# StackOverflow 问答 1020000-1020999

# java - 我如何解释 jstat 输出中的这些 *narrow* 尖峰？

> ID：1020000
> 
> 赞同：1
> 
> 时间：2009-06-19T20:58:38.320
> 
> 标签：java, jvm

尝试使用 jstat 监视 JVM 的性能时，我看到以下几行 -

```
 Timestamp      PC       PU        OC          **OU**       YGC    FGC    FGCT     GCT
      ...
      283.7 132608.0 132304.8   1572864.0    **398734.1**     20     0    0.000    3.061
      284.0 132608.0 132312.8   1572864.0   **1547795.2**     21     0    0.000    3.061
      284.2 132608.0 132313.7   1572864.0    **417220.7**     21     0    0.000    3.418
      ... 
```

相关 JVM 运行 2.5GB 的 Eden 和 4GB 的 Max。堆（-Xmn2560m -Xms4096m -Xmx4096m）

我不明白旧代使用量的这些峰值是如何可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T21:23:32.807

完全是在猜测，但看起来它发生在年轻一代进行 GC 时可能会将新对象踢到老一代中。这可能会在老一代中造成更严重的压实过程。

我猜它会复制所有新东西（使老一代更大），然后将其压缩回去......再次完全猜测。

由于您要从年轻一代移出一堆东西，即使没有完整的 GC，也可能需要时间（和空间）来移动一些东西。

# sharepoint - Windows Server 2008 上的 SharePoint 安装问题

> ID：1020016
> 
> 赞同：0
> 
> 时间：2009-06-19T21:03:25.627
> 
> 标签：sharepoint, sharepoint-2007, internet-explorer-8, windows-server-2008

我已经在 Windows Server 2008 上安装了 MOSS 2007。

我面临一个奇怪的问题：

1.  我无法使用 IE 8 登录 SharePoint，但可以使用 Firefox。请注意，我已经处理了 IE 中的安全问题。
2.  创建 Web 应用程序后，当我尝试更改 Web 应用程序以创建网站集时..我无法更改它（即使我选择了 Web 应用程序，它也会显示“无选择”。
3.  我无法将 Web 部件添加到创建的任何网站！（请注意，我已经使用解决方法创建了站点。使用 SharePoint 管理器将 SiteId=null 更改为站点 ID = 站点 ID）

我在日志中找不到任何条目或没有错误消息..

请在这方面帮助我。

优雅

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T16:22:33.470

Windows Server 2008 上的 IE8 的默认安全设置要严格得多。即使禁用 IE 增强安全配置也不允许所有功能。这是为了阻止您登录服务器，并且可能会无意中安装危及安全性的 IE 插件。

您确实应该从本地计算机连接到 SharePoint 管理中心。这样您就不会遇到安全问题，也将遵循 Microsoft 最佳实践。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T03:22:19.857

尝试将站点（中央管理员）添加到 IE 中的受信任站点，并将安全设置设为低。它将提供所有必需的东西，例如 Javascript，它应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T21:03:04.037

如果站点使用主机头名称，您可能需要禁用环回检查。[有关详细信息，](http://blog.brianfarnhill.com/2008/11/ie8-beta-2-authentication-issues-with-host-header-configured-sites/)请参阅这篇文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-25T19:15:59.680

我也遇到了同样的问题，无法选择网络应用程序。在我们的案例中，我们最终重新安装了 sharepoint（实际上是全新安装的操作系统），然后它运行良好。

安装中可能有一些步骤我们没有按正确的顺序执行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-25T21:01:36.783

在 Windows Server 2008 上安装 Sharepoint 不是常规安装。确保您安装了最新的累积更新 + SP2。更好的是，顺流安装。请注意，特别是在安装语言包时，在执行安装时需要注意，安装产品/更新/包的特定顺序。

更多信息[Code Eater 博客文章](http://blogs.msdn.com/wael/archive/2008/12/03/sharepoint-2007-with-language-packs-on-windows-server-2008.aspx)

# c# - “查找所有参考”在一个解决方案中被破坏

> ID：1020020
> 
> 赞同：3
> 
> 时间：2009-06-19T21:04:20.973
> 
> 标签：c#, visual-studio, ide, visual-studio-2005, find-all-references

在某些时候，“查找所有参考”功能因我拥有的单个解决方案而被破坏。它适用于所有其他解决方案。对于这个，它总是返回“搜索未找到结果”

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T21:17:39.997

在过去（VC6 :)）这种类型的问题通常是通过删除 .ncb 文件并让它自动重建来解决的。不确定这在 VS2005/8 中是否仍然适用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T21:06:21.203

我会杀死所有 Visual Studio 实例并重试。如果这不起作用，我想确实*没有*对您正在寻找的类型或成员的引用。

由于此功能适用于其他解决方案，我很难相信这是 IDE 本身的问题。我认为最可能的解释是 IDE 是正确的，而您实际上没有参考。

您是否有两种名称相似但实际上不是同一类型的类型？你能通过文本搜索找到参考文献吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-16T15:38:52.223

在 VS 2008 中遇到了同样的问题。就我而言，这是因为我将网站作为项目打开，而不是执行文件 - 打开网站。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-01T21:10:00.520

对我来说，我被“搜索没有返回结果”绊倒，但很快意识到方法名称是 Finalize()。一旦改名，一切都很好。

# windows - 在 Windows 的 schtasks 命令中指定“start-in”目录

> ID：1020023
> 
> 赞同：24
> 
> 时间：2009-06-19T21:06:03.547
> 
> 标签：windows, scheduled-tasks

我意识到这个问题在以下线程中得到了“回答”：[使用 schtasks.exe 指定计划任务的运行目录](https://stackoverflow.com/questions/447774)

但是，我仍然无法理解答案，也无法准确了解我的情况的结果。

我的 schtasks 命令如下所示：

`Schtasks /Create /TR "C:\Program Files\Java\jre6\bin\javaw.exe main.MoveFile input.txt" /SC WEEKLY /TN mytask`

我想在“C:\My Library”的目录中指定开始。在 tr 部分之前放置一个**“\”**填充“C:\Program Files\Java\jre6\bin”的起始目录。

我已经搞砸了很多，但我似乎无法让它工作。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-11-24T13:24:00.080

**更新：**请注意，从 Powershell v3 开始（但仅在 Windows 2012 及更高版本下！）有新的 API，我发现它更具吸引力：

```
$taskPath = "\MyTasksFolder\"
$name = 'MyTask'
$runAt = '5:00 AM'
$exe = 'my.exe'
$params = 'command line arguments'
$location = "C:\Path\To\MyTask"

Unregister-ScheduledTask -TaskName $name -TaskPath $taskPath -Confirm:$false -ErrorAction:SilentlyContinue  

$action = New-ScheduledTaskAction –Execute "$location\$exe" -Argument "$params" -WorkingDirectory $location
$trigger = New-ScheduledTaskTrigger -Daily -At $runAt
Register-ScheduledTask –TaskName $name -TaskPath $taskPath -Action $action –Trigger $trigger –User 'someuser' -Password 'somepassword' | Out-Null 
```

* * *

Amal 的`/v1`switch 解决方案很棒，但不允许在自定义文件夹中创建任务（即你不能创建“MyCompany\MyTask”，所有内容都在根文件夹中），所以我最终得到了下面描述的 PowerShell 脚本.

**用法：**

```
CreateScheduledTask -computer:"hostname-or-ip" `
                    -taskName:"MyFolder\MyTask" `
                    -command:"foo.exe" `
                    -arguments:"/some:args /here" `
                    -workingFolder:"C:\path\to\the\folder" `
                    -startTime:"21:00" `
                    -enable:"false" `
                    -runAs:"DOMAIN\user" `
                    -runAsPassword:"p@$$w0rd" 
```

（注意，`enable`必须是小写 - 对于您需要的布尔值 `$value.ToString().ToLower()`）

**执行：**

该函数使用 XML 任务定义和“Schedule.Service”COM 对象。

```
#####################################################
#
#  Creates a Windows scheduled task triggered DAILY.
#  Assumes TODAY start date, puts "run-as" user as task author.
#
#####################################################
function CreateScheduledTask($computer, $taskName, $command, $arguments, $workingFolder, $startTime, $enable, $runAs, $runAsPassword)
{    
    $xmlTemplate = "<?xml version='1.0' encoding='UTF-16'?>
        <Task version='1.2' xmlns='http://schemas.microsoft.com/windows/2004/02/mit/task'>
          <RegistrationInfo>
            <Date>{0}</Date>
            <Author>{1}</Author>
          </RegistrationInfo>
          <Triggers>
            <CalendarTrigger>
              <StartBoundary>{2}</StartBoundary>
              <Enabled>true</Enabled>
              <ScheduleByDay>
                <DaysInterval>1</DaysInterval>
              </ScheduleByDay>
            </CalendarTrigger>
          </Triggers>
          <Principals>
            <Principal id='Author'>
              <UserId>{1}</UserId>
              <LogonType>Password</LogonType>
              <RunLevel>LeastPrivilege</RunLevel>
            </Principal>
          </Principals>
          <Settings>
            <IdleSettings>
              <Duration>PT10M</Duration>
              <WaitTimeout>PT1H</WaitTimeout>
              <StopOnIdleEnd>true</StopOnIdleEnd>
              <RestartOnIdle>false</RestartOnIdle>
            </IdleSettings>
            <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>
            <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>
            <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>
            <AllowHardTerminate>true</AllowHardTerminate>
            <StartWhenAvailable>false</StartWhenAvailable>
            <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>
            <AllowStartOnDemand>true</AllowStartOnDemand>
            <Enabled>{3}</Enabled>
            <Hidden>false</Hidden>
            <RunOnlyIfIdle>false</RunOnlyIfIdle>
            <WakeToRun>false</WakeToRun>
            <ExecutionTimeLimit>P3D</ExecutionTimeLimit>
            <Priority>7</Priority>
          </Settings>
          <Actions Context='Author'>
            <Exec>
              <Command>{4}</Command>
              <Arguments>{5}</Arguments>
              <WorkingDirectory>{6}</WorkingDirectory>
            </Exec>
          </Actions>
        </Task>"
    $registrationDateTime = [DateTime]::Now.ToString("yyyy-MM-dd") + "T" + [DateTime]::Now.ToString("HH:mm:ss")
    $startDateTime = [DateTime]::Now.ToString("yyyy-MM-dd") + "T" + $startTime + ":00"
    $xml = $xmlTemplate -f $registrationDateTime, $runAs, $startDateTime, $enable, $command, $arguments, $workingFolder

    $sch = new-object -ComObject("Schedule.Service")
    $sch.Connect($computer)
    $task = $sch.NewTask($null)
    $task.XmlText = $xml

    $createOrUpdateFlag = 6
    $sch.GetFolder("\").RegisterTaskDefinition($taskName, $task, $createOrUpdateFlag, $runAs, $runAsPassword, $null, $null) | out-null 
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-12-12T08:06:53.687

如果一切都失败了，你可以重定向到一个批处理文件来设置它自己的 CD，然后调用你的程序。
例如：

```
Schtasks /Create /TR "C:\example\batch.bat" /SC WEEKLY /TN mytask 
```

作为 schtask，并且

```
cd "%temp%\"
"C:\Program Files\Java\jre6\bin\javaw.exe main.MoveFile input.txt" 
```

作为“C:\example\batch.bat”。这应该将当前目录保留为您在批处理文件中将其更改为的任何目录，并保留与该目录相关的所有引用。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-06-20T01:50:29.353

不确定您使用的是哪个版本的 Windows，但从阅读其他问题来看，Vista / Server 2008 上的 schtasks 似乎没有提供允许您直接指定“启动”目录的命令选项。人们提供的解决方法是：

1.  使用 /v1 标志创建一个与 XP / 2003 兼容的任务，在这种情况下会自动设置“start-in”目录。不确定它的设置，但我怀疑它可能与您的任务可执行文件位于同一目录，这对您不起作用。
2.  从允许您指定“起始”目录的 XML 文件（使用 /XML 选项）创建任务。抱歉，我不知道这个 XML 文件的语法/结构。
3.  改为使用任务计划程序 UI 创建您的任务。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-11-02T23:48:52.707

正如您所注意到的，在 /TR 参数中使用额外引号的技巧只允许您使用与可执行文件所在的目录相同的目录。如果要指定不同的工作目录，则应使用 /XML 选项并指定列出工作目录的 XML 文件。该命令将是这样的：

```
SchTasks /Create /TN "Foo" /XML task.xml 
```

XML 文件看起来像这样：

```
<?xml version="1.0" ?>
<Task xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">
    <RegistrationInfo>
        <Date>2006-05-02T13:21:17</Date>
        <Author>AuthorName</Author>
        <Version>1.0.0</Version>
        <Description>Call MoveFile</Description>
    </RegistrationInfo>
    <Triggers>
        <CalendarTrigger>
            <StartBoundary>2011-11-02T00:00:00</StartBoundary>
            <ScheduleByDay>
                <DaysInterval>1</DaysInterval>
            </ScheduleByDay>
        </CalendarTrigger>
    </Triggers>
    <Principals>
        <Principal>
            <UserId>Administrator</UserId>
            <LogonType>InteractiveToken</LogonType>
        </Principal>
    </Principals>
    <Settings>
        <Enabled>true</Enabled>
        <AllowStartOnDemand>true</AllowStartOnDemand>
        <AllowHardTerminate>true</AllowHardTerminate>
    </Settings>
    <Actions>
        <Exec>
            <Command>C:\Program Files\Java\jre6\bin\javaw.exe</Command>
            <Arguments>main.MoveFile input.txt</Arguments>
            <WorkingDirectory>C:\My Library</WorkingDirectory>
        </Exec>
    </Actions>
</Task> 
```

这里有关于 XML 架构的更多信息：http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa383609 (v=VS.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383609(v=VS.85).aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-12-30T07:54:42.783

尝试

```
cd /d "C:\Program Files\Java\jre6\bin" & schtasks /create /tr "C:\Program Files\Java\jre6\bin\javaw.exe main.MoveFile input.txt" /sc WEEKLY /tn mytask 
```

更改工作目录，然后运行 ​​schtasks。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-06-19T19:13:54.773

## 需求

*安排将从特定目录运行的任务。*如果我们在执行命令`c:\x`时调用此目录`pwd`，它将打印`c:\x`. 从那里开始的每个路径都相对于该目录。

另一个例子：运行`java -jar myapp.jar`将*执行*位于`c:\x\myapp.jar`

## 问题

无法使用命令设置该特定参数`schtasks /create`

## 解决方案

有点步履蹒跚（比如步骤太多）：

1.  `schtasks /create`使用命令尽可能具体地创建任务。尝试将每个参数设置为所需的值：开始时间、重复、持续时间等...

    在这种情况下，`/tn`参数是强制性的，所以设置它：`\tn mytask`

2.  使用将新创建的任务导出到 XML`schtasks /query /tn mytask /xml > mytask.xml`

3.  `mytasks.xml`在您喜欢的编辑器中打开。你应该看到这样的东西（我隐藏了不感兴趣的部分）：

```
<?xml version="1.0" encoding="UTF-16"?>

<Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">

 <RegistrationInfo>...
 </RegistrationInfo>

 <Triggers>...
 </Triggers>

 <Settings>...
 </Settings>

 <Actions Context="Author">

   <Exec>

     <Command>java</Command>

     <Arguments>-jar c:\x\myapp.jar</Arguments>

   </Exec>

 </Actions>

 <Principals>...
 </Principals>

</Task> 
```

4.  在该`<Exec>`部分内，下面向该`<Argument>`字段介绍一个新字段：

```
<WorkingDirectory>c:\x\</WorkingDirectory> 
```

**并保存文件。**此字段在此处的 xml 架构定义中定义[https://docs.microsoft.com/en-us/windows/desktop/taskschd/task-scheduler-schema](https://docs.microsoft.com/en-us/windows/desktop/taskschd/task-scheduler-schema)

5.  删除之前创建的任务（使用修改后的 xml 重新创建）：`schtasks /delete /tn mytask`

6.  `/xml`使用参数再次创建任务：`schtasks \tn mytask \xml mytask.xml`

### 只是看看它是否有效

使用`schtasks /run /tn mytask`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-30T19:04:26.010

注意：这是我刚刚看到的问题..

注意：您必须有两行：

```
REM NOTE:You have to create the schedule first
SCHTASKS /S SERVER /CREATE /TN "SERVER_RESTART" /RU "" /TR "D:\WORK\scripts\__server_restart.bat 1" /SC MONTHLY /MO FIRST /D SUN /ST:02:10
REM The next line is run to set the run in folder as well as set the: run as: NT AUTHORITY\SYSTEM
SCHTASKS /S SERVER /CHANGE /TN "SERVER_RESTART" /RU "" /TR "D:\WORK\scripts\__server_restart.bat 1" 
```

例如，我在 Windows 2008 中注意到的一件事是它处理批处理脚本比 2003 好得多。我认为“运行”文件夹并不像我刚刚从任务计划程序手动在测试机器上重新启动服务器那样重要，它运行得很好。

对于可能遇到转义字符等问题的人，请考虑以下事项：

```
SCHTASKS /CHANGE /S SERVER /RU "" /TR "powershell -file "\"D:\WORK\ps\zip_up_files\zip_up_files.ps1"\"" /TN "PowerShell - New Archive" 
```

或者，另一个例子：

```
SCHTASKS /CREATE /S SERVER /RU "" /TR "powershell -file "\"D:\WORK\ps\page_test.ps1"\"" /TN "PowerShell - Page Test" /SC MINUTE /MO 3 /ST:23:00 
```

注意：额外的引号和额外的反斜杠。

希望这可以帮助！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-05T00:41:07.743

我发现，如果您在 SCHTASKS 命令行中对路径和文件名使用 8.3 命名约定，则“Start In”字段将使用文件路径填充 -

例如 "C:\Progra~1\NBVCl~1\nbv_up~1.exe" 将导致 "C:\Progra~1\NBVCl~1" 出现在 "start In" 区域

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-13T06:41:30.560

唯一的方法是使用 XML Flle，使用以下命令： schtasks /Create /XML C:\file.xml /TN TaskName /RU domain\username /RP password

每天 23:00 运行的示例 XML 文件，C:\task 文件夹将设置运行目录：

```
<?xml version="1.0" encoding="UTF-16"?>
<Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">
  <RegistrationInfo>
    <Date>2016-07-13T07:56:56</Date>
    <Author>Administrator</Author>
  </RegistrationInfo>
  <Triggers>
    <CalendarTrigger>
      <StartBoundary>2016-07-13T23:00:00</StartBoundary>
      <Enabled>true</Enabled>
      <ScheduleByDay>
        <DaysInterval>1</DaysInterval>
      </ScheduleByDay>
    </CalendarTrigger>
  </Triggers>
  <Principals>
    <Principal id="Author">
      <UserId>domain\Administrator</UserId>
      <LogonType>Password</LogonType>
      <RunLevel>HighestAvailable</RunLevel>
    </Principal>
  </Principals>
  <Settings>
    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>
    <DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>
    <StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>
    <AllowHardTerminate>true</AllowHardTerminate>
    <StartWhenAvailable>false</StartWhenAvailable>
    <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>
    <IdleSettings>
      <StopOnIdleEnd>true</StopOnIdleEnd>
      <RestartOnIdle>false</RestartOnIdle>
    </IdleSettings>
    <AllowStartOnDemand>true</AllowStartOnDemand>
    <Enabled>true</Enabled>
    <Hidden>false</Hidden>
    <RunOnlyIfIdle>false</RunOnlyIfIdle>
    <WakeToRun>false</WakeToRun>
    <ExecutionTimeLimit>P3D</ExecutionTimeLimit>
    <Priority>7</Priority>
  </Settings>
  <Actions Context="Author">
    <Exec>
      <Command>C:\taskfolder\task.bat</Command>
      <WorkingDirectory>C:\taskfolder</WorkingDirectory>
    </Exec>
  </Actions>
</Task> 
```

# java - 如何在 Eclipse 中使用带有选定文本的“sysout”片段？

> ID：1020027
> 
> 赞同：24
> 
> 时间：2009-06-19T21:07:05.603
> 
> 标签：java, eclipse, code-snippets

我知道 Eclipse 片段“sysout”被 System.out.println(); 巧妙地替换了。当标签完成时。

这非常有用，但有时我需要将一些现有代码包装在 System.out.println();

在 Eclipse 内部，模板被定义为能够包装“选定的单词”。但是，由于键入“sysout”显然会删除选定的文本，因此我如何才能将片段与选定的文本一起使用。

任何的想法？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-06-19T21:26:20.133

sysout 模板作用于整个 Java 语句。

1.  在编辑器中突出显示一个语句。
2.  点击 CTRL-SPACE（或您为内容辅助设置的任何内容。）
3.  键入 sysout 然后按回车键。请注意，当您键入 sysout 时，它**会**`System.out.println`暂时覆盖您的语句（但当您按 Enter 时，它会返回包装。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T21:35:57.090

Eclipse 有“环绕宽度”选项，可以为您做到这一点。

SHIFT + ALT + Z 应该让您了解模板元数据布局的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T21:25:40.167

我不认为你可以一次完成，但是剪切选定的文本然后：tab+space，ctrl+v，这只是一个组合键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T21:27:54.843

如果您使用内容辅助（Windows 上的 ctrl-space），列表末尾将是 sysout 选项。您可能希望在单词选择周围使用引号来扩充模板，这样您就不需要输入它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-07T15:26:42.293

首选项>常规>键。然后在“类型过滤器文本”中搜索“内容辅助”或“内容”。不要按 Enter。选择“内容辅助”。键入 Binding 并设置您自己的快捷方式。比如“控制+空格”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-06T13:28:15.897

主要部分是：

Java->编辑器->模板

这可以通过以下方式访问：

*   首选项窗口：进入 Java->Editor->Templates。
*   环绕文字并按下：

    ```
    Windows: SHIFT + ALT + Z (as sadhasivam said)
    Mac: CMD + OPT + Z 
    ```

    显示首选项窗口

# objective-c - 我可以将::bind() 提升到目标 C 函数吗？

> ID：1020028
> 
> 赞同：10
> 
> 时间：2009-06-19T21:08:07.487
> 
> 标签：objective-c, boost-bind

我不知道这是否可能，但如果是的话，语法会是什么样子？

如果不可能，为什么不呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-19T21:29:52.763

您应该能够绑定到消息实现 ( `IMP`)，它们只是具有两个隐藏参数的普通 C 函数，`self`类型`_cmd`分别为`id`和`SEL`。

**编辑**：刚刚测试了下面的完整示例，它似乎可以工作。

```
#include <stdio.h>
#include <boost/bind.hpp>
#include <Foundation/NSObject.h>

@interface MyClass : NSObject
{
}
-(int) doSomething:(int)arg;
@end

@implementation MyClass
-(int) doSomething:(int)arg
{
  printf("doSomething: self=0x%08x _cmd=0x%08x\n", self, _cmd);
  return arg + 1;
}
@end

int main(void)
{
  MyClass *myObj = [[MyClass alloc] init], *otherObj = [[MyClass alloc] init];
  typedef int (*MyFunc)(id, SEL, int);
  SEL doSomething_sel = @selector(doSomething:);
  MyFunc doSomething_impl = (MyFunc)[myObj methodForSelector:doSomething_sel];

  // bind self & _cmd arguments:
  // calls [myObj doSomething:x]
  int result = boost::bind(doSomething_impl, myObj, doSomething_sel, _1)(14);
  printf("result1: %d\n", result);

  // bind _cmd & arg:
  // calls [otherObj doSomething:3]
  result = boost::bind(doSomething_impl, _1, doSomething_sel, 42)(otherObj);
  printf("result2: %d\n", result);

  return 0;
} 
```

使用 GNUstep，编译为：

```
gcc objcbind.mm -o objcbind -I/usr/include/GNUstep -lobjc -lstdc++ -lgnustep-base 
```

在 Mac OS X 上，编译为：

```
gcc objcbind.mm -o objcbind -framework Foundation -lstdc++ 
```

输出：

```
doSomething：自我=0x01a85f70 _cmd=0x00602220
结果1：15
doSomething：自我=0x01a83d70 _cmd=0x00602220
结果2：43

```

# excel - 如何防止更新 Excel 中的单元格？

> ID：1020031
> 
> 赞同：3
> 
> 时间：2009-06-19T21:09:30.870
> 
> 标签：excel, vba

我有一个相当大的范围（10,000 行，10 列），我每天都会逐行填写。我还有一个较小的范围（366 行，5 列），其中，对于每个单元格，我运行一个宏。该宏几乎可以完成 DSUM 或 SUMIF 的工作，但有多个条件。问题是，在实现了这些花哨的东西之后，我无法体面地填充我的东西，因为在我填充宏的每个单元格上运行了几十次，每次循环数百次，大约需要 5 秒才能让我填充下一个单元格。

我希望能够阻止更新较小的范围（或不运行宏），所以我可以正常填充它，然后按一个按钮更新所有内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T21:11:17.967

您将需要锁定目标范围（将`Locked`Range 的属性设置为`true`）。然后，您将需要通过调用工作表的`Protect()`方法来保护工作表。下面是如何锁定和解锁单元格的示例`A1:A4`。

锁：

```
Sheet1.Range("A1:A4").Locked = true
Sheet1.Protect() 
```

解锁：

```
Sheet1.Unprotect() 
```

**编辑**：重新阅读问题后，似乎 OP 正在使用 Worksheet_Change 事件。我有一句话：

## **停止**

只需将一个 ActiveX 按钮放入工作表中，然后为其分配一个宏，如此[处](http://peltiertech.com/WordPress/how-to-assign-a-macro-to-an-activex-control/)所述。

Worksheet_Change 事件充满危险。进入的人要当心，因为那里有龙。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T21:13:52.267

嗯，有这个：

```
 Application.Calculation = xlCalculationManual 
```

但这会停止所有重新计算，直到您将其休息为自动或明确调用重新计算。这足够了吗，还是您需要更多？

如果您需要将重新计算限制限制为仅阻止执行特定的宏，则执行以下操作：

1.  在宏中添加“全局 IShouldNotRun as Boolean”
2.  您的宏应检查 IShouldNotRun 值，如果为真则退出。
3.  编写另一个切换此全局的宏。
4.  无论你在做什么数据加载调用例程将全局设置为 True。
5.  完成加载并调用Calculate、CalculateFull 或CalculateFullRebuild 后重置它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T21:16:42.760

我的电脑上没有 ecell，所以我无法检查确切的路径，但据我记得进入工具/选项菜单后，有一个选项卡“计算”或“计算”，您可以在其中禁用自动公式重新计算。

# python - 如何使用列表理解上链表？

> ID：1020037
> 
> 赞同：1
> 
> 时间：2009-06-19T21:12:29.647
> 
> 标签：python, list-comprehension

我一直在想一种方法来遍历层次结构，如链表，使用列表表达式，但没有想出任何似乎可行的方法。

基本上，我想转换这段代码：

```
p = self.parent
names = []
while p:
  names.append(p.name)
  p = p.parent
print ".".join(names) 
```

变成像这样的单线：

```
print ".".join( [o.name for o in <???>] ) 
```

不过，我不确定如何以*通用方式*（如果可能的话）在`???`零件中进行遍历。我有几个具有相似类型属性的结构，并且不想为每个结构编写一个屈服函数。*`.parent`*

 *编辑：

我不能使用`__iter__`对象本身的方法，因为它已经用于迭代对象本身包含的值。大多数其他答案，除了 liori 的，硬编码属性名称，这是我想要避免的。

这是我根据 liori 的回答做出的改编：

```
import operator
def walk(attr, start):
  if callable(attr):
    getter = attr
  else:
    getter = operator.attrgetter(attr)

  o = getter(start)
  while o:
    yield o
    o = getter(o) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T21:18:08.483

我能想到的最接近的事情是创建一个父生成器：

```
# Generate a node's parents, heading towards ancestors
def gen_parents(node):
   node = node.parent
   while node:
      yield node
      node = node.parent

# Now you can do this
parents = [x.name for x in gen_parents(node)]
print '.'.join(parents) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T23:38:10.510

如果您希望您的解决方案具有通用性，请使用通用技术。这是一个类似生成器的定点：

```
def fixedpoint(f, start, stop):
    while start != stop:
        yield start
        start = f(start) 
```

只要这些值都不等于 stop，它将返回一个生成器产生 start, f(start), f(f(start)), f(f(f(start))), ...。

用法：

```
print ".".join(x.name for x in fixedpoint(lambda p:p.parent, self, None)) 
```

我的个人助手库多年来一直具有类似的定点功能……它对于快速破解非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T21:17:15.957

列表推导适用于作为迭代器的对象（具有 next() 方法）。您需要为您的结构定义一个迭代器，以便能够以这种方式对其进行迭代。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T22:57:35.677

您的 LinkedList 需要可迭代才能正常工作。

[这是一个很好的资源。（PDF 警告）](http://heather.cs.ucdavis.edu/~matloff/Python/PyIterGen.pdf)它对迭代器和生成器都非常深入。

一旦你这样做了，你就可以这样做：

```
print ".".join( [o.name for o in self] ) 
```*

# asp.net - ASP.NET Vers Winforms

> ID：1020043
> 
> 赞同：5
> 
> 时间：2009-06-19T21:14:08.273
> 
> 标签：asp.net, winforms

任何人都知道我在哪里可以找到“普遍接受”的 Pro 和 Con 在 ASP.NET 中开发与 Win forms 2.0 之间的良好比较。最好是官方的。我需要向我的老板（根本不是技术人员）介绍这两者，并且正在寻找一些“官方”的东西来展示给他。我在论坛上找到了很多东西，但从“官方”来源找不到任何东西

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T21:16:09.640

ASP.NET 是一个 Web 开发框架，而 WinForms 是一个桌面应用程序 UI 框架。您是在尝试构建网站还是桌面应用程序？这就是你的答案。

如果您的问题更像是瘦客户端还是胖客户端，请参阅[此处](https://stackoverflow.com/questions/522422/when-should-you-build-a-web-application-vs-a-thick-client/522431)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-19T21:16:53.930

一篇可能有用的 MSDN 文章：[在 Windows 窗体和 Web 窗体之间选择](http://msdn.microsoft.com/en-us/library/5t6z562c(VS.80).aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-19T21:18:07.843

MSDN：[在 Windows 窗体和 Web 窗体之间选择，](http://msdn.microsoft.com/en-us/library/5t6z562c.aspx) 它也链接到[ClickOnce 部署概述](http://msdn.microsoft.com/en-us/library/142dbbz4.aspx)，尽管您还应该考虑[Silveright](http://silverlight.net/)（浏览器中的丰富应用程序）和[ASP.NET MVC](http://www.asp.net/mvc/)（Web 服务器上 Web 窗体的替代模型）。

# java - 启动 Java Web 启动应用程序后没有任何反应

> ID：1020044
> 
> 赞同：4
> 
> 时间：2009-06-19T21:14:18.740
> 
> 标签：java

我以前从未做过 Java Web 启动应用程序。我编写了我的应用程序的 JNLP 文件并将它们与所有 JAR 一起发布到我的 Web 服务器。但是，在获得 JWS 加载库的初始启动屏幕之后，什么也没有发生。你对如何调试有什么建议，也许得到一些控制台输出？我尝试通过“javaws -uninstall”清理缓存，但没有帮助。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T21:31:52.183

在 Java 控制面板中，选择高级 > Java 控制台 > 显示控制台。您可能会看到一些异常输出。如果该进程仍在运行，您应该能够`jps`从命令行中找到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T21:58:09.353

在 Java 控制台中，您应该启用完整的跟踪和日志记录。这将告诉您很多关于当 Web Start 不工作时在幕后发生的事情。

请参阅[http://java.sun.com/javase/6/docs/technotes/guides/deployment/deployment-guide/tracing_logging.html](http://java.sun.com/javase/6/docs/technotes/guides/deployment/deployment-guide/tracing_logging.html)

希望这可以让你开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-08T00:59:24.663

您是否检查了任务管理器以查看它是否已实际启动？

根据我遇到类似问题的经验，程序本身实际上正在运行，但它无法显示任何内容。

# asp.net - 如何跟踪 ScriptService WebService 请求？

> ID：1020045
> 
> 赞同：7
> 
> 时间：2009-06-19T21:14:25.387
> 
> 标签：asp.net, jquery, web-services, soap-extension

我有一个旨在记录所有 SOAP 请求和响应的 SoapExtension。它适用于使用 MS Soap Toolkit (OnBase Workflow) 的应用程序调用。但它不适用于由 $.ajax() 在 html 页面上进行的调用。这是一个例子：

```
$.ajax({
    type: "POST",
    url: url,
    data: data,
    contentType: "application/json; charset=utf-8",
    dataType: "json"
}); 
```

它正在调用标有 WebService 和 ScriptService 属性的 ASP.NET 3.5 WebService：

```
[WebService(Namespace = XmlSerializationService.DefaultNamespace)]
[ScriptService]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
public class DepartmentAssigneeService : WebService
{
    private readonly DepartmentAssigneeController _controller = new DepartmentAssigneeController();

    /// <summary>
    /// Fetches the role items.
    /// </summary>
    /// <returns></returns>
    [WebMethod]
    [SoapLog]
    public ListItem[] FetchDepartmentItems()
    {
        return CreateListItems(_controller.FetchDepartments());
    }
} 
```

以下是 SoapExtension 和 SoapExtensionAttribute 的基础知识：

```
public class LoggingSoapExtension : SoapExtension, IDisposable { /*...*/ }

[AttributeUsage(AttributeTargets.Method)]
public sealed class SoapLogAttribute : SoapExtensionAttribute { /*...*/ } 
```

我是否遗漏了允许 LoggingSoapExtension 在 $.ajax() 请求上执行的内容？

**更新**

@克里斯布兰兹玛

> 这可能是因为您通过 Web 服务（数据类型：“json”）请求 Json 结果而不是 XML。因此 ScriptService 属性被激活，但您没有发送 SOAP 消息。

这回答了为什么 SoapExtension 不起作用。对使用 ScriptService 进行跟踪有什么建议吗？唯一想到的是 ScriptService 基类，它提供了一种记录请求的方法。但是我必须在每个 ScriptService WebService 中的每个 WebMethod 中调用该方法（我有很多）。如果可能的话，我想使用像 SoapExtension 属性一样干净简单的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-23T19:19:30.940

我找到了解决方案。通过使用 IHttpModule，我可以记录来自任何东西（SOAP、JSON、表单等）的请求。在下面的实现中，我选择记录所有 .asmx 和 .ashx 请求。这将替换问题中的 LoggingSoapExtension。

```
public class ServiceLogModule : IHttpModule
{
    private HttpApplication _application;
    private bool _isWebService;
    private int _requestId;
    private string _actionUrl;

    #region IHttpModule Members

    public void Dispose()
    {
    }

    public void Init(HttpApplication context)
    {
        _application = context;
        _application.BeginRequest += ContextBeginRequest;
        _application.PreRequestHandlerExecute += ContextPreRequestHandlerExecute;
        _application.PreSendRequestContent += ContextPreSendRequestContent;
    }

    #endregion

    private void ContextPreRequestHandlerExecute(object sender, EventArgs e)
    {
        _application.Response.Filter = new CapturedStream(_application.Response.Filter,
                                                          _application.Response.ContentEncoding);
    }

    private void ContextBeginRequest(object sender, EventArgs e)
    {
        string ext = VirtualPathUtility.GetExtension(_application.Request.FilePath).ToLower();
        _isWebService = ext == ".asmx" || ext == ".ashx";

        if (_isWebService)
        {
            ITraceLog traceLog = TraceLogFactory.Create();
            _actionUrl = _application.Request.Url.PathAndQuery;

            StreamReader reader = new StreamReader(_application.Request.InputStream);
            string message = reader.ReadToEnd();
            _application.Request.InputStream.Position = 0;

            _requestId = traceLog.LogRequest(_actionUrl, message);
        }
    }

    private void ContextPreSendRequestContent(object sender, EventArgs e)
    {
        if (_isWebService)
        {
            CapturedStream stream = _application.Response.Filter as CapturedStream;
            if (stream != null)
            {
                ITraceLog traceLog = TraceLogFactory.Create();
                traceLog.LogResponse(_actionUrl, stream.StreamContent, _requestId);
            }
        }
    }
} 
```

我大量借鉴了[Capturing HTML generated from ASP.NET](https://stackoverflow.com/questions/386487/capturing-html-generated-from-asp-net)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T21:54:24.603

这可能是因为您通过 Web 服务（数据类型：“json”）请求 Json 结果而不是 XML。因此 ScriptService 属性被激活，但您没有发送 SOAP 消息。

您可以将 dataType 更改为 xml 并查看是否有效。

[http://docs.jquery.com/Ajax/jQuery.ajax#options](http://docs.jquery.com/Ajax/jQuery.ajax#options)

此外，另一个日志记录选项是 Log4Net。它可以为您提供更多功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T13:35:03.523

Fiddler（主要用于 IE，但现在用于 firefox）或 Firebug（用于 firefox）是观察客户端请求和响应的宝贵工具。

# tfs - 分支上的 TFS 2008 持续集成 MSBUILD 在标签上失败

> ID：1020047
> 
> 赞同：0
> 
> 时间：2009-06-19T21:15:59.657
> 
> 标签：tfs, msbuild, continuous-integration

我正在尝试在我的一个 TFS 项目的分支上使用 CI。只有当我尝试使用分支时，MSBuild 才会失败。我将相同的构建指向“主干”项目，它工作正常。

我从构建日志收到的错误：

> 任务“标签”
> 
> 标签 TeamFoundationServerUrl="http://TFSServer:8080/" BuildUri="vstfs:///Build/Build/6763" Name="Test_SF_20090619.1" Scope="$/MyProject" Recursive=True Comments="标签创建者Team Build" Version="BuildServer3D143_66" Child="Replace" Files="$/" C:\Program Files\MSBuild\Microsoft\VisualStudio\TeamBuild\Microsoft.TeamFoundation.Build.targets(812,5,812,5)：
> 
> 错误：在您的工作区的 $/ 中找不到匹配的项目。
> 
> 完成执行任务“标签”——失败。
> 
> 在项目“TFSBuild.proj”中完成构建目标“CoreLabel”——失败。

我相信这个错误是由于缺少源文件被复制到构建服务器引起的。

从构建日志中获取任务摘录：

> 任务“获取”
> 
> 获取 TeamFoundationServerUrl="http://TFSServer:8080/" BuildUri="vstfs:///Build/Build/6768" Force=True Overwrite=False PopulateOutput=False Preview=False Recursive=True Version="C204806" Workspace="构建服务器3D143_66"
> 
> 完成执行任务“获取”。

这是一个完整的构建。GET 中应该列出大约一千个文件。

**一般信息**

*   TFS 2008
*   视觉工作室 2008
*   已建立的构建服务器（去年一直在运行构建）
*   正在分支的项目是一个 ASP.NET 网站（2.0 框架）。

**完整构建参数**

*   /p:SkipClean=假
*   /p:SkipInitializeWorkspace=false
*   /p:ForceGet=真
*   /p:增量构建=假
*   /p:增量获取=假

注意：我知道 IncrementalBuild 是多余的，但我只是想确定一下。

**问题：**

*   对分支的构建有限制吗？
*   知道为什么 MSBuild 无法从分支工作区中提取文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T00:46:53.927

如果是用于 CI，那么您很可能会进行增量获取。TFS 只会费心获取自上次获取以来它认为已更改的文件——例如，如果您从服务器中删除任何文件，它仍会认为您拥有这些文件，因此不会再次获取它们。在这种情况下，您需要在关闭增量属性的情况下运行一次构建，以便强制完全获取源代码。您可以通过在“队列构建”对话框中覆盖 MSBuild 命令行框中的属性来执行此操作：

```
/p:IncrementalGet=false;ForceGet=true 
```

另一个想到的可能性是 Label 任务被您的分支混淆了。可能是您的工作区设置不正确，因此请检查您是否正在映射它需要的所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-24T16:53:23.837

在这种情况下，我有两个问题。

首先，分支安全没有授予构建服务帐户的权限。我已将分支限制为我们团队的技术主管和发布工程师。构建服务帐户也需要访问权限。什么提示我是在搜索互联网时，我偶然发现了一个犯了同样错误的人的[帖子。](http://social.msdn.microsoft.com/Forums/pt-BR/tfsbuild/thread/2b1ab034-6bdd-47a9-aa34-ea3286052d84)

第二个问题涉及更多一点。在清理我的构建项目文件时，我删除了以下部分。

```
<SolutionToBuild Include="$(BuildProjectFolderPath)/../../_stage/MyProject/MySolution.sln">
        <Targets></Targets>
        <Properties></Properties>
</SolutionToBuild> 
```

这在我已经构建过至少一次的项目上运行良好，但如果这是一个新构建，没有将源文件复制到构建服务器，那么将没有文件并且构建将失败。

你们中的一些人可能想知道我的其他构建是否也可以工作，毕竟他们没有旧的构建文件。是的，但我已经定义了完成我真正关心的所有工作的目标。所以SolutionToBuild 有点轻浮。

# python - 使用 Python 的内置 .csv 模块编写

> ID：1020053
> 
> 赞同：7
> 
> 时间：2009-06-19T21:17:07.330
> 
> 标签：python, file-io, csv, python-3.x

[请注意，这与已经回答的[如何使用 Python 的内置 .csv 编写器模块替换列？](https://stackoverflow.com/questions/1019200/how-to-replace-a-column-using-pythons-built-in-csv-writer-module)]

我需要在一个巨大的 Excel .csv 文件中进行查找和替换（特定于一列 URL）。由于我正处于尝试自学脚本语言的开始阶段，我想我会尝试在 python 中实现该解决方案。

在更改条目的内容后尝试写回 .csv 文件时遇到问题。我已阅读有关如何使用编写器的[官方 csv 模块文档](http://docs.python.org/3.0/library/csv.html)，但没有涵盖这种情况的示例。具体来说，我试图在一个循环中完成读取、替换和写入操作。但是，不能在 for 循环的参数和 writer.writerow() 的参数中使用相同的“行”引用。那么，一旦我在 for 循环中进行了更改，我应该如何写回文件？

**编辑：**我实施了 S. Lott 和 Jimmy 的建议，结果仍然相同

**编辑#2：**根据 S. Lott 的建议，我在 open() 函数中添加了“rb”和“wb”

```
import csv

#filename = 'C:/Documents and Settings/username/My Documents/PALTemplateData.xls'

csvfile = open("PALTemplateData.csv","rb")
csvout = open("PALTemplateDataOUT.csv","wb")
reader = csv.reader(csvfile)
writer = csv.writer(csvout)

changed = 0;

for row in reader:
    row[-1] = row[-1].replace('/?', '?')
    writer.writerow(row)                  #this is the line that's causing issues
    changed=changed+1

print('Total URLs changed:', changed) 
```

**编辑：**供您参考，这是来自解释器的**新**的完整回溯：

```
Traceback (most recent call last):
  File "C:\Documents and Settings\g41092\My Documents\palScript.py", line 13, in <module>
    for row in reader:
_csv.Error: iterator should return strings, not bytes (did you open the file in text mode?) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-19T21:23:05.383

您不能读取和写入同一个文件。

```
source = open("PALTemplateData.csv","rb")
reader = csv.reader(source , dialect)

target = open("AnotherFile.csv","wb")
writer = csv.writer(target , dialect) 
```

所有文件操作的正常方法是创建原始文件的修改副本。不要尝试就地更新文件。这只是一个糟糕的计划。

* * *

**编辑**

在行中

```
source = open("PALTemplateData.csv","rb")

target = open("AnotherFile.csv","wb") 
```

“rb”和“wb”是绝对需要的。每次忽略这些时，都会以错误的格式打开文件进行读取。

您必须使用“rb”来读取 .CSV 文件。Python 2.x 没有选择。在 Python 3.x 中，您可以省略它，但显式使用“r”以使其清晰。

您必须使用“wb”来编写 .CSV 文件。Python 2.x 没有选择。对于 Python 3.x，您必须使用“w”。

* * *

**编辑**

看来您正在使用 Python3。您需要从“rb”和“wb”中删除“b”。

阅读：[http ://docs.python.org/3.0/library/functions.html#open](http://docs.python.org/3.0/library/functions.html#open)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-22T15:51:08.047

以二进制形式打开 csv 文件是错误的。CSV 是普通的文本文件，所以你需要打开它们

```
source = open("PALTemplateData.csv","r")
target = open("AnotherFile.csv","w") 
```

错误

```
_csv.Error: iterator should return strings, not bytes (did you open the file in text mode?) 
```

来是因为您以二进制模式打开它们。

当我用 python 打开 excel csv 时，我使用了类似的东西：

```
try:    # checking if file exists
    f = csv.reader(open(filepath, "r", encoding="cp1250"), delimiter=";", quotechar='"')
except IOError:
    f = []

for record in f:
    # do something with record 
```

它工作得相当快（我打开了两个大约 10MB 的 csv 文件，虽然我是用 python 2.6 做的，而不是 3.0 版本）。

在 python 中处理 excel csv 文件的工作模块很少[——pyExcelerator](http://sourceforge.net/projects/pyexcelerator)就是其中之一。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T21:22:24.543

问题是你试图写入你正在读取的同一个文件。写入不同的文件，然后在删除原始文件后重命名。

# c++ - 学习用于游戏编程的 C++ 的资源

> ID：1020054
> 
> 赞同：4
> 
> 时间：2009-06-19T21:17:13.087
> 
> 标签：c++, game-development

我是 C++ 方面的新手，在游戏行业工作了几个月。我希望重返这个行业，并了解一个人需要成为一名非常优秀的 C++ 程序员（主要是因为进入游戏制作行业的竞争力有多大）。我想知道是否有任何非常好的在线网站可以对此有所帮助。基本上，我正在寻找可以帮助我掌握 C++ 概念并通过练习编程示例帮助我成为一名优秀编码人员的东西。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-19T21:20:56.463

Scott Meyers 的书籍：《Effective C++》、《More Effective C++》和《Effective STL》对你来说绝对是必不可少的。

添加到 Andrei Alexandrescu 的“现代 C++ 设计”。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-19T21:56:29.077

有人曾经说过，学习 C++ 需要 10 年。拥有 14 年的 C++ 经验并且仍然经常学习新事物，我会说这是真的。即使在我拥有丰富的经验之后，我也会犹豫称自己为 C++ 专家。不要指望一夜之间掌握它......你会经历许多你*认为*你掌握它的阶段，然后你会发现一个全新的世界（因为没有更好的术语；我相信理查德道金斯将这个过程称为“提高意识”）。我已经开始接受这些顿悟中的另一个总是在我之前，因此我为什么不称自己为专家。

也就是说，你必须练习练习练习。我将成为 Gamedev.net 的第 2 名（或第 3 名或第 4 名，无论我们现在处于什么位置）。那天我在那里度过了很多时间......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-19T21:19:38.463

[游戏开发网](http://www.gamedev.net/)。

在参考资料中，有一个“初学者”部分。通读所有这些！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-19T21:51:23.063

[C++ FAQ Lite](http://www.parashift.com/c++-faq-lite/)很好。你可以从那个网站学到很多东西，还有一本相关的书也很好。

Scott Meyers 的书也包含非常好的具体建议。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-20T00:49:04.733

C++ 是一门很棒的语言，我喜欢它。它构建了快得离谱的代码。通过充分利用分析器、分析驱动优化器、模块间优化器、const 和限制关键字、MMX/SSE/向量内在函数和其他东西，它可以构建非常快的代码。

您可能会关注大型游戏公司的工作清单，并且有*很多*C++ 需求。

也就是说，这不是开发游戏的唯一方法。我只想介绍一些替代方案。

Microsoft 的 .NET 东西运行良好。查看他们的[XNA 平台](http://msdn.microsoft.com/en-us/xna/default.aspx)。

即使使用 Java，您也可以编写很棒的游戏。有一个[Java 版本的 Quake2](http://bytonic.de/html/jake2.html)在我家的 Core I7 系统上的某些区域可以达到 1,000 FPS。大部分繁重的工作当然是在 OpenGL 和图形驱动程序中。

很多人都在用 Flash 编写有趣的游戏，它的语言性能比 Java 或 .NET 差得多。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-19T21:20:58.727

我完全推荐 Brucke Eckel 的：Thinking in C++

你可以在他的网页上免费下载。

[http://www.mindview.net/Books/TICPP/ThinkingInCPP2e.html](http://www.mindview.net/Books/TICPP/ThinkingInCPP2e.html)

这应该可以帮助您掌握 C++，从那里，您可以开始阅读引擎中的代码，例如 Ogre3D，这将是一个更好的学习。

稍后，您应该查看 GameDev.net 上的书籍，它们真的很酷。但在我看来，在 GameDev 中找到的文章已经过时了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-19T21:20:32.283

www.gamdev.net 是游戏编程的绝佳资源。

我还推荐[游戏编程宝石系列](https://rads.stackoverflow.com/amzn/click/com/1584500492)。

就掌握 C++ 概念而言，谁比创建 C++ 的人更值得学习呢？他写道：[C++ 编程语言](https://rads.stackoverflow.com/amzn/click/com/0201889544)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-19T21:25:00.137

一种重新进入并同时获得乐趣的方法是阅读 Nehe[的 OpenGL](http://nehe.gamedev.net/)教程，或者使用更高级别的游戏框架，例如[Irrlicht](http://irrlicht.sourceforge.net/)或[Ogre3D](http://www.ogre3d.org/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-25T13:49:29.683

[Bjarne Stroustrup的 C++ 编程语言](http://www.research.att.com/~bs/3rd.html) 。

我用这个直到今天。它包含对 C++ 语言所有特性的简洁描述。当我在网上搜索这些信息时，它的蓬勃发展超出了清晰的理解。Bjarne 在明确定义语言的所有原则方面做得非常好，这是必须的。我没有读过整本书，但我读过小节。

（还对 Effective C++、Effective STL 和[Exceptional C++](http://www.gotw.ca/publications/xc++.htm) (Sutter) 投了赞成票）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-19T21:24:15.833

[您应该在http://www.geometrictools.com/](http://www.geometrictools.com/)查看 wildmagic 。这是一个不错的游戏引擎，有很多示例代码和相关书籍。我强烈推荐它作为对 C++ 游戏引擎的深入研究。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-19T21:24:53.837

我通过以下书籍学习了 C++（之前没有编码经验）：

Brian Overland 的“C++ 无所畏惧”

《Sams 24 小时自学 C++》第四版

和

Jonathan S. Harbor 的“通过 C++ 开始游戏编程”第二版

第一个非常好，非常详细，如果阅读有点慢。第二个我主要用作参考，最后一个非常有用且易于阅读，但它经常使用“超出本书范围”这个短语。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-20T20:28:23.477

我建议从基础开始：

C 编程语言，作者 Kernigan 和 Ritchie。通过这本书，您将比其他人更接近 C 的内部结构。然后，您可以阅读 C++ 书籍。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-19T22:59:46.310

以上是学习C++和游戏的好建议……

如果您只是想在没有大量编程背景的情况下制作游戏，我会给您推荐软件...

您可以快速制作简单的游戏，然后学习制作严肃游戏所需的 C++ 和其他语言……

软件：

游戏制作者

[http://www.yoyogames.com/make](http://www.yoyogames.com/make)

游戏工厂 2

[http://www.clickteam.com/eng/tgf2.php](http://www.clickteam.com/eng/tgf2.php)

图书

想象自己创造视频游戏，第 1 版

很棒的游戏创作：无需编程，第 3 版

在几分钟内制作出令人惊叹的游戏，第 1 版

祝你好运...

# javascript - 如何通过 Google 图表 API 使用 X 轴中的日期？

> ID：1020061
> 
> 赞同：40
> 
> 时间：2009-06-19T21:19:03.037
> 
> 标签：javascript, asp.net, vb.net, google-visualization

有没有办法使用 Google 图表 API 绘制图表，以便 X 轴值是一个月中的天数？

我有不同频率提供的数据点。例如：

```
Date - Value
1/1/2009 - 100
1/5/2009 - 150
1/6/2009 - 165
1/13/2009 - 200
1/20/2009 - 350
1/30/2009 - 500 
```

我想制作一个图表，将每个数据点与基于一个月内的时间的相对距离分开。这可以用 Excel 完成，但我怎样才能用谷歌图表计算和显示呢？

也欢迎其他类似于 Google 图表的免费解决方案或可与 ASP.NET 一起使用的免费库。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-19T21:44:09.367

> **更新**现在使用高级图表“注释图表”功能直接在图表 API 中支持 - [https://developers.google.com/chart/interactive/docs/gallery/annotationchart](https://developers.google.com/chart/interactive/docs/gallery/annotationchart)

我已经在我的~~[ReHash 数据库统计](http://rehash.dustinfineout.com/db_stats.php "ReHash 数据库统计")~~图表上做到了这一点（即使日期被证明是均匀分布的，所以它并不能完全证明它正在这样做）。

首先，您想要获得您的**整体时间段**，这将类似于您的图表的整体宽度。为此，我们从最晚的日期中减去最早的日期。我更喜欢使用 Unix 纪元时间戳，因为它们是整数并且易于以这种方式进行比较，但您可以轻松计算秒数等。

现在，遍历您的数据。对于每个日期，我们想要从开始的日期在整个期间的*百分位数*（即最早的日期是 0，最晚的日期是 100）。对于每个日期，您首先要计算**当前日期**与数据集中最早日期的距离。本质上，“我们离一开始还有多远”。因此，从当前日期中减去最早的日期。然后，为了找到百分位数，我们将**当前日期的距离**除以**整个时间段**，然后乘以 100 并截断或四舍五入任何小数，得到我们的积分**x 坐标**。

就这么简单！您的 x 值范围从 0（图表的左侧）到 100（右侧），并且每个数据点将位于与其真实时间距离相对应的起点的距离处。

如果您有任何问题随时问！如果需要，我可以发布伪代码或 PHP。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-10-30T19:36:02.300

我遇到了同样的问题，在 Google Charts 上找到了[散点图](http://code.google.com/apis/ajax/playground/?type=visualization#scatter_chart)，它确实是必要的。

这是我最终得到的代码（以他们的作为起点）：

```
function drawVisualization() {
    // Create and populate the data table.
    var data = new google.visualization.DataTable();
    data.addColumn('date', 'Date');
    data.addColumn('number', 'Quantity');
    data.addRow([new Date(2011, 0, 1), 10])
    data.addRow([new Date(2011, 1, 1), 15])
    data.addRow([new Date(2011, 3, 1), 40])
    data.addRow([new Date(2011, 6, 1), 50])

    // Create and draw the visualization.
    var chart = new google.visualization.ScatterChart(
        document.getElementById('visualization'));
    chart.draw(data, {title: 'Test',
                      width: 600, height: 400,
                      vAxis: {title: "cr", titleTextStyle: {color: "green"}},
                      hAxis: {title: "time", titleTextStyle: {color: "green"}},
                      lineWidth: 1}
              );
} 
```

请注意，它们似乎从 0 开始计算月份，即一月是 0，二月是 1，...，十二月是 11。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-04-12T20:03:57.993

看起来您现在可以使用高级图表执行此操作：

[http://code.google.com/apis/visualization/documentation/gallery/annotatedtimeline.html](http://code.google.com/apis/visualization/documentation/gallery/annotatedtimeline.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T21:32:15.177

这可以很容易地用谷歌图表完成，但你的应用程序必须计算标签

chxl chart x label 参数是您需要的参数。以下示例用 50 步的数字标记 y 轴，底部用日期标记

```
chxl=0:|0|50|100|150|200|250|300|350|400|450|500|1:|16/01/2009|26/01/2009|6/02/2009 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-23T09:59:42.973

海。我的想法和你一样。我可以预见标签相互覆盖的问题，并且只能想到两种方法。

1) 根据格式（周一/周二、周一/周二、1 月 1 日/2 月 1 日、1 月 1 日、2 月 29 日、2010 年 2 月 14 日等）计算出每个日期中有多少个字符，然后计算有多少标签你可以适应你的图表宽度（这可能会变得粗糙，涉及以像素为单位的字符宽度（对于固定字体更容易），或者只是一些试验和错误）。

当然，您的标签可能会直接与任何数据对齐。

2) 使用多个 X 轴标签并垂直放置日期。

# objective-c - 什么时候定义objective-c方法？

> ID：1020070
> 
> 赞同：34
> 
> 时间：2009-06-19T21:21:24.577
> 
> 标签：objective-c, declaration, definition, api-design

我正在学习 Objective-C，并且有 C/C++ 背景。

*   在面向对象的 C++ 中，您总是需要在定义（实现）方法之前声明您的方法，即使它是在父类中声明的。

*   在过程风格的 C、IIRC 中，您可以只定义一个函数，只要它仅从稍后出现在文件中的同一编译单元（即同一文件）中的其他东西调用（好吧，提供您不会在其他地方用“extern”声明它）。

*   现在，在 Objective-C 中，您似乎只需要在头文件中声明选择器（如果它们将被外部使用），并且您可以在 .m 文件中很好地构建选择器，并在其中调用它们.m 文件。此外，似乎从未（重新）定义委托方法或继承方法。

我在正确的轨道上吗？什么时候需要在 Objective-C 中定义选择器？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-06-19T22:32:04.620

对于 Objective-C 方法，一般做法是将您希望公开的方法放在`@interface`头文件的部分中，以便其他代码只能包含 .h 并知道如何与您的代码交互。基于顺序的“惰性声明”就像 C 中的函数一样工作——您不必**声明**方法原型，除非您有无法通过排序解决的依赖项，但`@implementation`如果需要，您可以在其中添加方法原型。

所以是的，你在正确的轨道上。不要为继承的方法重复方法原型——编译器会在父类的头文件中找到它。委托方法可以定义为类别中的原型（附加到类上）并根据需要实现，但委托不需要提供方法原型，因为它已经定义。（为了清楚起见，它仍然可以，等等。）

*由于您只是在学习 Objective-C，因此此答案的其余部分比您要求的要详细得多。你被警告了。;-)*

* * *

当您静态键入一个变量（例如`MyClass*`，而不是`id`）时，当您尝试调用一个类没有宣传它实现的方法时，无论它是否实现，编译器都会警告您。如果您动态键入变量，编译器不会阻止您调用您喜欢的任何内容，并且只有在调用不存在的内容时才会出现运行时错误。就语言而言，您可以在运行时调用类实现的任何方法而不会出错——没有办法限制谁可以调用方法。

就个人而言，我认为这实际上是一件好事。我们非常习惯于封装和保护我们的代码免受其他代码的影响，以至于我们有时将调用者视为狡猾的恶棍，而不是值得信赖的同事或客户。我发现以“你做你的工作，我做我的工作”的心态来编码是非常愉快的，每个人都尊重界限并照顾自己的事情。你可能会说，Objective-C 的“态度”是一种社区信任，而不是严格执行。例如，我很乐意帮助任何来到我办公桌前的人，但如果有人在没有询问的情况下弄乱我的东西或移动东西，我会非常生气。精心设计的代码不一定是偏执或反社会的，它只需要很好地协同工作。:-)

也就是说，有很多方法可以构建界面，具体取决于您在向用户公开界面时想要/需要的粒度级别。您在公共标头中声明的任何方法本质上都是公平的游戏，任何人都可以使用。隐藏方法声明有点像锁住你的车或房子——它可能不会让每个人都被拒之门外，但是（1）它“让诚实的人保持诚实”，不会用他们不应该搞砸的东西来诱惑他们，以及（2 ）任何进入的人肯定会知道他们*不*应该这样做，并且不能真正抱怨负面后果。

以下是我用于文件命名的一些约定，以及每个文件中的内容——从底部的 .m 文件开始，每个文件都包含它上面的文件。（使用严格的包含链将防止出现重复符号警告等情况。）其中一些级别仅适用于较大的可重用组件，例如 Cocoa 框架。根据您的需要调整它们，并使用适合您的任何名称。

*   `MyClass.h`— 公共 API（应用程序编程接口）
*   `MyClass_Private.h`— 公司内部 SPI（系统编程接口）
*   `MyClass_Internal.h`— 项目内部 IPI（内部编程接口）
*   `MyClass.m`— 实现，通常是所有 API/SPI/IPI 声明
*   `MyClass_Foo.m`— 附加实现，例如类别

API 是供大家使用的，并且是公开支持的（通常在 中`Foo.framework/Headers`）。SPI 为您的代码的内部客户端公开了额外的功能，但要理解支持可能会受到限制，并且接口可能会发生变化（通常在 中`Foo.framework/PrivateHeaders`）。IPI 由特定于实现的细节组成，这些细节绝不应该在项目本身之外使用，并且这些标头根本不包含在框架中。任何选择使用 SPI 和 IPI 调用的人都需要自担风险，并且通常会在更改破坏代码时损害他们的利益。:-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T21:31:36.723

在头文件中声明方法只会停止编译器警告。Objective-C 是一种动态语言，因此无论该方法是否在外部声明，您都可以向对象调用方法（发送消息）。

此外，如果您在调用它的任何代码（惰性声明）上方的 .m 文件中定义方法，则不会生成任何警告。然而，同样的事情也适用，您可以在不声明对象的情况下向对象发送消息。

当然——这意味着在 Objective-C 中没有私有方法。可以调用类实现的任何方法。

个人喜好。如果它是一种公共方法（即外部使用的方法）。在 .h 中声明它并在 .m 中定义。如果您想限制它的可见性，或者至少表明它是私有方法，请在 .m 文件中使用[类别/类扩展名。](https://stackoverflow.com/questions/360968/)尽管许多示例代码使用惰性声明方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T21:36:07.930

Objective-C 将函数视为“消息”，因此，您可以向任何对象发送“消息”——即使是在其接口中没有明确声明它可以接受的对象。因此，在 Obj-C 中没有私有成员之类的东西。

这可能非常强大，但对于新的 Obj-C 程序员来说是一个混乱的根源——尤其是那些来自 C++、Java 或 C# 的程序员。以下是基本的经验法则：

*   您应该在 @interface 中定义所有公共方法，以便消费者知道您希望处理哪些消息。
*   您应该在@interface 中定义@private 方法以避免编译器消息并避免必须在@implementation 中对方法进行排序。
*   在为您的类实现特定的方法约定时，您应该使用协议。

这在很大程度上是个人喜好，但它有助于避免烦人的编译器警告并保持您的代码井井有条。并且易于理解。

# c# - 单击asp.net链接按钮将焦点设置在页面顶部

> ID：1020073
> 
> 赞同：0
> 
> 时间：2009-06-19T21:22:04.840
> 
> 标签：c#, asp.net

我有一个显示客户订单详细信息的 asp.net 数据网格。网格底部的分页是使用 datalist 和 asp.net Linkbutton 控件完成的。这是代码：

```
<asp:DataList ID="DataList2" runat="server" CellPadding="1" CellSpacing="1" 
        OnItemCommand="DataList2_ItemCommand" 
        OnItemDataBound="DataList2_ItemDataBound" RepeatDirection="Horizontal">
    <ItemTemplate>
        <asp:LinkButton ID="lnkbtnPaging" runat="server" 
             CommandArgument='<%# Eval("PageIndex") %>'
             CommandName="lnkbtnPaging" 
             Text='<%# Eval("PageText") %>' />
        <asp:Label runat="server" ID="lblPageSeparator" Text=" | " name=></asp:Label>
    </ItemTemplate>
</asp:DataList> 
```

当用户单击任何页码（即链接按钮）时，我需要将焦点设置在页面顶部。

我该怎么做呢？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T23:54:46.140

我认为默认行为是将页面滚动位置设置回页面顶部。您的页面中是否还有其他内容可能会覆盖此行为？

例如：

1.  您的 DataList 是否在 UpdatePanel 中？在这种情况下，当前滚动位置将在（部分）回发上保持。因此，您需要自己将滚动位置重置为页面顶部。一种方法是为 PageRequestManager 的 EndRequest 客户端事件实现一个处理程序，该事件将设置滚动位置 - 这个线程解释了[如何](https://stackoverflow.com/questions/616210/reset-scroll-position-after-async-postback-asp-net)
2.  Page MaintainScrollPositionOnPostBack 属性是否设置为 true？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T21:38:29.657

您可以尝试在页面顶部设置一个命名锚点。这是一篇解释它的文章[http://www.w3schools.com/HTML/html_links.asp](http://www.w3schools.com/HTML/html_links.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-29T07:31:35.250

在 AJAX 部分回发之后，您可能需要返回到 ASPX 页面的顶部以显示错误消息等。这是我完成的一种方法。您可以将下面的 JavaScript 函数添加到您的 ASPX 页面，然后在需要时使用 ScriptManager.RegisterClientScriptBlock 方法在代码隐藏中调用该方法。ASP.NET C# 代码隐藏：

```
ScriptManager.RegisterClientScriptBlock(this, Page.GetType(), 
 "ToTheTop", "ToTopOfPage();", true); 
```

JavaScript：

```
<script type="text/javascript">
function ToTopOfPage(sender, args) {
    setTimeout("window.scrollTo(0, 0)", 0);
} 
```

`OnClientClick`您也可以只使用 JavaScript 使用按钮的属性滚动到页面顶部。但这将导致每次单击按钮时都会发生此行为，而不仅仅是在您希望它发生时。例如： `<asp:Button id="bntTest" runat="server" Text="Test" OnClick="btn_Test" OnClientClick="javascript:window.scrollTo(0,0);" />`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-23T18:09:37.693

```
<asp:LinkButton ID="lbGonder" runat="server" CssClass="IK-get" ValidationGroup="ik" OnClick="lbGonder_Click" OnClientClick="ddd();" title="Gönder">Gönder</asp:LinkButton>`
<script type="text/javascript">
var ddd = (function () {
    $('body,html').animate({
        scrollTop: 300
    }, 1453);
    return false;
}); 
```

# javascript - 将 Firefox 窗口置于全屏模式

> ID：1020100
> 
> 赞同：2
> 
> 时间：2009-06-19T21:26:49.307
> 
> 标签：javascript

我已经计划了一个 Intranet Ajax 应用程序，我想把它置于全屏模式，这样它看起来就像一个真正的独立应用程序。

我的问题是，使用 Firefox 3`window.open`将窗口置于全屏模式的选项效果不佳。我总是有磁贴栏、网址栏和状态栏。

有没有办法隐藏那些酒吧？

我记得不太清楚，有一种方法可以以用户可以接受的签名方式编写脚本......

任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T21:53:16.990

这根本不可能，如果是的话，这将是一个巨大的安全风险，网络钓鱼诈骗会更加成功。

要获得更真实的独立应用程序的感觉，也许您应该看看[Mozilla Prism](http://prism.mozilla.com)以用作您的 ajax Web 应用程序的客户端。

# nhibernate - NHibernate 入门

> ID：1020128
> 
> 赞同：1
> 
> 时间：2009-06-19T21:34:20.447
> 
> 标签：nhibernate

我正在尝试在 NHibernate 中开发我的 Hello World 程序。

我的代码如下：

```
MyClass.cs
----------
using System.Collections.Generic;
using System.Text;
using System;
using NHibernate.Collection;
using NHibernate.Mapping;
using Iesi.Collections;

namespace NHibernate__MyClass
{
    public class MyClass 
    {
        int id;
        string name;
        int _value;

        public MyClass()
        {
            id = 0;
            name = "";
            _value = 0;
        }

        public virtual int Id
        {
            get { return id; }
            set { id= value; }
        }

        public virtual string Name
        {
            get { return name; }
            set { name= value; }
        }

        public virtual int Value
        {
            get { return _value; }
            set { _value= value; }
        }
    }
}

MyClass.hbm.xml
---------------
<?xml version="1.0" encoding="utf-8" ?>

<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="NHibernate__MyClass" assembly="NHibernate__MyClass">
  <class name="MyClass" table="MyClass">
    <id name="Id">
      <column name="ID" sql-type="int" not-null="true"/>
      <generator class="native" />
    </id>
    <property name="Name">
      <column name="Name" not-null="true" />
    </property>
    <property name="Value">
      <column name="Value" not-null="true" />
    </property>
  </class>
</hibernate-mapping>

Program.cs
----------
using System;
using System.Collections.Generic;
using System.Text;

using NHibernate;
using NHibernate.Cfg;

namespace NHibernate__MyClass
{
    class Program
    {
        static void Main(string[] args)
        {
            MyClass myClass = new MyClass();
            myClass.Id = 1;
            myClass.Name = "Hello World!";
            myClass.Value = 100;

            ISessionFactory sessionFactory = new Configuration().Configure().BuildSessionFactory();
            ISession session = sessionFactory.OpenSession();

            session.BeginTransaction();
            session.Save(myClass);
            session.Transaction.Commit();

            Console.ReadLine();
        }
    }
}

App.config
----------
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <section
    name="hibernate-configuration"
    type="NHibernate.Cfg.ConfigurationSectionHandler, NHibernate"
/>
  </configSections>

  <hibernate-configuration xmlns="urn:nhibernate-configuration-2.2">
    <session-factory>
      <property name="dialect">NHibernate.Dialect.MsSql2000Dialect</property>
      <property name="connection.provider">NHibernate.Connection.DriverConnectionProvider</property>
      <property name="connection.connection_string">Data Source=.\SQLEXPRESS;Initial Catalog=NHibernate;Integrated Security=True</property>
      <mapping assembly="NHibernate__MyClass" />
    </session-factory>
  </hibernate-configuration>
</configuration>

SQL Table
---------
CREATE TABLE [dbo].[MyClass](
    [ID] [int] NOT NULL,
    [Name] [varchar](50) NOT NULL,
    [value] [int] NOT NULL
) ON [PRIMARY] 
```

但是这个程序正在生成一个异常：

异常消息：{“无法插入：[NHibernate__MyClass.MyClass][SQL: INSERT INTO MyClass (Name, Value) VALUES (?, ?); select SCOPE_IDENTITY()]”}

内部异常消息：{“无法将值 NULL 插入 'ID' 列，表 'NHibernate.dbo.MyClass'；列不允许空值。INSERT 失败。\r\n语句已终止。”}

可能是什么问题？

NHibernate DLL 版本 = 2.0.0.2002

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T21:36:48.553

因为你的映射文件中有这个标签

```
<generator class="native" /> 
```

在 SQL 中，您需要将该表中的 ID 字段设置为标识。

您也可以让 nHibernate 生成身份字段。

# silverlight-2.0 - Silverlight 2：在 ADO.NET 数据服务 DataServiceContext 上设置超时

> ID：1020129
> 
> 赞同：0
> 
> 时间：2009-06-19T21:34:25.033
> 
> 标签：silverlight-2.0, wcf-data-services

我无法弄清楚如何在从 Silverlight 客户端调用的 ADO.NET 数据服务上设置超时。我看到博客文章提到 DataServiceContext 基类的超时属性。

[http://blogs.msdn.com/astoriateam/archive/2009/01/13/timeout-workaround.aspx](http://blogs.msdn.com/astoriateam/archive/2009/01/13/timeout-workaround.aspx)

但是当我尝试在我的 DataServiceContext 上设置 Timeout 属性时 - 但该属性不存在。

任何人都知道设置超时的其他方法 - 否则 Silverlight 应用程序将永远坐在那里等待。

我确信有一种方法可以在调用服务的异步方法上设置超时，但我不想在每个方法调用上都设置它 - 我会在服务级别处理它

谢谢迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T21:42:38.853

```
<configuration>
<system.serviceModel>
    <bindings>
        <basicHttpBinding>
            <binding name="AllocationsDataServiceSoap" maxBufferSize="2147483647"
                maxReceivedMessageSize="2147483647" **receiveTimeout=""**>
                <security mode="None" />
            </binding>
        </basicHttpBinding>
    </bindings>
    <client>
        <endpoint address=""
            binding="basicHttpBinding" bindingConfiguration="AllocationsDataServiceSoap"
            contract="AllocationsDataWebService.AllocationsDataServiceSoap"
            name="AllocationsDataServiceSoap" />
    </client>
</system.serviceModel> 
```

绑定标记内 clientconfig.xml 中的 recievetimeout 属性

编辑：当您添加服务引用时，此 xml 文件会在您的项目根目录中创建

# git - 如何反向应用存储？

> ID：1020132
> 
> 赞同：279
> 
> 时间：2009-06-19T21:34:59.243
> 
> 标签：git, git-stash

我有一个小补丁保存在我的 git stash 中。我已经将它应用到我的工作副本中，使用`git stash apply`. 现在，我想通过反向应用补丁来取消这些更改（有点像`git revert`会做的事情，但针对存储）。

有谁知道如何做到这一点？

**澄清：**我的工作副本还有其他变化。我的特殊情况很难描述，但您可以想象隐藏中的一些调试或实验代码。现在它在我的工作副本中与其他一些更改混合在一起，我想看看有没有来自存储的更改的效果。

stash 目前似乎不支持此功能，但 a`git stash apply --reverse`将是一个不错的功能。

* * *

## 回答 #1

> 赞同：212
> 
> 时间：2009-06-20T15:39:33.197

根据[git-stash 手册页](http://git-scm.com/docs/git-stash)，“存储被表示为一个提交，其树记录工作目录的状态，其第一个父级是`HEAD`创建存储时的提交”，并`git stash show -p`为我们提供“记录在stash 作为隐藏状态与其原始父级之间的差异。

要保持其他更改不变，请`git stash show -p | patch --reverse`按以下方式使用：

```
$ git init
Initialized empty Git repository in /tmp/repo/.git/

$ echo Hello, world >messages

$ git add messages

$ git commit -am 'Initial commit'
[master (root-commit)]: created 1ff2478: "Initial commit"
 1 files changed, 1 insertions(+), 0 deletions(-)
 create mode 100644 messages

$ echo Hello again >>messages

$ git stash

$ git status
# On branch master
nothing to commit (working directory clean)

$ git stash apply
# On branch master
# Changed but not updated:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#
#       modified:   messages
#
no changes added to commit (use "git add" and/or "git commit -a")

$ echo Howdy all >>messages

$ git diff
diff --git a/messages b/messages
index a5c1966..eade523 100644
--- a/messages
+++ b/messages
@@ -1 +1,3 @@
 Hello, world
+Hello again
+Howdy all

$ git stash show -p | patch --reverse
patching file messages
Hunk #1 succeeded at 1 with fuzz 1.

$ git diff
diff --git a/messages b/messages
index a5c1966..364fc91 100644
--- a/messages
+++ b/messages
@@ -1 +1,2 @@
 Hello, world
+Howdy all 
```

**编辑：**

对此的轻微改进是使用`git apply`代替补丁：

```
git stash show -p | git apply --reverse 
```

或者，您也可以`git apply -R`用作`git apply --reverse`.

最近发现这个真的好用。。。

* * *

## 回答 #2

> 赞同：157
> 
> 时间：2016-11-06T05:44:31.477

```
git checkout -f 
```

将删除任何未提交的更改。

* * *

## 回答 #3

> 赞同：89
> 
> 时间：2009-06-19T23:22:22.600

[`git stash`](http://git-scm.com/docs/git-stash)`[save]`获取您的工作目录状态和索引状态，并将它们隐藏起来，将索引和工作区设置为`HEAD`版本。

`git stash apply`带回这些更改，因此`git reset --hard`将再次删除它们。

`git stash pop`带回这些更改并删除顶部隐藏的更改，因此`git stash [save]`在这种情况下将返回到以前的（弹出前）状态。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2015-04-23T06:30:01.043

V1 git 手册页有一个关于取消应用存储的参考。摘录如下。

较新的 V2 [git 手册页](https://git-scm.com/book/en/v2/Git-Tools-Stashing-and-Cleaning)不包含对取消应用存储的任何引用，但以下内容仍然有效

**取消应用** 存储 在某些用例场景中，您可能希望应用存储的更改，做一些工作，然后取消应用最初来自存储的更改。Git 没有提供这样的 stash un-apply 命令，但可以通过简单地检索与 stash 关联的补丁并反向应用它来实现效果：

```
$ git stash show -p stash@{0} | git apply -R 
```

同样，如果您不指定存储，Git 会假定最近的存储：

```
$ git stash show -p | git apply -R 
```

您可能想要创建一个别名并有效地将 stash-unapply 命令添加到您的 Git。例如：

```
$ git config --global alias.stash-unapply '!git stash show -p | git apply -R'
$ git stash apply
$ #... work work work
$ git stash-unapply 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2014-04-22T09:13:26.457

这早就到期了，但是如果我正确解释了问题，我找到了一个简单的解决方案，请注意，这是我自己的术语的解释：

`git stash [save]`将保存当前更改并将当前分支设置为“干净状态”

`git stash list`给出类似的东西：`stash@{0}: On develop: saved testing-stuff`

`git apply stash@{0}`**将像以前**一样设置当前分支 **`stash [save]`**

 **`git checkout .`将当前分支设置为**之后** `stash [save]`

保存在 stash 中的代码不会丢失，可以`git apply stash@{0}`再次找到。

不管怎样，这对我有用！

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-09-15T16:39:44.587

> 如何反向应用存储？

除了其他人提到的，最简单的方法是先做

```
git reset HEAD 
```

然后检查所有本地更改

```
git checkout . 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-05-03T11:53:49.893

如果您不小心点击了存储，您可以按照我分享的图像取消存储。

![](../Images/8ac6228225c8b0dbe61466ccb8c0ce86.png)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-10-17T19:59:51.880

除了@Greg Bacon 回答之外，如果二进制文件被添加到索引中并且是使用的存储的一部分

```
git stash show -p | git apply --reverse 
```

可能导致

```
error: cannot apply binary patch to '<YOUR_NEW_FILE>' without full index line
error: <YOUR_NEW_FILE>: patch does not apply 
```

添加`--binary`解决了这个问题，但不幸的是还没有弄清楚为什么。

```
 git stash show -p --binary | git apply --reverse 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-07-16T20:15:55.547

你可以应用两个命令

`git reset .`// 反转文件

然后

`git checkout .` // 反转更改

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-06-05T16:21:21.373

这是对上述答案的补充，但会根据消息添加对 git stash 的搜索，因为在保存新的存储时存储编号可能会更改。我写了几个 bash 函数：

```
apply(){
  if [ "$1" ]; then
    git stash apply `git stash list | grep -oPm1 "(.*)(?=:.*:.*$1.*)"`
  fi
}
remove(){
  if [ "$1" ]; then
    git stash show -p `git stash list | grep -oPm1 "(.*)(?=:.*:.*$1.*)"` | git apply -R
    git status
  fi
} 
```

1.  使用名称创建存储（消息）`$ git stash save "my stash"`
2.  申请命名`$ apply "my stash"`
3.  删除命名存储`$ remove "my stash"`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-08-21T06:43:44.190

我自己也有类似的问题，我认为您需要做的就是`git reset --hard`您不会丢失您的更改或任何未跟踪的更改。

如果您阅读其中的文档，`git stash --help`说明 apply 是“像 pop，但不要从存储列表中删除状态”，因此状态仍然存在，您可以将其取回。

或者，如果您没有冲突，您可以`git stash`在测试更改后再次进行。

如果您确实有冲突，请不要担心，`git reset --hard`不会丢失它们，因为“应用状态可能会因冲突而失败；在这种情况下，它不会从存储列表中删除。您需要手动解决冲突并调用之后手动 git stash drop。”

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-11-09T19:53:25.213

```
git stash show -p | git apply --reverse 
```

警告，并非在所有情况下都如此：“ [`git apply -R`](https://github.com/git/git/blob/c23cd78e8127a2f80cc0357994209bc1bb81a4fe/Documentation/git-apply.txt#L104)” ^(（[man](https://git-scm.com/docs/git-apply#Documentation/git-apply.txt--R)）)没有正确处理两次正确接触同一路径的补丁，这已在 Git 2.30（2021 年第一季度）中得到纠正。

这在将路径从常规文件更改为符号链接（反之亦然）的补丁中最为相关。

请参阅[Jonathan Tan ( ) 的](https://github.com/jhowtan)[提交 b0f266d](https://github.com/git/git/commit/b0f266de11e9dc3a140ff9407a47604bef0e257f)（2020 年 10 月 20 日[）](https://github.com/jhowtan)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 c23cd78](https://github.com/git/git/commit/c23cd78e8127a2f80cc0357994209bc1bb81a4fe))^(中，2020 年 11 月 2 日）)[`jhowtan`](https://github.com/jhowtan)
^([`gitster`](https://github.com/gitster))

> ## [`apply`](https://github.com/git/git/commit/b0f266de11e9dc3a140ff9407a47604bef0e257f): 当`-R`, 也反转部分列表
> 
> ^(协助人：Junio C Hamano)
> ^(签字人：Jonathan Tan)

> 将符号链接更改为文件的补丁由 2 个部分编写（在代码中，表示为“struct patch”）：首先，删除符号链接，其次，创建文件。
> 
> 当使用 应用该补丁时`-R`，这些部分是相反的，因此我们得到：（1）创建符号链接，然后（2）删除文件。
> 
> 这会在选中“删除文件”部分时导致问题，因为 Git 观察到所谓的文件不是文件而是符号链接，从而导致“错误类型”错误消息。
> 
> 我们想要的是：（1）删除文件，然后（2）创建符号链接。
> 
> 在代码中，这反映在检查删除`previous_patch()`时调用时的行为。 创建然后删除意味着当检查删除时，返回创建部分，触发模式冲突导致“错误类型”错误消息。`check_preimage()`
> `previous_patch()`
> 
> 但是delete then creation的意思是当检查delete的时候，`previous_patch()`returns `NULL`，所以对lstat检查delete模式，这就是我们想要的。
> 
> 还有其他方法可以让补丁包含引用同一文件的 2 个部分，例如，在[7a07841c0b](https://github.com/git/git/commit/7a07841c0ba8d791dd4c7363eaf004b4a7d11fb6)中（“ `git-apply`：处理多次接触同一路径的补丁更好”，2008-06-27，Git v1.6.0-rc0 -[合并](https://github.com/git/git/commit/7ebd52aa0e58df6bac5f0f87a591da17eb3324a6)）。" [`git apply -R`](https://github.com/git/git/blob/b0f266de11e9dc3a140ff9407a47604bef0e257f/Documentation/git-apply.txt#L104)" ^(( [man](https://git-scm.com/docs/git-apply#Documentation/git-apply.txt--R) ))以同样的方式失败，这个提交使这个案例成功。
> 
> 因此，在构建节列表时，在传递时以相反的顺序构建它们（通过添加到列表的前面而不是后面）`-R`。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-12T14:12:05.963

对我来说，我刚刚在签出时输入了错误的存储库名称。所以实际上没有远程拉。

因此，除了检查大小写之外，还要检查分支名称的*拼写*，或者更好的是，复制并粘贴它 - 以排除它。**

# java - 如何在Java中将HTML textarea元素拆分为行数组

> ID：1020133
> 
> 赞同：2
> 
> 时间：2009-06-19T21:35:15.920
> 
> 标签：java, split, textarea

如何在Java中将HTML textarea元素拆分为行数组

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T21:41:04.317

如果您指的是 Java 而不是 JavaScript（假设您有一个 JSP 系统）：

```
String[] lines = myTextArea.getText().split("\\n"); 
```

或者

```
String[] lines = request.getParameter("textarea").split("\\n"); 
```

* * *

对于 JavaScript：

```
var lines = document.getElementById("myTextArea").value.split('\\n'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T21:58:30.490

在 Java 中，获取文本并将其传递给如下方法：

```
private String[] split(String s) {
        if (s==null) {
            return new String[0];
        }

        StringTokenizer st = new StringTokenizer(s,"\n");
        ArrayList list = new ArrayList();
        while (st.hasMoreElements()) {
            list.add(st.nextToken());
        }

        return (String[]) list.toArray(new String[list.size()]);
} 
```

# flash - 为什么 Sytem.totalMemory 不断增加？

> ID：1020146
> 
> 赞同：7
> 
> 时间：2009-06-19T21:39:14.353
> 
> 标签：flash, actionscript-3, memory, actionscript

我有这个空白项目，只是为了检查 System.totalMemory 变量。据我所见，我得到了这个值：

```
3076
3092
3096
3088
3092
3096
3100
3104
3108
3112
3117
3121
3125
3129
3133
3137
3141
3145
3149
...
And so on 
```

我没有打开 Flash，没有 Internet 浏览器，也没有其他 Flash 实例。

项目是空白的，只有一个静态文本，一个动态文本，叫做‘记忆’。一个***.as**文件，其中包含以下代码：

```
package{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.system.System;
    import flash.text.TextField;
    public class Test extends Sprite {
        public function Test() {
            this.addEventListener(Event.ENTER_FRAME,Loop);
        }
        public function Loop(e:Event) {
            memory.text = String(System.totalMemory);
        }
    }
} 
```

这些是我的发布设置。

![http://i.stack.imgur.com/3k1vq.png](../Images/63de04f45a3ce68a6d78507a2d7e1118.png) ![http://i.stack.imgur.com/rwM1D.png](../Images/c524cdce2b029c5185de023b087ec6e4.png)

我在 Debug 和 Published *.swf 中进行了测试，结果相同。

我对这个一无所知，所以请帮忙。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-20T21:53:39.933

我认为你有几件事错了。

首先，您的跟踪显示 totalMemory 截断最后 3 位数字（因为您没有在代码中执行此操作，我认为这是因为 TextField 宽度）。它像这样增长：3076、3092、3096 等。这些是（大约）千字节，而不是字节。然后您评论：“2 小时后的总内存：3887104。我的上帝”。现在，如果 3,887,104 是指 3,887,104 Kb，则大约是 3.8 Gb。我怀疑是这种情况，所以让我们假设您的意思是 3,887,104 字节。这大约是 3,800 Kb 或 3.8 Mb。实际上并没有那么多内存，更重要的是，与最初的 3,076 Kb 相差不远。

我认为这实际上误导了另一位发帖人，认为播放器将内存使用量增加了 4 个字节，而实际上它增加了 4,096 个字节或 4 Kb。

其次，即使代码非常简单，它确实会消耗内存。对于初学者，每次发送 ENTER_FRAME 事件时，都会创建一个 Event 对象，该对象又包含对其他对象、字符串等的引用。这需要记忆。然后，您将一个数字隐式转换为字符串（通过打印 totalMemory）。无论您是否进行显式转换，这也需要内存（如果您进行跟踪而不是使用文本字段，这同样适用）。最重要的是，从“动作脚本的角度”来看，肯定还有其他事情正在发生。

现在，我认为部分问题在于您只是在跟踪当前的 totalMemory。看着它，它似乎一直在缓慢而稳定地增长。这是真的，但你可能错过的是，GC 以较慢的速度启动并释放大量积累的内存。

如果您修改代码以计算一些东西，这一点会更加明显。

```
package{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.system.System;
    import flash.text.TextField;
    import flash.utils.getTimer;
    import flash.text.TextField;
    import flash.text.TextFormat;

    public class Test extends Sprite {

        private var peak:int            = 0;
        private var prev:int            = 0;
        private var cur:int             = 0;
        private var diff:int            = 0;
        private var decreaseCount:int   = 0;
        private var increaseCount:int   = 0;
        private var accumIncrease:int   = 0;
        private var accumDecrease:int   = 0;
        private var maxIncrease:int     = 0;
        private var maxDecrease:int     = 0;
        private var initTime:Number     = 0;
        private var elapsed:Number      = 0;

        private var time:TextField;
        private var info:TextField;

        public function Test() {
            initTime = getTimer();
            var tf:TextFormat = new TextFormat("Courier New",12);
            time = new TextField();
            time.defaultTextFormat = tf;
            time.width  = 250;
            addChild(time);
            info = new TextField();
            info.defaultTextFormat = tf;
            info.y = 15;
            info.width  = 250;
            info.height = 250;
            addChild(info);
            addEventListener(Event.ENTER_FRAME,Loop);
        }

        public function Loop(e:Event) {
            cur = System.totalMemory >> 12;

            elapsed     = (getTimer() - initTime) / 1000; 
            time.text   = "time running:        " + elapsed;

            if(cur == prev) {
                return;
            }

            if(cur > peak) {
                peak = cur;
            }

            if(cur > prev && prev > 0) {
                diff = cur - prev;
                if(diff > maxIncrease) {
                    maxIncrease = diff;
                }
                accumIncrease += diff;
                increaseCount++;
            } else if(cur < prev) {
                diff = prev - cur;
                if(diff > maxDecrease) {
                    maxDecrease = diff;
                }
                accumDecrease += diff;
                diff = -diff;
                decreaseCount++;
            }

            info.text   =   "current:           " + cur + "\n"
                        +   "previous:          " + prev + "\n"
                        +   "diff:              " + diff + "\n"
                        +   "peak:              " + peak + "\n"
                        +   "increaseCount:     " + increaseCount + "\n"
                        +   "decreaseCount:     " + decreaseCount + "\n"
                        +   "accumIncrease:     " + accumIncrease + "\n"
                        +   "accumDecrease:     " + accumDecrease + "\n"
                        +   "maxIncrease:       " + maxIncrease + "\n"
                        +   "maxDecrease:       " + maxDecrease;

            prev    = cur;

        }
    }
} 
```

我使用 4096 字节的块作为单位（这就是为什么我在做 System.totalMemory >> 12。只是说 System.totalMemory / 4096 的一种奇特方式）。我认为它更易于管理，无论如何，totalMemory 总是返回 4096 字节或 4kb 的倍数。您可以在此处阅读有关 Flash GC 的更多信息：[https](https://developer.mozilla.org/en/MMgc) ://developer.mozilla.org/en/MMgc 。播放器的那部分是开源的，如果您愿意，甚至可以阅读源代码。

关于代码跟踪内容的简要说明：

*   **运行时间：** 自 swf 开始运行以来经过的秒数
*   **current：** System.totalMemory 返回的内存量，以 4 Kb 为单位
*   **previous：** totalMemory 的上一个值
*   **diff：** 当前和上一个之间的差异。可能是负面的。这会向您显示内存使用量相对于之前的值是增加还是减少。
*   **峰：** 自我解释。这不是很重要。
*   **increaseCount：** 当前比以前大的次数。基本上，它告诉你 totalMemory 增加了多少次，至少 1 个块。
*   **减少计数：** 先前大于当前的次数。这会告诉你内存被释放了多少次。
*   **accumIncrease：** 正差异的累积值。会让你知道已经分配了多少块。
*   **accumDecrease：** 负差异的累积值。会让你知道有多少块已经被释放。
*   **maxIncrease：** 在两次循环执行中分配的最大块数。
*   **maxDecrease：** 两次循环执行中释放的最大块数。

现在，让我们看一下使用此代码拍摄的一些“快照”。

这是早期的快照，在 swf 运行 3 秒时拍摄。请注意，电流读数为 760。

*   运行时间：3秒
*   当前：760
*   上一个：759
*   差异：1
*   峰值：760
*   增加计数：3
*   减少计数：0
*   累积增加：6
*   累积减少：0
*   最大增加：3
*   最大减少：0

大约 10 分钟后：

*   运行时间：574 秒
*   当前：763
*   上一个：762
*   curDiff: 1
*   峰值：834
*   增加计数：127
*   减少数：3
*   累计增加：132
*   累计减少：123
*   最大增加：3
*   最大减少：72

有几点需要注意：

1.  大约 10 分钟后，电流非常接近 3 秒时的情况：763 vs 760。这意味着现在，总内存为 3.052 Mb；在 3 秒时，它是 3,040 Mb。
2.  增加计数高，减少计数低。这意味着播放器已经分配了很多次内存，但非常谨慎地释放它。
3.  maxIncrease 低，maxDecrease 高。将其添加到 2) 中，您就有了一个有趣的模式：玩家经常分配少量块。它以慢得多的速度释放它们；但是，当它这样做时，它会释放大量的块。
4.  accumIncrease 和 accumDecrease 也非常接近。

现在，让 swf 运行更多时间。运行 50 分钟后，快照如下所示：

*   运行时间：2989 秒
*   当前：931
*   上一个：930
*   差异：1
*   峰值：931
*   增加计数：690
*   减少数：8
*   累计增加：699
*   累计减少：522
*   最大增加：3
*   最大减少：163

在这一点上，您可能会认为有泄漏。请注意当前内存是 931，而不是最初的 760。

但是看看在 3124 秒，约 52 分钟发生了什么：

*   运行时间：3142 秒
*   当前：767
*   上一个：768
*   差异：-1
*   峰值：962
*   增加计数：720
*   减少数：10
*   累计增加：730
*   累计减少：717
*   最大增加：3
*   最大减少：194

在 GC 开始之前，峰值增长到 962。但在那之后，电流又下降到 767，再次非常接近最初的 760。

因此，总而言之，内存使用量增加的事实并不一定意味着存在泄漏。您只需要处理播放器被垃圾收集的事实，并且该过程是不确定的。内存最终会在某个时候被回收（当然，除非您的代码确实存在泄漏）。您无法确定何时会发生这种情况。它会在玩家确定有必要时发生。总的来说，玩家知道得更好。

也就是说，我认为注意代码中可能存在的泄漏很重要。但是仅仅跟踪 System.totalMemory 并不能帮助您确定这一点。如果可以，请使用诸如 Flex Builder 的内存分析器之类的工具，它并不完美，但可以为您提供更多有用的信息。在向舞台添加侦听器和使用计时器时要小心，这是 Flash 播放器中内存泄漏的最大罪魁祸首。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T04:53:50.997

您可能想查看您正在运行的 Flash 播放器的版本。如果您安装了 IDE，那么您很有可能在播放器的调试版本中运行 - 与普通播放器相比，它几乎不会经常（如果有的话）释放内存。

如果您在调试播放器中运行，您可以强制执行 gc 扫描 - System.gc();

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T21:57:30.273

随着文本字段中的文本发生变化，Flash 必须将不同的字符加载到内存中才能显示它们。这可以解释你得到的几百字节的增加。

不理会，足迹会变大多少？

更新：考虑到这一点，我认为这与为 Flash 创建以呈现文本的临时位图图形有关……尽管您不会期望使用跟踪...尽管跟踪也必须做一些内部事情...

您是否想过在 FlexBuilder 中运行它？它有一个分析工具，可以告诉你记忆的去向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T22:52:42.910

据我所知，在每个循环中，对 System.totalMemory 的调用都会返回一个 uint，它表示 Flash 当前使用的内存量（以字节为单位）。调用 System.totalMemory 返回的 uint 存储在内存中（即您的 RAM，而不是您标记为“内存”的 textField）。然后更新 memory.text 引用以指向 uint 占用的内存空间。旧的 uint 仍在内存中，但没有引用它。Uint 是 32 位（4 字节）的数据，因此您会看到内存占用量每次增加 4 字节。一旦垃圾收集器运行，现在取消引用的 uint 占用的内存空间应该被释放，您应该会看到内存下降。

但是，当我运行您的示例代码时，我什么也得不到。它会上升和下降，它不会像你的那样持续上升，但我在 OS X 上，所以它是一个不同的播放器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-22T12:12:41.710

也许这很明显，但请记住 System.totalMemory 为您提供 Flash Player 使用的内存量（静态）。如果您打开了其他 Flash 应用程序，这可能解释了您的内存增加的原因。

# c# - 如何使用 linq2sql 模仿 nhibernate 的存储库模式？

> ID：1020147
> 
> 赞同：2
> 
> 时间：2009-06-19T21:39:15.630
> 
> 标签：c#, nhibernate, linq-to-sql

我正在阅读这篇博文：

> [https://web.archive.org/web/20110503184234/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/10/08/the-repository-pattern.aspx](https://web.archive.org/web/20110503184234/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/10/08/the-repository-pattern.aspx)

我喜欢他们如何为您创建一个包含所有基本 CRUD 查询的界面，并且您可以在所有实体/表中使用它。

这也可以用 linqtosql 完成吗？

* * *

### 代码：

```
public class Repository<T> : IRepository<T>
{
    public ISession Session { get { return UnitOfWork.CurrentSession; } }
    public T GetById(int id)
    {
        return Session.Get<T>(id);
    }

    public ICollection<T> FindAll()
    {
        return Session.CreateCriteria(typeof(T)).List<T>();
    }

    public void Add(T product)
    {
        Session.Save(product);
    }

    public void Remove(T product)
    {
        Session.Delete(product);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-22T14:58:15.993

是的，有[几次](http://www.google.com/search?hl=en&q=linq+to+sql+repository+pattern&aq=0&oq=linq+to+sql+reposit&aqi=g2)尝试使用 LINQ to SQL 来实现这种模式。

# jquery - 同一页面上的多个 jquery 扩展会导致错误，有人解决吗？

> ID：1020148
> 
> 赞同：0
> 
> 时间：2009-06-19T21:39:22.153
> 
> 标签：jquery

我使用的是 IE 8，有一个带有 2 个 jquery 扩展的网页（一个是菜单，另一个是 fency 文本框）。当我单独运行每个扩展时，它们工作正常，当我一起运行它们时，我得到以下 js 错误：

错误：对象不支持此属性或方法

我正在通过以下方式注册处理程序：

文本框：

```
<script type="text/javascript">
        $().ready(function() {
            $('#ctl00_Main_Status1_tbStatus').textboxhelp({ help: 'I am thinking of a...' });           
        });
    </script> 
```

菜单：

```
<script type="text/javascript">
        $(function() {
            alert('in menu');
            $("#1, #2, #3").lavaLamp({
                fx: "backout",
                speed: 700,
                click: function(event, menuItem) {
                    return false;
                }
            });
        });
    </script> 
```

任何帮助都会得到很大的帮助，我对 jquery 很陌生...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T23:01:38.163

它可能是 $ 别名，检查插件以查看。

```
(function($){
   //theplugin code here
})( jQuery ); 
```

这允许在内部使用 $ 而不会混淆

* * *

@杰夫这个：

```
$(function(){
  //stuff here
}); 
```

是相同的：

```
(function($) {
  $(document).ready(function() {
    // your code here
  })
})(jQuery) 
```

但可能不如（最后没有绑定（jQuery）），只有在您使用其他使用 $.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T23:48:18.663

具体到：对象不支持此属性或方法

您的包含是否按顺序排列，并且在您的脚本之上？如果您没有所有依赖的插件文件，则可能会出现这种错误。

将您的 jquery 包含在第一...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T23:21:06.067

好的，谢谢大家的帮助。马克的回答是解决我的问题。我使用了第三个选项，而且……它奏效了。至于您的答复杰夫，好吧，我将代码移动了，尽管即使我将其更正为您所说的内容，它也给了我同样的错误。

所以，如果有人感兴趣或碰巧遇到同样的错误，这里是我的两个控件的代码：

控制 1：

```
<script type="text/javascript">
        (function($) {
            $(document).ready(function() {
            $('#ctl00_Main_StatusCtrl_tbStatus').textboxhelp({ help: 'I am thinking of...' });
            });
        })(jQuery)
    </script> 
```

控制 2：

```
<script language="javascript" type="text/javascript">
  (function($) {
      $(document).ready(function() {
          $("#1, #2, #3").lavaLamp({
              fx: "backout",
              speed: 700,
              click: function(event, menuItem) {
                  return false;
              }
          });
      });
  })(jQuery)
</script> 
```

再一次，谢谢你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T21:45:32.513

当您运行它们或包含它们时？如果在包含它们时发生错误，则函数名称或其他内容可能存在冲突。

无论哪种情况，请尝试下载 Firefox 并运行 FireBug 插件，看看是否有助于追踪问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-19T22:19:58.247

您的第二个脚本菜单不应该也包含在 document.ready 处理程序中吗？

```
$().ready(function() { 
    /*the menu script here*/ 
    /*the textbox script here */
}); 
```

# apache - 如何处理旧的访问日志？

> ID：1020158
> 
> 赞同：2
> 
> 时间：2009-06-19T21:42:59.133
> 
> 标签：apache, logging, access-log

五年前，我的网站有 51 GB 的 HTTP (Apache) 访问日志。就我的个性而言，我是一个囤积者，这就是为什么我不愿意删除它们，即使它占用的磁盘空间比我想要的要多。我应该硬着头皮删除吗？还是匿名？

人们如何处理他们的旧日志文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T21:51:41.550

答案实际上取决于您通常需要对日志做什么、您的业务是什么以及您的（公司？）安全策略。

在我这边，我通常从不删除日志。它们对于发现安全漏洞、行为和趋势非常有用。

如果存储有问题，请考虑使用 Amazon S3 等存储服务，不要忘记压缩它们！我通常将所有超过一个月的压缩日志移到那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T21:46:52.073

我“囤积”的大多数日志文件我要么根据月/季度/年压缩，然后你就会拥有它们，但日志文件可以很好地压缩。如果空间有问题，请刻录到 DVD（也可以制作多个副本）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T22:19:55.707

这是很多日志。你在使用[logrotate](http://gd.tuwien.ac.at/linuxcommand.org/man_pages/logrotate8.html)吗？只需将它们拉上拉链即可为您提供所需的空间。我所有的服务器日志都被压缩成 gzip 文件。来自中小型企业 Intranet 的一年日志价值为 174M。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T22:28:17.280

我同意其他人的观点：

如果它让您感觉更好，请压缩并刻录到光盘。

如果您需要额外的舒适感，请在异地存放。

如果你只是需要一些东西来分散你对放手的决定，你可以编写一个解析器，将你的日志剥离到最基本的东西，找到差异，或者以其他方式破坏它们，这样你就有了一些精简、有见地、多汁的数据集. 然后，您可以保留两件事。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T23:32:22.597

我们每天压缩超过 75 Gigs 的日志。由于显而易见的原因，我们目前不会保留超过一个月的日志，但我们正在研究包括 DFS 在内的解决方案，以便我们可以轻松添加更多日志。存储很便宜，但您始终必须考虑“假设”。每月 0.15 美元/演出，您只需在 S3 上存储每月 8 美元，然后您不必担心会丢失任何东西。我建议你调查一下。

驱动器也很便宜，如果你担心买一些便宜的 50 美元驱动器并将日志复制到那里并将它们存储在朋友/亲戚家。:-)

# c# - 同一功能中的多个锁定

> ID：1020159
> 
> 赞同：1
> 
> 时间：2009-06-19T21:43:48.260
> 
> 标签：c#, multithreading

我有一个函数，这是我的应用程序的主要瓶颈，因为它对线程之间共享的全局列表进行了大量的字符串比较。我的问题基本上是这样的：

在 1 个函数中多次锁定列表（称为 List gList ）是不好的做法。然后稍后再次锁定它（基本上在进行查找时锁定，解锁准备好插入新项目然后再次锁定并添加新项目）。

当我是分析员时，我看不到任何迹象表明我为此付出了沉重的代价，但是我可以在稍后的时间或在野外编写代码时吗？有人在这方面有任何最好的实践或个人经验吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T21:54:17.910

你如何执行锁定？[`ReaderWriterLockSlim`](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)如果还不是这样，您可能想研究 using 。

这是一个简单的使用示例：

```
class SomeData
{
    private IList<string> _someStrings = new List<string>();
    private ReaderWriterLockSlim _lock = new ReaderWriterLockSlim();

    public void Add(string text)
    {
        _lock.EnterWriteLock();            
        try
        {
            _someStrings.Add(text);
        }
        finally
        {
            _lock.ExitWriteLock();
        }

    }

    public bool Contains(string text)
    {
        _lock.EnterReadLock();
        try
        {
            return _someStrings.Contains(text);
        }
        finally
        {
            _lock.ExitReadLock();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T21:47:24.740

通常，您希望锁定尽可能短的时间。争用的成本（必须转到内核）比获取无争用锁的成本（可以在用户空间中完成）要高得多，因此更细粒度的锁定通常对性能有好处，即使这意味着获取锁定更多次。

也就是说，请确保您在适当的情况下进行分析：同时负载量很大的情况。否则你的结果与现实几乎没有关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T21:50:15.967

在我看来，能给出具体答案的数据很少。通常不是锁的数量会导致性能问题，而是等待该锁的线程数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T21:58:57.340

听起来您不想释放查找和插入之间的锁定。要么，要么您根本不需要在查找期间锁定。

您是否仅在元素不存在时才尝试添加到列表中？如果是这样，那么在两个步骤之间释放锁定允许另一个线程在您准备元素时添加到列表中。当您准备好添加时，您的查找已过时。

如果查找可能已过时不是问题，那么您可能根本不需要在查找期间锁定。

# oracle - 显示 Oracle AQ SYS.AQ$_JMS_TEXT_MESSAGE 的内容

> ID：1020165
> 
> 赞同：14
> 
> 时间：2009-06-19T21:44:51.657
> 
> 标签：oracle, jms, advanced-queuing

我有一个使用 Oracle 高级队列的 JMS op top 的应用程序。我想对显示消息内容的队列表进行查询（在我的例子中是 XML）。因此，当我执行“从 [queue_table] 中选择 user_data”时，我得到“AQ SYS.AQ$_JMS_TEXT_MESSAGE”作为响应。

是否有可以显示此消息内容的功能？诸如“从 [queue_table] 中选择 FUNCTION(user_data)”之类的东西？

我用谷歌搜索，扫描了许多关于排队的 Oracle 文章，但我找不到这个东西。我怀疑有一种简单的方法可以做到这一点，但我找不到。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-20T08:25:00.313

我也为此苦苦挣扎。我在这里写了一个答案：[http](http://rwijk.blogspot.com/2009/02/whats-in-my-jms-queue.html) ://rwijk.blogspot.com/2009/02/whats-in-my-jms-queue.html 。

问候，罗布。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-20T12:33:44.180

所以我想应该是：

```
select queue.user_data.text_vc from [queue_table] queue 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-05-26T11:08:09.827

这里的答案不处理较大内容的显示，存储在`user_data.text_lob`. 如果内容大于一定数量的字节（4000？），`text_vc`将是`null`并且您必须查看`text_lob`（`null`否则）

为了显示所有数据，无论其大小，您都可以使用以下查询[`nvl`](http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions105.htm)：

`SELECT nvl(q.user_data.text_vc, q.user_data.text_lob) FROM [queue_table] q`

我想你可以（并且应该考虑）使用[`coalesce`](http://docs.oracle.com/cd/B28359_01/server.111/b28286/functions023.htm#SQLRF00617)而不是`nvl`，因为它[不会评估第二个参数](https://stackoverflow.com/a/950103/1436981)，如果第一个参数已经不同于`null`，但我还没有测试过那个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-12T10:44:18.993

除了 stuXnet 的评论：

```
SELECT nvl(to_clob(q.user_data.text_vc), q.user_data.text_lob) FROM queue_table q; 
```

如果没有 to_clob，对于大于 4000 个字符的数据，您将得到 ORA-22835，因为它保留了第一个参数的空间，它只是 VARCHAR2。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-03-18T09:47:53.230

请尝试以下命令：

从 [queue_table] 名称中选择 user_data

# automation - 为什么更多的编程语言没有内置的窗口管理器接口？

> ID：1020168
> 
> 赞同：0
> 
> 时间：2009-06-19T21:46:30.670
> 
> 标签：automation, x11, autohotkey, window-managers

编程是在计算机上自动执行任务的核心。
据推测，这些任务通常由人手动完成。
人类通过键盘、鼠标以及与控制台或窗口管理器的交互来使用计算机。
但是很少有语言内置了为这些基本计算对象提供接口的函数。

一个值得注意的例外是 autohotkey，它是 Windows 上的一种开源语言，它提供了允许执行以下简单任务的内置函数：
* 获取像素信息
* 获取鼠标位置
* 键盘宏
* 模拟击键
* 模拟鼠标点击
* 窗口管理
请参阅[rosettacode](http://www.rosettacode.org/wiki/Category:AutoHotkey_Originated)上的示例。

linux上有过各种尝试，很多都没有解释就停止了。一个是不活跃的 tcl 库：android. 在 google 代码中搜索 android, lang:tcl

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T22:01:18.113

我编写网络服务器代码。没有人与代码交互。它只是 Apache 的许多复杂插件。

“人类通过键盘、鼠标以及与控制台或窗口管理器的交互来使用计算机。”

就我而言，这完全是错误的。“用户”通过 HTTP 发送请求。没有键盘，没有鼠标，没有控制台，没有窗口管理器。

用户可能正在使用某种花哨的 GUI，但这对我或我的软件无关紧要。我看到的只是 HTTP GET 和 POST 请求。纯文本。

“但很少有语言内置了为这些基本计算对象提供接口的函数。”

正确的。我没有使用键盘、鼠标、控制台或窗口管理器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T22:03:09.703

所有个人计算平台都有可以执行此操作的库。

问题在于，这需要标准化所有系统上的用户交互。Java 尝试了这一点，但没有取得很大的成功。还有其他一些或多或少成功的库，Qt 可能是迄今为止最有前途的库。

当然可以为一个包含所有 UI 基础的单一平台编写语言。也可以使用 GUI 和库来伪造它。但是，有充分的理由需要一种可在任何主要平台上使用的语言，无论是否有 GUI。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T21:53:13.513

我怀疑这个前提是真的。Java 可以做所有这些，除了“窗口管理”，因为我不知道这是什么意思。

如果你不能用 c# 做到这一点，我会感到惊讶。

如果有很多语言不能做到这一点，我猜这是因为如果不将语言与操作系统绑定就很难做到。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-22T21:12:56.837

首先，我想你是在问为什么编程语言的标准库没有内置的窗口管理器接口。语言本身及其库是截然不同的。

一大原因是便携性。如果一种编程语言的库中有太多特定的功能，那么将其移植到其他系统将更加困难。例如，I/O、数学函数、字符串、各种数据结构和相关算法都是通用的，几乎可以在任何计算机上工作。

但是诸如窗口管理器、GUI 等之类的东西，它们*更*特定于某些平台，这就是为什么它们不包含在标准库中的原因。这就是 C/C++ 如此可移植的原因。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T21:54:33.370

在没有任何人机界面设备交互的情况下由计算机执行的任务数量远远超过由人类直接执行的任务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T21:56:57.560

编程语言尝试（或至少目前正在尝试）独立于平台。.net 中的示例，您必须引用一些 Win32 api 来执行您在上面指定的一些内容。将其内置到核心编程语言模型中，.net 将与操作系统过于耦合，因此，创建 Mono 对应物将太乏味。

关于击键、宏和一些东西，我现在做的最简单的方法是真正的 vbscript 或在 powershell 中:)

# version-control - 分支模式/策略

> ID：1020169
> 
> 赞同：4
> 
> 时间：2009-06-19T21:46:40.000
> 
> 标签：version-control, branch

我目前正在改进我们商店进行版本控制的方式。我们将使用以服务器为中心的版本控制解决方案。

我想看看其他人是如何分支的，并且成功地做到了，而没有我读到的所有令人头疼的问题。

您在生产环境中看到哪些经过现场测试的分支模式运行良好，即每个版本的分支。已经制定了哪些政策来确保分支顺利进行。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T22:02:44.257

这取决于您正在开发的软件类型。

对我们来说，我们是一家网上商店，所以我们没有任何编号的“版本”。我们将主干保留为值得“生产”的东西，并且只直接提交小的更改。

当我们有一个大型项目时，我们创建一个分支并将其工作到准备好生产，同时将主干更改同步到其中。

如果项目涉及代码库的大规模重组，我们通常会在合并分支更改之前在最后一个修订版上创建一个标签。

同样，如果您正在创建需要维护不同版本的打包软件，这将几乎无法正常工作。

作为记录，我们使用[Subversion](http://subversion.apache.org)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T21:52:18.490

[subversion book](http://svnbook.red-bean.com/nightly/en/svn.branchmerge.commonpatterns.html)描述了一些常用的分支模式（例如发布分支、特性分支等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T22:13:27.013

考虑分支时的 3 件事。

第一：分支很好，只要你打算稍后合并东西。当然，您始终可以为有特定问题的一位客户提供带有特定补丁的分支。但最终你想将大部分补丁合并回主干

第二：断言你的需求。我见过各种规模的树，具体取决于部门的规模、客户的数量等......

第三：检查您的源代码控制在分支和合并方面有多好。例如，众所周知，CVS 对这种操作很差。SVN，他们声称的“CVS 做得对”，要好一些。但是创建 Git 的 Linus Torvalds（它特别适合这种操作）会告诉你 CVS 不能正确地完成（他在关于 Git 的一个非常有趣的演示文稿中说过）。因此，如果您确实需要分支和合并，至少要获得 SVN 而不是 CVS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T22:54:23.967

看看分支模式：

[http://www.cmcrossroads.com/bradapp/acme/branching/](http://www.cmcrossroads.com/bradapp/acme/branching/)

它描述了许多使用模式的模式。我通常以两种方式工作：

*   稳定的接收线 - 所有开发都在分支中完成，仅在需要时合并到主干中。这意味着您始终只有一个稳定的发布点。

*   主开发线 - 所有工作都在主干中进行。在发布时，您需要一个发布标签并使用它。如果需要进行重大的实验性返工，则在分支中进行，并在稳定时合并回主干。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T22:03:28.547

这就是我们做的方式，它对我们很有效......

```
Project
   |
   +--01-Development
   |  |
   |  +--Release1.0
   |  |  |
   |  |  +--Solution Files
   |  |   
   |  +--Release2.0
   |     |
   |     +--Solution Files
   |
   +--02-Integration
   |  |
   |  +--Release1.0
   |  |  |
   |  |  +--Solution Files
   |  |   
   |  +--Release2.0
   |     |
   |     +--Solution Files
   |
   +--03-Staging
   |
   +--04-Production 
```

反正你懂这个意思...

**注意：**这是 Team Foundation Server 中的目录结构 分支仅存在于 01-Development/Release1.0 和 02-Integration/Release1.0、02-Integration/Release1.0 和 03-Staging/Release1.0、03-Staging 之间/Release1.0 和 04-Production/Release1.0

换句话说，您将无法将 03-Staging/Release1.0 合并到 04-Production/Release2.0 等...

这对我们来说是我们有 4 个独立的环境开发、集成（alpha 服务器）、暂存（beta 服务器）、生产。

代码从开发开始，从开发开始，然后在 QA（集成/alpha）和用户（Staging/beta）测试时得到提升，最后进入生产。

功能/更改被收集并分组到每隔几个月发生的版本中。

但是假设您正在为 Release2.0 开发，并且您在 Release1.0 上遇到了生产问题......我可以轻松获得最新版本的 Release1.0 并修复问题并升级它，而不会影响我一直在工作的任何东西对于 Release2.0 开启

并不是说这在任何情况下都适用于每个人，但这对我们来说非常有效。

# sql-server - NHibernate 身份字段

> ID：1020174
> 
> 赞同：6
> 
> 时间：2009-06-19T21:47:38.283
> 
> 标签：sql-server, nhibernate

[NHibernate 入门](https://stackoverflow.com/questions/1020128/getting-started-with-nhibernate)

如何使用 Hilo 算法在 nHibernate 中生成身份字段？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-04T09:11:36.757

使用类 =“hilo”：

```
<generator class="hilo"> 
```

例子：

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="NHibernate__MyClass" assembly="NHibernate__MyClass">
  <class name="MyClass" table="MyClass">
    <id name="Id" type="int" column="ID">
      <generator class="hilo">
    </id>
    <property name="Name">
      <column name="Name" not-null="true" />
    </property>
    <property name="Value">
      <column name="Value" not-null="true" />
    </property>
  </class>
</hibernate-mapping> 
```

我简化了：

```
<id name="Id">
  <column name="ID" sql-type="int" not-null="true"/>
  <generator class="hilo" />
</id> 
```

到：

```
<id name="Id" type="int" column="ID">
    <generator class="hilo">
</id> 
```

您可能会遇到某种令 NHibernate 感到困惑的语法错误。
如果您可以提供有关失败之前正在执行的代码的更多详细信息，或者您可能认为重要的任何其他内容，那么这可以加快您的问题得到解决的速度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T21:52:44.480

我还没有看过截屏视频。但是[nHibernate的夏天](http://www.summerofnhibernate.com)应该可以帮助你。

对不起 - 我没有回答你原来的问题。

# c# - 暂时阻止特定网站的编程方式？

> ID：1020175
> 
> 赞同：2
> 
> 时间：2009-06-19T21:47:44.477
> 
> 标签：c#, vb.net, windows-xp, cross-browser

我需要一种方法来以编程方式阻止然后根据其域名取消阻止特定网站。我只需要阻止浏览器（所以 http 和 https 就足够了，我猜？）但不仅仅是 Internet Explorer，它也应该适用于任何试图运行 Chrome 或 Firefox 的人。

这需要在 Windows XP 上运行，并且可以从 .NET 程序（Vb.net 或 C#）中使用。

（ps.，我发现了这个问题：[How to unblock website which is blocked, using C#?](https://stackoverflow.com/questions/868054/how-to-unblock-website-which-is-blocked-using-c)这似乎是在说同样的话，但当时我无法理解。现在我明白了，谢谢大家。）谢谢,

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T22:13:47.417

hosts 文件中的这一行将重定向到 localhost。虽然我对纳斯卡没有任何意见；）

```
127.0.0.1       www.nascar.com 
```

[使用主机文件阻止网站。](http://allthingsmarked.com/2006/08/28/howto-block-websites-using-the-hosts-file/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T21:50:20.803

一种糟糕的方法是动态更新主机文件。

c:\Windows\System32\drivers\etc\hosts

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T21:51:45.217

您可以在 Hosts.ini 文件中添加条目来实现此目的。它只能在 Windows 上运行。看看这里[链接文本](http://www.howtonetworking.com/whatis/hosts.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T22:17:58.597

首先，要知道您需要成为管理员才能执行此操作。

好吧，您可以在 ( c:\Windows\System32\drivers\etc\hosts ) 中的 hosts 文件中添加一行，其中包含您想要的站点，例如：

```
127.0.0.1 www.example.com 
```

完成后，只需运行以下命令：

```
ipconfig /flushdns 
```

一些网络浏览器，包括 Firefox，也必须重新启动。

要取消阻止被阻止的站点，只需从 hosts 文件中删除它的条目，或在其开头放置 # 号。

# c# - 当应用程序处于焦点时，如何捕获 WinForms 应用程序上的键？

> ID：1020179
> 
> 赞同：3
> 
> 时间：2009-06-19T21:49:22.273
> 
> 标签：c#, .net, winforms

当应用程序处于焦点时，如何捕获 WinForms 应用程序上的键？

我曾尝试使用`Form_KeyDown`and`Form_KeyUp`事件，但它们并没有按照我希望的方式工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T21:50:06.700

设置`KeyPreview`为真

这是您的表单的示例`OnKeyDown`覆盖，它吃掉击键并防止它被传播到其他事件：

```
protected override void OnKeyDown(KeyEventArgs e)
{
    e.SuppressKeyPress = true; // do this to 'eat' the keystroke
    base.OnKeyDown(e);
} 
```

# iphone - UITabBarItem 的标签

> ID：1020180
> 
> 赞同：3
> 
> 时间：2009-06-19T21:49:53.270
> 
> 标签：iphone, cocoa-touch, uitabbaritem

当我使用此方法初始化 a 时`UITabBarItem`：

```
- (id)initWithTitle:(NSString *)title image:(UIImage *)image tag:(NSInteger)tag 
```

我是否需要为每个标签栏项目使用不同的标签，或者（因为我不使用它们）我可以简单地为所有标签使用相同的标签值吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T22:04:28.153

我很确定您可以将它们全部保留为 0 或您选择的任何其他数字。每个 UIView 都可能有不同的标签，并且 Interface Builder 默认将它们全部设置为 0。我没有遇到任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T22:21:09.150

来自 Apple 的[UITabBarItem](http://developer.apple.com/iphone/library/documentation/uikit/reference/UITabBarItem_Class/Reference/Reference.html)类参考：

> *tag* - 接收者的标签，一个整数，可用于标识应用程序中的条形项目对象。

所以看起来真的无所谓。

# ruby-on-rails - Mechanical Turk 教程或操作指南

> ID：1020187
> 
> 赞同：3
> 
> 时间：2009-06-19T21:51:28.853
> 
> 标签：ruby-on-rails, amazon-web-services, mechanicalturk

有人知道任何讨论集成 Amazon 的[Mechanical Turk](https://www.mturk.com/mturk/welcome)和 Rails 的教程/资源吗？（除了那些亚马逊已经提供的资源）

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-10-21T00:26:48.050

你可以看看我的 gem [Turkee](http://github.com/aantix/turkee)。建立在 RTurk 之上，应该有助于简化外部表单的创建并将工作人员输入的数据导入回您的模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-24T23:01:13.757

[RTurk](http://webchicanery.com/2009/06/20/4-minute-work-week/ "土耳其人")不完整，但看起来很有希望。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-12T12:07:15.390

I've updated RTurk and continued development, it should work for most jobs. Here's a little tutorial I wrote up on it - [http://squarepush.com/ps/2009/08/11/mechanical-turk-in-ruby/](http://squarepush.com/ps/2009/08/11/mechanical-turk-in-ruby/)

I'll be doing a more rails specific one in the next few days.

# algorithm - 无需除法的快速平均

> ID：1020188
> 
> 赞同：9
> 
> 时间：2009-06-19T21:51:31.677
> 
> 标签：algorithm, language-agnostic, bit-manipulation, binary-search

我有一个二进制搜索循环，它在执行路径中被多次命中。

分析器显示搜索的除法部分（根据搜索范围的高和低索引查找中间索引）实际上是搜索成本最高的部分，大约是 4 倍。

（我认为）对于有效的二分搜索来说，找到精确的中间值并不重要，只是靠近中间的一个值，在任何一个方向上都没有偏差。

是否有一种比特旋转算法可以用`mid = (low + high) / 2`更快的东西代替？

编辑：语言是 C#，但等效的位操作在任何语言中都有效（尽管它可能对性能没有好处），这就是我关闭 C# 标记的原因。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-20T01:47:15.617

这是一个不受溢出问题影响的平均值的 bit-hack 版本：

```
unsigned int average (unsigned int x, unsigned int y)
{
  return (x&y)+((x^y)>>1);
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-19T21:52:42.890

```
int mid = (low + high) >>> 1; 
```

请注意，当整数溢出成为问题时，使用“(low + high) / 2”进行中点计算[将无法正常工作。](http://googleresearch.blogspot.com/2006/06/extra-extra-read-all-about-it-nearly.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-19T22:40:33.497

您可以使用位移并克服可能的溢出问题：

```
low + ((high-low) >> 1) 
```

但是我必须承认，我希望现代编译器和解释器将除以 2（或除以任何其他恒定的 2 幂）作为位移位，所以不确定它是否真的有帮助 - 试试看。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-06T11:43:20.790

为了进一步扩展 Nils 的答案，**Richard Schroeppel**发明了这个。

[http://www.inwap.com/pdp10/hbaker/hakmem/boolean.html#item23](http://www.inwap.com/pdp10/hbaker/hakmem/boolean.html#item23)

> 第 23 项（施罗佩尔）：
> 
> (A AND B) + (A OR B) = A + B = (A XOR B) + 2 (A AND B)。

```
(A + B)/2 = ((A XOR B) + 2(A AND B))/2
          =  (A XOR B)/2  + (A AND B)
          =  (A XOR B)>>1 + (A AND B)

avg(x,y){return((x^y)>>1)+(x&y);} 
```

`(A AND B) + (A OR B) = A + B`因为`A AND B`给出了两个共享的（在 A 和 B 之间）幂的总和，`A OR B`给出了共享的和不共享的，因此：

```
(A AND B) + (A OR B) = 
   (sum of shared powers of two) + 
   ((sum of shared powers of two) + (sum of unshared powers of two)) = 
     (sum of shared powers of two) + 
     ((sum of shared powers of two) + (sum of powers of two of A only) + 
     (sum of powers of two of B only)) = 
       ((sum of shared powers of two) + (sum of powers of two of A only)) + 
       ((sum of shared powers of two) + (sum of powers of two of B only)) 
= A + B. 
```

`A XOR B`给出 A 和 B 之间不同的那些位的映射。因此，

```
A XOR B = (sum of powers of two of A only) + (sum of powers of two of B only). 
```

因此：

```
2(A AND B) + (A XOR B) = 
       ((sum of shared powers of two) + (sum of powers of two of A only)) + 
       ((sum of shared powers of two) + (sum of powers of two of B only)) 
= A + B. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T01:16:19.860

如果我没记错的话，在某些情况下，使用数组的确切中间实际上可能会更慢。解决方案是随机选择一分为二数组的索引。确定数组中位数的算法同样如此。

我不记得确切的细节，但我记得在 iTunes 上的[MIT 算法系列的第 6 讲中听过。](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-046JFall-2005/CourseHome/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-15T18:24:19.860

尝试低 + ((高 - 低) / 2))。这应该有效，因为您只取两个数字的平均值。如果二进制搜索列表相当大，这将减少算法所花费的时间，因为高 - 低远小于高 + 低。

# c# - 基于 IList 中项目中的数据的 WPF 数据绑定和样式

> ID：1020191
> 
> 赞同：1
> 
> 时间：2009-06-19T21:52:09.660
> 
> 标签：c#, .net, wpf, data-binding

我有一个 ListBox 绑定到一个项目列表（为了争论，可以说它有一个字符串和两个日期 Entered 和 Done）。

如果 Done DateTime 为 != DateTime.MinValue，我想让 ListBox 中项目的背景颜色为灰色。

**编辑：**

我应该做一个转换器吗？并根据 DateTime 的值将 DateTime 转换为 Brush？

像这样的东西是我最好的选择吗？或者我可以使用一个简单的 Xaml 片段吗？

```
[ValueConversion(typeof(DateTime), typeof(Brush))]
class MyConverter : IValueConverter
{
    ...
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T22:25:23.370

A`ValueConverter`会工作。另一种选择是`DataTrigger`使用`ListBoxItem`. 也许是这样的：

```
<Style x:Name="MinDateTimeListBoxStyle" TargetType="ListBoxItem">
    <Style.Triggers>
        <Setter Property="Background" Value="Gray" />
        <DataTrigger Binding="{Binding Path=Done}"
            Value="{x:Static sys:DateTime.MinValue}">
            <Setter Property="Background" Value="White" />
        </DataTrigger>
    </Style.Triggers>
</Style> 
```

`Done`当is not的值时，这会将背景设置为 Gray `DateTime.MinValue`。我认为没有办法在触发器中进行不等于比较，因此默认情况下它将背景设置为灰色，并且只有在`Done`尚未更改时才将其更改回白色。使用正确的背景颜色而不是白色可能会更好（也许得到父背景的值？），但这应该给你一些开始。

**更新**：要将此样式应用于仅某些列表框的项目，请为样式命名并根据需要设置`ItemContainerStyle`：

```
<ListBox x:Name="StyledListBox"
    ItemContainerStyle="{StaticResource MinDateTimeListBoxStyle}" />
<ListBox x:Name="NormalListBox" /> 
```

# assembly - 汇编语言是如何整合到程序中的？

> ID：1020192
> 
> 赞同：3
> 
> 时间：2009-06-19T21:52:10.147
> 
> 标签：assembly, encapsulation

我在很多地方读到汇编语言通常不用于创建完整的程序，而是被其他程序用来使某些程序更高效，尤其是那些每秒调用几千次的程序。我想知道如何将少量的汇编代码合并到更大的程序中。

*   我认为可以制作一个小的可执行文件，然后从另一个程序运行，但这似乎效率低下。

*   然后我想到了 Visual Studio 的内联程序集，但那是微软特有的，似乎会有更好的方法。

那么如何在不创建单独的程序或使用 Visual Studio 内联汇编的情况下在更大的程序中使用少量的汇编代码呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T21:57:02.443

内联汇编并非特定于 Visual Studio - GCC 也支持它。内联汇编通常是将汇编合并到程序中的最简单方法。但是有几个问题 - 它会极大地影响代码的可移植性，并且一些编译器不支持它 - 例如，Microsoft 的 x64 编译器不支持它。

对于不支持内联汇编的编译器，或者当您想要包含所有特定于机器的代码时，您通常将汇编语言特定部分分离到它们自己的文件中，将汇编代码公开为您的 C++ 代码可以调用的函数。然后，您将它们组装并链接为构建的一部分。您的链接器不关心用于生成目标文件的语言 - 它可以将来自多种语言的目标文件组装到单个程序中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T05:52:49.350

> 然后我想到了 Visual Studio 的内联程序集，但那是微软特有的，似乎会有更好的方法。

每个编译器都支持某种形式的内联汇编，尽管方式通常略有不同。

因此，如果您需要使用内联汇编，请将每个片段封装在一个小函数中。然后，在移植到另一个编译器时，您可以毫不费力地重新实现这些函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T21:59:25.590

这是一个示例（GCC）：

```
__asm__ ("movl %eax, %ebx\n\t"
"movl $56, %esi\n\t"
"movl %ecx, $label(%edx,%ebx,$4)\n\t"
"movb %ah, (%ebx)"); 
```

对于 Microsoft 内联汇编，关键字是 __asm，汇编代码用大括号括起来，它不是字符串，目标寄存器现在位于左侧。

微软示例：

```
int foo(void) {
  __asm{
   mov eax,100 ; Moves 100 into eax!
   leave
   ret
  };
} 
```

*更多信息的链接*

内联汇编说明和参考：[http ://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html](http://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html)

IBM 教程，特定于 x86：[http ://www.ibm.com/developerworks/linux/library/l-ia.html](http://www.ibm.com/developerworks/linux/library/l-ia.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T22:11:51.493

对于像内部循环这样的少量代码，通常使用内联汇编来完成。这*绝对*不是微软特有的！（GCC 和几乎所有现代编译器也都支持它，尽管语法有不同的变化）。

对于较大的代码块（例如，操作系统的引导加载程序），它通常会放在一个单独的源文件中（就像您对每种语言使用多个源文件一样），然后与程序的其余部分链接使用链接器。

请记住，现在汇编主要用于操作系统，因为编译器现在已经足够好，将它用于游戏等内部循环并没有多大帮助（而且它根本不能移植到不同的架构）。它主要用于*非常低级*的东西，例如硬件中断和设置分页（虚拟内存）。

# php - PHP：使用 file() 读取 config.ini 到数组

> ID：1020194
> 
> 赞同：3
> 
> 时间：2009-06-19T21:52:35.527
> 
> 标签：php, file, ini

我的配置文件如下所示：

```
title = myTitle;
otherTitle = myOtherTitle; 
```

当我用 file() 读取文件时，它会创建这个数组

```
[0] => title = myTitle;
[1] => otherTitle = myOtherTitle; 
```

我希望数组看起来像

```
[title] => myTitle;
[otherTitle] => myOtherTitle; 
```

我是不是用了错误的方法她？我是否应该将整个配置读入一个刺痛并从那里爆炸？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T22:02:11.810

您可以使用该[`parse_ini_file`](http://us3.php.net/manual/en/function.parse-ini-file.php)功能。它在 PHP 4 和 5 中可用。

如果您的配置文件如下所示：

```
one = 1;
five = 5;
animal = BIRD; 
```

该函数将返回以下关联数组：

```
Array
(
    [one] => 1
    [five] => 5
    [animal] => BIRD
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T21:58:45.577

我会遍历文件并单独分解每一行。这是一个简单的示例，之后`$config`您将按要求保存所有数据。

```
$config = array();
$lines = file("config.ini");
foreach ($lines as $line) {
    $vals = explode('=', $line, 2);
    $config[trim($vals[0])] = trim($vals[1]);
} 
```

# visual-studio - 如何更改默认的 Visual Studio 配置？

> ID：1020207
> 
> 赞同：2
> 
> 时间：2009-06-19T21:55:07.253
> 
> 标签：visual-studio

我想更改 Visual Studio 的默认配置（调试、发布）。也就是说，更改配置，以便所有创建的新解决方案都会受到影响。

这怎么可能？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T22:40:22.543

很可能您将不得不开始修改

C:\Program Files (x86)\Microsoft Visual Studio 9.0\Common7\IDE\ProjectTemplates

但我没有看到这样做的支持方式。您最好编写一个宏来为您添加它们。

# c# - C# 我可以在数据网格中显示可扩展的树状视图吗？

> ID：1020213
> 
> 赞同：2
> 
> 时间：2009-06-19T21:56:58.357
> 
> 标签：c#, datagridview

我正在使用 C#，并且希望我的数据网格的一部分可以像树一样折叠，可以这样做吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T21:59:23.860

如果您（或您的公司）可以花一点钱，为自己节省大量时间并购买 Infragistics 控件。

# visual-studio - 忽略 SqlMetal 生成文件的代码分析

> ID：1020217
> 
> 赞同：0
> 
> 时间：2009-06-19T21:57:48.713
> 
> 标签：visual-studio, code-generation, code-analysis, sqlmetal

我正在开发一个包含 SqlMetal 生成文件的 C# 项目。我想使用代码分析。我在代码分析选项中打开了“抑制生成代码的结果”，但它仍然报告 SqlMetal 类。有什么办法可以关闭它吗？

我正在使用 Visual Studio 2008 和 SqlMetal 2.0.50727.3082

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T11:15:43.820

一种选择是编辑生成的源代码以简单地将“部分”添加到您关心的类中。

然后你可以添加一个单独的文件

```
[GeneratedCode]
public partial class Foo
{
} 
```

对于你所做的每一个类 Foo

然后在重新生成时可能发生的最坏情况是部分链接被破坏（这将导致编译错误，因此您知道这已经发生并且需要更正（简单而容易）。

我还建议您提交一个连接错误/请求，要求他们将此属性生成添加为 sql metal 本身的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:44:29.877

这是一个已知问题（但遗憾的是，更正推迟到 Visual Studio 2010 之后的下一个版本）：

[http://connect.microsoft.com/VisualStudio/feedback/details/470206/code-analysis-and-designer-files](http://connect.microsoft.com/VisualStudio/feedback/details/470206/code-analysis-and-designer-files)

# web-services - 5 位 PIN 码是否比大多数密码更好？

> ID：1020218
> 
> 赞同：35
> 
> 时间：2009-06-19T21:57:49.370
> 
> 标签：web-services, security, authentication, passwords

这是困扰我多年的事情：为什么大多数在线服务都**高度重视密码的熵**，将其作为一种安全措施，并在用户选择密码时强制执行？

[在阅读了“Do Strong Web Passwords Accomplish Anything?”](http://research.microsoft.com/pubs/70445/tr-2007-64.pdf)论文后，我决定提出这个问题。（当然还有[经典的呆伯特卡通](http://www.dilbert.com/strips/comic/2005-09-10/)）。

在线站点的典型策略是要求至少 6 位或 8 位大写+小写+数字密码。该长度与暴力攻击的难度有关，例如从哈希中恢复密码。但是在线猜测的典型方式是有人尝试登录服务器，尝试几次后可以随意拒绝。

例如，假设我们正在使用全数字 PIN 保护一些中型服务。人们会立即想到 4 位数或 6 位数的别针，但这可能不是一个好主意，因为太多人会想输入他们孩子的生日，这本质上是一种公共知识。

所以，这是我的**5 位数 PIN**建议。我为每个用户保留一个“可能的攻击”标志。

1.  用户正确登录 -> OK
2.  否则，保持 https 会话并允许再尝试 2 次
3.  用户登录 -> 确定
4.  否则，允许再尝试 2 次，在他们之前有 5 分钟的休息时间
5.  用户登录 -> 确定
6.  用户中断会话 -> 设置标志
7.  用户中断会话但稍后正常登录：向用户显示对话框并允许清除标志
8.  用户用尽了上述尝试：发送带有链接的电子邮件；允许清除标志
9.  如果一个月内总共有超过 100 个标志，请设置全局“可能攻击”标志，要求没有 cookie 的人回答安全问题
10.  在某些情况下自动清除用户标志（例如用户最终从同一台计算机登录）

让我们假设用户名以某种方式已知（请注意，对于大多数网站来说这不是真的）。对一个用户的暴力攻击是没有希望的——你在 5 次尝试后被锁定，所以你有 1/200000 的机会。如果您在一个月内尝试猜测密码超过 200 次，则标志会熄灭，您将一无所获。如果你每月尝试 <200 个用户，一年后你有 < 1% 的机会破坏一个用户；使用网络钓鱼、病毒、社会工程或其他任何东西，你会好得多。

站点的大小仅在没有误报的意义上是相关的，即真正忘记密码的用户（假设每月 1%），恢复它，但不清除标志（假设 1%那些），以及当您无法自动清除标志时（例如，其中的 10%）。^(这使得每 10 6 个)用户每月有 10 个预期的误报标志——这意味着一个中型站点进入“恐慌”模式的可能性相当低，无论如何这还不错。

我相信这个方案非常实用。以下是关于它的一些明显的初步事实*（更新）*：

*   **好处**：PIN 更容易记住。我相信这是一个很大的好处，因为现在可以要求用户记住您生成的密码。我相信大多数人比任何其他类型的随机密码更能记住 5 个随机数字。
*   **权衡**：如果您的攻击者知道散列的 PIN 和盐，散列将无济于事。如果有人闯入您的数据库*并*了解您的加盐过程是什么，这是可能的。但是，我相信标准密码熵在这种情况下也无济于事。
*   **好处**：与随机字母数字密码相比，人们更愿意记住随机的 5 位数字；因此，要求我们生成密码而不是用户更容易。这消除了字典/个人数据攻击。

我的问题是：

1.  与我描述的典型方案相比，我的方案的其他权衡/好处是什么？
2.  使用我的密码方案不会更好地成为大多数中型网站和组织吗？
3.  他们选择现有计划的原因是什么？

**注意**：我不提倡总是使用短密码。我自己的网络密码通常是由密码管理器 ( `1Password`) 随机生成并加密的，密码为 12 个字符的高熵密码。但我认为通常上述方案会比我们实际使用的方案更好。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-06-19T22:04:55.597

不，你错了。蛮力攻击是一回事，但真正危险的是 Rainbow Tables，它从哈希值中为您提供明文密码。

首先，您永远不会将任何内容存储为纯文本。如果有人破坏了您的安全（或者即使员工有恶意），您也不想暴露用户的密码。因此，您将使用适当的盐渍哈希。

然后，使用 5 位 PIN 码太短，无法使用哈希进行保护。有彩虹表（甚至是谷歌搜索）可以让某人在获得哈希后取回密码。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-19T22:13:25.873

请记住，尝试 3.000 次的恶意用户可以在几分钟内成功阻止 1.000 个帐户。另一件事是，他可以通过每天尝试数千个不同的帐户来改变一次成功登录的几率。[OpenID](http://openid.net/developers/)不是一个选项吗？

**更新**

刚刚对 5 位数的东西有了一点启发。如果 5 位数字 (10^5=100.000) 真的很容易记住并且安全，那么这些情况呢：

```
4 letters all lowercase (26^4 = 456.976) => abcd
3 letters with mixed cases (52^3 = 140.608) => aBc
3 letters lowercase + numbers (36^3 = 46.656) => ab1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T23:09:46.323

我仍然不明白为什么人们完全限制密码长度。记住一个句子或短语对我来说不是更容易吗？例如，我可能希望我的密码是“ `this is my stackoverflow password`”。如果我忘记了，我会有一些严重的记忆问题。它的长度是 34 个字符，并且只使用 27 个字符的字母表，但实际上仍然不可能反转散列（4.6 x 10 ^(48)可能的排列）。

结合您对“攻击标志”和适当的加盐/散列技术的想法，我认为这将是一个理想的解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T22:22:35.653

**小心会话处理**

我对会话处理了解不多，但据我所知，大部分时间都是使用 cookie 制作的。当您有像您这样的方案时，有必要将错误尝试写入数据库或服务器上的特殊文件，因为您不能依赖会话处理（在您的描述中听起来有点，因为您可以“举行会议”以了解所有真相......） - 因为互联网上的会议非常脆弱。它只是 cookie（可以删除）和/或页面名称（也可以被污染）的构造。您唯一可以依靠的是用户仍然持有会话 - 您无法真正确定某些（接缝）新连接是否不是您的旧用户......

特别是，区分“用户仍有会话”和“用户中断会话”（您的第 7 项）之间没有任何意义，这只是一个可忽略的区别，也可能成为安全漏洞。

**记住并不容易**

您还说，记住 5 位数字更容易。这可能适合您的信用卡或银行卡（在德国，我们有 4 位 PIN）安全号码，但对于网站，您总是会遇到问题，即许多网站都有密码。记住几十个 5 位数字就像记住大量密码一样困难。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-29T03:55:34.700

By that logic, if 5 digits are easier to remember than 8 characters, yet contain sufficient entropy, then one digit and three case-insensitive letters should be easier still!

```
10**5 = 100,000
26**3 * 10 = 175,760 
```

Now just four little characters, yet they convey more entropy!

Perhaps I'll just use my initials followed by the digit 1 . . .

I'm not what's proved by this except that there's a big ambiguous gray area between reductio ad absurdum and sarcasm.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-11T04:04:42.210

真正的问题？人们。

我知道一个学区有 4 个密码：1111、2222、3333 和 4444。为什么？用户聚集在一起并同意这样做，这样他们就可以在员工在家生病时随时进入。当午餐工人生病时，进入锁定的午餐钱电脑太痛苦了。

哦，是的，我多次看到无人看管的午餐电脑。而且，是的，您可以随时要求将您的余额变成现金*。*

用户疯了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-19T22:08:02.703

带有加盐哈希的密码是最好的。Salt 可以防止大多数彩虹攻击，并且密码更难以暴力破解。即使使用字典攻击，您也更有可能在 5 位密码上获得更快的点击率，然后是类似长度的密码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-19T22:11:49.013

我过去曾建议过与您类似的方案，因为我看到很多情况下，用户只是在他们的显示器旁边的便签上写下密码，理由是共谋太难记住了。我认为密码并不重要，因为黑客更有可能在系统中找到其他漏洞，无论是通过应用程序还是简单的社会工程。

我认为有些人，尤其是技术经理，他们并没有完全理解你所说的安全感。一个大而复杂的密码感觉很强。有点像盒子上的保证，它让你感觉很好。有点像牙仙

> “汤米：你怎么知道牙仙不是什么疯狂的吸胶者。‘制造’模型飞机，”他告诉他们。好吧，我不买它。他偷偷溜进你家一次，就够了. 接下来你知道你的梳妆台抽屉里的钱不见了，你的女儿被撞倒了。”

最终，尽管像 pin 这样的简单密码很可能会被常见组合破解或猜到，但感觉并不安全。[与RSA SecurId](http://en.wikipedia.org/wiki/SecurID)结合使用的pin是我们都能够同意的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-19T22:46:11.190

我认为记住“密码短语随时都可以击败 PIN！”会更容易，这将承受大约 400 万亿年的暴力攻击。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-03-16T10:29:24.000

因此，依靠锁定来确保安全是一种糟糕的用户体验，并且会导致攻击者锁定多个帐户，从而给真实用户带来不便。取而代之的是使用带有加盐哈希的更强密码，如果在 PIN 和密码之间进行选择，这些密码更难使用暴力破解，并且不易受到 Rainbow 表攻击。如果在密码、密码和 PIN 之间进行选择。我的建议是使用密码，然后是密码短语，然后是 PIN，按偏好的降序排列。密码短语（>10 个字符）通常比密码（6 到 8 个字符）更安全，但不能提供很好的体验，因为用户每次都需要输入密码短语（>10 个字符）！！根据数据的敏感程度以及您希望提供的用户体验如何做出选择。等一下..

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-02-29T01:57:05.337

我也在试验别针和密码。这取决于您尝试构建的应用程序的整体安全性，但如果您结合一些密码安全检查，密码通常每次都会获胜。我的理解是，至少 14 个以上字符的良好密码可能比“典型”密码更好。它允许人们输入他们容易记住的东西，但在攻击中可能难以复制的东西。仅纯粹的字符数量就很难破解。

如果您将密码短语与上述锁定方法结合使用，您可能会拥有一个更安全的系统。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-19T22:37:02.503

PIN 与密码，密码胜出，并不完美，但具有强大的策略，远优于 PIN。

谁说很多人不会在便签上写他们的 PIN 码，对于很多人来说，单词组合比 5 位数字更容易记住，就我个人而言，我最容易记住数字，因此我的密码比字母更数字。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-11-01T11:57:25.897

另一个需要考虑的因素是易于进入。PIN 很容易在数字键盘上快速输入，因为您的输入非常复杂，输入的便利性下降。轻松取决于设备。在带有触摸打字的标准键盘上，我可以轻松输入符号和 UC。在智能手机上，我发现很难可靠地输入小写字母，而且由于键盘更小，符号输入起来又困难又慢。数字 PIN 可以快速输入，我可以轻松记住并输入一长串数字。如果输入速度很慢并且使用不寻常的动作泄露正在输入的内容，人类观察者会发现更容易获取密码。

简而言之，您不仅需要考虑密码的复杂性及其存储方式，还需要考虑密码的保密性和输入的难易程度。

# dns - 哪个是 Windows Server 2008 Web 版最好的 DNS 服务器解决方案

> ID：1020231
> 
> 赞同：-1
> 
> 时间：2009-06-19T22:00:21.500
> 
> 标签：dns, windows-server-2008

我想继续使用 Windows Server 2008，如果我使用 Web 版而不是标准版，每月可以节省 20 欧元。唯一的“问题”，Windows Server 2008 不再内置 DNS 服务器。

现在我问我，哪个是我的 Web 服务器最好的第三方 DNS。我看了一下simpleDNS，它看起来很酷。任何额外的想法或经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-24T06:19:11.423

[绑定](https://www.isc.org/downloadables/11)。大量的文档，如果你有时间学习，效果很好。

# coding-style - Bison（和 flex）编码约定

> ID：1020233
> 
> 赞同：2
> 
> 时间：2009-06-19T22:00:39.300
> 
> 标签：coding-style, bison, flex-lexer

您建议编写 Bison (.y) 和 flex (.lex) 文件的编码约定和准则是什么？

请说明代码部分的长度及其样式。

谢谢，
阿萨夫

PS，[这里](http://compilers.iecc.com/comparch/article/03-02-009)
有一个关于它的旧线程，但我正在寻找更详细的答案（并将其放在 SO 上！）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T20:46:35.623

对于这样的问题，我通常会看到其他人做了什么。很好的资源是[Google Code Search](http://codesearch.google.com)和[Koders](http://www.koders.com/)。两者都支持通过特定的编程语言进行搜索；但是，似乎只有 Google 将`lex`其列为列出的语言。

除此之外，我通常尝试在源代码中保持 79 或 96 列，以确保我可以并排查看至少 2 个窗口的代码。

# javascript - javascript 对象是否跨页面保存？

> ID：1020235
> 
> 赞同：7
> 
> 时间：2009-06-19T22:00:52.297
> 
> 标签：javascript

我想知道 javascript 对象是否跨页面保留？看起来有些浏览器会，有些则不会。什么是标准行为？

谢谢，埃贝

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-19T22:05:59.417

不，当您更改页面时，所有对象都将丢失。

但是，您可以使用`window.name`. `window.name`只要当前窗口打开，的值就会保持不变，因此您可以在其中临时存储数据（并逐页访问）。但是，可以从使用该窗口的任何页面访问（并且可覆盖）此数据，因此它不是安全或可靠的存储。

有关更多信息，请参见[http://www.thomasfrank.se/sessionvars.html](http://www.thomasfrank.se/sessionvars.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T22:03:38.610

从来没有见过这样的行为。据我所知 - 没有浏览器可以做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T22:16:45.027

浏览器会缓存脚本文件，但 JavaScript 对象的范围仅限于加载脚本文件的页面，因此如果您导航到使用相同脚本的另一个页面，对象将是新创建的，但不一定具有相同的状态如上一页。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-06-19T22:06:21.270

一些 Web 浏览器（例如 Safari）会缓存已编译的 javascript 代码。但是状态不应该在任何浏览器下的页面加载中保持不变。

# javascript - 从网页中检索 csv 文件

> ID：1020237
> 
> 赞同：0
> 
> 时间：2009-06-19T22:01:55.960
> 
> 标签：javascript, data-retrieval

我想从网页保存一个 csv 文件。但是，页面上的链接并没有直接指向文件，而是调用了某种javascript，从而导致了文件的打开。换句话说，我要下载的文件没有明确的 url 地址，或者至少我不知道它应该是什么。我找到了一种下载文件的方法，方法是激活 Internet Explorer，进入网页并按下链接按钮，然后通过对话框保存文件。这很难看，我想知道是否有更优雅（和快速）的方法来检索文件而不使用 Internet Explorer（例如，通过使用 urllib.retrieve 方法）不允许发布源代码...）：

“CSV”

有任何想法吗？

萨沙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T22:06:08.930

您可以查看 javascript 函数正在做什么，它应该会告诉您它从哪里下载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T22:11:49.387

一两年前我就遇到过这种问题。我最终安装了 rhino javascript 引擎；从目标文档中提取 javascript 并在 rhino 中评估 url，然后获取结果。

# linker - 链接器错误：无法打开文件“CHARTGROUPFRAME.DFM”

> ID：1020246
> 
> 赞同：3
> 
> 时间：2009-06-19T22:04:18.687
> 
> 标签：linker, c++builder, c++builder-2007

直到今天，我的 IDE 一直运行良好。

当我尝试编译我的项目时，我得到了这个：

> [链接器错误] 无法打开文件 'CHARTGROUPFRAME.DFM'

CHARTGROUPFRAME.CPP 单元是项目的一部分，所以这当然是一个错误。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T22:31:12.673

我找到了解决这个问题的方法:)。

我只需要将 .DFM 文件所在的目录添加到我的 **库路径**

顺便说一句，当我向项目中添加一个单元时，这应该由 IDE 设置......但是，至少这是可行的 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-08T15:57:25.647

在 RAD Studio 10.1 中也遇到了这个问题，对我来说，它有助于关闭打开这些文件的编辑器窗格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-20T10:45:54.887

从管理员运行您的 RAD Studio。

# asp.net - 在asp：GridView中控制行高的万无一失的方法？

> ID：1020263
> 
> 赞同：0
> 
> 时间：2009-06-19T22:10:16.037
> 
> 标签：asp.net, gridview

我似乎无法阻止我的 gridview 行太高......从谷歌搜索来看，这似乎是一个非常普遍的问题，但我似乎无法解决它。

```
<GridView ID="gridComputerApps" DataSourceID="llbComputerApplication" runat="server" AutoGenerateColumns="False" 
            CellPadding="0" CellSpacing="0" style="overflow:hidden"
            GridLines="Horizontal"
            EmptyDataText ="NO APPLICATIONS FOUND FOR THIS COMPUTER."
            DataKeyNames="ComputerID, ApplicationID" RowStyle-Height="0px" RowStyle-BorderWidth="0" RowStyle-VerticalAlign="Top"
            EnableViewState="False">
            <Columns> 
```

我也试过：

```
Private Sub gridComputerApps_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles gridComputerApps.RowDataBound
        e.Row.Height = New Unit(5, UnitType.Pixel)
    End Sub 
```

有没有完全万无一失的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T22:36:39.447

您是否尝试在 CSS 中设置行高？

在您的和样式的`CssClass`属性中设置此样式：`RowStyle``AlternateRowStyle``GridView`

```
.smallRow {
  height: 15px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T15:37:12.253

这似乎已经解决了问题......也许不是所有的都是必要的，但我正在继续。

```
table, tr, th, td {height: 5px; line-height:1.0; 
                             margin: 0px 0px 0px 0px; 
                             border:0px 0px 0px 0px; 
                             padding: 1px 1px 1px 1px;
                             padding-top: 0px;
                             padding-right: 0px;
                             padding-bottom: 0px;
                             padding-left: 0px;
                             vertical-align: middle;
                             overflow:hidden;
                             overflow-x:hidden} 
```

需要特别注意的一件特别重要的事情是 padding-top、padding-left 等。Firefox 和 IE 对 padding 的解释不同，所以在 FF 中它是正确的：padding: 1px 1px 1px 1px;

但 IE 似乎忽略了这一点。

另一个值得注意的问题是 CSS 当然会覆盖在 RowDataBound 事件中设置行高，这是有道理的。

另一个更新：上面的原始 CSS 出于某种未知原因停止为我工作。我碰巧正在使用 Blueprint CSS，这导致一些样式下降，这与我的自定义样式表相混淆。

所以无论如何，我想我终于有了它.... 1\. 基本上，为了安全起见（也许只有当你像我一样杂乱无章时），你必须明确设置每个可能影响高度的属性。这是我正在使用的 CSS：

```
.xGridview tr, th, td, input {height: auto; 
                       line-height:normal; 
                     margin: 0px 0px 0px 0px; 
                     border:0px 0px 0px 0px; 
                     padding: 0px 0px 0px 2px; 
                     padding-top: 0px;
                     padding-right: 0px;
                     padding-bottom: 0px;
                     padding-left: 2px;
                     margin: 0px 0px 0px 0px;
                     margin-bottom: 0px;
                     margin-left: 0px;
                     margin-right: 0px;
                     margin-top: 0px;
                     vertical-align: middle;
                     overflow:hidden;
                     background-color:White} 
```

2.  我碰巧在我的网格中有一个必填字段验证器；它呈现为不可见，所以在我使用 Firebug 之前我没有注意到它。更糟糕的是，我认为它在一个表格中呈现自己，而该表格以某种方式忽略了外部表格的 CSS。

3.  我在网格中有一个 RadioButtonList，默认情况下呈现为表格。这可以通过在 RadioButtonList 控件上设置 RepeatLayout="Flow" 来更改，这会使其呈现为一个跨度，更好。另请注意，我将元素 INPUT 添加到 CSS，这是在附加到单选按钮的标签上设置垂直对齐所必需的。

所以这似乎终于舔了它。

# jquery - 如何从 PHP 中的动态表单元素中检索 jQuery 更改事件？

> ID：1020267
> 
> 赞同：2
> 
> 时间：2009-06-19T22:11:16.690
> 
> 标签：jquery, forms, select, live, bind

为了选择类别，我想使用下拉列表。每个列表包含一个级别的类别。所以它是：顶级、子、子子、子子子等。每个级别都是通过我的脚本动态检索的`getcat.php`，它显示了一个`<select>`对象。

到目前为止，检索使用以下代码。但是，由于它是一个表单，我想获取最后一个选择的值，这样我就可以获得类别 ID。这对我不起作用。我试过`$("select:last option:selected")`了，但这不适用于新插入的元素。

选择类别后，必须显示一个输入字段，用户可以在其中创建自己的子类别（在所选类别内）。这也不适用于新元素。

现在，我尝试使用 .live ，但它不支持更改事件。各位大侠有什么改善方法的小窍门吗？

目前我有以下代码：

```
$("select").bind("change", function(){
    $(this).nextAll().remove();
    var value = $(this).val();
    $("#currentcat").val(value);
    if($("select:last option:selected").hasClass('makenew')) {
        $("#newcat").show();
    }
    else if($("select:last option:selected").hasClass('disabled')) { }
    else {
    $.get("getcat.php", { c: value },
        function(data){
            $("#getcats").append(data);
        });
    $("#newcat").hide();
    }    
}); 
```

然而，正如你所看到的，它不是一种美。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T23:10:57.710

您是否将 onchange 事件重新绑定到新的选择框？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T23:26:57.567

如果您希望 new `<option>`s 绑定到 DOM 并跨不同的浏览器工作，我建议您使用 document.createElement 和 document.createTextNode 将它们附加到您的选择中，如下所示：

```
var opt = document.createElement('option');
opt.value = "someValue";
opt.appendChild(document.createTextNode("someText"));
$('#currentcat').append(opt); 
```

因此，您可能应该使用[$.getJSON](http://docs.jquery.com/Ajax/jQuery.getJSON)而不是使用 $.get来获取一个 JSON 对象，该对象包含您将附加到您的选择的选项的值和文本属性。从服务器检索到的 JSON 对象应如下所示：

```
 { "options" : [   
                                    { "text" : "Fishing",  // First element
                                      "value"  : "5" },

                                    { "text" : "Skiing",  // Second Element
                                      "value"  : "70" }
                               ]
                } 
```

迭代对象看起来像这样：

```
$.getJSON("getcat.php", { c: value }, function(json) {
    var $select = $('<select></select>).attr('id','currentcat').attr('name','currentcat').hide(); 
    $.each(json.options, function(i, item) {
        var opt = document.createElement('option');
        opt.value = item.value;
        opt.appendChild(document.createTextNode(item.text));
        $('#currentcat').append(opt);        
    });
    $("#newcat").hide();
    $('#someDiv').append($select).show();
}); 
```

以上内容未经测试，反映了我对您问题的理解。希望有帮助。

# architecture - 声明变量

> ID：1020278
> 
> 赞同：2
> 
> 时间：2009-06-19T22:14:32.033
> 
> 标签：architecture, variables, declaration

假设您有一个名为**hotelPropertyNumber**的变量。内容将始终是一个数字，但通常用作字符串。将其声明为字符串会有什么“错误”，这样您就不必不断地将其转换为字符串......或者这是一个不好的编程习惯？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T22:25:29.017

数字是用于计数和测量的数学对象。如果您使用hotelPropertyNumber 进行计数，即对其应用任何算术运算，则它*是*数字并且应该存储为数字类型。

如果不是，那么它*不是*一个数字；它是一个字符串。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T22:31:44.653

在某些语言中，您可以创建用户定义类型，例如“ `class HotelPropertyNumber`”，其中：

*   完全支持您需要的方法
*   可以在内部将其数据存储为字符串
*   可以验证（在其构造函数中）其值具有类似数字的语法
*   不能与不是 HotelPropertyNumber 实例的其他数字和/或字符串类型实例混淆。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T22:16:27.757

始终以最简单的形式存储您的信息。在这种情况下，一个整数。必要时将其转换为字符串。几乎所有语言都使这几乎没有痛苦，尤其是对于字符串的整数。

[StackOverflow Podcast #58](http://itc.conversationsnetwork.org/shows/detail4148.html)就是一个很好的例子，当时 Jeff 将标题的 HTML 存储在数据库中，而不仅仅是标题本身。当他想稍后添加功能并在不需要 HTML 的地方显示该标题时，这会导致很多问题。

ChrisW 还提出了一个很好的观点，即这样做可以断言[类型安全](http://en.wikipedia.org/wiki/Type_safety)。我认为这已经足够重要了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T22:25:41.263

这取决于你想用它们做什么。

你可能永远不会对它们进行算术运算，但是排序呢？整数的排序方式与字符串不同。您希望它们为 1、10、2 等吗？如果不是，则使用整数或特殊的排序方法。

另一方面，使用字符串将允许以后使用更多类型的“数字”。例如“10090A”。并且不会像整数那样出现溢出问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T23:19:22.653

Igor Krovokon 已经说过了，但我想详细说明一下。

为什么你认为酒店号码的内容是一个数字？“12”不是数字。它是一个包含几个数字的字符串。你不能取房间 #153 的平方根，但你可以用数字 153 来做。

酒店房间号不**表现**为数字。数字是一个数学概念，可以用多种不同的方式在文本中表示。14 可以用罗马数字写成 XIV、“十四”或十六进制的 0xfe，或二进制的 11111110。但是如果你问“房间一一一一一一一一零”，酒店工作人员很可能会给你一个很奇怪的表情。

酒店房间号不是数学数字，因此不应以整数表示。

那么他们是字符串吗？是的，或多或少，但正如您所注意到的，它们确实有一些额外的限制。

并非每个字符串都是有效的酒店号码。“14”很好，但“西瓜”不是。

所以理想情况下，它应该被表示为一种抽象数据类型，它包装了一个字符串，并确保字符串中不存在非数字。

当然，在实践中，如果您采用简单的方法并将房间号表示为整数或字符串，那么您不太可能遇到很多问题。但最好的设计是确保房间号与房间号一样。字符串或整数都不这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T22:17:16.943

不不一定是错的。但是您可能需要考虑重命名变量以反映它是一个字符串。我认为对于是否应该将其保留为数字或将其转换为字符串没有一个简单的答案。这取决于实际情况。如果您选择将其作为整数存储在应用程序中，并且必须在代码中将其转换为字符串 1000 次，那么可能值得将其转换为字符串一次。您必须根据情况考虑权衡取舍。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T22:17:59.297

我同意@Eric。您会发现，如果将其声明为字符串，则将其解析为 int 或将其强制为 int 都会出错。只需使用一个int。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T22:28:54.783

我不同意埃里克。

开发中没有“始终”的规则。

如果您主要将此变量用作字符串，则将其存储为字符串更有意义，并从变量名称中丢失“数字”。

如果你对这个变量做更多的数值运算，那么它是一个数字，应该存储为一个数值，并转换一个字符串作为字符串使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T22:30:01.300

将名称更改为 hotelPropertyIdentifier 是否有意义？这可能会避免调用某个号码的所有含义。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-19T22:41:31.123

您始终可以创建一个公共的“HotelPropertyNumber()”函数，该函数将数字作为字符串返回，但 int 仍被隐藏起来。

如果您决定确实不需要幕后的 int，HotelPropertyNumber() 可以只返回私有字符串。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-19T23:40:24.030

永远不要说总是。它可能并不总是用数字表示。例如，图14可以细分为14a和14b。或者 21 和 22 可以合并为 21-22。这比和他们做算术更有可能。

查看街道地址，它通常以数字开头。（也非常接近的类比。）

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-06-19T22:55:37.600

这本身并不是一个*坏习惯，但它可能会在以后导致麻烦。*

现在从个人经验说起：我曾经是存储数值的忠实粉丝，这些数值总是将用作字符串变量中的字符串。我的意思是，为什么不呢，对吧？为您节省了所有繁琐的选角和诸如此类的事情，您可以继续解决问题的真正实质。（当然，决定午餐点什么。）

然后，我花了一天的大部分时间试图弄清楚为什么实时系统会抛出各种疯狂的异常。原来我在数据中看到的“1”实际上是一个小写的“l”。

然后，正如他们所说，我开悟了。

（当然，这可以根据您使用的语言而改变。在 Java 之类的东西中，几行类定义就可以解决所有这些问题。在 Python 或 Perl 中，这个问题甚至没有任何意义——语言只是“做对了”。好吧，无论如何，对于“正确”的一些定义。）

# python - python中的自引用类定义

> ID：1020279
> 
> 赞同：21
> 
> 时间：2009-06-19T22:14:40.473
> 
> 标签：python

有没有办法从类声明中引用类名？一个例子如下：

```
class Plan(SiloBase):
    cost = DataField(int)
    start = DataField(System.DateTime)
    name = DataField(str)
    items = DataCollection(int)
    subPlan = ReferenceField(Plan) 
```

我有一个读取这些信息并进行一些设置的元类，并且基类实现了一些常见的保存内容。我希望能够创建这样的递归定义，但到目前为止，在我的实验中，我一直无法获得我想要的效果，通常会遇到“计划未定义”错误。我明白发生了什么，类的名称不在类的范围内。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-19T22:18:31.700

**尝试这个：**

```
class Plan(SiloBase):
    cost = DataField(int)
    start = DataField(System.DateTime)
    name = DataField(str)
    items = DataCollection(int)

Plan.subPlan = ReferenceField(Plan) 
```

**或者`__new__`像这样使用：**

```
class Plan(SiloBase):

    def __new__(cls, *args, **kwargs):
        cls.cost = DataField(int)
        cls.start = DataField(System.DateTime)
        cls.name = DataField(str)
        cls.items = DataCollection(int)
        cls.subPlan = ReferenceField(cls)
        return object.__new__(cls, *args, **kwargs) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-19T23:15:00.057

> 我有一个元类可以读取这些信息并进行一些设置

大多数使用元类的框架都提供了解决此问题的方法。例如，[Django](http://docs.djangoproject.com/en/1.0/ref/models/fields/#foreignkey)：

```
subplan = ForeignKey('self') 
```

[谷歌应用引擎](http://code.google.com/appengine/docs/python/datastore/typesandpropertyclasses.html#SelfReferenceProperty)：

```
subplan = SelfReferenceProperty() 
```

诸如稍后添加附加属性或使用等解决方案的问题`__new__`在于，大多数 ORM 元类都希望类属性在创建类时存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T22:23:54.027

> 我明白发生了什么，类的名称不在类的范围内。

不完全是。定义其内容（例如范围）时，**尚未定义**类的名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-21T07:29:28.640

Sine Python 3.7 和[PEP 563](https://www.python.org/dev/peps/pep-0563/)有办法做到这一点。

添加导入

```
from __future__ import annotations 
```

以下代码将起作用

```
from __future__ import annotations
from typing import List

class Refer(object):
    def __init__(self, x: Plan):
        self.x: Plan = x

class Plan(object):
    def __init__(self):
        pass
    subPlan: Refer(Plan()) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T22:20:47.733

不，你不能那样做。想想如果你这样做会发生什么：

```
 OtherPlan = Plan
 other_plan = OtherPlan() 
```

在 的实例化时`other_plan`，类的名称是什么？

无论如何，这种事情最好在`__new__`方法中完成，它接受一个`cls`引用类的参数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-19T16:55:00.670

可以使用 python3 中的以下代码执行此操作。我们使用 cached_property 只评估 Player.enemyPlayer 一次，然后返回缓存的结果。因为我们的值来自函数，所以在第一次加载类时不会对其进行评估。

```
class cached_property(object):
    # this caches the result of the function call for fn with no inputs
    # use this as a decorator on function methods that you want converted
    # into cached properties
    def __init__(self, fn):
        self._fn = fn

    def __set_name__(self, owner, name):
        # only works in python >= 3.6
        self.name = name
        self._cache_key = "_" + self.name

    def __get__(self, instance, cls=None):
        if self._cache_key in vars(self):
            return vars(self)[self._cache_key]
        else:
            result = self._fn()
            setattr(self, self._cache_key, result)
            return result

class Player:
    @cached_property
    def enemyPlayer():
        return Player 
```

# sql-server - 在 SQL Server 的单个 XQuery 中删除多个节点

> ID：1020305
> 
> 赞同：5
> 
> 时间：2009-06-19T22:25:11.030
> 
> 标签：sql-server, xml, sql-server-2005, xpath, xquery

我有：

1.  带有**xml**类型列的表（ID 列表）
2.  一个**xml**类型参数（也是 ID 列表）

从与参数中的节点匹配的列中删除节点的最佳方法是什么，同时保留任何不匹配的节点？

例如

```
declare @table table (
    [column] xml
)

insert @table ([column]) values ('<r><i>1</i><i>2</i><i>3</i></r>')

declare @parameter xml
set @parameter = '<r><i>1</i><i>2</i></r>'

-- this is the problem
update @table set [column].modify('delete (//i *where text() matches @parameter*)') 
```

MSDN 文档表明它应该是可能的（[在 SQL Server 2005 中的 XQuery 简介中](http://technet.microsoft.com/en-us/library/ms345122.aspx)）：

> 可以轻松修改此存储过程以接受包含一个或多个技能元素的 XML 片段，从而允许用户通过一次存储过程调用删除多个技能节点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-20T02:55:52.450

您需要以下形式的内容：

```
[column].modify('delete (//i[.=(1, 2)])') -- like SQL IN
-- or
[column].modify('delete (//i[.=1 or .=2])')
-- or
[column].modify('delete (//i[.=1], //i[.=2])')
-- or
[column].modify('delete (//i[contains("|1|2|",concat("|",.,"|"))])') 
```

XQuery 在 SQL2005 中不支持 xml SQL 类型，并且 modify 方法只接受字符串文字（不允许使用变量）。

这是一个带有 contains 功能的丑陋黑客：

```
declare @table table ([column] xml)
insert @table ([column]) values ('<r><i>1</i><i>2</i><i>3</i></r>')

declare @parameter xml
set @parameter = '<r><i>1</i><i>2</i></r>'

-- build a pipe-delimited string
declare @in nvarchar(max)
set @in = convert(nvarchar(max),
    @parameter.query('for $i in (/r/i) return concat(string($i),"|")')
  )
set @in = '|'+replace(@in,'| ','|')

update @table set [column].modify ('
  delete (//i[contains(sql:variable("@in"),concat("|",.,"|"))])
  ')
select * from @table 
```

这是另一个带有动态 SQL 的代码：

```
-- replace table variable with temp table to get around variable scoping
if object_id('tempdb..#table') is not null drop table #table
create table #table ([column] xml)
insert #table ([column]) values ('<r><i>1</i><i>2</i><i>3</i></r>')

declare @parameter xml
set @parameter = '<r><i>1</i><i>2</i></r>'

-- we need dymamic SQL because the XML modify method only permits string literals
declare @sql nvarchar(max)
set @sql = convert(nvarchar(max), 
    @parameter.query('for $i in (/r/i) return concat(string($i),",")')
  )
set @sql = substring(@sql,1,len(@sql)-1)
set @sql = 'update #table set [column].modify(''delete (//i[.=('+@sql+')])'')'
print @sql
exec (@sql)

select * from #table 
```

如果要更新 xml 变量而不是列，请使用 sp_executesql 和输出参数：

```
declare @xml xml
set @xml = '<r><i>1</i><i>2</i><i>3</i></r>'

declare @parameter xml
set @parameter = '<r><i>1</i><i>2</i></r>'

declare @sql nvarchar(max)
set @sql = convert(nvarchar(max), 
    @parameter.query('for $i in (/r/i) return concat(string($i),",")')
  )
set @sql = substring(@sql,1,len(@sql)-1)
set @sql = 'set @xml.modify(''delete (//i[.=('+@sql+')])'')'
exec sp_executesql @sql, N'@xml xml output', @xml output

select @xml 
```

使用游标迭代删除值的替代方法，由于多次更新，效率可能较低：

```
declare @table table ([column] xml)
insert @table ([column]) values ('<r><i>1</i><i>2</i><i>3</i></r>')

declare @parameter xml
set @parameter = '<r><i>1</i><i>2</i></r>'

/*
-- unfortunately, this doesn't work:
update t set [column].modify('delete (//i[.=sql:column("p.i")])')
from @table t, (
  select i.value('.', 'nvarchar')
  from @parameter.nodes('//i') a (i)
  ) p (i)
select * from @table
*/

-- so we have to use a cursor
declare @cursor cursor
set @cursor = cursor for
  select i.value('.', 'varchar') as i
  from @parameter.nodes('//i') a (i)

declare @i int
open @cursor
while 1=1 begin
  fetch next from @cursor into @i
  if @@fetch_status <> 0 break
  update @table set [column].modify('delete (//i[.=sql:variable("@i")])')
end

select * from @table 
```

有关 SQL2005 中 XML 变量限制的更多信息，请参见此处：

[http://blogs.msdn.com/denisruc/archive/2006/05/17/600250.aspx](http://blogs.msdn.com/denisruc/archive/2006/05/17/600250.aspx)

有没有人有更好的方法？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-22T17:54:37.947

虽然这样做有点尴尬，但如果您的数据很简单（例如您提供的示例），您可以进行更新以更改数据。以下查询基本上会将两个 XML 字符串拆分为表，将它们连接起来，排除非空（匹配）值，并将其转换回 XML：

```
UPDATE @table 
SET [column] = (
    SELECT p.i.value('.','int') AS c
    FROM [column].nodes('//i') AS p(i)
    OUTER APPLY (
        SELECT x.i.value('.','bigint') AS i
        FROM @parameter.nodes('//i') AS x(i)
        WHERE p.i.value('.','bigint') = x.i.value('.','int')
    ) a
    WHERE a.i IS NULL
    FOR XML PATH(''), TYPE
) 
```

# actionscript-3 - ActionScript 中的组合框错误

> ID：1020309
> 
> 赞同：0
> 
> 时间：2009-06-19T22:25:35.320
> 
> 标签：actionscript-3

我试图根据文本框中的值过滤组合框数据提供程序。当 dataprovider 的内容发生变化时，Combo box 会自动调用 change 事件方法。请在下面找到示例代码。

过滤器实用功能：

```
private function filterLocations(event:FocusEvent):void {
    locationsList1.filterFunction = filterUtility;  
    locationsList1.refresh();                           
}   

public function filterUtility(item:Object):Boolean {
// pass back whether the location square foot is with in the range specified

if((item.SQUARE_FOOTAGE >= rangeText1.text) && (item.SQUARE_FOOTAGE rangeText2.text))
    return item.SQUARE_FOOTAGE;
} 

// THIS WOULD BE CALLED WHEN COMBO BOX SELECTION IS DONE 
private function selectLocationsReports(event:ListEvent):void {
    selectedItem =(event.currentTarget as ComboBox).selectedItem.LOCATION_ID;
} 
```

当 DataProvider 被刷新时，它会自动调用 change 方法并抛出 Null Pointer 函数，因为它过早地调用了上述 selectLocationsReports 方法并抛出错误。

有人可以让我知道如何在刷新数据提供者时阻止 CHANGE 事件的传播。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T23:32:44.933

要做的另一件事（在 Kekoa 的响应之上）是在事件处理程序中放置一个 if 语句，并在开始使用它之前检查以确保数据存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T23:47:07.137

我经常为此使用的一个方便的语法是

如果（数据提供者名称）{

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T23:25:52.890

您无法停止 CHANGE 事件，除非您准备好获取事件，否则不要添加事件侦听器。我看不到您的 Event.CHANGE 事件侦听器在上面的代码中的位置。

`addEventListener(Event.CHANGE, selectLocationsReports)`请确保在您的 ComboBox 准备好之前 不要这样做。

# open-source - 有哪些网站可以寻找开源项目？

> ID：1020311
> 
> 赞同：4
> 
> 时间：2009-06-19T22:25:59.500
> 
> 标签：open-source

我目前是一名顾问，但我发现我已经很长时间没有进行编码了。

所以我想知道除了 sourceforge.net 之外是否还有其他不错的网站可以让我进行一些编码。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T22:27:45.207

[sourceforge.net](http://sourceforge.net) - 各种开源软件，从 Linux 到 BSD 到 Windows。

[codeplex.com](http://codeplex.com) - 主要以 Microsoft 技术为重点。在这里您可以找到更多 .NET 开源内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T22:35:44.097

有关开源软件的一般索引，请参阅[freshmeat](http://freshmeat.net/)和[Ohloh](http://ohloh.net/)。前者是开源软件的经典索引，后者统计了每个项目的源代码，如果你想判断一个项目的活跃程度，这可能会很方便。

如果您想轻松加入，分布式修订控制是不错的选择。[Mercurial ( Bitbucket](http://bitbucket.org/) )、Git ( [Github](http://github.com/) ) 和 Bazaar ( [Launchpad](http://launchpad.net/) )的大型托管网站应该为您提供大量可供浏览的项目，并希望为您做出贡献:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-05T16:33:24.913

[OpenHatch (openhatch.org)](http://openhatch.org)很漂亮 (IMO)，因为：

*   该站点提供了一些来自免费开源软件 (FOSS) 项目的“一口大小”错误。
*   有一张地图显示您所在地区的注册用户，以及他们参与的语言和项目。
*   该站点提供了一个带有轮换“反垃圾邮件盐”的电子邮件转发地址，其他贡献者可以通过该地址与您联系。（您可以选择是否使用此功能，或提供其他方式在网站上与您联系。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T22:29:11.333

此外，还有[Github](http://github.com/)和[Google Code](http://code.google.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T22:30:11.113

[谷歌代码](http://code.google.com/hosting/)。

IMO，比 SourceForge 好得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-05T16:54:59.753

We can not say that one website is better, it depends on the domain you work, so your best friend is well [http://www.google.com](http://www.google.com) with your keywords

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T23:14:14.130

有很多服务不足的开源领域，你可以给你额外的时间。

您不必做其他人都在做的事情，例如，浪费大量时间的 CMS 项目，而 Java 中似乎没有合适的 OCR，毫无疑问，Jira 是一个很棒的问题跟踪系统，但是它不是开源的，Bugzilla 很烂，别说 Mantis，Eventum 是用 PHP 写的（我是 Java 狂热者）

开源项目的最佳来源当然是 sourceforge.net，Google 代码，不多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T22:27:55.923

Google [Summer of Code](http://code.google.com/soc/)怎么样？

如果您只是在寻找一个小型快速项目，[Clusterify](http://www.clusterify.com/projects/)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T22:34:34.177

[Ohloh](http://www.ohloh.net/)是另一个很好的开源项目集合。它提供详细信息、时间表和注释。

# design-patterns - 单身人士真的那么糟糕吗？

> ID：1020312
> 
> 赞同：54
> 
> 时间：2009-06-19T22:26:18.000
> 
> 标签：design-patterns, singleton

> **可能的重复：**
> [单身人士有什么不好的？](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)

很多设计模式在某些情况下会被滥用是可以理解的，就像妈妈常说的：“*太多的好东西并不总是好的！* ”

我注意到这些天来，我经常使用 Singletons，我担心我自己可能会滥用设计模式，并且越来越深入地养成一种不良实践的习惯。

我们正在开发一个 Flex 应用程序，它有一个相当大的分层数据结构，在用户处理它时保存在内存中。用户可以按需加载、保存、更改和刷新数据。

这些数据通过 Singleton 类进行集中，该类聚合了几个 ArrayCollections、Arrays、值对象和其他一些通过 getter 和 setter 公开的本机成员变量。

为了从应用程序的任何地方获取对我们数据的引用，我们执行整个 Model.getInstance() 方法类型的事情，我相信每个人都熟悉。这可以确保我们始终获得相同的数据副本，因为在我们设计时，我们说过在应用程序生命周期内只允许存在一次实例。

例如，从这个中央数据存储库中，我们可以很容易地调度属性更改事件，并且可以有多个引用中央数据的 UI 组件，更新它们的显示以反映已发生的数据更改。

到目前为止，这种方法是有效的，并且被证明对我们的情况非常实用。

然而，我发现，在创建新课程时我有点过于急切了。诸如类应该是单例类，还是应该以其他方式进行管理（例如使用工厂）之类的问题有时会变得有点困难，并带有一些不确定性。

我在哪里用单身人士划清界限？是否有一个很好的指导方针来决定何时使用单例以及何时远离它们。

另外，谁能推荐一本关于设计模式的好书？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-06-19T22:55:24.760

是的，单身人士很糟糕。它们很糟糕，因为它们为您所做的只是结合了两个属性，每个属性在大约 95% 的情况下都很糟糕。（这意味着平均而言，单身人士在 99.75% 的时间里都很糟糕；））

GoF 定义的单例是一种数据结构，它：

1.  授予对对象的全局访问权限，并且
2.  强制对象只能存在一个实例。

第一个通常被认为是一件坏事。我们不喜欢全局变量。第二个有点微妙，但一般来说，几乎没有任何情况下这是一个合理的*强制*限制。

有时，只有一个对象的实例才有意义。在这种情况下，您选择只创建一个。您不需要单例来强制执行它。

通常，即使只有一个实例“有意义”，但事实证明它毕竟没有意义。迟早，您将需要不止一个记录器。或多个数据库。或者您将不得不为每个单元测试重新创建资源，这意味着我们必须能够随意创建它们。在我们了解后果之前，它过早地从我们的代码中删除了灵活性。

单例隐藏依赖并增加耦合（每个类都可能依赖单例，这意味着该类不能在其他项目中重用，除非我们也重用所有单例），并且因为这些依赖不是立即可见的（作为函数/构造函数参数)，我们不会注意到它们，并且在创建它们时通常不会考虑它。只引入一个单例非常容易，它几乎充当了一个局部变量，所以一旦它们在那里，我们就会经常使用它们。这使得它们几乎不可能再次移除。你最终可能不是意大利面条代码，而是意大利面条依赖图。迟早，你失控的依赖将意味着单例开始相互依赖，然后当你尝试初始化一个时，你会得到循环依赖。

它们使单元测试变得非常困难。（您如何测试调用单例对象上的函数的函数？我们不希望执行实际的单例代码，但我们如何防止这种情况发生？

是的，单身人士很糟糕。

有时，你真的想要一个全球性的。然后使用全局，而不是单例。

有时，非常非常非常罕见，您可能会遇到创建类的多个实例是错误的情况，在这种情况*下无法*在不导致错误的情况下完成。（关于我能想到的唯一一种情况，即使这是人为的，如果你代表一些硬件设备。你只有一个 GPU，所以如果你要将它映射到代码中的一个对象，它会有意义的是只能存在一个实例）。但是，如果您发现自己处于这种情况（再次强调，是多个实例导致严重错误的情况，而不仅仅是“我无法为多个实例考虑任何用例”的情况），然后强制执行该约束，但在不使对象全局可见的情况下这样做。

在极少数情况下，这两个属性中的每一个*都*可能有用。但我想不出将它们*结合*起来会是一件好事的单一案例。

不幸的是，很多人都认为“单例是符合 OOP 的全局变量”。不，他们不是。**除了**引入其他一些完全不相关的问题之外，它们仍然遭受与全局变量相同的问题。绝对没有理由更喜欢单例而不是普通的旧全局。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-06-19T22:29:13.003

要记住的关键是设计模式只是帮助您理解抽象概念的工具。一旦您有了这种理解，将自己专门限制在书中的“食谱”上是没有意义的，并且会损害您编写最适合您的目的的代码的能力。

也就是说，阅读诸如 GoF 之类的书籍将为您提供更多思考问题的方法，以便在您自己实施某些事情时，您将拥有更广泛的视角来解决问题。

在您的情况下，如果在每种情况下使用单例都有意义，那么请继续。如果它“有点”合适并且您必须以某种笨拙的方式实现它，那么您需要提出一个新的解决方案。强迫一个不完美的图案有点像在一个圆孔中锤一个方形钉子。

鉴于您说“这种方法是有效的，并且证明对我们的情况非常实用”，我认为您做得很好。

这里有一些好书：

[Gang of Four Book](https://rads.stackoverflow.com/amzn/click/com/0201633612) - 设计模式的经典书籍

[Head First Design Patterns](https://rads.stackoverflow.com/amzn/click/com/0596007124) - 我听过一些人推荐这个作为替代方案

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-03-24T20:53:38.063

软件开发人员似乎相当平均地分为两个阵营，这取决于他们喜欢理想主义的编码风格还是务实的风格：

*   理想主义：*永远不要*使用单例模式。
*   务实：*避免*单例模式。

就个人而言，我赞成务实的方法。有时打破规则是有意义的，但前提是您真正了解自己在做什么并愿意接受相关风险。如果您可以对以下有关您的特定用例的问题回答“是”，那么单例模式可以产生一些实际的好处。

*   单例是否在您的应用程序外部？数据库、队列服务和 ESB 都是单例模式的完全有效的宏示例。
*   KISS：您的整个应用程序是否仅限于 2-3 个内部单例？
*   DRY：这些单例是否天生是全局的，因此会导致必须在您的应用程序中对几乎每个对象进行引用？（例如，记录器或组件中介）？
*   您的单例是否仅相互依赖和/或操作环境？
*   您是否确保了每个单例的正确启动和关闭顺序，包括内存管理注意事项？例如，“Grand Central”风格的线程池可能需要在 main() 中有实例 Run() 和 Shutdown() 方法，以便保证任务仅在它们操作的对象处于有效状态时运行。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-06-19T22:42:17.017

单身人士不会杀死程序，程序员会杀死程序。

像任何编程结构一样，如果使用得当，您不会自责。

推荐的书籍很好，但它们并不总是提供足够的背景知识来说明您何时可以选择使用 Singleton。

只有当你发现单例是一个糟糕的选择时，你才会有这种体验，当你需要有多个实例时，突然之间，你在到处注入对象引用时遇到了很多麻烦。

有时最好继续使用对象引用，但是如果您必须将其重构为不同的设计，您使用 Singleton 的事实确实有助于确定您将面临的问题的范围。我认为这是一件非常好的事情：即只拥有一个类（即使设计不佳）就可以看到改变类的效果。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-08-14T00:20:27.093

在我看来，单例的使用直接表明了设计缺陷。原因很简单，它们允许绕过 C++ 中内置的正常对象创建和销毁机制。如果一个对象需要对另一个对象的引用，它应该在构造时传入对它的引用，或者在内部创建它的新实例。但是，当您使用单例时，您会明确地混淆创建和拆卸周期。一个相关的问题是控制单例的生命周期是极其困难的。因此，许多包含通用单例实现的包还包括笨重的对象生命周期管理器等。有时我想知道这些是否只是为了管理单身人士而存在。

基本上，如果您需要在许多地方使用一个对象，则应该在堆栈中的最高公共点显式创建它，然后通过引用传递给使用它的每个人。有时人们使用单例，因为他们在将多个参数传递给新线程时遇到问题，但不要为此而堕落，明确定义你的线程参数并以相同的方式将它们传递给新线程。您会发现您的程序流程更加清晰，并且不会因为静态初始化依赖或错误的拆卸而出现令人讨厌的意外。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-10-14T17:42:29.893

我们已经开始了一个项目，我们基本上面临着同样的问题，即如何**访问模型**，尤其是它的根元素。该项目不是一个 Flex 应用程序，而是一个游戏！网络应用程序，但这并不重要。

在系统中拥有一个**唯一的对象**很好，问题是**如何访问它**。所以关于单例的争论与**依赖注入**（DI）的概念以及如何获取对象有关。

DI 的主要论据如下：

*   可测试性和模拟
*   将对象实例化与使用分离（这可能导致生命周期管理）
*   关注点分离

DI 的可能方法是（参见 Fowler 的经典[文章](http://martinfowler.com/articles/injection.html)）：

*   在方法参数中传递对象
*   服务定位器
*   DI框架

从这个角度来看，单例模式只是一种服务定位器，例如`Model.getInstance()`。

但是为了在面对未来的变化时提供最大的灵活性，对唯一对象的引用应该尽可能多地**传递**`Model.getInstance()`，并且只在必要时获取。这也将产生更清晰的代码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-19T22:51:52.397

单身人士当然不错。它们有它们的用途，其中一些非常好。单例确实容易被缺乏经验的开发人员过度使用，因为它通常是他们了解的第一个设计模式，而且它相当简单，所以他们把它到处乱扔，而不考虑其中的含义。

每次你想使用单例时，试着考虑一下你为什么要这样做，以及使用这种模式的好处和坏处。

单例确实有效地创建了一组全局可访问的“东西”（数据或方法），我认为大多数人会同意使用太多全局变量不是一个好主意。类和面向对象的全部意义在于将事物分组到离散的区域中，而不是仅仅将所有内容都放入一个巨大的全局空间中。

我发现我倾向于比单例更喜欢的“模式”之一是从顶部向下传递所需的对象。我在我的应用程序初始化阶段创建它们一次，然后将它们传递给所有需要访问它们的对象。它模仿了单例模式的“单一创建”部分，但没有“全局”部分。

单例的全部意义在于它适用于只应该存在 1 的对象。您提到了一组数据控制类。也许考虑一下，实际上，在某些情况下，应用程序可能想要创建 2 组数据控制类，因此对此强制执行单例可能不太正确。相反，如果您在应用程序初始化时创建了这些数据类，并将它们传递下来，您将只创建 1 个集合，因为这是您当前应用程序需要的，但是您可能会在某些时候需要第二个集合您可以轻松地创建它们。此外，数据控制类是否真的可以从应用程序的任何地方全局访问。我认为不是，相反，它们可能只能从较低级别的数据访问层访问。

有人推荐了 GOF 书。我会说，是的，那是一本很棒的书，但首先尝试找到一本关于通用架构的书，先阅读关于 2/3/n 层设计、封装、抽象和这些原则的内容。这将为您提供更坚实的基础来理解 GOF 讨论的模式的适当用法。

[编辑：单例变体可能有用的另一种情况是，当你想要一个访问点的时候，但实现细节实际上可能不止一件事。调用者不需要知道，在幕后他们对单例对象的请求实际上是针对几个可用对象解决的，并返回一个。我在想这里的线程池之类的东西，用在哪里，嘿，给我一个线程，我需要1，但我不在乎哪个]

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-05-11T15:17:34.040

我知道这是一个旧线程，但似乎没有人提到适合 OP 试图做的实际模式。我相信他所描述的需求被称为[Mediator Pattern](http://sourcemaking.com/design_patterns/mediator)。SourceMaking 是学习/参考此类信息的绝佳网站。绝对是我向人们介绍软件模式的地方。此外，不要相信任何设计模式本质上都是善或恶的，这通常是一个好主意。它们都有自己的用途，只有学习何时何地使用它们才是诀窍。对我来说，那些声明从不使用单例的人不了解它们的用处。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-19T22:27:54.583

不，它们不一定是坏的。

至于一本书，你需要从[经典](https://rads.stackoverflow.com/amzn/click/com/0201633612)入手。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-19T22:30:02.080

单身人士并不是“那么糟糕”。如果您有很多相关的单例，并且您可以使用工厂替换/合并其中的一些，而不会丢失您关心的任何内容，那么您应该这样做。

至于书，[嗯，有一种经典](https://rads.stackoverflow.com/amzn/click/com/0201633612)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-19T22:32:48.487

我认为[单身人士很好](http://c2.com/cgi/wiki?SingletonsAreGood)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-20T01:09:43.850

谷歌似乎[确信](http://code.google.com/p/google-singleton-detector/)单例是一个坏主意。

这并不是说谷歌所做的一切都是完美的，或者他们的每一个意见都是任何争论的结束，但他们甚至编写了这个 Singleton 检测器来根除它们。你自有主张。

# python - 如何在 Python 中进行 PGP（生成密钥、加密/解密）

> ID：1020320
> 
> 赞同：40
> 
> 时间：2009-06-19T22:28:46.123
> 
> 标签：python, encryption, public-key-encryption, gnupg, pgp

我正在用 Python 制作一个程序，通过安装程序分发给 Windows 用户。

该程序需要能够每天下载使用用户公钥加密的文件，然后对其进行解密。

所以我需要找到一个 Python 库，它可以让我生成 PGP 公钥和私钥，并解密用公钥加密的文件。

这是 pyCrypto 会做的事情吗（文档很模糊）？还有其他纯 Python 库吗？任何语言的独立命令行工具怎么样？

到目前为止，我所看到的只是 GNUPG，但在 Windows 上安装它会对注册表产生影响，并且到处抛出 dll，然后我不得不担心用户是否已经安装了这个，如何备份他们现有的密钥环等。我宁愿只需拥有一个 python 库或命令行工具并自己管理密钥。

更新：pyME 可能有效，但它似乎与我必须使用的 Python 2.4 不兼容。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-06-27T22:12:35.683

您不需要`PyCrypto`or `PyMe`，尽管这些软件包可能是好的 - 您将在 Windows 下构建各种问题。相反，为什么不避开兔子洞，做我所做的呢？使用`gnupg 1.4.9`. 您不需要在最终用户机器上进行完整安装 - 只需`gpg.exe`从`iconv.dll`分发版安装就足够了，您只需要将它们放在路径中的某个位置或使用完整路径名从 Python 代码访问。无需更改注册表，如果需要，所有内容（可执行文件和数据文件）都可以限制在一个文件夹中。

有一个模块`GPG.py`最初由 Andrew Kuchling 编写，由 Richard Jones 改进并由 Steve Traugott 进一步改进。它在[此处](https://web.archive.org/web/20090921072827/http://trac.t7a.org/isconf/browser/trunk/lib/python/isconf/GPG.py)可用，但不适合 Windows，因为它使用`os.fork()`. 虽然最初是其中的一部分`PyCrypto`，**但它完全独立于其他部分，`PyCrypto`只需要 gpg.exe/iconv.dll 即可工作**。

我有一个`gnupg.py`派生自 Traugott's 的版本 ( ) `GPG.py`，它使用该`subprocess`模块。它在 Windows 下运行良好，至少对我来说是这样——我用它来执行以下操作：

*   密钥管理 - 生成、列表、导出等。
*   从外部来源导入密钥（例如从合作伙伴公司收到的公钥）
*   加密和解密数据
*   签署和验证签名

我拥有的模块现在不适合展示，因为它包含一些不应该存在的其他内容 - 这意味着我目前无法按原样发布它。在某个时候，也许在接下来的几周内，我希望能够整理它，添加更多单元测试（例如，我没有任何用于签名/验证的单元测试）并发布它（或者在原始`PyCrypto`许可证或类似的商业友好许可证）。如果您迫不及待，请使用 Traugott 的模块并自己修改它 - 使其与`subprocess`模块一起工作并没有太多工作。

这种方法比我考虑并尝试过的其他方法（例如`SWIG`基于 - 的解决方案或需要使用`MinGW`/构建的解决方案）痛苦得多。`MSYS`我对用其他语言编写的系统使用了相同的 ( `gpg.exe`/ ) 方法，例如，同样没有痛苦的结果。`iconv.dll``C#`

PS 它适用于 Python 2.4 以及 Python 2.5 及更高版本。没有用其他版本测试过，虽然我没有预见到任何问题。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2017-10-10T11:41:13.180

经过大量挖掘，我找到了一个适合我的包。虽然说支持生成密钥，但我没有测试。但是，我确实设法解密了使用 GPG 公钥加密的消息。这个包的优点是它不需要机器上的 GPG 可执行文件，并且是 OpenPGP 的基于 Python 的实现（而不是可执行文件的包装器）。我使用 GPG4win 和 kleopatra for windows 创建了私钥和公钥，请参阅下面的代码。

```
import pgpy
emsg = pgpy.PGPMessage.from_file(<path to the file from the client that was encrypted using your public key>)
key,_  = pgpy.PGPKey.from_file(<path to your private key>)
with key.unlock(<your private key passpharase>):
    print (key.decrypt(emsg).message) 
```

虽然这个问题很老了。我希望这对未来的用户有所帮助。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-24T08:30:10.367

PyCrypto 支持 PGP - 尽管您应该对其进行测试以确保它符合您的规范。

尽管很难找到文档，但如果您查看 Util/test.py（模块测试脚本），您可以找到其 PGP 支持的基本示例：

```
if verbose: print '  PGP mode:',
obj1=ciph.new(password, ciph.MODE_PGP, IV)
obj2=ciph.new(password, ciph.MODE_PGP, IV)
start=time.time()
ciphertext=obj1.encrypt(str)
plaintext=obj2.decrypt(ciphertext)
end=time.time()
if (plaintext!=str):
    die('Error in resulting plaintext from PGP mode')
print_timing(256, end-start, verbose)
del obj1, obj2 
```

此外，PublicKey/pubkey.py 提供了以下相关方法：

```
def encrypt(self, plaintext, K)
def decrypt(self, ciphertext):
def sign(self, M, K):
def verify (self, M, signature):
def can_sign (self):
    """can_sign() : bool
    Return a Boolean value recording whether this algorithm can
    generate signatures.  (This does not imply that this
    particular key object has the private information required to
    to generate a signature.)
    """
    return 1 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-24T16:03:44.223

[PyMe](http://pyme.sourceforge.net/)确实声称与 Python 2.4 完全兼容，我引用：

> PyMe 的最新版本（在撰写本文时）是 v0.8.0。它的 Debian 二进制发行版是使用 SWIG v1.3.33 和 GCC v4.2.3 编译的，用于 GPGME v1.1.6 和 Python v2.3.5、v2.4.4 和 v2.5.2（当时以“不稳定”发行版提供）。它的 Windows 二进制发行版是使用 SWIG v1.3.29 和 MinGW v4.1 编译的，用于 GPGME v1.1.6 和 Python v2.5.2（尽管安装了相同的二进制文件并且在 v2.4.2 中也可以正常工作）。

我不确定你为什么说“它似乎与我必须使用的 Python 2.4 不兼容”——请具体说明一下？

是的，它确实作为 GPGME 上的半 Pythonic (SWIGd) 包装器存在——一旦你拥有一个基本上可以完成这项工作的 C 库，这是开发 Python 扩展的一种流行方式。

[PyPgp](http://softlayer.dl.sourceforge.net/sourceforge/pypgp/pgp.py)有一个更简单的方法——这就是为什么它是一个单一的、简单的 Python 脚本：基本上它只是对命令行 PGP 命令进行“shell out”。例如，解密只是：

```
def decrypt(data):
    "Decrypt a string - if you have the right key."
    pw,pr = os.popen2('pgpv -f')
    pw.write(data)
    pw.close()
    ptext = pr.read()
    return ptext 
```

即，将加密后的密文写入 的标准输入`pgpv -f`，读取 pgpv 的标准输出作为解密后的明文。

PyPgp 也是一个非常古老的项目，尽管它的简单性意味着使其与现代 Python 一起工作（例如，子进程而不是现在已弃用的 os.popen2）并不难。但是您仍然需要安装[PGP](http://www.pgp.com/)，否则 PyPgp 不会做任何事情；-)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-25T04:10:59.127

[M2Crypto](http://chandlerproject.org/Projects/MeTooCrypto)有 PGP 模块，但我实际上从未尝试过使用它。如果您尝试了它并且它有效，请告诉我（我是当前的 M2Crypto 维护者）。一些链接：

*   [模块源](http://svn.osafoundation.org/m2crypto/trunk/M2Crypto/PGP/)
*   [演示脚本](http://svn.osafoundation.org/m2crypto/trunk/demo/pgp/pgpstep.py)
*   [单元测试](http://svn.osafoundation.org/m2crypto/trunk/tests/test_pgp.py)

**更新：** PGP 模块不提供生成密钥的方法，但推测这些可以使用较低级别的[RSA](http://www.heikkitoivonen.net/m2crypto/api/M2Crypto.RSA-module.html)、[DSA](http://www.heikkitoivonen.net/m2crypto/api/M2Crypto.DSA-module.html)等模块创建。我不知道 PGP 的内幕，所以你必须挖掘细节。此外，如果您知道如何使用 openssl 命令行命令生成这些，那么将其转换为 M2Crypto 调用应该相当容易。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-07-31T18:26:43.300

正如其他人所指出的，PyMe 是这方面的规范解决方案，因为它基于 GpgME，它是 GnuPG 生态系统的一部分。

对于 Windows，我强烈建议使用[Gpg4win](http://www.gpg4win.org)作为 GnuPG 发行版，原因有两个：

它基于 GnuPG 2，其中包括`gpg2.exe`，它可以（最后，我可能会添加 :)`gpg-agent.exe`按需启动（gpg v1.x 不能）。

其次，它是 GnuPG 开发人员唯一的官方 Windows 版本。例如，它完全从 Linux 交叉编译到 Windows，因此在准备它时没有使用任何非自由软件（对于安全套件来说非常重要:)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-06-21T20:51:31.077

仅使用导出的公钥文件而不使用密钥环进行签名。

使用 PGPy 0.5.2（纯 Python GPG RFC 实现）：

```
key_fpath = './recipient-PUB.gpg'

rsa_pub, _ = pgpy.PGPKey.from_file(rkey_fpath)
rkey = rsa_pub.subkeys.values()[0]                                                                                                     

text_message = pgpy.PGPMessage.new('my msg')
encrypted_message = rkey.encrypt(text_message)
print encrypted_message.__bytes__() 
```

使用 gpg 1.10.0（gpgme Python 绑定 - 前 PyME）：

```
rkey_fpath = './recipient-PUB.gpg'
cg = gpg.Context()
rkey = list(cg.keylist(source = rkey_fpath))                                                                                                                

ciphertext, result, sign_result = cg.encrypt('my msg', recipients=rkey, sign=False, always_trust=True)
print ciphertext 
```

for 循环中的一个简单基准测试告诉我，对于我的系统上的这个简单操作，PGPy 比 gpgme Python 绑定快约 3 倍（请不要接受这个陈述，因为 X 比 Y 快：我将邀请您在您的环境中进行测试）。

# iphone - 如何以编程方式在 iPhone 中查找可用内存？

> ID：1020327
> 
> 赞同：21
> 
> 时间：2009-06-19T22:31:10.020
> 
> 标签：iphone, objective-c, memory-management

我想知道如何通过 Objective-C 在 iPhone 中以编程方式查找可用内存？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T17:19:15.737

您可以通过以下方式获取物理内存：

```
NSLog(@"physical memory: %d", [NSProcessInfo processInfo].physicalMemory); 
```

可用内存将不是您可以确定的硬数字，因为操作系统会根据需要为您关闭后台应用程序，以便为前台应用程序提供更多内存，以及清除文件缓存等。假设您正在这样做要优化您自己的缓存，您可以根据物理内存构建缓存大小并猜测您应该使用多少。例如，在旧的 128m iphone 3g 上，您的整个应用程序在被杀死之前可能只会获得 10-15meg 的 ram，而全新的 1024meg iphone5 将允许您在操作系统决定杀死您之前获得数百兆字节的 ram .

在[http://en.wikipedia.org/wiki/List_of_iOS_devices查看设备中的内存](http://en.wikipedia.org/wiki/List_of_iOS_devices)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T15:19:30.527

您可以使用[Mach 调用](http://web.mit.edu/darwin/src/modules/xnu/osfmk/man/host_info.html) `host_info(host, flavor, host_info, host_info_count)`。如果用 调用它`flavor=HOST_BASIC_INFO`，则指向的缓冲区`host_info`将填充一个 struct `host_basic_info`，如下所示：

```
struct host_basic_info {
    integer_t               max_cpus;               /* max number of CPUs possible */
    integer_t               avail_cpus;             /* number of CPUs now available */
    natural_t               memory_size;            /* size of memory in bytes, capped at 2 GB */
    cpu_type_t              cpu_type;               /* cpu type */
    cpu_subtype_t           cpu_subtype;            /* cpu subtype */
    cpu_threadtype_t        cpu_threadtype;         /* cpu threadtype */
    integer_t               physical_cpu;           /* number of physical CPUs now available */
    integer_t               physical_cpu_max;       /* max number of physical CPUs possible */
    integer_t               logical_cpu;            /* number of logical cpu now available */
    integer_t               logical_cpu_max;        /* max number of physical CPUs possible */
    uint64_t                max_mem;                /* actual size of physical memory */
} 
```

从这个结构中，你可以得到内存大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-17T12:12:40.490

***斯威夫特 5***

**您的内存大小（以字节为单位）：**

```
let totalRam = ProcessInfo.processInfo.physicalMemory 
```

# asp.net - 使用带有 ASP.NET 的 log4net 来跟踪 Session 变量

> ID：1020331
> 
> 赞同：5
> 
> 时间：2009-06-19T22:32:05.463
> 
> 标签：asp.net, log4net, session-variables

我们的 Web 应用程序捕获用户的登录信息并将其存储在会话变量中，类似于 Session("User_Id")。我想使用 log4net 来捕获日志中的用户。

我看到一些使用 MDC（映射诊断上下文）的引用已被 ThreadContext 属性替换。

有没有人实现过这个 ThreadContext 方法？有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-22T19:43:52.527

在代码中...

```
log4net.ThreadContext.Properties["Log_User"] = userName; 
```

在 web.config 中

```
<appender name="ADONetAppender" type="log4net.Appender.ADONetAppender">
  <bufferSize value="1" />
  <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
  <connectionString value="set in global.asax" />
  <commandText value="INSERT INTO Log4Net ([Log_Date], [Severity],[Application],[Message], [Source], [Log_User]) VALUES (@log_date, @severity, @application, @message, @source, @currentUser)" />
  <parameter>
    <parameterName value="@log_date" />
    <dbType value="DateTime" />
    <layout type="log4net.Layout.RawTimeStampLayout" />
  </parameter>
    ...
  <parameter>
    <parameterName value="@currentUser" />
    <dbType value="String" />
    <size value="100" />
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%property{Log_User}" />
    </layout>
  </parameter>
</appender> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T23:00:44.670

我总是将对所有 Session 变量的访问封装在一个类中。这控制访问，让我使用强类型。我在这门课上做任何日志记录。这是一个例子：

```
public static class SessionInfo
{
    private static readonly ILog log = LogManager.GetLogger(typeof(SessionInfo));

    private const string AUDITOR_ID_KEY = "AuditorId";

    static SessionInfo()
    {
        log.Info("SessionInfo created");
    }

    #region Generic methods to store and retrieve in session state

    private static T GetSessionObject<T>(string key)
    {
        object obj = HttpContext.Current.Session[key];
        if (obj == null)
        {
            return default(T);
        }
        return (T)obj;
    }

    private static void SetSessionObject<T>(string key, T value)
    {
        if (Equals(value, default(T)))
        {
            HttpContext.Current.Session.Remove(key);
        }
        {
            HttpContext.Current.Session[key] = value;
        }
    }

    #endregion

    public static int AuditorId
    {
        get { return GetSessionObject<int>(AUDITOR_ID_KEY); }
        set { SetSessionObject<int>(AUDITOR_ID_KEY, value); }
    }
} 
```

# wpf - WPF：动画自定义依赖属性？

> ID：1020335
> 
> 赞同：0
> 
> 时间：2009-06-19T22:34:26.613
> 
> 标签：wpf, animation, dependency-properties

假设我定义了这样的依赖项：

```
 public class MySampleClass
    {public static DependencyProperty MyDoubleProperty = DependencyProperty.Register("MyDouble", typeof(double), typeof(MySampleClass));
    public double MyDouble
    {
        get
        {
            return (double)GetValue(MyDoubleProperty);
        }
        set
        {
            SetValue(MyDoubleProperty, value);
        }
    }
} 
```

我想对这个值应用一个 DoubleAnimation。我怎样才能做到这一点？以前，我一直通过调用 UIElement 的 BeginAnimation 方法来使用 DoubleAnimations。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T22:55:38.927

您是否尝试在不从 UIElement 继承的类上使用 DoubleAnimation？如果没有，您至少应该从 Animatable 或其他一些也支持 BeginAnimation 的基类继承。

# linq-to-sql - 需要帮助将带有联接和分组依据/计数的查询转换为 LINQ to SQL

> ID：1020341
> 
> 赞同：3
> 
> 时间：2009-06-19T22:36:29.557
> 
> 标签：linq-to-sql, join, count, group-by

我需要帮助将此查询转换为 linq to sql：

```
select
    rd.RouteDispatchID,
    r.RouteNumber,
    s.ShortDescription Status,
    rd.DispatchDate,
    rd.CreationDate CreatedDate,
    e.FirstName,
    e.LastName,
    count(md.MachineDispatchID) NumMachines
from
dbo.RouteDispatch rd
    inner join dbo.Route r on rd.RouteID = r.RouteID
    inner join dbo.Reference s on rd.StatusCodeReferenceID = s.ReferenceID
    inner join dbo.Employee e on rd.CreatedByEmployeeID = e.EmployeeID
    left join dbo.MachineDispatch md on rd.RouteDispatchID = md.RouteDispatchID and md.IsSelected = 1 
```

这是我到目前为止所拥有的，但我无法弄清楚如何让 group by/count 起作用，我的 Linqer 工具也不能......

```
var query = from rd in db.RouteDispatches
                join r in db.Routes on rd.RouteID equals r.RouteID
                join s in db.References on new { StatusCodeReferenceID = rd.StatusCodeReferenceID } equals new { StatusCodeReferenceID = s.ReferenceID }
                join e in db.Employees on new { CreatedByEmployeeID = rd.CreatedByEmployeeID } equals new { CreatedByEmployeeID = e.EmployeeID }
                join md in db.MachineDispatches
                      on new { RouteDispatchID = rd.RouteDispatchID, IsSelected = true }
                  equals new { RouteDispatchID = md.RouteDispatchID, IsSelected = md.IsSelected.Value } into md_join
                from md in md_join.DefaultIfEmpty()
                select new RouteView {
                  RouteDispatchID = rd.RouteDispatchID,
                  RouteNumber = r.RouteNumber,
                  Status = s.ShortDescription,
                  DispatchDate = rd.DispatchDate.Value,
                  CreatedDate = rd.CreationDate.Value,
                  FirstName = e.FirstName,
                  LastName= e.LastName,
                  NumMachines = 0//.Count()
                }; 
```

感谢谁能弄清楚这一点，我仍然是 linq to sql 的新手，所以每天都会提出 2-3 个新问题！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T22:21:54.160

搞定了...

```
var query = from rd in db.RouteDispatches
                        join r in db.Routes on rd.RouteID equals r.RouteID
                        join s in db.References on new { StatusCodeReferenceID = rd.StatusCodeReferenceID } equals new { StatusCodeReferenceID = s.ReferenceID }
                        join e in db.Employees on new { CreatedByEmployeeID = rd.CreatedByEmployeeID } equals new { CreatedByEmployeeID = e.EmployeeID }
                        join md in db.MachineDispatches
                              on new { RouteDispatchID = rd.RouteDispatchID, IsSelected = true }
                          equals new { RouteDispatchID = md.RouteDispatchID, IsSelected = md.IsSelected.Value } into md_join
                        from md in md_join.DefaultIfEmpty()
                        group new { rd, r, s, e, md } by new
                        {
                            rd.RouteDispatchID,
                            r.RouteNumber,
                            s.ShortDescription,
                            rd.DispatchDate,
                            rd.CreationDate,
                            e.FirstName,
                            e.LastName
                        } into g
                        select new RouteView
                        {
                            RouteDispatchID = (System.Int32)g.Key.RouteDispatchID,
                            RouteNumber = g.Key.RouteNumber,
                            Status = g.Key.ShortDescription,
                            DispatchDate = (System.DateTime)g.Key.DispatchDate,
                            CreatedDate = (System.DateTime)g.Key.CreationDate,
                            FirstName = g.Key.FirstName,
                            LastName = g.Key.LastName,
                            NumMachines = g.Count(),
                            TotalRecordCount = 0
                        }; 
```

# ruby-on-rails - 如何将 Rake 任务作为 Windows“计划任务”运行？

> ID：1020344
> 
> 赞同：4
> 
> 时间：2009-06-19T22:38:45.980
> 
> 标签：ruby-on-rails, windows, ruby

我有一个 rake 任务，我需要在 Windows XP 机器上作为日常工作运行。我发现了 Windows“计划任务”控制面板。我试图弄清楚如何让它运行我的 Rake 任务。

其中两个字段是“运行”（带有浏览按钮）和“开始”。我试图进入`rake mycategory:mytask`“运行”，并且包含 Rake 任务的 Rails 项目目录进入“开始”。结果是一条消息说任务“无法开始”。

如何设置 Windows“计划任务”来运行 Rake 任务？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T22:42:39.857

如果您可以构建一个可以正确执行它的批处理文件，我会这样做，然后您可以指示批处理文件与任务一起运行。

像这样的东西应该工作：

```
:: Run task every hour
@call rake stats RAILS_ENV="production" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T23:30:13.177

此外，除了上面的（正确的）批处理文件建议，AFAIK，您可能需要在设置了非空密码的帐户上运行任务。调度程序的属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-16T00:16:43.947

只需为感兴趣的人添加一个更新/充实的答案......

创建一个名为`rake.bat`- 确保使用 ANSI 编码（Windows 记事本的默认设置）保存的文件。你可以把这个文件保存在任何地方，但我把它放在`C:\ror\rake.bat`

**rake.bat**

```
@call bundle exec rake %* 
```

现在，当您创建计划任务时，您可以将其设置为运行 .bat 文件，并且参数只是 .bat 之后的内容`rake`。将其设置为在您选择的目录中运行。无论用户是否登录都运行，但不要以最高权限运行。为了清楚起见，下面的屏幕截图；我的 rake 任务是命名空间`manager`的，任务本身是`sync`：

![编辑动作对话框](../Images/2b2f7b450231be537092c3cab6da7d1a.png)

![编辑任务对话框](../Images/9520e445d70c136a3db8887da8ed37f6.png)

# oracle - Oracle：从记录数据类型中选择

> ID：1020348
> 
> 赞同：4
> 
> 时间：2009-06-19T22:40:56.927
> 
> 标签：oracle

我有一个返回记录数据类型的函数（2 个字段：ID 和名称）。如何从 select 语句中获取数据？

具体来说，我正在尝试使用 OracleCommand 对象尝试将对象放入我的 C# 代码中。我最初尝试...

```
CALL FUNCTION_NAME() INTO :loRetVal 
```

...但无论我使用什么类型，我都会收到数据类型错误。我也试过...

```
SELECT * FROM FUNCTION_NAME() 
```

... 和 ...

```
SELECT * FROM TABLE ( FUNCTION_NAME() ) 
```

……无济于事。我想我正在寻找...

```
SELECT * FROM RECORD ( FUNCTION_NAME() ) 
```

......当然，不存在。

我能想出的唯一解决方案是将此函数调用包装在另一个函数调用中，其中外部函数返回包含此唯一记录的记录表。但是，这似乎很麻烦，我正在寻找一种更简单的方法。任何帮助，将不胜感激。

编辑：对不起，我也试过了`SELECT FUNCTION_NAME() FROM DUAL`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-20T08:42:48.717

记录数据类型是 PL/SQL 数据类型。SQL 对此一无所知。这可能就是您收到错误的原因。看这个例子：

```
SQL> create package mypkg
  2  as
  3    type myrec is record
  4    ( id int
  5    , name varchar2(10)
  6    );
  7    function f return myrec;
  8  end mypkg;
  9  /

Package created.

SQL> create package body mypkg
  2  as
  3    function f return myrec
  4    is
  5      r myrec;
  6    begin
  7      r.id := 1;
  8      r.name := 'test';
  9      return r;
 10    end f;
 11  end mypkg;
 12  /

Package body created.

SQL> desc mypkg
FUNCTION F RETURNS RECORD
   ID                           NUMBER(38)              OUT
   NAME                         VARCHAR2(10)            OUT

SQL> select mypkg.f from dual
  2  /
select mypkg.f from dual
       *
ERROR at line 1:
ORA-00902: invalid datatype 
```

我指的是 SQL 中的错误。您可以从 PL/SQL 调用它：

```
SQL> declare
  2    r mypkg.myrec;
  3  begin
  4    r := mypkg.f;
  5    dbms_output.put_line(r.id);
  6    dbms_output.put_line(r.name);
  7  end;
  8  /
1
test

PL/SQL procedure successfully completed. 
```

如果要在 SQL 中使用该函数，则可以创建 SQL 对象类型。请注意，直接从 C# 调用您的函数看起来比坚持使用 SQL 来执行此操作更可取。但只是为了记录：

```
SQL> drop package mypkg
  2  /

Package dropped.

SQL> create type myobj is object
  2  ( id int
  3  , name varchar2(10)
  4  );
  5  /

Type created.

SQL> create package mypkg
  2  as
  3    function f return myobj;
  4  end mypkg;
  5  /

Package created.

SQL> create package body mypkg
  2  as
  3    function f return myobj
  4    is
  5    begin
  6      return myobj(1,'test');
  7    end f;
  8  end mypkg;
  9  /

Package body created.

SQL> select mypkg.f from dual
  2  /

F(ID, NAME)
--------------------------------------------------------------
MYOBJ(1, 'test')

1 row selected. 
```

问候，罗布。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-30T00:56:51.800

你能

```
CREATE TYPE <object name> AS TABLE OF <record type> 
```

并直接在 SQL 语句中使用它？我问是因为我有一个无法编辑的存储过程。存储过程有一个输出变量，它是我必须在 SQL 语句中引用的记录类型。我已经创建了一个函数来调用 proc，但是如果我不必将记录转换为类型对象，那就太好了。

我以后会这样称呼它：

```
SELECT *
FROM TABLE( CAST( <function name>() as <object name>)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T04:51:56.757

我认为这就是您要寻找的；在 select 语句中获取值：

```
select result.id as id, result.name
  from ( select function() as result from dual); 
```

因为您的函数返回的记录不是本机类型，所以您不能使用标准方法。如果您想将实际记录作为对象获取到 C# 中，那么您必须阅读 ODP .net 文档中的用户定义类型。

您还可以将该函数包装在另一个函数中，该函数返回一个引用游标，并以更标准的方式在 C# 中使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-12T18:58:02.817

我认为您正在寻找流水线功能：

```
CREATE TABLE test_table(tt_id INTEGER,tt_text VARCHAR2(40));

CREATE PACKAGE test_pkg IS
    TYPE tp_rec IS RECORD(tt_id INTEGER,tt_text VARCHAR2(40));
    TYPE tp_recs IS TABLE OF tp_rec;

    FUNCTION test_func RETURN tp_recs PIPELINED;
    FUNCTION test_func1 RETURN tp_recs PIPELINED;
    FUNCTION test_func2(ivar INTEGER) RETURN tp_recs PIPELINED;
END;
/

CREATE OR REPLACE PACKAGE BODY test_pkg IS
    FUNCTION test_func RETURN tp_recs PIPELINED
    AS
       currec tp_rec;
    BEGIN
       currec.tt_id := 1;
       currec.tt_text := 'test1';
       PIPE ROW(currec);
    END;

    FUNCTION test_func1 RETURN tp_recs PIPELINED
    AS
       currec tp_rec;
       CURSOR t_cursor IS
           SELECT * FROM test_table;
    BEGIN
        OPEN t_cursor;
        LOOP
            FETCH t_cursor INTO currec;
            EXIT WHEN t_cursor%NOTFOUND;
            PIPE ROW(currec);
        END LOOP;
        CLOSE t_cursor;
    END;

    FUNCTION test_func2(ivar INTEGER) RETURN tp_recs PIPELINED
    AS
       currec tp_rec;
    BEGIN
       SELECT * INTO currec FROM test_table WHERE tt_id = ivar;
       PIPE ROW(currec);
    END;

END;
/

BEGIN
    INSERT INTO test_table VALUES(1,'test1');
    INSERT INTO test_table VALUES(2,'test2');
    INSERT INTO test_table VALUES(3,'test3');
    COMMIT;
END;
/

SELECT * FROM TABLE(test_pkg.test_func());
SELECT * FROM TABLE(test_pkg.test_func1());
SELECT * FROM TABLE(test_pkg.test_func2(2)); 
```

上面的代码已经过测试，应该会给你一个好的开始。只需在 Oracle 中查找 PIPELINED 关键字以获取更多信息（假设您正在使用 Oracle ...）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-20T15:19:46.277

我对 Rob van Wijk 的评论的格式很糟糕。继续他的想法。

```
-- create a collection type 
CREATE TYPE myobj_tab AS TABLE OF myobj; 

-- have the function return a collection type 
CREATE OR REPLACE function f return myobj_tab 
IS 
    objtab myobj_tab; 
BEGIN 
    objtab := myobj_tab(myobj(1,'test')); 
    return objtab; 
end f; 

-- CAST it as a table and straight up select from it. 
SELECT id, name FROM TABLE(CAST(f() AS myobj_tab)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-20T04:01:27.870

为什么你需要使用 SQL？您也许可以只使用 System.Data.CommandType.StoredProcedure 来调用该函数。

[从-c调用-an-oracle-function-from-c#](http://www.velocityreviews.com/forums/t385408-anyone-know-how-to-call-an-oracle-function-from-c.html)

[使用 C# 调用包中的 Oracle 函数](http://www.guru.net.vn/PermaLink,guid,1cfcd9d6-3837-493d-87bb-a28be66ce3a5.aspx)

# linq-to-sql - Linq to Sql：我这样做对吗？

> ID：1020352
> 
> 赞同：2
> 
> 时间：2009-06-19T22:42:32.167
> 
> 标签：linq-to-sql

我正在开发一个数据库访问层项目，并决定为此使用 Linq to SQL。我想做的一件事是提供一个 API，它可以将 Linq 表达式作为参数来检索数据。例如，我现在编写了这个 API，如下所示：

```
 public Result GetResults(System.Linq.Expressions.Expression<Func<Result, bool>> predicate)
    {
        Result result = db.Results.SingleOrDefault(predicate);
        return result;
    } 
```

然后，您可以使用此 API 在数据库中查询满足特定条件的 Result 行，例如：

```
Result result = Provider.GetResults(r => r.ID == 11); 
```

这很好用。我能够根据我的条件得到我想要的一行。

下一步是采取这一措施，以便能够从数据库中取回多个对象。

我让它工作的方式是这样的：

```
public List<Result> GetResults(System.Linq.Expressions.Expression<Func<Result, bool>> predicate)
    {
        List<Result> results = db.Results.Select(r => r).Where(r => r.ID == 11).ToList<Result>();
        return results;
    } 
```

如您所见，我使用 r => r 调用 Select，这将返回所有内容，然后我使用 Where 过滤到我需要的内容。

它有效......但有些事情告诉我，我这样做真的很难看。我可能是错的，但这不是将所有东西都从结果表中拉出来然后过滤掉吗？还是将在数据库级别进行过滤的正确 SQL 语句放在一起？

无论如何......我非常感谢一些关于如何完成这项任务的指导。如何编写一个将 Linq 表达式作为参数并根据该表达式从数据库中返回一组对象的 API。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T22:48:51.560

`Select(r=>r)`什么都不做（除了从 to 改变-`Table<T>`但`IQueryable<T>`没什么*用处*）。我假设你打算传递`predicate`给`Where`?

实际上，这**并没有**将所有内容都提取出来并对其进行过滤——`WHERE`生成了适当的 (TSQL) 子句。这是可能的，因为“延迟执行”和“可组合性”——意思是：在你开始迭代数据（在 中）之前它实际上不会执行任何东西`ToList()`——直到那时你只是在塑造查询。

您可以通过执行以下操作来看到这一点：

```
db.Log = Console.Out; 
```

并查看 TSQL。或者运行 TSQL 跟踪。为了使它更漂亮，将其简化为：

```
return db.Results.Where(predicate).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T23:01:15.623

我知道你说你想传递一个谓词并返回一个 List 但你是否考虑过返回一个 IQueryable

然后你可以打电话：

```
 GetResults().Where(r => r.SomeProperty == "SomeValue")
     .OrderBy(r => r.SomeOtherProperty)
     .Skip(10) 
     .Take(10); //etc. 
```

使用您当前的 API 设计，您将返回所有记录，然后必须获得 10 条记录，而上述仅返回您需要的 10 条记录......

只是一些想法...

# java - 将当前的 git commit id 注入 Java webapp

> ID：1020354
> 
> 赞同：19
> 
> 时间：2009-06-19T22:42:58.390
> 
> 标签：java, git, ant

我们有一个 git 存储库，其中包含一些相关 Java WAR 和 JAR 的源代码。如果 Java 代码能够以某种方式实现就好了：

```
System.err.println("I was built from git commit " + commitID); 
```

（很明显，真正的代码可能会将其放入 HTTP 标头中，在启动时记录它，或者其他什么，这现在并不重要）

我们正在使用 Ant 构建（至少对于生产构建，似乎一些程序员从 Eclipse 内部进行测试，而我对此知之甚少）二进制文件。

有没有一种规范的方法可以在构建时将当前 git checkout 的提交 ID 获取到我们的 Java 中？如果没有，使用 Ant 构建的人能否建议他们如何做，我们将看看是否出现了规范的解决方案？我确信我可以完全用整块布料自己发明一些东西，但这似乎是一个可重复使用的积木，所以我宁愿不这样做。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-20T17:52:38.107

您可以获得最后一次提交的 SHA

```
git rev-parse HEAD 
```

但通常使用起来更有用

```
git describe 
```

这会给你一些看起来像这样的东西：

```
v0.7.0-185-g83e38c7 
```

如果您有标签，这将有效 - 它会告诉您当前签出的最后一个有效标签中有多少次提交加上该提交的部分 SHA，因此您可以使用它来作为以后签出的基础。在大多数情况下，您可以像使用 SHA 一样使用此标识符，但它更易于人类阅读。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-19T22:57:56.393

我不知道 git 是否有任何 Ant 任务（我用谷歌搜索了一下没有成功），无论如何 Ant 可以使用 Piotr 的选项 ( `git rev-parse HEAD`) 更新属性文件，然后在运行时使用该属性来获取修订号。这比让 Ant 生成 .java 文件更简洁和*IDE 友好。*

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-06-19T18:23:39.957

如果它对其他人有帮助。我知道你的是 ANT

对于**MAVEN**构建，您可以在**pom.xml**文件中使用***git-commit-id-plugin***

 **```
 <plugin>
        <groupId>pl.project13.maven</groupId>
        <artifactId>git-commit-id-plugin</artifactId>
        <version>2.2.0</version>
        <executions>
            <execution>
                <goals>
                    <goal>revision</goal>
                </goals>
            </execution>
        </executions>
        <configuration>
            <dotGitDirectory>${project.basedir}/.git</dotGitDirectory>
            <generateGitPropertiesFile>true</generateGitPropertiesFile>
            <generateGitPropertiesFilename>${project.build.outputDirectory}/git.properties</generateGitPropertiesFilename>
        </configuration>
    </plugin> 
```

请通过：
1\. [http://www.baeldung.com/spring-git-information](http://www.baeldung.com/spring-git-information) &
2\. [https://github.com/ktoso/maven-git-commit-id-plugin](https://github.com/ktoso/maven-git-commit-id-plugin)了解更多信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-03-15T20:21:42.943

我编写了一个 Ant 任务来使用 JGit API（没有 git 命令行应用程序）获取内部版本号，请参阅[jgit-buildnumber-ant-task](https://github.com/alx3apps/jgit-buildnumber)。然后，您可以将此内部版本号存储在 MANIFEST.MF 文件中，并在运行时从类路径中获取它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T22:52:35.593

`git rev-parse HEAD`将打印您可能想要的内容（例如`HEAD`提交的 id）。您可以让 ant 生成一个简单的 Java 类，并将这个 id 作为静态常量。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-19T23:29:06.470

首先，您可以使用带有关键字的`ident` [gitattribute](http://git-scm.com/docs/gitattributes)`$Id$`（尽管它可能不是您想要的；它是文件内容的哈希，与当前项目版本无关）。

其次，您可以按照 Linux 内核和 Git 本身的方式进行操作：在 Makefile 中（在您的情况下：在 Ant 文件中）有替换某些占位符的规则，通常是 '@@VERSION@@'（但在 Perl 的情况下是 '++VERSION++') 由 GIT-VERSION-GEN 的结果，而[GIT-VERSION-GEN](http://git.kernel.org/?p=git/git.git;a=blob;f=GIT-VERSION-GEN;hb=master)又使用**“ [git describe](http://www.kernel.org/pub/software/scm/git/docs/git-describe.html) ”**。但要使它有用，您必须标记您的版本（使用带注释/签名的标签）。**

# java - Java Swing JTree 扩展

> ID：1020357
> 
> 赞同：1
> 
> 时间：2009-06-19T22:44:17.357
> 
> 标签：java, swing

此方法按预期工作 - 它创建一个带有根节点和两个子*容器*节点（每个都有各自的叶节点）的 JTree：

```
private JComponent createSideBar()
{
    final DefaultMutableTreeNode top = new DefaultMutableTreeNode("Projects");
    final JTree tree = new JTree(top);

    DefaultMutableTreeNode project = new DefaultMutableTreeNode("project 1");
    DefaultMutableTreeNode version = new DefaultMutableTreeNode("version 1");
    project.add(version);
    top.add(project);
    TreePath treePath = new TreePath(project.getPath());
    // tree.expandPath(treePath);

    project = new DefaultMutableTreeNode("project 2");
    version = new DefaultMutableTreeNode("version 2");
    project.add(version);
    top.add(project);

    return tree;
} 
```

在这种情况下，树开始关闭。我希望应用程序从完全展开的所有节点开始，所以我首先添加以下内容：

```
 tree.expandPath(treePath); 
```

但是当我从上面的代码中取消注释时，第二组子节点不显示，即：项目 2 和版本 2 不显示。事实上，所有随后添加的节点都不会出现。

对于它的价值，我使用的是 JDK 1.5。从文档中，我似乎看不到任何限制或为什么这种方法会产生如此不良的影响......我将尝试查看源代码，但希望有人可能对这是什么以及为什么会有所了解是预期的行为。我想知道每个后续节点“添加”是否以某种方式被禁止 - 但我无法想象大多数运行时用例都适用。

谢谢，

——路德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-20T00:02:36.497

不幸的是，Swing 通常是“有帮助的”。在这种情况下，它会根据提供的数据为您创建一个模型，这与`JList`如果您提供一个`Vector`.

`JTree`和共犯（主要是 Pluggable Look & Feel）将向模型添加侦听器以随时了解更新。如果您只是更改（隐式）模型背后的数据，那么除了偶然之外，什么都不会更新。

所以，你应该做的是明确地创建一个模型。当模型数据发生变化（当然总是在 EDT 上）时，会触发相关事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T23:00:01.303

如果将节点添加到已经展开的节点，则需要[重新加载模型](http://java.sun.com/javase/6/docs/api/javax/swing/tree/DefaultTreeModel.html#reload())。

```
((DefaultTreeModel)tree.getModel()).reload(); 
```

或者

```
((DefaultTreeModel)tree.getModel()).reload(top); 
```

如果您只想重新加载大树的一小部分，则[第二个版本更有用。](http://java.sun.com/javase/6/docs/api/javax/swing/tree/DefaultTreeModel.html#reload(javax.swing.tree.TreeNode))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T00:26:04.063

啊……模特。

您的答案在[此处](http://java.dzone.com/news/secret-life-defaulttreemodel)和[此处](http://www.coderanch.com/t/341673/Swing-AWT-SWT-JFace/java/JTree-expand-node-highlight)进行了详细说明....甚至[在这里](http://java.sun.com/products/jfc/tsc/articles/jtree/)。

我最终做了类似的事情：

```
DefaultTreeModel model = (DefaultTreeModel) tree.getModel();
model.insertNodeInto(newNode, parent, index); 
```

这使模型直接得到通知。就我而言，这可以很好地扩展。

现在，如何将其中之一标记为答案！？！

# javascript - 如何隐藏或加密 JavaScript 代码？

> ID：1020368
> 
> 赞同：59
> 
> 时间：2009-06-19T22:50:25.877
> 
> 标签：javascript, encryption, obfuscation

有什么方法可以隐藏或加密 JavaScript 代码以防止人们查看、复制和/或修改专有程序？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-06-19T22:52:57.823

你可以混淆它，但没有办法完全保护它。

混淆器示例： [https ://obfuscator.io](https://obfuscator.io)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-19T22:53:57.773

不，这是不可能的。如果它在客户端浏览器上运行，则必须由客户端浏览器下载。使用 Fiddler 检查 HTTP 会话并获取任何下载的 js 文件非常简单。

您可以使用一些技巧。最明显的方法之一是使用 javascript 混淆器。

话又说回来，混淆只能防止随意窥探，并不能防止人们提起和使用您的代码。

您可以尝试以 Flash 电影的形式编译的动作脚本。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-03T22:33:47.883

虽然每个人都普遍认为 Javascript 加密是一个[坏主意](http://www.matasano.com/articles/javascript-cryptography/)，但在一些小用例中，减缓攻击总比没有好。您可以从[YUI Compressor](http://refresh-sf.com/yui/)（如 @Ben Alpert 所说）开始，或者 JSMin、Uglify 或更多。

但是，我想要真正“隐藏内容”的主要情况是发布电子邮件地址时。请注意，当您单击“检查元素”时，Chrome 会出现问题。它将显示您的原始代码：每次。这就是为什么混淆通常被认为是一种更好的方法。

在这方面，我采取了两管齐下的攻击，纯粹是为了减缓垃圾邮件机器人的速度。我混淆/缩小 js，然后通过编码器再次运行它（同样，这第二步在 chrome 中完全没有意义）。

虽然不完全是纯 Javascript 编码器，但我发现的最好的 html 编码器是[http://hivelogic.com/enkoder/](http://hivelogic.com/enkoder/)。它会变成这样：

```
<script type="text/javascript">
//<![CDATA[
<!--
var c=function(e) { var m="mail" + "to:webmaster";var a="somedomain"; e.href = m+"@"+a+".com";  
};
//-->
//]]>
</script>
<a href="#" onclick="return c(this);"><img src="images/email.png" /></a> 
```

进入这个：

```
<script type="text/javascript">
//<![CDATA[
<!--
var x="function f(x){var i,o=\"\",ol=x.length,l=ol;while(x.charCodeAt(l/13)!" +
"=50){try{x+=x;l+=l;}catch(e){}}for(i=l-1;i>=0;i--){o+=x.charAt(i);}return o" +
".substr(0,ol);}f(\")87,\\\"meozp?410\\\\=220\\\\s-dvwggd130\\\\#-2o,V_PY420" +
"\\\\I\\\\\\\\_V[\\\\\\\\620\\\\o710\\\\RB\\\\\\\\610\\\\JAB620\\\\720\\\\n\\"+
"\\{530\\\\410\\\\WJJU010\\\\|>snnn|j5J(771\\\\p{}saa-.W)+T:``vk\\\"\\\\`<02" +
"0\\\\!610\\\\'Dr\\\\010\\\\630\\\\400\\\\620\\\\700\\\\\\\\\\\\N730\\\\,530" +
"\\\\2S16EF600\\\\;420\\\\9ZNONO1200\\\\/000\\\\`'7400\\\\%n\\\\!010\\\\hpr\\"+
"\\= -cn720\\\\a(ce230\\\\500\\\\f730\\\\i,`200\\\\630\\\\[YIR720\\\\]720\\\\"+
"r\\\\720\\\\h][P]@JHADY310\\\\t230\\\\G500\\\\VBT230\\\\200\\\\Clxhh{tzra/{" +
"g0M0$./Pgche%Z8i#p`v^600\\\\\\\\\\\\R730\\\\Q620\\\\030\\\\730\\\\100\\\\72" +
"0\\\\530\\\\700\\\\720\\\\M410\\\\N730\\\\r\\\\530\\\\400\\\\4420\\\\8OM771" +
"\\\\`4400\\\\$010\\\\t\\\\120\\\\230\\\\r\\\\610\\\\310\\\\530\\\\e~o120\\\\"+
"RfJjn\\\\020\\\\lZ\\\\\\\\CZEWCV771\\\\v5lnqf2R1ox771\\\\p\\\"\\\\tr\\\\220" +
"\\\\310\\\\420\\\\600\\\\OSG300\\\\700\\\\410\\\\320\\\\410\\\\120\\\\620\\" +
"\\q)5<: 0>+\\\"(f};o nruter};))++y(^)i(tAedoCrahc.x(edoCrahCmorf.gnirtS=+o;" +
"721=%y;++y)87<i(fi{)++i;l<i;0=i(rof;htgnel.x=l,\\\"\\\"=o,i rav{)y,x(f noit" +
"cnuf\")"                                                                     ;
while(x=eval(x));
//-->
//]]>
</script> 
```

也许这足以减慢一些垃圾邮件机器人的速度。我还没有收到任何垃圾邮件（！还）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-19T22:54:08.070

[YUI Compressor](http://www.julienlecomte.net/yuicompressor/)是最好的压缩器之一（不是专门的混淆器）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-19T23:29:20.433

JavaScript 是一种脚本语言，因此在 JavaScript 运行时解释和执行它之前一直保持人类可读的形式。

至少对技术水平较低的人来说，部分隐藏它的唯一方法是混淆。

混淆使人类更难阅读，但对于精通技术的人来说并非不可能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-19T23:34:09.643

如果您有任何特别想要隐藏的内容（例如专有算法），请将其放在服务器上，或者将其放在 Flash 电影中并使用 JavaScript 调用它。编写 ActionScript 与编写 JavaScript 非常相似，您可以在 JavaScript 和 ActionScript 之间进行通信。你可以用 Silverlight 做同样的事情，但是 Silverlight 没有 Flash 的穿透力。

但是，请记住，任何手机都可以运行您的 JavaScript，但不能运行 Silverlight 或 Flash，因此如果您使用 Flash 或 Silverlight，您将削弱您的移动用户。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-19T22:57:29.110

保护您的代码的唯一安全方法是不泄露它。通过客户端部署，无法避免客户端访问代码。

所以简短的回答是：你做不到

更长的答案是考虑闪光灯或 Silverlight。虽然我相信 Silverlight 会很乐意在客户端运行反射器时泄露它的秘密。

我不确定 Flash 平台是否存在类似的东西。

# silverlight - 将具有内置 ASMX WebService 的 Silverlight 应用程序部署到 IIS

> ID：1020370
> 
> 赞同：0
> 
> 时间：2009-06-19T22:51:36.297
> 
> 标签：silverlight, web-services, iis, deployment

我有一个 Silverlight 应用程序，它使用内置的 .ASMX WebService 来访问 SQL 数据库并运行一些查询。一切都在我的开发机器上顺利运行。

我正在尝试将应用程序部署到 IIS 6，但遇到了一些问题。

Silverlight 应用程序本身似乎运行良好，但 Web 服务却没有。一旦页面加载（当页面加载时，我正在调用一些 Async WebService 方法），我就会收到一个未处理的异常错误，显示 [Async_ExceptionOcurred]。

我认为这是 Web 服务的问题，但我不知道问题是什么。我尝试将 WebService 命名空间设置为我的 URL，但这不起作用。我尝试在我的 Web Config 中弄乱 SQL 连接字符串，但这也没有任何影响。

需要注意的一点是，我的 IIS 虚拟目录仅包含我的 SilverlightApp.Web 文件夹。我知道作为应用程序一部分的另一个文件夹包含 WebService 的 .ClientSettings 文件，但我认为这是嵌入到 .xap 中的。

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T00:39:42.630

最有可能发生的事情：客户端上的 Web 服务代理正在使用它所针对的 Web 服务的地址：（“ [http://localhost](http://localhost) ...”）。要做的事情：

*   使用[提琴手](http://www.fiddler2.com/fiddler2/)确认这是问题所在。它将向您显示代理正在调用的位置。
*   使用 Web 服务的重载构造函数并指定 URI。考虑使用 id/defing 进行调试/发布。这将覆盖 client.config 中的设置。
*   在客户端配置中为发布版本创建另一个端点（[此处为 Shawn 的文章](http://wildermuth.com/2008/11/08/Controlling_Service_References_in_Silverlight_2)）并选择一个或另一个（再次使用 if/defs）。

还有其他选项（查看 URI 并建立服务地址）......但这是一般的想法。

hth，埃里克

# tsql - 执行 TSQL 插入语句时遇到错误

> ID：1020382
> 
> 赞同：4
> 
> 时间：2009-06-19T22:54:38.473
> 
> 标签：tsql

我们的一位用户在开发服务器中做了一个插入语句。插入工作正常。但是，当在生产服务器中执行相同的插入语句时，他遇到了以下错误：

> 错误：.Net SqlClient 数据提供程序错误消息：将 char 数据类型转换为 datetime 数据类型导致 datetime 值超出范围。该语句已终止。

插入语句如下：

```
Insert into tbl_SeatWave_customers (Title
                                   ,FirstName
                                   ,Lastname
                                   ,EmailAddress
                                   ,HomeTelephone
                                   ,Address1
                                   ,Address2
                                   ,Address3
                                   ,Town
                                   ,County
                                   ,Postcode
                                   ,BuyerOrSeller
                                   ,OrderID
                                   ,ListingID
                                   ,BestCallDateTimeFrom
                                   ,bestcalldatetimeto
                                   ,FAQAsked
                                   ,Comments
                                   ,CallOutcome
                                   ,Spare1
                                   ,Spare2
                                   ) 
Values('Mr'
      ,'Darren'
      ,'Piper'
      ,'bazzt27@hotmail.com'
      ,'07825758328'
      ,'7 RUSSELL ROAD'
      ,''
      ,''
      ,''
      ,'CLWYD'
      ,'LL18 3BS'
      ,'Other'
      ,''
      ,'19/06/2009'
      ,'12:00'
      ,''
      ,'Callers tickets have not yet arrived.'
      ,'Resolved'
      ,'Yes'
      ,''
      ) 
```

表 tbl_SeatWave_customers 具有以下结构：

```
COLUMN_NAME           DATA_TYPE COLUMN_DEFAULT
NUID                  bigint    NULL
CallDateTime          datetime  (getdate())
Title                 nvarchar  NULL
FirstName             nvarchar  NULL
LastName              nvarchar  NULL
EmailAddress          nvarchar  NULL
HomeTelephone         nvarchar  NULL
MobileTelephone       nvarchar  NULL
WorkTelephone         nvarchar  NULL
Address1              nvarchar  NULL
Address2              nvarchar  NULL
Address3              nvarchar  NULL
Address4              nvarchar  NULL
Town                  nvarchar  NULL
County                nvarchar  NULL
Postcode              nvarchar  NULL
BuyerOrSeller         nvarchar  NULL
OrderID               nvarchar  NULL
ListingID             nvarchar  NULL
BestCallDateTimeFrom  datetime  NULL
BestCallDateTimeTo    datetime  NULL
FAQAsked              nvarchar  NULL
Comments              nvarchar  NULL
Spare1                nvarchar  NULL
Spare2                nvarchar  NULL
Spare3                nvarchar  NULL
Spare4                nvarchar  NULL
Spare5                nvarchar  NULL
CallOutcome           nvarchar  NULL 
```

我的问题是这个错误的原因是什么，解决它的解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T22:58:51.837

我的猜测可能是国际化（`19/06/2009`与来自客户端机器和/或配置不同的服务器的对比 - 提示，一个相当常见的布局将是“2009/06/19”），或者只是您可能错误地使用了`06/19/2009`日期`2009 06 19`，现在已经过了 12 日 - 即之前它认为是 10 月 6 日、11 月 6 日、12 月 6 日，*繁荣*。

当然，如果你使用参数（而不是字符串）你就不会有这个问题。小数点同上 -`123,456`与 123456 相同吗？还是123半？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T22:59:22.333

问题在于“19/06/2009” `which is specified in`DD/MM/YYYY `but your SQL Server instance expects it as`MM/DD/YYYY`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T23:03:24.870

DateFormats mm/dd/yyyy 与 dd/mm/yyyy 取决于用于连接到服务器的登录名的语言设置。阅读此处了解更多信息：

[为 SQL Server 设置标准日期格式](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/setting-a-standard-dateformat-for-sql-se)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T23:17:39.007

您的日期文字 '19/06/2009' 可能被解释为样式 101,US,mm/dd/yyyy 或样式 103,British/French,dd/mm/yyyy。19 不是有效的“数字月份”，所以我的猜测是您的开发服务器设置为英国/法语（19/06/2009 => 周五，2009 年 6 月 19 日），您的生产服务器设置为我们的样式/格式（19/06 /2009 => 错误）。

[http://msdn.microsoft.com/en-us/library/ms180878.aspx#UsingDateandTimeFormats](http://msdn.microsoft.com/en-us/library/ms180878.aspx#UsingDateandTimeFormats)说：

> 字符串文字格式会影响应用程序中数据向用户的呈现，但不会影响 SQL Server 中的基础整数存储格式。但是，SQL Server 可能会将字符串文字格式的日期值解释为不同的日期，由应用程序或用户输入用于存储或日期函数。*解释取决于字符串文字格式、数据类型* **和运行时 SET DATEFORMAT、SET LANGUAGE 和默认语言选项设置**的组合。

和

> 我们建议您使用不依赖于 DATEFORMAT 并且是多语言的日期时间格式。ISO 8601 格式“1998-02-23T14:23:05”和“1998-02-23T14:23:05-08:00”是唯一的国际标准格式。它们不依赖于 DATEFORMAT 或默认登录语言，并且是多语言的。

# php - 如何在一台 Apache 服务器上同时运行 Django 和 PHP？

> ID：1020390
> 
> 赞同：26
> 
> 时间：2009-06-19T22:56:29.360
> 
> 标签：php, django, apache-config

我目前可以在我的 Apache 服务器上通过 mod_wsgi 或 PHP 运行 Django。

我的 Django 项目在：[http://localhost](http://localhost)运行，源代码在 C:/django_proj

我的 PHP 项目在：[http://php.localhost](http://php.localhost)运行，源代码在 C:/web

如果我同时打开， php.localhost 和 localhost 会转到 Django 项目。我已经通过 Apache 虚拟主机设置了它们。

以下是 httpd.conf 中的一些相关行：

```
DocumentRoot "C:/web"

<Directory />
    Options FollowSymLinks
    AllowOverride None
    Order deny,allow
    Deny from all
</Directory>

<Directory "C:/web">
    Options Indexes FollowSymLinks
    AllowOverride None
    Order allow,deny
    Allow from all
</Directory>

<Directory "C:/django_proj">
    Order allow,deny
    Allow from all
</Directory>

Include "C:/django_proj/apache/apache_django_wsgi.conf" 
```

中的相关行`apache_django_wsgi.conf`是：

```
WSGIScriptAlias / "C:/django_proj/apache/proj.wsgi"
<Directory "C:/django_proj/apache">
    Order allow,deny
    Allow from all
</Directory> 
```

在 httpd-vhosts.conf 中：

```
<Directory C:/web>
    Order Deny,Allow
    Allow from all
</Directory>

<Directory C:/django_proj>
    Order Deny,Allow
    Allow from all
</Directory>

<VirtualHost *:80>
    DocumentRoot "C:/django_proj"
    ServerName localhost
</VirtualHost>

<VirtualHost *:80>
    DocumentRoot "C:/web"
    ServerName php.localhost
</VirtualHost> 
```

我的 PHP 项目当前无法访问。有人知道我缺少什么吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-20T01:12:47.697

我用一个 Apache 运行了几十个 mod_wsgi/Django 站点、PHP 站点和一个 Rails 站点。

它主要是使用虚拟主机完成的，但我有一些在同一个域上运行。

您只需将您的放在`WSGIScriptAlias /...`任何其他位置/别名指令之后。

例如，我想在与 Django 站点相同的域上运行 phpMyAdmin。配置看起来像这样：

```
Alias /phpmyadmin /full/path/to/phpmyadmin/
<Directory /full/path/to/phpmyadmin>
   Options -Indexes
   ...etc...
</Directory>

WSGIScriptAlias / /full/path/to/django/project/app.wsgi
<Directory /full/path/to/django/project>
    Options +ExecCGI
    ...etc...
</Directory> 
```

**编辑**：

您的配置应如下所示：

```
<VirtualHost *:80>
    DocumentRoot "C:/django_proj"
    ServerName localhost
    WSGIScriptAlias / "C:/django_proj/apache/proj.wsgi"
    <Directory "C:/django_proj/apache">
        Options +ExecCGI
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost>

<VirtualHost *:80>
    DocumentRoot "C:/web"
    ServerName php.localhost
    Alias / C:/web
    <Directory C:/web>
        Options Indexes FollowSymLinks
        AllowOverride None
        Order Deny,Allow
        Allow from all
    </Directory>
</VirtualHost> 
```

您不需要这些`<Directory>`指令`http.conf`......在虚拟主机中进行所有配置。

此外，彻底摆脱`<Directory />`障碍。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-19T23:21:45.283

您的`WSGIScriptAlias / ...`指令告诉 Apache 以“/”开头的所有请求都应该通过 Django 的 WSGI 处理程序提供。如果您将其改为读取`WSGIScriptAlias /django-proj/ ...`，则只有以“/django-proj”开头的请求才会传递到 Django。

另一种方法是开始为每个项目设置虚拟主机。这样，您可以将 Apache 配置为将每个项目放在它自己的域的 / 中，并且您无需担心一个项目的配置会影响您的其他项目之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-14T12:37:56.497

我有同样的问题。尝试`<Directory />`在 httpd-conf 中删除此块。

包括 httpd-vhost.conf 并尝试将我`WSGIScriptAlias / "/somewhere/file.wsgi"`的放在监听端口 80 的 httpd-vhosts 的虚拟主机部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-07T15:31:54.423

我想补充一点，如果您使用的是 Apache *ProxyPass*，则可以拒绝某些 URL 模式，使其属于 mod_php。

```
ProxyPass /wordpress !
<Location /wordpress>
    Require all granted
</Location> 
```

# apache-flex - 第三方外部 swf 需要哪些限制/解决方法

> ID：1020397
> 
> 赞同：0
> 
> 时间：2009-06-19T22:58:35.457
> 
> 标签：apache-flex, flash, actionscript, air

我们正在将外部 swf 内容加载到 adobe air 应用程序中。越来越多的第三方提供内容。

作为第三方内容，它将被加载到单独的安全域 (trustContent=false) 和同级应用程序域 (loadForCompatibility=true) 中。我们正在使用 Loader 类执行此操作。

将 swf 用作外部内容时会导致问题的功能/选项/方法有哪些？

我对任何类型的问题都感兴趣，因为我们已经重现了与加载内容的应用程序域/安全域无关的内容问题（并且也发生在 Loader 和 SWFLoader 中）。

非常感谢任何解决这些问题的方法，尤其是可以从主应用程序应用的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T05:07:39.360

令人讨厌的大问题（我们已经处理过很多问题了！）是外部 SWF 根本不能被直接信任的事实。曾经。这使得它们与基础 AIR 应用程序之间的通信充其量是困难的。

基于通过 URLLoader 加载 SWF 的数据，然后从其中获取字节数组并将其泵入 Loader 有一个 hack。但是，我相信 AIR 1.5.1 已经杀死了 hack。

话虽如此，AIR 应用程序和加载的 SWF 之间可以通过 Adob​​e 所谓的沙盒桥进行通信。但是，设置沙盒桥是一件非常痛苦的事情，任何复杂的数据（对象，甚至像数组一样简单）都会被剥离为桥另一侧的通用对象，并且无法恢复其原始形式。

对于我们最近需要使用桥梁的项目，我们创建了一个名为 AIRBridge 的专业类，您可以在桥梁的两侧使用它，它有助于正确设置所有内容。如果您有兴趣，可以从我们的 Google 代码项目[Automata-Tools](http://code.google.com/p/automata-tools/)中提取当前源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T23:07:04.033

我们已经解决了一个问题：

*   外部 swf 舞台之外的内容会显示在应用程序中，并且在设置将要显示的大小时，会考虑舞台外元素。**解决方法：**在主应用程序上添加一个遮罩，以便隐藏外部内容。使用 .content.width/height（充满舞台外元素）和 .content.loaderInfo.width/height（原始舞台大小）来计算缩放内容的程度，以使原始舞台与可见区域相匹配。

# java - dom4j SAXReader - 停止解析

> ID：1020409
> 
> 赞同：0
> 
> 时间：2009-06-19T23:01:17.433
> 
> 标签：java, xml, parsing, sax, dom4j

我正在使用 SAXReader 解析 XML 文件，并且希望在一定时间（超时）后停止，以防文件太大。概括地说，我想在 ContentHandler 中抛出一个 SAXException（比如在 startElement 中）。

这个想法在这里描述：http: [//www.ibm.com/developerworks/xml/library/x-tipsaxstop/](http://www.ibm.com/developerworks/xml/library/x-tipsaxstop/)

但是，dom4j 的 SAXReader 使用 ElementHandler，其中“onStart”和“onEnd”事件不允许抛出异常。我对在这里做什么有点困惑。

有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T23:03:19.767

当你得到太多时，你总是可以抛出运行时异常。要么自己做，要么使用通常不会出现的现有的之一，并将其​​用作退出的手段。

# python - “django-admin.py makemessages”或 xgettext 调用中的错误？->“警告：未终止的字符串”

> ID：1020432
> 
> 赞同：0
> 
> 时间：2009-06-19T23:16:04.407
> 
> 标签：python, django, internationalization, xgettext

**在包装非常长的字符串的情况下，**django-admin.py makemessages因错误“警告：未终止的字符串”而死：****

 **```
string = "some text \
          more text\
          and even more" 
```

这些字符串甚至不需要翻译——例如 sql 查询字符串。当我连接字符串时问题就消失了，但结果看起来很丑陋，加入它们需要时间......

有没有人有这样的问题？你找到解决方法了吗？

我有以下版本的工具：

xgettext-0.17、gettext-0.17、django-1.0.2、python-2.6.2

有一个关于这个问题的[票](http://byteflow.su/ticket/107)，但它被关闭可能是因为错误只出现在某些组件版本的组合中。

**编辑：找到问题的根源**- xgettext 向 sterr 打印警告消息，django 将它们视为致命错误并退出。

xgettext 调用的返回状态为 0 - “成功”。我想 django 应该将其识别为成功，而不是因为警告而退出。

有趣的是，如果需要翻译，xgettext 仍然会提取反斜杠换行的字符串，但会在 stderr（*“未终止的字符串”*）和 .po 文件（*“国际化消息不应包含 `\r' 转义序列”*）中给出警告

xgettext 调用如下：

```
xgettext -d django -L Python --keyword=gettext_noop \
         --keyword=gettext_lazy --keyword=ngettext_lazy:1,2 \
         --keyword=ugettext_noop --keyword=ugettext_lazy \
         --keyword=ungettext_lazy:1,2 
         --from-code UTF-8 -o - source_file.py 
```

从 django/core/management/commands/makemessages.py 调用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T09:20:43.243

我可以想到两种可能性：在行尾的反斜杠之后可能有一个额外的空格；或者你可能会以某种方式在你的源代码中以错误的行结束字符结束（例如，当你的 Python 期望 Unix 风格时，Windows 风格，从而禁用反斜杠）。

无论哪种方式，我都会利用 C 风格的自动字符串连接：

```
>>> string = ("some text "
...           "more text "
...           "and even more")
>>> string
'some text more text and even more' 
```

或者，如果您不介意换行符出现在此处，请使用多行字符串：

```
>>> string = """some text
...             more text
...             and even more""" 
```

IMO 这些看起来好多了，重构时也不那么脆弱。

这有帮助吗？**

# iphone - 帮助如何从 UIViewController 加载 UINavigationViewController

> ID：1020433
> 
> 赞同：0
> 
> 时间：2009-06-19T23:16:46.120
> 
> 标签：iphone, objective-c

这又是一个愚蠢的问题:(我正在尝试创建一个示例应用程序，当应用程序加载时加载 UIViewController 并且视图包含一个加载 UINavigationViewController 的按钮。

现在，我使用“基于窗口的应用程序”创建了一个项目，并在项目中添加了“RootViewController”，其中包含 .m、.h 和 .xib。

接下来我在“RootViewController.xib”文件中添加了一个视图和一个按钮，它运行正常。之后，我添加了名为“NavViewController”的“UIViewController 子类”文件，其中包含 .h、.m 和 .xib 文件。

我还在“RootViewController”类中添加了 - (IBAction)buttonPressed:(id)sender 函数来加载 NavigationViewController。

这是“buttonPressed：”的代码。

```
- (IBAction)buttonPressed:(id)sender {
    NavViewController *navViewController = [[NavViewController alloc] initWithNibName:@"NavViewController" bundle:nil];
    self.navController = navViewController;
    [self.view insertSubview:navViewController.view atIndex:0];
    [navViewController release];
} 
```

当我“构建并运行”时，它最初运行良好，直到我按下按钮。当我按下按钮时，程序会终止它。

我究竟做错了什么？请帮忙...

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T09:39:56.183

你在做什么错？以非标准方式设计您的应用程序 - 您不应该这样做 - NavigationController 负责！

为什么你会有一个按钮，然后添加一个导航控制器？- 它违反了用户界面指南。我发现一开始就很难掌握界面指南，但你真的必须这样做，因为它会让你的应用程序更加可用。

如果您需要导航控制器，请将其添加到视图中，或者使用导航控制器创建一个新视图。老实说尝试一下，您会觉得用户界面感觉好多了。

如果您真的想要一个将导航控制器添加到窗口的按钮，请执行以下操作：

1.  在代码中保留对 AppDelegate 的引用
2.  使用此引用并将当前视图控制器传递给名为 reloadMainViewWithNavBar:(UNViewController*) viewController 的方法
3.  这个新方法应该删除旧的 mainViewController 并使用您的 viewController 作为根视图控制器创建一个 NavigationController
4.  将导航控制器视图添加到窗口视图

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T03:34:23.310

除了上面提到的修复之外，您真正想要做的是创建包含在导航控制器中的第一个视图控制器 - 但隐藏导航栏，直到按下按钮使其取消隐藏。您无法轻松地将导航控制器添加到您所在的视图中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T23:56:42.453

navController 在 nib 中没有设置视图。UINavigationcontroller 需要一个根视图。在笔尖中，将导航控制器连接到另一个视图控制器。

# c# - C# 数组子集获取

> ID：1020438
> 
> 赞同：2
> 
> 时间：2009-06-19T23:20:39.873
> 
> 标签：c#, algorithm, bytearray, search

我有一个字节数组，我想确定这个字节数组的内容是否作为连续序列存在于另一个更大的数组中。这样做的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T23:25:40.910

天真的方法是：

```
public static bool IsSubsetOf(byte[] set, byte[] subset) {
    for(int i = 0; i < set.Length && i + subset.Length <= set.Length; ++i)
        if (set.Skip(i).Take(subset.Length).SequenceEqual(subset))
            return true;
    return false;
} 
```

对于更有效的方法，您可以考虑更高级的字符串匹配算法，如[KMP](http://en.wikipedia.org/wiki/Knuth-Morris-Pratt_algorithm)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T23:29:31.180

尝试适应一些字符串搜索算法。最快的之一是[Boyer-Moore](http://en.wikipedia.org/wiki/Boyer-Moore_string_search_algorithm)。这也很容易。对于二进制数据，[Knuth-Morris-Pratt](http://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm)算法也可能非常有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-23T03:03:34.537

这是这个答案的 1/1 端口：[Searching for a sequence of Bytes in a Binary File with Java](https://stackoverflow.com/questions/1507780/searching-for-a-sequence-of-bytes-in-a-binary-file-with-java)

这样做是一种非常有效的方法：

```
public static class KmpSearch {

    public static int IndexOf(byte[] data, byte[] pattern) {
        int[] failure = ComputeFailure(pattern);

        int j = 0;
        if (data.Length == 0) return -1;

        for (int i = 0; i < data.Length; i++) {
            while (j > 0 && pattern[j] != data[i]) {
                j = failure[j - 1];
            }
            if (pattern[j] == data[i]) { j++; }
            if (j == pattern.Length) {
                return i - pattern.Length + 1;
            }
        }
        return -1;
    }

    private static int[] ComputeFailure(byte[] pattern) {
        int[] failure = new int[pattern.Length];

        int j = 0;
        for (int i = 1; i < pattern.Length; i++) {
            while (j > 0 && pattern[j] != pattern[i]) {
                j = failure[j - 1];
            }
            if (pattern[j] == pattern[i]) {
                j++;
            }
            failure[i] = j;
        }

        return failure;
    }
} 
```

# email - 如何测试电子邮件送达率 - 垃圾文件夹中的百分比

> ID：1020440
> 
> 赞同：4
> 
> 时间：2009-06-19T23:21:27.220
> 
> 标签：email, spam-prevention

有谁知道测试您的电子邮件是否进入垃圾邮件文件夹的好工具？

我的网络应用程序向用户生成电子邮件，我收到了很多来自人们的报告，他们说“嘿，没有人回复我的消息”。

我有 SPF 规则并正常运行（电子邮件标题显示 spf 通行证）。我也通过垃圾邮件刺客运行我的消息，它的分数非常低。

还有其他想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-02-28T09:07:15.833

要知道您的电子邮件是否进入收件箱，您需要获取一个名为“收件箱放置率”的指标。这个指标可以由 Return Path 提供，但是相当昂贵。如果您不发送大量邮件，则可能不值得。衡量 IPR 的唯一方法实际上是拥有一定数量的测试收件箱......换句话说：检查您的电子邮件是否不在垃圾邮件文件夹中的唯一方法是进行测试并看看会发生什么。没有其他神奇的解决方案，这就是 Return Path 正在做的事情。

这意味着当您听到有人声称他们有 99% 的可送达率/送达率时，这可能是真的，这只是意味着电子邮件已被 ISP“接受”或“送达”。很多，但不是全部！

您应该做的是：使用专注于可交付性的 ESP。我个人为 Mailjet 工作。我相信这是您可以获得的最佳价值：免费提供个性化的 DKIM 和 SPF，您可以获得反垃圾邮件评分、分析、IP 信誉监控、节流等。这是一个多合一的工具，可以避免优化自己的头痛。它比 Amazon SES 更贵，因为您可以获得许多增值服务，但它的价格比许多传统 ESP 低得多！

底线是：自己优化一切是一项全职工作。确切地知道电子邮件是否在收件箱中会花费你很多钱。最好的方法是：

*   尊重最佳实践（选择加入，不要太多图像，不要红色等）
*   获取一些指标，例如打开率、点击率、交付等，并观察它们随时间的演变。从一个发送到另一个发送的任何更改都可能是您要调查的问题的信号。
*   使用能够处理所有可交付性优化的工具

Mailjet 很酷，因为无论您选择哪种计划，您都可以使用所有选项。但是，如果您想全面了解现有内容，请查看此比较表：

[http://socialcompare.com/en/comparison/transactional-emailing-providers-mailjet-sendgrid-critsend](http://socialcompare.com/en/comparison/transactional-emailing-providers-mailjet-sendgrid-critsend)

如果您是一个完美主义者，想要微调布局、电子邮件的显示方式等。看看 Litmus，它也是一个非常强大的工具！

[http://litmus.com/](http://litmus.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-16T17:26:14.250

简单的答案：使用 Mailgun！！！！

[http://mailgun.net/](http://mailgun.net/)

他们将为您完成所有的电子邮件传递和设置，并为您提供强大的 API 以供构建！他们是了不起的。您再也不用担心域密钥或垃圾邮件过滤了！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T23:32:58.757

您还应该检查您的 IP 是否不在任何主要的黑名单上。 [dnsbl.info](http://www.dnsbl.info/dnsbl-database-check.php)

如果您实际上被标记为垃圾邮件，这至少会给您一个想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-18T16:53:51.873

在过去的两年里，我们使用了 DeliveryMonitor.com 服务。然而，他们已经停止接受新的申请，这是一个很大的危险信号......

我目前正在使用他们的免费试用版从 emailreach.com 评估服务

...我们现在正在使用 DeliveryWatch.com，到目前为止效果非常好...

# c++ - 同时使多个指针为NULL

> ID：1020443
> 
> 赞同：6
> 
> 时间：2009-06-19T23:24:30.223
> 
> 标签：c++, pointers

这是我用 n 个指针创建的 C++ 类。

```
class SomeClass
{
private:
        int* ptr1;
        int* ptr2;
        ...
        int* ptrn;

private:
        // constructors, destructors, and methods
}; 
```

在初始化阶段，我想让所有这些指针都指向 NULL（或者在声明它们时让指针默认指向 NULL），而不是这样做：

```
void SomeClass::MakePtrNull()
{
        ptr1 = NULL;
        ptr2 = NULL;
        ...
        ptrn = NULL;
} 
```

有没有什么简单的方法可以实现这个目标？我只是想知道是否有任何方法可以避免键入 n 行 ptr = NULL; 在我的功能中。提前致谢。

**根据我到目前为止收到的答案添加：不幸的是，这些指针必须分开，因为它们用于不同的目的**。**我这样命名指针只是为了说明我正在尝试做的事情，但是每个指针都有完全不同的目的。我想我必须像我已经做的那样让它们指向 NULL。感谢您的回答。**

 *** * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-19T23:49:57.753

代替`int *`，创建一个类似智能指针的类，其工作方式与 完全相同`int *`，但默认构造为 NULL：

```
template <typename T>
class MyPointer {
    T *p;

public:
    MyPointer() : p(NULL) { }
    MyPointer(T *o) : p(o) { }
    operator T*() const { return p; }
    // ...and the rest of the traditional smart-pointer operators
}; 
```

然后，在你的课堂上使用它：

```
class SomeClass
{
private:
        MyPointer<int> ptr1;
        MyPointer<int> ptr2;
        ...
        MyPointer<int> ptrn;

private:
        // constructors, destructors, and methods
}; 
```

该类型的每个变量都`MyPointer<int>`将在 的构造函数中自动正确初始化`SomeClass`，而无需任何额外的输入。如果您没有忘记或错误地实现任何`MyPointer`'s 方法，它将完全像普通指针一样工作，并具有完全相同的大小和性能。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-19T23:27:30.717

为什么不使用数组或向量而不是创建 n 个单独命名的指针？然后你可以在一个简短的 for 循环中进行归零。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-19T23:28:09.453

你可以这样做：

```
void SomeClass::MakePtrNull()
{
        ptr1 = ptr2 = ptr3 = ... = ptrn = NULL;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-19T23:28:58.017

首先，**不起作用**的技术：

调用 memset 将整个对象设置为零是不行的。首先，如果你的函数有一个或多个虚函数会带来很多麻烦，其次，空指针不能保证用全零的位模式来表示。

在您的情况下，我可能会做的是将指针存储在数组或向量中。然后，您可以使用该`std::fill`函数将它们全部设置为 NULL。（或者，如果您愿意，也可以使用循环）

当然，如果您需要经常这样做，则可能值得编写一个包装类，它的行为类似于指针，但在其默认构造函数中将其设置为 NULL。

或者你可以使用 boost::optional ，它的工作原理基本上是这样的。（虽然它不是特定于指针）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-20T13:33:55.010

如果您必须单独保留指针，我建议您执行以下操作（可能最迫切的需要是指针可以具有不同的类型）

```
class SomeClass {
    struct Pointers {
        int* ptr1;
        int* ptr2;
        float* ptrn;
    } ptrs;

public:
    void MakePtrNull();
};

void SomeClass::MakePtrNull()
{
    // clears all pointers at once
    ptrs = Pointers();
} 
```

这确实有效，因为没有用户声明的构造函数的类的值初始化将初始化其所有成员。指针的值初始化将创建一个空指针。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-19T23:29:05.333

为什么不使用默认构造函数：

```
SomeClass::SomeClass() : ptr1(NULL), ptr2(NULL), ...
{

} 
```

你也可以这样做：

```
ptr1 = ptr2 = ptr3 = NULL; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-19T23:57:32.607

您可以将指针放入结构中，然后在需要时将 memset() 放入结构中。指针仍然是分开的，但是您可以将它们作为一个单元来定位，而不会影响班级的其余部分。例如：

```
struct MyPointers
{
    int* ptr1;
    int* ptr2;
    ...
    int* ptrn;
};

class SomeClass
{
private:
    MyPointers ptrs;
    ...
};

void SomeClass::MakePtrNull()
{
    memset(&ptrs, 0, sizeof(ptrs));
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T23:33:46.447

为此使用向量（因为从它的声音来看，您将来不需要编辑列表 - 而且您需要随机访问）。你可以这样做：

```
class PointerList
{
private:
    typedef std::vector<int*> IntPtrVector;
    IntPtrVector m_ptrVec;

public:
    PointerList()
    {
        m_ptrVec.reserve(5);
        for (int i = 0; i < 5; i++)
            m_ptrVec.push_back(NULL);
    }

    int* getPointer(int index)
    {
        return m_ptrVec[index];
    }

    void setPointer(int index, int* ptr)
    {
        assert(index <= 4);
        m_ptrVec[index] = ptr;
    }
}; 
```

**编辑**

虽然说实话，这有点贫民窟的味道。您确定您的问题需要此解决方案吗？如果您详细说明您的具体问题，也许在另一个问题中，我相信您可以就如何更优雅地完成您想要的事情获得更好的答案 - 而不是通过创建第二个问题。**

# c# - 在 .Net 3.5 上使用 ICSharpCode.AvalonEdit？

> ID：1020447
> 
> 赞同：2
> 
> 时间：2009-06-19T23:26:45.900
> 
> 标签：c#, .net, text-editor, sharpdevelop, avalonedit

我正在尝试在我正在构建的 WPF 应用程序中使用来自 SharpDevelop 4.0 项目的 ICSharpCode.AvalonEdit.TextEditor 控件，但我似乎无法让它工作。

我从 svn://svnmirror.sharpdevelop.net/sharpdevelop/trunk/SharpDevelop/src/Libraries/AvalonEdit 在修订版 4304 中检查了源代码的副本。然后，我使用 Visual Studio 2008 SP1 构建了该项目，该项目没有成功错误。

然后我创建了一个空白的新 WPF 项目，将构建 DLL 添加到工具箱中，并将 TextEditor 控件拖放到默认的空窗口中，如下所示：

```
<Window x:Class="AvalonEditTest.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:avalonedit="http://icsharpcode.net/sharpdevelop/avalonedit"        
    Title="Window1" Height="300" Width="300" >
    <Grid x:Name="LayoutRoot">
        <avalonedit:TextEditor Name="textEditor" />
    </Grid>
</Window> 
```

但是，当我运行项目时，表单完全空白。没有插入符号，鼠标光标保持默认指针，窗口不响应按键。

我错过了什么，还是 AvalonEdit 有点坏了？

[编辑：我开始认为这可能与我的特定设置有关。我正在运行 64 位 Windows 7 RC。这可能与它有关吗？我试过只为 x86 构建它，没有区别。]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-12T14:06:32.637

你确定你的命名空间声明是正确的吗？

你可以尝试这样的事情：

```
<Window x:Class="Editor.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300" 
    xmlns:e="clr-namespace:ICSharpCode.AvalonEdit;assembly=ICSharpCode.AvalonEdit">
    <Grid>
        <e:TextEditor x:Name="Editor" WordWrap="True" Height="200">          
        </e:TextEditor>
    </Grid>
</Window> 
```

我能够让它毫无问题地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-30T17:08:10.420

这适用于我的最新版本

```
<DockPanel LastChildFill="True">
    <avalonedit:TextEditor 
        HorizontalAlignment="Stretch"
        Name="textEditor1" 
        VerticalAlignment="Stretch" />
</DockPanel> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T23:52:49.807

AvalonEdit TextEditor 只是一个 TextDocument 模型的视图。问题是一个新的 AvalonEdit 实例没有开始连接到任何模型实例，所以没有任何东西可以编辑。

来自 statictype 的代码起作用的原因是他没有使用`<avalonedit:TextEditor/>`，但是`<avalonedit:TextEditor></avalonedit:TextEditor>`. 这将为 Text 属性分配一个空字符串，从而导致编辑器隐式创建一个新文档。

但这与最近的 AvalonEdit 版本不再相关，编辑器现在总是会创建一个新的 TextDocument。

# php - 如何用php替换坏词？

> ID：1020451
> 
> 赞同：2
> 
> 时间：2009-06-19T23:27:55.817
> 
> 标签：php

我有一些文本需要过滤掉一个坏词列表，例如：

```
$bad_words = array(
  'word1' => 'gosh',
  'word2' => 'darn',
); 
```

我可以遍历这些并一次更换一个，但这很慢，对吧？有没有更好的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T23:30:01.320

就在这里。使用[`preg_replace_callback()`](http://au2.php.net/preg_replace_callback)：

```
<?php
header('Content-Type: text/plain');

$text = 'word1 some more words. word2 and some more words';
$text = preg_replace_callback('!\w+!', 'filter_bad_words', $text);
echo $text;

$bad_words = array(
  'word1' => 'gosh',
  'word2' => 'darn',
);

function filter_bad_words($matches) {
  global $bad_words;
  $replace = $bad_words[$matches[0]];
  return isset($replace) ? $replace : $matches[0];
}
?> 
```

这是一个简单的过滤器，但它有很多限制。就像它不会停止拼写变化，在字母之间使用空格或其他非单词字符，用数字替换字母等等。但是你想要它有多复杂基本上取决于你。

### 更新（2016 年 9 月 11 日）

我意识到这是 7 岁，但如果正在测试的单词不在`$bad_words`数组中，较新版本的 php 似乎会抛出异常。为了解决这个问题，我改变了最后两行`filter_bad_words()`如下：

```
$replace = array_key_exists($matches[0], $bad_words) ? $bad_words[$matches[0]] : false;
return $replace ?: $matches[0]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T23:29:26.157

[str_ireplace()](http://us3.php.net/str_ireplace)可以为搜索和替换参数获取一个数组。您可以将它与现有数组一起使用，如下所示：

```
$unfiltered_string = "gosh and darn are bad words";
$filtered_string = str_ireplace(array_vals($bad_words), array_keys($bad_words), $unfiltered_string);

// $filtered string now contains: "word1 and word2 are bad words" 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-19T23:33:16.133

像这样：

```
function clean($array, $str) {
    $words = array_keys($array);
    $replacements = array_values($array);

    return preg_replace($words, $replacements, $str);
} 
```

# python - Python中的继承有什么意义？

> ID：1020453
> 
> 赞同：84
> 
> 时间：2009-06-19T23:28:18.733
> 
> 标签：python, oop, inheritance

假设你有以下情况

```
#include <iostream>

class Animal {
public:
    virtual void speak() = 0;
};

class Dog : public Animal {
    void speak() { std::cout << "woff!" <<std::endl; }
};

class Cat : public Animal {
    void speak() { std::cout << "meow!" <<std::endl; }
};

void makeSpeak(Animal &a) {
    a.speak();
}

int main() {
    Dog d;
    Cat c;
    makeSpeak(d);
    makeSpeak(c);
} 
```

如您所见，makeSpeak 是一个接受通用 Animal 对象的例程。在这种情况下，Animal 与 Java 接口非常相似，因为它只包含一个纯虚方法。makeSpeak 不知道它通过的 Animal 的性质。它只是向它发送信号“speak”，并让后期绑定处理调用哪个方法：Cat::speak() 或 Dog::speak()。这意味着，就 makeSpeak 而言，实际上传递了哪个子类的知识是无关紧要的。

但是 Python 呢？让我们看一下 Python 中相同案例的代码。请注意，我暂时尽量与 C++ 案例相似：

```
class Animal(object):
    def speak(self):
        raise NotImplementedError()

class Dog(Animal):
    def speak(self):
        print "woff!"

class Cat(Animal):
    def speak(self):
        print "meow"

def makeSpeak(a):
    a.speak()

d=Dog()
c=Cat()
makeSpeak(d)
makeSpeak(c) 
```

现在，在此示例中，您会看到相同的策略。您使用继承来利用 Dogs 和 Cats 都是 Animals 的分层概念。但在 Python 中，不需要这种层次结构。这同样有效

```
class Dog:
    def speak(self):
        print "woff!"

class Cat:
    def speak(self):
        print "meow"

def makeSpeak(a):
    a.speak()

d=Dog()
c=Cat()
makeSpeak(d)
makeSpeak(c) 
```

在 Python 中，您可以将“说话”信号发送给您想要的任何对象。如果对象能够处理它，它将被执行，否则它会引发异常。假设您在两个代码中都添加了一个 Airplane 类，并将一个 Airplane 对象提交给 makeSpeak。在 C++ 的情况下，它不会编译，因为 Airplane 不是 Animal 的派生类。在 Python 的情况下，它会在运行时引发异常，这甚至可能是预期的行为。

另一方面，假设您添加了一个带有方法 speak() 的 MouthOfTruth 类。在 C++ 案例中，您必须重构层次结构，或者必须定义不同的 makeSpeak 方法来接受 MouthOfTruth 对象，或者在 java 中，您可以将行为提取到 CanSpeakIface 中并为每个对象实现接口。有很多解决方案...

我想指出的是，我还没有找到在 Python 中使用继承的单一理由（除了框架和异常树，但我想存在替代策略）。您无需实现基派生层次结构即可以多态方式执行。如果您想使用继承来重用实现，您可以通过包含和委托来完成相同的操作，另外还有一个好处是您可以在运行时更改它，并且您可以清楚地定义包含的接口，而不会冒意外副作用的风险。

所以，最后，问题是：Python 中的继承有什么意义？

**编辑**：感谢非常有趣的答案。事实上，你可以将它用于代码重用，但我在重用实现时总是很小心。一般来说，我倾向于做非常浅的继承树或根本不做树，如果一个功能很常见，我将它重构为一个公共模块例程，然后从每个对象中调用它。我确实看到了单点更改的好处（例如，我只添加到 Animal，而不是添加到 Dog、Cat、Moose 等，这是继承的基本优势），但是您可以通过一个委托链（例如，一个 JavaScript）。我并不是说它更好，只是另一种方式。

我也找到了关于这方面[的类似帖子。](http://forums.devshed.com/python-programming-11/does-interface-only-inheritance-make-sense-in-python-82822.html)

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-06-19T23:35:48.453

您将运行时鸭子类型称为“覆盖”继承，但是我相信继承作为一种设计和实现方法有其自身的优点，它是面向对象设计的一个组成部分。在我看来，你是否能以其他方式实现某些东西的问题并不是很重要，因为实际上你可以在没有类、函数等的情况下编写 Python 代码，但问题是你的代码的设计、健壮和可读性如何。

我可以举两个例子来说明我认为继承是正确方法的地方，我相信还有更多。

首先，如果你编码得当，你的 makeSpeak 函数可能想要验证它的输入确实是一个 Animal，而不仅仅是“它会说话”，在这种情况下，最优雅的方法是使用继承。同样，你可以用其他方式来做，但这就是具有继承的面向对象设计的美妙之处——你的代码将“真的”检查输入是否是“动物”。

其次，显然更直接的是封装——面向对象设计的另一个组成部分。当祖先具有数据成员和/或非抽象方法时，这变得相关。举一个愚蠢的例子，其中祖先有一个函数（speak_twice），它调用一个 then-abstract 函数：

```
class Animal(object):
    def speak(self):
        raise NotImplementedError()

    def speak_twice(self):
        self.speak()
        self.speak()

class Dog(Animal):
    def speak(self):
        print "woff!"

class Cat(Animal):
    def speak(self):
        print "meow" 
```

假设`"speak_twice"`是一个重要特性，您不想同时在 Dog 和 Cat 中对其进行编码，我相信您可以推断这个示例。当然，您可以实现一个 Python 独立函数，该函数将接受一些鸭子类型的对象，检查它是否有一个 speak 函数并调用它两次，但这既不优雅，也错过了第 1 点（验证它是一个动物）。更糟糕的是，为了加强封装示例，如果后代类中的成员函数想要使用`"speak_twice"`怎么办？

如果祖先类有一个数据成员，例如由祖先类中`"number_of_legs"`的非抽象方法使用`"print_number_of_legs"`，但在后代类的构造函数中启动（例如，Dog 将使用 4 初始化它，而 Snake 将初始化它与 0）。

同样，我确信还有无穷无尽的示例，但基本上每个（足够大的）基于可靠的面向对象设计的软件都需要继承。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-20T04:51:10.347

Python 中的继承就是代码重用。将通用功能分解为基类，并在派生类中实现不同的功能。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-20T03:44:11.340

Python 中的继承比其他任何东西都更方便。我发现它最好用于提供具有“默认行为”的类。

事实上，有一个重要的 Python 开发者社区反对使用继承。无论你做什么，不要只是不要过度。拥有一个过于复杂的类层次结构肯定会被贴上“Java 程序员”的标签，而你就是不能拥有它。:-)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-19T23:34:45.197

我认为Python中继承的目的不是让代码编译，而是继承的真正原因是将类扩展到另一个子类，并覆盖基类中的逻辑。但是 Python 中的鸭子类型使得“接口”概念变得毫无用处，因为您可以在调用之前检查方法是否存在，而无需使用接口来限制类结构。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-20T03:31:25.170

我认为很难用这样抽象的例子给出一个有意义的、具体的答案……

为简化起见，有两种类型的继承：接口和实现。如果您需要继承实现，那么 python 与静态类型的 OO 语言（如 C++）并没有太大区别。

接口的继承是有很大区别的地方，根据我的经验，它会对你的软件设计产生根本性的影响。在这种情况下，像 Python 这样的语言不会强迫您使用继承，并且在大多数情况下避免继承是一个好点，因为以后很难修复错误的设计选择。这是任何优秀的 OOP 书籍中提出的一个众所周知的观点。

在某些情况下，在 Python 中建议对接口使用继承，例如插件等。对于这些情况，Python 2.5 及以下版本缺乏“内置”的优雅方法，并且几个大框架设计了自己的解决方案（zope，trac，twister）。Python 2.6 及以上版本有[ABC 类来解决这个问题](http://www.python.org/dev/peps/pep-3119/#abcs-vs-duck-typing)。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-10-15T22:28:31.100

鸭子类型没有意义的不是继承，而是接口——就像你在创建一个全抽象的动物类时选择的接口。

如果您使用的动物类为其后代引入了一些真实行为，那么引入了一些额外行为的狗和猫类将有两个类的原因。只有在祖先类没有为后代类提供实际代码的情况下，您的论点才是正确的。

因为 Python 可以直接知道任何对象的能力，而且这些能力在类定义之外是可变的，所以使用纯抽象接口“告诉”程序可以调用哪些方法的想法有点毫无意义。但这不是唯一的，甚至不是主要的继承点。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-06-20T01:01:40.887

在 C++/Java/etc 中，多态性是由继承引起的。放弃这种错误的信念，动态语言向你敞开。

从本质上讲，在 Python 中没有接口，而是“理解某些方法是可调用的”。漂亮的手波和学术听起来，不是吗？这意味着因为您调用“speak”，您显然希望该对象应该具有“speak”方法。很简单吧？这是非常 Liskov 式的，因为类的用户定义了它的接口，这是一个很好的设计概念，可以引导您进入更健康的 TDD。

所以剩下的是，正如另一位发帖人礼貌地避免说的那样，一个代码共享技巧。您可以将相同的行为写入每个“子”类，但这将是多余的。更容易继承或混合在继承层次结构中不变的功能。一般来说，更小、更干燥的代码更好。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-07-01T20:55:23.263

我认为继承没有多大意义。

每次我在实际系统中使用继承时，我都会被烧死，因为它会导致依赖关系的错综复杂，或者我只是及时意识到没有它我会好很多。现在，我尽可能地避免它。我只是从来没有用过它。

```
class Repeat:
    "Send a message more than once"
    def __init__(repeat, times, do):
        repeat.times = times
        repeat.do = do

    def __call__(repeat):
        for i in xrange(repeat.times):
             repeat.do()

class Speak:
    def __init__(speak, animal):
        """
        Check that the animal can speak.

        If not we can do something about it (e.g. ignore it).
        """
        speak.__call__ = animal.speak

    def twice(speak):
        Repeat(2, speak)()

class Dog:
     def speak(dog):
         print "Woof"

class Cat:
     def speak(cat):
         print "Meow"

>>> felix = Cat()
>>> Speak(felix)()
Meow

>>> fido = Dog()
>>> speak = Speak(fido)
>>> speak()
Woof

>>> speak.twice()
Woof

>>> speak_twice = Repeat(2, Speak(felix))
>>> speak_twice()
Meow
Meow 
```

James Gosling 曾在一次新闻发布会上被问到一个类似的问题：“如果你可以回去做不同的 Java，你会遗漏什么？”。他的回答是“上课”，引起了哄堂大笑。但是，他很认真地解释说，实际上，问题不在于类，而在于继承。

我有点把它看作是药物依赖——它给你一个感觉很好的快速修复，但最终，它把你搞砸了。我的意思是这是一种重用代码的便捷方式，但它会在子类和父类之间产生不健康的耦合。对父母的改变可能会破坏孩子。孩子依赖于父母的某些功能并且不能改变该功能。因此，孩子提供的功能也与父母相关——你只能同时拥有两者。

更好的是为实现该接口的接口提供一个面向客户端的类，使用在构造时组合的其他对象的功能。通过适当设计的接口来做到这一点，所有的耦合都可以被消除，我们提供了一个高度可组合的 API（这不是什么新鲜事——大多数程序员已经这样做了，只是还不够）。请注意，实现类不能简单地公开功能，否则客户端应该直接使用组合类 - 它*必须*通过组合该功能来做一些新的事情。

继承阵营的观点认为，纯委托实现会受到影响，因为它们需要大量“胶水”方法，这些方法只是通过委托“链”传递值。然而，这只是使用委托重新发明了类似继承的设计。多年接触基于继承的设计的程序员特别容易落入这个陷阱，因为在没有意识到的情况下，他们会考虑如何使用继承来实现某些东西，然后将其转换为委托。

像上面的代码这样正确分离关注点不需要粘合方法，因为每个步骤实际上都是在*增加价值*，所以它们根本不是真正的“粘合”方法（如果它们不增加价值，那么设计就有缺陷）。

归结为：

*   对于可重用代码，每个类应该只做一件事（并且做得好）。

*   继承创建了不止一件事的类，因为它们与父类混合在一起。

*   因此，使用继承会使类难以重用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-24T23:40:17.903

您可以在 Python 和几乎任何其他语言中绕过继承。不过，这都是关于代码重用和代码简化的。

只是一个语义技巧，但是在构建了类和基类之后，您甚至不必知道您的对象可以做什么来查看您是否可以做到。

假设你有 d ，它是一个 Dog ，它是 Animal 的子类。

```
command = raw_input("What do you want the dog to do?")
if command in dir(d): getattr(d,command)() 
```

如果用户输入的任何内容可用，则代码将运行正确的方法。

使用它，您可以创建任何您想要的哺乳动物/爬行动物/鸟类混合怪物的组合，现在您可以让它说“树皮！” 一边飞一边伸出分叉的舌头，它会妥善处理它！玩得开心！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-07-11T14:14:27.263

另一个小点是 op 的第三个例子，你不能调用 isinstance()。例如，将您的第 3 个示例传递给另一个对象，该对象采用“Animal”类型的调用来说话。如果你不这样做，你将不得不检查狗的类型、猫的类型等等。由于后期绑定，不确定实例检查是否真的是“Pythonic”。但是你必须实现某种方式，AnimalControl 不会尝试将芝士汉堡类型扔进卡车，因为芝士汉堡不会说话。

```
class AnimalControl(object):
    def __init__(self):
        self._animalsInTruck=[]

    def catachAnimal(self,animal):
        if isinstance(animal,Animal):
            animal.speak()  #It's upset so it speak's/maybe it should be makesNoise
            if not self._animalsInTruck.count <=10:
                self._animalsInTruck.append(animal) #It's then put in the truck.
            else:
                #make note of location, catch you later...
        else:
            return animal #It's not an Animal() type / maybe return False/0/"message" 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-19T23:52:43.757

Python 中的类基本上只是对一堆函数和数据进行分组的方式。它们与 C++ 中的类等不同。

我经常看到用于覆盖超类的方法的继承。例如，也许更 Python'ish 使用继承将是..

```
from world.animals import Dog

class Cat(Dog):
    def speak(self):
        print "meow" 
```

当然，猫不是一种狗，但我有这个（第三方）`Dog`类，它工作得很好，*除了*我想重写的`speak`方法——这节省了重新实现整个类，所以它喵喵叫。同样，虽然`Cat`不是 的类型`Dog`，但猫确实继承了很多属性..

重写方法或属性的更好（实际）示例是如何更改 urllib 的用户代理。您基本上是子类`urllib.FancyURLopener`并更改版本属性（[来自文档](http://docs.python.org/library/urllib.html#urllib._urlopener)）：

```
import urllib

class AppURLopener(urllib.FancyURLopener):
    version = "App/1.7"

urllib._urlopener = AppURLopener() 
```

使用异常的另一种方式是用于异常，当以更“正确”的方式使用继承时：

```
class AnimalError(Exception):
    pass

class AnimalBrokenLegError(AnimalError):
    pass

class AnimalSickError(AnimalError):
    pass 
```

..然后你可以捕捉`AnimalError`到所有从它继承的异常，或者一个特定的，比如 `AnimalBrokenLegError`

# fortran - 在调用 SUBROUTINE 之前调用 ENTRY 时是否分配了 SUBROUTINE 变量

> ID：1020464
> 
> 赞同：1
> 
> 时间：2009-06-19T23:30:23.473
> 
> 标签：fortran

我有`ENTRY`在`SUBROUTINE`. `SUBROUTINE`变量是否分配？

```
SUBROUTINE foo
character*5 A,B,C
DIMENSION IA(50),IB(50)
print* A,B,C
RETURN
ENTRY bar
DO 50 I=1,50
TOTAL = TOTAL + IA(I)
50 CONTINUE
print* TOTAL
RETURN
END 
```

那么如果我`CALL bar`之前`foo`是`IA`分配的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T23:33:39.893

据我所知，除非你在编译期间有一个特殊的开关，否则不会对堆栈分配的数据进行初始化，而且这在所有编译器中都不存在（IBM xlf 有它，但我不记得了）。

这意味着这些数组将充满随机垃圾。

无论如何，我强烈建议你*不要*使用 ENTRY，除非你的生活依赖它。正如您所展示的那样，除了预先设置状态然后调用 ENTRY 符号之外，我真的看不出使用它的理由，但是有更好、更清洁的替代方案。

如果你的意思是分配，那么它肯定是。这段代码

```
 program hello
  call bar
  end
  SUBROUTINE foo
  character A(12345)
  a(1) = "hello"
  ENTRY bar
  print *, a(1)
  RETURN
  END 
```

被编译成这个代码（长的东西）

```
.globl _bar_
_bar_:
    pushl   %ebp
    movl    %esp, %ebp
    subl    $24, %esp
    movl    $0, -8(%ebp)
    movl    $1, -4(%ebp)
    subl    $4, %esp
    pushl   $0
    leal    -12(%ebp), %eax
    pushl   %eax
    leal    -4(%ebp), %eax
    pushl   %eax
    call    ___g95_master_0__
    addl    $16, %esp
    movl    %eax, -8(%ebp)
    movl    -8(%ebp), %eax
    leave
    ret
.globl _foo_
_foo_:
    pushl   %ebp
    movl    %esp, %ebp
    subl    $24, %esp
    movl    $0, -8(%ebp)
    movl    $0, -4(%ebp)
    subl    $4, %esp
    pushl   $0
    leal    -12(%ebp), %eax
    pushl   %eax
    leal    -4(%ebp), %eax
    pushl   %eax
    call    ___g95_master_0__
    addl    $16, %esp
    movl    %eax, -8(%ebp)
    movl    -8(%ebp), %eax
    leave
    ret 
```

如您所见，基本相同（即，ENTRY 只是初始化部分的“复制”例程，然后再分叉）实际分配发生在 ___g95_master_0_

```
___g95_master_0__:
    pushl   %ebp
    movl    %esp, %ebp
    pushl   %ebx
    subl    $12372, %esp
    call    L8 
```

您看到堆栈指针递减的地方，您可以看到它在两个例程中都被调用。

当然，如果您的第一部分包含一个 ALLOCATABLE 变量和一个 ALLOCATE，那么情况就会改变。在那种情况下，我很确定它不会被分配。你会崩溃，但这是另一个问题。

# java - 无法让 GWT FormPanel 正常工作

> ID：1020468
> 
> 赞同：6
> 
> 时间：2009-06-19T23:32:49.333
> 
> 标签：java, gwt

我已经尝试了几天了，但没有运气。

```
final FormPanel form = new FormPanel(new NamedFrame("test"));
form.setAction("/designer");
form.setMethod(FormPanel.METHOD_POST);
VerticalPanel panel = new VerticalPanel();
form.setWidget(panel);

final TextBox tb = new TextBox();
tb.setName("style");
panel.add(tb);
panel.add(new Button("Submit", new ClickHandler() {
public void onClick(ClickEvent event) {
   Window.alert("submitting to:" + form.getTarget());
   form.submit();
    }
}));
form.addSubmitCompleteHandler(new SubmitCompleteHandler() {
public void onSubmitComplete(SubmitCompleteEvent event) {
  Window.alert("complete");
  Window.alert(event.getResults());
}
}); 
```

在托管模式下，“提交到”警报触发后没有任何反应。在 Chrome 中，表单会在单独的选项卡中加载，但 POST 本身是空的。同样，在 Firefox 和 IE 中，警报之后没有任何反应。有任何想法吗？

我在 /designer 设置了一个 servlet，它从任何页面请求中输出请求标头和正文。我可以从一个普通的 HTML 页面点击这个 servlet 并查看预期的输出。从 GWT 中，不会出现任何请求（Chrome 除外，其中显示了请求，但正文为空）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-01T14:14:38.530

尝试移动`form.setWidget(panel);`到底部。

此外，请确保将表单添加到容器面板，即`add(form);`，而不是垂直面板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T06:24:59.180

您的代码几乎与[FormPanel API](http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/user/client/ui/FormPanel.html)上的示例相同，因此我必须假设逻辑是正确的。

“/designer”中是否存在 servlet？[SubmitCompleteHandler](http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/user/client/ui/FormPanel.SubmitCompleteHandler.html)的文档指出，只有在提交成功时才会触发 onSubmitComplete 事件。

这是一个包含一些示例代码的线程，用于编写处理表单发布的 servlet：[http ://groups.google.com/group/Google-Web-Toolkit/browse_thread/thread/77e68fcb9097debc](http://groups.google.com/group/Google-Web-Toolkit/browse_thread/thread/77e68fcb9097debc)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T16:23:22.490

我知道这篇文章已经 3 年了，但是为了像我这样登陆这里的任何谷歌用户，这是*OnSubmitCompleteEvent*被解雇的条件：

1.  使用无参数构造函数来构建表单：**FormPanel f = new FormPanel();** . 如[Javadoc](http://google-web-toolkit.googlecode.com/svn/javadoc/2.4/com/google/gwt/user/client/ui/FormPanel.html#FormPanel%28%29)中所述：

    > 创建一个新的 FormPanel。当使用此构造函数创建时，它将被提交给隐藏的 <iframe> 元素，并且提交的结果 **通过****{@link SubmitCompleteHandler} 可用**。

    所以它是唯一一个在成功时触发表单提交完成事件的事件。

2.  确保被调用的操作返回 **内容类型的响应：“text/html”**

如果您仍需要使用外部**NamedFrame**，一种解决方案是观察框架上的**LoadEvent**。它在框架开始加载时被触发，这意味着来自服务器的响应到达：...

```
NamedFrame frame = new NamedFrame("test");
frame.addLoadHandler(new LoadHandler()
{
    void onLoad(LoadEvent event)
    {
        //your code here
    }
}); 
```

希望能帮助到你！

# mysql - 地理冗余和 MySQL 复制

> ID：1020469
> 
> 赞同：1
> 
> 时间：2009-06-19T23:32:49.350
> 
> 标签：mysql, apache, replication

我有一个相当简单的网站，使用 LAMP 配置每天获得 200K 次点击（3-5 次点击/秒）。主机有点不稳定（读作：便宜），所以我们想添加第二台主机以保证正常运行时间（我不会称此任务为关键任务，但更多的是防止烦恼）。

MySQL 以大约 200 qps 的速度空闲，有时会达到 450。

我有一些 master-master 和 maatkit 设置的经验，所以我打算在第二个位置复制站点，使用 master-master 复制，并使用 maatkit 验证数据并监控 slave-lag 等。

但是，在阅读有关此设置的所有可怕警告时，我试图评估这是否是正确的举动。什么是替代架构？

附加问题：假设您有 2 台服务器，一台在东海岸，一台在西海岸。为那些数据库负载平衡的合理策略是什么？你会让西海岸的 apache 服务器访问东海岸的 mysql 吗？这真的是一种选择吗？我认为延迟会扼杀性能......

有什么想法吗？TIA 迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T08:23:49.597

美国的时间大约为 50 毫秒，因此假设您对每个 http 查询执行 40-90 个 mysql 查询，您可以预期 http 查询的延迟增加至少 2-4.5 秒。这忽略了传输任何大型有效负载所需的时间。你不想为这个应用做跨大陆的mysql。

避免跨大陆 mysql 查询的另一个原因是两个主服务器可能不同步，因此如果您对两个数据库进行循环查询，用户可能会看到不一致的数据并感到困惑。但是，如果您的本地数据库出现故障，则回退到远程数据库是合理的。在这种情况下，您还希望将流量从本地网络服务器转移，以避免上述延迟命中。

您需要确保用户坚持使用同一个 apache 服务器，以便他们获得一致的数据视图。一个简单的方法是将用户从 www.yoursite.com 重定向到 server1.yoursite.com 和 server2.yoursite.com，确保所有 URL 都是相对的。如果一台服务器出现故障，您可以重新指向 DNS，在此之前，用户可能会不断刷新 www.yoursite.com（将作为 DNS 循环服务），直到他们获得另一台服务器。这样做的一个危险是用户会将 server1.yoursite.com 加入书签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-03T05:22:55.647

可以使用活动备用方法在同一站点使用虚拟 IP 来保证正常运行时间。您甚至可以将不同的站点配置为活动备用。地理冗余是另一个问题。

# jquery - 使用 JQuery 删除元素

> ID：1020474
> 
> 赞同：0
> 
> 时间：2009-06-19T23:33:17.493
> 
> 标签：jquery

我目前正在使用以下代码将 X 链接附加到翻转时的每个元素。

```
$(".item").hover(function() {
    var id = $(this).attr("id");

    var roll = $('<a class="close" href="#">X</a>').hide();

    roll.prependTo($(this)).fadeIn(0);
}, function() {
    $(this).find("a:first").fadeOut(0, function() {
        $(this).remove()
    });
}); 
```

我无法编写的是当这个 X 链接被按下时，它会删除它当前所在的父 div。

很想在这方面提供帮助:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T23:36:17.517

好吧，首先我建议在 hover() 事件上动态添加和删除元素可能会出现问题。通常的解决方案是根据需要显示/隐藏它们。它的性能也更高。

所以：

```
<div class="item">
  <p>Some content</p>
  <a class="close" href="#">X</a>
</div> 
```

和

```
div.item a.close { display: none; } 
```

和

```
$("div.item").hover(function() {
  $("a.close", this).fadeIn();
}, function() {
  $("a.close", this).fadeOut();
});
$("a.close").click(function() {
  $(this).parents("div.item:first").remove();
  return false;
}); 
```

现在您可以通过动态添加到 DOM 的链接来做到这一点，但我建议不要这样做。但是，如果您这样做，请[`live()`](http://docs.jquery.com/Events/live)用于事件处理：

```
$("a.close").live("click", function() {
  $(this).parents("div.item:first").remove();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T23:40:03.377

像这样的东西应该工作。尽管正如 cletus 所说，您在 hover() 上所做的事情可能会出现问题。

```
$("a.close").click(function(){
   $(this).parent().remove();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T23:44:08.890

将所有其他内容与点击处理程序结合起来：

```
$('<a class="close" href="#">X</a>')
      .hide()
      .prependTo($(this))
      .click( function() { $(this).closest('div').remove(); })
      .fadeTo(0); 
```

# c - 结构对类型大小的贡献

> ID：1020481
> 
> 赞同：8
> 
> 时间：2009-06-19T23:35:28.893
> 
> 标签：c, struct, overhead

我想知道为什么以下两种类型

```
struct {
    double re[2];
}; 
```

和

```
double re[2]; 
```

在 C 中有相同的大小吗？struct 不会增加一点大小开销吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-19T23:37:55.720

不，它只是将所有元素组合成一个更高级别的元素，其大小只是单个元素的大小相加（加上一些填充，取决于对齐规则，但这超出了这个问题的范围）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-19T23:37:58.777

不是如果它可以帮助它 - 不。C 避免像瘟疫一样的开销。特别是，它避免了在这种情况下的开销。

如果您使用不同的结构，您可能会看到不同之处：

```
struct space_filled
{
    char       part0;
    double     part1;
}; 
```

如果您的机器需要`double`在 8 字节边界上对齐（并且`sizeof(double) == 8`，这是正常的，但标准没有强制要求），那么您会发现该结构占用 16 字节。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-19T23:38:59.213

不，结构不必添加任何东西。与 Java 或 .NET 中的类（和结构）具有许多其他职责不同，在 C 和 C++ 中，它们只是用于保存许多数据成员的容器。在 C++ 中，如果存在虚函数调用，它们可能必须存储一个 vtable 来解析虚函数调用，但一般来说，不，结构本身没有开销。

一个例外是：

```
typedef struct {} empty;
assert(sizeof(empty) > 0); 
```

空结构的大小*不会*为零。一个结构必须有*一些*非零大小，因为每个对象都必须有一个唯一的地址。（否则您将无法创建这些结构的数组）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-19T23:38:34.610

不。 Struct 不会增加任何大小，也不会在编译的 C 中产生任何开销。

它是一个语法层，需要编译器进行额外的工作，但在运行时没有开销。

C 是一种极其“赤裸”的语言，这意味着除非需要，否则什么都没有。所以问问自己，“结构需要什么开销？”，你不会找到任何开销。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T23:38:35.423

不，它没有。

这是结构的优点之一（为什么它们在老式 TCP/IP 编程中如此有用）。

这是表示内存/缓冲区布局的好方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T23:38:40.023

没有C中的结构类型只是顺序布局内存中的成员

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T23:45:56.343

有时，请参阅：[http ://en.wikipedia.org/wiki/Sizeof](http://en.wikipedia.org/wiki/Sizeof)

# http - 网站（Google 和/或您）应该如何对待 Accept-Language 标头？

> ID：1020494
> 
> 赞同：16
> 
> 时间：2009-06-19T23:39:18.930
> 
> 标签：http, localization

很长一段时间以来，我一直对 Google 在以下案例中的行为不满意，并且在意外地注意到[80 多个其他人](https://stackoverflow.com/questions/1011167/what-are-common-ui-misconceptions-and-annoyances/1011225#1011225)也有同样的感觉（并且 20 多个人赞成 Google 错误报告的想法）之后，我认为它很有用挖掘 SO 在 HTTP 协议和网络文化方面的智慧。

每次我去不同的国家并`google.com`从我的笔记本电脑访问或安装新的浏览器时，都会出现这种行为。在包括越南在内的许多国家/地区，google 会自动重定向到本地化版本（例如[google.com.vn](http://google.com.vn)），我实际上无法阅读该版本，因此我扫描它以拼命尝试找到*Google.com 的英文*链接。

第一次发生这种情况时，我很困惑，花了一些时间找出我的请求标头可能有什么问题；正如我所料，我`Accept-Language`的总是`en-US`或类似的东西`en-US,ru;q=0.5`。使用不同 IP 进行的进一步测试证实，即使您已登录，它们也可以进行 IP 地理定位。后来我了解到有一个语言查询`?hl=...`，但仍然如此。

所以，我的问题是：你认为这是网络文化方面的合理和预期行为吗？其他网站也这样做吗？**如果你要设计一个多语言网站，你会如何处理一个来自`.vn`IP 但会`en-US`语言的人？**

我想IP地理定位有不同的方法：

*   **contra**：我认为这是不礼貌的：我明确地告诉你我想要什么，给我别的东西有什么好处？

*   **亲**：可能是一个人刚刚安装了默认语言包的浏览器，对`Accept-*`标题一无所知，但仍然希望看到网站的本地化版本。

*   **对比**：然而，非技术人员可以通过安装语言包轻松更改接受语言。事实上，如果你去下载 Firefox，你很可能会以你想要的语言下载一个，并带有符合你意愿的接受语言标题。

请注意，我阅读了1999 年的[HTTP 1.1 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4)[`Accept-Language`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4)，但它们似乎忽略了应该真正考虑多少的问题。

我相信这个问题属于 SO 作为网络应用程序设计问题。而且我仍在考虑提交正式的错误报告（如果我是正确的，这种行为远非网络标准）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-20T03:47:10.070

我认为这里确实存在两个不同的问题。语言和国家。他们绝对不是一回事。HTTP 规范明确将 Accept-Language 请求标头字段定义为*语言*说明符，而不是国家/地区说明符。

例如：en-US 是指一种特定的语言（主要在美国使用的英语版本），en-GB 是指另一种语言（主要是在英国使用的英语版本）。这实际上与您目前在世界上的哪个位置无关，它只是定义了您在查看网站时最能接受的语言。这**应该**得到尊重，因为即使是新手用户也应该有一个使用他们的语言的浏览器，默认情况下会发送正确的请求头字段。

但这不是网站传统上使用它的方式。像另一张海报一样，我注意到网站将语言与国家等同起来，并根据该国家独特的**政治**限制/自由/公司在那里的产品来定制他们的网站，不一定针对**语言**。给出的示例是一家不在特定国家/地区销售特定产品但在其他国家/地区销售的公司。

在为不同国家/地区展示哪些产品的情况下，对 IP 地址进行地理定位比根据语言做出决定要好，但它仍然不是完美的。如果我暂时在另一个国家/地区但想订购一些东西并将其交付回家怎么办？如果我的 IP 地址不能反映我的实际位置，它不完美怎么办？

是的，大多数人大部分时间都可以正常工作。但是你到底为什么要让人们很难以他们要求的语言获得网站？这只是糟糕的UI设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-20T00:01:10.323

虽然我理解甚至分享你的挫败感，但有一些正当的理由这样做。

许多公司都有针对每个特定国家/地区量身定制的网站。例如，因为他们不会向每个国家/地区销售所有产品，或者因为特定国家/地区的法律在他们的网站上规定了某些特定义务（禁止的产品系列、添加的法律通知或其他...） .

因此，他们将为您提供适合您所在国家/地区的版本，因为这应该是最有用的（如果我目前不在 Z 国，X 公司在 Z 国销售产品 Y 并不重要） .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T23:43:11.950

谷歌很聪明。我想他们会做他们所做的事情，因为对于*大多数*情况下，如果您在越南，您很可能想要`.vn`-我们是技术人员，因此我们对接受语言等都了如指掌，但绝大多数人不知道。

话虽如此，我认为他们至少可以对接受语言标题有礼貌的一件事是显示某种通知（有点像本网站上显示的横幅），上面写着“用英语寻找 Google ？点击这里”如果标题表明他们想要英语 - 虽然这可能不适用于谷歌（因为他们不这样做），但如果我正在制作一个多语言网站，我当然会考虑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T23:43:58.093

我敢打赌，与生活在一个国家并且不会说/读母语的人相比，使用没有正确利用此 HTTP 标头值的软件的人更多。这可以解释谷歌的行为。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-04T10:23:10.613

我分享你的沮丧。我对很多网站感到失望。大多数人都进行 IP 地理定位，但显然对浏览器文化设置一无所知。不用说，用户位置是关于用户喜欢哪种语言和文化的不可靠信息源。尤其是在民族和文化高度混合的全球化时代。

> 请注意，我从 1999 年开始阅读 HTTP 1.1 规范，但它们似乎忽略了应该真正考虑多少接受语言的问题。

现代浏览器积极支持此设置。没有充分的理由不考虑它。如果请求中不存在标头，请进行地理定位，否则尊重用户文化设置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-06T13:37:40.727

我来自拉脱维亚，我更喜欢英语。Firefox 默认发送 en-US，IE 发送 lv-LV（即使是英文版），因为 Windows 区域设置。所以accept-header是不可靠的。

恕我直言，最好的方法是同时进行地理位置和接受语言检查，

如果区域和语言匹配 => 如果不匹配则自动重定向 => 提供最佳猜测并给用户一个选择（也许屏幕的右上角是语言切换的最佳位置，因为它或多或少是 UI 标准）+记住在 cookie 中的选择

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-20T04:30:18.473

我猜在非英语国家有很大比例的人使用报告接受英语语言的浏览器（也许是因为他们使用盗版英语版本，谁知道呢）。

他们中的大多数，除了在英语编程网站上发声的少数人:) 之外，都希望看到用自己的语言显示的网站，而普通人并不关心 HTTP 规范。这将使 Accept-language 标头基本上无用，这是现实世界！= 程序员幻想世界的完美示例。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-07-07T12:20:46.697

我同意谷歌行为不端。我怀疑这是结构过度优化的结果。如果您将服务器放置在靠近用户的位置，并且您的目标是获得极快的结果，那么您最好在每个本地服务器集群之外以一种语言提供单一的搜索结果缓存。

这意味着当您的 IP 进入时，与其说是 IP 地理位置，不如说是哪个服务器集群首先响应了您的请求。在越南，离您最近的集群已经过优化，可以提供越南语页面。

我确信这是可以解决的，但如果该优化的设计使他们难以修复，我不会感到惊讶。

# visual-c++ - 如何使用 Visual C++ 查看代码背后的程序集？

> ID：1020498
> 
> 赞同：130
> 
> 时间：2009-06-19T23:40:50.283
> 
> 标签：visual-c++, assembly

我正在阅读另一个关于两行代码效率的问题，OP 说他查看了代码后面的程序集，两行在程序集中是相同的。题外话，如何查看程序编译时创建的汇编代码。

我正在使用 Microsoft 的 Visual C++，但我也想知道是否可以查看用 Visual Basic 编写的代码背后的程序集。

那么，如何查看用 C++ 和 Visual Basic 等高级语言编写的程序背后的汇编代码？

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2009-06-19T23:47:44.827

有几种方法：

1.  在 Visual Studio（以及 Eclipse）中调试 C++ 时，您通常可以看到汇编代码。为此，在 Visual Studio 中在有问题的代码上放置一个断点，当调试器点击它时，单击并找到“Go To Assembly”（或按 CTRL+ALT+D）

2.  第二种方法是在编译时生成汇编列表。为此，请转到项目设置 -> C/C++ -> 输出文件 -> ASM 列表位置并填写文件名。还要选择“Assembly Output”到“Assembly With Source Code”。

3.  编译程序并使用任何第三方调试器。为此，您可以使用 OllyDbg 或 WinDbg。您也可以使用 IDA（交互式反汇编程序）。但这是做这件事的核心方式。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-06-20T01:41:44.377

为 cl 编译器指定 /FA 开关。根据开关的值，要么只集成汇编代码，要么集成高级代码和汇编代码。文件名获得 .asm 文件扩展名。以下是支持的值：

* * *

*   /FA 汇编代码；.asm
*   /FAc 机器和汇编代码；.鳕鱼
*   /FAs 源代码和汇编代码；.asm
*   /FAcs 机器、源代码和汇编代码；.鳕鱼

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-06-20T08:57:58.593

附加说明：Debug 汇编器输出和 Release 1 之间存在很大差异。第一个很好地了解编译器如何从 C++ 生成汇编代码。第二个很好地了解编译器如何优化各种 C++ 结构。在这种情况下，一些 C++ 到 asm 的转换并不明显。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-06-19T23:47:06.233

最简单的方法是启动调试器并检查*反汇编窗口*。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-02-09T20:33:45.103

[由于http://gcc.godbolt.org/](http://gcc.godbolt.org/)为 ARM、x86 和 x86-64提供了**CL 19 RC**（针对 Windows 调用约定），此答案的早期版本（rextester.com 的“hack”）大多是多余的，与该站点上的 gcc、clang 和 icc 不同）。

Godbolt 编译器资源管理器旨在很好地格式化编译器 asm 输出，消除指令的“噪音”，因此我强烈建议使用它来查看 asm 以获取带有 args 并返回值的简单函数（所以它们不会是优化了）。

有一段时间，CL 在[http://gcc.beta.godbolt.org/](http://gcc.beta.godbolt.org/)上可用，但不是主站点，但现在两者都可用。

* * *

要从[http://rextester.com/l/cpp_online_compiler_visual](http://rextester.com/l/cpp_online_compiler_visual)在线编译器获取 MSVC asm 输出： 添加`/FAs`到命令行选项。让您的程序找到自己的路径并计算出路径`.asm`并将其转储。或者在`.exe`.

例如[http://rextester.com/OKI40941](http://rextester.com/OKI40941)

```
#include <string>
#include <boost/filesystem.hpp>
#include <Windows.h>

using namespace std;

static string my_exe(void){
    char buf[MAX_PATH];
    DWORD tmp = GetModuleFileNameA( NULL, // self
                                  buf, MAX_PATH);
    return buf;
}

int main() {
    string dircmd = "dir ";
    boost::filesystem::path p( my_exe() );
    //boost::filesystem::path dir = p.parent_path();

    // transform c:\foo\bar\1234\a.exe 
    // into      c:\foo\bar\1234\1234.asm
    p.remove_filename();
    system ( (dircmd + p.string()).c_str() );

    auto subdir = p.end();      // pointing at one-past the end
    subdir--;                   // pointing at the last directory name
    p /= *subdir;               // append the last dir name as a filename
    p.replace_extension(".asm");
    system ( (string("type ") + p.string()).c_str() );
//    std::cout << "Hello, world!\n";
}

... code of functions you want to see the asm for goes here ... 
```

`type`是 DOS 版本[`cat`](http://man7.org/linux/man-pages/man1/cat.1.html)。我不想包含更多代码，这会使找到我想查看 asm 的函数变得更加困难。（尽管使用 std::string 和 boost 与这些目标背道而驰！一些 C 风格的字符串操作会对它正在处理的字符串做出更多假设（并通过使用大缓冲区忽略最大长度安全/分配`GetModuleFileNameA`）总机器码要少得多。）

IDK 为什么，但`cout << p.string() << endl`只显示基本名称（即文件名，没有目录），即使打印它的长度显示它不仅仅是裸名。（Ubuntu 15.10 上的 Chromium48）。`cout`在 中的某个点或程序的标准输出和网络浏览器之间可能存在一些反斜杠转义处理。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-19T23:42:18.690

在 Visual C++ 中，Output Files 下的项目选项我相信有一个用于输出带有源代码的 ASM 列表的选项。因此，您将在同一个文件中看到 C/C++ 源代码和生成的 ASM。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-02-11T23:41:14.487

对于 MSVC，您可以使用链接器。

link.exe /dump /linenumbers /disasm /out:foo.dis foo.dll

foo.pdb 需要可用于获取符号

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-20T00:12:07.867

[Red Gate 的 .NET Reflector](http://www.red-gate.com/products/reflector/)是一个非常棒的工具，它帮助了我很多次。除了轻松向您展示 MSIL 之外，此实用程序的优点是您可以分析许多第三方 DLL，并让 Reflector 负责将 MSIL 转换为 C# 和 VB。

我不保证代码会像源代码一样清晰，但你应该不会有太多麻烦。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-01-29T12:57:03.843

如果您正在谈论调试以查看汇编代码，最简单的方法是Debug->Windows->Disassembly（或Alt-8）。这将让您进入一个被调用的函数并留在反汇编中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-06T13:49:03.010

使用 Visual Studio 6.0

单击菜单项“项目”

点击“设置”

选择选项卡标题 C/C++

将“类别”更改为“列出文件”

在“列出文件类型”下，将组合框从“无列表”更改为“使用机器代码组装”

汇编源代码文件将作为 .cod 文件出现在“Release”文件夹中

# c# - 在 .NET (C#) 中，如何从子 WinForm 引用一个 WinForm 中的变量？

> ID：1020506
> 
> 赞同：0
> 
> 时间：2009-06-19T23:44:49.310
> 
> 标签：c#, winforms

给定 WinForm1 中类的公共实例化，我尝试打开 WinForm2 并引出 DB parms 进行查询，我希望使用该查询的结果来填充 WinForm1 中的类实例。但是，我无法弄清楚如何从 WinForm2 访问 WinForm1 中的类实例。

WinForm1 中的类实例被编码为私有成员/公共属性：

```
private theClass _classInstance;
public theClass ClassInstance {get; set;} 
```

我将 WinForm2 称为模态表单。

```
WinForm2 wf2 = new WinForm2();
wf2.ShowDialog(this); 
```

有没有办法在 wf2 中引用 ClassInstance （修改其值）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T23:45:56.420

您可以在构造函数中传递对父窗体的引用，或者将其作为属性传递给子窗体，或者将引用保存在`static`字段中。

```
class WinForm2 : Form {
     WinForm1 parentForm;
     public WinForm2(WinForm1 parentForm) {
         this.parentForm = parentForm;
         // ....
     }

     // Use `parentForm.ClassInstance` here.
}

WinForm2 wf2 = new WinForm2(this);
wf2.ShowDialog(this); 
```

顺便说一句，当您声明一个像您指定的那样的*自动属性*时，您不应该手动创建支持字段。编译器会为您处理这些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T23:49:07.193

您可以在 WinForm2 上创建一个在实例化时接受 WinForm1 的构造函数。

```
public partial class WinForm2 : Form
{
    public WinForm2()
    {
        InitializeComponent();
    }

    Form parentForm
    internal WinForm2(Form parent)
        : this()
    {
        parentForm = parent
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T23:53:15.017

在 WinForm2 中（已改进以避免 Mehrdad 指出的可能的运行时故障）：

```
WinForm1 form1 = this.Owner as WinForm1;
if (form1 != null) {
    theClass classInstance = form1.ClassInstance;
    // ...
} 
```

Owner 属性返回传递给的表单`ShowDialog(IWin32Window window)`

# java - 如何使用 Java 编写简单的游戏

> ID：1020509
> 
> 赞同：2
> 
> 时间：2009-06-19T23:45:23.600
> 
> 标签：java

如果我想创建 Jeopardy 或 Wheel of Fortune 类型（电视/棋盘游戏类型）桌面游戏，那么在 Java 中学习如何做到这一点的最佳方法是什么？我并不是要创建像 Quake 或 Spore 这样复杂的东西，而是要简单一些数量级的东西。

我想我需要渲染一个游戏板/设置、简单的效果和声音。为此推荐了哪些 Java 工具和库？

或者，如果 Python、Ruby 或其他一些环境更适合这种类型的游戏开发，请推荐。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T23:52:33.583

对于 Java，我强烈推荐David Brackeen 的《用[Java 开发游戏》一书。](https://rads.stackoverflow.com/amzn/click/com/1592730051)这是一本*非常棒*的书，它教你一切，从简单的基于瓷砖的游戏到复杂的脚本第一人称射击游戏。

然而，Python 也非常适合使用[Pygame](http://www.pygame.org/news.html)的简单游戏。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-20T00:08:37.653

查看[jmonkeyengine](http://www.jmonkeyengine.com)。它有一个很大的社区，有很多教程，而且你可以非常快速地创建小项目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T00:49:19.930

我认为[Processing](http://www.processing.org)对你来说是一个不错的选择。
处理带有许多简化多媒体应用程序开发的类。（2D 和 3D 图形、声音……）。
它还带有一个集成的开发环境。
语法受 Java 启发，但经过简化。IIRC 它还允许部署为小程序或独立程序 - 因此您的用户不需要 Java 之外的任何东西。 [维基百科](http://en.wikipedia.org/wiki/Processing_(programming_language))有一个很好的介绍。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T00:34:52.703

我和一个朋友几乎完成了一个用 Java 编写的游戏，这是我们使用的：

图形：

*   从 Java2D 开始，但速度太慢，所以我们转向[LWJGL](http://www.lwjgl.org/)，并使用网上的示例编写了一个简单的 OpenGL 2D 渲染器。然而，在项目进行到大约四分之三的时候，我们发现已经存在[Slick2D](http://slick.cokeandcode.com/index.php)和[PulpCore](http://www.interactivepulp.com/pulpcore/)等引擎。

音乐：

*   在我们发现如果我们通过 JLayer（也来自 JavaZoom）使用 MP3 需要支付版税后，最终选择了[JavaZoom的 Vorbis SPI 和 JOrbis 用于 Ogg Vorbis 音乐。](http://www.javazoom.net/index.shtml)他们的库是 LGPL，因此您可以将它们链接到您的项目中，而无需发布游戏的源代码。
*   还使用 BasicPlayer (by JavaZoom) 播放音乐。

声音：

*   对于音效，我们使用 WAV 文件和普通的 Java Sound。Java Sound 是一个非常糟糕的 API。

杂项：

*   我们将 JDOM 用于我们的 XML 配置文件。这是一个非常好的用于 XML 的库，除了它有点旧（没有泛型）。

至于其他一切，我们只是使用了 Java 标准库。有关编写游戏循环的信息（这可能是最令人困惑的部分），请查看有关它们的[讨论](http://dewitters.koonsolo.com/gameloop.html)。

如果这是您的第一个游戏，我建议您从 PulpCore 或 Slick2D 之类的框架开始。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T01:08:02.853

在 Sun Java App Store 启动并运行之前，Flash 确实是创建分发基本游戏的流行机制。

# batch-file - 微软批处理文件如何工作？

> ID：1020514
> 
> 赞同：1
> 
> 时间：2009-06-19T23:47:32.080
> 
> 标签：batch-file

当你制作一个微软批处理文件时，即：保存

```
@echo off
:loop
echo HI!
goto loop 
```

如`hiloop.bat`，代码是如何工作的？最初我认为它就像 C++ 之类的任何其他代码一样工作，但后来我在某处读到批处理文件直接在操作系统上运行，或者类似的东西使它非常高效，所以

microsoft .bat 文件如何工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T23:51:47.313

它完全被解释为尽可能慢。一个程序（命令行处理器）一次解释每一行，弄清楚它想做什么，做它，然后检查下一行或者去它被告知去的地方。

但是，由于批处理文件可以调用 COM dll（本质上是已编译的程序）的帮助，因此在这些文件中执行的任何操作都非常有效。并且有成千上万个具有大量功能的 dll，例如数据库访问、使用界面组件，以及构建许多困难但常规的东西所需的大多数东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T23:58:07.223

以 .bat 结尾的批处理文件由 command.com 解释并在 MS-DOS 仿真下运行。

以 .cmd 结尾的批处理文件由 cmd.exe 解释并作为 Windows 控制台应用程序运行。

您可以使用“开始”、“运行”，然后键入 command.com 或 cmd.exe 以交互方式启动命令解释器。它会提示您输入命令，并在您键入后执行每一行。批处理文件基本上只是提前指定命令，这样您就不必键入它们。批处理文件没有经过预处理或编译，因此效率提升很小或没有。

有些功能只能在批处理文件中使用，例如 goto 命令，它允许您创建循环和分支来控制批处理文件中的执行流程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T23:52:47.920

批处理文件由 shell 以解释的方式执行（在 Windows 中，这是`cmd.exe`）。shell 从顶部开始读取文件的每一行，并将该行作为命令执行，就像您在命令提示符中键入它一样。

有一些例外，例如`goto`命令，如果您在命令提示符下键入它没有意义，但在批处理文件中执行时会这样做。当看到`goto`命令时，shell 会回到文件的开头，依次读取每一行，直到找到`goto`. 然后它从那里开始执行。

上面的方法是*解释*的而不是*编译*的，所以它的执行效率比 C++ 之类的编译语言低得多。我永远不会称批处理文件“非常高效”。也许“非常高效” *。*

# project-server - Project Web Access 中的项目之间的链接

> ID：1020516
> 
> 赞同：0
> 
> 时间：2009-06-19T23:48:16.713
> 
> 标签：project-server, project-web-access

有谁知道“项目之间的链接”功能是否适用于 Project Web Access 中加载的项目？

当我加载对话框时，浏览按钮被禁用。

[替代文字 http://img13.imageshack.us/img13/7493/croppercapture9q.jpg](http://img13.imageshack.us/img13/7493/croppercapture9q.jpg)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-20T16:17:43.903

我不确定您所说的“在 Project Web Access 中加载的项目”是什么意思。但是，您当然可以在 Project Server 中存储的项目之间链接任务。为此，请打开包含要链接的任务的项目，然后[按照这些说明](http://office.microsoft.com/en-us/project/HP452952071033.aspx)进行操作。

# python - 浏览器自动化：Python + Firefox 使用 PyXPCOM

> ID：1020524
> 
> 赞同：5
> 
> 时间：2009-06-19T23:50:57.473
> 
> 标签：python, firefox, automation

我已经尝试过[Pamie](http://pamie.sourceforge.net/)一个用于 Internet Explorer 的浏览器自动化库。它使用 COM 连接 IE，非常简洁：

```
import PAM30
ie = PAM30.PAMIE("http://user-agent-string.info/")
ie.clickButton("Analyze my UA") 
```

现在我想在 Firefox 上使用具有类似灵活性的[PyXPCOM做同样的事情。](https://developer.mozilla.org/en/pyxpcom)我怎样才能做到这一点？你能提供示例代码吗？

**更新：请只使用 pyxpcom**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-20T19:42:04.847

我已经将[webdriver](http://pypi.python.org/pypi/webdriver/0.5)与 Firefox 一起使用。我对此非常满意。

至于代码示例，[这](http://code.google.com/p/webdriver/wiki/PythonBindings)将使您入门。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-29T09:17:20.840

我对 PyXPCOM 的理解是，它旨在让您创建和访问 XPCOM 组件，而不是控制现有的组件。根据原作者 Mark Hammond 的说法，您可能根本无法使用 PyXPCOM 做到这一点：

> [这根本不是 XPCOM 想要做的。我不确定 Mozilla/Firefox 现在是否拥有或正在开发 COM 或任何其他“自动化”机制。](http://mail.python.org/pipermail/python-win32/2004-October/002569.html "马克·哈蒙德，2004")

和：

> [如果通过“自动化”，您的意思是“通过 xpcom 通过远程进程控制 Mozilla”，那么据我所知，这是不可能的](http://aspn.activestate.com/ASPN/Mail/Message/pyxpcom/3506917 "马克·哈蒙德，2007")

相反，您可能想看看之前推荐的 Webdriver 项目[Windmill](http://www.getwindmill.com/ "风车")或[MozMill](http://code.google.com/p/mozmill/ "莫兹米尔")，它们都支持通过 Python 自动化 Firefox/Gecko/XULRunner。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T19:39:35.150

如果您正在测试一个 web 应用程序并想编写 Python 来完成它，请查看[Selenium RC](http://seleniumhq.org/projects/remote-control/)，以便您可以为所有浏览器使用相同的 API。

# shell - Useradd using crypt password generation

> ID：1020534
> 
> 赞同：18
> 
> 时间：2009-06-19T23:57:27.223
> 
> 标签：shell, ftp, passwd

I am working on what I thought was a very simple script to dynamically create an FTP user using 'useradd' There are several parts of this process I am unfamiliar with, and an entire day's research has not gotten me too far. Here is what I have:

```
password="pass"
pass=$(perl -e 'print crypt($ARGV[0], "wtf")' $password)
useradd -d HOME_DIR -s /bin/bash -g GROUP -p $pass -f -1 testing 
```

Notes

1.  HOME_DIR and GROUP are placeholders
2.  I am not having issues with the home/base_dir (-d, -b) or group (-g) functionality of 'useradd'

Topics:

1.  Why are my password generation efforts not working?
2.  is /bin/bash the correct shell to use for a purely FTP user, or would I use /bin/false or a different shell?
3.  By default, useradd disables an account until they provide their own password, how do I bypass this?
4.  I do not want to use the passwd utility as it cripples my ability to automagically generate FTP accounts, I found a solution to this [here](https://stackoverflow.com/questions/714915/using-the-passwd-command-from-within-a-shell-script), but I do not understand the solution

Let me know if I am going about this all wrong, or if what I am trying to do is not possible or if I am misinformed about anything I have stated herein. Thank you for any help you can provide. :D

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-20T17:04:40.977

Regarding password generation:

> ### [32.3 Encrypting Passwords](http://www.gnu.org/s/libc/manual/html_node/crypt.html)
> 
> *   Function: char * **crypt** (*const char *key, const char *salt*)
>     
>     
>     
>     The `crypt` function takes a password, *key*, as a string, and a *salt* character array which is described below, and returns a printable ASCII string which starts with another salt. It is believed that, given the output of the function, the best way to find a *key* that will produce that output is to guess values of *key* until the original value of *key* is found.
>     
>     
>     
>     The *salt* parameter does two things. Firstly, it selects which algorithm is used, the MD5-based one or the DES-based one. Secondly, it makes life harder for someone trying to guess passwords against a file containing many passwords; without a *salt*, an intruder can make a guess, run `crypt` on it once, and compare the result with all the passwords. With a *salt*, the intruder must run `crypt` once for each different salt.
>     
>     
>     
>     For the MD5-based algorithm, the *salt* should consist of the string `$1$`, followed by up to 8 characters, terminated by either another `$` or the end of the string. The result of crypt will be the *salt*, followed by a `$` if the salt didn't end with one, followed by 22 characters from the alphabet `./0-9A-Za-z`, up to 34 characters total. Every character in the *key* is significant.
>     
>     
>     
>     For the DES-based algorithm, the *salt* should consist of two characters from the alphabet `./0-9A-Za-z`, and the result of `crypt` will be those two characters followed by 11 more from the same alphabet, 13 in total. Only the first 8 characters in the *key* are significant.
>     
>     
>     
>     The MD5-based algorithm has no limit on the useful length of the password used, and is slightly more secure. It is therefore preferred over the DES-based algorithm.
>     
>     
>     
>     When the user enters their password for the first time, the salt should be set to a new string which is reasonably random. To verify a password against the result of a previous call to crypt, pass the result of the previous call as the salt.

Depending on your system, there may also be Blowfish or SHA-2 family `crypt`s as well, and it's possible that the traditional DES may be disabled for security. PAM can add its own complications in here too.

```
     ID       |    Method
  -------------------------------
     1        |  MD5 (Linux, BSD)
     2a       |  Blowfish (OpenBSD)
     md5      |  Sun MD5
     5        |  SHA-256 (Linux, since glibc 2.7)
     6        |  SHA-512 (Linux, since glibc 2.7)

```

That being said, the

```
root# useradd -d / -g users -p $(perl -e'print crypt("foo", "aa")') -M -N foo
user$ su - foo
Password: foo
foo$ ^D
root# userdel foo

```

works just fine on my system.

* * *

Regarding the shell:

`/sbin/nologin` is traditional for login-disabled users. You'll have to double-check your FTP daemon's configuration to see if that excludes them from FTP access.

* * *

Regarding the disabled account:

As seen above, works for me, as expected if given a working password.

* * *

About the other solution:

What don't you understand about the alternate solution? It seems very clear to me.

Just pipe "`username:password`" into "`chpasswd`".

* * *

If you want FTP-only users, I would recommend using a FTP daemon that supports virtual users like [glftpd](http://www.glftpd.dk/), [Pure-FTPd](http://www.pureftpd.org/), [ProFTPD](http://www.proftpd.org/), [vsftpd](http://vsftpd.beasts.org/), ... actually it seems that all the common ones do. This way, an FTP account does not require a real system account.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-24T13:25:57.413

If you want to create "FTP only" users, you should look at [rssh](http://pizzashack.org/rssh/) Install rssh for your distro, and set the shell for the "FTP only" user to "/usr/bin/rssh"

Works very well

# apache-flex - 有没有办法导出 DisplayObject 的矢量数据？

> ID：1020536
> 
> 赞同：1
> 
> 时间：2009-06-19T23:57:49.097
> 
> 标签：apache-flex, flash, actionscript-3, vector, displayobject

Flex 可以将显示对象导出为位图，如下所示：

```
var bitmapDataBuffer:BitmapData = new BitmapData ( displayObject.width, displayObject.height, false);            
bitmapDataBuffer.draw ( displayObject, displayObject.transform.matrix); 
```

有没有办法将显示对象导出为矢量图形而不是位图数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-23T20:20:51.393

对象上的[`copyFrom()`](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/display/Graphics.html#copyFrom())功能`Graphics`可能是您需要的。它是在 Flash Player 10 中添加的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-28T19:44:03.787

您可以使用 svgeditor-as3 库，但它使用自己的抽屉引擎，但功能非常强大，并且可以导出为 SVG 格式。

您可以在此处找到更多信息： [http ://code.google.com/p/svgeditor-as3/](http://code.google.com/p/svgeditor-as3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-29T22:16:32.653

简而言之，不，但您可以尝试转换为位图，然后对位图进行矢量化（类似于[行进正方形](http://en.wikipedia.org/wiki/Marching_squares)算法）

如果您在 AS 中绘制它，您可以跟踪您的绘制，可能通过扩展 Graphics & Sprite 或 Shape 以使用新类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T00:22:49.653

我将从这个错误中猜测它目前是不可能的：

[http://bugs.adobe.com/jira/browse/FP-605](http://bugs.adobe.com/jira/browse/FP-605)

# programming-languages - 你使用什么过程来学习一门新的编程语言？

> ID：1020540
> 
> 赞同：4
> 
> 时间：2009-06-20T00:00:16.313
> 
> 标签：programming-languages, methodology

这个问题是针对经验丰富的程序员的。在学习一门新的语言时，您是否有一套遵循的流程？

我希望我有一个可以遵循的有效方法或待办事项清单，以使学习过程更加简化。

你喜欢独自学习还是和朋友一起学习？有什么地方可以轻松获得新语言的语法吗？您是否制作了一种特定类型的备忘单，您可以在其中快速写下控制结构和重要的关键字？

你有什么特别的东西要记住吗？

你确定要学习什么样的图书馆？你怎么知道你已经学到了一些东西，在什么时候你觉得你好像知道这门语言？

每当我学习一门新语言时，我大部分时间都在翻阅书籍，其中一半是为初学者准备的，而从不为有经验的开发人员准备的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-20T00:05:30.970

就我个人而言，我发现我需要一个实质性的项目来用一种新的有趣的语言来实现。您可以阅读一本书以熟悉语法，并接触到有趣的功能，但没有什么能让您像项目一样用新语言思考。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-20T00:09:21.600

我不打算仅仅学习一门新语言。我找到了一个需要（或非常适合）新语言的项目并开始编码。

资源取决于语言，但无论是在线教程还是一本好的“学习语言”书都非常有帮助。我不会试图记住任何东西，只是保持文档关闭并搜索我需要编写的每段代码的解决方案。算法在语言之间变化不大，所以大多数时候只是查找我需要的特定结构的语法。

另外，我可能永远不会知道关于语言的一切。我只是不断地查阅有关我需要的东西的文档，最终我不再需要查找大多数东西了。然而，即使是多年来我每天都在使用的语言，有时我仍然需要查找一些东西，因为我以前从未使用过它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-20T00:28:36.303

这是我通常做的：

*   阅读以熟悉新的语言语法
*   查找我感兴趣的现有开源项目
*   将其移植到新语言
*   根据需要重复

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-20T00:24:14.143

我通常从一些基本程序开始。通常是我正在阅读的书中的样本，然后稍微修改它们以使其更复杂并修整粗糙的边缘。

之后，我前往[Project Euler](http://projecteuler.net/)并开始解决问题。这是熟悉新语言和基本结构的好方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-20T00:24:23.693

这是一个疯狂的冲刺。

首先，我必须确保我知道如何以“旧”方式做事，这意味着我习惯于使用其他语言的方式。

但是我不想陷入（例如）像编写 C 代码一样编写 Python 代码的陷阱，所以我阅读了新语言为我提供的所有更熟悉的语言所没有的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-20T00:02:54.983

我阅读了一本很好的手册，并将其与我已经知道的语言进行了比较。所以我只是了解它们之间的差异。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-20T00:07:01.277

学习一门新语言的一种非常流行的方法是为自己创建一个简单的项目并用新的目标语言实现它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-20T00:07:32.930

我会创建一些我以前已经做过的东西，这样我就可以专注于语言本身，而不是项目的设计或主题。
我还会花一些时间寻找（这个地方是一个很好的开端；-）并阅读一本关于该语言的好书。

剩下的就是**练习练习练习**（就像外面的一切一样，不是这样）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-20T00:09:56.200

我会阅读一些关于语言大概念的常见问题解答/书籍。

然后我会尝试在我已经知道的语言之间进行比较，以避免在语言 X 中应用语言 Y 中使用的概念。每种语言作为完成工作的方式，即使它们看起来相似，也不应该混合它们乍一看。

这将是第一步。

在更长的基础上，我会关注论坛或 SO 上专门讨论这种语言的部分。这些天我会阅读许多线程的答案，以便掌握高级概念、技巧和最常用的库。这也有助于我注意到我何时开始流利地使用该语言：当您开始能够用特定语言回答许多随机问题时，这意味着您已经非常擅长它了。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-20T00:19:15.217

编程的基础只需要很少的结构——一个好的程序员将能够编写出色的代码，只需要可用语言功能的一小部分。

一本书通常是学习一门新语言的基础知识并获得概述的好方法，这样您就知道该语言的哪些领域可以在您以后需要它们时为您提供帮助，但是最好的方法是编写程序来做这些事情你需要做的，并在你去的时候学习你需要知道的东西。

这样做的好处是，当你想做新的事情时，你知道去哪里找，而且你做得很好，但你不会费心去学习大量你永远不会真正使用的垃圾。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-07-16T08:10:31.280

我假设您学习了一种新的支持 OOP 的高级编程语言。此类语言的示例包括：Java、Typescript、Perl、C#、C++ 等。您也是一位经验丰富的程序员，因此您已经了解其他一些面向对象的语言。

> 我希望我有一个可以遵循的有效方法或待办事项清单，以使学习过程更加简化。

您应该创建一个涵盖以下主题的项目。

### 句法

*   评论
*   命名空间
*   陈述
    *   `if else`
    *   循环
    *   `switch case`
*   函数和类
*   `include`// `import`_`use`

特定类：

*   静止的
*   常量/最终
*   覆盖方法
*   创建接口并实现
*   继承
*   嵌套类

### 数据结构

*   大批
*   收藏：
    *   列表
    *   地图、队列、堆栈
    *   对它们的操作：
        *   删除
        *   插入
        *   搜索
        *   迭代
*   字符串

您可以通过多种方式操作**字符串：**

*   代替
*   匹配
*   加入
*   分裂

### 运营商

赋值运算符`=`有时很棘手。您必须检查它是创建浅拷贝还是深拷贝。

效果如何`==`？也许有另一种选择`obj.equals(other)`？

串联：`s1 . s2`或`s1 + s2`？

你能重载运算符吗？

### 编程技巧

*   异常处理
*   拉姆达斯
*   与用户交互 ( `read`, `write`)
*   单元测试

什么是简单类型，如`int`, `bool`, `char`？它们是不变的吗？如果这是弱类型语言，标量、数组和哈希表之间可能存在差异。

职能。

参数是值传递还是引用传递？

### 各种各样的

*   正则表达式
*   线程
*   数据格式：
    *   JSON
    *   XML
*   文件和流
*   HTTP 方法
*   日期和时间

    您应该熟悉流行的库`Math`，如`algorithm`.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-20T00:49:46.887

我通常安装运行时。然后我从编译器或解释器的命令行运行一些常用命令。我在网上寻找论坛以了解其他人对此的看法。然后我研究如何在 java 中使用外部参数，例如 psvm(String[] args)。我想总结一下，由于我在 solaris 中的系统管理员背景，我总是对命令行上的语言功能感兴趣。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-07-16T08:36:29.710

如果您没有机会加入一个项目并学习它并从头开始应用它。您可以从开放的在线课程中获得帮助。例如，“Edx.org”就是一个很棒的平台。有很多关于计算机科学和软件开发的课程。即 [这里](https://courses.edx.org/courses/course-v1:PennX+SD2x+2T2017/info)是数据结构和软件设计的课程。

# java - JPA 配置到底是什么？

> ID：1020545
> 
> 赞同：0
> 
> 时间：2009-06-20T00:02:40.070
> 
> 标签：java, hibernate, jpa, ant, hibernate-envers

我要疯了，试图让一个简单的[Envers](http://www.jboss.org/files/envers/docs/index.html)示例工作。我被困在了`org.hibernate.tool.ant.EnversHibernateToolTask`——看起来我终于得到了我需要的所有 jar 文件，但现在我收到了错误消息

```
[hibernatetool] Persistence unit not found: 'ConsolePU'.

BUILD FAILED
C:\deka\proj\java\test-database\build.xml:61: Persistence unit not found: 'ConsolePU'. 
```

据我所知，持久性单元与 JPA`persistence.xml`文件相关联。但我没有使用persistence.xml 文件；我正在使用 hibernate.cfg.xml - 但 envers 示例`<jpaconfiguration>`在 ant 任务中有一个：

```
<hibernatetool destdir=".">
        <classpath>
             <fileset dir="src/">
                  <include name="**/*.hbm.xml"/>
            </fileset>

            <path location="${buildDir}" />
        </classpath>
    <jpaconfiguration persistenceunit="ConsolePU" />
    <hbm2ddl
        drop="false"
        create="true"
        export="false"
        outputfilename="versioning-ddl.sql"
        delimiter=";"
        format="true"/>
    </hibernatetool> 
```

有什么可以替换它以使其与 hibernate.cfg.xml 文件一起使用吗？似乎有关于如何让所有这些东西正常工作的零文档。

**编辑：**好的，所以主要问题是我不了解 hibernatetool 选项以及什么适合我的应用程序。幸运的是，我确实找到了[Hibernate ant 文档。](https://www.redhatrenewals.com/docs/en-US/JBoss_Developer_Studio/en/hibernatetools/html/ant.html)谢谢。现在我有一个新问题：我正在使用注释，但我还为属性设置设置了一个 hibernate.cfg.xml。该`hibernatetool`任务只能让我运行其中一个`<configuration />`或`<annotationconfiguration />`两个都不运行，甚至`<configuration />`无法工作，因为我已经有注释在做事。如何将我的属性设置从 hibernate.cfg.xml 文件迁移到我的注释？

**编辑：**呃，我没有意识到你只是这样做：

```
<annotationconfiguration configurationfile="...filename..." /> 
```

根据[hibernatetool 任务文档。](https://www.redhatrenewals.com/docs/en-US/JBoss_Developer_Studio/en/hibernatetools/html/ant.html#d0e3018)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-20T01:50:02.067

将 替换为`<jpaconfiguration />`标签[`<configuration />`](http://docs.jboss.org/tools/nightly/trunk/en/hibernatetools/html_single/index.html#d0e4247)，如 Hibernate Tools 文档中所述：

```
<configuration
    configurationfile="hibernate.cfg.xml"
    propertyfile="hibernate.properties"
    entityresolver="EntityResolver classname"
    namingstrategy="NamingStrategy classname"> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-20T05:49:31.803

只是为了给你高水平的先见之明。JPA 是 SUN 提供的标准持久性 API。
您可以使用任何持久性框架，如 Hibernate、TopLink、JDO 等作为 JPA 的持久性提供程序。

所以只是为了让事情清楚

您的代码 -----> JPA -----> 持久性提供程序（休眠）。

使用 JPA 将是一个好习惯，因为它是标准库。

因此，您的持久性提供程序信息应该只有 JPA 知道，而不是您的代码特定的 XML。

这就是您的 persistence.xml 的样子

```
<persistence version="1.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">
<persistence-unit name="QuarkFrameworkPU" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
</persistence-unit> 
```

你的应用程序上下文看起来像（依赖于 JPA，没有提到 Hibernate）

```
 <bean id="dataSource"
    class="org.springframework.jdbc.datasource.DriverManagerDataSource"
    p:driverClassName="com.mysql.jdbc.Driver" p:url="${db.url}" />

<!-- ADD PERSISTENCE SUPPORT HERE (jpa,etc) -->

<bean id="entityManagerFactory"
    class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="persistenceUnitName" value="QuarkFrameworkPU" />
    <property name="dataSource" ref="dataSource" />
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
            <property name="showSql" value="true" />
        </bean>
    </property>
</bean>

<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory" />
    <property name="dataSource" ref="dataSource" />
</bean> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T01:39:44.133

您需要从头开始：[Sun 的 JPA 教程](http://java.sun.com/javaee/5/docs/tutorial/doc/bnbpz.html)。

[这](http://www.netbeans.org/kb/articles/hibernate-javaee.html)也可能有帮助。

您需要创建 persistence.xml 并将其放在项目的 META-INF 目录中。

Hibernate 是 JPA 的一种具体实现，但还有其他实现（例如，JDO）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T20:18:08.067

您需要注解配置而不是 jpaconfiguration。

# jquery - 如何使用 JQuery 通过 ruby on rails 操作方法从数据库加载内容？

> ID：1020554
> 
> 赞同：1
> 
> 时间：2009-06-20T00:09:10.977
> 
> 标签：jquery, ruby-on-rails, ajax

我有一个页面需要从数据库和可能的其他来源中提取内容。

这就是我构建我的 ruby​​ on rails 应用程序的方式。

/Index - 这包含三个不同的部分，需要加载三种不同类型的内容。每个都需要不同的时间才能返回，因此我想在播放每个 div 以填充数据时显示加载消息。

要加载数据，理想情况下我想在我的控制器上调用一个 Ruby 方法，然后渲染一个部分。

我已经进行了搜索，但我看不到如何加载页面索引，然后将操作方法​​中的数据作为单独的操作加载。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-28T20:07:45.717

如果您使用的是更新版本的 Rails，并且希望尽可能以不显眼的方式执行此操作，您可以在控制器中使用 :respond_to 选项，如下所示：

```
class MyController < ApplicationController

  def first_method
     respond_to do |format|
        format.html # this handles normal requests asking for html
        format.js # this handles requests asking for javascript to be sent instead
      end
  end

end 
```

如果您正在响应点击，您会在页面上执行类似触发查询的操作

```
$("a.element_you_click_to_trigger").click(function(e) {
  e.preventDefault(); // make sure clicking doesn't trigger unneeded event bubbling
  $.ajax({url: "/controller/first_method", type: "POST", dataType: "script"}); // send a request and tell the server that you want javascript back
} 
```

就像您在该控制器的视图文件夹中有一个 index.html.erb 文件一样，您的`first_method.js.erb`文件旁边的相关视图文件夹中也会有一个类似的`index.html.erb`文件：

```
views
  controller
    index.html.erb
    first_method.js.erb 
```

这将返回在客户端执行的 javascript，但它会在服务器端构建，因此您可以包含 rails ERB 片段，因此您可以执行以下操作：

```
$('#loading_placeholder_element').html('<%= escape_javascript(render(:partial => "create")) %>');

// do some other stuff you fancy in the page

// then make the next call once the other stuff is over (you may need to add this as a call back on an animation):
$.ajax({url: "/controller/second_method", type: "POST", dataType: "script"}); 
```

然后，您将对 fsmf 突出显示的其他每个较长的方法再次重复相同的过程。

几个月前，当我学习这个[Railscast on jQuery](http://railscasts.com/episodes/136-jquery)时，我发现这个Railscast 非常有用，我真的推荐它。

希望这可以帮助 ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T00:17:30.227

你需要为此使用ajax。

[http://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

我不知道如何在 Rails 上使用 ruby​​ 或 ruby​​。但我想这个概念是一样的。

一个例子：

```
$.post("yourAjaxTarget.html",{ //html as an example
    attribute1: "blabla",
    attribute2: 1234
      }, function(data){
         //do something
      }, "json"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T12:49:35.660

假设您安装了[jRails 插件](http://ennerchi.com/projects/jrails)。

```
class MyController < ApplicationController

  def index
    # your main action
  end

  def long_section
    # this method should accept XHR requests
    # and render the HTML view
    # long_section.html.erb
    render :layout => false # or partial
  end

  def very_long_section
    # this method should accept XHR requests
    # and render the HTML view
    # very_long_section.html.erb
    render :layout => false # or partial
  end

end 
```

在您的 index.html.erb 视图中。

```
<h1>Index</h1>

<div id="index">First section here.</div>
<div id="second">Second section here.</div>
<div id="third">Third section here.</div>

<%= remote_function(:action => "long_section", :update => "second") %>
<%= remote_function(:action => "very_long_section", :update => "third") %> 
```

# c# - 使用基类和方法重写来编写更整洁的代码

> ID：1020562
> 
> 赞同：1
> 
> 时间：2009-06-20T00:12:05.260
> 
> 标签：c#, oop

我听说过如何结合基类和方法覆盖来消除代码重用/编写更整洁的代码。

是否有可用的示例说明如何做到这一点（在 C# 中）？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-20T00:26:12.033

基本上，您从您创建的一组类中提取出通用功能，并将该功能放入基类中。然后，当每个类从基类继承时，它们就会接收到该功能（或者可以选择覆盖它并提供自己的实现）。提供功能的代码保留在基类中的一个位置，而不是跨类集。

[这是一个很好的讨论](http://www.blackwasp.co.uk/Inheritance.aspx)，以及多态性是如何适应的。关于这个主题有很多[好书。](http://www.amazon.com/s/ref=nb_ss_gw?url=search-alias%3Daps&field-keywords=object+oriented+programming+c%23)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T00:43:41.843

我认为了解多态性的一个好方法是查看 Bob Martin 的[OOD 的 SOLID 原则，](http://www.butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)并研究设计模式及其使用多态性来为常见问题提供解决方案。我为以后推荐[Head First Design Patterns](http://www.amzn.com/0596007124)。

# android - AndroidManifest.xml 包属性没有命名空间

> ID：1020564
> 
> 赞同：5
> 
> 时间：2009-06-20T00:12:09.193
> 
> 标签：android, xml

来自 Rick Rogers、John Lombardo、Zigurd Mednieks 和 Blake Meike 的 O'Reilly 书籍“Android 应用程序开发”，第 44 页：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.microjobsinc.mjandroid" android:versionCode="1"
    android:versionName="1.0"> 
```

上面的 XML 代码具有该`package`属性。但是，在 XML 的其余部分中，其余属性都具有名称空间。

为什么所有属性都有一个命名空间除了`package`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T23:16:45.943

我认为这可能是因为 package 属性是应用程序的完整 Java 包名称，因此 Java 概念不是特定于 Android 的。虽然它确实很不寻常，但它是根据[http://d.android.com/guide/topics/manifest/manifest-element.html的正确方法](http://d.android.com/guide/topics/manifest/manifest-element.html)

# javascript - （Ruby，Rails，Javascript）禁用Javascript时重定向/呈现不同的页面......？

> ID：1020565
> 
> 赞同：0
> 
> 时间：2009-06-20T00:13:52.950
> 
> 标签：javascript, ruby-on-rails, redirect, render

我在使用 Rails、Javascript 和重定向时遇到了严重问题。基本上，如果禁用 JS，我有重定向到不同页面的“简单”问题。如果启用了 JS，那么我会立即内联添加一个新项目——这就像一个魅力。但是，如果 JS 被禁用，我想重定向到不同控制器的 NEW 页面。基本上模型设置是这样的：

```
Site -> Buildings -> Controllers (not to be confused with Rails "controllers") 
```

我有一个“SiteManagerController”，它使用 JS 来管理整个事情。基本上我有一个场景，我正在尝试执行以下操作：

1) 如果启用了 JS，我想添加内联项 2) 如果禁用了 JS，我希望渲染 ":controller => building, :action => new"

我的“link_to_remote”很简单。正如我所说，它适用于 JS。我的rails控制器代码如下：

def add_building @building = Building.new @building.name = "Untitled" @building.site_id = params[:id] @building.save respond_to do |format| format.html {redirect_to :controller => "buildings", :action => "new"} format.js end end

这不起作用。值得一提的是，在查看页面源代码时，没有迹象表明启用 JS 和禁用 JS 有什么不同。所有链接看起来都一样——即 Ajaxy。

我知道这不应该是一个如此复杂的问题，但我很困惑。

最好的。

PS 请不要更改这篇文章的标题。;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-20T01:06:18.833

我相信解决方案在于“link_to_remote”而不是任何特定的控制器。以下似乎有效：

```
 <div><%=link_to_remote "NEW BUILDING", {:url => {:action => "add_building", :id => site.id}},
            {:href => url_for(:controller => "buildings",:action => "new")}%></div> 
```

如果你们有更好的建议，一定要发帖。再次感谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T01:10:04.707

您是否尝试过编写表单以使其重定向到另一个页面，然后在页面加载时触发一些 js 并用您的 ajax-y js 覆盖它？这样，如果禁用了 js，页面将按预期重定向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T02:24:28.787

提到的 link_to_remote 解决方案可能会起作用，但如果您正在寻找一种不引人注目的方式来做到这一点，您可以使用一些 javascript (jQuery)，如下所示：

在您的 .html.erb 文件中：

```
<%=link_to "New Building", new_building_path, :id => 'new_building_link' %> 
```

在一个 javascript 文件中：

```
$(document).load(function() {
  $("#new_building_link").click(function() {
    $.ajax({
      type:     "POST",  # or whatever http method you need
      url:      "/buildings/add_building",
      dataType: "script"
    });
    return false;
  });
}); 
```

然后返回一些 JS，这些 JS 将更新您要更改的页面区域。

我确信使用 Prototype（rails 的默认 JS 库）也有类似的方法，但我不知道 Prototype。

另请注意，这使用了 restful 路由（new_building_path 而不是指定控制器和操作）。这是现在的首选方法；您只需将“map.resources :buildings”添加到 routes.rb。有几个关于宁静路线的 Railscasts，如果你有 9 美元可以放弃，一个 Peepcode。

作为提到的评论之一，您可以使用以下方法缩小您的建筑创建代码： `Building.create({:name => "Untitled", :site_id => params[:id]})`

# c# - 无法在 C# 中读取在 Word 中打开的 XML 文件

> ID：1020567
> 
> 赞同：1
> 
> 时间：2009-06-20T00:15:42.930
> 
> 标签：c#, xml

目前我有一个读取 XML 文件的 C# 应用程序。但是如果这个 XML 文件是用 word 打开的，然后我的应用程序读取了同一个 XML 文件，我会得到一个 IO 异常。我需要做的就是读取文件。这是一个小代码片段；

```
public Object Load()
{
  try
  {
    using (FileStream fs = new FileStream(
       filePath,
       FileMode.Open,
       FileAccess.Read,
       FileShare.ReadWrite)) // Also tried, FileShare.Read and gets the same exception
    {
       return ((FooObject) new XmlSerializer(typeof(FooObject))
                .Deserialize(fs)) as Object;
    }
  }
  catch (Exception ex)
  {
    LogException(ex);
    return null;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T00:19:12.143

Word 肯定会锁定文件以进行写入，这将阻止您的 FileStream 打开。您正在请求读写访问，这将失败。

不过，我相信您可以打开它进行阅读-只需将您的行更改为：

```
using (FileStream fs = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read)) 
```

请注意 FileShare.Read 与 FileShare.ReadWrite。我不相信 word 会打开文件以进行独占访问 - 但它确实会锁定写入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T00:19:36.150

如果 word 以独占方式打开文件，您将无能为力，我认为就是这种情况。

捕获异常并通知您的用户他可能需要结束 Word 以使您的应用程序正常工作。

**编辑**

Word 不会以独占方式打开文件 - 确保打开文件以阅读 onky - 查看其他评论者的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T01:18:29.713

我基于[MSDN Docs](http://msdn.microsoft.com/en-us/library/dsh84875.aspx) for XmlSerializer.Deserialize() 创建了一个快速的 WinForms 应用程序。使用与您相同的 FileStream 参数，我打开文件没有问题，即使它已经在 Word 中打开。您是否认为“filePath”的值可能不正确，即尝试将以下内容添加到 Object_Load()：

```
if (!File.Exists(filePath))
{
    throw new FileNotFoundException("File does not exist", filePath);
} 
```

# ruby - 如何在Ruby中将字符串转换为小写或大写

> ID：1020568
> 
> 赞同：1180
> 
> 时间：2009-06-20T00:16:00.743
> 
> 标签：ruby, string, uppercase, lowercase

如何在 Ruby 中获取字符串并将其转换为小写或大写？

* * *

## 回答 #1

> 赞同：1697
> 
> 时间：2009-06-20T00:16:55.487

Ruby 有一些方法可以改变字符串的大小写。要转换为小写，请使用`downcase`：

```
"hello James!".downcase    #=> "hello james!" 
```

同样，将`upcase`每个字母`capitalize`大写，字符串的第一个字母大写，其余字母小写：

```
"hello James!".upcase      #=> "HELLO JAMES!"
"hello James!".capitalize  #=> "Hello james!"
"hello James!".titleize    #=> "Hello James!" (Rails/ActiveSupport only) 
```

如果你想修改一个字符串，你可以在这些方法中添加一个感叹号：

```
string = "hello James!"
string.downcase!
string   #=> "hello james!" 
```

有关详细信息，请参阅[字符串的文档](http://www.ruby-doc.org/core/String.html)。

* * *

## 回答 #2

> 赞同：127
> 
> 时间：2009-06-20T09:27:57.017

您可以通过打开 irb 并运行来找出字符串上可用的所有方法：

```
"MyString".methods.sort 
```

特别是对于字符串可用的方法列表：

```
"MyString".own_methods.sort 
```

我用它来发现关于我可能不知道存在的对象的新的和有趣的事情。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2013-04-19T05:46:31.580

就像@endeR 提到的那样，如果国际化是一个问题，那么 unicode_utils gem 就绰绰有余了。

```
$ gem install unicode_utils
$ irb
> require 'unicode_utils'
=> true
> UnicodeUtils.downcase("FEN BİLİMLERİ", :tr)
=> "fen bilimleri" 
```

* * *

Ruby 2.4 中的字符串操作现在对 unicode 敏感。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-06-20T00:16:52.787

ruby`downcase`方法返回一个字符串，其大写字母替换为小写字母。

```
"string".downcase 
```

[https://ruby-doc.org/core-2.1.0/String.html#method-i-downcase](https://ruby-doc.org/core-2.1.0/String.html#method-i-downcase)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-06-20T09:10:17.147

...大写是：

```
"Awesome String".upcase
=> "AWESOME STRING" 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2014-08-01T23:44:24.117

Rails Active Support gem 提供了`upcase`, `downcase`, `swapcase`, `capitalize`, 等带有国际化支持的方法：

```
gem install activesupport
irb -ractive_support/core_ext/string
"STRING  ÁÂÃÀÇÉÊÍÓÔÕÚ".mb_chars.downcase.to_s
 => "string  áâãàçéêíóôõú"
"string  áâãàçéêíóôõú".mb_chars.upcase.to_s
=> "STRING  ÁÂÃÀÇÉÊÍÓÔÕÚ" 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-05-29T11:26:13.693

.swapcase方法将字符串中的大写**字母**转换为小写字母，将小写字母转换为大写字母。

```
'TESTING'.swapcase #=> testing
'testing'.swapcase #=> TESTING 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-01-29T12:18:06.567

您可以找到类似的字符串方法`"strings".methods` 您可以将字符串定义为`upcase`, `downcase`, `titleize`。例如，

```
"hii".downcase
"hii".titleize
"hii".upcase 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-09-18T14:57:42.983

从 Ruby 2.4 开始，有一个内置的[完整的 Unicode 大小写映射](https://github.com/ruby/ruby/blob/v2_4_0_preview3/string.c#L6083-L6131)。资料来源：[https](https://stackoverflow.com/a/38016153/888294) ://stackoverflow.com/a/38016153/888294 。有关详细信息，请参阅 Ruby 2.4.0 文档：[https ://ruby-doc.org/core-2.4.0/String.html#method-i-downcase](https://ruby-doc.org/core-2.4.0/String.html#method-i-downcase)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-10-23T20:20:11.953

不会对每个人都有效，但这只是为我节省了很多时间。我刚刚遇到了 CSV 返回“TRUE 或“FALSE”的问题，所以我只添加了 VALUE.to_s.downcase == “true”，如果值为“TRUE”，则返回布尔值 true，如果值为“FALSE”，则返回 false "，但仍适用于布尔值 true 和 false。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-08-03T08:29:23.277

结合`try`方法，支持`nil`价值：

```
'string'.try(:upcase)
'string'.try(:capitalize)
'string'.try(:titleize) 
```

# javascript - 哪些 JavaScript 库具有事件委托？

> ID：1020579
> 
> 赞同：5
> 
> 时间：2009-06-20T00:19:48.333
> 
> 标签：javascript, event-delegation

我想尝试一个新的 JavaScript 库。使用（并且喜欢）j [Query 1.3 的“实时”事件](http://docs.jquery.com/Events/live#typefn)后，我更喜欢下一个库，我尝试将事件委托内置到事件系统中。[Wikipedia 的 JS 库比较](http://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks)在这里很重要。

看起来[MooTools 正在 2.0 中获得它](http://www.clientcide.com/code-releases/clientcide-202-event-delegation-updated-for-mootools-20-compatibility/)。其他人呢？

我正在制作这个社区维基。请帮我填写清单。

> 原型：没有
> 
> jQuery：从 1.3 开始
> 
> MooTools：从 2.0 开始
> 
> ExtJS：是的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T16:08:53.713

事件委托比您想象的要容易。

如果我找到一个没有自动事件委托的库，我只需向它添加一个层。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-26T13:18:48.023

我建议调查一下[Prototype](http://www.prototypejs.org/)。它在 SO 上与 jQuery 一样频繁地列出，我将它用作我所有项目的 JS 库。

我不相信它内置了委托，但它是一个功能齐全的库，具有根据需要添加委托的所有必要功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-26T21:36:57.103

如果您喜欢使用 Jquery，但想尝试不同的东西，我会使用 mootools，指向 Aarons 事件委托插件的链接以及他关于如何使用原始插件的教程应该可以满足您的所有需求。有很多关于在一天结束时哪个更好的讨论，这正是您喜欢的。

Mootools 非常棒，并且有一些很好的插件，你还应该看看 David Walsh，他做了很多 mootools 开发和一些 Jquery。他发布了一些有趣的东西。 [http://davidwalsh.name](http://davidwalsh.name)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-26T23:08:49.040

事件委托只是将事件处理程序挂在 DOM 树的更上方。所有框架都可以/应该能够做到这一点。处理程序应该能够拾取任何冒泡的事件。该事件包含触发它的元素，并且处理程序可以从中执行任何操作。

Prototype 没有像 jQuery 那样工作的库原生的任何事件委托糖`$.fn.live`，但是构建一个捕获事件并处理其目标元素的函数相当简单。

```
document.observe('click',function(event){alert(event.element().inspect())}) 
```

您可以使用它轻松地克隆 jQuery 的 live 版本（我并不是说它会表现良好或其他任何东西）。

```
live = function(selector,callback){
  document.observe("click",function(e){
    var element = e.element()
    if (!element.match(selector))
      element = element.ancestors().find(function(elem){return elem.match(selector)});
    else
      element = null
    if (element)
      callback.apply(element)
  })
} 
```

你可以这样称呼它：

```
live("div",function(){this.setStyle({color:'blue'})}) 
```

我想我要说的是事件委托已经内置在 javascript 中。图书馆只是添加糖。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-28T11:31:37.197

我一直相信[Ext Js 。](http://extjs.com/forum/showthread.php?t=27417)

# c# - 如何以编程方式确定我的处理器类型？

> ID：1020581
> 
> 赞同：6
> 
> 时间：2009-06-19T16:54:20.360
> 
> 标签：c#, java, vbscript, processor

如何以编程方式确定我的机器是 x86、x64 还是 IA64？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T17:02:37.773

在 Windows 系统上，您可以获得环境变量 PROCESSOR_ARCHITECTURE。这是一篇 MSDN 文章，解释了可以返回的值。

> ```
> PROCESSOR_ARCHITECTURE=AMD64
> PROCESSOR_ARCHITECTURE=IA64
> PROCESSOR_ARCHITECTURE=x86 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T07:12:16.120

VBScript，检查 PROCESSOR_ARCHITECTURE 环境变量：

```
Set oShell = CreateObject("WScript.Shell")
Set oEnv = oShell.Environment("System")
Select Case LCase(oEnv("PROCESSOR_ARCHITECTURE"))
  Case "x86"
    ' x86
  Case "amd64"
    ' amd64
  Case "ia64"
    ' ia64
  Case Else
    ' other
End Select 
```

VBScript，使用 WMI：

```
Const PROCESSOR_ARCHITECTURE_X86  = 0
Const PROCESSOR_ARCHITECTURE_IA64 = 6
Const PROCESSOR_ARCHITECTURE_X64  = 9

strComputer = "."

Set oWMIService = GetObject("winmgmts:" & _
    "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colProcessors = oWMIService.ExecQuery("SELECT * FROM Win32_Processor")

For Each oProcessor In colProcessors
  Select Case oProcessor.Architecture
    Case PROCESSOR_ARCHITECTURE_X86
      ' x86
    Case PROCESSOR_ARCHITECTURE_X64
      ' x64
    Case PROCESSOR_ARCHITECTURE_IA64
      ' ia64
    Case Else
      ' other
  End Select
Next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T17:04:39.640

在 C# 中：

```
using System;
using Microsoft.Win32;

  class Class1
  {
    static void Main(string[] args)
    {
      RegistryKey RegKey = Registry.LocalMachine;
      RegKey = RegKey.OpenSubKey("HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0");
      Object cpuSpeed = RegKey.GetValue("~MHz");
      Object cpuType  = RegKey.GetValue("VendorIdentifier");
      Console.WriteLine("You have a {0} running at {1} MHz.",cpuType,cpuSpeed);
    }
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T18:46:00.387

猫 /proc/cpuinfo

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T20:11:59.417

除了安装在主机上的处理器之外，通常比底层处理器更重要的是操作系统运行的模式。

检查“uname -p”（或 uname(2)）的输出

Intel 采用了 AMD 的 64 位指令扩展，因此“x86_64”的值意味着您正在运行 Intel 或 AMD 64 位处理器，否则您正在运行常规的 x86 ISA。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-19T16:57:03.163

cpu-z 是您想要的程序，它会告诉您您拥有的处理器以及它支持的扩展

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-06-20T05:12:52.300

在 Java 中你不需要知道。;)

# asp.net - 博客引擎如何创建博客文章？

> ID：1020598
> 
> 赞同：2
> 
> 时间：2009-06-20T00:27:29.817
> 
> 标签：asp.net, wordpress, blogs

我正在创建一个博客引擎作为学习练习，一个特殊的问题让我很难过。我想知道如何在 Wordpress 等博客引擎中创建博客文章？我想有两种方法可以做到这一点：

1) 创建一个名为“testPost”的新博客文章会创建一个名为 www.myblog.com/testPost.html 的新 HTML 页面。因此，对于每篇新博客文章，您都将一个新的 HTML 页面保存到服务器。这种方法似乎效率低下。一个博客可以有数百篇博客文章，这意味着您必须创建数百个 HTML 页面。我不认为我想使用这种方法。

2) 您有一个通用博客文章页面，其数据根据您尝试访问的文章呈现。例如，如果我创建了“testPostOne”，则通用博客文章页面将填充 testPostOne 的数据和 URL，如果我创建了“testPostTwo”，那么通用页面将呈现 testPostTwo 各自的内容等等。

但是使用这种方法会带来自己的问题。例如，您将如何链接到实际不存在的页面？链接到[http://www.myblog.com/testPostOne.html](http://www.myblog.com/testPostOne.html)不起作用。

这是我可以想出的两种方法来解决这个问题。我不确定是否还有其他选择。如果您知道，请随时推荐解决此问题的更好方法。

基本上，我希望能够为每篇博文创建一个格式良好的 URL，而不必在服务器上为每篇博文创建一个新的 HTML 页面。

**编辑**：我可能会补充说我正在使用 ASP.NET 来执行此操作，因此通过此框架可用的任何方法都会有所帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-20T00:31:54.347

基本思想是使用数据库。每个帖子都是数据库中的一个条目，您只需根据 URL 检索数据。例如，

www.myblog.com/posts.php?postid=1 或 www.myblog.com/posts.aspx?postid=1

然后，您可以使用 URL 重写方法以更清晰的 URL 检索相同的帖子，或者使用更好的 RESTful 方法来执行相同的任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T00:30:49.233

这是一个用 ASP.NET 2.0 编写的[开源博客引擎和一个](http://www.dotnetblogengine.net/)[用 PHP 编写的](http://chyrp.net/)（还有很多其他的）。你最好的办法是检查设计和架构，并剖析它（或类似的东西）是如何工作的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T00:30:29.297

例如，您需要在 PHP 中创建一个动态页面，该页面从数据库中读取帖子内容的数据。如果您希望页面中有漂亮的 URL，那么您需要研究类似的东西`mod_rewrite`来重写 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T00:33:09.650

如果您动态创建页面（如建议 2 中所示），当您尝试访问它时[http://www.myblog.com/testPostOne.html](http://www.myblog.com/testPostOne.html)将存在，即使它不是磁盘上的实际文件...

所以建议2可能是最好的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T00:38:40.823

就个人而言，我使用 Apache mod_rewrite。因此，当您有如下 URL 时：

`http://myblog.com/archives/my_very_first_post`,

您可以像这样制定重写规则：

```
RewriteEngine on
RewriteRule ^archives/(.*)$ myblog.php?post=$1 
```

Apache 将“my_very_first_post”解释为帖子 ID，并将其提供给处理该 ID 的 PHP 脚本。然后脚本从数据库中获取帖子并显示它。

我相信这是最常见的方法。

# assembly - 一个简单的汇编程序？

> ID：1020600
> 
> 赞同：1
> 
> 时间：2009-06-20T00:28:10.597
> 
> 标签：assembly

我最近从 MSVC++ IDE 中学习了如何使用 MASM，为了测试它是否有效，我想运行一个简短的程序。

但是，我还不知道任何程序集（我所做的是无用的：即：即使我知道`i+=1;`C++ 中的内容，但没有 . 我什么也做不了`int main()`）。

那么我在哪里可以找到一个类似于与 C++ 一起使用的 helloworld 程序的简单汇编程序？（它实际上不必显示“Hello，World！”，它只需要做一些事情，以便我可以确保我的设置有效）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T00:31:56.423

这是在线 MASM 文档： [http ://web.sau.edu/LillisKevinM/csci240/masmdocs/](http://web.sau.edu/LillisKevinM/csci240/masmdocs/)

这是关于组装的difinitive教程： [http ://webster.cs.ucr.edu/](http://webster.cs.ucr.edu/)

我认为在这两者之间，您应该能够加快速度并开始编写程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T00:39:05.893

为了让您快速入门，我建议您访问以下站点： [RADAsm](http://www.oby.ro/rad_asm/)和[WinASM](http://www.winasm.net/)。

从这些站点中，您可以找到一些示例，以及一些带有 IDE 和编译器的预打包下载。这种方式实际上很容易在早期做一些 GUI 软件，但请注意，请注意阅读有关 x86 程序集的信息。查看[wikibooks - x86 汇编器](http://en.wikibooks.org/wiki/X86_Assembly)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T04:05:22.163

您可能会发现这个站点很有趣： [使用汇编语言编写 Windows 应用程序](http://www.grc.com/smgassembly.htm)。您可以下载 The Small Is Beautiful Starter Kit，其中包含一个示例应用程序，用于在汇编中编写 Windows 程序。

# php - 这个 php 代码是否按照 OO 原则正确编写？

> ID：1020611
> 
> 赞同：1
> 
> 时间：2009-06-20T00:32:02.240
> 
> 标签：php, sql, oop

我一直在尝试了解面向对象，我认为我已经开始了解一些概念，但我不确定。如果我的思路是正确的，进行谷歌搜索来回答是相当困难的，所以我决定很快在这里问，请告诉我这个问题是否违反任何规则。

我在消息传递方面的想法是正确的吗？什么是明显的坏事？在继续学习的过程中，我应该如何思考？喜欢`getpagecontent($page, $connection);`等

Atm 我正在阅读 [Oreilly - 学习 php 和 mysql][1] 和 [Programming in an Object-Oriented Environment][2] 以及一些关于 UML 的书籍

这是代码。

## dbfunctions.php

```
<?php
class dbconnect {

    function dbconnect() {
    $this->dbhost = 'xx';
    $this->dbuser = 'xx';
    $this->dbpass = 'xx';
    $this->dbdatabase = 'xx';
    }

    function createdbconnection() {
        require_once('DB.php'); // pear

        $this->connection = DB::connect("mysql://$this->dbuser:$this->dbpass@$this->dbhost/$this->dbdatabase");

        if (DB::isError($this->connection)) {
        die("Could not connect (connection)<br>" . DB::errorMessage($this->connection));
        }
    }

    function closedbconnection(){
        $this->connection->disconnect();
    }
}

class dbinteractions {

   function dbinteractions($connection) {
            $this->connection = $connection;
        }

   function searchdb($qstring) {
    if (get_magic_quotes_gpc()) {
        $qstring = stripslashes($qstring);
    }

    $qstring = mysql_real_escape_string($qstring);

    $query = "SELECT content FROM site_content WHERE content LIKE '%$qstring%'";
    $result = $this->connection->query($query);

    if(DB::isError($result)) {
        die("Could not connect (query)<br>" . DB::errorMessage($result));
    }

    while($result_row = $result->fetchRow()) {
        echo("<h2>Resultat:</h2>");
        foreach($result_row as $out)
            echo($out . "<p>");
    }
}

    function getpagecontent($page) {
        $query = "SELECT * FROM site_content WHERE (page_id = \"" . $page . "\")";
        $result = $this->connection->query($query);;

        while($result_row = $result->fetchRow()) {
            echo "<h1>" . $result_row[0] . "</h1>"; //Echo page_id
            echo $result_row[1]; //Echo content
            echo "<h2>" . $result_row[2] . "</h2>"; //Echo timestamp
        }
    }

}
?> 
```

## 搜索.php

```
<?php
function displaysearchform()
{
    echo("<p></p>");
    if($_GET["search"] == '') { //Display search box if no search ?>

        <form method="GET" action="<?php echo(htmlentities($_SERVER['PHP_SELF'])); ?>">
            <label>
                Search: <input type="text" name="search" />
            </label>
            <input type="submit" value="Go!">
        </form>

    <?php
        return false;
    }
    else
    {
        return true;
    }
}

?> 
```

## 索引.php

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<link rel="stylesheet" href="style.css" type="text/css">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title></title>
</head>
<body>
    <div id="container">
        <div id="sidebar">
            <a href="?id=1">1</a><br>
            <a href="?id=2">2</a><br>
        </div>
        <div id="main">

            <?php
                include("dbfunctions.php");
                include("search.php");

                $dbconnect = new dbconnect();

                $dbconnect->createdbconnection();

                $dbinteractions = new dbinteractions($dbconnect->connection);

                if(!$_GET["id"] && $_GET["search"] == "") { //Check if direct site hit and no search query
                    $dbinteractions->getpagecontent("1");
                    }

                else  {
                    $page = $_GET["id"];
                    $dbinteractions->getpagecontent($page); //Get and display page content
                }

                if (displaysearchform() == true){ //If search was made don't display searchform
                    $dbinteractions->searchdb($_GET["search"]);
                }

                $dbconnect->closedbconnection(); //Close connection to db
            ?>
        </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T00:34:18.197

我不确定你所说的面向对象是什么意思，但你的代码看起来不像传统意义上的类、对象和方法的 OO 代码。当大多数人说“OO”时，他们的意思是他们的代码是由您可以调用方法的不同类型的对象构建的。

对我来说，您的代码看起来像典型的过程代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T00:57:39.350

您当然正确地使用了对象，并且正确地访问了它们。从外观上看，您的 DB 对象是一个单例，这很好。而且您正在使用“->”来访问其他对象方法和属性。

但看起来您正在实现应该是 DB 对象的一部分的功能。例如，对于我自己的数据库类，我会做这样的事情

```
$db = DBObject::getInstance(); // The DB object is a singleton

$sql = "Select * from.... etc etc";

$result = $db->query($sql); 
```

我认为应该完成您尝试做的所有事情。DB 对象应该知道如何自己连接到数据库，发出自己的错误消息并在需要时关闭连接（它可能不需要）。处理引号、斜杠和确保查询安全等内容也可以在 DB 对象中进行处理。

而且，您尝试执行的过程很容易成为一个完全属于自己的类（例如：PageRenderer）。但是在这里，您创建了许多使用其他对象的函数。

但是很难给你一个直接的答案。是的，你做得对，但你似乎做得太多了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T01:03:52.100

我认为当你真的喜欢编写 OO 时，你应该使用相互交互的对象来完成手头的任务。我没有看到任何从类实例化的对象，所以我认为这不是正确的面向对象代码。如果你问我，这是更多的程序代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T01:14:08.817

OO 只有一件事是正确的。$connection 对象。

其他一切都是程序性的。您应该从创建一个类开始，而不是“dbfunctions.php”中的所有松散函数。

另请注意，您应避免将逻辑代码与 HTML 混合。它变得难以维护。

这可能[是你能读到的关于这个主题的最好的书](https://rads.stackoverflow.com/amzn/click/com/1590593804)。

进入面向对象范式并不容易。但是当你得到它时，就像骑自行车一样。你永远不会忘记。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-20T01:26:52.880

我不能说这里真的有很多 OOP，但听起来和看起来更像是您正在尝试使用参数而不是使用全局变量来学习一种好的方法 - 您似乎已经完成了。

如果您想从此代码中改进更多，这里有一些指示

*   尝试使用一致的编码风格。例如PHP中常用的[PEAR编码标准](http://pear.php.net/manual/en/standards.php)
*   将您的数据库代码更改为封装连接对象的类。例如，您可以有一个包含方法*connect*、*search*和*close的 Database 类*
*   对您的 HTML 代码使用一些模板解决方案。您可以将 PHP 本身用作模板语言，如此[处所示](http://www.bigsmoke.us/php-templates/smarter-sans-smarty)。主要思想是将“应用程序逻辑”与“视图逻辑”分开
*   您可能还想修改`echo`用于简单返回结果的函数，并使用另一个函数（或只是模板中的代码）来输出它们。通常，您需要一个函数提供/获取数据或输出数据，而不是两者。

最后，我建议查看一些流行的 PHP 框架，因为它们通常遵循良好的 OOP 编码风格。CakePHP 应该很容易上手，但是因为它使用 PHP4，所以它并不总是很好地执行 OOP。你可以熟悉 Cake 的原理，然后转向 Symfony 或 Zend Framework 之类的东西。在我开始使用 Zend Fw 之后，我自己的编码风格变得更好了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-20T20:54:30.863

我有一个关于面向对象的 php 编程的小建议；首先阅读 php.net 中的文档，最后你应该阅读 No Starch Press 的“面向对象的 PHP”一书 -> [http://nostarch.com/oophp.htm](http://nostarch.com/oophp.htm)

此外，在您的类/函数文件顶部使用此语句，您将包含（搜索和 dbfunctions.php）

if (!defined('page')) exit('不允许直接访问脚本');

并定义使用此类的页面 - 如下面的示例：

定义（“页面”，“搜索”）；包括（“dbfunctions.php”）；包括（“search.php”）；

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-20T21:21:36.723

我喜欢保持简单和直接。这是我使用的一个类，在Jason Gilmore的《 *Beginning PHP and MySQL: From Novice to Professional 》一书中使用*

```
<?php

class SQL {

    function __construct() {

        $this->host     = "xxx";

        $this->user     = "xxx";

        $this->password  = "xxx";

        $this->database  = "xxx";

        $this->result;

        $this->querycount;

        $this->connect();

        $this->select();        

    }

    function connect() {

        $this->linkid = @ mysql_connect($this->host, $this->user, $this->password);

        if(!$this->linkid) {

            echo "--[ could not connect to sql database ]--";   exit();

        }

    }

    function select() {

        if(!@ mysql_select_db($this->database, $this->linkid)) {

            echo "--[ could not select database ]--";   exit();

        }

    }

    function escape($data) {

        return mysql_real_escape_string(trim(htmlspecialchars($data)), $this->linkid);

    }

    function query($query) {

        if( $this->result = @ mysql_query($query, $this->linkid) ) {

            $this->querycount++;

            return true;

        } else {

            echo "<b>Error:</b>" . mysql_error($this->linkid);              

            return false;

        }   

    }

    function affectedRows() {

        $count =  @ mysql_affected_rows($this->linkid);

        return $count;

    }

    function numRows() {

        $count = @ mysql_num_rows($this->result);

        return $count;

    }

    function fetchObject() {

        $row = @ mysql_fetch_object($this->result);

        return $row;

    }

    function fetchRow() {

        $row = @ mysql_fetch_row($this->result);

        return $row;

    }

    function fetchArray() {

        $row = @ mysql_fetch_array($this->result);

        return $row;

    }

    function fetchAssoc() {

        $row = @ mysql_fetch_assoc($this->result);

        return $row;

    }

    function numQueries() {

        return $this->querycount;

    }

}

?> 
```

我并不是说这是最好的方法。但它非常简单直接；也应该改为使用mysqli，但我一直很懒=p

# c# - 让图像和 bindingSource.Filter 在 DataGridView 中一起工作

> ID：1020612
> 
> 赞同：1
> 
> 时间：2009-06-20T00:32:08.717
> 
> 标签：c#, .net, user-interface, datagridview

我从序列化为 XML 字符串的集合填充 DataGridView（示例代码：*）。

我的要求是 (1) 将图像放入 DataGridView 和 (2) 设置 bindingSource.Filter 字符串并根据列中的字符串动态过滤表的能力（可能有数千个条目）。下面我奇怪的 XML 到字符串 hack 适用于过滤器，但我无法将图像反序列化到字符串/从字符串反序列化，因此我无法创建一个魔术 DataView，其中 .Filter 可以正常工作。

问题：(a) 有没有更好的方法将对象的 DataView 集合从 RAM 获取到 dataGridView 中，而不是序列化为 XML 字符串（以获取 DataView）*，但需要注意 .Filter 仍然有效*。(b) 是否有另一种方法可以在运行时（尤其是 Image 列）向 bindingSource/DataView 添加内容，从而保留 .Filter 的使用？

根据我的测试，[以这种方式做事（如何：将对象绑定到 Windows 窗体 DataGridView 控件）](http://msdn.microsoft.com/en-us/library/y0wfd4yz.aspx)使得设置 Filter 字段无法操作，即什么都不做，没有异常，没有魔法过滤，nada。

(*)

```
 // objects in each row
    [Serializable]
    public class GradorCacheFile
    {
        public Bitmap image;
        public string filename;

        // to make it serializable
        public GradorCacheFile()
        {
        }

        public GradorCacheFile(GradorCacheFile old)
        {
            this.filename = old.filename;
            this.image = old.image;
        }
    }

// snippet of class:
public List<GradorCacheFile> files = null;
void Process()
{
    GradorCacheFiles gcf = new GradorCacheFiles();
    gcf.AddRange(this.files);

    XmlSerializer xs = new XmlSerializer(typeof(GradorCacheFiles));
    StringWriter sw = new StringWriter();
    xs.Serialize(sw, gcf);
    sw.Close();

    string xml = sw.ToString();

    StringReader reader = new StringReader(xml);
    DataSet ds = new DataSet();
    ds.ReadXml(reader);
    if (ds.Tables.Count < 1)
        return;

    DataTable dt = ds.Tables[0];
    DataView dv = new DataView(dt);
    this.bindingSource = new BindingSource();
    this.bindingSource.DataSource = dv;
    this.dataGridView.DataSource = this.bindingSource;

    int rows = this.dataGridView.Rows.Count;
    if (rows == 0)
        return;
    this.dataGridView.Columns[0].HeaderText = "Image";
    this.dataGridView.Columns[1].HeaderText = "File";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T08:45:43.517

（完全重写）你甚至不需要 xml；如果您使用[ToDataTable](https://stackoverflow.com/questions/564366/generic-list-to-datatable/564373#564373)，则以下工作正常：

```
public class MyType
{
    public string Name { get; set; }
    public Image Image { get; set; }
}
...
[STAThread]
static void Main()
{
    List<MyType> list = new List<MyType>();
    list.Add(new MyType { Image=Bitmap.FromFile(image1Path), Name="Fred" });
    list.Add(new MyType { Image=Bitmap.FromFile(image2Path), Name="Barney" });

    DataTable table = list.ToDataTable();
    BindingSource bs = new BindingSource(table, "");
    bs.Filter = @"Name = 'Fred'";
    Application.Run(new Form {
        Controls = {
            new DataGridView {
                DataSource = bs,
                Dock = DockStyle.Fill}
        }
    });
} 
```

# assembly - 计算文件中的字母 - 程序集

> ID：1020613
> 
> 赞同：-2
> 
> 时间：2009-06-20T00:32:52.660
> 
> 标签：assembly

我必须为 8086 或 8088 处理器用汇编语言编写程序。给定`.txt`文件将计算其所有字母（从 A 到 Z，不区分大小写）并稍后显示在屏幕上。文件中的字母数量不能超过一个单词的大小（16 位或 65535）。

最后我在屏幕上显示这样的东西：

```
A - 00010
B - 00359
C - 00353 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-20T00:41:11.350

以下是您需要知道如何做的一些事情的列表：

*   从命令行读取文件名
*   使用操作系统服务打开文件
*   将文件的内容读入内存
*   检查文件中每个字符的值
*   为每个字母制作一个字母表和相应的计数
*   检测何时到达文件末尾
*   将文本打印到屏幕上
*   将整数转换为其字符串表示形式
*   使用成功退出代码终止并返回操作系统

# design-patterns - INTERPRETER 是反模式吗？

> ID：1020622
> 
> 赞同：10
> 
> 时间：2009-06-20T00:36:38.457
> 
> 标签：design-patterns, lisp, anti-patterns, interpreter-pattern, greenspunning

对我来说，Interpreter 模式听起来很像被称为 Greenspun 第十条规则的反模式：

> 任何足够复杂的 C 或 Fortran 程序都包含一个临时的、非正式指定的、充满错误的、缓慢的 Common Lisp 一半的实现。

也就是说，如果您需要使用解释器，您可能会创建一些缓慢、临时且指定不明确的东西。正确的解决方案是从一开始就使用正确的语言。

或者，也可以将一种众所周知的、明确指定的语言嵌入到您的应用程序中，例如 Guile（GNU 可嵌入方案）。或者使用 Haskell 作为嵌入式领域特定语言。

但我在实践中还没有看到这一点——您在构建自己的嵌入式语言方面有什么经验？这是个好主意吗？它比嵌入已经存在的语言更好吗？

（我不是特别喜欢 lisp。这很好，但 C、Haskell 和 python 以及许多其他语言也是如此。）

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-20T00:45:40.013

解释器模式中没有任何内容表明它必须是您正在解释的另一种编程语言的语法。如果您需要解析一个简单的数学表达式，那么解释器就是这样。

知道何时使用模式可以防止它成为反模式。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-20T01:09:10.450

如果被滥用，任何设计模式都是反模式。

[解释器模式](http://en.wikipedia.org/wiki/Interpreter_pattern)的良好用途：

*   软件编译器
*   SQL 评估引擎
*   图形计算器输入解析器
*   XML 解析器

这些都是解决评估语言中单词问题的程序，[无论该语言是什么](http://en.wikipedia.org/wiki/Formal_language)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-20T08:07:53.543

请记住，“解释器模式”是 OOP 中的一种特定设计模式。

它与“解释器”或它们的一般用途无关。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-20T01:56:41.993

在某些时候，一个项目可能需要一个配置系统。一开始通常只需要一些简单的东西，比如键值对，以便系统可以连接到本地数据库，或类似的东西。如果这就是所需要的，通常只需为 INI 或 CSV 的方言编写一个简单的解析器并继续前进。但是随着系统的发展和成熟，配置更加重要。这是正常且健康的，将功能和责任重构到正确的抽象层。从这里开始，开发人员甚至（喘不过气的）用户很快就会想要一种更具表现力的配置语言。甚至在任何人都没有注意到之前，该系统已经内置并使用了图灵完备的语言。

这是 Greenspunning 的基本模式。一切都经过精心设计，直到最后一点，一种临时语言被推入了真正的计算工作领域。

任何大小合适的系统都*应该*包含至少一半的 clisp。

提前知道是一大步。编写大型系统的一种非常方便的方法是选择一种很好的、​​易于破解的解释性语言并用它来编写你的系统。这恰好正是 TCL 旨在做的事情，但如今很难让任何人支持该语言的大型项目。另一方面，现在有许多其他语言可以提供所有这些好处。

这样做的好处是[活动文件模式](http://www.doc.ic.ac.uk/~np2/patterns/scripting/data-as-code.html)。简单配置的编写方式与系统可用的语言解析器兼容。由于文件是由语言解析的，因此可以轻松嵌入更复杂的逻辑。

django 的 settings.py 就是一个例子。出于某种原因，django 在猜测 django 项目的安装位置方面并不是很聪明。在配置文件中使用少量[标准 python](https://stackoverflow.com/questions/550632/favorite-django-tips-features/550644#550644)，这可以在一般情况下以可移植的方式处理，这将适合几乎所有可能的用户。尽管如此，大部分的 settings.py 文件看起来像 .ini 样式配置文件中典型的普通旧键 = 值对。

与解释器模式的关系是，这些成熟的语言可能会为某些病态用途获得*正确的模式。*一旦你知道你需要解析一些东西，就想出一个很好的理由不使用现有的语言。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-20T08:46:31.063

解释器模式并不意味着编写一个完整的通用脚本语言。如果您需要，显然使用人们已经写过好书的知名语言会更有意义（或者最重要的是，允许用户选择语言）。

解释器模式更多地是关于持久化对象图的想法，但选择人类可读和可编辑的持久化格式（例如用指向几个对象的指针`2 + 3`表示一个对象）。即使这从未作为一种“语言”暴露给客户，它仍然有助于调试、支持、现场黑客攻击等。其他常见的例子是查询语言，例如 [N]Hibernate 中的 HQL - 没有任何现有的语言可以很好地描述该抽象级别的查询。`Addition``Integer`

正如其他人所建议的那样，XML 通常用作此的基本语法（尤其是在将持久对象图设想为“配置文件”时，另请参见 Microsoft 的 XAML），但它实际上是一个次优选择。UTF-8（或类似）中的 JSON 会更干净、更容易解析、更具可读性和可编辑性，因此对于大多数应用程序来说可能更好。但是有一些很棒的轻量级解析器库，它们采用类似 BNF 的语法描述，然后可以将文本解析成类似 DOM 的可步行结构，所有这些都在运行时进行，因此编写高度特定的简洁语法是没有问题的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-06-22T16:28:11.477

你显然不是 Lisp 的“狂热者”，因为符合该描述的男孩和女孩通常可以知道 Lisp 是一种编译语言。Lisp 出现于 1958 年。1961 年的 Lisp 1 手册已经描述了编译。

口译很有用；它为我们提供了语义，而无需先编写编译器。这种语义为编译语义提供了一个参考模型：理想情况下，解释程序和编译程序做同样的事情。当我们发现他们不这样做时，我们要么解决它，要么以某种方式描述和证明这种情况。

解释可用于引导编译的 Lisp 系统，而不需要现有的 Lisp 实现，而是使用另一种语言，例如 C。解释避免了用引导语言编写 Lisp 编译器的需要。

ANSI Common Lisp 的 CLISP 实现就是一个很好的例子。要构建 CLISP，您只需要一个 C 编译器。CLISP 的 Lisp 编译器是用 Lisp 编写的。因此，当然，您没有任何东西可以运行该编译器。解决方案是使用用 C 编写的解释器来解释编译器。

在运行解释时，编译器编译大部分 Lisp 库。其结果就是 CLISP 所称的“半编译内存映像”：包含已编译例程但一些解释例程的映像。（我认为，编译器本身仍然是解释代码）。

然后使用这个半编译的映像来编译剩余的代码，从而得到完全编译的映像。

如果没有解释器，CLISP 的编译器只能通过坚持首先安装另一个 Lisp 实现来引导。（您需要 C 编译器来引导 GCC 的方式）。否则，CLISP 的编译器必须用 C 语言编写，以便使用现有的 C 编译器编译编译器，然后将其应用于 Lisp 代码进行编译，然后才能运行。

头脑正常的人都不想用 C 语言编写 Lisp 编译器，并且在 Lisp 并不普遍的世界中，需要 Lisp 实现来构建 Lisp 实现是一个很大的缺点。在 Lisp-compiler-in-C 助推模型下会发生什么，用 C 语言编写的 Lisp 编译器将是一个完全最小且可能不完整的编译器，它会发出质量差的代码，仅足以启动助推，并且是“真正的”编译器仍然是用 Lisp 编写的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-20T00:48:14.207

也许 Lisp 编译器的实现包括解释器模式的示例。

例如，我认为您不应该说“轮子”是一种反模式，即使您通常应该购买现成的轮子而不是重新发明它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-20T00:53:46.503

解释器是 JavaCC 解析器生成器背后的想法。我认为它工作正常。

Interpreter 是一种比 Singleton 更受尊敬的 GoF 模式。那是需要在岛上投票的人。也许纪念品也是如此。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-20T00:57:20.973

发明 XML 的原因之一是让我们免于编写所有 EDI 解释器。但至少范围是明确定义的，我们所有人都大致平等地（至少足够）有效地做到了。至少我仍然有足够的错觉，认为这是正确的做法。

听起来你正在尝试开始一个新的都市传奇？你天生就反对领域特定语言吗？

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-06-20T01:31:25.040

通常编译器/解释器的阶段如下所示：

1.  句法
2.  解析树
3.  AST
4.  编译或解释

在 Lisp 中，1 和 2 合并为 3。

因此，很明显，复杂的程序中可能嵌入了一种自定义语言，它是“一种临时的、非正式指定的、充满错误的、对一半 Common Lisp 的缓慢实现”。

然而，我不得不说，手写 AST 树是令人不快的，并且不是所有语言的终结，无论有多少 Lispers 声称它是。

# vb.net - 使用 Skype api 通过 vb.net 拨打电话

> ID：1020629
> 
> 赞同：-1
> 
> 时间：2009-06-20T00:39:26.407
> 
> 标签：vb.net, skype

1.  如何在我的 vb.net 应用程序中包含 Skype 库？
2.  我如何通过 vb,net 在 Skype 上拨打电话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T00:57:29.210

Skype 提供了一个可从 VB.NET 使用的 COM API。有关从 VB.NET 使用 COM 的更多信息，请参见：

[http://msdn.microsoft.com/en-us/library/x66s8zcd.aspx](http://msdn.microsoft.com/en-us/library/x66s8zcd.aspx)

Skype API 文档可以在以下位置找到：

[https://developer.skype.com/Docs/ApiDoc](https://developer.skype.com/Docs/ApiDoc)

而且，虽然不在 VB.NET 中，但[SEHE AKA Skype Event Handler Example](http://saveontelephonebills.com/modules.php?name=News&file=article&sid=2)中有一个很好的例子来说明如何使用 Skype API 。它是用 C# 编写的，但相同的原则适用于 VB.NET，只是语法略有不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-18T09:39:48.820

这是在 C# 中，但很容易[使用 Skype API转换为 VB](http://www.i-programmer.info/projects/38-windows/203-recording-skype.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-02T18:35:25.400

这是使用 vb.net 在 Skype 上拨打电话的代码，包括声明。

```
Imports SKYPE4COMLib
Public class form 1
Public WithEvents skype As New SKYPE4COMLib.Skype
Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
  'check if the skype client is running
  If Not skype.Client.IsRunning Then
        skype.Client.Start()
    End If
end sub
'use a button or other control to place a call to the test account of skype
 Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    skype.PlaceCall("echo123")
End Sub 
```

打电话给其他人只需替换 echo123，不要忘记“引号”

# django - 动态填充表单集中的字段

> ID：1020637
> 
> 赞同：3
> 
> 时间：2009-06-20T00:43:03.000
> 
> 标签：django, django-forms, inline-formset

我有两个看起来像这样的模型：

```
class RouteBase(models.Model):
    base        =   models.ForeignKey("Base")
    route       =   models.ForeignKey("Route")
    sequence    =   models.IntegerField()

class Route(models.Model):
    bases       =   models.ManyToManyField("Base", through="RouteBase", blank=True)
    description =   models.TextField(blank=True)
    #and a few other attributes omitted for brevity 
```

...然后是一个看起来像这样的模型：

```
class RouteBaseForm(ModelForm):
    base = forms.ModelChoiceField(queryset=Base.objects.all(), widget=forms.TextInput)
    sequence = forms.IntegerField(widget=forms.HiddenInput)

    class Meta:
        model = RouteBase 
```

如您所见，序列小部件是隐藏的，因为我希望该字段由 django 自动处理。我希望用户只需通过文本框输入 Base 即可。序列由文本框的顺序推断。

我已经使用此表单创建了一个表单集，用于创建/编辑路线中的所有基础：

```
RouteBaseFormset = inlineformset_factory(Route, RouteBase, form=RouteBaseForm, extra=5, ) 
```

创建此表单集时，序列字段为空。在保存表单集之前，我需要用值填充它（否则它不会验证）。我可以想到大约 4 种方法来解决这个问题

1.  在我将表单集发送到模板之前，我运行以下代码：

```
    我=1
    对于 formset.forms 中的表单：
        form.fields["sequence"].initial = i
        我 += 1

```

这工作正常，除了一个问题。当表单集被提交回视图进行保存时，使用该表单集创建的**所有**5 个额外字段都将填充一个序列值。当用户只想向路线添加 2 或 3 个碱基时，这会导致问题。验证错误弹出，因为该表单的必填字段“base”为空。我*可以*在表单集发布后运行一些代码来检查是否存在碱基，如果不存在，则删除序列，但如果我要这样做，我也可以......

2.  POST 表单集时运行一些代码，检查是否输入了 Base，如果是，则添加一个序列，如果没有，则将该字段留空。这样，当您尝试使用表单集时`.save()`，空值可确保不会将特定表单放入数据库中。唯一的问题是在我运行之前我不能对表单做任何事情，因为表单`.save(commit=False)`集没有验证。但我可以...

3.  通过复制`request.POST`变量并手动设置序列来添加序列值，但这看起来非常糟糕。

4.  我也可以`blank=True`从我的一个`RouteBase`领域中删除，但我真的不想这样做。

那么我应该在这里做什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-20T17:52:59.590

如果您从不打算让用户编辑序列字段并计划始终在后端计算其值，则可以[将其从表单中排除](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#using-a-subset-of-fields-on-the-form)，而不是将其隐藏。

然后您可以使用 commit=False 并根据需要处理您的序列字段的计算。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-06-21T15:10:36.983

```
newPOST = request.POST.copy()
i=1
for index in range(0, int(request.POST["routebase_set-TOTAL_FORMS"])-1):
    if request.POST["routebase_set-" + str(index) + "-base"]:
        newPOST["routebase_set-" + str(index) + "-sequence"] = i
        i += 1
    else:
        newPOST["routebase_set-" + str(index) + "-sequence"] = "" 
```

老实说，这似乎比任何搞砸表单验证都好。它也没有我想象的那么糟糕......

# asp.net - 类似于 ASP.NET winforms 的哲学和页面生命周期经常妨碍我

> ID：1020638
> 
> 赞同：2
> 
> 时间：2009-06-20T00:43:19.223
> 
> 标签：asp.net, asp.net-mvc, visual-studio, page-lifecycle

## MVC + 经典网络表单在同一个网站

**现在**我想知道是否可以混合 MVC 和经典网络表单（我不想重新实现我已经做过的事情，即使这会使代码不均匀......）

## 原始问题

我对 ASP.NET（以及一般的 Web 编程）的理解越深入，我就越不喜欢 ASP.NET 页面生命周期及其类似 winforms 的范例。我越来越相信，通过自己的处理程序编写或最多使用没有任何数据绑定控件的普通 .aspx 模板，我会在更短的时间内获得更好的结果。
每次我学习 ASP.NET 做某事的方式时，我都会觉得我浪费了我的时间，最终我又重新发明了轮子。

您是否熟练使用 System.Web.UI.* 控件？
您不会对页面生命周期感到困惑吗？
您不觉得在每个页面上放置一个 SQLDataSource 会产生不可维护的代码吗？

### 更新

我不敢相信我是唯一一个有这种感觉的人，现在我知道我是对的。我正在观看一些有关**MVC**的视频，它看起来与我正在寻找的完全一样。明天我将安装并尝试一下。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-20T00:47:06.143

[ASP.NET MVC](http://www.asp.net/mvc/)正是为那些有你感觉的人创建的 :)

是的，完全可以[混合使用 WebForms 和 ASP.NET MVC](http://www.packtpub.com/article/mixing-asp.net-webforms-and-asp.net-mvc)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T00:49:18.323

是的，有些人不喜欢经常被称为“泄漏”的抽象，即 WebForms。它试图将无状态浏览器请求变成类似于有状态表单应用程序的野兽，但并不总是成功且通常不优雅（大型视图状态隐藏字段、损坏的后退按钮功能、依赖 javascript 进行简单导航）。

这是微软开发其 MVC 实现的一个重要原因。它为您提供了一个“本机”Web 界面，没有抽象，同时维护一些助手（它实际上称为助手）。在 MVC 之前，也可以在 ASP.NET 上编写自己的非 Web 窗体应用程序，这只是意味着更多的工作（我个人使用我自己的基于 HTTPHandler 构建的自制系统来提供 RESTful url 和非 Web 窗体交互大约比 MVC 提供官方替代方案早一年）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T00:58:07.133

我从经典的 asp 和 php 转到 .net。一开始很难。我一直在想，我可以在经典的 asp/php 中更快地完成任务，并且我的结果会更加简洁和轻量级。

要回答您的问题：

是的（花了一段时间）

不（不知道为什么我从来没有对它感到困惑，因为很多人都是）

是的（但你不需要使用它们）

现在“回到”asp.net MVC，我觉得我可以在 webforms 中更轻松地做事。不过，我开始掌握它的窍门。这一切都来了一个完整的循环，但更好。

正如许多人指出的那样，如果您还没有尝试过，您可能会更喜欢 asp.net MVC。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T08:21:13.347

您是否熟练使用 System.Web.UI.* 控件？

> 不再。

您不会对页面生命周期感到困惑吗？

> 曾经。特别是在混入自定义/用户控件时。

您不觉得在每个页面上放置一个 SQLDataSource 会产生不可维护的代码吗？

> 当然可以，但是没有人强迫您使用 SqlDataSource。我更喜欢具有 3 层架构的 ObjectDataSource。

采用 MVC 方式有时令人失望。分页和排序等显而易见的东西需要重新发明（开源的东西通常不能满足您的所有需求）。更重要的是 - 如果您不知道自己在做什么并且没有保持良好的组织，MVC 项目很容易变得一团糟。但在专业人士手中——MVC 是核武器。

当心。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T00:51:39.517

这有点像 winforms 的东西，但...提供一些更高级别的抽象来尝试让它看起来不像你在为 web 开发。您对 Web 开发了解得越多，就越希望剥离这些抽象。如果 webforms 是一种自动传输，那么[ASP.NET MVC](http://www.asp.net/mvc/)就是一个变速杆。它剥离了很多抽象，让您可以访问正在发生的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-20T01:41:05.143

> 您不觉得在每个页面上放置一个 SQLDataSource 会产生不可维护的代码吗？

什么？你为什么不使用`SqlConnection`？

# iphone - iPhone 3.0 SDK 能否提供对蓝牙设备（耳机）的完全访问？

> ID：1020640
> 
> 赞同：6
> 
> 时间：2009-06-20T00:44:34.820
> 
> 标签：iphone, bluetooth

因此，iPhone 可以与蓝牙耳机配对并使用它来拨打电话（尽管带有 3.0 OS 的[iPod Touch](http://en.wikipedia.org/wiki/IPod_Touch)无法与耳机配对，请看图）。

但是我可以编写一个应用程序来访问配对的蓝牙设备及其功能（例如来自耳机的麦克风输入）吗？

这在[VoIP](http://en.wikipedia.org/wiki/Voice_over_IP)应用程序甚至通过可以使用语音聊天的 Wi-Fi 玩的多人游戏中非常有用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-21T08:07:30.487

如果兼容的蓝牙耳机与设备配对，如果您使用 Core Audio API，它将被透明地使用；您无需在应用程序中添加对蓝牙耳机的特定支持。

If you want to integrate specifically with Bluetooth devices, you will need to join the "Made for iPod" / "Works with iPhone" program, but that's still not going to let you talk to any arbitrary Bluetooth device. Compatible Bluetooth devices require a special Apple authentication chip, which usually means you'd need to build a custom device specifically for the iPhone/iPod (for example, [TomTom](http://en.wikipedia.org/wiki/TomTom)'s in-car navigation device).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T01:00:52.650

我想是的，但我不确定。

非常高级的信息在这里：http: [//developer.apple.com/iphone/program/sdk/](http://developer.apple.com/iphone/program/sdk/)

新框架的文档在这里，您可能需要登录 iPhone 开发程序才能查看它，我不确定：

[http://developer.apple.com/iphone/library/documentation/ExternalAccessory/Reference/ExternalAccessoryFrameworkReference/ExternalAccessoryFrameworkReference.pdf](http://developer.apple.com/iphone/library/documentation/ExternalAccessory/Reference/ExternalAccessoryFrameworkReference/ExternalAccessoryFrameworkReference.pdf)

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T00:54:39.420

不，我不这么认为。

但您仍然可以使用麦克风。如果有耳机，它将使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T03:59:03.953

硬件制造商必须为您提供一些规格以允许您使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-24T12:35:59.433

As Nathan said, if it's already paired you use Core Audio.

If you need more advanced stuff (more than audio) I guess you were thinking of using the GameKit Framework to connect to the bluetooth devices. In this case forget it, since Apple allows you to connect only to "other iPhones or iPod Touches"...

# php - 来自 2 个不同库的 php 中的函数名冲突

> ID：1020650
> 
> 赞同：1
> 
> 时间：2009-06-20T00:49:57.103
> 
> 标签：php, function

我有 2 个“库”，需要包含在同一页面上。简单的机器论坛和 Wordpress。

然而，两者都有相互冲突的功能 is_admin() 。

```
Fatal error: Cannot redeclare is_admin() (previously declared
in /home/site.com/wordpress/wp-includes/query.php:100)in /home/site.com/smf/Sources/Security.php on line 82) 
```

解决这个问题的最佳方法是什么？因为我不想将所有对一个库的调用修改为 is_admin2() 例如。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T00:56:53.830

我相信您没有太多选择，只能重命名函数，或者将所有函数包装在一个类中。这就是 PHP <= 5.* 的问题：没有命名空间，开发人员通常更喜欢编写一个充满松散函数的脚本，而不是使用面向对象的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T00:59:14.247

我会硬着头皮手动重命名较小库的每个函数调用（我猜那将是论坛之一）。祝你好运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T01:23:57.427

将函数重命名为`is_admin_wp()`和`is_admin_smf()`。然后，定义自己的`is_admin()`函数。这可能只是一个简单的包装器：

```
function is_admin() {
    // from what function is_admin was called?
    list (, $last) = debug_backtrace();
    if (strpos($last['file'], 'wordpress') >= 0) {
        $fn = 'is_admin_wp';
    } else {
        $fn = 'is_admin_smf';
    }
    $args = func_get_args();
    return call_user_func_array($fn, $args);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T01:05:13.453

一种可能是使用 PHP 5.3，它带来了对命名空间的支持。我不知道实现的细节，但它*应该*使您能够将库包装在不同的名称空间中。

不幸的是，5.3 还没有达到稳定版本。如果您不能/不想使用它，我看到的唯一不涉及重命名的选项是：创建单独的两个 PHP 脚本，在不同的解释器中启动它们，并让它们以某种方式进行通信（管道，套接字，临时文件）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T01:16:42.337

对我来说幸运的是，这是在简单机器论坛中对 is_admin 的声明中发现的评论。

```
// Grudge chickens out and puts this in for combatibility. This will be ripped out on day one for SMF 1.2 though ;) 
```

无论如何似乎都不需要它......有点讨厌，我每次升级时都必须记住删除它......

# functional-programming - 如果没有可变状态，你怎么能做任何有用的事情？

> ID：1020653
> 
> 赞同：300
> 
> 时间：2009-06-20T00:52:37.253
> 
> 标签：functional-programming, state

我最近一直在阅读很多关于函数式编程的东西，我可以理解其中的大部分内容，但我无法理解的一件事是无状态编码。在我看来，通过移除可变状态来简化编程就像通过移除仪表板来“简化”汽车：成品可能更简单，但祝它与最终用户交互好运。

几乎我能想到的每个用户应用程序都将状态作为核心概念。如果您编写文档（或 SO 帖子），则状态会随着每个新输入而改变。或者如果你玩电子游戏，有大量的状态变量，从所有角色的位置开始，他们往往会不断地四处走动。如果不跟踪值的变化，你怎么可能做任何有用的事情呢？

每次我找到讨论这个问题的东西时，它都是用真正的技术功能语言编写的，假设我没有沉重的 FP 背景。有没有人知道一种方法可以向对命令式编码有良好、扎实理解但在功能方面完全n00b的人解释这一点？

编辑：到目前为止，一堆回复似乎试图让我相信不可变值的优势。我明白那部分。这很有意义。我不明白的是如何在没有可变变量的情况下跟踪必须更改并不断更改的值。

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2009-06-20T03:20:17.080

> 或者如果你玩电子游戏，有大量的状态变量，从所有角色的位置开始，他们往往会不断地四处走动。如果不跟踪值的变化，你怎么可能做任何有用的事情呢？

如果你有兴趣，[这里](http://prog21.dadgum.com/23.html)有一系列描述 Erlang 游戏编程的文章。

你可能不会喜欢这个答案，但在你使用它之前你不会*得到*函数式程序。我可以发布代码示例并说“在这里，你没*看到*”——但如果你不理解语法和基本原理，那么你的眼睛就会呆滞。从您的角度来看，我似乎在做与命令式语言相同的事情，但只是设置了各种边界以有目的地使编程变得更加困难。我的观点是，你只是在体验[Blub 悖论](http://www.paulgraham.com/avg.html)。

起初我持怀疑态度，但几年前我跳上了函数式编程的火车并爱上了它。函数式编程的诀窍在于能够识别模式、特定的变量赋值，并将命令式状态移动到堆栈中。例如，for 循环变成递归：

```
// Imperative
let printTo x =
    for a in 1 .. x do
        printfn "%i" a

// Recursive
let printTo x =
    let rec loop a = if a <= x then printfn "%i" a; loop (a + 1)
    loop 1 
```

它不是很漂亮，但我们得到了相同的效果，没有突变。当然，只要有可能，我们喜欢完全避免循环并将其抽象掉：

```
// Preferred
let printTo x = seq { 1 .. x } |> Seq.iter (fun a -> printfn "%i" a) 
```

Seq.iter 方法将枚举集合并为每个项目调用匿名函数。非常便利 ：）

我知道，打印数字并不令人印象深刻。但是，我们可以对游戏使用相同的方法：将所有状态保存在堆栈中，并使用递归调用中的更改创建一个新对象。这样，每一帧都是游戏的无状态快照，其中每一帧只是创建一个全新的对象，其中包含需要更新的任何无状态对象的所需更改。其伪代码可能是：

```
// imperative version
pacman = new pacman(0, 0)
while true
    if key = UP then pacman.y++
    elif key = DOWN then pacman.y--
    elif key = LEFT then pacman.x--
    elif key = UP then pacman.x++
    render(pacman)

// functional version
let rec loop pacman =
    render(pacman)
    let x, y = switch(key)
        case LEFT: pacman.x - 1, pacman.y
        case RIGHT: pacman.x + 1, pacman.y
        case UP: pacman.x, pacman.y - 1
        case DOWN: pacman.x, pacman.y + 1
    loop(new pacman(x, y)) 
```

命令式和函数式版本是相同的，但函数式版本显然不使用可变状态。功能代码保持所有状态都保存在堆栈上——这种方法的好处是，如果出现问题，调试很容易，你只需要一个堆栈跟踪。

这可以扩展到游戏中任意数量的对象，因为所有对象（或相关对象的集合）都可以在它们自己的线程中渲染。

> 几乎我能想到的每个用户应用程序都将状态作为核心概念。

在函数式语言中，我们不是改变对象的状态，而是简单地返回一个带有我们想要的更改的新对象。它比听起来更有效率。例如，数据结构很容易表示为不可变的数据结构。例如，堆栈非常容易实现：

```
using System;

namespace ConsoleApplication1
{
    static class Stack
    {
        public static Stack<T> Cons<T>(T hd, Stack<T> tl) { return new Stack<T>(hd, tl); }
        public static Stack<T> Append<T>(Stack<T> x, Stack<T> y)
        {
            return x == null ? y : Cons(x.Head, Append(x.Tail, y));
        }
        public static void Iter<T>(Stack<T> x, Action<T> f) { if (x != null) { f(x.Head); Iter(x.Tail, f); } }
    }

    class Stack<T>
    {
        public readonly T Head;
        public readonly Stack<T> Tail;
        public Stack(T hd, Stack<T> tl)
        {
            this.Head = hd;
            this.Tail = tl;
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            Stack<int> x = Stack.Cons(1, Stack.Cons(2, Stack.Cons(3, Stack.Cons(4, null))));
            Stack<int> y = Stack.Cons(5, Stack.Cons(6, Stack.Cons(7, Stack.Cons(8, null))));
            Stack<int> z = Stack.Append(x, y);
            Stack.Iter(z, a => Console.WriteLine(a));
            Console.ReadKey(true);
        }
    }
} 
```

上面的代码构造了两个不可变列表，将它们附加在一起以创建一个新列表，然后附加结果。在应用程序的任何地方都没有使用可变状态。它看起来有点笨重，但这只是因为 C# 是一种冗长的语言。这是 F# 中的等效程序：

```
type 'a stack =
    | Cons of 'a * 'a stack
    | Nil

let rec append x y =
    match x with
    | Cons(hd, tl) -> Cons(hd, append tl y)
    | Nil -> y

let rec iter f = function
    | Cons(hd, tl) -> f(hd); iter f tl
    | Nil -> ()

let x = Cons(1, Cons(2, Cons(3, Cons(4, Nil))))
let y = Cons(5, Cons(6, Cons(7, Cons(8, Nil))))
let z = append x y
iter (fun a -> printfn "%i" a) z 
```

创建和操作列表不需要可变变量。几乎所有的数据结构都可以很容易地转换成它们的等效功能。[我在这里](http://en.wikibooks.org/wiki/F_Sharp_Programming/Advanced_Data_Structures)写了一个页面，它提供了堆栈、队列、左派堆、红黑树、惰性列表的不可变实现。没有一个代码片段包含任何可变状态。为了“变异”一棵树，我用我想要的新节点创建了一个全新的树——这非常有效，因为我不需要复制树中的每个节点，我可以在我的新节点中重用旧节点树。

使用一个更重要的示例，我还编写了[这个完全无状态的 SQL 解析器](http://en.wikibooks.org/wiki/F_Sharp_Programming/Lexing_and_Parsing)（或者至少*我的*代码是无状态的，我不知道底层的词法库是否是无状态的）。

无状态编程与有状态编程一样富有表现力和强大，它只需要一点练习来训练自己开始无状态思考。当然，“尽可能无状态编程，必要时有状态编程”似乎是大多数不纯函数式语言的座右铭。当函数式方法不那么干净或高效时，使用可变变量并没有什么坏处。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2009-06-20T02:00:50.300

简短的回答：你不能。

那么关于不变性有什么大惊小怪的呢？

如果您精通命令式语言，那么您就会知道“全局变量很糟糕”。为什么？因为它们在您的代码中引入（或有可能引入）一些非常难以解开的依赖关系。而且依赖不好；你希望你的代码是*模块化*的。程序的一部分尽可能少地影响其他部分。FP 将您带到模块化的圣杯：完全没有副作用*。*你只有你的 f(x) = y。把 x 放进去，把 y 拿出来。对 x 或其他任何内容都没有更改。FP 让你停止思考状态，而开始思考价值。您的所有函数都只是接收值并产生新值。

这有几个优点。

首先，没有副作用意味着程序更简单，更容易推理。不用担心引入程序的新部分会干扰和崩溃现有的工作部分。

其次，这使得程序可以简单地并行化（有效的并行化是另一回事）。

第三，有一些可能的性能优势。假设您有一个功能：

```
double x = 2 * x 
```

现在你输入 3 的值，你得到 6 的值。每次。但是你也可以在命令式中做到这一点，对吧？是的。但问题是，在命令式中，你可以做*更多*的事情。我可以：

```
int y = 2;
int double(x){ return x * y; } 
```

但我也可以

```
int y = 2;
int double(x){ return x * (y++); } 
```

命令式编译器不知道我是否会产生副作用，这使得优化变得更加困难（即双 2 不必每次都是 4）。功能性的知道我不会 - 因此，它可以在每次看到“双 2”时进行优化。

现在，即使每次创建新值对于计算机内存方面的复杂类型的值来说似乎都非常浪费，但不必如此。因为，如果你有 f(x) = y，并且 x 和 y 的值“基本相同”（例如，树只在几片叶子上有所不同），那么 x 和 y 可以共享部分内存——因为它们都不会发生变异.

所以如果这个不可变的东西这么棒，我为什么要回答没有可变状态你就不能做任何有用的事情。好吧，如果没有可变性，您的整个程序将是一个巨大的 f(x) = y 函数。程序的所有部分也是如此：只是函数，以及“纯”意义上的函数。正如我所说，这意味着*每次*f(x) = y 。因此，例如 readFile("myFile.txt") 每次都需要返回相同的字符串值。不太好用。

因此，每个 FP 都提供了*一些*改变状态的方法。“纯”函数式语言（例如 Haskell）使用诸如 monad 之类的有些吓人的概念来做到这一点，而“不纯”函数式语言（例如 ML）则直接允许这样做。

当然，函数式语言还有许多其他的优点，可以使编程更高效，例如一流的函数等。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-06-20T01:01:51.963

请注意，说函数式编程没有“状态”有点误导，可能是造成混乱的原因。它绝对没有“可变状态”，但它仍然可以有被操纵的值；它们只是不能就地更改（例如，您必须从旧值创建新值）。

这是一个严重的过度简化，但想象一下你有一种 OO 语言，其中类的所有属性只在构造函数中设置一次，所有方法都是静态函数。您仍然可以通过让方法获取包含计算所需的所有值的对象，然后返回带有结果的新对象（甚至可能是同一对象的新实例）来执行几乎任何计算。

将现有代码转换为这种范式可能“很难”，但那是因为它确实需要一种完全不同的代码思考方式。作为副作用，尽管在大多数情况下，您可以获得很多免费并行的机会。

**附录：（** *关于您对如何跟踪需要更改的值的编辑）*
它们当然会存储在不可变的数据结构中......

这不是建议的“解决方案”，但最简单的方法是看到这将始终有效，您可以将这些不可变值存储到类似结构的映射（字典/哈希表）中，以“变量名称”为键。

显然，在实际解决方案中，您会使用更理智的方法，但这确实表明，如果没有其他方法可以工作，那么最坏的情况是您可以使用通过调用树携带的这种映射来“模拟”可变状态。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-06-20T04:38:46.417

我觉得有一点点误会。纯函数式程序有状态。不同之处在于该状态的建模方式。在纯函数式编程中，状态由函数操作，这些函数接受一些状态并返回下一个状态。然后通过将状态传递给一系列纯函数来实现对状态的排序。

甚至全局可变状态也可以通过这种方式建模。例如，在 Haskell 中，程序是从 World 到 World 的函数。也就是说，你传入*整个宇宙*，程序返回一个新的宇宙。但实际上，您只需要传入程序实际感兴趣的宇宙部分。程序实际上会返回*一系列操作*，这些操作作为程序运行的操作环境的指令。

您希望看到用命令式编程来解释这一点。好的，让我们看一些用函数式语言编写的非常简单的命令式编程。

考虑这段代码：

```
int x = 1;
int y = x + 1;
x = x + y;
return x; 
```

非常标准的命令式代码。没有做任何有趣的事情，但这可以用于说明。我想你会同意这里涉及到状态。x 变量的值随时间变化。现在，让我们通过发明一种新语法来稍微改变符号：

```
let x = 1 in
let y = x + 1 in
let z = x + y in z 
```

加上括号可以更清楚地说明这意味着什么：

```
let x = 1 in (let y = x + 1 in (let z = x + y in (z))) 
```

所以你看，状态是由一系列纯表达式建模的，这些表达式绑定了以下表达式的自由变量。

你会发现这种模式可以模拟任何一种状态，甚至是 IO。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-06-20T03:04:47.783

这只是做同一件事的不同方式。

考虑一个简单的例子，例如将数字 3、5 和 10 相加。想象一下，首先通过将 3 的值加 5 来更改它，然后在该“3”上加 10，然后输出“”的当前值。 3" (18)。这看起来显然很荒谬，但本质上它是基于状态的命令式编程经常完成的方式。实际上，您可以有许多不同的“3”，它们的值为 3，但又是不同的。所有这一切似乎都很奇怪，因为我们已经根深蒂固地认为数字是不可变的，这个非常明智的想法。

现在考虑在将值设为不可变时添加 3、5 和 10。将 3 和 5 相加产生另一个值 8，然后将该值加 10 产生另一个值 18。

这些是做同样事情的等效方法。所有必要的信息都存在于这两种方法中，但形式不同。一方面，信息作为状态存在，并且存在于改变状态的规则中。另一方面，信息存在于不可变数据和功能定义中。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-07-02T01:10:25.137

以下是**编写不可变状态代码的方法**：不是将状态变化放入可变变量中，而是将其放入函数的参数中。而不是编写循环，而是编写递归函数。因此，例如这个命令式代码：

```
f_imperative(y) {
  local x;
  x := e;
  while p(x, y) do
    x := g(x, y)
  return h(x, y)
} 
```

变成这个功能代码（类似于方案的语法）：

```
(define (f-functional y) 
  (letrec (
     (f-helper (lambda (x y)
                  (if (p x y) 
                     (f-helper (g x y) y)
                     (h x y)))))
     (f-helper e y))) 
```

或者这个 Haskellish 代码

```
f_fun y = h x_final y
   where x_initial = e
         x_final   = loop x_initial
         loop x = if p x y then loop (g x y) else x 
```

至于*为什么*函数式程序员喜欢这样做（你没有问过），你的程序越多是无状态**的，就越有方法可以在没有任何中断的情况下将它们组合在一起**。无状态范式的力量不在于无状态（或纯度）*本身*，而在于它赋予您编写强大、*可重用*的函数并将它们组合起来的能力。

[您可以在 John Hughes 的论文Why Functional Programming Matters](http://www.cse.chalmers.se/~rjmh/Papers/whyfp.html)中找到包含大量示例的优秀教程。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2016-07-28T15:27:21.567

我迟到了讨论，但我想为那些在函数式编程中苦苦挣扎的人补充几点。

1.  函数式语言维护与命令式语言完全相同的状态更新，但**它们通过将更新后的状态传递给后续函数调用来实现**。这是一个非常简单的沿数轴移动的示例。您所在的州是您当前的位置。

首先是命令式（伪代码）

```
moveTo(dest, cur):
    while (cur != dest):
         if (cur < dest):
             cur += 1
         else:
             cur -= 1
    return cur 
```

现在是功能方式（在伪代码中）。我非常依赖三元运算符，因为我希望具有命令式背景的人能够真正阅读此代码。因此，如果您不经常使用三元运算符（我在命令式的日子里总是避免使用它），这就是它的工作原理。

```
predicate ? if-true-expression : if-false-expression 
```

您可以通过将新的三元表达式代替假表达式来链接三元表达式

```
predicate1 ? if-true1-expression :
predicate2 ? if-true2-expression :
else-expression 
```

因此，考虑到这一点，这是功能版本。

```
moveTo(dest, cur):
    return (
        cur == dest ? return cur :
        cur < dest ? moveTo(dest, cur + 1) : 
        moveTo(dest, cur - 1)
    ) 
```

这是一个简单的例子。如果这是在游戏世界中移动人们，则必须引入副作用，例如在屏幕上绘制对象的当前位置，并根据对象移动的速度在每次调用中引入一点延迟。但是你仍然不需要可变状态。

2.  教训是函数式语言通过调用具有不同参数的函数来“改变”状态。显然，这并没有真正改变任何变量，但这就是你获得类似效果的方式。这意味着如果你想进行函数式编程，你必须习惯于递归思考。

3.  学习递归思考并不难，但它确实需要练习和工具包。在那本“学习 Java”一书中，他们使用递归来计算阶乘的那一小部分并没有删减它。您需要一个技能工具包，例如使迭代过程脱离递归（这就是尾递归对于函数式语言必不可少的原因）、延续、不变量等。如果不学习访问修饰符、接口等，您就不会进行 OO 编程。同样的事情用于函数式编程。

我的建议是做 Little Schemer（注意我说的是“做”而不是“阅读”），然后在 SICP 中做所有的练习。完成后，您的大脑将与开始时不同。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-06-20T03:01:13.627

事实上，即使在没有可变状态的语言中，也很容易拥有看起来像可变状态的东西。

考虑一个类型为 的函数`s -> (a, s)`。从 Haskell 语法翻译过来，它意味着一个函数，它接受一个类型为 " " 的参数`s`并返回一对类型为 " `a`" 和 " `s`" 的值。如果`s`是我们状态的类型，这个函数接受一个状态并返回一个新的状态，可能还有一个值（你总是可以返回 "unit" aka `()`，它有点等同`void`于 C/C++ 中的 " " ，就像 " `a`"类型）。如果您将多个具有此类类型的函数调用链接起来（从一个函数返回状态并将其传递给下一个），您将拥有“可变”状态（实际上，您在每个函数中创建一个新状态并放弃旧状态）。

如果您将可变状态想象为程序正在执行的“空间”，然后考虑时间维度，可能会更容易理解。在时刻 t1，“空间”处于某种条件下（例如，某个内存位置的值为 5）。在稍后的时刻 t2，它处于不同的状态（例如，内存位置现在具有值 10）。这些时间“切片”中的每一个都是一个状态，并且它是不可变的（您无法及时返回来更改它们）。所以，从这个角度来看，你从带有时间箭头的完整时空（你的可变状态）到一组时空切片（几个不可变状态），你的程序只是将每个切片视为一个值并计算每个它们中的一个函数应用于前一个函数。

好的，也许这并不容易理解:-)

将整个程序状态显式表示为一个值似乎是无用的，它只能在下一个瞬间被丢弃（就在创建一个新状态之后）。对于某些算法，它可能是自然的，但如果不是，还有另一个技巧。您可以使用一个假状态来代替真实状态，它只不过是一个标记（我们称之为这个假状态的类型`State#`）。从语言的角度来看，这种假状态存在，并且像任何其他值一样被传递，但是编译器在生成机器代码时完全忽略了它。它仅用于标记执行顺序。

例如，假设编译器为我们提供了以下函数：

```
readRef :: Ref a -> State# -> (a, State#)
writeRef :: Ref a -> a -> State# -> (a, State#) 
```

从这些类似 Haskell 的声明中翻译，`readRef`接收类似于指针或句柄类型“ `a`”的值和假状态的东西，并返回`a`第一个参数指向的“”类型的值和新的假状态。`writeRef`类似，但改变了指向的值。

如果您调用`readRef`然后将其返回的假状态传递给它`writeRef`（可能与中间不相关函数的其他调用；这些状态值创建函数调用的“链”），它将返回写入的值。您可以`writeRef`使用相同的指针/句柄再次调用，它将写入相同的内存位置 - 但是，由于概念上它返回一个新的（假的）状态，（假的）状态仍然是不可变的（一个新的已经“​​创建”）。如果存在必须计算的真实状态变量，编译器将按照调用它们的顺序调用函数，但唯一的状态是真实硬件的完整（可变）状态。

（了解 Haskell 的人会注意到我简化了很多事情并省略了一些重要的细节。对于那些想要了解更多细节的人，请看一下`Control.Monad.State`from the `mtl`, and at `ST s`and `IO`(aka `ST RealWorld`) monads。）

您可能想知道为什么要以这种迂回的方式来做（而不是简单地在语言中使用可变状态）。真正的优势是您已经[具体化](http://en.wikipedia.org/wiki/Reification_(computer_science))了程序的状态。[以前是隐含的（您的程序状态是全局的，允许远距离操作](http://en.wikipedia.org/wiki/Action_at_a_distance_(computer_science))之类的事情）现在是显式的。不接收和返回状态的函数不能修改它或受它的影响；他们是“纯粹的”。更好的是，你可以有单独的状态线程，并且通过一点类型的魔法，它们可以用来在纯线程中嵌入命令式计算，而不会使它变得不纯（`ST`Haskell 中的 monad 是这个技巧中常用的；我上面提到的`State#`实际上是 GHC 的`State# s`，由它的实现`ST`和使用`IO`单子）。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-06-20T01:05:19.287

函数式编程*避免*状态并*强调*功能。从来不存在没有状态之类的东西，尽管状态实际上可能是不可变的或融入到您正在使用的架构中的东西。考虑一下仅从文件系统加载文件的静态 Web 服务器与实现魔方的程序之间的区别。前者将根据旨在将请求转换为文件路径请求的功能来实现，该请求将来自该文件的内容的响应。除了一点点配置之外，几乎不需要任何状态（文件系统“状态”实际上超出了程序的范围。无论文件处于什么状态，程序都以相同的方式工作）。但是在后者中，您需要对多维数据集和程序实现建模，以了解对该多维数据集的操作如何更改其状态。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-06-20T02:37:21.147

除了其他人给出的很好的答案之外，想想类`Integer`和`String`Java。这些类的实例是不可变的，但这并不会因为它们的实例不能更改而使这些类无用。不变性为您提供了一些安全性。您知道，如果您使用 String 或 Integer 实例作为 a`Map`的键，则无法更改该键。将此与`Date`Java 中的类进行比较：

```
Date date = new Date();
mymap.put(date, date.toString());
// Some time later:
date.setTime(new Date().getTime()); 
```

您已经默默地更改了地图中的键！使用不可变对象（例如在函数式编程中）要干净得多。更容易推断会发生什么副作用 - 没有！这意味着程序员更容易，优化器也更容易。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-08-29T14:43:17.557

对于游戏等高度交互的应用程序，**函数响应式编程**是您的朋友：如果您可以将游戏世界的属性表述为**随时间变化的值**（和/或事件流），那么您就准备好了！这些公式有时会比改变状态更自然和更能揭示意图，例如对于移动的球，您可以直接使用众所周知的定律**x = v * t**。更好的是，以这种方式编写的游戏规则比面向对象的抽象更好**。**例如，在这种情况下，球的速度也可以是一个随时间变化的值，这取决于由球的碰撞组成的事件流。有关更具体的设计注意事项，请参阅[在 Elm 中制作游戏](http://elm-lang.org/blog/games-in-elm/part-0/Making-Pong.html)。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2014-10-17T19:50:23.937

使用一些创意和模式匹配，创建了无状态游戏：

*   [CSSPlay：迷宫游戏](http://www.cssplay.co.uk/menu/amazing.html)
*   [CSSPlay：迷宫游戏 2](http://www.cssplay.co.uk/menu/maze2.html)
*   [CSSPlay：井字游戏](http://www.cssplay.co.uk/menu/tictactoe.html)
*   [纯 CSS 井字游戏](http://lea.verou.me/2011/06/pure-css-tic-tac-toe/)
*   [CSSPlay：乒乓球](http://www.cssplay.co.uk/menu/cssplay-pong2.html)
*   [CSSPlay：乒乓球](http://www.cssplay.co.uk/menu/cssplay-ping-pong.html)
*   [CSSPlay：警察和强盗](http://www.cssplay.co.uk/menu/tilt)
*   [CSSPlay：打老鼠](http://www.cssplay.co.uk/menu/cssplay-whack-a-rat.html)
*   [CSS3 Pong：与 CSS 相关的疯狂事情](http://www.sitepoint.com/css3-pong-insane-things-to-do-with-css/)

以及滚动演示：

*   [CSSPlay：随机英雄](http://www.cssplay.co.uk/menu/cssplay-random-heroes.html)
*   [动画模拟 SVG 时钟](http://upload.wikimedia.org/wikipedia/commons/4/4d/Animated_analog_SVG_clock.svg)
*   [动画 SVG 摆](http://tecfa.unige.ch/guides/svg/ex/smil-dom/pendula.svg)
*   [动画 SVG 赛车手](http://srufaculty.sru.edu/david.dailey/svg/newstuff/SMIL7g.svg)
*   [CSS3：造雪](http://standardista.com/snow/#slide1)

和可视化：

*   [XSLT Mandlebrot](http://bisqwit.iki.fi/jutut/xslt-mandelbrot/mandelbrot.xml)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-06-20T01:03:29.853

这就是 FORTRAN 在没有 COMMON 块的情况下工作的方式：您将编写具有您传入的值和局部变量的方法。就是这样。

面向对象编程将状态和行为结合在一起，但当我在 1994 年第一次从 C++ 中遇到它时，这是一个新想法。

Geez，当我是一名机械工程师时，我是一名函数式程序员，我不知道！

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-06-20T02:59:59.010

请记住：函数式语言是图灵完备的。因此，任何用命令式语言执行的有用任务都可以用函数式语言完成。不过，归根结底，我认为混合方法有一些话要说。F# 和 Clojure（我相信还有其他语言）等语言鼓励无状态设计，但在必要时允许可变性。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-06-20T03:21:39.200

您不能拥有有用的纯函数式语言。总会有一定程度的可变性需要处理，IO 就是一个例子。

将函数式语言视为您使用的另一种工具。它对某些事情有好处，但对其他事情则不然。您提供的游戏示例可能不是使用函数式语言的最佳方式，至少屏幕将具有可变状态，您无法使用 FP 做任何事情。您思考问题的方式和使用 FP 解决的问题类型将不同于您习惯使用命令式编程的方式。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-06-20T01:35:43.313

通过使用大量递归。

[F# 中的井字游戏（一种功能语言。）](http://www.siafoo.net/snippet/246)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-08-10T07:47:25.553

JavaScript 提供了非常清晰的示例，说明了在其核心中处理可变或不可变状态\值的不同方法，因为 ECMAScript 规范无法确定一个通用标准，因此必须继续记住或仔细检查哪些函数创建了它们返回的新对象或修改传递给它的原始对象。如果你的整个语言是不可变的，那么你知道你总是得到一个新的（复制的和可能修改的）结果，并且永远不必担心在将变量传递给函数之前意外修改它。

你知道哪个返回一个新对象，哪个改变了以下示例的原始对象吗？

```
Array.prototype.push()
String.prototype.slice()
Array.prototype.splice()
String.prototype.trim() 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-10-16T04:40:09.333

让我们回答更普遍的问题：

> 没有状态，你怎么能做任何有用的事情？

# 你没有。

> *在寻找传统语言的替代方案时，我们必须首先认识到系统不可能是历史敏感的（允许执行一个程序来影响后续程序的行为），除非系统具有某种状态（第一个程序可以更改并且第二个可以访问）。**因此，计算系统的历史敏感模型必须具有状态转换语义**，至少在这种弱意义上。*
> 
> [约翰巴克斯](https://www.cs.cmu.edu/%7Ecrary/819-f09/Backus78.pdf)。

^(（我强调。）)

重要的是巴库斯随后的观察：

> *但这并不意味着每次计算都必须严重依赖于复杂的状态 [...]*

[Haskell](https://www.haskell.org)或[Clean](https://clean.cs.ru.nl/Clean)等函数式语言让您可以轻松地将这一观察结果付诸实践：大多数定义都是简单的函数，就像您在数学教育中看到的那样。这留下了一个小的“杂牌小组”来处理所有令人讨厌的外部状态，以便例如：

*   与用户互动，
*   与远程服务通信，
*   使用随机抽样处理模拟，
*   打印出[SVG 文件](https://futureofcoding.org/essays/dctp.html)（例如作为海报），
*   进行计划备份，

...两种语言都通过使用类型将平原与杂色分开。

* * *

有时，如果您尝试实现的算法是使用私有的本地可变状态实现的，那么它的效果最好。在这种情况下，您可以使用 Haskell 扩展来做到这一点，**而不**会使整个程序“内部杂乱无章” -有关详细信息，请参阅 John Launchbury 和 Simon Peyton Jones 的[Haskell 状态。](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.52.3656&rep=rep1&type=pdf)

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2021-08-12T20:05:16.357

TLDR：您可以在没有可变状态的情况下进行任何计算，但是当需要实际告诉计算机要做什么时，由于计算机仅在可变状态下工作，因此您需要在某个时候改变某些东西。

有很多答案正确地说，如果没有可变状态，您将无法做任何有用的事情，我想用一些简单的（反）示例以及一般直觉来支持这一点。

如果您看到任何被认为是“纯功能性”的代码，并且它做了这样的事情（不是真正的语言）：

```
printUpToTen = map println [1..10] 
```

这不是纯粹的功能。有一个隐藏状态（的`stdout`）不仅被变异，而且被隐式传入。看起来像这样的代码（同样不是真正的语言）：

```
printUpToTen = map println stdout [1..10] 
```

也不是纯的：即使我们显式传入 state ( `stdout`)，它仍然会被隐式变异。

现在有一些直觉：可变状态是必要的，因为影响我们计算机的核心构建块是可变状态，该构建块是内存。即使我们的计算模型确实可以在没有“内存”概念的情况下计算任何东西，我们也不能强迫计算机在不以某种方式操纵这个内存的情况下做任何事情。

想想类似旧的 GameBoy Advance：为了在屏幕上显示某些内容，您必须修改内存（某些地址每秒被读取多次，以确定屏幕上显示的内容）。您的计算模型（纯函数式编程）可能不需要状态来操作，您甚至可以使用抽象状态操作的命令式状态操作模型（如程序集）来实现您的模型，但归根结底，在某个地方在您的代码中，您必须修改内存中的这些地址，以便设备实际显示任何内容。

这就是命令式模型具有天然优势的地方：因为它们总是在操纵状态，所以您可以很容易地将其转化为实际修改内存。这是一个示例渲染循环：

```
while (1) {
   render(graphics_state);
} 
```

如果要展开循环，它看起来像这样：

```
render(graphics_state); // modified the memory
render(graphics_state); // modified the memory
render(graphics_state); // modified the memory
... 
```

但在纯函数式语言中，您可能会得到如下内容：

```
render_forever state = render_forever newState
    where newState = render state 
```

展开（或准确地说是展平）可以像这样可视化：

```
render(render(render(render(...state) // when is the memory actually changing??

// or if you want to expand it the other direction
...der(render(render(render(render(render(state) // no mutation 
```

正如你所看到的，我们在不断变化的状态上一遍又一遍地调用一个函数，但我们从不改变内存：我们立即将它传递给下一个函数调用。即使我们的实现实际上是在修改一些代表状态的东西（甚至在原地！），它也不在正确的位置。在某些时候，我们需要暂停并修改内存中的正确地址，这涉及到一个突变。

* * *

## 回答 #20

> 赞同：-3
> 
> 时间：2015-10-30T19:31:20.103

这很简单。您可以在函数式编程中使用任意数量的变量……但前提是它们是**局部**变量（包含在函数内部）。因此，只需将您的代码包装在函数中，在这些函数之间来回传递值（作为传递的参数和返回值）......这就是它的全部内容！

这是一个例子：

```
function ReadDataFromKeyboard() {
    $input_values = $_POST[];
    return $input_values;
}
function ProcessInformation($input_values) {
    if ($input_values['a'] > 10)
        return ($input_values['a'] + $input_values['b'] + 3);
    else if ($input_values['a'] > 5)
        return ($input_values['b'] * 3);
    else
        return ($input_values['b'] - $input_values['a'] - 7);
}
function DisplayToPage($data) {
    print "Based your input, the answer is: ";
    print $data;
    print "\n";
}

/* begin: */
DisplayToPage (
    ProcessInformation (
        GetDataFromKeyboard()
    )
); 
```

# java - 如何轻松对黑莓代码进行单元测试？

> ID：1020656
> 
> 赞同：21
> 
> 时间：2009-06-20T00:54:45.050
> 
> 标签：java, unit-testing, blackberry, tdd

*对于我的大学课程，我们正在开发一个多线程的黑莓应用程序，它允许我们使用蓝牙扫描运行我们应用程序的其他设备，然后通过 Wifi 接口通过 TCP 相互传输文件，实现 NAT 遍历，同时记录我们的GPS定位。（这是 RIM 赞助的计算机网络课程，以防这还不明显。）*

我越来越喜欢[测试驱动开发](http://en.wikipedia.org/wiki/Test-driven_development)，并打算用它来开发我的家庭作业。但是，由于非法修饰符，我在测试期间扩展或以其他方式调用的任何 Blackberry 类都会给我一个[ClassFormatError 。](http://java.sun.com/javase/6/docs/api/java/lang/ClassFormatError.html)我认为这个错误是因为带有黑莓代码的 jar 必须是专门为他们的专有 JVM 编译的。

到目前为止，我已经求助于使用[代理模式](http://en.wikipedia.org/wiki/Proxy_pattern)并实现代理的[模拟对象](http://en.wikipedia.org/wiki/Mock_object)。但是，这变得非常乏味，因为我继承了许多本地 Blackberry 类。

如果可能的话，我还想避免启动黑莓模拟器。启动它可能需要几分钟，这对于单元测试来说是不切实际和烦人的。

**是否有简单的方法对我的黑莓代码进行单元测试？**

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-20T06:54:09.077

## 样机测试

您的模型制作方法正确，但我不建议您在 J2SE 平台上测试 Blackberry 功能。我认为应该使用代理和模型，以防本地源中没有可用的测试数据，例如：

“扫描其他设备” - 没有其他设备，但您想测试扫描功能
“TCP over the Wifi interface” - 您想在 Storm（无 WiFi）上测试它
“记录我们的 GPS 位置” - 设备位置是静态的，但您想测试其他位置

然后您可以使用 Blackberry 平台模拟此类功能：
[BlackBerry GPS location mockup](https://stackoverflow.com/questions/920303/blackberry-change-latitude-and-longitude-on-the-device-to-test-app/943305#943305)

您仍然可以使用相同的名称和签名从头开始在 J2SE 上重现 BlackBerry API 类。那将假定您必须自己实现所有类功能。

## 在没有模拟器的情况下测试 j2me

那将是一个非常好的选择，但到目前为止我还看不到如何做到这一点。

测试涉及应用程序运行，这涉及平台模拟。有可能在没有整个 UI 模拟器运行的情况下测试 j2me 代码，但我不知道。

您可以做的是在 Java 标准版上以最少的代码更改测试一些业务逻辑。

您仍然需要在模拟器上运行平台相关的功能测试，但您可以在一个应用程序中进行，这将是一组单元测试，就像 ChrisW 已经说过的那样。只需逐个运行测试方法并在屏幕上输出结果：
Method1 - Passed - 0.03 s Method2 -
Passed - 1.30 s
Method3 - Passed - 0.25 s

## J2MEUnit

[http://j2meunit.sourceforge.net/](http://j2meunit.sourceforge.net/)：

> J2MEUnit 是一个 Java 2 Micro Edition (J2ME) 库，其中包含用于 J2ME 应用程序的单元测试框架。它基于原始 JUnit 的源代码，它是 Java 标准（桌面）版 J2SE 的成功单元测试框架。

[使用 J2MEUnit 和 Eclipse](http://decoding.wordpress.com/2008/12/05/unit-testing-j2me-applications-with-j2meunit-and-eclipse/)
[快速教程对 J2ME 应用程序进行单元测试以设置和学习 J2MEUnit](http://www.instrumentalservices.com/media/java/j2me/J2MEUnitTutorial.pdf)

## JMUnit

[http://jmunit.sourceforge.net/](http://jmunit.sourceforge.net/)：

> JMUnit 是一个基于 JUnit 的 Java ME (J2ME) 单元测试框架。它具有以下特性：
> - 在 Sun 模拟器和实际设备上都可以使用。
> - 很小（测试甚至可以在旧的 MIDP 1.0 设备上运行）。
> - 拥有全面的 Assert 方法集合，用于检查测试失败。
> - 支持测试用例和测试套件。
> - 包括用于在连续构建中运行 JMUnit 测试的 Ant 任务。
> - 具有受 JUnitPerf 启发的性能监控类。

[编写和运行 JMUnit 测试](http://dsdp.eclipse.org/help/latest/index.jsp?topic=/org.eclipse.mtj.doc.user/html/gettingstarted/jmunit.html)

## 单元

> 基于 jmunit 的 RIM Blackberry 单元测试库

[http://sourceforge.net/projects/b-unittesting/](http://sourceforge.net/projects/b-unittesting/)
[黑莓支持社区论坛：如何对我的黑莓应用程序进行单元测试](http://supportforums.blackberry.com/rim/board/message?board.id=java_dev&thread.id=49820&view=by_date_ascending&page=2)

## 额外的

[如何 - 使用 BlackBerry Simulator 自动进行测试](http://www.blackberry.com/knowledgecenterpublic/livelink.exe/fetch/2000/348583/796557/800738/800792/801083/How_To_-_Automate_testing_with_the_BlackBerry_Simulator.ht%20ml?nodeid=1261374&vernum=0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T01:01:41.370

当我想对一些 Windows Mobile 代码进行单元测试时，我在模拟器/模拟器和/或设备本身上运行它们。

> 这是不切实际的，因为我不会启动一个模拟器，它在实现每个测试/功能后需要将近一分钟才能启动。

我可以启动它，将软件加载到它上面，然后运行测试......让它继续运行......在*不重新启动*的情况下重新加载新的应用程序软件，然后重新运行它。也许黑莓不允许这样做？

此外，我可以一次性运行一整套测试（无需在每个测试/功能之间重新启动）。但是，如果您的习惯是：这可能与 TDD 不兼容：

1.  写一个测试用例
2.  运行它以确保它失败
3.  编写实现
4.  再次运行它，以确保它这次成功
5.  （重复上述实现下一个功能）

不过也有可能发生。例如设备驱动程序：调试繁琐，因为系统可能每次都需要启动，因为如果它们有错误，它们会挂起系统，因为调试器不是用户友好的......这样的环境交互性较差，所以更加强调：

*   第一次做对（所以你不必调试）
*   一次实施（并编写测试并随后测试）更大（可能是整个）功能块

# c# - 如何重构迭代器的使用

> ID：1020664
> 
> 赞同：0
> 
> 时间：2009-06-20T00:57:37.323
> 
> 标签：c#, refactoring, iterator

我有一些我想重构的代码使用 C# 迭代器（即 IEnumerable）。不幸的是，我无法确定允许其他函数与迭代器一起工作而不导致它重新启动迭代器的最佳方法。

例如：

```
NewLineEnumerator nle = new NewLineEnumerator();

while (bytesRead > 0)
{
  var nlenum = nle.Process(inputData, bytesRead);
  foreach (string block in nlenum)
  {
    DoSomething(nlenum);
  }
}

void DoSomething(IEnumerable<string> myiter)
{
  foreach (var s in myiter)
  {
     // myiter is restarted, and begins at the start of the iterator again
  }
} 
```

你可能会问我为什么要这样做。原因是我有一个数据流，被“命令块”包围。根据命令，我将其发送到不同的子函数进行处理。所以我想在流的开始或结束时继续迭代我在流中停止的地方。

这里有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-20T00:59:33.433

通过调用 GetEnumerator() 传递 IEnumerator<string> 而不是 IEnumerable<string>。它将在调用中保留状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-20T03:50:18.507

正如尼克所说，创建一个`IEnumerator<string>`并在方法之间传递它。代码看起来像：

NewLineEnumerator nle = new NewLineEnumerator();

```
while (bytesRead > 0)
{
    var nlenum = nle.Process(inputData, bytesRead);
    using (var enumerator = nlenum.GetEnumerator())
    {
        while (enumerator.MoveNext())
        {
            DoSomething(enumerator);
            Console.WriteLine(enumerator.Current);
        }
    }

    // ensure that bytesRead is decremented by the code that runs above
}

void DoSomething(IEnumerator<string> myenum)
{
    while (myenum.MoveNext())
    {
        if (ShouldProcess(myenum.Current))
        {
            // process it
        }
        else
        {
            // return to outer loop
            break;
        }
    }
} 
```

（请注意，如果您使用的是 .NET 1.0，并且`IEnumerable`, not `IEnumerable<string>`，则该`using`语句可能无法编译。）

# vb.net - 发送 HTML 电子邮件的解决方案，其中 HTML 来自 HTML 文件。VB.Net/ClickOnce 环境

> ID：1020669
> 
> 赞同：0
> 
> 时间：2009-06-20T00:59:05.993
> 
> 标签：vb.net, clickonce, mapi

**用法：**

用户在另一个应用程序中创建漂亮的 HTML 新闻信件。**他们将时事通讯发布到网络上，但他们也**想将 HTML 时事通讯文件的内容设置为电子邮件的正文，并使用应用**程序**问题**发送**。

 ****用户了解在发送 E 时事通讯时使用绝对链接和图像引用。

**环境：**

**AIQ**是一个通过 ClickOnce 部署的 VB.Net 应用程序。它是一个内网应用程序；可以确定 MS Office 2003 和 interop 11 dll 在目标机器上。

**限制：**

[MAPI 出来了。](http://support.microsoft.com/kb/268440)它破坏了 HTML。

由于它是 ClickOnce 部署，我们无法注册 dll（我想，如果我错了，请纠正我）。因此，CDO 和 COM 被淘汰了（同样，我可能错了......我很高兴被证明是这样）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-20T08:19:47.170

我不确定你在问什么。如果您询问如何发送电子邮件，.NET Framework 包含用于通过 SMTP 发送电子邮件的 System.Net.Mail 命名空间。

您可以创建一个新的`SmtpClient`. 如果它部署在 LAN 上，那么您可以将`Host`属性设置为 Exchange 服务器或其他 SMTP 服务器。

然后，您可以创建一个`MailMessage`将正文设置为要发送的 HTML 内容的内容。

这是一个示例：

```
 //create the mail message
 MailMessage mail = new MailMessage();

 //set the addresses
 mail.From = new MailAddress("me@mycompany.com");
 mail.To.Add("you@yourcompany.com");

 //set the content
 mail.Subject = "This is an email";
 mail.Body = "this is a sample body with html in it. <b>This is bold</b> <font color=#336699>This is blue</font>";
 mail.IsBodyHtml = true;

 //send the message
 SmtpClient smtp = new SmtpClient("127.0.0.1");
 smtp.Send(mail); 
```****

# c# - 这个 Moq 代码在 RhinoMocks 中会是什么样子

> ID：1020673
> 
> 赞同：8
> 
> 时间：2009-06-20T01:00:10.140
> 
> 标签：c#, asp.net-mvc, mocking, rhino-mocks, moq

嘿人们...试图让我的嘲笑与 asp.net MVC 排序。

我在网上找到了这个使用 Moq 的示例，基本上我理解它的意思是：调用 ApplyAppPathModifier 时，返回传递给它的值。

我不知道如何在 Rhino Mocks 中做到这一点，有什么想法吗？

```
var response = new Mock<HttpResponseBase>();
response.Expect(res => res.ApplyAppPathModifier(It.IsAny<string>()))
            .Returns((string virtualPath) => virtualPath); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-09-08T08:49:09.263

如果您使用的是存根方法而不是 SetupResult 方法，则其语法如下：

```
response.Stub(res => res.ApplyAppPathModifier(Arg<String>.Is.Anything))
                .Do(new Func<string, string>(s => s)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-20T02:19:36.237

正如我上面提到的，草皮法，一旦你发帖寻求帮助，你会在 5 分钟后找到它（即使搜索了一段时间）。无论如何，为了他人的利益，这是可行的：

```
SetupResult
    .For<string>(response.ApplyAppPathModifier(Arg<String>.Is.Anything)).IgnoreArguments()
    .Do((Func<string, string>)((arg) => { return arg; })); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T01:58:19.773

除非我误读了代码，否则我认为您可以将其简化很多。试试这个：

```
var response = MockRepository.GenerateMock<HttpResponseBase>();

response.Stub(res => res.ApplyAppPathModifier(Arg<String>.Is.Anything)) 
                        .IgnoreArguments()
                        .Return(virtualPath); 
```

# javascript - 如何使 Flash 电影按比例缩放到 div 宽度？

> ID：1020682
> 
> 赞同：2
> 
> 时间：2009-06-20T01:04:44.967
> 
> 标签：javascript, jquery, css, flash, actionscript

我整理了一个[示例页面，详细说明了我的问题](http://tinyurl.com/lgk9ny)

我的网站将有一个主包装器，该包装器设置为兼容浏览器的最大宽度属性。它将最大延伸到 940 像素。当按比例缩小时，我希望 swf 与它成比例地缩放。就像应用了宽度百分比的图像。Flash 电影的尺寸为 940 × 360 像素。

我似乎无法找出正确的属性来添加到 embed 标记以使其执行此操作。

我目前正在使用 jquery flash embed，但我对其他选项持开放态度，尽管这是我的理想。

在示例中，我将闪光灯背景设置为黑色。

当调整浏览器窗口的大小时，flash 电影不会按比例缩放到 div，只有照片会，留下空白画布（黑色），而 div 高度保持不变。我无法在 CSS 中添加高度值。

![替代文字](../Images/274067a138168609ef2cf3d388156bf8.png)

如何正确制作这个比例？添加 noscale 参数只会裁剪图像。swf 的高度也不会按比例缩放。

我的所有代码都可以在[链接的示例源](http://tinyurl.com/lgk9ny)中查看。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-20T11:27:33.750

本文有望涵盖您需要的内容：[http](http://www.alistapart.com/articles/creating-intrinsic-ratios-for-video/) ://www.alistapart.com/articles/creating-intrinsic-ratios-for-video/ 。它也是纯 CSS ！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-20T02:29:24.907

我有几个想法，从使用 ExternalInterface 从 javascript 调用和 actionscript 函数，到将 FlashVars 传递给 swf 只是让 swf 知道 div 的大小，再到一个更简单的想法。

开始。

有 1 个 MovieClip 作为背景和 1 个包含头部的 MoveClip。

我认为您最好的选择是您示例中的“这是顶部的 Flash 电影”选项。你最好的将是设置

```
stage.scaleMode = StageScaleMode.NO_SCALE; 
```

或者

```
stage.scaleMode = StageScaleMode.SHOW_ALL; 
```

这个想法是按比例缩放内容。

然后，您将为调整大小事件添加一个事件侦听器并缩放/重绘背景。

```
stage.addEventListener(Event.RESIZE, stageResizeHandler);

function stageResizeHandler(event:Event = null):void{
   //assuming your background is called "background"
   background.width = stage.stageWidth;
   background.height = stage.stageHeight;
   //if content needs recentering, assuming "content" is the name used
   content.x = (stage.stageWidth - content.width) * .5;
   content.y = (stage.stageHeight - content.height * .5;
} 
```

我为事件处理程序参数设置了默认值，因此您可以调用该函数而无需调度事件

例如

```
stageResizeHandler(); 
```

代替

```
stage.dispatchEvent(new Event(Event.RESIZE)); 
```

您可能需要在初始化时调用该函数，不确定。

此外，您还需要根据舞台的大小按比例调整内容的大小。所以这是我测试的一些代码：

```
stage.scaleMode = StageScaleMode.NO_SCALE;
stage.align = StageAlign.TOP_LEFT;

stage.addEventListener(Event.RESIZE, stageResizeHandler);

stageResizeHandler();

function stageResizeHandler(event:Event = null):void{
    //resize bg
    bg.width = stage.stageWidth;
    bg.height = stage.stageHeight;

    //scale proportionally
    if(content.width > stage.stageWidth || content.height > stage.stageHeight){
        var ratio:Number = getRatio(content);
        if(stage.stageWidth > stage.stageHeight){
            content.height = stage.stageHeight;
            content.width = content.height * ratio;
        }else 
        if(stage.stageWidth < stage.stageHeight){
            content.width = stage.stageWidth;
            content.height = content.width / ratio;
        }
    }else {
        content.scaleX = content.scaleY = 1;
    }

    //centre
    content.x = (stage.stageWidth - content.width) * .5;
    content.y = (stage.stageHeight - content.height) * .5;
}

function getRatio(target:MovieClip):Number{
    var ratio:Number; 
    target.width > target.height ? ratio = (target.width / target.height) : ratio = (target.height / target.width);
    return ratio;
} 
```

不幸的是，我注意到某些尺寸有些闪烁。我猜测缩放比例和比率的变化经常取决于您调整大小的方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-20T08:23:27.397

感谢 George Profenza 给了我所有的 actionscript 代码。闪烁太多，我对 actionscript 不够熟悉，不知道如何修复它。不过，把这么多东西放在一起的大道具。

**我使用 jquery 创建了一个解决方案。这很简单。**

首先，我为禁用 css 的人嵌入了具有最大可能高度的 flash 电影。它仍会随宽度缩放，但会像链接示例中一样显示画布背景。

```
$(selector).flash({
    src: swf,
    width: '100%',
    height: '360',
});

//get ratio from native width and height
var nativeWidth = 940;
var nativeHeight = 360;
var ratio = nativeWidth/nativeHeight;

var containerWidth = $(selector).width();
var containerHeight = containerWidth/ratio;
$(selector+' embed').height(containerHeight);

//resize flash movie
$(window).resize(function() {
    containerWidth = $(selector).width();
    containerHeight = containerWidth/ratio;
    $(selector+' embed', selector+' object').height(containerHeight);
    $(selector).height(containerHeight);
}); 
```

然后在调整浏览器窗口大小时几乎调整电影大小，并根据新宽度除以原始纵横比计算高度。这段代码可以清理很多，但我希望它可以帮助其他人避免数小时的烦恼。

# jquery - 需要关于圆角的jquery插件的建议

> ID：1020694
> 
> 赞同：5
> 
> 时间：2009-06-20T01:11:10.697
> 
> 标签：jquery, css, jquery-plugins

我想了解jquery插件，所以我决定尝试制作一个简单的圆角框。我知道已经有一些圆角插件，但这对我来说更像是一种学习练习，而不是工作要求。

[我从这里](http://www.cssplay.co.uk/boxes/snazzy.html)取的圆角。我喜欢这个示例，因为它不使用图像，很容易更改框的颜色。

我想我很难用最好的方法来解决这个问题。我有一个非常粗糙的样本，它有点工作，但感觉不对。让我束手无策的部分是在内容区域周围构建圆角。现在它需要“内容”框并附加它周围的角。有什么更好的方法来做到这一点？

这是制作盒子的电话 - $('#content').roundbox();

如果这还不够信息，请告诉我。

```
//
(function($)
{
jQuery.fn.roundbox = function(options)
{

    var opts = $.extend({}, $.fn.roundbox.defaults, options);

    var outer = $("<div>");
    var topBorder = $("<b class='xtop'><b class='xb1'></b><b class='xb2'></b><b class='xb3'></b><b class='xb4'></b></b>");
    var bottomBorder = $("<b class='xbottom'><b class='xb4'></b><b class='xb3'></b><b class='xb2'></b><b class='xb1'></b></b>");
    var title = $("<h1>Select Funding</h1>");
    var separator = $("<div></div>");

    $(this).append(title);
    $(this).append(separator);

    var firstElement = $(this).children()[0];
    if (firstElement != null)
    {
        title.insertBefore(firstElement);
        separator.insertBefore(firstElement);
    }

    outer.append(topBorder);
    outer.append($(this));
    outer.append(bottomBorder);

    $("#fundingAdminContainer").append(outer);

    //Add classes
    outer.addClass(opts.outerClass); //outer container
    $(this).addClass(opts.contentClass); //inner content
    title.addClass(opts.titleClass); //roundbox title
    separator.addClass(opts.lineClass); //line below title
};

$.fn.roundbox.defaults =
{
    outerClass: 'roundbox',
    contentClass: 'roundboxContent',
    titleClass: 'roundboxTitle',
    lineClass: 'roundboxLine'
};

})(jQuery);

//CSS
.roundbox
{
float:left;
width:400px;
margin-right:20px;
}

.roundboxContent
{
display:block;
background:#ffffff;
border:0 solid #D4E2FE;
border-width:0 1px;
height:180px;
padding:10px;
}

.roundboxLine
{
background: url(../images/fundingAdmin_line.gif);
background-repeat:no-repeat;
height:5px;
}

.roundboxTitle
{
font-size:1.3em; color:#17A2D3;
}

.xtop, .xbottom {display:block; background:transparent; font-size:1px;}
.xb1, .xb2, .xb3, .xb4 {display:block; overflow:hidden;}
.xb1, .xb2, .xb3 {height:1px;}
.xb2, .xb3, .xb4 {background:#ffffff; border-left:1px solid #D4E2FE; border-right:1px solid #D4E2FE;}
.xb1 {margin:0 5px; background:#D4E2FE;}
.xb2 {margin:0 3px; border-width:0 2px;}
.xb3 {margin:0 2px;}
.xb4 {height:2px; margin:0 1px;} 
```

盒子的最终结构应该是：

```
<div id="fundingAdminContainer"><!-- Not part of rounded box, just serves as a container. -->
    <div class="roundbox">
        <b class="xtop"><b class="xb1"></b><b class="xb2"></b><b class="xb3"></b><b class="xb4"></b></b>
        <div id="content" class="roundboxContent">
            <h1 class="roundboxTitle">Title</h1>
            <div class="roundboxLine"></div>
                //CONTENT
        </div>
        <b class="xbottom"><b class="xb4"></b><b class="xb3"></b><b class="xb2"></b><b class="xb1"></b></b>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T01:02:59.060

[http://www.curvycorners.net/ http://www.curvycorners.net/](http://www.curvycorners.net/)

javascript 库，不是 jQuery 插件，但它似乎可以工作：D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T07:50:32.440

这是一个替代的jQuery弯角插件

[http://labs.parkerfox.co.uk/cornerz/](http://labs.parkerfox.co.uk/cornerz/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-22T11:15:06.193

这个很棒：

[http://jrc.rctonline.nl/](http://jrc.rctonline.nl/)

它使用 Canvas，因此非常灵活。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T13:14:48.730

你这样做的方式对我来说似乎很好。不过，我不会硬编码 Funding 的东西。

您可以将标题和分隔符设置为函数的选项，而不是附加到#fundingAdminContainer，您可以这样做

```
outer.insertBefore($(this)); 
```

在将 $(this) 附加到外部之前。

编辑：这个答案现在已经很老了，我会说已经过时了。大多数浏览器现在通过 CSS 边框半径属性或至少一个特定于浏览器的替代方案来支持圆角。我还要说，在大多数情况下，为不支持 CSS 的旧浏览器（当然这是意见）填充圆角所需的额外 js 甚至是不值得的。所以如果我要给出一个完整的答案，我会说只是使用[它](http://border-radius.com/)并按照它告诉你的去做:)。

但是，如果您真的想要 <IE9 中的圆角，我建议您[这样](http://code.google.com/p/curved-corner/)做，以便您仍然可以在大多数浏览器中单独使用 CSS，并且只有 IE 需要做任何额外的工作（在 htc 文件中）来圆角.

唯一的问题是 htc 文件也已过时，应该使用类似的东西进行修改以检查边界半径是否[存在](http://www.nealgrosskopf.com/tech/thread.php?pid=74#showmore-unique2)。HTC只是JS。这将使 IE9 不必进行 JS DOM 操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-03T14:13:15.377

这个**jQuery Corner 插件**可能会有所帮助。易于使用且令人惊叹。

[http://jquery.malsup.com/corner/](http://jquery.malsup.com/corner/)

**用法**

```
$('#myDiv').corner(); 
```

# c# - ClickOnce 部署网站修改

> ID：1020704
> 
> 赞同：1
> 
> 时间：2009-06-20T01:21:43.187
> 
> 标签：c#, .net, deployment, clickonce

所以我有一个我想通过 ClickOnce 部署的应用程序。但是，当您访问部署网页时，您会看到一个相当平淡的默认样式页面，其中包含应用程序名称和“运行”按钮。如何修改此页面以添加其他按钮、插图等？我似乎无法在任何地方的解决方案中找到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-20T01:54:15.787

您需要做的就是创建一个指向服务器上的应用程序文件的网页。 `<a href="http://server/myapp.application">My App</a>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-20T01:48:22.353

它是由发布向导自动生成的，但您不必将其部署到您的服务器，只需将您自己的页面放在那里即可。向导生成的页面没有什么特别之处。

# sharepoint - 使用基于 SharePoint 表单的身份验证打开文档时出现问题

> ID：1020710
> 
> 赞同：0
> 
> 时间：2009-06-20T01:27:03.800
> 
> 标签：sharepoint, forms-authentication, wss-3.0

我正在尝试构建一个 WSS 3.0 站点。

我在尝试签出文档时弹出的对话框有困难。我试图通过启用基于表单的身份验证来解决这个问题，但是当我单击文档时，Microsoft Word 打开并且我得到了垃圾（MS Office 也失败了）。

我想要完成的只是从任何计算机登录到我的 WSS 3.0 站点，当我登录时，编辑和上传文档而不会让对话框打断我。

如何实现？

注意：WSS 3.0 安装在 Windows Server 2008、Vista 客户端和 MS Office 2007 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-20T07:04:03.550

为了防止弹出，您需要进行 IE 设置。恐怕对于 Internet 站点它不会有帮助。如果您更改为 FBA，则另当别论，请参阅[MSDN 博客](http://blogs.msdn.com/sharepoint/archive/2009/05/13/update-on-sharepoint-forms-based-authentication-fba-and-office-client.aspx) 了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-09T13:23:09.923

您所说的垃圾是指您在尝试打开的文档中看到类似表单登录屏幕的内容吗？如果是这样，解决它的一种方法是修改您的登录屏幕，以便始终为用户提供持久 cookie 而不是会话 cookie。还有一种方法可以在打开文档之前显示一个表单登录框（Kusek 在他的回复中链接到了有关它的信息）。

# python - 有没有更好的方法将列表转换为 Python 中的字典，其中包含键但没有值？

> ID：1020722
> 
> 赞同：6
> 
> 时间：2009-06-20T01:43:49.023
> 
> 标签：python, list, dictionary, list-comprehension

我确信会有一个行将列表转换为字典，其中列表中的项目是键，而字典没有值。

我能找到的唯一方法遭到反对。

“在忽略结果时使用列表推导会产生误导且效率低下。`for`循环更好”

```
myList = ['a','b','c','d']
myDict = {}
x=[myDict.update({item:None}) for item in myList]

>>> myDict
{'a': None, 'c': None, 'b': None, 'd': None} 
```

它有效，但有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-06-20T01:48:05.927

使用`dict.fromkeys`：

```
>>> my_list = [1, 2, 3]
>>> dict.fromkeys(my_list)
{1: None, 2: None, 3: None} 
```

值默认为`None`，但您可以将它们指定为可选参数：

```
>>> my_list = [1, 2, 3]
>>> dict.fromkeys(my_list, 0)
{1: 0, 2: 0, 3: 0} 
```

从文档：

> a.fromkeys(seq[, value]) 创建一个新字典，其中的键来自 seq，值设置为 value。
> 
> dict.fromkeys 是一个返回新字典的类方法。值默认为无。2.3 版中的新功能。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-20T01:49:34.363

您可以使用[集合](http://docs.python.org/library/stdtypes.html#set-types-set-frozenset)而不是字典：

```
>>> myList=['a','b','c','d']
>>> set(myList)
set(['a', 'c', 'b', 'd']) 
```

如果您从不需要存储值，而只是存储唯一项目的无序集合，这会更好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-20T05:37:39.897

为了回答最初提问者的性能担忧（对于`dict`vs中的查找`set`），有点令人惊讶的是，假设例如一半查找失败而一半成功，`dict`查找*可以*更快（在我相当慢的笔记本电脑上的 Python 2.5.1 中）。以下是如何找出答案：

```
$ python -mtimeit -s'k=dict.fromkeys(range(99))' '5 in k and 112 in k'
1000000 loops, best of 3: 0.236 usec per loop
$ python -mtimeit -s'k=set(range(99))' '5 in k and 112 in k'
1000000 loops, best of 3: 0.265 usec per loop 
```

多次检查以验证它们是可重复的。因此，如果慢速笔记本电脑上的 30 纳秒或更少时间处于绝对关键的瓶颈，那么可能值得采用晦涩难懂的`dict.fromkeys`解决方案，而不是简单、明显、可读且清晰正确`set`（不寻常——在 Python 中几乎总是简单直接解决方案也具有性能优势）。

当然，需要检查自己的 Python 版本、机器、数据以及成功与失败测试的比率，**并**通过极其准确的分析确认，将查找时间缩短 30 纳秒（或其他时间）将产生重要影响。

幸运的是，在绝大多数情况下，这将被证明是完全没有必要的……但由于程序员*无论如何***都会**沉迷于毫无意义的微优化，无论他们被告知多少次无关紧要，该模块就在标准中图书馆让那些几乎毫无意义的微基准测试变得容易！-)*`timeit`*

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T01:54:00.733

这是使用地图的一种相当错误且效率低下的方法：

```
>>> d = dict()
>>> map (lambda x: d.__setitem__(x, None), [1,2,3])
[None, None, None]
>>> d
{1: None, 2: None, 3: None} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-20T07:04:57.713

您可以使用列表推导：

```
my_list = ['a','b','c','d']
my_dict = dict([(ele, None) for ele in my_list]) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-20T09:33:52.310

也许你可以使用 itertools：

```
>>>import itertools
>>>my_list = ['a','b','c','d']
>>>d = {}
>>>for x in itertools.imap(d.setdefault, my_list): pass
>>>print d
{'a': None, 'c': None, 'b': None, 'd': None} 
```

对于庞大的列表，也许这非常好：P*

# sql - SQL 在返回的行中添加一行

> ID：1020726
> 
> 赞同：0
> 
> 时间：2009-06-20T01:48:45.520
> 
> 标签：sql

好的，

我有一个表发布，它具有 PublicationID、PublisherID、NameAbbrev...，并且它连接到另一个名为 AreaBuy 的表，该表具有 AreaBuyID 字段、NameAbbrev、DateCreated 和 CreatedBy 字段。关系基本上是公司为我们的产品签了一组文件（不一定属于同一个伞形公司）。publish 和 AreaBuy 表通过 PublicationAreaBuy 表连接，该表具有 1...M...1 关系（巧妙的名字对！）。

我的问题是：我想从出版物表中选择一组出版物，假设我们从今年的第一天到现在签署了它们，但是如果返回的任何论文在 AreaBuy 组中，我想要那个也回来了！更重要的是，我只想返回两列，这将是所有出版物 ID 和名称，所以我希望 AreaBuy 信息包含在这两列中。所以假设我在我的集​​合中得到了五个结果：

```
编号 | 姓名
1 先驱报
2 洛杉矶时报  
162 洛杉矶地区购买
230县询问者
2006 年伊利诺伊邮报

```

所以，洛杉矶时代是在洛杉矶地区购买，所以也出现了——你是怎么做到的？将一组结果信息合并到另一组中？

抱歉，这是一个糟糕的解释，R。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-20T02:12:20.197

好的，我想我遵循您的需要。我认为这样的事情应该可以解决问题。

```
SELECT Publication.PublicationID, Publication.NameAbbrev
FROM Publication
UNION ALL
SELECT AreaBuy.AreaBuyID, AreaBuy.NameAbbrev
FROM AreaBuy
INNER JOIN PublicationAreaBuy
ON AreaBuy.AreaBuyID = PublicationAreaBuy.AreaBuyID
INNER JOIN Publication
ON PublicationAreaBuy.PublicationID = Publication.PublicationID 
```

根据需要添加 DateCreated 或任何其他判别式的挂钩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T02:12:33.147

很难说，解释不是很清楚，但你肯定想使用连接。通过阅读您的问题，这是我认为您想要的最接近的。

```
SELECT P.PublicationID, P.Name
From Publication P
LEFT JOIN PublicationAreaBuy AS PAB
ON P.PublicationID = PAB.PublicationID
LEFT JOIN AreaBuy AS AB 
ON PAB.AreaBuyID = AB.AreaBuyID
WHERE P.SignedUp > @firstDayOfYear
OR Not AB.AreaBuyID is NULL 
```

这将返回一年中第一天之后注册的所有出版物的 PublicationID 和出版物名称，或者如果它们在 PublicationAreaBuy 表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T02:50:52.163

这实际上是一个支点，但最容易将其表示为`UNION`两个不同集合中的一个——出版物集合和它们所链接的区域集合。正常`UNION`的重复数据集，所以通常会慢一点。A`UNION ALL`可能会产生多个区域是两个出版物在同一个区域，所以`DISTINCT`如果你使用，你需要 a 停止那里的重复`UNION ALL`：

```
SELECT 'Publication' AS RowType
    ,Publication.PublicationID AS idNum
    ,Publication.NameAbbrev AS name
FROM Publication
WHERE Publication.SignedUp >= '1/1/2009'

UNION ALL

SELECT DISTINCT 'Area' AS RowType
    ,AreaBuy.AreaBuyID AS idNum
    ,AreaBuy.NameAbbrev AS name
FROM AreaBuy
INNER JOIN PublicationAreaBuy
    ON AreaBuy.AreaBuyID = PublicationAreaBuy.AreaBuyID
INNER JOIN Publication
    ON PublicationAreaBuy.PublicationID = Publication.PublicationID
WHERE Publication.SignedUp >= '1/1/2009' 
```

或使用`UNION`：

```
SELECT 'Publication' AS RowType
    ,Publication.PublicationID AS idNum
    ,Publication.NameAbbrev AS name
FROM Publication
WHERE Publication.SignedUp >= '1/1/2009'

UNION

SELECT 'Area' AS RowType
    ,AreaBuy.AreaBuyID AS idNum
    ,AreaBuy.NameAbbrev AS name
FROM AreaBuy
INNER JOIN PublicationAreaBuy
    ON AreaBuy.AreaBuyID = PublicationAreaBuy.AreaBuyID
INNER JOIN Publication
    ON PublicationAreaBuy.PublicationID = Publication.PublicationID
WHERE Publication.SignedUp >= '1/1/2009' 
```

在支持公用表表达式的 SQL 方言中，您可以通过以下方式避免重复更复杂的业务逻辑：

```
WITH SelectedPubs AS (
    SELECT Publication.PublicationID
        ,Publication.NameAbbrev
    FROM Publication
    WHERE Publication.SignedUp >= '1/1/2009'
)
SELECT 'Publication' AS RowType
        , SelectedPubs.PublicationID AS idNum
        ,SelectedPubs.NameAbbrev AS name
FROM SelectedPubs

UNION

SELECT 'Area' AS RowType
    ,AreaBuy.AreaBuyID AS idNum
    ,AreaBuy.NameAbbrev AS name
FROM AreaBuy
INNER JOIN PublicationAreaBuy
    ON AreaBuy.AreaBuyID = PublicationAreaBuy.AreaBuyID
INNER JOIN SelectedPubs
    ON PublicationAreaBuy.PublicationID = SelectedPubs.PublicationID 
```

# eclipse - eclipse中带有maven的java代理

> ID：1020731
> 
> 赞同：2
> 
> 时间：2009-06-20T01:52:18.583
> 
> 标签：eclipse, maven-2, aspectj

我在 Eclipse 中将 aspectjweaver 作为 javaagent 运行。我使用 maven 来管理我的依赖项，但我需要在命令行上放置 aspectjweaver 的路径。推荐的方法是什么？在我的工作区中保存另一个副本？引用我的本地存储库？

谢谢，

杰夫

# fortran - 重温：Fortran 程序中的堆栈溢出

> ID：1020734
> 
> 赞同：4
> 
> 时间：2009-06-20T01:54:26.897
> 
> 标签：fortran, stack-overflow

在 Compac Fortran 中执行以下代码时出现堆栈溢出。专线：

```
DIMENSION IZ(NX,NY),VX(NX-1,NY-1),VY(NX-1,NY-1),VZ(NX-1,NY-1) 
```

我正在做的是从参数文件中读取 NX、NY、DX、DY。

有什么建议么？

```
 PARAMETER(NGMAX=30000)
       INTEGER NX,NY,DX,DY
       OPEN(6,FILE='MGSTAOriggroup15.asc',STATUS='old')
       OPEN(7,FILE='Gravity.asc',STATUS='old')
       OPEN(8,FILE='Gravity200.nor',STATUS='old')
       OPEN(9,FILE='linana.para',STATUS='old')
       OPEN(10,FILE='MGSTAOriggroup15coord.dat',STATUS='unknown')
       OPEN(12,FILE='MGSTAOriggroup15ncoord.dat',STATUS='unknown')
       OPEN(11,FILE='linana.fsn',STATUS='unknown')
       READ(9,*) NX,NY,DX,DY
       CALL ANALYSIS(NX,NY)
       Close(6)
       Close(7)
       Close(8)
       Close(9)
       Close(10)
       Close(11)
       Close(12)
C
       STOP 
     END
C 
      SUBROUTINE ANALYSIS(NX,NY)
      INTEGER NX,NY,DX,DY
      COMMON/COM1/ DX,DY
      PARAMETER(NGMAX=30000)
      DIMENSION KO(NGMAX)
      DIMENSION XLS(NGMAX,100),XLE(NGMAX,100),
     &          YLS(NGMAX,100),YLE(NGMAX,100)
      DIMENSION IZ(NX,NY),VX(NX-1,NY-1),VY(NX-1,NY-1),VZ(NX-1,NY-1)
      """"""""""""""""""""""""""""""""""""""""""""
      To the end 
```

注意：从 更改`(NGMAX=30000)`为`(NGMAX=30)`没有帮助。

是的，我已将 NGMAX 的所有实例更改为 30。

下面列出了新版本。

* * *

```
 INTEGER NX,NY,DX,DY
    PARAMETER(NGMAX=30)
      COMMON /CM1/ FX(NGMAX),FY(NGMAX),FZ(NGMAX),FR(NGMAX),IL(NGMAX)
      COMMON /CM2/ JST(NGMAX),KST(NGMAX),JDP(NGMAX),KDP(NGMAX)
      COMMON /CM3/ XC(NGMAX),YC(NGMAX),ZC(NGMAX),KTYP(NGMAX)
      COMMON /CM4/ A(4,4),B(4),U(4)
    COMMON /CM5/ KO(NGMAX)
      COMMON /CM6/ XLS(NGMAX,10),XLE(NGMAX,10),
     &          YLS(NGMAX,10),YLE(NGMAX,10)
      OPEN(6,FILE='MGSTAOriggroup15.asc',STATUS='old')
      OPEN(7,FILE='Gravity.asc',STATUS='old')
      OPEN(8,FILE='Gravity200.nor',STATUS='old')
      OPEN(9,FILE='linana.para',STATUS='old')
      OPEN(10,FILE='MGSTAOriggroup15coord.dat',STATUS='unknown')
      OPEN(12,FILE='MGSTAOriggroup15ncoord.dat',STATUS='unknown')
      OPEN(11,FILE='linana.fsn',STATUS='unknown')
      READ(9,*) NX,NY,DX,DY
    CALL ANALYSIS(NX,NY)
      Close(6)
      Close(7)
      Close(8)
      Close(9)
      Close(10)
      Close(11)
      Close(12)
C
       STOP 
     END
C 
      SUBROUTINE ANALYSIS(NX,NY)
    INTEGER NX,NY,DX,DY
      COMMON/COM1/ DX,DY
    PARAMETER(NGMAX=30)
      COMMON /CM1/ FX(NGMAX),FY(NGMAX),FZ(NGMAX),FR(NGMAX),IL(NGMAX)
      COMMON /CM2/ JST(NGMAX),KST(NGMAX),JDP(NGMAX),KDP(NGMAX)
      COMMON /CM3/ XC(NGMAX),YC(NGMAX),ZC(NGMAX),KTYP(NGMAX)
      COMMON /CM4/ A(4,4),B(4),U(4)
    COMMON /CM5/ KO(NGMAX)
      COMMON /CM6/ XLS(NGMAX,10),XLE(NGMAX,10),
     &          YLS(NGMAX,10),YLE(NGMAX,10)
      DIMENSION IZ(NX,NY),VX(NX-1,NY-1),VY(NX-1,NY-1),VZ(NX-1,NY-1) 
```

我很抱歉：我整天都在编写代码，最后它工作了。但是，我们不需要声明 NX 和 NY。我想从参数文件中读取这些参数。代码如下：

* * *

```
 PARAMETER(NX=322,NY=399,NGMAX=30000)
C I need to change NX and NY to read from the parameter file
      CHARACTER infile1*80,infile2*80,infile3*80,outfile1*80
     &,outfile2*80,outfile3*80
      DIMENSION KO(NGMAX)
      DIMENSION XLS(NGMAX,100),XLE(NGMAX,100),
     &          YLS(NGMAX,100),YLE(NGMAX,100)
      DIMENSION IZ(NX,NY),VX(NX-1,NY-1),VY(NX-1,NY-1),VZ(NX-1,NY-1)
      DIMENSION FX(NGMAX),FY(NGMAX),FZ(NGMAX),FR(NGMAX),IL(NGMAX)
      DIMENSION JST(NGMAX),KST(NGMAX),JDP(NGMAX),KDP(NGMAX)
      DIMENSION XC(NGMAX),YC(NGMAX),ZC(NGMAX),KTYP(NGMAX)
      DIMENSION A(4,4),B(4),U(4)
C
    CALL getenv('INFILE1',infile1)
    CALL getenv('INFILE2',infile2)
    CALL getenv('INFILE3',infile3)
    CALL getenv('OUTFILE1',outfile1)
    CALL getenv('OUTFILE2',outfile2)
    CALL getenv('OUTFILE3',outfile3)
    OPEN(1,FILE='Alaa1.para',STATUS='old')
    READ(1,*)DX,DY,infile1,infile2,infile3,outfile1,outfile2
     &,outfile3
C
       OPEN(6,FILE=infile1,STATUS='old')
       OPEN(7,FILE=infile2,STATUS='old')
       OPEN(8,FILE=infile3,STATUS='old')
       OPEN(10,FILE=outfile1,STATUS='unknown')
       OPEN(12,FILE=outfile2,STATUS='unknown')
       OPEN(11,FILE=outfile3,STATUS='unknown')

       TO THE END 
```

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T02:05:36.310

听起来子程序`ANALYSIS`正在根据传递给它的参数（`NX`和`NY`）在堆栈上分配空间。如果这些值太大，则堆栈上可能没有足够的空间来分配数组。

您可以做的是打印出 和 从文件中读取的值，`NX`以`NY`查看`linana.para`它们是否对您的应用程序有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-28T22:10:13.240

看起来你的代码是 Fortran77 如果是这样的话，下面应该是有意义的，如果不是它可能会给你一些线索。

在 Fortran77 语言标准中没有动态内存分配支持，许多编译器确实支持它，但使用编译器特定的扩展。您的代码不会触发任何类似这样的扩展记忆。

做你想做的事情的一种方法是生成一个主程序，该程序将声明数组空间，然后将数组作为参数传递给子程序。该主程序将被编译并与其余代码链接。每组值都会产生一个新的主程序。

例如 - 对于 NX=2456 & NY=789

```
 PROGRAM MAIN
  INTEGER NX, NY
  DIMENSION IZ(2456,789),VX(2455,788),VY(2455,788),VZ(2455,788)
  NX=2456
  NY=789
  CALL ANALYSIS(NX,NY,IZ,VX,VY,VZ)
  STOP
  END

  SUBROUTINE ANALYSIS(NX,NY,IZ,VX,VY,VZ)
  INTEGER NX,NY,DX,DY
  DIMENSION IZ(NX,NY),VX(NX-1,NY-1),VY(NX-1,NY-1),VZ(NX-1,NY-1) 
```

...返回结束

我不记得了，但可能可以在主程序中使用参数语句，因此您可以完全参数化上面的主程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T02:22:25.497

假设异常发生在您提到的那一行，那么您的程序堆栈对于分配在其上的变量来说不够大。您需要在编译器中找到该标志以增加程序的默认堆栈分配。或者，如果您根本不使用递归，您可以将这些变量设为全局变量，这样它们就不会分配到堆栈上。

请注意您分配的大小：

```
PARAMETER(NGMAX=30000)
DIMENSION KO(NGMAX)
DIMENSION XLS(NGMAX,100),XLE(NGMAX,100),YLS(NGMAX,100),YLE(NGMAX,100)
DIMENSION IZ(NX,NY),VX(NX-1,NY-1),VY(NX-1,NY-1),VZ(NX-1,NY-1) 
```

您正在为`real`四个数组`XLS`、`XLE`、`YLS`和`YLE`. 那是 12,000,000 个值。假设 32 位值，它是 48 Meg 的内存。但我隐约记得在某些平台上，实数是 80 位？在这种情况下，它将是 120 Meg 的内存。

你*真的*需要你的数组在一维上有 30,000 个元素吗？如果没有，减少该分配可能会对您有所帮助。

查看您正在使用的 FORTRAN 编译器的编译器选项。我记得 VAX/VMS FORTRAN 编译器有一个命令行选项可以使*所有*变量都静态化，也就是说不在堆栈上分配。假设您可以保证不会进行任何递归，这可能是解决问题的最快方法。

另一个选择是将所有大型数组放入一个 COMMON 块中，但请注意，一个公共块中的数组不能动态调整大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T02:27:31.570

呵呵。嗯，从技术上讲，这可能属于 ServerFault，因为它是一个操作系统问题，但我认为那里也没有人会回答那里的 VMS 问题。对我和 VMS 来说已经有一段时间了，对 FORTRAN 来说甚至更长，但我会试一试......

好的，这就是你所得到的：ANALYSIS 子例程有 4 个数组，每个数组有 (30,000*100)=3,000,000 个单元格，每个单元格是 12M 单元格或每个 8 字节（我认为？）为 72Mbytes。再加上整数数组 IZ 和实数数组 VX、VY 和 VZ 占用的空间，我无法估计，因为我不知道 NX 和 NY 的最大值是多少。

无论如何，VAX 至少有 144,000 页或 Alpha 至少有 24,000 页（加上其他 4 个数组）。您的进程地址表需要至少是该地址表的 2 倍（实际上稍微多一点），因为用户堆栈只得到其中的一半。

所以，转到命令提示符并输入“SHOW PROC/MEM”并告诉我它说的是什么（我想我说得对）。

注意：NX、NY 只是 DIMENSION 的参数，它是占用堆栈的数组。

使数组全局可能不起作用，因为堆和静态分配空间并不比堆栈大。

好的，我看到你的最大 NX，NY 值是 5,000。那是另一个 4*25,000,000 或 100,000,000。每个 8 字节为 800MB 加上上面的 72MB。坏消息是，无论 VMS 进程设置如何，VAX 在架构上都限制为 1GB 的用户堆栈，所以我们希望浮点数是 4 字节（而不是 8 字节）或者您使用的是 Alpha。

# python - Google App Engine 中的自定义身份验证

> ID：1020736
> 
> 赞同：37
> 
> 时间：2009-06-20T01:56:48.560
> 
> 标签：python, google-app-engine, authentication

有谁知道或知道我可以学习如何使用 Python 和 Google App Engine 创建自定义身份验证过程的地方？

我不想使用 Google 帐户进行身份验证，并且希望能够创建自己的用户。

如果不是专门针对 Google App Engine，任何有关如何使用 Python 和 Django 实现身份验证的资源？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-20T03:03:14.293

django 1.0 今天在 Google AppEngine 上更新了。但是您可以像其他任何事情一样进行用户身份验证，因为它是如此庞大，所以您无法真正使用会话。

[http://gaeutilities.appspot.com/](http://gaeutilities.appspot.com/)中有一个会话实用程序

[http://gaeutilities.appspot.com/session](http://gaeutilities.appspot.com/session)

[http://code.google.com/p/gaeutilities/](http://code.google.com/p/gaeutilities/)

或者，

您必须创建自己的用户表并散列或加密密码，然后可能创建一个仅使用令牌散列或 uuid cookie 模拟会话的令牌系统（无论如何，会话只是 cookie）。

我已经用基本的 google.webapp 请求和响应头实现了一些。我通常使用 uuids 作为主键作为用户 ID，然后加密用户密码并让他们的电子邮件进行重置。

如果您想授权用户对数据进行外部访问，您可以查看 OAuth 以进行应用程序访问。

如果您只想通过 id 存储数据并且它更面向消费者，则可能只需使用 openid 之类的 stackoverflow，然后将配置文件数据附加到该标识符，例如 django 配置文件（[http://code.google.com/p/openid-selector /](http://code.google.com/p/openid-selector/)）。

django 1.0 今天刚刚在 GAE 上发布，但我认为存在同样的问题，没有会话，你必须真正创建自己的存储会话数据。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-25T14:54:34.477

这是一个开箱即用的解决方案，效果很好： [http ://code.scotchmedia.com/engineauth/docs/index.html](http://code.scotchmedia.com/engineauth/docs/index.html)

它内置了对 Facebook、Google+、Twitter、LinkedIn、GitHub 和 OpenId 的支持（通过 Google App Engine）。

您只需要将用户重定向到`/auth/facebook`或`/auth/google`等等（此 url 是可自定义的）。

它还实现了两个类：`User`并且`UserProfile`，every`User`是您的应用程序中的唯一帐户，可能与一个或多个相关`UserProfiles`- 哪个是唯一帐户`User`必须登录到您的应用程序的登录策略（如果不清楚，那是因为我的英语是非常糟糕，[文档](http://code.scotchmedia.com/engineauth/docs/index.html)解释得更好）。

PS：文档不是很完整，但代码非常简单，简短且不言自明。[此外，这里](https://groups.google.com/forum/#!topic/webapp2/Ui5FEFVnyIY)还有一个讨论，其中作者对困惑和初学者的问题提供了各种答案。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-20T03:06:55.157

[OpenID 消费者](http://code.google.com/p/google-app-engine-samples/source/browse/#svn/trunk/openid-consumer)（优秀的“应用程序引擎示例”开源项目的一部分）目前可以工作（尽管其 README 中的警告是旧的），并且允许您使用 OpenID 进行用户登录。

django 的[身份验证](http://docs.djangoproject.com/en/dev/topics/auth/)也可以通过例如[这个项目](http://code.google.com/p/google-app-engine-django/)使用（至少是`users`一部分，不一定`groups`，`permissions`尽管他们可能随时让他们工作）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-02-08T03:51:34.603

我看到每次您搜索“应用程序引擎中的自定义登录”时都会在谷歌中弹出这个，所以我决定给出一个一直为我服务的答案。这是示例应用程序 [https://github.com/fredrikbonander/Webapp2-Sample-Applications](https://github.com/fredrikbonander/Webapp2-Sample-Applications)

这使用

1.  webapp2（已经在 GAE 1.6.2 中）
2.  Jinja2（已经在 GAE 1.6.2 中）

Webapp2 似乎是 GAE 的最佳选择（建立在 webapp 之上，因此是未来的证明），因此使用 GAE 原生支持的框架进行身份验证是一个好主意。还有许多其他框架，但必须在用户部分进行大量黑客攻击才能使其正常工作。对于想要建立一个“稳定”网站的人来说，这样的黑客工作是非常不可取的。

我也意识到现在已经有了对 GAE 的 SQL 支持，并且原生支持 django。我们都知道 django 内置了用户认证系统。虽然，我认为，尤其是在云世界中，NoSQL 才是未来。我相信将来会有一个和 django 一样好的 NoSQL 框架。但这就是我，你的要求可能需要别的东西。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-03-19T12:44:15.920

这是一篇优秀且相对较新的（2013 年 1 月）博客文章，标题为[Google App Engine 上的使用 webapp2 进行用户身份验证](http://blog.abahgat.com/2013/01/07/user-authentication-with-webapp2-on-google-app-engine/)，以及相关的[GitHub 存储库：`abahgat/webapp2-user-accounts`](https://github.com/abahgat/webapp2-user-accounts)。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-08-19T09:11:06.867

看看 Django 的[app-engine-patch](http://code.google.com/p/app-engine-patch/)（我从你的问题中假设你首选的框架）。它提供对 gae 的身份验证。

或者，看看[web2py](http://www.web2py.com)。它是一个基于 Python 的框架，适用于 GAE 和关系数据库。它的内置 Auth 对象为用户、组和权限提供。

但是，它并没有提供对 BigTable 的无限制访问，而是提供了关系功能的一个子集（例如，BigTable 不支持 Joins 并且 web2py [还] 不支持 BigTable 模型）。

Web2py 和 Django 社区都在讨论对 BigTable 的支持。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-07-02T22:45:02.413

我用谷歌搜索了一段时间的应用引擎自定义身份验证系统。我最终决定在应用引擎上运行烧瓶。[我使用这个样板在应用引擎https://github.com/kamalgill/flask-appengine-template/](https://github.com/kamalgill/flask-appengine-template/)上运行烧瓶和这个烧瓶身份验证扩展[http://pypi.python.org/pypi/Flask-Auth/](http://pypi.python.org/pypi/Flask-Auth/)附带即插即用谷歌应用引擎支持。我认为flask也有一个非常好的oAuth库，所以最终添加facebook和twitter登录会很容易

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-25T15:10:52.373

除了所有其他很棒的答案之外，我还要补充一点，[Facebook](https://developers.facebook.com/docs/authentication/)、[Twitter](https://dev.twitter.com/docs/auth/oauth/single-user-with-examples)和[github](http://github.com)都提供 OAuth 机制，您可以将其用作应用程序的统包身份验证支持。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-28T14:21:57.357

看看我正在与 coto 合作的这个项目：[https](https://github.com/coto/gae-boilerplate) ://github.com/coto/gae-boilerplate 它包括一个功能齐全的自定义身份验证系统等等。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-08-23T17:34:18.947

另一种选择是[烧杯模块](http://beaker.readthedocs.org/en/latest/index.html)。客户端会话的 AES 加密很好。

# javascript - 估计的搜索结果数 Google 搜索 API

> ID：1020741
> 
> 赞同：4
> 
> 时间：2009-06-20T02:01:15.820
> 
> 标签：javascript, google-search-api, google-ajax-api

当您搜索 google 时，它​​会估计搜索结果的数量，例如

> 结果 1 - 10 约 103,000,000 为 hello world

如何以编程方式获得数字 103,000,000？

我对结果不感兴趣，只对这个数字感兴趣，而且我需要一次进行大约 100 次这样的搜索，所以网页报废不是一种选择，因为谷歌倾向于阻止这种事情。

我已经看到了您可以使用 google soap API 来执行此操作的解决方案，但这不再是一种选择，因为它已被弃用并且它们不再提供 API 密钥，而且 AJAX API 似乎没有提供此字段：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-14T14:30:27.530

返回搜索对象时，它将具有一个属性“results”作为包含结果对象的数组，以及一个包含具有估计结果计数属性的游标对象的“游标”属性。那是你追求的家伙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-30T04:51:03.367

我使用 C# 和 Bing 而不是 Google 完成了这项工作。你可以在这里找到答案：

[Google Search API - 结果数](https://stackoverflow.com/questions/4231663/google-search-api-number-of-results)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-06-20T02:26:50.513

也许不是一个选择，也许不允许，甚至可能无法正常工作，但是只进行这 100 次搜索并使用不同的 Google 服务器并不断更改您的标识（浏览器、cookie 等）并在两次搜索之间留出足够的时间怎么样？例如，如果我们在 google.com、google.net、google.co.uk 或 google.jp 上进行 nslookup，我们会得到几个不同的服务器（74.125.95.104、74.125.91.104、72.14.203.104 用于 google.jp） . 对其他服务器做同样的事情，你会很容易地想出 30-40 台这样的服务器，甚至更多。如果您每轮只在服务器上进行 1 或 2 次搜索，这可能是最好的。祝你好运！

**更新**

刚刚查看了 AjaxSearch 的“ [Flash 和其他非 Javascript 环境](http://code.google.com/apis/ajaxsearch/documentation/#fonje)”，似乎有一个您可能感兴趣的名为“estimatedResultCount”的字段（包括 php、flash 的代码示例）。一个简短的说明：对不起，伙计们，我试图对我的答案不可知论，而不是通过不给出可能的选择来审查自己。

# text - 如何调整包含嵌入字体的文本的启用比例 9 网格的 MovieClip？

> ID：1020744
> 
> 赞同：0
> 
> 时间：2009-06-20T02:04:25.707
> 
> 标签：text, flash, scaling, scale9grid

这可能很简单，因为它是一种设计问题模式而不是开发（想想绘制 UI 图形而不是 OOD :)）我已经意识到我已经有一段时间没有使用 Flash IDE 进行设计了。我创建了一个简单的圆角按钮，由以下部分组成：

1.  背景剪辑
2.  基色剪辑
3.  一个文本字段
4.  一个亮点

这就是我忘记的内容：“还要记住，即使设置了 scale9Grid 属性，所有文本和子影片剪辑也会正常缩放，而不管它们位于 scale9 网格的哪个区域。” 来自[Sephiroth 的旧式 scale 9 教程](http://www.sephiroth.it/tutorials/flashPHP/scale9/)。

我已经为所有的影片剪辑设置了一个 9 级网格，并且按钮现在几乎可以调整大小。我的文本字段是动态的。如果未嵌入字体，则按钮会按我的预期缩放，但如果我嵌入字体（我需要），则文本会缩放而不考虑比例 9 网格。

有没有办法制作包含嵌入字体的动态 TextField 的 MovieClip，使用比例 9 网格正确缩放？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-20T04:58:53.143

不直接，不。然而，解决此问题的最简单方法是将背景制作为自己的剪辑，并将其和文本字段放在 MovieClip 中的单独层中。

这种使用 next clips 很常见（例如，内置组件一直使用它）

# php - FOUND_ROWS() 不断返回 0

> ID：1020745
> 
> 赞同：3
> 
> 时间：2009-06-20T02:05:14.737
> 
> 标签：php, select, count

```
$result = $db_con->query("SELECT SQL_CALC_FOUND_ROWS * FROM users LIMIT 0,10");

$count_result = $db_con->query("SELECT FOUND_ROWS() as totalcount");
$row = $count_result->fetch_assoc();
$total = $row['totalcount']; 
```

即使 $result 包含其中的所有用户行，$total 仍然返回 0。

```
ini_set("mysql.trace_mode", "0"); 
```

我通过在此处搜索类似的 Q 发现了此设置，但它并没有解决我的问题。

当我在我的 MySQL 客户端中使用 2 个 select 语句时，它总是输出正确的计数。只是似乎无法弄清楚如何让它在我的 php 页面上运行。

PHP 版本：5.2.5 build 6 MySQL 版本：5.1.30

注意：我在此处提供的代码并未用于我的实际项目，但是，它确实说明了我无法检索总计数的问题。这段代码，从我读过的关于 found_rows() 的内容来看，应该可以工作，但不能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T02:21:30.087

**`LIMIT`需要使 found_rows() 正常工作**

在查询的末尾添加一个 LIMIT，即。

```
SELECT SQL_CALC_FOUND_ROWS * FROM users LIMIT 0,10; 
```

[http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows)

`FOUND_ROWS()`-- 对于带有 LIMIT 子句的 SELECT，如果没有 LIMIT 子句，将返回的行数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T02:50:35.130

在 php.net 上，我发现有人可能有同样的问题。他说的是可能发生的竞争条件：[php.net](http://us2.php.net/manual/en/function.mysql-num-rows.php#85654)。基本上，他通过以减慢速度为代价临时锁定表来解决这个问题。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-06-20T02:20:57.093

我不确定您使用的是什么数据库库，但看起来您正在尝试从 mysql 数据库中计算 php 中的 select 语句中的行数。

您是否尝试过查看它是否适用于 php 中内置的 mysql 数据库函数？

```
$count_result = mysql_query("SELECT COUNT(*) as totalcount FROM users");
$row = mysql_fetch_array($count_result);

$total = $row['totalcount']; 
```

# apache-flex - 使用 grails 连接到 flex web 服务

> ID：1020747
> 
> 赞同：0
> 
> 时间：2009-06-20T02:05:47.810
> 
> 标签：apache-flex, web-services, json, grails, rest

我有一个 grails 应用程序，它将将 html 页面呈现为 pdf 文件，我有一个 flex 应用程序位于服务器上，它将接受 REST 参数并根据参数构建一个图形（将采用 JSON 格式）。我想要做的是使用我的参数调用 flex 应用程序并让 flex 应用程序创建图形，渲染图形的 JPEG，然后将图像发送回 grails。换句话说，我想放置一个 HTML img src="http://flex-app-location/graphing-tool.swf?param=1¶m=2¶m=3"/ 将图像直接呈现到页面，以便我在 grails 中的 PDF 插件会将其呈现为 PDF。

我知道如何在 Flex 中渲染图像，但我不知道如何通过 HTTP 将此图像推回以便可以将其渲染为图像数据。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-20T10:08:30.010

你知道有一个用于 Grails 的 Flex 插件吗？[http://grails.org/Flex+Plugin](http://grails.org/Flex+Plugin) 它允许您将 grails 服务公开为 Flex 远程处理目的地。

所以我想我会做类似的事情：

*   在 Flex 中构建位图
*   将其编码为 JPEG（参见 JPEGEncoder 类）。
*   将此 ByteArray 发送到接受 byte[] 参数的远程 grails 服务（Flex 插件使用 BlazeDS，因此您的 AS3 ByteArray 对象将转换为 Java 字节数组）

PS：编码也可以在服务器上完成，特别是如果您的图像尺寸非常大并且您不关心通过网络发送大量数据

# class - 面向对象编程中什么是公共的、私有的和受保护的？

> ID：1020749
> 
> 赞同：105
> 
> 时间：2009-06-20T02:08:31.203
> 
> 标签：class, oop, definition, access-modifiers

面向对象编程中什么是公共的、私有的和受保护的？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2009-06-20T02:23:26.400

它们是**访问修饰符**，帮助我们实现[封装](http://en.wikipedia.org/wiki/Information_hiding)（或信息隐藏）。它们告诉编译器哪些其他类应该有权访问正在定义的字段或方法。

**`private`**- 只有当前类才能访问该字段或方法。

**`protected`**- 只有该类的当前类和子类（有时也包括同包类）才能访问该字段或方法。

**`public`**- 任何类都可以引用字段或调用方法。

*这假定这些关键字用作类定义中的字段或方法声明的一部分。*

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-20T02:11:31.027

它们不是真正的概念，而是在 C++ 和 Java 等流行语言中往往出现的特定关键字（语义略有不同）。

本质上，它们旨在允许类限制对成员（字段或函数）的访问。这个想法是，在另一种类型中允许访问的类型越少，可以创建的依赖项就越少。这允许更容易地更改访问的对象，而不会影响引用它的对象。

从广义上讲，public 意味着每个人都可以访问，private 意味着只允许同一类的成员访问，protected 意味着也允许子类的成员。但是，每种语言都为此添加了自己的东西。例如，C++ 允许您非公开继承。在Java中，还有一个默认的（包）访问级别，还有关于内部类的规则等等。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-04-11T11:53:45.000

这三个都是在类中使用的访问修饰符和关键字。public 声明的任何东西都可以被类内或类外的任何对象使用，private 中的变量只能被类内的对象使用，不能通过直接访问来更改（因为它可以通过友元函数等函数来更改） .任何在受保护部分下定义的东西都可以被该类及其刚刚派生的类使用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-08-06T20:51:15.253

如上所述，但在质量上：

```
private - least access, best encapsulation
protected - some access, moderate encapsulation
public - full access, no encapsulation 
```

您提供的访问权限越少，从您的对象中泄漏的实现细节就越少。这种泄漏的减少意味着在不破坏对象客户端的情况下更改对象的实现方式方面具有更大的灵活性（也称为“松散耦合”）。这是一个真正需要理解的基本问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-20T02:10:57.673

公共项目是可以从任何其他类访问的项目。您只需要知道它是什么对象，就可以使用点运算符来访问它。受保护意味着一个类及其子类可以访问该变量，但不能访问任何其他类，它们需要使用 getter/setter 对变量执行任何操作。私有意味着只有该类可以直接访问变量，其他所有内容都需要方法/函数来访问或更改该数据。希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-20T09:44:36.377

总而言之，在面向对象编程中，一切都被建模为类和对象。类包含属性和方法。public、private 和 protected 关键字用于指定从其他类或其他 .dll 甚至其他应用程序对类的这些成员（属性和方法）的访问。

# php - SWFUpload - 有人熟悉吗？

> ID：1020750
> 
> 赞同：0
> 
> 时间：2009-06-20T02:08:39.130
> 
> 标签：php, swfupload

我正在尝试使用 SWFUpload ( [http://swfupload.org](http://swfupload.org) )，我想知道在 PHP 中，它的数据是否仍然在 $_FILES 数组中。如果没有，它会去哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-20T02:13:47.997

SWFUploader 使用 HTTP POST 上传文件。因此，从 PHP 的角度来看，它与随文件一起发布没有什么不同。

该文件将在 $_FILES 中，额外的 postvars 将在 $_POST 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-02T05:37:46.100

我将发布一个使用 swfupload 和 PHP 的完整示例。我相信 swfupload 文档对初学者不是很有帮助，这个例子可以帮助很多人。您需要下载的内容如下

## 首先复制/创建所有必要的文件

*   下载 v2.2.xy 内核和示例
*   然后创建以下文件夹结构

创建一个名为 swfupload 的文件夹并将以下文件从 2.2.xy 核心复制到其中

*   swfupload.js（来自核心根文件夹）
*   swfupload swf 文件（来自 core/Flash 文件夹）

将以下文件从 2.2.x demos 文件夹复制到我们的 swfupload 文件夹中

*   default.css（来自 2.2.xy 示例/演示/css）
*   在此处复制 2.2.xy samples/demos/simpledemo/js 文件夹（原样）
*   在此处复制 2.2.xy samples/demos/images 文件夹（原样）

现在创建一个 PHP 脚本来接收 swfupload 文件夹中的文件（称为 receiver.php）。现在，您的文档根目录中有一个名为 swfupload 的文件夹，其中包含所有必需的文件。

## 使用 swfupload 控件创建测试 html 页面

```
 <!-- file upload component  -->
    <div class="fieldset flash" id="fsUploadProgress">
        <span class="legend">Upload Queue</span>
     </div>
     <div id="divStatus">No Files Uploaded</div>
      <div>
          <span id="spanButtonPlaceHolder"></span>
      <input id="btnCancel" type="button" value="Cancel All Uploads" onclick="swfu.cancelQueue();" disabled="disabled" style="margin-left: 2px; font-size: 8pt; height: 29px;" />
      </div> 
```

## 包含与 swfupload 控件交互的 javascript

现在您必须在我们的测试 html 中包含 swfupload css 文件和所需的 javascript 文件。我们还必须初始化和配置与 swfupload 控件交互所需的 js。

```
<link href="/swfupload/default.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/swfupload/swfupload.js"></script>
<script type="text/javascript" src="/swfupload/js/swfupload.queue.js"></script>
<script type="text/javascript" src="/swfupload/js/fileprogress.js"></script>
<script type="text/javascript" src="/swfupload/js/handlers.js"></script>

<script type="text/javascript">
            //attach events
            $(document).ready(function(){
                $("a.removeMedia").live("click", function(event){
                    event.preventDefault();
                    var docId = $(this).attr("id");
                    //remove flexi data
                    webgloo.gMedia.table.removeRow(docId);
                }) ;

                //initialize gMedia table with documentId coming from server
                webgloo.gMedia.debug = false ;
                webgloo.gMedia.table.load();

            });

            //swffileupload related javascript
            var swfu;

            window.onload = function() {
                var settings = {
                    flash_url : "/swfupload/swfupload.swf",
                    upload_url: "/swfupload/receiver.php",
                    post_params: {"PHPSESSID" : "<?php echo session_id(); ?>"},
                    file_size_limit : "10 MB",
                    file_types : "*.*",
                    file_types_description : "All Files",
                    file_upload_limit : 100,
                    file_queue_limit : 0,
                    custom_settings : {
                        progressTarget : "fsUploadProgress",
                        cancelButtonId : "btnCancel"
                    },
                    debug: false,

                    // Button settings
                    button_image_url: "/swfupload/images/TestImageNoText_65x29.png",
                    button_width: "65",
                    button_height: "29",
                    button_placeholder_id: "spanButtonPlaceHolder",
                    button_text: '<span class="theFont">Upload</span>',
                    button_text_style: ".theFont { font-size: 16; }",
                    button_text_left_padding: 12,
                    button_text_top_padding: 3,

                    // The event handler functions are defined in handlers.js
                    file_queued_handler : fileQueued,
                    file_queue_error_handler : fileQueueError,
                    file_dialog_complete_handler : fileDialogComplete,
                    upload_start_handler : uploadStart,
                    upload_progress_handler : uploadProgress,
                    upload_error_handler : uploadError,
                    upload_success_handler : uploadSuccess,
                    upload_complete_handler : uploadComplete,
                    queue_complete_handler : queueComplete  // Queue plugin event
                };

                swfu = new SWFUpload(settings);
            };

        </script> 
```

请查看您需要在设置中进行的更改。现在我们准备点击 PHP 脚本。我们将点击 PHP 脚本，并且 PHP 脚本将返回一些我们的测试 html 可以使用的响应（例如 doc 位置，或者 doc_id，如果您存储在数据库中，名称，大小，mime）等可以返回。

## 用于服务器端处理的 PHP 脚本

如果您知道如何在 PHP 中处理文件，那么您唯一需要知道的是 swfupload 发送的文件元素名称是 Filedata。剩下的就是细节。通过 $_FILES 处理您的文件上传后，您的接收器脚本可以返回一些数据，这些数据可用于使用文档详细信息更新您的 html。swfupload 论坛中包含的 PHP 上传示例是纯意大利面条。如果您想查看@面向对象的模型，请查看@以下文件

[http://code.google.com/p/localo/source/browse/job/web/swfupload/receiver.php](http://code.google.com/p/localo/source/browse/job/web/swfupload/receiver.php) http://code.google.com/p/localo/source/browse/lib/webgloo/common /Upload.php [http://code.google.com/p/localo/source/browse/lib/webgloo/job/FileUpload.php](http://code.google.com/p/localo/source/browse/lib/webgloo/job/FileUpload.php)

这仅用于说明目的。该代码将无法正常工作，因为它依赖于我的库。

## 连接 PHP 脚本将数据返回到包含 swfupload 控件的 html

这是最后一步。服务器脚本在成功上传时返回的内容应由 swfupload javascript 处理程序之一处理以更新 html（例如将返回的文件上传 URI 存储在文档中以进一步将其提交给其他脚本等）。您可以进行接线的方式是开放的向上 /swfupload/js/handlers.js 并在那里进行更改。

```
function uploadSuccess(file, serverData) {
    // The php script may return an error message etc. but the handler event for swfupload
    // client is still uploadSuccess. we have to parse data returned from server to find known/script
    // error case.
    try {
        var progress = new FileProgress(file, this.customSettings.progressTarget);
        //try parsing server data now
        var dataObj ;

        try{
            if(webgloo.gMedia.debug) {
                alert("server returned => " + serverData);
            }

            dataObj = JSON.parse(serverData);
            //process server data
            if(dataObj.error === undefined || dataObj.error != 'yes'){
                //no error object or error is not yes!
                //process document object received from server
                webgloo.gMedia.table.addRow(dataObj.document.uuid, dataObj.document.originalName);
                progress.setComplete();
                progress.setStatus(dataObj.message);
                progress.toggleCancel(false);
            }else {
                //known error
                progress.setStatus("Error: " + dataObj.message);
            }

        } catch(ex) {
            //we need to gaurd against JSON parsing errors as well
            progress.setStatus("Error: " + ex.toString());
        }

    } catch (ex) {
        this.debug(ex);
    }
} 
```

您可以在此处热连线您自己的 javascript。有关示例（我正在更新文档表并将返回的文档元数据存储为表单文档中的 json 字符串），请参见此处：

[http://code.google.com/p/localo/source/browse/job/web/js/main.js](http://code.google.com/p/localo/source/browse/job/web/js/main.js)

我希望这些信息足以让您开始使用 swfupload。快乐编码:)

# java - Java 同步未按 (I) 预期工作

> ID：1020751
> 
> 赞同：2
> 
> 时间：2009-06-20T02:08:40.033
> 
> 标签：java, multithreading, synchronization

程序员小伙伴。我正在用一个非常简单的代码（或者至少*看起来很*简单）来测试 java 线程功能。我有这个班级帐户：

```
public class Account {
    protected double balance;

    public synchronized void withdraw(double value) {
        this.balance = this.balance - value;
    }

    public synchronized void deposit(double value) {
        this.balance = this.balance + value;
    }

    public synchronized double getBalance() {
        return this.balance;
    }
} 
```

我有两个线程：`Depositer`，每千次存款 1 万美元：

```
public class Depositer extends Thread {
    protected Account account;

    public Depositer(Account a) {
        account = a;
    }

    @Override
    public void run() {
        for(int i = 0; i < 1000; i++) {
            this.account.deposit(10);
        }
    }
} 
```

并且`Withdrawer`，每千次提取 10 美元：

```
public class Withdrawer extends Thread {
    protected Account account;

    public Withdrawer(Account a) {
        account = a;
    }

    @Override
    public void run() {
        for(int i = 0; i < 1000; i++) {
            this.account.withdraw(10);
        }
    }
} 
```

此安排由以下人员执行：

```
public class Main {
    public static void main(String[] args) {
        Account account = new Account();
        Thread c1 = new Depositer(account);
        Thread c2 = new Withdrawer(account);

        c2.start();
        c1.start();

        System.out.println(account.getBalance());
    }
} 
```

由于方法是同步的，我只是希望余额最后总是为 0，但有时不会发生这种情况。我真的无法弄清楚为什么。有人能看出我的错在哪里吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-20T02:12:29.480

`c2.start()`和`c1.start()`异步运行该过程。在打印出结果之前，您的主线程需要等待这两个线程完成。

称呼

```
try {
    c2.join();
    c1.join();
} catch (InterruptedException e) {
    e.printStackTrace();
} 
```

在调用 println 之前。

见[`join`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html#join%28%29)。

> 等待这个线程死掉。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-20T02:14:11.677

您执行以下操作：

```
c2.start();  // Start a thread in the background
c1.start();  // Start a 2nd thread in the background

// print out the balance while both threads are still running
System.out.println(account.getBalance()); 
```

您需要等待这些线程完成它们的处理：

```
c2.start();  // Start a thread in the background
c1.start();  // Start a 2nd thread in the background

try {
    c2.join();  // Wait until the c2 thread completes
    c1.join();  // Wait until the c1 thread completes
} catch (InterruptedException e) {
    // LOG AN ERROR HERE
}

// print out the final balance
System.out.println(account.getBalance()); 
```

如果你中断你的主线程，那么你需要对中断的异常*做一些事情。*假设您的代码都没有这样做，您应该始终至少记录异常。注意：如果有人打断或，你会得到`InterruptedException` *not*，但如果有人打断你的主线程，调用. 如果有人调用了你的主线程但你没有检查它，那么你可能会在你调用的那一刻得到。`c1``c2``join()``interrupt()``InterruptedException``join()`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T02:13:42.207

在检查“最终余额”之前，您必须等待两个线程完成。

```
c1.join();
c2.join();
System.out.println(account.getBalance()); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-20T02:15:36.573

在多线程代码中，“结束”的定义很棘手。

同步只意味着对账户的每个操作都是互斥的。也就是说，在您存款、取款或查看余额时，账户并未更新。

但是，余额的打印输出发生在主程序中，就在线程生成之后。由于它们是独立线程，因此无法保证它们在您开始打印之前完成运行。因此，您可以在数到 1000 之前打印。或者换句话说，总和最后为 0，但您最后没有打印...

您可能希望从 main 加入线程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-20T02:18:20.560

这种类型的并发错误称为[**竞争条件**](http://en.wikipedia.org/wiki/Race_condition#Simplified_explanation)。您需要[**同步**](http://en.wikipedia.org/wiki/Synchronization_(computer_science))线程。通过使用`join`其他人解释的方法，您将有效地实现并发[Barrier](http://en.wikipedia.org/wiki/Barrier_(computer_science))。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-20T05:17:47.397

您会注意到提款与添加负金额相同，因此您实际上并不需要它。

amount 应该是私有的，不受保护，因为您可以对其执行的所有操作都应该在 Account 中定义并同步。

# xml - AndroidManifest.xml 文件 版本代码属性

> ID：1020758
> 
> 赞同：4
> 
> 时间：2009-06-20T02:13:26.343
> 
> 标签：xml, android, versioning

在 Android 开发者网站上对[您的应用程序进行版本控制：](http://developer.android.com/guide/publishing/versioning.html#appversion)

> 您将发布应用程序的第一个版本，并将 versionCode 设置为 1，然后随着每个版本单调增加该值，无论该版本构成主要版本还是次要版本。

这一切都很好，但是如何处理这个序列？：

```
1 1.0
2 1.1
3 1.2
4 1.3
5 1.4
6 2.0
? 1.5

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-20T04:16:17.923

我猜你是真的想说“如果我们想要发布下一代技术 2.0 但仍然针对 1.0 系列技术发布 1.5 补丁版本怎么办？”

您的选择是：

1.  不要那样做——一旦切换到 2.0，就继续使用 2.0 系列
2.  将 2.0 技术线作为单独的应用程序发布，可能从 1 开始
3.  嗯……没有#3

我的猜测是你想要#2。毕竟，根据定义，您是说应用程序有两个当前版本（1.5 和 2.0），因此实际上有两个不同的应用程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-20T12:57:43.850

为了允许多行开发和发布，我们回到过去的基本行号。下面的顺序是按发布日期：

```
10000 1.0-0
10001 1.0-1
10002 1.0-2
10100 1.1-0
10103 1.1-3
10200 1.2-0
20000 2.0-0
10201 1.2-1

```

上述限制在每个级别（2 位）释放 1 到 100 个点和 100 个破折号。每个级别可以使用 10 个（1 位数），但我从未使用过符合该限制的“真实”软件。鉴于当今的持续集成方法，甚至在某些情况下，每个级别需要 1000（3 位数）。

使用 2 位数字为带符号的 16 位整数提供 31 个主要版本或为无符号提供 63 个主要版本。如果需要，这应该/可能会给 Android 世界足够的时间去 64 位。

此方法提供多个分支，可由程序检查，较高的 versionCode 数字意味着从较低数字升级。

[版本控制您的应用程序](http://developer.android.com/guide/publishing/versioning.html#appversion)状态：

> 其他应用程序...需要向系统查询您应用程序的版本，以确定兼容性并识别依赖关系
> 
> android:versionCode — 一个整数值，表示应用程序代码的版本，相对于其他版本
> 
> 该值是一个整数，以便其他应用程序可以以编程方式对其进行评估，例如检查升级或降级关系。您可以将该值设置为您想要的任何整数，但是您应该确保应用程序的每个后续版本都使用更大的值。

剩下的问题是关于“每个连续的版本”。这是否旨在将一个限制为日期，以便您不能同时让 1.2-1 和 2.0-0 成功 1.2-0，除非发布日期按该顺序排列。versionCode 值：10200、10201 和 20000 提供“升级或降级关系”。还是使用整数值旨在将一个限制为没有分支的单行？

# c# - 如何在 C# 中编写 Apple 推送通知提供程序？

> ID：1020762
> 
> 赞同：13
> 
> 时间：2009-06-20T02:14:51.317
> 
> 标签：c#, ios, apple-push-notifications

Apple 关于提供商如何连接和与其服务进行通信的文档确实很糟糕（在撰写本文时 - 2009 年）。我对协议感到困惑。这是如何在 C# 中完成的？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-07-03T03:34:33.700

工作代码示例：

```
int port = 2195;
String hostname = "gateway.sandbox.push.apple.com";

//load certificate
string certificatePath = @"cert.p12";
string certificatePassword = "";
X509Certificate2 clientCertificate = new X509Certificate2(certificatePath, certificatePassword);
X509Certificate2Collection certificatesCollection = new X509Certificate2Collection(clientCertificate);

TcpClient client = new TcpClient(hostname, port);
SslStream sslStream = new SslStream(
        client.GetStream(),
        false,
        new RemoteCertificateValidationCallback(ValidateServerCertificate),
        null
);

try
{
    sslStream.AuthenticateAsClient(hostname, certificatesCollection, SslProtocols.Tls, true);
}
catch (AuthenticationException ex)
{
    client.Close();
    return;
}

// Encode a test message into a byte array.
MemoryStream memoryStream = new MemoryStream();
BinaryWriter writer = new BinaryWriter(memoryStream);

writer.Write((byte)0);  //The command
writer.Write((byte)0);  //The first byte of the deviceId length (big-endian first byte)
writer.Write((byte)32); //The deviceId length (big-endian second byte)

String deviceId = "DEVICEIDGOESHERE";
writer.Write(ToByteArray(deviceId.ToUpper()));

String payload = "{\"aps\":{\"alert\":\"I like spoons also\",\"badge\":14}}";

writer.Write((byte)0); //First byte of payload length; (big-endian first byte)
writer.Write((byte)payload.Length); //payload length (big-endian second byte)

byte[] b1 = System.Text.Encoding.UTF8.GetBytes(payload);
writer.Write(b1);
writer.Flush();

byte[] array = memoryStream.ToArray();
sslStream.Write(array);
sslStream.Flush();

// Close the client connection.
client.Close(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-20T02:41:18.393

我希望这是相关的（稍微），但我刚刚成功地为 Java 创建了一个，因此在概念上与 C# 非常相似（可能除了 SSL 的东西，但这不应该太难修改。下面是一个示例消息有效负载和加密设置：

```
 int port = 2195;
    String hostname = "gateway.sandbox.push.apple.com";

    char []passwKey = "<keystorePassword>".toCharArray();
    KeyStore ts = KeyStore.getInstance("PKCS12");
    ts.load(new FileInputStream("/path/to/apn_keystore/cert.p12"), passwKey);

    KeyManagerFactory tmf = KeyManagerFactory.getInstance("SunX509");
    tmf.init(ts,passwKey);
    SSLContext sslContext = SSLContext.getInstance("TLS");
    sslContext.init(tmf.getKeyManagers(), null, null);
    SSLSocketFactory factory =sslContext.getSocketFactory();
    SSLSocket socket = (SSLSocket) factory.createSocket(hostname,port); // Create the ServerSocket
    String[] suites = socket.getSupportedCipherSuites();
    socket.setEnabledCipherSuites(suites);
    //start handshake

    socket.startHandshake();

    // Create streams to securely send and receive data to the server
    InputStream in = socket.getInputStream();
    OutputStream out = socket.getOutputStream();

    // Read from in and write to out...
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    baos.write(0); //The command
    System.out.println("First byte Current size: " + baos.size());

    baos.write(0); //The first byte of the deviceId length    
    baos.write(32); //The deviceId length

    System.out.println("Second byte Current size: " + baos.size());

    String deviceId = "<heaxdecimal representation of deviceId";
    baos.write(hexStringToByteArray(deviceId.toUpperCase()));
    System.out.println("Device ID: Current size: " + baos.size());

    String payload = "{\"aps\":{\"alert\":\"I like spoons also\",\"badge\":14}}";
    System.out.println("Sending payload: " + payload);
    baos.write(0); //First byte of payload length;
    baos.write(payload.length());
    baos.write(payload.getBytes());

    out.write(baos.toByteArray());
    out.flush();

    System.out.println("Closing socket..");
    // Close the socket
    in.close();
    out.close(); 
```

}

再一次，不是 C#，但至少比 Apple 提供的糟糕的 ObjC 示例更接近。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-10T14:32:47.687

Github 上最好的[APNSSharp](https://github.com/Redth/APNS-Sharp)项目。它在短短几分钟内对我来说绝对没问题！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-01T05:57:04.057

您可以使用 GitHub 中的[PushSharp](https://github.com/Redth/PushSharp)库。

我在所有项目中都使用它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-29T11:10:53.493

```
 public ActionResult ios()
    {
        string message = string.Empty;

        var certi = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "Certificates2.p12");
        var appleCert = System.IO.File.ReadAllBytes(Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "Certificates2.p12"));

        ApnsConfiguration apnsConfig = new ApnsConfiguration(ApnsConfiguration.ApnsServerEnvironment.Production, appleCert, "Password");

        var apnsBroker = new ApnsServiceBroker(apnsConfig);
        apnsBroker.OnNotificationFailed += (notification, aggregateEx) =>
        {
            aggregateEx.Handle(ex =>
            {
                if (ex is ApnsNotificationException)
                {
                    var notificationException = (ApnsNotificationException)ex;
                    var apnsNotification = notificationException.Notification;
                    var statusCode = notificationException.ErrorStatusCode;
                    var inner = notificationException.InnerException;
                    message = "IOS Push Notifications: Apple Notification Failed: ID=" + apnsNotification.Identifier + ", Code=" + statusCode + ", Inner Exception" + inner;
                }
                else
                {
                    message = "IOS Push Notifications: Apple Notification Failed for some unknown reason : " + ex.InnerException;
                }
                return true;
            });
        };

        apnsBroker.OnNotificationSucceeded += (notification) =>
        {
            message = "IOS Push Notifications: Apple Notification Sent!";
        };

        apnsBroker.Start();
        try
        {
            string deviceToken = "33c2f3a13c90dc62660281913377c22066c1567e23c2ee2c728e0f936ff3ee9b";

            apnsBroker.QueueNotification(new ApnsNotification
            {
                DeviceToken = deviceToken,
                Payload = JObject.Parse("{\"aps\":{\"alert\":\" Test Message\", \"badge\":1, \"sound\":\" default\",}}")
            });
        }
        catch (Exception ex)
        {
            Console.Write(ex);
        }
        apnsBroker.Stop();

        return View(message);
    } 
```

# visual-studio - Visual Studio 插件能否收到有关 C++ 构建/CL 任务/对 CL.EXE 的调用的通知？

> ID：1020774
> 
> 赞同：1
> 
> 时间：2009-06-20T02:22:27.790
> 
> 标签：visual-studio, thread-priority

我希望我的 cl.exe（c++ 编译器进程）进程以低于正常的优先级运行，这样我的 UI 线程就不会受到影响。我已经为我的大多数项目打开了 /MP 构建，并希望利用所有 CPU，但不希望盒子陷入困境并且无法使用。

一位同事编写了一个实用程序来监视线程并允许用户选择进程名称以放弃优先级，但我想知道是否有可能为 Visual Studio 编写一个插件，在所有调用 CL.exe 时都会收到通知，以便您可以以编程方式降低优先级。

那么，这可能吗？VS 2008 - 现在可以构建 C++。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T20:15:42.097

您有 DTE 公开的[BuildEvents](http://msdn.microsoft.com/en-us/library/aa301273(VS.71).aspx)对象，它将用于触发所有类型的项目，但它是查看 CL 是否正在运行的一个很好的说明点。（有一些关于如何在[Google 代码搜索](http://www.google.com/codesearch?hl=en&sa=N&q=BuildEvents++lang:c%23&ct=rr&cs_r=lang:c%23)中使用它的示例）。
或者（这很老套，我不知道它是否会起作用）您可以编写一个 CL.exe 替换器，它将以低/理想优先级运行实际 CL 并将所有参数路由到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-03T15:29:36.697

虽然这不能回答你的问题，但我和你的同事做了同样的事情——写了一个降低优先级的小实用程序`cl.exe`，你可以在这里获取[源代码/二进制文件](http://www.stud.fit.vutbr.cz/~xpolok00/coolstuff.htm#link28)。

# python - Python数据库应用框架和工具

> ID：1020775
> 
> 赞同：9
> 
> 时间：2009-06-20T02:22:57.900
> 
> 标签：python, frame

我一直在构建业务数据库应用程序，例如财务、库存和其他业务需求应用程序。我打算转向 Python。最好的工具是什么。我需要做主、交易表格、处理（后端）、报告和诸如此类的事情。数据库将是 postgress 或 mysql。由于我是 Python 新手，我知道除了 Python 之外我还需要 ORM 和框架。我的应用程序与网站无关，但如果需要，也可能需要通过网络完成。

如何选择工具组合的初始设置？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-20T09:37:32.520

如果我是你，我可能会先看看基于 Django 的基于 Web 的解决方案是否能解决问题。如果您需要更好的外观和感觉，请将 jQuery 添加到组合中。如果它提供的功能太少，请选择 PyQt。如果您有很多非常小的应用程序，请选择多种技术。下面，您会找到我（有些冗长）对此建议的推理。

**Webapp 与桌面应用程序**

一年前，我们有一个业务数据库，需要一个前端。我们必须决定前端使用什么技术。我们考虑过：

1.  [PyQt](http://www.riverbankcomputing.co.uk/software/pyqt/intro)
2.  基于 Web（查看[此处](http://wiki.python.org/moin/WebFrameworks)了解 Python 的 Web 框架概述）

从我们的角度来看，PyQt 的优势：

*   [以前使用Qt](http://www.qtsoftware.com/products/)的C++ 经验，从中我们知道 Qt 适合该任务。
*   包括所有必要的工具。
*   轻松开发富客户。

然而，我们决定不使用 PyQt，而是使用基于 Web 的解决方案。原因是：

*   对前端的要求是适度的，并且可以在浏览器中轻松完成（主要是报告，一些用于输入数据或运行功能的表单）。
*   应用程序（以及新版本、错误修复等）的部署要容易得多，因为一切都只发生在受控环境中的服务器上。
*   访问控制/身份验证/权限是“免费的”，因为它是服务器（在我们的例子中 Apache 使用 Active Directory 身份验证）和浏览器的一部分，这对我们很重要。
*   该应用程序无论如何都需要服务器连接，并且不必在客户端存储任何内容。

*简而言之*：在受控部署环境中具有大量功能的功能丰富的前端可能更容易使用 Qt 实现。对于我们的轻量级前端，基于服务器的解决方案对我们来说似乎更好。

**哪个网络框架？**

既然我们已经决定了一种技术，我们就必须选择一个框架。我们进行了一些研究，并详细研究了两种选择：

1.  [姜戈](http://www.djangoproject.com/)
2.  [由CherryPy](http://www.cherrypy.org/)作为调度程序（将 http 请求与功能和所有相关内容匹配）、[Mako](http://www.makotemplates.org/)作为生成网页的模板库、[SQLAlchemy](http://www.sqlalchemy.org/)作为 ORM 和用于客户端功能的[jQuery](http://jquery.com/)组成的软件堆栈。

我们评估了这两种选择，最后选择了第二种。这个决定是由我们真正的“轻量级”前端需求（许多非常小的应用程序）驱动的。一堆软件——我们可以根据需要混合和匹配——对我们来说似乎更好。我们可以在不需要 Web 前端的情况下重用 SQLAlchemy，我们可以在没有模板库和 ORM 的情况下使用 CherryPy，等等。然而，在许多其他情况下，我会选择 Django 而不是这个堆栈。

**总结一下：**

*   一个大而复杂的应用程序-> PyQt
*   一组相对相似、简单明了的报告、表格等，具有相同的外观-> Django
*   一组相对多样化的事物，在要求和使用的技术或在其他情况下重用某些技术时存在很大差异 -> 根据需要混合使用技术

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-20T02:40:48.830

如果我是你，我会从[django](http://docs.djangoproject.com/en/dev/)开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T06:13:06.943

如果您的应用程序将来需要在桌面和 Web 上运行，您可以考虑使用可分发服务器创建基于 Web 的应用程序。这些事情很容易用 Python 以简单的方式和更强大的方式（例如使用 Twisted）来完成。

如果仅桌面是您的方向，那么确实正如 Alex 所说 - 选择 PyQt。它非常易于使用，并通过多种数据库绑定提供了非常强大的 GUI 功能。

至于数据库——你习惯使用哪一个？例如，如果您是 MySQL 专家，那么首先检查一下 Python 的 MySQL 绑定是明智的。对于 ORM，绝对可以尝试 SQLAlchemy。

也许问题中的更多细节可以帮助提供更完整的答案。

* * *

更多细节（供您评论）：

如果 PostgreSQL 是您的方向，那么 Python 将[PyGreSQL](http://www.pygresql.org/)作为绑定。它是开源的，就像 Python 本身一样，所以你应该对用户免费的应用程序没有任何问题。至于 Python 是正确的选择，我认为是。考虑到许多强大的网站都运行 Python（YouTube、Reddit，甚至某些应用程序的 Google）。Python 还用于几个大容量应用程序，例如源代码控制系统 Mercurial 和 Bazaar，以及邮件列表管理器 mailman。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T02:56:40.687

正如 Boudewijn Rempt 在[这里](http://www.informit.com/articles/article.aspx?p=30649&seqNum=7)所写，“对于创建 [[NON-web]] 数据库应用程序的最简单方法，您可能想看看[PyQt](http://www.riverbankcomputing.co.uk/software/pyqt/intro) ”。这是他 6 年前写的，但我认为今天也是完全正确的。特别是pyqt4 的[QtSql](http://docs.huihoo.com/pyqt/pyqt4/html/qtsql.html)模块，它支持 MySQL、PostgreSQL 和其他几个数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T08:02:24.477

仅供参考，对于 PyQT，这本书有第 15 章的数据库，看起来不错。这本书有一些数据和视图等。我读过它，我认为这很值得你花时间:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-09T13:28:59.367

由于我不喜欢任何可用的框架，我决定自己写一些东西。也许你想看看[Pylax](https://github.com/thomasfuhringer/pylax/tree/master/GTK)。它内置于 GTK 中，并使用嵌入式 Python 编写脚本。目前，后端是 SQLite。

# f# - F# 私有静态方法

> ID：1020788
> 
> 赞同：7
> 
> 时间：2009-06-20T02:33:49.267
> 
> 标签：f#, static, methods, declaration

如何在 f# 的类中定义私有静态方法？当我尝试附加一个私人修饰符时，它会抱怨。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-20T02:47:07.100

这是一个定义和使用私有静态成员的简短脚本：

```
type MyClass =
    static member private MyPrivateMember() = printfn "MyPrivateMember()"

    static member MyMember() = MyClass.MyPrivateMember()

MyClass.MyMember() // MyPrivateMember() 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-05-20T20:17:08.873

替代：

```
type MyClass () =
    static let myPrivateMethod () =
        printfn "This is inaccessible outside the class." 
```

# asp.net-mvc - 如何在 C# 3.0 中获取上传文件的完整路径？

> ID：1020789
> 
> 赞同：0
> 
> 时间：2009-06-20T02:35:11.493
> 
> 标签：asp.net-mvc, c#-3.0, filestream, text-files, import

在我的 ASP.NET MVC 网站中，我必须阅读一个 txt 文件，其中包含一些由“;”分隔的名称和电子邮件。之后，我必须将此 txt 文件的每一行保存到数据库中。

谷歌搜索，我找到了一些片段，但在所有片段中我都必须使用 txt 文件路径。

但是，我怎样才能得到这条路？这个文件可以在用户机器的任何地方！

谢谢！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-20T02:54:07.493

您无法获取上传文件的完整路径。对于上传文件的用户来说，这将侵犯隐私。

相反，您需要阅读已上传的 Request.Files。例如：

```
HttpPostedFile file = Request.Files[0];
using (StreamReader reader = new StreamReader(file.InputStream))
{
    while ((string line = reader.ReadLine()) != null) 
    {
        string[] addresses = line.Split(';');
        // Do stuff with the addresses
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T02:41:41.027

如果您使用的是 asp.net 网页模型，则`Server.MapPath("~/")`可以获取站点的根目录，以便传递您需要的路径。您可能需要致电

```
HttpContext.Current.Server.MapPath("~/"); 
```

例如保存文本文件的文件夹：

```
string directoryOfTexts = HttpContext.Current.Server.MapPath("~/txtdata/"); 
```

一旦你拥有它就可以读取它，你可以 StreamReader 它：

```
string directoryOfTexts = HttpContext.Current.Server.MapPath("~/txtdata/");
string path = directoryOfTexts + "myfile.txt";
string alltextinfile = "";
if (File.Exists(path)) 
{
    using (StreamReader sr = new StreamReader(path)) 
    {
       //This allows you to do one Read operation.
       alltextinfile = sr.ReadToEnd());
    }
} 
```

如果这是针对桌面应用程序，则 Applcation 类包含所有这些信息：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.application.startuppath.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.startuppath.aspx)

```
Application.StartupPath 
```

所有属性都列出了其他 appdata 文件夹和内容，但是一旦您获得了可执行文件的应用程序路径，这将为您提供上下文，例如`Application.LocalUserAppDataPath`.

[http://msdn.microsoft.com/en-us/library/system.windows.forms.application_properties.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.application_properties.aspx)

如果内容足够小，您也可以在保存到数据库之前将它们保存在 a`HashTable`或 Generic中。`List<String>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T04:22:21.903

```
var hpf = Request.Files[file] as HttpPostedFile; 
```

HTML 中的表单应该有`enctype="mulitipart/form-data"`

# drupal - 如何在 drupal 6 的 nodecomments 中获取到父节点的链接？

> ID：1020798
> 
> 赞同：2
> 
> 时间：2009-06-20T02:41:33.960
> 
> 标签：drupal, hyperlink, parent

我知道问的理想地点是在。我在 drupal 支持论坛和模块下发布了[我的问题](http://drupal.org/node/495412)`nodecomments`作为问题。在过去的 3 天里，我还在 drupal 支持 IRC 频道中每天连续发布一次这个问题。

没有答案。

因此，我决定在这里碰碰运气。我正在共享主机上的当前设置上运行以进行测试：

```
drupal-6.12
fivestar-6.x-1.15
nodecomment-6.x-1.2rc2
cck-6.x-2.3
votingapi-6.x-2.0-rc2
views-6x-2.6 
```

尽管他们使用的模块有点过时，但我还是按照[http://drupal.org/node/234681中的说明进行操作。](http://drupal.org/node/234681)我得到了我想要的工作。我有一个产品节点类型和一个评论节点类型。然后我使用 nodecomment 以便评论节点类型显示为产品的评论。

到现在为止还挺好。

现在，当我自己查看评论节点时，我找不到返回产品节点的链接——评论节点的父节点。我尝试搜索并遇到了[这个补丁](http://drupal.org/node/472900)，但我不知道如何使用它。事实上，我什至不确定它是否能解决我的问题。

我不介意将父节点（产品节点）显示为面包屑，只要有返回产品节点的链接即可。我买了“使用drupal”一书，但我不喜欢它教你选择产品列表以创建评论的方式。我尝试搜索了一段时间，遇到了节点注释、节点层次结构和节点相对性。经过多次试验，我已经决定使用 nodecomment，但我需要父链接。

请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T05:38:16.670

您指向的补丁适用于 6.x-2.x-dev 版本（有一天将成为 Drupal 6 的 nodecomment 2.0），因此在您的情况下几乎没有用，抱歉。

你可以简单地做类似的事情

```
<?php print l('Back to product', 'node/' . $node->comment_target_nid); ?> 
```

在您`node-comment.tpl.php`获取返回产品的链接。

如果您想做更高级的事情（例如加载产品节点以获取其标题或其他属性），我建议您在主题中创建一个预处理功能（甚至创建一个模块，具体取决于您的需求有多大）。

这是关于预处理函数的一个很好的资源：[设置在模板中使用的变量（预处理函数）](http://drupal.org/node/223430)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T20:06:16.570

您可以根据自己的需要调整本教程中的方法： [http ://www.lullabot.com/articles/photo-galleries-views-attach](http://www.lullabot.com/articles/photo-galleries-views-attach)

不要使用 nodecomment，而是使用带有 CCK 节点引用字段的“评论”内容类型到“产品”节点（节点[引用 URL](http://drupal.org/project/nodereference_url)将在产品节点上添加一个方便的链接到添加评论表单，并且已经设置了产品节点引用）。节点参考将显示为评论节点中的一个字段，其中包含链接到产品节点的产品名称。

[Views Attach](http://drupal.org/project/views_attach)将允许您将评论列表添加到产品节点。

# iphone - 将 NSArray 分离为 NSString 类型对象的列表

> ID：1020813
> 
> 赞同：16
> 
> 时间：2009-06-20T02:52:28.603
> 
> 标签：iphone, objective-c, nsstring, nsarray, variadic-functions

UIActionSheet 初始化为：

```
UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:@"Title" delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil 
otherButtonTitles:@"Button1", @"Button2", nil]; 
```

我正在尝试将 NSArray 传递到“otherButtonTitles”消息中。

我尝试使用以下方法传递 NSArray：

```
otherButtonTitles:[array] 
```

但该消息需要一个 NSStrings 列表。

我能想到的将 NSArray 分解为一组 NSString 的唯一方法是使用 componentsJoinedByString，但它给了我一个逗号分隔的列表，它是一个 NSString。

正确方向的一点将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-20T03:11:28.643

该方法需要可变参数。没有一种非常简单的方法可以使转换成为您的描述，在这种情况下尝试绝对不值得麻烦。这只是一种方便的方法。

只需使用访问器 ( , ,等)使用`-init`和配置所有内容`-setDelegate:``-addButtonWithTitle:``-setCancelButtonIndex:`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-20T03:10:54.433

不幸的是，[你不能](https://stackoverflow.com/questions/431910/is-possible-send-a-array-in-obj-c-for-a-variable-arguments-function)在 Objective-C 中做到这一点。

# xsd - XSD：我可以让元素继承祖先的规则吗？

> ID：1020814
> 
> 赞同：2
> 
> 时间：2009-06-20T02:52:31.833
> 
> 标签：xsd

考虑以下：

```
<xs:complexType name="A">
    <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:group ref="subAGroup"/>
        <xs:group ref="xGroup"/>
    </xs:choice>
</xs:complexType>
<xs:complexType name="B">
    <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:group ref="subBGroup"/>
        <xs:group ref="xGroup"/>
    </xs:choice>
</xs:complexType> 
```

我想要发生的是，如果 xGroup 中的一个元素是 A 的孩子、孙子等，那么它的孩子必须是 subAGroup 或 xGroup 的一部分。如果 B 是它的祖先，那么它的孩子必须在 subBGroup 或 xGroup 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-23T22:10:26.727

一种解决方案是为每个父类型创建不同的组和类型。按照上面的例子，它会变成这样：

```
<xs:complexType name="A">
    <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:group ref="subAGroup"/>
        <xs:group ref="xGroup"/>
    </xs:choice>
</xs:complexType>
<xs:complexType name="B">
    <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:group ref="subBGroup"/>
        <xs:group ref="yGroup"/>
    </xs:choice>
</xs:complexType>

<xs:group name="xGroup">
    <xs:choice>
        <xs:element name="Element1" type="AEleType"/>
    </xs:choice>
</xs:group>
<xs:complexType name="AEleType">
    <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:group ref="subAGroup"/>
        <xs:group ref="xGroup"/>
    </xs:choice>
</xs:complexType>

<xs:group name="yGroup">
    <xs:choice>
        <xs:element name="Element1" type="BEleType"/>
    </xs:choice>
</xs:group>
<xs:complexType name="BEleType">
    <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:group ref="subBGroup"/>
        <xs:group ref="yGroup"/>
    </xs:choice>
</xs:complexType> 
```

虽然它似乎过于冗长。有没有更优雅的解决方案？

# java - 转换对象的设计

> ID：1020815
> 
> 赞同：2
> 
> 时间：2009-06-20T02:52:40.867
> 
> 标签：java, design-patterns

我试图想出一个很好的设计来将一组不同的对象转换成一个共同的对象。基本上，我从系统 A 接收到一个（许多略有不同的）复杂对象，并且必须将其转换为系统 B 的更简单对象。

我要转换的对象都继承自同一个基类，因此部分转换始终相同。但在每种情况下，转换确实涉及到一些非常特定于我正在转换的对象类型的东西。它可以是 RPC、HTTP 提取、数据库查找或完全不同的东西。

我正在查看[模板方法](http://en.wikipedia.org/wiki/Template_method_pattern)和[策略](http://en.wikipedia.org/wiki/Strategy_pattern)模式。但两者似乎都不是完美的选择。问题是要使用的方法/策略与要转换的对象的类型相关，因此不可互换。

这是我正在考虑做的事情的草图：

```
class FooConverter {
    Map<String, FooConverter> converters;
    Foo convert(Bar bar) {
        Foo foo = ...;  // Common part of the conversion.
        FooConverter c = converters.get(bar.getType(), foo);
        c.finishConversion(bar, foo);
        return foo;
    }
} 
```

让我烦恼的是，`FooConverter`必须定义一个额外的转换方法，将部分转换的对象作为参数。所以我最终混合了一个策略（因为所有转换器都实现了相同的接口）和模板方法（因为转换的公共部分由所有转换器共享）。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T03:35:04.540

您正在使用一堆“Convertable”对象，也许您可​​以让“Foo”为每个“Convertable”基本类型都有装饰器，当您检测到“Convertable”类型时，您可以将适当的装饰器添加到“Foo”？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T10:00:16.423

听起来您需要遍历结构并能够对结构中的每个元素执行某些操作。该“某事”因元素的类型而异，您还希望能够改变*该*“某事”的实现方式。

如果是这样的话，这听起来很适合**访客**模式。我最近自己在一个非常像你的场景中使用它，我需要以灵活的方式将一种结构转换为另一种结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-22T07:16:19.607

至少有两种方法可以做到：

1.  使用模板方法。即在超类（Bar）中有一个转换方法并在子类（例如，MyBar、HttpBar 等）中实现它。这很好，只要类知道如何转换自己。你可以在 Bar 中有一个 toFoo() 方法。子类将调用 super.toFoo() 并且另外做需要的东西。
2.  上述方法可能并不总是可取的，因为从*概念上*转换不是 Bar 的工作。在这种情况下，您可以使用访客模式。您可以拥有转换类的并行层次结构。每个类都可以*接受*某种特定类型的 Bar 并进行转换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T03:14:20.103

您可以为要转换的每个给定类型使用构造函数实现目标类型的子类。从构造函数调用其父类型的重载构造函数。

就像是：

```
public class ConvertedFoo extends Foo
{
    public ConvertedFoo(SuperTypeA a) {
        // Do some common stuff here.
    }

    public ConvertedFoo(SubtypeOfSuperTypeA a) {
        ConvertedFoo((SuperTypeA)a);
        // Do more specific stuff here.
    }
} 
```

如果`ConvertedFoo`类变得太大，则可以很容易地将其拆分为子类型。

这将允许最大程度地重用代码，并在不使用动态类型检查的情况下集中所有转换代码。

我不认为这是一个命名模式。如果有人知道，我想知道它的名字。

# c++ - 比较 C 与 C++ 中的结构

> ID：1020820
> 
> 赞同：1
> 
> 时间：2009-06-20T02:55:00.767
> 
> 标签：c++, class

我想比较 C++ 类/结构对象。`struct`在 C 中，大多数时候，通过将各个字段的大小相加（假设编译器不添加填充）来知道确切的大小。因此，可以在两个对象上使用 memcmp() 函数来非常快速地比较它们。我不确定这是否适用于 C++。这是因为一个类也有函数定义，也许还有一些其他隐藏的东西（可能是一些 RTTI 信息？甚至是一个虚函数表？）

一个包含`int`和`char`成员的简单结构和一个函数的快速程序显示结构的大小为`sizeof(int)+sizeof(char)`.

我有一个具有简单 int、char 等数据类型（但数量很多）的大型结构类。我想不时比较对象。我不能重载`==`运算符，因为这会使它们逐个字段地比较每个字段。在 C 中，我可以一次性使用`memcmp()`. 对 C++ 有什么建议吗？可以`memcmp()`直接使用吗？我不希望 memcmp() 失败，因为像虚函数指针表这样的其他值是不同的（但所有字段实际上都是相等的）（我使用的是 g++）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-20T03:39:49.617

在许多方面保持警惕......

1.  任何填充中的值都是不确定的，因此不可比较。
2.  如果您的机器是 little-endian，比较整数字段将产生一个答案；如果你的机器是大端的，它会产生另一个答案。
3.  大多数人认为 -1 小于 0，但`memcmp()`会按字节进行无符号比较，因此会将 -1 视为大于 0。
4.  任何指针本质上都不能通过`memcmp()`.
5.  您无法比较`float`或`double`使用`memcmp()`.

总的来说，您正在寻求一种不明智的优化。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-20T03:03:03.200

可以采用`sizeof()`结构或类。

**编辑：** 由于我提供了上面的答案，您已经将问题从“如何手动确定 C++ 结构和类的大小？” 关于比较两个类的更一般的。

简短的回答是您*确实*想重载`==`运算符。认为它会一次一个地比较每个字段的信念是不正确的；您可以重载`operator ==`以使用您喜欢的任何算法，包括`memcmp`.

`memcmp()`在从第一个字段偏移到最后一个字段的内存上应该可以正常工作。如果您将类型 A 的类与继承自 A 的另一个类 B 进行比较，则类的整个足迹上的A`memcmp()`可能会失败，因为 vtable 指针可能不同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-20T02:58:03.647

如果您的`class`or`struct`没有任何虚拟内容，则“将各个字段的大小相加（并假设编译器不添加填充）”在 C++ 中与在 C 中一样正确（即不完全正确，因为通常会添加填充*；-)*。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-20T03:37:30.103

[POD](http://en.wikipedia.org/wiki/Plain_Old_Data_Structures)可以安全地与 memcmp 进行比较。

填充是对类对象执行 memcmp 的一个问题，因为它可能充满垃圾（这将因对象而异）。在 C 中，您通常不会遇到这个问题，因为在进行任何赋值之前将整个结构设置为 0 通常是可以的，这在 C++ 中非常糟糕，因为您可以覆盖 vtable。

我不相信语言规范中有任何内容说明如何实现 vtable，尽管它们通常是隐藏的数据成员。vtable 对于同一个类的成员应该是相同的（但对于父/子类当然会不同）。当您进入多重继承或虚拟继承时，实现可能会因编译器而异。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T03:54:35.793

据我所知，您可以使用 #pragma pack ( [gcc](http://gcc.gnu.org/onlinedocs/gcc/Structure_002dPacking-Pragmas.html) , [vc++](http://msdn.microsoft.com/en-us/library/2e70t5y1(VS.80).aspx) )防止结构中的填充

```
#pragma pack(push, 1)
struct Example
{
   int a;
   char b;
   short c;
};
#pragma pack(pop) 
```

打印 sizeof(Example) 显示它是 7 个字节。如果没有#pragma 包，大小为8 字节。

# java - 如何简洁地用 Java 构建 XML 文档？

> ID：1020828
> 
> 赞同：21
> 
> 时间：2009-06-20T03:02:19.723
> 
> 标签：java, xml, builder

我需要从 Java 对象层次结构构建 XML 文档。Java 类和 XML 格式都是固定的。所以我不能使用像[XStream](http://xstream.codehaus.org/)这样的 XML 序列化器：它基于 Java 类的 XML 格式。同样，像[JAXB](http://jaxb.java.net/)这样的 Java XML 绑定技术也不起作用，因为它从 XML 模式创建 Java 类 [ed: 但见下文]。我需要一种手动方法。

技术含量低的 StringBuilder 路线会导致代码脆弱和错误（至少对我而言！）。

[像JAXP](https://jaxp.dev.java.net/)或[JDOM](http://www.jdom.org/index.html)这样的 API会产生更健壮的代码，但这些代码非常冗长。

[Groovy](http://groovy.codehaus.org/)有一个优雅的[MarkupBuilder](http://groovy.codehaus.org/Creating+XML+using+Groovy%27s+MarkupBuilder)：

```
def writer = new StringWriter()
def xml = new MarkupBuilder(writer)
xml.records() {
  car(name:'HSV Maloo', make:'Holden', year:2006) {
    country('Australia')
    record(type:'speed', 'Production Pickup Truck with speed of 271kph')
  }
  car(name:'P50', make:'Peel', year:1962) {
    country('Isle of Man')
    record(type:'size', 'Smallest Street-Legal Car at 99cm wide and 59 kg')
  }
} 
```

其他语言（例如[Ruby](http://builder.rubyforge.org/)）甚至有更好的语言，尽管我想继续使用纯 Java。似乎确实有一些用于 Java 的新 XML 构建器，例如[actualxml](http://sourceforge.net/projects/practicalxml/)和 James Murty 的[xmlbuilder](http://code.google.com/p/java-xmlbuilder/)。

在 Java 中构建 XML 文档的更优雅的方法是什么？

**概括：**

Jon Doe 建议[使用 dom4j](http://dom4j.sourceforge.net/)和[jdom](http://www.jdom.org/index.html)。

无论如何，CurtainDog 建议使用 JAXB，jherico 提示我这是一个相关的建议：然后您可以使用 Dozer 在我当前的 JavaBeans 和 JAXB JavaBeans 之间进行映射。

thaggie 推荐[JIBX](http://jibx.sourceforge.net/)并同意 CurtainDog 和 jherico 的观点，即绑定技术实际上是实用的。

StaxMan 推荐[StaxMate](http://staxmate.codehaus.org/Tutorial)。

在我看过的东西中，practicalxml 和 James Murty 的 xmlbuilder 似乎是最简洁的构建器，尽管它们是相当新的。像 JAXB 这样的绑定技术似乎提供了额外的安全/自动化。在主流选择中，[dom4j](http://dom4j.sourceforge.net/)看起来不错，但仍然有点冗长。它提供了一个“流利的接口”（突变器返回对突变对象的引用，因此它们可以链接在一起），我喜欢它：

```
public Document createDocument() {
    Document document = DocumentHelper.createDocument();
    Element root = document.addElement( "root" );
    Element author2 = root.addElement( "author" )
      .addAttribute( "name", "Toby" )
      .addAttribute( "location", "Germany" )
      .addText( "Tobias Rademacher" );
    Element author1 = root.addElement( "author" )
      .addAttribute( "name", "James" )
      .addAttribute( "location", "UK" )
      .addText( "James Strachan" );
    return document;
} 
```

为简洁起见，您可以在此 API 上包裹一个薄外观，为其中一些方法提供简洁的同义词（例如，attr() 而不是 addAttribute()）。

谢谢大家！

PS：Stephan Schmidt 从事 Java [MarkupBuilder](http://codemonkeyism.com/the-best-markup-builder-i-could-build-in-java/)工作，但似乎没有发布它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-20T03:10:58.660

dom4j 或 jdom 可能是最优雅的，您可以按照自己的喜好编写代码。如果我记得的话，Dom4j 有构建器，是的，代码更冗长。

```
Element.addElement("x").setAttribute("x", "y").xxxxx; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-15T11:40:48.733

看看[XOM](http://www.xom.nu/)。它快速、简单、正确且不冗长。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T03:19:18.207

你为什么不直接使用 JAXB.. 那么问题就变成了一个非常简单的对象到对象映射，你完全避免了 xml。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T06:08:41.523

虽然不像脚本语言中的构建器那样简洁，[但 StaxMate](http://staxmate.codehaus.org/Tutorial)使事情变得非常简单。通常在结构上与树模型一样简单，但它还支持类型加法（隐式转换）。并将这一切直接放入流中，这意味着内存使用率非常低（如果重要的话，速度很快）。

值得一提的是，它还支持流畅的样式（从 2.0.x 开始），因为它通常是有意义的。与完整数据绑定（和树模型）解决方案相比，主要优势可能是内存使用率低；很少有状态被保留，所有输出都会尽快到达目的地。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-02-22T07:39:58.520

[Underscore-java](https://github.com/javadev/underscore-java)有一个构建器来从对象创建 xml 字符串。

```
 String xml = U.objectBuilder().add("author", U.arrayBuilder()
            .add(U.objectBuilder()
                .add("-name", "Toby")
                .add("-location", "Germany")
                .add("#text", "Tobias Rademacher"))
            .add(U.objectBuilder()
                .add("-name", "James")
                .add("-location", "UK")
                .add("#text", "James Strachan"))).toXml();

// <?xml version="1.0" encoding="UTF-8"?>
// <root>
//   <author name="Toby" location="Germany">Tobias Rademacher</author>
//   <author name="James" location="UK">James Strachan</author>
// </root> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-20T05:27:10.707

您可以考虑[JIBX](http://jibx.sourceforge.net)，您可以定义从域模型类到目标 XML 模式的[映射。](http://jibx.sourceforge.net/binding/tutorial/binding-start.html#intro)

或者，如果这是不可能的，虽然我知道你说你已经打折使用绑定技术我鼓励你审查这个决定，从你的域模型复制到生成的模型很可能会使更清洁、更可维护和更少比您建议的更容易出错的代码（JIBX 也可以这样做）。

我可能应该补充一点，根据我的经验，在这里提出有关 JIBX 的问题是徒劳的，但他们的邮件列表非常有帮助。

# eclipse - 索引和搜索项目文件夹中的内容

> ID：1020829
> 
> 赞同：3
> 
> 时间：2009-06-20T03:02:20.270
> 
> 标签：eclipse, netbeans, project-management, indexing, full-text-search

每次我试图在我的代码（在项目文件夹中）中找出一个变量或字符串或一些文本时，我都遇到了麻烦。看来我不知道简单的技术来做到这一点。

我想知道是否有任何工具可以索引指定的文件夹（在我的案例项目文件夹中）并实时更新（使用更新代码）。也可以轻松搜索任何字符串（该项目文件夹中的哪个文件/s包含该字符串）？

是否有 Eclipse 或 Netbeans 的内置支持或插件？（因为这两个 IDE 都索引了所有代码，所以应该有）

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T03:21:12.790

exuberant ctags 执行您想要的索引。我会想象许多 IDE 都存在插件（它适用于 vim，这就是我所使用的）。

对于这个一般用例，我倾向于只在命令行中使用 ack。这是一个相当快的类似“grep”的工具，非常适合代码。它还可能具有适用于各种 IDE/文本编辑器的插件。

这些是相当最小的 unix 风格的解决方案，但我发现它们可以满足我的大部分需求，即使是在大型、复杂的项目中也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T19:08:43.417

从**Netbeans 6.5**开始，您有一个快速搜索栏（大部分位于右上角），用于搜索您的项目文件夹（以及更多）。

# vbscript - 在 VBscript 中写入/读取具有自定义扩展名的外部文件

> ID：1020832
> 
> 赞同：2
> 
> 时间：2009-06-20T03:04:27.300
> 
> 标签：vbscript, file-extension

您如何使用 VBscript 写入或读取具有自定义扩展名的外部文件（例如，而不是 .txt 扩展名，它可能具有 .cyc）？

我不知道如何，似乎无法弄清楚。对于读取文件，是否可以只读取文件的一部分？例如，如果我有一条线

string1=世界你好！

在我的文件中，我的脚本如何仅从 string1 行读取以及如何将文本值分配给 vbscript 文件中的字符串？

那么，如何将单个值写入我的文件？

为了澄清，我基本上是在尝试使用外部文件作为配置/数据文件。

这可能是一个非常愚蠢的问题，如果是，我真的很抱歉。

编辑：这是一个两部分的问题，我需要知道上面指定的读写文件的代码，以及如何使用自定义扩展。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T03:07:41.647

您所要做的就是在文件名末尾包含扩展名，如下所示：

```
c:\myfolder\myfile.ext 
```

当您打开文件进行写入时。

下面是一些示例代码，它打开一个新文件，向其中写入一行文本，然后关闭该文件：

```
Set myFSO = CreateObject("Scripting.FileSystemObject")
Set WriteStuff = myFSO.OpenTextFile("c:\myfolder\myfile.ext", 2, true)
WriteStuff.WriteLine("Hello World.")
WriteStuff.Close
Set WriteStuff = nothing
Set myFSO = nothing 
```

这是读取它的代码：

```
Dim S as String
Set myFSO = CreateObject("Scripting.FileSystemObject")
Set ReadStuff = myFSO.OpenTextFile("c:\myfolder\myfile.ext", 1)
S=Readstuff.ReadLine
ReadStuff.Close
Set ReadStuff = nothing
Set myFSO = nothing 
```

[在http://www.activexperts.com/activmonitor/windowsmanagement/adminscripts/other/textfiles/](http://www.activexperts.com/activmonitor/windowsmanagement/adminscripts/other/textfiles/)上还有更多示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T03:30:40.697

如果您想在随机位置读取和写入文本文件，最好的办法是使用 INI 文件。

INI 文件包含如下所示的条目：

```
[owner]
name=John Doe
organization=Acme Products 
```

要读取 ini 文件，您需要一个可以这样调用的函数：

```
Dim s as string
s=ReadINI("c:\myfolder\myfile.ext", "owner", "name") 
```

...这将把“John Doe”放在 s 中。

执行此操作的代码在这里： [http ://cwashington.netreach.net/depo/view.asp?Index=553](http://cwashington.netreach.net/depo/view.asp?Index=553)

编写 INI 文件的工作方式相同。

这是另一个例子：

```
WriteINI("c:\myfolder\myfile.ext", "MySection", "MyItem", "MyValue") 
```

创建一个如下所示的 INI 文件：

```
[MySection]
MyItem=MyValue 
```

您可以根据需要在每个部分中包含任意数量的不同部分和项目。要检索所需的值，您所要做的就是使用要检索的值的部分名称和项目名称调用 ReadINI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-22T04:53:54.917

以下类从 VB.Net 读取和写入 INI 文件：

```
Class INI

#Region "API Calls"
    ' standard API declarations for INI access
    ' changing only "As Long" to "As Int32" (As Integer would work also)
    Private Declare Unicode Function WritePrivateProfileString Lib "kernel32" _
    Alias "WritePrivateProfileStringW" (ByVal lpApplicationName As String, _
    ByVal lpKeyName As String, ByVal lpString As String, _
    ByVal lpFileName As String) As Int32

    Private Declare Unicode Function GetPrivateProfileString Lib "kernel32" _
    Alias "GetPrivateProfileStringW" (ByVal lpApplicationName As String, _
    ByVal lpKeyName As String, ByVal lpDefault As String, _
    ByVal lpReturnedString As String, ByVal nSize As Int32, _
    ByVal lpFileName As String) As Int32
#End Region

    Public Overloads Function INIRead(ByVal INIPath As String, _
    ByVal SectionName As String, ByVal KeyName As String, _
    ByVal DefaultValue As String) As String
        ' primary version of call gets single value given all parameters
        Dim n As Int32
        Dim sData As String
        sData = space$(1024) ' allocate some room 
        n = GetPrivateProfileString(SectionName, KeyName, DefaultValue, _
        sData, sData.Length, INIPath)
        If n > 0 Then ' return whatever it gave us
            INIRead = sdata.Substring(0, n)
        Else
            iniread = ""
        End If
    End Function

#Region "INIRead Overloads"
    Public Overloads Function INIRead(ByVal INIPath As String, _
    ByVal SectionName As String, ByVal KeyName As String) As String
        ' overload 1 assumes zero-length default
        Return INIRead(inipath, sectionname, KeyName, "")
    End Function

    Public Overloads Function INIRead(ByVal INIPath As String, _
    ByVal SectionName As String) As String
        ' overload 2 returns all keys in a given section of the given file
        Return INIRead(inipath, sectionname, Nothing, "")
    End Function

    Public Overloads Function INIRead(ByVal INIPath As String) As String
        ' overload 3 returns all section names given just path
        Return INIRead(inipath, Nothing, Nothing, "")
    End Function
#End Region

    Public Sub INIWrite(ByVal INIPath As String, ByVal SectionName As String, _
    ByVal KeyName As String, ByVal TheValue As String)
        Call WritePrivateProfileString(SectionName, KeyName, TheValue, INIPath)
    End Sub

    Public Overloads Sub INIDelete(ByVal INIPath As String, ByVal SectionName As String, _
    ByVal KeyName As String) ' delete single line from section
        Call WritePrivateProfileString(SectionName, KeyName, Nothing, INIPath)
    End Sub

    Public Overloads Sub INIDelete(ByVal INIPath As String, ByVal SectionName As String)
        ' delete section from INI file
        Call WritePrivateProfileString(SectionName, Nothing, Nothing, INIPath)
    End Sub

End Class 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T03:06:37.477

气旋：

1.  创建文件夹 c:\testarea。
2.  在刚刚创建的文件夹中创建一个名为 test.vbs 的文本文件，并将下面的代码粘贴到其中。
3.  双击 test.vbs 文件来执行它。请注意，它会在同一目录中创建一个 test.ini 文件。打开 test.ini 并查看它。

这段代码已经过测试，所以我知道它可以工作。我从[http://www.robvanderwoude.com/vbstech_files_ini.php得到它](http://www.robvanderwoude.com/vbstech_files_ini.php)

```
 Function ReadIni( myFilePath, mySection, myKey )
    ' This function returns a value read from an INI file
    '
    ' Arguments:
    ' myFilePath  [string]  the (path and) file name of the INI file
    ' mySection   [string]  the section in the INI file to be searched
    ' myKey       [string]  the key whose value is to be returned
    '
    ' Returns:
    ' the [string] value for the specified key in the specified section
    '
    ' CAVEAT:     Will return a space if key exists but value is blank
    '
    ' Written by Keith Lacelle
    ' Modified by Denis St-Pierre and Rob van der Woude

    Const ForReading   = 1
    Const ForWriting   = 2
    Const ForAppending = 8

    Dim intEqualPos
    Dim objFSO, objIniFile
    Dim strFilePath, strKey, strLeftString, strLine, strSection

    Set objFSO = CreateObject( "Scripting.FileSystemObject" )

    ReadIni     = ""
    strFilePath = Trim( myFilePath )
    strSection  = Trim( mySection )
    strKey      = Trim( myKey )

    If objFSO.FileExists( strFilePath ) Then
        Set objIniFile = objFSO.OpenTextFile( strFilePath, ForReading, False )
        Do While objIniFile.AtEndOfStream = False
            strLine = Trim( objIniFile.ReadLine )

            ' Check if section is found in the current line
            If LCase( strLine ) = "[" & LCase( strSection ) & "]" Then
                strLine = Trim( objIniFile.ReadLine )

                ' Parse lines until the next section is reached
                Do While Left( strLine, 1 ) <> "["
                    ' Find position of equal sign in the line
                    intEqualPos = InStr( 1, strLine, "=", 1 )
                    If intEqualPos > 0 Then
                        strLeftString = Trim( Left( strLine, intEqualPos - 1 ) )
                        ' Check if item is found in the current line
                        If LCase( strLeftString ) = LCase( strKey ) Then
                            ReadIni = Trim( Mid( strLine, intEqualPos + 1 ) )
                            ' In case the item exists but value is blank
                            If ReadIni = "" Then
                                ReadIni = " "
                            End If
                            ' Abort loop when item is found
                            Exit Do
                        End If
                    End If

                    ' Abort if the end of the INI file is reached
                    If objIniFile.AtEndOfStream Then Exit Do

                    ' Continue with next line
                    strLine = Trim( objIniFile.ReadLine )
                Loop
            Exit Do
            End If
        Loop
        objIniFile.Close
    Else
        WScript.Echo strFilePath & " doesn't exists. Exiting..."
        Wscript.Quit 1
    End If
    End Function

    Sub WriteIni( myFilePath, mySection, myKey, myValue )
    ' This subroutine writes a value to an INI file
    '
    ' Arguments:
    ' myFilePath  [string]  the (path and) file name of the INI file
    ' mySection   [string]  the section in the INI file to be searched
    ' myKey       [string]  the key whose value is to be written
    ' myValue     [string]  the value to be written (myKey will be
    '                       deleted if myValue is <DELETE_THIS_VALUE>)
    '
    ' Returns:
    ' N/A
    '
    ' CAVEAT:     WriteIni function needs ReadIni function to run
    '
    ' Written by Keith Lacelle
    ' Modified by Denis St-Pierre, Johan Pol and Rob van der Woude

    Const ForReading   = 1
    Const ForWriting   = 2
    Const ForAppending = 8

    Dim blnInSection, blnKeyExists, blnSectionExists, blnWritten
    Dim intEqualPos
    Dim objFSO, objNewIni, objOrgIni, wshShell
    Dim strFilePath, strFolderPath, strKey, strLeftString
    Dim strLine, strSection, strTempDir, strTempFile, strValue

    strFilePath = Trim( myFilePath )
    strSection  = Trim( mySection )
    strKey      = Trim( myKey )
    strValue    = Trim( myValue )

    Set objFSO   = CreateObject( "Scripting.FileSystemObject" )
    Set wshShell = CreateObject( "WScript.Shell" )

    strTempDir  = wshShell.ExpandEnvironmentStrings( "%TEMP%" )
    strTempFile = objFSO.BuildPath( strTempDir, objFSO.GetTempName )

    Set objOrgIni = objFSO.OpenTextFile( strFilePath, ForReading, True )
    Set objNewIni = objFSO.CreateTextFile( strTempFile, False, False )

    blnInSection     = False
    blnSectionExists = False
    ' Check if the specified key already exists
    blnKeyExists     = ( ReadIni( strFilePath, strSection, strKey ) <> "" )
    blnWritten       = False

    ' Check if path to INI file exists, quit if not
    strFolderPath = Mid( strFilePath, 1, InStrRev( strFilePath, "\" ) )
    If Not objFSO.FolderExists ( strFolderPath ) Then
        WScript.Echo "Error: WriteIni failed, folder path (" _
                   & strFolderPath & ") to ini file " _
                   & strFilePath & " not found!"
        Set objOrgIni = Nothing
        Set objNewIni = Nothing
        Set objFSO    = Nothing
        WScript.Quit 1
    End If

    While objOrgIni.AtEndOfStream = False
        strLine = Trim( objOrgIni.ReadLine )
        If blnWritten = False Then
            If LCase( strLine ) = "[" & LCase( strSection ) & "]" Then
                blnSectionExists = True
                blnInSection = True
            ElseIf InStr( strLine, "[" ) = 1 Then
                blnInSection = False
            End If
        End If

        If blnInSection Then
            If blnKeyExists Then
                intEqualPos = InStr( 1, strLine, "=", vbTextCompare )
                If intEqualPos > 0 Then
                    strLeftString = Trim( Left( strLine, intEqualPos - 1 ) )
                    If LCase( strLeftString ) = LCase( strKey ) Then
                        ' Only write the key if the value isn't empty
                        ' Modification by Johan Pol
                        If strValue <> "<DELETE_THIS_VALUE>" Then
                            objNewIni.WriteLine strKey & "=" & strValue
                        End If
                        blnWritten   = True
                        blnInSection = False
                    End If
                End If
                If Not blnWritten Then
                    objNewIni.WriteLine strLine
                End If
            Else
                objNewIni.WriteLine strLine
                    ' Only write the key if the value isn't empty
                    ' Modification by Johan Pol
                    If strValue <> "<DELETE_THIS_VALUE>" Then
                        objNewIni.WriteLine strKey & "=" & strValue
                    End If
                blnWritten   = True
                blnInSection = False
            End If
        Else
            objNewIni.WriteLine strLine
        End If
    Wend

    If blnSectionExists = False Then ' section doesn't exist
        objNewIni.WriteLine
        objNewIni.WriteLine "[" & strSection & "]"
            ' Only write the key if the value isn't empty
            ' Modification by Johan Pol
            If strValue <> "<DELETE_THIS_VALUE>" Then
                objNewIni.WriteLine strKey & "=" & strValue
            End If
    End If

    objOrgIni.Close
    objNewIni.Close

    ' Delete old INI file
    objFSO.DeleteFile strFilePath, True
    ' Rename new INI file
    objFSO.MoveFile strTempFile, strFilePath

    Set objOrgIni = Nothing
    Set objNewIni = Nothing
    Set objFSO    = Nothing
    Set wshShell  = Nothing
    End Sub
         '
         '
    Call  WriteINI("c:\testarea\Test.INI","Section1","Item1","Value1")
    Call  WriteINI("c:\testarea\Test.INI","Section1","Item2","Value2")
    Call  WriteINI("c:\testarea\Test.INI","Section1","Item3","Value3")
    Call  WriteINI("c:\testarea\Test.INI","Section2","Item4","Value4")
    Call  WriteINI("c:\testarea\Test.INI","Section2","Item5","Value5") 
```

# css - CSS 未在 Firefox 中加载

> ID：1020834
> 
> 赞同：3
> 
> 时间：2009-06-20T03:06:35.080
> 
> 标签：css, internet-explorer, firefox

我有一个在 IE 和 FF 中测试的网页。它在 IE 中完美运行，但在 Firefox 中无法加载样式表。

有没有其他人在使用 Firefox 时遇到过这种类型的问题？

另请注意，这仅在我的开发工作站上加载本地文件...

这是html文件的标题部分：

```
<head>

<link  rel="stylesheet" type="text/css" href="\\server\USERS$\myID\Projects\Intranet\css\common.css">
<link  rel="stylesheet" type="text/css" href="\\server\USERS$\myID\Projects\Intranet\css\css.css">

<title>8927.html</title>
</head> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-20T03:49:34.530

**UNC 路径**

如果您要链接到 UNC 路径中的文件（例如，\\servername\share\file.ext），则需要指定路径：

```
file://///servername/share/file.ext 
```

另请注意，由于存在错误，您无法链接到 file://///servername 以获取该主机名的共享列表。

来源： http: [//kb.mozillazine.org/Links_to_local_pages_don%27t_work](http://kb.mozillazine.org/Links_to_local_pages_don%27t_work)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T03:45:37.920

CSS 在 Firefox 中的处理方式与在 IE 中不同。

但是，如果您的 css 在任何浏览器中都可以正常工作，请尝试：

*   清除 FF 缓存
*   在 Chrome 或 Safari 中测试

您的页面是否有任何代码检查浏览器类型，当它检测到它是 FF 时可能会停止 CSS？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T03:52:13.577

好的，我使用以下方法修复了它，它现在可以在 IE 和 FF 中使用：

```
<link  rel="stylesheet" type="text/css" href="../css/common.css">
<link  rel="stylesheet" type="text/css" href="../css/css.css"> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T03:52:51.427

一个疯狂的猜测，因为我无法复制您的环境：我想知道 Firefox 是否在路径中的 $ 或反斜杠方面存在问题。我首先尝试用正斜杠替换反斜杠，然后尝试对 $ 进行 URL 编码（即，用 %24 替换它）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-20T11:34:13.037

我不时遇到与javascript文件类似的问题。我认为 Firefox 有时区分大小写，因此请确保文件的路径及其实际名称使用相同的大小写。

# eclipse - 最好的待办事项列表管理软件

> ID：1020835
> 
> 赞同：12
> 
> 时间：2009-06-20T03:06:54.503
> 
> 标签：eclipse, project-management, todo

我正在寻找一种简单、易于使用、有效的待办事项列表管理。

如果我可以链接到我的代码来更改待办事项，那就更好了。

是否有任何开源解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-20T03:10:01.517

根据您使用的平台，有一些选项。对于 Eclipse，有[Mylyn 项目](http://www.eclipse.org/mylyn/)

*Robert Munteanu 的贡献：*查看[此博客](http://tasktop.com/blog/mylyn/how-to-task-focused-programming)以获得温和的介绍。此外，使用 Mylyn 允许您在准备就绪时将任务*迁移*到真正的后端，例如 Bugzilla、Trac、Mantis 等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-06-16T13:01:35.927

基于 Web 的待办事项列表管理工具非常适合管理此类任务。

尽管它们没有直接链接到您的代码，但它们增加了一些优势，例如与同事共享待办事项列表、使待办事项列表无论您身在何处都可用，以及在您离开办公桌时允许移动访问。

## [记住牛奶](http://www.rememberthemilk.com/)

直观的界面使管理任务变得有趣。下周五或两周后轻松设置截止日期。广泛的键盘快捷键使任务管理比以往更快。

## [谷歌任务](http://mail.google.com/mail/help/tasks/)

只需单击并键入以添加新任务、设置截止日期或添加注释，然后（最令人满意地）在完成时将它们核对掉。无论您如何访问它，您的任务列表都会保持最新。这是一个简单的清单，无论您走到哪里，都可以随身携带。

## [双人船](http://teuxdeux.com/)

TeuxDeux 是一款简单、设计感强、基于浏览器的待办事项应用程序，也是工作室伙伴 swissmiss 和 Fictive Kin 之间的首次合作。

## [粗糙的下腹部](http://roughunderbelly.com/user/login)

Online CEO 任务管理目前是 Topfunky Corporation 的免费（且不受支持）服务。

将来可能会收取少量费用，但总会有免费计划，因此请尝试一下。

## [嘟嘟嘟](http://www.toodledo.com/)

一个易于使用的在线待办事项列表。变得井井有条、保持积极性并提高工作效率。

## [Zoho 规划师](http://www.zohoplanner.com/login?serviceurl=%2Flogin.do)

添加待办事项、笔记和图像。与您的朋友分享。完成任务 - 简单且免费。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T03:10:28.303

不确定这是否是您正在寻找的，但它是一个很棒的免费工具，带有源代码：

[ToDoList - 一种简单但有效的方式来掌握您的任务](http://www.codeproject.com/KB/applications/todolist2.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T14:22:38.640

我相信许多 Eclipse 透视图都能够处理代码中的待办事项。

如果你有类似的东西：

```
if (something == true) {
    //@todo add something to do
} 
```

它将显示在任务窗格中，您可以单击列表项跳转到代码中的该点。

编辑：我检查过，我使用的 php 插件没有，但 java 有。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T04:01:48.260

您可以在 Visual Studio 的任何代码文件中添加“todo: my notes here”。然后所有项目都在“任务列表”窗口中可见。

# javascript - 当您编写 Titanium 应用程序时，源代码对用户可见吗？

> ID：1020838
> 
> 赞同：2
> 
> 时间：2009-06-20T03:08:01.037
> 
> 标签：javascript, python, ruby, ria, titanium

当您为 Adob​​e AIR 编写 HTML/CSS/JavaScript 应用程序时，源文件位于任何人都可以看到的目录中。

[Appcelerator Titanium](http://www.appcelerator.com/products/titanium-desktop/)允许您使用 JavaScript、Python 和 Ruby 编写代码。捆绑是否类似于 AIR，所有源都暴露出来？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-22T08:54:22.920

根据[Titanium FAQ](http://titaniumapp.com/faq/if-i-build-my-app-in-titanium-and-distribute-it-is-the-source-code-visible-to-the-user-in-other-words-can-the-program-be-compiled-into-a-binary-format)，是的，任何寻找它的人都可以访问您的源代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-10T09:04:43.803

正如[Nosredna](https://stackoverflow.com/users/61027/nosredna)在评论中添加的那样，他们似乎已经意识到他们新框架版本中的这种变化。

查看这个[问题](https://stackoverflow.com/questions/2444001/how-does-appcelerator-titanium-mobile-work)，从 appcelerator 中获得有关框架如何工作的一些见解。我理解这是一个编译过程，不会在包中留下你的 js 文件的痕迹。

# python - 如何在 Python 中进行简单的命令行聊天？

> ID：1020839
> 
> 赞同：12
> 
> 时间：2009-06-20T03:08:03.173
> 
> 标签：python

我学习网络编程，想用 Python 写一个简单的命令行聊天。

我想知道如何使接收和输入保持不变，以便随时发送。

如您所见，此客户端一次只能完成一项工作：

```
from socket import *

HOST = 'localhost'
PORT = 21567
BUFSIZE = 1024
ADDR = (HOST, PORT)

tcpCliSock = socket(AF_INET, SOCK_STREAM)
tcpCliSock.connect(ADDR)

while 1:
    data = raw_input('> ')
    if not data: break
    tcpCliSock.send(data)
    data = tcpCliSock.recv(BUFSIZE)
    if not data: break
    print data

tcpCliSock.close() 
```

所以如果另一个客户端发送了一条消息，这个客户端也只有在发送一条消息后才会收到它。我打赌你理解我。我搜索了这个问题，发现了很多有趣的东西，比如异步 I/O、线程、非阻塞同步、并发编程等等。我还安装了 twisted 包。简而言之，我一直在学习所有这些东西，但还没有找到我想要的东西。（当然，我会不断尝试，直到我明白这一点。）

所以，我的问题是如何做到这一点？=)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-21T04:52:44.253

你的问题不是很连贯。但是，您的程序根本不需要异步即可达到您的要求。

这是您最初想要的一个工作聊天脚本，只需进行最少的更改。它使用 1 个线程接收和 1 个发送，都使用阻塞套接字。它比使用异步方法简单得多。

```
from socket import *
from threading import Thread
import sys

HOST = 'localhost'
PORT = 21567
BUFSIZE = 1024
ADDR = (HOST, PORT)

tcpCliSock = socket(AF_INET, SOCK_STREAM)
tcpCliSock.connect(ADDR)

def recv():
    while True:
        data = tcpCliSock.recv(BUFSIZE)
        if not data: sys.exit(0)
        print data

Thread(target=recv).start()
while True:
    data = raw_input('> ')
    if not data: break
    tcpCliSock.send(data)

tcpCliSock.close() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-20T03:12:45.613

如果您想从头开始编写代码，`select`则可以走（您可以在 Google 图书搜索上阅读涵盖此类问题的 Python in a Nutshell 的大部分章节）；如果你想利用更多的抽象，`asyncore`它是可用的，但[Twisted](http://twistedmatrix.com/trac/)更丰富、更强大。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T10:45:08.750

聊天程序同时做两件事。

1.  监视本地用户的键盘并发送给远程用户（通过某种套接字）

2.  观察远程套接字并在本地控制台上显示他们键入的内容。

你有几种方法可以做到这一点。

1.  打开套接字和键盘并使用[选择](http://docs.python.org/library/select.html)模块查看哪个已准备好输入的程序。

2.  创建两个线程的程序。一个线程读取远程套接字并打印。另一个线程读取键盘并发送到远程套接字。

3.  一个分叉两个子进程的程序。一个子进程读取远程套接字并打印。另一个子进程读取键盘并发送到远程套接字。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-20T13:58:47.127

好吧，这就是我此刻所拥有的。

服务器是这样的：

```
import asyncore
import socket

clients = {}

class MainServerSocket(asyncore.dispatcher):
    def __init__(self, port):
        asyncore.dispatcher.__init__(self)
        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)
        self.bind(('',port))
        self.listen(5)
    def handle_accept(self):
        newSocket, address = self.accept( )
        clients[address] = newSocket
        print "Connected from", address
        SecondaryServerSocket(newSocket)

class SecondaryServerSocket(asyncore.dispatcher_with_send):
    def handle_read(self):
        receivedData = self.recv(8192)
        if receivedData:
            every = clients.values()
            for one in every:
                one.send(receivedData+'\n')
        else: self.close( )
    def handle_close(self):
        print "Disconnected from", self.getpeername( )
        one = self.getpeername( )
        del clients[one]

MainServerSocket(21567)
asyncore.loop( ) 
```

客户端就像这样：

```
from Tkinter import *
from socket import *
import thread

HOST = 'localhost'
PORT = 21567
BUFSIZE = 1024
ADDR = (HOST, PORT)

tcpCliSock = socket(AF_INET, SOCK_STREAM)
tcpCliSock.connect(ADDR)

class Application(Frame):
    def __init__(self, master):
        Frame.__init__(self, master)
        self.grid()
        self.create_widgets()
        self.socket()

    def callback(self, event):
        message = self.entry_field.get()
        tcpCliSock.send(message)

    def create_widgets(self):
        self.messaging_field = Text(self, width = 110, height = 20, wrap = WORD)
        self.messaging_field.grid(row = 0, column = 0, columnspan = 2, sticky = W)

        self.entry_field = Entry(self, width = 92)
        self.entry_field.grid(row = 1, column = 0, sticky = W)
        self.entry_field.bind('<Return>', self.callback)

    def add(self, data):
        self.messaging_field.insert(END, data)

    def socket(self):
        def loop0():
            while 1:
                data = tcpCliSock.recv(BUFSIZE)
                if data: self.add(data)

        thread.start_new_thread(loop0, ())

root = Tk()
root.title("Chat client")
root.geometry("550x260")

app = Application(root)

root.mainloop() 
```

现在是时候让代码看起来更好并添加一些功能了。

谢谢你的帮助，伙计们！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-20T03:14:06.017

您应该使用[select](http://linux.die.net/man/2/select)。

查看：

*   [另一个选择链接](http://docs.python.org/library/select.html)
*   [如何](http://www.amk.ca/python/howto/sockets/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-20T03:19:09.627

我在异步 I/O 中编写了一个……它比完整的线程模型更容易理解。

如果你能拿到“talk”的源代码，你就能学到很多。查看演示[http://dsl.org/cookbook/cookbook_40.html#SEC559](http://dsl.org/cookbook/cookbook_40.html#SEC559)，或者如果您使用的是 linux 机器，请自行尝试...

它实时发送字符。

此外，ytalk 是交互式的和多个用户......有点像 hudddlechat 或 campfire。

# mysql - “[MySQL] 连接是邪恶的” - Cal Henderson

> ID：1020847
> 
> 赞同：15
> 
> 时间：2009-06-20T03:10:56.943
> 
> 标签：mysql

Flickr 的 Cal Henderson[发表了 DjangoCon 2008 的主题演讲](http://www.youtube.com/watch?v=i6Fr65PFqfk)。他简要谈到了 Django 框架在查询中使用表连接，并断言，“当你达到一定规模时，你不会使用连接。” 我希望亨德森对这些事情了如指掌，但有谁知道他声称的可能原因是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-21T09:01:41.033

当我说他们是邪恶的时候，我有些夸大了。

对于非常大的数据集，即使它们适合单个数据库，连接也是一项昂贵的操作（大量非顺序 IO）。对于典型的 Web 应用程序负载（90/10 读/写），您的读取需要尽可能便宜，同时您可以将更多时间花在写入上（并且在许多情况下懒惰地复制写入）。在典型的高性能 Web 应用程序中，您将希望在几百毫秒内执行所有数据库 IO，因此这是您的第一个限制。其次，您希望能够处理大量并发请求。这往往表明能够直接从大型表的索引中收集记录。有人已经提到您不需要向浏览器发送大量数据，因此不需要跨整个数据集执行连接，但请考虑订购：如果可以的话

对于多机分区数据，同样的问题也适用，但规模更大。通常的解决方案是物化视图（数据扁平化），通过在插入/更新/删除时（或之后延迟）执行多次写入并使用非常简单的索引选择来启用类似连接的查询。

显然，连接很有用，并且在大多数情况下都非常好。但是对于原生不支持物化视图的数据库中的大型数据集，这在大型数据集的高并发下会下降。

而对 Django 的具体抱怨是，由于在现有数据上更改模型的不灵活，人们被鼓励创建仅连接的一对一映射表，而不是向现有表添加列。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-20T03:19:13.933

所有大型可扩展系统都必须不加入。原因是对于高度分布式的数据库，例如 Google 使用的 BigTable，数据非常庞大，以至于它们超出了单台机器的范围。连接两个大小为 GB 的表是不可扩展的。事实上，如果您进行大量连接，您将看到大约 500 万行，您的 RDBMS 将开始严重依赖索引。在分布式数据库和文档数据库（如 mongodb、couchdb 等）中，索引也更难。

未来是一个很好的架构模型作为基础，然后是数据副本和插入更新队列后，以制作扁平连接表并随着每组行的更改而更新。MSSQL、Oracle 等中的大型 RDBMS 都达到了需要数据仓库和数据扁平化以实现报告速度和 Web 等高可扩展需求的地步。

当我们获得 TB 级数据时，Join 将成为过去。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-20T03:20:46.317

我认为这是一个粗略的概括。包括连接在内的关系数据库概念是现代应用程序程序员可用的一些最有用和最有价值的工具。

对于海量数据集，诸如非规范化之类的概念有其优点。如今，我们倾向于将大型 Web 应用程序开发人员（如 Facebook、MySpace 等）的话当作福音，而不考虑上下文。

除非您增长超过 300-4 亿行标记，否则带有索引和外键的优化连接将很好（我不能说更大，因为这大约是我们开始归档最大应用程序的限制我现在开始工作）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-20T03:28:49.497

我倾向于不同意，因为如果你设计好你的数据库，你可以获得性能。我们有一个用 Kimball 星型模式建模的多 TB 数据仓库，您必须将事实加入维度以进行任何类型的分析并执行（因为它是分区和索引的）。但是我必须在一个进程中生成 2 亿行汇总输出。这种信息量根本不会推送给用户。

但是，对于典型的面向客户端的 Web 应用程序，每次生成页面时返回有限数量的数据，您加入多少？相反，您的应用程序服务器可以请求行，然后请求相关的行，等等。当关系数据库在用 C 编程的 64K 小型 8086 手持设备上不可用时，我们有一个 ISAM 库，我们必须在其中查找和读取表，然后在另一个表中查找和读取。如果您不处理大量数据，那么自己完成工作同样容易。

但它更多的是编程，更多的代码意味着更多的错误。这也意味着数据库安全性和约束/关系完整性模型非常薄弱。如果没有 JOIN，您将对数据库进行更多的访问。在最好的情况下，您将从数据库服务器返回相同数量的信息到 Web 服务器。如果 Web 服务器希望根据之前检索到的行过滤这些行，情况会变得更糟。实际上，Web 服务器**仍在**执行 JOIN，但当然，横向扩展 Web 服务器要容易一些，并且需要较少的关系引擎优化专业知识。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-20T03:18:38.597

在一定的性能水平上，您非常关心需要移动磁头多少次才能满足查询。要通过 JOIN 将两条记录放在一起，您需要至少移动磁头两次，除非一条或两条记录完全保存在索引中，并且索引被缓存。（将列添加到索引以便满足查询所需的列从索引中出来是一种常见的技术，但是索引元组越宽，可以缓存的越少。）最终你达到了你想要的记录的规模加入不受同一个数据库实例的控制。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-20T03:35:26.520

当您扩大规模时，您会开始放弃功能，因为它们会花费一些东西。子查询优先；然后最终甚至加入。这将使您可以对表和索引做任何您需要的事情——比如谷歌。

SQL 数据库通常建立在 isams 之上——它们只是表和索引。所以他只是说他越来越接近金属了。想想看，我猜是 MyISAM。因此，您省去了优化器为您解决问题的麻烦。我肯定会从那里继续。但恕我直言，第一步是摆脱 SQL 解析器/优化器的开销并直接操作表和索引。就像它曾经在foxpro等中一样。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-20T03:18:49.160

加入是一种成本。您仍然将数据连接或组合在一起并为其付费，但您将成本推迟到更容易扩展的更便宜的应用程序层。

# jquery - 根据 ID 依次显示 LI

> ID：1020868
> 
> 赞同：2
> 
> 时间：2009-06-20T03:25:30.660
> 
> 标签：jquery, events, effects

我正在创建一个调用 javascript 效果并将其应用于 LI 的 for 循环，按顺序执行。这是我所拥有的：

```
$(document).ready(function () {
    for(i=1;i<=10;i++) {
        $("li#"+i).show();
    }
}); 
```

但是，这不起作用。我需要它来将效果应用于 LI#1，然后是 LI#2、LI#3……等等。

我正在尝试做的类似于 Twitter 在您单击页面底部的“更多”按钮而不是跳跃时所做的事情，我希望它放松一下。

**编辑：**我不能只将 LI 包装在 DIV 中，因为我要将 LI 添加到 UL 元素中。

但是，如果有一种方法可以在 UL 改变大小时对其进行动画处理，我会全力以赴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T03:37:56.780

```
$(document).ready(function () {
    for(i=1;i<=10;i++) {
        $("li#"+i).show("slow");
    }
}); 
```

看看[show( speed, [callback] )](http://docs.jquery.com/Effects/show)。从文档：

> 使用优美的动画显示所有匹配的元素，并在完成后触发可选的回调。
> 
> 每个匹配元素的高度、宽度和不透明度根据指定的速度动态变化。

此外，还有其他方法可以隐藏和显示元素，例如[fadeIn](http://docs.jquery.com/Effects/fadeIn)和[fadeOut](http://docs.jquery.com/Effects/fadeOut)。看看[http://docs.jquery.com/Effects](http://docs.jquery.com/Effects)。

我用静态数据快速模拟了你所追求的那种东西：

```
var $lis = $('<li>blha blhahah lajlkdj</li><li>blha blhahah lsdfsajlkdj</li>').hide();
$('ul').append($lis);
$lis.show("slow"); 
```

并且它有效，因此可以想象您可以执行以下操作，而不必为迭代元素 ID 的头痛而烦恼：

```
$.load('/items/?p=2',function(data) {
    var $lis = $(data).hide();
    $('ul').append($lis);
    $lis.show("slow");
}); 
```

为了清楚起见，上面对[$.load](http://docs.jquery.com/Ajax/load)的调用假定您站点上**/items/?p=2**的输出是一堆 LI

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T04:15:28.483

如果您希望每个都以相同的速度出现，但每个之间有轻微的延迟，您可能需要使用 setTimeout... 例如...

```
$(document).ready(function () {        
    var showListItem = function(index) {
        $("li#"+index).show("slow")
    };
    for(i=1;i<=10;i++) {
        setTimeout(function() { showListItem(i); }, (i * 100))
    }
}); 
```

这可能看起来有点傻，但如果我没记错的话，除非您将索引 (i) 包装在某种外壳中，否则执行的方法将始终将 i 的值视为 10。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T03:41:13.047

此外，请确保如果您在另一个通过 Ajax 加载新项目的事件上触发此事件（例如在单击“更多”按钮之后），那么您需要将逻辑包装在 jQuery 1.3 中可用的[.live()中。](http://docs.jquery.com/Events/live)

如果您使用的是 jQuery 1.2，则可以改用[livequery](http://docs.jquery.com/Plugins/livequery)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T04:55:24.163

如果您有这样的列表，应该这样做：

```
<ul id='menu' style='display: none;'>
<li>item 1</li>
<li>item 2</li>
<li>item 3</li>
<li>item 4</li>
<li>item 5</li>
<li>item 6</li>
<li>item 7</li>
</ul> 
```

然后，您可以编写代码来按顺序显示列表项，如下所示：

```
$('#menu').show().find('li').hide().bind('show', function() {
  $(this).show('slow', function() {
    $(this).next('li').trigger('show');
  });
}).filter(':first').trigger('show'); 
```

代码执行以下操作：找到菜单`<ul>`，显示它，找到所有`<li>`并隐藏它们，绑定一个名为的自定义事件`show`，它会慢慢显示元素，一旦完全显示，查看`<li>`它旁边是否有任何东西并触发该元素的相同事件。然后我们从所有唯一的第一个中过滤`<li>`，并为它触发这个自定义事件，基本上触发了多米诺骨牌效应。

[这是它在工作中的一个例子](http://jsbin.com/idoso)。如果您想要更快，您可以将“慢”更改为“快”或一段时间。

# c# - 我可以在 ASP.NET MVC 站点中路由 Web 服务 (ASMX) 的 url 吗？

> ID：1020875
> 
> 赞同：5
> 
> 时间：2009-06-20T03:34:10.813
> 
> 标签：c#, .net, asp.net-mvc, httphandler

我已经看到了如何使用这样的代码向 WebForms 添加自定义路由。

```
public class WebFormsRouteHandler : IRouteHandler
{
    public string VirtualPath { get; set; }

    public IHttpHandler GetHttpHandler(RequestContext requestContext)
    {
        // Compiles ASPX (if needed) and instantiates the web form
        return (IHttpHandler) BuildManager.CreateInstanceFromVirtualPath(VirtualPath, typeof (IHttpHandler));
    }
} 
```

我正在尝试使类似的事情起作用，但对于 Web 服务文件 (TestService.asmx)。以前的方法会引发异常，因为该页面不是从 IHttpHandler 继承的。我见过其他一些使用 WebServiceHandlerFactory 的代码

```
return new WebServiceHandlerFactory().GetHandler(context, requestType, url, pathTranslated); 
```

这会返回一个我需要的 IHttpHandler，但它需要传入一个 HttpContext，但作为 RequestContext 的一部分，我唯一可以访问的是 HttpContextBase。据我所知，我无法从中转换为 HttpContext 。

有任何想法吗？或者也许是一种不同的方式去解决它？我想要完成的是通过正常的路由系统控制我的 Web 服务的 url。一个例子是希望 TestService.asmx 作为 ExampleTestService/ 出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-09-28T11:34:49.983

我就是这样做的：

```
 Return New WebServiceHandlerFactory().GetHandler(HttpContext.Current, "*", "/Build/WebService.asmx", HttpContext.Current.Server.MapPath(aspxToLoad)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T12:53:22.783

有趣的想法。我不知道你可以那样使用网络表单。我们目前正在将旧的 Web 表单应用程序与`IgnoreRoutes`. 我一定会为您的问题添加书签；）

但也许我可以帮你解决你的问题。好的旧的`HttpContext`仍然存在，它只是被 MVC 包装到 mock friendly`HttpContextBase`中。

您可以`HttpContext`使用

```
var context = System.Web.HttpContext.Current; 
```

在控制器中，您必须完全指定类型以将其与名为的控制器属性区分开来`HttpContext`

# image - Delphi 7 中使用 Paradox 实时 BMP 到 JPG 转换

> ID：1020876
> 
> 赞同：2
> 
> 时间：2009-06-20T03:34:12.513
> 
> 标签：image, delphi, clipboard, jpeg, bmp

在这里和 Code News Fast 进行研究，我没有看到任何与我的问题有关的内容。我有一个应用程序，当用户单击我的应用程序中的按钮以加载它时，通过剪贴板从第三方拍照程序获取客户图片（JvDBImage）。(PhotoImage.PasteFromClipboard)。这会将图像加载并保存为位图……有时是 BIG BMP。所以，我需要一些可以保存和加载 JPG 的东西。

我试过：.. 使用 JPeg

```
var
   jpg     : TJpegImage;
begin
  PhotoImage.PasteFromClipboard;
//  // convert to JPEG
//  jpg.Create;
//  jpg.Assign(PhotoImage.Picture);
//  PhotoImage.Picture := jpg;
//  freeAndNil(jpg);
end; 
```

这不会编译，因为分配是两种不同的类型。我还花了一些时间在剪贴板上工作，试图将其放入 TMemoryStream 中，但没有成功。

我的下一个尝试是将其临时保存到文件中，然后将其作为 JPG 检索，但这会很慢，而且我不确定我正在尝试做的事情是否可行。所以，与其走另一条小巷，我想我会在这里发布问题。

有问题的数据库有一个名为 Photo 的 memo(1) 字段，PhotoImage 连接到该字段。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-20T04:06:06.343

[此页面](http://www.swissdelphicenter.ch/torry/showcode.php?id=874)至少显示了如何将剪贴板内容转换为 JPEG：

```
uses
  Jpeg, ClipBrd;

procedure TfrmMain.ConvertBMP2JPEG;
  // converts a bitmap, the graphic of a TChart for example, to a jpeg
var 
  jpgImg: TJPEGImage;
begin
  // copy bitmap to clipboard
  chrtOutputSingle.CopyToClipboardBitmap;
  // get clipboard and load it to Image1
  Image1.Picture.Bitmap.LoadFromClipboardFormat(cf_BitMap,
    ClipBoard.GetAsHandle(cf_Bitmap), 0);
  // create the jpeg-graphic
  jpgImg := TJPEGImage.Create;
  // assign the bitmap to the jpeg, this converts the bitmap
  jpgImg.Assign(Image1.Picture.Bitmap);
  // and save it to file
  jpgImg.SaveToFile('TChartExample.jpg');
end; 
```

这段代码很不完整，我不确定它是否正确，但是使用的方法应该是正确的，而且应该不难纠正（例如，cf_BitMap 应该是 HBITMAP，你不需要“ CopyToClipboardBitmap" 行，因为您似乎已经将数据存储在那里）。您还应该查看 TJPEGImage 类以将图像质量和其他参数设置为适合您需要的值。

但是，如果您想实时为大图像执行此操作，则最好寻找一些可以使用的 JPG 库。可能有一些比 Delphi 例程执行得更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-11T22:07:27.513

这是我几年前为处理 JPEG 图像而编写的一些代码的摘录。它演示了加载和保存 jpeg 文件，从 blob 字段存储和检索 jpeg 数据，以及 jpeg 和 bmp 之间的转换。

'_proper' 程序演示了通过从 JPEG -> BMP -> JPEG 重新压缩图像。'_update_display' 过程演示了如何在画布上绘制 TJpegImage 以便用户可以看到它。

```
//Take the supplied TJPEGImage file and load it with the correct
//data where _gas_check_key is pointing to.
//Return 'true' on success, 'false' on failure.
function TfrmGcImage._load_image(var image: TJPEGImage): Boolean;
var
    blob_stream: TStream;
begin
   //Get the current image into image_field
    _query_current_image();

    blob_stream := Query1.CreateBlobStream
        ( Query1.FieldByName('GcImage') as TBlobField, bmRead);
    try
        _load_image := False;
        if blob_stream.Size > 0 then
        begin
            image.LoadFromStream(blob_stream);
            _load_image := True;
        end;
    finally
        blob_stream.Free;
    end;
end;

{   Extract Exif information representing the dots per inch of the physical
    image.

    Arguments:
        file_name: name of file to probe
        dpi_h: horizontal dpi or 0 on failure.
        dpi_v: vertical dpi or 0 on failure.

    Returns: True for successful extraction, False for failure
}
function TfrmGcImage._get_dpi
    (file_name: string; var dpi_h, dpi_v: Integer): Boolean;
var
    exif: TExif;
begin
    exif := TExif.Create;
    try
        exif.ReadFromFile(file_name);
        dpi_h := exif.XResolution;
        dpi_v := exif.YResolution;
    finally
        exif.Free;
    end;

    //Even though the file did have Exif info, run this check to be sure.
    _get_dpi := True;
    if (dpi_h = 0) or (dpi_v = 0) then
        _get_dpi := False;
end;

procedure TfrmGcImage._update_display();
var
    image_jpeg: TJPEGImage;
    thumbnail: TBitmap;
    dest_rect: TRect;
begin
    thumbnail := TBitmap.Create;
    try
        image_jpeg := TJpegImage.Create;
        try
            if (not _load_image(image_jpeg)) or (not _initialized) then
                _load_no_image_placeholder(image_jpeg);
            thumbnail.Width := Image1.Width;
            thumbnail.Height := Image1.Height;
            dest_rect := _scale_to_fit
                ( Rect(0, 0, image_jpeg.Width, image_jpeg.Height)
                , Rect(0, 0, thumbnail.Width, thumbnail.Height));
            thumbnail.Canvas.StretchDraw(dest_rect, image_jpeg);
        finally
            image_jpeg.Free;
        end;
        Image1.Picture.Assign(thumbnail);
    finally
        thumbnail.Free;
    end;
end;

{
    Calculate a TRect of the same aspect ratio as src scaled down to
    fit inside dest and properly centered
}
function TfrmGcImage._scale_to_fit(src, dest: TRect): TRect;
var
    dest_width, dest_height: Integer;
    src_width, src_height: Integer;
    margin_lr, margin_tb: Integer;
begin
    dest_width := dest.Right - dest.Left;
    dest_height := dest.Bottom - dest.Top;
    src_width := src.Right - src.Left;
    src_height := src.Bottom - src.Top;

    //Must not allow either to be larger than the page
    if src_width > dest_width then
    begin
        src_height := Trunc(src_height * dest_width / src_width);
        src_width := dest_width;
    end;
    if src_height > dest_height then
    begin
        src_width := Trunc(src_width * dest_height / src_height);
        src_height := dest_height;
    end;

    margin_lr := Trunc( (dest_width - src_width) / 2);
    margin_tb := Trunc( (dest_height - src_height) / 2);

    _scale_to_fit.Left := margin_lr + dest.Left;
    _scale_to_fit.Right := dest.Right - margin_lr;
    _scale_to_fit.Top := margin_tb + dest.Top;
    _scale_to_fit.Bottom := dest.Bottom - margin_tb;
end;

{
    Take a Jpeg image and resize + compress
}
procedure TfrmGcImage._proper(var image: TJpegImage; dpi_h, dpi_v: Integer);
var
    scale_h, scale_v: Single;
    bitmap: TBitmap;
begin
    scale_h := dpi / dpi_h;
    scale_v := dpi / dpi_v;

    bitmap := TBitmap.Create;
    try
        bitmap.Width := Trunc(image.Width * scale_h);
        bitmap.Height := Trunc(image.Height * scale_v);
        bitmap.Canvas.StretchDraw
            ( Rect
                ( 0, 0
                , bitmap.Width
                , bitmap.Height)
            , image);
        with image do
        begin
            Assign(bitmap);
            JPEGNeeded();
            CompressionQuality := 75;
            GrayScale := True;
            DIBNeeded();
            Compress();
        end;
    finally
        bitmap.Free;
    end;

end;

procedure TfrmGcImage.Import1Click(Sender: TObject);
var
    blob_stream: TStream;
    image: TJPEGImage;
    dpi_h, dpi_v: Integer;
    open_dialog: TOpenPictureDialog;
    file_name: string;
begin
    if not _initialized then Exit;

    //locate file to import.
    open_dialog := TOpenPictureDialog.Create(Self);
    try
        open_dialog.Filter := GraphicFilter(TJpegImage);
        open_dialog.Title := 'Import';
        if not open_dialog.Execute() then Exit;
        file_name := open_dialog.FileName;
    finally
        open_dialog.Free;
    end;

    image := TJpegImage.Create();
    try
        try
            image.LoadFromFile(file_name);
        except
            ShowMessage(file_name + ' could not be imported.');
            Exit;
        end;
        if not _get_dpi(file_name, dpi_h, dpi_v) then
        begin
            if not _get_dpi_from_user
                ( image.Width, image.Height, dpi_h, dpi_v) then Exit
            else if (dpi_h = 0) or (dpi_v = 0) then Exit;
        end;

        _proper(image, dpi_h, dpi_v);

        //Create a TBlobStream to send image data into the DB
        _query_current_image();
        Query1.Edit;
        blob_stream := Query1.CreateBlobStream
            (Query1.FieldByName('Gcimage') as TBlobField, bmWrite);
        try
            image.SaveToStream(blob_stream);
        finally
            Query1.Post;
            blob_stream.Free;
        end;
    finally
        image.Free;
    end;

    _update_display();
end;

procedure TfrmGcImage.Export1Click(Sender: TObject);
var
    save_dialog: TSavePictureDialog;
    blob_stream: TStream;
    image: TJpegImage;
    file_name: string;
begin
    if not _initialized then Exit;

    //decide where to save the image
    save_dialog := TSavePictureDialog.Create(Self);
    try
        save_dialog.DefaultExt := GraphicExtension(TJpegImage);
        save_dialog.Filter := GraphicFilter(TJpegImage);
        if not save_dialog.Execute() then Exit;
        file_name := save_dialog.FileName;
    finally
        save_dialog.Free;
    end;

    //locate the appropriete image data
    _query_current_image();

    //Create a TBlobStream to send image data into the DB
    Query1.Edit;
    blob_stream := Query1.CreateBlobStream
        ( Query1.FieldByName('Gcimage') as TBlobField
        , bmRead);
    image := TJpegImage.Create();
    try
        image.LoadFromStream(blob_stream);
        image.SaveToFile(file_name);
    finally
        Query1.Post;
        blob_stream.Free;
        image.Free;
    end;
end; 
```

# rdlc - 仅显示一次 RDLC 标头

> ID：1020878
> 
> 赞同：2
> 
> 时间：2009-06-20T03:35:02.573
> 
> 标签：rdlc

通常在 RDLC 报告中，如果您使用标题，它将在每一页上重复。

如果我只想在第一页上显示标题而不是其余部分，有什么解决方案？有没有办法告诉哪些页面上的标题可见？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-23T14:37:38.523

您不能使用页眉执行此操作。

您需要将标题控件移动到您的正文部分才能执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-12T07:40:26.053

我假设您的页眉包含一个文本框和一个图像。您可以做的最好的事情是 1.) 将页眉（包含图像和文本框）的高度最小化到尽可能小。

2.) 将图像大小属性设置为原始大小。

3.) 将文本框大小属性大小选项设置为“允许高度增加”。

4.) 将文本框字体大小属性设置为 =IIf(Globals!PageNumber <> 1 , "0pt", "12pt")

5.) 将文本框和图像可见性属性设置为“=(Globals!PageNumber <> 1)”，这将隐藏除 page1 之外的所有其他页面上的文本和图像。

第 4 步是可选的。一切顺利

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T13:25:00.653

首先删除页眉。

如果要在第一页显示数据，则仅将控件放在正文中的 tablix 控件之前。如果要在每个页面中显示数据，请将带有属性的控件重复设置为 tablix。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-11T20:54:29.960

只需将其放在 tablixes 上方的主体顶部即可

# php - 这个PHP框架可以识别吗？

> ID：1020888
> 
> 赞同：0
> 
> 时间：2009-06-20T03:43:07.800
> 
> 标签：php, frameworks

我刚刚得到了一些使用类似框架的 PHP 项目，但我不知道是哪一个。我之前体验过一些 Code Igniter、Django 和 Rails，但我无法确定具体的框架。我正在查看 PHP 文件以了解其来源的任何迹象，但它们似乎已被清除。我正在帮助的人对编程一无所知，所以他不能告诉我他们来自哪里。项目 helloworld 的目录结构如下：

```
helloworld/
    .htaccess
    index.php
    modules/
        hi/
            hi.php
        home.php
    system/
        conf.inc.php
        functions/
    theme/
        default/
            images/
            js/
            templates/
                home.tpl 
```

对于上述情况，Controller 代码似乎位于 modules 文件夹下。有人还可以告诉我以下语法正在使用哪个 PHP 模板引擎吗？在控制器代码（home.php）中访问模板，如下所示：

```
$tpl = new template;
$tpl -> Load("!theme/{$GLOBALS["THEME"]}/templates/home.tpl");
$tpl -> GetObjects();

// more PHP codes  here

$tpl -> CleanZones();
$tpl -> Flush(); 
```

示例查看代码：

```
<base href="{siteURL}/" target="_self" /> 
```

我不确定上面是自制的、现有框架的定制版本还是许多 PHP 框架之一的未修改版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T04:08:16.750

通过[快速的 google 关键字搜索](http://www.google.com.gt/search?q=tpl+template+GetObjects+CleanZones)，它看起来像是来自[PHPizabi](http://www.phpizabi.net/)的代码，一个“社交网络平台”......

# linux - 徽标编程语言实现

> ID：1020890
> 
> 赞同：26
> 
> 时间：2009-06-20T03:44:14.757
> 
> 标签：linux, windows, macos, logo-lang

Joel在[播客 #58](https://blog.stackoverflow.com/2009/06/podcast-58/ "Stackoverflow Podcast #58")中提出的[“笑话”问题](https://stackoverflow.com/questions/1003841/how-do-i-move-the-turtle-in-logo "如何移动 LOGO 中的乌龟？")让我非常怀念 Logo，这是我在 Basic 之后编写的第二门语言，这就是为什么我在大学里的递归从来没有遇到过任何问题。

是否有适用于 Windows 或 Linux（我可以使用的平台）或 Mac（因为我知道我在这个世界上并不孤单）的 Logo 实现？如何获得适用于我的计算机的 Logo 编程语言？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-31T07:32:22.110

在 Mac 或 Linux 上启动终端，然后键入`python`，然后按 Return 或 Enter。然后键入`from turtle import *`，然后按 Return 或 Enter。现在输入`fd(100)`，然后 Return 或 Enter。万岁！带有 Python 的徽标！=D（Windows 用户可以[在这里](https://www.python.org/)安装 Python ）

## 文档

有关命令的完整列表，请参阅[在线文档](http://docs.python.org/library/turtle.html)。请注意，文档会告诉您键入`turtle.fd(100)`，而不是`fd(100)`，因为他们选择使用`import turtle`，而不是`from turtle import *`。star 方法几乎总是不好的，因为它可能会将您自己的函数与模块中的函数混淆，但在这种情况下它是好的，因为它让我们可以使用适当的徽标命令来控制海龟。

## 保存标志功能

创建一个名为 的文件`shapes.py`，并将其保存在合理的位置。将以下代码添加到`shapes.py`：

```
from turtle import *

def square(size):
    for i in range(4):
        fd(100)
        rt(90)

def fun(size):
    for i in range (10):
        square (size)
        rt(36) 
```

现在，无论何时您想要制作徽标，请导航到您`shapes.py`在运行之前保存的任何位置`python`。然后，在运行之后`python`，运行`from shapes import *`而不是`from turtle import *`. 这将导入徽标以及您在 中定义的任何自定义函数`shapes.py`。因此，每当您制作一个很酷的功能时，只需将其保存起来以`shapes.py`备将来使用。

例如交互式会话（`python`从相关目录运行后）：

```
from shapes import *

square(100)
fun(50) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-20T03:46:36.560

跨平台版本： http: [//www.mathcats.com/gallery/logodownloadinfo.html](http://www.mathcats.com/gallery/logodownloadinfo.html)

MacOS X 特定： [http ://www.alancsmith.co.uk/](http://www.alancsmith.co.uk/)

开源标志： http:
[//sourceforge.net/projects/fmslogo](http://sourceforge.net/projects/fmslogo)
[http://www.rz.uni-augsburg.de/~micheler/en/](http://www.rz.uni-augsburg.de/~micheler/en/)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-20T04:03:51.537

[UCBLogo](http://www.cs.berkeley.edu/~bh/logo.html)是我最喜欢的 LOGO 实现，碰巧可用于 Windows、UNIX（X11 支持海龟绘图）和 Mac OS X，以及用于 DOS 和 Mac OS 9 的过时端口。

大多数 Linux 发行版[已经](http://packages.debian.org/ucblogo) [将](http://packages.gentoo.org/package/dev-lang/ucblogo) [它](http://www.novell.com/products/linuxpackages/opensuse/ucblogo.html) [打包](https://admin.fedoraproject.org/pkgdb/packages/name/ucblogo)。

它仍然得到维护（感谢伯克利的~~廉价劳动力~~学生）、开源且非常便携（我已经在各种风格的 UNIX 上运行它，包括 Linux，以及各种处理器架构）。

UCBLogo 带有相当全面的标准库和良好的文档；还包括 Brian Harvey 的“计算机科学徽标样式”书籍中示例的源代码。

* * *

附录：

[papert - 您的浏览器中的徽标](http://logo.twentygototen.org/)具有令人惊讶的功能，并且似乎可以在任何现代浏览器中使用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-03-04T23:47:17.567

我正在使用**[Elica LOGO 在 Windows 上成功地教我的孩子 LOGO](http://pavel.it.fmi.uni-sofia.bg/elica/about.html)**。（儿童年龄目前为 12 岁和 10 岁。）

该软件包的优势包括许多“高级”扩展，超出了基本的二维海龟。其中包括 3-D 图形和 Windows 小部件世界的简单挂钩。（您可以从您的 LOGO 代码中创建带有按钮等的 Windows 窗体。）

缺乏声音/音乐功能，至少在 5.5 版中，并且内置文档很广泛，有许多高级示例，但在我看来它不是很有用——由于它的不完整，并且它有许多包含错误的编码示例. （但我的孩子通过在编程示例中查找错误来了解更多信息。）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-02-16T19:38:44.820

KTurtle - [http://edu.kde.org/applications/school/kturtle/](http://edu.kde.org/applications/school/kturtle/)是你在 linux 下所需要的。

对于 Windows 版本的 kturtle，请访问 windows.kde.org

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-08-10T22:43:22.680

要真正重现怀旧情绪，您可以尝试在模拟的 Apple II 上运行 Logo。您可以在此处获取[用于徽标的 Apple II 磁盘的](http://mirrors.apple2.org.za/ftp.apple.asimov.net/images/programming/logo/)图像，并[在此处获取 AppleWin 仿真器的图像](http://applewin.berlios.de/)。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-06-12T18:26:14.867

现在通过 TurtleAcademy [http://turtleacademy.com](http://turtleacademy.com)教孩子们徽标的最佳方式。这是一个非常酷的网站，可以开始学习徽标原理，而且它是免费的

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-20T03:59:49.710

[在http://pylogo.org/](http://pylogo.org/)上有一个纯 Python 版本的 Logo

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-03-04T23:58:22.053

这是一个很好的免费 Windows [http://www.softronix.com/logo.html](http://www.softronix.com/logo.html)

还有一个平行标志，你可以看看 [http://ccl.northwestern.edu/netlogo/](http://ccl.northwestern.edu/netlogo/)

此外，麻省理工学院有一个很好的平行标志，称为 starlogo [http://education.mit.edu/starlogo/](http://education.mit.edu/starlogo/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-04-29T21:26:02.683

[http://tortue-logo.fr](http://tortue-logo.fr)是徽标语言的浏览器版本。它是用 raphaeljs 用 javascript 开发的（使用 python/django 的服务器端，但解释器在客户端运行）。

它只使与海龟玩耍成为可能，但它可能足以提醒您学习如何编程的好时机。:) 我认为它应该涵盖 LOGO 语言的主要命令。

目前支持法语和英语。法文版LOGO与英文版不同（命令翻译成法文）。所以请确保在网站上选择正确的语言。

我希望你会喜欢

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-09-11T09:05:26.007

您可以使用[http://www.logointerpreter.com](http://www.logointerpreter.com)。它是一个使用 HTML5 和 JQuery 的基于 Web 的解释器。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-02-23T16:53:07.473

海龟学院在线是学习和实验的神源 logo

# python - urllib2 读取到 Unicode

> ID：1020892
> 
> 赞同：46
> 
> 时间：2009-06-20T03:46:27.013
> 
> 标签：python, unicode, urllib2

我需要存储可以使用任何语言的网站内容。而且我需要能够在内容中搜索 Unicode 字符串。

我试过类似的东西：

```
import urllib2

req = urllib2.urlopen('http://lenta.ru')
content = req.read() 
```

内容是字节流，所以我可以搜索它以查找 Unicode 字符串。

我需要一些方法，当我这样做`urlopen`然后读取时使用标题中的字符集来解码内容并将其编码为 UTF-8。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-06-20T04:17:41.293

在您执行的操作之后，您将看到：

```
>>> req.headers['content-type']
'text/html; charset=windows-1251' 
```

所以：

```
>>> encoding=req.headers['content-type'].split('charset=')[-1]
>>> ucontent = unicode(content, encoding) 
```

`ucontent`现在是一个 Unicode 字符串（140655 个字符）——例如，如果您的终端是 UTF-8，则显示其中的一部分：

```
>>> print ucontent[76:110].encode('utf-8')
<title>Lenta.ru: Главное: </title> 
```

你可以搜索，等等等等。

编辑：Unicode I/O 通常很棘手（这可能是阻碍原始提问者的原因）但我将绕过将 Unicode 字符串输入到交互式 Python 解释器的难题（与原始问题完全无关）来展示如何，一旦正确输入了一个 Unicode 字符串（我是通过代码点来做的——愚蠢但并不棘手；-），搜索绝对是不费吹灰之力（因此希望原始问题已经得到彻底回答）。再次假设一个 UTF-8 终端：

```
>>> x=u'\u0413\u043b\u0430\u0432\u043d\u043e\u0435'
>>> print x.encode('utf-8')
Главное
>>> x in ucontent
True
>>> ucontent.find(x)
93 
```

**注意**：请记住，此方法可能不适用于所有站点，因为某些站点仅在提供的文档中指定字符编码（例如，使用 http-equiv 元标记）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-12-21T02:23:33.547

要解析`Content-Type`http 标头，您可以使用`cgi.parse_header`以下函数：

```
import cgi
import urllib2

r = urllib2.urlopen('http://lenta.ru')
_, params = cgi.parse_header(r.headers.get('Content-Type', ''))
encoding = params.get('charset', 'utf-8')
unicode_text = r.read().decode(encoding) 
```

获取字符集的另一种方法：

```
>>> import urllib2
>>> r = urllib2.urlopen('http://lenta.ru')
>>> r.headers.getparam('charset')
'utf-8' 
```

或者在 Python 3 中：

```
>>> import urllib.request
>>> r = urllib.request.urlopen('http://lenta.ru')
>>> r.headers.get_content_charset()
'utf-8' 
```

也可以在 html 文档中指定字符编码，例如`<meta charset="utf-8">`.

# iphone - 在表格视图动画期间控制 iPhone 应用程序流

> ID：1020909
> 
> 赞同：0
> 
> 时间：2009-06-20T03:58:08.027
> 
> 标签：iphone, multithreading, animation, uitableview

在我的应用程序中，我希望能够等到表视图动画（删除表视图行）完成后再执行我的部分应用程序。我想知道是否有任何方法可以等待或暂停我的应用程序，直到这些动画完成。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T04:40:17.290

删除完成后，您的 tableview 应该将 tableView:didEndEditingRowAtIndexPath: 消息发送给它的委托。如果您的委托响应该消息，您可以将您的应用程序代码（或对执行它的类的调用）放入该方法中。

Apple 在此处提供有关 tableview 插入和删除的更多信息：

[http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView:didEndEditingRowAtIndexPath](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView:didEndEditingRowAtIndexPath)：

[http://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/TableView_iPhone/ManageInsertDeleteRow/ManageInsertDeleteRow.html](http://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/TableView_iPhone/ManageInsertDeleteRow/ManageInsertDeleteRow.html)

# c++ - 使用 GLee 构建错误（GL Easy Extension Library）

> ID：1020924
> 
> 赞同：0
> 
> 时间：2009-06-20T04:10:03.520
> 
> 标签：c++, c, opengl

使用带有 mingw 的 Code::Blocks，并尝试将 Glee 用于 Windows 上的某些 OpenGL。我收到以下构建错误：

```
GLee.c|60|undefined reference to `_wglGetProcAddress@4'
GLee.c|10748|undefined reference to `_wglGetProcAddress@4'
GLee.c|10751|undefined reference to `_wglGetCurrentDC@0'
GLee.c|10797|undefined reference to `_glGetString@4'
GLee.c|10910|undefined reference to `_glGetString@4'
GLee.c|10976|undefined reference to `_glGetString@4' 
```

而且我只是包括 GLee 喜欢这样（使用 GLee.c，而不是 .dll）：

```
#include "GLee.h" 
```

根据 Ben Woodhouse 的说法，GLee 是“用纯 ANSI C 编写的，因此任何 C 或 C++ 编译器都应该可以工作。您可以将源文件直接包含在项目中或将它们编译到库中”，所以我应该没有问题。

谷歌在这方面没有给我太多信息，所以我希望那里的一些 OpenGL 兽医（或任何熟悉 GLee 的人）可以为我指明正确的方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T04:19:01.730

看起来您需要将您的应用程序与 OpenGL 库（特别是 Opengl32.lib）链接起来，这些库将提供您缺少的功能。也许[OpenGL FAQ](http://www.opengl.org/resources/faq/technical/gettingstarted.htm#0010)可能有助于解决这个问题。

# algorithm - diff可以在自己的游戏中被击败吗？

> ID：1020925
> 
> 赞同：11
> 
> 时间：2009-06-20T04:10:12.617
> 
> 标签：algorithm, comparison, diff, big-o

我正在寻找合适的算法来比较两个文件。`diff`我认为我可以比由于一些额外的限制做得更好。

我拥有的是两个文本文件，每个文件都包含一个文件列表。它们是在两个不同时间拍摄的系统上所有文件的快照。我想弄清楚在两个快照之间添加或删除了哪些文件。

我可以`diff`用来比较这些文件，但我不想这样做，因为：

1.  `diff`尝试将更改组合在一起，查找文件中的哪些块已更改。我只是在寻找一个已经改变的行列表，这应该比找到最长的公共子序列或类似的东西要简单得多。

2.  广义差异算法在运行时或空间上是*O(mn) 。*我正在寻找更像时间上的*O(m+n)*和空间上的*O(1)*的东西。

以下是该问题的限制条件：

1.  两个文件中的文件列表顺序相同。它们*不一定*按字母顺序排列，但它们的*相对*顺序相同。

2.  大多数情况下，列表之间不会有任何差异。如果存在差异，通常只会有少数新/删除的文件。

3.  我不需要将结果组合在一起，比如说“整个目录已被删除”或“第 100-200 行是新的”。我可以单独列出不同的每一行。

我认为这相当于拥有两个排序列表并试图找出两个列表之间的差异的问题。问题是列表项不一定按字母顺序排序，因此您不知道一项是否比另一项“更大”。您只知道两个列表中存在的文件的顺序相同。

对于它的价值，我几年前曾在[Ask Metafilter](http://ask.metafilter.com/)[上发布过](http://ask.metafilter.com/31950/Algorithm-for-file-comparison)这个问题。请允许我预先回答几个可能的答案。

**答：**这个问题称为[最长公共子序列](http://en.wikipedia.org/wiki/Longest-common_subsequence_problem)。

**回应：**我试图避免最长的公共子序列，因为简单的算法在*O(mn)*时间/空间中运行，而更好的算法更复杂且更“启发式”。我的直觉告诉我，由于添加了约束，所以存在线性时间算法。

**答：**按字母顺序排列，然后比较。

**响应：**那将是*O(m log m+n log n)*，这比*O(m+n)*差。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-20T04:19:03.163

读取一个文件，将每个文件名放入带有add 和contains 实现的类似[HashSet](http://java.sun.com/javase/6/docs/api/java/util/HashSet.html)的数据结构中。`O(1)``O(1)`

然后读取 seconds 文件，根据 HashSet 检查每个文件名。

如果文件一有长度`m`，而第二个文件有长度，则总算法`n`是`O(m+n)`按要求的。

*注意：该算法假设数据集在物理内存中的适应速度很快。*

如果数据集无法轻松放入内存，则可以使用带有磁盘分页的[B-Tree的某些变体来实现查找。](http://en.wikipedia.org/wiki/B-tree)然后，复杂性将是`O(mlog m)`初始设置并`O(n log m)`为每个其他文件进行比较。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-20T04:39:17.570

这不完全是`O(1)`内存，按更改次数顺序的内存需求，但它是`O(m+n)`运行时的。

它本质上是一种缓冲流算法，在任何给定行都知道所有先前行的差异。

```
// Pseudo-code:
initialize HashMap<Line, SourceFile> changes = new empty HashMap
while (lines left in A and B) {
    read in lineA from file A
    read in lineB from file B

    if (lineA.equals(lineB)) continue

    if (changes.contains(lineA) && changes.get(lineA).SourceFile != A) {
         changes.remove(lineA)
    } else {
         changes.add(lineA, A)
    }

    if (changes.contains(lineB) && changes.get(lineB).SourceFile != B) {
         changes.remove(lineB)
    } else {
         changes.add(lineB, B)
    }
}

for each (line in longerFile) {
    if (changes.contains(line) && changes.get(line).SourceFile != longerFile) {
         changes.remove(line)
    } else {
         changes.add(line, longerFile)
    }
}

Lines in the HashMap from SourceFile == A have been removed
Lines in the HashMap from SourceFile == B have been added 
```

这在很大程度上依赖于文件以相同的相对顺序列出的事实。否则，内存需求将远大于更改的数量。但是，由于这种排序，该算法使用的内存不应超过 2 * numChanges。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T04:19:41.403

从理论的角度来看，比较两个字符串之间的编辑距离（因为这里有一个有趣的语言中的字符串，其中“字符”是一个文件名）不能进行 O(m+n)。但在这里我们进行了简化。

在您的情况下实现算法（应该包含错误）：

```
# i[0], i[1] are undoable iterables; at the end they both return Null

while (a = i[0].next()) && (b = i[1].next()) :    # read one item from each stream
    if a != b:                 # skip if they are identical
        c = [[a],[b]]          # otherwise, prepare two fast arrays to store difference
        for (w = 1; ; w = 1-w) # and read from one stream at a time
             nxi = Null        
             if (nx = i[1-w].next()) in c[w]:  # if we read a new character that matches
                  nxi = c[w].index(nx)          
             if nx is Null: nxi = -1           # or if we read end of stream
             if nxi is not Null:               # then output that we found some diff
                 for cc in c[1-w]: yield cc              # the ones stored 
                 for cc in c[w][0:nxi-1]: yield cc       # and the ones stored before nx
                 for cc in c[w][nxi+1:]: i[w].undo(cc)   # about the remainder - put it back
                 break                         # and return back to normal cycle
 # one of them finished
 if a: yield a
 if b: yield b
 for ci in i: 
     while (cc = ci.next()): yield cc 
```

有些数据结构我称之为快速数组——它们可能是`HashSet`事物，但它们会记住排序。它们中的加法和查找应该是`O(log N)`，但内存使用`O(N)`。

`O(m+n)`除了发现差异之外，这不会使用任何内存或循环。对于每个“差异块”——可以描述为去掉 M 个连续项目并添加 N 个项目的操作——这需要`O(M+N)`内存和指令。块完成后释放内存，因此如果您确实只有很小的更改，这并不是什么大问题。当然，最坏情况下的性能与泛型方法一样糟糕。~~`O(MN)`~~ `O(Mlog N+Nlog M)`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-21T06:25:52.707

在实践中，排序时间的对数因子差异可能是微不足道的——`sort`可以在几秒钟内对数十万行进行排序。所以你实际上不需要编写任何代码：

```
sort filelist1 > filelist1.sorted
sort filelist2 > filelist2.sorted
comm -3 filelist1.sorted filelist2.sorted > changes 
```

我并不是说这一定是最快的解决方案——我认为[Ben S 接受的答案](https://stackoverflow.com/questions/1020925/can-diff-be-beaten-at-its-own-game/1020952#1020952)是，至少高于 N 的某个值。但它绝对是最简单的，它可以扩展到任意数量的文件，并且（除非你是负责谷歌备份操作的人）对于您拥有的文件数量来说，它的速度将绰绰有余。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-20T04:50:16.197

如果您接受字典（哈希映射）是 O(n) 空间和 O(1) 插入/查找，那么这个解决方案在时间和空间上都应该是 O(m+n)。

```
from collections import defaultdict
def diff(left, right):
    left_map, right_map = defaultdict(list), defaultdict(list)
    for index, object in enumerate(left): left_map[object] += [index]
    for index, object in enumerate(right): right_map[object] += [index]
    i, j = 0, 0
    while i < len(left) and j < len(right):
        if left_map[right[j]]:
            i2 = left_map[right[j]].pop(0)
            if i2 < i: continue
            del right_map[right[j]][0]
            for i in range(i, i2): print '<', left[i]
            print '=', left[i2], right[j]
            i, j = i2 + 1, j + 1
        elif right_map[left[i]]:
            j2 = right_map[left[i]].pop(0)
            if j2 < j: continue
            del left_map[left[i]][0]
            for j in range(j, j2): print '>', right[j]
            print '=', left[i], right[j2]
            i, j = i + 1, j2 + 1
        else:
            print '<', left[i]
            i = i + 1
    for j in range(j, len(right)): print '>', right[j] 
```

```
>>> 差异（[1, 2, 1, 1, 3, 5, 2, 9],
... [ 2, 1, 3, 6, 5, 2, 8, 9])
< 1
= 2 2
= 1 1
< 1
= 3 3
> 6
= 5 5
= 2 2
> 8
= 9 9

```

好吧，如果它们是链表，那么轻微的作弊`list.append`只是`list.__delitem__`O(1)，这不是真的……但无论如何，这就是想法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-20T05:13:52.813

对 ehemient 答案的改进，这只在有变化时使用额外的内存。

```
def diff(left, right):
    i, j = 0, 0

    while i < len(left) and j < len(right):
        if left[i] == right[j]:
            print '=', left[i], right[j]
            i, j = i+1, j+1
            continue

        old_i, old_j = i, j
        left_set, right_set = set(), set()

        while i < len(left) or j < len(right):
            if i < len(left) and left[i] in right_set:
                for i2 in range(old_i, i): print '<', left[i2]
                j = old_j
                break

            elif j < len(right) and right[j] in left_set:
                for j2 in range(old_j, j): print '>', right[j2]
                i = old_i
                break

            else:
                left_set .add(left [i])
                right_set.add(right[j])
                i, j = i+1, j+1

    while i < len(left):
        print '<', left[i]
        i = i+1

    while j < len(right):
        print '>', right[j]
        j = j+1 
```

评论？改进？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-05T20:11:34.387

我一直在追求一个程序来区分大文件而不会耗尽内存，但没有找到适合我的目的。我对使用差异进行修补不感兴趣（然后我可能会`rdiff`从 librdiff 使用），但是为了直观地检查差异，也许将它们变成单词差异`dwdiff --diff-input`（读取统一差异格式）并可能收集单词-diffs 不知何故。

（我的典型用例：我有一些用于处理大型文本语料库的 NLP 工具。我运行它一次，得到一个 122760246 行长的文件，我对我的工具进行了更改，再次运行它，得到一个文件就像每百万行不同，可能两次插入和删除，或者只有一行不同，诸如此类。）

由于我找不到任何东西，我只是制作了一个小脚本[https://github.com/unhammer/diff-large-files](https://github.com/unhammer/diff-large-files) - 它可以工作（dwdiff 接受它作为输入），它足够快（比 xz 进程快经常在管道中运行），最重要的是它不会耗尽内存。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-03-12T09:25:18.373

我会将文件列表读入两组，然后找到对任一列表都是唯一的文件名。

在 Python 中，类似于：

```
files1 = set(line.strip() for line in open('list1.txt'))
files2 = set(line.strip() for line in open('list2.txt'))
print('\n'.join(files1.symmetric_difference(files2))) 
```

# iphone - loading a image from documents directory in iPhone

> ID：1020940
> 
> 赞同：10
> 
> 时间：2009-06-20T04:30:49.690
> 
> 标签：iphone

I want to load a image to UIImageView from my app documents library. I am trying to use the following code but it is not working.

```
UIImageView *background = [[[UIImageView alloc] initWithFrame:CGRectMake(3, 10, 48, 36)] autorelease];

[background setImage:[[UIImage imageAtPath:[[NSBundle mainBundle] pathForResource:@"Thumbnail-small" ofType:@"jpg" inDirectory:@"/Users/nbojja/Library/Application Support/iPhone Simulator/User/Applications/60C2E4EC-2FE0-4579-9F86-08CCF078216D/Documents/eb43ac64-8807-4250-8349-4b1f5ddd7d0d/9286371c-564f-40b4-99bd-a2aceb00a6d3/9"]]] retain]]; 
```

can someone help me with doing this. thanks...

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-20T07:24:17.407

If you *really* want to load an image from your app's documents folder, you could use this:

```
NSArray *sysPaths = NSSearchPathForDirectoriesInDomains( NSDocumentDirectory, NSUserDomainMask, YES );
NSString *docDirectory = [sysPaths objectAtIndex:0];
NSString *filePath = [NSString stringWithFormat:@"%@/Thumbnail-small.jpg", docDirectory];
background.image = [[[UIImage alloc] initWithContentsOfFile:filePath] autorelease]; 
```

However, as pointed out by others here, you probably want to load it from your app bundle, in which case either of these will work:

```
background.image = [UIImage imageNamed:@"Thumbnail-small.jpg"]; 
```

or

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"Thumbnail-small" ofType:@"jpg"];
background.image = [UIImage imageWithContentsOfFile:path]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-10T06:30:56.740

```
NSString *docPath = [NSSearchPathForDirectoriesInDomains (NSDocumentDirectory,NSUserDomainMask, YES) objectAtIndex:0];
NSString *filePath=[NSString stringWithFormat:@"%@/image.png",docPath];

BOOL fileExists=[[NSFileManager defaultManager] fileExistsAtPath:filePath];

if (!fileExists)
    NSLog(@"File Not Found");
else
    image = [UIImage imageWithContentsOfFile:filePath]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T05:18:23.340

See [this related question](https://stackoverflow.com/questions/924740/dispelling-the-uiimage-imagenamed-fud) which has the code you want.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T04:40:40.613

I think what you actually need is:

```
UIImage *img = [UIImage imageWithContentsOfFile: [[NSBundle mainBundle] pathForResource:@"myimagefile" ofType:@"png"]];
[self.testView.imgView setImage:img]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-14T13:11:07.223

Swift 3:

```
let nsDocumentDirectory = FileManager.SearchPathDirectory.documentDirectory
let nsUserDomainMask = FileManager.SearchPathDomainMask.userDomainMask
let paths = NSSearchPathForDirectoriesInDomains(nsDocumentDirectory, nsUserDomainMask, true)
if let dirPath = paths.first {
let imageURL = URL(fileURLWithPath: dirPath).appendingPathComponent("Image2.png")
let image = UIImage(contentsOfFile: imageURL.path)
// Do whatever you want with the image
} 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-06-20T06:35:49.440

Use `[UIImage imageNamed:@"ThumbnailSmall.jpg"];`

This will load up what you want I think.

# popup - 如何禁用 html 按钮的自动回发？

> ID：1020941
> 
> 赞同：2
> 
> 时间：2009-06-20T04:31:05.337
> 
> 标签：popup, postback

我想在单击按钮时显示一个弹出窗口。我能够实现它，但我无法停止自动回发。显示弹出窗口并自动回发页面。需要帮忙。TIA。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-20T04:43:27.150

我假设你在 Javascript 中做这样的事情来打开弹出窗口：

```
<input type="submit" onclick="window.open('...');" ... /> 
```

您需要做的就是添加“return false;” 到您的 Javascript 调用结束以防止回发发生，给您留下如下内容：

```
<input type="submit" onclick="window.open('...'); return false;" ... /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-16T17:09:07.157

使用**返回假；**在点击功能调用下。例如

```
onclick="dosomthing(); return false;" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T05:03:08.320

下面是使用 LinkBut​​ton 的 OnClientClick 属性的示例：

```
protected void lnkConfirm_Click(object sender, EventArgs e)
{
   Response.Write("Postback!");
}

<asp:LinkButton ID="lnkConfirm" runat="server" 
    OnClientClick="return confirm('Do Postback?');"
    OnClick="lnkConfirm_Click">Postback</asp:LinkButton> 
```

# php - 从动态数据库调用创建对象

> ID：1020942
> 
> 赞同：0
> 
> 时间：2009-06-20T04:31:45.977
> 
> 标签：php, database, oop

我正在尝试创建一个类，该类从数据库查询中获取一些未指定的数据（作为数组传递给我的类）并将其转换为 PHP 对象，该对象具有从传递给它的数据动态创建的属性。

像这样：

```
 class myLibrary_Item extends myLibrary
    {
            private function __construct($vars)
            {
                    foreach($vars as $var => $val)
                    {
                            $this->$var => $val;
                    }
            }

            private function __set($var, $val)
            {
                    $this->$var => $val;
            }

            private function __get($var)
            {
                    return $this->$var;
            }
    }  

$myArray = array(
    'firstName' => 'Joe',
    'lastName' => 'Carrington'
);

$myObject = new myLibrary_Item($myArray)
echo $myObject->firstName;
//Hopefully will output Joe 
```

所以，我的问题是，这是一个好主意吗？我在这里错过了 OOP 的意义吗？我应该学习 PDO 吗？看起来这可能是一个很大的帮助，但如果这会在以后咬我的屁股，我不想敲出这些错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-20T04:33:29.223

我想说这对于[PDOStatement->fetchObject](http://us3.php.net/manual/en/pdostatement.fetchobject.php)确实是多余的。

```
php > $dbh = new PDO("mysql:host=localhost;dbname=test", "guest");
php > $stat = $dbh->prepare("select * from books");
php > $stat->execute();
php > while($row = $stat->fetchObject())
php > print_r($row);
stdClass Object
(
    [title] => Hitchhiker's Guide
    [author] => Douglas Adams
    [isbn] => 0345391802
    [publisher] => Del Rey
    [year] => 1995
    [summary] => Arthur Dent accidentally saves the world.
) 
```

# jquery - jQuery 使用动态数量的字段进行验证

> ID：1020943
> 
> 赞同：14
> 
> 时间：2009-06-20T04:32:27.240
> 
> 标签：jquery, dynamic, field, validation

我有一个具有动态数量的字段组的阶段的表单，其中数字基于前一阶段的答案。

我将字段服务器端生成为数组，即

```
<input id="foo[0]"...
<input id="bar[0]"...

<input id="foo[1]"...
<input id="bar[1]"...

<input id="foo[2]"...
<input id="bar[2]"... etc 
```

无论数字是多少，所有字段都是必需的，并且在某些情况下，我还需要根据类型和位数进行验证。我正在使用[jQuery validate 插件](http://docs.jquery.com/Plugins/Validation)进行客户端处理（是的，也备份了服务器端的东西）&验证不能内联完成，因为表单需要通过 XHTML Strict（编辑：请参阅下面的附录） .

我的问题是我无法弄清楚如何使用动态数量的字段进行验证。以下是表单其余部分的验证语法通常如下所示：

```
$(document).ready(function() {

    // validate stage_form on keyup and submit
    var validator = $("#form_id").validate({

        // rules for field names
        rules: {

            name: "required", 
            address: "required",
            age: { required: true, number: true }

        },

        // inline error messages for fields above
        messages: {

            name: "Please enter your name", 
            address: "Please enter your address",
            age: { required: "Please enter your age", number: "Please enter a number" }

        }

    });

}); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-09-06T18:59:56.297

实际上，如果您使用类而不是将规则初始化为 validate() 选项，它应该可以工作。

*标记：*

```
<input id="foo[0]" class="required"
<input id="bar[0]" class="required number"

<input id="foo[1]" class="required"
<input id="bar[1]" class="required email" 
```

*jQuery：*

```
$(document).ready(function() {

  var validator = $("#form_id").validate({
    messages: {
            name: "Please enter your name", 
            address: "Please enter your address",
            age: { 
               required: "Please enter your age", 
               number: "Please enter a number" 
            }

    }

  });

}); 
```

希望这有效。思南。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-04T15:32:30.943

您是否尝试过使用[自定义类规则](http://docs.jquery.com/Plugins/Validation/Reference#Refactoring_rules)来定义 xhtml 不兼容的规则？

[文档](http://docs.jquery.com/Plugins/Validation/Reference#Refactoring_rules)中的示例仅使用一个类，但我想您可以组合不同的自定义类来实现您需要的验证规则。我自己没有试过这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-28T22:31:12.120

没有答案，所以我将发布我的“临时”解决方案，即为“必需”和“类型”设置内联验证规则，将“最大长度”留给服务器端检查，然后显示带有内联标题标签的自定义消息。

对于这项工作来说，这可能已经足够了，但我仍然很好奇是否有办法在 jQuery 中“完全”完成它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-20T14:51:35.313

这是另一种方法。

```
/* Normal validate initialisation. */
$('#myForm').validate({

    /* Use the submitHandler method to add custom-selector-based validation. */
    submitHandler: function(form, ev) {

        /* Find your dynamic field/s. Note that you may want to access them via a scope external to validate, as any selection you do in this internal scope will be static from the form's pre-edit state. */
        var el = $('#selector');

        /* Do your custom validation. */
        if (  el.val() !== 'A'  ) {

            /* Show any errors:- 'fieldname': 'error message'. */
            this.showErrors({
                'name-of-a-field-near-where-you-want-your-error-placed': 'Please enter "A" to continue'
            });

            /* Prevent form submission. */
            return;
        } 
    }
}); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2011-08-15T19:28:40.930

我找到了一种使用“元数据”的方法。

这应该在具有动态名称的模板中使用。所以，我不需要知道名字。

缺点仍然是无法使用带有干净标签的纯 javascript 代码。

```
<script src="jquery.metadata.js" type="text/javascript"></script>

<input validate="{required: true, email: true, messages: { required: 'i'm required', 'i'm not valid e-mail' }}" name="dynamicRow[  myRandomNumber ]"type="text" class="input_normal" />

 $( function() {
     // setup stuff
     $.metadata.setType("attr", "validate"); 
}); 
```

# iphone - *在* iPhone 上将 .png 转换为 PVRTC

> ID：1020944
> 
> 赞同：6
> 
> 时间：2009-06-20T04:32:29.237
> 
> 标签：iphone, objective-c

是否有标准机制或已知库可以将 .png 图像转换为 iPhone 本身上的压缩 PVRTC 纹理（不是在使用 OS X 上的标准工具进行开发期间）。

我的应用程序中有许多 .png 纹理，但交换是一个问题。我想在设备上创建 .pngs 的 PVRTC 变体，如果可用内存在应用程序启动时（或者可能在应用程序的首次加载时）不足。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-08T12:02:38.803

我在网上没有看到任何关于如何手动构建 PVRTC 图像的信息，据我所知，iPhone 中不支持此功能（并且不需要读取 PVRTC 文件）。

对于大多数应用程序，包含或构建文件的两个版本几乎没有意义。在最佳条件下，PVRTC 版本应该与 PNG 版本几乎没有区别，并且实际上只是为直接流式传输到视频内存而优化的文件的“预处理”版本。

通常最好检查所有图像并决定如何最好地打包图像以平衡所有用户的内存节省和质量，而不仅仅是在特定的内存受限情况下。

需要考虑的几件事（如果这是多余的知识，请道歉）：

1.  PVRTC 文件在处理复杂的 Alpha 混合图像时可能会出现问题，因为预处理可能会导致沿混合边缘出现难看的伪影。
2.  不透明的 PNG 文件应在原始图像中删除其 alpha 通道（节省内存和混合开销）。
3.  对于颜色范围有限的图像，将图像从 PNG32 缩小到 PNG16 或 PNG8 以节省磁盘内存。
4.  如果这是基于 OpenGL 的程序，请考虑使用支持交替像素格式（例如 565 和 4444）的 Texture2D 的增强版本（例如来自 Cocos2D）。这可以大大减少显卡的开销，同时对图像质量的影响最小，通过仔细选择与原始图像中颜色平衡相对应的像素格式。
5.  此外，对于基于 OpenGL 的程序，请避免使用单个图像 (320x480) 作为背景，因为这将导致每个图像在内存中的纹理为 512x512。将图像分成小块或将图像设置为 512x512 并用其他图像填充额外的空间，以便只需要加载一个纹理。
6.  与所有事情一样，首先关注最大的图像以获得最大的收益。

还值得注意的是，由于您的应用程序将是唯一运行的东西（除了系统应用程序），唯一真正的内存开销将是有限数量的“磁盘”空间。制作所有图像文件的第二个副本实际上会对您不利，而不是帮助您。

巴尼

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T04:37:59.287

我会小心假设这会对你有所帮助。一旦您引用图像一次，即将它们加载到 UIImage 中，无论您是否喜欢它们，iPhone 都会开始缓存您的 png。在我看来，压缩它们不会很好地帮助你实现你在这里寻找的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-10T08:14:47.590

如果你想在 IOS 上将图像压缩到 PVR，你可以考虑 OpenSceneGraph 插件 pvr ：

[http://www.openscenegraph.org/projects/osg/browser/OpenSceneGraph/branches/OpenSceneGraph-3.0/src/osgPlugins/pvr/ReaderWriterPVR.cpp](http://www.openscenegraph.org/projects/osg/browser/OpenSceneGraph/branches/OpenSceneGraph-3.0/src/osgPlugins/pvr/ReaderWriterPVR.cpp) .

# wcf - 将大数据从 WCF 服务发送到客户端的最佳方式是什么？

> ID：1020956
> 
> 赞同：3
> 
> 时间：2009-06-20T04:40:19.787
> 
> 标签：wcf, streaming, mtom

我有一个返回大量数据的特定服务。WCF 中处理此问题的最佳实践和选项是什么？

这些大数据是在做完所有的过滤后返回的，所以不能再过滤了。数据可以进入GB。我确实理解系统可以处理的数据量是有限度的。

但是给上面的场景你会推荐什么选项/替代方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-20T05:04:45.180

使用流式[MSDN](http://msdn.microsoft.com/en-us/library/ms733742.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T05:04:40.313

**MTOM**是一种将带有 SOAP 消息的大型二进制附件作为原始字节传输的机制，允许使用更小的消息。

有关详细信息，请参见：http: [//msdn.microsoft.com/en-us/library/aa395209.aspx](http://msdn.microsoft.com/en-us/library/aa395209.aspx)。

# unit-testing - 编写测试时如何处理 setUp() 成瘾问题？

> ID：1020963
> 
> 赞同：2
> 
> 时间：2009-06-20T04:48:36.560
> 
> 标签：unit-testing, language-agnostic, testing

我对编写测试有点陌生。我发现自己在努力保持我的设置简洁明了，而不是试图用超级设置完成太多。

我的问题是，您如何拆分测试？

您的测试是否包含一两行独立的步骤代码？

```
def test_public_items():
    item1 = PublicItem()
    item2 = PublicItem()
    assertEqual(public_items, [item1, item2]) 
```

还是无论如何您都会将其纳入设置中？

如果是这样，你如何处理测试类分离？当一组测试需要不同的设置然后另一组测试时，您是否创建一个新类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-20T04:55:34.053

我相信你在这里 遇到了几个[反模式](https://stackoverflow.com/questions/333682/tdd-anti-patterns-catalogue)

*   过度设置
*   不恰当地共享夹具。

经验法则是特定测试夹具中的所有测试都应该需要 Setup() 方法中的代码。

如果您编写的 test() 需要或多或少地设置当前存在的内容，则可能暗示它属于新的测试夹具。创建新测试夹具的惯性..是将设置代码滚雪球成一个大泥球 - 试图为所有测试做所有事情。相当损害可读性..您在设置代码中看不到测试，其中大部分甚至可能与您正在查看的测试无关。

也就是说，可以在测试中对通用设置进行一些特定设置说明的测试。（这属于 Arrange-Act-Assert 三合会的第一个）。但是，如果您在多个测试中重复了这些指令 - 您可能应该将所有这些测试带到一个新的测试夹具中，其

```
setup_of_new_fixture = old_setup + recurring_arrange_instruction 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T04:58:23.690

是的，一个文本夹具（体现在一个类中）应该是一组共享设置和拆卸的共同需求的测试。

理想情况下，单元测试应该命名为`testThisConditionHolds`. `public_items`不是“条件”。无论令人难以置信的黑魔法`public_items`应该来自哪里，我都会编写如下测试：

```
def testNoPublicItemsRecordedIfNoneDefined(self):
    assertEqual([], public_items)

def testOnePublicItemsIsRecordedRight(self):
    item = PublicItem()
    assertEqual([item], public_items)

def testTwoPublicItemsAreRecordedRight(self):
    item1 = PublicItem()
    item2 = PublicItem()
    assertEqual([item1, item2], public_items) 
```

如果`public_items`一个神奇的列表应该被神奇地填充为调用魔术函数的副作用`PublicItem`，那么调用后者`setUp`实际上会破坏正确测试这些简单案例的能力，所以我当然不会这样做！

# c# - 从非托管 c++ 代码调用托管 c# 组件，我如何定义配置

> ID：1020964
> 
> 赞同：0
> 
> 时间：2009-06-20T04:48:56.013
> 
> 标签：c#, c++, unmanaged

我想从非托管 C++ 服务调用 C# 组件。我需要设置 C# 组件期望的配置项。应该配置什么名称以及它应该位于哪里。

例如。父文件夹\cplusplusservice.exe

另一个文件夹\csharp.dll

我需要 csharp.dll.config 或它的等价物。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-20T05:34:09.717

本文展示了如何在 c# 中使用配置文件：

[http://www.devasp.net/net/articles/display/679.html](http://www.devasp.net/net/articles/display/679.html)

本文概述了从非托管 c++ 调用托管 c# 组件（反之亦然），以及一些帮助类：

[http://www.codeproject.com/KB/mcpp/unmanaged_to_managed.aspx](http://www.codeproject.com/KB/mcpp/unmanaged_to_managed.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T07:04:21.207

.config 文件的名称需要与应用程序的名称相同。当非托管代码首次调用托管代码时，会创建一个 AppDomain，该 AppDomain 控制加载哪个配置文件以及从何处加载。

您需要手动将 .config 文件复制到输出目录并以应用程序名称命名，或者创建一个后期构建来执行此操作。

基本上，适用于纯托管应用程序的 .config 文件所在位置的相同规则适用于加载托管代码的非托管应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T09:20:36.393

这取决于托管您的托管代码的 AppDomain 是如何创建的。

例如，如果您将托管代码公开为 COM，它将被加载到默认的 AppDomain 中，并且配置文件将与可执行文件位于同一目录中（在您的情况下为 parentfolder\cplusplusservice.exe.config）。

如果您自己创建 AppDomain，您可以控制配置文件的位置。

# c# - 使用委托或接口解耦日志记录 - 最佳实践 - C#

> ID：1020967
> 
> 赞同：4
> 
> 时间：2009-06-20T04:51:11.610
> 
> 标签：c#, delegates, interface

我的解决方案有几个项目，其中包括几个库和一个 UI 项目。目前它是一个 Windows 窗体应用程序，我使用 log4net 进行日志记录。这个 UI 项目只引用了 log4net，这个项目维护了配置文件。但我也想从我的图书馆登录。

执行此操作的常用方法是将日志记录调用包装在接口后面。创建一个名为实用程序的通用项目并将此接口添加到该项目中。现在这个项目可以在所有项目中使用，并且可以使用这个接口进行日志记录。

我正在考虑一种替代设计，它涉及传递委托、减少耦合和避免不必要的接口。

考虑以下课程是我图书馆中的一门课程。

```
public sealed class Foo
{
    Action<string> log;
    Action<string, Exception> logException;

    public Foo(Action<string> log, Action<string,Exception> logException)
    {
        this.log = log;
        this.logException = logException;
    }

    public void Work()
    {
        WL("Starting work");
        WL("Completed step1");
        .........
    }

    void WL(string message)
    {
        if(log != null) log(message);
    }

    void WL(string message, Exception exception)
    {
        if(logException != null) logException(message, exception);
    }
} 
```

现在从调用代码中，我可以轻松地传递日志记录方法。就像是

```
Foo foo = new Foo(message => Console.WriteLine(message), 
                (message, exception) => Console.WriteLine("{0},{1}", message, exception));
foo.Work(); 
```

使用控制台进行解释，实际上我将在这里使用日志记录代码。

1 - 你认为这是一个更好的解决方案吗？我认为这更好，因为这更松散耦合。

2 - 还有其他更好的解决方案吗？

[这](https://stackoverflow.com/questions/522370/dependency-injection-and-logging-interfaces)是我在这里找到的唯一相关问题

有什么想法吗...？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-20T05:06:27.300

如果有多个签名以紧密的形式飞行，请不要使用代表。您所做的只是[避免定义](http://c2.com/cgi/wiki?FearOfAddingClasses)有意义的类和接口。log4net 提供了一个`ILog`接口，它是您可以传入的简单包装器接口的一个很好的示例。

如果您要使用日志框架，尤其是 log4net，请不要包装它，也不要创建单个全局（静态或单例）入口点。[我以前写过这个](https://stackoverflow.com/questions/576185/logging-best-practices/576420#576420)，你可能也[对最佳实践的问题](https://stackoverflow.com/questions/576185/logging-best-practices)感兴趣。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-20T09:15:28.043

我有一个薄层，它公开了一个与 Log4Net 非常相似的日志 API，它使用提供者模型设计模式来允许您插入任何合适的日志框架。我已经实现了提供者：

*   System.Diagnostics.Trace

*   log4net

*   实体库

这意味着我可以在我的所有应用程序中使用日志记录，而无需直接依赖特定的日志记录框架，并且我的组件的用户可以插入他们自己喜欢的日志记录框架。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T14:22:29.187

我的建议是在所有项目中添加对 log4net 的引用，但将记录器配置保留在 UI 项目中。这仍然使您可以灵活地在每个程序集的基础上定义不同的日志记录级别。日志记录是一种低级别的活动，而 log4net 是一种成熟的产品，我不会花任何时间试图提出一个聪明的解决方案来满足“最佳实践”。我什至可能会争辩说，一两杯啤酒，引用 log4net 与引用 System.Core 没有什么不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T05:01:59.677

除非您使用不同的日志记录框架有不同的代码片段，否则我会有一个单例`LogDispatcher`或类似的东西，所有尝试记录的代码都会调用它，可能会传入消息级别以确定正确的日志记录方法。这可以防止记录的委托需要在整个代码库中传递，并集中所有负责记录策略的代码。

另一种方法是使用像[Log4Net](http://logging.apache.org/log4net/release/manual/introduction.html)这样的框架。即使您最终没有使用它，它们的设计也是您自己登录的一个很好的基础。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-20T05:04:21.280

引用 Jon S. “简单几乎总是比聪明好” - 恕我直言，您对代表的使用看起来更多的是后者。

如果您希望库项目记录，他们应该设置并使用自己的记录器。我不会要求客户传入一个记录器（对象或接口）——然后它会一直深入到类型依赖图的深处。**它只是用不必要的记录器对象/接口/委托等参数污染了接口**。

如果您使用 Log4XXX 框架，我相信它强调了“[分层日志架构](http://logging.apache.org/log4net/release/features.html)”（他们在 s/w 中提出的名称）的概念，其中每个类型/类都可以维护和写入自己的日志文件。如果 Foo 的 ctor 在内部创建一个记录器，我会喜欢的。而且由于它是可配置的，特定的客户端也可以更改配置文件以将输出重定向到其他地方。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-20T09:35:56.207

谷歌“AOP 日志”。

[这是](http://ayende.com/Blog/archive/2008/07/31/Logging--the-AOP-way.aspx)来自 Ayende 的一些关于此的聊天。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-19T22:08:56.667

因此，您的问题是我很快将不得不致力于解决的问题。事实上的答案是“使用注入”，但在这种情况下，它减少了控制反转和更多的依赖扩展。我认为你很接近，所以这是我的想法。

**您的解决方案的优点**

您的类或它所在的程序集不需要额外的引用。因为您使用具有常见类型的操作，所以这些引用可能已经存在。

这样做的好处是 100% 的日志记录实现留给注入您的操作的程序集。因此，如果您添加 nLog 的 log4Net，则对它的唯一引用将是它的实现位置。因此，如果您想稍后切换，则只需更新该程序集。

反之亦然，如果您只是将一个选定的记录器注入到每个类中。这意味着您必须在每个项目中添加对记录器的引用。即使接口的名称和实现都相同，您也必须有参考才能解析它。在您拥有超过 3 个项目的解决方案中，这些项目的成本可能很高，并且任何时候切换记录器的成本都是相同的。

**可能的改进**

这就是您的解决方案的美妙之处。但是它可以改进。我发现当注入类似功能或“方面”的东西时，将它们放入一个对象并注入它是有意义的。您可以使用您的两个操作创建接口并注入实现您想要的任何库的具体。这将再次将日志库的唯一引用留给一个项目/程序集，而只需将对您的接口的引用添加到其余部分的成本。

希望这会有所帮助，祝你好运。

# variables - Common Lisp 与 Scheme 中函数和变量的独立命名空间

> ID：1020968
> 
> 赞同：31
> 
> 时间：2009-06-20T04:51:30.843
> 
> 标签：variables, scheme, lisp, common-lisp, lisp-2

Scheme 为所有变量使用一个命名空间，无论它们是绑定到函数还是其他类型的值。Common Lisp 将两者分开，因此标识符“hello”在一个上下文中可能指代一个函数，而在另一个上下文中指代一个字符串。

（注1：这个问题需要上面的一个例子；随意编辑它并添加一个，或者用它给原作者发电子邮件，我会这样做。）

但是，在某些情况下，例如将函数作为参数传递给其他函数，程序员必须通过使用明确区分他指定的是函数变量，而不是非函数变量，`#'`如下所示：

```
(sort (list '(9 A) '(3 B) '(4 C)) #'< :key #'first)
```

我一直认为这有点像疣，但我最近遇到了一个[论点](http://coding.derkeiler.com/Archive/Lisp/comp.lang.lisp/2004-04/0620.html)，认为这实际上是一个特性：

> ...重要的区别实际上在于形式的语法，而不是对象的类型。在不知道所涉及的运行时值的情况下，很明显函数形式的第一个元素必须是函数。CL 接受了这一事实并将其与宏和特殊形式一起成为语言的一部分，这些形式也可以（并且必须）静态确定。所以我的问题是：当函数名的主要用途是出现在变量名很少出现的地方时，为什么你希望函数名和变量名在同一个命名空间中？

> 考虑类名的情况：为什么一个名为 FOO 的类要阻止使用名为 FOO 的变量？我唯一一次用 FOO 来引用这个类是在需要类名的上下文中。如果在极少数情况下我需要获取绑定到类名 FOO 的类对象，则可以使用 FIND-CLASS。

从经验来看，这个论点对我来说确实有意义。Haskell 中也有类似的情况，字段名称也是用于访问字段的函数。这有点尴尬：

```
data Point = Point { x, y :: Double {- lots of other fields as well --} }
isOrigin p = (x p == 0) && (y p == 0) 
```

这可以通过一些额外的语法来解决，`NamedFieldPuns`扩展特别好：

```
isOrigin2 Point{x,y} = (x == 0) && (y == 0) 
```

那么，对于这个问题，除了一致性之外，Common Lisp 与 Scheme 以及一般而言，所有值的单个命名空间与函数和非函数值的单独命名空间的优点和缺点是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-20T05:09:25.660

这两种不同的方法有名称：Lisp-1 和 Lisp-2。Lisp-1 对变量和函数都有一个命名空间（如在 Scheme 中），而 Lisp-2 对变量和函数有单独的命名空间（如在 Common Lisp 中）。我提到这一点是因为您可能不知道该术语，因为您没有在问题中提及它。

维基百科[提到了这场辩论](http://en.wikipedia.org/wiki/Lisp-1_vs._Lisp-2#The_function_namespace)：

> 单独的函数命名空间是否是一个优势是 Lisp 社区争论的根源。它通常被称为 Lisp-1 与 Lisp-2 的辩论。Lisp-1 指的是 Scheme 的模型，Lisp-2 指的是 Common Lisp 的模型。这些名称是由 Richard P. Gabriel 和 Kent Pitman 在 1988 年的一篇论文中创造的，该论文广泛比较了这两种方法。

Gabriel 和 Pitman 的题为“[功能细胞和价值细胞分离的技术问题”](http://www.nhplace.com/kent/Papers/Technical-Issues.html)的论文解决了这个问题。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-20T15:08:26.380

实际上，正如[Richard Gabriel 和 Kent Pitman 在论文](http://www.dreamsongs.com/Separation.html)中所概述的那样，争论是关于 Lisp-5 与 Lisp-6 的，因为已经存在其他几个命名空间，论文中提到了类型名称、标记名称、块名称和声明名称。 *编辑：这似乎是不正确的，正如 Rainer 在评论中指出的那样：Scheme 实际上似乎是一个 Lisp-1。但是，以下内容在很大程度上不受此错误的影响。*

一个符号是表示要执行的东西还是要引用的东西，从上下文中总是很清楚。将函数和变量放入同一个命名空间主要是一种限制：程序员不能对事物和动作使用相同的名称。Lisp-5 从中得到的只是避免了从不同于当前上下文所暗示的命名空间中引用某些东西的一些语法开销。 *编辑：这不是全貌，只是表面。*

我知道 Lisp-5 的支持者喜欢函数是数据这一事实，并且这在语言核心中得到了表达。我喜欢这样一个事实，即我可以将列表称为“列表”并将汽车称为“汽车”，而不会混淆我的编译器，而且函数无论如何都是一种从根本上特殊的数据。 *编辑：这是我的主要观点：单独的命名空间根本不是一个缺点。*

我也喜欢[Pascal Constanza 对此的看法](http://coding.derkeiler.com/Archive/Lisp/comp.lang.lisp/2004-04/0721.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T05:06:53.277

我在 Python（统一命名空间）与 Ruby（方法与非方法的不同命名空间）中遇到了类似的区别。在这种情况下，我更喜欢 Python 的方法——例如，使用这种方法，如果我想列出一些东西，其中一些是函数，而另一些不是，我不必对它们的名称做任何不同的事情，例如，取决于它们的“功能性”。类似的考虑适用于函数对象被捆绑而不是调用的所有情况（高阶函数的参数和返回值等）。

也可以调用非函数（如果它们的类定义`__call__`，在 Python 的情况下——“运算符重载”的一种特殊情况），因此“上下文区别”也不一定清楚。

然而，我的“lisp-oid”体验主要是/曾经是使用 Scheme 而不是 Common Lisp，所以我可能会潜意识地对最终来自该体验的统一命名空间的熟悉程度产生偏见。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-20T06:27:46.930

Scheme中的函数名只是一个以函数为值的变量。无论我是否这样做`(define x (y) (z y))`，`(let ((x (lambda (y) (z y))))`我都在定义一个可以调用的函数。因此，就Scheme 而言，“变量名很少希望出现在那里”的想法有点似是而非。

Scheme 是一种典型的函数式语言，因此将函数视为数据是其原则之一。让函数成为自己的一种类型，像所有其他数据一样存储是实现这一想法的一种方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-22T17:34:04.120

至少对于 Common Lisp，我看到的最大缺点是可理解性。我们都同意它为变量和函数使用不同的命名空间，但它有多少？在 PAIP 中，Norvig 表明它有“至少七个”命名空间。

当语言的经典书籍之一，由一位备受推崇的程序员撰写，在出版的书中甚至不能肯定地说，我认为有问题。我对多个命名空间没有问题，但我希望该语言至少足够简单，以至于*有人*可以完全理解它的这一方面。

我很乐意为变量和函数使用相同的符号，但在更晦涩的领域，我出于恐惧而使用不同的名称（冲突的命名空间真的很难调试！），这真的不应该是案子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-21T20:00:52.057

这两种方法都有好处。但是，我发现在重要的时候，我更喜欢同时拥有一个函数 LIST 和一个变量 LIST，而不是不得不错误地拼写其中一个。

# php - 我在 mysql 中有一个问题，我有一个自动递增的字段 id 和一些其他字段

> ID：1020970
> 
> 赞同：1
> 
> 时间：2009-06-20T04:52:14.230
> 
> 标签：php, mysql

我在 mysql 中有一个问题，我有一个自动递增的字段 id 和一些其他字段。其中 id 字段在输入空值时不应自动递增，而应在输入值时自动递增 在同一行中插入值而不给出空值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T05:26:35.903

听起来您需要在自己的代码中自己生成 id 字段的值，而不是让数据库生成它。

如果您在数据库中创建身份字段，数据库将自动创建该字段。通常在保存记录时会发生这种情况，无论是否存在空字段。如果您需要比这更多的控制，您必须自己生成 id 值。

如果您需要知道下一个 id 号是什么，可以使用 SELECT MAX(id_field);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T06:29:12.403

罗伯特哈维的回答解决了这个问题，但我也建议看看你正在保存什么，看看是否有另一种方法。也许空值应该保存在另一个表中？也许您拥有的自动增量列不是主键。

这可能不是方向，但在这种情况下，值得退后一步重新检查。

# django - Django - 'WSGIRequest' 类型的参数不可迭代

> ID：1020978
> 
> 赞同：2
> 
> 时间：2009-06-20T04:59:41.100
> 
> 标签：django, django-forms

使用表单时如何修复以下 Django 错误？

```
TypeError at /url/
argument of type 'WSGIRequest' is not iterable 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T05:03:53.233

在调试我的代码约 45 分钟后，我发现需要以下行来传递发布信息的请求字典而不是请求本身：

```
# This: 
#    job_form = JobForm(request)
# Should Be: 
job_form = JobForm(request.GET) # OR
job_form = JobForm(request.POST) 
```

最初在 Google 上无法打开任何内容。希望这对某人有帮助！

# python - 在 Python 中与另一个命令行程序交互

> ID：1020980
> 
> 赞同：8
> 
> 时间：2009-06-20T05:01:10.897
> 
> 标签：python, command-line, subprocess

我需要编写一个 Python 脚本，它可以运行另一个命令行程序并与它的标准输入和标准输出流进行交互。本质上，Python 脚本将从目标命令行程序中读取，通过写入其标准输入进行智能响应，然后再次从程序中读取结果。（它会反复这样做。）

我已经查看了 subprocess 模块，但我似乎无法让它完成我正在寻找的读/写/读/写的事情。还有什么我应该尝试的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-20T05:12:42.923

要执行如此详细的交互（当在您的控制之外，其他程序可能正在缓冲其输出，除非它认为它正在与终端交谈）需要类似[pexpect](http://pexpect.sourceforge.net/pexpect.html)的东西——这反过来又需要`pty`一个 Python 标准库模块（在运行时）允许它的系统，例如 Linux 和 Mac OS x）实现“伪终端”。

Windows 上的生活更艰难，但也许[这个 zipfile](http://sage.math.washington.edu/home/goreckc/sage/wexpect/wexpect.zip)可以提供帮助——它应该是`pexpect`Windows 的一个端口（抱歉，我没有 Windows 机器可以检查它）。有问题的项目名为`wexpect`，[就在这里](http://code.google.com/p/wexpect/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-20T05:06:06.567

请参阅问题 [wxPython：如何创建 bash shell 窗口？](https://stackoverflow.com/questions/989129/wxpython-how-to-create-a-bash-shell-window/1005079#1005079)

在那里，我与 bash shell 进行了完整的交互，读取 stdout 和 stderr 并通过 stdin 进行通信

主要部分是此代码的扩展

```
bp = Popen('bash', shell=False, stdout=PIPE, stdin=PIPE, stderr=PIPE)
bp.stdin.write("ls\n")
bp.stdout.readline() 
```

如果我们读取所有数据，它将被阻止，因此我给出的脚本链接在一个线程中执行。这是一个部分模仿 bash shell 的完整 wxpython 应用程序。

# chat - 哪个更好？长 TCP 连接还是长轮询？

> ID：1020988
> 
> 赞同：1
> 
> 时间：2009-06-20T05:04:40.063
> 
> 标签：chat, xmpp

我打算在我的网站上建立一个网络聊天。我知道这样做的两种方式：一种是使用XMPP Web客户端（通过flash，长TCP连接），另一种是facebook方式，长轮询。

但是 facebook 将更新他们的聊天以支持 Jabber (XMPP)，那么有人能告诉我们哪种方式更好吗？（包括升级到 XMPP）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T05:15:06.870

在我的应用程序中通过长轮询获得了相当不错的结果，但更大的问题是您是否会面临[C10K 问题](http://www.kegel.com/c10k.html)。如果是这样，至少在短期内，构建您的代码以处理这种繁重的工作负载可能会主导所有其他设计考虑因素。:-)

除了服务器负载，使用哪种策略的主要考虑因素是客户端环境兼容性——为了能够在只允许 HTTP 的严苛防火墙后面工作，或者在禁止任何插件的浏览器环境中工作，长轮询是唯一的生存方式，但它比简单的 TCP 连接方法开销更大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-03T19:06:05.923

它们有不同的优点和缺点，例如：TCP 需要一个插件（至少在 HTML5 网络套接字得到广泛支持之前），Long Polling 性能较差等。我不是这种差异的专家，这就是我推荐的原因您要**避免做出这种选择**，避免每种方法涉及的开发和调整，避免未来可用技术的变化（即随着 HTML5 的到来），使用**抽象所用传输方法**的库，并根据客户端功能选择最佳方法：

[http://socket.io/](http://socket.io/)

这个奇妙的库使创建实时应用程序变得非常简单！并且有各种服务器端实现：Python (Tornado)、Java、Google GO、Rack (Ruby)，除了 Node.js 中的主流实现（服务器端 JavaScript）

# php - “任何”变量的代码？

> ID：1020998
> 
> 赞同：2
> 
> 时间：2009-06-20T05:09:56.423
> 
> 标签：php, mysql

我想合并以下代码。虽然我不确定如何引用 SELECT * FROM 任何以列表结尾的表。

```
 $this->displaylistings=mysql_query("SELECT * FROM nordstromlisting WHERE ShopperID = '$this->ShopperID'
    UNION ALL SELECT * FROM saksfifthavenuelisting WHERE ShopperID = '$this->ShopperID'
    UNION ALL SELECT * FROM guesslisting WHERE ShopperID = '$this->ShopperID'
    UNION ALL SELECT * FROM gnclisting WHERE ShopperID = '$this->ShopperID'
    UNION ALL SELECT * FROM urbanoutfitterslisting WHERE ShopperID = '$tnis->ShopperID'
    UNION ALL SELECT * FROM bananarepubliclisting WHERE ShopperID = '$this->ShopperID'
    UNION ALL SELECT * FROM americaneaglelisting WHERE ShopperID = '$this->ShopperID'
    UNION ALL SELECT * FROM neimanmarcuslisting WHERE ShopperID = '$this->ShopperID'
    UNION ALL SELECT * FROM footlockerlisting WHERE ShopperID = '$this->ShopperID'"); 
```

先谢谢了

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-20T05:21:03.443

据我所知，没有办法使用通配符来引用表格。

您可能需要考虑更改架构，以便拥有一个`listing`包含一列的表来指示它是哪种类型的列表（saksfifthavenue、guess、...）。

然后，您可以简单地查询该单个表。

这也会使您的架构更好地[规范化。](http://en.wikipedia.org/wiki/Database_normalization)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T08:08:23.340

[您可以使用SHOW TABLES](http://dev.mysql.com/doc/refman/5.0/en/show-tables.html)命令通过通配符进行查询。在你的情况下，你会这样做：

```
SHOW TABLES LIKE '%listing' 
```

这适用于命令行或 PHP：

```
 $find_tables_query = "SHOW TABLES LIKE '%listing'";
$result = mysql_query($find_tables_query)
    or die ("Cannot make query. " . mysql_error());

$queries = array();
while ($row = mysql_fetch_row($result)) {
    $queries[] = 'SELECT * FROM '
        . $row[0]
        . ' WHERE ShopperID=\'$this->ShopperID\'';
}
$combined_query = implode("\nUNION ALL\n",$queries);

// for debugging, print query:
print "<pre>";
print $combined_query;
print "</pre>"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T05:18:51.933

据我所知，您不能在表名中指定通配符。所以你的代码可能尽可能小。

如果您不需要实时访问，您可以定期将结果写入另一个表，并仅引用该表。