# StackOverflow 问答 10126000-10126999

# graphics - 无效的三角形

> ID：10126001
> 
> 赞同：2
> 
> 时间：2012-04-12T14:45:10.623
> 
> 标签：graphics, 3d

在 3D 网格中检测无效三角形的最快方法是什么？作为无效我的意思是：

*   零区
*   三个共线点
*   两个重叠点

我们目前使用这种 - 非常慢 - 方法：

```
 if (Area(p1,p2,p3) < 1e-3)

         Debug.WriteLine("Invalid triangle found!");

    public double Area(Point p1, Point p2, Point p3)
    {

        double[,] m = new double[3, 3];

        m[0, 0] = p1.Y; m[0, 1] = p1.Z; m[0, 2] = 1;
        m[1, 0] = p2.Y; m[1, 1] = p2.Z; m[1, 2] = 1;
        m[2, 0] = p3.Y; m[2, 1] = p3.Z; m[2, 2] = 1;

        double det1 = Matrix.Determinant3(m);

        m[0, 0] = p1.Z; m[0, 1] = p1.X; m[0, 2] = 1;
        m[1, 0] = p2.Z; m[1, 1] = p2.X; m[1, 2] = 1;
        m[2, 0] = p3.Z; m[2, 1] = p3.X; m[2, 2] = 1;

        double det2 = Matrix.Determinant3(m);

        m[0, 0] = p1.X; m[0, 1] = p1.Y; m[0, 2] = 1;
        m[1, 0] = p2.X; m[1, 1] = p2.Y; m[1, 2] = 1;
        m[2, 0] = p3.X; m[2, 1] = p3.Y; m[2, 2] = 1;

        double det3 = Matrix.Determinant3(m);

        return Math.Sqrt(det1 * det1 + det2 * det2 + det3 * det3) / 2;

    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T14:55:58.647

面积为零的唯一方法是这些点都是共线的。

尝试以下操作：

```
p1_p2_slope = (p2.y - p1.y) / (p2.x - p1.x);
p2_p3_slope = (p3.y - p2.y) / (p3.x - p2.x);
if(p1_p2_slope == p2_p3_slope) {
 // points are collinear
}

if(p1.x == p2.x && p1.y == p2.y) {
  // p1 and p2 overlap
}
if(p1.x == p3.x && p1.y == p3.y) {
  // p1 and p3 overlap
}
if(p3.x == p2.x && p3.y == p2.y) {
  // p3 and p2 overlap
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T16:34:59.953

我认为这样做

```
abs(dot(sub(b,a), cross(sub(c,b)))) < epsilon 
```

如果您只想扩展它，我认为它可以解决：

```
abs((b.x - a.x) * (c.y - b.y) + (b.y - a.y) * (b.x - c.x)) < epsilon 
```

# asp.net-mvc-3 - 剃刀局部视图，以适应不同的模型类型

> ID：10126005
> 
> 赞同：0
> 
> 时间：2012-04-12T14:45:15.807
> 
> 标签：asp.net-mvc-3, inheritance, razor, model, partial-views

mvc razor 局部视图是否可以采用 2 个模型之一......我有一个创建模板和一个编辑模板，它们相似但不相同。所以我创建了一个通用的局部视图，将类似的项目提取到其中，但它需要一个模型。我希望这个部分能够根据调用它的位置来接受创建模型或编辑模型。

所以在我的创建视图中，我会说 `@{Html.Partial("EditorTemplates/CommonModel", Model);}` 我的创建模型在哪里

在编辑 `@{Html.Partial("EditorTemplates/CommonModel", Model);}` 中，模型是我的编辑模型......我应该如何在部分上定义模型来满足这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T14:49:38.163

听起来像是继承的完美案例。创建一个基类，其中包含您通常持有的部分所需的一切。让您的编辑器模型和您的创建模型都继承自它。将基类定义为局部视图的模型。将您碰巧拥有的任何子类（创建或编辑）模型传递给您的`Html.Partial`调用。

# php - Gmail 通过 IMAP 优先收件箱？

> ID：10126009
> 
> 赞同：3
> 
> 时间：2012-04-12T14:45:33.473
> 
> 标签：php, gmail, imap

我通过 IMAP 连接到我的 GMail 帐户（使用 php_imap） 有没有办法知道邮件是否被标记为“重要”（因此它在优先收件箱中）？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T15:36:11.920

在`[Gmail]`IMAP 中的文件夹下，有一个名为的文件夹`Important`，用于存储所有标记为重要的邮件。

我想您可以检查该特定文件夹中是否存在该消息。

更多信息在这里：[http ://techcrunch.com/2010/09/03/priority-inbox-imap/](http://techcrunch.com/2010/09/03/priority-inbox-imap/)

# android - 如何在 OS X 10.7.3 上修复/设置 Eclipse Java EE 并为其授予权限？

> ID：10126013
> 
> 赞同：1
> 
> 时间：2012-04-12T14:45:53.027
> 
> 标签：android, eclipse, macos, permissions, permission-denied

我无法更新包，无法清理项目，无法构建项目。

**在构建项目时，它给我写了一个错误：**

由于“无法删除 '/.../classes/com'.”，该项目未构建。修复问题，然后尝试刷新此项目并构建它，因为它可能不一致 Unknown Java Problem

**当我试图清理它报告的项目时：**

构建过程中发生错误。在项目“...”上运行构建器“Android Package Builder”时出错。删除资源时遇到的问题。无法删除....

**更新时：**

android-sdk-macosx/temp/google_apis-15_r02.zip（权限被拒绝）

看起来它没有获得系统调用或类似权限的权限。当我在使用“sudo -s”登录后从终端使用：“./eclipse”启动 eclipse 时，它​​会获得所有权限并清理和构建项目，但是当我以这种方式构建项目并在设备或模拟器上启动它时，它崩溃了。

我的问题是 - 我需要做什么才能授予 eclipse 会话的所有权限？我需要在 .bash_profile 中编辑什么？它也看不到工作路径。

**在 .bash_profile 我有：**

导出 PATH=${PATH}:~/android-sdk-macosx/tools

并且查看 adb 等也无济于事，我必须始终提供完整路径。

我已经修复了 OS X 中的权限，Eclipse 版本：

版本：Indigo Service Release 2 内部版本 ID：20120216-1857

**PS我与eclipse的最后一次互动是：**

安装了 MAT，并将 4.03 api 从 16 更新到 18，但我确信问题出现在此之前，导致我在简单会话中无法执行所有这些操作，但是从 sudo 和前一天，它是完全工作的 IDE .

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T14:55:17.603

我会在 Eclipse 工作区或项目上尝试 - chown -R $me $folder。也许您以不同的用户开始它并以这种方式获得了一些不一致的权限。

# ruby-on-rails-3.1 - Rails 在页面中突出显示当前菜单

> ID：10126014
> 
> 赞同：0
> 
> 时间：2012-04-12T14:45:53.690
> 
> 标签：ruby-on-rails-3.1

所以我在 application.html.erb 文件中有这个：

```
<div class="mainMenu">
<%= link_to 'Movies', dvds_path %>  
<%= link_to 'Books', books_path %>  
<%= link_to 'Albums', cds_path %> 
<%= link_to 'Games', games_path %> 
</div> 
```

如果我们在每个页面上，我想在菜单上放置一个“突出显示”类，例如，在电影页面中，如果我们在 dvds_path 中，那么它将是：

```
<%= link_to 'Movies', dvds_path, :class => 'highlight' %> 
```

但似乎无法弄清楚，这些方法都不适合我：

[使用控制器](https://stackoverflow.com/questions/829727/highlight-tab-in-menu)

[使用助手](http://juliocapote.com/post/52081481/highlight-link-based-on-current-page-in-rails)

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T14:55:26.013

你可以使用：

```
link_to_unless_current(name, options = {}, html_options = {}, &block) 
```

使用由选项集创建的 URL 创建给定名称的链接标记，除非当前请求 URI 与链接相同，在这种情况下，仅返回名称（或产生给定块，如果存在）。你可以给link_to_unless_current 一个专门化默认行为的块（例如，显示“从这里开始”链接而不是链接的文本）。

[http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to_unless_current](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to_unless_current)

因此，您可以在导航栏中将“链接”设置为未选中，并在链接不存在时使用“已选择”样式。

```
li { color:#fff; } /* selected */
li a { color:#333; }
li a:hover { color:#999; }

<ul id="navbar">
  <li>Home</li>
  <li><a href="/controller/about">About Us</a></li>
</ul> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:18:57.657

我很确定如果你把它放在一个 do 块中，如果链接是当前的，你可以分配一个备用内容值。

如果当前操作是给定的操作，则评估给定给 link_to_unless_current 的隐式块。所以，如果我们有一个评论页面并且想要呈现一个“返回”链接而不是评论页面的链接，我们可以这样做......</p>

```
<%=
  link_to_unless_current("Comment", { :controller => "comments", :action => "new" }) do
    image_tag src=>"/image.jpg"
  end
%> 
```

# database - 关系数据库设计：连接不同类型的“对象”

> ID：10126015
> 
> 赞同：0
> 
> 时间：2012-04-12T14:45:54.483
> 
> 标签：database, relational

我目前正在为我的一个项目设计一个数据库。目标是连接不同类型的“对象”，如网络链接、文本、图片和文件。使用下表，我的第一次尝试如下所述结束：

```
TABLE text
TABLE picture
TABLE file 
```

所以我的第一次尝试是使用 n:m 关系将每个表连接到表“项目”。之后我必须创建一个表来保护这些对象之间的连接，所以我创建了一个“关系”表。但是问题出现了，我无法非常有效地将每个表（文本、图片和文件）相互连接起来。

你们中的任何人现在如何以一种好的方式做这样的事情？提前感谢您的帮助！西里尔C

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T14:55:28.027

`N:M relation`可以使用以下技术解决。让我们假设有一个实体`Student`，您创建一个名为 的表`Student`，一个实体`Teacher`因此创建了一个表`Teacher`。让我们假设`one teacher`可以教`many` `students`并且`one student`可以被教`many teachers`。因此，为了解决这个问题，可以引入`weak entity`，假设您创建了一个名为 的表`TeacherStudent`。的列`TeacherStudent`可能是`pkTeacherStudentId`, `fkTeacherId`, `fkStudentId`。

在您的案例中可以应用相同的方法来解决`N:M`关系。

希望这有帮助。

# opencl - OpenCL 内核在 Nvidia GPU 上每个线程使用多少寄存器？

> ID：10126020
> 
> 赞同：3
> 
> 时间：2012-04-12T14:46:03.677
> 
> 标签：opencl, gpu, nvidia

我的第一个问题是如何在 Nvidia GPU 上获取 OpenCL 内核代码的寄存器使用信息，因为 nvcc 编译器`nvcc --ptxas-options=-v`为 CUDA 内核代码提供了相同的 using 标志。

我还从`.isa file`运行程序时生成的 OpenCL 内核的 AMD GPU 上获得了相同的信息，在导出`GPU_DUMP_DEVICE_KERNEL=3`. 我也在 Nvidia GPU 上尝试过同样的事情，但没有得到`.isa file`。我的第二个问题是为什么 Nvidia GPU 不生成`.isa file`？

谷歌搜索后，我发现获取 Nvidia GPU 上 OpenCL 内核的寄存器和共享内存使用信息的方法是`cl-nv-verbose`在 clBuildProgram() 函数调用中使用字符串标志。然后读取编译内核代码的“二进制”信息。我的第三个问题是在 Nvidia GPU 上获取寄存器使用信息的正确方法吗？其他获得相同方法的方法是什么？

//构建程序...

```
clBuildProgram(program, 1, &device_id, "-cl-nv-verbose", NULL, NULL); 
```

在构建程序后，我在 clGetProgramInfo() 函数中使用了两个常量`CL_PROGRAM_BINARY_SIZES and CL_PROGRAM_BINARIES`来获取已编译内核代码的二进制文件。

// 打印编译内核代码的二进制文件...

```
cl_uint program_num_devices, ret;
    size_t t;
    ret = clGetProgramInfo(program, CL_PROGRAM_NUM_DEVICES, sizeof(cl_uint), &program_num_devices, NULL);
    if(program_num_devices == 0) {
            printf("No valid device was found \n");
            return ;
    }
    size_t binary_sizes[program_num_devices];
    char **binaries = (char **) malloc(program_num_devices * sizeof(char* ));
    //first call to get size of ISA binary file...
    ret = clGetProgramInfo(program, CL_PROGRAM_BINARY_SIZES, program_num_devices * sizeof(size_t), &binary_sizes, NULL);
    for(t = 0; t < program_num_devices; t++) {
            binaries[t] = (char *) malloc((binary_sizes[t] + 1) * sizeof(char));
    }
    //second call to get ISA info....
    ret = clGetProgramInfo(program, CL_PROGRAM_BINARIES, program_num_devices * sizeof(size_t), binaries, NULL);
    for(t = 0; t < program_num_devices; t++) {
            binaries[t][binary_sizes[t]] = '\0';
            printf("Binary ISA Info%s : %lu \n", binaries[t], binary_sizes[t]);
    }
    printf("ProgramNumDevices:: %u\n", program_num_devices);
    for(t = 0; t < program_num_devices; t++) {
            free(binaries[t]);
    } 
```

这是打印我编译的 OpenCl 内核代码的“二进制文件”。但它不显示寄存器和共享内存使用信息。为什么？

请分享一些有用的信息。

提前致谢 ！！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T15:53:05.327

通过快速搜索，看起来在使用 构建程序之后`-cl-nv-verbose`，您会获得使用 的详细输出`clGetProgramBuildInfo(...,CL_PROGRAM_BUILD_LOG,...)`。

# mongodb - 使用 MongoDb csharp 驱动程序更改类型时反序列化字段

> ID：10126025
> 
> 赞同：9
> 
> 时间：2012-04-12T14:46:20.337
> 
> 标签：mongodb, mongodb-.net-driver

我正在使用 MongoDb 测试一些场景，以了解如何从可能的数据问题中恢复。

我有类（带有地址集合的地址）在地址中具有邮政编码属性，该属性最初被转换为字符串。我保存了多条地址记录，并且可以很好地检索它们。像这样， var allAddresses =addresses.FindAllAs();

我将邮政编码属性更改为 int 并保存了一些记录。然后我将邮政编码属性改回字符串。

当我尝试回读集合时，我收到反序列化错误，正如预期的那样。var allAddresses = 地址.FindAllAs();

我的目标是能够覆盖反序列化，因此如果发生字段反序列化错误，我可以选择忽略它或应用默认值。

我尝试了一个自定义序列化程序，但它不起作用。任何建议，将不胜感激。

```
public class MyCustomSerializer : BsonBaseSerializer
  {

    public override object Deserialize(BsonReader bsonReader, Type nominalType,  IBsonSerializationOptions options)
    {
      if (bsonReader.CurrentBsonType != BsonType.String)
      {
        return string.Empty;
      }

      return bsonReader.ReadString();
    }

    public override void Serialize(
               BsonWriter bsonWriter,
               Type nominalType,
               object value,
               IBsonSerializationOptions options)
    {
      bsonWriter.WriteStartDocument();
      bsonWriter.WriteName("ZipCode");
      bsonWriter.WriteString(value.ToString());
      bsonWriter.WriteEndDocument();
    }
  } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-12T17:43:56.537

有几件事正在发生。主要问题是无论类型如何，您都必须使用输入，否则反序列化过程会不同步。我已经测试了您的场景，编写了一个名为 ZipCodeSerializer 的自定义序列化程序，它处理空值并将 ZipCodes 写入字符串，但在输入时接受字符串或整数并将整数转换为字符串。

我用这个类来测试：

```
public class Address
{
    public ObjectId Id;
    public string ZipCode;
} 
```

这是我编写的自定义序列化程序：

```
public class ZipCodeSerializer : BsonBaseSerializer
{
    public override object Deserialize(BsonReader bsonReader, Type nominalType, Type actualType, IBsonSerializationOptions options)
    {
        var bsonType = bsonReader.CurrentBsonType;
        switch (bsonType)
        {
            case BsonType.Null:
                bsonReader.ReadNull();
                return null;
            case BsonType.String:
                return bsonReader.ReadString();
            case BsonType.Int32:
                return bsonReader.ReadInt32().ToString();
            default:
                var message = string.Format("ZipCodeSerializer expects to find a String or an Int32, not a {0}.", bsonType);
                throw new BsonSerializationException(message);
        }
    }

    public override void Serialize(BsonWriter bsonWriter, Type nominalType, object value, IBsonSerializationOptions options)
    {
        if (value == null)
        {
            bsonWriter.WriteNull();
        }
        else
        {
            bsonWriter.WriteString((string)value);
        }
    }
} 
```

您必须确保自定义序列化程序已连接，您可以这样做：

```
BsonClassMap.RegisterClassMap<Address>(cm =>
    {
        cm.AutoMap();
        cm.GetMemberMap(a => a.ZipCode).SetSerializer(new ZipCodeSerializer());
    }); 
```

因此，现在 Address 类的 ZipCode 字段将由自定义序列化程序处理。

我使用 BsonDocument 创建了一些测试数据，以便轻松强制在我的测试集合中存储特定的数据版本：

```
collection.Drop();
collection.Insert(new BsonDocument());
collection.Insert(new BsonDocument("ZipCode", BsonNull.Value));
collection.Insert(new BsonDocument("ZipCode", "12345"));
collection.Insert(new BsonDocument("ZipCode", 56789)); 
```

以下是使用 mongo shell 时文档的样子：

```
> db.test.find()
{ "_id" : ObjectId("4f871374e447ad238040e346") }
{ "_id" : ObjectId("4f871374e447ad238040e347"), "ZipCode" : null }
{ "_id" : ObjectId("4f871374e447ad238040e348"), "ZipCode" : "12345" }
{ "_id" : ObjectId("4f871374e447ad238040e349"), "ZipCode" : 56789 }
> 
```

所以我们看到一些 ZipCodes 是字符串，一些是整数（还有一个 null 被抛出）。

这是我的测试代码：

```
foreach (var document in collection.FindAll())
{
    Console.WriteLine(document.ToJson());
} 
```

运行测试代码的输出是：

```
{ "_id" : ObjectId("4f871374e447ad238040e346"), "ZipCode" : null }
{ "_id" : ObjectId("4f871374e447ad238040e347"), "ZipCode" : null }
{ "_id" : ObjectId("4f871374e447ad238040e348"), "ZipCode" : "12345" }
{ "_id" : ObjectId("4f871374e447ad238040e349"), "ZipCode" : "56789" }
Press Enter to continue 
```

请注意，数据库中的 int 邮政编码现在是一个字符串。

我的测试程序的完整源代码位于：

[http://www.pastie.org/3775465](http://www.pastie.org/3775465)

# css - CSS：带有浮动右按钮的流畅文本输入

> ID：10126031
> 
> 赞同：5
> 
> 时间：2012-04-12T14:46:46.003
> 
> 标签：css, forms, fluid-layout

我正在尝试使用右侧的提交按钮创建一个流畅的文本输入。输入和按钮应填充其容器的 100%。

这是我想要实现的近似值：http: [//jsfiddle.net/t7tgJ/](http://jsfiddle.net/t7tgJ/)

我遇到的问题是，为了让输入填充它的容器，我需要给它一个流体宽度，比如 100%。但是，如果我将按钮浮动到右侧，我需要将该宽度降低到 90% 左右，以便按钮适合。但这仅适用于一种视口大小。

我想要的是类似的东西

```
input { width: 100% - {button.width}; }
button { float: right; } 
```

或者，用简单的英语，我的输入应该延伸到右浮动按钮，并在任何视口大小下保持这种状态。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-12-01T09:50:18.467

我认为您的问题有两种解决方案。

1）您可以 `display: flex`在容器元素和 `flex-grow: 1`输入上使用。[这是一个代码笔](http://codepen.io/transGLUKator/pen/yyYaoL)

2）您可以使用[这篇文章](https://boulderinformationservices.wordpress.com/2011/02/02/input-field-and-submit-button-on-the-same-line-full-width/)`overflow: hidden`中的技巧。尽管您必须在您的字段上使用额外的包装器。`input`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T14:57:08.303

像这样的东西？[小提琴](http://jsfiddle.net/t7tgJ/1/)它似乎适用于固定大小的按钮:-)关键是为按钮腾出空间，并在输入周围添加边距......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-13T10:59:31.353

尽管他们都表达了很好的想法，但我无法让各种建议在浏览器中看起来一致。在对此进行了迭代之后，我想出了以下解决方案，该解决方案看起来适用于所有 > IE7 并且不需要任何额外的容器。

[http://jsfiddle.net/tjlahr/hUeZS/](http://jsfiddle.net/tjlahr/hUeZS/)

基本上我的解决方案是：

1)`button { float: right; position: relative; top: -28px; }`

2) 使用浏览器重置来取消添加到按钮元素的一些额外填充和边距。

3）设置输入和按钮的高度，以进一步保持浏览器之间的大小一致。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-10T14:52:20.510

找到[了这个](http://boulderinformationservices.wordpress.com/2011/02/02/input-field-and-submit-button-on-the-same-line-full-width/)，它对我很有用。[JSFiddle](http://jsfiddle.net/nmalancea/hsy2ob18/)

1.  `float: right`在按钮上
2.  给出该字段`width: 100%`并将其包装在一个 div 中`overflow: hidden`

HTML

```
<a href="#" class="search-btn">Search</a>
<div class="search-field-wrap">
  <input class="search-input" type="text" name="search">
</div> 
```

CSS

```
.search-btn {
    float: right;
}
.search-field-wrap {
    overflow: hidden;
}
.search-input {
    width: 100%;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-03T02:04:39.300

改编后的托马斯小提琴只需稍作改动

[http://jsfiddle.net/hUeZS/147/](http://jsfiddle.net/hUeZS/147/)

不要使用 top: -28px，而是尝试 margin-top: -28px。这在我的情况下更好，因为它下面的元素仍然获得全宽并且不会受到影响。

```
...

form button {
    /* style */
    background-color: lightblue;
    border: none;
    padding: 7px;

    /* to match input height above */
    height: 28px;

    /* removes the box from DOM */
    float: right;

    /* alternative to negative margin-top,
    which seems to hide my button behind the input */
    position: relative;
    top: 0px;
    margin-top: -28px;
}

... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-12T14:59:49.317

在按钮上应用负上边距：http: [//jsfiddle.net/t7tgJ/2/](http://jsfiddle.net/t7tgJ/2/)

**更新：**

要在固定按钮宽度的新条件下完成此操作，请将输入浮动到左侧，将按钮浮动到右侧。但是，您必须对表单元素应用 clearfix，因为它的高度与所有浮动的子元素一起折叠：http: [//jsfiddle.net/t7tgJ/3/](http://jsfiddle.net/t7tgJ/3/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-01T19:09:50.287

`display: flex;`可以解决很多问题没有`float`
看到通过弹性布局解决[http://philipwalton.github.io/solved-by-flexbox/demos/input-add-ons/](http://philipwalton.github.io/solved-by-flexbox/demos/input-add-ons/)

# c# - 如何使用 TableAdapter 更新 DatabaseDataSet？

> ID：10126036
> 
> 赞同：0
> 
> 时间：2012-04-12T14:46:56.663
> 
> 标签：c#, database, sql-server-ce

我正在使用 Visual C# Studio 2010 express 并且一直在尝试批量更新我的表。每次我尝试更新 1 条记录时，我都会收到“并发冲突：UpdateCommand 影响了预期的 1 条记录中的 0 条”。我在梦中用代码问过这个问题，但我对一些诚实问题的回答有些失望。[链接到我在 DIC 的问题](http://www.dreamincode.net/forums/topic/274690-concurrency-violation-while-trying-to-update-database/)

我接受了最后的建议并更改了我的代码以影响数据集..或者我认为但我仍然遇到并发问题。这是我更新的代码。

```
 private void SendNewPotentialsToZoho()
    {
        Console.WriteLine("Trying to send potentials to Zoho");

        var newZoho = potentialDatabaseDataSet.Potential.DefaultView;
        var poster = new ZohoPoster(ZohoPoster.Fields.Potentials, ZohoPoster.Calls.insertRecords);
        var count = 0;

        //newZoho.RowFilter = "IsNull(ZohoID,'zoho') = 'zoho'";
        newZoho.RowFilter = "Soid = 1234";
        poster.Debugging = !UseZoho;
        for (int i = 0; i < 1; i++)//newZoho.Count; i++)
        {
            var xmlString = Potential.GetPotentialXML(newZoho[i][1], newZoho[i][2], newZoho[i][4], newZoho[i][3], newZoho[i][5], newZoho[i][7], newZoho[i][0]);
            Console.WriteLine("Sending New Records to Zoho: {0}", xmlString);
            poster.PostItem.Set("xmlData", xmlString);
            var result = poster.Post(3);
            Console.WriteLine(result);
            if (!string.IsNullOrEmpty(result))
            {
                try
                {
                    var rowLength = newZoho[i].Row.ItemArray.Length;
                    var rowOffset = Math.Abs((int)newZoho[i][rowLength - 1])-1;

                    potentialDatabaseDataSet.Potential.Rows[rowOffset]["ZohoID"] = ReadResult(result);
                    potentialTableAdapter.Update(potentialDatabaseDataSet.Potential.Rows[rowOffset]);
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Failed to update: {0}", ex.Message);
                }
            }
        }
    } 
```

名为海报的位变量效果很好。它返回一个类似 xml 的结果，其中包含我解析并尝试存储的 zohoID。出于测试目的，我尝试只更新一条记录。我收到 potentialTableAdapter.Update(potentialDatabaseDataSet) 的错误。对我来说奇怪的是，我使用非常相似的代码来制作全新的记录，而且效果很好。事实上，这就是我使用 Soid = 1234 创建行的方式。我是唯一可以访问该程序的人，而且据我所知它不是多线程的，所以我只是不明白为什么它会出现并发问题。请帮忙 ：）

*编辑*

好的，所以我在玩它，发现如果我向它添加 EndEdit，我不会遇到并发问题。另一方面，虽然我绑定的 datagridview 显示了更新的数据，但数据实际上并没有得到更新。所以这并不是说我回到了第一方，我认为我实际上已经很接近了。我是从记忆中记忆一小段代码，所以如果它不正确，请不要讨厌..这主要是为了了解我在说什么

```
 for (int i = 0; i < 5; i++) //emailRecord.Count; i++)
        {
            if (ZohoEmail.EmailExpectedShipping(emailRecord[i], "12/10/2012"))
            {//true means that the email went through just fine
                try
                {
                    var rowLengh = emailRecord[i].Row.ItemArray.Length;
                    var rowOffset = Math.Abs((int)emailRecord[i][rowLengh - 1]) - 1;

                    potentialDatabaseDataSet.Potential.Rows[rowOffset][17] = true; //17 is Expected Email
                    potentialDatabaseDataSet.Potential.Rows[rowOffset].AcceptChanges();
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Failed to update: {0}", ex.Message);
                }
            }
            potentialTableAdapter.Update(potentialDatabaseDataSet.Potential);
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T19:40:37.623

您不能只更新一行。数据适配器允许更新表，而不是行。所以而不是

```
potentialTableAdapter.Update(potentialDatabaseDataSet.Potential.Rows[rowOffset]); 
```

采用

```
potentialTableAdapter.Update(potentialDatabaseDataSet.Potential); 
```

**编辑**

我不太确定你想在这里实现什么：

```
var rowLength = newZoho[i].Row.ItemArray.Length;
var rowOffset = Math.Abs((int)newZoho[i][rowLength - 1])-1; 
```

看起来您首先获得了列数，最好是：

```
var rowLength = potentialDatabaseDataSet.Potential.Columns.Count; 
```

然后根据最后一列中的值计算行号，并在该值之前获取第一行。这是我不明白为什么？此外，您正在根据视图计算行偏移量。

为什么你不使用：

```
newZoho[i].Row["ZohoID"] = ReadResult(result);
potentialTableAdapter.Update(potentialDatabaseDataSet.Potential); 
```

而不是计算应该更新哪一行？

我相信*ZohoID*是更新前数据库中存在的外键？

**编辑 2**

我认为问题出在您的自动表适配器上。首先尝试以强类型方式更新行：

```
((PotentialRow)newZoho[i].Row).ZohoID = ReadResult(result); 
```

并尝试为您的数据集适配器修改更新查询。自动数据适配器会生成非常丑陋的查询。将更新查询中的 where 子句更改为现在仅比较行**主键**(ID) 的所有值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T15:25:47.927

好吧，我想我想通了。非常感谢 Marcin 在我的这个问题上为我提供了这么多帮助。您对我生成的表适配器中的问题是正确的。我最终根据自动生成的代码制作了自己的代码。这是我的代码，以防其他人对自动生成的代码有问题。

```
using System;
using System.Data.SqlServerCe;
using System.Data.Common;
using System.Data;

namespace Zoho
{
    public partial class PotentialTableAdapter
    {
        SqlCeDataAdapter _adapter;
        SqlCeConnection _connection;
        SqlCeTransaction _transaction;
        SqlCeCommand[] _commandCollection;
        DataTable _table;

        public PotentialTableAdapter()
        {
            ClearBeforeFill = true;
            InitConnection();
            InitAdapter();
            InitCommandCollection();
            FillTable();
        }

        public bool ClearBeforeFill {get; set;}
        public SqlCeDataAdapter Adapter
        {
            get
            {
                if ((this._adapter == null))
                {
                    this.InitAdapter();
                }
                return this._adapter;
            }
        }
        public SqlCeConnection Connection
        {
            get
            {
                if (_connection == null)
                    InitConnection();
                return _connection;
            }
        }
        public SqlCeTransaction Transaction
        {
            get
            {
                return _transaction;
            }
            set
            {
                _transaction = value;
                for (int i = 0; (i < CommandCollection.Length); i = (i + 1))
                {
                    CommandCollection[i].Transaction = value;
                }
                Adapter.DeleteCommand.Transaction = value;
                Adapter.InsertCommand.Transaction = value;
                Adapter.UpdateCommand.Transaction = value;
            }
        }
        public SqlCeCommand[] CommandCollection
        {
            get
            {
                if ((this._commandCollection == null))
                {
                    InitCommandCollection();
                }
                return this._commandCollection;
            }
        }
        public DataTable Table
        {
            get
            {
                if (_table == null)
                    FillTable();
                return _table;
            }
        }

    }
}
using System.Data.Common;
using System.Data.SqlServerCe;
using System.Data;

namespace Zoho
{

    partial class PotentialTableAdapter
    {
                                    private void InitAdapter()
    {
        this._adapter = new SqlCeDataAdapter();
        this._adapter.TableMappings.Add(GetTableMapping());
        this._adapter.SelectCommand = new SqlCeCommand("SELECT * FROM Potential", Connection);
        this._adapter.InsertCommand = GetCommand(@"INSERT INTO [Potential] ([Soid], [SalesRep], [Account], [ClosingDate], [Amount], [Stage], [SourceId], [Product], [FirstName], [Email], [CustomerPO], [ZohoID], [WorkOrder], [ExpectedShip], [TrackingNumber], [DependencyID], [ProcessEmail], [ExpectedEmail], [ShippedEmail]) VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19)");
        this._adapter.UpdateCommand = GetCommand(@"UPDATE [Potential] SET [Soid] = @p1, [SalesRep] = @p2, [Account] = @p3, [ClosingDate] = @p4, [Amount] = @p5, [Stage] = @p6, [SourceId] = @p7, [Product] = @p8, [FirstName] = @p9, [Email] = @p10, [CustomerPO] = @p11, [ZohoID] = @p12, [WorkOrder] = @p13, [ExpectedShip] = @p14, [TrackingNumber] = @p15, [DependencyID] = @p16, [ProcessEmail] = @p17, [ExpectedEmail] = @p18, [ShippedEmail] = @p19 WHERE (([NCPotentialKey] = @p20))");
    }
                    private void InitConnection()
    {
        this._connection = new SqlCeConnection(Zoho.Properties.Settings.Default.PotentialDatabaseConnectionString);
    }
                        private void InitCommandCollection()
    {
        _commandCollection = new SqlCeCommand[1];
        _commandCollection[0] = new SqlCeCommand("SELECT * FROM Potential", Connection);

    }
                        private void FillTable()
    {
        _table = new DataTable();
        Adapter.Fill(_table);
    }

                                                                                                                private DataTableMapping GetTableMapping()
    {
        var tableMapping = new DataTableMapping();

        tableMapping.SourceTable = "Table";
        tableMapping.DataSetTable = "Potential";
        tableMapping.ColumnMappings.Add("Soid", "Soid");
        tableMapping.ColumnMappings.Add("SalesRep", "SalesRep");
        tableMapping.ColumnMappings.Add("Account", "Account");
        tableMapping.ColumnMappings.Add("ClosingDate", "ClosingDate");
        tableMapping.ColumnMappings.Add("Amount", "Amount");
        tableMapping.ColumnMappings.Add("Stage", "Stage");
        tableMapping.ColumnMappings.Add("SourceId", "SourceId");
        tableMapping.ColumnMappings.Add("Product", "Product");
        tableMapping.ColumnMappings.Add("FirstName", "FirstName");
        tableMapping.ColumnMappings.Add("Email", "Email");
        tableMapping.ColumnMappings.Add("CustomerPO", "CustomerPO");
        tableMapping.ColumnMappings.Add("ZohoID", "ZohoID");
        tableMapping.ColumnMappings.Add("WorkOrder", "WorkOrder");
        tableMapping.ColumnMappings.Add("ExpectedShip", "ExpectedShip");
        tableMapping.ColumnMappings.Add("TrackingNumber", "TrackingNumber");
        tableMapping.ColumnMappings.Add("DependencyID", "DependencyID");
        tableMapping.ColumnMappings.Add("ProcessEmail", "ProcessEmail");
        tableMapping.ColumnMappings.Add("ExpectedEmail", "ExpectedEmail");
        tableMapping.ColumnMappings.Add("ShippedEmail", "ShippedEmail");
        tableMapping.ColumnMappings.Add("NCPotentialKey", "NCPotentialKey1");

        return tableMapping;

    }
                                            private SqlCeCommand GetDeleteCommand()
    {
        var deleteCommand = new SqlCeCommand();
        deleteCommand.Connection = this.Connection;
        deleteCommand.CommandText = "DELETE FROM [Potential] WHERE (([NCPotentialKey] = @p1))";
        deleteCommand.CommandType = CommandType.Text;
        var parameter = new SqlCeParameter("@p1", SqlDbType.Int, 0, ParameterDirection.Input, false, 0, 0, "NCPotentialKey", DataRowVersion.Original, null);
        deleteCommand.Parameters.Add(parameter);

        return deleteCommand;
    }
        private SqlCeCommand GetCommand(string text)
        {
            var command = new SqlCeCommand(text);
            command.Connection = this.Connection;
            command.Parameters.Add(new SqlCeParameter("@p1", SqlDbType.Int, 0,      ParameterDirection.Input, true, 0, 0, "Soid",          DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p2", SqlDbType.NVarChar, 0, ParameterDirection.Input, true, 0, 0, "SalesRep",      DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p3", SqlDbType.NVarChar, 0, ParameterDirection.Input, true, 0, 0, "Account",       DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p4", SqlDbType.NVarChar, 0, ParameterDirection.Input, true, 0, 0, "ClosingDate",   DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p5", SqlDbType.Money, 0,    ParameterDirection.Input, true, 0, 0, "Amount",        DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p6", SqlDbType.NVarChar, 0, ParameterDirection.Input, true, 0, 0, "Stage",         DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p7", SqlDbType.Int, 0,      ParameterDirection.Input, true, 0, 0, "SourceId",      DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p8", SqlDbType.NVarChar, 0, ParameterDirection.Input, true, 0, 0, "Product",       DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p9", SqlDbType.NVarChar, 0, ParameterDirection.Input, true, 0, 0, "FirstName",     DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p10",SqlDbType.NVarChar, 0, ParameterDirection.Input, true, 0, 0, "Email",         DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p11",SqlDbType.NVarChar, 0, ParameterDirection.Input, true, 0, 0, "CustomerPO",    DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p12",SqlDbType.NVarChar, 0, ParameterDirection.Input, true, 0, 0, "ZohoID",        DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p13",SqlDbType.Int, 0,      ParameterDirection.Input, true, 0, 0, "WorkOrder",     DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p14",SqlDbType.DateTime, 0, ParameterDirection.Input, true, 0, 0, "ExpectedShip",  DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p15",SqlDbType.NVarChar, 0, ParameterDirection.Input, true, 0, 0, "TrackingNumber",DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p16",SqlDbType.Int, 0,      ParameterDirection.Input, true, 0, 0, "DependencyID",  DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p17",SqlDbType.Bit, 0,      ParameterDirection.Input, true, 0, 0, "ProcessEmail",  DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p18",SqlDbType.Bit, 0,      ParameterDirection.Input, true, 0, 0, "ExpectedEmail", DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p19",SqlDbType.Bit, 0,      ParameterDirection.Input, true, 0, 0, "ShippedEmail",  DataRowVersion.Current, null));
            command.Parameters.Add(new SqlCeParameter("@p20",SqlDbType.Int, 0,      ParameterDirection.Input, true, 0, 0, "NCPotentialKey",DataRowVersion.Original, null));

            return command;
        }
    }
} 
```

现在为我的包装类。我发现这样做非常有用。使用系统；使用 System.Data.SqlServerCe；使用 System.Data；

```
namespace Zoho
{
    public class DatabaseConnection
    {
        PotentialTableAdapter table;
        public DatabaseConnection()
        {
            table = new PotentialTableAdapter();
        }
        public DataTable Table
        {
            get
            {
                return table.Table;
            }
        }

        public void Update()
        {
            try
            {
                Console.Write("Attemping to update database: ");
                table.Adapter.Update(Table);
                Console.WriteLine("Success");
            }
            catch (Exception ex)
            {
                Console.WriteLine("Fail: {0}", ex.Message);
            }
        }

    }
} 
```

最后是真正重要的代码片段。Marcin 帮我弄清楚的那个。其实超级简单。

```
 DatabaseConnection AllPotentials = new DatabaseConnection();
        var newZoho = AllPotentials.Table.DefaultView;
        var poster = new ZohoPoster(ZohoPoster.Fields.Potentials, zohoPoster.Calls.insertRecords);

        newZoho.RowFilter = "IsNull(ZohoID,'zoho') = 'zoho'";
        poster.Debugging = !UseZoho; //UseZoho= false which turns debugging on

        for (int i = 0; i < 1; i++)//newZoho.Count; i++)
        {
            var xmlString = Potential.GetPotentialXML(newZoho[i]);
            Console.WriteLine("Sending New Records to Zoho: {0}", xmlString);
            poster.PostItem.Set("xmlData", xmlString);
            var result = poster.Post(3);
            Console.WriteLine(result);
            if (!string.IsNullOrEmpty(result))
            {
                try
                {
                    newZoho[i].Row["ZohoID"] = ReadResult(result);
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Failed to update: {0}", ex.Message);
                }
            }
        }
        try
        {
            Console.Write("Trying to update the database after getting zoho: ");
            AllPotentials.Update(); 
            Console.WriteLine("Success");
        }
        catch (Exception ex)
        {
            Console.WriteLine("Failed: {0}", ex.Message);
        } 
```

我试了一下，它说成功了，所以我在另一个程序中打开了数据库，结果发现我的假数据中有 zoho id :) 我很兴奋。现在我可以真正启动并运行这个程序了。我现在遇到的唯一问题是，在我的 datagridview 中，它只显示 4 或 5 条记录，而不是 201 条记录（我只是想了一下，我敢打赌过滤器与它有关！）。现在是时候完成我的程序了！:) 再次感谢 Marcin 的耐心并帮助我。既然您告诉我问题出在我的 tableAdapter 中，我将把问题标记为您已回答。

# c# - 组合框 c# - 我如何摆脱组合列表中的第一个空值

> ID：10126039
> 
> 赞同：-2
> 
> 时间：2012-04-12T14:47:27.260
> 
> 标签：c#, combobox

我在任何地方都找不到这个。似乎每个人都试图在列表的第一个获得空值，但我想要相反。我不希望在我的组合框列表中将 null 作为选项。我该如何摆脱它。

```
foreach (String item in comboFieldList)
{
    fieldBox1.Items.Add(item);
} 
```

请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T14:51:00.893

将项目添加到 后`ComboBox`，将 设置`SelectedItem`为第一个项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T14:51:51.047

除非您专门添加一个，否则不应有一个空值。

也许您在填充后没有通知组合框选择列表中的第一项？

填充后，检查它是否有值，如果有，请选择第一个索引。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T16:21:01.807

我同意，您没有正确填充组合框。您需要设置显示成员：-

组合框1.数据源=数据表1；combobox1.DisplayMember = "Column1";

# mysql - SQL获取单行中不为零的列

> ID：10126041
> 
> 赞同：0
> 
> 时间：2012-04-12T14:47:31.597
> 
> 标签：mysql, sql, sqlite

假设我有一张这样的桌子：

表名：测试

```
col1 | col2 | col3 | col4
--------------------------
a    | 0    | 0    | 1 
```

是否可以检索行，以及不为零的列，而不必单独列出每一列？

有没有一种简单的方法来选择值为 1 的行？每行只有 1 列的整数值为 1。

我正在尝试获取不为零的这一行的列名。该表中的列会增长，所以我不想在我的 sql 语句中列出每个列名。我正在使用 SQLite。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:02:34.463

关系数据库的目的是在行中进行操作，而不是在列中。所以列操作非常低效。也许你对你的问题使用了错误的方法。考虑一下：假设您找到了解决问题的方法，如果存在多个“1”会发生什么？如果没有“1”怎么办？

那么我想你也想要具有“1”值的列名，那么你在哪里设法将它存储在结果中？

我强烈建议您将该信息存储在另一个表中，这样您就可以快速实现您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T14:58:33.983

类似的东西能达到你想要的吗？

```
create table Test
(
    col1 nvarchar(100),
    col2 int,
    col3 int,
    col4 int
)
insert into Test  values('a', 1, 0, 0)
insert into Test values('b', 0, 2, 0)
insert into Test values('c', 0, 0, 3)

select col1, val = case
    when col2 > 0 then col2
    when col3 > 0 then col3
    when col4 > 0 then col4
    end
from test 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:05:02.403

一种方法是遍历每一列并确定每一行的该列中的值是否为一个。以下是您可以针对您的环境进行修改的示例：

[http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm](http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm)

您还需要对其进行调整以使其与 SQLite 一起使用。这是我从一个这样做的人那里找到的一句话：

> 我最终通过几个循环来完成它，首先，从 sqlite_master 表中提取表名数组，然后另一个循环循环遍历每个列名，我从 dbCursor.description 中提取出来。 [http://forums.fedoraforum.org/showthread.php?t=219441](http://forums.fedoraforum.org/showthread.php?t=219441)

这将是一个混乱的过程，但它可能会满足您的需求。如果你不想变得太复杂，你可以这样做：

```
SELECT 'Col1' AS Column
FROM Table
WHERE Col1 = 1
UNION ALL
SELECT 'Col2' AS Column
FROM Table
WHERE Col2 = 1
etc. 
```

这是大量的手动工作，并且需要在您更改列时进行更新，但对您来说可能更简单。

# java - eclipse indigo 的链接资源中的 jar 文件给出“无法从 "

> ID：10126050
> 
> 赞同：0
> 
> 时间：2012-04-12T14:48:07.960
> 
> 标签：java, environment-variables, eclipse-indigo

我在 Eclipse 中创建了一个路径变量，并使用此路径链接了一个 jar 文件。然后将此文件添加到构建路径。在我的电脑上它工作正常，但在其他电脑上却出现以下错误。出现对话框，并显示消息“无法从以下位置加载主类清单属性”

基本上我们在eclipse中有不同的项目使用相同的jar文件，这些不同的项目是一个大项目的不同模块。我们需要将所有 jar 文件放在单独的驱动器中。我使用上述机制，所以每当我们将项目移动到任何其他系统时，我们只需要设置变量值，都会自动调整。

任何人都可以告诉这个问题或可以提供替代解决方案??????

——朱奈德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T05:19:43.860

我们已经解决了。转到 Window->Preferences->java->"Build Path"->"Classpath variables" 并创建一个指向库根目录的变量。转到项目属性->“java构建路径”单击“添加变量”，选择您创建的变量并扩展它。这是您可以选择所有罐子的地方。

# visual-studio-2010 - VS 2010 SP1如何选择boost lib文件的版本？

> ID：10126052
> 
> 赞同：2
> 
> 时间：2012-04-12T14:48:14.387
> 
> 标签：visual-studio-2010, boost

在 boost 库目录下，我可以看到以下文件：

libboost_filesystem-vc100-mt-1_46_1.lib
libboost_filesystem-vc100-mt-1_46_1.pdb
libboost_filesystem-vc100-mt-1_47.lib
libboost_filesystem-vc100-mt-gd-1_46_1.lib libboost_filesystem-vc100-mt-gd-1_46_1.pdb
libboost_filesystem-vc100-mt-gd-
1_46_1.pdb -vc100-mt-gd-1_47.lib
libboost_filesystem-vc90-mt-1_47.lib
libboost_filesystem-vc90-mt-gd-1_47.lib

当我构建解决方案时，会报告以下警告：

> 警告 15 警告 LNK4099：在“libboost_filesystem-vc100-mt-1_47.lib(codecvt_error_category.obj)”或“C:\source\Release\libboost_filesystem-vc100”中找不到 PDB“libboost_filesystem-vc100-mt-1_47.pdb” -mt-1_47.pdb'; 链接对象好像没有调试信息 C:\source\Project1\libboost_filesystem-vc100-mt-1_47.lib(codecvt_error_category.obj)

如您所见，VS2010 选择 的版本`libboost_filesystem-vc100-mt-1_47.lib`，因为我们没有`libboost_filesystem-vc100-mt-1_47.pdb`同一目录下的 ，所以链接器会报错。

**问题 > VS2010**使用什么方法来选择链接哪个版本的boost库？

例如，如果我们有以下库文件怎么办，

libboost_filesystem-vc100-mt-1_46_1.lib
libboost_filesystem-vc100-mt-1_47_1.pdb
libboost_filesystem-vc100-mt-1_49_1.lib

VS2010会选择哪个版本？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:00:16.477

它由 boost 标头中的 #pragma 语句确定——因此，无论您最终包含什么版本的标头，这就是它将尝试链接的 lib 版本。

具体来说，你可以在 boost/config/auto_link.hpp 中找到它，它看起来像这样：

```
#  pragma comment(lib, BOOST_LIB_PREFIX BOOST_STRINGIZE(BOOST_LIB_NAME) BOOST_LIB_THREAD_OPT BOOST_LIB_RT_OPT ".lib") 
```

奇怪的是“#pragma comment”实际上指示链接器做某事......但这就是MS的做法......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:39:38.060

Boost 版本在这里定义：

C:\boost1.47\boost\version.hpp

```
//
//  BOOST_LIB_VERSION must be defined to be the same as BOOST_VERSION
//  but as a *string* in the form "x_y[_z]" where x is the major version
//  number, y is the minor version number, and z is the patch level if not 0.
//  This is used by <config/auto_link.hpp> to select which library version to link to.

#define BOOST_LIB_VERSION "1_47" 
```

C:\boost1.49\boost\version.hpp

```
//
//  BOOST_LIB_VERSION must be defined to be the same as BOOST_VERSION
//  but as a *string* in the form "x_y[_z]" where x is the major version
//  number, y is the minor version number, and z is the patch level if not 0.
//  This is used by <config/auto_link.hpp> to select which library version to link to.

#define BOOST_LIB_VERSION "1_49" 
```

Boost库名的组成如下：

C:\boost1.49\boost\config\auto_link.hpp

```
//
// now include the lib:
//
#if defined(BOOST_LIB_NAME) \
      && defined(BOOST_LIB_PREFIX) \
      && defined(BOOST_LIB_TOOLSET) \
      && defined(BOOST_LIB_THREAD_OPT) \
      && defined(BOOST_LIB_RT_OPT) \
      && defined(BOOST_LIB_VERSION) 
```

# java - 我如何使用 gwt-test-utils 来处理 gin？

> ID：10126053
> 
> 赞同：0
> 
> 时间：2012-04-12T14:48:14.463
> 
> 标签：java, gwt, testng, gwt-test-utils

我尝试使用[http://code.google.com/p/gwt-test-utils/wiki/HowToUseWithGIN](http://code.google.com/p/gwt-test-utils/wiki/HowToUseWithGIN)中的步骤，我正在使用 testNG 但它给出了休闲错误

```
java.lang.ExceptionInInitializerError
    at com.riskfocus.examples.JsonReaderWriterTest.setupGIN(JsonReaderWriterTest.java:59)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:80)
    at org.testng.internal.Invoker.invokeConfigurationMethod(Invoker.java:551)
    at org.testng.internal.Invoker.invokeConfigurations(Invoker.java:213)
    at org.testng.internal.Invoker.invokeConfigurations(Invoker.java:138)
    at org.testng.internal.TestMethodWorker.invokeBeforeClassMethods(TestMethodWorker.java:175)
    at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:107)
    at org.testng.TestRunner.privateRun(TestRunner.java:768)
    at org.testng.TestRunner.run(TestRunner.java:617)
    at org.testng.SuiteRunner.runTest(SuiteRunner.java:334)
    at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)
    at org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)
    at org.testng.SuiteRunner.run(SuiteRunner.java:240)
    at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:53)
    at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:87)
    at org.testng.TestNG.runSuitesSequentially(TestNG.java:1185)
    at org.testng.TestNG.runSuitesLocally(TestNG.java:1110)
    at org.testng.TestNG.run(TestNG.java:1022)
    at org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:109)
    at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:202)
    at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:173)
Caused by: java.lang.UnsupportedOperationException: ERROR: GWT.create() is only usable in client code!  It cannot be called, for example, from server code.  If you are running a unit test, check that your test case extends GWTTestCase and that GWT.create() is not called from within an initializer or constructor.
    at com.google.gwt.core.client.GWT.create(GWT.java:91)
    at com.riskfocus.examples.client.model.StockPriceJsonReaderWriter.<clinit>(StockPriceJsonReaderWriter.java:12)
    ... 25 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T05:54:54.660

我猜你忘记扩展 GwtTest 类（它替代了标准 GWTTestCase 类）。

gwt-test-utils / GIN 集成 wiki 页面没有告诉这样做（我的错），这已得到纠正 :)

# sql - 在 ColdFusion 中遇到 SQL 连接问题

> ID：10126057
> 
> 赞同：0
> 
> 时间：2012-04-12T14:48:20.017
> 
> 标签：sql, coldfusion, cfquery, cfoutput

我正在尝试在 CF/SQL 中做一些非常简单的事情，但似乎无法弄清楚我做错了什么。

我有这些表：

```
movies       genres     actors      moviesGenres     moviesActors
------       ------     ------      ------------     ------------
movieId      genreId    actorId     id               id
title        name       fname       movie            movie
                        lname       genre            actor 
```

我正在尝试编写一个简单地列出所有电影的查询，其中包括每部电影的类型（可以多选）和每部电影的演员（同样，可以多选）。

当我编写查询以仅包含流派时，一切正常。我使用查询本身，按movieId分组，然后围绕流派单独分组。

但是当我尝试将演员包括在内时，一切都崩溃了，似乎分组崩溃了。

这是两个连接的 SQL 查询：

```
SELECT m.movieId, m.title, m.releaseDate, m.description, g.name, a.fname, a.lname
FROM movies m
   INNER JOIN genres g ON g.genreId IN (SELECT genre FROM moviesGenres WHERE movie = m.movieId)
   INNER JOIN actors a ON a.actorID IN (SELECT actor FROM moviesActors WHERE movie = m.movieId)
ORDER BY m.title 
```

提前感谢您的帮助！

更新：

Leigh 和 Mark 提供的查询似乎总体上有效，但我仍然看到演员在 . 这是我的代码：

```
<tbody>
   <cfoutput query="variables.movieList" group="movieId">
      <tr>
         <td><a href="##">#title#</a></td>
         <td><cfoutput group="name">#name# | </cfoutput></td>
         <td><cfoutput group="actorId">#actorId# | </cfoutput></td>
      </tr>
   </cfoutput>
</tbody> 
```

我也尝试过没有对最终标签进行分组，但这没有用。请注意，为了简化测试，我将 a.lName 和 a.fName 更改为 a.actorId。

示例行如下所示：

```
The Godfather    Action | Drama |    1 | 2 | 1 | 2 | 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:06:00.133

您必须关联连接中的所有表。否则你会得到一个[笛卡尔积](http://en.wikipedia.org/wiki/Join_%28SQL%29#Cross_join)。所以也要加入联结表，而不是在子查询中使用它们。使用正确的 ORDER BY，您应该能够根据需要`<cfoutput group="..">`来格式化输出。

没有经过测试，但有一些类似的东西。

```
SELECT m.movieId, m.title, m.releaseDate, m.description, g.name, a.actorID, a.fname, a.lname
FROM movies m
        LEFT JOIN moviesGenres mg ON mg.movie = m.movieID
        LEFT JOIN genres g ON g.genreID = mg.genre
        LEFT JOIN moviesActors ma ON ma.movie = m.movieID
        LEFT JOIN actors a ON a.actorId = ma.actor
// since movie names may not be unique, do a secondary sort on movieID
ORDER BY m.title, m.movieID, g.Name, a.fName, a.lName 
```

**根据评论编辑：**

正如史蒂夫所提到的，在使用`cfoutput group`结果时，必须以相同的方式对结果进行排序和分组，才能使功能正常工作。有关更详细的解释，[请参阅他的答案。](https://stackoverflow.com/a/10128805/104223)

另一种方法是使用结构来生成独特的流派和演员。请注意，上面的 sql 查询稍作修改以匹配您更新的示例。

```
<table border="1">
<!--- group by ID in case multiple movies have the same name --->
<cfoutput query="yourQuery" group="movieID">

    <!--- use structures to save unique genres and actors --->
    <cfset genres = {}>
    <cfset actors = {}>
    <cfoutput>
        <cfset genres[name] = true>
        <cfset actors[actorID] = true>
    </cfoutput>

    <!--- display results --->
    <tr><td>#Title#</td>
        <td>#structKeyList(genres, "|")#</td>
        <td>#structKeyList(actors, "|") #</td>
    </tr>
</cfoutput>
</table> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:08:42.187

不确定我喜欢你的语法。我猜你的子选择和别名正在搞砸你的结果。如果我发现你在做什么，你所追求的是加入这些桥牌桌。我会做这样的事情：

```
SELECT m.movieId, m.title, m.releaseDate, m.description, g.name, a.fname, a.lname
FROM movies m
  INNER JOIN movieGenres mg ON m.movieID = mg.movie
  INNER JOIN genres g ON g.genreID = mg.genre
  INNER JOIN movieactors ma on ma.movie  = m.movieID
  INNER JOIN actors a on ma.actor = a.actorID
ORDER BY m.title 
```

如果actors.movi​​e 和genres.movi​​​​e都匹配movies.movi​​eID，这将起作用 - 但通常我希望看到比这更好的外键。例如，如果 Actor.movi​​​​e 确实包含“movieID”，则将其命名为“movieID” - 否则我想我正在寻找

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-12T17:36:41.957

您的问题确实有两个不同的问题。

1) 如何编写 SQL 查询来获取页面所需的结果。

Mark 和 Leigh 对这个问题都有很好的解决方案。我个人更喜欢Leigh的。

我将在您进行时添加转储您的结果（这里的所有人可能都知道，但是为后代记录是一件好事），因为很容易假设您得到的结果与您想象的不同。

此外，它与下一步特别相关。

2) 如何正确显示结果。

为此，您必须了解 cfoutput 的“组”属性是如何工作的。它只是检查您选择的列的值是否与上一行相比发生了变化。这意味着您必须按组列排序，否则分组将看起来错误。

例如：

类别,产品

*   食品, 苹果
*   清洁工，彗星
*   食物，香蕉

如果您对上面的结果执行此操作，它看起来会出错，因为每次切换类别时都会显示分组输出。另一方面，以下结果集可以正常工作：

*   清洁工，彗星
*   食品, 苹果
*   食物，香蕉

这样做的结果是 cfoutput 组取决于排序，因此您只能在任何一个级别的一列上使用它（当然，您可以根据需要深入任意级别）。

因此，解决方案是更手动地处理第二列分组。例如，这可以通过在某处建立一个列表然后循环遍历它。

因此，对于您示例中的查询，这将起作用：

```
<tbody>
   <cfoutput query="variables.movieList" group="movieId">
       <cfset actors = "">
        <cfoutput>
            <cfif NOT ListFindNoCase(actors,actorId)>
                <cfset actors = ListAppend(actors,actorId)>
            </cfif>
        </cfoutput>
      <tr>
         <td><a href="##">#title#</a></td>
         <td><cfoutput group="name">#name# | </cfoutput></td>
         <td><cfloop list="actors" index="actor">#actor# | </cfloop></td>
      </tr>
   </cfoutput>
</tbody> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T15:19:33.897

您不能在同一个查询中同时使用演员和流派。最好的办法是只输出电影，`<cfoutput query="someQry" group="movieId">`然后进行查询以分别获取每部电影的演员和流派。

# asp.net-mvc - 无法隐式转换类型'System.Collections.Generic.List '到'int？

> ID：10126059
> 
> 赞同：0
> 
> 时间：2012-04-12T14:48:28.467
> 
> 标签：asp.net-mvc, asp.net-mvc-3

在 mvc3 应用程序中，我使用以下查询从数据库中填充下拉列表。在 Index.cshtml 上出现错误

```
public mydataEntities1 dbContext = new mydataEntities1();

        public List<SelectListItem> GetPricingSecurityID()
        {
        var pricingSecurityID = (from m in dbContext.Reporting_DailyNAV_Pricing
                                     select new SelectListItem
                                         {
                                                Text = m.PricingSecurityID.ToString(),
                                                Value = m.PricingSecurityID.ToString()
                                         });

        return pricingSecurityID.ToList();
        }

        public List<SelectListItem> GetCUSIP()
        {
            var cusipID = (from m in dbContext.StateStreet_DailyPosition_Second
                                     select new SelectListItem
                                     {
                                         Text = m.CUSIP.ToString(),
                                         Value = m.CUSIP.ToString()
                                     });

            return cusipID.ToList();
        }

Home.controller
public ActionResult Index()
        {
            SecurityIdentifierMapping objModel = new SecurityIdentifierMapping();
            objModel.PricingSecurityID = objRepository.GetPricingSecurityID();
            objModel.CUSIP = objRepository.GetCUSIP();
            return View(objModel);
        }

public partial class SecurityIdentifierMapping
    {
        public int Id { get; set; }

        [Required(ErrorMessage = "Please select a PricingSecurityID")]
        public Nullable<int> PricingSecurityID { get; set; }

        [Required(ErrorMessage = "Please select a CUSIPID")]
        public string CUSIP { get; set; }

        public string Calculation { get; set; }
    } 
```

也试过`AsEnumerable()`改变什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T14:51:36.820

如果没有看到 的定义，我无法确定`SecurityIdentiferMapping`，但我猜那`PricingSecurityID`是类型`int?`。您正在尝试设置`GetPricingSecurityID()`此属性的返回值，但该方法的返回值是`List<SelectItemList>`

更改您的`GetPricingSecurityID()`方法以返回一个`int?`或您的属性以接受一个`List<SelectItemList>`.

# ruby-on-rails - 如果时间更新大于 X

> ID：10126062
> 
> 赞同：1
> 
> 时间：2012-04-12T14:48:41.547
> 
> 标签：ruby-on-rails

我想我在这里有一个大脑冻结，但我无法找出最好的方法来做到这一点......提前感谢您的帮助。

我的位置表中有一些字段每 5 分钟由外部脚本更新一次。如果超过 1 小时未更新，则会向站点管理员发送一封电子邮件。

获取死区列表相当简单：

```
 scope :not_responding, lambda {
    where('last_heartbeat < ?', Time.now - 1.hour )
  } 
```

我坚持的应该很简单......我要做的就是改变位置名称的样式，如果它没有响应，它就会变成红色。

```
%td
  - @locations.each do |locations|    
    = if ('locations.last_heartbeat < ?', Time.now - 1.hour )  
      red
    -else
      green 
```

但这会引发错误（意外的'，'）

谁能建议如何将其移至我的模型中？

- 更新 -

我不确定这是一个错误还是什么，但我看到了一些奇怪的结果。

使用下面的答案，我添加了这个：

```
def not_responding?
    last_heartbeat < (Time.now - 1.hour)
  end 
```

并使用：

```
- if location.not_responding?
  red
- else
  green 
```

但是，这给了我一个关于“<”未定义的错误。

最后，我不得不这样做才能让它工作。一切似乎都很荒谬......

```
 def not_responding
   last_heartbeat <=> (Time.now - 1.hour)
 end 
```

在视图中：

```
- if (hotspot.not_responding_two == -1)
  red
- else
  green 
```

没有意义，因为以下测试没问题：

```
def test?
  Time.now > (Time.now - 1.hour)
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T15:23:30.900

可能最简单的方法是这样的：

```
class Location < ActiveRecord::Base
  def not_responding?
    last_heartbeat < (Time.now - 1.hour)
  end
end 
```

我打了一个问号，因为这是一个布尔方法。在您看来：

```
%td
  - @locations.each do |location|    
    -if location.not_responding?
      red
    -else
      green 
```

您需要在位置对象上调用一个方法，在这种情况下，您调用的是我们刚刚定义的方法，它将根据上次心跳的时间返回 true 或 false。

# internet-explorer - Watin 在我的 TFS 构建机器上不起作用

> ID：10126068
> 
> 赞同：0
> 
> 时间：2012-04-12T14:49:05.737
> 
> 标签：internet-explorer, tfs, watin, specflow

我一直试图让它工作一段时间，但我似乎无法让我的 Watin 测试在 TFS 上运行。他们似乎在我的开发帐户上工作。

我有一个 TFS 用户在我的解决方案中运行所有测试。所有测试通过，但 Watin 测试失败。

我收到以下错误：

```
WatiN.Core.Exceptions.RunScriptException: RunScript failed ---> System.UnauthorizedAccessException: Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED)) 
```

错误堆栈是：

```
mshtml.HTMLWindow2Class.IHTMLWindow2_execScript(String code, String language)
WatiN.Core.Native.InternetExplorer.IEUtils.RunScript(String scriptCode, String language, IHTMLWindow2 window)
WatiN.Core.Native.InternetExplorer.IEUtils.RunScript(String scriptCode, String language, IHTMLWindow2 window)
WatiN.Core.Native.InternetExplorer.IEElement.GetJavaScriptElementReference()
WatiN.Core.Native.InternetExplorer.IEFireEventHandler.CreateJavaScriptFireEventCode(NameValueCollection eventObjectProperties, String eventName)
WatiN.Core.Native.InternetExplorer.IEFireEventHandler.FireEvent(String eventName, NameValueCollection eventProperties, Boolean noWait)
WatiN.Core.Native.InternetExplorer.IEElement.FireEvent(String eventName, NameValueCollection eventProperties)
WatiN.Core.Element.FireEvent(String eventName, Boolean waitForComplete, NameValueCollection eventProperties)
WatiN.Core.Element.FireEvent(String eventName)
WatiN.Core.Element.Focus()
WatiN.Core.Actions.TypeTextAction.TypeAppendClearText(String value, Boolean append, Boolean clear)
WatiN.Core.Actions.TypeTextAction.TypeText(String value)
WatiN.Core.TextField.TypeText(String value) 
```

关于从哪里开始寻找的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:33:40.140

确保构建服务设置为作为交互式过程运行，更多信息在[这篇博](http://blogs.msdn.com/b/mathew_aniyan/archive/2009/05/26/coded-ui-test-in-a-team-build.aspx)文中。这是关于编码 UI 的，但它可能是相关的。

此外，请检查您的用户帐户是否有权运行交互式进程（您可以以它的身份登录），并且没有作为仅服务用户进行保护。

![TFS 构建](../Images/d41e3f72a11af826f10affd6e33006b0.png)

# mysql - 推动自定义标准

> ID：10126069
> 
> 赞同：1
> 
> 时间：2012-04-12T14:49:05.847
> 
> 标签：mysql, sql, propel

我正在尝试使用推进标准构建以下查询：

```
SELECT *
FROM mytable
WHERE facility_id IN (4,7)
GROUP BY housing_id
HAVING COUNT(DISTINCT facility_id) = 2; 
```

推进标准：

```
$criteria->add(HousingsHousingFacilitiesPeer::HOUSING_FACILITY_ID, $facility_filter, Criteria::IN);

$criteria->addGroupByColumn(HousingsHousingFacilitiesPeer::HOUSING_ID);

$criteria->addHaving(
  $criteria->getNewCriterion(
    HousingsHousingFacilitiesPeer::HOUSING_ID, 
    'COUNT(DISTINCT housings_housing_facilities.HOUSING_FACILITY_ID) = 2',
    Criteria::CUSTOM
  )
); 
```

但查询确实返回任何结果。

我是否正确使用了自定义标准？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T14:59:34.583

乍一看，你`count distinct`似乎错了：

```
'COUNT(DISTINCT HousingsHousingFacilitiesPeer::HOUSING_FACILITY_ID) = 2' 
```

如果它只是一个糟糕的 c/p，关于[这个片段](http://snippets.symfony-project.org/snippet/257)，你可能会这样做：

```
$c = new Criteria();
$c->add(HousingsHousingFacilitiesPeer::HOUSING_FACILITY_ID, $facility_filter, Criteria::IN);
$c->addGroupByColumn(HousingsHousingFacilitiesPeer::HOUSING_ID);
$c->addAsColumn('numFacilities', 'COUNT(DISTINCT '.HousingsHousingFacilitiesPeer::HOUSING_FACILITY_ID.')');
$c->addHaving($c->getNewCriterion(HousingsHousingFacilitiesPeer::ID, 'numArticles=2', Criteria::CUSTOM)); 
```

# java - 为什么需要编写获取自定义类对象的类型变量？

> ID：10126071
> 
> 赞同：0
> 
> 时间：2012-04-12T14:49:17.507
> 
> 标签：java

我不明白为什么会这样

例如：

```
class Test
{
   public void someMethod()
   {

   }

} 
```

进而

```
Test test = new Test(); 
```

为什么需要写变量的类型，所以如果你看到变量分配了那个自定义类，我认为这是一些溢出写作）。

ps：这是java，我是新手，如果问题很愚蠢，很抱歉，但我现在不明白

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T14:51:58.420

您正在声明变量（引用）的类型，与对象的类型不同。

例如，您的变量类型可以是`Test`，也可以是超类型 ( `Object`) 或`Test`实现的接口。你选择哪一个取决于你的客户应该如何引用初始化的对象。例如，他们是否应该知道它是一种特定类型，或者他们只知道它将实现给定接口或功能子集是否足够（或可取）。

一个更好的例子是：

```
Animal animal = new Dog(); 
```

您的客户端代码只知道它正在处理动物。即它可以（说）调用一个方法`.eat()`，但它不会知道 a 的`Dog`吃法与 a 不同`Fish`。

请注意，某些语言（例如 Scala）会执行*类型推断*。也就是说，您不必声明变量类型，而是编译器将根据您对变量的后续使用来确定它应该是什么类型。结果代码仍然是静态类型的，但编译器会为您做更多的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T14:54:19.650

问题是声明变量和创建变量实例之一。第一个`Test`声明变量。您可以通过以下方式在不创建实例的情况下执行此操作：

```
Test test; 
```

第二个`Test`调用`new Test()`变量的构造函数。在这种情况下，由于您没有创建构造函数，因此您使用的是默认`Object`构造函数。这可以使用先前定义的变量来完成，如下所示：

```
Test test;
test = new Test(); 
```

Also you can have multiple constructors that take different parameters and then you have to specify which you want to use.

```
public class Test {

    public Test(int i) {
    }

    public Test() {
    }
} 
```

Then you can do

```
Test test = new Test();
Test test2 = new Test(2); 
```

# javascript - 如何通过 JavaScript 查找远程服务器目录是否存在

> ID：10126073
> 
> 赞同：1
> 
> 时间：2012-04-12T14:49:28.827
> 
> 标签：javascript, ant

我在我的 Ant 脚本中使用 javascript 将运行时网络远程文件夹值作为输入传递。传递该值后，我发现输入文件夹路径是否存在。但我无法做到这一点。我的代码如下。

```
 <script language="javascript">
    <![CDATA[
        importPackage(javax.io);
        importPackage(javax.swing);
        importPackage(java.lang);
        var deployment_machine = project.getProperty("var2");
        var deployment_machine = deployment_machine.substring(2,deployment_machine.indexOf("$")-2);
        var optionPane = JOptionPane.showInputDialog( 'Deployment location for GatewayFW in ' + deployment_machine + '?', null );
        var path = require('optionPane');
        if (path.existsSync("/the/path")) {
                // ...
            }

        if(!fso.FolderExists(optionPane))
        {
        var optionPane = JOptionPane.showInputDialog( 'Deployment location for GatewayFW in ?', deployment_machine );
        }
        else
        {
        project.setProperty('deploy_loc',optionPane);
        }           
    ]]>
    </script>
</then>
<else>
    <echo message="File need to check:- ${patch.path}/${patch.name}/GatewayFW_patch.zip is not exist"/>
</else> 
```

`

任何人都可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T10:57:12.257

`<script language="javascript"> <![CDATA[ importPackage(java.io); importPackage(javax.swing); importPackage(java.lang); var deployment_machine = project.getProperty("var2"); var deployment_machine = deployment_machine.substring(2,deployment_machine.indexOf("$")-2);
do { var optionPane = JOptionPane.showInputDialog( 'Deployment location for GatewayFW in ' + deployment_machine + '?', null );
var dir = new File(optionPane); } while(!dir.exists()); project.setProperty('deploy_loc',optionPane); ]]> </script>` 在这里，我们必须将 File("folder path") 分配给一个 javascript 变量，如上面 var=dir =new File("folder path"); 然后我们可以对路径执行任何操作。

# ruby-on-rails - Ruby on Rails - 使用 REST 后端的 Facebook 身份验证

> ID：10126076
> 
> 赞同：1
> 
> 时间：2012-04-12T14:49:39.543
> 
> 标签：ruby-on-rails, authentication, rest, architecture

我正在构建一个 javascript 前端和一个 Rails REST API 后端。用户只能使用 Facebook 登录。像这样的东西最好的架构是什么？我是 Rails 和 REST 新手，但到目前为止我的想法是：

1.  使用 FB javascript 库登录客户端
2.  向 /users/current 发送请求。在请求中包含 FB 令牌。（这个网址安静吗？）
3.  在服务器上
    *   如果令牌有效，则获取用户信息并将 JSON 传回（id、pic、name 等）
    *   如果令牌无效，则回传错误

有人可以指出我正确的方向吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:00:13.733

没错，我实际上正在使用相同的概念开发一个应用程序，但通过 Google 登录。

如果您计划合并联合登录，您正在寻找的是用于 Facebook 或 OpenID 的 OAuth 2.0。

所以，是的，基本上你说的都是对的。您从客户端获取授权令牌，向服务器发送请求，您应该有一个身份验证方法，该方法通过使用该令牌向 facebook 发送用户信息的 GET 请求来检查令牌的有效性。收到响应后，您应该返回 JSON 格式的信息或返回错误，具体取决于您从 GET 请求返回的数据。

[脸书 OAuth 2.0](https://developers.facebook.com/docs/authentication/)

那应该为您指明正确的方向。希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T04:26:59.120

@Leo 为您提供了一种方法。

另一种方法是使用设计。

1.  将设计配置为可令牌验证。
    这里的步骤：http: [//matteomelani.wordpress.com/2011/10/17/authentication-for-mobile-devices/](http://matteomelani.wordpress.com/2011/10/17/authentication-for-mobile-devices/)

2.  在 initializers/devise.rb 中设置`config.skip_session_storage = [:token_auth]`，以便不存储会话，并且每次都必须发送令牌 ID

3.  定义如下函数。此函数验证您发送的 FB 访问令牌是否正确以及它是否对应于 FB id。我们必须在调用 valid_password 的地方使用这个函数，因为我们的数据库中没有用户创建的密码。但我们必须通过 Facebook 对其进行验证。

    ```
    def self.valid_password_custom?(password, fbid)
      uri = URI.parse("https://graph.facebook.com/me")
      fb_params = {"access_token"=>password}
      http = Net::HTTP.new(uri.host, uri.port)
      http.use_ssl = true
      request = Net::HTTP::Get.new(uri.path)
      request.set_form_data( fb_params )
      request = Net::HTTP::Get.new( uri.path + "?" + request.body )
      response = http.request(request)
      json_response = JSON.parse(response.body)

      if json_response["id"] == fbid
        logger.debug("FB Access token is valid for the user")
        return true
      else
        logger.debug("FB Access token is not valid for the user. ID for access token is '#{fbid}'")
        return false
      end
    end 
    ```

4.  一旦设置了上述步骤，您将从设计中获得一个令牌。您可以使用它与 API 进行通信

# java - ImageView 作为系统覆盖 - 旋转设备时位置错误

> ID：10126078
> 
> 赞同：0
> 
> 时间：2012-04-12T14:49:44.333
> 
> 标签：java, android, imageview, android-service, android-imageview

我目前正在尝试为运行 Android 2.3.4 的特殊设备编写一个应用程序，它将系统覆盖放在屏幕上精确定义的位置。这就是我使用绝对值定位图层的原因。

我编写了一个活动（包括布局中的两个按钮），用于启动和停止显示此覆盖的服务。

```
public class MyActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
}

public void showOverlay(View view) {
    Intent i = new Intent("myPackage.myService");
    startService(i);
}

public void hideOverlay(View view) {
    Intent i = new Intent("myPackage.myService");
    stopService(i);
}
} 
```

这是我的服务（也被添加到清单文件中）。

```
public class MyService extends Service {    
ImageView iv;

@Override
    public IBinder onBind(Intent intent) {
    return null;
}

@Override
public void onCreate() {
    super.onCreate();

    int imageRes    =   0;

    final WindowManager.LayoutParams params = new WindowManager.LayoutParams(
            WindowManager.LayoutParams.TYPE_SYSTEM_OVERLAY,
            WindowManager.LayoutParams.FLAG_WATCH_OUTSIDE_TOUCH | WindowManager.LayoutParams.FLAG_LAYOUT_IN_SCREEN,
            PixelFormat.TRANSLUCENT);

    params.gravity  =   Gravity.NO_GRAVITY;
    params.alpha    =   1; 

    switch (findRotation()) {
    case Surface.ROTATION_0:
        params.height = 12; params.width = 600; params.x = 0; params.y = 1012;
        imageRes = R.drawable.horizontal; 
        break;
    case Surface.ROTATION_180: 
        params.height = 12; params.width = 600; params.x = 0; params.y = 0;
        imageRes = R.drawable.horizontal; 
        break;
    case Surface.ROTATION_90: 
        params.height = 600; params.width = 12; params.x = 1012; params.y = 0;
        imageRes = R.drawable.vertical; 
        break;
    case Surface.ROTATION_270: 
        params.height = 600; params.width = 12; params.x = 0; params.y = 0;
        imageRes = R.drawable.vertical; 
        break;
    }

    final WindowManager wm = (WindowManager) getSystemService(WINDOW_SERVICE);        

    iv = new ImageView(getApplicationContext());
    iv.setClickable(false);
    iv.setImageResource(imageRes);
    iv.draw(new android.graphics.Canvas());
    wm.addView(iv, params);
}

private int findRotation() {
     Display display = ((WindowManager) getSystemService(WINDOW_SERVICE)).getDefaultDisplay();
     return display.getRotation();
}

@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);
    onDestroy();    //I don't know how to to make the service reposition the layer, so I used this. Not nice but it works 
    onCreate();   
}

@Override
public void onDestroy() {
    super.onDestroy();
    if(iv != null) {
        ((WindowManager) getSystemService(WINDOW_SERVICE)).removeView(iv);
        iv = null;
    }
}
} 
```

要显示为叠加层的图像具有我设备纵向屏幕分辨率的宽度（或高度，我没有找到在 API 级别 10 上旋转可绘制对象的方法，因此我使用了两张图像，一张用于水平显示，一张用于垂直显示）模式 (=600) 和 12 像素的高度（或宽度）。我希望它位于硬件按钮所在的位置，即底部为纵向模式，右侧逆时针旋转 90° 时，顶部旋转 180° 时等等。

这适用于 0° 和 90° (ccw) 的旋转，但对于其他两个方向，图像显示在屏幕中间而不是顶部或左侧。我究竟做错了什么？

编辑 2012-04-19：我已将 ROTATION_180 的 params.y 的值更改为 -1012，这种情况现在有效。不过，我认为这不是预期的行为。ROTATION_270 的类似更改不起作用...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T16:06:42.587

我认为当您的设备旋转 180° 时，它认为它处于纵向模式，因此旋转 0°。所以尝试对 0 和 180 以及 90 和 270 使用相同的参数。我不确定，也许我错了；）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T08:17:03.900

好的，对不起，我在编写编辑时更改 ROTATION_270 的参数时犯了一个错误。

我得到了代码来做我想做的事，这就是我所做的：

我将 180° 的 y 参数更改为 -1012，并将 270° 的 x 参数更改为 -1012。现在，在所有四个方向上，图像都显示在硬件按钮所在的位置。

为了完整起见，我把它写在这里。

(...)

```
switch (findRotation()) {
    case Surface.ROTATION_0:
        params.height = 12; params.width = 600; params.x = 0; params.y = 1012;
        imageRes = R.drawable.horizontal; 
        break;
    case Surface.ROTATION_180: 
        params.height = 12; params.width = 600; params.x = 0; params.y = -1012;
        imageRes = R.drawable.horizontal; 
        break;
    case Surface.ROTATION_90: 
        params.height = 600; params.width = 12; params.x = 1012; params.y = 0;
        imageRes = R.drawable.vertical; 
        break;
    case Surface.ROTATION_270: 
        params.height = 600; params.width = 12; params.x = -1012; params.y = 0;
        imageRes = R.drawable.vertical; 
        break;
} 
```

(...)

# jquery - 将绝对 div 动画到固定 div

> ID：10126083
> 
> 赞同：1
> 
> 时间：2012-04-12T14:50:08.567
> 
> 标签：jquery, html, css, positioning

在我的网站上，我有一个在父 div 中有绝对位置的 div。我想要的是当我单击 div 时，它必须放大并定位在浏览器的中间。

我尝试的是这样的：

```
$j("#mac").click(function(){
 $j('#mac').css({
        position: 'fixed'
    });

$j('#mac').animate({
    width: 923,
    height: 498,
    left: ($j(window).innerWidth() - 923)/2,
    top: ($j(window).innerHeight() - 498)/2
  }, 1000)}); 
```

它起作用了，但发生的事情是#mac 首先定位到我屏幕的左上角，然后动画到我的屏幕中心。这是有道理的，因为使用了固定位置。但是当我不使用那个位置时，div 不会位于中心位置。

所以我不想在屏幕的左上角定位，但 div 必须从他的原始位置动画到屏幕的中心。

有人知道怎么做吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T14:57:04.250

当您将 CSS 位置更改为固定时，同时找到 DIV 的当前顶部和左侧位置并设置它们。那应该在正确的位置开始动画。

```
var offset = $j('#mac').offset();

$j('#mac').css({
    position: 'fixed',
    top: offset.top,
    left: offset.left
}); 
```

# symfony - 在编辑配置文件中删除密码检查

> ID：10126085
> 
> 赞同：3
> 
> 时间：2012-04-12T14:50:11.233
> 
> 标签：symfony, fosuserbundle

对于 sf 应用程序，我想从 FOSUserBundle 中的编辑配置文件表单中删除密码检查。

仅通过覆盖配置文件表单来删除“当前”字段仍会导致“密码无效”验证消息。这是由 FOSUSerBundle 中的 ProfileFormHandler 类通过以下代码引起的：

```
 $this->form->setData(new CheckPassword($user)); 
```

所以我也覆盖了表单处理程序并将上面的代码替换为

```
 $this->form->setData($user); 
```

到目前为止，这可行，我的表单类型已显示，我的表单处理程序处理表单，但我收到以下错误

```
The CSRF token is invalid. Please try to resubmit the form 
```

实际上，csrf 令牌不再添加到表单中。坦率地说，我不知道我做错了什么；（

谢谢，本

这是表单、处理程序和模板的完整代码：

```
<?php

namespace Application\Sonata\UserBundle\Form\Type;

use Symfony\Component\Form\FormBuilder;

class ProfileFormType extends \FOS\UserBundle\Form\Type\ProfileFormType
{

    private $class;

    /**
     * @param string $class The User class name
     */
    public function __construct($class)
    {
        $this->class = $class;
    }

    public function buildForm(FormBuilder $builder, array $options)
    {
       $builder
           ->add('first_name')
            ->add('last_name')
            ->add('phone')
            ->add('location','room13_geo_location')
            ->add('birthday','birthday')
            ->add('smoker')
            ->add('newsletter')
        ;

    }

    public function getName()
    {
        return 'balkanride_user_profile';
    }

    public function getDefaultOptions(array $options)
    {
        return array(
            'data_class' => $this->class,
            'intention'  => 'profile',
        );
    }
} 
```

-

```
<?php

namespace Application\Sonata\UserBundle\Form\Handler;

use Symfony\Component\Form\Form;
use Symfony\Component\HttpFoundation\Request;

use FOS\UserBundle\Model\UserInterface;
use FOS\UserBundle\Model\UserManagerInterface;
use FOS\UserBundle\Form\Model\CheckPassword;

class ProfileFormHandler
{
    protected $request;
    protected $userManager;
    protected $form;

    public function __construct(Form $form, Request $request, UserManagerInterface $userManager)
    {
        $this->form = $form;
        $this->request = $request;
        $this->userManager = $userManager;
    }

    public function process(UserInterface $user)
    {

        $this->form->setData($user);

        if ('POST' === $this->request->getMethod())
        {
            $this->form->bindRequest($this->request);

            //var_dump($this->form->getErrors());
            //die();

            if ($this->form->isValid())
            {

                $this->onSuccess($user);

                return true;
            }

            // Reloads the user to reset its username. This is needed when the
            // username or password have been changed to avoid issues with the
            // security layer.
            $this->userManager->reloadUser($user);
        }

        return false;
    }

    protected function onSuccess(UserInterface $user)
    {
        $this->userManager->updateUser($user);
    }
} 
```

-

```
{% extends "ApplicationSonataUserBundle::layout.html.twig" %}

{% block page_body %}

<section>

    <form id="ProfileForm" action="{{ path('fos_user_profile_edit') }}" {{ form_enctype(form) }} method="POST" class="fos_user_profile_edit">
        {{ form_widget(form) }}
        <div>

            <div class="form-actions">
                <input type="submit" value="{{ 'profile.edit.submit'|trans }}" class="btn btn-primary" />
                <a href="{{path('fos_user_profile_show')}}" class="btn">{{ 'profile.edit.cancel'|trans }}</a>
            </div>

        </div>

    </form>

</section>

{% endblock page_body %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-26T22:22:23.317

解决此问题的建议方法是创建一个单独的表单来编辑不需要密码保护的字段，然后才能对其进行编辑。最简单且无需 hack :)

# c++ - 用地图库插入不起作用

> ID：10126087
> 
> 赞同：0
> 
> 时间：2012-04-12T14:50:19.907
> 
> 标签：c++, map, insert

我有以下程序并在插入地图时出现问题：

```
 static std::map<std::string,void *> name_data_map;
      std::map<std::string,void *>::iterator iter=name_data_map.find(name) ;

    if(  iter == name_data_map.end() )
    {
            tmp_data = (void *) malloc ( mt_get_dkstat_size() );
            errorCode = getsproxy(tmp_data , name );
            name_data_map.insert(pair<std::string,void *>(name,tmp_data) );

    }

   memcpy(*data, iter->second,  mt_get_dkstat_size() ) ; 
```

插入后，`tmp_data`正在损坏。而且我想了解这两种插入有什么区别：

```
name_data_map.insert(pair<std::string,void *>(name,tmp_data) );
name_data_map.insert(make_pair(name,tmp_data) ); 
```

感谢您的高级回复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T14:54:18.907

`iter`如果它还不存在，它仍然会指向`end()`你的。`map`

尝试这个：

```
static std::map<std::string,void *> name_data_map;
std::map<std::string,void *>::iterator iter=name_data_map.find(name) ;

if (iter == name_data_map.end())
{
        tmp_data = (void *)malloc(mt_get_dkstat_size());
        errorCode = getsproxy(tmp_data, name);
        // Fix:
        std::pair<std::map<std::string,void>::iterator,bool> ret;
        ret = name_data_map.insert(pair<std::string,void *>(name,tmp_data));
        iter = ret.first;
}

memcpy(*data, iter->second, mt_get_dkstat_size()); 
```

编辑：要回答您关于这两种方法之间差异的问题，它们与`make_pair`实现为基本相同：

```
template <class T1,class T2>
  pair<T1,T2> make_pair (T1 x, T2 y)
  {
    return ( pair<T1,T2>(x,y) );
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:07:27.610

试试这个：

```
void *tmp_data;
if(  iter == name_data_map.end() ) {
        tmp_data = (void *) malloc ( mt_get_dkstat_size() );
        errorCode = getsproxy(tmp_data , name );
        name_data_map[name] = tmp_data;
} else {
    tmp_data = iter->second;
}

memcpy(*data, tmp_data,  mt_get_dkstat_size() ) ; 
```

您的原始代码的问题是您取消引用`iter`，即使它等于`.end()`.

* * *

或者，如果您更喜欢使用`insert`而不是`operator[]`，请尝试以下操作：

```
auto pair = name_data_map.insert(std::make_pair(name, (void*)0));
if(pair.second) {
    pair.first->second = (void*)malloc( mt_get_dkstat_size() );
    errorCode = getxproxy(tmp_data, name);
}

memcpy(*data, pair.first->second,  mt_get_dkstat_size() ) ; 
```

这会将`.find()`and`.insert()`合并到一个操作中，每次插入为您节省一个 log(N) 搜索。

# algorithm - 如何计算一段代码的每一行的运行时间

> ID：10126091
> 
> 赞同：1
> 
> 时间：2012-04-12T14:50:44.230
> 
> 标签：algorithm, big-o, time-complexity

我对大 O 表示法有点熟悉，但是我遇到了一个我不太明白的大 O 表示法的解释。

```
int foo(int n) {
  int p = 1;        -------------->c1        x 1
  int i = 1;         ------------->c1        x 1
  while (i < n) {     ------------>c2        x n
    int j = 1; ------------------->c1        x (n - 1)
       while (j < i) { ----------->c2        x ((1/2)n^2 - (3/2)n + 2)
         p = p * j; -------------->(c1 + c3) x ((1/2)n^2 - (3/2)n + 1)
         j = j + 1; -------------->(c1 + c4) x ((1/2)n^2 - (3/2)n + 1)
      }
    i = i + 1; ------------------->(c1 + c4) x (n - 1)
  }
  return p; ---------------------->c5        x 1        
} 
```

(c1 + 1/2*c2 + 1/2*c3 + 1/2*c4)n^2 + (-c1 - 1/2*c2 - 3/2*c3 - 1/2*c4)n + ( 2*c1 + 2*c2 + c3 + c5)

我知道由于嵌套循环以及结果方程中常数和低阶项的减少，该算法将变成 n^2。但是，我不明白“x”的 rhs 是如何得出的，例如 ((1/2)n^2 - (3/2)n + 1)。对此的任何见解将不胜感激，我真的需要了解大 O 表示法的核心概念。谢谢。

[在这里查看动画解释](http://www.csanimated.com/animation.php?t=Big_O_notation)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:04:53.347

外循环执行`n-1`次数：

```
sum(1, i=1;n-1) = n-1. 
```

内部循环`i-1`为 each 执行次数`i`，总共：

```
sum(i-1, i=1;n-1)
= sum(i, i=1;n-1) - sum(1, i=1;n-1)
= (n-1)*((n-1)+1)/2 - (n-1)
= (n-1)*n/2 - n+1
= (1/2)n^2-(3/2)n+1 
```

使用著名的欧拉公式计算从 1 到 的数字之和`n`：`sum(i, i=1;n) = n*(n+1)/2`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:10:34.750

有 n-1 次循环 while(i < n)

内循环将执行 0, 1, 2, 3,..n-2 次 - 这是算术级数，其和为 (n-2)(n-1)/2 = (1/2) n^2 - (3/2) n + 1

# ruby - 为时间线绘图目的收集 ActiveRecord 日期属性的最佳方法

> ID：10126092
> 
> 赞同：1
> 
> 时间：2012-04-12T14:50:47.180
> 
> 标签：ruby, ruby-on-rails-3

我有点迷失了这个。我可以建立一堆计数查询来查找在给定时间段内具有最后登录日期的所有记录，例如计算过去一周每天有多少条记录（7 个计数查询，每天一个），但我有兴趣知道是否有一种漂亮、更高效的 Ruby/Rails 方法来做到这一点。

我真的没有任何示例代码要发布。也许这样的事情会有所帮助：

```
hour_range = 7 * 24 # 7 days worth of hours
start_date = Time.now.to_time - day_range
end_range = Time.now
start_date.to_date.upto(end_range.to_date) do |day|
    # Series of count queries which populate an array of counts for each day...
end 
```

我正在使用 Highcharts（或尝试一下）在客户端绘制图表。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:03:44.277

如果您提前计划，您可以在表中创建可索引的衍生列。这使得将结果组合在一起非常简单。

例如，如果您想按天分组，请创建一个日期列。如果您想按周分组，您可以使用一些可用的日期函数来执行此操作，生成类似于`201204`2012 年第 4 周的值。月份更容易，因为它只是`%Y%M`格式化的日期。

其中大部分可以作为使用本机 SQL 日期格式化函数的现有数据的单独迁移或作为一系列`before_save`挂钩来填充。

使报告高效且响应迅速的方法是执行尽可能少的查询，并使这些查询尽可能易于数据库计算。加载数百条记录或进行数十次查询不会扩展。

# java - 按优先级排序任务

> ID：10126095
> 
> 赞同：0
> 
> 时间：2012-04-12T14:50:53.583
> 
> 标签：java, swing, sorting, jlist

如何在 JList 中按优先级排序？
例如，我有几个任务，例如“洗涤、烹饪、洗衣”，我希望能够使用鼠标 (GUI) 对它们进行排序，最重要的在顶部。
到目前为止，这是我的代码：

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;

public class Test extends JFrame implements ActionListener {

    JPanel pLeft = new JPanel();
    JPanel pRight = new JPanel();
    String data[] = {
        "Item 1",
        "Item 2",
        "Item 3",
        "Item 4",
        "Item 5"
    };
    DefaultListModel model = new DefaultListModel();
    JList list = new JList(model);
    JScrollPane listScroller = new JScrollPane(list);
    JButton bUp = new JButton("UP");
    JButton bDown = new JButton("DOWN");

    public Test() {
        this.setDefaultCloseOperation(EXIT_ON_CLOSE);
        this.setBounds(300, 100, 300, 200);
        this.setVisible(true);
        this.setLayout(new BorderLayout());
        pRight.setLayout(new BorderLayout());

        this.add(pLeft, BorderLayout.WEST);
        this.add(pRight, BorderLayout.EAST);

        listScroller.setPreferredSize(new Dimension(150, 150));
        pLeft.add(listScroller);

        pRight.add(bUp, BorderLayout.NORTH);
        pRight.add(bDown, BorderLayout.SOUTH);

        bUp.addActionListener(this);
        bDown.addActionListener(this);

        for (int i = 0; i < data.length; i++) {
            model.add(i, data[i]);
        }
    }

    @Override
    public void actionPerformed(ActionEvent ae) {
        Object source = ae.getSource();
        if (source == bUp) {
            model.setElementAt(model.getElementAt(list.getSelectedIndex()), list.getSelectedIndex() + 1);
        }
        if (source == bDown) {
            model.setElementAt(model.getElementAt(list.getSelectedIndex()), list.getSelectedIndex() - 1);
        }

    }

    public static void main(String[] args) {
        Test test = new Test();
    }
} 
```

但不是只是“改变”它的位置，旧项目只是被新项目替换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T14:59:58.937

使用[`JList`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JList.html). 有关更多详细信息，请参阅[如何使用列表](http://docs.oracle.com/javase/tutorial/uiswing/components/list.html)。

Drag'n'Drop包是查找重新排序列表功能的地方[。](http://docs.oracle.com/javase/7/docs/api/java/awt/dnd/package-summary.html)有关如何使用 D'n'D API 的信息，请参阅Java 教程的[拖放和数据传输课程。](http://docs.oracle.com/javase/tutorial/uiswing/dnd/index.html)

# asp.net - MVC 3 不路由某些 URL

> ID：10126096
> 
> 赞同：1
> 
> 时间：2012-04-12T14:50:55.933
> 
> 标签：asp.net, asp.net-mvc-3, iis-7.5, asp.net-routing

我正在开发一个定义了一些自定义路由的 MVC 3。所有路由都在本地运行良好（使用 IIS Express 和 Cassini），但是当我将站点推送到我的生产服务器时，其中一个路由炸弹会出现 404。

本地设置：Windows 7 VS 2010 SP1 IIS Express

生产设置：Windows Server 2008 Datacenter IIS 7.5

正在轰炸的路线：

```
routes.MapRoute(
      "ShortLinks",
      "E-{id}",
      new { Controller = "Public", Action = "ResolveShortLink" },
      new[] { "namespace.WebUI.Controllers" }
    );

  routes.MapRoute(
      "SmsShortLinks",
      "T-{id}",
      new { Controller = "Public", Action = "ResolveShortLink" },
      new[] { "namespace.WebUI.Controllers" }
    ); 
```

示例请求如下所示。

[http://domain/E-7d9cbaa2-25b0-47be-8b2c-31844a3de482](http://domain/E-7d9cbaa2-25b0-47be-8b2c-31844a3de482) http://domain/T-7d9cbaa2-25b0-47be-8b2c-31844a3de482

同样，当我在本地运行此路由时，路由工作正常，但是当我将其推送到生产服务器时，它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:02:36.680

你有没有看过它实际上要去哪条路线？我建议阅读此 [http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx) 或使用 Glimpse 查看实际正在解决的路由，这可能有助于阐明问题... [http://getglimpse.com/](http://getglimpse.com/)

# sql-server - 当 SQL Server BIDS 安装在远程计算机上而不是本地时，如何通过 Excel 宏执行 SSIS 包？

> ID：10126098
> 
> 赞同：1
> 
> 时间：2012-04-12T14:51:06.913
> 
> 标签：sql-server, excel, ssis, vba

当我的 PC 上没有安装 SQL Server BIDS（商业智能开发工作室）应用程序并且我想使用将启动 BIDS 实例的 Excel 宏运行/执行一个 .dtsx 包文件时，我有一个典型案例CITRIX 服务器（远程机器）并使用包配置文件（XML 配置文件）来执行它。

我的 PC 上没有安装 SQL Server，我可以从中创建 SQL 代理作业并以编程方式安排程序包执行或使用命令行语句从 DOS 提示符执行程序包。

请帮助我，因为我需要尽快找到解决方案。谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:23:40.110

假设服务器不是*那么*遥远以至于您根本无法与之交谈，通常的方法是设置一个代理作业来运行包，然后找到一种方法来触发该作业。在[这篇 Microsoft 文章](http://msdn.microsoft.com/en-us/library/ms403355.aspx#Y386)中对此进行了很好的讨论。

最直接的方法需要打开与服务器的数据库连接并运行 sp_start_job （这意味着您需要允许这样做的凭据），如文章中所述 - 但显然还有多种其他方法可以启动作业。

# c# - 清除 Internet 临时文件中的 *.kml 文件

> ID：10126102
> 
> 赞同：0
> 
> 时间：2012-04-12T14:51:22.600
> 
> 标签：c#

我想清除 Internet 临时文件中的所有 kml 文件。我尝试了递归目录搜索，但没有找到任何 kml 文件，尽管使用 windows 资源管理器浏览时可以看到 kml 文件。在“Internet 临时文件”的实际目录中，例如 Content.IE5，这些 kml 文件存在 *.xml 对应文件。我也删除了它们，但 Windows 资源管理器仍然显示 kml 文件。我也尝试了一些 WinApi 方法，但我无法编写我想要的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T14:59:41.220

据我所知，Internet 临时文件的处理方式与回收站文件类似，即有一个包含元数据（如文件名）的索引文件和包含实际内容的文件。您可能可以[`GetUrlCacheEntryInfo()`](http://msdn.microsoft.com/en-us/library/aa384185%28VS.85%29.aspx)用来获取文件信息，但我认为没有任何特定/简单的方法可以清除除特定子集之外的所有文件（不会像您通过简单地删除文件而不更新元数据来破坏缓存文件那样）或遍历缓存中的所有文件）。

编辑：我误解了你（我想；你只是想删除一组特定的文件；而不是其他所有文件）。如果您只想删除所有 *.kml 文件，您可以这样做：

*   `FindFirstUrlCacheEntry`使用`FindNextUrlCacheEntry)查找缓存条目。
*   用于`DeleteUrlCacheEntry`删除您找到的条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:03:20.500

你试过`Environment.SpecialFolder.InternetCache`路径

```
 string tempPath = Environment.GetFolderPath(Environment.SpecialFolder.InternetCache);

        System.IO.DirectoryInfo tempDir = new DirectoryInfo(tempPath );
        foreach (FileInfo file in tempDir.GetFiles("*.kml"))
        {
            file.Delete();
        } 
```

您还应该更新代码以删除子目录中的文件。

希望它会有所帮助。

# ruby-on-rails - 避免 ActiveResource 的键符号化

> ID：10126104
> 
> 赞同：5
> 
> 时间：2012-04-12T14:51:27.897
> 
> 标签：ruby-on-rails, hash, activeresource

我正在使用名为“Setting”的 ActiveResource 模型连接到外部 Web 服务，该服务提供一些响应，如下例所示：

```
{"setting" => {"id" => 10, :details => {"10a" => 7, "10b" => 8}}} 
```

问题是，ActiveResource 尝试对`details`哈希中的所有键进行符号化，但这是不可能的，并且会引发`NameError: wrong constant name 10a`. 是否有机会禁止符号化，甚至避免转换为`details`单独的对象？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T01:09:16.690

您是否尝试过手动设置架构？我不知道你是否可以设置这样的嵌套属性。

```
class Setting < ActiveResource::Base
   schema = {'setting' => {'id' => :integer, :details => {'10a' => :integer, '10b' => :integer}}}
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-03T20:53:22.037

我假设单独的对象是 HashWithIndifferentAccess？您可以在使用之前尝试调用`#deep_stringify_keys`详细信息哈希吗？

# c# - 动态 GridView 和浮动格式

> ID：10126106
> 
> 赞同：0
> 
> 时间：2012-04-12T14:51:33.173
> 
> 标签：c#, asp.net, entity-framework, gridview

我从代码创建一个 GridView 并将其绑定到如下数据：

```
GridView myGridView1 = new GridView();
myGridView1.DataSource = db.T_Values.Select(x => new 
    {
        x.TimeStamp, 
        x.Value, 
        x.Type
    }).OrderBy(x => x.TimeStamp).ToList();
myGridView1.DataBind(); 
```

如果该值类似于 0,00000000123123，则 GridView 会舍入此数字。是否有可能避免这种情况并显示完整的数字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T14:58:45.373

您必须订阅 gridview 事件 OnRowDataBound。在这种情况下，您将该值设为字符串并将其分配给某个列，而不是在问题未解决时自动生成列

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:44:31.587

M.Babcock 提供帮助，首先执行 ToList() 然后 Value = x.Value.toString("0,0000000000")

# java - 未检测到 aws-sdk 库 netbeans

> ID：10126110
> 
> 赞同：0
> 
> 时间：2012-04-12T14:51:45.310
> 
> 标签：java, netbeans-7, amazon-dynamodb

我正在使用 Netbeans 编写 Java 应用程序。该数据库托管在 DynamoDB (Amazon Web Services) 中。我已经从亚马逊网站下载了 .jar 文件 (aws-java-sdk-1.3.6.jar) 并尝试将其添加到我的项目中。但是，它不起作用。我按照通常的步骤将 .jar 添加到项目中（工具 -> 库 -> 新库 -> 添加 JAR/文件夹）。但是，它似乎不起作用。无法识别我需要对数据库的访问进行编码的导入。我收到错误“com.amazonaws 包不存在”。

我在该方法之后添加了其他库（例如 Xerces）并毫无问题地使用它们。但是，我无法使那一项工作。

任何帮助或建议将不胜感激！！

谢谢！

劳拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T08:23:34.757

如果您仅限于 Netbeans，请尝试按照此处采取的步骤进行响应：[AWS SDK on Netbeans](https://forums.aws.amazon.com/thread.jspa?messageID=337489)

另一种选择是切换到 Eclipse 并使用适用于 AWS 的 Eclipse 工具包：[AWS Toolkit for Eclipse](http://aws.amazon.com/eclipse/)

# python - 在没有安装 python 的情况下将 virtualenv 目录复制到 Windows 后运行 python

> ID：10126111
> 
> 赞同：0
> 
> 时间：2012-04-12T14:51:45.953
> 
> 标签：python, windows, virtualenv

我在 Windows 机器上创建了一个 virtualenv 目录，并将其复制到未安装 python 的原始 Windows 机器上的相同绝对路径中。在第一次通过时，python.exe 在原始机器上失败，因为它找不到 python27.dll。然后我回到第一台机器并将 python27.dll 从 C:\Windows\System32 复制到 virtualenv \Scrips 文件夹中，并重复该过程。python.exe 然后在原始机器上失败并出现以下错误：ImportError: no module named functools.

此问题似乎与 virtualenv 的以下修复有关：[https](https://github.com/techtonik/virtualenv/commit/bd2fb414d016be7462d19bf9116117ac5aa9b019) ://github.com/techtonik/virtualenv/commit/bd2fb414d016be7462d19bf9116117ac5aa9b019 。我使用的是 virtualenv 1.7.1.2 和 python 2.7。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-08-10T14:06:27.263

virtualenv 不是完整的 Python 安装。它只是一个使用现有 Python 安装并提供隔离环境来安装包的环境。不要指望给定的 virtualenv 可以工作，除非它是在哪里创建的（“哪里”包括它所在的计算机）。

对于部署，有 PEX 和 PyInstaller 以及各种其他选项。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-12T15:09:34.330

从您的一条评论中：

> 我的问题很简单，virtualenv 可以在没有安装 python 的情况下工作吗？

不，请阅读[virtualenv 文档中的“使环境可重定位”](http://pypi.python.org/pypi/virtualenv#making-environments-relocatable)

引用最重要的：

> 注意：这个选项在某种程度上是实验性的，可能还有一些尚未确定的警告。此外，这目前不适用于 Windows。

# android - Android Jsoup For 循环

> ID：10126113
> 
> 赞同：1
> 
> 时间：2012-04-12T14:51:50.520
> 
> 标签：android, jsoup

链接和 h3 是元素。对于 Jsoup 中的 (Element link:links) 我们通常会这样做。我们如何用两个元素来做到这一点？喜欢（元素链接：链接；元素链接1：h3）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T17:42:20.673

您可以同时选择它们并遍历结果`Elements`：

```
 String html = "<a href='#'>Link</a><h3>Heading</h3><span>Some text</span>";
    Document doc = Jsoup.parse(html);
    for (Element e : doc.select("a,h3")) {
        System.out.println(e);
    } 
```

输出如下所示：

```
<a href="#">Link</a>
<h3>Heading</h3> 
```

这样做的好处是，如果这对您很重要，那么似乎可以维持排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:11:18.307

最简单的方法 - 是将所有元素添加到一个 List 中并对其进行迭代：

```
links.addAll(h3);
for (Element link:links) {
//DO your stuff
} 
```

# r - 将字符串强制转换为 int

> ID：10126118
> 
> 赞同：3
> 
> 时间：2012-04-12T14:52:00.510
> 
> 标签：r

谁能解释为什么在 R 中会发生以下情况：

```
> 0.0 < "14.9a"
[1] TRUE

> 2.03 < "14.9a"
[1] FALSE

> 10.11006 < "14.9a"
[1] TRUE 
```

当“14.9a”在内部强制转换为 int 时会发生什么？正如第二个示例所示，它不能只是忽略非数字字符。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-12T14:54:53.593

我认为它正在做相反的事情并将 int 转换为字符串。

```
> "0.0" < "14.9a"
[1] TRUE

> "2.03" < "14.9a"
[1] FALSE

> "10.11006" < "14.9a"
[1] TRUE 
```

从帮助页面：

> 如果两个参数是不同类型的原子向量，则将一个强制转换为另一个类型，优先级（递减）顺序为字符、复数、数字、整数、逻辑和原始。

并且：

> 字符向量中字符串的比较是使用正在使用的语言环境的整理顺序在字符串中按字典顺序进行的：请参阅语言环境。诸如 en_US 之类的语言环境的整理顺序通常与 C（应该使用 ASCII）不同，并且可能令人惊讶。谨防对整理顺序做出任何假设......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-12T14:56:45.967

根据`?"<"`：

> 如果两个参数是不同类型的原子向量，则将一个强制转换为另一个类型，优先级（递减）顺序为字符、复数、数字、整数、逻辑和原始。

因此，数值被转换为字符串，然后根据它们的字典顺序对字符串进行比较。（即“2”>“10”）

# php - 如何使用 Gdata 从 Picasa 获取实际图像

> ID：10126119
> 
> 赞同：2
> 
> 时间：2012-04-12T14:52:10.970
> 
> 标签：php, zend-framework, gdata

我正在尝试将实际 URL 输出到照片条目的高分辨率图像。Gdata的照片条目`Zend_Gdata_Photos_PhotoEntry`包含存储在 Picasa 中的照片数据。

目前，我找到了将 URL 输出到图像的方法。首先是输出拇指图像，它们似乎有三种不同的尺寸。第二种方法是通过`getContent()`。我希望这种方法可以让我获得最高分辨率的 URL。相反，它包含一个仍然比 Picasa 中的原始 URL 小的图像 URL。

```
 $thumb = $entry->getMediaGroup()->getThumbnail();
    $content = $entry->getMediaGroup()->getContent();

    echo "<img src='" . $content[0]->getUrl() . "' />";      
    echo "<img src='" . $thumb[1]->getUrl() . "' />"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T12:49:39.873

构建查询时，添加**setImgMax**参数，如下所示：

```
$query = $gp->newAlbumQuery();
$query->setUser($user);
$query->setAlbumId($album);
$query->setImgMax("d"); 
```

这样，您将使用您发布的相同代码获得照片的最高分辨率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T19:59:49.047

同样[的问题在这里](https://stackoverflow.com/questions/9935814/where-is-the-full-size-image-in-gdata-photos-query)

在 php/zend 方面之外，它可以帮助理解 gdata/picasa 的底层抽象协议。我假设您的照片提供商是 picasa..

无论您使用哪种语言编写，您都可以使用 Playground 等通用工具[来](https://code.google.com/oauthplayground/)进行测试以执行协议，并进一步了解您尝试使用的 API 的所有方面。

高分辨率图片位于**media:group/media:content[@url]**

另一个链接有一个很长的答案，显示了如何针对特定用户/相册/照片的 api 执行 GET，以及如何找到包含所需 URL 的标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T21:34:39.423

可能更简单，将 url 上的大小从**sXXX 更改**为**s0**

![在此处输入图像描述](../Images/e2121c8328cb8fcd46449659afd0fca7.png)

至

![在此处输入图像描述](../Images/eed1e0be29cd5976456f74dacf2c2c0b.png)

# php - 关注者的 PHP/MYSQL/社交网络最佳实践表结构

> ID：10126122
> 
> 赞同：2
> 
> 时间：2012-04-12T14:52:21.040
> 
> 标签：php, mysql, networking, social

我想让用户像 Twitter、Instagram 等一样关注其他用户。我认为这应该包括如下表结构：

具有用户 ID、密码、电子邮件、fname、lname 的用户

具有 userid1(INT)、followstatus(TINYINT)、usererid2 (INT) 的追随者

当 user1 决定关注 user2 时，将创建新行。如果 user1 决定不再关注 user2，则可以关闭以后的关注状态。如果 user2 跟随 user 1，将有一个单独的条目

我可以通过对该表的查询告诉 user1 他正在关注谁。并通过计数查询告诉用户有多少人关注他们。然后以这种关系为条件，将有关 user2s 操作（followee）的信息打印到 user1（follower）。

这是最佳做法吗？或者还有更多……是否需要其他字段、表格？

注意：用户有另一个人表，不一定是用户，但我认为关注者状态应该在单独的表中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T15:01:57.447

这看起来不错。不过需要注意的是：如果您的项目真正起飞，您很快就会脱离单台机器并且必须进行分片。这意味着将您的用户表和关系表分解成更小的表。这是一个很大的话题，超出了这里的范围。

一旦你打破了它们，某种类型的查询就会变得困难或不可能。

例如，现在查询“谁关注我”很简单。

```
select * from followers where user2 = me; 
```

或“我该跟随谁？”

```
select * from followers where user1 = me; 
```

一旦您破坏了关注者表，这些查询之一将是不可能的（因为数据可能跨越多个表/数据库/服务器）。为了克服这个问题，您可能需要创建两个表：

```
i_follow (user1 int, user2 int)
follow_me (user1 int, user2 int) 
```

并在每个新关系上插入相应的记录。

这只是冰山一角。踏上这段旅程，你会发现许多有趣的问题需要解决:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T14:59:31.580

我认为你在正确的轨道上。包含用户的表是必须的。第二个表是将追随者与被追随者相关联。这将让您确定谁关注谁，允许任何 2 个用户的双向关系，并使查询变得简单。此外，重要的是，您不会将任何重要信息存储两次。使用单个删除查询也可以轻松删除关系。

# java - 用点中心在Java中创建一个圆形类？

> ID：10126124
> 
> 赞同：3
> 
> 时间：2012-04-12T14:52:38.043
> 
> 标签：java

写一个类来封装圆的概念，假设圆有以下属性：一个Point表示圆的中心，圆的半径是一个整数。包括构造函数、访问器和修改器，以及 toString 和 equals 方法。还包括返回圆的周长 (2*PI*radius) 和面积 (PI*radius^2) 的方法。

```
import java.awt.*;

public class Circle {

    private int radius;

    public Circle() {

        radius = 1;
    }

    public Circle(int x, int y, int r) {
        super(x, y, c);
        radius = r;
    }

    public int getRadius() {
        return radius;
    }

    public double getArea() {
        return Math.PI * radius * radius;
    }

    public double getPerimeter() {
        return 2 * Math.PI * radius;
    }
} 
```

我可以做到这一点，我只是对向我的类添加点构造函数、访问器和修改器有点困惑。

它看起来像这样吗？

```
 protected int x, y;

  public point() {

      setPoint(0,0);

  }

  public point(int coordx, int coordy) {
      setPoint(coordx,coordy);
  }

  public void setPoint(int coordx, int coordy) {
      x = coordx;
      y = coordy;
  }
  public int getX() {
      return x;
  }

  public int getY() {
      return y;
  }

  public String toPrint() {
      return "[" + x + "," + y + "]";
  }

  } 
```

是否可以将两者结合在 1 类中？我试了一下，里面的每一行都有一个错误，说 Circle 没有返回类型。任何洞察力都将是一种回报。再次感谢各位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:01:35.167

这里有一些代码，一个圆是一个点的扩展，向它添加一个半径

```
public class Point {
   public Point(int x, int y) {
      // .. set x and Y coord
   }

   // Getters and Setters
   public int getX() {
      return x;
   }

  public int getY() {
      return y;
  }

  public String toPrint() {
      return "[" + x + "," + y + "]";
  }
  // Your other Point methods...

  private int x = 0;
  private int y = 0;
}

public class Circle extends Point {
  int rad;

  public Circle (int x, int y, int radius) {
    super(x, y);
    rad = radius;
  }
  // Your other Circle methods
} 
```

正如所承诺的：另一种没有扩展的方式可能是：

```
class Point {
  int x;
  int y;

  public Point (int x, int y) {
     this.x = x;
     this.y = y;
  }
  // Getter/Setters and other methods
}

public class Circle {

  Point centre = null;
  int radius = 0;

  public Circle(int x, int y, int rad) {
      centre = new Point(x, y);
      radius = rad;
  }
   // Your other Circle methods
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T14:59:11.317

您正在谈论在单个类中具有多个对象的构造函数。那是做不到的。Java 认为这`public point()`是一个没有返回类型的方法，因此在语法上是不正确的。

你不需要为了点而上课。Java 已经提供`java.awt.Point`了。`Point`只需为您的班级添加一个班级级别字段，`Circle`您就可以了。

`Circle`然后看起来像这样：

```
public class Circle {

    private int radius;
    private Point point;

    public Circle() {
        point = new Point(0, 0);
        radius = 1;
    }

    public Circle(int x, int y, int r) {
        point = new Point(x, y);
        radius = r;
    }

    public int getRadius() {
        return radius;
    }

    public double getArea() {
        return Math.PI * radius * radius;
    }

    public double getPerimeter() {
        return 2 * Math.PI * radius;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:09:19.470

我会这样做

```
import java.awt.Point;

public class Circle {

    private Point center;
    private int radius;

    public Circle(){
        this( new Point( 0, 0 ) );
    }

    public Circle( int x, int y, int radius ){
        this( new Point( x, y ), radius );
    }

    public Circle( Point center ){
        this( center, 1 );
    }

    public Circle( Point center, int radius ){   
        this.setCenter( center );
        this.radius = radius;
    }

    public int getRadius(){ return this.radius; }
    public Point getCenter(){ return this.center; }

    public double getPerimeter(){ return 2 * Math.PI * this.radius; }
    public double getArea(){ return Math.PI * this.radius * this.radius; }

    public void setCenter( int x, int y ){
        this.setCenter( new Point( x, y ) );
    } 

    public void setCenter( Point center ){
        this.center = center;
    }

    public boolean equals( Object o ){ 

        if ( o == this ){ return true; }
        if ( o == null || o.getClass() != this.getClass() ){ return false; }

        Circle c = (Circle) o;
        return ( o.radius == this.radius && o.center.equals( this.center ) );
    }

    public string toString(){
        return "Circle[" + this.center.toString() + ", " + this.radius + "]";
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T14:58:24.047

您在构造函数中调用超级构造函数：

```
super(x, y, c); 
```

# python - 修复 Numpy 中的相位展开错误

> ID：10126125
> 
> 赞同：5
> 
> 时间：2012-04-12T14:52:53.110
> 
> 标签：python, numpy, phase

我有一系列展开阶段，其中一些展开错误包括 +/- Pi 的倍数的跳跃：

```
import numpy
a = numpy.array([0.5, 1.3, 2.4, 10.3, 10.8, 10.2, 7.6, 3.2, 2.9]) 
```

在此示例中，在 2.4 和 10.3 之间有 2 个周期的第一次跳跃，在 7.6 和 3.2 之间有 -1 个周期的跳跃。我想删除跳跃。问题是，当您删除一个跳跃时，您需要相应地增加或减少该系列的其余部分，而不仅仅是跳跃发生的值。

有没有更清洁的方法（没有/更少的循环，更快）这样做：

```
jumpsexist = 1
while jumpsexist:
    # Look for absolute differences greater than Pi
    jump = numpy.abs((numpy.roll(a,-1) -a)) > numpy.pi
    if jump[:-1].any():
        # Find the index of the first jump
        jumpind = numpy.argmax(jump) + 1
        # Calculate the number of cycles in that jump
        cycles = ((a[jumpind] - a[jumpind- 1]) / numpy.pi).astype("Int8")
        # Remove the cycles
        a[jumpind:] -= cycles * numpy.pi
    else:
        break 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-17T12:37:13.347

NumPy 提供了`numpy.unwrap()`相位展开的功能。使用默认参数值，它将校正以 2π 为模的相位数组，使得所有跳跃都小于或等于 π：

```
>>> a = numpy.array([0.5, 1.3, 2.4, 10.3, 10.8, 10.2, 7.6, 3.2, 2.9])
>>> numpy.unwrap(a)
array([ 0.5       ,  1.3       ,  2.4       ,  4.01681469,  4.51681469,
        3.91681469,  1.31681469,  3.2       ,  2.9       ]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:24:53.893

这个怎么样：

```
import numpy as np 
a = np.array([0.5, 1.3, 2.4, 10.3, 10.8, 10.2, 7.6, 3.2, 2.9])
d = np.diff(a)/np.pi
b = np.empty_like(a)
b[0] = a[0]
b[1:] = a[1:]-(np.floor(np.abs(d))*np.sign(d)).cumsum()*np.pi 
```

这使：

```
In [40]: print a
[  0.5   1.3   2.4  10.3  10.8  10.2   7.6   3.2   2.9]

In [41]: print b
[ 0.5         1.3         2.4         4.01681469  4.51681469  3.91681469
  1.31681469  0.05840735 -0.24159265] 
```

这里`d`包含“跳跃”的有符号数量，适当截断的“跳跃”的累积总和是需要删除/添加到系列的每个连续元素的 pi 的多个。

这是你的意思吗？

# ios - Xcodebuild & Jenkins：如何在构建后重命名产品

> ID：10126126
> 
> 赞同：2
> 
> 时间：2012-04-12T14:52:59.307
> 
> 标签：ios, continuous-integration, jenkins, xcodebuild

我想重命名在构建过程之后创建的 .ipa 文件以应用一些公司内部命名法。我们使用 Jenkins 和 Xcodebuild 插件。似乎没有办法通过 Xcodebuild 插件重命名产品，所以我想知道合适的 shell 脚本是什么。

考虑到我手头有一个 $filename。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T22:44:40.153

您可以添加一个执行 shell 构建步骤以在 xcodeplugin 运行后运行。像这样的东西：

```
mv $WORKSPACE/build/Distribution-iphoneos/<your ipa filename>.ipa $WORKSPACE/build/Distribution-iphoneos/<new filename>.ipa 
```

您必须检查构建服务器或从属服务器上的 WORKSPACE 目录以获取 .ipa 文件的确切位置。

# c# - 在 SharePoint 中使用 BreakRoleInheritance() 时真假之间的区别

> ID：10126129
> 
> 赞同：10
> 
> 时间：2012-04-12T14:53:13.607
> 
> 标签：c#, sharepoint, permissions

使用`ListItem.BreakRoleInheritance(true)`和 和有什么不一样`ListItem.BreakRoleInheritance(false)`？

使用这两个时我得到相同的结果，我想知道是什么告诉他们分开？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-12T14:57:33.573

如文档中所述，它是一个布尔值，用于说明角色分配是否从父级复制到子级。如果为 false，则子级将有一个空白的角色（所有者除外）。如果为真，它将拥有您调用该方法时父级所拥有的任何内容。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-12T15:14:35.410

来自[MSDN](http://msdn.microsoft.com/en-us/library/ee535228.aspx)：

您可以通过对象的 BreakRoleInheritance 方法中断网站、列表或列表项的安全继承，以便父对象上的角色分配不再适用于子对象，例如，列表上的角色分配不会不再适用于列表项。对于网站和列表，此方法传递两个布尔参数，copyRoleAssignments 和 clearSubScopes。第一个参数指定是否保留当前已经从父网站集或网站继承的角色分配，第二个参数指定是否清除子对象的唯一权限，以便它们随后从父网站或列表继承权限。如果 copyRoleAssignments 参数设置为 false，则运行代码的当前用户将获得对象的完全控制权。

# c++ - 编译错误：linux/module.h：没有这样的文件或目录

> ID：10126134
> 
> 赞同：12
> 
> 时间：2012-04-12T14:53:37.930
> 
> 标签：c++, c, linux, compilation, kernel

我写了一个简单的模块：

```
#define __KERNEL__
#define MODULE
#include <linux/kernel.h> 
#include <linux/module.h>

int init_module(void)
{
    printk("Hello, world\n");
    return 0;
}

void cleanup_module(void)
{
    printk("Goodbye\n");
} 
```

并用这个命令编译它：

```
cc -c hello.c 
```

但我收到此错误：

```
 linux/module.h: No such file or directory 
```

有什么建议么？

编辑：我使用了这个逗号：

```
cc -I/usr/src/linux-headers-3.0.0-17-generic/include -c hello.c 
```

它领先一步，现在我收到此错误：

```
In file included from /usr/src/linux-headers-3.0.0-17-generic/include/linux/kernel.h:13:0,
                 from hello.c:3:
/usr/src/linux-headers-3.0.0-17-generic/include/linux/linkage.h:5:25: fatal error: asm/linkage.h: No such file or directory
compilation terminated. 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-12T14:57:11.527

首先你需要*[内核源代码](http://www.kernel.org/)*。许多人混淆了用户空间标头和内核空间标头，因为它们中的许多具有相同的文件夹结构。大多数发行版只有用户空间头文件，而没有内核空间头文件。

并且*通常* `make`用于构建内核模块而不是裸露的`cc`. [按照这里](http://tldp.org/LDP/lkmpg/2.6/html/lkmpg.html)给出的简单的逐步解释的`Hello World`内核模块

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-04T20:16:40.760

源文件名为 basic.c

```
#include <linux/init.h>
#include <linux/module.h>
/*MODULE_LICENSE("Dual BSD/GPL");*/
static int hello_init(void)
{
    printk(KERN_ALERT "Hello, world\n");
    return 0;
}
static void hello_exit(void)
{
    printk(KERN_ALERT "Goodbye, cruel world\n");
}
module_init(hello_init);
module_exit(hello_exit); 
```

======================================

# 现在为ubuntu制作文件

首先在您的终端上键入 $(uname -r) 然后您将获得在您的系统上使用的版本..

```
obj-m +=basic.o

KDIR =//usr/src/linux-headers-3.13.0-44-generic

all:
 $(MAKE) -C $(KDIR) SUBDIRS=$(PWD) modules
clean:
 rm -rf *.o *.ko *.mod.* *.symvers *.order 
```

=================================================

# **运行代码**

```
$sudo insmod basic.ko
$dmesg
u will get the output
$sudo rmmod basic.ko
$dmesg 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-12T14:55:07.573

你需要内核头文件；`/usr/include/`如果安装，它们通常会在其中。

除非您使用基于源的发行版或构建自己的内核，否则它们默认情况下不会安装；使用发行版的包管理器来安装它们。该包通常称为`linux-headers`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-12T15:42:36.710

您需要内核构建环境（脚本、头文件和 Makefile 的选择），如果已经安装了内核，通常可以通过 /lib/modules/ *version /build（指向它的符号链接）访问。*否则，该目录就是构建目录（System.map 所在的目录）。*不需要*完整的源代码（智能发行版认识到这一点），/usr/include/whatever 也不需要。

您还*必须*使用 kbuild；打电话`cc -I`是不够的，已经10多年没有了。你从一个`Kbuild`文件开始：

```
obj-m += mymodule.o 
```

和一个`Makefile`：

```
kdir=/lib/modules/$(shell uname -r)/build
all:
        make -C ${kdir} M=$$PWD
modules_install clean:
        make -C ${kdir} M=$$PWD $@ 
```

然后利用`make`.

#defining`__KERNEL__`并且`MODULE`也毫无意义，因为如果需要，kbuild 已经设置了它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-12T14:59:13.043

大多数 Linux 发行版默认不安装内核头文件。寻找一个包 kernel-headers 或类似的东西。

# python - IPython Notebook 中的 Pyzmq 错误

> ID：10126142
> 
> 赞同：6
> 
> 时间：2012-04-12T14:54:10.283
> 
> 标签：python, ipython, pyzmq

我正在尝试在 Vista 中运行 IPython 笔记本。我相信我使用 easy_install安装了所有必要的依赖项（在[此处列出）。](http://ipython.org/ipython-doc/dev/install/install.html#dependencies-for-the-ipython-html-notebook)IPython 运行良好。但是当我尝试运行 IPython notebook 时，一切都正常启动，但是一旦我尝试做任何事情，内核就会死掉。我收到以下令人困惑的错误：

```
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "C:\Python27\lib\site-packages\ipython-0.11-py2.7.egg\IPython\zmq\__init__.py", line 25, in <module>
    minimum_pyzmq_version, pyzmq_version))
ImportError: IPython.zmq requires pyzmq >= 2.1.4, but you have 2.1.11 
```

2.1.11 >= 2.1.4 所以我不确定问题是什么。2.1.11 是 pyzmq 的最新版本（[这里](https://github.com/zeromq/pyzmq)是项目页面）。

[更新：谢谢@ThomasK。我已经在运行 IPython 0.12 但我在 IPython 和 pyzmg 上运行了 easy_install --upgrade 并修复了它。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T17:39:50.067

该错误已在 IPython 0.12 中修复，因此您需要升级。无论如何，您需要 0.12 才能运行笔记本。

如果您在升级时遇到问题，请尝试删除安装 IPython 0.11 的文件夹，然后使用 easy_install 重新安装。

# jquery - 使用jQuery一键触发多个添加到购物篮按钮

> ID：10126144
> 
> 赞同：0
> 
> 时间：2012-04-12T14:54:17.753
> 
> 标签：jquery

我希望在现成的电子商务平台上触发多个添加到购物篮按钮。服务器使用以下脚本生成添加到购物篮按钮：

按钮 1：

```
<a id="productRepeater_ctl00_btnAddToBasket" class="btn addbutton" href="javascript:__doPostBack('productRepeater$ctl00$btnAddToBasket','')">add to basket</a> 
```

按钮 2：

```
<a id="productRepeater_ctl01_btnAddToBasket" class="btn addbutton" href="javascript:__doPostBack('productRepeater$ctl01$btnAddToBasket','')">add to basket</a> 
```

按钮 1：

```
<a id="productRepeater_ctl02_btnAddToBasket" class="btn addbutton" href="javascript:__doPostBack('productRepeater$ctl02$btnAddToBasket','')">add to basket</a> 
```

平台脚本：

```
//<![CDATA[
var theForm = document.forms['buyoffpage'];
if (!theForm) {
    theForm = document.buyoffpage;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]> 
```

我希望能够通过单击一个单独的 jQuery 按钮来提交所有这些按钮。到目前为止我得到的脚本只提交了第一个：

```
$("body").append('<div id=\"submitAll\"><a href=\"#\">HIT ME</a></div>');
$('#submitAll').click(function(e) {
   __doPostBack('productRepeater$ctl00$btnAddToBasket', 'productRepeater$ctl01$btnAddToBasket','productRepeater$ctl02$btnAddToBasket');
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:06:28.650

如果表单不是通过 AJAX 或类似方式提交的，您将无法提交所有表单。如果您使用的是 AJAX，您可以执行以下操作：

```
var submitAll = $('<a href="javascript:;" />').html('HIT ME').click(function(){

      $('.addbutton').trigger('click');

});
$('body').append($('<div id="submitAll" />').append(submitAll)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:11:11.513

你会想做这样的事情......（你必须玩这个，因为它不是一个完整的解决方案）

```
function submitAll(){
  //your submit code
}

$(".btn.addbutton").each(function(a){
  //first clean up old junk
  a=$(a)
  a.removeAttr('href');
  //add a custom event call
  a.bind('submitAll', submitAll )
});

//fire custom events
$('#submitAll').trigger('submitAll') 
```

# c#-4.0 - XNA 程序许可协议

> ID：10126147
> 
> 赞同：0
> 
> 时间：2012-04-12T14:54:20.053
> 
> 标签：c#-4.0, licensing, xna-4.0

我只是想知道我应该在 XNA Framework 游戏设置文件中包含什么许可协议。目前，我正在使用 GNU 许可证，但我不确定这是否合适......

我只是想确保我使用的是正确的协议，或者它是否足以涵盖这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:02:38.147

不确定这个问题是否属于这里......

无论如何，我的理解与[此](http://en.wikipedia.org/wiki/Microsoft_XNA#XNA_Framework)相符：

> 针对 Xbox 平台的 XNA 框架游戏目前只能由 Microsoft XNA Creator's Club 的成员分发，订阅费为每年 99 美元。 [4] 桌面应用程序可以根据 Microsoft 当前的许可免费分发。

[这](http://en.wikipedia.org/wiki/Microsoft_XNA#License_agreement)：_

> Microsoft XNA Framework 2.0 EULA 明确禁止在开发商和 Microsoft 未签署具体协议的情况下分发连接到 Xbox Live 和/或 Games for Windows Live 的商业网络游戏。 [19] 这意味着 XNA Game Studio 仍然可以用于为 Windows 平台开发商业游戏和其他程序，尽管不能使用微软针对 Xbox/Windows Live 的网络支持代码。自行开发的网络代码仍然可以在开发者的 XNA 项目内部使用。

所以只要微软对它没问题就发布它，我认为它没问题。

[链接](http://www.gnu.org/licenses/gpl-faq.html#NonFreeTools) （对于 GNU 许可证）

> 您用于编辑源代码、编译、研究或记录源代码的程序通常不会影响与源代码许可相关的问题。

# java - 我可以在我的 java 代码中读取 htop 输出吗？

> ID：10126149
> 
> 赞同：1
> 
> 时间：2012-04-12T14:54:21.030
> 
> 标签：java, linux, procmon

我需要阅读有关在我的服务器中运行的各种进程的信息以及某些参数的值。我试图在 Ubuntu 11.10 上使用 Apache 服务器。在终端中使用 htop 我可以看到进程和变量值。我尝试通过管道将输出重定向到文本文件，但没有帮助。您能否通过说明如何通过 java 代码读取其输出来提供帮助。我是java新手，帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:01:53.607

您可能想查看 linux`/proc`文件系统：在那里您将找到有关系统和正在运行的进程的大部分信息。通常工具喜欢`ps`或`top`从那里读取他们的数据。许多文件都是小型文本文件，您可以从中获取适当的信息。

[您可以在http://www.linuxjournal.com/article/8381](http://www.linuxjournal.com/article/8381)下找到一个介绍（有点旧但很好的介绍）

附加说明：`/proc`文件系统有些文档化且稳定。大多数情况下，所有工具输出都可能（将）随着时间而改变。

# generics - 使用 Java 进行 CRUD 操作的通用 Web 服务

> ID：10126151
> 
> 赞同：0
> 
> 时间：2012-04-12T14:54:30.173
> 
> 标签：generics, wsdl

我计划为 20 个表的 CRUD 操作开发通用 Web 服务。我已经为每个表准备了 DAO 类（使用休眠）。我的目标是开发单个 Web 服务类来处理这些表的所有 CRUD 操作。有可能的？

我看到了一些示例，例如一个具有所有 CRUD 操作的通用抽象类和扩展该抽象类并调用超类方法的所有其他子类。在这里我可以将该抽象类公开为 Web 服务吗？这是正确的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T07:05:38.163

是的，您看到的示例与在 netbeans 中创建 restful web 服务相同

[http://netbeans.org/kb/docs/websvc/rest.html](http://netbeans.org/kb/docs/websvc/rest.html)有教程

使用 glassfish 服务器（因为它与 JEE6 完全兼容）

这将生成一个 wadl 并看到

在上面的教程之后...右键单击项目并单击测试restful服务..因为有WADl的链接（不是wsdl..因为它是restful）

# android - 为什么在添加线性布局 (Android) 时会出现空指针异常？

> ID：10126153
> 
> 赞同：2
> 
> 时间：2012-04-12T14:54:36.950
> 
> 标签：android, layout, canvas, nullpointerexception

我正在尝试使用类扩展视图来添加画布，然后将其添加到屏幕底部的线性布局中，在一些按钮下方。我知道我做得不对，但我不知道哪里出了问题。尝试添加线性布局时出现空指针异常。建议？

以下是部分代码：

```
public class Vectors extends Activity{

VectorsView vectorsView;
LinearLayout l;

public void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    vectorsView = new VectorsView(this);
    l = (LinearLayout) findViewById(R.id.llCanvasV);
    l.addView(vectorsView); //Line 50
    setContentView(R.layout.vectors);
    .......
}

public class VectorsView extends View{

    public VectorsView(Context context) {
        super(context);
    }
    @Override
    protected void onDraw(Canvas canvas) {
        // TODO Auto-generated method stub
        super.onDraw(canvas);       

        Paint paint = new Paint();
        paint.setColor(Color.WHITE);

        canvas.drawLine(0, 0, 100, 100, paint);
        vectorsView.draw(canvas);
        vectorsView.setLayoutParams(new LayoutParams(25, 25)); 
    }
} 
```

}

这是xml的一部分：

```
<LinearLayout 
     android:layout_width="fill_parent" 
     android:layout_height="fill_parent"
     android:background="@drawable/background" 
     android:orientation="vertical">

     <ImageView android:layout_height="wrap_content" 
        android:src="@drawable/vectors" 
        android:layout_width="wrap_content"
        android:layout_gravity="center"
        android:paddingTop="5dp"
        android:paddingBottom="5dp"
        android:adjustViewBounds="true">
     </ImageView>
     <LinearLayout android:layout_height="wrap_content" 
        android:layout_width="match_parent"
        android:orientation="horizontal">
        <Button android:text="Choose Program" 
            android:id="@+id/bChsProgV" 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content"
            android:layout_marginBottom="5dp"
            android:layout_marginLeft="97dp"
            android:adjustViewBounds="true">
        </Button>
        <ImageButton android:layout_height="wrap_content" 
            android:src="@drawable/help" 
            android:id="@+id/ibHelpV" 
            android:layout_width="wrap_content"
            android:layout_marginLeft="65dp"
            android:background="@null" 
            android:layout_marginTop="10dp">
        </ImageButton>
     </LinearLayout>
     <LinearLayout android:id="@+id/llCanvasV" 
        android:layout_height="wrap_content" 
        android:layout_width="match_parent">
     </LinearLayout>
</LinearLayout> 
```

这是logcat：

```
 04-12 07:47:22.009: ERROR/AndroidRuntime(15072): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.prattia.webs.cheaterphysics/com.prattia.webs.cheaterphysics.Vectors}: java.lang.NullPointerException
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at android.os.Looper.loop(Looper.java:123)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at android.app.ActivityThread.main(ActivityThread.java:4627)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at java.lang.reflect.Method.invokeNative(Native Method)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at java.lang.reflect.Method.invoke(Method.java:521)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at dalvik.system.NativeStart.main(Native Method)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072): Caused by: java.lang.NullPointerException
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at com.prattia.webs.cheaterphysics.Vectors.onCreate(Vectors.java:50)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
04-12 07:47:22.009: ERROR/AndroidRuntime(15072):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T14:56:13.860

在调用**findViewById**之前，您需要先调用**setContentView**。见下文：

 **```
public void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.vectors);  //must be called before findViewById

    vectorsView = new VectorsView(this);
    l = (LinearLayout) findViewById(R.id.llCanvasV);
    l.addView(vectorsView); //Line 50
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T14:57:11.457

常见的错误：

```
l = (LinearLayout) findViewById(R.id.llCanvasV); 
```

在当前内容视图中搜索，但未设置。

改变;

```
l = (LinearLayout) findViewById(R.id.llCanvasV);
l.addView(vectorsView); //Line 50
setContentView(R.layout.vectors); 
```

进入

```
setContentView(R.layout.vectors);
l = (LinearLayout) findViewById(R.id.llCanvasV);
l.addView(vectorsView); //Line 50 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T14:57:31.147

您尚未在第 50 行之前调用 setContentView，因此第 49 行还找不到 LinearLayout。**

# eclipse - Maven如何从从war文件导入的项目中构建战争？

> ID：10126157
> 
> 赞同：0
> 
> 时间：2012-04-12T14:54:47.570
> 
> 标签：eclipse, maven, import, export, war

我通过导入一个war文件创建了一个eclipse web项目。最初，war 文件中没有源代码。我想通过根据不同的配置文件动态更改一个属性文件的内容来从这个项目构建一个新的war文件，以便可以将构建的war文件部署在不同的环境（开发和生产）中。

但是由于原war文件中没有源代码，所以项目中没有源代码，将此项目转换为maven项目，并在pom.xml中设置打包为war后，maven显示如下错误：

> [错误] 无法在项目 birt 上执行目标 org.apache.maven.plugins:maven-war-plugin:2.1.1:war >(default-war)：组装 WAR 时出错：需要 webxml 属性（或预先存在WEB-INF/web.xml 如果在更新模式下执行）

我认为这个错误是由于我的项目中没有这样的文件夹（/src/main/webapp）引起的。我的项目结构如下：

> drwxrwxr-x 3 kewei kewei 4096 12 avril 15:55 build
> 
> -rw-rw-r-- 1 kewei kewei 375 12 avril 16:10 pom.xml
> 
> drwxrwxr-x 3 kewei kewei 4096 12 avril 15:54 src
> 
> drwxrwxr-x 5 kewei kewei 4096 12 avril 16:12 目标
> 
> drwxrwxr-x 10 kewei kewei 4096 12 avril 15:55 WebContent

src 文件夹中没有任何内容，所有内容都在 WebContent 文件夹中。

我可以通过更改属性文件并将项目导出到 war 文件（没有 maven）来完成这项工作。但是有更聪明的方法吗？

也许 maven 不是为了做这种构建而设计的？在这种情况下，如何根据不同的配置文件动态更改属性文件的内容来构建不同的战争？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T20:43:15.957

如果您真的喜欢处理 WebContent 而不是所有内容都在 src/main/webapp 等下的 maven 方式，您可以更改[maven-war-plugin](http://maven.apache.org/plugins/maven-war-plugin/)的配置以根据您的需要进行更改。但我可以建议只为第一步进行配置。在它运行之后，将项目的布局更改为 maven 默认值（约定），因为它让生活更轻松。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T01:38:09.393

khmarbaise 是对的，但我强烈建议如果您要使用 Maven，那么您可以使用 maven 的约定来构建您的代码树。

Maven 是一个很棒的工具，只要您按照它想要的方式做所有*事情*。如果你偏离了，有（或可能有）变通办法来实现你的目标，但通常会很痛苦。

# jsp - JSP和Tomcat网页运行问题

> ID：10126162
> 
> 赞同：-2
> 
> 时间：2012-04-12T14:55:11.700
> 
> 标签：jsp

我想发布我在本地 pc 上的 win 7 机器上创建的 jsp 页面。运行项目时。它运行但不在浏览器中显示该页面。请帮我..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:02:14.137

Tomcat 有一个管理员显示已安装的应用程序和状态。如果由于某种原因未部署该应用程序，您将在那里看到它。

# objective-c - 使用 objc_msgSend 时避免静态分析器泄漏警告？

> ID：10126167
> 
> 赞同：0
> 
> 时间：2012-04-12T14:55:30.093
> 
> 标签：objective-c, automatic-ref-counting

我有来自通用工厂类的以下（简化）代码：

```
- (id) invokeSetup: (id) object {
    // Just an example, subclasses delegate setup to a component that either returns +0 or +1 references
    return objc_msgSend(object, @selector(init));
}

- (id) newInstance {
    id object = objc_msgSend([NSString class], @selector(alloc));
    id replacement = [self invokeSetup: object];

    return replacement;
} 
```

分析器在 上产生警告`return replacement:`：

> 警告：具有 +0 保留计数的对象返回给调用者，其中预期 +1（拥有）保留计数

我不知何故需要告诉分析器返回的引用`- invokeSetup`是+1。上面的例子被简化了，在实际程序中，有几个约束：

1.  我无法`invokeSetup`使用 ns_returns_retained 进行注释，因为它是继承的，并且存在其他子类，其中 invokeSetup 返回 +0 引用。如果是+1 或+0 只能在运行时检测。

2.  我无法更改任何方法的名称。

3.  设计就是这样。可能有更好的设计，但这里不能改变。

是否有可能在赋值点（`id replacement = ...`）以某种方式告诉 ARC 引用肯定是 +1？

谢谢，乔臣

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:19:36.053

有关在代码中抑制静态分析器警告的方法，请参阅[https://stackoverflow.com/a/5833430/1313031](https://stackoverflow.com/a/5833430/1313031)

但是，是的，最好的办法是重命名 newInstance

# ios - mp4 和 m4v 文件未在 iOS 5.1 中捆绑

> ID：10126169
> 
> 赞同：2
> 
> 时间：2012-04-12T14:55:35.683
> 
> 标签：ios, objective-c, video, mp4, m4v

我有一个在 iOS 5.1 上运行的应用程序，该应用程序使用 Xcode 4.31 构建，可以使用标准 mpmovieplayercontroller 很好地播放 *.mov 文件。但是当我尝试使用 .m4v 或 .mp4 版本的视频时，它们不会被捆绑。如果我从测试设备（iPad 或 iPad 模拟器）中删除应用程序，我可以看到 .mov 在构建和部署期间被复制，但 .m4v 或 .mp4 版本不会被复制。

我添加了一些调试代码，似乎可以确认应用程序中不存在 m4v 或 mp4 媒体：

```
if (moviePath) {
    theMovieURL = [NSURL fileURLWithPath:moviePath];
    NSLog(@"theMovieURL: %@", theMovieURL);
}else {
     NSLog(@" there is no theMovieURL");
    return;
} 
```

当我尝试使用 m4v 或 mp4 时，它会在 else 块中打印出日志消息。我尝试了完全不同的测试视频，每次都得到相同的结果。任何 .mov 视频都可以正常工作，根本没有 m4v 或 mp4 文件。该应用程序需要包含一个相当大的视频，所以我想使用优化版本 - mp4 或 m4v 中的 H.264 vids 似乎不到文件大小的一半，所以只使用 .mov 版本不是一个选项。

感谢您提供的任何见解。

编辑/更新：我查看了我的 Library/.../[Simulator].../[App name].app 目录，发现 *.mov 文件，没有 *.m4v 或 *.mp4 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:31:40.723

Apple 的 *.mov 文件格式是一种[容器格式](http://en.wikipedia.org/wiki/Container_format_%28digital%29)。您可以将 *.mp4 或 *.m4v 文件保存为 *.mov，因为它基本上只是“环绕”源 *.mp4 或 *.m4v 并且几乎不影响文件大小。

**编辑：**
此外，许多 *.mp4 文件可以简单地重命名为 *.mov 并且仍然可以正常播放。

# silverlight - 'BitmapSource.main page'的部分声明错误不能指定不同的基类

> ID：10126170
> 
> 赞同：0
> 
> 时间：2012-04-12T14:55:39.500
> 
> 标签：silverlight, windows-phone-7, bitmapsource

'BitmapSource.main page'的部分声明出现错误，不能指定不同的基类。

在我的 XAML 中，我有

```
x:Class="BitmapSource.MainPage", xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone", xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone" 
```

然后在**MainPage.gics**中突出显示的错误是公共部分类**MainPage** Microsoft.Phone.Controls.PhoneApplicationPage

如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:10:01.427

我会说这个问题是由潜在的[BitmapSource 混淆引起](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapsource%28v=vs.95%29.aspx)的。简单的测试来查看是否是这种情况 - 将您的项目重命名为 BitmapSource 以外的其他名称，然后查看问题是否仍然存在。

# templates - 玉思mixin是未定义的，但不是

> ID：10126174
> 
> 赞同：2
> 
> 时间：2012-04-12T14:55:56.137
> 
> 标签：templates, pug

为什么这不起作用？

```
extends layout

mixin WhyNotDefined(text)
  p #{text}

append content
  mixin WhyNotDefined('Hi') 
```

我不断收到错误：`WhyNotDefined_mixin is not defined`

玉@0.20.3; 节点 v0.6.14

**更新。**

愚蠢的我，应该在块中定义mixin。这有效：

```
extends layout

append content
  mixin WhyNotDefined(text)
    p #{text}

  mixin WhyNotDefined('Hi') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T10:12:25.367

愚蠢的我，应该在块中定义mixin。这有效：

```
extends layout

append content
  mixin WhyNotDefined(text)
    p #{text}

  mixin WhyNotDefined('Hi') 
```

# xml - .net 3.5 中的 DtdProcessing.Ignore

> ID：10126176
> 
> 赞同：3
> 
> 时间：2012-04-12T14:56:00.660
> 
> 标签：xml, .net-4.0, .net-3.5, dtd

在 .net 4.0 中，我们可以使用`XmlReaderSettings.DtdProcessing`带值的属性`DtdProcessing.Ignore`来忽略 dtd。在 .net 3.5 中，我们只能`XmlReaderSettings.ProhibitDtd`在没有忽略值的情况下使用。如何在 .net 3.5 中激活 dtd 的忽略模式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-21T13:27:36.933

尝试以下：

```
XmlReaderSettings.ProhibitDtd = false;

XmlReaderSettings.XmlResolver = null;

XmlDocument.XmlResolver = null; 
```

为我工作

# android - Eclipse 不会在 android 项目中的 xml 文件上显示警告和错误

> ID：10126183
> 
> 赞同：2
> 
> 时间：2012-04-12T14:56:42.423
> 
> 标签：android, eclipse

![在此处输入图像描述](../Images/7b2ce3c17e0df148c033b4b584f52fc1.png)

我在父文件夹上看到警告和错误图标，但在实际的 xml 文件中看不到它们。
当我打开包含文件的文件夹时，文件警告会闪烁几秒钟然后消失。
对于这个问题我能做些什么？

提前致谢。

# html - IFrames 使我的页面滚动到页面底部

> ID：10126184
> 
> 赞同：0
> 
> 时间：2012-04-12T14:56:44.967
> 
> 标签：html, iframe

这些是`iframes`奇怪的，当我检查它们时，我看到它们里面的整个页面 HTML。这正常吗？？！！加载它们时，页面会滚动到“它们所在的位置”底部并拒绝向上滚动，直到它们完成加载。如何停止滚动到底部？

```
 <iframe id="upload_target0" name="upload_target0" src="#" style="width:0;height:0;border:0px solid #fff;"></iframe>
        <iframe id="upload_target1" name="upload_target1" src="#" style="width:0;height:0;border:0px solid #fff;"></iframe>
        <iframe id="upload_target2" name="upload_target2" src="#" style="width:0;height:0;border:0px solid #fff;"></iframe>
        <iframe id="upload_target3" name="upload_target3" src="#" style="width:0;height:0;border:0px solid #fff;"></iframe>
        <iframe id="upload_target4" name="upload_target4" src="#" style="width:0;height:0;border:0px solid #fff;"></iframe>
        <iframe id="upload_target5" name="upload_target5" src="#" style="width:0;height:0;border:0px solid #fff;"></iframe>
        <iframe id="upload_target6" name="upload_target6" src="#" style="width:0;height:0;border:0px solid #fff;"></iframe> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T14:58:46.917

`#`解析为当前 URL。指定空字符串、空字符串或`about:blank`.
此外，不要重复`width:0;height:0;border:0;`使用，而是`display:none;`在单独的 CSS 规则中使用。

```
<iframe id="upload_target0" name="upload_target0" src="about:blank" class="upload_target"></iframe>

.upload_target {display:none;} 
```

# css - 尝试修复同一页面的 IE8 中略有不同的渲染

> ID：10126185
> 
> 赞同：0
> 
> 时间：2012-04-12T14:56:45.590
> 
> 标签：css, forms, internet-explorer-8

我有一个页面，其表单在一个版本的 IE8 中显示良好，但在另一台计算机上的 IE8 中查看时略有混乱。您可以在此处查看损坏页面的图像：

[http://blog.freihofersrun.com/wp-content/uploads/2012/04/download1.jpg](http://blog.freihofersrun.com/wp-content/uploads/2012/04/download1.jpg)

我在 style.css 中添加了一些 CSS 代码，我在这个网站上找到了另一个问题，但这并没有解决它（将 body {margin-top: 0;} 添加到样式表）。还有其他建议吗？非常感谢，克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:22:10.750

一种修复方法可能是对每个输入使用“清除”CSS 属性。或者，您可以使用 100% 宽度（或多少宽度可以使其正确对齐）和自动高度的 div 包装每个标签输入对。

# sql - Postgis重新排序混合的线串块/ max_segment_length（线串）？

> ID：10126187
> 
> 赞同：3
> 
> 时间：2012-04-12T14:56:53.390
> 
> 标签：sql, postgresql, postgis, multilinestring

我将大约 1000 条路径从某处导入我的 postgis 数据库到线串字段。

（**编辑**）我的桌子是这样的

```
+---------+---------------+------------------+
| id(int) | name(varchar) | path(LINESTRING) |
+---------+---------------+------------------+
| 123     | foo           | 000002...        |
| 124     | bar           | 000002...        | 
```

我遇到的问题是每条路径都被分成块，并且在某些情况下这些块被混淆了。

假设线串在点号 50 和 70 处被分割：

1.  块 A：点 1-50
2.  块 B：点 51-70
3.  块 C：点 71-100

当我将它迁移到我的数据库中时，它们混合在一起，所以结果线串可能会像这样结束：

1.  块 A：点 1-50
2.  块 C：点 71-100
3.  块 B：点 51-70

所以这会产生从 50 到 71 的跳跃和另一个从 100 到 51 的跳跃

（**编辑**）当我导入这些分成块的路径时，我认为它们是有序的，但事实是有些是混合的，这使得我的一些线串与它们的点一样排列，就像第二个例子一样。

我希望能够重新排序这些块（点），所以我想构建一个 SQL 查询来检测哪些路径有混合点，然后我可以手动（使用使用 openlayers 制作的工具）重新排列它们。

最好有一个 SQL 更新查询来解决这个问题，但我认为检测更容易（我认为有大约 5% 或更少的路径有错误）

**EDIT3**：我认为检测脚本可以检查路径是否包含一对太远的连续点。也许从包含最长段的路径排序路径的 SQL 会很好。

如何创建一个函数来获取线串中最大段的长度？

这里我展示一个例子：这就是它在数据库中的样子 ![不好的方式](../Images/04cb7695bc4e8e5a3c7ef05d638b8d60.png)

这就是我希望它被修复的方式 ![一个好的（固定的）方式](../Images/1b878d42d622816517b6fab534a0de80.png)

**EDIT4**：就像我在 EDIT3 上计划的那样，可以编写一个函数来查找线串中两个连续点之间的最长距离，使用[ST_NPoints()](http://www.postgis.org/documentation/manual-2.0/ST_NPoints.html)和[ST_PointN()](http://www.postgis.org/documentation/manual-2.0/ST_PointN.html)遍历线串的点，然后可以进行查询以订购路径与那最长的距离。这个距离太长的线串很可能会出现所描述的问题。这样我就可以检测到它们，并手动修复它们。

检测 SQL 的结果将是这样的：

```
 |ordered by this|
+---------+---------------+------------------+---------------+
| id(int) | name(varchar) | path(LINESTRING) |  msbtcp(int)  |
+---------+---------------+------------------+---------------+
| 123     | foo           | 000002...        | 1000          |
| 124     | bar           | 000002...        | 800           | 
```

*msbtcp 将是函数的结果：`max_separation_between_two_consecutive_points(path)`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T11:13:20.367

这听起来有点令人费解，但是如果您刚刚在线串中两个连续点之间的最大距离之后：

```
CREATE OR REPLACE FUNCTION max_distance_in_linestring(line geometry) RETURNS float as $BODY$
DECLARE
    i integer;
    n integer;
    d float;
    m float;
BEGIN
    d := 0;
    n := ST_NPoints(line);
    i := 2;
    LOOP
        EXIT WHEN i >= n;
        m := ST_Distance(ST_PointN(line,i-1),ST_PointN(line,i));
        -- use for lon,lats:
        -- m := ST_Distance(ST_PointN(line,i-1)::geography,ST_PointN(line,i)::geography);
        IF m > d THEN
            d := m;
        END IF;
        i := i + 1;
    END LOOP;
    RETURN d;
END;
$BODY$
LANGUAGE plpgsql;

SELECT max_distance_in_linestring('LINESTRING(0 0, 1 1, 2 2)'::geometry);
SELECT max_distance_in_linestring('LINESTRING(0 0, 4 3, 2 2)'::geometry); 
```

您可能希望将 ST_PointN 调用重新投射到 ::geography 以获取以米为单位的距离。

SQL 将是这样的：

```
SELECT
  name, path 
FROM
  paths
ORDER BY
  max_distance_in_linestring(path) DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T15:56:57.073

那么你想知道的是段是如何链接的，所以你需要将每个段的第一个和最后一个点与所有其他段进行比较：

```
SELECT foo.gid as segment_a, bar.gid as segment_b
    FROM 
        segments AS foo, 
        (SELECT the_geom, gid FROM segments) AS bar
    WHERE 
        bar.gid != foo.gid AND ( -- avoid same segments  
        ST_DWithin( 
                ST_GeometryN(foo.the_geom,  ST_NumGeometries(foo.the_geom)) , -- last from foo
                ST_GeometryN(bar.the_geom,  ST_NumGeometries(bar.the_geom)) , -- last from bar
                0.00005 ) OR -- precision, depends of your SRID
        ST_DWithin( 
                ST_GeometryN(foo.the_geom,  1) , -- first from foo (start = 1 index)
                ST_GeometryN(bar.the_geom,  ST_NumGeometries(bar.the_geom)) , -- last from bar
                0.00005 ) OR -- precision, depends of your SRID
        ST_DWithin( 
                ST_GeometryN(foo.the_geom,  ST_NumGeometries(foo.the_geom)) , -- last from foo
                ST_GeometryN(bar.the_geom,  1) , -- first from bar
                0.00005 ) OR -- precision, depends of your SRID
        ST_DWithin( 
                ST_GeometryN(foo.the_geom,  1) , -- first from foo 
                ST_GeometryN(bar.the_geom,  1) , -- first from bar
                0.00005 ) ) -- precision, depends of your SRID 
```

瞧……！您可以将此链接保存在新表中，并使用 ST_Union 连接链接的段。

# delphi - 如何用 SSE2 优化这个 Delphi 函数？

> ID：10126198
> 
> 赞同：3
> 
> 时间：2012-04-12T14:57:28.383
> 
> 标签：delphi, assembly, x86, sse2, basm

我需要一个提示，如何使用 SSE2 程序集（32 位）实现这个 Delphi 函数。也欢迎其他优化。也许有人可以告诉我，可以使用什么样的指令，所以我有一个进一步阅读的起点。

实际的：

```
const Precision = 10000;

// This function adds all Pixels into one. The pixels are weighted before adding. 
// A weight can range from 0 to "Precision". "Size" is typically 10 to 50.

function TFilter.Combine(Pixels: PByte; Weights: PCardinal; const Size: Cardinal): Cardinal;
var
  i, R, G, B, A: Cardinal;
begin
  B := Pixels^ * Weights^; Inc(Pixels);
  G := Pixels^ * Weights^; Inc(Pixels);
  R := Pixels^ * Weights^; Inc(Pixels);
  A := Pixels^ * Weights^; Inc(Pixels);
  Inc(Weights); // goto next weight
  for i := 1 to Size - 1 do
  begin
    Inc(B, Pixels^ * Weights^); Inc(Pixels);
    Inc(G, Pixels^ * Weights^); Inc(Pixels);
    Inc(R, Pixels^ * Weights^); Inc(Pixels);
    Inc(A, Pixels^ * Weights^); Inc(Pixels);
    Inc(Weights); // goto next weight
  end;
  B := B div Precision;
  G := G div Precision;
  R := R div Precision;
  A := A div Precision;

  Result := A shl 24 or R shl 16 or G shl 8 or B;
end; 
```

预期的：

```
function TFilter.Combine(Pixels: PByte; Weights: PCardinal; const Size: Cardinal): Cardinal;
asm
  // Insert fast SSE2-Code here ;-)
end; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-13T05:36:39.943

相当简单的实现。我已经更改了您的函数原型 - 常规函数（针对对象方法）。

此代码的运行速度比逐字节函数快约 3 倍（在 256 元素阵列上 1000000 次迭代需要 1500 毫秒，在我的旧 Athlon XP 2.2 GHz 上大约为 0.7 GB/秒）

```
function Combine(Pixels: PByte; Weights: PInteger; const Size: Cardinal): Integer;
//x86, register calling convention - three parameters in EAX, EDX, ECX
const
  Precision: Single = 1.0;
asm
  pxor XMM6, XMM6 //zero const
  pxor XMM4, XMM4 // zero accum

@@cycle:
  movd XMM1, [eax] //load color data
  movss XMM3, [edx]  //load weight

  punpcklbw XMM1, XMM6 //bytes to words
  shufps XMM3, XMM3, 0 // 4 x weight
  punpcklwd XMM1, XMM6 //words to ints
  cvtdq2ps XMM2, XMM3  //ints to singles
  cvtdq2ps XMM0, XMM1  //ints to singles

  mulps XMM0, XMM2    //data * weight
  addps XMM4, XMM0    //accum  = accum + data * weight

  add eax, 4        // inc pointers
  add edx, 4
  loop @@cycle

  movss XMM5, Precision
  shufps XMM5, XMM5, 0 // 4 x precision constant

  divps XMM4, XMM5    //accum/precision

  cvtps2dq XMM2, XMM4  //rounding singles to ints
  packssdw XMM2, XMM2 //ints to ShortInts
  packuswb XMM2, XMM2  //ShortInts to bytes

  movd eax, XMM2  //result
end; 
```

# objective-c - 当 UIView 框架更改时，视图内的 AVPlayer 层不会调整大小

> ID：10126200
> 
> 赞同：59
> 
> 时间：2012-04-12T14:57:31.270
> 
> 标签：objective-c, uiview, calayer, avplayer

我有一个`UIView`包含一个`AVPlayer`来显示视频的内容。更改方向时，我需要更改视频的大小和位置。

我对调整图层大小不是很有经验，所以我在调整视频大小时遇到​​了问题。

我首先创建`AVPlayer`并将其播放器添加到我的 videoHolderView 层：

```
NSURL *videoURL = [NSURL fileURLWithPath:videoPath];
self.avPlayer = [AVPlayer playerWithURL:videoURL];

AVPlayerLayer* playerLayer = [AVPlayerLayer playerLayerWithPlayer:self.avPlayer];
playerLayer.frame = videoHolderView.bounds;
playerLayer.videoGravity = AVLayerVideoGravityResizeAspect;
playerLayer.needsDisplayOnBoundsChange = YES;

[videoHolderView.layer addSublayer:playerLayer];
videoHolderView.layer.needsDisplayOnBoundsChange = YES; 
```

然后，稍后，我更改了 videoHolderView 框架的大小和位置：

```
[videoHolderView setFrame:CGRectMake(0, 0, 768, 502)]; 
```

此时，我需要将 avPlayer 调整为这些相同的尺寸。这不会自动发生 - avPlayer 在 vi​​deoHolderView 中保持较小的尺寸。

如果有人可以提供帮助，我将非常感谢任何建议。

多谢你们。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2015-04-13T22:33:18.920

```
 playerLayer.videoGravity = AVLayerVideoGravityResizeAspectFit; 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2017-01-16T18:03:22.200

将@Suran 的解决方案转换为 Swift：

首先，创建一个继承 UIView 的类，您只覆盖 1 个变量：

```
import UIKit
import AVFoundation

class AVPlayerView: UIView {
    override class var layerClass: AnyClass {
        return AVPlayerLayer.self
    }
} 
```

然后使用界面生成器添加一个简单的 UIView 并将其类更改为您刚刚创建的类：AVPlayerView

[![将常规 UIView 的类更改为 AVPlayerView](../Images/e5dcc22de8f5d0c1e7d76c26ef324722.png)](https://i.stack.imgur.com/mHQkM.png)

然后，为该视图创建一个出口。称之为 avPlayerView

```
@IBOutlet weak var avPlayerView: AVPlayerView! 
```

现在，您可以在 viewcontroller 中使用该视图并像这样访问它的 avlayer：

```
let avPlayer = AVPlayer(url: video)
let castLayer = avPlayerView.layer as! AVPlayerLayer
castLayer.player = avPlayer
avPlayer.play() 
```

该层现在将像常规层一样遵循约束。无需手动更改边界或大小。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2015-01-26T14:01:51.073

实际上，您不应该将 AVPlayer 的图层添加为子图层。取而代之的是，您应该在要显示 AVPlayer 的视图的子类中使用以下方法。

```
+ (Class)layerClass
{
     return [AVPlayerLayer class];
} 
```

并使用以下行添加（设置）播放器层。

```
[(AVPlayerLayer *)self.layer setPlayer:self.avPlayer]; 
```

希望能帮助到你;-）

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-04-17T17:21:24.190

最后我通过将 AVPlayerLayer 重新添加到 UIView 解决了这个问题。我不确定为什么更改框架会删除图层，但确实如此。这是最终的解决方案：

```
//amend the frame of the view
[videoHolderView setFrame:CGRectMake(0, 0, 768, 502)];

//reset the layer's frame, and re-add it to the view
AVPlayerLayer* playerLayer = [AVPlayerLayer playerLayerWithPlayer:self.avPlayer];
playerLayer.frame = videoHolderView.bounds;
[videoHolderView.layer addSublayer:playerLayer]; 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2017-08-02T12:06:35.703

找到 Marco Santarossa 的一篇很棒的文章，其中展示了多种修复方法。[https://marcosantadev.com/calayer-auto-layout-swift/](https://marcosantadev.com/calayer-auto-layout-swift/)

我使用他的第一个建议在 viewDidLayoutSubViews() 事件期间重置图层框架。

```
override func viewDidLayoutSubviews() {
    super.viewDidLayoutSubviews()
    playerLayer.frame = view.layer.bounds
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-10-10T22:11:47.807

您可以通过覆盖以下`-layoutSubviews`方法来更改图层的框架：

```
- (void)layoutSubviews
{
    [super layoutSubviews];
    self.playerLayer.frame = self.bounds;
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2019-09-19T09:26:39.417

在 Swift 4 中使用

```
 playerLayer.videoGravity = AVLayerVideoGravity.resizeAspectFill 
```

`AVLayerVideoGravity`或您想要的任何财产。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-01-22T15:43:29.447

theDunc 的回答对我不起作用。我找到了一个更简单的解决方案：我只需要在 UIView 中更改 AVPlayerLayer 的框架后调整它：

```
avPlayerLayer.frame = CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height); 
```

在[这篇博客](http://raptureinvenice.com/ios-brownbag-view-vs-layers-including-clock-demo/)中声明，视图的框架也会影响其中的层。

> 当您更改视图的框架时，它只是更改了图层的框架。

对于这种情况，这是不正确的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-09-13T14:37:08.333

我在 Swift 2.3 中遇到了这个问题，我解决了编写一个适当的 PlayerView 类并将其设置为子视图的问题：

```
import UIKit
import AVKit
import AVFoundation

class PlayerPreviewView: UIView {

    override class func layerClass() -> AnyClass {
        return AVPlayerLayer.self
    }

    var player: AVPlayer? {
        get {
            return playerLayer.player
        }

        set {
            playerLayer.player = newValue
        }
    }

    var playerLayer: AVPlayerLayer {
        return layer as! AVPlayerLayer
    }

    override init(frame: CGRect) {
        super.init(frame: frame)
        playerLayer.videoGravity = AVLayerVideoGravityResize
    }

    required init?(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        playerLayer.videoGravity = AVLayerVideoGravityResize
    }

} 
```

在呈现的 ViewController 中：

```
private func play(asset asset: AVURLAsset){
    let playerItem = AVPlayerItem(asset: asset)

    player = AVPlayer(playerItem: playerItem)
    player?.actionAtItemEnd = .None
    player?.muted = true

    playerPreviewView = PlayerPreviewView(frame: CGRectZero)
    view.addSubview(playerPreviewView)
    playerPreviewView.player = player

    playerPreviewView.translatesAutoresizingMaskIntoConstraints = false
    view.addConstraints(NSLayoutConstraint.constraintsWithVisualFormat("H:|-0-[subview]-0-|", options: .DirectionLeadingToTrailing, metrics: nil, views: ["subview": playerPreviewView]))
    view.addConstraints(NSLayoutConstraint.constraintsWithVisualFormat("V:|-0-[subview]-0-|", options: .DirectionLeadingToTrailing, metrics: nil, views: ["subview": playerPreviewView]))

    player?.play()

    NSNotificationCenter.defaultCenter().addObserver(self,
                                                     selector: #selector(SplashScreenViewController.videoDidFinish),
                                                     name: AVPlayerItemDidPlayToEndTimeNotification,
                                                     object: nil)
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-12T15:14:41.177

第一步：在 UIVIew.h 中查看 UIView 的 autoresizing 属性

> @property(nonatomic) UIViewAutoresizing autoresizingMask; // 简单的调整大小。默认是 UIViewAutoresizingNone

这个属性对应于 IB 中的“springs and struts”控件，尽管它需要你进行一些实验才能得到你想要的结果。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-07-20T22:32:14.640

要到达`playerLayer`，您需要遍历`videoHolderView.layer.sublayers`并更改每一个。

这就是我在 Swift 2.2 中所做的

```
if let sublayers = videoHolderView.layer.sublayers{
    for layer in sublayers where layer is AVPlayerLayer{
        layer.frame.size = ... // change size of the layer here
    }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-05-21T01:54:59.933

对于那些只关心在设备旋转期间调整 AVPlayer 大小的人，您可以在 viewWillTransition(to size: CGSize, with coordinator: UIViewControllerTransitionCoordinator) 方法中更改图层框架，如下所示。

```
//Swift 4
//Method in UIViewController
//Variable definitions are:
//self.layer is the AVPlayerLayer
//self.videoPlayerView is the view that the AVPlayerLayer is the sublayer of
override func viewWillTransition(to size: CGSize, with coordinator: UIViewControllerTransitionCoordinator) {
    super.viewWillTransition(to: size, with: coordinator)
    coordinator.animate(alongsideTransition: { context in
        self.layer.layoutIfNeeded()
        UIView.animate(
            withDuration: context.transitionDuration,
            animations: {
                self.layer.frame = self.videoPlayerView.bounds
            }
        )
    }, completion: nil)
} 
```

这将在旋转期间为您的图层框架以及所有其他视图设置动画。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-08-13T18:01:44.943

在我搜索时搜索 Xamarin 版本的任何人

不要将 AVPlayerLayer 添加为子图层，而是将图层设置为 Avplayer 图层

```
[Export("layerClass")]
public static Class LayerClass()
{
    return new Class(typeof(AVPlayerLayer));
} 
```

以下行设置图层

```
(this.Layer as AVPlayerLayer).Player = _player;   // Acplayer 
```

# android - 应用程序启动时的日期更改检测 - Android

> ID：10126201
> 
> 赞同：1
> 
> 时间：2012-04-12T14:57:31.580
> 
> 标签：android, date, android-intent, alarmmanager

我是 Android 编程的新手，在这个论坛上可能会在几秒钟内解决一个挑战。

我试图弄清楚如何在启动期间启用应用程序以检测自上次启动以来日期是否已更改。

当日期更改时，我打算更改 textview 中的值。但是，如果没有，则 textview 不会改变。- 我知道如何创建此功能，但遇到日期更改问题？

我已经阅读了alarmmanager，但不确定这是必需的，因为它不需要仅在启动期间的特定时间发生。

任何建议将不胜感激。

谢谢，

ps 我正在创建一个基本的报价应用程序，并希望包含当天页面的报价。为此，我需要知道日期是否已更改，以便应用程序更改报价

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T15:06:38.437

您将需要的是：
一个[`SharedPreference`](http://developer.android.com/reference/android/content/SharedPreferences.html)描述最后日期的长值。
一个[`Calendar`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html)。

当您的 Activity 开始时（在`onCreate()`Method 中似乎是这样做的好地方），您可以获得一个新的`Calendar`. 它将具有当前日期，您可以提取日期：

```
Calendar c = Calendar.getInstance();
int thisDay = c.get(Calendar.DAY_OF_YEAR); //You can chose something else to compare too, such as DATE..
long todayMillis = c.getTimeInMillis(); //We might need this a bit later. 
```

然后，您从上次读取可能保存的值并将日历设置为该值，然后将其与今天进行比较：

```
SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
long last = prefs.getLong("date", 0); //If we don't have a saved value, use 0.
c.setTimeInMillis(last);
int lastDay = c.get(Calendar.DAY_OF_YEAR);

if( last==0 || lastDay != thisDay ){
    //New day, update TextView and preference:
    SharedPreferences.Editor edit = prefs.edit();
    edit.putLong("date", todayMillis);
    edit.commit();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:02:41.510

在应用程序启动时执行此操作：

```
SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this)

if (prefs.getBoolean("firstLaunch", true))
{
    SharedPreferences.Editor editor = prefs.edit();
    editor.putBoolean("firstLaunch", false);
    editor.putInt("date", new Date().getTime());
    editor.commit();
}
else
{
    if (new Date().getTime() != prefs.getInt("date", 0))
    {
            // Do something
    }
} 
```

# javascript - phantomjs 的受控异步退出

> ID：10126205
> 
> 赞同：8
> 
> 时间：2012-04-12T14:57:56.363
> 
> 标签：javascript, testing, asynchronous, phantomjs

我正在尝试使用 phantomjs 进行一些测试......基本上我想：

*   在我的网络服务器上打开一个页面
*   页面初始化后（所有页面 js 已加载）
*   从phantomjs调用页面js并测试结果
*   退出 phantomjs

phantomjs 似乎很难注意到页面何时加载。

我可以使用 phantomjs 在窗口或其他东西上设置一个“测试”变量，以便页面 js 可以检查它，然后在完成后调用回调。问题是回调只能是页面回调，所以它不能做任何页面不能做的事情。

这对苔丝来说可能没问题，但最后一步是不可能的。

我想出了这个：

```
page.onConsoleMessage = function(msg) {
  if (msg == "__quit__") {
    phantom.exit();
  }
  else {
    console.log("page: " + msg);
  }
};

page.evaluate(function () { 
  window.quit = function () { console.log("__quit__"); };
}); 
```

所以页面代码可以调用window.quit()，然后控制台监视器可以杀死幻影。不过，这似乎有点 hacky。有没有人有更好的方法呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T16:53:13.750

免责声明：这是未经测试的代码

您可能能够附加到网页对象的 onLoadFinished 回调。这在 PhantomJS 的范围内执行，因此您将拥有所有可用的变量。

像这样的东西就足够了：

```
page.onLoadFinished = function(){
   page.evaluate(function() {
//call your testing code here
   });

phantom.exit();
} 
```

# java - 没有关注应用程序窗口的关键听众

> ID：10126206
> 
> 赞同：0
> 
> 时间：2012-04-12T14:57:57.993
> 
> 标签：java, focus, jna, keystrokes

我正在尝试使用主要依赖于击键的java制作一个应用程序，我遇到的问题是重点应该放在我的应用程序的框架/组件上以实现其功能，但我需要它在后台工作而不需要要关注的应用程序。有没有办法实现这一点而不是使用 JNA ？

# lisp - 在 Windows 7 上使用 clisp 的 quicklisp 问题

> ID：10126209
> 
> 赞同：5
> 
> 时间：2012-04-12T14:58:23.577
> 
> 标签：lisp, common-lisp, slime, clisp, quicklisp

我在 Windows 7 上安装了 quicklisp/slime/clisp。当我使用 启动 slime 时`M-x slime`，我收到了这个错误消息。

![在此处输入图像描述](../Images/101e31ba5bb510475d779cccec974e94.png)

我可以输入“继续”来启动 clisp/slime，但是每当我启动 slime 时都会弹出此消息。这有什么问题？我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T16:56:52.303

我使用了 clisp 2.44 ，它对于 quicklisp 来说已经过时了，当我安装和使用[2.49](http://sourceforge.net/projects/clisp/files/latest/download)时，问题就消失了。

看[`EXT:PROBE-PATHNAME`](http://www.clisp.org/impnotes/dir-is-not-file.html)

# sql-server-2008 - 在动态查询中按日期和时间比较两个日期时间

> ID：10126212
> 
> 赞同：-6
> 
> 时间：2012-04-12T14:58:32.707
> 
> 标签：sql-server-2008, tsql, datetime, compare

我正在尝试比较两个日期时间，但它在动态查询中不起作用。为什么部分时间不起作用？我的代码是这些

```
 ALTER PROCEDURE [dbo].[testdate]    
    @startDate datetime = null  ,
    @endDate datetime = null,
    @TableName nvarchar(100) ,
    @SearchString NVARCHAR(200)
AS
BEGIN   
    SET NOCOUNT ON; 
    declare @sqlcmd nvarchar(max)

    set  @sqlcmd= 'select * from '+@TableName  +' where '   
    if @startDate is not null and @endDate is not null
    begin

        /*set @sqlcmd=@sqlcmd + ' ( DateLog between'''
        + convert (nvarchar(50), @startDate, 101)
        +''' and ''' 
        --+ convert (nvarchar(50),DATEADD(D,1, @endDate), 101)
        + convert (nvarchar(50), @endDate, 101)
        + ''' ) and '   
        */
        set @sqlcmd=@sqlcmd + ' ( DateLog between @startDate and @endDate ) and '

    end     

    set @sqlcmd=@sqlcmd + '('
    SELECT 
            @sqlcmd  = @sqlcmd + '  [' + SYSCOLUMNS.NAME + '] LIKE N''%'+@SearchString+'%'' or '    
            FROM SYSCOLUMNS 
            WHERE OBJECT_NAME(id) =  @TableName AND TYPE_NAME(SYSCOLUMNS.XTYPE) IN ('VARCHAR','NVARCHAR','CHAR','NCHAR','INT','DECIMAL')

        set @sqlcmd  = @sqlcmd  + '1<>1)'                           
    --print @sqlcmd                                             
    Exec(@sqlcmd)
END 
```

我的表 AccountLog 有这些字段和数据

```
 UserName     DateLog
     Salah        2012-04-06 22:06:19.493
     John         2012-08-06 22:06:22.800 
```

这个查询是真的

```
 select * from AccountLog where DateLog between '2012-04-06T22:06:19' and '2012-08-06T22:06:23' 
```

但是这个查询没有给我适当的结果

```
declare @a datetime
declare @b datetime 
set @a = '2012-04-06T22:06:19'  
set @b = '2012-08-06T22:06:23'
exec testdate @a,@b,'AccountLog',N'test' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:19:13.143

您应该使用强类型参数并完全抛弃任何转换为​​ nvarchar 的废话。

**EDIT**更新了更多需求更改。

```
ALTER PROCEDURE [dbo].[testdate]    
  @startDate    DATETIME = NULL,
  @endDate      DATETIME = NULL,
  @TableName    NVARCHAR(100),
  @SearchString NVARCHAR(200)
AS
BEGIN 
  SET NOCOUNT ON;

  DECLARE @sql NVARCHAR(MAX);
  SET @sql = N'SELECT * FROM dbo.' + QUOTENAME(@TableName) 
    + ' WHERE (1 = 0 ';

  SELECT @sql = @sql + ' OR ' + QUOTENAME(name) + ' LIKE N''%'+@SearchString+'%'''  
    FROM sys.columns WHERE [object_id] = OBJECT_ID('dbo.' + @TableName)
    AND system_type_id IN (56,106,167,175,231,239);

  SET @sql = @sql + ')';

  IF @startDate IS NOT NULL AND @endDate IS NOT NULL
  BEGIN
    SET @sql = @sql + ' AND DateLog BETWEEN @s AND @e';
  END

  EXEC sp_executesql @sql, N'@s DATETIME, @e DATETIME', @startDate, @endDate;
END
GO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T16:38:43.217

您将日期和时间传递给您的过程，但是当您将它们转换为动态 SQL 时，您使用的是格式 101，它删除了时间部分。尝试将 101 更改为 126（您的代码中有 2 个地方使用了 101，请确保同时更改它们。

# jquery - jQuery 动画受 Chrome 中的 window.print() 影响？

> ID：10126216
> 
> 赞同：1
> 
> 时间：2012-04-12T14:58:38.210
> 
> 标签：jquery, google-chrome, printing, jquery-animate

这只能在 chrome 中观察到，其他浏览器似乎都没有这个问题。

[jsFiddle 示例](http://jsfiddle.net/DN9kQ/6/embedded/result/)

[打印链接内容](http://jsfiddle.net/y5Egb/)

基本上，我有一个 div 包含一堆我想显示的项目，但一次只有一个，所以我创建了一个带有溢出的 div：隐藏和默认高度。现在点击 jquery animate 以在单击 div 时循环到另一个 div，一切正常，直到我添加打印链接。如果我单击示例页面中的打印链接，只要 chrome 打印预览窗口保持打开状态，它就会破坏动画。关闭预览后，一切都恢复正常。有人知道发生了什么吗？

# c# - 虚拟模式下 ListView 中的分组

> ID：10126221
> 
> 赞同：3
> 
> 时间：2012-04-12T14:58:46.837
> 
> 标签：c#, winforms

我正在使用虚拟列表视图并向其中添加了一些项目，但现在我想将它们分配给一个组。

例如在执行 RetrieveVirtualItem 时如何执行此操作。// 只是我的观点

我正在使用视觉工作室 2010

我想使用本机列表视图，并且我处于无法使用 3rd 方组件的位置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T15:13:08.640

正式地，您不能在`Virtual`模式下使用组。[CLR 2.0 虚拟列表视图](http://blogs.msdn.com/b/cumgranosalis/archive/2006/03/06/virtuallistviewusage.aspx)

然而，这个项目使用了一个未记录的特性（在 Vista 和更高版本上），它可以在`Virtual`模式下启用组。[对象列表视图](http://objectlistview.sourceforge.net/cs/features.html#groups-on-virtual-lists)

# javascript - Javascript：跳入溢出环境的特定部分？

> ID：10126224
> 
> 赞同：0
> 
> 时间：2012-04-12T14:58:50.183
> 
> 标签：javascript

我有一个充满文本的环境。这意味着浏览器会在它旁边创建一个小滑块，使用户能够滚动环境。我的问题是是否可以使用一些 JS 魔法使浏览器“跳转”到文本的特定部分；例如，用户按下一个按钮，滑块一直向下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:07:01.010

您可以使用直接的 HTML 或 javascript 来执行此操作。

**HTML**

点击链接

```
<a href="#Test">Click Here</a> 
```

把它放在你想跳的地方

```
<div id="Test">Content to jump too</div> 
```

**Javascript**

您也可以使用[javascript scrollTo](http://www.w3schools.com/jsref/met_win_scrollto.asp)函数执行此操作

```
window.scrollTo(100,500); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:05:06.703

您可以使用简单的 html 来实现：

```
<a href="#foo">Click here to scroll down to section "foo"</a>
...
<a name="#foo">Section "foo"</a> 
```

我在下面的链接中包含了一个示例：http: [//jsfiddle.net/C9Qj5/](http://jsfiddle.net/C9Qj5/)

# salesforce - 如何将应用程序可见性设置从沙盒中的配置文件部署到生产组织？

> ID：10126227
> 
> 赞同：3
> 
> 时间：2012-04-12T14:58:54.600
> 
> 标签：salesforce

我已经更改了我的沙盒组织中用户配置文件的应用程序的可见性，我想将这些更改部署到生产组织。我找不到办法做到这一点，但知道我一定错过了一些东西。有谁知道怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-13T01:37:25.040

您可以为此使用更改集。对于您部署的任何组件，您可以选择同时为部分或所有配置文件部署配置文件权限。请注意，仅部署与更改集中的组件相关的权限。另请注意，如果您包含配置文件的配置文件设置，该配置文件存在于您的 Sandbox 中，但不存在于您的生产组织中，则会出现错误。

*   设置->部署->出站更改集
*   命名更改集，单击保存
*   在变更集组件下将应用程序添加到变更集
*   在个人资料设置下添加您想要更新权限的任何个人资料

当前变更集不支持标准应用程序。但是，这可以通过元数据 API 来完成，它增加了使用 v29 检索标准应用程序的能力。您可以使用列表元数据 api 调用来检索标准应用程序的名称，这些名称通常采用以下形式`standard__<AppName>`，例如`standard__Sales`. 如果您检索应用程序以及要更改权限的配置文件，则可以部署这些设置。请注意，这还将在源组织中部署对该应用程序的任何更改以及任何常规配置文件权限（即 loginIpRanges、启用 API 等）。

示例包.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<Package xmlns="http://soap.sforce.com/2006/04/metadata">
    <types>
        <members>standard__Sales</members>
        <name>CustomApplication</name>
    </types>
    <types>
        <members>MyProfile</members>
        <name>Profile</name>
    </types>
    <version>33.0</version>
</Package> 
```

示例检索到的配置文件 xml

```
<?xml version="1.0" encoding="UTF-8"?>
<Profile xmlns="http://soap.sforce.com/2006/04/metadata">
    <applicationVisibilities>
        <application>standard__Sales</application>
        <default>false</default>
        <visible>false</visible>
    </applicationVisibilities>
    <custom>true</custom>
    <loginIpRanges>
        <endAddress>255.255.255.255</endAddress>
        <startAddress>0.0.0.0</startAddress>
    </loginIpRanges>
    <userLicense>Salesforce</userLicense>
    <userPermissions>
        <enabled>true</enabled>
        <name>ActivateContract</name>
    </userPermissions>
    <userPermissions>
        <enabled>true</enabled>
        <name>ApiEnabled</name>
    </userPermissions>
    <!-- truncated for brevity -->
</Profile> 
```

# javascript - JS node-mysql bools 行为怪异

> ID：10126228
> 
> 赞同：0
> 
> 时间：2012-04-12T14:58:58.407
> 
> 标签：javascript, node.js, socket.io, node-mysql

我有这个函数，我需要返回 true 或 false。问题是，它的行为似乎不正确。如果它确实返回 false，它不会断开客户端，如果它返回 true，它仍然会执行“console.log('Disconnecting client...')” 我完全迷失了。:(这是针对node.js mysql和socket.io的

代码：

```
if(!client_to_server_00(header,data,len)){
    // should send the server a packet to terminate the connection on
               their end...
    // It should send 0x00 SERVER->CLIENT (will implement later)
    console.log('Disconnecting client...'); // This always shows no matter what
    client.emit('disconnect');  // **This does not work!
}else{
    console.log('ID VERIFIED!  WELCOME!');
 } 
```

==================================================== =================================

```
// LOGIN INFORMATION
function client_to_server_00(header, data, len){
// We are already connected to the database
var z = decodeFromHex(data);    // find the username
z = returnvalue(z,1,len);       // the code was a little off (ill fix it later)
console.log(z);                 // make sure we have this correct

// In this example.  The database returns 'oh'  And z = 'oh'

client.query('USE '+TEST_DATABASE);

client.query(
 'SELECT * FROM '+TEST_TABLE,
function selectCb(err, results, fields) {
if (err) {
  throw err;
}
var first = results[0];
console.log('USRNAME: ['+first['name']+']');  // Make sure we have it

if(first['name'] == z){
console.log('Correct');
return true;                    // I need client_to_server_00 function to return true if correct
}else{
console.log('Incorrect');
return false;                   // I need client_to_server_00 function to return false if incorrect
}

})
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:19:22.363

这是很常见的错误。您缺少异步编程的非常基本的概念 - 您必须将回调传递给您的`client_to_server_00`函数并在完成异步内容（在这种情况下为数据库连接）时调用它。

# prolog - 在 SWI-Prolog 中创建保存状态

> ID：10126231
> 
> 赞同：3
> 
> 时间：2012-04-12T14:59:10.207
> 
> 标签：prolog, swi-prolog

我正在尝试从 Windows 的顶层创建已保存的状态，但我不断收到此错误：

```
1 ?- qsave_program('U:/boo64.prc').
%   library(broadcast) compiled into broadcast 0.00 sec, 7,504 bytes
%   library(debug) compiled into prolog_debug 0.00 sec, 21,544 bytes
%   library(option) compiled into swi_option 0.00 sec, 14,416 bytes
%   library(arithmetic) compiled into arithmetic 0.00 sec, 33,872 bytes
%  library(settings) compiled into settings 0.00 sec, 120,152 bytes
% c:/program files/swi-prolog/library/listing compiled into prolog_listing 0.00 sec, 180,936 bytes
%   library(occurs) compiled into occurs 0.00 sec, 5,144 bytes
%  library(prolog_clause) compiled into prolog_clause 0.00 sec, 61,544 bytes
% c:/program files/swi-prolog/library/prolog_stack compiled into prolog_stack 0.00 sec, 77,320 bytes
ERROR: '$mark_executable'/1: file `U:/boo64.prc' does not exist (No such file or directory)
2 ?- 
```

我认为这应该这样做。为什么它甚至试图调用'mark_executable'？我想要的只是一个可以从嵌入式 C/C++ 应用程序加载的资源文件。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:30:28.177

SWI-Prolog 文档`qsave_program`简洁且难以理解，但请 [从这里开始](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%272.10%27,swi%28%27/doc/Manual/compilation.html%27%29%29)。最后两节，**创建保存状态**和**使用 -c 命令行选项编译**至少会给你一个例子来尝试。

我认为这里的问题是使用 1 参数版本`qsave_program`强制程序状态不仅作为资源保存，而且作为附加到机器相关可执行文件 Prolog 模拟器末尾的资源。Windows 上的此类文件需要`.exe`扩展名，但您正试图强制`.prc`扩展名。

从示例中，我将尝试使用 atom`boo64`作为您的*File*参数。如果您想从程序保存状态中删除模拟器，或检查该资源，请查看[本页](http://www.swi-prolog.org/pldoc/doc_for?object=section%281,%2710%27,swi%28%27/doc/Manual/runtime.html%27%29%29)底部链接的部分。

# mysql - MYSQL GROUP BY / ORDER BY 混淆

> ID：10126233
> 
> 赞同：0
> 
> 时间：2012-04-12T14:59:12.970
> 
> 标签：mysql, sql, group-by, sql-order-by

我正在尝试对结果进行排序，但我的语句顺序被忽略了......我明白为什么但不知道如何解决它。这是我的代码：

```
SELECT 
    result.station_id as 'Station ID',
    result.date as 'Date',
    result.id as 'ID',
    COALESCE(sum(if(result.parameter = '1', result.result, NULL)),'-') as 'RESULT A)',
    COALESCE(sum(if(result.parameter = '2', result.result, NULL)),'-') as 'RESULT B)',
FROM (  
    SELECT
        event.station_id,
        event.date,
        event.id,
        e_result.result
    FROM event
    Inner Join e_result ON e_result.id = event.id
    WHERE 
         (event.station_id =  '0001') AND `devent`.`date` >= '1999-02-08' AND `event`.`date` <= '2011-12-20') as result 
GROUP BY by result.id
ORDER BY 
     result.station_id ASC, 
     result.date DESC 
```

它正在正确分组，但之后没有对结果进行排序......似乎正在对分组进行排序。我需要在分组完成后对整个结果集（不是每个分组）进行排序

样本输出：

```
Station Date        ID          Result A    Result B
20      7/6/2009    g003        -           3
12      2/8/1999    g000        19.2        -
12      2/8/1999    g001        19.9        -
12      2/14/1999   g002        19.1        -
17      4/9/2003    i001        22.2        4 
```

应该

```
Station Date        ID          Result A    Result B
12      2/14/1999   g002        19.1        -
12      2/8/1999    g000        19.2        -
12      2/8/1999    g001        19.9        -
17      4/9/2003    i001        22.2        4
20      7/6/2009    g003        -           3 
```

表：

```
e_result   id, parameter, result
     g002, 1, 19.1
     g000, 1, 19.2
     g001, 1, 19.9
     i001, 1, 22.2
     i001, 2, 4
     g003, 2, 3

event      station_id, date, id
     20, 7/16/2009, g003
     12, 2/8/1999, g000
     12, 2/8/1999, g001
     12, 2/14/1999, g002
     17, 4/9/2003, i001 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T16:07:42.433

好吧，我看你不明白它是如何`group by`工作的。当您分组时，您会丢失单个记录并将它们放在一个包中，这允许您执行聚合函数，例如`count`、`sum`等。因此，根据经验，如果您选择非聚合字段，那么你应该把它放在`group by`从句中。

在您的示例中，您没有使用任何聚合函数，那么为什么要分组？

此外，您在数据类型方面遇到问题。您`station_id`在查询中似乎是一个字符串，而在输出中似乎是一个整数。相反，你的约会发生了。我敢打赌，您正在使用字符字段而不是这些字段的适当数据类型，并且您将它们作为字符字段排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T17:44:13.840

我已将您的查询放入 sqlfiddle，但必须进行大量调整才能使其正常工作。

这是一个产生您想要的结果的查询：

```
select result.station_id as 'Station ID',
    date_format(result.date,'%c/%m/%Y') as 'Date',
    result.id as 'ID',
    if (sum(if(result.parameter = 1, result.result,0)) = 0, 
        null, 
        sum(if(result.parameter = 1, result.result,0)))  as 'RESULT A)',
    if (sum(if(result.parameter = 2, result.result,0)) = 0, 
        null, 
        sum(if(result.parameter = 2, result.result,0)))  as 'RESULT B)'
from 
      (SELECT
        event.station_id,
        event.date,
        event.id,
        e_result.result,
        e_result.parameter
      FROM event
      Inner join e_result ON e_result.id = event.id) as result
group by 
     result.station_id, result.date, result.id
order by 
     result.station_id ASC, 
     result.date DESC; 
```

我重新设计了合并，删除了内表结果中的 where 子句，更正了“devent”错字，将参数字段添加到内表。还有一些其他的东西

这给出了：

```
STATION ID    DATE         ID      RESULT A    RESULT B
12            2/02/1999    g002    19.1    
12            2/02/1999    g000    19.2    
12            2/02/1999    g001    19.9    
17            4/04/2003    i001    22.2        4
20            7/07/2009    g003                3 
```

都在这里： [http ://sqlfiddle.com/#!2/34d87/17](http://sqlfiddle.com/#!2/34d87/17)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:10:42.823

您的查询很好，但最后缺少最后一个功能：

```
GROUP BY
 result.station_id 
```

# python - 使用 telnetlib 实时读取输出

> ID：10126239
> 
> 赞同：9
> 
> 时间：2012-04-12T14:59:27.423
> 
> 标签：python, telnetlib

我正在使用 Python 的 telnetlib 远程登录到某些机器并执行一些命令，我​​想获得这些命令的输出。

那么，目前的情况是——

```
tn = telnetlib.Telnet(HOST)
tn.read_until("login: ")
tn.write(user + "\n")
if password:
    tn.read_until("Password: ")
    tn.write(password + "\n")

tn.write("command1")
tn.write("command2")
tn.write("command3")
tn.write("command4")
tn.write("exit\n")

sess_op = tn.read_all()
print sess_op
#here I get the whole output 
```

现在，我可以在 sess_op 中获得所有合并的输出。

但是，我想要的是在 command1 执行之后和 command2 执行之前立即获取它的输出，就好像我在另一台机器的 shell 中工作一样，如下所示 -

```
tn = telnetlib.Telnet(HOST)
tn.read_until("login: ")
tn.write(user + "\n")
if password:
    tn.read_until("Password: ")
    tn.write(password + "\n")

tn.write("command1")
#here I want to get the output for command1
tn.write("command2")
#here I want to get the output for command2
tn.write("command3")
tn.write("command4")
tn.write("exit\n")

sess_op = tn.read_all()
print sess_op 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-10T18:05:09.663

我在使用 telnetlib 时遇到了类似的问题。

然后我意识到每个命令末尾缺少回车和换行，并为所有命令执行了 read_eager。像这样的东西：

```
 tn = telnetlib.Telnet(HOST, PORT)
 tn.read_until("login: ")
 tn.write(user + "\r\n")
 tn.read_until("password: ")
 tn.write(password + "\r\n")

 tn.write("command1\r\n")
 ret1 = tn.read_eager()
 print ret1 #or use however you want
 tn.write("command2\r\n")
 print tn.read_eager()
 ... and so on 
```

而不是只编写如下命令：

```
 tn.write("command1")
 print tn.read_eager() 
```

如果它只为您使用“\n”，则仅添加一个“\n”可能就足够了，而不是“\r\n”，但就我而言，我必须使用“\r\n”而我没有还没有尝试过只换一条新线。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-12T15:24:30.060

[您必须在此处](http://docs.python.org/library/telnetlib.html)参考`telnetlib`模块的文档。 尝试这个 -

```
tn = telnetlib.Telnet(HOST)
tn.read_until("login: ")
tn.write(user + "\n")
if password:
    tn.read_until("Password: ")
    tn.write(password + "\n")

tn.write("command1")
print tn.read_eager()
tn.write("command2")
print tn.read_eager()
tn.write("command3")
print tn.read_eager()
tn.write("command4")
print tn.read_eager()
tn.write("exit\n")

sess_op = tn.read_all()
print sess_op 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-17T07:24:01.120

我也遇到了 read_very_eager() 函数没有显示任何数据的相同问题。从一些帖子中得到了该命令需要一些时间来执行的想法。所以使用了 time.sleep() 函数。

代码片段：

```
tn.write(b"sh ip rou\r\n")
time.sleep(10)
data9 = tn.read_very_eager()
print(data9) 
```

# sharepoint-2007 - OleDbConnection 到 MOSS 2007 共享文档中的 Excel 文件

> ID：10126244
> 
> 赞同：0
> 
> 时间：2012-04-12T14:59:34.590
> 
> 标签：sharepoint-2007, c#-3.0, oledb

我需要以编程方式打开存储在 MOSS 2007 共享文档列表中的 Excel 文件。我想使用 OleDbConnection 以便可以将文件的内容作为 DataTable 返回。我相信这是可能的，因为网络上的许多[文章](https://stackoverflow.com/questions/4132160/opening-a-xls-spreadsheet-programatically-in-c-sharp-from-a-sharepoint-site-in-r)都暗示这是可能的。目前我的代码在尝试初始化新连接时失败（oledbConn = new OleDbConnection(_connStringName); 错误消息是：

*初始化字符串的格式不符合从索引 0 开始的规范。*

我相信我只是无法找到文件的正确路径。这是我的代码：

```
 public DataTable GetData(string fileName, string workSheetName, string filePath)
    {   
// filePath == C:\inetpub\wwwroot\wss\VirtualDirectories\80\MySpWebAppName\Shared Documents\FY12_FHP_SPREADSHEET.xlsx
            // Initialize global vars
        _connStringName = DataSource.Conn_Excel(fileName, filePath).ToString();
        _workSheetName = workSheetName;
        dt = new DataTable();
        //Create the connection object
        if (!string.IsNullOrEmpty(_connStringName))
        {
            SPSecurity.RunWithElevatedPrivileges(delegate()
            {
                oledbConn = new OleDbConnection(_connStringName);

                try
                {

                    oledbConn.Open();
                    //Create OleDbCommand obj and select data from worksheet GrandTotals
                    OleDbCommand cmd = new OleDbCommand("SELECT * FROM " + _workSheetName + ";", oledbConn);

                    //create new OleDbDataAdapter
                    OleDbDataAdapter oleda = new OleDbDataAdapter();
                    oleda.SelectCommand = cmd;
                    oleda.Fill(dt);
                }
                catch (Exception ex)
                {
                    System.Diagnostics.Debug.WriteLine(ex.Message);
                }
                finally
                {
                    oledbConn.Close();
                }
            });
        }
        return dt;
    }

        public static OleDbConnection Conn_Excel(string ExcelFileName, string filePath)
    {
// filePath == C:\inetpub\wwwroot\wss\VirtualDirectories\80\MySpWebAppName\Shared Documents\FY12_FHP_SPREADSHEET.xlsx
OleDbConnection myConn = new OleDbConnection();
        myConn.ConnectionString = string.Format(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + filePath + ";Extended Properties=Excel 12.0");
        return myConn;
    } 
```

我做错了什么，还是有更好的方法将 Excel 文件内容作为 DataTable 获取？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T22:13:11.300

我最终使用了开源项目[Excel Data Reader](http://exceldatareader.codeplex.com/)

# java - Java 泛型何时在运行时使用强制转换？

> ID：10126248
> 
> 赞同：6
> 
> 时间：2012-04-12T14:59:41.863
> 
> 标签：java, generics

我正在阅读有关 C++ 模板和 C# 泛型的讨论，以及它们与 Java 的类型擦除泛型有何不同。我读过一个声明，说 Java 在运行时仍然使用强制转换，例如在处理集合时。如果这是真的，我不知道！

假设我有如下代码：

```
ArrayList<SomeClass> list = new ArrayList<SomeClass>();
...
SomeClass object = list.get(0); 
```

我的问题是。这是否有效地编译为

```
ArrayList list = new ArrayList();
...
SomeClass object = (SomeClass) list.get(0); 
```

如果是这样，为什么？我认为 list 是类型`ArrayList<SomeClass>`保证的事实，在编译时和运行时，只有 SomeClass 将存储在 ArrayList 中？或者您是否可以进行不安全的类型转换以将 a`ArrayList<OtherClass>`转换为`ArrayList<SomeClass>`？

在 Java 泛型中是否存在其他运行时类型转换的情况？

最后，如果确实使用了运行时强制转换，是否存在 JIT 可以忽略运行时强制转换检查的情况？

（请不要回答/评论微优化不值得，抢先优化是万恶之源等。我在其他类似问题上看到了这些。这些点很好理解，但它们并没有带走尝试的意义了解类型擦除的泛型是如何在底层实现的。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T15:03:54.837

你的假设是正确的。

类型检查始终是必要的，因为您可以编写以下合法代码：

```
ArrayList<X> good = new ArrayList<X>();
ArrayList q = x;
ArrayList<Y> evil = (ArrayList<Y>)q;  //Doesn't throw due to type erasure
evil.add(new Y()); //this will actually succeed
X boom = good.get(0); 
```

转换from `ArrayList`to`ArrayList<Y>`将（总是）给出未经检查的转换警告，但会（也总是）在运行时成功。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-12T15:12:06.953

这是我写的一个小程序：

```
public class Test<T> {

  public T contents;

  public Test(T item) {
    contents = item;
  }

  public static void main(String[] args) {

    Test<String> t = new Test<String>("hello");
    System.out.println(t.contents);

  }

} 
```

尝试用 编译它`javac`，然后用 . 查看字节码`javap -verbose`。我选择了一些有趣的行：

```
public java.lang.Object contents; 
```

这应该在 Test 构造函数的定义之前出现。在示例代码中它是 T 类型，现在它是一个对象。那是擦除。

现在，查看主要方法：

```
public static void main(java.lang.String[]);
Code:
   Stack=3, Locals=2, Args_size=1
   0:   new #3; //class Test
   3:   dup
   4:   ldc #4; //String hello
   6:   invokespecial   #5; //Method "<init>":(Ljava/lang/Object;)V
   9:   astore_1
   10:  getstatic   #6; //Field java/lang/System.out:Ljava/io/PrintStream;
   13:  aload_1
   14:  getfield    #2; //Field contents:Ljava/lang/Object;
   17:  checkcast   #7; //class java/lang/String
   20:  invokevirtual   #8; //Method java/io/PrintStream.println:(Ljava/lang/String;)V
   23:  return 
```

然后我们可以在第 17 行看到`checkcast`命令，就在 println 之前——这是 Java 转换`Object`为已擦除泛型类型的地方——`String`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:04:52.017

请记住，在运行时， an`ArrayList<String>`与 an 相同，`ArrayList`并且使用底层实现`Object[]`。JIT 通常足够聪明，可以忽略强制转换，是的，但是由于泛型在运行时被删除，所以强制转换是必要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-12T15:10:14.027

Java 在保持其版本之间的兼容性方面做得很好，这意味着 Java5+ 语法可以编译成 1.4 兼容的类。我想这是 ArrayList在运行时**不**保证只有 SomeClass 会存储在 ArrayList 中的部分原因。

要查看您的泛型代码真正编译成什么，请使用出色的[JAD](http://www.varaneckas.com/jad)工具。

你的代码确实编译成`SomeClass object = (SomeClass) list.get(0);`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-12T15:48:18.757

> 我认为 list 是 ArrayList 类型的事实保证，在编译时和运行时，只有 SomeClass 将存储在 ArrayList 中？或者您是否可以进行不安全的类型转换以将 ArrayList 转换为 ArrayList？

是的，类型信息在运行时被丢弃。

这意味着您无法理解您是否有一个类型`ArrayList<String>`的对象或一个类型的对象`ArrayList<Long>`。JVM 不知道泛型类实例的实际类型参数，因此您没有运行时检查（并且只有在使用该数据时才会看到错误）。

此代码有效：

```
public void enqueueItem(ArrayList<Integer> list, Integer item) {
    List listAlias = list;
    listAlias.add(x.toString());
} 
```

这在运行时不是问题，类型检查仍然可以帮助您避免任何问题，并且您可以将旧代码与新代码互操作。即使在 .NET 环境中，您也有相同的行为（`IList<T>`派生自`IList`）。

您所支付的只是强制转换对性能的影响（这是与 Java 的通用实现的最大区别）。**或多或少的泛型是检测错误并使代码更具可读性的编译时助手**。例如，这段代码对编译器非常有效：

```
public ArrayList getCollection() {
   return new ArrayList<Integer>();
}

public void doStuff() {
   ArrayList<String> list = getCollection();
   list.add("text");
} 
```

> 在 Java 泛型中是否存在其他运行时类型转换的情况？

是的，每次你使用它们时（如果你对泛型做了坏事，你就会得到一个错误）。

> 最后，如果确实使用了运行时强制转换，是否存在 JIT 可以忽略运行时强制转换检查的情况？

我*认为*不，它总是进行强制转换，但无论如何这是一个非常实现的细节，它跟踪子类的类型参数，所以如果你从泛型类派生你自己的类，那么你将从这个*问题*中解脱出来。

> 如果是这样，为什么？

即使您更改了某些接口，所有现有代码都将适用于新的泛型。这意味着您可以逐步*更新到泛型。*我不担心性能影响（我们用它生存了很长时间，现在它是一个问题吗？）但我不喜欢所有这些技巧。也许，毕竟，*我们不能让橡木满了，妻子喝了*……

# jquery - Jquery提交不起作用

> ID：10126249
> 
> 赞同：0
> 
> 时间：2012-04-12T14:59:46.160
> 
> 标签：jquery, .net, partial-views

我有一个最初为`$(form).submit()`. 我必须修改它才能继续工作，`$("#savebutton").click()`因为主视图中已经有一个 form.sumbit() 函数。唯一的问题是，当单击按钮并且状态有效时，表单停止提交。旧代码

```
$(document).ready(function () {
    $("form").submit(function (e) {
        e.preventDefault(); //prevent default form submit
        $.ajax({
            url: '@Url.Action("HasJobInProgress", "ClientChoices")/',
            data: { id: '@Model.ClientId' },
            success: function (data) {
                showMsg(data);
            },
            cache: false
        });
    });
});

function showMsg(hasCurrentJob) {
    if (hasCurrentJob == "True") {
        alert("The current clients has a job in progress. No changes can be saved until current job completes");
        return false;
    } else {
       $("form").unbind('submit').submit();
    }
} 
```

当前代码

```
$(document).ready(function () {

    $("#saveButton").click(function (e) {
        e.preventDefault(); //prevent default form submit
        $.ajax({
            url: '@Url.Action("HasJobInProgress", "Shared")/',
            data: { id: '@Model.ClientId' },
            success: function (data) {
                showMsg(data);
            },
            cache: false
        });
    });

    function showMsg(hasCurrentJob) {
        if (hasCurrentJob == "True") {
            alert("The current clients has a job in progress. No changes can be saved until current job completes");
            return false;
        } else {
            $("form").submit();
        }
        return true;
    }
}); 
```

***更新（还是不行）***

```
$(document).ready(function () {

    $("#saveButton").click(function (e) {
        if ($(e.currentTarget).data('shouldSubmit')) return;
        e.preventDefault(); //prevent default form submit
        $.ajax({
            url: '@Url.Action("HasJobInProgress", "Shared")/',
            data: { id: '@Model.ClientId' },
            success: function (data) {
                showMsg(data, e);
            },
            cache: false
        });
    });

    function showMsg(hasCurrentJob, e) {
        if (hasCurrentJob == "True") {
            alert("The current clients has a job in progress. No changes can be saved until current job completes");
            return false;
        } else {
            $(e.currentTarget).data('shouldSubmit', true);
            $("#saveButton").click();
            $(e.currentTarget).data('shouldSubmit', null);
        }
        return true;
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:41:08.173

[这个答案](https://stackoverflow.com/a/8135983/13087)使用了一种可能有效的技术。基本上以编程方式再次单击相同的按钮，并使用标志来确定它是否在确认方法中被单击（`showMsg`在您的情况下）。

# c# - C# 英国夏令时 (BST) 时区缩写

> ID：10126252
> 
> 赞同：17
> 
> 时间：2012-04-12T14:59:52.017
> 
> 标签：c#, .net, timezone

我需要显示带有当前时区缩写的标签。我电脑的时区当前设置为“(GMT) 格林威治标准时间：都柏林、爱丁堡、里斯本、伦敦”。因此，我希望看到 BST 显示，因为 LN 目前处于英国夏令时。

看起来该信息（时区缩写）不可用。查看 GMT TimeZoneInfo，关于名称我能看到的只有

```
Id  "GMT Standard Time"
StandardName    "GMT Standard Time"
DaylightName    "GMT Daylight Time" 
```

有什么方法可以从“GMT Daylight Time”或任何其他可用的 Windows 时区信息到达 BST？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-12T15:04:27.673

该`TimeZoneInfo`课程将“英国夏令时”称为“GMT 夏令时”，所以不，这是不可能的。如果 Microsoft 将其存储为“BST”，它将在`DaylightName`属性中。

`TimeZoneInfo`多年前在 BCL 博客上跟踪课程的开发时，我没有看到他们如何选择`DaylightName`. 如果我猜测那将是因为这是针对“时区”而不是特定城市。

似乎公共域[tzdatabase](http://cpansearch.perl.org/src/ZEFRAM/Time-OlsonTZ-Data-0.201203/tzsrc/tz-link.htm)被认为比 Microsoft 的时区数据库更完整，它确实显示了伦敦的 BST（[来源](http://twiki.org/cgi-bin/xtra/tzdate?tz=Europe/London)）。这是因为城市包含在这个数据集中，而不仅仅是时区。有一个名为[Noda Time](http://nodatime.org)的项目将 tzdatabase 带到现在可用的 .Net。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-13T23:59:45.390

您应该知道，所有标有“标准”的时区都会在夏季正确切换到白天时间。例如`TimeZoneInfo.FindSystemTimeZoneById("GMT Standard Time")`，将是一个可以正确处理标准时间和日光时间的对象。比如说，也是如此`"Pacific Standard Time"`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-12T15:12:21.770

我认为您有两个选择：GMT 时区的特殊情况处理，或“Microsoft 使用错误名称的时区”的通用处理。

例如，我想知道葡萄牙人是否在冬季使用“GMT”作为他们的时区。不管他们是否这样做，我怀疑他们在夏天使用“英国夏令时”！

# javascript - 使用 mootools插入中断

> ID：10126254
> 
> 赞同：2
> 
> 时间：2012-04-12T14:59:59.560
> 
> 标签：javascript, mootools

我想使用 mootools`<br />`在标签后插入一个中断元素。`<label>`不幸的是，这行代码不起作用：

```
$$('.class-name label').inject('<br />', 'after'); 
```

`<br />`我应该先用 mootools创建元素吗？谢谢您的回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:20:45.580

这不是一个有效的元素构造函数`"<br />"`，并且注入工作相反 - `newel.inject(target, where)`。你要`grab`

```
$$(".class-name label").grab(new Element("br"), "after"); 
```

如果性能很重要（IE和许多项目）......

```
(function() {
    var br = new Element("br"), after = "after", inject = function(el) {
        el.grab(br.clone(), after) // or br.clone().inject(el, after)
    }
    $$(".class-name label").each(inject)
}()); 
```

甚至 - 为了避免 mootools el 构造函数的惩罚，我个人会采用以下方法：

```
(function() {
    var br = "br",
        after = "after",
        doc = document,
        ce = 'createElement',
        inject = function(el) {
            el.grab(doc[ce](br), after)
        }

    document.getElements(".class-name label").each(inject)
}()); 
```

老实说，如果可能的话，你应该先在 CSS 中解决这个问题。

# java - 在哪里可以找到 ISO Schematron 验证器的 Java 实现？

> ID：10126256
> 
> 赞同：6
> 
> 时间：2012-04-12T15:00:03.573
> 
> 标签：java, schematron

ISO Schematron 标准已经推出两年了，但我仍然无法找到使用 ISO Schematron XSLT 文件的 Java 实现（与旧版本 Schematron 的文件相反，例如：http: [//uploading.com /files/c9c9cb87/SchematronXpath.jar/](http://uploading.com/files/c9c9cb87/SchematronXpath.jar/)）。

有谁知道可以从 Java 方法轻松调用的生产就绪 ISO 模式验证器？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-11-07T17:08:29.170

Additionally you may use `ph-schematron` which provides both support for conversion to XSLT as well as a native plain Java validation, which is quicker than the XSLT version in nearly all cases. See [https://github.com/phax/ph-schematron/](https://github.com/phax/ph-schematron/) for the details as well as a quick intro. Example code to check if an XML file matches a Schematron file:

```
public static boolean validateXMLViaPureSchematron (File aSchematronFile, File aXMLFile) throws Exception { 
  final ISchematronResource aResPure = SchematronResourcePure.fromFile (aSchematronFile);
  if (!aResPure.isValidSchematron ()) 
    throw new IllegalArgumentException ("Invalid Schematron!"); 
  return aResPure.getSchematronValidity(new StreamSource(aXMLFile)).isValid ();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-04T15:45:56.113

[Probatron4j](http://www.probatron.org/probatron4j.html)可以根据 ISO Schematron 进行验证。该网站提供了一个独立的 JAR，旨在从命令行运行，但如果您有[其源代码](http://code.google.com/p/probatron4j/source/browse/#svn/trunk/)，则可以很容易地从 Java 方法调用 Probatron 。这是我如何做到的简化版本：

```
public boolean validateSchematron(InputStream xmlDoc, File schematronSchema) {
    // Session = org.probatron.Session; think of it as the Main class
    Session theSession = new Session();
    theSession.setSchemaSysId(schematronSchema.getName());
    theSession.setFsContextDir(schematronSchema.getAbsolutePath());

    // ValidationReport = org.probatron.ValidationReport; the output class
    ValidationReport validationReport = null;
    try
    {
        validationReport = theSession.doValidation(xmlDoc);
    }
    catch(Exception e) { /* ignoring to keep this answer short */ }

    if (validationReport == null ||
        !validationReport.documentPassedValidation()) {
        return false;
    }
    return true;
} 
```

您需要进行一些小的修改，让 Probatron 知道它不是从 JAR 文件中运行的，但这不会花很长时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-09T19:28:47.587

您可以查看[SchematronAssert](https://github.com/j-maly/SchematronAssert)（披露：我的代码）。它主要用于单元测试，但您也可以将它用于普通代码。它是使用 XSLT 实现的。

单元测试示例：

```
ValidationOutput result = in(booksDocument)
    .forEvery("book")
    .check("author")
    .validate();
assertThat(result).hasNoErrors(); 
```

独立验证示例：

```
StreamSource schemaSource = new StreamSource(... your schematron schema ...);
StreamSource xmlSource = new StreamSource(... your xml document ... );
StreamResult output = ... here your SVRL will be saved ... 
// validation 
validator.validate(xmlSource, schemaSource, output); 
```

使用 SVRL 的对象表示：

```
ValidationOutput output = validator.validate(xmlSource, schemaSource);
// look at the output
output.getFailures() ... 
output.getReports() ... 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-11T13:25:20.897

[jing](http://code.google.com/p/jing-trang/)图书馆为我工作。

# php - 查找两个日期之间的日期日期

> ID：10126258
> 
> 赞同：1
> 
> 时间：2012-04-12T15:00:07.427
> 
> 标签：php

我想查找日期范围之间一天中日期的出现。

> 例如 date1 = 04/12/2012（星期四）和 date2 = 04/30/2012。

所以 PHP 函数应该返回两个日期：

> 19/12/2012（开始日期后的第一个星期四）和 26/12/2012（开始日期后的第二个星期四）。

对于较大的日期范围函数应返回第 1、第 2、第 3、第 4....等发生日期。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:17:26.047

评论中列出的副本（[获取明年星期一和星期二的所有日期](https://stackoverflow.com/questions/2045736/getting-all-dates-for-mondays-and-tuesdays-for-the-next-year)）有一个相当冗长的答案。[`strtotime`](http://php.net/manual/en/function.strtotime.php)这是使用[相对格式](http://www.php.net/manual/en/datetime.formats.relative.php)的简洁解决方案：

```
// Initialize our dates to UNIX timestamps
$startDate = strtotime( 'next Tuesday', strtotime($startDate) );
$endDate= strtotime($endDate);

// Output all Tuesdays prior to our end date
while ($startDate < $endDate) {

    echo date('n/j/Y', $startDate ). "\n";

    // Get next Tuesday relative to last Tuesday
    $startDate = strtotime( 'next Tuesday', $startDate );
} 
```

以今天 ( `$startDate`) 和从今天起 2 个月 ( `$endDate`) 为例，上述输出：

```
4/17/2012
4/24/2012
5/1/2012
5/8/2012
5/15/2012
5/22/2012
5/29/2012
6/5/2012 
```

[在行动中看到它。](http://codepad.org/VWxDMnAa)

**注意**：确保您使用[正确的日期格式](http://www.php.net/manual/en/datetime.formats.date.php)来接收准确的结果。

# jquery - Jquery .submit 在 Chrome 上不起作用

> ID：10126263
> 
> 赞同：0
> 
> 时间：2012-04-12T15:00:28.897
> 
> 标签：jquery, ajax

我正在研究ajax。
浏览器是谷歌浏览器。
当我点击提交时，我的浏览器没有提示确定，而是提交了表单。这里有什么问题？

```
 <html>
    <head>
    <script type="text/javascript" src="/cp/scripts/jquery-1.7.2.js"></script>
    <script language="javascript">
    $("#test").submit(function(){
    //$.post("test.php", this.serialize());
    alert('ok');
    return false;
    });
    </script>
    </head>
    <body>
    <form id="test">
    <input type="text" name="name">
    <input type="submit">
    </form>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-12T15:01:35.870

执行脚本时尚未定义表单。将其包装在一个[`$().ready`](http://api.jquery.com/ready/)事件中：

```
$(document).ready(function() {
    $("#test").submit(function() {
    //$.post("test.php", this.serialize());
    alert('ok');
    return false;
    });
}); 
```

我可以看到以下问题：“什么未定义？”。
是的：

```
...
# Hey, a script tag, let's wait, and load the resource.
<script type="text/javascript" src="/cp/scripts/jquery-1.7.2.js"></script>

# Hey a script tag!
<script language="javascript">
$("#test").submit(function(){
//$.post("test.php", this.serialize());
alert('ok');
return false;
});
</script>
# The script block has ended, let's parse the script
# ... *calls* $('#test'). ....

# Now, #test is defined. Too late...
<form id="test">
# ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:07:36.187

首先，确保函数正在执行`document.ready`，然后不要忘记阻止`submit`事件的默认行为：

```
$(document).ready(function() {
    $("#test").submit(function(evt){
        evt.preventDefault();
        alert('ok');
        return false;
    });
}); 
```

在 Chrome中的[jsFiddle](http://jsfiddle.net/)上测试。

# c# - 应用程序使用 saxonHE (9.2.1.1) api 针对多个 XML 文件处理 XSLT (v2.0)

> ID：10126264
> 
> 赞同：6
> 
> 时间：2012-04-12T15:00:31.620
> 
> 标签：c#, winforms, xslt, .net-3.5, saxon

我有一个使用 SAXONHE 9.2.1.1 api 文件将 XML 数据转换为纯文本的应用程序。我的表单有文本框

1.  XMLInput_FilePath
2.  XSLT_FilePath
3.  TextOutput_FilePath

在我的表单的 okButton_Click() 事件中，我有以下内容：

```
private void okButton_Click(object sender, EventArgs e) {
    FileStream xsltTransform_FileStream = File.Open(xsltTransform_FilePath.Text, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);
    FileStream xmlInput_FileStream = File.Open(xmlInput_FilePath.Text, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);

    XmlTextReader modelFileXML = new XmlTextReader(xmlInput_FileStream);
    modelFileXML.XmlResolver = null;

    Processor processor = new Processor();

    XdmNode input = processor.NewDocumentBuilder().Build(modelFileXML);

    XsltTransformer xsltTransformer = processor.NewXsltCompiler().Compile(xsltTransform_FileStream).Load();
    xsltTransformer.InputXmlResolver = null;
    xsltTransformer.InitialContextNode = input;

    Serializer serializer = new Serializer();
    serializer.SetOutputFile(writeFile);

    xsltTransformer.Run(serializer);

    xsltTransform_FileStream.Close();
    modelFileStream.Close();
} 
```

在我的 XMLInput 文件的上下文中，引用了另一个 XML 文件中的数据 - 见下文：

XML:

```
<XMLInput_File
  Name="XMLInput_File">
  <Subsystem Name="Subsystem">
    <Requirements Name="Requirement_1">
      <Rows>
        <Path Text="XMLInput2_File:/XMLInput2_File/Subsystem_1/Field_1" />
      </Rows>
      <Rows>
        <Path Text="XMLInput2_File:/XMLInput2_File/Subsystem_1/Field_2" />
      </Rows>
    </Requirements>
    <Requirements Name="Requirement_2">
      <Rows>
        <Path Text="XMLInput2_File:/XMLInput2_File/Subsystem_1/Field_3" />
      </Rows>
      <Rows>
        <Path Text="XMLInput2_File:/XMLInput2_File/Subsystem_2/Field_1" />
      </Rows>
    </Requirements>
  </Subsystem>
</XMLInput_File> 
```

Text 属性是存储外部 XML 文件路径的位置，在上面的示例中，XML 文件名将是“XMLInput2_File.xml”。

XML2：

```
<XMLInput2_File Name="XMLInput2_File">
  <Subsystem Name="Subsystem_1">
    <Fields Name="Field_1">
      S1_Field_One
    </Fields>
    <Fields Name="Field_2">
      S1_Field_Two
    </Fields>
     <Fields Name="Field_3">
      S1_Field_Three
    </Fields>
 </Subsystem>
  <Subsystem Name="Subsystem_2">
    <Fields Name="Field_1">
      S2_Field_One
    </Fields>
    <Fields Name="Field_2">
      S2_Field_Two
    </Fields>
     <Fields Name="Field_3">
      S2_Field_Three
    </Fields>
 </Subsystem>
</XMLInput2_File> 
```

XSLT：

```
 <xsl:template match="/">
    <xsl:for-each select ="//Rows/Path">
      <xsl:variable name ="interfaceData" select ="@Text"/>
      <xsl:variable name ="_intfModelName" select ="substring-before(@Text,':/')"/>
      <xsl:variable name ="_intfFileName" select ="concat('../../OtherXMLFiles/',$_intfModelName,'.xml')"/>
      <xsl:apply-templates select ="document($_intfFileName)/*[@Name=$_intfModelName]/*">
      </xsl:apply-templates>
     </xsl:for-each>
  </xsl:template> 
```

我正在使用 Microsoft Visual Studion 2008 Professional Edition 来测试我的转换，并且上述场景完全可以正常工作 - document() 更具体地引用了外部文件。但是，当我使用 C# Winform 应用程序和 saxon api 调用时，我的输出文件包含空白数据（空白行）。

经过几次测试和 Internet 搜索后，我得出结论，相对路径 [在我的 XSLT 中] 没有按应有的方式应用。似乎 saxon api 调用从 transform.exe 文件的位置处理 document() 函数，而**不是**输入文件（这是我更喜欢的）。

我一直在尝试对这个问题进行更多的 Internet 搜索，但我对问题是在我的 XSLT 文件中还是在 okButton_Click() 事件中的 saxon api 调用中感到困惑。此外，我去过撒克逊的网站和[文档](http://www.saxonica.com/documentation9.2/dotnetdoc/)寻求帮助，但无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T16:32:19.003

在您的 XSLT 中，使用

```
 <xsl:apply-templates select ="document($_intfFileName, /)/*[@Name=$_intfModelName]/*"> 
```

如果您希望相对于输入文档（而不是样式表）解析相对 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T21:08:12.163

在撒克逊帮助邮件列表上发布我的询问后，Saxonica 的 Michael Kay 帮助我解决了这个问题。错误出现在我的 saxon api 调用（C# 应用程序）中。以下是更新后的代码：

```
private void okButton_Click(object sender, EventArgs e) {
    Processor processor = new Processor();
    XdmNode input = processor.NewDocumentBuilder().Build(new Uri(inputFile));
    XsltCompiler compiler = processor.NewXsltCompiler();
    compiler.BaseUri = new Uri(inputFile);
    XsltTransformer xsltTransformer = compiler.Compile(new Uri(transformFileTextBox.Text)).Load();
    xsltTransformer.InitialContextNode = input;
    Serializer serializer = new Serializer();
    serializer.SetOutputFile(writeFile);
    xsltTransformer.Run(serializer);
    xsltTransform_FileStream.Close();
    modelFileStream.Close();
} 
```

“问题是您正在调用 document() 来解析其基本 URI 未知的相对 URI。因为您使用 substring-before 来计算相对 URI，所以参数是字符串，因此它将使用的基本 URI 是“ - 迈克尔·凯

所以，这就是我所做的

*   删除了两个 FileStream 变量
*   创建了一个 XsltCompiler 对象并将 BaseUri 设置为输入文件
*   将 FileStream 签名替换为“new Uri(filename)”签名
*   删除了这行代码'xsltTransformer.InputXmlResolver = null;'

我的输出是应该的。非常感谢 Saxonica 的 Michael Kay 帮助解决了这个问题。- 洛伦兹

# iphone - 为 iPhone 应用创建网格布局

> ID：10126265
> 
> 赞同：0
> 
> 时间：2012-04-12T15:00:49.420
> 
> 标签：iphone, xcode, cocoa, ios5

我正在开发一个 iPhone 应用程序，该应用程序当前拍摄照片并存储图像。

然后我有一组过滤器可以编辑图像。我的目标是在网格布局中预览图像，比如 3 x 4，但我不知道该怎么做。例如，我是否使用 uitable？

有人可以指出我正确的方向。

谢谢

奥利弗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:40:07.933

你试过[DTGridView](https://github.com/danielctull/DTGridView)吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:05:36.910

您可以使用 UIImageView 来显示您的图像。

# android - 当有人点击Android应用程序屏幕上的任意位置时如何触发事件？

> ID：10126268
> 
> 赞同：30
> 
> 时间：2012-04-12T15:01:06.223
> 
> 标签：android, events

当应用程序屏幕上某处发生点击时，如何捕捉事件？是否有按钮或其他东西都没有关系。我只需要`onClick()`在整个应用程序屏幕上应用一个事件监听器。
这个怎么做？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-12T15:03:43.687

`setonclicklistner`用于布局文件的主要布局......

像....main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:id="@+id/mainlayout">
 <!- Your other view->
</Relativelayout> 
```

并为 mainlayout 设置单击侦听器...

```
 RelativeLayout rlayout = (RelativeLayout) findViewById(R.id.mainlayout);
 rlayout.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v) {

    }

 }); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-10-10T03:05:03.323

我相信最简单的方法是[在](https://developer.android.com/reference/android/app/Activity.html#onUserInteraction())你的`Activity`

`EditText`请注意，当用户关注 on/off和`Spinners`（可能还有其他小部件）时，它不会触发。但是每次用户触摸屏幕或按下按钮时它都会触发。

但这使得无需在布局中构建侦听器或编写额外的方法来处理这些侦听器，因此我相信这是获得所需内容的最轻松的方式。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-11-10T23:01:43.403

你应该重写`Activity`'s`dispatchTouchEvent(ev: MotionEvent)`方法

* * *

看一下 Kotlin 中的这个例子。这种方法**不会影响**您应用中的任何 onClickListenters

```
/**
 * On each touch event:
 * Check is [snackbar] present and displayed
 * and dismiss it if user touched anywhere outside it's bounds
 */
override fun dispatchTouchEvent(ev: MotionEvent): Boolean {
    // dismiss shown snackbar if user tapped anywhere outside snackbar
    snackbar?.takeIf { it.isShown }?.run {
        val touchPoint = Point(Math.round(ev.rawX), Math.round(ev.rawY))
        if (!isPointInsideViewBounds(view, touchPoint)) {
            dismiss()
            snackbar = null // set snackbar to null to prevent this block being executed twice
        }
    }

    // call super
    return super.dispatchTouchEvent(ev)
} 
```

或查看完整的[要点](https://gist.github.com/and291/ce5704c4163f8dcd9d06b1ab6a9850cf)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-04-13T12:00:01.380

如果您想知道用户点击了屏幕上的任何位置，那么诀窍就是覆盖 OnUserUnteraction()：

*“每当按键、触摸或轨迹球事件被调度到活动时调用。如果您希望知道用户在活动运行时以某种方式与设备交互，请实现此方法。此回调和 {@link #onUserLeaveHint } 旨在帮助活动智能地管理状态栏通知；特别是，帮助活动确定取消通知的适当时间...."*

```
public abstract class BaseActivity extends Activity {
...
@Override
public void onUserInteraction() {
    Log.d(DEBUG_TAG,"Touch anywhere happened");
    super.onUserInteraction();
} 
```

在一些不活动后，我正在使用它来设置应用程序屏幕块。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-12T15:04:44.770

给你的主布局一个id，然后

```
LinearLayout root = (LinearLayout) findViewById(R.id.main_layout);
root.setOnClickListener(new OnClickListener() {
    public void onClick()
    {

    }
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-20T08:49:59.100

您也可以直接从`onClick`根布局的 xml 属性设置回调：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:onClick"myMethod">
 <!- Your other view->
</Relativelayout> 
```

在您的活动中：

```
public void myMethod(View pView) {
  //XXX do something
} 
```

这样可以减少臃肿的代码:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-12T15:04:55.833

也许您可以向 Layout 实例添加一个侦听器，获取布局

```
RelativeLayout l = (RelativeLayout)findViewById(R.id.mylayout);
l.setOnClickListener(click); 
```

# tsql - 使用 DES（不是三重）算法在 T-SQL 中加密数据

> ID：10126269
> 
> 赞同：0
> 
> 时间：2012-04-12T15:01:06.317
> 
> 标签：tsql, des

我需要使用 DES 编码一些字符串（不是三重 DES - 我知道有很多文章描述了如何使用 NCRYPTBYPASSPHRASE 命令）。我有钥匙和 IV。我如何使用 T-SQL 来做到这一点？有没有现成的程序或功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T21:34:17.197

从[这里](http://msdn.microsoft.com/en-us/library/ms179331%28v=sql.90%29.aspx)撕下来。我没有对此进行测试，但是[这个](http://msdn.microsoft.com/en-us/library/ms345262%28v=sql.90%29.aspx)页面列出了所有的加密类型，而 DES 似乎就是其中之一。

```
--If there is no master key, create one now. 
IF NOT EXISTS 
    (SELECT * FROM sys.symmetric_keys WHERE symmetric_key_id = 101)
    CREATE MASTER KEY ENCRYPTION BY 
    PASSWORD = '23987hxJKL969#ghf0%94467GRkjg5k3fd117r$$#1946kcj$n44nhdlj'
GO

CREATE CERTIFICATE HumanResources037
   WITH SUBJECT = 'Employee Social Security Numbers';
GO

CREATE SYMMETRIC KEY SSN_Key_01
    WITH ALGORITHM = DES
    ENCRYPTION BY CERTIFICATE HumanResources037;
GO

-- Open the symmetric key with which to encrypt the data.
OPEN SYMMETRIC KEY SSN_Key_01
   DECRYPTION BY CERTIFICATE HumanResources037;

-- Encrypt the value 
SET @encrypted = EncryptByKey(Key_GUID('SSN_Key_01'), '555-77-4444'); 
```

# delphi - 全局变量不是全局变量或不包含我期望它包含的值？

> ID：10126272
> 
> 赞同：0
> 
> 时间：2012-04-12T15:01:27.273
> 
> 标签：delphi

我在 Form1 中有以下代码。

```
public
  { Public declarations }
  cas: integer;
end; 
```

然后我使用该变量，然后我使用`Form2.ShowModal;`On Form2 调用另一个表单我尝试执行以下操作`Label9.Caption:=Format('%ds',[Form1.cas]);`：但无论我做什么，在 Form1 中，'cas' 被分配了正确的值，但在 Form2 中它总是显示“0s”。为什么会这样？

编辑：

现在我在第一个名为“kolecka”的单元中有这个

```
var
  Form1: TForm1;
  barvy: array[1..6] of TColor;
  kola: array[1..22] of TShape;
  valid: integer;
  bezi: boolean;
  presnost: real;
  skore: integer;
  chyb: integer;
  kliku: integer;
  cas: integer; 
```

这在另一个称为“对话”的单元中：

```
implementation

uses
  kolecka;

{$R *.dfm}

procedure Statistiky();
begin
  With Form2 do begin
    Label8.Caption:=IntToStr(kolecka.skore);
    Label9.Caption:=Format('%ds',[kolecka.cas]);
    Label10.Caption:=IntToStr(kolecka.cas);
    Label11.Caption:=IntToStr(skore);
    Label12.Caption:=Format('%.2f%%',[presnost]);
  end;
end; 
```

但它仍然不起作用..仍然显示为零。

编辑2：

我觉得每个答案都说不同的东西，我很困惑..

EDIT3：这就是在 Form1 中操作“cas”的方式

```
procedure TForm1.Timer3Timer(Sender: TObject);
begin
  cas:=cas+1;
  Form1.Label5.Caption:=IntToStr(cas);
end; 
```

找到了！

嗯。我发现问题出在哪里。
我在 Form2 Create 上分配标签标题而不是 Show，所以它们当然是在 0 >.>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:11:09.667

在您最初的问题中，您在对象中声明了一个字段，并且您认为它可能是全局的？

```
unit unit1;

interface 

uses Stuff;

type 
 TForm1 = class(TForm)
   public
     THisIsAFieldInAnObject:Integer;
 end

var
  ThisIsAGlobal:Integer;

implementation

uses OtherStuff;

... 
```

注意你把全局变量放在上面的位置。全局变量不是类中的字段。当你写代码时，你把东西放在哪里被称为“你所处的上下文”。在类声明中，类似的东西`public`作为可见性说明符是有意义的。它不会使事物全局化，而是使它们对类的用户可见。

要访问全局，请以 unitName.VariableName 的形式访问它，并且不要忘记将“使用 unitName”添加到其他单元。

**更新**您现在可以正确访问全局变量，并且它不包含您期望的值。这就是我们开始调试的地方。在设置变量的位置设置断点，并在任何其他将其更改回 0 的位置设置断点。现在在读取变量的位置设置断点。我发现变量写入在实际发生时效果更好，并且当它们没有被后续写入相同位置覆盖时，包含不同的值。变量就像一个包含数字的盒子。零写入它的东西（你认为被调用的代码没有被调用）或写入它的两件事（你认为应该存在但不存在的东西，因为第二次写入破坏了第一个值）是你的常见来源的混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:22:20.133

你有一个全局变量：`kolecka.cas`和一个字段`kolecka.Form1.cas`。那些是不同的。

```
public
  { Public declarations }
  cas: integer;//This is the field
end;

var
  Form1: TForm1;
  cas: integer;//This is the global variable 
```

`Label9.Caption:=Format('%ds',[kolecka.cas]);`访问全局变量。

`cas`在一个实例方法中`TForm1`引用字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:29:54.570

在 上`Label10.Caption:=IntToStr(kolecka.cas);`，您实际上是在读取`cas`unit 的全局变量`kolecka`，而不是`Form1`'s 。

在第一种情况下，您可能试图`Form1.cas`在 call 之后进行操作`Form2.ShowModal`。请注意，ShowModal 调用之后的代码在您关闭显示的表单之前不会执行`ShowModal`。

**更新** 看来您正在操纵单元的`cas`变量，而不是表单的变量。我完全不知道德尔福是如何处理这种情况的。但明确指出`cas`您正在操作的实例是一个好习惯。使用此代码：

```
self.cas := self.cas + 1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T20:25:58.523

我要检查的第一件事是您是否只有一个名为 Form1 的变量。

我最好的猜测是你在 unit 中有 1 `Unit1`（声明 TForm1 的地方）和在 unit 中有 1 `Kolecka`，但这只是一个假设。

# c# - 从 JavaScript 调用可能返回另一个 JavaScript 函数的代码隐藏函数

> ID：10126274
> 
> 赞同：0
> 
> 时间：2012-04-12T15:01:32.980
> 
> 标签：c#, javascript, asp.net, gridview, updatepanel

我有一个问题，它适用于一个按钮，而不适用于另一个。

一个有效的按钮是调用 ModalPopup 以向 UpdatePanel 内的 GridView 添加新行。如果成功，它会弹出一个带有消息的警报，否则会弹出另一个带有异常消息的警报。该代码与其他代码非常相似，只是它位于 ModalPopupExtender 中。

引发有关 EventValidation 的已知异常的按钮如下所示：

网站：

```
<asp:Button ID="btnAlquilar" runat="server" Text="Alquilar" CssClass="AdminButtons"
                                 OnClientClick="Click_Alquilar(); return false"/> 
```

它调用的 JavaScript 函数

```
function Click_Alquilar() {
        if (index == '') {
            alert("Debe elegir una película para alquilar");
        }
        else {

            if (confirm("¿Quiere alquilar la película '" + selected.childNodes[2].innerText + "'?")) {
                __doPostBack('<%= btnAlquilar.UniqueID %>', index);
            }
        }
    } 
```

其中 index 是 GridView 中所选行的索引（使用类似的架构完成，并且工作正常）。

代码隐藏从 Page_Load 方法开始，并调用我遇到问题的函数：

```
 protected void Page_Load(object sender, EventArgs e)
        {
            if (!Page.IsPostBack)
            {...}
            else
            {
                ProcessAjaxPostBack(sender, e);
            }
        }
private void ProcessAjaxPostBack(object sender, EventArgs e)
        {
            if ((Request.Params["__EVENTTARGET"] != null) && (Request.Params["__EVENTARGUMENT"] != null))
            {
                ...

                if (Request.Params["__EVENTTARGET"] == this.btnAlquilar.UniqueID)
                {
                    index = Convert.ToInt32(Request.Params.Get("__EVENTARGUMENT").TrimStart('r', 'o', 'w'));
                    btnAlquilar_Click(Request.Params.Get("__EVENTARGUMENT"));
                }    

            }
        }

protected void btnAlquilar_Click(string id)
        {
            string message = "";
            if (BAC.BAC.CheckUserAge(lblUserId.Text) < Convert.ToInt32(dgvPeliculas.Rows[index].Cells[7].Text))
            {
                btnBorrar.Visible = false;
                btnEditar.Visible = false;
                btnNuevo.Visible = false;
                System.Web.UI.ScriptManager.RegisterClientScriptBlock(Page, Page.GetType(), Guid.NewGuid().ToString(), "alert('No tiene la edad mínima para alquilar la película.')", true);
            }
            else
            {
                try
                {
                    BAC.BAC.NewAlquiler(lblUserId.Text, dgvPeliculas.Rows[index].Cells[0].Text, dgvPeliculas.Rows[index].Cells[9].Text);
                }
                catch (Exception ex)
                {
                    message = Change_ExceptionMessage(ex.Message);
                    System.Web.UI.ScriptManager.RegisterClientScriptBlock(Page, Page.GetType(), Guid.NewGuid().ToString(), "alert('No se pudo alquilar la película: " + message + "')", true);
                }
            }

        } 
```

RegisterClientScriptBlock 方法与我用于另一个按钮的方法相同（它不会做任何比这个更复杂的事情：如果出现问题，它会更改弹出窗口中标签的文本并显示警报；如果正确，它加载 GridView 并显示成功警报），并在那里工作。在这里，它抛出异常“EnableEventValidation is true so...”。我已为渲染时的事件验证注册了此按钮：

```
protected override void Render(HtmlTextWriter writer)
        {
            this.Page.ClientScript.RegisterForEventValidation(btnAlquilar.UniqueID);
            base.Render(writer);
        } 
```

那么为什么会在这里发生呢？为什么这次不行？

编辑：现在我检查了，由 ModalPopup 中的工作按钮更改的标签包含在 UpdatePanel 中。我不知道这是否重要，但只是要注意它。

EDIT2：该页面也适用于母版页。不知道有没有用。我尝试使用 UpdatePanels 和使用 AsyncPostBackTrigger 包装 Edit 按钮和 GridView，但我仍然得到相同的异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T19:17:58.687

好的，对于那些对此感兴趣的人，问题出在 _ *doPostBack 调用上。由于我传递的参数 (* _EVENTARGUMENT) 是动态的，因此我永远无法通过 RegisterForEventValidation 方法注册这些事件，因为它要求提供两个常量字符串 (AFAIK)：控件的 UniqueID 和将与它一起传递的参数。

因此，除了按钮的 UniqueID 之外，我停止向 doPostBack 传递参数，并通过其他媒体（主要是将隐藏字段值传递给 Page 类中的全局变量）传递我感兴趣的变量。

这解决了问题并使程序按预期工作。我将按钮包装在与 GridView 相同的更新面板中，以免生成 AutoPostBack 并更改 Grid 的值而无需刷新。

如果有人对代码感兴趣，我可以提供。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T19:29:06.567

```
OnClientClick="Click_Alquilar(); return false"
instead of this use
OnClientClick="return Click_Alquilar();

and in javascript
use return false;
in functions like

function Click_Alquilar() {
        if (index == '') {
            alert("Debe elegir una película para alquilar");
return false;
        }
        else {

            if (confirm("¿Quiere alquilar la película '" + selected.childNodes[2].innerText + "'?")) {
                __doPostBack('<%= btnAlquilar.UniqueID %>', index);
            }
        }
    } 
```

# sql - 使用 BCP 从 SQL Server 2008 导出数据时出错

> ID：10126276
> 
> 赞同：2
> 
> 时间：2012-04-12T15:01:35.147
> 
> 标签：sql, sql-server-2008, bcp

我收到错误：

SQLState = S1000，NativeError = 0 错误 = [Microsoft][SQL Server Native Client 10.0]无法打开 BCP 主机数据文件

运行以下命令时：

```
set nocount on;
Declare @sql varchar(1000);
declare @noteid int;
declare xx1 cursor for select nic.NotebookItemId from NotebookItemContent nic
inner join NotebookLinks nl on nl.NotebookItemId = nic.NotebookItemId
inner join NotebookItems ni on ni.NotebookItemId = nic.NotebookItemId
where nl.clientid = 1235074
AND ni.NotebookTypeId = 56;
open xx1;
fetch xx1 into @noteid;
while (@@fetch_status = 0)
begin
set @sql = 'BCP "SELECT memo FROM Monarch_Pronet_ITOIL.dbo.notebookitemcontent where notebookitemid=' + cast(@noteid as varchar) + 
'" QUERYOUT C:\TEMP\' + cast(@noteid as varchar) + '.doc -T -f C:\temp\bcp.fmt -S ' + @@SERVERNAME
EXEC master.dbo.xp_CmdShell @sql
fetch xx1 into @noteid;
end;
close xx1;
deallocate xx1; 
```

任何帮助，将不胜感激！

打印@SQL 返回：

```
BCP "SELECT memo FROM Monarch_Pronet_ITOIL.dbo.notebookitemcontent where notebookitemid=17695498" QUERYOUT C:\TEMP\17695498.doc -T -f C:\temp\bcp.fmt -S BHAMSQL-SRV03 
```

还意识到我的原始查询不正确（选择所有备忘录而不是使用光标......！所以现在正确的查询是上面的查询 - 为我作为布偶道歉：D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:10:08.340

你能做一个

```
PRINT @sql 
```

并查看@sql 字符串值是什么。我猜，它是一个错误的引用或反斜杠

# algorithm - 使用一组素数按升序生成整数

> ID：10126285
> 
> 赞同：12
> 
> 时间：2012-04-12T15:02:11.047
> 
> 标签：algorithm, primes, hamming-numbers, smooth-numbers

我有一组素数，我必须只使用这些素数以递增的顺序生成整数。

例如，如果集合是*p* = {2, 5}，那么我的整数应该是 1, 2, 4, 5, 8, 10, 16, 20, 25, ...</p>

有没有有效的算法来解决这个问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-15T06:32:54.937

删除一个数字并将*其所有倍数*（通过集合中的素数）重新插入优先级队列是*错误*的（在问题的意义上） - 即它产生正确的序列但*效率低下*。

它在两个方面效率低下 - 首先，它*过度生产*了序列；其次，每个 PriorityQueue 操作都会产生额外的成本（这些操作`remove_top`通常`insert`不会都是*O(1)*，当然不会在任何基于列表或树的 PriorityQueue 实现中）。

高效的*O(n)*算法在生成序列时将指针保持回序列本身，以便在*O(1)*时间内查找并附加下一个数字。在伪代码中：

```
 return array h where
    h[0]=1; n=0; ps=[2,3,5, ... ]; // base primes
    is=[0 for each p in ps];       // indices back into h
    xs=[p for each p in ps]        // next multiples: xs[k]==ps[k]*h[is[k]]
    repeat:
      h[++n] := minimum xs
      for each ref (i,x,p) in (is,xs,ps):
        if( x==h[n] )
          { x := p*h[++i]; }       // advance the minimal multiple/pointer 
```

对于每个最小倍数，它会推进其指针，同时计算其下一个倍数值。这也有效地实现了 PriorityQueue 但有关键区别 - 它*在*终点之前，而不是之后；除了序列本身之外，它不会创建任何额外的存储；并且它的大小是恒定的（只有*k*个数字，对于*k*个基本素数），而过去的 PriorityQueue 的大小随着我们沿着序列前进而增长（在汉明序列的情况下，基于*3 个*素数的集合，如*n ^(2 /3)*，对于序列的*n 个*数字）。

* * *

[Haskell](http://rosettacode.org/wiki/Hamming_numbers#The_classic_version)中的经典汉明序列本质上是相同的算法：

```
h = 1 : map (2*) h `union` map (3*) h `union` map (5*) h

union a@(x:xs) b@(y:ys) = case compare x y of LT -> x : union  xs  b
                                              EQ -> x : union  xs  ys
                                              GT -> y : union  a   ys 
```

我们可以使用函数（参见[Wikipedia](http://en.wikipedia.org/wiki/Fold_%28higher-order_function%29#Tree-like_folds)）以*树状*方式折叠列表以提高效率，从而为*任意*基本素数生成[平滑数](http://en.wikipedia.org/wiki/Smooth_number)，从而创建固定大小的比较树：*`foldi`*

 **```
smooth base_primes = h   where       -- strictly increasing base_primes  NB!
    h = 1 : foldi g [] [map (p*) h | p <- base_primes]
    g (x:xs) ys = x : union xs ys

foldi f z []     = z
foldi f z (x:xs) = f x (foldi f z (pairs f xs))

pairs f (x:y:t)  = f x y : pairs f t
pairs f t        = t 
```

* * *

也可以通过直接枚举三元组并通过对数评估它们的值，在*O(n* *^(2/3)* *)时间内直接计算围绕其第**n*个成员的汉明序列*切片*。这个[Ideone.com 测试条目](http://ideone.com/q3fma)在*~~1.12~~* *0.05*秒内计算了[*第 10 亿*](https://stackoverflow.com/a/37833043/849891)[个汉明数](https://stackoverflow.com/a/37833043/849891)[（2016-08-18：主要加速由于尽可能使用][而不是默认值][，即使在 32 位上也是如此；由于建议的调整，额外的 20% @GordonBGood，将波段大小复杂度降低到 O(n] [^(1/3)] [))。]*`logval(i,j,k) = i*log 2+j*log 3+k*log 5`[](https://stackoverflow.com/a/37833043/849891)*~~[`Int``Integer`]~~**

 **~~[在这个答案](https://stackoverflow.com/a/12041774/849891)中对此进行了更多讨论，我们还找到了它的完整归属：

```
slice hi w = (c, sortBy (compare `on` fst) b) where  -- hi is a top log2 value
  lb5=logBase 2 5 ; lb3=logBase 2 3                  -- w<1 (NB!) is (log2 width)
  (Sum c, b) = fold                                  -- total count, the band
      [ ( Sum (i+1),                                 -- total triples w/this j,k
          [ (r,(i,j,k)) | frac < w ] )               -- store it, if inside the band
        | k <- [ 0 .. floor ( hi   /lb5) ],  let p = fromIntegral k*lb5,
          j <- [ 0 .. floor ((hi-p)/lb3) ],  let q = fromIntegral j*lb3 + p,
          let (i,frac) = pr  (hi-q)      ;       r = hi - frac    -- r = i + q
      ]    -- (sum . map fst &&& concat . map snd)
  pr = properFraction 
```

这也可以推广到*k*个基本素数，可能在*O(n ^((k-1)/k) )*时间内运行。

* * *

请参阅[此 SO 条目](https://stackoverflow.com/questions/12480291/new-state-of-the-art-in-unlimited-generation-of-hamming-sequence)以了解重要的后续开发。另外，[这个答案](https://stackoverflow.com/questions/29992904/enumerate-factors-of-a-number-directly-in-ascending-order-without-sorting/30181351#30181351)很有趣。和另一个[相关的答案](https://stackoverflow.com/questions/9242733/find-the-smallest-regular-number-that-is-not-less-than-n/12041774#12041774)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-12T15:12:44.267

基本思想是 1 是集合的成员，对于集合 n 的每个成员，*2* n*和*5 *n*也是集合的成员。因此，您首先输出 1，然后将 2 和 5 推送到优先级队列中。然后，你反复弹出优先级队列的最前面的项，如果与前面的输出不同，就输出它，然后将 2 次和 5 次的数字压入优先级队列。

谷歌搜索“汉明数”或“常规数”或访问[A003592](http://oeis.org/A003592)了解更多信息。

----- 稍后添加 -----

我决定在午餐时间用几分钟时间编写一个程序来实现上述算法，使用 Scheme 编程语言。首先，[这](http://programmingpraxis.com/2009/08/14/pairing-heaps/)是一个使用配对堆算法的优先级队列的库实现：

```
(define pq-empty '())
(define pq-empty? null?)

(define (pq-first pq)
  (if (null? pq)
      (error 'pq-first "can't extract minimum from null queue")
      (car pq)))

(define (pq-merge lt? p1 p2)
  (cond ((null? p1) p2)
        ((null? p2) p1)
        ((lt? (car p2) (car p1))
          (cons (car p2) (cons p1 (cdr p2))))
        (else (cons (car p1) (cons p2 (cdr p1))))))

(define (pq-insert lt? x pq)
  (pq-merge lt? (list x) pq))

(define (pq-merge-pairs lt? ps)
  (cond ((null? ps) '())
        ((null? (cdr ps)) (car ps))
        (else (pq-merge lt? (pq-merge lt? (car ps) (cadr ps))
                            (pq-merge-pairs lt? (cddr ps))))))

(define (pq-rest lt? pq)
  (if (null? pq)
      (error 'pq-rest "can't delete minimum from null queue")
      (pq-merge-pairs lt? (cdr pq)))) 
```

现在是算法。函数`f`有两个参数，集合*ps*中的数字列表和从输出的头部输出的项目数*n 。*算法略有改变；通过按 1 初始化优先级队列，然后开始提取步骤。变量*p*为前一个输出值（初始为0），*pq*为优先队列，*xs*为输出列表，逆序累加。这是代码：

```
(define (f ps n)
  (let loop ((n n) (p 0) (pq (pq-insert < 1 pq-empty)) (xs (list)))
    (cond ((zero? n) (reverse xs))
          ((= (pq-first pq) p) (loop n p (pq-rest < pq) xs))
          (else (loop (- n 1) (pq-first pq) (update < pq ps)
                      (cons (pq-first pq) xs)))))) 
```

对于那些不熟悉 Scheme 的人来说，这`loop`是一个局部定义的函数，它被递归调用，`cond`是 if-else 链的头部；在这种情况下，有三个`cond`子句，每个子句都有一个谓词和一个后件，后件为第一个谓词为真的子句进行评估。谓词`(zero? n)`终止递归并以正确的顺序返回输出列表。谓词`(= (pq-first pq) p)`表示优先级队列的当前头部先前已输出，因此通过在第一项之后与优先级队列的其余部分重复来跳过它。最后，`else`谓词始终为真，它标识要输出的新数字，因此它递减计数器，将优先级队列的当前头部保存为新的先前值，更新优先级队列以添加当前数字的新子代，并且将优先级队列的当前头插入到累积输出中。

由于更新优先级队列以添加当前编号的新子代并非易事，因此该操作被提取到单独的函数中：

```
(define (update lt? pq ps)
  (let loop ((ps ps) (pq pq))
    (if (null? ps) (pq-rest lt? pq)
      (loop (cdr ps) (pq-insert lt? (* (pq-first pq) (car ps)) pq))))) 
```

该函数循环遍历`ps`集合的元素，依次将每个元素插入优先级队列；当列表用完时，`if`返回更新的优先级队列，减去它的旧头。`ps`递归步骤剥去`ps`列表`cdr`的头部，并将优先级队列的头部和列表的头部的乘积插入`ps`到优先级队列中。

下面是算法的两个例子：

```
> (f '(2 5) 20)
(1 2 4 5 8 10 16 20 25 32 40 50 64 80 100 125 128 160 200 250)
> (f '(2 3 5) 20)
(1 2 3 4 5 6 8 9 10 12 15 16 18 20 24 25 27 30 32 36) 
```

您可以在[http://ideone.com/sA1nn](http://ideone.com/sA1nn)运行该程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-12T15:50:47.970

根据 user448810 的回答，这是一个使用 STL 中的堆和向量的解决方案。
现在，堆通常会输出最大值，因此我们将负数存储为一种解决方法（因为`a>b <==> -a<-b`）。

```
#include <vector>
#include <iostream>
#include <algorithm>

int main()
{
    std::vector<int> primes;
    primes.push_back(2);
    primes.push_back(5);//Our prime numbers that we get to use

    std::vector<int> heap;//the heap that is going to store our possible values
    heap.push_back(-1);
    std::vector<int> outputs;
    outputs.push_back(1);
    while(outputs.size() < 10)
    {
        std::pop_heap(heap.begin(), heap.end());
        int nValue = -*heap.rbegin();//Get current smallest number
        heap.pop_back();
        if(nValue != *outputs.rbegin())//Is it a repeat?
        {
            outputs.push_back(nValue);
        }
        for(unsigned int i = 0; i < primes.size(); i++)
        {
            heap.push_back(-nValue * primes[i]);//add new values
            std::push_heap(heap.begin(), heap.end());
        }
    }
    //output our answer
    for(unsigned int i = 0; i < outputs.size(); i++)
    {
        std::cout << outputs[i] << " ";
    }
    std::cout << std::endl;
} 
```

输出：

```
1 2 4 5 8 10 16 20 25 32 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-12T15:34:24.093

这种二维探索算法并不精确，但适用于前 25 个整数，然后混合了 625 和 512。

![2 和 5 的幂](../Images/275437d7959b5c07b430f121a8ea2ffd.png)

```
n = 0
exp_before_5 = 2
while true
  i = 0
  do
    output 2^(n-exp_before_5*i) * 5^Max(0, n-exp_before_5*(i+1))
    i <- i + 1
  loop while n-exp_before_5*(i+1) >= 0
  n <- n + 1
end while 
```~~****

# jquery - jQuery更改类

> ID：10126290
> 
> 赞同：2
> 
> 时间：2012-04-12T15:02:21.213
> 
> 标签：jquery, jquery-ui

我正在尝试更改位于 h3 内的跨度的类，但我做不到。这是我想要完成的链接：http: [//jsfiddle.net/WPxG4/9/](http://jsfiddle.net/WPxG4/9/)

代码：

```
jQuery(document).ready(function() {
    $('h3').click(function() {
        $(this).next('ul').toggle();
        $(this).next('span').toggleClass('special1', 'special');
        return false;
    }).next().hide();
}); 
```

HTML：

```
<h3><span class="special"></span><a href="#">Heading 1</a></h3>
<ul>
    <li><a href="#">List one two there</a></li>
    <li><a href="#">List one two there</a></li>
    <li><a href="#">List one two there</a></li>
    <li><a href="#">List one two there</a></li>
    <li><a href="#">List one two there</a></li>
    <li><a href="#">List one two there</a></li>
    <li><a href="#">List one two there</a></li>
</ul> 
```

​</p>

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T15:03:46.190

**不**使用`$(this).find('span')` **`$(this).next('span')`**

# jsf-2 - 数据表中重复的数据

> ID：10126291
> 
> 赞同：0
> 
> 时间：2012-04-12T15:02:28.703
> 
> 标签：jsf-2, datatable, duplicate-data

我对使用 Tomahawk 的 dataTable 组件有疑问。

我想在某些列中创建一个包含子列的数据表。像这样的东西：

![我的数据表](../Images/463b9d956b2d8395cbceb5b4042ef15e.png) 该表只有 2 行，但重复。这是代码：

```
 <t:dataTable id="tabla1" value="#{userControl.mc64cljobs_encolados}" var="clh"> 
                        <t:column id="col1" >
                         <f:facet name="header" >
                              <h:outputText styleClass="leftColumn" value="Options"/>
                         </f:facet>
                         <t:dataTable id="tabla2" value="#{userControl.mc64cljobs_encolados}" var="clh1">
                             <t:column id="col11">
                                <f:facet name="header" >
                                    <h:outputText styleClass="leftColumn" value="Delete Work"/>
                                </f:facet>
                                    <center>
                                        <h:form>
                                            <h:commandLink actionListener="#{userControl.eliminaTrabajo(clh1.codigo, 'multicore64clustalwtrabajos', userControl.user, userControl.password, clh1.fileSequences, '')}"  value="Delete" />
                                        </h:form>
                                    </center>

</t:column>          

                        <t:column id="col12">
                            <f:facet name="header" >
                                 File Sequence Fasta
                            </f:facet>
                            <center>
                                <h:form>
                                   <h:commandLink target="popupWindow" action="popupWindow" actionListener="#{userControl.setOpenFile(clh1.fileSequences)}"  value="FILE 1" />
                                </h:form>
                            </center>
                        </t:column>
                 </t:dataTable>

        </t:column>

<t:column id="col2" >
                   <f:facet  name="header">
                        Pairwise alignment parameters
                   </f:facet> 

                 <t:dataTable id="tabla3" value="#{userControl.mc64cljobs_encolados}" var="clh2" >
                 <t:column id="col21" >
                     <f:facet name="header"  >
                        Gap Open Cost
                   </f:facet>  
                     #{clh2.costeOpenGap}

                </t:column>
                 <t:column  id="col22">
                   <f:facet  name="header">
                        Gap Extend Cost
                   </f:facet>  
                     #{clh2.costeExtendGap}

                </t:column>

                   <t:column  id="col23">
                     <f:facet name="header"  >
                        Cost Matrix
                   </f:facet>  
                     #{clh2.scoringMatrix}

  </t:column>
                 <t:column  id="col24">
                   <f:facet  name="header">
                        Cost Match/Replace
                   </f:facet>  
                     #{clh2.costeMatchReplace}

                </t:column>
                 </t:dataTable>
             </t:column>
          </h:dataTable> 
```

我在该代码中的错误是什么？我究竟做错了什么？

太感谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:36:52.010

检查这个： [为什么 JSF 多次调用 getter](https://stackoverflow.com/questions/2090033/why-jsf-calls-getters-multiple-times/2090062#2090062) 在 jsf 生命周期中可以多次调用 getter

# java - 使用 Threading 设置后台进程以处理 Android 中的工作

> ID：10126295
> 
> 赞同：-1
> 
> 时间：2012-04-12T15:02:36.940
> 
> 标签：java, android, multithreading, user-interface, background-process

您好，我正在尝试在执行时创建一个示例应用程序，它将带您回到主屏幕，运行后台进程并显示 toast points。

我认为我需要在后台进程中使用一个单独的线程来完成我需要的任何工作。这是我的主要活动的代码（BackGroundPrcessingExampleActivity）：

```
enter code here
public class BackGroundProcessExampleActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        try {

            Intent myIntent = new Intent(this, MyService.class);
            startService(myIntent);

            moveTaskToBack(false);

        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

这是来自“MyService.java”的代码：

```
enter code here
public int onStartCommand(Intent intent, int flags, int startId) {

    Toast.makeText(getBaseContext(), "Service is started!", 1).show();

    myHandler = new Handler() {

        @Override
        public void handleMessage(Message msg) {

            super.handleMessage(msg);

                Toast.makeText(getBaseContext(), "Hello!",
                        Toast.LENGTH_SHORT).show();
        }
    };

    Runnable runnable = new Runnable() {
        @Override
        public void run() {

            while (true) {

                try {               

                    Thread.sleep(2);

                    myHandler.sendEmptyMessage(0);

                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }
    };
    new Thread(runnable).start();

    return super.onStartCommand(intent, flags, startId);
} 
```

我遇到的问题是没有出现 Toast 消息。我可以设置断点并查看它正在单步执行代码，但没有出现任何消​​息。我认为可能是上下文不正确？我需要 UI 的上下文（BackGroundPRcessExampleActivity）吗？任何帮助表示赞赏，在此先感谢。

D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T11:41:38.993

在回复的帮助下，这最终对我有用。添加了通知代码。

```
 @Override
public int onStartCommand(Intent intent, int flags, int startId) {

    final NotificationManager notificationManager = (NotificationManager) 
            getSystemService(NOTIFICATION_SERVICE);

    // Create Notifcation
    final Notification notification = new Notification(R.drawable.ic_launcher,
        "A new notification", System.currentTimeMillis());

    // Cancel the notification after its selected
    notification.flags |= Notification.FLAG_AUTO_CANCEL;
    //
    notification.number += 1;

    // Specify the called Activity
    Intent intent2 = new Intent(this, NotificationReceiver.class);

    Toast.makeText(getApplicationContext(), "Service is started!", 1)
            .show();

    PendingIntent activity = PendingIntent.getActivity(this, 0, intent2, 0);
    notification.setLatestEventInfo(this, "This is the title",
        "This is the text", activity);

    myHandler = new Handler();

    Runnable runnable = new Runnable() {
        @Override
        public void run() {
            int i = 0;

            while (true) {
                final int x = i++;

                try {
                    Thread.sleep(500);
                } catch (InterruptedException e1) {
                    e1.printStackTrace();
                }

                myHandler.post(new Runnable() {

                    @Override
                    public void run() {

                        try {
                            Toast.makeText(getApplicationContext(),
                                    "Hello!" + String.valueOf(x),
                                    3).show();

                            if(x == 100)
                                notificationManager.notify(0, notification);
                            Thread.sleep(1);

                        } catch (InterruptedException e) {
                            e.printStackTrace();
                        }
                    }
                });
            }
        }
    };
    new Thread(runnable).start(); 
```

谢谢大家的帮助。

D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T16:15:05.520

试试看 -

```
public int onStartCommand(Intent intent, int flags, int startId) {
Handler mHandler = new Handler();
Toast.makeText(getApplicationContext(), "Service is started!", 1).show();

Runnable runnable = new Runnable() {
    @Override
    public void run() {
        while (true) {
            try { 
                Thread.sleep(5000);

                mHandler.post(new Runnable() {
              @Override
               public void run() {
                        Toast.makeText(getApplicationContext(), "Hello!", Toast.LENGTH_LONG).show();
                  }
               });
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
};
new Thread(runnable).start();

return super.onStartCommand(intent, flags, startId); 
```

}

# sql - SQL DELETE 遇到约束

> ID：10126296
> 
> 赞同：2
> 
> 时间：2012-04-12T15:02:38.490
> 
> 标签：sql, sql-server, database

让我们看看著名的 Nortwind 数据库。说我跑`DELETE FROM Clients`。

在 MSAccess 中，当对具有参照完整性约束的表运行 DELETE 语句时，Jet 将删除它*可以*删除的记录，并保留其他记录。在这种情况下，它只会删除`Clients`没有`Orders`.
在 SQL Server 中，这样做似乎只是失败，并显示一条消息指出`The DELETE statement conflicted with the REFERENCE constraint ....`.

因此，我的问题是：有没有一种简单的方法可以让 SQL Server 只删除那些**可以删除**的记录？还是我必须添加一个`WHERE ClientId NOT IN (SELECT Id FROM Clients)`？
换句话说，我可以让 SQL Server`DELETE`像 Jet 一样工作`DELETE`吗？

信息：我不是那么懒惰，但那里有很多限制，我想保持我的代码简单......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T18:28:33.603

另一种方法是循环删除（逐行）使用`CURSOR`和`TRY .. CATCH`块来忽略删除引用行的问题。

在这种方法中，您不必对现有和未来的约束进行建模。

例子：

```
SET NOCOUNT ON; -- use not to have "(N row(s) affected)" for each deleted row

DECLARE del_cursor CURSOR
FOR SELECT ClientID FROM Clients

DECLARE @CurrentClientID INT -- use your proper type
DECLARE @message VARCHAR(200) -- just for building messages

OPEN del_cursor

FETCH NEXT FROM del_cursor
INTO @CurrentClientID

WHILE @@FETCH_STATUS = 0
BEGIN
    BEGIN TRY
        DELETE FROM Clients WHERE CURRENT OF del_cursor
    END TRY
    BEGIN CATCH
        SET @message = 'Row ' + CAST(@CurrentClientID AS VARCHAR) + ' cannot be deleted - skipping.'
        PRINT @message
    END CATCH

    FETCH NEXT FROM del_cursor
    INTO @CurrentClientID
END

CLOSE del_cursor
DEALLOCATE del_cursor 
```

您可以将上面的示例包装为`CREATE PROCEDURE DeleteClients`并使用`EXEC DeleteClients`，而不是`DELETE FROM Clients`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:06:09.070

您的选择是：

1.  级联删除 - 将删除依赖于这些客户端的所有记录。
2.  删除约束（我不推荐这个:)）
3.  提前检查是否可以删除，不会有冲突

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:15:37.047

如果您想保留具有 FK 引用的行，那么只有几个选项，而且没有一个是漂亮的：

1.  在执行删除之前检查约束
2.  如您在问题中提到的，修改查询以包含 FK 的 where 子句
3.  更改您的逻辑以一次删除一个行，提交每一行并在删除失败时回滚删除。

“最不糟糕”选项实际上取决于有多少 FK，您将删除多少行以及一行具有 FK 依赖关系的可能性。如果这是一个相对罕见的事件，那么选项#3 可能是最好的，尽管我倾向于倾向于前两个选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T16:43:05.840

*   如果你想保持代码简单（你说过）让你`CREATE VIEW`在你的桌子上。
*   定义`WHERE`子句以仅获取可删除的行。
*   那么你可能只是`DELETE FROM ClientsDeletable`.
*   记住新视图的 DELETE 权限。

脚本示例：

```
CREATE VIEW ClientsDeletable
AS
SELECT * 
FROM Clients
WHERE
ClientID NOT IN (SELECT CliID FROM ForeignTab1)
AND
ClientID NOT IN (SELECT CliID FROM ForeignTab2) 
```

请注意，它`FROM`不能包含 JOIN - 其他方式你会得到错误：

```
Msg 4405, Level 16, State 1, Line 1
View or function 'ClientsDeletable' is not updatable because the modification affects multiple base tables. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T15:18:17.727

我知道这是一个有点复杂的解决方案，但你只需要做一次。

防止删除的触发器怎么样？

```
create table parent(
id int not null primary key
)
create table son(
id int not null primary key,
idparent int)

alter table son add foreign key(idparent) references parent(id)

insert into parent values(1)
insert into parent values(2)
insert into parent values(3)

insert into son values(1,1)

--select * from parent
--select * from son

create trigger preventDelete
on parent
instead of delete
as
begin
  delete from parent where id not in (select idparent from son) and id in (select id from deleted)
end

delete from parent 
```

记录 2 和 3 将被删除

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-12T15:59:13.687

试试这个，它会生成你的语句。请原谅我写得很快的格式：

```
DECLARE @i INT, @SQL NVARCHAR(2000), @TABLENAME NVARCHAR(100)
SET @i = 1
SET @TABLENAME = 'informer_alert'
SET @SQL = ''

DECLARE @col VARCHAR(50), @basecol VARCHAR(50), @tname VARCHAR(50)

DECLARE @TABLE TABLE ([table] VARCHAR(50), col VARCHAR(50), basecol VARCHAR(50))
INSERT INTO @TABLE
SELECT t.name, sc.name, sc2.name
FROM sys.foreign_key_columns fk
INNER JOIN sys.tables t ON fk.parent_object_id = t.OBJECT_ID
INNER JOIN syscolumns sc ON fk.parent_column_id = sc.colorder
AND sc.id = fk.parent_object_id
INNER JOIN syscolumns sc2 ON fk.referenced_object_id = sc2.id
AND fk.constraint_column_id = sc2.colorder
WHERE fk.referenced_object_id = (SELECT OBJECT_ID 
                                    FROM sys.tables 
                                    WHERE name = @TABLENAME)

WHILE (@i <= (SELECT COUNT(*) FROM @TABLE))
BEGIN

    SELECT @tname = [table], @col = col, @basecol = basecol
    FROM (SELECT    ROW_NUMBER() OVER(ORDER BY col) [N],
            [table], col, basecol
            FROM @TABLE) A
    WHERE A.N = @i

    SET @SQL = @SQL + ' DELETE FROM ' + @TABLENAME + ' WHERE ' + @basecol  + ' NOT IN (SELECT ' + @col+ ' FROM ' + @tname + ')'

    SET @i = @i + 1

END

SELECT @SQL 
```

# java - 填充 JTable 的第一列

> ID：10126299
> 
> 赞同：1
> 
> 时间：2012-04-12T15:02:56.570
> 
> 标签：java, swing, user-interface, jtable, abstracttablemodel

如何使用 AbstractTableModel 预填充 JTable 的第一列？

我想在第一列中放入时间段，然后用其他内容填充其他列。

好的，因此 GUI 中的 JTables 将使用 ChannelTableModel。基本上它从 6.30 - 24:00 设置 30 分钟的时间段。时隙必须放在 JTable 的第一行

在某种程度上，我需要设置一个变量“行”来获取 AbstractTableModel 中的行值，我发现这很难做到。

以下是到目前为止的代码。

代码：

```
import java.util.List;
import javax.swing.table.AbstractTableModel;

public class ChannelTableModel extends AbstractTableModel
{

    public ChannelTableModel(List<Program> schedule)
    {
        this.channel= schedule;
    }

    public int getColumnCount() 
    {
        return 3;
    }

    public int getRowCount() 
    {
        return 37;
    }

    public Object getValueAt(int rowIndex, int columnIndex) 
    {

        switch (columnIndex)
        {
        case 0: return 6+((row*30) / 60)+":"+(row % 2 == 0 ? "00" : "30") + " - " + (6 +(((row+1)*30) / 60)+":"+(row % 2 != 0 ? "00" : "30"));
        default: return "Not Available.";
        }

    }

} 
```

如何创建变量“row”以使 TableModel 可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T16:15:46.513

通常，您只会对第一列进行特殊处理。例如，如果“真实数据”在矩阵中。示意图：

```
public class AddColumn0TableModel extends AbstractTableModel {

    final int columnCount, rowCount;
    final Object wrappedData[][];

    public AddColumn0TableModel(Object[][] wrappedData) {
       this.wrappedData = wrappedData;
       //  assume nice square data, YMMV
       columnCount= 1 + wrappedData.length;
       rowCount = wrappedData[0].length;
    }

    public int getRowCount() { return rowCount; }

    public int getColumnCount() { return columnCount; }

    public Object getValueAt(int row, int column) {
       if (column == 0)
         // implement this, in your case the time slot
         return theSpecialThingForColumn0(row);
       else
          return wrappedData[column-1][row];
    }

} 
```

ps 与您的订购相比，我在矩阵上的订购错误有 50/50 的可能性。:-)

# css - IE8 的样式问题

> ID：10126302
> 
> 赞同：1
> 
> 时间：2012-04-12T15:03:09.440
> 
> 标签：css, internet-explorer-8, styles

我有一个问题： [http ://tinyurl.com/7rb66t4](http://tinyurl.com/7rb66t4)

它基本上是这个模板： [http ://www.display-inline.fr/demo/constellation/template/login.php](http://www.display-inline.fr/demo/constellation/template/login.php)

但该模板在 Chrome、Firefox 和 Safari 中运行良好。只是 IE 会出问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:06:42.673

您似乎缺少文件顶部的 doctype 属性

# php - 选项国家 html 和 mysql

> ID：10126305
> 
> 赞同：0
> 
> 时间：2012-04-12T15:03:16.760
> 
> 标签：php, mysql, option

所以我有这个选项国家，比如这个网站[http://www.mediacollege.com/internet/samples/html/country-list.html](http://www.mediacollege.com/internet/samples/html/country-list.html)，我在一个表mysql中有一个字段国家。我想读取 mysql 中的字段 country 并在选项中选择与 mysql 中的字段匹配的国家。

我在 mysql 数据库中读取没有问题，我的问题是如何在这样的巨大列表中选择正确的选项国家。让一一变得不切实际

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:08:14.177

你应该有一个循环，你可以通过所有选项..比如

```
foreach($countries as $key=>$value){
 echo '<option value="'.$key.'" '.($key == $selected_country ? 'selected=selected':'').'>'.$value.'</option>';
} 
```

如果您使用多项选择，则不要使用比较，而是使用`in_array`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:11:06.797

```
<?php

$Countries = array(
"AF"    =>  "Afghanistan",
"AL"    =>  "Albania",
"DZ"    =>  "Algeria",
"AS"    =>  "American Samoa",
"AD"    =>  "Andorra",
"AG"    =>  "Angola",
"AI"    =>  "Anguilla",
"AG"    =>  "Antigua &amp; Barbuda",
"AR"    =>  "Argentina",
"AA"    =>  "Armenia",
"AW"    =>  "Aruba",
"AU"    =>  "Australia",
"AT"    =>  "Austria",
"AZ"    =>  "Azerbaijan",
"BS"    =>  "Bahamas",
"BH"    =>  "Bahrain",
"BD"    =>  "Bangladesh",
"BB"    =>  "Barbados",
"BY"    =>  "Belarus",
"BE"    =>  "Belgium",
"BZ"    =>  "Belize",
"BJ"    =>  "Benin",
"BM"    =>  "Bermuda",
"BT"    =>  "Bhutan",
"BO"    =>  "Bolivia",
"BL"    =>  "Bonaire",
"BA"    =>  "Bosnia &amp; Herzegovina",
"BW"    =>  "Botswana",
"BR"    =>  "Brazil",
"BC"    =>  "British Indian Ocean Territory",
"BN"    =>  "Brunei",
"BG"    =>  "Bulgaria",
"BF"    =>  "Burkina Faso",
"BI"    =>  "Burundi",
"KH"    =>  "Cambodia",
"CM"    =>  "Cameroon",
"CA"    =>  "Canada",
"IC"    =>  "Canary Islands",
"CV"    =>  "Cape Verde",
"KY"    =>  "Cayman Islands",
"CF"    =>  "Central African Republic",
"TD"    =>  "Chad",
"CD"    =>  "Channel Islands",
"CL"    =>  "Chile",
"CN"    =>  "China",
"CI"    =>  "Christmas Island",
"CS"    =>  "Cocos Island",
"CO"    =>  "Colombia",
"CC"    =>  "Comoros",
"CG"    =>  "Congo",
"CK"    =>  "Cook Islands",
"CR"    =>  "Costa Rica",
"CT"    =>  "Cote D'Ivoire",
"HR"    =>  "Croatia",
"CU"    =>  "Cuba",
"CB"    =>  "Curacao",
"CY"    =>  "Cyprus",
"CZ"    =>  "Czech Republic",
"DK"    =>  "Denmark",
"DJ"    =>  "Djibouti",
"DM"    =>  "Dominica",
"DO"    =>  "Dominican Republic",
"TM"    =>  "East Timor",
"EC"    =>  "Ecuador",
"EG"    =>  "Egypt",
"SV"    =>  "El Salvador",
"GQ"    =>  "Equatorial Guinea",
"ER"    =>  "Eritrea",
"EE"    =>  "Estonia",
"ET"    =>  "Ethiopia",
"FA"    =>  "Falkland Islands",
"FO"    =>  "Faroe Islands",
"FJ"    =>  "Fiji",
"FI"    =>  "Finland",
"FR"    =>  "France",
"GF"    =>  "French Guiana",
"PF"    =>  "French Polynesia",
"FS"    =>  "French Southern Territory",
"GA"    =>  "Gabon",
"GM"    =>  "Gambia",
"GE"    =>  "Georgia",
"DE"    =>  "Germany",
"GH"    =>  "Ghana",
"GI"    =>  "Gibraltar",
"GB"    =>  "Great Britain",
"GR"    =>  "Greece",
"GL"    =>  "Greenland",
"GD"    =>  "Grenada",
"GP"    =>  "Guadeloupe",
"GU"    =>  "Guam",
"GT"    =>  "Guatemala",
"GN"    =>  "Guinea",
"GY"    =>  "Guyana",
"HT"    =>  "Haiti",
"HW"    =>  "Hawaii",
"HN"    =>  "Honduras",
"HK"    =>  "Hong Kong",
"HU"    =>  "Hungary",
"IS"    =>  "Iceland",
"IN"    =>  "India",
"ID"    =>  "Indonesia",
"IA"    =>  "Iran",
"IQ"    =>  "Iraq",
"IE"    =>  "Ireland",
"IM"    =>  "Isle of Man",
"IL"    =>  "Israel",
"IT"    =>  "Italy",
"JM"    =>  "Jamaica",
"JP"    =>  "Japan",
"JO"    =>  "Jordan",
"KZ"    =>  "Kazakhstan",
"KE"    =>  "Kenya",
"KI"    =>  "Kiribati",
"NK"    =>  "Korea North",
"KR"    =>  "Korea South",
"KW"    =>  "Kuwait",
"KG"    =>  "Kyrgyzstan",
"LA"    =>  "Laos",
"LV"    =>  "Latvia",
"LB"    =>  "Lebanon",
"LS"    =>  "Lesotho",
"LR"    =>  "Liberia",
"LY"    =>  "Libya",
"LI"    =>  "Liechtenstein",
"LT"    =>  "Lithuania",
"LU"    =>  "Luxembourg",
"MO"    =>  "Macau",
"MK"    =>  "Macedonia",
"MG"    =>  "Madagascar",
"MY"    =>  "Malaysia",
"MW"    =>  "Malawi",
"MV"    =>  "Maldives",
"ML"    =>  "Mali",
"MT"    =>  "Malta",
"MH"    =>  "Marshall Islands",
"MQ"    =>  "Martinique",
"MR"    =>  "Mauritania",
"MU"    =>  "Mauritius",
"ME"    =>  "Mayotte",
"MX"    =>  "Mexico",
"MI"    =>  "Midway Islands",
"MD"    =>  "Moldova",
"MC"    =>  "Monaco",
"MN"    =>  "Mongolia",
"MS"    =>  "Montserrat",
"MA"    =>  "Morocco",
"MZ"    =>  "Mozambique",
"MM"    =>  "Myanmar",
"NA"    =>  "Nambia",
"NU"    =>  "Nauru",
"NP"    =>  "Nepal",
"AN"    =>  "Netherland Antilles",
"NL"    =>  "Netherlands",
"NV"    =>  "Nevis",
"NC"    =>  "New Caledonia",
"NZ"    =>  "New Zealand",
"NI"    =>  "Nicaragua",
"NE"    =>  "Niger",
"NG"    =>  "Nigeria",
"NW"    =>  "Niue",
"NF"    =>  "Norfolk Island",
"NO"    =>  "Norway",
"OM"    =>  "Oman",
"PK"    =>  "Pakistan",
"PW"    =>  "Palau Island",
"PS"    =>  "Palestine",
"PA"    =>  "Panama",
"PG"    =>  "Papua New Guinea",
"PY"    =>  "Paraguay",
"PE"    =>  "Peru",
"PH"    =>  "Philippines",
"PO"    =>  "Pitcairn Island",
"PL"    =>  "Poland",
"PT"    =>  "Portugal",
"PR"    =>  "Puerto Rico",
"QA"    =>  "Qatar",
"RE"    =>  "Reunion",
"RO"    =>  "Romania",
"RU"    =>  "Russia",
"RW"    =>  "Rwanda",
"NT"    =>  "St Barthelemy",
"EU"    =>  "St Eustatius",
"HE"    =>  "St Helena",
"KN"    =>  "St Kitts-Nevis",
"LC"    =>  "St Lucia",
"MB"    =>  "St Maarten",
"PM"    =>  "St Pierre &amp; Miquelon",
"VC"    =>  "St Vincent &amp; Grenadines",
"SP"    =>  "Saipan",
"SO"    =>  "Samoa",
"AS"    =>  "Samoa American",
"SM"    =>  "San Marino",
"ST"    =>  "Sao Tome &amp; Principe",
"SA"    =>  "Saudi Arabia",
"SN"    =>  "Senegal",
"SC"    =>  "Seychelles",
//"S0"  =>  "Serbia",
"SL"    =>  "Sierra Leone",
"SG"    =>  "Singapore",
"SK"    =>  "Slovakia",
"SI"    =>  "Slovenia",
"SB"    =>  "Solomon Islands",
"OI"    =>  "Somalia",
"ZA"    =>  "South Africa",
"ES"    =>  "Spain",
"LK"    =>  "Sri Lanka",
"SD"    =>  "Sudan",
"SR"    =>  "Suriname",
"SZ"    =>  "Swaziland",
"SE"    =>  "Sweden",
"CH"    =>  "Switzerland",
"SY"    =>  "Syria",
"TA"    =>  "Tahiti",
"TW"    =>  "Taiwan",
"TJ"    =>  "Tajikistan",
"TZ"    =>  "Tanzania",
"TH"    =>  "Thailand",
"TG"    =>  "Togo",
"TK"    =>  "Tokelau",
"TO"    =>  "Tonga",
"TT"    =>  "Trinidad &amp; Tobago",
"TN"    =>  "Tunisia",
"TR"    =>  "Turkey",
"TU"    =>  "Turkmenistan",
"TC"    =>  "Turks &amp; Caicos Is",
"TV"    =>  "Tuvalu",
"UG"    =>  "Uganda",
"UA"    =>  "Ukraine",
"AE"    =>  "United Arab Emirates",
"GB"    =>  "United Kingdom",
"US"    =>  "United States of America",
"UY"    =>  "Uruguay",
"UZ"    =>  "Uzbekistan",
"VU"    =>  "Vanuatu",
"VA"    =>  "Vatican City State",
"VE"    =>  "Venezuela",
"VN"    =>  "Vietnam",
"VB"    =>  "Virgin Islands (Brit)",
"VA"    =>  "Virgin Islands (USA)",
"WF"    =>  "Wallis &amp; Futana Is",
"YE"    =>  "Yemen",
"ZR"    =>  "Zaire",
"ZM"    =>  "Zambia",
"ZW"    =>  "Zimbabwe"
); 
```

这是我之前制作的一个 - 您可以使用它来生成下拉列表，然后在从数据库中读取时，您可以使用 2 个字母的国家/地区代码作为此键：

```
$Countries[$mysqlCountryCode]; 
```

获取您的完整国家/地区名称。

这绝对不是优雅的——但你必须将数据存储在某个地方，无论是在 mysql 表中还是在数组中。

# ruby-on-rails - 在分页时而不是事先获取对象？（导轨 + Kaminari）

> ID：10126316
> 
> 赞同：0
> 
> 时间：2012-04-12T15:04:06.703
> 
> 标签：ruby-on-rails, pagination, kaminari

所以我有一个搜索控制器，它返回一组对象 ID（在本例中为“用户”）。

由于搜索结果数组可以包含数百个 ID，我宁愿仅在需要将它们发送到视图时才获取实际对象本身。简而言之，我想使用分页为每个 ID 块（即 1..10、11..20 等）预先获取对象本身，而不是让视图逻辑获取对象。我不知道如何做到这一点。

**我的控制器代码**

```
users = [1,3,456,23423,234,23...]
#somehow have the pagination get the Objects from DB for each page
@persons = Kaminari.paginate_array(users).page(params[:page]).per(10) 
```

**看法**

```
- @persons.each do |person| #I WANT TO HAVE THE FULL WRITER OBJECT BY NOW
  = person.name             # instead of doing a 'User.find(person.id)' in the view 
```

有任何想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:17:02.127

我是个白痴。您可以根据 @persons 数组映射或收集一个新数组

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:18:01.550

在 url 中放一个页码参数。然后，如果您想每页显示 10 个并假设用户单击第三页，则将页码减去一页 (10) 并添加一页，得到 21。这是您开始查询数据库。并限制为 10 个结果

# codeigniter - 使用 Zend Studio 的 CodeIgniter 的代码完成不工作

> ID：10126320
> 
> 赞同：0
> 
> 时间：2012-04-12T15:04:26.460
> 
> 标签：codeigniter, ide, zend-studio

好的，所以我尝试按照[这篇](https://stackoverflow.com/questions/1080068/how-to-get-zend-studio-autocomplete-with-codeigniter)文章所说的向 zend studio 添加代码完成，即使库添加了代码提示/完成仍然无法显示。随着我的库的增长，拥有这个功能变得越来越重要，因为我开始忘记我的方法实际上是为什么设计的或它们叫什么。从控制器中，模型甚至可以查看我希望在键入后显示它`$this->router->(show completion)`作为示例。我还为我的自定义库添加了应用程序/库路径，它们也不会显示。

我已经做了一些谷歌搜索，但大多数人只是说按照上面的帖子所说的去做。我试图尝试`/* @var $var Class */`但无法为其分配一个属性，例如。`/* @var $this->router CI_Router */`只是一个标准变量..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-24T10:33:45.057

只需通过这样的评论即可解决此问题

> /**
> * @var CI_Loader
> */
> $load

而不仅仅是做

> /* @var ........ */

# c# - 构建工作流中的 CheckInGatedChanges 活动位置

> ID：10126323
> 
> 赞同：6
> 
> 时间：2012-04-12T15:04:31.300
> 
> 标签：c#, .net, .net-4.0, tfsbuild

默认构建模板具有在`CheckInGatedChanges`活动之外运行的活动（“签入门控更改”）`AgentScope`（“在代理上运行”）。

是否有一个原因？或者更确切地说，是否可以将`CheckInGatedChanges`活动移到`AgentScope`流程的末尾（序列的末尾）？

我的*猜测*是，微软不希望代理本身签入更改，而是希望控制器签入。我不确定，因为我不知道他们拥有的控制器代理模型的内部工作原理。

我问的原因是因为我**需要在签入更改*****后***运行一个活动，而这目前迫使我使用 AgentScope 活动的另一个实例。我宁愿将它们全部放在第一个 AgentScope 活动中，而不使用额外的资源。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:23:14.620

CheckInGatedChanges 在模板中的当前位置确保如果您向模板添加额外的活动，它们不会在更改提交到服务器后意外运行。此外，它允许并行代理执行。例如，如果您想将构建并行化到多个代理以进行扩展，则需要在所有构建代理工作流程完成后进行签入。

这些是我能想到的原因。我认为这是安全的，如果你知道你不需要一个收敛点来签入你的更改，将 CheckInGatedChanges 活动移动到 AgentScope 中，这样你就不必产生另一个 AgentScope 来完成你的自定义工作。我不认为我们限制了这项活动的范围。

# ios - UITextfield 的清除按钮在 UIScrollView 内部时隐藏键盘

> ID：10126324
> 
> 赞同：5
> 
> 时间：2012-04-12T15:04:32.337
> 
> 标签：ios, xcode, uiscrollview, uitextfield

我在 UIScrollView 中有一个文本字段，我想在用户开始编辑时显示一个清除按钮。当用户点击 UIScrollview 的背景（但不是文本字段）时，我还需要隐藏键盘。显示那个清除按钮不是问题，问题是当点击清除按钮时键盘被隐藏并且文本字段没有被清除。显然，问题出在手势识别器上，因为处理此问题的方法会在单击清除按钮时触发（但在点击文本字段时不会触发）。这是我的代码：

```
 //adding gesture recognizer so i can hide keyboard when user taps scrollview
    - (void) textFieldDidBeginEditing:(UITextField *)textField
    {
        if (self.tapOutside == nil) self.tapOutside = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(textFieldTouchOutSide:)];

        [self.scrollView addGestureRecognizer:self.tapOutside];
    }

    //This hides keyboard BUT IS ALSO CALLED WHEN CLEAR BUTTON IS TAPPED
    - (void)textFieldTouchOutSide:(id)sender
    {
        [self.textfield resignFirstResponder];
    }

    //NEVER GETS CALLED
    - (BOOL) textFieldShouldClear:(UITextField *)textField {
        return YES;
    } 
```

任何想法如何解决这个问题？也许添加手势识别器的更好方法？我想不出没有优雅的解决方案......提前非常感谢......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-02T15:12:29.853

我遇到了同样的问题并通过以下方法解决了它：

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {
    // Disallow recognition of gestures in unwanted elements
    if ([touch.view isMemberOfClass:[UIButton class]]) { // The "clear text" icon is a UIButton
        return NO;
    }
    return YES;
} 
```

不要忘记遵守“UIGestureRecognizerDelegate”协议并设置委托（使用您的变量）：

```
self.tapOutside.delegate = self; 
```

干杯

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T15:29:06.340

我只是遇到了这个问题并且这个解决方案有效，但是如果您在视图上确实有其他按钮允许用户在填写表单时点击，您可以执行以下操作：

```
-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {
// Disallow recognition of gestures in unwanted elements
if ([touch.view isMemberOfClass:[UIButton class]] && [touch.view.superview isMemberOfClass:[UITextField class]]) { 

    // The "clear text" icon is a UIButton
    return NO;
}
return YES;
} 
```

如果按钮是 UITextField 的子视图，这将缩小案例仅返回 No，就像清除按钮的情况一样，但如果他们触摸通常会执行您的手势代码的普通按钮，仍然隐藏键盘。

# iphone - 将 OAuthConsumer 链接到 Xcode 项目

> ID：10126332
> 
> 赞同：2
> 
> 时间：2012-04-12T15:05:03.570
> 
> 标签：iphone, ios, xcode, oauth

我想在我的 iPhone 应用程序中使用 OAuth。我找到了 OAuthConsummer 框架，但是在阅读了文档之后，我仍然不明白如何在 Xcode 中添加它（因为我的英语很差......）。

首先，OAuthConsumer 是在我的 iPhone 应用程序中使用 OAuth 的最佳方式吗？其次，如何将 OAuthConsumer 框架链接到我的 Xcode 项目？

# c - C中的多线程

> ID：10126335
> 
> 赞同：-2
> 
> 时间：2012-04-12T15:05:06.933
> 
> 标签：c, multithreading

我是多线程的新手，任何答案都将不胜感激。我正在运行一个使用 3 个线程的教程中的示例；两个由用户创建，一个为 main 本身。这是代码：

```
#include <stdio.h>
#include <pthread.h>
#include <string.h>
#include <stdlib.h>

#define NUM_EMPLOYEES 2

/* global mutex for our program. assignment initializes it */
pthread_mutex_t a_mutex = PTHREAD_MUTEX_INITIALIZER;

struct employee {
    int number;
    int id;
    char first_name[20];
    char last_name[30];
    char department[30];
    int room_number;
};

/* global variable - our employees array, with 2 employees */
struct employee employees[] = {
        {1, 12345678, "danny", "cohen", "Accounting", 101},
        {2, 87654321, "moshe", "levy", "Programmers", 202}
};

/* global variable - employee of the day */
struct employee employee_of_the_day;

void copy_employee(struct employee *from, struct employee *to) {
    int rc;     /* contain mutex lock/unlock results */

    /*lock the mutex, to assure exclusive access to 'a' and 'b' */
    rc = pthread_mutex_lock(&a_mutex);

    to->number = from->number;
    to->id = from->id;
    strcpy(to->first_name, from->first_name);
    strcpy(to->last_name, from->last_name);
    strcpy(to->department, from->department);
    to->room_number = from->room_number;

    /* unlock mutex */
    rc = pthread_mutex_unlock(&a_mutex);
}

/* function to be executed by the variable setting threads thread */
void *do_loop(void *data) {
    int my_num = *((int*)data);

    while(1) {
        /* set employee of the day to be the one with number 'my_num' */
        copy_employee(&employees[my_num-1], &employee_of_the_day);
    }
}

/* program's execution begins in main */

int main(int argc, char *argv[]) {
    int i;
    int thr_id1;
    int thr_id2;
    pthread_t p_thread1;
    pthread_t p_thread2;
    int num1 = 1;
    int num2 = 2;
    struct employee eotd;
    struct employee *worker;

    /* initialize employee of the day to first 1 */
    copy_employee(&employees[0], &employee_of_the_day);

    /* create a new thread that will execute 'do_loop()' with '1' */
    thr_id1 = pthread_create(&p_thread1, NULL, do_loop, (void*)&num1);

    /* create a new thread that will execute 'do_loop()' with '2' */
    thr_id2 = pthread_create(&p_thread2, NULL, do_loop, (void*)&num2);

    /* run a loop that verifies integrity of 'employee of the day' many */
    /* many times.... */
    for (i = 0; i < 600000; i++) {
        /* save contents of 'employee of the day' to local 'worker' */
        copy_employee(&employee_of_the_day, &eotd);
        worker = &employees[eotd.number-1];

        /* compare employees */
        if (eotd.id != worker->id) {
            printf("mismatching 'id', %d != %d (loop '%d')\n",
                    eotd.id, worker->id, i);
            exit(0);
        }
        if (strcmp(eotd.first_name, worker->first_name) != 0) {
            printf("mismatching 'first_name' , %s != %s (loop '%d')\n",
                    eotd.first_name, worker->first_name, i);
            exit(0);
        }
        if (strcmp(eotd.last_name, worker->last_name) != 0) {
            printf("mismatching 'last_name' , %s != %s (loop '%d')\n",
                    eotd.last_name, worker->last_name, i);
            exit(0);
        }
        if (strcmp(eotd.department, worker->department) != 0) {
            printf("mismatching 'department' , %s != %s (loop '%d')\n",
                    eotd.department, worker->department, i);
            exit(0);
        }
        if (eotd.room_number != worker->room_number) {
            printf("mismatching 'room_number' , %d != %d (loop '%d')\n",
                    eotd.room_number, worker->room_number, i);
            exit(0);
        }
    }

    printf("Glory, employees contents was always consistent\n");
    return 0;
} 
```

我基本上是想确认在main的for循环中，下面的语句

```
copy_employee(&employee_of_the_day, &eotd); 
```

可以由 3 个线程中的任何一个执行；我对吗？随后的比较显然不是原子的这一事实引起了一些混淆。对此的任何澄清/更正将非常有帮助。

顺便说一句，对于 C 中的多线程教程有什么好的建议吗？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:09:09.200

不，main 中的代码仅由一个线程执行。

使用互斥锁在 copy_employee 函数中确保原子性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:09:42.527

> 我基本上是想确认在main的for循环中，下面的语句
> 
> copy_employee(&employee_of_the_day, &eotd);
> 
> 可以由 3 个线程中的任何一个执行；我对吗？

并非如此，因为该语句仅由主线程执行，而不由其他两个线程执行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-12T15:10:06.610

您的主线程（并且没有任何工作线程）将执行其中的所有内容`main()`，然后结束。您的两个工作线程都将在其中执行所有内容，`do_loop()`并在它们离开函数后结束。

这听起来有点像你在`phtread_create()`混淆`fork()`. `pthread_create()`将使用提供的函数作为入口点，而`fork()`将从调用它的位置开始。

# ruby-on-rails - Ruby on Rails - 无法安装 SystemTimer

> ID：10126336
> 
> 赞同：6
> 
> 时间：2012-04-12T15:05:07.503
> 
> 标签：ruby-on-rails, rubygems, ruby-1.9

我正在使用 Windows，我刚刚运行了命令：

```
C:\Sites\cmply>gem install SystemTimer -v '1.2.3' 
```

我得到了这个错误：

```
Temporarily enhancing PATH to include DevKit...
Building native extensions.  This could take a while...
ERROR:  Error installing SystemTimer:
        ERROR: Failed to build gem native extension.

        C:/RailsInstaller/Ruby1.9.3/bin/ruby.exe extconf.rb
creating Makefile

make
generating system_timer_native-i386-mingw32.def
compiling system_timer_native.c
In file included from system_timer_native.c:8:0:
c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby/backward/rubysig.h:14:2: warning: #warning rubysig.h is obsolete
system_timer_native.c: In function 'install_first_timer_and_save_original_configuration': 
```

知道为什么吗？在此之前，我遇到了另一个可疑错误：

```
Gem files will remain installed in C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/SystemTimer-1.2.3 for inspection.
Results logged to C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/SystemTimer-1.2.3/ext/system_timer/gem_make.out
An error occured while installing SystemTimer (1.2.3), and Bundler cannot continue.
Make sure that `gem install SystemTimer -v '1.2.3'` succeeds before bundling. 
```

在此之前，我遇到了另一个错误，似乎表明我的 Ruby 版本不同步：

```
C:\Sites\cmply>bundle update rake
Updating git://github.com/twitter/twitter-text-rb.git
Fetching source index for http://rubygems.org/
Bundler could not find compatible versions for gem "activesupport":
  In snapshot (Gemfile.lock):
    activesupport (3.2.3)

  In Gemfile:
    rails (= 3.1.3) x86-mingw32 depends on
      activesupport (= 3.1.3) x86-mingw32

Running `bundle update` will rebuild your snapshot from scratch, using only
the gems in your Gemfile, which may resolve the conflict. 
```

那么这一切都源于我拥有一个不兼容的 ruby​​ 版本吗？这应该如何解决？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-13T09:39:50.647

您无法使用 ruby​​ 1.9 安装 system_timer gem，但这不是错误，而是一项功能。这是[完整的解释](http://ph7spot.com/musings/system-timer "完整的解释")。

> “system_timer 仅在您运行 Ruby 1.8 时才相关。如果您正在运行 Ruby 1.9，则不需要它”

如果您从 Ruby 1.8 切换到 1.9，只需删除 system_time gem 并更新处理超时的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-13T07:29:58.127

检查输出，它说您正在为 Ruby 1.9.3 构建包含 1.9.1 的包含文件。

看起来您的 Ruby 安装以某种方式损坏了。我会尝试重新安装 Ruby 1.9.3 并检查包含文件是否存在`c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.3/`于`c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/`.

# ruby-on-rails - Heroku 现在是否接受带有 Paperclip 上传的应用程序？

> ID：10126337
> 
> 赞同：1
> 
> 时间：2012-04-12T15:05:13.990
> 
> 标签：ruby-on-rails, heroku, paperclip

我的兄弟告诉我，我需要在我的应用程序上安装 Amazon S3 才能使用 Paperclip。但是，我只是将我的应用程序推送到 Heroku 生产服务器，我可以毫无问题地上传图像。我没有安装 S3。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T15:07:59.970

如果您希望上传的图像在未来的应用程序部署和扩展操作中保留，您需要使用 Amazon S3。

您可以在没有 Amazon S3 的情况下上传到 Heroku，但是在重新部署/扩展应用程序后，您会发现您的图像消失了 - 重新部署会从 git 存储库为您的应用程序重新编译一个 slug，同时扩展到多个 dyno 意味着资产不会可在其他测功机上使用。

而且您不需要“安装 S3”——您只需使用 Amazon S3 服务来存储您的资产。

# c - 串行通信不起作用。读取文件出错

> ID：10126338
> 
> 赞同：0
> 
> 时间：2012-04-12T15:05:17.097
> 
> 标签：c, winapi, serial-port, readfile, fpga

经过数小时的浏览和阅读，我仍然无法弄清楚为什么我的代码不起作用。我在不同的网站上看到了类似的代码片段，但我似乎无法让它工作。写作部分正常，但阅读出错。每个“真实字符”后跟三个空终止符。写一个 19 个字符的字符串是可行的，我使用的 FPGA 在显示屏上给出了正确的数据。FPGA 应该反转输入并将这个包发送到串行端口。在超级终端中，这可以正常工作。

有人可以指出我的错误并告诉我我做错了什么吗？

提前感谢=）

```
#include <windows.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
#include <time.h>
#include    <commdlg.h>
//#include  <windef.h>
#define    BUFFERLENGTH 19

void writeToSerial(char *line, HANDLE hSerial, DWORD dwBytesWritten);
void printBuffer(char * buffRead, DWORD dwBytesRead);

int main(){
    HANDLE hSerial;
    COMMTIMEOUTS timeouts;
    COMMCONFIG dcbSerialParams;
    char *line, *buffWrite, *buffRead;
    DWORD dwBytesWritten, dwBytesRead;
    /* Create a handle to the serial port */    
    hSerial = CreateFile("COM3",
                            GENERIC_READ | GENERIC_WRITE,
                            0,
                            NULL,
                            OPEN_EXISTING,
                            FILE_ATTRIBUTE_NORMAL,
                            NULL);
    /* Check if the handle is valid */                        
    if(hSerial == INVALID_HANDLE_VALUE){
       if(GetLastError() == ERROR_FILE_NOT_FOUND){
          printf("Serial port does not exist \n");
       }else{
          printf("Port occupied. Please close terminals!\n");
       }
    }else{
       printf("Handle created\n");    
       /* Check the state of the comm port */
       if(!GetCommState(hSerial, &dcbSerialParams.dcb)){
          printf("Error getting state \n");
       }else{
          printf("Port available\n"); 
          /* Configure the settings of the port */
          dcbSerialParams.dcb.DCBlength = sizeof(dcbSerialParams.dcb);
          /* Basic settings */    
          dcbSerialParams.dcb.BaudRate = CBR_57600;
          dcbSerialParams.dcb.ByteSize = 8;
          dcbSerialParams.dcb.StopBits = ONESTOPBIT;
          dcbSerialParams.dcb.Parity = NOPARITY;
          /* Misc settings */
          dcbSerialParams.dcb.fBinary = TRUE;
          dcbSerialParams.dcb.fDtrControl = DTR_CONTROL_DISABLE;
          dcbSerialParams.dcb.fRtsControl = RTS_CONTROL_DISABLE;
          dcbSerialParams.dcb.fOutxCtsFlow = FALSE;
          dcbSerialParams.dcb.fOutxDsrFlow = FALSE;
          dcbSerialParams.dcb.fDsrSensitivity= FALSE;
          dcbSerialParams.dcb.fAbortOnError = TRUE;
          /* Apply the settings */
          if(!SetCommState(hSerial, &dcbSerialParams.dcb)){
            printf("Error setting serial port state \n");
          }else{
            printf("Settings applied\n");  
            GetCommTimeouts(hSerial,&timeouts);
              //COMMTIMEOUTS timeouts = {0};
            timeouts.ReadIntervalTimeout = 50;
            timeouts.ReadTotalTimeoutConstant = 50;
            timeouts.ReadTotalTimeoutMultiplier = 10;
            timeouts.WriteTotalTimeoutConstant = 50;
            timeouts.WriteTotalTimeoutMultiplier= 10;

            if(!SetCommTimeouts(hSerial, &timeouts)){
                  printf("Error setting port state \n");
            }else{
                /* Ready for communication */
                line = "Something else\r";
                //****************Write Operation*********************//
                writeToSerial(line, hSerial, dwBytesWritten);
                //***************Read Operation******************//
                if(ReadFile(hSerial, buffRead, BUFFERLENGTH, &dwBytesRead, NULL)){
                   printBuffer(buffRead, dwBytesRead);                     
                }
             }          
          }
       }
    }
    CloseHandle(hSerial);
    system("PAUSE");
    return 0;

}
void printBuffer(char * buffRead, DWORD dwBytesRead){
     int j;
     for(j = 0; j < dwBytesRead; j++){
         if(buffRead[j] != '\0'){    
           printf("%d: %c\n", j, buffRead[j]);
         }
     }   
}

void writeToSerial(char *line, HANDLE hSerial, DWORD dwBytesWritten){
    WriteFile(hSerial, line, 19, &dwBytesWritten,NULL);
    if(dwBytesWritten){
       printf("Writing success, you wrote '%s'\n", line);
    }else{
       printf("Writing went wrong =[\n");      
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:17:56.527

在这一行：

```
if(ReadFile(hSerial, buffRead, BUFFERLENGTH, &dwBytesRead, NULL)) 
```

该`buffRead`参数是一个未初始化的指针。将声明更改为：

```
char *line, *buffWrite, buffRead [BUFFERLENGTH+1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:17:32.010

超级终端可能不显示空字符，因此您的 fpga 可能实际上正在发送它们。

您可以尝试使用 Br@y Terminal 在十六进制模式下对其进行测试，或者使用示波器查看线路。

# delphi - VC++在两个应用程序之间发送消息

> ID：10126342
> 
> 赞同：0
> 
> 时间：2012-04-12T15:05:33.957
> 
> 标签：delphi, post, message

我一直在寻找从 Microsoft Visual C++ 向另一个在 Delphi 中创建的应用程序发送消息 2 小时。

在 delphi 中，我知道如何读取数据。但我不知道如何在 MVC++ 中发送消息

我希望你能给我一个代码。

**因此，对于下一个代码，我想要在 Microsoft Visual Studio C++ 2010 中进行翻译，我的项目是一个控制台项目。**

```
const 
  MY_MESSAGE = WM_USER + 4242; 

type 
  TForm1 = class(TForm) 
    Button1: TButton; 

procedure Button1Click(Sender: TObject); 

  end; 
var 
  Form1: TForm1; 
implementation 
{$R *.DFM} 

procedure TForm1.Button1Click(Sender: TObject); 
var 
  txt: string; 
begin 
  txt := 'Hello World'; 
  SendMessage(Form1.Handle, MY_MESSAGE, 0, DWORD(PChar(txt))); 
end; 

end. 
```

使用此代码，我应该读取数据。我也想兼容。

```
const 
  MY_MESSAGE = WM_USER + 4242; 

type 
  TForm1 = class(TForm) 

    // Handler that receive the Message 

procedure MessageReceiver(var msg: TMessage); message MY_MESSAGE; 
  end; 
var 
  Form1: TForm1; 
implementation 
{$R *.DFM} 

procedure TForm1.MessageReceiver(var msg: TMessage); 
var 
  txt: PChar; 
begin 
  txt := PChar(msg.lParam); 
  msg.Result := 1; 
  ShowMessage(txt); 
end; 
end. 
```

所以我的应用程序包含两个部分：一个在 Microsoft Visual Studio 中，我使用 opencv，我想向第二个应用程序发送消息，它是在 Delphi 中创建的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:24:13.743

您可以使用`WM_GETTEXT`or`WM_COPYDATA`消息在应用程序之间来回发送数据缓冲区。我曾经寻找过一种方法来发送缓冲区`WM_GETTEXT`，只是使用不同的消息。原始代码可以在这里找到：

[http://www.nldelphi.com/forum/showthread.php?p=275167#post275167](http://www.nldelphi.com/forum/showthread.php?p=275167#post275167)

我不知道一切是否仍然有效（从那以后就没有使用过），但当时确实如此。

```
// The order (first Buffer, then BufferLength) seems more sensible, although with
// WM_SETTEXT they are actually the other way around.
function SendTextMessage(Handle: THandle; Msg: Integer; Buffer: Pointer; BufferLength: Integer): Cardinal;
var
  ProcessHandle: THandle;
  ProcessId: Cardinal;
  VirtualBuffer: Pointer;
begin
  // Get the id of process to which the handle belongs.
  GetWindowThreadProcessID(Handle, @ProcessId);
  ProcessHandle := OpenProcess(PROCESS_ALL_ACCESS, False, ProcessId);

  if ProcessHandle = 0 then
    RaiseLastWin32Error;

  // Allocate a virtual buffer in the process
  VirtualBuffer := VirtualAllocEx(ProcessHandle, nil, BufferLength,
                           MEM_COMMIT, PAGE_READWRITE);
  if VirtualBuffer = nil then
    RaiseLastWin32Error;

  try
    // Send a message to the handle, passing the virtual pointer as a buffer
    Result := SendMessage(Handle, Msg, BufferLength, Integer(VirtualBuffer));

    // Read the resulting value from the virtual buffer into the given buffer
    if not ReadProcessMemory(ProcessHandle, VirtualBuffer, Buffer, Result, Result) then
      RaiseLastWin32Error;

  finally
    VirtualFreeEx(ProcessHandle, VirtualBuffer, BufferLength, MEM_RELEASE);
  end;

end; 
```

并这样称呼它：

```
var
  h: THandle;
  b: array[0..1024] of Char;
begin
  h := Cardinal(StrToInt(Edit1.Text));
  // Not like this
  //SendMessage(h, WM_GETTEXT, 1024, Integer(@b));

  // But like this
  SendTextMessage(h, WM_USER+1, @b, 1024 * SizeOf(Char));
  ShowMessage(b); 
```

阅读这样的消息：

```
procedure WM_USERPLUS1(var Msg: TWMGetText); message WM_USER+1;

procedure TForm2.WM_USERPLUS1(var Msg: TWMGetText);
begin
  with Msg do
    Result := StrLen(StrLCopy(PChar(Text), PChar('Hallo wereld'), TextMax - 1)) * SizeOf(Char);
end; 
```

不过，它可能同样易于使用`WM_COPYDATA`。:D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:15:04.313

我不知道如何使用管道，但我之前使用过以下方案：

使用`WM_COPYDATA`消息使用`SendMessage()`. 这是一个参考

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms649011(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms649011(v=vs.85).aspx)

和例子

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms649009(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms649009(v=vs.85).aspx)

您将需要使用`FindWindow`来获取要将消息发送到的应用程序的句柄。

# java - Java regex String.matches 工作不一致

> ID：10126347
> 
> 赞同：5
> 
> 时间：2012-04-12T15:05:43.367
> 
> 标签：java, regex

我有一个正则表达式，它检查字符串是否为数字。该格式的千位分隔符是一个空格，小数点分隔符是一个点。小数部分是可选的。

问题是在某些时候 String.matches() 函数停止按预期工作。以前有效的，现在不再有效。

例如，JUnit 代码：

```
import junit.framework.Assert;
import org.junit.Test;

public class RegExTest {

    @Test
    public void testThousandSeperatorRegex()
    {
        String regEx = "([0-9]{1,3}( [0-9]{3})*(\\.[0-9]+)?|\\.[0-9]+)";
        Assert.assertEquals(true, "1".matches(regEx));
        Assert.assertEquals(true, "10".matches(regEx));
        Assert.assertEquals(true, "100".matches(regEx));
        Assert.assertEquals(true, "1 000".matches(regEx));
        Assert.assertEquals(true, "10 000".matches(regEx));
        Assert.assertEquals(true, "100 000".matches(regEx));
        Assert.assertEquals(true, "1 000 000".matches(regEx));
        Assert.assertEquals(true, "10 000 000".matches(regEx));
        Assert.assertEquals(false, "10000.56".matches(regEx));
        Assert.assertEquals(true, "8 734".matches(regEx));
    }
} 
```

最后一行“8 734”失败。当我用“1 000”替换它时，它继续失败。最终，同一运行中的相同代码在第 4 行断言中通过，但在最后一行失败（新代码被保存！）。但有时一切都开始按预期工作，直到......再次开始失败。所以我想很难重现我的问题。也许还有一些我做错的事情我没有注意到并因此描述了，但我试图让它尽可能简单。这让我很困惑。String.matches() 有内存还是什么？

正则表达式可能有问题吗？我正在跳过`^$`，因为 String.matches 无论如何都适用于整个字符串。我试过 java.util.regex 和 jregex 包，问题仍然存在。

我正在使用 JDK 6u31。

任何想法表示赞赏。

UPD：好的，在发布这个 Q 之后，代码开始工作并且到目前为止还没有失败。也许这与我有关，但自上周以来这一直困扰着我，我能够一次又一次地复制它。我将继续使用我的代码，如果它可以继续工作，我将关闭此问题。此外，我将尝试确定究竟是什么导致了问题。同时，如果有人遇到同样的问题，请分享您的知识。否则，这看起来像是一个可以通过知识解决的问题，而不是通过调试。为了保护自己免于愚蠢，我可以说我已经编程了很多年，这是论坛上的第一个帖子:)。到目前为止，我能够通过调试、阅读文档和搜索其他 Qs 的论坛来解决我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:35:50.333

好的，到目前为止我还没有遇到过这个问题。

对于有一天碰巧遇到这种情况的其他人，我只能建议清理您正在工作的环境。这与损坏的 JVM 或计算机的内存状态有关。

感谢大家的贡献。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T08:48:42.567

顺便说一句：尝试对所有断言使用预编译模式`Pattern p = Pattern.compile(regEx)`和单一匹配器`assertTrue(p.matcher("1 000 000").matches())`。字符串的匹配方法每次调用它时都会编译正则表达式模式

# android - 使用带有库项目 R18 的 ant 进行 Android 单元测试

> ID：10126358
> 
> 赞同：2
> 
> 时间：2012-04-12T15:06:17.043
> 
> 标签：android, unit-testing, ant

我遇到了与此问题相同的问题：[Android unit test using ant with library project](https://stackoverflow.com/questions/8595006/android-unit-test-using-ant-with-library-project)

我尝试了问题中建议的两种方法，但是在 r18 版本的 android 工具上，我得到：

```
NTServicesTest/build.xml:110: Reference jar.libs.ref not found. 
```

我不确定是否是我未能按照解决方法来回答原始问题的方法，或者是否在 r18 的 android 工具中发生了某些变化。

我的文件夹设置位于 proj 文件夹中，其中包含..：

NTServices , NTServicesTest , NTServicesTestApp

对于@Snicolas 的解决方法，我将 NTServicesTest/project.properties 修改为如下所示：

```
# Project target.
target=android-15
tested.android.library.reference.1=../NTServices 
```

我的 NTServicesTest/build.xml 看起来像这样：（从版本标签的正下方）

```
 <import file="${sdk.dir}/tools/ant/build.xml" />

    <!-- override "compile" target in platform android_rules.xml to include tested app's external libraries -->
 <!-- Compiles this project's .java files into .class files. -->
<target name="-compile" depends="-build-setup, -pre-build, -code-gen, -pre-compile">
<do-only-if-manifest-hasCode elseText="hasCode = false. Skipping...">
    <!-- If android rules are used for a test project, its classpath should include
         tested project's location -->
    <condition property="extensible.classpath"
            value="${tested.project.absolute.dir}/bin/classes"
            else=".">
        <isset property="tested.project.absolute.dir" />
    </condition>
    <condition property="extensible.libs.classpath"
            value="${tested.project.absolute.dir}/${jar.libs.dir}"
            else="${jar.libs.dir}">
        <isset property="tested.project.absolute.dir" />
    </condition>
    <echo message="jar libs dir : ${tested.project.target.project.libraries.jars}"/>
    <javac encoding="${java.encoding}"
            source="${java.source}" target="${java.target}"
            debug="true" extdirs="" includeantruntime="false"
            destdir="${out.classes.absolute.dir}"
            bootclasspathref="android.target.classpath"
            verbose="${verbose}"
            classpath="${extensible.classpath}"
            classpathref="jar.libs.ref">
        <src path="${source.absolute.dir}" />
        <src path="${gen.absolute.dir}" />
        <classpath>
            <!-- steff: we changed one line here !-->
            <fileset dir="${tested.android.library.reference.1}/bin/" includes="*.jar"/>
            <fileset dir="${extensible.libs.classpath}" includes="*.jar" />
        </classpath>
        <compilerarg line="${java.compilerargs}" />
    </javac>
           <!-- if the project is instrumented, intrument the classes -->
                    <if condition="${build.is.instrumented}">
                        <then>
                            <echo>Instrumenting classes from ${out.absolute.dir}/classes...</echo>
                            <!-- It only instruments class files, not any external libs -->
                            <emma enabled="true">
                                <instr verbosity="${verbosity}"
                                       mode="overwrite"
                                       instrpath="${out.absolute.dir}/classes"
                                       outdir="${out.absolute.dir}/classes">
                                </instr>
                                <!-- TODO: exclusion filters on R*.class and allowing custom exclusion from
                                     user defined file -->
                            </emma>
                        </then>
                    </if>           
</do-only-if-manifest-hasCode>
</target> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-17T14:53:12.523

只需将 classpathref="jar.libs.ref" 重命名为 classpathref="project.libraries.jars"。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-17T15:34:25.310

是的，它奏效了。在 R18 中，此属性更改为 project.libraries.jars 但在 owerrided 任务中，我们没有更改此值

# ravendb - RavenDB 保存到磁盘查询

> ID：10126360
> 
> 赞同：1
> 
> 时间：2012-04-12T15:06:18.247
> 
> 标签：ravendb

在我开始之前，让我说我是 RavenDB 的新手。

我现在只是在评估它，并且正在使用 RavenDB-Build-616 构建。我的服务器正在运行，也就是说我已经手动启动了“Raven.Server.exe”，并且有以下测试代码

```
 public class RavenFullTextSearchDemo
    {
        private DocumentStore documentStore;

        private List<string> firstNames = new List<string>() { "John", "Peter", "Paul", "Sam", "Brendon" };
        private List<string> lastNames = new List<string>() { "Simons", "Black", "Benson", "Jones", "Breckwell" };
        private Random rand = new Random();

        public RavenFullTextSearchDemo(DocumentStore documentStore)
        {
            this.documentStore = documentStore;
        }

        public void Run()
        {

            IndexCreation.CreateIndexes(typeof(RavenFullTextSearchDemo).Assembly, this.documentStore);

            using (IDocumentSession session = documentStore.OpenSession())
            {
                //add some random Users 
                for (int i = 0; i < 5; i++)
                {
                    string name = string.Format("{0} {1},", 
                        firstNames[rand.Next(firstNames.Count)], lastNames[rand.Next(lastNames.Count)]);
                    User newUser = new User { Name = name };
                    session.Store(newUser);
                }
                session.SaveChanges();

                //Seem to have to give it some time to persist??? Seems very odd
                //If I take the following line out, I dont get any users back at all
                Thread.Sleep(3000);

                PrintCurrentUsers(session);

                var searchName = firstNames[rand.Next(firstNames.Count)];

                Console.WriteLine(string.Format("Looking for users with Name starting with '{0}'\r\n", searchName));

                Console.WriteLine("Simple starts with");
                foreach (var person in Queryable.Where(session.Query<User, User_ByName_FullTextSearch>(), x => x.Name.StartsWith(searchName)))
                {
                    Console.WriteLine(person.Name);
                }

                Console.WriteLine("\r\n");
                Console.WriteLine("Complex starts with");

                IQueryable<User> query = session.Query<User, User_ByName_FullTextSearch>();

                query = searchName.Split().Aggregate(query, (current, part) => current.Where(x => x.Name.StartsWith(part)));

                foreach (var person in query)
                {
                    Console.WriteLine(person.Name);
                }
            }

        }

        private void PrintCurrentUsers(IDocumentSession session)
        {
            IList<User> users = new List<User>();
            Console.WriteLine("The current list of users is :\r\n");
            foreach (User user in session.Query<User>().ToList())
            {
                Console.WriteLine(string.Format("UserName : {0}", user.Name));
            }
            Console.WriteLine("\r\n\r\n");
        }

    }

    public class User_ByName_FullTextSearch : AbstractIndexCreationTask<User>
    {
        public User_ByName_FullTextSearch()
        {
            Map = users => from user in users
                            select new { user.Name };
            Index(x => x.Name, FieldIndexing.Analyzed);
        }
    } 
```

像这样调用它的地方

```
 using (var documentStore = new DocumentStore { Url = documentStoreLocation, DefaultDatabase = "ravenTest-" + DateTime.Now.Ticks })
    {
        documentStore.Initialize();
        RavenFullTextSearchDemo ravenFullTextSearchMessAround = new RavenFullTextSearchDemo(documentStore);
        ravenFullTextSearchMessAround.Run();
    } 
```

发生了一些奇怪的事情，因为我似乎需要 Thread.Sleep 才能将新的 User 对象持久保存到磁盘。如果我在那里没有那个 Thread.Sleep，我永远不会在“PrintCurrentUsers”方法调用中看到任何打印出来的东西。

这是我在没有 Thread.Sleep 的情况下得到的输出

++++++++++++++++++++++++++++++++++++++++++++++++++++++ ++++++ 当前用户列表为：

寻找姓名以“Paul”开头的用户

简单从保罗琼斯开始，

复杂从保罗琼斯开始，

虽然这是我使用 Thread.Sleep 得到的输出

当前用户列表是：

用户名：Paul Black，用户名：Paul Benson，用户名：Paul Jones，用户名：Peter Black，用户名：Paul Simons，

++++++++++++++++++++++++++++++++++++++++++++++++++++++ ++++++

寻找姓名以“Paul”开头的用户

简单从保罗·布莱克、保罗·本森、保罗·琼斯、保罗·西蒙斯开始，

复杂从保罗布莱克开始，保罗本森，保罗琼斯，保罗西蒙斯，

我究竟做错了什么。我在其他地方有一些其他代码可以插入一堆用户并立即获取它们，这似乎工作正常。

任何线索任何人？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T15:10:55.237

用户正在被持久化，但索引在后台更新，并且您正在查询索引（这是设计使然）。请参阅：[http ://ravendb.net/docs/client-api/querying](http://ravendb.net/docs/client-api/querying)

您可以告诉 Raven 等到所有过时的数据都在查询中。

请参阅此页面：[http](http://ravendb.net/docs/client-api/querying/stale-indexes) ://ravendb.net/docs/client-api/querying/stale-indexes ，了解如何等待索引更新的示例。（具体来说，您需要将方法更改为：

```
 private void PrintCurrentUsers(IDocumentSession session)
    {
        IList<User> users = new List<User>();
        Console.WriteLine("The current list of users is :\r\n");
        foreach (User user in session.Query<User>()
            .Customize(x => x.WaitForNonStaleResults(TimeSpan.FromSeconds(5)))
            .ToList())
        {
            Console.WriteLine(string.Format("UserName : {0}", user.Name));
        }
        Console.WriteLine("\r\n\r\n");
    } 
```

# ios - 使用 Http 直播串流视频，形成无缝播放列表

> ID：10126366
> 
> 赞同：3
> 
> 时间：2012-04-12T15:06:32.037
> 
> 标签：ios, ios5, video-streaming, http-live-streaming

我有兴趣看看是否可以使用 HTTP Live Streaming (Apple) 连接两个不同的视频？例如，要能够播放一个视频播放列表，例如广告视频 1 和电视节目视频 2，并使用此协议在它们之间启用无间隙播放，因此之间无需等待。

如果这是可能的，有人可以告诉我如何正确形成播放列表 .m3u8 吗？

我尝试了如下示例：

```
#EXTM3U
#EXT-X-TARGETDURATION:10
#EXTINF:10,
commercial-00001.ts
#EXTINF:10,
commercial-00002.ts
#EXTINF:9,
commercial-00003.ts
#EXTINF:7,
commercial-00004.ts
#EXTINF:10,
tv-00001.ts
#EXTINF:10,
tv-00002.ts
#EXTINF:10,
tv-00003.ts
#EXTINF:10,
tv-00004.ts
#EXTINF:10,
tv-00005.ts
#EXTINF:10,
tv-00006.ts
#EXTINF:7,
tv-00007.ts
#EXT-X-ENDLIST 
```

但是，iOS 上的播放器在播放第一个视频（商业）后会冻结。缓冲条只显示它已缓冲到第一个视频的末尾。

注意：我的目标是 iOS，所以 Flash 是不可能的，不幸的是:(

有没有正确的方法来执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T16:32:59.503

除非将片段准备为单个流，否则解码器不一定能够在它们之间无缝切换。

您应该在插入的段之前和之后引入[#EXT-X-DISCONTINUITY行。](https://datatracker.ietf.org/doc/html/draft-pantos-http-live-streaming-07#section-3.3.11)这可能会导致客户端出现明显的（但不是破坏性的）转换，因为视频解码器将被重置。

# php - 不验证javascript中的特殊字符“_”

> ID：10126370
> 
> 赞同：-2
> 
> 时间：2012-04-12T15:06:38.270
> 
> 标签：php, javascript

你好我正在使用 javascript 来验证字段

我正在检查特殊字符..我正在实现的代码验证所有特殊字符，除了_下划线..

```
 <script type="text/javascript" language="javascript">
function validateForm()
{
    var iChars = "!@#$%^&*()+=-[]\\\';,./{}|\":<>?_";

   for (var i = 0; i < document.reg_form.txtusername.value.length; i++) 
        {
            if (iChars.indexOf(document.reg_form.txtusername.value.charAt(i)) != -1) 
                {
                    alert ("Special Characters are not allowed.");
                    return false;
                        }
         }
    return true;
}
</script> 
```

为此提交

```
<input name="txtusername" type="text" id="txtusername" maxlength="10" style="background-color:#CCC"  /> 
```

但它没有验证下划线

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:09:06.233

将它推入您的 iChars 变量中是否没有意义，这显然是您的“黑名单”？

```
var iChars = "!@#$%^&*()+=-[]\\\';,./{}|\":<>?_"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:10:45.640

```
var iChars = "!@#$%^&*()+=-[]\\\';,./{}|\":<>?_";

        for (var i = 0; i < document.reg_form.firstname.value.length; i++) 
        {
            if (iChars.indexOf(document.reg_form.firstname.value.charAt(i)) != -1) 
                {
                    alert ("Special Characters are not allowed");
                    return false;
                 }
         } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:30:53.077

字符串中的字符可以像字符串是一个数组一样被寻址（如果你考虑一下，它就是）。由于您正在循环遍历字符串 char-per-char，再次，就像您使用数组一样，为什么在您的逻辑中不一致？

```
if (iChars.indexOf(document.reg_form.firstname.value[i]) !== -1)
{
    alert('Foobar');
    return false;
} 
```

这应该可以工作......另外：没有真正需要转义单引号，因为 iChar 字符串由双引号分隔......如果所有其他方法都失败了，您可能也想尝试省略该反斜杠。虽然我不认为这是导致问题的原因

它正在工作：[这里](http://jsfiddle.net/GvQC5/)

# c++ - 从 SM4+ 中的 hlsl 访问绘图调用中的所有顶点

> ID：10126377
> 
> 赞同：0
> 
> 时间：2012-04-12T15:07:03.303
> 
> 标签：c++, directx, hlsl

假设我想在 gpu 管道中为顶点变换构建矩阵，我意识到我当前的实现效率很低，因为它为每个顶点从源材料重建矩阵（而它只需要为每个受影响的顶点构建一次） ）。有没有办法修改在单个绘图调用中绘制的整个顶点数组？计算矩阵并将它们存储在 vram 中似乎不是一个很好的选择，因为将同时处理多个顶点，我认为我不能有效地同步它们。我能想到的唯一其他选择是计算着色器，我还没有研究过它的用途，但是有没有可能让它计算矩阵并将它们存储在 gpu 中，以便我以后可以在绘图时访问它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T19:19:47.487

Do you have any source code? I never calculate matrices in the shaders, normally do it on the CPU and pass them over in a constant buffer.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T19:27:24.720

实现这一点的一种方法是预先计算矩阵并将它们作为统一变量发送到着色器。例如，如果您的着色器只需要将 MVP 矩阵与顶点位置相乘，那么您可以在着色器外部预先计算 MVP 矩阵并将其作为 float4x4 统一发送到着色器，那么顶点着色器所做的就是将该单个矩阵与每个顶点相乘。没有比这更优化的了，因为顶点是在 GPU 上并行处理的，并且 GPU 具有针对向量演算优化的指令集。

# github - 为什么 github 一直要求我提供 repo 凭据？

> ID：10126381
> 
> 赞同：15
> 
> 时间：2012-04-12T15:07:19.317
> 
> 标签：github

我们最近将我们的 github 从一个帐户所有者转移到另一个帐户所有者，现在突然间当我`git pull`在远程 repo 上执行一个或任何 git 命令时，它会要求我提供 github 用户名和密码。

我的 git-config 说：

```
[github]
    user = kamilski81
    token = ********* 
```

知道如何阻止它向我询问凭据并记住所有内容，新所有者是否必须设置我的 ssh 密钥或类似的东西？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-28T12:00:32.420

按照这篇文章为我整理了一下： [https ://help.github.com/articles/why-is-git-always-asking-for-my-password](https://help.github.com/articles/why-is-git-always-asking-for-my-password)

```
git remote set-url origin git@github.com:user/repo.git 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-12T15:09:22.163

gitconfig 中的 github 用户名和令牌仅用于与 GitHub API 的交互（例如`hub`gem 和`github`工具）。

如果您通过 https 从 GitHub 存储库推送和拉取，那么您需要每次都指定您的凭据，或者连接到密码管理器以记住您的凭据。如何执行此操作取决于您的平台。

最简单的做法是转到您的 github 帐户并将您的 SSH 公钥提交到您的帐户，然后将您的 github 远程切换为通过 ssh 而不是 https 推送/拉取。

[编辑] 在重新阅读问题后，我注意到您提到它以前是一个 GitHub 存储库，刚刚从一个所有者转移到另一个所有者。如果是这种情况，并且您可以通过指定您的凭据来推送和拉取，那么在我看来这是以下两种情况之一：

*   之前的远程使用ssh，GitHub有你的SSH密钥；但是当所有者更改并且您更新了遥控器时，您将其更新为通过 https。
*   以前的遥控器使用 https，但您正确设置了密码管理器来处理您的凭据，但它不再有效。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-07-06T19:20:43.707

在执行“remote -v”之后......问题是我的遥控器使用的是“https”遥控器而不是“git”遥控器。将遥控器更改为使用 git 而不是 https 解决了所有问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T15:34:07.680

如果您只执行一次**git pull**并且 Git 客户端仍然询问您的凭据而没有为您执行*git pull*，那么问题应该是因为您的凭据不正确或尚未设置。

但是，如果您收到对话框，要求为每个操作提供一个凭据，则意味着您的凭据不被记住。为此，您可以使用**[Pageant](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)**存储您的 SSH 私钥，因此，每次您执行某项操作时，它都会从 Pageant 检索您的凭据，而不是询问您。

# php - 打开一个外国网址然后继续我自己的网页

> ID：10126383
> 
> 赞同：0
> 
> 时间：2012-04-12T15:07:24.293
> 
> 标签：php, javascript, url, curl

[http://bulksms.poweredsms.com/send.php?usr=rajdeeps&pwd=pass123&ph=xxxxxxxxxxx&sndr=textid&text=hi](http://bulksms.poweredsms.com/send.php?usr=rajdeeps&pwd=pass123&ph=xxxxxxxxxxx&sndr=textid&text=hi)

我需要打开这个网址，但是我无法从这个链接重定向回我自己的网站，有没有办法执行这个链接并继续使用我想要的其他网页......？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:10:27.643

您可以为此使用 CURL。

[http://en.wikipedia.org/wiki/CURL](http://en.wikipedia.org/wiki/CURL)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:09:19.683

我不知道“执行”一个 url 是什么意思，如果你只是想调用它，你可以使用 AJAX，打开一个弹出窗口或者只是做这样的事情（非常丑陋的方法）：

```
<img src="url....." style="display: none;"> 
```

编辑：

使用 AJAX 的一个示例如下：

[从没有使用 jquery 的 php 文件中获取结果](https://stackoverflow.com/questions/9069539/get-result-from-php-file-without-usig-jquery/9069599#9069599)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:18:48.100

您可以使用 cURL 尝试这种方式

```
<?php

$ch = curl_init("http://bulksms.poweredsms.com/send.php?usr=rajdeeps&pwd=pass123&ph=xxxxxxxxxxx&sndr=textid&text=hi");
curl_setopt($ch, CURLOPT_URL, $ch);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, false);
curl_exec($ch);
curl_close($ch);
?> 
```

# java - PrimeFaces 和浏览器兼容性

> ID：10126385
> 
> 赞同：5
> 
> 时间：2012-04-12T15:07:28.687
> 
> 标签：java, jsf, primefaces

试图让我的头脑总体上围绕 PrimeFaces 和 JSF。PrimeFaces 如何处理浏览器怪癖/兼容性？它生成的客户端代码是否包含在 PF 支持的浏览器中呈现所需的所有代码，或者我（PF 开发人员）是否需要添加正确呈现 PF 组件所需的任何客户端代码（HTML/CSS/JS）在不同的浏览器中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T18:41:20.287

至于 JS，PrimeFaces 将浏览器敏感的 JS 作业委托给捆绑的[jQuery](http://jquery.com)库。至于 CSS，一切都由捆绑的[jQuery UI](http://jqueryui.com/)库完成。到目前为止，jQuery 和 jQuery UI 已经非常成熟并且支持广泛的浏览器，包括 IE6。至于 HTML，JSF 应该按照规范生成符合 XHTML 1.0 过渡的 HTML，每个“现代”浏览器都能理解，包括 IE6，即使使用 HTML5 文档类型也是如此。

你不必担心这一切，除非你自己手动编写 HTML/CSS/JS。

# c# - 使用字符串变量内容作为标签 ID 来更新 label.Text，我收到错误 - “字符串”不包含“文本”的定义

> ID：10126391
> 
> 赞同：1
> 
> 时间：2012-04-12T15:08:09.777
> 
> 标签：c#, string, label

C#新手所以要温柔！这是使用按钮中的参数创建字符串以匹配标签 ID 的代码，因此我可以更新标签文本。

```
string[] commandArgs = e.CommandArgument.ToString().Split(new char[] {','});                    //Convert the buttons arguments to server/service variables
    string strServerName = commandArgs[0];
    string strServiceName = commandArgs[1];     
    string strLabelID = String.Format(strServerName + "_" + strServiceName + "_" + "Status");   //assign the strLabelID to the format: "servername_servicename_Status" for updating the label text 
```

这在直接使用标签 ID 名称为“serverx_spooler_Status”时有效...

```
serverx_spooler_Status.Text = String.Format(strServiceName);    //update label text 
```

即使“strLabelID”的值为“serverx_spooler_Status”，此操作也会失败...

```
strLabelID.Text = String.Format(strServiceName);    //update label text 
```

谢谢德里克的搜索方向！解决方案是这样...

```
 // Find control on page.
    Control myControl1 = FindControl(strLabelID);
    Label myLabel1 = (Label)myControl1;
    myLabel1.Text = "Updated Label Text!"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T08:48:16.487

```
 string service = "winmgmt";
        string server = "DFS5600";
        string labelText = string.Format("{0}_{1)_Status", server, service);

        foreach (Control ctr in this.Controls)
        {
            if (ctr is Label)
            {
                if (ctr.Name == labelText)
                {
                    ctr.Text = "Hello Label";
                }
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T08:35:28.037

我认为这可能会有所帮助。

您需要做的是遍历项目中的所有标签，直到找到这样的匹配项：-

字符串 strLabelID = String.Format("{0}_{1}_Status",strServerName,strServiceName);

foreach（在 this.Controls 中控制 ctr）{

if (ctr is Label) { if (ctr.Name == strLabelID) { //在这里做任何事情 } } }

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:12:59.773

的类型`serverx_spooler_Status`可能是`Label`具有`Text`字段的（未在问题中显示），因此`serverx_spooler_Status.Text`是有效的。

的类型`strLabelID`是`string`（第一个包含），它没有`Text`字段，所以访问`strLabelID.Text`无效

尝试：

```
strLabelID = String.Format(strServiceName); 
```

这会将 的值更改`strLabelID`为`strServiceName`（基本上与：`strLabelID = strServiceName;`）的值相同

如果您真的想更新标签，您将需要一个类型为 的对象`Label`，您可以在其中访问该`Text`字段并更新该字段（只是说谎您正在使用`serverx_spooler_Status`）。如果您有任何其他可以使用的标签对象，则不会显示您的代码包含。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T15:39:20.780

我认为这就是您要寻找的东西：-

Label.Text = String.Format("{0}_{1}_Status",strServerName,strServiceName);

那应该行得通。

或者你可以说：-

字符串 strLabelID = String.Format("{0}_{1}_Status",strServerName,strServiceName);

label1.Text = strLabelID;

不太清楚你的意思。希望这可以帮助。

# javascript - 如何将用逗号分隔的值传递给数组？使用 java 脚本

> ID：10126393
> 
> 赞同：0
> 
> 时间：2012-04-12T15:08:11.713
> 
> 标签：javascript, arrays, csv

我有这个静态代码，可以隐藏/显示一些组合框，但是如果我添加更多类别怎么办？如果确实添加更多类别，我每次都必须更改代码

所以我想要做的是有一个 var 将接收几个用逗号分隔的值

以及它们如何将值分开，它们会将值存储在数组中。现在当用户需要添加更多类别时，不必编辑代码。

但是我怎样才能用逗号分隔值，然后将它们添加到数组中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:11:03.907

您可以使用 String.split() 函数，例如：

```
var s = '1,2,3,4,5,6';
var values = s.split(',');

console.log(values); 
```

有关更多信息，请参见此处：[https ://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/split](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/split)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:12:32.463

如果我正确理解你的问题，你会想看看[http://www.w3schools.com/jsref/jsref_split.asp](http://www.w3schools.com/jsref/jsref_split.asp)

并使用`var arr = YOURVARIABLE.split(',');`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:11:05.140

您将使用 split() 方法。[http://www.w3schools.com/jsref/jsref_split.asp](http://www.w3schools.com/jsref/jsref_split.asp)

```
var string = '1,2,3,text,123';
var array = string.split(',');

//array = [1, 2, 3, 'text', 123]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T15:12:51.693

试试下面的代码

```
var testString = "comma,seperated,list";

var stringArr = testString.split(","); 
```

split() 方法将按传递给它的分隔符逐字拆分字符串并返回一个值数组。在这种情况下，我们的数组将是

```
// stringArr = ["comma", "seperated", "list"]; 
```

# javascript - 如何克隆和更改ID？

> ID：10126395
> 
> 赞同：136
> 
> 时间：2012-04-12T15:08:19.977
> 
> 标签：javascript, jquery, clone

我需要克隆 id，然后在它之后添加一个数字，例如`id1`，`id2`等等。每次点击克隆时，都会将克隆放在 id 的最新数字之后。

```
$("button").click(function() {
    $("#id").clone().after("#id");
}); 
```

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2012-04-12T15:44:51.453

```
$('#cloneDiv').click(function(){

  // get the last DIV which ID starts with ^= "klon"
  var $div = $('div[id^="klon"]:last');

  // Read the Number from that DIV's ID (i.e: 3 from "klon3")
  // And increment that number by 1
  var num = parseInt( $div.prop("id").match(/\d+/g), 10 ) +1;

  // Clone it and assign the new ID (i.e: from num 4 to ID "klon4")
  var $klon = $div.clone().prop('id', 'klon'+num );

  // Finally insert $klon wherever you want
  $div.after( $klon.text('klon'+num) );

});
```

```
<script src="https://code.jquery.com/jquery-3.1.0.js"></script>

<button id="cloneDiv">CLICK TO CLONE</button> 

<div id="klon1">klon1</div>
<div id="klon2">klon2</div>
```

* * *

## 加扰元素，检索最高 ID

假设您有许多 ID 类似`klon--5`但被打乱（不按顺序）的元素。这里我们**不能**使用`:last`or `:first`，因此我们需要一种机制来检索最高 ID：

```
const all = document.querySelectorAll('[id^="klon--"]');
const maxID = Math.max.apply(Math, [...all].map(el => +el.id.match(/\d+$/g)[0]));
const nextId = maxID + 1;

console.log(`New ID is: ${nextId}`);
```

```
<div id="klon--12">12</div>
<div id="klon--34">34</div>
<div id="klon--8">8</div>
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-04-12T15:09:30.390

**更新：**正如[Roko C.Bulijan](https://stackoverflow.com/a/10127093/297641)指出的那样..您需要使用 .insertAfter 在选定的 div 之后插入它。如果您希望在多次克隆时将其附加到末尾而不是开头，请参阅更新的代码。[**演示**](http://jsfiddle.net/HGtmR/4/)

**代码：**

```
 var cloneCount = 1;;
   $("button").click(function(){
      $('#id')
          .clone()
          .attr('id', 'id'+ cloneCount++)
          .insertAfter('[id^=id]:last') 
           //            ^-- Use '#id' if you want to insert the cloned 
           //                element in the beginning
          .text('Cloned ' + (cloneCount-1)); //<--For DEMO
   }); 
```

* * *

尝试，

```
$("#id").clone().attr('id', 'id1').after("#id"); 
```

如果您想要一个自动计数器，请参见下文，

```
 var cloneCount = 1;
   $("button").click(function(){
      $("#id").clone().attr('id', 'id'+ cloneCount++).insertAfter("#id");
   }); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-03-07T12:32:40.433

这是对我有用的最简单的解决方案。

```
$('#your_modal_id').clone().prop("id", "new_modal_id").appendTo("target_container"); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-03-31T16:41:11.127

这也有效

```
 var i = 1;
 $('button').click(function() {
     $('#red').clone().appendTo('#test').prop('id', 'red' + i);
     i++; 
 });
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<div id="test">
  <button>Clone</button>
  <div class="red" id="red">
  </div>
</div>

<style>
  .red {
    width:20px;
    height:20px;
    background-color: red;
    margin: 10px;
  }
</style>
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-09-08T11:38:00.720

我创建了一个通用的解决方案。下面的函数将更改克隆对象的 ID 和名称。在大多数情况下，您将需要行号，因此只需向对象添加“data-row-id”属性。

```
function renameCloneIdsAndNames( objClone ) {

    if( !objClone.attr( 'data-row-id' ) ) {
        console.error( 'Cloned object must have \'data-row-id\' attribute.' );
    }

    if( objClone.attr( 'id' ) ) {
        objClone.attr( 'id', objClone.attr( 'id' ).replace( /\d+$/, function( strId ) { return parseInt( strId ) + 1; } ) );
    }

    objClone.attr( 'data-row-id', objClone.attr( 'data-row-id' ).replace( /\d+$/, function( strId ) { return parseInt( strId ) + 1; } ) );

    objClone.find( '[id]' ).each( function() {

        var strNewId = $( this ).attr( 'id' ).replace( /\d+$/, function( strId ) { return parseInt( strId ) + 1; } );

        $( this ).attr( 'id', strNewId );

        if( $( this ).attr( 'name' ) ) {
            var strNewName  = $( this ).attr( 'name' ).replace( /\[\d+\]/g, function( strName ) {
                strName = strName.replace( /[\[\]']+/g, '' );
                var intNumber = parseInt( strName ) + 1;
                return '[' + intNumber + ']'
            } );
            $( this ).attr( 'name', strNewName );
        }
    });

    return objClone;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-04-11T09:27:43.943

```
$('#cloneDiv').click(function(){

  // get the last DIV which ID starts with ^= "klon"
  var $div = $('div[id^="klon"]:last');

  // Read the Number from that DIV's ID (i.e: 3 from "klon3")
  // And increment that number by 1
  var num = parseInt( $div.prop("id").match(/\d+/g), 10 ) +1;

  // Clone it and assign the new ID (i.e: from num 4 to ID "klon4")
  var $klon = $div.clone().prop('id', 'klon'+num );

  // Finally insert $klon wherever you want
  $div.after( $klon.text('klon'+num) );

}); 
```

```
<script src="https://code.jquery.com/jquery-3.1.0.js"></script> 
```

# php - 使用 Smarty php 显示 mysql 查询

> ID：10126397
> 
> 赞同：0
> 
> 时间：2012-04-12T15:08:25.223
> 
> 标签：php, mysql, smarty

我正在将博客作为学校项目制作，但有点卡住了。

该项目的要求之一是使用 smarty，这对我来说是全新的。

我的问题是我想将数据库中的“博客文章”分配给 smarty 变量。我的方法是这样的：

```
<?php
require_once('connect_db.php');
$result = $db->query("SELECT * FROM Innlegg");
while ($row = $result->fetch_assoc())
{print ("<h1>" . $row["forfatter"] . "</h1>");
print ($row["innhold"]);}
?> 
```

现在我只是从“Innlegg”打印出“forfatter”。这是如何使用 smarty 完成的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T15:27:23.567

首先尝试阅读[Smarty 常见问题解答](http://smarty.incutio.com/?page=SmartyFrequentlyAskedQuestions)。它非常简单

```
$list=array();
while ($row = $result->fetch_assoc()) {
    $list[]=$row;
}

$smarty = new Smarty(); //maybe some configuration ?
$smarty->assign('list', $list);
$smarty->fetch('index.tpl'); 
```

在 smarty index.tpl 模板文件中

```
{foreach from=$list item=row}
    <h1>{$row.forfatter}</h1>
    {$row.innhold}
{/foreach} 
```

# javascript - 重复的 Pinterest Facebook 邀请功能

> ID：10126399
> 
> 赞同：6
> 
> 时间：2012-04-12T15:08:34.913
> 
> 标签：javascript, facebook

我正在尝试复制 Pinterest 的“邀请朋友”功能。如果您还没有看到它的外观，它看起来像这样： ![在此处输入图像描述](../Images/4c29b86860d61c2b63ce35a91e0cf6f0.png)

这里的重点是 1) 有多个收件人和 2) 您可以键入自定义消息。

到目前为止，使用 Facebook API，我只找到了向单个用户发送自定义消息或向多个用户发送预置消息的方法。我还没有找到向多个用户发送自定义消息的方法。

以下是允许您向一个用户发送自定义消息的方法：[https ://developers.facebook.com/docs/reference/dialogs/send/](https://developers.facebook.com/docs/reference/dialogs/send/)

以下是让您向多个用户发送预置消息的方法： [https ://developers.facebook.com/docs/reference/dialogs/requests/](https://developers.facebook.com/docs/reference/dialogs/requests/)

那么他们是怎么做到的呢？如何允许我的用户像 Pinterest 一样向多个收件人发送自定义消息？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-16T17:14:38.183

Facebook 大约一周前回应了有关此问题的错误报告，称这是“设计使然”。Pinterest 和其他应用程序被列入白名单，以便能够包含多个收件人。如何进入白名单？超越我。

请参阅[https://developers.facebook.com/bugs/314701778595814](https://developers.facebook.com/bugs/314701778595814)以获取 Facebook 的完整官方回复（以及开发人员的沮丧回复）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-16T16:00:29.817

1.  他们肯定在使用[send dialog](https://developers.facebook.com/docs/reference/dialogs/send/ "https://developers.facebook.com/docs/reference/dialogs/send/")，查看出现的对话框，标题显示**Send a Message**，它仅用于发送对话框。

2.  如果您以某种方式获得好友列表，则可以使用他们的用户 ID（数字）或用户名（字母数字）预先选择多个好友。但是您不传递数组，而是传递一个csv，如下所示：

    ```
    FB.ui({
        method: 'send',
        to: '123123123,234234234',
        name: 'People Argue Just to Win',
        link: 'http://www.nytimes.com/2011/06/15/arts/people-argue-just-to-win-scholars-assert.html',
    }); 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-15T23:42:42.500

尝试将数组作为参数传递给`to`FB.ui。这将让您选择收件人。或者，使用一些 UID 填充数组，以预填充收件人。

```
FB.ui({
  method: "send",
  to:[],
  name: "Join my site, now!",
  description: "...",
  picture: "...",
  link: 'http://...'
}) 
```

# winforms - GeckoFX - WinForms - javascript:print()

> ID：10126402
> 
> 赞同：2
> 
> 时间：2012-04-12T15:08:45.880
> 
> 标签：winforms, printing, geckofx

我刚刚创建了一个带有 Gecko.GeckoWebBrowser 的 win 表单应用程序，当我导航到一个带有 href 属性设置为 javascript:print() 的锚点的页面并单击它时，会显示打印对话框，但结果是当我点击该对话框上的取消按钮时，Gecko.GeckoWebBrowser 被破坏，我的意思是控件接收到 WM_DETROY 消息，任何关于这里可能发生什么的线索？我该如何预防？我修改了 gecko fx Gecko.GeckoWebBrowser windows 程序并捕获并绕过该 windows 消息，但似乎这对我使用 xulrunner-11.0.en-US.win32 和 geckofx-11.dll 没有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T03:38:27.197

从火狐代码来看，火狐似乎正在发送 WM_DESTROY 消息。

```
nsPrintingPromptService::ShowPrintDialog(nsIDOMWindow *parent, nsIWebBrowserPrint *webBrowserPrint, nsIPrintSettings *printSettings)
{
    NS_ENSURE_ARG(parent);

    HWND hWnd = GetHWNDForDOMWindow(parent);
    NS_ASSERTION(hWnd, "Couldn't get native window for PRint Dialog!");

    return NativeShowPrintDialog(hWnd, webBrowserPrint, printSettings);
}

nsresult NativeShowPrintDialog(HWND                aHWnd,
                               nsIWebBrowserPrint* aWebBrowserPrint,
                               nsIPrintSettings*   aPrintSettings)
{
  PrepareForPrintDialog(aWebBrowserPrint, aPrintSettings);

  nsresult rv = ShowNativePrintDialog(aHWnd, aPrintSettings);
  if (aHWnd) {
    ::DestroyWindow(aHWnd);
  }

  return rv;
} 
```

我不确定它为什么会这样做。

解决此问题的一些选项：

*   打开“print.always_print_silent”
*   提供并注册您自己的 nsIPrintingPromptService
*   提供并注册您自己的 nsIWindowWatcher 服务。

nsIWindowWatcher 方法看起来像是查看 GetHWNDForDOMWindow 的正确方法：

```
HWND
nsPrintingPromptService::GetHWNDForDOMWindow(nsIDOMWindow *aWindow)
{
    nsCOMPtr<nsIWebBrowserChrome> chrome;
    HWND hWnd = NULL;

    // We might be embedded so check this path first
    if (mWatcher) {
        nsCOMPtr<nsIDOMWindow> fosterParent;
        if (!aWindow) 
        {   // it will be a dependent window. try to find a foster parent.
            mWatcher->GetActiveWindow(getter_AddRefs(fosterParent));
            aWindow = fosterParent;
        }
        mWatcher->GetChromeForWindow(aWindow, getter_AddRefs(chrome));
    }

    if (chrome) {
        nsCOMPtr<nsIEmbeddingSiteWindow> site(do_QueryInterface(chrome));
        if (site) 
        {
            HWND w;
            site->GetSiteWindow(reinterpret_cast<void **>(&w));
            return w;
        }
    } 
```

# android - 直接在 SQLite 中计算两点之间的距离

> ID：10126404
> 
> 赞同：11
> 
> 时间：2012-04-12T15:08:49.327
> 
> 标签：android, sqlite, math

在我的 web/MySQL 应用程序中，我有这样的东西来获取两点之间的距离：

```
6371 * acos(cos(radians(-19.83996)) * cos(radians(lat)) * cos(radians(-43.94910) - radians(lng)) + sin(radians(-19.83996)) * sin(radians(lat))) 
```

但是我在 SQLite 中进行了测试，这些数学函数（acos、cos、弧度、sin）不存在。有什么东西可以让我直接在数据库中计算距离吗？

但是，我有一个使用[这种方法](http://www.thismuchiknow.co.uk/?p=71)计算的 iPhone 应用程序。完美运行，但现在我需要在 Android 应用程序的数据库中执行相同的搜索。

提前致谢。

**更新**

我有 9000 个点来计算距离并获得给定点的 5 个附近位置。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T15:47:38.013

这是我要做的：

拿你给定的观点。测量一个（要细化的任意值）约 2 公里宽的正方形，并取东/西/北/南边界的值。

查询该正方形内的元素。这个很简单，你只需要

```
select * from points where lat between ? and ? and lon between ? and ? 
```

计算你的结果。没有足够的结果（显然小于 5，但我肯定会说两次），用更大的半径重试。太多（比如说，超过 100 个），用更小的半径再试一次。

一旦你有足够的，加载它们，确保你需要的所有 5 个元素不仅在 Xkm 宽的正方形中，而且在 Xkm 半径圆中（以避免之前的近似值没有检测到潜在的更近的元素）。

## 另一种方法

仅当您的给定点与您正在搜索的点相对接近时才有效。

测量平坦地球的局部近似值。接近您的观点，您可以考虑纬度、经度和距离之间的线性关系。这使您可以发出按简单演算排序的请求。（乘法和加法）。同样，选择更多点以便在 SQLite 请求之后进行正确的计算。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-01-07T10:03:23.760

将 cos_lat_rad,sin_lat_rad,cos_lon_rad,sin_lon_rad 插入到您的表中

```
contentValues.put("cos_lat_rad", Math.cos(deg2rad(latitude)));
contentValues.put("sin_lat_rad", Math.sin(deg2rad(latitude)));
contentValues.put("cos_lon_rad", Math.cos(deg2rad(longitude)));
contentValues.put("sin_lon_rad", Math.sin(deg2rad(longitude))); 
```

度数为弧度

```
public static double deg2rad(double deg) {
    return (deg * Math.PI / 180.0);
} 
```

查询,距离km

```
 Cursor c=database.dis(String.valueOf(Math.cos((double) distance / (double) 6380)), Math.cos(deg2rad(latitude)), Math.sin(deg2rad(latitude)), Math.cos(deg2rad(longitude)), Math.sin(deg2rad(longitude))); 
```

询问

```
public Cursor dis(String dis, double cos_lat_rad, double sin_lat_rad, double cos_lon_rad, double sin_lon_rad) {

    Cursor cursor = sqLiteDatabase.rawQuery("SELECT * ,(" + sin_lat_rad + "*\"sin_lat_rad\"+" + cos_lat_rad + "*\"cos_lat_rad\"*(" + sin_lon_rad + "*\"sin_lon_rad\"+" + cos_lon_rad + "*\"cos_lon_rad\")) AS \"distance_acos\" FROM parish WHERE ("+sin_lat_rad+" * \"sin_lat_rad\" +"+ cos_lat_rad +"* \"cos_lat_rad\" * (+"+sin_lon_rad +"* \"sin_lon_rad\" + "+cos_lon_rad +"* \"cos_lon_rad\")) >"+dis+ " ORDER BY \"distance_acos\" DESC ", null);
    return cursor;

} 
```

将 distance_acos 转换为 km

```
 if(c.moveToFirst())
        do {
            double distance_acos= c.getDouble(c.getColumnIndex("distance_acos"));
                     String Distance=String.valueOf(Math.acos(distance_acos) * 6380); 
        }while (c.moveToNext()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-08T14:09:55.060

```
For windows:

Install minGw full options. modify environment variable: system variable path, including

c:\mingw\bin

test functionality command:

g++ --version

copy files: extension-functions.c, sqlite3.h, sqlite3ext.h in sqlite3 program directory. Go to sqlite3 directory and compile:

gcc -shared -I "path" -o libsqlitefunctions.so extension-functions.c

   (path = path of sqlite3ext.h; i.e. C:\sqlite3)

If the program is built so that loading extensions is permitted, the following will work:

   sqlite> SELECT load_extension('./libsqlitefunctions.so');

   sqlite> select cos(radians(45));

   0.707106781186548

SQLite Distance implementation:

From:  https://www.movable-type.co.uk/scripts/latlong.html https://en.wikipedia.org/wiki/Haversine_formula

Distance
This uses the ‘haversine’ formula to calculate the great-circle distance between two points – that is, the shortest distance over the earth’s surface – giving an ‘as-the-crow-flies’ distance between the points (ignoring any hills they fly over, of course!).

Haversine
formula:    a = sin²(Δφ/2) + cos φ1 * cos φ2 * sin²(Δλ/2)
c = 2 * atan2( √a, √(1−a) )
c = 2 * 
d = R * c
where   φ is latitude, λ is longitude, R is earth’s radius (mean radius = 6,371km);
note that angles need to be in radians to pass to trig functions!
JavaScript: 
const R = 6378136.6 ; // meters equatorial radius
const φ1 = lat1 * Math.PI/180; // φ, λ in radians
const φ2 = lat2 * Math.PI/180;
const Δφ = (lat2-lat1) * Math.PI/180;
const Δλ = (lon2-lon1) * Math.PI/180;

const a = Math.sin(Δφ/2) * Math.sin(Δφ/2) +
          Math.cos(φ1) * Math.cos(φ2) *
          Math.sin(Δλ/2) * Math.sin(Δλ/2);
const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));

const c = 2 * Math.asen(MIN (1, Math.sqrt(a))); //sqlite implementation

const d = R * c; // in metres

Distance = 2 * R * ASIN( MIN (1, SQRT( SIN( (RADIANS(lat1)-RADIANS(lat2))/2 )^2 + COS( RADIANS(lat1) )*COS( RADIANS(lat2) )*SIN( (RADIANS(long1)-RADIANS(long2))/2 )^2 )))

Physical Properties of Earth https://en.wikipedia.org/wiki/Earth_ellipsoid :Ecuatorial radius: 6378.1366 Kms. Average radius: 6367 Kms

Constant = 2 * 6378136.6 = 12756273.2

SQLite query command with coordinates taken from table PAR: 

ROUND (
      12756273.2 * ASIN(
                        MIN (1 , 
                                SQRT(
                                    POWER( SIN(RADIANS(PAR.Lat1 - PAR.Lat2)/2) , 2) + 
                                    COS(RADIANS(PAR.Lat1)) * COS(RADIANS(PAR.Lat2)) * POWER ( SIN(RADIANS(PAR.Long1 - PAR.Long2)/2) , 2)
                                      )
                            )
                        )
         , 0) AS Distance 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-31T11:44:35.247

Angel的回复并没有解决SQLite的问题，因为它仍然包含SQLite中不存在的ACOS功能

经过深入研究后，我得出的结论是，应该使用以下公式选择一个粗略的估计以在 SQLite 中使用：

公里的距离估计：

```
SQRT(SQUARE((TO_LAT-FROM_LAT)*110)+
     SQUARE((TO_LONG-FROM_LONG)*COS(TO_LAT)*111)) 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-04-12T15:16:03.390

在 android 中，我们有一个 Location 类，我们需要初始化 location 类，其中我们有一个名为 distanceBetween() 的方法，它给出了两个地理点之间的距离。

参考这个[链接](http://developer.android.com/reference/android/location/Location.html)

# ios - 一些 UI 元素不获取 UIAppearance 特征

> ID：10126405
> 
> 赞同：3
> 
> 时间：2012-04-12T15:08:56.600
> 
> 标签：ios, ios5, uiview, uilabel

我正在尝试`UIAppearance`在我的 iOS 应用程序中使用统一的颜色主题。例如，我尝试将所有`UILabel`对象的文本颜色设置如下：

```
[[UILabel appearance] setTextColor:[UIColor colorWithRed:0.7 green:0.07 blue:0.12 alpha:1]]; 
```

这适用于我的故事板/XIB 中静态定义的所有对象。但是，有时我需要在视图中动态创建 UILabel。在这些情况下，不使用 UIAppearance。而是使用默认文本颜色（黑色）。

除了诉诸旧的“手动设置每个元素”方法之外，有没有人遇到过这个问题/找到了解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T09:10:24.900

似乎并非所有类都支持 UIAppearance 并且 UILabel 不是其中之一。

检查此问题以获取更多信息： [UIAppearance not getting effect on UILabels created programatically](https://stackoverflow.com/questions/11308379/uiapperance-not-taking-effect-on-uilabels-created-programatically)

以下是支持 UIAppearance 的类列表：http: [//blog.mosheberman.com/list-of-classes-that-support-uiappearance-in-ios-5/](http://blog.mosheberman.com/list-of-classes-that-support-uiappearance-in-ios-5/)

# asp.net - 如何修复asp.net中的文件或路径过长异常？

> ID：10126407
> 
> 赞同：2
> 
> 时间：2012-04-12T15:09:08.767
> 
> 标签：asp.net, path

我正在向某些网站发出网络请求。我不知道 url 的长度，因为我是动态获取的。因此，对于某些网址，我收到此错误：

"**指定的路径、文件名或两者都太长。完全限定的文件名必须少于 260 个字符，目录名必须少于 248 个字符。** "

**var request = HttpWebRequest.Create(url); var response = request .GetResponse();**

我在“url”中发送请求页面的 url，我应该得到 html 页面，但作为响应，我得到“路径太长异常”。

提前致谢。

# java - 如何使用编程语言模拟 Erlang(k) 变量？

> ID：10126409
> 
> 赞同：0
> 
> 时间：2012-04-12T15:09:10.960
> 
> 标签：java, c++, gamma-distribution

我有一个大学项目，我需要在其中创建一个模拟 Erlang(k) 变量的程序。我不是在谈论 Erlang 语言，而是关于标准 Gamma(0,1,k), k ϵ N+。如果有人可以帮助我或就如何在 C++ 或 Java 中解决此问题提供建议，我将不胜感激。

我已经写了这个问题附带的公式和定理：[link](http://imageshack.us/g/96/erlang2.jpg/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:17:27.950

试试这个：[http ://www.ee.ucl.ac.uk/~mflanaga/java/Stat.html](http://www.ee.ucl.ac.uk/~mflanaga/java/Stat.html)

# excel - VBA 数字格式

> ID：10126419
> 
> 赞同：2
> 
> 时间：2012-04-12T15:09:48.103
> 
> 标签：excel, vba, accounting

我正在编写一个宏包来格式化会计格式的数字，这样我每次想要制作数字会计格式（我的工作需要）时都不必单击“alt - h - fm”。我的代码达到了一定程度，但它与 excel 的会计格式不匹配。现在 $ 出现在数字前一个空格，而不是在单元格的左边缘（就像它对 excel 的会计格式一样）。我目前的代码格式为数千，没有小数，所有错误是美元符号没有出现在单元格的左边缘。

这是我的数字格式代码：

```
Selection.NumberFormat = "_(* $ #,##0_);_(* $ (#,##0);_(* ""$  -""?_);_(@_)" 
```

我应该如何更改它以使美元符号出现在单元格的开头？

感谢您的帮助！这已经难倒我一段时间了......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:15:15.293

您需要将:等放在`$`前面。`*``_($* #,##0_);`

此外，如果您想复制现有格式，您可以随时使用宏记录器，将单元格更改为您想要的格式，然后检查自动生成的代码。

# php - MySql 重叠日期无法正确处理

> ID：10126420
> 
> 赞同：2
> 
> 时间：2012-04-12T15:09:53.533
> 
> 标签：php, mysql

我正在尝试使用重叠日期进行查询。我的表看起来像这样'

```
Agenda ID   DateStart               DateEnd
-------------------------------------------------------
1           2012-04-02 08:00:00     2012-04-02 11:30:00
2           2012-04-02 10:00:00     2012-04-02 13:00:00
3           2012-04-02 12:00:00     2012-04-02 15:00:00 
```

此数据用于计划活动。如果时间重叠，您将无法计划活动。在这种情况下，所有时间都重叠。但他将其与您之前计划的进行了比较。假设我计划了 ID 1，所以我不能计划 ID 2，但我可以计划 ID 3。

如何使用 php 编写查询以选择重叠的项目。非常感谢你

```
SELECT
   agenda.DateStart,
   agenda.DateEnd,
   agenda.AgendaID
FROM
   AGENDA
WHERE
   ????
   AND
   ???? 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T15:16:00.833

```
select a.DateStart, a.DateEnd, a.AgendaId, b.DateStart, b.DateEnd, b.AgendaId
from agenda a, agenda b
where 
a.AgendaId <> b.AgendaId
and b.DateStart>= a.DateStart and
b.DateStart<= a.DateEnd 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:15:52.833

```
$query_Orders = "SELECT * FROM AGENDA WHERE fldTime between  DateStart  and DateENd "; 
```

您可以使用**MYSQL** `BETWEEN`关键字进行检查。

# java - PreparedStatement 性能调优

> ID：10126427
> 
> 赞同：0
> 
> 时间：2012-04-12T15:10:22.683
> 
> 标签：java, jdbc

有什么方法可以提高准备好的语句的性能吗？这是关于许多选择查询。我这样查询：

```
 String query = "SELECT NAME, ADDRESS " 
                + "FROM USERS "
                + "where ID = ? "
                + "group by NAME, ADDRESS";

PreparedStatement pstmt = connection.prepareStatement(query);

for(long id: listIDs){
   pstmt.setLong(1, id);
   ResultSet rs = pstmt.executeQuery();

   ...
} 
```

数据库是 MySQL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:15:22.627

它是准备查询的服务器（这就是您需要连接的原因）。为了提高准备好的语句的性能，您必须调整数据库服务器本身（索引等）。

另一种方法是编写只得到你想要的结果的查询。

另一个想法是在客户端缓存你知道你会经常使用的数据，这样你就不会一次又一次地在数据库中查询相同的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:13:27.793

两个建议：

1.  确保该`ID`字段已编入索引。
2.  将许多小查询合并为一个，例如使用`WHERE ID IN (...)`.

有关后者的更详细讨论，请参阅[JDBC 中的批处理选择语句](http://www.javaranch.com/journal/200510/Journal200510.jsp#a2)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:26:13.940

您可能还想调查您的 JDBC 驱动程序是否支持语句缓存。我知道 oracle 的 JDBC 驱动程序确实支持。

# java - 无法创建 JVM：JVM 日志位置

> ID：10126430
> 
> 赞同：-1
> 
> 时间：2012-04-12T15:10:31.163
> 
> 标签：java, jvm, java-web-start, jvm-crash

我通过 Java Webstart 部署应用程序（使用 Oracle JDK/JRE 1.7 + Java FX 2）。
它适用于大多数用户，但是其中一个用户有时（并非总是）在启动应用程序时会出现此错误：

```
Error: Could not create the Java Virtual Machine.
Error: A fatal exception has occured. Program will exit. 
```

有没有办法获得有关导致问题的原因的更多信息（如日志）？
关于问题可能是什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T01:43:49.297

从评论中复制：-我认为这通常是硬件/RAM问题（特别是因为它有时会发生）。做一些谷歌搜索，你会发现一些经历过的人。但最好能获得有关用户机器的更多信息。-好吧，我查找了错误：致命异常......以及我发现的唯一内存错误（特别是来自其他使用 Java 的东西）。建议编辑 run.bat/dat.bat 作为可能的解决方案？不幸的是，由于错误的模糊性，很难提出一个可靠的解决方案，但无论如何我发现： [link1](http://groups.google.com/group/akka-user/browse_thread/thread/bb0e26255984fc11?pli=1) [link2](http://forums.bukkit.org/threads/java-problem.68817/) [link3](http://nest.array.ca/web/nest/forum/-/message_boards/message/234665)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-15T20:55:27.793

我遇到了几乎相同的问题（我每次都遇到这个错误）并通过更改**eclipse.ini来修复**

```
--launcher.XXMaxPermSize
256m 
```

至

```
--launcher.XXMaxPermSize
900m 
```

900 是下面的 Xmx

# excel - Countifs 匹配 OR 条件？

> ID：10126432
> 
> 赞同：1
> 
> 时间：2012-04-12T15:10:36.460
> 
> 标签：excel, excel-2007, excel-formula, countif

我有以下计数公式

```
=COUNTIFS($F$2:$F$848,Summary!$F5,'Report'!$G$2:$G$848,$Q$10,$G$2:$G$848,$Q$11) 
```

在我的工作表上，Q10 = 星期一，Q11 = 星期二 在“报告”上，G2:G848 包含登录数据

目标：我需要周一（Q10）或周二（Q11）的报告总数

使用我拥有的当前公式，countifs 正在查找行中包含星期一和星期二的行，这是错误的。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:38:19.900

大概 F2:F848 也在报告表上？尝试这个

`=SUMPRODUCT(COUNTIFS('Report'!$F$2:$F$848,Summary!$F5,'Report'!$G$2:$G$848,$Q$10:$Q$11))`

假设公式与 Q10 和 Q11 值位于同一张纸上......

COUNTIFS 函数将返回一个包含 2 个值的“数组”，一个用于星期一（Q10），一个用于星期二（Q11），然后 SUMPRODUCT 只需将这两个值相加即可为您提供两天的总数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:27:01.943

```
=COUNTIF('Report'!$G$2:$G$848,"Q10")+COUNTIF('Report'!$G$2:$G$848,"Q11") 
```

这假设`'Report'!$G$2:$G$848`包含您正在谈论的`Q10`和值。`Q11`

# maven - 在 gradle 中，如何生成 ivy.xml 和 pom.xml 文件？

> ID：10126437
> 
> 赞同：4
> 
> 时间：2012-04-12T15:10:47.360
> 
> 标签：maven, ivy, gradle

目前，我们的 gradle 设置适合在构建完成后发布到某些 maven 存储库。对于特定客户，我需要压缩 jars、许可证文件、pom.xml 和 ivy.xml 文件，然后将其全部发送到 zip 中。为此，我只需要定义一个备用位置即可将其发布到。gradle 网站上的所有文档似乎都旨在编写一套发布规则，而不是另一套。

我希望简单地编写一个不同的任务，该任务将专注于构建这个客户特定的 zip 文件。到目前为止，我已经收集了所有 jars（包括源代码和可运行代码）以及许可证和通知文件。但是我还没有解决定义本地 ivy 存储库和本地 maven 存储库的问题，这只是这个 alt 任务的一部分。

```
task alt {
    dependsOn subprojects*.tasks*.matching { task -> task.name == 'assemble' }

    subprojects.each{project ->
        if (project.hasProperty('sourceJar')) {
            evaluationDependsOn(project.name)
        }
    }

    File altDir = mkdir("$buildDir/alt")
    subprojects.each { project -> 
        if (project.hasProperty('sourceJar')) {
            // Extra the module name from the path of the sub-project
            String submodule = project.projectDir.absolutePath.split(File.separator).last()
            File subfolder = mkdir(altDir.absolutePath + "/${project.group}/${group}.${submodule}/$version")
            project.tasks.withType(Jar).each {archiveTask ->
                copy {
                    from archiveTask.archivePath
                    from("$rootDir") {
                        include 'license.txt'
                        include 'notice.txt'
                    }
                    into subfolder
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T12:40:44.613

这是[gradle 文档](http://gradle.org/docs/current/userguide/maven_plugin.html#newPom)，它告诉您如何生成 pom。此外，如果您希望将该文件安装到本地存储库，您可以使用此[博客条目](http://linkedjava.blogspot.com/2011/06/gradle-build-to-create-pom.html)中描述的机制。基本上所有你需要做的

```
configure(install.repositories.mavenInstaller) {
    pom.project {
        version '1.0'
        artifactId 'your.artifact.id'
        groupId 'your.group.id'
    }
} 
```

目前看起来不可能通过 gradle 生成 ivy.xml，但是一旦你有了 pom 文件，你就可以使用 ivy 本身来生成[这里描述](http://ant.apache.org/ivy/history/latest-milestone/use/convertpom.html)的 ivy 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-26T17:02:38.530

[http://www.gradle.org/docs/current/userguide/publishing_ivy.html](http://www.gradle.org/docs/current/userguide/publishing_ivy.html)的第 64.5 节涵盖“生成 Ivy 模块描述符文件而不发布”。

文档有点破损（例如不一致的命名约定）。以下对我有用：

```
apply plugin: 'ivy-publish'

publishing {
    publications {
        aoeu(IvyPublication)
    }
} 
```

这将生成一个目标`generateDescriptorFileForAoeuPublication`。

# javascript - 如何使用外部源调整 iframe 的大小并偏移内容？

> ID：10126442
> 
> 赞同：0
> 
> 时间：2012-04-12T15:11:06.453
> 
> 标签：javascript, jquery, ajax, dom, iframe

我怎样才能：

1.  等待外部 iFrame 加载
2.  调整外部来源 iFrame 的大小（例如：100 像素 x 40 像素）
3.  偏移外部来源的 iFrame（例如：25 像素 x 50 像素）

示例代码：

```
<html>
<body>
    <p>Here's Google's Logo Today:</p>
    <iframe id="google_logo" src="http://www.google.com/search?q=stackoverflow"></iframe>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {});
    </script>
</body>
</html> 
```

我知道您无法获取外部 iFrame 的内容，但是调整大小和偏移呢？

我也知道我的例子很荒谬。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:19:58.280

当外部 iframe 完全加载时，您无法触发事件，但其余的都是可能的。

将框架包裹在 div 中

```
<div id="frame_wrapper">
  <iframe id="google_logo" src="http://www.google.com/search?q=stackoverflow"></iframe>
</div> 
```

添加以下 jQuery

```
$(document).ready(function() {
  $("#frame_wrapper").addClass("iframe_shift");
}); 
```

添加以下 CSS

```
#google_logo { width: 100%; height: 100%; }
.iframe_shift { width:100px; height: 45px; position: relative; top: 25px; left: 45px;  }​ 
```

# validation - Silverlight 5 验证问题

> ID：10126444
> 
> 赞同：0
> 
> 时间：2012-04-12T15:11:07.217
> 
> 标签：validation, textbox, silverlight-5.0

我正在尝试使用 silverlight 中的验证来验证我的项目的数据输入

这是结果

[http://imageshack.us/photo/my-images/842/immagineleb.png/](http://imageshack.us/photo/my-images/842/immagineleb.png/)

如您所见，几乎所有文本框的边框都是红色的，实际上，在这种情况下，它们都不应该是红色的！在所有工具提示中都有相同的信息。

我在表单的数据上下文中使用了对象的属性

```
 private int matricola;
    public int Matricola
    {
        get { return matricola; }
        set 
        {
            ValidateRequiredInt("Matricola", value, "Inserire un numero");
            matricola = value;
            OnNotifyPropertyChanged("Matricola");
        }
    }

    private String cognome;
    public String Cognome
    {
        get { return cognome; }
        set 
        {
            ValidateRequiredString("Cognome", value, "Inserire cognome");
            cognome = value;
            OnNotifyPropertyChanged("Cognome");
        }
    }

    private String nome;
    public String Nome
    {
        get { return nome; }
        set 
        {
            ValidateRequiredString("Nome", value, "Inserire nome");
            nome = value;
            OnNotifyPropertyChanged("Nome");
        }
    }

    private String codiceUtente;
    public String CodiceUtente
    {
        get { return codiceUtente; }
        set 
        {
            ValidateRequiredString("CodiceUtente", value, "Inserire codice utente");
            codiceUtente = value;
            OnNotifyPropertyChanged("CodiceUtente");
        }
    }

    private String password;
    public String Password
    {
        get { return password; }
        set 
        {
            ValidateRequiredString("Password", value, "Inserire password");
            password = value;
            OnNotifyPropertyChanged("Password");
        }
    }

    private int? idOrario;
    public int? IdOrario
    {
        get { return idOrario; }
        set { idOrario = value; }
    }

    private DateTime? dataAssunzione;
    public DateTime? DataAssunzione
    {
        get { return dataAssunzione; }
        set 
        {
            if (value != null)
            {
                ValidateDateTime("DataAssunzione", (DateTime)value, "Immettere una data corretta");
                if (((DateTime)value).Year == 1 && ((DateTime)value).Month == 1 && ((DateTime)value).Day == 1)
                {
                    dataAssunzione = null;
                }
                else
                {
                    dataAssunzione = value;
                }
                OnNotifyPropertyChanged("DataAssunzione");
            }
            else
            {
                dataAssunzione = null;
            }
        }
    }

    private DateTime? dataLicenziamento;
    public DateTime? DataLicenziamento
    {
        get { return dataLicenziamento; }
        set 
        {
            if (value != null)
            {
                ValidateDateTime("DataLicenziamento", (DateTime)value, "Immettere una data corretta");
                if (((DateTime)value).Year == 1 && ((DateTime)value).Month == 1 && ((DateTime)value).Day == 1)
                {
                    dataLicenziamento = null;
                }
                else
                {
                    dataLicenziamento = value;
                }
                OnNotifyPropertyChanged("DataLicenziamento");
            }
            else
            {
                dataLicenziamento = null;
            }
        }
    }

    private int idGruppoAnag;
    public int IdGruppoAnag
    {
        get { return idGruppoAnag; }
        set { idGruppoAnag = value; }
    }

    private int? costoOrario;
    public int? CostoOrario
    {
        get { return costoOrario; }
        set 
        {
            if (value != null)
            {
                ValidateInt("CostoOrario", (int)value, "Immettere un numero o lasciare il campo vuoto");
                if (value == 0 || value == -1)
                {
                    costoOrario = null;
                }
                else
                {
                    costoOrario = value;
                }
                OnNotifyPropertyChanged("CostoOrario");
            }
            else
            {
                costoOrario = null;
            }
        }
    } 
```

这些是用于验证的方法

```
 protected bool ValidateRequiredInt(string propName, int value, string errorText)
    {
        if (DataErrors.ContainsKey(propName))
        {
            DataErrors[propName].Remove(errorText);
        }

        if (value == 0 || value == -1)
        {
            AddError(propName, errorText);
            return false;
        }
        OnErrorsChanged(propName);
        return true;
    }

    //validazione dei campi che richiedono numeri interi nullable
    protected bool ValidateInt(string propName, int value, string errorText)
    {
        if (DataErrors.ContainsKey(propName))
        {
            DataErrors[propName].Remove(errorText);
        }
        if (value == 0)
        {
            AddError(propName, errorText);
            return false;
        }
        OnErrorsChanged(propName);
        return true;
    }

    //validazione dei campi che richiedono stringhe
    protected bool ValidateRequiredString(string propName, string value, string errorText)
    {
        //Clear any existing errors since we're revalidating now
        if (DataErrors.ContainsKey(propName))
        {
            DataErrors[propName].Remove(errorText);
        }
        if (string.IsNullOrEmpty(value))
        {
            AddError(propName, errorText);
            return false;
        }
        OnErrorsChanged(propName);
        return true;
    }

    protected bool ValidateDateTime(string propName, DateTime value, string errorText)
    {
        //Clear any existing errors since we're revalidating now
        if (DataErrors.ContainsKey(propName))
        {
            DataErrors[propName].Remove(errorText);
        }
        if (value.Year == 9999 && value.Month == 12 && value.Day == 31)
        {
            AddError(propName, errorText);
            return false;
        }
        OnErrorsChanged(propName);
        return true;
    } 
```

我还在两个“数据”文本框中使用 dataconverter，在 matricola 和 costo 文本框中使用 numberconverter 作为本地资源，我可以说它们工作正常。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T20:38:31.933

如何实现 INotifyDataErrorInfo？

在视图模型基类中：

```
 public abstract class BaseViewModel : INotifyPropertyChanged, INotifyDataErrorInfo
{
    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    protected void OnPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }

#endregion

    #region INotifyDataErrorInfo Members

    public event EventHandler<DataErrorsChangedEventArgs> ErrorsChanged;

    public System.Collections.IEnumerable GetErrors(string propertyName)
    {   
    ....
    }

    public System.Collections.IEnumerable GetErrors()
    {
    ...
    }

//Plus methods to push errors into an underlying error dictionary used by the above error get methods
} 
```

对此进行扩展，您将拥有所有视图模型的可重用基类。在适当的设置器中验证属性。如果它们验证失败，则将错误推送到由属性名称键入的错误字典中。如果验证成功，则从属性的字典中删除验证错误（如果有）。

更改字典时需要触发 ErrorsChanged 事件，但这可以通过使用受保护的

```
SetErrorForProperty(string propName, object error) 
```

方法将其包装起来。可以通过将 null 传递给此方法和/或使用单独的方法来清除错误

> ClearErrorsFroProperty（字符串 propName）

方法。

# facebook - 获取自 facebook 中的时间戳以来的更新次数

> ID：10126446
> 
> 赞同：1
> 
> 时间：2012-04-12T15:11:09.593
> 
> 标签：facebook, facebook-graph-api

我们可以使用图形 APIS 获取自特定时间戳以来的更新次数吗？更新的数量可能是新的新提要或消息的数量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T18:00:04.237

取决于您调用的 api

> 在用户的新闻提要上搜索公共帖子或帖子时，您可以使用since、until 和limit 参数对结果进行翻页。since 和 until 都接受 unix 时间戳。及时分页时，您应该将 until 与 limit 结合使用，其中 until 是上一个查询返回的最后一个对象中 created_time 字段的 unixtime 值。及时向前分页时，您应该将 since 设置为上一个查询返回的第一个对象中 created_time 字段的 unixtime 值。请注意，您只能在新闻提要中搜索大约 1 到 2 周前的内容。

/me/feed?since=2+hours+ago&until=now "在 php 中使用 strtotime"

# html - 如何从 CSS 中屏蔽 HTML 标签？

> ID：10126451
> 
> 赞同：1
> 
> 时间：2012-04-12T15:11:20.633
> 
> 标签：html, css

有什么方法可以将 HTML 元素与 CSS 隔离开来？我正在尝试使 a 及其所有子项在文档中变得“不可见”。

用户能够通知在文档上调用的 css，但我需要确保这不会丢失，我的意思是，没有显示：无，可见性：隐藏，文本缩进：-10000px，左：- 10000px，或任何其他这些技巧。

```
<div class="foo">
 <a href="#foo">link</a>
 <img src="" />
 <span>bar</span>
</div> 
```

我可以使用 data:text/html;base64 iframe，但文本不会被格式化。

考虑免责声明或徽标。用户可以在我的小部件中包含他自己的 CSS（通过通知 CSS URL），即使用户在他的 CSS 上为该免责声明元素或其任何子项指定 display:none 或 text-indent，我也需要保持该免责声明可见。

我不是想不使用任何样式，我只是想知道是否有任何属性可以屏蔽 <tag/>，例如“-moz-user-select: none;”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T17:59:04.680

没有任何东西可以 100% 地工作，但这里有一个在大多数情况下都可以工作的解决方案：

```
<div class="foo" style="background:#fff !important;color:#000 !important;position:relative !important;display:block !important;visibility:visible !important;opacity:1 !important;float:none !important;left:0 !important;top:0 !important;">
 <a href="#foo" style="background:#fff !important;color:#000 !important;position:relative !important;display:inline !important;visibility:visible !important;opacity:1 !important;float:none !important;left:0 !important;top:0 !important;">link</a>
 <img src="" style="background:#fff !important;color:#000 !important;position:relative !important;display:inline !important;visibility:visible !important;opacity:1 !important;float:none !important;left:0 !important;top:0 !important;" />
 <span style="background:#fff !important;color:#000 !important;position:relative !important;display:inline !important;visibility:visible !important;opacity:1 !important;float:none !important;left:0 !important;top:0 !important;">bar</span>
</div> 
```

基本上，您希望`!important`为每个不想在`style`属性中覆盖的样式指定。如果手动完成这是一个巨大的痛苦，就像我之前所说的，*可以*由精通 CSS 的人解决。

***注意：**提供的样式并不是一个详尽的列表，只是我能想到的东西。*

[关于 CSS 特异性](http://www.w3.org/TR/CSS21/cascade.html#specificity)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T20:45:33.810

正如之前的答案所指出的，没有属性可以做到这一点，而且这种`!important`方法也不起作用，为什么？主要是因为用户可以使用自己的css，如果用户`!important`在每个样式属性中放置，它会覆盖以前`!important`的标记属性，这里有一个例子：

`Site.css` .copyright { 显示：块！重要；/* 这里有其他样式 */ }

`Uploaded css` .copyright { 显示：无！重要；/* ... */ }

您可以克服它的唯一方法是阅读上传的样式表并删除**every** `!important`，在这种情况下，您可以使用`!important`避免样式属性被覆盖。

> *编辑：但是您必须主动声明用户可能用来隐藏*元素的每个属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T17:58:40.497

不，没有属性可以屏蔽标签。

# spotify - Spotify 应用程序 - 用于在应用程序内创建的播放列表的“添加为播放列表”按钮

> ID：10126452
> 
> 赞同：0
> 
> 时间：2012-04-12T15:11:21.583
> 
> 标签：spotify

我的代码循环遍历许多专辑以获取它们的曲目并将它们添加到播放列表变量中

```
playlist.add(m.Track.fromURI(results.tracks[j].uri)); 
```

我之前设置的

```
var playlist = new m.Playlist('robs top 5'); 
```

我现在如何创建一个“添加为播放列表”按钮，它将这个播放列表对象变成用户的播放列表？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T16:43:47.053

做一个按钮，然后调用

```
playlist.subscribed = true; 
```

但我认为这不适用于自行生成的播放列表，但请告诉我。

-edit K，我已经为你整理好了。当你想要一个订阅按钮时，你想做的是给你的播放列表一个名字，然后你需要添加的是 subscribed 是真的。

```
$('#subscribe').on('click', function() {
    var playlist = new models.Playlist('Playlist Name');
            playlist.subscribed = true;
            $.each(tracks, function(index, track){
                playlist.add(track);
            });
    }); 
```

这是我如何做到的一小部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:24:13.607

在这里，我是怎么做的：

```
$('myplaylistbutton').live('click',function(e){
var myAwesomePlaylist = new m.Playlist(album.artist.name + " - " + pl.name);
$.each(pl.data.all(),function(i,track){
    myAwesomePlaylist.add(track);
});
e.preventDefault();
}); 
```

希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T15:54:26.217

为了制作播放列表，您需要拥有以下代码：

```
$(document).ready(function() {
    /* Instantiate the global sp object; include models & views */
    var sp = getSpotifyApi(1);
    var models = sp.require('sp://import/scripts/api/models');
    var views = sp.require('sp://import/scripts/api/views');

    $("#subscribe").click(function(playlist){
        var playlist = models.Playlist.fromURI("spotify:user:spotify:playlist:3Yrvm5lBgnhzTYTXx2l55x");
        playlist.subscribed = true;

        playlist.observe(models.EVENT.CHANGE, function() {
            console.log("Playlist is subscribed!");
        });
     });

}); 
```

# security - 交易前需要重新输入密码

> ID：10126453
> 
> 赞同：1
> 
> 时间：2012-04-12T15:11:24.807
> 
> 标签：security, facebook-login

我看过您使用 Facebook 帐户登录的网站，捐款后会保存您的 CC 信息以供将来使用。

可怕的部分是，如果您的 FB 登录信息已保存，并说您离开计算机，有人可以使用您的登录信息进行访问，并使用您的信用卡向另一个组织捐款，因为它已保存。

不太可能发生的情况，但仍有可能。有没有办法让用户使用保存的 FB 登录名浏览网站，但要求他们重新输入密码作为完成交易的最后一步？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:43:50.637

是的，有这样的功能。它由 docs [Re-Authentication](http://developers.facebook.com/docs/authentication/reauthentication/)调用，专为此类情况而设计。

引用[文档](http://developers.facebook.com/docs/authentication/reauthentication/)：

> 在某些应用程序中，您可能需要仔细检查用户的身份 - 可能在他们进行购买或更改某些个人数据之前。重新身份验证允许您强制用户重新输入他们的 Facebook 密码，然后再将其传回您的应用程序。

# .net - 如何在 Entity Framework .NET 3.5 中处理 NN 关系

> ID：10126454
> 
> 赞同：0
> 
> 时间：2012-04-12T15:11:49.587
> 
> 标签：.net, entity-framework, .net-3.5

我在两个元素 Sfera 和 Contenuti 之间有 NN 关系。

在 Sfera 项目上，我看到 Contenuti 实体集，在 Contenuti 中，我看到 Sfera 集。

当我通过代码添加新项目时，我使用如下结构：

```
using (IndexDB DB = new IndexDB())
        {
            try
            {
                var newContenuto = new Contenuto();
                newContenuto.Cancellato = false;
                newContenuto.PK_Content_ID = tt_content_id;
                newContenuto.URL = URL;
                foreach(long sphere in SphereID)
                {
                    try
                    {
                        var sfere = from sfera in DB.Sfera where sfera.PK_Sfera == sphere select sfera;
                        newContenuto.Sfera.Add(sfere.First());
                        sfere.First().Contenuto.Add(newContenuto);
                    }
                    catch (Exception exc)
                    {
                        return new StandardResponse() {Success = false, Message = exc.Message};
                    }
                }
                DB.AddToContenuto(newContenuto);
                DB.SaveChanges();
                return new StandardResponse() {Success = true};
            }
            catch (Exception e)
            {
                return new StandardResponse() { Success = false, Message = e.Message + e.StackTrace };
            } 
```

如果我看一下我的数据库，它会很好地存储我在右侧“NN”表中的两个元素之间的关系......但是当我尝试访问元素 Contenuto.Sfera 和 Sfera.Contenuto 总是空集.. .

要访问我做这样的事情：

```
using (IndexDB DB = new IndexDB())
        {
            var sfere = from sfera in DB.Sfera where sfera.PK_Sfera == IDSfera && sfera.Attiva select sfera;

            if (!sfere.Any())
            {
                response.Add(new UrlResponse() { Success = false, ErrorMessage = "" });
            }
            var sferaSelezionata = sfere.First();
//HERE sferaSelezionata.Contenuto.Count == 0 even if on DB there are MANY "connections"
} 
```

}

我该如何处理？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:22:58.610

尝试`Include()`在您的查询中使用。

```
var sfere = from sfera in DB.Sfera.Include("Contenuto") where sfera.PK_Sfera == IDSfera && sfera.Attiva select sfera; 
```

# c# - 如何实现 System.Linq.Expressions.Expression.Like

> ID：10126455
> 
> 赞同：1
> 
> 时间：2012-04-12T15:11:51.413
> 
> 标签：c#, asp.net, .net, linq, lambda

我正在编写一个动态linq查询来实现分页，现在我遇到一个问题，我需要该`System.Linq.Expressions.Expression.Like`功能，但它不存在`System.Linq.Expressions.Expression`，这是我的代码。

```
Expression mWhereFunc;          // Filter clause 
ParameterExpression mLinqParam; // Linq param

// Get current request page
string mCurPage = this.Request.QueryString["page"];
if (String.IsNullOrEmpty(mCurPage))
{
    mCurPage = "1";
}

mLinqParam = Expression.Parameter(typeof(ORD_Order), "p");
mWhereFunc = Expression.Equal(Expression.Property(mLinqParam,
     typeof(ORD_Order).GetProperty("ItemIsValid")), 
     Expression.Constant(true));

string mOrderSN = this.Request.QueryString["txtOrderSN"];
if (!String.IsNullOrEmpty(mOrderSN))
{
    mWhereFunc = Expression.And(mWhereFunc, 
     **Expression.Equal**(Expression.Property(mLinqParam,
     typeof(ORD_Order).GetProperty("OrderSN")), 
     Expression.Constant(mOrderSN)));
}

var mLambdaWhere = (Expression<Func<ORD_Order, 
      bool>>)Expression.Lambda<Func<ORD_Order, bool>>(mWhereFunc, 
     new ParameterExpression[] { mLinqParam });
Func<ORD_Order, Int32> mLambdaOrder = p => p.OrderID;

IORD_OrderRepository rptOrder = new ORD_OrderRepository();
ICTM_CustomerRepository rptCtm = new CTM_CustomerRepository();

var list = from o in rptOrder.GetAll()
             .Where(mLambdaWhere)
                 .OrderBy(mLambdaOrder)
                 .Skip((int.Parse(mCurPage) - 1) * mPageSize).Take(mPageSize)
               join c in rptCtm.GetAll()
               on o.CustomerID equals c.CustomerID
               select new
               {
                   o.OrderID,
                   o.OrderSN,
                   o.CustomerID,
                   c.ContactName,
                   o.Status,
                   o.CreateDate,
                   o.Description
               }; 
```

**Expression.Equal**是我想将其更改为 Expression.Like 的地方 ![在此处输入图像描述](../Images/61eaade400829f7f14ebc75ca3405d36.png)

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T12:12:44.787

我像这样修改了我的代码

```
mWhereFunc = Expression.And(mWhereFunc, Expression.Call(
   Expression.Property(mLinqParam, typeof(ORD_Order).GetProperty("OrderSN")), 
   typeof(String).GetMethod("Contains"), 
   new Expression[] { Expression.Constant(mOrderSN) })); 
```

它有效，非常感谢你们所有人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T14:36:57.803

像 linq 的等价物 是`String.Contains`等[http://www.simonrhart.com/2008/06/using-like-in-linq-to-sql-under-c.html](http://www.simonrhart.com/2008/06/using-like-in-linq-to-sql-under-c.html)`String.StartsWith`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:30:12.533

如果您使用 NHibernate，您可以创建一个 Like 方法并使用 Expression 来调用它

您可以在此处查看有关如何进行“Like”扩展的帖子：[NHibernate Linq Provider Extension](http://fabiomaulo.blogspot.mx/2010/07/nhibernate-linq-provider-extension.html)

然后你像这样构建“Like”表达式：

```
Expression.Call(typeof(MyLinqExtensions).GetMethod("IsLike"), Expression.Property(mLinqParam,
     typeof(ORD_Order).GetProperty("OrderSN")), 
     Expression.Constant(mOrderSN))); 
```

**编辑：**作为附加评论，您应该使用`Expression.AndAlso`而不是`Expression.And`因为第一个是 && 运算符，最后一个是 & 运算符

**编辑 2：**对于实体框架检查这篇文章（Linq To Entities 场景）：[SQL User-Defined Functions in Entity Framework 4](http://blogs.microsoft.co.il/blogs/gilf/archive/2009/05/28/entity-sql-user-defined-functions-in-entity-framework-4.aspx)，我没有经验，但它似乎与 NH 提供程序相同，然后构建 Linq 表达式应该和我之前发的一样

# javascript - 来自本质上无域的移动应用程序的跨域 XMLHttpRequest？

> ID：10126458
> 
> 赞同：0
> 
> 时间：2012-04-12T15:12:01.677
> 
> 标签：javascript, cordova, network-programming, xmlhttprequest, cross-domain

我正在使用PhoneGap 框架制作一个移动应用程序，也就是说整个应用程序是用HTML、CSS 和JavaScript 编写的。

该应用程序的一部分要求我从远程数据库中获取一些信息。

我花了最后一个小时阅读如何将 XMLHttpRequest() 发送到远程域，但我终其一生都无法弄清楚。

作为奖励，由于请求的目标是检索一些数据库内容，我需要向服务器发送 3 个参数以进行查询。

我一直看到有关同源策略的事情，但我找不到任何明确说明它是否适用于没有实际主机的 phonegap 应用程序的东西。我还看到了大约 6 个相当复杂的解决方法。在我麻烦实施其中一个之前，我想确认现在没有一些简单的方法可以做到这一点。如果是这样，任何人都可以举一个例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T19:55:09.690

当您从移动设备的 file:// 协议运行 XHR 时，同源策略不适用。这是我用来展示如何向 twitter 发出 XHR 请求的一个小示例。

[http://simonmacdonald.blogspot.ca/2011/12/on-third-day-of-phonegapping-getting.html](http://simonmacdonald.blogspot.ca/2011/12/on-third-day-of-phonegapping-getting.html)

# c# - 为什么在这个简单的测试中方法的速度与触发顺序有关？

> ID：10126460
> 
> 赞同：11
> 
> 时间：2012-04-12T15:12:06.537
> 
> 标签：c#, performance

我一直在做其他实验，直到这种奇怪的行为引起了我的注意。

代码在 x64 版本中编译。

如果键入 1，**则 List 方法的第三次运行比第一次 2 花费 40% 的时间**。输出是

```
List costs 9312
List costs 9289
Array costs 12730
List costs 11950 
```

如果键入 2，**则 Array 方法的第 3 次运行比第 2 次花费的时间多 30%**。输出是

```
Array costs 8082
Array costs 8086
List costs 11937
Array costs 12698 
```

您可以看到该模式，完整的代码附在下面（只需编译并运行）：{提供的代码是运行测试的最小代码。用于获得可靠结果的实际代码更复杂，我将方法打包并在适当预热后测试了 100 多次}

```
class ListArrayLoop
{
    readonly int[] myArray;
    readonly List<int> myList;
    readonly int totalSessions;

    public ListArrayLoop(int loopRange, int totalSessions)
    {
        myArray = new int[loopRange];
        for (int i = 0; i < myArray.Length; i++)
        {
            myArray[i] = i;
        }
        myList = myArray.ToList();
        this.totalSessions = totalSessions;
    }
    public  void ArraySum()
    {
        var pool = myArray;
        long sum = 0;
        for (int j = 0; j < totalSessions; j++)
        {
            sum += pool.Sum();
        }
    }
    public void ListSum()
    {
        var pool = myList;
        long sum = 0;
        for (int j = 0; j < totalSessions; j++)
        {
            sum += pool.Sum();
        }
    }

}
class Program
{
    static void Main(string[] args)
    {
        Stopwatch sw = new Stopwatch();
        ListArrayLoop test = new ListArrayLoop(10000, 100000);

        string input = Console.ReadLine();

        if (input == "1")
        {
            sw.Start();
            test.ListSum();
            sw.Stop();
            Console.WriteLine("List costs {0}",sw.ElapsedMilliseconds);
            sw.Reset();
            sw.Start();
            test.ListSum();
            sw.Stop();
            Console.WriteLine("List costs {0}", sw.ElapsedMilliseconds);
            sw.Reset();
            sw.Start();
            test.ArraySum();
            sw.Stop();
            Console.WriteLine("Array costs {0}", sw.ElapsedMilliseconds);
            sw.Reset();
            sw.Start();
            test.ListSum();
            sw.Stop();
            Console.WriteLine("List costs {0}", sw.ElapsedMilliseconds);
        }
        else
        {
            sw.Start();
            test.ArraySum();
            sw.Stop();
            Console.WriteLine("Array costs {0}", sw.ElapsedMilliseconds);
            sw.Reset();
            sw.Start();
            test.ArraySum();
            sw.Stop();
            Console.WriteLine("Array costs {0}", sw.ElapsedMilliseconds);
            sw.Reset();
            sw.Start();
            test.ListSum();
            sw.Stop();
            Console.WriteLine("List costs {0}", sw.ElapsedMilliseconds);
            sw.Reset();
            sw.Start();
            test.ArraySum();
            sw.Stop();
            Console.WriteLine("Array costs {0}", sw.ElapsedMilliseconds);
        }

        Console.ReadKey();
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T15:22:35.400

人为的问题会给你人为的答案。

**优化应该在编写代码之后而不是之前进行。**以最容易理解和维护的方式编写您的解决方案。然后，如果程序对于您的用例来说不够快，那么您使用[分析工具](https://stackoverflow.com/questions/3927/what-are-some-good-net-profilers)并返回查看实际瓶颈在哪里，而不是您“认为”它在哪里。

人们在您的情况下尝试做的大多数优化都是花费 6 个小时来做​​一些将运行时间减少 1 秒的事情。大多数小程序不会运行足够的时间来抵消您尝试“优化”它所花费的成本。

* * *

话虽如此，这是一个奇怪的边缘案例。我对其进行了一些修改，并通过探查器运行它，但我需要降级我的 VS2010 安装，这样我才能让 .NET 框架源退后一步。

* * *

我使用较大的示例运行了探查器，但找不到需要更长时间的充分理由。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T17:09:04.343

你的问题是你的考验。当您对代码进行基准测试时，您应该始终遵循几个指导原则：

1.  处理器亲和性：仅使用单个处理器，通常不是#1。
2.  热身：总是预先进行少量测试。
3.  持续时间：确保您的测试持续时间至少为 500 毫秒。
4.  平均：对多次运行进行平均以消除异常。
5.  清理：强制 GC 在测试之间收集分配的对象。
6.  冷却：让进程休眠一小段时间。

因此，使用这些指南并重写您的测试，我得到以下结果：

**运行 1**

```
输入测试编号 (1|2): 1
ListSum 平均为 776
ListSum 平均 753
ArraySum 平均 1102
ListSum 平均 753
按任意键继续 。. .

```

**运行 2**

```
输入测试编号 (1|2)：2
ArraySum 平均 1155
ArraySum 平均 1102
ListSum 平均 753
ArraySum 平均 1067
按任意键继续 。. .

```

所以这是最终使用的测试代码：

```
static void Main(string[] args)
{
    //We just need a single-thread for this test.
    Process.GetCurrentProcess().ProcessorAffinity = new IntPtr(2);
    System.Threading.Thread.BeginThreadAffinity();

    Console.Write("Enter test number (1|2): ");
    string input = Console.ReadLine();

    //perform the action just a few times to jit the code.
    ListArrayLoop warmup = new ListArrayLoop(10, 10);
    Console.WriteLine("Performing warmup...");
    Test(warmup.ListSum);
    Test(warmup.ArraySum);
    Console.WriteLine("Warmup complete...");
    Console.WriteLine();

    ListArrayLoop test = new ListArrayLoop(10000, 10000);

    if (input == "1")
    {
        Test(test.ListSum);
        Test(test.ListSum);
        Test(test.ArraySum);
        Test(test.ListSum);
    }
    else
    {
        Test(test.ArraySum);
        Test(test.ArraySum);
        Test(test.ListSum);
        Test(test.ArraySum);
    }
}

private static void Test(Action test)
{
    long totalElapsed = 0;
    for (int counter = 10; counter > 0; counter--)
    {
        try
        {
            var sw = Stopwatch.StartNew();
            test();
            totalElapsed += sw.ElapsedMilliseconds;
        }
        finally { }

        GC.Collect(0, GCCollectionMode.Forced);
        GC.WaitForPendingFinalizers();
        //cooldown
        for (int i = 0; i < 100; i++)
            System.Threading.Thread.Sleep(0);
    }
    Console.WriteLine("{0} averages {1}", test.Method.Name, totalElapsed / 10);
} 
```

*注意：*有些人可能会争论冷却的用处；但是，每个人都同意，即使没有帮助，也无害。我发现在*某些*测试中它可以产生更可靠的结果；然而，在上面的例子中，我怀疑它有什么不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:41:32.977

评论太多了，所以它是 CW - 随意合并，我会删除它。给定的代码对我来说有点偏离，但问题仍然很有趣。如果你混合调用，你会得到更差的性能。此代码突出显示它：

```
static void Main(string[] args)
{
    var input = Console.ReadLine();

        var test = new ListArrayLoop(10000, 1000);

        switch (input)
        {
            case "1":
                Test(test.ListSum);
                break;
            case "2":
                Test(test.ArraySum);
                break;
            case "3":
                // adds about 40 ms
                test.ArraySum();
                Test(test.ListSum);
                break;
            default:
                // adds about 35 ms
                test.ListSum();
                Test(test.ArraySum);
                break;
        }

}

private static void Test(Action toTest)
{
    for (int i = 0; i < 100; i++)
    {
        var sw = Stopwatch.StartNew();
        toTest();
        sw.Stop();
        Console.WriteLine("costs {0}", sw.ElapsedMilliseconds);
        sw.Reset();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T15:37:29.407

[列表在 .NET 中使用数组实现，](https://stackoverflow.com/questions/2540050)因此平均性能应该相同（因为您不更改任何一个的长度）。

看起来您已经充分平均了 sum()s 的时间，这可能是 sum() 方法中使用的迭代器的 GC 问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-26T23:09:04.973

***简短回答***：这是因为[CRL](http://msdn.microsoft.com/en-us/library/8bs2ecf4%28v=vs.100%29.aspx)对调用接口类型的调度方法进行了优化。只要特定接口的方法调用是在同一类型（实现该接口）上进行的，CLR 使用快速调度例程（只有 3 条指令），它只检查实例的实际类型，如果匹配，它直接跳转到特定的预先计算的地址方法。但是，当在另一种类型的实例上进行相同接口的方法调用时，CLR 会将分派切换到较慢的例程（它可以为任何实际实例类型分派方法）。

***长答案***：首先，看一下[System.Linq.Enumerable.Sum()](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.sum.aspx)方法是如何声明的（我省略了源参数的有效性检查，因为在这种情况下它并不重要）：

```
public static int Sum(this IEnumerable<int> source)
{
    int num = 0;
    foreach (int num2 in source)
        num += num2;
    return num;
} 
```

所以所有实现[IEnumerable<int>](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)的类型都可以调用这个扩展方法，包括*int[]*和*List<int>*。关键字[foreach](http://msdn.microsoft.com/en-us/library/ttw7t8t6%28v=vs.100%29.aspx)只是通过*IEnumerable< T >.GetEnumerator()*获取枚举器并遍历所有值的缩写。所以这个方法实际上是这样做的：

```
 public static int Sum(this IEnumerable<int> source)
    {
        int num = 0;
        IEnumerator<int> Enumerator = source.GetEnumerator();
        while(Enumerator.MoveNext())
            num += Enumerator.Current;
        return num;
    } 
```

现在您可以清楚地看到，该方法主体包含对接口类型变量的三个方法调用：*GetEnumerator()*、*MoveNext()*和*Current*（虽然*Current*实际上是属性，而不是方法，从属性中读取值只是调用相应的 getter 方法）。

*GetEnumerator()*通常会创建某个辅助类的新实例，该类实现*IEnumerator< T >*，因此能够一一返回所有值。需要注意的是，在*int[]*和*List< int >的情况下，* *GetEnumerator()* ot 这两个类返回的枚举数类型是不同的。如果参数*source*是*int[]*类型，则*GetEnumerator()*返回*SZGenericArrayEnumerator< int >*类型的实例，如果*source*是*List< int >*类型，则返回*List< int >+Enumerator< int >*类型的实例。

另外两种方法（*MoveNext()*和*Current*）在紧密循环中重复调用，因此它们的速度对于整体性能至关重要。不幸的是，对接口类型变量（例如*IEnumerator< int >*）调用方法并不像普通实例方法调用那样简单。CLR 必须动态找出变量中对象的实际类型，然后找出哪个对象的方法实现了相应的接口方法。

CLR 试图通过一个小技巧来避免**每次调用都**进行这种耗时的查找。当第一次调用特定方法（例如*MoveNext()*）时，CLR 会找到进行此调用的实例的实际类型（例如*SZGenericArrayEnumerator< int >*，如果您在*int[]上调用**Sum*）并找到方法，实现该类型对应的方法（即方法*SZGenericArrayEnumerator< int >.MoveNext()*的地址）。然后它使用此信息生成辅助调度方法，该方法只是检查实际实例类型是否与第一次调用时相同（即*SZGenericArrayEnumerator< int >****) 如果是，则直接跳转到之前找到的方法地址。因此，在后续调用中，只要实例类型保持不变，就不会进行复杂的方法查找。但是当调用不同类型的枚举器时（如*List< int >+Enumerator< int >*计算*List< int >*的总和），CLR 不再使用这种快速调度方法。取而代之的是另一种（通用）和慢得多的调度方法。***

 ****因此，只要*Sum()*仅在数组上调用，CLR 就会使用快速方法调度对*GetEnumerator()*、*MoveNext()*和*Current的调用。*当在列表上也调用*Sum()*时，CLR 切换到较慢的调度方法，因此性能下降。**

如果您关心性能，请为要调用*Sum()*的每种类型实现自己的单独*Sum()*扩展方法。这确保了 CLR 将使用快速调度方法。例如：

 *```
public static class FasterSumExtensions
{
    public static int Sum(this int[] source)
    {
        int num = 0;
        foreach (int num2 in source)
            num += num2;
        return num;
    }

    public static int Sum(this List<int> source)
    {
        int num = 0;
        foreach(int num2 in source)
            num += num2;
        return num;
    }
} 
```

甚至更好的是，完全避免使用*IEnumerable< T >*接口（因为它仍然会带来明显的开销）。例如：

```
public static class EvenFasterSumExtensions
{
    public static int Sum(this int[] source)
    {
        int num = 0;
        for(int i = 0; i < source.Length; i++)
            num += source[i];
        return num;
    }

    public static int Sum(this List<int> source)
    {
        int num = 0;
        for(int i = 0; i < source.Count; i++)
            num += source[i];
        return num;
    }
} 
```

以下是我电脑上的结果：

*   *您的原始程序*：**9844、9841、12545、14384**
*   *FasterSumExtensions*：**6149、6445、754、6145**
*   *EvenFasterSumExtensions*：**1557、1561、553、1574**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-24T15:30:49.783

嗯，它看起来真的很奇怪......我的猜测：您正在使用 var 类型在变量池上调用 .sum() 。只要您只处理一种类型（列表或数组），对 sum() 的调用是明确的并且可以优化。使用新的类 var 是模棱两可的，必须解决，因此进一步的调用将导致性能下降。我没有编译器，所以尝试加载另一个支持 sum() 的类并比较时间。如果我是对的，我会再次期待性能受到影响，但这次不是那么多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-25T12:32:34.363

在我看来，这是缓存（因为预读）。第一次访问数组时，其中的许多元素会同时进入缓存（预读）。这种预取机制预计程序可能会访问请求地址附近的内存。

进一步的调用已经从中受益（假设数组适合缓存）。当您更改方法时，缓存将失效，您需要再次从内存中获取所有内容。

所以调用：list，array，list，array，list，array应该比：list，list，list，array，array，array慢

但从程序员的角度来看，这不是确定性的，因为您不知道缓存的状态或影响缓存决策的其他单元。***

# asp.net-mvc - 如何从 MVC3 中的索引控制器中传递一个值？

> ID：10126463
> 
> 赞同：1
> 
> 时间：2012-04-12T15:12:11.287
> 
> 标签：asp.net-mvc, database, asp.net-mvc-3, linq

我试图从我的索引中传递一个额外的值，并且我已经从返回中传递了一些其他的东西，因为我使用的是 pagedList 方法。我需要将 vm 从索引返回中传递出来，所以它看起来像

```
return View(vm); 
```

目前看起来像这样

```
return View(IAMP.ToPagedList(pageNumber, pageSize)); 
```

我一直在阅读下面链接的这个问题，以更好地了解如何将两个表传递给一个视图，但我无法弄清楚我应该如何使用 pagedList 所需的当前返回值返回“vm”。我还发布了我的控制器、模型和索引的代码，如果需要更多代码以提高清晰度，请告诉我。

[MVC - 将多个数据表传递给视图](https://stackoverflow.com/questions/5488363/mvc-passing-multiple-data-tables-to-a-view)

真正的问题是我需要获得一个版本号以显示在索引中以及位于另一个表中的其他值。我希望我正在尝试做的事情是有意义的。:) 感谢您对所有可以提供帮助的人的支持！

## 控制器

```
namespace DBFirstMVC.Controllers

{
    public class PaController : Controller
    {
        PaEntities db = new PaEntities();

        // Index Method 
        public ViewResult Index(string sortOrder, string currentFilter, string searchString, int? page)
        {
            PageViewModel vm =  new PageViewModel();

            vm.iamp_mapping = from n in db.iamp_mapping select n;
            vm.version_number = from k in db.version_number select k;

            ViewBag.CurrentSort = sortOrder; //ViewBag property provides the view with the current sort order
            ViewBag.NameSortParm = String.IsNullOrEmpty(sortOrder) ? "PA desc" : ""; // Calls the sortOrder switch/case PA desc or default 
            ViewBag.MPSortParm = sortOrder == "MP" ? "MP desc" : "MP asc"; // Calls the sortOrder switch/case MP desc or MP asc
            ViewBag.IASortParm = sortOrder == "IA" ? "IA desc" : "IA asc"; // Calls the sortOrder switch/case IA desc or IA asc
            ViewBag.VersionSortParm = sortOrder == "VERSION" ? "Version desc" : "Version asc"; // Calls the sortOrder switch/case Version desc or Version asc
            ViewBag.IAMP_PKSortParm = sortOrder == "IAMP_PK" ? "IAMP_PK desc" : "IAMP_PK asc"; // Calls the sortOrder switch/case IAMP_PK desc or IAMP_PK asc

            if (Request.HttpMethod == "GET") 
            {
                searchString = currentFilter; //sets the currentFilter equal to Searchstring
            }
            else
            {
                page = 1;                   // defaults to page 1
            }
            ViewBag.CurrentFilter = searchString; // Provides the view with the current filter string

            var IAMP = from p in db.iamp_mapping select p;
            var VIAMP = from x in db.version_number select x;

            if (!String.IsNullOrEmpty(searchString))
            {
                IAMP = IAMP.Where(p => p.PA.ToUpper().Contains(searchString.ToUpper())); //selects only records that contains the search string
            }

            switch (sortOrder) // switch case changes based on desired sort 
            {
                case "Pa desc":
                    IAMP = IAMP.OrderByDescending(p => p.PA);
                    break;
                case "MP desc":
                    IAMP = IAMP.OrderByDescending(p =>p.MAJOR_PROGRAM);
                    break;
                case "MP asc":
                    IAMP = IAMP.OrderBy(p =>p.MAJOR_PROGRAM);
                    break;
                case "IA desc":
                    IAMP = IAMP.OrderByDescending(p => p.INVESTMENT_AREA);
                    break;
                case "IA asc":
                    IAMP = IAMP.OrderBy(p => p.INVESTMENT_AREA);
                    break;
                case "Version asc":
                    VIAMP = VIAMP.OrderBy(x => x.VERSION);

                    break;
                case "Version desc":
                    VIAMP = VIAMP.OrderByDescending(x => x.VERSION);
                    break;
                case "IAMP_PK asc":
                    IAMP = IAMP.OrderBy(p => p.IAMP_PK);
                    break;
                case "IAMP_PK desc":
                    IAMP = IAMP.OrderByDescending(p => p.IAMP_PK);
                    break;
                default:
                    IAMP = IAMP.OrderBy(p => p.PA);
                    break;
            }
            int pageSize = 15; // number of records shown
            int pageNumber = (page ?? 1); // start page number

            return View(IAMP.ToPagedList(pageNumber, pageSize)); // uses pagedList method to return correct page values
        } 
```

## PaDb模型

```
using System;
using System.Collections.Generic;
using System.Linq;
using DBFirstMVC.Models;

namespace DbFirstMVC.Models
{
    public class PageViewModel
    {
        public IQueryable<iamp_mapping> iamp_mapping { get; set; }
        public IQueryable<version_number> version_number { get; set; }

    }

} 
```

## 指数

```
@model DBFirstMVC.Models.iamp_mapping

@{
    ViewBag.Title = "Edit";
}

<h2>Edit</h2>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm()) {

    @Html.ValidationSummary(true)
    <fieldset>
        <legend>iamp_mapping</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.PA)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.PA)
            @Html.ValidationMessageFor(model => model.PA)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.MAJOR_PROGRAM)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.MAJOR_PROGRAM)
            @Html.ValidationMessageFor(model => model.MAJOR_PROGRAM)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.INVESTMENT_AREA)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.INVESTMENT_AREA)
            @Html.ValidationMessageFor(model => model.INVESTMENT_AREA)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.VERSION)
        </div>
        <div class="editor-field">

            @Html.DropDownList("Version", ViewBag.Version as MultiSelectList)
            @Html.ValidationMessageFor(model => model.VERSION)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.IAMP_PK)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.IAMP_PK)
            @Html.ValidationMessageFor(model => model.IAMP_PK)
        </div>

        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
}

<div>
    @Html.ActionLink("Back to List", "")
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:24:25.393

在您的 ViewModel 中公开您需要传递给视图的列表

```
var vm = new MyViewModel();

//do your stuff

vm.MyList1 = IAMP.ToPagedList(pageNumber, pageSize);
vm.MyList2 = VIAMP.ToPagedList(pageNumber, pageSize);
return View(vm); 
```

然后在您看来，您将 foreach 用于每个列表或您需要做的任何事情

```
@model DBFirstMVC.Models.MyViewModel

@foreach(var item in Model.MyList1) {

}

@foreach(var item in Model.MyList2) {

} 
```

# button - 通过PhoneGap禁用jquery移动按钮上的复制

> ID：10126468
> 
> 赞同：2
> 
> 时间：2012-04-12T15:12:23.253
> 
> 标签：button, jquery-mobile, cordova

我正在使用 jQuery Mobile 为 iPhone 开发一个通过 PhoneGap 的应用程序。当我按下（并保持）一个按钮时，我有这个菜单（见下图）：

[http://imageshack.us/photo/my-images/855/imagexj.png/](http://imageshack.us/photo/my-images/855/imagexj.png/)

我怎样才能禁用它？

在此先感谢，DGM.-

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T11:25:07.430

只需添加以下 css 代码即可禁用：

> * {
> 
> -webkit-touch-callout：无；
> 
> -webkit 用户选择：无；
> 
> }

并且只启用你喜欢的东西：

> 输入 {
> 
> -webkit-用户选择：自动；
> 
> }

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:43:35.547

尝试这个：

```
$('#openBtn').click(function(){
    $(this).button('disable');
}); 
```

看起来您还可以将类 ui-disabled 添加到按钮。您也可以简单地将禁用的属性添加到按钮或输入标签。请注意，这不适`<a>`用于使用 data-role="button" 的标签。出于某种原因，它只适用于`<button disabled></button>`和`<input type="text" disabled />`

# java - Java 实时调试（游戏）

> ID：10126472
> 
> 赞同：6
> 
> 时间：2012-04-12T15:12:40.990
> 
> 标签：java, debugging

在此视频中：http://www.youtube.com/watch?v=BES9EKK4Aw4

Notch（我的世界的创造者）正在做他所说的“实时调试”。他实际上是在修改代码并同时玩游戏，而不是每次都重新编译。

有谁知道这叫什么或者我可以在哪里获得有关如何实现这一目标的更多信息？我一直在环顾四周，没有任何成功！

问候， 厄瓦尔德

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-12T15:19:09.377

此功能称为“[热交换](http://en.wikipedia.org/wiki/Hot_swapping#Software)”，某些 JVM 支持此功能。Eclipse IDE 调试器能够在调试 ( `F11`) 模式下热交换您的代码。Eclipse 还可以在您保存修改后的文件后自动构建您的项目（以及在运行调试构建时进行热交换）。Notch 似乎正是在使用这种技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:18:09.537

一些 IDE 正在这样做，例如：eclipse、netbeans、intellij idea 等。

但是有些更改需要重新编译（方法添加或删除等）

他使用的可能是日食。

# ruby-on-rails - RoR link_to 和资产路径

> ID：10126474
> 
> 赞同：0
> 
> 时间：2012-04-12T15:12:47.987
> 
> 标签：ruby-on-rails, ruby-on-rails-3, iis-7, iis-7.5, helicontech

我有一个通过 HeliconZoo 模块在 IIS 7.5 上运行的 RoR (1.9.3 - 3.2) 应用程序。它位于像[http://server/application/这样的子目录中](http://server/application/)

现在，如果我将 link_to 与 <% link_to "/users" %> 之类的直接位置一起使用，它将链接回[http://server/users](http://server/users)而不是[http://server/application/users](http://server/application/users)（同时链接到控制器操作有效美好的）。

此外（这是这里更大的问题）应用程序正在将所有资产预编译到 server/application/public/assets 中，但在渲染时正在 server/public/assets 中搜索它们。如果我设置 config.assets.prefix 资产也会被渲染到不同的位置（“/application/...”作为每次添加），这会导致持续的不同步并且永远不会加载资产。我可以通过将 config.assets.prefix 更改为“/application/public/assets”进行预编译并在之后将其更改回默认值来解决此问题，但这很烦人。

是否有某种配置告诉渲染器在直接链接和资产上添加前缀（“/应用程序”）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T16:08:20.180

我从来没有使用过 IIS 或 HeliconZoo 来部署 Rails，所以这可能行不通，但无论如何我都会尽力回答，因为在我看来，你真正想要做的是让 Rails 理解你'将其重新部署到子文件夹，这并不太难。只需将所有内容封装`routes.rb`在一个范围内，如下所示：

```
scope "/context_root" do
   resources :controller
   resources :another_controller
   match 'welcome/', :to => "welcome#index"
   root :to => "welcome#index"
end 
```

[我直接从这里](https://stackoverflow.com/questions/3181746/what-is-the-replacement-for-actioncontrollerbase-relative-url-root)复制了这个答案，这可能会为您提供更多有用的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T13:19:50.663

请尝试打开 IIS 管理器，导航到“应用程序”文件夹，打开上下文菜单并选择“转换为应用程序”。通常不需要专门修改 Ruby 代码。

# mysql - 从 MySQL 中的 datetime 开始计算月份和年份

> ID：10126486
> 
> 赞同：0
> 
> 时间：2012-04-12T15:13:34.630
> 
> 标签：mysql, sql, database, algorithm

我一直在努力想出一个查询来显示日期时间以显示年份 -> 月份 -> 计数（那一年的月份）。

示例：我想像这样显示我的结果：

```
Year    Mth     #
2012    Apr     595
2012    Mar     27
2011    Oct     1
etc... 
```

我的桌子看起来像这样：

```
create table `log` (
    `datetime` datetime ,
    `username` varchar (75),
    `clientaddr` varchar (225),
    `action` varchar (75),
    `details` varchar (300)
); 
```

我想在日志表中显示所有记录，如上所示。有人有什么建议吗？随意分享一个算法来做同样的事情。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T15:25:48.680

怎么样：

```
select year(datetime) as year, monthname(datetime) as month, count(*) from log group by year, month order by year, month; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:28:04.633

```
SELECT YEAR(`DateTime`) AS Year, MONTH(`DateTime`) as Month, COUNT(*) AS Count
FROM Log
GROUP BY YEAR(`DateTime`), MONTHNAME(`DateTime`)
ORDER BY Year DESC, Month DESC 
```

不建议使用 DateTime 作为列名。

# c++ - 编译简单的类程序时出错

> ID：10126487
> 
> 赞同：1
> 
> 时间：2012-04-12T15:13:34.733
> 
> 标签：c++, class, pointers

编译以下简单的 C++ 类程序时出现错误。

***错误***： **'ptr_code' 未声明（首先使用此函数）**

```
#include<iostream>

using namespace std;

class company
{
  public:

  int code;
  int *ptr_code;

  company(int i)
  {
          ++count;
          code=i ;
          ptr_code = &code; 
  } 

};

int main()
{
company c(10);
company *ptr_c = &c;
cout<<<<"\n";
cout<<"\nCompany codes : \n"<<ptr_c->*ptr_code<<"\n"<<ptr_c->code<<"\n";
system("pause");
return 0;
} 
```

请帮助我，同时变量**ptr_code**被声明为具有公共范围说明符的整数指针，而 **ptr_c->code**工作正常。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:16:55.467

`ptr_c->*ptr_code`应该是`*ptr_c->ptr_code`。`ptr_c->*ptr_code`如果`ptr_code`是指向公司数据成员的类型指针变量，则该变量有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-12T15:18:11.550

更改`ptr_c->*ptr_code`为`*ptr_c->ptr_code`

和

```
cout<<<<"\n"; 
```

到

```
cout<<"\n"; 
```

您`count`在构造函数中使用了一个`company`不属于类的变量，也没有声明它。所以它会给你一个错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:16:19.107

使用`*ptr_c->ptr_code`而不是`ptr_c->*ptr_code`查看[运算符优先级](http://en.cppreference.com/w/cpp/language/operator_precedence)

# sql - 如何改进这个无休止的查询？

> ID：10126489
> 
> 赞同：4
> 
> 时间：2012-04-12T15:13:36.233
> 
> 标签：sql, sql-server, tsql, optimization, query-optimization

我有一张接近 5kk 行的桌子。他们每个人都有一个文本列，我在其中存储我的 XML 日志

我试图找出是否有一些日志

```
<node>value</node> 
```

我试过了

```
SELECT top 1 id_log FROM Table_Log WHERE log_text LIKE '%<node>value</node>%' 
```

但它永远不会结束。

有什么办法可以改善这种搜索吗？

PS：我不能删除任何日志

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-12T15:21:34.957

诸如通配符查询`'%<node>value</node>%'`将导致全表扫描（忽略索引），因为它无法确定在字段中的哪个位置可以找到匹配项。我所知道的改进此查询的唯一真正方法（没有分区表等，如果表不断记录，则应考虑）是向表中添加全文目录和索引，以便在该字段上提供更有效的搜索。

[这](http://blog.sqlauthority.com/2008/09/05/sql-server-creating-full-text-catalog-and-index/)是一个很好的参考，应该可以引导您完成它。完成此操作后，您可以使用针对此类检索优化的 CONTAINS 和 FREETEXT 运算符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:16:14.737

不幸的是，我能看到的唯一优化方法是在该列上实现全文搜索，但即使这样也很难构建到它只返回特定元素中的特定值的位置。

我目前正在做一些工作，我也在其中一列中存储 XML。但我假设对该数据所需的任何查询都需要很长时间，这对我们的需求来说是可以的。

另一个选项与将数据存储在二进制列中有关，然后 SQL Server 具有用于指定在该字段中存储的文档类型的选项。例如，这允许您在该字段上实现更有意义的全文搜索。但是我很难想象这会有效地满足您的要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:43:39.440

除了在该列上实现全文搜索和索引表之外，也许您可​​以通过其他参数（日期等）缩小结果。此外，您可以添加一个名为“Tags”的表字段（varchar 类型），您可以在插入行时填充该字段。该字段将为该日志注册“关键字、标签”。这样，您可以将此字段作为条件更改您的查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T15:17:01.273

您正在使用类似查询。不涉及索引 = 不好 不幸的是，您无法利用目前的资源来加快速度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T15:27:59.677

我认为这无济于事，但请尝试使用[FAST x 查询提示](http://msdn.microsoft.com/en-us/library/ms181714.aspx)，如下所示：

```
SELECT id_log 
FROM Table_Log 
WHERE log_text LIKE '%<node>value</node>%' 
OPTION(FAST 1) 
```

这应该优化查询以返回第一行。

# c# - detailsview > on insert > password 字段应该保存它的 md5 哈希值

> ID：10126493
> 
> 赞同：1
> 
> 时间：2012-04-12T15:13:45.280
> 
> 标签：c#, asp.net, visual-studio-2010, passwords, detailsview

我在 Visual Studio 中的细节视图控制方面遇到问题。

![在此处输入图像描述](../Images/989630b1e98b47332183ac0953835cdd.png)

如您所见，这是一个简单的插入，但在数据库中有一个列名密码盐渍哈希，我打算用它来保存密码的哈希，但是，我希望人们能够在这里输入实际的密码然后让它做一个哈希并保存它。

请告诉我怎么做？我认为这是可能的，但我迷路了。

我尝试了各种方法，比如将字段转换为模板并从那里找出来，但这让我无处可去——或者至少我没有弄清楚。也看了detailsview控件的教程，但是没有用过这样的例子。有办法吗？

谢谢

id' 更喜欢视觉方式，如果存在的话，很简单，因为还有其他类似的情况我需要这个，但如果代码是唯一的方式，我也会采取这种方式 - 使用代码我不确定如何影响插入行为。

# javascript - 使用 Rhino 和 JSR-223 读取 JSON 文件

> ID：10126494
> 
> 赞同：4
> 
> 时间：2012-04-12T15:13:54.613
> 
> 标签：javascript, rhino, jsr223

我正在尝试使用一些 JavaScript 读取 JSON 文件，我正在通过 Java JSR-223 API 使用 Rhino 进行评估。我正在尝试使用 Rhino shell，但不适用于我的 Java 代码中的嵌入式 Javascript。

这是有效的：

```
$ java -jar js.jar
js> readFile('foo.json');
{y:"abc"} 
```

这是不起作用的：

```
ScriptEngineManager factory = new ScriptEngineManager();
ScriptEngine engine = factory.getEngineByName("js");
engine.eval("readFile('foo.json')"); 
```

我收到此错误：

```
Exception in thread "main" javax.script.ScriptException: 
sun.org.mozilla.javascript.internal.EcmaError: ReferenceError: "readFile" is not defined. (<Unknown source>#4) in <Unknown source> at line number 4
    at com.sun.script.javascript.RhinoScriptEngine.eval(RhinoScriptEngine.java:153)
    at javax.script.AbstractScriptEngine.eval(AbstractScriptEngine.java:232) 
```

我怎样才能让`readFile`我的引擎中可用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T18:51:41.727

如果您只是尝试解析[JSON](http://json.org/)，我建议您使用 JSON 解析库，例如[Jackson](http://jackson.codehaus.org/)或[Jettison](http://jettison.codehaus.org/)，这是一种更简单的方法。readFile 调用返回一个字符串，它实际上并没有将内容转换为 JavaScript 对象。为了实现这一点，需要对字符串进行JSON.parse[或*JavaScript eval调用。*](https://stackoverflow.com/questions/1143417/json-data-parsed-or-evaled)

如果你真的需要使用 JavaScript 引擎来解析 JSON 并且你使用的是 Java 7，你可以做这样的事情（但我不建议这样做）......

```
public static void main(final String args[]) throws Exception {
    final ScriptEngineManager factory = new ScriptEngineManager();
    final ScriptEngine engine = factory.getEngineByName("js");
    Object val = null;
    Scanner s = null;
    try {
        s = new Scanner(new File("foo.json"));
        s.useDelimiter("\\Z");
        engine.getBindings(ScriptContext.GLOBAL_SCOPE).put("json", s.next());
    } finally {
        if (s != null) {
            s.close();
        }
    }
    // The default JavaScript engine in Java 6 does not have JSON.parse
    // but eval('(' + json + ')') would work
    val = engine.eval("JSON.parse(json)");

    // The default value is probably a JavaScript internal object and not very useful
    System.out.println(val.getClass() + " = " + val);
    // Java 7 uses Rhino 1.7R3 the objects will implement Map or List where appropriate
    // So in Java 7 we can turn this into something a little more useable
    // This is where Java 6 breaks down, in Java 6 you would have to use the 
    // sun.org.mozilla.javascript.internal classes to get any useful data
    System.out.println(convert(val));
}

@SuppressWarnings("unchecked")
public static Object convert(final Object val) {
    if (val instanceof Map) {
        final Map<String, Object> result = new HashMap<String, Object>();
        for (final Map.Entry<String, Object> entry: ((Map<String, Object>) val).entrySet()) {
            result.put(entry.getKey(), convert(entry.getValue()));
        }
        return result;
    } else if (val instanceof List) {
        final List<Object> result = new ArrayList<Object>();
        for (final Object item: ((List<Object>) val)) {
            result.add(convert(item));
        }
        return result;
    }
    if (val != null) {
        System.out.println(val.getClass() + " = " + val);
    }
    return val;
} 
```

Java 提供的 JavaScript 引擎[排除](http://docs.oracle.com/javase/6/docs/technotes/guides/scripting/programmer_guide/index.html#jsengine)了 Rhino 提供的一些功能。readFile 函数实际上是由[Rhino Shell](https://developer.mozilla.org/en/Rhino_Shell)提供的，而不是引擎实现。Oracle[还提供了](http://docs.oracle.com/javase/6/docs/technotes/tools/share/jsdocs/allclasses-noframe.html)[jrunscript](http://docs.oracle.com/javase/6/docs/technotes/tools/share/jrunscript.html) shell可访问的功能，这些功能不在引擎中。

这是一个模仿 Rhino shell readFile 函数并将其添加到 JavaScript 作用域的示例，基于对以下问题的回答： [如何使用 Rhino 在 Javascript 中将 Java 类中的方法添加为全局函数？](https://stackoverflow.com/questions/2552300/how-can-i-add-methods-from-a-java-class-as-global-functions-in-javascript-using)

```
public static void main(final String args[]) throws Exception {
    final ScriptEngineManager factory = new ScriptEngineManager();
    final ScriptEngine engine = factory.getEngineByName("js");
    engine.getBindings(ScriptContext.GLOBAL_SCOPE).put("utils", new Utils());
    engine.eval("for(var fn in utils) {\r\n" +
            "  if(typeof utils[fn] === 'function') {\r\n" +
            "    this[fn] = (function() {\r\n" +
            "       var method = utils[fn];\r\n" +
            "       return function() {\r\n" +
            "         return method.apply(utils,arguments);\r\n" +
            "       };\r\n" +
            "    })();\r\n" +
            "  }\r\n" +
            "}");
    engine.eval("println(readFile('foo.json'))");
}

static class Utils {
    public String readFile(final String fileName) throws FileNotFoundException {
        return readFile(fileName, null);
    }
    public String readFile(final String fileName, final String encoding) throws FileNotFoundException {
        Scanner s = null;
        try {
            s = new Scanner(new File(fileName), (encoding == null)? Charset.defaultCharset().name(): encoding);
            s.useDelimiter("\\Z");
            return s.next();
        } finally {
            if (s != null) {
                s.close();
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T21:22:53.740

您总是可以利用相关的 Java 类来插入 JSON 文件，然后对其进行修饰，使其适合 eval()。

它可以整齐地在一行中完成。例如给出以下内容：

cfg.json：

```
{     
    myopts: {
        username: "tee",
        password: "password"
    }
} 
```

以及以下 Javascript：

```
cfg = eval('(' + new java.util.Scanner( new java.io.File('cfg.json') ).useDelimiter("\\A").next() + ')'); 
```

您现在可以通过以下方式在 Javascript 中访问您的 JSON：

```
log.info("Username: " + cfg.myopts.username ); // "Username: tee" 
```

# java - 将 xalan java 转换应用于axis2 对象？

> ID：10126495
> 
> 赞同：0
> 
> 时间：2012-04-12T15:13:57.643
> 
> 标签：java, axis2, xalan

我想获得开源 OWL-S API [http://on.cs.unibas.ch/owls-api/](http://on.cs.unibas.ch/owls-api/)以使用axis2。我已经设法正确发送请求，但是在响应方面我无法对其应用转换。为了让我的问题更容易回答，我提供了一些无需导入项目即可运行的独立代码。要设置 DOMSource：

```
String xmlString = "<ns1:countResponse xmlns:ns1=\"http://www.test.de/pill-counter\"><ns1:value>0</ns1:value><ns1:value>0</ns1:value><ns1:value>1</ns1:value><ns1:value>0</ns1:value><ns1:value>0</ns1:value><ns1:value>0</ns1:value></ns1:countResponse>";
    ByteArrayInputStream xmlStream = new ByteArrayInputStream(xmlString.getBytes());
    OMElement test = null;
    try {
        StAXBuilder builder = new StAXOMBuilder(xmlStream);
        test = (OMElement) builder.getDocument().getChildren().next();

    } catch (XMLStreamException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
    OMElement documentElement = null;
      try {
        documentElement = AXIOMUtil.stringToOM(DOOMAbstractFactory.getOMFactory(), xmlString);
    } catch (XMLStreamException e2) {
        // TODO Auto-generated catch block
        e2.printStackTrace();
    }

     SAAJConverterFactory convFactory = (SAAJConverterFactory) FactoryRegistry.getFactory(org.apache.axis2.jaxws.message.factory.SAAJConverterFactory.class);
     SAAJConverter conv = convFactory.getSAAJConverter();

     //Create soap 1.1 message
    SOAPMessage msg = MessageFactory.newInstance().createMessage();
    SOAPPart sp = msg.getSOAPPart();
    SOAPEnvelope se = sp.getEnvelope();
    SOAPBody soapBody = se.getBody();
    javax.xml.soap.SOAPFactory soapFactory = javax.xml.soap.SOAPFactory.newInstance();
    response = conv.toSAAJ(documentElement, soapBody, soapFactory);
    Node root = response; 
```

现在应用转换：

```
Transformer transformer = null;
    try {
        transformer = TransformerFactory.newInstance().newTransformer(new StreamSource(new StringReader("<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:ns1=\"http://www.test.de/pill-counter\">\n\n\t<xsl:template match=\"/\">\n\t\t<xsl:value-of select=\"sum(*/ns1:value)\" />\n\t</xsl:template>\n</xsl:stylesheet>")));
    } catch (TransformerConfigurationException e2) {
        // TODO Auto-generated catch block
        e2.printStackTrace();
    } catch (TransformerFactoryConfigurationError e2) {
        // TODO Auto-generated catch block
        e2.printStackTrace();
    }
    try {
        transformer.transform(new DOMSource(root), new StreamResult(System.out));
    } catch (TransformerException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } 
```

运行此代码的结果是 NullPointerException。

```
SystemId unknown; Line num.0; Column num.0; java.lang.NullPointerException 
```

我曾尝试在 Google、Xalan-j 邮件列表和此站点上寻找解决此问题的方法，但没有成功。我还尝试了其他几种编码方法，但没有运气。任何人的任何想法？

我找到了另一种通过从头开始生成文档来完成这项工作的方法：

```
DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
    dbf.setNamespaceAware(true);
    dbf.setValidating(false);
    DocumentBuilder db = null;
    try {
        db = dbf.newDocumentBuilder();
    } catch (ParserConfigurationException e3) {
        // TODO Auto-generated catch block
        e3.printStackTrace();
    }          
    InputSource is = new InputSource(new StringReader(documentElement.toString()));
    Document document = null;
    try{
        document=db.parse(is);
    } catch (SAXException e3) {
        // TODO Auto-generated catch block
        e3.printStackTrace();
    } catch (IOException e3) {
        // TODO Auto-generated catch block
        e3.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T21:30:23.720

您是否考虑过使用 wsdl2java 来构造存根，而不是直接使用低级 API？这将使您可以轻松地在 java 中操作响应。在这种情况下，使用 xslt 似乎是一种不寻常的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T11:34:28.803

要在 Axiom 树上使用 JAXP API，您无需先将其转换为 SAAJ 或 DOM。Axiom 能够创建一个可以传递给 JAXP 的 SAXSource。一个例子可以在[这里](http://ws.apache.org/axiom/quickstart-samples.html#Schema_validation_using_javax.xml.validation)找到。该示例使用`javax.xml.validation`API，但`javax.xml.transform`它的工作方式相同。

Note that the example uses some APIs introduced in recent Axiom versions, but the feature already exists for quite some time. Depending on the Axiom version you are using, the code needs to be adapted to the older API. In particular, instead of calling `getSAXSource` (which was introduced in 1.2.13), you need to construct an `org.apache.axiom.om.impl.jaxp.OMSource` object and pass that to JAXP.

# javascript - 应用所有变换矩阵

> ID：10126498
> 
> 赞同：5
> 
> 时间：2012-04-12T15:14:00.880
> 
> 标签：javascript, svg, transformation

我正在寻找一种可能快速的方法来应用给定 svg 图形的所有变换矩阵。换句话说：算法应该去掉所有的“变换”属性，将图形的所有坐标变换为绝对坐标。

他们的任何库可以做到这一点，还是他们的任何 SVGDomInterface 方法可以做到这一点？

编辑：：

如果我这样调用 consolidate 方法：

```
$.each( svg.find( 'path' ), function( i ){
        this.transform.baseVal.consolidate();
}); 
```

没有任何反应，如果我这样称呼它：

```
$.each( svg.find( 'path' ), function( i ){
        this.transform.animVal.consolidate();
}); 
```

我收到此错误：

![错误](../Images/858d580abfaea74f51996ba9e1cdae48.png)

那么，我应该如何使用“合并”方法，我应该在哪些元素上调用它？

问候菲利普

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-09T07:24:28.047

这是一个带有一些 javascript 库代码（部分基于 Raphael.js）的 jsFiddle，用于将转换烘焙到所有路径的数据中：

[http://jsfiddle.net/ecmanaut/2Wez8/](http://jsfiddle.net/ecmanaut/2Wez8/)

（不过，不确定这里的 Opera 是怎么回事；它通常在 SVG 上是同类中最好的。我可能在某些方面遇到了其他浏览器更宽容的问题。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-13T09:17:47.050

consolidate 方法仅将矩阵列表简化为单个矩阵。您在 animVal 示例中遇到的错误是因为您不允许修改动画值（合并破坏性地修改了变换列表）。

要回答您的问题，SVG DOM 中没有现有的方法可以通过修改路径的值等来应用变换。Inkscape（以及 Illustrator 也有 IIRC）中有用于应用这样的变换的选项。

如果您正在寻找执行此操作的库或实用程序，您可以尝试[SVG Cleaner](http://libregraphicsworld.org/blog/entry/svg-cleaner-becomes-faster-removes-ms-visio-elements)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-08T00:44:02.373

SVG Cleaner 似乎没有为我应用所有转换，但 Inkscape 可以。这是我需要应用时使用的命令行：

```
inkscape copy-of-file.svg --select=id-of-node \
         --verb=EditCut --verb=EditPaste \
         --verb=FileSave --verb=FileClose 
```

假设您在inkscape 的首选项中将“转换-> 存储转换”设置为“优化”（我相信默认情况下它是打开的），这将应用它并产生想要的结果。确保您对输入文件的副本进行操作，因为该操作会替换您的原始文件！

如果您在 Mac 上运行它，您可能希望首先在您的 shell 中执行此操作：

```
alias inkscape=/Applications/Inkscape.app/Contents/Resources/bin/inkscape 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T01:07:52.350

最好使用*EditPasteInPlace*而不是*EditPaste*。*EditPaste*粘贴在鼠标位置，不是节点的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-07T08:06:05.330

为了检索相对于其他一些父 DOM 节点（例如 SVG 根容器）的路径，您可以在此处使用该技术。

它使用 SVG.getTransformToElement 计算父节点和 SVG 树上某个节点之间的转换。返回的对象包含返回变换的逆的方法等，用它做实际的事情。

[缩放和旋转后如何确定 Raphael 对象的大小？](https://stackoverflow.com/questions/13046811/how-to-determine-size-of-raphael-object-after-scaling-rotating-it/13111598#13111598)

我不确切知道您要达到的目标，但这有能力做到这一点。

# javascript - 来自 h2 的数据导入到 img 标题属性

> ID：10126501
> 
> 赞同：0
> 
> 时间：2012-04-12T15:14:09.993
> 
> 标签：javascript, jquery, dom

我需要使用来自 H2 元素的数据并将其插入页面上图像的标题属性中。我一直在尝试使用 jQuery 数据函数，但它失败了。知道解决这个问题的更好方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:15:26.980

这很简单：

```
$(function () {
  $("img#toId").attr("title", $("h2#fromId").data("something"));
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:16:35.473

如果数据是指 h2 的内容，那么应该这样做

```
$(function () {
  $("img").attr("title", $("h2").text());
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:16:24.517

来自h2的什么数据？标签内的文字？该`.text`方法将为您提供标签的内容，您可以使用该`.attr`方法在图像上设置标题。

`$("#myimage").attr("title", $("#myh2").text());`

如果它是h2上的实际数据属性，那么您可以使用该`.data`方法将其拉出。假设一个 h2 喜欢：`<h2 id="myh2" data-mydata="foobar">Hey you guys!</h2>`你可以这样做：

`$("#myimage").attr('title', $("#myh2").data('mydata'));`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T15:18:54.143

如果你想要 jquery 数据，而不是 h2 的文本，你可以这样做：

html:

```
<h2 data-imgTitle="Image Title">Header Content</h2> 
```

javascript:

```
$(function () {
  $("img").attr("title", $("h2").data("imgTitle"));
}); 
```

# asp.net - 一个奇怪的涉及 IIS 和 ASP.Net 的 Windows 身份验证

> ID：10126503
> 
> 赞同：0
> 
> 时间：2012-04-12T15:14:17.447
> 
> 标签：asp.net, internet-explorer-8, iis-7.5, windows-authentication

我们有一个在一对托管服务器上运行的 ASP.net 应用程序。对应用程序的访问由使用集成 Windows 安全性的 IIS 控制。ASP 代码文件位于一个 iis 站点中，而静态内容由另一个站点提供。这些文件位于 UNC 共享上`\\10.x.x.1\mySites`，可供运行 IE8 和 9 的用户访问。

在过去两周左右，应用程序用户发现很难访问该站点。现在，当他们请求 URI 时，他们会看到标准登录框，该登录框在每次尝试获取访问权限后都会重新出现。经过六次尝试后，该过程以“401 Not Authorized”错误结束。

这很奇怪，但是在让我们的一位网络人员查看之后，结果发现用户在 IIS 密码提示中键入的凭据没有被传输到 IIS，而是它的凭据（Windows 登录 ID 和密码）的当前用户是。

任何人都可以阐明正在发生的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T14:01:32.580

我认为 IIS 单独保存用户帐户凭据，以便它可以处理匿名访问。如果这与匿名帐户的相应系统凭据不同步，则可能会发生这种事情。戳一下，我认为有一种方法可以重置 IIS。

# regex - 如果给定的字符串包含给定的子字符串，那么惯用的 scala 查找方式是什么？

> ID：10126504
> 
> 赞同：67
> 
> 时间：2012-04-12T15:14:22.597
> 
> 标签：regex, string, scala, substring, contains

我在 scala 中有两个字符串，我想知道较大的字符串 ( `needle`) 是否包含较小的字符串 ( `haystack`)。

我发现是用这样的正则表达式和匹配来做的（[来自这个问题](https://stackoverflow.com/questions/3021813/how-to-check-whether-a-string-fully-matches-a-regex-in-scala)）：

`needle.r.pattern.matcher(haystack).matches`

对于这样一个简单的问题，这（1）过于复杂，但更重要的是，（2）对我不起作用，因为

`"needle".r.pattern.matcher("Finding needle in haystack").matches`

返回

`Boolean = false`

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2012-04-12T15:23:35.790

如果您想以最高效率执行此操作，您可能必须自己编写（或在某处找到一个好的子字符串搜索算法）。如果你只是想让它工作，那么在 Scala 中：

```
scala> "Finding needle in haystack" contains "needle"
res0: Boolean = true

scala> "Finding needle in haystack" indexOf "needle"
res1: Int = 8 
```

这些*不是*正则表达式搜索。您也没有正确使用正则表达式匹配（编辑：因为该代码要求与整个字符串完全匹配，而不是查找匹配的子字符串），但这是一个不同的问题。如果要计算匹配数，可以执行以下操作

```
scala> "needle".r.findAllIn("Finding needle in haystack").length
res2: Int = 1 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-04-12T16:07:12.763

虽然回答了我想我也会提供这种正则表达式风格

```
scala> "I have a needle in my haystack" matches ".*needle.*"
res10: Boolean = true 
```

# r - 从另一个函数内部调用 mlogit()，使用附加时变量的范围问题

> ID：10126505
> 
> 赞同：1
> 
> 时间：2012-04-12T15:14:23.597
> 
> 标签：r, scoping, mlogit

我需要从另一个函数内部调用[mlogit() R](http://cran.r-project.org/web/packages/mlogit/index.html)函数。

这是一个用于演示目的的函数：

```
#-------------------------
# DEMO FUNCTION
#-------------------------
# f = formula (string)
# fData = data.frame
# cVar = choice variable (string)
# optVar = alternative variable (string)
##########################
mlogitSum <- function(f, fData,  cVar="choice", optVar="option"){
  library(mlogit)
  r2 <- mlogit(as.formula(f), shape = "long", data = fData, alt.var=optVar, choice = cVar)
  return(summary(r2))
} 
```

显然存在环境问题，因此 mlogit() 函数找不到未全局声明的变量作为参数。

此示例不起作用：

```
mydata <- read.csv(url("http://www.ats.ucla.edu/stat/r/dae/mlogit.csv"))
attach(mydata)
library(mlogit)
mydata$brand<-as.factor(mydata$brand)
mlData<-mlogit.data(mydata, varying=NULL, choice="brand", shape="wide")

myFormula <-"brand~1|female+age"
var1 <- "brand"
var2 <- "alt"
mlogitSum(myFormula, fData = mlData, var1, var2) 
```

如果在主环境中分配变量，则它可以工作：

```
mydata <- read.csv(url("http://www.ats.ucla.edu/stat/r/dae/mlogit.csv"))
attach(mydata)
library(mlogit)
mydata$brand<-as.factor(mydata$brand)
fData<-mlogit.data(mydata, varying=NULL, choice="brand", shape="wide")

myFormula <-"brand~1|female+age"
cVar <- "brand"
optVar <- "alt"
mlogitSum(myFormula, fData, cVar, optVar) 
```

或者，如果我从函数内部全局分配变量，它也可以工作

```
#-------------------------
# DEMO FUNCTION
#-------------------------
# f = formula (string)
# fData = data.frame
# cVar = choice variable (string)
# optVar = alternative variable (string)
##########################
mlogitSum_rev <- function(f, fData,  cVar="choice", optVar="option"){
  fData<<-fData
  cVar<<-cVar
  optVar<<-optVar
  #return(head(lcmData))
  library(mlogit)
  #mi serve per poi estrarre model.matrix(r2), per il resto sarebbe ridondante
  r2 <- mlogit(as.formula(f), shape = "long", data = fData, alt.var=optVar, choice = cVar)
  return(summary(r2))
}

mydata <- read.csv(url("http://www.ats.ucla.edu/stat/r/dae/mlogit.csv"))
attach(mydata)
library(mlogit)
mydata$brand<-as.factor(mydata$brand)
mlData<-mlogit.data(mydata, varying=NULL, choice="brand", shape="wide")

myFormula <-"brand~1|female+age"
var1 <- "brand"
var2 <- "alt"
mlogitSum_rev(myFormula, mlData, var1, var2) 
```

关于如何避免全局分配变量的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T16:09:29.700

**tl;博士**这似乎是一个错误`mlogit`，您可以自己修复（见下文）或要求维护者修复。

在内部`mlogit`，该函数尝试按如下方式评估数据：

```
nframe <- length(sys.calls()) ## line 11
... 
data <- eval(mldata, sys.frame(which = nframe))  ## line 44 
```

这是对 R 的作用域结构的适度复杂的混乱——它试图*在当前帧之上的*`mldata`第一帧中进行评估，如果有人做了一些棘手的事情（但完全合理！），比如从函数中调用，它将失败。*`mlogit`*

 *我通过运行解决了问题（有点！）`fix(mlogit)`，这会将您转储到编辑器中并允许您修改功能。我将第 44 行更改为

```
data <- eval(mldata, parent.frame()) 
```

之后代码似乎起作用了。

如果这对您有用，您可以 (1)`fix()`每次需要使用它时使用 mlogit：(2) 下载源 ( `.tar.gz`) 包的副本，修改并安装它；或（3）[最好！]联系包维护者，让他们知道这个问题，并要求他们发布一个补丁版本......

PS 根据您的一般数据分析协议，您可能希望摆脱使用的习惯`attach`：[为什么不建议在 R 中使用 attach()，我应该改用什么？](https://stackoverflow.com/questions/10067680/r-why-is-it-not-advisable-to-use-attach)*

# windows - Windows批处理文件，将wget下载的文件内容保存到变量

> ID：10126506
> 
> 赞同：0
> 
> 时间：2012-04-12T15:14:29.150
> 
> 标签：windows, batch-file, wget

目前，我有一个批处理文件，它使用 wget 从服务器读取文件。wget 有没有办法将该文件的内容保存到变量中，然后批处理文件根据变量的值采取某种操作？

peseduo-code 可能看起来像这样。我对批处理文件非常陌生，并且仍在学习语义：

```
SAVE RESULT OF wget http://www.theserver.com/instruction TO VARIABLE: the_variable
IF %the_variable% == 'restart' <DO SOME ACTION HERE> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T20:03:20.047

我将根据您下载的文件包含文本字符串的假设来回答这个问题。
如果是这种情况，那么可以以这种方式使用 FOR 命令：

```
for /F %I IN (instruction.txt) DO if %I==restart @echo RESTART FOUND 
```

此命令打开文件“instruction.txt”并对其进行解析，将每个单词分配给变量 %I 然后对于变量 %I 的每个值，执行关键字 DO 之后指定的命令。
在这种情况下，我将变量 %I 与字符串“restart”进行了比较，如果结果为真，则批处理执行命令 @echo RESTART FOUND

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:23:49.140

您可以在批处理文件中使用 GOTO: 函数。因此，如果变量等于某个值/字符串，它会跳转到批处理文件中的特定部分并执行该部分中的代码。

几乎就像在面向对象编程中使用方法一样。

检查此链接：-

[http://www.robvanderwoude.com/goto.php](http://www.robvanderwoude.com/goto.php)

# jquery - Sublime 视频播放器无法在 IE9 中调整大小

> ID：10126507
> 
> 赞同：0
> 
> 时间：2012-04-12T15:14:29.460
> 
> 标签：jquery, css, html, video, html5-video

所以我使用这个托管的 js 来运行我的视频：[http ://sublimevideo.net/](http://sublimevideo.net/)

在这里的第一张幻灯片上：www.xsp.com/indexvideo.php

该链接应该显示具有容器的隐藏 div。当您单击视频时，它应该填充页眉和页脚之间的空间。它确实如此。当您调整浏览器窗口的大小时，也应该调整视频的大小。适用于 IE 7 + 8、Firefox 和 Safari。但不是 IE 9。

有人有什么想法吗？

调整代码大小以遵循：

```
 $(window).resize(function() {
        proportion_index();
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(letsDoThis, 0);
    });

    function letsDoThis() {
        resize_object();
    };

    function resize_object() {
        var viewportwidth;
        var viewportheight;

        // the more standards compliant browsers (mozilla/netscape/opera/IE7) use window.innerWidth and window.innerHeight
        if (typeof window.innerWidth != 'undefined') {
            viewportwidth = window.innerWidth;
            viewportheight = window.innerHeight;
        }

        // IE6 in standards compliant mode (i.e. with a valid doctype as the first line in the document)
        else if (typeof document.documentElement != 'undefined' && typeof document.documentElement.clientWidth !='undefined' && document.documentElement.clientWidth != 0) {
            viewportwidth = document.documentElement.clientWidth;
            viewportheight = document.documentElement.clientHeight;
        }

        // older versions of IE
        else {
            viewportwidth = document.getElementsByTagName('body')[0].clientWidth;
            viewportheight = document.getElementsByTagName('body')[0].clientHeight;
        }

        //SET THE VIEWPORT TO BROWSER WIDTH AND BROWSER HEIGHT MINUS THE HEADER AND FOOTER SPACE
        if(viewportheight > 650) {
            viewportheight = viewportheight - 242;
        } else if(viewportheight <= 650) {
            viewportheight = viewportheight - 90;
        }

        $('#slide1video').css('width',viewportwidth);
        $('#slide1video').css('height',viewportheight);
        $('#slide1video').css('z-index','1001');
        $('#slide1video').css('background','#000000');

        $('#sublime_video_wrapper_0').css('width',viewportwidth);
        $('#sublime_video_wrapper_0').css('height',viewportheight);
        $('#sublime_video_wrapper_0').css('z-index','1002');
        $('#slide1video').css('background','#000000');

        $('span.sv_play_button').css('width',viewportwidth);
        $('span.sv_play_button').css('height',viewportheight);
        $('span.sv_play_button').css('background','blue');
        $('span.sv_play_button').css('z-index','1003');

        $('.sublime_video_content').css('width',viewportwidth);
        $('.sublime_video_content').css('height',viewportheight);
        $('.sublime_video_content').css('background','#000000');

        $('video.sublimed').attr('width',viewportwidth);
        $('video.sublimed').attr('height',viewportheight);
        $('video.sublimed').css('width',viewportwidth);
        $('video.sublimed').css('height',viewportheight);
        $('video.sublimed').css('max-width',viewportwidth);
        $('video.sublimed').css('max-height',viewportheight);
        $('video.sublimed').css('left','0');
        $('video.sv_html5_fullscreen').css('left','0');
        $('video.sublimed').css('z-index','1000');

        $('.sv_controls').css('width',viewportwidth);
        $('.sv_progress_back').css('width',viewportwidth - 89);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T16:41:41.703

您应该尝试使用 SublimeVideo 调整大小的方法，而不是手动进行。在此处查找演示：[http](http://test.sublimevideo.net/resize) ://test.sublimevideo.net/resize以及有关我们文档中调整大小方法的更多信息：http: [//docs.sublimevideo.net/javascript-api/methods#resize](http://docs.sublimevideo.net/javascript-api/methods#resize)

不要犹豫，在我们的社区论坛中提出任何问题。

# screen - NVDA 屏幕阅读器问题

> ID：10126512
> 
> 赞同：1
> 
> 时间：2012-04-12T15:14:50.757
> 
> 标签：screen

我正在使用 NVDA 屏幕阅读器。它碰巧只是阅读了我的窗口的标题，没有别的。说全部开启。它只是对其他所有内容都说“未知”。其他人有同样的问题吗？是否有一些设置必须更改？或者它是一个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:42:35.823

我终于找到了答案...

仅当我从 Visual Studio 中运行程序（调试）时才会发生这种情况。当我启动 .exe 本身时，它工作正常。

# c++ - 当我尝试创建对象数组时出错

> ID：10126514
> 
> 赞同：2
> 
> 时间：2012-04-12T15:15:03.223
> 
> 标签：c++, arrays, class, pointers

我有点困惑，对我来说，我认为以下两个实现是有效的（但我的语法有错误），但我无法让其中任何一个工作。这是一年级的C++入门课作业，我们不能用Vector（不然很久以前就做完了……）

我已经完成了我的课程`Student`，但现在我必须创建一个容器来存储 n 个学生。我在想以下两个选项。

1）创建一个学生对象数组：`Student arrayOfStudents[20];`

我的学生课很简单（因为行太多所以修改不同）。但想法是这样的......

```
class Student
{
    public:
    // Constructor for the Book class, take 6 arguments 
    Student(string myUID, string myLastName, string myFirstName, 
         string major, string age, string homeState, bool isWorking);
    ...
}; 
```

但是当我尝试创建一个学生数组时，我收到了这个错误消息。

```
cs114p2main.cpp: In function ‘int main(int, char**)’:
cs114p2main.cpp:103: error: no matching function for call to ‘Student::Student()’
cs114p2Student.h:14: note: candidates are: Student::Student(std::string*)
cs114p2Student.h:11: note:                 Student::Student(std::string, std::string, std::string, std::string, std::string, bool)
cs114p2Student.h:7: note:                 Student::Student(const Student&) 
```

2）还尝试过：创建一个指向每个学生的学生指针数组。 `Student* ArrayOfStudents = Student[20];`

我的问题是为什么方法1不起作用？在这种情况下我是否必须使用指针（类似于方法 2）。

因为我需要将这个数组传递给一个设置每个学生的函数。（我不知道会有多少学生在那里）。那么这是否意味着我必须将指针传递给学生数组？在那种情况下，我真的希望方法 1 可以工作，我无法想象处理指向学生指针数组的指针。我在想必须返回一个数组`data[numOfData][numOfStudnet]`，并主要执行此操作，但无论哪种方式，我都想弄清楚为什么这会给我带来错误..谢谢。

**编辑：后续问题**：我通过研究知道，我必须将数组的大小声明`Student`为参数，但是如果我只知道它运行后的大小怎么办？在这种情况下，我有什么选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:19:17.797

你的`Student`类只有一个构造函数，即

```
Student(string myUID, string myLastName, string myFirstName,  
     string major, string age, string homeState, bool isWorking); 
```

因此，编译器不会生成默认构造函数。由于您也没有提供一个（默认 ctor：一个不带参数的可调用函数），因此编译器无法创建数组——它需要将默认可构造对象放置在元素中（使用初始化数组）。

要修复，您需要提供一个默认 ctor：

```
Student(); 
```

您需要根据`Student`假定的行为方式找出自己的行为。

您还可以为列出的`Student`ctor 的所有参数提供默认参数，因此无需显式指定任何参数即可调用它——因此有资格作为默认 ctor

如果默认 ctor 不可行，您将需要变得更有创意并动态分配数组，将所有现有元素复制到新元素，并在需要时将给定的新元素分配给它。请注意，您实际上是在重新创建`std::vector`容器的功能。另请注意，这种方法真的很难做到正确，所以我建议不要这样做，特别是因为你只是在学习基础知识。

另一种方法是创建一个指向 的指针数组`Student`，因此您可以在动态创建它们时分配每个指针。`Student`在尝试访问指向的对象之前，您必须测试该元素是否为空指针。

```
Student* students[20];

students[0] = new Student(/*list of actual parameter values*/);

if (student[0] != NULL) {
  students[0]->getName(); // assuming you have a member function getName()
} 
```

注意：索引 0 仅用于说明目的，您也可以使用变量（只要确保它保持在 0 和 19（包括）之间）- 请注意，即使您有 20 个元素，最大索引也是 19计数从 0 开始

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:19:36.627

> 我的问题是为什么方法1不起作用？

因为`Student`没有默认构造函数（没有参数的构造函数）。仅当未定义构造函数时，编译器才会生成默认构造函数。由于已经定义了构造函数，它至少接受一个参数，因此不存在默认构造函数。声明数组时：

```
Student arrayOfStudents[20]; 
```

`Student`正在使用不存在的默认构造函数创建20 个实例。

`Student`您可以定义一个允许使用数组的默认构造函数，但是没有名称、年龄等存在是否有意义？

或者，使用以下数组`Student*`：

```
Student* arrayOfStudents[20] = {}; // The '{}' will set all pointers to NULL. 
```

编辑：

如果直到运行时才知道学生人数，那么：

```
// Get number of students somehow.
int numberOfStudents = ...;

// The '()' will set all pointers to NULL.
Student** arrayOfStudents = new Student*[numberOfStudents](); 
```

记住每个`delete`条目`arrayOfStudents`和自身。`delete[]``arrayOfStudents`

# ruby-on-rails - 在 Rails 控制台中访问会话变量

> ID：10126516
> 
> 赞同：2
> 
> 时间：2012-04-12T15:15:07.893
> 
> 标签：ruby-on-rails, session

有没有办法在 rails 控制台中访问给定会话的会话对象/会话变量（由`_foundation_session`cookie 的值标识）？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-12T16:07:21.943

一个可能的解决方案是使用 ruby​​-debug：

[http://railscasts.com/episodes/54-debugging-with-ruby-debug](http://railscasts.com/episodes/54-debugging-with-ruby-debug)

# c++ - 在 VC++ 中，类型转换并将 void 指针变量分配给 Integer 变量。

> ID：10126518
> 
> 赞同：0
> 
> 时间：2012-04-12T15:15:11.023
> 
> 标签：c++, visual-c++, type-conversion, void-pointers

我有一个 C++ 函数：

```
void Func(void* param)
{
   int a;
   a= (int*)param;
} 
```

我想我做了什么**a= (int*)param;** 是正确的。但不知道为什么我收到编译错误“无法从 int* 转换为 int.

任何人都可以在这方面帮助我。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:16:45.497

因为`a`是一个`int`而不是一个`int*`。你的意思：

```
int a;
a = *((int*)param); 
```

反而？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:17:51.460

转换`param`为后`(int*)`，您需要**取消引用**它以将其用作变量：

```
int a;
int* intParamPtr = (int*)param;
a = *intParamPtr; // * is dereference operator 
```

# .net - 如何从 IList 类型的属性中检索 RavenDb 中的不同值 ?

> ID：10126521
> 
> 赞同：1
> 
> 时间：2012-04-12T15:15:18.560
> 
> 标签：.net, list, distinct, ravendb

我在 RavenDb 中存储了以下类：

```
public class User
{
  public string Id {get;set;}
  public string Name {get;set;}
  public IList<string> Phrases {get;set;} 
} 
```

我想要所有用户的所有不同短语。

**解决方案 1（未测试）**

```
session.Query<User>().SelectMany(c=>c.Educations).Distinct(); 
```

你认为这种方法会有性能问题吗？

**解决方案 2（经过测试）** 通过 google，我发现 session.Advanced.DatabaseCommands.GetTerms() 可以很好地获取属性的不同值。但在这里我有一个 List 属性。根据这个：

*   我创建了一个基于 CharTokenizer 的自定义 Tokenizer，以根据特定的字符 (|) 拆分值；
*   我创建了一个类似于 WhiteSpaceAnalyzer 的自定义分析器；
*   我在 Map 中使用“phrases = string.join("|", Phrases)”创建一个索引，指定我的自定义分析器；
*   我使用 session.Advanced.DatabaseCommands.GetTerms(myindexname, phrases, null, int.maxvalue)。

在您看来，哪种方法更好？其他更好/更简单的解决方案？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T16:51:50.073

如果您编写索引如下所示：

```
from user in docs.Users
from phrase in user.Phrases
select new { phrase } 
```

然后`session.Advanced.DatabaseCommands.GetTerms()`将起作用，因此您可以使用**解决方案 2**而不会增加所有复杂性。

我*认为* **解决方案 2**将是最有效的，因为它直接从 Lucene 索引中获取术语，但您必须对其进行基准测试才能确定。

# ios - monotouch中的计时器动画

> ID：10126522
> 
> 赞同：1
> 
> 时间：2012-04-12T15:15:18.607
> 
> 标签：ios, xamarin.ios, core-animation

我注意到有很多应用程序在屏幕上显示不同的计时器，并且几乎所有应用程序都在切换秒和分钟时使用漂亮的动画（类似于从顶部翻转新数字的页面）。是否有或多或少的标准方法将动画应用于我的计时器？是否有任何示例显示如何以漂亮的方式为计时器设置动画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T20:10:57.240

这是该项目的解决方案： [http ://code.google.com/p/jquery-countdown/](http://code.google.com/p/jquery-countdown/)

jquery 代码是不言自明的。将它移植到 monotouch 花了不到 40 分钟。

# sphinx - 在 PHP 中构建二元组和三元组以在 Sphinx 中进行拼写检查

> ID：10126527
> 
> 赞同：1
> 
> 时间：2012-04-12T15:15:33.640
> 
> 标签：sphinx, spell-checking

我正在尝试使用 Sphinx 准备自动完成并进行更正，并找到了这篇文章：[http](http://www.ivinco.com/blog/sphinx-in-action-did-you-mean/) ://www.ivinco.com/blog/sphinx-in-action-did-you-mean/ ，这是非常有帮助但不太容易理解的.

我的问题是：

1.  如何从我的狮身人面像索引中已有的关键字构建这个二元组和三元组？
2.  如何准备对 Sphinx 守护程序的查询，而不是像示例文章中的 SphinxSE。

有没有人用 Sphinx 做过这样的拼写“你的意思是……”项目吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T13:00:02.277

应该查看下载中的 misc/suggest/ 文件夹。

也可以在这里查看[http://sphinxsearch.googlecode.com/svn/trunk/misc/suggest/](http://sphinxsearch.googlecode.com/svn/trunk/misc/suggest/)

# model-view-controller - 将使用 Json.net 库序列化的数据传递给 View 并使用敲除绑定它

> ID：10126528
> 
> 赞同：1
> 
> 时间：2012-04-12T15:15:33.920
> 
> 标签：model-view-controller, knockout.js, json.net

我正在尝试将一些序列化数据发送到视图并将其绑定到敲除代码。我正在使用 json.net 库进行序列化，因为我想将枚举的常量传递给视图（而不是底层整数。）我不确定我的控制器返回 Json 数据应该是什么样子。这是示例代码：

我将被序列化的视图模型：

```
public class FranchiseInfoViewModel
    {

        public string FolderName { get; set; }

        [JsonConverter(typeof(StringEnumConverter))]
        public LobbyTemplateOptions LobbyTemplate { get; set; }

        public List<LobbyTemplateOptions> LobbyTemplates { get; set; }

        public void Initialize()
        {
            FolderName = "Test";

            LobbyTemplate = LobbyTemplateOptions.G;
            LobbyTemplates = new List<LobbyTemplateOptions>
                                 {
                                     LobbyTemplateOptions.G,
                                     LobbyTemplateOptions.H,
                                     LobbyTemplateOptions.I
                                 }; 
```

枚举：

```
[JsonConverter(typeof(StringEnumConverter))]
    public enum LobbyTemplateOptions
    {
        G = 7,
        H = 8,
        I = 9
    } 
```

我的淘汰码：

```
$(function () {
    omega.FranchiseInfo = (function () {
        var FolderName = ko.observable();
        var LobbyTemplates = ko.observableArray([]);

        $.getJSON("FranchiseData", function (data) {
            FolderName(data.FolderName);

            for (var i = 0; i < data.LobbyTemplate.length; i++) {
               LobbyTemplates.push(data.LobbyTemplate[i]);
            }
        });

        return {
            folderName: FolderName,

            lobbyTemplates: LobbyTemplates
        }
    } ());
    ko.applyBindings(omega.FranchiseInfo);
})

        } 
```

我想知道将序列化的 Json 数据传递给视图的控制器应该是什么样子，因为我没有使用过 json.net，而且我对编程比较陌生：

控制器将 Json 数据传递给视图：

```
 public JsonResult FranchiseData()
            {
                FranchiseInfoViewModel franchiseInfoViewModel = new FranchiseInfoViewModel();
                franchiseInfoViewModel.MapFranchiseInfoToFranchiseInfoViewModel();
                string json = JsonConvert.SerializeObject(franchiseInfoViewModel);

                // this is how I do it with the default Json serializer
               // return Json(franchiseInfoViewModel, JsonRequestBehavior.AllowGet);
            } 
```

如果有人可以发布我的控制器的工作示例，我将不胜感激。谢谢你！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-12T23:38:31.330

您需要实现 JsonNetResult。

```
public class JsonNetResult : ActionResult
{
  public Encoding ContentEncoding { get; set; }
  public string ContentType { get; set; }
  public object Data { get; set; }

  public JsonSerializerSettings SerializerSettings { get; set; }
  public Formatting Formatting { get; set; }

  public JsonNetResult()
  {
    SerializerSettings = new JsonSerializerSettings();
  }

  public override void ExecuteResult(ControllerContext context)
  {
    if (context == null)
      throw new ArgumentNullException("context");

    HttpResponseBase response = context.HttpContext.Response;

    response.ContentType = !string.IsNullOrEmpty(ContentType)
      ? ContentType
      : "application/json";

    if (ContentEncoding != null)
      response.ContentEncoding = ContentEncoding;

    if (Data != null)
    {
      JsonTextWriter writer = new JsonTextWriter(response.Output) { Formatting = Formatting };

      JsonSerializer serializer = JsonSerializer.Create(SerializerSettings);
      serializer.Serialize(writer, Data);

      writer.Flush();
    }
  }
} 
```

要使用它，在您的情况下，您需要以这种方式重写控制器方法：

```
public ActionResult FranchiseData()
{
    FranchiseInfoViewModel franchiseInfoViewModel = new FranchiseInfoViewModel();
    franchiseInfoViewModel.MapFranchiseInfoToFranchiseInfoViewModel();

    JsonNetResult jsonNetResult = new JsonNetResult();
    jsonNetResult.Formatting = Formatting.Indented;
    jsonNetResult.Data = franchiseInfoViewModel;

    return jsonNetResult;
} 
```

（上面 JsonNetResult 的实现取自这篇博文 [http://james.newtonking.com/archive/2008/10/16/asp-net-mvc-and-json-net.aspx](http://james.newtonking.com/archive/2008/10/16/asp-net-mvc-and-json-net.aspx)）

# c++ - SWIG 和 C++ 共享库

> ID：10126531
> 
> 赞同：15
> 
> 时间：2012-04-12T15:15:39.917
> 
> 标签：c++, python, linker, g++, swig

我有一个 C++ 库（我们称之为`mylib`），它编译成`libmylib.so`文件，我在一个名为in`/usr/local/lib`的目录中有一堆头文件。`my lib``/usr/local/include`

现在我想做的事情（对于初学者）只是使用 SWIG 的一个头文件（它包含有关我的库提供的类的信息）来生成`mylib_wrap.cxx`文件，然后编译它并将其链接到现有的`mylib.so`. 这样我就可以在 Python 中实例化我的类。

这是正确的方法/想法吗？编译和链接命令会是什么样子（当然不完全是）？我正在尝试生成 Python 绑定。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-12T15:28:52.797

我为你整理了一个完整的例子：

## 头文件：

(mylib.h)

```
class Foo {
};

void bar(const Foo&); 
```

## 执行：

```
#include "mylib.h"
#include <iostream>

void bar(const Foo& f) {
  std::cout << &f << std::endl;
} 
```

## 编译库：

```
g++ -fPIC -Wall -Wextra -shared mylib.cc -o libmylib.so

```

## 用于包装库的 SWIG 接口：

```
%module mylib

// Make mylib_wrap.cxx include this header:
%{
#include "mylib.h"
%}

// Make SWIG look into this header:
%include "mylib.h" 
```

## 编译 Python 模块：

```
痛饮 -Wall -c++ -python mylib.i  
g++ -fPIC -Wall -Wextra -shared mylib_wrap.cxx -o _mylib.so -L。-lmylib -I/usr/include/python2.7/ -lpython2.7

```

请注意，我们将 Python 模块与库链接。如果它不在当前目录中，则需要指定库路径。SWIG 期望 Python 模块的本机部分被称为 _module.so

## 跑

```
LD_LIBRARY_PATH=。Python                                                 
Python 2.7.2+（默认，2011 年 11 月 30 日，19:22:03）
[GCC 4.6.2] 在 linux2 上
输入“帮助”、“版权”、“信用”或“许可”以获取更多信息。
>>> 导入 mylib
>>> i=mylib.Foo()
>>> mylib.bar(i)
0x28cc100
>>> mylib.bar(i)
0x28cc100
>>> mylib.bar(mylib.Foo())
0x28b3b10

```

在这里，我通过适当地设置 LD_LIBRARY_PATH 来确保我们刚刚构建的共享对象位于库路径上。

# android - 为什么 ProgressDialog 不能正确显示？

> ID：10126533
> 
> 赞同：0
> 
> 时间：2012-04-12T15:15:42.570
> 
> 标签：android, progressdialog

我的 ProgressDialog 不会出现。在我的程序中，用户从弹出菜单中选择比特率，内容被在线获取并显示在 VideoView 中。

但是，在视频加载时，我得到的只是黑屏，并且在视频最终加载之前，progressDialog 在结束时显示一瞬间（或更短）。

```
 private void showPopupMenu(View v){
   popupMenu = new PopupMenu(VideoPlayer.this, v); 
   if(bitRates != null){
       int menuItem = 0;
       int index = bitRates.size()-1;
       popupMenu.getMenu().add(0,menuItem, 0,"Hide menu");
          for(int i=1;i<bitRates.size();i++){
              menuItem = i;

              popupMenu.getMenu().add(0,menuItem, 0,"Quality"+" : "+bitrateCheck(bitRates.get(index))).setCheckable(true);
              Log.i("ITEM",qualityList.get(i)+" : "+bitRates.get(i));
              index--;
          }
          popupMenu.getMenu().add(0,menuItem++, 0,"Catalog");

      }
  popupMenu.show(); 
  popupMenu.setOnMenuItemClickListener(new PopupMenu.OnMenuItemClickListener() {

   public boolean onMenuItemClick(final MenuItem item) {
        p_dialog = ProgressDialog.show(VideoPlayer.this, "", "Loading...");

       //get current position of video to seek to
       final int position = mVideoView.getCurrentPosition();
       new Thread() {

            public void run() {

                try{

                    runOnUiThread(new Runnable() {
                        public void run() {

                            if(item.getTitle().equals("Catalog")){
                                 backButtonVideo(new View(VideoPlayer.this));
                            }
                            else if(item.getTitle().equals("Hide menu")){
                                popupMenu.dismiss();
                                mVideoView.start();                             
                            }
                            else{
                                play(streamUrls.get(item.getItemId()),position);

                            }
                        }
                    });

                }
                catch (Exception e) {
                    Log.e("tag", e.getMessage());

                }
                p_dialog.dismiss();
            }

        }.start();

       return true;

   }
  });

}

 public void play(String _videoUri, int position){
         Log.i(TAG,"URI is : "+Uri.parse(_videoUri).toString());         
         //View view = new View()
         MediaController mc = new MediaController(VideoPlayer.this);
         mVideoView.setMediaController(mc); 
         mVideoView.setVideoURI(Uri.parse(_videoUri));
         mVideoView.requestFocus();
         mVideoView.seekTo(position);
         mVideoView.start();

  } 
```

////////////////////使用新代码编辑：根据建议/////////////// /// 现在对话框根本不显示。

```
 mVideoView.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {

    public void onPrepared(MediaPlayer mp) {
        // TODO Auto-generated method stub  
        mVideoView.start();

    }
}); 
```

///////////////////////////////////////// ////////////////////////////

```
 popupMenu.show(); 
  popupMenu.setOnMenuItemClickListener(new PopupMenu.OnMenuItemClickListener() {

   public boolean onMenuItemClick(final MenuItem item) {       
       //get current position of video to seek to
       final int position = mVideoView.getCurrentPosition();
       p_dialog = ProgressDialog.show(VideoPlayer.this, "", "Loading...");
       try{
            if(item.getTitle().equals("Catalog")){
                backButtonVideo(new View(VideoPlayer.this));
            }
            else if(item.getTitle().equals("Hide menu")){
                popupMenu.dismiss();
                mVideoView.start();                             
            }
            else{
                play(streamUrls.get(item.getItemId()),position);                            
            }

        }
        catch (Exception e) {Log.e("tag", e.getMessage());}  
       return true;  
   }
  });

 }

  public void play(String _videoUri, int position){
         Log.i(TAG,"URI is : "+Uri.parse(_videoUri).toString());         
         MediaController mc = new MediaController(VideoPlayer.this);
         mVideoView.setMediaController(mc); 
         mVideoView.setVideoURI(Uri.parse(_videoUri));
         mVideoView.requestFocus();
         mVideoView.seekTo(position);
         p_dialog.dismiss();
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:44:14.727

首先，创建一个单独的线程只是为了在 UI 线程上运行一些东西是没有意义的（那你为什么首先创建线程呢？）。

`onMenuItemClick`应该已经被 UI 线程调用（UI 元素的回调通常会这样做）。

您应该查看的是使用`MediaPlayer.OnPreparedListener`with `VideoView.setOnPreparedListener`。这将为您指示视频何时可以播放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T08:53:30.980

I have the same problem...i've tried you solution but my progress gets blocked...everything stops...and video doesn't show up...it seems that onPrepareListener is never called up...any ideas? Also it seems that setVideoURI has never passed in code...:/

I have different versions of code...with threads, with runOnUI, with AsyncTask, without everything...nothing seems to be working fully. something is always missing.

EDIT:

I have function that I'm calling in onClickListener

Here is a code like yours without any threads:

Version 1: Video starts after few seconds, progress dialog just show for a moment when video starts. Progress isn't showed from the beginning.

```
public void loadService(final int mode) {

    //Version 1

    // Show dialog
    loadService = new ProgressDialog(activity);

    loadService.setTitle("Loading service");
    loadService.setMessage("Please wait...");
    loadService.setCancelable(false);
    loadService.show();

    // Hide progress dialog after 15 seconds if nothing happens
    DuoTVGuiHandler.progressBarProttection(loadService, 15);

    // Setup video view for playback
    if (mode == STAND_ALONE) {
        setupVideoView(((DuoTVGuiActivity) activity).getVideoPlayback());
    }

    if (mode == WIDGET_MODE) {
        setupVideoView(((MainActivity) activity).getVideoViewWidgetMode());
    }
}

/** Setup video view for playback */
public void setupVideoView(final VideoView videoView) {

    videoView.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {

        public void onPrepared(MediaPlayer mp) {
            loadService.dismiss();
            videoView.start();
        }
    });

    videoView.setVideoURI(Uri.parse(channels.get(index).getFilePath()));

} 
```

Version 2 with thread and handler...progress dialog is showed...its spinning...video shows for a second...and the app crashes...WrongThread for UI exception...but when i move setVideoURI in runOnUiThread...progress just stays forever...and setOnVideoURI is never finished.

```
public void loadService(final int mode) {

    // //////////////////////////////
    // Version 2
    // //////////////////////////////

    // Show dialog
    loadService = new ProgressDialog(activity);

    loadService.setTitle("Loading service");
    loadService.setMessage("Please wait...");
    loadService.setCancelable(false);
    loadService.show();

    final Handler handler = new Handler() {

        @Override
        public void handleMessage(Message msg) {

            loadService.dismiss();

            super.handleMessage(msg);
        }
    };

    Thread loadVideoPath = new Thread(new Runnable() {

        public void run() {
            if (mode == STAND_ALONE) {
                ((DuoTVGuiActivity) activity)
                        .getVideoPlayback()
                        .setVideoURI(
                                Uri.parse(channels.get(index).getFilePath()));
            }

            if (mode == WIDGET_MODE) {
                ((MainActivity) activity)
                        .getVideoViewWidgetMode()
                        .setVideoURI(
                                Uri.parse(channels.get(index).getFilePath()));
            }

            handler.sendEmptyMessage(0);
        }
    });

    loadVideoPath.start();
} 
```

Hope you have some idea...I've lost few days on this...and cant see solution...for this pretty basic thing...it drives me crazy :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T16:15:02.527

我按照 Che Jami 的要求做了一些重新安排并让它发挥作用。谢谢

```
 mVideoView.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {    
    public void onPrepared(MediaPlayer mp) {
        // TODO Auto-generated method stub
        p_dialog.dismiss();
        mVideoView.start();

    }
}); 
```

///////////////////////////////////////// //////////////////////////

```
 popupMenu.show(); 
  popupMenu.setOnMenuItemClickListener(new PopupMenu.OnMenuItemClickListener() {

   public boolean onMenuItemClick(final MenuItem item) {       
       //get current position of video to seek to
       final int position = mVideoView.getCurrentPosition();

       try{
            if(item.getTitle().equals("Catalog")){
                backButtonVideo(new View(VideoPlayer.this));
            }
            else if(item.getTitle().equals("Hide menu")){
                popupMenu.dismiss();
                mVideoView.start();                             
            }
            else{
                p_dialog = ProgressDialog.show(VideoPlayer.this, "", "Loading new stream");
                play(streamUrls.get(item.getItemId()),position);                            
            }

        }
        catch (Exception e) {Log.e("tag", e.getMessage());}  
       return true;  
   }
  }); 
```

}

```
 public void play(String _videoUri, int position){
         Log.i(TAG,"URI is : "+Uri.parse(_videoUri).toString());

     MediaController mc = new MediaController(VideoPlayer.this);
     mVideoView.setMediaController(mc); 
     mVideoView.setVideoURI(Uri.parse(_videoUri));
     mVideoView.requestFocus();
     mVideoView.seekTo(position); 
```

}

# silverlight - Silverlight 应用程序中的单个实例

> ID：10126536
> 
> 赞同：0
> 
> 时间：2012-04-12T15:15:57.940
> 
> 标签：silverlight, silverlight-5.0

一次只允许单个用户/客户端在浏览器中打开一个 Silverlight 5 应用程序实例的最佳做法是什么？

如果用户在浏览器中打开 silverlight 应用程序的第二个实例，他们应该会收到一条消息，指示有另一个实例打开并且他们无法继续。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:21:05.783

Silverlight 中有一组类允许本地应用程序进行通信。

看看这里：[基于 Silverlight 的本地应用程序之间的通信](http://msdn.microsoft.com/en-us/library/dd833063%28v=vs.95%29.aspx)

# spring - 如何使用注释而不是 XML 定义 Spring bean？

> ID：10126537
> 
> 赞同：15
> 
> 时间：2012-04-12T15:16:00.513
> 
> 标签：spring, spring-mvc, spring-annotations

我在 xml 配置文件中定义了：

```
<bean id="bootstrap" class="com.package.Bootstrap"></bean> 
```

这很好用。

引导类：

```
public class Bootstrap {

   @PostConstruct
   public void onServerStart() {
      System.out.println("PRINTSSSSSSSSSSSSSSSSSSS");
   }
} 
```

该方法被解雇。

但是我怎样才能摆脱 xml 部分，并将 bootstrap 注释为 bean 呢？

我有

```
<mvc:annotation-driven />
<context:annotation-config /> 
```

和

```
<context:component-scan base-package="com.package" /> 
```

但我**想知道使用的注释**应该是什么替换：

```
<bean id="bootstrap" class="com.package.Bootstrap"></bean> 
```

我在网上和春季文档中找不到任何关于此的信息:(

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-12T15:20:45.487

有关于此的文档；你会想要一个像`@Component`.

[构造型 bean 注释](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-stereotype-annotations)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-31T17:47:06.940

这是我刚刚制作的一个简单示例：

**主.java**

```
package the.test;

import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.support.AbstractApplicationContext;

public class Main {

public static void main(String[] args) {

    AbstractApplicationContext aac = new AnnotationConfigApplicationContext(Person.class, Phones.class);
    Person person = aac.getBean(Person.class);
    System.out.println(person.getPhones().getPhoneOne());
    System.out.println(person.getPhones().getPhoneTwo());
    System.out.println(person.getSurname());
    System.out.println(person.getName());
    System.out.println(person.getAge());
    aac.close();

    }
} 
```

**人.java**

```
package the.test;

import javax.annotation.Resource;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Configuration;

@Configuration

//you may use @ComponentScan("the.test") here and omit declaring 
//"Phone.class" in the main method 

public class Person {
private int age;
private String name;
private String surname;

private Phones phones;

public int getAge() {
    return age;
}
@Value("33")
public void setAge(int age) {
    this.age = age;
}

public String getName() {
    return name;
}

@Value("John")
public void setName(String name) {
    this.name = name;
}

public String getSurname() {
    return surname;
}

@Value("Due")
public void setSurname(String surname) {
    this.surname = surname;
}

public Phones getPhones() {
    return phones;
}
@Resource
public void setPhones(Phones phones) {
    this.phones = phones;
}
} 
```

**电话.java**

```
package the.test;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Configuration;

@Configuration
public class Phones {
private String PhoneOne;
private String PhoneTwo;

public String getPhoneOne() {
    return PhoneOne;
}

@Value("987654321")
public void setPhoneOne(String phoneOne) {
    PhoneOne = phoneOne;
}

public String getPhoneTwo() {
    return PhoneTwo;
}

@Value("123456")
public void setPhoneTwo(String phoneTwo) {
    PhoneTwo = phoneTwo;
}

} 
```

这完全基于 Spring Annotation 并在 spring 框架 4.2.5 上制作

希望能帮助到你。

# javascript - 向下滑动强制显示：块

> ID：10126539
> 
> 赞同：4
> 
> 时间：2012-04-12T15:16:02.633
> 
> 标签：javascript, jquery, css

我使用下面的代码向下滑动一行，但是 jQuery`display: block`在该行上强制执行，当它应该是 时`table-row`，会破坏样式。

小提琴：http: [//jsfiddle.net/7Ay3z/](http://jsfiddle.net/7Ay3z/)

我在完成后手动将其设置为`table-row`，但这太可怕了。我该如何解决这个问题？

```
<style>
table {
    margin: 25px;
}
tr {
    background-color: #c00;
    color: #fff;
    border: 1px solid #000;
    padding: 10px;
}
</style>
<table>
    <tr>
        <td>a</td>
        <td>b</td>
        <td>c</td>
        <td>d</td>
        <td style="display:none;">1</td>
    </tr>
</table> 
```

问：

```
$("tr").click(function(){
    var row = $(this);
    var visibleLength = row.find("td:visible").length;
    var hiddenLength = row.find("td:not(:visible)").length;
    var drillRow = $("<tr/>").addClass("drillDownRow");
    var drillColumn = $("<td/>").attr("colspan", visibleLength);
    var drillHidden = $("<td/>").attr("colspan", hiddenLength).css({display: "none"});

    drillColumn.html("test <b>2</b>... ok");

    drillRow.hide().append(drillColumn).append(drillHidden).insertAfter(row);
    drillRow.slideDown("slow",function() {$(this).css({display: "table-row"})});
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:59:34.023

尝试使用该`animate`方法而不是`slideDown`. 你需要对你想要的效果做更多的手动定义，但它不会引入`display:block`给你带来麻烦的东西。

引自[http://api.jquery.com/animate/](http://api.jquery.com/animate/)：

> 注意：与 .slideDown() 和 .fadeIn() 等速记动画方法不同，.animate() 方法不会使隐藏元素作为效果的一部分可见。例如，给定 $('someElement').hide().animate({height:'20px'}, 500)，动画将运行，但元素将保持隐藏状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-30T10:41:37.617

```
 $el.slideDown(function() {$(this).css('display', '');}); 
```

# c# - 在 .NET 中使用 asp 对象 - 最大兼容性

> ID：10126541
> 
> 赞同：3
> 
> 时间：2012-04-12T15:16:04.080
> 
> 标签：c#, xslt, asp-classic, vbscript

我有一些在其中包含 VBScript 的旧版 XSLT 脚本。它们在旧系统上运行，我无法更改该系统。

我现在需要对 XSLT 进行更改以以不同方式转换文件。

我构建了一个简单的 .NET 项目来测试我的 XSLT 转换：

```
 [STAThread]
    public static void Main(string[] args)
    {
        var transform = new XslCompiledTransform(true);
        //foreach (var file in System.Reflection.Assembly
        //    .GetExecutingAssembly().GetManifestResourceNames()
        //    )
        //{
        //    Console.WriteLine(file);
        //}
        //Console.ReadKey();

        transform.Load(XmlTextReaderFromEmbeddedResource("MyXSLTFile"),
            new XsltSettings() { EnableDocumentFunction = true, EnableScript = true }, new XmlUrlResolver());
        transform.Transform(
            XmlTextReaderFromEmbeddedResource("MySourceXML"),
            ToXmlTextWriter("MyOutput.xml"));

    }

    private static XmlTextReader XmlTextReaderFromEmbeddedResource(string resourceName)
    {
        var resource = typeof(Transform)
            .Assembly.GetManifestResourceStream
            (resourceName);
        return new XmlTextReader(resource);
    }

    private static XmlTextWriter ToXmlTextWriter(string fileName)
    {
        return new XmlTextWriter(fileName, Encoding.UTF8);
    } 
```

这在程序上有效。但是，XSLT 中的脚本（即 VBScript）不能很好地与 .NET 配合使用。具体来说，我有一个部分：

```
dim gRegEx
set gRegEx = New RegExp 
```

它将变换轰炸为：

```
Type 'RegExp' is not defined. 
```

有很多关于如何将其转换为 .NET 对象的文章，但这需要回到需要 VBScript 的旧机器上。

我该如何编写它以便它可以在两种环境中工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T16:25:03.673

避免使用的最简单方法`XslCompiledTransform`. 而是使用 COM-Interop 来利用 MSXML3 或 MSXML6 来执行转换。这样，当在经典 ASP 中执行转换时，在 .NET 中执行的转换更有可能执行相同的操作。

**编辑**：

例子。

创建 Windows 控制台 C# 项目

添加对 COM 组件名称“Microsoft XML, v3.0”的引用。

包括此代码：-

```
class Program
{
    static void Main(string[] args)
    {
        try
        {
            var dom = new MSXML2.DOMDocument30();
            dom.async = false;
            dom.load(args[0]);

            var xslt = new MSXML2.DOMDocument30();
            xslt.async = false;
            xslt.load(args[1]);

            File.WriteAllText(args[2], dom.transformNode(xslt));

            Console.WriteLine("Done");

        }
        finally
        {
            Console.ReadKey();
        }
    }

} 
```

现在在项目属性 Debug 选项卡中添加三个命令行参数，输入 XML 的文件路径，转换它的 XSLT 文件和输出文件路径。

现在，您可以将其合并到一个更大的 .NET 项目中，该项目可以使用为 ASP Classis 设计的 XSL 和/或包含较旧的 MS 脚本代码。

# php - 如果将 php the_content 放在 html 正文中的脚本之后，则执行不正确

> ID：10126543
> 
> 赞同：0
> 
> 时间：2012-04-12T15:16:08.450
> 
> 标签：php, wordpress

我正在使用 wordpress 并使用以下内容将页面内容拖到 html 正文中。

```
<?php the_content(); ?> 
```

它在脚本上方的任何位置都可以正常工作，但是如果我将它放在脚本之后的页面上的任何位置，它会输出就好像它是同一脚本的回显函数（我猜它是什么）。

谁能告诉我可能发生了什么以及是否有办法阻止这种情况发生。我尝试将脚本放在单独的页面中并使用 include 函数将其拉入，但这也不起作用。

```
<?php
$pages = array(
    0 => 'longtailtext/intro1-1.php', 
    1 => 'longtailtext/intro1-2.php'
);
srand(floor(time()/60/60/1));
$key =rand(0,count($pages)-1);
include($pages[$key]) ;
?> 
```

将内容标签放置在脚本之后的任何位置只会输出以下内容：“longtailtext/paragraph1-1.php”

感谢您在这方面给我的任何帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-14T01:17:45.180

也许你应该使用[http://codex.wordpress.org/Function_Reference/get_the_content](http://codex.wordpress.org/Function_Reference/get_the_content)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T17:12:19.563

可能是导致错误的恶意插件。试试这个：[http](http://hungred.com/how-to/avoid-trouble-filter-thecontent-wordpress/) ://hungred.com/how-to/avoid-trouble-filter-thecontent-wordpress/从[这里](https://stackoverflow.com/questions/5019325/wordpress-the-content-not-working-on-single-php)。

# excel - VBA Property Let，不接受传递的值

> ID：10126544
> 
> 赞同：2
> 
> 时间：2012-04-12T15:16:13.083
> 
> 标签：excel, vba

```
'CLASS PROPERTY CODE
Public Property Let setCode_ID(ByVal vCode_ID As String)
    Code_ID = vCode_ID
End Property

For Each Cell In WS_CostCode.Range(Cells(2, 1), Cells(fRow, 1)) 'COLUMN OF CODE_ID
    Set CostCodeItem = New Cost_CodeCL
    CostCodeItem.setCode_ID = "code id" 'WS_CostCode.Cells(Cell.Row, Cell.Column) 'SET CODE_ID 'SET CODE_ID
    CostCodeItem.setCode_Description = "code desc" 'WS_CostCode.Cells(Cell.Row, Cell.Column + 1) 'SET CODE_DESCRIPTION
    CostCodeItem.setCode_Category = "code category" 'WS_CostCode.Cells(Cell.Row, Cell.Column + 2) 'SET CODE_CATEGORY

    uKey = CostCodeItem.getCode_ID
    Debug.Print CostCodeItem.getCode_ID
    CostCodeColl.Add CostCodeItem, CostCodeItem.getCode_ID
Next Cell 
```

我的 pproperty "vCode" 应该显示我在 For Each 循环中传递的任何字符串，但是当它运行时，一旦它访问 Property Let 并且我单步执行它以确保我的字符串正在传递，它就会显示为 ""，而不是我通过的任何东西。

我在另一个类中使用了完全相同的代码，它按预期完美运行。为什么这行为不正常。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:15:56.830

哇，我感觉自己像个新手！很抱歉耽误了任何人的时间。我想我一直在寻找编写大量代码的方法并且没有得到足够的休息。我不小心把我的一个公式写反了。

再次感谢。

# matlab - Matlab - 视频质量差

> ID：10126547
> 
> 赞同：3
> 
> 时间：2012-04-12T15:16:19.883
> 
> 标签：matlab, video-capture

我试图从笔记本电脑中的网络摄像头捕捉帧，但我得到的输出是红色的，绿色的。我使用了以下代码。

```
vid = videoinput('winvideo',1,'YUY2_320x240'); 
set(vid,'TriggerRepeat',Inf);
vid.FrameGrabInterval = 5;
vid_src = getselectedsource(vid);
set(vid_src,'Tag','motion detection setup');

figure; 

start(vid)
while(vid.FramesAcquired<=100) 
    data = getdata(vid,1);
    imshow(data);
end
stop(vid) 
```

# git - Git/Redmine 提交要求

> ID：10126550
> 
> 赞同：0
> 
> 时间：2012-04-12T15:16:25.890
> 
> 标签：git, redmine, scmbug

我目前正在考虑从使用 scmbug 的 svn/bugzilla 系统迁移到将两者集成到 git/redmine 系统。我一直无法找到一种方法来要求提交与 redmine 系统中的“问题”相关联。有谁知道这是否可能？

谢谢！布赖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:38:55.220

正如 eykanal 所指出的，Redmine 可以配置为识别提交消息中的问题编号。当它这样做时，它会自动链接问题页面上的提交，它工作得很好。但请注意，这*不需要*提交即可获得问题参考。如果您想强制执行此操作（即明确禁止不引用问题的提交），那么您必须编写自己的[`pre-commit hook`](http://book.git-scm.com/5_git_hooks.html)查询 Redmine 数据库并在未找到时以失败状态退出。

鉴于此，我不确定我是否会失败，因为您总是会在这里和那里进行合法地不引用票证的提交。我可能只是发出警告信息。例如：

> “警告，您的提交没有引用问题。请适当更新提交消息。这可以通过以下方式完成：git commit --amend -m“新提交消息”

# excel - Matlab：当我在excel中为单元格着色时创建了奇怪的文件

> ID：10126551
> 
> 赞同：2
> 
> 时间：2012-04-12T15:16:31.443
> 
> 标签：excel, matlab

此代码必须通过给定的 rgb 为 J1 单元格着色。

```
row_number_excel = 1;
representative_red = 205;
representative_green = 211;
representative_blue = 201;
headers = {'J'};
rgb = [representative_red representative_green representative_blue]; %# if you have 0 to 1 values        multiply by 255 and round
clr = rgb * [1 256 256^2]'; %# convert to long number Excel understands
pwd = 'D:\grapes\main';
e = actxserver ('Excel.Application'); % open Activex server
filename = fullfile(pwd,'example.xls'); %# full path required
if exist(filename,'file')
    ewb = e.Workbooks.Open(filename); %# open the file
else
    error('File does not exist.') %# or create a new file
end
esh = ewb.ActiveSheet;
for c = 1:row_number_excel
    str = num2str(row_number_excel);
    esh.Range(strcat(headers{1},str)).Interior.Color = clr;
end
ewb.Save
ewb.Close(false)
e.Quit 
```

我尝试运行此代码，但单元格的颜色与给定的 rgb 不同。当我第二次运行代码时，在我的目录中创建了一个文件，名为：“2E60F720”。它的类型是“文件”。然后程序跑了又跑，直到我被任务管理器停止'EXCEL.EXE'才停止。之后matlab给我写了这个：

```
"??? Error: The remote procedure call failed.
Error in ==> test1 at 212 ewb.
Close(false);" 
```

有人能帮助我吗？我捕获了屏幕。在左侧，程序仍在运行，在右侧，这是我的目录。我标记了创建的文件。 ![在此处输入图像描述](../Images/4520402a5c10360861d427f26f5580f9.png) 谢谢！

解决我的问题的解决方案是：

```
row_number_excel = 1;
representative_red = 205;
representative_green = 211;
representative_blue = 201;
headers = {'J'};
rgb = [representative_red representative_green representative_blue]; %# if you have 0 to 1 values            multiply by 255 and round
clr = rgb * [1 256 256^2]'; %# convert to long number Excel understands
pwd = 'D:\grapes\main';
e = actxserver ('Excel.Application'); % open Activex server
filename = fullfile(pwd,'example.xls'); %# full path required
if exist(filename,'file')
    ewb = e.Workbooks.Open(filename); %# open the file
else
    error('File does not exist.') %# or create a new file
end
esh = ewb.ActiveSheet;
for c = 1:row_number_excel
    str = num2str(row_number_excel);
    esh.Range(strcat(headers{1},str)).Interior.Color = clr;
end
xlWorkbookDefault = 51; %# it's the Excel constant, not sure how to pass it other way
ewb.SaveAs(fullfile(pwd,'example2'), xlWorkbookDefault)
ewb.Close(false)
e.Quit 
```

感谢@yuk！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T16:58:48.853

问题行是用`ewb.Save`.

您的文件实际上是旧格式（excel 2003），不确定它是否支持真正的 RGB 颜色，这可能是原因。

我建议使用新名称和最新格式保存文件。把它作为最后几行：

```
xlWorkbookDefault = 51; %# it's the Excel constant, not sure how to pass it other way
ewb.SaveAs(fullfile(pwd,'example2'), xlWorkbookDefault)
ewb.Close(false)
e.Quit 
```

# java - LWJGL 教程

> ID：10126555
> 
> 赞同：10
> 
> 时间：2012-04-12T15:16:40.540
> 
> 标签：java, lwjgl

有谁知道任何适合 OpenGL 初学者的轻量级 Java 游戏库教程？我注意到 youtube 上有一些，但它们只涵盖了创建窗口和将 2D 四边形重新渲染到屏幕的基础知识，而且通常不完整。LWJGL 网站也提供小教程，但似乎只是关于设置窗口和轮询输入的基础知识。

欢迎大家提出意见。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-12T15:23:04.433

这些是您感兴趣的一些链接：

[http://content.gpwiki.org/index.php/OpenGL:Tutorials:Java:LWJGL:Introduction](http://content.gpwiki.org/index.php/OpenGL:Tutorials:Java:LWJGL:Introduction)

[http://lwjgl.org/forum/index.php?topic=3616.0](http://lwjgl.org/forum/index.php?topic=3616.0)

[http://ninjacave.com/lwjglapplet](http://ninjacave.com/lwjglapplet)

[http://code.google.com/p/lwjgltutorial/source/browse/#svn%2Ftrunk%2Fsrc%2Forg%2Flwjgltutorial%253Fstate%253Dclose](http://code.google.com/p/lwjgltutorial/source/browse/#svn%2Ftrunk%2Fsrc%2Forg%2Flwjgltutorial%253Fstate%253Dclosed)

[http://www.experiencefestival.com/wp/videos/18-advanced-opengl-rendering--java-game-development-lwjgl/oTqFgYR3Fvs](http://www.experiencefestival.com/wp/videos/18-advanced-opengl-rendering--java-game-development-lwjgl/oTqFgYR3Fvs) - 这是很好的视频教程。此外，这是以下网站，收集了超过18课视频教程的来源。 [https://github.com/OskarVeerhoek/YouTube-tutorials/tree/master/src](https://github.com/OskarVeerhoek/YouTube-tutorials/tree/master/src)。

[http://www.lloydgoodall.com/tutorials/first-person-camera-control-with-lwjgl/](http://www.lloydgoodall.com/tutorials/first-person-camera-control-with-lwjgl/) - 第一人称相机控制器教程

[https://bitbucket.org/chuck/lwjgl-sandbox/src/b3e538e59c85/src/main/java/tutorials/nehe](https://bitbucket.org/chuck/lwjgl-sandbox/src/b3e538e59c85/src/main/java/tutorials/nehe) - 这个有大约 12 节 NEHE 课程移植到 LWGJL。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-16T17:35:51.043

当他发布 LWJGL 的新教程时，我总是看 TheCodingUniverse，这是第 1 集：[http](http://www.youtube.com/watch?v=0v56I5UWrYY) ://www.youtube.com/watch?v=0v56I5UWrYY （他目前已发布 26 集：从基本的 2D 四边形到高级渲染、声音和加载楷模）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T18:35:58.523

我强烈推荐阅读[学习现代 3D 图形编程](http://www.arcsynthesis.org/gltut/index.html)。如果您对 LWJGL 端口感兴趣，可以在[这里](https://github.com/integeruser/jgltut)找到。

# apache - 网址的 htaccess

> ID：10126559
> 
> 赞同：1
> 
> 时间：2012-04-12T15:16:56.800
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting

嗨，我想知道我如何编写 htaccess 来制作以下网址：

`http://localhost:8000/foo/index.php?pageid=EmpDataEntry`

像这样

`http://localhost:8000/foo/pageid/EmpDataEntry`

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:26:39.570

Have you read the official mod_rewrite [documentation](http://httpd.apache.org/docs/current/mod/mod_rewrite.html) ? Everything is exaplained.

```
RewriteEngine On
RewriteBase /
RewriteRule ^/foo/pageid/([A-Za-z]+)/?$ /foo/index.php?pageid=$1 [L] 
```

Remove `/?` if you don't want to allow a trailing slash.

# c# - 通过 ASP.NET 使用 ContentEditable 保存到数据库？

> ID：10126560
> 
> 赞同：0
> 
> 时间：2012-04-12T15:16:58.480
> 
> 标签：c#, asp.net, html, contenteditable

我正在尝试创建一个网页，用户可以在其中编辑文本，完成后，他们点击保存并将输入的新文本保存到数据库中。

我的代码中没有任何错误，但由于某种原因，旧文本只是被重写到数据库而不是新文本中。

这是我的代码隐藏：

```
protected void saveBtn_Click(object sender, EventArgs e)
{
    string newName;
    string newIntro;
    string newEduc;
    string newWork;

    h1New.Text = h1.Text;

    newName = h1New.Text;
    newIntro = intro.Text;
    newEduc = educ.Text;
    newWork = employ.Text;

    string connectionInfo = ConfigurationManager.ConnectionStrings["ApplicationServices"].ConnectionString;

    using (SqlConnection connection = new SqlConnection(connectionInfo))
    {

        connection.Open();
        SqlCommand myCommand = new SqlCommand("UPDATE simpleContent SET userName = @newName, infoContent = @newIntro, educContent = @newEduc, workContent = @newWork WHERE userID = @userName", connection);

        try
        {

            string username = HttpContext.Current.User.Identity.Name;
            myCommand.Parameters.AddWithValue("@userName", username.ToString());
            myCommand.Parameters.AddWithValue("@newName", newName.ToString());
            myCommand.Parameters.AddWithValue("@newIntro", newIntro.ToString());
            myCommand.Parameters.AddWithValue("@newEduc", newEduc.ToString());
            myCommand.Parameters.AddWithValue("@newWork", newWork.ToString());
            myCommand.ExecuteNonQuery();
            connection.Close();
        }
        catch
        {
            Response.Redirect("http://www.google.co.uk");
        }

    }
} 
```

我将不胜感激您可能有的任何指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:54:25.403

试着把你的代码格式：

```
protected void saveBtn_Click(object sender, EventArgs e)
{    
// add variables
     string connectionInfo = (...)
     string commandText = (...)

    using (...){
        SqlCommand myCommand = (...)
        // add parameters

    try
    {
        connection.Open();
        myCommand.ExecuteNonQuery();
        connection.Close();
    }

    catch (Exception ex)
            {
                (...)
            }
} 
```

# c++ - 使用派生类调用父类的模板化函数重载

> ID：10126564
> 
> 赞同：0
> 
> 时间：2012-04-12T15:17:11.853
> 
> 标签：c++, templates, inheritance, overloading

我有以下形式的问题：

```
class A {
    ...
};
template <...> class B : public A {
    ...
}

f(A*) {...}
f(C*) {...}
template <...> f(D*) {...} 
```

问题是，如果我使用 B* 类型的参数调用函数 f，它会选择泛型类型 D*（它根本与 A 或 B 无关）。我*希望*它选择 A* 的专业。

我正在尝试做的事情是否有效，如果是，为什么它不起作用？
谢谢，
伊恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:30:07.783

您可以使用 SFINAE：

```
template<typename T>
typename boost::disable_if<boost::is_base_of<A, T>, Ret>::type
f(T*); 
```

（如果您想针对`B`特定类型禁用此重载，而不仅仅是从`A`您派生的所有类型都可以`boost::is_same<B, T>`用作条件。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:35:30.330

我不确定您要做什么。你可以试试：

```
void f(B *b)
{
  f(dynamic_cast<A*>(b));
} 
```

这将`f()`使用类型参数进行调用，`B*`解析为您的第一个定义`f()`，即接受类型参数的定义`A*`。`f()`否则，编译器将使用需要最少隐式类型转换的函数来解析调用。由于`template <typename D> void f(D*);`不需要类型转换，它将捕获所有`f()`不匹配更具体定义的调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T05:22:15.077

看来我想做的事情并不是直接可能的；显然，模板专业化优先于多态性，如果没有 Boost 或 C++11，就不可能解决这个问题。

最后，我通过在调用“f”之前将所有内容转换为“A*”类型来解决问题。

谢谢大家，

# python - 如何使用 pysqlite2 在 python 中强制执行 SQLite 外键？

> ID：10126566
> 
> 赞同：1
> 
> 时间：2012-04-12T15:17:20.353
> 
> 标签：python, sqlite, foreign-keys, enforcement

我有一个 SQLite 数据库。根据[这个答案](https://stackoverflow.com/a/3296052/651779)，您需要我拥有的 3.6.19+ 版本。我使用 SQLite 3.7.10 版制作它：

```
>>> from pysqlite2 import dbapi2 as sqlite
>>> print sqlite.sqlite_version
3.7.10 
```

所以它应该支持外键。

我有以下 sqlite 数据库创建语句：

```
DROP TABLE IF EXISTS `msrun`;
-- -----------------------------------------------------
-- Table `msrun`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `msrun` (
  `msrun_name` VARCHAR(40) PRIMARY KEY NOT NULL ,
  `description` VARCHAR(500) NOT NULL );

DROP TABLE IF EXISTS `feature`;
-- -----------------------------------------------------
-- Table `feature`
-- -----------------------------------------------------
CREATE  TABLE IF NOT EXISTS `feature` (
  `feature_id` VARCHAR(40) PRIMARY KEY NOT NULL ,
  `intensity` DOUBLE NOT NULL ,
  `overallquality` DOUBLE NOT NULL ,
  `charge` INT NOT NULL ,
  `content` VARCHAR(45) NOT NULL ,
  `msrun_msrun_name` VARCHAR(40) NOT NULL ,
  CONSTRAINT `fk_feature_msrun1`
    FOREIGN KEY (`msrun_msrun_name` )
    REFERENCES `msrun` (`msrun_id` )
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

  CREATE UNIQUE INDEX `id_UNIQUE` ON `feature` (`feature_id` ASC);
  CREATE INDEX `fk_feature_msrun1` ON `feature` (`msrun_msrun_name` ASC); 
```

所以特征表中的msrun_msrun_name是msrun表中msrun_name的外键。但是，当我填写功能表时，我可以为 msrun_msrun_name 填写任何我想要的内容。未强制执行外键。

根据[这个问题](https://stackoverflow.com/questions/2614984/sqlite-sqlalchemy-how-to-enforce-foreign-keys)，需要打开强制执行，它给出了如何使用 SQLAlchemy 执行此操作的答案，但我没有使用 SQLAlchemy。

如何使用 pysqlite2 强制执行外键？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:30:58.600

尝试使用 SQLite 的`PRAGMA foreign_keys=ON;`命令，默认情况下它是禁用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:33:34.997

尝试使用[PRAGMA](http://www.sqlite.org/foreignkeys.html) foreign_keys 命令。例如：

```
sqlite> PRAGMA foreign_keys = ON; 
```

然后查看当前是否启用了外键：

```
sqlite> PRAGMA foreign_keys;
0
sqlite> PRAGMA foreign_keys = ON;
sqlite> PRAGMA foreign_keys;
1
sqlite> PRAGMA foreign_keys = OFF;
sqlite> PRAGMA foreign_keys;
0 
```

# python - 从 wxpython 中的导入模块捕获标准输出并将其发送到 textctrl，而不阻塞 GUI

> ID：10126567
> 
> 赞同：2
> 
> 时间：2012-04-12T15:17:20.643
> 
> 标签：python, multithreading, wxpython, stdout, wxtextctrl

有很多与此非常相似的问题，但我找不到一个专门适用于我正在尝试做的事情的问题。

我有一个正在为其编写 GUI 的模拟（用 SimPy 编写），模拟的主要输出是文本 - 从“打印”语句到控制台。现在，我认为最简单的方法是创建一个单独的模块 GUI.py，并将我的模拟程序导入其中：

```
import osi_model 
```

我希望所有打印语句都被 GUI 捕获并出现在 Textctrl 中，这里有无数的例子，如下所示：

```
class MyFrame(wx.Frame):
    def __init__(self, *args, **kwds):
        <general frame initialisation stuff..>

        redir=RedirectText(self.txtCtrl_1)
        sys.stdout=redir

class RedirectText:
    def __init__(self,aWxTextCtrl):
        self.out=aWxTextCtrl

    def write(self,string):
        self.out.WriteText(string) 
```

我也从“开始”按钮开始我的模拟：

```
def go_btn_click(self, event):
    print 'GO'
    self.RT = threading.Thread(target=osi_model.RunThis())
    self.RT.start() 
```

这一切都很好，模拟模块的输出由 TextCtrl 捕获，除了 GUI 锁定并变得无响应 - 我仍然需要它可以访问（至少要有一个“停止”按钮）。我不确定这是否是我在这里所做的创建新线程的拙劣尝试，但我认为在此过程的某个阶段将需要一个新线程。

人们建议使用 wx.CallAfter，但考虑到导入的模块不知道 wx，我不知道该怎么做，而且我也无法真正浏览整个模拟架构并将所有打印语句更改为 wx .CallAfter，任何从导入的模拟程序内部捕获 shell 的尝试都会导致程序崩溃。

有人对我如何最好地实现这一目标有任何想法吗？所以我真正需要的只是让 TextCtrl 捕获所有控制台文本，同时 GUI 保持响应，并且所有文本仅来自导入的模块。

（另外，关于停止按钮的第二个问题 - 只是杀死模拟线程是不好的形式吗？）。

谢谢，

邓肯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T11:23:10.853

我建议查看[这篇关于长期运行任务的 WX wiki 文章](http://wiki.wxpython.org/LongRunningTasks)。

它专门解决了您使用“开始”按钮处理长时间运行的过程的情况。使用不同的技术（如线程和空闲处理程序）给出了几个不同的示例。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-17T14:48:59.687

我认为您必须将标准输出重定向到日志文件（或简单的 SQLite 数据库？），然后使用您的线程检查日志文件的更新，然后使用 wx.CallAfter 或类似方法将其传递给 GUI。您可能可以使用类似 Python 中构建的套接字服务器：[http](http://wiki.wxpython.org/AsynchronousSockets) ://wiki.wxpython.org/AsynchronousSockets 。我认为 wxPython Cookbook 也提到了一些关于使用 RPC 服务器的内容（可能是这个：[http](http://docs.python.org/library/simplexmlrpcserver.html) ://docs.python.org/library/simplexmlrpcserver.html ），但我不记得细节了。

您还应该尝试在 wxPython 官方邮件列表上提问。他们在那边非常友好。

# java - 如何将 KNET 支付网关与 php 集成

> ID：10126569
> 
> 赞同：2
> 
> 时间：2012-04-12T15:17:23.647
> 
> 标签：java, php, payment-gateway

如何将 KNET 支付网关与 PHP 集成？网关 ID 仅适用于 Java 和 .NET。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-17T11:13:39.580

您可以在与 php 5.3 一起使用[的 github 上使用此 php 实现。](https://github.com/TigerWolf/e24PaymentPipe-php)

有关更多信息，请参阅 git 自述文件中的学分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-14T09:49:54.087

您必须为其安装 PHP / Java Bridge。然后，您必须将支付网关提供的 jar 文件复制到 /WEB-INF/Lib。然后在你的 PHP 中调用那个 java 类。

享受。

# sed - Bash/AWK/SED 在一行中匹配并重写一串数字（日期）

> ID：10126576
> 
> 赞同：4
> 
> 时间：2012-04-12T15:17:38.817
> 
> 标签：sed, awk, grep

我有一个文本文件，其内容重复大约 60 次，来自转换后的 .ics 文件：

```
Start Vak
Tijd van: 20120411T093000Z
Tijd tot: 20120411T100000Z
Klas(sen) en Docent(en): VPOS0A1 VPOS0A2 Mariel Kers
Vak: Ex. Verst. beperk.
Lokaal: 7.05
Einde Vak 
```

我想重写“Tijd van”和“Tijd tot”值以成为一个好的日期（在带有 awk、sed 和 grep 等的 gnu/linux 系统上的 bash 脚本中）。我尝试使用 awk 找到它：

```
awk '/^Tijd.*[:digit:][:digit:]Z$/; { getline; print $0; }' rooster2.txt 
```

和 grep：

```
egrep '/^Tijd(.*)[:digit:][:digit:]Z$/' rooster2.txt 
```

但他们都没有找到线。

我想要的是将该日期重写为更 bash 可解析/可行的时间格式，例如 EPOCH 或类似 31.04.2012 13:00:00 的格式。我不想替换或重写整行，只是特定的字符串！欢迎使用任何提示、示例或链接，并且非常有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:27:40.797

试试这个（GNU sed）：

```
sed -r 's/(Tijd ...: )(....)(..)(..).(..)(..)(..)./\1 \4.\3.\2 \5:\6:\7/' FILE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-23T10:13:10.397

`awk`您的代码有几个问题：

1.  虽然`[:digit:]`指的是*“任何数字”*，但您仍然需要另一对方括号 ( `[...]`) 来表示字符组：（`[[:digit:]]`只是您想要的图像“ *a,any digit or _* ”，这将是`[a[:digit:]_]`定义字符组的外部方括号。 )
2.  `;`您的*模式*( `/.../`) 和相应的*操作*( ) 之间的分号 ( )`{...}`将两者分开，因此您有一个没有操作的*模式*，导致标准*操作* `{print $0}`，以及没有*模式的第二个**操作*，导致它对所有*记录*执行（即线）。
***   `getline`要求在继续之前`awk`阅读下一条*记录*（即行）。**

 **将所有这些放在一起，您的代码将执行以下操作：

*   打印所有匹配的行`/^Tijd.*[:digit:][:digit:]Z$/`（即没有，因为`[:digit:]`转换为*“:,d,i,g, or t”之一*）。
*   此外，对于所有行：阅读*下一*行并打印。

因此，它将打印除第一行之外的所有行（因为这是唯一一个不是任何其他行的*下一行）。*

假设您只想打印匹配*“以'Tijd'开头并以两位数字后跟'Z'”的*行，您可以使用以下代码：

```
awk '/^Tijd.*[[:digit:]][[:digit:]]Z$/{ print $0; }' rooster2.txt 
```

由于`{print $0}`是标准*动作*，您甚至可以将其缩短为

```
awk '/^Tijd.*[[:digit:]][[:digit:]]Z$/' rooster2.txt 
```

要解决您的实际问题，您可以使用以下内容：

```
awk '/^Tijd.*[[:digit:]][[:digit:]]Z$/{year=substr($NF,1,4);month=substr($NF,5,2);day=substr($NF,7,2);hour=substr($NF,10,2);min=substr($NF,12,2);sec=substr($NF,14,2);$NF=day"."month"."year" "hour":"min":"sec}1' rooster2.txt 
```

这工作如下：

*   对于匹配*模式*( ) 的*记录*（即行），根据您的需要重新排列*最后一个字段*( )。*`/.../`*`$NF`**
***   打印所有*记录*（即行）（`1`是匹配所有*记录（即行）的**模式*，没有指定*操作*，产生标准的（））**`{print $0}`****

 ***请注意，GNU`awk`也有一个`strftime`功能。但是，这需要时间戳采用不同的格式。如果你想使用它，你仍然必须重新排列*field*，首先：

```
awk -v FORMAT="%c" '/^Tijd.*[[:digit:]][[:digit:]]Z$/{$NF=strftime(FORMAT,mktime(substr($NF,1,4)" "substr($NF,5,2)" "substr($NF,7,2)" "substr($NF,10,2)" "substr($NF,12,2)" "substr($NF,14,2)))}1' rooster2.txt 
```

现在，您只需要根据需要进行调整`FORMAT`即可更改格式。详情请参阅`man strftime`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:43:41.973

作为红宝石单线；需要然后替换匹配的正则表达式`time`。`Time.parse`您可以查看[strftime](http://rdoc.info/stdlib/core/1.9.3/Time#strftime-instance_method)方法来格式化时间输出。

```
[slmn@uriel ~]$ ruby -rtime -ne 'puts $_.sub(/(Tijd (van|tot): )(.*)/) { $1 + Time.parse($3).strftime("%D %T") }' < yourfile.txt
Start Vak
Tijd van: 04/11/12 09:30:00
Tijd tot: 04/11/12 10:00:00
Klas(sen) en Docent(en): VPOS0A1 VPOS0A2 Mariel Kers
Vak: Ex. Verst. beperk.
Lokaal: 7.05
Einde Vak 
```*****

# spring - 在单元测试期间提交/刷新事务？

> ID：10126577
> 
> 赞同：2
> 
> 时间：2012-04-12T15:17:39.973
> 
> 标签：spring, unit-testing, transactions, junit4

我正在使用 Spring 和 JUnit 为我的 DAO 编写一些集成测试。我在测试方法的开始设置我的测试数据，然后在同一个测试方法中测试我的 DAO 方法。问题是，如果我不刷新/提交事务，EntityManager 会返回我刚刚在数据设置中创建的实体的相同实例 - 使我的测试无用，因为它们总是会通过。

例如

```
@Test   
@Transactional()
public void loadTreeBasicCase() {
    // creates and saved node to DB
    Node n = createNode();

    // test DAO
    Node result = dao.lookup(n.getId());

    // verify
    assertThat(n, equalTo(result));
} 
```

一种方法是在我的 DAO 中公开 commit() 和/或 flush() 方法。但我不希望这样做，因为在生产代码中，这几乎不需要发生（让 EntityManager 做这件事）。有没有办法通过注释或在 Spring 配置中进行配置？我正在使用 Spring、JPA2 和 Hibernate。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T15:16:44.497

您可以在 @Transactional 上设置 defaultRollback 属性以重置测试之间的内容。这听起来不像你要求的，只是先把它扔出去。

在测试中，实体管理器的行为正确。您想为测试注入不同的行为，以将设置与测试的其余部分“断开”。我在一些测试中做的一件事是直接从测试中调用实体管理器上的刷新。我只需要做几次，但在那些情况下它很有价值。我在测试（不是 DAO）中做到了，以免在 DAO 上提供我不希望人们调用的方法。

# php - 转义整个字符串的小问题

> ID：10126579
> 
> 赞同：1
> 
> 时间：2012-04-12T15:17:52.487
> 
> 标签：php

我有以下执行 XOR 编码/解码过程的代码：

```
<?php

/*
 * Simple XOR encoder/decoder, Inkubus
 *
 */

$key = pack("H*","3cb37efae7f4f376ebbd76cd");
//$encoded = ")5/Y+F8'0P$/;"; // <- OK, Working
//$decoded = 'hM5cf$350';
$encoded = "-?^<]TLV.GQV)B4[YQ   "; // <- BAD, Not working
$decoded = "CTC(*zlkb4848";
//$encoded = ')3\8?E(21@$;='; // <- OK, Working
//$decoded = 'suances06';

function decode($encoded,$key) {
  $cipher = convert_uudecode($encoded);
  $plain = $cipher ^ $key;
  $result = substr($plain, 0, strlen($cipher));
  return $result;
}

function encode($decoded,$key) {
  $plain = $decoded ^ $key;
  $result = convert_uuencode(substr($plain, 0, strlen($decoded)));
  $result = preg_replace("/\n/m","",$result);
  $result = preg_replace("/`$/m","",$result);
  return $result;
}

echo "Encoded: " . $encoded . "\n";
echo "Decoded: " . decode($encoded,$key) . "\n";
echo "Encoded: " . encode($decoded,$key) . "\n";
echo "Decoded: " . decode(encode($decoded,$key),$key) . "\n";

?> 
```

在标题之后评论的是两个有效的示例，未注释的是有问题的示例。我怎样才能通常评论要解码的 UUENCODED 字符串，使其保持不变并正确解码？注释字符串中的任何有问题的字符不是一种选择，而是整个字符串。

工作运行示例：

```
bash-$ php xor.php
Encoded: )3\8?E(21@$;=
Decoded: suances06
Encoded: )3\8?E(21@$;=
Decoded: suances06 
```

不工作的例子：

```
bash-$ php xor.php
Encoded: -?^<]TLV.GQV)B4[YQ
Decoded: CTC(*zlkb484
Encoded: ,?^<]TLV.GQV)B4[Y
Decoded: CTC(*zlkb484 
```

某些字符丢失或其他。有任何想法吗？

谢谢！

更新：另一个不工作的例子：

```
$encoded = "-!8H<RY67FP';C1+]R@  "; // <- BAD, Not working
$decoded = "99b1rchw00d06"; 
```

冉：

```
bash-$ php xor.php
Encoded: -!8H<RY67FP';C1+]R@
Decoded: 99b1rchw00d0
Encoded: ,!8H<RY67FP';C1+]
Decoded: 99b1rchw00d0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T17:51:29.720

不清楚您在这里实际要问的是什么。您的函数包含许多杂乱无章的代码，可以/应该简化为：

```
function decode($encoded,$key) {
  return convert_uudecode($encoded) ^ $key;
}

function encode($decoded,$key) {
  return convert_uuencode($decoded ^ $key);
} 
```

这不能按您预期工作的原因是因为 PHP 的 XOR 不能按您希望的方式工作：

```
$a = "-?^<]TLV.GQV)B4[YQ   ";
$b = pack("H*","3cb37efae7f4f376ebbd76cd");

$c = ($a ^ $b) ^ $b;
echo $a == $c ? 'OK' : 'NOT OK'; 
```

这将输出`NOT OK`. 如果您想要一个简单的字符串 XOR 运算符，请使用：

```
function str_xor($a, $b){
    $out = '';
    for ($i=0; $i<strlen($a); $i++){
        $ac = ord($a{$i});
        $bc = ord($b{$i});
        $out .= chr($ac ^ $bc);
    }
    return $out;
} 
```

然后前面的示例代码将往返：

```
$c = str_xor(str_xor($a, $b), $b);
echo $a == $c ? 'OK' : 'NOT OK';
# outputs 'OK' 
```

PHP 的 XOR 函数不适用于第二个操作数比第一个操作数短的字符串 - 它会将返回的字符串截断为第二个操作数的长度（如果第二个操作数比第一个操作数长也可以 - 它会将输出截断到最短操作数的长度）。

另一种可能的解决方案是像这样扩展您的密钥：

```
while (strlen($key) < strlen($text)) $key .= $key; 
```

这将确保您的密钥比您正在异或的东西长

# mysql - .net mvc3 mysql表没有主键

> ID：10126580
> 
> 赞同：0
> 
> 时间：2012-04-12T15:17:55.853
> 
> 标签：mysql, asp.net-mvc, asp.net-mvc-3, primary-key

我是 .net 的新手，我唯一的经验是使用 MVC3 Entity Framework Code First 项目。我需要编写一个新的 Web 应用程序来查询现有的遗留数据库。我对该 MYSQL 数据库具有只读访问权限。大多数表没有主键。我可以连接到数据库了。当尝试使用 EF 连接并提取一些数据时，我收到表没有主键的错误。在网上研究这个问题让我得出结论，在这种情况下我可能无法使用 EF。鉴于我的经验有限，我的下一个最佳行动方案是什么？任何援助将不胜感激。

最亲切的问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:23:19.590

您可以使用内置于 .NET 框架中的 ADO.NET。这意味着您必须编写 SQL 代码才能与数据库进行交互。

要让 ADO.NET 与 MySQL 一起工作，您需要 MySQL ADO.NET[连接器](http://www.mysql.com/downloads/connector/net/)。更多关于 ADO.NET 的文档可以在[MSDN](http://msdn.microsoft.com/en-us/library/e80y5yhx%28v=vs.100%29.aspx)上找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:25:38.607

鉴于对没有主键的数据库的只读访问权限，Entity Framework 将无济于事。我自己没有尝试过，但我建议你尝试使用 XSD 文件为你的 mysql 挂件创建 tableadapter 和表。但即使这可行，没有键您将无法添加任何关联。

# mysql - 无论如何，如何在结果集中包含零消息的日期？

> ID：10126582
> 
> 赞同：0
> 
> 时间：2012-04-12T15:17:58.380
> 
> 标签：mysql, sql

我有下表的消息：

```
+---------+---------+------------+----------+
| msg_id  | user_id | m_date     |  m_time  |
+-------------------+------------+----------+
|   1     | 1       | 2011-01-22 | 06:23:11 |
|   2     | 1       | 2011-01-23 | 16:17:03 |
|   3     | 1       | 2011-01-23 | 17:05:45 |
|   4     | 2       | 2011-01-22 | 23:58:13 |
|   5     | 2       | 2011-01-23 | 23:59:32 |
|   6     | 2       | 2011-01-24 | 21:02:41 |
|   7     | 3       | 2011-01-22 | 13:45:00 |
|   8     | 3       | 2011-01-23 | 13:22:34 |
|   9     | 3       | 2011-01-23 | 18:22:34 |
|  10     | 3       | 2011-01-24 | 02:22:22 |
|  11     | 3       | 2011-01-24 | 13:12:00 |
+---------+---------+------------+----------+ 
```

我想要的是每天，查看每个用户在 16:00 之前和之后发送了多少条消息：

```
SELECT 
    user_id, 
    m_date, 
    SUM(m_time <= '16:00') AS before16, 
    SUM(m_time > '16:00') AS after16 
FROM messages 
GROUP BY user_id, m_date
ORDER BY user_id, m_date ASC 
```

这会产生：

```
user_id m_date      before16  after16
-------------------------------------
1       2011-01-22  1         0
1       2011-01-23  0         2
2       2011-01-22  0         1
2       2011-01-23  0         1
2       2011-01-24  0         1
3       2011-01-22  1         0
3       2011-01-23  1         1
3       2011-01-24  2         0 
```

因为用户 1 在 2011 年 1 月 24 日没有写任何消息，所以这个日期不在结果集中。然而，这是不希望的。我的数据库中有第二个表，名为“date_range”：

```
+---------+------------+
| date_id | d_date     |
+---------+------------+
| 1       | 2011-01-21 |
| 1       | 2011-01-22 |
| 1       | 2011-01-23 |
| 1       | 2011-01-24 |
+---------+------------+ 
```

我想对照这张表检查“消息”。对于每个用户，所有这些日期都必须在结果集中。如您所见，没有一个用户在 2011-01-21 上写过消息，如前所述，用户 1 在 2011-01-24 上没有任何消息。查询的期望输出将是：

```
user_id d_date      before16  after16
-------------------------------------
1       2011-01-21  0         0
1       2011-01-22  1         0
1       2011-01-23  0         2
1       2011-01-24  0         0
2       2011-01-21  0         0
2       2011-01-22  0         1
2       2011-01-23  0         1
2       2011-01-24  0         1
3       2011-01-21  0         0
3       2011-01-22  1         0
3       2011-01-23  1         1
3       2011-01-24  2         0 
```

如何链接这两个表，以便查询结果还包含 before16 和 after16 的零值行？

**编辑：是的，我有一个“用户”表：**

```
+---------+------------+
| user_id | user_date  |
+---------+------------+
| 1       | foo        |
| 2       | bar        |
| 3       | foobar     |
+---------+------------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:42:11.073

Test bed:

```
create table messages (msg_id integer, user_id integer, _date date, _time time);
create table date_range (date_id integer, _date date);
insert into messages values
       (1,1,'2011-01-22','06:23:11'),
       (2,1,'2011-01-23','16:17:03'),
       (3,1,'2011-01-23','17:05:05');
insert into date_range values
       (1, '2011-01-21'),
       (1, '2011-01-22'),
       (1, '2011-01-23'),
       (1, '2011-01-24'); 
```

Query:

```
SELECT p._date, p.user_id,
       coalesce(m.before16, 0) b16, coalesce(m.after16, 0) a16
  FROM
      (SELECT DISTINCT user_id, dr._date FROM messages m, date_range dr) p
  LEFT JOIN
      (SELECT user_id, _date,
              SUM(_time <= '16:00') AS before16,
              SUM(_time > '16:00') AS after16 
         FROM messages 
        GROUP BY user_id, _date
        ORDER BY user_id, _date ASC) m
    ON p.user_id = m.user_id AND p._date = m._date; 
```

**EDIT:**

1.  Your initial query is left as is, I hope it doesn't requires any explanations;

2.  `SELECT DISTINCT user_id, dr._date FROM messages m, date_range dr` will return a cartesian or [`CROSS JOIN`](http://dev.mysql.com/doc/refman/5.5/en/join.html) of two tables, which will give me all required date range for each user in subject. As I'm interested in each pair only once, I use `DISTINCT` clause. Try this query with and without it;

3.  Then I use [`LEFT JOIN`](http://dev.mysql.com/doc/refman/5.5/en/join.html) on two sub-selects.

    This join means: first, INNER join is performed, i.e. all rows with matching fields in the `ON` condition are returned. Then, for each row in the left-side relation of the join that has no matches on the right side, return `NULL`s (thus the name, `LEFT JOIN`, i.e. left relation is always there and right is expected to have `NULL`s). This join will do what you expect — return `user_id + date` combinations even if there were no messages in the given date for a given user. Note that I use `user_id + date` sub-select first (on the left) and `messages` query second (on the right);

4.  [`coalesce()`](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_coalesce) is used to replace `NULL` with zero.

I hope this clarifies how this query works.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T16:00:07.160

试一试：

```
select u.user_id, u._date,
    sum(_time <= '16:00') as before16,
    sum(_time > '16:00') as after16
from (
    select m.user_id, d._date
    from messages m
        cross join date_range d
    group by m.user_id, d._date
    ) u
    left join messages m on u.user_id=m.user_id
                        and u._date=m._date
group by u.user_id, u._date 
```

内部查询只是构建一组所有可能/所需的用户日期对。使用 users 表会更有效，但你没有提到你有一个，所以我不会假设。否则，您只需要不`left join`删除未加入的记录。

**编辑** ——更详细的解释：将查询分开。

从最里面的查询开始；目标是为每个用户获取所有所需日期的列表。由于有一个用户表和一个日期表，它看起来像这样：

```
select distinct u.user_id, d.d_date
from users u
  cross join date_range d 
```

这里的关键是`cross join`，获取表中的`users`每一行并将其与表中的每一行相关联`date_range`。`distinct`关键字实际上只是所有列上的 a 的简写，这里`group by`是为了以防有重复数据。

请注意，还有其他几种方法可以获取相同的结果集（例如在我的原始查询中），但从逻辑和计算的角度来看，这可能是最简单的。

实际上，唯一的其他步骤是添加`left join`（将我们上面得到的所有行与所有可用数据相关联，并且不删除任何没有任何数据的内容）以及`group by`与`select`之前基本相同的组件。所以，把所有东西放在一起看起来像这样：

```
select t.user_id, t.d_date,
  sum(m.m_time <= '16:00') as before16,
  sum(m.m_time > '16:00') as after16
from (
    select distinct u.user_id, d.d_date
    from users u
      cross join date_range d
  ) t
  left join messages m on t.user_id = m.user_id
                      and t.d_date = m.m_date
group by t.user_id, t.d_date 
```

基于其他一些评论/问题，请注意对所有表和子查询的所有使用都显式使用前缀（这非常简单，因为我们不再多次使用任何表）：`u`对于`users`表，`d`对于`date_range`表，`t`用于包含用于每个用户的日期的子查询，以及`m`用于`message`表。这可能是我的第一个解释有点短的地方，因为我两次使用消息表，两次都使用相同的前缀。由于两种用途的上下文（一个在子查询中），它在那里工作，但它可能不是最佳实践。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:27:36.517

它不整洁。但如果你有一张`user`桌子。然后可能是这样的：

```
SELECT 
    user_id, 
    _date, 
    SUM(_time <= '16:00') AS before16, 
    SUM(_time > '16:00') AS after16 
FROM messages 
GROUP BY user_id, _date
UNION
SELECT
    user_id,
    date_range,
    0 AS before16, 
    0 AS after16 
FROM
    users,
    date_range
ORDER BY user_id, _date ASC 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T15:22:22.120

chezy525 的解决方案效果很好，我将它移植到 postgresql 并删除/重命名了一些别名：

```
select users_and_dates.user_id, users_and_dates._date,
    SUM(case when _time <= '16:00' then 1 else 0 end) as before16,
    SUM(case when _time > '16:00' then 1 else 0 end) as after16
from (
    select messages.user_id, date_range._date
    from messages 
        cross join date_range 
    group by messages.user_id, date_range._date
    ) users_and_dates
    left join messages  on users_and_dates.user_id=messages.user_id
                    and users_and_dates._date=messages._date
group by users_and_dates.user_id, users_and_dates._date; 
```

并在我的机器上运行，完美运行

# multithreading - 如何在排序算法模拟期间操纵线程的速度

> ID：10126583
> 
> 赞同：0
> 
> 时间：2012-04-12T15:17:59.573
> 
> 标签：multithreading, model-view-controller, user-interface, sorting

我的问题是关于我目前正在从事的一个 Java 项目。我必须建立一个模拟来从概念上/视觉上展示各种不同排序算法的工作原理。其中包括：冒泡排序、插入排序、归并排序等。这必须允许用户逐步完成流程的每个步骤或选择他们希望执行的速度。这必须使用线程来完成。排序算法都在一个类中，用户从端选择的任何一个都将在线程中运行。

例如 sort.bubbleSort(objects); < objects 是要排序的对象数组。

我的问题是我不知道如何操纵线程的速度。例如，我需要一步一步地在算法的每一行执行后暂停。该项目还实现了 MVC。线程在 Contoller 包中，排序类在 Model 中。任何可以帮助我的人都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:34:34.710

我没有任何灵丹妙药类型的解决方案。我认为你将不得不`Thread.sleep(...)`在不同的地方调用你的代码。

```
public class BubbleSort {
    private long sleepBetweenIterationsMillis;
    public BubbleSort(long sleepBetweenIterationsMillis) {
       this.sleepBetweenIterationsMillis = sleepBetweenIterationsMillis;
    }

    ...
    // iterate through the list bringing the highest value to the top
    // wait a certain number of millis
    Thread.sleep(sleepBetweenIterationsMillis);
    // loop
    ...
} 
```

选择排序算法中的点来放置这些睡眠调用取决于您认为“迭代”是什么。除了注入睡眠值之外，您还可以调用某个睡眠管理器，该管理器可以动态更改睡眠值或根据用户输入进行更改。

```
public interface SleepManager {
   public void sleep();
}

public class BubbleSort {
    private SleepManager sleepManager;
    public BubbleSort(SleepManager sleepManager) {
       this.sleepManager = sleepManager;
    }

    ...
    // iterate through the list bringing the highest value to the top
    // call the manager which can dynamically slow or speed up the iterations
    sleepManager.sleep();
    // loop
    ...
} 
```

我无法评论 MVC 问题。您将不得不围绕您尝试过的内容和想要完成的内容写另一个更具体的问题。

# java - Java Swing 中的动画线条

> ID：10126590
> 
> 赞同：1
> 
> 时间：2012-04-12T15:18:20.290
> 
> 标签：java, swing, animation, amazon-ec2

我目前正在编写用于创建监控工具的代码，该工具可以监控亚马逊网络服务和亚马逊云，并可视化我当前运行的云基础设施。

例如，如果 CPU 利用率或网络 I/O 增加了某个阈值，而不是调用自动缩放并将 EC2 的新实例添加到系统中，则此代码运行良好，但现在我在 GUI 上可视化此东西显示此活动的工具。我正在使用 Java Swing 创建监控工具。

我需要的主要帮助如下：

我在框架顶部可视化客户端，在客户端下方显示 EC2 实例，只是为了显示客户端和服务器之间的逻辑连接，我在客户端和 EC2 实例之间画线。

现在我需要对这些线进行动画处理——也许一条缓慢移动的描边线只是为了表明客户端和 EC2 实例之间存在一些流量，我还希望线条中的动画或描边移动的速度随着流量的增加而增加。（可能是设置动画速度的变量）。

我需要有关如何在 Java Swings 中实现此类动画线条的帮助。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:38:37.270

这是一个从零开始完全绘制和动画的移动虚线的小例子：

```
private static int speed = 5;

public static void main ( String[] args )
{
    JFrame frame = new JFrame ();
    frame.setLayout ( new BorderLayout () );

    frame.add ( new JComponent ()
    {
        private int diff = 0;

        {
            final Timer timer = new Timer ( 1000 / ( 10 * speed ), null );
            timer.addActionListener ( new ActionListener ()
            {
                public void actionPerformed ( ActionEvent e )
                {
                    if ( diff < 20 )
                    {
                        diff++;
                    }
                    else
                    {
                        diff = 0;
                    }
                    repaint ();
                    timer.setDelay ( 1000 / ( 10 * speed ) );
                }
            } );
            timer.start ();
        }

        protected void paintComponent ( Graphics g )
        {
            Graphics2D g2d = ( Graphics2D ) g;
            g2d.setRenderingHint ( RenderingHints.KEY_ANTIALIASING,
                    RenderingHints.VALUE_ANTIALIAS_ON );
            g2d.setStroke (
                    new BasicStroke ( 5f, BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND, 1f,
                            new float[]{ 10f, 10f }, diff ) );
            g2d.setPaint ( Color.BLACK );
            g2d.drawLine ( 0, getHeight () / 2, getWidth (), getHeight () / 2 );
        }
    } );
    frame.add ( new JSlider ( JSlider.HORIZONTAL, 1, 10, speed )
    {
        {
            addChangeListener ( new ChangeListener ()
            {
                public void stateChanged ( ChangeEvent e )
                {
                    speed = getValue ();
                }
            } );
        }
    }, BorderLayout.SOUTH );
    frame.setSize ( 500, 500 );
    frame.setLocationRelativeTo ( null );
    frame.setVisible ( true );
} 
```

基本上，对于动画，您需要绘制大部分想要制作动画的东西。在您的情况下，如果它是用虚线连接的两个对象 - 您可以使用绘制该连接的容器并仅放置在其上的简单 Swing 组件。所以它会检测它们的边界并绘制连接线......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T20:08:49.013

动画一个`BasicStroke`. 有关示例代码，请参[见此答案](https://stackoverflow.com/a/9772978/418556)。

![](../Images/295fe679922e73d0a946a597683d1dea.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:38:46.220

使用 JPanel 并覆盖它的`paintComponent()`方法。这个方法将负责动画。

```
public void paintComponent(Graphics g)
 {
 super.paintComponent(g);
 g.setColor(Color.red); 
 g.drawLine(x1,y1,x2, y2); 
} 
```

需要时再次增加 x2。在您的情况下，需要在服务器处理新连接时增加 x2。希望这会帮助你。

# java - 如何打败这个 java.net.ProtocolException：Android 中已经建立了连接

> ID：10126591
> 
> 赞同：1
> 
> 时间：2012-04-12T15:18:28.553
> 
> 标签：java, android

我有这个代码来提出请求。

```
@Override
protected Boolean doInBackground(Object... argList) {
/*
* filling all the variables here..
String method = (String) argList[3];
**/
HttpsURLConnection connection = null;
try {
     URL connectURL = new URL(url);
     connection = (HttpsURLConnection) connectURL.openConnection();
     connection.setRequestProperty("connection", "close");
     connection.setRequestMethod(method); // this line 
 connection.setReadTimeout(10000);

/*
* futher code for process GET AND POST Request.
**/
 } catch (IOException e) {
     connection.disconnect();
 } finally{
     connection.disconnect();
   } 
```

### 例外

```
04-12 19:30:27.147: WARN/System.err(431): java.net.ProtocolException: Connection already established
04-12 19:30:27.419: WARN/System.err(431):     at java.net.HttpURLConnection.setRequestMethod(HttpURLConnection.java:429)
04-12 19:30:27.447: WARN/System.err(431):     at org.apache.harmony.luni.internal.net.www.protocol.https.HttpsURLConnectionImpl.setRequestMethod(HttpsURLConnectionImpl.java:127)
04-12 19:30:27.487: WARN/System.err(431):     at com.app.services.AppServiceManager.doInBackground(AppServiceManager.java:297)
04-12 19:30:27.526: WARN/System.err(431):     at com.app.services.AppServiceManager.doInBackground(AppServiceManager.java:1)
04-12 19:30:27.559: WARN/System.err(431):     at android.os.AsyncTask$2.call(AsyncTask.java:185)
04-12 19:30:27.617: WARN/System.err(431):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
04-12 19:30:27.636: WARN/System.err(431):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
04-12 19:30:27.716: WARN/System.err(431):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
04-12 19:30:27.751: WARN/System.err(431):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
04-12 19:30:27.798: WARN/System.err(431):     at java.lang.Thread.run(Thread.java:1096) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:47:23.890

恕我直言，您最好使用 Apache HTTP 类。它们只是比 Java 具有的烘焙 URL 更有意义，并且直接在 Android API 中有一个端口：

[http://developer.android.com/reference/org/apache/http/package-summary.html](http://developer.android.com/reference/org/apache/http/package-summary.html)

然后我会将它传递给您的 AsyncTask，因为它是超类：

```
HttpUriRequest request = new HttpPost(uri):
// ... configure 
```

或者

```
HttpUriRequest request = new HttpGet(uri)
// ... configure 
```

您的 AsyncTask 看起来像：

```
new AsyncTask<HttpUriRequest, Void, ResultClass>(){

    public ResultClass doInBackground(HttpUriRequest... requests) {

        HttpClient client = new DefaultHttpClient();
        HttpResponse response = client.execute(requests[0]);

        // handle the response
        return instanceOfResultClass;
    }

    // ... 

}.execute(request); 
```

你明白了，希望。:)

# php - png 图像的透明度问题

> ID：10126594
> 
> 赞同：1
> 
> 时间：2012-04-12T15:18:44.527
> 
> 标签：php, gd, alpha-transparency

我有这张图片： ![白色背景的原始图像](../Images/d85b0080bfc10e8a48e14eb540ce51bb.png)

我使用 php5 和 gd2 库来实现透明背景，但结果不是我所期望的（您需要深色背景才能看到差异）：![透明背景](../Images/2e433e245e9ce6485d7f4f5ed6f12d30.png)

这是我的代码：

```
$size = getimagesize($img_url);
$img = imagecreatefrompng($img_url);
$im_tc = imagecreatetruecolor($size[0],$size[1]);
imagecopyresampled($im_tc,$img,0,0,0,0,$size[0],$size[1],$size[0],$size[1]);
imagedestroy($img);
$white  = imagecolorallocatealpha($im_tc, 255, 255, 255,127);
imagecolortransparent($im_tc, $white);
imagepng($im_tc,'image.png'); 
```

任何帮助，将不胜感激！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:24:02.833

您的原始图像没有透明背景，但您试图通过将所有纯白色像素更改为透明来创建一个。由于文本周围有阴影/发光，这些像素不是很白，也不会变得透明。你有几个选择：

*   使用图像编辑器（GIMP、Photoshop 等）及其细粒度选择工具对“背景”进行智能选择，然后将其删除。至少，Photoshop 在其魔棒工具上提供了非常有用的选项来选择阈值、羽化等。
*   选择更多颜色以使“透明”。不只是白色，而是选择所有灰色阴影，减去“.gr”设置的确切颜色。这应该使图像的所有阴影部分也透明，尽管边缘可能不太完美（即：没有羽毛，略呈锯齿状。）

# c# - 如果对象有效，则 StackOverflow 与 TryValidateObject

> ID：10126599
> 
> 赞同：2
> 
> 时间：2012-04-12T15:19:04.183
> 
> 标签：c#, data-annotations

我`Validator.TryValidateObject()`用来验证使用数据注释的对象。当对象无效时，代码执行良好。但是，如果它有效，则会产生 stackoverflow 错误。

这是我的方法：

```
public virtual IEnumerable<ValidationResult> Validate(ValidationContext vc)
{
    vc = new ValidationContext(this, null, null);
    List<ValidationResult> a = new List<ValidationResult>();

    Validator.TryValidateObject(this, vc, a,true);

    foreach (var item in a)
        yield return item;

    if (Name == "Arbitary")
        yield return new ValidationResult("Bad Name.", new[] { "Name" });

} 
```

似乎这也在`TryValidateObject`内部调用我的方法`Validate`。

我使用此方法的目标是验证我的对象的所有 DataAnnotations，然后添加一些复杂的验证逻辑 - 所以我假设`TryValidateObject`会检查数据注释，然后我可以放置我自己的验证逻辑。

就目前而言，如果数据无效，我的方法将有效 - 它会报告从 DataAnnotations 生成的 ValidationResults，如果名称为“Arbitary”，还会添加一个 ValidationResult，但如果数据有效，我会得到这个 stackoverflow。

有任何想法吗？如何以不会导致调用我自己的`Validate`方法的方式验证对象的数据注释？或者，如何解决此堆栈溢出？

请注意，我的类实现了`IValidatableObject`接口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:26:31.887

Rather than inheriting from Validate could you implement your own data annotation attribute to perform custom validation, as per this SO question?

[How to create Custom Data Annotation Validators](https://stackoverflow.com/questions/3413715/how-to-create-custom-data-annotation-validators)

# wpf - 如何在wpf datagrid中显示数据集中的相关数据

> ID：10126602
> 
> 赞同：2
> 
> 时间：2012-04-12T15:19:17.447
> 
> 标签：wpf, datagrid, dataset, master-detail

我有一个包含两个表的数据集，一个简单的一对多父子关系。例如;

```
Parent Table
ParentId (int)
Name     (string)

Child Table
ChildId (int)
ParentId (int)
Name     (string) 
```

在这个数据集中，我在父 id 字段上建立了父子关系（ParentChildRelation）。如果我以编程方式进行 Parent.getChildRows() 调用，我会看到正确的相关子记录，因此我知道关系很好。

我需要显示一个带有父行列表的数据网格，并让另一个单独的数据网格显示所选父行的子记录列表。

到目前为止，在我后面的代码窗口中，我有

```
private DataSet _parentChildDataSet;
public DataSet ParentChildDataSet
{
    get
    {
        return _parentChildDataSet;
    }
    set 
    {
        _parentChildDataSet = value;
    }

    public DataView ParentView
    {
        get
        {
            return this.ParentChildDataSet.Tables["Parent"].DefaultView;
        }
    }

    public DataRelation ParentChildRelation
    {
        get
        {
            return this.ParentChildDataSet.Relations["Parent_Child"] ;
        }
    } 
```

我还在窗口构造函数中将窗口的数据上下文设置为自身，例如；

```
this.DataContext = this; 
```

在我的 xaml 中

```
<Grid>
    <DataGrid ItemsSource="{Binding Path=ParentView}" AutoGenerateColumns="True" Name="dataGrid1">
    </DataGrid>
    <DataGrid ItemsSource="{Binding Path=ParentChildRelation}" Name="dataGrid2" AutoGenerateColumns="False">
        <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding Path=Name}" Header="Name" />
        </DataGrid.Columns>
    </DataGrid>
</Grid> 
```

但是我无法让任何子记录显示在 dataGrid2 中。

我将此网格绑定到数据关系名称是正确的吗？

如果我绑定到我的窗口上的另一个属性；

```
 public DataView ChildrenView
    {
        get
        {
            return this.ParentChildDataSet.Tables["Child"].DefaultView;
        }
    } 
```

然后我会看到所有记录，无论父母如何，正如您所期望的那样。

感谢任何人都可以给我的任何指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T16:08:19.343

当您返回 DataView 时，它正在工作但显示全部。

在这里你返回一个 DataRelation

```
ItemsSource="{Binding Path=ParentChildRelation}" 
```

您需要返回一个 DataView

使用关系生成 DataView

DataRowView.CreateChildView 方法（DataRelation）

# c - 避免在代码中使用 google oauth2 客户端密码

> ID：10126611
> 
> 赞同：2
> 
> 时间：2012-04-12T15:19:49.613
> 
> 标签：c, oauth-2.0

我正在编写一个通过 Oauth2 连接到 google api 的小型 c 程序。因此我需要向谷歌发送一个客户端密码。我将这个秘密存储在我的代码中，我想将其推送到 github，但是我怎样才能避免向所有查看我的代码的人展示我的客户秘密呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:23:59.247

在代码中存储秘密（理想情况下是任何字符串文字）是错误的 - 将其存储在资源（文本）文件中，不要将其推送到 Git。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:24:02.520

使用配置文件来存储 API 密钥...您有很多选择，最简单的是将密钥直接写入文件，更复杂的是使用某种序列化程序（如 json、xml、inifile 等... )，正确的选项取决于您（通常，如果您想在文件中存储多个选项，则需要序列化）。

如果您不介意密钥在主机的进程列表中可见，您也可以将密钥设置为程序参数。

并且确保不要将您已经存在的 git 历史记录推送到 git hub，而是创建一个新的存储库，否则您以前的所有补丁（带有密钥）都将是公开的；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-20T07:08:45.683

如果您正在寻找在***哪里可以找到***您的 Google Drive apss 的客户端密码。然后按照这个步骤。

1.  转到您的项目
2.  单击凭据。

> 之后，您将获得有关您的项目的所有详细信息，例如*客户端 ID、重定向 uri*等。但是您将在此处单击“**下载 Jason** ”按钮，下载文件后，您将获得您的 CLIENT SECRET。请看图片。

![在此处输入图像描述](../Images/4ce7ab3b16857d04fed43962dfbc127e.png)

# asp.net - 服务 app_offline.htm 时将 http 状态 404 更改为 503

> ID：10126617
> 
> 赞同：2
> 
> 时间：2012-04-12T15:20:01.470
> 
> 标签：asp.net, iis-7.5

我们添加了 app_offline.htm。所有请求都返回“正在重建的站点”和 404 错误。我可以为返回 503 错误做什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T08:53:54.613

我们使用asp.net 2.0。我创建了新的池 ASP.NET 4.0 并将网站附加到它。然后返回的http状态是503。

澄清一下，当使用 app_offline.htm 时，ASP.NET 2 返回 404，而 ASP.NET 4 返回 503 状态码。

# php - 我对 oops 感到困惑，我对 oops 中的抽象类扩展和接口实现感到困惑

> ID：10126618
> 
> 赞同：-4
> 
> 时间：2012-04-12T15:20:03.350
> 
> 标签：php, oop

问候！我不想了解更多关于抽象类和接口的信息。和术语继承，如抽象类扩展和接口实现。需要帮助。请解决我的问题。提供一些例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:39:08.890

抽象类是未实例化的类，因此不存在这样的事情：

```
<?php
   $p = new person();
?> 
```

抽象类只能被继承，不能直接使用。您将它用作基类，您可以在其中放置其他类可以共享的所有代码。

接口就像一个类必须实现的方法的协议：

```
// Declare the interface 'iExample'
interface iExample
{
    // methodes
}

// Implement the interface
// This will work
class Thingy implements iExample
{
    // implement the methodes specifies in the interface
} 
```

# ruby - 将不同数组的元素加在一起

> ID：10126621
> 
> 赞同：0
> 
> 时间：2012-04-12T15:20:16.087
> 
> 标签：ruby, arrays, csv

我正在尝试使用 CSV 计算三个数字的平均值并将其输出到单独的文件中。特别是，打开一个文件，取第一个值（名称），然后计算接下来三个值的平均值。对文件中的每个人多次执行此操作。

这是我的 Book1.csv

```
Tom,90,80,70
Adam,80,85,83
Mike,100,93,89
Dave,100,100,100
Rob,80,70,75
Nick,80,90,70
Justin,100,90,90
Jen,80,90,100 
```

我试图让它输出这个：

```
Tom,80
Adam,83
Mike,94
Dave,100
Rob,75
Nick,80
Justin,93
Jen,90 
```

我将每个人都放在一个数组中，我可以让它与我编写的基本“伪”代码一起工作，但它不起作用。到目前为止，这是我的代码：

```
#!/usr/bin/ruby
require 'csv'
names=[]
grades1=[]
grades2=[]
grades3=[]
average=[]
i = 0
CSV.foreach('Book1.csv') do |students|
  names << students.values_at(0)
  grades1 << reader.values_at(1)
  grades2 << reader.values_at(2)
  grades3 << reader.values_at(3)
end

while i<10 do
   average[i]= grades1[i] + grades2[i] + grades3[i]
   i= i + 1
end

CSV.open('Book2.csv', 'w') do |writer|
   rows.each { |record| writer << record }
end 
```

while 循环部分是我最关心的部分。有什么见解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:25:41.807

如果您有一个要求和的值数组，您可以使用：

```
sum = array.inject(:+) 
```

如果您将数据结构更改为：

```
grades = [ [], [], [] ]
...
grades[0] << reader.values_at(1) 
```

然后你可以这样做：

```
0.upto(9) do |i|
  average[i] = (0..2).map{ |n| grades[n][i] }.inject(:+) / 3
end 
```

有多种方法可以改进您的数据结构，以上是对您的代码影响最小的方法之一。

任何时候你发现自己在写作：

```
foo1 = ...
foo2 = ... 
```

您应该将其识别为代码异味，并考虑如何将数据组织到更好的集合中。

* * *

这是我如何做到这一点的重写。请注意，它适用于任意数量的分数，而不是硬编码为 3：

```
require 'csv'
averages = CSV.parse(DATA.read).map do |row|
  name, *grades = *row
  [ name, grades.map(&:to_i).inject(:+) / grades.length ]
end
puts averages.map(&:to_csv)
#=> Tom,80
#=> Adam,82
#=> Mike,94
#=> Dave,100
#=> Rob,75
#=> Nick,80
#=> Justin,93
#=> Jen,90

__END__
Tom,90,80,70
Adam,80,85,83
Mike,100,93,89
Dave,100,100,100
Rob,80,70,75
Nick,80,90,70
Justin,100,90,90
Jen,80,90,100 
```

# oracle - 关闭或不关闭 Oracle 连接？

> ID：10126623
> 
> 赞同：5
> 
> 时间：2012-04-12T15:20:16.850
> 
> 标签：oracle, connection, connection-string, connection-pooling, odp.net

我的应用程序有性能问题，所以我开始从根开始调查：“与数据库的连接”。

最佳实践说：“尽快打开连接，使用它并关闭”，但我不知道这会导致什么开销，所以问题是：

1 -“尽快打开、使用、关闭连接是使用 ODP.NET 的最佳方法吗？”

2 - 有没有办法以及如何将连接池与 ODP.NET 一起使用？我正在考虑创建一个列表来存储一些连接字符串并创建一个逻辑以在每次需要时选择“最佳”连接。这是最好的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-14T20:02:06.747

这是一个包含 Oracle 推荐的最佳实践的幻灯片：

[http://www.oracle.com/technetwork/topics/dotnet/ow2011-bp-performance-deploy-dotnet-518050.pdf](http://www.oracle.com/technetwork/topics/dotnet/ow2011-bp-performance-deploy-dotnet-518050.pdf)

创建 OracleConnection 时会自动获得一个连接池。对于大多数中间层应用程序，您将希望利用这一点。您还需要通过在注册表中打开性能计数器来调整池以适应实际工作负载。

有关连接池的详细信息，请参阅 ODP.NET 联机帮助。池设置被添加到连接字符串中。

人们在使用 OracleConnections 时经常遇到的另一个问题是，垃圾收集器没有意识到它们是真正的资源密集型，也没有及时清理它们。由于 ODP.NET 没有完全托管，因此一些资源对垃圾收集器隐藏，这使情况更加复杂。因此，最佳实践是关闭（）和处置（）所有 Oracle ODP.NET 对象（包括 OracleConnection）以强制清理它们。

这个特殊问题将在 Oracle 的完全托管提供程序中得到缓解（很快就会发布测试版）

（编辑：ODP.NET，托管驱动程序现在可用。）

克里斯蒂安·谢伊

甲骨文

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T16:58:13.927

ODP.NET 是 ADO.NET 的数据提供者。ADO.Net 的最佳实践是打开、获取数据（到内存）、关闭、在内存中使用数据。例如，使用 OracleDataReader 将数据加载到内存中的 DataTable 中并关闭连接。

[]的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T22:16:24.930

对于单个事务，这是最好的，但对于最后提交的多个事务，这可能不是最佳解决方案。您需要保持连接打开，直到事务提交或回滚。在这种情况下，您如何管理以及如何检查连接是否仍然存在？（即网络故障）此时有 ConnectionState.Broken 属性不起作用。

# windows-7 - Windows 2008 远程桌面不会复制+粘贴

> ID：10126624
> 
> 赞同：3
> 
> 时间：2012-04-12T15:20:19.317
> 
> 标签：windows-7, windows-server-2008-r2, remote-desktop

我刚刚设置了一个 Guest Windows 2008 R2 Standard Edition 64bit（Windows 7 64 位主机上的 VirtualBox）进行一些测试。

我发现在远程桌面环境“内部”（即我从主机远程访问来宾 ip）时，复制和粘贴不起作用。当我说“不起作用”时，让我明确一点。

*   假设我通过 RDC 登录到 Win2008 机器
*   复制/粘贴缓冲区中没有任何内容。我可以鼠标单击一些文本，然后单击复制。然后我可以右键单击并单击“粘贴”，但没有任何反应。我可以看到“选择”已启用粘贴但没有任何反应。插入符号保持不变。
*   CTRL+C / CTRL-V / CTRL-X 在 RDC 领域不起作用
*   我不是在谈论在复制/粘贴 RDC 土地/主机土地之间进行。

这是双重打击：当我执行上述操作时，它会“感染”我的主机 PC，因此那里也无法使用复制粘贴。如果 PRT SCR 不再工作。

我努力了：

*   重新启动来宾操作系统和主机操作系统
*   在组策略编辑器中，我禁用了“不允许剪贴板重定向”（我不能给你这个复制/粘贴的完整路径，刚刚又坏了）
*   我已确保在 RDC 中本地资源的“选项”包括剪贴板。
*   注意：如果我根本不触摸 RDC 并通过控制台复制粘贴登录来宾操作系统，效果很好

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-11-08T10:08:28.767

使用任务管理器终止`rdpclip.exe`进程。然后，创建一个名为`rdpclip.exe`. 这将解决您的问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-08-24T12:52:06.093

请按照远程计算机中的这些步骤操作。

## **停止 rdpclip 进程**

1.  打开任务管理器。
2.  转到进程选项卡并找到`rdpclip`
3.  选择`rdpclip`并结束该任务。

## **启动 rdpclip.exe**

4.  转到开始菜单并打开运行命令
5.  打开**rdpclip.exe**并单击确定按钮。

[![在此处输入图像描述](../Images/2fc2a6e1dbd64d50e57f00f7180b094b.png)](https://i.stack.imgur.com/DMBCy.jpg)

复制粘贴现在应该可以工作了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T10:21:27.690

（在 VirtualBox 中）设置->常规->[高级]->共享剪贴板 {禁用}

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T10:16:08.530

看来这是 VirtualBox 的一个缺陷

这些帖子涵盖了它

[https://forums.virtualbox.org/viewtopic.php?f=6&t=44498](https://forums.virtualbox.org/viewtopic.php?f=6&t=44498)（阅读最后一篇文章）

[https://github.com/FreeRDP/FreeRDP/issues/230](https://github.com/FreeRDP/FreeRDP/issues/230)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-01T14:06:04.053

有很多事情要检查。

如果复制/粘贴偶尔失败，重新启动**rdpclip.exe**是值得尝试的，这意味着我们可能会在前一个会话中的进程上。

在客户端，我们检查 RDP 选项。单击底部的 Show Options 按钮，选择第三个选项卡**Local Resources**。确保选中**剪贴板。**

[![rdp](../Images/24d7aa7fe961c97f3864be522abed8d5.png)](https://i.stack.imgur.com/OxuTV.png)

在远程服务器端，我们要检查**远程桌面会话主机配置**（Win Server 2008+）。

[![在此处输入图像描述](../Images/5e21db8a64f2e61c104d47f4394728da.png)](https://i.stack.imgur.com/IFeHA.png)

双击连接以打开其属性窗口。

[![在此处输入图像描述](../Images/1438fac78c5bec4852b93a9f6d69261c.png)](https://i.stack.imgur.com/y0auB.png)

在名为**Client Settings**的选项卡中，确保**剪贴板**未被禁用。

[![在此处输入图像描述](../Images/28a98ffd2042e5b74e9e669d061c3edf.png)](https://i.stack.imgur.com/P7MI0.png)

我们需要从远程桌面注销。

[![在此处输入图像描述](../Images/80a669b8b480132349ba6f37143b1a77.png)](https://i.stack.imgur.com/FJjvf.png)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-11-28T23:40:22.937

## 解决方法

使用这样的在线共享文本框：

[https://pastebin.com/](https://pastebin.com/)

# visual-studio-2010 - 将 VBscript 转换为 VB 错误（检查正确的字符）

> ID：10126626
> 
> 赞同：0
> 
> 时间：2012-04-12T15:20:24.957
> 
> 标签：visual-studio-2010, vbscript

以下代码是用 vbscript 编写的，我正在转换为 Visual Basic。

在以下行中：`If Right(LCase(oFile.Name), 3) = "pdf" Then`我收到以下错误：在为其赋值之前使用了变量“Right”。运行时可能会导致空引用异常。也是说对象变量或未设置块变量。

据我所知，我相信它正在检查以确保文件名正确的 3 个字符是“pdf”？

```
For Each oFile In oFolder.Files
        If Right(LCase(oFile.Name), 3) = "pdf" Then

            Data = Replace(oFile.name, ".pdf", "")
            Data = Replace(oFile.name, ".PDF", "")

            Data = Split(Data, "-")
            acct = Data(1)
            lob = Data(2)

            fileName = clientid & "-" & acct & "-" & lob & "-" & speciesid & "-" & seq & ".pdf"

            outputLine = acct & "," & speciesid & "," & lob & "," & oFile.Name & "," & inputDate

            oOutFile.WriteLine(outputLine)

        End If
    Next 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T16:13:52.647

你需要把：

```
Imports Microsoft.VisualBasic 
```

在您的程序开始时。“Right”是这个命名空间中的一个函数。

[http://msdn.microsoft.com/en-us/library/dxs6hz0a(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/dxs6hz0a(v=vs.80).aspx)

# layout - 创建带有居中按钮的 2x2 按钮网格？

> ID：10126628
> 
> 赞同：0
> 
> 时间：2012-04-12T15:20:27.323
> 
> 标签：layout, extjs, sencha-touch-2

我有一个 2x2 按钮网格。现在我想将按钮缩小到 200x200，将每个按钮放在一个容器中作为空间占位符，然后将每个按钮放在其各自容器中的中心。

在我的图像中，我只缩小了顶部的两个按钮，以便您可以看到页面上的间距。我怎样才能从第一张图像转到第二张经过 Photoshop 处理的图像？

![在此处输入图像描述](../Images/d20f32807c7747ae06eed1f5b6bf5a23.png)

目标：（实际上，所有 4 个居中的按钮都是目标） ![在此处输入图像描述](../Images/2795e93a7fd8b2274a0f93fd7d4fc2df.png)

文件：app.js

```
分机应用程序（{

    启动：函数（）{
        var view = Ext.create('Ext.Container', {
            布局： {
                类型：'vbox'
            },
            项目： [
                {
                    xtype: '容器',
                    布局：'hbox'，
                    弹性：1，
                    项目：[
                        {
                            xtype: '容器',
                            布局：'hbox'，
                            弹性：1，
                            项目：[
                                {
                                    xtype:'按钮',
                                    文字：'家'，
                                    ui：'简单'，
                                    样式：'背景颜色：#c9c9c9'，
                                    身高：200，
                                    宽度：200
                                }
                            ]
                        },
                        {
                            xtype: '容器',
                            布局：'hbox'，
                            弹性：1，
                            项目：[
                                {
                                    xtype:'按钮',
                                    文本：'新闻'，
                                    ui：'简单'，
                                    样式：'背景颜色：#b9b9cb'，
                                    身高：200，
                                    宽度：200
                                }
                             ]
                        }
                    ]
                },
                {
                    xtype: '容器',
                    布局：'hbox'，
                    弹性：1，
                    项目：[
                        {
                            xtype:'按钮',
                            文本：'邮件'，
                            ui：'简单'，
                            样式：'背景颜色：#a9c9c9'，
                            弹性：1
                        },
                        {
                            xtype:'按钮',
                            文本：'搜索'，
                            ui: '搜索',
                            样式：'背景颜色：#c9c9c9'，
                            弹性：1
                        }
                    ]
                }
            ]
        });
        Ext.Viewport.add(view);
    }
});

```

文件：index.html

```
<!doctype html>
<html manifest="" lang="zh-CN">
<头部>
    <meta charset="UTF-8">
    <title>煎茶</title>
    <link rel="stylesheet" href="http://extjs.cachefly.net/touch/sencha-touch-2.0.0/resources/css/sencha-touch.css" type="text/css">
    <script type="文本/javascript"
    src="http://extjs.cachefly.net/touch/sencha-touch-2.0.0/sencha-touch-all-debug.js"></script>
    <script type="text/javascript" src="app.js"></script>
<正文>
</正文>
</html>

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:51:03.000

只需添加`centered:true`到所有按钮的配置中。

祝你好运。

**P/S：该配置实际上将您的组件设置为其父**组件的中心（水平和垂直）。

# ios - UIDocument openWithCompletionHandler 未在 iOS 设备上完成

> ID：10126630
> 
> 赞同：11
> 
> 时间：2012-04-12T15:20:33.693
> 
> 标签：ios, iphone, cocoa-touch, objective-c-blocks, uimanageddocument

我正在尝试使用打开托管文档`openWithCompletionHandler:`

我遇到的问题是它在模拟器上运行良好，但是当我在我的 iPhone 4 上测试它时，完成处理程序永远不会完成。代码如下所示：

```
[theManagedDocument openWithCompletionHandler:^(BOOL success){
    if(success) [self documentIsReady];
    if(!success) NSLog(@"Couldn't Open Document");
}]; 
```

这在模拟器上运行良好，我可以`documentIsReady`拨打电话（或者如果出现错误，则会出现“无法打开文档”）。但在 iPhone 4 上，它从不运行 CompletionHandler 块。我已经在整个块中放置了断点（在两个 if 语句之前和之后）并且没有被调用。控制台上没有“无法打开文档”，没有调用`documentIsReady`.

我还必须提到，我第一次在 iPhone 上运行该应用程序时，它似乎可以正常工作。我也将此封装在带有`fileExistsAtPath:`调用的 if 语句中。它可以很好地进入 if 语句并调用`openWithCompletionHandler:`，但**完成块永远不会被触发**。

我正在使用 iOS 5.1 和 Xcode 4.3.2。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T21:42:15.480

我在使用 iCloud 共享数据的应用程序中遇到了同样的问题。我意识到，`openWithCompletionHandler:`如果文档被暂停的应用程序保持打开状态，则只是等待并且永远不会调用完成处理程序。如果您是这种情况，您应该确保在您的应用程序进入后台时关闭文档。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-24T21:37:05.127

在我的情况下，关闭我的 iPad 并重新启动它“修复”了这个问题。祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-16T12:38:44.493

尝试在调用之前检查 theManagedDocument != nil - 这是我能想到的为什么该块不会被执行的唯一原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-25T16:17:13.147

可能为假的另一个原因`success`是您更改了模型（例如向实体添加了属性），但没有从模拟器/设备中删除应用程序以更新模型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-14T12:30:40.160

对我来说，这是因为我正在调用`openWithCompletionHandler:`后台线程。将其更改为从主线程调用修复了挂起

```
dispatch_async(dispatch_get_main_queue(), ^{
    ...
    [document openWithCompletionHandler:^(BOOL success) {
        ...
    }];
}); 
```

# wix - 在不弄乱用户桌面图标的情况下进行 wix 升级的模式

> ID：10126631
> 
> 赞同：5
> 
> 时间：2012-04-12T15:20:33.670
> 
> 标签：wix, upgrade, shortcut, desktop-shortcut

我正在处理的 Wix 设置询问用户是否从桌面上的主程序安装快捷方式。

**问题是在升级过程中，快捷方式被删除然后重新创建：**

*   如果用户移动了图标，它可能会在其他地方重新创建（下一个可用空间从左上角开始）
*   如果用户在初始安装期间选择不创建图标，则使用 UI 的升级不会记住默认情况下创建图标的复选框应为“未选中”，并且静默升级只会创建图标，尽管用户明确选择不拥有这个图标创建。

**有没有一种简单的方法来正确处理这种情况？**

以下是有关我的 wix 设置的信息：

安装是每台机器

用户通过在“选择目标”的修改版本上添加的复选框选择安装桌面快捷方式：

```
<Control Id="DesktopShortcutCheckBox" Type="CheckBox" X="20" Y="160" Width="290" Height="17" Property="INSTALLDESKTOPSHORTCUT" CheckBoxValue="[INSTALLDESKTOPSHORTCUT]" Text="!(loc.InstallDirDlgCreateDesktopShortcut)" /> 
```

在 UI 标记中，我初始化了属性：

```
<Property Id="INSTALLDESKTOPSHORTCUT" Value="1"/> 
```

这是使用 INSTALLDESKTOPSHORTCUT 条件创建快捷方式的组件：

```
<Directory Id="DesktopFolder" Name="Desktop">
    <Component Id="desktopconnecteurdts" Guid="a-real-guid-here">
        <Condition>INSTALLDESKTOPSHORTCUT=1</Condition>
        <Shortcut Id="desktopconnecteurdts" Name="DTS eXplorer" WorkingDirectory="ApplicationFolder" Icon="DTSeXplorer.exe" Target="[ApplicationFolder]\DTSeXplorer.exe" Advertise="no" />
    </Component>
</Directory> 
```

启动时，安装程​​序将检查是否存在旧版本，如果发现则删除旧版本：

```
<Upgrade Id="$(var.UpgradeCode)">
    <UpgradeVersion OnlyDetect="no"
                    Property="PREVIOUSVERSIONSINSTALLED"
                    Minimum="$(var.OldProductVersion)"
                    IncludeMinimum="yes"
                    Maximum="$(var.ProductVersion)"
                    IncludeMaximum="no" 
                    RemoveFeatures="all" />
    <UpgradeVersion OnlyDetect="yes" Property="PROJECT_DOWNGRADE"
                    Minimum="$(var.ProductVersion)" IncludeMinimum="no" />
</Upgrade> 
```

产品版本主要没有变化，例如我从 1.6.8.12345 升级到 1.7.2.56789

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T17:55:41.850

在安装过程中将 INSTALLDESKTOPSHORTCUT 的值写入注册表。每当您的安装程序启动时，您都可以读取注册表，如果该键存在，请将其设置为该属性的默认值。

但是，不确定您是否可以对桌面上快捷方式的位置做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T16:38:27.587

您可以仅使用 wix 保存和恢复快捷方式的设置。

您的财产必须看起来像这样。

```
<Property Id="INSTALLDESKTOPSHORTCUT" Value="1" Secure="yes">
  <RegistrySearch Id="Reg64" Root="HKLM" Win64="yes" Key="Software\$(var.ProductCompany)" Name="CreateDesktopShortcut" Type="raw"></RegistrySearch>
  <RegistrySearch Id="Reg32" Root="HKLM" Win64="no" Key="Software\$(var.ProductCompany)" Name="CreateDesktopShortcut" Type="raw"></RegistrySearch>
</Property> 
```

这两个“RegistrySearch”仅适用于 32 位和 64 位安装程序，如果您只使用 32 位，则可以删除其中一个。

在你的根文件夹下添加这个。

```
<Component Permanent="yes" Id="RegistryEntries" Guid="YOUR_GUID">
  <RegistryKey Root="HKLM" Key="Software\$(var.ProductCompany)" Action="create">
    <RegistryValue Type="integer" Name="CreateDesktopShortcut" Value="[INSTALLDESKTOPSHORTCUT]" />
  </RegistryKey>
</Component> 
```

# javascript - 将 Fiddle 代码集成到布局中

> ID：10126633
> 
> 赞同：-3
> 
> 时间：2012-04-12T15:20:38.467
> 
> 标签：javascript, html, css, jsfiddle

在一个名叫 Michael 的 Stack Overflow 用户的帮助下，我能够让这个 jsFiddle 部门正确地下拉。但是，当我尝试实现 JavaScript、CSS 和 HTML 时，即使是在一个只有 jsFiddle 代码的新目录中，我也无法在点击时将分区下拉。实际上，它根本不会显示内容划分。我究竟做错了什么？

我猜我必须以某种方式错误地实现 JavaScript 代码。

jsFiddle 是[http://jsfiddle.net/WeL6j/12/](http://jsfiddle.net/WeL6j/12/)，

```
$(function() {
    $('.action').click(function() {
        var content = $(this).find('~ .content');
        $(this).parent().parent().find('.content').not(content).hide('fast');
        content.slideToggle('fast');
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:30:36.037

您需要在使用***之前***包含 jQuery ... 确保这一点的一个好方法是在编码**之前**`<script>`放置包含 jQuery 的标签。[或者您可以在阅读更多内容](http://net.tutsplus.com/tutorials/javascript-ajax/24-javascript-best-practices-for-beginners/)之前将您的代码移动到正文的底部**`</body>`**

 **```
<head>
<title></title>

<script language="JavaScript" type="text/javascript" src="jquery.js"></script>
<link rel="stylesheet" type="text/css" href="style.css" />

</head>

<body>
<div id="container"><ul>
    <li>
        <a href="#" class="action">summer</a>
        <div class="content">
            <a href="link">june</a>
            <a href="link">july</a>
        </div>
    </li>
    <li>
        <a href="#" class="action">winter</a>
        <div class="content">
            <a href="link">november</a>
            <a href="link">december</a>
        </div>
    </li>
    <li>
        <a href="#" class="action">weather</a>
        <div class="content">
            <a href="link">rain</a>
            <a href="link">sun</a>
        </div>
    </li>
    </ul></div><br>
<div id="div">
    </div>
<script type="text/javascript">
//$(function() { // ooo looky, i'm not actually needed now!
    $('.action').click(function() {
        var content = $(this).find('~ .content');
        $(this).parent().parent().find('.content').not(content).hide('fast');
        content.slideToggle('fast');
    });
//});?
</script>
</body> 
```**

# log4net - 如何更改 Log4Net 滚动文件附加程序创建新名称的方式？

> ID：10126634
> 
> 赞同：0
> 
> 时间：2012-04-12T15:20:39.820
> 
> 标签：log4net, log4net-configuration, rollingfileappender

假设我们当前的应用程序日志命名为 AppLog.log，这意味着滚动附加程序在某些时候会创建 AppLog.log.1、AppLog.log.2 等。我们有一个客户希望查看 AppLog.1.log、AppLog .2.log 等 我已经阅读了文档，但没有看到强制执行此操作的方法，因为大多数人更感兴趣的是在日志名称中插入日期或其他标记，而不是移动索引。有没有办法将该索引值移动到滚动附加程序的日志文件名的内部？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T09:34:18.390

如果您使用 log4net 1.2.11 或更高版本，则可以使用该`PreserveLogFileNameExtension`属性。

```
<preserveLogFileNameExtension value="true" /> 
```

# linux - Subversion post-commit 与不同的用户

> ID：10126637
> 
> 赞同：0
> 
> 时间：2012-04-12T15:20:49.460
> 
> 标签：linux, svn, tortoisesvn

我已经安装了颠覆并具有以下设置：

回购：
`/home/svn/tester (apache:apache)`

该网站是：
`/var/www/tester (tester:tester)`

我已经检查了测试仪回购`/var/www/tester`

在`/home/svn/tester/hooks/post-commit`我有：
`sudo -u tester /usr/bin/svn update /home/tester --username aaa --password bbb`

我想要做的是保留文件`/home/svn/tester = apache`
的所有者和文件的所有者`/var/www/tester = tester`

我已添加到`/etc/sudoers`：
`tester ALL=(ALL) NOPASSWD: /usr/bin/svn`

我已经注释掉了 requiretty `/etc/sudoers`：
`#Defaults requiretty`

运行提交后，我会收到以下消息（在 tortoisesvn 中）：

```
Commit failed (details follow):
MERGE of '/svn/tester': 200 OK (https://[site name]) 
```

我会以正确的方式解决这个问题吗？如果是这样，我怎样才能克服这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T11:58:59.950

您已将存储库配置在普通 Web 内容之下。

```
/var/_www_/tester 
```

那是行不通的：SVN 请求一些 DAV 的东西，但它只能得到正常的答案。这就是为什么`200 OK`在这种情况下实际上是一个错误。

将您的存储库移出`www`树，您应该没问题。

# oracle - apex 默认每页行数选项

> ID：10126638
> 
> 赞同：2
> 
> 时间：2012-04-12T15:20:51.460
> 
> 标签：oracle, oracle-apex

如何为交互式报告设置每页的默认行数？

我需要将此值应用于所有未覆盖此值的交互式报表。我需要它的原因如下：为每个创建的交互式报表设置必要的行数很麻烦，而且当更新该值时，它变成了一场噩梦。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T15:29:28.933

对于交互式报告，您可以修改显示的默认行数，方法是选择适当的行数，然后使用“另存为默认报告设置”选项保存报告（以 APEX 开发人员身份登录时）[。](http://apex.oracle.com/i/doc/TDPAX/interactive_reports.htm)

不幸的是，这必须应用于每个报告。

对于大规模更新，[OTN 上的一个帖子提到](https://forums.oracle.com/forums/thread.jspa?threadID=692800)：

> 在您的 apex 应用程序架构的 WWV_FLOW_WORKSHEET_RPTS 表中有一个 display_rows 列。您可以进行全局更新，其中 flow_id 等于您的 app_id。

这尚未经过验证，使用风险自负（Oracle 不支持）。

# java - ArrayDeque 不为空，但为 poll 方法返回 null

> ID：10126639
> 
> 赞同：1
> 
> 时间：2012-04-12T15:20:56.717
> 
> 标签：java, queue

我有这个代码（混淆）作为大型应用程序的一部分，它正在`NullPointerException`上`object.doSomething()`线。既然我们只是检查了`isEmpty()`调用，没有其他线程轮询这个队列，这怎么可能呢？还有其他线程添加到队列中；并发添加是否可能永久搞砸队列？

我尝试阅读源代码，`ArrayDeque`它`head == tail`用作检查`isEmpty()`. 在添加过程中是否可能发生一些奇怪的碰撞，`head != tail`但`head`指向`null`？

```
private final Queue<Task> active = new ArrayDeque<Task>();
if (!this.active.isEmpty()) {
    SomeType object = null;
    object = this.active.poll();
    object.doSomething();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:30:30.763

即使没有其他线程轮询，也可能有其他线程在推送。

这意味着在并发访问中，tail 可能会被错误地修改，如果 tail 被损坏，您可能永远无法`head == tail`到达`NullPointerException`.

正如@dacwe 所说，文档明确指出您（或此混淆应用程序的开发人员）不应`ArrayDeque`在并发环境中使用，这是并发可能出现的问题之一。

* * *

> **它们不是线程安全的**；在没有外部同步的情况下，它们不支持多线程并发访问。

* * *

如果你想要一个线程安全的[`Queue`](http://docs.oracle.com/javase/7/docs/api/java/util/Queue.html)你可以使用[`LinkedBlockingQueue`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/LinkedBlockingQueue.html)，如果你需要一个[`Dequeue`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/LinkedBlockingDeque.html)你可以使用[`LinkedBlockingDeque`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/LinkedBlockingDeque.html)。

* * *

**资源：**

*   [Javadoc：ArrayDeque](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayDeque.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:24:23.397

如[api](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayDeque.html)所述：

> 它们**不是线程安全的；**在没有外部同步的情况下，它们不支持多线程并发访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-05T20:07:45.387

您可以考虑访问同时回收双端队列已满`active.poll()`的旧元素[]的情况。`ArrayDequeue.doubleCapacity()`

一种可能的时间表：

1.  轮询线程签出`active.isEmpty()`返回 false
2.  轮询线程调用```active.pollFirst() 来访问非原子元素[]
3.  一个或多个其他线程`active.addLast()`突发调用，因此`active`已满并触发 doubleCapacity()
4.  在 doubleCapacity() 中，elements[] 被新分配的数组替换，这样旧的 elements[] 被 GC 回收
5.  轮询线程现在引用回收的元素 [] 并可能变为空。

我的猜测是，当队列不为空时，您希望避免同步轮询。为避免由于 doubleCapacity() 导致的竞争，请确保为队列分配了足够大的容量，并且在调用 addLast() 时不会满。但是，根据实际实施，您可能需要考虑其他竞赛。

以下来自 openJDK 的源代码附在后面，仅供参考。

```
public E pollFirst() {
    int h = head;
    @SuppressWarnings("unchecked")
    E result = (E) elements[h];
    // Element is null if deque empty
    if (result == null)
        return null;
    elements[h] = null;     // Must null out slot
    head = (h + 1) & (elements.length - 1);
    return result;
}

public void addLast(E e) {
    if (e == null)
        throw new NullPointerException();
    elements[tail] = e;
    if ( (tail = (tail + 1) & (elements.length - 1)) == head)
        doubleCapacity();
}

private void doubleCapacity() {
    assert head == tail;
    int p = head;
    int n = elements.length;
    int r = n - p; // number of elements to the right of p
    int newCapacity = n << 1;
    if (newCapacity < 0)
        throw new IllegalStateException("Sorry, deque too big");
    Object[] a = new Object[newCapacity];
    System.arraycopy(elements, p, a, 0, r);
    System.arraycopy(elements, 0, a, r, p);
    elements = a;
    head = 0;
    tail = n;
} 
```

# plone - 如何更新克隆自定义策略（例如 mysite.policy）附加组件

> ID：10126640
> 
> 赞同：2
> 
> 时间：2012-04-12T15:20:56.663
> 
> 标签：plone

当我第一次创建我的 Plone (4.1) 站点时，我制作了一个 mysite.policy 插件以包含一些自定义用户和自定义工作流程。

我需要对工作流程和权限进行一些更正。我更新了 src 以包含这些更改，但是通过 Plone 附加管理器（卸载 - 安装）更新包不起作用。一旦我卸载所有条目的状态就会切换到“本地策略”，所以当我重新安装时我无法恢复细粒度的状态设置。

此外，用户权限似乎没有改变。可能是因为它们已经在站点设置时创建。但是我不知道如何在 rolemap.xml 中编写权限更改与权限设置。我认为该 xml 中的任何内容都是我的克隆世界的规则，但这似乎不起作用。

到目前为止，我在手头的手册和书籍中找不到任何关于此的内容。任何提示如何解决这个问题？也许解决这个问题的唯一方法是通过 ZMI 进行一系列手动更改，但这样做就没有那么优雅了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T17:49:04.527

有很多选择。我将尝试描述其中的几个。

如果您的更改仅包括站点策略的通用设置配置文件（*./src/my/site/policy/profile/default/* -files）的更改，并且您不想*自动*升级，您可以简单地更新配置文件-文件并为您的策略重新运行这些特定的导入步骤：

1.  为您的站点打开 ZMI( `site/manage`) 并查找`portal_setup`.

2.  打开时选择*Import* -tab `portal_setup`。

3.  从 Select Profile或*Snapshot* -list 中选择您的站点策略的配置文件（您的配置文件的标题由您的策略产品中的*registerProfile*指令定义）。`configure.zcml``profiles.zcml`

4.  单击以选择*角色/权限映射*和*工作流工具*的导入步骤。

5.  从页面底部，取消选择*Include dependencies*。

6.  单击*导入选定的步骤*- 按钮。

7.  如果您的工作流程更新应该修改现有工作流程状态中的权限，请转到`portal_workflow`ZMI 上的 -tool 和*更新安全设置。*

这些步骤应仅重新导入站点策略产品的通用设置配置文件中选定的导入步骤。以这种方式重新导入单个步骤应该是非常安全的，但要小心：`portal_setup`屏幕上的意外点击可能会产生不可预知的后果。

这些步骤也可以通过定义一个叫做 Generic Setup *Upgrade Step*的东西来自动化。

1.  我希望您的站点策略产品的默认通用设置配置文件包含`metadata.xml`line `<version>1</version>`。

2.  将该行更新为`<version>2</version>`.

3.  使用 -directive打开`zcml`-file `registerProfile`，然后添加

    ```
    <genericsetup:upgradeDepends
        source="1" destination="2" sortkey="1"
        title="Upgrade my.site.policy (1 to 2)"
        description="Upgrades my.site.policy's default profile from version version 1 to 2."
        profile="my.site.policy:default"
        import_steps="rolemap workflow"
        run_deps="false"
        /> 
    ```

这些步骤应注册从配置文件版本 1 到 2 的升级步骤，该步骤重新导入步骤角色映射和*工作流*（*rolemap.xml*和*工作流**.xml*）。您应该能够从 Plone Site Setup 的附加组件屏幕运行升级步骤，在您安装的策略产品之后现在应该有一个升级按钮。

 ***正如@toutpt 所提到的，集体开发人员手册有[更多关于升级步骤的示例](http://collective-docs.readthedocs.org/en/latest/components/genericsetup.html?highlight=upgradestep#upgrade-steps)。如果您曾经想知道，为什么建议在 中使用整数`metadata.xml`，通常独立于产品的发布版本号'，这就是原因:)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T09:36:56.603

任何需要升级的更改必须通过增加 profile/default/metadata.xml 中的数字来显示（保持整数）。接下来，您必须编写升级步骤。它将在插件控制面板中添加一个升级按钮。

请按照本教程了解如何创建升级步骤：[http ://collective-docs.readthedocs.org/en/latest/components/genericsetup.html?highlight=upgradestep#upgrade-steps](http://collective-docs.readthedocs.org/en/latest/components/genericsetup.html?highlight=upgradestep#upgrade-steps)***

# python - Python 2.6.5 中的自定义异常处理和导入模块

> ID：10126641
> 
> 赞同：1
> 
> 时间：2012-04-12T15:20:57.483
> 
> 标签：python

我有一个带有自定义异常类的脚本，格式如下：

```
class DirectionError(Exception):
    pass 
```

我在同一个脚本中使用了以下形式的函数：

```
def func1(x):
    if x == 1:
        raise DirectionError 
```

我将函数调用以以下形式放入 try/except/except 块中：

```
try:
    func1(2)
except DirectionError:
    logging.debug("Custom error message")
    sys.exit()
except:
    logging.debug(traceback.format_exc()) 
```

随后，我将这些函数移到了单独的 mytools.py 文件中。我将 mytools.py 文件导入到我的主要 python 脚本中。

我将自定义异常类移动到 mytools.py 文件中，但异常没有到达主 python 脚本。

如何在 mytools.py 文件中获取这些函数以将异常发送回我的主 python 脚本中的 try/except 块？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:32:28.490

这取决于您如何导入 mytools。如果您将其导入为

```
import mytools 
```

然后改变：

```
except DirectionError: 
```

至：

```
except mytools.DirectionError: 
```

应该管用。

如果您只导入了您的函数：

```
from mytools import func1 
```

将其更改为：

```
from mytools import func1, DirectionError 
```

基本上，您需要将 DirectionError 类导入您的主代码并正确引用它。

此外，仅当您调用 func1(1) 并且您正在调用 func1(2) 时才会引发异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:23:36.147

在其自己的脚本文件中定义异常，然后将该文件导入 mytools.py 和您的主脚本

# java - 所有 SocketExceptions 都是“致命的”吗？

> ID：10126642
> 
> 赞同：2
> 
> 时间：2012-04-12T15:20:59.923
> 
> 标签：java, sockets

当遇到 SocketException 时（或者当您使用 BufferedReader 作为套接字时遇到 IOException），整个连接是否应该被认为是坏的？

我或多或少想知道在读取或写入套接字时是否会发生任何“非致命”异常，发生异常但套接字仍然可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T16:09:43.473

我不会说 SocketExceptions 是致命的，但整个连接应该被认为是坏的。虽然我完全同意 stacker 之前的回答，但重要的是要注意 SocketException 是 Exception 而不是 Error 的子级。我认为 Error 的孩子是致命的，而 Exceptions 可以具有可恢复的状态。不幸的是，在这种情况下，可恢复状态将是打开一个新连接。

根据您的业务逻辑，如果需要丢失套接字会导致应用程序进入不可恢复状态，则创建一个扩展 IOError（IOError 扩展错误）并作为 IOError 而不是作为异常捕获并重新抛出的类可能会很有用状态，无法合理处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:29:30.023

[对SocketException](http://docs.oracle.com/javase/6/docs/api/java/net/SocketException.html)子类的 javadoc 的编译表明，您无法从此类异常中恢复并重用套接字。

*   **BindException** 表示尝试将套接字绑定到本地地址和端口时发生错误。通常，端口正在使用中，或者无法分配请求的本地地址。

*   **ConnectException** 表示尝试将套接字连接到远程地址和端口时发生错误。通常，连接被远程拒绝（例如，没有进程正在侦听远程地址/端口）。

*   **NoRouteToHostException** 表示尝试将套接字连接到远程地址和端口时发生错误。通常，由于中间防火墙或中间路由器已关闭，无法访问远程主机。

*   **PortUnreachableException** 表示已在连接的数据报上接收到 ICMP 端口不可达消息。

SocketException 本身：抛出表明底层协议存在错误，例如 TCP 错误。

因此我会说是的，没有办法继续，因为 TCP 已经尝试确保从传输问题中恢复。

# jenkins - Jenkins 在独立安装时重定向 / 到 /jenkins

> ID：10126643
> 
> 赞同：5
> 
> 时间：2012-04-12T15:21:02.547
> 
> 标签：jenkins

我们有 Jenkins 的标准 Debian 安装（仅 winstone，不涉及 tomcat 或 apache），我们`--prefix=/jenkins`在端口 80 上运行它。

现在，当我访问时，`http://my.server/`我得到一个 404 页面。我可以说服 Winstone 以某种方式将其重定向到正确的地址`http://my.server/jenkins/`吗？

编辑：我知道我可以安装 Apache，并使用以下重写规则来获得我想要的：

```
RewriteEngine On
RewriteRule ^/*$ https://jenkins.corp.mobile.de/jenkins/ [R] 
```

我的问题是如何在 Winstone 中做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T17:26:34.103

做你想做的事的典型方法是在一些高端口上运行 Jenkins，比如 8080，`--prefix=/jenkins`然后在配置为反向代理的端口 80 中运行 Apache 或 Nginx 之类的`/jenkins`东西`http://localhost:8080/jenkins`

对于 Apache，您可以在 Apache 的配置文件中添加如下内容：

```
ProxyPass         /jenkins  http://localhost:8080/jenkins
ProxyPassReverse  /jenkins  http://localhost:8080/jenkins
ProxyRequests     Off

# Allow direct access to Jenkins only from localhost i.e. Apache
<Proxy http://localhost:8080/jenkins*>
  Order deny,allow
  Allow from 127.0.0.1
</Proxy> 
```

您应该根据要接受与 Jenkins 的连接的位置调整指令中的访问控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T07:18:36.853

[这里](http://jenkins.361315.n4.nabble.com/Running-Hudson-as-another-user-td369946.html)描述了对我有用的技巧。很快，执行以下命令：

```
sudo service jenkins stop
sudo rm -rf /tmp/*
sudo service jenkins start 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-05-29T14:18:49.433

正确的方法是访问您的 DNS 提供商并更改重定向

[http://my.server/](http://my.server/)

目前它应该指向你的主目录，叫做 / 你应该把它改成 /jenkins

我个人喜欢为 webapps 定义子域，例如[http://jenkins.my.server/](http://jenkins.my.server/)并保留 www.myserver 用于其他目的。

这也可以在您的 DNS 提供商配置中实现

# c# - WCF 中的删除方法

> ID：10126645
> 
> 赞同：1
> 
> 时间：2012-04-12T15:21:09.700
> 
> 标签：c#, wcf, linq, web-services, rest

我正在为此寻找一种 LINQ 删除方法：

```
<ArrayOfGroup>
    <Group>
        <GroupName>c</GroupName>
        <StudentList>
             <Student>
                 <TimeAdded>0001-01-01T00:00:00</TimeAdded> // trying to delete from here
                 <StudentID>1</StudentID>
                 <FirstName>a</FirstName>
                 <LastName>b</LastName> // to here
                 <StudentGroup/>
             </Student>
        </StudentList>
    </Group>
</ArrayOfGroup> 
```

出于某种原因，当我以这种方式删除它时：

```
[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single)] 
public class Service : IService
{
    List<Student> students = new List<Student>();
    List<Group> Groups = new List<Group>();
    public void removeStudent(string studentID)
    {
        students.Remove(students.Find(f => f.StudentID.Equals(studentID)));
        //var result = students.Where(n => String.Equals(n.StudentID, studentID)).FirstOrDefault();
        //if (result == null)
        //{
        //    result.StudentGroup.Remove(StudentList.Student.Find(f => f.StudentID.Equals(studentID)));
        //}
        // students.RemoveAll(f => f.StudentID.Equals(studentID)); also tryed this
    } 
```

它不会从我的 ArrayOfGroup 的学生列表/学生区域中删除它，所以我厌倦了试图解决它不删除的原因，只是试图找到一种新方法将它与原始记录一起删除。我觉得这样做是个罪犯，但如果有人能提供帮助，我将不胜感激。

我的数据合同如下所示：

```
[DataContract(Name="Student")]
public class Student
{
    public Student()
    {
        StudentGroup = new List<Group>();
    }

    [DataMember(Name = "StudentID")]
    public string StudentID { get; set; }

    [DataMember(Name = "FirstName")]
    public string FirstName { get; set; }

    [DataMember(Name = "LastName")]
    public string LastName { get; set; }

    [DataMember(Name = "TimeAdded")]
    public DateTime TimeAdded;

    public string TimeAddedString
    {
        get
        {
            return this.TimeAdded.ToString("dd/MM/yyyy hh:mm:ss");
        }
    }

    public List<Group> StudentGroup { get; set; }
}

[DataContract(Name = "Group")]
public class Group
{
    public Group() 
    {
        StudentList = new List<Student>();
    }

    [DataMember(Name = "GroupName")]
    public string GroupName { get; set; }

    public List<Student> StudentList { get; set; }
} 
```

如果有帮助，这就是将学生添加到组中的方式吗？

```
public void AddStudentToGroup(string group, string studentID, string firstName, string lastName)
{
    var result = Groups.Where(n => String.Equals(n.GroupName, group)).FirstOrDefault();
    var result1 = students.Where(n => String.Equals(n.StudentID, studentID)).FirstOrDefault();
    if (result != null)
    {
        result.StudentList.Add(new Student() { StudentID = studentID, FirstName = firstName, LastName = lastName });
    }
    if (result1 != null)
    {
        result1.StudentGroup.Add(new Group() { GroupName = group });
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:33:39.523

您可以`Remove`在对象上使用该方法，该方法`List<T>`采用如下谓词：

```
students.RemoveAll(s => s.StudentId == 5); 
```

# asp.net-mvc - 仅在生产模式下应用缓存清单

> ID：10126646
> 
> 赞同：1
> 
> 时间：2012-04-12T15:21:21.510
> 
> 标签：asp.net-mvc, html, offline-caching

我在我的应用程序中添加了一个“cache.manifest”（效果很好），从那时起，调试起来就非常困难，因为我必须始终清除缓存或修改 cache.manifest 版本。

我尝试使用“HttpContext.Current.IsDebuggingEnabled”条件加载清单：

```
<!DOCTYPE HTML>
  @if (HttpContext.Current.IsDebuggingEnabled)
  {
    <html>
  }
  else
  {
    <html manifest="/cache.manifest">
  } 
```

这不起作用，Visual Studio 给了我 3 个错误：

*   该块缺少结束 } 字符
*   **html**元素未关闭
*   不能有超过 1 个**html**元素。

有人有想法吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T20:08:37.673

根据“sav931”的回答，我终于找到了解决方案：

```
<html @(HttpContext.Current.IsDebuggingEnabled ? "" :  "manifest=cache.manifest" )> 
```

无需在 web.config 中添加应用程序设置键，因为已经有一个功能。(HttpContext.Current.IsDebuggingEnabled)

另外，我在开发时完全删除了 manfest 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T15:19:49.673

尝试在 web.config 中添加密钥，例如：

```
<add key="devMode" value="true"/> 
```

现在将其添加到您的视图中：

```
<head @(Convert.ToBoolean(System.Web.Configuration.WebConfigurationManager.AppSettings["devMode"]) ? "manifest=/cache.manifest" : "manifest=devMode.manifest")> 
```

通过添加一个不存在的清单文件名，它将禁用缓存...

# ruby-on-rails - 具有相关模型的自动生成方法

> ID：10126647
> 
> 赞同：1
> 
> 时间：2012-04-12T15:21:26.213
> 
> 标签：ruby-on-rails, magic-methods

我有两个模型：客户和合同。客户端有 3 个属性：id、email 和 client_number。合同也有 3 个：id、ip 和 client_id。客户 has_many :contracts。合同 belongs_to ：客户。

使用 RoR，我得到自动生成的方法，例如：

Client.find_by_email_and_client_number 'some_email', 1234

但我想要一个自动生成的方法，如：

Client.find_by_email_and_client_number_and_ip 'some_email', 1234, '192.168.200.54'

仅使用非客户的属性。我也想使用 Contract 模型中的 ip 属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:33:18.507

使用 Rails 的内置魔法查找器方法将无法实现这一点。但是您可以使用更直接的查询来做到这一点，如下所示：

```
Client.includes(:contracts).where(:email => 'some_email', :ip => '192.168.200.54').where('contracts.client_number = 1234') 
```

这是 Rails 的两种查找机制的示例：第一种是直接通过哈希查找，第二种是 SQL 片段。

不过，看起来您实际上在这里寻找的是某种关系。如果`client_number`设置为`has_many`关联的键，这样查询可能更容易：

```
client = Client.find_by_client_number(1234)
client.contracts.where(:email => 'some_email', :ip => '192.168.200.54') 
```

# android - 在加载位图之前如何知道它的尺寸？我可以只加载“预览”或“缩略图”版本吗？

> ID：10126648
> 
> 赞同：0
> 
> 时间：2012-04-12T15:21:29.720
> 
> 标签：android

我正在尝试加载并显示一个显示多张照片缩略图的屏幕。当我尝试将它们全部加载为位图时，我经常会收到 OutOfMemoryError，因为位图有点大，并且根据屏幕尺寸我要加载 10-20 个。照片的大小并不完全相同，因此取决于我要显示的子集，内存可能足以或可能不足以加载它们，这使我的应用程序不规律地崩溃（有时它会在用户滚动时崩溃）正在滚动照片网格）。

注意：由于我显示的是缩略图，我实际上并不要求加载的位图以全分辨率显示。有没有办法在加载位图之前告诉它的大小，还有，有没有办法在磁盘上加载位图的“预览”或下采样版本，这样我就可以节省内存并避免撞到内存限制？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T15:21:43.587

是的，当您通过 加载位图时`BitmapFactory`，您可以使用`BitmapFactory.Options`指定您只想检查位图的类型、宽度和高度：

```
// Read bitmap size and type only
final BitmapFactory.Options options = new BitmapFactory.Options();
options.inJustDecodeBounds = true;
BitmapFactory.decodeFile(imagePath, options);

int imageHeight = options.outHeight;
int imageWidth = options.outWidth;
String imageType = options.outMimeType; 
```

BitmapFactory.Options 还允许您指定要加载位图的下采样版本；您所要做的就是指定 inSampleSize，它是下采样因子（使用 2 加载一半宽度和一半高度的图像——因此具有大约 1/4 的内存占用）。因此，在您的情况下，您所要做的就是根据缩略图大小计算适当的下采样因子，并加载下采样的图像：

```
// (continuing from previous block of code)    

// Calculate downsample factor
options.inSampleSize = /* calculate downsample factor here as appropriate */

// Load a downsampled bitmap according to factor calculated above
options.inJustDecodeBounds = false;
Bitmap myBitmap = BitmapFactory.decodeResource(res, resId, options); 
```

此外，如果您的列表滚动，那么您可能应该实施一种智能策略来释放您不再在屏幕上显示的位图。结合这种技术，这应该可以解决你的问题`OutOfMemoryError`。

有关这方面的更多信息，请查看 Android Training 上的这个课程，它提供了这些（以及许多其他）实用技巧，以确保您的应用程序正确加载、显示和处理位图：

[http://developer.android.com/training/displaying-bitmaps/index.html](http://developer.android.com/training/displaying-bitmaps/index.html)

# ios - 在 iOS 上始终获取 In_app 的状态 SKPaymentTransactionStatePurchasing

> ID：10126653
> 
> 赞同：3
> 
> 时间：2012-04-12T15:21:54.247
> 
> 标签：ios, in-app-purchase

我使用教程使用 MKStoreKit

我添加了我的产品 ID

但后来我尝试进行购买过程，我总是得到 transactionState SKPaymentTransactionStatePurchasing

在 Apple Dev Guide 中，没有提及我必须如何处理它。

我尝试不同的设备，不同的 mac pc 等等。

但总是得到状态 SKPaymentTransactionStatePurchasing

它适用于所有产品 TypeConsumable 与否。

可以帮助我这是什么错误？当我得到这个状态时我的下一步是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:36:56.750

你在模拟器中收到了吗？

它来了，当 Apple 弹出“你想购买该商品吗？”。

然后它变为购买或失败，但不是模拟器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T10:19:13.380

发生这种情况是因为 Apple 可能需要时间在“服务器”中创建产品。

所以这个问题是：

在 12:00 我用 ID 创建产品：org.example.testProduct

只有在第二天我才能使用它。

似乎 Apple 需要时间在服务器或 smht 之间“同步”数据。

# c# - 使用 jquery 传递给 actioncontroller asp.net mvc 3 的数组

> ID：10126657
> 
> 赞同：1
> 
> 时间：2012-04-12T15:22:03.437
> 
> 标签：c#, jquery, asp.net-mvc, arrays, asp.net-mvc-3

我想知道如何在 jquery ajax 调用传递的 asp.net mvc3 控制器数组中进行迭代

我的阿贾克斯电话：

```
 var array = [];
                array.push({ dir: id });
                array.push({ dirToCreate: $("#txtDir").val() });

                $.ajax({
                    Type: 'GET',
                    url: '/Home/CreateFolder/',
                    data: { 'list': array },
                    traditional: true,
                    cache: 'true',
                    success: function (result) {
                        alert(result);
                    }
                }); 
```

这是我的动作控制器：

```
 public ActionResult CreateFolder (IEnumerable<string> list  )
    {
        // how to iterate through the values passed
        return Content("ok");

    } 
```

`ActionController`实际上，我可以像在`ActionController` `CreateFolder`方法中获得的那样传递一个数组`object object`吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T09:17:12.557

这不是一件直截了当的事情，但这是一种方法。首先将您的ajax方法更改为：

```
$.ajax({
        type: 'post',
        datatype: 'json',
        url: '/Home/CreateFolder',
        traditional: true,
        data: { list: JSON.stringify(array)},
        success: function (result) {
            alert(result);
        }
    }); 
```

然后在控制器中，您需要使用`JavascriptSerializer`该类反序列化 json。在我的示例中，我使用了一个名为文件夹的类，它在控制器代码下方注明。您不必使用这种类型，如果您想通过并在其他地方使用它，它看起来更干净。在控制器中执行以下操作：

```
 [HttpPost]
    public ActionResult CreateFolder(string list)
    {
        var js = new JavaScriptSerializer();
        var deserializedObject = (object[])js.DeserializeObject(list);
        var myFolders = new List<Folder>();

        if (deserializedObject != null)
        {
            foreach (Dictionary<string, object> newFolder in deserializedObject)
            {
                myFolders.Add(new Folder(newFolder));
            }
        }

        return Json("");
    } 
```

这是`Folder`我上面使用的类型，以及采用新文件夹的构造函数：

```
public class Folder
{
    public Folder(Dictionary<string, object> newFolder)
    {
        if (newFolder.ContainsKey("dir"))
        {
            Directory = (string)newFolder["dir"];
        }
        if (newFolder.ContainsKey("dirToCreate"))
        {
            DirectoryToCreate = (string)newFolder["dirToCreate"];
        }
    }
    public string Directory { get; set; }
    public string DirectoryToCreate { get; set; }
} 
```

# cordova - 如何从 phonegap 获取图片到远程 XPage？

> ID：10126658
> 
> 赞同：3
> 
> 时间：2012-04-12T15:22:05.277
> 
> 标签：cordova, xpages

我在 iPad 上构建了一个 1.6 版的 Phonegap 应用程序，并将 ulr 设置为 Domino 服务器上的 XPage

现在我的问题：

当我在 iPhone 上拍照并使用函数将其上传到我的 XPage 时`takePicture`，“返回值”是这样的字符串

```
data:image/jpeg;base64,file://localhost/var/mobile/Applications/C1ABCAD3-5F54-45AB-81B0-A242940B58CB/tmp/photo_001.jpg 
```

有没有机会上传文件而不是字符串？

这是我正在使用的代码：

```
XSP.submitLatency = 300*1000;

function takePicture() {    
    navigator.camera.getPicture(displayPicture,
     showError,
      { quality: 50 }

      ); 

}

function displayPicture(data) {

alert("Hallo" );
    var imagePanel = document.getElementById('imagePanel');
    imagePanel.style.display = "";
    imagePanel.style.position = "absolute";
    imagePanel.style.top = "250px";
    imagePanel.style.left = "0px";

    alert("data:image/jpeg;base64," + data)
    document.getElementById('image').src = "data:image/jpeg;base64," + data;
    document.getElementById("#{javascript:getClientId('inputHidden1')}").value = "data:image/jpeg;base64," + data;

    document.getElementById("#{javascript:getClientId('button1')}").disabled = false;
}

function showError(fail) {
    alert(fail);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T19:52:53.623

您要做的是通过将 destinationType 指定为[options的一部分，让](http://docs.phonegap.com/en/1.6.0/cordova_camera_camera.md.html#cameraOptions_options)[getPicture](http://docs.phonegap.com/en/1.6.0/cordova_camera_camera.md.html#camera.getPicture)方法返回 FILE_URI 而不是 DATA_URL 。获得 URI 后，您可以使用[FileTransfer.upload](http://docs.phonegap.com/en/1.6.0/cordova_file_file.md.html#FileTransfer_upload)上传文件。

# java - 存储用于比较两个目录结构的数据

> ID：10126660
> 
> 赞同：0
> 
> 时间：2012-04-12T15:22:12.680
> 
> 标签：java

我想比较 2 个目录结构（仅文件），所以首先我会得到一些文件列表，结构如下： Filename|size
For ilustration:
(1):

```
C:\Downloads\100 Java Tips.pdf|1025kB
C:\Downloads\1590599799.rar|1000kB
C:\Downloads\573440.flv|50000kb
C:\Downloads\575492.flv|40000kb
C:\Downloads\avira_antivir_personal_en.exe|15000kB
C:\Downloads\backup-mkyong.com-12-24-2009.tar.gz|2000kB 
```

然后我想比较 2 个目录 sturctres = 我将有两个具有列表目录结构的文件（参见（1））。一个文件将被引用，第二个文件将被比较。我只有树结果： 1）ok - 第一个结构中的文件存在于第二个结构中，大小相同 2）fail1 - 第一个结构中的文件在第二个结构中不存在 3）fail2 - 第一个结构中的文件存在于第二个结构中但有不同尺寸

我的问题是，什么最适合存储我将要比较的数据？例如，我将数据从 file1 放到“shelf1”，从 file2 放到“shelf2”。问题是货架应该是什么？数组，...谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:26:14.583

如果您有相同的路径（绝对或相对），您可以使用 hashmap 并将路径用作键和大小（或相应的`File`对象）作为值。

然后遍历map 1的条目并检查它们是否存在于map 2中并且具有相同的值（即大小）。

# scripting - Applescript：如何使用默认程序打开文件？

> ID：10126661
> 
> 赞同：11
> 
> 时间：2012-04-12T15:22:16.000
> 
> 标签：scripting, applescript

在一个applescript 中，我收到一个我必须打开的文件路径。

文件路径的格式为“ `/Users/xxx/my/file/to/open.xyz`”。

我想用默认程序打开它。如果是AVI，我需要用视频程序打开它，如果是xls，用excel，...

我尝试了几件事但没有成功：

```
--dstfile contains the previous path
tell application "Finder"
    activate
    open document dstfile
end tell 
```

--> 我收到错误 1728，告诉我他无法获取文档

```
tell application "Finder"
    activate
    open document file dstfile
end tell 
```

--> 这里也一样

```
tell application "Finder"
    activate
    open document POSIX file dstfile
end tell 
```

--> 这里也一样

我确定该文件存在，因为我在执行此代码之前执行了此操作：

```
if not (exists dstfile) then
    display dialog "File isn't existing"
end if 
```

我无法使用 to of... 的合成器 open.xyz，因为我将其作为参数接收。

请帮助我绝望:'(

**答案**：根据答案，我最终得到：

```
set command to "open " & quoted form of dsturl
do shell script command 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-12T22:12:34.250

您的问题是双重的：

1.  您的路径采用 POSIX 表示法，AppleScript 无法将其强制转换为 Finder 可接受的*别名*或*文件*对象，因为这些只能从 HFS 表示法 ( `Users:xxx:my:file:to:open.xyz`) 中的路径字符串隐式创建。明确将您的路径声明为*POSIX 文件*将解决此问题。然而，
2.  您对 Finder 的调用将*文档*添加到路径中，但 Finder 的 AppleScript 字典不包含*文档*对象类型（存在*文档文件*对象，但它是*finder 项*的子项，无法在此调用中创建）。删除该部分将解决问题。

**TL;DR：**以下行将在默认程序中打开一个通过 POSIX 路径给出的文件，而无需求助于 shell：

```
tell application "Finder" to open POSIX file "/Users/xxx/my/file/to/open.xyz" 
```

**警告：**这是最简单的解决方案，但它仅适用于合格的 POSIX 路径（即以 开头的路径`/`），就像问题中的路径一样。`~`处理相对的（即以,`.`或开头的路径`..`）OTOH 需要 AppleScript-ObjectiveC API（不完全是微不足道的）或 shell（对您的引用感兴趣）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-12T15:39:53.957

尝试：

```
set dstfile to "~/xxx/my/file/to/open.xyz"
do shell script "open " & dstfile & "" 
```

# jquery - 通过 jQuery 更改 TinyMCE 背景

> ID：10126662
> 
> 赞同：0
> 
> 时间：2012-04-12T15:22:19.550
> 
> 标签：jquery, css, tinymce

我有一个带有颜色选择器和 TinyMCE 编辑器的表单。用户可以为 TinyMCE 选择新的背景颜色。如果用户选择了一种颜色，编辑器会立即获得新的背景。

这是我的代码：

```
$(".color-picker").miniColors({
        letterCase: 'uppercase',
        change: function(hex) {
            $("iframe > html").css("background-color", hex);
            $("iframe > body").css("background-color", hex);
        }
    }); 
```

但是什么都没有改变。。

如何使用 jQuery 更改 TinyMCE 编辑器的背景颜色？

请

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T07:51:02.633

kpotehin 很接近，但使用他的代码将修改页面上的所有 iframe，而不仅仅是要更改背景的编辑器 iframe。使用活动的 tinymce 编辑器和一些编辑器相关功能，您的问题的解决方案是

```
$(".color-picker").miniColors({
      letterCase: 'uppercase',
      change: function(hex) {
          $(tinymce.activeEditor.getBody()).css("background-color",'#' + hex);
          $(tinymce.activeEditor.getBody().parentNode).css("background-color",'#' + hex);
      }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T00:06:44.920

最好也发布html代码。但在我看来，你只需要在十六进制之前添加“#”。你的例子：

```
$(".color-picker").miniColors({
        letterCase: 'uppercase',
        change: function(hex) {
            $("iframe > html").css("background-color",'#' + hex);
            $("iframe > body").css("background-color",'#' + hex);
        }
    }); 
```

# javascript - 自动将json操作成不同结构的对象

> ID：10126666
> 
> 赞同：0
> 
> 时间：2012-04-12T15:22:21.983
> 
> 标签：javascript, json

我有一个巨大的 JSON 文件。它的结构不正确，我无法控制结构。它是来自一组基于时间戳的路由器的数据。我正在尝试创建一个对象结构，它将给定路由器的所有信息组合成一个带有时间戳等的路由器对象作为数组。@quodlibetor 对我接近这一点很有帮助。我还想根据 json 中的名称 val 对的名称自动命名对象的属性。

我的目标是从 json 文件中的名称自动命名属性，并将其重组为一个看起来像这样的对象（我愿意接受有关结构的建议，这似乎是最有组织的方式）。

这是我想要的结构：

```
 {
        "Router": [
            {
                "routerName": "RouterID1",
                "TimeStamp": [
                    "2012/01/01 06:00:00",
                    "2013/01/01 06:00:00",
                    "2014/01/01 06:00:00"
                ],
                "OutputBITS": [
                    "23235",
                    "29903",
                    "22103"
                ],
                "InputBITS": [
                    "23235",
                    "29903",
                    "22103"
                ]
            }
        ]
    } 
```

尽管尝试创建该结构，但我已经接近但没有交易：

```
{
    "RouterID1": {
        "timeStamp": [
            {
                "timeStamp": "2012/01/01 06:00:00"
            },
            {
                "timeStamp": "2013/01/01 06:00:00"
            },
            {
                "timeStamp": "2014/01/01 06:00:00"
            }
        ],
        "OutputBITS": [
            {
                "OutputBITS": "23235"
            },
            {
                "OutputBITS": "23235"
            },
            {
                "OutputBITS": "23235"
            }
        ],
        "InputBITS": [
            {
                "InputBITS": "29903"
            },
            {
                "InputBITS": "29903"
            },
            {
                "InputBITS": "29903"
            }
        ]
    }
} 
```

原始 JSON：

```
json = [
         {
              "Router": "RouterID1",
              "TimeStamp": "2012/01/01 06:00:00",
              "OutputBITS": "23235",
              "InputBITS":  "29903"
         },   
          {
              "Router": "RouterID1",
              "TimeStamp": "2013/01/01 06:00:00",
              "OutputBITS": "23235",
              "InputBITS":  "29903"
         },   
          {
              "Router": "RouterID1",
              "TimeStamp": "2014/01/01 06:00:00",
              "OutputBITS": "23235",
              "InputBITS":  "29903"
         },
         {
              "Router": "RouterID3",
              "TimeStamp": "2012/01/01 06:05:00",
              "OutputBITS": "21235",
              "InputBITS":  "22103"
         },
         {
             "Router": "RouterID3",
             "TimeStamp": "2012/01/01 06:05:00",
             "OutputBITS": "21235",
             "InputBITS":  "22103"
        },
        {
            "Router": "RouterID4",
            "TimeStamp": "2012/01/01 06:05:00",
            "OutputBITS": "21235",
            "InputBITS":  "22103"
       },
       {
           "Router": "RouterID4",
           "TimeStamp": "2012/01/01 06:05:00",
           "OutputBITS": "21235",
           "InputBITS":  "22103"
      }
      ]; 
```

代码：

```
 //  Create routers object    
    var routers = {};

       for (var i=0;i<json.length;i++){
        var router_name = json[i].Router;
        router_name = (router_name.replace(/-/g, ""));  //take hyphen out or router name

        if (!routers[router_name]){
            // add properties to the router object thanks to @@quodlibetor

            // instead of using timeStamp is something like json[i] or json.[name] or some
            // way to reference each json property and not have to type it in?

            routers[router_name] = { timeStamp : [], OutputBITS : [], InputBITS : [] };
        }

                routers[router_name].timeStamp.push({
                    timeStamp : json[i].TimeStamp
                }); 
                 routers[router_name].OutputBITS.push({
                     OutputBITS : json[i].OutputBITS
                }); 
                routers[router_name].InputBITS.push({
                    InputBITS : json[i].InputBITS
                });  
    }; 

    console.log(routers);
    });
     </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:25:02.027

这是您需要的代码：

```
var router = {router: []}, i, j, k, l, inArray, routerName, thisRouter;

for(i=0,j=json.length;i<j;++i) {
    inArray = false;

    routerName = json[i].Router;

    for(k=0,l=router.router.length;k<l;++k) {
        if(router.router[k].name === routerName) {
            inArray = true; --k; l = k;
        }
    }

    if(inArray === true) {
        router.router[k].TimeStamp.push(json[i].TimeStamp);
        router.router[k].OutputBITS.push(json[i].OutputBITS);
        router.router[k].InputBITS.push(json[i].InputBITS);
    } else {
        thisRouter = {name: routerName, TimeStamp: [json[i].TimeStamp], OutputBITS: [json[i].OutputBITS], InputBITS: [json[i].InputBITS]};

        router.router.push(thisRouter);
    }
}

console.log(router); 
```

# c++ - 我可以使用 Cython 在 Python 中覆盖 C++ 虚函数吗？

> ID：10126668
> 
> 赞同：14
> 
> 时间：2012-04-12T15:22:23.640
> 
> 标签：c++, python, cython

我有一个带有虚拟方法的 C++ 类：

```
//C++
class A
{

    public:
        A() {};
        virtual int override_me(int a) {return 2*a;};
        int calculate(int a) { return this->override_me(a) ;}

}; 
```

我想做的是用 Cython 将这个类公开给 Python，从 Python 中的这个类继承，并有正确的覆盖调用：

```
#python:
class B(PyA):
   def override_me(self, a):
       return 5*a
b = B()
b.calculate(1)  # should return 5 instead of 2 
```

有没有办法做到这一点 ？现在我在想，如果我们也可以覆盖 Cython 中的虚拟方法（在 pyx 文件中），那也很棒，但允许用户在纯 python 中执行此操作更为重要。

**编辑**：如果这有帮助，一个解决方案可能是使用这里给出的伪代码：http: [//docs.cython.org/src/userguide/pyrex_differences.html#cpdef-functions](http://docs.cython.org/src/userguide/pyrex_differences.html#cpdef-functions)

但是有两个问题：

*   我不知道如何在 Cython 中编写此伪代码
*   也许有更好的方法

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-21T21:22:43.870

解决方案有些复杂，但有可能。这里有一个完整的示例：[https ://bitbucket.org/chadrik/cy-cxxfwk/overview](https://bitbucket.org/chadrik/cy-cxxfwk/overview)

以下是该技术的概述：

创建一个专门的子类，`class A`其目的是与 cython 扩展交互：

```
// created by cython when providing 'public api' keywords:
#include "mycymodule_api.h"

class CyABase : public A
{
public:
  PyObject *m_obj;

  CyABase(PyObject *obj);
  virtual ~CyABase();
  virtual int override_me(int a);
}; 
```

构造函数接受一个 python 对象，它是我们的 cython 扩展的实例：

```
CyABase::CyABase(PyObject *obj) :
  m_obj(obj)
{
  // provided by "mycymodule_api.h"
  if (import_mycymodule()) {
  } else {
    Py_XINCREF(this->m_obj);
  }
}

CyABase::~CyABase()
{
  Py_XDECREF(this->m_obj);
} 
```

在 cython 中创建这个子类的扩展，以标准方式实现所有非虚拟方法

```
cdef class A:
    cdef CyABase* thisptr
    def __init__(self):
        self.thisptr = new CyABase(
            <cpy_ref.PyObject*>self)

    #------- non-virutal methods --------
    def calculate(self):
        return self.thisptr.calculate() 
```

创建虚拟和纯虚拟方法作为`public api`函数，将扩展实例、方法参数和错误指针作为参数：

```
cdef public api int cy_call_override_me(object self, int a, int *error):
    try:
        func = self.override_me
    except AttributeError:
        error[0] = 1
        # not sure what to do about return value here...
    else:
        error[0] = 0
        return func(a) 
```

在你的 c++ 中间体中使用这些函数，如下所示：

```
int
CyABase::override_me(int a)
{
  if (this->m_obj) {
    int error;
    // call a virtual overload, if it exists
    int result = cy_call_override_me(this->m_obj, a, &error);
    if (error)
      // call parent method
      result = A::override_me(i);
    return result;
  }
  // throw error?
  return 0;
} 
```

我很快将我的代码改编为您的示例，因此可能会出现错误。查看存储库中的完整示例，它应该可以回答您的大部分问题。随意分叉并添加您自己的实验，它远未完成！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-02T23:57:49.563

出色的 ！

不完整但足够。我已经能够为自己的目的做这个把戏。将这篇文章与上面链接的来源结合起来。这并不容易，因为我是 Cython 的初学者，但我确认这是我在 www 上找到的唯一方法。

非常感谢你们。

很抱歉，我没有太多时间讨论文本细节，但这是我的文件（可能有助于就如何将所有这些放在一起获得额外的观点）

设置.py：

```
from distutils.core import setup
from distutils.extension import Extension
from Cython.Distutils import build_ext

setup(
    cmdclass = {'build_ext': build_ext},
    ext_modules = [
    Extension("elps", 
              sources=["elps.pyx", "src/ITestClass.cpp"],
              libraries=["elp"],
              language="c++",
              )
    ]
) 
```

测试类：

```
#ifndef TESTCLASS_H_
#define TESTCLASS_H_

namespace elps {

class TestClass {

public:
    TestClass(){};
    virtual ~TestClass(){};

    int getA() { return this->a; };
    virtual int override_me() { return 2; };
    int calculate(int a) { return a * this->override_me(); }

private:
    int a;

};

} /* namespace elps */
#endif /* TESTCLASS_H_ */ 
```

ITestClass.h：

```
#ifndef ITESTCLASS_H_
#define ITESTCLASS_H_

// Created by Cython when providing 'public api' keywords
#include "../elps_api.h"

#include "../../inc/TestClass.h"

namespace elps {

class ITestClass : public TestClass {
public:
    PyObject *m_obj;

    ITestClass(PyObject *obj);
    virtual ~ITestClass();
    virtual int override_me();
};

} /* namespace elps */
#endif /* ITESTCLASS_H_ */ 
```

ITestClass.cpp：

```
#include "ITestClass.h"

namespace elps {

ITestClass::ITestClass(PyObject *obj): m_obj(obj) {
    // Provided by "elps_api.h"
    if (import_elps()) {
    } else {
        Py_XINCREF(this->m_obj);
    }
}

ITestClass::~ITestClass() {
    Py_XDECREF(this->m_obj);
}

int ITestClass::override_me()
{
    if (this->m_obj) {
        int error;
        // Call a virtual overload, if it exists
        int result = cy_call_func(this->m_obj, (char*)"override_me", &error);
        if (error)
            // Call parent method
            result = TestClass::override_me();
        return result;
    }
    // Throw error ?
    return 0;
}

} /* namespace elps */ 
```

EDIT2：关于 PURE 虚拟方法的注释（这似乎是一个非常常见的问题）。如上面的代码所示，以这种特殊的方式，“TestClass::override_me()”不能是纯的，因为它必须是可调用的，以防 Python 的扩展类中没有覆盖该方法（又名：一个不属于“ITestClass::override_me()”主体的“错误”/“未找到覆盖”部分）。

扩展名：elps.pyx：

```
cimport cpython.ref as cpy_ref

cdef extern from "src/ITestClass.h" namespace "elps" :
    cdef cppclass ITestClass:
        ITestClass(cpy_ref.PyObject *obj)
        int getA()
        int override_me()
        int calculate(int a)

cdef class PyTestClass:
    cdef ITestClass* thisptr

    def __cinit__(self):
       ##print "in TestClass: allocating thisptr"
       self.thisptr = new ITestClass(<cpy_ref.PyObject*>self)
    def __dealloc__(self):
       if self.thisptr:
           ##print "in TestClass: deallocating thisptr"
           del self.thisptr

    def getA(self):
       return self.thisptr.getA()

#    def override_me(self):
#        return self.thisptr.override_me()

    cpdef int calculate(self, int a):
        return self.thisptr.calculate(a) ;

cdef public api int cy_call_func(object self, char* method, int *error):
    try:
        func = getattr(self, method);
    except AttributeError:
        error[0] = 1
    else:
        error[0] = 0
        return func() 
```

最后，python调用：

```
from elps import PyTestClass as TC;

a = TC(); 
print a.calculate(1);

class B(TC):
#   pass
    def override_me(self):
        return 5

b = B()
print b.calculate(1) 
```

这应该会使之前的链接工作更直接地指向我们在这里讨论的重点......

编辑：另一方面，上面的代码可以通过使用'hasattr'而不是try/catch块来优化：

```
cdef public api int cy_call_func_int_fast(object self, char* method, bint *error):
    if (hasattr(self, method)):
        error[0] = 0
        return getattr(self, method)();
    else:
        error[0] = 1 
```

当然，上面的代码只有在我们不覆盖“override_me”方法的情况下才会有所不同。

# jquery - 如何限制字符数

> ID：10126670
> 
> 赞同：0
> 
> 时间：2012-04-12T15:22:40.793
> 
> 标签：jquery

我需要控制用户在单个文本框中输入的字符数，但我不知道如何，例如你有这个

```
$.validator.addMethod('selectNone',
                    function(value, element) {
                        return this.optional(element) ||
                        (value.indexOf(" ") == -1);
                    }, "Por Favor Selecciona una Opción"); 
```

我如何创建一个规则来控制使用只输入 6 个字符（字母数字）以及我如何控制用户可以输入最大数字 999,999,999.99（如果不输入“，我可以控制用户，我的文本框添加当用户完成像 55555.55 这样的数字并将其转换为 55,555.55 时（如果要输入小数，用户应始终输入“.”）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:32:20.653

这实际上是2个问题吗？如何限制字符数以及如何格式化用户输入的内容。

您可以通过在输入元素上使用 maxlength 属性来限制 HTML 中的长度

```
<input type="text" id="YourTextbox" name="YourTextbox" maxlength="20" /> 
```

有关格式，请查看此问题... [每三位数字添加逗号](https://stackoverflow.com/questions/1990512/add-comma-to-numbers-every-three-digits-using-jquery)

另外 - 如果您使用 JQuery 验证器[http://docs.jquery.com/Plugins/Validation/Methods/maxlength](http://docs.jquery.com/Plugins/Validation/Methods/maxlength)

对于正则表达式 - 也看看这个问题[Insert commas into number string](https://stackoverflow.com/questions/721304/insert-commas-into-number-string)

# javascript - onclick 函数通过切换将数据插入输入字段

> ID：10126671
> 
> 赞同：0
> 
> 时间：2012-04-12T15:22:45.897
> 
> 标签：javascript, jquery, onclick, toggle

我想构建两个具有**onclick 功能**的按钮，将“男性”或“女性”插入另一个输入。

这两个按钮有背景图片，点击时需要改变背景位置。我需要两个按钮来相互切换。

任何人都可以建议使用 javascript 或 jquery 的解决方案吗？

```
<input type="button" class="gnM" onclick="???????">
<input type="button" class="gnF" onclick="???????">

<input class="req-string gender" id="gender" name="gender"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:26:39.390

If you must do this with `onclick` then I'd suggest:

```
<input type="button" class="gnM" onclick="$('#gender').val($(this).val())" value="male" />
<input type="button" class="gnM" onclick="$('#gender').val($(this).val())" value="female" /> 
```

[JS Fiddle demo](http://jsfiddle.net/davidThomas/DnyDV/).

I'd strongly suggest moving from an `onclick` to a jQuery unobtrusive method, using the `click()` method:

```
​$('.gnM').click(
    function(){
        var that = $(this);
        $('#gender').val(that.val());
        that.css('background-position','bottom right');
    });​​​​​​ 
```

[JS Fiddle demo](http://jsfiddle.net/davidThomas/DnyDV/1/).

To allow for toggling:

```
$('.gnM').click(
    function(){
        var that = $(this);
        $('#gender').val(that.val());
        that.siblings().removeClass('active');
        that.toggleClass('active');
    });​ 
```

[JS Fiddle demo](http://jsfiddle.net/davidThomas/DnyDV/2/).

Or, more concisely:

```
$('.gnM').click(
    function(){
        var that = $(this);
        $('#gender').val(that.val());
        that.toggleClass('active').siblings().removeClass('active');
    });​ 
```

[JS Fiddle demo](http://jsfiddle.net/davidThomas/DnyDV/3/).

References:

*   [`click()`](http://api.jquery.com/click/).
*   [`css()`](http://api.jquery.com/css/).
*   [`removeClass()`](http://api.jquery.com/removeClass/).
*   [`siblings()`](http://api.jquery.com/siblings/).
*   [`toggleClass()`](http://api.jquery.com/toggleClass/).
*   [`val()`](http://api.jquery.com/val/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:30:00.850

[http://jsfiddle.net/vFsXt/](http://jsfiddle.net/vFsXt/)使用jQuery的解决方案，避免使用js的内联属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:33:13.780

创建一个 CSS 类 ( `button-toggle-on`)，为按钮应用切换的背景位置。然后在按钮`onclick`上切换类按钮。为此，首先需要打开一个。

```
<input type="button" class="gnM button-toggle-on" onclick="$('#gender').val('male'); $('.gnF, .gnM').toggleClass('button-toggle-on');" /> 
<input type="button" class="gnF" onclick="$('#gender').val('female'); $('.gnF, .gnM').toggleClass('button-toggle-on');" /> 
```

# c# - Kung foo 调用多次罢工，如何从测试中知道调用的方法？

> ID：10126673
> 
> 赞同：2
> 
> 时间：2012-04-12T15:22:54.740
> 
> 标签：c#, nunit, moq

好的 - 所以我有这个测试。我写它时期望它会失败，因为我的 OnSaveCommand 确实调用了我的适配器 Save 方法。但令我惊讶的是，它没有说“在模拟中多次执行调用”。我完全糊涂了。我根本不叫它*goink*。我的问题是我不知道如何分辨它叫什么？如果我在哪里运行代码，我会在一个断点处抛出一个断点，并在调用它时查看调用堆栈，但这在这里并不真正起作用，因为它当然是一个模拟。

我试图查看最小起订量快速入门以获得一些想法，但事实是我只是被难住了。测试的第一部分发布了一个导致 DiscountsForSelectedCompany 列表被填充的事件，我可以看到所有发生的事情，然后我执行保存命令对吗？然后我得到错误。就像我说的那样，我很难过——如果有人能指出我正确的方向，那就太棒了。

```
[Test]
public void SaveCommand_Will_Call_Adapter_SaveDiscounts_For_All_Edited_Discounts()
{
    eventAggregator.GetEvent<SetCompanyIdEvent>().Publish(182);

    vm.DiscountsForSelectedCompany.Single(x => x.Id == 1).IsEdited = true;
    mockVariablePricingAdapter.Setup(x => x.SaveDiscounts(
            It.Is<List<DisplayCompanyDiscount>>(a => a.First().Id == 1))
        ).Verifiable();

    vm.SaveCommand.Execute();
    mockVariablePricingAdapter.Verify(x => x.SaveDiscounts(It.Is<List<DisplayCompanyDiscount>>(a => a.First().Id == 1)), Times.Once());
} 
```

谢谢！

EIDT！哇——嘿！！！我将“Times.Once（）”更改为“Times.AtLeastOnec（）”，如果失败说“没有在模拟上执行调用：” - 有人知道吗？它是一个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T22:51:50.243

几点和评论。

首先，您的测试的第三行是不必要的，因为您在最后一行明确识别您的验证。如果您想保留 .setup(...).verifiable() ，那么最后一行应该是 .Verify();

至于找到两个调用的原因，首先我会在代码中的适当位置设置一个刹车点，然后逐步找到这两个调用。如果这没有帮助，请将 Moq 替换为手动模拟，并在手动模拟的 SaveDiscounts 中放置一个断点。

快乐的编码，我希望这会有所帮助。

# tfs - 在 TFS 2010 中使工作项字段仅在处于状态时而不是在过渡到该状态时只读

> ID：10126677
> 
> 赞同：2
> 
> 时间：2012-04-12T15:23:01.610
> 
> 标签：tfs

我目前正在开发与 TFS2010 一起使用的自定义流程模板。我想对我的工作项目施加一些限制。我有一个“任务”工作项，它在创建时将以“待办事项”状态开始。当转换到下一个状态“进行中”时，我指定了“原始估计”字段是必需的。到目前为止，一切都很好。

为了对此进行扩展，我想在该字段处于“进行中”状态时将其设为只读，但在进行转换时允许对其进行编辑。目前，当我在“进行中”状态下为该字段设置只读时，我无法输入一个值。唯一可行的方法是在“待办事项”状态下输入值，保存然后转换。如果可能的话，我想避免那个临时保存步骤。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T08:09:13.247

I believe I found away around what I was trying to do by using the WHENNOTCHANGEDCONDITION.

By using this on the 'In Progress' state, I set the 'Original Estimate' field to READONLY when the 'State' is not being changed.

I would've tried FROZEN as Dave suggested, but I would like it to be amendable if returned to the previous state.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:26:38.560

What about using [`FROZEN`](http://msdn.microsoft.com/en-us/library/ms194953.aspx)?

> Specifies that you cannot change the field to a non-empty value after changes are committed. As soon as a user saves the work item with a value in that field, the value can no longer be modified.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T20:20:07.243

您无法成功，因为您将只读字段约束设置为状态而不是转换为状态。

将您的只读约束置于“进行中”状态，而不是从“待办事项”到“进行中”的转换。

在流程模板版中右键单击转换框，然后选择属性（IIRC），您将处于熟悉的位置。

# python - 如何在python中设置和检查布尔标志

> ID：10126679
> 
> 赞同：8
> 
> 时间：2012-04-12T15:23:08.733
> 
> 标签：python, boolean

我正在尝试用布尔值做这样的事情：

```
/* ... other stuff */
loggedDocument = false
for line in inFile:
  if (line.find( /*something*/ ) != -1):
    println("FOUND DOCUMENT: %s" % line)
    loggedDocument = true
  if (loggedDocument == false):
    /* do something else */ 
```

但我不断收到无效的语法错误。我用谷歌搜索但找不到一个简单的布尔示例，有什么想法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-12T15:24:56.647

您正在寻找`True`和`False`（注意大写字母）。此外，写最后一行的更 Pythonic 方式是`if not loggedDocument`代替`if loggedDocument == False`. 编辑：顺便说一句，`println`不是 Python 内置的 Python 函数；你在找`print()`吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-12T15:25:02.950

布尔值拼写为`True`and `False`。

确保你的空格是正确的。

并删除 之后的括号`if`，不需要它们。

# c++ - boost::spirit 排列

> ID：10126680
> 
> 赞同：2
> 
> 时间：2012-04-12T15:23:10.320
> 
> 标签：c++, boost, boost-spirit, boost-spirit-qi

我必须解析以下文本

```
Camera {
    position 0 0 0
    direction 0 -1 0
    up 0 1 0
    FOVy 45
} 
```

我的选择继续提升：精神，因为我不必处理 flex 或 bison。

我终于有了这个语法

```
struct camera_grammar :  qi::grammar<Iterator, camera(), ascii::space_type>
{
    qi::rule<Iterator, camera(), ascii::space_type> start;

    camera_grammar() : camera_grammar::base_type(start)
    {
        start %=
        lit("Camera")
        >> '{'
        >> (lit("position") >> float_ >> float_ >> float_) 
        >> (lit("direction") >> float_ >> float_ >> float_)
        >> (lit("up") >> float_ >> float_ >> float_)
        >> (lit("FOVy") >> int_)
        >> '}'
        ;
    }
}; 
```

问题是花括号内的部分甚至可以交换；我已经阅读了关于置换运算符*^*的信息，但是当至少有一个操作数以任何顺序匹配时，我读到了该匹配。我需要我的语法只有当它们都以任何顺序并且只有一次时才匹配。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T19:24:52.080

[Hartmut Kaiser在本文中](http://boost-spirit.com/home/2010/02/17/parsing-arbitrary-things-in-any-sequence/)解释了如何做到这一点。

您需要`no_empties_impl`按照文章中的描述定义类，然后声明一个函数

```
phoenix::function<no_empties_impl> const no_empties = no_empties_impl(); 
```

然后，在您的语法中，您需要为 、 、 和 中的每`position`一个`direction`定义`up`规则`FOVy`。然后你的开始语法看起来像（未经测试）：

```
start %=
lit("Camera")
>> '{'
>> position ^ direction ^ up ^ FOVy
>> '}'
    [qi::_pass = no_empties(qi::_0)]
; 
```

# resharper - 为什么 ReSharper 本身不支持带有测试运行器的 Xunit？

> ID：10126689
> 
> 赞同：0
> 
> 时间：2012-04-12T15:23:31.047
> 
> 标签：resharper, xunit

我可以看到有一个 Xunit.Contrib 插件，但是为什么 R# 本身不支持在 VS 中运行用 Xunit 编写的测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T08:42:58.220

可以就 ReSharper 当前不支持的任何单元测试框架（或者实际上是任何技术）提出这个问题。答案主要与时间和资源限制有关，以及单元测试框架的原始创建者通常能够更好地提供支持，对事物的工作方式有更好的理解。

# java - 如何绘制表示连接节点图的树？

> ID：10126695
> 
> 赞同：13
> 
> 时间：2012-04-12T15:23:49.253
> 
> 标签：java, swing, swt, awt

我想在 Java GUI 中显示一棵树，但我不知道如何。树表示连接节点的图，如下所示：

![图片](../Images/1535f0b9f9f00bd3c77c07ef48c49e63.png)

我应该说我有自己的树类：

```
public class BinaryTree  
{
private BinaryNode root;
public BinaryTree( )
{
    root = null;
}

public BinaryTree( Object rootItem )
{
    root = new BinaryNode( rootItem, null, null );
}

public BinaryTree( Object rootItem,BinaryNode a,BinaryNode b )
{
    root = new BinaryNode( rootItem, a, b );
}

public int leavesCount(){
    return BinaryNode.leavesCount(root);
}

public boolean equal(BinaryTree a,BinaryTree b){
    return BinaryNode.equal(a.root, b.root);

}

public void printPreOrder( )
{
    if( root != null )
        root.printPreOrder( );
}

public void printInOrder( )
{
    if( root != null )
       root.printInOrder( );
}

public void printPostOrder( )
{
    if( root != null )
       root.printPostOrder( );
}

public void makeEmpty( )
{
    root = null;
}

public boolean isEmpty( )
{
    return root == null;
}

public void merge( Object rootItem, BinaryTree t1, BinaryTree t2 ) throws MergeAbrot
{
    if( t1.root == t2.root && t1.root != null )
    {
         throw new MergeAbrot("MergeAbrot");

    }

     root=new BinaryNode( rootItem, t1.root, t2.root );

    if( this != t1 )
        t1.root = null;
    if( this != t2 )
       t2.root = null;
}

public int size( )
{
    return BinaryNode.size( root );
}

public int height( )
{
    return BinaryNode.height( root );
}

} 
```

我只想画树。我应该怎么做？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-12T18:59:20.273

您可以考虑以下任何一种：

*   [此处](https://stackoverflow.com/a/13997870/230513)引用的[JHotDraw](https://sourceforge.net/projects/jhotdraw/)是一个用于创建自定义图形编辑器的元库。

*   [Prefuse](https://en.wikipedia.org/wiki/Prefuse)可视化[库](https://stackoverflow.com/tags/prefuse/info)，[在此处](https://stackoverflow.com/a/30395586/230513)和[此处](http://prefuse.org/gallery/)进行说明。

*   [Batik](http://xmlgraphics.apache.org/batik/)，它实现了 SVG 渲染。

*   [JGraph](http://www.jgraph.com/jgraph.html) [演示](http://www.diagram.ly/)和[用户手册](http://www.jgraph.com/doc/mxgraph/index_javavis.html)。

*   [GraphStream](http://graphstream-project.org)，[此处](https://stackoverflow.com/a/45055683/230513)说明。

*   [JFreeChart](http://www.jfree.org/jfreechart/) [`XYBubbleRenderer`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/renderer/xy/XYBubbleRenderer.html)

*   A `JTree`，[这里](https://stackoverflow.com/a/10126761/230513)建议，带自定义[`TreeIcon`](https://stackoverflow.com/a/4641530/230513)。

*   自[定义渲染器](https://stackoverflow.com/a/10129112/230513)，其中*x*基于树宽的一部分，*y*基于递归级别。

*   一个简单的图形编辑器`draw.GraphPanel`，如图[所示](https://stackoverflow.com/a/11944233/230513)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-12T17:58:35.123

我能想到的最简单的方法是编写一个扩展`JPanel`并覆盖其`paintComponent()`方法的类。在paint 方法中，您可以遍历树并绘制每个节点。这是一个简短的例子：

```
import java.awt.Graphics;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class JPanelTest extends JPanel {

    @Override
    public void paintComponent(Graphics g) {
        // Draw Tree Here
        g.drawOval(5, 5, 25, 25);
    }

    public static void main(String[] args) {
        JFrame jFrame = new JFrame();
        jFrame.add(new JPanelTest());
        jFrame.setSize(500, 500);
        jFrame.setVisible(true);
    }

} 
```

如果您无法弄清楚您在问题中尝试过的内容，请尝试画树。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-08-14T09:34:49.203

我会说也值得看看[Abego 的 TreeLayout](http://treelayout.sourceforge.net/)。它本质上是一种树布局算法，因此可以与任何绘图机制一起使用，但它还包含一些在 SVG 和 Swing 中绘制图形的演示/示例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-12T15:27:01.307

我想你只需要阅读 JTree： [http ://docs.oracle.com/javase/tutorial/uiswing/components/tree.html](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html)

也许还有一些关于 Swing 的其他一般信息

# engineyard - 添加输出消息以部署挂钩

> ID：10126700
> 
> 赞同：2
> 
> 时间：2012-04-12T15:24:02.560
> 
> 标签：engineyard

我想向 deploy/before_bundle.rb 钩子添加一些消息，以便在部署时将进度的额外详细信息输出到命令行。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-08T21:38:26.190

你有没有尝试过：

```
run "echo 'this will make it to the terminal'" 
```

我只是猜测这可能会奏效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T15:46:41.317

这只是 Ruby，所以`puts`很好

```
puts "About to run a command"
run! "/bin/some/command"
puts "Finished"

# Sometimes the order seems off so try
$stderr.puts "About to run a command"
$stderr.flush 
```

# jquery - 在 IE8 中使用 Colorbox 出现幻影弹出问题

> ID：10126704
> 
> 赞同：0
> 
> 时间：2012-04-12T15:24:15.237
> 
> 标签：jquery, internet-explorer-8, popup, colorbox

[当单击此页面http://www.usalight.com/light-bulbs-s/1513.htm](http://www.usalight.com/light-bulbs-s/1513.htm)上未引用颜色框的链接时，我无法弄清楚为什么会出现此弹出/消失弹出窗口脚本。

例如，如果您单击卤素灯泡部分，您会看到一个颜色框弹出窗口出现并迅速消失。我只为水平的“灯泡”横幅使用颜色框，上面写着“你需要什么色温？”

我只在 IE8 中得到这种行为。我尝试过的所有其他浏览器都可以正常工作，包括 IE9。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T02:16:02.357

由于某种与颜色框无关的原因，横幅链接实际上包含了文档的很大一部分。当您点击一个链接时，比如说卤素灯泡，该链接和横幅链接都被点击了。通过在缩略图之间单击而不是在缩略图上单击，您可以更清楚地看到这一点。

# javascript - 自动完成 Jquery 替代品

> ID：10126705
> 
> 赞同：-3
> 
> 时间：2012-04-12T15:24:23.040
> 
> 标签：javascript, jquery, jquery-ui

我需要像[这样创建和自动完成](http://www.booking.com/)

我猜 Jquery UI 不能做这样的事情？

我需要手写吗，或者你会推荐什么开头？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:28:49.463

jQuery 是领先且最强大的 JavaScript 库：它有许多用于特定功能的插件，例如自动完成功能。然而，替代品是 Dojo Toolkit、Prototype、Mootools 和...

检查这个：

[http://jqueryui.com/demos/autocomplete/](http://jqueryui.com/demos/autocomplete/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:31:50.623

试试这个[http://code.google.com/p/jquery-autocomplete/](http://code.google.com/p/jquery-autocomplete/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:34:03.040

这可以通过 jQuery 自动完成轻松完成。查看此插件的自动完成功能： [https ://github.com/scottgonzalez/jquery-ui-extensions/blob/master/autocomplete/jquery.ui.autocomplete.html.js](https://github.com/scottgonzalez/jquery-ui-extensions/blob/master/autocomplete/jquery.ui.autocomplete.html.js)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-12T15:39:54.503

我假设您的意思是自动完成建议的自定义输出？您可以使用 jQuery 自定义自动完成结果的输出 - 没问题。例如：

```
$(this).autocomplete().data("autocomplete")._renderItem = function (ul, item) {
                    return $("<li></li>")
                        .data("item.autocomplete", item)
                        .append($("<a></a>").html(item.label))
                        .append($("<span>whatever you fancy in here..</span>"))
                        .appendTo(ul);
                }; 
```

我建议您谷歌“猴子修补 jquery 自动完成”以获取更多详细信息。

# javascript - 带有 jquery text() 的新行

> ID：10126708
> 
> 赞同：0
> 
> 时间：2012-04-12T15:24:25.923
> 
> 标签：javascript, jquery, dom

我必须在我的网页上显示此代码（总共 7 行）。这`<code>`仅用于显示，最好的用途是复制和粘贴以供自己使用。

```
<script type="text/javascript">
wg_width = '250px';
wg_height = '250px';
wg_lines = '3';
wg_bgcolor = '#003366';
</script>
<script src="wg.js" type="text/javascript"></script> 
```

我显示代码的 jquery 函数是：

```
function upcode(rec,w,h,color) {
var wHTML = ""; 
wHTML += ('<scr' + 'ipt type="text/javascript">\n');
wHTML += ("wg_lines = '" + rec + "';\n");
wHTML += ("wg_width = '" + w + "';\n");
wHTML += ("wg_height = '" + h + "';\n");
wHTML += ("wg_bgcolor = '" + color + "';\n");
wHTML += ('</scr' + 'ipt>\n');
wHTML += ('<scr' + 'ipt src="wg.js" type="text/javascript"></scr' + 'ipt>');
$("#box_code").text(wHTML);
} 
```

不幸的是，我的输出仅在 1 行，这不好

```
<script type="text/javascript">wgppn_lines = '5'; wgppn_width ='250px'; wgppn_height = '250px';wgppn_bgcolor = '#FF0000';</script> <script src="wgppn.js" type="text/javascript"></script> 
```

我也尝试过使用`html()`方法，`<br>`但这种方法`<script>`只去除标签显示

```
wg_width = '250px';
wg_height = '250px';
wg_lines = '3';
wg_bgcolor = '#003366'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:33:50.597

您可以将文本括在`<pre>`标签中：

```
wHTML = $('<div></div>').text(wHTML).html(); // let jQuery escape it for us
$('#box_code').html('<pre>'+wHTML+'</pre>'); 
```

您可以使用以下 CSS 使框代码的行为类似于 pre：

```
#box_code { white-space: pre; } 
```

您也可以更改语法以使用`&lt;script&gt`代替`<script>`等，然后`<br />`手动输入标签，但这似乎有点乏味。

# python - Python - 创建多个对象的巧妙方法？

> ID：10126710
> 
> 赞同：5
> 
> 时间：2012-04-12T15:24:31.303
> 
> 标签：python, oop, object

我对 Python 还很陌生，我有一个关于创建具有不同属性的多个对象的巧妙方法的问题。目前，我必须像这样专门创建每个：

```
object1 = MyClass(property=foo,property2=bar)
object1.DoStuff(variable = foobar)

object2 = MyClass(property=foo,property2=bar2)
object2.DoStuff(variable = foobar)

object3 = MyClass(property=foo,property2=bar3)
object3.DoStuff(variable = foobar) 
```

我的问题是我想以这种方式创建数十个对象，并且必须像这样手动创建每个对象似乎是非常糟糕的编程。有没有更好的方法来创建属性略有不同的多个对象？

我想我*想做*的是：

```
list = [prop1, prop2, prop3, prop4, prop5]
while i < len(list)
    object_i = MyClass(property=foo,property2=list[i])
    object_i.DoStuff(variable = foobar)
    i+=1 
```

并让它创建 5 个名为 object_1、object_2 等的对象

这可能吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-12T15:29:53.557

如果您有具有名称等的对象`object_1`，`object_2`并且想要对所有这些对象执行通用操作，这清楚地表明您实际上应该使用列表`objects`，并使用循环来执行通用操作。

```
props = <some list here>
objects = [MyClass(property=foo, property2=prop) for prop in props]
for obj in objects:
    obj.do_stuff(variable=foobar) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-12T15:45:20.497

另一种解决方法是在字典的帮助下使用更有意义的对象定义。如果您只关心 object_1、object_2 等，Sven Marnach 的解决方案效果很好，但如果您的对象稍后实际上具有单独的重要性怎么办？引用它们会变得不直观，你会很快迷路。以下是一些示例代码，可在这方面为您提供帮助：

```
objectNames = ("foo", "bar", "cat", "mouse")
objectDictionary = {}
for name in objectNames:
    objectDictionary[name] = MyClass(property=foo,property2=bar)

for obj in objectDictionary.itervalues():
    obj.DoStuff(variable = foobar) 
```

如果您希望特定实例执行与其他实例不同的操作，此解决方案使这变得简单：

```
objectDictionary["bar"].DoSomethingElse(variable = cat) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-12T15:27:14.790

使用元组解包和列表推导。

```
object_1, object_2, ... = [MyClass(property=foo, property2=x) for x in (bar,
  bar2, ...)] 
```

# javascript - 从 url 查询字符串中获取特定值

> ID：10126712
> 
> 赞同：4
> 
> 时间：2012-04-12T15:24:49.383
> 
> 标签：javascript, regex, url

我有以下 URL，我想使用 JavaScript 从中获取“id”值。

```
https://www.blabla.com/ebookedit?id=B0077RQGX4&commit=Go
```

我从这段代码开始：

```
var url = document.URL;
var id_check = /^\id...\E; // NOT SURE HERE
var final_id = new RegExp(id_check,url); 
```

我想提取 id“ **B0077RQGX4** ”并将其保存到我稍后会修改的变量中。我将如何做以及我将在 JavaScript 中使用*哪些函数？*

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-12T15:56:37.937

我想出了这个：

```
var final_id;
var url = document.URL;
var id_check = /[?&]id=([^&]+)/i;
var match = id_check.exec(url);
if (match != null) {
    final_id = match[1];
} else {
    final_id = "";
} 
```

效劳于：

```
https://www.blabla.com/ebookedit?id=B0077RQGX4&commit=Go
final_id = 'B0077RQGX4'

https://www.blabla.com/ebookedit?SomethingElse=Something&id=B0077RQGX4&commit=Go
final_id = 'B0077RQGX4'

https://www.blabla.com/ebookedit?commit=go&id=B0077RQGX4
final_id = 'B0077RQGX4'

https://www.blabla.com/ebookedit?commit=Go
final_id = ''

https://www.blabla.com/ebookedit?id=1234&Something=1&id=B0077RQGX4&commit=Go
final_id = '1234' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-12T15:51:20.290

~~虽然您可以使用 Regex 执行此操作，但如果您使用非 Regex 方法，它可能会更容易和/或更一致。之所以出现这种情况，是因为查询字符串可能有多种布局（`id`值为 first、last 或中间）。~~

**编辑：** @AdrianaVillafañe 证明这可以通过正则表达式轻松完成！我将把这个仅限 JS 的方法留在这里，因为它确实有效。

我喜欢使用这种 JavaScript 方法从 URL 解析查询字符串并获取与所需名称匹配的第一个值。在您的情况下，“id”将是`name`参数。

```
// parses the query string provided and returns the value
function GetQueryVariable(query, name) {
    if (query.indexOf("?") == 0) { query = query.substr(1); }
    var pairs = query.split("&");
    for (var i = 0; i < pairs.length; i++) {
        var pair = pairs[i].split("=");
        if (pair[0] == name) {
            return pair[1];
        }
    }
    return "";
} 
```

要使用此方法，您需要传入 URL 的查询字符串部分和要获取的值的名称。如果要解析当前请求的 URL，可以这样做：

```
var value = GetQueryVariable(location.search, "id"); 
```

~~在尝试处理查询字符串布局的可能变化时，尝试在 Regex 中执行此操作很可能是不一致的。~~

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T13:29:09.523

**试试这个。**

```
function getUrlVars()
{
  var vars = {};
  var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value)   
  {
     vars[key] = value;
  });
  return vars;
} 

function urlval()
{
    var x=getUrlVars()["id"];
    alert (x);
 } 
```

**现在 x 将在 id 中给出 B0077RQGX4 的值**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T15:44:40.030

像这样的东西应该工作。

```
var url = document.URL;
var regex = new RegExp("id=(.+)&");

var id = url.match(regex)[1];​​​​​​ 
```

[此处](http://jsfiddle.net/mmM3h/)为 jsfiddle 示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T15:28:53.177

好吧，它不是正则表达式，但你可以这样做

```
id=url.split('id=')[1].split('&')[0]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-17T23:12:52.350

以下工作非常好，并且比我找到的大多数解决方案更容易理解。

```
<script>
//Pulls the variables from a URL and saves them
function $_GET(q,s) {
    s = (s) ? s : window.location.search;
    var re = new RegExp('&'+q+'=([^&]*)','i');
    return (s=s.replace(/^\?/,'&').match(re)) ?s=s[1] :s='';
}

//Get the variables value
var urlvariablevalue = $_GET('id');

//Display the Value of the id from the URL
document.write(urlvariablevalue);
</script> 
```

# c - 如何编码视频文件以进行实时流式传输并通过 UDP 数据报传送

> ID：10126715
> 
> 赞同：1
> 
> 时间：2012-04-12T15:24:53.793
> 
> 标签：c, video, udp, video-streaming, video-encoding

我正在开发用于实时视频流的 P2P 系统。我想知道如何对源文件（即视频）进行编码，以便通过将编码内容封装在自定义 UDP 数据报中来实时传送它。

哪些视频格式更适合实时视频流？

如何在源端编码并在目标端解码视频？

在 C 中是否有任何实用程序可以做到这一点？

我可以使用哪个视频播放器来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T18:11:59.577

**你也可以检查这个：**

ffmpeg 通过为您完成所有解码、编码、复用和解复用来处理视频处理的所有艰苦工作。这可以使媒体应用程序更易于编写。它很简单，用 C 语言编写，速度快，几乎可以解码您今天使用的任何编解码器，还可以编码其他几种格式

ffmpeg 文档 [http://ffmpeg.org/ffmpeg.html](http://ffmpeg.org/ffmpeg.html)

UDP 原型流系统（但旧） [http://sys.cs.pdx.edu/trac/Cascades/browser/Trunk/Misc/Video/Codec/Misc/AVCodec/Source/FFMpeg-SVN-7063/libavformat/udp。 C](http://sys.cs.pdx.edu/trac/Cascades/browser/Trunk/Misc/Video/Codec/Misc/AVCodec/Source/FFMpeg-SVN-7063/libavformat/udp.c)

C代码

[http://www.ffmpeg.org/doxygen/trunk/encoding_8c-source.html](http://www.ffmpeg.org/doxygen/trunk/encoding_8c-source.html)

[http://www.inb.uni-luebeck.de/~boehme/using_libavcodec.html](http://www.inb.uni-luebeck.de/~boehme/using_libavcodec.html)

# css - @font-face 在 IE8 中不起作用，在 IE9 中起作用

> ID：10126719
> 
> 赞同：1
> 
> 时间：2012-04-12T15:25:03.360
> 
> 标签：css, internet-explorer-8

我的字体没有出现在**IE8**中，但它在**IE9**中有效。

```
@font-face {
  font-family: 'Ziggurat-HTF-Black';
  src: url('fonts/ziggurat-htf-black.eot');
  src: url('fonts/ziggurat-htf-black.eot?#iefix') format('embedded-opentype'), url('fonts/ziggurat-htf-black.woff') format('woff'), url('fonts/ziggurat-htf-black.ttf') format('truetype'), url('fonts/ziggurat-htf-black.svg#ziggurat-htf-black') format('svg');
  font-weight: normal;
  font-style: normal;
} 
```

**注意：**我从另一个发布的关于堆栈溢出的解决方案中获取了这个，所以说真的，它不是另一个问题的重复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:35:36.003

我不能确定这里出了什么问题，但我的建议是使用[fontsquirrel](http://www.fontsquirrel.com)生成必要的跨浏览器兼容 CSS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:38:53.713

语法很好，我会查看服务器配置或字体文件本身。你用过转换工具吗？再次尝试转换字体。

检查是否可以直接访问 EOT 文件（如果它在 IE9 中工作应该没问题）。

是否有针对 IE8 的 CSS 类？检查他们是否正在更改字体系列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T02:43:42.213

通过遵循此答案中的建议，我能够让我的 Ziggurat-Black 工作：[https ://stackoverflow.com/a/7169311/564879](https://stackoverflow.com/a/7169311/564879)

*“字体无法在 IE 中加载的最常见原因是字体作者对字体名称表进行了错误编码。Josefin 肯定是这种情况。姓氏 + 样式名称必须 = 全名。Josephine 没有做到这一点. 仅供参考 - fontsquirrel.com 会自动纠正其网络字体中的这些问题。”*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T15:34:23.383

从[这里](https://stackoverflow.com/a/5127439/339852)：

> 旧版本的 Internet Explorer在 CSS3 中正式化之前支持[*嵌入式 OpenType (EOT)*](https://stackoverflow.com/a/5127439/339852)文件。`@font-face`

# delphi - 为什么表单销毁事件被多次调用？

> ID：10126720
> 
> 赞同：0
> 
> 时间：2012-04-12T15:25:04.410
> 
> 标签：delphi, delphi-xe

我以前从未在我的程序中注意到它，但是对于我的一个 TForm，我有一个销毁事件，它释放一个对象，被多次调用或触发。我不明白为什么。

```
procedure THTrendFrm.FormDestroy(Sender: TObject);
begin
  LogAlarm.Free;  <---Invalid Pointer Operation exception is raised
end; 
```

提前致谢，

**更新**：这是我的程序关闭后的 FastMM 消息窗口。TAlarmMsg 是从中创建 LogAlarm 的类。 ![在此处输入图像描述](../Images/1cddbb448154f69a5a7cf10cd1a9f40c.png) ![在此处输入图像描述](../Images/377bbf039bc01b8b086a3536ded6ae60.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T20:09:26.813

该`TForm.OnDestroy`事件不会被多次调用，因此您必须在触发事件`LogAlarm`之前在代码中的其他位置释放该对象。`OnDestroy`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T13:42:03.213

感谢大卫赫弗南和其他人。我发现了我的问题并修复了它。有问题的 TForm 像这样在我的项目文件中创建了两次。

Application.CreateForm(HTrendFrm, HTrend);

这就解释了为什么 destroy 被调用了两次。

一旦我删除了重复的行，它就可以正常关闭了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T22:00:00.437

这取决于您如何创建 LogAlarm。

如果 LogAlarm 是 TComponent 的后代，并且您以表单的所有者身份创建了它，则不应在其上调用 Free，因为一旦表单被销毁，该组件将自动被清理。

或者，如果您坚持自己清理它，请在创建期间将 owner 保留为 nil。

# asp.net - DBNULL 分配给 Oracle 中的“NUMBER”字段

> ID：10126723
> 
> 赞同：0
> 
> 时间：2012-04-12T15:25:20.933
> 
> 标签：asp.net, oracle11g

我正在尝试将使用 SQL Server 的 ASP.Net 应用程序转换为使用 Oracle 11g 的应用程序。在表中，有一个字段定义为 Number(10,0)。它也是一个外键，因此 0 是该字段的无效值。在 DAL 中，我检查如下：

```
oraCmd.Parameters.Add(new OracleParameter("MPID", OracleDbType.Int32));
oraCmd.Parameters["MPID"].Direction = ParameterDirection.Input;                 

if (NewCustomer.MPId == 0)
    oraCmd.Parameters["MPID"].Value = DBNull.Value;
else
    oraCmd.Parameters["MPID"].Value = NewCustomer.MPID; 
```

MPId 为零时，添加“值不在预期范围内”的记录失败。

# php - index.php 301 重定向不适用于 Joomla 网站

> ID：10126727
> 
> 赞同：0
> 
> 时间：2012-04-12T15:25:33.070
> 
> 标签：php, .htaccess, mod-rewrite, joomla

我在我的 Joomla 网站上尝试了 .htaccess 中的以下代码，但它根本不起作用：

```
Redirect 301 /index.php / 
```

我也试过：

```
Redirect 301 www.domain.com/index.php www.domain.com/ 
```

基本上我不想有重复的页面，目前我可以使用 index.php 和不查看主页。

我不知道为什么 Joomla 会这样做，但它根本不起作用。我还在 Artio SEO 组件下完成了 301 重定向，但它也不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:27:18.673

试试这个：

```
<IfModule mod_rewrite.c>
  RewriteEngine on

  RewriteCond %{THE_REQUEST} ^.*/index.php
  RewriteRule ^(.*)index.php$ "http\:\/\/www\.yourdomain\.com\/$1" [R=301,L]
</IfModule> 
```

# objective-c - 如何将 UIView 中绘制的像素与 UIImageView 中的图像结合起来，并将其保存为新图像？

> ID：10126729
> 
> 赞同：0
> 
> 时间：2012-04-12T15:25:40.243
> 
> 标签：objective-c, ios, uiview, uiimageview

我想知道如何将 UIView 中的绘制像素与 UIImageView 中的图像结合起来并将其保存为新图像？我不知道该怎么做。

如果有人能指出我正确的方向，我会喜欢的。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T16:01:14.433

查看[Quartz 2D](https://developer.apple.com/library/mac/#documentation/graphicsimaging/conceptual/drawingwithquartz2d/Introduction/Introduction.html)。具体来说，`CGContextDrawImage()`可用于加载图像，在此上下文中绘制您想要的任何内容，然后您可以`CGBitmapContextCreateImage()`创建一个`CGImageRef`您可以从中创建图像的`UIImage`'s `imageWithCGImage`。最后，您使用`UIImagePngRepresentation()`or`UIImageJPEGRepresentation()`获取一个 NSData ，然后您可以使用`writeToFile`它。

# c++ - 是否可以在不处理输入缓冲区的情况下构造 wstring？

> ID：10126732
> 
> 赞同：0
> 
> 时间：2012-04-12T15:25:47.173
> 
> 标签：c++

在我的程序中创建了许多 std::wstring 对象，

```
std::wstring mystr(L"test string"); 
```

由于输入的 wchar 字符串是字符串常量，因此如果将 mystr 构造为 mystr.c_str() 等于 L“测试字符串”的地址，则会节省一些堆使用量。是否可以构造这样的 wstring？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:35:10.717

不。为了做到这一点， 的实现`std::basic_string`需要额外的信息来说明 是否`wchar_t const*`来自字符串文字，而这些信息根本不可用。即使是这样，它也会增加使用类的成本，即使参数不是`wchar_t const*`.

如果这些字符串在全局范围内，则构建它们的成本只是在启动时。而如果它们是局部变量，你总是可以声明它们`static`，这样构造它们的成本只会支付一次，而不是每次进入块时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:35:36.470

确实有有效的用例，但 C++ 字符串类完全不支持它。如果你真的需要它，你需要编写自己的支持实习的字符串类。

请注意，其他几种语言本机支持此功能；不幸的是，C++ 字符串类涵盖了一个相当具体的用例（大量修改）而不是一般用例（本质上不可变字符串的大量副本）。

为了简化任务，请考虑在一对（const）迭代器周围使用一个瘦包装类是否足够，这些迭代器可能只指向`wchar_t`静态内存中缓冲区的开始和结束。

# python - Ubuntu Chrome：如何从 python 脚本中读取 cookie

> ID：10126734
> 
> 赞同：7
> 
> 时间：2012-04-12T15:26:01.563
> 
> 标签：python, google-chrome, cookies, ubuntu

我正在创建一个包含两部分的小应用程序：其中一个显示在 Chrome 浏览器中，另一个是用 Python 编写的本地应用程序。

在 Chrome 中，用户`<select>`可以选择他/她的首选语言。该信息由 Chrome 存储在 cookie 中。

我想知道是否可以检索该语言首选项（意思是读取 cookie），因此当我运行本地应用程序时，它将以用户已经使用 Chrome 选择的相同语言显示。

不过，我无法更改系统的语言环境（这可能是最有意义的）。那必须保持英文，但如果用户通过 Chrome 选择*中文*作为首选语言，然后启动本地应用程序，我希望该应用程序能够以*中文*启动。

我一直在查看 Chrome 的[命令行开关](http://www.ericdlarson.com/misc/chrome_command_line_flags.html)，但没有看到任何有用的东西。最多，该`--enable-file-cookies`选项，然后尝试打开并解析cookie文件......不知何故，但我能找到的所有信息都非常模糊。

先感谢您！

更新。进一步搜索 ( [1](http://unlockforus.blogspot.com/2008/09/how-opening-google-chrome-files-history.html) , [2](http://www.techknowme.com/2010/10/how-to-read-the-google-chrome-cookies-file-on-a-mac/) ) 似乎表明 Chrome 使用 SQL lite 存储 cookie。我正在调查这个。或许还有希望……

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-12T17:38:56.723

是的，正如我在对我的问题的评论中提到的，sqlite3 听起来很有希望......当我学会阅读的那一天，我将征服世界！

无论如何，以防万一对其他人有帮助：

```
#!/usr/bin/env python
import os
import sqlite3
import pwd

_cookieName = "preferredLanguage"

def getPreferredLanguageFromCookieDB():
    retval="en-US"
    cookieDBFilename = os.path.join(pwd.getpwuid(1000).pw_dir, ".config/google-chrome/Default/Cookies")
    if os.path.isfile(cookieDBFilename):
        connection = sqlite3.connect(cookieDBFilename)
        querier = connection.cursor()
        numCookiesMatching = int(querier.execute('SELECT COUNT(*) FROM cookies WHERE (host_key="127.0.0.1" or host_key="localhost") and name="%s"' % (_cookieName)).fetchone()[0])
        if numCookiesMatching == 1:
            retval = querier.execute('SELECT value FROM cookies WHERE (`cookies`.`host_key`="127.0.0.1" or `cookies`.`host_key`="localhost") and `cookies`.`name` = "%s"' % (_cookieName)).fetchone()[0]
        elif numCookiesMatching == 0:
            print("::getPreferredLanguageFromCookieDB > No cookie for '%s' found. Assuming wizard hasn't run yet, which is weird, but not critical" % (_cookieName))
            retval="en-US"
        else:
            raise KeyError("Found %s cookies matching %s in file %s. This shouldn't have happened" % (numCookiesMatching, _cookieName, cookieDBFilename))
            retval=None
    else:
        print("::getPreferredLanguageFromCookieDB > Cookie 'db' (actually, file) %s doesn't exist" % (cookieDBFilename))
        retval="en-US"

    return retval

if __name__ == "__main__":
    print "Prefered language: %s" % getPreferredLanguageFromCookieDB() 
```

这个小片段将连接到 Cookies“数据库”（实际上只是文件，但无论如何......）并读取由或`preferredLanguage`发出的“” cookie的值。如果localhost 发出多个 " " cookie，它将崩溃。`localhost``127.0.0.1``preferredLanguage`

# jquery - 动态创建 JSON 对象

> ID：10126737
> 
> 赞同：0
> 
> 时间：2012-04-12T15:26:12.967
> 
> 标签：jquery, json

我想按照以下格式在 JSON 中动态创建以下对象。数据将来自不同的来源，我将从 Ajax 获得。您能否让我知道如何动态创建 JSON。

```
window.store1 = new Ext.data.JsonStore({
            fields: ['name', '2008', '2009', '2010','2011', 'data4', 'data5', 'data6', 'data7', 'data9', 'data9', 'data10', 'data11'],
            data: generateData(5, 20)
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:41:06.827

```
var d = {
            fields: ['name', '2008', '2009', '2010','2011', 'data4', 'data5', 'data6', 'data7', 'data9', 'data9', 'data10', 'data11'],
            data: 'You Data'
        }

var json = JSON.stringify(d) 
```

# java - httpURLConnection.getOutputStream() 上的 readTimeout？

> ID：10126738
> 
> 赞同：1
> 
> 时间：2012-04-12T15:26:13.640
> 
> 标签：java, httpurlconnection, outputstream, urlconnection, socket-timeout-exception

我有`HttpURLConnection`一个`readTimeout`设置为 500 毫秒的测试。根据我的理解，`readTimeout`等待响应的最大允许时间。但是，当我运行我的应用程序时，会在`getOutputStream`. `Exception`显然是由于`readTimeout`.

为什么`readTimeout`发生在`getOutputStream`？我认为`getOutputStream`仅用于发送数据，因此不应等待任何响应。而且由于它不必等待任何响应，`readTimeout`因此不会发生。最初，我认为这`readTimeout`将发生在`getInputStream`因为它是接收/读取响应的地方。你能解释一下 a`readTimeout`和是如何`connectTimeout`工作的吗？

另外，当我在之前和之后放置一个计时器时`getOutputStream`，调用后我的计时器的值`getOutputStream`只有200+毫秒。我`readTimeout`的是 500 毫秒。为什么`getOutputStream`超时时间早于 my 的 500 毫秒值`readTimeout`？请注意，我`connectTimeout`的设置为 0 或无限。

# c# - 有没有办法将 ContextMenuStrip 分配给 ListViewItem？

> ID：10126744
> 
> 赞同：3
> 
> 时间：2012-04-12T15:26:22.900
> 
> 标签：c#, winforms, listview, listviewitem, contextmenustrip

我想为表单上的所有 ListViewItems 分配相同的 ContextMenuStrip。这些 ListViewItem 是动态创建的。

不幸的是，ListViewItems 似乎没有可以分配给的 ContextMenuStrip 属性（当然，ListView 本身有）。

我是否必须将 ContextMenuStrip 分配给 ListView，然后根据 ListView 当前选定的项目，从那里继续？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-13T06:16:14.093

```
private void listView1_MouseDown(object sender, MouseEventArgs e)
{
    if (e.Button == MouseButtons.Right)
    {
        var hitTestInfo = listView1.HitTest(e.X, e.Y);
        if (hitTestInfo.Item != null)
        {
            var loc = e.Location;
            loc.Offset(listView1.Location);

            // Adjust context menu (or it's contents) based on hitTestInfo details
            this.contextMenuStrip2.Show(this, loc);
        }
    }
} 
```

# c# - Internet Explorer 不编码 url 参数

> ID：10126746
> 
> 赞同：4
> 
> 时间：2012-04-12T15:26:23.850
> 
> 标签：c#, asp.net, windows-7, internet-explorer-9

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:36:18.040

据推测，您的 Web 应用程序无法通过让用户手动在浏览器中键入查询字符串来工作。尝试创建一个测试 HTML 页面并在其中包含以下内容：

```
<a href="http://whatever.com?user=chantal.côté">link</a> 
```

在 IE 中打开这个测试页面，然后点击链接。查询字符串中的字符将被正确编码。似乎当您手动将内容放入地址栏中时，IE 不会为您对其进行 URL 编码，但希望这一事实与您的应用程序无关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:28:05.130

利用

```
HttpUtility.UrlEncode(string) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:30:21.777

尝试从另一端检查[HttpServerUtility.UrlEncode](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx)和[HttpServerUtility.HtmlDecode](http://msdn.microsoft.com/en-us/library/hwzhtkke.aspx)

# .htaccess - Allow access to a folder using htaccess

> ID：10126749
> 
> 赞同：0
> 
> 时间：2012-04-12T15:26:27.210
> 
> 标签：.htaccess

I'm working on a client site that was built using Zen Cart, I'm just adding a Wordpress blog to it. So I've setup a new folder called 'blog' and was just hoping that I could add a new tab to the top menu and link to the folder where Wordpress is installed.

The problem is I'm getting a 403 Forbidden error.

Is there any way to overcome this using htaccess ?

I've been doing a bit of Googling but could not figure it out.

Regards, Stephen

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:32:27.347

使用代码在目录中创建一个 .htaccess：

```
Satisfy Any,Deny
Allow from all 
```

# php - 使用 jQuery 加载页面但不加载到容器 div

> ID：10126756
> 
> 赞同：1
> 
> 时间：2012-04-12T15:26:41.473
> 
> 标签：php, jquery

我有一个下拉菜单，我从中选择一个文件类型，然后我希望它在一个页面上触发，该页面根据选择的内容生成一个文件并强制使用`header`php.ini 下载它。这是jQuery。

```
$('#exportdropdown').change(function(){
var searchinput = $('#searchinput').val();
var maxrec = $('#navdropdown option:selected').text();
    $('.loadCont').fadeIn();
    if($('#importbutton').hasClass('clickedButton')){
        $.get('export.php', {filter: 'import', maxrecords: maxrec, type: 'xls'});
    }else{
        $.get('export.php', {filter: 'export', maxrecords: maxrec, type: 'xls'});
    }
    $('.loadCont').delay('600').fadeOut();
}); 
```

我目前正在强制使用该类型进行测试，但它似乎并没有按我的预期工作。当您使用以下数据处理文件时，`export.php?filter='import'&maxrecords=15&type='xls'`它会强制下载正常。只是不使用 jQuery 方法。有什么明显的东西能让更有经验的人脱颖而出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:30:19.080

Ajax 在这里毫无意义，您所做的只是请求一个将文件推送到浏览器的链接。尝试：

```
window.location.href = "export.php?filter=" + filter + "&maxrecords=" + maxrecords + "&type=" + type; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:40:20.560

在我的几个项目中，我正在做类似但完全不同的事情:)。

在下拉单击时，我将打开新窗口并在那里执行 karim79 代码（例如在身体负载上）。所以

> 1.  点击下拉项目
> 2.  使用适当的参数打开新窗口，例如：

```
 window.open ("newindow.html?filter=" + filter + "&maxrecords=" + maxrecords + "&type=" +  type"); 
//this is not tested, but you got the point 
```

> 1.  在 body 的 onload 事件上执行：

```
window.location.href = "export.php?filter=" + filter + "&maxrecords=" + maxrecords + "&type=" + type"; 
```

> 或类似的东西。

# c# - Type.GetType() 动态字符串返回 null

> ID：10126758
> 
> 赞同：6
> 
> 时间：2012-04-12T15:26:51.560
> 
> 标签：c#

我正在使用`Type.GetType()`创建一个实例。

这有效：

```
 var type = Type.GetType("Test.ClassServices.HowService, Test"); 
```

但是，这行不通。它返回`null`：

```
 var name = "How";
 var type = Type.GetType("Test.ClassServices."+name+"Service, Test"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T15:39:54.183

不可复制。运行此示例：

```
var hardCodedWorking = Type.GetType("System.String");

var stringName = "String";
var concatenatedWorking = Type.GetType("System." + stringName);

var badStringName = "string";
var concatenatedNull = Type.GetType("System." + badStringName); 
```

从MSDN 上的[Type.GetType() ：](http://msdn.microsoft.com/en-us/library/w3f99sx1.aspx)

> 获取具有指定名称的 Type，执行区分大小写的搜索。

基于上面的例子和我的例子，我相信很可能是值`name`与类的名称不完全匹配。

# c# - Endianness - How to convert a c# integer into a big-endian byte (no byte array, just a single byte)?

> ID：10126759
> 
> 赞同：1
> 
> 时间：2012-04-12T15:27:00.530
> 
> 标签：c#, java, arrays, byte, endianness

Of course I know this have to do with endianess. I know Java is big-endian while C# is little-endian.

I have a working program in Java which sends a string to an external system. The thing is that they require to use a 2 byte header at the beggining of the string that represents its length.

In this 2 byte header, the first one is just to tell if the string exceeds 255 characters, if not, it is always 0\. But the second byte (which is the one that i can't get right in C#) will represent the length of the string, if the first byte is 0 (in almost all cases) it represents the whole lenth of the string, let's say 226.

So in java, I have this segment of code that calculates the header and append the original string so we can have the final string to send, and it works just fine:

Java working segment of code:

```
String iso_str = iso_buf.toString();    // This contains original string without header

int iso_len = iso_str.length();     // We need to know if it exceeds 255

int i, j;
i = (int)(iso_len / 256);           // Always 0\. It would be 1 if original string bigger than 255
j = (int)(iso_len % 256);           // Length of the string (most times 226)

Integer ii = new Integer(i);
Integer jj = new Integer(j);

byte[] bmsg_0200 = new byte[iso_len + 2];   // We create an array of bytes making room for the 2 bytes header and the original string
bmsg_0200[0] = ii.byteValue();      // Header byte number one
bmsg_0200[1] = jj.byteValue();      // Header byte number two

System.arraycopy(iso_str.getBytes(), 0, bmsg_0200, 2, iso_str.length()); // Then we just copy the original string in the array after the header         

String mensaje_str = new String(bmsg_0200); // Make the whole byte array into one string to send 
```

In the part that says: bmsg_0200[1] = jj.byteValue(); is where java actually gets a byte value that works (and I think it puts -30 there when jj is 226). And the final system understands this header, therefore reads all the message.

I tried to replicate the code in .NET (C#) and I have the following code:

C# not working segment of code:

```
int tramaISOLongitud = iso.Length;  // iso contains original string without header, We need to know if it exceeds 255

int i, j;
i = (int)(tramaISOLongitud / 256);  // Always 0\. It would be 1 if original string bigger than 255
j = (int)(tramaISOLongitud % 256);  // Length of the string (most times 226)            

byte[] tramaISOBytes = new byte[tramaISOLongitud + 2];  // We create an array of bytes making room for the 2 bytes header and the original string
tramaISOBytes[0] = Convert.ToByte(i);   // Header byte number one
tramaISOBytes[1] = Convert.ToByte(j);   // Header byte number two

System.Text.ASCIIEncoding encoding = new System.Text.ASCIIEncoding();
System.Array.ConstrainedCopy(encoding.GetBytes(iso), 0, tramaISOBytes, 2, tramaISOLongitud); // Then we just copy the original string in the array after the header

System.Text.ASCIIEncoding enc = new System.Text.ASCIIEncoding(); 
string tramaISOHeader = enc.GetString(tramaISOBytes); // Make the whole byte array into one string to send 
```

The last code compiles and everything, but gets the wrong byte in tramaISOBytes[1] = Convert.ToByte(j); because is little-endian. So i tried using System.Net.IPAddress.HostToNetworkOrder as follows:

```
int tramaISOLongitud = iso.Length;  // iso contains original string without header, We need to know if it exceeds 255

int i, j;
i = (int)(tramaISOLongitud / 256);  // Always 0\. It would be 1 if original string bigger than 255
j = (int)(tramaISOLongitud % 256);  // Length of the string (most times 226)    

int i2 = System.Net.IPAddress.HostToNetworkOrder(i);
int j2 = System.Net.IPAddress.HostToNetworkOrder(j);    

byte[] tramaISOBytes = new byte[tramaISOLongitud + 2];  // We create an array of bytes making room for the 2 bytes header and the original string
tramaISOBytes[0] = Convert.ToByte(i2);  // Header byte number one
tramaISOBytes[1] = Convert.ToByte(j2);  // Header byte number two

System.Text.ASCIIEncoding encoding = new System.Text.ASCIIEncoding();
System.Array.ConstrainedCopy(encoding.GetBytes(iso), 0, tramaISOBytes, 2, tramaISOLongitud); // Then we just copy the original string in the array after the header

System.Text.ASCIIEncoding enc = new System.Text.ASCIIEncoding(); 
string tramaISOHeader = enc.GetString(tramaISOBytes); // Make the whole byte array into one string to send 
```

But then j2 gets a huge number (like -503316480) that cannot be converted into a single byte because is too large and for sure i need it in one byte because the header as I said, is just 2 byte long. Any ideas?

Thanks in advance.

* * *

OK I will put this on a much simpler way:

In C#:

```
int test    = -10471344;
int test2   = -503316480;
int test3 = 57856;
byte b = (byte)test;
byte b2 = (byte)test2;
byte b3 = (byte)test3; 
```

If we run these lines we get: b = 80 b2 = 0 b3 = 0

So, why the number -10471344 casted to a (byte) gives 80; and the other ones just give 0? Actually I'm interested in the variable test2 = -503316480 I would like it to be converted in something else, and i get 0\. Why b can be 80 and the other ones cannot be something different than 0?

* * *

SOLUTION: As Jim said, my problem didn't have anything to do with endianness (although I thought it was everything related to that), but the key knowledge is that in .NET world converting a String into a byte array is no problem, but getting back from byte array to string is where you have problems because you have to use encoding (ASCIIEncoding or UTF8Enconding) and that's where problems arise because your bytes get mangled.

In java I didn't have this kind of problem.

So this is the block of code that did the job:

```
static byte[] addHeader2(string iso)
{
    int tramaISOLongitud = iso.Length;

    byte highByte = (byte)(tramaISOLongitud >> 8);
    byte lowByte = (byte)(tramaISOLongitud & 255);

    byte[] tramaISOBytes = new byte[tramaISOLongitud + 2];
    tramaISOBytes[0] = highByte;
    tramaISOBytes[1] = lowByte;

    System.Text.UTF8Encoding encoding = new System.Text.UTF8Encoding();
    System.Array.ConstrainedCopy(encoding.GetBytes(iso), 0, tramaISOBytes, 2, tramaISOLongitud);

    return tramaISOBytes;
} 
```

And I just send that byte array through the socket as it is.

THANKS TO ALL FOR YOUR HELP!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T17:01:49.877

您的问题与字节序无关。当你在做算术时，系统是大端还是小印度都没有关系。也就是说，鉴于此：

```
int len = 260;

byte highByte = (byte)(len >> 8);
byte lowByte = (byte)(len & 255);

Console.WriteLine("highByte = {0:X2}", highByte);
Console.WriteLine("lowByte = {0:X2}", lowByte); 
```

`highByte`永远是1 ，*永远**是*4。`lowByte`

 *无需进行 HostToNetWorkOrder 转换。

现在，如果您使用负值，您的除法和 mod 运算符会给您带来意想不到的结果。但是你说它是一个 2 字节长度的值，你存储在一个 int 中，所以负值不应该给你带来问题。

我认为，如果您单步执行原始 C# 代码，您会看到正确的值存储在`tramaISOBytes`数组的前两个位置。我怀疑当您尝试将生成的字节数组转换为字符串时会出现问题。您正在使用`ASCIIEncoding`将字节数组转换为字符串，这将破坏任何大于 127 (0x7Fh) 的字节。

所以，而不是你的转换是：

```
System.Text.ASCIIEncoding enc = new System.Text.ASCIIEncoding();
string tramaISOHeader = enc.GetString(tramaISOBytes); 
```

您想使用 8 位编码。也许像 ISO-8859-2 这样的东西。基本上，您想要一些不会尝试进行任何转换的东西。或者，更好的是，如果你把它放在一起进行传输，你甚至不应该转换回字符串。直接传输字节数组即可。这样一来，事情就没有被破坏的机会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:49:51.347

将 2 个字节复制到一个字节数组中，并尝试将字节转换为 ushort：

```
bool remoteSystemIsLittleEndian = false;
byte[] stringLengthBytes = new byte[] { 1, 255 };

if (BitConverter.IsLittleEndian != remoteSystemIsLittleEndian)
{
    Array.Reverse(stringLengthBytes);
}

int stringLength = (int)BitConverter.ToUInt16(stringLengthBytes, 0); 
```

这用于将数字转换回 2 字节数组：

```
bool remoteSystemIsLittleEndian = false;
int stringLength = 511;

byte[] stringLengthBytes = BitConverter.GetBytes((ushort)stringLength);

if (BitConverter.IsLittleEndian != remoteSystemIsLittleEndian)
{
    Array.Reverse(stringLengthBytes);
} 
```*

# python - 这个 python 代码中的语法错误在哪里？

> ID：10126764
> 
> 赞同：1
> 
> 时间：2012-04-12T15:27:03.593
> 
> 标签：python, syntax

我在最后一行 - 第 14 行遇到语法错误。但我不明白为什么，因为它似乎是一个简单的打印语句。

```
cel = "c"
far = "f"
cdegrees = 0
fdegrees = 0
temp_system = input ("Convert to Celsius or Fahrenheit?")
if temp_system == cel:
    cdegrees = input ("How many degrees Fahrenheit to convert to Celsius?")
    output = 5/9 * (fdegrees - 32)
    print "That's " + output + " degrees Celsius!"
elif temp_system == far:
    fdegrees = input ("How many degrees Celsius to convert to Fahrenheit?")
    output = (32 - 5/9) / cdegrees
    print "That's " + output + " degrees Fahrenheit!"
else print "I'm not following your banter old chap. Please try again." 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-12T15:27:57.800

您忘记了最后一个冒号 ( `:`) `else`。

还：

```
input ("Convert to Celsius or Fahrenheit?") 
```

应该改为

```
raw_input ("Convert to Celsius or Fahrenheit?") 
```

as`input()`尝试评估其输入，同时`raw_input`采用“原始”字符串。`c`例如，当您输入时，`input()`它会尝试评估表达式`c`，就好像它是查找变量的 Python 代码一样，`c`而`raw_input`只是获取字符串而不尝试评估它。

此外，您不能像在这种情况下那样将字符串与整数连接（相加），其中`output`是一个数字。

将其更改为

```
print "That's " + str(output) + " degrees Celsius!" 
```

或者

```
print "That's %d degrees Celsius!" % output 
```

# z3 - Z3 编译选项

> ID：10126772
> 
> 赞同：0
> 
> 时间：2012-04-12T15:27:34.507
> 
> 标签：z3

我想知道 Z3 是否使用 _SECURE_SCL=0 编译，因为我在另一个需要将其设置为 0 的应用程序中使用它。

谢谢，

AG。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T22:57:58.843

我们的构建配置不会更改 SECURE_SCL 选项的默认值。因此，它应该在 VS2010 下的发布模式下设置为 0：http: [//msdn.microsoft.com/en-us/library/aa985896 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/aa985896(v=vs.100).aspx)

# ios - iOS 上 YCrCb 像素格式的全范围 (420f) 和视频范围 (420v) 之间的差异

> ID：10126776
> 
> 赞同：21
> 
> 时间：2012-04-12T15:27:41.543
> 
> 标签：ios, image, colors, avfoundation

iPhone 4S 上的两种（三种支持的）像素格式是：

```
kCVPixelFormatType_420YpCbCr8BiPlanarVideoRange
kCVPixelFormatType_420YpCbCr8BiPlanarFullRange 
```

有谁知道其中的区别，使用其中一个有什么后果/优势吗？

Apple 的描述基本相同：http: [//developer.apple.com/library/mac/#documentation/QuartzCore/Reference/CVPixelFormatDescriptionRef/Reference/reference.html](http://developer.apple.com/library/mac/#documentation/QuartzCore/Reference/CVPixelFormatDescriptionRef/Reference/reference.html)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-12T18:10:45.737

视频范围意味着 Y 分量仅使用从 16 到 235 的字节值（出于某些历史原因）。全范围使用一个字节的全范围，即 0 到 255。

色度分量（Cb、Cr）始终使用全范围。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-04-15T00:34:48.243

*这是一个非常古老的问题，但之前接受的答案是不正确的，所以发布一个正确的答案。*

视频范围与全范围是指亮度和色度分量占据的范围。视频范围定义了“动态余量”、亮度和色度值，这些值通常不会被占用，但会在信号通过各种可能引入信号增益或衰减的模拟过程转换时保留信号。

```
kCVPixelFormatType_420YpCbCr8BiPlanarVideoRange

     8-bit 4:2:0 Component Y'CbCr format. Each 2x2 pixel block is represented
     by 4 unsigned eight bit luminance values and two unsigned eight bit
     chroma values. The chroma plane and luma plane are separated in memory. The
     luminance components have a range of [16, 235], while the chroma value
     has a range of [16, 240]. This is consistent with the CCIR601 spec.
     '420v' is the Apple Core Video four-character code for this pixel format.

kCVPixelFormatType_420YpCbCr8BiPlanarFullRange

     8-bit 4:2:0 Component Y'CbCr format. Each 2x2 pixel block is represented
     by 4 unsigned eight bit luminance components and two unsigned eight bit
     chroma components. The chroma plane and luma plane are separated in memory. The
     luminance components have a range of [0, 255], while the chroma value
     has a range of [1, 255].
     '420f' is the Apple Core Video four-character code for this pixel format.
     The equivalent Microsoft fourCC is 'NV12'. 
```

如果您可以选择格式，则最好使用全范围变体，因为它可以更准确地量化信号值。

# c# - Silverlight 应用程序作为服务提供商

> ID：10126780
> 
> 赞同：0
> 
> 时间：2012-04-12T15:28:03.230
> 
> 标签：c#, java, silverlight, web-services

我正在谷歌搜索教程或介绍如何使 Silverlight 应用程序成为服务提供者。这是交易：

Java 应用程序将 SOAP 消息发送到 Silverlight 控件

```
 Soap stuff..
  <ShowVisualisation>
    <URL>http://www.example.org/simulations/sim1.txt</URL>
  </ShowVisualisation>
 Soap stuff.. 
```

当 SL 应用程序收到消息时，它需要下载此文本文件并进行处理。自己编写 WSDL 非常繁琐且容易出错。

是否有教程/示例如何构建独立于 .Net 的 SL 服务？我正在寻找一些 WSDL 生成。

编辑：

我浏览了这些文章，似乎没有简单的方法可以让 SL 应用程序成为服务提供商。SL 应用程序不会托管在 IIS 上。因此，消息很简单，有没有更好的沟通方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T19:02:42.430

我建议你使用 WCF RIA 这里是一个让你开始的链接

[http://www.silverlight.net/learn/advanced-techniques/wcf-ria-services/get-started-with-wcf-ria-services](http://www.silverlight.net/learn/advanced-techniques/wcf-ria-services/get-started-with-wcf-ria-services)

我不相信您将能够在您的 silverlight 项目中托管您的 Web 服务，而是在同一个解决方案中。这可能比预期的要具有这种超响应的复杂性。好消息是您不必处理任何 WSDL 的东西，visual studio 和 eclipse 会为您处理这些。

干杯，

# linux - 带有管道的 bash 复合命令

> ID：10126783
> 
> 赞同：1
> 
> 时间：2012-04-12T15:28:10.180
> 
> 标签：linux, bash

如何明确指向 bash 例如命令的优先级是什么

> 屏幕 -dm -S 测试 tar zxvf /tmp | 枪弹

我想该*屏幕*与所有命令有关

> 焦油zxvf /tmp | 枪弹

但 bash 不知道。Bash 将其分为

> screen -dm -S 测试 tar zxvf /tmp

和

> 枪弹

如何使 Bash 在屏幕中运行整个命令。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T15:29:15.880

已经`screen`运行了一个外壳，并让外壳运行您的管道。

```
screen -dm -S test bash -c "tar zxvf /tmp | gunzip" 
```

# c# - String.Intern() 的用法在这个用例中有什么意义吗？

> ID：10126784
> 
> 赞同：1
> 
> 时间：2012-04-12T15:28:17.883
> 
> 标签：c#, string

在我正在开发的应用程序中，我正在创建几个对象，每个对象都具有以下属性：

```
 /// <summary>
    /// Gets the jumps text.
    /// </summary>
    public string JumpsText
    {
        get
        {
            return Jumps == -1 ? String.Empty : String.Format("{0} jump{1}", Jumps, Jumps != 1 ? "s" : String.Empty);
        }
    } 
```

这些对象用于迭代列表视图。创建的对象可以从 1 到最多 3000 不等，这意味着从上述属性创建的字符串对于不同的对象可以是相同的。

我的问题是：

`String.Intern(String.Format("{0} jump{1}", Jumps, Jumps != 1 ? "s" : String.Empty))`在这种情况下是否会建议使用 String.Intern() 。它会对创建的字符串使用的内存有什么影响吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:33:58.360

对于几千个条目，它根本不重要。根据经验，只要由于性能和内存消耗的原因 Listview 不是虚拟的，您就不需要担心字符串实习。

# jquery - 我在哪里可以找到 ui.core 和 ui.tabs js 文件？

> ID：10126786
> 
> 赞同：0
> 
> 时间：2012-04-12T15:28:29.437
> 
> 标签：jquery, javascript

我似乎再也找不到这些文件了，甚至在 google cdn 或 jQuery 的页面上也找不到。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:33:03.290

默认情况下，jQuery UI 将包含所有小部件代码，但您可以自定义和下载

[http://jqueryui.com/download](http://jqueryui.com/download)

在您的情况下，您只需取消选择所有非核心包并仅从小部件中选择选项卡，然后单击下载。

# c# - MonoTouch.Dialog - RootElement 的组为空或不是 RadioGroup

> ID：10126790
> 
> 赞同：0
> 
> 时间：2012-04-12T15:28:37.457
> 
> 标签：c#, xamarin.ios, monotouch.dialog

我正在使用 Monotouch.Dialog，并遇到此错误：

```
The RootElement's Group is null or is not a RadioGroup 
```

我正在使用的代码如下，我添加了注释，告诉你变量的状态：

```
 var groupSortChoices = new RadioGroup("S", Extensions.GetValues<PeopleDirectoryGroupSortEnum>().IndexOfItem (i => i.Element == Extensions.GetValue<PeopleDirectoryGroupSortEnum>(Options.GroupAndSort)).Value);
// new RadioGroup("S", 0)
        var nameDisplayChoices = new RadioGroup("N", Extensions.GetValues<PeopleDirectoryNameDisplayEnum>().IndexOfItem (i => i.Element == Extensions.GetValue<PeopleDirectoryNameDisplayEnum>(Options.NameDisplay)).Value);
// new RadioGroup("N", 0)

        var gsElems = Extensions.GetValues<PeopleDirectoryGroupSortEnum>()
            .Select(e => new RadioElement(e, "S"))
            .ToArray();
// String[4] array of this enum's values
        var ndElems = Extensions.GetValues<PeopleDirectoryNameDisplayEnum>()
            .Select(e => new RadioElement(e, "N"))
            .ToArray();
// String[2] array of this enum's values

        groupSortElement = new RootElement("Grouping and Sorting", groupSortChoices)
        {
            new Section("Grouping and Sorting")
            {
                gsElems
            },
        };

        nameDisplayElement = new RootElement("Name Display", nameDisplayChoices)
        {
            new Section("Name Display")
            {
                ndElems
            }
        };

        var root = new RootElement("Directory Options")
        {
            groupSortElement,
            nameDisplayElement
        };

        this.Root = root; 
```

我分解了这段代码以尝试调试它。错误肯定来自 groupSortElement 和 nameDisplayElement。我尝试在不使用“S”和“N”的情况下初始化我的组，但仍然出现相同的错误。我以前做过几次，但我一生都无法弄清楚我做错了什么。有任何想法吗？这两个 RadioGroup 不为空，如果我注释掉 groupSortElement 和 nameDisplayElement，就会出现一个空视图，告诉我这与这些元素有关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-17T15:22:11.130

我想到了。我试图将 RootElements 直接添加到 RootElement，而不是添加到 RootElement 包含的部分中。

# c# - ComboBox 中的数据绑定：使用用户控件显示每个项目

> ID：10126791
> 
> 赞同：1
> 
> 时间：2012-04-12T15:28:48.403
> 
> 标签：c#, wpf, xaml, data-binding, user-controls

我有一个模型类 Person 和一个 UserControl PersonComboBoxItem 来显示它。

我想做的是，创建一个`ComboBox`它的 ItemsSource 绑定到我`ObservableCollection<Person>`调用的 People 的位置，并使用我的 PersonUserControl 来显示集合中的每个 Person。

```
<Grid>
    <ComboBox SelectedIndex="0" ItemsSource="{Binding People}" >            
        <ComboBox.ItemTemplate>
            <DataTemplate>
                <local:PersonComboBoxItem Person="{Binding ###how do I get the current item here to set the property 'Person' on my PersonComboBoxItem class? ###  }"  />
            </DataTemplate>
        </ComboBox.ItemTemplate>
    </ComboBox>
</Grid> 
```

我已经[完成了这篇关于 msdn 上的数据绑定的精彩文章](http://msdn.microsoft.com/en-us/library/ms742521.aspx)，但我无法过渡到我的设计方法。随意批评它 - 我不确定，如果这是 WPF 方式来做到这一点。

问候，弗洛里安

PS：我的示例代码可以从[这里](http://dl.dropbox.com/u/1429970/ComboboxWithItemUserControl.zip)下载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:34:56.257

`DataContext`in`ItemTemplate`是当前的，`Person`直接绑定到 the`DataContext`并因此绑定到`Person`刚才使用的`{Binding}`。

您可以将您`UserControl`的设计直接使用当前`DataContext`而不是`Person`属性，然后您不需要显式设置任何内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:34:20.673

只需使用隐式告诉 WPF在可视化树中遇到对象时`DataTemplate`如何绘制它`Person`

```
<Grid>
    <ComboBox SelectedIndex="0" ItemsSource="{Binding People}" DisplayMemberPath="Name">            
        <ComboBox.Resources>
            <DataTemplate DataType="{x:Type local:Person}">
                <local:PersonComboBoxItem />
            </DataTemplate>
        </ComboBox.Resources>
    </ComboBox>
</Grid> 
```

`ComboBox`已经将您的数据`Person`对象放在 中`VisualTree`，并且可能看起来像这样：

```
<StackPanel>
    <ContentPresenter>
        <Person />
    </ContentPresenter>
    <ContentPresenter>
        <Person />
    </ContentPresenter>
    <ContentPresenter>
        <Person />
    </ContentPresenter>
    ...
</StackPanel> 
```

因此，您只需将其替换 `<Person />`为`<local:PersonComboBoxItem />`. 您的`DataContext`of 您`UserControl`也将设置为您的`Person`对象

此外，`DataContext`of the`PersonItemComboBox`将始终是 type `Person`，因此您甚至不需要`Person`依赖属性。

# java - JSF - 为受限页面实现过滤器

> ID：10126792
> 
> 赞同：3
> 
> 时间：2012-04-12T15:28:48.973
> 
> 标签：java, security, jsf, jakarta-ee, glassfish

我正在关注@BalusC 对[JSF 2.0 的回答：如何获取在浏览器地址栏中输入的 URL](https://stackoverflow.com/questions/4105263/jsf-2-0-how-to-get-the-url-that-is-entered-in-the-browsers-address-bar)以限制未登录用户的页面。

筛选：

```
public class RestrictPageFilter implements Filter{
    FilterConfig fc;

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
        fc=filterConfig;
    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        HttpServletRequest httpreq = (HttpServletRequest) request;
        HttpServletResponse httpres = (HttpServletResponse) response;
        if (httpreq.getUserPrincipal() == null) {
            httpreq.getSession().setAttribute("from", httpreq.getRequestURI());
            httpres.sendRedirect("/pages/login.xhtml");
        } else {
            chain.doFilter(request, response);
        }
    }

    @Override
    public void destroy() {
        // TODO Auto-generated method stub
    }
} 
```

网页.xml：

```
<security-constraint>
    <web-resource-collection>
      <web-resource-name>Admin pages</web-resource-name>
      <url-pattern>/admin/*</url-pattern>
      <url-pattern>/restricted/*</url-pattern>
      <http-method>GET</http-method>
          <http-method>POST</http-method>
    </web-resource-collection>
    <auth-constraint>
      <role-name>ADMIN</role-name>
    </auth-constraint>
  </security-constraint>

  <security-constraint>
    <web-resource-collection>
      <web-resource-name>User pages</web-resource-name>
      <url-pattern>/restricted/*</url-pattern>
      <http-method>GET</http-method>
          <http-method>POST</http-method>
    </web-resource-collection>
    <auth-constraint>
      <role-name>ADMIN</role-name>
      <role-name>USER</role-name>
    </auth-constraint>
  </security-constraint>

   <!--login-config>
     <auth-method>FORM</auth-method>
     <realm-name>jdbc-realm</realm-name>
     <form-login-config>
       <form-login-page>/pages/login.xhtml</form-login-page>
       <form-error-page>/pages/error.xhtml</form-error-page>
     </form-login-config>
   </login-config-->

    <filter>
        <filter-name>RestrictPageFilter</filter-name>
        <filter-class>gov.denis.chanceryweb5.filter.RestrictPageFilter</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>RestrictPageFilter</filter-name>
        <url-pattern>/restricted/*</url-pattern>
    </filter-mapping> 
```

glassfish-web.xml

```
<glassfish-web-app>
<security-role-mapping>
    <role-name>ADMIN</role-name>
    <group-name>ADMIN</group-name>
  </security-role-mapping>
  <security-role-mapping>
    <role-name>USER</role-name>
    <group-name>USER</group-name>
  </security-role-mapping> 
```

glassfish gui控制台中的领域： ![在此处输入图像描述](../Images/8d1be828852246b177056c6a8cf5d114.png)

访问我的网络应用程序时，在浏览器中我出于某种原因看到了这个？为什么？

![在此处输入图像描述](../Images/3db4e971cef6a0d56b441dd3f944f67c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T23:35:56.120

您将看到与 BASIC 身份验证方法相关的对话框。

您当前已将 web.xml 文件的 login-config 元素注释掉...因此未应用配置。

GlassFish 3 服务器具有默认登录配置，当用户部署的应用程序指定安全约束但未指定登录配置时使用该配置...

您的应用程序的有效登录配置实际上看起来像这样

```
 <login-config>
    <auth-method>BASIC</auth-method>
    <realm-name>file</realm-name>
  </login-config> 
```

默认登录配置在`glassfish3/glassfish/domains/<your domain name here>/config/default-web.xml`

# algorithm - 从一组字母中获取单词组合

> ID：10126796
> 
> 赞同：1
> 
> 时间：2012-04-12T15:28:56.977
> 
> 标签：algorithm, combinations

我在互联网上搜索了很多如何做到这一点，但我没有想出我完全理解的东西。

我试图通过指定每个组中的字母数量来从字母数组中生成所有可能的组合，例如：

字母：`A, B, C`

长度：`2`

结果：`AB, AC, BC`

（我知道有 : `BA`，`CA`但`CB`我只需要让组顺序无关紧要。）

示例 2：

字母：`A, B, C, D`

长度：`3`

结果：`ABC, ACD, BCD, CDA, DAB`

等等……</p>

我打算在 C++ 中实现该算法，但也欢迎使用 C#、Java 或 Javascript 的示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:53:08.243

如果您以可重现的方式对它们进行排序，您将找到一种更容易生成它们的算法：

让我们不要太容易，取 3 of 5：

```
e d c b a 
---------
    x x x abc
  x   x x abd
x     x x abe
  x x   x acd 
x   x   x ace
x x     x ade
  x x x   bcd
x   x x   bce
x x   x   bde 
x x x     cde 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:52:08.933

似乎很适合递归。获取每个元素，并将其添加到其余组合之前，直到满足给定的深度。

```
static List<String> func(List<String> a, Int32 depth)
{
    List<String> retVal = new List<String>();
    if (depth <= 0)
    {
        return retVal;
    }
    for (int i = 0; i < a.Count; i++)
    {
        String element = a[i];

        List<String> temp = new List<String>(a);
        temp.RemoveAt(i);
        List<String> resultset = func(temp, depth - 1);
        if (resultset.Count == 0)
        {
            retVal.Add(element);
        }
        else
        {

            foreach (String result in resultset)
            {
                retVal.Add(element + result);
            }
        }
    }
    return retVal;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-14T16:40:28.313

这被称为置换，有很多解决方案。这是我写的一个非递归的，速度非常快。（如果您在 Windows 上，您可能需要查找 _BitScanReverse 而不是使用 __builtin_ctz）。

```
#include <iostream>
#include <cstdlib>
using namespace std;

void perm(unsigned &v) { //v must be initialised with t = ( 2 << N ) - 1;
    unsigned t = v | (v - 1);
    v = (t + 1) | (((~t & -~t) - 1) >> (__builtin_ctz(v) + 1));
}

int main (int argc, char *argv[]) {
    unsigned n = argc > 1 ? atoi(argv[1]) : 3; //bins:   0..31
    unsigned k = argc > 2 ? atoi(argv[2]) : 2; //things: 0 .. bins.
    unsigned m = (1 << n) - 1; //bitmask is size of n (bins).
    unsigned v = (1 << k) - 1; //start value - initial allocation.
    do {
        cout << bitset<31>(v & m) << endl;
        perm(v);
    } while (v < m);
    return 0;
} 
```

在您的问题中，您建议 - 以字母：A、B、C 长度：2 为例。所以，这段代码会生成（传递 3 2 作为参数）（我已经评论过）

```
ABC
011 //BC
101 //AC
110 //AB 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-03T19:53:23.957

如果您稍微调整一下，这应该可以工作：

```
void r_nCr(const unsigned int &startNum, const unsigned int &bitVal, const unsigned int &testNum) // Should be called with arguments (2^r)-1, 2^(r-1), 2^(n-1)
{
    unsigned int n = (startNum - bitVal) << 1;
    n += bitVal ? 1 : 0;

    for (unsigned int i = log2(testNum) + 1; i > 0; i--) // Prints combination as a series of 1s and 0s
        cout << (n >> (i - 1) & 1);
    cout << endl;

    if (!(n & testNum) && n != startNum)
        r_nCr(n, bitVal, testNum);

    if (bitVal && bitVal < testNum)
        r_nCr(startNum, bitVal >> 1, testNum);
} 
```

[在这里](https://stackoverflow.com/questions/27308438/how-to-cheaply-calculate-all-possible-length-r-combinations-of-n-possible-elem/27308439#27308439)解释。

# wpf - Caliburn Micro 中的 WPF 上下文菜单

> ID：10126797
> 
> 赞同：14
> 
> 时间：2012-04-12T15:29:09.103
> 
> 标签：wpf, contextmenu, caliburn.micro, caliburn

我试图在 ListBox ItemTemplate 中获取上下文菜单以调用父视图模型上的方法，并将单击的项目作为参数传递。我为项目模板中的其他按钮工作，但对于上下文菜单，它似乎失败了。

我有以下 xaml（为清楚起见而缩写）：

```
<ListBox>
    <ListBox.GroupStyle>
        <GroupStyle>
            ...
        </GroupStyle>
    </ListBox.GroupStyle>
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid>
                <Grid.ContextMenu>
                    <ContextMenu Name="cm">
                        <MenuItem Header="Open" 
                                  cal:Message.Attach="Open($dataContext)">

                        </MenuItem>
                </Grid.ContextMenu>

                <TextBlock VerticalAlignment="Center" >
                    .. text..
                </TextBlock>
            </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

我感觉这与视觉树不同的事实有关，因此 Caliburn 无法可靠地解析该方法。我确定这是一个常见问题，我已经尝试了一些我在网上找到的东西，但似乎没有任何效果。

有任何想法吗？？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-23T23:39:14.010

使用我在[Caliburn Micro 网站](http://caliburnmicro.codeplex.com/discussions/241956)上找到的信息，我将您的 XAML 修改为如下所示：

```
 <Grid Background="White" HorizontalAlignment="Stretch" Height="200" Name="GridLayout">       
    <ListBox x:Name="ListBoxItems">            
        <ListBox.ItemTemplate>
            <DataTemplate>
                <Grid Tag="{Binding DataContext, ElementName=GridLayout}">
                    <Grid.ContextMenu>
                        <ContextMenu Name="cm" cal:Action.TargetWithoutContext="{Binding Path=PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                            <MenuItem Header="Open" 
                              cal:Message.Attach="Open($dataContext)">
                            </MenuItem>
                        </ContextMenu>
                    </Grid.ContextMenu>

                    <TextBlock VerticalAlignment="Center" >
                .. text..
                    </TextBlock>
                </Grid>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox>
</Grid> 
```

我的视图模型：

```
 public List<string> ListBoxItems { get; set; }
    public ShellViewModel()
    {
        ListBoxItems = new List<string> {"One", "Two", "Three"};          
    }

    public void Open(object source)
    {
        MessageBox.Show((string) source);
    } 
```

使用列表框中的适当字符串成功调用了 Open。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-17T17:43:14.803

添加到 Jason 的答案中，如果您要使用与控件相同的数据上下文，那么您可以绑定`DataContext`而不是`Tag`

```
<Grid>
    <Grid.ContextMenu>
        <ContextMenu cal:Action.TargetWithoutContext="{Binding Path=PlacementTarget.DataContext, RelativeSource={RelativeSource Self}}">
            <MenuItem Header="Open" 
                      cal:Message.Attach="Open($source)">
            </MenuItem>
        </ContextMenu>
    </Grid.ContextMenu>
</Grid> 
```

> `$source`触发 ActionMessage 的实际 FrameworkElement

您可以`$source`在此处查看有关该公约的更多信息：[https ://caliburnmicro.com/documentation/cheat-sheet](https://caliburnmicro.com/documentation/cheat-sheet)

# php - DOMXPath->评估没有找到我需要的 div

> ID：10126798
> 
> 赞同：1
> 
> 时间：2012-04-12T15:29:14.360
> 
> 标签：php, curl, web-scraping, domxpath

大家好，

我正在努力争取结果并取得了成功，但我现在陷入困境。

下面的代码显示有一个类为“vsc”的 DIV，其中是一个类为“r”的 H3。我可以使用 (//h3[@class='r'//a) 获取 H3 标签内的锚点。

我的问题是下面的表格也有一个带有“r”类的 H3，我不想要表格内的任何链接。

```
<li class="g">
<div class="vsc" pved="0CD4QkgowAA" bved="0CD8QkQo" sig="m15">
<h3 class="r">
<a href="https://ameriloan.com/" class="l" onmousedown="return          rwt(this,'','','','1','AFQjCNEazKuyTuAyYgnAT3MqI3aJoiAlZw','','0CDwQFjAA',null,event)">
</h3>
<div class="vspib" aria-label="Result details" role="button" tabindex="0">
<div class="s">
</div>
<table cellpadding="0" cellspacing="0" class="nrgt"> 
```

这是我用来抓取所有锚点的脚本，但它无法仅检索“vsc”DIV 中的 H3 锚点：

```
function getURL($url)

{
$ch=curl_init();
// This allows the script to accept HTTPS certificates "blindly"
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt ($ch, CURLOPT_URL, $url);
curl_setopt($ch,CURLOPT_HTTP_VERSION,'CURL_HTTP_VERSION_1_1' );
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true); // Follows redirects
curl_setopt($ch, CURLOPT_MAXREDIRS, 6);  // follows up to 6 redirects
$ret = curl_exec($ch);
return $ret;
}
$i = 0;
$rawKeyword = 'EXAMPLE';
$keyword = str_replace(' ', '+', $rawKeyword);

$url = "http://www.google.com/search?sourceid=chrome&ie=UTF-8&q=".$keyword;

//get the HTML through cURL function
$html = getURL($url);

// parse the html into a DOMDocument
$dom = new DOMDocument();
@$dom->loadHTML($html);

// grab all data
$xpath = new DOMXPath($dom);

// XPath eval to get page links and titles 
//$elementContent = $xpath->evaluate("//h3[@class='r']//a");
$elementContent = $xpath->evaluate("//div[@class='vsc']//h3[@class='r']//a");

// Print results
foreach ($elementContent as $content) {
  $i++;
  $clean = trim($content->getAttribute('href'), "/url?q=");
  echo '<strong>'.$i.'</strong>: <h3 style=" clear:none !important; font-size:10px; letter-spacing:0.1em; line-height:2.6em; text-transform:uppercase;">'.$content->textContent.'</h3><br/>'.$clean.'<br /><br />';
} 
```

我的评估查询做错了什么？

@jdwilemo - 你的方式是正确的，我试图只在 DIV 中使用“vsc”类来获取锚点。这是更多的表格代码，它显示了另一个具有“r”类的 H3 DIV ......

```
<table cellpadding="0" cellspacing="0" class="nrgt">
<tbody>
<tr class="mslg">
<td style="vertical-align: top; ">
<div class="sld vsc" pved="0CIYBEJIKMAE" bved="0CIcBEJEK" sig="Q_U">
<span class="tl">
<h3 class="r">
<a href="https://example.com/?page=ent_cs_login" class="l" onmousedown="return rwt(this,'','','','2','AFQjCNEyANjoolNXGFnLVKH3S1j4CO1qQw','','0CIQBEIwQMAE',null,event)">
</h3>
</span>
<div class="vspib" aria-label="Result details" role="button" tabindex="0">
<div class="s">
</div>
</li> 
```

一切都包裹在一个'li'标签中。该表是“li”标签中的最后一个元素。我想获得 <H3 class='r'> 锚点，而不是在 'li' 元素末尾的表格内获得 <H3 class='r'> 锚点。我希望我清除了...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T17:13:57.143

如果我正确理解了您的问题，那么您只需要带有 class=r AND 的 h3 的锚点，它位于*带有 class=vsc 的 div*下。但是您将返回多个 H3 节点。

如果这是正确的，您还需要在查询中指定 div 的类，就像对 h3 所做的那样：`//div[@class='vsc']/h3[@class='r'//a`

如果不是这种情况，请使用更多详细信息和更广泛的 xml 示例更新您的问题，其中包含您所指的模棱两可的数据，我会完善我的答案，希望对您有所帮助！

请注意：使用“//”是告诉 XPath 从“根”或开头开始，因此 //h3 的 XPath 将返回名称为“h3”的所有节点

**编辑：** 如果您想要在 div 中而不是在 table 元素中的锚点，只需像这样使用祖先函数：

```
//h3[@class='r' and not(ancestor::table)]//a 
```

希望这会有所帮助，如果我需要澄清其他任何事情，请告诉我！

# php - 如何保留一个简单的 XML 对象变量

> ID：10126800
> 
> 赞同：0
> 
> 时间：2012-04-12T15:29:21.943
> 
> 标签：php, drupal

我作为一个简单的 xml 表单对象从服务中获得响应

```
Array
(
    [result] => Array
        (
            [0] => Array
                (
                    [link] => SimpleXMLElement Object
                        (
                            [0] => LINK
                        )

                    [snippet] => Teaser 
                    [fragment] => foo 
```

我尝试将其分配给会话变量，缓存表（drupal）全局变量，但稍后无法获取实际对象，我得到空值或无效对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:54:32.327

您可以在将 xml 变量分配给会话时尝试使用[序列化](http://php.net/manual/en/function.serialize.php)，然后在另一端[取消序列化。](http://www.php.net/manual/en/function.unserialize.php)

# asp.net-mvc - 创建有错误的存储库？

> ID：10126806
> 
> 赞同：1
> 
> 时间：2012-04-12T15:29:41.787
> 
> 标签：asp.net-mvc, visual-studio-2010, asp.net-mvc-3, html, class

我正在尝试使用以下教程[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work创建一个存储库-patterns-in-an-asp-net-mvc-application](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)我得到这两个错误。

找不到类型或命名空间名称“IShowRepository”（您是否缺少 using 指令或程序集引用？）

找不到元数据文件“C:\Users\Ben\Documents\Visual Studio 2010\Projects\StudentTheatreGroupWebsite\StudentTheatreGroupWebsite\bin\StudentTheatreGroupWebsite.dll” StudentTheatreGroupWebsite.Tests

任何帮助将非常感激 ...

```
using System;
using System.Collections.Generic
using System.Data;
using System.Linq;
using StudentTheatreGroupWebsite.Models;

namespace StudentTheatreGroupWebsite.DAL
{
    public class ShowRepository : IShowRepository , IDisposable
    {
        private StudentTheatreContext context;

        public ShowRepository(StudentTheatreContext context)
        {
            this.context = context;
        }

        public IEnumerable<Show> GetShows()
        {
            return context.Shows.ToList();
        }

        public Show GetShowByID(int id)
        {
            return context.Shows.Find(id);
        }

        public void InsertShow(Show show)
        {
            context.Shows.Add(show);
        }

        public void DeleteShow(int ShowID)
        {
            Show show = context.Shows.Find(ShowID);
            context.Shows.Remove(Shows);
        }

        public void UpdateShow(Show show)
        {
            context.Entry(show).State = EntityState.Modified;
        }

        public void Save()
        {
            context.SaveChanges();
        }

        private bool disposed = false;

        protected virtual void Dispose(bool disposing)
        {
            if (!this.disposed)
            {
                if (disposing)
                {
                    context.Dispose();
                }
            }
            this.disposed = true;
        }

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:43:51.850

我在编辑之前复制了您的代码：

```
 using System; 
    using System.Collections.Generic; 
    using System.Linq; 
    using System.Web; 
    using StudentTheatreGroupWebsite.Models; 

    namespace StudentTheatreGroupWebsite.DAL { 

    public interface IStudentRepository : IDisposable { 
       IEnumerable<Show> GetShows(); 
       Show GetShowByID(int ShowId); 
       void InsertShow(Show Show); 
       void DeleteShow(int ShowID); 
       void UpdateShow(Show Show); 
       void Save(); 
  }
 } 
```

我会称它为“IShowRepository”，而不是 IStudentRepository，不是吗？

# jquery - Knockout.js 获取与数据关联的 dom 对象

> ID：10126812
> 
> 赞同：50
> 
> 时间：2012-04-12T15:29:57.200
> 
> 标签：jquery, dom, knockout.js

我正在使用 knockout.js 构建动态列表，并且试图弄清楚如何获取与我的可观察数组中的对象关联的 DOM 对象。具体来说，我想连续获取 jQuery。

例子：

```
<ul data-bind="foreach: Item">
    <li data-bind="events: {click: getDomObject}, text: 'text: ' + text">
    </li>
</ul> 
```

在`getDomObject`函数中，我希望能够获取特定的`<li></li>`DOM 对象，以便可以对它进行一些 jQuery 操作。

我曾想过`id`在Item ViewModel中添加一个成员，然后将id添加为line item的html id，然后在此基础上进行选择，但我觉得应该有更简单的方法。

引用由 knockout.js 生成的动态 HTML 的正确方法是什么？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-04-12T15:42:10.243

像 click 这样的事件处理程序传递了两个参数。那是

1.  此事件所属的项目 - 就像您使用 foreach 绑定（在您的情况下为“项目”）呈现的可观察数组的条目。

2.  并且，一个事件对象，它为您提供有关实际事件的更多信息。该对象包含被点击的 DOM 元素（键“目标”）：

    ```
    getDomObject = function(item, event) {
        var $this = $(event.target);
        // ...
    } 
    ```

请注意：不要混合使用敲除和原生 jQuery DOM 操作 - 如果您可以通过巧妙的敲除绑定获得相同的结果，我建议您使用它。

这是一个简单的演示：http: [//jsfiddle.net/KLK9Z/213/](http://jsfiddle.net/KLK9Z/213/)

```
var Item = function(color) {
  this.color = String(color);
  this.setTextColor = function(item, event) {
    $(event.target).css('background', color);
  };
};

ko.applyBindings(new function() {
  this.Items = ko.observableArray([
    new Item('red'),
    new Item('blue'),
    new Item('green')
  ]);
}());
```

```
li {
  padding: 2px 10px;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/2.0.0/knockout-min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<ul data-bind="foreach: Items">
  <li>
    <button data-bind="click: setTextColor, text: 'Color: ' + color"></button>
  </li>
</ul>
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-22T09:24:03.057

如果*$(event.target)*解决方案与项目的 DOM 元素位于目标的已经发生的事件相关，则它是很好的解决方案。但有时您没有目标项目，因为没有事件（例如 - 您想将列表滚动到用户未使用手势的项目）。

在这种情况下，您可以为项目的 DOM 元素 id 属性赋予一个包含项目 id 的唯一值：

```
<li data-bind="attr: {id: 'item_' + id}"> 
```

然后 getDomObject() 看起来像：

```
getDomObject = function(item) { return $("#item_" + item.id); } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-18T03:49:38.607

添加第三个选项，也适用于您没有事件可处理的情况（如果您有事件，则接受的答案是最佳/优化的）。

创建自定义绑定，例如：

```
ko.bindingHandlers.scrollTo = {
    update: function(element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        if (value) {
            var scrollParent = $(element).closest("div");
            var newTop = $(element).position().top + scrollParent.scrollTop();
            scrollParent.scrollTop(newTop);
        }
    }
}; 
```

用法如下：

```
<li data-bind="scrollTo: $parent.scrollTo() && $parent.scrollTo().id == id"> 
```

在上述情况下，$parent 是我的视图模型。我有一个包含唯一 ID 的可观察对象。每当我设置该 scrollTo() 对象时，列表都会滚动到该项目。

请注意，我的代码假定 LI 的父 DIV 具有滚动条（溢出：自动/滚动）。您可以根据需要进行调整，可能在父级上使用一个类并将其用于您的 jQuery 选择器，或者为了非常灵活，您可以通过数据绑定选项传入选择器......对我来说，这就足够了，因为我总是将 div 用于我的可滚动部分。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-12-29T09:45:26.047

我有一个类似的问题。我想出了一个类似于 Backbone.js 使用 el 和 $el 引用的解决方案。

在您的视图模型中：

```
var myViewModel = function(){
  var self = this;

  //html element
  self.el = ko.observable();

  //jquery wrapped version
  self.$el = ko.observable();
} 
```

在 html 中（例如列表元素）：

```
<!-- left side is the name of the handler, right side is name of the observable -->
<li class="myclass" data-bind="el: el, $el: $el"></li> 
```

在 bindingHandlers 中（显示 init 的所有可能参数）：

```
ko.bindingHandlers.el = {
  init: function(element, valueAccessor, allBindings, viewModel, bindingContext) {
    var value = valueAccessor();
    //assign value to observable (we specified in html)
    value(element);
  }
};

ko.bindingHandlers.$el = {
  init: function(element, valueAccessor, allBindings, viewModel, bindingContext) {
    var value = valueAccessor();
    //here we first create a jQuery object by using $(myelem)
    //before updating observable value
    value($(element).first());
  }
}; 
```

例如，您可以像这样使用 $el：

```
var myViewModel = function(){
  var self = this;

  //plain DOM element reference
  self.el = ko.observable();

  //jquery object reference
  self.$el = ko.observable();

  self.myFunction = function() {
    console.log(self.$el().html());
    self.$el().addClass("myCssClass");
  }
} 
```

希望这可以帮助！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-11-17T10:50:10.230

我的解决方案（对“值”绑定有效）

```
 ko.bindingHandlers.value.preprocess = function(val, name, cb) {
    /* every time I set a data-bind="value: xxxx" with an 
     * observable xxxx add also a data-bind="domElement: xxxx" */
    cb('domElement', val );
    return val;
}

ko.bindingHandlers.domElement = {
    /* For each data-bind="domElement: xxxx" add an extension "element" */
    init: function (element, valueAccessor, allBindingsAccessor, viewModel) { 
      valueAccessor().extend({element: element });
    }
  };

ko.extenders.element = function (target, element) {
    /* element extension add el and $el to observable xxxx */
    target.el = element;
    target.$el = $(element);
} 
```

现在你有了绑定到 jquery 和 DOM 元素的 yourobservable.$el 和 yourobservable.el。

# algorithm - 课表组成的遗传算法

> ID：10126814
> 
> 赞同：3
> 
> 时间：2012-04-12T15:30:03.953
> 
> 标签：algorithm, optimization, genetic

我正在编写自动大学日程安排的应用程序并用于此遗传算法。但现在我在实现方面遇到了一些问题。

一开始我假设我们有持续时间为 1 个时隙（时隙 = 1 小时）的课程，我们可以简单地将其放入数组中（表示时间表网格：容量为 numberOfRooms*numberOfDays*numberOfTimeslots 的一维数组）和也可以毫无问题地执行突变和交叉。

但是知道我想改进应用程序并允许有几个时隙持续时间的课程。这里会出现很多问题：

我们如何将一个类对象放入一个数组中并填充类必须占用的所有槽（几个数组单元）（一个对象 - 几个单元）？并且按照我们将如何将其放入数组中，如何执行变异和交叉操作？提前致谢！我真的很感谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T19:28:05.700

一个好的规则可能是只跨越具有相同时隙的类。例如，您可以将占用两个时隙的类与占用一个时隙的两个类交叉。

要表示具有多个时隙持续时间的类，最简单但棘手的方法是设置一个标志，该标志对于每个时隙会告诉您该时隙是被新类占用还是只是之前开始的类的延续。当你越过时，你会注意那面旗帜，以确保你没有穿过部分班级。

另一种（更好的）方法是创建更复杂的数据结构：`DailyRoomOccupation`. 该数据结构将包含：

*   房间的每日容量，以时段数表示；
*   当天在该房间安排的课程（双链接）列表；
*   计算列表中的类是否适合时隙的函数；
*   一个允许跨越两个不同`DailyRoomOccupation`s 的函数，只负责跨越相等数量的时隙。

# asp.net-mvc - 无论如何，ASP.NET MVC 都会获得身份验证重定向

> ID：10126815
> 
> 赞同：1
> 
> 时间：2012-04-12T15:30:04.913
> 
> 标签：asp.net-mvc, asp.net-mvc-3, authentication

所以我的 web.config 中有（如下）。但是除了我的默认页面之外的所有内容都被重定向到 login.aspx。/Content/ 中的所有内容以及任何其他页面。

```
<authentication mode="Forms"/>
<authorization>
  <allow users="*"/>
</authorization> 
```

我不知道是怎么回事。可以在本地顺利工作。在服务器上炸了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T16:22:15.767

您的默认页面是从哪个控制器提供的？我假设/Home/Index。

看看你的其他控制器，看看你是否出于某种原因在类或其任何方法上放置了 [Authorize] 属性。

如果是这样，用户必须拥有表单身份验证票才能查看这些控制器/操作的内容。

您可以删除 [Authorize] 属性以提供开放访问权限，或者您需要实施表单身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T11:17:35.767

它在本地工作，但是当你部署它失败？如果是这样，请检查此响应。

[IIS 上的 ASP.NET MVC3 和 Windows Auth 不断重定向到 /Account/Login](https://stackoverflow.com/questions/5009565/asp-net-mvc3-and-windows-auth-on-iis-keeps-redirecting-to-account-login)

它是关于 WebMatrix.Data.dll 和 WebMatrix.WebData.dll 的。这两个文件不应伴随部署。这两个迫使 login.aspx 重定向它似乎。

# javascript - 每次编辑 JS 代码时都需要重新启动服务器吗？- 流星

> ID：10126817
> 
> 赞同：2
> 
> 时间：2012-04-12T15:30:09.390
> 
> 标签：javascript, node.js, meteor

我开始玩 Meteor。不幸的是，有几件事让我慢了下来。

我正在编辑 JS 代码（我正在使用 CoffeeScript），但新代码似乎没有被拾取，需要重新启动服务器。

重新启动服务器也需要一段时间。所以每次编辑后需要等待10秒才能看到结果……有点乏味。

为了加快编辑和测试循环，我能做些什么？

多谢你们。帮助会很棒:)

## 编辑

好的，发现您可以使用在测试模式下运行流星

```
meteor run --production=false 
```

但是在修改coffeescript文件时，重新加载页面仍然需要10秒或更长时间。如果有人有任何想法，那将很有帮助。我想我现在会尝试不使用 CoffeeScript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:45:32.853

更改代码后，您可以使用[node-supervisor](https://github.com/isaacs/node-supervisor)自动重启服务器。

# xamarin.android - 在 monodroid 的 web 视图中显示谷歌地图

> ID：10126820
> 
> 赞同：0
> 
> 时间：2012-04-12T15:30:13.420
> 
> 标签：xamarin.android

这是我的想法……我有一个从 Activity 派生的基本活动，在我的一个派生活动中，我需要显示带有我当前位置的谷歌地图。如果我没有使用此基本活动，我将从地图活动中派生活动并使用 com.google.android.maps.MapView 地图控件。但因为我不，我不能...

所以我试图用地图活动派生我的基类，但即使这样它也不起作用我仍然有同样的例外

> Android.Views.InflateException：膨胀类 com.google.android.maps.MapView 时出错

所以，我想在网络视图中显示地图，但我只想显示地图，没有谷歌工具栏等等......我在网上寻找一种方法，我找到了一些链接，一个其中是[我](https://developers.google.com/maps/articles/android_v3)非常喜欢的，但我不知道如何使用 javascript。有人能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T09:29:31.200

因此，您在示例中的 WebView 中加载的 URL 很可能是：http: [//gmaps-samples.googlecode.com/svn/trunk/articles-android-webmap/simple-android-map.html](http://gmaps-samples.googlecode.com/svn/trunk/articles-android-webmap/simple-android-map.html)

此 html 页面包含显示在您链接到的示例底部的 JavaScript。您希望将其作为资产在您的应用程序中或在您的服务器上，以便可以轻松地对其进行修改。

该html的来源是：

```
<html> 
<head> 
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" /> 
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/> 
<title>Simple V3 Map for Android</title> 

<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script> 

<script type="text/javascript"> 
  var map;

  function initialize() {

    var latitude = 0;
    var longitude = 0;

    if (window.android){
      latitude = window.android.getLatitude();
      longitude = window.android.getLongitude();
    }

    var myLatlng = new google.maps.LatLng(latitude,longitude);

    var myOptions = {
      zoom: 8,
      center: myLatlng,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }

    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
  }

  function centerAt(latitude, longitude){
    myLatlng = new google.maps.LatLng(latitude,longitude);  
    map.panTo(myLatlng);
  }
</script> 
</head> 
<body style="margin:0px; padding:0px;" onload="initialize()"> 
  <div id="map_canvas" style="width:100%; height:100%"></div> 
</body> 
</html> 
```

由于这使用了普通的 Google Maps JavaScript API，您可以通过将其添加到`myOptions`数组中来轻松禁用 defaultUI：

```
disableDefaultUI: true, 
```

就像这里的文档说的：[https ://developers.google.com/maps/documentation/javascript/controls#DisablingDefaults](https://developers.google.com/maps/documentation/javascript/controls#DisablingDefaults)

# c - 在 C 中的特定时间执行动作

> ID：10126821
> 
> 赞同：2
> 
> 时间：2012-04-12T15:30:16.707
> 
> 标签：c, linux

我有一个 while 循环，它通过检索每一帧来解码视频文件，所以是这样的：

```
while (get_frame(codec_ctx, format_ctx, video_stream, frame) != 0) {
      ...
 } 
```

现在，一旦检索到帧，就需要在未来的某个时间点将其绘制到屏幕上（根据帧的时间戳）。这如何实现？有什么方法可以设置在特定时间执行的回调吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:35:38.440

您可以将（帧，时间）对推送到队列中，然后让单独的线程执行以下算法：

```
loop {
    time, frame = pop(queue);
    wait_until(time);
    display(frame);
} 
```

where`pop`等待一个项目被推入队列，如果它是空的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:34:33.897

用于`select(2)`等到您需要绘制框架（或直到您需要执行其他操作，由传递给`select()`被戳的 FD 之一指示）。

# php - 如何对 Symfony2 控制器进行单元测试？

> ID：10126826
> 
> 赞同：30
> 
> 时间：2012-04-12T15:30:23.557
> 
> 标签：php, unit-testing, symfony

我想尽可能多地使用测试驱动开发——这是一种很好的工作方式。

`Response`Symfony2 控制器创建并返回一个新对象，这让我感到困扰。

我希望能够单独对控制器进行单元测试。

你怎么做呢？

将控制器创建为普通旧 PHP 对象，将其注册为服务并使用依赖注入将新`Response`对象（或`Response`工厂）传递给它的答案是什么？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-04-12T21:48:03.693

通常，您的控制器将不同的对象插入在一起并以正确的顺序连接它们。也许他调用了一个存储库，读取了一些对象并通过 render 方法返回它们。也许他会打电话给其他一些做事的处理程序/经理。

这意味着控制器是高级组件。这通常表明功能测试是有序的，而不是单元测试。你的目标不应该是通过单元测试获得 100% 的代码覆盖率。也许您可以这样想：如果您对控制器调用的所有内容（模型、验证、表单、存储库）进行单元测试，会出现什么问题？大多数情况下，您只有在使用生产中涉及的所有真实类时才会观察到这种情况。

我还想指出，TDD 并不意味着一切都必须经过单元测试。可以对高级代码进行一些功能测试。如前所述，如果您使用单元测试测试低级组件，您应该只测试它们如何协同工作，而您无法使用模拟测试，因为您告诉模拟返回值是什么。

如果您的控制器不仅仅是将系统的各个部分连接在一起，您应该考虑将这些东西重构为更底层的类，您可以使用单元测试进行测试。

**所以我的建议**是使用功能测试来测试你的控制器并使用单元测试来测试你的模型和业务逻辑的东西。

如果您在功能测试方面遇到困难，可以阅读以下内容：

*   [http://symfony.com/doc/current/book/testing.html#functional-tests](http://symfony.com/doc/current/book/testing.html#functional-tests)
*   [http://blog.sznapka.pl/fully-isolated-tests-in-symfony2/](http://blog.sznapka.pl/fully-isolated-tests-in-symfony2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:36:40.877

使用模拟将模型和其他对象与主控制器方法的逻辑隔离开来，请参阅[http://www.phpunit.de/manual/3.7/en/test-doubles.html#test-doubles.mock-objects](http://www.phpunit.de/manual/3.7/en/test-doubles.html#test-doubles.mock-objects)

我认为在旧版本中你可以模拟整个班级，但我拥有的最新 phpunit 3.6.10 似乎不起作用。所以我猜你留下了依赖注入模式

```
class objss{
    function ss(){
        $x = new zz();
        var_dump($x->z());
    }
}

class MoTest extends PHPUnit_Framework_TestCase{
    public function setUp(){

    }

    public function testA(){
        $class = $this->getMock('zzMock', array('z'), array(), 'zz');
        $class->expects($this->any())->method('z')->will($this->returnValue('2'));

        $obj = new objss();
        $this->assertEquals('2', $obj->ss());
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-30T10:29:49.003

# 单元测试

将您的控制器重构为服务： [http ://symfony.com/doc/current/cookbook/controller/service.html](http://symfony.com/doc/current/cookbook/controller/service.html)

然后，您可以轻松地对它们进行单元测试。

# 功能测试

当然（正如其他人已经提到的）你可以使用`WebTestCase`这里描述的：http: [//symfony.com/doc/current/book/testing.html#functional-tests](http://symfony.com/doc/current/book/testing.html#functional-tests)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-03T17:51:10.293

刘易斯 - 我以为我会跳到这里。上面的方法让你在测试中复制你的动作逻辑的更好部分。这并没有错，许多框架（尤其是 Rails 中的 RSPEC）实际上建议您对 Controller 对象执行单元测试以及功能测试。但是，鉴于您的示例，我想我会跳过单元测试并采用功能方法。

在我看来，测试的重点是创建一个沙盒环境，运行测试，并检查副作用和直接结果。如果您的大部分测试都在隔离该方法，那么可能是时候使用不同的测试方法或编写类的不同方法了。鉴于这是一个控制器，并且本质上它们将堆栈的不同部分粘合在一起，我会在堆栈的更远位置创建您的沙箱。具体来说，我会使用这样的方法：

[https://github.com/PolishSymfonyCommunity/SymfonyMockerContainer](https://github.com/PolishSymfonyCommunity/SymfonyMockerContainer)

对我来说很好:)

# ios - xCode - 帮助尝试将撤消/重做功能添加到 UIBezier 路径

> ID：10126828
> 
> 赞同：0
> 
> 时间：2012-04-12T15:30:28.510
> 
> 标签：ios, xcode, core-graphics

我正在尝试向 iOS 应用程序添加撤消/重做功能。我希望能够画几条线，然后撤消每条线。我可以擦除整个东西，但这还不够好......我非常感谢帮助，因为这是我第一次尝试使用 CG ......

我的 .h 声明包括：

```
CGPoint lastPoint;
NSMutableArray *pathArray;
UIBezierPath *myPath; 
```

在.m中，我有：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    NSLog(@"%s", __FUNCTION__);
    UITouch *touch = [touches anyObject];
    myPath=[[UIBezierPath alloc]init];
    lastPoint = [touch locationInView:self.view];
    [myPath moveToPoint:lastPoint];
    lastPoint.y -= 20;
    [pathArray addObject:myPath];
    NSLog(@"pathArray count is %i", [pathArray count]);

}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    NSLog(@"%s", __FUNCTION__);
    UITouch *touch = [touches anyObject];   
    CGPoint currentPoint = [touch locationInView:self.view];
    currentPoint.y -= 20;   
    UIGraphicsBeginImageContext(self.view.frame.size);
    [drawImage.image drawInRect:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];

    CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound);
    CGContextSetLineWidth(UIGraphicsGetCurrentContext(), brush);
    CGContextSetRGBStrokeColor(UIGraphicsGetCurrentContext(), red, green, blue, 1.0);
    CGContextBeginPath(UIGraphicsGetCurrentContext());
    CGContextMoveToPoint(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y);
    CGContextAddLineToPoint(UIGraphicsGetCurrentContext(), currentPoint.x, currentPoint.y);
    CGContextStrokePath(UIGraphicsGetCurrentContext());

    drawImage.image = UIGraphicsGetImageFromCurrentImageContext();
    savedImage.image = drawImage.image;

    UIGraphicsEndImageContext();

    lastPoint = currentPoint;

} 
```

在 touchesBegin 结束时，pathArray 计数始终为零.. :(

为了实现撤消，我正在使用以下代码：

```
- (void)undoButtonTapped {
    NSLog(@"%s", __FUNCTION__);
    NSLog(@"pathArray count is %i", [pathArray count]);
    if([pathArray count]>0){
        UIBezierPath *_path=[pathArray lastObject];
        [bufferArray addObject:_path];
        [pathArray removeLastObject];
        [self.view setNeedsDisplay];
    }

} 
```

这里的计数也为零..

所有这些都在 UIViewController 中处理。我欢迎任何建议/改进/建议。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:37:51.687

我会说`[pathArray count]`零的原因是`touchesBegan`我在您的代码中看不到任何地方

```
pathArray = [[NSMutableArray alloc] init]; 
```

因此，您将消息发送到空指针（允许但不执行任何操作）。

那么你是在分配 pathArray 吗？还是为空？？

# c# - C# 中的富文本框和数据绑定

> ID：10126830
> 
> 赞同：0
> 
> 时间：2012-04-12T15:30:32.493
> 
> 标签：c#

我正在尝试将数据库中的数据绑定到富文本框中，这是我的代码：

```
 DataTable NameTable = new DataTable("NameTable");
        NameTable.Columns.Add("PropertyNo");
        NameTable.Columns.Add("PropertyName");

        DataSet NameSet = new DataSet();
        NameSet.Tables.Add(NameTable);

        selectQry = new SqlCommand("SELECT PropertyNo, PropertyName FROM Property", conn);
        SqlDataAdapter DataAdpt = new SqlDataAdapter(selectQry);

        DataAdpt.Fill(NameSet, "NameTable");

        Binding NameBinding = new Binding("Text", NameSet, "NameTable.PropertyName");
        NameRtb.DataBindings.Add(NameBinding); 
```

我只得到最后一个值。谁能帮我吗。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:58:10.767

我不认为这是可能的，我个人喜欢将数据表绑定到 DatagridView 的。

您需要做的就是：-

使用 Binding Source，将其 DataSource 设置为 DataTable。然后将 Datagridview 的数据源设置为绑定源。

例如下面： -

//DataGridView DataGridView dgView = new DataGridView();

//BindingSource同步DataTable和DataGridView BindingSource bSource = new BindingSource();

//设置BindingSource DataSource bSource.DataSource = dTable;

//设置DataGridView DataSource dgView.DataSource = bSource;

# php - mysql_result 已定义，但 mysql_free_result 警告它需要资源

> ID：10126833
> 
> 赞同：0
> 
> 时间：2012-04-12T15:30:44.107
> 
> 标签：php, mysql

此代码在释放之前测试是否有结果：

```
$result = mysql_query($query) or die("$query\n\n" . mysql_error());
$id = mysql_insert_id();
if ($result) { mysql_free_result($result); } 
```

但它给出了这个警告：

```
mysql_free_result() expects parameter 1 to be resource, boolean given in /foo/bar/etc.php 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:40:53.160

由于您已调用`mysql_insert_id()`，我假设您执行了`INSERT`查询而不是`SELECT`. 在那种情况下（与其他没有返回行集的情况一样），`$result`它只是成功的布尔值 TRUE，而不是结果资源。没有必要释放它，实际上尝试释放它会导致警告。

[从文档中`mysql_query()`：](http://php.net/manual/function.mysql-query.php)

> 对于 SELECT、SHOW、DESCRIBE、EXPLAIN 和其他返回结果集的语句，mysql_query() 成功时返回资源，错误时返回 FALSE。
> 
> 对于其他类型的 SQL 语句，INSERT、UPDATE、DELETE、DROP 等，mysql_query() 在成功时返回 TRUE，在错误时返回 FALSE。

但是，这并不意味着您不应该对其进行错误检查。

```
$result = mysql_query($query);
if ($result) {
  $id = mysql_insert_id();
}
else echo mysql_error(); 
```

# java - 如何减少不再需要的列表的内存消耗？

> ID：10126835
> 
> 赞同：0
> 
> 时间：2012-04-12T15:30:48.710
> 
> 标签：java

我已经搜索过这个，但似乎无法找到一个直接的答案。

基本上我有一些代码可以创建一个数组的副本（`Arrays.copyOf`用于创建`int[]`），它会做一些工作并输出结果或将结果发送`Arrays.copyOf`到队列以进行进一步处理。

如果我更改结果副本，我的结果不再正确，所以我认为我需要它，但我想知道完成后是否有什么可以做的，因为根据我的内存分析，它占用了我所有的内存和垃圾收集有帮助，但是它只是再次建立起来。我真的不确定这是否会有所帮助，但我想测试一下，如果我`int[]`在将其提交到队列后以某种方式将其删除，那么我的程序是否能像使用更小的内存占用一样运行。

我是 Java 新手，所以如果这个逻辑完全有缺陷，还有其他方法可以达到相同的结果吗？底线是我正在创建一个新数组，它被使用了一点，但在不再需要时徘徊（它占用了我最大内存的 15G，然后我相信垃圾收集器会进来并减少它，但它会在几个秒）。也许我可以将变量设置为 null 或者一旦我确定它不需要它（我正在复制的对象非常大）？

这里有一些代码只是为了说明我的意思（它有点蹩脚，但希望它能让你理解它在代码中的设置，所有这些都在多线程可调用中）：

```
 while(!queue.isEmpty()) {
                int[] data_list = Arrays.copyOf(current.list, current.list.length);

                    if (things work) {
                        Sysout("print results");
                    } else if (current.k > 0) {
                        queue.add(new Queue(data_list)); 

                    }
                }
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:38:01.290

一般来说，这里要做的是“相信垃圾收集器知道它在做什么”。JVM 非常擅长判断何时不再需要对象，尤其是如果它可以证明一个对象没有“逃避”创建它的方法。

Java 甚至没有提供删除对象正在使用的内存的方法，除了消除对它的所有引用——这正是您正在做的事情。

# tsql - 如何使用数据透视生成每周时间表

> ID：10126838
> 
> 赞同：2
> 
> 时间：2012-04-12T15:30:59.430
> 
> 标签：tsql, sql-server-2000, pivot

我想使用 sql server pivot 生成每周时间表。

我的数据库有这些表。

```
 create table Students
        (
            StudentID int identity primary key,
            Name nvarchar(50)
        )
        create table Times
        (
            TimeID int identity primary key
            ,Name nvarchar(10)
        )
        create table Days
        (
            DayID int identity primary key 
            ,Name nvarchar(20)
        )
        create table TimeTable
        (
            StudentID int references Students(StudentID)
            ,TimeID int references Times(TimeID)
            ,DayID int references Days(DayID)
            ,Value nvarchar(50)
        )

        insert Times values('t1')
        insert Times values('t2')
        insert Times values('t3')

        insert Days values('sunday')
        insert Days values('monday')
        insert Days values('tuesday')
        insert Days values('wednesday')
        insert Days values('thursday')
        insert Days values('friday')
        insert Days values('saturday') 
```

我想要列（DayID，DayName，t1，t2，t3）

我正在使用此查询，但由于在将记录插入时间表表时使用 Max(Value) 聚合函数，此查询显示列 t1、t2 和 t3 的一个值。但是 t2 和 t3 应该为空

```
 SELECT      *
            FROM         (SELECT     dbo.Days.DayID, dbo.Days.Name, dbo.Times.Name AS Expr1, dbo.TimeTable.Value
            FROM         dbo.Times CROSS JOIN
                                  dbo.Days LEFT OUTER JOIN
                                  dbo.TimeTable ON dbo.Days.DayID = dbo.TimeTable.DayID) AS d_1
            PIVOT (max (Value) FOR [Expr1] 
            IN (t1, t2, t3)) AS P 
```

例如，在执行这些 cmds 后，所有列都会显示 asp 值。

```
 insert Students values('ahmad')
            insert TimeTable values(1,1,1,'asp') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:58:15.423

您缺少从 TimeTable 到 Times 的匹配项：

```
 AND dbo.Times.TimeID = dbo.TimeTable.TimeID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T16:02:35.580

你非常接近试试这个：

```
create table #Students
(
    StudentID int identity primary key,
    Name nvarchar(50)
)
create table #Times
(
    TimeID int identity primary key
    ,Name nvarchar(10)
)
create table #Days
(
    DayID int identity primary key 
    ,Name nvarchar(20)
)
create table #TimeTable
(
    StudentID int references #Students(StudentID)
    ,TimeID int references #Times(TimeID)
    ,DayID int references #Days(DayID)
    ,Value nvarchar(50)
)

insert #Times values('t1')
insert #Times values('t2')
insert #Times values('t3')

insert #Days values('sunday')
insert #Days values('monday')
insert #Days values('tuesday')
insert #Days values('wednesday')
insert #Days values('thursday')
insert #Days values('friday')
insert #Days values('saturday')

insert #Students values('ahmad')
insert #TimeTable values(1,1,1,'asp') 

SELECT *
FROM 
(
    SELECT     d.DayID, d.Name, t.Name AS Expr1, tt.Value
    FROM         #Times t 
    CROSS JOIN #Days d
    LEFT OUTER JOIN #TimeTable tt
        ON d.DayID = tt.DayID
        AND t.TimeID = tt.TimeID) AS d_1
PIVOT (max (Value) FOR [Expr1] 
IN (t1, t2, t3)) AS P 

drop table #Students
drop table #Times
drop table #Days
drop table #TimeTable 
```

# cakephp - CakePHP：覆盖现有的重复数据

> ID：10126840
> 
> 赞同：1
> 
> 时间：2012-04-12T15:31:17.393
> 
> 标签：cakephp, duplicates, overwrite

如何让 Cake 使用 REPLACE INTO 而不是 INSERT INTO？我有一个将数据保存到数据库中的操作，但我不想有重复的条目。主键（id）是唯一的，如果该值已经存在，我不希望它作为新行输入。

正在保存的数据也是动态生成的，因此退出时出错是不合适的。

编辑最初我保存的数据在一个大数组中

```
$data = Array([0] => 'value1', [1] => 'value2', [2] => 'value3') etc 
```

我正在尝试遍历此数组，将每个值保存为新记录

```
foreach ($data as $value) { 
    $save_data['Model'] = array('field' => $value);
}
Classregistry::init('Model')->saveAll($save_data); 
```

我正在使用 Classregistry，因为我将数据保存到不同的模型。目前，此代码在尝试插入重复记录时会出错，因为“字段”是唯一索引。在使用 CakePHP 之前，我只是使用了 REPLACE INTO 语法，没有任何问题。我想在 Cake 中实现类似的东西。

我目前唯一的解决方法是允许输入重复项，但仅通过对它们进行分组来显示唯一的行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:38:36.360

指定数据中的主键：

```
// create a new record
$this->Model->create();
$this->Model->save(array(
  'Model' => array(
    'name' => 'new record'
  )
));

// update it
$this->Model->save(array(
  'Model' => array(
    'id' => $id,
    'name' => 'updated record'
  )
)); 
```

在您的编辑视图中，简单地说：

```
echo $this->Form->input('id'); // or your custom PK field 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-20T11:19:50.110

在 cakephp 3.0 中没有 $this->Model->create(); 它会返回未定义的错误。

我们可以通过传递类似下面的数据来做到这一点

```
foreach($sizeCategories as $sizeData){

	$iteamData['Item_Code']		= 'abc-'.$sizeData->sizes_id;
	$iteamData['Item_Desc']		= '';
	$iteamData['Article_ID']	= 0;
	$iteamData['ColorId']		= $colorData;
	$iteamData['CreatedBy'] 	= $this->request->session()->read('Auth.User.id');
	$iteamData['CreatedDate'] 	= Time::now();
	$iteamData['UpdateDate']  	= Time::now();
	$iteamData['Status']  		= '1';

	// Generaly we used $this->ItemMaster->patchEntity($itemMaster, $iteamData); that will update the data and overwrite the same entry again & again we should use the $this->ItemMaster->newEntity($iteamData);	
	// save data in loop 
	$itemMaster = $itemMaster = $this->ItemMaster->newEntity($iteamData);			

	if ($this->ItemMaster->save($itemMaster)) {
		$this->Flash->success(__('The products has been generated.'));
	}else{
		$this->Flash->error(__('The products could not be generate. Please, try again.'));
	}
}
```

# android - 在不丢失数据的情况下处理屏幕旋转 - Android

> ID：10126845
> 
> 赞同：51
> 
> 时间：2012-04-12T15:31:43.727
> 
> 标签：android, android-layout, android-intent

我正在疯狂地找出处理屏幕旋转的最佳方法。我在这里阅读了数百个问题/答案，但我真的很困惑。

如何在重新创建活动之前保存 myClass 数据，以便我可以保留重绘活动的所有内容，而无需进行其他无用的初始化？

有没有比 parcelable 更干净更好的方法？

我需要处理旋转，因为我想在横向模式下更改布局。

```
public class MtgoLifecounterActivity extends Activity {

    MyClass myClass;

    // Called when the activity is first created
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        If ( ?? first run...myClass == null ? ) {
            myClass = new MyClass();
        } else {
            // do other stuff but I need myClass istance with all values.
        }
        // I want that this is called only first time. 
        // then in case of rotation of screen, i want to restore the other instance of myClass which
        // is full of data.
    } 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-11-29T06:22:56.890

在清单的活动标签中，您应该提到

```
<activity
        android:name="com.example.ListActivity"
        android:label="@string/app_name" 
        android:configChanges="keyboardHidden|orientation"> 
```

如果您使用的是 Android 2.3（API 级别 13）及更高版本，请使用

```
<activity
        android:name="com.example.Activity"
        android:label="@string/app_name" 
        android:configChanges="keyboardHidden|orientation|screenSize"> 
```

它应该工作。

It will work only with **activity** tag and not with **application** tag

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-04-12T15:37:29.200

可以使用覆盖方法`onSaveInstanceState()`和`onRestoreInstanceState()`。或停止调用`onCreate()`屏幕旋转只需在清单 xml 中添加此行`android:configChanges="keyboardHidden|orientation"`

注意：您的自定义类必须实现`Parcelable`下面的示例。

```
@Override
    public void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        outState.putParcelable("obj", myClass);
    }

@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
 // TODO Auto-generated method stub
 super.onRestoreInstanceState(savedInstanceState);
 myClass=savedInstanceState.getParcelable("obj"));
}

public class MyParcelable implements Parcelable {
     private int mData;

 public int describeContents() {
     return 0;
 }

 /** save object in parcel */
 public void writeToParcel(Parcel out, int flags) {
     out.writeInt(mData);
 }

 public static final Parcelable.Creator<MyParcelable> CREATOR
         = new Parcelable.Creator<MyParcelable>() {
     public MyParcelable createFromParcel(Parcel in) {
         return new MyParcelable(in);
     }

     public MyParcelable[] newArray(int size) {
         return new MyParcelable[size];
     }
 };

 /** recreate object from parcel */
 private MyParcelable(Parcel in) {
     mData = in.readInt();
 }

} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-01-14T07:37:52.143

May be this is solved already but just for a small update for new members who stuck on it, just have a look at [Google Developer Site](http://developer.android.com/guide/topics/resources/runtime-changes.html), From API level 13, you just need to add this code to Manifest:

```
<activity android:name=".SplashScreensActivity"
          android:configChanges="orientation|keyboardHidden|screenSize"
          android:label="@string/app_name"> 
```

when one of these configurations change, SplashScreensActivity does not restart. Instead, the SplashScreensActivity receives a call to onConfigurationChanged(). This method is passed a Configuration object that specifies the new device configuration. By reading fields in the Configuration, you can determine the new configuration and make appropriate changes by updating the resources used in your interface. At the time this method is called, your activity's Resources object is updated to return resources based on the new configuration, so you can easily reset elements of your UI without the system restarting your activity.

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2017-07-25T05:07:02.713

The problem here is that you are losing the "state" of the App. In OOPs, What is a State? The Variables! Exactly! Hence when you are losing the data of your variables.

Now here is what you can do, Find Out the variables which are losing their states.

[![enter image description here](../Images/adc3415976332c025aacc3c53de98035.png)](https://i.stack.imgur.com/KjXD7.jpg)

When you rotate your device, your present activity gets completely destroyed, ie goes through **onSaveInstanceState()** `onPause() onStop() onDestroy()` and a new activity is created completely which goes through `onCreate() onStart()` **onRestoreInstanceState**.

The Two Methods in the bold, **onSaveInstanceState()** saves the instance of the present activity which is going to be destroyed. **onRestoreInstanceState** This method restores the saved state of the previous activity. This way you don't lose your previous state of the app.

Here is how you use these methods.

```
 @Override
    public void onSaveInstanceState(Bundle outState, PersistableBundle outPersistentState) {
        super.onSaveInstanceState(outState, outPersistentState);

        outState.putString("theWord", theWord); // Saving the Variable theWord
        outState.putStringArrayList("fiveDefns", fiveDefns); // Saving the ArrayList fiveDefns
    }

    @Override
    public void onRestoreInstanceState(Bundle savedInstanceState, PersistableBundle persistentState) {
        super.onRestoreInstanceState(savedInstanceState, persistentState);

        theWord = savedInstanceState.getString("theWord"); // Restoring theWord
        fiveDefns = savedInstanceState.getStringArrayList("fiveDefns"); //Restoring fiveDefns
    } 
```

EDIT : **A Better Approach:** The above approach toward maintaining your data isn't the best way to maintain data in production code/apps. Google IO 2017 introduced ViewModel to protect your data against configurational changes (like Screen Rotation). Keeping all data inside the activity using variables isn't a good software design and violates the *Single Responsibility Principle* hence separate your data storage using ViewModel from the activities.

*   ViewModel will be responsible for the data to be displayed.
*   Activity will be responsible for how to display the data.
*   Use additional repository class if you have an increasing complexity of storing the data.

That's just one of the way to separate classes and their responsibility, which will go a long way while making well-architectured apps.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-04-12T15:37:04.387

如果您不需要重新启动活动，只需将 AndroidManifest.xml 中活动的 configChanges 属性设置为：

```
 android:configChanges="keyboard|keyboardHidden|orientation" 
```

这将告诉操作系统您将负责处理轮换，并且不会重新启动您的活动。使用此方法将消除您必须保存任何类型的状态的需要。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-04-12T15:37:38.723

有两种（好的）方法。让你的类实现 Parcelable 并将它放在一个包中`onSaveInstanceState()`，或者，如果它更复杂（例如 AsyncTask），将它返回到`onRetainNonConfigurationInstance()`.

然后还有一种懒惰的方式，您只需停止对配置更改做出反应。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-03-14T05:53:22.937

Its solve my problem.

```
<activity android:name=".MyActivity"
      android:configChanges="orientation|screenSize|screenLayout|keyboardHidden"
      android:label="@string/app_name"> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-12-09T17:32:18.187

from the documentation:

> Note: If your application targets Android 3.2 (API level 13) or higher, then you should also declare the "screenSize" and "screenLayout" configurations, because they might also change when a device switches between portrait and landscape orientations.

so what you shpuld write will be :

```
<android:configChanges="keyboardHidden|orientation|screenSize|screenLayout"> 
```

# c# - 从 Visual Studio 扩展生成代码

> ID：10126846
> 
> 赞同：9
> 
> 时间：2012-04-12T15:31:44.273
> 
> 标签：c#, visual-studio-2010, visual-studio-extensions, office-addins

我有一个基于元数据生成文本（表示接口和类）的项目。我想把这个生成的代码作为一个新的类和接口直接插入到特定项目和目录下当前打开的解决方案中。我将创建将生成类的菜单工具，但我不知道如何从我的自定义 Visual Studio 扩展中访问以下项目：

1.  迭代当前解决方案并找到一个项目将生成的代码转储到其中。
2.  在 Visual Studio 中打开一个新文件窗口，并将我的工具生成的文本直接注入该窗口。
3.  在我的自定义扩展中的当前解决方案中的特定项目中创建一个新文件夹。

编辑 - 为了澄清我需要打开一个新文件（例如，右键单击项目 -> 添加 -> 新类）并从我的自定义 Visual Studio 扩展中将文本插入其中。

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-15T05:25:24.853

要从 Visual Studio 扩展 (ToolWindowPane) 创建新文件，首先使用 GetService 方法：

```
// Get an instance of the currently running Visual Studio IDE
DTE dte = (DTE)GetService(typeof(DTE)); 
```

其次，确保当前打开了解决方案，如果没有打开解决方案，则文件生成将不起作用：

```
string solutionDir = System.IO.Path.GetDirectoryName(dte.Solution.FullName); 
```

第三，从 DTE 对象生成新文件：

```
dte.ItemOperations.NewFile(@"General\Visual C# Class", "ObjectOne", EnvDTE.Constants.vsViewKindTextView); 
```

创建新文件后，使用以下代码访问该文件的文本并将其替换为您生成的文本：

```
TextSelection txtSel = (TextSelection)dte.ActiveDocument.Selection;
TextDocument txtDoc = (TextDocument)dte.ActiveDocument.Object("");

txtSel.SelectAll();
txtSel.Delete();
txtSel.Insert("Hello World"); 
```

# spring - Spring bean 顺序如何保证？PropertyPlaceHolder 问题

> ID：10126847
> 
> 赞同：4
> 
> 时间：2012-04-12T15:31:47.940
> 
> 标签：spring, properties, initialization

我有一个非常简单和小型的服务，我正在使用 spring。为了配置数据库连接，我有一个 DataSource bean，我使用了一个“datasource.properties”文件，该文件使用 .

交易是 Spring 在读取属性文件之前初始化数据源 bean，这样，数据源 bean 正在尝试使用“${datasource.driver}”驱动程序。

如何保证在初始化数据源 bean 之前加载属性？

请看下面的一段代码：

```
<context:property-placeholder location="classpath:config/datasource.properties"/>
<import resource="classpath:spring/spring-*.xml"/>

<bean id="bdsDatasource"    class="com.mchange.v2.c3p0.ComboPooledDataSource"   destroy-method="close">
    <property name="driverClass"    value="${datasource.bds.driver}" />
    <property name="jdbcUrl"        value="${datasource.bds.url}" />
    <property name="user"           value="${datasource.bds.user}" />
    <property name="password"       value="${datasource.bds.password}" />
</bean> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T22:27:09.990

### *如果*

*   `property-placeholder`在相同的应用程序上下文中使用，并且
*   `<import resource="classpath:spring/spring-*.xml"/>`没有自己`property-placeholder`的覆盖 import 语句之前定义的那个，并且
*   `datasource.properties`真的有一个`datasource.bds.driver`

### *然后*

`bdsDatasource`应该可以毫无问题`${datasource.bds.driver}`地解决。

### *如果*

还有一个地方覆盖了声明之前定义的地方*，*这里有两件事要尝试：`property-placeholder``import`

*   在 import 语句`property-placeholder` *之后*定义你的：

```
<import resource="classpath:spring/spring-*.xml"/>
<context:property-placeholder location="classpath:config/datasource.properties"/>

<bean id="bdsDatasource"    class="com.mchange.v2.c3p0.ComboPooledDataSource"   destroy-method="close">
    <property name="driverClass"    value="${datasource.bds.driver}" />
    <property name="jdbcUrl"        value="${datasource.bds.url}" />
    <property name="user"           value="${datasource.bds.user}" />
    <property name="password"       value="${datasource.bds.password}" />
</bean> 
```

*   添加一个`order`属性到`property-placeholder`：

```
<context:property-placeholder 
    location="classpath:config/datasource.properties" 
    order="0"/> 
```

潜在地覆盖几个`property-placeholder`bean的顺序

# asp.net-mvc-4 - MVC4 Web Api 没有序列化我的课程

> ID：10126848
> 
> 赞同：1
> 
> 时间：2012-04-12T15:31:48.260
> 
> 标签：asp.net-mvc-4, asp.net-web-api

我开发了一个非常简单的 WebApi 来测试一些 Knockout.js 功能。IMO 它应该可以正常工作，但是当我通过 Fiddler 向 Api 发出 GET 请求时，它根本不会返回任何 JSON。

我正在使用 MVC4 的 JSON 默认序列化程序。

这是我的模型...

```
public class Page
{
    public string Name { get; set; }
    public List<Control> Controls { get; set; }        
}

public abstract class Control
{
    public string Name { get; set; }
    public abstract string SayHi();
}

public class Form : Control
{
    public override string SayHi()
    {
        return string.Format("Hi, I'm form {0}", Name);
    }
}

public class Datagrid : Control
{
    public override string SayHi()
    {
        return string.Format("Hi, I'm datagrid {0}", Name);
    }
} 
```

...这是我的控制器...

```
public class PageController : ApiController
{
    static readonly ISimplePageRepository _repository = new TestPageRepository();

    // GET /api/page
    public IEnumerable<Page> GetAllPages()
    {
        return _repository.GetAll();
    }
} 
```

...以防万一，这是我的回购...

```
public class TestPageRepository : ISimplePageRepository
{
    private List<Page> _pages = new List<Page>();

    public TestPageRepository()
    {
        Add(new Page {Name = "pagina1", Controls = new List<Control>() {new Datagrid() {Name = "laTablita"}}});
        Add(new Page {Name = "pagina2", Controls = new List<Control>() {new Form() {Name = "elFormito"}}});
    }

    public Page Add(Page item)
    {
        _pages.Add(item);
        return item;
    }

    public IEnumerable<Page> GetAll()
    {
        return _pages.AsQueryable();
    }
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T15:28:02.850

我将默认序列化程序更改为 JSON.NET 并且它有效。显然，问题出在默认序列化程序和抽象 Control 类上。

# jquery - AJAX 请求 + jQuery 的内存泄漏

> ID：10126852
> 
> 赞同：6
> 
> 时间：2012-04-12T15:32:15.357
> 
> 标签：jquery, ajax, json, memory-leaks

我通过 AJAX 调用反复从服务器获取 JSON 对象。随着时间的推移，浏览器的内存使用量会增加（尝试使用 Chrome、Safari、Firefox）。使用 Chrome 的堆快照，我发现时间戳字符串没有任何引用。如果我拍摄一系列快照，我会看到字符串的数量在不断增加。

```
$(function() {
    var latestTimestamp = 0;

    function fetchData() {
        $.get("/parameter?format=json&since=" + latestTimestamp, gotData)
    }   

    function gotData(data) {
        latestTimestamp = data['timestamp'];
        setTimeout(fetchData, 250);
    }   

    fetchData();
}); 
```

其他注意事项：

*   我正在使用 jQuery 1.7.1。编辑：刚刚尝试了 1.6.2 和 1.4.2，同样的问题。
*   JSON 对象中的`timestamp`实际是一个整数，而不是字符串。那么累积的字符串可能是临时值吗？
*   从 AJAX 请求中删除`+ latestTimestamp`可以阻止泄漏。
*   更快的 setTimeout (20ms) 会导致更快的泄漏。我认为快速超时可能是罪魁祸首，所以我将它缩短到 250 毫秒，但这并没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T11:50:38.237

您是否尝试过 cleartimeout javascript 功能？如果没有，请试试这个。

```
var abc=null;
function gotData(data) {
latestTimestamp = data['timestamp'];
data=null;
clearTimeout(abc);
abc=setTimeout(fetchData, 250);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T16:39:05.557

我相信这个问题出在 jQuery 和/或浏览器上。我经常在 AJAX 调用中看到类似的泄漏。

考虑将数据从服务器推送到客户端，而不是每秒轮询服务器 4 次。我不知道您使用的是什么平台，但如果是 .Net，您可能想看看 SignalR

[https://github.com/SignalR/SignalR](https://github.com/SignalR/SignalR)

[http://www.hanselman.com/blog/AsynchronousScalableWebApplicationsWithRealtimePersistentLongrunningConnectionsWithSignalR.aspx](http://www.hanselman.com/blog/AsynchronousScalableWebApplicationsWithRealtimePersistentLongrunningConnectionsWithSignalR.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T15:47:35.387

一旦你完成了 data[]，你就可以摆脱它：

```
function gotData(data) {
    latestTimestamp = data['timestamp'];
    delete data;
    setTimeout(fetchData, 250);
} 
```

# wix - 如何使用 WiX 在安装程序中创建带有嵌入式 WebBrowser 控件的自定义对话框以进行 Web 身份验证

> ID：10126858
> 
> 赞同：2
> 
> 时间：2012-04-12T15:32:36.597
> 
> 标签：wix, windows-installer

我正在寻找一种将 webbrowser 控件嵌入到安装程序以执行基于 web 的身份验证的方法。有没有办法实现它？用 webcontrol 实现简单的对话框对我来说是一个很好的起点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T13:42:29.133

WIX 仅限于 MSI 可以包含的功能。并且 Web 浏览器控件不是受支持的控件。

至于解决方法：

*   您可以使用所需的任何控件创建单独的 Windows 应用程序，并使用 WIX 安装程序中的自定义操作启动它。它的外观和感觉不像 WIX 自定义对话框，但任务会完成。

*   使用用户名密码和自定义操作创建自定义对话框，使用提供的凭据创建 HTTP 请求以验证凭据。它当然不会显示站点，但仍然可以通过这种方式完成身份验证任务。

*   如果您使用的是 WIX 3.6，您可以简单地使用 WPF 对话框创建一个引导程序。WPF 再次允许您使用 WebBrowser 控件执行您需要的任何操作。该对话框将在安装程序实际运行之前显示，但您可以将参数传递给主 MSI，就像在静默模式下一样。如果没有 WIX 3.6，您也可以做同样的事情，但实际上需要做更多的工作。

# php - 代码点火器。RSS 解析器将数据添加到数据库

> ID：10126861
> 
> 赞同：0
> 
> 时间：2012-04-12T15:32:55.320
> 
> 标签：php, oop, codeigniter, simplepie

我正在创建一个脚本来从 rss 提要中获取帖子并将它们放入我的数据库中。我将使用 3-5 个不同的提要执行此操作，然后无论它们来自哪个提要，我都会按日期顺序将它们打印出来。其中一些工作正常，比如我可以使用 simplepie 从文件中获取 rss 数据，但我似乎无法将其添加到数组中（微不足道的部分）。

get_title() 中的数据以“SimplePie_Item”的形式返回，而不仅仅是一个字符串“不能将 SimplePie_Item 类型的对象用作数组”。如果我尝试回显数据，它会很好地打印字符串。所以我认为这里的对象数据我没有得到一些东西，比如为什么我不能只将字符串复制到数组中。我尝试铸造，但这似乎没有做任何事情。

--update_database 方法代码--

```
function update_database($options=array())
{    
    //Check required fields.
    if(!$this->_required(array('feeds','life'),$options))
      return false;

    //Add default values
    $options = $this->_default(array() ,$options);

    if(is_array($options['feeds'])) //Multiple blogs
    { 
```

echo '是一个数组';

```
 //Parse each url and add to db.
        foreach($options['feeds'] as $a => $u)
        { 
```

echo '打印 r =

```
';print_r($u);echo '
```

';

```
echo 'feeds loop = '.$a;

echo 'url = '.$u['url'].'<br />';

$posts = $this->fetch_feed( array('url'=>$u['url']) );

            //Add to db.
            foreach($posts as $f)
            {   

  $add['post_title'] =    (string)$f->get_title();
  $add['link'] =          (string)$f->get_link();
  $add['p_description'] = (string)$f->get_description();
  $add['content'] =       (string)$f->get_content();
  $add['post_date'] =     (string)$f->get_date();
  $add['guid'] =          (string)$f->get_id();
  $add['status'] =        'active';
  $add['blog_id'] =       $u['blog_id'];

                $this->add_post($f);//Add posts to db.
            }
        }
    }
    else //Single blog.
    {
echo 'feeds - single feed';

$posts = $this->fetch_feed( array('url'=>$options['url']) );

            //Add to db.
            foreach($posts as $k=>$f)
            {                   
  $add['post_title'] =    (string)$f->get_title();
  $add['link'] =          (string)$f->get_link();
  $add['p_description'] = (string)$f->get_description();
  $add['content'] =       (string)$f->get_content();
  $add['post_date'] =     (string)$f->get_date();
  $add['guid'] =          (string)$f->get_id();
  $add['status'] =        'active';
  $add['blog_id'] =       $options['blog_id'];

                $this->add_post($f);//Add posts to db.
            }
    }
} 
```

--fetch_feed 方法--

```
 function fetch_feed($options=array())
  {
    $this->simplepie->set_feed_url($options['url']);
    $this->simplepie->set_cache_location(APPPATH.'cache/rss');
    $this->simplepie->init();
    $this->simplepie->handle_content_type();
    return $this->simplepie->get_items();
  } 
```

--add_post 方法--

```
 function add_post($options)
    {
        //Check required options.
        if(!$this->_required(array('post_title','link','p_description','content','post_date','guid','status','blog_id'), $options))
          return false;

        //Add default values
        $options = $this->_default(array() ,$options);  

        $this->db->set('post_title',$options['title']);
        $this->db->set('link',$options['link']);
        $this->db->set('p_description',$options['description']);
$this->db->set('content',$options['content']);
$this->db->set('post_date',$options['post_date']);
$this->db->set('guid',$options['guid']);
$this->db->set('status',$options['status']);    
        $this->db->set('blog_id',$options['blog_id']);

        $this->db->insert('posts');
        return $this->db->affected_rows();
    } 
```

- 控制器 -

```
 function simple_pie()
  {
    $this->load->model('post_model');
    //$this->options->feeds = $this->post_model->fetch_feed(array('url'=>'http://testigniter.blogspot.com/feeds/posts/default?alt=rss'));

    $urls = array('feeds'=>array( array('url'=>'http://testigniter.blogspot.com/feeds/posts/default?alt=rss','blog_id'=>1) ),'life'=>60);

    $this->options->result = $this->post_model->update_database($urls);

    if($this->options->result)
    {
      echo 'Passed';
    }
    else
    {
      echo 'Failed';
    }

    $this->load->view('pages/simplepie_test', $this->options);  
  } 
```

这里真的不需要视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T12:29:55.940

Echo`(string)`在显示之前转换一个值。

尝试`(string)`在您获取的值之前添加，您将获得与回显相同的结果。

我相信您的问题在于该值实际上是`array(0 => 'string')`因为这是您可以读取和存储 XML 结构的一种方式，并且当您回显它时它看起来不错，因为：
`(string)array(0 => 'string') == 'string'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T21:42:25.197

PHP 和我不是最好的朋友，但如果问题出在 SimplePie 上，您应该查看在首次声明对象时可以设置的标志，尤其是 enable_xml_dump()。这使您可以从提要中获取原始 XML 并使用它做任何您想做的事情。

我过去用它来完成一些事情。如果您可以以某种方式缩短您的示例代码/示例，这可能会有所帮助。通常，如果您可以获取提要， get_title() 应该可以正常工作...错误的提要通常是罪魁祸首，您确定提要本身很好并且可以验证吗？有 RSS 提要验证器...

# c# - 优化绘图应用程序 c#

> ID：10126862
> 
> 赞同：1
> 
> 时间：2012-04-12T15:32:57.627
> 
> 标签：c#, optimization, drawing, gdi+, double-buffering

我正在使用 c# 制作一个像 photoshop 这样的绘画项目。我使用 GDI+ 进行绘图。遗憾的是，我无法发布所需声誉点的屏幕截图。编辑：好的，我有足够的代表上传图片。 ![在此处输入图像描述](../Images/491cd3ebdede778692ede2baf4115dd4.png)

当画笔大小增加时，我使用鼠标进行的绘图会滞后。我有一个画布缓冲区，它被绘制到画布面板

```
protected override void OnPaint(PaintEventArgs e)
    {
        if (canvasBuffer != null)
        {
            using (Graphics g = e.Graphics)
            {
                g.DrawImage(canvasBuffer, e.ClipRectangle, e.ClipRectangle, GraphicsUnit.Pixel);
            }
        }
    } 
```

这就是完成任何绘画时会发生的情况。

1.  我存储鼠标拖动事件的点列表。
2.  我从a点到b点画了一系列圆，以记录点为中心画一条平滑线
3.  此绘制是在存储在图层类中的笔划列表中的位图上完成的。这个绘图也是用 CompositingMode.SourceCopy 来实现 alpha 值绘图
4.  我有一个 layerBuffer 来存储图层的最终图像。我通过使用 SourceCopy 兼容模式使用透明颜色的绘图清除它来将受笔触影响的更改绘制到此 layerBuffer，然后使用 SourceOver 在笔触列表中绘制位图
5.  由于我正在实施的分层系统，我将所有图层缓冲区绘制到一个图片缓冲区。这张图片Buffer最终通过缩放变换绘制到canvasBuffer中。

注意：画布缓冲区的受影响区域以与图层缓冲区相同的方式完成，即清除受影响的部分并重新绘制图片缓冲区的整个受影响部分。如果我不清除之前的绘图，则使用 alpha 值绘图将无法按预期工作。

请帮助我优化此代码或提出一些新方法来提高性能并减少使用鼠标绘制时的延迟。此外，将绘图代码和使用线程的缓冲区的点计算和绘图分开会有帮助吗？

这是代码。

```
public void PSF_Painted(PSF_PaintEvent e)
    {
        Layer SelectedLayer = psf.Layers[0];//Get selected layer here
        if ((BrushTool)getActiveTool() != null)
        {
            //getting the pen attributes from the brush tool
            BrushTool brushTool = (BrushTool)getActiveTool();
            Pen pen = brushTool.getPen();
            Brush brush = pen.Brush;
            int brushSize = (int)pen.Width;
            //loading points data
            List<Point> recordedPoints = null;
            Point currentPoint = new Point(0, 0);
            Point previousPoint = new Point(0, 0);
            if (e.RecordedPoints != null)
            {
                recordedPoints = e.RecordedPoints;
                if (recordedPoints.Count > 1)
                {
                    currentPoint = recordedPoints[recordedPoints.Count - 1];
                    previousPoint = recordedPoints[recordedPoints.Count - 2];
                }
                else if (recordedPoints.Count == 1)
                {
                    currentPoint = recordedPoints[0];
                    previousPoint = currentPoint;
                }
            }
            if (e.PaintEventType == PSF_PaintEvent.StrokeStarted)
            {
                //Console.WriteLine("StrokeStarted");
                SelectedLayer.Strokes.Add(new Bitmap(SelectedLayer.Width, SelectedLayer.Height));
            }
            else if (e.PaintEventType == PSF_PaintEvent.Painting)
            {
                //Draw the drawing in the bitmap of the layer's stroke data
                using (Graphics g = Graphics.FromImage(SelectedLayer.Strokes[SelectedLayer.Strokes.Count - 1]))
                {
                    List<Point> points = Global.GetPointsOnLine(previousPoint.X, previousPoint.Y, currentPoint.X, currentPoint.Y);
                    for (int i = 0; i < points.Count; i++)
                    {
                        g.CompositingMode = System.Drawing.Drawing2D.CompositingMode.SourceCopy;
                        if (pen.Width == 1)
                        {
                            g.FillRectangle(brush, new Rectangle(points[i].X, points[i].Y, brushSize, brushSize));
                        }
                        else
                        {
                            g.FillEllipse(brush, new Rectangle(points[i].X, points[i].Y, brushSize, brushSize));
                        }
                        int xt, xb, yt, yb;
                        xt = points[i].X;
                        xb = points[i].X + brushSize;
                        yt = points[i].Y;
                        yb = points[i].Y + brushSize;

                        if (xt < 0) xt = 0;
                        if (xb > psf.Width) xb = SelectedLayer.Width;
                        if (yt < 0) yt = 0;
                        if (yb > psf.Height) yb = SelectedLayer.Height;

                        //Refresh changes to the affected part of the canvas buffer
                        Rectangle affectedRect = new Rectangle(xt, yt, xb - xt, yb - yt);
                        float zf = psf.ZoomFactor;
                        Rectangle canvasAffectedRect = new Rectangle((int)(affectedRect.X * zf), (int)(affectedRect.Y * zf), (int)(affectedRect.Size.Width * zf), (int)(affectedRect.Size.Height * zf));
                        SelectedLayer.invalidateLayerBuffer(affectedRect);
                        invalidateCanvasBuffer(canvasAffectedRect);
                    }
                }
            }
            else if (e.PaintEventType == PSF_PaintEvent.StrokeCompleted)
            {
                //Console.WriteLine("StrokeCompleted");
            }
        }
        this.Invalidate();
    } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-23T23:36:26.983

好的，我找到了这个优化的解决方案。我只记录了距离大于画笔大小 1/5 的点。我意识到我不需要一条非常完美的线条。因此，可以在生产线质量方面进行折衷以换取性能。

# ios - 如何使 if 语句更改 xcode 中的文本字段？

> ID：10126864
> 
> 赞同：0
> 
> 时间：2012-04-12T15:33:01.987
> 
> 标签：ios, xcode, textfield, stringwithformat

好的，所以如果文本字段为空，我正在尝试使此操作更改用户可编辑的文本字段。这是我现在正在使用的代码，但它不起作用：

```
if ([textField.text isEqualToString:[NSString stringWithFormat:@""]]) {
    [o1 setText:[NSString stringWithFormat:@"1"]]; 
```

有人知道为什么吗？我也这样做了：

```
UITextField *textField; 
```

那有必要吗？

更新：我刚刚意识到我应该早点把它放在这里，但它是为 ios 而不是 mac。对不起！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T22:14:59.267

您的代码有些复杂 - 只需像这样测试：

```
if ([myTextField length] == 0) myTextField.text = @"1"; 
```

您需要在界面中声明 myTextField，如下所示：

```
IBOutlet UITextField *myTextField; 
```

然后在IB中链接它。您可以将其作为简化内存管理的属性。

# c# - Entity Framework - Generating Classes

> ID：10126871
> 
> 赞同：64
> 
> 时间：2012-04-12T15:33:34.653
> 
> 标签：c#, entity-framework

I have an existing database. I was hoping there was a way to generate class files from this database. However, I seem to see a lot of generating the database from the class files.

Is there a way to generate class files from an existing database using the Entity Framework? If so how? Can someone point me to a tutorial?

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2012-04-12T22:46:12.993

1) First you need to generate `EDMX` model using your database. To do that you should add new item to your project:

*   Select `ADO.NET Entity Data Model` from the Templates list.
*   On the Choose Model Contents page, select the Generate from Database option and click Next.
*   Choose your database.
*   On the Choose Your Database Objects page, check the Tables. Choose Views or Stored Procedures if you need.

So now you have `Model1.edmx` file in your project.

2) To generate classes using your model:

*   Open your `EDMX` model designer.
*   On the design surface Right Click –> Add Code Generation Item…
*   Select Online templates.
*   Select `EF 4.x DbContext Generator for C#`.
*   Click ‘Add’.

Notice that two items are added to your project:

*   `Model1.tt` (This template generates very simple POCO classes for each entity in your model)
*   `Model1.Context.tt` (This template generates a derived DbContext to use for querying and persisting data)

3) Read/Write Data example:

```
 var dbContext = new YourModelClass(); //class derived from DbContext
 var contacts = from c in dbContext.Contacts select c; //read data
 contacts.FirstOrDefault().FirstName = "Alex"; //edit data
 dbContext.SaveChanges(); //save data to DB 
```

Don't forget that you need 4.x version of EntityFramework. You can download EF 4.1 here: [Entity Framework 4.1](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=8363).

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-04-20T13:08:22.603

I found very nice solution. Microsoft released a beta version of Entity Framework Power Tools: [Entity Framework Power Tools Beta 2](http://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d)

There you can generate POCO classes, derived DbContext and Code First mapping for an existing database in some clicks. It is very nice!

After installation some context menu options would be added to your Visual Studio.

Right-click on a C# project. Choose Entity Framework-> Reverse Engineer Code First (Generates POCO classes, derived DbContext and Code First mapping for an existing database):

![Visual Studio Context Menu](../Images/c10fb34005e4b87bc497db1e3bf18f34.png)

Then choose your database and click OK. That's all! It is very easy.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-04T07:29:36.730

1.  Open the EDMX model
2.  Right click -> Update Model from Browser -> Stored Procedure -> Select your stored procedure -> Finish
3.  See the Model Browser popping up next to Solution Explorer.
4.  Go to Function Imports -> Right click on your Stored Procedure -> Add Function Import
5.  Select the Entities under Return a Collection of -> Select your Entity name from the drop down
6.  Build your Solution.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-08T07:45:38.663

EDMX model won't work with EF7 but I've found a Community/Professional product which seems to be very powerfull : [http://www.devart.com/entitydeveloper/editions.html](http://www.devart.com/entitydeveloper/editions.html)

# c# - C# TreeView 折叠/展开父选择

> ID：10126873
> 
> 赞同：3
> 
> 时间：2012-04-12T15:33:35.290
> 
> 标签：c#, treeview, expand, collapse

这个很难解释，所以我只会告诉你我想要实现什么以及我是如何做到的，所以也许有人会知道我做错了什么。

在我的 winForm 中，我有一个填充的 TreeView 控件。所有父母都有孩子（任意数量），但没有孩子有自己的孩子。例子：

```
- Parent 1
        Child 1
        Child 2
        Child 3
- Parent 2
       Child 4 
```

我想要的行为如下：

1.  当用户点击一个孩子时，它被选中（默认完成）
2.  当用户单击父级时，它应该折叠或展开但不更改任何选择

第 1 点没有问题，因为它是 TreeView 的默认行为，但第 2 点是另一回事。

这是我到目前为止所做的：

为了防止父级被选中，我添加了一个 BeforeSelect 事件处理程序并在其中放入以下代码：

```
if (e.Node.Parent == null)
    e.Cancel = true; 
```

这完美地完成了这项工作。所以现在我取消了对父级的选择，我想展开或折叠它。所以我把上面的代码改成：

```
if (e.Node.Parent == null)
{
    if (e.Node.IsExpanded)
    {
        e.Node.Collapse();
    }
    else
    {
        e.Node.Expand();
    }
    e.Cancel = true;
} 
```

这有点工作 - 除了，与单击 + 号不同，调用 Expand() 或 Collapse() 会选择父节点，忽略 e.Cancel = true; 线。

我尝试在调用 Collapse() 或 Expand() 之前获取 SelectedNode，然后将其设置回来 - 它可以工作，但是当我这样做时，它会再次展开父节点以进行选择。

不知何故，当我点击父母时，+号正是我想要发生的事情——我似乎无法让它工作。

想法？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-03T14:26:27.570

试试这个：

```
 private bool allowExpandCollapse = false;

    private void treeView1_BeforeExpand(object sender, TreeViewCancelEventArgs e)
    {
        e.Cancel = !allowExpandCollapse;
    }

    private void treeView1_BeforeCollapse(object sender, TreeViewCancelEventArgs e)
    {
        e.Cancel = !allowExpandCollapse;
    }

    private void treeView1_BeforeSelect(object sender, TreeViewCancelEventArgs e)
    {
        if (e.Node.Parent == null)
        {
            e.Cancel = true;
        }
    }

    private void treeView1_NodeMouseClick(object sender, TreeNodeMouseClickEventArgs e)
    {
        if (e.Node.Parent == null)
        {
            allowExpandCollapse = true;
            if (e.Node.IsExpanded)
            {
                TreeNode selectedNode = treeView1.SelectedNode;
                e.Node.Collapse();
                allowExpandCollapse = false;
                treeView1.SelectedNode = selectedNode;
            }
            else
            {
                e.Node.Expand();
                allowExpandCollapse = false;
            }
        }
    } 
```

# html-parsing - HtmlAgility Pack 难以从嵌套表中获取信息

> ID：10126877
> 
> 赞同：0
> 
> 时间：2012-04-12T15:33:42.903
> 
> 标签：html-parsing, html-agility-pack

我正在尝试解析下表，但不幸的是每个节点似乎都相互嵌套。:( 获取子节点是不可能的，因为它总是给出 count = 1

这真的很有趣，但它正在寻找；例如下一个“tr”作为前一个 tr 的子节点？

你有什么主意吗？

```
<table width="292px" border="0">
    <tr>
        <td>
        </td>
    </tr>
    <tr>
        <td>
            <table>
                <tr>
                    <td colspan="2" bgcolor="#FBCE9D" align="center" height="40">
                    </td>
                </tr>
                <tr>
                    <td bgcolor="#FFF4D2" height="25" width="60">
                    </td>
                    <td height="25" bgcolor="#e8e8e8">
                    </td>
                </tr>
                <tr>
                    <td bgcolor="#FFF4D2" height="25" width="60">
                    </td>
                    <td height="25" bgcolor="#e8e8e8">
                    </td>
                </tr>
                <tr>
                    <td bgcolor="#FFF4D2" height="25" width="60">
                    </td>
                    <td height="25" bgcolor="#e8e8e8">
                    </td>
                </tr>
                <tr>
                    <td bgcolor="#FFF4D2" height="25" width="60">
                    </td>
                    <td height="25" bgcolor="#e8e8e8">
                    </td> //Here is a missing "</tr>" and I think this one is confusing the agilitypack!
                    <tr>
                        <td bgcolor="#FFF4D2" height="35" colspan="2" align="center">
                        </td>
                    </tr>
            </table>
        </td>
    </tr>
</table> 
```

我的代码是：

```
var webGet = new HtmlWeb();
var doc = webGet.Load("the url where this table is located");
HtmlNodeCollection tb = doc.DocumentNode.SelectNodes("//table[@width='292px']");
                        var table = tb[0].ChildNodes[1].ChildNodes[0].ChildNodes[0].ChildNodes;
                        for (var na = 0; na < table.Count; na++)
                        { .....do the work.... } 
```

实际上，这段代码以前就像一个魅力一样工作，但他们在里面嵌套了另一个表，`ChildNodes[1]`因为`ChildNodes[1]`它永远不会存在`ChildNodes[0]`？

再来一张纸条；Firebug 将“/html/body/table/tbody/tr[2]/td/table/tbody”显示为嵌套表的 XPath，但您可能注意到“tbody”不熟悉 htmlagility，因为它是由浏览器删除缺少的关闭标签 /tr

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-17T11:36:35.387

这真的很有趣，但问题是在 Nuget 上实际可用的 HmtlAgility 包！我将其删除并从网上下载（[http://htmlagilitypack.codeplex.com/](http://htmlagilitypack.codeplex.com/)）。它现在正在工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T07:17:41.260

`XPATH`会在这里帮助你很多。

对于内部表`tr`节点，您可以在下面尝试

```
doc.DocumentNode.SelectNodes("//table[@width='292px']/tr/td/table/tr") 
```

如果要遍历`td`内部表中的节点，则

```
doc.DocumentNode.SelectNodes("//table[@width='292px']/tr/td/table/tr/td") 
```

# javascript - 301 重定向页面上的 Omniture 数据报告

> ID：10126879
> 
> 赞同：0
> 
> 时间：2012-04-12T15:33:46.473
> 
> 标签：javascript, html, analytics, adobe-analytics

我们使用 Omniture 报告通过网页上的 JavaScript 提交基本指标，例如页面浏览量等。

最近的一项要求要求我们在页面上执行 301 重定向。现在，这必然意味着 JavaScript 不会在浏览器访问的页面上执行。

如何在 Omniture 中跟踪此类指标。通过 Google Analytics，我知道我们有一组 API 可以让您进行自定义报告。

我想知道是否有人以某种方式完成了它，或者人们是否知道执行此类要求的最佳实践。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T21:31:03.637

如果您登录到 SiteCatalyst 界面，知识库文章 543 将解释您正在寻找的所有详细信息。

# javascript - jQuery 阻止 stop() 为元素提供固定高度

> ID：10126880
> 
> 赞同：0
> 
> 时间：2012-04-12T15:33:49.693
> 
> 标签：javascript, jquery

我有以下代码行：

```
$(".product-list .product").hover(function() {
    $(this).find('.product-description').stop().slideDown("slow");
}, function() {
    $(this).find('.product-description').stop().slideUp("slow");
}) 
```

现在的问题是，当我移动得足够快，然后再次悬停元素时，.product-description 会卡在旧事件的高度上。

例如：

1.  鼠标悬停：元素->动画->全高：200px
2.  mouseleave：元素 -> 动画停止 -> 动画 -> 高度：0（现在默认高度：100px）
3.  鼠标悬停：元素->动画->全高：100px（但应该是200px）

是的，我已经尝试过获得正常高度 - 但问题是，我使用了 jQuery 无法真正处理的 clearfix。

感谢您的任何建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:36:28.053

尝试像下面这样使用它，

```
$(".product-list .product").hover(function() {
    $(this).find('.product-description').stop(true, true).slideDown("slow");
}, function() {
    $(this).find('.product-description').stop(true, true).slideUp("slow");
}) 
```

> **.stop( [clearQueue] [, jumpToEnd] )**
> 
> **clearQueue**一个布尔值，指示是否也删除排队的动画。默认为假。
> 
> **jumpToEnd 一个**布尔值，指示是否立即完成当前动画。默认为假。

# google-analytics - 谷歌分析活动页面

> ID：10126881
> 
> 赞同：2
> 
> 时间：2012-04-12T15:33:50.440
> 
> 标签：google-analytics

在 Top Active Pages 下的新版 Google Analytics（分析）中，我看到一个 url（或类似的）

/1.php/Oi8vd3d3/LnBpbmtm/aW5lYXJ0/LmNvbS8_/3D/b0/

并且这个网址会保持几分钟（上面的网址到目前为止已经 1/2 小时），这应该意味着它们处于活动状态。然而，如果我将它添加到我的网站 url 的末尾，它会返回一个 404 错误页面。

知道有人在做什么/在寻找什么吗？

# weblogic - weblogic：调试 ActiveDirectory 身份验证器

> ID：10126883
> 
> 赞同：1
> 
> 时间：2012-04-12T15:33:57.627
> 
> 标签：weblogic

使用Weblogic 10.3.2.0，我在Weblogic 上创建了一个ActiveDirectory 验证器，如下，我需要启用调试。

如果我启用所有服务器日志：Environment -> AdminServer -> Debug -> enable all "default" and all "weblogic" 我获得了我需要的调试类型，例如：

```
####<Apr 12, 2012 3:56:36 PM CEST> <Debug> <SecurityRoleMap> <WINXP3> <AdminServer> <[ACTIVE] ExecuteThread: '0' for queue: 'weblogic.kernel.Default (self-tuning)'> <<WLS Kernel>> <> <> <1334238996125> <BEA-000000> <Evaluate urn:oasis:names:tc:xacml:1.0:function:string-is-in(MYGROUP,MYUSER) -> false> 
```

但是，启用所有服务器日志太重了。我需要启用哪些特定的调试组件才能获得 ActiveDirectory 调试，例如上面的示例？我尝试使用“weblogic->security->realm”和“weblogic->security->ldap”，但没有成功。

问候，大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-07T08:33:58.070

嵌入式 LDAP 具有用于调试输出和访问事件的日志文件。这些文件的位置和名称在 /myserver/ldap/conf/vde.props 文件中设置。

[资源](http://monduke.com/2006/02/22/weblogic-embedded-ldap-logging/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-30T20:17:55.413

通过在 weblogic 调试记录器上启用 SecurityAtn 标志，可以记录所有身份验证提供程序的调试日志，包括自定义提供程序（如果有）。

# package - 使用 Open Build Service 构建多架构 rpm 包

> ID：10126885
> 
> 赞同：1
> 
> 时间：2012-04-12T15:34:02.737
> 
> 标签：package, rpm, opensuse, meego

关于正确构建和构建 RPM 包，我有以下问题：

1.  我在哪里可以找到一些关于在 RPM 包中使用**baselibs.conf文件的深入解释？**我发现了这些小片段：[http](http://en.opensuse.org/openSUSE:Build_Service_baselibs.conf) ://en.opensuse.org/openSUSE:Build_Service_baselibs.conf 。
2.  该文件是否仅由 OBS 服务器或其他地方使用？
3.  在 OBS 服务器上本地和远程使用 baselibs.conf 构建 rpm 包有什么区别？- 意味着当我在本地构建时，我只会得到以下包：**.src.rpm 和 .dontuse.rpm**，但是当我远程构建时，我会得到额外的**.rpm**包 - 这是最重要的。
4.  如何在本地检查 baselibs.conf 中的配置是否正确？

# c# - iText 表格未对齐的行

> ID：10126886
> 
> 赞同：0
> 
> 时间：2012-04-12T15:34:02.777
> 
> 标签：c#, itext

是否可以将 iText 表中的行错位？换句话说，是否可以有任意相邻的单元格高度？

示例：假设我有两个相邻的单元格：根据内容，前者可以高于后者。这迫使后者增加其高度。我不想要这种行为。我不能使用 rowspan 因为我不知道一个单元格是否高于正常值。

# javascript - jQPlot - 删除垂直网格线

> ID：10126889
> 
> 赞同：33
> 
> 时间：2012-04-12T15:34:13.453
> 
> 标签：javascript, jquery, charts, jqplot

我使用 jqPlot 作为我的图表框架，并且在我的应用程序中有许多图表，主要是折线图和堆叠条形图。

我现在要求只在这些图表上显示水平网格线，并且在 jqPlot 中看不到任何选项来执行此操作。

有一个`showGridline`选项可以完全禁用网格线。

是否可以仅删除 jqPlot 中的垂直网格线并继续显示水平网格线？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-04-13T02:19:43.693

我想到了。您可以`showGridline`通过执行以下操作应用于单个轴：

```
axes:{
    xaxis: {
       tickOptions:{
          showGridline: false
       }
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-07-18T04:51:42.243

要删除 X 轴上的网格线：

```
axes : {
    xaxis : {
       tickOptions : {
           showGridline : false
       }
    }
} 
```

要删除 Y 轴上的网格线：

```
axes : {
    yaxis : {
       tickOptions : {
           showGridline : false
       }
    }
} 
```

要删除两个轴上的网格线：

```
axes : {
    xaxis : {
       tickOptions : {
           showGridline : false
       }
    },
    yaxis : {
       tickOptions : {
           showGridline : false
       }
    }
} 
```

或者

```
grid : {
    drawGridlines: false
} 
```

# javascript - 使用 JavaScript 创建倾斜的 Div 和对象

> ID：10126890
> 
> 赞同：2
> 
> 时间：2012-04-12T15:34:15.410
> 
> 标签：javascript, graphics

**是否可以使用 JavaScript 创建这样的“倾斜菜单”（请参见下文）？**

前提是我希望它们“相对”以适当地调整到屏幕尺寸。

![在此处输入图像描述](../Images/02a57277f6150f84f468ec7a555d7d6a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-13T19:54:21.023

您可以使用 CSS 转换来做到这一点，并使用其他一些技巧..

```
div
{

    transform:rotate(45deg);
    -ms-transform:rotate(45deg); /* IE 9 */
    filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1.5); /* IE 8- */
    -moz-transform:rotate(45deg); /* Firefox */
    -moz-transform:skewx(45deg) translatex(150px);
    -webkit-transform:rotate(45deg); /* Safari and Chrome */
    -o-transform:rotate(45deg); /* Opera */

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T19:29:54.253

这可以使用HTML5 和[JQuery](http://jquery.com/)`<canvas>`的元素来完成。通过使用 canvas 元素，您可以在另一个之上绘制平行四边形，并在每个平行四边形中添加文本。

这确实有一个缺点，需要通过确定每个项目是否落入平行四边形之一来处理每个项目的点击，但这是我知道的唯一方法。

**HTML**

```
<div id="click" width=10%>
Click Here
</div>
<div id="menu" width=10%>
  <canvas id="canvas"></canvas>
</div> 
```

**jQuery**

```
$("#menu").hide();
$("#click").click(function(){
                     $("#menu").slideToggle('slow', function() {});
                   });

$("#canvas").click(function() {
                    // Determine which trapezoid the click was on and do the needed action.
                  });

var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');
// Draw the top parallelogram with the color blue.
ctx.fillStyle = "blue"; 
ctx.beginPath();
ctx.moveTo(0,0);
ctx.lineTo(75,0);
ctx.lineTo(100,75);
ctx.lineTo(25,75);
ctx.lineTo(0,0);
ctx.fill();

// Use a point object here to make it a bit easier to determine the four points.
var startPoint = new Object();
startPoint.x = 25;
startPoint.y = 75;
// Draw the second parallelogram and fill it with grey.
ctx.fillStyle = "grey";
ctx.beginPath();
ctx.moveTo(startPoint.x, startPoint.y);
ctx.lineTo(startPoint.x + 75, startPoint.y);
ctx.lineTo(startPoint.x + 85, startPoint.y + 25);
ctx.lineTo(startPoint.x + 10, startPoint.y+25);
ctx.lineTo(startPoint.x, startPoint.y);
ctx.fill();

ctx.fillStyle = "black";
ctx.font = 'italic 22px sans-serif';
ctx.fillText("a", startPoint.x+10, startPoint.y+22); 
```

您可以在此[JSFiddle](http://jsfiddle.net/dqAvD/)中看到此代码。

要保持与屏幕大小相关的大小，您需要将硬编码值替换为由`$("#menu")`div 大小确定的值。

您还需要创建一种方法来绘制平行四边形，以使添加其他菜单项更加简单。

# selenium - Testlink 和 Selenium 2

> ID：10126891
> 
> 赞同：0
> 
> 时间：2012-04-12T15:34:19.047
> 
> 标签：selenium, automation, testcase, bamboo

我正在尝试从一组 Selenium 2 测试脚本中生成测试用例，这些脚本的格式设置为 TestLink 可以导入的方式。

本质上，我只有大量的 Selenium 测试方法，可以在竹子中生成报告，我想要一种方法让 TestLink 吃掉这些方法，这样我们就不必手动输入所有测试用例。

有没有人尝试过类似的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T13:41:31.087

我相信你现在已经想通了。但是，没有直接的方法可以做到这一点。根据您的 selenium 2 测试用例编写的语言，将确定您使用的工具。

如果是我（并且我使用 PHP 实现），我很可能会构建一个可以放置在 Webdriver 对象位置的类。对于每个 Selenium 命令，我都会让它构建一个字符串，而不是向 Selenium 服务器发送网络调用。话虽如此，我可能会将其翻译成[Gherkin](https://github.com/cucumber/cucumber/wiki/Gherkin)。在测试结束时，我会使用[Testlink 的 API](http://teamst.org/_tldoc/1.8/phpdoc_api/TestlinkAPI/TestlinkXMLRPCServer.html)来创建测试用例。我可能会在[java](http://code.google.com/p/testlink-api-java-client/source/browse/?r=6#svn%2Ftrunk%2Ftestlink-api-java-client%2Fsrc%2Ftestlink%2Fapi%2Fjava%2Fclient)中做这部分以供以后重用。然后，我将使用 PHPUnit 的功能将日志导出为 JUnit，加载它们，然后使用相同的 java 客户端将它们发送到 testlink。

大量的开发时间...

# javascript - clientX，clientY javascript 在 Internet Explorer 中未按预期工作

> ID：10126895
> 
> 赞同：0
> 
> 时间：2012-04-12T15:34:24.147
> 
> 标签：javascript, internet-explorer

我有一个网页，当用户将鼠标移出页面时会显示一条消息。除 Internet Explorer 外，所有浏览器均可完美运行。在 Internet Explorer 中，我的代码可以正常工作，除非用户单击表单选择项。当用户从下拉列表中选择一个项目时，clientX 和 clientY 报告一个不正确的值，这使得我的消息显示就好像用户将鼠标移到页面外一样。仅当鼠标实际移出页面时才应显示该消息。我已经在为旧版本的 IE 使用解决方法。有谁知道解决此问题的不同方法，以便代码在较旧的 IE 浏览器 (7-8) 中正常工作？

这是我的代码：

```
if (document.addEventListener) {
    window.addEventListener("mouseout", popMessage, false);
} else {  // IE before version 9
    document.attachEvent ('onmouseout', popMessage);
}

.
.
.
.

var mouseX = 0;
var mouseY = 0;

function popMessage (e) {
    mouseX = e.pageX;
    mouseY = e.pageY;

    if ('pageX' in e) { // all browsers except IE before version 9
        var mouseX = e.pageX - document.documentElement.scrollLeft;
        var mouseY = e.pageY - document.documentElement.scrollTop;
    }
    else {  // IE before version 9
        mouseX = e.clientX + document.documentElement.scrollLeft;
        mouseY = e.clientY + document.documentElement.scrollTop;
    }

    if ((mouseY < 0 || mouseY > window.innerHeight-1)
    ||  (mouseX < 0 || mouseX > window.innerWidth-1))
    {
        abandonPanel.show();
        // alert("x:" + mouseX + "  y:" + mouseY + "  innerHeight:" + window.innerHeight + "  innerWidth:" + window.innerWidth);

        if (document.addEventListener) {
            window.removeEventListener("mouseout", popMessage, false);
        } else {  // IE before version 9
            document.detachEvent ('onmouseout', popMessage);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T14:03:17.817

Appended the code as follows

```
 else {  // IE before version 9
        if (e.srcElement.nodeName!="SELECT") { // IE reports inaccurate mouse information on SELECT elements
            mouseX = e.clientX + document.documentElement.scrollLeft;
            mouseY = e.clientY + document.documentElement.scrollTop;
        }
        else {
          mouseX = 50  
          mouseY = 50
        }

    } 
```

This enters dummy values if the user has the mouse over a select element which keeps the javascript from misfiring.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T16:01:03.243

e.clientX 仅在事件的目标 (srcElement) 是文档时才像 e.pageX 一样工作。

在表格和定位元素以及表单元素中，需要考虑包含元素的偏移量 -

```
var node=event.srcELement, mouseX=node.offsetLeft+event.clientX;
while(node.offsetParent){
  node=node.offsetParent;
  mouseX+=node.offsetLeft;
} 
```

也适用于mouseY。

在 srcElement 是主体之前忽略鼠标移动会更简单。

# c++ - 运算符不匹配*

> ID：10126897
> 
> 赞同：2
> 
> 时间：2012-04-12T15:34:28.113
> 
> 标签：c++

我正在阅读 Effective C++ (Scott Meyers)，并在尝试编译本书中的以下代码时收到错误“no match for operator*”：

理性的.h

```
class rational
{
    private:
        int num;
        int den;
    public:
        rational(int n = 0, int d = 1);
        int getNum() const {return num;}
        int getDen() const {return den;}
}; 
```

理性的.cpp

```
#include "rational.h"

rational::rational(int n,
                    int d)
    :num(n),
     den(d)
{}

const rational operator*(const rational &lhs, 
                         const rational &rhs)
{
    return  rational( lhs.getNum()*rhs.getNum(),
                      lhs.getDen()*rhs.getDen() );
} 
```

主文件

```
#include "rational.h"
int main()
{
    rational r1(1,2);
    rational r2;
    r2 = 2*r1;
    r2 = r1*3;
    return 0;
} 
```

有人可以解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T15:36:18.123

您忘记告诉您的用户您的运营商的存在：

*理性的.h*

```
...
const rational operator*(const rational &lhs, 
                         const rational &rhs);
... 
```

通常，在 C 和 C++ 中，我们谈论“定义”和“声明”。声明是使某些东西对其他人可见的注释，但它们本身什么也不做。定义是实际做某事的实体：

```
int foo();              // <- we call it "declaration"
int foo() { return 0; } // <- we call it foo's "definition" 
```

在您的代码中，main.cpp 中没有`operator*`可见声明，因此您需要在某处提供一个（最好在理性的标题中）。

作为一种风格建议：在几乎所有情况下，如果构造函数采用内置类型，您希望使其显式：

```
explicit rational (int, int); 
```

这可以防止有时细微的错误，因为（在您的情况下）`rational`s 可能是无意创建的（请参阅[Automatic Conversions](http://www.gotw.ca/gotw/019.htm)）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-12T15:36:56.723

您尚未`operator*`在头文件中声明 ，因此在`main.cpp`.

# iphone - 告诉 UITableView 在不可见时不要释放单元格

> ID：10126901
> 
> 赞同：0
> 
> 时间：2012-04-12T15:34:38.907
> 
> 标签：iphone, objective-c, uitableview

有什么方法可以告诉 UITableView 在单元格变得不可见时*不要释放它们？*

我问这个是因为我有这个问题：我有一个 UITableView 用作“插入视图”。在单元格内，我有许多 UITextView。当我推送 UITableView 时，我将“becomeFirstResponder”发送到第一个单元格，以在打开键盘的情况下启动视图。这可以正常工作。

但是，如果我向下滚动，当第一个单元格变得不可见时，键盘会自行关闭。注意：关联的 UITextView 是一个属性 retain 并且它正确地保持分配，只是单元格消失并且 UITextView 似乎辞职了第一响应者。

我知道我可以检查 UITextView 何时恢复可见并发送另一个 becomeFirstResponder，但我想知道我是否可以通过第一个请求达到我的目标:-)

谢谢问候法比奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-15T14:59:10.897

这里我发现了一些新信息：

我看到键盘只是第一次关闭。示例：视图以 UITextView 作为 firstResponder 加载。滚动，键盘将关闭。但是，再次点击 UITextView 后，键盘会再次打开，然后永远不会关闭，即使再次滚动也是如此。

为了了解原因，我发现了这一点：

*   在“viewDidLoad”中，我设置了第一响应者
*   在 cellForRowAtIndexPath 我将 UITextView 添加为子视图
*   在 ViewDidLoad 之后调用 cellForRowAtIndexPath

当 UITextView 退出第一响应者时，我看到它正在发生，因为 UITableView 正在搜索调用 CellForRowAtIndexPath 方法的特定单元格。但是，再次点击后，只为其他单元格调用 CellForRowAtIndexPath，而不是为选定的单元格调用。似乎，如果在 UITableView 设置后将 UITextView 设置为第一响应者，则即使不可见，也会保留该单元格。

然后，我尝试在“viewDidAppear”（在 uitableview 设置之后调用）中移动“becomefirstresponder”，然后，神奇地，问题解决了:-) 如果里面的 UITextView 是第一响应者，则不再释放单元格。

唯一剩下的问题是：在 viewDidApper 中调用“becomeFirstResponder”会导致键盘延迟显示在屏幕上。为了避免这种情况，我在 viewDidLoad 中调用了 becomeFirstResponder，然后在 viewDidAppear 中我辞职并再次调用了 becomeFirstResponder。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T17:07:22.457

在单元格中使用 tableview 通常它不会释放单元格。第一次它会分配一些可见的单元格，第一个时间表出现，之后它使用相同的单元格意味着在不同的 indexpath 的不同日期重用相同的单元格，你应该使用 UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

# ruby-on-rails - 测试时将表单发布到外部 URL 失败并出现 RoutingError

> ID：10126905
> 
> 赞同：1
> 
> 时间：2012-04-12T15:34:48.847
> 
> 标签：ruby-on-rails, rspec, braintree

我对发布到 Braintree 的透明重定向 API 的 Rails 应用程序进行了集成测试。基本上，测试用有效数据填写表格，并且只期望得到正确的响应。我并不是要测试 Braintree 的每一项验证——只需要一个测试来确保我的表单在大多数情况下都能正常工作。

但是，我的表单抛出了这个错误：

```
1) Braintree CreditCard integration creates a credit card on Braintree and locally
Failure/Error: click_on 'Add card'
ActionController::RoutingError:
   No route matches [POST] "/merchants/XXX/transparent_redirect_requests" 
```

有问题的 form_for 助手看起来像：

```
=form_for :credit_card, :params => @result && @result.params[:credit_card],
:errors => @result && @result.errors.for(:credit_card),
:builder => ApplicationHelper::BraintreeFormBuilder,
:url => Braintree::TransparentRedirect.url,
:html => {:autocomplete => "off"} do |f| 
```

相关行似乎是 Braintree::TransparentRedirect.url - 也许在测试环境中这会被截断/丢失相关主机信息？不是这样！为测试输出 page.html 显示以下内容：

`<form accept-charset="UTF-8" action="https://sandbox.braintreegateway.com:443/merchants/XXX/transparent_redirect_requests" autocomplete="off" method="post">`

那么，为什么测试似乎试图在我自己的服务器上点击 /merchants... 而不是将数据发布到 sandbox.braintreegateway.com，正如表单的操作属性明确指出的那样？

此外，手动复制测试程序（用有效数据填写表格，点击提交）在开发和生产中都有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:51:20.180

Rails 集成测试将所有请求发送到您的 Rails 应用程序 - URL 的主机部分被忽略。

只要您使用合适的 capybara 驱动程序，您就可以使用 rspec 请求规范执行此操作 - 默认值`Rack::Test`对于主机具有相同的行为，但 Capybara-webkit 或其中一个 selenium 驱动程序可能会有所不同。

# javascript - Javascript：替换_之后的字符

> ID：10126916
> 
> 赞同：9
> 
> 时间：2012-04-12T15:35:24.857
> 
> 标签：javascript, replace

我正在尝试做一些看起来相当基本的事情，但似乎无法让它发挥作用。

我试图在下划线的最后一个实例之后剥离字符。

我有这个字符串，例如：

www/images/10/20120412/28-696-b0b9815463e47c9371b02b7202788a75_tn.jpg

我试图去掉'tn.jpg'来制作：

www/images/10/20120412/28-696-b0b9815463e47c9371b02b7202788a75_

我尝试做 .slice(0,-6) 但这仅适用于 _tn.jpg 而不是 _med.jpg 的实例。

最终，我将交换不同大小的图像（_med.jpg、_full.jpg 等），并且只需要在最后一个下划线之后（URL 中可能有下划线）。

任何帮助将不胜感激！

扎克

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-12T15:40:44.507

你可以这样：

```
var testURL = "dvuivnhuiv_ew";
var output = testURL.substring(0, testURL.lastIndexOf('_') + 1);
console.log(output); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-12T15:39:14.650

```
var path = "www/images/10/20120412/28-696-b0b9815463e47c9371b02b7202788a75_tn.jpg";
var index = path.lastIndexOf('_');
path = path.substring(0, index+1);
alert(path); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-12T15:45:17.170

```
var url = "www/images/10/20120412/28-696-b0b9815463e47c9371b02b7202788a75_tn.jpg";
var result = url.substring(0, url.lastIndexOf('_')+1);
alert(result); 
```

[**​示例**](http://jsfiddle.net/heera/znwBQ/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-12T21:17:14.620

```
var url = "www/images/10/20120412/28-696-b0b9815463e47c9371b02b7202788a75_tn.jpg";
var result = url.substring( 0,url.indexOf('_')+1);
alert(result);
//or you can type only after _
var url = "www/images/10/20120412/28-696-b0b9815463e47c9371b02b7202788a75_tn.jpg";
var result = url.substring( url.indexOf('_'));
alert(result);
// (substring) is mean how much you want display chracter and where like from 0 to 63

// (indexOf) is mean number chracter on line

// note: if u have two _ i think will get some problme 
```

# jquery - 使用 jQuery 在交互式地图上显示和隐藏元素

> ID：10126920
> 
> 赞同：0
> 
> 时间：2012-04-12T15:35:33.927
> 
> 标签：jquery, show-hide

我正在使用一些 jquery 制作一个简单的交互式地图，但我不确定如何正确地完成它。

我在地图上有一个标志列表，当用户单击一个标志（即法国）时，一个特色帖子缩略图将出现在一个 div（法国 div）中，如果他们再次单击它，它将消失。我的问题是当“法国” div 显示时，我点击了一个新标志，即。巴西 我不能用“巴西”div 替换“France”div。

jQuery：

```
$(document).ready(function() {
    $('.france-posts').hide();
    $('#france_flag').click(function() {
        $('.france-posts').fadeIn(1000);
    });

    $('.brazil-posts').hide();
    $('#brazil_flag').click(function() {
        $('.laos-posts').fadeIn(1000);
    });

    $('.ireland-posts').hide();
    $('#ireland_flag').click(function() {
        $('.laos-posts').fadeIn(1000);
    });
}); 
```

HTML：

```
<div id="france">
    <ul id="flags">
        <li id="france_flag" onclick="" ></li>
    </ul>
</div>

<div id="brazil">
    <ul id="flags">
        <li id="brazil_flag" onclick="" ></li>
    </ul>
</div>

<div id="ireland">
    <ul id="flags">
        <li id="ireland_flag" onclick="" ></li>
    </ul>
</div>

<div class="flag-posts">
    <div class="france-posts">
        <?php query_posts(array('category__in' => array(4), 'posts_per_page' => 4)); ?>
            <a href="<?php the_permalink(); ?>">
                <?php echo get_the_post_thumbnail($currentid, array(120, 100)); ?>
            </a>
        <?php endwhile; endif; wp_reset_query(); ?>
    </div>

    <div class="brazil-posts">
        <?php query_posts(array('category__in' => array(5), 'posts_per_page' => 4)); ?>
            <a href="<?php the_permalink(); ?>">
                <?php echo get_the_post_thumbnail($currentid, array(120, 100)); ?>
            </a>
        <?php endwhile; endif; wp_reset_query(); ?>                
    </div>

    <div class="ireland-posts">
        <?php query_posts(array('category__in' => array(6), 'posts_per_page' => 4)); ?>
            <a href="<?php the_permalink(); ?>">
                <?php echo get_the_post_thumbnail($currentid, array(120, 100)); ?>
            </a>
        <?php endwhile; endif; wp_reset_query(); ?>
    </div>
</div> 
```

对不起，如果这有点模糊。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T17:15:06.243

如果我正确理解您的问题，您希望在单击新帖子时隐藏其他帖子。所以你可以这样做：

```
$(document).ready(function() {
    $('.france-posts').hide();
    $('#france_flag').click(function() {
        $('[class$=posts]').hide();
        $('.france-posts').fadeIn(1000);
    });

    $('.brazil-posts').hide();
    $('#brazil_flag').click(function() {
        $('[class$=posts]').hide();
        $('.laos-posts').fadeIn(1000);
    });

    $('.ireland-posts').hide();
    $('#ireland_flag').click(function() {
        $('[class$=posts]').hide();
        $('.laos-posts').fadeIn(1000);
    });
}); 
```

这一行将隐藏所有类以'posts'结尾的div，从它看起来对你有用->`$('[class$=posts]').hide();`

还有其他更好的方法来处理这个问题，例如使用`posts`and`flags`类并使用数据对象来跟踪正在单击的元素，这将有助于减少您的代码，但以上是快速解决方案。

如果您希望旧标志淡出，只需`hide()`将`fadeOut()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T01:39:55.603

谢谢我让它与这个代码一起工作：

```
$(document).ready(function() {
$('.laos-posts').hide();
$('#laos_flag').click(function() {
    $('.selected').fadeOut();
    $('.laos-posts').fadeIn(1000);
    $('.laos-posts').addClass("selected");
});

$('.vietnam-posts').hide();
$('#vietnam_flag').click(function() {
    $('.selected').fadeOut();
    $('.vietnam-posts').fadeIn(1000);
    $('.vietnam-posts').addClass("selected");
});

$('.indonesia-posts').hide();
$('#indonesia_flag').click(function() {
    $('.selected').fadeOut();
    $('.indonesia-posts').fadeIn(1000);
    $('.indonesia-posts').addClass("selected");
   });
}); 
```

# c# - 关闭一个表格并打开另一个表格

> ID：10126924
> 
> 赞同：0
> 
> 时间：2012-04-12T15:35:41.560
> 
> 标签：c#, winforms, oop

我有一个以登录屏幕启动的 Winforms 应用程序。如果用户的登录凭据良好，则调用此方法：

```
public void success()
{
    mainForm index = new mainForm();
    index.Show();
    this.Close();
} 
```

我认为这会打开`mainForm`并关闭登录表单，但是当我运行它时，它会关闭整个应用程序。这是为什么？总的来说，我对 C# 和 OOP 还是很陌生，所以任何提示都值得赞赏！

我试着做这样的事情： [关闭一个表单，然后调用另一个](https://stackoverflow.com/questions/2751076/closing-a-form-and-then-call-another-one)

但我仍然得到相同的结果。

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:37:38.283

这样做：

```
static class Program
 {
  /// <summary>
  /// The main entry point for the application.
  /// </summary>
  [STAThread]
  static void Main()
  {   
    using (Login login = new Login())
    {
     login.StartPosition = FormStartPosition.CenterScreen;
     if (login.ShowDialog() == DialogResult.OK)
     {      
      Application.Run(new Form1(login.strUserName)); //passing the userName to the constructor of form1 (see bellow)
     }
   }
  }
 }

//form1:
 public partial class Form1 : Form
 {  
  string userName; 
  public Form1(string _strUser)
  {   
   InitializeComponent();
   userName = _userName; //a local variable of a form1 class has hold user`s name (userName - which u can call it from within the form1 class!
  }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:39:20.000

如另一个问题中所述，您无法关闭应用程序的主窗口（即传递给的窗口`Application.Run()`）。

要解决此问题，请将您的实例传递`mainForm`给`Application.Run()`并让您`mainForm`在打开时显示登录对话框。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:41:49.890

您可能希望在 Program.cs 中移动您的登录表单，而不是将其设置为启动表单。在此处查看更多信息：[如何在不关闭应用程序的情况下关闭登录表单并显示主表单？](https://stackoverflow.com/questions/4759334/how-can-i-close-a-login-form-and-show-the-main-form-without-my-application-closi)

另一种解决方案是在用户成功登录后隐藏登录表单并打开新的登录表单，并在主窗口关闭时使用事件关闭登录表单（将被隐藏）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-12T16:25:38.873

这里的答案解释了一些解决方案，但要澄清问题，请参阅 MSDN 上的[Application.Run Method (Form)](http://msdn.microsoft.com/en-us/library/ms157902.aspx)。它指出：

> 此方法将事件处理程序添加到 Closed 事件的 mainForm 参数。事件处理程序调用 ExitThread 来清理应用程序。

因此，因为您是从登录框开始的，所以一旦它关闭，它就会触发 ExitThread 并关闭应用程序。正如我所说，这里的其他答案说明了避免此问题的几种方法，例如直接在 Main() 中创建登录框或启动主窗体并让它管理显示登录框。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T05:57:28.973

回答你的问题：它可以是任何变量。这是我编造的一个变量。它来自哪里：它实际上来自登录表单。有一个公共属性有一个私有设置器，并且只能在登录表单中设置。从我的代码中可以看出，我明白了：

```
Application.Run(new Form1(login.strUserName)); 
```

login 是登录表单的引用。因此，我只将 strUserName 变量从登录表单“转移”到 Program（一切开始的地方）和 Form1，这样我就可以在那里显示它。 **为什么我必须转移它，为什么我不能简单地从 Form1 访问它？** 这是因为当代码来到 Form1 时，Login 表单已经被释放，并且来自 Login 的所有成员都设置为 null（不可访问）。你可以看到当我实例化 Login 类时，我是在 using 块中完成的，所以当代码离开它时，类也将它处理掉。

顺便说一句，登录表单如下所示：

```
class Login
{
   public string strUserName { get; private set; }
} 
```

希望对理解有所帮助。再见

# c# - 根据枚举的描述检索枚举的值

> ID：10126925
> 
> 赞同：0
> 
> 时间：2012-04-12T15:35:44.817
> 
> 标签：c#, enums

[通过其描述属性查找枚举值的](https://stackoverflow.com/questions/3422407/finding-an-enum-value-by-its-description-attribute/3422440#3422440)可能重复项

我从用户选择的复选框中获得了 MyEnum 的描述，我必须找到该值并保存它。有人可以帮助我如何找到 Enum 给定描述的值

```
public enum MyEnum
{
   [Description("First One")]
   N1,
   [Description("Here is another")]
   N2,
   [Description("Last one")]
   N3
} 
```

例如，我将给 Here is another 我必须返回 N1，当我收到 Last one 时，我必须返回 N3。

我只需要做与[如何从值中获取 C# 枚举描述相反的操作？](https://stackoverflow.com/questions/2650080/how-to-get-c-sharp-enum-description-from-value)

有人能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:53:10.317

像这样：

```
// 1\. define a method to retrieve the enum description
public static string ToEnumDescription(this Enum value)
{
    FieldInfo fi = value.GetType().GetField(value.ToString());

    DescriptionAttribute[] attributes =
        (DescriptionAttribute[])fi.GetCustomAttributes(
        typeof(DescriptionAttribute),
        false);

    if (attributes != null &&
        attributes.Length > 0)
        return attributes[0].Description;
    else
        return value.ToString();
}

//2\. this is how you would retrieve the enum based on the description:
public static MyEnum GetMyEnumFromDescription(string description)
{
    var enums = Enum.GetValues(typeof(MyEnum)).Cast<MyEnum>();

    // let's throw an exception if the description is invalid...
    return enums.First(c => c.ToEnumDescription() == description);
}

//3\. test it:
var enumChoice = EnumHelper.GetMyEnumFromDescription("Third");
Console.WriteLine(enumChoice.ToEnumDescription()); 
```

# c# - 如何告诉 System.Xml.Serialization.XmlSerializer 只序列化基类？

> ID：10126927
> 
> 赞同：3
> 
> 时间：2012-04-12T15:35:51.673
> 
> 标签：c#, xmlserializer, base-class

我有一个基类的对象数组`MyBase`。其中一些对象是派生类的实例，因此当我尝试使用`System.Xml.Serialization.XmlSerializer`它序列化此数组时，它会因对派生类的抱怨而失败：*System.InvalidOperationException: DerivedClass 类型不是预期的。使用 XmlInclude 或 SoapInclude 属性指定静态未知的类型。*

我不想序列化派生类，我绝对不想放入`[XmlIgnore()]`派生类（或`[XmlInclude()]`基类中，就此而言）！

有没有办法告诉`XmlSerializer`只为这样的成员**序列化基础**？

```
[XmlElement("Items")]
public MyBase[] Items
{
    get
    {
        return items.ToArray();
    }
    set 
    {
        items = new HashSet<MyBase>(value);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T20:41:25.670

您可以对项目集合进行 Linq 查询，过滤类型：

```
[XmlElement("Items")]
public MyBase[] Items
{
    get
    {
        return items.Where(item => item.GetType() == typeof(MyBase)).ToArray();
    }
    set 
    {
        items = new HashSet<MyBase>(value);
    }
} 
```

# vb6 - 在 64 位 Windows 下从映射驱动器运行 32 位应用程序？

> ID：10126928
> 
> 赞同：0
> 
> 时间：2012-04-12T15:35:52.763
> 
> 标签：vb6, 32bit-64bit, windows-7-x64

我有一个 32 位 (VB6) 应用程序，它始终从网络驱动器运行（在 32 位 Windows XP 下），以便多个用户可以访问它，并且只需要在一个地方进行更新。

但是，当我们将（Windows 7）64 位机器添加到网络时，我无法找到一种方法让这些机器在 32 位兼容模式下运行应用程序并将其保留在网络驱动器上（尽管我可以为本地安装）。

有没有办法解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T08:14:35.300

我不明白你为什么需要在 32 位兼容模式下运行？

我可以从本地驱动器或网络驱动器的 Windows 7 64 位计算机上正常运行 VB6 应用程序（无需更改兼容性设置）

您可能遇到的唯一问题是确保在相关机器上注册了 VB6 运行时以及所需的任何 OCX 和 ActiveX DLL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T03:38:36.590

确实不支持“从网络共享运行”。一方面，覆盖操作会导致高网络流量，这可能会导致超时或数据错误，从而导致程序崩溃。对于另外许多程序，尤其是那些用 VB6 编写的程序，具有需要本地安装才能正常工作的依赖项。

AppCompat 数据库是您特定问题的另一个参与者。与您正在超越 Windows XP 的事实相比，64 位的问题可能要小得多。您知道您的程序需要哪些 appcompat 垫片才能正常运行吗？通常较小的重写可以避免对大部分（如果不是全部）的需要。应用程序兼容性工具包旨在帮助您跟踪这些问题。

请参阅[在企业中管理](http://technet.microsoft.com/en-us/library/dd837648%28WS.10%29.aspx)Shim，但是我不相信您可以为未本地安装的程序创建 Shim 数据库条目。

# javascript - 将产品自定义选项值保存到 js 文件

> ID：10126929
> 
> 赞同：0
> 
> 时间：2012-04-12T15:36:01.500
> 
> 标签：javascript, magento

我是 magento 的新手，我正在使用 magento 开发一个电子商务网站。我在添加产品时使用自定义选项，现在我只想在保存/编辑产品时将一些自定义选项值（例如：颜色自定义选项的值）保存到 js 文件中。我应该在哪里添加代码来执行此操作以及如何添加。有人有想法吗？请与我分享。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T15:56:52.267

在您的 config.xml 模块中：

```
<global>
    <events>
        <catalog_product_save_after>
            <observers>
                <yourmodule>
                    <type>singleton</type>
                    <class>yourmodule/observer</class>
                    <method>catalog_product_save_after</method>
                </yourmodule>
            </observers>
        </catalog_product_save_after>
    </events>
</global> 
```

在你的 Observer.php 中：

```
class YourNamespace_YourModule_Model_Observer
{
    public function catalog_product_save_after($observer)
    {
        $product = $observer->getProduct();
        //echo "<pre>"; print_r($product->getData()); exit;
        // do something here
    }
} 
```

之后，您将获取您需要的值并编写您需要构建的 JS 文件。

希望这可以帮助。

来源： http: [//blog.chapagain.com.np/magento-event-observer-with-save-before-and-save-after/](http://blog.chapagain.com.np/magento-event-observer-with-save-before-and-save-after/)

# php - Foreach 循环中奇怪的 SimpleMODAL OSX 动作

> ID：10126931
> 
> 赞同：0
> 
> 时间：2012-04-12T15:36:08.597
> 
> 标签：php, javascript, jquery, simplemodal, wordpress

我正在一个**Wordpress MU**网站上开发一个**PHPBB3**论坛，该论坛已合并到该网站中。在网站上有一个使用**SimpleModal OSX 样式模式对话框**的页面，用于查询一些网站用户数据。我还使用了一个插件，它允许您为每个名为**Cimy User Extra Fields**的用户创建自定义元信息。在我详细讨论问题之前，我想确保我的解释很彻底，因为显然我以前没有。

进入问题…………

问题在于页面上使用了**SimpleModal OSX Style Modal Dialog** jquery 函数。在此页面上，它查询网站用户数据，并通过 PHP 中的 Foreach 序列；在 div 列中显示页面上的数据。利用 **SimpleModal OSX 样式模式对话框**的代码部分显示为列中列出的每个用户旁边的按钮。

当您单击激活模态窗口的按钮时；该模式窗口内部是该用户的元数据。每个模态窗口中存储的数据应该与每个用户匹配。相反，它只显示它在系统中找到的第一个用户的数据，跨越页面上的所有模式窗口。

最初我通过 foreach 循环运行该函数，存储在 MODAL 窗口中的结果数据是相同的数据 - 而不是函数从数据库查询的每个用户都是唯一的。

一个示例是网站上有 10 个用户，因此 foreach 循环将返回列中列出的此页面上的 4 个用户。[您可以在此处](http://conspirators.websitedesignbyneo.com/guild-roster/)查看可视化表示。

如果您正在查看该页面，您将看到列出了 4 个用户。对于每个用户，它会显示他们的头像图像、显示名称、排名、一个查看卡通的按钮、一个挑战按钮和一个发送电子邮件的链接。查看卡通按钮是问题所在。

正如我上面所说的，它在模态窗口中一遍又一遍地为每个按钮显示相同的数据——而不是每个用户唯一的数据。[在爸爸](https://stackoverflow.com/users/1226894/baba)的帮助下， 他给了我一记耳光，说明剧本出了什么问题。不幸的是，我无法让它工作。对不起，爸爸不太确定我做错了什么。我采用了一种不同的方法，我“觉得”这对于我的新手来说可能是一个更简单的解决方案。

正如 Baba 所提到的，问题在于 Javascript 正在寻找一个特定的 ID 来调用创建模式窗口的脚本。因为这是一个 foreach 循环，所以在我目前的情况下，它会重复 View Toons 按钮 4 次。因此，我们有 4 个按钮，当按下它们时会弹出一个模态窗口，其中存储了元数据。单击这 4 个按钮时，所有四个按钮都显示相同的数据。那么，解决方案呢？我们需要以某种方式随机化每个按钮的 ID，并且 jquery 函数能够识别它需要在每个按钮上激活。

我花了几个小时试图利用巴巴的想法，但无法让它发挥作用。因此，我在网上进行了更深入的挖掘，并在 stackoverflow 上遇到了这个问题/答案，您可以[在此处查看](https://stackoverflow.com/questions/2129006/multiple-calls-with-simple-modal-osx-style-dialog/2258297#2258297)。我遇到的问题完全相同，SimpleModal 的开发人员提供了答案。唯一的问题是答案是基于已经存在的 id 而不是会在循环中自动创建的 ID .....

我的解决方案.......

我需要一种方法来生成随机的数字和字母字符串。我在[这里](http://www.php.net/manual/en/function.rand.php)找到了这个解决方案。我如何将它实现到我的代码中：

```
<?php 
    $n = rand(10e16, 10e20);
    $x = base_convert($n, 10, 36);
?> 
```

现在我已经在代码中生成了这个随机字符串，我需要一种方法让 Jquery 函数能够使用随机的数字和字母字符串来识别这些 ID。我需要一个通配符.....这是我使用的：

```
$("[id^=osx-modal-content]").modal({ 
```

有了这个，我认为它肯定会起作用！它没......

奇怪的是，它确实做了一些很奇怪的事情，我不确定我是否可以用书面形式很好地解释它，如果你在我尝试解释它时直观地观察它产生的东西会更好。[您可以在此处](http://conspirators.websitedesignbyneo.com/guild-roster/)查看该页面。

所以这些小红色 x 字符出现在每个查看按钮下方。这些红色的小 x 字符代表这部分代码：

```
<div id="osx-modal-content<?php echo $x;?>"> 
```

啊! 这些是包含每个模式窗口中元数据的 div。为什么出现红色 x 我不知道。更奇怪的是，当您单击 4 个查看按钮中的任何一个时。模态窗口不仅没有完全展开，而且就像一扇被附身的车库门。它下降了一点，然后又回到了原点。在它向下滑动的过程中，您也看不到元数据。这可能是因为模态窗口没有完全展开。

然后单击查看卡通按钮后会出现另一个问题。出现在每个卡通按钮下方的那些小红色 x 将自己重新定位在第一个查看卡通按钮下方。现在是我上面列出的 osx-modal-content(random string) 的 DIV.ID。所有这四个 div 现在都位于第一个视图卡通按钮下。么么哒？？？

这就是我在伙计们的地方。我希望我使用这段代码走在正确的道路上，很抱歉，爸爸，我无法让您的解决方案正常工作，我希望这对其他愿意帮助理解我在做什么的人来说是足够的信息。

==================================================== ================================ **更新**：正如Pointy提到的，当它应该是类时，我在循环中使用ID ，我查看了样式表并注意到这行代码：

```
#osx-modal-content, #osx-modal-data {display:none;} 
```

因为我在#osx-modal-content 的末尾添加了随机字母数字字符串。它没有注册 display:none 的样式。我将此添加到代码中：

```
<div id="osx-modal-content<?php echo $x;?>" style="display:none"> 
```

这让那些讨厌的小红x消失了。谢谢你的尖尖！我目前正在尝试更改循环中的 DIV 的相应 ID/类 - 看看这是否会有所作为。

**更新 2**：我在 jquery 函数中更改了第 18 行，原来是这样的：

```
$("osx").click(function (e) { 
```

对此：

```
$("[id^=osx]").click(function (e) { 
```

这导致疯狂的，附身的车库门效应停止。它现在滑出并显示每个用户的元信息。但是，当您单击“查看卡通”按钮时，它现在会在框中显示所有用户元信息，而不仅仅是选定的“用户”。此外，当您单击每个按钮时，它会根据用户 ID 号按 ASC 顺序列出用户。

**更新 3**：我几乎肯定模态窗口显示所有用户信息的问题是因为我设置了通配符。它基于任何以 osx-modal-content 开头的 div 打开，这将导致它显示每个用户的元信息。我需要 jquery 函数的不同解决方案。

那些愿意看看这个并帮助我的人。我在下面列出了完整的代码、查询函数和 Jquery 函数：

查询网站用户元数据的自定义函数：

```
<?php
    function roster()
    {
        $members    = get_users('blog_id=15&exclude=array(1)');
        foreach ($members as $user) 
        { 

            $item['login']      = $user->display_name;
            $item['email']      = $user->user_email;
            $item['picture']    = get_cimyFieldValue($user->ID, 'picture'); 
            $item['rank']       = get_cimyFieldValue($user->ID, 'guild_rank'); 
            $item['game']       = get_cimyFieldValue($user->ID, 'game'); 
            $item['avatar']     = get_cimyFieldValue($user->ID, 'avatar');
            $item['toon_name'] = get_cimyFieldValue($user->ID, 'character_name');
            $item['faction']    = get_cimyFieldValue($user->ID, 'faction');
            $item['class']  = get_cimyFieldValue($user->ID, 'class'); 
            $item['role']       = get_cimyFieldValue($user->ID, 'role');
        } 
        unset($members);
        return $ret;
    }
?> 
```

从函数调用的每个用户的循环：

```
<?php 
    $ret = roster(); 

    if ( ! empty($ret))
    {
        foreach($ret as $v)
        { ?>

            <div id = "roster_container">
                <div id="left_col">
                    <div id="first_left_col">
                        <h4>Avatar</h4>
                        <?php echo '<li><img src="' . $v['picture'] . '" alt="" /></li>';?>
                    </div>

                    <div id="second_left_col">
                        <h4>Username</h4>
                        <?php echo '<li>' . $v['login'] . '</li>';?>
                    </div>

                    <div id="third_left_col">
                        <h4>Rank</h4>
                        <?php echo '<li>' . $v['rank'] . '</li>';?>
                    </div>
                </div>

                <div id="right_col">        
                    <div id="first_right_col">
                        <h4>Toons</h4>
                        <li>
                            <div id='osx-modal'>
                                <?php 
                                    $n = rand(10e16, 10e20);
                                    $x = base_convert($n, 10, 36);
                                ?>

                                <input type="button" name="osx<?php echo $x;?>" value="View" class="osx<?php echo $x;?>" id="osx<?php echo $x;?>"/>
                            </div>

                            <div id="osx-modal-content<?php echo $x;?>" style="display:none;">
                                <div class="close"><a href="#" class="simplemodal-close">x</a></div>
                                <div id="osx-modal-data">                                   
                                    <div id="toon_title">Game Characters</div>
                                    <div id="toon_game">                                    
                                        <?php echo '<h3>' . $v['game'] . '</h3>';?>
                                    </div>

                                    <div id="toon_box">
                                        <div id="toon_name"><?php echo $v['toon_name'];?></div>
                                        <div id="toon_avatar"><?php echo '<img src="' . $v['avatar'] . '" alt="" />';?></div>       
                                        <div id="toon_faction"><?php echo $v['faction'];?></div>
                                        <div id="toon_class"><?php echo $v['class'];?></div>
                                        <div id="toon_role"><?php echo $v['role'];?></div>
                                    </div>

                                    <p><button class="simplemodal-close">Close</button></p>
                                </div>
                            </div>
                        </li>
                    </div>
                    <div id="second_right_col">
                        <h4>Challenge</h4>
                        <?php echo '<li><a href="#" class="CHALLENGE">Challenge</a></li>';?>
                    </div>

                    <div id="third_right_col">
                        <h4>Email</h4>
                        <?php echo '<li><a href="mailto:' . $v['email'] . '"><img src="http://conspirators.websitedesignbyneo.com/wp-content/themes/conspirators/css/dark-red/img/email-icon.gif" style="height:15px;width:20px;margin-top:5px;margin-left:7px;"></a></li>';?>
                    </div>
                </div>
            </div>
        <?php
        }
    }
    ?> 
```

最后是 SimpleModal OSX 样式的模态对话框 Jquery：

```
/*
* SimpleModal OSX Style Modal Dialog
* http://www.ericmmartin.com/projects/simplemodal/
* http://code.google.com/p/simplemodal/
*
* Copyright (c) 2010 Eric Martin - http://ericmmartin.com
*
* Licensed under the MIT license:
*   http://www.opensource.org/licenses/mit-license.php
*
* Revision: $Id: osx.js 238 2010-03-11 05:56:57Z emartin24 $
*/

jQuery(function ($) {
var OSX = {
    container: null,
    init: function () {
            $("[id^=osx]").click(function (e) {
            e.preventDefault(); 
            $("[id^=osx-modal-content]").modal({
                overlayId: 'osx-overlay',
                containerId: 'osx-container',
                closeHTML: null,
                minHeight: 80,
                opacity: 65, 
                position: ['0',],
                overlayClose: true,
                onOpen: OSX.open,
                onClose: OSX.close
            });
        });
    },
    open: function (d) {
        var self = this;
        self.container = d.container[0];
        d.overlay.fadeIn('slow', function () {
            $("[id^=osx-modal-content]", self.container).show();
            var title = $("#osx-modal-title", self.container);
            title.show();
            d.container.slideDown('slow', function () {
                setTimeout(function () {
                    var h = $("#osx-modal-data", self.container).height()
                        + title.height()
                        + 20; // padding
                    d.container.animate(
                        {height: h}, 
                        200,
                        function () {
                            $("div.close", self.container).show();
                            $("#osx-modal-data", self.container).show();
                        }
                    );
                }, 300);
            });
        })
    },
    close: function (d) {
        var self = this; // this = SimpleModal object
        d.container.animate(
            {top:"-" + (d.container.height() + 20)},
            500,
            function () {
                self.close(); // or $.modal.close();
            }
        );
    }
};

OSX.init();

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T20:45:47.167

变量 $ret 似乎不包含任何内容？

1- 请在您的 LI 周围使用 UL 2- 请使用类而不是 ID

所以，我不太确定你想用随机数实现什么，我不知道 overlayId 和 containerId 应该指什么，但这看起来是一种更好的做事方式：

```
<?php 
    $ret = roster(); 

    if ( ! empty($ret))
    {
        foreach($ret as $v)
        { ?>

            <div class="roster_container">
                <div class="left_col">
                    <div class="first_left_col">
                        <h4>Avatar</h4>
                        <?php echo '<li><img src="' . $v['picture'] . '" alt="" /></li>';?>
                    </div>

                    <div class="second_left_col">
                        <h4>Username</h4>
                        <?php echo '<li>' . $v['login'] . '</li>';?>
                    </div>

                    <div class="third_left_col">
                        <h4>Rank</h4>
                        <?php echo '<li>' . $v['rank'] . '</li>';?>
                    </div>
                </div>

                <div class="right_col">        
                    <div class="first_right_col">
                        <h4>Toons</h4>
                        <ul>
                          <li>
                              <div class='osx-modal'>
                                  <?php 
                                      $n = rand(10e16, 10e20);
                                      $x = base_convert($n, 10, 36);
                                  ?>

                                  <input type="button" name="osx" value="View" class="osx" class="osx"/>
                              </div>

                              <div class="osx-modal-content" style="display:none;">
                                  <div class="close"><a href="#" class="simplemodal-close">x</a></div>
                                  <div class="osx-modal-data">                                   
                                      <div class="toon_title">Game Characters</div>
                                      <div class="toon_game">                                    
                                          <?php echo '<h3>' . $v['game'] . '</h3>';?>
                                      </div>

                                      <div class="toon_box">
                                          <div class="toon_name"><?php echo $v['toon_name'];?></div>
                                          <div class="toon_avatar"><?php echo '<img src="' . $v['avatar'] . '" alt="" />';?></div>       
                                          <div class="toon_faction"><?php echo $v['faction'];?></div>
                                          <div class="toon_class"><?php echo $v['class'];?></div>
                                          <div class="toon_role"><?php echo $v['role'];?></div>
                                      </div>

                                      <p><button class="simplemodal-close">Close</button></p>
                                  </div>
                              </div>
                          </li>
                        </ul>
                    </div>
                    <div class="second_right_col">
                        <h4>Challenge</h4>
                        <ul>
                          <?php echo '<li><a href="#" class="CHALLENGE">Challenge</a></li>';?>
                        </ul>
                    </div>

                    <div class="third_right_col">
                        <h4>Email</h4>
                        <ul>
                          <?php echo '<li><a href="mailto:' . $v['email'] . '"><img src="http://conspirators.websitedesignbyneo.com/wp-content/themes/conspirators/css/dark-red/img/email-icon.gif" style="height:15px;width:20px;margin-top:5px;margin-left:7px;"></a></li>';?>
                        </ul>
                    </div>
                </div>
            </div>
        <?php
        }
    }
    ?>

<script>
  jQuery(function ($) {
  var OSX = {
      container: null,
      init: function () {
              $("[name=osx]").click(function (e) {
                e.preventDefault(); 
                $(this).parent().next().modal({
                    overlayId: 'osx-overlay',
                    containerId: 'osx-container',
                    closeHTML: null,
                    minHeight: 80,
                    opacity: 65, 
                    position: ['0',],
                    overlayClose: true,
                    onOpen: OSX.open,
                    onClose: OSX.close
                });
            });
      },
      open: function (d) {
          var self = this;
</script> 
```

# solr - solr/lucene：可以在索引后添加术语向量吗？

> ID：10126933
> 
> 赞同：1
> 
> 时间：2012-04-12T15:36:12.377
> 
> 标签：solr, lucene, mahout

我继承了一个 lucene 索引，我很想将 Mahout 指向它，但初始配置并没有要求任何内容字段具有与之关联的 termVectors。

是否有可能（也许通过编写 Luke 的脚本？）在文档被索引后添加 termvector 信息？

# jquery - 使用 MVC 4 进行远程 jQuery 验证，动态验证所有以 loc 开头的输入？

> ID：10126935
> 
> 赞同：1
> 
> 时间：2012-04-12T15:36:17.270
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-4, server-side-validation

描述：

我在一个 MVC4 应用程序中有一个简单的表单，它有 5 个名为 loc1-5 的文本框和一个提交按钮。该应用程序在文本框 loc1-5 中最多占用 5 个地址，并使用带有 jQ​​uery 的 bing 地理编码服务对地址进行一些处理并创建带有方向的地图。

问题是我需要验证 loc1-5 文本框以确保它们是有效地址，然后再继续并决定最有意义的方法是使用 jQuery.validate 远程调用可以使用我的 MVC 控制器函数用于检查有效地址的预构建函数。

现在我确实想出了一个可行的解决方案来验证这些字段，但我迫切需要使它更加动态，以便将来可以以最小的努力添加更多的文本框。理想情况下，我希望逻辑能够对所有以“loc”开头的输入进行验证。

工作解决方案（非常脏）：

简单形式（在 MVC 视图中）

```
<form action="/Home/ViewResult" method="post" id="ViewResult" name="ViewResult">
<fieldset>
<legend>Enter Route</legend>
<p>
Address 1 (Start & End):
</p>
<p>
<input type="text" id="loc1" name="loc1" value='' />
</p>
<p>
Address 2:
</p>
<p>
<input type="text" id="loc2" name="loc2" value='' />
</p>
<p>
Address 3:
</p>
<p>
<input type="text" id="loc3" name="loc3" value='' />
</p>
<p>
Address 4:
</p>
<p>
<input type="text" id="loc4" name="loc4" value='' />
</p>
<p>
Address 5:
</p>
<p>
<input type="text" id="loc5" name="loc5" value='' />
</p>
<p>
<input type="submit" value="Route"/>
</p>
</fieldset>
</form> 
```

jQuery 验证代码（在 MVC 视图中）

```
<script src="../../Scripts/jquery.validate.js" type="text/javascript"></script>
<script type="text/javascript"> 
```

```
    $(文档).ready(函数 () {
        $("#ViewResult").validate({
            onfocusout：错误，
            onkeyup：假，
            规则：{
                “loc1”：{
                    要求：真，
                    偏僻的： {
                        url: "/Home/IsValidAddress1",
                        超时：2000，
                        类型：“帖子”
                    }
                },
                “loc2”：{
                    要求：真，
                    偏僻的： {
                        url: "/Home/IsValidAddress2",
                        超时：2000，
                        类型：“帖子”
                    }
                },
                “loc3”：{
                    要求：真，
                    偏僻的： {
                        url: "/Home/IsValidAddress3",
                        超时：2000，
                        类型：“帖子”
                    }
                },
                “loc4”：{
                    偏僻的： {
                        url: "/Home/IsValidAddress4",
                        超时：2000，
                        类型：“帖子”
                    }
                },
                “loc5”：{
                    偏僻的： {
                        url: "/Home/IsValidAddress5",
                        超时：2000，
                        类型：“帖子”
                    }
                }
            },
            消息：{
                “loc1”：{
                    required: "开始/结束位置是必填字段。",
                    远程：“请输入一个有效的地址。”
                },
                “loc2”：{
                    required: "请输入至少 3 个地址。",
                    远程：“请输入一个有效的地址。”
                },
                “loc3”：{
                    required: "请输入至少 3 个地址。",
                    远程：“请输入一个有效的地址。”
                },
                “loc4”：{
                    远程：“请输入一个有效的地址。”
                },
                “loc5”：{
                    远程：“请输入一个有效的地址。”
                },
            }

        });
    });

```

```
</script> 
```

远程引用的 Home Controller 中的函数

```
    // 检查有效地址的函数
    公共布尔 IsValidAddress（字符串位置）
    {
        // 如果不为空
        如果（位置！=“”）
        {
            // 尝试获取航路点
            航点航点 = getWaypoint(location);

            // 如果没有返回航点，则返回 false
            如果（航点==空）
            {
                返回假；
            }
        }

        返回真；
    }

    public JsonResult isValidAddress1(string loc1) // 参数必须是文本框名称
    {
        如果（！IsValidAddress（loc1））
        {
            返回新的 JsonResult { 数据 = false };
        }
        返回新的 JsonResult { 数据 = true };
    }

    public JsonResult isValidAddress2(string loc2) // 参数必须是文本框名称
    {
        如果（！IsValidAddress（loc2））
        {
            返回新的 JsonResult { 数据 = false };
        }
        返回新的 JsonResult { 数据 = true };
    }

    public JsonResult isValidAddress3(string loc3) // 参数必须是文本框名称
    {
        如果（！IsValidAddress（loc3））
        {
            返回新的 JsonResult { 数据 = false };
        }
        返回新的 JsonResult { 数据 = true };
    }

    public JsonResult isValidAddress4(string loc4) // 参数必须是文本框名称
    {
        如果（！IsValidAddress（loc4））
        {
            返回新的 JsonResult { 数据 = false };
        }
        返回新的 JsonResult { 数据 = true };
    }

    public JsonResult isValidAddress5(string loc5) // 参数必须是文本框名称
    {
        如果（！IsValidAddress（loc5））
        {
            返回新的 JsonResult { 数据 = false };
        }
        返回新的 JsonResult { 数据 = true };
    }

```

**问题：**

这同样有效，但它很脏而且根本不是动态的。

基本上我有两个问题。

1.  如何编写 jQuery 速记来为所有以“loc”开头的文本框创建验证规则？
2.  据我所知，处理远程调用的 MVC 控制器函数必须将文本框的名称传递给它。那么如何让一个 MVC 控制器函数处理对它的多个远程调用呢？

我在 jQuery 方面不是很强大，但我真正想要的是这样的东西，所以我可以稍后以最小的努力添加更多的文本框：

```
<script src="../../Scripts/jquery.validate.js" type="text/javascript"></script>
<script type="text/javascript"> 
```

```
    $(文档).ready(函数 () {
        $("#ViewResult").validate({
            onfocusout：错误，
            onkeyup：假，
            规则：{
                “loc1”：{
                    要求：真，
                },
                “loc2”：{
                    要求：真，
                },
                “loc3”：{
                    要求：真，
                },
                $("input=text").StartsWith("loc").each(): {
                    偏僻的： {
                        url: "/Home/IsValidAddress",
                        超时：2000，
                        类型：“帖子”
                    }
                }
            },
            消息：{
                “loc1”：{
                    required: "开始/结束位置是必填字段。",
                },
                “loc2”：{
                    required: "请输入至少 3 个地址。",
                },
                “loc3”：{
                    required: "请输入至少 3 个地址。",
                },
                $("input=text").StartsWith("loc").each(): {
                    远程：“请输入一个有效的地址。”
                },
            }

        });
    });

```

```
</script> 
```

和家庭控制器功能

```
    // 检查有效地址的函数
    public JsonResult IsValidAddress(string loc) // loc 变量连接到动态文本框名称？
    {
        // 如果不为空
        如果 (loc != "")
        {
            // 尝试获取航路点
            航点航点 = getWaypoint(loc);

            // 如果没有返回航点，则返回 false
            如果（航点==空）
            {
                返回新的 JsonResult { 数据 = false };
            }
        }

        返回新的 JsonResult { 数据 = true };
    }

```

最后请注意，我没有能力更改 MVC 模型。我见过很多与此类似的解决方案，它们直接在 MVC 模型中编写验证规则和远程调用，但我根本无法那样做。

欢迎任何改进建议，并提前感谢您的任何回复。

请尝试告诉我我哪里出错了，或者我想要的是否可能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T23:42:20.420

所以我想通了。

**最终工作解决方案：**

MVC Home Controller 中的功能：

```
    // 检查有效地址的函数
    // 注意：地址变量参数连接到远程调用中的数据属性
    public JsonResult IsValidAddress(字符串地址)
    {
        // 如果不为空
        如果（地址！=“”）
        {
            // 尝试获取航路点
            航点航点 = getWaypoint(地址);

            // 如果没有返回航点，则返回 false
            如果（航点。位置 == 空）
            {
                返回新的 JsonResult { 数据 = false };
            }
        }
        返回新的 JsonResult { 数据 = true };
    }

```

视图中的 jQuery 函数：

```
<script src="../../Scripts/jquery.validate.js" type="text/javascript"></script>
<script type="text/javascript"> 
```

```
    $(文档).ready(函数 () {
        $("#ViewResult").validate({
            onfocusout：错误，
            onkeyup: 假
        });
        $("#loc1").rules("add", {
            要求：真，
            消息：{
                required: "开始/结束位置是必填字段。",
            }
        });
        $("#loc2").rules("add", {
            要求：真，
            消息：{
                必填：“请输入至少 3 个地址。”
            }
        });
        $("#loc3").rules("add", {
            要求：真，
            消息：{
                必填：“请输入至少 3 个地址。”
            }
        });
        $('#ViewResult [name^="loc"]').each(function () {
            var currentValue = null;
            当前值 = $(这个);
            $(this).rules("add", {
                偏僻的： {
                    url: "/Home/IsValidAddress",
                    超时：2000，
                    类型：“帖子”，
                    数据：{地址：函数（）{返回currentValue.val（）；} }
                },
                消息：{
                    远程：“请输入一个有效的地址。”
                }
            });
        });
    });

```

```
</script> 
```

我花了很多时间试图弄清楚这一点，我想我会分享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T13:55:35.043

因此，我能够通过在规则声明中使用远程调用的数据属性来定义一个名为“地址”的新参数，然后在 MVC 控制器函数中将其作为参数引用，从而找出问题的第二部分。

这是 Home 控制器中 MVC 控制器功能的更新代码：

```
    // 检查有效地址的函数
    // 注意：地址变量参数连接到远程调用中的数据属性
    public JsonResult IsValidAddress(字符串地址)
    {
        // 如果不为空
        如果（地址！=“”）
        {
            // 尝试获取航路点
            航点航点 = getWaypoint(地址);

            // 如果没有返回航点，则返回 false
            如果（航点。位置 == 空）
            {
                返回新的 JsonResult { 数据 = false };
            }
        }
        返回新的 JsonResult { 数据 = true };
    }

```

对于 jQuery，有两种方法可以做到这一点。

首先使用我之前使用的格式：

```
<script src="../../Scripts/jquery.validate.js" type="text/javascript"></script>
<script type="text/javascript"> 
```

```
    $(文档).ready(函数 () {
        $("#ViewResult").validate({
            onfocusout：错误，
            onkeyup：假，
            规则：{
                “loc1”：{
                    要求：真，
                    偏僻的： {
                        url: "/Home/IsValidAddress",
                        超时：2000，
                        类型：“帖子”，
                        数据：{地址：函数（）{返回$（“#loc1”）.val（）；} }
                    }
                },
                “loc2”：{
                    要求：真，
                    偏僻的： {
                        url: "/Home/IsValidAddress",
                        超时：2000，
                        类型：“帖子”，
                        数据：{地址：函数（）{返回$（“#loc2”）.val（）；} }
                    }
                },
                “loc3”：{
                    要求：真，
                    偏僻的： {
                        url: "/Home/IsValidAddress",
                        超时：2000，
                        类型：“帖子”，
                        数据：{地址：函数（）{返回$（“#loc3”）.val（）；} }
                    }
                },
                “loc4”：{
                    偏僻的： {
                        url: "/Home/IsValidAddress",
                        超时：2000，
                        类型：“帖子”，
                        数据：{地址：函数（）{返回$（“#loc4”）.val（）；} }
                    }
                },
                “loc5”：{
                    偏僻的： {
                        url: "/Home/IsValidAddress",
                        超时：2000，
                        类型：“帖子”，
                        数据：{地址：函数（）{返回$（“#loc5”）.val（）；} }
                    }
                }
            },
            消息：{
                “loc1”：{
                    required: "开始/结束位置是必填字段。",
                    远程：“请输入一个有效的地址。”
                },
                “loc2”：{
                    required: "请输入至少 3 个地址。",
                    远程：“请输入一个有效的地址。”
                },
                “loc3”：{
                    required: "请输入至少 3 个地址。",
                    远程：“请输入一个有效的地址。”
                },
                “loc4”：{
                    远程：“请输入一个有效的地址。”
                },
                “loc5”：{
                    远程：“请输入一个有效的地址。”
                }
            }
        });
    });

```

```
</script> 
```

或者使用 .rules("add") 方法：

```
<script src="../../Scripts/jquery.validate.js" type="text/javascript"></script>
<script type="text/javascript"> 
```

```
    $(文档).ready(函数 () {
        $("#ViewResult").validate({
            onfocusout：错误，
            onkeyup: 假
        });
        $("#loc1").rules("add", {
            要求：真，
            偏僻的： {
                url: "/Home/IsValidAddress",
                超时：2000，
                类型：“帖子”，
                数据：{地址：函数（）{返回$（“#loc1”）.val（）；} }
            },
            消息：{
                required: "开始/结束位置是必填字段。",
                远程：“请输入一个有效的地址。”
            }
        });
        $("#loc2").rules("add", {
            要求：真，
            偏僻的： {
                url: "/Home/IsValidAddress",
                超时：2000，
                类型：“帖子”，
                数据：{地址：函数（）{返回$（“#loc2”）.val（）；} }
            },
            消息：{
                required: "请输入至少 3 个地址。",
                远程：“请输入一个有效的地址。”
            }
        });
        $("#loc3").rules("add", {
            要求：真，
            偏僻的： {
                url: "/Home/IsValidAddress",
                超时：2000，
                类型：“帖子”，
                数据：{地址：函数（）{返回$（“#loc3”）.val（）；} }
            },
            消息：{
                required: "请输入至少 3 个地址。",
                远程：“请输入一个有效的地址。”
            }
        });
        $("#loc4").rules("add", {
            偏僻的： {
                url: "/Home/IsValidAddress",
                超时：2000，
                类型：“帖子”，
                数据：{地址：函数（）{返回$（“#loc4”）.val（）；} }
            },
            消息：{
                远程：“请输入一个有效的地址。”
            }
        });
        $("#loc5").rules("add", {
            偏僻的： {
                url: "/Home/IsValidAddress",
                超时：2000，
                类型：“帖子”，
                数据：{地址：函数（）{返回$（“#loc5”）.val（）；} }
            },
            消息：{
                远程：“请输入一个有效的地址。”
            }
        });
    });

```

```
</script> 
```

# grails - 缺少方法异常

> ID：10126938
> 
> 赞同：2
> 
> 时间：2012-04-12T15:36:22.293
> 
> 标签：grails, groovy, integration-testing

我正在进行集成测试，每次都缺少方法异常，这是集成测试的代码

```
package supasonic

import grails.plugin.spock.IntegrationSpec

class DownloadRequestServiceSpec extends IntegrationSpec {
    def downloadRequestService    

    def 'downloadrequest can be added to the database'(){
        when:'the createDownloadRequest method is called'
            downloadRequestService.createDownloadRequest(123,23,'127.0.0.0')

        then:'download request is added to the database'
            DownloadRequest request = DownloadRequest.read(1)
        and:'contain the correct userId and trackId'
            request.userId == userId
            request.trackId == trackId

        and:'uniqueIdentifer is not blank'
            request.uniqueIdentifier != ''
        and:'ip address is present'
            request.ipAddress == ipAddress
    }
} 
```

及其相关服务如下

```
package supasonic
import com.supajam.net.NetworkUtils
import org.apache.commons.lang.RandomStringUtils

class DownloadRequestService {

    static transactional = true

    def createDownloadRequest(Long trackId,Long userId,String ipAddress) {
        String uniqueCode = RandomStringUtils.random(20, true, true)
        DownloadRequest request = new DownloadRequest(trackId: trackId, userId: userId, ipAddress: ipAddress, uniqueIdentifier: uniqueCode)
        if(request.save(failOnError: true)) {
            return request
        }
        return null
    }
} 
```

我收到此错误：

```
groovy.lang.MissingMethodException: No signature of method: supasonic.DownloadRequest.save() is applicable for argument types: () values: []
Possible solutions: save(), save(boolean), save(java.util.Map), wait(), any(), wait(long)
    at supasonic.DownloadRequestService.createDownloadRequest(DownloadRequestService.groovy:12)
    at supasonic.DownloadRequestServiceSpec.downloadrequest can be added to the database(DownloadRequestServiceSpec.groovy:12) 
```

谁能帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T12:30:34.670

尝试将 @Mock(DownloadRequest) 添加到您的测试类中，如[http://blog.springsource.org/2011/06/07/countdown-to-grails-1-4-unit-testing/](http://blog.springsource.org/2011/06/07/countdown-to-grails-1-4-unit-testing/)中的示例。

# asp.net-mvc-3 - Text templates (as EF 4.x Generator) and validation attributes on pocos?

> ID：10126940
> 
> 赞同：0
> 
> 时间：2012-04-12T15:36:31.997
> 
> 标签：asp.net-mvc-3, entity-framework-4.1, t4

Do we agree that adding validation atibutes just above auto generated POCOs entities (like with EF 4.x Dbcontext Generator template) is meaningless ?

Because each time the tool is ran, attributes are erased.

My question is : Is there a way to maintain both auto generated pocos entities one the one hand, and validation attributes on the other ?

Seems that it would be possible with a code first approach ?

Actually I sarted my project with a database first approach and auto generated my POCOs. Would it be possible to get rid of .tt files, keep generated pocos and use code first approach for managing new fields, validation attributes (and so on ...) ? Will the changes on POCOs update my database tables ?

Thanks a lot for your lights.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T17:31:56.977

If you are truly doing a "code first" approach, that means "the code is the boss". You shouldn't be running code generators repeatedly to update your code-- you should update POCOs directly yourself.

Of course, code-generating POCOs from a db at the start of a project can make sense, save a lot of work. But don't plan to keep doing it - you get the problems you mention.

If you wanted to do a "database first" approach, make changes in the db, and your POCOs will be a secondary thing, regenerated - kind of confusing as to who is "the boss".

So i think it makes sense to (as you say) "keep generated pocos and use code first approach for managing new fields, validation attributes (and so on ...)".

As to "Will the changes on POCOs update my database tables ?" - it shouldn't, unless you have something set to regenerate the db.

Note: i am coming from an NHibernate background, not EF, but the same concepts apply.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T18:08:28.047

You have several problems here. The first is that you're trying to place validation attributes on your data model classes. This implies that you are passing your data objects directly to your views. While that works, it is not the recommended way to do it.

You should instead have View Models that have only the information needed for any given view, and these view models have your validation attributes. You then, in your business logic, map your view models to your data models.

However, if you're bound and determined to use your data models in your views, then you would use what are called "buddy classes" to add validators to metadata classes.

[http://hartzer.wordpress.com/2010/01/26/mvc-buddy-class/](http://hartzer.wordpress.com/2010/01/26/mvc-buddy-class/)

Finally, if you want to go to Code first, you will find that Code First works very differently than Database first. While you could take the generated entities and then map them to Code First mappings, it's much easier to use the Entity Framework Power Tools CTP1 to reverse engineer your database to a code first model, since this will also create your mappings.

# excel - 使用 VBA 在 Excel 2007/2010 中跟踪样式更改

> ID：10126945
> 
> 赞同：0
> 
> 时间：2012-04-12T15:36:42.997
> 
> 标签：excel, vba

我需要跟踪某些工作表中的单元格样式更改。我无法在 Excel 2007/2010 中使用内置跟踪，因为我需要自定义一些东西。我试图通过 Workbook_SheetChange 跟踪样式更改但失败了。当我将单元格从一种样式更改为另一种样式时，它永远不会触发。

是否有任何其他事件可用于跟踪样式更改？或者有什么解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:53:15.080

格式更改不会触发任何事件。

最好的解决方法是监视 Worksheet_SelectionChange 事件。当用户单击一个单元格时，您必须存储对该单元格的引用以及您要监视的所有格式信息。下次触发事件时，您必须回顾他们单击的最后一个单元格，将其当前格式与您保存的格式信息进行比较，这样您就可以检测到更改。

缺点是您只能在他们点击远离他们格式化的单元格后才能检测到更改。

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Static LastRange As Range 'The last range selected'
    'For example, monitor the background color or the cell'
    Static LastColorIndex As Integer

    If LastRange.Cells(1).Interior.ColorIndex <> LastColorIndex Then
        'Do what you do'
    End If

    Set LastRange = Target
    LastColorIndex = Target.Interior.ColorIndex
End Sub 
```

这是最简单的情况。如果他们一次修改整个单元格范围，事情会变得更加复杂。

# magento - Magento 站点数量限制

> ID：10126949
> 
> 赞同：0
> 
> 时间：2012-04-12T15:36:59.520
> 
> 标签：magento

我想在 Magento 中容纳 500 个网站。这样，我就很难知道单个 Magento 实例的站点数量限制。有谁知道？（我知道即使限制可能更高 Magento 上的 500 个站点也很疯狂，但我需要知道限制）

另一方面，拥有 500 个不同的实例会更好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T15:45:22.000

据我所知，一个 Magento 实例中可以拥有的站点数量没有限制。但是 500 会很疯狂，我根本不会推荐它。如果每个网站有 1,000 种产品，即您从一个实例管理 500,000 种产品。从索引管理到目录搜索，一切都将耗费很长时间。一个更好的主意是将站点分成集群，每 15 到 20 个商店有 1 个实例，或者如您所说有 500 个不同的实例。

# firefox - 在 Safari 和 Opera 中应用边框图像时背景图像不显示

> ID：10126950
> 
> 赞同：2
> 
> 时间：2012-04-12T15:37:03.210
> 
> 标签：firefox, safari, background-image, opera, css

我将以下 CSS 类应用到我的网站页脚，以同时显示背景图像和顶部的 3 像素 3 色调边框。

```
.site-footer {
    background-image: url(../img/footer-background.png);
    background-repeat: repeat;
    border-width: 3px 0px 0px;
    padding: 15px 0;
}

.border-image {
    -webkit-border-image: url(../img/footer-border-hr.png) 2 0 0 0 repeat;
       -moz-border-image: url(../img/footer-border-hr.png) 2 0 0 0 repeat;
         -o-border-image: url(../img/footer-border-hr.png) 2 0 0 0 repeat;
            border-image: url(../img/footer-border-hr.png) 2 0 0 0 repeat;
            border-width: 2px 0px 0px 0px;
} 
```

在 Chrome (18) 中很好，但在 Firefox (Mac 10.0.2 和 11) Safari (Mac 版本 5.1.5 (7534.55.3)) 和 Opera (Mac 11.62) 中背景只是纯白色。通过检查元素删除边框图像会恢复背景。我猜边框图像基本上被渲染为背景图像，因此背景被覆盖，但有人知道解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-16T15:51:25.390

您看到的是白色背景，因为大概边框图像的中心部分是白色的，它绘制在背景图像的顶部，并且大多数浏览器在添加关键字之前实现[了](http://www.w3.org/TR/css3-background/#border-image-slice)[实验](http://www.w3.org/TR/css3-background/#border-image-slice)`border-image`版本。[`fill`](http://www.w3.org/TR/css3-background/#border-image-slice)

正如规范所描述的：

> 'fill' 关键字（如果存在）会导致边框图像的中间部分被保留。（默认情况下它被丢弃，即视为空。）

不支持这个 fill 关键字的浏览器（我知道至少 Opera 和 Firefox 不支持，尽管[Firefox 从版本 12 开始支持它](https://developer.mozilla.org/En/CSS/-moz-border-image#border-image-width)）不会丢弃边框图像的中间，而是将其绘制在背景之上.

Since you're using PNGs, you can make sure that the middle piece of your border-image is transparent. That should make the background appear through it.

# python - MEDIA_ROOT MEDIA_URL : 通过 Django 渲染静态服务器页面

> ID：10126955
> 
> 赞同：1
> 
> 时间：2012-04-12T15:37:12.653
> 
> 标签：python, django

我的 settings.py 文件中有以下设置：

```
ROOT_PATH = os.path.dirname(os.path.realpath(__file__))
MEDIA_ROOT = os.path.join(ROOT_PATH,'site_media')
MEDIA_URL = 'http://xx.xxx.xx.xx:yyyy/site_media/'

And in urls.py

urlpatterns += patterns('',
        (r'^site_media/(?P<path>.*)$', 'django.views.static.serve',
        {'document_root': settings.MEDIA_ROOT, 'show_indexes': True}), 
```

在我的网页中：

```
<img border="0" width="120" align="Left" src="/site_media/images/logo.gif"> 
```

我可以在项目路径中看到该文件：

项目/site_media/images/logo.gif

但是当我在 HTML 页面中开始我的项目时，我仍然看不到图像：

```
Prj > python manage.py runserver xx.xxx.xx.xx:yyyy
Validating models...

0 errors found
Django version 1.3.1, using settings 'Prj.settings'
Development server is running at http://xx.xxx.xx.xx:yyyy/
Quit the server with CONTROL-C. 
```

我不确定问题是什么，我该如何解决？

下面是我在 Firebug 中看到的请求/响应标头：

```
GET http://xx.xxx.xx.xx:yyyy/site_media/images/logo.gif

Response Headers
Content-Type    text/html; charset=utf-8
Date    Thu, 12 Apr 2012 17:00:01 GMT
Server  WSGIServer/0.1 Python/2.7.2

Request Headersview source
Accept  image/png,image/*;q=0.8,*/*;q=0.5
Accept-Charset  ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding gzip, deflate
Accept-Language en-us,en;q=0.5
Connection  keep-alive
Host    xx.xxx.xx.xx:yyyy
Referer http://xx.xxx.xx.xx:yyyy/
User-Agent  Mozilla/5.0 (Windows NT 6.1; WOW64; rv:7.0) Gecko/20100101 Firefox/7.0 
```

服务器日志：

```
[12/Apr/2012 09:35:11] "GET /site_media/images/logo.gif HTTP/1.1" 200 122202 
```

请注意，即使 CSS / JS 脚本也没有被加载：

```
GET jquery-1.4.2.js

200 OK xx.xxx.xx.xx:yyyy 119.3 KB xx.xxx.xx.xx:yyyy 6.96s

HeadersResponseCache
Response Headersview source
Content-Type    text/html; charset=utf-8
Date    Thu, 12 Apr 2012 17:00:03 GMT
Server  WSGIServer/0.1 Python/2.7.2

Request Headersview source
Accept  */*
Accept-Charset  ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding gzip, deflate
Accept-Language en-us,en;q=0.5
Connection  keep-alive
Host    xx.xxx.xx.xx:yyyy 
Referer http://xx.xxx.xx.xx:yyyy/
User-Agent  Mozilla/5.0 (Windows NT 6.1; WOW64; rv:7.0) Gecko/20100101 Firefox/7.0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T18:57:39.637

由于您使用的是 Django 1.3.1，而不是 MEDIA_ROOT 和 MEDIA_URL，我建议使用 django.contrib.staticfiles

仔细阅读[本页](https://docs.djangoproject.com/en/dev/howto/static-files/)

在你的情况下，这将是这样的：

* * *

设置.py：

```
STATIC_ROOT = os.path.join(ROOT_PATH,'site_media')
STATIC_URL = '/site_media/'

INSTALLED_APPS = (
    # Your installed apps....
    # ...
    'django.contrib.staticfiles',
)

# Not sure what exact context processors you need, but "static" will be one of them
TEMPLATE_CONTEXT_PROCESSORS = (
    "django.contrib.auth.context_processors.auth",
    "django.core.context_processors.debug",
    "django.core.context_processors.i18n",
    "django.core.context_processors.media",
    "django.core.context_processors.static",
    "django.core.context_processors.request",
    "django.contrib.messages.context_processors.messages",
) 
```

* * *

为了保持管理页面正常工作，在 urls.py

```
# Admin
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('',
    # Admin:
    (r'^admin/', include(admin.site.urls)),

    # Your other url code
) 
```

* * *

然后在您的网页上，您可以输入：

`<img border="0" width="120" align="Left" src="{{ STATIC_URL }}images/logo.gif">`

请记住，您必须使用正确的上下文处理器来呈现您的模板：

```
return render_to_response('my_page.html', locals(),
        context_instance=RequestContext(request)) 
```

# javascript - 使用正则表达式从查询字符串中捕获值？

> ID：10126956
> 
> 赞同：43
> 
> 时间：2012-04-12T15:37:13.230
> 
> 标签：javascript, regex, query-string

我正在尝试选择 in 之后`name=`和之前的内容`&`：

```
"/pages/new?name=J&return_url=/page/new" 
```

到目前为止我有..

```
^name=(.*?). 
```

在这种情况下，我试图返回`J`，但它是动态的，因此它可以包含多个字符、字母或数字。

最终情况将允许我自己对`replace`正则表达式找到的这个动态变量做一个陈述。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-04-12T15:39:29.690

`/name=([^&]*)/`

*   删除`^`and 以 a 结尾`&`

* * *

例子：

```
var str     = "/pages/new?name=J&return_url=/page/new";
var matches = str.match(/name=([^&]*)/);
alert(matches[1]); 
```

* * *

更好的方法是将所有参数分解（使用当前地址的示例）：

```
function getParams (str) {
   var queryString = str || window.location.search || '';
   var keyValPairs = [];
   var params      = {};
   queryString     = queryString.replace(/.*?\?/,"");

   if (queryString.length)
   {
      keyValPairs = queryString.split('&');
      for (pairNum in keyValPairs)
      {
         var key = keyValPairs[pairNum].split('=')[0];
         if (!key.length) continue;
         if (typeof params[key] === 'undefined')
         params[key] = [];
         params[key].push(keyValPairs[pairNum].split('=')[1]);
      }
   }
   return params;
}

var url    = "/pages/new?name=L&return_url=/page/new";
var params = getParams(url);
params['name']; 
```

* * *

## 更新

尽管在任何版本的 IE 中仍然不支持，但[URLSearchParams](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams)提供了一种为其他浏览器检索值的本机方式。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-09-01T16:42:24.267

如果参数后面有散列，则接受的答案包括散列部分。正如@bishoy 在他的功能中所拥有的那样，正确的正则表达式是

```
/name=([^&#]*)/ 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-12-15T16:10:41.747

改进以前的答案：

```
/**
 *
 * @param {string} name
 * @returns {string|null}
 */
function getQueryParam(name) {
  var q = window.location.search.match(new RegExp('[?&]' + name + '=([^&#]*)'));
  return q && q[1];
}

getQueryParam('a'); // returns '1' on page http://domain.com/page.html?a=1&b=2 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-09-12T05:47:40.460

这是完整的功能（针对大写/小写测试和修复）

```
function getParameterByName (name) 
{
    name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS = "[\\?&]" + name.toLowerCase() + "=([^&#]*)";
    var regex = new RegExp(regexS);
    var results = regex.exec(window.location.search.toLowerCase());
    if (results == null)
        return "";
    else
        return decodeURIComponent(results[1].replace(/\+/g, " "));
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-12T15:39:59.050

以下应该有效：

```
\?name=(.*?)& 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-12T15:51:15.463

```
var myname = str.match(/\?name=([^&]+)&/)[1]; 
```

[1] 是因为您显然想要组的值（括号中的正则表达式部分）。

```
var str = "/pages/new?name=reaojr&return_url=/page/new";
var matchobj = str.match(/\?name=([^&]+)&/)[1];
document.writeln(matchobj); // prints 'reaojr' 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-06-19T13:46:22.853

这是一个避免存储变量的单行答案（如果你不能使用 URLSearchParams 因为你仍然支持 IE）

```
(document.location.search.match(/[?&]name=([^&]+)/)||[null,null])[1] 
```

通过`||[null,null]`在括号中添加和包围它，您可以安全地索引数组中的第 1 项，而无需检查 match 是否返回结果。当然，您可以将 [null,null] 替换为您想要的默认值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-27T14:28:46.517

这可能有效：

```
\??(.*=.+)*(&.*=.+)? 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-28T12:06:27.190

**您可以**在 javascript 中使用简单的**.split()**获得相同的结果。

让值 = url.split("name=")[1].split("&")[0];

# javascript - jQuery代码导致内存泄漏

> ID：10126958
> 
> 赞同：1
> 
> 时间：2012-04-12T15:37:15.137
> 
> 标签：javascript, jquery, memory-leaks

以下代码导致内存泄漏（您可以看到这种情况发生的越多，越慢，越慢）。不幸的是，我无法在我的办公室下载 javascript 分析器（我可以，只需几天/几周）。

这是代码，只是下拉菜单的一些简单转换：

```
$(document).ready(function(){
    breadcrumbOver = function () {
        $(this).stop().animate({ backgroundColor: "#3393b5", textIndent: 15 }, 250);
    }
    breadcrumbOut = function () {
        $(this).stop().animate({ backgroundColor: "#738793", textIndent: 0 }, 250);
    }
    $("nav ul li").hover(
      function () {
        $(this).children('ul.child').stop().slideDown('fast').children('li').hover(breadcrumbOver, breadcrumbOut);
      }, 
      function () {
        $(this).children('ul.child').stop().slideUp('fast').unbind(breadcrumbOver, breadcrumbOut);
      }
    );
}); 
```

任何人都可以看到可能发生内存泄漏的位置吗？

编辑：现场示例 - [http://rcnhca.org.uk/sandbox/](http://rcnhca.org.uk/sandbox/)（反复滚动“健康、安全和安保”，然后滚动它的孩子以查看效果，动画 slideDown 有时不会触发，如果你滚入滚出足够快）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T15:45:11.693

问题看起来可能出在您的初始选择器中。它以 under 下的所有标签为目标，`li`其中包括所有子代和孙代。`ul``nav`

```
$("nav ul li") ... 
```

这会导致它为 下的`hover`所有`li`标签添加回调`nav`，然后当您将鼠标悬停时，它会添加另一个`hover`回调。

您可能希望更具体地使用它，例如专门针对直接子代。

```
$("nav>ul>li") 
```

如果您有子类，您还可以使用`:not(.child)`来定位所有非子类。使用`console.log`（内置于 Chrome 或使用 Firebug）来记录这些选择器正在拉动的内容，以确保您得到您期望的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T16:31:49.317

我明白你在谈论乔治；多次打开盒子后在元素之间快速滑动时，效果最为明显。

也许这会影响你所看到的。我继续阅读`stop()`并觉得它可能会对您所看到的产生影响。您可以在其中指定的第一个属性`stop()`是 clearQueue。第二个同样有趣。以下是文档中的说明：

> **clearQueue**一个布尔值，指示是否也删除排队的动画。默认为假。 **jumpToEnd**一个布尔值，指示是否立即完成当前动画。默认为假。

可能值得一试，像这样传递真实：

```
$(this).children('ul.child').stop(true, true)...
// (or  you want the animation to unwind, I suppose)
$(this).children('ul.child').stop(true)... 
```

另外，我也检查了[unbind](http://api.jquery.com/unbind/)，我认为你不能像你一样传递两个事件。也许您可以以这种方式使用它而不会遇到您遇到的问题：

```
...unbind(breadcrumbOver).unbind(breadcrumbOut); 
```

# c# - BouncyCastle 使用文件名中的 Cyrillik（俄语）字母对文件进行加密和签名

> ID：10126959
> 
> 赞同：0
> 
> 时间：2012-04-12T15:37:15.303
> 
> 标签：c#, character-encoding, bouncycastle, sign, pgp

如何在文件名中使用西里尔字母（俄语）对文件进行加密和签名。然后解密并验证签名。请帮助我我无法验证签名异常----“流中的未知对象已保留”

```
 public void VerifySignature(Stream input, string outputpath)
    {
        input = PgpUtilities.GetDecoderStream(input);
        PgpObjectFactory pgpObjF = new PgpObjectFactory(input);            

        PgpEncryptedDataList enc = (PgpEncryptedDataList) pgpObjF.NextPgpObject();

        PgpPrivateKey sKey = null;
        PgpPublicKeyEncryptedData pbe = null;
        PgpSecretKeyRingBundle pgpSec = new PgpSecretKeyRingBundle(PgpUtilities.
            GetDecoderStream(File.OpenRead(m_encryptionKeys.PrivateKeyPathd)));

        foreach (PgpPublicKeyEncryptedData pked in enc.GetEncryptedDataObjects())
        {
            sKey = FindSecretKey(pgpSec, pked.KeyId, m_encryptionKeys.PassPhrase.ToCharArray());

            if (sKey != null)
            {
                pbe = pked;
                break;
            }
        }

        if (sKey == null)
        {
            throw new ArgumentException("secret key for message not found.");
        }

        Stream clear = pbe.GetDataStream(sKey);
        PgpObjectFactory plainFact = new PgpObjectFactory(clear);
        PgpCompressedData cData = (PgpCompressedData)plainFact.NextPgpObject();
        PgpObjectFactory pgpFact = new PgpObjectFactory(cData.GetDataStream());
        PgpObject message = pgpFact.NextPgpObject();

        if (message is PgpOnePassSignatureList)
        {
            PgpOnePassSignatureList p1 = (PgpOnePassSignatureList)message;
            PgpOnePassSignature ops = p1[0];

            PgpLiteralData p2 = (PgpLiteralData)pgpFact.NextPgpObject();
            Stream dIn = p2.GetInputStream();

            PgpPublicKeyRingBundle pgpRing = new PgpPublicKeyRingBundle(PgpUtilities.
                        GetDecoderStream(File.OpenRead(m_encryptionKeys.PublicKeyPathd)));
            PgpPublicKey key = pgpRing.GetPublicKey(ops.KeyId);

            Stream fos = File.Create(p2.FileName);
            ops.InitVerify(key);

            int ch;
            while ((ch = dIn.ReadByte()) >= 0)
            {
                ops.Update((byte)ch);
                fos.WriteByte((byte)ch);
            }
            fos.Close();

            //PgpObject p3 = pgpFact.NextPgpObject();
            //if(p3 is PgpSignature)
            //    throw new PgpException("signature verified.");
            PgpSignatureList p3 = (PgpSignatureList)pgpFact.NextPgpObject();
            PgpSignature firstSig = p3[0];
            if (ops.Verify(firstSig))
            {

                throw new PgpException("signature verified.");
            }
            else
            {

                throw new PgpException("signature verification failed.");
            }

        }

    } 
```

加密类：

```
public class PgpEncrypt
    {

        private PgpEncryptionKeys m_encryptionKeys;

        private const int BufferSize = 0x10000; // should always be power of 2 

        /// <summary>

        /// Instantiate a new PgpEncrypt class with initialized PgpEncryptionKeys.

        /// </summary>

        /// <param name="encryptionKeys"></param>

        /// <exception cref="ArgumentNullException">encryptionKeys is null</exception>

        public PgpEncrypt(PgpEncryptionKeys encryptionKeys)
        {

            if (encryptionKeys == null)

                throw new ArgumentNullException("encryptionKeys", "encryptionKeys is null.");

            m_encryptionKeys = encryptionKeys;

        }

        /// <summary>

        /// Encrypt and sign the file pointed to by unencryptedFileInfo and

        /// write the encrypted content to outputStream.

        /// </summary>

        /// <param name="outputStream">The stream that will contain the

        /// encrypted data when this method returns.</param>

        /// <param name="fileName">FileInfo of the file to encrypt</param>

        public void EncryptAndSign(Stream outputStream, FileInfo unencryptedFileInfo)
        {

            if (outputStream == null)
                throw new ArgumentNullException("outputStream", "outputStream is null.");

            if (unencryptedFileInfo == null)
                throw new ArgumentNullException("unencryptedFileInfo", "unencryptedFileInfo is null.");

            if (!File.Exists(unencryptedFileInfo.FullName))
                throw new ArgumentException("File to encrypt not found.");

            /*string ext = unencryptedFileInfo.Extension;
            File.Move(unencryptedFileInfo.FullName, unencryptedFileInfo.DirectoryName +"\\554"  + ext);*/

            using (Stream encryptedOut = ChainEncryptedOut(outputStream))
            using (Stream compressedOut = ChainCompressedOut(encryptedOut))
            {

                PgpSignatureGenerator signatureGenerator = InitSignatureGenerator(compressedOut);

                using (Stream literalOut = ChainLiteralOut(compressedOut, unencryptedFileInfo))
                using (FileStream inputFile = unencryptedFileInfo.OpenRead())                
                {
                    StreamReader strRdr = new StreamReader(inputFile);
                    Encoding code = strRdr.CurrentEncoding;
                    WriteOutputAndSign(compressedOut, literalOut, inputFile, signatureGenerator);
                }

            }

        }

        public Encoding DetectEncoding(String fileName)
        {
            // open the file with the stream-reader:
            using (StreamReader reader = new StreamReader(fileName, true))
            {

                // return the encoding.
                return reader.CurrentEncoding;
            }
        }

        private static void WriteOutputAndSign( Stream compressedOut,
                                                Stream literalOut,
                                            FileStream inputFile,
                                 PgpSignatureGenerator signatureGenerator){

            int length = 0;
            byte[] buf = new byte[BufferSize];
            while ((length = inputFile.Read(buf, 0, buf.Length)) > 0)
            {
                literalOut.Write(buf, 0, length);
                signatureGenerator.Update(buf, 0, length);
            }

            signatureGenerator.Generate().Encode(compressedOut);
        }

        private Stream ChainEncryptedOut(Stream outputStream)
        {
            PgpEncryptedDataGenerator encryptedDataGenerator;
            encryptedDataGenerator =  new PgpEncryptedDataGenerator(SymmetricKeyAlgorithmTag.TripleDes,new SecureRandom());
            encryptedDataGenerator.AddMethod(m_encryptionKeys.PublicKey);
            return encryptedDataGenerator.Open(outputStream, new byte[BufferSize]);
        }

        private static Stream ChainCompressedOut(Stream encryptedOut)
        {
            PgpCompressedDataGenerator compressedDataGenerator = new PgpCompressedDataGenerator(CompressionAlgorithmTag.Zip);
            return compressedDataGenerator.Open(encryptedOut);
        }

        private static Stream ChainLiteralOut(Stream compressedOut, FileInfo file)
        {
            string fileName = PgpLiteralData.Console;
            PgpLiteralDataGenerator pgpLiteralDataGenerator = new PgpLiteralDataGenerator();
            return pgpLiteralDataGenerator.Open(compressedOut, PgpLiteralData.Binary,file);
        }

        private PgpSignatureGenerator InitSignatureGenerator(Stream compressedOut)
        {
            const bool IsCritical = false;
            const bool IsNested = false;
            PublicKeyAlgorithmTag tag = m_encryptionKeys.SecretKey.PublicKey.Algorithm;
            PgpSignatureGenerator pgpSignatureGenerator = new PgpSignatureGenerator(tag, HashAlgorithmTag.Sha1);
            pgpSignatureGenerator.InitSign(PgpSignature.BinaryDocument, m_encryptionKeys.PrivateKey);

            foreach (string userId in m_encryptionKeys.SecretKey.PublicKey.GetUserIds())
            {
                PgpSignatureSubpacketGenerator subPacketGenerator = new PgpSignatureSubpacketGenerator();
                subPacketGenerator.SetSignerUserId(IsCritical, userId);
                pgpSignatureGenerator.SetHashedSubpackets(subPacketGenerator.Generate());

                // Just the first one!
                break;
            }

            pgpSignatureGenerator.GenerateOnePassVersion(IsNested).Encode(compressedOut);

            return pgpSignatureGenerator;

        }
    } 
```

堆栈跟踪：

```
 at Org.BouncyCastle.Bcpg.OpenPgp.PgpObjectFactory.NextPgpObject()
   at OpenPGPzzz.PgpDecrypt.VerifySignature(Stream input, String outputpath) in E:\repo\PgpDe\OpenPGPzzz\Renaissance.cs:line 302
   at PgpDE.MainWindow.button2_Click(Object sender, RoutedEventArgs e) in E:\repo\PgpDe\PgpDE\MainWindow.xaml.cs:line 68
   at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)
   at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)
   at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)
   at System.Windows.UIElement.RaiseEvent(RoutedEventArgs e)
   at System.Windows.Controls.Primitives.ButtonBase.OnClick()
   at System.Windows.Controls.Button.OnClick()
   at System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp(MouseButtonEventArgs e)
   at System.Windows.UIElement.OnMouseLeftButtonUpThunk(Object sender, MouseButtonEventArgs e)
   at System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)
   at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)
   at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)
   at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)
   at System.Windows.UIElement.ReRaiseEventAs(DependencyObject sender, RoutedEventArgs args, RoutedEvent newEvent)
   at System.Windows.UIElement.OnMouseUpThunk(Object sender, MouseButtonEventArgs e)
   at System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)
   at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)
   at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)
   at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)
   at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)
   at System.Windows.UIElement.RaiseTrustedEvent(RoutedEventArgs args)
   at System.Windows.UIElement.RaiseEvent(RoutedEventArgs args, Boolean trusted)
   at System.Windows.Input.InputManager.ProcessStagingArea()
   at System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)
   at System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport)
   at System.Windows.Interop.HwndMouseInputProvider.ReportInput(IntPtr hwnd, InputMode mode, Int32 timestamp, RawMouseActions actions, Int32 x, Int32 y, Int32 wheel)
   at System.Windows.Interop.HwndMouseInputProvider.FilterMessage(IntPtr hwnd, WindowMessage msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   at System.Windows.Interop.HwndSource.InputFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
   at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)
   at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)
   at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)
   at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG& msg)
   at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)
   at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)
   at System.Windows.Threading.Dispatcher.Run()
   at System.Windows.Application.RunDispatcher(Object ignore)
   at System.Windows.Application.RunInternal(Window window)
   at System.Windows.Application.Run(Window window)
   at System.Windows.Application.Run()
   at PgpDE.App.Main() in E:\repo\PgpDe\PgpDE\obj\x86\Debug\App.g.cs:line 0
   at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T13:55:55.017

问题解决了！我在类 PgpLiteralDataGenerator 中做了一些更改，每件事都以正确的方式进行这是我的更改：

```
public Stream Open(
            Stream      outStr,
            char        format,
            string      name,
            long        length,
            DateTime    modificationTime)
        {
            if (pkOut != null)
                throw new InvalidOperationException("generator already in open state");
            if (outStr == null)
                throw new ArgumentNullException("outStr");

            // Do this first, since it might throw an exception
            long unixMs = DateTimeUtilities.DateTimeToUnixMs(modificationTime);

            byte[] encName = Encoding.GetEncoding(65001).GetBytes(name);

            pkOut = new BcpgOutputStream(outStr, PacketTag.LiteralData,
                length + 2 + encName.Length + 4, oldFormat);

            WriteHeader(pkOut, format, name, unixMs);

            return new WrappedGeneratorStream(this, pkOut);
        } 
```

# maven - 如何让詹金斯将.war文件部署到tomcat6而不是本地主机

> ID：10126960
> 
> 赞同：0
> 
> 时间：2012-04-12T15:37:22.547
> 
> 标签：maven, deployment, jenkins, tomcat6, pom.xml

我有一个 jenkins ci，它可以构建我们的项目并制作一个 .war 文件。但我无法将它部署到詹金斯，我该怎么做？

我的 pom.xml 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>MavenWeb</groupId>
<artifactId>MavenWeb</artifactId>
<packaging>war</packaging>
<version>0.0.1-SNAPSHOT</version>
<description></description>
<distributionManagement>
<repository>
  <uniqueVersion>false</uniqueVersion>
  <id>e-ject.se</id>
  <name>e-ject.se</name>
  <url>http://e-ject.se/MavenWeb</url>
  <layout>default</layout>
</repository>
 </distributionManagement>
<build>
    <plugins>
        <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.3.2</version>
            <configuration>
                <source>1.5</source>
                <target>1.5</target>
            </configuration>
        </plugin>
        <plugin>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.0.1</version>
        </plugin>
        <plugin>
            <groupId>org.apache.tomcat.maven</groupId>
            <artifactId>tomcat6-maven-plugin</artifactId>
            <version>2.0-beta-1</version>
                <configuration>
    <url>http://e-ject.se:8080/manager</url>
    <server>e-ject.se</server>
    <path>/MavenWeb</path>
</configuration>
        </plugin>
    </plugins>
</build>
<dependencies>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
    </dependency>
</dependencies>
</project> 
```

我在网上找到的 settings.xml 中添加了所有信息。我可以使用用户名和密码登录到 e-ject.se:8080/manager/html。

```
<server>
    <id>e-ject.se</id>
    <username>jonathan</username>
    <password>*****</password>
    <filePermissions>664</filePermissions>
    <directoryPermissions>775</directoryPermissions>
    <configuration></configuration>
</server> 
```

我在詹金斯控制台中得到了这个：

```
mavenExecutionResult exceptions not empty
message : Failed to execute goal org.apache.maven.plugins:maven-deploy-plugin:2.5:deploy     (default-deploy) on project MavenWeb: 
Failed to deploy artifacts: Could not transfer artifact   MavenWeb:MavenWeb:war:0.0.1-20120412.150346-1 from/to e-ject.se 
(http://e-ject.se/MavenWeb): Failed to transfer file: http://e-ject.se/MavenWeb/MavenWeb/MavenWeb/0.0.1-SNAPSHOT/MavenWeb-0.0.1-20120412.150346-1.war. 
Return code is: 405 
```

如果我只是在 jenkins 中添加 tomcat:deploy 而不是 deploy

我得到：

```
 mavenExecutionResult exceptions not empty
 message : Failed to execute goal org.codehaus.mojo:tomcat-maven-plugin:1.1:deploy (default-cli)     on project MavenWeb: Cannot invoke Tomcat manager
 cause : Cannot invoke Tomcat manager 
```

然后：

```
Caused by: java.io.IOException: Server returned HTTP response code: 401 for URL:   http://localhost:8080/manager/deploy?path=%2FMavenWeb&war= 
```

有人可以帮我让它工作吗，我已经阅读了大量指南，但我无法让它工作！

尊重乔纳森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-07T13:14:53.203

我意识到我有不止一个詹金斯安装了 maven，而且我之前的安装误导了我！有时，重新开始并正确地做会更好。

# c# - 从代码后面调用命令

> ID：10126968
> 
> 赞同：84
> 
> 时间：2012-04-12T15:37:54.197
> 
> 标签：c#, wpf, xaml, data-binding, command

所以我一直在四处寻找，无法确切地知道如何做到这一点。我正在使用 MVVM 创建用户控件，并希望在“加载”事件上运行命令。我意识到这需要一些代码，但我不太清楚需要什么。该命令位于 ViewModel 中，它被设置为视图的数据上下文，但我不确定如何路由它，因此我可以从加载事件后面的代码中调用它。基本上我想要的是这样的......

```
private void UserControl_Loaded(object sender, RoutedEventArgs e)
{
    //Call command from viewmodel
} 
```

环顾四周，我似乎无法在任何地方找到它的语法。我是否需要先在 xaml 中绑定命令才能引用它？我注意到用户控件中的命令绑定选项不会让您像在按钮之类的东西中那样绑定命令...

```
<UserControl.CommandBindings>
    <CommandBinding Command="{Binding MyCommand}" /> <!-- Throws compile error -->
</UserControl.CommandBindings> 
```

我敢肯定有一种简单的方法可以做到这一点，但我终其一生都无法弄清楚。

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2012-04-12T15:44:01.137

好吧，如果 DataContext 已经设置，你可以转换它并调用命令：

```
var viewModel = (MyViewModel)DataContext;
if (viewModel.MyCommand.CanExecute(null))
    viewModel.MyCommand.Execute(null); 
```

*（根据需要更改参数）*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-12T15:45:46.927

前言：在不了解您的要求的情况下，在加载时从代码隐藏执行命令似乎是一种代码味道。必须有更好的方法，MVVM 方面。

但是，如果你真的需要在后面的代码中这样做，这样的事情可能会起作用（注意：我目前无法对此进行测试）：

```
private void UserControl_Loaded(object sender, RoutedEventArgs e)     
{
    // Get the viewmodel from the DataContext
    MyViewModel vm = this.DataContext as MyViewModel;

    //Call command from viewmodel     
    if ((vm != null) && (vm.MyCommand.CanExecute(null)))
        vm.MyCommand.Execute(null);
} 
```

再次 - 尝试找到更好的方法......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-17T20:30:26.080

我想分享一个更紧凑的解决方案。因为我经常在 ViewModel 中执行命令，所以我厌倦了编写相同的 if 语句。所以我为 ICommand 接口写了一个扩展。

```
using System.Windows.Input;

namespace SharedViewModels.Helpers
{
    public static class ICommandHelper
    {
        public static bool CheckBeginExecute(this ICommand command)
        {
            return CheckBeginExecuteCommand(command);
        }

        public static bool CheckBeginExecuteCommand(ICommand command)
        {
            var canExecute = false;
            lock (command)
            {
                canExecute = command.CanExecute(null);
                if (canExecute)
                {
                    command.Execute(null);
                }
            }

            return canExecute;
        }
    }
} 
```

这就是您在代码中执行命令的方式：

```
((MyViewModel)DataContext).MyCommand.CheckBeginExecute(); 
```

我希望这将加快您的开发速度。:)

PS 不要忘记也包括 ICommandHelper 的命名空间。（在我的情况下，它是 SharedViewModels.Helpers）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-12T15:43:42.977

试试这个：

```
private void UserControl_Loaded(object sender, RoutedEventArgs e)
{
    //Optional - first test if the DataContext is not a MyViewModel
    if( !this.DataContext is MyViewModel) return;
    //Optional - check the CanExecute
    if( !((MyViewModel) this.DataContext).MyCommand.CanExecute(null) ) return;
    //Execute the command
    ((MyViewModel) this.DataContext).MyCommand.Execute(null)
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-07-29T12:04:20.403

要在代码后面调用命令，您可以使用此代码行

例如：调用按钮命令

```
Button.Command?.Execute(Button.CommandParameter); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-29T15:29:32.087

您也可能已将代码嵌入到任何 MessaginCenter.Subscribe 并使用 MessagingCenter 模型。如果您只想从后面的代码中执行某些操作，而不是单击具有 Command 属性的视图按钮，那么它对我来说非常有效。

我希望它可以帮助某人。

# java - 为什么我在这里得到一个空指针异常？

> ID：10126972
> 
> 赞同：0
> 
> 时间：2012-04-12T15:38:10.190
> 
> 标签：java

我正在使用java。这段代码的第二行得到一个空指针异常。

```
double gpa = 0.0;
gpa = grads[index].calculateGPA();
return gpa; 
```

grads 是一组毕业生对象。我已经在 J​​UnitTest 中测试了这个方法，它工作正常。我还测试了calculateGPA()。只有当我运行程序时才会出现错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T15:39:35.413

该错误可能是由以下可能性之一引起的：

1.  `grads`是`null`。
2.  `index`是`null`。
3.  `grads[index]`是`null`。
4.  `calculateGPA()`正在引发空指针异常。

使用您的调试器找出其中的哪一种可能性，然后从那里获取它。

# android - 将项目从 NBAndroid (NetBeans) 迁移到 Eclipse for Android dev

> ID：10126973
> 
> 赞同：1
> 
> 时间：2012-04-12T15:38:11.173
> 
> 标签：android, eclipse, netbeans, eclipse-plugin, project

我有一个 NBAndroid 项目，我花了相当多的时间来处理它，需要转移到 Eclipse。我对 NetBeans 的选择只是一种偏好，但当时我并没有意识到 Eclipse 确实是 Android 开发的最佳方式（因为 Google 的工具都围绕着 Eclipse）。我想知道是否有人有将 NetBeans Android 项目从 NetBeans 迁移到 Eclipse 的经验。关于走另一条路的信息很多，但关于这条路的信息不多。请让我知道您的建议和/或经验。谢谢。

# html - 源代码超过 10k 行的 IE6 性能问题

> ID：10126974
> 
> 赞同：2
> 
> 时间：2012-04-12T15:38:14.293
> 
> 标签：html, css, browser, cross-browser, internet-explorer-6

即使关闭了 javascript，我在 IE6 中也存在很大的性能问题。这很奇怪，因为有时当页面加载时，页眉浮动在页脚旁边，或者幻灯片在内容之上。

我想知道是否有人在 IE6 中遇到相同或类似的问题，如果我将生成的源代码缩小为一行，是否有助于以某种方式在该浏览器中获得加载速度？

- 想提一下它应该与 ie6 兼容，所以请不要发布类似的消息 - 使用现代浏览器。

**问题出在 CSS 内的 MS png 修复程序中。即使我关闭了 javascript，它仍然可以工作，所以当我使用 ms 过滤器删除 css 行以实现 png 透明度时，它开始正常工作。**

感谢任何提交。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:52:21.807

我怀疑删除换行符会以任何明显的方式提高速度。

也就是说，性能问题可能不是由*行数*引起的，而是解析*后*元素/操作的*大小/数量/类型/成本。*

 *处理换行符的实际[词法分析器](http://en.wikipedia.org/wiki/Lexical_analysis)应该在流中看到它们与任何其他字符没有什么不同。取决于确切的上下文“源”意味着换行符在解析器的语义上有一些影响：

1.  CSS：无（忽略嵌入的换行符）
2.  HTML：可能的新文本节点或不同的内容
3.  JavaScript：自动分号插入（或嵌入换行符）

但是，没有理由*不*快速尝试缩小版本以查看它是否有所作为，更重要的是，为了满足您的好奇心；-) 我肯定也会听取其他建议，例如检查页面（一切）为有效性。

快乐编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T21:55:57.163

你还没有指定你的页面包含什么，但我猜你会输出所有 HTML 表的母亲？

我猜这是因为 IE6 在渲染大表时非常慢，特别是在列宽可变的情况下。（后来的 IE 也很慢，但没有 IE6 差）

原因是浏览器会在显示任何内容之前尝试渲染整个表格，并执行大量计算来确定如何渲染它。

这个问题的答案也可能对您有所帮助：[大型 html 表格是否慢？](https://stackoverflow.com/questions/1364213/are-large-html-tables-slow)*

# ruby-on-rails - 我的应用程序中调用的“password=”方法在哪里？

> ID：10126977
> 
> 赞同：0
> 
> 时间：2012-04-12T15:38:29.907
> 
> 标签：ruby-on-rails

[在这](http://ruby.railstutorial.org/chapters/modeling-users?version=3.2#fnref:6.15)一点上，我被困在 Ruby on Rails 教程中。我浏览了[`has_secure_password`](https://github.com/rails/rails/blob/master/activemodel/lib/active_model/secure_password.rb?version=3.2#)类定义，但我无法弄清楚`password=`被调用的方法是在应用程序的哪个部分？我没有在我们教程的任何地方明确调用它，但是当我输入时：

```
User.create{blah blah} 
```

进入 Rails 控制台，它会自动加密密码并将其添加到`password_digest`列中！

由于方法名称的登录，我一直无法谷歌`=`，所以请在这里帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:43:41.530

您的相关行是：

```
@user = User.new(name: "Example User", email: "user@example.com", 
             password: "foobar", password_confirmation: "foobar") 
```

当 ActiveRecord 模型类接收`new`或`create`带有选项散列时，它们会将散列键转换为方法名称并调用`#{method_name}=`新生成的模型。

这允许控制器模式（或反模式，具体取决于您的视图）

```
User.new(params) 
```

# java - Java.nio.files - 复制文件

> ID：10126982
> 
> 赞同：5
> 
> 时间：2012-04-12T15:38:38.513
> 
> 标签：java, file, copying, java.nio.file

谁能告诉我下面的代码我做错了什么。我没有收到任何错误 - 它只是直截了当。

```
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class Main {

    public static void main(String[] args) {
         Path source = Paths.get("C:\\Users\\Public\\Pictures\\SamplePictures");
    Path nwdir = Paths.get("D:\\NetbeansProjects\\CopyingFiles\\copiedImages");

    try{
    Files.copy(source, nwdir);
    }catch (IOException e){
        System.out.println("Unsucessful. What a surprise!");
    }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T15:52:49.507

如果您查看[Files.copy](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#copy%28java.nio.file.Path,%20java.nio.file.Path,%20java.nio.file.CopyOption...%29)的 Javadocs ，您会注意到这一行（添加了重点）：

> 如果文件是一个目录，那么它会在目标位置创建一个空目录（目录中的*条目不会被复制*）。此方法可与 walkFileTree 方法一起使用，以复制目录和目录中的所有条目，或在需要时复制整个文件树。

所以看起来你需要使用那个 walkFileTree 方法。

（正如评论者所说，打印出异常，他们会经常告诉你出了什么问题！）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-06T13:33:49.527

在这里寻找一种 NIO Java7 方法来递归地将目录复制到另一个位置。这可以通过`Files.walkFileTree`另一个答案中提到的 Jon7 来完成。我得到的这个代码是一个简单的目录副本：

```
final Path srcDir, final Path dstDir;
Files.walkFileTree(srcDir, new SimpleFileVisitor<Path>() {
    public FileVisitResult visitFile( Path file, BasicFileAttributes attrs ) throws IOException {
        return copy(file);
    }
    public FileVisitResult preVisitDirectory( Path dir, BasicFileAttributes attrs ) throws IOException {
        return copy(dir);
    }
    private FileVisitResult copy( Path fileOrDir ) throws IOException {
        Files.copy( fileOrDir, dstDir.resolve( srcDir.relativize( fileOrDir ) ) );
        return FileVisitResult.CONTINUE;
    }
}); 
```

有关还处理文件属性和覆盖现有文件的更详细示例，请参阅[http://docs.oracle.com/javase/tutorial/essential/io/examples/Copy.java](http://docs.oracle.com/javase/tutorial/essential/io/examples/Copy.java)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-27T16:49:59.183

这就是我设法将文件从一个位置复制到另一个位置的方式：

```
import java.io.IOException;
import static java.nio.file.StandardCopyOption.*;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class App  {

 public static void main(String[] args)
 {
    Path source = Paths.get("E:/myFile.pdf");
    Path nwdir = Paths.get("F:");
    try
    { 
       Files.copy(source, nwdir.resolve(source.getFileName()), REPLACE_EXISTING);
       System.out.println("File Copied");
    }
    catch(IOException e)
    {
        e.printStackTrace();
    }
 }

} 
```

# python - 在python中展平列表

> ID：10126983
> 
> 赞同：7
> 
> 时间：2012-04-12T15:38:43.357
> 
> 标签：python

我有一个这样的列表：

```
[[(video1,4)], [(video2,5),(video3,8)], [(video1,5)], [(video5, 7), (video6,9)]...] 
```

此列表中的每个项目可能包含一个数据对或一个元组，我想将此列表更改为

```
[(video1,4),(video2,5),(video3,8),(video1,5),(video5,7),(video6,9)...] 
```

然后这样做：

```
for item in list:
    reqs = reqs + item[1]
    b.append(item[0])
c = set(b) 
```

不知道如何更改列表结构，或者如何在原始列表的基础上进行相同的计算？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-12T15:40:52.677

要展平一个级别，您可以使用`itertools.chain.from_iterable()`：

```
flattened_list = itertools.chain.from_iterable(my_list) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-12T15:41:21.850

如果您只想展平列表，只需使用`itertools.chain.from_iterable`：[http ://docs.python.org/library/itertools.html#itertools.chain.from_iterable](http://docs.python.org/library/itertools.html#itertools.chain.from_iterable)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-20T00:08:35.387

列表推导式有一种非常简单的方法。此示例已记录在[此处的 python 文档中](http://docs.python.org/tutorial/datastructures.html)

```
>>> # flatten a list using a listcomp with two 'for'
>>> vec = [[1,2,3], [4,5,6], [7,8,9]]
>>> [num for elem in vec for num in elem]
[1, 2, 3, 4, 5, 6, 7, 8, 9] 
```

这是您想要实施的解决方案。根据您的示例，这是最简单的解决方案

```
In [59]: your_list = [[('video1',4)], [('video2',5),('video3',8)], [('video1',5)], [('video5', 7), ('video6',9)]]

In [60]: improved_list = [num for elem in your_list for num in elem]

In [61]: improved_list
Out[61]: 
[('video1', 4),
 ('video2', 5),
 ('video3', 8),
 ('video1', 5),
 ('video5', 7),
 ('video6', 9)] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-12-17T22:34:42.673

如果此列表是**单嵌套**的（列表列表），您可以这样做，我经常使用**它**：

```
flat_list = sum(list_of_lists, []) 
```

这是因为 sum 只是简单地添加列表，并且添加列表在 python 中按预期工作:)

**注意**：这是低效的，有些人说不可读。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-13T10:02:52.757

这是另一个（没有库）：

```
def plus(a,b): return a + b
reduce(plus, your_list) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-12T15:51:21.777

试试这个：

```
from itertools import chain 

c = set()
reqs = 0
for vid, number in chain(*your_list): 
    c.add(vid)
    reqs += number 
```

另请参阅相关文章[Flattening a shallow list in Python](https://stackoverflow.com/questions/406121/flattening-a-shallow-list-in-python)。

使用`chain.from_iterable(list)`而不是应该有可以忽略不计的性能提升`chain(*list)`，但确实前者看起来更干净。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-04-12T15:55:06.507

从数据结构中提取所有元组...

```
def get_tups(y):
    z = []
    if y:
        for x in y:
            if isinstance(x, tuple):
                z.append(x)
            else:
                z.extend(get_tups(x))
    return z 
```

也许 ...

# php - PHP将条件语句分配给变量？

> ID：10126985
> 
> 赞同：0
> 
> 时间：2012-04-12T15:38:51.123
> 
> 标签：php

我有一个保存表格结构的变量，我想在表格中添加 php 代码。我尝试将代码语句添加到变量中，然后在表中获取变量数据，但我认为这是不可能的，正确的做法是什么。

```
$table='<table border="1" cellspacing="0" cellpadding="0"><tr>
        <td width="638" valign="top">**ADD CODE HERE**</td></tr>
        </table>';
echo $table; 
```

这是我要在列中添加的代码：

```
if($_SESSION['Mmsg']['Mreg-err'])
    {
        echo '<div class="err">'.$_SESSION['Mmsg']['Mreg-err'].'</div>';
        unset($_SESSION['Mmsg']['Mreg-err']);
    }       
if($_SESSION['Mmsg']['Mreg-success'])
    {
        echo '<div class="success">'.$_SESSION['Mmsg']['Mreg-success'].'</div>';
        unset($_SESSION['Mmsg']['Mreg-success']);
    } 
```

我尝试在 $notification 中添加代码，然后添加

```
$notification='if($_SESSION['Mmsg']['Mreg-err'])
    {
    echo '<div class="err">'.$_SESSION['Mmsg']['Mreg-err'].'</div>';
        unset($_SESSION['Mmsg']['Mreg-err']);
    }       
    if($_SESSION['Mmsg']['Mreg-success'])
        {
        echo '<div class="success">'.$_SESSION['Mmsg']['Mreg-success'].'</div>';
        unset($_SESSION['Mmsg']['Mreg-success']);
        }'; 
```

> ' . $通知。'

表内如下：

```
$table='<table border="1" cellspacing="0" cellpadding="0"><tr>
            <td width="638" valign="top">' . $notification . '</td></tr>
            </table>';
echo $table; 
```

但这是不可能的，有没有办法做到这一点？我是新手

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T15:47:00.527

编辑添加了您的未设置...

```
if($_SESSION['Mmsg']['Mreg-err'])
    $notification = '<div class="err">'.$_SESSION['Mmsg']['Mreg-err'].'</div>';
if($_SESSION['Mmsg']['Mreg-success'])
    $notification = '<div class="success">'.$_SESSION['Mmsg']['Mreg-success'].'</div>';

unset($_SESSION['Mmsg']['Mreg-err']);
unset($_SESSION['Mmsg']['Mreg-success']);

$table='<table border="1" cellspacing="0" cellpadding="0"><tr>
        <td width="638" valign="top">' . $notification . '</td></tr>
        </table>';
echo $table; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T15:42:30.960

你能把你想要的内容放到 $notification 变量中吗？

```
 var $notification=""; // is 'var' idiomatic PHP? Not used it much lately.
   if($_SESSION['Mmsg']['Mreg-err'])
     {
       $notification= '<div class="err">'.$_SESSION['Mmsg']['Mreg-err'].'</div>';  
       unset($_SESSION['Mmsg']['Mreg-err']);     
     }
  if($_SESSION['Mmsg']['Mreg-success'])
     {
        $notification = $notification . '<div class="success">'.$_SESSION['Mmsg']['Mreg-success'].'</div>';
         unset($_SESSION['Mmsg']['Mreg-success']);
   } 

  $table='<table border="1" cellspacing="0" cellpadding="0"><tr>             <td width="638" valign="top">' . $notification . '</td></tr>             </table>';     
  echo $table; 
```

然而，有几件事对我来说似乎很奇怪。

首先，为什么要为错误或成功消息设置单独的 Session 变量？为什么没有`$_SESSION['Mmsg']['Mreg-outcome']`？那你就不需要那样切换了。

你还需要`echo`桌子吗？为什么不让您的`$notification`变量可用于页面，然后让表格在页面中执行如下操作：

```
<table><tr><td>$notification</td></tr></table> 
```

最后，除了显示表格数据之外，您最好不要将该表用于其他任何用途，否则您会使小猫哭泣。它看起来很可疑，好像您可能打算将其用于页面格式化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T15:47:13.567

```
<?php
    // snipped code
    $table='<table border="1" cellspacing="0" cellpadding="0"><tr>
           <td width="638" valign="top">' . $notification . '</td></tr>
           </table>'
    echo $table;
    // snipped code
?> 
```

可以这样重写：

```
<?php
    // snipped code
?>
<table border="1" cellspacing="0" cellpadding="0">
    <tr>
        <td width="638" valign="top"><?=$notification?></td>
    </tr>
</table>
<?php
    // snipped code
?> 
```

干净多了，不是吗？

这些`if`语句还具有替代语法，我发现它更容易遵循。

```
<?php
// snipped code
if($_SESSION['Mmsg']['Mreg-err'])
{
echo '<div class="err">'.$_SESSION['Mmsg']['Mreg-err'].'</div>';
    unset($_SESSION['Mmsg']['Mreg-err']);
}       
if($_SESSION['Mmsg']['Mreg-success'])
    {
    echo '<div class="success">'.$_SESSION['Mmsg']['Mreg-success'].'</div>';
    unset($_SESSION['Mmsg']['Mreg-success']);
    }
// snipped code
?> 
```

这可以重写：

```
<?php
// snipped code
?>

<?php if($_SESSION['Mmsg']['Mreg-err']): ?>
    <div class="err"><?=$_SESSION['Mmsg']['Mreg-err']?></div>
    <?php unset($_SESSION['Mmsg']['Mreg-err']); ?>
<?php endif; ?>
<?php if($_SESSION['Mmsg']['Mreg-success']): ?>
    <div class="success"><?=$_SESSION['Mmsg']['Mreg-success']?></div>
    <?php unset($_SESSION['Mmsg']['Mreg-success']); ?>
<?php endif; ?>

<?php
// snipped code
?> 
```

现在，如果出现任何错误，调试和跟踪会容易得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T15:58:49.720

您所做的是完全正确的，只是您没有为通知变量正确分配值。现在应该可以了。

```
 if($_SESSION['Mmsg']['Mreg-err'])
 {
   $notification= '<div class="err">'.$_SESSION['Mmsg']['Mreg-err'].'</div>';  
   unset($_SESSION['Mmsg']['Mreg-err']);     
 }
if($_SESSION['Mmsg']['Mreg-success'])
 {
    $notification = $notification . '<div class="success">'.$_SESSION['Mmsg']['Mreg-success'].'</div>';
     unset($_SESSION['Mmsg']['Mreg-success']);
 } 

$table='<table border="1" cellspacing="0" cellpadding="0"><tr><td width="638" valign="top">' . $notification . '</td></tr></table>';     
echo $table; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T16:08:12.803

你的问题不清楚。我试图猜测你的问题是什么，试试这个：

```
$table='<table border="1" cellspacing="0" cellpadding="0"><tr>
        <td width="638" valign="top">' . htmlentities($notification) . '</td></tr>
        </table>';
echo $table; 
```

看看这是否有效

# asp.net-mvc - 可以使用按钮通过索引视图更新数据吗？

> ID：10126989
> 
> 赞同：1
> 
> 时间：2012-04-12T15:39:08.300
> 
> 标签：asp.net-mvc, asp.net-mvc-3, model, calendar

我正在将我的思维和编程方式从 Webforms 转换为 MVC3。记录在案，这让我很头疼。

所以我正在制作一个具有月视图的日历（页面仅显示该月的日期和事件）。我将两个按钮“上一个”和“下一个”按月放置。在 Webforms 中，任何更改都只会发生在 Calendar.aspx 上。但是，***似乎***我必须制作两个 ActionResults（都是 HttpPost）。一个进入上一个视图，另一个进入下一个视图。只是为了达到同样的效果。我希望只更新 Index ActionResult/View 上的日历，但我不知道该怎么做。我的索引视图如下。

长话短说，有没有办法更新日历并返回索引视图？或者当我点击相应的按钮（上一个和下一个）时，我是否必须制作另外两个视图（上一个和下一个）来显示新月份？

```
@model HTMLMVCCalendar.Models.MonthModel

@{
    ViewBag.Title = "Home Page";
    int month = Model.Month;
    int year = Model.Year;
    int numberOfDays = DateTime.DaysInMonth(year, month);
    int startDay = (int)(Convert.ToDateTime(month + "/1/" + year).DayOfWeek);
    int startCount = 1;
}

<h2>@ViewBag.Message</h2>
<p>
    To learn more about ASP.NET MVC visit <a href="http://asp.net/mvc" title="ASP.NET MVC Website">http://asp.net/mvc</a>.
</p>
<div>  
    <table id="calendar">
        <thead>
            <tr>
                <th id="monthHeader" colspan="7">
                    <h3>
                    @{
                        @Convert.ToDateTime(month + "/1/" + year).ToString("MMMM");
                    }
                    </h3>
                </th>
            </tr>
            <tr>
                <th>Sun</th>
                <th>Mon</th>
                <th>Tues</th>
                <th>Wed</th>
                <th>Thur</th>
                <th>Fri</th>
                <th>Sat</th>
            </tr>
        </thead>
        <tbody>
            <tr>
            @for (int i = 0; i < startDay; ++i)
            {
                @:<td><div><span>&nbsp;</span></div><div><span>&nbsp;</span></div></td>
            }
            @for (int j = startDay; j < ((numberOfDays + startDay) + 1); ++j)
            {
                <td>
                    <div><span>@startCount</span></div>
                    <div>
                        <span>
                            @{
                                var todaysEvents = Model.AllDays.ToList().FindAll(d => d.CalDate.Day == startCount);
                                foreach(HTMLMVCCalendar.Models.CalendarModel eventsToday in todaysEvents)
                                {
                                    foreach(HTMLMVCCalendar.Models.EventModel eventToday in eventsToday.CalEvents)
                                    {
                                        <text>
                                            &nbsp;@eventToday.DayCode:<br />
                                            &nbsp;@eventToday.Subject:<br />
                                            &nbsp;@eventToday.EventDesc<br /><br />
                                        </text>
                                    }                                 
                                }
                            }
                        </span>
                    </div>
                </td>
                            if ((j + 1) % 7 == 0)
                            {
                    @:</tr><tr>
                }
                ++startCount;
            }
            </tr>
        </tbody>
    </table>
    <div>
        <input id="previous" type="submit" value="submit" />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input id="next" type="submit" value="submit" />
    </div> 
</div> 
```

**更新：** 我已经尝试过了，我认为它应该可以工作。不知道为什么没有？

```
 <div>
        @using (Html.BeginForm("Previous", "Home"))
        {
            <input id="previous" type="submit" value="Previous" />
        }
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        @using (Html.BeginForm("Next", "Home"))
        {
            <input id="next" type="submit" value="Next" />
        }
    </div> 

public ActionResult Index()
{
    ViewBag.Message = "Welcome to ASP.NET MVC!";

    int month;
    int year;

    int.TryParse(ViewBag.Year, out year);
    int.TryParse(ViewBag.Month, out month);
    Calendar monthEventsCal = new Calendar();

    HTMLMVCCalendar.Models.MonthModel allMonthEvents = monthEventsCal.monthEvents(year, month);
    return View("Index", allMonthEvents);            
}

[HttpPost]
public ActionResult Previous(HTMLMVCCalendar.Models.MonthModel prevMonth)
{
    Calendar monthEventsCal = new Calendar();
    var newMonth = monthEventsCal.previousMonth(prevMonth.Year, prevMonth.Month);

    ViewBag.Month = newMonth.Item2;
    ViewBag.Year = newMonth.Item1;
    return RedirectToAction("Index");
}

[HttpPost]
public ActionResult Next(HTMLMVCCalendar.Models.MonthModel nextMonth)
{
    Calendar monthEventsCal = new Calendar();
    var newMonth = monthEventsCal.nextMonth(nextMonth.Year, nextMonth.Month);

    ViewBag.Month = newMonth.Item2;
    ViewBag.Year = newMonth.Item1;
    return RedirectToAction("Index");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T17:07:49.493

建议的潜在方法

```
public virtual ActionResult Index(int? month)
{
    int relativeMonth = 0;
    if(month.HasValue)
        relativeMonth = month.Value;

    //Create ViewModel fetching calender data using relativeMonth value.
    //For example if relativeMonth is 0 fetch current month view model.
    //If relative month is -3 fetch calendar data from three months ago.

    if(Request..IsAjaxRequest()) //Optional. If you want ajax.
        return PartialView("Calendar", model);

    return View(model);
} 
```

使用这种方法，您的下一个和上一个按钮现在是链接，其中 Previous 将链接到 relativeMonth - 1 和 next 是 relativeMonth + 1。我认为没有必要让它们发布，因为您实际上并没有提交任何表单数据（使用这个方法我会让下一个和上一个链接的样式像按钮）。

如果您确实想启用 ajax，我会将您的日历视图粘贴在单独的 cshtml 中，并将其作为 index.cshtml 中的部分视图调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T15:45:13.160

有几种方法可以做到这一点，最简单的方法是进行 ajax 调用并使用返回的数据更新您的视图 [http://bob-the-janitor.blogspot.com/2010/12/easy-ajax-with- aspnet-mvc-and-jquery.html](http://bob-the-janitor.blogspot.com/2010/12/easy-ajax-with-aspnet-mvc-and-jquery.html) 如果你想变得花哨，你甚至可以从 ajax 调用返回一个视图并替换你当前的视图，如下所示 [http://bob-the-janitor.blogspot.com/2011/11 /more-ajax-with-mvc-using-partial-views.html](http://bob-the-janitor.blogspot.com/2011/11/more-ajax-with-mvc-using-partial-views.html)