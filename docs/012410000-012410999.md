# StackOverflow 问答 12410000-12410999

# javascript - 了解 Node.js 用例

> ID：12410005
> 
> 赞同：2
> 
> 时间：2012-09-13T15:41:27.287
> 
> 标签：javascript, node.js, backbone.js

试图了解如何将 node.js 用于 Web 应用程序。

基本上有2个主要用例，即：

1.  整个系统是用 node 编写的，所以你有登录、注销、密码恢复以及 web 应用程序所做的任何其他功能。所有这些都是用javascript编写的？

2.  您仅使用 node.js 来发送客户端更新，以对应用程序产生实时影响。但是应用程序的其余部分是用例如 rails 或 django 编写的

如果我理解正确，请告诉我：

在node.js使用的其他技术方面，你倾向于看到人们使用node.js作为后端服务器，客户端使用socket.io建立一个跨浏览器长时间运行的ajax调用库，然后你可能会使用主干.js 用于您的客户端 mvc 模式。

这是正确的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T15:53:59.213

基本上来说，它只是一个在服务器端运行 javascript 代码的工具。你用它做什么取决于你。许多人将它用作补充系统，因为它相对较新，但完全可以使用 node.js 运行独立应用程序。

据说它特别擅长处理并发连接，这就是为什么经常建议在应用程序中处理实时作业的原因，但是对于这个特定的用例来说，没有“义务”使用它，它只是一个你可以做的事情。

与所有事物一样，理解它的最佳方式是使用它，所以不要害怕玩弄它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-07T06:51:32.093

我们在应用程序 Skype 中使用的 Node js 用例，例如使用 node js 在 Chrome 浏览器上进行语音和视频聊天

# c# - 为什么这段代码在win8 rtm中抛出异常，而在win8 rp中却没有？

> ID：12410006
> 
> 赞同：1
> 
> 时间：2012-09-13T15:41:33.757
> 
> 标签：c#, file-io, windows-8, windows-runtime, visual-studio-2012

> 前提条件：Windows 8 Pro RTM + VS2012 Ultimate RTM

1.App.xaml.cs中有以下代码。如果用户第一次打开这个应用程序，应用程序将创建一个 xml。

```
 private async void CheckXML()
    {
        try
        {
            StorageFile file1 = await ApplicationData.Current.LocalFolder.GetFileAsync("BetterTask.xml");
        }
        catch (FileNotFoundException)
        {
            CreateXML();
        }
    }

    private async void CreateXML()
    {
        StorageFile file2 = await ApplicationData.Current.LocalFolder.CreateFileAsync("BetterTask.xml", CreationCollisionOption.ReplaceExisting);
        using (var writeStream1 = await file2.OpenStreamForWriteAsync() as Stream)
        {
            XDocument doc1 = new XDocument(              
                                            new XDeclaration("1.0", "utf-8", "yes"),  
                                            new XElement("tasks", 
                                                new XElement("task",  
                                                    new XElement("title", "Wish you enjoy this App :)"),
                                                    new XElement("due", DateTime.Now.Date.ToString("yyyy/MM/dd")))));
            doc1.Save(writeStream1);
            await writeStream1.FlushAsync();
        }
    } 
```

2.app启动时，在MainPage.xaml中的OnNavigatedTo事件中，会读取xml获取数据。

```
 protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        ReadTasks("all");
        ShowTime();
    }

    private async void ReadTasks(string action)
    {
        StorageFile file1 = await ApplicationData.Current.LocalFolder.GetFileAsync(xmlfilename);
        var ReadStream1 = await file1.OpenStreamForReadAsync() as Stream;
        XDocument doc1 = new XDocument();
        doc1 = XDocument.Load(ReadStream1);
        ReadStream1.Dispose(); 
        .......
     } 
```

.3\. **发生了什么**：当应用程序第一次启动时，以下代码会引发错误：

```
 var ReadStream1 = await file1.OpenStreamForReadAsync() as Stream; 
```

> **错误：** 用户代码未处理 UnauthorizedAccessException 访问被拒绝。（来自 HRESULT 的异常：0x80070005 (E_ACCESSDENIED)）

```
I check the folder, the xml file is created when the error happen. 
```

.4\. **更多**：当我重新打开应用程序时，什么也没有发生，它就像一个魅力。我不知道为什么，该应用程序在 Win8 RP 和 VS 2012 RC 中运行良好。我什么都没改变，但为什么它不能在带有 VC2012 RTM 的 Win8 RTM 中运行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:16:49.510

由于您的第二个代码块使用变量名**xmlfilename**我不知道您是否实际上正在尝试打开同一个文件，但我猜您是。由于在 App.xaml.cs 中创建文件的操作和在 MainPage.xaml.cs 中读取文件的操作都是异步的，因此它们很可能同时发生。解决此问题的最简单方法是使用表示 XML 文件创建的应用程序级任务变量。像这样：

```
Task creatingFile = CheckXML();
createFile.Start(); 
```

**现在，在 MainPage.xaml 文件中，您可以使用createdFile.IsCompleted**（或**IsFaulted**）检查任务是否仍在运行。如果任务完成，那么您可以打开文件。如果任务尚未完成，您可以使用**createFile.ContinueWith(...)**来安排文件在创建后打开。

此外，不要忘记将文件包装在 using 语句中，以确保在您使用完它们后将它们关闭。像这样：

```
using (var ReadStream1 = await file1.OpenStreamForReadAsync() as Stream)
{
...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T23:46:47.093

Jared 关于同时完成这项工作是正确的，但我不太喜欢应用程序范围的任务参考。发生这种情况的原因是因为您不能等待返回 void 的方法。您已将方法标记`CheckXML`为`CreateXML`异步无效。async void 方法是一种“一劳永逸”的方法。您的代码将异步执行它。当您导航到页面时，它会尝试阅读它。

我建议创建一个读取文件的方法，如果文件存在只是读取，则不是先创建然后读取。

选项 1：

```
private async void ReadTasks(string action)
{
    // This is a fire and forget method

    StorageFile file = await GetXmlFile(xmlfilename);

    var ReadStream1 = await file.OpenStreamForReadAsync() as Stream;
    XDocument doc1 = new XDocument();
    doc1 = XDocument.Load(ReadStream1);
    ReadStream1.Dispose(); 
    .......
}

private async Task<StorageFile> GetXmlFile(string xmlfilename)
{
    try
    {
        StorageFile file = await ApplicationData.Current.LocalFolder.GetFileAsync(xmlfilename);
    }
    catch (FileNotFoundException)
    {
        file = await CreateXml(xmlfilename);
    }
    return file;
}

private async Task<StorageFile> CreateXML(string xmlfilename)
{
    StorageFile file = await ApplicationData.Current.LocalFolder.CreateFileAsync(xmlfilename, CreationCollisionOption.ReplaceExisting);
    using (var writeStream1 = await file2.OpenStreamForWriteAsync() as Stream)
    {
        XDocument doc1 = new XDocument(              
                                        new XDeclaration("1.0", "utf-8", "yes"),  
                                        new XElement("tasks", 
                                            new XElement("task",  
                                                new XElement("title", "Wish you enjoy this App :)"),
                                                new XElement("due", DateTime.Now.Date.ToString("yyyy/MM/dd")))));
        doc1.Save(writeStream1);
        await writeStream1.FlushAsync();
    }
    return file;
} 
```

# asp.net-mvc - MVC 文件上传器返回 null

> ID：12410007
> 
> 赞同：0
> 
> 时间：2012-09-13T15:41:34.667
> 
> 标签：asp.net-mvc

我的解决方案基于这篇文章； [http://dotnetslackers.com/articles/aspnet/ASP-NET-MVC-and-File-Uploads.aspx](http://dotnetslackers.com/articles/aspnet/ASP-NET-MVC-and-File-Uploads.aspx)

但是，当我尝试上传图片时，我得到的是 null 而不是文件名。

我的观点是这样的；

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<SHP.Models.HrViewModel>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    Edit Employee
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <fieldset>
    <legend>Add details to the selected employee</legend>
    <p>The photo you select for an employee will appear on MNet.</p>
    <p>The qualifications you add for an employee will appear on their business cards when required.</p>
        <% using (Html.BeginForm("EditEmployee", "HumanResources", FormMethod.Post,
         new{enctype = "multipart/form-data"}))
           {%>
        <%: Html.AntiForgeryToken() %>
        <%: Html.ValidationSummary(true) %>
        <%: Html.EditorFor(model => model.EmployeeSelector) %>
        <% if (Model.SelectedEmployee != null)
           { %>
                <%: Html.HiddenFor(model => model.SelectedEmployee.EmployeeId) %>
                <%: Html.HiddenFor(model => model.EmployeeName) %>
                <table class="groupBorder" style="margin-top:15px; width:617px;">
                <tbody>
                <tr>
                    <th colspan="2">Add Details for <%: Model.EmployeeName %></th>
                </tr>
                <tr>
                    <td style="text-align: right;">
                <%: Html.LabelFor(model => model.SelectedEmployee.Photo)%>
                   </td>                    
                    <td>
                        <input type="file" id="Picture" name="Picture" />
                    </td>
                </tr>
                <tr>
                    <td style="text-align: right;">
                <%: Html.LabelFor(model => model.SelectedEmployee.Qualifications)%>
                   </td>                    
                    <td>
                <%: Html.TextBoxFor(model => model.SelectedEmployee.Qualifications, new {style = "width:500px;"})%>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align: center;padding-top:20px;">
                    <input type="submit" value="Save" id="btnSubmit" /></td>
                </tr>
                </table>
       <% } %>
        <% } %>
        </fieldset>
</asp:Content> 
```

当您单击“保存”按钮时，您将转到此控制器操作；

```
 [HttpPost]
    [Authorize(Roles = "Administrator, HumanResources, ManagerAccounts, ManagerIT")]
    [ValidateAntiForgeryToken]
    [ValidateOnlyIncomingValues]
    public ActionResult EditEmployee(HrViewModel hrvm)
    {
        if (ModelState.IsValid)
        {
            if (hrvm.SelectedEmployee == null
                || hrvm.EmployeeSelector.SearchTextId != hrvm.SelectedEmployee.EmployeeId)
            {
                return this.RedirectToAction(
                    "EditEmployee", new { employeeId = hrvm.EmployeeSelector.SearchTextId });
            }

            if (hrvm.SelectedEmployee.Picture.HasFile())
            {
                var destinationFolder = Server.MapPath("/Users");
                var postedFile = hrvm.SelectedEmployee.Picture;
                var fileName = Path.GetFileName(postedFile.FileName);
                var path = Path.Combine(destinationFolder, fileName);
                postedFile.SaveAs(path);
                hrvm.SelectedEmployee.Photo = path;
            }   

            var emp = Employee.GetEmployee(hrvm.SelectedEmployee.EmployeeId);
            this.TryUpdateModel<IEmployeeHrBindable>(emp, "SelectedEmployee");
            emp.Update();
            this.TempData["Message"] = string.Format(
                "At {0} Details updated for {1}", DateTime.Now.ToString("T"), hrvm.EmployeeName);
            return this.View(hrvm);
        }

        return this.View(new HrViewModel());
    } 
```

那么我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:05:26.223

默认情况下，MVC3 根据视图中输入元素的 Name 属性执行模型绑定。

要获取文件上传数据，请使用 HttpPostedFileBase 类作为 ActionResult 的参数并调用参数“文件”。

```
[HttpPost]
[Authorize(Roles = "Administrator, HumanResources, ManagerAccounts, ManagerIT")]
[ValidateAntiForgeryToken]
[ValidateOnlyIncomingValues]
public ActionResult EditEmployee(HrViewModel hrvm, HttpPostedFileBase file)
{
    if (ModelState.IsValid)
    {
        if (hrvm.SelectedEmployee == null
            || hrvm.EmployeeSelector.SearchTextId != hrvm.SelectedEmployee.EmployeeId)
        {
            return this.RedirectToAction(
                "EditEmployee", new { employeeId = hrvm.EmployeeSelector.SearchTextId });
        }
        if (file.ContentLength > 0)
        {
            hrvm.SelectedEmployee.Picture = file;
            var destinationFolder = Server.MapPath("/Users");
            var postedFile = hrvm.SelectedEmployee.Picture;
            var fileName = Path.GetFileName(postedFile.FileName);
            var path = Path.Combine(destinationFolder, fileName);
            postedFile.SaveAs(path);
            hrvm.SelectedEmployee.Photo = path;
        }   

        var emp = Employee.GetEmployee(hrvm.SelectedEmployee.EmployeeId);
        this.TryUpdateModel<IEmployeeHrBindable>(emp, "SelectedEmployee");
        emp.Update();
        this.TempData["Message"] = string.Format(
            "At {0} Details updated for {1}", DateTime.Now.ToString("T"), hrvm.EmployeeName);
        return this.View(hrvm);
    }

    return this.View(new HrViewModel());
} 
```

（因此，如果您*可以*使用模型绑定来获取图像数据，它将位于 hrvm.Picture 而不是 hrvm.SelectedEmployee.Picture）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:47:47.793

在您的视图中，请改用以下内容，默认模型绑定应该可以工作：

```
<%: Html.TextBoxFor(model => model.SelectedEmployee.Photo, new { type = "file" }) %> 
```

那是假设`SelectedEmployee.Photo`是 type `HttpPostedFileBase`。

它目前不起作用的原因是默认模型绑定器将尝试直接在模型上查找名为 Picture 的属性，因为这是您的文件输入的名称。它不会找到它，因为 Picture 是 SelectedEmployee 的属性。

将其更改为我上面建议的内容会为标记中的文件输入生成正确的 id 和名称，因此在回发时具有正确的路径。这意味着默认模型绑定器能够在表单发布值和属性之间进行映射。

# android - Android EditText 文本颜色在键入时自动更改

> ID：12410008
> 
> 赞同：3
> 
> 时间：2012-09-13T15:41:35.697
> 
> 标签：android, android-layout

在输入 EditText 时，文本颜色自动从黑色变为白色，最初我将文本颜色设置为白色并将提示颜色设置为白色，但是在测试它时，它显示在开始时输入黑色但在中间或达到随机数量的字符，它变成白色文本。它在三星 Galaxy Gio、Nexus One 和不同的模拟器上运行良好，但在 HTC Evo 3G 和其他一些设备上，它表现出这种行为！我尝试通过将样式设置为正常，将文本颜色设置为白色，将提示颜色设置为白色以及其他与焦点相关的内容来进行修复，所有内容都设置为白色，但在某些设备上它仍然显示行为并在中间继续改变颜色打字。请让我知道是否有人熟悉此问题并解决了此类问题。

这是演示该问题的视频。 [http://youtu.be/1dydBvZnSHI](http://youtu.be/1dydBvZnSHI)

这是我的这个 EditText 的 xml

```
 <EditText
                android:id="@+id/email_edittext"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_centerVertical="true"
                android:layout_marginRight="15dp"
                android:layout_marginTop="5dp"
                android:layout_toRightOf="@+id/textView2"
                android:background="@drawable/share_email_bg"
                android:ems="10"
                android:lines="1"
                android:maxLines="1"
                android:padding="5dip"
                android:singleLine="true"
                android:textColor="#ffffff"
                android:textColorHint="#ffffff" 
                android:inputType="textEmailAddress"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T07:31:51.977

好吧，我正在回答这个问题，因为有些人可能会从中受益。实际上我在我的一个设备中遇到了同样的问题，经过长时间的努力，我发现这是一个非常愚蠢的错误。

为了解决这个问题，我们只需要在`<EditText>`节点中添加一个属性。这是解决方案：

```
<EditText
     android:textColor="@android:color/black"
     ..........
/> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-03-03T23:28:11.587

利用：

```
android:textColorHighlight="@android:color/black" 
```

在 textEdit 中，如果您在编辑时参考编辑文本向下行更改颜色，则需要将颜色设置为：

```
android:backgroundTint="@color/colorPrimaryDark" 
```

# cordova - phonegap：存储数据直到检测到网络

> ID：12410010
> 
> 赞同：3
> 
> 时间：2012-09-13T15:41:39.253
> 
> 标签：cordova, local-storage, internet-connection

我正在编写一个应用程序，它允许用户在几个表单字段中描述一些东西，然后给它拍照。数据和照片保存在我们的服务器上，因此可以随时随地实时查看。如果没有网络连接，我可以在本地存储数据，直到再次检测到连接？一旦检测到网络连接，我可以在后台将数据发布到服务器吗？

在我看来，可能有一个明显的解决方案（插件、线程、论坛），但如果有，它就会避开我。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:48:30.267

您需要收听[在线](http://docs.phonegap.com/en/2.0.0/cordova_events_events.md.html#online)和[离线](http://docs.phonegap.com/en/2.0.0/cordova_events_events.md.html#offline)事件。如果你得到一个离线事件旅行一个标志，那么你知道你需要开始在本地存储你的数据。然后，当您获得在线活动时，您可以与您的服务器同步。

# ruby-on-rails - Rails 3\. 如果全部留空，则不要验证嵌套属性

> ID：12410011
> 
> 赞同：2
> 
> 时间：2012-09-13T15:41:43.090
> 
> 标签：ruby-on-rails, ruby

我有一个带有嵌套属性的表单。我正在为学生注册一所学校，该学生可以有许多紧急联系人。

```
class EmergencyContact < ActiveRecord::Base
  attr_accessible :full_name, :relationship, :mobile_phone, :student_id
  belongs_to :student

  validates :full_name, :presence => true
  validates :relationship, :presence => true

end 
```

所以我有一个表格来注册学生，然后 3 行输入紧急联系人。类似于以下（当然这是一个过于简化的版本......

```
Student Name: _____________

Emergency Contacts
------------------------------------------
| Name         | Relationship             |
------------------------------------------
|              |                          |
------------------------------------------
|              |                          |
------------------------------------------
|              |                          |
------------------------------------------ 
```

如果我只输入 2 个紧急联系人，那么我会收到紧急联系人姓名不能为空的验证错误。**如果该特定紧急联系人的表格中的所有字段都是空白的，我怎样才能使它不验证？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-13T15:59:54.557

我假设您已经在 Student 模型中设置了 accept_nested_attributes 。您需要添加一个 :reject_if 过程。如果 proc 评估为 true，它将忽略该行。

```
class Student < ActiveRecord::Base 
  has_many                      :emergency_contacts
  accepts_nested_attributes_for :emergency_contacts, 
                                :reject_if => lambda { |a| a[:full_name].blank? }
end 
```

您可以`lambda { |a| a[:name].blank? && a[:relationship].blank? }`根据需要将其修改为 等。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-21T09:32:22.743

您还可以将其修改为更通用的内容，例如

```
proc { |attributes| 
    attributes.delete :_destroy
    attributes.reject { |key, value| value.blank? }.empty?
} 
```

**编辑**

您也可以以最简单的方式执行此操作

```
accepts_nested_attributes_for :emergency_contacts, :reject_if => :all_blank 
```

你可以在这里找到一些文档：http: [//api.rubyonrails.org](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html#method-i-accepts_nested_attributes_for)

# go - 尝试将键盘输入写入Golang中的文件

> ID：12410014
> 
> 赞同：7
> 
> 时间：2012-09-13T15:42:00.923
> 
> 标签：go

我正在尝试从键盘获取输入，然后将其存储在文本文件中，但我对如何实际操作有点困惑。

我目前的代码如下：

```
// reads the file txt.txt 
bs, err := ioutil.ReadFile("text.txt")
if err != nil {
      panic(err)
}

// Prints out content
textInFile := string(bs)
fmt.Println(textInFile)

// Standard input from keyboard
var userInput string
fmt.Scanln(&userInput)

//Now I want to write input back to file text.txt
//func WriteFile(filename string, data []byte, perm os.FileMode) error

inputData := make([]byte, len(userInput))

err := ioutil.WriteFile("text.txt", inputData, ) 
```

“os”和“io”包中有很多功能。我很困惑我实际上应该使用哪一个来达到这个目的。

我也对 WriteFile 函数中的第三个参数应该是什么感到困惑。在文档中说“perm os.FileMode”类型，但由于我是编程新手，所以我有点无能为力。

有人对如何处理有任何提示吗？在此先感谢，玛丽

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:30:00.950

例如，

```
package main

import (
    "fmt"
    "io/ioutil"
    "os"
)

func main() {
    fname := "text.txt"

    // print text file
    textin, err := ioutil.ReadFile(fname)
    if err == nil {
        fmt.Println(string(textin))
    }

    // append text to file
    f, err := os.OpenFile(fname, os.O_CREATE|os.O_APPEND|os.O_WRONLY, 0666)
    if err != nil {
        panic(err)
    }
    var textout string
    fmt.Scanln(&textout)
    _, err = f.Write([]byte(textout))
    if err != nil {
        panic(err)
    }
    f.Close()

    // print text file
    textin, err = ioutil.ReadFile(fname)
    if err != nil {
        panic(err)
    }
    fmt.Println(string(textin))
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T16:55:26.487

```
// reads the file txt.txt 
bs, err := ioutil.ReadFile("text.txt")
if err != nil { //may want logic to create the file if it doesn't exist
      panic(err)
}

var userInput []string

var err error = nil
var n int
//read in multiple lines from user input
//until user enters the EOF char
for ln := ""; err == nil; n, err = fmt.Scanln(ln) {
    if n > 0 {  //we actually read something into the string
        userInput = append(userInput, ln)
    } //if we didn't read anything, err is probably set
}

//open the file to append to it
//0666 corresponds to unix perms rw-rw-rw-,
//which means anyone can read or write it
out, err := os.OpenFile("text.txt", os.O_APPEND, 0666)
defer out.Close() //we'll close this file as we leave scope, no matter what

if err != nil { //assuming the file didn't somehow break
    //write each of the user input lines followed by a newline
    for _, outLn := range userInput {
        io.WriteString(out, outLn+"\n")
    }
} 
```

我已经确保它在 play.golang.org 上编译和运行，但我不在我的开发机器上，所以我无法验证它是否完全正确地与 Stdin 和文件交互。不过，这应该可以帮助您入门。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T19:18:55.520

如果您只是想将用户的输入附加到文本文件中，您可以像您已经完成的那样读取输入并使用`ioutil.WriteFile`，就像您尝试做的那样。所以你已经有了正确的想法。

为了顺利进行，简化的解决方案是：

```
// Read old text
current, err := ioutil.ReadFile("text.txt")

// Standard input from keyboard
var userInput string
fmt.Scanln(&userInput)

// Append the new input to the old using builtin `append`
newContent := append(current, []byte(userInput)...)

// Now write the input back to file text.txt
err = ioutil.WriteFile("text.txt", newContent, 0666) 
```

的最后一个参数`WriteFile`是一个标志，它指定文件的各种选项。高位是文件类型（`os.ModeDir`例如）等选项，低位表示 UNIX 权限形式的权限（`0666`八进制格式，代表用户 rw、组 rw、其他 rw）。有关更多详细信息，请参阅[文档](http://golang.org/pkg/os/#FileMode)。

现在您的代码有效，我们可以改进它。例如，通过保持文件打开而不是打开两次：

```
// Open the file for read and write (O_RDRW), append to it if it has
// content, create it if it does not exit, use 0666 for permissions
// on creation.
file, err := os.OpenFile("text.txt", os.O_RDWR|os.O_APPEND|os.O_CREATE, 0666)

// Close the file when the surrounding function exists
defer file.Close()

// Read old content
current, err := ioutil.ReadAll(file)

// Do something with that old content, for example, print it
fmt.Println(string(current))

// Standard input from keyboard
var userInput string
fmt.Scanln(&userInput)

// Now write the input back to file text.txt
_, err = file.WriteString(userInput) 
```

`os.O_APPEND`这里的神奇之处在于，您在打开文件时使用标志，这会产生`file.WriteString()`追加。请注意，您需要在打开文件后关闭文件，我们在函数存在后使用`defer`关键字执行此操作。

# c++ - 为什么在超出数组末尾写入时不会出现分段错误？

> ID：12410016
> 
> 赞同：7
> 
> 时间：2012-09-13T15:42:19.020
> 
> 标签：c++, segmentation-fault

为什么我编译时没有给出错误？

```
#include <iostream>
using namespace std;

int main()
{
    int *a = new int[2];
    // int a[2]; // even this is not giving error
    a[0] = 0;
    a[1] = 1;
    a[2] = 2;
    a[3] = 3;
    a[100] = 4;
    int b;

    return 0;
} 
```

有人可以解释为什么会这样。提前致谢。）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-13T15:43:04.533

因为未定义的行为 == 任何事情都可能发生。你很不幸它没有崩溃，这种行为可能会隐藏错误。

至于`a`被定义两次 - 这是编译器中的一个错误。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-13T15:53:46.533

声明两个被调用的变量`a`肯定是错误的；如果你的编译器接受了，那么它就坏了。我假设您的意思是，如果您将一个声明替换为另一个声明，您仍然不会收到错误消息。

数组访问没有范围检查。在编译时，数组的大小通常是未知的，即使知道，语言也不需要检查。在运行时，检查会降低性能，这违背了不为不需要的东西付费的 C++ 理念。因此，超出数组末尾的访问会产生未定义的行为，程序员需要确保它不会发生。

有时，无效访问会导致分段错误，但这并不能保证。通常，内存保护仅适用于整个内存页面，典型的页面大小为几千字节。有效内存页面内的任何访问都不会被捕获。您访问的内存很有可能包含一些其他程序变量或调用堆栈的一部分，因此在那里写入可能会以您可以想象的任何方式影响程序的行为。

如果你想安全，你可以使用, 并且只能使用它的函数`std::vector`访问它的元素。`at()`这将检查索引，如果超出范围则抛出异常。它还将为您管理内存分配，修复示例中的内存泄漏。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-13T16:45:11.320

我猜你来自 Java 或类似 Java 的语言，一旦你走出数组的边界，就会得到“数组索引越界”异常。

好吧，C 对你有更多的期望；它节省了您要求的空间，但它不会检查您是否超出了所节省空间的边界。一旦你按照上面提到的那样做，程序就会出现可怕的未定义行为。

请记住，如果您的程序中存在错误并且您似乎无法找到它，并且当您检查代码/调试它时，一切似乎都很好，那么您很有可能会“出局” bounds”并访问一个未分配的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T17:26:24.673

具有良好代码分析的编译器肯定会警告该代码引用超出您的数组分配。忘记多个 a 声明，如果您运行它，它可能会或可能不会出错（正如其他人所说的未定义行为）。例如，如果你有一个 4KB 的堆页面（在处理器地址空间中），如果你不在那个页面之外写，你就不会从处理器那里得到错误。删除数组后，如果您已经删除了，并且根据堆实现，堆可能会检测到它已损坏。

# asp.net - 实体框架 - 历史表

> ID：12410017
> 
> 赞同：1
> 
> 时间：2012-09-13T15:42:22.590
> 
> 标签：asp.net, sql-server, entity-framework, history

我在 SQL Server 数据库中定义了以下 2 个表：

```
create table Project
(
Id int,
Name varchar(100)
IdIdentity int
)

create table ProjectHistory
(
Id int,
Name varchar(100)
IdIdentity int,
DtChange datetime
) 
```

当我更新“项目”时，我想将新记录插入到表中`ProjectHistory`，并设置`DtChange`为实际日期。

我使用实体框架 4.1。你能给我一些方法来实现这一点吗？保存更改时可能会生成实体框架的更改 sql。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T15:44:10.037

传统的方法是`update trigger`在项目表上使用一个。

```
CREATE TRIGGER trgProjectUpdate
   ON  Project
   AFTER UPDATE
AS 
BEGIN
    insert ProjectHistory (id, name, dtchange)
    select id, name, GETDATE() from deleted
END 
```

# jquery - 无法为元素设置 .data()

> ID：12410019
> 
> 赞同：0
> 
> 时间：2012-09-13T15:42:31.537
> 
> 标签：jquery, element

我无法将数据添加到动态添加的元素：

```
var newItem = "<li>" + poi.Title + "</li>";
$(newItem).data('poiID', poi.ID);
$(newItem).data('poiTitle', poi.Title); 
```

我试图添加这个：

```
alert($(newItem).data('poiID')); 
```

就在上述行之后，但我不断得到“未定义”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T15:45:54.077

像这样更改您的代码：

```
var newItem = $("<li>" + poi.Title + "</li>");
newItem.data('poiID', poi.ID);
newItem.data('poiTitle', poi.Title);

...

alert(newItem.data('poiID')); 
```

小提琴示例：http: [//jsfiddle.net/P4HWb/](http://jsfiddle.net/P4HWb/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T15:44:39.693

那是因为每次你都`$(newItem)`在创建一个新元素，而实际上并没有存储对它的引用。

尝试：

```
var newItem = $("<li>" + poi.Title + "</li>");  /* create element as newItem */
newItem.data('poiID', poi.ID);                  /* add data to existing elem */
alert(newItem.data('poiID'));                   /* peek at your data */ 
```

请注意，此时您的新元素尚未附加到您的 DOM。要将其显示在页面上，您需要使用、等`newItem`方法进行附加。`append()``prepend()`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-13T15:44:13.683

你`newItem`还没有在 DOM 中。附加它，然后您可以添加`.data()`到它。

或者你可以做这样的事情。

```
var newItem = $("<li>" + poi.Title + "</li>");
$(newItem).data('poi', poi); //That way the whole object is added to the element. 
```

然后将其附加到 DOM。

# android - 方向锁定

> ID：12410023
> 
> 赞同：1
> 
> 时间：2012-09-13T15:42:41.557
> 
> 标签：android

如何防止我的应用程序表单旋转。我想要它，所以如果用户处于纵向模式，则应用程序将始终处于纵向模式，如果他们以横向启动应用程序，则应用程序将始终处于横向模式（直到应用程序关闭并重新启动）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T15:43:54.233

```
public static void lockOrientation(Activity a) {
    if (a.getResources().getConfiguration().orientation == Configuration.ORIENTATION_PORTRAIT) {
        a.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
    } else {
        a.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
    }
}

public static void unlockOrientation(Activity a) {
    a.setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED);
} 
```

# asp.net - Webproject 可以控制网站吗

> ID：12410029
> 
> 赞同：1
> 
> 时间：2012-09-13T15:42:54.507
> 
> 标签：asp.net

我正在开发基于 Web 的解决方案，以替换我们提供的应用程序。Web 应用程序是一个记录存储应用程序，每个客户端将有不同的表单，他们将数据输入和存储。我的问题是：是否有可能创建一个主干 Web 项目，它的更新最少更新更频繁。

任何支持或反对这一点的建设性意见以及理由也将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:12:52.597

如果您想对该术语进行一些研究，听起来您所描述的是一个多租户系统。您的 Web 界面对所有人都保持不变，但每个客户的记录/文档都不同。听起来您可能需要将记录与客户端 ID（可能存储在数据库中）相关联的登录/访问功能。根据您打算如何存储记录（文件系统与数据库），您可以根据客户端 ID（文档表的外键）或您可能想要创建角色来控制访问。这是根据规格可能变得复杂的非常高的概述。

# php - 如何从 Rss Fedd 获取类别

> ID：12410030
> 
> 赞同：0
> 
> 时间：2012-09-13T15:42:54.100
> 
> 标签：php, rss

```
<title>demo title</title>
<guid isPermaLink="false">demo link</guid>
<link>demo link 2</link>
<description>demo description</description>
<category><![CDATA[category]]></category>
<dc:creator>demouser</dc:creator>
<pubDate>timestamp</pubDate> 
```

我想从上面的 Rss 中获取类别字段我已经从那个 RSS 中获得了所有内容，我尝试过的唯一类别没有出现，`print_r`但类别没有在数组中打印

任何人都可以告诉我如何获得该类别值吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T15:49:08.837

尝试使用 simple_xml_load 函数。

```
$xml = simple_xml_load("http://host");
print_r($xml);
echo $xml->category; 
```

# ios - iOS 6 旋转：supportedInterfaceOrientations 不起作用？

> ID：12410031
> 
> 赞同：36
> 
> 时间：2012-09-13T15:42:56.657
> 
> 标签：ios, rotation, ios6, screen-rotation

我在使用 iOS 6 SDK 时遇到了这个问题：我有一些应该允许旋转的视图（例如视频视图），而有些则不允许。现在我知道我必须检查应用程序的 Info.plist 中的所有方向，然后在每个 ViewController 中进行排序，应该发生什么。但它不起作用！应用程序始终旋转到 Info.plist 中给出的方向。

信息列表：

```
<key>UISupportedInterfaceOrientations</key>
    <array>
        <string>UIInterfaceOrientationPortrait</string>
        <string>UIInterfaceOrientationLandscapeLeft</string>
        <string>UIInterfaceOrientationLandscapeRight</string>
    </array> 
```

任何不应被允许旋转的 ViewController：

```
//deprecated
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (NSUInteger)supportedInterfaceOrientations{
return UIInterfaceOrientationMaskPortrait;
} 
```

观察：应用旋转到横向和纵向。任何想法为什么或我做错了什么？

干杯，马克

编辑：我的最新发现还表明，如果您想在应用程序中的某个位置进行旋转，则*必须*在项目设置或 Info.plist 中激活所有四个旋转方向。对此的替代方法是覆盖

```
- (NSUInteger)application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window 
```

在您的 AppDelegate 中，它会覆盖 Info.plist。不再可能在 Info.plist 中仅设置 Portrait，然后通过覆盖 shouldAutorotateToInterfaceOrientation 或 supportedInterfaceOrientations 在某些 ViewController 中进行旋转。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-13T17:27:39.897

如果您的 ViewController 是 UINavigationController 或 UITabBarController 的子级，那么问题就是父级。您可能需要对该父视图控制器进行子类化，只需覆盖您在问题中显示的那些 InterfaceOrientation 方法

编辑：

仅纵向 TabBarController 的示例

```
 @interface MyTabBarController : UITabBarController
            {
            }
            @end

            @implementation MyTabBarController

            // put your shouldAutorotateToInterfaceOrientation and other overrides here        
            - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
                return (interfaceOrientation == UIInterfaceOrientationPortrait);
            }

            - (NSUInteger)supportedInterfaceOrientations{ 
                return UIInterfaceOrientationMaskPortrait; 
            } 

        @end 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-09-20T06:31:08.177

添加到上面 CSmith 的答案中，UINavigationController 子类中的以下代码允许以我最初期望的方式委托给顶视图控制器：

```
- (BOOL)shouldAutorotate;
{
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations
{
    if ([[self topViewController] respondsToSelector:@selector(supportedInterfaceOrientations)])
        return [[self topViewController] supportedInterfaceOrientations];
    else
        return [super supportedInterfaceOrientations];
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-19T12:21:17.090

这是 CSmith 方法的另一种选择。

如果您想复制 iOS 6 之前的行为，即导航堆栈/选项卡栏中的所有视图必须就一组允许的方向达成一致，请将其放在您的子类中`UITabBarController`or `UINavigationController`：

```
- (NSUInteger)supportedInterfaceOrientations
{
    NSUInteger orientations = [super supportedInterfaceOrientations];

    for (UIViewController *controller in self.viewControllers)
        orientations = orientations & [controller supportedInterfaceOrientations];

    return orientations;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-04T08:14:51.830

尝试添加此类别：

```
@interface UINavigationController(InterfaceOrientation)

@end

@implementation UINavigationController(InterfaceOrientation)

- (NSUInteger) supportedInterfaceOrientations {
    if (self.viewControllers.count > 0)
        return [[self.viewControllers objectAtIndex:0] supportedInterfaceOrientations];
    else
        return UIInterfaceOrientationMaskAll;
}

@end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-07T19:12:34.993

对于使用 UINavigationController 和 Swift 的人，您可以将此扩展添加到您的项目中。之后，导航控制器将控制权委托给它们的子控制器。

```
extension UINavigationController {
    override public func supportedInterfaceOrientations()
    -> UIInterfaceOrientationMask {
        if let ctrl = topViewController {
            return ctrl.supportedInterfaceOrientations()
        }
        return super.supportedInterfaceOrientations()
    }

    override public func shouldAutorotate() -> Bool {
        if let ctrl = topViewController {
            return ctrl.shouldAutorotate()
        }
        return super.shouldAutorotate()
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-12T19:57:00.227

对@CSmith 和@EvanSchoenberg 的进一步补充。

如果您有一些可以旋转的视图，而另一些不能旋转的视图，则必须创建一个自定义实例`UITabBarController`，但仍让每个视图自行`UIViewController`决定。

```
- (BOOL)shouldAutorotate;
{
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations
{
    UIViewController * top;
    UIViewController * tab = self.selectedViewController;
    if([tab isKindOfClass:
        ([UINavigationController class])]) {
        top = [((UINavigationController *)tab)
                 topViewController];
    }

    if ([top respondsToSelector:@selector(supportedInterfaceOrientations)])
        return [top supportedInterfaceOrientations];
    else
        return [super supportedInterfaceOrientations];
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-11T12:36:37.067

@Alvivi 为**Swift 4**更新了答案。

```
extension UINavigationController {

    // Look for the supportedInterfaceOrientations of the topViewController
    // Otherwise, viewController will rotate irrespective of the value returned by the ViewController
    override open var supportedInterfaceOrientations: UIInterfaceOrientationMask {
        if let ctrl = self.topViewController {
            return ctrl.supportedInterfaceOrientations
        }
        return super.supportedInterfaceOrientations
    }

    // Look for the shouldAutorotate of the topViewController
    // Otherwise, viewController will rotate irrespective of the value returned by the ViewController
    override open var shouldAutorotate: Bool {
        if let ctrl = self.topViewController {
            return ctrl.shouldAutorotate
        }
        return super.shouldAutorotate
    }
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-05-21T20:15:05.687

@Shimanski Artem 的回答很好，但我认为使用最顶层（当前可见）的控制器是更好的解决方案：

```
@interface UINavigationController(InterfaceOrientation)

@end

@implementation UINavigationController(InterfaceOrientation)

- (NSUInteger) supportedInterfaceOrientations {
    if (self.viewControllers.count > 0){
        return [[self.viewControllers objectAtIndex:[self.viewControllers count] - 1] supportedInterfaceOrientations];
    }
    return UIInterfaceOrientationMaskAll;
}

@end 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2012-09-19T17:35:39.037

作为替代选项，如果您想在应用中保留 iOS6 之前的旋转功能：

这是 github 上的一些有用代码，它调整了 iOS6 的方法调用，以便旋转像在 iOS4/iOS4 上一样工作。这真的帮助了我，因为我支持一个真正微观管理其轮换的遗留应用程序。实现 iOS6 所需的更改将是大量工作。感谢发布它的用户。

[https://gist.github.com/3725118](https://gist.github.com/3725118)

# php - 动态 XHTML 验证（PHP 输出）

> ID：12410033
> 
> 赞同：1
> 
> 时间：2012-09-13T15:42:58.057
> 
> 标签：php, validation, xhtml

鉴于我有一个任意复杂的 php 脚本，在 apache2 网络服务器上运行，我想检查这个脚本是否只输出有效的 xhtml。

实现这一点的一种方法是在每次运行时在脚本中验证此 php 脚本的输出，并将生成的错误和警告存储在 mysql 数据库中。

这可能吗？

谢谢！

**编辑：**`echo`我想这里的主要问题是在不重写每个调用的情况下获取当前脚本的输出。

**EDIT2：**我更喜欢 w3c sgml 验证而不是 html tidy。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T15:51:32.390

您不仅可以检查，还可以使用[tidy修复常见错误](http://www.php.net/manual/en/intro.tidy.php)

[来自http://www.php.net/manual/en/tidy.parsestring.php](http://www.php.net/manual/en/tidy.parsestring.php)的示例

```
<?php
ob_start();
?>

<html>
  <head>
   <title>test</title>
  </head>
  <body>
   <p>error<br>another line</i>
  </body>
</html>

<?php

$buffer = ob_get_clean();
$config = array('indent' => TRUE,
                'output-xhtml' => TRUE,
                'wrap' => 200);

$tidy = tidy_parse_string($buffer, $config, 'UTF8');

$tidy->cleanRepair();
echo $tidy;
?> 
```

这将输出：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>
      test
    </title>
  </head>
  <body>
    <p>
      error<br />
      another line
    </p>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T15:45:23.027

这当然是可能的。您必须搜索为您验证 XHTML 标记的程序或服务。

问题实际上是您的应用程序的速度和性能。你一定要缓存输出！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-01T11:36:46.277

此类将让您[验证正确的 HTML5 的输出](https://404it.no/en/blog/php_class_for_validating_html5)。您不想执行此运行时，因为它会减慢您的执行时间。相反，在部署网站之前创建一组可以运行的测试。我个人更喜欢[PHPUnit](https://phpunit.de/)作为测试框架。

# java - 使用未经验证的 SSL 证书通过 HTTPS 下载文件

> ID：12410037
> 
> 赞同：1
> 
> 时间：2012-09-13T15:43:11.927
> 
> 标签：java, ssl

我的 Java 程序使用 GitHub 的原始地址来访问版本文件以获取最新版本。此地址的格式为[https://raw.github.com/user/repository/branch/version_file](https://raw.github.com/user/repository/branch/version_file)

在测试阶段，我使用以下代码没有问题：

```
currentVersion = new Version(plugin.getDescription().getVersion());

URL url = new URL("https://raw.github.com/zonedabone/CommandSigns/master/VERSION");
URLConnection connection = url.openConnection();
BufferedReader in = new BufferedReader(new InputStreamReader(connection.getInputStream()));
newestVersion = new Version(in.readLine());

if (currentVersion.compareTo(newestVersion) < 0)
    newAvailable = true; 
```

但是，一些用户抱怨以下错误：

```
sun.security.validator.ValidatorException:
  PKIX path building failed:
    sun.security.provider.certpath.SunCertPathBuilderException:
      unable to find valid certification path to requested target 
```

Java 抱怨它无法验证 SSL 证书。GitHub 的证书由 DigiCert 验证，但显然一些 Java 版本无法识别这一点。

我读过有两种方法可以克服这个问题：将证书添加到 TrustStore 并完全禁用验证。

StackOverflow 上建议的答案要么使用允许所有的 TrustStore，考虑到它不在“测试环境”的范围内，这将是一个非常糟糕的主意，或者如果它们显示如何添加证书，它们通常链接到一个损坏的网页。

有人可以提供新信息吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:27:47.887

首先是理论......正如[JSSE 参考指南](http://docs.oracle.com/javase/7/docs/technotes/guides/security/jsse/JSSERefGuide.html)所说：

> 重要说明：JDK 在 /lib/security/cacerts 文件中附带了数量有限的受信任根证书。如 keytool 中所述，如果您将此文件用作信任库，则您有责任维护（即添加/删除）此文件中包含的证书。
> 
> 根据您联系的服务器的证书配置，您可能需要添加额外的根证书。从适当的供应商处获取所需的特定根证书。

用户应自行维护 CA 证书列表。不幸的是，许多人不知道该怎么做。他们可以`cacerts`在自己的安装中使用另一个 JRE 的文件（更新的）。

您可以使用信任任何证书的信任管理器并将其专门用于该连接，但这不是一个好主意，因为它会打开潜在 MITM 攻击的连接。对于这种不安全的解决方案，有足够多的代码示例。

如果您想信任特定证书，最好的解决方案是使用特定的信任库正确加载它，如[本答案](https://stackoverflow.com/a/859271/372643)中所述。`InputStream`如果您想将它与您的应用程序捆绑在一起，您甚至可以从类加载器中加载此信任库。

或者，在可能的情况下，您可以直接使用操作系统信任库。在 Windows 上，您可以按照[本文](http://java.sun.com/developer/technicalArticles/J2SE/security/)`Windows-ROOT`所述加载密钥库。在 OSX 上，您可以加载.`KeychainStore`

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-13T15:48:25.363

您可以使用“all”-TrustManager 实现 HttpsUrlConnection

像[http://bitsandcodes.blogspot.de/2010/08/create-trust-manager-that-trust-all-ssl.html](http://bitsandcodes.blogspot.de/2010/08/create-trust-manager-that-trust-all-ssl.html)

# jenkins - 从 jenkins 上传 rpm 到 Redhat 卫星

> ID：12410042
> 
> 赞同：0
> 
> 时间：2012-09-13T15:43:21.843
> 
> 标签：jenkins

我的任务是构建我的项目，创建 rpm，然后将 rpm 上传到 Redhat Satellite。我正在使用 jenkins 构建项目并创建 rpm，但最后一个任务已成为 headcache。我面临以下问题。

1.  Jenkins 用户无权将 rpm 上传到卫星。
2.  su 也不适用于 jenkins，因为它没有终端。

现在我开始觉得我可能无法用詹金斯实现这一目标。[虽然我非常热衷于通过 jenkins 来做这件事] 有人可以提出一些出路吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T14:15:47.313

您需要在 Satellite 中为 jenkins 创建一个用户。此用户需要您要上传 RPM 的频道的管理权限。

然后您需要在 jenkins 中创建作业，使用[https://fedorahosted.org/spacewalk/wiki/spacecmd](https://fedorahosted.org/spacewalk/wiki/spacecmd "空间命令")将 RPM 推送到 Satellite 服务器。

# django - 配置 Django runserver 以在非应用目录中提供静态文件？

> ID：12410043
> 
> 赞同：3
> 
> 时间：2012-09-13T15:43:21.640
> 
> 标签：django

我正在尝试将 Django 配置为在使用*runserver*时提供静态文件（生产工作正常）。一切都适用于应用程序目录下的所有静态文件。问题来自不在特定应用程序下但位于最终*静态*目录中的静态文件。例如，我有这个项目结构：

```
/myproject/
/myproject/static/
/myproject/static/css/foo.css
/myproject/app1
/myproject/app1/static/css/bar.css

urls.py
if settings.SERVE_STATIC:
    urlpatterns += patterns('',
        url(r'^static/(?P<path>.*)$', 'django.views.static.serve',
            {'document_root': settings.STATIC_ROOT}),
    )
    urlpatterns += staticfiles_urlpatterns() # one of these may be redundant.

settings.py
SERVE_STATIC = True
PROJECT_ROOT = '/myproject'
STATIC_ROOT = os.path.join(PROJECT_ROOT, 'static')
STATIC_URL = '/static/'
STATICFILES_DIRS = (os.path.join(PROJECT_ROOT, 'static'),)
INSTALLED_APPS = ('app1',) 
```

使用这些设置，我得到错误：

> 配置不当：STATICFILES_DIRS 设置不应包含 STATIC_ROOT 设置

这是有道理的。我告诉 Django 收集静态文件，并将它们放在同一个地方——这可能会导致循环。

如果我注释掉 STATICFILES_DIRS 变量，django 将找到静态文件“bar.css”。但它*没有*找到'foo.css'。

如果我注释掉 STATIC_ROOT 变量并放回 STATICFILES_DIRS，那么它会找到文件“foo.css”——当然，“collectstatic”命令将不再起作用。

注意 - 我意识到“/静态”目录应该是空的，但我所在的项目无论如何都有文件。:) 只要它们没有被“collectstatic”覆盖，看起来 Django runserver 应该为它们服务——但事实并非如此。

运行 Django runserver 时，如何提供 STATIC_ROOT 下的静态文件（例如 foo.css）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T15:49:10.210

现在将 /static/ 中的文件移动到不同的目录 - 例如，将其称为 /project-static/。

然后只在 urls.py 中包含这一行：

```
urlpatterns += staticfiles_urlpatterns() 
```

（删除 django.views.static.serve 视图）

在 settings.py 中，使用这个：

```
STATICFILES_DIRS = (os.path.join(PROJECT_ROOT, 'project-static'),) 
```

然后你可以将文件放在文件系统的 /project-static/ 目录中，开发服务器会从 /static/ URL 前缀中为它们提供服务，在生产中，`collectstatic`会找到它们并将它们放入 web 所在的 /static/ 目录中服务器可以找到它们。

# python - Python if/else 语句的问题

> ID：12410049
> 
> 赞同：0
> 
> 时间：2012-09-13T15:43:36.173
> 
> 标签：python

我敢肯定，这个问题的答案非常简单，但我终其一生都无法弄清楚这一点。我有这段代码，如果我只有 if 语句，它工作得很好，但是当我添加 else 它停止工作。我到底做错了什么？！

```
import wmi
import win32api
c = wmi.WMI()
process_watcher = c.Win32_Process.watch_for("creation")
while True:
    new_process = process_watcher()
    if(new_process.Caption == "java.exe"):
         win32api.MessageBox(0, 'Java has started, did you mean for this to happen?', 'Warning', 0x00001000)
    else:
         win32api.MessageBox(0, 'Not Java', 'Warning', 0x00001000) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T15:46:15.580

您正在使用制表符进行缩进，我认为您有缩进错误。用于`python -tt scriptname.py`检测。

# javascript - 如何处理ajax 201

> ID：12410051
> 
> 赞同：13
> 
> 时间：2012-09-13T15:43:42.233
> 
> 标签：javascript, jquery

进行 ajax 调用时，请参见下面的示例`success`确实会重新调整**201**状态。您如何更好地处理这些成功函数中的 200、201？

```
$.ajax({
    type: "POST",
    dataType: "json",
    url: "http://api.domain.com/sms",
    data: {
      // Send value in mobile input field.
      mobile: $("#mobile").val(),
    },
    // On successful AJAX call do the following.
    success: function(data) {
      $('#messageText').text('SMS successfully sent');
    },
    error: function(jqXhr) {
      data = JSON.parse(jqXhr.responseText);
    }
}); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-16T01:19:43.990

使用`statusCode`对象：

```
var handle200 = function(data, textStatus, jqXHR) {
    alert('200'); // success codes have the success signature
};

var handle201 = function(data, textStatus, jqXHR) {
    alert('201'); // success codes have the success signature
    // test it if you are in doubt:
    console.log(data);
    console.log(textStatus);
    console.log(jqXHR);
};

var handle404 = function(jqXHR, textStatus, errorThrown) {
    alert('404'); // failing codes have the error signature
});

var request = $.ajax({
    type: 'POST',
    url: '/myresource/posttarget',
    data: { name: 'john' },
    statusCode: {
        200: handle200,
        201: handle201,
        404: handle404
    }
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-01-14T12:43:48.380

这是一个老问题，但我还是想发表评论。

我遇到了同样的问题，为我解决的一件事是未设置“dataType”。当您执行此操作时，jQuery 将尝试猜测服务器返回的数据类型，并且当您的服务器返回没​​有内容的 201 时不会抛出错误。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-13T06:00:52.553

我们遇到了类似的问题；查看 jquery 1.9 源代码，201 状态代码需要内容。如果 201 没有返回内容（或内容类型错误），则调用失败回调。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T15:49:11.040

[数据插入成功但jquery仍然返回错误](https://stackoverflow.com/questions/2233553/data-inserted-successful-but-jquery-still-returning-error)

这里的答案似乎是您现在可以使用的解决方法。但是，如果您使用跨域，AJAX 有一些问题。看看这个 SOF 线程：

[从 jQuery AJAX 读取 HTTP 状态/错误代码的问题](https://stackoverflow.com/questions/7685288/problems-reading-the-http-status-error-code-from-jquery-ajax)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-09T14:39:09.170

代替

```
ResponseEntity<?> responseEntity = new ResponseEntity<>(HttpStatus.CREATED); 
```

我用了

```
ResponseEntity<?> responseEntity = new ResponseEntity<>(detailVO, HttpStatus.CREATED); 
```

如果成功，detailVO 是我的目标。然后在浏览器中我得到了成功功能的响应。

# deployment - 如果用户未能提供所需信息，则卸载/回滚 ClickOnce 应用程序

> ID：12410054
> 
> 赞同：0
> 
> 时间：2012-09-13T15:43:53.130
> 
> 标签：deployment, clickonce

**设想：**

我有要从网站安装/更新的 Window 应用程序。用户需要在安装过程中为用户输入一些信息并配置应用程序。如果用户未能提供所需的信息，应用程序将卸载/回滚。

ClickOnce 部署符合从网站自动安装和更新应用程序。但我无法在应用程序安装之前获得用户输入（或执行我的自定义 WinForms）。

**问题：**

如何在安装具有上述要求的应用程序之前执行自定义 WinForms？

或者

如果用户未能提供必填信息，如何卸载 ClickOnce 应用程序？

或者

上面还有其他实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T07:02:38.580

最后，我们添加了一个单独的层来获取用户输入和处理数据。用户无需安装即可下载并执行该 exe。应用程序将被下载，如果一切顺利..

问候， 阿曼

# monitoring - 什么是金丝雀监控？

> ID：12410059
> 
> 赞同：3
> 
> 时间：2012-09-13T15:44:04.997
> 
> 标签：monitoring

什么是金丝雀监控？这是什么意思？为什么是金丝雀？

在这里找到了一个金丝雀监控工具：http: [//svn.apache.org/viewvc/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/tool/Canary.java ?view=标记](http://svn.apache.org/viewvc/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/tool/Canary.java?view=markup)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-13T15:52:35.010

象征意义是“煤矿里的金丝雀”；过去，在电子蒸汽探测器出现之前，矿工会将笼中的金丝雀带入煤矿，作为危险气体的“预警系统”。与流行的谣言相反，矿工们通常不会等到金丝雀死去。他们反而在听金丝雀停止鸣叫。

在这种情况下，程序只是愉快地坐在那里做很少的事情（基本上轮询包含有关 Apache 的状态数据的 HTableDescriptors），*直到*出现一些故障，此时它记录故障的性质（然后可以通过以下方式发送给系统管理员使用其他系统（如事件日志嗅探）发送电子邮件）。

更“类似金丝雀”的监控系统是“心跳监控”。这基本上要求被监控的系统以设定的时间间隔发送“我还在这里并且做得很好”的消息。如果系统错过了“心跳”，监视器就知道有问题了。这有点类似于金丝雀唧唧声，因为监视器只是被动地“监听”这些状态消息，并且状态消息总是一件好事（而不是您的示例中使用的系统正在主动监视系统）监控并发送好消息和坏消息）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T15:47:28.863

> 对笼中金丝雀采矿工人的暗示将与他们一起进入隧道。如果甲烷或一氧化碳等危险气体泄漏到矿井中，这些气体会在杀死矿工之前杀死金丝雀。

[http://en.wiktionary.org/wiki/canary_in_a_coal_mine](http://en.wiktionary.org/wiki/canary_in_a_coal_mine)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-29T08:01:03.623

> 矿工通常不会等到金丝雀死去；他们反而在听金丝雀停止鸣叫。

实际上，这正是合成（或主动）监控的全部内容 [1]。有很多 SaaS 工具可以为您完成这项工作（[https://www.site24x7.com/、https://www.pingdom.com](https://www.pingdom.com) [）](https://www.site24x7.com/)，其中很多是免费的。有些提供 API 接口，您可以使用它来制作自定义版本的监视器 ( [https://cula.io/](https://cula.io/) )。

[1] [https://en.wikipedia.org/wiki/Synthetic_monitoring](https://en.wikipedia.org/wiki/Synthetic_monitoring)

# google-maps-api-3 - 检查 infowindow 是否打开 Google Maps v3

> ID：12410062
> 
> 赞同：43
> 
> 时间：2012-09-13T15:44:10.037
> 
> 标签：google-maps-api-3, infowindow

拜托，我需要帮助。

我想检查我的信息窗口是否打开。

例如：

```
if (infowindow.isOpened)
{
   doSomething()
} 
```

或者

```
if (infowindow.close)
{
   doAnotherthing();
} 
```

我不知道该怎么做

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-09-13T16:02:31.793

这是一个未记录的功能，因此可能会在没有通知的情况下进行更改，但是该`infoWindow.close()`方法将对象上的地图设置为`null`（这就是为什么`infoWindow.open(map, [anchor])`需要您传入 a `Map`），因此您可以检查此属性以判断它当前是否正在显示：

```
function isInfoWindowOpen(infoWindow){
    var map = infoWindow.getMap();
    return (map !== null && typeof map !== "undefined");
}

if (isInfoWindowOpen(infoWindow)){
    // do something if it is open
} else {
    // do something if it is closed
} 
```

**更新：** 另一种可能有用的编写`isOpen()`方法是向`InfoWindow` `prototype`.

```
google.maps.InfoWindow.prototype.isOpen = function(){
    var map = this.getMap();
    return (map !== null && typeof map !== "undefined");
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-09-27T20:50:18.447

在谷歌没有给我们任何更好的方法之前，您可以向 infoWindow 对象添加一个属性。就像是：

```
google.maps.InfoWindow.prototype.opened = false;
infoWindow = new google.maps.InfoWindow({content: '<h1> Olá mundo </h1>'});

if(infoWindow.opened){
   // do something
   infoWindow.opened = false;
}
else{
   // do something else
   infoWindow.opened = true;
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-06-18T20:31:03.880

我修改了 google.maps.InfoWindow 的原型并更改了打开/关闭以设置/清除属性：

```
//
// modify the prototype for google.maps.Infowindow so that it is capable of tracking
// the opened state of the window.  we track the state via boolean which is set when
// open() or close() are called.  in addition to these, the closeclick event is
// monitored so that the value of _openedState can be set when the close button is
// clicked (see code at bottom of this file).
//
google.maps.InfoWindow.prototype._open = google.maps.InfoWindow.prototype.open;
google.maps.InfoWindow.prototype._close = google.maps.InfoWindow.prototype.close;
google.maps.InfoWindow.prototype._openedState = false;

google.maps.InfoWindow.prototype.open =
    function (map, anchor) {
        this._openedState = true;
        this._open(map, anchor);
    };

google.maps.InfoWindow.prototype.close =
    function () {
        this._openedState = false;
        this._close();
    };

google.maps.InfoWindow.prototype.getOpenedState =
    function () {
        return this._openedState;
    };

google.maps.InfoWindow.prototype.setOpenedState =
    function (val) {
        this._openedState = val;
    }; 
```

您还需要监视 closeclick 事件，因为单击关闭按钮不会调用 close()。

```
//
// monitor the closelick event and set opened state false when the close
// button is clicked.
//
(function (w) {
    google.maps.event.addListener(w, "closeclick", function (e) {
        w.setOpenedState(false);
    });
})(infowindow); 
```

调用`InfoWindow.getOpenedState()`返回一个反映信息窗口状态（打开/关闭）的布尔值。

我选择这样做而不是使用`InfoWindow.getMap()`or`MVCObject.get('map')`方法是因为众所周知的使用无证行为的陷阱。然而，谷歌使用`MVCObject.set('map', null)`强制从 DOM 中删除 InfoWindow，所以这不太可能改变......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-03T14:06:36.717

`infowindow.getMap()``infowindow`如果关闭则返回 null 。

所以你可以简单地使用：

```
if (infowindow.getMap()); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-11-26T13:31:02.320

您可以简单地为 infoWindow设置`key`和：`value``infoWindow.set('closed', true);`

**例子：**

```
const infoWindow = new google.maps.InfoWindow({
    content: 'foo',
    position: {
        lat: some_number,
        lng: some_number
    }
});

infoWindow.set('closed', true);

// Clicking on polyline for this example
// Can be marker too
polyline.addListener(
    'click',
    () => {
        if (infoWindow.get('closed')) {
            infoWindow.open(map);
            infoWindow.set('closed', false);
        } else {
            infoWindow.close();
            infoWindow.set('closed', true);
        }
    }
); 
```

# java - 我可以使用 SchedulingRule 来代替同步吗

> ID：12410066
> 
> 赞同：0
> 
> 时间：2012-09-13T15:44:30.893
> 
> 标签：java, eclipse, multithreading, concurrency

我可以从以下位置更改我的代码：

```
class Sample{
    private Object _lock=new Object();
    public void someMethod(){
        synchronized(_lock){
            doSomething();
        }
    }
} 
```

到：

```
class Sample{
    private ISchedulingRule _lock=new SomeSchedulingRule();
    public void someMethod(){
        try{
            Job.getManager().beginRule(_lock);
            doSomething();
        }finally{
            Job.getManager().endRule(_lock);
        }
    }
} 
```

我正在阅读“实践中的 java 并发”，他们说如果我想使用一些显式锁，我必须保证内存可见性。

所以问题是：

**如果我能保证内存可见性，我可以使用底部的代码替换顶部的代码（用eclipse IJobManager.beginRule和IJobManager.endRule替换内部同步）**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:14:09.267

[假设我在这里](http://grepcode.com/file/repository.grepcode.com/java/eclipse.org/3.5/org.eclipse.core/jobs/3.4.100/org/eclipse/core/internal/jobs/JobManager.java#JobManager.beginRule%28org.eclipse.core.runtime.jobs.ISchedulingRule%2Corg.eclipse.core.runtime.IProgressMonitor%29)找到的源代码是最新的，您可以检查其中有一个大块的`beginRule`方法调用。`implicitJob.begin``synchronized(this)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:10:40.160

我刚刚发现了一个关于并发性的网络教程，它做出了以下声明：

> 好吧，事实证明 Lock 接口的一个约定是它提供与同步相同的 >memory barrier 行为。

那是指`java.util.concurrent`. 我不知道它是否适用于`ISchedulingRule`您在此处显示的界面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T06:54:39.543

如果您的唯一目标是实现同步，那么答案是肯定的。

也就是说，您需要注意一些（隐藏的）陷阱。由于`JobManager`在某种程度上旨在防止死锁，因此对于使用和定义嵌套规则有一些严格的规则（Java 同步块没有的限制）。没有用于检查线程是否持有规则/锁的公共 API。此外，`beginRule`不能通过在等待线程上调用中断来取消。仅举几例。

# iphone - mapView "addAnnotation:addAnnotation" 不使用 IF/ELSE 语句根据需要删除引脚

> ID：12410069
> 
> 赞同：2
> 
> 时间：2012-09-13T15:44:40.150
> 
> 标签：iphone, xcode, mkmapview, mkannotation, mkannotationview

在我现在已经筋疲力尽的事情上苦苦挣扎。这里有两个部分：

1）如果用户搜索已识别并固定在 ViewDidLoad 上的相同坐标，我试图删除一个图钉。这部分工作。不可操作的部分是#2。

2）当用户搜索任何其他位置时，我想添加一个图钉，即 [self.mapView addAnnotation:addAnnotation]；我的代码如下。

```
- (IBAction) showAddress // THIS IS A BUTTON WHICH LOCATES COORDINATES
{

[addressField resignFirstResponder];
MKCoordinateRegion region;
MKCoordinateSpan span;
span.latitudeDelta=0.2;
span.longitudeDelta=0.2;

CLLocationCoordinate2D location = [self addressLocation];
region.span=span;
region.center=location;

[mapView setRegion:region animated:TRUE];
[mapView regionThatFits:region];

if (location.longitude = (double) -73.2125) 
{   
    addAnnotation = [[AddressAnnotation alloc]initWithCoordinate:location]; 
    [self.mapView removeAnnotation:addAnnotation];
}

else  
{
    addAnnotation = [[AddressAnnotation alloc]initWithCoordinate:location]; 

    [self.mapView addAnnotation:addAnnotation];
    [addAnnotation release];
}
} 
```

有什么想法吗？多谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T15:54:34.417

这一行：

```
if (location.longitude = (double) -73.2125) 
```

进行赋值 ( `=`)，而不是比较 ( `==`)。

由于分配总是成功的，它总是去`removeAnnotation`零件。

但是，我不建议使用`==`.
我建议检查这两个数字是否彼此相距很小。
有关示例，请参[见此答案。](https://stackoverflow.com/a/4732704/467105)

# entity-framework - 实体框架复制对象以进行版本控制

> ID：12410070
> 
> 赞同：1
> 
> 时间：2012-09-13T15:44:42.110
> 
> 标签：entity-framework

我正在使用最新版本的 EF 并试图弄清楚如何制作对象的副本并将其作为新记录插入，但是这样指向不同对象的对象的所有属性仍然指向这些对象之后副本。

所以我说了一个“软件”对象，它有一个版本并且有作者和公司属性，我复制了这个软件并更新了版本，作者和公司保持不变，但我有一个新的记录。所以从技术上讲，如果需要，我可以回滚到以前的版本。

当前获取对象，对其进行更新并将其作为新对象插入会创建预期的链接对象的新版本。我知道您可以将对象附加和分离到上下文中，这似乎是正确的方法，但不确定当您想要新记录时它是如何工作的。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T15:50:07.813

当您更新对象时，在调用 SaveChanges() 之前，您可以将 EntityState 修改为已添加，因此 EF 会将实体添加为新实体，而不是更新现有实体。

如果你有一个 DbContext：

```
YourContext.Entry(YourEntity).State = EntityState.Added; 
```

如果你有一个 ObjectContext：

```
YourContext.ObjectStateManager.ChangeObjectState(YourEntity, EntityState.Added); 
```

# c# - 从视图返回控制器动作中的总数

> ID：12410071
> 
> 赞同：0
> 
> 时间：2012-09-13T15:44:46.330
> 
> 标签：c#, asp.net-mvc

我有一个观点，我在其中存储未按时归还的书籍的滞纳金，这是我在控制器操作中的操作方式：

```
 [HttpPost()]
    public ActionResult DisplayTotalBalance(string id)
    {
        DataContext db = new DataContext();

        var totalLateFee = (from p in db.vwCustomer.Where(a => a.CustomerId == id)
                              group p by p.LateFee into g
                              select g.Key).FirstOrDefault();

        return Json(new { totalLateFee });
    } 
```

在我存储滞纳金的 vwCustomer 中，客户可能列出了许多滞纳金。例如

```
CustomerId LateFee
J101        5.0
P202        6.0
J101        2.0
P203        5.0
J101        5.0 
```

如何汇总 J101 的所有 LateFee 并在控制器操作中返回？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T15:47:43.857

```
(from p in db.vwCustomer.Where(a => a.CustomerId == id) select p.LateFee).sum(); 
```

# java - Java：为什么静态字段彼此“独立”？

> ID：12410072
> 
> 赞同：0
> 
> 时间：2012-09-13T15:44:46.703
> 
> 标签：java, static, field

在以下代码中，该`set`方法更改了类的字段值`Calendar`。该字段`YEAR`已声明`static int YEAR`。那么为什么通过创建两个`Calendar`类对象，对一个对象的更改会反映到另一个对象上呢？这不会发生。我会问你Java开发人员是如何实现这个的？

```
Calendar calendar = new GregorianCalendar();
Calendar cal = new GregorianCalendar(2011,9,13);
System.out.println(calendar.get(Calendar.YEAR));
System.out.println(cal.get(Calendar.YEAR)); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T15:46:33.567

`Calendar.YEAR`是一个常量，仅用于*命名*`Calendar`. 该字段的*值***不是**静态的：它可以并且会在`Calendar`.

`Calendar`为日期和时间的不同组成部分定义了许多这些字段名称，专门用于相应字段的 get 和 set 操作。

[这是](http://docs.oracle.com/javase/6/docs/api/java/util/Calendar.html#YEAR)javadoc 中的部分`Calendar.YEAR`。

至于实现，`set`and`get`方法知道这些不同的字段类型，并根据传入的常量更改实例中的值。可以将其视为or中的一个大`switch`语句，打开所有字段值。`get``set`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T15:48:08.113

`YEAR`（和其他相关字段）只是用于告诉您`Calendar`想要哪个字段的常量。如果您查看 的值`YEAR`，您会发现它的实际`static final` [值为 1](http://docs.oracle.com/javase/6/docs/api/constant-values.html#java.util.Calendar.YEAR)。

正如您所期望的那样，个人的年份`Calendar`最终存储在对象中，并且该常量仅用于询问其实际年份值。`Calendar``YEAR``Calendar`

# javascript - 通过 jQuery 为表中的 xmlhttprequest json 数据生成输入处理程序

> ID：12410073
> 
> 赞同：0
> 
> 时间：2012-09-13T15:44:58.143
> 
> 标签：javascript, jquery, dynamics-crm-2011, jquery-events

我正在努力通过 JSON 数组动态生成按钮。

精简代码是这样的（目的是根据数据构建一个表，还没有什么花哨的，我还不精通这个）：

```
$.ajax({
    /* type, content, etc. removed */
    success: function (data, textStatus, XmlHttpRequest) {
        var target = $('myContainerDiv');
        var result = data.d.results;

        var $table = $('<table />');
        for(var i=0;i < results.length; i++) {
            var $row = $('<tr />');
            var $cell = $('<td />');
            var $button = $('<input />').attr({ type: 'button', value: 'Edit', name: 'btn' + i });
            $button.click(function () {

                // **
                // In a .NET environment, this would become a closure
                // I suspect this is the offending bit of code
                //

                alert(results[i].name);

            };

            $cell.append($button);
            $row.append($cell);
            $table.append($row);
        }

        $target.append($table);
    },
    /* error etc. removed*/
}); 
```

我基本上想要一个充满按钮的列，每个按钮都会从我从`$.ajax`调用中获得的数组中弹出一个字段的值。

按钮实际上出现了，但它们对单击没有反应，而且我在 F12 工具控制台中没有看到运行时错误。这可能是因为该脚本是 Microsoft Dynamics CRM 2011 解决方案配置页面的一部分，但除此之外，我确信 AJAX 调用正常（我尝试让它打印出数据，我可以看到）。

**更新**

在点击处理程序中引用`i`确实是有问题的行：像这样更改代码使事情按我的预期工作：

```
var $button = $('<input />').attr({ type: 'button', value: 'Edit', name: 'btn' + results[i].name });
$button.click(function () {
    // 'i' value is NOT what I thought it was !
    alert(this.name.substring(3,this.name.length));
    // I found out in the meanwhile that 'this' references the event source
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:27:09.273

首先，您的代码中有几个语法错误，它可能根本没有运行：

1.  如果你的 div 容器的 ID 是`myContainerDiv`, 来获取你需要做的目标`$('#myContainerDiv')`

2.  您创建了一个变量`result`，但您使用了一个`results`变量

3.  你没有在`$button.click`

4.  您正在添加所有内容，`$target`但被定义为`target`

现在实际问题可能是，正如您所说，闭包，请记住您关闭了变量而不是值，因此当您执行按钮单击处理程序时，`i`其值为`results.length`，所以到那时您已超出范围。

您可以尝试将`results`对象存储在其他位置，从按钮中提取您要查找的对象的 Id（您正在命名 then `'btn'+i`），然后以`name`这种方式访问​​该属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:24:29.807

我注意到您没有关闭 .click() 括号。

尝试...

```
$button.click(function () {
    alert(results[i].name);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:59:02.587

你可以试试这个...

```
$.ajax({
/* type, content, etc. removed */
success: function (data, textStatus, XmlHttpRequest) {
    var $target = $('#myContainerDiv'),
        results = data.d.results,
        $table = $target.append('<table />').children('table:last-child'), $trSet = $([]);
    for(var i=0; i < results.length; i++) {
        $trSet = $trSet.add(
            $([
                '<tr><td>',
                $('<input type="button" value="edit" name="btn'+i+'" rel="'+results[i].name+'" />').wrap('<div />').html(),
                '</td></tr>'
            ].join(''))
        );
    }       
    // Using Event delegation ... Only one handler is attached to the DOM.
    $table.append($trSet).click(function(e){
        var $t = $(e.target);

        if( $t.is('input[type="button"]') ){
            alert($t.attr('rel'));
        }
        // choose to return false whether to prevent event bubbling up the DOM or not
        // return false;
    });     
  },
   /* error etc. removed*/
}); 
```

# c# - 按下后退按钮时执行最后一个动作 ASP.Net

> ID：12410076
> 
> 赞同：0
> 
> 时间：2012-09-13T15:45:04.870
> 
> 标签：c#, webforms

我有一个带有“服务器列表”的 ListBox，它启用了 AutoPostBack 并附加了一个 SelectedIndexChanged 事件：

```
 protected void lbServerList_SelectedIndexChanged(object sender, EventArgs e)
    {            
        if ( lbServerList.SelectedValue.ToString() != "")
        {
            Response.Redirect("detail.aspx?Server=" +  lbServerList.SelectedValue.ToString());
        }
    } 
```

然后我有一个文本框来添加一个带有按钮“btnServertoAdd”的“服务器”（执行添加）

```
 protected void btnServertoAdd_Click(object sender, EventArgs e)
    {
        Response.Redirect("add.aspx?Server=" + tbServertoAdd.Text);
    } 
```

场景：如果我从 ListBox 中选择一个项目，它将转到 detail.aspx，显示服务器规格：太棒了。现在，如果我单击返回（浏览器按钮），然后在 TextBox 中键入内容并单击 btnServerToAdd，它仍然会转到 detail.aspx 而不是应该的 add.aspx.... 我该如何解决这个问题？

让我知道是否需要更多代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T15:54:20.840

这是因为当您单击按钮时，所选服务器也不同于原始值（存储在视图状态中）。两个事件都被触发，但显然`SelectedIndexChanged`事件首先被触发，然后`Redirect`跳过其余的处理。

我想不出如何*不让*`SelectedIndexChanged`事件第二次触发，所以你可以做的是，而不是事件`Redirect`本身：

1.  在您的页面类中有一对`bool`成员变量。
2.  `true`在每个事件处理程序中设置一个。
3.  在页面`OnLoadComplete`事件中，检查每个并根据需要重定向：
    *   如果*两者*都是`true`，则重定向到`add.aspx`。
    *   如果是`true`，则重定向到相应的页面。
    *   否则根本不重定向。

# plone - Plone 3.3.5 Document_view 属性错误

> ID：12410077
> 
> 赞同：0
> 
> 时间：2012-09-13T15:45:15.150
> 
> 标签：plone, upgrade

在这里克隆 n00b，继续从 2.5 到 3.3.5 的迁移问题。

为了消除任何潜在的问题，我清除了自定义文件夹并试图让页面显示出来。当我转到不是首页的页面时，我得到：

```
AttributeError _v_transform. 
```

这是回溯：

```
Exception traceback
Time    2012/09/13 08:18:06.733 GMT-7
User Name (User Id) Anonymous User (None)
Request URL http://localhost:8080/mission-vision/index_html/document_view

Exception Type  AttributeError
Exception Value _v_transform
Traceback (innermost last): 
Module ZPublisher.Publish, line 119, in publish 
Module ZPublisher.mapply, line 88, in mapply 
Module ZPublisher.Publish, line 42, in call_object 
Module Shared.DC.Scripts.Bindings, line 313, in __call__ 
Module Shared.DC.Scripts.Bindings, line 350, in _bindAndExec 
Module Products.CMFCore.FSPageTemplate, line 216, in _exec 
Module Products.CMFCore.FSPageTemplate, line 155, in pt_render 
Module Products.PageTemplates.PageTemplate, line 98, in pt_render 
Module zope.pagetemplate.pagetemplate, line 117, in pt_render 
Module zope.tal.talinterpreter, line 271, in __call__ 
Module zope.tal.talinterpreter, line 346, in interpret 
Module zope.tal.talinterpreter, line 891, in do_useMacro 
Module zope.tal.talinterpreter, line 346, in interpret 
Module zope.tal.talinterpreter, line 536, in do_optTag_tal 
Module zope.tal.talinterpreter, line 521, in do_optTag 
Module zope.tal.talinterpreter, line 516, in no_tag 
Module zope.tal.talinterpreter, line 346, in interpret 
Module zope.tal.talinterpreter, line 957, in do_defineSlot 
Module zope.tal.talinterpreter, line 346, in interpret 
Module zope.tal.talinterpreter, line 536, in do_optTag_tal 
Module zope.tal.talinterpreter, line 521, in do_optTag 
Module zope.tal.talinterpreter, line 516, in no_tag 
Module zope.tal.talinterpreter, line 346, in interpret 
Module zope.tal.talinterpreter, line 861, in do_defineMacro 
Module zope.tal.talinterpreter, line 346, in interpret 
Module zope.tal.talinterpreter, line 957, in do_defineSlot 
Module zope.tal.talinterpreter, line 346, in interpret 
Module zope.tal.talinterpreter, line 536, in do_optTag_tal 
Module zope.tal.talinterpreter, line 521, in do_optTag 
Module zope.tal.talinterpreter, line 516, in no_tag 
Module zope.tal.talinterpreter, line 346, in interpret 
Module zope.tal.talinterpreter, line 949, in do_defineSlot 
Module zope.tal.talinterpreter, line 346, in interpret 
Module zope.tal.talinterpreter, line 536, in do_optTag_tal 
Module zope.tal.talinterpreter, line 521, in do_optTag 
Module zope.tal.talinterpreter, line 516, in no_tag 
Module zope.tal.talinterpreter, line 346, in interpret 
Module zope.tal.talinterpreter, line 861, in do_defineMacro 
Module zope.tal.talinterpreter, line 346, in interpret 
Module zope.tal.talinterpreter, line 586, in do_setLocal_tal 
Module zope.tales.tales, line 696, in evaluate
URL: file:d:\websites\nipo\plone 3.3.5\buildout-cache\eggs\plone-3.3.5-py2.4.egg\Products\CMFPlone\skins\plone_content\document_view.pt
Line 11, Column 4
Expression: <PathExpr standard:u'here/getText'>
Names:
{'container': <PloneSite at /Plone>,
 'context': <ATDocument at /Plone/mission-vision/index_html>,
 'default': <object object at 0x0108D528>,
 'here': <ATDocument at /Plone/mission-vision/index_html>,
 'loop': {},
 'nothing': None,
 'options': {'args': ()},
 'repeat': <Products.PageTemplates.Expressions.SafeMapping object at 0x07909300>,
 'request': <HTTPRequest, URL=http://localhost:8080/mission-vision/index_html/document_view>,
 'root': <Application at >,
 'template': <FSPageTemplate at /Plone/document_view used for /Plone/mission-vision/index_html>,
 'traverse_subpath': [],
 'user': <SpecialUser 'Anonymous User'>}
Module zope.tales.expressions, line 217, in __call__ 
Module Products.PageTemplates.Expressions, line 163, in _eval 
Module Products.PageTemplates.Expressions, line 125, in render 
Module Products.Archetypes.ClassGen, line 56, in generatedAccessor 
Module wicked.fieldevent, line 29, in render 
Module zope.event, line 23, in notify 
Module zope.component.event, line 26, in dispatch 
Module zope.component._api, line 130, in subscribers 
Module zope.component.registry, line 290, in subscribers 
Module zope.interface.adapter, line 535, in subscribers 
Module wicked.fieldevent, line 16, in notifyFieldEvent 
Module zope.component._api, line 101, in getMultiAdapter 
Module zope.component._api, line 114, in queryMultiAdapter 
Module zope.component.registry, line 206, in queryMultiAdapter 
Module zope.interface.adapter, line 482, in queryMultiAdapter 
Module wicked.fieldevent.meta, line 78, in field_value 
Module Products.Archetypes.Field, line 1394, in get 
Module Products.Archetypes.BaseUnit, line 100, in transform 
Module Products.PortalTransforms.TransformEngine, line 181, in convertTo 
Module Products.PortalTransforms.chain, line 51, in convert 
Module Products.PortalTransforms.Transform, line 192, in convert
AttributeError: _v_transform 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T07:16:11.887

试试这个：转到portal_setup，单击导入选项卡，选择“门户转换”配置文件，复选框“PloneTransforms 设置”，点击“导入选定步骤”，注意“包含依赖项”也被选中。

参考资料： http: [//plone.293351.n2.nabble.com/Re-content-type-icons-missing-in-migrated-site-td2563285.html](http://plone.293351.n2.nabble.com/Re-content-type-icons-missing-in-migrated-site-td2563285.html)

# javascript - 如何停止在javascript中以表单重新加载页面的输入键

> ID：12410080
> 
> 赞同：1
> 
> 时间：2012-09-13T15:45:17.693
> 
> 标签：javascript, forms, enter

我有一个带有按钮的搜索栏，可以搜索另一个站点上的内容。我让它正常运行（它在新选项卡中的另一个站点上搜索）但是每当我在搜索栏中单击输入时，我正在重新加载的页面。起初它从按回车键并单击搜索重新加载，然后我将输入类型更改为按钮而不是提交。当点击按钮时，这会重新加载，但是当按下回车键时，页面会重新加载。此外，它仅在单击搜索栏时才会重新加载，而不仅仅是在任何时候。必须为输入键选择搜索栏才能重新加载页面。

html:

```
<div id="search-3" class="widget widget_search">
    <h3 align="center">Search the other site!</h3>
    <form method="post" name="searchform" id="searchform">

      <span class="searching">
        <input type="text" value="" name="s" id="s" />
      </span>
      <input class="submit" type="button" Onclick="SearchBlog();" value="Search" />

    </form>
</div> 
```

javascript:

```
function SearchBlog()
{
    var searchQuery = document.searchform.s.value;
    if(searchQuery != ""){
        var destination = "website.com/s" + searchQuery;
        window.open(destination, "_blank");
    }
} 
```

我希望能够使用回车键进行搜索，但我不希望它重新加载页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T15:47:31.797

那是因为您要提交到一个不存在的页面。

`onsubmit`在您的`<form>`声明中使用：

```
<form method="POST" name="searchform" id="searchform" onsubmit="SearchBlog();">
   ...
</form> 
```

然后确保您`return false;`在 SearchBlog() 函数中。你应该很高兴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T15:47:48.697

试试这个：

```
<input class="submit" type="button" Onclick="return SearchBlog();" value="Search" /> 
```

和

```
function SearchBlog()
{
    var searchQuery = document.searchform.s.value;
    if(searchQuery != ""){
        var destination = "website.com/s" + searchQuery;
        window.open(destination, "_blank");
    }
    return false;
} 
```

# android - 是否可以在 Android 上打断电话？

> ID：12410081
> 
> 赞同：4
> 
> 时间：2012-09-13T15:45:18.970
> 
> 标签：android

Android应用程序是否可以中断电话或占据前台？无论设备是否已植根，我都会对此感兴趣。

我知道这是一个不寻常的要求，尽管它是针对专业项目的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T15:59:38.057

令人惊讶的是。com.android.internal.telephony.ITelephony 中有一个 endCall 方法（您需要在编译路径中使用正确的类进行编译或使用反射来获得它）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T15:48:24.993

您的服务（在后台运行）可以发送将由系统处理的 Intent，并将应用程序（处理此 Intent）带到前台。我不确定它是否会结束通话。

# php - AJAX 脚本未在 codeigniter 中返回成功

> ID：12410084
> 
> 赞同：1
> 
> 时间：2012-09-13T15:45:26.710
> 
> 标签：php, jquery, ajax, codeigniter

JS：

```
$(function() {
    load_custom_topics()
//    load_main()
});

function load_custom_topics(){
    $.ajax({
    type: "POST",
    async: false,
    url: 'http://rickymason.net/thebump/index.php/ajax/load_custom_topics',
    dataType: 'json', 
    data: { },
        success: function(page){
            alert(page);
        }
    });
    event.preventDefault()
} 
```

load_custom_topics

```
public function load_custom_topics()
{
    $check = $this->page_model->check_active_topic();
    if ($check == FALSE) 
    {
            $page['content'] = 'TEST equals FALSE'; 
    } else {
            $page['content'] = 'TRUE'; 
    }
    echo json_encode($page);
} 
```

转到页面 index.php/ajax/load_custom_topics 返回：

`{"content":"TEST equals FALSE"}`

警报没有触发！知道为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T15:55:25.500

实际上，在检查对控制器的请求时，我发现您没有设置 ajax 调用期望的正确标头（文本/json）。

请参阅 codeigniter 的[输出](http://codeigniter.com/user_guide/libraries/output.html)类。

使用

```
$this->output->set_content_type('application/json')->set_output(json_encode($page)); 
```

代替

```
echo json_encode($page); 
```

应该做的伎俩。

# c# - NLog - 帮助了解现有的配置选项

> ID：12410089
> 
> 赞同：0
> 
> 时间：2012-09-13T15:45:41.727
> 
> 标签：c#, nlog

我在应用程序上使用 NLog。我从另一个项目复制了 NLog 配置设置。该文件如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" autoReload="true">

  <!-- make sure to set 'Copy To Output Directory' option for this file -->
  <!-- go to http://nlog-project.org/wiki/Configuration_file for more information -->

  <targets>
        <target name="file" xsi:type="File" fileName="${basedir}/logs/log.txt" />
        <target name="errors" xsi:type="File" maxArchiveFiles="7" layout="${longdate}|${level}|${callsite}|${message}|${exception:format=ShortType,StackTrace}" archiveEvery="Day" fileName="${basedir}\logs\exceptions.txt" />    </targets>
    <rules>
        <logger name="*" minlevel="Debug" writeTo="file,errors" />
    </rules>
</nlog> 
```

我很好奇配置指定了什么，特别是“存档”选项。（即 maxArchiveFiles、archiveEvery）。

另外，我注意到目前当我使用 NLog记录*任何内容时，它会输出两个文件。*一个 exceptions.txt 文件和一个 log.txt 文件。我想我希望异常文件只包含异常（它将警告和信息记录到异常文本文件中）。

现在我只记录错误/异常，所以如果它与 exceptions.txt 相同，我认为我什至不需要 logs.txt 文件。

C#、NLog v2.0.0.0、ASP.NET 4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T15:50:17.167

它创建了两个文件（logs.txt 和errors.txt），因为您指定了两个文件（目标名称=文件，目标名称=错误）。

这可能是个好主意，但您当然可以自由地尝试设置和文件的不同组合，并根据最适合您的方式进行标准化。

这是解释格式和选项的文档：

*   [http://nlog-project.org/wiki/Configuration_file](http://nlog-project.org/wiki/Configuration_file)

# java - 在没有实际 servlet 容器的情况下运行 spring + hibernate 应用程序

> ID：12410092
> 
> 赞同：2
> 
> 时间：2012-09-13T15:45:54.783
> 
> 标签：java, spring, hibernate, tomcat, servlets

我有一个 Spring+Hibernate 应用程序，我将其编译为`*.war`文件并将其部署到 Tomcat。这对我作为开发人员有用，但是：

**有没有办法在安装了 Java 但未安装 tomcat 的某些用户计算机上运行该应用程序？**

我什至会接受该解决方案，该解决方案使用实际运行 servlet 容器并将应用程序部署到用户计算机的某种包，但我不希望用户必须安装容器并对其进行配置等。

有什么建议么？

编辑：

**基本上我希望用户从可执行文件运行我的 Web 应用程序，而无需安装 tomcat 或其他工具。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T16:00:47.153

你有几个选择：

1.  如果您将源代码分发给用户，并且他们已经安装了 maven，您可以在本地运行`mvn jetty:run`或`mvn tomcat:run`构建应用程序并在 Maven 插件启动的 servlet 容器中运行它。

2.  您可以在应用程序中[嵌入 Tomcat](https://stackoverflow.com/questions/640022/howto-embed-tomcat-6)或[嵌入 Jetty](http://wiki.eclipse.org/Jetty/Tutorial/Embedding_Jetty)，以便在应用程序中运行`main()`方法会启动侦听某个端口的 servlet 容器并运行您的应用程序。这使得可以将整个应用程序打包为单个`.jar`文件并使用`java -jar your.jar`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T17:38:51.223

Winstone servlet 容器允许在 winstone jar 中嵌入 war 文件*，*从而形成一个可以使用“java -jar foo.jar”或作为可点击 jar 运行的单个 jar 部署。

詹金斯/哈德森使用这个。我们已经使用它和一些类路径技巧来使用爆炸战争。

有关详细信息，请参阅[http://winstone.sourceforge.net/#embedding](http://winstone.sourceforge.net/#embedding)。

这很可能是目前最优雅的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T15:55:58.500

您当然可以从命令行运行 spring +hibernate 应用程序，使用[`ClassPathXmlApplicationContext`](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/support/ClassPathXmlApplicationContext.html)在您的方法中加载 spring 配置文件`main`来初始化 spring 容器和其余的接线。

但是，要运行使用 servlet 或使用 Java Servlet 规范的类似范例编写的 Web 应用程序，您需要一个像 Tomcat、AFAIK 这样的 servlet 容器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T18:32:52.857

不是直接的例子，但可能有用的类似例子：[http](http://www.zimbra.com/products/desktop.html) ://www.zimbra.com/products/desktop.html和[http://www.zimbra.com/products/zimbra-open-source.html](http://www.zimbra.com/products/zimbra-open-source.html)

# java - LinkedList 中的 ConcurrentModificationException

> ID：12410093
> 
> 赞同：5
> 
> 时间：2012-09-13T15:46:02.037
> 
> 标签：java, linked-list

我正在尝试设计一种将流程图转换为 java 或任何其他代码的软件。但是我反复得到 ConcurrentModificationException.. 但我不能使用布尔值来防止 concurrentModification，因为对链表的访问发生在不同的地方。

因此，作为解决方案，我创建了以下适配器类。但是，它也会从下一个方法抛出相同的异常。有没有其他解决方案，或者如果可以，请让我知道如何修改我的代码......

非常感谢您...

```
import java.util.Iterator;
import java.util.LinkedList;

public class LinkedListAdapter<T> extends LinkedList<T>{

@Override
public boolean add(T t){

    boolean b;

    synchronized(this){
        b = super.add(t);
    }

    return b;
}

@Override
public T remove(){

    T t;

    synchronized(this){
        t = super.remove();
    }

    return t;
}

@Override
public Iterator<T> iterator(){

    final LinkedListAdapter<T> adap = this;

    return 
        new Iterator<T>(){

        private Iterator<T> iter;

        {
            synchronized(adap){
                iter = LinkedListAdapter.this.getIterator();
            }
        }

        @Override
        public boolean hasNext() {

            boolean b;

            synchronized(adap){
                b = iter.hasNext();
            }

            return b;
        }

        @Override
        public T next() {

            T t;

            synchronized(adap){
                t = iter.next();
            }

            return t;
        }

        @Override
        public void remove() {
            throw new UnsupportedOperationException();
        }
    };
}

protected Iterator<T> getIterator() {

    Iterator<T> iter;

    synchronized(this){
        iter = super.iterator();
    }

    return iter;
}
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-13T15:48:50.843

通常在迭代列表时抛出，`ConcurrentModificationException`同时通常另一个线程甚至同一个循环尝试修改（添加/删除）列表的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T15:57:43.007

使用 synchronizedList 或同步列表在迭代它时仍然必须在外部同步。

如果您使用 ConcurrentLinkedQueue，则不会遇到这些问题。

```
Queue<Task> tasks = new ConcurrentLinkedQueue<Task>();
tasks.add(task); // thread safe
tasks.remove(task2); // thread safe

for(Task t: tasks) // can iterate without a CME. 
```

注意：如果您将队列与另一个线程一起使用，我建议您使用 ExecutorService，因为这将队列与 ThreadPool 结合在一起，使使用“后台”线程更容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T15:53:53.663

为什么不使用**LinkedBlockingQueue**？[http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/LinkedBlockingQueue.html](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/LinkedBlockingQueue.html)

顺便说一句，它不一定与同步有关。像这样的代码：

```
for(Value v : valuesList){
    valueslist.add(new Value());
} 
```

也会导致此异常。检查您的代码在迭代时可能对列表进行修改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T15:53:07.160

当您遍历列表并在循环体中向其中添加元素时，就会发生这种情况。当您使用`remove()`迭代器的方法时，您可以安全地删除元素，但不能通过调用`remove()`列表本身的任何方法。

解决方案是在迭代之前复制列表：

```
List<T> copy = new ArrayList<T>( list );
for( T e : copy ) {
    ... you can now modify "list" safely ...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T15:54:48.123

Java 集合是快速失败的，这意味着所有现有的迭代器在底层集合被修改的那一刻变得无效 - 同步修改不会阻止列表使所有迭代器失效。

作为一种解决方法，您可以创建列表的副本以迭代或推迟修改直到迭代完成。要删除条目，您还可以使用 iterator.remove() 方法来保持迭代器本身有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-13T15:49:56.190

```
List<X> myList = ....
List<X> myThreadSafeList = synchronizedList(myList); 
```

[同步列表（myList）](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#synchronizedList%28java.util.List%29)

请注意 JavaDoc 中的以下语句：

> 用户在迭代返回的列表时必须手动同步它：

```
List list = Collections.synchronizedList(new ArrayList());
    ...
synchronized(list) {
    Iterator i = list.iterator(); // Must be in synchronized block
  while (i.hasNext())
      foo(i.next());
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-22T07:36:37.253

答案在这里：[为什么我得到 java.util.ConcurrentModificationException？](https://stackoverflow.com/questions/18440445/why-am-i-getting-java-util-concurrentmodificationexception)帮了我很多。

我会将其复制并粘贴到此处，以防有人希望修复此错误：

当您遍历列表时，您无法从中删除项目。这样做会导致异常。

做：

```
int size = list.size();
for (int i = 0 ; i< size ; i++) {
   list.add(0,"art");
   list.remove(6);
   System.out.println(list);
} 
```

# ios - 我在哪里可以找到关于 Mach 内核消息传递的好文档

> ID：12410102
> 
> 赞同：7
> 
> 时间：2012-09-13T15:46:33.467
> 
> 标签：ios, macos, kernel, messaging

我正在寻找一些全面的东西来阅读

1) Mach 消息传递（mach_msg 函数和好友）

2）Mig系统（mig_get_reply_port函数和朋友）

我发现了以下内容：

a) 不同的开源（例如[http://opensource.apple.com/source/Libc/Libc-167/threads.subproj/mig_support.c](http://opensource.apple.com/source/Libc/Libc-167/threads.subproj/mig_support.c)）

b) 本文仅提供简要概述[http://hurdextras.nongnu.org/ipc_guide/mach_ipc_basic_concepts.html](http://hurdextras.nongnu.org/ipc_guide/mach_ipc_basic_concepts.html)

c) MacOS X 内部书 ( [http://www.amazon.com/Mac-OS-Internals-Systems-Approach/dp/0321278542](https://rads.stackoverflow.com/amzn/click/com/0321278542) )。我正在考虑购买它，但我需要的只是 10 页的 Mach 消息描述，因此我正在尝试寻找其他信息来源。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T22:30:30.187

首先，有 Apple 的开发者文档。[从 Mach 概述和内核编程指南](https://developer.apple.com/library/mac/#documentation/Darwin/Conceptual/KernelProgramming/Mach/Mach.html)中的以下部分开始（链接可能不会长时间保持良好状态；Apple 倾向于经常重组；另外，您可能更喜欢在 Xcode 中搜索而不是在线搜索）。从这里您还可以找到参考文档的链接。

还有很多来自学术来源的关于 Mach 的文档。从[CMU Mach 教程网站](http://www.cs.cmu.edu/afs/cs/project/mach/public/www/doc/tutorials.html)和[HURD 档案](http://www.shakthimaan.com/downloads/hurd/)开始，但也尝试搜索一对名为“A Programmer's Guide to Mach”的文章，我能够在两个不同的 .ps 格式的[FTP](ftp://www.cs.toronto.edu/doc/mach/) [档案](ftp://ftp.ibr.cs.tu-bs.de/docs/DistributedSystems/Mach/)中找到它们. 另外，我假设您看到链接到的 HURD 文档是较大指南的一部分（单击“General TOC”链接到达那里），但它仍然没有那么详细。

还有一些来自 Phrack（例如，[Developing MacOS X Kernel Rootkits](http://www.phrack.org/issues.html?issue=66&id=16)）或 Uninformed（例如，在 Mac OS X 上滥用 Mach）等​​来源的有趣内容，但请记住，大多数编写这些内容的人更喜欢通过逆向工程来学习所有内容，即使在公共文档很容易获得，这意味着它们有一些奇怪的术语和一些奇怪的知识空白。（更不用说他们并不真正关心某件事是应该做 X 还是碰巧做 X，只要 X 是他们可以利用的东西……）

# c# - 返回列表值列表（合并）

> ID：12410103
> 
> 赞同：3
> 
> 时间：2012-09-13T15:46:34.953
> 
> 标签：c#, asp.net, .net, list, foreach

我希望能够返回来自查询的所有“列表值”的列表。下面的“查询”从数据库返回多行结果，每行作为列表中的一个项目。从 db 返回的示例结果看起来像......

我放断点时的示例查询结果：（这是“查询”下方的第一行代码从数据库返回的内容）

> 1.  姓名 = 约翰；地址 = 1230, Ewded ; listOfCities = "纽约、CH、洛杉矶"
> 2.  姓名 = 埃里克；地址 = 12 , Ewded ; listOfCities = "BO, SE, OR"

代码：

```
 List<Index.Result> query = getresultsbackfromdb();
       // query content at this point looks like above 1,2 

        List<string> result = new List<string>();            

        foreach (var item in query)
        {      

            results.Add(item.listCities);

            //'results' list takes in string and not a list
            //How do I return a consolidated list of items

        }

        return result; // this should have ""NY, CH, LA, BO, SE, OR"
        //I am trying to get a list of all cities from 1,2 included in
        //one single list. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:29:59.443

a 中有一种方法`List`允许您添加多个项目

```
foreach (var item in query)
{      
    results.AddRange(item.listCities);  
} 
```

[List.AddRange 方法](http://msdn.microsoft.com/en-us/library/z883w3dc.aspx)的文档。

此外，以防万一您需要过滤掉一些重复的项目，您可以使用[`Distinct`](http://msdn.microsoft.com/en-us/library/bb348436.aspx)LINQ 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T15:50:54.570

您可以根据以下代码尝试此代码`Split Method`

```
var result = yourString.Split(',');

var input = "NY, CH, LA";
var result = input.Split(','); 
```

您可以将此值保存在`List<object>`

```
var list = new List<object>();
list.Add(result ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T15:53:00.853

你想要`AddRange`and`string.Split`方法

```
results.AddRange(string.Split(',', item.ListCities)); 
```

`string.Split`将在找到给定字符的任何位置将字符串拆分为一个数组，添加范围会将数组中的所有项目添加到列表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T15:54:33.897

试试这个：

```
var result = query.SelectMany(x => x.listOfCities.Split(',')); 
```

或使用

```
var result = query.SelectMany(x => x.listOfCities.Split(',')).Distinct(); 
```

获取没有重复的列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T16:16:48.627

如果你喜欢 Linq，那么你可以这样做：

```
using System.Linq;

List<string> result = query.SelectMany(s => s.listCities).ToList(); 
```

（这与 oleksii 的 AddRange 基本相同。）

# php - Symfony 2 为多个用户查找博客文章

> ID：12410105
> 
> 赞同：2
> 
> 时间：2012-09-13T15:46:48.553
> 
> 标签：php, symfony, doctrine-orm

我有 3 个表`user`：`user_followers`和`blog_posts`。用户可以关注其他用户，
并且用户与 相关`blog_post`。`user_id`

我需要获取我关注的人写的所有博客文章。
我试过类似的东西：

```
$followedUsers = $user->getFollowedByMe(); //This one works
$posts = $entityManager->getRepository('<BundleHere>:BlogPosts')
                       ->findBy(array('user_id' => $followedUsers)); 
```

我尝试了更多的变化，但无法弄清楚。也许有人知道一种更好的方法来搜索多个对象而不仅仅是一个对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:00:37.377

例如，您可以在 BlogRepository.php 中使用这种代码。

```
public function getBlogPost($userId)
{
    return $this
        ->_em
        ->createQueryBuilder('p')
        ->leftJoin('p.user', 'u')
        ->where('u.id = :id')
        ->setParameter('id', $userId)
        ->getQuery()
        ->getResult();
} 
```

createQueryBuilder('p') 将自动创建选择和来自（从表中选择实体（发布？））。然后，您可以像这样使用它：

```
$posts = $entityManager->getRepository('<BundleHere>:BlogPosts')->getBlogPost($userId); 
```

我无法为您提供确切的查询，因为我们没有关于您的实体的足够信息。但是通过这种方式，您可以编写很好的查询来获得您想要的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:10:59.440

你可以做：

```
$posts = $entityManager->getRepository('<BundleHere>:BlogPosts')
    ->createQueryBuilder('b')
    ->whereIn('b.user', $followedUsers)
    ->getQuery()
    ->getResult(); 
```

'user' 应该是用于在 Blogpost 对象中保存用户的属性的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T08:39:00.477

所以我想通了（谢谢大家用queryBuilder为我指出正确的方向）。

```
$followedByMe = $user->getFollowedByMe(); //Getting users i follow
$followedIds = $followedByMe
->map(function( $obj ) { //Using map method to create an array of id's for all followers
    return $obj->getId(); //Value to put into array (in this case id)
})->toArray(); //Create an array and assign it to $followedIds variable

$qb = $em->getRepository('<BundleHere>:BlogPosts')->createQueryBuilder('b');
$posts = $qb->where($qb->expr()->in('b.user', $followedIds ))
->orWhere('b.user = :my_id')->setParameter('my_id', $user->getId()) //Get my posts too
->getQuery()
->getResult(); 
```

# c# - 从 SQL Server 数据库插入和返回图像

> ID：12410108
> 
> 赞同：0
> 
> 时间：2012-09-13T15:46:57.700
> 
> 标签：c#, asp.net-mvc, sql-server-2008

我正在尝试使用 ASP.NET MVC3 和 C# 将图像插入 SQL Server 数据库。

有人可以在这里给我一个好的教程或答案吗？我正在寻找诸如控制器、模型和视图之类的东西！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T15:51:19.553

这里是如何做到这一点：[Storing and Retrieving Images from SQL Server Using Stred Procedures and C#.net](http://www.codeproject.com/Articles/354639/Storing-and-Retrieving-Images-from-SQL-Server-Usin)

# header - CSS整页宽度标题

> ID：12410110
> 
> 赞同：0
> 
> 时间：2012-09-13T15:47:02.267
> 
> 标签：header

嘿，我有一个小问题，我有一个完整的页面标题，但是当我放大或缩小屏幕尺寸并滑动时。它不是完整的页面宽度，它只是留下空白。可能会跟随 css 代码。

```
.header {
background:#242424 repeat-x;
color:#ffffff;
width:100%;
height:74px;
font-family: 'Karla', cursive;
font-weight:bold;
font-size:15px; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:28:06.917

问题是由您的`<div class="medium-cont"></div>`标签引起的。

您在导致问题的 CSS 中将其宽度设置为 1400px。

您不需要使用此元素，而是设置`.medium-back`.

```
<div class="medium-back">
    <div class="register"></div>
    <div class="medium-cont"></div> <!-- Remove this line -->
</div> 
```

`.medium-back`将您的样式更改为：

```
.medium-back {
    background: #19D89B url(images/medium-content.png) no-repeat;
    height: 475px;
    margin: 0 auto;
} 
```

然后删除最外层元素上的任何其他`width:100%;`样式。

# python - 在计算机之间迁移 virtualenv 和 Github

> ID：12410113
> 
> 赞同：8
> 
> 时间：2012-09-13T15:47:21.483
> 
> 标签：python, git, github, virtualenv

这些天我主要使用 Python 2.7 和 Django 1.3.3（托管在 Heroku 上）工作，并且我维护了多个项目。我一直在使用在 VirtualBox 中运行 Ubuntu 的桌面上工作，但最近不得不去旅行，想把所有东西都加载到我的笔记本上。但是，我很快发现 virtualenv + Github 非常容易创建项目，但我努力尝试将它们转移到我的笔记本上。我想出的方法是创建新的 virtualenv，然后从 github 克隆代码。但是，我无法在我真正想要的文件夹中执行此操作，因为它会说该文件夹不为空。所以，我会将它克隆到一个 tmp 文件夹，而不是他们将所有内容剪切/粘贴到我真正想要的位置。不可怕，但我只是觉得我 我在这里遗漏了一些东西，应该更容易。也许先克隆，然后是 mkvirtualenv？

这不是一个严重的问题，但我正在考虑进行更多更改（例如使用 VirtualBox 并使用双启动系统），如果我可以让它更顺畅一些，那就太好了。:)

最后，我找到并阅读了一些关于在计算机之间移动 git repos 的帖子，但我没有看到任何与 Virtualenv 的交易（也许我只是错过了它）。

编辑：为了清楚起见并避免混淆，我不会尝试“移动”virtualenv。我只是在谈论创建新方法的最佳方法。安装软件包，然后从 github 克隆 repo。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-13T15:57:03.863

您应该需要的唯一工作流程是：

```
git clone repo_url somedir
cd somedir
virtualenv <name of environment directory>
source <name of environment directory>/bin/activate
pip install -r requirements.txt 
```

这假设您已运行`pip freeze > requirements.txt`（在激活 venv 时）列出所有 virtualenv-pip-installed 库并将其签入 repo。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-13T15:54:24.307

那是因为您甚至不应该将 virtualenvs 移动到一个系统上的不同位置（有重定位支持，但它是实验性的），更不用说从一个系统到另一个系统了。创建一个新的虚拟环境：

*   在另一个系统上安装 virtualenv
*   获取 a `requirements.txt`，或者通过写一个或者通过存储`pip freeze`（和编辑输出）的输出
*   将 requirements.txt 移动到另一个系统，创建一个新的 virtualenv，然后通过`pip install -r requirements.txt`.
*   在另一个系统上克隆 git 存储库

对于更高级的需求，您可以创建一个包含 virtualenv + 自定义代码的引导脚本来设置其他任何内容。

编辑：将 virtualenv 的根目录和存储库的根目录放在同一个目录中对我来说似乎是一个非常糟糕的主意。将存储库放在 virtualenv 根目录内的目录中，或者将它们放入完全独立的树中。您不仅可以避免 git（理所当然地——通常情况下，git 未跟踪的所有内容都可以删除）抱怨现有文件，还可以将 virtualenv 用于多个存储库并避免名称冲突。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T15:54:02.883

除了编写脚本创建一个新的 virtualenv 之外，您还应该创建一个包含所有依赖项（例如 Django1.3）的 requirements.txt 文件，然后您可以运行`pip install -r requirements.txt`它，这将为您安装所有依赖项。

您甚至可以让 pip 为您创建它，`pip freeze > stable-req.txt`这将打印出您当前 virtualenv 中的依赖项。然后，您可以将 requirements.txt 保留在版本控制之下。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T15:51:12.530

virtualenv 的好处是您可以描述如何制作它，并且可以在多个平台上重复制作它。

因此，与其克隆整个事物，不如克隆一个方法来一致地创建 virtualenv，并将其保存在您的 git 存储库中。这样您就可以避免特定于平台的麻烦。

# c# - 将大型虚拟文件从 C# 拖放到 Windows 资源管理器

> ID：12410114
> 
> 赞同：5
> 
> 时间：2012-09-13T15:47:21.907
> 
> 标签：c#, com, drag-and-drop

我有一个 C# WPF 应用程序，其中一个部分用作 FTP 客户端，列出远程服务器上的文件并允许用户下载它们。我希望用户能够将文件从文件列表拖放到他们自己的机器上（即进入 Windows 资源管理器外壳）。

为此，我使用了[Delay 博客中的 VirtualFileDataObject 代码](http://blogs.msdn.com/b/delay/archive/2009/10/26/creating-something-from-nothing-developer-friendly-virtual-file-implementation-for-net.aspx)`Action<Stream>`，使用`SetData`. 这适用于较小的文件。

我的问题是：我正在处理的一些文件非常大（2+ GB），并且`VirtualFileDataObject`该类处理流的方式涉及将整个内容读入内存，这最终可能会引发“存储空间不足”错误对于那些非常大的文件。

代码的相关部分`VirtualFileDataObject`如下。**如何重写此代码以不需要整个流都在内存中？**

```
 public void SetData(short dataFormat, int index, Action<Stream> streamData) {
        _dataObjects.Add(
            new DataObject {
                FORMATETC = new FORMATETC {
                    cfFormat = dataFormat,
                    ptd = IntPtr.Zero,
                    dwAspect = DVASPECT.DVASPECT_CONTENT,
                    lindex = index,
                    tymed = TYMED.TYMED_ISTREAM
                },
                GetData = () => {
                    // Create IStream for data
                    var ptr = IntPtr.Zero;
                    var iStream = NativeMethods.CreateStreamOnHGlobal(IntPtr.Zero, true);
                    if (streamData != null) {
                        // Wrap in a .NET-friendly Stream and call provided code to fill it
                        using (var stream = new IStreamWrapper(iStream)) {
                            streamData(stream);
                        }
                    }
                    // Return an IntPtr for the IStream
                    ptr = Marshal.GetComInterfaceForObject(iStream, typeof(IStream));
                    Marshal.ReleaseComObject(iStream);
                    return new Tuple<IntPtr, int>(ptr, NativeMethods.S_OK);
                },
            });
    } 
```

特别是，这部分`GetData`是罪魁祸首：

```
// Wrap in a .NET-friendly Stream and call provided code to fill it
using (var stream = new IStreamWrapper(iStream)) {
    streamData(stream);
} 
```

`streamData`是`Action<stream>`我提供的将实际文件数据写入流的。我的代表只是打开一个文件并将字节读入提供的流中。

有没有办法避免这最后一步，也许以某种方式直接传递文件流以供 Explorer shell 读取？我正在考虑`iStream`用一个指向我所拥有的.NET 文件流的指针来替换......但我对 COM 互操作知之甚少，甚至不知道这样做的语法。任何提示/方向将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T19:25:46.950

经过更多的谷歌搜索和跌跌撞撞并尝试一件事又一件事后，我得到了一些可行的方法，但我仍然对更好的解决方案持开放态度。现在，当放置操作发生时，我将文件检索到一个临时位置，然后使用[`SHCreateStreamOnFileEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb759866%28v=vs.85%29.aspx)打开一个`IStream`到该位置。修改后的部分，`GetData`lambda，如下：

```
GetData = () => {
    var filename = getFilename();

    IStream stream = null;
    NativeMethods.SHCreateStreamOnFileEx(filename, NativeMethods.STGM_FAILIFTHERE, NativeMethods.FILE_ATTRIBUTE_NORMAL, false, null, ref stream);
    var ptr = Marshal.GetComInterfaceForObject(stream, typeof(IStream));
    Marshal.ReleaseComObject(stream);
    return new Tuple<IntPtr, int>(ptr, NativeMethods.S_OK);
} 
```

正如我所说，我不知道这是否是最好的方法，或者我是否可以更干净地管理它，但这似乎有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-06T10:57:45.780

我遇到了同样的问题，但很容易解决；）

问题是我们正在创建一个新的内存流，而它不是必需的，因为我们已经有了我们的。您可以在 c# 中创建一个实现 IStream 的 Stream 包装器：

```
 /// <summary>
/// Simple class that exposes a read-only Stream as a IStream.
/// </summary>
private class StreamWrapper : IStream
{

   private Stream _stream;

   public StreamWrapper(Stream stream)

   {
       _stream = stream;
   }

   public void Read(byte[] pv, int cb, System.IntPtr pcbRead)

   {
       Marshal.WriteInt32(pcbRead, _stream.Read(pv, 0, cb));
   }

   public void Seek(long dlibMove, int dwOrigin, System.IntPtr plibNewPosition)

   {
       Marshal.WriteInt32(plibNewPosition, (int)_stream.Seek(dlibMove, (SeekOrigin)dwOrigin));
   }

   public void Clone(out IStream ppstm)

   {
       throw new NotImplementedException();
   }

   public void Commit(int grfCommitFlags)

   {
       throw new NotImplementedException();
   }

   public void CopyTo(IStream pstm, long cb, IntPtr pcbRead, IntPtr pcbWritten)

   {
       throw new NotImplementedException();
   }

   public void LockRegion(long libOffset, long cb, int dwLockType)

   {
       throw new NotImplementedException();
   }

   public void Revert()

   {
       throw new NotImplementedException();
   }

   public void SetSize(long libNewSize)

   {
       throw new NotImplementedException();
   }

   public void Stat(out System.Runtime.InteropServices.ComTypes.STATSTG pstatstg, int grfStatFlag)

   {
       throw new NotImplementedException();
   }

   public void UnlockRegion(long libOffset, long cb, int dwLockType)

   {
       throw new NotImplementedException();
   }

   public void Write(byte[] pv, int cb, IntPtr pcbWritten)

   {
       throw new NotImplementedException();
   }
} 
```

然后在 VirtualFileDataObject 类中，更改 SetData 方法的签名，以便您现在传递一个 Stream：

```
public void SetData(short dataFormat, int index, Stream stream)
{
  ...
  var iStream = new StreamWrapper(stream);
  ...
  // Ensure the following line is commented out:
  //Marshal.ReleaseComObject(iStream);
  return new Tuple<IntPtr, int>(ptr, NativeMethods.S_OK);
 ...
} 
```

现在，不会创建新的内存流。

有关更多信息，请访问[http://blogs.msdn.com/b/delay/archive/2009/11/04/creating-something-from-nothing-asynchronously-developer-friendly-virtual-file-implementation-for- net-improved.aspx#10496772](http://blogs.msdn.com/b/delay/archive/2009/11/04/creating-something-from-nothing-asynchronously-developer-friendly-virtual-file-implementation-for-net-improved.aspx#10496772)并阅读我的评论

# javascript - 覆盖外部 java 脚本文件的 css 属性无法正常工作

> ID：12410115
> 
> 赞同：1
> 
> 时间：2012-09-13T15:47:23.690
> 
> 标签：javascript, jquery, css

我正在尝试覆盖外部 java 脚本文件中元素的样式。

如果我将此代码粘贴到本地文件中：

```
<script type="text/javascript" charset="utf-8" src="http://static.polldaddy.com/p/6343621.js"></script>
<noscript><a href="http://polldaddy.com/poll/6343621/">New Poll</a></noscript>

<style>
.pds-links {
    display: inline !important;
}
</style> 
```

并在 Google chrome 中运行我在检查类 '.pds-links' 时收到此错误：

![在此处输入图像描述](../Images/508db59d4ea4b2338f9cd21f7c33df5d.png)

css 属性是正确的，因为当我在小提琴中运行此代码时，所有元素都内联显示：http: [//jsfiddle.net/YsEmj/](http://jsfiddle.net/YsEmj/)

如何成功覆盖 .pds-links 样式的“显示”属性？发生这种情况的原因是在 .css 属性可以应用于它之前加载 javascript 文件，如果是这种情况，我是否需要使用 jQuery 来更新样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:13:25.180

The poll script is adding a `style` tag to the end of the `head`. If your stylesheet comes before it, and their style also specifies `!important` it will override your style.

Here's the gunk the script is adding:

```
<style type="text/css" id="poll_style6343621">#PDI_container6343621 .pds-box{font-family: Helvetica, Arial, sans-serif;background: #fff;border: 1px solid #ccc;width: 300px;font-size: 12px;text-align: left;color: #4e4e4e;-webkit-border-radius: 12px;-moz-border-radius: 12px;border-radius: 12px;} #PDI_container6343621 .pds-box A{outline: none;} #PDI_container6343621 .pds-clear{display: block;clear: both;} #PDI_container6343621 .pds-box-outer{padding: 12px;} #PDI_container6343621 .pds-question-top{font-size:14px;line-height: 120%;color: #333;font-weight: bold;padding: 5px 0px 15px 0px;position:relative;} #PDI_container6343621 .pds-answer{padding: 10px 0px 10px 0px;border-top: 1px solid #e8e8e8;border-bottom: 1px solid #e8e8e8;} #PDI_container6343621 .pds-answer label{color: #333;font-size: 13px;line-height: 150%;position: relative;} #PDI_container6343621 .pds-answer-group{display: block;padding: 8px 0px 8px 0px;} #PDI_container6343621 .pds-answer-group BR{display: none;} #PDI_container6343621 .pds-answer-input{display: block;float:left;width: 25px;} #PDI_container6343621 .pds-input-label{display: block;float:left;width: 245px;cursor: pointer;} #PDI_container6343621 .pds-answer-other{padding: 0px 0px 0px 10px;} #PDI_container6343621 .pds-textfield{background: #FFF;border: 1px solid #d1d1d1;font-size: 12px;padding: 2px;width: 150px;} #PDI_container6343621 .pds-answer-other BR{display: none;} #PDI_container6343621 .pds-other-label{display: block;float:left;cursor: pointer;} #PDI_container6343621 .pds-feedback-group{display: block;padding: 8px 0px 8px 0px;} #PDI_container6343621 .pds-feedback-label{display: block;padding: 0px 0px 5px 0px;} #PDI_container6343621 .pds-feedback-result {float:right;} #PDI_container6343621 .pds-answer-text {float:left} #PDI_container6343621 .pds-feedback-per{font-weight: bold;} #PDI_container6343621 .pds-feedback-votes{font-weight: normal;} #PDI_container6343621 .pds-answer-feedback {background-color: #f1f1f1;border: 1px solid #d1d1d1;position: relative;} #PDI_container6343621 .pds-answer-feedback-bar {font-size: 2px;background: #3478e3;height: 18px;} #PDI_container6343621 .pds-vote {padding: 10px 0px;} #PDI_container6343621 .pds-votebutton-outer {} #PDI_container6343621 .pds-vote BR{display: none;} #PDI_container6343621 .pds-vote-button {color: #464646;padding: 3px 25px;white-space: nowrap;background:#F2F2F2 url(http://s3.wordpress.com/wp-admin/images/white-grad.png) repeat-x scroll left top;-webkit-border-radius: 11px;-moz-border-radius:11px;border-radius: 11px;border: 1px solid #999;cursor: pointer;font-size: 12px;font-family: "Lucida Grande",Verdana,Arial;text-decoration: none;line-height: 25px;font-weight: bold;white-space: nowrap;} #PDI_container6343621 .pds-vote-button:hover{border: 1px solid #333;} #PDI_container6343621 .pds-vote-button-load {color: #464646;padding: 3px 25px;white-space: nowrap;-webkit-border-radius: 11px;-moz-border-radius:11px;border-radius: 11px;border: 1px solid #999;cursor: pointer;font-size: 12px;font-family: "Lucida Grande",Verdana,Arial;text-decoration: none;line-height: 25px;font-weight: bold;white-space: nowrap;background:#EEE url(http://i.polldaddy.com/polls/vote-loader-eeeeee.gif) no-repeat scroll 50% 50%;} #PDI_container6343621 .pds-vote-button-load SPAN{visibility: hidden;} #PDI_container6343621 .pds-links {padding: 10px 0px 0px 0px;display: block;text-align: center;} #PDI_container6343621 .pds-links-back {padding: 10px 0px 0px 0px;display: block;text-align: center;} #PDI_container6343621 .pds-links A {font-family: Helvetica, Arial, sans-serif;font-size:12px;color: #4e4e4e;text-decoration: none;padding: 0px 4px 0px 4px;line-height: 24px;display: inline-block;font-weight: bold;} #PDI_container6343621 .pds-links-back A {font-family: Helvetica, Arial, sans-serif;font-size:12px;color: #4e4e4e;text-decoration: none;padding: 0px 4px 0px 4px;line-height: 24px;display: inline-block;font-weight: bold;} #PDI_container6343621 .pds-links A:hover {text-decoration: underline;} #PDI_container6343621 .pds-links-back A:hover {text-decoration: underline;} #PDI_container6343621 .pds-comments SPAN{font-weight: normal;} #PDI_container6343621 .pds-total-votes{padding: 10px 0px 0px 0px;position: relative;} #PDI_container6343621 .pds-total-votes SPAN{font-weight: bold;} #PDI_container6343621 div {margin:0;padding:0;}</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T08:50:16.120

我通过覆盖样式生成的所有值来实现这一点。该脚本生成此样式：

```
.pds-links {padding: 10px 0px 0px 0px;display: block;text-align: center;} 
```

使用此样式会导致所有项目都显示为 inline ：

```
.pds-links {padding: 10px 0px 0px 0px;display: inline !important; text-align: center;} 
```

我不确定为什么当我只覆盖显示属性时没有使用该样式：.pds-links`{ display: inline !important; }`我可能会单独提出一个问题来解决这个问题。

# java - 视频流背后的基本概念

> ID：12410121
> 
> 赞同：0
> 
> 时间：2012-09-13T15:47:34.533
> 
> 标签：java, audio, video, streaming, webcam

谁能告诉我流媒体的基本步骤。就像从网络摄像头获取视频流并将其发送到网页一样。我想用java编程。只需要了解流是如何完成的。比如数据是如何存储和发送的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:42:54.103

Wikipedia 文章部分[Streaming media: Codec, bitstream, transport, control](http://en.wikipedia.org/wiki/Streaming_media#Codec.2C_bitstream.2C_transport.2C_control)应该是理想的起点，因为它很好地回答了您的问题，并提供了所用技术的链接以供进一步参考。

# python - OS X Python 脚本 - 如何在后台启动它？

> ID：12410122
> 
> 赞同：0
> 
> 时间：2012-09-13T15:47:38.677
> 
> 标签：python, macos, background, pyobjc

> **可能重复：**
> [在 OS X 的后台运行 Python](https://stackoverflow.com/questions/9522324/running-python-in-background-on-os-x)

我有一个不错的 python 脚本，可以在后台启动。我希望它可以在 OS X 上运行。我不知道该怎么做。我通过在终端中启动“python myscript.py &”找到了一种解决方案，但这并不是真正在后台运行。我听说过很多关于守护进程的事情，但我真的不知道如何在这个小脚本中实现它，而不调用非本地库。

这是脚本：

```
#!/usr/bin/python2.6

from Cocoa import *
from Foundation import *
from PyObjCTools import AppHelper
import keycode
import string
import sys
global TABLE
TABLE = []

class AppDelegate(NSObject):
    def applicationDidFinishLaunching_(self, aNotification):
        NSEvent.addGlobalMonitorForEventsMatchingMask_handler_(NSKeyDownMask, handler)

def handler(event):
    global TABLE
    if event.type() == NSKeyDown and keycode.tostring(event.keyCode()) in string.printable:
        key =  keycode.tostring(event.keyCode())
        TABLE.append(key)
        print "lol"
        print TABLE
        if len(TABLE) > 10:
            for letter in TABLE:
                log = open("Analyzed.txt", "a")
                log.write(letter)
                log.close()
            TABLE = []

def main():
    app = NSApplication.sharedApplication()
    delegate = AppDelegate.alloc().init()
    NSApp().setDelegate_(delegate)
    AppHelper.runEventLoop()

if __name__ == '__main__':
   main() 
```

我试过了：

```
#!/usr/bin/env python

import sys, time
from daemon import Daemon
from Cocoa import *
from Foundation import *
from PyObjCTools import AppHelper
import keycode
import string
import sys
global TABLE
TABLE = []

class MyDaemon(Daemon):
        def run(self):

            class AppDelegate(NSObject):
                def applicationDidFinishLaunching_(self, aNotification):
                    NSEvent.addGlobalMonitorForEventsMatchingMask_handler_(NSKeyDownMask, handler)

            def handler(event):
                global TABLE
                if event.type() == NSKeyDown and keycode.tostring(event.keyCode()) in string.printable:
                    key =  keycode.tostring(event.keyCode())
                    TABLE.append(key)
                    print "lol"
                    print TABLE
                    if len(TABLE) > 10:
                        for letter in TABLE:
                            log = open("LOG_KEY.txt", "a")
                            log.write(letter)
                            log.close()
                        TABLE = []

            app = NSApplication.sharedApplication()
            delegate = AppDelegate.alloc().init()
            NSApp().setDelegate_(delegate)
            AppHelper.runEventLoop()

if __name__ == "__main__":
        daemon = MyDaemon('/tmp/carto_daemon.pid')
        if len(sys.argv) == 2:
                if 'start' == sys.argv[1]:
                        daemon.start()
                elif 'stop' == sys.argv[1]:
                        daemon.stop()
                elif 'restart' == sys.argv[1]:
                        daemon.restart()
                else:
                        print "Unknown command"
                        sys.exit(2)
                sys.exit(0)
        else:
                print "usage: %s start|stop|restart" % sys.argv[0]
                sys.exit(2) 
```

守护进程来自哪里[http://www.jejik.com/articles/2007/02/a_simple_unix_linux_daemon_in_python/](http://www.jejik.com/articles/2007/02/a_simple_unix_linux_daemon_in_python/)

但是python似乎崩溃了......

# iphone - 使用 AVAssetExportSession 旋转 AVAsset

> ID：12410130
> 
> 赞同：8
> 
> 时间：2012-09-13T15:48:26.590
> 
> 标签：iphone, ipad, core-graphics, core-video

我正在尝试使用 an 将视频旋转到正确的方向`AVAssetExportSession`，但总是出现以下错误：

```
Error Domain=AVFoundationErrorDomain Code=-11841 "The operation couldn’t be completed. (AVFoundationErrorDomain error -11841.)" 
```

这意味着，`AVErrorInvalidVideoComposition`但我看不出我的视频作品有什么问题。这是代码：

```
AVAssetTrack *sourceVideo = [[avAsset tracksWithMediaType:AVMediaTypeVideo] lastObject];
AVAssetTrack *sourceAudio = [[avAsset tracksWithMediaType:AVMediaTypeAudio] lastObject];
CGAffineTransform preferredTransform = [sourceVideo preferredTransform];

AVMutableComposition *composition = [[AVMutableComposition alloc] init];

AVMutableCompositionTrack *compositionVideoTrack = [composition addMutableTrackWithMediaType:AVMediaTypeVideo
                                                                            preferredTrackID:kCMPersistentTrackID_Invalid];

AVAssetExportSession *exporter = [[[AVAssetExportSession alloc] initWithAsset:composition presetName:AVAssetExportPresetMediumQuality] autorelease];

[compositionVideoTrack insertTimeRange:CMTimeRangeMake(kCMTimeZero, avAsset.duration)
                               ofTrack:sourceVideo
                                atTime:kCMTimeZero
                                 error:nil];

if( !CGAffineTransformIsIdentity(preferredTransform) ) {

    AVMutableVideoComposition *videoComposition = [AVMutableVideoComposition videoComposition];
    videoComposition.renderSize = CGSizeMake([avAsset naturalSize].height, [avAsset naturalSize].width);
    videoComposition.frameDuration = CMTimeMake(1, compositionVideoTrack.naturalTimeScale);

    AVMutableVideoCompositionLayerInstruction *instruction = [AVMutableVideoCompositionLayerInstruction videoCompositionLayerInstructionWithAssetTrack:sourceVideo];
    [instruction setTransform:preferredTransform atTime:kCMTimeZero];

    AVMutableVideoCompositionInstruction *videoTrackInstruction = [AVMutableVideoCompositionInstruction videoCompositionInstruction];
    videoTrackInstruction.timeRange = CMTimeRangeMake(kCMTimeZero, avAsset.duration);
    videoTrackInstruction.layerInstructions = [NSArray arrayWithObject:instruction];

    [videoComposition setInstructions:[NSArray arrayWithObject:videoTrackInstruction]];

    exporter.videoComposition = videoComposition;
}

AVMutableCompositionTrack *compositionAudioTrack = [composition addMutableTrackWithMediaType:AVMediaTypeAudio
                                                                            preferredTrackID:kCMPersistentTrackID_Invalid];

[compositionAudioTrack insertTimeRange:CMTimeRangeMake(kCMTimeZero, avAsset.duration)
                               ofTrack:sourceAudio
                                atTime:kCMTimeZero
                                 error:nil];

exporter.outputURL = tempPathUrl;
exporter.outputFileType = AVFileTypeQuickTimeMovie;
[exporter exportAsynchronouslyWithCompletionHandler:^{ }]; 
```

组合可能有什么问题？我已经阅读了文档，到目前为止看不到任何问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-02T15:33:12.753

我认为这是因为宽度和高度参数的顺序不正确。你有：

```
 videoComposition.renderSize = CGSizeMake([avAsset naturalSize].height, [avAsset naturalSize].width); 
```

难道不应该

```
 videoComposition.renderSize = CGSizeMake([avAsset naturalSize].width, [avAsset naturalSize].height); 
```

反而？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T19:02:41.243

这可能与您的帧持续时间有关。您正在使用 `CMTimeMake(1, naturalTimeScale)`
您应该检查 naturalTimeScale 因为它并不总是等于 fps。有关更多信息，请参阅[AVFoundation 编程指南](http://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/05_MediaRepresentations.html)“时间表示”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-15T05:58:38.667

错误来自您的设置方式`instruction`。

```
... videoCompositionLayerInstructionWithAssetTrack:sourceVideo] 
```

`sourceVideo`不是组合的成员。在你的情况下，这应该是`compositionVideoTrack`.

# objective-c - 挂起 mergeChangesFromContextDidSaveNotification （和合并冲突）

> ID：12410131
> 
> 赞同：1
> 
> 时间：2012-09-13T15:48:31.913
> 
> 标签：objective-c, ios, core-data, nsmanagedobjectcontext

**总结：**当我`[myMOC mergeChangesFromContextDidSaveNotification:notification]`在多线程场景中调用时，我的应用程序挂起。

详细情况是这样的：

我的应用程序从服务器下载一大堆数据，并在首次启动时将其存储在 Core Data 中。它分为几个部分。解析整个事情需要几秒钟，大部分时间都花在了其中的两个块上。所以为了加快速度，我已经并行化了这两个块。这是它的样子：

```
NSArray *arr = [self parseJsonData:downloadedNSData]; //turns NSData into JSON array
                     //using NSJSONSerialization
NSMutableArray __block *first = [[NSMutableArray alloc]init];
NSMutableArray __block *second = [[NSMutableArray alloc]init];

//put half of arr in first and half in second with a loop

dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
dispatch_group_t group = dipatch_group_create(); 
dispatch_group_async(group, queue, ^
   {
      for (id element in first)
      {
         [MyDataClass parseData:element]; //create NSManagedObject subclass, save
      }
      [self saveContext];
   });

    dispatch_group_async(group, queue, ^
   {
      for (id element in second)
      {
         [MyDataClass parseData:element]; //create NSManagedObject subclass, save
      }
      [self saveContext];
   });

  dispatch_group_wait(group, DISPATCH_TIME_FOREVER); 
```

`[self saveContext]`呼吁`save`MOC。这当然是在多个线程上完成的，所以我需要`ManagedObjectContext`为每个线程创建一个单独的。这是通过通过此对象 ( `self`) 上的属性公开 MOC 来实现的，该属性维护一个`NSMutableDictionary`线程名称 (call `description`on `NSThread`) 给`NSManagedObjectContext`s。访问时，如果没有 的 MOC `[NSThread currentThread]`，它会创建一个新的，将其添加到字典中并存储它。创建每个 MOC 时，我都会订阅其更改通知：

```
NSNotificationCenter *center = [NSNotificationCenter defaultCenter];
[center addObserver:self selector:@selector(mergeChanges:)
      name:NSManagedObjectContextDidSaveNotification object:createdMOC]; 
```

在`mergeChanges`中，我遍历我的上下文字典并调用`mergeChangesFromContextDidSaveNotification`所有上下文字典，除了发生这种情况的线程的字典。更具体地说，我`[performSelector:onThread:withObject:waitUntilDone:]`曾经让每个 MOC 在为其创建的线程上执行此操作。

我也在使用`NSLock`the`[myMOC save]`和 my`mergeChanges`方法进行锁定。如果我没有锁定这些，我会得到“Cocoa error 133020”，这[显然](https://stackoverflow.com/a/4628593/412107)意味着合并更改时出错。

所以，这就是我的日志记录告诉我正在发生的事情：

*   线程 1 获取要保存的锁并开始保存
*   合并上下文通知出现在线程 1 上。线程 1 获取用于合并更改的锁并开始该过程。它为主线程合并 MOC 的更改，然后在为后台线程执行 MOC 之一时挂起。
*   线程 2 开始保存但从未获得保存锁，因为另一个线程在尝试合并更改时被卡住了。

那么，为什么在合并更改时它会挂起？有没有更好的方法来处理这种情况？

**更新：**我尝试`[persistentStoreCoordinator lock]`在我的`[MOC save]`通话中使用而不是仅使用 锁定`NSLock`，但无济于事。我还尝试在其中一个`[NSThread sleepForTimeInterval:2]`调用中添加调用，但没有帮助。`[self saveContext]``dispatch_group_async`

**更新 2：**也许这里更好的问题是为什么我会遇到合并冲突（Cocoa 错误 133020）。这是预期的吗？我是否正确进行了合并（合并到除了一个保存之外的所有上下文）？

**更新 3：**我发布了[另一个问题](https://stackoverflow.com/questions/12466823/core-data-multithreading-code-examples)，以解决我如何进行多线程处理的更大背景。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:07:07.300

创建`NSManagedObject`子类时，会将其插入上下文中，因此只能在属于上下文的队列/线程上执行此操作。

调用`-save`上下文也是如此。

在我看来，从您的代码中您正在插入两个对象——每个对象都在它们自己的线程上。这是行不通的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-26T16:24:26.117

我已经发布了[这个问题](https://stackoverflow.com/questions/12466823/core-data-multithreading-code-examples)，以更好地记录我的情况。我认为当前的这个问题范围有点窄。

# javascript - HTML5 视频：如何测试 HLS 播放能力？(video.canPlayType)

> ID：12410132
> 
> 赞同：23
> 
> 时间：2012-09-13T15:48:33.090
> 
> 标签：javascript, html, http-live-streaming

我有通过 HLS 传送的视频。现在我想用 JavaScript 测试设备是否真的可以播放 HTML5 中的 HLS 视频。

通常在 Javascript 中我做了类似的事情 `document.createElement('video').canPlayType('video/mp4')` 但是我不知道哪种“类型”是 HLS 的正确类型。

[Apple 的 Safari HTML5 Audio and Video Guide](https://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/AudioandVideoTagBasics/AudioandVideoTagBasics.html#//apple_ref/doc/uid/TP40009523-CH2-SW21)似乎建议使用“vnd.apple.mpegURL”（“Listing 1-7 Falling back to a plug-in for IE”）

```
<video controls>
    <source src="HttpLiveStream.m3u8" type="vnd.apple.mpegURL">
    <source src="ProgressiveDowload.mp4" type="video/mp4">
.... 
```

但`canPlayType("vnd.apple.mpegURL")`即使在可以完美播放实际 HLS 流的 iOS 设备上也返回一个空字符串。

有没有办法在没有“外部知识”的情况下检查播放功能（例如“检查 iOS 用户代理并假设它可以播放 hls”）？

我知道我可以在一个元素中指定多个来源，并且浏览器将使用第一个可播放的来源。但是在我的情况下，我需要向 JW Player 提供一个我无法修改的 URL。所以不知何故，我需要从一组视频编码中找到“最佳可播放 URL”。（不过，一个处理源选择的开源 JS 库将是一个很好的解决方法。）

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-15T22:52:39.850

我没有对此进行全面测试，但看起来您应该测试完整的 HLS mimetype`application/vnd.apple.mpegURL`而不仅仅是`vnd.apple.mpegURL`.

`application/x-mpegURL`并且`audio/mpegurl`也是 HLS m3u8 文件的合适 mimetypes。 `audio/x-mpegurl`根据 Apple 的说法，它也被列为可接受的 mimetype，但在实际的 HLS 草案规范中似乎没有提及。

在 iOS 和 OS X 上的 Safari 中，

```
document.createElement('video').canPlayType('application/vnd.apple.mpegURL') 
```

返回`maybe`。我不确定是否有任何其他浏览器支持 HLS——Android 似乎不喜欢这种语法（尽管我看到了一些相反的断言），我相信这可能是因为实际的视频播放被委托给外部应用程序，而不是浏览器本身。

## 参考：

1.  [http://developer.apple.com/library/ios/#technotes/tn2235/_index.html](http://developer.apple.com/library/ios/#technotes/tn2235/_index.html)
2.  [http://www.longtailvideo.com/html5/hls](http://www.longtailvideo.com/html5/hls)
3.  [https://datatracker.ietf.org/doc/html/draft-pantos-http-live-streaming-03](https://datatracker.ietf.org/doc/html/draft-pantos-http-live-streaming-03)
4.  [http://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Using_HTML5_Audio_Video.pdf](http://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Using_HTML5_Audio_Video.pdf)

# javascript - Jquery 全局事件和动态添加的内容

> ID：12410136
> 
> 赞同：0
> 
> 时间：2012-09-13T15:48:51.810
> 
> 标签：javascript, jquery, events

我正在尝试将我自己的自定义事件触发为全局事件，以便我页面上的任何内容都可以收听它们并做出反应，但是，对于动态添加的内容，它不起作用。请参阅我的小提琴：http: [//jsfiddle.net/6TMkG/8/](http://jsfiddle.net/6TMkG/8/)

据我了解，对于 jQuery 知道的页面中的任何元素都会触发该事件，并且它似乎不会触发`li`'s 的事件，即使它们确实有一个处理程序。

任何人都知道如何解决这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T15:54:58.457

如果你想要全局事件，那么你可以在文档上绑定事件处理程序，并在文档中的任何元素上触发它。

```
$(document).on('randomEvent', callback);

$('ul').click(function() {
  $(this).trigger("randomEvent");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:07:21.280

试试这个

```
$("#b2").click(function() {
        //$.event.trigger("randomEvent");
        $('li').trigger('randomEvent');
    }); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-13T15:54:06.447

抱歉，我完全错过了..我没有看到您问题的第一部分..自定义事件..看起来您正在关联 randomEvent 但与它相关联时您没有触发该事件..

确保在 Document.Ready 函数中添加触发器事件，以便 evnet 处理程序与元素可用时相关联。

# c1-cms - 在数据透视图中对数据进行排序（复合 C1）

> ID：12410138
> 
> 赞同：1
> 
> 时间：2012-09-13T15:48:54.900
> 
> 标签：c1-cms

我在“数据”透视图的“页面数据文件夹”内创建了一个自定义数据类型。因此，我已将此数据文件夹添加到页面中，并且我正在使用它来毫无问题地显示页面中的数据....，但现在我想显示在管理控制台中排序的这些数据。

我试图在 App_Data/Composite/TreeDefinitions 中创建一个 xml 文件，但没有成功。

那么，有没有教程可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T09:16:35.137

您在 ~/App_Data/Composite/TreeDefinitions 文件夹中创建一个“树定义”xml 文件是正确的，您应该确保您的定义包含以下内容：

```
<ElementStructure.AllowedAttachments ApplicationName="(your app name here)"> 
  <DataType Type="Composite.Data.Types.IPage" Position="Bottom" /> 
</ElementStructure.AllowedAttachments> 
```

一旦你定义了这个，你可以使用“附加应用程序”命令将它附加到页面上。

有关详细信息，请参阅[http://docs.composite.net/Console/Guide-to-Applications/How-to-Attach-Console-Applications](http://docs.composite.net/Console/Guide-to-Applications/How-to-Attach-Console-Applications)。

# php - 在 Magento 中隐藏产品的自定义选项

> ID：12410140
> 
> 赞同：0
> 
> 时间：2012-09-13T15:49:07.920
> 
> 标签：php, sql, database, magento, e-commerce

我的 Magento 商店中有数百种产品，所有这些产品都有一组非常相似的自定义选项。我使用一个产品作为模板，并将其自定义选项复制到所有其他产品，以便所有产品当前都具有相同的自定义选项集。

我想禁用或隐藏商店中某些产品的某些自定义选项，而不完全删除该选项。现在，我只能完全删除产品的选项。例如，某些产品目前无法订购不同颜色的产品，但可能会在以后订购；我希望能够禁用颜色选项而不是删除它并稍后重新添加整个颜色列表。

有没有人有类似的经验可以帮我解决这个问题？谢谢，非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:01:37.777

对“颜色”等属性使用自定义选项对 Magento 来说不是正确的方法。Magento 具有特殊的产品类型 -**可配置**产品，用于您尝试实现的目录结构。

以下是使用可配置产品而不是自定义选项可以获得的好处：

1.  自动库存管理。一旦某些实物商品缺货，您就无需启用-禁用您的自定义选项 - Magento 会为您完成。
2.  您不必将所有自定义选项复制到您创建的新产品中。此产品所属的*属性集*的属性将自动可用于新条目。
3.  您将能够使用分层导航按类别页面上的**颜色属性过滤您的产品。**

以下是[如何](http://www.magentocommerce.com/knowledge-base/entry/tutorial-creating-a-configurable-product)从 Magento 官方 wiki 创建可配置产品的指南。

# asp.net - 在 DataGrid 中设置 DropDownList 的 SelectedValue

> ID：12410145
> 
> 赞同：0
> 
> 时间：2012-09-13T15:49:16.897
> 
> 标签：asp.net, data-binding, datagrid, .net-3.5

我有一个数据网格，其中数据源 #1 绑定到，例如

```
public class Class
{
  public string Val { get; set; }
  public string Val2 { get; set; }
}
List<Class> classes = new List<Class>();
dgr.DataSource = classes; 
```

在这个数据网格中，我为每一行都有一个列表框，其中数据源 #2 绑定到：

```
<Columns>
  <asp:TemplateColumn HeaderText="Spaltenname">
    <ItemTemplate>
      <asp:ListBox runat="server" DataTextField="Text" DataValueField="Value" DataSource="<%#oParentTablesHandler.DataTableXYZ%>" />
    </ItemTemplate>
  </asp:TemplateColumn>
</Columns> 
```

这可行，但我在设置 SelectedValue 时遇到问题。

```
SelectedValue="<%# "" %> 
```

可以，但我需要根据数据源#1 中的 Val 进行选择。我怎样才能做到这一点？我想我需要使用 Eval，但是

```
SelectedValue="<%# Eval("Val") %> did not work... 
```

编辑：我发现我想按文本而不是按值选择一个项目，啊。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:16:16.790

试试这样。。

```
<%# ((Class)Container.DataItem).Val %> 
```

更新：

好吧。“Val”属性中可能有一些值可能不存在于您的 Datasource#2 的相应列中...

因此，出于测试目的，请尝试以下..

```
<asp:ListBox .. AppendDataBoundItems="true"> 
   <Items>       
 <asp:ListItem Text="NA" Value="" />   
 </Items>
 </asp:ListBox > 
```

# reverse-proxy - 在 CloudBees PaaS 中，应该指定什么配置来将不同的服务器放在同一个 URL 空间中

> ID：12410147
> 
> 赞同：1
> 
> 时间：2012-09-13T15:49:30.870
> 
> 标签：reverse-proxy, paas, cloudbees

我正在尝试使用 CloudBees PaaS (RUN@CloudBees) 在同一 URL 空间下整合三种不同的不同用途：

*   root (/) 主登陆、营销页面
*   应用程序 (/app) 在 CloudBees 中运行的 java 应用程序
*   博客 (/blog) 在 cloudbees 中或可能在外部运行的另一个 java 应用程序 (example.wordpress.com)

如果我自己在数据中心或 AWS 中执行此操作，我将设置一个反向代理（可能像 Varnish 并配置反向代理以映射 URL 空间，如下所示：

*   root (/): www.example.com/ --> 作为 cloudbees 应用程序运行的 CMS example-cms.cloudbees.net
*   app (/app) 在 CloudBees www.example.com/app -> app.example.com 中运行的 java 应用
*   博客 (/blog) 类似 www.example.com/blog -> example.wordpress.com 或 exampleblog.cloudbees.net

如何使用 CloudBees 实现相同的目标。可以做到吗？对 PaaS 供应商的期望是否过高？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T12:34:07.707

一个有趣的问题，以及一些解决方案：

1.  使用域而不是路径（例如 blog.example.com 等） - 这样您就可以使用 DNS 来引导事物
2.  构建一个本质上为您代理流量的应用程序（这可以在 cloudbees 或其他地方运行）——有很多方法可以做到这一点。
3.  使用一些路由/代理服务（如 CloudFlare），它可以让您设置路由规则（因此它可以代理流量）。

我的偏好始终是数字 1 - DNS 是执行此类操作的好方法。您可以使用这种方法在您的 paas 应用程序中拥有 /blog 类似的 Url，并让它执行 302 重定向到真正的 blog.example.com - 这两种方式都给了您一些。

# validation - 验证器错误排序

> ID：12410149
> 
> 赞同：1
> 
> 时间：2012-09-13T15:49:31.743
> 
> 标签：validation, bean-validation, hibernate-validator

我想要实现的是有序的错误消息。给出以下 bean 类

```
public class DummyBean{

    @NotNull
    public String firstName;

    @NotNull
    public String lastName;
} 
```

并像这样使用[LocalValidatorFactoryBean](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/validation/beanvalidation/LocalValidatorFactoryBean.html)：

```
private Validator validator;

@Autowired
public DummyController(Validator validator) {
    this.validator = validator;
}

public void validate(DummyBean bean){
    Map<String, String> failureMessages = new LinkedHashMap<String, String>();

    for (ConstraintViolation<DummyBean> failure : validator.validate(bean)) {
        failureMessages.put(failure.getPropertyPath().toString(), failure.getMessage());
    }
} 
```

如何确保与属性“firstName”相关的错误消息总是首先与“lastName”相关？

只能订购 Afaik 组序列，但我希望也许有人已经遇到过这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T08:20:25.037

你是对的，如果你想执行一个命令，你需要使用一个组序列。但是，在这种情况下，一旦发生约束冲突，验证就会停止。这意味着在这种情况下，您将永远不会违反*firstName*和*lastName*的约束。

还要考虑你得到了一*组*违规，并且没有保证对一组的迭代顺序。

# ms-access - MS-Access 报告的“输出掩码”？

> ID：12410152
> 
> 赞同：1
> 
> 时间：2012-09-13T15:49:44.260
> 
> 标签：ms-access, ms-access-2010

## **概括：**

我正在尝试确定最简单的方法来屏蔽 MS-Access 报告中特定列的输出。

## **情况：**

我有一个“联系人”表，每个人都必须属于一个“组织”。联系人表中填充了遗留数据，这些数据并未严格执行联系人和组织之间的关系。在导入时，如果联系人不属于某个组织，则将其分配给一个虚拟的“遗留”组织（以保持完整性，并允许我们搜索并最终回填这些值）。

## **我的问题：**

我的问题是——从联系人表生成邮件列表报告时，会为那些讨厌的旧联系人填充虚拟“传统”组织的名称。我需要以这样一种方式屏蔽此输出，以使这些行的所有其他列保持不变，并且组织名称列只是空白。需要包含这些行（未过滤），但如果他们的组织 == “旧版”，那么在报告中，组织名称需要为空白。

## **我的想法：**

我已经考虑过一个简单的 VBA 宏，以便在报告加载后对其进行编辑，但我想知道是否有更直接的机制。我知道 Access 允许输入屏蔽，它有类似的输出吗？

**谢谢，** 克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T15:57:05.347

为什么不将您的报告基于查询？

```
SELECT ContactID, IIf(Company="Legacy",Null,Company) 
FROM Contacts 
```

您也可以在报表控件中执行类似的操作，但请确保在将控件设置为函数之前重命名该控件。

# .htaccess - 多语言站点，子目录作为语言 (RewriteRule) WHMCS

> ID：12410153
> 
> 赞同：1
> 
> 时间：2012-09-13T15:49:48.487
> 
> 标签：.htaccess, mod-rewrite

我使用 RewriteRule 为我的网站制作友好的网址，因为我正在使用 whmcs 并且脚本已编码。这是我想要的：

```
http://www.example.com/index.php?language=english 
```

至

```
http://www.example.com/en/index.html 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T15:54:19.970

尝试这个

```
<IfModule mod_rewrite.c>
  RewriteEngine on

  RewriteRule ^en/(.*)\.html$ /$1.php?language=english [L,QSA]
</IfModule> 
```

# java - Apache Ant 正在创建奇怪的目录

> ID：12410157
> 
> 赞同：0
> 
> 时间：2012-09-13T15:50:06.937
> 
> 标签：java, ant, build.xml

我正在定义一个新的构建文件，并且（出于此问题范围之外的原因）我需要将它放在里面`projectRoot/build`，而不是正常的`projectRoot`：

```
MyProject
    src/
        <Java source>
    build/
        build.xml
        build.properties 
```

所以里面`build.xml`：

```
<project name="myproject-build" basedir="..">
    <property file="build.properties"/>

    <target name="mkdirs">
        <mkdir dir="${gen.dir}"/>
    </target>
</project> 
```

在里面`build.properties`：

```
gen.dir=generated 
```

因此，如果我从命令行运行`mkdirs`，您会*期望*它生成以下目录结构：

```
MyProject
    src/
        <Java source>
    generated/
    build/
        build.xml
        build.properties 
```

但相反，我得到：

```
MyProject
    src/
        <Java source>
    ${gen.dir}
    build/
        build.xml
        build.properties 
```

这是怎么回事？为什么 Ant 不能正确导入`build.properties`文件？还是发生了其他事情？我怀疑这与它有关`basedir`，但我无法改变构建*必须*存在于内部的事实`build/build.xml`。提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T15:54:08.610

你的怀疑是正确的。设置`basedir`更改它正在寻找`build.properties`文件的位置。将您的导入更改为：

```
<property file="build/build.properties"/> 
```

它应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T15:54:23.103

`property file="build/build.properties"/>`应该修复它

这里需要 30 个字符.. damm

# php - 正则表达式日期分隔

> ID：12410159
> 
> 赞同：0
> 
> 时间：2012-09-13T15:50:11.937
> 
> 标签：php, regex

我有这样的以下日期

20120809

我想用'-'把它分开，然后把它变成

2012-08-09

使用正则表达式。

有没有使用 PHP 的简单解决方案？一切都会好的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T15:56:26.320

你可以使用`date_parse_from_format`，[文档在这里](http://www.php.net/manual/en/function.date-parse-from-format.php)。在您的情况下，这将导致：

```
date_parse_from_format('Ymd',$dateIn); 
```

返回一个数组，因此您几乎可以从那里开始随心所欲

正如@Rocket 所说，您还可以获得该`DateTime`对象，它也为您提供了各种好东西。[更多要阅读的文档；）](http://www.php.net/manual/en/datetime.createfromformat.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T15:58:24.063

使用`date()`和`strtotime()`？

```
date('Y-m-d',strtotime('20120809')); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T15:55:07.497

同意其他人您不需要正则表达式来执行此操作，但是...

```
preg_replace('/(\d{4})(\d\d)(\d\d)/', '\1-\2-\3', $str); 
```

但是，使用 PHP，您可以使用`substr_replace`插入破折号：

```
$str = substr_replace($str, '-', 4, 0);
$str = substr_replace($str, '-', 7, 0); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-13T15:55:42.007

如果你想使用正则表达式，这很简单。只需`\d`与量词一起使用，如`{4}`.

```
preg_replace('/(\d{4})(\d{2})(\d{2})/', '$1-$2-$3', '20120809'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T16:02:30.547

对这件事使用正则表达式是完全错误的，有更好的方法来做到这一点，比如 substr() ...

但这是你想要的：

```
<?php

$string = '20120809';

preg_match( '/(\d{4})(\d{2})(\d{2})/', $string, $parts);

unset($parts[0]);

$result = implode('-', $parts); //2012-08-09

?> 
```

# c# - 是否建议使用 .resx 文件将常见的字符串引用存储在类库中？

> ID：12410162
> 
> 赞同：4
> 
> 时间：2012-09-13T15:50:22.077
> 
> 标签：c#, three-tier

是否建议使用 .resx 文件将常见的字符串引用存储在业务层类库中？我通常只看到这些在表示层中使用过。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:09:37.617

一种选择是在您的解决方案中拥有一个单独的项目，其中包含整个解决方案的所有 resx 文件。然后，您可以将其添加为对业务层的引用。在资源项目中，您可以围绕 .net ResourceManager 类编写一个包装器，以返回您的密钥的资源值。类似的东西：

```
public class ResourceService : IResourceService
{
    public ResourceService() {}

    public GetResourceValue(string resourceFileName, string resourceKey)
    {
         var resourceManager = new ResourceManager("Myresources", Assembly.Load("MyResourcesProjectName"));
         return resourceManager.GetString(resourceKey);
    }
} 
```

然后你可以从你的业务层使用它：

```
var resourceService = new ResourceService();
var resourceValue = resourceService.GetResourceValue("MyResources", "ResourceKeyName"); 
```

我没有时间测试代码，我是在运行中编写的，但它应该给你一个大致的想法。IMO，将 resx 文件放在单独的项目中没有任何问题。另一种接近它的方法是在使用它们的地方有 .resx 文件。我发现单独的项目想法更好，因为这样，您可以为每种语言创建单独的文件夹，并在其中存储特定于语言环境的 .resx 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:05:23.643

最好尝试将用户将看到的字符串移动到表示层，但在业务层中构建一些消息的情况并不少见。如果您计划将消息翻译成多种语言/文化，那么将它们放在 resx 文件中是合适的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T16:06:28.457

我认为将面向用户的字符串放入任何层的 resx 文件中都没有问题。

即，如果您的业务逻辑有类似的东西`CreateGreatingMail(User user, CultureInfo language)`，那么您将有多个面向用户的可本地化字符串，您需要将它们放在某个地方，而 resx 是最好的地方。

对于共享 UI 字符串，您可以拥有专门用于 UI 字符串的显式 UI 层组件，而不是将其合并到共享业务层中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T15:55:45.300

是的，Exaclty`.resx file`放置在 上`Presentation Layer`。

但是你可以设置`constant`

```
const string toto = "test"; 
```

# git - GitHub for Windows 预提交挂钩

> ID：12410164
> 
> 赞同：8
> 
> 时间：2012-09-13T15:50:35.477
> 
> 标签：git, github

我们有一个开发团队，他们使用 50/50 的 GitHub for windows 和 Bash shell 进行 Git 管理。

我们已经实现了一个预提交钩子（旨在运行单元测试并在测试失败时使提交失败）。作为一个简化版本，我附上了一个简化版本，它在下面演示了我们的问题。

```
#!/bin/sh
exit 1 
```

如果我们尝试从 bash shell 提交，预期的提交会失败。但是，如果我们从 GitHub for windows 应用程序执行相同的提交，它会成功提交到本地存储库。

那么有谁知道我们如何从 GitHub 应用程序中获得相同的功能？不幸的是，我们无法将用户从应用程序中移除，现在它是一个明显的漏洞。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-17T03:47:09.047

很抱歉成为坏消息的承担者，但 GitHub for Windows 不支持预提交钩子，因为它使用 libgit2 提交。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T15:36:55.797

使用 Git shell 你可以有提交钩子。我得到了一些使用 PowerShell 的提交钩子。我发现了一个执行 lint 的[powerShell](https://gist.github.com/1034262)脚本，我将其扩展为运行 phpunit 和 phpcs（路径是硬编码的，因此您需要调整）：

预提交文件：

```
#!/bin/sh
echo 
exec powershell.exe -ExecutionPolicy RemoteSigned -File '.\.git\hooks\pre-commit-hook.ps1'
exit 
```

pre-commit.ps1 文件：

```
###############################################################################
#
# PHP Syntax Check for Git pre-commit hook for Windows PowerShell
#
# Author: Vojtech Kusy <wojtha@gmail.com>
# Author: Chuck "MANCHUCK" Reeves <chuck@manchuck.com>
#
###############################################################################

### INSTRUCTIONS ###

# Place the code to file "pre-commit" (no extension) and add it to the one of 
# the following locations:
# 1) Repository hooks folder - C:\Path\To\Repository\.git\hooks
# 2) User profile template   - C:\Users\<USER>\.git\templates\hooks 
# 3) Global shared templates - C:\Program Files (x86)\Git\share\git-core\templates\hooks
# 
# The hooks from user profile or from shared templates are copied from there
# each time you create or clone new repository.

### SETTINGS ###

# Path to the php.exe
$php_exe = "C:\php\php.exe";

# Path to the phpcs
$php_cs = "C:\Includes\PEAR\phpcs.bat";

# Path to the phpunit
$php_unit = "C:\Includes\PEAR\phpunit.bat";

# Path to the phpunit bootstrap file
$bootstrap = "tests\bootstrap.php";

# Flag, if set to 1 require test file to exist, set to 0 to disable
$requireTest = 1;

# Extensions of the PHP files 
$php_ext = "php|phtml"

# Flag, if set to 1 git will unstage all files with errors, set to 0 to disable
$unstage_on_error = 0;

### FUNCTIONS ###

function php_syntax_check {
    param([string]$php_bin, [string]$extensions, [int]$reset) 

    $err_counter = 0;

    write-host "Pre-commit PHP syntax check:" -foregroundcolor "white" -backgroundcolor "black"

    git diff-index --name-only --cached HEAD -- | foreach {             
        if ($_ -match ".*\.($extensions)$") {
            $file = $matches[0];
            $errors = & $php_bin -l $file   
            $testFileExists = (Test-Path $file -PathType Leaf)
            write-host $file ": "  -foregroundcolor "gray"  -backgroundcolor "black" -NoNewline
            if ($testFileExists) {
                if ($errors -match "No syntax errors detected in $file") {
                    write-host "OK!" -foregroundcolor "green" -backgroundcolor "black"
                }
                else {              
                    write-host "ERROR! " $errors -foregroundcolor "red" -backgroundcolor "black"
                    if ($reset) {
                        git reset -q HEAD $file
                        write-host "Unstaging ..." -foregroundcolor "magenta" -backgroundcolor "black"
                    }
                    $err_counter++
                }
            } else {
                write-host "OK! (file deleted)" -foregroundcolor "green" -backgroundcolor "black"
            }
        }
    }

    if ($err_counter -gt 0) {
        write-host "Some File(s) have syntax errors. Please fix then commit" -foregroundcolor "red" -backgroundcolor "black"
        exit 1
    }    
}

function php_cs_check {
    param([string]$php_cs, [string]$extensions, [int]$reset) 

    $err_counter = 0;

    write-host "Pre-commit PHP codesniffer check:" -foregroundcolor "white" -backgroundcolor "black"

    git diff-index --name-only --cached HEAD -- | foreach {     
        if ($_ -match ".*\.($extensions)$") {
            $file = $matches[0];

            write-host $file ": "  -foregroundcolor "gray"  -backgroundcolor "black" -NoNewline
            if ($file -match "tests\/") {
                write-host "PASSED! (test file)" -foregroundcolor "green" -backgroundcolor "black"
            } else {
                $errors = & $php_cs --standard=Zend $file           

                if ($LastExitCode) {
                    write-host "FAILED! (contains errors)"  -foregroundcolor "red" -backgroundcolor "black"
                    if ($reset) {
                        git reset -q HEAD $file
                        write-host "Unstaging ..." -foregroundcolor "magenta" -backgroundcolor "black"
                    }
                    $err_counter++
                } else {                
                    write-host "PASSED!" -foregroundcolor "green" -backgroundcolor "black"
                }
            }
        }
    }

    if ($err_counter -gt 0) {
        write-host "Some File(s) are not following proper codeing standards. Please fix then commit" -foregroundcolor "red" -backgroundcolor "black"
        exit 1
    }    
}

function php_unit_check {
    param([string]$php_unit, [string]$bootstrap, [string]$extensions, [int]$reset, [int]$requireTest) 

    $err_counter = 0;

    write-host "Pre-commit PHP unit check:" -foregroundcolor "white" -backgroundcolor "black"

    git diff-index --name-only --cached HEAD -- | foreach {     
        if ($_ -match ".*\.($extensions)$") {
            $file = $matches[0];

            write-host $file ": "  -foregroundcolor "gray"  -backgroundcolor "black" -NoNewline
            if ($file -match "tests\/") {
                write-host "SKIPPED! (test file)" -foregroundcolor "green" -backgroundcolor "black"
            } elseif ($file -match ".*Bootstrap.php") {
                write-host "SKIPPED! (bootstrap file)" -foregroundcolor "green" -backgroundcolor "black"
            } elseif ($file -match "([application|library\\NDX].*)(.($extensions))$") {

                $testFile = 'tests/' + $matches[1] + "Test.php";
                $testFileExists = (Test-Path $testFile -PathType Leaf)

                if ($testFileExists) {
                    $errors = & $php_unit --bootstrap $bootstrap $testFile
                    if ($LastExitCode) {
                        write-host "FAILED! (" $testFile ")"  -foregroundcolor "red" -backgroundcolor "black"
                        if ($reset) {
                            git reset -q HEAD $file
                            write-host "Unstaging ..." -foregroundcolor "magenta" -backgroundcolor "black"
                        }
                        $err_counter++
                    } else {
                        write-host "PASSED!" -foregroundcolor "green" -backgroundcolor "black"

                    }
                } elseif($requireTest) {
                    write-host "FAILED! Test file Not found: (" $testFile ")"  -foregroundcolor "red" -backgroundcolor "black"
                    if ($reset) {
                        git reset -q HEAD $file
                        write-host "Unstaging ..." -foregroundcolor "magenta" -backgroundcolor "black"
                    }
                    $err_counter++
                } else {
                    write-host "PASSED! (Test file not found and not required)" -foregroundcolor "darkGreen" -backgroundcolor "black"
                }
            } else {
                write-host "IGNORED!" -foregroundcolor "darkGreen" -backgroundcolor "black"
            }
        }
    }

    if ($err_counter -gt 0) {
        write-host "Some File(s) failed unit testing. Please fix then commit" -foregroundcolor "red" -backgroundcolor "black"
        exit 1
    }    
}
### MAIN ###

php_syntax_check $php_exe "php|phtml" $unstage_on_error
write-host
php_cs_check $php_cs "php" $unstage_on_error
write-host
php_unit_check $php_unit $bootstrap "php" $unstage_on_error $requireTest 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-05T03:13:50.450

您可能会考虑使用 Visual Studio（或您的构建器）预构建事件，但如果需要完全自动化，也有一个问题。[这是一个示例用法。](http://blog.didenko.com/2013/11/version-inventory.html)现在，该解决方案也需要`git.exe`在路径上，但用户不需要与之交互。如果比我聪明的人能解决文章中提到的反斜杠问题，那就太好了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-02T21:20:58.967

添加一个答案作为当前选择的答案不再是这种情况。我能够编写一个预提交挂钩，它适用于 Windows 的 GitHub Desktop、Windows 的 SourceTree 和 Windows 的 Git Bash。

我不确定这是否是 Windows 提交挂钩的硬性要求，但我包含了对 sh.exe 的准确引用，如下所示：

```
#!C:/Program\ Files/Git/usr/bin/sh.exe 
```

它运行良好！

# xml - XSL，在 for-each 中获取 xsl:value-of 的问题

> ID：12410170
> 
> 赞同：0
> 
> 时间：2012-09-13T15:51:07.677
> 
> 标签：xml, xslt, foreach, value-of

我有一个带有不同节点的 XML：

```
<INFORME>
  <Assignatura>
     <Nom_materia>Física</Nom_materia>
  </Assignatura>
  <Assignatura>
     <Nom_materia>Informàtica</Nom_materia>
  </Assignatura>
</INFORME> 
```

并且，在内部`for-each`，我想访问前一个节点。我想做这样的事情，从逻辑上讲它不起作用。

```
<xsl:for-each select="Assignatura">
  <xsl if text="Nom_materia = Assignatura[position()-1]/Nom_materia">
    do something...
.... 
```

我认为这将是非常简单的事情，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T15:58:17.097

假设您的上下文节点是 INFORME：

```
<xsl:for-each select="Assignatura">
  <xsl:if test="Nom_materia = preceding-sibling::Assignatura[1]/Nom_materia">
    do something...
  </xsl:if>
</xsl:for-each> 
```

# java - 试图在 JAVA 中编写一个检查用户输入的方法，得到 NoSuchElementException

> ID：12410173
> 
> 赞同：0
> 
> 时间：2012-09-13T15:51:17.473
> 
> 标签：java, validation, input, java.util.scanner

我正在尝试编写一种方法来处理控制台应用程序中用户的所有输入。我一共调用了这个方法5次。第一次，条件是

a) 数字必须是正数和实数（double）

接下来的4次条件是

b) 数字必须大于 1

这是我的方法：

```
private static double numChk(int errNum) {

    final String[] ERROR_MESSAGE = {
            "\nPlease enter only positive, real-valued numbers",
            "\nPlease enter only positive numbers greater than 1" };
    Scanner in = new Scanner(System.in);
    double tempData;

    while (!in.hasNextDouble()) {
        System.out.println(ERROR_MESSAGE[errNum]);
        System.out.print("  Please try again: ");
        in.next();
    }
    tempData = in.nextDouble();

    // in.close();
    return tempData;
} 
```

这是对此方法的示例调用：

```
 do {
        System.out
                .println("Please enter only positive, real-valued numbers");
        System.out.print("  Enter a constant: ");
        mu = numChk(0);
    } while (mu <= 0); 
```

注意“// in.close();” 在我写的方法中。在不关闭扫描仪的情况下，此方法可以正常工作。但是，我的任务要求我确保关闭所有打开的输入流。如果我关闭方法中的输入流并重新打开它，我会得到 NoSuchElementException。我知道我可以将所有这些放入我的主要方法并在其末尾关闭输入但是，我想知道是否有办法做到这一点（输入验证，多次）并能够关闭输入流。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:12:09.007

当您调用 in.close() 时，您也在关闭 System.in。下次您尝试使用新的 Scanner 时，它将尝试使用已关闭的 System.in，这就是为什么当您尝试从中读取时会出现异常

请参阅： [使用 Scanner.next() 获取文本输入](https://stackoverflow.com/questions/1071965/using-scanner-next-to-get-text-input)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T15:53:13.010

如果在方法中调用 in.close()，则需要某种方法来确定它是否是最后一个输入。

我建议将扫描仪放在您的主要方法中，将扫描仪传递给该方法，然后在您完成所有输入后关闭它。

我怀疑正在发生的事情是您正在像从文件中一样通过管道发送输入。第一个扫描仪缓冲所有输入，当您关闭并重新打开它时，您最终会丢失缓冲到第一个扫描仪的数据。我不能保证，但这就是它的样子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T15:52:25.520

在 while 循环它尝试调用之后，通过这一行可能没有任何输入。

```
 tempData = in.nextDouble(); 
```

# shopify - Notes 属性语法改变了吗？- 通过 API 调用的笔记属性对我来说失败了

> ID：12410179
> 
> 赞同：2
> 
> 时间：2012-09-13T15:51:28.130
> 
> 标签：shopify

您好 Shopfiy 开发人员！

我通过 API 调用遇到了注释属性的问题。它曾经工作到一个月前，然后事情开始横向发展。有任何语法改变吗？这是我的代码片段，它在 for 循环中返回错误。

错误消息“未定义的索引：note_attribute 就在 foreach 行”

```
// Overwrite custom status field if it's defined in note-attributes
if(array_key_exists('note-attributes', $o))
{
    // For whatever reason, the note-attributes are formatted
    // differently if there's only one key => value pair
    // ( * see examples at end of this file )
    // If the note-attribute array has the key 'name' in it, it's just a single pair.
    // Otherwise, the note-attribute array would be numerically indexed with keys 0,1,2.. etc
    if(array_key_exists('name',$o['note-attributes']['note_attribute']))
    {
        if($o['note-attributes']['note_attribute']['name'] == "custom_status")
            $arr_tmp[7] = $o['note-attributes']['note_attribute']['value'] ;
    }
    else
    {
        foreach($o['note-attributes']['note_attribute'] as $na) //Fails here
        {
            if($na['name'] == "custom_status")
                $arr_tmp[7] = $na['value'] ;
        }
    }
} 
```

非常感谢您的帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T14:36:18.163

这里的问题是由于 XML 节点语法的变化；Shopify 有一个回归，在响应中更改`note-attributes`为`note_attributes`，然后又改回来了。

# php - 如何编写这种输出的代码？当我单击特定链接时，它会显示某种形式（不确定是否是形式）

> ID：12410181
> 
> 赞同：0
> 
> 时间：2012-09-13T15:51:31.310
> 
> 标签：php, html, jquery

如何编码？当我悬停我的名字时它像表格一样弹出，但我认为它不是表格

![在此处输入图像描述](../Images/7bc77127db8be1e6b2276b722a34fc22.png)

我想要完全一样的，因为我想在我的页面中发生当我悬停我的名字时它的值是 id 并通过 ajax 将其发送到 php 然后 php 脚本查询 id 并返回其其他详细信息然后其他详细信息将像在图像中一样显示我已经有一个函数和一个 php 代码我唯一需要的是如何做这个图像

js函数代码：

```
function searchWarriors() {
var id = $("#name").val();
$.ajax({
    url: "retrieve_result.php",
    type:"GET",
    datatype:"json",
    data: {id: id},
    success: function(data) {
        var toAppend = '';
        if(typeof data === "object"){
            for(var i=0;i<data.length;i++){
                var warrior = data[i];
                toAppend += '<ul class="ul">';
                toAppend += '<li>'+data[i]['loc']+'</li>';
                toAppend += '<li>'+data[i]['email']+'</li>';
                toAppend += '<li>'+data[i]['sex']+'</li>';
                toAppend += '</ul>';
            }
            $(".ul").remove();
            $("#details").append(toAppend);
        }
    }
});
return false; 
```

}

我的 PHP 代码：

```
<?php
header("Content-Type: application/json");

include 'functions/class.php';

$db = new DB();

$result = $db->getDetails($_GET['id']);

$details = array();

foreach($result as $values){
    $details[] = $names;
}
echo json_encode($details);
?> 
```

我的html调用函数的代码

```
 <?php
foreach($result as $id){
//I don't know if this is right
echo'<a id="name" href="myphpcode.php"?id='.$id['user_id'].'>'.$id['name'].'</a>';
}
?>
<div id="details">

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:10:37.910

最简单的方法是通常准确地创建您希望弹出窗口在 php 脚本中的外观，然后使用 jQuery 并使用 $("#Popup-id").load(script-url.php?获取变量 = 1)。div 元素需要较高的 z-index 才能显示在屏幕顶部。

# javascript - 在滚动 div 中自定义光标图像

> ID：12410182
> 
> 赞同：0
> 
> 时间：2012-09-13T15:51:35.123
> 
> 标签：javascript, jquery, html, scroll, cursor

当光标位于顶部或底部（向上或向下滚动）时，我有一个 div 滚动内容。我有两个自定义的光标图像——一个应该在 div 内容向上滚动时显示，另一个应该在 div 内容向下滚动时显示。下面的脚本由 stackoverflow 成员编写，仅在使用标准光标样式（如等待、指针等）时有效。我想使用图像，但无法使其正常工作。我也不需要下面脚本中的计时器。

```
 <script type='text/javascript' >
 var top=0, timer;

 $('#repertoirescroll').on('scroll', function() {
 clearTimeout(timer);
 var scrollTop = $(this).scrollTop(),
    cursor = scrollTop > top ? 'pointer' : 'wait';
 $('body').css('cursor', cursor);
 top = scrollTop;
 timer = setTimeout(function() {
    $('body').css('cursor', 'default');
 }, 500);
 });​

 </script> 
```

我使用的图像名称是

```
 url(../images/arrowup.png)
 url(../images/arrowdown.png) 
```

*****HTML/CSS******

 **```
 .cursorup {
  cursor: url(../images/arrowup.png), auto;
  position:relative;

 }

 .cursordown {
  cursor: url(../images/arrowdown.png), auto;
  position:relative;

 } 
```

滚动内容

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T15:56:48.067

要使用自定义光标，请使用 CSS 样式：

```
.curarrowup {
    cursor: url(../images/arrowup.png), auto;
} 
```

然后应用，使用 jQuery 应用样式：

```
$(myElement).addClass("curarrowup"); 
```

当您想返回到普通光标时：

```
$(myElement).removeClass("curarrowup"); 
```

在您的示例中使用 $('body') (myElement === 'body') 很好。

一个警告：在 Firefox 中，新光标通常在您实际移动鼠标之前不会出现。这是一个已知的错误，我找不到任何解决方法。

**编辑：**修改您的代码：

```
var top=0, timer;

$('#repertoirescroll').on('scroll', function() {
    var scrollTop, cursor;

    clearTimeout(timer);
    scrollTop = $(this).scrollTop();
    cursor = scrollTop > top ? 'curarrowup' : 'curarrowdown';
    $('body').addClass(cursor);
    top = scrollTop;
    timer = setTimeout(function() {
        $('body').removeclass(cursor);
    }, 500);
});​ 
```**

# javascript - 如何在 Alfresco 共享表单中更改突出显示项目的颜色

> ID：12410185
> 
> 赞同：0
> 
> 时间：2012-09-13T15:51:47.923
> 
> 标签：javascript, css, workflow, share, alfresco

所以我一直在尝试更改文档在 Alfresco Share 工作流程表单的“项目”字段中显示的突出显示颜色。基本上，给定一个看起来像这样的起始表格......

![在此处输入图像描述](../Images/9f3f190786ec8077420b3cee6dc83115.png)

您会注意到添加到项目字段的所有其他文档都会自动突出显示为浅蓝色。我想知道是否可以更改该颜色，此外是否可以设置它以便仅在该文档列表中突出显示顶部项目（或单个项目）？

我认为这就像在某处查找和更改 CSS 文件一样简单，但是尽管在 Alfresco 中更改了许多不同的 CSS 文件，但我在更改颜色时运气不佳。只是想知道是否有人对此有任何经验并愿意帮助我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T09:49:11.347

编辑：您正在寻找的课程是：

tr.yui-dt-高亮

这里的问题是这些类是由页面中注入的 JavaScript 自动生成的。所以，我搜索并找到了这个小信息：`share/res/js/yui-common.js`你应该使用像[JavaScript Formatting](http://jsbeautifier.org/)这样的工具来理解其中的一些代码的路径。有一个 CLASS_HIGHLIGHTED 启动一个函数，你应该尝试覆盖它：

```
highlightRow: function (k) {
    var i = this.getTrEl(k);
    if (i) {
        var j = this.getRecord(i);
        c.addClass(i, d.CLASS_HIGHLIGHTED);
        this.fireEvent("rowHighlightEvent", {
            record: j,
            el: i
        });
        return;
    }
},
unhighlightRow: function (k) {
    var i = this.getTrEl(k);
    if (i) {
        var j = this.getRecord(i);
        c.removeClass(i, d.CLASS_HIGHLIGHTED);
        this.fireEvent("rowUnhighlightEvent", {
            record: j,
            el: i
        });
        return;
    }
}, 
```

有 highlightRow 和 highlightColumn 可以查看。覆盖 YAHOO yui 函数总是非常困难..

# android - Google 如何在其 G+ 应用中实现动画帖子？

> ID：12410187
> 
> 赞同：13
> 
> 时间：2012-09-13T15:51:52.823
> 
> 标签：android, google-plus

我喜欢滚动浏览 Google+ 应用程序中的帖子时出现的动画，但我不知道它们是如何实现的。

使用什么技术来使帖子出现动画？我不是在寻找动画本身，而是如何将任何动画应用于可滚动项目列表。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-13T19:09:52.667

经过一些测试，我认为我得到了与工作类似的东西；

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    final LinearLayout list = new LinearLayout(this);
    list.setOrientation(LinearLayout.VERTICAL);

    ScrollView scrollView = new ScrollView(this) {
        Rect mRect = new Rect();

        @Override
        public void onLayout(boolean changed, int l, int t, int r, int b) {
            super.onLayout(changed, l, t, r, b);

            for (int i = 0; i < list.getChildCount(); ++i) {
                View v = list.getChildAt(i);

                // Tag initially visible Views as 'true'.
                mRect.set(l, t, r, b);
                v.setTag(getChildVisibleRect(v, mRect, null));                  
            }
        }

        @Override
        public void onScrollChanged(int l, int t, int oldl, int oldt) {
            super.onScrollChanged(l, t, oldl, oldt);

            for (int i = 0; i < list.getChildCount(); ++i) {
                View v = list.getChildAt(i);
                mRect.set(getLeft(), getTop(), getRight(), getBottom());

                // If tag == 'false' and View is visible we know that
                // View became visible during this scroll event.
                if ((Boolean) v.getTag() == false
                        && getChildVisibleRect(v, mRect, null)) {
                    AlphaAnimation anim = new AlphaAnimation(0, 1);
                    anim.setDuration(1000);
                    v.startAnimation(anim);
                    v.setTag(true);
                }
            }
        }
    };
    scrollView.addView(list);

    for (int i = 0; i < 20; ++i) {
        TextView tv = new TextView(this);
        tv.setText("Test");
        tv.setTextSize(72);
        tv.setTextColor(Color.WHITE);
        tv.setBackgroundColor(Color.GRAY);
        list.addView(tv);
    }

    setContentView(scrollView);
} 
```

`TextView`一旦 new s 变得可见，向下滚动列表应该会触发 alpha 动画。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-18T13:14:39.117

有一个图书馆，它似乎做得很好： [https ://github.com/cuub/sugared-list-animations](https://github.com/cuub/sugared-list-animations)

# asp.net - 使用 ActiveDirectoryMembershipProvider 进行 Windows 身份验证

> ID：12410188
> 
> 赞同：0
> 
> 时间：2012-09-13T15:52:00.037
> 
> 标签：asp.net, iis, ldap, windows-authentication

我的网站身份验证有问题。

我正在构建一个需要使用与 Intranet 站点相同的单点登录的网站。

我的想法是在网站上使用 Windows 身份验证来获取用户凭据，然后使用 LDAP 对我们客户的域控制器进行身份验证。有问题的网站托管在客户域之外的服务器上。我已经尝试使用**ActiveDirectoryMembershipProvider**，但我无法让它与集成身份验证一起使用。

我的问题是我无法获得 Windows 身份验证以使用 LDAP 作为会员提供程序。目前，Windows 身份验证获取用户凭据，尝试针对计算机上的用户对它们进行身份验证，但由于 Web 服务器不在域中而失败。我想获取凭据并使用 LDAP 将它们发送到将对它们进行身份验证的域控制器。

有没有办法我可以使用和 LDAP 连接进行集成身份验证？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:17:22.543

**更新**

如果您的网站**托管**在客户端域之外的服务器上，则您无法获得用户身份验证。

因为当您将凭证发送到托管服务器时，域服务器中有一个**Location**对象，它会首先尝试 在您托管网站的本地找到该指定**用户**，然后再到已在 location 中指定的**Doamin 服务器**（虽然我们也可以设置优先级）

如果它没有在本地找到任何用户，那么

之后，它将使用这些**Credentials向****Domain Server**发送请求。

 **在您的情况下，首先它不会在您希望与之通信的位置对象中找到**域服务器名称。**

例如：

```
 PrincipalContext pr = new PrincipalContext(ContextType.Domain, "corp.local", "dc=corp,dc=local", username, password); 
```

这里**Corp.Local**是我的**Location 对象**中的域名以及该用户的用户名**和密码**，该用户具有编辑/更新/删除域服务器中任何用户的管理权限。

所以整个过程再次进行，当在 Location 对象中找到指定的**Domain Server**时，它将与该**Domain**进行通信并生成一个**TOKEN**

您的情况的唯一解决方案是您需要将所有用户从客户端服务器复制到您的域服务器，否则您需要在两个域服务器之间建立信任。

希望这就是你要找的。！！**

# php - simplexml_load_file 忽略 DTD

> ID：12410190
> 
> 赞同：0
> 
> 时间：2012-09-13T15:52:05.557
> 
> 标签：php, xml, simplexml, dtd

我正在使用 simplexml_load_file 来解析必须遵循 DTD 的 XML 文件。XML 和 DTD 都是本地文件。

```
 $obj_xml = simplexml_load_file(
        $str_xml_file,
        'SimpleXMLElement',
        LIBXML_DTDVALID + LIBXML_NOENT
    );
    if (false === $obj_xml) {
        throw new Exception("XML file is not valid");
    } 
```

XML文件是这样的

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapping SYSTEM 'mapping.dtd' [
<!ENTITY data_file "data.csv">
]>
<mapping>
...
</mapping> 
```

我的印象是，如果 XML 根据指定的 DTD 无效，那么 simplexml_load_file 将返回 false，但事实并非如此。我还尝试检查 $obj_xml 是否是 LibXMLError 类的实例，但结果相同。

似乎 simplexml_load_file 完全忽略了 DTD。我尝试将其名称更改为不存在的名称，但仍然没有错误。

正如我所说，XML 和 DTD 都是本地文件。$str_xml_file 是 XML 文件的绝对完整路径名，DTD 位于同一目录中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T22:20:00.063

[我在网上看到的文档](http://www.php.net/manual/en/function.simplexml-load-file.php)中没有任何内容表明`simplexml_load_file`执行验证。事实上，我在 SimpleXML 文档中看不到任何东西表明它可以验证 XML。

[共识[（http://www.ibm.com/developerworks/xml/library/x-simplexml/index.html）似乎是SimpleXML没有验证工具；IBM DeveloperWorks 有[一篇文章](http://www.ibm.com/developerworks/library/x-validxphp/index.html)建议您需要使用 DOM 接口进行验证。

# ssh - AWS EC2：从 cert-***.pem 生成私钥文件以进行 SSH 终端访问

> ID：12410191
> 
> 赞同：5
> 
> 时间：2012-09-13T15:52:06.987
> 
> 标签：ssh, amazon-ec2, amazon-web-services

我有我的访问密钥、密钥和下载的证书 pem 文件。

我了解 SSH 需要一个私钥文件才能与我的实例建立终端 SSH 连接。

我通过谷歌找到的是我需要使用 puttygen 将我的证书 pem 文件转换为私钥文件：

[http://www.techrepublic.com/blog/datacenter/connect-to-amazon-ec2-with-a-private-key-using-putty-and-pageant/5085](http://www.techrepublic.com/blog/datacenter/connect-to-amazon-ec2-with-a-private-key-using-putty-and-pageant/5085)

但是，我找到的所有说明都基于 GUI puttygetn，并且我只有 CL 版本，因为我在笔记本电脑上运行 Linux Fedora 16。我做了 yum PuTTy，它带有一个 GUI，但 puttygen 只有一个 CL 版本。我在 puttygen 中尝试做的事情如下：

```
>puttygen cert-***.pem -o default.pem 

puttygen: error loading `cert-***.pem': file does not begin with OpenSSH key header 
```

谁能指出我做错了什么以及如何使用 CL puttygen 将我的证书文件转换为可由 SSH 连接到我的实例的私钥文件？

提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-13T17:46:46.090

如果你在命令行运行 Linux，为什么需要用 puttygen 制作 ppk？基本上，您从 AWS 获得的密钥对是 pem 格式的，适合在 ssh 命令行中使用。

因此，如果您将 .pem 文件从 Amazon 保存为`/path/to/aws.pem`，您需要做的就是

```
ssh -i /path/to/aws.pem user@hostname.com 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T17:14:35.457

ssh 私钥与 X.509 证书和私钥完全不同。这有点令人困惑，因为人们经常将 EC2 生成的 ssh 私钥保存在“.pem”文件中，就像使用 cert 和 pk 一样。

您不能像您尝试的那样转换或使用 X.509 证书或私钥来进行 ssh。

[您可以通过AWS 控制台](https://console.aws.amazon.com/ec2/home#s=KeyPairs)上的 Amazon EC2或 AWS 命令​​行工具 ( )生成 ssh 私钥（有时称为“密钥对” `ec2-add-keypair`）。如果您使用的是 Putty，您可能仍需要转换为参考文章所述的 PPK 格式，但您转换的是 ssh 密钥 .pem 文件，而不是 X.509 私钥或证书。

如果您知道如何在本地生成自己的 ssh 密钥（或已经这样做了），那么我建议您这样做并将[ssh 公钥上传到 EC2](http://alestic.com/2010/10/ec2-ssh-keys)。

当您运行 EC2 实例时，然后指定 ssh 密钥对名称，以便 EC2 使 ssh 公钥可用于实例，让您安全地通过 ssh 连接到新服务器。

# c++ - 在 C++ 中检测命名空间

> ID：12410192
> 
> 赞同：4
> 
> 时间：2012-09-13T15:52:13.447
> 
> 标签：c++, namespaces, language-lawyer

是否可以检测在给定的代码点您是否在命名空间中？特别是，如果文件包含在全局命名空间中，我想包含一个警告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:00:00.767

好的做法是在全局命名空间中包含**所有标头。**在文件开头打开所有需要的命名空间并在结束前关闭它们。另一种方式将不可避免地导致一堆问题。

***评论扩展***

为防止意外包含，您可以执行以下操作：

```
In header:
#ifndef INTERNAL_INCLUDE
#error ...
#endif

When used:
#define INTERNAL_INCLUDE
#include "internal.h"
#undef INTERNAL_INCLUDE 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T18:02:01.377

如果标头未包含在全局命名空间中，我可以给你一个提示，它会生成编译错误。如果我知道 C++ 构造肯定会生成编译器警告（除了#warning），那么它可以用来代替编译错误。

放入您的标题：

```
template <class A, class B>
struct AreSame { enum { VALUE = -1 }; };
template <class A>
struct AreSame<A,A> { enum { VALUE = 1 }; };

struct TestGlobalNamespace
{
   int test_namespace[AreSame<TestGlobalNamespace, ::TestGlobalNamespace>::VALUE];
}; 
```

当您的标头包含在某个命名空间中时，您会收到错误消息。

就像在这个例子中一样：

```
namespace Some {

struct TestGlobalNamespace
{
   int test_namespace[AreSame<TestGlobalNamespace, ::TestGlobalNamespace>::VALUE];
};

} 
```

你会得到：

```
prog.cpp:17: error: size of array ‘test_namespace’ is negative 
```

[更新]

然而，更可能的是这种错误：

```
prog.cpp:17: error: ‘::TestGlobalNamespace’ has not been declared
prog.cpp:17: error: template argument 2 is invalid 
```

无论如何-没有人敢将您的标头包含在全局以外的名称空间中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T16:38:38.593

您可以这样做，但需要第二个标头，在第一个标头之前包含在全局命名空间中，这带来了一些不便。

```
// stuff_guard.h - include from global namespace to guard stuff.h
#ifndef STUFF_GUARD_H
#define STUFF_GUARD_H
typedef char stuff_guard[1];
#endif

// stuff.h - must be included from non-global namespace, after stuff_guard.h
// No include guard - may be included multiple times, in different namespaces.

#ifndef STUFF_GUARD_H
#error stuff_guard.h must be included before stuff.h
#endif

typedef char stuff_guard[2];

static_assert(sizeof (stuff_guard) != sizeof (::stuff_guard), 
    "stuff.h must not be included from the global namespace");

// Put your stuff here 
```

`stuff_guard.h`如果您违反这两个规则中的任何一个，这将给出相当友好的错误消息，如果您从非全局命名空间中包含，则会给出一个不太友好的错误。

如果你被一个旧的编译器困住并且`static_assert`不可用，那么你可以使用`BOOST_STATIC_ASSERT`，或者[滚动你自己的](https://stackoverflow.com/q/6765770/204847).

# forms - 从基于 Genshi 模板的表单中获取用户条目

> ID：12410193
> 
> 赞同：0
> 
> 时间：2012-09-13T15:52:14.187
> 
> 标签：forms, templates, plugins, trac, genshi

我正在尝试为 Trac 编写插件。我已经成功地将我的请求（process_request）中的变量内容导出到我的模板......但我仍然在以其他方式执行此操作时遇到问题：如何捕获用户录制的信息？

```
<form name="input" action="" method="POST">
    Configuration : <input type="text" name="configuration" value ="$my_var" /> <br /><br />

    <label for="file">URL:</label>
    <input type="text" name="file" id="WillPosted" value="This text will be changed by the user"/>      

    <input type="submit" name="SubmiT" value="Browse" /><br /><br /> 
```

那么如何使用 id="WillPosted" 捕获输入表单的内容？注意：实际问题出在Trac的**IRequestHandler方法中！**

任何想法 ？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:54:42.827

您在询问常见的 Web-UI 交互

*   my_var --> 带有输入字段'file'和默认值'This will ..'的模板
*   用户输入到字段
*   通过 POST 请求提交

如何获得（更改）输入的新值，对吗？如果是这样，你解释得相当复杂。

而且我想知道，如果您不了解[trac-hacks.org](https://trac-hacks.org/wiki/)，它可能是地球上最权威的 Trac 插件代码来源 - 比这里需要的工作示例要多得多。

`reg.args`无论如何，关键是从dict读取返回值，如下所示：

```
from pkg_resources  import resource_filename
from trac.web.chrome  import ITemplateProvider, add_stylesheet

implements(IRequestHandler, ITemplateProvider)

# IRequestHandler methods

def match_request(self, req):
    # Any condition evaluating to True will fire the second method.
    return req.path_info == '/<your_path>'

def process_request(self, req):
    "Demo how to interact with your template."

    # Check, if you'r really processing the right request by target matching,
    # and only act on input of authorized users - as an added suggestion/option.
    if req.path_info.startswith('/<your_path>') and req.authname != 'anonymous':
        # Check for request type.
        if req.method == 'POST':
            # Ok, go pock for the new value now.
            value = req.args.get('file', 'default_value')))
            # Now go, process it, store it, even redirect away, if you're done.

            # Fallback for Trac 0.11 compatibility included.
            referer = req.args.get('referer') or req.get_header('Referer')

            # Steer clear of requests going nowhere or loop to self
            if referer is None or \
                    referer.startswith(str(req.abs_href()) + '/<your_path>'):
                referer = req.abs_href()
            req.redirect(referer)

    # Still there, so that's the initial call or anonymous user, hey?
    # So let's prepare information for displaying the template ...
    data = dict(my_var='any_string_or_number')

    # Take the env obj from self, if needed.
    env = self.env
    mod = MyOwnSecondaryModule(env)
    if mod.can_do_something:
        data['my_var'] = mod.do('better')
    # Why not apply an own style?
    add_stylesheet(req, 'your_plugin/most_famous_style.css')

    return 'your_template.html', data

# ITemplateProvider methods

def get_htdocs_dirs(self):
    """Return the absolute path of a directory containing additional
    static resources (such as images, style sheets, etc).
    """
    return [('your_plugin', resource_filename('your_plugin_pkg_base_dir', 'htdocs'))]

def get_templates_dirs(self):
    """Return the absolute path of the directory containing the provided
    Genshi templates.
    """
    return [resource_filename('your_plugin_pkg_base_dir', 'templates')] 
```

关于使用各种 Trac 扩展点接口的问题？[另请参阅有关该主题](http://trac.edgewall.org/wiki/TracDev/PluginDevelopment/ExtensionPoints)的权威 wiki 文档！

# objective-c - DecimalNumberByAdding 是如何工作的？

> ID：12410194
> 
> 赞同：0
> 
> 时间：2012-09-13T15:52:15.583
> 
> 标签：objective-c, ios, c, xcode, nsdecimalnumber

我有一种情况需要添加两个 NSDecimal，这是我拥有的代码：

```
NSDecimalNumber *total = [[NSDecimalNumber alloc] initWithString:@"0"];
for (Product* product in cartItems) {
    NSDecimalNumber *prodPrice = [[NSDecimalNumber alloc] init];
    prodPrice = product.price;
    total = [total decimalNumberByAdding:prodPrice];
}
return total; 
```

当我尝试添加两个数字（例如 0.01 和 0.02）并且它给了我 0.03 时，它完全可以工作。

但是当我使用整数时，它不起作用。例如，当我尝试将 0.01 和 1 相加时，它给了我一个负数。谁能帮我解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:11:12.387

我稍微修改了你的循环。分配 productPrice = product.price 在您的代码中肯定是错误的。看这个：

```
NSArray *cartItems = [NSArray arrayWithObjects:@"1", @".01", nil];
NSDecimalNumber *total = [[NSDecimalNumber alloc] initWithString:@"0"];

for (NSString *price in cartItems) {
    NSDecimalNumber *prodPrice = [[NSDecimalNumber alloc] initWithString:price];
    total = [total decimalNumberByAdding:prodPrice];
}
NSLog(@"Total: %@", total); 
```

返回

```
 2012-09-13 15:04:03.815 Searcher[69779:f803] TotalL 1.01 
```

# c++ - 在 boost Spirit 解析器中使用指针作为合成属性

> ID：12410195
> 
> 赞同：2
> 
> 时间：2012-09-13T15:52:20.050
> 
> 标签：c++, boost-spirit

我想为我无法修改的对象树编写一个精神解析器。为了简化代码，我可以使用一个表达式示例：

```
class Expr
{
public:
    virtual ~Expr() = 0;
};
Expr::~Expr() {}

class Plus : public Expr
{
public:
    Plus (Expr* e1, Expr* e2) : _e1(e1), _e2(e2) {}
    ~Plus () {}
private:
    Expr* _e1;
    Expr* _e2;
};

class Num : public Expr
{
public:
    Num(double n) : _n(n) {}
private:
    double _n;
}; 
```

我检查了文档，发现有用的 BOOST_ADAPT_STRUCT，但使用声明为的规则：

```
qi::rule<Iterator, Expr()> r; 
```

当规则返回例如 Plus 对象时，我将对对象进行切片。所以我尝试这种方式：

```
template <typename Iterator>
struct ExprParser : qi::grammar<Iterator, Expr*(), ascii::space_type>
{

    ExprParser()
      : ExprParser::base_type (start, "expr")
    {
        expr = qi::double_    [ qi::_val = phoenix::new_<Num>(::_1) ]
                | '('
                    >> expr
                    >> '+'
                    >> expr
                  >> ')'      [ qi::_val = phoenix::new_<Plus>(::_1, ::_2) ]
                ;

        start %= expr;
    }

    qi::rule<Iterator, Expr*(), ascii::space_type> expr;
    qi::rule<Iterator, Expr*(), ascii::space_type> start;
}; 
```

但是我在语义操作中的分配中遇到编译错误。我究竟做错了什么？

# 编辑

sehe的回答很好！那里缺少括号和错误使用占位符。但是发生解析错误时内存泄漏怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:35:20.697

如文档中所述

*   [http://www.boost.org/doc/libs/1_48_0/libs/spirit/doc/html/spirit/qi/tutorials/semantic_actions.html#spirit.qi.tutorials.semantic_actions.phoenix](http://www.boost.org/doc/libs/1_48_0/libs/spirit/doc/html/spirit/qi/tutorials/semantic_actions.html#spirit.qi.tutorials.semantic_actions.phoenix)

在“重要”下，您需要在 Phoenix 中使用 qi 占位符。我已经测试了固定代码。**[你可以在http://liveworkspace.org/code/48dbfb55a0b7cbd4783b2f9f9a66d6d1](http://liveworkspace.org/code/48dbfb55a0b7cbd4783b2f9f9a66d6d1)**上看到它。

请注意，编译第二个语义操作需要额外的括号：

```
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix.hpp>

namespace qi = boost::spirit::qi;
namespace ascii = boost::spirit::ascii;
namespace phoenix = boost::phoenix;

class Expr
{
    public:
        virtual ~Expr() = 0;
};
Expr::~Expr() {}

class Plus : public Expr
{
    public:
        Plus (Expr* e1, Expr* e2) : _e1(e1), _e2(e2) {}
        ~Plus () {}
    private:
        Expr* _e1;
        Expr* _e2;
};

class Num : public Expr
{
    public:
        Num(double n) : _n(n) {}
    private:
        double _n;
};

template <typename Iterator>
struct ExprParser : qi::grammar<Iterator, Expr*(), ascii::space_type>
{

    ExprParser()
      : ExprParser::base_type (start, "expr")
    {
        expr = qi::double_     [ qi::_val = phoenix::new_<Num>(qi::_1) ]
                | ('('
                    >> expr
                    >> '+'
                    >> expr
                  >> ')')      [ qi::_val = phoenix::new_<Plus>(qi::_1, qi::_2) ]
                ;

        start %= expr;
    }

    qi::rule<Iterator, Expr*(), ascii::space_type> expr;
    qi::rule<Iterator, Expr*(), ascii::space_type> start;
};

int main(int argc, const char *argv[])
{
    char input[] = "3.14 + 39";
    ExprParser<const char*> p;

    const char *f = std::begin(input);
    const char *l = std::end(input);
    qi::phrase_parse(f, l, p, ascii::space);
} 
```

# sql-server - 组件的 SSIS 包外部列不同步

> ID：12410199
> 
> 赞同：2
> 
> 时间：2012-09-13T15:52:28.927
> 
> 标签：sql-server, sql-server-2008, ssis

我在 BIDS 中有一个包含许多 SSIS 包的解决方案。我必须恢复我的 SSIS 包中的 OLEDB 连接管理器正在使用的数据库。即使在我开发这些包时，所有数据结构都与以前相同，但我现在的所有包都出现错误/警告图标，指出“组件的外部列不同步”或“列无法在 unicode 和非 unicode 字符串数据类型”。

当我进入包中显示错误/警告的每个单独任务时，我所要做的就是单击确定，它们就会消失。

我的解决方案中有大约 50 个包，因此像这样为每个包刷新它既痛苦又耗时。

有没有一种快速简单的方法可以一次消除所有包的错误/警告？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:56:43.050

抱歉，由于您更改了后端，BIDS 无法确保它具有正确版本的元数据。如果此程序包在计划的作业上运行，则您不必执行此 IMO。要回答您的问题，没有自动的方法。

# parsing - 解析器问题，寻找参数的结尾，发生移位/减少冲突

> ID：12410203
> 
> 赞同：0
> 
> 时间：2012-09-13T15:52:47.893
> 
> 标签：parsing, yacc, shift-reduce-conflict

我试图通过识别没有逗号来设置我的解析器以找到某个参数的结尾，所以我基本上将它设置为找到这样的参数

参数：end_parameter 逗号

（这个数据类型只是一个列表，所以没有任何东西表明它结束了——只是当没有逗号分隔项目时它会停止）

end_parameter 在下面定义并执行它应该做的事情。解析器通过将右大括号识别为结尾来处理其他数据类型，但是当我设置以缺少逗号结尾的类型时，我遇到了移位/减少错误。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:25:35.687

你通过编写与它们是什么相匹配的规则来识别事物，而不是它们不是什么。因此，对于以逗号分隔且末尾没有逗号的参数列表，您将使用：

```
parameter_list : parameter
               | parameter_list ',' parameter
               ; 
```

现在，根据您使用 this 的上下文以及在同一上下文中使用的其他规则，您可能会遇到冲突。如果是这样，您需要查看 y.output 文件以了解冲突的来源以解决它们。

您很少会从单个规则中获得冲突——冲突通常来自多个规则的交互。

# matlab - MATLAB：以 Stata 样式引用变量名中的迭代字符串

> ID：12410204
> 
> 赞同：2
> 
> 时间：2012-09-13T15:52:49.590
> 
> 标签：matlab, stata

在 MATLAB 中，我想在一对分别对男性和女性进行分组的数据集上执行一系列命令——我想分别导出结果。我对Stata很熟悉，所以我的直觉是做这样的事情：

```
foreach X in m f{
    data_`X' = csvread('data_`X'.csv');
    variable_`X' = data_`X'(:,12);
    plot(1975:2011,variable_`X')
    print -djpeg graph_`X'
    % etc.
} 
```

但我无法在 MATLAB 中找到类似于“X”引用结构的类似物，这将允许将迭代的字符串称为变量名的一部分。

我是 MATLAB 的新手，所以我可能完全找错了树。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:53:08.343

你可以这样做，但它可能不是最有效的。

假设这`m`是一个字符串元胞数组，并且 data_X.csv 存在：

```
for ii=1:length(m)
  assignin('base',['data_' m{ii}], csvread(evalin('base',['data_' m{ii} '.csv'));
  assignin('base',['variable_' m{ii}],['data_' m{ii} '(:,12)']);
  plot(1975:2011, evalin('base',['variable_' m{ii}]));
  ... 
```

我认为这会让你走上正确的轨道。

# php - 从文件路径和文件名检测图像类型

> ID：12410207
> 
> 赞同：0
> 
> 时间：2012-09-13T15:52:59.390
> 
> 标签：php, image, filepath

我正在尝试从名为**avatar_50x50**的文件夹中回显图像，文件名是**username**。尽管扩展名始终是图像，但我将如何确定它是什么文件类型？

```
<img src="../images/users/avatar_50x50/<?php echo $sel_user['username']; ?>" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T15:57:51.917

`glob()`如果您确定只有一个名称为用户名的图像，则可以使用并从数组中获取第一个元素：

```
<?php
    $file = glob('../images/users/avatar_50x50/'.$sel_user['username'].'.*');
    echo '<img src="../images/users/avatar_50x50/'.$file[0].'" alt="" />';
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T15:58:57.207

使用[http://php.net/exif_imagetype](http://php.net/exif_imagetype)

而不是使用“切换”运算符来找到正确的图像分机。

```
$type = exif_imagetype($image);
switch($type) {
  case IMAGETYPE_GIF:
    $ext = '.gif';
  // etc...
} 
```

# jsf - PrimeFaces 日历与 Tomahawk 组件一起使用时不会弹出

> ID：12410209
> 
> 赞同：0
> 
> 时间：2012-09-13T15:53:00.620
> 
> 标签：jsf, jsf-2, primefaces, tomahawk

我有一个包含几个 Tomahawk 组件的应用程序，我想向其中添加 PrimeFaces 日历。但是，除非我删除所有 Tomahawk 组件，否则不会弹出 PrimeFaces 日历。这是如何引起的，我该如何解决？

编辑-这是我正在谈论的代码的一部分。喜欢primefaces日历时间选择器，想用，战斧版太笨拙了。如果我删除了 tomahawk 组件，p:calendar 可以正常工作，但是当我的 .xhtml 中有任何 tomahawk 组件时不会渲染（我也使用了一个 tomahawk 调度程序，但我没有在这里包含）。

```
 <h:outputLabel>Enter Appt Date:Time</h:outputLabel>

<t:inputDate popupCalendar="true" type="both" value="#{ScheduleMB.from}"/>

<p:calendar id="clientApptTime"  value="#{ScheduleMB.datePrime}"  
    pattern="HH:mm" timeOnly="true" mode="popup"     /> 

<h:outputLabel>Enter Appt. Length</h:outputLabel>

<h:selectOneMenu id="apptDuration" value="#{ScheduleMB.apptTime}">
        <f:selectItem itemValue="45" itemLabel="45 minutes"/>
    <f:selectItem itemValue="60" itemLabel="60 minutes"/>
    <f:selectItem itemValue="90" itemLabel="90 minutes"/>
    <f:selectItem itemValue="120" itemLabel="120 minutes"/>
</h:selectOneMenu> 
```

# ios - MagicalRecord - saveinBackground 不持久化数据？

> ID：12410213
> 
> 赞同：0
> 
> 时间：2012-09-13T15:53:16.567
> 
> 标签：ios, magicalrecord

我无法理解 和 之间的`[[NSManagedObjectContext defaultContext] save]`区别`[[NSManagedObjectContext defaultContext] saveInBackground]`。

当我使用该`save`功能时，它工作得很好，但从`saveInBackground`不持久化数据。简而言之，这就是区别：

```
// Save in background.. DOES NOT WORK
    [[NSManagedObjectContext defaultContext] saveInBackgroundErrorHandler:^(NSError *error){
        NSLog(@"FAILED TO SAVE!! Task: %@", task);
    }completion:^(void){
        NSLog(@"PERSISTED NEW TASK: %@", task);
    }];

    // Save in main thread.. WORKS
    [[NSManagedObjectContext defaultContext] save]; 
```

每次`saveInBackground`运行时，我都会看到“PERSISTED NEW TASK”日志条目。但是，当我重新启动应用程序时，数据不存在。当我使用时`save`，我重新启动应用程序并且数据在那里。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:23:29.050

不得不打电话`[context saveNestedContexts]`

# jquery - 使用jquery逐行获取表格单元格值

> ID：12410237
> 
> 赞同：6
> 
> 时间：2012-09-13T15:54:21.507
> 
> 标签：jquery

我有一张这样的桌子

```
<table class="wp-list-table widefat fixed posts">
        <tbody id="c_b">
    <tr>
        <td><b>Title</b></td>
        <td><b>Upcharge</b></td>
        <td><b>Profit Percentage</b></td>
        <td><b>Short Description</b></td>
    </tr>
    <tr>
        <td colspan="4"><input type="checkbox" id="selectall"> Bulk <u>Check/Uncheck</u></td>
    </tr>
    <tr>
        <td id="title_1"><input type="checkbox" id="product_1" value="123123_1" class="case"> 123123<br></td>
        <td id="upcharge_1">24</td>
        <td id="percentage_1">15</td>
        <td id="sdescription_1">This is a short</td>
    </tr>
    <tr>
        <td id="title_2"><input type="checkbox" id="product_2" value="A33232_2" class="case"> A33232<br></td>
        <td id="upcharge_2">24</td>
        <td id="percentage_2">15</td>
        <td id="sdescription_2">This is a short</td>
    </tr>
    <tr>
        <td id="title_22"><input type="checkbox" id="product_3" value="BEY-049_22" class="case"> Plane Shirt<br></td>
        <td id="upcharge_22">24</td>
        <td id="percentage_22">15</td>
        <td id="sdescription_22">SD for Plane shirt</td>
    </tr>
    <tr>
        <td id="title_23"><input type="checkbox" id="product_4" value="IRCTC_23" class="case"> Rail Neer<br></td>
        <td id="upcharge_23">24</td>
        <td id="percentage_23">15</td>
        <td id="sdescription_23">Rail neer short description</td>
    </tr>
    <input type="hidden" value="47474" id="licence_no" name="licence_no"><input type="hidden" value="47474" id="licence_no" name="licence_no">
    <input type="hidden" value="47474" id="licence_no" name="licence_no"><input type="hidden" value="47474" id="licence_no" name="licence_no">      
    </tbody>
    </table> 
```

我想逐行获取单元格值作为数组，为此我编写如下代码

```
$("tbody>tr").each(function(){
        var rowvalue = [];
        $("tbody>tr>td").each(function(){
            //alert($(this).text());
            rowvalue.push($(this).text());
        });
        alert(rowvalue);

    }); 
```

在这里，我一次获取所有值，它发出 n 次警报（n = 行数），但我想要 n 个具有该行值的数组。我怎样才能获得这些价值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-01T19:09:53.040

你可以用这个，

```
var rowvalues = [];
            $("tbody > tr").each(function () {
                var rowvalue = [];
                $(this).children().each(function () {
                    //alert($(this).text());
                    rowvalue.push($(this).text());
                });
                rowvalues.push(rowvalue);
            }); 
```

这里 rowvalues 数组将包含逐行值

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:22:03.243

演示：http: [//jsfiddle.net/iambriansreed/2Pgey/](http://jsfiddle.net/iambriansreed/2Pgey/)

```
var table_data = [];

$('tr').each(function(){

    var row_data = [];    

    $('td', this).each(function(){

        row_data.push($(this).text());   

    });    

    table_data.push(row_data);

});

console.log(table_data); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T16:03:11.327

您应该在每个函数的范围之外初始化数组。在每次迭代中，您都在清除先前迭代的数据。你可以使用`map`方法。

```
var rowvalue = [];
$("tbody > tr").each(function(i, v) {
    rowvalue[i] = $('td', this).map(function() {
        return $(this).text()
    }).get()
});

console.log(rowvalue); 
```

[http://jsfiddle.net/ydZBN/](http://jsfiddle.net/ydZBN/)

# html - 浮动列表有缩进，我不明白为什么

> ID：12410240
> 
> 赞同：0
> 
> 时间：2012-09-13T15:54:24.613
> 
> 标签：html, css, css-float

在某些时候，我的浮动链接列表以缩进结束，导致最后一个链接进入新行（或者`div`如果我为`ul`

我真的不知道从哪里开始寻找这个问题。我将继续并链接到该网站。这是该部分的 HTML：

```
<div id="navigation">
<ul id="navLinks">
    <li><a href="home.html">Home</a></li>

    <li><a href="alston.html">Alston</a></li>

    <li><a href="booking.html">Booking</a></li>

    <li><a href="photos.html" class="lastLink">Photos</a></li>

</ul>
</div> 
```

这是我*认为*唯一影响它的 CSS：

```
#navigation {
   position: relative;
   //width: 210px;
   //height: 600px;
   margin: 2px 0;
   font-size: 90%;
   font-weight: normal;
   clear:both;
   overflow:hidden;
}

//NAVIGATION BAR STUFF
#navLinks {
   list-style-type:none;
   //display:inline;
   margin-left:auto;
   margin-right:auto;
   width: 100%;
   padding:0;
   text-align:center;
   text-decoration: none;
   overflow:hidden;
}

ul#booking {
color:rgb(84, 154, 14);
}

ul#navlinks {
   text-algin: center;
   margin: 0;
   padding: 0;
}

ul#navLinks li { display: inline;
list-style-type: none;
   line-height: 150%;
   margin-right: 10px;
   margin-left: 10px;
   background-color: #fff; }

ul#navLinks li a
{
float: left;
text-align:center;
background-color: #ADF16A;
color: #000000;
text-decoration: none;
border-left: 0px;
border-top: 0;
border-bottom: 0;
border-right: 1px;
border-style: solid;
border-color: #7AE015;
width:161px;
padding:3px 0px;
}

ul#navLinks a:hover
{
   background-color: #CC7A00;
}

ul#navLinks .lastLink{
    border:0;
}
//ul#navLinks a 
//END OF NAVIGATION BAR STUFF 
```

整个 CSS 在[这里](http://www.wildgoosecottage.com/style1.css)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T15:57:08.013

您`#navLinks`的浏览器默认设置了一些左填充（在我的 cas 中`-webkit-padding-start: 40px;`）。如果您定义`padding-left: 0;`，它将被覆盖。

你确实在你的第 195 行覆盖了这个基础`style1.css`，它有`ul#navlinks {`但需要`ul#navLinks {`。

确保在 CSS 文件中对 s 进行拼写检查`text-align`，并在 CSS 文件中将类和 ID 大写时将它们大写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:03:26.460

如果您将 css 重置文件添加到您的站点，它应该可以解决您的问题，这与您的 UL 上的填充/边距有关。

一个 css 重置文件，除了许多其他的东西，将所有元素的填充和边距设置为零 - 允许您根据需要自由地设置所有内容的样式。

[http://meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)

# python - python只将首字母大写

> ID：12410242
> 
> 赞同：208
> 
> 时间：2012-09-13T15:54:32.070
> 
> 标签：python, capitalize, letter

我知道 .capitalize() 将字符串的第一个字母大写，但如果第一个字符是整数怎么办？

这

```
1bob
5sandy 
```

对此

```
1Bob
5Sandy 
```

* * *

## 回答 #1

> 赞同：282
> 
> 时间：2012-09-13T16:18:06.857

只是因为没有其他人提到它：

```
>>> 'bob'.title()
'Bob'
>>> 'sandy'.title()
'Sandy'
>>> '1bob'.title()
'1Bob'
>>> '1sandy'.title()
'1Sandy' 
```

然而，这也会给

```
>>> '1bob sandy'.title()
'1Bob Sandy'
>>> '1JoeBob'.title()
'1Joebob' 
```

即它不只是大写第一个字母字符。但是`.capitalize()`有同样的问题，至少在那个方面`'joe Bob'.capitalize() == 'Joe bob'`，所以嗯。

* * *

## 回答 #2

> 赞同：254
> 
> 时间：2012-09-13T15:56:40.733

如果第一个字符是整数，则不会将第一个字母大写。

```
>>> '2s'.capitalize()
'2s' 
```

如果你想要这个功能，去掉数字，你可以`'2'.isdigit()`用来检查每个字符。

```
>>> s = '123sa'
>>> for i, c in enumerate(s):
...     if not c.isdigit():
...         break
... 
>>> s[:i] + s[i:].capitalize()
'123Sa' 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2015-08-26T17:15:07.950

这类似于@Anon 的答案，因为它保持字符串的其余部分保持不变，而不需要 re 模块。

```
def sliceindex(x):
    i = 0
    for c in x:
        if c.isalpha():
            i = i + 1
            return i
        i = i + 1

def upperfirst(x):
    i = sliceindex(x)
    return x[:i].upper() + x[i:]

x = '0thisIsCamelCase'

y = upperfirst(x)

print(y)
# 0ThisIsCamelCase 
```

正如@Xan 指出的那样，该函数可以使用更多的错误检查（例如检查 x 是否是一个序列-但是我省略了边缘情况来说明该技术）

根据@normanius 评论更新（谢谢！）

感谢@GeoStoneMarten 指出我没有回答这个问题！-修复了

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2014-07-22T21:26:39.627

这是一个单行，它将大写第一个字母并保留所有后续字母的大小写：

```
import re

key = 'wordsWithOtherUppercaseLetters'
key = re.sub('([a-zA-Z])', lambda x: x.groups()[0].upper(), key, 1)
print key 
```

这将导致`WordsWithOtherUppercaseLetters`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-04-11T13:01:36.640

看到[这里](https://stackoverflow.com/questions/1549641/how-to-capitalize-the-first-letter-of-each-word-in-a-string-python)陈厚武回答，可以使用字符串包：

```
import string
string.capwords("they're bill's friends from the UK")
>>>"They're Bill's Friends From The Uk" 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-02-25T10:23:38.640

单线：`' '.join(sub[:1].upper() + sub[1:] for sub in text.split(' '))`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-10-09T17:36:58.850

```
def solve(s):
    for i in s[:].split():
        s = s.replace(i, i.capitalize())
    return s 
```

这是工作的实际代码。.title() 在 '12name' 的情况下不起作用

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-13T16:06:03.383

我想出了这个：

```
import re

regex = re.compile("[A-Za-z]") # find a alpha
str = "1st str"
s = regex.search(str).group() # find the first alpha
str = str.replace(s, s.upper(), 1) # replace only 1 instance
print str 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-11-16T11:25:33.193

您可以使用正则表达式替换`preceded by a digit`每个单词的第一个字母 ( )：

```
re.sub(r'(\d\w)', lambda w: w.group().upper(), '1bob 5sandy')

output:
 1Bob 5Sandy 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-02-10T01:55:34.813

```
def solve(s):

names = list(s.split(" "))
return " ".join([i.capitalize() for i in names]) 
```

> 接受像你的名字这样的输入：john doe

> 返回第一个大写的字母。（如果第一个字符是数字，则不发生大写）

> 适用于任何名称长度

# java - 从什么时候开始 if/else 需要大括号？

> ID：12410247
> 
> 赞同：9
> 
> 时间：2012-09-13T15:54:44.300
> 
> 标签：java, netbeans

我刚刚在最新的 Netbeans 中启动了一个新项目，我注意到它已经开始为我提供如下代码的代码建议：

```
 if (a == null) x = 0;
    else x = 1; 
```

它说

```
If-Else Statements MUST use Braces 
```

它想“修复”它：

```
 if (a == null) {
        x = 0;
    }
    else {
        x = 1;
    } 
```

我根本不想要。我对此很特别，它使代码看起来不必要的混乱。我有成千上万行代码不使用（而且显然不需要）额外的大括号。假设 Netbeans 是正确的，那么这个要求是什么时候发生的，是什么推动了它？

PS我知道我可以关闭这些消息。

更新问题：

我写这篇文章的方式可能并不明显，但根据@corsiKa 下面的评论，也许我应该澄清一下。我真的不想讨论花括号是否**可取**。我想知道它们是否变得**必要**。

编写和制作 Netbeans 的男孩和女孩通常都很好地融入了社区以及 Java 正在采取什么方向或正在考虑什么。所以我认为，当他们使用咨询机制来提醒我们*Java 语法将会改变*并且我使用的代码实践将在某个时候被弃用时，这是可能的。

从下面 saber_raider 的回答看来，答案是否定的。正如 Mystical 所建议的那样，Netbeans 的建议似乎夸大了**MUST这个词。**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-13T15:55:51.057

那是代码咨询。戴上牙套总是安全的`if/else`。缺少大括号可能会在维护时造成混乱。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-13T15:58:04.307

这绝对不是 java 的语法要求，而只是 netbeans 的一个特性。如果您确定自己在做什么，请随时将其关闭...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-13T16:02:22.597

毕竟这是一个建议，而不是规则。我见过很多情况，其中缺少括号会直接影响“可读性”和维护性，因为 if 仅包装下一行代码而不是接下来的两行，如下例所示：

```
if(condition)
    doSomething();
    condition = false; 
```

`condition`始终设置为 false 并导致错误。

在您声明的特定情况下（变量），我会使用内联 if ( `x = a == null ? 0 : 1;`) 而不是`if-else`，但这只是我的意见。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-13T15:57:16.437

它不需要，但它使阅读它的人更容易理解代码。它还可以使您免于难以找到错误。

# javascript - 构造函数的 Javascript Date() 参数

> ID：12410248
> 
> 赞同：0
> 
> 时间：2012-09-13T15:54:45.533
> 
> 标签：javascript, date

假设我想为 2012 年 9 月 1 日 10:11:15 h 创建一个日期对象。

我想通了：

```
past = new Date(2012,08,01,10,11,15);// works!
past = new Date('2012,08,01,10,11,15');// doesn't work. 
```

问题是，我想将它与一种方法结合使用：

```
past = new Date(mypastformatfunc(mystring_to_format)); 
```

这给了我NaN。没有创建有效的日期对象。我检查了 mypastformatfunc() 的返回，看来我的格式正确。关于报价是否有任何转义问题？我怎样才能让它工作？这真的很奇怪......谢谢。

编辑解决：问题是它不是一个值而是单个参数。它们不能一次通过函数的返回传递....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T15:59:56.427

使用日期字符串作为构造函数的参数。

```
past = new Date('2012,08,01,10,11,15'.replace(/(\d+),(\d+),(\d+),(\d+),(\d+),(\d+)/, '$1/$2/$3 $4:$5:$6'));

function mypastformatfunc(str) {
  return str.replace(/(\d+),(\d+),(\d+),(\d+),(\d+),(\d+)/, '$1/$2/$3 $4:$5:$6')
} 
```

# c# - 如何从另一个 ascx 获取一个 ascx 控件值

> ID：12410255
> 
> 赞同：0
> 
> 时间：2012-09-13T15:54:58.630
> 
> 标签：c#, asp.net

我有包含 parent.ascx 用户控件的 Family.aspx 页面。

在 parent.ascx 中包含两个不同的用户控件，即 childA.ascx、childB.ascx 和其他五个文本框。应用一些逻辑，我使子控件可见真或假。在 ChildA 和 childB 用户控件中同样包含五个文本框控件。

在 Parent.ascx.cs 中，我有 SaveData 方法，它将整个数据保存在 DB 中。所以关键是如何在 parent.ascx.cs 中获取 ChildA 或 ChildB 文本框值，以便我可以调用 SaveData。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T15:57:30.407

如果`ChildA`并且`ChildB`是您的自定义用户控件，您可以将从`TextBox`控件检索到的值公开为公共属性（如果需要，进行一些额外的处理），然后在`Parent.ascx.cs`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T15:57:21.437

您可以将来自 ChildA.ascx / ChildB.ascx 的数据存储在 Session[] 中。比，当您调用 SaveData 时，您可以根据需要管理数据！只是一个选项，我真的不知道你的 web 应用程序的场景。

# javascript - 如何在删除文本框中的字符时使用 jquery 删除值

> ID：12410258
> 
> 赞同：1
> 
> 时间：2012-09-13T15:55:15.250
> 
> 标签：javascript, jquery, jquery-autocomplete

我有这个代码

```
<input type="hidden" value="[{"value":1,"label":"Emmoia Boently"},{"value":6,"label":"John Smith"}]" name="group[users][]" id="users">

<input type="text" value="Emmoia--Boently, John--Smith, " name="autocompleter_group[users][]" id="autocompleter_userss" class="ui-autocomplete-input" autocomplete="off" role="textbox" aria-autocomplete="list" aria-haspopup="true"> 
```

现在我的问题是当前的 javascript 正在将文本框中的值添加到隐藏的字段中。

但是当我删除文本时，它不会从隐藏的输入字段中删除。

所以我想在 jquery 中做，当我开始删除主文本框中的文本时，隐藏输入字段中的值也会被删除。

就像我们在 SO 中删除问题页面中的标签字符时所做的那样

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T15:58:08.310

```
$("#autocompleter_userss").on("keyup", function() {
    $("#users").val($(this).val());
}); 
```

**[小提琴](http://jsfiddle.net/y64Tk/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T15:58:10.433

**更新：**似乎您正在寻找标签编辑器。有关详细链接，请参阅[此帖子](https://stackoverflow.com/questions/519107/jquery-autocomplete-tagging-plug-in-like-stackoverflows-input-tags):)

* * *

```
$('input#1').change(function(){
  $('input#hidden').val($(this).val());
}); 
```

此外，您可以尝试一些 data-binidng 库，例如[knockout.js](http://knockoutjs.com/examples/helloWorld.html)等。

# db2 - DB2 安全性 - Kerberos

> ID：12410270
> 
> 赞同：0
> 
> 时间：2012-09-13T15:55:48.890
> 
> 标签：db2, kerberos

有谁知道在 DB2 中您是否可以运行任何 SQL 来显示您是否使用 kerberos 连接进行连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T15:02:03.257

以下可能适用于；它没有明确说明连接是通过 Kerberos 进行身份验证的，但它暗示了通过 Kerberos 进行身份验证。

```
 SELECT 1 FROM SYSIBMADM.DBMCFG
    WHERE NAME='authentication'
    AND VALUE IN('KERBEROS','KRB_SERVER_ENCRYPT') FETCH FIRST ROW ONLY 
```

# c - 如何在不使用 strtok 的情况下在 C 中拆分字符串

> ID：12410280
> 
> 赞同：7
> 
> 时间：2012-09-13T15:56:23.007
> 
> 标签：c, string, token

```
#include <stdio.h>
int
main() {
    char string[] = "my name is geany";
    int length = sizeof(string)/sizeof(char);
    printf("%i", length);
    int i;
    for ( i = 0; i<length; i++ ) {

    }   
    return 0;
} 
```

如果我想分别打印“my”“name”“is”和“geany”，那我该怎么办。我正在考虑使用分隔符，但我不知道如何在 C 中执行此操作

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-13T16:00:43.873

1.  以指向字符串开头的指针开始
2.  逐个字符迭代，寻找你的分隔符
3.  每次找到一个时，您都会从长度不同的最后一个位置得到一个字符串 - 用它做你想做的事
4.  将新的起始位置设置为分隔符 + 1，然后转到步骤 2。

在字符串中剩余字符时执行所有这些操作...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-01T20:22:18.203

我需要这样做，因为正在运行的环境有一个受限库，缺少`strtok`. 以下是我如何拆分连字符分隔的字符串：

```
 b = grub_strchr(a,'-');
     if (!b)
       <handle error>
     else
       *b++ = 0;

     c = grub_strchr(b,'-');
     if (!c)
       <handle error>
     else
       *c++ = 0; 
```

在这里，`a`以复合字符串 开始生命`"A-B-C"`，在代码执行后，有三个以空字符结尾的字符串 , ，`a`它们的值分别为,和。是代码对缺少的分隔符做出反应的占位符。`b``c``"A"``"B"``"C"``<handle error>`

请注意，像 一样`strtok`，通过将分隔符替换为 NULL 来修改原始字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T15:19:39.057

这会在换行符处断开字符串并修剪报告字符串的空格。它不会像 strtok 那样修改字符串，这意味着它可以用于`const char*`来源不明的字符串，而 strtok 不能。不同之处在于`begin`/`end`是指向原始字符串字符的指针，因此不像 strtok 给出的那样以空字符结尾的字符串。当然，这使用静态本地，因此不是线程安全的。

```
#include <stdio.h> // for printf
#include <stdbool.h> // for bool
#include <ctype.h> // for isspace

static bool readLine (const char* data, const char** beginPtr, const char** endPtr) {
    static const char* nextStart;
    if (data) {
        nextStart = data;
        return true;
    }
    if (*nextStart == '\0') return false;
    *beginPtr = nextStart;

    // Find next delimiter.
    do {
        nextStart++;
    } while (*nextStart != '\0' && *nextStart != '\n');

    // Trim whitespace.
    *endPtr = nextStart - 1;
    while (isspace(**beginPtr) && *beginPtr < *endPtr)
        (*beginPtr)++;
    while (isspace(**endPtr) && *endPtr >= *beginPtr)
        (*endPtr)--;
    (*endPtr)++;

    return true;
}

int main (void) {
    const char* data = "  meow ! \n \r\t \n\n  meow ?  ";
    const char* begin;
    const char* end;
    readLine(data, 0, 0);
    while (readLine(0, &begin, &end)) {
        printf("'%.*s'\n", end - begin, begin);
    }
    return 0;
} 
```

输出：

```
'meow !'
''
''
'meow ?' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T16:00:13.753

```
use strchr to find the space.
store a '\0' at that location.
the word is now printfable.

repeat
    start the search at the position after the '\0'
    if nothing is found then print the last word and break out
    otherwise, print the word, and continue the loop 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-13T16:31:36.950

重新发明轮子通常是个坏主意。学会使用实现函数也是一个很好的训练。

```
#include <string.h>

/* 
 * `strtok` is not reentrant, so it's thread unsafe. On POSIX environment, use
 * `strtok_r instead. 
 */
int f( char * s, size_t const n ) {
    char * p;
    int    ret = 0;
    while ( p = strtok( s, " " ) ) { 
        s += strlen( p ) + 1; 
        ret += puts( p ); 
    }
    return ret;
} 
```

# c# - ClientBase 类在 Reference.cs 文件中不可用

> ID：12410283
> 
> 赞同：1
> 
> 时间：2012-09-13T15:56:27.823
> 
> 标签：c#, wcf, wcf-client

我使用以下 wsdl 在 Visual Studio 2010 中添加了服务引用。添加成功。这是从模式 xsd 文件生成的 wsdl；不是来自实际的服务代码。知道为什么这没有在 Reference.cs 文件中生成所需的类和方法吗？

```
<?xml version="1.0" encoding="utf-8"?>
<definitions xmlns:import0="urn:thinktecture-com:demos:restaurantservice:messages:v1" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:import1="urn:thinktecture-com:demos:restaurantservice:data:v1" xmlns:tns="urn:lijo:demos:multiplyservice:calculation:v1" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" name="CalculationService" targetNamespace="urn:lijo:demos:multiplyservice:calculation:v1" xmlns="http://schemas.xmlsoap.org/wsdl/">
<wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" />
<types>
<xsd:schema>
  <xsd:import schemaLocation="C:\toolbox\LijosServiceApp\NewService\RestaurantMessages.xsd" namespace="urn:thinktecture-com:demos:restaurantservice:messages:v1" />
  <xsd:import schemaLocation="C:\toolbox\LijosServiceApp\NewService\RestaurantData.xsd" namespace="urn:thinktecture-com:demos:restaurantservice:data:v1" />
</xsd:schema>
</types>

<message name="getMultipliedIn">
<wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" />
<part name="parameters" element="import0:getMultiplied" />
</message>
<message name="getMultipliedOut">
<wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" />
<part name="parameters" element="import0:getMultipliedResponse" />
</message>

<portType name="CalculationServiceInterface">
<wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" />
<operation name="getMultiplied">
  <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" />
  <input message="tns:getMultipliedIn" />
  <output message="tns:getMultipliedOut" />
</operation>
</portType>

<binding name="BasicHttpBinding_CalculationServiceInterface" type="tns:CalculationServiceInterface">

<soap:binding transport="http://schemas.xmlsoap.org/soap/http" />

<operation name="getMultiplied">
  <soap:operation soapAction="urn:lijo:demos:multiplyservice:calculation:v1:getMultipliedIn" style="document" />
  <input>
    <soap:body use="literal" />
  </input>
  <output>
    <soap:body use="literal" />
  </output>
  </operation>
  </binding>
  <service name="CalculationServicePort">
 <port name="CalculationServicePort" binding="tns:BasicHttpBinding_CalculationServiceInterface">
  <soap:address location="http://localhost/CalculationService" />
  </port>
 </service>
 </definitions> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:42:38.297

问题在于该工具使用的 xml 命名空间不正确。请参阅[400 Bad Request Exception: Simple SOAP WCF service with small data中更正后的 wsdl](https://stackoverflow.com/questions/12410947/400-bad-request-exception-simple-soap-wcf-service-with-small-data)

# python - 编码python

> ID：12410284
> 
> 赞同：2
> 
> 时间：2012-09-13T15:56:28.530
> 
> 标签：python, encode

我想在**python**中连接一些字符串（波斯字符串） ：

```
 for t in lstres:
            with conn:
                c = conn.cursor()   
                q="SELECT fa FROM words WHERE en ='"+t+"'"
                c.execute(q)
                lst=c.fetchall()

                if lst:
                    W.append(lst)
                else:
                    W.append(t)

        cnum=1
        for can in W:
            cnum=cnum*len(W)

        candida=Set()

        for ii in range(1,min(20,cnum)):
            candid=""
            for w in W:
                candid+=str(" "+random.choice (w)[0]).encode('utf-8')
            candida.add(candid) 
```

但它说：

```
UnicodeDecodeError: 'ascii' codec can't decode byte 0xd8 in position 1: ordinal not in  range(128) 
```

问题是什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:23:06.890

Python 正在尝试从 unicode 字符串到 ASCII 编码字符串的隐式类型转换。从您发布的内容很难判断发生这种情况的位置，但最好确保您始终使用 unicode。为此，您需要`u`在所有字符串前面添加一个，如下所示：`u"A unicode string"`并始终使用`unicode()`而不是`str()`.

Unicode 经常被英语语言程序员和教程所忽视，因为在英语中，您只需使用 ASCII 编码字符即可。不幸的是，世界其他地方为此受苦，因为大多数语言使用 ASCII 不支持的字符。[查看 Python Unicode HOWTO](http://docs.python.org/howto/unicode.html)以获取有关 Unicode 良好编程实践的一些指导可能会很有用。

我还发现[这篇](http://www.joelonsoftware.com/articles/Unicode.html)文章非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:46:27.703

问题在这里：

```
for ii in range(1,min(20,cnum)):
   candid=""
   for w in W:
       candid+=str(" "+random.choice (w)[0]).encode('utf-8')
    candida.add(candid) 
```

它应该是

```
for ii in range(1,min(20,cnum)):
    candid=u""
    for w in W:
        candid+=str(u" "+random.choice (w)[0]).encode('utf-8')
    candida.add(candid) 
```

但这不是惯用的python

你应该做

```
for ii in range(1,min(20,cnum)):
     candida.add(u" ".join(random.choice (w)[0] for w in W)) 
```

此外，您的脚本中有一个潜在的 sql 注入

```
q="SELECT fa FROM words WHERE en ='"+t+"'"
c.execute(q) 
```

你应该做

```
q="SELECT fa FROM words WHERE en =?"
c.execute(q, (t,)) 
```

`(t,)`是一个只有一个元素的元组

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:02:07.387

您需要将您的字符串声明为 Unicode ：

```
u'Your string here éàèç×...' 
```

# yii - yii 检测范围是否在使用中

> ID：12410295
> 
> 赞同：0
> 
> 时间：2012-09-13T15:57:02.847
> 
> 标签：yii, scopes, named-scopes

我想知道是否有一种方法可以检测是否在 yii 的 AR 搜索中使用了范围？

例如，一个模型可能包含 2 个作用域：

```
class MyModel extends CActiveRecord
{
    ...
    function myScope1()
    {
        $this->getDbCriteria()->mergeWith(array(
            'join'=>'etc...',
            'condition'=>'foo = bar',
        ));
        return $this;
    }

    function myScope2()
    {
        $this->getDbCriteria()->mergeWith(array(
            'join'=>'etc...',
            'condition'=>'foo2 = bar2',
        ));
        return $this;
    }
    ....
} 
```

我这样称呼AR：

```
$results = MyModel::model()->myScope1()->myScope2()->findAll(); 
```

这是一个非常动态的站点，有超过 2 个范围，有些使用，有些没有。如果正在使用另一个范围，则有几个范围不应应用。为了避免数百条`if else`语句，我可以这样做：

```
class MyModel extends CActiveRecord
{
    ...
    function myScope1()
    {
        $this->getDbCriteria()->mergeWith(array(
            'condition'=>'foo = bar',
        ));
        return $this;
    }

    function myScope2()
    {
        if($this->appliedScopes('myScope1')==false)
        {
            // scope myScope1 isn't applied, so apply this scope:
            $this->getDbCriteria()->mergeWith(array(
                'condition'=>'foo2 = bar2',
            ));
        }
        return $this;
    }
    ....
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:04:46.693

典型的，几乎在发布后立即想到一个解决方法！

就我而言，在两个范围之间应用“或”将起作用，所以；

```
class MyModel extends CActiveRecord
{
    ...
    function myScope1()
    {
        $this->getDbCriteria()->mergeWith(array(
            'join'=>'etc...',
            'condition'=>'foo = bar',
        ));
        return $this;
    }

    function myScope2($useAnd=true)
    {
        $this->getDbCriteria()->mergeWith(array(
            'join'=>'etc...',
            'condition'=>'foo2 = bar2',
        ),$useAnd);
        return $this;
    }
    ....
} 
```

像这样调用：

```
$results = MyModel::model()->myScope1()->myScope2(false)->findAll(); 
```

# bash - 获取没有特定文件类型 cygwin/bash 的目录

> ID：12410298
> 
> 赞同：0
> 
> 时间：2012-09-13T15:57:05.983
> 
> 标签：bash, loops, scripting, cygwin

我正在尝试组织我的音乐收藏的专辑封面，用于 XBMC 等，以及我个人基于强迫症的原因。为此，我想遍历我的音乐收藏中的每个文件夹，（因此还有文件`music`。`$(find . -type d)`我检查每个文件夹是否存在 jpeg。如果存在，则将其复制以调用`cover.jpg`。如果没有 jpeg找到了，应该将文件夹的名称添加到列表中，然后我将自己搜索谷歌。我正在使用的代码如下。

```
#!/bin/bash

IFS=$'\n'

touch missing

cd /cygdrive/d/music

for i in $(find . -type d)
    do cd $i
    if [ -e '*.jpg' ]
    then
        for j in *.jpg
            do cp $j 'cover.jpg'
        done
    else
        cd ..
        $i >> missing
    fi
done 
```

# 问题

1.  `cd $i`总是失败，因为目录不存在。
2.  `$i >> missing`总是失败，权限被拒绝错误，但是`ls -l missing`给出`-rwxrwxrwx+ 1 Username None 0 Sep 13 16:45 missing`

## 更新：

在尝试了几次迭代以使脚本正常工作后，我不得不放弃并简单地使用这个[专辑封面下载](http://sourceforge.net/projects/album-art/)器，事后看来这是显而易见的事情。我用修改后的脚本将答案标记为已接受，因为它让我更接近我所知道的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:03:56.860

`cd $i`对于像“艺术家姓名 - 歌曲名称.mp3”这样的文件将失败。外壳会`Artist` `Name`在空白处将其分解为等，它会破坏。您可以在调试问题`$i`之前打印。`cd`

`$i >> missing`将失败，因为您试图`$i`作为脚本执行并将内容输出到丢失。如果你想输入文件名，你应该使用类似`echo "$i" >> missing`.

我建议您使用真正的脚本语言，例如 Perl 或 Python，而不是在 shell 中执行此操作。名称中带有空格的文件真的很痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:04:13.883

> 1) cd $i 总是失败，因为目录不存在。

由于结果与`find . -type -d`您的初始工作目录相关，因此您需要 cd 回到基本目录，然后再执行下一个`cd $1`. 返回上一个目录的快速方法是`cd -`.

> 2) $i >> missing 总是失败，出现权限被拒绝错误，

这里有两个问题。首先，通过这样做，`$i >> missing`您实际上是在尝试`$i`作为命令执行。如果要将文件名附加到文件中，则需要使用`echo $i >> missing`.

其次，您是在初始工作目录中创建的，因此一旦您在其他地方编辑`missing`，您实际上是在处理不同的文件。要引用同一个文件，请使用绝对路径。`missing``cd`

试试这个：（我试图让脚本尽可能接近你所拥有的，并评论了我改变的行。我还引用了所有路径以更好地处理带空格的文件名）

```
#!/bin/bash
IFS=$'\n'
MISSING="$(pwd)/missing"  # store absolute path
> "$MISSING". # create new or empty existing

cd /cygdrive/d/music

for i in $(find . -type d)
    do 
    cd "$i"
    if [ -e *.jpg ]  # wildcard not expanded if quoted
    then
        for j in *.jpg
            do cp "$j" 'cover.jpg'
        done
    else
        echo "$i" >> "$MISSING"  # use $MISSING
    fi
    cd -  # go back to previous directory
done 
```

ps 以防万一您没有注意到，请注意，如果您`*.jpg`在一个目录中有多个文件，您的脚本基本上会反复覆盖`cover.jpg`最后一个作为实际版本的文件。`cp: 'cover.jpg' and 'cover.jpg' are the same file`此外，如果您有多个 jpg 文件并且`cover.jpg`已经存在，您可能会看到错误“ ”。

# java - 在脸书的墙上贴一些东西

> ID：12410300
> 
> 赞同：0
> 
> 时间：2012-09-13T15:57:07.780
> 
> 标签：java, android, facebook, eclipse

我想在 facebook 墙贴上发布一条消息。我正在使用此代码。如果我使用

`.setType(image/jpeg)`它附加了图像并且工作正常。但是我无法让它与消息一起使用。请告诉我如何解决这个问题

```
String msg = "My Message" ;
            Intent shareIntent = ShareCompat.IntentBuilder.from(MainMenu.this)
                      .setType("text/plain")
                      .setText(msg)
                      .getIntent()
                      .setPackage("com.facebook.katana");
            try{
            startActivity(shareIntent);
            }catch (ActivityNotFoundException e) {
                 Toast.makeText(MainMenu.this, "Sorry, but it seems that application is not installed", Toast.LENGTH_LONG).show();
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:09:44.650

检查以下链接，您将获得一些信息

[http://developers.facebook.com/docs/reference/api/](http://developers.facebook.com/docs/reference/api/)

这可能会帮助你

# azure - 找不到时间戳

> ID：12410305
> 
> 赞同：1
> 
> 时间：2012-09-13T15:57:29.943
> 
> 标签：azure, cloud, azure-table-storage

在我使用 TableStorage 的 Azure 项目中，出现以下异常：

*Microsoft JScript 中的运行时错误：Sys.WebForms.PageRequestManagerServerErrorException：在所选数据源中找不到名为“TimeStamp”的字段或属性*

原来的德语信息是：

*Microsoft JScript 中的 Laufzeitfehler：Sys.WebForms.PageRequestManagerServerErrorException: Feld oder Eigenschaft mit dem Namen TimeStamp wurde nicht in der ausgewählten Datenquelle gefunden。*

如果我尝试访问 TableStorage，我总是会得到这个。该代码是例如

```
storageAccount = GlobalStorageAccount.GetGlobalStorageAccount();
storageAccount.CreateCloudTableClient().CreateTableIfNotExist(tableName); 
```

GlobalStorageAccount 类：

```
public class GlobalStorageAccount
{
    private static CloudStorageAccount _storageAccount;

    public static CloudStorageAccount GetGlobalStorageAccount()
    {
        if (_storageAccount == null)
        {
            var acc = new StorageCredentialsAccountAndKey("...", "...");
            _storageAccount = new CloudStorageAccount(acc, true);
        }
        return _storageAccount;
    }
} 
```

# asp.net - 如何使用版本控制在多个网站上使编译的代码库保持最新？

> ID：12410310
> 
> 赞同：3
> 
> 时间：2012-09-13T15:57:47.753
> 
> 标签：asp.net, .net, version-control, tfs, versioning

目前，我们在整个公司的 Intranet 中拥有一长串各种网站。大多数都在防火墙内，需要 Active Directory 帐户才能访问。最近，我们的一个问题是网站数量的增加以及添加了一个通用代码库来存储我们的数据库访问类、通用帮助函数、序列化方法等。我们的目标是跨平台使用该框架整个公司的所有网站。

目前，我们已根据这些更改一致地升级了内部数据输入应用程序。它是最新的。然而，问题在于维护所有其他网站。是否有最佳实践或方法可以让我在每个网站上找到版本并进行相应升级？我可以有一个集中的地方来保存这些 DLL 和站点引用它们吗？找出这些网站上的版本而不必浏览每个网站、找出版本并在每次更改后升级的最佳方法是什么？

请记住，我们运行最新的 TFS，并且是一个 .NET 开发团队。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T02:28:54.613

在我的工作中，我们有一个与你类似的设置，许多使用公共库的内部应用程序，我花了一年中最好的时间来整理这些。

首先要注意的是，您提到的任何内容都与 TFS 没有任何关系，但实际上是您的应用程序及其组件的打包和部署方式的症状。

以下是一些帮助您入门的想法：

# 设置自动/连续构建

这是您需要做的第一件事。如果必须，请使用 TFS 中的构建工具，或者投资于 TeamCity 之类的东西（这很棒）。评估一切。找到你喜欢并且其他人都可以忍受的东西。你之所以需要找到你喜欢的东西，是因为你最终会对它负责。

设置自动构建之所以如此重要，是因为这是您解决其余问题的起点。

# 设置自动部署

现在，您的构建服务器应该正在构建每个可部署的工件。不再需要手动部署。不再从工作站进行部署。没有更多的视觉工作室发布功能。很难摆脱这一点，但这是值得的。

如果您有很多 Web 项目，那么可以考虑使用 Web 部署，它可以使用 msbuild/powershell 轻松自动化，或者尝试使用 octopus deploy 之类的东西。

# 使用nuget打包常用组件

到目前为止，您的公共代码应该有自己的自动构建，但是您如何自动部署公共组件？将其打包到 nuget 中，然后将其放在共享中以供使用或将其托管在 nuget 服务器中（TeamCity 内置了一个）。一个好的构建服务器可以自动为你更新你的 nuget 包（如果你总是需要使用最新版本），你可以通过检查你的`packages.config`.

* * *

我知道这需要考虑很多，但它本质上是实现持续交付的基础 (http://continuousdelivery.com/)。

请注意，要做到这一点需要很长时间，但这个过程是渐进的，你可以随着时间的推移而发展。然而，你等待的时间越长，它就越难。不要觉得你需要同时升级所有项目，你不需要。只是造成最痛苦的那些。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T02:57:41.327

我只想跳出针对您的问题的特定解决方案的空间，并解决您必须巩固工作量的潜在愿望。请注意，任何修补/升级方案都会产生您必须解决的成本 - 没有灵丹妙药。特别是，您想要实现的目标通常会产生构建/部署开销（如 jonnii 所述）或运行时开销（验证新版本以确保一切按预期工作）。

在你的情况下，因为你已经构建了你的产品，我希望你会走构建/部署路线。

请记住，即使使用二进制等价（一切都可以编译，并且单元测试通过），升级后应用程序的行为仍然存在某种不同的风险，因此您将无法避免至少在您的所有程序中进行一些基本测试应用程序（GAC 方法特别容易受到这种风险的影响）。

您*可能会*发现更容易接受这一点，仅仅因为您构建了一个新版本的二进制文件，并不意味着它应该推广到所有 Web 应用程序，即使是那些已经正常运行的应用程序（如果没有损坏的话。 ..)。

If that is acceptable, then you will reduce your workload by only incurring resource expense on testing applications that actually *need* to be touched.

# zend-framework - 有没有使用 Zend/Code/Generator 组件的例子

> ID：12410312
> 
> 赞同：1
> 
> 时间：2012-09-13T15:57:51.463
> 
> 标签：zend-framework

我将 Symfony 的控制台组件与 Zend_CodeGenerator 组件一起使用。例子很少，但我得到了它的工作 - [http://framework.zend.com/manual/1.12/en/zend.codegenerator.html](http://framework.zend.com/manual/1.12/en/zend.codegenerator.html)。当然，它不处理名称空间和`use`语句。今天我想我试试[Zend/Code/Generator](http://goo.gl/CPNTx)。我在这里找到了一篇旧帖子 [http://mwop.net/blog/261-Code-Generation-with-ZendCodeGenerator.html](http://mwop.net/blog/261-Code-Generation-with-ZendCodeGenerator.html)。

因此，我使用 Composer 安装了组件并更新了我的代码（见下文）。我遇到了未生成文档块的问题（请参阅新版本）。没有结果错误表明参数错误只是没有文档块。我快速查看了源代码、api 甚至一些单元测试。所以在我放弃这个并坚持使用 ZF1 CodeGenerator 之前，我想知道是否有任何使用 docblocks 的示例。

**旧版**

```
<?php
$class = new Zend_CodeGenerator_Php_Class();
$docblock = new Zend_CodeGenerator_Php_Docblock(array(
    'shortDescription' => 'Index controller',
    'tags' => array(
        array(
            'name' => 'category',
            'description' => 'Controller',
        ),
        array(
            'name' => 'package',
            'description' => 'Application\Controller',
        ),
    ),
));
$methods = array(
    array(
        'name' => 'indexAction',
        'docblock' => new Zend_CodeGenerator_Php_Docblock(array(
            'shortDescription' => 'Index action',
            'tags' => array(
                new Zend_CodeGenerator_Php_Docblock_Tag_Return(array(
                    'datatype' => 'void',
                )),
            ),
        )),
    ),
);
$class->setName("Admin_IndexController")
      // Additional step needed to add namespace and use statement
      ->setExtendedClass('Action')
      ->setDocblock($docblock)
      ->setMethods($methods);
$file = new Zend_CodeGenerator_Php_File(array(
    'classes'  => array($class),
));
$code = $file->generate();
// Remove all that extra blank lines
$code = preg_replace("/(^[\r\n]*|[\r\n]+)[\s\t]*[\r\n]+/", "\n", $code);
if (file_put_contents('application/modules/admin/controllers/IndexController.php', $code)) {
    $this->output->writeln(
        'Controller generated ' . realpath('application/modules/admin/controllers/IndexController.php')
    );
} 
```

**新版本**

```
<?php
$classGenerator = new ClassGenerator(); 
$classGenerator->setName('Admin_IndexController')
               ->setExtendedClass('Action')
               ->setDocBlock(
                    new DocBlockGenerator(
                        'Index controller',
                        '',
                        array(
                            new Tag(
                                array(
                                    'name' => 'category', 
                                    'description' => 'Controller'
                                )
                            ),
                            new Tag(
                                array(
                                    'name' => 'package', 
                                    'description' => 'Application\Controller'
                                )
                            )
                        )
                    )
               )
               ->addMethods(
                    array(
                        new MethodGenerator(
                            'indexAction',
                            array(),
                            null,
                            null,
                            new DocBlockGenerator(
                                'Index action'
                            )
                        )
                    )
                );          
$fileGenerator = new FileGenerator();
$fileGenerator->setUse('Application\Controller\Action')
              ->setClass($classGenerator);
$code = $fileGenerator->generate();
// ... 
```

# asp.net-mvc-4 - IIS 7.5 上的 ASP.NET MVC 4，返回 404。与无扩展路由映射有关

> ID：12410314
> 
> 赞同：15
> 
> 时间：2012-09-13T15:57:59.450
> 
> 标签：asp.net-mvc-4, iis-7.5

我已经将 MVC 4 网站部署到带有 IIS 7.5 的 Windows 2008 R2 服务器。.NET 4.5 安装在服务器上。

该网站在本地运行良好。所有路由工作正常。但是，当我将它放在服务器上时，没有任何效果。我已经通过在站点中放置一个静态文本文件来确认 DNS/绑定正在工作，并且这个工作正常。

这是我尝试过的一些事情：

*   默认路由 / 返回 403.13 - 表示目录浏览已禁用（正确）。这肯定应该映射到/home/index？
*   任何路由（例如 /Organisation、Organisation/Index）都只返回 404。
*   确保我的所有 DLL 都被复制（根据[http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx](http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx)）

我已经尝试/确认：

*   HttpRedirection 安装在 IIS7 上（根据[http://support.microsoft.com/kb/2023146](http://support.microsoft.com/kb/2023146)）
*   HttpErrors 安装在 IIS7 上
*   我所有的 DLL 都已就位

我错过了什么吗？我下一个绝望的举动是安装完整的 ASP.NET MVC 4 堆栈，包括 Visual Studio Express、SQL Express 等，看看它是否有效。我真的不想这样做。这是生产服务器！

*更新：* 我应该补充一点，同一个站点在内部等效配置上工作，在登台服务器上。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-20T22:26:30.003

我有同样的问题。您应该尝试一个修补程序：http: [//support.microsoft.com/kb/980368](http://support.microsoft.com/kb/980368) 它为我解决了这个问题。

# image - 谷歌图片搜索路径

> ID：12410316
> 
> 赞同：1
> 
> 时间：2012-09-13T15:58:04.743
> 
> 标签：image, seo

搜索引擎优化问题，如果服务器上的图像被允许被索引，用描述性名称明智地命名并且没有过大，图像路径或文件夹是否会影响该图像在谷歌图像搜索中的排名？

例如，图片 A 的排名是否高于图片 B（如下） - 如果是，为什么？

A：/images/cat-on-a-chair.jpg B：/images/repository/cat-on-a-chair.jpg

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:37:38.467

对一个因素进行受控案例研究太困难了，如果它确实有帮助，那就太微不足道了。

简短的回答：这是极不可能的。

将图像本身和图像所在的页面视为两个完全独立的实体（它们确实如此）。当您进行 Google 图片搜索时，您会找到包含该图片的页面。因此，排名靠前的页面可能会成为图像结果的良好候选者。*您实际上并没有被直接返回图像。*

影响图像排名的其他因素包括特定于图像的数据，如 ALT 标签、描述、图像名称等。

作为参考，以下是前五个结果的路径`horses`：

*   [http://upload.wikimedia.org/wikipedia/commons/thumb/8/85/Points_of_a_horse.jpg/330px-Points_of_a_horse.jpg](http://upload.wikimedia.org/wikipedia/commons/thumb/8/85/Points_of_a_horse.jpg/330px-Points_of_a_horse.jpg)
*   [http://upload.wikimedia.org/wikipedia/commons/thumb/9/98/Horse-and-pony.jpg/310px-Horse-and-pony.jpg](http://upload.wikimedia.org/wikipedia/commons/thumb/9/98/Horse-and-pony.jpg/310px-Horse-and-pony.jpg)
*   [http://images4.fanpop.com/image/photos/23500000/horse-horses-23582505-1024-768.jpg](http://images4.fanpop.com/image/photos/23500000/horse-horses-23582505-1024-768.jpg)
*   [http://www.hedweb.com/animimag/horses-gallop.jpg](http://www.hedweb.com/animimag/horses-gallop.jpg)
*   [http://www.horsesmaine.com/images/2%20%20horses.jpg](http://www.horsesmaine.com/images/2%20%20horses.jpg)

从科学上讲，这是一个很小的样本，不值得一提。但是让我们假设它是：大多数结果在目录路径中没有相关的关键字。相反，一个排名非常高的网站会获得前几个位置。

如果你想更进一步，你可以编写一个脚本来获得更大的样本，但在这一点上，我希望你已经得出结论，不，它没有任何区别。

# php - Codeigniter 数据库选择

> ID：12410322
> 
> 赞同：0
> 
> 时间：2012-09-13T15:58:36.467
> 
> 标签：php, sql, codeigniter, activerecord

我想从我的表中选择产品，其中 Akcie 1 和 Stav 也是 1。但它是搜索查询，所以我有更多类似的东西。它不工作，为什么？这是查询

```
$q = $this->db->where('Akcia', 1)
          ->like('Titul', $vyraz)
      ->or_like('PodTitul', $vyraz)
      ->or_like('Autor1', $vyraz)
      ->or_like('Autor2', $vyraz)
      ->or_like('Autor3', $vyraz)
      ->or_like('Autor4', $vyraz)
      ->or_like('Prekladatel', $vyraz)
      ->or_like('Rozmer', $vyraz)
      ->or_like('Vydavatelstvo', $vyraz)
      ->or_like('ISBN', $vyraz)
      ->or_like('EAN', $vyraz)
      ->or_like('Popis', $vyraz)
      ->or_like('KratkyPopis', $vyraz)
      ->or_like('RokVydania', $vyraz)
      ->where('stav', 1)
      ->order_by('id', 'desc')
      ->limit($limit)
      ->offset($offset)
     ->get('knihy');

         return $q->result(); 
```

这个查询也在选择 Akcia 为 0 的 pruduts 为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:25:28.557

好吧，如果我是正确的，代码将在 SQL 上产生这种情况：

```
WHERE Akcia = 1 AND Titul LIKE 'param' OR PodTitul LIKE 'param' etc. 
```

因此，如果“or_like”参数中的任何一个被命中，您的 Akcia 条件将自动被忽略，系统仍将显示所有记录，无论它们具有 1 还是 0 值

您需要的是包含这样的括号：

```
WHERE Akcia = 1 AND (Titul LIKE 'param' OR PodTitul LIKE 'param' etc.) 
```

我认为这是您需要的，请参阅此链接：

[http://codeigniter.com/forums/viewthread/105664/#548079](http://codeigniter.com/forums/viewthread/105664/#548079)

# date - 不能从日期行按年份分组

> ID：12410327
> 
> 赞同：0
> 
> 时间：2012-09-13T15:58:51.103
> 
> 标签：date, drupal, aggregation, drupal-views

我有一个日期时间类型的字段。我将此字段添加到视图中，并将日期时间字段格式化为仅显示年份。当我在视图中打开“聚合”并尝试对该字段进行分组时，它没有按我的预期工作并再次显示所有日期。我看到了 Vies 查询并且没有任何预格式化。它仅按 dis 字段分组。我希望修改查询以根据需要格式化此字段（仅限年份）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:14:29.650

是的，聚合设置似乎适用于查询，而不是您格式不同的输出结果。

不过，这是您如何进行聚合的方法：

1.  选择“表格”格式旁边的“设置”
2.  在“分组字段编号”下选择您的日期字段（仅显示年份）。1' ![在此处输入图像描述](../Images/33b50adf9a6eedce639c205150ba9a24.png)
3.  然后从显示中排除该字段，因为它将在组的顶部输出 ![在此处输入图像描述](../Images/08219fc6b95dd919ceee72c282144205.png)
4.  这就是大致的结果（对于表格视图......你可以尝试各种不同的，如列表等，以及你喜欢的 CSS 样式）。我只输出我的标题字段 ![在此处输入图像描述](../Images/eae8029635cd6ed9c7792af47c47cf00.png)

无论如何，希望这会有所帮助！

# jquery - 将 @Ajax.ActionLink 转换为 jQuery

> ID：12410329
> 
> 赞同：0
> 
> 时间：2012-09-13T15:58:54.650
> 
> 标签：jquery, ajax, asp.net-mvc-3

我正在学习 MVC3 并且我`@Ajax.Actionlink`在部分视图中有以下内容，我想将其转换为使用 ajax 调用的 jQuery 方法，但是我有两个主要问题我不太清楚：

*   如何将参数输入到ajax调用中。（userID 很好，因为它在部分视图的 ViewModel 中，但我看不到如何从子集合的实例中获取 customerID。）
*   如何将部分视图返回到指定的 div。（当我尝试这个时，它只是重定向到部分视图，而当前`@Ajax.ActionLink`确实正确更新了 div。）

以下是所有（我认为）相关代码：

**局部视图**

```
@model ..snip../CustomerViewModel

<div id="updatedablediv">
<table class="customers" style="width: 50%">
    <thead>
        <tr>
            <th>
                Name
            </th> 
            <th>
                Actions
            </th>
        </tr>
    </thead>      
    <tbody>
    @if (Model != null)
    {
        foreach (Customer item in Model.Customers)
        { 
            <tr id="customer-id-@item.CustomerID">
                @Html.HiddenFor(i => item.CustomerID)
                <td>
                    @Html.DisplayTextFor(i => item.Name)
                </td>  
                <td>
                    @Ajax.ActionLink("Delete", "DeleteCustomer", "MyController", new { userID = Model.UserID, customerID = item.CustomerID },
                        new AjaxOptions() { UpdateTargetId = "updatedablediv", HttpMethod = "Get" }, new { @class = "standardbutton" })
                </td>       
            </tr>
            }
        }       
        </tbody>     
    </table>
</div> 
```

**控制器动作**

```
[HttpGet]
public PartialViewResult DeleteCustomer(int userID, int customerID)
{
    try
    {
        //Delete code
    }
    catch (DataException)
    {
        ModelState.AddModelError("", "Unable to save changes.");
    }

    CustomerViewModel returnViewModel = new CustomerViewModel()
    {
        UserID = userID,
        Customers = repository.Customers
    };

    return PartialView("CustomerPartial", returnViewModel);
} 
```

我已经尝试过这样做，但我一直遇到上述问题。我的尝试之一是使用以下 jQuery：

```
$("#buttonid").click(function(){  
    var loadUrl = $('#buttonid').attr('href');
    $("#updatedablediv")  
        .html(DeleteCustomer)  
        .load(loadUrl, {userID: @model.UserID);  
}); 
```

任何帮助我将其转换`@Ajax.ActionLink`为 jQuery 的指针将不胜感激。

非常感谢，

**更新 HTML**

`<tr>`这是我部分视图中 a 实例的 html 。

```
<tr id="customer-id-1003">
    <input id="item_CustomerID" name="item.CustomerID" type="hidden" value="1003" />
    <td>
        James
    </td>  
    <td>
        <a class="standardbutton" data-ajax="true" data-ajax-method="Get" data-ajax-mode="replace" data-ajax-update="#updatedablediv" href="/MyController/DeleteCustomer?userID=12&amp;customerID=1003">Delete</a>
    </td>       
</tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:02:05.997

生成的链接的属性为您提供正确执行 AJAX 请求所需的一切：

```
<a class="standardbutton"
   data-ajax="true"
   data-ajax-method="Get"
   data-ajax-mode="replace"
   data-ajax-update="#updatedablediv"
   href="/MyController/DeleteCustomer?userID=12&amp;customerID=1003"
> 
```

所以让我们这样做：

```
$('.standardbutton[data-ajax="true"]').click(function(e) {
    e.preventDefault();
    var $this = $(this);
    $.ajax({
        method: $this.data('ajaxMethod').toUpperCase(),
        cache: false,
        url: $this.attr('href'),
        dataType: 'html',
        success: function(resp) {
            // this assumes that the data-ajax-mode is always "replace":
            $($this.data('ajaxUpdate')).html(resp);
        }
    });
}); 
```

# javascript - 当用户滚动页面或点击文本框外时，输入失去焦点，但不会模糊

> ID：12410332
> 
> 赞同：5
> 
> 时间：2012-09-13T15:59:13.653
> 
> 标签：javascript, ios, cordova

所以我在 phonegap/cordova (2.0) 应用程序中有一个表格。它位于 iframe 内的页面上，并且在大多数情况下表现出应有的行为。当您单击输入字段然后意外触摸输入之外或根本滚动页面时，就会出现问题。输入仍然有蓝色胡萝卜，表明它具有焦点，并且在 javascript 中没有触发模糊事件，但您无法编辑输入。重新调整文本框的焦点不会触发焦点事件，也不允许您进入测试。您必须聚焦另一个元素（这会模糊输入），然后重新聚焦它。

有没有办法防止输入假失去焦点？我不想在用户滚动时模糊输入，这将导致键盘关闭并导致其他问题（在单击输入外部会关闭键盘并在 mouseup 时执行第二次单击之前，我们遇到了一个问题）页面正在移动......我们最终设法摆脱了它）。

# java - 最适合边界检查的地方 - 构造函数或设置器？

> ID：12410338
> 
> 赞同：3
> 
> 时间：2012-09-13T15:59:50.043
> 
> 标签：java, coding-style, constructor, getter-setter

对 Java 来说还是比较新的，我想知道哪种方法更好。我有一个带有一些参数的类构造函数，并且在这个类中还有公共 getter 和 setter：

```
private String name;
private Float value;

public MySampleClass(String theName, Float theValue) {
    setName(theName);
    setValue(theValue);
}

public void setName(String n) {
    this.name = n;
}

public value setValue(Float v) {
    this.value = v;
} 
```

我想对这个 Float 做一些边界检查。似乎最好的放置位置是在 setter 中：

```
public value setValue(Float v) {
    if (v < 0.0f) {
        this.value = 0.0f;
    } else if (v > 1.0f) {
        this.value = 1.0f;
    }
} 
```

这段代码最初在构造函数和 setter 中进行了边界检查，这似乎是多余的。我更改了构造函数以调用 setter 并将检查放在那里。这更有意义吗？还是我违反了一些我完全不知道的约定？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T16:04:46.620

从您的构造函数调用可覆盖的方法是一个坏主意。做更多这样的事情：

```
private String name;
private Float value;

public MySampleClass(String theName, Float theValue) {
    this.name = theName;
    setValueImpl(theValue);
}

public void setName(String n) {
    this.name = n;
}

public void setValue(Float v) {
    setValueImpl(v);
}

private void setValueImpl(Float v) {
    if (v < 0.0f) {
        this.value = 0.0f;
    } else if (v > 1.0f) {
        this.value = 1.0f;
    }
} 
```

这为您提供了两个地方的验证，并消除了对可覆盖方法的调用。有关[此问题](https://stackoverflow.com/questions/3404301/whats-wrong-with-overridable-method-calls-in-constructors)的更多信息，请参阅此问题。

**编辑：**如果您计划子类`MySampleClass`化并希望验证设置器可用，请声明它`protected final`而不是`private`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:02:40.110

对于相当简单的数据检查，例如您的示例，那么是的，在 setter 中进行验证是最有意义的。但是，如果验证`theValue`也取决于`theName`（或其他事物），那么在构造函数（或构造函数调用的私有方法）中执行验证可能是值得的。

# facebook - 访问自己的应用程序的“关于应用程序”页面

> ID：12410339
> 
> 赞同：1
> 
> 时间：2012-09-13T15:59:53.120
> 
> 标签：facebook, tabs

我最近创建了一个小应用程序以嵌入 Facebook 上的页面选项卡。

我以前做过，但从那以后似乎程序发生了变化。

我找到了这个页面：[https](https://www.facebook.com/help/?faq=172925542764476) ://www.facebook.com/help/?faq=172925542764476 ，上面说，为了将页面嵌入为页面选项卡，我需要转到“App About”页面并单击那里有一个链接。

我的问题是 - 我找不到我的应用程序的“关于应用程序”页面！我最终能够确定直接访问我的应用程序的页面（https://apps.facebook.com/[appID]/），但我认为这不是他们所指的页面。常见问题解答建议在 Facebook 上搜索应用程序名称，但这样做不会拉出我的应用程序。

谁能带领我朝着正确的方向前进？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:04:49.033

您可能没有，您需要通过应用设置的“应用详细信息”部分中的“创建页面”选项来创建它。

您不需要此页面即可将应用程序添加到页面，您也可以使用“[添加页面选项卡”对话框](https://developers.facebook.com/docs/reference/dialogs/add_to_page/)或[Pages API](https://developers.facebook.com/docs/reference/api/page/#tabs)将您的应用程序添加到页面。

# php - Zend 框架 2：“连接错误：SQLSTATE [28000] [1045] 访问被拒绝”

> ID：12410343
> 
> 赞同：1
> 
> 时间：2012-09-13T15:59:59.547
> 
> 标签：php, zend-framework2

我一直在研究[ZF2 的官方教程](http://zf2.readthedocs.org/en/latest/user-guide/database-and-models.html)。
在页面的末尾，要查看结果是什么，我收到了这个长错误：

```
An error occurred
An error occurred during execution; please try again later.
Additional information:
Zend\Db\Adapter\Exception\RuntimeException
File:
D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\Adapter\Driver\Pdo\Connection.php:243
Message:
Connect Error: SQLSTATE[28000] [1045] Access denied for user ''@'localhost' (using password: NO)
Stack trace:
#0 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\Adapter\Driver\Pdo\Pdo.php(211): Zend\Db\Adapter\Driver\Pdo\Connection->connect()
#1 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\Adapter\Adapter.php(175): Zend\Db\Adapter\Driver\Pdo\Pdo->createStatement(NULL)
#2 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\Sql\Sql.php(103): Zend\Db\Adapter\Adapter->createStatement()
#3 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\TableGateway\AbstractTableGateway.php(234): Zend\Db\Sql\Sql->prepareStatementForSqlObject(Object(Zend\Db\Sql\Select))
#4 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\TableGateway\AbstractTableGateway.php(210): Zend\Db\TableGateway\AbstractTableGateway->executeSelect(Object(Zend\Db\Sql\Select))
#5 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\TableGateway\AbstractTableGateway.php(197): Zend\Db\TableGateway\AbstractTableGateway->selectWith(Object(Zend\Db\Sql\Select))
#6 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\module\Album\src\Album\Model\AlbumTable.php(24): Zend\Db\TableGateway\AbstractTableGateway->select()
#7 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\module\Album\src\Album\Controller\AlbumController.php(18): Album\Model\AlbumTable->fetchAll()
#8 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Mvc\Controller\AbstractActionController.php(87): Album\Controller\AlbumController->indexAction()
#9 [internal function]: Zend\Mvc\Controller\AbstractActionController->onDispatch(Object(Zend\Mvc\MvcEvent))
#10 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php(469): call_user_func(Array, Object(Zend\Mvc\MvcEvent))
#11 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php(209): Zend\EventManager\EventManager->triggerListeners('dispatch', Object(Zend\Mvc\MvcEvent), Object(Closure))
#12 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Mvc\Controller\AbstractController.php(108): Zend\EventManager\EventManager->trigger('dispatch', Object(Zend\Mvc\MvcEvent), Object(Closure))
#13 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Mvc\DispatchListener.php(114): Zend\Mvc\Controller\AbstractController->dispatch(Object(Zend\Http\PhpEnvironment\Request), Object(Zend\Http\PhpEnvironment\Response))
#14 [internal function]: Zend\Mvc\DispatchListener->onDispatch(Object(Zend\Mvc\MvcEvent))
#15 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php(469): call_user_func(Array, Object(Zend\Mvc\MvcEvent))
#16 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php(209): Zend\EventManager\EventManager->triggerListeners('dispatch', Object(Zend\Mvc\MvcEvent), Object(Closure))
#17 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Mvc\Application.php(298): Zend\EventManager\EventManager->trigger('dispatch', Object(Zend\Mvc\MvcEvent), Object(Closure))
#18 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\public\index.php(12): Zend\Mvc\Application->run()
#19 {main}
Previous exceptions:
PDOException
File:
D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\Adapter\Driver\Pdo\Connection.php:239
Message:
SQLSTATE[28000] [1045] Access denied for user ''@'localhost' (using password: NO)
Stack trace:
#0 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\Adapter\Driver\Pdo\Connection.php(239): PDO->__construct('mysql:dbname=zf...', NULL, NULL, Array)
#1 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\Adapter\Driver\Pdo\Pdo.php(211): Zend\Db\Adapter\Driver\Pdo\Connection->connect()
#2 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\Adapter\Adapter.php(175): Zend\Db\Adapter\Driver\Pdo\Pdo->createStatement(NULL)
#3 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\Sql\Sql.php(103): Zend\Db\Adapter\Adapter->createStatement()
#4 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\TableGateway\AbstractTableGateway.php(234): Zend\Db\Sql\Sql->prepareStatementForSqlObject(Object(Zend\Db\Sql\Select))
#5 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\TableGateway\AbstractTableGateway.php(210): Zend\Db\TableGateway\AbstractTableGateway->executeSelect(Object(Zend\Db\Sql\Select))
#6 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Db\TableGateway\AbstractTableGateway.php(197): Zend\Db\TableGateway\AbstractTableGateway->selectWith(Object(Zend\Db\Sql\Select))
#7 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\module\Album\src\Album\Model\AlbumTable.php(24): Zend\Db\TableGateway\AbstractTableGateway->select()
#8 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\module\Album\src\Album\Controller\AlbumController.php(18): Album\Model\AlbumTable->fetchAll()
#9 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Mvc\Controller\AbstractActionController.php(87): Album\Controller\AlbumController->indexAction()
#10 [internal function]: Zend\Mvc\Controller\AbstractActionController->onDispatch(Object(Zend\Mvc\MvcEvent))
#11 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php(469): call_user_func(Array, Object(Zend\Mvc\MvcEvent))
#12 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php(209): Zend\EventManager\EventManager->triggerListeners('dispatch', Object(Zend\Mvc\MvcEvent), Object(Closure))
#13 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Mvc\Controller\AbstractController.php(108): Zend\EventManager\EventManager->trigger('dispatch', Object(Zend\Mvc\MvcEvent), Object(Closure))
#14 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Mvc\DispatchListener.php(114): Zend\Mvc\Controller\AbstractController->dispatch(Object(Zend\Http\PhpEnvironment\Request), Object(Zend\Http\PhpEnvironment\Response))
#15 [internal function]: Zend\Mvc\DispatchListener->onDispatch(Object(Zend\Mvc\MvcEvent))
#16 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php(469): call_user_func(Array, Object(Zend\Mvc\MvcEvent))
#17 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php(209): Zend\EventManager\EventManager->triggerListeners('dispatch', Object(Zend\Mvc\MvcEvent), Object(Closure))
#18 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\vendor\zendframework\zendframework\library\Zend\Mvc\Application.php(298): Zend\EventManager\EventManager->trigger('dispatch', Object(Zend\Mvc\MvcEvent), Object(Closure))
#19 D:\softs\UwAmp\www\zf2-tutorial\ZendSkeletonApplication\public\index.php(12): Zend\Mvc\Application->run()
#20 {main} 
```

谁可以帮我这个事？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T16:02:02.030

您需要将凭据放在本地配置文件中

```
// config/autoload/local.php:
return array(
    'db' => array(
        'username' => 'YOUR USERNAME HERE',
        'password' => 'YOUR PASSWORD HERE',
    ),
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-11T07:57:20.973

感谢 Maks3w，我得到了同样的错误，因为我没有创建`local.php`文件来添加代码。我认为这`local.php.dist`很好用。`local.php`有了代码后一切都很好

// 配置/自动加载/local.php:

```
return array(
    'db' => array(
        'username' => 'YOUR USERNAME HERE',
        'password' => 'YOUR PASSWORD HERE',
    ),
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-04T12:52:17.447

有一条评论**`local.php.dist`**帮助我修复它：

```
// Copy this file without the .dist extension at the end and populate values as needed. 
```

# php - PHP Simple HTML DOM - 访问没有标识符的值

> ID：12410347
> 
> 赞同：1
> 
> 时间：2012-09-13T16:00:12.433
> 
> 标签：php

说我在 html 中有这个

```
<strong class="top">Contact Person: </strong>
<br>
Shan
<strong class="top">Email-id: </strong>
<br>
<span>abshanai@gmail.com</span>
<br>
<strong class="top">Website:</strong>
www.absgym.co.in 
```

是否可以使用简单的 html DOM 获取值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-11T10:44:54.483

```
<?php

$sourcelink = 'http://en.wikipedia.org/wiki/Document_Object_Model';
$retriever = curl_init(); curl_setopt($retriever, CURLOPT_URL, $sourcelink);
curl_setopt($retriever, CURLOPT_REFERER, "http://www.google.com");
curl_setopt($retriever, CURLOPT_USERAGENT, "MozillaXYZ/1.0");
curl_setopt($retriever, CURLOPT_HEADER, 0); curl_setopt($retriever,
CURLOPT_RETURNTRANSFER, true); curl_setopt($retriever, CURLOPT_TIMEOUT, 10);
$source_content =curl_exec ($retriever); curl_close ($retriever);

/*
 *preg_match('/The starting of content's html tag(.*?)ending of content's html tag, source, variable with results)
 */

preg_match('/<h1 id="firstHeading" class="firstHeading" lang="en">(.*?)<div id="bodyContent" class="mw-body-content">/s',$source_content,$selected_area);

$needed_content=$selected_area[0];

$dom_class = new DOMDocument();

@$dom_class->loadHTML($needed_content);

$processor = new DOMXPath($dom_class);

/*
 * This must be the html tag which is enclosing the targetted content to extract, syntax as below,
 * $processor->query('//html tag[@html_attribute="value"]');
 */
$process_selector = $processor->query('//span[@dir="auto"]');

foreach( $process_selector as $valuesalue ) {
    echo $values=trim($valuesalue->nodeValue); echo '<br>';
    $accumaltor[]=$values;
} 
```

?>

**跟随：**

1.  要更改的强制行是上述代码中的第 3、15 和 16 行，对应于您确定的 DOM 文档。

2.  第 3 行：使用您的网址

3.  第 15 行：HTML 父标记包含您确定的 HTML DOM 部分。

4.  第 16 行：这必须是包含要提取的目标内容的 html 标记。在你的情况下`<strong class="top>Targeted content to extract</strong>`，所以

`$process_selector = $processor->query('//strong[@class="top"]');`

# twitter-bootstrap - Twitter Bootstrap 和 Plusstrap 有什么区别

> ID：12410350
> 
> 赞同：2
> 
> 时间：2012-09-13T16:00:20.607
> 
> 标签：twitter-bootstrap

我使用[Twitter Bootstrap](http://twitter.github.com/bootstrap/ "推特引导")已经有一段时间了。我听到一个会议提到[Plusstrap](http://xbreaker.github.com/plusstrap/index.html)更可取。在查看 Plusstrap 时，它看起来像一个相同的克隆。此外，我找不到任何线索来说明为什么它首先被分叉。我想听听是否有人可以对这个项目有所了解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:16:54.597

在这个阶段只不过是 twitter bootstrap 的一个克隆（v 0.1.0）

[https://github.com/xbreaker/plusstrap/commits/master](https://github.com/xbreaker/plusstrap/commits/master)

只有外观变化和 bootstrap 被 plustrap 取代。

# javascript - 在道场网格中显示数据

> ID：12410353
> 
> 赞同：0
> 
> 时间：2012-09-13T16:00:39.610
> 
> 标签：javascript, json, dojox.grid.datagrid, dojo

我有一个哈希图`dataFields = {"element1":1,"element2":2,"element3":3}`，我正在尝试在 dojo 网格中显示数据。但是，当我设置我的数据存储时：

```
 var data = {  identifier: "element1",
                  items: []
                };
   payload = JSON.stringify(dataFields);
   data.items.push(payload);  
   var store = new dojo.data.ItemFileWriteStore({data: data}); 
```

网格不显示任何内容。现在我知道网格设置正确，因为当我传入一个 JSON 文件来测试我的网格时，它会显示文件的内容而没有任何错误。我应该提到这`dataFields`是 a 的响应，`GET`整个响应对我没有用，这就是为什么我提取有用的字段并将它们放入哈希映射并尝试显示它们的原因。我觉得我在这里遗漏了一些关于数据存储如何工作的重要内容。所以我想，要问的正确问题是，我将如何设置我的数据存储，以便网格显示我的哈希图？或者有比使用哈希映射更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:06:55.633

所以事实证明我不需要“字符串化”哈希映射。我刚放进去`data.items.push(datafields)`，它奏效了。我这样做的唯一原因是我想如果我把它变成一个字符串，那么它会模仿一个 JSON 对象。原来我错了，因为 JSON 文本是一种哈希映射。

# php - jQuery File Upload plugin - 空文件上传结果

> ID：12410358
> 
> 赞同：2
> 
> 时间：2012-09-13T16:00:53.807
> 
> 标签：php, jquery, file, plugins, upload

在过去的几天里，我一直在玩[这个插件，对其进行自定义并设置它以完全按照我的网站需要工作。](http://blueimp.github.com/jQuery-File-Upload/)我在我的本地主机服务器上一切正常，没有错误/错误。但是，当我尝试将其上传到我的 Plesk 服务器时，加载时没有显示任何文件（即使目标文件夹中有图像），并且当我尝试上传时出现“空文件上传结果”错误。奇怪的是..即使显示错误，文件上传似乎也能正常工作，并且相关图像出现在文件夹中。所以似乎只有他有阅读问题，但没有写作问题？

我检查了文件和缩略图文件夹的权限，并将它们都设置为 777，所以这不是问题。

我真的不明白为什么这可以在我的本地主机服务器上运行，而不是在我的 Plesk 服务器上运行。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T11:54:30.550

终于解决了这个问题。问题是我的 Plesk 服务器运行的是非常旧的 PHP 版本。将其更新到 5.3 似乎已经解决了我的问题。

# asp.net - 当我创建一个新的 ASP.NET 4 Web 应用程序时，web.config 文件几乎是空的

> ID：12410361
> 
> 赞同：1
> 
> 时间：2012-09-13T16:01:12.830
> 
> 标签：asp.net, .net-4.0

当我创建一个新的 ASP.NET 4 Web 应用程序时，web.config 文件几乎是空的。ASP.NET 4 之前的所有配置元素发生了什么变化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:07:31.547

这是一个很好的帖子来解释它。

[http://weblogs.asp.net/scottgu/archive/2009/08/25/clean-web-config-files-vs-2010-and-net-4-0-series.aspx](http://weblogs.asp.net/scottgu/archive/2009/08/25/clean-web-config-files-vs-2010-and-net-4-0-series.aspx)

“**新的 .NET 4 machine.config 文件现在**自动注册我们多年来添加的所有 ASP.NET 标记部分、处理程序和模块，包括以下功能：

ASP.NET AJAX ASP.NET 动态数据 ASP.NET 路由（现在可用于 ASP.NET WebForms 和 ASP.NET MVC） ASP.NET 图表控件（现在内置于 ASP.NET V4） 这是什么意思是当你在 VS 2010 中创建一个新的“空 ASP.NET 应用程序”项目时，你会发现新的默认应用程序级 web.config 文件现在干净简单：”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:09:30.360

大多数配置设置现在都使用 machine.config 而不是 web.config。我认为您在创建应用程序时必须从菜单中选择了“空 Web 应用程序”。

# mysql - 无法在 MySQL 中存储 unicode 字符串

> ID：12410364
> 
> 赞同：1
> 
> 时间：2012-09-13T16:01:23.113
> 
> 标签：mysql, unicode, utf-8, character-encoding

我需要将此 unicode 字符串存储在 MySQL 中

```
Příliš žluťoučký kůň úpěl ďábelské ódy.On sangen hauskaa, että polkupyörä on maanteiden jokapäiväinen ilmiö. 
```

但是每当我存储这个字符串并从 phpMyAdmin 执行查询时，字符串就会存储为

```
P?íliš žlu?ou?ký k?? úp?l ?ábelské ódy.On sangen hauskaa, että polkupyörä on maanteiden jokapäiväinen ilmiö. 
```

谁能告诉我为什么会这样？我正在使用 MySQL 5.5.20，表和数据库的字符集都是 utf8 - UTF-8 Unicode 和排序规则是 utf_unicode_ci

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:05:51.547

检查您的 phpmyadmin 安装使用的字符集。

# javascript - 主干.js，车把错误：this._input.match 不是函数

> ID：12410366
> 
> 赞同：0
> 
> 时间：2012-09-13T16:01:28.593
> 
> 标签：javascript, backbone.js, handlebars.js

我是backbone.js 和handlebars 的新手，我在让我的模板渲染数据时遇到问题。

这是我来自 tagfeed.js 模块的集合和模型数据：

```
// Create a new module.
  var Tagfeed = app.module();

  // Default model.
  Tagfeed.Model = Backbone.Model.extend({
    defaults : {
        name : '',
        image : ''
    }
  });

  // Default collection.
  Tagfeed.Collection = Backbone.Collection.extend({
    model : Tagfeed.Model,
    url : Api_get('api/call')
  });

  Tagfeed.TagView = Backbone.LayoutView.extend({
    template: "tagfeed/feed",
    initialize: function() {
        this.model.bind("change", this.render, this);
    },
    render: function(template, context) {
                return Handlebars.compile(template)(context);
    }
  }); 
```

然后在我的路由器中，我有：

```
define([
  // Application.
  "app",

  // Attach some modules
  "modules/tagfeed"
],

function(app, Tagfeed) {

  // Defining the application router, you can attach sub routers here.
  var Router = Backbone.Router.extend({

    routes: {
      "index.html": "index"
    },

    index: function() {
        var collection = new Tagfeed.Collection();

        app.useLayout('main', {
            views: {
                ".feed": new Tagfeed.TagView({
                    collection: collection,
                    model: Tagfeed.Model,
                    render: function(template, context) {
                        return Handlebars.compile(template)(context);
                    }
                })
        }
  });
    }
  });

  return Router;

}); 
```

这成功地调用了 api，调用了我的主模板，并调用了获取提要模板 HTML。如果我不包含该 render(template, context) 函数，那么它将在页面上呈现为我在提要模板中的直接 HTML，其中仍然包含 {{ name }}。但是，当它包含在内时，我得到了错误

```
TypeError: this._input.match is not a function
[Break On This Error]   

match = this._input.match(this.rules[rules[i]]); 
```

如果我检查传递给 appLayout 视图渲染函数的变量`feed`，我会看到`template`var 是一个函数，并且`context`var 未定义，然后它会引发该错误。

任何想法我做错了什么？我知道我在这里至少有一个问题，可能更多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:21:28.407

由于您使用的是 requirejs，因此您可以使用文本模块来外部化您的模板，或者更好地预编译它们并将它们包含在您的视图中。查看[http://berzniz.com/post/24743062344/handling-handlebars-js-like-a-pro](http://berzniz.com/post/24743062344/handling-handlebars-js-like-a-pro)

例如使用预编译的模板

```
// router.js
define(['views/tag_feed', 'templates/feed'], function(TagFeedView) {

    var AppRouter = Backbone.Router.extend({

        // ...

    });

})

// tag_feed.js
define(['collections/tag_feed'], function() {

    return Backbone.View.extend({

        // ...

        render: function() {
            this.$el.html(
                Handlebars.templates.feed({
                    name: '...'
                })
            );
        }   

     });

}) 
```

作为参考，我为骨干网/require/handlebars 设置创建了简单的样板文件[https://github.com/nec286/backbone-requirejs-handlebars](https://github.com/nec286/backbone-requirejs-handlebars)

# android - Android 模拟器：更改网吧

> ID：12410370
> 
> 赞同：2
> 
> 时间：2012-09-13T16:01:50.150
> 
> 标签：android, emulation, adt, telnet, ddms

有谁知道是否可以更改 android 模拟器中的可见网络栏？我搜索了谷歌，尝试使用 telnet 和 DDMS，但没有运气。

或者，有谁知道我在哪里可以获得条形图像的 png 文件（在 2.3 中）？我最终想要做的是获取不同级别的一些屏幕截图（1 条，2 条等）。我沿着尝试获取android源代码的路线走下去，但进展并不顺利。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T18:58:24.173

很抱歉发布了 necroposting，但我正在寻找同样的东西，虽然我没有得到即时的答案，但我应该在这里发布我的发现，因为它回答了最初的问题。要在模拟器中设置网络接收级别，您需要使用 telnet 连接到它

```
telnet localhost 5554 
```

通常您的模拟器将在端口 5554 上运行，但您可以随时在模拟器窗口的标题栏中检查它。之后你可以运行命令

```
gsm signal NN 
```

其中 NN 是一个 int 0..31，表示信号电平。因此命令

```
gsm signal 0 
```

不会给你任何酒吧。希望有一天有人会发现这很有用。快乐编码！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:10:58.263

您可以从[此处获取状态栏可绘制对象](http://androiddrawables.com/status.html)

搜索`stat_sys_signal_`。我没有检查这些的分辨率。但如果这些是低分辨率的，您可能必须下载 Android 开源代码。可绘制对象将出现在`frameworks\base\core\res\res\drawable-hdpi`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:09:57.237

在 Eclipse 的 ddms 视图模拟器选项卡中，您可以更改网络、电池的状态和电源...否则，您必须远程登录您的模拟器并发送命令

# php - symfony 2中的foreach

> ID：12410379
> 
> 赞同：-2
> 
> 时间：2012-09-13T16:02:10.530
> 
> 标签：php, foreach

无法解决如何每 4 次获得最后一个迭代行，但我需要找到最后一个，这样我才能让它做一些事情

```
foreach( $gallery->getMedia() as $key => $media )
{
        if( ($key % 4 ) == 0 ) $html .= '<div class="clear"></div>';
        $url = $media->dir . '/' . $media->filename;

        $html .= sprintf( '<li><a href="#photo-%s" class="album_image_wrapper" id="photo_%s" title="%s" alt="%s" target="_blank" class="image-link" rel="slideshow"><div style="background-image: url(\'',
                $media->id ,
                $media->id ,
                $url,
                $gallery->name ,
                $media->id ,
                $this->generateThumbUrl( $url, array( 'width' => 100, 'height'=> 120, 'zoom' => true) ),
                $media->title,
                $galleryID  ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:15:46.040

If you're using Symfony2 then you definitely shouldn't be rendering HTML content like this, you should be using the templating engine, [Twig](http://twig.sensiolabs.org/).

e.g. From a controller (I assume this is in a controller):

```
return $this->render('BundleName:ControllerName:view.html.twig', array(
    'gallery' => $gallery
); 
```

Then in your `/path/to/BundleName/Resources/views/ControllerName/view.html.twig` template:

```
{% for key, media in gallery.media %}
    {% if loop.last %}
        {# Logic for the last iteration of the loop #}
    {% endif %}

    {% if loop.index % 4 == 0 %}
        {# Logic for every 4th iteration #}
    {% endif %}

    {# other code... #}

{% endfor %} 
```

# c# - C# Outlook get CompanyName property from Recipient

> ID：12410380
> 
> 赞同：6
> 
> 时间：2012-09-13T16:02:15.670
> 
> 标签：c#, outlook, add-in

I am currently writing an Outlook 2010 AddIn using C#. What I want is to get the CompanyName property from a Recipient object that I pull from an AppointmentItem. So, having the Recipients of an AppointmentItem I want to find out the CompanyName of each Recipient, which might be an ExchangeUser.

My code is this:

```
Recipients recipients = appointmentItem.Recipients;
foreach (Recipient rec in recipients)
{
    resolved = rec.Resolve();
    if (resolved)
    {
       ContactItem contactItem = rec.AddressEntry.GetContact();
       String companyName = contactItem.CompanyName;       
       // ...
    } 
```

Where contactItem is always null.

Doing something like this also results in a null pointer.

```
ExchangeUser u = rec.AddressEntry.GetExchangeUser();
companyName = u.CompanyName; 
```

I simply cannot get to the CompanyName information. I know the information does exist. However, also a lot of other attributes, besides CompanyName, seem to result in NULL pointers as well.

Can someone give me a hint on that?

Thanks in advance.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-22T10:47:31.973

Try with below code. Working for me.

**CODE:**

```
 bool resolved;
        Microsoft.Office.Interop.Outlook.Application olApplication = new Microsoft.Office.Interop.Outlook.Application();

        // get nameSpace and logon.
        Microsoft.Office.Interop.Outlook.NameSpace olNameSpace = olApplication.GetNamespace("mapi");
        olNameSpace.Logon("Outlook", "", false, true);

        // get the Calender items
        Microsoft.Office.Interop.Outlook.MAPIFolder _olCalender = olNameSpace.GetDefaultFolder(Microsoft.Office.Interop.Outlook.OlDefaultFolders.olFolderCalendar);

        // Get the Items (Appointments) collection from the Calendar folder.
        Microsoft.Office.Interop.Outlook.Items oItems = _olCalender.Items;

        foreach (object o in oItems)
        {

            if (o is Microsoft.Office.Interop.Outlook.AppointmentItem)
            {
                Microsoft.Office.Interop.Outlook.Recipients recipients = ((Microsoft.Office.Interop.Outlook.AppointmentItem)o).Recipients;
                foreach (Microsoft.Office.Interop.Outlook.Recipient rec in recipients)
                {
                    resolved = rec.Resolve();
                    if (resolved)
                    {
                        Microsoft.Office.Interop.Outlook.ContactItem contactItem = rec.AddressEntry.GetContact();
                        MessageBox.Show(contactItem.CompanyName);
                    }
                }

            }
        } 
```

Hope It should work.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T17:43:07.067

I haven't tried this but it may help. It looks like CompanyName is a property of a ContactItem, so you need to convert the recipient to a ContactItem. The below code looks for the contact in the address book using the recipient's email address. From here you may be able to find the CompanyName:

```
Outlook.MAPIFolder fldContacts = (Outlook.MAPIFolder)OutlookApp.Session.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderContacts); 
for (int i =1; i <aitem.Recipients.Count+1 ; i++) 
{ 
   Outlook.Recipient r = aitem.Recipients.Item(i); 
   if (!r.Resolved) r.Resolve(); 
   if (r.Resolved) 
   { 
     Outlook.ContactItem ci = (fldContacts.Items.Find("[Email1Address] = '" + r.Address + "'") as Outlook.ContactItem);
     if (ci != null) 
     { 
       //Now you got the contact deal with it here 
     } 
    }
} 
```

# c# - 使用 azure、ACS、Sharepoint 2010、MVC 站点和 WebService 的跨域单点登录

> ID：12410381
> 
> 赞同：0
> 
> 时间：2012-09-13T16:02:18.083
> 
> 标签：c#, web-services, sharepoint-2010, claims-based-identity, acs

我有一个配置为使用 ACS 登录的 SharePoint 2010 站点。并且 ACS 配置为使用我自己的身份提供程序。我还有一个 MVC Web 应用程序，它也支持声明，并使用 ACS 进行身份验证。想法是使用我构建的 web 服务将某些服务从 sharepoint 公开到 MVC 站点。

[这是一个想法图：](http://i.stack.imgur.com/B084s.jpg)

我的想法是，一旦您登录到 MVC 站点，您就可以使用该 SAML 令牌（身份）登录到 SharePoint（我只是将 SAML 令牌传递给 Web 服务，并且该服务尝试使用该令牌登录到 SharePoint ）。我希望，因为我在 ACS 中配置了依赖方（MVC 站点，SharePoint）以使用相同的证书进行签名，即使它来自不同的领域，它也会接受令牌。但事实并非如此。所以我想知道我的网络服务如何用我的声明来冒充用户。我一直在做无休止的研究，我非常相信这是不可能的。真正的问题是，SharePoint 是否有办法信任我在 MVC 网站上获得的令牌，而无需构建整个 STS 并让 SharePoint 与之建立信任关系。任何帮助和想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:02:11.013

如果您信任为 MVC 或 SharePoint 创建的令牌，那么您的 Web 服务是该“领域”的一部分，因此可以将该领域添加为有效领域。观众 uri 验证可以从配置或代码中更改。你在使用 WCF 吗？您是否将 WIF 与 WCF 一起使用？

```
<audienceUris>
   <add value="your:sharepoint-and-mvc:realm" />
   <add value="http://webservice" />
</audienceUris> 
```

**编辑**：再次阅读您的问题和您所做的说明，您将遇到 SharePoint 问题，因为他们有一个 STS，它将对原始 ACS 令牌进行一些转换并使用自己的密钥再次对其进行签名。这意味着您无权访问原始 ACS 令牌。我在这里看到两个选项：

*   在使用服务之前创建自己的令牌（您可以使用 SimpleWebTokens 或 JsonWebTokens，它们更易于实现和共享对称密钥）。
*   将您的服务配置为信任由 ACS 或 SharePoint 密钥以及受众 URI 签名的 SAML 令牌。

由于这是一个 REST 服务，我将使用选项 1，将原始令牌转换为 JSON Web 令牌，使用您自己的密钥退出并将令牌附加到授权标头。

在这里，您有一个 JsonWebTokens (JWT) [http://nuget.org/packages/JWT的实现](http://nuget.org/packages/JWT)

这是 SimpleWebTokens [http://nuget.org/packages/netfx-Microsoft.IdentityModel.Swt的实现](http://nuget.org/packages/netfx-Microsoft.IdentityModel.Swt)

您也可以将 JWT 与带有 x509 证书的非对称加密一起使用（虽然它没有在该包中实现）

# java - 从 void java 调用静态方法时出错

> ID：12410387
> 
> 赞同：-1
> 
> 时间：2012-09-13T16:02:39.330
> 
> 标签：java, oop

在从主类调用方法时需要帮助。

我需要调用一个方法，因此我创建了一个对象来处理它。
下面我引用我的主要方法

```
 public static void main(String[] args) {
        // TODO code application logic here
        SLRatio sl= new SLRatio();
        sl.clustering(apa);
} 
```

这是我需要调用的方法

```
public class SLRatio {

public static String [][]clustering(String[][]apa) {

   System.out.println("Cluster 1");

   int a = apa.length/3;
   String [][] cluster1=new String [a][apa[0].length];

   for (int i =0; i<a; i++) {
      for (int j=0;j<apa[0].length;j++) {
         cluster1 [i][j] = apa[i][j];
      }
   }

   for (int b = 0; b < cluster1.length; b++) {
      for (int c = 0; c < cluster1[0].length; c++) {
         System.out.print(cluster1[b][c] + "\t");
       }

       System.out.println("");        
   }

   System.out.println("\n");

   return cluster1;

}
} 
```

我收到错误消息：“找不到符号，访问静态方法集群”

我能做些什么来解决它？我试图改变语法，但没有奏效。
太感谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:04:26.357

你没有定义`Allocation()`方法`SLRatio`

注意：静态方法应该用类名调用（避免实例方法和静态之间的混淆）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:04:29.320

如果是静态方法，则不需要通过实例调用。

```
SLRatio .clustering(...); 
```

应该足够了。

而且您似乎忘记了实现`Allocation`方法。

另一个建议，java命名约定，方法名以小写字母开头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T06:41:48.613

`static`除非您确定合适，否则请勿使用。

这是一个流行的编程错误，部分原因是 eclipse 不断建议在变量和方法`static`无法访问时创建它们。但通常，这不是正确的解决方案。虽然它修复了编译问题，但它经常破坏应用程序逻辑。

现在，您的问题可能是它`apa`有 type `String[][]`，但您正在`String[]`向它传递一个参数。所以无法编译，因为**没有方法`clustering(String[] args)`**。

说真的，您需要学习更多 Java 基础知识。也许来自一**本书**。

# ios - 永远不知道要使用哪个配置文件组合签名

> ID：12410388
> 
> 赞同：2
> 
> 时间：2012-09-13T16:02:41.693
> 
> 标签：ios, xcode

我永远不知道我应该使用哪些配置文件来签署构建和签署临时分发的版本。

我已经尝试使用 ad-hoc 分发配置文件对构建进行签名，然后使用推送配置文件对包进行签名，但这没有用，所以只是尝试了很多组合，直到我找到了一个有效的组合。

昨天，经过几个月的无忧签名操作后，我不得不在 XCode 不断崩溃后重新安装它，然后我无法再在自己的手机上签名进行开发，也无法在其他手机上进行临时分发。

我尝试了几十种不同配置文件的组合，直到最终我得到了一个可以安装在其他人手机上的临时版本，但随后 XCode 再次崩溃，我失去了那个组合，让我想哭，但我没有不想再经历一次尝试所有可能组合的过程。

在代码签名身份部分的 XCode 中，我有以下选择：a) Apple Push Profile b) iOS Team Provisioning Profile c) NNN Development Profile，其中 NNN 是正在开发的项目/产品的名称 d) iPhone Distribution Company Name which被描述为没有配置文件的身份。e) 临时分发

我应该使用以上 5 个中的哪一个来签署构建以使用 XCode 在我自己的设备上运行？在构建以将包发送给其他人以通过 iTunes 安装时，我是否需要将其更改为临时分发？

其次，一旦我构建了一个存档并希望创建一个临时部署以将其发送给测试人员以便他们通过 iTunes 安装，还有一个额外的步骤是对构建的包进行签名，为此我提供了以下选择： 1) Apple Push Profile 2) NNN Development Profile 3) iOS Team Provisioning Profile

应该使用这 3 个中的哪一个来签署临时部署。

非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:31:53.167

我的应用程序有 4 个配置文件。

一种是 Xcode 提供的 iOS Team 配置文件

我通过 Apple iOS Provisioning Portal 生成的另外 3 个。

*   我公司的 1 个通用开发配置文件：BlahBlah.com.myCompany.*
*   1 个对我的公司也通用的临时分发配置文件：differentBlaBlah.com.myCompany.*
*   1 个特定于产品的分发配置文件：BlahBlah.com.myCompany.NNN

当我在我的机器上测试时，我使用的是 Xcode 生成的。当我在我的设备上运行它时，我使用的是 dev。轮廓。当我构建分发给测试人员时，我使用 adhoc。当我上传到 iTunes 时，第 3 个。

任何地方都没有权利。

！

珍妮

# c# - Expression Encoder SDK 源代码以编程方式编码在 Apple 设备上播放的视频

> ID：12410389
> 
> 赞同：0
> 
> 时间：2012-09-13T16:02:46.023
> 
> 标签：c#, expression-encoder, expression-encoder-sdk

我正在使用 VS 2010、C#，我发现以下链接包含 SDK 源代码，可以对视频进行编程编码以在安装了 MS Silverlight 的浏览器上播放：

[http://www.cognifide.com/blogs/marketing-technology/microsoft-smooth-streaming-part-3/](http://www.cognifide.com/blogs/marketing-technology/microsoft-smooth-streaming-part-3/)

但是，该链接中的源代码仅用于以编程方式对 Silverlight 输出中的视频进行编码。Silverlight 的输出文件带有 .ism、.ismc、.ismv 等扩展名

我正在寻找在 VS 2010 中使用相同的 Expression Encoder SDK 的 C# 源代码，以执行相同的功能来以编程方式对 Apple 设备上播放的视频进行编码。对于 Apple 编码的文件，我希望有一些源代码可以编码和生成扩展名为 .m3u8、.ts、.ismx 和清单文件 .ism 的文件

我正在使用表达式编码器 4.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:12:56.470

您链接的示例正在使用`WindowsMediaOutputFormat()`，`WmaAudioProfile()`iOS 设备无法读取，因此请尝试用[Mp4OutputFormat](http://msdn.microsoft.com/en-us/library/microsoft.expression.encoder.mp4outputformat%28v=expression.30%29)和[AacAudioProfile](http://msdn.microsoft.com/en-us/library/microsoft.expression.encoder.profiles.aacaudioprofile%28v=expression.30%29.aspx)替换这些类，然后看看它是如何工作的。

# hibernate - NHibernate 的缓存选项

> ID：12410391
> 
> 赞同：0
> 
> 时间：2012-09-13T16:03:02.280
> 
> 标签：hibernate, nhibernate, nhibernate-mapping, hibernate-mapping

在应用程序中，我有一个名为**Cycles**的引用表，它映射到**Cycle**实体。基本上大多数使用 NHibernate 映射的实体都保留对该表的引用。通常这些实体具有如下字段：

*   开始循环
*   修改周期
*   结束循环
*   循环

等等

即使我每个请求都使用会话，但我仍然在日志中看到大多数查询都发送到**Cycles**表。当我不是通过 Cycle ID 而是通过属于**Cycle**类型的其他属性进行查询时，就是这种情况。

**Cycle**类型几乎是不可变的，它具有**Status**属性，实际上这是唯一可以由 Service 类（如 CloseCycleService、Open 等）更改的属性。循环也不能删除，但可以插入。

所以我想尽量减少对**Cycles**表的查询次数。

我可以通过使用应用程序缓存将它缓存在 ASP .NET 中，并创建另一个抽象层，但在我这样做之前，我想知道 NHibernate 提供的选项以及缺点是什么？

我看到的唯一问题是多线程——即使**Cycle**几乎是不可变的（并且是无状态的），两个请求可能会同时尝试修改同一个实体，这可能会导致错误。但是……这几乎是不可能的。

那么你能建议我用 NHibernate 做什么来将 Cycles 表的所有内容存储在缓存中（哦，我也没有提到该表中的数据数量很小：每月 1 个周期，所以目前大约 20 行，并且每月会增长 1 行）并最小化向**Cycles**表发出的查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:14:37.607

将 NHibernate 二级缓存与 SysCacheProvider 和查询缓存一起使用 - 当您为 Cycle 实体创建查询时，调用 .SetCacheable(true) 它将查询结果存储在缓存中（以及实体本身）

NHibernate 的二级缓存实现得非常好，它将与您在同一进程中所做的任何更改保持缓存一致。如果您直接在数据库中进行更改，那么您可以查看 SysCacheProvider2（我认为），我认为它也支持 SqlDependencies。

# android - 了解 Google Directions API 每日查询限制

> ID：12410392
> 
> 赞同：1
> 
> 时间：2012-09-13T16:03:03.330
> 
> 标签：android, google-maps

我计划在出租车司机的 Android 应用程序中使用 Google Directions API 来构建出租车驱动器的路线。我不清楚每天 2500 条路线查询的限制。请求数的计算依据是什么？每个客户端的 IP 地址有 2500 个查询？或者以其他方式？我在这里注意到[Google Directions API 查询限制](https://stackoverflow.com/questions/5302780/google-directions-api-query-limit)。那里有关于每个移动公司服务器的限制的提案，但没有评论，没有答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T23:37:24.870

是的，它是每个 IP 地址。但是，请注意，许多移动服务将让设备共享 IP 地址。因此，您可能想要实现一个后备 Web 应用程序。此外，请确保您符合应用程序的服务条款，并调查 Google Maps API for Business 以获得更高的配额。

# javascript - 显示隐藏多个表

> ID：12410395
> 
> 赞同：2
> 
> 时间：2012-09-13T16:03:13.010
> 
> 标签：javascript, html

我想知道是否有人可以通过命令帮助我；

如果有以下脚本：

```
<script type="text/javascript">
function show_table(id){
  document.getElementById('table1').style.display='none';
  document.getElementById('table2').style.display='none';
  document.getElementById('table3').style.display='none';
  document.getElementById('table4').style.display='none';
  document.getElementById('table6').style.display='none';
  document.getElementById('table'+id).style.display='block';
}
</script> 
```

它可以很好地显示我拥有的表格，但是现在我想使用命令同时打开两个表格，因此只需单击以下参考链接；

```
<a href="#" onclick="show_table(6)">Table6</a> 
```

是否可以将它与双 onclick="" 命令一起使用？我想打开作为示例表（6）和表（2）。我应该写什么？顺便说一句，我只能使用 javascript，不能使用 PHP。

我尝试过这样的事情，但没有完成这项工作

```
<a href="#" onclick="show_table(6),show_table(2)">Table6 and Table2</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:07:17.020

试试这个版本，它可以接受一个数字或一个数组：

```
function show_table(id) {
    var ix;

    for (ix = 1;  ix <= 6;  ++ix) {
        document.getElementById('table' + ix).style.display='none';
    }
    if (typeof id === "number") {
        document.getElementById('table'+id).style.display='block';
    } else if (id && id.length) {
        for (ix = 0;  ix < id.length;  ++ix) {
            document.getElementById('table'+ix).style.display='block';
        }
    }
} 
```

然后你可以说 show_table([1, 2]) 而不仅仅是 show_table(1)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:07:30.627

```
 function show_table(ids) {
        var idArr = ids.split(",");
        document.getElementById('table1').style.display='none';
      document.getElementById('table2').style.display='none';
      document.getElementById('table3').style.display='none';
      document.getElementById('table4').style.display='none';
      document.getElementById('table6').style.display='none';

        for(var i = 0; i< idArr.length; i++) {
            document.getElementById('table'+idArr[i]).style.display='block';
        }
    }

<a href="#" onclick="show_table('6,2')"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T18:31:38.423

如果您更喜欢最小力方法，请尝试以下操作：

```
function hide_all_tables(){
    document.getElementById('table1').style.display='none';
    document.getElementById('table2').style.display='none';
    document.getElementById('table3').style.display='none';
    document.getElementById('table4').style.display='none';
    document.getElementById('table6').style.display='none';
}

function show_table(id){
    document.getElementById('table'+id).style.display='block';
} 
```

然后以这种方式使用代码：

```
<a href="#" onclick="hide_all_tables();show_table(6);show_table(2);">Table6 and Table2</a> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T16:06:46.933

我从来没有使用过“双击命令”，老实说，我认为它们不起作用，或者是好的做法。你为什么不把两个显示表命令都放在一个 javascript 函数中并调用该函数 onclick 呢？

如果我正确理解你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T17:17:08.167

如果表具有逻辑关联（它们必须，对吗？），您**可以一次更改它们而无需循环。**

这个想法是为他们分配一个类（或多个类）并立即更改整个类：

```
<script>
function f(classname, show)
{
    var mysheet=document.styleSheets[0];

    /* Each class in the styleSheet is called a 'rule' */
    var myrules=mysheet.cssRules;

    var value = show ? '' : 'none'; /* show or hide? */
    for (i=0; i<myrules.length; i++){

        /* find the class we want to change */
        if(myrules[i].selectorText==classname){
            /* change the rule */
            myrules[i].style.display = value;
        }
    }
}
</script>

<style type="text/css" >
.hasPets { color: green; display: none; }
.hasCats { font-weight: bold; display: none; }
</style>

​&lt;button onclick="f('.hasPets', true)">Show Pets</button>
​&lt;button onclick="f('.hasCats', true)">Show Cats</button>
​&lt;button onclick="f('.hasPets', false)">Hide Pets</button>
​&lt;button onclick="f('.hasCats', false)">Hide Cats</button>

<div class="hasPets">Pets</div>
<div class="hasCats hasPets">Cats</div> 
```

在此示例中，`Show Pets`两者都显示，`Hide Cats`仅隐藏 Cats。您不能只显示 Cats - Pets 会覆盖它。

**注意**：为了清楚起见，我保持简短。在实践中，您将不得不添加几行，因为并非所有版本的 IE 都支持`.cssRules property`，我认为他们称之为`.rules`。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-09-17T15:28:33.267

此功能允许显示任意数量的表格。

```
function show_table(){
    for(var i = 1; i  < 7; i++) // change 7 to the amount of tables 
        if(document.getElementById('table'+i))
            document.getElementById('table'+i).style.display='none';

    for (var i = 0; i < arguments.length; i++)
        if(document.getElementById('table'+arguments[i]))
            document.getElementById('table'+arguments[i]).style.display='block';
} 
```

要显示 ID 为的表，`table3`然后`table5`：

```
show_table(3,5); 
```

# regex - Powershell 正则表达式 - 匹配直到字符

> ID：12410397
> 
> 赞同：1
> 
> 时间：2012-09-13T16:03:22.653
> 
> 标签：regex, powershell

所以我需要做的是匹配文本，直到我击中某个字符，然后停止。现在我有一段时间让它正常工作，在这一点上，我想我只是让自己更加困惑。我正在搜索的文本将如下所示：

```
ServerA_logfile.log
ServerB_logfile.log
ServerC_logfile.log 
```

我需要做的只是返回服务器名称，并排除下划线字符之后的所有内容。

这是我的代码：

```
Get-ChildItem \\fileshare\logs\ -Name -Filter *.log | foreach { [regex]::match($_ -replace "^_", "")} 
```

它返回的是......好吧，没有帮助，但这是我能得到的。

我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T16:21:21.877

你需要的是[积极的前瞻](http://www.regular-expressions.info/lookaround.html#lookahead)（它是*在某些情况下为匹配*量身定制的）

```
[Regex]::Match($_, "^.+(?=_)").Value 
```

`Match()`不返回字符串，而是返回`Match`对象。因此，`Value`应该访问该属性以从对象中提取字符串。

如果不清楚，使用的表达式指定查找：

*   在行首 ( `^`)
*   任意长度的字符串（大于或等于一个字符） ( `.+`)
*   后跟下划线 ( `(?=_)`)，表示正向前瞻

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T17:07:21.887

还有一个非常简单的解决方案：

```
[Regex]::Match($_, "^[^_]*").Value 
```

`[^_]`匹配除下划线以外的任何字符。因此`^[^_]*`，匹配从字符串的开头开始，并在第一个下划线之前停止。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T17:02:13.443

我知道要求使用正则表达式，但使用内置`split`命令同样容易（也许更容易）。

这是代码：

```
Get-ChildItem \\fileshare\logs\ -Name -Filter *.log | foreach { $_.Split("_")[0] } 
```

# extjs - bryntum调度器如何动态改变增量

> ID：12410398
> 
> 赞同：-1
> 
> 时间：2012-09-13T16:03:21.757
> 
> 标签：extjs, scheduler

我正在尝试使用 bryntum 调度程序。

有什么方法可以动态更改 Increment 属性或对其进行放大/缩小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T02:40:29.843

我建议为您需要的配置创建额外的预设，然后只需调用 switchViewPreset 在它们之间进行更改。更多信息在这里：

[http://www.bryntum.com/docs/#!/api/Sch.preset.ViewPreset](http://www.bryntum.com/docs/#!/api/Sch.preset.ViewPreset)

和这里：

[http://www.bryntum.com/docs/#!/api/Sch.preset.Manager](http://www.bryntum.com/docs/#!/api/Sch.preset.Manager)

对于缩放，请查看此示例：[http ://www.bryntum.com/examples/scheduler-latest/examples/zooming/zooming.html](http://www.bryntum.com/examples/scheduler-latest/examples/zooming/zooming.html)

# firefox-addon - 有没有办法不从 HTML 文件（在 Firefox 插件 main.js 文件中）加载 AngularJS？

> ID：12410399
> 
> 赞同：1
> 
> 时间：2012-09-13T16:03:22.753
> 
> 标签：firefox-addon, angularjs, firefox-addon-sdk

我正在使用[AngularJS](http://angularjs.org/)开发一个 Firefox 扩展，并且我正在尝试在我的 main.js 文件中使用一些 AngularJS 服务。我`require()`用来包含相关模块并`angular.bootstrap()`初始化模块。

但是，我总是收到以下错误：

> 参考错误：未定义窗口

我还能做些什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T06:37:08.390

AngularJS 并不真正适用于这种环境 - 它是一个 MVC 框架，在您的情况下 V（视图）缺失。你没有告诉你想用 AngularJS 做什么，但你可能想考虑在你的内容脚本中使用它，而不是`main.js`.

也就是说，AngularJS 通常`window`只是简单地用作访问全局对象的一种方式。这很容易修复，AngularJS 源代码的倒数第二行说：

```
})(window, document); 
```

这应该改为：

```
})(this, document); 
```

这至少会允许那些不需要视图的功能继续进行。当然，您仍然需要删除最后一行（试图将样式表插入文档的行）并导出`angular`变量：

```
exports.angular = angular; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T19:12:19.703

没有太多细节，所以我不确定这个建议是否符合你想要做的。如果您想使用一些需要 DOM 并且不想向用户显示文档的 JS 库，请考虑使用 page-worker 模块：

[https://addons.mozilla.org/en-US/developers/docs/sdk/latest/packages/addon-kit/page-worker.html](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/packages/addon-kit/page-worker.html)

您需要在 worker 和 main.js 之间设置事件驱动的通信，就像 SDK 代码使用的任何其他内容文档一样：

[https://addons.mozilla.org/en-US/developers/docs/sdk/latest/dev-guide/guides/events.html](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/dev-guide/guides/events.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T07:00:28.787

您要更新的观点是什么？您应该能够提供`angular.bootstrap`一些非根元素来开始编译。[http://docs.angularjs.org/api/angular.bootstrap](http://docs.angularjs.org/api/angular.bootstrap)

如果您正在使用一些依赖于窗口的服务，您可能还需要提供自己的调整`$window`服务。[http://docs.angularjs.org/api/ng.$window](http://docs.angularjs.org/api/ng.%24window)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T22:19:07.890

可能您必须通过获取窗口对象 `var window = require("window-utils").activeBrowserWindow;`？

# php - 要求作者为帖子设置特色图片

> ID：12410402
> 
> 赞同：4
> 
> 时间：2012-09-13T16:03:30.760
> 
> 标签：php, image, wordpress, function, featured

我已经定制了我的 Wordpress 网站设计，以过度使用特色图片来发布帖子。这就是为什么我需要要求非管理员发布的所有帖子都需要一组特色图片。

这怎么可能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T17:58:56.617

您需要在您编写的自定义插件中挂钩发布操作。尽管这需要标题，但这应该可以帮助您入门，您只需要检查是否分配了特色图像。

```
add_action( 'pre_post_update', 'bawdp_dont_publish' );

function bawdp_dont_publish()
{
    global $post;
    if ( strlen( $post->title ) < 10 ) {
        wp_die( 'The title of your post have to be 10 or more !' );
    }
} 
```

查看 ( [`has_post_thumbnail( $post->ID )`](http://codex.wordpress.org/Function_Reference/has_post_thumbnail)) 以确定帖子是否有特色图片。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-27T01:15:11.533

鉴于上面 Gary 的示例，我将以下内容写入了我的 functions.php 文件：

```
function featured_image_requirement() {
     if(!has_post_thumbnail()) {
          wp_die( 'You forgot to set the featured image. Click the back button on your browser and set it.' ); 
     } 
}
add_action( 'pre_post_update', 'featured_image_requirement' ); 
```

我也更愿意在插件中看到这一点 - 有一个叫做**Mandatory Field**但它不适用于预定的帖子。两者都不是真正雄辩的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-10T08:11:01.227

你可以使用插件

```
https://wordpress.org/plugins/require-featured-image/ 
```

或者您可以将以下代码复制并粘贴到您的 wordpress 主题 functions.php 文件中：

```
<?php
/**
 * Require a featured image to be set before a post can be published.
 */
add_filter( 'wp_insert_post_data', function ( $data, $postarr ) {
    $post_id              = $postarr['ID'];
    $post_status          = $data['post_status'];
    $original_post_status = $postarr['original_post_status'];
    if ( $post_id && 'publish' === $post_status && 'publish' !== $original_post_status ) {
        $post_type = get_post_type( $post_id );
        if ( post_type_supports( $post_type, 'thumbnail' ) && ! has_post_thumbnail( $post_id ) ) {
            $data['post_status'] = 'draft';
        }
    }
    return $data;
}, 10, 2 );
add_action( 'admin_notices', function () {
    $post = get_post();
    if ( 'publish' !== get_post_status( $post->ID ) && ! has_post_thumbnail( $post->ID ) ) { ?>
        <div id="message" class="error">
            <p>
                <strong><?php _e( 'Please set a Featured Image. This post cannot be published without one.' ); ?></strong>
            </p>
        </div>
    <?php
    }
} ); 
```

# perl - perl：使用未初始化的值和输出被截断

> ID：12410405
> 
> 赞同：0
> 
> 时间：2012-09-13T16:03:51.950
> 
> 标签：perl

我正在尝试使用以下脚本来打乱文件中序列（行）的顺序。我不确定如何“初始化”值——请帮忙！

```
print "Please enter filename (without extension): ";
my $input = <>;
chomp $input;

use strict;
use warnings;

print "Please enter total no. of sequence in fasta file: ";
my $orig_size = <>*2-1;
chomp $orig_size;

open INFILE, "$input.fasta"
   or die "Error opening input file for shuffling!";
open SHUFFLED, ">"."$input"."_shuffled.fasta"
   or die "Error creating shuffled output file!";

my @array  = (0); # Need to initialise 1st element in array1&2 for the shift function
my @array2 = (0);
my $i      = 1;
my $index  = 0;
my $index2 = 0;

while (my @line = <INFILE>){

    while ($i <= $orig_size) { 

        $array[$i] = $line[$index];
        $array[$i] =~ s/(.)\s/$1/seg;

        $index++;
        $array2[$i] = $line[$index];
        $array2[$i] =~ s/(.)\s/$1/seg;

        $i++;
        $index++;
    }
}

my $array  = shift (@array); 
my $array2 = shift (@array2);

for ($i = my $header_size; $i >= 0; $i--) { 

    my $j = int rand ($i+1);
    next if $i == $j;
    @array[$i,$j]  = @array[$j,$i];
    @array2[$i,$j] = @array2[$j,$i];
}

while ($index2 <= my $header_size) { 

    print SHUFFLED "$array[$index2]\n";
    print SHUFFLED "$array2[$index2]\n";
    $index2++;
}
close INFILE;
close SHUFFLED; 
```

我收到以下警告：

`Use of uninitialized value in substitution (s///) at fasta_corrector6.pl line 27, <INFILE> line 578914.
Use of uninitialized value in substitution (s///) at fasta_corrector6.pl line 31, <INFILE> line 578914.
Use of uninitialized value in numeric ge (>=) at fasta_corrector6.pl line 40, <INFILE> line 578914.
Use of uninitialized value in addition (+) at fasta_corrector6.pl line 41, <INFILE> line 578914.
Use of uninitialized value in numeric eq (==) at fasta_corrector6.pl line 42, <INFILE> line 578914.
Use of uninitialized value in numeric le (<=) at fasta_corrector6.pl line 47, <INFILE> line 578914.
Use of uninitialized value in numeric le (<=) at fasta_corrector6.pl line 50, <INFILE> line 578914.`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:44:34.350

首先，您在以下位置读取整个输入文件：

```
 use IO::File;
  my @lines = IO::File->new($file_name)->getlines; 
```

然后你洗牌：

```
 use List::Util 'shuffle';
  my @shuffled_lines = shuffle(@lines); 
```

然后你把它们写出来：

```
 IO::File->new($new_file_name, "w")->print(@shuffled_lines); 
```

Perl FAQ 中有一个关于[如何洗牌数组](http://perldoc.perl.org/perlfaq4.html#How-do-I-shuffle-an-array-randomly%3f)的条目。另一个条目[讲述了一次性读取文件的多种方法](http://perldoc.perl.org/5.12.3/perlfaq5.html#How-can-I-read-in-an-entire-file-all-at-once%3f)。Perl FAQs 包含很多关于如何做许多常见事情的示例和琐事——这是一个继续学习更多关于 Perl 的好地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T19:06:02.890

On your previous question I gave [this answer](https://stackoverflow.com/a/12357923/725418), and noted that your code failed because you had not initialized a variable named `$header_size` used in a loop condition. Not only have you repeated that mistake, you have elaborated on it by starting to declare the variable with `my` each time you try to access it.

```
for ($i = my $header_size; $i >= 0; $i--) { 
#         ^^--- wrong!

while ($index2 <= my $header_size) { 
#                 ^^--- wrong! 
```

A variable that is declared with `my` is empty (`undef`) by default. `$index2` can never contain anything but `undef` here, and your loop will run only once, because `0 <= undef` will evaluate true (albeit with an uninitialized warning).

Please take my advice and set a value for `$header_size`. And only use `my` when declaring a variable, not every time you use it.

**A better solution**

Seeing your errors above, it seems that your input files are rather large. If you have over 500,000 lines in your files, it means your script will consume large amounts of memory to run. It may be worthwhile for you to use a module such as [Tie::File](http://search.cpan.org/perldoc?Tie::File) and work only with array indexes. For example:

```
use strict;
use warnings;
use Tie::File;
use List::Util qw(shuffle);

tie my @file, 'Tie::File', $filename or die $!;
for my $lineno (shuffle 0 .. $#file) {
    print $line[$lineno];
}
untie @file; # all done 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T16:36:06.297

I cannot pinpoint what exactly went wrong, but there are a few oddities with your code:

### The Diamond Operator

Perl's Diamond operator `<FILEHANDLE>` reads a line from the filehandle. If no filehandle is provided, each command line Argument (`@ARGV`) is treated as a file and read. If there are no arguments, `STDIN` is used. better specify this yourself. You also should `chomp` *before* you do arithemtics with the line, not afterwards. Note that strings that do not start with a number are treated as numeric `0`. You should check for numericness (with a regex?) and include error handling.

The Diamond/Readline operator is context sensitive. If given in scalar context (e.g, a conditional, a scalar assignment) it returns one line. If given in list context, e.g. as a function parameter or *an array assignment*, it returns *all lines* as an array. So

```
while (my @line = <INFILE>) { ... 
```

will not give you one line but all lines and is thus equivalent to

```
my @line;
if (@line = <INFILE>) { ... 
```

### Array gymnastics

After you read in the lines, you try to do some manual chomping. Here I remove all trailing whitspaces in `@line`, in a single line:

```
s/\s+$// foreach @line; 
```

And here, I remove all non-leading whitespaces (what your regex is doing in fact):

```
s/(?<!^)\s//g foreach @line; 
```

To stuff an element alternatingly into two arrays, this might work as well:

```
for my $i (0 .. $#@line) {
   if ($i % 2) {
     push @array1, shift @line;
   } else {
     push @array2, shift @line;
   }
} 
```

or

```
my $i = 0;
while (@line) {
   push ($i++ % 2 ? @array1 : @array2), shift @line
} 
```

Manual bookkeeping of array indices is messy and error-prone.

Your for-loop could be written mor idiomatic as

```
for my $i (reverse 0 .. $header_size) 
```

Do note that declaring `$header_size` inside the loop initialisation is possible if it was not declared before, but it will yield the `undef` value, therefore you assigned `undef` to `$i` which leads to some of the error messages, as `undef` should not be used in arithemtic operations. Assignments always assigns the right side to the left side.

# android - Android 检测来自任何应用程序的屏幕边缘手势

> ID：12410407
> 
> 赞同：1
> 
> 时间：2012-09-13T16:04:01.813
> 
> 标签：android, view, filter, touch

我正在尝试制作一个应用程序来检测在任何应用程序中从屏幕边缘滑动的手势，类似于滑动板或智能状态栏。

我尝试使用 SYSTEM_ALERT_WINDOW 创建视图，但它要么过滤所有触摸事件，要么根据 NOT_TOUCHABLE 标志不接收任何事件。

还有另一种方法可以实现这一目标吗？

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:21:10.533

我最终坚持使用 SYSTEM_ALERT_WINDOW 但在屏幕边缘设置它非常小

# css - Mountain Lion 中的 CSS 自动溢出：滚动条未出现

> ID：12410408
> 
> 赞同：1
> 
> 时间：2012-09-13T16:04:10.233
> 
> 标签：css, scrollbar, overflow, osx-mountain-lion

在 Lion 和 Mountain Lion 上的 Chrome 或 Safari 中测试[这个 JS Fiddle](http://jsfiddle.net/zEnaY/)。

应该显示的是一个可以滚动的框。开始滚动后，该栏应出现，并在您停止滚动时再次消失。在狮子和山狮中，它没有。有人知道显示滚动条的修复程序吗？

HTML：

```
<div id="box">
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus facilisis scelerisque aliquam. Nulla consequat justo malesuada mi imperdiet sodales. Morbi rhoncus, diam nec egestas sagittis, ipsum eros sollicitudin urna, quis ornare erat nisl scelerisque eros. Nulla eleifend posuere tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum in diam commodo sapien mollis cursus. Integer vitae lacus augue. Proin a velit augue. Quisque at mi augue, a sagittis metus. Aenean id bibendum nunc. Nulla quis eros odio. Sed non leo diam, et sollicitudin leo. Cras ut nibh diam, a mattis felis. Proin lectus massa, fermentum sit amet aliquet id, posuere a dui. Morbi vulputate elit elit. Proin in mi turpis.</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus facilisis scelerisque aliquam. Nulla consequat justo malesuada mi imperdiet sodales. Morbi rhoncus, diam nec egestas sagittis, ipsum eros sollicitudin urna, quis ornare erat nisl scelerisque eros. Nulla eleifend posuere tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum in diam commodo sapien mollis cursus. Integer vitae lacus augue. Proin a velit augue. Quisque at mi augue, a sagittis metus. Aenean id bibendum nunc. Nulla quis eros odio. Sed non leo diam, et sollicitudin leo. Cras ut nibh diam, a mattis felis. Proin lectus massa, fermentum sit amet aliquet id, posuere a dui. Morbi vulputate elit elit. Proin in mi turpis.</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus facilisis scelerisque aliquam. Nulla consequat justo malesuada mi imperdiet sodales. Morbi rhoncus, diam nec egestas sagittis, ipsum eros sollicitudin urna, quis ornare erat nisl scelerisque eros. Nulla eleifend posuere tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum in diam commodo sapien mollis cursus. Integer vitae lacus augue. Proin a velit augue. Quisque at mi augue, a sagittis metus. Aenean id bibendum nunc. Nulla quis eros odio. Sed non leo diam, et sollicitudin leo. Cras ut nibh diam, a mattis felis. Proin lectus massa, fermentum sit amet aliquet id, posuere a dui. Morbi vulputate elit elit. Proin in mi turpis.</p>
</div>​ 
```

CSS：

```
#box {        
    height: 300px;
    overflow: auto;
    margin: 10px;
}​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T19:35:04.323

这个问题是“真实的”，因为之前的海报已经在 Apple 的 Mountain Lion 操作系统中显示出真正的外观差异。

但是滚动行为仍然有效，在我在互联网上和开篇文章的“测试这个”链接上看到的其他示例中。

问题是 Mountain Lion 中的默认用户设置会导致滚动条被隐藏，因此用户看不到它们。并且默认的“自然”滚轮或触控板（Magic Pad）方向与旧系统或 PC 的方向相反。这两个方面导致混乱。

在默认设置下，如果鼠标箭头在块上（即使滚动条不存在），滚动区域将滚动，并且如果朝正确的方向移动，滚动区域就会出现。默认的“自然”（Apple 称之为）方向是滚轮或触控板沿“自然”方向移动对象本身（与在对象上移动的窗口相反）。Mac 上有一个设置可以扭转这种情况，但这会使 Mac 的方向与 Apple 触摸平板电脑的方向相反。

真正的问题是隐藏滚动条给用户带来的困惑，所以他们没有意识到如果鼠标光标在上面，他们可以用滚轮移动区域。此外，用户必须有一个触控板或滚轮才能使其正常工作，但这在大多数情况下甚至是导航 Mountain Lion 操作系统本身所必需的。

用户可以在个人常规设置中将 Mac 的设置更改为“显示滚动条：始终”。但这对 CSS 或网站开发人员帮助不大。

我建议我们就此向 Apple 投诉。主要的替代方法是不使用网站窗口中的可滚动区域的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:59:09.077

这是一个 jQuery 插件，可以满足您的需求。

[http://naeka.github.com/jquery-scrollbar/](http://naeka.github.com/jquery-scrollbar/)

你需要

```
<script type="text/javascript" src="jquery-1.6.2.min.js"></script>
<script type="text/javascript" src="jquery-ui-1.8.16.custom.min.js"></script>
<script type="text/javascript" src="jquery.scrollbar.min.js"></script>
<script type="text/javascript" src="demo.js"></script> 
```

使用类`<div id="page"> <div class="scrollBox"><div id="scroll1"><p class="left">`

示例：http: [//jsfiddle.net/pullapooh/3aGDK/](http://jsfiddle.net/pullapooh/3aGDK/)

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-09-13T17:55:19.330

似乎在 linux mint 上对我有用，尝试一下如何：

```
溢出：滚动；
```

# mysql - Mysql 在子查询中返回匹配的用户

> ID：12410409
> 
> 赞同：1
> 
> 时间：2012-09-13T16:04:12.083
> 
> 标签：mysql

我正在寻找一种方法来编写一个查询来比较多个 mysql 子查询的结果，并返回每个查询中的用户。

我有一个包含球员的梦幻足球统计数据。为简化起见，在这种情况下，我使用了 3 列：玩家、积分、年份。

我希望运行一个查询，以返回 2010 年和 2011 年均进入前 50 名（基于积分）的球员列表。

我已经在使用子查询、在一张表上进行连接等方面进行了很多搜索，但我仍然对如何处理这个问题感到茫然。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:08:05.013

你可以这样做：

```
SELECT  a.player

FROM    (SELECT player FROM players WHERE Year = 2010 ORDER BY points DESC LIMIT 50) a

        JOIN

        (SELECT player FROM players WHERE Year = 2011 ORDER BY points DESC LIMIT 50) b
        ON a.player = b.player 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:40:32.897

您可以使用 a `UNION ALL`，这将`Top 50`在两年内为您提供并将它们放在相同的结果集中，无需加入：

```
(
    select player, year, points 
    from players
    where year = 2010
    order by points desc
    limit 50
)
union all
(
    select player, year, points 
    from players
    where year = 2011
    order by points desc
    limit 50
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:36:15.663

Here is an example. I assumed that you calculate top50 based on sum of points and you have several entries for each player in each year.

```
 select y2010.player 
from (
  select player, sum from (
    select st1.player player, sum(st1.points) sum from stats st1 where st1.year = 2010 group by st1.player order by sum desc
  ) t1 limit 50 offset 0
) y2010, (
  select player, sum from (
    select st1.player player, sum(st1.points) sum from stats st1 where st1.year = 2011 group by st1.player order by sum desc
  ) t1 limit 50 offset 0
) y2011
where y2010.player = y2011.player 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T16:57:18.950

您是否想要：

*   2010 年进入前 50 名的所有球员，以及 2011 年进入前 50 名的所有球员：

    ```
    SELECT *
    FROM   scores
    WHERE  year = 2010
       AND points >= (SELECT MIN(points) FROM (
                       SELECT   points
                       FROM     scores
                       WHERE    year = 2010
                       ORDER BY points DESC
                       LIMIT    50
                     ) t)
    UNION ALL
    SELECT *
    FROM   scores
    WHERE  year = 2011
       AND points >= (SELECT MIN(points) FROM (
                       SELECT   points
                       FROM     scores
                       WHERE    year = 2011
                       ORDER BY points DESC
                       LIMIT    50
                     ) t) 
    ```

*   *所有在*2010 年和 2011年均进入前 50 名的球员，在这种情况下，您需要进一步对结果进行分组：

    ```
    SELECT   player
    FROM     (
               -- query as above
             ) t
    GROUP BY player
    HAVING   COUNT(DISTINCT year) = 2 
    ```

# telerik-grid - 将 EditorTemplate 文件绑定到 Kendo UI MVC 中的网格组合框

> ID：12410411
> 
> 赞同：0
> 
> 时间：2012-09-13T16:04:21.793
> 
> 标签：telerik-grid, telerik-mvc, kendo-ui

想象一下，我在**/Views/Home/Index.cshtml**上的文件上有网格：

```
 @model IEnumerable<KendoMVCWrappers.Models.StockWebAndDetailsView>

@( Html.Kendo().Grid(Model)

               .Name("Grid")
                @* Other columns and dataSource in here *@
                columns.Bound("QuantityToEnquiry").Filterable(false).Sortable(false)
                     .EditorTemplateName("QuantityToEnquiry"); 

               }) 
```

我在**/Views/EditorTemplateName/QuantityToEnquiry.cshtml**上有文件（我也试过 **~/Views/Shared/EditorTemplates/**）：

```
 @(Html.Kendo().ComboBox()
        .Name("QuantityToEnquiry")
        .Value("1")
            .BindTo(Enumerable.Range(1, 100).ToList()) 
```

在我的模型上：

```
public class StockWebAndDetailsView
{
    [UIHint("QuantityToEnquiry")]
            public int QuantityToEnquiry { get; set; }
} 
```

显示的数据是**null**，一个值为“null”的字符串，我不知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:04:26.590

哟，伙计，

首先，我建议您将该编辑器模板放在 Shared/EditorTemplates 文件夹下。然后我建议您将组合框命名为与您的属性相同的名称。

```
@(Html.Kendo().ComboBox()
    .Name("QuantityToEnquiry")
    .Value("1")
        .BindTo(Enumerable.Range(1, 100).ToList()) 
```

我希望它有所帮助。

# ios - 如果我在未安装 iBooks 的情况下尝试通过我的应用程序在 iBooks 中打开 pdf，会发生什么情况？

> ID：12410414
> 
> 赞同：1
> 
> 时间：2012-09-13T16:04:26.857
> 
> 标签：ios, cocoa, ibooks

我从[Send PDF to iBooks](https://stackoverflow.com/questions/3098342/send-pdf-to-ibooks)中看到了如何格式化链接以在 iBooks 中打开 pdf，但是如果未安装 iBooks，它会正常打开吗？或者有什么东西会坏掉？（我知道，我可以对此进行测试并找出答案，但也可以将其放在这里以供其他有相同问题的人使用。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:09:59.783

有两种方法可以在另一个应用中打开内容

1) [UIDocumentInteractionController presentOpenInMenuFromRect]

这将仅显示可用的应用程序。因此，iBooks 将不会显示，您将无法在其中打开 pdf

2) 自定义 URL 的使用。

应用程序向系统注册自定义 URL。因此，如果未安装 iBooks 并且未注册自定义 URL，则调用将失败（我不确定它会返回哪种错误）。

# java - 如何设置私有的、可远程访问的 Maven 存储库？

> ID：12410423
> 
> 赞同：47
> 
> 时间：2012-09-13T16:04:53.113
> 
> 标签：java, maven

我需要为一些内部公司库设置一个 Maven 存储库，这些库只需要我们的开发人员访问（即安全），但应该可以通过 Internet 安全访问。

我熟悉设置公共 Maven 存储库，但不确定设置私有远程访问存储库的最佳方式。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-14T07:22:54.643

解决方案是使用 Maven 存储库管理器，例如 Nexus、Artifactory 或 Archivia。

您将 MRM 安装在服务器上，并使用您希望访问它的用户的身份验证详细信息对其进行配置。

[您可以在https://oss.sonatype.org](https://oss.sonatype.org)和[https://repository.apache.org](https://repository.apache.org/)上看到一个可公开访问的 Nexus 实例。因此，在此基础上，假设 Nexus 中的身份验证是可靠且安全的是相当安全的。

Artifactory 可作为在线托管服务使用，我们将它（在线托管服务）用于我们的内部工件托管。

Archivia 由一些非常好的人维护，我怀疑他们也有很好的锁定。

如果您想快速启动并运行并且不想管理服务器，我建议您使用 Artifactory 等托管服务。我不知道是否有在线 Nexus 或 Archivia 托管服务。

现在进行披露：

1.  JFrog（Artifactory 的创建者）是我雇主的合作伙伴，我们使用 Artifactory 托管服务
2.  Sonatype（Nexus 的创建者）是我雇主的合作伙伴
3.  我是 Apache 软件基金会的成员（Archivia 的创建者）

我不推荐您使用*哪种*MRM。但作为 Maven 提交者和 PMC 成员，我*强烈建议*使用 MRM。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-16T18:40:49.357

[Amazon S3](http://aws.amazon.com/s3/)是最好的解决方案：http: [//www.stackoverflow.com/questions/850570/maven-s3-wagon-provider](http://www.stackoverflow.com/questions/850570/maven-s3-wagon-provider)，因为：

1.  无需安装程序
2.  由亚马逊托管，高度可用
3.  Maven 通过一些货车完全支持（见上面的链接）

您可能还会发现这篇文章很有帮助：[http ://www.yegor256.com/2015/09/07/maven-repository-amazon-s3.html](http://www.yegor256.com/2015/09/07/maven-repository-amazon-s3.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-03-10T16:01:27.350

自从发布这个问题后，我发现了[JitPack](https://jitpack.io/)，这使得直接从 Github 创建公共（免费）和私有（廉价）存储库变得非常容易。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-13T16:08:05.420

您可以使用archiva 或nexus 将用户名/密码放在服务器上的不同存储库中。您还可以管理谁可以部署到这些存储库。

这些可以添加到您的 settings.xml 文件中，这样您就不必每次都登录。

# neo4j - 事后如何在 Neo4j 中创建复合索引

> ID：12410427
> 
> 赞同：1
> 
> 时间：2012-09-13T16:05:11.080
> 
> 标签：neo4j

我可以在创建对象后使用 neo4j 管理员中的电动工具控制台创建复合索引吗？我目前添加一个节点，而不是将其“名称”属性添加到“应用程序”索引。现在我还想创建一个“平台”和“storeId”复合索引。顺便说一句，我应该将它添加到同一个 Apps 索引还是创建一个新索引。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T21:21:23.113

当然，您可以通过控制台创建新索引并添加现有节点。

最明智的做法是[执行脚本片段](http://docs.neo4j.org/chunked/snapshot/shell-commands.html#_executing_groovy_python_scripts)，请参阅[控制台在线手册](http://docs.neo4j.org/chunked/snapshot/shell-commands.html#_indexing)并发出`help index`控制台。

所以要么使用这样的东西：

```
index -q Apps "name:*" -c cd -a $i && index -i Apps storeId 
```

否则使用 eval 来评估一个 javascript 片段：

```
eval                                                   
  index=db.index().forNodes("Apps")                   
  nodes=index.query("name:*")                            
  while ( nodes.hasNext() ) {                            
     node=nodes.next()                                   
     index.add(node,"storeId",node.getProperty("storeId"))
  } 
```

# email - 如何在不使用 RSCONN01 程序的情况下发送电子邮件？

> ID：12410428
> 
> 赞同：0
> 
> 时间：2012-09-13T16:05:12.043
> 
> 标签：email, abap, sapconnect

我正在尝试在不使用 rsconn01 的情况下发送带有 excel 附件的电子邮件。如果这是可能的，你能告诉我这是怎么做的吗？

我还想了解更多有关 rsconn01 工作原理的信息。我正在使用 rsconn01 发送电子邮件，但我收到投诉称该程序还在重新发送当天早些时候失败的电子邮件。

这是我现在使用的代码。它有效，但我想知道另一种不使用 rsconn01 的方法。

```
`CALL FUNCTION 'SO_DOCUMENT_SEND_API1'
EXPORTING
  document_data              = w_doc_data
  put_in_outbox              = 'X'
  commit_work                = 'X'

IMPORTING
  sent_to_all                = w_sent_all
TABLES
  packing_list                = t_packing_list
   contents_bin               = t_attachment
  contents_txt               = it_message
  receivers                  = t_receivers
EXCEPTIONS
  too_many_receivers         = 1
  document_not_sent          = 2
  document_type_not_exist    = 3
  operation_no_authorization = 4
  parameter_error            = 5
  x_error                    = 6
  enqueue_error              = 7
  OTHERS                     = 8.

if sy-subrc = 0.
   WAIT UP TO 2 SECONDS.
   SUBMIT rsconn01 WITH mode = 'INT'
            WITH output = 'X'
           AND RETURN.
    else.
  WRITE:/ 'ERROR IN MAIL ', sy-subrc.
endif.` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:45:15.320

除非您想实现自己的协议处理，否则您将不得不使用 RSCONN01。您正在使用标准的 SAPconnect 功能（虽然 API 有点过时，但如果我站在您的立场上，我会切换到[BCS](http://help.sap.com/saphelp_nw73ehp1/helpdata/en/4d/353bcfd2512304e10000000a15822b/frameset.htm)）。只要您使用它，您就会被该报告卡住。但是，您通常不必自己调用它。这是一个后台进程，每隔几分钟就会调用一次以处理外发邮件。也许您在 SAPconnect 系统未正确设置的开发环境中工作 - 在这种情况下，您应该与系统管理员交谈。在许多情况下，有多种方法可以调整 SAPconnect 系统以使其正常工作。在尝试规避它们之前，您应该尝试使用现有且支持良好的设施。

# c# - 跟踪子工作流内部活动

> ID：12410431
> 
> 赞同：1
> 
> 时间：2012-09-13T16:05:25.367
> 
> 标签：c#, workflow-foundation-4, workflow-foundation, workflow-activity

我面临一个关于**WF4**和**CustomTrackingRecord的问题，用于通过****WorkflowInvoker**从 .xaml 动态加载的子工作流。执行效果非常好，我能够跟踪 InArguments 和 OutArguments，但不能像我对 0 级工作流（父级）所做的那样跟踪内部活动。这里是 InArgs 和 OutArgs 跟踪的代码。

```
var userRecord = new CustomTrackingRecord("InArguments");
        foreach (var kvp in inArgs) {
            userRecord.Data.Add(kvp.Key, kvp.Value == null ? "" : kvp.Value.ToString());
        }
        context.Track(userRecord); 
```

...

```
 WorkflowInvoker invoker = new WorkflowInvoker(dynamicActivity);
            outArgs = invoker.Invoke(inArgs);

            foreach (string argumentKey in outArgs.Keys) {
                this.ChildArguments[argumentKey].Set(context, outArgs[argumentKey]);
            }

            userRecord = new CustomTrackingRecord("OutArguments");
            foreach (var kvp in outArgs) {
                userRecord.Data.Add(kvp.Key, kvp.Value == null ? "" : kvp.Value.ToString());
            }
            context.Track(userRecord); 
```

我很确定invoker.Invoke(inArgs) 应该启动标准跟踪系统，简而言之，完美工作的系统曾经知道Activity 发生了什么，但它似乎忽略了DynamicActivity 发生了什么。

任何的想法？语境问题？类型问题？

谢谢，弗朗西斯科

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:54:51.603

WorkflowInvoker 是具有自己扩展的不同执行。因此，要将这些事件添加到同一个 TrackingParticipant 中，您需要将其添加到 invoker.Extensions 集合中。

就像是：

```
var invoker = new WorkflowInvoker(dynamicActivity);
var tracker = context.GetExtension<TrackingParticipant>();
invoker.Extensions.Add(tracker);
outArgs = invoker.Invoke(inArgs); 
```

# c++ - 在输入单独的函数之前强制 Qt GUI 更新

> ID：12410433
> 
> 赞同：25
> 
> 时间：2012-09-13T16:05:26.850
> 
> 标签：c++, qt, function, user-interface

这似乎应该是自动的，但显然不是。我有以下代码：

```
 ui.my_label->setText("Test 1...");
    ui.my_label->adjustSize();

    processThatTakesAbout30SecondsToFinish(files[0].toStdString());

    ui.my_label->setText("Finished.");
    ui.my_label->adjustSize(); 
```

正在发生的事情是我*从来没有*看到`"Test1...",`GUI 似乎挂起，直到以下功能完成，我最终只看到“完成。”。

如何确保 GUI 在进入该功能之前正在更新？
谢谢。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-13T16:12:13.513

您应该能够在输入代码之前处理事件队列；

```
#include <QApplication> 
```

并且，当您想刷新 GUI 时，请致电；

```
qApp->processEvents(); 
```

请注意，让您的长时间运行的进程不时调用该函数可能是个好主意，以使您的 GUI 感觉更灵敏。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-13T16:23:30.913

如果你不关心你的 GUI 在这段时间内是否响应，那么调用`my_label->repaint()`就可以了。除非您屈服于事件循环，否则 Qt 无法自动为您做任何事情。

为了获得最大的响应能力，您可以考虑在单独的线程中运行您的进程，并在处理完成时使用信号/插槽连接（默认情况下是线程安全的）向您的主 GUI 线程发出信号。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-13T19:09:43.443

我只是想为我补充一点，它结合了我在这里看到的两个答案。所以对我有用的是：

```
ui.my_label->setText("Test 1...");
ui.my_label->adjustSize();

//! Both of these lines needed
ui.my_label->repaint();
qApp->processEvents();

processThatTakesAbout30SecondsToFinish(files[0].toStdString());

ui.my_label->setText("Finished.");
ui.my_label->adjustSize(); 
```

希望这可以帮助某人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-06T13:04:26.250

定义函数...

```
void YourClass::Update_Ui()
{
if(this->isEnabled())
    return;

this->repaint();
qApp->processEvents();
} 
```

...像这样并确保`this`在您想要强制更新时禁用（以防止用户操作）`ui`对我来说是最好的解决方案。

示例如何在函数中使用它（例如在需要大量时间的堆栈处理期间）：

```
this->setEnabled(false);
//Do whatever you want
Update_Ui();
//Do some other stuff
this->setEnabled(true); 
```

这不允许用户通过`ui`交互来干扰处理（它被禁用）并`Update_Ui();`在代码中调用时更新并更新整个`ui`，而不仅仅是选择的标签或其他内容。请注意，这不会阻止`ui`元素触发的信号。

# delphi - 如何创建复合控件？

> ID：12410434
> 
> 赞同：3
> 
> 时间：2012-09-13T16:05:43.157
> 
> 标签：delphi, delphi-xe

谁能指出一些（厚厚的）书籍（甚至是网站）来解释如何创建自己的复合控件（例如，TPanel 是其他几个控件的父级）？

我的意思是 Borland 的“组件编写者指南”之外的东西。

我在 StackOverflow 上看到了很多关于这个主题的帖子，在每一篇文章中，人们都在对构造函数、继承、初始化代码的位置/时间、流问题、事件顺序、育儿等方面存在矛盾

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-17T15:29:39.097

我发现 CCPack 有一个 sourceforge 存储库。

甚至还有许多 delphi 版本的软件包。

我已经安装在 Delphi XE2 上，它需要一个简单的修复工作（注册调用不正确，它给出了编译时错误，我不记得确切，但很容易纠正）

我可以按预期安装和工作。我已经使用它制作了几个简单的组件和一个复合组件，并且可以正常工作。

[SourceForge 上的 CCPack](http://sourceforge.net/projects/ccpack/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-17T16:40:14.010

一个对我帮助很大的是 Delphi 3 (Ray Lischner) 的隐藏路径：

[http://www.amazon.com/Hidden-Paths-Delphi-Experts-Wizards/dp/0965736601/ref=sr_1_7?s=books&ie=UTF8&qid=1387298207&sr=1-7&keywords=delphi+ray](https://rads.stackoverflow.com/amzn/click/com/0965736601)

和：

[http://www.amazon.com/Visual-Developer-Developing-Custom-Components/dp/1576101126/ref=sr_1_3?s=books&ie=UTF8&qid=1387298207&sr=1-3&keywords=delphi+ray](https://rads.stackoverflow.com/amzn/click/com/1576101126)

有一本从未读过，但听起来很有趣：

[http://www.amazon.com/Developing-Custom-Delphi-Components-Creating/dp/1883577470/ref=sr_1_4?s=books&ie=UTF8&qid=1387298207&sr=1-4&keywords=delphi+ray](https://rads.stackoverflow.com/amzn/click/com/1883577470)

# python - 如何在不添加额外索引的情况下使用 Pandas groupby apply()

> ID：12410438
> 
> 赞同：11
> 
> 时间：2012-09-13T16:05:55.587
> 
> 标签：python, pandas, apply

我经常想通过组合分组 DataFrame 的多列来创建一个新的 DataFrame。apply() 函数允许我这样做，但它要求我创建一个不需要的索引：

```
 In [359]: df = pandas.DataFrame({'x': 3 * ['a'] + 2 * ['b'], 'y': np.random.normal(size=5), 'z': np.random.normal(size=5)})

 In [360]: df
 Out[360]: 
    x         y         z
 0  a  0.201980 -0.470388
 1  a  0.190846 -2.089032
 2  a -1.131010  0.227859
 3  b -0.263865 -1.906575
 4  b -1.335956 -0.722087

 In [361]: df.groupby('x').apply(lambda x: pandas.DataFrame({'r': (x.y + x.z).sum() / x.z.sum(), 's': (x.y + x.z ** 2).sum() / x.z.sum()}))
 ---------------------------------------------------------------------------
 ValueError                                Traceback (most recent call last)
 /home/emarkley/work/src/partner_analysis2/main.py in <module>()
 ----> 1 df.groupby('x').apply(lambda x: pandas.DataFrame({'r': (x.y + x.z).sum() / x.z.sum(), 's': (x.y + x.z ** 2).sum() / x.z.sum()}))

 /usr/local/lib/python3.2/site-packages/pandas-0.8.2.dev-py3.2-linux-x86_64.egg/pandas/core/groupby.py in apply(self, func, *args, **kwargs)
     267         applied : type depending on grouped object and function
     268         """
 --> 269         return self._python_apply_general(func, *args, **kwargs)
     270 
     271     def aggregate(self, func, *args, **kwargs):

 /usr/local/lib/python3.2/site-packages/pandas-0.8.2.dev-py3.2-linux-x86_64.egg/pandas/core/groupby.py in _python_apply_general(self, func, *args, **kwargs)
     417             group_axes = _get_axes(group)
     418 
 --> 419             res = func(group, *args, **kwargs)
     420 
     421             if not _is_indexed_like(res, group_axes):

 /home/emarkley/work/src/partner_analysis2/main.py in <lambda>(x)
 ----> 1 df.groupby('x').apply(lambda x: pandas.DataFrame({'r': (x.y + x.z).sum() / x.z.sum(), 's': (x.y + x.z ** 2).sum() / x.z.sum()}))

 /usr/local/lib/python3.2/site-packages/pandas-0.8.2.dev-py3.2-linux-x86_64.egg/pandas/core/frame.py in __init__(self, data, index, columns, dtype, copy)
     371             mgr = self._init_mgr(data, index, columns, dtype=dtype, copy=copy)
     372         elif isinstance(data, dict):
 --> 373             mgr = self._init_dict(data, index, columns, dtype=dtype)
     374         elif isinstance(data, ma.MaskedArray):
     375             mask = ma.getmaskarray(data)

 /usr/local/lib/python3.2/site-packages/pandas-0.8.2.dev-py3.2-linux-x86_64.egg/pandas/core/frame.py in _init_dict(self, data, index, columns, dtype)
     454         # figure out the index, if necessary
     455         if index is None:
 --> 456             index = extract_index(data)
     457         else:
     458             index = _ensure_index(index)

 /usr/local/lib/python3.2/site-packages/pandas-0.8.2.dev-py3.2-linux-x86_64.egg/pandas/core/frame.py in extract_index(data)
    4719 
    4720         if not indexes and not raw_lengths:
 -> 4721             raise ValueError('If use all scalar values, must pass index')
    4722 
    4723         if have_series or have_dicts:

 ValueError: If use all scalar values, must pass index

 In [362]: df.groupby('x').apply(lambda x: pandas.DataFrame({'r': (x.y + x.z).sum() / x.z.sum(), 's': (x.y + x.z ** 2).sum() / x.z.sum()}, index=[0]))
 Out[362]: 
             r         s
 x                      
 a 0  1.316605 -1.672293
 b 0  1.608606 -0.972593 
```

有没有办法使用 apply() 或其他一些函数来获得相同的结果而无需额外的零索引？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-13T17:41:05.363

您正在为每个组生成一个聚合 r 和 s 值，因此您应该在`Series`这里使用：

```
In [26]: df.groupby('x').apply(lambda x: 
             Series({'r': (x.y + x.z).sum() / x.z.sum(), 
                     's': (x.y + x.z ** 2).sum() / x.z.sum()}))
Out[26]: 
           r           s
x                       
a  -0.338590   -0.916635
b  66.655533  102.566146 
```

# extjs - 使用数组过滤存储

> ID：12410443
> 
> 赞同：0
> 
> 时间：2012-09-13T16:06:23.663
> 
> 标签：extjs, extjs4

我正在打印 3 个值`console.log (a.name+a.age+a.gender);`，我需要将这 3 个值添加到数组中，然后过滤存储，以便它返回所有具有`a.name`和`a.age`的记录`a.gender`。

我已经编写了我的代码，但我不确定如何将 3 条记录添加到数组中，以及如何在过滤器中使用它（其中将返回与过滤条件匹配的记录列表）

```
console.log (a.name+a.age+a.gender);
var st = Ext.getStore('Person');
st.on('load', function() {
    st.filter({
        filterFn: function(rec) {
            return ????????????????? ; // Not sure how to return all the records that matches the filter criteria..
        }
    });
}, this, { single: true });
st.load(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:15:54.713

像这样的东西怎么样：

```
filterFn: function(rec) {
  return rec.name === a.name 
      && rec.age  === a.age
      && rec.gender === a.gender;
} 
```

我假设您需要找到与此人姓名、年龄和性别完全相同的`a`人。)

# jsf-2 - 何时调用 fileUploadListener？

> ID：12410444
> 
> 赞同：0
> 
> 时间：2012-09-13T16:06:25.037
> 
> 标签：jsf-2, actionlistener

谁能告诉我何时调用 fileUploadListener 以及在哪个阶段。我正在使用 PrimeFaces。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-07T08:46:17.830

fileUploadListener 在阶段 APPLY_REQUEST_VALUES 2 之前执行（我使用的是 PF 3.5）

您可以通过以下方式检查当前阶段实现生命周期侦听器：

```
package mypackage;

import javax.faces.event.PhaseEvent;
import javax.faces.event.PhaseId;
import javax.faces.event.PhaseListener;

public class LifeCycleListener implements PhaseListener {

public PhaseId getPhaseId() {
    return PhaseId.ANY_PHASE;
}

public void beforePhase(PhaseEvent event) {
    System.out.println("START PHASE " + event.getPhaseId());
}

public void afterPhase(PhaseEvent event) {
    System.out.println("END PHASE " + event.getPhaseId());
}

} 
```

然后，将您的新侦听器添加到 faces-config.xml：

```
<lifecycle>
<phase-listener>mypackage.LifeCycleListener</phase-listener>
</lifecycle> 
```

不要忘记为 primefaces 消息添加日志！

干杯!

# jquery - jquery数据表默认排序不起作用

> ID：12410446
> 
> 赞同：12
> 
> 时间：2012-09-13T16:06:34.907
> 
> 标签：jquery, jquery-plugins

我有一个 4 列的表，我希望前 3 列可由用户排序，但不是第 4 列，这工作正常。我还希望第三列默认按 ASC 顺序排序。这部分不起作用，默认情况下我无法对任何列进行排序，也无法弄清楚我的语法有什么问题：

```
$(document).ready(function() {
$(".table-sortable").dataTable({
    aaSorting: [],
    bPaginate: false,
    bFilter: false,
    bInfo: false,
    bSortable: true,
    bRetrieve: true,
    aoColumnDefs: [
        { "aTargets": [ 0 ], "bSortable": true },
        { "aTargets": [ 1 ], "bSortable": true },
        { "aTargets": [ 2 ], "asSorting": [ "asc" ], "bSortable": true },
        { "aTargets": [ 3 ], "bSortable": false }
    ]
}); 
}); 
```

这是我一直在工作的：[http ://datatables.net/usage/columns](http://datatables.net/usage/columns)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-13T16:27:51.090

这应该可以满足您的需求

```
$(document).ready(function() {
    $(".table-sortable").dataTable({
        aaSorting: [[2, 'asc']],
        bPaginate: false,
        bFilter: false,
        bInfo: false,
        bSortable: true,
        bRetrieve: true,
        aoColumnDefs: [
            { "aTargets": [ 0 ], "bSortable": true },
            { "aTargets": [ 1 ], "bSortable": true },
            { "aTargets": [ 2 ], "bSortable": true },
            { "aTargets": [ 3 ], "bSortable": false }
        ]
    }); 
}); 
```

关键是`aaSorting`选项。出于某种原因，它不在他的“主要”使用页面中......你可以在这里找到它虽然[http://datatables.net/ref](http://datatables.net/ref)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-06-05T07:17:29.550

它对我有用。谢谢..最初我使用`'order':[2,'desc']`的是不工作..正确的选项是**aaSorting**

例如;

```
$(document).ready(function() {
    $('#example1').DataTable({
        aaSorting: [[0, 'desc']]
    });
}); 
```

# matlab - matlab中的过滤矩阵

> ID：12410450
> 
> 赞同：3
> 
> 时间：2012-09-13T16:06:48.910
> 
> 标签：matlab

我有列向量 A 和 B：

```
A'= [1 2 0 0 1 4]
B'= [1 2 3 4 5 6] 
```

我想过滤掉 A 中的零并删除 B 中的相应元素并将它们设置为：

```
A' = [1 2 1 4] 
B' = [1 2 5 6] 
```

我知道有一个快速的 MATLAB 命令可以做到这一点，但无法弄清楚。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T17:25:08.323

最快、最简单的方法是使用逻辑索引：

```
A = [1 2 0 0 1 4].';
B = [1 2 3 4 5 6].';

nz = (A ~= 0); %# logical matrix for non-zeros in A

A = A(nz)      %# non-zeros of A
B = B(nz)      %# corresponding elements in B 
```

另一种方式是稍微慢一点

```
nz = find(A); %# vector of linear indices to non-zero elements

A = A(nz)     %# non-zeros of A
B = B(nz)     %# corresponding elements in B 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:51:37.200

您可以通过删除中间变量并稍微更改语法来进一步压缩逻辑索引解决方案。

```
B=B(~~A)
A=A(~~A) 
```

删除中间变量（即`nz=~~A`）的唯一可能的轻微缺陷是您必须记住在更改`B`之前更改`A`。可以通过将操作转换为单个命令来消除这个陷阱——在计算表达式的右侧之前，不会将新值分配给变量。

```
[A,B] = deal(A(~~A),B(~~A)) 
```

Zen（如果您正在寻找最少数量的命令字符），尽管我同意效率可能会受到影响（请参阅评论）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T16:10:09.380

你可以这样做：

```
> A = [1 2 0 0 1 4]
A =

   1   2   0   0   1   4

> B = [1 2 3 4 5 6]
B =

   1   2   3   4   5   6

> V = find(A~=0)        % get the indices for which A <> 0 
V =

   1   2   5   6

> A = A(V)              % select elements from A
A =

   1   2   1   4

> B = B(V)              % select elements from B
B =

   1   2   5   6

> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T18:03:56.230

另一种选择是删除 A 中的 0 元素：

```
A0=A==0;
A(A0)=[]; 
B(A0)=[]; 
```

但是正如@RodyOldenhuis 所说，`A(A0)=[]`它比`A=A(A0)`. 所以，当涉及到大循环，或者A的大小非常大时，`A(A0)=[]`应该避免使用。

# forms - 将字符串用于 symfony2 日期时间月份下拉列表

> ID：12410458
> 
> 赞同：2
> 
> 时间：2012-09-13T16:07:28.790
> 
> 标签：forms, symfony

我正在以标准的 symfony2 方式构建一个表单，就像这样

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
   $builder->add('publishedAt', 'datetime');
} 
```

这很好用，但它提供了一个月的下拉菜单，就像这样

```
<select>
   <option value="1">01</option>
   <option value="2">02</option>
   <option value="3">03</option>
</select> 
```

我真正想要的是一个使用字符串作为选项文本的下拉菜单，更像这样

```
<select>
    <option value="1">Jan</option>
    <option value="2">Feb</option>
    <option value="3">Mar</option>
</select> 
```

实现这一目标的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:02:15.783

采用：

```
 $builder->add('publishedAt', 'datetime', array(
        'date_format' => 'yyyy-MMM-dd'
    )); 
```

你可以使用这个 date_format 来做一些事情，比如在末尾显示年份 (dd-MMM-yyyy) 或者只显示两位数字的年份。（日-月-年）。请注意，此日期格式仅接受 y、M 和 d 格式（例如，没有星期几）并且时间没有对应的“time_format”。有关格式说明符的更多信息在[这里](http://userguide.icu-project.org/formatparse/datetime#TOC-Date-Time-Format-Syntax)

# javascript - 使用 JavaScript 根据窗口/视口的高度动态调整图像大小

> ID：12410462
> 
> 赞同：0
> 
> 时间：2012-09-13T16:07:57.103
> 
> 标签：javascript, image, layout, resize, fluid

我正在尝试为摄影师设计一个网站，该网站将调整图像和缩略图的高度，以使其适合用户的窗口大小。这是我第一次尝试流畅的布局而不是固定宽度的布局。

图片需要根据浏览器的高度调整大小，并且必须保持纵横比。

为了更清楚地了解我的意图是什么，您可以查看我的两个设计（很多工作正在进行中

[http://annmariegrant.com/test1](http://annmariegrant.com/test1)（这个设计会有两三排缩略图，需要根据窗口的高度调整大小）

[http://annmariegrant.com/test2](http://annmariegrant.com/test2)（此设计将只有一排图像（幻灯片），再次调整大小以适应窗口的高度）。

到目前为止，我只有一个访问图像的 .width DOM 元素并对其进行更改的小测试，但我似乎无法让它正常工作，并且有点超出我的深度，因为我正在学习 JavaScript在这里飞行！

我希望我已经提供了足够的细节来帮助你。您的回复将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:17:54.087

不要打扰。改用 CSS。将 img 的宽度设置为 100%，以便它始终缩放到容器的最大可用宽度，该宽度也不应设置，但您可以设置最大和最小宽度。这就是为什么当屏幕调整大小（或在不同设备上查看）时，浏览器会将图像缩放到尽可能大的原因。不需要 JS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:29:00.063

您想在调整窗口大小时重新计算图像的大小。为此，您需要将 JavaScript 放入窗口调整大小事件中

```
window.onresize = function(event) {
    ...
} 
```

在那里你可以重新计算高度并更新你的 CSS 样式。

# java - Android 4 上的默认浏览器从何而来？

> ID：12410468
> 
> 赞同：6
> 
> 时间：2012-09-13T16:08:31.343
> 
> 标签：java, android, browser, android-4.0-ice-cream-sandwich

问题：

Android 4 上的默认浏览器来自哪里？

用户代理字符串只包含 Safari，不包含 Chrome。

如果我进入 android-market，下载并安装 Chrome、Firefox 和 Opera Mobile，那么我的网站会在其中很好地显示。

它在 Safari、Internet Explorer (9+8) 和 iPad 上也能很好地显示（只有经过大量工作才能在 iPad 上）。

但它在 Android 4 默认浏览器中看起来很糟糕。更糟糕的是，我对此无能为力：
我无法在 android 设备上调试，我无法安装用于远程调试的 USB 驱动程序（我在公司笔记本电脑上没有管理员权限），在android模拟器是不切实际的，因为它太慢了，而且它不接受来自计算机键盘的输入，这意味着我必须使用鼠标并在这个可怕的键盘上用鼠标分别键入每个字符只是提示的冰山。

默认浏览器似乎也不包含任何类型的开发人员工具，我可以在其中查看样式或 JavaScript 脚本控制台。

我还没有找到任何类型的独立浏览器或模拟器，这样我就可以在 Windows 或 Linux 上本地运行那个可怕的东西，所以我实际上可以调试 LAYOUT（而不是 javascript）。

当我查看浏览器进程时，它说：

```
com.android.browser 
```

对我来说，这看起来像是一个 Java 命名空间。

这个可怕的东西是源自 Java 渲染引擎吗？
如果是，是哪一个，是否存在使用该引擎的 Java 浏览器我可以运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-30T15:18:41.807

每个版本的 Android 都有一个“android 浏览器”，它使用 WebKit 渲染引擎的一部分。此外，AOSP v4.4 (kitkat) 中的 Android 浏览器基于与 Chromium v​​30.0.0 相同的代码。使用 WebViews 的应用程序使用这个 Android 浏览器（不是用户的默认浏览器）。

![在此处输入图像描述](../Images/c4c8affe6f6549fa9799865c1400da0c.png)

[https://developer.chrome.com/multidevice/webview/overview](https://developer.chrome.com/multidevice/webview/overview) [http://decadecity.net/blog/2013/11/21/android-browser-versions](http://decadecity.net/blog/2013/11/21/android-browser-versions)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:30:52.113

默认的 Android 浏览器使用 WebKit 渲染引擎和 V8 JavaScript 引擎。

[https://android.stackexchange.com/questions/4271/android-browser](https://android.stackexchange.com/questions/4271/android-browser)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:49:28.717

我认为您的调试选项有限（或者我还没有找到一个很好的解决方案）。我发现的最好的方法是同时在您的设备/模拟器和您选择的 Chrome/浏览器中查看您的浏览器中的页面，并对不同之处和原因做出有根据的猜测，操作事物，刷新，重新开始.

为了让你的 Android 4.x 模拟器不至于太糟糕，你可以安装 Intel x86 System Image，然后使用它创建一个新的模拟器。如果您只使用 Eclipse：

1.  打开你的窗口 > Android SDK 管理器。
2.  在每个Android版本下找到“Intel x86 Atom System Image”（4.1和4.0.3，我认为还有一个2.3.3）
3.  复选框，安装软件包，同意条款，所有这些有趣的东西。

![在此处输入图像描述](../Images/cdc9ee8d5fe6822fd63282ba0b02ddc3.png)

# android - 如何获取在 Google Cloud Messaging 服务器中注册的设备列表

> ID：12410469
> 
> 赞同：0
> 
> 时间：2012-09-13T16:08:39.740
> 
> 标签：android, push-notification, google-cloud-messaging

阅读我的服务器的示例代码后：

```
// Replace with real BROWSER API key from Google APIs
$apiKey = "123456";

// Replace with real client registration IDs 
$registrationIDs = array( "123", "456" );

// Message to be sent
$message = "x";

// Set POST variables
$url = 'https://android.googleapis.com/gcm/send';

$fields = array(
             'registration_ids'  => $registrationIDs,
             'data'              => array( "message" => $message ),
              );

$headers = array( 
                 'Authorization: key=' . $apiKey,
                 'Content-Type: application/json'
             );

// Open connection
$ch = curl_init();

// Set the url, number of POST vars, POST data
curl_setopt( $ch, CURLOPT_URL, $url );

curl_setopt( $ch, CURLOPT_POST, true ); 
curl_setopt( $ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );

curl_setopt( $ch, CURLOPT_POSTFIELDS, json_encode( $fields ) );

// Execute post
$result = curl_exec($ch);

// Close connection
curl_close($ch); 
```

需要知道服务器的registration_ids才能推送信息。

如何从我的个人服务器获取 GCM 服务器中的注册设备列表（registration_ids）。

如何向 GCM 中注册的所有设备发送广播消息。

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T20:27:12.957

> 如何从我的个人服务器获取 GCM 服务器中的注册设备列表（registration_ids）

你没有。正如您所指出的，您必须通过一种或另一种方式（例如，Web 服务）将注册 ID 从设备发送到您的服务器。

> 如何向 GCM 中注册的所有设备发送广播消息

没有内置的方法可以做到这一点，除非您通过它们的注册 ID 向所有注册设备发送消息。

# sql-server - SQL Server 中的负数据库 ID

> ID：12410471
> 
> 赞同：8
> 
> 时间：2012-09-13T16:08:43.777
> 
> 标签：sql-server

SQL Server 中的数据库 ID 可以为负数吗？

我知道你总共可以拥有 32767（32 位和 64 位）[（最大容量 SQL Server）](http://msdn.microsoft.com/en-us/library/ms143432.aspx)

我知道前几个数据库 ID 是为 master、model、msdb 和 tempdb 保留的，而 32767 是隐藏的系统资源数据库。

我从未见过否定的数据库 ID，但我想确认这是不可能的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T16:17:40.780

简而言之，它们可以，但它们几乎永远不会。

在主数据库中，sysdatabases 表中的 id 列被定义为具有种子 1 和增量 1 的标识列。这意味着，默认情况下，SQL Server 将始终为您创建的任何数据库分配一个正 DBID。

但是，可以更改，您可以为标识列指定负种子和增量，因此您可以将 sysdatabases 表的标识列重置为 -1，-1 并且您创建的下一个数据库将具有 ID -1，然后 - 2 等等。-1 是一个完全有效的 16 位整数值，因此身份字段应该没有问题。您*可能*会遇到 SQL Server 通过检查最大 DBID 天真地检查其管理的 DB 数量的问题。我不希望 MSS 以如此愚蠢的方式进行检查，但是发生了奇怪的事情，而且我从未见过一个实例上有几十个数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:21:36.747

在实践中，如果您认为您可能会用完标识值而不是负值，您可能应该考虑使用 bigint 而不是 int。但是，当表格需要某些特殊情况时，我偶尔会看到它们使用它们。这些通常是使用 set identity_insert on 输入的。

例如，在我工作的一个地方，我们的系统用户的 ID 为负数。由于在我们的人员表中输入的数据由输入者标记，因此很容易将系统条目（来自导入等）从实际人员输入的条目中排除，这有助于研究数据问题。当然，我们可以轻松查看 id 是否为 13856799，但 < 0 更容易记住。

# c++ - 与 zheevr 的 OpenMP C++ 数据竞赛

> ID：12410472
> 
> 赞同：2
> 
> 时间：2012-09-13T16:08:48.867
> 
> 标签：c++, openmp, lapack

我正在尝试将 c++ 中的 for 循环与 openMP 并行化。我有许多需要用 zheevr 取幂的矩阵（Matrix 类）。该实现提供了数据竞赛。

并行化的 for 循环是

```
/* in main */
#pragma omp parallel for shared(Aexp_omp, A, Z, W) private(j) firstprivate(idt)
for (j=0; j< nMat; ++j) {
    Aexp_omp[j] = EigenMethod(A[j],-idt,&(Z[j]),W[j]);
} 
```

这里, `Aexp_omp`, `A`,`Z`都是类的数组`Matrix`。确切的行似乎是对 zheevr in 的第二次调用`EigenMethod`。当 #pragma omp critical 没有被注释掉时，代码会正确执行（但是在这里放置 pragma omp critical 似乎违背了并行化此代码的目的）。

我不明白数据竞争来自哪里，如果我没记错的话，循环中清除的所有变量都是线程私有的？

关于为什么会发生这种情况的任何见解？我是否错误地清除了`pragma omp parallel for`代码的一部分？

非常感谢您的帮助。

## 编辑：完整代码

为了提供所有信息，这里是完整的代码（有点长，我很抱歉）。它使用makefile在我的机器上编译

```
omp_matrix: omp_matrix.cpp
        g++ -fopenmp -lgsl -lgslcblas -llapack -lblas -lm -o omp_matrix omp_matrix.cpp 
```

由于我怀疑数据竞争，它在运行时会出现随机行为。代码必须是文件，一个带有 main（和一些额外的命名空间）和 Matrix 类的文件。

```
/* omp_matrix.cpp */
#include <iostream>
#include <omp.h>
#include <cstdio>
#include <ctime>
#include <string>
#include <cmath>
#include <vector>
#include <complex>
#include <limits>
#include <cstdlib>

const char Trans[]  = {'N','T','C'};
const char UpLo[]   = {'U','L'};
const char Jobz[]   = {'V','N'};
const char Range[]  = {'A','V','I'};
#ifdef __cplusplus
extern "C" {
#endif

void zgemm_(const char* TransA, const char* TransB, const size_t* M, const size_t* N, const size_t* K, const std::complex<double>* alpha, const std::complex<double>* A, const size_t* lda, const std::complex<double>* B, const size_t* ldb, const std::complex<double>* beta, std::complex<double>* C, size_t* ldc);
int zheevr_(const char* jobz, const char* range, const char* uplo, const size_t* n, std::complex<double>* a, size_t* lda, double* vl, double* vu, size_t* il, size_t* iu, double* abstol, size_t* m, double* w, std::complex<double>* z, size_t* ldz, int* isuppz, std::complex<double>* work, int* lwork, double* rwork, int* lrwork, int* iwork, int* liwork, int* info);

#ifdef __cplusplus
}
#endif

    #include "Matrix.hpp"

namespace MOs {
    //Identity Matrix
    template <class T> 
    inline void Identity(Matrix<T>& I){
    size_t dim = I.GetRows();
    if (dim != I.GetColumns())
            exit(1);
    for(size_t i=0; i<dim; i++)
        for(size_t j=0; j<dim; j++)
                I(i,j) = i == j ? T(1) : T(0);
    return; 
    }

    // The H.O. Annilation operator
    template <class T> 
    inline void Destroy(Matrix<T>& a){
            size_t dim = a.GetRows();
            if (dim != a.GetColumns())
                    exit(1);
            for(size_t i=0; i<dim; i++)
                    for(size_t j=0; j<dim; j++)
                            a(i,j) = j == i+1 ? std::sqrt(T(j)) : T(0); 
            return; 
    }

    //Take the Hermitian conjugate of a complex Matrix
    inline Matrix<std::complex<double> > Dagger(const Matrix<std::complex<double> >& A){
            size_t cols = A.GetColumns(), rows= A.GetRows();
            Matrix<std::complex<double> > temp(cols,rows);
            for (size_t i=0; i < rows; i++)
                    for(size_t j=0; j < cols; j++)
                            temp(j,i) = conj(A(i,j));
            return temp;
    }

    template <class T>
    inline Matrix<T> TensorProduct(const Matrix<T>& A, const Matrix<T>& B){
            size_t rows1 = A.GetRows(), rows2 = B.GetRows(), cols1 = A.GetColumns(), cols2 = B.GetColumns();
            size_t rows_new = rows1*rows2, cols_new = cols1*cols2, n, m;
            Matrix<T> temp(rows_new,cols_new);
            for(size_t i=0; i<rows1; i++)
                    for(size_t j=0; j<cols1; j++)
                            for(size_t p=0; p<rows2; p++)
                                    for(size_t q=0; q<cols2; q++){
                                            n = i*rows2+p;    
                                            m = j*cols2+q; //  0 (0 + 1)  + 1*dimb=2 + (0 + 1 )  (j*dimb+q)         
                                            temp(n,m) = A(i,j)*B(p,q);
                            }
                    return temp;
            }
}

Matrix<std::complex<double> > EigenMethod(const Matrix<std::complex<double> >& Ain,  std::complex<double> x, Matrix<std::complex<double> >* Z=NULL, double *W=NULL );

using namespace std;

int main(int argc, char const *argv[]) {
    // dim is the dimension of the system
    size_t  dimQ    = 2;
    size_t  dim = dimQ*dimQ*dimQ;

    // Define the matrices used to build the matrix to be exponentiated
    Matrix<complex<double> > o(dimQ,dimQ), od(dimQ,dimQ), nq(dimQ,dimQ);
    MOs::Destroy(o);
    od = MOs::Dagger(o); nq=od*o;
    Matrix<complex<double> > IdentQ(dimQ, dimQ), Hd(dim, dim);
    MOs::Identity(IdentQ);
    Hd = 0.170*MOs::TensorProduct(MOs::TensorProduct(od,IdentQ),o) + 0.124* MOs::TensorProduct(MOs::TensorProduct(IdentQ,od),o);

    complex<double> idt = complex<double>(0.0,0.2);                 // time unit multiplied by i

    size_t  nMat    = 2;
    double* c   = new double[nMat];
    c[0] = 0.134;
    c[1] = -0.326;

    // Decalre matrices and allocate memory for them
    Matrix<complex<double> >*   A    = new Matrix<complex<double> >[nMat];
    Matrix<complex<double> >*   Aexp     = new Matrix<complex<double> >[nMat];
    Matrix<complex<double> >*   Aexp_omp = new Matrix<complex<double> >[nMat];
    for (size_t k = 0; k < nMat; ++k)
            A[k] = c[k]*Hd;

    // METHOD 1: Serial. Exponentiate one matrix after another
    double start_s = omp_get_wtime();
    for (size_t k = 0; k < nMat; ++k)
            Aexp[k] = EigenMethod(A[k],-idt);
    double end_s = omp_get_wtime();

    cout << "Aexp[0] = \n" << Aexp[0] << endl;
    cout << "Aexp[1] = \n" << Aexp[1] << endl;

    // METHOD 2: Parallel. Exponentiate all matrices at the same time
    // THIS DOES NOT WORK. Data race condition in EigenMetod?
    Matrix<complex<double> >* Z = new Matrix<complex<double> >[nMat];
    double** W = new double*[nMat];
    for (size_t k = 0; k < nMat; ++k) {
            Z[k].initialize(dim,dim);
            W[k] = new double[dim];
    }

    size_t j;
    double start_p1 = omp_get_wtime( );
    #pragma omp parallel for shared(Aexp_omp,A,Z,W) private(j) firstprivate(idt)
    for (j=0; j< nMat; ++j) {
            Aexp_omp[j] = EigenMethod(A[j],-idt,&(Z[j]),W[j]);
    }
    double end_p1 = omp_get_wtime( );

    cout << "Done" << endl;

    cout << "Aexp_omp[0] = \n" << Aexp_omp[0] << endl;
    cout << "Aexp_omp[1] = \n" << Aexp_omp[1] << endl;

    cout << "Serial time: " << end_s - start_s << ", parallel time method 2: " << end_p1-start_p1 << endl;

    delete [] c;
    delete [] A;
    delete [] Aexp;
    delete [] Aexp_omp;

} /* end of int main */

Matrix<complex<double> > EigenMethod(const Matrix<complex<double> >& A, complex<double> x, Matrix<complex<double> >* Z, double *W){ 

    bool returnZ(Z!=NULL), returnW(W!=NULL);                            // flags to see if the function received valid Z and W adresses

    //if (MOs::IsHermitian(A)==0) UFs::MyError("Routine ExpM::EigenMethod: The input Matrix is not Hermitian.");
    size_t N = A.GetRows(), LDA=A.GetLD(), IL, IU, M, LDZ=N;
    double VL, VU, ABSTOL=numeric_limits<double>::min(); 
    complex<double>*    WORK;
    double*         RWORK;
    int*            IWORK;

    //finding the optimal work sizes
    int LWORK=-1, LRWORK=-1, LIWORK=-1, ok=0;
    WORK    = new std::complex<double>[1];
    RWORK   = new double[1];
    IWORK   = new int[1];

    // ZHEEV computes all eigenvalues and, optionally, eigenvectors of a complex Hermitian Matrix A.
    // Jobz[0] = V i.e. compute eigenvalues and eigen-vectors, Range[0] = A i.e. all eigen values will be found, UpLo[1] = L i.e. lower triangle of matrix is stored
    zheevr_ (&Jobz[0],&Range[0],&UpLo[1],&N,NULL,&LDA,&VL,&VU,&IL,&IU,&ABSTOL,&M,NULL,NULL,&LDZ,NULL,WORK,&LWORK,RWORK,&LRWORK,IWORK,&LIWORK,&ok);

    //Setting the optimal workspace
    LWORK   = (int)real(WORK[0]);
    LRWORK  = (int)RWORK[0];
    LIWORK  = IWORK[0];

    delete [] WORK; 
    delete [] RWORK;
    delete [] IWORK;

    //Running the algorithim 
    if (!returnZ) Z = new Matrix<std::complex<double> >(LDZ,LDZ);
    if (!returnW) W = new double[LDA];

    Matrix<std::complex<double> > temp(A);

    int *ISUPPZ;
    ISUPPZ  = new int[2*N]; 
    WORK    = new std::complex<double>[LWORK];
    RWORK   = new double[LRWORK];
    IWORK   = new int[LIWORK];
    //#pragma omp critical
    //{
    // THIS LINE IS DOING SOMETHING WRONG
    zheevr_ (&Jobz[0],&Range[0],&UpLo[1],&N,temp.GetMat(),&LDA,&VL,&VU,&IL,&IU,&ABSTOL,&M,W,Z->GetMat(),&LDZ,ISUPPZ,WORK,&LWORK,RWORK,&LRWORK,IWORK,&LIWORK,&ok);   
    //}

    if (ok!=0) {
        cerr << "Routine EigenMethod: An error occured in geting the diagonalization of A" << endl;
        exit(1);
    }

    //Getting the Diag*Dagger(Z), this is where the exponentiation is done using the eigenvalues
    for (size_t i=0; i < N; i++)
        for(size_t j=0; j < N; j++)
            temp(i,j) = exp(x*W[i])*conj((*Z)(j,i));

    temp = (*Z)*temp;   

    if(!returnW) delete [] W; 
    if(!returnZ) delete Z; 

    delete [] ISUPPZ;
    delete [] WORK;
    delete [] RWORK;
    delete [] IWORK;

    return temp;
} 
```

接下来是类矩阵

```
#ifndef Matrix_h
#define Matrix_h

enum OutputStyle {Column, List, Array};

template <class T>
class Matrix {  
//friend functions get to use the private varibles of the class as well as have different classes as inputs
template <class S>
friend std::ostream& operator << (std::ostream& output, const Matrix<S>& A){
    for (size_t i=0; i<A.rows_; i++){
        for (size_t j=0; j<A.cols_; j++){
            output << A.mat_[j*A.rows_ +i] << "\t";
        }
        output << std::endl;
    }
    return output;
}

// overloads beta*A
template <class S1, class S2>
friend Matrix<S1> operator*(const S2& beta, const Matrix<S1>& A){
    size_t rows= A.rows_, cols = A.cols_;
    Matrix<S1> temp(rows,cols);
    for (size_t i=0; i < rows; i++)
        for(size_t j=0; j < cols; j++)
            temp(i,j) = beta*A(i,j);
    return temp;
}

friend Matrix<std::complex<double> > operator*(const Matrix<std::complex<double> >& A, const Matrix<std::complex<double> >& B) {
    static Matrix<std::complex<double> > C;
    C.initialize(A.rows_,B.cols_);
    std::complex<double> alpha =1.0, beta =0.0;
    zgemm_(&Trans[0], &Trans[0], &A.rows_, &B.cols_, &A.cols_, &alpha, A.mat_, &A.LD_, B.mat_, &B.LD_, &beta, C.mat_, &C.LD_);
    return C;
}

public:
//Construtors
Matrix() : rows_(0), cols_(0), size_(0), LD_(0), outputstyle_(Array){ mat_=0;}
Matrix(size_t rows, size_t cols) : rows_(rows), cols_(cols), size_(rows*cols), LD_(rows), outputstyle_(Array), mat_(new T [size_]){}

Matrix(const Matrix<T>& rhs) : rows_(rhs.rows_), cols_(rhs.cols_), size_(rhs.size_), LD_(rows_), outputstyle_(rhs.outputstyle_), mat_(new T [size_]) {
for(size_t p = 0; p < size_; p++)
    mat_[p] = rhs.mat_[p];
}

//Initialize an empty Matrix() to Matrix(size_t  rows, size_t cols)
inline void initialize(size_t  rows, size_t cols) {
    if (rows_ != rows || cols_ != cols ) {
        if (mat_ != 0) delete [] (mat_);
        rows_   = rows;
        cols_   = cols;
        size_   = rows_*cols_;
        LD_ = rows;
        mat_    = new T[size_];
    }
}

//Destructor
virtual ~Matrix()   {if (mat_ != 0) delete[] (mat_);}

//Assignment operator
inline Matrix<T>& operator=(const Matrix<T>& rhs){
    if (rows_ != rhs.rows_ || cols_ != rhs.cols_ ) {
        if (mat_ != 0) delete [] (mat_);
        rows_=rhs.rows_;
        cols_=rhs.cols_;
        size_=rows_*cols_;
        LD_=rhs.LD_;
        mat_= new T[size_];
    }
    for (size_t p=0; p < size_; p++)
        mat_[p] = T(rhs.mat_[p]);
    return *this;
}

inline T& operator()(size_t i, size_t j){
    if (i >= rows_ || j >= cols_) exit(1);
    return mat_[j*rows_+i];
}

inline T operator()(size_t i, size_t j) const{
    if (i >= rows_ || j >= cols_) exit(1);
    return mat_[j*rows_+i];
}

//overloading functions. 
inline Matrix<T> operator+(const Matrix<T>& A){
    if(rows_ != A.rows_ || cols_ != A.cols_)
        exit(1);
    Matrix<T> temp(rows_,cols_);
    for (unsigned int p=0; p < size_; p++)      
        temp.mat_[p] = mat_[p] + A.mat_[p];
    return temp;
}

//Member Functions
inline size_t GetColumns() const            { return cols_; }
inline size_t GetRows() const               { return rows_; }
inline size_t GetLD() const             { return LD_;   }
inline size_t size() const              { return size_; }
T* GetMat() const                   { return mat_;  }

protected:
size_t rows_, cols_, size_, LD_;
//rows_ and cols_ are the rows and columns of the Matrix
//size_ = rows*colums dimensions of the vector representation   
//LD is the leading dimeonsion and for Column major order is in general eqaul to rows
enum OutputStyle outputstyle_;

T * mat_;

};
#endif /* Matrix_h */ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:42:10.997

您并没有真正提供足够的代码（也没有实际症状）来为您调试。没有它，我只能猜测`zheerv_()`使用全局变量（直接或间接）的实现。

除了我在评论中已经提到的代码气味之外，变量还有一个问题`idt`：该函数`EigenMethod()`通过引用获取它，但是您传递了一个临时 ( `-idt`) - 我很惊讶编译。我认为你并没有真正改变它的值 ( `x`) inside `EigenMethod()`，所以你应该要么接受一个常量引用，要么（最好）只是一个值。

顺便说一句，不需要在并行循环中声明共享变量，只需说

```
 #pragma omp parallel for
 for(int j=0; j<nMat ;++j) { /* ... */ } 
```

并且在循环外声明的所有变量默认情况下都是共享的，并且永远不应声明循环变量（私有似乎无论如何都不是正确的选择）。

# php - PHP 邮件未发送，尽管响应积极

> ID：12410473
> 
> 赞同：0
> 
> 时间：2012-09-13T16:08:53.777
> 
> 标签：php

刚回到我放弃了一段时间的项目。我在页面（debatecalendar.com）的顶部有一个简单的表格，它出现在按钮上。

我填写了表格，收到了成功通知，但似乎没有收到任何电子邮件。不知道如何修复它。任何帮助表示赞赏！

主页上的代码是

```
// Init the form once the document is ready
jQuery( init );

// Initialize the form

function init() {

  // Hide the form initially.
  // Make submitForm() the forms submit handler.
  // Position the form so it sits in the centre of the browser window.
  jQuery('#contactForm').hide().submit( submitForm ).addClass( 'positioned' );

  // When the "Send us an email" link is clicked:
  // 1\. Fade the content out
  // 2\. Display the form
  // 3\. Move focus to the first field
  // 4\. Prevent the link being followed

  jQuery('a[href="#contactForm"]').click( function() {
    jQuery('#content').fadeTo( 'slow', .2 );
    jQuery('#contactForm').fadeIn( 'slow', function() {
      jQuery('#senderName').focus();
    } )

    return false;
  } );

  // When the "Cancel" button is clicked, close the form
  jQuery('#cancel').click( function() {
    jQuery('#contactForm').fadeOut();
    jQuery('#content').fadeTo( 'slow', 1 );
  } ); 

  // When the "Escape" key is pressed, close the form
  jQuery('#contactForm').keydown( function( event ) {
    if ( event.which == 27 ) {
      jQuery('#contactForm').fadeOut();
      jQuery('#content').fadeTo( 'slow', 1 );
    }
  } );

}

// Submit the form via Ajax

function submitForm() {
  var contactForm = jQuery(this);

  // Are all the fields filled in?

  if ( !jQuery('#senderName').val() || !jQuery('#senderEmail').val() || !jQuery('#message').val() ) {

    // No; display a warning message and return to the form
    jQuery('#incompleteMessage').fadeIn().delay(messageDelay).fadeOut();
    contactForm.fadeOut().delay(messageDelay).fadeIn();

  } else {

    // Yes; submit the form to the PHP script via Ajax

    jQuery('#sendingMessage').fadeIn();
    contactForm.fadeOut();

    jQuery.ajax( {
      url: contactForm.attr( 'action' ) + "?ajax=true",
      type: contactForm.attr( 'method' ),
      data: contactForm.serialize(),
      success: submitFinished
    } );
  }

  // Prevent the default form submission occurring
  return false;
}

// Handle the Ajax response

function submitFinished( response ) {
  response = jQuery.trim( response );
  jQuery('#sendingMessage').fadeOut();

  if ( response == "success" ) {

    // Form submitted successfully:
    // 1\. Display the success message
    // 2\. Clear the form fields
    // 3\. Fade the content back in

    jQuery('#successMessage').fadeIn().delay(messageDelay).fadeOut();
    jQuery('#senderName').val( "" );
    jQuery('#senderEmail').val( "" );
    jQuery('#message').val( "" );

    jQuery('#content').delay(messageDelay+500).fadeTo( 'slow', 1 );

  } else {

    // Form submission failed: Display the failure message,
    // then redisplay the form
    jQuery('#failureMessage').fadeIn().delay(messageDelay).fadeOut();
    jQuery('#contactForm').delay(messageDelay+500).fadeIn();
  }
} 
```

然后在 processForm.php 中处理表单，它读取

```
<?php

// Define some constants
define( "RECIPIENT_NAME", "Debate Calendar" );
define( "RECIPIENT_EMAIL", "events@debatecalendar.com" );
define( "EMAIL_SUBJECT", "Feedback or Add Event" );

// Read the form values
$success = false;
$senderName = isset( $_POST['senderName'] ) ? preg_replace( "/[^\.\-\' a-zA-Z0-9]/", "", $_POST['senderName'] ) : "";
$senderEmail = isset( $_POST['senderEmail'] ) ? preg_replace( "/[^\.\-\_\@a-zA-Z0-9]/", "", $_POST['senderEmail'] ) : "";
$message = isset( $_POST['message'] ) ? preg_replace( "/(From:|To:|BCC:|CC:|Subject:|Content-Type:)/", "", $_POST['message'] ) : "";

// If all values exist, send the email
if ( $senderName && $senderEmail && $message ) {
  $recipient = RECIPIENT_NAME . " <" . RECIPIENT_EMAIL . ">";
  $headers = "From: " . $senderName . " <" . $senderEmail . ">";
  $success = mail( $recipient, EMAIL_SUBJECT, $message, $headers );
}

// Return an appropriate response to the browser
if ( isset($_GET["ajax"]) ) {
  echo $success ? "success" : "error";
} else {
?>
<html>
  <head>
    <title>Thanks!</title>
  </head>
  <body>
  <?php if ( $success ) echo "<p>Thanks for sending your message! We'll get back to you shortly.</p>" ?>
  <?php if ( !$success ) echo "<p>There was a problem sending your message. Please try again.</p>" ?>
  <p>Click your browser's Back button to return to the page.</p>
  </body>
</html>
<?php
}
?> 
```

所有这些代码都是从各种在线示例中混合在一起的，如果能帮助我清理混乱，我们将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:14:11.390

If you are using Windows (From [http://php.net/mail](http://php.net/mail)):

Note:

The Windows implementation of mail() differs in many ways from the Unix implementation. First, it doesn't use a local binary for composing messages but only operates on direct sockets which means a MTA is needed listening on a network socket (which can either on the localhost or a remote machine).

Second, the custom headers like From:, Cc:, Bcc: and Date: are not interpreted by the MTA in the first place, but are parsed by PHP.

As such, the to parameter should not be an address in the form of "Something ". The mail command may not parse this properly while talking with the MTA

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T22:37:34.787

好的！问题解决了

在这里找到答案： [http ://www.therevcounter.com/technology-computing-gadgetry/58477-php-mail-fails-send-domain-email.html](http://www.therevcounter.com/technology-computing-gadgetry/58477-php-mail-fails-send-domain-email.html)

似乎因为电子邮件地址与域相同，它试图在本地处理电子邮件。与链接帖子完全相同的问题。

谢谢大家

# spring-mvc - Spring MVC：发布后执行会话数据的合并

> ID：12410474
> 
> 赞同：1
> 
> 时间：2012-09-13T16:08:54.343
> 
> 标签：spring-mvc

我们看到了 Spring MVC 的一个问题/特性，在我们的客户端 JSP 中删除的条目在我们的请求到达控制器时重新出现。

以下是我们在控制器中的 GET 请求的片段：

```
AssignmentRulesFormDTO assignmentRulesFormDTO = ...
    model.addAttribute("assignmentRulesForm", assignmentRulesFormDTO);
    return new ModelAndView(getPageName(), model); 
```

因此，我们的 AssignmentRulesFormDTO 包含许多 Rule 对象，在我们的客户端，其中一个对象被删除。我已经通过 Fiddler 确认删除的对象没有传递给服务器。然而，当它到达我们控制器的保存方法时，对象又重新出现了。这是 save 方法的方法签名：

```
public ModelAndView saveRuleAttributesAndRules(@ModelAttribute("assignmentRulesForm")
AssignmentRulesFormDTO assignmentRulesForm, BindingResult bindingResult, HttpSession session, Principal principal,
    ModelMap model) { 
```

所以看起来好像 Spring 在它到达我们的控制器之前正在执行某种合并。

因此，我想知道这种现象叫什么，以及如何为这个特定的会话属性关闭它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:24:14.277

假设第二个片段是一种`@RequestMapping`方法，我认为您不想`AssignmentRulesFormDTO`用`@ModelAttributes`注释标记。通过在方法参数上使用这个注解，[你](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-ann-modelattrib-method-args)[告诉 Spring 去实例`AssignmentRulesFormDTO`](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-ann-modelattrib-method-args)化`@ModelAttribute("assignmentRulesForm")`.

因此，Spring 在分派给您的`@RequestMapping`方法来处理时所做的`POST`是：

1.  找到合适的`@RequestMapping`方法
2.  检查每个方法参数以查看是否存在所需的数据
3.  如果`@ModelAttribute`找到一个参数并且该属性在模型中尚不存在，则在控制器中找到填充该参数的方法`@ModelAttribute`
4.  执行3中找到的方法
5.  最后执行`@RequestMapping`方法

`@ModelAttribute`因此，如果您的目标是*仅*`AssignmentRulesFormDTO`填充请求正文，则听起来您不应该注释参数。相反，您可能想要[使用](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-ann-requestbody).*[`@RequestBody`](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-ann-requestbody)*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:22:10.763

我的控制器带有注释`@SessionAttributes`，似乎是导致问题的原因。因此，一旦我删除了这个注释，就会在提交保存操作时创建一个全新的 AssignmentRulesFormDTO。`@SessionAttributes`似乎正在将请求中添加的数据合并到现有的会话属性中，因此出现上述问题*

# sql - 在 volatile 表上设置主索引的问题

> ID：12410475
> 
> 赞同：0
> 
> 时间：2012-09-13T16:09:02.830
> 
> 标签：sql, teradata

我有以下引用临时表的查询，我在设置主索引 (i_sys_clm) 时遇到问题

我收到错误：期待 tab2 和“。”之间的东西。如果我只是在提交保留行时使用数据主索引（i_sys_clm）；我收到一个错误，说它不明确。

```
 create volatile table Fin as (
 select tab1.*
 ,tab2.i_sys_clm
 ,tab2.c_sta_clm as "new_status"
 ,tab2.whse_curr_row_ind
 ,tab2.whse_load_ts
 ,(case when tab2.c_sta_clm  is null then 'U' else tab1.c_sta_clm end) bom_status  
 ,tab2.c_sta_clm eom_status

 from tab1
 left outer join tab2
 on tab1.i_sys_clm = tab2.i_sys_clm
 ) with data primary index (tab2.i_sys_clm)  on commit preserve rows; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T22:17:17.880

创建索引时，索引列名是指正在创建的新表，而不是源表。`tab2.i_sys_clm`在语句中添加您的 index: 别名`SELECT`，然后在创建索引时引用该别名。例如：

```
 create volatile table Fin as (
 select tab1.*
 ,tab2.i_sys_clm as "i_sys_clm_2"
 ,tab2.c_sta_clm as "new_status"
 ,tab2.whse_curr_row_ind
 ,tab2.whse_load_ts
 ,(case when tab2.c_sta_clm  is null then 'U' else tab1.c_sta_clm end) bom_status  
 ,tab2.c_sta_clm eom_status

 from tab1
 left outer join tab2
 on tab1.i_sys_clm = tab2.i_sys_clm
 ) with data primary index (i_sys_clm_2)  on commit preserve rows; 
```

# android - 文件复制后显示 Android Toast 消息

> ID：12410478
> 
> 赞同：-3
> 
> 时间：2012-09-13T16:09:09.313
> 
> 标签：android, toast

我对 Android 开发相当陌生，所以我想我会从一个基本的应用程序开始。当按下按钮时，它会将文件复制到代码中写入的位置（请参阅下面的代码）。当我按下安装按钮并将文件复制到其位置时，我想要一条 toast 消息显示“成功安装或复制文件时出错”。我将如何实现这一点？

```
public class TrialActivity extends Activity {

    private ProgressDialog progressDialog;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        runDialog(5);
    }

    private void runDialog(final int seconds)
        {
            progressDialog = ProgressDialog.show(this, "Please Wait...", "unpacking patch in progress");

            new Thread(new Runnable(){
                    public void run(){
                        try {
                            Thread.sleep(seconds * 1000);
                            progressDialog.dismiss();
                        } catch (InterruptedException e) {
                            e.printStackTrace();
                        }
                    }
                }).start();

            ((Button)findViewById(R.id.button1)).setOnClickListener(new View.OnClickListener()
                {
                    public void onClick(View paramView)
                        {

                        }

                        {

                            InputStream in = null;
                            OutputStream out = null;
                            String filename="savegame.bin";
                            try {

                                in = getResources().openRawResource(R.raw.savegame);
                                out = new FileOutputStream("/sdcard/Android/data/files/" + filename);
                                copyFile(in, out);
                                in.close();
                                in = null;
                                out.flush();
                                out.close();
                                out = null;
                            } catch(Exception e) {
                                Log.e("tag", e.getMessage());
                                Message message = Message.obtain();
                                message.what = 1;  // success message
                                mHandler.sendMessage(message);

                            }

                        }
                    private void copyFile(InputStream in, OutputStream out) throws IOException {
                        byte[] buffer = new byte[1024];
                        int read;
                        while((read = in.read(buffer)) != -1){
                            out.write(buffer, 0, read);

                        }
                    }
                }
                );
        }

    Handler mHandler = new Handler() {

            public void handleMessage( Message msg )
                {
                    Toast toast;
                    switch(msg.what)
                    {
                    case 1: // for success
                        toast = Toast.makeText(getBaseContext(), "Created By MRxBIGxSTUFF", Toast.LENGTH_SHORT);
                        toast.show();
                        break;
                    case 0: // for Error
                        toast = Toast.makeText(getBaseContext(), "Error... Application has shutdown", Toast.LENGTH_LONG);
                        toast.show();
                        break;
                    }
                }
        };
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:15:23.667

要展示 Toast，您必须自己制作并展示它。像这样：

```
CharSequence text = "Hello toast!";
Toast.makeText(context, text, Toast.LENGTH_SHORT).show(); 
```

[在此处](http://developer.android.com/guide/topics/ui/notifiers/toasts.html)阅读有关 Toast的更多信息。

而且你的代码是错误的，因为你硬编码`/sdcard/`是**错误**的。使用[getExternalStorageDirectory()](http://developer.android.com/reference/android/os/Environment.html#getExternalStorageDirectory%28%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:18:53.153

我建议使用 AsyncTask 在后台运行您的进程。这不会冻结复制文件大小变大的用户界面事件。

您可以在加载操作时显示进度条。

```
public class CopyFiles extends AsyncTask<Void, Void, Void>
{  
@Override
protected void onPreExecute()
{  
    super.onPreExecute();
    dialog.setMessage("Please wait...");
    dialog.setCancelable(false);
    dialog.show();

} 
@Override 
protected void onProgressUpdate(Void... values) {
    super.onProgressUpdate(values);
    // Things to be done while execution of long running operation is in progress. For example updating ProgessDialog
 }

@Override 
protected void onPostExecute(Void result)

{ 
      //Post Execute
       dialog.cancel();
      //Use toast here to toast the message
      //Check condition toast message
      Toast.makeText(getBaseContext(), "Created By MRxBIGxSTUFF", Toast.LENGTH_SHORT);
}
@Override
protected Void doInBackground(Void... params) {

  // Your operation..Dont Edit Any Views here

    return null;
}
} 
```

我认为这是处理文件的最佳方式之一（即复制、下载等）

希望能帮助到你

# c# - 如何在 SharePoint 2010 中获取服务应用程序权限

> ID：12410481
> 
> 赞同：3
> 
> 时间：2012-09-13T16:09:14.780
> 
> 标签：c#, sharepoint, sharepoint-2010, user-permissions

在 SharePoint 2010 中读取特定服务应用程序的帐户权限的最佳/最简单方法是什么？目前我一直在搞乱：

```
 var solution = SPFarm.Local.Solutions["Service App Name.wsp"];
    var solutionPermissions = solution. //trying different options here 
```

我一直在寻找可以遵循“解决方案”的不同选项。但到目前为止，我很茫然。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:06:06.353

您可以通过 PowerShell 尝试此操作。您可以从您的代码运行脚本并尝试以这种方式与权限进行交互。

看到这个：http: [//blogs.technet.com/b/spweb/archive/2011/04/13/configure-service-application-permissions-in-sharepoint-2010-using-powershell.aspx](http://blogs.technet.com/b/spweb/archive/2011/04/13/configure-service-application-permissions-in-sharepoint-2010-using-powershell.aspx)

以及如何从您的代码运行 PowerShell：http: [//www.codeproject.com/Articles/18229/How-to-run-PowerShell-scripts-from-C](http://www.codeproject.com/Articles/18229/How-to-run-PowerShell-scripts-from-C)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T14:43:47.733

[如何检查服务应用程序的权限](https://stackoverflow.com/questions/12462209/how-to-check-the-permissions-of-a-service-application)？可能对您有用：

```
foreach (SPService service in SPFarm.Local.Services)
{
    if (service.Name.Equals("ServiceName"))
    {
        foreach (SPServiceApplication serviceApp in service.Applications)
        {
            //This gets the service app administrators
            SPCentralAdministrationSecurity serviceAppSecurity = serviceApp.GetAdministrationAccessControl();
            SPAcl<SPCentralAdministrationRights> adminAcl = serviceAppSecurity.ToAcl();

            foreach (SPAce<SPCentralAdministrationRights> rights in adminAcl)
            {
                //Handle users
            }

            //This gets the users that can invoke the service app
            SPIisWebServiceApplication webServiceApp = (SPIisWebServiceApplication) app;
            SPIisWebServiceApplicationSecurity webServiceAppSecurity = webServiceApp.GetAccessControl();
            SPAcl<SPIisWebServiceApplicationRights> invokerAcl = webServiceAppSecurity.ToAcl();

            foreach (SPAce<SPIisWebServiceApplicationRights> rights in invokerAcl)
            {
                //Handle users
            }
        }
    }
} 
```

# php - CodeIgniter + MongoDB 更新

> ID：12410483
> 
> 赞同：0
> 
> 时间：2012-09-13T16:09:23.760
> 
> 标签：php, codeigniter, mongodb, activerecord

我正在尝试使用嵌套在集合中的库[codeigniter-library-mongodb 。](https://github.com/alexbilbie/codeigniter-mongodb-library)但是我无法进行更新...

要查询我正在使用以下代码：

```
getFacebookUser function ($ id ='') {
   return $ this-> mongo_db-> get_where ('users', array ('facebook.id' => $ id));
} 
```

插入：

```
createFacebookUser function ($ id ='', $ acess_token ='') {
   $user = array (
     'facebook' => array (
       'id' => $ id,
       'acess_token' => $ acess_token
     )
   );
   $ this-> mongo_db-> insert ('users', $ user);
} 
```

我尝试使用以下代码：

```
updateFacebookUser function ($ id ='', $ acess_token ='') {
    $ this-> mongo_db-> update ('users', array ('facebook.acess_token' => $ acess_token), array ('facebook.id' => $ id));
} 
```

但我收到以下消息：

Mongo 集合中没有要更新的内容或更新不是数组

我使用的结构如下：

```
user {
     name,
     {facebook
         id,
         acess_token
     }
     {twitter
        id,
        acess_token
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:00:26.007

这可能是一个错字，但是当您的架构说它被称为“用户”时，您似乎正在尝试更新“用户”集合。

# ruby-on-rails - Prawn pdf嵌套表 - 找不到示例

> ID：12410490
> 
> 赞同：4
> 
> 时间：2012-09-13T16:09:59.240
> 
> 标签：ruby-on-rails, ruby, pdf-generation, prawn

我需要在大虾pdf中生成一个带有嵌套表的文档。

[这个堆栈溢出问题](https://stackoverflow.com/questions/2379124/prawn-pdf-i-need-to-generate-nested-tables)的最新答案似乎表明我可以这样做：

```
(Prawn::Document.generate("subtable.pdf") do |pdf|
  subtable = pdf.make_table([["sub"],["table"]])
  pdf.table([[subtable,"original"]])
end 
```

不幸的是，这样做会给我以下错误：

```
undefined method `size=' for #<Prawn::Table::Cell::Subtable:0xad3f1e4> 
```

所以检查我可以看到的文档：“您可以使用 Prawn::Document#make_table 创建一个用作子表的表，而无需立即绘制它。请参阅examples/table/bill.rb 了解子表的一些复杂使用。” [http ://prawn.majesticseaacreature.com/docs/0.11.1/Prawn/Table.html](http://prawn.majesticseacreature.com/docs/0.11.1/Prawn/Table.html)

我在哪里可以看到这个例子/表/bill.rb？我已经克隆了 github 存储库，搜索了网站和手册，但在任何地方都找不到这些示例！

我知道我错过了一些愚蠢的东西。有谁知道如何在虾 pdf 中正确嵌套表格和/或示例文件所在的位置？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T05:02:40.900

做：

大虾的宝石

这会给你虾宝石的位置。它包括示例目录。你可以在那里找到 table/bill.rb。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-22T04:28:59.580

我建议看一下[自我记录手册](http://prawn.majesticseacreature.com/manual.pdf)向下滚动（或使用 ctrl-f）转到“content_and_subtables”，您可以看到它们是如何使用的。

如果您仍然遇到问题，请发布您的错误消息的完整跟踪以及您正在使用的代码示例。通过这种方式，我们可以调试您遇到的问题，并查看您的代码中是否存在问题或其他问题。

# java - 使用 ANTLR 解析日志文件

> ID：12410496
> 
> 赞同：1
> 
> 时间：2012-09-13T16:10:40.943
> 
> 标签：java, parsing, logging, antlr, antlr3

我需要用 ANTLR 解析 Weblogic 日志文件。这是示例：

```
Tue Aug 28 09:39:09 MSD 2012 [test] [[ACTIVE] ExecuteThread: '0' for queue: 'weblogic.kernel.Default (self-tuning)'] Alert - There is no user password credential mapper provider configured in your security realm. Oracle Service Bus service account management will be disabled. Configure a user password credential mapper provider if you need OSB service account support.

Sun Sep 02 23:13:00 MSD 2012 [test] [[ACTIVE] ExecuteThread: '5' for queue: 'weblogic.kernel.Default (self-tuning)'] Warning - Timer (Checkpoint) has been triggered with a tick (205 873) that is less than or equal to the last tick that was received (205 873). This could happen in a cluster due to clock synchronization with the timer authority. The current trigger will be ignored, and operation will be skipped.
Mon Sep 03 10:35:54 MSD 2012 [test] [[ACTIVE] ExecuteThread: '19' for queue: 'weblogic.kernel.Default (self-tuning)'] Info - 
 [OSB Tracing] Inbound request was received. 

 Service Ref = Some/URL
 URI = Another/URL
 Message ID = u-u-i-d
 Request metadata =
    <xml-fragment>
      <tran:headers xsi:type="http:HttpRequestHeaders" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <http:Accept-Encoding>gzip, deflate,gzip, deflate</http:Accept-Encoding>
        <http:Connection>Keep-Alive</http:Connection>
        <http:Content-Length>666</http:Content-Length>
        <http:Content-Type>text/xml; charset=utf-8</http:Content-Type>
        <http:Host>some.host.name</http:Host>
        <http:SOAPAction>""</http:SOAPAction>
      </tran:headers>
      <tran:encoding xmlns:tran="http://www.bea.com/wli/sb/transports">utf-8</tran:encoding>
      <http:client-host xmlns:http="http://www.bea.com/wli/sb/transports/http">1.2.3.4</http:client-host>
      <http:client-address xmlns:http="http://www.bea.com/wli/sb/transports/http">1.2.3.4</http:client-address>
      <http:http-method xmlns:http="http://www.bea.com/wli/sb/transports/http">POST</http:http-method>
    </xml-fragment>
 Payload =  
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><XMLHere/></s:Envelope> 
```

我对日志的这一部分感兴趣，必须忽略其他所有内容（应解析日期、服务参考值和信封 XML）：

```
Sun Sep 02 23:13:00 MSD 2012 [test] [[ACTIVE] ExecuteThread: '5' for queue: 'weblogic.kernel.Default (self-tuning)'] Warning - Timer (Checkpoint) has been triggered with a tick (205 873) that is less than or equal to the last tick that was received (205 873). This could happen in a cluster due to clock synchronization with the timer authority. The current trigger will be ignored, and operation will be skipped.
    Mon Sep 03 10:35:54 MSD 2012 [test] [[ACTIVE] ExecuteThread: '19' for queue: 'weblogic.kernel.Default (self-tuning)'] Info - 
     [OSB Tracing] Inbound request was received. 

     Service Ref = Some/URL
     URI = Another/URL
     Message ID = u-u-i-d
     Request metadata =
        <xml-fragment>
          <tran:headers xsi:type="http:HttpRequestHeaders" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
            <http:Accept-Encoding>gzip, deflate,gzip, deflate</http:Accept-Encoding>
            <http:Connection>Keep-Alive</http:Connection>
            <http:Content-Length>666</http:Content-Length>
            <http:Content-Type>text/xml; charset=utf-8</http:Content-Type>
            <http:Host>some.host.name</http:Host>
            <http:SOAPAction>""</http:SOAPAction>
          </tran:headers>
          <tran:encoding xmlns:tran="http://www.bea.com/wli/sb/transports">utf-8</tran:encoding>
          <http:client-host xmlns:http="http://www.bea.com/wli/sb/transports/http">1.2.3.4</http:client-host>
          <http:client-address xmlns:http="http://www.bea.com/wli/sb/transports/http">1.2.3.4</http:client-address>
          <http:http-method xmlns:http="http://www.bea.com/wli/sb/transports/http">POST</http:http-method>
        </xml-fragment>
     Payload =  
    <s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><XMLHere/></s:Envelope> 
```

这是我的词法分析器：

```
lexer grammar LogLexer;

options {filter=true;}

 /*------------------------------------------------------------------
 * LEXER RULES
 *------------------------------------------------------------------*/
LOGDATE : DAY ' ' MONTH ' ' NUMDAY ' ' NUMTIME ' ' TIMEZONE ' ' NUMYEAR;

METAINFO : '[' .* ']' ' [[' .* ']' .* ']' .* '-' .* '[OSB Tracing] Inbound request was received.';

SERVICE_REF : 'Service Ref = ';

URI : (SYMBOL | '/')+;

ENVELOPE_TAG : '<' ENVELOPE_TAGNAME .* '>' .* '</' ENVELOPE_TAGNAME '>';

fragment
ENVELOPE_TAGNAME : SYMBOL+ ':Envelope';

fragment
NUMTIME : NUM NUM ':' NUM NUM ':' NUM NUM;

fragment
TIMEZONE : SYMBOL SYMBOL SYMBOL;

fragment
DAY : 'Sun' | 'Mon' | 'Tue' | 'Wed' | 'Fri' | 'Sat';

fragment
MONTH :  'Sep' | 'Oct' | 'Nov' | 'Dec' | 'Feb' | 'Mar' | 'May' | 'Apr' | 'Jun' | 'Jul' | 'Aug';

fragment
NUMYEAR : NUM NUM NUM NUM;

fragment
NUMDAY : NUM NUM;

fragment
NUM : '0'..'9';

fragment
SYMBOL : ('a'..'z' | 'A'..'Z'); 
```

这是解析器（尚未完成）：

```
grammar LogParser;

options {
tokenVocab = OSBLogLexer;
}

@header {
    import java.util.List;
    import java.util.ArrayList;
}

parse 
    returns [List<List<String>> entries] 
    @init {
        $entries = new ArrayList<List<String>>();
    }
    : requestLogEntry+
    {
        $entries.add($requestLogEntry.logEntry);
    };

requestLogEntry 
    returns [List<String> logEntry]
    @init {
        $logEntry = new ArrayList<String>();
    }
    : LOGDATE METAINFO .* serviceRef .* ENVELOPE_TAG
    {
        $logEntry.add($LOGDATE.getText());
        $logEntry.add($serviceRef.serviceURI);
        $logEntry.add($ENVELOPE_TAG.getText());
    };

serviceRef 
    returns [String serviceURI] 
    : SERVICE_REF URI 
    {
        $serviceURI = $URI.getText();
    }; 
```

问题是它解析日志不正确。我的代码不会忽略不需要的记录，因此我在结果列表中得到无效的 DATE 值：Tue Aug 28 09:39:09 MSD 2012（示例中的第一个）而不是 Mon Sep 03 10:35:54 MSD 2012（正确一个）。有人可以帮我吗？

提前感谢您的回答。

**更新**

我已经更新了我的代码，但是我得到了生成错误。看不出有什么问题。

更新的词法分析器：

```
lexer grammar LogLexer;

options {
    filter=true;
}

TRASH : LOGDATE ' ' METAINFO (' ' | '\n')* { skip(); };

LOGDATE : DAY ' ' MONTH ' ' NUMDAY ' ' NUMTIME ' ' TIMEZONE ' ' NUMYEAR;

METAINFO : ('[' | ']' | SYMBOL | NUM | ' ' | SPECIAL)+;

OSB_METAINFO : (' ' | '\n')* '[OSB Tracing] Inbound request was received.';

SERVICE_REF : 'Service Ref = ';

URI : (SYMBOL | '/')+;

ENVELOPE_TAG : '<' ENVELOPE_TAGNAME .* '>' .* '</' ENVELOPE_TAGNAME '>';

fragment
OSB_TRACING : '[OSB Tracing] Inbound request was received.';

fragment
ENVELOPE_TAGNAME : SYMBOL+ ':Envelope';

fragment
NUMTIME : NUM NUM ':' NUM NUM ':' NUM NUM;

fragment
TIMEZONE : SYMBOL SYMBOL SYMBOL;

fragment
DAY : 'Sun' | 'Mon' | 'Tue' | 'Wed' | 'Fri' | 'Sat';

fragment
MONTH :  'Sep' | 'Oct' | 'Nov' | 'Dec' | 'Feb' | 'Mar' | 'May' | 'Apr' | 'Jun' | 'Jul' | 'Aug';

fragment
NUMYEAR : NUM NUM NUM NUM;

fragment
NUMDAY : NUM NUM;

fragment
NUM : '0'..'9';

fragment
SYMBOL : ('a'..'z' | 'A'..'Z');

fragment
SPECIAL : ( ~'\n' | '\'' | '.' | '(' | ')' | '-'); 
```

更新的解析器：

```
parser grammar LogParser;

options {
    tokenVocab = LogLexer;
}

@header {
    import java.util.List;
    import java.util.ArrayList;
}

parse returns [List<List<String>> entries] 
    @init {
        $entries = new ArrayList<List<String>>();
    }
    : requestLogEntry+
    {
        $entries.add($requestLogEntry.logEntry);
    };

requestLogEntry 
    returns [List<String> logEntry]
    @init {
        $logEntry = new ArrayList<String>();
    }
    :  LOGDATE ' ' METAINFO OSB_METAINFO .* serviceRef .* ENVELOPE_TAG
    {
        $logEntry.add($LOGDATE.getText());
        $logEntry.add($serviceRef.serviceURI);
        $logEntry.add($ENVELOPE_TAG.getText());
    };

serviceRef 
    returns [String serviceURI] 
    : SERVICE_REF URI 
    {
        $serviceURI = $URI.getText();
    }; 
```

词法分析器生成错误：

```
[14:18:12] error(204): LogLexer.g:56:21: duplicate token type '\'' when collapsing subrule into set
[14:18:12] error(204): LogLexer.g:56:28: duplicate token type '.' when collapsing subrule into set
[14:18:12] error(204): LogLexer.g:56:34: duplicate token type '(' when collapsing subrule into set
[14:18:12] error(204): LogLexer.g:56:40: duplicate token type ')' when collapsing subrule into set
[14:18:12] error(204): LogLexer.g:56:46: duplicate token type '-' when collapsing subrule into set
[14:18:12] error(204): LogLexer.g:56:21: duplicate token type '\'' when collapsing subrule into set
[14:18:12] error(204): LogLexer.g:56:28: duplicate token type '.' when collapsing subrule into set
[14:18:12] error(204): LogLexer.g:56:34: duplicate token type '(' when collapsing subrule into set
[14:18:12] error(204): LogLexer.g:56:40: duplicate token type ')' when collapsing subrule into set
[14:18:12] error(204): LogLexer.g:56:46: duplicate token type '-' when collapsing subrule into set 
```

这些错误似乎随机发生并且随机消失（文件重命名）。ANTLR 还会从我的解析器文件中生成另一个词法分析器（这也是随机发生的）。我在 Windows 7 (x64) 上使用最后可用的 ANTLR3 和 ANTLRWorks。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:06:46.460

> *这些错误似乎随机发生并且随机消失（文件重命名）。*

不，它们不会随机发生。错误源于以下规则：

```
fragment
SPECIAL : ( ~'\n' | '\'' | '.' | '(' | ')' | '-'); 
```

集合`~'\n'`已经匹配`'\'' | '.' | '(' | ')' | '-'`。你可能的意思是：

```
fragment
SPECIAL : ~('\n' | '\'' | '.' | '(' | ')' | '-'); 
```

> *ANTLR 还会从我的解析器文件中生成另一个词法分析器（这也是随机发生的）。我在 Windows 7 (x64) 上使用最后可用的 ANTLR3 和 ANTLRWorks。*

仅当您未指定语法类型时才会发生这种情况。例如：（`grammar T`所谓的组合文法）同时生成词法分析器和解析器，其中`parser grammar T`和`lexer grammar T`仅分别生成解析器和词法分析器。一开始我看到你贴了一个组合语法。“额外的”词法分析器类可能是您使用组合语法时的残余物。

此外，请确保***不要***在解析器语法中使用任何文字标记！（`' '`从`requestLogEntry`规则中删除）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:39:01.083

我不完全确定我正在跟踪什么是有效与无效的服务请求，但无论如何我都会继续努力。

您的解析器正在寻找

```
LOGDATE METAINFO .* serviceRef .* ENVELOPE_TAG 
```

在开始解析之前，词法分析器正在寻找 LOGDATE + METAINFO + some stuff + serviceRef。

词法分析器不知道您希望它丢弃没有 serviceRef 的前两个 LOGDATE，而只考虑具有 serviceRef 的第三个条目。因此，它将第一行解析为完整条目的开头。

在不给您答案并剥夺您从深入理解 antlr 中获得的乐趣的情况下，我建议您让您的词法分析器“了解”更多关于如何构建正确条目的方式。词法分析器还应该了解如何构建不正确的条目。

换句话说，您将如何重写词法分析器，以便它处理一些词位并说前两行“只是一个日期”，第三行是真正的交易？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T08:18:48.150

内核模式！

我不确定，您选择的解析日志文件的方式是否最合适。

在我看来，Antlr 旨在描述上下文无关的语法。在您的情况下，我们处理最简单的常规语法。

根据我的经验，我敢说，对于以逐行模式解析日志文件，*阅读器*是一种更简单、更优化的方法。这样的算法将如下所示：

1.  读一行。转到第 2.1。2.1 如果该行以与正则表达式匹配的表达式开头（用于解析“Mon Sep 03 10:35:54 MSD 2012”） - 解析它并保存结果以供进一步解析。转到第 1\. 2.2 如果该行与上述正则表达式不匹配，则转到p。3.
2.  读取行，直到一行与 p.2.1 中的 reg.exp 匹配。转到第 4.
3.  尝试从读取块中剪切 XML（使用简单的字符串函数）。转到第 5.
4.  包含 XML？=> 解析 XML 并使用之前保存的解析结果作为日志日期。然后转到第 1 页。

# java - 在 zip 中的 xml 文件上使用 SAX 解析器

> ID：12410499
> 
> 赞同：5
> 
> 时间：2012-09-13T16:10:57.337
> 
> 标签：java, xml-parsing, zip, saxparser

由于正在处理的文件的大小（50-100MB xml 文件），这可能超出了 Java VM 的能力

现在我有一组以 zip 格式发送的 xml 文件，这些文件依次全部解压缩，然后使用 SAX 一次处理一个目录中的所有 XML。

为了节省时间和空间（因为压缩大约是 1:10），我想知道是否有办法将 ZipFileEntry （它是一个 xml 文件）传递给 SAX 处理程序。

我已经看到它使用 DocumentBuilder 和其他 xml 解析方法完成，但对于性能（尤其是内存）我坚持使用 SAX。

目前我正在通过以下方式使用 SAX

```
 SAXParserFactory factory = SAXParserFactory.newInstance();
        SAXParser saxParser = factory.newSAXParser();

        MyHandler handler = new MyHandler();

        for( String curFile : xmlFiles )
        {
            System.out.println( "\n\n\t>>>>> open " + curFile + " <<<<<\n");
            saxParser.parse( "file://" + new File( dirToProcess + curFile ).getAbsolutePath(), handler );
        } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T16:24:51.090

您可以使用 InputStream 作为源来[解析 XML 。](http://docs.oracle.com/javase/6/docs/api/javax/xml/parsers/SAXParser.html#parse%28java.io.InputStream,%20org.xml.sax.helpers.DefaultHandler%29)因此，您可以打开[ZipFile](http://docs.oracle.com/javase/6/docs/api/java/util/zip/ZipFile.html)，获取所需条目的 InputStream ，然后对其进行解析。请参阅[getInputStream](http://docs.oracle.com/javase/6/docs/api/java/util/zip/ZipFile.html#getInputStream%28java.util.zip.ZipEntry%29)方法。

- - 编辑 - -

以下是一些指导您的代码：

```
for( String curFile : xmlFiles )
{
        ZipFile zip = new ZipFile(new File( dirToProcess + curFile));
        Enumeration<? extends ZipEntry> entries = zip.entries();
        while (entries.hasMoreElements()){
            ZipEntry entry = entries.nextElement();
            InputStream xmlStream = zip.getInputStream(entry);
            saxParser.parse( xmlStream, handler );
            xmlStream.close();
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:07:17.017

*   [`ZipInputStream.read()`](http://docs.oracle.com/javase/1.5.0/docs/api/index.html?java/util/zip/ZipEntry.html)将从中读取 x 个字节`ZipFileEntry`，解压缩它们并为您提供解压缩的字节。
*   使用[此处](http://ostermiller.org/convert_java_outputstream_inputstream.html)的任何方法来创建输入/输出流。
*   为您的解析器提供*输入/输出流。*`InputStream`
*   开始将解压缩的数据写入输入/输出流（现在视为`OutputStream`）。
*   因此，您现在正在从 zip 文件中读取数据块，解压缩它们并将它们传递给解析器。

PS：

1.  如果 zip 文件包含多个文件，请参阅：[从 byte[] (Java) 读取时提取 ZipFile 条目的内容](https://stackoverflow.com/questions/1533253/extracting-contents-of-zipfile-entries-when-read-from-byte-java)，您必须进行检查，以便知道何时到达条目末尾。
2.  我不太了解 SAX 解析器，但假设它会以这种方式解析文件（当以块的形式给出时）。

- - 编辑 - -

这就是我的意思：

```
import java.io.File;
import java.io.InputStream;
import java.io.PipedInputStream;
import java.io.PipedOutputStream;
import java.util.Enumeration;
import java.util.zip.ZipEntry;
import java.util.zip.ZipFile;

import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;

import org.xml.sax.Attributes;
import org.xml.sax.SAXException;
import org.xml.sax.helpers.DefaultHandler;

public class Main {
    static class MyRunnable implements Runnable {

        private InputStream xmlStream;
        private SAXParser sParser;

        public MyRunnable(SAXParser p, InputStream is) {
            sParser = p;
            xmlStream = is;
        }

        public void run() {
            try {
                sParser.parse(xmlStream, new DefaultHandler() {
                    public void startElement(String uri, String localName, String qName, Attributes attributes)
                            throws SAXException {
                        System.out.println("\nStart Element :" + qName);
                    }

                    public void endElement(String uri, String localName, String qName) throws SAXException {
                        System.out.println("\nEnd Element :" + qName);
                    }
                });
                System.out.println("Done parsing..");
            } catch (Exception e) {
                e.printStackTrace();
            }
        }

    }

    final static int BUF_SIZE = 5;
    public static void main(String argv[]) {

        try {

            SAXParser saxParser = SAXParserFactory.newInstance().newSAXParser();

            ZipFile zip = new ZipFile(new File("D:\\Workspaces\\Indigo\\Test\\performance.zip"));
            Enumeration<? extends ZipEntry> entries = zip.entries();
            while (entries.hasMoreElements()) {
                // in stream for parser..
                PipedInputStream xmlStream = new PipedInputStream();
                // out stream attached to in stream above.. we would read from zip file and write to this..
                // thus passing whatever we write to the parser..
                PipedOutputStream out = new PipedOutputStream(xmlStream);
                // Parser blocks in in stream, so put him on a different thread..
                Thread parserThread = new Thread(new Main.MyRunnable(saxParser, xmlStream));
                parserThread.start();

                ZipEntry entry = entries.nextElement();
                System.out.println("\nOpening zip entry: " + entry.getName());
                InputStream unzippedStream = zip.getInputStream(entry);

                byte buf[] = new byte[BUF_SIZE]; int bytesRead = 0;
                while ((bytesRead = unzippedStream.read(buf)) > 0) {
                    // write to err for different color in eclipse..
                    System.err.write(buf, 0, bytesRead);
                    out.write(buf, 0, bytesRead);
                    Thread.sleep(150); // theatrics...
                }

                out.flush();
                // give parser a couple o seconds to catch up just in case there is some IO lag...
                parserThread.join(2000);

                unzippedStream.close(); out.close(); xmlStream.close();
            }

        } catch (Exception e) {
            e.printStackTrace();
        }

    }
} 
```

# winapi - 如何垂直同步winapi图纸

> ID：12410502
> 
> 赞同：3
> 
> 时间：2012-09-13T16:11:05.977
> 
> 标签：winapi, graphics, 3d, 2d

我想在我的显示器屏幕上按顺序绘制一个帧号

> 0 1 2 3 4 5 6 7 ...

每一个物理帧一个数字（在 100 Hz 刷新率监视器上每秒 100 次）在 winapi/gdi 下是否可能？怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:47:54.843

GDI 和 GDI+ 都不允许您访问 vsync 信号。

已弃用的 DirectDraw API 有一种等待 vsync 的方法。当您调用适当的 Present 方法时，较新的 DirectX API 基本上会为您执行此操作（尽管我相信有*不*等待 vsync 的选项）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-10T15:21:40.023

现代版本具有桌面窗口管理器（合成器。请参阅[https://en.wikipedia.org/wiki/Desktop_Window_Manager](https://en.wikipedia.org/wiki/Desktop_Window_Manager)）。您可以要求它阻止，直到发生与视频帧速率同步的“某些事件”。只需调用 DwmFlush()。我不会链接到文档，因为链接会过时。

在我的机器上，我的应用程序在等待 DwmFlush() 时被取消调度。换句话说，它不会浪费 CPU 周期忙等待，这很好。

我相信 Windows Vista 和 7 有 DWM，但它可以被禁用。在 Windows 8 及更高版本上，它始终存在。

# c# - 在后面的代码中获取最后插入的记录

> ID：12410503
> 
> 赞同：0
> 
> 时间：2012-09-13T16:11:11.970
> 
> 标签：c#, asp.net

我有一个像这样的插入存储过程

```
 insert into Profile_Master(FirstName,LastName,Dob,Gender,MobileNo,Country,State,EmailId,Password)
 values 
(@FirstName,@LastName,@Dob,@Gender,@MobileNo,@Country,@State,@EmailId,@Password)
set @id=SCOPE_IDENTITY()
return
end 
```

我想在后面的代码中获取最后插入的记录，如何捕获值？

```
 pid = cmd1.Parameters.Add("@id", System.Data.SqlDbType.Int);
            pid.Direction = System.Data.ParameterDirection.Output;
            int res = Convert.ToInt32(pid.Value);
            HttpContext.Current.Session["value"] = res.ToString(); 
```

在这里，我将 res 设为 0，因此第二页中的值不会更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:14:29.440

当您调用存储过程时，您应该已经定义了所有参数，包括带有 ParameterDirection.Output 的 @ID。这允许您在存储过程退出时读取参数的值。

像这样的东西

```
using(SqlConnection conn = new SqlConnection(CONNECTION_STRING))
{
    conn.Open();
    SqlCommand command = conn.CreateCommand();
    command.CommandType = CommandType.StoredProcedure;

    // Add all of your input parameters....

    SqlParameter pID = command.Parameters.Add
                 ("@ID",SqlDbType.Int);
    pID.Direction = ParameterDirection.Output;
    command.CommandText = "YourInsertProc";
    command.ExecuteNonQuery();

    // After executing the stored procedure, the SCOPE_IDENTITY() value 
    // could be read from the parameter value.
    int result = Convert.ToInt32(pID.Value);    
} 
```

如果您需要将结果传递到第二个页面，您可以使用会话变量

```
 Page.Session["EMailID"] = pID.Value; 
```

并在第二页重读

```
 if(Page.Session["EMailID"] != null)
    emailID = Convert.ToInt32(Page.Session["EMailID"]); 
```

作为第二种可能性，使用 QueryString 传递值

```
 url = "secondPage.aspx?emailID=" + pID.Value.ToString(); 
```

在“secondPage.aspx”上使用

```
 int emailID = Convert.ToInt32(Page.Request["emailID"]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:05:57.910

您还可以使用`OUTPUT INSERTED`和`execute scalar`

你的存储过程

```
declare @idtbl table (id int)
insert into Profile_Master(FirstName,LastName,Dob,Gender,MobileNo,Country,
                            State,EmailId,Password)
output inserted.ID into @idtbl
values 
(@FirstName,@LastName,@Dob,@Gender,@MobileNo,@Country,@State,@EmailId,@Password)

SELECT id from @idtbl 
```

在 C# 代码中：

```
command.CommandText = "sp_name_here";
//add parameters
command.CommandType = CommandType.StoredProcedure;
var id = command.ExecuteScalar();
HttpContext.Current.Session["value"] = id.ToString() 
```

# mysql - 在 MySQL 中计算零的个数

> ID：12410505
> 
> 赞同：-11
> 
> 时间：2012-09-13T16:11:21.783
> 
> 标签：mysql, sql, counting

我有以下数据：

```
 htno         sub       marks        credits
      1           a          15            0
      1           b          10            0 
      1           c          25            4
      1           d          24            4
      1           e          22            2
      1           f          12            0
      2           a          22            4 
      2           b          15            0
      2           c          23            4
      2           d          18            2 
      2           e          20            4
      2           f          6             0
      3           a          22            4  n so on 
```

我将向用户提供一个表格。如果用户输入他的电话号码“1”，那么它应该在 PHP 和 MySQL 中以这种方式显示输出：

```
 Number of Backlogs           Passed Subjects
                   3                           3 
```

这意味着它应该计算零的数量并显示积压的数量并计算非零的数量并显示通过主题的数量。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-13T18:19:06.373

我从您的文本格式数据中去除了尾随和前导空格，并使用 SQL Fiddle 创建了一个等效的示例模式。设置如下所示：

```
CREATE TABLE Grades
    (`htno` int, `sub` varchar(1), `marks` int, `credits` int)
;

INSERT INTO Grades
    (`htno`, `sub`, `marks`, `credits`)
VALUES
    (1, 'a', 15, 0),
    (1, 'b', 10, 0),
    (1, 'c', 25, 4),
    (1, 'd', 24, 4),
    (1, 'e', 22, 2),
    (1, 'f', 12, 0),
    (2, 'a', 22, 4),
    (2, 'b', 15, 0),
    (2, 'c', 23, 4),
    (2, 'd', 18, 2),
    (2, 'e', 20, 4),
    (2, 'f', 6, 0),
    (3, 'a', 22, 4)
; 
```

我做了以下假设：

*   每行代表一个学生在某一学科中的成绩。
*   “halticket number”唯一标识每个学生，并由列表示`htno`。
*   列中的零值`credits`表示学生“积压”中的一个主题。
*   列中大于零的值`credits`表示“通过主题”。

此查询满足您的要求：

```
SELECT
  SUM(CASE WHEN credits = 0 THEN 1 ELSE 0 END) AS `Number of backlogs`,
  SUM(CASE WHEN credits > 0 THEN 1 ELSE 0 END) AS `Passed subjects`
FROM Grades
WHERE htno = 1; 
```

我们使用过滤器[`SELECT`](http://dev.mysql.com/doc/refman/5.5/en/select.html)从 Grades 表中选择了 1 号学生的所有行。`WHERE`

第一个[`CASE`](http://dev.mysql.com/doc/refman/5.5/en/case.html)表达式计算一个新列，如果 credits 不为零，则该列包含 0，否则包含 1。

第二个`CASE`表达式计算一个新列，如果 credits 为非正数，则该列包含 0，否则包含 1。

您可以想象中间结果如下所示：

```
[Case expression 1] [Case expression 2]
0   1
0   1
1   0
1   0
1   0
0   1 
```

我们将整个结果集视为一个聚合组，并使用该[`SUM`](http://dev.mysql.com/doc/refman/5.5/en/group-by-functions.html#function_sum)函数将第一和第二计算列中的所有值相加。

第一列之和为 3，第二列之和为 3。

这为您提供了最终结果集。

[您可以在SQL Fiddle](http://sqlfiddle.com/#!2/e1282/2)上试用我的交互式解决方案。

# python - python中的文字聊天网站

> ID：12410506
> 
> 赞同：0
> 
> 时间：2012-09-13T16:11:29.443
> 
> 标签：python, network-programming, erlang, chat, tornado

我渴望创建一个具有一些额外功能的文本聊天网站。至于核心文本聊天部分，python 是否适合这种语言？如果是这样，他们是否有任何有助于此过程的库。

我还需要将实时数据推送回浏览器，这意味着我也将使用网络套接字。龙卷风是服务器的合适选择吗？我是基于网络的应用程序或网站的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:19:03.277

Tornado 是一个非阻塞网络服务器，已经创建了一个聊天演示。

[https://github.com/facebook/tornado/tree/master/demos/chat](https://github.com/facebook/tornado/tree/master/demos/chat)

来自龙卷风网站：

> 该框架与大多数主流 Web 服务器框架（当然还有大多数 Python 框架）不同，因为它是非阻塞的并且相当快。因为它是非阻塞的，并且使用 epoll 或 kqueue，所以它可以同时处理数千个站立连接，这意味着它非常适合实时 Web 服务。我们专门构建了 Web 服务器来处理 FriendFeed 的实时功能——FriendFeed 的每个活跃用户都与 FriendFeed 服务器保持开放连接。（有关扩展服务器以支持数千个客户端的更多信息，请参阅 C10K 问题。）

听起来值得花时间研究一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:16:57.233

您可以创建自己的简单聊天引擎。无论如何，看看下一个库也不错： [http://docs.python.org/library/asynchat.html](http://docs.python.org/library/asynchat.html)， [http://docs.python.org/library/socketserver.html](http://docs.python.org/library/socketserver.html)。

链接包含示例。

使用示例：在某个端口上启动它并从 javascript 访问它。

# vba - 使用宏替换字符串

> ID：12410507
> 
> 赞同：0
> 
> 时间：2012-09-13T16:11:34.120
> 
> 标签：vba, excel

我想替换 Excel 文件中所有工作表中的字符串。

这是模块，我已经写过了。但是，我想从搜索（和替换）操作中排除 A 列。

我不知道该怎么做。您能否让我知道模块中的更改，我可以从搜索中排除列。

谢谢

```
Sub FindSignificant()
    Dim SearchString As String
    Dim SearchRange As Range, cl As Range
    Dim FirstFound As String
    Dim sh As Worksheet

    ' Set Search value
    SearchString = "SIGNIFICANT"
    Application.FindFormat.Clear
    ' loop through all sheets
    For Each sh In ActiveWorkbook.Worksheets
        ' Find first instance on sheet
        Set cl = sh.Cells.Find(What:=SearchString, _
             After:=sh.Cells(1, 1), _
            LookIn:=xlFormulas, _
            LookAt:=xlPart, _
            SearchOrder:=xlByRows, _
            SearchDirection:=xlNext, _
            MatchCase:=False, _
            SearchFormat:=False)
        If Not cl Is Nothing Then
            ' if found, remember location
            FirstFound = cl.Address
            ' format found cell
            Do
                cl.Font.Bold = True
                cl.Font.ColorIndex = 3
                ' cl.Interior.ColorIndex = 3
                ' find next instance
                Set cl = sh.Cells.FindNext(After:=cl)
                ' repeat until back where we started
            Loop Until FirstFound = cl.Address
        End If
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:18:43.627

这应该可以解决您的麻烦：

```
Do
  If not cl.column = 1 Then
    cl.Font.Bold = True
    cl.Font.ColorIndex = 3
    ' cl.Interior.ColorIndex = 3            
  End If
    ' find next instance
    Set cl = sh.Cells.FindNext(After:=cl)
    ' repeat until back where we started
Loop Until FirstFound = cl.Address 
```

# php - 为什么这个正则表达式不验证

> ID：12410511
> 
> 赞同：2
> 
> 时间：2012-09-13T16:11:59.360
> 
> 标签：php, regex

我正在为像**G20003030**或像**G-20003030**这样的检查字符串构建一个正则表达式。第一个字母可以是任何一个：VGJ。这是我的代码：

```
$string = "G20003030";
if (preg_match('^[VGJ]{1,1}?[0-9]{8,8}$/', $string)) {
    echo "passed";
} else {
    echo "not passed";
} 
```

但它总是返回“未通过”。我的正则表达式有什么问题以及如何检查这两个变体？（我认为我的代码只适用于第一个）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:14:13.387

> **警告**: :在第 3 行的 /code/xxxxxx.php 中`preg_match()`找不到结束分隔符`'^'`

您忘记了第一个斜线和连字符（感谢**@Sepster**）。

```
/^[VGJ]-?[0-9]{8}$/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:16:10.423

尝试使用这个正则表达式：

```
/^[VGJ]-?[0-9]{8}$/ 
```

# textures - 具有正交投影的 JOGL 场景中的白框

> ID：12410513
> 
> 赞同：1
> 
> 时间：2012-09-13T16:12:08.283
> 
> 标签：textures, jogl, orthographic

我正在使用最新版本的 JOGL 2.0

我的场景是使用正交投影设置的，我正在尝试在场景底部添加纹理。纹理是 1600 x 100 PNG 文件。

如果我使用 1000 x 1000 PNG 文件，则纹理呈现正常，但是当我使用 1600 x 100 纹理时，我得到一个白框。

我已经使用

```
gl.glMatrixMode(GL2.GL_PROJECTION);
gl.glPushMatrix();
gl.glOrtho(0, 1, 0, 1, 0, 1);

gl.glMatrixMode(GL2.GL_MODELVIEW);
gl.glPushMatrix();
gl.glLoadIdentity(); 
```

我正在使用加载纹理

```
texture = TextureIO.newTexture(new File("image.png") ,false); 
```

我正在使用

```
gl.glEnable(GL.GL_TEXTURE_2D);
TextureCoords tc = texture.getImageTexCoords();

texture.bind(gl);

gl.glBegin(GL2.GL_QUADS);

gl.glTexCoord2d(tc.left(),tc.top());gl.glVertex2d(0.0,0.1);     
gl.glTexCoord2d(tc.left(),tc.bottom());gl.glVertex2d(0.0,0.0);      
gl.glTexCoord2d(tc.right(),tc.bottom());gl.glVertex2d(1.0,0.0);     
gl.glTexCoord2d(tc.right(),tc.top()); gl.glVertex2d(1.0,0.1);

gl.glEnd();
gl.glDisable(GL.GL_TEXTURE_2D); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T16:14:29.153

你得到一个白盒子的原因是因为你的显卡确实支持这么大的图像。1600 x 1600 像素太大了，按照现代标准，1600 x 100 也太大了。我建议你使用 1024 x 128。

为了获得最大的兼容性，我建议您使用具有二次幂的纹理。例如 32 x 64、128 x 512 甚至 1024 x 1024。仅仅因为一个数字可以被 2 整除并不意味着 2 的幂。2 的幂是 2^x。

查找二次幂的提示（计算器）：只需输入 [2] [*] [2] [=] [=] [=]... 其中 [] 代表您的输入。

# http - NodeJS请求不返回

> ID：12410517
> 
> 赞同：1
> 
> 时间：2012-09-13T16:12:13.857
> 
> 标签：http, node.js, twitter, request, asynccallback

Node 很新，我正在尝试在我的 node/express 应用程序中实现一个 twitter 流。

该文件位于我的路由文件夹中的一个单独的 stream.js 文件中，它是通过客户端 jquery 脚本中的 ajax 调用的。

我查看并比较了其他几个站点上的 http.request，并且尝试了多种配置，但没有任何变化。直到 http.request 回调的所有内容都会触发，但我无法得到响应

```
 var http = require('http')
      , events = require('events')
      , url = require('url')
      , fs = require('fs')
      , path = require('path')
      , sys = require('sys')

      , tweet_emitter = new events.EventEmitter()
      , options = {
                host: "api.twitter.com",
                port: 80,
                path: "/1/statuses/public_timeline.json",
                method: "GET"
      }

    var getTweets = function() {
        console.log('getTweets');// fires fine
        var req = http.request( options, function( res ) {
            console.log('STATUS: ' + res.statusCode);// nothing here executes
            console.log('HEADERS: ' + JSON.stringify(res.headers));

            var data = "";

            res.setEncoding('utf8');
            res.on('data',function( chunk ) {
                data += chunk;
                console.log(chunk);
            });

            res.on('end',function() {
                var tweets = JSON.parse( data );
                if( tweets.length ) tweet_emitter.emit( 'tweets', tweets )
            })

            req.end()
        });

        req.on('error', function(e) {
            console.log('problem with request: ' + e.message);
        })
    }

    setInterval(getTweets, 5000 );

    exports.stream = function(req, res){
        var listener = tweet_emitter.addListener("tweets", function( tweets ) {
            res.writeHead(200, { "Content-Type" : "text/plain" });
            res.write( JSON.stringify(tweets) );
            res.end();

            clearTimeout(timeout);
        });

        var timeout = setTimeout(function() {
            res.writeHead( 200, { "Content-Type" : "text/plain" });
            res.write(JSON.stringify([]));
            res.end();

            tweet_emitter.removeListener(listener);
        },10000);
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:39:58.073

我赞同史蒂夫的评论。如此多的 NodeJS 新手开发人员在巨头构建的非常低级的方法上破解了自己的道路。查看 NPM 上一些更常见的库。

考虑：[https](https://github.com/joyent/node/wiki/modules) ://github.com/joyent/node/wiki/modules 或：[https ://npmjs.org/](https://npmjs.org/)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-07T09:53:22.667

哇。四年后。我有一个类似的问题。

同意史蒂夫的评论，也许是一个更好的图书馆......，但这里是这个图书馆的解决方案。好吧，不*完全是*这个库，但这个概念应该也可以。

问题

```
const request = require('request');
var opts = {url:my_url,timeout:5000}
request(opts,function(error,response,body){
  var data = parse(response);
  dosomething(data);
);
// the callback is never called...
// even after the timeout period... 
```

[https://github.com/request/request](https://github.com/request/request)

`timeout`医生说`if the underlying TCP connection cannot be established, the OS-wide TCP connection timeout will overrule the timeout option (the default in Linux can be anywhere from 20-120 seconds).`

也许我只是等不及 120 秒？唔...

为了强制超时，我提出了这个解决方案：

```
const request = require('request');
var opts = {url:my_url,timeout:5000}
var complete = false
request(opts,function(e,r,b){
  if(!complete) {
    complete = true;
    var d = parse(r);
    dosomething(d);
  }
});

setTimeout(function() {
  if(!complete) {
    complete = true;
    dosomething(null);
  }
}, opts.timeout); 
```

我的情况的根本原因可能是我的 ip 应该被列入白名单，但我认为它被列入黑名单并且服务器根本没有响应，即使出现错误也没有。我可以从不同的 ip 访问它，而不是为白名单请求的 ip :)

症状变成了我的代理表现出我以前没有预料到的非常长的等待时间，因为我在开发/测试时没有遇到过这个问题。

# python - South 命令意外从 Django 的 manage.py 中删除

> ID：12410520
> 
> 赞同：4
> 
> 时间：2012-09-13T16:12:23.063
> 
> 标签：python, django, django-south

我一直在开发一个 django 应用程序并且已经成功地使用了 South。出于某种原因，我不再能够通过以下方式访问南命令`manage.py`：

```
$ python manage.py schemamigration appname
Unknown command: 'schemamigration'
Type 'manage.py help' for usage. 
```

此外，`manage.py help`没有列出任何 South 命令。

我仍然可以很好地导入 South`manage.py shell`并且 south 仍然在我的`INSTALLED_APPS`. 我在 virtualenv 中运行 South 0.7.6、Django 1.4.1 和 Python 2.7.3，并且我也尝试过重新创建 virtualenv，但没有运气。有任何想法吗？

已解决：经过一番摆弄后，我注意到当我从`settings.py > INSTALLED_APPS`South 中删除我的应用程序时，功能返回了。所以，我又调查了一些......

我已经`LOGIN_REDIRECT_URL`设置了`settings.py`使用`reverse()`查找的方法。`reverse()`查找失败是因为`admin.py`试图导入我刚刚删除的模型。这就是我的南方问题的根源。为了解决我的问题，我删除了有问题的 import in `admin.py`，但我也测试了将全局变量包装在`settings.py`with`try/except`中，这也有效。

我觉得奇怪的是，`manage.py`当它在导入时窒息时会默默地失败`settings.py`。有没有办法改变这种行为？此外，是否有设置全局变量的最佳实践`settings.py`？

# git - 将 Clearcase 的历史记录保存到 Git？

> ID：12410521
> 
> 赞同：11
> 
> 时间：2012-09-13T16:12:27.507
> 
> 标签：git, clearcase, clearcase-ucm

在我的公司，我们正在（完全）从 ClearCase UCM 过渡到 Git。使用 Git 一段时间后，我们将不再使用 Clearcase。

在过渡期间，是否有任何好的工具可以将 ClearCase 的历史以某种方式带入 Git？

另外，我读了很多，一个组件=一个回购。但是，我们希望将当前组件重新组织并拆分为更小的部分。（设置 ClearCase 的人并没有真正提前计划。）还有办法做到这一点吗？

任何意见将不胜感激 - 包括在过渡期间需要注意的答案和其他事项。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T16:59:32.227

至少，使用 ClearCase UCM，您可以使用完整的基线，即在给定组件的所有文件上设置的标签。

根据经验，您*永远不会*将 ClearCase 中的完整历史记录导入基于跨引用修订的版本控制工具（请参阅[ClearCase 和 Git 之间的区别](https://stackoverflow.com/questions/645008/what-are-the-basic-clearcase-concepts-every-developer-should-know?lq=1)：ClearCase 具有逐个文件设置的历史记录，而不是“逐个修订”）

[正如我在回答“同步 GIT 和 ClearCase](https://stackoverflow.com/questions/2477321/sync-git-and-clearcase) ”中提到的，我通常做的是：

*   每个 UCM 组件一个 Git 存储库
*   仅导入集成流的最后 3 或 4 个基线
*   仅在确实需要时才从子流中导入一些基线
*   锁定 UCM vob 并将 ClearCase 保持在只读模式以进行存档

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T16:21:56.173

尝试使用此工具将历史记录从 ClearCase 导入 git：[https ://github.com/charleso/git-cc](https://github.com/charleso/git-cc)

关于从 ClearCase 迁移到 git 时 repos 的重组，关于 SO 的讨论很少，例如这个： [Sync GIT and ClearCase](https://stackoverflow.com/questions/2477321/sync-git-and-clearcase)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T16:24:13.733

我不会立即退出明确的案例。您要做的是以明确的大小写和任何标签提交任何分支的提示。这应该以反映清楚情况下发生的情况的方式完成（保留逻辑分支点等）。从那时起使用 git。如果您需要深入了解历史，请参阅 clear case。最终归档明确的案例，并且只有在您看到一些旧提交时才恢复它。根据我的经验，导入旧历史不值得麻烦。这通常非常耗时且容易出错。

# drupal - 在新用户注册后运行自定义代码（Drupal 7）

> ID：12410524
> 
> 赞同：0
> 
> 时间：2012-09-13T16:12:33.327
> 
> 标签：drupal, drupal-7

我想在新用户注册后运行一些自定义代码（特别是我想为新的新客户添加一个 ubercart 订单）。添加此代码的正确位置在哪里？我目前正在查看 hook_user_insert()，但是从文档中我不确定这是正确的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:24:50.583

您可以使用[规则](http://drupal.org/project/rules)模块手动插入 php 代码。

# c# - 从 R 调用 .NET/C#

> ID：12410528
> 
> 赞同：13
> 
> 时间：2012-09-13T16:12:51.667
> 
> 标签：c#, visual-studio-2010, r

我想使用 R 中仅在 .NET 中可用的 API。是否有可用于从 R 调用 .NET C# 代码的标准方法？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-09-06T00:28:15.227

本讨论的读者可能会考虑的另一个选择是[rClr 包](https://github.com/jmp75/rClr "rClr")，我已经研究了几年来从 R 访问任意 .NET 代码。它是[R.NET](https://www.nuget.org/packages/R.NET/ "网络")的兄弟，相反，它是一种方法从 .NET 访问 R。

为了给出 rClr 包的味道，规范的“Hello World”看起来像：

```
library(rClr)
clrLoadAssembly('c:/path/to/myassembly.dll')
myObj <- clrNew('MyNamespace.MyClass,MyAssemblyName')
clrCall(myObj, 'SayHelloWorld') 
```

欢迎通过网站提供反馈和建议。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T02:41:51.660

将 .NET dll 公开为 COM dll，然后从 R 调用 dll 中的 COM 对象似乎是唯一的方法。并且有一个包：[http ://cran.r-project.org/web/packages/rcom/rcom.pdf](http://cran.r-project.org/web/packages/rcom/rcom.pdf)

如果您无法制作 COM dll，因为它是第三方 dll，您始终可以使用 COM 接口创建一个类似接口的新 .NET dll，您可以在其中调用实际的 dll。

# performance - Erlang rpc:pmap 在多个节点上与单个节点

> ID：12410531
> 
> 赞同：0
> 
> 时间：2012-09-13T16:13:06.283
> 
> 标签：performance, parallel-processing, erlang, pmap

我正在尝试将我的计算与`rpc:pmap`. 但我对它的表现有点困惑。

这是一个简单的例子：

```
-module(my_module).
-compile(export_all).

    do_apply( X, F ) -> F( X ). 
```

首先 - 在单个节点上测试：

```
1> timer:tc( rpc, pmap, [{my_module, do_apply}, [fun(X) -> timer:sleep(10), X end], lists:seq(1,10000)] ).
{208198,
 [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,
  23,24,25,26,27|...]} 
```

之后，我连接了第二个节点（我的操作系统中的第二个 erlang shell 进程）：

```
(foo@Stemm.local)24> timer:tc( rpc, pmap, [{my_module, do_apply}, [fun(X) -> timer:sleep(10), X end], lists:seq(1,10000)] ).
{446284,
 [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,
  23,24,25,26,27|...]} 
```

最后我连接了第三个节点：

```
(foo@Stemm.local)26> timer:tc( rpc, pmap, [{my_module, do_apply}, [fun(X) -> timer:sleep(10), X end], lists:seq(1,10000)] ).
{483399,
 [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,
  23,24,25,26,27|...]} 
```

所以 - 我**的三个节点与单节点的性能更差**。

我意识到节点之间的通信存在一些开销。但是我如何理解在哪些情况下更好地在多个节点上执行计算呢？

**编辑：**

我在 shell 中的逐步测试：

```
1> c(my_module).
{ok,my_module}
2>  
2> List = lists:seq(1,10000).
[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,
 23,24,25,26,27,28,29|...] 
```

**单节点性能测试：**

```
3> timer:tc( rpc, pmap, [{my_module, do_apply}, [fun(X)-> timer:sleep(10), X end], List] ).
{207346,
 [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,
  23,24,25,26,27|...]} 
```

网络环境入口：

```
4> net_kernel:start([one]).
{ok,<0.20066.0>}
(one@Stemm.local)5> erlang:set_cookie(node(), foobar).
true 
```

添加第二个节点：

```
(one@Stemm.local)6> net_kernel:connect('two@Stemm.local').
true
(one@Stemm.local)7> 
(one@Stemm.local)7> nodes().
['two@Stemm.local'] 
```

**使用两个节点测试性能：**

```
(one@Stemm.local)8> timer:tc( rpc, pmap, [{my_module, do_apply}, [fun(X)-> timer:sleep(10), X end], List] ).
{510733,
 [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,
  23,24,25,26,27|...]} 
```

连接第三个节点：

```
(one@Stemm.local)9> net_kernel:connect('three@Stemm.local').
true
(one@Stemm.local)10> nodes().
['two@Stemm.local',
 'three@Stemm.local'] 
```

**用三个节点测试性能：**

```
(one@Stemm.local)11> timer:tc( rpc, pmap, [{my_module, do_apply}, [fun(X)-> timer:sleep(10), X end], List] ).
{496278,
 [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,
  23,24,25,26,27|...]} 
```

**PS**我猜性能会下降，因为我在同一台物理机器上将每个节点创建为一个新的 erlang-shell 进程。但我不知道我是否正确。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:32:44.957

您无需添加节点即可在 Erlang 中获得并行性。每个节点可以在本地支持大量进程。 `pmap`已经在并行运行您的函数。如果您延长等待时间，这更容易看出：

```
timer:tc( rpc, pmap, [{my_module, do_apply}, [fun(X) -> timer:sleep(1000), X end], lists:seq(1,10000)] ).
{1158174,
 [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,
  23,24,25,26,27|...]} 
```

如果睡眠在一个节点上按顺序运行，那么您会期望最少等待`1000 * 10000 = 10,000,000`，而我们只需要等待`1,158,174`

您正在创建 3 个独立的 Erlang VM，并将它们相互连接。然后，您在其中一个虚拟机上运行并行映射。额外的虚拟机只会损害您当前设置的性能，因为它们都试图使用相同的物理资源，其中 2 个甚至没有运行任何工作。

多个节点只有在不同的物理资源上运行时才会有助于提高性能。

# php - 斑马条纹 PHP MYSQL 表

> ID：12410534
> 
> 赞同：1
> 
> 时间：2012-09-13T16:13:10.017
> 
> 标签：php, jquery, mysql, html-table

我想 Zebra Stripe 结果表。我找不到可靠的解决方案。我需要对该表执行什么操作才能将奇数/偶数类添加到结果行？

```
 // HTML ... Aliases from Mysql
echo "<table  class='sortable' id='tablesorter' cellspacing='1' cellpadding='0' border='0' width='920px' >
<thead>
<tr>
<th class='header'>Short Name of Fund</th>
<th class='header'>I/C</th>
<th class='header'>Fund Manager Company</th>
<th class='header'>Class</th>
<th class='header'>Special Class</th>
<th class='header' id='custom'>TTR year-to-date<br /> %</th>
<th class='header'>Mgmt Fee Effectively Charged</th>
<th class='header id='custom'>Total Expenses <br /> %</th>
<th class='header'>Fund Size</th>
</thead><tbody>

</tr>";

//<tr> specifies table row. for each <td> (table data) will specify a new column.  The $row specifies the mysql column name (in this case using an alias)
while($row = mysql_fetch_array($result))
  {
  echo "<tr>";
  echo "<td><a href=\"page.php?id={$row['ID']}\">{$row['Short Name of Fund']}</a></td>";
  echo "<td>" . $row['I/C'] . "</td>";
  echo "<td>" . $row['Fund Manager Company'] . "</td>";
  echo "<td>" . $row['Class'] . "</td>";
  echo "<td>" . $row['Special Class'] . "</td>";
  echo "<td>" . $row['TTR year-to-date %'] . "</td>";
  echo "<td>" . $row['Mgmt Fee Effectively Charged'] . "</td>";
  echo "<td>" . $row['Total Expenses %'] . "</td>";
  echo "<td>" . $row['Fund Size'] . "</td>";

  echo "</tr>";
  }
echo "</tbody></table>"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T16:16:49.697

这应该可行，语法可能不正确，因为我没有测试过。但逻辑是存在的。

```
$currentState = 'odd';
$html = '';
while($row = mysql_fetch_array($result)){
    $currentState = ($currentState == 'odd' ? 'even' : 'odd');
    $html .= '<tr class="'.$currentState.'">';
    $html .= '<td><a href="page.php?id=' . $row['ID'] . '">'. $row['Short Name of Fund'] .'</a></td>';
    $html .= '<td>' . $row['I/C'] . '</td>';
    $html .= '<td>' . $row['Fund Manager Company'] . '</td>';
    $html .= '<td>' . $row['Class'] . '</td>';
    $html .= '<td>' . $row['Special Class'] . '</td>';
    $html .= '<td>' . $row['TTR year-to-date %'] . '</td>';
    $html .= '<td>' . $row['Mgmt Fee Effectively Charged'] . '</td>';
    $html .= '<td>' . $row['Total Expenses %'] . '</td>';
    $html .= '<td>' . $row['Fund Size'] . '</td>';
    $html .= '</tr>';
}
echo $html; 
```

**编辑**：更新代码，使其工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T16:16:10.513

If you are willing to use CSS 3, try the [nth child](http://dev.opera.com/articles/view/zebra-striping-tables-with-css3/) trick in your css:

```
tr:nth-child(2n+1) 
{
  background-color: #aaeeaa;
} 
```

However, if you want to go ahead with odd / even classes, then you'll need a counter during your while loop and then alternate the odd / even classes when `count % 2 = 0`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-03T16:30:17.940

诀窍是以逻辑方式使用 php：D 诀窍是为您的表行创建一个动态类。所以基本上你会有两个班级，一个是奇数，一个是偶数。我会在下面给你一个例子（不要介意我的项目）：

```
 $counter="";
                      while ($upit_row = mysql_fetch_array($upit_run)){
                            $korisnik_id = $upit_row['korisnik_id'];
                $tip_id = $upit_row['tip_id'];
                                $tip = mysql_fetch_array(mysql_query("SELECT naziv FROM  tip_korisnika WHERE tip_id = '$tip_id'"));
                            $kor_ime = $upit_row['korisnicko_ime'];
                            $ime = $upit_row['ime'];
                            $prezime = $upit_row['prezime'];
                            $email = $upit_row['email'];
                            $counter++;
                            $class="";
                        if ($counter%2){
                           $class="even";
                      } else{
                           $class="odd";
                      } 
```

CSS 看起来像这样：

```
tr.odd{
    background-color:white;     
}
tr.even{
    background-color:#FAFAFA;
} 
```

计数器将计算 php 生成的每一行，这会创建一个数字，您将其减去 2 并获得奇数和偶数。之后，您使用 if 语句来定义您的类：D 之后，只需将类变量插入如下：

```
echo "<tr class='$class'>"; 
```

或像这样：

```
<tr class="<?php echo $class ?>"> 
```

PS。对不起我的英语：/希望它有所帮助。

# php - 使用 PHP/Codeigniter 连接到远程数据库（EC2 实例）？

> ID：12410535
> 
> 赞同：2
> 
> 时间：2012-09-13T16:13:10.843
> 
> 标签：php, mysql, codeigniter, ssh, amazon-ec2

我已经在我的 Mac 上设置了[MNPP](http://getmnpp.org/)（XAMPP 的 Nginx 版本），但不知道如何连接到不是 localhost 的数据库。我想连接到一个 EC2 实例上的 MySQL 数据库。

我正在使用 Codeigniter/PHP 并且以下配置有效：

```
$db['default']['hostname'] = "localhost"; 
$db['default']['password'] = ""; 
```

以下**不起作用**：

```
$db['default']['hostname'] = "mysite.com"; //the name of my EC2 instance
$db['default']['password'] = "my_password"; 
```

`~/.ssh/mysite.pem`我可以使用 MySQL GUI、Sequel Pro、上面的配置和我的 EC2 SSH 密钥（

我是否需要更改 my.cnf 文件或其他任何地方的任何内容才能使其正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:26:53.080

确保您的主机正在侦听 TCP 3306。

您还需要为新主机上的用户设置数据库权限。

在您的远程数据库上，运行：

```
GRANT ALL ON foo.* TO username@'your-ip-address-here' IDENTIFIED BY 'PASSWORD'; 
```

替换`your-ip-address-here`为 localhost 的公共 IP，并将 username 和 PASSWORD 替换为您各自的值。

这将允许您的应用程序通过 MySQL 与远程主机通信。这些应用程序不直接支持 SSH 隧道。

或者，您可以创建一个 SSH 隧道，它将`localhost:3307`例如桥接到`remotehost:3306`.，然后在您的应用程序中，您仍然可以使用 localhost，但将 mysql 端口更改为`3307`.

# google-analytics - GoogleAnalytics for own data

> ID：12410537
> 
> 赞同：3
> 
> 时间：2012-09-13T16:13:24.980
> 
> 标签：google-analytics, google-analytics-api

i am preparing mvc4 website in which i want to implement chart for specific "Area". let me describe in detail, there can be many "Area" in website say abc,xyz. now in one area there can be number of users.

all i want is to maintain chart for particular "Area" like how many users visiting "Area",number of clicks per "Area",time users spent in one "Area" etc.

is this possible through GA ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T00:05:18.333

查看[自定义变量](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCustomVariable)。这允许您创建自己的自定义细分。

# c# - Get Method in C#

> ID：12410541
> 
> 赞同：0
> 
> 时间：2012-09-13T16:13:43.823
> 
> 标签：c#, xrm

I came across C# codes in the following pattern but quite don't get where that `Set` method comes from.

```
// obj is an instance of Microsoft's Xrm Entity class
obj.Set("property_name", property_value); 
```

Based on Xrm's Entity class definition, there is no member method called `Set`.

Can someone give me some light on this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:30:28.407

由于 C# 3.0 类可以获得未在类本身中声明的扩展方法。

[http://www.c-sharpcorner.com/uploadfile/puranindia/extension-methods-in-C-Sharp-3-0/](http://www.c-sharpcorner.com/uploadfile/puranindia/extension-methods-in-C-Sharp-3-0/)

我怀疑这里就是这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:19:46.330

如果您在 Visual Studio 中，您可以右键单击`Set`呼叫并单击“转到定义”

您至少可以获得您正在使用的任何类的几乎任何成员的元数据文件。

# c# - Unable to find error while inserting data into database

> ID：12410542
> 
> 赞同：0
> 
> 时间：2012-09-13T16:14:04.637
> 
> 标签：c#, asp.net, sql

Can some one here tell me what is wrong with my code? Benn spending like an endless hour finding the error.

```
 protected void Button1_Click(object sender, EventArgs e)
{
    SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["Connection"].ConnectionString);
    SqlCommand cmd = new SqlCommand("Insert into CarReserve(UserName,Manufacture,Model,Plate,DateReturn,TimeReturn) Values (@Username1,@Manufacture1,@Model1,@Plate1,@Date1,@TimeReturn1)", conn);

    cmd.CommandType = CommandType.Text;
    cmd.Parameters.AddWithValue("@Username1", Label1.Text);
    cmd.Parameters.AddWithValue("@Manufacture1", Label3.Text);
    cmd.Parameters.AddWithValue("@Model1", Label4.Text);
    cmd.Parameters.AddWithValue("@Plate1", Label5.Text);
    cmd.Parameters.AddWithValue("@Datel", Label6.Text);
    cmd.Parameters.AddWithValue("@TimeReturnl", Label7.Text);

    conn.Open();
    cmd.ExecuteNonQuery();
    Response.Redirect("HomeUser.aspx"); 

} 
```

The error is must declare the scalar var @Date1\. Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:18:05.607

```
cmd.Parameters.AddWithValue("@Datel", Label6.Text); 
```

看起来您输入`@Date**l**`的是“字母 ell”而不是`@Date**1**`“第一”。

看起来您也对以下行犯了同样的错误：

```
cmd.Parameters.AddWithValue("@TimeReturnl", Label7.Text); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-14T06:08:12.997

据我所知，您应该将参数及其值放在 sql 查询字符串之前，例如：

```
SqlConnection conn = new SqlConnection  (ConfigurationManager.ConnectionStrings["Connection"].ConnectionString);
SqlCommand cmd = new SqlCommand(conn);

cmd.Parameters.AddWithValue("@Username1", Label1.Text);
cmd.Parameters.AddWithValue("@Manufacture1", Label3.Text);

cmd.CommandText = "Insert into CarReserve(UserName,Manufacture,Model,Plate,DateReturn,TimeReturn) Values (@Username1,@Manufacture1,@Model1,@Plate1,@Date1,@TimeReturn1)";

cmd.CommandType = CommandType.Text; 
```

# php - Setting a flag in cache memory using zend_registry

> ID：12410546
> 
> 赞同：3
> 
> 时间：2012-09-13T16:14:10.580
> 
> 标签：php, zend-framework, zend-cache

Let's suppose I have a Php function like this:

```
private function verification($isXLSFile = false) {

    if ($isXLSFile) {
        $this->parseXLSFile();
    }else {
        $parsedCSVArr = $this->getCSVarr();
        Zend_Registry::get('VMMS_ZEND_CACHE')->save($parsedCSVArr, $this->getXLSCacheName());
        Zend_Registry::get('VMMS_ZEND_CACHE')->save($isXLSFile, $this->getXLSCacheName());
    }
} 
```

And then I call another function checking the CACHE like this:

```
private function process(){
    Logger::info("EnterDataMassUpload - Start Process...");
    if (($parsedCSVArr = Zend_Registry::get('VMMS_ZEND_CACHE')->load($this->getXLSCacheName())) === false) {
        $this->verification();
        return;
    }
    //if XLS file it reads the lines for each sheet.
    if ($isXLSFile == true) {
        $i=0;
        //make sure there's no duplicated row
        $parsedCSVArr = array_unique($parsedCSVArr, SORT_REGULAR);
        foreach($parsedCSVArr as $sheetIndex=>$arr){
            foreach ($arr as $k=>$line) {
                $this->processLine($line, $k);
                $i++;
            }
        }
    } else { //for a CSV file
        foreach($parsedCSVArr as $k=>$line){
            $this->processLine($line, $k);
        }
    }
    // ... 
```

As you can see, I'm trying to save 2 variables in the same place to read it in the function `process()`. Do you know why my flag is not working? I mean.. can I save two variables in the same place:

```
 Zend_Registry::get('VMMS_ZEND_CACHE')->save($parsedCSVArr, $this->getXLSCacheName());
 Zend_Registry::get('VMMS_ZEND_CACHE')->save($isXLSFile, $this->getXLSCacheName()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:20:13.267

你为什么不把它保存在两个不同的名字下？

否则，您可以使用序列化将两个变量保存在相同的名称下。

```
Zend_Registry::get('VMMS_ZEND_CACHE')->save(serialize(array('parsedCSVArr' => $parsedCSVArr, 'isXLSFile' => $isXLSFile)), $this->getXLSCacheName()); 
```

然后，在 process 函数中获取缓存结果和：

```
$cacheResult['parsedCSVArray'];
$cacheResult['isXLSFile']; 
```

# c# - The thread has exited with code 0 (0x0) with no unhandled exception

> ID：12410548
> 
> 赞同：121
> 
> 时间：2012-09-13T16:14:15.790
> 
> 标签：c#, .net, debugging

While debugging my C# application I have noticed a large amount occurrences of the following sentence:

> The thread -- has exited with code 0 (0x0).

The application continues to work and no exception is catched/unhanded.

The application is running on Windows 7 64bit and debugged with x86 platform.

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2012-09-13T16:18:47.110

这只是调试消息。您可以通过右键单击输出窗口并取消选中来关闭它`Thread Exit Messages`。

[http://msdn.microsoft.com/en-us/library/bs4c1wda.aspx](http://msdn.microsoft.com/en-us/library/bs4c1wda.aspx)

> 除了从您的应用程序中编程外，“**输出**”窗口还可以显示以下信息：
> 
> *   调试器已加载或卸载的模块。
>     
>     
> *   抛出的异常。
>     
>     
> *   退出的进程。
>     
>     
> *   **退出的线程。**

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-09-13T16:17:11.023

好吧，一个应用程序可能有很多并行运行的线程。有些是由您（编码员）运行的，有些是由框架类运行的（尤其是如果您在 GUI 环境中）。

当一个线程完成其任务时，它会退出并停止存在。即没有什么令人担忧的，你不应该关心。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-12-15T13:25:07.650

为了完成 BlueM 接受的答案，您可以在此处停用它：

工具 > 选项 > 调试 > 常规输出设置 > 线程退出消息：关闭

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-09-13T16:16:45.293

如果您的应用程序直接或间接使用线程（即在第 3 方库中的幕后），线程完成后终止是绝对常见的......这基本上就是你所描述的......调试器显示此消息...如果您不想要它，您可以将调试器配置为不显示此消息...

如果上述方法没有帮助，请提供更多详细信息，因为我不确定您到底面临什么问题......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-17T13:47:42.323

该框架创建线程来支持您创建的每个窗口，例如，当您创建一个 Form 并 .Show() 它时。当窗口关闭时，线程终止（即它们退出）。

这是正常行为。但是，如果应用程序正在创建线程，并且有很多与这些线程对应的线程退出消息（可以通过线程的名称来判断，通过在应用程序中给它们不同的名称），那么这可能表明存在问题由于程序逻辑错误，应用程序在不应该创建线程时创建线程。

让原始海报让我们知道他/她发现了有关服务器崩溃问题的信息，这将是一个有趣的后续行动。我觉得这与此无关……但从发布的信息中很难判断。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-03-08T12:52:46.540

执行 Linq 查询会产生额外的线程。当我尝试在即时窗口中执行使用 Linq 查询集合的代码时，它经常拒绝运行，因为调试器没有足够的线程可用。

正如其他人所说，线程完成后退出是完全正常的。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-11-30T06:33:32.463

停止这个错误你必须按照这个简单的步骤

1.  打开 Visual Studio
2.  从顶部选择选项调试
3.  选择选项
4.  在调试下的选项选择调试中选择常规
5.  在常规选择复选框“调试停止时自动关闭控制台”
6.  保存

然后使用快捷键 Ctrl+f5 运行代码

**否则直接运行时它仍然显示错误

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2020-01-30T10:57:48.843

我也遇到过这个问题，解决方法是：

1.  打开解决方案探索
2.  双击 Program.cs 文件

我再次添加了这段代码，我的程序运行准确：

```
Application.Run(new PayrollSystem()); 
//File name this code removed by me accidentally. 
```

# https - How secure is https?

> ID：12410549
> 
> 赞同：1
> 
> 时间：2012-09-13T16:14:25.617
> 
> 标签：https, security

I have recently been looking into HTTPS, and just how secure it is.

I went to an https site which had a valid certificate and entered my username and password. Using **Fiddler**, I decrypted the requests which appeared after clicking the submit button, and there was my username and password in plain text in a string containing key-value pairs (this wasn't the querystring, it was the post values).

Can anyone enlighten me as to why HTTPS is said to be secure when it is this easy for me to get the username and password using an external application? I mean it was pretty much instant decryption, and surely a hacker could use an application to find out what requests you're making and decrypt them, can't they?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-13T16:28:16.487

HTTPS 是一种相当安全的点对点通信方式，中间的任何人都无法监听。

Fiddler 可以解密流量的原因是它可以控制您的浏览器信任哪些证书。证书基本上是“保证”，您正在与之交谈的网站就是它声称的身份，并且由于 Fiddler 可以将自己的证书放入浏览器，它可以让浏览器相信它是*任何*网站。

通常，浏览器只有来自证书颁发机构（如 Verisign、Thawte、Geotrust）的证书，他们的工作是验证每个站点实际上是他们所说的那个人。只要您信任证书颁发机构（[他们犯了错误](http://www.eweek.com/c/a/Security/Fake-Google-SSL-Certificate-Emerges-With-Ability-to-Hijack-User-Accounts-270126/)）并且没有人向您的浏览器添加假证书，您几乎可以相信没有人在监听。

如果您正在寻找“数学上安全”的东西，HTTPS 不是。为了易于建立通信，您仍然必须信任*其他*人，而不是连接另一端的人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T21:23:41.770

我完全同意 Joachim Isaksonn 的观点。只想添加几件事：

1) SSL 安全性取决于所使用的 RSA 密钥的长度。更长的密钥更安全。一般来说 1024 位在大多数情况下仍然足够好，2048 位是世界上所有资源的已知因式分解方法都无法破解的

[http://en.wikipedia.org/wiki/RSA_Factoring_Challenge](http://en.wikipedia.org/wiki/RSA_Factoring_Challenge)

2) SSL 安全性也取决于用户。如果您访问某个网站并显示“证书不匹配”并且您单击忽略，那么您就有麻烦了（与 Fiddler 可以解密流量的原因相同）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-14T14:54:54.530

由于您使用 Fiddler 取得的成就，您似乎对 HTTPS 持怀疑态度。我会尽量简明扼要地回答你问题的那一部分。

您之所以能够做到这一点，是因为您在 Fiddler 是**MiTM**的地方对自己发动了中间人攻击。您一定已经注意到浏览器会发出关于证书不安全的警告。该证书实际上是 Fiddler 自己的证书。因此，您的浏览器连接到 fiddler，fiddler 连接到预期的服务器，Fiddler 中继流量（就像**代理**一样）。这正是您能够看到流量的原因。您的浏览器使用 Fiddler 的公钥加密数据，而 fiddler 使用其私钥解密数据以显示给您。这与“HTTPS”不安全无关。只要用户足够小心地接受浏览器发出的警告，HTTPS 就可以被认为是安全的。一如既往，**这里最薄弱的环节**是用户。

# c# - 基于 32 位或 64 位的不同结构属性

> ID：12410555
> 
> 赞同：7
> 
> 时间：2012-09-13T16:15:05.333
> 
> 标签：c#

有没有办法可以有条件地将属性应用于结构？

如果机器是**32bit**我想应用这个属性

`[StructLayout(LayoutKind.Sequential, Pack = 2, CharSet = CharSet.Unicode)]`

如果机器是**64bit**我想应用这个属性

`[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]`

或者，我可以在属性中替换一个值...

**32 位**（包 = 2）

`[StructLayout(LayoutKind.Sequential, Pack = 2, CharSet = CharSet.Unicode)]`

**64 位**（包 = 8）

`[StructLayout(LayoutKind.Sequential, Pack = 8, CharSet = CharSet.Unicode)]`

我尝试使用此[示例](http://msdn.microsoft.com/en-us/library/z919e8tw%28v=vs.80%29.aspx)，但它用于自定义属性，而不是现有属性。

**更新：**

*   我想介绍“任何 CPU”
*   该属性用于[SHFILEOPSTRUCT](http://msdn.microsoft.com/en-us/library/windows/desktop/bb759795%28v=vs.85%29.aspx)，取决于处理器使用或。
*   我不想编译两个版本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T16:26:26.770

好问题。

我首先想到的答案是预处理器指令和 32 位和 64 位编译程序集。您可以使用相同的代码，甚至是相同的项目，只需根据目标系统以两种方式构建和部署它：

```
#ifdef Bit32
[StructLayout(LayoutKind.Sequential, Pack = 2, CharSet = CharSet.Unicode)]
#endif
#ifdef Bit64
[StructLayout(LayoutKind.Sequential, Pack = 8, CharSet = CharSet.Unicode)]
#endif 
```

这将需要根据目标架构为您的项目定义 Bit32 和 Bit64 编译常量，并且可能会构建您的应用程序两次。

如果您想在运行时执行此操作，我认为除非您在运行时动态发出整个类，否则这是不可能的。属性可能只有常量数据，它们不能在运行时有条件地应用（预处理器指令在编译时运行，而不是运行时）。

我能想到的唯一另一种方法是将类定义复制到两个命名空间中，并根据 Environment.Is64BitOperatingSystem 属性有条件地使用其中一个。您可以使用该属性有条件地控制您实例化哪个类，或者您选择哪种创建策略（使用哪种工厂方法或相关模式），但您不能在运行时有条件地控制属性；它们的信息作为元数据静态编译到程序集清单中。运行时本身特别使用此属性来定义它如何将对象的成员存储为堆数据，并且您永远不会真正在用户代码中查找此属性并使用它来定义行为（因此忽略或指定条件 Pack运行时的值）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:26:56.543

创建两个不同的构建目标（一个用于 32 位，一个用于 64 位），为每个目标添加一个条件编译符号（一个为 x86，另一个为 x86_64）并`#ifdef`在结构定义周围使用 's。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:23:39.083

我不认为你能做到这一点。只需有 2 个结构，并提供一种将两者转换为共享结构或类以进行处理的方法......

注意：您要求的功能非常奇怪（基于运行时发生的 JIT 类型的不同显式结构布局）。在大多数情况下，这用于匹配某些著名的固定协议的字节的物理布局，而与应用程序的比特性无关。您可以将您的案例视为 x86/x64 案例有 2 个不同的协议/互操作，并对 2 个结构感到满意。

# firefox - css3border-image firefox 15.0.1（第二轮）

> ID：12410562
> 
> 赞同：0
> 
> 时间：2012-09-13T16:15:40.967
> 
> 标签：firefox, background, css

关于这个问题：[css3 border-image firefox 15.0.1](https://stackoverflow.com/questions/12385269/css3-border-image-firefox-15-0-1)

我解决了新版本的 firefox (15.0.1) 的问题，现在边框图像功能去了。但是出现了一个新问题。内容未填充图像。

在所有浏览器中，背景都是用边框图像填充的，新版本的 Firefox 除外。

我的课：

```
border-style: solid none solid solid;
border-width: 12px 0 12px 12px;

border-image: url("img/contents-entry.png") 12 0 12 12 stretch; /* CSS3 recommendation */
-moz-border-image: url("img/contents-entry.png") 12 0 12 12 stretch stretch; /* old Firefox */
-o-border-image: url("img/contents-entry.png") 12 0 12 12 stretch; /* Opera */
-webkit-border-image: url("img/contents-entry.png") 12 0 12 12 stretch; /* Safari */

background-color: transparent; 
```

谢谢

更新：这是我在[http://jsfiddle.net/angelcervera/8YWXs/](http://jsfiddle.net/angelcervera/8YWXs/)中的测试：

```
div {
border-width:15px;
width:250px;
padding:10px 20px;
background-color: red;
}

#round {
border-style: solid;
border-image:url("http://www.norabrowndesign.com/css-experiments/images/border1.png") fill 30 30 30 30 stretch;
-moz-border-image:url("http://www.norabrowndesign.com/css-experiments/images/border1.png") 30 30 30 30 stretch; /* Firefox */
-webkit-border-image:url("http://www.norabrowndesign.com/css-experiments/images/border1.png") 30 30 30 30 stretch; /* Safari */
-o-border-image:url("http://www.norabrowndesign.com/css-experiments/images/border1.png") 30 30 30 30 stretch; /* Opera */
} 
```

我补充说：

*   **背景颜色：红色；**在 div 样式中区分白色背景页面和 div 背景。
*   **边框样式：实心；border-image:url("border.png") 填充 30 30 30 30 拉伸；**在 #round 样式中可以在 Firefox 中工作，但不能填充。
*   我用不透明的图像更改了图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T07:19:47.030

正如我在另一个问题中所说，您需要：

```
border-image: url("img/contents-entry.png") fill 12 0 12 12 stretch; 
```

如果要填充框的中心区域。见[http://www.w3.org/TR/css3-background/#border-image-slice](http://www.w3.org/TR/css3-background/#border-image-slice)

# asp.net-mvc - ASP.NET MVC WIZARD : Passing the entry ID but keeping the app safe for all users

> ID：12410563
> 
> 赞同：0
> 
> 时间：2012-09-13T16:15:43.497
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, wizard

Guys i'have a question.

I'm currently buiding a wizard that has 5 step's until being completed.

The user starts by the first step where he generates the entry id. From there on i start passing the id over the url like this:

```
host.com/{controller}/{view}/{id} 
```

This is how my url looks like after the step1, ------- currently at view step2 passing the id=120

```
host.com/{controller}/step2/120 
```

This isn't safe because as you know, anyone can change the id and affect other users's entries. Ofc, it can be quickly solved by reading if the authenticated user is proprietary of the entry that he must be trying to access in each view.

Now, my question is... is there a better way to do this? Any tips for future work? Is what i'm doing enougth? (begginer doubt praying for a expert awnser) Cheers

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:19:24.343

如果您真的担心用户更改 URL 中的 ID，那么您必须花费额外的时间添加类似“isOwnedBy”的功能。

作为一项额外的安全措施，您可以通过表单中的隐藏变量传递它，因此至少也不容易更改。

编辑：我也喜欢@LeffeBrune 关于加密这个想法的建议。但是，我仍然建议对函数执行验证以确保用户拥有该对象。这只是一个好习惯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:55:31.613

> ...可以通过读取经过身份验证的用户是否拥有他必须在每个视图中访问的条目的所有权来快速解决。

是的，这是真的。你应该从那里开始。

以下是您可以做的其他一些事情：

1.  您可以[将您的条目 id 设置为 Guid](https://stackoverflow.com/a/2043199/109941)，以便潜在的黑客永远不会尝试猜测条目 id。
2.  因为[对敏感数据使用 GET 是一个坏主意](https://stackoverflow.com/a/323286/109941)，所以您可以[像 endyourif 建议](https://stackoverflow.com/questions/12410563/asp-net-mvc-wizard-passing-the-entry-id-but-keeping-the-app-safe-for-all-users/12410618#12410618)的那样，传递带有隐藏字段的条目 ID。

# javascript - Is onfling available for html, html5

> ID：12410569
> 
> 赞同：0
> 
> 时间：2012-09-13T16:16:00.997
> 
> 标签：javascript, html

Is onfling or onpan available for html, html5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:20:34.983

不，这些不是 HTML5 的一部分。

我认为它们是特定于 Android 的。

可以在此处找到 HTML5 事件列表：

[http://www.w3schools.com/html5/html5_ref_eventattributes.asp](http://www.w3schools.com/html5/html5_ref_eventattributes.asp)

# image - Why are colors inverted when uploading a CMYK JPEG in Coldfusion?

> ID：12410570
> 
> 赞同：1
> 
> 时间：2012-09-13T16:16:05.470
> 
> 标签：image, file, coldfusion, upload, cmyk

I'm running `Coldfuison8` and have trouble with an image file upload, where I seem to often end up with users trying to upload CMYK JPEG files.

While the upload works fine (I don't get any errors) and `isImageFile` also returns `yes`, the colors of the loaded image are distorted.

Only doing this already saves the wrong colored image to the server:

```
<cffile result="temp" 
        action="upload" 
        accept="image/jpeg,image/jpg" 
        filefield="Dateiname8" 
        destination="#variables.tempDirectory#" 
        nameconflict="overwrite" /> 
```

**Question:**
If `isImageFile` does not produce an error, Coldfusion correctly identifies the image. What do I need to do to display it correctly?

**EDIT1:**
By distorted I mean, the file looks like this:

![enter image description here](../Images/3d74f23a31494245e2e42c9f0067efae.png)

and ends up like this:

![enter image description here](../Images/ae5c1df04d50dc725a514e640f4b6c98.png)

**EDIT2:**

```
<cfhttp timeout="45" 
    throwonerror="no" 
    url="#LOCAL.testFilePath#" 
    method="get" 
    useragent="Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.8.1.12) Gecko/20080201 Firefox/2.0.0.12"
    getasbinary="yes" 
    result="LOCAL.objGet">
<cfset LOCAL.objImage = ImageNew(LOCAL.objGet.FileContent)>
<cfset LOCAL.ext = ".png">
<cfset LOCAL.basePath = LOCAL.tempDirectory & "_base_" & LOCAL.file & LOCAL.ext>
<cfset imageWrite( LOCAL.objImage, LOCAL.basePath, ".99")> 
```

So, I'm splitting the filename into `file` and `ext` and then replace the extension with `.png`. The file gets created, but has 0 file size with the error thrown.

Any idea what might be causing this?

**EDIT3:**
Here is my script using `imageMagick`:

```
<cffile result="temp" action="upload" accept="image/jpeg,image/jpg" filefield="Dateiname8" destination="#variables.tempDirectory#" nameconflict="overwrite" />
<cfset variables.testFilePath = variables.tempDirectory & temp.serverFile>
<!--- imageMagick for CMYK uploads --->
<cftry>
    <cfimage action="info" source="#variables.testFilePath#" structname="cmyk" />
        <cfcatch type="any">
            <cftry>
                <cfexecute name="#expandpath("../tools/imageMagick/convert.exe")#" arguments="#variables.testFilePath# -strip -colorspace rgb -quality 100 #variables.testFilePath#" timeout="30" variable="msg" />
                <cfcatch>
                    <cfdump output="dump.txt" label="catch" var="type: #cfcatch.type#">
                    <cfdump output="dump.txt" label="catch" var="message: #cfcatch.message#">
                    <cfdump output="dump.txt" label="catch" var="detail: #cfcatch.detail#">
               </cfcatch>
            </cftry>
        </cfcatch>
    </cftry>
    <!--- Image can now be read --->
    <cfimage action="info" source="#variables.testFilePath#" structname="cmyk" /> 
```

ImageMagick ran fine, but the image was still tainted. I then tried this:

```
<cfset variables.testFilePath = variables.tempDirectory & temp.serverFile>
<cfset variables.try = ImageRead( variables.testFilePath )>
<cfset ImageNegative( variables.try )>
<cfset ImageWrite( variables.try, variables.testFilePath, "0.99")> 
```

And it created the correct image. Only problem is how to check for CMYK on the original image. Then I wouldn't need to use ImageMagick.

**EDIT4:**
And this is the full error I'm getting when trying to save the image as a png

```
Detail: Ensure that the file is a vaild image file.
Message: ColdFusion was unable to create an image from the specified source file.
StackTrace: coldfusion.image.ImageReader$UnableToCreateImageException: ColdFusion was unable to create an image from the specified source file.
at coldfusion.image.ImageReader.readImage(ImageReader.java:114)
at coldfusion.image.Image.<init>(Image.java:236)
at coldfusion.runtime.CFPage.ImageRead(CFPage.java:5841)
at cfform_img_handler2ecfc1184626149$funcUPLOAD.runFunction(E:123)
at coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:418)
at coldfusion.filter.SilentFilter.invoke(SilentFilter.java:47)
at coldfusion.runtime.UDFMethod$ArgumentCollectionFilter.invoke(UDFMethod.java:324)
at coldfusion.filter.FunctionAccessFilter.invoke(FunctionAccessFilter.java:59)
at coldfusion.runtime.UDFMethod.runFilterChain(UDFMethod.java:277)
at coldfusion.runtime.UDFMethod.invoke(UDFMethod.java:463)
at coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:453)
at coldfusion.runtime.TemplateProxy.invoke(TemplateProxy.java:320)
at coldfusion.runtime.CfJspPage._invoke(CfJspPage.java:2222)
at coldfusion.tagext.lang.InvokeTag.doEndTag(InvokeTag.java:358)
at cfhs_herstellerprofil2ecfm1153584487._factor19(E:559)
at cfhs_herstellerprofil2ecfm1153584487._factor21(E:514)
at cfhs_herstellerprofil2ecfm1153584487._factor22(E:511)
at cfhs_herstellerprofil2ecfm1153584487._factor41(E:502)
at cfhs_herstellerprofil2ecfm1153584487.runPage(E:1)
at coldfusion.runtime.CfJspPage.invoke(CfJspPage.java:196)
at coldfusion.tagext.lang.IncludeTag.doStartTag(IncludeTag.java:483)
at coldfusion.filter.CfincludeFilter.invoke(CfincludeFilter.java:65)
at coldfusion.filter.ApplicationFilter.invoke(ApplicationFilter.java:282)
at coldfusion.filter.RequestMonitorFilter.invoke(RequestMonitorFilter.java:48)
at coldfusion.filter.MonitoringFilter.invoke(MonitoringFilter.java:40)
at coldfusion.filter.PathFilter.invoke(PathFilter.java:86)
at coldfusion.filter.ExceptionFilter.invoke(ExceptionFilter.java:70)
at coldfusion.filter.BrowserDebugFilter.invoke(BrowserDebugFilter.java:74)
at coldfusion.filter.ClientScopePersistenceFilter.invoke(ClientScopePersistenceFilter.java:28)
at coldfusion.filter.BrowserFilter.invoke(BrowserFilter.java:38)
at coldfusion.filter.NoCacheFilter.invoke(NoCacheFilter.java:46)
at coldfusion.filter.GlobalsFilter.invoke(GlobalsFilter.java:38)
at coldfusion.filter.DatasourceFilter.invoke(DatasourceFilter.java:22)
at coldfusion.filter.RequestThrottleFilter.invoke(RequestThrottleFilter.java:126)
at coldfusion.CfmServlet.service(CfmServlet.java:198)
at coldfusion.bootstrap.BootstrapServlet.service(BootstrapServlet.java:89)
at jrun.servlet.FilterChain.doFilter(FilterChain.java:86)
at coldfusion.monitor.event.MonitoringServletFilter.doFilter(MonitoringServletFilter.java:42)
at coldfusion.bootstrap.BootstrapFilter.doFilter(BootstrapFilter.java:46)
at jrun.servlet.FilterChain.doFilter(FilterChain.java:94)
at jrun.servlet.FilterChain.service(FilterChain.java:101)
at jrun.servlet.ServletInvoker.invoke(ServletInvoker.java:106)
at jrun.servlet.JRunInvokerChain.invokeNext(JRunInvokerChain.java:42)
at jrun.servlet.JRunRequestDispatcher.invoke(JRunRequestDispatcher.java:286)
at jrun.servlet.ServletEngineService.dispatch(ServletEngineService.java:543)
at jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService.java:203)
at jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320)
at jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428)
at jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266)
at jrunx.scheduler.WorkerThread.run(WorkerThread.java:66)
TagContext:  ...    
Type: Application 
```

[object of coldfusion.image.ImageReader$UnableToCreateImageException] Class Name: coldfusion.image.ImageReader$UnableToCreateImageException

Parent Class: [object of coldfusion.image.ImageException] Class Name: coldfusion.image.ImageException

```
Parent Class: [object of coldfusion.runtime.ApplicationException]
    Class Name: coldfusion.runtime.ApplicationException
    Parent Class: [object of coldfusion.runtime.NeoException]
        Class Name: coldfusion.runtime.NeoException
        Methods:  
            findAdvancedCFTarget(coldfusion.runtime.AdvancedCFException, java.lang.String[]) returns int 
            findCustomTarget(coldfusion.runtime.CustomException, java.lang.String[]) returns int 
            findThrowableTarget(java.lang.Throwable, java.lang.String[]) returns int 
            getDetail() returns java.lang.String 
            getLocalizedMessage() returns java.lang.String 
            getMessage() returns java.lang.String 
            getRootCause() returns java.lang.Throwable 
            getString(java.lang.Throwable, java.lang.String, java.util.Locale) returns java.lang.String 
            getType() returns java.lang.String 
            setLocale(java.util.Locale) returns void 
            unwrap(java.lang.Throwable) returns java.lang.Throwable
        Parent Class: [object of java.lang.RuntimeException]
            Class Name: java.lang.RuntimeException
            Parent Class: [object of java.lang.Exception]
                Class Name: java.lang.Exception
                Parent Class: [object of java.lang.Throwable]
                    Class Name: java.lang.Throwable
                    Methods:  
                        fillInStackTrace() returns java.lang.Throwable 
                        getCause() returns java.lang.Throwable 
                        getLocalizedMessage() returns java.lang.String 
                        getMessage() returns java.lang.String 
                        getStackTrace() returns java.lang.StackTraceElement[] 
                        initCause(java.lang.Throwable) returns java.lang.Throwable 
                        printStackTrace(java.io.PrintWriter) returns void 
                        printStackTrace(java.io.PrintStream) returns void 
                        printStackTrace() returns void 
                        setStackTrace(java.lang.StackTraceElement[]) returns void 
                        toString() returns java.lang.String 
```

# php - PHP Firebird API：php_interbase 还是 PDO？

> ID：12410574
> 
> 赞同：5
> 
> 时间：2012-09-13T16:16:14.930
> 
> 标签：php, pdo, firebird

我们在新脚本中使用 PDO 已经 2 年了，以连接到我们的 MySQL、PostgreSQL 和 SQLite 数据库。

我们现在开始一个项目，我们需要在其中读取（可能还有一些简单的更新）一个 Firebird 2.5 数据库文件。我想使用 PDO，因为我们已经使用了它，而且它不会是一个过渡。然而[PDO_FIREBIRD PECL](http://pecl.php.net/package/PDO_FIREBIRD)包似乎最后一次更新是在 2006 年。

所以我的问题是：在新项目中使用 PDO Firebird 驱动程序或 php_interbase API 更好吗？即 PDO Firebird 驱动程序是否值得生产？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:21:04.387

如果您从 PHP 的主存储库中使用 PDO Firebird 是稳定的 您应该使用 PHP 附带的扩展而不是 PECL 扩展 这是去年的 PDO 健康状况[http://www.firebirdnews.org/?p= 6619](http://www.firebirdnews.org/?p=6619) 从那时起修复了许多错误，因此您可以尝试并滥用它。PECL 的版本多年**未更新，但我会尽快处理它**[https://bugs.php.net/bug.php?id=58824](https://bugs.php.net/bug.php?id=58824)

当然 php_ibase api 更老，并且在生产系统中经过多年的良好测试（从 php3 ~ 1998 的旧时代）

# wpf - WPF：处理大量路由事件

> ID：12410577
> 
> 赞同：0
> 
> 时间：2012-09-13T16:16:21.000
> 
> 标签：wpf

对于以下问题，我需要您的建议：

假设您有一个 MyView 类型 (UserControl)，它定义了一个路由事件 IsSelectedChanged。每次更改 myView.IsSelected 属性值时都会引发它。

此外，您有一个 MyContainer (Canvas)，其中包含非常（非常！）大量 MyView 类型的子项。MyContainer 已路由事件 MyViewsSelectionChanged，每当 MyViewsSelection 发生更改时都会引发该事件。MyViewsSelection 是一组 MyView 对象，其 IsSelected 属性设置为**true**。MyContainer 将为每个孩子处理 MyView.IsSelectedChanged 并将其 MyViewSelection 状态提供给 MyContainerParent（面板）

MyContainerParent 将处理 myContainer.MyViewsSelectionChanged 事件

我担心的问题是，我的应用程序对于大量 MyView 对象的选择会表现不佳，从而导致某种“野火”事件。

任何防止该问题的建议，将不胜感激！

谢谢

**一些代码：**

BatchView.IsSelectedChanged (MyView)：

```
public static readonly RoutedEvent IsSelectedChangedEvent = EventManager.RegisterRoutedEvent(
        "IsSelectedChanged", 
        RoutingStrategy.Direct, 
        typeof(RoutedEventHandler), 
        typeof(BatchView)
    );
/// <summary>
/// Occurs when IsSelected property value is changed.
/// </summary>
public event RoutedEventHandler IsSelectedChanged {
        add { AddHandler(IsSelectedChangedEvent, value); }
        remove { RemoveHandler(IsSelectedChangedEvent, value); }
    }
void RaiseIsSelectionChangedEvent() {
        RoutedEventArgs e = new RoutedEventArgs(IsSelectedChangedEvent, this.BatchViewModel);
        RaiseEvent(e);
        Logger.Debug("IsSelectionChanged: {0}; IsSelected = {1}", this.BatchViewModel.Description, this.IsSelected);
    }
public static readonly DependencyProperty IsSelectedProperty = DependencyProperty.RegisterAttached(
        "IsSelected",
        typeof(bool),
        typeof(BatchView),
        new FrameworkPropertyMetadata(false, FrameworkPropertyMetadataOptions.AffectsRender | FrameworkPropertyMetadataOptions.BindsTwoWayByDefault, new PropertyChangedCallback(delegate(DependencyObject sender, DependencyPropertyChangedEventArgs args) {
        BatchView view = sender as BatchView;
        bool isSelected = Convert.ToBoolean(args.NewValue);
        if ( view != null ) {
            view._border.BorderBrush = isSelected ? Brushes.Magenta : Brushes.Black;
            view.IsPrimarySelected = view.IsFocused && isSelected;
        }
    })));
/// <summary>
/// Get/set whether this batch view is selected
/// </summary>
public bool IsSelected {
        get { return (bool)GetValue(IsSelectedProperty); }
        set {
            if ( IsSelected != value ) {
                SetValue(IsSelectedProperty, value);
                RaiseIsSelectionChangedEvent();
            }
        }
    } 
```

甘特视图（MyContainer）：

```
static GanttView() {
        EventManager.RegisterClassHandler(typeof(BatchView), BatchView.IsSelectedChangedEvent, new RoutedEventHandler(delegate(object sender, RoutedEventArgs args) {
            var batchView = sender as BatchView;
            var ganttView = batchView.FindVisualParent<GanttView>();
            if ( ganttView != null ) {
                ganttView.RaiseBatchViewsSelectionChangedEvent();
            }
            args.Handled = true;
        }));
    }

public static readonly RoutedEvent BatchViewsSelectionChangedEvent = EventManager.RegisterRoutedEvent(
        "BatchViewsSelectionChanged",
        RoutingStrategy.Direct,
        typeof(RoutedEventHandler),
        typeof(GanttView)
    );
public event RoutedEventHandler BatchViewsSelectionChanged {
        add { AddHandler(BatchViewsSelectionChangedEvent, value); }
        remove { RemoveHandler(BatchViewsSelectionChangedEvent, value); }
    }
void RaiseBatchViewsSelectionChangedEvent() {
        RoutedEventArgs e = new RoutedEventArgs(BatchViewsSelectionChangedEvent, this);         
        RaiseEvent(e);
        Logger.Debug("BatchViewsSelectionChanged: {0};", this.SelectedBatchViews.Count());
    } 
```

调度器视图（MyContainerParent）：

```
static SchedulerView() {
        EventManager.RegisterClassHandler(typeof(GanttView), GanttView.BatchViewsSelectionChangedEvent, new RoutedEventHandler(delegate(object sender, RoutedEventArgs args) {              
            var schedulerView = ((GanttView)sender).FindVisualParent<SchedulerView>();
            if ( schedulerView != null ) {
                if ( schedulerView.BatchesSelectionChanged != null ) {
                    BatchesSelectionChangedEventArgs e = new BatchesSelectionChangedEventArgs();
                    e.SelectedBatchesCount = schedulerView.GanttView.SelectedBatchViews.Count();
                    e.TotalBatchesDuration = schedulerView.GanttView.SelectedBatchViews.Sum<BatchView>(bv => bv.BatchViewModel.Model.Duration);
                    e.TotalBatchesQuantity = schedulerView.GanttView.SelectedBatchViews.Sum<BatchView>(bv => bv.BatchViewModel.Model.Quantity);
                    schedulerView.BatchesSelectionChanged(schedulerView, e);
                }
            }
        }));
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T11:47:05.243

如果您担心必须处理的事件数量。你应该重新评估你的方法。有没有办法确定用户何时完成选择项目？

如果没有办法减少事件的数量，那么您可能想要实施节流阀，即仅在一段时间内没有收到任何事件时才处理事件。

您可以自己实现这一点 - 例如通过使用计时器 - 或者您可以使用响应式扩展的 (RX) Throttle 功能。

> 节流“忽略来自可观察序列的值，这些值在指定源和到期时间的到期时间之前跟随另一个值”

[您可以在http://msdn.microsoft.com/en-us/data/gg577609.aspx](http://msdn.microsoft.com/en-us/library/hh229298%28v=vs.103%29)找到 RX，在[http://msdn.microsoft.com/en-us/library/hh229298%28v](http://msdn.microsoft.com/en-us/data/gg577609.aspx)找到Trottle 的文档[=vs.103%29](http://msdn.microsoft.com/en-us/library/hh229298%28v=vs.103%29)。显然你也可以通过 NuGet 安装 RX。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:38:58.510

我想分享我的问题的解决方案。解决方案基于我的经理和 Obalix 给出的建议。因此，我将使用一个计时器来稍微延迟 GanttView.BacthViewsSelectionChangedEvent 的引发。

```
static GanttView() {            
    EventManager.RegisterClassHandler(typeof(BatchView),   BatchView.IsSelectedChangedEvent, new RoutedEventHandler(delegate(object sender, RoutedEventArgs args) {
            var batchView = sender as BatchView;
            var ganttView = batchView.FindVisualParent<GanttView>();
            if ( ganttView != null && !ganttView._batchViewIsSelectedChangedEventQueued ) {
                ganttView._batchViewIsSelectedChangedEventQueued = true;
                System.Timers.Timer eventTrigger = new System.Timers.Timer(100) { AutoReset = false };
                eventTrigger.Start();
                eventTrigger.Elapsed += new System.Timers.ElapsedEventHandler(delegate(object timer, System.Timers.ElapsedEventArgs e) {
                    ganttView._batchViewIsSelectedChangedEventQueued = false;
                    ganttView.Dispatcher.Invoke(new Action(delegate() { ganttView.RaiseBatchViewsSelectionChangedEvent(); }), DispatcherPriority.Normal, null);
                });             
            }
            args.Handled = true;
        }));
} 
```

使用 Dispatcher 属性调用 ganttView.RaiseBatchViewsSelectionChangedEvent() 很重要，否则会出现异常（“调用线程无法访问此对象，因为不同的线程拥有它。”），请参考这篇文章 http:// /www.switchonthecode.com/tutorials/working-with-the-wpf-dispatcher

Dan 和 Obalix，非常感谢您的时间和考虑！

# php - Symfony 2 带有文件类型的表单集合字段

> ID：12410578
> 
> 赞同：14
> 
> 时间：2012-09-13T16:16:21.200
> 
> 标签：php, symfony, twig

我想通过 POST 请求（不带 Ajax）上传多个文件。我可以将 Symfony 2 的表单集合字段与这样的文件类型一起使用：

实体中的代码：

```
public $pictures;

public function __construct()
{
    $this->pictures = new \Doctrine\Common\Collections\ArrayCollection();
} 
```

表单类中的代码：

```
$builder->add('pictures', 'collection', array(
        'type' => 'file',
        'required' => false,
        'attr' => array(
            'multiple' => 'multiple'
        )
)); 
```

树枝中的代码：

```
{% for picture in form.pictures %}
    <td>
        {{ form_widget(picture) }}
    </td>
{% endfor %} 
```

我试过了，但它似乎不起作用。它没有显示任何错误，但也没有显示输入文件。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-27T22:03:13.723

要实际呈现输入类型，您需要将集合中的 allow_add 选项设置为 true，并使用集合的表单原型、javascript 和按钮来添加文件字段。

基于文档的示例（[集合-添加和删除](http://symfony.com/doc/2.0/reference/forms/types/collection.html#adding-and-removing-items)）

表格：

```
<form action="..." method="POST" {{ form_enctype(form) }}>
{# ... #}

{# store the prototype on the data-prototype attribute #}
<ul id="image-container" class="collection-container" data-prototype="{{ form_widget(form.images.vars.prototype) | e }}">
{% for imageField in form.images%}
    <li>
        {{ form_widget(imageField) }}
    </li>
{% endfor %}
</ul>

<a href="#" class="collection-add" data-collection="image-container">Add image</a>

</form> 
```

剧本：

```
<script type="text/javascript">
  var imageCount;

  jQuery(document).ready(function() {
    $(document).on('click', '.collection-add', function () {
        var $collectionContainer = $('#' + $(this).data('collection'));
        if(!imageCount){imageCount = $collectionContainer.children().length;}
        var prototype = $collectionContainer.attr('data-prototype');
        var item = prototype.replace(/__name__/g, imageCount);
        $collectionContainer.append(item);
        imageCount++;
    });
  })
</script> 
```

这只是一个想法，根据您的需要还有很多工作要做。如果这不是您想要的，也许您可​​以调用添加按钮单击作为解决方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-05-17T20:07:18.043

如果您想显示多个输入字段，不，它不起作用。集合类型要求您在呈现字段之前提供一些数据。我已经尝试过了，并想出了创建一个单独的实体（例如文件）并添加与我的目标实体的关系。

例子：

```
class File
{
    // properties

    public $file; // this holds an UploadedFile object

    // getters, setters
} 
```

文件类型：

```
....

public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder
        ->add('file', 'file', [
            'required' => false
        ])
    ;
} 
```

产品：

```
class Product
{
    // properties

    private $images; // ManyToMany relationship

    // setters, getters
} 
```

产品类别：

```
->add('images', 'collection', [
    'type' => 'YOUR_FILE_TYPE_NAME',
    'by_reference' => false,
    'required' => false
]) 
```

产品控制器：

```
public function someAction()
{
    ...

    $image = new File();
    $product->addImage($image);

} 
```

我知道这个解决方案可能有点矫枉过正并创建了额外的表格，但它确实有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T18:39:31.257

您需要在集合中指定小部件的类型

看看：[http ://symfony.com/doc/2.0/reference/forms/types/collection.html](http://symfony.com/doc/2.0/reference/forms/types/collection.html)

```
$builder->add('pictures', 'collection', array(
  // each item in the array will be an "email" field
  'type'   => 'file',
  // these options are passed to each "email" type
  'options'  => array(
    'required'  => false,
  ),
)); 
```

为了进一步阅读，我建议

[http://symfony.com/doc/2.0/reference/forms/types/file.html](http://symfony.com/doc/2.0/reference/forms/types/file.html)

此外，您还需要向此集合添加 sth 以显示，因为在初始化时它将为空，就像在实体的构造函数中一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-13T14:57:45.567

表单类中的代码是正确的，但您还应该修改表单域的名称。`full_name`应该是你的`form[pictures][]`情况。

实际上，在 sf2.3 中似乎无法再修改表单字段名称，但在 sf2.4 中又可以了。

[https://github.com/bamarni/symfony/commit/35639824e864ed8d4a4cc0d8360f2c73ae08b507#commitcomment-3627879](https://github.com/bamarni/symfony/commit/35639824e864ed8d4a4cc0d8360f2c73ae08b507#commitcomment-3627879)

# service - 运行 Windows 服务时登录失败

> ID：12410588
> 
> 赞同：3
> 
> 时间：2012-09-13T16:16:54.883
> 
> 标签：service

我在 windows server 2012 上运行一个名为 prunner 的服务。我使用命令 sc 来更改服务的用户名和密码：

```
sc.exe config myService obj= "sqa265\hero" password= "hero1" 
```

命令的输出是说它已经成功但是当我去任务管理器以启动服务时，我得到：登录失败！！！

我尝试在用户 hero 和用户管理员下运行 sc 命令，但仍然遇到相同的错误。但非常奇怪的是，如果我通过任务管理器和服务控制面板手动执行相同的操作，我会成功并且服务进入状态：正在运行！！！但我需要自动化这件事，所以请帮忙？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-30T20:47:37.007

您需要为帐户“sqa265\hero”授予 SeServiceLogonRight 权限。正如您已经注意到通过控制面板设置凭据是可行的，但您可能没有注意到的是，如果您在使用控制面板后尝试使用命令行。

您可以通过在控制面板中将服务设置回本地系统帐户，然后再次运行命令行来测试这一点。

要通过脚本解决此问题，您可以使用此 MS 知识库文章中概述的 NTrights 实用程序：http: [//support.microsoft.com/kb/315276](http://support.microsoft.com/kb/315276)

安装 NT Rights 后，您可以像这样运行它：

```
NTRights.exe +r SeServiceLogonRight -u "sqa265\hero" 
```

结合您已有的 sc config 命令行，该服务应该使用这些凭据运行。

进一步阅读： [http ://www.techrepublic.com/article/set-user-rights-using-the-ntrights-utility/5032903](http://www.techrepublic.com/article/set-user-rights-using-the-ntrights-utility/5032903)

# objective-c - RestKit 在映射时混合了类

> ID：12410590
> 
> 赞同：2
> 
> 时间：2012-09-13T16:17:03.760
> 
> 标签：objective-c, ios, xcode, xcode4, restkit

我正在开发一个应用程序，该应用程序根据 Web 服务提供的信息创建表视图。我目前有两个表视图，一个用于“区域”，另一个用于“类别”，并且正在使用 RestKit 将 JSON 信息映射到适当的类。我有“区域”和“类别”类来保存每个项目的数据。如果它是要查看的第一个表，则每个表似乎都可以正常工作。但是，如果我查看一个表然后切换到另一个，程序会遇到异常。如果我在查看另一张表之前查看一张表，似乎将我的类别和区域类混淆了。

当我首先转到类别视图，然后转到区域视图时，我收到此异常：“由于未捕获的异常 'NSInvalidArgumentException' 导致应用程序终止，原因：'-[Category regionName]: unrecognized selector sent to instance 0x938f1a0'”

当我进入 Regions 视图，然后是 Categories 视图时，我看到以下内容：“由于未捕获的异常 'NSInvalidArgumentException' 导致应用程序终止，原因：'-[Region categoryName]: unrecognized selector sent to instance 0xce87240'”

这是相关的代码。我意识到这是很多代码，但我不知道我的问题出在哪里：

如果有人对出了什么问题有任何想法，我将不胜感激。谢谢！

分类查看：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    mCategoryId = [NSNumber numberWithInt:0];
    NSLog(@"Categories");

    RKURL *baseURL = [RKURL URLWithBaseURLString:@"My URL"];
    RKObjectManager *objectManager = [RKObjectManager objectManagerWithBaseURL:baseURL];
    objectManager.client.baseURL = baseURL;

    RKObjectMapping *categoryMapping = [RKObjectMapping mappingForClass:[Category class]];
    [categoryMapping mapKeyPathsToAttributes:@"categoryID", @"categoryID", @"parentID", @"parentID", @"categoryName", @"categoryName", @"childrenCount", @"childrenCount", @"parentCount", @"parentCount", @"catCount", @"catCount", nil];
    [objectManager.mappingProvider setMapping:categoryMapping forKeyPath:@""];

    [self sendRequest];

}

- (void) sendRequest {
    RKObjectManager *objectManager = [RKObjectManager sharedManager];
    NSError *error;
    NSData *jsonData = [NSJSONSerialization dataWithJSONObject:[NSDictionary dictionaryWithObject:mCategoryId forKey:@"CategoryId"] options:0 error:&error];

    [objectManager loadObjectsAtResourcePath:@"/api/Main/Process" usingBlock:^(RKObjectLoader *loader) {
        loader.params = [RKRequestSerialization serializationWithData:jsonData MIMEType:RKMIMETypeJSON];
        loader.method = RKRequestMethodPOST;
        loader.serializationMIMEType = RKMIMETypeJSON;

        NSDictionary *headers = [NSDictionary dictionaryWithObjectsAndKeys:@"application/json", @"Content-Type", @"Basic ClientIdentifier%3Afc_ios_client%2CEndpoint%3A%2FCategories%2FGetChildCategoriesById", @"Authorization", nil];
        loader.additionalHTTPHeaders = headers;
        loader.onDidLoadObjects = ^(NSArray *objects) {
            NSLog(@"Objects Loaded");
            categories = objects;
            [self.tableView reloadData];
        };
    loader.onDidFailWithError = ^(NSError *error) {
            NSLog(@"Error %@", [error localizedDescription]);  
        };
        NSLog(@"%@",[NSString stringWithFormat:@"%@%@", loader.URL.baseURL, loader.URL.relativePath]);
        loader = nil;
    }];
    objectManager = nil;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    Category *category = [[Category alloc] init];
    category = nil;
    category = [categories objectAtIndex:indexPath.row];
    NSLog(@"Category Cell");
    cell.textLabel.text = category.categoryName;
    NSLog(@"Cell returned");

    return cell;
} 
```

地区视图：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSLog(@"Region Listings Loading");

    mRegionId = [NSNumber numberWithInt:1];

    RKURL *baseURL = [RKURL URLWithBaseURLString:@"My URL"];
    RKObjectManager *objectManager = [RKObjectManager objectManagerWithBaseURL:baseURL];
    objectManager.client.baseURL = baseURL;

    RKObjectMapping *regionMapping = [RKObjectMapping mappingForClass:[Region class]];
    [regionMapping mapKeyPathsToAttributes:@"regionHome", @"regionHome", @"regionID", @"regionID", @"regionName", @"regionName", @"parentCount", @"parentCount", @"parentID", @"parentID", @"childrenCount", @"childrenCount", @"parentName", @"parentName", nil];
    [objectManager.mappingProvider setMapping:regionMapping forKeyPath:@""];

    NSLog(@"Mapping done");

    [self sendRequest];

}
- (void) sendRequest {

    RKObjectManager *objectManager = [RKObjectManager sharedManager];
    NSError *error;
    NSData *jsonData = [NSJSONSerialization dataWithJSONObject:[NSDictionary dictionaryWithObject:mRegionId forKey:@"RegionId"] options:0 error:&error];

    NSLog(@"JSON Data");

    [objectManager loadObjectsAtResourcePath:@"/api/Main/Process" usingBlock:^(RKObjectLoader *loader) {
        loader.params = [RKRequestSerialization serializationWithData:jsonData MIMEType:RKMIMETypeJSON];
        loader.method = RKRequestMethodPOST;
        loader.serializationMIMEType = RKMIMETypeJSON;

        NSDictionary *headers = [NSDictionary dictionaryWithObjectsAndKeys:@"application/json", @"Content-Type", @"Basic ClientIdentifier%3Afc_ios_client%2CEndpoint%3A%2FRegions%2FGetChildRegionsByIdWithBaseRegion", @"Authorization", nil];
        loader.additionalHTTPHeaders = headers;

        NSLog(@"Headers");

        loader.onDidLoadObjects = ^(NSArray *objects) {
            NSLog(@"Objects Loaded");
            regions = nil;
            regions = objects;
            [self.tableView reloadData];
        };
        loader.onDidFailWithError = ^(NSError *error) {
            NSLog(@"Error %@", [error localizedDescription]);  
        };
        NSLog(@"%@",[NSString stringWithFormat:@"%@%@", loader.URL.baseURL, loader.URL.relativePath]);
    }];

}
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    Region *region = [[Region alloc] init];
    region = nil;
    region = [regions objectAtIndex:indexPath.row];
    NSLog(@"region");
    cell.textLabel.text = region.regionName;

    return cell;
} 
```

# windows-mobile - 将 .net compact 框架转换为 activex

> ID：12410597
> 
> 赞同：2
> 
> 时间：2012-09-13T16:17:41.090
> 
> 标签：windows-mobile, compact-framework, activex, windows-mobile-6

我已经为面向 Windows Mobile 6.1 的手持式扫描仪创建了一个解决方案。现在我需要知道是否可以将此解决方案嵌入到 ActiveX 中以在 IE8（非移动设备）上运行。这是在手持设备不可用的情况下的备份。显然扫描功能不起作用，但除此之外，是否可以转换它？我不想管理相同代码的多个副本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T19:42:20.267

不，你不能。Compact Framework 不支持 EE Hosting，因此无法将 Compact Framework 的任何内容直接编译为 COM/ActiveX 对象。

您能否创建一个桌面 C# 项目，然后拉入代码文件并将其编译为 ActiveX 控件？这取决于你想做多少工作。至少，您必须为所有公开的类定义 COM 接口，并为每个属性添加属性，如 Guid、InterfaceType 和 ComVisible 以及 Didpid。您必须确保所有公开的类型都具有 COM 功能并且具有接口。试图保持该代码库仍然可编译，因为您现有的 CF 应用程序本身就是一个巨大的挑战。

当然，你会遇到任何 P/Invokes 的问题（这是一个非常罕见的不需要它们的 CF 应用程序）。您必须在另一个接口（或更多）中抽象它们。UI 级别的任何窗口处理都可能需要更改。

当您完成所有这些工作时，您可能会花费更多时间来完全重写浏览器的应用程序，并且它可能不会像重写那样工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T20:29:46.707

这似乎表明在某种程度上是可能的：

[http://www.dreamincode.net/forums/topic/38890-activex-with-c%23/](http://www.dreamincode.net/forums/topic/38890-activex-with-c%23/)

然而，我和另一位开发人员试图在移动浏览器上运行数周，但没有成功。我不知道是项目类型本身还是设备的限制，但它只是不想玩。

正如 ctacke 建议的那样，我会非常重视这个想法。ActiveX 是旧技术，将您限制在 IE 中。如果可以的话，我强烈建议以另一种方式这样做。

# tridion - Tridion 命令扩展如何找出它扩展的命令？

> ID：12410599
> 
> 赞同：2
> 
> 时间：2012-09-13T16:17:47.063
> 
> 标签：tridion

Tridion 的用户界面允许您扩展特定命令，这是修改某些现有命令的行为的好方法。在编辑器的配置文件中，这是通过如下部分完成的：

```
<ext:commands>
  <ext:command name="TextUnderline" extendingcommand="MyTextUnderline"/>
  <ext:command name="TextStrikethrough" extendingcommand="MyTextStrikethrough"/> 
```

我正在研究一个通用命令扩展类，可用于修改许多命令的行为：

```
<ext:commands>
  <ext:command name="TextUnderline" extendingcommand="MyCommandExtension"/>
  <ext:command name="TextStrikethrough" extendingcommand="MyCommandExtension"/> 
```

因此，在第二个配置片段中，我们对和进行了相同的`MyCommandExtension`扩展。`TextUnderline``TextStrikethrough`

但是现在在我的 JavaScript 中，我`MyCommandExtension`如何确定最初触发了哪个命令？

```
MyCommandExtension.prototype.isAvailable = function (selection, pipeline) {
  ...
  console.log(this.properties.name);
  ...
}; 
```

在这种情况下，`this.properties.name`将被记录为不太有用但完全正确：

> “禁用命令”

我怀疑该信息在`pipeline`参数中的某处可用，但尚未找到。

如何从中找出原始命令`MyCommandExtension`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:41:01.700

简短的回答：我不能。

我不得不做类似的事情，最终不得不扩展各种命令并将“当前”命令设置为我的“_execute”调用的一部分（所以我现在需要调用`_execute(selection, pipeline, originalCommand)`我的命令。

ñ

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T10:15:15.143

您无法找出原始命令是什么。假设是扩展命令特定于它扩展的命令，因此会知道它正在扩展哪个命令。在创建适用于不同命令的通用扩展时，我可以看到了解配置是多么有用。

也许您可以将此添加为增强请求？

要暂时解决它，您可以使用您的逻辑创建一个基本命令 - 它采用它作为参数扩展的命令的名称。然后为您要扩展的每个命令创建特定的类，只需调用基本命令并传入名称。

换句话说，使用所有必需的方法创建一个 BaseExtendingCommand - 然后创建一个 TextUnderlineExtendingCommand 和 TextStrikethroughExtendingCommand，它们调用 BaseExtendingCommand 上的方法（并分别传入“TextUnderline”和“TextStrikethrough”作为参数）

# c++ - 将 ptr_vector 与 malloc 一起使用

> ID：12410605
> 
> 赞同：0
> 
> 时间：2012-09-13T16:18:09.593
> 
> 标签：c++, c, boost

可以`ptr_vector`用`malloc`那个能自动释放内存的吗？

我问的原因是，我必须将指针推送到`ptr_vector`对象内部的结构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:30:42.660

如果您的意思是`boost::ptr_vector`它是设计使然，但是您需要使用 C++`new`语句而不是旧的好 C `malloc()/free()`。参见示例：

```
struct S { int i; double d; };
boost::ptr_vector<S> pv;

// pv now owns dynamic S instance and will destroy it when going out of scope
pv.push_back(new S());
pv[0].i = 42; // Using it as usual 
```

还有一些方法可以定义您自己的分配器，`std::allocator`以便它可以使用`malloc()/free()`，但看起来并不是您真正需要的。

# javascript - 隐藏的 iframe onload 事件

> ID：12410606
> 
> 赞同：0
> 
> 时间：2012-09-13T16:18:18.937
> 
> 标签：javascript, iframe, javascript-events

我在这里看到了一些关于 iframe onload 的类似问题，但没有什么对我有用。

我有一个隐藏的 iframe，仅用于用户下载在我的服务器上动态创建的 pdf。当用户单击按钮时，通过指向控制器/操作以及参数查询字符串在我的服务器上创建 pdf。

这很好用。但是，当他们按下此按钮（“BlockAndSpin”功能）时，我会显示一个微调器并禁用 UI。我想在下载 pdf 后打开隐藏微调器并重新启用 ui。

当我在 Chrome 和 FF 中调试时，我的 onload 方法永远不会被命中。我还尝试将 onload 属性添加到 iframe 本身，但这也不起作用。文件下载，但 UI 保持不变并且 onload 事件不会触发。

js

```
function downloadPOS(id) {
    var ifrm = document.getElementById(id)
    BlockAndSpin(true);
    ifrm.src = "/staticPOS/AddOrDownload" + GetPosQueryString();
    ifrm.onload = function () {
        BlockAndSpin(false);
    }
} 
```

html

```
<iframe id="dlFrame" onload="BlockAndSpin(false);" style="display: none"></iframe> 
```

显然这是做不到的。我的回应是用户下载了一个 .pdf 文件，并且没有将任何内容加载到 iframe 本身中，因此它永远不会触发事件。我将不得不重新审视这是如何完成的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T23:59:46.700

我遇到了一个类似的问题，附加到隐藏 iframe 上的消息。IE 似乎不喜欢使用“隐藏”（显示：无）iframe 进行跨域通信。

我的解决方法是将 iframe 设置为绝对位置，左侧值为 -9999px。然后它被有效地隐藏起来，你可以附加到它上面。

# android - 用户输入任何字符时如何替换文本字段中的文本

> ID：12410611
> 
> 赞同：0
> 
> 时间：2012-09-13T16:18:44.473
> 
> 标签：android, android-widget, textfield

在我的 android 应用程序中，我有一个文本字段，上面写着“你想拿多少钱”。

我希望文本自动删除并替换为用户在该文本字段中键入时输入的内容。

示例：如果用户输入一个字符，它会自动从文本字段中删除“你想拿多少”，并将其替换为输入的一个字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:21:40.083

在您的 xml 文件中使用

```
android:hint="how much would you like to take" 
```

在你的`TextView`定义中

（嗯，它应该类似于strings.xml中的`"@string/how_much"`那个`how_much`字符串，但老实说......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:22:24.283

它称为`android:hint`属性，`EditText`您可以将其设置到您的 xml 文件中。

类似的东西。

```
 <EditText
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:hint="how much would you like to take" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T16:23:59.457

在你的xml中试试这个

在下面的代码中使用它`android:hint="how much would you like to take"`

```
 <EditText
    android:id="@+id/edtName" 
    android:layout_width="fill_parent"      
    android:layout_height="wrap_content"    
    android:layout_below="@+id/txtName"     
    android:layout_marginRight="5dip" 
    android:hint="how much would you like to take" 
    android:inputType="textCapSentences"
    /> 
```

希望能帮助到你

# c# - 从 C# 发布到我的 Facebook 时间线

> ID：12410613
> 
> 赞同：3
> 
> 时间：2012-09-13T16:18:49.140
> 
> 标签：c#, facebook, winforms, oauth, dotnetopenauth

有人可以向我提供能够简单地将消息发布到我的 Facebook 页面所需的工作流程吗？根据我的阅读，DotNetOpenAuth 4.1 不支持 Facebook 的 OAuth 2.0 协议？如果有人对 OAuth2 库有更好的建议，我很想听听，如果您可以提供一个如何将消息发布到 Facebook 页面的示例，那就太好了！

此外，这是一个 Winforms 应用程序，而不是一个 Web 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T04:18:22.293

OAuth2 客户端非常简单，几乎不需要库。尝试在你的 winforms 应用程序中使用 HTTP 调用自己遵循 Facebook 文档，看看你是否可以让它工作。

对于像 winforms 这样的客户端应用程序，有时最棘手的部分可能是没有明显的重定向 URL。

DotNetOpenAuth 4.x 确实支持 Facebook（通过实现 FB 不符合规范的解决方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-04T00:28:32.103

我通常使用 ComputerBeacon 库。相当流畅

[http://computerbeacon.net/library/facebookgraphtoolkit](http://computerbeacon.net/library/facebookgraphtoolkit)

# python - 搜索模式（正则表达式）python

> ID：12410617
> 
> 赞同：0
> 
> 时间：2012-09-13T16:19:16.240
> 
> 标签：python, regex

我下载了这个工具（http://www3.telus.net/pfrank/）来重命名包含大量非法字符的数千个文件名（我继承的）。我试图在文件名的任何位置找到 ... 并将其替换为任何内容。

我试过 [...] 但它只从文件名的末尾删除。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:56:02.077

正如 Kash 所说，使用`\.{3}`而不是`[...]`. 问题是句点是正则表达式中的特殊字符。它的意思是“任何字符”。因此，为了表示一个文字句点，您可以使用反斜杠对其进行转义。 `\.{3}`查找连续恰好三个周期的任何出现。 `\.+`查找连续出现的一个或多个句点（小心，将查找单个句点）。 `\.\.+`将连续找到两个或多个句点的所有实例，我希望这就是您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:50:51.490

使用`\.+`而不是`[...]`.
如果您正在寻找专门的 3 个点，那么`\.{3}`

# css - 根据变量分配更少的功能

> ID：12410624
> 
> 赞同：4
> 
> 时间：2012-09-13T16:19:54.760
> 
> 标签：css, function, variables, less

我正在尝试在 LESS CSS 中开发一个“主题引擎”，以允许客户使用最少的变量更新其网站的配色方案。目前我们有一个变量文件，我们在其中分配默认集，为了简化用户输入的数量，我们经常使用变亮和变暗功能，例如

```
// snippet 1
@grayLight: #999999;
@grayLighter: darken(@grayLight, 10%); 
```

有没有一种方法可以将变亮/变暗函数分配为变量？这样我们只需要指定色调对比度（暗/亮或亮/暗）：

```
// snippet 2 (does not work)
@contrastVerb: darken;
@linkColorHover: @contrastVerb(@linkColor, 10%);//#FFA500; 
```

我尝试使用 Javascript 括号表示法来调用函数请求，例如

```
// snippet 3 (does not work)
@linkColorHover: `window[@contrastVerb]`(@linkColor, 10%);//#FFA500; 
```

一个选项是模式匹配：

```
// snippet 4
@tone: light;
.linkColor(light, @color){
    color: lighten(@color, 10%);
}
.linkColor(dark, @color){
    color: darken(@color, 10%);
}

.linkColor(@tone, #f17900); 
```

然而，片段 4 将比片段 2 或 3 更冗长，并且会导致生成大量额外代码。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T15:43:50.713

关于用户生成的主题，我处于类似的情况，并且我想出了以下 LESS mixin 来帮助我管理从几种基色生成的配色方案：

```
//LESS 1.3.3
.color (@color, @amount: 100) {
        color: contrast(@color, darken(@color, lightness(@color) * (@amount / 100)), lighten(@color, (100 - lightness(@color)) * (@amount / 100)), 0.5);
    } 
```

上面的代码是为 LESS 1.3.3 编写的，它与我通常在 Sublime Text 2 中使用的 LESS 版本具有不同的**对比功能！**如果这没有给出预期的结果，请尝试：

```
.color (@color, @amount: 100) {
    color: contrast(@color, lighten(@color, (100 - lightness(@color)) * (@amount / 100)), darken(@color, lightness(@color) * (@amount / 100)), 50%);
} 
```

这个 mixin 的工作原理是根据输入颜色和 0 到 100 之间的数量生成对比色。100 = 全对比度（即黑色或白色）；0 = 无对比度（即输入颜色）。例如

**较少的**

```
@c: #4f2634;
.c0 {.color(@c, 0)}
.c20 {.color(@c, 20)}
.c50 {.color(@c, 50)}
.c80 {.color(@c, 80)}
.c100 {.color(@c, 100)} 
```

**CSS**

```
.c0 {color: #4f2634;}
.c20 {color: #844057;}
.c50 {color: #bf7a92;}
.c80 {color: #e5cad3;}
.c100 {color: #ffffff;} 
```

此示例显然会生成文本颜色，因此在给定背景颜色时很有用，但是可以将相同的想法重新用于边框颜色等。希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:49:18.617

尝试在其中添加一个类`<body>`并创建 css 规则（使用 mixin）来更改站点中的任何内容。

```
<body class="section1"></body> 
```

**少演示**：

```
.color-mixin (@color) {
    color: @color;
    .foo{
         background-color: darken(@color, 10%);
    }
    a {
        &:hover{
            background-color: lighten(@color, 30%);
        }
    }
}

.section1 {
    .color-mixin(red);
}
.section2 {
    .color-mixin(blue);
} 
```

**CSS结果**：

```
.section1 {
  color: #ff0000;
}
.section1 .foo {
  background-color: #cc0000;
}
.section1 a:hover {
  background-color: #ff9999;
}
.section2 {
  color: #0000ff;
}
.section2 .foo {
  background-color: #0000cc;
}
.section2 a:hover {
  background-color: #9999ff;
}​ 
```

# c - 控制台和文件之间的 fprintf 和 printf 输出顺序不同

> ID：12410625
> 
> 赞同：0
> 
> 时间：2012-09-13T16:19:57.087
> 
> 标签：c

我在构建代码时遇到了困难：

```
#include <stdio.h>
#include <stdlib.h>
int main(int argc, char **argv){
    char *input[2];
    input[0]= "ls";
    input[1]= "pwd";
    FILE *result;
    char *output = "output.txt";
    FILE *fout = fopen(output, "w");

    if(!fout){
        fprintf(stderr, "Can not read %s file\n", output);
        return EXIT_FAILURE;
    }

    char command[256];
    pid_t pid = 1;
    int num = 0;
    while(num < 2)
    {
        pid = fork();
        if(pid == 0){
            result = popen(input[num], "r");
            char getline[256];
            while(fgets(getline, 256, result) != NULL){
                fprintf(fout, getline);
                printf("%s", getline);
            }
            printf("\n");
        }
        else if( pid > 0){
            fprintf(fout, "#command %d\n", num);
            printf("#command %d\n", num );
            wait(NULL);
        }
        else{
            printf(stderr, "something wrong in process!");
            break;
        }
        num++;
    }

    if(pid > 0){
        pclose(result);
        fclose(fout);
    }

    return EXIT_SUCCESS;
} 
```

我把`fprintf()`相邻`printf()`但结果不同。

我在控制台上得到以下信息：

```
#command 0
Debug
main.c
output.txt

#command 1
#command 1
/home/lightning/workspace/prac

/home/lightning/workspace/prac 
```

在`output.txt`文件中：

```
Debug
main.c
output.txt
#command 1
#command 0
/home/lightning/workspace/prac
Debug
main.c
output.txt
/home/lightning/workspace/prac 
```

谁能给我解释一下？

我想要以下输出：

```
#command 0
Debug
main.c
output.txt
#command 1
/home/lightning/workspace/prac 
```

`#commnad NUM`从父进程打印，结果`#command NUM`从子进程打印。

我应该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:51:25.770

It's been a long time since I coded in C, but if I read this correctly, you're opening a single text file, forking off a child process (which will run in parallel, more or less), having both processes *independently and asynchronously* write to that file, then exit.

Most likely the two process are writing all over each other on a character-by-character basis.

You have a couple of choices:

1.  re-think your logic and have each process write to its own file
2.  use file locks; have each process open the file for exclusive write (not a good idea)
3.  use locks within your code so the child process is forced to wait until the parent process finishes writing (again, not a good idea.)

# php - PHP Google Contact API 生成 HTTP/1.0 401 需要授权

> ID：12410626
> 
> 赞同：3
> 
> 时间：2012-09-13T16:19:57.663
> 
> 标签：php, javascript, jquery, google-contacts-api

我正在使用带有 OAuth 2.0 的 Google Contact API V3 从 Google 帐户检索联系人，我使用 jQuery 从子窗口获取 OAuth 令牌，然后将该令牌发布到另一个应该获取用户联系人的文件，但是当我通过从 Google 获取联系人的令牌，但它给出了错误“ `Warning: file_get_contents(https://www.google.com/m8/feeds/contacts/default/full&oauth_token=[token]) [function.file-get-contents]: failed to open stream: HTTP request failed! HTTP/1.0 401 Authorization required in ...\getContacts.php on line 7`”

这是我的参考代码：

在我的 index.php 中：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <script src="js/jquery-1.8.1.min.js" type="text/javascript"></script>
   <script type="text/javascript">
      var windowSizeArray = [ "width=200,height=200",
                        "width=300,height=400,scrollbars=yes" ];

      $(document).ready(function(){
         $('#newWindow').click(function (event){
            var url = $(this).attr("href");
            var windowName = "popUp";//$(this).attr("name");
            var windowSize = windowSizeArray[  $(this).attr("rel")  ];
            window.open(url, windowName, windowSize);
            event.preventDefault();
         });
      });

      function getContacts(accessToken){
          $.post("getContacts.php?token="+accessToken,function(data){
            $("#contacts").html(data);
          });
      }
   </script>
</head>

<body>

<a href="https://accounts.google.com/o/oauth2/auth?client_id=xxxxxxxxxxxxxxxx&redirect_uri=xxxxxxxxx&scope=https://www.google.com/m8/feeds/&response_type=code" id="newWindow">Click Here</a>! to import your contact.

<div id="contacts"></div> 
```

在我的 childWindow.php 中：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript" src="js/jquery-1.8.1.min.js"></script>
</head>

<body>

<?php
    $authcode= $_GET["code"];    
    $clientid='My Client ID';         
    $clientsecret='My Client Secret';         
    $redirecturi='http://localhost/googleContacts/validate.php';  

    $fields=array(
                    'code'=>  urlencode($authcode),
                    'client_id'=>  urlencode($clientid),
                    'client_secret'=>  urlencode($clientsecret),
                    'redirect_uri'=>  urlencode($redirecturi),
                    'grant_type'=>  urlencode('authorization_code')
                );  

    //url-ify the data for the POST 
    $fields_string='';
    foreach($fields as $key=>$value) { $fields_string .= $key.'='.$value.'&'; }
    $fields_string=rtrim($fields_string,'&');

    //open connection
    $ch = curl_init();

    //set the url, number of POST vars, POST data
    curl_setopt($ch,CURLOPT_URL,'https://accounts.google.com/o/oauth2/token');
    curl_setopt($ch,CURLOPT_POST,5);
    curl_setopt($ch,CURLOPT_POSTFIELDS,$fields_string);

    // Set so curl_exec returns the result instead of outputting it.
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

    //to trust any ssl certificates
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);

    //execute post
    $result = curl_exec($ch);

    //close connection
    curl_close($ch);

    //extracting access_token from response string
    $response=  json_decode($result);
    $accesstoken= $response->access_token;

    //echo "<span>".$accesstoken."</span><hr>";
?>

<script type="text/javascript">
    $(document).ready(function() {
        window.opener.getContacts("<?php echo $accesstoken; ?>");
        window.close();
    });
</script> 
```

最后在我的 getContacts.php 中：

```
<?php

$accesstoken = $_REQUEST['token'];

//passing accesstoken to obtain contact details  

$xmlresponse=  file_get_contents('https://www.google.com/m8/feeds/contacts/default/full&oauth_token='.$accesstoken);  

//reading xml using SimpleXML  

$xml=  new SimpleXMLElement($xmlresponse);  

foreach($xml->entry as $content){

    $nameEmail = "";

    if(!empty($content->title)){
        $nameEmail .= "<span style=\"text-decoration:underline;\">".$content->title."</span>: ";    
    }

    $gd = $content->children('http://schemas.google.com/g/2005');

    if($gd){
        $nameEmail .= $gd->attributes()->address."<hr>";
        echo $nameEmail;
    }else{
        echo $nameEmail."<hr>";
    }
} 
?> 
```

请告诉我错误在哪里。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-28T06:30:12.320

要允许 https 为`file_get_contents()`您应该启用 php 扩展`php_openssl.dll`。

确保在您的 php.ini 中有以下行：

```
extension=php_openssl.dll    
allow_url_fopen = On 
```

# php - 基于 Cookie 的身份验证注销不起作用

> ID：12410629
> 
> 赞同：0
> 
> 时间：2012-09-13T16:20:22.150
> 
> 标签：php, codeigniter, session, cookies

我正在构建一个基于 cookie 的会话机制，它有一个抽象类 Session，可以扩展它以创建多个 cookie 会话实例，以适应不同的用途和复杂性……。

我还有一个 Auth 类，它处理权限以及用户的实际登录和注销。Auth 类需要 Session 类或子类才能运行。

到目前为止一切都很好，我可以登录用户，如果经过一定时间、IP 地址不匹配等，也可以将其注销。

每个页面加载都会读取 cookie 检查是否存在不一致，并根据 xyz 销毁或更新它。销毁脚本现在将 cookie 上的时间设置回减号，并删除已从 auth 库中添加的所有用户数据。这很有效，因为我登录后等待了几分钟，然后点击刷新，cookie 变得疲惫不堪，我被弹回登录屏幕。

但是，如果我想通过单击按钮将它们注销，则销毁脚本不起作用，即我可以在顶部回显原始用户数据运行注销脚本，该脚本回显注销并运行所有功能而没有错误等但是那么如果我得到用户cookie它仍然是一样的。我不明白这对于自动检查是如何起作用的，但当用户点击注销按钮时……</p>

下面是我的 sessionDestroy 函数

```
protected function sessionDestroy($cookieName) {

    setcookie(
                $cookieName,
                addslashes(serialize(array())),
                (time() - 3600),
                0
        );          
} 
```

PS我知道destroy对cookies来说是个坏词，但你知道我的意思……希望

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-09-14T20:06:10.293

为什么不使用 CI 中内置的 cookie 和会话库？

会话库的优点在于它使用了加密的 cookie。你发现它是一个比你所做的更好的解决方案。

# c# - 如何使编译器接受十六进制值？

> ID：12410630
> 
> 赞同：-2
> 
> 时间：2012-09-13T16:20:26.380
> 
> 标签：c#, enums, flags, winmm, enum-flags

我正在尝试使用[http://www.pinvoke.net/default.aspx/coredll/playsound.html上的代码](http://www.pinvoke.net/default.aspx/coredll/playsound.html)

但是，它会导致几个错误消息，即：“意外字符'×'” 26 次。

所以，我尝试将 vals 更改为逐字字符串，如下所示：

SND_SYNC = @"0×0000",

...但现在我得到“无法将类型'string'隐式转换为'int'

我意识到我可以将这些字符串转换为整数，但这真的是这样吗？恐怕我可以让它以这种方式编译，但它仍然无法工作（或更糟）。将这些十六进制值标记为这样的适当方法是什么，以便编译器接受它们？

这是代码的第一部分：

[DllImport("winmm.dll", SetLastError = true)] static extern bool PlaySound(string pszSound, UIntPtr hmod, uint fdwSound);

```
[Flags]
public enum SoundFlags
{
    SND_SYNC = 0×0000, // <- "unexpected char 'x'" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:24:24.830

只需分配它们 - SND_SYNC = 0x000

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:25:29.003

我想你想要

```
int val = 0x12fe; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-29T07:40:57.947

我从网站复制到 ac# Visual Studio 2012 编辑器的一些代码也遇到了同样的问题，它粘贴的 x 根本不是 x，而是其他字符。用实际的 x 字符、大写或小写替换它们对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T16:38:32.260

至少在我的情况下，我必须将所有小写 x 更改为大写 X 才能使其正常工作。

# java - SWT：区分选择和键入组合

> ID：12410636
> 
> 赞同：2
> 
> 时间：2012-09-13T16:20:43.733
> 
> 标签：java, swt, jface

考虑以下 Java (SWT) 代码：

```
private static ComboViewer createViewer(final Shell shell) {
  final ComboViewer v = new ComboViewer(shell, SWT.DROP_DOWN);
  v.setLabelProvider(new LabelProvider());
  v.setContentProvider(new ArrayContentProvider());
  v.setInput(new String[]{"value 1", "value 2"});
  return v;
}

public static void main(final String[] args) {
  Display display = new Display();
  Shell shell = new Shell(display);
  shell.setSize(200, 60); 
  shell.setLayout(new GridLayout());

  final ComboViewer v = createViewer(shell);

  // This wires up the userSelectedSomething method correctly
  v.addSelectionChangedListener(new ISelectionChangedListener() {
    @Override
    public void selectionChanged(final SelectionChangedEvent event) {
      userSelectedSomething();
    }
  });

  shell.open();
  while (!shell.isDisposed()) {
    if (!display.readAndDispatch()) {
      display.sleep();
    }
  }
  display.dispose();
}

public static void userSelectedSomething() {
  // This should be called *only if* the user selected from the drop-down
}

public static void userTypedSomething() {
  // This should be called *only if* the user typed in the combo
} 
```

我只想`userTypedSomething`在用户输入组合时调用该方法（而不是当他们从下拉列表中选择时）。我应该添加什么监听器来实现这一点？将修改侦听器添加到组合查看器`v.getCombo().addModifyListener(...)`并不好，因为这会触发组合中的键入和选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:46:39.383

```
private static ComboViewer createViewer(final Shell shell) {
    final ComboViewer v = new ComboViewer(shell, SWT.DROP_DOWN);
    v.setLabelProvider(new LabelProvider());
    v.setContentProvider(new ArrayContentProvider());
    v.setInput(new String[]{"value 1", "value 2"});
    return v;
  }

  private static boolean userTyped;
  private static int index = -1;

  public static void main(final String[] args) {
    Display display = new Display();
    Shell shell = new Shell(display);
    shell.setSize(200, 60); 
    shell.setLayout(new GridLayout());

    final ComboViewer v = createViewer(shell);
    /*
     * invoked multiple times when combo selection happens
     * invoked once when user types
     */
    v.getCombo().addVerifyListener(new VerifyListener() {

      @Override
      public void verifyText(VerifyEvent e) {
         userTyped = (e.keyCode != 0);
      }
    });

 v.getCombo().addModifyListener(new ModifyListener() {

  @Override
  public void modifyText(ModifyEvent e) {

    Combo c = (Combo)e.widget;

    if(userTyped || index == c.getSelectionIndex() || c.getSelectionIndex() == -1)
    {
      userTypedOrEditedSomething();
    }
    index = c.getSelectionIndex();
  }
});

    // This wires up the userSelectedSomething method correctly
    v.addSelectionChangedListener(new ISelectionChangedListener() {
      @Override
      public void selectionChanged(final SelectionChangedEvent event) {
        userSelectedSomething();
      }
    });

    shell.open();
    while (!shell.isDisposed()) {
      if (!display.readAndDispatch()) {
        display.sleep();
      }
    }
    display.dispose();
  }

  public static void userSelectedSomething() {
    // This should be called *only if* the user selected from the drop-down
    System.out.println("User selected");
  }

  public static void userTypedOrEditedSomething() {
    // This should be called *only if* the user typed in the combo
    System.out.println("User typed or edited");
  } 
```

我建议您使用验证事件而不是 Key UP，因为您最终可能会处理很多事情（箭头键、魔术键等）。验证也是关键事件，但它会过滤掉**ALT、CNTRL、SHIFT**组合。当用户键入时，只需检查 keycode!=0。

正如您所指出的，当您使用 CNTRL+V 时，右键单击 Menu paste....combo 不会将其视为关键事件，但它会触发验证事件以确保剪贴板文本对组合有效。我认为这就是它应该如何工作，因为菜单项选择和组合键事件是不同的事情。您可以随时监控所有关键事件以进行复制/粘贴/删除等特殊操作。

上面的示例代码应该能够执行您正在寻找的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:23:59.523

由于您想听键盘输入，我建议您听`SWT.KeyUp`.

这应该是一个很好的起点：

```
public static void main(String[] args) {
    final Display display = new Display();
    final Shell shell = new Shell(display);
    shell.setLayout(new FillLayout());

    final Combo combo = new Combo(shell, SWT.NONE);

    combo.add("First");
    combo.add("Second");

    combo.addListener(SWT.Selection, new Listener() {

        @Override
        public void handleEvent(Event arg0) {
            System.out.println("Selected: " + combo.getItem(combo.getSelectionIndex()));
        }
    });

    combo.addListener(SWT.KeyUp, new Listener() {

        @Override
        public void handleEvent(Event arg0) {
            System.out.println("Typed");
        }
    });

    shell.pack();
    shell.open();
    while (!shell.isDisposed()) {
        if (!display.readAndDispatch()) {
            display.sleep();
        }
    }
    display.dispose();
} 
```

# java - 实施 ISelectionListener 以在项目资源管理器中监视选定的项目

> ID：12410640
> 
> 赞同：2
> 
> 时间：2012-09-13T16:21:04.383
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-rcp, eclipse-cdt

我正在尝试在我的 Eclipse 插件中实现 ISelectionListener，它将跟踪我的项目资源管理器中的选择并告诉我选择了哪些项目。所以它与构建工具栏按钮查找每次选择要构建的项目的方式相同。我实现了那个监听器，但只有当用户点击实际项目而不是项目下的任何其他项目（如源代码、文件夹、包......）时，我才能选择项目我的代码是：

```
 @Override
public void selectionChanged(IWorkbenchPart part, ISelection selection) {
    Object[] allselections= null;
    selectedProjects.clear();
    // TODO Auto-generated method stub

    if(selection instanceof IStructuredSelection) {
        //Object element = ((IStructuredSelection)selection).getFirstElement();
        allselections = ((IStructuredSelection)selection).toArray();
        for(Object element: allselections){

            if (element instanceof IResource) {
                selectedProjects.add(((IResource)element).getProject());

        }
    }
}; 
```

当元素不是 IResource 的实例并且是 CModelManager、来自 CDT 的 cSource/cxxSource ......以及可以成为项目一部分的任何其他内容时，是否有通用方法来获取它所属的项目？

对于 IResourceChangeListener，您可以使用 IResourceDeltaVisitor，然后您可以使用以下方法将所有内容作为 IResource 实例获取：访问（IResourceDelta delta）函数中的 IResource resource = delta.getResource()。ISelectionListener 有类似的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:17:12.363

[http://www.eclipsezone.com/articles/what-is-iadaptable/](http://www.eclipsezone.com/articles/what-is-iadaptable/)

[http://wiki.eclipse.org/FAQ_How_do_I_use_IAdaptable_and_IAdapterFactory%3F](http://wiki.eclipse.org/FAQ_How_do_I_use_IAdaptable_and_IAdapterFactory%3F)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-10T02:02:07.360

[http://exploreeclipse.blogspot.com/2015/05/listening-to-project-explorer-changes.html](http://exploreeclipse.blogspot.com/2015/05/listening-to-project-explorer-changes.html)

如果您想根据从项目资源管理器中选择元素来控制某些操作，我们可以通过服务注册表注册一个帖子选择更改。

```
//Register listener
ISelectionService ss = PlatformUI.getWorkbench().getActiveWorkbenchWindow().getSelectionService();

ProjectExplorerSelectionListener selectionListener = new ProjectExplorerSelectionListener();
ss.addPostSelectionListener(IPageLayout.ID_PROJECT_EXPLORER, selectionListener);

//Listener
import org.eclipse.core.resources.IProject;
import org.eclipse.core.resources.IResource;
import org.eclipse.core.runtime.IAdaptable;
import org.eclipse.jface.viewers.ISelection;
import org.eclipse.jface.viewers.IStructuredSelection;
import org.eclipse.ui.ISelectionListener;
import org.eclipse.ui.IWorkbenchPart;

class ProjectExplorerSelectionListener implements ISelectionListener
{
 public void selectionChanged(IWorkbenchPart part, ISelection newSelection)
 {
  if (newSelection instanceof IStructuredSelection)
  {
   Object element = ((IStructuredSelection) newSelection).getFirstElement();
   if (element instanceof IAdaptable)
   {
    IResource resource = (IResource) ((IAdaptable) element).getAdapter(IResource.class);
    final IProject project = resource.getProject();

    //do your action here!!
   }
  }

 }

} 
```

# xml - 关于为 XML 配置文件创建 GUI 的建议

> ID：12410643
> 
> 赞同：2
> 
> 时间：2012-09-13T16:21:12.710
> 
> 标签：xml, user-interface

我想创建一个 Windows GUI 以允许用户友好地编辑存储在 XML 中的配置。XML 以传统方式使用嵌套元素，通常带有用于配置值的属性。设计和创建 GUI（可能在 C# 中使用树控件显示整体结构和使用 PropertyGrid 编辑特定属性）将是一项合理的工作量。在我看来，当问题可以通过 XML 模式和一些额外的“元数据”更普遍地解决时，创建一个完全定制的应用程序似乎也是错误的。

是否有人知道任何可以为“XML 配置文件”GUI 应用程序提供基础的框架或库（理想情况下是开源的，但我会考虑以合适的价格进行商业化）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-21T09:25:10.387

最后，我们决定采用“带有树控件的 C# 应用程序以显示整体结构和 PropertyGrid 以编辑特定属性”的路线。它的工作量比我们预期的要少——一旦有了基本的应用程序结构，我们只需为每个我们希望可配置的对象添加类。每个类都公开可由 PropertyGrid 编辑的属性，并负责以适当的格式将其属性读/写到 XML。可能有更简单的方法，但这给了我们足够的控制权而不会太费时。

我们发现以下资源在开发过程中很有用：

*   在属性网格中订购项目 - [http://www.codeproject.com/Articles/6611/Ordering-Items-in-the-Property-Grid](http://www.codeproject.com/Articles/6611/Ordering-Items-in-the-Property-Grid)
*   控制描述区域高度 - [http://www.codeproject.com/Articles/31497/Gain-Control-Over-PropertyGrid-s-Description-Area](http://www.codeproject.com/Articles/31497/Gain-Control-Over-PropertyGrid-s-Description-Area)
*   实体拖动拆分器 -[在拆分器移动时刷新 SplitContainer 的面板](https://stackoverflow.com/questions/6521731/refresh-the-panels-of-a-splitcontainer-as-the-splitter-moves)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:26:54.820

我会使用 XForms，它在许多免费应用程序和许多商业应用程序中都可用（这些应用程序不是不相交的）。您可以从查看 XSLTForms、Orbeon、BettterForms 和 EMC 公式开始。

# ruby - Ruby CSV UTF-8 编码/翻译问题

> ID：12410645
> 
> 赞同：0
> 
> 时间：2012-09-13T16:21:18.263
> 
> 标签：ruby, csv, utf-8

我的数据中有 Ruby 1.9 CSV 和无效 UTF-8 字符的问题。

我的代码看起来像这样：

```
CSV.foreach("small-test2.csv", options) do |row |

    name, workgroup, address, actual, output = row
    next if nbname == "NBName"
    @ssl_info[name] = workgroup, address, actual, output

   ic = Iconv.new('UTF-8//IGNORE', 'UTF-8')
   clean = ic.iconv(output + ' ')[0..-2]

   puts clean

end 
```

但是我仍然得到以下信息：

```
ArgumentError: invalid byte sequence in UTF-8
           =~ at org/jruby/RubyRegexp.java:1487
           =~ at org/jruby/RubyString.java:1686 
```

我在这里有什么遗漏吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T07:10:45.857

试试这个，

```
output.encode("UTF-8", :invalid => :replace, :undef => :replace, :replace => "") 
```

# c# - MOQ：设置一个方法，该方法填充作为参数传递的对象内的集合

> ID：12410646
> 
> 赞同：3
> 
> 时间：2012-09-13T16:21:19.693
> 
> 标签：c#, unit-testing, moq

我有一个名为“CollectionPager”的类，其中有一个 List 类型的集合。我有一个方法“RetrieveList”，它将“CollectionPager”作为输入并在其中填充“List”。此方法不返回任何值。

我需要模拟一个调用“RetrieveList”的函数。但是，由于它不返回任何值，因此不会考虑输入到 Mock 中的任何输入，并且此集合（列表）的计数始终为 0。

有什么可能的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:41:58.377

我想您需要`Callback`（另请参阅[Moq quickstart](http://code.google.com/p/moq/wiki/QuickStart)）方法来设置一些逻辑来模拟一个 void 函数。

这是演示用法的示例测试：

```
var mock = new Mock<IRetrieveListService>();
mock.Setup(m => m.RetrieveList(It.IsAny<CollectionPager>()))
    .Callback<CollectionPager>(p =>
                                    {
                                        p.List.Add("testItem1");
                                        p.List.Add("testItem2");
                                    });
var sut = new OtherService(mock.Object);
sut.SomeMethodToTest(); 
```

假设您的课程看起来像这样：

```
public class CollectionPager
{
    public CollectionPager()
    {
        List = new List<string>();
    }

    public List<string> List { get; private set; }
}

public interface IRetrieveListService
{
    void RetrieveList(CollectionPager pager);
}

public class RetrieveListService : IRetrieveListService
{
    public void RetrieveList(CollectionPager pager)
    {
        pager.List.Add("item1");
        pager.List.Add("item2");
    }
}

public class OtherService
{
    private readonly IRetrieveListService retrieveListService;

    public OtherService(IRetrieveListService retrieveListService)
    {
        this.retrieveListService = retrieveListService;
    }

    public void SomeMethodToTest()
    {
        var collectionPager = new CollectionPager();
        retrieveListService.RetrieveList(collectionPager);
        // in your test collectionPager.Item contains: testItem1, testItem2
    }
} 
```

# java - 将 Spring 3.1 项目更新为 hibernate4 现在获得 No Session found for current thread

> ID：12410652
> 
> 赞同：0
> 
> 时间：2012-09-13T16:21:36.957
> 
> 标签：java, spring, hibernate, spring-mvc, spring-webflow

我不得不将我的 Spring WebFlow 项目更新到 Spring 3.1 和 Hibernate 4 才能尝试让 maven 工作。看起来现在一切正常，但是在项目的一部分要进行数据库读取时，我收到以下错误：

```
org.hibernate.HibernateException: No Session found for current thread   org.springframework.orm.hibernate4.SpringSessionContext.currentSession(SpringSessionContext.java:97) 
```

我不知道为什么我在 hibernate3 中没有收到此错误，但有人可以告诉我如何解决此问题。

这是我的 pom.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.springframework.samples</groupId>
    <artifactId>webflow-primefaces-showcase</artifactId>
    <name>JSF 2, Spring Web Flow, and PrimeFaces Showcase</name>
    <packaging>war</packaging>
    <version>1.0.0-BUILD-SNAPSHOT</version>

    <properties>
        <java-version>1.5</java-version>
        <springframework-version>3.1.1.RELEASE</springframework-version>
        <springwebflow-version>2.3.1.BUILD-SNAPSHOT</springwebflow-version>
        <springsecurity-version>3.1.1.RELEASE</springsecurity-version>
        <org.slf4j-version>1.5.10</org.slf4j-version>
        <hibernate.version>4.1.1.Final</hibernate.version>
    </properties>

    <dependencies>
        <!-- Spring -->

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>${springframework-version}</version>
            <!-- will come with all needed Spring dependencies such as spring-core 
                and spring-beans -->
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aspects</artifactId>
            <version>${springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${springframework-version}</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework.webflow</groupId>
            <artifactId>spring-faces</artifactId>
            <version>${springwebflow-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-core</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-web</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>

        <dependency>
            <groupId>javax.transaction</groupId>
            <artifactId>jta</artifactId>
            <version>1.1</version>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.14</version>
        </dependency>

        <dependency>
            <groupId>cglib</groupId>
            <artifactId>cglib</artifactId>
            <version>2.2.2</version>
        </dependency>

        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.21</version>
        </dependency>

        <dependency>
            <groupId>c3p0</groupId>
            <artifactId>c3p0</artifactId>
            <version>0.9.1.2</version>
        </dependency>

        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpcore</artifactId>
            <version>4.2.1</version>
        </dependency>

        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpclient</artifactId>
            <version>4.2.1</version>
            <exclusions>
                <exclusion>
                    <artifactId>commons-logging</artifactId>
                    <groupId>commons-logging</groupId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjtools</artifactId>
            <version>1.6.2</version>
        </dependency>

        <dependency>
            <groupId>jstl</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>

        <!-- Logging -->
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <version>${org.slf4j-version}</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>${org.slf4j-version}</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.16</version>
            <scope>runtime</scope>
        </dependency>
        <!-- JSF-303 Dependency Injection -->
        <dependency>
            <groupId>javax.inject</groupId>
            <artifactId>javax.inject</artifactId>
            <version>1</version>
        </dependency>
        <!-- Servlet -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet.jsp</groupId>
            <artifactId>jsp-api</artifactId>
            <version>2.1</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
        <!-- Sun Mojarra JSF 2 runtime -->
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>2.1.7</version>
        </dependency>
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>2.1.7</version>
        </dependency>

        <!-- JSR 303 validation -->
        <dependency>
            <groupId>javax.validation</groupId>
            <artifactId>validation-api</artifactId>
            <version>1.0.0.GA</version>
        </dependency>

        <!-- ********************************************************************** 
            ** HIBERNATE DEPENDENCIES ** ********************************************************************** -->

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>${hibernate.version}</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.0.2.GA</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.0.2.GA</version>
        </dependency>
        <!-- Test -->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.7</version>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <repositories>
        <!-- For testing against latest Spring snapshots -->
        <repository>
            <id>org.springframework.maven.snapshot</id>
            <name>Spring Maven Snapshot Repository</name>
            <url>http://maven.springframework.org/snapshot</url>
            <releases>
                <enabled>false</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </repository>
        <!-- For developing against latest Spring milestones -->
        <repository>
            <id>org.springframework.maven.milestone</id>
            <name>Spring Maven Milestone Repository</name>
            <url>http://maven.springframework.org/milestone</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For Hibernate Validator -->
        <repository>
            <id>org.jboss.repository.releases</id>
            <name>JBoss Maven Release Repository</name>
            <url>https://repository.jboss.org/nexus/content/repositories/releases</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For Sun Mojarra JSF 2 implementation -->
        <repository>
            <id>maven2-repository.dev.java.net</id>
            <name>Java.net Repository for Maven</name>
            <url>http://download.java.net/maven/2/</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For PrimeFaces JSF component library -->

    </repositories>

    <build>
        <finalName>WebFlowTemplate</finalName>
    </build>
</project> 
```

这是我的 database.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx" 
       xmlns:jdbc="http://www.springframework.org/schema/jdbc"

    xsi:schemaLocation="http://www.springframework.org/schema/beans 
                            http://www.springframework.org/schema/beans/spring-beans.xsd
                            http://www.springframework.org/schema/context 
                            http://www.springframework.org/schema/context/spring-context-3.1.xsd
                            http://www.springframework.org/schema/tx
                            http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
                            http://www.springframework.org/schema/jdbc
                            http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd">

    <context:property-placeholder location="classpath:app.properties" />

    <context:component-scan base-package="org.uftwf" />

    <tx:annotation-driven transaction-manager="hibernateTransactionManager" />

    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"
        destroy-method="close">

        <!-- these are C3P0 properties      --> 
        <property name="acquireIncrement" value="${database.c3p0.acquireIncrement}" />
        <property name="minPoolSize" value="${database.c3p0.minPoolSize}" />
        <property name="maxPoolSize" value="${database.c3p0.maxPoolSize}" />
        <property name="maxIdleTime" value="${database.c3p0.maxIdleTime}" />
        <property name="maxIdleTimeExcessConnections" value="${database.c3p0.maxIdleTimeExcessConnections}" />
        <property name="numHelperThreads" value="${database.c3p0.numHelperThreads}" />
        <property name="unreturnedConnectionTimeout" value="${database.c3p0.unreturnedConnectionTimeout}" />
        <property name="idleConnectionTestPeriod" value="300" />

        <property name="driverClass" value="${database.driver}" />
        <property name="jdbcUrl" value="${database.url}" />
        <property name="user" value="${database.user}" />
        <property name="password" value="${database.password}" />
    </bean>

    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="annotatedClasses">
            <list>
                <value>org.uftwf.memberinquiry.model.MemberInquiryInformation</value>
            </list>
        </property>

        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${hibernate.dialect}</prop>
                <prop key="hibernate.show_sql">${hibernate.show_sql}</prop>
                <prop key="hibernate.use_sql_comments">${hibernate.use_sql_comments}</prop>
                <prop key="format_sql">${format_sql}</prop>
                <prop key="hibernate.c3p0.min_size">10</prop>
                <prop key="hibernate.c3p0.max_size">25</prop>
                <prop key="hibernate.c3p0.timeout">600</prop>
                <prop key="hibernate.c3p0.max_statements">0</prop>
                <prop key="hibernate.c3p0.idle_test_period">300</prop>
                <prop key="hibernate.c3p0.acquire_increment">5</prop>
            </props>
        </property>
    </bean>

    <bean id="hibernateTransactionManager"
        class="org.springframework.orm.hibernate4.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>
</beans> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:43:53.847

尝试将此添加到您的服务中：

```
@Transactional(readOnly=true, propagation=Propagation.REQUIRED) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:29:49.437

看起来像一个延迟加载问题。您是否启用了 OpenSessionFactoryInViewFilter 或 OpenSessionFactoryInViewInterceptor？在事务中执行的任何代码都不应出现此异常，但呈现视图通常发生在需要过滤器/拦截器的事务之外。没有看到代码很难说。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T00:56:13.220

```
 public Session currentSession() throws HibernateException {
    Object value = TransactionSynchronizationManager.getResource(this.sessionFactory);
    if (value instanceof Session) {
        return (Session) value;
    }
    else if (value instanceof SessionHolder) {
        SessionHolder sessionHolder = (SessionHolder) value;
        Session session = sessionHolder.getSession();
        if (TransactionSynchronizationManager.isSynchronizationActive() &&
                !sessionHolder.isSynchronizedWithTransaction()) {
            TransactionSynchronizationManager.registerSynchronization(
                    new SpringSessionSynchronization(sessionHolder, this.sessionFactory));
            sessionHolder.setSynchronizedWithTransaction(true);
            // Switch to FlushMode.AUTO, as we have to assume a thread-bound Session
            // with FlushMode.MANUAL, which needs to allow flushing within the transaction.
            FlushMode flushMode = session.getFlushMode();
            if (FlushMode.isManualFlushMode(flushMode) &&
                    !TransactionSynchronizationManager.isCurrentTransactionReadOnly()) {
                session.setFlushMode(FlushMode.AUTO);
                sessionHolder.setPreviousFlushMode(flushMode);
            }
        }
        return session;
    }
    else if (this.jtaSessionContext != null) {
        Session session = this.jtaSessionContext.currentSession();
        if (TransactionSynchronizationManager.isSynchronizationActive()) {
            TransactionSynchronizationManager.registerSynchronization(new SpringFlushSynchronization(session));
        }
        return session;
    }
    else {
        throw new HibernateException("No Session found for current thread");
    }
} 
```

这是SpringSessionContext.java抛出的异常，你可以调试这段代码来检查变量值是否发生过，在遇到这个问题之前，因为我们使用的是hibernate3.SessionHolder，所以它无法从instanceof中识别出来，希望这可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T05:39:50.183

```
<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource"/>
    <property name="hibernateProperties">
       <props>
                <prop key="hibernate.current_session_context_class">thread</prop>
      </props>
    </property> 
</bean> 
```

# android - 如何重命名Android根目录中的文件？

> ID：12410654
> 
> 赞同：1
> 
> 时间：2012-09-13T16:21:42.833
> 
> 标签：android, file, directory, root, rename

我正在尝试将目录 /system/app 中的 SystemUI.apk 重命名为我的根设备（带有 ICS 的平板电脑）上的其他名称，就像根浏览器能够做到的那样。它的工作方式与在 /sdcard 目录中的工作方式不同。我试过这个：

```
String s = "/system/app";
File from = new File(s, "SystemUI.apk");
File to = new File(s, "_SystemUI.apk");
from.renameTo(to); 
```

（此代码适用于 SD 卡中的文件）

我设置了写入外部存储的权限：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

但是，“内部”存储没有这样的权限。我需要通过 Runtime.getRuntime().exec(some command) 执行此操作吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:28:46.193

您需要 root 访问权限，这是标准 java 类无法做到的。

*通过 SU 二进制运行此命令*

> mv /system/app/SystemUI.apk /system/app/_SystemUI.apk

显然，您可以根据需要更改 cmd 以执行您需要的操作。

# ios - NSDocumentDirectory 在设备上保存和加载图像是否合法？

> ID：12410655
> 
> 赞同：0
> 
> 时间：2012-09-13T16:21:45.210
> 
> 标签：ios, uiimage, nsdocumentdirectory

以下代码在模拟器上运行，但由于 img 为 nil 导致设备崩溃：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];

    for (NSString* path in userImages) {
        NSLog(@"image at %@", path); //logs "image at userImage0.png"
        NSString *getImagePath = [documentsDirectory stringByAppendingPathComponent:path];
        UIImage *img = [UIImage imageWithContentsOfFile:getImagePath];
        unichar ch = [path characterAtIndex:9];
        NSLog(@"Ch = %c", ch); //correctly logs "0"
        if (ch == '0') {
            [self.images insertObject:img atIndex:0]; //this throws the error
        }
    } 
```

为什么在设备上运行而不是在模拟器上运行时 img nil？图像最初是这样保存的：

```
NSString *docsDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask,YES) objectAtIndex:0];
NSString *imageName = @"userimage0.png";
NSString *imagePath = [docsDir stringByAppendingPathComponent:imageName];
[UIImagePNGRepresentation(img) writeToFile:imagePath atomically:YES]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:29:15.177

对不起，这是一个大小写问题。用户图像与用户图像。模拟器不关心这个（我希望它这样做），但设备关心。

# php - PHP：从用户端获取时区偏移量并计算“时间前”

> ID：12410657
> 
> 赞同：1
> 
> 时间：2012-09-13T16:21:48.620
> 
> 标签：php, time, timezone

我试图计算自发表评论以来经过的时间。我找到了一个[功能](https://stackoverflow.com/a/2916189/996652)，它运行良好

但我只是注意到显示给用户的时间是错误的，因为他/她的**时区**。我做了一些研究，解决方案似乎是**使用**一个名为`getTimezoneOffset`.

问题是我无法设法使用此偏移量来创建时区并在我上面链接的那个功能上使用它。到目前为止，我可以在[另一个代码](https://stackoverflow.com/a/10254751/996652)的帮助下收集到：

```
function humanTiming ($time,$offset)
{

    $isDST = 1; // Daylight Saving 1 - on, 0 - off
    $timezoneName = timezone_name_from_abbr('', intval($offset, 10) * 36, $isDST);

    $date = new DateTime($time, new DateTimeZone($timezoneName));
    $time = strtotime($date);

    $time = time() - $time; // to get the time since that moment

    $tokens = array (
        31536000 => 'year',
        2592000 => 'month',
        604800 => 'week',
        86400 => 'day',
        3600 => 'hour',
        60 => 'minute',
        1 => 'second'
    );

    foreach ($tokens as $unit => $text) {
        if ($time < $unit) continue;
        $numberOfUnits = floor($time / $unit);
        return $numberOfUnits.' '.$text.(($numberOfUnits>1)?'s':'');
    }

} 
```

让我们这样调用函数：

```
echo humanTiming ($row['date'],"-240"); 
```

注意：`-240`是我从运行那个 javascript 函数中得到的值，所以它可能是我的时区偏移量。

**第一个问题**：似乎该值`-240`无效，并且可以`-0500`正常工作。

**第二个问题**：即使我尝试使用有效的偏移值，函数也会返回`42 years`

不确定这 42 年是如何计算的，但它完全错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T03:43:36.037

几个问题：Javascript 函数[`getTimezoneOffset()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset)以分钟为单位返回时区偏移量，但[`timezone_name_from_abbr()`](http://www.php.net/timezone_name_from_abbr)期望以秒为单位的偏移量。所以在你的例子中`-240`实际上是`-4`几小时或`-14396`几秒。您可以通过稍微更改数学来修复您的代码：

```
$timezoneName = timezone_name_from_abbr('', intval($offset) * 60, $isDST); 
```

由于您已经开始使用该`DateTime`对象，因此您不能再使用它`strtotime`来获取 Unix 时间戳。相反，您需要[`format()`](http://www.php.net/manual/en/datetime.format.php)：

```
$date = new DateTime($time, new DateTimeZone($timezoneName));
$time = $date->format('U'); 
```

这应该会得到你想要的结果。您将获得 42 年，因为时间设置为 0（`strtotime($date)`评估为假），即 Unix 纪元 - 1970。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-16T01:52:49.303

你可以像这样抵消一切：

```
$today=new DateTime("-$offset minutes");
$tomorrow=new DateTime("+1 day-$offset minutes"); 
```

# parameters - 如何将函数的默认参数设置为 PowerShell 2 中另一个函数的输出？

> ID：12410660
> 
> 赞同：0
> 
> 时间：2012-09-13T16:22:05.753
> 
> 标签：parameters, powershell-2.0, default-value

在 PowerShell 2 中，我有一个返回当前季度的函数 Get-CurrentQuarter。

我有另一个接受参数季度的函数。我希望使用 Get-CurrentQuarter 函数将其默认为当前季度。

我试过：

```
function Test-ParameterByFunction
{
  param(
    [string]$quarter = Get-CurrentQuarter
  )
}

Test-ParameterByFunction 
```

PowerShell 报告：

```
PS > .\test.ps1
Missing expression after '='.
At .\test.ps1:4 char:23
+     [string]$quarter = <<<<  Get-CurrentQuarter
    + CategoryInfo          : ParserError: (=:String) [], ParseException
    + FullyQualifiedErrorId : MissingExpressionAfterToken 
```

这对于清理我的代码非常方便。有一些我缺少的语法吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T08:32:46.267

试试这个：

```
[string]$quarter = [string](Get-CurrentQuarter) 
```

# javascript - 在 if()else() 之前等待函数完成

> ID：12410661
> 
> 赞同：0
> 
> 时间：2012-09-13T16:22:07.453
> 
> 标签：javascript, jquery

我有这个：

```
var myError;

function getNames(user,location){
    myError=null;

    //Make an Ajax Call (this takes some time)
    //On Success do this:
        if(//Some Condition){
            myError=false;
        }else{
            myError=true
        }
}

function first(){
    getNames(user, location);

    if(myError==false){ //MYCONDITION
        //do some custom stuff just for first();
    }else{
        alert("Failed");
    }
}

function second(){
    getNames(user, location);

    if(myError==false){ //MYCONDITION
        //do some custom stuff just for second();
    }else{
        alert("Failed");
    }
} 
```

现在，当我调用 first() 或 second() 时，它总是给我警报消息“FAILED”。问题是 //MYCONDITION 在 getNames() 函数完成之前被执行。我想等待 getNames() 执行，然后才能检查 //MYCONDITION。

我无法设置延迟，因为我不知道 getNames() 将花费多少时间。我正在考虑使用一些 jQquery 函数，但我似乎找不到一个。

而且，我试图让 getNames() 尽可能通用。所以，我正在考虑一种不打扰 getNames() 的方法。

我看到的最后一个选项是将回调（）添加到 getNames（）。但是，这个函数也被其他不需要回调（）的函数调用。

有什么想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:24:58.080

添加回调完全没问题；你可以检查它是否存在：

```
function getNames(user, location, callback){
    myError=null;

    //Make an Ajax Call (this takes some time)
    //On Success do this:
        if(//Some Condition){
            myError=false;
        }else{
            myError=true
        }

        if(callback) {
           callback.apply();
        }
} 
```

如果你对 arity 不够通用感到困扰，你可以让函数接受一个对象而不是参数，所以：

```
function getNames(options) {
    var user = options.user;
    var location = options.loacation;
    var callback = options.callback;

    myError=null;

    //Make an Ajax Call (this takes some time)
    //On Success do this:
        if(//Some Condition){
            myError=false;
        }else{
            myError=true
        }

        if(typeof callback !== "undefined") {
           callback.apply();
        }
} 
```

当你打电话时`getNames`，你可以这样做：

```
getNames({
    user: "some user",
    location: "some location",
    callback: function() {
        ...
    }
}); 
```

或者

```
getNames({
    user: "some user",
    location: "some location"
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:28:48.847

在 jquery 中，如果您不喜欢回调（我非常希望您不喜欢 :)），那么您很幸运，我的朋友。$.ajax() 函数中有一个标志，您可以使用它来关闭该特定 AJAX 请求的异步。下面是代码示例：

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

```
var x = 1;
jQuery.ajax({
     url:    'http://example.com/catalog/create/',
     success: function(result) {
                x = 59;
              },
     async:   false
});

console.log(x);    //Should print 59 instead of 1 
```

# css - 绝对定位下拉菜单的 CSS 宽度和 IE7 问题

> ID：12410664
> 
> 赞同：0
> 
> 时间：2012-09-13T16:22:23.893
> 
> 标签：css, drop-down-menu, width, css-position

如何根据包含的链接长度自动定义下拉菜单的宽度：

以下是我拥有和想要的图片：

这是现实：

![在此处输入图像描述](../Images/d0c8b6cf3aa59bf78cb52483bcc45582.png)

这是我需要得到的：

![在此处输入图像描述](../Images/9bcd858340ca3b35bb4326b754cf1746.png)

这是我的 html 和 css（我尽可能减少了 HTML - 刚刚离开菜单）：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Title</title>

        <style type="text/css">
/* Main styles */

/*drop default browser css settings*/

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, font, img, ins, kbd, q, s, samp,
small, strike, strong, tt, var,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td {
margin: 0;
padding: 0;
border: 0;
outline: 0;
font-weight: inherit;
font-style: inherit;
font-size: 100%;
font-family: inherit;
vertical-align: baseline;
}
/* remember to define focus styles! */
:focus {
outline: 0;
}
body {
font: .8em 'Trebuchet MS', Trebuchet,Verdana, sans-serif;
line-height: 1;
color: #444;
background: white;
}
ol, ul {
list-style: none;
}
/* tables still need 'cellspacing="0"' in the markup */
table {
border-collapse: collapse;
border-spacing: 0;

}
caption, th, td {
text-align: left;
font-weight: normal;
}
blockquote:before, blockquote:after,
q:before, q:after {
content: "";
}
blockquote, q {
quotes: "" "";
}

#second_menu {
    margin: 25px 25px 0 40px;
    border-bottom: 1px dotted #BBBBBB;
}

#second_menu li {
    font-size: 1.1em;
    font-weight: bold;
    display: -moz-inline-stack;
    display: inline-block;
    zoom: 1;
    *display: inline;
    padding: 10px 20px 15px 0;
    position: relative;
    height: auto;
}

#second_menu li a {
    color: #757575;
    text-decoration: none;
}

#second_menu li.multiple > a {
    cursor: default;
}

#second_menu li:hover a,
#second_menu li.current a {
    color: #6F8936;
}

#second_menu li.multiple a span {
    background: url(../img/icons/sprite10.png) no-repeat -244px -370px;
    display: -moz-inline-stack;
    display: inline-block;
    zoom: 1;
    *display: inline;
    width: 7px;
    height: 7px;
    margin-left: 5px;
    vertical-align: middle;
}

#second_menu li.multiple:hover a span,
#second_menu li.multiple.current a span {
    background-position: -244px -379px;
}

#second_menu ul.subnav {
    list-style: none;
    position: absolute;
    top: 39px;
    left: -10px;
    background-color: #fff;
    border: 1px dotted #BBBBBB;
    border-top: none;
}

#second_menu .subnav li {
    display: block;
    padding: 0;
    margin: 0;
}

#second_menu .subnav li a {
    color: #868686;
    padding: 10px;
    display: block;
    font-weight: normal;
}

#second_menu .subnav li a:hover {
    color: #616161;
    background-color: #DFEBBD;
}

#second_menu li.multiple .subnav {
    display: none;
}

#second_menu li.multiple:hover .subnav {
    display: block;
}

    </style>
    </head>

<body id="main-page">

<div id="user-message-container"></div>
<!-- Header -->
<div id="header">
    <div class="header-content">
        <div id="user-block">

        </div>
       <div id="header-wrapper">
           <div id="header-left">
           <div id="logo">
            <a href="http://mysite.com/" title=""></a>
            </div>
            </div>
            <div id="header-menu">
            </div>
       </div>
    </div>
    <div class="clear"></div>
    <div class="header-content">
        <div id="info-search">
        </div>
        <ul id="second_menu">
                    <li class="current multiple"><a href="#">MENU1<span></span></a>
                        <ul class="subnav">
                            <li><a href="http://mysite.com/">Short name</a></li>
                            <li><a href="http://mysite.com/">This is a very long name</a></li>
                            <li><a href="http://mysite.com/">Shorty</a></li>
                        </ul>
                        </li>
                    <li class="multiple"><a href="#">MENU2<span></span></a>
                        <ul class="subnav">
                            <li><a href="http://mysite.com/">submenu1</a></li>
                            <li><a href="http://mysite.com/">submenu2</a></li>
                        </ul>
                        </li>
                    <li><a href="http://mysite.com/">MENU3</a>
                        </li>
                    <li><a href="http://mysite.com/">MENU4</a>
                        </li>
                    <li class="multiple"><a href="#">MENU5<span></span></a>
                        <ul class="subnav">
                            <li><a href="http://mysite.com/">submenu1</a></li>
                            <li><a href="http://mysite.com/">submenu2</a></li>
                        </ul>
                        </li>
                    <li><a href="http://mysite.com/">MENU6</a>
                        </li>
                    <li><a href="http://mysite.com/">MENU7</a>
                        </li>
                </ul>
    </div>
</div>
<!-- // Header -->
<div class="clear"></div>

<!-- Wrapper -->
<div id="wrapper">

<!-- // Main content (left column) -->
    <!-- Sidebar (right column) -->
    <div id="sidebar">

    </div>
    <!-- // Sidebar (right column) -->
<div class="clear"></div> </div>
<!-- // Wrapper -->

<!-- Footer -->
<div class="clear"></div>
<div id="footer">

</div>

<!-- // Footer  -->

</body>
</html> 
```

对此有任何帮助将不胜感激。

PS 另一个问题是在 IE7 中 - 当我将光标从菜单名称移动到子菜单块时 - 子菜单块消失，好像 :hover 效果丢失了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:40:34.143

尝试添加`white-space: nowrap`到您的子导航链接 -[**演示**](http://jsfiddle.net/EUj69/6/)

```
#second_menu .subnav li a {
    color: #868686;
    padding: 10px;
    display: block;
    font-weight: normal;
    white-space: nowrap; /* this */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:40:25.070

`position: relative`从删除中`#second_menu li`
删除`top: 39px;`和 `left: -10px;`从`#second_menu ul.subnav`
添加`margin-left:-10px`到`#second_menu ul.subnav`
添加`display:block;`到`#second_menu li a`

演示：http:
[//jsfiddle.net/EUj69/10](http://jsfiddle.net/EUj69/10)

编辑：IE7修复

# bash - 用变量替换可执行路径？

> ID：12410665
> 
> 赞同：1
> 
> 时间：2012-09-13T16:22:26.687
> 
> 标签：bash, unix

是否可以用变量替换可执行文件的路径？

```
CFBuildNumber=$(/usr/libexec/PlistBuddy -c "Print CFBuildNumber" $buildPlist) 
```

这就是我想做的，但我想我把语法弄乱了

```
buddyPath = /usr/libexec/PlistBuddy
CFBuildNumber=$($buddyPath -c "Print CFBuildNumber" $buildPlist) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:28:04.373

执行名称在变量中的命令应该可以正常工作，但是您不能那样设置变量。利用

```
buddyPath=/usr/libexec/PlistBuddy 
```

周围没有空格`=`。

# c# - 无法从传输连接异常中读取数据

> ID：12410666
> 
> 赞同：1
> 
> 时间：2012-09-13T16:22:28.287
> 
> 标签：c#, mysql, entity-framework

我有一个 MySQL 5.5 DB 服务器，使用 Entity Framework 4.3，MySQL Connector 6.5.4。

我看到的问题是通过慢速连接（~192kbs）似乎相当一致。

场景是我首先调用一个如下所示的方法：

```
using (var db = new IceCreamEntities(ConnectionString, null, null, null, "infinite timeout"))
{
   db.desserts.Add(myDessert);
   db.SaveChanges()

   db.dessertData.Add(new dessertBlob() { DessertId = myDessert.Id, Data = someData });
} 
```

然后我在那之后（比如说，在 30 秒左右）密切调用一个方法来取回它。看起来像：

```
using (var db = new IceCreamEntities(ConnectionString, null, null, null, "infinite timeout"))
{
   var myDessertData = db.dessertData.Where(m => m.DessertId == myId).FirstOrDefault();
   return myDessertData;
} 
```

现在，`IceCreamEntities`我正在使用的构造函数调用执行以下操作：

```
public IceCreamEntities(string connectionString, string unused2, string unused3, string unused4, string forLongRunningStuff)
: base(connectionString)
{
   var objectContext = (this as IObjectContextAdapter).ObjectContext;
   objectContext.CommandTimeout = 0;
} 
```

*（还有一些其他构造函数用于不同的超时，但这可能与讨论无关）*

我放入甜点数据表的 blob 大小约为 3 兆字节。

当我的连接速度不慢时，我看不到这个问题。

我得到的例外是：

> System.Data.EntityCommandExecutionException：执行命令定义时出错。有关详细信息，请参阅内部异常。
> 
> ---> MySql.Data.MySqlClient.MySqlException: 命令执行过程中遇到致命错误。
> 
> ---> MySql.Data.MySqlClient.MySqlException：尝试读取结果集时遇到致命错误。
> 
> ---> MySql.Data.MySqlClient.MySqlException：从流中读取失败。
> ---> System.IO.IOException: Unable to read data from the transport connection: 一个现有的连接被远程主机强行关闭。
> 
> ---> System.Net.Sockets.SocketException: 现有连接被远程主机强行关闭
> 
> 在 System.Net.Sockets.NetworkStream.Read（字节 [] 缓冲区，Int32 偏移量，Int32 大小）
> 
> --- 内部异常堆栈跟踪结束 ---
> 
> 在 MySql.Data.Common.MyNetworkStream.HandleOrRethrowException（异常 e）
> 
> 在 MySql.Data.Common.MyNetworkStream.Read（字节 [] 缓冲区，Int32 偏移量，Int32 计数）
> 
> 在 MySql.Data.MySqlClient.TimedStream.Read（字节 [] 缓冲区，Int32 偏移量，Int32 计数）
> 
> 在 System.IO.BufferedStream.Read（字节 [] 数组，Int32 偏移量，Int32 计数）
> 
> 在 MySql.Data.MySqlClient.MySqlStream.ReadFully（流流，字节 [] 缓冲区，Int32 偏移量，Int32 计数）
> 
> 在 MySql.Data.MySqlClient.MySqlStream.LoadPacket()
> 
> --- 内部异常堆栈跟踪结束 ---
> 
> 在 MySql.Data.MySqlClient.MySqlStream.LoadPacket()
> 
> 在 MySql.Data.MySqlClient.MySqlStream.ReadPacket()
> 
> 在 MySql.Data.MySqlClient.NativeDriver.FetchDataRow（Int32 statementId，Int32 列）
> 
> 在 MySql.Data.MySqlClient.Driver.FetchDataRow（Int32 statementId，Int32 列）
> 
> 在 MySql.Data.MySqlClient.ResultSet.GetNextRow()
> 
> 在 MySql.Data.MySqlClient.ResultSet..ctor（驱动程序 d，Int32 statementId，Int32 numCols）
> 
> 在 MySql.Data.MySqlClient.Driver.NextResult（Int32 statementId，布尔力）
> 
> 在 MySql.Data.MySqlClient.MySqlDataReader.NextResult()
> 
> --- 内部异常堆栈跟踪结束 ---
> 
> 在 MySql.Data.MySqlClient.MySqlDataReader.NextResult()
> 
> 在 MySql.Data.MySqlClient.MySqlCommand.ExecuteReader（CommandBehavior 行为）
> 
> --- 内部异常堆栈跟踪结束 ---
> 
> 在 MySql.Data.MySqlClient.MySqlCommand.ExecuteReader（CommandBehavior 行为）
> 
> 在 MySql.Data.Entity.EFMySqlCommand.ExecuteDbDataReader（CommandBehavior 行为）
> 
> 在 System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands（EntityCommand entityCommand，CommandBehavior 行为）
> 
> --- 内部异常堆栈跟踪结束 ---
> 
> 在 System.Data.EntityClient.EntityCommandDefinition.ExecuteStoreCommands（EntityCommand entityCommand，CommandBehavior 行为）
> 
> 在 System.Data.Objects.Internal.ObjectQueryExecutionPlan.Execute[TResultType]（ObjectContext 上下文，ObjectParameterCollection 参数值）
> 
> 在 System.Data.Objects.ObjectQuery `1.GetResults(Nullable`1 forMergeOption)
> 
> 在 System.Data.Objects.ObjectQuery`1.System.Collections.Generic.IEnumerable.GetEnumerator()
> 
> 在 System.Linq.Enumerable.FirstOrDefault[TSource]（IEnumerable`1 源）
> 
> 在 System.Data.Entity.Internal.Linq.DbQueryProvider.Execute[TResult]（表达式表达式）
> 
> 在 System.Linq.Queryable.FirstOrDefault[TSource]（IQueryable`1 源）
> 
> 在 IceCream.Repository.GetDessertData(Int64 dessertId) 在 ....

另一个数据点 - 我可以使用相同大小的 blob 调用连续两次添加的方法，但我没有收到此错误（或等效错误）。仅当我执行添加然后使用检索跟进时才会发生这种情况。

任何想法如何解决这个问题？我曾认为将命令超时值设置为 0 可以解决我的问题，但事实并非如此。

**编辑**

另一点是我做了数学计算，192mbs 的 3 兆字节应该需要大约 128 秒的时间来传输。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T18:03:44.697

因此，经过大量搜索和阅读，我调整了 my.ini 文件中的以下值：

> **net_read_timeout**
> 
> **net_write_timeout**

通过将它们设置为值**99999**并重新启动我的数据库服务器，我现在可以通过慢速连接检索该 3M 文件，而不会发生进一步的事件。

# scala - Scala - 相同但不同的类型

> ID：12410669
> 
> 赞同：0
> 
> 时间：2012-09-13T16:22:48.143
> 
> 标签：scala, inheritance, types

我有以下代码：

```
trait CellT[VAL <: AnyVal] {
  var value: VAL
  type NEXT <: AnyVal
  var next: CellT[NEXT]
}

abstract class Cell[VAL <: AnyVal] extends CellT[VAL] {
  var next = this  // defaults to `this`. ERROR
}

// impl example:
class CellInt extends Cell[Int] {
  var value: Int = 0
} 
```

错误说

> 在 Cell[Cell.this.NEXT] 类型的特征 CellT 中覆盖变量 next；变量 next 具有不兼容的类型

很明显，`this`它将具有与`VAL <: AnyVal`相同的类型`NEXT <: AnyVal`，但是，我仍然得到错误。我如何告诉 Scala`next`应该能够返回任何类型`Cell[A <: AnyVal]`，但这种类型*不*应该与类类型参数相同`[VAL <: AnyVal]`？？？否则我可以使用`[VAL]`，但它会限制太多，例如因为`Cell[Int]`它会限制`next`方法只返回`Cell[Int]`类型实例。但我希望`next`可以重新分配给任何其他`Cell[*]`类型的实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:19:18.383

如果您想`next`重新分配给任何其他 Cell[*] 类型实例，您可以使用[存在类型](http://www.cakesolutions.net/teamblogs/2012/09/03/existential-types/)：

```
trait CellT[VAL <: AnyVal] {
  var value: VAL
  var next: CellT[_ <: AnyVal]
}

abstract class Cell[VAL <: AnyVal] extends CellT[VAL] {
  var next: CellT[_ <: AnyVal] = this // defaults to `this`
  override def toString = "Cell(%s,%s)".format(value, if(next == this) "this" else next.toString)
}

// impl example:
class CellInt extends Cell[Int] {
  var value: Int = 0
}

class CellBoolean extends Cell[Boolean] {
    var value = false
}

var c1 = new CellInt
var c2 = new CellBoolean

println(c1)
c1.value = 1
println(c1)
c1.next = c2
println(c1)

println(c2)
c2.value = true
println(c1)
println(c2) 
```

输出：

单元格(0,this)
单元格(1,this)
单元格(1,Cell(false,this))
单元格(false,this)
单元格(1,Cell(true,this))
单元格(true,this)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:39:42.213

> 很明显，这将具有类型 VAL <: AnyVal 与 NEXT <: AnyVal 相同

不，它们不一样，它们只是共享相同的约束。NEXT 尚未指定。想象一下，您随后像这样子类化 Cell：

```
class StringNextCell extends Cell {
    type NEXT = String
} 
```

现在，`StringNextCell.next`应该是类型`Cell[String]`，但您来自 Cell 的声明将其声明为`Cell[Int]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T17:45:53.177

这与其说是一个警告，不如说是一个答案。一个月前我写了非常相似的代码，我花了很多次迭代才知道当谈到 Scala 类型时，越粗越好。

请记住，Scala 类型参数检查仅在编译时进行，因此它通常比您想象的要粗略。花 15 分钟编译您的代码，却发现您的 X[Foo <: Bar] 被视为 X[_]，这真的很烦人。

我建议您从以下内容开始：

```
abstract class Cell[VAL] {
    var value: VAL
    var next: Cell[_]
} 
```

并且只有在您有迫切需要时才能更具体。很有可能，如果您需要知道 next 的类型，无论如何您都需要进行明确的运行时检查。

# sitefinity - SQLDriver 未使用服务器版本初始化

> ID：12410671
> 
> 赞同：0
> 
> 时间：2012-09-13T16:22:49.913
> 
> 标签：sitefinity

我在 sitefinity 4.4 上收到以下错误

> SQLDriver 未使用服务器版本初始化。

我在 sitefinity 论坛上查看过，但找不到任何解决此问题的方法

SQLDriver 未使用服务器版本初始化。

描述：

> 当前 Web 请求执行期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详情：

> System.InvalidOperationException：SQLDriver 未使用服务器版本初始化。

源错误：

> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

堆栈跟踪：

```
[InvalidOperationException: SQLDriver not initialized with server version.]
   OpenAccessRuntime.Relational.RelationalMetaDataBuilder.findMatchingJdbcColumn(DataObjectsExtension[] nested) +398
   OpenAccessRuntime.Relational.RelationalMetaDataBuilder.createJdbcSimpleField(FieldMetaData fmd) +204
   OpenAccessRuntime.Relational.RelationalMetaDataBuilder.createJdbcField(FieldMetaData fmd, Boolean quietParam) +125

[MetadataException: The metadata for field 'id' of class 'Telerik.Sitefinity.Metadata.Model.MetaAttribute' cannot be initialized: SQLDriver not initialized with server version.]
   DynamicModule.ns.Wrapped_OpenAccessMetaDataProvider_904ca528250e4b188a43261dbbe077b6.Initialize(String providerName, NameValueCollection config, Type managerType) +405
   Telerik.Sitefinity.Data.ManagerBase`1.InstantiateProvider(IDataProviderSettings providerSettings, Type providerType, ExceptionPolicyName policy, ManagerBase`1 manager) +1976
   Telerik.Sitefinity.Data.ManagerBase`1.InstantiateProvider(IDataProviderSettings providerSettings, ExceptionPolicyName policy, ManagerBase`1 manager) +74
   Telerik.Sitefinity.Data.ManagerBase`1.SetProvider(String providerName, String transactionName) +526 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:00:03.127

你有没有机会在 Visual Studio 2012 中运行它？我相信 Sitefinity 4.4 中的 OpenAccess 版本与 VS2012 不兼容，如果您从该环境（或 IIS 中的 asp.net 4.5）运行它，则会引发此错误。

如果是这种情况，请尝试在 VS2010 中打开，然后希望您能够升级到最新版本以支持 VS2012。

如果根本不是这种情况，我肯定会建议将此作为门票发送给 Sitefinity 支持，以便他们仔细查看您的项目！

我希望这是有帮助的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-20T18:57:43.990

以防万一这有助于某人：

我遇到了这个错误，不是使用 Sitefinity，而是在一个相当老的应用程序中，它使用了一些在 Sitefinity 中也使用的相同 Telerik 库。该应用程序使用 SQL Server 2005 和 2008 R2 运行良好，但在 2012 及更高版本中运行失败。

库中的某些内容无法识别 2008 R2 以上的任何 SQL Server 版本。（从回溯中的线索来看，库的一部分似乎存储了 SQL 版本，另一部分查看它。第一部分无法识别 SQL 2012 及更高版本，因此它不存储任何内容。）

明显的含义是需要更新版本的库。我们没有编写或构建应用程序，因此很遗憾，直到/除非我们能够获得（或制作）使用更新库的应用程序版本，我们才能这样做。

但是对于最初的问题，更新版本的 Sitefinity 或使用早期版本的 SQL Server 可能会起作用。

无论如何，也许这些信息可以帮助可能看到相同消息的人。

# asp.net-mvc-3 - 不支持使用相同的 DbCompiledModel 针对不同类型的数据库服务器创建上下文

> ID：12410673
> 
> 赞同：21
> 
> 时间：2012-09-13T16:22:55.250
> 
> 标签：asp.net-mvc-3

我正在从 Microsoft 的教程中学习 ASP.NET MVC：

[http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/accessing-your-model's-](http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/accessing-your-model) [https://stackoverflow.com/editing-helpdata-from-a-](https://stackoverflow.com/editing-helpdata-from-a-controller) _[控制器](https://stackoverflow.com/editing-helpdata-from-a-controller)

在上面提到的链接中，在添加一个名为“MoviesController”的控制器时，我收到了这个错误

“无法检索 'MvcMovie.Models.Movie' 的元数据。不支持使用相同的 DbCompiledModel 针对不同类型的数据库服务器创建上下文。相反，为正在使用的每种类型的服务器创建一个单独的 DbCompiledModel”

我该如何解决？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-19T22:00:58.990

我遇到过同样的问题。

`providerName="System.Data.SqlServerCe.4.0"`我用切换`providerName="System.Data.SqlClient"`，它创建了控制器和视图。

我发现了这个：http: [//msdn.microsoft.com/en-US/library/ms171861.aspx](http://msdn.microsoft.com/en-US/library/ms171861.aspx)

我按照指示添加了对 SQL Server Compact 的引用，但它仍然不起作用。

我还尝试注释掉默认的 SQL Server Express 连接，但在尝试添加控制器时仍然出现相同的错误。

我只是打算使用 SQL Server Express。如果我有任何问题，我会告诉你。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-28T01:55:31.017

我发现使用以下方法：（假设您安装了 SQL Server Express 或更高版本）

```
 <add name="MovieDBContext" providerName="System.Data.SqlClient" connectionString="Data Source=(LocalDb)\v11.0;AttachDBFilename=|DataDirectory|MovieDB.sdf"/> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-31T00:44:06.090

我认为这个错误的原因是因为 VS 在搭建脚手架时难以重用现有的 DBContext。VS 尝试在 DBContext 中使用具有相似域名称的属性（例如尝试连接“s”的域名）。如果它找不到该属性并且您的上下文已经有一个带有您的 Domain 类的 DBSet，它会生成该错误。

我的解决方案是创建一个名为“DeleteContext”的新 DBContext。成功创建控制器和视图后，我已将控制器中的“DeleteContext”替换为现有的。最后我删除了“DeleteContext”类。

它工作得很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T20:04:02.463

[我在使用 Visual Studio 2012 ( http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-5](http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-5) )时在另一个 Microsoft ASP.NET MVC 教程中遇到了同样的错误. 我决定，为了完成本教程，使用 SQL Express 代替 SQL CE 会更容易。

我为解决这个问题所做的是从服务器资源管理器中删除 MvcMusicStore.sdf，然后从解决方案资源管理器中的 App_Data 中删除相同的数据库文件。

我更新了 Web.config 中的连接字符串部分，以使用 Sql Express 数据库 (.mdf) 代替 Sql CE (.sdf)。对于这个特定的教程，`MusicStoreEntities`是扩展类的名称`DbContext`：

```
<connectionStrings>
    <add name="MusicStoreEntities" connectionString="Data Source=(LocalDB)\v11.0;AttachDbFilename=|DataDirectory|\MvcMusicStore.mdf;Integrated Security=True" providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

我构建了解决方案，运行了站点，并为我重新生成了数据库。要将数据库文件添加回解决方案，请单击解决方案资源管理器中的“显示所有文件”按钮，右键单击 App_Data 中的 .mdf 文件，然后选择“包含在项目中”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-14T02:45:20.573

嗨，有一个对我来说很好的解决方案。在您的 Web.config 中，教程告诉您在该部分中添加以下行`connectionStrings`：

```
<add name="SchoolContext" connectionString="Data Source=|DataDirectory|School.sdf" providerName="System.Data.SqlServerCe.4.0"/> 
```

不要删除或更改它！

当您添加新控制器时，您可以这样做以避免出现的错误：

1.  评论上面的行。
2.  添加以下行： `<'add name="SchoolContext" connectionString="Data Source=|DataDirectory|School.sdf" providerName="System.Data.SqlClient"/>`
3.  保存您的解决方案
4.  添加控制器
5.  在运行您的应用程序之前，取消注释您已注释的行 (1)，并注释您添加的行（带有 的行`providerName="System.Data.SqlClient"`）(2)。

添加控制器时，这对我来说非常好。

希望这可以帮助你。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-20T16:06:55.250

该解决方案对我不起作用，它继续存在`return View(db.Movies.ToList());`

而是使用这个：

```
<add name="MovieDBContext" connectionString="Data Source=|DataDirectory|Movie.sdf" providerName="System.Data.SqlServerCe.4.0"/> 
```

和这个：

```
public class MovieDBContext : DbContext
{
   public MovieDBContext() : base("Movie") { }
   public DbSet<Movie> Movies { get; set; }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-05T08:09:07.837

我在阅读 Contoso University asp.net MVC 教程时遇到了同样的问题。问题似乎来自将 SQL Server Compact 连接字符串与成员资格提供程序 Sql Server 连接混合。

我最初使用了 hyperGeoMetric 的修复程序，并且确实有效。然后我查看了可下载代码的 web.config 并注意到了一些额外的配置。

如果您使用以下内容添加/替换 entityFramework 的默认参数：

```
<parameters>
        <parameter value="Data Source=(localdb)\v11.0; Integrated Security=True; MultipleActiveResultSets=True" />
</parameters> 
```

添加一个 system.data 部分，如下所示：

```
<system.data>
    <DbProviderFactories>
      <remove invariant="System.Data.SqlServerCe.4.0" />
      <add name="Microsoft SQL Server Compact Data Provider 4.0" invariant="System.Data.SqlServerCe.4.0" description=".NET Framework Data Provider for Microsoft SQL Server Compact" type="System.Data.SqlServerCe.SqlCeProviderFactory, System.Data.SqlServerCe, Version=4.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
    </DbProviderFactories>
  </system.data> 
```

并修改现有（默认） DefaultConnection 如下所示：

```
<add name="DefaultConnection" providerName="System.Data.SqlServerCe.4.0" connectionString="Data Source=|DataDirectory|aspnet-membership.sdf" /> 
```

在这些修改之后，我能够使用 Sql Server Compact 版本继续本教程。

山姆

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-01T06:02:30.343

如果您使用的是 VS 2012，您还需要告诉 EF 使用 SQL Compact 而不是 localDb。

```
<entityFramework>
<defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlCeConnectionFactory, EntityFramework">
  <parameters>
    <parameter value="System.Data.SqlServerCe.4.0" />
  </parameters>
</defaultConnectionFactory> 
```

一种更简单的方法是安装[EF SQL Compact Nuget 包](http://nuget.org/packages/EntityFramework.sqlservercompact)。

有关更多详细信息，请查看此[博客条目](http://odetocode.com/Blogs/scott/archive/2012/08/14/a-troubleshooting-guide-for-entity-framework-connections-amp-migrations.aspx)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-04-28T21:39:06.117

我也遵循了该教程，并遇到了同样的问题。我删除了连接字符串，然后我能够添加控制器，它创建了其他文件。然后我再次将相同的连接字符串添加到 Web.config 文件中，将它准确地插入到之前的相同位置。它解决了我的问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-14T07:58:06.593

我只是尝试了一下，发现了问题。

在本教程中，您将在 web.config 中添加以下行

```
<add name="MovieDBContext" connectionString="Data Source=|DataDirectory|Movies.sdf" providerName="System.Data.SqlServerCe.4.0"/> 
```

似乎它有问题..我只是将其注释掉并使用了SqlServer，它对我有用。如果您仍想使用 SqlServerCe，您需要查看如何解决该问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-08-09T02:40:42.097

我正在学习本教程： http: [//mvcmusicstore.codeplex.com/](http://mvcmusicstore.codeplex.com/)。并得到同样的错误。我在 NuGet 包列表中找到了一个项目名称“EntityFramework.SqlServerCompact”，并安装它，一切正常！注意，包依赖的实体框架，你可以在这里查看所有版本：[https](https://www.nuget.org/packages/EntityFramework.SqlServerCompact) ://www.nuget.org/packages/EntityFramework.SqlServerCompact 。祝你好运！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-25T08:05:35.223

数据源路径错误，可以在“Movie.sdf”前加一个“\”。像这样：

```
<add name="MovieDBContext" connectionString="Data Source=|DataDirectory|\Movie.sdf" providerName="System.Data.SqlServerCe.4.0"/> 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-10-15T18:14:41.523

我在另一个解决方案中遇到了同样的问题。它出现在我引入对基本构造函数的参数化调用之后，就像默认`UsersContext`类中包含的调用一样。

这失败了

```
public class MovieDBContext : DbContext
{
  public MovieDBContext() : base("DefaultConnection")
  {
  }

  ...
} 
```

这有效

```
public class MovieDBContext : DbContext
{
  // No constructor here
  ...
} 
```

似乎在构造函数中命名连接字符串会产生错误。我的 web.config 中只有一个连接字符串，所以`DefaultConnection`仍然使用，尽管我没有明确命名它。

# google-bigquery - 使用 BigQuery 时跨用户/应用共享数据集

> ID：12410680
> 
> 赞同：1
> 
> 时间：2012-09-13T16:23:33.103
> 
> 标签：google-bigquery

据我了解，有公共数据集（由 Google 团队维护）和私有数据集（由用户/应用程序创建）。

是否可以共享由 1 个用户为 1 个应用程序创建的私有数据集，以便使用 OAuth 与另一个应用程序共享？是否也可以像对该数据集的只读或读写访问一样控制访问？

谢谢，阿米特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:58:10.497

所有数据集都有允许与其他用户共享的 ACL。您可以在 BigQuery UI 中更新数据集的 ACL，如果您直接使用 BigQueryAPI，则可以使用数据集[PATCH API 。](https://developers.google.com/bigquery/docs/reference/v2/datasets/patch)

# .net - 在 iPhone 上加密、在 .Net 服务器上使用 System.Security.Cryptography 解密时出现 iOS CCCrypt 填充问题

> ID：12410682
> 
> 赞同：0
> 
> 时间：2012-09-13T16:23:40.497
> 
> 标签：.net, objective-c, ios, cryptography, aes

这是一个令人头疼的问题。它涉及加密，使其特别粗糙！

我有使用 CCCrypt 到 AES 128 的 Objective-C 代码加密我使用协议缓冲区和 AsyncSockets 发送的 iPhone 上的消息。iOS代码如下：

```
- (NSData *)AES128EncryptWithKey:(const char *)keyPtr {

    NSUInteger dataLength = [self length];

    //See the doc: For block ciphers, the output size will always be less than or 
    //equal to the input size plus the size of one block.
    //That's why we need to add the size of one block here
    size_t bufferSize = dataLength + kCCBlockSizeAES128;
    void *buffer = malloc(bufferSize);

    size_t numBytesEncrypted = 0;
    CCCryptorStatus cryptStatus = CCCrypt(kCCEncrypt, kCCAlgorithmAES128, kCCOptionPKCS7Padding,
                                          keyPtr, kCCKeySizeAES128, // oorspronkelijk 256
                                          keyPtr /* initialization vector (optional) */,
                                          [self bytes], dataLength, /* input */
                                          buffer, bufferSize, /* output */
                                          &numBytesEncrypted);
    if (cryptStatus == kCCSuccess) {
        //the returned NSData takes ownership of the buffer and will free it on deallocation
        return [NSData dataWithBytesNoCopy:buffer length:numBytesEncrypted];
    } else {
        free(buffer); //free the buffer;
        return nil;
    }
} 
```

我将 AES 托管对象定义如下：

```
 AesManaged AES = new AesManaged();
    AES.Padding = PaddingMode.PKCS7;
    var shared = /* a shared key */
    var salt = shared + DH.P;
    Rfc2898DeriveBytes deriveBytes = /* derived bytes from shared */
    byte[] ekey = deriveBytes.GetBytes(16);
    byte[] eiv = ekey;
    AES.Key = ekey;
    AES.IV = eiv; 
```

然后，我使用以下 C# .Net 代码在我的服务器上解密这些数据：

```
public byte[] Decrypt(byte[] encryptedData)
{
    byte[] dec = null;
    MemoryStream ms = new MemoryStream(encryptedData);
    using (CryptoStream cs = new CryptoStream(ms, AES.CreateDecryptor(), CryptoStreamMode.Read))
    {
         BinaryReader reader = new BinaryReader(cs);
         dec = reader.ReadBytes(encryptedData.Length);
         reader.Close();
    }
    return dec;
} 
```

当我在 iOS 模拟器中运行以及从 Xcode 调试到设备本身时，这非常有效。但是，当我创建应用程序的分发包（IPA 文件）并将其部署到设备时，我在服务器上收到此异常：

```
System.Security.Cryptography.CryptographicException: Padding is invalid and cannot be removed. 
```

我发送的导致此问题的数据的未加密数据长度为 4，从而创建了 16 的加密大小。由于我相信这是 AES 块大小，这似乎是正确的。调试日志显示这是已部署应用程序和模拟器上消息的大小。所以大小似乎没有错。

阅读有关此异常的信息向我表明，填充的创建方式存在问题。但是，为什么在设备上部署与通过调试器或模拟器运行时会有所不同？

提前致谢。几天来我一直在试图解决这个问题，这阻止了我让我的应用程序被 Apple 测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:27:00.060

几个注意事项：

a）您能否显示从 iOS 上的共享密钥派生加密密钥的代码。

您为 .NET 显示了此代码，但没有为 iOS 显示。

b) 确保 iOS 上的 keyPtr 实际上包含 128 位（16 字节）。如果由于任何原因它包含较少，您可能对此有疑问

c) 我不建议将 keyPtr 作为 IV 传递。一般来说，这是一个不好的做法。您应该为每个加密文件创建新的唯一 IV。

出于测试目的，您可以将其设置为 NULL（少一个变量需要担心）。

d) 您能否展示派生加密密钥的整个 .NET 代码。有几点不清楚：

*   什么是DH.P？

*   Rfc2898DeriveBytes derivedBytes = /* 从共享中派生的字节 */ 据我所知，应该有类似 new Rfc2898DeriveBytes(pwd, salt); 你用什么作为密码和盐并不明显。

# android - 如何检索没有布局的片段？

> ID：12410683
> 
> 赞同：0
> 
> 时间：2012-09-13T16:23:40.787
> 
> 标签：android, android-fragments, android-activity

我正在使用不使用我创建的布局的 ListFragment，我需要一种方法来设置片段的 ID，以便我可以通过活动的 getSupportFragmentManager.findFragmentByID(fragId) 方法访问它。

在我尝试访问的片段的 onCreateView 方法中，我对传入的容器执行了 setId(R.id.notes_fragment)。我将其设置为引用 res/values/ids 中的以下代码的 id。 xml。这是 ids.xml 的内容：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <item type="id" name="notes_fragment" />
</resources> 
```

但是当我这样做时 frag 为空：

```
NotesFragment frag = (NotesFragment) this.getSupportFragmentManager().findFragmentById(R.id.notes_fragment); 
```

我用它来提交片段： getSupportFragmentManager().beginTransaction().add(android.R.id.content, notesFrag, NotesFragment.TAG).commit();

文档说我可以使用这个提交片段的 ID 通过 findFragmentById 访问它。如何获取此已提交片段的 ID？我试图传递我试图访问的片段的 ID，以启动活动（需要与片段对话的那个），但它仍然为空。

编辑：

**我刚刚发现了 findFragmentByTag，**但即使我引用了片段的 TAG，即使片段仍然存在，它仍然返回 null。

# python - Python Skype4Py 消息状态保持为“正在发送”

> ID：12410684
> 
> 赞同：2
> 
> 时间：2012-09-13T16:23:43.597
> 
> 标签：python, skype4py

```
import Skype4Py

skype=Skype4Py.Skype()

skype.Client.Start()

skype.Attach()

skype.SendMessage('echo123','Test') 
```

该代码有效，但由于某种原因，当我发送消息时，它的状态仍然存在`SENDING`，因此我无法发送任何消息。

编辑：事实证明，只要联系人在线，该方法就会发送消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T20:09:03.317

始终在用户在线时发送消息。

# c# - 确定 DropDownlist 选择是否为粗体

> ID：12410685
> 
> 赞同：0
> 
> 时间：2012-09-13T16:23:50.373
> 
> 标签：c#, asp.net, drop-down-menu

我正在编写一个使用下拉列表来显示各种选项的 asp.net 应用程序。根据用户的授权，某些选项是不允许选择的。
受限制的选项以粗体显示。
如何确定用户是否选择了粗体选项之一？我知道这是一种奇怪的做法，但这是应用程序所有者希望它完成的方式。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:10:28.043

您可以尝试询问 DropDownList.SelectedItem 的属性以查看所选项目是否受到限制。你如何设置它，字体属性将决定你如何询问选定的项目。

唯一的另一种方法是重新运行逻辑以确定所选值，或将粗体项目的索引存储在隐藏字段或视图状态属性中，或类似的东西。

# r - rbundler 构建错误：“无法打开文件'startup.Rs'：没有这样的文件或目录”

> ID：12410694
> 
> 赞同：10
> 
> 时间：2012-09-13T16:24:06.417
> 
> 标签：r, dependencies, package, devtools

我在构建以下软件包时遇到了问题：[https ://github.com/yoni/rbundler](https://github.com/yoni/rbundler)

我的[测试](https://github.com/yoni/rbundler/blob/master/inst/tests/test-bundle.r)尝试`bundle`在具有单个依赖项的普通包上运行 rbundler 的命令。测试在我的 OSX 机器上通过，但在我的 x86_64-redhat-linux-gnu Jenkins 服务器上失败。两台机器都运行带有 0.7.1 的 R 2.15.1 `devtools`，其中包括[此错误修复](https://github.com/hadley/devtools/commit/303ec092f4359e3f4dd71664b56bb3f790d284fa#R/system.r)。

完整的测试输出可以在[这个 gist](https://gist.github.com/3715368)中找到。

这是我看到的错误的简短摘要：

```
Error in file(filename, "r", encoding = encoding) : 
  cannot open the connection
Calls: local ... eval.parent -> eval -> eval -> eval -> eval -> source -> file
In addition: Warning message:
In file(filename, "r", encoding = encoding) :
  cannot open file 'startup.Rs': No such file or directory
Execution halted 
```

* * *

这样做的背景是我正在尝试为 R 构建一个依赖管理系统。这个想法是一个 R 项目应该能够在不使用系统范围或用户范围的库的情况下运行。相反，R 项目将在其根目录下安装自己的库。

对于我之前与 R 中的依赖管理相关的 Stack Overflow 问题，请参阅 R 中的[依赖管理](https://stackoverflow.com/questions/7730180/dependency-management-in-r)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-01-16T23:15:25.553

在我的情况下，这个问题是由`R_TESTS`设置为的环境变量引起的`startup.Rs`

当您从测试中执行另一个 R 进程时（在我的情况下，它是通过 OGS qsub 提交的），此环境变量的存在会导致问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:58:44.177

我无法直接回答您的问题，但您可以尝试两件事来获取有关正在发生的事情的更多信息。

1.  使用 'env' 在你的 OSX 机器和 Jenkins 主机上转储环境变量
2.  通过 Linux 上的 strace 和 OSX 上的 dtruss 运行该进程以捕获系统调用

strace/dtruss 应该显示它正在搜索启动的位置。Rs 和 env 输出可能会为您提供一个环境变量，该变量在系统之间会有所不同，从而导致不同的结果。

# php - PHP 中的新行 ("\n") 不起作用

> ID：12410695
> 
> 赞同：18
> 
> 时间：2012-09-13T16:24:12.940
> 
> 标签：php, xampp

出于某种奇怪的原因，插入`echo "\n";`和其他转义序列字符对我不起作用，这就是为什么我只是使用它`<br />`。

书籍和其他文档中示例结果的图像似乎还不错。我目前正在使用 XAMPP，并且已经使用了具有相同实际结果的 WAMPP。这是为什么？

**编辑：**

在将您的答案与以下内容进行比较后，我似乎无法理解这个概念： [PHP Linefeeds (\n) Not Working](https://stackoverflow.com/questions/3016034/php-linefeeds-n-not-working)

编辑：

抱歉，我没有意识到上面的链接是指写入文件的 php 代码。我只是想知道为什么我有这些使用 \n 的几个 php 示例程序，即使它在网页中输出。谢谢大家。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-09-13T16:49:05.370

当您在浏览器中运行 PHP 脚本时，默认情况下它将呈现为 HTML。如果您使用的书籍以其他方式显示，则代码或插图不准确。您可以使用“查看源代码”查看发送到浏览器的内容，您会看到您的换行符出现了。

```
<?php
echo "Line 1\nLine 2";
?> 
```

这将在您的浏览器中呈现为：

```
Line 1 Line 2 
```

如果您需要将纯文本发送到浏览器，您可以使用以下内容：

```
<?php
header('Content-type: text/plain');
echo "Line 1\nLine 2";
?> 
```

这将输出：

```
Line 1
Line 2 
```

[PHP Linefeeds (\n) Not Working](https://stackoverflow.com/questions/3016034/php-linefeeds-n-not-working)是指将输出发送到*文件*而不是浏览器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-13T16:26:07.007

你应该在寻找[`nl2br()`](http://php.net/manual/en/function.nl2br.php). `<br>`这将在浏览器呈现的输出中添加换行符（ ）；换行符不是。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-13T16:40:35.707

这`echo "\n"`可能正在工作，只是不是您期望的方式。

该命令将插入一个换行符。从它的声音来看，您正在使用浏览器查看您的输出。请注意，如果您编写的 HTML 文件的正文内容如下所示：

```
<p>This
is
a
test </p> 
```

浏览器渲染将不包含新行，而只会显示“这是一个测试”

如果您想查看换行符，您可以查看源代码，您会看到源代码包含换行符。

经验法则是，如果您需要在浏览器中换行，则需要使用 HTML（例如`<br />`），而如果您想要纯文本，则可以使用`\n`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-13T16:25:59.923

`<br />`是换行的 HTML 标签，而 "\n" 是输出一个新行（真实的）。

每次 HTML 文件转到下一行时，浏览器都不会输出新行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T16:27:17.417

您可以使用[nl2br](http://php.net/manual/en/function.nl2br.php)函数转换`\n`为`<br>`

如前所述，HTML 不会呈现`\n`为新行。它只识别`<br>`html 标签

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-05T08:19:51.737

如果您正在使用 HTML（例如在浏览器中查看结果），则必须使用 HTML 换行方式，即：`<br>`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-23T07:18:19.323

`/n`仅当它用作简单文本时才有效，但在这里，当我们在 html 文档中编码时，它会将其作为 HTML 文本，因此您可以改用`</br>`标签。

# jquery - jquery .animate 不透明度和背景颜色同时在同一个元素上

> ID：12410697
> 
> 赞同：-1
> 
> 时间：2012-09-13T16:24:13.580
> 
> 标签：jquery, jquery-animate, opacity, background-color

我正在尝试同时为元素的不透明度和背景颜色设置动画。我正在使用下面的代码，但目前只有不透明度动画。

```
$("div.offer").mouseover(function() {
var myClass = $(this).attr("class");

$(this).stop().animate({width:'259px'}, {queue:false, duration:600, easing:'easeOutQuint'});

if (myClass == "offer windows") {
    $(".offer.windows .offerBackground").stop().animate({opacity:'1'}, {queue:false, duration:600, easing:'easeOutQuint'});
    $(".offer.windows .offerBackground").stop().animate({backgroundColor:'#B0C1C8'}, {queue:false, duration:600, easing:'linear'});
}
}); 
```

是否可以同时为两者制作动画？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:25:46.917

对于动画颜色，您需要使用[jQuery UI](http://jqueryui.com)。jQuery 核心本身不会为与颜色相关的属性设置动画。

# java - Java 多线程同步

> ID：12410700
> 
> 赞同：0
> 
> 时间：2012-09-13T16:24:17.963
> 
> 标签：java, multithreading

我无法与三个线程共享资源......

```
 public class Subject{

        int i;
        boolean valueSet1 = false;
        boolean valueSet2 = true;
        boolean valueSet3 = true;

    void put(int i){

        while(valueSet1){
            try{
                wait();
               }catch(InterruptedException e){
                    System.out.println("Producer thread interrupted");
                }
            }
            System.out.println("Producer thread wakesup");
            valueSet1=true;
            valueSet2=false;
            this.i=i;        
            System.out.println("Put: "+i);
            notify();
        }

    void makesquare(){

            int a;   
            while(valueSet2){
                try{
                    System.out.println("Convertor thread goin to sleep");
                    wait();
                }catch(InterruptedException e){
                    System.out.println("Convertor thread interrupted");
                }
            }       
            System.out.println("Convertor thread wakesup");
            valueSet2 = true;
            valueSet3=false;
            a = this.i;
            this.i = a*a;
            System.out.println("Made: "+i);        
            notify();
    }

    void get(){

           while(valueSet3){
                try{
                    System.out.println("Consumer thread goin to sleep");                
                    wait();
                }catch(InterruptedException e){
                    System.out.println("Consumer thread interrupted");
                }
            }
           System.out.println("Consumer thread wakesup");
           valueSet3 = true;
           valueSet1 = false;
           System.out.println("Got: "+i);
           notify();       
    }

    }

    class Producer implements Runnable{

        Subject q;    
        Thread t;
        String msg; 
        Producer(Subject q, String msg){
            this.q=q;
            this.msg = msg;
            t = new Thread(this, this.msg);
        }
        @Override
        public void run(){
            int i=2;
            while(true){
                synchronized(q){
                q.put(i++);
                }
            }
        }
    }
    class Consumer implements Runnable{

        Subject q;    
        Thread t;
        String msg;
        Consumer(Subject q,String msg){
            this.q = q;
            this.msg = msg;
            t = new Thread(this, this.msg);
        }
        @Override
        public void run(){
            while(true){
                synchronized(q){
                q.get();
                }
            }
        }
    }

    class Convertor implements Runnable{
        Subject q;   
        Thread t;
        String msg;
        Convertor(Subject q, String msg){
            this.q=q;
            this.msg = msg;
            t = new Thread(this, this.msg);    
        }
        @Override
        public void run(){
            while(true){
                synchronized(q){
                q.makesquare();
                }
            }
        }
    } 
```

程序中有三个线程。一根线生产，而另一根线使生产量成平方。而最后一个线程消耗平方乘积。它们都共享同一个对象。

```
 public class Thread3way {

        public static void main(String[] args) {
           Subject q = new Subject();
           Producer P = new Producer(q, "producer");
           Convertor Cv = new Convertor(q, "convertor");
           Consumer Cs = new Consumer(q, "consumer");
           P.t.start();
           Cv.t.start();
           Cs.t.start();
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:40:47.763

您的`wait`循环不太正确，您需要继续循环直到您的条件为真*，然后*再进行任何修改。我会这样做（使用`State`枚举使事情更清楚）：

```
public class Subject {
    static enum State { EMPTY, WAITING_TO_SQUARE, WAITING_TO_GET };
    State state;
    int value;

    public synchronized void put(int i) {
        while (state != State.EMPTY) {
            try {
                wait();
            }catch(InterruptedException e) {
                System.out.println("Put interrupted");
            }
        }
        value = i;
        state = State.WAITING_TO_SQUARE;
    }
} 
```

正如评论者指出的那样，您不需要同步两次，无论是`synchronized(q)`围绕`Subject`调用*还是*声明您的方法`synchronized`。你不需要两者。

无需`Runnables`显式使用，直接 make `Producer`, `Convertor`, `Consumer` `Thread`s 即可。然后你就不需要这些`t`字段了，你可以像`P.start()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:54:21.963

在我看来，您正在做某种具有 3 个阶段的管道。为什么不享受以下好处`ExecutorService`：

```
class ConvertorTask implements Runnable {

    private int number;
    private static ExecutorService consumer = Executors.newSingleThreadExecutor();

    public ConvertorTask(int number) {
        this.number = number;       
    }

    public void run() {
        consumer.submit(new ConsumerTask(number * number));
    }
}

class ConsumerTask implements Runnable {

    private int number;

    public ConsumerTask(int number) {
        this.number = number;       
    }

    public void run() {
        System.out.println(number);
    }
}

class Producer implements Runnable {

    private ExecutorService convertor = Executors.newSingleThreadExecutor();

    public void run() {
        int i = 0;
        while(true) {           
            convertor.submit(new ConvertorTask(i++));
        }
    }
}

public class Test {

    public static void main(String[] args) throws InterruptedException {        
        Thread t = new Thread(new Producer());
        t.start();
    }
} 
```

# c# - 使用自动增量主键在c#中将一行插入到sql表中

> ID：12410702
> 
> 赞同：1
> 
> 时间：2012-09-13T16:24:19.003
> 
> 标签：c#, sql-server

当 ID 列为主键并设置为自动增量时，如何执行表插入命令？

我尝试了以下方法：

```
 using (SqlConnection conn = new SqlConnection(connstring))
        {
            SqlCommand identChange = conn.CreateCommand();
            identChange.CommandText = "SET IDENTITY_INSERT table1 ON";
            conn.Open();
            string commtext = @"Insert INTO table1 (ID, Username)
                       SELECT @ID, @User";
            SqlCommand comm = new SqlCommand(commtext, conn);
            comm.Parameters.AddWithValue("@ID", -1);
            comm.Parameters.AddWithValue("@User", loggedinuser);
            identChange.ExecuteNonQuery();
            comm.ExecuteNonQuery();
            conn.Close();
        } 
```

但无论将什么值放入 ID（我尝试过 0 和 -1），它都会在 ID 列下创建一个具有该值的新行。结果，当我尝试插入下一行时，它给了我一个错误，因为现在我有两行具有相同的 ID。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T16:26:53.903

如果它是自动增量列，您就不必提及该列。

```
string commtext = @"Insert INTO table1 (Username) SELECT @User";
SqlCommand comm = new SqlCommand(commtext, conn);
comm.Parameters.AddWithValue("@User", loggedinuser); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:37:55.303

你这样说：

```
int addUser( string userName )
{
  if ( string.IsNullOrWhiteSpace(userName) throw new ArgumentException("invalid user name" , "userName") ;
  int user_id ;
  string connectString = GetSomeConnectString() ;

  using ( SqlConnection connection = new SqlConnection( connectString ) )
  using ( SqlCommand    cmd        = connection.CreateCommand() )
  {

    cmd.CommandType = CommandType.Text ;
    cmd.CommandText = @"
insert dbo.user ( user_name ) values ( @user_Name )
select user_id = @@SCOPE_IDENTITY
" ;

    cmd.Parameters.AddWithValue( "@user_name" , userName ) ;

    connection.Open() ;
    user_id = (int) cmd.ExecuteScalar() ;
    connection.Close() ;
  }

  return user_id ;
} 
```

`identity`不能在插入时指定任何具有属性（或自动递增列）的列。您必须指定要提供其值的列。任何未提供的列都必须可以为空、具有默认约束或者是自动递增列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:27:47.163

除非您想显式设置 ID，否则不要将 IDENTITY_INSERT 设置为 ON，否则使用自动递增的值。

```
 using (SqlConnection conn = new SqlConnection(connstring))
    {           
        conn.Open();
        string commtext = @"Insert INTO table1 (Username)
                   SELECT @User";
        SqlCommand comm = new SqlCommand(commtext, conn);
        comm.Parameters.AddWithValue("@User", loggedinuser);
        identChange.ExecuteNonQuery();
        comm.ExecuteNonQuery();
        conn.Close();
    } 
```

# .htaccess - 将域上的所有传入流量重定向到非 www HTTPS

> ID：12410704
> 
> 赞同：2
> 
> 时间：2012-09-13T16:24:23.480
> 
> 标签：.htaccess, mod-rewrite, redirect

我以为我可以使用以下方法完成此操作，但它正在循环...

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^example.com [NC,OR]
RewriteCond %{HTTP_HOST} ^www.example.com [NC]
RewriteCond %{HTTPS_HOST} ^www.example.com [NC]
RewriteRule ^(.*)$ https://example.com/$1 [L,R=301] 
```

我需要做什么来确保域的所有实例都转到[https://example.com](https://example.com)而不循环？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:08:19.893

您的第一行检查主机是否是您要重定向到的主机。你不需要检查`HTTPS_HOST`，因为在https中，主机仍然是相同的（它来自请求头，`Host:`）。

尝试：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www.example.com [NC]
RewriteRule ^(.*)$ https://example.com/$1 [L,R=301]

RewriteCond %{HTTPS} !on
RewriteRule ^(.*)$ https://example.com/$1 [L,R=301] 
```

# c# - 如何以编程方式重置 mongodb 内存缓存

> ID：12410706
> 
> 赞同：0
> 
> 时间：2012-09-13T16:24:25.107
> 
> 标签：c#, mongodb

您能否告诉我如何重置 mongodb 内存缓存，因为它一直在堆积。

当我重新启动 mongod.exe 时，内存缓存被删除。

我可以使用 C# for Windows 以编程方式执行此操作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:44:53.390

MongoDB 不控制它使用内存的方式，因为它使用内存映射文件。它将缓存留给操作系统，因此它无法告诉操作系统如何限制或取消缓存它所拥有的内容。见：[http ://www.mongodb.org/display/DOCS/Caching](http://www.mongodb.org/display/DOCS/Caching)

这是确保 MongoDB 在自己的机器上运行的一个很好的理由。否则，空闲内存将被消耗，其他程序将难以从操作系统获得足够的 RAM。

# android - Android 个别选项卡颜色

> ID：12410713
> 
> 赞同：0
> 
> 时间：2012-09-13T16:24:58.360
> 
> 标签：android, colors, tabs, tabwidget

我创建了四个选项卡，但希望每个选项卡具有不同的块颜色 - 这应该在 xml 或 java 文件中完成吗？我假设使用 java，因为我只有一个用于整个选项卡小部件的 xml 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:27:37.987

尝试自定义各个选项卡尝试使用类似的东西

```
TabWidget tabWidget = getTabWidget();
for(int i = 0; i < tabWidget.getChildCount(); i++) {
RelativeLayout tabLayout = (RelativeLayout) tabWidget.getChildAt(i);
tabLayout.setBackgroundDrawable(someimage);
} 
```

# jquery - 将行的一部分作为新行添加到表中

> ID：12410716
> 
> 赞同：1
> 
> 时间：2012-09-13T16:25:12.327
> 
> 标签：jquery, html

有一个带有链接的表，单击时会添加一个新行：

```
 <table>
                <thead>
                  <tr>
                    <th scope="col">col1</th>
                    <th scope="col">col2</th>
                    <th scope="col">col3</th>
                  </tr>
                </thead>

                <tbody>
                  <tr>
                    <td><input name="col1" id="col1"></td>
                    <td><input name="col2" id="col2"></td>
                    <td>
                      <select name="col3" id="col3">
                        <option value="">Please select</option>
                        <option value="1">select1</option>
                        <option value="2">select1</option>
                        <option value="3">select1</option>
                      </select>
                    </td>
                  </tr>
                </tbody>
            </table>
<a href="#" id="addLink">+</a> 
```

单击链接时，我想在表格末尾添加一个新行，但没有第三列。所以我使用 JQuery 来做到这一点：

```
$(document).ready(function(){
                $('#addLink').click(function(){
                    addTableRow($("table"));
                    return false;
                }); // end click
            function addTableRow(table)
            {
                // get the first row in the table
                var $tr = $(table).find("tbody tr:first").html();

                $($tr).remove('td:last'); // remove the last column 

                $('tbody').append("<tr>");
                $(table).find('tbody tr:last').append($tr);

                        };
            }); // end ready 
```

但是，这部分不会删除第 3 列：

```
$($tr).remove('td:last'); // remove the last column 
```

有什么方法可以只用前 2 列追加新行吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:31:52.160

无需使用`html`方法：

```
$(table).find("tbody tr:first td:last").remove(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:38:13.017

这是你要找的吗？

我也改变了一些其他的东西，你会明白的。

```
$(document).ready(function(){
  $('#addLink').click(function(){
    addTableRow($("table"));
    return false;
  }); // end click
  function addTableRow(table) {
    // get the first row in the table
    var $tr = table.find("tbody tr:first").html();

    $('tbody').append($('<tr/>'));
    table.find('tbody tr:last').append($tr).find('td:last').remove();

  };
}); // end ready​ 
```

[http://jsfiddle.net/QTuzM/](http://jsfiddle.net/QTuzM/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-13T16:28:32.183

```
 $('tbody').append("<tr>");
                $(table).find('tbody tr:last').append($tr);
??? 
```

怎么样

```
$(table).find('tbody').append($tr) 
```

# java - 在泽西岛发布 XML 字符串

> ID：12410721
> 
> 赞同：0
> 
> 时间：2012-09-13T16:25:30.237
> 
> 标签：java, junit, jaxb, jersey

我想发送一个 POST 请求，但我想在帖子中添加 XML 作为字符串，而不是添加 JAXBObject。原因是我正在编写一些单元测试。使用 JAXBObject，我只能通过 XSD（即有效的 ENUM 类型）在我的 jaxb 生成的对象中提供**有效值。**

现在我想通过为该输入类型输入一些随机值来测试我的 WS，以便我可以测试它。

如果我做

```
ClientResponse clientResponse = service.post(ClientResponse.class, jaxbElement); 
```

它按预期工作正常。但是我不想发送 jaxbElement .. 我想发送一个自定义 XML 说

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-14T05:45:00.280

当您从测试用例中调用以下内容时

```
ClientResponse response = builder.
    accept(MediaType.APPLICATION_JSON).
    type(MediaType.APPLICATION_XML).
    entity(entityObj).
    post(ClientResponse.class); 
```

你可以发送任何东西`entity(entityObj)`

您还可以尝试[使用 SoapUI 进行 REST 测试](http://www.soapui.org/REST-Testing/getting-started.html)

# ruby-on-rails - 自定义验证到位时保存记录时出错

> ID：12410723
> 
> 赞同：0
> 
> 时间：2012-09-13T16:25:36.073
> 
> 标签：ruby-on-rails, ruby, activerecord, attr-accessor

我有这个 API 可以保存视频、索引它们并更新它们。为了减少索引发生的时间，我决定添加一些验证以仅索引已更改或新的视频。之前是这样的：

```
class Video < ActiveRecord::Base

  after_save :index_me

  def index_me
    Resque.enqueue(IndexVideo, self.id)
  end

end 
```

我所做的更改如下：

```
class Video < ActiveRecord::Base

  before_save :check_new_record
  after_save :index_me

  def check_new_record
    self.is_new = self.new_record?
  end

  def index_me
    if self.changed? || self.is_new
      Resque.enqueue(IndexVideo, self.id)
    end
  end

end 
```

如果没有更改，一切都很好，除了每个视频都会被索引，即使没有任何更改。但是随着我的更改，当视频尝试保存到数据库时，它会回滚。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T02:39:49.840

**如果我没记错的话，当`before`回调返回时`false`，事务会回滚。** 这可能就是正在发生的事情。

```
def check_new_record
    self.is_new = self.new_record?
end 
```

当`self.new_record?`返回时`false`，它分配`false`给`self.is_new`然后方法返回`self.is_new`，这`false`也是。

试试这个：

```
def check_new_record
    self.is_new = self.new_record?
    true
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:01:25.810

一方面，您可以摆脱在 after_save 中检测记录是否是新的黑客行为。如果记录是新的，.changed? 方法将返回 true。

```
class Video < ActiveRecord::Base
  after_save :index_me

  def index_me
    Resque.enqueue(IndexVideo, self.id) if self.changed?
  end
end 
```

# javascript - Href：当前 DIV 中的目标 ID

> ID：12410727
> 
> 赞同：1
> 
> 时间：2012-09-13T16:25:48.610
> 
> 标签：javascript, html, html-lists

我有一个`<li>`从 CMS/DB 生成的项目列表。每个`<li>`都有一个`<div>`包含指向灯箱的链接（隐藏的`<div>`）。该链接以隐藏的 id `<div>`(#inline-content-print) 为目标，因此 javascript 插件会触发并拉起灯箱。

我遇到的问题是`<li>`页面上的所有 s 都使用相同的隐藏`div`id 生成（我可以将其更改为类）。所以无论`<li>`点击哪个href，它总是为`<li>`页面上的第一个（id的第一个实例）拉出灯箱。我需要一种方法让 href 从 THIS 中说出“打开#inline-content-print” `div`（被点击的链接所在的那个）”。

```
<li>
<div class="store-buttons-bg hide-print-buttons-{tag_Hide-Print-Buttons}">

<a href="#inline-content-print" class="various store-button">PRINT</a>

        <div style="display: none;" id="inline-content-print">
        CONTENT OF LIGHTBOX
        </div>
        <!-- end inline-content-print -->

</div>
</li> 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T17:00:45.203

假设您想使用 jQuery/Javascript 执行此操作，您可以使用如下内容：

```
$(document).ready(function()
{
    $('li a.store-button').click(function(e)
    {
        var lightboxElement = $(e.currentTarget).find('div');
        lightboxElement.show(); // or whatever function you need to display
        return false;
    });
}); 
```

这是一个小脚本：

1.  等待页面加载。
2.  查找您的列表元素（按`li`对象类型和链接上的类）
3.  拦截点击事件。
4.  查找`div`嵌套在单击的链接中的元素。
5.  在目标灯箱元素上显示（或运行其他功能）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:19:44.720

您使用的是什么服务器端语言？它是否在循环中生成这些列表项？该循环是否有索引？如果是这样，这对你有用。

```
[Server language version of a for loop with an index variable named "i"]
<li>
<div class="store-buttons-bg hide-print-buttons-{tag_Hide-Print-Buttons}">

<a href="#inline-content-print_[server language output of "i"]" class="various store-button">PRINT</a>

        <div style="display: none;" id="inline-content-print_[server language output of "i"]">
        CONTENT OF LIGHTBOX
        </div>
        <!-- end inline-content-print -->

</div>
</li>
[server language version of an end to the for loop] 
```

# java - 字符串匹配序列数组

> ID：12410728
> 
> 赞同：-1
> 
> 时间：2012-09-13T16:25:51.333
> 
> 标签：java, string, loops, if-statement, char

```
public class sequence {
    public static void main(String args[]){
        char[] c = {'a','x','c','e'};
        char[] t = {'x','b'};
        int count = 0,j;

        for(int i=0;i<(c.length);i++)
        {
            int p = i;
            int x = 0;
            for( j=0;j<(t.length);j++){
                if(c[p]!=c[j]){
                    break;
                }
                else
                x++;

                System.out.print(x);
                if(x==((t.length))){
                    count++;
                }
                p++;
            }
            System.out.print('a');

        }

        System.out.println("Number of Occurences " + count);
    }

} 
```

我的任务是计算序列即 t[] 在母数组 c[] 中出现的次数。即使我在脑海中尝试了所有运行良好的迭代，我也无法获得所需的结果。我是编程的初学者，所以在这里需要一些帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:59:21.500

您不需要在所有元素上循环`c`（您可以停在最后一个可能匹配的位置）。在内部循环中，一旦找到匹配项，就必须继续下一个`c`元素：

```
public static void main(String[] args) {
        char[] c = {'c','a','x','b'};
        char[] t = {'x','b'};
        int count = 0, j;

        for(int i=0;i<=(c.length-t.length);i++)
        {
            for(j=0;j<(t.length);j++){
                if(t[j]!=c[i+j]){
                    break;
                }
            }
            if(j==t.length)
                count++;    
        }
        System.out.println("Number of Occurences " + count);

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:32:24.510

您应该使用这段代码：

```
if(x==((t.length))){
    count++;
} 
```

从内循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:33:27.623

问题是您的`x == t.length`检查在您的内部`for`循环中，但您的内部`for`循环永远不会让`x`到达`t.length`。此外，您的`x`变量是多余的，并且始终等于，`j`因此可以将其删除。

要解决此问题，请将您的长度检查移到循环外部。

**编辑：**另外，您在内部循环（`break`语句所在的位置）中访问了错误的数组。

```
public static void main(String args[]){
    char[] c = {'a','x','c','e'};
    char[] t = {'x','b'};
    int count = 0, j;

    for (int i = 0; i < (c.length); i++) {
        int p = i;
        for (j = 0; j < (t.length); j++){
            if (c[p] != t[j]) {
                break;
            }
            p++;
        }
        if (j == t.length){
            count++;
        }
    }

    System.out.println("Number of Occurences " + count);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T16:46:12.603

您不需要两个 for 循环：

```
public static void main(String args[]){
    char[] c = {'a','x','b','c','x','b','e'};
    char[] t = {'x','b'};
    int count = 0;

    int tInd = 0;
    for(int i=0;i<(c.length);i++)
    {
        if(tInd < t.length && t[tInd] == c[i]){ // Found a member of t[]
            tInd ++;
        } else {
            tInd = 0; // Didn't find t[]
        }
        if(tInd == t.length){ // Found full t[] sequence
            count++;
            tInd = 0;
        }
    }
    System.out.println("Number of Occurences " + count);
} 
```

# python - Python 正则表达式替换不像我预期的那样工作

> ID：12410743
> 
> 赞同：1
> 
> 时间：2012-09-13T16:27:01.847
> 
> 标签：python, regex

我正在尝试创建一个正则表达式来替换字符串的一部分。这是字符串的示例：

```
string = u'/nl/nl/1681/1/0/a/all/'
pattern = r'(/\w{2}/\w{2}/)(\d+)/(\d+)(/\d+/[ans]/all/)'
pattern_obj = re.compile(pattern) 
```

该模式指定了 4 个组。如果您进行搜索，则结果如下：

```
m = pattern_obj.search(string)
m.group(0) -> u'/nl/nl/1681/1/0/a/all/'
m.group(1) -> u'/nl/nl/'
m.group(2) -> u'1681'
m.group(2) -> u'1'
m.group(4) -> u'/0/a/all/' 
```

到目前为止，一切都很好。现在我指定一个替换字符串，如下所示：

```
replacement = r'\1' + '1000' + '/' + '20' + r'\4' 
```

并发出以下声明：

```
pattern_obj.sub(replacement,string) 
```

这导致：

```
u'H00/20/0/a/all/' 
```

我期待这个：

```
u'/nl/nl/1000/20/0/a/all/' 
```

我一定做错了什么，但我不知道是什么。有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:34:54.860

您的替换字符串在完全组装后`\11000/20\4`会`\110`被解释为八进制转义符，`H`而不是对组号 1 后跟`10`.

您需要编写`\g<1>`而不是`\1`确保它是明确的反向引用。请[参阅`re.sub`](http://docs.python.org/library/re.html#re.sub).

# python - 来自另一个类的 PySide 编辑小部件

> ID：12410747
> 
> 赞同：1
> 
> 时间：2012-09-13T16:27:17.373
> 
> 标签：python, pyside

我正在编写的程序有问题。由于它会很大，我想将布局和信号等分离到单独的类/模块中，以使事情更容易阅读。我希望能够从另一个类编辑布局小部件。这是可能的，还是我试图做一些不可能的事情？我在下面提供了一个示例，以防我的解释不清楚

```
class Layout:
  def __init__(self):
    self.callback = CallBack()

  def Gui(self):
    ''' 
    some layout with a listwidget that affects another listwidget depending on choice for example
    '''
    self.list1 = QtGui.QListWidget()
    self.list1.addItems(['chocolate', 'candy', 'pop'])

    self.list1.itemClicked.connect(self.callback.ButtonCallback)

    self.list2 = QtGui.QListWidget()

class CallBack(Layout):
  def __init__(self)
    super(CallBack, self).__init__()

  def ButtonCallback(self, button_signal):
    '''
    do get options for self.list2 depending on chosen item
    '''

    new_items = ['item1', 'item2', 'item3']
    Layout.list2.addItems(new_items) 
```

我意识到代码的最后一行可能是错误的，但这是我正在努力解决的部分。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T17:30:22.370

您当然可以让其他对象为您回答您的信号，只要它们符合 QObject。在您编写的示例代码中，我将创建 CallBack 对象作为 QObject 的子类，并保留与拥有它的 Layout 的关系，以便它可以访问 Layout 对象的属性。

```
class Layout:
    def __init__(self):
        self.callback = CallBack(self)

    def Gui(self):
    ''' 
    some layout with a listwidget that affects another listwidget depending on choice for example
    '''
    self.list1 = QtGui.QListWidget()
    self.list1.addItems(['chocolate', 'candy', 'pop'])

    self.list1.itemClicked.connect(self.callback.ButtonCallback)

    self.list2 = QtGui.QListWidget()

class CallBack(QtCore.QObject):
    def __init__(self, parent)
        super(CallBack, self).__init__()
        self.parent = parent

    def ButtonCallback(self, button_signal):
    '''
    do get options for self.parent.list2 depending on chosen item
    '''

    new_items = ['item1', 'item2', 'item3']
    self.parent.list2.addItems(new_items) 
```

# javascript - 骨干模型默认值 - todos.js 示例中不必要的代码？

> ID：12410748
> 
> 赞同：4
> 
> 时间：2012-09-13T16:27:23.277
> 
> 标签：javascript, backbone.js

在backbone.js [ToDos 示例](http://documentcloud.github.com/backbone/docs/todos.html)中，`initialize`ToDo 构造函数的方法将`title`属性设置为默认标题。

这不是不必要的吗？我认为默认值的重点是它们会自动分配？还是我错过了什么？

```
var Todo = Backbone.Model.extend({ 

    // Default attributes for the todo item.
    defaults: function() {
      return {
        title: "empty todo...",
        order: Todos.nextOrder(),
        done: false
      };
    },

    // Ensure that each todo created has `title`.
    initialize: function() {
      if (!this.get("title")) {
        this.set({"title": this.defaults().title});
      }
    },

    ///...

);} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T16:38:46.513

仅当没有将相应的属性传递给构造函数时才会应用默认值。在这种情况下，可能是为了确保以空字符串作为标题创建的项目显示其中包含某些内容。比较

```
var Todo1 = Backbone.Model.extend({

    defaults: function() {
      return {
        title: "empty todo...",
        done: false
      };
    },

    initialize: function() {
      if (!this.get("title")) {
        this.set({"title": this.defaults().title});
      }
    }
});
var t1 = new Todo1({
    title: ""
}); 
```

和

```
var Todo2 = Backbone.Model.extend({

    // Default attributes for the todo item.
    defaults: function() {
      return {
        title: "empty todo...",
        done: false
      };
    }
});

var t2 = new Todo2({
    title: ""
}); 
```

`t1.get('title')`将是*空的 todo...*并且`t2.get('title')`将是一个空字符串。不向两个构造函数传递任何参数确实会使用默认值。

还有一个小提琴[http://jsfiddle.net/nikoshr/CeEDg/](http://jsfiddle.net/nikoshr/CeEDg/)

# objective-c - 申请突然终止

> ID：12410755
> 
> 赞同：1
> 
> 时间：2012-09-13T16:28:02.283
> 
> 标签：objective-c, instruments, xcode-instruments

我的应用程序正在终止而没有错误。我调试了代码，一切就绪。我在仪器中发现突然终止是由于“未经授权的文件系统访问”和详细信息窗格具有未经授权的访问：

```
Caller:imageloader::link(imageloader::linkcontext const&, bool, bool ,imageloader::rpathchain const&) and Mode:O_RDWR and Function:Open 
```

也为，

```
Caller:checkAddress Mode:blank  Function:write 
```

如何删除这种未经授权的文件系统访问。

# javascript - Jquery 对 div 的关注

> ID：12410756
> 
> 赞同：1
> 
> 时间：2012-09-13T16:28:03.183
> 
> 标签：javascript, jquery

我有两个 div，一个叫做“mainDesign”，一个叫做“div1”。

单击“div1”时，将调用 focusin 并且边框颜色会发生变化。

如果单击“mainDesign”，“div1”只能聚焦。

该脚本有效，但需要单击两次“mainDesign”才能使其工作，在它集中注意力后，该脚本可以完美运行。

有任何想法吗？代码：http: [//jsfiddle.net/v3DWf/14/](http://jsfiddle.net/v3DWf/14/)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:34:48.310

使用 mousedown 和 stopPropagation() 重写：http: [//jsfiddle.net/patrickmarabeas/v3DWf/20/](http://jsfiddle.net/patrickmarabeas/v3DWf/20/)

哈哈，看来Royce Feng 打败了我。

* * *

~~我删除了 focusout()，因为这似乎是一个不必要的步骤......~~

这是可以接受的吗？： http: [//jsfiddle.net/patrickmarabeas/v3DWf/15/](http://jsfiddle.net/patrickmarabeas/v3DWf/15/)

~~编辑：切换功能，现在似乎按预期工作：http: [//jsfiddle.net/patrickmarabeas/v3DWf/17/](http://jsfiddle.net/patrickmarabeas/v3DWf/17/)~~

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:47:52.900

您可以切换到使用`.mousedown()`和停止内部传播。

[http://jsfiddle.net/v3DWf/18/](http://jsfiddle.net/v3DWf/18/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:45:14.390

尝试这个：

```
$("#div1").focusin(function() {
    $(this).css("border-color","#ff9900");
});

$("#mainDesign").mousedown(function(){
    setTimeout(function(){
        if (!$("#div1").is(":focus"))
            $("#div1").css("border-color","#999999");        
    }, 100);
}); 
```

超时是必要的，因为 mousedown 将在 div 模糊之前触发。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-13T16:45:25.223

那么问题是你已经在 .focusout() 事件中嵌套了 .mousedown() 事件。

所以这里发生的是，当触发 focusout 事件时，您会将 .mousedown 事件附加到 mainDesign div。让我再重复一遍，在 focusout 事件触发之前，不会附加 .mousedown 事件。

然后，一旦附加了 .mousedown 事件，下次您在 mainDesign div 中按下 mousedown 时，该事件将触发，这就是为什么它当前需要您单击两次。

所以最简单的解决方案是简单地摆脱 .focusout 事件。

# php - WHERE 子句语法

> ID：12410757
> 
> 赞同：1
> 
> 时间：2012-09-13T16:28:03.430
> 
> 标签：php, mysql, where-clause

我的 sysntax 是怎么回事，我做错了。有没有更好的办法？

```
<?
            $uid = $_GET["uid"];
            $month= $_GET["month"];
            $year = $_GET["year"];
            $query = "SELECT taskname,uid,month,year, SUM(tasktime) FROM tictoc WHERE uid = $uid, month = $month, year = $year GROUP BY taskname"; 

            $result = mysql_query($query) or die(mysql_error());

            // Print out result
            while($row = mysql_fetch_array($result)){
                echo "<br />";
                echo "Total ". $row['taskname']. " = <strong>". $row['SUM(tasktime)']."</strong>";
                echo "<br />";
            }
            ?> 
```

错误是：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' month = 'Aug', year = '2012' GROUP BY taskname' at line 1 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-13T16:28:34.507

您需要使用`AND`，而不是逗号，如下所示：

```
select taskname, uid, month, year, SUM(tasktime)
from tictoc
where uid = $uid
    and month = $month
    and year = $year
group by taskname 
```

另外，请注意以下行：

```
echo "Total ". $row['taskname']. " = <strong>". $row['SUM(tasktime)']."</strong>"; 
```

不管用。您需要为查询中的总和加上别名并引用该别名，如下所示：

```
SELECT taskname,uid,month,year, SUM(tasktime) as SumTaskTime 
```

然后做：

```
echo "Total ". $row['taskname']. " = <strong>". $row['SumTaskTime)']."</strong>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:41:36.810

为了补充前面的答案，请检查参数是否为空。例如：

```
 $uid = $_GET["uid"] = $_GET["uid"] == "" ? 0 : $_GET["uid"];
 $month = $_GET["month"] = $_GET["month"] == "" ? 0 : $_GET["month"];
 $year = $_GET["year"] = $_GET["year"] == "" ? 0 : $_GET["year"]; 
```

或者选择你的检查策略。

原因是如果它们到达时是空的并且您没有验证它，您将错误地构建您的 SQL 语句并且您将遇到您报告的错误。

# android - 安卓布局？

> ID：12410761
> 
> 赞同：0
> 
> 时间：2012-09-13T16:28:10.950
> 
> 标签：android, layout, tablelayout

> **可能重复：**
> [android - 布局 - 调整 ImageButtons 的大小？](https://stackoverflow.com/questions/12391532/android-layout-resize-imagebuttons)

例如：如何制作 10 x 10 表格布局（100% 水平和 100% 垂直）。例如，在第 2 行和第 2 列中是一个按钮。该按钮应填充该区域。

我搜索了很长时间，太多人对布局有问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:33:04.383

`layout_width=fill_parent`您应该使用、`layout_height=fill_parent`和来创建一个 LinearLayout `orientation=vertical`。

在其中，创建 10 个具有`layout_width=fill_parent`、`layout_height=0dp`、`layout_weight=1`和的线性布局`orientation=horizontal`。

`layout_width=0dp`在这 10 个 LinearLayout 中的每一个中，使用、`layout_height=fill_parent`和.创建您的视图（无论您的视图是什么 - 即按钮或其他）`layout_weight=1`。

# php - 24 小时后过期的 SQL 条目

> ID：12410762
> 
> 赞同：4
> 
> 时间：2012-09-13T16:28:12.593
> 
> 标签：php, mysql, html

我想制作一个表，其中条目在插入 PHP 和 MySQL 后 24 小时过期。

理想情况下，我想在每次用户与我的服务器交互时运行一个“删除过程”，删除旧条目。由于这更频繁，您应该不会删除大量数据，因此它应该只需要几毫秒。

我给每个条目一个日期/时间附加值。

我该怎么做？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-13T16:37:27.517

你可以使用 MySQL 的[事件调度](http://dev.mysql.com/doc/en/events.html)器：

*   到期时自动删除此类记录：

    ```
    CREATE EVENT delete_expired_101
    ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 24 HOUR DO
    DELETE FROM my_table WHERE id = 101; 
    ```

*   定期自动清除所有过期记录：

    ```
    CREATE EVENT delete_all_expired
    ON SCHEDULE EVERY HOUR DO
    DELETE FROM my_table WHERE expiry < NOW(); 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:33:13.603

1.  当用户交互时，您不应该执行删除过程。它会减慢速度，您应该使用 cronjob（每分钟/小时）
2.  您需要索引添加的时间戳值，然后运行`DELETE FROM table WHERE added < FROM_UNIXTIME(UNIX_TIMESTAMP()-24*60*60)`
3.  也许你会想要检查[Partitions](http://dev.mysql.com/doc/refman/5.1/en/partitioning.html)，它将表分成不同的表，但它的行为就像一个表。优点是您不需要删除条目，并且每天都有单独的表格。
4.  我认为您认为大量数据会减慢表格的速度。也许您应该使用`EXPLAIN`（[MySQL 手册](http://dev.mysql.com/doc/refman/5.1/de/explain.html)）并使用索引优化您的 SELECT 查询（[MySQL 手册](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)）
5.  **更新**查看[eggyal 的答案](https://stackoverflow.com/a/12410888/944131)- 这是另一种值得一看的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:31:02.150

您可以考虑使用 Cron Job，[http](http://en.wikipedia.org/wiki/Cron) ://en.wikipedia.org/wiki/Cron使其符合您的要求时每 24 小时运行一次。

这将有助于

[时间过去后删除 MySQL 行](https://stackoverflow.com/questions/9865393/how-to-delete-mysql-row-after-time-passes)

# excel - 如果原始范围被删除，我们可以使用 pastespecial 方法吗

> ID：12410767
> 
> 赞同：0
> 
> 时间：2012-09-13T16:28:34.077
> 
> 标签：excel, vsto, excel-2007, vba

我想在循环通过最后 8 种格式时模拟格式画家的行为。为此，我将最后 8 个捕获的 Range 以循环格式存储在 List<> 对象中。应用时，我取出每个范围调用 COPY 方法以在剪贴板上复制该范围，然后在目标范围上调用 PasteSpecial 方法，如下所示

```
RangeInfo tempRangeInfo = listRangeInfo[Counter]; 
//Copy to clipboard
                        tempRangeInfo.CopiedRange.Copy();
                        selection.PasteSpecial(xl.XlPasteType.xlPasteFormats,  xl.XlPasteSpecialOperation.xlPasteSpecialOperationNone,
                            false, false); 
```

但是，如果我删除原始范围，我会得到：

> Range 类的 PasteSpecial 方法失败”错误。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:06:23.197

当您在 Excel 中复制时（复制的区域有行军蚂蚁边框），数据实际上并不在剪贴板上。粘贴时，Excel 使用剪贴板从源单元格实时传输。它这样做是为了在粘贴操作期间将公式重新编写为新的相对单元格引用。如果删除源单元格，则 Excel 在粘贴操作期间无法从中提取数据。

VBA 不支持直接使用剪贴板。但是，您可以将 MSForms 添加到 VBA 项目，然后声明一个支持剪贴板功能的对象。

有关如何直接从 VBA 访问剪贴板的说明和示例，请参见以下网站：

[http://www.cpearson.com/excel/Clipboard.aspx](http://www.cpearson.com/excel/Clipboard.aspx)

对我来说，我的可用列表中没有 MSForms `references`，正如`cpearson`网站上所建议的那样，但我确实在 C:\ 驱动器中搜索了 FM20.dll 并发现它隐藏在一些不起眼的文件夹中。我将它复制到 C:\ 的根目录，并且能够`reference`通过单击对话框将其添加`browse`为。`add references`

MSForms 可用后，您可以使用此代码将文本复制到剪贴板，该剪贴板在源单元格被删除后仍然存在。

```
Public Sub Test()
  Dim obj As New MSForms.DataObject
  obj.SetText ActiveCell.Value
  obj.PutInClipboard
End Sub 
```

这个复制了持续存在的公式：

```
Public Sub Test()
  Dim obj As New MSForms.DataObject
  obj.SetText ActiveCell.Formula
  obj.PutInClipboard
End Sub 
```

我没有时间弄清楚如何将单元格的格式复制到剪贴板，但如果您想保留复制的值以便可以将它们粘贴到源单元格之后，这似乎是您需要走的方向被删除。

## 编辑#1

Even though the Windows Clipboard can store multiple formats for one item (e.g., RTF and Text versions of a copied selection), it can only store **one** item at a time.

The Office Clipboard doesn't use the Windows Clipboard. It stores copied values itself, and can store many different selections. However, as of Office 2000, it could not be controlled via VBA (see [How to use the Office 2000 Clipboard](http://support.microsoft.com/kb/221190/en-us)), and selections copied from Excel are either 'paste text' or 'paste all'. There is no *paste special* to just paste the formats. I couldn't find anything that says different for later versions of Office.

**Conclusion**: The only way to use VBA to do a *paste special* is to have an active / valid / copied selection. So I agree that the only solution is to declare your own persistent global variables (e.g., a list of objects) and store the formats for each copied selection in the list. Since the clipboard really isn't a viable solution, `SetData` and `SetDataObject` are irrelevant... If it proves impossible to capture the formatting of a cell in a single line of VBA code, you could always enumerate the formats of interest and set flags in your stored objects for later use.

# matlab - 使用混合类型数据读取 CSV

> ID：12410768
> 
> 赞同：1
> 
> 时间：2012-09-13T16:28:39.350
> 
> 标签：matlab, csv, import

我需要`csv`在 MATLAB 中阅读以下文件：

```
2009-04-29 01:01:42.000;16271.1;16271.1
2009-04-29 02:01:42.000;2.5;16273.6
2009-04-29 03:01:42.000;2.599609;16276.2
2009-04-29 04:01:42.000;2.5;16278.7
... 
```

我想要三列：
timestamp;value1;value2

我尝试了此处描述的方法：
[Reading date and time from CSV file in MATLAB](https://stackoverflow.com/questions/1641519/reading-date-and-time-from-csv-file-in-matlab)
修改为：

```
filename = 'prova.csv';  
fid = fopen(filename, 'rt');  
a = textscan(fid, '%s %f %f', ...  
        'Delimiter',';', 'CollectOutput',1);  
fclose(fid); 
```

但它返回一个 1x2 单元格，其第一个元素是`a{1}='ÿþ2'`，另一个是空的。

我还尝试根据我的情况调整这些问题的答案：
[在 MATLAB 中导入数据和时间 在 matlab 中](https://stackoverflow.com/questions/10200856/importing-data-with-time-in-matlab?rq=1)
[读取具有特定格式的数据文件并将日期转换为 matal 序列时间](https://stackoverflow.com/questions/6534866/read-data-files-with-specific-format-in-matlab-and-convert-date-to-matal-serial)
，但我没有成功。

如何导入该`csv`文件？

**编辑**在@macduff 的回答之后，我尝试将上面报告的数据复制粘贴到一个新文件中并使用：

```
a = textscan(fid, '%s %f %f','Delimiter',';'); 
```

它有效。不幸的是，这并没有解决问题，因为我必须处理`csv`自动生成的文件，这似乎是 MATLAB 奇怪行为的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:44:36.517

试试呢：

```
a = textscan(fid, '%s %f %f','Delimiter',';'); 
```

对我来说，我得到：

```
a = 

{4x1 cell}    [4x1 double]    [4x1 double] 
```

因此，每个元素`a`对应于 csv 文件中的一列。这是你需要的吗？

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:36:23.333

看来你正在以正确的方式去做。您提供的示例在这里没有问题，我得到了您想要的输出。1x2 单元格中有什么？

如果我是你，我会用文件的较小子集再试一次，比如 10 行，看看输出是否改变。如果是，则尝试 100 行等，直到找到 4x1 单元 + 4x2 阵列分解为 1x2 单元的位置。可能是有一个空行或一个空字段或其他什么，这会强制`textscan`在额外的单元格级别中收集数据。

请注意，这`'CollectOutput',1`会将最后两列收集到一个数组中，因此您最终将得到 1 个包含字符串的 4x1 元胞数组，以及 1 个包含双精度的 4x2 数组。这真的是你想要的吗？否则，请参阅@macduff 的帖子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-08T04:51:11.880

我不得不解析像这样的大文件，我发现我不喜欢 textscan 来完成这项工作。我只是使用一个基本的 while 循环来解析文件，并使用 datevec 将时间戳组件提取到一个 6 元素时间向量中。

```
%% Optional: initialize for speed if you have large files
n = 1000  %% <# of rows in file - if known>
timestamp = zeros(n,6);
value1 = zeros(n,1);
value2 = zeros(n,1);

fid = fopen(fname, 'rt');
if fid < 0
    error('Error opening file %s\n', fname); % exit point
end

cntr = 0
while true
    tline = fgetl(fid);  %% get one line
    if ~ischar(tline), break; end; % break out of loop at end of file
    cntr = cntr + 1;

    splitLine = strsplit(tline, ';');  %% split the line on ; delimiters
    timestamp(cntr,:) = datevec(splitLine{1}, 'yyyy-mm-dd HH:MM:SS.FFF'); %% using datevec to parse time gives you a standard timestamp vector
    value1(cntr) = splitLine{2};
    value2(cntr) = splitLine{3};
 end

%% Concatenate at the end if you like
result = [timestamp  value1  value2]; 
```

# vb.net - 从子过程 vb.net 返回 0 值

> ID：12410773
> 
> 赞同：0
> 
> 时间：2012-09-13T16:28:54.273
> 
> 标签：vb.net

嗨，我被分配了一项家庭作业来创建以下程序： 手机公司 Cell4U 确定他们的手机费用如下：客户为整分钟的通话支付 R2.05，每多出一秒支付 2c。他们还为每条短信支付 40 美分，但客户每满 30 分钟通话可获得 2 条免费短信。每发送 30 条短信，客户还可免费获得 1 条短信。

为公司工作的所有员工都会获得一部免费手机作为福利，他们的账户每月最多可支付 R800 兰特。该公司要求每月报告所有员工的手机账单以及他们在员工手机津贴上花费的总金额。

该计划必须提供以下内容：

• 呼叫到期金额和短信到期金额必须在子过程中计算。这必然意味着子程序必须将秒转换为分钟和秒，并且这些值以及空闲短信的数量也可用于主程序。• 必须调用第二个子程序来计算员工的总账单并累计公司需要为手机津贴支付的总金额。此子程序还必须使用布尔参数向主程序指示公司是否将支付该员工的全部金额或仅支付 R800。• 所有输出必须显示在主程序中（按钮单击事件）。• 任意数量的员工。一个空的员工编号将表示输入的结束（或者用户可以单击输入框中的取消按钮）。输入最后一个数据后，总金额必须如图 5 所示显示。请记住，如果帐户超过 R800，则公司仅向账单贡献 R800，并且总额中必须反映 R800。

我已经编写了以下代码，但返回的值为零

```
Option Strict On
Option Explicit On

Public Class TheCellPhoneCompany

Private Sub CalcMinAndSec(ByVal intLengthCallInSec As Integer, ByVal intCallSec As Integer, ByVal intCallMin As Integer, ByVal intNumMsgs As Integer, ByVal intNumFreeMsgs As Integer, ByVal decCallCost As Decimal, _
                          ByVal decSmsCost As Decimal, ByVal RatePerMin As Decimal, ByVal RatePerSec As Decimal, ByVal RatePerSms As Decimal)

    intCallMin = (intLengthCallInSec \ 60I)
    intCallSec = ((intLengthCallInSec Mod 60I))
    intNumFreeMsgs = ((intCallMin - (intCallMin Mod 30)) \ 15) + ((intNumMsgs - (intNumMsgs Mod 30I) \ 30I))
    decCallCost = (intCallMin * RatePerMin) + (intCallSec * RatePerSec)
    decSmsCost = (intNumMsgs - intNumFreeMsgs) * RatePerSms

End Sub

Private Sub CalcTotals(ByVal decCallCost As Decimal, ByVal decSmsCost As Decimal, ByVal decTotCost As Decimal, ByVal decAmtPaid As Decimal, ByVal decFinalAmtPaid As Decimal, ByVal PaidByComp As Decimal)

    Dim blnPaidByComp As Boolean = decTotCost > 800I

    decTotCost = decCallCost + decSmsCost
    If blnPaidByComp = True Then
        decAmtPaid = PaidByComp
    Else
        decAmtPaid = decTotCost
    End If

    decFinalAmtPaid += decAmtPaid

End Sub

Private Sub btnEnterData_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEnterData.Click

    Dim strEmpCode, strLengthCallInSec, strNumOfSms As String
    Dim intNumMsgs, intNumFreeMsgs, intCallMin, intCallSec, intEmpCode, intLengthCallInSec As Integer
    Dim decCallCost, decSmsCost, decTotCost, decAmtPaid, decFinalAmtPaid As Decimal
    Dim intEmpNum As Integer = 1

    Const RatePerMin As Decimal = 2.05D
    Const RatePerSec As Decimal = 0.02D
    Const RatePerSms As Decimal = 0.4D
    Const PaidByComp As Decimal = 800D

    Do

        strEmpCode = InputBox("Please enter employee number", "Employee " & intEmpNum)
        Integer.TryParse(strEmpCode, intEmpCode)
        If intEmpCode <> 0 Then

            strLengthCallInSec = InputBox("Enter total calls for the month in seconds", "Employee " & intEmpNum)
            Integer.TryParse(strLengthCallInSec, intLengthCallInSec)

            If intLengthCallInSec > 0 Then
                strNumOfSms = InputBox("Enter total number of SMS's sent for the month", "Employee " & intEmpNum)
                Integer.TryParse(strNumOfSms, intNumMsgs)

                If intNumMsgs > 0 Then

                Else
                    MessageBox.Show("Invalid value - the number of SMS's must be a positive integer", "Error - please correct", MessageBoxButtons.OK, MessageBoxIcon.Exclamation, MessageBoxDefaultButton.Button1)
                End If

            Else
                MessageBox.Show("Invalid value - the seconds must be a positive integer", "Error - please correct", MessageBoxButtons.OK, MessageBoxIcon.Exclamation, MessageBoxDefaultButton.Button1)
            End If

        Else
        End If

        Call CalcMinAndSec(intLengthCallInSec, intCallSec, intCallMin, intNumMsgs, intNumFreeMsgs, decCallCost, decSmsCost, RatePerMin, RatePerSec, RatePerSms)

        Call CalcTotals(decCallCost, decSmsCost, decTotCost, decAmtPaid, decFinalAmtPaid, PaidByComp)

        lstCellPhones.Items.Add("Employee: " & intEmpCode)
        lstCellPhones.Items.Add("Calls: " & intCallMin & " minutes and " & intCallSec & " seconds")
        lstCellPhones.Items.Add("Number of SMS messages: " & intNumMsgs & " (" & intNumFreeMsgs & ")")
        lstCellPhones.Items.Add("Cost for calls: R" & decCallCost.ToString("N2"))
        lstCellPhones.Items.Add("Cost for sms messages: R" & decSmsCost.ToString("N2"))
        lstCellPhones.Items.Add("Total cost: R" & decTotCost.ToString("N2"))
        lstCellPhones.Items.Add("Paid by company: R" & decAmtPaid.ToString("N2"))
        lstCellPhones.Items.Add("")

        intEmpNum = intEmpNum + 1

    Loop Until intEmpCode = 0

    lstCellPhones.Items.Add("Total amount paid by company for cell phones = R" & decFinalAmtPaid.ToString("N2"))

End Sub

Private Sub btnClear_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnClear.Click

    lstCellPhones.Items.Clear()

End Sub

Private Sub btnExit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnExit.Click

    Me.Close()

End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T18:03:28.760

1) 通常不将值传递给 sub 以更改这些值。相反，如果您更改变量的范围，`decCallCost`以便它们对您的所有代码“可见”，那么您将通过某种方式使其工作。

2）上线

```
decSmsCost = (intNumMsgs - intNumFreeMsgs) * RatePerSms 
```

如果 intNumFreeMsgs > intNumMsgs 会发生什么？

3）虽然您通常不会这样做，并且由于这是家庭作业，这将是一个坏主意，但您*可以*更改作为参数传递给子的变量：

```
Module Module1

    Sub x(ByRef n As Integer)
        n = 5
    End Sub

    Sub Main()
        Dim a As Integer = 1
        x(a)
        Console.WriteLine(a) ' outputs 5
        Console.ReadLine()
    End Sub

End Module 
```

以防万一您在某处看到它并想知道发生了什么。

# c# - 具有固定大小 FIFO 队列的生产者/消费者模式

> ID：12410777
> 
> 赞同：6
> 
> 时间：2012-09-13T16:29:18.053
> 
> 标签：c#, .net, queue, producer-consumer, concurrent-collections

我需要围绕固定大小的 FIFO 队列实现生产者/消费者模式。我*认为*围绕 ConcurrentQueue 的包装类可能适用于此，但我不完全确定（而且我以前从未使用过 ConcurrentQueue）。这里的转折是队列只需要保存固定数量的项目（在我的例子中是字符串）。我的应用程序将有一个生产者任务/线程和一个消费者任务/线程。当我的消费者任务运行时，它需要及时将队列中存在的所有项目出列并处理它们。

对于它的价值，我的消费者处理排队的项目只不过是通过 SOAP 将它们上传到不是 100% 可靠的网络应用程序。如果无法建立连接或调用 SOAP 调用失败，我应该丢弃这些项目并返回队列以获取更多信息。由于 SOAP 的开销，我试图最大化队列中可以在一个 SOAP 调用中发送的项目数。

有时，我的生产者添加项目的速度可能比我的消费者删除和处理它们的速度要快。如果队列已经满了并且我的生产者需要添加另一个项目，我需要将新项目排入队列，然后将最旧的项目出队，以便队列的大小保持固定。基本上，我需要始终保留队列中生成的最新项目（即使这意味着某些项目没有被消耗，因为我的消费者当前正在处理以前的项目）。

关于生产者保持队列中的项目数量固定，我从这个问题中发现了一个潜在的想法：

[固定大小的队列，在新入队时自动将旧值出列](https://stackoverflow.com/questions/5852863/fixed-size-queue-which-automatically-dequeues-old-values-upon-new-enques)

我目前正在使用 Enqueue() 方法围绕 ConcurrentQueue 使用包装类（基于该答案），如下所示：

```
public class FixedSizeQueue<T>
{
    readonly ConcurrentQueue<T> queue = new ConcurrentQueue<T>();

    public int Size { get; private set; }

    public FixedSizeQueue(int size)
    {
        Size = size;
    }

    public void Enqueue(T obj)
    {
        // add item to the queue
        queue.Enqueue(obj);

        lock (this) // lock queue so that queue.Count is reliable
        {
            while (queue.Count > Size) // if queue count > max queue size, then dequeue an item
            {
                T objOut;
                queue.TryDequeue(out objOut);
            }
        }
    }
} 
```

我在队列上创建了一个具有大小限制的类的实例，如下所示：

```
FixedSizeQueue<string> incomingMessageQueue = new FixedSizeQueue<string>(10); // 10 item limit 
```

我启动了我的生产者任务，它开始填充队列。当添加项目导致队列计数超过最大大小时，我的 Enqueue() 方法中的代码似乎可以正常工作，以从队列中删除最旧的项目。现在我需要我的消费者任务来使项目出列并处理它们，但这是我的大脑感到困惑的地方。为我的消费者实现 Dequeue 方法的最佳方法是什么，该方法将在某个时刻拍摄队列的快照并将所有项目出列以进行处理（在此过程中，生产者可能仍在将项目添加到队列中）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T16:55:35.800

简单地说，ConcurrentQueue 有一个“ToArray”方法，当输入该方法时，它将锁定集合并生成队列中所有当前项目的“快照”。如果您希望为您的消费者提供一个工作块，您可以锁定入队方法具有的同一个对象，调用 ToArray()，然后`while(!queue.IsEmpty) queue.TryDequeue(out trash)`在返回您提取的数组之前通过循环清除队列。

这将是你的`GetAll()`方法：

```
public T[] GetAll()
{
    lock (syncObj) // so that we don't clear items we didn't get with ToArray()
    {
        var result = queue.ToArray();
        T trash;
        while(!queue.IsEmpty) queue.TryDequeue(out trash);
    }
} 
```

由于您必须清除队列，因此您可以简单地将这两个操作结合起来；创建一个适当大小的数组（使用 queue.Count），然后当队列不为空时，将一个项目出队并将其放入数组中，然后返回。

现在，这就是具体问题的答案。我现在必须凭良心戴上我的 CodeReview.SE 帽子并指出一些事情：

*   **永远不要**使用`lock(this)`. 您永远不知道其他对象可能会将您的对象用作锁定焦点，因此当对象从内部锁定自身时会被阻止。最好的做法是锁定一个私有范围的对象实例，通常是为了被锁定而创建的：`private readonly object syncObj = new object();`

*   由于无论如何您都在锁定包装器的关键部分，因此我将使用普通`List<T>`集合而不是并发集合。访问速度更快，更容易清理，因此您将能够比 ConcurrentQueue 更简单地完成您正在做的事情。要入队，请在索引零之前锁定同步对象 Insert()，然后使用 RemoveRange() 将索引 Size 中的任何项目删除到列表的当前 Count。要出列，锁定同一个同步对象，调用 myList.ToArray()（来自 Linq 命名空间；与 ConcurrentQueue 的作用几乎相同），然后在返回数组之前调用 myList.Clear()。再简单不过了：

    ```
    public class FixedSizeQueue<T>
    {
    private readonly List<T> queue = new List<T>();
    private readonly object syncObj = new object();

    public int Size { get; private set; }

    public FixedSizeQueue(int size) { Size = size; }

    public void Enqueue(T obj)
    {
        lock (syncObj)
        {
            queue.Insert(0,obj)
            if(queue.Count > Size) 
               queue.RemoveRange(Size, Count-Size);
        }
    }

    public T[] Dequeue()
    {
        lock (syncObj)
        {
            var result = queue.ToArray();
            queue.Clear();
            return result;
        }
    }
    } 
    ```

*   您似乎明白您正在使用此模型丢弃排队的项目。这通常不是一件好事，但我愿意给你怀疑的好处。但是，我会说有一种无损方法可以使用 BlockingCollection 来实现这一点。BlockingCollection 包装了任何 IProducerConsumerCollection，包括大多数 System.Collections.Concurrent 类，并允许您指定队列的最大容量。然后，该集合将阻止任何试图从空队列中出列的线程，或任何试图添加到完整队列的线程，直到添加或删除项目，以便有一些东西可以获取或插入空间。这是实现具有最大大小的生产者-消费者队列的最佳方式，或者需要“轮询”以查看是否存在 是供消费者使用的东西。如果你走这条路，只有消费者必须扔掉的东西才会被扔掉；消费者将看到生产者放入的所有行，并对每一行做出自己的决定。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-13T16:43:02.147

您不想使用`lock`with `this`。请参阅[为什么 lock(this) {...} 不好？](https://stackoverflow.com/questions/251391/why-is-lockthis-bad)更多细节。

这段代码

```
// if queue count > max queue size, then dequeue an item
while (queue.Count > Size) 
{
    T objOut;
    queue.TryDequeue(out objOut);
} 
```

建议您需要以某种方式*等待*或*通知*消费者该商品的可用性。在这种情况下，请考虑[`BlockingCollection<T>`](http://msdn.microsoft.com/en-us/library/dd267312.aspx)改用。

# java - SQLite 内存不足异常

> ID：12410778
> 
> 赞同：1
> 
> 时间：2012-09-13T16:29:18.877
> 
> 标签：java, sqlite, jdbc, synchronized

我收到“java.sql.SQLException：[SQLITE_MISUSE] 库使用不正确（内存不足）”。我为我的数据库连接对象粘贴代码示例

```
public class DBhandler {
   private String DBUrl="d:\\sqlitedb\\somdb.db";
   private String driverName="org.sqlite.JDBC";
   private String jdbc="jdbc:sqlite:";
   private Connection con=null;
   private Statement stmnt=null;

  public DBhandler() 
  {
        try {
            Class.forName(this.driverName);
        } catch (ClassNotFoundException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }

            try {
                this.con=DriverManager.getConnection(this.jdbc+this.DBUrl);
                this.stmnt=con.createStatement();
            } catch (SQLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

  }

   public CurrentActiveSom getCurrentActiveSom()
 {

     CurrentActiveSom cas=null;
     String query="select * from current_active_som where active=1"; 
    ResultSet rs=null;

     try {
        rs=this.stmnt.executeQuery(query);
    if (rs.next())
    {
        cas= new CurrentActiveSom();
        cas.setMonth(rs.getString("month"));
        cas.setYear(rs.getString("year"));
        cas.setIsActive(rs.getInt("active"));

    }

    } catch (SQLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

     finally
     {
         try {
            rs.close();
            this.stmnt.close();
             this.con.close();
        } catch (SQLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

     }
     return cas;
 }

 public CurrentActiveSom getIsDoneSom(String month,String year)
 {

     CurrentActiveSom cas=null;
     String query="select * from current_active_som where month='"+month+"' and year='"+year+"' and active=0"; 

    ResultSet rs=null;

     try {

             rs=this.stmnt.executeQuery(query); //this is exception line
        }

        if (rs.next())
        {
            cas= new CurrentActiveSom();
            cas.setMonth(rs.getString("month"));
            cas.setYear(rs.getString("year"));
            cas.setIsActive(rs.getInt("active"));

        }

     } catch (SQLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
     }

     finally
     {
         try {
            //rs.close(); //if i uncomment this gets null pointer exception 
            this.stmnt.close();
             this.con.close();
        } catch (SQLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

     }
     return cas;
 } 
```

使用相同的 DBhandler 对象调用这两个方法，例如

```
 DBhandler db=new DBhandler();
 CurrentActiveSom cas1=db.getCurrentActiveSom();
 CurrentActiveSom cas2=db.getIsDoneSom(String month,String year) 
```

然后我得到上述异常，

但是如果我们用不同的对象 DBhandler 调用这 2 个方法，比如

```
 DBhandler db1=new DBhandler();
   DBhandler db2=new DBhandler();
   CurrentActiveSom cas1=db1.getCurrentActiveSom();
   CurrentActiveSom cas2=db2.getIsDoneSom(String month,String year) 
```

然后代码工作正常。

这是因为同步问题，有连接吗？如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:45:03.783

好吧，“内存不足”错误看起来很奇怪，但一个明确的错误在于`Connection`每次程序运行（在构造函数中）创建一次，然后在每个数据访问方法中关闭它。

这段代码：

```
CurrentActiveSom cas1=db.getCurrentActiveSom(); 
```

关闭`Connection`，所以这段代码：

```
CurrentActiveSom cas2=db.getIsDoneSom(String month,String year) 
```

试图从*封闭*的数据库中获取数据。如果您正在使用某种连接池，在这种连接池中关闭连接会将其返回到池中，这是可以的。但似乎您正在处理单个物理连接。

因此，在您完成从数据库获取数据后关闭它，而不是在每个数据访问方法中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-05-01T22:01:57.990

在调用 `rs.next() 之前关闭连接，因此 ResultSet 尝试从已经关闭的连接中读取。

# javascript - JavaScript 中的嵌套函数和“this”关键字

> ID：12410779
> 
> 赞同：4
> 
> 时间：2012-09-13T16:29:26.160
> 
> 标签：javascript, this

“`this`关键字总是指包含函数作为方法的对象。”

太好了，听起来很简单，但这就是我想知道的……

例如：

```
function func1() {

  function func2() {
    alert(this == window); // true
  }

  func2();

  alert(this == window); // true
}

func1.func3 = function () {

  alert(this == window); // false
  alert(this == func1); // true

};

func1();
func1.func3(); 
```

现在，因为`func1`实际上是*全局*( `window`) 对象的方法（分配给*全局*`func1`对象属性的函数对象），所以inside指的是*全局*对象，并且因为是函数对象的方法，所以有意义那里面指的是'函数对象。*`this``func1`*`func3``func1``this``func3``func1`**

 **困扰我的是`func2`。我知道`this`嵌套函数内部也应该引用*全局*对象，但我不确定为什么因为`func2`不是*全局*对象的方法。据我了解（这是我可能完全错误的部分）`func2`是`func1`调用（激活/变量）对象的方法。现在，如果我对此是正确的（而且我不确定我是否正确），那么不应该`this`在内部`func2`引用`func1`'s call object 而不是*全局*对象？

所以，我想我的问题是：嵌套函数是否是嵌套函数的调用（激活）对象的方法，如果是，不应该`this`引用该调用对象而不是*全局*对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T16:39:58.040

> this 关键字总是引用包含函数的方法的对象。

不，不幸的是，这并不容易。MDN 上的[关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)[文档`this`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)提供了很好的概述。当函数作为方法调用时，它被设置为对象*，*但还有其他可能性。默认是在没有任何特殊的情况下`this`调用`undefined`它，就像你用`func1`and做的那样`func2`。对于草率（非严格）模式函数`undefined`（和`null`）虽然没有使用，但在这种情况下`this`确实指向它们的全局对象（`window`在浏览器中） - 你正在观察什么。

但它也可以在函数作为构造函数（使用关键字）调用时指向新的对象实例`new`，或者在用作处理程序时指向事件目标（如 DOM 元素）。最后但并非最不重要的一点是，它可以手动设置`call`，`apply`或者`bind`…</p>

`this`与嵌套无关。嵌套函数声明/表达式仅影响变量的范围（“隐私”，可用性）。虽然函数的变量范围永远不会改变，但`this`每次调用的值可能不同——它更像是一个额外的参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T16:52:59.167

函数中关键字的含义`this`取决于调用函数的方式。JavaScript 中有 4 种不同的函数调用模式。

1.  函数调用模式`foo()`
2.  方法调用模式`o.foo()`
3.  构造函数调用模式`new foo`
4.  调用/应用模式`foo.apply(...)`或`foo.call(...)`

只有在#2 中，`this`函数内部指的是函数是方法的对象。

您正在`func2()`使用函数调用模式进行调用。这样做时，`this`指的是全局对象。

正如@Bergi 所建议的，请参阅[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)`this`以获取有关不同函数调用模式的含义和更多详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T16:32:47.650

> 但我不确定为什么因为 func2 不是全局对象的方法。

在函数内部定义的任何东西都是该函数范围内的。so`func2`属于 的局部范围，`func1`因此不附属于`window`。

在 Javascript 中， 的值`this`通常取决于您如何调用函数。当你调用一个没有任何前导对象的函数时，`this`通常设置为全局父对象，即`window`.

`this`您可以通过三种方式显式设置 的值：

```
myObj.func(a, b); //this set to myObj implicitly because myObj is the parent 

func.call(myObj, a, b); //this set to myObj explicitly; the first argument 
                        //to call sets the value of this for that function

func.apply(myObj, [a, b]); //this set to myObj explicitly; the first argument
                           //to apply also sets the value of this for that
                           //function. 
```

`this`可能是一个棘手的概念。MDN 有[一篇](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)关于`this`.**

# php - 尝试使用正则表达式删除新行和空格

> ID：12410783
> 
> 赞同：-2
> 
> 时间：2012-09-13T16:29:54.590
> 
> 标签：php, regex

我正在尝试从我拥有的多行字符串中删除一些换行符和空格，例如：

```
 Toronto (YTZ)
    to
    Montreal (YUL) 
```

我试着做：

```
$matched = preg_replace('/[\n]/', '', $string);
var_dump($matched); 
```

但它返回的只是：

```
 Montreal (YUL) 
```

我尝试了各种正则表达式组合，但它似乎只能找到我指定的内容，替换它，并在匹配的表达式之后显示任何内容。

我确定这很简单，但我似乎无法弄清楚。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:32:09.513

\n 仅表示“转到行”，如果它在 PHP “\n”中的双引号之间...您的正则表达式不应该`"/[\n]/"`是`'/[\n]/'`

无论如何，不​​要为此使用正则表达式，而是使用正则表达式`str_replace("\n",'',$string)`。它更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:46:29.487

正如 Kash 已经注意到的那样，不同操作系统中新行的表达可能不同。那就是使用 PHP_EOL 常量的地方。这个常数是根据操作系统定义的。

```
$string = str_replace(PHP_EOL, '', $string); 
```

如果可以在不同的机器上创建字符串，那么最好分别替换“\r”和“\n”

```
$string = str_replace(array("\r", "\n"), '', $string); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:57:53.007

```
$str = preg_replace('/\n+(?=.)/', " ",
       preg_replace('/^\s*/m', "",
       $str)); 
```

[在此处](http://ideone.com/BbVJE)检查此代码。

# http - Content-Type HTTP 标头中“字符集”的范围

> ID：12410788
> 
> 赞同：1
> 
> 时间：2012-09-13T16:30:07.553
> 
> 标签：http

Pyramid Web 框架生成的 HTTP 响应附加`; charset=UTF-8`到`Content-Type`HTTP 标头。例如，

```
Content-Type: application/json; charset=UTF-8 
```

[RFC 2616 的第 14.17 节](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17)给出了一个例子：

```
Content-Type: text/html; charset=ISO-8859-4 
```

但是，没有描述这个`charset`“属性”的作用。这有什么范围，谁来解释它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:33:53.223

它定义了被传输实体的字符编码，并且可以被远程用户解释。Pyramid 告诉所有人，它只与使用 UTF-8 的人交谈，而不是默认使用 ISO-8859-1。

# postgresql - 困难的（对我来说）postgres sql 查询

> ID：12410791
> 
> 赞同：0
> 
> 时间：2012-09-13T16:30:19.657
> 
> 标签：postgresql, join

这是我的表：

AB 元组表 C 表具有 A.id、B.id、C.units 条目 D 表具有 C.id 条目 我想计算 D 表中具有相同 A 的 C.id 的所有条目.id 和 B.id 并从具有相同 A.id 和 B.id 的所有 C.units 的总和中减去该计数作为新列“差异”

所以我希望查询在一行中返回“差异”、常见的 A.id 和常见的 B.id

如果计数为 0，它也应该返回一个条目，并且“差异”将等于 sum(C.units)

例如

```
D table

D.id = 1, open=true, D.CID = 2
D.id = 2, open=true, D.CID = 3
D.id = 3, open=true, D.CID = 3
D.id = 4, open=true, D.CID = 4

C table

C.id = 2, A.id = 3, B.id = 5, units =4 
C.id = 3, A.id = 3, B.id = 5, units = 6
C.id = 4, A.id = 4, B.id = 6, units = 8
C.id = 5, A.id = 4, B.id = 6, units = 10 
```

Bc D 中的前 3 个条目具有具有相同 AID 和 BID 的 CID，它们被计入同一个条目中。此外，具有相同 A.id 和 B.id 的 C 条目将其单位相加。即使 C 条目没有关联的 D 条目。因此，查询应返回以下 2 个条目：

```
1\. difference = (6+4)-3 = 7    A.id = 3  B.id = 5
2\. difference = (10+8)-1 = 17  A.id = 4  B.id = 6 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:07:18.983

设置（你真的应该包括在你的问题中）：

```
CREATE TABLE c
  (
    id int NOT NULL PRIMARY KEY,
    aid int NOT NULL,
    bid int NOT NULL,
    units int NOT NULL
  );
CREATE TABLE d
  (
    id int NOT NULL PRIMARY KEY,
    open boolean NOT NULL,
    cid int NOT NULL
  );
INSERT INTO c VALUES (2,3,5,4),(3,3,5,6),(4,4,6,8),(5,4,6,10),(6,7,8,9);
INSERT INTO d VALUES (1,true,2),(2,true,3),(3,true,3),(4,true,4); 
```

这个问题有点难以理解，但我想你可能正在寻找这样的东西：

```
WITH n AS (
  SELECT aid, bid, count(*) AS cnt
    from c
    JOIN d ON (d.cid = c.id)
    GROUP BY aid, bid
)
SELECT aid, bid, sum(c.units) - COALESCE(n.cnt, 0) AS difference
  FROM c
  LEFT JOIN n USING (aid, bid)
  GROUP BY aid, bid, n.cnt
  ORDER BY aid, bid; 
```

我得到这些结果：

```
援助| 出价 | 不同之处
-----+-----+------------
   3 | 5 | 7
   4 | 6 | 17
   7 | 8 | 9
(3 行)

```

# php - 如何将 CSS 文件中的 LTR（从左到右）属性和值转换为 RTL 对应项，反之亦然

> ID：12410792
> 
> 赞同：0
> 
> 时间：2012-09-13T16:30:19.910
> 
> 标签：php, css, right-to-left

我有许多为从左到右的网站制作的 CSS 文件

我想创建一个 php 函数，可以将 LTR 属性和值转换为它们的 RTL 对应项

我之所以要这样做是因为该网站始终处于开发阶段，并且它有数十个页面和 css 文件，并且很难跟踪所有这些文件

这个功能的目的是自动转换CSS文件，这样可以更容易地制作网站的RTL版本

例如：

```
// This is the content of the css file:
$content = '
html, body {
  direction: ltr;
}
#element1 {
  padding:   1px 2px  3px 4px;
  margin-right: 3em;
  background-position: 5%   80%;
  background-image: url(image.png);
  cursor: ne-resize;
  text-align: left; /* 1 */
}
#element2 {
  background: url(image.gif) 5% 80%;
  text-align: right; /* 2 */
  border-left: 1px solid #000;
}
';

$content = convertCSStoRTL($content);

// The output - This is what i want it to become after the function is applied to the content of the css file:
$content = '
html, body {
  direction: rtl;
}
#element1 {
  padding: 1px 4px 3px 2px;
  margin-left: 3em;
  background-position: 95% 80%;
  background-image: url(image.png);
  cursor: nw-resize;
  text-align: right; /* 1 */

}
#element2 {
  background: url(image.gif) 95% 80%;
  text-align: left; /* 2 */
  border-right:  1px solid #000;
}
'; 
```

我怎样才能在 PHP 中做到这一点（以最简单的方式）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-07T18:26:56.277

以下 SCSS 导入添加了一些有用的变量、函数和 mixin。

[在 GitHub 上查看](https://github.com/tysonmatanich/directional-scss)

[阅读更多](http://www.matanich.com/2013/09/06/rtl-css-with-sass/)

```
// Override default value for $dir in directional.scss
$dir: rtl;

// Import helpers from directional.scss
@import "directional";

// Use the helpers to make CSS for LTR or RTL
body {
    text-align: $left;
    padding-#{$right}: 1em;
    margin: dir-values(0 2em 0 1em) if-ltr(!important);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:07:13.460

如果您尝试依靠正则表达式/str_replace 来修改您的 CSS，我认为您将受到伤害。我的建议是让 PHP 生成 2 个不同的文件，而不是获取一个并生成其镜像，尤其是当您考虑诸如边框之类的属性而不仅仅是对齐时。

我还没有实际测试过这个，但它应该让你知道如何处理它

```
<?php
$ltr = true;
function doLTR($left, $right, $property = FALSE) {
    @global $ltr;

    $direction = $ltr ? $left : $right;
    if (!$property) {
        print $direction;
    } else {
        print $direction . ': ' . $property;
    }
}
?>

.test {
    border: 1px solid;
    <?php doLTR('margin-left', 'margin-right', '10px'); ?>
    <?php doLTR('text-align: left', 'text-align: right'); ?>
} 
```

如果`$ltr = true`，理论上你应该得到这个输出：

```
.test {
    border: 1px solid;
    margin-left: 10px;
    text-align: left;
} 
```

如果它是假的（rtl），你会得到这个：

```
.test {
    border: 1px solid;
    margin-right: 10px;
    text-align: right;
} 
```

可能值得考虑使用像 Sass 或 LESS 这样的 CSS 预处理器来为您完成这种繁重的工作，因为这是他们最擅长的。

# git - 服务器上的 Git 接收后挂钩错误

> ID：12410796
> 
> 赞同：3
> 
> 时间：2012-09-13T16:30:35.427
> 
> 标签：git, githooks

我想在我的服务器上有一个 git 'post-receive'。我在挂钩文件上使用以下代码：

```
#!/bin/bash
#CONFIG
LIVE="/home/ubuntu/public_html/testing"

read oldrev newrev refname
if [ $refname = "refs/heads/master" ]; then
  echo "===== DEPLOYING TO LIVE SITE ====="
  unset GIT_DIR  
  cd $LIVE
 # ssh-agent $BASH
 # ssh-add /home/ubuntu/.ssh/ubuntu
  git pull --verbose origin  master || echo "git-pull: returned error code"     
  echo "===== DONE ====="
fi 
```

每当我尝试将某些内容从本地 PC 推送到服务器时，它都会显示以下错误消息：

```
===== DEPLOYING TO LIVE SITE =====
remote: error: cannot open .git/FETCH_HEAD: Permission denied
remote: 
remote: git-pull: returned error code
remote: ===== DONE ===== 
```

任何人都可以请帮助可能是什么问题？

只是为了确认一下，我尝试使用相同的用户凭据通过 ssh 终端运行命令，并且运行良好。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T17:48:14.057

最后，我确实能够通过将目录（/home/ubuntu/public_html/testing）的所有权更改为提交/运行钩子的用户来解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T19:45:19.297

每当我收到有关权限和 FETCH_HEAD 的错误消息时，这是因为我在修补某些东西时不小心以 root 身份进行了拉取，这会在 root 拥有的 .git 目录中创建文件，而我的普通 ssh 用户无法覆盖这些文件.

我通常会运行`ls -laR .git | grep root`（我确定有更好的方法，我不是系统管理员）来检查是否有 root 拥有的任何文件。简单地把它们扔回去就可以让我像往常一样继续前进。

# wpf - 根据属性值设置不同的内容

> ID：12410798
> 
> 赞同：0
> 
> 时间：2012-09-13T16:30:45.707
> 
> 标签：wpf, xaml, wpf-controls

我有点迷失了要采取什么策略。我需要执行以下操作：

我有一个切换按钮作为基类。这个按钮具有普通按钮的所有属性，加上 IsChecked，它告诉我们按钮是否被切换。

我想为 ToggleButton 创建一个样式（或模板）。基本上它必须从 ToggleButton 继承原始样式，并添加：

IsChecked=True：将 ToolTip 设置为“折叠”并显示此内容（减号）

```
<Path Margin="2" Stroke="ForeGround property on control" Data="M0,5 H10" StrokeThickness="3" /> 
```

IsChecked=False，设置 ToolTip tp “展开”并显示此内容（加号）

```
<Path Margin="2" Stroke="ForeGround property on control" Data="M0,5 H10 M5,0 V10" StrokeThickness="3" /> 
```

我尝试了几种方法，但总是遇到一些我无法解决的异常。

另一种方法可以是只有一个内容（加号），但分为两行：

```
<Grid>
    <Path Margin="2" Stroke="ForeGround property on control" Data="M0,5 H10" StrokeThickness="3" />
    <Path x:Name="verticalLine" Margin="2" Stroke="ForeGround property on control" Data="M5,0 V10" StrokeThickness="3" />
</Grid> 
```

他们根据展开/折叠状态悬挂垂直线的可见性。

我取得了一些进展：

```
<Style x:Key="myToggleButtonStyle" TargetType="ToggleButton" BasedOn="{StaticResource ToggleButtonStyle}">
    <Setter Property="ContentTemplate">
        <Setter.Value>
            <Grid>
                <Path Margin="2" Stroke="Black" Data="M0,5 H10" StrokeThickness="3" />
                <Path x:Name="verticalLine" Margin="2" Stroke="Black" Data="M5,0 V10"  StrokeThickness="3" />
            </Grid>
        </Setter.Value>
    </Setter>

    <Style.Triggers>
        <Trigger Property="IsChecked" Value="True">
            <Trigger.EnterActions>
                <BeginStoryboard>
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.Target="verticalLine" Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <Visibility>Collapsed</Visibility>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </BeginStoryboard>
            </Trigger.EnterActions>
            <Trigger.ExitActions>
                <BeginStoryboard>
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.Target="verticalLine" Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0">
                                <DiscreteObjectKeyFrame.Value>
                                    <Visibility>Visible</Visibility>
                                </DiscreteObjectKeyFrame.Value>
                            </DiscreteObjectKeyFrame>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </BeginStoryboard>
            </Trigger.ExitActions>
        </Trigger>
    </Style.Triggers>
</Style> 
```

我现在唯一不能做的就是将 Stroke 设置为 ToggleButton 的前景色。我已经尝试了所有我记得的东西，从 TemplatedParent 到 AncestorType，但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:05:48.913

尝试`Path.Data`根据`ToggleButtons IsChecked`属性更改：

```
 <ToggleButton.Style>
                        <Style TargetType="ToggleButton">
                            <Setter Property="ToolTip" Value="Collapsed"/>
                            <Setter Property="Content">
                                <Setter.Value>
                                    <Path Margin="2" Stroke="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ToggleButton}}" StrokeThickness="3">
                                        <Path.Style>
                                            <Style TargetType="Path">
                                                <Setter Property="Data" Value="M0,5 H10 M5,0 V10 "/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ToggleButton}, Path=IsChecked}" Value="True">
                                                        <Setter Property="Data" Value="M0,5 H10"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Path.Style>
                                    </Path>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter Property="ToolTip" Value="Expanded"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </ToggleButton.Style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T20:31:44.863

好的，这是最终的解决方案：

```
<Style x:Key="MyToggleButtonStyle" TargetType="ToggleButton" BasedOn="{StaticResource ToggleButtonStyle}}">
    <Setter Property="ContentTemplate">
        <Setter.Value>
            <DataTemplate>
                <Grid>
                    <Path Margin="4" Data="M0,5 H10" Stretch="UniformToFill" Stroke="{TemplateBinding Control.Foreground}" StrokeThickness="3" />
                    <Path x:Name="verticalLine" Margin="4" Data="M5,0 V10" Stretch="UniformToFill" Stroke="{TemplateBinding Control.Foreground}" StrokeThickness="3" />
                </Grid>
                <DataTemplate.Triggers>
                    <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource TemplatedParent}}" Value="True">
                        <DataTrigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="verticalLine" Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Collapsed</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                        <DataTrigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="verticalLine" Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Visible</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.ExitActions>
                    </DataTrigger>
                </DataTemplate.Triggers>
            </DataTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# java - 将新模块添加到正在运行的应用程序 NetBeans 平台

> ID：12410802
> 
> 赞同：0
> 
> 时间：2012-09-13T16:31:07.330
> 
> 标签：java, auto-update, netbeans-platform

我正在设计一个使用 NetBeans 平台应用程序框架编写的应用程序。将按照敏捷方法进行开发。作为敏捷的特点，一旦发布应用程序，我们将添加新模块，同时更新现有模块。我是 NetBeans 平台的新手，正在研究网络，我知道当您部署应用程序时，模块被配置为在“更新中心”中搜索更新，但我的问题是，如果我们添加新模块，那些模块已安装到已安装的应用程序中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T07:16:36.257

如果您想向现有（正在运行的应用程序）添加一些新闻模块，您可以使用静默更新。

# grails - Grails 控制器 - 无法捕获 SocketException

> ID：12410803
> 
> 赞同：2
> 
> 时间：2012-09-13T16:31:18.133
> 
> 标签：grails, exception-handling, grails-2.0

当我尝试在控制器方法中捕获异常时，我无法捕获 SocketException。控制器动作如下所示：

```
def updateDeviceStartV1() {
      try {
         ...
         response.status = 200;
         response.setContentType("application/octet-stream")
         response.outputStream << responseService.encryptedResponse // byte[]
      }
      catch(Exception e) {
         log.error "Server faced unexpected exception", e
         response.status = 500;
         ...
      } 
```

SocketException 由“response.outputStream << responseService.encryptedResponse”行抛出，因为客户端意外关闭了连接。然而，这个异常并没有被捕获，控制台接收到标准的异常显示......

难道我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T17:04:00.533

我认为如果引发异常的方法没有显式抛出异常（在签名中带有 throws ），它将作为**UndeclaredThrowableException**抛出。然后你的 catch 中的类型与它不匹配。尝试捕获 SocketException。或者，如果您可以使用`catch(all)`. 哦，看看[这个](http://jts-blog.com/?p=9491)。

# ms-access - 我还没有找到适合我需要的答案。如何使用单个表单填充多个表？

> ID：12410805
> 
> 赞同：-1
> 
> 时间：2012-09-13T16:31:21.613
> 
> 标签：ms-access, ms-access-2003

我有一个由单个表单填充的主表。此表包含我所有的客户信息，并列出了我们销售的所有产品以及每个产品向每个客户销售的数量。我正在为每个单独的产品创建单独的表格。如果出售给单个客户的数量至少为 1，我想知道如何使这个单一表格在表格中为每个单独的产品填充一行。

例如，假设我要销售 widget_1、widget_2 和 widget_3。在我的主表上，无论如何都会填充客户信息。现在，我有一个用于 widget_1 的表，一个用于 widget_2 的表，以及一个用于 widget_3 的表。如果客户只订购了#1 和#3，我希望将他们的信息输入到widget_1 和widget_3 的表中，而不是widget_2。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T11:49:01.257

如果只有有限数量的小部件可用，是否有任何理由不能为小部件 1 到 3 提供子表单？主窗体不必绑定，可以将链接主字段设置为与相关子窗体字段匹配的控件，以便在相关子窗体中输入数量时自动将数据填充到小部件表中。

# c# - `using` 会处理其中声明的所有对象吗？

> ID：12410806
> 
> 赞同：1
> 
> 时间：2012-09-13T16:31:29.240
> 
> 标签：c#

我想知道如果我执行or操作，`using`语句中创建的对象是否会被释放。示例如下。`return``throw`

```
using(SomeClass thing = new SomeClass())
{
  ...
  if(condition)
    return;
  ...
} 
```

上面会混淆还是GC在这里值得信任？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T16:32:54.437

是的，它会的。该`using`语句将导致`finally`创建一个块。即使在相关块中抛出异常，或者如果该 try 块中有语句， `finally`块的代码也会运行。`try``return`

只有少数例外情况会导致`finally`块的代码不被执行，它们都列[在这里](https://stackoverflow.com/a/10260233/1159478)，但我的猜测是，在你的情况下，你将能够承受这些后果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:34:03.393

是的，因为 using 被编译器最终扩展为 try 。处置将发生在 finally 块内。此外，finally 将包含一个测试，以检查 using 中的变量是否为 null（以防构造函数出现异常）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T16:33:32.613

`using`是等价的`try-finally`，是的，确实如此。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-13T16:33:34.300

如果实现了 dispose ，它将始终被调用。它相当于在 finally 块中调用 dispose。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-13T16:33:49.527

它会处理，是的。它将在 CIL 代码中创建一个 finally 块。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-13T16:41:39.297

编写 using 语句时：

```
using(SomeClass thing = new SomeClass())
{
    //...
    if (condition)
        return;
    //...
} 
```

这将导致以下代码：

```
SomeClass thing;
try
{
    thing = new SomeClass();
    //...
    if (condition)
        return;
    //...
}
finally
{
    if(thing != null)
    {
        thing.Dispose();
    }
} 
```

所以所有声明的对象`using ( /* HERE */ )`都会自动处理。在`{}`will not 中声明的对象。但是您当然可以使用语句嵌套（或堆栈）：

```
using (var thing = new SomeClass())
    using (var another = new Another())
        using (var somethingElse = new Whatever())
        {
            //...
        } 
```

这当然只是写作的语法糖

```
using (var thing = new SomeClass())
{
    using (var another = new Another())
    {
        using (var somethingElse = new Whatever())
        {
            //...
        }
    }
} 
```

因为当一个语句后面只有一个代码块（在这种情况下是另一个`using`-block）时，你可以跳过花括号......

当使用两个或多个相同类型的对象时，您可以在`using`-statement 中链接声明：

```
using (MemoryStream stream = new MemoryStream(), stream2 = new MemoryStream())
{
    //...
} 
```

（感谢@Gratzy 指出这一点）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-07-16T03:46:19.043

对我来说，问题与细节不匹配，细节已经在这里解决了一堆但不是标题问题......

> 是否`using`处理其中声明的所有对象？

**不**，它没有。它只`Dispose()`在其声明中调用对象。它不要求在其中声明`Dispose()`的*对象*。

我通常在代码中看到这种东西

```
using(var sqlConn = new SqlConnection("connStr"))
using(var sqlCmd = new SqlCmd("CmdText", sqlConn))
{
   sqlConn.Open();
   var reader = sqlCmd.ExecuteReader();
   while (reader.Read())
   {
     //stuff is done
   }
} 
```

这将处置和关闭两者`sqlConn`，`sqlCmd`当范围完成时，那些*在使用范围中声明的*`reader`并没有自动调用它。*`Dispose()`*

# c1-cms - 检索媒体文件的外部 URL

> ID：12410807
> 
> 赞同：1
> 
> 时间：2012-09-13T16:31:31.203
> 
> 标签：c1-cms

我有一个带有属性“图像”的页面数据文件夹，它是对复合 C1 后端中媒体文件的引用。

我现在想在我的 asp.net 用户控件中检索数据，但是当我访问 PageDataFolder 类型的“图像”属性时，我得到的只是一个具有以下格式的字符串：

> 媒体存档：b5354eba-3f69-4885-9eba-74576dff372d

我不确定如何从中获取外部图像 url。有我可以使用的 API 函数吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T09:28:35.647

建立一个像

〜/媒体（**{媒体密钥}**）

例如：“~/媒体（媒体存档：b5354eba-3f69-4885-9eba-74576dff372d）”

渲染 C1 页面后，它将被以下 SEO 友好 url 替换：

/media/ **{媒体档案中图像的路径}** )

例如：“/media/5611182f-6462-4b80-a051-3c3b9bb3276d/References/Screenshots/Olympiacos/1_png”

请注意，您可以通过查询字符串指定图像重新处理/裁剪选项。 [http://docs.composite.net/Getting-started/Configuration/Resizing-Images](http://docs.composite.net/Getting-started/Configuration/Resizing-Images)

如果您由于某种原因不能依赖 C1 页面渲染逻辑，您可以使用以下代码构建公共媒体 url：

```
protected string GetMediaUrl(string mediaPath)
{
    string[] parts = mediaPath.Split(new[] { ':' });

    string mediaStore = parts[0];
    Guid mediaId = new Guid(parts[1]);

    string mediaUrl = MediaUrls.BuildUrl(new MediaUrlData { MediaStore = mediaStore, MediaId = mediaId, QueryParameters = new NameValueCollection() },
                                         UrlKind.Public);

    // Temporary fix, allows media player to receive a nice url with an extension
    return mediaUrl.Replace("_jpg", ".jpg").Replace("_mov", ".mov").Replace("_m4v", ".m4v").Replace("_swf", ".swf");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:48:26.290

我找到了一种方法，但它并不是最短的方法：

```
MediaUrlHelper.GetUrl(MediaUrlHelper.GetFileFromQueryString(new NameValueCollection { {"id", myItem.Image} })) 
```

我仍然希望有人提出更好的解决方案，我很乐意将其标记为答案。

# html - CSS：调整元素大小而不是清除浮动

> ID：12410811
> 
> 赞同：2
> 
> 时间：2012-09-13T16:31:38.547
> 
> 标签：html, css

我有一个包含图像的框，其中包含 float:left 集和文本内容。

```
-------------------------------------
|---------                           |
||       |                           | 
|| Image |                           |
||       |       Content             |
|---------                           |
|                                    |
|                                    |
|                                    |
--------------------------------------
                                Fig. 1 
```

我通常认为让内容漂浮在图像周围是件好事。但是，在使用列表的情况下，以下外观很烦人：

```
-------------------------------------
|---------                           |
||       |   List                    | 
|| Image |                           |
||       |   1\. Item                 |
|---------   2\. Item                 |
|  3\. Item                           |
|  4\. Item                           |
|                                    |
--------------------------------------
                                Fig. 2 
```

我宁愿采用以下方式（至少对于相当短的列表，让我们假设现在列表很短）

```
-------------------------------------
|---------                           |
||       |   List                    | 
|| Image |                           |
||       |   1\. Item                 |
|---------   2\. Item                 |
|            3\. Item                 |
|            4\. Item                 |
|                                    |
| Additional content (not in list)   |
--------------------------------------
                                Fig. 3 
```

我通过制作列表得到了上面的外观`display: inline-block`（或者在列表之前插入一个`<br>`，或者将它包装在一个块级元素中）

但是，如果有任何长列表项（长于内容字段的小宽度），浮动将被清除。

```
-------------------------------------
|---------                           |
||       |                           | 
|| Image |                           |
||       |                           |
|---------                           |
| 1\. Item                            |
| 2\. A very long item, which makes   |
|    the list box just as wide as the|
|    outer box.                      |
| 3\. More items                      |
-------------------------------------|
                                Fig. 4 
```

为什么会发生这种情况对我来说似乎很清楚。在浮动环境中，首先将列表呈现为一个块（因为`display: inline-block`），使用外框的宽度作为环境宽度。由于物品很长，因此生成的块将与外箱一样宽。在第二步中，尝试将块放在浮动图像旁边，它不适合。最后，浮动被清除。

有什么办法可以改变现状吗？比如，首先尝试用较短的宽度渲染列表，如果失败，重新渲染？或者完全不同的方式来实现我想要的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:33:00.647

将列表放在 a`DIV`中，该列表也以定义的宽度向左浮动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:57:23.340

`overflow:hidden`在你的清单上尝试一个简单的 - 这应该可以解决问题。

请参阅**[示例](http://jsfiddle.net/e4Dky/)**。

# android - R.color 显示错误数据

> ID：12410814
> 
> 赞同：0
> 
> 时间：2012-09-13T16:31:57.740
> 
> 标签：android, android-layout, android-ui

从资源中获取存储的颜色值时，我遇到了一些奇怪的行为。我在 values 文件夹中创建了一个名为 v_color.xml 的文件。

```
 <resources>
     <color name="Blue_ICS">#000099CC</color>
     </resources> 
```

其十进制值应为 = 39372。但是当我将其放入日志时，

```
Log.e(TAG, "Color="+R.color.Blue_ICS); 
```

我得到值颜色=2131296268。所以谁能告诉我这里哪里出错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T16:33:43.580

您正在检查指针。

采用

```
Log.e(TAG, "Color="+getResources().getColor(R.color.Blue_ICS)); 
```

# java - 修剪 Struts2 文本字段字符串输入

> ID：12410817
> 
> 赞同：6
> 
> 时间：2012-09-13T16:32:17.767
> 
> 标签：java, string, struts2

修剪此字符串的最佳方法是什么/放置修剪代码的最佳位置在哪里？

假设我的 jsp 中有以下文本字段：

```
<s:textfield label="First Name" name="person.firstname"/> 
```

动作类：

```
public class BaseAction extends ActionSupport implements ServletRequestAware, SessionAware {
    private Person person;
    // Getters, setters and action logic
} 
```

豆子：

```
public class Person implements Serializable {
    private String lastname;
    private String firstname;
    // Getters and setters
} 
```

我可以更改 bean 中的默认设置，但这似乎是一个 hack：

```
public void setFirstname(String firstname) {
    this.firstname = firstname.trim();
} 
```

**编辑**：我确实也看到了这个问题：[struts2 trim all string 从表单](https://stackoverflow.com/questions/2499530/struts2-trim-all-string-obtained-from-forms?rq=1)中获得，其中一些人还建议“正确”的方法是使用拦截器。

为什么拦截器是“正确”的方式？更改 bean 的设置器有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-20T14:27:18.653

可以使用[Struts2 转换器](http://struts.apache.org/2.3.4.1/docs/type-conversion.html)来完成。

```
public class TrimmingStringConverter extends StrutsTypeConverter {

    public Object convertFromString(Map ctx, String[] values, Class arg2) {
        if (values != null && values.length > 0) {
            return values[0].trim();
        }

        return null;
    }

    public String convertToString(Map ctx, Object o) {
        if (o != null) {
            return o.toString();
        }
        else {
            return null;
        }
    }

    public Object convertValue(Map context, Object o, Class toClass)
    {
        if (o == null) {
            return null;
        } else if (toClass == java.lang.String.class) {
            if (o instanceof String[]) {
                String[] os = (String[]) o;

                if (os.length > 0) {
                    return os[0].trim();
                }
            }

            return o.toString().trim();
        }

        return super.convertValue(context, o, toClass);
   }
} 
```

必须在 xwork-conversion.properties 中注册：java.lang.String=es.jogaco.webapp.TrimmingStringConverter

这将应用于**所有**用户输入。

如果您有默认的 struts2 拦截器，它将起作用。引用自 struts2 文档：

> 默认情况下，转换拦截器包含在默认堆栈中的 struts-default.xml 中

另外，我可以在我的 struts2 应用程序中使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T16:36:56.457

简短的回答是*默认情况下不是*，没有内置机制来执行此操作，您需要在您的操作类中执行此操作，或者某种 java 脚本会为您执行此操作。

其他可能的方法是创建一个拦截器来执行此操作，其中包含排除选项或类似跋涉中的类似内容。

我相信拦截器是一个很好的方法，最好有这样的拦截器与 S2 一起。

# excel - 使用宏来格式化excel中的图表

> ID：12410818
> 
> 赞同：2
> 
> 时间：2012-09-13T16:32:18.610
> 
> 标签：excel, vba, graph, charts

我正在尝试创建一个宏来格式化 Excel 中的图表，以便我的所有图表都具有相同的格式，但数据不同。通常我只会粘贴格式，但这些图表是使用插件制作的，它们似乎与“粘贴格式”不兼容。每个图表与图表数据一起位于不同的工作表中。

我的图表有 3 个系列。每个系列都有特定的格式，例如系列 1：圆形标记，大小 3pt，无标记线，绿色填充。系列 2：圆形标记，尺寸 3pt，黑色标记线，黄色填充。系列 3：圆形标记，大小 3pt，无标记线，红色填充。

此外，图表需要具有特定的展示尺寸（目前还不确定确切的尺寸，但大概应该很容易编辑）。

这些是我需要从默认值更改的唯一参数，以便让图表看起来像我想要的那样。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:52:47.047

使用 VBA 可以很容易地完成图表格式化：

```
Dim chChart as chart
set chChart = Thisworkbook.Sheet("Sheet1").ChartObjects("Chart1").Chart
With chChart
    seriescollection(1).Markerforegroundcolor = rgb(255,255,255)
    seriescollection(1).Markerbackgroundcolor = rgb(255,255,255)
    seriescollection(1).interior.color = rgb(255,255,255)
End With 
```

上面的代码应该让您了解如何编写宏，替换正确的工作表和图表名称。理想情况下，您还可以使用一些循环来遍历图表和图表中的系列

```
For each chart in Thisworkbook.Sheet("Sheet1").ChartObjects
For each series in chChart.seriescollection 
```

要获得您想要更改的确切值，我建议您记录手动进行更改的宏或使用编辑器对象浏览器（VBA 编辑器中的 F2）来查找可能的值。

# vb.net - 在 VB.net 中使用 Linq 编写连接查询

> ID：12410821
> 
> 赞同：5
> 
> 时间：2012-09-13T16:32:26.760
> 
> 标签：vb.net, linq, entity-framework, join

我试图在 vb 中将 SQL 查询转换为 linq 查询。但是我在语法正确时遇到了一些麻烦。

原始查询

```
SELECT b.* 
FROM History_Table_B b 
INNER JOIN Employee e ON b.EmployeeId = e.EmployeeId 
INNER JOIN Company c ON e.CompanyId = c.CompanyId 
WHERE e.AncillaryId = @AncillaryPersonId 
AND c.AncillaryId = @AncillaryCompanyId
AND (b.EndDate is null OR b.EndDate >= convert(date, GetDate())) 
```

我的 Linq

```
Dim result = From b In context.H_Table_B
             Join employee In context.Employees
             On b.EmployeeId Equals (employee.EmployeeId)
             Join company In context.Companies
             On employee.CompanyId Equals (company.CompanyId) 
             Where employee.AncillaryId Equals(iPerId) 
             And company.AncillaryId Equals (iCompanyId) 
             And ((b.EndDate Is Nothing) Or (b.EndDate Equals(DateTime.Today))) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T16:42:11.147

在 where 条件下，您不能使用像 Join LINQ 查询这样的 Equals（运算符）。这里 Equals 是对象类的一种方法，因此您可以使用 '.' 访问。例如`employee.AncillaryId.Equals(iCompanyId)`

并且还有一件事在新行 VB.net 的 Where 条件中需要“_”。

例如

```
From b In context.H_Table_B
         Join employee In context.Employees
         On b.EmployeeId Equals (employee.EmployeeId)
         Join company In context.Companies
         On employee.CompanyId Equals (company.CompanyId) 
         Where employee.AncillaryId.Equals(iPerId) _ 
         And company.AncillaryId.Equals(iCompanyId) _
         And ((b.EndDate Is Nothing) Or (b.EndDate.Equals(DateTime.Today))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:35:10.077

我认为您只是缺少一个点-尝试：

```
...b.EndDate.Equals(DateTime.Today) 
```

# file - Gradle - 将单个文件添加到 JAR

> ID：12410828
> 
> 赞同：15
> 
> 时间：2012-09-13T16:32:59.980
> 
> 标签：file, jar, include, task, gradle

我在项目的根目录中有文件“license.txt”。在 jar-task 中，我想将此文件添加到 JAR 文件的（根文件夹）中。

我试过了

```
jar {
  from '.' include 'license.txt'
} 
```

但这会*替换*其他内容（.class 文件）而不是*添加*文件。而且我不想将 license.txt 添加到资源文件夹中，因为我不想仅仅因为构建工具而改变我的项目结构。

谁能帮忙？谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-13T19:53:10.023

要添加单个文件，您只需执行以下操作：

```
jar {
    from "license.txt"
} 
```

如果您通过将其括在花括号中`include`来限定您的范围，您的解决方案也应该有效。`from`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-10-09T17:14:09.313

如果你想添加多个文件，你可以这样做：

```
jar{
    from{
        ["aaa.txt","bbb.txt"]
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-09T10:44:58.427

您将添加多个文件到输出 jar，如下所示：

```
jar {
    // Update jar name according to Ascertia conventions
    /**
     * archiveFileName
     * The archive name. If the name has not been explicitly set, the pattern for the name is:
     * [archiveBaseName]-[archiveAppendix]-[archiveVersion]-[archiveClassifier].[archiveExtension]
     */
    archiveFileName = 'database_postgresql.jar'
    from(['build/classes/java/main','mappings/postgresql'])
} 
```

将添加以下目录中的所有内容：

*   构建/类/java
*   /main/mappings/postgresql

# javascript - 如何通过 HTML + CSS 中的另一个元素选择器更改元素的属性值？

> ID：12410830
> 
> 赞同：0
> 
> 时间：2012-09-13T16:33:03.240
> 
> 标签：javascript, html, css

我有 2 个元素按钮，我想在单击另一个按钮时更改其中一个的颜色，反之亦然。我试过了，但不工作。谁能帮我？HTML：

```
<button id="t1">Test 1</button>
<button id="t2">Test 2</button> 
```

CSS：

```
#t1:active + #t2
{
    color: red;
}
#t2:active + #t1
{
    color: red;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:35:01.740

反之亦然，因为兄弟组合器仅在一个方向上工作（从较早的兄弟到较晚的兄弟）。换句话说，使用 CSS，您只能更改单击的`#t2`时间`#t1`，而不能更改单击的`#t1`时间`#t2`。此外，[`>`是子组合器](https://stackoverflow.com/questions/3225891/what-does-mean-in-css-rules/3225905#3225905)，而不是兄弟组合器。

如果您需要相同的行为以两种方式工作，则必须使用 JavaScript mousedown 事件而不是`:active`选择器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T17:12:41.863

我可以想到几种方法来仅使用 CSS 来实现这一点，尽管它们并不完全“真诚”。

第一种方法依赖于创建第一个按钮的“假”克隆，并在第二个按钮为`:active`demo: [little link](http://jsfiddle.net/glee/Jxvck/)时显示它。

第二种方法依赖于这样一个事实，即当您`button`的 s 之一是时`:active`，它后面的父元素`:active`也是如此。这是此解决方案的演示：[little link](http://jsfiddle.net/glee/hk7jv)。

# grails - 在 grails 中重定向

> ID：12410831
> 
> 赞同：0
> 
> 时间：2012-09-13T16:33:10.183
> 
> 标签：grails

我在 grails 中重定向上传的图像，如下所示：

控制器：

```
 def upload() {
    def f = request.getFile('myFile')
    if (f == null | f.empty) {
        flash.default = "file cannot be empty"
        errors.getFieldError("cannot be empty")
        return
    }
    def fName = f.getOriginalFilename()
    def picture = new Picture(orgName: fName, urlOrg: "http://localhost/"+fName)
    f.transferTo(new File('/Users/sagarmichael/Desktop/photoUpload/'+fName))
    println("saved")
    redirect(action: 'test', params: [url1:picture.urlOrg] )

}

def test(){
    System.out.println(params.url1)
            [url1:params.url1]

} 
```

我希望这会将 url1 发送到我的名为 test 的视图中，我有这个：

```
<img src="${url1}"/> 
```

我希望这会在屏幕上显示图像。我正确设置了 apache2 配置，当我去

```
http://localhost/<imageName> 
```

它工作正常。

我在浏览器的 url 栏中得到的是：

```
http://localhost:8080/FYP/profile/test?url1=http%3A%2F%2Flocalhost%2Flonglogo3.png 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:36:29.450

尝试

```
render(view:"test", model: [url1:picture.urlOrg]) 
```

或者

```
chain(action: "test", model: [url1:picture.urlOrg]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:52:16.107

如果您使用该`redirect`方法，`params`它们将出现在 url 中。要省略这一点，您需要以另一种方式来设计代码。

查看您的代码，您似乎上传了一些图像并需要显示结果。我建议您只将图像的名称传递给您的其他方法并动态安装链接（并不总是本地主机，对吗？）。输出网址将是：

```
http://localhost:8080/FYP/profile/test?image=longlogo3.png 
```

如果您也需要省略图像的名称，则必须将其存储在会话中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:44:56.467

您正在混合模型和 URL 参数。如果你真的需要这样，你必须在 test() 动作中将 param 'url1' 的内容放入模型中：

```
def test() {
    return [ 'url1': params.url1 ]
} 
```

我希望你明白这一点，我绝对建议重新设计代码;-)

# java - 在 Color 类中定义的常量 - Myprogramminglab

> ID：12410834
> 
> 赞同：0
> 
> 时间：2012-09-13T16:33:15.147
> 
> 标签：java, colors, constants

我想不通这个：

> ```
> > Given g, a reference to a Graphics object, use a constant defined in
> > the Color class to write a statement that arranges for the next drawn
> > rectangle to be red: 
> ```

有人有想法吗？它适用于 Myprogramminglab

我想到了：

```
g.setColor(Color.red); 
g.drawRect (10, 10, 200, 200); 
```

或类似的东西，但不起作用。尝试了我能想象到的一切。

谢谢

编辑

Myprogramminglab 上的最后一个问题是这样的：

> ```
> > Write the invocation (method name with arguments) needed to display
> > the outline of a square whose sides are 60 pixels and whose top right
> > corner is located at (100,200). 
> ```

答案是：

```
drawRect(40,200,60,60) 
```

所以我没有得到关于我需要做什么的更多或更少的信息，而且答案不像构建整个脚本。所以我真的没有头绪。在 Java Solutions 一书中，也没有关于我现在遇到的问题的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:37:26.937

You have to put your code inside a [paintComponent(Graphics g)](http://docs.oracle.com/javase/6/docs/api/javax/swing/JComponent.html#paintComponent%28java.awt.Graphics%29) method, overridden from a JComponent class (like JPanel).

---- Edit ----

Here is some code to give you some clues:

```
public class MyHomeworkClass extends JPanel {
    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.setColor(Color.red);
        g.drawRect(40,200,60,60);
    }
} 
```

Then just add this panel to a Frame to show it.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T16:59:25.753

```
g.setColor(Color.red); 
```

和

```
g.setColor(Color.RED); 
```

两者都有效。

# python - 用python抓取多个不连续的行

> ID：12410835
> 
> 赞同：3
> 
> 时间：2012-09-13T16:33:17.643
> 
> 标签：python, text

我有一个文本文件，我希望能够找到“Acct Nbr：”的任何实例，并获取“队列编号：”、“队列描述：”的前几行以及名为 ApplNbr 的队列编号之后的第 5 行。如果在它之前还有其他应用程序，它并不总是第 5 行。此行始终是 3 列数字。例如：“5024 17 110”或“964 16 100”

如您所见，每个队列有时有多个“Acct nbr：”条目，但大多数时候只有一个。如果可能的话，有多个 Acct nbr: 在一个队列编号行下会很好。此文本文件中有数千个条目，我只需要查找由 Acct nbr 标识的这些错误：但我需要每个错误的队列号、que 描述和 appl nbr。我希望我是清楚的。

我用“->”标记了所需的行。我想使用 python，但我对其他脚本语言（如 powershell）或使用 gnu 实用程序（如 grep）持开放态度。

感谢您的时间和关注。

要解析的文本示例：

```
->Queue Number: 87125  Queue Effective Date:  09-05-2012  Queue Scheduled Date:  09-05-2012

->Queue Description: **Posting File** Processing  Queue Type Description: PM File Load Copy

  Appl QSub  Seq  Appl                   Appl      Return   Start     Stop   Time of Run

  Nbr  Nbr   Nbr  Description            Name      Code     Time      Time   (In Minutes)

->386  2     0    Inclearing Processing  AH_CLEAR  0      12:07:21  12:07:56       0.583

  Procedure Complete
  ***************  Batch Application Errors  ***************

->Acct Nbr: 0000000000      Batch Actv Msg: Bank Check Not Processed - Validation Error

->Batch Oracle Msg:

->Acct Nbr: 0000000000      Batch Actv Msg: Bank Check Not Processed - Validation Error

->Batch Oracle Msg: 
```

期望的输出：

```
Queue Number: 87125  Queue Effective Date:  09-05-2012  Queue Scheduled Date:  09-05-2012

Queue Description: **Posting File** Processing  Queue Type Description:  PM File Load Copy

386    2      0  Inclearing Processing     AH_CLEAR  0      12:07:21  12:07:56       0.583

Acct Nbr: 0000000000      Batch Actv Msg: Bank Check Not Processed - Validation Error
Batch Oracle Msg:

Acct Nbr: 0000000000      Batch Actv Msg: Bank Check Not Processed - Validation Error
Batch Oracle Msg: 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:36:34.943

Iterate every line with a state machine that stores the latest `Queue Number` and `Queue Description`. When you find the `Acct Nbr` use the stored values to generate your output.

Quick untested example, please adapt to your own needs:

```
class State(object):

    qnumb = None
    qdesc = None

    def feed(self, line):
        if line.startswith('Queue Number'):
            self.qnumb = line
        elif line.startswith('Queue Description'):
            self.qdesc = line
        elif line.startswith('Acct Nbr'):
            return line, self.qnumb, self.qdesc

def parse(lines):
    results = []
    s = State()
    for line in lines:
        entry = s.feed(line)
        if entry:
            results.append(entry)
    return results 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:47:47.823

由于您想要的行具有特定的格式，我想我会使用正则表达式来匹配想要的输入行。您可以使用 re.search() 来返回一个包含所需内容的匹配对象。

您可以在此处阅读有关正则表达式的更多信息：http: [//docs.python.org/py3k/library/re.html](http://docs.python.org/py3k/library/re.html)

# ios - NSDate 到 Tick 的转换

> ID：12410839
> 
> 赞同：4
> 
> 时间：2012-09-13T16:33:31.000
> 
> 标签：ios, objective-c, type-conversion, nsdate

我想将日期（nsdate）转换为刻度值。自 0001 年 1 月 1 日格林威治标准时间 00:00:00 以来，刻度值为（1 个刻度 = 0.1 微秒或 0.0001 毫秒）。NSDate 具有类似 timeIntervalSince1970 的功能。那么，我该如何转换呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:33:31.000

我想分享一下我的经验：

我试图从 01/01/0001 中找到秒数，然后乘以 10,000,000。但是，它给了我错误的结果。所以，我发现 01/01/1970 是 01/01/0001 的 621355968000000000 个刻度，并使用以下公式以及 NSDate 的 timeIntervalSince1970 函数。

滴答声 = (MilliSeconds * 10000) + 621355968000000000

毫秒 =（滴答声 - 621355968000000000）/ 10000

结果如下：

```
+(NSString *) dateToTicks:(NSDate *) date
{
    NSString *conversionDateStr = [self dateToYYYYMMDDString:date];
    NSDate *conversionDate = [self stringYYYYMMDDToDate:conversionDateStr];
    NSLog(@"%@",[date description]);
    NSLog(@"%@",[conversionDate description]);
    double tickFactor = 10000000;
    double timeSince1970 = [conversionDate timeIntervalSince1970];
    double doubleValue = (timeSince1970 * tickFactor ) + 621355968000000000;
    NSNumberFormatter *numberFormatter = [[[NSNumberFormatter alloc] init] autorelease];
    [numberFormatter setNumberStyle:NSNumberFormatterNoStyle];
    NSNumber *nsNumber = [NSNumber numberWithDouble:doubleValue];
    return [numberFormatter stringFromNumber:nsNumber];
} 
```

同样，要从刻度转换为日期：

```
//MilliSeconds = (Ticks - 621355968000000000) / 10000
+(NSDate *) ticksToDate:(NSString *) ticks
{
    double tickFactor = 10000000;
    double ticksDoubleValue = [ticks doubleValue];
    double seconds = ((ticksDoubleValue - 621355968000000000)/ tickFactor);
    NSDate *returnDate = [NSDate dateWithTimeIntervalSince1970:seconds];
    NSLog(@"%@",[returnDate description]);
    return returnDate;
} 
```

# android - Android 通知最后收到的短信

> ID：12410847
> 
> 赞同：0
> 
> 时间：2012-09-13T16:33:55.643
> 
> 标签：android, notifications, sms, broadcastreceiver

我正在尝试制作一个简单的应用程序来拦截从我的电话运营商的电子邮件服务收到的所有 SMS。

它是如何工作的：我有一封来自电话接线员的电子邮件，每次收到一封带有 SMS 的电子邮件时都会通知我。短信是这样来的：

* * *

```
You have a new e-mail from:email@domain.com See it now through internet! Visit http://m.iclaro.com.br. Subject: SUBJECT GOES HERE 
```

* * *

我试图制作的这个应用程序必须拦截这些短信，检索整个主题（“SUBJECT GOES HERE”）并从一个只有主题内容的号码发送虚假短信。

我已经完成的工作：截取来自该电子邮件服务的所有这些 SMS，检索主题并从一个新号码（我选择了 3）伪造一条新的 SMS，仅包含主题。

但现在我有一个问题：这条新的伪造短信没有显示任何通知。

广播接收器如下：

* * *

```
public class SmsReceiver extends BroadcastReceiver
    {
        ...
        public void onReceive( Context context, Intent intent ) 
        {
            ...
            if(address.contains("1") && body.contains(replace))
            {                   
                    body = body.substring(body.lastIndexOf(replace),body.length());
                    body = body.replace(replace, "");
                    address = "3";

                    ContentResolver contentResolver = context.getContentResolver();
                    ContentValues values = new ContentValues();
                    values.put("address", address);
                    values.put("body", body);
                    contentResolver.insert(Uri.parse("content://sms/inbox"), values);
                    this.abortBroadcast();
            }
        }
    } 
```

* * *

我也尝试过：

* * *

```
if(address.contains("1") && body.contains(replace))
{
    this.abortBroadcast(); 
```

和

```
contentResolver.insert(Uri.parse("content://sms/inbox"), values);
this.abortBroadcast(); 
```

和

```
this.clearAbortBroadcast();
contentResolver.insert(Uri.parse("content://sms/inbox"), values);
this.abortBroadcast(); 
```

* * *

无论如何要重新通知最后收到的短信？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T18:16:42.907

编辑收到的短信后，您必须对 pdu 进行编码。为此，您可以使用 smslib 等 java 库对 pdu 进行编码。

```
public class SmsReceiver extends BroadcastReceiver
    {
        ...
        public void onReceive( Context context, Intent intent ) 
        {
            ...
            if(address.contains("1") && body.contains(replace))
            {                   
                    body = body.substring(body.lastIndexOf(replace),body.length());
                    body = body.replace(replace, "");
                    address = "3";

                    //ContentResolver contentResolver = context.getContentResolver();
                    //ContentValues values = new ContentValues();
                    //values.put("address", address);
                    //values.put("body", body);
                    //contentResolver.insert(Uri.parse("content://sms/inbox"), values);
                    this.abortBroadcast();
                    //create new pdu from the edited data
                    byte[] pdu = .......;
                    intent.putSerializableExtra("pdus", pdu);
                    context.sendBroadcast(intent);
            }
        }
    } 
```

# c - Linux 上 GNU C 中 ncurses 中的 move(y,x)

> ID：12410849
> 
> 赞同：1
> 
> 时间：2012-09-13T16:33:57.950
> 
> 标签：c, ncurses

我有一段使用 ncurses 的代码。我想知道是否可以使用单个移动功能打印几行。

例如：

```
move(25,25);
printw("Line 1\n");
printw("Line 2\n"); 
```

第 1 行打印在 (25,25) 位置，但如果我不使用 move(26,25)，第 2 行打印在 (26,0)。我可以避免第二步并仍然在 (26,25) 处打印第 2 行吗？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:23:12.127

如果您要打印的内容必须对齐，您可以定义一个新窗口。不久：

```
#include <ncurses.h>

int main()
{
  WINDOW* mywin;

  initscr();
  cbreak();
  keypad(stdscr, TRUE);

  int height=15;
  int width=30;
  int starty=25;
  int startx=25;

  printw("F9 to exit");
  refresh();

  mywin = newwin(height, width, starty, startx);
  mvwprintw(mywin,0,0,"First line\n");
  wprintw(mywin,"Second line");
  wrefresh(mywin);

  while(getch() != KEY_F(9)) {}

  endwin();
  return 0;
} 
```

如果这种方法不适合，那么您必须手动移动到要打印的下一个位置。

# scroll - 使 div 无需单击即可通过键盘滚动

> ID：12410856
> 
> 赞同：4
> 
> 时间：2012-09-13T16:34:50.793
> 
> 标签：scroll

我有 div 元素，我在其中加载文本，通常是长文本，所以 div 有滚动条。当光标在它上面时，我可以用鼠标在这个 div 中滚动，但是我不能上下滚动页面，除非我先在 div 内单击。那么有没有办法避免这种点击，在加载文本时从代码中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-02-20T22:47:32.923

这里的答案对我有用：

[将键盘焦点设置为 <div>](https://stackoverflow.com/questions/6754275/set-keyboard-focus-to-a-div)

基本上`tabindex`在 div 中添加一个：

```
<div id="mydiv" tabindex="-1"> 
```

然后使用以下方式以编程方式设置焦点： document.getElementById("mydiv").focus();

从原来的帖子：

> tabindex 值可以允许一些有趣的行为。
> 
> *   如果给定值“-1”，则元素不能被制表符，但焦点可以通过编程方式赋予元素（使用 element.focus()）。
> *   如果给定值 0，则元素可以通过键盘获得焦点并落入文档的选项卡流中。
> *   大于 0 的值创建优先级，其中 1 是最重要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-27T15:59:26.833

正如你所描述的，就是这样。我将输入附加到内容 div，然后对其进行 focus()，而不是尝试聚焦 div。因此，在按下加载文本后，您可以立即按下 pg up/dn 来滚动 div。

[**这里是**](http://jsfiddle.net/BQQ8C/28/)

```
 $("div").append('<input type="text" id="focusDiv">');
    /*
 Here I need to have some code which gives "focus to the div, so if I press the load text and then immediately PageDown key, sthedvis scrolls down.

 $("button").on("click", function (e) {
    e.preventDefault();
    $("div").html("Very long text...");
    $("div").append('<input type="text" id="focusDiv">');
    $('#focusDiv').focus();
}); 
```

# java - 复制文件后显示成功消息

> ID：12410859
> 
> 赞同：-2
> 
> 时间：2012-09-13T16:34:57.627
> 
> 标签：java, android, toast

我对 Android 开发相当陌生，所以我想我会从一个基本的应用程序开始。当按下按钮时，它会将文件复制到代码中写入的位置（请参阅下面的代码）。当我按下安装按钮并将文件复制到其位置时，我想要一条 toast 消息显示“成功安装或复制文件时出错”。我将如何实现这一点？

```
public class TrialActivity extends Activity {

private ProgressDialog progressDialog;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    runDialog(5);
}

private void runDialog(final int seconds)
{
    progressDialog = ProgressDialog.show(this, "Please Wait...", "unpacking patch in progress");

    new Thread(new Runnable(){
        public void run(){
            try {
                Thread.sleep(seconds * 1000);
                progressDialog.dismiss();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }).start();

    ((Button)findViewById(R.id.button1)).setOnClickListener(new View.OnClickListener()
    {
      public void onClick(View paramView)
      {

      }

   {

              InputStream in = null;
              OutputStream out = null;
  String filename="savegame.bin";           
  try {    

                in = getResources().openRawResource(R.raw.savegame);
                out = new FileOutputStream("/sdcard/Android/data/files/" + filename);
                copyFile(in, out);
                in.close();
                in = null;
                out.flush();
                out.close();
                out = null;
              } catch(Exception e) {
                  Log.e("tag", e.getMessage());
              }       

      }
      private void copyFile(InputStream in, OutputStream out) throws IOException {
          byte[] buffer = new byte[1024];
          int read;
          while((read = in.read(buffer)) != -1){
            out.write(buffer, 0, read);

          }
      }
      }
    );
  }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:43:12.400

使用下一个代码：

```
 private class AsyncTaskDialog extends AsyncTask<Void, Void, Void> {
    Toast toastSuccess;

    boolean flagSuccessCopy =false;
            protected void onPreExecute() {
                super.onPreExecute();

                }
            }

            protected Boolean doInBackground(Void... params) {
                copyFiles();
                return null;
            }

            @Override
            protected void onPostExecute(Boolean result) {
                super.onPostExecute(result); 

              if (getActivity() != null) {
                 if(flagSuccessCopy){
                  toastSuccess  = Toast.makeText(context, "Success", duration);
                 }else{
                      toastSuccess  = Toast.makeText(context, "Error", duration);
                 }
                toast.show();               
            }
        } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-13T16:46:11.510

允许将任何文件从任何应用程序复制到 SD 卡

```
import ru.gelin.android.sendtosd.R;
import android.app.Activity;
import android.app.AlertDialog;
import android.widget.ProgressBar;
import android.widget.TextView;

public class ProgressDialog extends AlertDialog implements Progress {

/** Activity for which the dialog is created */

Activity activity;

/** Progress manager for the dialog */
ProgressManager manager = new ProgressManager();

/**
 *  Creates the customized progress dialog for
 *  activity.
 */
protected ProgressDialog(Activity activity) {
    super(activity);
}

@Override
public void setFiles(int files) {
    synchronized (manager) {
        manager.setFiles(files);
    }
    activity.runOnUiThread(new Runnable() {
        @Override
        public void run() {
            synchronized (manager) {
                updateTotalProgress();
            }
        }
    });
}

@Override
public void nextFile(final File file) {
    synchronized (manager) {
        manager.nextFile(file);
    }
    activity.runOnUiThread(new Runnable() {
        @Override
        public void run() {
            synchronized (manager) {
                updateFileName(file);
                updateFileProgress();
                updateTotalProgress();
            }
        }
    });
}

@Override
public void processBytes(long bytes) {
    synchronized (manager) {
        manager.processBytes(bytes);
    }
    activity.runOnUiThread(new Runnable() {
        @Override
        public void run() {
            synchronized (manager) {
                updateFileProgress();
            }
        }
    });
}

void updateTotalProgress() {
    ProgressBar progress = (ProgressBar)findViewById(R.id.total_progress);
    progress.setMax(manager.getFiles());
    progress.setProgress(manager.getFile());
    TextView text = (TextView)findViewById(R.id.total_files);
    text.setText(getContext().getString(R.string.files_progress,
            manager.getFile(), manager.getFiles()));
}

void updateFileName(File file) {
    if (file == null) {
        return;
    }
    TextView view = (TextView)findViewById(R.id.file_name);
    view.setText(file.getName());
}

void updateFileProgress() {
    ProgressBar progress = (ProgressBar)findViewById(R.id.file_progress);
    if (manager.getProgressInUnits() < 0) {
        progress.setIndeterminate(true);
    } else {
        progress.setIndeterminate(false);
        progress.setMax((int)(manager.getSizeInUnits() * 10));
        progress.setProgress((int)(manager.getProgressInUnits() * 10));
    }
    TextView text = (TextView)findViewById(R.id.file_size);
    text.setText(getContext().getString(manager.getSizeUnit().progressString,
            manager.getProgressInUnits(), manager.getSizeInUnits()));
    }

} 
```

来源：[http ://code.google.com/p/sendtosd-android/source/browse/src/ru/gelin/android/sendtosd/progress/ProgressDialog.java?spec=svn0933973391a12bee4759a32f5776864c64022d71&r=0933973391a12bee4759a32f577186246](http://code.google.com/p/sendtosd-android/source/browse/src/ru/gelin/android/sendtosd/progress/ProgressDialog.java?spec=svn0933973391a12bee4759a32f5776864c64022d71&r=0933973391a12bee4759a32f5776864c64022d71)

# c++ - 不完整变量类型的编译器错误

> ID：12410860
> 
> 赞同：0
> 
> 时间：2012-09-13T16:34:59.057
> 
> 标签：c++, boost, namespaces, compiler-errors

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:51:22.283

`matrix_column`在`<boost/numeric/ublas/matrix_proxy.hpp>` [http://www.boost.org/doc/libs/1_51_0/libs/numeric/ublas/doc/matrix_proxy.htm#matrix_column中声明](http://www.boost.org/doc/libs/1_51_0/libs/numeric/ublas/doc/matrix_proxy.htm#matrix_column)

# c# - EnumerableCollectionView 到 ListCollectionView 与 DataGrids

> ID：12410865
> 
> 赞同：5
> 
> 时间：2012-09-13T16:35:15.427
> 
> 标签：c#, wpf, sorting, datagrid, collectionview

我有一个试图在其上实现 CustomSort 的 DataGrid。DataGrid ItemsSource 始终返回不可排序的 EnumerableCollectionView 类型。我正在尝试将 EnumerableCollectionView 转换为 ListCollectionView 以便我可以在其上实现我的 CustomSort 方法。底层集合是一个 ObservableDictionary。如何将 EnumerableCollectionView 转换为 ListCollectionView 或从 ItemsSource 返回 ListCollectionView？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:16:09.173

最终自己解决了这个问题。我创建了一个包含所有 DataGridRows 的新列表，然后基于我的 DataGridRows 列表创建了一个新的 ListCollectionView。然后，我根据新列表执行了我的自定义排序，并将 DataGrid 的 ItemsSource 设置为 ListCollectionView。

```
private void PerformCustomSort(DataGridColumn column) {
        ListSortDirection direction = (column.SortDirection != ListSortDirection.Ascending) ? ListSortDirection.Ascending : ListSortDirection.Descending;
        column.SortDirection = direction;

        List<DataGridRow> dgRows = new List<DataGridRow>();
        var itemsSource = dataGrid1.ItemsSource as IEnumerable;

        foreach (var item in itemsSource) {
            DataGridRow row = dataGrid1.ItemContainerGenerator.ContainerFromItem(item) as DataGridRow;
            if (null != row) {
                dgRows.Add(row);
            }
        }

        ListCollectionView lcv = new ListCollectionView(dgRows);
        SortOrders mySort = new SortOrders(direction, column);
        lcv.CustomSort = mySort;
        dataGrid1.ItemsSource = lcv;
    } 
```

这让我可以避免 EnumerableCollectionView 并允许排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T17:29:03.910

我认为你的做法是错误的。您不要让 DataGrid 确定要使用哪种集合，而是自己显式创建集合并将 DataGrid 绑定到它。

您可能不需要通过强制转换 ItemsSource 来检索集合，您应该将其存储为 ViewModel 的属性，或者存储在代码隐藏中。

如果您确实需要从 DataGrid 中检索引用，只需将其转换为：

```
ListCollectionView myList = (ListCollectionView)dataGrid.ItemsSource; 
```

但在大多数情况下，如果你这样做，你可能在代码结构上做错了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T19:29:19.010

您可能在处理较大集合中的集合/子集时遇到问题。例如：

```
ItemsSource = dsJournals.Local.Where(j => j.Jrnl == "AAA"); 
```

`dsJournals.Local`是 a`ListCollectionView`但 LINQ 查询的结果是`EnumerableCollectionView`.

# java - Liferay API：通过权限获取角色

> ID：12410866
> 
> 赞同：2
> 
> 时间：2012-09-13T16:35:17.690
> 
> 标签：java, api, jsf, liferay

目前，我正在尝试创建一个概述，其中列出了为它们中的每一个激活的所有布局和 Portlet 和角色（权限）。

我想我已经很接近解决方案了，但最后一点不见了。

我已经得到了我需要的所有类型的信息。我得到了表单布局-> 到资源-> 到权限。但现在我不知道如何通过 Liferay API 从 Permissions（或 permissionId）到实际的角色。

我有什么：布局、资源、权限我需要什么：角色

使用 Liferay 5.2.4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T14:03:07.310

您可以使用 RoleLocalServiceUtil。companyId 您可以通过调用 user.getCompanyId 来获取 Liferay 用户。和用户可以通过这种方式检索： user = UserLocalServiceUtil.getUserById(id);

```
private static Role getLiferayRole(String roleName, long companyId) {
    Role role = null;
    try {
        role = RoleLocalServiceUtil.getRole(companyId, roleName);
    } catch (Exception e) {
        LOG.error(e.getMessage());
    } 
    return role;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T10:36:09.273

好吧，我想我终于自己发现了。我现在要做的就是：

```
List<Layout> tempPages = LayoutLocalServiceUtil.getLayouts( 0, LayoutLocalServiceUtil.getLayoutsCount() );
List<Role> allAvailRoles = RoleLocalServiceUtil.getRoles( 0, RoleLocalServiceUtil.getRolesCount() );
for ( Layout page : tempPages )
{
    List<Role> mappedRoles = new ArrayList<Role>();
    for ( Role role : allAvailRoles )
    {
        boolean hasRolePermission = PermissionLocalServiceUtil.hasRolePermission( role.getRoleId(),
                                                                                  page.getCompanyId(),
                                                                                  Layout.class.getName(),
                                                                                  ResourceConstants.SCOPE_INDIVIDUAL,
                                                                                  String.valueOf( page.getPrimaryKey() ),
                                                                                  "VIEW" );
        if ( hasRolePermission )
        {
           mappedRoles.add( role );
        }
     }
     pages.add( new LayoutRoleModel( page, mappedRoles ) );
} 
```

# javascript - Convert geocode results into php variables to post to mysql database

> ID：12410867
> 
> 赞同：-1
> 
> 时间：2012-09-13T16:35:22.707
> 
> 标签：javascript, php, google-maps, geocode

I have used the tutorial here [http://tech.cibul.net/geocode-with-google-maps-api-v3/](http://tech.cibul.net/geocode-with-google-maps-api-v3/) to create a page with map and draggable marker to display address and lat/long.

Demo - [http://www.calcunation.com/testgeo.php](http://www.calcunation.com/testgeo.php)

How do I captured those results and put them into a php variable so I can insert into a mysql database?

I'm relatively new to Java, and fairly comfortable with PHP.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:43:11.850

您是否尝试拆分地址组件？

像街道，城市，州，邮编......

如果是这样...您将需要查看地理编码结果，并解析它返回的地址类型数组。

这是一些您可以使用的快速示例代码...

```
//Startup a new geocode instance

var geocoder = new google.maps.Geocoder();

//event.latLng is a latLng object passed into the geocode function to get 
your addy results

geocoder.geocode({'location': event.latLng}, function(results, status) {

//Show the results here
console.log(results);

if (status == google.maps.GeocoderStatus.OK) {

    var addressResults = results[0].address_components;
    var address1 = "";
    var address2 = "";
    var city = "";
    var state = "";
    var zipCode = "";

    for(var i = 0; i < addressResults.length; i++){

        for(var j = 0; j < addressResults[i].types.length; j++){
            if(addressResults[i].types[j] == 'street_number'){
                address1 = addressResults[i].long_name;
                break;
            }

            if(addressResults[i].types[j] == 'route'){
                address1 += " " + addressResults[i].long_name;
                break;
            }

            if(addressResults[i].types[j] == 'subpremise'){
                address2 = addressResults[i].long_name;
                break;
            }

            if(addressResults[i].types[j] == 'locality'){
                city = addressResults[i].long_name;
                break;
            }

            if(addressResults[i].types[j] == 'administrative_area_level_1'){
                state = addressResults[i].short_name;
                break;
            }

            if(addressResults[i].types[j] == 'postal_code'){
                zipCode = addressResults[i].long_name;
                break;
            }
        }
    }

    //Do ajax post to your form here with the data you just parsed out
}
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:44:49.107

从用户的角度来看，AJAX 将是最干净的。我会使用 jquery $.post 来做[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)。

# javascript - Jquery limit text in input box

> ID：12410868
> 
> 赞同：17
> 
> 时间：2012-09-13T16:35:26.560
> 
> 标签：javascript, jquery

I want to limit number of chars in input text field.

Code I'm using:

```
function limitText(field, maxChar){
    if ($(field).val().length > maxChar){
       $(field).val($(field).val().substr(0, maxChar));
    }
} 
```

Event is onkeyup. When I type some text in input field cursor stays on the end of text but focus is backed on start of the text so I can't see cursor.

What can be a problem.

Browser is FF, on IE and chrome it is working correctly

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-09-13T16:36:33.647

you can also do it like this:

```
<input type="text" name="usrname" maxlength="10" /> 
```

to achieve this with jQuery, you can do this:

```
function limitText(field, maxChar){
    $(field).attr('maxlength',maxChar);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-13T16:45:14.157

您的代码在 FF 中运行。这是您的代码的略微修改版本：

```
$('input.testinput').on('keyup', function() {
    limitText(this, 10)
});

function limitText(field, maxChar){
    var ref = $(field),
        val = ref.val();
    if ( val.length >= maxChar ){
        ref.val(function() {
            console.log(val.substr(0, maxChar))
            return val.substr(0, maxChar);       
        });
    }
} 
```

***[演示](http://jsfiddle.net/BPXmK/2/)***

# c++ - constness 是否应该传播到成员指针指针？

> ID：12410872
> 
> 赞同：1
> 
> 时间：2012-09-13T16:35:50.247
> 
> 标签：c++, pointers, coding-style, constants

我有一个成员函数，它被声明为 const 并通过指针修改数据。这似乎具有误导性。我应该删除 const 关键字吗？

我想知道其他人如何在他们的代码中处理这种情况。人们是否只是添加评论以澄清发生了什么？他们不将 const 关键字添加到成员函数吗？也许完全是别的东西？

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T16:41:23.237

您基本上有两种选择：

**深度常数：**

```
class Foo
{
    T * ptr;
public:
    T       & operator*()       { return *ptr; }
    T const & operator*() const { return *ptr; }
    T       * operator->()       { return ptr; }
    T const * operator->() const { return ptr; }
}; 
```

**浅常量：**

```
class Foo
{
    T * ptr;
public:
    T & operator*() const { return *ptr; }
    T * operator->() const { return ptr; }
}; 
```

这真的取决于你，也取决于你上课的目的。如果该类是智能指针，那么具有浅常量语义似乎是合理的，因为该类应该尽可能类似于原始指针（当然，您可以有一个指向非常量指针的常量原始指针）。

否则，您应该问自己为什么要公开对成员指针对象的访问权限。您当然有可能希望通过对您的类的持续引用来提供可变访问，但我想这些都是特殊和罕见的情况。首先，您的代码中不应该有那么多原始指针。通过取消引用一个指针来返回一个深度常量引用应该没问题，但通常在更好封装的“getter”函数中，它隐藏了你的类中有一个指针的事实，比如`T const & get() const { return *ptr; }`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:37:12.473

一般来说，是的。即使您可以做到，修改您声明为常量的内容也是一种欺骗性行为。

如果有人使用您的代码并看到 const，他们期望 const。修改，即使对你来说是明智的，也可能会给他们带来严重的问题——甚至使程序崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T17:15:46.733

考虑一个`std::vector<Blah>`成员与`Blah*`用于实现动态数组的成员。大多数情况下，用前者代替后者是有意义的。对于`Blah*`成员`const`，允许方法修改数组中的数据，而对于`std::vector<Blah>`成员，`const`不允许方法修改那里的数据。

还要考虑一个带有索引方法的矩阵类，该方法返回允许分配给元素的代理。通过代理分配会改变矩阵，而不是代理对象本身。因此，代理对象的赋值运算符可以是（并且应该是）`const`，以便对其效果施加尽可能多的约束，而其主要工作是修改事物。

这是设计级别与编码级别不同的另一个示例。

在第一个示例中，使用成员数组，`const`所有关于表达设计级别约束，但在第二个示例中，使用分配代理，`const`所有关于表达编码级别约束。

然而，这些用法并非不兼容。关键思想是为代码的读者提供尽可能多的约束（因为这大大减少了理解或处理代码必须考虑的不同事物的数量）。结果：`const`在您实际可以添加的任何地方添加。

# ruby-on-rails - Helper method to log in in Minitest

> ID：12410873
> 
> 赞同：2
> 
> 时间：2012-09-13T16:35:58.013
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, minitest

Just wondering what the best way to setup something in Minitest acceptance tests to log in before a test.

I'm switching from Cucumber, where it would usually be something like this:

step("log in as userx")

Would I simply define a method to utilise Capybara in my minitest_helper.rb or is there a better way?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T10:19:21.733

由于您没有测试登录功能，您应该能够创建您的`User`类的对象并将其登录（设置会话）。

如果你愿意，你可以把它放进你的`minitest_helper.rb`，这样每次你需要一个登录用户时你都会有一个空白。

# xml - Float image in PDF using xsl:fo

> ID：12410876
> 
> 赞同：1
> 
> 时间：2012-09-13T16:36:29.320
> 
> 标签：xml, xslt, xml-parsing, xslt-2.0, xsl-fo

I have been trying hard to find a solution to this but no luck till now. I'm generating a PDF from xml and I want to float the images inside the pdf. Like for example if I have image floating left in the xml, same should get applied into the pdf.

```
<p>
<img width="127" height="190" src="/images/241729.jpg" style="float: left;">
Globally transition high standards in technology via ubiquitous partnerships.
Distinctively pursue worldwide paradigms vis-a-vis business e-business.
</p> 
```

and the XSL that I have now looks like

```
<xsl:template match="img">
    <xsl:param name="src">
      <xsl:choose>
        <xsl:when test="substring-before(@src,'://') = 'http'"><xsl:value-of select="@src" /></xsl:when>
    <xsl:otherwise>
      <xsl:choose>
        <xsl:when test="substring(@src, 1, 1) != '/' "><xsl:value-of select="@src" /></xsl:when>
        <xsl:otherwise><xsl:value-of select="@src" /></xsl:otherwise>
      </xsl:choose>
    </xsl:otherwise>
      </xsl:choose>
    </xsl:param>

    <fo:block space-after="12pt">
      <fo:external-graphic src="{$src}">
        <xsl:if test="@width">
          <xsl:attribute name="width">
            <xsl:choose>
              <xsl:when test="contains(@width, 'px')">
                <xsl:value-of select="@width"/>
              </xsl:when>
              <xsl:otherwise>
                <xsl:value-of select="concat(@width, 'px')"/>
              </xsl:otherwise>
            </xsl:choose>
          </xsl:attribute>
        </xsl:if>
        <xsl:if test="@height">
          <xsl:attribute name="height">
            <xsl:choose>
              <xsl:when test="contains(@height, 'px')">
                <xsl:value-of select="@height"/>
              </xsl:when>
              <xsl:otherwise>
                <xsl:value-of select="concat(@height, 'px')"/>
              </xsl:otherwise>
            </xsl:choose>
          </xsl:attribute>
        </xsl:if>
      </fo:external-graphic>
    </fo:block>
  </xsl:template> 
```

I'm trying to add `<fo:float>` in this template match but it's not working the way it should. It would be great if you can tell me how to approach this problem.

# orchardcms - 您如何在 Orchard 中删除或重命名内容部分？

> ID：12410882
> 
> 赞同：0
> 
> 时间：2012-09-13T16:36:58.167
> 
> 标签：orchardcms

我给内容部分取了一个错误的名称，我想重命名它。我尝试在解决方案中重命名类及其所有调用均无济于事。我什至尝试从 ShellFeatures 表和 Migrations 本身生成的表中删除条目，但这只会让事情变得更糟。现在整个模块的功能都没有被识别。以前有人试过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-26T17:12:28.813

我知道这是一个老问题，但我只需要解决这个问题，这是我从 Google 获得的第一个结果。

您可以`ContentPart`使用迁移删除并再次添加它，例如：

```
 public int UpdateFrom3() {
        // remove the AccreditationsPart part cleanly
        ContentDefinitionManager.DeletePartDefinition(typeof (AccreditationsPart).Name);
enter code here
        // re-add the AccreditationsPart again
        ContentDefinitionManager.AlterPartDefinition(typeof (AccreditationsPart).Name,
            cfg = > cfg
            .Attachable()
            .WithDescription("Adds a row of configurable accreditations to the content type"));
        return 4;
    } 
```

您需要自定义更新编号以适合您的当前`migrations.cs`，并更改`AlterPartDefinition`以匹配您想要的任何内容。

**警告：**这仅用于解决您立即发现的问题。当您删除迁移第一部分中的部分时，您将丢失所有相关数据。如果您已经在生产环境中运行了代码，那么您将不得不使用不同的方法。

# open-source - 最初在 GPL 下发布的项目可以在未来的版本中“关闭”吗？

> ID：12410885
> 
> 赞同：0
> 
> 时间：2012-09-13T16:37:14.173
> 
> 标签：open-source, gpl

假设我创建了一个我最初在 GPL 许可下分发的软件。然后我决定在将来的某个日期我不希望发布任何进一步修订的源代码。如果我是该软件的原始创建者，并且该软件没有使用任何 GPL 库，是否可以这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:40:00.723

是的。但是，您最初发布的任何副本都将保留在 GPL 下，因为一旦授予用户，您就无法撤销该许可。作为软件的版权所有者和创建者，GPL 有义务继续将源代码提供给早期版本的最终用户。

如果您拥有该代码（您拥有该代码），那么即使您已经获得了 GPL 许可，您也可以随意使用该代码，前提是您履行了对先前版本的被许可人的义务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:56:22.143

如果您编写了所有代码并且从未接受过其他人的补丁，那么您完全有权按照您认为合适的方式重新许可它。GPL 下的原始副本将保持不变。

从法律上讲，您接受第三方的单个补丁*而不*让他们将版权分配给您，然后他们可以强制代码保持 GPL ......或者您被迫跳回补丁之前的代码并仅重播您的更改，因为他们的（基本上不写他们的改变......但要注意你如何“重写”他们的改变）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:38:48.357

我相信是的，是的，但是您之前发布的内容无法收回 - 所以基本上，一旦某件事是 GPL，它始终是 GPL。你可以创建一个未来的封闭版本——但它不能包含任何贡献的代码，我认为它是这样工作的。

# python - When POSTing a Django form, my changes to the form's data are lost

> ID：12410887
> 
> 赞同：0
> 
> 时间：2012-09-13T16:37:25.970
> 
> 标签：python, django, django-forms

In my Django app, I have a `page.html` that includes forms from multiple models like so:

```
# models.py
class OneModel(models.Model):
    foo = models.CharField(...)
    bar = models.CharField(...)

# forms.py
class OneForm(forms.ModelForm):
    class Meta:
        model = OneModel 
```

On save, in addition to the POST data, I add a prefix to all the forms, for example:

```
form1 = OneForm(prefix=OneForm.Meta.model._meta.module_name) 
```

Then, I send the `POST` request to be saved and send the next data to the `__init__` form:

```
# views.py
form_data = {'foo': 'fo-fo-fo',    # from request.POST
             'bar': 'bar-bar-bar'} # -//-//-
form1 = OneForm(form_data)         # without prefix 
```

Afterwards, when the template is being put together, I get input from the form with my data (`fo-fo-fo`, `bar-bar-bar`), but without the prefix in input names, which is not what I want.

But if I add the prefix in the `__init__` part instead I get back the form without my data:

```
# views.py
form1 = OpenForm(prefix=OneForm.Meta.model._meta.module_name, form_data) 
```

How can I get the results of the form with *both* the data I need and the prefix I added?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:03:33.953

您不需要`form_data`从`request.POST`. 您可以将表单实例创建为`form1 = OneForm(request.POST, prefix=OneForm.Meta.model._meta.module_name)`.

# json - 在 POJO 中包含类名 - JSON Marshalling

> ID：12410889
> 
> 赞同：0
> 
> 时间：2012-09-13T16:37:33.497
> 
> 标签：json, datatables, marshalling, jackson, resteasy

按照这个[例子](http://www.mkyong.com/webservices/jax-rs/json-example-with-jersey-jackson/)。

GET 响应是：

> { "singer":"Metallica", "title":"Enter Sandman" }

如果包含更多对象，则输出应如下所示：

> [{“歌手”：“金属乐队”，“标题”：“进入桑德曼”}，{“歌手”：“猫王”，“标题”：“摇滚”}]

我也想写“类名”。像这样的东西：

> {“Track”：[{“singer”：“Metallica”，“title”：“Enter Sandman”}，{“singer”：“Elvis”，“title”：“Rock”}]}

有什么简单的方法可以实现这一目标吗？

期待从 JAX-RS Resteasy (Jackson) 服务器[将数据直接获取到数据表中。](http://datatables.net/release-datatables/examples/ajax/objects.html)还试图避免DTO。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T17:07:33.270

```
class TrackList  
{  
   private List<Track> Track = new ArrayList<Track>();  
   // setter, getter  
} 
```

获取方法

```
public TrackList getTrackInJSON() { 
```

**编辑**
GET 方法

```
public String getTrackInJSON() {   
   // ... create list of objects  

   return convertToString(objects);  
} 
```

实用方法

```
static <T> String convertToString(List<T> list) throws IOException
{
    final String json = new ObjectMapper().writeValueAsString(list);

    return new StringBuilder()
            .append("{\"")
            .append(list.get(0).getClass().getSimpleName())
            .append("\":")
            .append(json)
            .append("}")
            .toString();
} 
```

# c# - 类型约束

> ID：12410890
> 
> 赞同：3
> 
> 时间：2012-09-13T16:37:35.837
> 
> 标签：c#, .net, oop, class, generics

我有以下类层次结构。

```
class Header { IEnumerable<Item> Item { get; set; } .... }
class HeaderA : Header { .... } // Item should have the type of IEnumerable<ItemA>
class HeaderB : Header { .... } // Item should have the type of IEnumerable<ItemB>

class Item { .... }
class ItemA : Item { .... }
class ItemB : Item { .... } 
```

是否可以在编译时检查 of 的类型`Item`以确保它分别是`IEnumerable<ItemA>`、`IEnumerable<ItemB>`for`ItemA`和`ItemB`？有没有更好的设计？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T16:41:50.643

您可以更改 Header 类的定义以将类型参数传递给它，然后您可以强加：

```
 class Header<TItem> where TItem : Item { IEnumerable<TItem> Item { get; set; } }
    class HeaderA : Header<ItemA> { } // Item should have the type of IEnumerable<ItemA>
    class HeaderB : Header<ItemB> { } // Item should have the type of IEnumerable<ItemB>

    class Item { }
    class ItemA : Item { }
    class ItemB : Item { } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:40:19.117

您应该使用[通用类](http://msdn.microsoft.com/en-us/library/sz6zd40f%28v=vs.80%29.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T16:44:12.283

您可以使用泛型类型并将其传递给类。

```
public class Header<T> where T : Item
{
   IEnumerable<T> Item { get; set; }
}

 Header<ItemA> AHeader;
 Header<ItemB> BHeader; 
```

[http://msdn.microsoft.com/en-US/library/sz6zd40f(v=vs.100](http://msdn.microsoft.com/en-US/library/sz6zd40f(v=vs.100) )

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T16:43:11.723

像这样

```
class HeaderA : Header<ItemB> { .... }
class HeaderB : Header<ItemA> { .... } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T16:45:41.807

如果我正确理解您的问题，您可以更改 Header 类的签名来完成此操作。

```
class Header<ItemType> { IEnumerable<ItemType> Item {get; set;} ....}
class HeaderA : Header<ItemA> { .... }
class HeaderB : Header<ItemB> { .... }

class Item { .... }
class ItemA : Item { .... }
class ItemB : Item { .... } 
```

将导致 HeaderA 仅允许 ItemA 对象，而 HeaderB 仅允许将 ItemB 对象放入其各自的 Item 集合中。

# java - 键监听器 Java

> ID：12410891
> 
> 赞同：1
> 
> 时间：2012-09-13T16:37:39.263
> 
> 标签：java, swing, keylistener

我正在尝试在我的代码中使用 KeyListener ......但它不起作用，我认为 KeyListener 没有响应......

如果你们看到有什么不对的地方请告诉我。我不知道为什么它不起作用。提前致谢。

这是代码。

```
import javax.swing.*;
import java.awt.*;
import java.util.Scanner;

public class Main extends JFrame {
    static void drawFrame(JFrame frame) {

        frame.setSize(610, 805);
        frame.setLocation(145, 15);
        frame.setResizable(false);
        frame.setVisible(true);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    }

    public static void main(String[] args) {

        JFrame frame = new JFrame("PacMan");
        drawFrame(frame);
        MyPanel panel = new MyPanel();
        panel.setBounds(00, 00, 610, 800);
        frame.setLayout(null);
        frame.getContentPane().setLayout(null);
        frame.getContentPane().add(panel);
    }
} 
```

我的面板类

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.Toolkit;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.util.Scanner;

import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JLabel;
import javax.swing.JPanel;

public class MyPanel extends JPanel implements KeyListener {

    private int xpac = 285, ypac = 570;

    public MyPanel() {
        this.requestFocus();
        this.requestFocusInWindow();
    }

    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        drawMap1(g);
        drawPacman(g);
        addKeyListener(this);
    }

    void drawMap1(Graphics g) {

        BufferedImage image = null;
        try {
            image = ImageIO.read(new File("pacmap1.png"));
        } catch (IOException e) {
            System.out.println("Can't find the Image.");
        }
        setBackground(Color.BLACK);
        g.drawImage(image, 0, 0, null);
    }

    void drawPacman(Graphics g) {

        int x = xpac, y = ypac;
        BufferedImage image = null;
        try {
            image = ImageIO.read(new File("pacright.png"));
        } catch (IOException e) {
            System.out.println("Can't find the Image.");
        }
        g.drawImage(image, x, y, null);
    }

    @Override
    public void keyPressed(KeyEvent e) {
        // TODO Auto-generated method stub
        System.out.println("Hi there Buddy");

    }

    @Override
    public void keyReleased(KeyEvent e) {
        // TODO Auto-generated method stub
        System.out.println("Hi there Buddy");

    }

    @Override
    public void keyTyped(KeyEvent e) {
        // TODO Auto-generated method stub
        System.out.println("Hi there Buddy");
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:40:54.737

您应该将 放在`this.addKeyListener(this);`MyPanel 类构造函数中，而不是 paintComponent 方法中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:47:15.880

`addKeyListener`您应该在类中注释掉`MyPanel`并在实例化后在 Main 类中执行此操作`MyPanel`：

```
frame.addKeyListener(panel); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T16:42:58.567

请始终将 a`KeyBindings`用于此类任务。请参阅：[http ://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)

作为一个小提示，我建议您将其实现`KeyListener`为`AnonymousClass`.

# javascript - 在页面呈现之前更改 HTML 数据

> ID：12410895
> 
> 赞同：2
> 
> 时间：2012-09-13T16:37:55.343
> 
> 标签：javascript

我一直在寻找这个问题的答案，但似乎无法找到如何去做......或者是否有可能。

我有一个显示 .HTML 页面的 JavaScript 程序。我有来自另一家公司的 API，它也向我们发送信息。我希望能够在用户看到它之前更改 .HTML 页面的内容。这可能吗？

例如，假设 page.html 是：

```
<HTML>
<HEADER>
<TITLE>
The Company Name
</TITLE>
</HEADER>
<BODY>
Some stuff
</BODY>
</<HTML> 
```

page.html 位于我们的服务器上并使用 JavaScript/HTML 我想在页面呈现给用户之前使用 API 中的值更改“公司名称”的值。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:45:43.173

`window.onload`如果您想确保您的用户在编辑之前看不到页面，则不会这样做，因为它`onload`会等待加载所有内容，包括图像。

我推荐的是：

*   更改 head 块中的标题：`<script>document.title="test"</script>`
*   最初隐藏页面，方法是将其包含在`<div id=wholepage style="display:none;">`
*   更改`<script>`正文末尾包含的标准块中的页面内容
*   最后呈现你的大 div 可见，使用`document.getElementById('wholepage').style.display='block';`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:40:32.073

一个简单的 Javascript 函数就可以解决问题：

```
window.onload = function() { document.getElementByTagNames("title")[0].value = "Yourvalue"; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:49:57.130

您可以将页面中的 HTML 加载到字符串变量中。然后，您将在字符串上使用正则表达式并搜索起始表达式和结束表达式，并对该内容进行替换。Javascript 有一个替换方法。

```
var str="<HTML><HEADER><TITLE>The Company Name</TITLE></HEADER><BODY>Some stuff</BODY></<HTML>";
str=str.replace("<TITLE>","<DUMMY>"); 
str=str.replace("</TITLE>","</DUMMY><TITLE>your real title</TITLE>"); 
```

本质上，您会将标题标签重命名为不存在的标签，例如 dummy，然后将真实的标题标签附加到它的末尾。

然后，您可以在运行时在页面中的字符串/变量中显示 HTML 内容。

# java - 具有 testng 并行化的静态 Selenium 客户端

> ID：12410896
> 
> 赞同：0
> 
> 时间：2012-09-13T16:38:06.403
> 
> 标签：java, selenium, testng, selenium-grid

我被告知通过以下约定使用使用 selenium 的框架：

```
public static SeleniumClient instance() {

if (_instance == null) {

  _instance = new SeleniumClient();

  LogHelper.instance().setInfo("SeleniumClient::instance(): Singleton created.");

}

return _instance;

} 
```

所有的测试都是以类似的方式编写的。例如，如果我正在创建一个新测试，我会编写一个辅助类，这就是它的使用方式：

```
public static PropertyManagerHelper instance() {

if (_instance == null) {

  _instance = new PropertyManagerHelper();

  LogHelper.instance().setInfo("PropertyManagerHelper::instance(): Singleton created.");

}

return _instance;

} 
```

我有一个硒网格，我也打算发送这些测试。在我深入兔子洞之前，我有以下问题：

Selenium 如何将测试发送到网格？它是发送整个类/测试还是将每个操作作为单独的请求发送？

上一个问题可能会回答这个问题，但是这种静态用法会阻止 testng 运行多个并行测试吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T21:51:48.953

It sends each command. Selenium doesn't understand whether its a test case or class. Hub would get the command and distribute across the remote controls.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T18:16:07.993

为什么是单例模式？

在当前状态下它不是线程安全的：

[http://cshapindepth.com/Articles/General/Singleton.aspx](http://csharpindepth.com/Articles/General/Singleton.aspx)

我不建议使用单例模式。

# c# - HttpPost 上的 Razor 更改标签

> ID：12410897
> 
> 赞同：0
> 
> 时间：2012-09-13T16:38:12.303
> 
> 标签：c#, asp.net-mvc-3, razor, http-post

剃须刀新手，我有一个标签和一个按钮

```
<form action="" method="post" enctype="multipart/form-data"> 
<label name="Mylabel">Test + @ViewData["MyLabelUpdate"]</label>
<input type="submit" id="MyBtn"  Value="Change Label"> 
```

现在在控制器中我有：

```
 [HttpPost]
    public ActionResult Index()
    {
        return RedirectToAction("Index");
    } 
```

如何使用 actionresult 方法更改标签？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:11:36.470

你必须让你的控制器看起来像这样：

```
[HttpPost]
public ActionResult Index()
{
    ViewBag.MyLabelUpdate = "whatever";
    return RedirectToAction("Index");
} 
```

而且，您的观点：

```
<form action="" method="post" enctype="multipart/form-data"> 
<label name="Mylabel">Test + @ViewBag.MyLabelUpdate</label>
<input type="submit" id="MyBtn"  Value="Change Label"> 
```

# php - dompdf 对换行符的计算错误

> ID：12410899
> 
> 赞同：0
> 
> 时间：2012-09-13T16:38:15.857
> 
> 标签：php, dompdf

我正在使用 dompdf 0.5.2 并且遇到的问题是，当一行有重音时，下一行的第一个字符被移入其中，例如：

```
This is a first line with áccent. T
his is a second line. 
```

注意第一行末尾的 T，它属于第二行。默认字体和自定义加载字体都会发生这种情况。还尝试了 UTF-8 和 ISO-8859-1 编码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T14:11:57.680

另一个对我有用的解决方案是在你的 text/string 上使用[wordwrap](http://php.net/manual/en/function.wordwrap.php) PHP 函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-28T08:57:58.247

如果有人对 0.7.0-beta 版本有同样的问题，解决方案是将以下行添加到文件 src/Dompdf/FrameReflower/Text.php 的第 272 行（就在之前`if ($split == 0) {`）：

```
$split = mb_strlen(mb_substr($this->_frame->get_text(), 0, $split), 'UTF-8'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T16:38:15.857

取自[此处](http://code.google.com/p/dompdf/issues/detail?can=2&start=0&num=100&q=&colspec=ID%20Type%20Status%20Stars%20Priority%20Milestone%20Owner%20Summary%20Modified&groupby=&sort=&id=146)的有效解决方案是将以下代码行添加到 dompdf 文件的`include/text_frame_reflower.cls.php`第 246 行之后：

```
$split = mb_strlen(mb_substr($this->_frame->get_text(), 0, $split), 'UTF-8'); 
```

# django - 在 Django 中运行 PHP

> ID：12410904
> 
> 赞同：7
> 
> 时间：2012-09-13T16:38:38.107
> 
> 标签：django

有没有办法在 django 中运行 PHP 脚本？我在 TinyMCE 中有一个运行 PHP 脚本的插件，它能够使用 XAMPP 的 Apache 工作。但是，Django 确实支持 PHP 脚本的运行，因此该插件无法工作。我想知道是否有办法配置 Django 来运行 PHP 脚本。

任何帮助或指针表示赞赏。非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T20:01:29.367

Django 不是 HTTP 服务器。您需要像 Apache、Nginx 等 HTTP 服务器以及正确的 php 模块来运行您的 PHP 脚本。

然后，您可以将 Django 配置为在同一台服务器上运行。这是使用 Apache [https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/)运行 Django 的方法。然后，您可以将 PHP 脚本配置为在同一台服务器上运行。

之后，您的 PHP 脚本如何与 Django 项目交互是特定于实现的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T20:13:18.893

好吧，有 Django-php 可以让你在 Django 模板中运行 PHP - [http://animuchan.net/django_php/](http://animuchan.net/django_php/)

尽管我会提请您注意该网站的常见问题解答部分。

# r - 将颜色和形状的图例组合成一个图例

> ID：12410908
> 
> 赞同：92
> 
> 时间：2012-09-13T16:38:51.463
> 
> 标签：r, ggplot2

我正在 ggplot 从 2 x 2 研究设计中创建一个图，并希望使用 2 种颜色和 2 个符号对我的 4 种不同治疗组合进行分类。目前我有 2 个图例，一个用于颜色，一个用于两种形状。如何将它们组合成一个图例，这样我就有一个蓝色圆圈、一个红色圆圈、一个蓝色三角形和一个读取三角形？

一些数据：

```
state1 <- c(rep(c(rep("N", 7), rep("Y", 7)), 2))
year <- rep(c(2003:2009), 4)
group1 <- c(rep("C", 14), rep("E", 14))
group2 <- paste(state1, group1, sep = "")
beta <- c(0.16,0.15,0.08,0.08,0.18,0.48,0.14,0.19,0.00,0.00,0.04,0.08,0.27,0.03,0.11,0.12,0.09,0.09,0.10,0.19,0.16,0.00,0.11,0.07,0.08,0.09,0.19,0.10)
    lcl <- c(0.13,0.12,0.05,0.05,0.12,0.35,0.06,0.13,0.00,0.00,0.01,0.04,0.20,0.00,0.09,0.09,0.06,0.06,0.07,0.15,0.11,0.00,0.07,0.03,0.05,0.06,0.15,0.06)
    ucl <- c(0.20,0.20,0.13,0.14,0.27,0.61,0.28,0.27,0.00,1.00,0.16,0.16,0.36,0.82,0.14,0.15,0.13,0.13,0.15,0.23,0.21,0.00,0.15,0.14,0.12,0.12,0.23,0.16)
data <- data.frame(state1,year,group1,group2,beta,lcl,ucl) 
```

阴谋：

```
library(ggplot2)
pd <- position_dodge(.65)
ggplot(data = data, aes(x = year, y = beta, colour = state1, group = group2, shape = group1)) +
  geom_point(position = pd, size = 4) +
  geom_errorbar(aes(ymin = lcl, ymax = ucl),colour = "black", width = 0.5, position = pd) +
  scale_colour_hue(name = "Treatment & State",  #Legend label, use darker colors
                   labels = c("Control", "Exclosure"),
                   l = 40) +
  scale_shape(name = "State", labels = c("Non-F", "Flwr")) 
```

[![在此处输入图像描述](../Images/0260502351900ac5fc38fa2ce9932b05.png)](https://i.stack.imgur.com/Kitw2.png)

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-09-13T17:23:36.073

您需要对形状和色标使用相同的`name`和`labels`值。

```
pd <- position_dodge(.65)
ggplot(data = data,aes(x= year, y = beta, colour = group2, shape = group2)) +    
  geom_point(position = pd, size = 4) +
  geom_errorbar(aes(ymin = lcl, ymax = ucl), colour = "black", width = 0.5, position = pd) +
  scale_colour_manual(name = "Treatment & State",
                      labels = c("Control, Non-F", "Control, Flwr", "Exclosure, Non-F", "Exclosure, Flwr"),
                      values = c("blue", "red", "blue", "red")) +   
  scale_shape_manual(name = "Treatment & State",
                     labels = c("Control, Non-F", "Control, Flwr", "Exclosure, Non-F", "Exclosure, Flwr"),
                     values = c(19, 19, 17, 17)) 
```

![在此处输入图像描述](../Images/e1dd899ba2ee2458ffe0ce45ecca50ab.png)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-13T17:23:21.773

红色圆圈，蓝色圆圈，红色三角形，蓝色三角形，如您所问：

```
ggplot(data =data,aes(x= year, y = beta, shape=group2, colour=group2,group = group2)) +
geom_errorbar(aes(ymin = lcl, ymax = ucl),colour = "black", width = 0.5, position = pd) + 
geom_point(position = pd, size = 4) +  
scale_colour_manual(values=c("red","blue","red","blue")) +   
scale_shape_manual(values=c(19,19,17,17)) +
scale_fill_hue(name="Treatment & State",  #Legend label, use darker colors
labels=c("Control", "Exclosure"),l=40) 
```

![在此处输入图像描述](../Images/10710653094a7a881b54f89a9b8243c3.png)

# android - 如何将颜色转换为十六进制？

> ID：12410909
> 
> 赞同：2
> 
> 时间：2012-09-13T16:38:58.967
> 
> 标签：android

> **可能重复：**
> [如何在 Android 中将颜色整数转换为十六进制字符串？](https://stackoverflow.com/questions/6539879/how-to-convert-a-color-integer-to-a-hex-string-in-android)

```
int c = bitmap.getPixel(x, y); 
```

返回一个 7 或 8 位数字`-14438067`，例如绿色。

如何将其转换为十六进制或有意义的东西？我试过 parseColor 但我得到一个例外“不是颜色......”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:44:27.480

您可以使用 Color 类中的静态方法。（在这里找到：http: [//developer.android.com/reference/android/graphics/Color.html](http://developer.android.com/reference/android/graphics/Color.html)）

您可以分别提取红色、蓝色、绿色和 alpha 的各个分量。（分别使用 Color.red(int color)、Color.blue(int color)、Color.green(int color) 和 Color.alpha(int Color) 方法）

对单个组件值使用 Integer.toString(color, 16) 将获得该组件的十六进制字符串表示。

# android - 来自网站的 inoutstream 不显示任何内容

> ID：12410913
> 
> 赞同：0
> 
> 时间：2012-09-13T16:39:13.390
> 
> 标签：android, inputstream, httpurlconnection, bufferedreader

我使用以下代码从使用 textview 的网站逐行读取。但问题是 textview 什么也不显示。

我想知道我的错误在哪里，或者如何更正我的代码以从网站读取数据。

注意：我使用模拟器。

JAVA代码：

```
try {
          URL url = new URL("http://www.google.com");
          HttpsURLConnection con = (HttpsURLConnection) url.openConnection();
          con.setDoOutput(true);
          con.connect();
          //readStream(con.getInputStream());
          reader = new BufferedReader(new InputStreamReader (con.getInputStream()));
          String line="";
        while ( (line=reader.readLine()) != null)
            tv00.setText(line);
        } catch (Exception e) {
          e.printStackTrace();
    }

} 
```

# netbeans - 制作文件夹netbeans项目和ftp上传

> ID：12410915
> 
> 赞同：0
> 
> 时间：2012-09-13T16:39:24.640
> 
> 标签：netbeans, ide

我刚刚下载了 netBeans 7.2 和一个[ftp 插件](http://plugins.netbeans.org/plugin/39197/ftpsitedeployer)。我希望能够在我的计算机（我在 Eclipse 中创建）上创建一个文件夹（html、css、javascript、php）作为 NetBeans 的“项目”（至少这是我认为我想要做的）。然后，保存后，在线上传到远程目录。有没有办法做到这一点？

谢谢！托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T21:57:28.263

转到运行-设置项目配置-自定义单击远程连接旁边的管理。

我想你可以弄清楚其余的..

# python - Python shutil.copytree 函数不起作用

> ID：12410918
> 
> 赞同：0
> 
> 时间：2012-09-13T16:39:38.590
> 
> 标签：python, copy, shutil, copytree

我觉得我要么缺少一些基本的东西，要么正在发生一些不稳定的事情。我已阅读文档并了解 copytree 必须同时指定源路径和目标路径。我在目的地部分苦苦挣扎。我的代码如下...

```
from shutil import copytree

copytree("C:\Users\D34DLYHAX\Pictures", "C:\Users\D34DLYHAX\Pictures\Temp\\") 
```

复制树没有任何麻烦；但是，没有创建文件夹“Temp”，并且没有将复制的树放在其中。相反，复制的树被放置在“C:\Users\D34DLYHAX\Pictures\My Pictures”中。为什么会这样？除非我没有正确阅读文档，否则不应该将复制的树插入到 Temp 中以 Temp 作为源文件夹吗？

感谢您的帮助和回答。

——好吧，现在它变得更加陌生了。当我去查看复制的文件夹时，它被命名为“我的图片”，那里没有问题。但是，如果我将复制的树放入回收站并查看回收站的内容，则复制的树现在被命名为“Temp”。到底是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:47:37.407

快速解决方案是使用正斜杠。我怀疑你没有正确地逃避事情。

```
from shutil import copytree
copytree("C:/Users/D34DLYHAX/Pictures", "C:/Users/D34DLYHAX/Pictures/Temp") 
```

或者去掉尾随`//`

```
from shutil import copytree
copytree("C:\Users\D34DLYHAX\Pictures", "C:\Users\D34DLYHAX\Pictures\Temp") 
```

**另一件可能给您带来灾难的事情是在其内部复制一个文件夹。不要那样做，想想怎么会出错。将其复制到外部。**

记住如果你想复制符号链接`symlinks=True`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T21:17:08.813

不太清楚问题是什么，但这似乎工作得很好......

```
from datetime import date
from shutil import copytree

currentDate = str(date.today())
currentDate = currentDate.replace("-", ".")
DESTINATION = "C:\\Users\\D34DLYHAX\\Desktop\\Backup " + currentDate

copytree("C:\\Users\\D34DLYHAX\\Pictures\\", DESTINATION + "\\My Pictures") 
```

# visual-c++ - 嗯，列表 () 在 C++/CX 中？任何类型的列表、集合——甚至是 ObvervableCollection？

> ID：12410919
> 
> 赞同：-1
> 
> 时间：2012-09-13T16:39:42.787
> 
> 标签：visual-c++, windows-runtime, c++-cx

我正在尝试将（在 XAML 中）绑定到 C++/CX 中的列表，但我似乎没有任何列表。他们都去哪儿了？任何类型的列表都可以……甚至是字典、堆栈或……什么的！或者自从我上次使用C++ 以来，它发生*了很大的变化？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T16:43:19.547

命名空间中有 Windows 集合接口的 C++/CX 实现[`Platform::Collections`](http://msdn.microsoft.com/en-us/library/windows/apps/hh710418.aspx)，定义在`<collection.h>`.

另请参阅MSDN 上有关[C++/CX 中的集合的文章。](http://msdn.microsoft.com/en-us/library/windows/apps/hh700103.aspx)

# wordpress - Wordpress 中的永久链接 - 找不到页面

> ID：12410921
> 
> 赞同：5
> 
> 时间：2012-09-13T16:39:50.747
> 
> 标签：wordpress, .htaccess, permalinks, file-not-found

我一直在寻找几个小时，但没有找到任何似乎能够解决这个问题的东西。

这是场景：

我正在制作一个基于“二十一”主题的 wp 主题。一切都很顺利，直到我决定将网址更改为永久链接。唯一显示的页面是我之前定义的静态页面。

我已经设置了 htacces 文件。事实上，WP 是自动完成的。如果我切换回默认设置，一切正常，但是，对于 SEO，我宁愿使用永久链接选项。

这是我的 htaccess 文件（它在我的 WP 安装文件夹中）：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /mysite/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /mysite/index.php [L]
</IfModule>

# END WordPress 
```

我已经看过这个[带有永久链接的 wordpress .htaccess](https://stackoverflow.com/questions/2157279/wordpress-htaccess-with-permalinks)帖子，但没有什么可以帮助我。任何帮助都会非常好。

**更新：**我已经尝试过的事情：

*   删除页面并重新创建。
*   访问 wp_options (db) 上的永久链接字段并将值设置为空白并再次在管理员中设置永久链接选项。
*   我通过 Zend Server 的 apache2 安装在 Windows 7 上运行它。
*   我认为这是与我的localhost环境有关的问题，所以我将网站放在网上。一点运气都没有。我假设当您设置静态首页时，wordpress 无法将永久链接更改为更友好的 url 类型。真可惜。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-03T23:27:09.317

对于那些使用 apache 的人。您将需要

1.  确保您托管的站点的根路径中有 .htaccess。示例 /var/www
2.  更新 /etc/apache2/sites-available/default

**从**

```
<Directory /var/www/>
            Options Indexes FollowSymLinks MultiViews
            AllowOverride None
            Order allow,deny
            allow from all
    </Directory> 
```

**到**

```
<Directory /var/www/>
            Options Indexes FollowSymLinks MultiViews
            AllowOverride All
            Order allow,deny
            allow from all
    </Directory> 
```

希望这可以帮助某人

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-04-16T08:29:06.437

如果编辑 apache2 的默认配置和 Wordpress 的`.htaccess`文件没有帮助，原因可能只是 apache2 的`rewrite`模块未启用。对于那些自己安装 apache2 的人来说，通常就是这种情况。Wordpress 需要启用 apache2 的`rewrite`模块以支持永久链接编辑。如果像我一样，您不想手动编辑 conf 文件，`rewrite`可以通过以 root 身份运行这些命令来启用 apache2 的模块（我使用的是 Ubuntu 18.04，因此这些命令在不基于 Ubuntu 的发行版中可能会有所不同或 Debian）：

```
 a2enmod rewrite 
```

并通过运行重新启动 apache2 服务：

```
 systemctl restart apache2 
```

或者

```
 service apache2 restart 
```

如果您运行的是 Ubuntu 18.04，您可以查看下所有可用的 apache2 模块，`/etc/apache2/mods-available`并通过列出`/etc/apache2/mods-enabled`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-09T23:53:35.497

不知道大家有没有找到解决办法，不过我通过在httpd.conf文件中简单地开启LoadModule rewrite_module modules/mod_rewrite.so解决了这个问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-07-26T00:04:26.727

另请参阅[WordPress 上的永久链接 (Amazon EC2)](http://guiem.info/permalinks-on-wordpress-amazon-ec2/#comment-777)

我有同样的问题，但上面链接中的作者建议做三件事（它对我有用！）：

转到`/etc/httpd/conf`并编辑`httpd.conf`

```
<Directory />
    Options FollowSymLinks
    AllowOverride All
</Directory> 
```

如果将 AllowOverride 设置为 None，也要更改

```
# AllowOverride controls what directives may be placed in .htaccess files.
# It can be "All", "None", or any combination of the keywords:
#   Options FileInfo AuthConfig Limit
#
    AllowOverride All 
```

我你还没有创建它，在你的 wordpress 安装的根目录中放置一个 .htaccess 文件，其中包含以下内容：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-12T05:28:08.877

httpd.conf 文件中有两个“目录”部分。一个用于根文件夹，另一个用于 htdocs 文件夹。您必须编辑这两个字段才能使 WordPress 页面再次工作。希望能帮助到你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-29T04:46:19.700

这对我有用，就像@Skillachie 写的一样，但如果您使用 SSL，请务必在 000-default-SSL.conf 文件中包含这些设置！

```
<Directory /var/www/PATH>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Order allow,deny
        allow from all
</Directory> 
```

# ruby - 将鞋子 GUI 连接到现有的 Ruby 代码

> ID：12410925
> 
> 赞同：1
> 
> 时间：2012-09-13T16:40:03.833
> 
> 标签：ruby, user-interface, shoes

我用 Ruby 构建了一个命令行游戏，现在我正在尝试使用 Shoes 为游戏构建一个 GUI。我花了一上午的时间阅读有关鞋子的文章，查看一些代码示例，并自己编写了一些代码。*看起来*（我是 Shoes 新手，所以这可能是完全错误的）Shoes 代码（例如，您使用 Shoes 应用程序打开的文件`shoes.rb`）必须包含您要运行的所有 Ruby 代码。所有 Ruby 代码都将存在于该文件中。

我启动这个游戏的方式是在命令行通过将命令行参数传递给`play.rb`（Ruby 脚本）。运行`play.rb "command line game"`或`play.rb "shoes game"`在命令行。如果您运行后者，它将进行系统调用以`shoes.rb`使用 Shoes 应用程序打开。它将`play.rb`传递`ShoesInterface`给玩家，而不是`CommandLineInterface`. 以下是如何要求玩家移动的示例：

在`human_player.rb`文件中：

```
def make_move
    @interface.print("It's your turn to make a move.")
end 
```

`@interface`将是`CommandLineInterface`或`ShoesInterface`。`print`in`CommandLineInterface`方法只是一个 puts 语句。中的`print`方法`ShoesInterface`应该告诉鞋子 GUI 显示该文本。我正在尝试尽可能多地重用我的代码。从理论上讲，无论某人*如何*玩游戏（在网络上、在命令行上、通过 GUI 等），它都应该使用大部分相同的逻辑。界面仅显示消息并接收用户输入。他们只是以不同的方式做到这一点。

问题是我不知道如何将我的鞋子 GUI 连接到我现有的 Ruby 代码。这里有人精通鞋子吗？这在鞋子中可能是不可能的......也许我必须使用不同的 Ruby GUI，但我想在转向另一个之前我会问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T13:24:15.313

您可以做的是编写一个将响应方法打印的鞋子小部件。下面是这样一个小部件的一个非常粗略的示例，它将从编辑行附加一条消息到它的任意显示槽。当然，您可以轻松地修改小部件，以便您可以使用目标插槽对其进行初始化以进行显示等，但想法保持不变。

```
class Prompt < Shoes::Widget
 def initialize opts={}
  @top=opts[:top]
  @left=opts[:left]
  @width=opts[:width]
  @prom=flow :top=>@top, :left=>@left, :width=>@width do
   background red
  end
  end
 def print(msg)
  @prom.append do
   para msg
  end
 end
end
Shoes.app :title => "Test" do 
 @el=edit_line
 button "print"do
  @interface.print(@el.text)
 end
 @interface=prompt({:top=>50, :left=>20, :width=>100})
end 
```

我希望那是你想要的。

# c - 不同语言共有的浮点错误？

> ID：12410930
> 
> 赞同：3
> 
> 时间：2012-09-13T16:40:27.797
> 
> 标签：c, floating-point

```
 #include<stdio.h>
    void main()
    {
          float i,j;
          i=??;
          j=i+1;
          if(i==j)
               printf("Bug");
    } 
```

我的老师给了我这个 qns 来找到 i 的值，以便 printf 执行。他说这是许多语言中的常见错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:50:52.100

总是尝试奇怪行为的界限。这对我有用：

```
#include <float.h>

int _tmain(int argc, _TCHAR* argv[])
{
    float i,j;

    i = FLT_MAX;
    j = i + 1;

    if(i == j)
    {
        printf("they're the same");
    }

    return 0;
} 
```

# clone - 在 activemq 队列上克隆消息以进行重播的最简单方法是什么？

> ID：12410935
> 
> 赞同：0
> 
> 时间：2012-09-13T16:40:37.070
> 
> 标签：clone, activemq

理想情况下，我们可以应用将到达一个队列的所有消息复制到第二个队列以供以后重播的配置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T11:45:04.193

您可以使用[骆驼 xml 配置](http://activemq.apache.org/enterprise-integration-patterns.html)并应用[窃听模式](http://camel.apache.org/wire-tap.html)

您可以使用此模式在存储库（比如文件存储库）中记录、克隆甚至发送消息

在您的 activeMQ 的 /conf/ 目录中应该已经有一个 Apache camel XML 配置的演示

干杯!

# c++ - Qt - 在 QGraphicsScene 中仅编辑 QGraphicsLineItems

> ID：12410937
> 
> 赞同：1
> 
> 时间：2012-09-13T16:40:41.730
> 
> 标签：c++, qt

我正在使用 Qt 绘制一些数据可视化。我有线条表示时间轴上的某些重要点，但我希望能够从视图中删除这些线条，以便更清楚地看到下面的信息。

我了解如何将它们从视线中移除，但问题是如何`QGraphicsItems`在场景视图中找到哪些是线条，哪些不是。

我试过使用

```
try {
    qgraphicsitem_cast<QGraphicsLineItem>(scene->items()[i]);
} catch (...) {
} 
```

但这甚至无法编译。我尝试检查`qgraphicsitem_cast()`if is 的输出`0`，但编译器也不喜欢这样。

这是我最新的代码：

```
void Plotter::showHideLines() {
    int i;
    QGraphicsLineItem l;

    for (i = 0; i < scene->items().count(); i++) {
        try {
            qgraphicsitem_cast<QGraphicsLineItem>(scene->items()[i]);
            scene->items()[i]->setVisible(!scene->items()[i]->isVisible());
        } catch (...) {
        }
    }
} 
```

忽略`l`，尝试其他方法后我懒得删除它。

我对 Qt 很陌生，最近几天我才开始学习它。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:54:16.610

我不建议遍历每个场景项目，只是为了隐藏某种类型，因为当项目数量变大时事情会变慢。

相反，每当创建一行时，将其添加到列表中。当需要隐藏它们时，遍历列表并隐藏它们。它需要更多的内存，但更快、更安全，并且需要更少的编码。

# c++ - 在 C 中声明结构的新实例

> ID：12410941
> 
> 赞同：0
> 
> 时间：2012-09-13T16:40:54.510
> 
> 标签：c++, c, pointers, structure, instance

```
struct xampl {
       int x;
       char y;
};

struct xampl InstaceOfxampl;
struct xampl *PointerToxampl;
struct xampl &new_struct; 
```

我们在第一种情况下创建一个简单的实例，在第二种情况下创建一个指向结构 xampl 的指针。但是，第三个声明是什么意思？与代码中的其他两个相比，它的处理方式有何不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T16:42:37.657

在 C++ 中，`struct xampl &new_struct`声明一个引用（但是，它是无效的，因为必须初始化一个引用）。在 C 中，它在这里没有任何意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T17:21:21.820

您可以访问结构的成员：

*   第一个（结构变量）使用`.`
*   第二个（结构指针）使用`->`

您可以将第一个的地址存储在第二个中，例如：

```
PointerToxampl=&InstaceOfxampl; 
```

正如其他人所说的那样，第三个是无效的。如果你想引用一个参考。它应该按如下方式完成：

```
struct xampl &new_struct=InstaceOfxampl; 
```

# c# - 400 错误请求异常：具有小数据的简单 SOAP WCF 服务

> ID：12410947
> 
> 赞同：1
> 
> 时间：2012-09-13T16:41:28.940
> 
> 标签：c#, wcf

我有一个简单的 WCF 服务起诉**SOAP**。我有一个非常简单的操作“GetMultiplied”，数据量非常小。当客户端尝试调用操作时，我收到以下异常。知道可能是什么问题吗？

> 内部异常：{“远程服务器返回错误：（400）错误请求。”}

最后列出了完整的 wsdl 和模式。

注意：我在服务和客户端配置中都将配额值、maxBufferSize 等设置为更高的值。

**跟踪服务**

当我在服务中使用跟踪时（基于[如何打开 WCF 跟踪？](https://stackoverflow.com/questions/4271517/how-to-turn-on-wcf-tracing)），我得到以下信息 - 似乎没有记录错误。

```
<Type>3</Type>
<SubType Name="Information">0</SubType>
<Level>8</Level>
<TimeCreated SystemTime="2012-09-13T17:05:17.6059181Z" />
<Source Name="System.ServiceModel" />
<Description>AppDomain unloading.</Description> 
```

**服务实施**

```
public class CalculationService : ICalculationService
{

    public virtual GetMultipliedResponse GetMultiplied(GetMultipliedRequest request)
    {
        MultipliedResult result = new MultipliedResult();
        result.ResultNumber= ((request.InputNumber)*2);

        GetMultipliedResponse response = new GetMultipliedResponse(result);
        return response;
    }
} 
```

**客户**

```
 static void Main(string[] args)
    {
        CalculationServiceInterfaceClient proxy = new CalculationServiceInterfaceClient();
        multipliedResult result = proxy.getMultiplied(2);
    } 
```

在自动生成的代码中，详细信息是：

```
 public NewClient.CalcReference.multipliedResult getMultiplied(int inputNumber) 
    {
        NewClient.CalcReference.getMultipliedRequest inValue = new NewClient.CalcReference.getMultipliedRequest();
        inValue.inputNumber = inputNumber;

        NewClient.CalcReference.getMultipliedResponse retVal = ((NewClient.CalcReference.CalculationServiceInterface)(this)).getMultiplied(inValue);
        return retVal.restaurants;
    } 
```

**WSDL**

```
<definitions xmlns:import0="urn:lijo:demos:multiplyservice:messages:v1" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:import1="urn:lijo:demos:multiplyservice:data:v1" xmlns:tns="urn:lijo:demos:multiplyservice:calculation:v1" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" name="CalculationService" targetNamespace="urn:lijo:demos:multiplyservice:calculation:v1" xmlns="http://schemas.xmlsoap.org/wsdl/">
<wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" />
<types>
<xsd:schema>
  <xsd:import schemaLocation="C:\toolbox\LijosServiceApp\NewService\RestaurantMessages.xsd" namespace="urn:lijo:demos:multiplyservice:messages:v1" />
  <xsd:import schemaLocation="C:\toolbox\LijosServiceApp\NewService\RestaurantData.xsd" namespace="urn:lijo:demos:multiplyservice:data:v1" />
  </xsd:schema>
 </types>
 <message name="getMultipliedIn">
 <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" />
 <part name="parameters" element="import0:getMultiplied" />
 </message>
 <message name="getMultipliedOut">
 <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" />
 <part name="parameters" element="import0:getMultipliedResponse" />
 </message>
 <portType name="CalculationServiceInterface">
  <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" />
  <operation name="getMultiplied">
  <wsdl:documentation xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" />
  <input message="tns:getMultipliedIn" />
  <output message="tns:getMultipliedOut" />
  </operation>
  </portType>
  <binding name="BasicHttpBinding_CalculationServiceInterface" type="tns:CalculationServiceInterface">
  <soap:binding transport="http://schemas.xmlsoap.org/soap/http" />
  <operation name="getMultiplied">
  <soap:operation soapAction="urn:lijo:demos:multiplyservice:calculation:v1:getMultipliedIn" style="document" />
  <input>
    <soap:body use="literal" />
  </input>
  <output>
    <soap:body use="literal" />
  </output>
  </operation>
  </binding>
  <service name="CalculationServicePort">
  <port name="CalculationServicePort" binding="tns:BasicHttpBinding_CalculationServiceInterface">
  <soap:address location="http://localhost/CalculationService" />
  </port>
  </service>
  </definitions> 
```

**XSD**

```
<?xml version="1.0" encoding="utf-8" ?>
<xs:schema id="RestaurantData" targetNamespace="urn:lijo:demos:multiplyservice:data:v1"
elementFormDefault="qualified" xmlns="urn:lijo:demos:multiplyservice:data:v1"
xmlns:mstns="urn:lijo:demos:multiplyservice:data:v1" xmlns:xs="http://www.w3.org/2001/XMLSchema">

 <xs:complexType name="multipliedResult">
 <xs:sequence>
  <xs:element name="resultNumber" type="xs:int" />
 </xs:sequence>
 </xs:complexType>
 </xs:schema> 
```

**客户端配置**（自动生成）

```
<system.serviceModel>
    <bindings>
        <basicHttpBinding>
            <binding name="BasicHttpBinding_CalculationServiceInterface"
                closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00"
                sendTimeout="00:01:00" allowCookies="false" bypassProxyOnLocal="false"
                hostNameComparisonMode="StrongWildcard" maxBufferSize="65536"
                maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
                messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
                useDefaultWebProxy="true">
                <readerQuotas maxDepth="524288" maxStringContentLength="524288" maxArrayLength="524288"
                    maxBytesPerRead="524288" maxNameTableCharCount="524288" />
                <security mode="None">
                    <transport clientCredentialType="None" proxyCredentialType="None"
                        realm="" />
                    <message clientCredentialType="UserName" algorithmSuite="Default" />
                </security>
            </binding>
        </basicHttpBinding>
    </bindings>
    <client>
        <endpoint address="http://localhost/CalculationService" binding="basicHttpBinding"
            bindingConfiguration="BasicHttpBinding_CalculationServiceInterface"
            contract="CalcReference.CalculationServiceInterface" name="CalculationServicePort" />
    </client>
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T04:42:54.090

我解决了这个问题:-)

为了他人的利益，我将发布答案。

1.  关键问题：我试图使用手动创建的 wsdl。（我引用了服务中可用的本地副本 - 我正在使用一个工具从 wsdl 生成服务代码）。该服务没有提供它。我应该尝试通过浏览 svc 文件来查看 wsdl

2.  使用**WcfTestClient 运行**服务。给出了一个错误，表明**我们使用的项目名称和命名空间应该相同**。（否则它将在命名空间名称之前附加项目名称，这将成为不正确的命名空间）

    在“Visual Studio 命令提示符”中键入“WcfTestClient”命令。[http://blogs.msdn.com/b/wcftoolsteamblog/archive/2010/01/04/tips-for-launching-wcf-test-client.aspx](http://blogs.msdn.com/b/wcftoolsteamblog/archive/2010/01/04/tips-for-launching-wcf-test-client.aspx)

3.  通过**浏览服务中的svc文件**，发现**元数据发布**没有开启。在 web.config 中添加了元数据浏览的服务行为。

4.  使用服务的相对路径（而不是本地主机）[错误“没有协议绑定与给定地址匹配......”](https://stackoverflow.com/questions/4261180/error-no-protocol-binding-matches-the-given-address)

5.  服务跟踪也很有帮助（虽然在这里没有帮助我）。使用“C:\Program Files\Microsoft SDKs\Windows\v7.0A\bin\SvcTraceViewer.exe”。跟随帖子，错误文件 (initializeData="Error.svclog") 存储在解决方案项目中。将其更改为其他位置不起作用。[如何打开 WCF 跟踪？](https://stackoverflow.com/questions/4271517/how-to-turn-on-wcf-tracing)

6.  参考[一个 WCF 服务 - 两个客户端；一个客户端不工作](https://stackoverflow.com/questions/12420314/one-wcf-service-two-clients-one-client-does-not-work/12425653#12425653)

# wordpress - 使用子域创建另一个网站

> ID：12410950
> 
> 赞同：0
> 
> 时间：2012-09-13T16:41:36.533
> 
> 标签：wordpress, subdomain, cpanel, cgi-bin

我想创建一个在我的服务器上运行的测试网站。我使用 CPanel 创建了子域。创建后，该文件夹为空，没有 cgi-bin 文件夹（这是正确的行为）？我将 WP 上传到该文件夹​​，创建数据库，更改 wp-config.php 文件。

我试图将 cgi-bin 文件夹复制到该子域文件夹，但我不断收到此错误：

```
Not Found

The requested URL /cgi-bin/php5.fcgi/landscape/index.php was not found on this server.

Additionally, a 404 Not Found error was encountered while trying to use an ErrorDocument to handle the request. 
```

有人知道我做错了什么吗？谢谢！

# performance - Tomcat 7中的Web应用程序非常慢

> ID：12410951
> 
> 赞同：11
> 
> 时间：2012-09-13T16:41:38.797
> 
> 标签：performance, tomcat, web-applications

我实现了一个 Web 应用程序来快速启动 Tomcat 服务，但是花费数小时并且当更多用户进入时变得越来越慢（最多 15 个用户）。

检查 RAM 使用统计 (20%)、CPU (25%)

服务器特点：

*   内存 8GB
*   处理器 i7
*   Windows 服务器 2008 64 位
*   雄猫 7
*   mysql 5.0
*   Struts2
*   -Xms1024m
*   -Xmx1024m
*   永久代 = 1024
*   MaxPernGen = 1024

我不使用Web服务器，我们直接在Tomcat上发布。

进入半夜仍保持缓慢（仅1个用户在线）

我的解决方案是重新启动 Tomcat 服务，响应时间再次非常好。

有没有人经历过这个问题？任何线索将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-02-29T01:13:35.133

没有提供足够的细节。需要更多信息:(

**使用`htop`或`top`查找每个进程和每个线程的内存和 CPU 使用情况。**

## 中央处理器

在 4 核系统中恒定 25% 的 CPU 使用率表明单核应用程序/线程在它能够使用的唯一核上运行 100% CPU。

哪个应用程序正在吃 CPU？

## 记忆

20% 的内存约为 1.6GB。对于仅运行 tomcat + mysql 的空闲服务器，这比我预期的要多一点。告诉 tomcat预`-Xms1024`分配 1GB 内存以便解释它。

将 tomcat 设置更改为`-Xms512`和`-Xmx2048`。当你把一些用户扔给它时，观察 tomcat 的内存使用情况。如果它继续增长直到达到 2GB……然后冻结，这可能表明内存泄漏。

## 磁盘

用于`df -h`检查磁盘使用情况。完整的分区可能会导致您遇到的问题。

```
Filesystem    Size  Used Avail Usage% Mounted on
/cygdrive/c     149G  149G  414M 100%   / 
```

（如果您刚刚在此示例中发现我的笔记本电脑空间不足。您做得对：D）

## 日志

日志很棒。然而，他们有一个坏习惯来填满磁盘。检查日志磁盘使用情况。新用户连接时是否正确写入/擦除/旋转日志？删除日志可以解决问题吗？（在删除它们之前将它们复制到某处以供将来分析）

如果不。日志仍然很棒。他们有帮助您跟踪错误的好习惯。检查tomcat日志。您可能希望将日志记录级别设置为调试。网站死后最后会发生什么？任何有用的错误信息？用户连接是否仍被 tomcat 接收和接受？

## 应用

我想 25% 的 CPU 用于 tomcat（而不是 mysql）。Tomcat 本身不会失败。在其上运行的应用程序必须失败。尝试从 tomcat 中删除应用程序（您最终可以使用 hello world 代替）。没有您的应用程序，tomcat 可以保持通宵工作吗？它可能可以，在这种情况下，故障出在应用程序上。

在您的应用程序中启用完整的调试日志记录并尝试跟踪问题。在调试模式下直接从 Eclipse 运行它，然后将用户扔给它。它是否以同样的方式持续失败？

如果是，请在 Eclipse 调试器中点击“暂停”并检查应用程序正在做什么。查看每个线程当前正在运行的代码段 + 它的调用堆栈。重复几次。如果出现死锁、无限循环或类似情况，您可以通过这种方式找到它。

如果你幸运的话，你现在已经发现了这个问题。如果不是，那么你很不幸，这是一个可能在应用程序内部很深的棘手错误。这可能很难追踪。决心将导致成功。祝你好运=)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-06-28T14:19:40.587

我在干净的 Centos7 安装上遇到了一个非常慢的 Tomcat 仪表板，发现了以下原因和解决方案：

> Tomcat 的缓慢启动时间通常与 Java 的 SecureRandom 实现有关。默认情况下，它使用 /dev/random 作为熵源。这可能会很慢，因为它使用系统事件来收集熵（例如磁盘读取、按键等）。正如 urandom 联机帮助页所述：
> 
> ```
> When the entropy pool is empty, reads from /dev/random will block until additional environmental noise is gathered. 
> ```

来源：[https ://www.digitalocean.com/community/questions/tomcat-8-5-9-restart-is-really-slow-on-my-centos-7-2-droplet](https://www.digitalocean.com/community/questions/tomcat-8-5-9-restart-is-really-slow-on-my-centos-7-2-droplet)

通过将以下配置选项添加到您的 tomcat.conf 或（首选）自定义文件来修复它`/tomcat/conf/conf.d/`：

```
JAVA_OPTS="-Djava.security.egd=file:/dev/./urandom" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-03T18:42:51.070

对于**与性能相关的问题**，我们需要遵循给定的规则：

1.  您可以均衡和强调 xms 和 xmx 的大小以提高效果。

> ```
>  -Xms2048m
>   -Xmx2048m 
> ```

2.  您还可以启用 PermGen 进行垃圾收集。

> -XX:+UseConcMarkSweepGC -XX:+CMSPermGenSweepingEnabled -XX:+CMSClassUnloadingEnabled

3.  如果页面更改过于频繁而无法使此选项合乎逻辑，请尝试临时缓存动态内容，这样就不需要一遍又一遍地重新生成。应该使用任何可以用来缓存已经完成的工作而不是再次执行的技术——这是实现最佳 Tomcat 性能的关键。

4.  如果有任何与数据库相关的问题，那么可以按照[sql 查询性能调整](https://stackoverflow.com/questions/35438400/improve-postgresql-query-performance-having-left-join-for-100-millions-of-data/35456041#35456041)

5.  旋转**Catalina.out**日志文件，`without restarting Tomcat`.

具体来说，有两种方式。

**第一个**，更直接的是，您可以通过在 Catalina 的启动 shell 脚本中添加一个简单的管道到您选择的日志轮换工具来轮换 Catalina.out。这看起来像：

```
"$CATALINA_BASE"/logs/catalina.out WeaponOfChoice 2>&1 & 
```

只需`"WeaponOfChoice"`用您最喜欢的日志轮换工具替换即可。

**第二种方法**不太直接，但最终更好。处理 Catalina.out 旋转的最佳方法是确保它永远不需要旋转。只需将 .swallowOutput 中的所有上下文设置为 true 即可`"server.xml"`。

这将路由`System.err`到`System.out`您已配置的任何日志记录实现，或者`JULI`，如果您尚未配置。

*   查看更多信息：[Tomcat Catalina Out](https://www.mulesoft.com/tcat/tomcat-catalina)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-20T11:04:54.440

我们遇到了类似的问题，原因是“catalina.out”。它是“System.out”和“System.err”的标准目标日志文件。它的大小不断增加，从而减慢速度，最终 tomcat 崩溃了。通过旋转“catalina.out”解决了这个问题。我们使用的是redhat，所以我们制作了一个shell脚本来旋转“catalina.out”。

以下是一些链接：-

关于 catalina 的 Mulesoft 文章（也包含两种旋转方法）：

[Tomcat Catalina 简介](https://www.mulesoft.com/tcat/tomcat-catalina)

如果“catalina.out”不是问题，那么试试这个： -

Mulesoft 关于优化 Tomcat 的文章： [Tuning Tomcat Performance For Optimum Speed](https://www.mulesoft.com/tcat/tomcat-performance)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-13T14:18:40.113

我们遇到了一个问题，看起来与您的问题相似。Tomcat 响应缓慢，但访问日志仅显示几毫秒的响应。问题是流响应。我们的一项服务返回了用户可以订阅的实时数据。EPOLL 变得臃肿。网络请求无法到达 Tomcat。更有趣的是，CPU 大部分时间都是空闲的（因为没有人可以要求服务器做任何事情）并且接受器/轮询器线程位于`WAIT`，而不是`RUNNING`or `IN_NATIVE`。

当时我们只是限制了此类请求的数量，一切都变得正常了。

# c# - 您如何获得用户身份？

> ID：12410953
> 
> 赞同：0
> 
> 时间：2012-09-13T16:41:39.927
> 
> 标签：c#, asp.net

一旦用户通过身份验证和授权，应用程序就可以通过使用 User 对象的 Identity 属性来获取有关用户的信息。Identity 属性返回一个包含用户名和角色信息的对象。

下面是我用来理解这个概念的代码片段：-

```
private void Page_Load(object sender, System.EventArgs e)
{
 Label1.Text = User.Identity.IsAuthenticated.ToString();
 Label2.Text = User.Identity.Name;
 Label3.Text = User.Identity.AuthenticationType;
} 
```

有没有其他方法可以获取用户身份？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T17:03:56.150

请澄清您是否想要以下内容..

如果您只想在调用 Page_Load 时从 ASP.NET WebPage 中获取用户身份，请创建一个 string[] 并执行以下操作

```
string strRawUser = Page.User.Identity.Name; 
```

然后从那里 strRawUser 将有类似 "DomainName\UserName" 所以你需要将字符串拆分为 stringArray 并像这样获取字符串 [1] 值

```
string[] strRawUserSplitter = Page.User.Identity.Name.Split("\\");
Label2.Text = strRawUserSplitter[1] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:51:50.317

您还可以使用 Principal Object 获取当前用户身份。

# windows - 如何将批处理输出写入文本光标？

> ID：12410957
> 
> 赞同：6
> 
> 时间：2012-09-13T16:42:00.800
> 
> 标签：windows, cmd, keyboard-shortcuts, command-prompt

在 Windows 7 中，最终我想绑定一个快捷键 ( `Ctrl`++ `Alt`)`D`来吐出表单的日期时间戳`20120913 1232`。

我要挂断的步骤是让批处理文件向我的文本光标写入任何内容。目前我正在将它传送到[clip.exe](http://www.labnol.org/software/tutorials/copy-dos-command-line-output-clipboard-clip-exe/2506/ "剪辑.exe")，然后我粘贴，但我想消除剪贴板的中间步骤。如果这是不可能的，还有其他方法可以解决我的问题吗？

```
echo %date:~-4%%date:~4,2%%date:~7,2% %time:~0,2%%time:~3,2% | clip 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-04-20T14:54:15.213

您无法从 cmd 执行此操作。您需要使用 VBS、Js 或 PowerShell。这是一个简单的 VBS 脚本，可以满足您的需求。只需在运行此 VBS 文件的桌面上创建一个快捷方式并为其分配一个快捷键

```
Set WshShell = WScript.CreateObject("WScript.Shell")
' Switch back to the previous window. Use Alt+Esc because Alt+Tab sometimes doesn't work
' WshShell.SendKeys "%{TAB}", True
WshShell.SendKeys "%{ESC}", True

' Get the time string
Dim dt, datetime_str
dt =  now
datetime_str = Year(dt) & Right("0" & Month(dt), 2) & Right("0" & Day(dt), 2)
datetime_str = datetime_str & " " & Right("0" & Hour(dt), 2) & Right("0" & Minute(dt), 2)

' Send the date string to the target window
WshShell.SendKeys datetime_str 
```

然而， [Autohotkey](https://www.autohotkey.com/) (AHK) 将是一个更好的解决方案并且运行速度更快。下面是 2 个示例函数，它们将向当前应用程序键入日期时间字符串

```
; Map Ctrl+Alt+T to send the date string
^!t::
FormatTime, currentdate,, yyyyMMdd HHmm
SendInput %currentdate%
Return

; Map Ctrl+Alt+D to send the date string
^!D::
SendInput %A_YYYY%%A_MM%%A_DD% %A_Hour%%A_Min%
Return 
```

将上述脚本另存为 *.ahk 并运行它。AHK 将在后台运行并听取按键序列以执行所需的操作

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-09-29T14:03:01.890

对于 OP/任何有兴趣的人：http: [//ahkscript.org](http://ahkscript.org)

自动热键可能是您所追求的。香草补充 cmd .bat 或独立的 AHK 脚本应该能够从 STDOUT 中提取数据并设置您的日期语法，并从 1 个脚本中全部设置热键。

这个问题的“热键”部分可能是为什么它以前没有得到回答，而不是可以在 Windows CLI afaik 中完成的事情，你需要“快捷键重新映射软件”，这正是 Auto Hotkey 的设计用途:)

自从我研究 Windows 中的快捷键重新映射以来已经有很长时间了，但我确实记得 AHK 只是少数能够重新映射硬编码快捷键组合（如 WinKey + R）的程序，除非您自己编写一个（使用 C++ 或类似代码）

我还建议彻底挖掘 Rob van der Woude 的网站，特别是关于重定向的 2 篇文章：

[http://www.robvanderwoude.com/battech_redirection.php](http://www.robvanderwoude.com/battech_redirection.php)

底部是指向“重定向概述页面”的链接，这是重定向命令/语法的一个特别好的“备忘单”。

# php - 如何理解关闭的窗口

> ID：12410958
> 
> 赞同：3
> 
> 时间：2012-09-13T16:42:04.933
> 
> 标签：php

我创建了一个chatroom.php，并制作了target="_blank"，只要用户单击房间的链接，它就会将用户引导到适当的房间。此外，当用户单击该链接时，我会将用户的昵称存储在数据库中，以显示该房间中用户的昵称。但是，当用户关闭房间的窗口时，它仍然显示该用户在线，这是不需要的。我需要一种方法，每当用户关闭聊天室之类的房间时，我都会将他/她从该房间中删除。我希望我说清楚了。对于某些房间，它应该像 logout.php 一样工作。我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T16:43:53.600

看看这个[`onBeforeClose`](https://developer.mozilla.org/en-US/docs/DOM/window.onbeforeunload)事件。

```
window.onbeforeclose = function(){
  // make a call to PHP saying user is singing off.
}; 
```

或者，您可以使用“空闲”超时（如果用户在 X 分钟内没有说任何话，则自动将其注销。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T16:49:51.970

为此，您需要创建一个**自动任务以使用****SESSION_Checking**或 ACTIVITY_Monitoring检查仍在聊天室中的用户。一旦用户关闭窗口，TASK 将检查并进行必要的更改。

使用会话检查在 PHP 中实现：

每次用户登录时，您都会设置`$_SESSION['online'] = 1;`- 会话变量仅为该用户设置，因此您不必担心冲突。但是，如果您想向所有用户显示此信息，您可能应该将用户的最后操作时间保存到数据库中。`if($_SESSION['online'] == 1;) mysql_query('UPDATE user SET last_activity=NOW() WHERE id='.$user_id);`或那样。

因此，通过这种方式，您可以跟踪聊天应用程序中的在线用户。

# c++ - c ++将输出流连接到输入流

> ID：12410961
> 
> 赞同：20
> 
> 时间：2012-09-13T16:42:11.470
> 
> 标签：c++, pipe, iostream

我想做的是创建一种“管道”（就像进程之间的管道），但在同一程序中的 c++ iostream 之间。我有一个需要输入流作为参数的函数，但我的数据来自输出流。那么有没有一种标准方法可以将 a 的输出通过管道传输到 a`std::ostream`的输入中`std::istream`？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-13T19:19:13.180

您可以创建一个`std::streambuf`输出到一个缓冲区并`std::overflow()`在缓冲区变满时阻塞的位置。另一方面，您将有一个输入缓冲区，`underflow()`当缓冲区变空时会阻塞。显然，阅读和写作将在两个不同的线程中。

棘手的事情是如何同步两个缓冲区：流在访问缓冲区时不使用任何同步操作。只有当任何一个虚函数被调用时，你才能拦截操作并处理同步。另一方面，不使用缓冲区是相当低效的。我解决这个问题的方法是使用一个相对较小的输出缓冲区（例如 256`char`秒），并覆盖`sync()`以使用此函数将字符传输到输入缓冲区。将`streambuf`使用互斥锁进行同步，并使用条件变量来阻塞输出时的完整输入缓冲区和输入时的空输入缓冲区。为了支持完全关闭，还应该有一个函数设置一个标志，表明没有更多的输入，并且所有进一步的输出操作都应该失败。

创建实际实现表明两个缓冲区是不够的：访问输入和输出缓冲区的线程可能在各自的其他缓冲区阻塞时处于活动状态。因此，需要第三个中间缓冲区。通过对上述计划的这个小改动，下面是一些代码（它使用微小的缓冲区来确保存在实际的上溢和下溢；对于实际使用，至少输入缓冲区可能应该更大）。

```
// threadbuf.cpp                                                      -*-C++-*-
// ----------------------------------------------------------------------------
//  Copyright (C) 2013 Dietmar Kuehl http://www.dietmar-kuehl.de         
//                                                                       
//  Permission is hereby granted, free of charge, to any person          
//  obtaining a copy of this software and associated documentation       
//  files (the "Software"), to deal in the Software without restriction, 
//  including without limitation the rights to use, copy, modify,        
//  merge, publish, distribute, sublicense, and/or sell copies of        
//  the Software, and to permit persons to whom the Software is          
//  furnished to do so, subject to the following conditions:             
//                                                                       
//  The above copyright notice and this permission notice shall be       
//  included in all copies or substantial portions of the Software.      
//                                                                       
//  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,      
//  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES      
//  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND             
//  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT          
//  HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,         
//  WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING         
//  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR        
//  OTHER DEALINGS IN THE SOFTWARE. 
// ----------------------------------------------------------------------------

#include <algorithm>
#include <condition_variable>
#include <iostream>
#include <mutex>
#include <stdexcept>
#include <streambuf>
#include <string>
#include <thread>

// ----------------------------------------------------------------------------

class threadbuf
    : public std::streambuf
{
private:
    typedef std::streambuf::traits_type traits_type;
    typedef std::string::size_type      string_size_t;

    std::mutex              d_mutex;
    std::condition_variable d_condition;
    std::string             d_out;
    std::string             d_in;
    std::string             d_tmp;
    char*                   d_current;
    bool                    d_closed;

public:
    threadbuf(string_size_t out_size = 16, string_size_t in_size = 64)
        : d_out(std::max(string_size_t(1), out_size), ' ')
        , d_in(std::max(string_size_t(1), in_size), ' ')
        , d_tmp(std::max(string_size_t(1), in_size), ' ')
        , d_current(&this->d_tmp[0])
        , d_closed(false)
    {
        this->setp(&this->d_out[0], &this->d_out[0] + this->d_out.size() - 1);
        this->setg(&this->d_in[0], &this->d_in[0], &this->d_in[0]);
    }
    void close()
    {
        {
            std::unique_lock<std::mutex> lock(this->d_mutex);
            this->d_closed = true;
            while (this->pbase() != this->pptr()) {
                this->internal_sync(lock);
            }
        }
        this->d_condition.notify_all();
    }

private:
    int_type underflow()
    {
        if (this->gptr() == this->egptr())
        {
            std::unique_lock<std::mutex> lock(this->d_mutex);
            while (&this->d_tmp[0] == this->d_current && !this->d_closed) {
                this->d_condition.wait(lock);
            }
            if (&this->d_tmp[0] != this->d_current) {
                std::streamsize size(this->d_current - &this->d_tmp[0]);
                traits_type::copy(this->eback(), &this->d_tmp[0],
                                  this->d_current - &this->d_tmp[0]);
                this->setg(this->eback(), this->eback(), this->eback() + size);
                this->d_current = &this->d_tmp[0];
                this->d_condition.notify_one();
            }
        }
        return this->gptr() == this->egptr()
            ? traits_type::eof()
            : traits_type::to_int_type(*this->gptr());
    }
    int_type overflow(int_type c)
    {
        std::unique_lock<std::mutex> lock(this->d_mutex);
        if (!traits_type::eq_int_type(c, traits_type::eof())) {
            *this->pptr() = traits_type::to_char_type(c);
            this->pbump(1);
        }
        return this->internal_sync(lock)
            ? traits_type::eof()
            : traits_type::not_eof(c);
    }
    int sync()
    {
        std::unique_lock<std::mutex> lock(this->d_mutex);
        return this->internal_sync(lock);
    }
    int internal_sync(std::unique_lock<std::mutex>& lock)
    {
        char* end(&this->d_tmp[0] + this->d_tmp.size());
        while (this->d_current == end && !this->d_closed) {
            this->d_condition.wait(lock);
        }
        if (this->d_current != end)
        {
            std::streamsize size(std::min(end - d_current,
                                          this->pptr() - this->pbase()));
            traits_type::copy(d_current, this->pbase(), size);
            this->d_current += size;
            std::streamsize remain((this->pptr() - this->pbase()) - size);
            traits_type::move(this->pbase(), this->pptr(), remain);
            this->setp(this->pbase(), this->epptr());
            this->pbump(remain);
            this->d_condition.notify_one();
            return 0;
        }
        return traits_type::eof();
    }
};

// ----------------------------------------------------------------------------

static void writer(std::ostream& out)
{
    for (std::string line; std::getline(std::cin, line); )
    {
        out << "writer: '" << line << "'\n";
    }
}

// ----------------------------------------------------------------------------

static void reader(std::istream& in)
{
    for (std::string line; std::getline(in, line); )
    {
        std::cout << "reader: '" << line << "'\n";
    }
}

// ----------------------------------------------------------------------------

int main()
{
    try
    {
        threadbuf sbuf;
        std::ostream out(&sbuf);
        std::istream in(&sbuf);

        std::thread write(&::writer, std::ref(out));
        std::thread read(&::reader, std::ref(in));

        write.join();
        sbuf.close();
        read.join();
    }
    catch (std::exception const& ex)
    {
        std::cerr << "ERROR: " << ex.what() << "\n";
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-04-22T17:49:03.887

Dietmar Kühl 的帖子非常完整。它提供了一种在线程间执行此操作的方法，做得很好。但是有一个简单的方法使用`boost::iostreams`. 我今天遇到了这个问题，因为我需要学习如何处理流（设备）和过滤器。我第一次尝试它就成功了。它是您问题的一条线解决方案。

```
boost::iostreams::copy(istream,ostream); 
```

这是我所在位置的一个工作示例：

```
#include <iostream>
#include <sstream>
#include <boost/iostreams/copy.hpp>

const char* testz = R"(H4sIAJSHnl4AA61Uy3LCMAw8t19B + wF2QmAoM67ptZ / QU8Y4Alzix9hOH39fhRgnQGd66Qmx
Wq + 0kiZs86Xb2Qf4oKx5fixJ8bjhd / dsB9BshTxiPJsxD876WGuIohFRnECErd / XRmjgb + Jg
7cPs1UjCaEYTC7RQLXc2RC1CBP / SaOEl + e7fEGk1owMj0VMt1fBy + bRaVGWxXpJVWc3nK0bH
ZGJjO1B7YfbncohtYa / M6XW1KJ6KgtEByQQwSXy + KtdrrG + yHr0SzCUvvDNnWyW / a9dtWxUO
MLZj0YrhrTjCJ2yJgYiKA5YYojkqzT2jQ3BGg9udwP43YY57eAeJCi5DMvKyN9QHQ3u / doJD
lNbnrrz9HM0H23kJtXK8IvOqIuW6IAscwohnqrSdwYKMDkHGU034EG2H42pypp + ACrhqFfGc
uLEG0P8EmRJ7 + 06EgIxxEkOLOIQhM45j4vW6Lu4oG2SqARPVTuFFjy8PIBrw9c5bfbmbaeIs
dqvARBcPtYfQtXGiet32n8tP993LJH / pz2jxQpNN7f9TgcmB0RtbPT8dDqOTT8APTbkhEyYE
AAA =)";

int main(){
    std::istringstream source(testz, std::ios_base::in | std::ios_base::binary);

    namespace bio = boost::iostreams;
    bio::copy(source, std::cout);
} 
```

增强流的真正美妙之处在于，您只需添加过滤器即可在流上进行转换。就我而言，以及我留下长`testz`字符串的原因是，我将在流程中添加一个过滤器，以解压缩数据。

```
bio::filtering_istreambuf in;
in.push(bio::gzip_decompressor());
in.push(source);
bio::copy(in, std::cout); 
```

好吧，这还不行，我必须弄清楚我需要什么额外的过滤器才能将电子邮件附件转换为合格的 gzip 流。但这是处理流的一种非常优雅的方式。代码在顶部保持简单。我只需要把我的新过滤器推到过滤器前面`gzip_decompressor`。

# php - 通过在 POST var 名称中提供数组键使用 PHP POST vars 作为关联数组

> ID：12410962
> 
> 赞同：-1
> 
> 时间：2012-09-13T16:42:12.457
> 
> 标签：php, associative-array

PHP 开发人员知道名称后面带有 [] 的字段将生成一个值数组。例如

```
<input type="hidden" name="gift[]" value="Jerry Garciuh" />
<input type="hidden" name="gift[]" value="Gulf South Thingamabob" /> 
```

会产生

```
Array
(
    [gift] => Array
        (
            [1] => Jerry Garciuh
            [2] => Gulf South Thingamabob
        )

) 
```

但我最近了解到这可以更进一步：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:00:48.673

那是新事物吗？Oo 在 2003 年左右，我用这种方式制作了 4-6 维数组来保存 cms 的设置

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T16:42:12.457

通过在字段名称中提供键值，如下所示：

```
<form action="" method="post" id="gr" >
<input type="hidden" name="api_key" value="foobarbaz" />
<input type="hidden" name="gift[amount]" value="1" />
<input type="hidden" name="gift[recipient_email]" value="jerrygarciuh@example.com" />
<input type="hidden" name="gift[recipient_name]" value="Jerry Garciuh" />
<input type="hidden" name="gift[sender_name]" value="Gulf South Thingamabob" />
<input type="hidden" name="gift[message_announce]" value="Oh hai" />
<input type="submit" />
</form> 
```

您可以为后端生成更高度组织的帖子数据关联数组：

```
Array
(
    [api_key] => foobarbaz
    [gift] => Array
        (
            [amount] => 1
            [recipient_email] => jerrygarciuh@example.com
            [recipient_name] => Jerry Garciuh
            [sender_name] => Gulf South Thingamabob
            [message_announce] => Oh hai
        )

) 
```

# module - 如何使用 MEF 管理相互依赖的模块？

> ID：12410969
> 
> 赞同：6
> 
> 时间：2012-09-13T16:42:24.573
> 
> 标签：module, dependencies, mef

*我发现这个问题很难表达（尤其是标题形式），所以请多多包涵。*

我有一个应用程序，我不断修改它来做不同的事情。似乎 MEF 可能是管理不同功能的好方法。从广义上讲，应用程序的三个部分构成了某种管道：

1.  获得
2.  转型
3.  表达

以最简单的形式，我可以将这些阶段中的每一个都表示为接口（`IAcquisition`等）。当我想使用提供比标准更丰富的数据的采集组件时，问题就开始了。我想设计使用这些更丰富数据的模块，但我不能依赖它的存在。

当然，我可以将所有数据添加到接口规范中。我可以通过抛出异常或返回空值来处理较差的数据源。这似乎与理想相去甚远。

我更喜欢分三个阶段进行 MEF 绑定，这样只有在模块与之前选择的模块兼容时才将模块提供给用户。

所以我的问题是：**我可以指定限制可用导入集的元数据吗？**

一个例子：

> Acquision1 仅提供 BasicData
> 
> Acquision2 提供 BasicData 和 AdvancedData
> 
> Transformation1 需要 BasicData
> 
> Transformation2 需要 BasicData 和 AdvancedData
> 
> 首先选择采集模块。
> 
> 如果选择 Acquisition1，则不提供 Transformation 2，否则两者都提供。

这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-22T15:54:47.700

您的问题提出了这样的结构：

```
public class BasicData
{
    public string Basic { get; set; } // example data
}

public class AdvancedData : BasicData
{
    public string Advanced { get; set; } // example data
} 
```

现在您有了采集、转换和表达组件。您希望能够处理不同类型的数据，因此它们是通用的：

```
public interface IAcquisition<out TDataKind>
{
    TDataKind Acquire();
}

public interface ITransformation<TDataKind>
{
    TDataKind Transform(TDataKind data);
}

public interface IExpression<in TDataKind>
{
    void Express(TDataKind data);
} 
```

现在你想用它们构建一个管道，如下所示：

```
IExpression.Express(ITransformation.Transform(IAcquisition.Acquire)); 
```

* * *

所以让我们开始构建一个管道构建器：

```
using System;
using System.Collections.Generic;
using System.ComponentModel.Composition;
using System.ComponentModel.Composition.Hosting;
using System.ComponentModel.Composition.Primitives;
using System.Linq;
using System.Linq.Expressions;

// namespace ...

public static class PipelineBuidler
{
    private static readonly string AcquisitionIdentity =
        AttributedModelServices.GetTypeIdentity(typeof(IAcquisition<>));
    private static readonly string TransformationIdentity =
        AttributedModelServices.GetTypeIdentity(typeof(ITransformation<>));
    private static readonly string ExpressionIdentity =
        AttributedModelServices.GetTypeIdentity(typeof(IExpression<>));

    public static Action BuildPipeline(ComposablePartCatalog catalog,
        Func<IEnumerable<string>, int> acquisitionSelector,
        Func<IEnumerable<string>, int> transformationSelector,
        Func<IEnumerable<string>, int> expressionSelector)
    {
        var container = new CompositionContainer(catalog); 
```

该类为您的三个合同接口保存 MEF 类型标识。我们稍后将需要这些来识别正确的出口。我们的`BuildPipeline`方法返回一个`Action`. 那将是管道，所以我们可以这样做`pipeline()`。它需要 a`ComposablePartCatalog`和 3 `Func`s（选择导出）。这样一来，我们就可以将所有的脏活留在这个类中。然后我们从创建一个`CompositionContainer`.

现在我们要构建`ImportDefinition`s，首先是获取组件：

```
 var aImportDef = new ImportDefinition(def => (def.ContractName == AcquisitionIdentity), null, ImportCardinality.ZeroOrMore, true, false); 
```

这`ImportDefinition`只是过滤掉`IAcquisition<>`接口的所有导出。现在我们可以把它交给容器了：

```
 var aExports = container.GetExports(aImportDef).ToArray(); 
```

`aExports`现在保存`IAcquisition<>`目录中的所有导出。因此，让我们在此运行选择器：

```
 var selectedAExport = aExports[acquisitionSelector(aExports.Select(export => export.Metadata["Name"] as string))]; 
```

我们有我们的采集组件：

```
 var acquisition = selectedAExport.Value;
        var acquisitionDataKind = (Type)selectedAExport.Metadata["DataKind"]; 
```

现在我们将对转换和表达式组件做同样的事情，但有一点不同：`ImportDefinition`将确保每个组件都可以处理前一个组件的输出。

```
 var tImportDef = new ImportDefinition(def => (def.ContractName == TransformationIdentity) && ((Type)def.Metadata["DataKind"]).IsAssignableFrom(acquisitionDataKind),
            null, ImportCardinality.ZeroOrMore, true, false);
        var tExports = container.GetExports(tImportDef).ToArray();
        var selectedTExport = tExports[transformationSelector(tExports.Select(export => export.Metadata["Name"] as string))];

        var transformation = selectedTExport.Value;
        var transformationDataKind = (Type)selectedTExport.Metadata["DataKind"];

        var eImportDef = new ImportDefinition(def => (def.ContractName == ExpressionIdentity) && ((Type)def.Metadata["DataKind"]).IsAssignableFrom(transformationDataKind),
            null, ImportCardinality.ZeroOrMore, true, false);
        var eExports = container.GetExports(eImportDef).ToArray();
        var selectedEExport = eExports[expressionSelector(eExports.Select(export => export.Metadata["Name"] as string))];

        var expression = selectedEExport.Value;
        var expressionDataKind = (Type)selectedEExport.Metadata["DataKind"]; 
```

现在我们可以将它们全部连接到一个表达式树中：

```
 var acquired = Expression.Call(Expression.Constant(acquisition), typeof(IAcquisition<>).MakeGenericType(acquisitionDataKind).GetMethod("Acquire"));
        var transformed = Expression.Call(Expression.Constant(transformation), typeof(ITransformation<>).MakeGenericType(transformationDataKind).GetMethod("Transform"), acquired);
        var expressed = Expression.Call(Expression.Constant(expression), typeof(IExpression<>).MakeGenericType(expressionDataKind).GetMethod("Express"), transformed);
        return Expression.Lambda<Action>(expressed).Compile();
    }
} 
```

* * *

就是这样！一个简单的示例应用程序如下所示：

```
[Export(typeof(IAcquisition<>))]
[ExportMetadata("DataKind", typeof(BasicData))]
[ExportMetadata("Name", "Basic acquisition")]
public class Acquisition1 : IAcquisition<BasicData>
{
    public BasicData Acquire()
    {
        return new BasicData { Basic = "Acquisition1" };
    }
}

[Export(typeof(IAcquisition<>))]
[ExportMetadata("DataKind", typeof(AdvancedData))]
[ExportMetadata("Name", "Advanced acquisition")]
public class Acquisition2 : IAcquisition<AdvancedData>
{
    public AdvancedData Acquire()
    {
        return new AdvancedData { Advanced = "Acquisition2A", Basic = "Acquisition2B" };
    }
}

[Export(typeof(ITransformation<>))]
[ExportMetadata("DataKind", typeof(BasicData))]
[ExportMetadata("Name", "Basic transformation")]
public class Transformation1 : ITransformation<BasicData>
{
    public BasicData Transform(BasicData data)
    {
        data.Basic += " - Transformed1";
        return data;
    }
}

[Export(typeof(ITransformation<>))]
[ExportMetadata("DataKind", typeof(AdvancedData))]
[ExportMetadata("Name", "Advanced transformation")]
public class Transformation2 : ITransformation<AdvancedData>
{
    public AdvancedData Transform(AdvancedData data)
    {
        data.Basic += " - Transformed2";
        data.Advanced += " - Transformed2";
        return data;
    }
}

[Export(typeof(IExpression<>))]
[ExportMetadata("DataKind", typeof(BasicData))]
[ExportMetadata("Name", "Basic expression")]
public class Expression1 : IExpression<BasicData>
{
    public void Express(BasicData data)
    {
        Console.WriteLine("Expression1: {0}", data.Basic);
    }
}

[Export(typeof(IExpression<>))]
[ExportMetadata("DataKind", typeof(AdvancedData))]
[ExportMetadata("Name", "Advanced expression")]
public class Expression2 : IExpression<AdvancedData>
{
    public void Express(AdvancedData data)
    {
        Console.WriteLine("Expression2: ({0}) - ({1})", data.Basic, data.Advanced);
    }
}

class Program
{
    static void Main(string[] args)
    {
        var pipeline = PipelineBuidler.BuildPipeline(new AssemblyCatalog(typeof(Program).Assembly), StringSelector, StringSelector, StringSelector);
        pipeline();
    }

    static int StringSelector(IEnumerable<string> strings)
    {
        int i = 0;
        foreach (var item in strings)
            Console.WriteLine("[{0}] {1}", i++, item);
        return int.Parse(Console.ReadLine());
    }
} 
```

# html - 包含可折叠递归目录列表的 HTML

> ID：12410982
> 
> 赞同：3
> 
> 时间：2012-09-13T16:43:08.287
> 
> 标签：html, directory, dropbox, public

我想生成一个（静态）HTML 文件，该文件将在浏览器中显示一个递归目录列表，其中包含可折叠的子目录。

目前，我以下列方式使用树：

```
tree -H http://dl.dropbox.com/u/<user_id> > web/directory_listing.html 
```

这会生成一个 HTML 递归目录（和文件）列表。为了清楚起见，我希望目录内容默认折叠。选择目录后，所选目录中的目录和文件会展开并出现在同一页面中。

有什么方法可以生成这种类型的 HTML？也许可以修改树的输出。我想要一个 HTML 文件列表的原因是因为我没有很多服务器控制（这是用于托管在 Dropbox 上）。

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:54:29.513

如果您使用类似的东西卡住了`tree`，也许添加一些 javascript 来实现您的元素显示/隐藏效果。这可以通过在树 HTML ( `tree -H`) 输出的末尾连接一个 javascript 文件来轻松实现。

```
tree -H http://dl.dropbox.com/u/<user_id> > web/directory_listing_part.html
cat web/directory_listing_part.html web/some_file_containing_your_javascript_code > web/directory_listing.html 
```

如果你愿意，你甚至可以使用 javascript 来提供额外的样式。

看看这个页面：

[http://mama.indstate.edu/users/ice/00Tree.html](http://mama.indstate.edu/users/ice/00Tree.html)

这为您可以实现的格式提供了一个很好的示例。请注意类名的使用，这应该很容易让您与 javascript/jquery 挂钩

# objective-c - 具有奇怪调整大小的 IOS 6

> ID：12410983
> 
> 赞同：3
> 
> 时间：2012-09-13T16:43:10.220
> 
> 标签：objective-c, uiview, autoresize, ios6

我有一个包含 UIScrollView 的 UIView。它们都具有 768x1004 像素的精确尺寸，以正确适合 iPad 屏幕。

当 iPad 的方向更改为横向模式时，视图的自动调整大小更改为 1044x728 像素，这不是正确的比例并且会产生奇怪的行为。

这只发生在我使用 iOS 6 并且 iPad 以横向模式启动时。

在旧版本中从来没有问题，当 de iPad 以纵向模式启动时，功能运行良好。

为了让它正常工作，我必须将初始尺寸更改为 748x1044，但在所有其他情况下，应用程序的尺寸都不正确。

我的结论是，当 iPad 以横向模式启动时，iOS 6 中可能会出现某种机制或错误，这会改变您之前在 xib 上配置的大小。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T16:07:30.407

我无法提供确切的代码来解决您的问题。我用来调试此类大小问题的一种方法是在发生重要事情时注销我最外层视图的框架。

例如

```
- (void) viewDidLoad {
 //.. etc
 NSLog(@"viewDidLoad: %@", CGRectCreateDictionaryRepresentation(self.view.frame) );
}

- (void) viewDidLayoutSubviews {
 //.. etc
 NSLog(@"viewDidLayoutSubviews: %@", CGRectCreateDictionaryRepresentation(self.view.frame) );
}

 - (void) viewDidAppear {
 //.. etc
 NSLog(@"viewDidAppear: %@", CGRectCreateDictionaryRepresentation(self.view.frame) );
} 
```

通常通过查看日志，您可以了解问题所在和位置。

# c# - LINQ on Datatable 查找所有行都为空的位置

> ID：12410990
> 
> 赞同：2
> 
> 时间：2012-09-13T16:43:27.027
> 
> 标签：c#, excel, oledb

我有一个从 excel 电子表格中读取数据的代码，我已经走了这么远，在 SO 上有一些答案

```
DataTable dt = ds.Tables[0];
dt = dt.AsEnumerable().Where((row, index) => index > 4).CopyToDataTable();
DataTable filteredRows = dt.Rows.Cast<DataRow>().Where(row => row.ItemArray.All(field => !(field is System.DBNull))).CopyToDataTable(); 
```

有这个

```
dt.Rows.Cast<DataRow>().Where(row => row.ItemArray.All(field => (field is System.DBNull))) 
```

返回所有为空的行。

我也试过`Any`了，它没有给出所需的输出

上面的代码适用于所有字段都不为 NULL 的情况，即每列都有一个字段。这免除了所有缺少 1 列的行，但这不是我想要的。

我想免除所有列都为空的所有行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-13T17:02:10.310

只需将 NOT ( `!`) 移出一层。您希望“所有行都不为空”的项目不为真，而不是“所有行都不为空”为真。

```
DataTable filteredRows = dt.Rows.Cast<DataRow>()
    .Where(row => !row.ItemArray.All(field => field is System.DBNull))
    .CopyToDataTable(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:49:12.153

您是否尝试过过滤到任何字段而不是全部？

```
DataTable filteredRows = dt.Rows.Cast<DataRow>().Where(row => row.ItemArray.Any(field => !(field is System.DBNull))).CopyToDataTable(); 
```

# c++ - C++：使用 segvcatch 安全吗？

> ID：12410992
> 
> 赞同：5
> 
> 时间：2012-09-13T16:43:42.130
> 
> 标签：c++, exception-handling, segmentation-fault, signals

我刚刚偶然发现了[segvcatch](http://code.google.com/p/segvcatch/ "segvcatch")库，它承诺将段错误和浮点错误包装到适当的异常中。

使用这个库是否安全，如果我添加所有捕获的段错误将仅是空指针访问的前提条件（即，没有数组溢出或无效指针可能在段错误之前完全搞砸内存，无论如何都会导致未定义的行为）？捕获 nullptr 段错误后，程序是否仍具有定义的语义？浮点错误呢？他们表现得更好/不同吗？

旁注：请不要发表评论，说明任何产生段错误的程序都是格式错误的，应该调试/修复。我知道，我同意。不过，我对这个问题很感兴趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T17:11:21.983

不安全。

信号处理程序非常简单，而且它们完全是错误的。这是 SEGV 处理程序：

```
void default_segv()
{
    throw std::runtime_error("Segmentation fault");
} 
```

这是相当非法的，至少在 POSIX 上是这样。从信号处理程序中抛出异常是一个非常非常糟糕的主意。

**附录**
那么为什么这是一个坏主意呢？

使用 SIGALRM，这比一个坏主意更糟糕；这是未定义的行为，因为警报是异步的。使用 SIGSEGV 和 SIGBUS 这是一个非常糟糕的主意。对于其他信号，这只是一个坏主意。有时它可能会起作用。其他时候，可能不会。当魔法不起作用时，结果可能是非常灾难性的。

我先看看SEGV。分段违规和总线错误的一个常见原因是破坏堆栈。如果这是信号的原因，则没有可展开的堆栈。将`throw`尝试展开堆栈，这将引发另一个 SEGV。怎么办？在我的电脑上，这是一场灾难。

无论信号如何，在信号处理程序中抛出对于 RAII 而言都是不安全的，因为`free()`（因此`delete`）在处理程序的上下文中调用是不安全的。从信号处理程序的上下文中调用大量的函数是不安全的。在处理程序中发生的所有事情都是`throw`在信号处理程序的上下文中完成的，因为`throw`不会从处理程序返回。`throw`绕过返回。

那些不安全的调用和不安全的展开意味着可以在处理旧信号的同时发出新信号。这个递归信号是很成问题的。例如，在我的计算机上，信号变为 SIGSTOP。该程序不会退出，它不会丢弃核心。它只是挂在那里，永久冻结，直到我杀死 -9 或重新启动机器。

# mongodb - Meteor：通过_id从集合中查找对象

> ID：12410993
> 
> 赞同：5
> 
> 时间：2012-09-13T16:43:42.830
> 
> 标签：mongodb, meteor

我正在尝试使用 Meteor 通过 _id 查找对象。

这是我尝试过的：

```
Meteor.publish("gifts", function(gid) {
  console.log("Looking for "+ gid);
  var gifts = Gifts.find({_id: gid}).fetch();
  console.log("Result: " + gifts);
  return gifts;
}); 
```

这是输出：

> 寻找 f1790caa-7a10-4af5-a01c-e80bb2c2fd55 结果：

如果我取出查询：

```
Meteor.publish("gifts", function(gid) {
  console.log("Looking for "+ gid);
  var gifts = Gifts.find().fetch()[1];
  console.log("Result:" + gifts._id);
  return gifts;
}); 
```

对象在数组中，_id同上。

> 寻找 f1790caa-7a10-4af5-a01c-e80bb2c2fd55 结果： f1790caa-7a10-4af5-a01c-e80bb2c2fd55

另外，如果我在 mongo 控制台中执行 find ，我会找到对象：

```
> db.gifts.find({_id: 'f1790caa-7a10-4af5-a01c-e80bb2c2fd55'});
{ "name" : "A new gift", "_id" : "f1790caa-7a10-4af5-a01c-e80bb2c2fd55" } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T20:21:30.827

你是从哪里插入文件的？MongoDB 对字符串和 objectIds 的处理方式不同，目前 Meteor 中似乎存在一个错误，无法正确处理 objectIds。

[https://github.com/meteor/meteor/issues/61](https://github.com/meteor/meteor/issues/61)

# ios - 如何将新设备添加到临时分发配置文件？

> ID：12410996
> 
> 赞同：3
> 
> 时间：2012-09-13T16:43:55.123
> 
> 标签：ios, xcode

我已经向开发门户添加了一些新设备，并希望能够向它们发送临时分发版以便通过 iTunes 进行安装。

但是，我在门户网站上看不到可以将设备添加到临时配置文件的任何地方。我尝试通过 XCode 刷新配置文件，并将新设备添加到其他配置文件中，但没有将它们添加到临时配置文件中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T16:49:23.593

在您的 Ad-hoc 配置文件列表的右侧有一个“编辑”按钮，单击该按钮并使用复选框选择您想要在此配置文件中使用的设备。

![编辑按钮](../Images/03b0caebc0e0f59bdb03ae404b3cccc9.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:50:27.493

试试这个：

[在http://developer.apple.com/ios/manage/provisioningprofiles/index.action](http://developer.apple.com/ios/manage/provisioningprofiles/index.action)登录配置门户

*   转到分发选项卡。
*   查找您的临时配置文件
*   点击编辑。
*   在显示的列表中勾选新设备（或选择“全选”）。
*   个人资料会说待定。
*   等待几秒钟，重新加载。
*   下载并安装新的配置文件。