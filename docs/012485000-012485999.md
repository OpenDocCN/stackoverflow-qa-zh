# StackOverflow 问答 12485000-12485999

# mysql - MySQL 只选择新记录

> ID：12485000
> 
> 赞同：2
> 
> 时间：2012-09-18T21:03:07.883
> 
> 标签：mysql, sql, select

如何编写一个 MySQL 查询来完成这个任务？

**表：**作家

```
w_id    w_name
---------------
  1     Michael
  2     Samantha
  3     John
--------------- 
```

**表：**文章

```
a_id   w_id   timestamp   a_name
----------------------------------------
  1      1    0000000001  PHP programming
  2      3    0000000003  Other programming languages
  3      3    0000000005  Another article
  4      2    0000000015  Web design
  5      1    0000000020  MySQL
---------------------------------------- 
```

只需要选择那些发表不早于**0000000005**的第一篇文章的作者。
*（只能选择发表过至少一篇文章的作者）*

在此示例中，结果将是：

```
 2     Samantha 
```

SQL代码可以在这里测试[http://sqlfiddle.com/#!2/7a308](http://sqlfiddle.com/#!2/7a308)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:07:43.687

未经测试，但接近：

```
SELECT w_id, MIN(timestamp) as min_time
from writers w
JOIN articles a on w.w_id = a.w_id
GROUP BY 1
HAVING min_time > 5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:22:33.323

这是一种方法，使用内联视图（或 MySQL 称之为“派生表”）来获取每个写入器的最早时间戳：

```
SELECT w.w_id
     , w.w_name
   --  , e.earliest_timestamp
  FROM writers w
  LEFT
  JOIN ( SELECT a.w_id
              , MIN(a.timestamp) AS earliest_timestamp
           FROM articles a
          GROUP BY a.w_id
       ) e
    ON e.w_id = w.w_id
 WHERE e.earliest_timestamp >= '0000000005'
 ORDER BY w.w_id 
```

这可能不是最有效的方法，但您可以只在内联视图（别名为 e）中运行查询以查看它返回的内容。然后，我们可以像处理表一样引用该查询的结果集（有一些限制。）

（其他方法可以更好地利用合适的索引。）

我不清楚`earliest_timestamp`列的数据类型。上面的 SQL 假定它是字符数据类型。如果它是整数而不是字符，则 WHERE 子句可能如下所示：

```
 WHERE e.earliest_timestamp >= 5 
```

# amazon-web-services - 无法使用 AWS Elastic Beanstalk 将多个应用程序部署到单个 EC2 实例的解决方法？

> ID：12485002
> 
> 赞同：0
> 
> 时间：2012-09-18T21:03:15.607
> 
> 标签：amazon-web-services, amazon-elastic-beanstalk, continuous-deployment

我们有一个使用 AWS Elastic Beanstalk 运行的 Web 应用程序（通过 Visual Studio 2010）。

我们现在希望在同一台服务器上建立第二个站点，用于开发和演示目的。我想指向持续部署的新位置。一旦我们感到高兴，我想切换回原来的（生产）目的地。

我一直在网上阅读，看起来使用 Elastic Beanstalk 无法在同一个实例上运行两个站点？

我们目前在免费套餐下运行，并试图尽可能地榨取每一分钱。不得不抛出另一个实例来托管我们的预生产环境将使我们分配给免费层使用的时间减半。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T04:57:52.620

从你的问题中不清楚你到底想做什么。Elastic Beanstalk 使您可以非常轻松地在应用程序的版本之间来回切换。您还可以相当快速地轻松终止和重新创建环境。如果你 100% 的时间都不需要你的“生产”目的地，你难道不能在不使用它的时候把它关掉吗？

# c# - 以编程方式更改耳机的按钮行为

> ID：12485004
> 
> 赞同：3
> 
> 时间：2012-09-18T21:03:27.617
> 
> 标签：c#, registry, hardware, headphones

一旦用户单击[LifeChat LX-3000](http://www.microsoft.com/hardware/en-us/p/lifechat-lx-3000/JUG-00001)中心按钮，是否可以以编程方式更改启动的过程？

我没有任何硬件编程经验，所以不知道这是否可能。问题是，我们的一个客户有很多这样的耳机，我们希望能够将该按钮的默认行为从打开实时信使更改为打开我们的 CRM。我尝试按照[此说明](http://www.techpowerup.com/forums/showthread.php?t=150345)修改注册表（不是以编程方式）：

*   找到 HKEY_CLASSES_ROOT\CLSID{F5F545A6-39C4-40B5-814D-B45040A89FB5}\LocalServer32
*   通过双击它并删除文本来删除（默认）值
*   将值更改为*OurCRMExePath*

但这不起作用。我想自从网页编写之日起事情就发生了变化。任何想法？我想第一步是知道该按钮修改了哪个注册表项，然后去更改它。但是，怎么可能知道呢？

# python - Python 浮点精度格式说明符

> ID：12485005
> 
> 赞同：9
> 
> 时间：2012-09-18T21:03:28.340
> 
> 标签：python, numpy, floating-point, precision

假设我有一些 32 位数字和一些 64 位数字：

```
>>> import numpy as np
>>> w = np.float32(2.4)
>>> x = np.float32(4.555555555555555)
>>> y = np.float64(2.4)
>>> z = np.float64(4.555555555555555) 
```

我可以将它们打印出来，`%f`但它有额外的、不需要的小数：

```
>>> '%f %f %f %f' % (w, x, y, z)
'2.400000 4.555555 2.400000 4.555556' 
```

我可以使用`%g`，但它似乎有一个小的默认精度：

```
>>> '%g %g %g %g' % (w, x, y, z)
'2.4 4.55556 2.4 4.55556' 
```

我在想我应该`.7`对 32 位值和`.15`64 位值使用类似的东西：

```
>>> '%.7g %.7g %.15g %.15g' % (w, x, y, z)
'2.4 4.555555 2.4 4.55555555555556' 
```

这似乎工作得相当好，但精度数也用于小数位前的数字，例如 34567.375768。

总之，将浮点值序列化为文本的正确方法是什么，以便为 32 位和 64 位值保留适当的精度但不使用任何不必要的空间？

**更新**：

我*认为*输出应该是的示例：

```
number                float32     float64
5                     5           5
0.1                   0.1         0.1
2.4                   2.4         2.4
4.555555555555555     4.5555553   4.5555555555555554
12345678.92345678635  12345679.0  12345678.923456786 
```

我用 .7/.16 得到什么。这实际上看起来不错：

```
>>> v32 = np.array([5, 0.1, 2.4, 4.555555555555555, 12345678.92345678635], dtype=np.float32)
>>> v64 = np.array([5, 0.1, 2.4, 4.555555555555555, 12345678.92345678635], dtype=np.float64)
>>> ('%.7g ' * len(v32)) % tuple(v32)
'5 0.1 2.4 4.555555 1.234568e+07 '
>>> ('%.16g ' * len(v64)) % tuple(v64)
'5 0.1 2.4 4.555555555555555 12345678.92345679 ' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T21:18:04.267

您可以尝试使用该[`np.finfo`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.finfo.html)函数来获得与您的浮点数相对应的精度

```
finfo32 = np.finfo(np.float32)
finfo64 = np.finfo(np.float64)

finfo32.resolution = 1e-6
finfo64.resolution = 1e-15 
```

既然你知道你想要多少个小数，比如 6，只需使用 a`rstrip("0")`去掉不必要的 0：

```
print ("%.6f" % your_float).strip("0") 
```

如果您倾向于`%g`，也许您可​​能想要使用动态格式，例如：

```
>>> strf = lambda v: ("%%.%ig" % max(np.ceil(np.log10(v)), 7)) % v
>>> strf(123.456789)
'123.45679'
>>> strf(123456789.12345)
'123456789' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T21:27:23.790

我不确定您要完成什么。但是，这可能会有所帮助。你写了

*这似乎工作得相当好，但精度数也用于小数位前的数字，例如 34567.375768。*

您可以使用`%f`而不是`g`. 来自 Python[文档](http://docs.python.org/library/string.html#format-specification-mini-language)：

> 精度是一个十进制数，表示在小数点后应显示多少位数，格式为“f”和“F”的浮点值，或小数点前后的位数，格式为“g”或'G'。

```
>>> z = np.float64(4.555555555555555)
>>> "%.3f" % z
'4.556'
>>> q = np.float64(2131234.555555555555555)
>>> "%.3f" % q
'2131234.556'
>>> 
```

# javascript - 动态触发下拉列表的选定索引更改

> ID：12485007
> 
> 赞同：1
> 
> 时间：2012-09-18T21:03:32.873
> 
> 标签：javascript, jquery

我有一个带有附加方法的简单下拉列表。我想从代码中触发该下拉列表的 selectedindex 更改事件

```
<select id="ddStartPeriod" onchange="javascript:fnSetStartDate()">
<option value="RC">RC</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
</select> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T21:06:24.140

You should remove the inline javascript and add an event trigger:

```
$('#ddStartPeriod').on('change', function(){
    alert('changed to '+$(this).val());
}); 
```

trigger from a button:

```
$('#button').on('click', function(){
     $('#ddStartPeriod').change();
}); 
```

# ios - Codility 编程测试和 Objective-C 语法

> ID：12485009
> 
> 赞同：3
> 
> 时间：2012-09-18T21:03:41.987
> 
> 标签：ios, objective-c, c, syntax

我一直在查看 Codility 测试（[http://codility.com/](http://codility.com/)），因为我正在考虑尝试获得证书，但我遇到了一些非常奇怪的语法错误，它似乎使用了一点不同版本的 Objective-C 到 iOS。

例如，要完成的函数声明如下：

`int equi (NSMutableArray *A) { //.... }`

与

`-(int)equi:(NSMutableArray *)A { //... }`

当我声明以下`for`循环时（`A`是一个数组`NSNumber`）：

```
12\. for (int i = 0; i < [A count]; i++){
13\.    total = total + [[A objectAtIndex:i] intValue];   
14\. } 
```

它给了我以下编译错误：

```
func.m:12: error: 'for' loop initial declarations are only allowed in C99 mode
func.m:12: note: use option -std=c99 or -std=gnu99 to compile your code
func.m:13: error: invalid operands to binary + (have 'double' and 'id') 
```

如果有人可以对此有所了解，那么可能是objective-c的版本或编译器版本不同吗？

谢谢

**编辑：**来自 Codility 的@Kos 在下面评论说，他们最近将他们的 Objective-C 编译器切换到了 Clang，这应该意味着我问的大多数问题现在都不是问题了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T21:08:59.190

```
int equi (NSMutableArray *A) { //.... } 
```

这不是“Objective-C 的不同版本”。这是一个 C 函数。

生成编译器错误是因为...

```
'for' loop initial declarations are only allowed in C99 mode 
```

编译器稍后会告诉您解决方案：

```
use option -std=c99 or -std=gnu99 to compile your code 
```

另一个可以通过强制转换来解决：

```
total = total + (int)[[A objectAtIndex:i] intValue]; 
```

或者，甚至更好：

```
total = total + [(NSNumber *)[A objectAtIndex:i] intValue]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-26T22:17:16.467

我尝试参加 Objective-C 测试并有类似的经历。我的结论是 Codility 支持 Objective-C 1 而不是现代的 Objective-C 2。在我看来 Codility 使用 gcc 编译器，这就是为什么它是旧的 Objective-C 语法。我们这些在 Apple 平台上工作的人已经习惯了 Apple 更新的 Objective-C 2。不幸的是，我不知道有任何针对现代 Objective-C 的编程测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T10:15:33.623

请注意，这个问题完全是在 Codility 的上下文中，它没有明确告诉您它正在编译的 C 版本。

正如 H2CO3 所指出的，声明是一个 C 函数。我被抛出了，因为测试应该是在 Objective-C 中，而不是 C，虽然是的，Objective-C 是 C 的超集，但我期待 Objective-C 语法。

Codility 不允许您访问编译器标志，因此堆栈跟踪没有用。`i`问题是在循环声明中的初始声明`for`（C90 风格）。它应该被重写为明确的：

```
int i = 0;
int count = [A count];
for (i = 0; i < count; i++) {
    total = total + [((NSNumber *)[A objectAtIndex:i]) intValue];
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-05-07T22:59:16.433

在 for 循环中，计数不正确。正确的计数是数组计数 - 1，如下：

```
int i = 0;
int contagem = [A count];
for (i = 0; i < count - 1; i++) {
    total = total + [((NSNumber *)A[i]) intValue];
} 
```

# c# - 获取word文档

> ID：12485015
> 
> 赞同：-3
> 
> 时间：2012-09-18T21:04:27.653
> 
> 标签：c#

我有一个目录，其中包含一些 word 文档 (.doc) 文件。我想从该目录中获取每个并将它们放入列表中，以便我可以打开它们。我如何循环获取它们，一旦我得到它们，我如何打开它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T18:58:10.067

这将列出目录中的所有 word 文档：

```
using System.IO;

    DirectoryInfo Dir = new DirectoryInfo("C:\\Test");
    FileInfo[] FileList = Dir.GetFiles("*.doc", SearchOption.TopDirectoryOnly);
        foreach (FileInfo FI in FileList)
        {
            Console.WriteLine(FI.FullName); 
        } 
```

然后只是一个快速打开word文档的方法：

```
using System.Diagnostics;

    Process.Start(@"C:\Path to File\File.doc"); 
```

# c# - 桌面应用程序和服务应用程序之间的不同行为

> ID：12485021
> 
> 赞同：0
> 
> 时间：2012-09-18T21:04:39.197
> 
> 标签：c#, .net, service, desktop-application

我遇到了最奇怪的问题。

在我的 C# 解决方案中，我有一个桌面测试应用程序和一个服务应用程序。在启动两个应用程序时，我调用完全相同的方法，但行为完全不同。我的桌面应用程序运行良好，读取 COM 端口，处理该信息，然后将该数据插入我的数据库。服务应用程序，很好地读取了 COM 端口，但随后对数据的处理完全不同，之后它抛出 SQLException，因为它试图转换错误的数据（特别是 datetime '01/01/0001'）

我需要这个应用程序成为一个服务，我有桌面应用程序只是为了测试它。我从事服务工作已有一段时间了，以前从未见过这种行为。

使用完全相同的库调用相同的函数时，应用程序和服务的工作方式怎么可能如此不同？

这是代码：

*   服务：

    ```
    protected override void OnStart()
    {
                    csGPS.startGPSData();

        Thread hiloEscuchar = new Thread(delegate()
            {
                csListener listener = new csListener();
                listener.listenAutoCommand();
            });
        hiloEscuchar.Start();

        Thread hiloEnviar = new Thread(delegate()
            {
                csSender.buscarComandos();
            });
        hiloEnviar.Start();

        Thread hiloEnviarPosiciones = new Thread(delegate()
        {
            csSender.enviarPosiciones();
        });
        hiloEnviarPosiciones.Start();
    } 
    ```

*   桌面应用程序：

    ```
    private void btnComenzar_Click(object sender, EventArgs e)
    {
        csGPS.startGPSData();

        Thread hiloEscuchar = new Thread(delegate()
            {
                csListener listener = new csListener();
                listener.listenAutoCommand();
            });
        hiloEscuchar.Start();

        Thread hiloEnviar = new Thread(delegate()
            {
                csSender.buscarComandos();
            });
        hiloEnviar.Start();

        Thread hiloEnviarPosiciones = new Thread(delegate()
        {
            csSender.enviarPosiciones();
        });
        hiloEnviarPosiciones.Start();

        lblEstado.Text = "STARTED";
        btnComenzar.Enabled = false;

    } 
    ```

我希望你们能帮助我。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:12:31.240

虽然代码可能相同，但服务在完全不同的安全环境下运行。它们通常在`LocalSystem`用户下运行，并且无法访问桌面。此用途还具有非常有限的网络访问权限。

您需要将代码作为服务进行调试，或者至少添加一些调试日志语句来尝试找出不同的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:10:57.060

“01/01/0001”是有效的 .NET 日期，但不是有效的 MS SQL 日期。

您可能没有使用 MSSQL，但任何数据库都有有效的日期范围。

SQL 上的日期时间是 1753 年 1 月 1 日到 9999 年 12 月 31 日

SmallDateTIme 是 1900 年 1 月 1 日到 2079 年 6 月 6 日

我总是在插入之前检查日期范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T22:08:32.283

问题已解决。出于某种原因，我的服务使用的 CultureInfo 与我的桌面应用程序使用的不同。

桌面应用程序似乎使用在区域配置中设置的默认 CultureInfo，而服务应用程序由于某种原因不使用。

谢谢你的帮助。

# mobiscroll - Mobiscroll 有条件地设置打开滚动条值

> ID：12485022
> 
> 赞同：0
> 
> 时间：2012-09-18T21:04:44.280
> 
> 标签：mobiscroll

我正在尝试使用有条件设置的时间值打开滚动条。当文本输入框 = 0 时，将 mobiscroll 设置为 0。当输入值为 0 时，它似乎默认为 12。我尝试了很多方法，这是我得到的最接近的方法......

```
$(function () {

    $('.in').scroller({
        preset: 'time',
        theme: 'default',
        display: 'modal',
        mode: 'mixed',
        stepMinute: 15,
        timeWheels: 'hhii',
        ampm: false,
        ampmText: false,
        timeFormat: 'hh:ii',
        onShow: function (valueText, inst) {
            scrollerVals = inst.temp;

            if ($(this).val() == "0" || $(this).val == null || $(this).val == "") {
                $(this).scroller().scroller('setValue', ['1', '0'])
            }
        }
    }); 
```

但它不起作用。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:17:50.367

首先你想达到什么目标？

其次，mobiscroll 与输入相关联，因此使用它来决定值可能没有意义。

要设置默认值，请使用“setValue”方法。

# c++ - C2070 - 非法的操作数大小

> ID：12485025
> 
> 赞同：9
> 
> 时间：2012-09-18T21:04:56.777
> 
> 标签：c++, visual-studio-2008, sizeof, visual-c++

以下代码对我来说很好：

```
 #include <stdio.h>

    template <typename T>
    struct A
    {
        static float m_kA[];
    };

    template <typename T>
    float A<T>::m_kA[] = {1.0f, 2.0f, 3.0f};

    int main()
    {
        printf("%d\n", 
            sizeof(A<unsigned int>::m_kA) /
            sizeof(A<unsigned int>::m_kA[0]));
        return 0;
    } 
```

但是当我用 VC9 编译时出现以下错误

```
error C2070: 'float []': illegal sizeof operand 
```

我希望这段代码能够编译。我错过了什么吗？有谁知道解决这种奇怪行为的方法（请注意，没有模板的完全相同的东西编译得很好并输出 3）。

请注意，删除模板不是一个选项，我制作了这个示例来重现我在代码中遇到的问题，我需要包含数组的类型作为模板。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T21:16:44.043

它的定义很好。请注意，在类定义中，`m_kA`用 type 声明`float[]`，这是一个不完整的类型，不能与`sizeof`. 在的定义中`m_kA`，重新声明了有类型`float[3]`，之后就可以使用了`sizeof`。（8.3.4 规定了数组声明的含义。）

从 3.4.6 使用指令和命名空间别名 [basic.lookup.udir]：

> 10 在所有类型调整之后（在此期间 typedefs (7.1.3) 被其定义替换），所有引用给定变量或函数的声明指定的类型应相同，除了数组对象的声明可以指定数组类型因存在或不存在主要数组边界而异（8.3.4）。在类型标识上违反此规则不需要诊断。

从 3.9.2 复合类型 [basic.compound]：

> 6 [...]数组对象的声明类型可能是一个未知大小的数组，因此在翻译单元中的某个点不完整，稍后完成；这两个点的数组类型（“T 的未知边界数组”和“NT 数组”）是不同的类型。[...]

编译器问题的解决方法是直接声明`m_kA`完整的类型。另一个保持大小的静态成员也可能会有所帮助。

[我引用 C++11，但据我所知，C++03 遵循相同的规则。]

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-18T21:11:18.583

[http://ideone.com/3ssVi](http://ideone.com/3ssVi)

它用 G++ 编译得很好。

据我所见，它可能与此错误有关：

[http://connect.microsoft.com/VisualStudio/feedback/details/759407/can-not-get-size-of-static-array-defined-in-class-template](http://connect.microsoft.com/VisualStudio/feedback/details/759407/can-not-get-size-of-static-array-defined-in-class-template)

# python - 打印数字是偶数

> ID：12485028
> 
> 赞同：-5
> 
> 时间：2012-09-18T21:04:59.133
> 
> 标签：python

我正在尝试编写一个程序，提示用户输入一个数字并确定该数字是偶数还是奇数。

```
remainder = number%2

number = int(input ("number: ")

    if remainder == 0

    print("Number is even")

    else:

    print("Number is odd") 
```

我不断收到语法错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:05:51.267

Python 需要缩进，以及 if 语句后的 :。这是上述内容的更正版本，可以使用：

```
number = 7
remainder = number%2
if remainder == 0:
    print("Number is even")
else:
    print("Number is odd")

>>> Number is odd 
```

也就是说，Jane Doe 稍作修改的语法更简洁，并且可能更适合您的应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T21:07:49.417

```
 def evenOrOdd(number):
    if number%2 == 0:
        print "Even Number"
    else:
        print "Odd Number" 
```

# linux - 查找要与 dlload 一起使用的共享库名称

> ID：12485029
> 
> 赞同：1
> 
> 时间：2012-09-18T21:05:05.700
> 
> 标签：linux, shared-libraries, lazy-loading, autoconf, system-calls

在我的开源项目[Artha](http://artha.sourceforge.net/)中，我使用[libnotify](http://developer-next.gnome.org/libnotify/)向用户显示被动桌面通知。

不是静态链接 libnotify，而是在运行时通过 查找共享对象 (.so) 文件`dlload`，如果在目标机器上可用，Artha 在其 GUI 中公开通知功能。在应用程序上。开始，`dlload`使用文件名参数 as`libnotify.so.1`进行调用，如果它返回一个非空指针，则该功能被公开。

这个模型的一个反复出现的问题是，每次库的版本号被碰撞时，Artha 的代码都需要更新，目前`libnotify.so.4`是最新的出现这种情况的代码。

是否有 linux 系统调用（无论应用程序在哪个发行版上运行），它可以告诉我特定库的共享对象在运行时是否可用？我知道存在通过从 1 到 10 来枚举库的蛮力选项，我发现解决方案丑陋且不雅。

此外，如果这可以通过[autoconf](http://www.gnu.org/software/autoconf/manual/autoconf.html)解决，那么该解决方案也很受欢迎，即在构建时，基于目标机器，生成的 configure.h 应该具有可以传递给 .so 的正确名称`dlload`。

**PS：**我认为好的发行版遵循创建链接的风格，`libnotify.so.x`以便程序员可以做`dlload("libnotify.so", RTLD_LAZY)`并且加载正确的版本号 .so ；不幸的是，并非所有发行版都遵循这一点，包括 Ubuntu。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-23T09:14:07.053

答案是：你没有。

`dlopen()`并非旨在处理此类事情，并且尝试加载您在系统上找到的任何转换只是因为它恰好具有您需要的符号并不是一个好方法。

不同的 soname 有不同的 ABI，不同的 ABI 意味着您可能正在调用相同的符号名称，但需要不同的参数集（或不同的大小），这将导致非常难以调试的崩溃或错误行为。

您应该[了解共享对象版本的工作原理](https://blog.flameeyes.eu/2009/04/shared-object-version)以及[ABI 是什么](https://blog.flameeyes.eu/2009/04/application-binary-interface)。

该`libfoo.so`链接用于链接编辑器 ( `ld`)，因此通常与`-devel`软件包一起安装；它也很可能不是一个链接，而是一个带有链接器脚本的文本文件，通常是为了避免你正在尝试做的事情。

# c - sprintf segfault 而 printf 很好

> ID：12485034
> 
> 赞同：0
> 
> 时间：2012-09-18T21:05:36.603
> 
> 标签：c, windows, ubuntu, cstring

`printf("%s/%s\n", str1, str2);`当打印出字符串而`sprintf(str3, "%s/%s", str1, str2);`导致程序崩溃时，我可能会忽略任何简单的事情吗？

这只发生在我在 VirtualBox 上运行的 Ubuntu（最新版本）上。在 Windows（主机）上，两条线都运行没有任何问题。

如果需要更多上下文，请告诉我。我希望我错过了一些愚蠢的事情，并且那两条线绰绰有余。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T21:09:19.323

区别在于`printf()`写入标准输出和`sprintf()`写入缓冲区`str3`。如果`str3`不够大，无法包含生成的字符串，那么它是未定义的行为，并且可能是导致崩溃的原因。

`str3`必须正确初始化（未初始化`NULL`或未初始化）并且必须指向足够的空间来容纳`strlen(str1) + strlen(str2) + 2`字符。是`+ 2`和`/`终止空字符。例如：

```
char* str3 = malloc(strlen(str1) + strlen(str2) + 2);
if (str3)
{
    sprintf(str3, "%s/%s", str1, str2);
} 
```

# lucene - Lucene 网页页面

> ID：12485040
> 
> 赞同：1
> 
> 时间：2012-09-18T21:06:02.273
> 
> 标签：lucene

我正在创建一个`Lucene`需要实现分页的 Web 应用程序。我在这里看到了关于在收集器上使用偏移的不同示例。然而，那些似乎是旧的。 `Lucene 3.5`（或3.6不记得哪个）我相信添加了这个。我看过`IndexSearcher`方法`searchAfter`。但是，它要求您通过最后一个`ScoreDoc`. 因为这是一个 Web 应用程序，所以我无法将最后一个结果（作为 ScoreDoc 对象）传递给下一个请求。所以，我的问题是这通常是如何完成的？

我真正想出的唯一方法是在构建时将唯一键添加到索引中。然后，在尝试获取下一页时将该键作为 post 参数传递。然后，我必须搜索该键以获取文档 ID 并拉出该文档以与 searchAfter 一起使用。我认为我必须使用自己的唯一密钥，因为我不能依靠文档 ID 保持不变。我对此是否正确？

如果有更好的方法，请告诉我。这是我第一次尝试 Lucene。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T02:02:02.993

> 但是，它要求您将最后一个 ScoreDoc 传递给它。因为这是一个 Web 应用程序，所以我无法将最后一个结果（作为 ScoreDoc 对象）传递给下一个请求。所以，我的问题是这通常是如何完成的？

我不明白你的问题，如果你想使用searchAfter，只需制作一个ScoreDoc 传递给它。您的 webapp 可以传递整数和浮点数吗？

```
 /** Constructs a ScoreDoc. */
  public ScoreDoc(int doc, float score) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-09T15:14:58.993

据我所知，您目前所做的事情是正确的。您自己使用整数和浮点数构建的 ScoreDoc 将不起作用。请参阅我的类似问题：

[工作 Lucene SearchAfter 示例](https://stackoverflow.com/questions/24057613/working-lucene-searchafter-example)

# javascript - Javascript Fade 产生意想不到的结果

> ID：12485048
> 
> 赞同：3
> 
> 时间：2012-09-18T21:07:01.610
> 
> 标签：javascript, html, fading

我有一个 HTML 页面，上面有三组图像。我希望每组中的每张图像都保持可见 5 秒钟，然后一起淡出，当所有三个图像都不可见时，一起淡入。然后该过程再次开始。我试图在不使用 JQuery 的情况下做到这一点。我写了一个 JavaScript 来做到这一点，它可以工作，但过了一会儿奇怪的事情发生了。图像停止淡出、淡入或过早淡出。这是相关的HTML：

```
<body onload="HideAll(fade1Image2, fade1Image3, fade1Image4, fade2Image2,
fade2Image3, fade2Image4, fade3Image2, fade3Image3, fade3Image4); 
SetVariables(4,4,4);">

<div id="fade1Image1" style="position:absolute;top:0px;left:312px;">
    <img src="Images/Home/Power_Station/PowerStation1.jpg" alt="Power Station 1" />
</div>
<div id="fade1Image2" style="position:absolute;top:0px;left:312px;">
    <img src="Images/Home/Power_Station/PowerStation2.jpg" alt="Power Station 2" />
</div>
<div id="fade1Image3" style="position:absolute;top:0px;left:312px;">
    <img src="Images/Home/Power_Station/FenceLine1.jpg" alt="Fence Line 1" />
</div>
<div id="fade1Image4" style="position:absolute;top:0px;left:312px;">
    <img src="Images/Home/Power_Station/FenceLine2.jpg" alt="Fence Line 2" />
</div>

<div id="fade2Image1" style="position:absolute;top:208px;left:0px;">
    <img src="Images/Home/LNG_Terminal_Set/LNGTerminal1.jpg" alt="LNG Terminal 1" />
</div>
<div id="fade2Image2" style="position:absolute;top:208px;left:0px;">
    <img src="Images/Home/LNG_Terminal_Set/LNGTerminal2.jpg" alt="LNG Terminal 2" />
</div>
<div id="fade2Image3" style="position:absolute;top:208px;left:0px;">
    <img src="Images/Home/LNG_Terminal_Set/LNGTerminal3.jpg" alt="LNG Terminal 3" />
</div>
<div id="fade2Image4" style="position:absolute;top:208px;left:0px;">
    <img src="Images/Home/LNG_Terminal_Set/LNGTerminal4.jpg" alt="LNG Terminal 4" />
</div>
<div id="fade3Image1" style="position:absolute;top:416px;left:312px;">
    <img src="Images/Home/Airports/AirPort1.jpg" alt="Air Port 1" />
</div>
<div id="fade3Image2" style="position:absolute;top:416px;left:312px;">
    <img src="Images/Home/Airports/AirPort2.jpg" alt="Air Port 2" />
</div>
<div id="fade3Image3" style="position:absolute;top:416px;left:312px;">
    <img src="Images/Home/Airports/T1_Tracker.jpg" alt="TI Tracker 1" />
</div>
<div id="fade3Image4" style="position:absolute;top:416px;left:312px;">
    <img src="Images/Home/Airports/Targets_Tracked_no_alarm.jpg" alt="TI Tracker 2" />
</div> 
```

这是JavaScript：

```
var TimeToFade = 1000.0;
var maxCount;
var count;

function SetVariables()
{
    maxCount = new Array(arguments.length);
    count = arguments.length + 1;

for (var x = 0; x < arguments.length; x++)
{
    maxCount[x] = arguments[x];
}
}

function fade(counter)
{
var eid, countx;

for (var x = 1; x < count; x++)
{
    countx = counter % maxCount[x-1];
    if (countx == 0)
        countx = maxCount[x-1];
    eid = "fade" + x + "Image" + countx;

    var element = document.getElementById(eid);
    if(element == null)
            return;

    if(element.FadeState == null)
    {
            if(element.style.opacity == null 
                || element.style.opacity == '' 
                || element.style.opacity == '1')
        {
            element.FadeState = 2;
        }
        else
        {
            element.FadeState = -2;
        }
    }

    if(element.FadeState == 1 || element.FadeState == -1)
    {
            element.FadeState = element.FadeState == 1 ? -1 : 1;
            element.FadeTimeLeft = TimeToFade - element.FadeTimeLeft;
    }
    else
    {
            element.FadeState = element.FadeState == 2 ? -1 : 1;
            element.FadeTimeLeft = TimeToFade;
            if (x == 3)
                setTimeout("animateFade(" + new Date().getTime() + ",'" + counter + "')", 33);
    }
}
}

function animateFade(lastTick, counter)
{
var eid, countx;

for (var x = 1; x < count; x++)
{
    countx = counter % maxCount[x-1];
    if (countx == 0)
        countx = maxCount[x-1];
    eid = "fade" + x + "Image" + countx;

    var curTick = new Date().getTime();
    var elapsedTicks = curTick - lastTick;

    var element = document.getElementById(eid);

    if(element.FadeTimeLeft <= elapsedTicks)
    {
        element.style.opacity = element.FadeState == 1 ? '1' : '0';
        element.style.filter = 'alpha(opacity = ' 
            + (element.FadeState == 1 ? '100' : '0') + ')';
        element.FadeState = element.FadeState == 1 ? 2 : -2;

        if (element.FadeState == 2 && x == count-1)
        {
            setTimeout(function(){fade(counter)}, 5000);
            hidetext(TextBlock1, TextBlock2, Text2Block1, Text2Block2, Text3Block1, Text3Block2);
        }
        else if (x == count-1)
        {
            counter++;
            fade(counter);
        }

        if (x == count-1)
            return;
    }
    else if (element.FadeTimeLeft > elapsedTicks)
    {
        element.FadeTimeLeft -= elapsedTicks;
        var newOpVal = element.FadeTimeLeft/TimeToFade;
        if(element.FadeState == 1)
            newOpVal = 1 - newOpVal;

        element.style.opacity = newOpVal;
        element.style.filter = 'alpha(opacity = ' + (newOpVal*100) + ')'; 
    }
}

setTimeout("animateFade(" + curTick + ",'" + counter + "')", 33);
}

function HideAll()
{
for (var i = 0; i < arguments.length; i++)
{
    arguments[i].style.opacity = 0;
    arguments[i].style.filter = 'alpha(opacity = 0)';
    arguments[i].FadeState = -2;
}
setTimeout(function(){fade(1)}, 5000);
} 
```

我看不出我做了什么来产生这个错误；任何帮助将不胜感激。

要查看实际代码，请单击[此处](http://www.ar-t.co.uk/New_Site)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T11:51:43.810

这并不能真正回答问题，但我从头开始重写了 javascript，它似乎可以工作。因此，为了完整起见，这里是：

```
var Count = new Array(1, 1, 1);
var MaxCount = new Array(8, 6, 5);
var FadeState = "out";
var FadeTime = new Array(100, 100, 100);

function Fade()
{
for (var x = 0; x < 3; x++)
{
    var id = "fade" + (x+1) + "Image" + Count[x];
    var element = document.getElementById(id)

    if (FadeState == "out")
    {
        if (FadeTime[x] > 0)
        {
            FadeTime[x]-= 5;

            element.style.filter = 'alpha(opacity = ' + FadeTime[x] + ')'; 
            element.style.opacity = FadeTime[x]/100;
        }
        else
        {
            Count[x]++;
            if (Count[x] > MaxCount[x])
                Count[x] = 1;

            if (x == 2)
                FadeState = "back";
        }
    }
    else
    {           
        if (FadeTime[x] < 100)
        {
            FadeTime[x]+= 5;

            element.style.filter = 'alpha(opacity = ' + FadeTime[x] + ')'; 
            element.style.opacity = FadeTime[x]/100;
        }
        else
        {
            if (x == 2)
                FadeState = "pause";
        }
    }
}

switch (FadeState)
{
    case "back":
        FadeState = "in";
        Fade();
        break;
    case "pause":
        FadeState = "out";
        setTimeout(function(){Fade()}, 5000);           
        break;
    default:
        setTimeout(function(){Fade()}, 20);
}
}

function HideAll()
{
for (var i = 0; i < arguments.length; i++)
{
    var element = document.getElementById(arguments[i]);
    element.style.opacity = 0;
    element.style.filter = 'alpha(opacity = 0)';
}
setTimeout(function(){Fade()}, 5000);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T15:14:42.973

`HideAll`当您调用该方法时，您需要在 id 周围加上引号

```
HideAll('fade1Image2', 'fade1Image3', 'fade1Image4', 'fade2Image2',
'fade2Image3', 'fade2Image4', 'fade3Image2', 'fade3Image3', 'fade3Image4') 
```

而且你需要在设置它们的样式之前实际找到元素..

```
function HideAll()
{
for (var i = 0; i < arguments.length; i++)
{
    var element = document.getElementById( arguments[i] );
    element.style.opacity = 0;
    element.style.filter = 'alpha(opacity = 0)';
    element.FadeState = -2;
}
setTimeout(function(){fade(1)}, 5000);
} 
```

# java - 如何检测浏览器选项卡中的关闭？

> ID：12485049
> 
> 赞同：1
> 
> 时间：2012-09-18T21:07:04.947
> 
> 标签：java, javascript, web-applications, browser

您好我正在寻找有关关闭选项卡（不是浏览器）事件的信息，如果在 java 中有一个用于小程序的事件。我想知道是否有一个事件或一种方法来检查一种方法来检查它。我只想捕获该事件并制作一个小弹出框，说明您的会话将过期或类似的内容。这完全有可能还是使用java或Javascript有可能？

更新：好吧，有了你们指出我的信息，我能够获得有关足够简单的 javascript 的信息。现在它在 IE、Chrome 和 Firefox 中运行良好，但出于某种原因 Safari 5.1.7 不喜欢该代码。不知道为什么。如果有帮助，这里是代码。

```
jQuery(function() {
var hiddenBtn = document.getElementById("javaform:browserCloseSubmit");

try{
    opera.setOverrideHistoryNavigationMode('compatible');
    history.navigationMode = 'compatible';
}catch(e){}

//Sends the information to the javaBean.java file. 
function ReturnMessage()
{
    return hiddenBtn.click();
}

//UnBind Function
function UnBindWindow()
{
    jQuery(window).unbind('beforeunload', ReturnMessage);
}

//Bind Exit Message Dialogue
jQuery(window).bind('beforeunload', ReturnMessage);

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:08:52.720

您拥有`onBeforeUnload`可以在 JavaScript 中捕获的事件。见[这里](https://stackoverflow.com/questions/1704533/intercept-page-exit-event)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-16T21:03:26.230

采用`window.onbeforeunload`

```
window.onbeforeunload = function () {
    return "Are you sure you want to exit?";
}; 
```

Note that it will also end in *Are you sure you want to leave this page* (or *are you sure you want to reload this page* if you are reloading)

# javascript - 如何处理 Parse.com 中的 URL 变量？

> ID：12485050
> 
> 赞同：0
> 
> 时间：2012-09-18T21:07:09.443
> 
> 标签：javascript, jquery, backbone.js, parse-platform

我通常通过访问来访问我的 Parse 应用程序`www.mysite.com`。

但是，我希望能够执行类似`www.mysite.com/code`or的操作`www.mysite.com?page=code`，并为此在应用程序中显示特定视图，而无需单击。换句话说，我想检测是否存在 GET 变量，并使用它来确定要显示的视图。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T23:03:36.913

您可以使用[Backbone 的 Router](http://documentcloud.github.com/backbone/#Router)。Anypic.org 源代码中有[一个示例可供](https://github.com/ParsePlatform/Anypic/blob/master/Anypic-web/js/anypic.js)您使用。

```
var AppRouter = Backbone.Router.extend({
routes: {
  "pic/:object_id": "getPic",
  "*actions": "defaultRoute"
},

getPic: function(object_id) {
  App.showLandingPage();

  var query = new Parse.Query(Photo);
  query.include("user");
  query.get(object_id, {
    success: function(photo) {
      App.landingPageView.showPhoto(photo);
    },
    error: function(object, error) {
      console.error(error);
      // The object was not retrieved successfully.
      // error is a Parse.Error with an error code and description.
      App.landingPageView.showError();
    }
  });
},

defaultRoute: function(actions) {
  App.showHomePage();
} 
```

});

在此示例中，导航到[https://anypic.org/pic/XXXXX](https://anypic.org/pic/XXXXX)将调用 getPic 并将 XXXXX 的值传递给 getPic 函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T23:06:20.110

我对 parse.com 不太熟悉，但如果您只想在 javascript 中访问 GET 变量，这并不是非常困难：

[http://www.onlineaspect.com/2009/06/10/reading-get-variables-with-javascript/](http://www.onlineaspect.com/2009/06/10/reading-get-variables-with-javascript/)

# django - Tastypie APIKey 认证

> ID：12485053
> 
> 赞同：12
> 
> 时间：2012-09-18T21:07:35.300
> 
> 标签：django, tastypie, api-key

Tastypie APIKey 身份验证如何工作？我知道文档中提到了一个信号：

```
from django.contrib.auth.models import User    
from django.db import models  
from tastypie.models import create_api_key 

models.signals.post_save.connect(create_api_key, sender=User) 
```

然而，这叫什么时候？如果我想给用户他们的 APIkey，我知道我可以在 APIKey db 中找到它，这个 create_api_key 函数将密钥添加到其中，但是我应该在何时何地调用这个 models.signals.post_save 函数？

这只是另一个 django 模型吗？我觉得是这样的？

每次保存用户帐户时都会调用它吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-18T22:32:39.017

您可以将其放在`models.py`相关应用程序的文件中（例如`main/`）。每次保存实例时`post_save.connect(create_api_key, sender=User)`都会调用它。`User``create_api_key()`

现在让我们通过深入研究[**一下 sweetpie**](https://bitbucket.org/dc/django-tastypie/src/ee13e251ace5/tastypie/models.py)`create_api_key()`的来源来看看有什么作用：[](https://bitbucket.org/dc/django-tastypie/src/ee13e251ace5/tastypie/models.py)

 **```
class ApiKey(models.Model):
    user = models.OneToOneField(User, related_name='api_key')
    key = models.CharField(max_length=256, blank=True, default='')
    created = models.DateTimeField(default=datetime.datetime.now)

    def __unicode__(self):
        return u"%s for %s" % (self.key, self.user)

    def save(self, *args, **kwargs):
        if not self.key:
            self.key = self.generate_key()

        return super(ApiKey, self).save(*args, **kwargs)

    def generate_key(self):
        # Get a random UUID.
        new_uuid = uuid.uuid4()
        # Hmac that beast.
        return hmac.new(str(new_uuid), digestmod=sha1).hexdigest()

def create_api_key(sender, **kwargs):
    """
    A signal for hooking up automatic ``ApiKey`` creation.
    """
    if kwargs.get('created') is True:
        ApiKey.objects.create(user=kwargs.get('instance')) 
```

如您所见，`create_api_key()`将创建一条`ApiKey`与调用相关的新记录`User`。此记录在保存到表时也将具有[HMAC密钥。](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code)`ApiKey`密钥由`generate_key()`函数生成。**

# command-line-interface - 如何让 accurev 找到移动的工作区？

> ID：12485063
> 
> 赞同：6
> 
> 时间：2012-09-18T21:08:01.643
> 
> 标签：command-line-interface, accurev

我在 AccuRev 中的 M:\EclipseWorkspaces\ 下创建了一个工作区。
该项目检查良好。

然后我将项目移动到 C:\EclipseWorkspaces\。
现在 AccuRev 认为该项目不存在。这可能是因为 AccuRev 正在我的 M 驱动器上寻找项目。

如何让 AccuRev 找到我的项目？

我正在使用 5.3 版。这台计算机很慢，所以我想使用 CLI 来执行此操作。

更新：我删除了 AccuRev 客户端中的工作区.... 我可以将 C 盘上的工作区添加到 AccuRev 中的流中吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T21:35:47.443

好的，所以我删除了流中的工作区（在 AccuRev 客户端中）......或者我想。AccuRev 实际上并没有删除工作区；AccuRev 停用工作区。

所以首先我必须重新激活它（使用 CLI）：

```
accurev reactivate wspace foo_workspace 
```

然后我不得不在 accurev 中更改工作区的位置

```
C:\EclipseWorkspace>accurev chws -w foo_workspace -l . 
```

注意：
-w 是你的工作空间的名称（必须是你的，不能是别人的；有 -s 的）
-l 是你想要更改物理位置的位置

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-18T21:19:25.653

这个更改您应该从客户端 GUI 重新激活工作区，使用流浏览器中的显示隐藏复选框来执行此操作。然后，您将使用的 cli 命令是：

accurev chws -w wspace-name -l C:\EclipseWorkspaces\

这会将 AccuRev 知道的工作空间位置分配到新的正确位置...

更新：您需要关闭并重新打开 gui 才能识别此更改...

# jquery - 使用 jquery tablesorter 更改子行颜色

> ID：12485065
> 
> 赞同：1
> 
> 时间：2012-09-18T21:08:07.163
> 
> 标签：jquery, tablesorter

我正在使用 tablesorter jquery add on 的修改版本。

[http://www.pengoworks.com/workshop/jquery/tablesorter/tablesorter.htm](http://www.pengoworks.com/workshop/jquery/tablesorter/tablesorter.htm)

我需要折叠的行采用一个 coloe 而不是父行的颜色。

即使我明确设置子颜色，它仍然被父行颜色取代。

我如何打破这种逻辑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T02:28:13.987

您只需要增加子行的[CSS 特异性](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)。唯一的问题是父行有一个跨行到子行的单元格，因此它不会与子行的其余部分一起设置样式。

试试这个css（当然用你想要的颜色）；[这是一个演示](http://jsfiddle.net/Mottie/tuM8h/)：

```
table.tablesorter .expand-child.odd td,
table.tablesorter .expand-child.even td {
    background: #7ff;
} 
```

# css - 加载自定义字体在 Firefox 14 中不起作用

> ID：12485066
> 
> 赞同：1
> 
> 时间：2012-09-18T21:08:12.567
> 
> 标签：css, firefox, font-face

我使用 Wordpress 开发了一个网站。我基于现有的 211 创建了我的自定义主题。

我正在使用自定义字体（.eot、.otf、.ttf），它们在除 Firefox 之外的每个浏览器中都能完美运行。

这是我在控制台中得到的：

![在此处输入图像描述](../Images/a2baa1c87a22df030032f0551b1cf5ea.png)

我已经添加了这个：

```
<FilesMatch "\.(ttf|ttc|otf|eot|woff)$">
  <IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
  </IfModule>
</FilesMatch>

AddType image/svg+xml svg svgz
AddEncoding gzip svgz
AddType application/vnd.ms-fontobject eot
AddType font/truetype ttf
AddType font/opentype otf
AddType application/x-font-woff woff 
```

到我的 apache 的配置文件。

我的字体在 /public_html/fonts

我的CSS看起来像这样：

```
@font-face {
    font-family: Technic;
    src: url(/fonts/technic.eot); /* IE9 Compat Modes */
    src: url(/fonts/technic.otf);
} 
```

我错过了什么？

谢谢！

# html - 基于由 SQL 查询填充的节点元素的更改值的 HTML 行结果的 XSL 替代背景颜色

> ID：12485067
> 
> 赞同：5
> 
> 时间：2012-09-18T21:08:12.373
> 
> 标签：html, sql, css, xslt

我需要帮助来设置来自 XSL 文件的 HTML 输出，以根据节点元素的值何时更改来生成具有交替背景颜色的行结果。数据来自 SQL Server 2008，查询结果按“DivisionName”的节点元素排序。

```
SELECT      
  d.DivisionName,
  CASE
        WHEN t.ActualFinish is not NULL
              THEN convert(varchar, datepart(mm, t.ActualFinish))+ '/' + convert(varchar, datepart(dd, t.ActualFinish)) + '/' + convert(varchar, datepart(yyyy, t.ActualFinish))
        ELSE ' '
  END AS "Date",
  r.RegionName, 
  t.Name, 
  CASE
        WHEN t.ScheduleByElement is not NULL
              THEN t.ScheduleByElement
        ELSE ' '
  END AS "ScheduleByElement",
  '' AS "Activity",
  '' AS "Team",
  CASE
        WHEN t.WatchStatus is not NULL
              THEN convert(varchar, datepart(mm, t.WatchStatus))+ '/' + convert(varchar, datepart(dd, t.WatchStatus)) + '/' + convert(varchar, datepart(yyyy, t.WatchStatus))
        ELSE ' '
  END AS "Status"
FROM           
  dbo.Tasks AS t 
        INNER JOIN dbo.Division AS d 
              ON t.fk_DivisionID = d.DivisionID 
        INNER JOIN dbo.Region AS r 
              ON t.fk_RegionID = r.RegionID
WHERE        
  (t.OutlineLevel = 3) 
  AND (t.ScheduleByElement <> '') 
  AND (t.FileName LIKE 'NVDE%')
  AND (t.ActualFinish is not NULL)
ORDER BY d.DivisionName, t.ActualFinish, r.RegionName 
FOR XML PATH('DivisonName'), ROOT('CCDN') 
```

下面列出了 XSL 文件的完整内容：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="html" indent="yes"/>
<xsl:template match="/ROOT">

    <table border="1" cellpadding="6">
        <tr bgcolor="#9acd32">
            <td>Division</td>
            <td>Date</td>
            <td>Region</td>
            <td>System Name</td>
            <td>Schedule by/Plan by Element</td>
            <td>Activity</td>
            <td>Deployment Engineering Team</td>
            <td>Status</td>
        </tr>

        <xsl:for-each select="CCDN/DivisonName [not(preceding-sibling::DivisionName[1]/@DivisionNameID = @DivisionNameID)]">
            <xsl:variable name="DivisionNameID" select="@DivisionNameID" />
            <xsl:variable name="bgcolor">
                <xsl:choose>
                    <xsl:when test="position() mod 2 = 1">#FFFFCC</xsl:when>
                    <xsl:otherwise>#CCFFFF</xsl:otherwise>
                </xsl:choose>
            </xsl:variable>

            <xsl:for-each select=".|following-sibling::DivisionName[@DivisionNameID = $DivisionNameID]">
                <tr bgcolor="{$bgcolor}">
                    <xsl:for-each select="./*">
                        <td>
                            <xsl:value-of select="." />
                        </td>
                    </xsl:for-each>
                </tr>
            </xsl:for-each>
        </xsl:for-each>

    </table>

</xsl:template> 
```

我在您的网站上搜索了与此类似的其他问题，但没有找到在特定节点元素的变化值上定义颜色的示例。目前，结果是表格在#FFFFCC 和#CCFFFF 之间交替每隔一行的背景颜色，而不管 DivisionName 的值。

以下 HTML 可能更好地说明了我正在寻找的结果。行根据分区 A、B、C 和 D 升序排序。与第一个分区相关的所有行都是一种阴影（白色）或颜色，与下一个分区相关的所有行都是另一种阴影或颜色，然后从那时起重复。如果没有为 A 返回行，则 B 将是白色和交替的。没有为特定除法值定义特定阴影或颜色的硬编码。无论返回的除法如何，它都会改变，并且只关心除法值是否发生变化。

```
<style type="text/css">
        table.mystyle
        {
        border-width: 0 0 1px 1px;
        border-spacing: 0;
        border-collapse: collapse;
        border-style: solid;
        }
        .mystyle td, .mystyle th
        {
        margin: 0;
        padding: 4px;
        border-width: 1px 1px 0 0;
        border-style: solid;
        }
        tr.oddcolor
        {
        Background-color:#FFFFFF;
        }
        tr.evencolor
        {
        Background-color:#CCCCCC;
        }
    </style>
<table class="mystyle">
<tr>
<b>
  <td>Division</td>
  <td>Date</td>
  <td>Region</td>
  <td>System Name</td>
  <td>Schedule by/Plan by Element</td>
  <td>Activity</td>
  <td>Deployment Engineering Team</td>
  <td>Status</td>
</b>
 </tr>
 <tr bgcolor="#FFFFCC">
  <td>A</td>
  <td>3/2/2012</td>
  <td>region</td>
  <td>xxx</td>
  <td>xxxx</td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr bgcolor="#FFFFCC">
  <td>A</td>
  <td>4/12/2012</td>
  <td>region</td>
  <td>xxx</td>
  <td>xxxx</td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr bgcolor="#FFFFCC">
  <td>A</td>
  <td>4/12/2012</td>
  <td>region</td>
  <td>xxx</td>
  <td>xxxx</td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr bgcolor="#CCFFFF">
  <td>B</td>
  <td>4/27/2012</td>
  <td>region</td>
  <td>xxx</td>
  <td>xxxx</td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr bgcolor="#CCFFFF">
  <td>B</td>
  <td>5/1/2012</td>
  <td>region</td>
  <td>xxx</td>
  <td>xxxx</td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr bgcolor="#FFFFCC">
  <td>C</td>
  <td>5/15/2012</td>
  <td>region</td>
  <td>xxx</td>
  <td>xxxx</td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr bgcolor="#FFFFCC">
  <td>C</td>
  <td>5/24/2012</td>
  <td>region</td>
  <td>xxx</td>
  <td>xxxx</td>
  <td></td>
  <td></td>
  <td></td>
</tr>
<tr bgcolor="#CCFFFF">
  <td>D</td>
  <td>5/25/2012</td>
  <td>region</td>
  <td>xxx</td>
  <td>xxxx</td>
  <td></td>
  <td></td>
  <td></td>
</tr>
</table> 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T12:44:31.297

那我再来一次狂欢。此方法依赖于已按部门排序的数据。

XML

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
    <row division="a">Data</row>
    <row division="a">D1123ta</row>
    <row division="b">Da123ta</row>
    <row division="b">Da14ta</row>
    <row division="b">Da12312ta</row>
    <row division="c">Da123ta</row>
    <row division="c">Dat123a</row>
    <row division="c">Da123ta</row>
    <row division="c">Dat123a</row>
    <row division="d">Da123ta</row>
    <row division="d">Dat123a</row>
</root> 
```

XSL

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="1.0">
    <xsl:output indent="yes"/>
    <xsl:key name="arb" match="/root/row" use="@division"/>
    <xsl:template match="/">
       <!-- <table>
            <xsl:for-each select="root/row">
                <xsl:if test="generate-id(.) = generate-id(key('arb',@division))">
                    <tr><td>New Colour</td></tr>
                </xsl:if>
                <tr><td><xsl:value-of select="."/></td></tr>
            </xsl:for-each>
        </table>-->
        <html>
            <body>
                <table>
            <xsl:for-each select="root/row[generate-id(.) = generate-id(key('arb',@division))]">
                <xsl:variable name="local_div" select="@division"/>
                <tbody>
                    <xsl:if test="position() mod 2 = 0">
                        <xsl:attribute name="bgcolor">red</xsl:attribute>
                    </xsl:if>
                    <xsl:for-each select="../row[@division=$local_div]">
                        <tr><td><xsl:value-of select="@division"/></td><td><xsl:value-of select="."/></td></tr>
                    </xsl:for-each>
                </tbody>
            </xsl:for-each>
        </table>
            </body>
        </html>

    </xsl:template>
</xsl:stylesheet> 
```

产品

```
<html>
<body>
  <table>
     <tbody>
        <tr>
           <td>a</td>
           <td>Data</td>
        </tr>
        <tr>
           <td>a</td>
           <td>D1123ta</td>
        </tr>
     </tbody>
     <tbody bgcolor="red">
        <tr>
           <td>b</td>
           <td>Da123ta</td>
        </tr>
        <tr>
           <td>b</td>
           <td>Da14ta</td>
        </tr>
        <tr>
           <td>b</td>
           <td>Da12312ta</td>
        </tr>
     </tbody>
     <tbody>
        <tr>
           <td>c</td>
           <td>Da123ta</td>
        </tr>
        <tr>
           <td>c</td>
           <td>Dat123a</td>
        </tr>
        <tr>
           <td>c</td>
           <td>Da123ta</td>
        </tr>
        <tr>
           <td>c</td>
           <td>Dat123a</td>
        </tr>
     </tbody>
     <tbody bgcolor="red">
        <tr>
           <td>d</td>
           <td>Da123ta</td>
        </tr>
        <tr>
           <td>d</td>
           <td>Dat123a</td>
        </tr>
     </tbody>
  </table>
</body>
</html> 
```

# objective-c - 无法在情节提要中将按钮\标签与变量\出口连接起来

> ID：12485073
> 
> 赞同：6
> 
> 时间：2012-09-18T21:08:37.303
> 
> 标签：objective-c, ios, cocoa-touch, storyboard

我创建了 2 个视图控制器：第一次我创建了一个按钮，当单击它时，您将打开另一个带有按钮和标签的视图控制器。我已经为他们创建了出口和变量。

**我的问题是：**当我尝试将 button\label 与 variable\outlet 连接时，我看不到 button\label 周围的选择 -> 我的意思是我无法将它们全部连接起来。为什么？

**PS 不要输入减号，我只是新程序员！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:22:20.400

您可以发布您的 IBOutlet 声明吗？您必须像这样声明 UIButtons 以使它们在 Interface Builder 中工作（连接）：

```
@property (nonatomic, strong) IBOutlet UIButton *aButton; 
```

对于标签，它是一样的：

```
@property (nonatomic, strong) IBOutlet UILabel *aLabel; 
```

我认为您要么忘记编写 IBOutlet，要么您的变量类型错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:31:03.813

好的！我解决了任务。

我只需要创建一个新的，在第二个**View Controller的****Identity Inspector**`Objective-C class`中选择该新类，然后在该新类中编写所有代码。

 ***** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-22T03:06:35.920

我也错过了这个。

对于仍然感到困惑的人，请在 Storyboard 中选择 View Controller（黄色框），然后在 Inspector 下选择![在此处输入图像描述](../Images/41b7912169a9e3a451373f18f9d3e8f8.png)Identity Inspector。见图像。

现在您将能够连接接口 .h 文件中的 IBOutlet 项目。

![在此处输入图像描述](../Images/72798d45c6afabd0f88a2866b2665413.png)

![在此处输入图像描述](../Images/55a3570e2b709d3d506853f3b0c5c01f.png)****

# html - 带有引用文本的href的HTML链接？

> ID：12485074
> 
> 赞同：22
> 
> 时间：2012-09-18T21:08:44.840
> 
> 标签：html, hyperlink, href

这是一个简单的是或否的问题（可能不是），谷歌搜索似乎没有给我一个直接的答案。假设您有一个链接

```
<a href="www.stackoverflow.com">www.stackoverflow.com</a> 
```

有没有可能做类似的东西

```
<a href=self.text>www.stackoverflow.com</a> 
```

不使用其他任何东西（显然，没有脚本）？有什么捷径吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-18T21:10:42.137

不，您需要在标签`href`之间同时具有属性和值。`a`不使用任何脚本，就不可能引用它自己的内容。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-18T21:55:27.630

使用锚链接有用的提示部分在同一文档中创建指向“有用提示部分”的链接：

访问有用的提示部分

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-09-18T21:12:49.187

我认为您正在寻找 Anchor Tag 。`<a href="link">`如果您通过在正文中的某处使用 a 来引用它，则可以使用语法链接到它。

在底部查看一些示例：

[http://www.w3schools.com/html/html_links.asp](http://www.w3schools.com/html/html_links.asp)

# javascript - 防止在移动浏览器上滚动，而不防止输入焦点

> ID：12485085
> 
> 赞同：6
> 
> 时间：2012-09-18T21:09:10.040
> 
> 标签：javascript, android, ios, browser, preventdefault

我在文档的 touchstart 上使用 preventDefault() 来防止在页面上滚动。不幸的是，这阻止了太多。用户不能再将焦点放在输入上（并打开软键盘）。使用 jQuery focus()，我可以将焦点放在 touchstart 上的输入上。这会在 iOS 上打开软键盘（大部分时间），但不会在 Android 上打开。

**背景**：

我有一个网页，我想让它尽可能地像一个移动应用程序。我只真正关心 Android 和 iOS，但任何形式的因素。我首先使页面中的内容与屏幕大小完全相同。这很好，直到用户将手指放在页面上。我需要防止用户滚动。下面的代码实现了这一点，但在两个操作系统上的方式略有不同。

```
$(document).on('touchstart', function(e) {
    e.preventDefault();
}); 
```

在 iOS 上，这可以防止弹性滚动：用户可以通过尝试滚动页面来显示网页背后的纹理。该功能非常适合常规网页，但在我的情况下，它会降低用户体验。

在 Android 上，防止泄露我用来隐藏地址栏的一个方便的 hack。Android 浏览器开始时地址栏是可见的，但当用户向下滚动页面时，它就会消失。要以编程方式强制浏览器隐藏地址栏，只需将这行代码添加到加载时调用的函数中。

```
$('html, body').scrollTop(1); 
```

这是告诉 android 浏览器我们已经滚动，并且不再需要地址栏的一种 hacky（但也是唯一）方法。

如果没有文档上的 preventDefault，Android 浏览器将允许滚动并且可以显示地址栏。

因此，两个操作系统都有充分的理由在文档的每个 touchstart 上调用此 preventDefault() ，但它阻止了太多。点击输入字段没有任何作用。使用对 jQuery focus() 的调用会有所帮助，但只能在 iOS 上打开软键盘，而不是在 Android 上。

```
$('input').on('touchstart', function() {
    $(this).focus();
}); 
```

**如何防止页面滚动，但使用浏览器本机功能将焦点放在输入字段上？**

注意：此代码

```
$(document).on('touchstart', function(e) {
    if (e.target.nodeName !== 'INPUT') {
        e.preventDefault();
    }
}); 
```

这是有缺陷的，因为只要初始触摸来自输入字段，用户仍然可以滚动页面。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T21:09:10.040

我实际上在另一个项目中解决了这个问题，忘记了它，并通过输入这个大部分方式记住了它。

他们的关键是在touchmove上做。

```
$(document).on('touchmove', function(e) {
    e.preventDefault();
}); 
```

但是，touchstart 上的 preventDefault 会做各种好事，比如在启用手势的幻灯片上阻止图像保存菜单。我的项目也包括这个。

```
$(document).on('touchstart', function(e) {
    if (e.target.nodeName !== 'INPUT') {
        e.preventDefault();
    }
}); 
```

如果有人对其他内容或如何重新格式化这些内容有一些建议，以便它可以接触到更多的观众，那就太好了。我从来没有在一个地方看到过我在这里的所有内容，所以我觉得它需要放在 SO 上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-01T10:21:22.173

您的问题的简单答案是不要使用“preventDefault”，而是使用指针事件 css 属性来禁用滚动元素的滚动。

输入的 CSS：

```
input {
    pointer-events: auto !important;
} 
```

touchstart 事件监听器：

```
document.body.addEventListener('touchstart', function(e) {
    if (e.target.nodeName === 'INPUT') {
        this.style.pointerEvents = 'none';
    }
}); 
```

当您模糊输入时，您将需要重置指针事件。

```
document.body.pointerEvents = 'auto'; 
```

+1 好问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-08T16:33:42.637

将两者结合起来！

```
// prevent scrolling from outside of input field
$(document).on('touchstart', function(e) {
    if (e.target.nodeName !== 'INPUT') {
        e.preventDefault();
    }
});

// prevent scrolling from within input field
$(document).on('touchmove', function(e) {
    if (e.target.nodeName == 'INPUT') {
        e.preventDefault();
    }
}); 
```

这可能也不完美，我特别担心第一个功能会阻止链接，但我会留给其他人做广泛的测试。

# memory-management - 与原生应用程序相比，phonegap 应用程序的内存占用量是多少？

> ID：12485088
> 
> 赞同：3
> 
> 时间：2012-09-18T21:09:22.810
> 
> 标签：memory-management, mobile, cordova

我正在评估 Phonegap (Cordova) 与其本机应用程序的优缺点。有没有人有任何基线信息，然后包括特性和功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T00:14:58.220

以下是使用 Cordova / Phonegap 的主要优点和缺点：

**Cordova / Phonegap 的优点：**

1.  您只需要 HTML5/CSS/Javascript 技能，并且不需要任何特定的 Objective-C 知识，这使得创建应用程序的事情变得更简单。
2.  您拥有适用于所有平台（iOS、Android、Windows 7、移动网络）的单一代码库，这意味着您可以非常快速地为多个平台部署应用程序！
3.  快速测试和部署（直到你Phonegap它，此时你会受到App Store审查条件等的约束）
4.  使用 Phonegap，您仍然可以通过 App Store 或 Android Market 进行分发和集成支付

**Cordova / Phonegap 的缺点：**

1.  性能不佳，特别是如果您的应用程序图形密集（例如：像游戏）。您可以实现缓存或利用一些 3rd 方解决方案（即 Sibblingz）来实现本机图形加速；但在大多数情况下，本机应用程序比移动 Web 应用程序更快/更流畅

2.  缺少预先构建的 UI 小部件、过渡、标准控件等。您的开发时间可能会更长，尤其是如果您想要具有原生外观和感觉的精美应用程序。您可以尝试使用 Sencha Touch、JQuery Mobile、插件或具有预构建 UI 元素的类似工具，但您可能仍需要花费大量时间来设计应用程序以使其看起来像原生。

* * *

所以，在我看来，如果你想为你的应用程序包含“完整的功能”（比如良好的性能、快速的应用程序、访问原生组件等），你最好创建一个原生应用程序。

Phonegap / Cordova 更像是一个方便的工具，可以非常快速且以更简单的方式创建“类似 Web 的应用程序”（尤其是如果您已经了解 HTML/Javascript/CSS，例如）。如果你想要一个不太复杂的应用程序，你想快速部署你的应用程序，和/或你对 HTML/javascript/CSS 感觉很舒服，但对 Objective-C 不满意，我认为你会使用 Phonegap / Cordova。

* * *

希望这些答案有所帮助。

# sql - 使用 JPQL/Hibernate 在多对多关系中选择项目

> ID：12485095
> 
> 赞同：0
> 
> 时间：2012-09-18T21:09:48.117
> 
> 标签：sql, hibernate, playframework, jpql

如何轻松选择类别为 id x 的类别的模型文章的记录。文章和类别之间存在多对多关系。（链接字段int eh文章模型是类别。）

我必须构建查询，因为它根据一组变量提供了一个包含可用文章的列表。例如，我尝试了类似的东西（但显然不起作用）：

```
 if(categoryFilter != null){
        sql += "ANY categories.id = " + categoryFilter.id + " AND " ;
    } 
```

然后对于查询：

```
("site.app = ? AND " + sql + "removed = 0", app) 
```

我以前做过，但不记得了。我在 Play 上使用 Hibernate！框架。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:53:07.967

```
select article from Article article
inner join article.categories category
where category.id = :categoryId 
```

请参阅有关 HQL 以及关联和连接的[Hibernate 文档。](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#queryhql-joins)

# javascript - 并非所有朋友都使用 Facebook API 显示

> ID：12485100
> 
> 赞同：0
> 
> 时间：2012-09-18T21:10:43.580
> 
> 标签：javascript, facebook, facebook-apps

我正在使用 FB.api('me/friends'...) 来获取 facebook 好友列表，但是我没有收到 150 个（那是我所有的 FB 好友），而是收到了 147 个。是否有任何隐私设置允许用户不会出现在这个 API 函数结果上？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T09:40:25.700

# python - 组合从循环中获得的查询集

> ID：12485101
> 
> 赞同：0
> 
> 时间：2012-09-18T21:10:43.823
> 
> 标签：python, django, django-queryset

假设我有一个可以“关注”的人员列表。

我想遍历某个用户正在关注的所有人，并以查询集的形式从所有这些用户那里获取帖子。

我知道我可以通过使用链或 | 来组合查询集，但是在组合查询集时我有点困惑，我可能会从被跟踪的每个人中循环获取。

```
 following = UserFollows.objects.filter(user_id = user.id)
    for follow in following.iterator():
        UserPost.objects.filter(user=follow.user) #what do I do with this? 
```

如果我不能明确地将它们命名为链或“|”，我将如何组合它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:18:10.397

你可以这样做：

```
following = UserFollows.objects.filter(user__id = user.id).select_related('user')
users_ids = [follow.user.id for follow in following]
posts = UserPost.objects.filter(user__id__in=users_ids) 
```

但是看起来这是一个相当昂贵的操作，所以最好`select_related()`在一个查询中添加方法来获取用户。我认为您还应该考虑`users_ids`在从数据库中获取列表之前对其进行缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:22:52.933

你有没有尝试过类似的东西

```
following = UserFollows.objects.filter(user_id = user.id)
q = UserPost.objects.filter(user=following[0].user) 
for follow in following[1:]:
     q = q | UserPost.objects.filter(user=follow.user) 
```

# python - 导入与祖父包同名的模块

> ID：12485109
> 
> 赞同：4
> 
> 时间：2012-09-18T21:11:22.783
> 
> 标签：python, flask

在 Python 2.6.6 中，我有一个与其祖父母名称相同的模块。我的项目结构（使用 Flask 的网络应用程序）大致如下所示：

```
panel/
  run.py
  panel/
    __init__.py
    database.py
    views/
      __init__.py
      root.py
      dash.py
      panel.py
    users/
      __init__.py
      models.py 
```

请注意，run.py 旁边的包名称是**panel**。我还有一个名为**panel.views.panel**的模块。如果从 panel/__init__.py 中导入 panel.views.panel，使用以下三种样式中的任何一种：

```
from panel.views import panel
from panel.views import panel as panel_view
import panel.views.panel as panel_view 
```

导入**panel.py**后，我的其他导入都不起作用。例如，panel.users.models 尝试导入 database.py，并抛出此回溯：

```
Traceback (most recent call last):
  File "run.py", line 5, in <module>
    from panel import app
  File "/opt/www/panel/panel/__init__.py", line 8, in <module>
    from panel.views import root
  File "/opt/www/panel/panel/views/root.py", line 9, in <module>
    from panel import database;
ImportError: cannot import name database 
```

我在#pocoo IRC 频道与一些人交谈，根据他们的描述，问题在于从views/root.py 中，Python 认为`import panel.database`意味着`database`从它旁边的**panel.py导入。**

不过，这对我来说没有意义，因为[PEP 328](http://www.python.org/dev/peps/pep-0328/)概述了（看起来像）这个确切的问题，并将绝对导入作为默认值以解决此问题。我使用的是 Python 2.6.6，所以这应该是默认设置。不过可以肯定的是，我添加了这一行`from __future__ import absolute_import`，但这并没有什么不同；导入 database.py 发生同样的错误。

重命名**panel.py**解决了这个问题，但是，我非常想知道为什么它在编写时不起作用，特别是如果我可以做任何事情来使它工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T23:47:21.347

你说你添加了 line `from __future__ import absolute_import`，但你没有说你添加到哪个文件。请务必将其添加到 root.py。

python 教程的这一部分解释了你的情况发生了什么：http: [//docs.python.org/tutorial/modules.html#intra-package-references](http://docs.python.org/tutorial/modules.html#intra-package-references)

# javascript - 使用 ajax 调用显示加载状态

> ID：12485113
> 
> 赞同：0
> 
> 时间：2012-09-18T21:11:53.143
> 
> 标签：javascript

我正在寻找一种 JavaScript 解决方案，以在发生 ajax 请求时显示某种状态。我试过`document.getElementById("status").innerHTML = "<h2>Loading....</h2>";`了，但没有用。有任何想法吗？

```
function codesDelete(id) {
    var ajax;
    if (window.XMLHttpRequest) {
        ajax = new XMLHttpRequest();
    } else {
        ajax = new ActiveXObject("Microsoft.XMLHTTP");
    }

    ajax.onreadystatechange = function() {
        if (ajax.readyState === 4 && ajax.status === 200) {
            document.getElementById("status").innerHTML = "<h2>Data Deleted!</h2>";
        }
    }

    // this is what i tried
    document.getElementById("status").innerHTML = "<h2>Loading....</h2>";

    ajax.open("GET", "code.php?id=" + id, true);
    ajax.send();

    setTimeout(function() {
        document.getElementById("status").style.display = "none";
    }, 3000);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:14:39.553

您可以使用 JQuery 的何时/完成。启动您的状态指示器，然后使用 when/done 像这样：

```
// start the status indicator wherever it's appropriate    
StartStatusIndicator();

//Make your ajax call
$.when($.ajax({
    type: "POST",
    ...more stuff...
    success: function (json) {
        ...even more stuff...
    }
})).done(function () {
    KillYourStatusIndicator();
}); 
```

`done`当 ajax 调用完成时，里面的代码会被触发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:26:00.917

您可以做的另一种方法是在 jQuery.ajax 上使用`beforeSend`和回调，如下所示：`complete`

```
$.ajax({
    beforeSend:function(){
        // Create and insert your loading message here as you desire
        // For example, a version of what you were trying to do would be:
        $("#status").html("<h2>Loading....</h2>");
    },
    // ... whatever other things you need, such as a success callback, data, url, etc
    complete: function(){
       // Remove your loading message here, for example:
       $("#status").html("");
    }
}); 
```

顾名思义，`beforeSend`将在 AJAX 调用之前执行。`Complete`将在调用完成后执行，无论 AJAX 是成功还是失败。

# java - 实现基于 Web 的数据浏览器的最佳方式是什么？

> ID：12485114
> 
> 赞同：0
> 
> 时间：2012-09-18T21:11:54.257
> 
> 标签：java, javascript, ajax, web

这是我的问题：

我在网络服务器上的数据文件中有一堆 2D 点，我想将这些点从服务器传输到客户端浏览器并显示在他的浏览器上。用户需要具有缩放（放大/缩小）、平移（拖动）和选择二维数据画布上点区域的选项。

WRT上面的场景，最好的实现方式是什么？我可以使用 javascript + ajax 或使用 java applet 吗？我可以通过将数据点转换为图像然后进行图像处理来提高性能吗？

谢谢！舒敏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:14:04.483

我会使用 HTML5 和画布，或者只是一个好的 JavaScript 图形库。

Java 小程序是 1995 年的技术。谁在乎跳舞的茶壶了？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:58:17.347

[在http://datavisualization.ch/tools/](http://datavisualization.ch/tools/)和[https://en.wikipedia.org/wiki/Data_visualization](https://en.wikipedia.org/wiki/Data_visualization)上有数据可视化工具列表。如果您对数据[可视化](/questions/tagged/visualization "显示标记为“可视化”的问题")和[图表](/questions/tagged/charts "显示标记为“图表”的问题")感兴趣，[http:](http://reddit.com/r/visualization) //reddit.com/r/visualization、http [://flowingdata.com/](http://flowingdata.com/)和[http://visual.ly/](http://visual.ly/)是很好的资源。爱德华·塔夫特。[http://dygraphs.com/](http://dygraphs.com/)和[http://square.github.com/cubism/](http://square.github.com/cubism/) [ [http://d3js.org/](http://d3js.org/) ] 看起来很棒。D3JS 库中列出了很多很酷的数据可视化：[https](https://github.com/mbostock/d3/wiki/Gallery) ://github.com/mbostock/d3/wiki/Gallery 。例如，[http://mbostock.github.com/d3/talk/20111116/iris-splom.html](http://mbostock.github.com/d3/talk/20111116/iris-splom.html)示例显示了具有额外分类维度的二维数据。

# python - 引发包含 unicode 文字 (u"\u0410") 的异常时没有输出来赢得控制台

> ID：12485115
> 
> 赞同：4
> 
> 时间：2012-09-18T21:11:57.220
> 
> 标签：python, encoding, console, windows-console, unicode-literals

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-28T22:49:09.073

当要打印异常并给出 Unicode 消息时，Python 会尝试使用`sys.getdefaultencoding()`. 如果它失败了，编码错误就会被抑制，你会得到奇怪的输出。

在打印情况下，Unicode 字符串使用`sys.stdout.encoding`. 是的，如果使用 excepthook`sys.stderr.encoding`而不是`sys.getdefaultencoding()`.

请注意，以下工作。

```
raise LookupError(u"symbol: \u0411".encode(your_encoding)) 
```

您还可以通过调用更改`sitecustomize`或更改默认编码。您的系统应配置为默认编码等于（以及其他标准流的编码）。`usercustomize``sys.setdefaultencoding(your_encoding)``sys.stderr.encoding`

此外，这个问题在 Python 3 中不再存在。

# asp.net-mvc-4 - MVC4 / DotNetOpenAuth 中的自定义 OAuth 客户端 - 缺少访问令牌密码

> ID：12485117
> 
> 赞同：5
> 
> 时间：2012-09-18T21:12:13.540
> 
> 标签：asp.net-mvc-4, dotnetopenauth

我目前正在为我的应用程序实现一个 Dropbox OAuth 客户端。在我完成之前，这是一个相当轻松的过程。授权后，当我尝试访问用户数据时，我会从 Dropbox 收到关于令牌无效的 401。我在 Dropbox 论坛上问过，看起来我的请求缺少 Dropbox 返回的 access_token_secret。我能够使用 Fiddler 挖掘出秘密并将其添加到我的请求 url 并且它工作正常，所以这绝对是问题所在。那么为什么 DotNetOpenAuth 在返回访问令牌时不返回访问令牌秘密呢？

作为参考，我的代码：

```
public class DropboxClient : OAuthClient
{
    public static readonly ServiceProviderDescription DropboxServiceDescription = new ServiceProviderDescription
    {
        RequestTokenEndpoint = new MessageReceivingEndpoint("https://api.dropbox.com/1/oauth/request_token", HttpDeliveryMethods.GetRequest | HttpDeliveryMethods.AuthorizationHeaderRequest),
        UserAuthorizationEndpoint = new MessageReceivingEndpoint("https://www.dropbox.com/1/oauth/authorize", HttpDeliveryMethods.GetRequest | HttpDeliveryMethods.AuthorizationHeaderRequest),
        AccessTokenEndpoint = new MessageReceivingEndpoint("https://api.dropbox.com/1/oauth/access_token", HttpDeliveryMethods.GetRequest | HttpDeliveryMethods.AuthorizationHeaderRequest),
        TamperProtectionElements = new ITamperProtectionChannelBindingElement[] { new PlaintextSigningBindingElement() }
    };

    public DropboxClient(string consumerKey, string consumerSecret) : 
        this(consumerKey, consumerSecret, new AuthenticationOnlyCookieOAuthTokenManager())
    {
    }

    public DropboxClient(string consumerKey, string consumerSecret, IOAuthTokenManager tokenManager) : 
        base("dropbox", DropboxServiceDescription, new SimpleConsumerTokenManager(consumerKey, consumerSecret, tokenManager))
    {
    }

    protected override DotNetOpenAuth.AspNet.AuthenticationResult VerifyAuthenticationCore(DotNetOpenAuth.OAuth.Messages.AuthorizedTokenResponse response)
    {            
        var profileEndpoint = new MessageReceivingEndpoint("https://api.dropbox.com/1/account/info", HttpDeliveryMethods.GetRequest);
        HttpWebRequest request = this.WebWorker.PrepareAuthorizedRequest(profileEndpoint, response.AccessToken);

        try
        {
            using (WebResponse profileResponse = request.GetResponse())
            {
                using (Stream profileResponseStream = profileResponse.GetResponseStream())
                {
                    using (StreamReader reader = new StreamReader(profileResponseStream))
                    {
                        string jsonText = reader.ReadToEnd();
                        JavaScriptSerializer jss = new JavaScriptSerializer();
                        dynamic jsonData = jss.DeserializeObject(jsonText);
                        Dictionary<string, string> extraData = new Dictionary<string, string>();
                        extraData.Add("displayName", jsonData.display_name ?? "Unknown");
                        extraData.Add("userId", jsonData.uid ?? "Unknown");
                        return new DotNetOpenAuth.AspNet.AuthenticationResult(true, ProviderName, extraData["userId"], extraData["displayName"], extraData);
                    }
                }
            }
        }
        catch (WebException ex)
        {
            using (Stream s = ex.Response.GetResponseStream())
            {
                using (StreamReader sr = new StreamReader(s))
                {
                    string body = sr.ReadToEnd();
                    return new DotNetOpenAuth.AspNet.AuthenticationResult(new Exception(body, ex));
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T14:21:40.833

我在寻找类似问题的解决方案时发现了您的问题。我通过制作 2 个新课程解决了这个问题，您可以在这篇[coderwall 帖子](http://coderwall.com/p/rznlfg)中了解这些内容。

我还将在此处复制并粘贴完整的帖子：

* * *

DotNetOpenAuth.AspNet 401 未经授权的错误和持久访问令牌秘密修复

在设计我们的云电子书管理器 QuietThyme 时，我们知道每个人都和我们一样讨厌创建新帐户。我们开始寻找可以用来进行社交登录的 OAuth 和 OpenId 库。我们最终使用该`DotNetOpenAuth.AspNet`库进行用户身份验证，因为它立即支持 Microsoft、Twitter、Facebook、LinkedIn 和 Yahoo 以及许多其他公司。虽然我们在设置这一切时遇到了一些问题，但最终我们只需要进行一些小的自定义即可使其大部分工作（在[之前的 coderwall 帖子中描述）](http://coderwall.com/p/j9essg)）。我们注意到，与其他所有客户端不同，LinkedIn 客户端不会进行身份验证，从 DotNetOpenAuth 返回 401 Unauthorized Error。很快就发现这是由于签名问题造成的，在查看源代码后，我们能够确定检索到的 AccessToken 密钥没有与经过身份验证的配置文件信息请求一起使用。

这确实是有道理的，OAuthClient 类不包含检索到的访问令牌秘密的原因是它通常不需要用于身份验证目的，这是 ASP.NET OAuth 库的主要目的。

我们需要在用户登录后针对 api 发出经过身份验证的请求，以检索一些标准的个人资料信息，包括电子邮件地址和全名。我们可以通过临时使用 InMemoryOAuthTokenManager 来解决这个问题。

```
public class LinkedInCustomClient : OAuthClient
{
    private static XDocument LoadXDocumentFromStream(Stream stream)
    {
        var settings = new XmlReaderSettings
        {
            MaxCharactersInDocument = 65536L
        };
        return XDocument.Load(XmlReader.Create(stream, settings));
    }

    /// Describes the OAuth service provider endpoints for LinkedIn.
    private static readonly ServiceProviderDescription LinkedInServiceDescription =
            new ServiceProviderDescription
            {
                AccessTokenEndpoint =
                        new MessageReceivingEndpoint("https://api.linkedin.com/uas/oauth/accessToken",
                        HttpDeliveryMethods.PostRequest),
                RequestTokenEndpoint =
                        new MessageReceivingEndpoint("https://api.linkedin.com/uas/oauth/requestToken?scope=r_basicprofile+r_emailaddress",
                        HttpDeliveryMethods.PostRequest),
                UserAuthorizationEndpoint =
                        new MessageReceivingEndpoint("https://www.linkedin.com/uas/oauth/authorize",
                        HttpDeliveryMethods.PostRequest),
                TamperProtectionElements =
                        new ITamperProtectionChannelBindingElement[] { new HmacSha1SigningBindingElement() },
                //ProtocolVersion = ProtocolVersion.V10a
            };

    private string ConsumerKey { get; set; }
    private string ConsumerSecret { get; set; }

    public LinkedInCustomClient(string consumerKey, string consumerSecret)
        : this(consumerKey, consumerSecret, new AuthenticationOnlyCookieOAuthTokenManager()) { }

    public LinkedInCustomClient(string consumerKey, string consumerSecret, IOAuthTokenManager tokenManager)
        : base("linkedIn", LinkedInServiceDescription, new SimpleConsumerTokenManager(consumerKey, consumerSecret, tokenManager))
    {
        ConsumerKey = consumerKey;
        ConsumerSecret = consumerSecret;
    }

    //public LinkedInCustomClient(string consumerKey, string consumerSecret) :
    //    base("linkedIn", LinkedInServiceDescription, consumerKey, consumerSecret) { }

    /// Check if authentication succeeded after user is redirected back from the service provider.
    /// The response token returned from service provider authentication result. 
    [SuppressMessage("Microsoft.Design", "CA1031:DoNotCatchGeneralExceptionTypes",
        Justification = "We don't care if the request fails.")]
    protected override AuthenticationResult VerifyAuthenticationCore(AuthorizedTokenResponse response)
    {
        // See here for Field Selectors API http://developer.linkedin.com/docs/DOC-1014
        const string profileRequestUrl =
            "https://api.linkedin.com/v1/people/~:(id,first-name,last-name,headline,industry,summary,email-address)";

        string accessToken = response.AccessToken;

        var profileEndpoint =
            new MessageReceivingEndpoint(profileRequestUrl, HttpDeliveryMethods.GetRequest);

        try
        {
            InMemoryOAuthTokenManager imoatm = new InMemoryOAuthTokenManager(ConsumerKey, ConsumerSecret);
            imoatm.ExpireRequestTokenAndStoreNewAccessToken(String.Empty, String.Empty, accessToken, (response as ITokenSecretContainingMessage).TokenSecret);
            WebConsumer w = new WebConsumer(LinkedInServiceDescription, imoatm);

            HttpWebRequest request = w.PrepareAuthorizedRequest(profileEndpoint, accessToken);

            using (WebResponse profileResponse = request.GetResponse())
            {
                using (Stream responseStream = profileResponse.GetResponseStream())
                {
                    XDocument document = LoadXDocumentFromStream(responseStream);
                    string userId = document.Root.Element("id").Value;

                    string firstName = document.Root.Element("first-name").Value;
                    string lastName = document.Root.Element("last-name").Value;
                    string userName = firstName + " " + lastName;

                    string email = String.Empty;
                    try
                    {
                        email = document.Root.Element("email-address").Value;
                    }
                    catch(Exception)
                    {
                    }

                    var extraData = new Dictionary<string, string>();
                    extraData.Add("accesstoken", accessToken);
                    extraData.Add("name", userName);
                    extraData.AddDataIfNotEmpty(document, "headline");
                    extraData.AddDataIfNotEmpty(document, "summary");
                    extraData.AddDataIfNotEmpty(document, "industry");

                    if(!String.IsNullOrEmpty(email))
                    {
                        extraData.Add("email",email);
                    }

                    return new AuthenticationResult(
                        isSuccessful: true, provider: this.ProviderName, providerUserId: userId, userName: userName, extraData: extraData);
                }
            }
        }
        catch (Exception exception)
        {
            return new AuthenticationResult(exception);
        }
    }
} 
```

这是从 Microsoft 编写的基本 LinkedIn 客户端更改的部分。

```
InMemoryOAuthTokenManager imoatm = new InMemoryOAuthTokenManager(ConsumerKey, ConsumerSecret);
imoatm.ExpireRequestTokenAndStoreNewAccessToken(String.Empty, String.Empty, accessToken, (response as ITokenSecretContainingMessage).TokenSecret);
WebConsumer w = new WebConsumer(LinkedInServiceDescription, imoatm);

HttpWebRequest request = w.PrepareAuthorizedRequest(profileEndpoint, accessToken); 
```

不幸的是，该`IOAuthTOkenManger.ReplaceRequestTokenWithAccessToken(..)`方法直到方法返回后才会执行`VerifyAuthentication()`，因此我们必须创建一个新的 TokenManager 并`WebConsumer`使用`HttpWebRequest`我们刚刚检索到的 AccessToken 凭据创建一个和。

这解决了我们简单的 401 Unauthorized 问题。

现在，如果您想在身份验证过程之后保留 AccessToken 凭据，会发生什么？例如，这对于 DropBox 客户端可能很有用，您希望将文件异步同步到用户的 DropBox。问题可以追溯到 AspNet 库的编写方式，假设 DotNetOpenAuth 仅用于用户身份验证，而不是作为进一步 OAuth api 调用的基础。值得庆幸的是，修复相当简单，我所要做的就是修改基础`AuthetnicationOnlyCookieOAuthTokenManger`，以便该`ReplaceRequestTokenWithAccessToken(..)`方法存储新的 AccessToken 密钥和秘密。

```
/// <summary>
/// Stores OAuth tokens in the current request's cookie
/// </summary>
public class PersistentCookieOAuthTokenManagerCustom : AuthenticationOnlyCookieOAuthTokenManager
{
    /// <summary>
    /// Key used for token cookie
    /// </summary>
    private const string TokenCookieKey = "OAuthTokenSecret";

    /// <summary>
    /// Primary request context.
    /// </summary>
    private readonly HttpContextBase primaryContext;

    /// <summary>
    /// Initializes a new instance of the <see cref="AuthenticationOnlyCookieOAuthTokenManager"/> class.
    /// </summary>
    public PersistentCookieOAuthTokenManagerCustom() : base()
    {
    }

    /// <summary>
    /// Initializes a new instance of the <see cref="AuthenticationOnlyCookieOAuthTokenManager"/> class.
    /// </summary>
    /// <param name="context">The current request context.</param>
    public PersistentCookieOAuthTokenManagerCustom(HttpContextBase context) : base(context)
    {
        this.primaryContext = context;
    }

    /// <summary>
    /// Gets the effective HttpContext object to use.
    /// </summary>
    private HttpContextBase Context
    {
        get
        {
            return this.primaryContext ?? new HttpContextWrapper(HttpContext.Current);
        }
    }

    /// <summary>
    /// Replaces the request token with access token.
    /// </summary>
    /// <param name="requestToken">The request token.</param>
    /// <param name="accessToken">The access token.</param>
    /// <param name="accessTokenSecret">The access token secret.</param>
    public new void ReplaceRequestTokenWithAccessToken(string requestToken, string accessToken, string accessTokenSecret)
    {
        //remove old requestToken Cookie
        //var cookie = new HttpCookie(TokenCookieKey)
        //{
        //    Value = string.Empty,
        //    Expires = DateTime.UtcNow.AddDays(-5)
        //};
        //this.Context.Response.Cookies.Set(cookie);

        //Add new AccessToken + secret Cookie
        StoreRequestToken(accessToken, accessTokenSecret);

    }

} 
```

然后要使用它`PersistentCookieOAuthTokenManager`，您需要做的就是修改您的 DropboxClient 构造函数，或您希望保留 AccessToken Secret 的任何其他客户端

```
 public DropBoxCustomClient(string consumerKey, string consumerSecret)
        : this(consumerKey, consumerSecret, new PersistentCookieOAuthTokenManager()) { }

    public DropBoxCustomClient(string consumerKey, string consumerSecret, IOAuthTokenManager tokenManager)
        : base("dropBox", DropBoxServiceDescription, new SimpleConsumerTokenManager(consumerKey, consumerSecret, tokenManager))
    {} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T21:48:32.080

在进行了一些挖掘之后，我能够通过更改构造函数逻辑来解决这个问题，如下所示：

```
public DropboxClient(string consumerKey, string consumerSecret) : 
    this(consumerKey, consumerSecret, new AuthenticationOnlyCookieOAuthTokenManager())
{
}

public DropboxClient(string consumerKey, string consumerSecret, IOAuthTokenManager tokenManager) : 
    base("dropbox", DropboxServiceDescription, new SimpleConsumerTokenManager(consumerKey, consumerSecret, tokenManager))
{
} 
```

变成

```
public DropboxClient(string consumerKey, string consumerSecret) : 
        base("dropbox", DropboxServiceDescription, consumerKey, consumerSecret)
    {
    } 
```

挖掘 DNOA 源代码表明，如果您仅使用使用者密钥和秘密构造 OAuthClient（我的基类），它将使用 InMemoryOAuthTokenManager 而不是 SimpleConsumerTokenManager。我不知道为什么，但现在我的访问令牌秘密已正确附加到授权请求中的签名中，并且一切正常。希望这对其他人有帮助。与此同时，我可能会为一篇博客文章清理这个问题，因为网络上（我可以找到）这样做的指导**为零。**

编辑：我将撤消我的回答，因为正如一位同事指出的那样，这将处理一个请求，但现在我正在使用内存管理器，一旦我往返完全回到浏览器（我假设）。所以我认为这里的根本问题是我需要获取访问令牌秘密，我还没有看到如何去做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T18:30:55.213

OAuthClient 类不包含访问令牌秘密的原因是它通常不需要用于身份验证目的，这是 ASP.NET OAuth 库的主要目的。

也就是说，如果您想在您的情况下检索访问令牌秘密，您可以覆盖 VerifyAuthentication() 方法，而不是像上面所做的那样使用 VerifyAuthenticationCore()。在 VerifyAuthentication() 中，您可以调用 WebWorker.ProcessUserAuthorization() 来验证登录，并从返回的 AuthorizedTokenResponse 对象中访问令牌密钥。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-30T12:10:10.830

至于您最初的问题，即未在响应中提供秘密 - 当您在 verifyAuthenticationCore 函数中获得响应时，秘密就在那里。你得到他们两个像这样：

```
 string token = response.AccessToken; ;
  string secret = (response as ITokenSecretContainingMessage).TokenSecret; 
```

# .htaccess - 将 %{QUERY_STRING} 重定向到友好的 url

> ID：12485120
> 
> 赞同：1
> 
> 时间：2012-09-18T21:12:45.880
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

我正在尝试添加最后一项改进（关于 htaccess），那就是我希望它重定向`/?mod=inicio`到`/inicio`. 所以我试图用下面的代码来做，但它一直在构建这样的 url`/inicio?mod=inicio`

```
RewriteCond %{QUERY_STRING} ^mod=([a-z]+)$ [NC]
RewriteRule .* /%1 [L] 
```

与额外参数相同的事情：从`/?mod=x&type=y-z`到`/x/y-z`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:16:37.387

请尝试以下规则：

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /\?mod=([a-z]+)&type=([a-z\-]+)
RewriteRule ^ /%1/%2? [L]

RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /\?mod=([a-z]+)($|\ )
RewriteRule ^ /%1? [L] 
```

关键是匹配实际请求而不是 URI，因为您的其他规则（来自您之前的问题）将导致这些重写匹配，它们会相互冲突。另一个关键点是`?`在目标（例如）的末尾包含 a ，这样*就不会附加*`/%1/%2?`查询字符串。

# javascript - 在通过 JavaScript 提交之前更改表单值

> ID：12485124
> 
> 赞同：1
> 
> 时间：2012-09-18T21:13:02.457
> 
> 标签：javascript, html, forms

我在类似问题上遇到了很多问题，但似乎无法使其正常工作。我想要做的是当单击按钮时，将表单字段的值替换为“现在”一词，然后提交表单。最初，HTML 表单如下所示：

```
<tr id="row43" bgcolor="#FF0000">
<form id="form43" name="loggingUpdate" action="index.php" method="POST">
<td>PersonsName</td><td>SGS 1-26</td>
<td><input type="text" name="takeoff" id="takeoff43"/><a href='#' onclick='startTakeoff(43);return false;'><img alt='Start Now' src='brush_24.png' border='0'></a></td>
<td><input type="text" name="landing" /></td><td>0 Mins</td>
<td><input type="text" name="towHeight" /></td>
<td><input type="hidden" name="flightIndex" value="43"/><input type="submit" value="Update..." />  <a href=deleteEntry.php?flightIndex=43><img src="close_24.png" /></a></td>
</form></tr> 
```

onclick触发的Javascript如下图：

```
function startTakeoff(flightIndex) { 
    var flightForm = document.getElementById("form"+flightIndex);
    var flightRow = document.getElementById("row"+flightIndex);

    flightRow.cells[2].innerHTML = "<input type=\"text\" name=\"takeoff\" value=\"now\"><a href=\"#\" onclick=\"startTakeoff(43);return false;\"><img alt=\"Start Now\" src=\"brush_24.png\" border=\"0\"></a>";
    flightForm.submit();
} 
```

因此，当单击按钮时，它应该将单元格的值替换为“现在”并提交表单。问题是虽然它确实提交了，但更改的值实际上并没有被提交。如果我手动将某些内容添加到其他字段之一（例如 towHeight）并单击按钮，它确实会成功提交。换句话说，只有在单击按钮时没有提交的“起飞”字段。我以前从未使用过 Javascript，所以这对我来说似乎很奇怪。

在背景中，有一个 PHP 脚本生成 HTML 并接受提交的输入，因此有一些奇怪的 ID。如果我遗漏了任何内容，可以在这里看到整个页面[http://ad7zj.net/logging/index.php](http://ad7zj.net/logging/index.php) 非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:19:10.290

您正在寻找[.onsubmit()](http://msdn.microsoft.com/en-us/library/ie/ms536972%28v=vs.85%29.aspx)事件。

也就是说，您最好只从服务器获取时间。它将使您摆脱时区、夏令时问题以及时间设置不准确的计算机数量。

编辑：

好的，感谢您的评论，我想我知道发生了什么。

您正在尝试使用 更新表单`.innerHTML`。 `.innerHTML`是一只相当奇怪的野兽，充满了各种各样的心痛——不要屈服于它的诱惑。看起来浏览器正在等待 Javascript 事件结束，然后才实际应用 innerHTML 更新。无论如何，这将是我的猜测。除了最简单的更新之外，我避免了这件事。

核对这个：

```
 flightRow.cells[2].innerHTML = "<input type=\"text\" name=\"takeoff\" value=\"now\"><a href=\"#\" onclick=\"startTakeoff(43);return false;\"><img alt=\"Start Now\" src=\"brush_24.png\" border=\"0\"></a>"; 
```

试试这个：

```
// Assuming only one form with one name 'takeoff'
var el = document.getElementsByName("takeoff")[0];
el.value = 'now';

// The rest of the updates shouldn't matter -- the form is being submitted, nothing should be seen. 
```

# javascript - Twitter bootstrap modal 淡出 this.$backdrop is null 错误

> ID：12485126
> 
> 赞同：1
> 
> 时间：2012-09-18T21:13:15.213
> 
> 标签：javascript, jquery, twitter-bootstrap

我想创建一个简单的模态淡入效果。我试过这个：

[http://jsfiddle.net/Tropicalista/Wc8PB/2/](http://jsfiddle.net/Tropicalista/Wc8PB/2/)

它可以正常工作。

但是当我在我的服务器上上传一个测试文件时，我在 firefox 中遇到错误： this.$backdrop 为 null

见这里： http: [//mydirectory.altervista.org/prove/modal.html](http://mydirectory.altervista.org/prove/modal.html)

我错过了什么？

# parsing - 使用 ANTLR 捕获（并保留）所有评论

> ID：12485132
> 
> 赞同：6
> 
> 时间：2012-09-18T21:14:06.090
> 
> 标签：parsing, comments, antlr

我正在用 ANTLR 编写语法，将 Java 源文件解析为 AST 以供以后分析。与其他解析器（如 JavaDoc）不同，我试图保留所有注释。这是很难的注释，可以在代码中的任何地方使用。如果源代码中某处的注释与语法不匹配，则 ANTLR 无法完成对文件的解析。

有没有办法让 ANTLR 自动将它找到的任何评论添加到 AST 中？我知道词法分析器可以简单地使用其中一个`{skip();}`或通过将文本发送到隐藏通道来忽略所有评论。使用这些选项中的任何一个，ANTLR 都可以毫无问题地解析文件。

欢迎任何想法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-07-31T02:43:41.693

“The Definitive Antlr 4 Reference”中的第 12.1 节展示了如何访问评论，而不必在整个语法中散布评论规则。简而言之，您将其添加到语法文件中：

```
grammar Java;

@lexer::members {
    public static final int WHITESPACE = 1;
    public static final int COMMENTS = 2;
} 
```

然后为您的评论规则执行此操作：

```
COMMENT
    : '/*' .*? '*/' -> channel(COMMENTS)
    ;

LINE_COMMENT
    : '//' ~[\r\n]* -> channel(COMMENTS)
    ; 
```

然后在您的代码中通过 getHiddenTokensToLeft/getHiddenTokensToRight 请求令牌并查看本书中的 12.1 部分，您将了解如何执行此操作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-05-16T11:27:33.203

第一：将所有评论定向到某个频道（仅限评论）

```
COMMENT
    : '/*' .*? '*/' -> channel(2)
    ;

LINE_COMMENT
    : '//' ~[\r\n]* -> channel(2)
    ; 
```

第二：打印所有评论

```
 CommonTokenStream tokens = new CommonTokenStream(lexer);
      tokens.fill();
      for (int index = 0; index < tokens.size(); index++)
      {
         Token token = tokens.get(index);
         // substitute whatever parser you have
         if (token.getType() != Parser.WS) 
         {
            String out = "";
            // Comments will be printed as channel 2 (configured in .g4 grammar file)
            out += "Channel: " + token.getChannel();
            out += " Type: " + token.getType();
            out += " Hidden: ";
            List<Token> hiddenTokensToLeft = tokens.getHiddenTokensToLeft(index);
            for (int i = 0; hiddenTokensToLeft != null && i < hiddenTokensToLeft.size(); i++)
            {
               if (hiddenTokensToLeft.get(i).getType() != IDLParser.WS)
               {
                  out += "\n\t" + i + ":";
                  out += "\n\tChannel: " + hiddenTokensToLeft.get(i).getChannel() + "  Type: " + hiddenTokensToLeft.get(i).getType();
                  out += hiddenTokensToLeft.get(i).getText().replaceAll("\\s", "");
               }
            }
            out += token.getText().replaceAll("\\s", "");
            System.out.println(out);
         }
      } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-19T06:29:35.477

> 有没有办法让 ANTLR 自动将它找到的任何评论添加到 AST 中？

不，您必须在整个语法中添加额外的`comments`规则，以说明可能出现注释的所有有效位置：

```
...

if_stat
 : 'if' comments '(' comments expr comments ')' comments ...
 ;

...

comments
 : (SingleLineComment | MultiLineComment)*
 ;

SingleLineComment
 : '//' ~('\r' | '\n')*
 ;

MultiLineComment
 : '/*' .* '*/'
 ; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-03T11:00:58.260

也可以使用“孤岛语法”功能。请参阅 ANTLR4 书中的以下部分：

> Island Grammars：处理同一文件中的不同格式

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-26T17:29:13.810

我在我的词法分析器部分做到了：

```
WS  :   ( [ \t\r\n] | COMMENT) -> skip
;

fragment
COMMENT
: '/*'.*'*/' /*single comment*/
| '//'~('\r' | '\n')* /* multiple comment*/
; 
```

就像它会自动删除它们！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-27T09:27:02.767

**对于 ANTLR v3：**

空白标记通常不被解析器处理，但它们仍然在 HIDDEN 通道上捕获。

如果您使用`BufferedTokenStream`，您可以通过它获取所有令牌的列表并进行后处理，根据需要添加它们。

# html - 有没有办法将包含的 div 的宽度指定为父级可滚动区域的全宽？

> ID：12485133
> 
> 赞同：3
> 
> 时间：2012-09-18T21:14:16.433
> 
> 标签：html, css

我发现如果我放置一个`overflow-auto`包含其他 div 的 div，那么这些子 div 的宽度只是父级可见部分的宽度，而不是可滚动区域的宽度。

            ![问题的例子](../Images/4e3f821a56e8a3f98764c312cbe2233b.png)

[您可以在http://jsfiddle.net/UdgCE/](http://jsfiddle.net/UdgCE/)看到一个示例

有没有办法将可滚动区域的全宽指定为宽度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:42:50.367

我不确定这是否理想，它可能不能完全回答或匹配您打算做的事情。

然而，似乎可滚动容器内部的容器表现出与容器拉伸窗口类似的行为。例如，如果您有一个 div，`height:100%;`它`width:100%;`会拉伸视口，仅此而已。

考虑到这一点，在搞砸了一段时间后，我发现的唯一纯 CSS 解决方案是将特定的“匹配”像素值设置为您的内部/外部容器。

这里的一个例子...... [http://jsfiddle.net/krishollenbeck/UdgCE/27/](http://jsfiddle.net/krishollenbeck/UdgCE/27/)

**HTML**

```
<html>
  <body>
    <div style="overflow:auto" id="container"> 
      <div id="inner-wrap">        
          <div  style="white-space:pre" id="content">
             This is a the text of the first div and it's veeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeery long
          </div>
        </div>
      <div style="background-color:#FFFF00" id="yellow">
        &nbsp;
      </div>
    </div>
  </body>
</html> 
```

**CSS**

```
#yellow {
  width:2000px;    
}

#container {
 border:1px solid red;
    width:400px;
}
#content { 
    width:2000px;    
    border:1px solid #333;
}

#inner-wrap {
 width:2000px;   
}
​ 
```

这似乎不太理想，但似乎有效。我猜您很可能必须使用 javaScript 来测量可滚动容器的宽度，然后将内部 div 与该尺寸相匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:05:36.357

向包装器 div 添加“clearfix”为我修复了它。这使得包装 div 扩展到文本的宽度。不仅仅是溢出。

[http://jsfiddle.net/7a67j/](http://jsfiddle.net/7a67j/)

# css - 将图像存储在 HTML 文件中是否是有效的 HTML？

> ID：12485136
> 
> 赞同：3
> 
> 时间：2012-09-18T21:14:33.563
> 
> 标签：css, image, html, styles

如：

```
<img style="width:500px;height:150px;background:url(data:image/png;base64,BLAH)" /> 
```

我拥有的应用程序显示授权书，然后显示画布。画布允许触摸/鼠标事件，用户可以在上面签名。然后保存 HTML 和签名。客户要求将这些文件保存到一个文件中，以便将来不会得到不匹配的签名 PNG 文件和 HTML 文本文件。

因此，虽然我不喜欢这种方法的外观，但它似乎在 Chrome 甚至 IE 中都能正常工作，并且它解决了客户只需存储一个带有签名授权的文件的请求。

我的问题是 - 这是合法的 HTML 还是 Chrome 对我很好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T21:30:24.017

**引用操作：**

```
<img style="width:500px;height:150px;background:url(data:image/png;base64,BLAH)" /> 
```

*“我的问题是 - 这是合法的 HTML 吗？”*

* * *

不可以。根据[W3C HTML 规范](http://dev.w3.org/html5/spec/the-img-element.html#attr-img-src)，`src`属性*“必须存在”*。

为什么不把你的`img`变成一个`div`？

```
<div style="width:500px;height:150px;background:url(data:image/png;base64,BLAH)"></div> 
```

一般来说，任何关于 HTML 有效性的问题都应该通过在线验证器来解决：http: [//validator.w3.org/](http://validator.w3.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:21:01.690

HTML[无效](http://validator.w3.org/)。但是，如果您深入研究一下，您会发现[HTML4 规范中对](http://www.w3.org/TR/1999/REC-html401-19991224/struct/objects.html)[Data URI 方案](http://en.wikipedia.org/wiki/Data_URI_scheme)的引用：

```
<OBJECT id="clock1"
        classid="clsid:663C8FEF-1EF9-11CF-A3DB-080036F12502"
        data="data:application/x-oleobject;base64, ...base64 data...">
    A clock.
</OBJECT> 
```

...所以问题不在于`data:`uri。至于这是否是仅限 chrome 的东西，[关于 Data URI Scheme 的 Wikipedia 文章包含专门讨论浏览器支持的部分。](http://en.wikipedia.org/wiki/Data_URI_scheme#Web_browser_support)

看起来 CSS 也无效。以下在[w3c CSS 验证器](http://jigsaw.w3.org/css-validator/#validate_by_input)上的验证失败：

```
.wtv {
    background:url(data:image/png;base64,BLAH);
    color:red;
} 
```

验证器给出以下错误：

```
Value Error : background url(data:image/png;base64,BLAH) is an incorrect URL url(data:image/png;base64,BLAH) 
```

所以你正在做的工作，但根据法律条文，它是*无效*的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:19:09.240

在我看来这很好。在 CSS 声明中包含实际的 base64 图像数据很好。如果该过程的输出只是一个 HTML 文件，这是一种有趣的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T21:20:59.223

在这种情况下，问题是这是否是有效的 CSS。但是，它可以在两者中使用并且应该是有效的。但请注意，并非所有浏览器都支持它。

[维基百科：数据 URI 方案](http://en.wikipedia.org/wiki/Data_URI_scheme)

# c# - 在 ASP.NET C# 上上传时如何验证文件的大小？

> ID：12485138
> 
> 赞同：3
> 
> 时间：2012-09-18T21:14:40.363
> 
> 标签：c#, jquery, asp.net, validation, upload

我正在开发一个发送电子邮件的模块，其中一个功能是上传多个文件......

我以此作为参考来创建它： [http ://www.dotnetcurry.com/ShowArticle.aspx?ID=68](http://www.dotnetcurry.com/ShowArticle.aspx?ID=68)

我还必须添加 jquery 以允许它上传多个文件。

```
<script src="Scripts/jquery-1.3.2.js" type="text/javascript">
</script>

<script src="Scripts/jquery.MultiFile.js" type="text/javascript">
</script> 
```

但是，如果我在表单中按下按钮时上传了大于 10MB 的文件（我猜每当回发发生时都会发生这种情况），浏览器将无法加载该页面。所以我想要的是在我的按钮中触发这个功能：

```
protected void imgBtnEnviar_Click(object sender, ImageClickEventArgs e)
{
    int intBytes = 0;
    string strArchivos = "";
    string strRutaArchivos = "";
    bool blnBytes = true;
    bool blnPermitir = true;

    try
    {
        HttpFileCollection hfc = Request.Files;

        //Check if all files together are less than 10mb
        foreach (HttpPostedFile hpf in hfc)
        {
            intBytes += hpf.ContentLength;

            if (intBytes > 11000000)
            {
                blnBytes = false;
                break;
            }
        }

        if (blnBytes)
        {
            //Upload All attached files to server
            foreach (HttpPostedFile hpf in hfc)
            {
                if (hpf.FileName == "")
                {
                    break;
                }

                string strNombre = ((int)Session["Grupo"]) + "_" + (int)Session["EmailIdCliente"] + "_" + DateTime.Now.ToString("MM-dd-yyyy_HH.mm.ss") + "_" + Path.GetFileName(hpf.FileName);
                strArchivos += strNombre + ";";
                strRutaArchivos += Server.MapPath("~/Archivos/") + strNombre + ";";
                hpf.SaveAs(Server.MapPath("~/Archivos/") + strNombre);
            }
        }
    }

    catch
    {
        blnPermitir = false;
    }

    if (!blnBytes || !blnPermitir)
    {
        //Error Message Displayed To User
        ClientScript.RegisterStartupScript(this.GetType(), "Mensaje", "alert('Maximo Puede Enviar 10MB En Archivos');", true);
    }

    else
    {
        //Moving on to send email
    }
} 
```

我想要的是，如果 blnBytes 等于 false（当所有组合文件超过 10mb 时它变为 false）它只会显示一条错误消息，但是即使单个文件大于 10mb，我怎样才能使它工作？？... .

希望你能帮助我谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:28:21.730

你可以试试这个。。

```
foreach (HttpPostedFile hpf in hfc)
{
    if(hpf.ContentLength > 11000000)
    {
        blnBytes = false;
        break;
    }
    intBytes += hpf.ContentLength;
    if (intBytes > 11000000)
    {
        blnBytes = false;
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T21:24:22.237

您必须在 web.config 中启用大文件支持（httpRuntime、maxRequestLength 参数）。

这是示例：

```
 <httpRuntime requestValidationMode="2.0"
     executionTimeout="6000"
     maxRequestLength="20485760"
     requestLengthDiskThreshold="80"
     useFullyQualifiedRedirectUrl="false"
     minFreeThreads="8"
     minLocalRequestFreeThreads="4"
     appRequestQueueLimit="5000"
     enableKernelOutputCache="true"
     enableVersionHeader="true"
     requireRootedSaveAsPath="true"
     enable="true"
     shutdownTimeout="90"
     delayNotificationTimeout="5"
     waitChangeNotification="0"
     maxWaitChangeNotification="0"
     enableHeaderChecking="true"
     sendCacheControlHeader="true"
     apartmentThreading="false" /> 
```

更多相关信息可以在这里找到：http: [//msdn.microsoft.com/en-us/library/e1f13641 (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/e1f13641(v=vs.71).aspx)

# ruby-on-rails - Capybara NoMethodError：未定义的方法“访问”

> ID：12485140
> 
> 赞同：2
> 
> 时间：2012-09-18T21:14:44.250
> 
> 标签：ruby-on-rails, rspec, capybara

感谢您的回复。[我在应用程序Git 应用程序](https://github.com/itsNikolay/error)
中遇到错误并出现错误

```
Failures:

  1) Page pages page creation with invalid information should not create a page
     Failure/Error: before(:each) { visit new_admin_page_path }
     NoMethodError:
       undefined method `visit' for #<Page:0x00000005094bb0>
     # ./spec/requests/page_request_spec.rb:13:in `block (3 levels) in <top (required)>'

  2) Page pages page creation with invalid information error messages 
     Failure/Error: before(:each) { visit new_admin_page_path }
     NoMethodError:
       undefined method `visit' for #<Page:0x000000051671f0>
     # ./spec/requests/page_request_spec.rb:13:in `block (3 levels) in <top (required)>'

Finished in 1.21 seconds
14 examples, 2 failures 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-19T12:17:22.613

我克隆了您的存储库并运行了规范。问题是您使用该术语`page`来表示两种不同的事物，Capybara 页面 ( `subject { page }`) 和带有名称的模型`Page`（您也命名为`page`）。这两个名称冲突，这就是为什么 rspec 抱怨没有方法`visit`用于`#<Page:0x00000005094bb0>`.

要解决这个问题，只需重命名您在初始创建的页面`let`：

```
let(:mypage) { Factory.create(:page) } 
```

这将通过命名您的页面模型`mypage`而不是`page`.

然而还有其他问题。您的用户工厂不使用序列来分配电子邮件，因此您会收到验证错误，因为它表示电子邮件已被占用。

我将您的用户工厂更改为：

```
sequence(:email) { |n| "abc#{n}@example.com"}
factory :user do
  email
  password "foobar"
  password_confirmation "foobar"
  ... 
```

这修复了验证错误，但您现在得到另一个错误。在您的第一个规范中，您应该检查*class*`count`上的变化，而不是*记录*（或）。 *`Page` *`page``mypage`**

 **所以将其更改为：

```
expect { click_button "Create Page" }.not_to change(Page, :count) 
```

这*仍然*会给您留下错误，因为您也没有`create`对您的`PagesController`. 从您写的内容来看，该信息似乎无效，因此它甚至不应该执行此操作。我不知道你到底想在这里做什么，所以剩下的留给你自己弄清楚。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-20T16:29:03.550

如果您最近升级到 Capybara 2.0 并且您的集成测试正在使用以前版本的 Capybara，您可以尝试将 requests 目录重命名为 features。检查[http://www.codelearn.org/blog/how-to-make-old-integration-tests-work-with-capybara-2-0](http://www.codelearn.org/blog/how-to-make-old-integration-tests-work-with-capybara-2-0)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-19T06:31:58.050

Add the following to your `spec/spec_helper.rb` (in your `Spork.prefork` block):

```
require 'capybara/rspec'
require 'capybara/rails' 
```**

# objective-c - 如何在编译时忽略一些静态库

> ID：12485144
> 
> 赞同：0
> 
> 时间：2012-09-18T21:15:00.850
> 
> 标签：objective-c, ios, xcode, ios5, ios4

我想弄清楚如果项目已经存在类似的库，是否有办法在编译时忽略静态库？

我正在创建一个框架，我需要在其中拥有静态库来利用扫描机制。但是，我试图利用这个项目的项目也有这样的库，因此我很好奇是否有任何机制在编译时忽略这样的库？无论是框架还是项目都没有关系。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:22:48.677

我曾经有一个类似的案例，我写的一个库需要一些常见的开源组件，这些组件被许多开发人员使用。

我们找到的最佳解决方案是不将这些组件链接到我们的库中，提供这些组件的列表，并要求我们库的用户包含这些组件。

# python - 从任何子程序文件运行主 python 程序

> ID：12485148
> 
> 赞同：0
> 
> 时间：2012-09-18T21:15:27.820
> 
> 标签：python, import

这比真正的问题更方便，但我正在处理的项目有很多单独的文件，我希望基本上能够运行这些文件中的任何一个（基本上都只包含类）来运行主文件。

现在在写这个问题的第一句话的过程中，我尝试只导入`main.py`到每个文件中，这似乎工作得很好而且花花公子，但我不禁感到：

1.  它可能会导致问题，并且
2.  我之前在循环导入方面遇到过问题，我对没有出现任何问题感到有些惊讶。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:25:01.990

首先让我说：这很可能是一个坏主意，而且绝对不是标准的。这可能会导致未来的混乱和沮丧。

但是，如果你真的想这样做，你可以放：

```
if __name__ == "__main__":
    from mypackage import main
    main.run() 
```

假设`mypackage.main.run()`它是您的主要入口点，它将让您运行您想要的任何文件，就好像它是主文件一样。

您可能仍然会遇到循环导入的问题，这些问题将是完全不可避免的，除非`mypackage.main`不导入任何东西......这将使它相当无用:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:17:16.887

As an alternative, you may wish to use a testing framework like [doctest](http://docs.python.org/library/doctest.html) or [unittest](http://docs.python.org/library/unittest.html), then configure your IDE to run the unit tests from a hotkey. This way you're automatically building the repeatable tests as you develop your code.

# imagemagick - Image/GraphicsMagick 的云/RESTful 接口

> ID：12485149
> 
> 赞同：9
> 
> 时间：2012-09-18T21:15:31.990
> 
> 标签：imagemagick, cloud, graphicsmagick

我正在寻找可以上传图像并对其进行裁剪/调整大小的云服务。

基本上我正在寻找 zencoder，但要寻找图像而不是视频。

我知道 cloudinary，但它迫使您将图像存储在他们的系统上，以便他们可以提高费用。有没有什么好的替代品？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-01T04:50:08.307

Blitline 可以为您做到这一点。

[http://www.blitline.com/docs/quickstart](https://www.blitline.com/v3/home/features)

这是一个关于如何通过 curl 执行此操作的示例：

```
curl "http://api.blitline.com/job" \
  -d json='{ "application_id": "sgOob0A3b3RdYaqwTEJCpA", 
             "src" : "http://www.google.com/logos/2011/yokoyama11-hp.jpg", 
             "functions" : [ {"name": "blur", 
                              "params" : {"radius" : 0.0, "sigma" : 2.0}, 
                              "save" : { "image_identifier" : "some_id" }} ]}' 
```

这是可以使用的图像[功能列表。](https://helpdocs.blitline.com/article/MraLE6tVOY-functions)

笔记：

*   源图像应该是公开的，或者在您的 Amazon S3 账户上。
*   目标图像将存储在 blitline 的 S3 帐户或您自己的 S3 帐户中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T21:53:33.837

你的意思是

*   [**魔术工作室**](http://www.imagemagick.org/MagickStudio/scripts/MagickStudio.cgi)

ImageMagick 的开发者自己提供的？（这是免费的。）

或付费的“软件即服务”：

*   [**多云的**](http://cloudinary.com/faq)
*   [**位线**](http://www.blitline.com/docs/about)

阿法尤，...

*   Cloudinary 提供了一个 RESTful 和一个 JSON 接口，Blitline 只有一个 JSON 接口。
*   Cloudinary 可能提供比 Blitline 更多的图像处理功能。
*   裁剪和调整大小都适用。
*   Blitline 可能比 Cloudinary 便宜。

* * *

更新：对不起，我忘记了你已经提到过 Cloudinary...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-18T08:12:57.243

或者，[imgix](http://www.imgix.com/)也可能值得研究。不是像他们自己提到的那样简单的 ImageMagick 包装器，而是图像处理命令中相当广泛的产品。

[他们的文档页面](http://www.imgix.com/docs)列出了通过 URL 提供的命令示例，并且[完整的 API](http://www.imgix.com/docs/urlapi)被广泛记录。

# symfony - Symfony 2.1 - 带有注释标签实体的 FPNTagBundle

> ID：12485150
> 
> 赞同：0
> 
> 时间：2012-09-18T21:15:33.297
> 
> 标签：symfony, doctrine-orm, symfony-2.1

我已经通过作曲家安装了[FPNTagBundle 。](https://github.com/FabienPennequin/FPNTagBundle)我已经成功地将标签添加到我的文章中，但是当我添加 DoctrineExtensions'`TagRepository`作为 repositoryClass 时

```
/**
 * @ORM\Entity(repositoryClass="DoctrineExtensions\Taggable\Entity\TagRepository")
 * @ORM\Table
 */
class Tag extends FPN\TagBundle\Entity\Tag 
```

并尝试使用 TagRepository 的方法`getResourceIdsForTag('post', 'tagname')`，它失败了。我已经检查了存储库类

```
$tagRepo = $this->getDoctrine()->getRepository('GergelyPolonkaiFrontBundle:Tag');
echo get_class($tagRepo); 
```

不是`TagRepository`，而是`Doctrine\ORM\Entity\Repository`。即使我指定了无效的类名，我也没有关于 repositoryClass 的任何其他错误消息。

我是否发现了一个错误，或者我在某个地方错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-06T13:49:39.950

看来我遇到了一个错误。在 16 天前合并了 Fabien Pennequin 的一些拉取请求后，它现在似乎按预期工作。

# javascript - jQuery mobile：重新加载内容后应用样式

> ID：12485151
> 
> 赞同：4
> 
> 时间：2012-09-18T21:15:44.190
> 
> 标签：javascript, jquery, ajax, jquery-mobile

首先，我对 jQuery 和 JavaScript 很陌生，但对 HTML 和 PHP 不是很熟悉。

我发现很多关于这个问题的帖子，但没有解决方案。我想我做错了什么（完全？）...

我有两个文件，index.php 和 content.php，它们应该动态地向页面添加内容。

索引.php：

```
<!DOCTYPE html>
<html>
<head xmlns="http://www.w3.org/1999/xhtml">
    <meta charset="UTF-8"></meta>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link type="text/css" rel="stylesheet" href="../css/jquery.mobile-1.1.1.min.css"></link>
    <script type="text/javascript" src="../js/jquery-1.8.1.min.js"></script>
    <script type="text/javascript" src="../js/jquery.mobile-1.1.1.min.js"></script>
    <title>Ajax test</title>

    <script language="JavaScript">

    $(function(){
        $('#page1').click(function(event) {        
            $('#content').load($(this).attr('href')).trigger("create");
            return false;
        });
    });

    $(function(){
        $('#page2').click(function(event) {        
            $('#content').load($(this).attr('href')).trigger("create");
            return false;
        });
    }); 

    </script>

</head>

<body>
    <div id="hm-agenda" data-theme="a" data-role="page">

        <div data-theme="a" data-role="header">
            <h1>Ajax test</h1>
        </div>

        <div id="content" data-role="content">
            Default content
        </div>

    <div data-theme="a" data-role="footer" data-position="fixed" class="nav-glyphish-example">
        <div data-role="navbar" class="nav-glyphish-example" data-grid="d" class="navdiv">
        <ul>
            <li><a href="content.php?page=1" id="page1">Page 1</a></li>
            <li><a href="content.php?page=2" id="page2">Page 2</a></li>
            <li><a href="content.php?page=3" id="page3">Page 3</a></li>
            <li><a href="content.php?page=4" id="page4">Page 4</a></li>
            <li><a href="content.php?page=5" id="page5">Page 5</a></li>
        </ul>
        </div>
    </div>

</body>
</html> 
```

因此，在导航中单击“Page 1”或“Page 2”应该会将 content.php?page=x 加载到 id 为“content”的 div 中。

这就是 content.php 的样子：

```
<ul data-role="listview" class="hm-list">
<li data-role="list-divider"><h3>You are on page: <?php print $_GET['page']; ?></h3></li>
</ul> 
```

将文件加载到 content-div 中可以正常工作，因为 jQuery 不会应用样式。奇怪的是，单击导航中的链接后，样式会被应用大约一秒钟，然后立即消失。

这个例子在网上： http: [//m.sepulturagenda.ch/ajax/](http://m.sepulturagenda.ch/ajax/)

任何帮助表示赞赏。我现在在这里存了几个小时...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T22:27:30.733

您的问题出在这一行：

```
$('#content').load($(this).attr('href')).trigger("create"); 
```

您正在创建一个异步请求，并且在调用该方法`.load()`之前不等待它完成。`.trigger("create")`所以基本上你是`.trigger("create")`在初始化任何 HTML 之前调用该方法。

您可以利用可以传递给的回调函数在正确的时间`.load()`调用该`.trigger("create")`方法。

例如：

```
$(function(){
    $('#page1').click(function(event) {        
        $('#content').load($(this).attr('href'), function () {
            $('#content').trigger("create");
        }).trigger("create");
        return false;
    });
}); 
```

**快速说明：**

您使用`.load()`加载外部内容是否有原因？只要外部内容的格式正确，jQuery Mobile 就会为您执行此操作。这是一些解释我的意思的文档：http: [//jquerymobile.com/demos/1.1.1/docs/pages/page-links.html](http://jquerymobile.com/demos/1.1.1/docs/pages/page-links.html)

**附注：**

使用`document.ready`jQuery Mobile 时不建议使用事件处理程序。相反，您应该绑定到 jQuery Mobile 页面事件之一，例如`pageinit`.

例如：

```
//place this in the global scope
$(document).on('pageinit', '#my-page', function () {
    $('#page1').click(function(event) {        
        $('#content').load($(this).attr('href'), function () {
            $('#content').trigger("create");
        }).trigger("create");
        return false;
    });
}); 
```

尽管由于您使用 ID 作为事件处理程序的选择器`click`，但您不妨将事件处理程序 strait 委托给`#page1`元素。

例如：

```
$(document).on('click', '#page1', function () {    
    $('#content').load($(this).attr('href'), function () {
        $('#content').trigger("create");
    }).trigger("create");
    return false;
}); 
```

这是 jQuery Mobile 事件的文档（请参阅页面顶部的黄色大警告）：http: [//jquerymobile.com/demos/1.1.1/docs/api/events.html](http://jquerymobile.com/demos/1.1.1/docs/api/events.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:38:08.003

我敢肯定有更好的方法来做到这一点，但你可以手动告诉它添加“ui-btn-active”类..

```
 $(function(){
    $('#page2').click(function(event) {  
        $(".ui-btn-active").removeClass("ui-btn-active");   
        $('#content').load($(this).attr('href')).trigger("create");
        $(this).addClass('ui-btn-active');
        return false;
    });
}); 
```

# linux - 通过 wifi 流式传输音频：可行以及如何？

> ID：12485152
> 
> 赞同：1
> 
> 时间：2012-09-18T21:15:54.110
> 
> 标签：linux, audio, stream, mp3, wifi

我正在评估构建一个应用程序，该应用程序简化了要求，从配备麦克风的小型计算机（例如：Raspberry PI）记录并通过无线连接几乎实时地将数字化声音流式传输到同一 LAN 上的服务器（不涉及 Internet） . 理想情况下，服务器应用程序将记录来自各种 wifi 麦克风的不同流并将它们混合在一起。

我目前正在考虑从中获得相当不错的质量，以某种方式与 128Kb 立体声 MP3 相媲美。

在这一点上，我仍然在这里评估选项，所以我也想看看你对这个可行性的看法。如果你认为它是可行的，你会使用什么库、API、协议？考虑到这可能会部署在基于 Linux 的嵌入式计算机（用于 wifi 麦克风部分）和基于 Linux 的服务器上。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:31:18.517

我经常在 iPad 上听 Shoutcast。这对我来说听起来不错。我不知道那里的 kb/s 速率，我认为他们流式传输 mp3。因此，如果您可以忍受 mp3 带来的质量损失，我认为这不会是一个大问题。更大的问题可能是您的无线连接有多好。当您的网络非常繁忙时，会出现更多错误并且速度会降低。它还取决于您使用的无线标准和硬件。你也可以考虑缓冲。

# c# - 如何在没有 powershell 的情况下使用 C# 以编程方式创建 Exchange 2010 邮箱

> ID：12485157
> 
> 赞同：1
> 
> 时间：2012-09-18T21:16:18.960
> 
> 标签：c#, active-directory

我正在尝试在 C# 中创建一个邮箱，但我不能使用 powershell（根据要求）。我已经能够成功创建分发列表，而无需使用 powershell 功能。在各种论坛上查看，唯一可能的解决方案不是我有能力做的。我希望使用这个功能足够简单，但是，我有点卡住了。

到目前为止，我已经设法在邮箱中为 Exchange 2010 添加了几个属性，但我只能确定这么多属性。（例如 msExchUserAccessControl）。

我不确定我能提供哪些信息会有所帮助。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T20:07:44.150

如果您的意思是希望从客户端 PC 而不是 Exchange 服务器创建邮箱，并且您可能没有在客户端上安装管理工具，那么您可以远程执行 powershell 脚本。看这里： [从远程 C# 程序创建 Exchange 2010 邮箱](http://blog.pedroliska.com/2011/07/28/creating-an-exchange-2010-mailbox-from-a-remote-c-program/)

# windows - 使文件可被 Perl 脚本访问但被 Web 访问阻止 - IIS6

> ID：12485158
> 
> 赞同：1
> 
> 时间：2012-09-18T21:16:28.993
> 
> 标签：windows, perl, iis-6

我在带有 IIS6 的 Windows 2003 服务器上使用 perl。我编写了一个脚本，需要访问用户上传的机密文件。这些文件存储在 cgi-bin 的文件夹中。但是，我不希望通过网络链接访问这些文件。因此，我对 IIS 中禁用的这个特定文件夹具有“读取权限”。

这些文件无法通过网络链接访问，但我需要用户能够打开他/她上传的文档。

用户登录信息（用户名和密码）存储在 cgi-bin 的 csv 文件中。

我已经搜索了数据库，但找不到与这种情况完全匹配的任何内容。

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T15:55:20.407

除非我误解了您的问题，否则您试图在应用程序级别而不是服务级别限制用户访问。

如果您希望您的网络应用程序的用户能够访问他们上传的文件，那么您的授权检查需要在应用程序中完成，而不是在边缘（通过网络服务器）。

因此，每个上传的文件都标有它的所有者（数据库记录或每个所有者的目录），并且对文件的访问受到一小段代码的限制，该代码将经过身份验证的用户与文件所有者进行检查。

Web 服务器用户可以读取和写入文件所在的目录，因为这是 perl 将运行的用户，但它没有配置到 IIS 中，因为它可用于常规 HTTP GET 访问。它既不在 HTML 文档根目录下，也不在 CGI-BIN 目录下。它是一个完全独立的目录。

# php - simplexml_load_string() 不会读取标签中带有“soap:”的soap响应

> ID：12485162
> 
> 赞同：9
> 
> 时间：2012-09-18T21:16:38.930
> 
> 标签：php, xml, soap, curl, simplexml

我知道这可能是一个新手问题，但请幽默。读取标签中带有“soap:”的 xml 字符串时，simplexml_load_string() 不会读取 xml。

给定这个脚本：

```
#!/usr/bin/php
<?php

$s='
    <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
        <soap:Header>
        <context xmlns="urn:zimbra"/>
        </soap:Header>
        <soap:Body>
            <AuthResponse xmlns="urn:zimbraAdmin">
                <authToken>somevalue</authToken>
                <lifetime>123124123</lifetime>
                <a n="zimbraIsDomainAdminAccount">false</a>
            </AuthResponse>
        </soap:Body>
    </soap:Envelope>';

print_r(simplexml_load_string($s));
echo "\n\n";
print_r(simplexml_load_string(str_ireplace("soap:", "", $s)));
?> 
```

我得到这个输出：

```
jesse@jesse-debian:~/code/zmsoap$ ./xmltest.php 
SimpleXMLElement Object
(
)

SimpleXMLElement Object
(
    [Header] => SimpleXMLElement Object
        (
            [context] => SimpleXMLElement Object
                (
                )

        )

    [Body] => SimpleXMLElement Object
        (
            [AuthResponse] => SimpleXMLElement Object
                (
                    [authToken] => somevalue
                    [lifetime] => 123124123
                    [a] => false
                )

        )

)
jesse@jesse-debian:~/code/zmsoap$ 
```

我只是好奇为什么会发生这种情况，以及是否有更合适的方法来解决问题而不是进行字符串替换。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-19T14:51:38.303

带有冒号的标签名称表示该标签位于非默认命名空间中。SimpleXML 一次只查看一个命名空间，因此您需要使用 方法专门选择[命名`->children()`空间](http://php.net/manual/en/simplexmlelement.children.php)。

在这种情况下`$xml->children('http://www.w3.org/2003/05/soap-envelope')->Body`，或者`$xml->children('soap', true)->Body`两者都应该起作用。

由于这个和其他原因，不建议使用它`print_r`来调试 SimpleXML 对象。请尝试[使用此专用功能](http://github.com/IMSoP/simplexml_debug)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-19T13:27:20.123

这似乎奏效了。

在此处阅读：[使用 SimpleXML 使用命名空间解析 XML](https://stackoverflow.com/questions/595946/parse-xml-with-namespace-using-simplexml)

```
#!/usr/bin/php
<?php

$s='
    <soap:Envelope xmlns:soap="urn:zimbra">
        <soap:Header>
        <context xmlns="urn:zimbra"/>
        </soap:Header>
        <soap:Body>
            <AuthResponse xmlns="urn:zimbraAdmin">
                <authToken>somevalue</authToken>
                <lifetime>123124123</lifetime>
                <a n="zimbraIsDomainAdminAccount">false</a>
            </AuthResponse>
        </soap:Body>
    </soap:Envelope>';
//print_r(simplexml_load_string($s));
//echo "\n\n";
//print_r(simplexml_load_string(str_ireplace("soap:", "", $s)));
$xml = simplexml_load_string($s);
$xml->registerXPathNamespace("soap", "http://www.w3.org/2003/05/soap-envelope");
print_r($xml->xpath('//soap:Body'));

?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-31T11:02:02.210

最简单的：

```
$xml='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><AddOrderResult>1</AddOrderResult></soap:Body></soap:Envelope>';
var_export(json_decode(json_encode(simplexml_load_string(strtr($xml, array(' xmlns:'=>' ')))), 1)); 
```

输出：

```
array (
  '@attributes' => 
  array (
    'soap' => 'http://schemas.xmlsoap.org/soap/envelope/',
  ),
  'soap:Body' => 
  array (
    'AddOrderResult' => '1',
  ),
) 
```

# javascript - 如何使用小胡子样式获取下划线模板以识别 if 语句

> ID：12485166
> 
> 赞同：0
> 
> 时间：2012-09-18T21:16:44.030
> 
> 标签：javascript, underscore.js, ejs

> **可能重复：**
> [下划线模板中的布尔检查](https://stackoverflow.com/questions/10597480/boolean-checks-in-underscore-templates)

我不能使用带下划线的标准 ERB 样式模板，因为它们在 express ejs 文件中使用，所以我将下划线模板更改为使用 mustache 样式模板

```
_.templateSettings = {
  interpolate : /\{\{(.+?)\}\}/g
}; 
```

但是它现在会跳过 if 语句，我将如何更改此 ERB 样式

```
<% if (something) { %> 
```

变成与下划线中的替代模板一起使用的东西

```
{{ if (something) }} 
```

似乎不起作用，我不能使用标准的 <% erb 样式，因为它与它所在的 ejs 模板冲突。

# html - 如何更正 css3 nav ul a:active 背景填充问题

> ID：12485170
> 
> 赞同：2
> 
> 时间：2012-09-18T21:16:53.800
> 
> 标签：html, css, background, padding

我正在我的网站上工作，今天我的大脑崩溃了。

首先是我所在的位置：http: [//www.lenniemoore.com/home.html](http://www.lenniemoore.com/home.html) 以及相关的 css 文件： http: [//www.lenniemoore.com/assets/desktop.css](http://www.lenniemoore.com/assets/desktop.css)

在我的导航栏菜单上，除了 a:active 元素之外，我已经设置了所有样式并使用背景颜色正常工作。当我在菜单项上单击或单击并按住鼠标按钮时，背景形状与其他元素的形状不同。

我认为这是一个填充问题，但我整天都在梳理我所有的 CSS，只是没有看到罪魁祸首。

这是 desktop.css 中的相关 css 代码：

```
 ul{list-style-type:none;margin:0 0 5px -35px;}
    .content ul,.content ol{padding:0 15px 15px 40px;}
    #navigator nav{clear:both;width:950px;padding:4px 0;background:#06c;background:-moz-linear-gradient(-90deg,rgba(0,40,80,0),rgba(0,40,80,0.5)),#06c;background:-webkit-gradient(linear,left top,left bottom,from(rgba(0,40,80,0)),to(rgba(0,40,80,0.5))),#06c;background:-o-gradient(linear,left top,left bottom,from(rgba(0,40,80,0)),to(rgba(0,40,80,0.5))),#06c;overflow:auto;border-radius:20px;box-shadow:-3px 3px 2px rgba(64,64,55,0.4);}
    nav ul a,nav ul a:visited{padding:0;margin:0 0 2px 0;display:block;}
    nav li,nav li a{-moz-transition-duration:0.25s;-webkit-transition-duration:0.25s;-o-transition-duration:0.25s;}
    nav li{float:left;width:130px;padding:0 0 5px 0;margin:0 5px 0 0;}
    nav li a{display:block;text-align:center;line-height:normal;vertical-align:middle;font-size:120%;font-weight:bold; text-shadow:-2px 2px 0px rgba(0,0,0,1),0px 0px 5px rgba(0,0,0,1);text-decoration:none;color:#eee;}
    nav ul a,nav ul a:visited,nav ul a:focus,nav ul a:active,nav li,nav li.current{border-radius:13px;}
    nav ul a:focus,nav ul a:active,nav li.current,nav li:hover{box-shadow:0px 1px 5px black;}
    nav ul a:focus,nav ul a:active,nav li.current{background:#900;background:-moz-linear-gradient(-90deg,rgba(0,0,0,0.2),rgba(0,0,0,0)),#900;background:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,0.2)),to(rgba(0,0,0,0))),#900;background:-o-gradient(linear,left top,left bottom,from(rgba(0,0,0,0.2)),to(rgba(0,0,0,0))),#900;color:#eec;text-shadow:-1px 1px 0px rgba(0,0,0,1),-2px 2px 5px rgba(0,0,0,0.5);}
    nav li:hover{background:#ffd;background:-moz-linear-gradient(-90deg,rgba(0,0,0,0.2),rgba(0,0,0,0)),#ffd;background:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,0.2)),to(rgba(0,0,0,0))),#ffd;background:-o-gradient(linear,left top,left bottom,from(rgba(0,0,0,0.2)),to(rgba(0,0,0,0))),#ffd;}
    nav li:hover a{color:#900;text-shadow:-2px 2px 0px rgba(0,0,0,1),-3px 3px 5px rgba(0,0,0,0.5);} 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T00:12:27.600

目前您已`padding: 0 0 5px 0;`设置为`nav li`. 如果您将其删除，然后将其放在上面，`nav ul a, nav ul a:visited`那么您的问题将得到解决。

基本上，列表项上的填充意味着锚永远不会达到相同的高度。通过将填充放在锚点上，两个元素的高度相同。

# ruby-on-rails - 如何在没有 attr_accessible 的情况下进行非批量分配？

> ID：12485171
> 
> 赞同：0
> 
> 时间：2012-09-18T21:16:54.233
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord, ruby-on-rails-3.2

我有一个模型，它通过前端表单`Widget`接受`:title`,作为用户输入。`:url``:description`

在这个模型中，我最终不关心`:url`（意思是我不想存储它）。然而，我真正关心的是`:url`、an`:appname`和 a中的 2 条数据`username`。

另一方面，我不希望`:appname`并且`:username`以任何方式向公众大量分配或访问（为了简单起见，由于源不断变化，很难验证它们）。我所做的是严格验证 URL，这就足够了，这些部分在 url 中的位置我在正则表达式中有更多宽松的规则）。

我不确定如何在模型本身中进行设置。这是我到目前为止所拥有的

`attr_accessible :description, :title, :url`

但是，我该如何写`:username`，`:appname`如果它们不是 attr_accessible？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:22:52.583

如果您只想将非 ActiveRecord 属性写入模型实例，您可以使用

```
attr_writer :username, :appname 
```

在你的模型中。

或使用

```
attr_accessor :username, :appname 
```

如果您想稍后从 active_record`:url`属性设置/获取它。

# google-maps - 谷歌地图 API 问题

> ID：12485172
> 
> 赞同：0
> 
> 时间：2012-09-18T21:16:58.293
> 
> 标签：google-maps

我正在尝试在 Google Maps API 上制作一些绘图的原型。我已经按照这里的代码并认为我的代码应该可以工作，但是我得到一个空白屏幕。所有的对象都有似乎是正确的数据，但可惜没有骰子。任何帮助，将不胜感激。

```
<!DOCTYPE html>
<html>
<head>
<title>Google Maps Test</title>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=<key removed>&sensor=false"></script>
<style type="text/css">
</style>
<script type="text/javascript">
function initialize() {
    var myLatLng = new google.maps.LatLng(33.001466, -97.354317);

    var mapOptions = {
        zoom:6,
        center:myLatLng,
        mapTypeId: google.maps.MapTypeId.TERRAIN
    };
    console.log(mapOptions);

    var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
    console.log(map);

    var routeCoordinates = [
        new google.maps.LatLng(33.001466, -97.354317),
        new google.maps.LatLng(33.025001, -97.352171),
        new google.maps.LatLng(33.033219, -97.341700),
        new google.maps.LatLng(33.049321, -97.320414),
        new google.maps.LatLng(33.051335, -97.304020),
        new google.maps.LatLng(33.059464, -97.298355),
        new google.maps.LatLng(33.083919, -97.295609),
        new google.maps.LatLng(33.111314, -97.291918),
        new google.maps.LatLng(33.136042, -97.289257),
        new google.maps.LatLng(33.182818, -97.287111)
    ];
    console.log(routeCoordinates);

    var routePath = new google.maps.Polyline({
        path:routeCoordinates,
        strokeColor:"#000000",
        strokeOpacity:.90,
        strokeWeight: 2,
        editable:false
    });
    console.log(routePath);

    routePath.setMap(map);
}
</script>
</head>
<body onload="initialize()">
<div id="map_canvas">

</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:47:49.860

如果我删除密钥并给地图 div 一个大小，你的地图对我有用。

[http://www.geocodezip.com/JohnSwaringenSO.html](http://www.geocodezip.com/JohnSwaringenSO.html)

# ios - 我的应用程序不会保持登录到 Facebook

> ID：12485174
> 
> 赞同：0
> 
> 时间：2012-09-18T21:17:12.113
> 
> 标签：ios, facebook

我有一个小应用程序，它尝试使用 Facebook 教程中用于登录的确切方法使用 FB 进行基本登录：[https ://developers.facebook.com/docs/howtos/login-with-facebook-using-ios -SDK/](https://developers.facebook.com/docs/howtos/login-with-facebook-using-ios-sdk/)

期望的行为是用户能够登录到 FB 并保持登录状态，直到他们通过单击注销按钮明确选择注销。即使应用程序被强行杀死（但未删除），他们也应该在应用程序启动期间保持登录状态。

发生的情况是，单击登录按钮后，应用程序正确登录用户，但是一旦我导航回根视图控制器，然后返回 FacebookViewController，按钮再次显示登录，而不是注销。某处的某些东西正在杀死会话。

我不确定会要求什么代码，但这里有一堆：

```
#import "FacebookViewController.h"

@interface FacebookViewController ()

@end

@implementation FacebookViewController
@synthesize authButton;
@synthesize postSwitch;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    [[NSNotificationCenter defaultCenter]
     addObserver:self
     selector:@selector(sessionStateChanged:)
     name:FBSessionStateChangedNotification
     object:nil];

    // Check the session for a cached token to show the proper authenticated
    // UI. However, since this is not user intitiated, do not show the login UX.
    AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
    [appDelegate openSessionWithAllowLoginUI:NO];

    // Set toggle
    if ([[[NSUserDefaults standardUserDefaults] objectForKey:@"postToFB"] isEqualToString:@"Yes"]) {
        //set to yes
        [postSwitch setOn:YES animated:YES];
    } else {
        // set to no
        [postSwitch setOn:NO animated:YES];
    }

    NSLog(@"postToFB is now %@",[[NSUserDefaults standardUserDefaults] objectForKey:@"postToFB"]);
}

- (IBAction)authButtonAction:(id)sender
{
    AppDelegate *appDelegate =
    [[UIApplication sharedApplication] delegate];

    // If the user is authenticated, log out when the button is clicked.
    // If the user is not authenticated, log in when the button is clicked.
    if (FBSession.activeSession.isOpen) {
        [appDelegate closeSession];
    } else {
        // The user has initiated a login, so call the openSession method
        // and show the login UX if necessary.
        [appDelegate openSessionWithAllowLoginUI:YES];
    }
}

- (IBAction)togglePostSwitch:(id)sender
{
    if ([[[NSUserDefaults standardUserDefaults] objectForKey:@"postToFB"] isEqualToString:@"Yes"]) {
        //set to No
        [[NSUserDefaults standardUserDefaults] setObject:@"No" forKey:@"postToFB"];
    } else {
        // set to yes
        [[NSUserDefaults standardUserDefaults] setObject:@"Yes" forKey:@"postToFB"];
    }

    NSLog(@"postToFB is now %@",[[NSUserDefaults standardUserDefaults] objectForKey:@"postToFB"]);
}

- (void)sessionStateChanged:(NSNotification*)notification
{
    if (FBSession.activeSession.isOpen) {
        [self.authButton setTitle:@"Logout of Facebook" forState:UIControlStateNormal];

    } else {
        [self.authButton setTitle:@"Login to Facebook" forState:UIControlStateNormal];

    }
}

@end 
```

MainViewController（根 VC）在 ViewDidLoad 和 ViewWillAppear 中有以下内容：

```
- (void)viewDidLoad
{
    [[self navigationController] setNavigationBarHidden:YES animated:NO];
    AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
    BOOL open = [appDelegate openSessionWithAllowLoginUI:NO];
    if (open) {
        NSLog(@"User session found (MainVC viewDidLoad)");
    } else {
        NSLog(@"no session detected");
    }

}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:NO];
    [[self navigationController] setNavigationBarHidden:YES animated:NO];
} 
```

我不清楚为什么会发生这种行为。任何帮助都会被极大地接受:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T21:05:36.780

我实际上将此追溯到标记登录按钮的错误。即使按钮显示“登录”，会话也始终处于打开状态。我设法纠正了这个问题，但现在我发现该应用程序确实不会在启动时保持登录状态，但至少登录/注销按钮总是正确的！

# c# - 使用旧程序集的 IIS 和 Azure

> ID：12485179
> 
> 赞同：2
> 
> 时间：2012-09-18T21:17:42.453
> 
> 标签：c#, asp.net, iis, azure

当我在 Visual Studio 中构建我的项目时，我构建了我的整个解决方案并检查`http://localhost`了我的开发环境（使用标准 iis webapp），当我想要推送到暂存时，我发布到我的 azure env。突然之间，每当我构建我的解决方案时，它都会引用我项目的一些旧编译的 .dll，因为同样的错误不断出现。我确信这一点，因为当我进入`myproject/bin`文件夹并分别取出这些 dll 并在我的 iis bin 文件夹或我的 azure 服务器上覆盖它们时，错误就消失了，我最近的代码就在那里。我不太清楚为什么它一直这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T23:25:50.443

我在我的参考资料下进入Visual Studio并选择了我的dll并将“特定版本”更改为true，然后重建解决方案，然后将“特定版本”重新设置为false。这很奇怪，因为它不是 100% 一致的，但它在大多数情况下都有效。

# c++ - 静态分配的可变大小数组如何在 C++ 中工作？

> ID：12485180
> 
> 赞同：3
> 
> 时间：2012-09-18T21:17:44.173
> 
> 标签：c++, compiler-errors, g++, dynamic-memory-allocation, static-memory-allocation

```
#include <iostream>

    using namespace std;

    int main(int argc, const char * argv[])
    {

        int size;
        cin >> size;
        int myArray[size]; //this shouldn't compile , right ? 

        return 0;
    } 
```

我认为这不会编译，但它实际上（使用 g++ 命令）。

我后来发现，即使标准 C++ 不支持可变大小的数组，GCC 实际上也允许可变大小的数组，这很奇怪！因为我听到每个人都说创建可变大小数组的唯一方法是使用动态分配 like`int* array = new int[size];`或 better `std::vector`。我以为 GCC 不允许那段代码！

无论如何，我的*理论*问题是，`myArray`数组是分配在***堆***区还是***堆栈***区？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:22:12.250

那是编译器方面的扩展。*它是如何工作的？*好吧，它只*在某种程度上*起作用。

该实现基本上将堆栈指针移动一个取决于数组大小的量，并通过数组名称调用中间的内存。它仅在某种程度上起作用，因为在 VLA 中，大小不是类型的组成部分，这意味着许多可用于常规数组的构造不能用这种类型完成，例如通过引用将数组传递给模板...`sizeof`通常提供，但作为运行时构造实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:21:11.953

您的示例中的 myArray 是在堆栈上分配的。g++ 有一个允许这个技巧的扩展。不需要堆来执行此操作，编译器只需生成代码以将堆栈指针增加在运行时计算的数量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:28:48.847

VLA 是一种**扩展**，许多实现对 C++ 语言都有自己的扩展。如果您希望 g++ 抱怨您不遵守标准，请传递`-pedantic`标志。VLA 位于堆栈上，速度非常快，但是，这也是问题的原因，因为您的堆栈空间有限。然而，在 C++ 中，我们有类似`std::vector`等的结构，因此实际上没有必要使用它们。

# java - Android 开发 - Java：我如何从文件中创建字节数组并返回

> ID：12485183
> 
> 赞同：-4
> 
> 时间：2012-09-18T21:17:50.220
> 
> 标签：java, android, arrays, file, byte

我正在做一个小项目，它应该类似于通过蓝牙的远程文件浏览器。

我有这个文件：

```
File directory = Environment.getExternalStorageDirectory(); 
```

我需要从此文件中创建一个字节数组以将其发送到第二部手机。

有人可以给我写代码吗？谢谢和对不起我的英语:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:21:03.520

```
FileInputStream fis = new ....;
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        byte[] buffer = new byte[1024];
        int readBytes = 0;
        while(readBytes != -1)
        {
            readBytes = fis.read(buffer);
            if(readBytes > 0)
            {
                bos.write(buffer, 0, readBytes);
            }
            else 
                break;
        }
        byte[] fileData = bos.toByteArray(); 
```

希望能帮助到你

# facebook - 自定义请求对话框

> ID：12485185
> 
> 赞同：0
> 
> 时间：2012-09-18T21:18:09.770
> 
> 标签：facebook, facebook-app-requests

我的应用程序的期望行为是：安装了我的应用程序的用户可以通过自定义请求“您的一个朋友邀请安装 MyApp”邀请其他用户安装它。请求者将是我的应用程序（如通知 API），所以有点匿名。

是否可以自定义请求对话框来执行此操作，或使用任何其他技术？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:25:33.367

应用程序生成的请求只能发送给已验证您的应用程序的用户。这是一种安全措施。如果任何应用程序都可以向任何用户发送请求，那么垃圾邮件的可能性将是天文数字。

此外，用户**想**知道是谁邀请他使用该应用程序，不是吗？你的建议将是非常有问题的。

所以回答你的问题，不。这是不可能的。对非授权用户的应用程序请求必须由授权用户发送。

# google-docs - 未找到 Google 文档文件夹

> ID：12485187
> 
> 赞同：0
> 
> 时间：2012-09-18T21:18:11.453
> 
> 标签：google-docs, google-drive-api, google-docs-api

我们使用的是 Document List API 版本 3。我们使用两足式 OAuth 并使用通过 Google Apps Marketplace 获得的权限获得访问权限。我们检索文件夹中包含的文件夹列表，如下所示： [https](https://docs.google.com/feeds/default/private/full/folder:[folder) : //docs.google.com/feeds/default/private/full/folder:[folder doc id]/contents/-/folder?xoauth_requestor_id=[user name ]

我们得到 9 个结果。我们保留这些文件夹的文档 ID。稍后我们使用它们的文档 ID 检索每个文件夹，如下所示，其中 [用户名] 与我们之前使用的相同： [https](https://docs.google.com/feeds/default/private/full/[folder) ://docs.google.com/feeds/default/private/full/[folder doc id]？ xoauth_requestor_id=[用户名]

我们能够获取 9 个中的 8 个的文档（文件夹），但是对于其中一个，无论我们何时尝试，无论我们是否重试，我们都会得到 ResourceNotFoundException。我们知道该文件夹仍然存在并且指定的用户可以访问它。

这与其他人最近报告的问题本质上相似： [找不到文档](https://stackoverflow.com/questions/12448323/document-not-found)

这可能是谷歌错误吗？除了迁移到 Google Drive API 之外，还有什么关于如何解决它的建议？

问候， LT

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T03:02:26.647

您将这些文档 ID（或者实际上是 contentSrc URL）保留了多长时间？我发现这些东西可能会在几个小时后过期，因此您不应将它们缓存任何时间。

# assembly - 在 LLVM 中调用 fsincos 指令比调用 libc sin/cos 函数慢？

> ID：12485190
> 
> 赞同：14
> 
> 时间：2012-09-18T21:18:33.703
> 
> 标签：assembly, llvm, inline-assembly, x87

我正在研究一种用 LLVM 编译的语言。只是为了好玩，我想做一些微基准测试。一方面，我在一个循环中运行了数百万次 sin / cos 计算。在伪代码中，它看起来像这样：

```
var x: Double = 0.0
for (i <- 0 to 100 000 000)
  x = sin(x)^2 + cos(x)^2
return x.toInteger 
```

如果我使用以下形式的 LLVM IR 内联汇编计算 sin/cos：

```
%sc = call { double, double } asm "fsincos", "={st(1)},={st},1,~{dirflag},~{fpsr},~{flags}" (double %"res") nounwind 
```

这比分别使用 fsin 和 fcos 而不是 fsincos 更快。但是，它比我单独调用`llvm.sin.f64`and`llvm.cos.f64`内部函数要慢，后者编译为对 C 数学库函数的调用，至少在我使用的目标设置下（启用 SSE 的 x86_64）。

似乎 LLVM 在单/双精度 FP 之间插入了一些转换——这可能是罪魁祸首。这是为什么？抱歉，我是大会的相对新手：

```
 .globl  main
    .align  16, 0x90
    .type   main,@function
main:                                   # @main
    .cfi_startproc
# BB#0:                                 # %loopEntry1
    xorps   %xmm0, %xmm0
    movl    $-1, %eax
    jmp     .LBB44_1
    .align  16, 0x90
.LBB44_2:                               # %then4
                                    #   in Loop: Header=BB44_1 Depth=1
    movss   %xmm0, -4(%rsp)
    flds    -4(%rsp)
    #APP
    fsincos
    #NO_APP
    fstpl   -16(%rsp)
    fstpl   -24(%rsp)
    movsd   -16(%rsp), %xmm0
    mulsd   %xmm0, %xmm0
    cvtsd2ss        %xmm0, %xmm1
    movsd   -24(%rsp), %xmm0
    mulsd   %xmm0, %xmm0
    cvtsd2ss        %xmm0, %xmm0
    addss   %xmm1, %xmm0
.LBB44_1:                               # %loop2
                                    # =>This Inner Loop Header: Depth=1
    incl    %eax
    cmpl    $99999999, %eax         # imm = 0x5F5E0FF
    jle     .LBB44_2
# BB#3:                                 # %break3
    cvttss2si       %xmm0, %eax
    ret
.Ltmp160:
    .size   main, .Ltmp160-main
    .cfi_endproc 
```

与调用 llvm sin/cos 内在函数的相同测试：

```
 .globl  main
    .align  16, 0x90
    .type   main,@function
main:                                   # @main
    .cfi_startproc
# BB#0:                                 # %loopEntry1
    pushq   %rbx
.Ltmp162:
    .cfi_def_cfa_offset 16
    subq    $16, %rsp
.Ltmp163:
    .cfi_def_cfa_offset 32
.Ltmp164:
    .cfi_offset %rbx, -16
    xorps   %xmm0, %xmm0
    movl    $-1, %ebx
    jmp     .LBB44_1
    .align  16, 0x90
.LBB44_2:                               # %then4
                                    #   in Loop: Header=BB44_1 Depth=1
    movsd   %xmm0, (%rsp)           # 8-byte Spill
    callq   cos
    mulsd   %xmm0, %xmm0
    movsd   %xmm0, 8(%rsp)          # 8-byte Spill
    movsd   (%rsp), %xmm0           # 8-byte Reload
    callq   sin
    mulsd   %xmm0, %xmm0
    addsd   8(%rsp), %xmm0          # 8-byte Folded Reload
.LBB44_1:                               # %loop2
                                    # =>This Inner Loop Header: Depth=1
    incl    %ebx
    cmpl    $99999999, %ebx         # imm = 0x5F5E0FF
    jle     .LBB44_2
# BB#3:                                 # %break3
    cvttsd2si       %xmm0, %eax
    addq    $16, %rsp
    popq    %rbx
    ret
.Ltmp165:
    .size   main, .Ltmp165-main
    .cfi_endproc 
```

您能否建议使用 fsincos 的理想装配是什么样的？PS。向 llc 添加 -enable-unsafe-fp-math 会使转换消失并切换到双精度（fldl 等），但速度保持不变。

```
 .globl  main
    .align  16, 0x90
    .type   main,@function
main:                                   # @main
    .cfi_startproc
# BB#0:                                 # %loopEntry1
    xorps   %xmm0, %xmm0
    movl    $-1, %eax
    jmp     .LBB44_1
    .align  16, 0x90
.LBB44_2:                               # %then4
                                    #   in Loop: Header=BB44_1 Depth=1
    movsd   %xmm0, -8(%rsp)
    fldl    -8(%rsp)
    #APP
    fsincos
    #NO_APP
    fstpl   -24(%rsp)
    fstpl   -16(%rsp)
    movsd   -24(%rsp), %xmm1
    mulsd   %xmm1, %xmm1
    movsd   -16(%rsp), %xmm0
    mulsd   %xmm0, %xmm0
    addsd   %xmm1, %xmm0
.LBB44_1:                               # %loop2
                                    # =>This Inner Loop Header: Depth=1
    incl    %eax
    cmpl    $99999999, %eax         # imm = 0x5F5E0FF
    jle     .LBB44_2
# BB#3:                                 # %break3
    cvttsd2si       %xmm0, %eax
    ret
.Ltmp160:
    .size   main, .Ltmp160-main
    .cfi_endproc 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-06-28T20:44:31.910

## 硬件触发很慢。

太多文档声称 x87 指令类似于`fsin`或是`fsincos`执行三角函数的最快方法。这些说法往往是错误的。

最快的方法取决于你的 CPU。随着 CPU 变得越来越快，旧的硬件触发指令（例如）`fsin`并没有跟上步伐。对于某些 CPU，使用正弦或其他三角函数的多项式逼近的软件函数现在比硬件指令快。

总之，`fsincos`就是太慢了。

## 硬件触发已过时。

有足够的证据表明 x86-64 平台已经远离硬件触发。

*   对于浮点数，amd64 更喜欢 SSE 而不是 x87。然而，SSE 没有 x87 指令的等价物，例如`fsin`.
*   [对于 amd64， FreeBSD](http://svnweb.freebsd.org/base/head/lib/msun/)和[glibc](https://sourceware.org/git/?p=glibc.git;a=tree)中的 libm 都在软件中实现了 sin() 等功能，而不是 x87 trig。glibc使用多项式近似[为 sinf()](https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/x86_64/fpu/s_sinf.S;h=1529fb1f2452cefa1fdf482f8fa9165ffef4c197;hb=HEAD)（单精度正弦）优化了 x86-64 程序集，而不是 x87 `fsin`。[NetBSD](http://cvsweb.netbsd.org/bsdweb.cgi/src/lib/libm/?only_with_tag=MAIN)和[OpenBSD](http://www.openbsd.org/cgi-bin/cvsweb/src/lib/libm/)做出了相反的选择：它们用于 amd64 的 libm 确实使用 x87 指令。
*   Steel Bank Common Lisp`fsin`在其[x86 后端](http://sourceforge.net/p/sbcl/sbcl/ci/master/tree/src/compiler/x86/float.lisp)中使用，但不在其 x86-64 后端中使用。对于 x86-64，SBCL 编译[在 libm 中调用 sin() 的](http://sourceforge.net/p/sbcl/sbcl/ci/master/tree/src/code/irrat.lisp)代码。

## 硬件三角输了比赛。

从 2010 年开始，我在 AMD Phenom II X2 560 (3.3 GHz) 上对硬件和软件正弦进行了计时。我用这个循环编写了一个 C 程序：

```
volatile double a, s;
/* ... */
for (i = 0; i < 100000000; i++)
        s = sin(a); 
```

我用两个不同的 sin() 实现编译了这个程序两次。硬 sin() 使用 x87 `fsin`。软 sin() 使用多项式逼近。我的 C 编译器`gcc -O2`没有用 inline 替换我的 sin() 调用`fsin`。

以下是 sin(0.5) 的结果：

```
$ time race-hard 0.5
    0m3.40s real     0m3.40s user     0m0.00s system
$ time race-soft 0.5
    0m1.13s real     0m1.15s user     0m0.00s system 
```

这里的 soft sin(0.5) 非常快，这个 CPU 的 soft sin(0.5) 和 soft cos(0.5) 比一个 x87 快`fsin`。

对于罪（123）：

```
$ time race-hard 123
    0m3.61s real     0m3.62s user     0m0.00s system
$ time race-soft 123
    0m3.08s real     0m3.07s user     0m0.01s system 
```

软 sin(123) 比软 sin(0.5) 慢，因为 123 对于多项式来说太大了，所以函数必须减去 2π 的某个倍数。如果我还想要 cos(123)，那么对于 2010 年的这款 CPU，x87 有`fsincos`可能比 soft sin(123) 和 soft cos(123) 更快。

# c++ - 计算异常值的百分比函数

> ID：12485205
> 
> 赞同：2
> 
> 时间：2012-09-18T21:19:53.487
> 
> 标签：c++

在以下函数中，我收到异常值。

（请不要考虑匈牙利符号，我遵循旧来源的规则）

```
int nMaxHP = m_pDefender->GetMaxHitPoint();
u_long nPercentHP = 0;
if( nMaxHP > 0 )
    nPercentHP = (  nHP * 100 ) / nMaxHP;

CString show;
show.Format( "%u %d %d", nPercentHP, nMaxHP, nHP );
pUserAttacker->AddTextD3D( show, 0xffff0000 ); 
```

这是游戏客户端损坏代码的一部分，`m_pDefender`是大狮子柱，`nHP`是他受到伤害后的生命值，`nMaxHP`不言自明。 `AddTextD3D( CString format, DWORD color )`显示一条消息，如您在图像上看到的那样。 ![截屏](../Images/1f7ccdea28621be00bedba72c15efbdc.png)

问题是，
34.000.000 = nMaxHP
33.999.999 = nHP

33.999.999 * 100 = 3.399.999.900
3.399.999.900 / 34.000.000 = 99（或 99.99999705882353 双精度）

问题是为什么`nPercentHP`是4294967270？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T21:25:55.117

您的计算超出了 32 位算术最大值。

首先将所有内容转换为双倍

# javascript - 如何在我的页面中通过 jQuery 动态添加 google drive sdk 示例？

> ID：12485208
> 
> 赞同：1
> 
> 时间：2012-09-18T21:20:05.557
> 
> 标签：javascript, jquery, google-drive-api

这很简单，但我做不到。我可以在 index.html 中以正常方式执行此操作，但我需要动态添加和运行该代码。我正在尝试使用 jQuery 从 Drive SDK 页面[https://developers.google.com/drive/quickstart复制粘贴示例：](https://developers.google.com/drive/quickstart)

```
jQuery(document).ready(function(){

  // APPEND THE INPUT FROM THE EXAMPLE CODE
  jQuery('body').append('<input type="file" id="filePicker" style="visibility: hidden" />');

  / ** CONTINUE THE SDK EXAMPLE CODE **/
  var CLIENT_ID = 'XXXXXXX.apps.googleusercontent.com';
  var SCOPES = 'https://www.googleapis.com/auth/drive';
  function handleClientLoad() {
    window.setTimeout(checkAuth, 1);
  }
  [...]
  / ** FINISH THE EXAMPLE CODE **/

  // APPEND THE SCRIPT FROM EXAMPLE CODE
  jQuery('head').append('<script type="text/javascript" src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>');
}); 
```

它会那样工作吗？谢谢！

# asp.net-mvc-3 - MVC3 应用程序使用 asp.net 会员/声明感知应用程序 + STS

> ID：12485209
> 
> 赞同：0
> 
> 时间：2012-09-18T21:20:06.383
> 
> 标签：asp.net-mvc-3, asp.net-membership, wif

我有这个想法。我只是想检查是否有类似我已经完成的事情，或者我应该继续努力：

**使用 asp.net 成员的 MVC3 应用程序具有单点登录（因此它是一个将登录 STS 的声明感知应用程序）。**

我看过[http://identityserver.codeplex.com/](http://identityserver.codeplex.com/)但没有详细分析它：这是一个很好的解决方案吗？

我的问题是：有这样的事情吗？这是进行 SSO 的常用方法吗？（也使用会员资格？）

谢谢！..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:00:56.897

IdentityServer 是 STS 而不是应用程序。

如果您有一个声明感知应用程序，它会“模拟”成员资格提供程序。您可以配置 ADFS 以提供角色，然后使用标准 .NET 结构

IsInRole() 或

位置> ...允许角色= ...>

在 web.config 中。

# vb.net - vb.net 2010 - 从注册表读取不起作用 - win 7

> ID：12485211
> 
> 赞同：1
> 
> 时间：2012-09-18T21:20:11.003
> 
> 标签：vb.net, registry

我认为这会很简单，但是......

对，所以我只想从我的注册表中读取一个值。我已经经历了几个例子，但无法让它们中的任何一个起作用。我也尝试在管理员模式下运行我的应用程序，但仍然没有。有人可以帮忙吗？

在我尝试过的所有示例中，我将使用最简单的示例。

这有效：

```
Dim val As String
val = Registry.LocalMachine.OpenSubKey("Hardware\Description\System\CentralProcessor\0").GetValue("Identifier").ToString()
MsgBox(val) 
```

这个（我想要的）没有：

```
Dim val As String
val = Registry.LocalMachine.OpenSubKey("SOFTWARE\PTSClient").GetValue("ConfigDB").ToString()
MsgBox(val) 
```

后一个路径和值是我在注册表中手动创建的。我检查了两者之间的权限，它们完全相同。我也尝试以管理员身份运行该应用程序。我在 val= 行上收到运行时错误，它说：使用“new”关键字创建对象实例。

有任何想法吗？所有各种在线示例都失败了，对于我的生活，我无法弄清楚为什么......

干杯，J

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:13:57.917

好吧，我已经使用为 x86 编译的示例应用程序尝试了您的代码，并且正如预期的那样，它失败并出现空值异常。

我假设您正在为 x86 模式构建应用程序并在 64 位环境中运行。
当然，如果不是这种情况，请告诉我，我将删除此答案。

在上述情况下，LocalMachine.Software 注册表路径中的读/写调用将由操作系统自动更改为 Software\Wow6432Node 子项中的读/写，因此，您的代码无法找到您手动插入的密钥（“软件\PTSClient”）。
此代码将给出一个空值作为`Registry.LocalMachine.OpenSubKey("SOFTWARE\PTSClient")`导致无法获取 ConfigDB 值的返回值。

您需要将您的键/值添加到 Software\Wow6432Node 路径或为 AnyCPU 模式编译您的应用程序或让您的代码将值写入寄存器（它将被重定向到 Wow6432Node）。

# php - 在 Magento 中注册成功时发送管理员电子邮件

> ID：12485215
> 
> 赞同：0
> 
> 时间：2012-09-18T21:20:32.547
> 
> 标签：php, xml, magento, registration

我试图让[这个示例](https://stackoverflow.com/a/11315398/653929)在成功注册后通过电子邮件发送给管理员。'我认为'我已经正确设置了......但确实没有发生：

**配置.xml：**

```
<?xml version="1.0"?>
<config>
    <modules>
        <WACI_CustomerExt>
            <version>0.1.0</version>
        </WACI_CustomerExt>
    </modules>
    <global>
        <models>
            <WACI_CustomerExt>
                <class>WACI_CustomerExt_Model</class>
            </WACI_CustomerExt>
        </models>
        <template>
            <email>
                <!-- regisration success -->
                <notify_new_customer module="WACI_CustomerExt">
                    <label>Admin notification on registration success</label>
                    <file>notify_new_customer.html</file>
                    <type>html</type>
                </notify_new_customer>
            </email>
        </template>
    </global>
    <frontend>
        <events>
            <!-- regisration success -->
            <customer_register_success>
                <observers>
                    <WACI_CustomerExt>
                        <type>model</type>
                        <class>waci_customerext/observer</class>
                        <method>customer_register_success</method>
                    </WACI_CustomerExt>
                </observers>
            </customer_register_success>
        </events>
    </frontend>
</config> 
```

**命名空间/模块/组/Observer.php**

```
<?php 

require_once('../../../../../Mage.php');

class WACI_CustomerExt_Model_Observer 
{

    public function __construct()
    {

    }

    public function customer_register_success( Varien_Event_Observer $observer )
    {

        $emailTemplate  = Mage::getModel('core/email_template')
            ->loadDefault('notify_new_customer');
        $emailTemplate
            ->setSenderName(Mage::getStoreConfig('trans_email/ident_support/name'))
            ->setSenderEmail(Mage::getStoreConfig('trans_email/ident_support/email'))
            ->setTemplateSubject('New customer registered');
        $result = $emailTemplate->send(Mage::getStoreConfig('trans_email/ident_general/email'),(Mage::getStoreConfig('trans_email/ident_general/name'), $observer->getCustomer()->getData());

    }

} 
```

**本地/en_us/template/notify_new_customer.html**

```
New customer registration:<br />
Name: {{var name}}<br />
Email: {{var email}}<br />
... you win a pickle. 
```

有两件事看起来很可疑：我怀疑我的观察者在我的配置中设置是否正确。我希望我需要包含 app/mage.php （但在示例中它没有这样做）。

我在日志中没有收到任何错误，所以我假设事件没有得到注册或正确处理。

无论如何，在典型的 Magento 形式中，我的尝试是行不通的。

我很感激一些建议；D

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:59:19.380

日志记录肯定会产生包含错误

```
Failed opening 'Mage/Waci/Customerext/Model/Observer.php' 
```

显然，我的课堂参考需要正确的案例。

```
<events>
            <!-- regisration success -->
            <customer_register_success>
                <observers>
                    <WACI_CustomerExt>
                        <type>model</type>
                        <class>WACI_CustomerExt/Observer</class>
                        <method>customer_register_success</method>
                    </WACI_CustomerExt>
                </observers>
            </customer_register_success>
        </events> 
```

此外，就在这里的 send() 调用中出现了轻微的语法错误：`/email'),(Mage::getSt`。

无论如何，像往常一样，配置是我的问题。

# angularjs - 如何验证在 AngularJS e2e 测试中选中复选框的时间？

> ID：12485217
> 
> 赞同：30
> 
> 时间：2012-09-18T21:20:47.227
> 
> 标签：angularjs, angularjs-e2e

我一直在尝试[AngularJS e2e 测试](http://docs.angularjs.org/guide/dev_guide.e2e-testing)，但在确定是否选中复选框时遇到了困难。

[我将复选框输入](http://docs.angularjs.org/api/ng.directive:input.checkbox)的端到端测试用作示例（请参阅示例中的*端到端**测试*选项卡）。

 ***html片段：**

`Value1: <input type="checkbox" ng-model="value1"> <br/>`

**控制器片段：**

```
function Ctrl($scope) {
  $scope.value1 = true;
} 
```

**这是我尝试过的：**

1)`expect(binding('value1')).toEqual('true');`

只要`value1`在屏幕上显示，这在示例端到端测试中有效`{{value1}}`。如果您在本地对此进行测试并删除 `{{value1}}，则绑定测试将失败。在我的大多数真实示例中，我没有在屏幕上的任何地方显示复选框值。

2)`expect(input('value1').val()).toEqual('true');`

该值将始终默认为`on`并且与复选框是否处于选中状态无关（取自[这篇文章](https://stackoverflow.com/q/5621324/1207991)）。

* * *

**注意：**看起来 Angular E2E 测试将来会被[Protractor](https://github.com/angular/protractor)取代（请参阅[文档](http://docs.angularjs.org/guide/dev_guide.e2e-testing)）

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2014-09-07T22:27:47.570

对于使用[Protractor](https://github.com/angular/protractor)的任何人，都可以使用 webdriver [isSelected()](http://angular.github.io/protractor/#/api?view=webdriver.WebElement.prototype.isSelected)来解决这个问题。

`checked`您可以执行以下操作，而不是要求属性：

```
expect(element(by.model('value1')).isSelected()).toBeTruthy(); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-18T22:09:03.993

我赞成这个问题，因为我有同样的问题。我在测试中使用了以下解决方法，但我希望看到更好的方法。

```
expect( element('input[ng-model="value1"]').attr('checked') ).toBeTruthy(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T21:20:47.227

我希望有更好的方法，但我通过验证与该模型绑定匹配的已检查输入元素的计数来解决这个问题：

`expect(element('input[ng-model="value1"]:checked').count()).toBe(1);`

在检查是否未检查某些内容时，至少有一个缺点是该元素是否不存在或是否存在拼写错误，该值仍为 0，如本例所示：

`expect(element('input[ng-model="valueDoesNotExist"]:checked').count()).toBe(0);`*

# handlebars.js - {{#if foo }}{{ foo}}{{/if}} 有没有更好的方法来检查handlebars.js 中的值？（安静的参考符号）

> ID：12485230
> 
> 赞同：7
> 
> 时间：2012-09-18T21:21:20.813
> 
> 标签：handlebars.js

有没有更好的办法？

```
{{#if firstName }}  {{ firstName}}  {{/if}}
{{#if middleName }} {{ middleName}} {{/if}}
{{#if lastName }}   {{ lastName}}   {{/if}} 
```

我经常丢失数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-05-08T06:28:52.433

你也可以使用 `{{#with firstName}} {{this}} {{/with}}`

最好的方法是将名称保存为对象`{name:{first:'James', last:'Bond'}}`，然后：

`{{#with name}}{{last}}, {{first}} {{last}}{{/with}}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T17:08:03.433

使用车把，如果值为 null 或空车把将吐出一个空字符串，正如 Nick Kitto 所提到的。

所以只要 {{firstName}} {{middleName}} {{lastName}} 就可以了。但是，如果中间名是空白的，你最终会在名字和姓氏之间有 2 个空格，这是我能看到的唯一可能的问题。

# c# - Windows Phone 7.1 中的 POPUP 和事件问题

> ID：12485231
> 
> 赞同：0
> 
> 时间：2012-09-18T21:21:26.447
> 
> 标签：c#, wpf, windows-phone-7

我有一个激活服务的按钮，但在激活该服务之前，我需要强制用户输入文本，对于该任务，我创建了一个用户控件，允许用户输入文本并验证它，在该控件上我有 2按钮确定和取消，确定按钮工作正常，但取消应该隐藏弹出窗口，但事件不会被触发，我需要在此之前多次点击按钮，如果人回击我无法在不关闭应用程序的情况下摆脱弹出窗口。使用弹出窗口的最佳方法是什么，在这种情况下，为什么事件在第一次点击时没有被触发

公共部分类 TicketView { Controls.TextInputBox textInputControl;

```
 private void InitCloseTxtInput()
    {
        textInputControl = new Controls.TextInputBox(8, 0);
        textInputControl.CancelBtn.Click += new RoutedEventHandler(CancelBtn_Click);
        textInputControlForCamara.CancelBtn.Click += new RoutedEventHandler(CancelBtn_Click);
    }
    private void AppBarBtn_Click(object sender, EventArgs e)
    {
        InitCloseTxtInput();
        PivotContainer.IsEnabled = false;
        this.popup = new Popup();
        this.popup.Margin = new Thickness(0, 150, 0, 0);
        this.popup.Child = textInputControl;
        this.popup.IsOpen = true;
    }
    void OkBtnOnPopUP_Click(object sender, RoutedEventArgs e)
    {
       //Call Service
    }
    void CancelBtn_Click(object sender, RoutedEventArgs e)
    {
        this.popup.IsOpen = false;
        this.PivotContainer.IsEnabled = true;
    } 
```

}

如果有人对这段代码有任何疑问的建议，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T15:27:37.957

这条线是问题不完全知道为什么但是当试图重新控制时我评论这条线并且一切都开始工作得很好

this.popup.Margin = new Thickness(0, 150, 0, 0);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T05:24:35.643

至少在代码中，您似乎没有在`CancelBtnPopUP_Click`任何地方挂钩。

这是整个代码吗？

# jquery - 停止 MVC 应用程序请求不存在的特定 kquery (jquery-1.7.2)

> ID：12485233
> 
> 赞同：0
> 
> 时间：2012-09-18T21:21:27.837
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-4, bundler

我的 ASP MVC 页面不断请求 /scripts/jquery-1.7.2，但仅当我在某些页面中单击“返回”时。我不知道为什么。该文件不存在，因此出现“未定义 jquery”错误。

*   我已经从 Nuget 卸载了与 JQuery 相关的所有内容
*   我已经对包含文本“jquery-1.7*”的所有文件进行了 Windows 文件搜索。只有某些 JS 库中的注释包含文本。
*   我已经删除了所有与 JQuery 相关的旧文件
*   我已经清理了项目并删除了其中的 ~/obj/ 和 ~/bin/ 目录。
*   我已经从我的 BundleConfig 中删除了任何提及

作为该项目一部分的实际脚本文件：

![项目中包含的实际脚本文件（目录内容相同）](../Images/9689b94c166be472c3ac9ade0bdb5275.png)

我的 HTML 部分（略微修剪）

```
<head>
    <meta charset="utf-8" />
    <title>Foo</title>
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />

    <script type="text/javascript">         var myRootDir = '/';</script>

    <!--Problem here: Should not be loading these individual jqueryui files because they aren't in BundleConfig-->
    <link href="/Content/themes/base/jquery.ui.core.css" rel="stylesheet" type="text/css" />
    <!--Trimmed...-->
    <link href="/Content/themes/base/jquery.ui.theme.css" rel="stylesheet" type="text/css" />

    <link href="/Content/site.css" rel="stylesheet" type="text/css" />
    <link href="/Content/demo_table_jui.css" rel="stylesheet" type="text/css" />
    <link href="/Content/TableTools.css" rel="stylesheet" type="text/css" />
    <link href="/Content/TableTools_JUI.css" rel="stylesheet" type="text/css" />

    <!--Problem here: Where is this from?! -->
    <script src="/Scripts/jquery-1.7.2.js" type="text/javascript"></script>

    <script src="/Scripts/jquery-ui-1.8.20.js" type="text/javascript"></script>
    <script src="/Scripts/jquery.dataTables.js" type="text/javascript"></script>
    <script src="/Scripts/ZeroClipboard.js" type="text/javascript"></script>
    <script src="/Scripts/TableTools.js" type="text/javascript"></script>
    <script src="/Scripts/dataTables.editor.js" type="text/javascript"></script>
    <meta name="viewport" content="width=device-width" />
</head> 
```

我的捆绑配置：

```
public class BundleConfig
{
    public static void RegisterBundles(BundleCollection bundles) {
        bundles.Add(
            new ScriptBundle("~/bundles/jquery").Include(
                "~/Scripts/jquery-1.*"
            )
        );

        bundles.Add(new ScriptBundle("~/bundles/jqueryui").Include(
                    "~/Scripts/jquery-ui*"));

        bundles.Add(new ScriptBundle("~/bundles/dataTables").Include(
                    "~/Scripts/jquery.dataTables*",
                    "~/Scripts/ZeroClipboard*",
                    "~/Scripts/TableTools.*",
                    "~/Scripts/dataTables.editor.*"
                    ));

        bundles.Add(new StyleBundle("~/Content/css").Include(
            "~/Content/site.css",
            "~/Content/demo_table_jui.css",
            "~/Content/TableTools.css",
            "~/Content/TableTools_JUI.css"
            ));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T00:31:39.737

Mac Attack 的问题“你清除浏览器缓存了吗？”有点正确。浏览器缓存是问题，但我必须用 CCleaner 清除它。IE 的“安全 --> 删除浏览历史记录（☑ 检查所有内容）”由于某种原因不起作用。我什至手动杀死了所有 IE 进程，以防崩溃的进程锁定某些文件。

我也曾在 Firefox 中尝试过，当我第一次访问该页面时，出于某种原因，它做了同样的事情，但是“CTRL+F5”在 IE 中正常工作并解决了问题。

我有 +1 的 Mac Attack 的问题。

今天的教训：IE9 的缓存清除显然不起作用，至少在这种情况下是这样。

# sql - 来自 TSQL 中 Catch 块的 RAISERROR 传递给调用批处理 - 需要传递给调用应用程序

> ID：12485234
> 
> 赞同：1
> 
> 时间：2012-09-18T21:21:30.253
> 
> 标签：sql, tsql, sql-server-2005, try-catch, raiserror

我一直在研究 TRY/CATCH 块，我对如何以我需要的方式传递错误有点困惑。从我读过的内容来看，如果我理解正确，SQL 中的 CATCH 块中的 RAISERROR 将被传递给调用批处理或调用应用程序。该应用程序正在运行一个存储过程，其中包含一个事务。该事务被包装在一个 TRY/CATCH 块中。在 CATCH 块中，如果事务中的某些内容失败导致它跳转到 CATCH，我将引发错误。如果通过 SSMS 运行该过程，则错误显示正常并且事务回滚。但是，如果应用程序调用存储过程并发生相同的错误，则应用程序永远不会知道错误，因此现在过程不会失败。

首先，我是否正确理解了 CATCH 中的 RAISERROR 是如何工作的？如果是这样，我怎样才能将该错误引发回调用应用程序？

```
BEGIN TRY 
    BEGIN TRAN 
        ............... 
    COMMIT 
END TRY 
BEGIN CATCH 
    IF @@TRANCOUNT > 0 
        ROLLBACK 
    DECLARE @ErrMsg NVARCHAR(4000) 
    SELECT @ErrMsg = ERROR_MESSAGE() 
    RAISERROR(@ErrMsg, 16, 1) 
END CATCH 
```

我正在运行 Windows 7、SQL Server 2005

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T04:27:38.357

做你想做的最简单的方法是将@ErrMsg 声明为你的过程的输出参数并在你的调用应用程序中处理它。

如果您希望继续使用 RAISEERROR 来处理错误输出，可以在此处阅读有关 RAISEERROR 如何处理其输出的信息。[http://msdn.microsoft.com/en-us/library/ms178592.aspx](http://msdn.microsoft.com/en-us/library/ms178592.aspx)

# java - 找到适合区域的最大字体大小 - Java

> ID：12485236
> 
> 赞同：3
> 
> 时间：2012-09-18T21:21:39.757
> 
> 标签：java, jpanel, fontmetrics

我的 JPanel 中有一个区域，以点 (0,0) 和 (width,height) 为界。这是一个正方形。

我有话说

```
String s; 
```

我想找到我可以使用的最大字体大小`s`。现在，我知道有一种方法可以使用 FontMetrics 并制作一个 for 循环来不断增加字体的大小，直到它不适合该区域。但这太低效了，必须有一种方法来计算给定字体类型的字体大小，例如适合该区域的“Courier”。

BAD方式示例：

```
Font f = new Font("Courier", Font.PLAIN, 1);
FontMetrics fm = this.getFontMetrics(f); //this is a JPanel
do {
    f = new Font("Courier", Font.PLAIN, f.getSize()+1);
    fm = this.getFontMetrics(f);
while(fm.stringWidth(s) < width && fm.getHeight() < height); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-06T15:37:36.770

与仅迭代所有字体大小相比，我遇到了同样的问题并找到了一个稍微优化的解决方案。我尝试通过调整我添加或减去的差异来收敛到最佳字体大小，直到我发现差异字体大小低于 1。

```
Graphics2D graphics = image.createGraphics();
graphics.setColor(Color.black);

if (subtitleFont == null) {
    //create rectangle first (from a separate library
    int[] rect = matrix.getEnclosingRectangle();
    // define the maximum rect for the text
    Rectangle2D maxRect = new Rectangle2D.Float(0, 0, w - 7, h - rect[0] - rect[3] - 10);

    subtitleX = 0;
    subtitleY = 0;
    // starting with a very big font due to a high res image
    float size = 80f * 4f;
    // starting with a diff half the size of the font
    float diff = size / 2;
    subtitleFont = graphics.getFont().deriveFont(Font.BOLD).deriveFont(size);
    FontMetrics fontMetrics = graphics.getFontMetrics(subtitleFont);
    Rectangle2D stringBounds = null;

    while (Math.abs(diff) > 1) {
        subtitleFont = subtitleFont.deriveFont(size);
        graphics.setFont(subtitleFont);
        fontMetrics = graphics.getFontMetrics(subtitleFont);
        stringBounds = fontMetrics.getStringBounds(options.subtitle, graphics);
        stringBounds = new Rectangle2D.Float(0f, 0f, (float) (stringBounds.getX() + stringBounds.getWidth()), (float) ( stringBounds.getHeight()));

        if (maxRect.contains(stringBounds)) {
            if (0 < diff) {
                diff = Math.abs(diff);
            } else if (diff < 0) {
                diff = Math.abs(diff) / 2;
            }
        } else {
            if (0 < diff) {
                diff = - Math.abs(diff) / 2;
            } else if (diff < 0) {
                if (size <= Math.abs(diff)) {
                    diff = - Math.abs(diff) / 2;
                } else {
                    diff = - Math.abs(diff);
                }
            }
        }
        size += diff;
    }

    subtitleX = (int) ((w/2) - (stringBounds.getWidth() / 2));
    subtitleY = (int) (h - maxRect.getHeight() + fontMetrics.getAscent());
}

graphics.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING,
        RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
graphics.drawString(options.subtitle, subtitleX, subtitleY); 
```

我已经尝试过使用不同的图像分辨率和字体大小。需要 10 到 12 次迭代，直到找到适合最大矩形的字体。我希望它对某人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-19T06:10:29.800

是的，我也遇到了同样的问题，我知道你所说的“低效”是什么意思。

我尝试了一个解决方案，通过字体大小测量字符串的单位计数：1（默认）。

例如：

```
String line = "This is a test";
Font font = Font.createFont(Font.TRUETYPE_FONT, new File("/var/fonts/times.ttf"));
FontRenderContext ctx = new FontRenderContext(font.getTransform(), false, false);
Rectangle2D rect = font.getStringBounds(line, ctx);
BigDecimal widthUnits = BigDecimal.valueof(rect.getWidth()); 
```

然后，您通过字体大小 1 获得行的宽度单位。如果它除以区域宽度并保留整数部分（向下舍入），您将获得水平的最大字体大小。

```
int maxSizeHor = BigDecimal.valueOf(width)
                 .divide(widthUnits, 1, BigDecimal.ROUND_DOWN)
                 .intValue(); 
```

但是，还不够。您还应该垂直计算最大字体大小。幸运的是，具有相同字体样式和字体大小的每一行具有相同的高度。如果有多行，您可以使用：

```
lines.length * each height in font size 1. 
```

例如：

```
String[] lines = new String{"This is a test", "Hello World!"};
BigDecimal heightUnits = BigDecimal.valueOf(rect.getHeight())
                         .multiply(BigDecimal.valueOf(lines.length));
int maxSizeVer = BigDecimal.valueOf(height)
                 .divide(heightUnits
                         .multiply(BigDecimal.valueOf(lines.length)), 
                        1,BigDecimal.ROUND_DOWN)
                 .intValue(); 
```

最后，比较并获取最小值作为最大字体大小：

```
Math.min(maxSizeHor, maxSizeVer) 
```

但是，我遇到了另一个问题：单个字符“i”作为字体大小的输入字符串：1，您将获得宽度单位：0.0。但是，实际上，尽管它是一个非常小的值，但它不会为零。所以我将默认字体大小设置为 1000，并在每次进度后除以 1000。然后我得到非零值。

# javascript - 在非 AMD 代码上使用 dojo/select

> ID：12485237
> 
> 赞同：2
> 
> 时间：2012-09-18T21:21:41.593
> 
> 标签：javascript, jquery-selectors, dojo, amd, sizzle

我的网站上有使用 Sizzle 作为选择器引擎的旧版 JavaScript。

我最近添加了 dojo 库 (v 1.8) 用于可视化目的（图表等）。因为 dojo 包含选择器 (dojo/select)，所以我认为 Sizzle 现在是多余的，我可以用 dojo/select 替换它。有没有办法让 dojo/select 与非 AMD 代码一起工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T23:20:59.543

[根据文档](http://dojotoolkit.org/reference-guide/1.8/dojo/query.html)，您可以将 DOJO 选择器引擎换成 AMD/Dojo 兼容版本的[sizzle](https://github.com/kriszyp/sizzle)或[slick](https://github.com/kriszyp/slick)。因此，如果我是你，我会保留 Sizzle 并将 dojo 的底层选择器更改为 Sizzle，从而消除冗余而无需触及遗留代码。

> 我们还可以使用其他选择器引擎级别。Sizzle 和 Slick 都是与 dojo/query 一起工作的优秀选择器引擎。AMD/Dojo 兼容版本（仅包含 AMD）可在此处获得：
> 
> *   [https://github.com/kriszyp/sizzle](https://github.com/kriszyp/sizzle)
> *   [https://github.com/kriszyp/slick](https://github.com/kriszyp/slick)
> 
> 安装后，您可以使用选择器引擎模块 ID 作为指定的选择器引擎级别。我们可以将 Sizzle 设置为我们页面的查询引擎：
> 
> ```
> <script data-dojo-config="selectorEngine: 'sizzle/sizzle'" src="dojo/dojo.js">
> </script> 
> ```
> 
> 或将 Slick 设置为特定模块的引擎：
> 
> ```
> define(["dojo/query!slick/Source/slick"], function(query){
>   query(".someClass:custom-pseudo").style("color", "red");
> }); 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T07:03:15.410

[Brandon Boone](https://stackoverflow.com/users/402706/brandon-boone)的回答非常有用，因此您不必重写选择器字符串。我认为您要问的是如何导出[`dojo/query`](http://livedocs.dojotoolkit.org/dojo/query)到全局命名空间，即`window`通过 AMD 的异步特性导出到对象中。有两种选择：

1.  如果你使用release版本，它`dojo/query`已经打包了`dojo.js`，所以你不必关心模块工厂函数的异步执行，只需*导出*变量：

    ```
    <script 
        src="http://ajax.googleapis.com/ajax/libs/dojo/1.8.0/dojo/dojo.js"
        data-dojo-config="async:true"
    ></script>

    <script>
        // export query module to global namespace (window object)
        require(["dojo/query"], function(query) {
            window.query = query;        
        });
    </script>

    <script>
        // query function is now available globally
        console.log(query("li"));
    </script> 
    ```

    在 jsFiddle 上查看此示例：http: [//jsfiddle.net/phusick/gvnGu/](http://jsfiddle.net/phusick/gvnGu/)

2.  如果你使用 baseless dojo，它会更加棘手，因为你实际上必须等待`dojo/query`加载：

    ```
    <script src="dtk-sdk/dojo/dojo.js" data-dojo-config="async:true"></script>

    <script>
        // wrap your lecacy code into a function so it's not executed immediately
        var executeNonAmdCode = function() {
            console.log(query("li"));
        }
    </script>

    <script>
        require(["dojo/query"], function(query) {
            // export query module to global namespace (window object)
            window.query = query;
            // execute the legacy code
            executeNonAmdCode();
        });
    </script> 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T04:33:23.640

要添加到@phusick 的答案，我刚刚了解到从 v1.8 dojo 开始支持这一点：

```
<script type="dojo/require">
    "myApp.query": "dojo/query"
</script> 
```

上面的代码会将查询方法添加到全局 myApp 对象中（并在需要时创建 myApp）。

来源：

[http://dojotoolkit.org/reference-guide/1.8/dojo/parser.html#dojo-parser](http://dojotoolkit.org/reference-guide/1.8/dojo/parser.html#dojo-parser)

# asp.net - asp.net gridview 寻呼机悬停

> ID：12485238
> 
> 赞同：1
> 
> 时间：2012-09-18T21:21:46.663
> 
> 标签：asp.net, css, gridview

当我将鼠标悬停在我的 gridview 上时，我应用 css 来突出显示鼠标所在的行。这也适用于寻呼机，尽管它位于我的网格视图的顶部和底部。我**不能**将颜色样式 css 应用于寻呼机行吗？谢谢达摩

**CSS**

```
.mGrid tr:hover{background-color:#FFFFCC;color:white;} 
```

**HTML**

```
<asp:GridView ID="GridViewMain" OnRowDataBound="RowDataBound" OnPageIndexChanging="GridViewMain_PageIndexChanging"
     runat="server"  AllowPaging="True" PageSize="5" PagerSettings-Position="TopAndBottom"
     CssClass="mGrid"
     PagerStyle-CssClass="pgr"
     AlternatingRowStyle-CssClass="alt"
     OnRowCreated="GridViewMain_RowCreated">
</asp:GridView> 
```

**代码后面添加一个下拉到寻呼机**

```
protected void GridViewMain_RowCreated(object sender, GridViewRowEventArgs e)
        {
            if (e.Row.RowType == DataControlRowType.Pager)
            {
                DropDownList GridViewMainddl = new DropDownList();
                //adds variants of pager size
                GridViewMainddl.Items.Add("5");
                GridViewMainddl.Items.Add("10");
                GridViewMainddl.Items.Add("20");
                GridViewMainddl.Items.Add("50");
                GridViewMainddl.Items.Add("100");
                GridViewMainddl.Items.Add("200");
                GridViewMainddl.Items.Add("500");
                GridViewMainddl.Items.Add("All");
                GridViewMainddl.AutoPostBack = true;
                //selects item due to the GridView current page size
                ListItem li = GridViewMainddl.Items.FindByText(GridViewMain.PageSize.ToString());
                if (li != null)
                    GridViewMainddl.SelectedIndex = GridViewMainddl.Items.IndexOf(li);
                GridViewMainddl.SelectedIndexChanged += new EventHandler(GridViewMainddl_SelectedIndexChanged);
                //adds dropdownlist in the additional cell to the pager table
                Table pagerTable = e.Row.Cells[0].Controls[0] as Table;
                TableCell cell = new TableCell();
                cell.Style["padding-left"] = "15px";
                cell.Controls.Add(new LiteralControl("Page Size:"));
                cell.Controls.Add(GridViewMainddl);
                pagerTable.Rows[0].Cells.Add(cell);

            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:57:29.277

您可以使用 gridview 的 Row_DataBound 事件来实现这一点。您可以只选择包含数据的单元格而不包括其中的寻呼机。试试这个

```
protected void RowDataBound(Object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        e.Row.Attributes.Add("onmouseover", "this.originalstyle=this.style.backgroundColor;this.style.backgroundColor='#FFFFCC'");
        e.Row.Attributes.Add("onmouseout", "this.style.backgroundColor=this.originalstyle");
    }
} 
```

如果您不想使用内联样式..那么您也可以使用 ClassNames ..但是您需要在页面中添加一些 jQuery 代码..在页面的 head 部分中只包含这个，它应该工作也很好..

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<style type="text/css">
   .hoverClass
   {
       background-color: Red !important;
       color: Green !important;
   }
</style>

<script type="text/javascript">
   $(document).ready(function() {
       Sys.WebForms.PageRequestManager.getInstance().add_endRequest(PostBack);
       PostBack();
   });

   function PostBack() {
      $('tbody tr:gt(1)').mouseover(function() {
           $(this).addClass('hoverClass');
       }).mouseout(function() {
        $(this).removeClass('hoverClass');
       });
   }
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T21:59:22.810

使用 的`RowStyle-CssClass`属性`GridView`将类应用于网格中的数据行。然后在样式表中使用该类来应用悬停样式。

网格视图：

```
<asp:GridView ID="GridViewMain"
    OnRowDataBound="RowDataBound"
    OnPageIndexChanging="GridViewMain_PageIndexChanging"
    runat="server" 
    AllowPaging="True"
    PageSize="5"
    PagerSettings-Position="TopAndBottom"
    CssClass="mGrid"
    PagerStyle-CssClass="pgr"
    AlternatingRowStyle-CssClass="alt data-row"
    RowStyle-CssClass="data-row"
    OnRowCreated="GridViewMain_RowCreated">
 </asp:GridView> 
```

风格：

`.mGrid tr.data-row:hover { background-color:#FFFFCC; color:white; }`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T21:54:55.893

你可以试试这个。。

```
.mGrid tr:not(.pgr):hover{background-color:#FFFFCC;color:white;} 
```

# mysql - 从 sql 备份文件更新 1 列

> ID：12485239
> 
> 赞同：1
> 
> 时间：2012-09-18T21:21:49.830
> 
> 标签：mysql, sql, phpmyadmin

我有一个表`srSignals`，在一个名为的数据库`signals`中，如下所示：

```
animal      inserttime              id
dog         1970-00-00 00:00:00     3042
cat         1970-00-00 00:00:00     3041
monkey      1970-00-00 00:00:00     3040
hamster     1970-00-00 00:00:00     6 
```

我所有的`inserttime`价值观都在意外中重置为 1970 年。幸运的是，我有一个`signals`具有正确`inserttime`值（和相应`id`值）的数据库备份。备份文件被调用`signals.sql.gz`（`signals.sql`显然是在 gz 压缩中）。

我的问题是：使用 phpMyAdmin，我怎样才能将现有表`update`的列=备份文件的列。请注意，我不想完全恢复表，因为在此期间已将其他内容添加到数据库中。`inserttime``id``id`

我不确定解决这个问题的最佳方法 - 恢复 phpMyAdmin 的功能？一些花哨的更新/加载？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T21:38:41.700

将备份恢复到不同的数据库，然后进行更新：

```
UPDATE database1.table, database2.table
SET database1.table.field = database2.table.field
WHERE database1.table.idfield = database2.table.idfield 
```

# python - 元组转换为字符串

> ID：12485244
> 
> 赞同：4
> 
> 时间：2012-09-18T21:22:25.517
> 
> 标签：python

我有以下列表：

```
[('Steve Buscemi', 'Mr. Pink'), ('Chris Penn', 'Nice Guy Eddie'), ...] 
```

我需要将其转换为以下格式的字符串：

```
"(Steve Buscemi, Mr. Pink), (Chris Penn, Nice Guy Eddit), ..." 
```

我试着做

```
str = ', '.join(item for item in items) 
```

但遇到以下错误：

```
TypeError: sequence item 0: expected string, tuple found 
```

我将如何进行上述格式化？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-18T21:27:26.503

```
', '.join('(' + ', '.join(i) + ')' for i in L) 
```

输出：

```
'(Steve Buscemi, Mr. Pink), (Chris Penn, Nice Guy Eddie)' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-18T21:26:35.650

你很近。

```
str = '(' + '), ('.join(', '.join(names) for names in items) + ')' 
```

输出：

```
'(Steve Buscemi, Mr. Pink), (Chris Penn, Nice Guy Eddie)' 
```

分解：外括号是单独添加的，而内括号是由第一个生成的`'), ('.join`。括号内的名称列表使用单独的`', '.join`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-18T21:25:24.463

```
s = ', '.join( '(%s)'%(', '.join(item)) for item in items ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T21:25:03.027

您可以简单地使用：

```
print str(items)[1:-1].replace("'", '') #Removes all apostrophes in the string 
```

您想省略列表中方括号的第一个和最后一个字符。正如许多评论中提到的，这会在字符串周围留下单引号。您可以使用`replace`.

**注意**正如@ovgolovin 所指出的，这将**删除所有撇号，即使是名称中的撇号**。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T21:24:21.920

你很亲近……

```
print ",".join(str(i) for i in items) 
```

或者

```
print str(items)[1:-1] 
```

或者

```
print ",".join(map(str,items)) 
```

# c# - MVC ninject ViewEngine

> ID：12485246
> 
> 赞同：0
> 
> 时间：2012-09-18T21:22:28.677
> 
> 标签：c#, .net, asp.net-mvc, dependency-injection, ninject

我正在尝试在 MVC4 中创建我自己的自定义 ViewEngine 为了做到这一点，我想使用 ninject 注入一个存储库。

在阅读了有关 stackoverflow 的几篇文章和各种博客后，我想出了以下代码：

**新视图引擎.cs**

```
public class NewViewEngine: RazorViewEngine
{
    [Inject]
    private static IThemeRepository mThemeRepository { get; set; }
    ....
} 
```

**NinjectControllerFactory**

```
public class NinjectControllerFactory : DefaultControllerFactory
{
    private IKernel ninjectKernel;

    public NinjectControllerFactory()
    {
        ninjectKernel = new StandardKernel(new NinjectSettings { UseReflectionBasedInjection = true });
        AddBindings();
    }

    protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
    {
        return controllerType == null ? null : (IController)ninjectKernel.Get(controllerType);
    }

    private void AddBindings()
    {
        ninjectKernel.Bind<IThemeRepository>().To<EFThemeRepository>();
    }
} 
```

**全球.asax**

```
 protected void Application_Start()
    {
        AreaRegistration.RegisterAllAreas();

        WebApiConfig.Register(GlobalConfiguration.Configuration);
        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
        RouteConfig.RegisterRoutes(RouteTable.Routes);

        ControllerBuilder.Current.SetControllerFactory(new NinjectControllerFactory());

        ViewEngines.Engines.Clear();
        ViewEngines.Engines.Add(new ThemeViewEngine("web"));
    } 
```

但是，当我尝试运行它时，出现以下错误：

*对象引用未设置*为 mThemeRepository的对象实例

所以看起来我的存储库实际上没有被注入，现在我很困惑，任何想法可能是什么问题？

# java - java：调用方法

> ID：12485247
> 
> 赞同：3
> 
> 时间：2012-09-18T21:22:29.643
> 
> 标签：java, methods, subroutine

我只是在学习如何在 java 中创建一个子例程/方法，我遇到的问题是我不能用编译器调用我的方法，认为我的调用 (playGame();) 是对自身方法的尝试定义. 所以我收到错误“无效的方法声明；需要返回类型”。由于我是初学者，我确信这是一个愚蠢的错误，但我已经尝试重写很多次来修复它，但我无法弄清楚。

```
public class GUI {  
    public static void main(String[] args){

    }
    public static void playGame() {

    }
    playGame();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:23:47.570

您只能从另一个方法中调用一个方法，而不能从类的主体中调用。移动线

```
playGame(); 
```

方法内部`main`：

```
public static void main(String[] args){
    playgame();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:23:25.430

您的方法调用应该在另一个方法中，在这种情况下`main`（或）您也可以调用`playGame()`，但那将是`recursion`并且可能最终在`infinite loop.`

```
public static void main(String[] args){

playGame();
} 
```

请参阅[Java 编程语言精要](http://www.oracle.com/technetwork/java/index-138747.html)以了解有关如何编写 Java 程序的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:24:01.827

你不能像你正在做的那样直接从类体中调用方法。您需要`playGame()`从 main 方法调用方法。喜欢 ：

```
public class GUI {

    public static void main(String[] args){
       playGame();
    }
    public static void playGame() {
       // some  statements
    }    
} 
```

作为新手开始阅读[Java 教程](http://docs.oracle.com/javase/tutorial/java/index.html)。

# jquery - jquery.on() 不起作用

> ID：12485249
> 
> 赞同：1
> 
> 时间：2012-09-18T21:22:34.543
> 
> 标签：jquery, html, event-handling, handlebars.js

我有以下 HTML 结构，它是一个[handlebars.js](http://handlebarsjs.com/)模板：

```
<div class="row" id="{{serviceId}}">
            <div class="favorites" isfavorite="{{isFavorite}}">
                <img src="{{favImg}}" style="width:25px;">
            </div>
            <!-- end .favorites -->
            <div class="service">
                <p class="title">{{serviceName}}</p>
            </div>
            <div class="small serviceStat">

            </div>
            <div class="small metric">

            </div>
            <div class="performance"></div>
            <div class="icon email">
                <img src="../images/email.png" style="width:27px">
            </div>
        </div> 
```

`.on()`当我尝试使用它不起作用的方法将事件绑定到电子邮件类时：

```
$('.row').on('click','.email',function(){alert('clicked')});

 //or like this:
$('.email').on('click',function(){alert('clicked')}); 
```

但是，如果我将它与 live 绑定，它可以工作：

```
$('.email').live('click',function(){alert('clicked')}); 
```

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:30:18.097

问题是您需要`.row`在 DOM 中绑定您的委托处理程序 [您的元素将存在的位置]...

如果你有：

```
<div id="item-container">
    <!--divs with class row go in here -->
</div> 
```

你需要这样做：

```
$('#item-container').on('click', '.email', function() {alert('clicked'); }); 
```

这样做的原因是您的模板*实例*在文档准备好的 DOM 中不存在...所以您需要将事件绑定到*确实*存在的元素...又名，`item-container`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:26:01.360

这段代码

```
$('.row').on('click','.email',function(){alert('clicked')});

 //or like this:
$('.email').on('click',function(){alert('clicked')}) 
```

需要在这个范围内：

```
$(document).ready(function(){
   /* Code goes here */
}); 
```

我猜它不是。（这是为了确保在 DOM 准备好之后绑定事件）。

要么，要么您使用的是旧版本的 jQuery。`.on`在较新的版本之一中添加。

# java - 为什么 lucene 4.0 删除 IndexWriter 类的两个构造函数？

> ID：12485255
> 
> 赞同：0
> 
> 时间：2012-09-18T21:22:55.447
> 
> 标签：java, api, lucene

曾经有三个构造函数，例如

```
IndexWriter(String, Analyzer, boolean)
IndexWriter(String, Analyzer, boolean)
IndexWriter(Directory,Analyzer, boolean) 
```

但是现在只有一个构造函数，带来了一些不便，那么为什么要删除另外两个构造函数呢？

这种删除两个构造函数的糟糕api设计？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T23:28:03.420

简短的回答：随着时间的推移，IndexWriter 构造函数策略的整体变化主要是为了减少构造函数选项的扩散，并更好地封装正在使用的选项，以便它们可以共享和重用。

更长的答案：您所指的三个 arg 构造函数（目录/字符串/文件、分析器、布尔值）在 2008 年 10 月 11 日发布的 Lucene 2.4 中已弃用，然后在 Lucene 3.0（2009 年 11 月 26 日）中删除

底线：有整整一年的通知，这些构造函数最终会消失，并且它们在大约 3 年前发布的版本中被删除。

如果您有兴趣升级到非古代版本的 Lucene，并且您最大的抱怨是您的三个 arg IndexWriter 构造函数不再存在，那么只需将您的代码更改为如下所示...

```
IndexWriter w = new IndexWriter(dir, analyzer, true); 
```

......所以它看起来像这样......

```
IndexWriterConfig c = new IndexWriterConfig(Version.LUCENE_36,analyzer).setOpenMode(CREATE_OR_APPEND)
IndexWriter w = new IndexWriter(dir, config); 
```

...但我建议您不要只是盲目地进行更改，而是实际上查看 IndexWriterConfig 的文档并考虑一些现在可用的各种选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T19:44:48.530

实际上，在 Lucene 3.0.3 中，IndexWriter 有[5 个构造函数（不是 3 个）](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/all/org/apache/lucene/index/IndexWriter.html)，这是 IndexWriterConfig 出来之前的最后一个 GA 版本。这是[有关更改的原始票证](https://issues.apache.org/jira/browse/LUCENE-2294)（即 IndexWriterConfig 和删除其他构造函数的弃用）。票据顶部附近的讨论链接不再有效，但[Nabble 有它的副本](http://lucene.472066.n3.nabble.com/Lucene-2-9-and-deprecated-IR-open-methods-td592246.html)。

“这种糟糕的api设计是要删除两个构造函数吗？” 这是一个开放式问题，[SO FAQ 说不应该在 SO 上问](https://stackoverflow.com/faq#dontask)。无论如何，如果您想了解 Lucene 开发人员做出特定决定的意图，没有比直接询问 Lucene 开发人员更好的方法了，即在[官方 Lucene 邮件列表](http://lucene.apache.org/core/discussion.html)上，或者在[Lucene问题跟踪系统](https://issues.apache.org/jira/browse/LUCENE)。

如果我推测，这里有一些可能性：

*   他们可能忽略了这个问题或低估了（相对于像你这样的用户，因为重要性是主观的）保留构造函数的重要性。
*   保留构造函数会产生维护开销。除了让事情变得不那么“干净”（这又是主观的），开发人员还需要维护 IndexWriter（例如删除策略）和 IndexWriterConfig 中的默认设置。
*   维护构造函数以使用户不必更改其代码对于 3.0/4.0 转换的用处有限。因为 4.0 中有如此多的变化，人们不能指望仅仅放弃 Lucene Core 4.0 代码并期望他们的应用程序仍然可以工作。

如果你问我，那么不，我不认为这是“糟糕的 API 设计”。期望他们永远保持每个方法调用完好无损是不合理的。他们确实有一个向后兼容性政策，我理解其中的一部分，因为他们可以弃用任何想要的东西，但他们不会删除或破坏东西，直到下一个主要版本。最糟糕的之一？我认为它比其他一些流行的项目要好得多，这些项目在点发布之间没有可比的政策和/或改变行为（即使没有修复错误）。

# delphi - Delphi 2010 循环计数

> ID：12485256
> 
> 赞同：1
> 
> 时间：2012-09-18T21:23:03.887
> 
> 标签：delphi, for-loop, delphi-2010

我有一个 For 循环的问题。我需要它来计算随机数量的疯狂购物和数量，但按如下顺序显示它们。它还需要获取大量的狂欢并在之前显示。

目前它显示的总狂欢为 0，并且只显示 20 个非随机的狂欢。

您总共赢得了 3 次疯狂购物

在第 1 号大礼包中，您可能会花费 R100

在狂欢#2 中，您可能会花费 R341

在第 3 号大礼包中，您可能会花费 R451

总成本：= 0；

总和：= 0；

```
ListHead := 'Max per spree is R500.00 Max number of sprees 20';
lstNumber.Items.Add(ListHead);

  SpreeWon := 'You have won  ' + inttostr(Sum) + ' shopping sprees';
  lstNumber.Items.Add(SpreeWon);

for Count := 0 to 20 do
begin
    Sum := Random(Count);
    Prize := Random(500) + 1;
    ListItems := 'On spree # ' + inttostr(Sum) + ' you may spend R' + inttostr(Prize);
    lstNumber.Items.Add(ListItems);
    TotalCost := TotalCost + Prize;
end;
begin
    Cost := 'Total prize value : R' + inttostr(TotalCost);
    lstNumber.Items.Add(Cost);
end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:18:57.187

您的代码没有按照您的要求执行。您正在显示 20 个狂欢，因为您对其进行硬编码以生成 20 个狂欢，而不是随机数量的狂欢。

尝试更多类似的东西：

```
ListHead := 'Max per spree is R500.00 Max number of sprees 20';
lstNumber.Items.Add(ListHead);

Count := Random(20) + 1;
TotalCost := 0;

SpreeWon := 'You have won  ' + IntToStr(Count) + ' shopping sprees';
lstNumber.Items.Add(SpreeWon);

for I := 1 to Count do
begin
  Prize := Random(500) + 1;
  TotalCost := TotalCost + Prize;
  ListItems := 'On spree # ' + IntToStr(I) + ' you may spend R' + IntToStr(Prize);
  lstNumber.Items.Add(ListItems);
end;

Cost := 'Total prize value : R' + IntToStr(TotalCost);
lstNumber.Items.Add(Cost); 
```

# c# - c# 对象生命周期。使用检索到的指针值的位置

> ID：12485258
> 
> 赞同：0
> 
> 时间：2012-09-18T21:23:16.103
> 
> 标签：c#

mabby 这是一个愚蠢的问题）我有一个小误解：

"newobj" 使 CLR 能够： 1) 计算对象需要多少内存

2）如果堆有足够的内存 - 调用构造函数，检索内存中新对象到主代码的链接（地址是指向下一个对象的指针的最后位置）

3) 之前！检索引用将指针移动到下一个对象

这是一个例子： Car myCar = new Car;

所以，如果我理解的话，编译器会将“指向下一个对象的链接”写入 myCar ？如果我们需要编译器将“指向我们对象的链接”写入我的车..

如果可以，请描述它是如何工作的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:26:01.707

```
Car myCar = new Car; 
```

调用类型的构造函数，`Car`所有父类型的调用链从最深的类型开始。

分配空间，获得指向该内存位置的指针和分配给该内存的地址`myCar`。

基本步骤

# iphone - iOS iPhone CGImage 内存问题

> ID：12485260
> 
> 赞同：0
> 
> 时间：2012-09-18T21:23:19.770
> 
> 标签：iphone, ios, memory, cgimage

我正在尝试创建我拥有的一些数据的可视化表示。

我拥有的功能可以完美地（并且非常快速地）创建图像，但在仪器下，Real Memory 的使用量会飙升并最终导致应用程序崩溃。

我已经用 a 替换了我的函数，`return [UIImage imageNamed:@"blah"];`并且内存问题完全消失了。

想知道是否有人可以看到内存被占用的原因和位置以及我如何可能再次释放它？

我已经在分配和泄漏工具下运行了工具，但那里没有显示任何内容。

功能是...

```
- (UIImage*)imageOfMapWithDeadColor:(UIColor *)deadColor aliveColor:(UIColor *)aliveColor
{
//translate colours into rgb components
if ([deadColor isEqual:[UIColor whiteColor]]) {
    dr = dg = db = 255;
} else if ([deadColor isEqual:[UIColor blackColor]]) {
    dr = dg = db = 0;
} else {
    [deadColor getRed:&drf green:&dgf blue:&dbf alpha:&blah];

    dr = drf * 255;
    dg = dgf * 255;
    db = dbf * 255;
}

if ([aliveColor isEqual:[UIColor whiteColor]]) {
    ar = ag = ab = 255;
} else if ([aliveColor isEqual:[UIColor blackColor]]) {
    ar = ag = ab = 0;
} else {
    [aliveColor getRed:&arf green:&agf blue:&abf alpha:&blah];

    ar = arf * 255;
    ag = agf * 255;
    ab = abf * 255;
}

//create bytes of image from the cell map
int yRef, cellRef;

unsigned char *cell_ptr = cells;

for (int y=0; y<self.height; y++)
{
    yRef = y * (self.width * 4);

    int x = 0;
    do
    {
        cellRef = yRef + 4 * x;

        if (*cell_ptr & 0x01) {
            //alive colour
            buffer[cellRef] = ar;
            buffer[cellRef + 1] = ag;
            buffer[cellRef + 2] = ab;
            buffer[cellRef + 3] = 255;
        } else {
            //dead colour
            buffer[cellRef] = dr;
            buffer[cellRef + 1] = dg;
            buffer[cellRef + 2] = db;
            buffer[cellRef + 3] = 255;
        }
        cell_ptr++;
    } while (++x < self.width);
}

//create image
imageRef = CGImageCreate(self.width, self.height, 8, 32, 4 * self.width, CGColorSpaceCreateDeviceRGB(), kCGBitmapByteOrderDefault, provider, NULL, NO, kCGRenderingIntentDefault);

UIImage *image = [UIImage imageWithCGImage:imageRef];

//return image
return image;
} 
```

一些笔记...

buffer 是 init 中的 ivar GLubyte malloc-ed。cells 是我从中获取数据的原始 unsigned char 数组。

就像我说的，这个功能完美地工作（创建图像等......）我只是得到了大量的内存使用。

哦……这个功能被称为 LOTS，比如每秒 30 次或更多（我知道这会有所作为）。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T21:28:43.007

您使用 CGImageCreate 并且文档说：

**返回值** 一个新的 Quartz 位图图像。你负责通过调用 CGImageRelease 来释放这个对象。

# javascript - 具有范围的 JQuery 命名函数

> ID：12485262
> 
> 赞同：1
> 
> 时间：2012-09-18T21:23:30.097
> 
> 标签：javascript, jquery

我需要在我的页面上的一组相邻 DIVS 上执行单个函数。我认为它会像这样工作得最好：

```
function namedFunction(){
   setTimeout(3000);
   //do animations and such
   $(this).next().call(namedFunction);

}

$("#firstdiv").call(namedFunction()); 
```

但我找不到在设定范围（firstdiv 对象）中任意执行函数的方法，而且我什至不确定范围是否会正确传递。有没有办法做到这一点，或者更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:33:59.780

我猜你想要这个：

```
function namedFunction () {
   this.animate({ ... }, function () {
       namedFunction.call( $( this ).next() );
   });    
} 
```

进而：

```
namedFunction.call( $('#firstdiv') ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:40:37.390

该`setTimeout()`函数不会暂停当前执行，它会将您提供的函数的未来执行排队。要在页面加载时执行某些操作，请使用文档就绪处理程序。

我想你想要这样的东西：

```
$(document).ready(function() {
    var $divs = $("div.commonClass"),
        i = 0;
    function processNextDiv() {
        namedFunction($divs.eq(i));
        i = (i + 1) % $divs.length;
        setTimeout(processNextDiv, 3000);
    }
    processNextDiv();
}); 
```

这首先选择所有 div（我建议通过给它们一个公共类来这样做，但你可以按照你喜欢的任何方式这样做），然后设置一个基于超时的循环，调用`namedFunction()`将当前 div 传递给它以进行处理。那么你可以有：

```
function namedFunction($div) {
    $div.animate(...); // process current div
} 
```

或者您可以将动画或其他 div 处理代码直接放在该`processNextDiv()`函数中，具体取决于您是否希望能够`namedFunction()`从其他地方调用。

演示：http: [//jsfiddle.net/hWLTb/](http://jsfiddle.net/hWLTb/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-18T21:40:10.400

也许这个？

```
$("#firstdiv").nextAll("div").andSelf().each(function(){
    // this = DIV
}); 
```

# c# - 嵌套在类方法中的 C# 函数

> ID：12485268
> 
> 赞同：1
> 
> 时间：2012-09-18T21:23:34.113
> 
> 标签：c#, function, methods, nested

我正在尝试在 Class 方法中实现一个函数，但我对 C# 有点陌生。

基本上，我有一个方法可以遍历数据库中的行并将值设置为变量。然后，如果已创建文档，则更新该文档，否则创建该文档。我试图排除一些代码，但我不知道把它放在哪里，因为它仍然需要引用我的变量。我想排除 if else 语句中重复的项目。

```
 private void SyncKinases()
    {
        DataSet ds = new DataSet();
        ds = gn.ExecuteQuery("dx.kinasedatasheet.selectstagingkinases", null);

        TreeProvider tp = new TreeProvider(ui);
        VersionManager vm = new VersionManager(tp);
        TreeNode node;

        WorkflowManager wm = new WorkflowManager(tp);

        if (ds.Tables[0].Rows.Count > 0)
        {
            foreach (DataRow dr in ds.Tables[0].Rows)
            {
                string className = "dx.kinasedatasheet";
                string title = dr["Title"].ToString();
                string technologyPlatform = dr["TechnologyPlatform"].ToString();
                string ambitGeneSymbol = dr["AmbitGeneSymbol"].ToString();
                string targetDescription = dr["TargetDescription"].ToString();
                string entrezGeneSymbol = dr["EntrezGeneSymbol"].ToString();
                int entrezGeneID = int.Parse(dr["EntrezGeneID"].ToString());
                string aliases = dr["Aliases"].ToString();
                string kinaseGroup = dr["KinaseGroup"].ToString();
                string species = dr["Species"].ToString();
                string accessionNumber = dr["AccessionNumber"].ToString();
                string kinaseConstruct = dr["KinaseConstruct"].ToString();
                string kinaseForm = dr["KinaseForm"].ToString();
                string expressionSystem = dr["ExpressionSystem"].ToString();
                double avgZValue = 0;
                if (!(dr["AverageZValue"] is DBNull))
                {
                    avgZValue = double.Parse(dr["AverageZValue"].ToString());
                }
                string panel = dr["Panel"].ToString();
                string compoundsKds = dr["CompoundsKds"].ToString();
                string mutationRelevance = dr["MutationRelevance"].ToString();
                string mutationReferences = dr["MutationReferences"].ToString();

                string kinaseAliasPath = "/Kinase-Data-Sheets";

                if (!(dr["NodeID"] is System.DBNull))
                {
                    node = tp.SelectSingleNode(int.Parse(dr["NodeID"].ToString()));
                    vm.CheckOut(node);
                    node.DocumentName = ambitGeneSymbol;
                    node.NodeName = ambitGeneSymbol;
                    node.SetValue("Title", title);
                    node.SetValue("TechnologyPlatform", technologyPlatform);
                    node.SetValue("AmbitGeneSymbol", ambitGeneSymbol);
                    node.SetValue("TargetDescription", targetDescription);
                    node.SetValue("EntrezGeneSymbol", entrezGeneSymbol);
                    node.SetValue("EntrezGeneID", entrezGeneID);
                    node.SetValue("Aliases", aliases);
                    node.SetValue("KinaseGroup", kinaseGroup);
                    node.SetValue("Species", species);
                    node.SetValue("AccessionNumber", accessionNumber);
                    node.SetValue("KinaseConstruct", kinaseConstruct);
                    node.SetValue("KinaseForm", kinaseForm);
                    node.SetValue("ExpressionSystem", expressionSystem);
                    if (!(dr["AverageZValue"] is DBNull))
                    {
                        node.SetValue("AverageZValue", avgZValue);
                    }
                    node.SetValue("Panel", panel);
                    node.SetValue("CompoundsKds", compoundsKds);
                    node.SetValue("MutationRelevance", mutationRelevance);
                    node.SetValue("MutationReferences", mutationReferences);
                    node.SetValue("DocumentPublishTo", null);

                    node.Update();
                    updatedKinaseCount++;
                    vm.CheckIn(node, null, null);
                    WorkflowInfo wi = wm.GetNodeWorkflow(node);
                    if (node.IsPublished)
                    {
                        wm.AutomaticallyPublish(node, wi, null);
                    }
                }
                else
                {
                    node = TreeNode.New(className, tp);
                    node.DocumentName = ambitGeneSymbol;
                    node.NodeName = ambitGeneSymbol;
                    node.SetValue("Title", title);
                    node.SetValue("TechnologyPlatform", technologyPlatform);
                    node.SetValue("AmbitGeneSymbol", ambitGeneSymbol);
                    node.SetValue("TargetDescription", targetDescription);
                    node.SetValue("EntrezGeneSymbol", entrezGeneSymbol);
                    node.SetValue("EntrezGeneID", entrezGeneID);
                    node.SetValue("Aliases", aliases);
                    node.SetValue("KinaseGroup", kinaseGroup);
                    node.SetValue("Species", species);
                    node.SetValue("AccessionNumber", accessionNumber);
                    node.SetValue("KinaseConstruct", kinaseConstruct);
                    node.SetValue("KinaseForm", kinaseForm);
                    node.SetValue("ExpressionSystem", expressionSystem);
                    if (!(dr["AverageZValue"] is DBNull))
                    {
                        node.SetValue("AverageZValue", avgZValue);
                    }
                    node.SetValue("Panel", panel);
                    node.SetValue("CompoundsKds", compoundsKds);
                    node.SetValue("MutationRelevance", mutationRelevance);
                    node.SetValue("MutationReferences", mutationReferences);
                    node.SetValue("DocumentPublishTo", null);
                    node.SetValue("DocumentCulture", "en-US");

                    TreeNode parentNode = tp.SelectSingleNode("DiscoveRx", kinaseAliasPath, "en-US");
                    node.Insert(parentNode);
                    //vm.CheckIn(node, null, null);
                    newKinaseCount++;
                }
            }
        }
        ArchiveItems(archivedKinaseCount, "dx.kinasedatasheet.selectarchivekinases");
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:49:31.310

除了重构您的例程之外，我还建议您创建一些扩展方法来节省您的打字时间。例如，这是解析双打的扩展：

```
public static class Extensions
{
    public static double ToDoubleIfNotDBNull(this object item)
    {
       if (item is DBNULL) return 0;
       return double.Parse(item.ToString());
    }
} 
```

那么你的代码就变成了：

```
double avgZValue = dr["AverageZValue"].ToDoubleIfNotDBNull(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:30:03.057

你可以重构你的代码，这样你就不需要在不同的情况下设置节点值：

```
private void SyncKinases()
{
    DataSet ds = new DataSet();
    ds = gn.ExecuteQuery("dx.kinasedatasheet.selectstagingkinases", null);

    TreeProvider tp = new TreeProvider(ui);
    VersionManager vm = new VersionManager(tp);
    TreeNode node;

    WorkflowManager wm = new WorkflowManager(tp);

    if (ds.Tables[0].Rows.Count > 0)
    {
        foreach (DataRow dr in ds.Tables[0].Rows)
        {
            string className = "dx.kinasedatasheet";
            string title = dr["Title"].ToString();
            string technologyPlatform = dr["TechnologyPlatform"].ToString();
            string ambitGeneSymbol = dr["AmbitGeneSymbol"].ToString();
            string targetDescription = dr["TargetDescription"].ToString();
            string entrezGeneSymbol = dr["EntrezGeneSymbol"].ToString();
            int entrezGeneID = int.Parse(dr["EntrezGeneID"].ToString());
            string aliases = dr["Aliases"].ToString();
            string kinaseGroup = dr["KinaseGroup"].ToString();
            string species = dr["Species"].ToString();
            string accessionNumber = dr["AccessionNumber"].ToString();
            string kinaseConstruct = dr["KinaseConstruct"].ToString();
            string kinaseForm = dr["KinaseForm"].ToString();
            string expressionSystem = dr["ExpressionSystem"].ToString();
            double avgZValue = 0;
            if (!(dr["AverageZValue"] is DBNull))
            {
                avgZValue = double.Parse(dr["AverageZValue"].ToString());
            }
            string panel = dr["Panel"].ToString();
            string compoundsKds = dr["CompoundsKds"].ToString();
            string mutationRelevance = dr["MutationRelevance"].ToString();
            string mutationReferences = dr["MutationReferences"].ToString();

            string kinaseAliasPath = "/Kinase-Data-Sheets";

            bool isNewNode = false;
            if (!(dr["NodeID"] is System.DBNull))
            {
                node = tp.SelectSingleNode(int.Parse(dr["NodeID"].ToString()));
                vm.CheckOut(node);

            }
            else
            {
                node = TreeNode.New(className, tp);
                node.SetValue("DocumentCulture", "en-US");
                isNewNewNode = true;
            }

            node.DocumentName = ambitGeneSymbol;
            node.NodeName = ambitGeneSymbol;
            node.SetValue("Title", title);
            node.SetValue("TechnologyPlatform", technologyPlatform);
            node.SetValue("AmbitGeneSymbol", ambitGeneSymbol);
            node.SetValue("TargetDescription", targetDescription);
            node.SetValue("EntrezGeneSymbol", entrezGeneSymbol);
            node.SetValue("EntrezGeneID", entrezGeneID);
            node.SetValue("Aliases", aliases);
            node.SetValue("KinaseGroup", kinaseGroup);
            node.SetValue("Species", species);
            node.SetValue("AccessionNumber", accessionNumber);
            node.SetValue("KinaseConstruct", kinaseConstruct);
            node.SetValue("KinaseForm", kinaseForm);
            node.SetValue("ExpressionSystem", expressionSystem);
            if (!(dr["AverageZValue"] is DBNull))
            {
                node.SetValue("AverageZValue", avgZValue);
            }
            node.SetValue("Panel", panel);
            node.SetValue("CompoundsKds", compoundsKds);
            node.SetValue("MutationRelevance", mutationRelevance);
            node.SetValue("MutationReferences", mutationReferences);
            node.SetValue("DocumentPublishTo", null);

            if (isNewNode)
            {
                TreeNode parentNode = tp.SelectSingleNode("DiscoveRx", kinaseAliasPath, "en-US");
                node.Insert(parentNode);
                //vm.CheckIn(node, null, null);
                newKinaseCount++;

            }
            else
            {
                node.Update();
                updatedKinaseCount++;
                vm.CheckIn(node, null, null);
                WorkflowInfo wi = wm.GetNodeWorkflow(node);
                if (node.IsPublished)
                {
                    wm.AutomaticallyPublish(node, wi, null);
                }
            }
        }
    }
    ArchiveItems(archivedKinaseCount, "dx.kinasedatasheet.selectarchivekinases");
} 
```

您现在也不需要`dr`列中的所有这些临时变量，因为它们只会使用一次。删除这些将使您的方法更短且更具可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:26:33.397

只需创建一个新方法并将值作为参数发送。

```
void SetNodeValues(Node node, DataRow row)
{
    string title = dr["Title"].ToString();                
    ....

    node.SetValue("Title", title);
    ...
} 
```

您可能可以使用 for 循环完成所有操作（未经测试且与您的变量不匹配）

```
foreach(var col in Table.Columns)
    node.SetValue(col.Name, dr[col]); 
```

如果您使用的是 ORM，则可以发送一个对象而不是 DataRow，但这超出了此问题的范围。

# c# - 如何将行添加到排序的数据网格视图

> ID：12485270
> 
> 赞同：1
> 
> 时间：2012-09-18T21:23:40.657
> 
> 标签：c#, datagridview, sorted

我有一个绑定到数据库表的 DataGridView。Visual Studio 创建了网格和绑定导航器工具条。导航、插入、删除工作正常...但是：如果我通过单击某个列标题对网格进行排序，则插入一行会弄乱网格。传递给 RowsAdded 事件处理程序的行索引是错误的。它总是最后一行的索引，以前在未排序模式下很好。在排序模式下，我正在编辑错误的行，并且看不到找到正确行的索引的机会。即使索引始终是最后一行，所有数据绑定列也会正确显示。未绑定数据的列会出现此问题。在我的情况下，图像列取决于数据绑定列。图像始终绘制在最后一行。因此忽略排序...

这是我在 RowsAdded 事件处理程序中所做的事情：

```
for (int i = 0; i < e.RowCount; ++i)
        {
            DataGridViewRow row = dataGridView_Energietraeger.Rows[i + e.RowIndex];

            object idObj = row.Cells[Column_Id.Index].Value;
            if (idObj is System.DBNull || idObj == null)
            {
                // set default values to all cells in new row...

                // set icon indicating ro/ rw mode - wrong row when sorted!
                row.ReadOnly = (bool)readonlyObj;
                SetIconCellImage(row);  
            }
            else
            {
                object readonlyObj = row.Cells[Column_Readonly.Index].Value;
                if (!(readonlyObj is System.DBNull) && readonlyObj != null)
                {
                    row.ReadOnly = (bool)readonlyObj;
                    SetIconCellImage(row);  //
                }
            }
        } 
```

有什么提示吗？可能是我不了解数据绑定的逻辑以及如何访问行和数据源。但我还看不到我的错误。在此先感谢...霍尔格

# c++ - 如何检测多重定义的符号

> ID：12485271
> 
> 赞同：0
> 
> 时间：2012-09-18T21:23:43.773
> 
> 标签：c++, unix, linker, porting

我有一个常见的场景：可执行文件的一些源文件依赖于一些标准库和一些用户库。所有用户库都静态链接到可执行文件，而标准库则动态链接到它。

问题：我相信我的完整包中有多个定义的符号（可执行文件已经包含用户库代码+共享标准库）。链接器显然对它有洞察力，但据我了解，除非遇到多个强命名符号，否则链接器不会抱怨。我担心的是，当我将代码从 solaris 8/sparc 平台移动到 solaris10/sparc 平台时，一些标准的 unix 函数已经在用户库中实现，这会导致应用程序在运行时崩溃。请注意，该应用程序在 solaris 8/sparc 平台上运行良好

我一直面临着奇怪的问题，这让我相信这可能是源头

1.  修改一个库中的一个变量正在更改另一个库中另一个变量的值
2.  [Solaris 8-10：host2ip 转换问题](https://stackoverflow.com/questions/12395007/solaris-8-10-host2ip-conversion-problems)

我需要的：

1.  ~~有没有办法轻松列出所有多重定义的符号？~~
2.  有没有办法轻松列出源自用户库的所有多重定义符号？
3.  你们认为问题 #1 可能是由链接问题引起的，还是您认为这可能是其他问题的迹象？

Edit1：从那时起，我知道在使用 ld 生成地图文件时，它有一段多重定义的符号，我将通过它来查找看起来像标准库调用的名称。对于不知道的人，链接器只有在找到多个具有相同名称且名称是强名称的符号时才会链接失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:47:39.033

您可以在编译器（实际上是链接器）设置中打开 MAP 文件生成，并在映射文件中查找与您关注的 UNIX 系统函数匹配的符号。您可能必须编写一个脚本来自动化它，但这将是一个很好的起点。命令行开关可能是 -map 或类似的东西，这取决于您使用的编译器/链接器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T15:51:50.560

发生的实际问题是：库（我们称之为 lib1）有一个如下所示的数组

```
#define ARRAY_SIZE 1024
SomeStruct* global_array[ARRAY_SIZE]; 
```

这个数组被我的另一个库（我们称之为 lib2）使用，而我的应用程序又使用它来使用它的 extern 声明。

在编译 lib2（或者应用程序不确定）时，我们根本没有定义 ARRAY_SIZE。这以某种方式导致 lib2（或应用程序）的编译器错误地计算 global_array 的大小，进而导致它在已经分配给 global_array 的位置为其他变量分配内存。

通过在编译我的库和应用程序时再次定义 ARRAY_SIZE，一切都开始正常运行。由于数组的 extern 声明不包含大小，我不完全理解是什么导致了这个问题以及为什么它得到了解决。另外，如果库真的使用了 MACRO ARRAY_SIZE，那为什么编译不会失败呢？此外，用于定义的名称有可能是标准名称（实际字符串为 FD_SETSIZE）

我最初对链接器的直觉是错误的。

# javascript - jQuery选择首屏图像

> ID：12485273
> 
> 赞同：3
> 
> 时间：2012-09-18T21:23:58.410
> 
> 标签：javascript, jquery, image, lazy-loading

我目前正在使用 jQuery lazyload 插件来加载图像。我正在使用 javascript 替换 src 和 data-original 属性。这会导致负载轻微闪烁。我想知道jquery是否有办法只选择折叠下方或折叠上方的图像，这样我就可以避免这种闪烁。

```
var $imgs = $("img:not(.nolazy)");
$imgs.each( function(){
    var imgSrc = $(this).attr("src");
    $(this).attr("data-original",imgSrc).attr("src","gray.gif");
});
$imgs.lazyload({
      effect : "fadeIn"
}); 
```

编辑：@Jason Sperske 很好的答案。这是我解决闪烁问题的代码：

```
var wH = $(window).height();
var $imgs = $("img:not(.nolazy)");
$imgs.each( function(){
    var imgPosition = $(this).offset();
    if(imgPosition.top > wH){
        var imgSrc = $(this).attr("src");
        $(this).attr("data-original",imgSrc).attr("src","gray.gif");
    }
});
$imgs.lazyload({
      effect : "fadeIn"
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:25:50.033

虽然没有用于此目的的内置选择器，但您可以遍历它们并查找大于窗口高度的位置值。 [Ben Pickles](http://benpickles.com/)（[他的 SO 个人资料](https://stackoverflow.com/users/194664/benpickles)）已将此实现到一个名为[onScreen](http://benpickles.github.com/onScreen/)的过滤器中，您可以像选择器一样使用它（请注意，它仍会获取所有元素，但在您尝试修改它们之前将列表配对，因此选择器不会t 更快（实际上稍微慢一点），但减少的元素集更新速度会更快）。

# java - 数据库访问和电池友好型应用程序

> ID：12485280
> 
> 赞同：0
> 
> 时间：2012-09-18T21:24:35.150
> 
> 标签：java, android, sqlite

我想在我的应用中保存有关广告网络使用情况的统计信息。基本上，我想维护每天请求广告网络、产生印象或请求失败的次数。

我最初的想法是拥有一个包含以下列的 SQLite 数据库

```
[ day , networkId, requests, impressions, fails] 
```

但我正在考虑以下性能/电池消耗可能的问题：

由于我使用 3 个广告网络（1 个主要广告网络和 2 个作为回填广告网络），最坏的情况是：

*   网络 A 请求
*   网络 A 失败
*   请求网络 B
*   网络 B 失败
*   网络 C 请求
*   网络 C 成功。

全部在约 4 秒内完成。如果每一点都访问数据库以更新相应的行，那么开销会很大吗？我应该在内存中实现某种缓存并批量插入值（同时抓住一对 [request+success] 或 [request+fail] 进行单次更新？）还是我可以直接使用数据库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:56:29.000

您可以利用对象模型技术...每当您更改数据时，您可以将其写入对象...并且在某个时间间隔内，您可以将对象模型中的数据写入 sql 数据库。 ..

我看到的唯一问题是，如果您的活动被终止...或停止对象模型将变空...当您的活动有可能完成或终止时，您可以通过将数据写入数据库来避免这种情况。

# map - 传单矢量图层 - popuptemplate

> ID：12485281
> 
> 赞同：1
> 
> 时间：2012-09-18T21:24:50.080
> 
> 标签：map, vector, gis, leaflet

我正在尝试将 Leaflet 与 Leaflet Vector Layers (http://geojason.info/leaflet-vector-layers/) 和 ArcGIS Server 一起使用。我已经设置了弹出模板，并且可以按预期查看功能。但是，当我单击某个功能以获取信息时，我收到一个错误：“无法读取未定义的属性 'y'。” 任何建议将不胜感激。我用来创建相关图层的代码如下：

```
lyrHospitals = new lvector.AGS({
    url: oHospitals.url + '/' + oHospitals.layerIds,
    fields: '*',
    //uniqueField: "onemap_prod.SDEADMIN.hls.OBJECTID",
    popupTemplate: function (properties) {
        return '<p>hello there</p>';
    },
    scaleRange: [10, 20],
    symbology: {
        type: 'single',
        vectorOptions: {
            icon: baseballIcon
        }
    },
    singlePopup: true
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T17:08:21.027

我刚刚更新了 Leaflet Vector Layers 以使用 Leaflet v0.4.x。您可以尝试使用最新的[Leaflet Vector Layers](http://geojason.info/leaflet-vector-layers/download/)，如果您仍然遇到此问题，请告诉我？

# asp.net-mvc - SelectListItem 的 Selected 属性和 SelectItem 的 selectedValue 参数不起作用

> ID：12485287
> 
> 赞同：0
> 
> 时间：2012-09-18T21:25:19.503
> 
> 标签：asp.net-mvc, enums, html-helper, selectlist

我正在尝试开发一个 HtmlHelper 扩展方法：EnumDropDownListFor。无论我做什么，我都无法显示所选值。我尝试设置 SelectListItem 的 Selected=true 属性并设置 SelectList 构造函数的 selectedValue 。在调试时（在返回行），对于这两种情况，我都可以看到应该选择的 SelectLİstItem 的 Selected=true。但是当我“查看源代码”时，没有一个选项具有 selected="selected" 属性。

我哪里错了？

注意：Toolkit 是我的实用程序类，ToByte 是 Enum 的扩展方法

```
 public static MvcHtmlString EnumDropDownListFor<TModel, TProperty>(
        this HtmlHelper<TModel> helper, Expression<Func<TModel, TProperty>> expression, string optionLabel = null,
        object htmlAttributes = null) where TModel : class
    {
        var selectedValue = helper.ViewData.Model == null
                                ? default(TProperty)
                                : expression.Compile()(helper.ViewData.Model);

        var enumVals = Toolkit.GetEnumValues(typeof(TProperty));

        //var selectList = from enumVal in enumVals.OfType<Enum>()
        //                 select new SelectListItem
        //                 {
        //                     Text = enumVal.GetName(),
        //                     Value = enumVal.ToByte().ToString(),
        //                     Selected = Equals(enumVal, Toolkit.To<Enum>(selectedValue))
        //                 };

        // helper.ViewData[(expression.Body as MemberExpression).Member.Name] = Toolkit.To<Enum>(selectedValue).ToByte().ToString();

        var selectList = new SelectList(from enumVal in enumVals.OfType<Enum>()
                                        select new
                                        {
                                            TextField = enumVal.GetName(),
                                            ValueField = enumVal.ToByte().ToString()
                                        }, "ValueField", "TextField", Toolkit.To<Enum>(selectedValue).ToByte().ToString());

        return helper.DropDownListFor(expression, selectList, optionLabel, htmlAttributes);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-22T14:00:01.227

我解决了它（：那是因为我用返回枚举类型的相同表达式调用“helper.DropDownListFor”，并且我试图通过“字节”强制转换值设置选项值。所以似乎表达式的返回值覆盖了给定选定的值，很有意义。

# git - 当分支通过 x 提交位于远程存储库之前时，Git 状态不再显示

> ID：12485288
> 
> 赞同：3
> 
> 时间：2012-09-18T21:25:21.280
> 
> 标签：git

所以我使用以下几行设置了一个新的远程 git repo：

```
git remote add origin [link]
git push origin master
[enter password] 
```

在我之前的仓库中，当我进行新的提交并检查状态时，如果我忘记使用 git push，它会告诉我我的分支领先 x 次提交。但是，当我使用 git status 时，这个新的 repo 不再显示。

谁能告诉我如何解决这个问题？

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T22:28:12.057

不跟踪分支。您应该添加添加跟踪：git branch --set-upstream master origin/master。 [让现有的 Git 分支跟踪远程分支？](https://stackoverflow.com/questions/520650/how-do-you-make-an-existing-git-branch-track-a-remote-branch)

# php - codeigniter 点击导航

> ID：12485289
> 
> 赞同：-1
> 
> 时间：2012-09-18T21:25:22.450
> 
> 标签：php, codeigniter-2

这可能很简单，但仍然值得一问，因为我就是想不通。我有一个 index.php 视图，它是通过主函数调用从控制器加载的。现在，当我在该站点上时，有指向其他视图的链接。如何自定义这些链接的 href？示例之一是列出所有项目（控制器中有一个函数负责该函数以及加载它们的视图）但是当我单击链接“列出所有”时如何调用它？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:38:49.593

`/index.php/controller/action/`CodeIgniter中的默认路由是`controller`您要寻址的控制器的名称以及`action`您要在该控制器上调用的方法（操作）。

有关 CI 中路由的更多信息，请参见：http: [//codeigniter.com/user_guide/general/routing.html](http://codeigniter.com/user_guide/general/routing.html)。

# php - PHP中的锯齿状边缘数组

> ID：12485291
> 
> 赞同：2
> 
> 时间：2012-09-18T21:25:22.387
> 
> 标签：php, arrays, multidimensional-array

我想在PHP（5.3）中存储一些数据（我猜是一个半2，半3d数组）我需要做的是存储每个楼层的数据，如下所示：

```
Floor    Num of Spots    Handicap          Motorcyle        Other
1         100            array(15,16,17)    array (47,62)   array (99,100)
2         100            array(15,16,17)    array (47,62)   array (99,100)
and on 
```

问题是，如果 Handicap+Motorcyle+Other 是整数，我可以将数据存储在二维数组中。然而，他们不是。所以我想我可以制作一个几乎像 3D 数组的东西，前两列只有 2D。

我的另一个想法是制作一个二维数组和第 3,4 和 5 列而不是另存为

```
array(15,16)
//save like
1516 
```

然后拆分为两位数（1 位数组编号将以 0 开头）。但是，我想知道字符串长度的限制，因为如果我决定移动到数组中的 3 位长度数字，例如 array(100, 104)，并且我需要存储很多数字，我以为我会很快超过最大值。

**编辑 1** 我非常喜欢 Omar 的回答，但我不确定如何提取数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T21:37:32.963

虽然您可以将它们存储为`?D`数组，但您可能需要考虑另一种方法：

```
$stuff = array (
  'floor1' => 
  array (
    'NumSpots' => 100,
    'handicap' => array (15,16,17),    
    'motorcycle' => array (47, 62),
    'other' =>  array (99, 100),
    ),
  ),
  'floor2' => 
    'NumSpots' => 100,
    'handicap' => array (15,16,17),    
    'motorcycle' => array (47, 62),
    'other' => array (99, 100),
    ),
  )
) 
```

这样，您可以通过 mroe 有意义的名称访问事物，例如

```
$stuff['floor1']['motorcycle'][2] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T21:32:20.013

在 php 中，您可以为数组命名键。数组中的每个元素都可以有不同的类型，因此您可以拥有

```
$floors = array(
    1 => array(
            'num_spots' => 100,
            'handicap' => array(15,16,17)
        ),   

    2 => array(
            'num_spots' => 100,
            'handicap' => array(15,16,17),
            'motorcycle' => array (47,62)
        )
); 
```

ETC...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T21:30:16.003

你完全可以这样做。例子：

```
$a = array();
$a[1] = array(
    'spots' => 100,
    'handicap' => array(5,3,5)
);
$a[2] = array(
    'spots' => 50,
    'handicap' => array(1,3,20)
);
var_dump($a); 
```

输出：

```
array
  1 => 
    array
      'spots' => int 100
      'handicap' => 
        array
          0 => int 5
          1 => int 3
          2 => int 5
  2 => 
    array
      'spots' => int 50
      'handicap' => 
        array
          0 => int 1
          1 => int 3
          2 => int 20 
```

您可以将数组索引用于楼层编号，也可以为此使用单独的键/值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T21:32:51.400

就像是...

```
$floors = array();
$floors[1] => array(
    Spaces => 100,
    Handicapped => array(15, 16, 17),
    Motorcycle => array(47, 62),
    Other => array (1, 2, 3, ..., n)
) 
```

然后，您可以将值检索为...

```
$Floor1Spaces = $floors[1]['Spaces']; //An integer
$Floor1HAndicapped = $floors[1]['Handicapped']; //A 1-dimensional array of integer 
```

# google-maps - 在 Crystal Reports 中组合字段和替换文本

> ID：12485293
> 
> 赞同：2
> 
> 时间：2012-09-18T21:25:32.310
> 
> 标签：google-maps, crystal-reports, replace, formula

我是 Crystal Reports 的新用户，我们将不胜感激。我正在寻找一个允许我组合两个字段并进行文本替换（映射项目）的公式。

例如，我希望将地址和城市组合到一个字段中，因此我使用以下公式：

```
{Location.Address}+","+" "+{Location.City}. 
```

这通常是足够的，除了在记录系统中缩写的城镇中的普通街道。我需要将“24 SGE, Albany”的条目改为“24 Stargate East, Albany”，以便映射软件可以解释地址。

我尝试了类似的东西

```
{Location.Address}+","+" "+{Location.City} 
```

和

```
Replace({Location.Address}," SGE"," Stargate East") 
```

我得到了错误，`a boolean is require here`. 所以我可能还很遥远。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:47:12.823

```
Replace({Location.Address},"SGE","Stargate East") + ", " + {Location.City} 
```

# r - R 中介分析——自举

> ID：12485309
> 
> 赞同：7
> 
> 时间：2012-09-18T21:26:28.327
> 
> 标签：r, statistics-bootstrap

我正在尝试使用 mediate 包在 R 中进行调解分析。我查看了有关如何执行此操作的文档，并通读了 R 提供的示例（即，我已经运行了“示例（中介）”）。尽管如此，我还是无法运行最简单的调解。理想情况下，我想做一个引导程序，如 Preacher & Hayes (2004)。

这是我要运行的代码：

```
model.m <- lm(desirdata1$zpers1 ~ desirdata1$zdesir1 + desirdata1$age)
model.y <- lm(desirdata1$zpers1 ~ desirdata1$age)
age1test <- mediate(model.m, model.y,treat="age", mediator="zdesir1",
                    boot=TRUE, sims=50) 
```

请注意，数据集称为`desirdata`，处理称为`age`，结果称为`zpers1`，中介称为“zdesir1”。当我运行它时，我收到以下错误：

```
Error in `[.data.frame`(m.data, , treat) : undefined columns selected 
```

似乎声称不存在变量（特别是治疗变量）。但是，运行 names(desirdata) 显示该变量存在，并且命名正确，所有其他变量也是如此。前两个模型（model.m 和 model.y）运行良好，输出看起来应该是这样。这只是我无法运行的中介模型。据我所知，我没有打错字，而且我已经检查了一百次。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:59:24.997

当我阅读文档中的示例时，`model.m`中介模型的结果与主回归对象的结果不同`model.y`。由于您没有描述背景和什么样的数据，因此很难确定这一点，但想知道您是否打算输入：

```
model.m <- lm(zdesir1 ~  age, data=desirdata1)
model.y <- lm(zpers1 ~ age, , data=desirdata1 )
age1test <- mediate(model.m, model.y,treat="age", mediator="zdesir1",
                    boot=TRUE, sims=50) 
```

我使用`formula`and`data`对象对其进行转换，因为某些回归函数在刚给定向量时会分解。也更容易看到错别字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-30T15:44:49.043

你的模型不正确。model.m 应该从 IV 预测中介，model.y 应该从中介和 IV 预测 DV。

```
model.m <- lm(desirdata1$zdesir1 ~ desirdata1$age)
model.y <- lm(desirdata1$zpers1 ~ desirdata1$zdesir1 + desirdata1$age)
age1test <- mediate(model.m, model.y, treat="age", mediator="zdesir1", boot=TRUE, sims=50) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T05:59:34.150

试试 MBESS 包。传教士推荐它，您可以使用调解功能。如果您想要引导程序，只需确保它显示引导程序 = TRUE。B 是引导程序的数量。

```
mediation(x, mediator, dv, S = NULL, N = NULL, x.location.S = NULL,
mediator.location.S = NULL, dv.location.S = NULL, mean.x = NULL,
mean.m = NULL, mean.dv = NULL, conf.level = 0.95,
bootstrap = FALSE, B = 1000, which.boot="both", save.bs.replicates=FALSE) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T00:29:40.577

我在模拟数据中遇到了同样的问题，所以我运行了 debug(mediate) 并找到了问题所在。我相信问题出在代码的 [treat="age", mediator="zdesir1"] 部分。如果您附加数据，则不应遇到该问题。或者，您可以使用应该解决问题的 [treat="desirdata1$age", mediator="desirdata1$zdesir1"]。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-07T07:17:50.750

试试这个：

```
model.m <- lm(zdesir1 ~ age, data=desirdata1)
model.y <- lm(zpers1 ~ age + zdesir1, data=desirdata1)
age1test <- mediate(model.m, model.y,treat="age", mediator="zdesir1",
                    boot=TRUE, sims=50) 
```

为简单起见，中介模型 (model.m) 应该将中介作为结果。

# c# - HttpWebRequest 仅在提琴手运行时有效

> ID：12485310
> 
> 赞同：2
> 
> 时间：2012-09-18T21:26:30.777
> 
> 标签：c#, httpwebrequest, fiddler

我对以下代码有一些问题。当 Fiddler 打开时它会运行良好，但是当 Fiddler 不运行时它会超时。

```
IWebProxy proxy = websiterequester.Proxy;
websiterequester = (HttpWebRequest)WebRequest.Create("http://website.com/");
websiterequester.CookieContainer = cookieJar;
websiterequester.Method = "GET";
websiterequester.Referer = "http://website.com/";
if (websiterequester.Proxy != null)
{
  websiterequester.Proxy = null;
}

try
{
  objStream1 = websiterequester.GetResponse().GetResponseStream();
}
catch (WebException ex)
{
  return "oops";
}

objReader1 = new StreamReader(objStream1);
string thiscamebacks = objReader1.ReadToEnd(); 
```

希望大家有答案。（我在 SO 上阅读了另一个帖子，但没有一个答案对我有用）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:32:36.207

尝试使用它来读取响应流：

```
 private byte[] ReadWebResponse(WebResponse response)
    {
        byte[] bytes = null;
        if(response == null) return null;

        using(Stream responseStream = response.GetResponseStream())
        {
            using(BinaryReader readStream = new BinaryReader(responseStream))
            {
                using(MemoryStream memoryStream = new MemoryStream())
                {
                    byte[] buffer = new byte[256];
                    int count;
                    int totalBytes = 0;
                    while((count = readStream.Read(buffer, 0, 256)) > 0)
                    {
                        memoryStream.Write(buffer, 0, count);
                        totalBytes += count;
                    }
                    memoryStream.Position = 0;
                    bytes = new byte[totalBytes];
                    memoryStream.Read(bytes, 0, totalBytes);
                }
            }
        }
        return bytes;
    } 
```

[编辑] 我刚刚看到你最终想要一个来自响应的字符串，所以使用它来将字节数组转换为字符串：

```
/// <summary>
/// Returns the byte array as a string, or null
/// </summary>
public static string GetByteString(byte[] b)
{
    if (b == null) return null;
    return Encoding.UTF8.GetString(b);
} 
```

# php - Yii CJuiAutoComplete 动态sourceUrl。如何？

> ID：12485316
> 
> 赞同：0
> 
> 时间：2012-09-18T21:26:46.617
> 
> 标签：php, yii, jquery-ui-autocomplete

情况：

带有“国家”下拉菜单、“邮政编码”文本字段、“城市”文本字段的表单。

国家下拉菜单有两项：比利时和法国（以国家代码为有效值，分别为 BE 和 FR）

“PostalCode”字段是一个 CJuiAutoComplete 字段，根据从国家下拉列表中选择的值，它必须从“BeCity/getBelgianPostalCodes”或“FrCity/getFrenchPostalCodes”获取自动完成数据。

这两个动作，彼此独立，完美地工作，它们产生正确的自动完成数据。但是，我无法弄清楚如何根据国家下拉列表的选定值使其动态工作。我尝试将所选国家/地区置于会话状态，并从那里动态生成 sourceUrl。当我查看生成的 html 的来源时，根据所选国家/地区，生成的 sourceUrl 是正确的，但我仍然从加载的第一个国家/地区获得值。所以大概有一个缓存问题或什么？

这是代码：

形式：

```
<div class="row">
        <?php echo $form->labelEx($model,'Country'); ?>
        <?php echo $form->dropDownList($model,
                        'CountryCode',
                        CHtml::listData(Country::model()->findAllByAttributes(array('Visible'=>1)),'Code','Name'),
                        array('ajax'=>array(
                              'type'=>'POST',
                              'url'=>CController::createUrl('request/setRequestCountryCode'),
                              'data'=>'js:{CountryCode: $(this).val()}'))
                        ); ?>
        <?php echo $form->error($model,'CountryCode'); ?>
    </div>

        <div class="row">
        <?php echo $form->labelEx($model,'PostalCode'); ?>
        <?php 

                $this->widget('zii.widgets.jui.CJuiAutoComplete', array(
                'name'=>'Request_PostalCode',
                'value'=>$model->PostalCode,
//                'source'=>$this->createUrl('BeCity/GetBelgianPostalCodes'),
                'sourceUrl'=>$this->createUrl(RequestController::actionGetPostalCodeAction()),
                'options'=>array(
                        'minLength'=>'1',
                        'showAnim'=>'fold',
                        'cache'=>'false',
                        'select'=> 'js:function(event, ui)
                            {
                                $("#Request_PostalCode").val(ui.item.value);
                                $("#Request_City").val(ui.item.city);
                                return false;
                            }'

                )
                ));

                ?>
        <?php echo $form->error($model,'PostalCode'); ?>
    </div>

    <div class="row">
        <?php echo $form->labelEx($model,'City'); ?>
        <?php echo $form->textField($model,'City',array('size'=>50,'maxlength'=>250)); ?>
        <?php echo $form->error($model,'City'); ?>
    </div> 
```

请求控制器：

```
 public static function actionSetRequestCountryCode()
        {
            $countryCode = $_POST['CountryCode'];
            Yii::app()->user->setState('RequestCountryCode',$countryCode);
        }

        public static function actionGetPostalCodeAction()
        {
            $countryCode = Yii::app()->user->getState('RequestCountryCode');

            if($countryCode == 'BE')
                return 'BeCity/GetBelgianPostalCodes';
            elseif($countryCode == 'FR')
                return 'FrCity/GetFrenchPostalCodes';
            else
                return '';
        } 
```

BeCity 控制器：

```
public function actionGetBelgianPostalCodes()
        {                     
            $res =array();

            if (isset($_GET['term'])) {
                    // http://www.yiiframework.com/doc/guide/database.dao
                    $qtxt ="SELECT
                            DISTINCT
                            CONCAT(bc.PostalCode, ' - ', bc.NameNL) as label,
                            bc.PostalCode as value,
                            bc.NameNL as city
                            FROM be_city bc
                            WHERE bc.PostalCode LIKE :qterm
                            ORDER BY bc.PostalCode, bc.NameNL ASC";
                    $command =Yii::app()->db->createCommand($qtxt);
                    $command->bindValue(":qterm", $_GET['term'].'%', PDO::PARAM_STR);
                    $res = $command->queryAll();
            }

            echo CJSON::encode($res);
            Yii::app()->end();
        } 
```

FrCity 控制器：

```
public function actionGetFrenchPostalCodes()
        {                     
            $res =array();

            if (isset($_GET['term'])) {
                    // http://www.yiiframework.com/doc/guide/database.dao
                    $qtxt ="SELECT
                            DISTINCT
                            CONCAT(fc.PostalCode, ' - ' , fc.NameFR) AS label,
                            fc.PostalCode as value,
                            fc.NameFR as city
                            FROM fr_city fc
                            WHERE fc.PostalCode LIKE :qterm
                            ORDER BY fc.PostalCode ASC, fc.NameFR ASC";
                    $command =Yii::app()->db->createCommand($qtxt);
                    $command->bindValue(":qterm", $_GET['term'].'%', PDO::PARAM_STR);
                    $res =$command->queryAll();
            }

            echo CJSON::encode($res);
            Yii::app()->end();
        } 
```

这是使用会话变量的正确方法，还是有更好的方法？

那么缓存问题呢？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T08:14:56.737

好的，能够通过让一个动作（函数）获取国家参数并执行该动作中的所有逻辑来使其工作，而不是尝试重新路由到两个单独的动作：

形式：

```
 <div class="row">
        <?php echo $form->labelEx($model,'Country'); ?>
        <?php echo $form->dropDownList($model,
                        'CountryCode',
                        CHtml::listData(Country::model()->findAllByAttributes(array('Visible'=>1)),'Code','Name')

                        ); ?>
        <?php echo $form->error($model,'CountryCode'); ?>
    </div>

        <div class="row">
        <?php echo $form->labelEx($model,'PostalCode'); ?>
        <?php 

                $this->widget('zii.widgets.jui.CJuiAutoComplete', array(
                'name'=>'Request_PostalCode',
                'value'=>$model->PostalCode,
                'source'=>'js: function(request, response) {
                                $.ajax({
                                    url: "'.$this->createUrl('Request/GetPostalCodes').'",
                                    dataType: "json",
                                    data: {
                                        term: request.term,
                                        countryCode: $("#Request_CountryCode").val()
                                    },
                                    success: function (data) {
                                            response(data);
                                    }
                                })
                             }',
                'options'=>array(
                        'minLength'=>'1',
                        'showAnim'=>'fold',
                        'select'=> 'js:function(event, ui)
                            {
                                $("#Request_PostalCode").val(ui.item.value);
                                $("#Request_City").val(ui.item.city);
                                return false;
                            }'

                )
                ));

                ?>
        <?php echo $form->error($model,'PostalCode'); ?>
    </div>

    <div class="row">
        <?php echo $form->labelEx($model,'City'); ?>
        <?php echo $form->textField($model,'City',array('size'=>50,'maxlength'=>250)); ?>
        <?php echo $form->error($model,'City'); ?>
    </div> 
```

请求控制器：

公共函数 actionGetPostalCodes() {

```
 $countryCode = $_GET['countryCode'];

    $res =array();

    if (isset($_GET['term'])) 
    {

        $qtxt = '';

        if($countryCode == 'BE')
            $qtxt ="SELECT
                    DISTINCT
                    CONCAT(bc.PostalCode, ' - ', bc.NameNL) as label,
                    bc.PostalCode as value,
                    bc.NameNL as city
                    FROM be_city bc
                    WHERE bc.PostalCode LIKE :qterm
                    ORDER BY bc.PostalCode, bc.NameNL ASC";

        elseif($countryCode == 'FR')
            $qtxt ="SELECT
                    DISTINCT
                    CONCAT(fc.PostalCode, ' - ' , fc.NameFR) AS label,
                    fc.PostalCode as value,
                    fc.NameFR as city
                    FROM fr_city fc
                    WHERE fc.PostalCode LIKE :qterm
                    ORDER BY fc.PostalCode ASC, fc.NameFR ASC";

        if($qtxt != '')
        {
            $command =Yii::app()->db->createCommand($qtxt);
            $command->bindValue(":qterm", $_GET['term'].'%', PDO::PARAM_STR);
            $res = $command->queryAll();
        }
    }

    echo CJSON::encode($res);
    Yii::app()->end();

} 
```

# jquery - 让用户了解长时间运行的服务器端进程的进度

> ID：12485319
> 
> 赞同：0
> 
> 时间：2012-09-18T21:27:03.050
> 
> 标签：jquery, jsp

当用户单击我的 JSP 页面上的按钮时，这将启动一个 struts 操作，该操作将在 30 到 40 分钟之间完成，因为它会遍历包含 1000 个项目的列表。让用户了解进度的最佳方式是什么？我应该有一个

```
setTimeout(  updateUI(), 30000); 
```

键入 call ，它将每 30 秒递归调用一次并 ping 服务器以获取进度状态。是否有任何 JQuery 实用程序可以使这更容易？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:25:45.307

还有其他一些 Web 技术并不适用于所有浏览器，并且需要更多的精力来设置，例如 Web-sockets。但是，简单的解决方案是使用`setTimeout`

当您第一次发起请求时，成功回调将在 XX 秒后再次为同一请求设置超时。如果服务器响应缓慢，您只会在收到成功响应后 30 秒发出请求。避免堆叠查询和额外负载。

据我所知，没有一个 jquery ajax 属性可以设置来处理这个问题，就像其他库（如prototypejs）一样。

# matlab - 互相关

> ID：12485321
> 
> 赞同：1
> 
> 时间：2012-09-18T21:27:04.427
> 
> 标签：matlab

我一直试图找到一个时移信号响应和另一个作为参考的信号响应之间的互相关，但发现很难用 xcorr 函数反映我的时移。matlab代码粘贴在下面，如果有人可以就如何实现xcorr函数提出建议，我将不胜感激，这样我就可以确定两个信号响应相关的时移。谢谢你

```
clear all;
clc;
FS = 100e6;

figure(1)
AMP8 = importdata('av250nu.txt');
time8  = [1:length(AMP8)] / FS;
c=find(time8==0.14e-4);
plot(time8(1:c)',AMP8(1:c));
ylabel('Amplitude(V)')
xlabel('Time of flight(s)')

figure(2)
AMP = importdata('3kknu.txt');
time  = [1:length(AMP)] / FS;
c=find(time==0.14e-4);
plot(time(1:c)',AMP(1:c));
title('reference')
ylabel('Amplitude(V)')
xlabel('Time of flight(s)')

figure(3)
AMP1 = zeros(2000,1);
time1 = zeros(2000,1);
time11 = zeros(2000,1);
AMP1(1:320)= AMP(1:320);
time1(1:320) = time(1:320);
plot(time1,AMP1);
ylabel('Amplitude(V)')
xlabel('Time of flight(s)')

figure(4)
AMP2 = zeros(2000,1);
time2 = zeros(2000,1);
time21 = zeros(2000,1);
AMP2(321:640) = AMP(321:640);
time2(321:640) = time(321:640);
time21(321:640) = time2(321:640);
plot(time21,AMP2);
ylabel('Amplitude(V)')
xlabel('Time of flight(s)')

figure(5)
AMP3 = zeros(2000,1);
time3 = zeros(2000,1);
time31 = zeros(2000,1);
AMP3(641:960) = AMP(641:960);
time3(641:960) = time(641:960);
time31(641:960) = time3(641:960);
plot(time31,AMP3);
ylabel('Amplitude(V)')
xlabel('Time of flight(s)')

figure(6)
AMP4 = zeros(2000,1);
time4 = zeros(2000,1);
time41 = zeros(2000,1);
AMP4(961:1280) = AMP(961:1280);
time4(961:1280) = time(961:1280);
time41(961:2000) = time4(961:2000);
plot(time41,AMP4);
ylabel('Amplitude(V)')
xlabel('Time of flight(s)')

figure(75)
time5=zeros(2000,1);
p = zeros(2000,1);
time5(1:320)= time1(1:320); 
time5(321:640)=time21(321:640);
time5(641:960)=time31(641:960);
time5(961:2000)=time41(961:2000);

plot(time5,AMP);

 p(1:2000) = time5;
 p(1:16384) = AMP;
 plot(p);
 grid on;

 figure(95)
 [Z,lags] = XCORR(p(1:16384,1),AMP8,'biased');
 plot(lags,Z); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:41:51.850

尝试找到相关性的最大值，这是期望的转变。

```
[zmax, i] = max(Z);
t = lags[i]; 
```

# python - python 2.6.7 多处理池无法关闭

> ID：12485322
> 
> 赞同：2
> 
> 时间：2012-09-18T21:27:09.870
> 
> 标签：python, webserver, multiprocessing, python-2.6

我们有一个在 python 3.2 (Fedora Core 14 64b) 中运行的 Web 服务服务器，但由于新的依赖项（不支持 3.2）而被迫向后移植到 python 2.6.7。有一段代码使用了并发期货，已被重写为使用 multiprocessing.Pool 并行执行几个关键部分。代码现在如下所示：

```
import multiprocessing
def _run_threads(callable_obj, args, threads):
    pool = multiprocessing.Pool(processes=threads)
    process_list = [pool.apply_async(callable_obj, a) for a in args]
    pool.close()
    pool.join()
    return [x.get() for x in process_list] 
```

对“线程”名称的令人困惑的滥用表示歉意。这些是过程。

自从实现了这个功能，我们发现它有时会挂起。当我们最终杀死父（主）进程时，我们会得到一个乱码的回溯；但有几行似乎很关键：

```
[snip]
Process PoolWorker-445:
[snip]
File "/usr/lib64/python2.6/multiprocessing/pool.py", line 59, in worker
task = get()
File "/usr/lib64/python2.6/multiprocessing/queues.py", line 352, in get
return recv()
racquire()
[snip] 
```

在我看来，从现有证据来看，池中的子进程未能从父进程接收“关闭”信号，因此它正在等待工作。父母坐等孩子关机。服务器挂起。对于这样一个关键的服务器来说，这种情况发生的不确定性但过于频繁（一天一次）。

run_threads() 函数的编码有问题吗？这是已知解决方法的已知问题吗？显然，我们将其用于时间要求严格的处理，因此除非绝对必要，否则我们不希望为顺序执行重新编码。坚持使用 multiprocessing.Pool 的原因之一是可以轻松访问并行运行的操作的返回码。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:51:29.507

I am not sure where this issue has its origin. It's definitely very interesting. However, maybe a little restructuring solves the problem. I think you do not require to terminate the pool processes before having collected your results, right? Maybe sticking to the 'canonical' way of using a Pool, [as documented](http://docs.python.org/library/multiprocessing.html#module-multiprocessing.pool), helps:

```
result = pool.apply_async(time.sleep, (10,))
print result.get(timeout=1)           # raises TimeoutError 
```

Or, in your case, call `x.get() for x in process_list` before closing/joining the pool. If the problem persists and occurs during `get()`, we at least know it has nothing to do with `close()`.

# scala - 如何引用在同一个 Buildr 构建文件中构建的 JAR？

> ID：12485323
> 
> 赞同：1
> 
> 时间：2012-09-18T21:27:09.173
> 
> 标签：scala, jar, buildr

我目前正在使用 IntelliJ IDEA 来构建我的项目，但我想摆脱它以打破对这个特定 IDE 的依赖。 [Buildr](http://buildr.apache.org)看起来是一个不错的选择，因为 1) 它很简单，并且 2) 我已经了解 Ruby。

我的 IDEA 项目，它是一个 Java 库，目前看起来像这样：

```
/
    /src/...
    /sample_applications/ 
```

我可以将我的库构建为一个 JAR，目标是这样的，没有任何问题：

```
define 'my_library' do
  project.version = '0.0.1'
  package(:jar)
end 
```

但我想为示例应用程序提供构建目标——它们依赖于——`my_library`使用相同的构建文件。如果我像这样创建另一个目标：

```
sample_layout = Layout.new
sample_layout[:source, :main, :scala] = 'sample_programs/simple_program.scala'
define 'simple_program', :layout => sample_layout do
  project.version = '0.0.1'
  package(:jar)
end 
```

`simple_program-0.0.1.jar`编译得很好，但`my_library`不包括 JAR。如果我通过将上述定义修改为：

```
define 'simple_program', :layout => sample_layout do
  project.version = '0.0.1'
  package(:jar).path("lib").tap do |p|
    p.include artifact('my_library').to_s
  end
end 
```

然后我收到一个错误，例如： RuntimeError : Missing artifact identifier for {:group=>"my_library"}

如何在同一个构建文件中引用我之前在另一个项目中创建的 JAR？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T00:25:06.653

这是一个简单的问题，您只需要告诉 Buildr 打包任务需要从其他项目构建 jar：

```
package(:jar).include( project('my_library').package(:jar), :as => "lib/my_library.jar" ) 
```

# java - 如何在Java中获取引发异常的方法名称

> ID：12485327
> 
> 赞同：9
> 
> 时间：2012-09-18T21:27:39.607
> 
> 标签：java, aop, aspectj

我有一个方面在我的 TestNG 测试方法引发异常后运行。我想将测试方法名称添加到我的 aspectj 方法中。

对此有什么想法吗？请在下面找到我的代码示例：

方面：

```
pointcut publicCall(): call(public * *(..));

after() throwing (AssertionError e): publicCall() {
    logger.debug("Assertion Error thrown");
    System.out.println("Threw an exception: " + e);
} 
```

测试：

```
@Test

public void testScenarioOne(){
    logger.debug("From Scenario One Test");
    Assert.assertEquals(true, false);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-22T07:40:20.390

您需要将切入点类型从更改`call`为`execution`：

```
pointcut publicMethod(): execution(public * *(..));

after() throwing (AssertionError e): publicMethod() {
    System.out.println(thisJoinPointStaticPart.getSignature());
} 
```

**编辑：**`@Test`也许专门拦截带注释的方法会更干净：

```
import org.testng.annotations;

public aspect TestExceptionInterceptor {
    pointcut testMethod(): execution(@Test * *(..));

    after() throwing (AssertionError e): testMethod() {
        System.out.println(thisJoinPointStaticPart.getSignature());
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T21:32:43.180

您可以使用：

```
thisJoinPoint.getSignature().getName() 
```

尽管您必须直接从您的测试方法中抛出异常。`Assert.equals()`抛出异常不是你的测试方法。

# android - Android - 将其他值添加到 websettings settextsize

> ID：12485330
> 
> 赞同：0
> 
> 时间：2012-09-18T21:27:46.703
> 
> 标签：android

在我的应用程序中，我使用的是 webview，为了增加/减少文本大小，我正在使用`WebSettings().setTextSize`方法，但是，此方法仅限于 5 个预定义的枚举大小（最小、更小、正常、更大、最大）。我知道我可以使用`WebSettings().setTextZoom(int)`，但是我的应用程序可用于 API 8 级及以上，并且这种方法是在 API 14 中引入的......

我的问题是：有没有办法添加其他尺寸`webSettings().setTextSize`？也许通过扩展 textSize 枚举，或定义其他大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:36:19.860

你可以使用[`WebSettings.setDefaultFontSize(int size)`](http://developer.android.com/reference/android/webkit/WebSettings.html#setDefaultFontSize%28int%29)函数

# javascript - 获取选择的周围 DOM 节点

> ID：12485334
> 
> 赞同：1
> 
> 时间：2012-09-18T21:28:25.243
> 
> 标签：javascript, firefox, dom, firefox-addon, firefox-addon-sdk

我需要从选定的文本中获取周围的 DOM 节点。如何使用 Firefox 附加 SDK 做到这一点？或者我可以在我的扩展中使用任何其他可能性吗？

eg（选中的是大写） `<b class='foo'>here is SELected text</b>`

目的是获得类名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T06:55:36.327

内容脚本将有权访问该[`window.getSelection()`对象](https://developer.mozilla.org/en-US/docs/DOM/Selection)。从理论上讲，一个选择可以由几个不同的范围组成。但是，我从未见过多范围选择，您可能想假设只有第一个范围是相关的。范围具有允许您获取包含所有选定文本部分的元素的[`commonAncestorContainer`属性。](https://developer.mozilla.org/en-US/docs/DOM/range.commonAncestorContainer)这意味着您需要在内容脚本中执行以下操作：

```
var selection = window.getSelection();
if (selection.rangeCount >= 1)
{
  var range = selection.getRangeAt(0);
  alert(range.commonAncestorContainer.className);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T09:48:52.023

选择不一定有一个父节点。选择范围的端点可以在不同的节点中，范围内包含任意数量的节点，并且一个选择可以由多个范围组成。一个`selection`对象实际上是相当复杂的。

# visual-studio-2010 - 如何在 Visual Studio 2010 中使用 HTML5 智能感知？

> ID：12485341
> 
> 赞同：1
> 
> 时间：2012-09-18T21:28:44.407
> 
> 标签：visual-studio-2010

我一直在尝试在 Visual Studio 2010 中编写 HTML5 标签，但是当我尝试编写例如`<video></video>`绿色下划线和悬停信息的标签时：*Validation(XHTML 1.0 Transitional) Element video is not supported*。我已经在我的电脑上安装了 SP1，但是标签没有出现。我需要帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:33:52.190

我正在使用这个插件，它似乎涵盖了大部分内容。我仍然得到偶尔的 XHTML1.0 参考，但你能说什么..

[用于 VS 2010 和 2008 的 HTML5 智能感知](http://visualstudiogallery.msdn.microsoft.com/d771cbc8-d60a-40b0-a1d8-f19fc393127d)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T09:47:05.143

请参阅下面的链接 [在 Visual Studio 2010 中支持 HTML5](http://www.raihaniqbal.net/blog/2010/08/html5-support-in-visual-studio-2010/)

1.下载此存档并将内容提取到您的桌面。

2.复制/移动 html_5.xsd 到 D:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\Packages\schemas\html。路径可能因您安装 VS 2010 或 Visual Web Developer 2010 的位置而异。

3.从提取的内容中，运行相应的注册表文件。就我而言，它是 VS-2010-x64.reg

4\. 现在启动 Visual Studio 2010（或 VWD）并导航到工具 > 选项 > 文本编辑器 HTML > 验证。在右侧面板上，选择 HTML 5 作为目标。

# python - python请求和TLS

> ID：12485343
> 
> 赞同：2
> 
> 时间：2012-09-18T21:28:48.690
> 
> 标签：python, ssl, python-requests

是否可以使用请求包使用 TLS 发出请求？

做的时候：

```
requests.get('someurl') 
```

我越来越：

```
SSLError: [Errno 8] _ssl.c:491: EOF occurred in violation of protocol 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:38:26.423

不确定您正在尝试什么网址，但我希望以下内容有所帮助。

```
In [35]: url = 'https://www.googleapis.com/freebase/v1/mqlread?query=hello&key=xyz'
In [36]: requests.request("GET",url)
Out[36]: <Response [400]> 
```

有关更多文档，请参阅[此处](http://docs.python-requests.org/en/latest/api/#requests.request)

# svg - Ember 和 SVG：数组控制器内容更改时未呈现视图

> ID：12485344
> 
> 赞同：3
> 
> 时间：2012-09-18T21:29:02.480
> 
> 标签：svg, ember.js

我正在使用 Ember 和 SVG 创建时间线。下面是我创建的 jsfiddle 的链接（从原始代码简化）：

[http://jsfiddle.net/karlguillotte/UgeFk/](http://jsfiddle.net/karlguillotte/UgeFk/)

第一次渲染日历以及修改属性时都没有问题（请参阅init函数）。但是，当我设置事件集合时存在一些问题（错误：NOT_SUPPORTED_ERR：DOM Exception 9 is throw）。

当然，我可以使用 d3 来渲染这些矩形，但是我想利用 Ember 提供的绑定机制。该错误可能与Ember 用于管理绑定的*脚本标签有关。*

知道这如何仅使用 Ember 和 SVG 工作吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T01:26:49.683

```
App.eventsController.set('content', [{ start: 50, end: 100 }]);

{ start: 50, end: 100 } !== Em.Object.create({ start: 50, end: 100 }); 
```

Did you mean:

```
App.eventsController.set('content', [Em.Object.create({ start: 50, end: 100 })]); 
```

or simply:

```
App.eventsController.clear().pushObject(Em.Object.create({ start: 25, end: 100 })); 
```

* * *

```
App.eventsController.set('content', [{ start: 50, end: 100 }]);//will work
//but you cannot use set/get etc on the object later as its a pure js object. 
```

`SVG` is kind of strict in most ways, needs `setAttributeNS` in most places, takes all textNodes, so making a template engine manage things inside SVG is hard.

One workaround for now will be to use separate positioned `SVG` elements and restructure like:

```
App.EventView = Ember.View.extend({
    tagName: 'svg',
    templateName: 'event',
    ....
}); 
```

* * *

```
<script type="text/x-handlebars" id="event"><g><rect {{bindAttr x="view.x"}} {{bindAttr y="view.y"}} {{bindAttr width="view.width"}} {{bindAttr height="view.height"}}></rect></g></script> 
```

* * *

```
svg.ember-view{position:absolute;top:10px;left:10px;} 
```

[http://jsfiddle.net/UgeFk/4/](http://jsfiddle.net/UgeFk/4/)

[http://jsfiddle.net/UgeFk/5/](http://jsfiddle.net/UgeFk/5/)

I did something similar on a dropped project:

```
{{#each groups}}
  {{#view App.groupView groupBinding="this"}}
    <svg class="migration" height="568" width="1024">
      <g transform="translate(0,0)">
        {{countryMarkers}}
        <path {{bindAttr style="bezierStyle"}} {{bindAttr d="bezierPath"}} class="curve" />
      </g>
    </svg>
  {{/view}}
{{/each}} 
```

I would also love to hear if there is a better solution without unbinding or manual templating.

# php - 使用按钮保存变量但不重新加载页面

> ID：12485345
> 
> 赞同：0
> 
> 时间：2012-09-18T21:29:07.717
> 
> 标签：php, javascript

所以我有一个网站，整个页面需要填写大约 10 到 20 张表格，但是在中间有一个部分询问您是否要购买东西。我想要这个设置是你可以点击“购买”（一个按钮设置为在数组中设置一个变量）并继续填写你的信息。但是我突然想到，如果我这样做了，页面会重新加载，您尝试按“购买”，有效地清除所有您刚刚花时间输入信息的字段。有什么方法可以让我有一个“购买”按钮，将项目的 sku 发送到数组而不重新加载页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:31:51.020

最简单的方法是设置一个隐藏的输入字段，该字段将包含用户是否购买此商品。单击按钮时会更新该值。

但是，我可能会建议使用复选框。也许用户会在点击按钮后决定他们实际上并不想购买该商品。拥有一个复选框可以让用户改变主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:31:12.917

没有看到你在做什么很难说，而且由于你没有发布任何代码，我不能只给你模糊的建议。

我建议使用会话来存储数据或使用 AJAX 将值传递到另一个页面。

# java - 为什么我不能在 java 中像这样延迟初始化静态长数组？

> ID：12485346
> 
> 赞同：4
> 
> 时间：2012-09-18T21:29:09.673
> 
> 标签：java, static-members, lazy-initialization

```
private static final long[] reservedFromIps;

static {
    reservedFromIps = {0l, 167772160l, 1681915904l, 
        2130706432l, 2851995648l, 2886729728l, 3221225984l, 3227017984l, 3232235520l, 
        3323068416l, 3325256704l, 3405803776l, 3758096384l, 4026531840l, 4294967295l}; 
} 
```

错误是“表达式的非法开始，而不是语句，;预期”

而以下工作正常：

```
private static final long[] reservedFromIps = {0l, 167772160l, 1681915904l, 
    2130706432l, 2851995648l, 2886729728l, 3221225984l, 3227017984l, 3232235520l, 
    3323068416l, 3325256704l, 3405803776l, 3758096384l, 4026531840l, 4294967295l}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T21:33:23.210

这与块无关`static`，数组常量只能在初始化器中使用。这就是指定语言的方式。
此代码也不会编译：

```
public class Test {
    public static void main(String[] args) {
        long[] reservedFromIps;
        reservedFromIps = {0l, 167772160l, 1681915904l, 
                2130706432l, 2851995648l, 2886729728l, 3221225984l, 3227017984l, 3232235520l, 
                3323068416l, 3325256704l, 3405803776l, 3758096384l, 4026531840l, 4294967295l}; 
    }
} 
```

为什么会出现这种情况可能是一个增加了编译器复杂性的问题，几乎没有增加收益，但要完全确定您必须与 Java 设计团队一起讨论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T21:32:42.057

首先，您的静态初始化程序块（或您的字段声明）中有一个错字。其次，您必须这样做：

```
static {
        reservedFromIps = new long[]{0l, 167772160l, 1681915904l, 
            2130706432l, 2851995648l, 2886729728l, 3221225984l, 3227017984l, 3232235520l, 
            3323068416l, 3325256704l, 3405803776l, 3758096384l, 4026531840l, 4294967295l}; 
} 
```

数组常量只能在初始化器中使用，而不能在重新分配数组时使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T21:39:35.703

Java 编译器无法解析速记表达式的类型。语法在表达式之前需要类型标识符，无论表达式是什么，类型。仅对基元和字符串例外。数组不是原始的。

当用作初始化器时，初始化**器**表达式类型是已知的 - 与初始化**变量**类型相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T21:33:11.230

数组类型变量的声明必须与初始化在同一语句中进行。喜欢`long[] reservedFromIps = { /* ... */}`。它是语法糖所必需的（我们可以用它来初始化一个数组`{}`）。

例如以下应该工作 -

```
static { 
    reservedFromIps = new long[] {0l, 167772160l, 1681915904l,  
    2130706432l, 2851995648l, 2886729728l, 3221225984l, 3227017984l, 3232235520l,  
    3323068416l, 3325256704l, 3405803776l, 3758096384l, 4026531840l, 4294967295l};  
} 
```

原因如下

```
private static final long[] reservedFromIps = {0l, 167772160l, 1681915904l,  
    2130706432l, 2851995648l, 2886729728l, 3221225984l, 3227017984l, 3232235520l,  
    3323068416l, 3325256704l, 3405803776l, 3758096384l, 4026531840l, 4294967295l}; 
```

有效是因为在这种情况下，数组的声明和初始化`reservedFromIps`在同一个语句中。

# java - 扩展类中的 Java 反射字段值

> ID：12485351
> 
> 赞同：2
> 
> 时间：2012-09-18T21:29:45.357
> 
> 标签：java, reflection

> **可能重复：**
> [通过 Java 中的反射访问私有继承字段](https://stackoverflow.com/questions/3567372/access-to-private-inherited-fields-via-reflection-in-java)

您好，我遇到了 java 反射的 init 值问题。

我有简单的课

```
 public class A extends B {
     private String name;
 }

  public class B {
     private String superName;   
  } 
```

而且我有简单的功能：

```
 public void createRandom(Class<T> clazz , List<String> classFields){

    try {
        T object = clazz.newInstance();
        for(String s : classFields){
            clazz.getDeclaredField(s);
        }

    } catch(Exception e){

    }

   } 
```

我的功能做其他事情，但我有问题，因为我有错误：

```
java.lang.NoSuchFieldException: superName 
```

如何使用反射设置所有类字段以及超类中的字段？

我有所有的类字段（也是继承的）并且我正在使用函数`field.set(Object obj, Object value)`但是这样我不能设置继承的类字段：/

我没有问题来获取我正在使用 Spring ReflectionUtils.doWithfield 的所有类字段。我将所有字段名称存储在 中`List<String> classField`，所以我知道所有 clazz 字段也继承了。但我的问题是如何为所有 clazz 字段设置值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T21:36:53.600

如果我不得不猜测，我假设您在 A 类上调用此方法，并期望能够查看 B 类中声明的基础字段，如下所示：

```
A.class.getDeclaredField("superName"); 
```

情况并非如此，并且会抛出异常 ( `java.lang.NoSuchFieldException`)。反射不检查超类来查找字段或方法。因此，由于 class`A`没有定义`superName`，因此不会像这样使用反射找到它。但是，您可以修改代码以使其检查所有超类，直到它`null`作为超类到达，此时如果仍未找到它，则它肯定不存在。

这是一个例子：

```
public static Field findUnderlying(Class<?> clazz, String fieldName) {
    Class<?> current = clazz;
    do {
       try {
           return current.getDeclaredField(fieldName);
       } catch(Exception e) {}
    } while((current = current.getSuperclass()) != null);
    return null;
} 
```

这是一个示例调用`findUnderlying(A.class, "superName")`：它会首先检查 A 类的字段。由于 A 没有它，所以 dowhile 然后转到它的超类，即 B （不为空，所以继续）。B 确实有它，因此它会返回该字段。如果 B 没有它，它将检查 Object，然后返回 null，因为 Object 没有超类。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-18T21:40:57.803

您可以使用：

```
clazz.getSuperclass().getDeclaredField(s); 
```

而不是（或除了一些try-catch）：

```
clazz.getDeclaredField(s); 
```

**编辑：**

要设置超类的值，请使用以下命令：

```
Field f = clazz.getSuperclass().getDeclaredField(s);
f.setAccessible(true); // Especially necessary if the field is not public
f.set(yourObject, theValue); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T21:39:48.333

[使用Class.getSuperclass()](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getSuperclass%28%29)获取超类。然后使用超类，您可以获得它的字段。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-18T21:36:04.770

即使 A 从 B 扩展，它也不适用于 A 的实例，这是因为子类中无法访问私有成员。尝试将 superName 的访问权限更改为 protected ，如果它有效......

# android - ActionBar Sherlock - 显示一个变成刷新按钮的进度条

> ID：12485352
> 
> 赞同：2
> 
> 时间：2012-09-18T21:29:46.287
> 
> 标签：android, actionbarsherlock

我已将 ABS 集成到我的应用程序中。我有一个包含刷新按钮的膨胀菜单栏。当我点击刷新按钮时，它应该变成一个进度条，一旦我的刷新调用完成，它应该变成一个刷新按钮。我怎样才能做到这一点 ？

亲切的问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:50:28.113

您可以通过使菜单具有框架布局或您想要的任何其他布局并在其上放置一个按钮和一个进度条来做到这一点......这个进度条应该默认隐藏......

在运行时，当您单击刷新按钮时，您可以切换进度条和按钮的可见性......当进度条的工作完成时......再次做同样的技巧......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:58:04.867

将您的按钮放入 FrameLayout 并在此 framelayout 中放入一个带有 的进度条`android:visibility="gone"`，然后在加载数据后获取此进度条并将按钮可见性设置为可见，并将进度条设置为消失。

一些伪代码：

```
private void onDataLoaded(){
   ProgressBar pb = getSupportActionBar.getCustomView().findViewbyId(R.id.pb);
   pb.setVisibility(View.GONE);
   Button refresh = getSupportActionBar.getCustomView().findViewbyId(R.id.refresh);
   pb.setVisibility(View.VISIBLE);
} 
```

# jquery - 如何使用 jQuery 创建一个简单的选项卡？

> ID：12485353
> 
> 赞同：0
> 
> 时间：2012-09-18T21:29:50.413
> 
> 标签：jquery, jquery-ui, tabs

看看[http://jquerytools.org/demos/tabs/skin1.htm](http://jquerytools.org/demos/tabs/skin1.htm)。相当优雅。如何使用 jQuery（不是 jQuery 工具）完成同样的事情？Theme Rooler 对为此创建主题没有帮助，它只能更改颜色，大多数情况下。我不想使用 jQuery 工具，因为我已经使用 jQuery。不想混合到单独的库中。

所以我已经弄脏了 CSS（修改 jQuery 的 css），但我无法得到完全相同的结果。有更简单的解决方案吗？我正在考虑放弃 jQuery 的选项卡并从头开始创建自己的选项卡，但仍然使用一些 jQuery 功能，例如 hide() 或选择器。我知道我的问题很模棱两可，但我只想指出正确的方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:34:14.230

jQuery Tools 是 jQuery 的扩展，与它没有冲突。事实上，如果不首先加载 jQuery，它将无法工作。他们为许多常见的网页元素提供了非常好的库。你自己说它很优雅，为什么不使用它呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:39:02.133

请试试这个：http: [//jsfiddle.net/wZPzB/](http://jsfiddle.net/wZPzB/)

好链接：http: [//jqueryui.com/demos/tabs/](http://jqueryui.com/demos/tabs/)

不太清楚，你是什么意思不使用脚本下面的 JQ 工具不使用工具库。

希望它符合原因！`:)`

**脚本**

```
 <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'></script>
  <script type="text/javascript" src="http://code.jquery.com/ui/1.8.18/jquery-ui.min.js"></script>
  <script type="text/javascript" src="/js/lib/jquery.lint-11-06.js"></script>
    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/ui-lightness/jquery-ui.css"> 
```

**代码**==>`$( "#tabs" ).tabs();`

```
var $tabsList = $( "<ul></ul>" );

$( ".tab h3" )
    .each( function( idx ) {
        var $this = $( this ),
            tabId = "tabs-" + idx;

        $tabsList.append( "<li><a href='#" + tabId + "'>" + $this.text() + "</a></li>" );

        $this
            .parent()
                .removeClass( "tab" )
                .attr( "id", tabId );

        $this.remove();

    } );

$tabsList.prependTo( ".tabs" );

$( ".tabs" ).tabs();
​ 
```

# .net - .NET 中的 XML 到字符串转换

> ID：12485354
> 
> 赞同：1
> 
> 时间：2012-09-18T21:29:51.870
> 
> 标签：.net, xml, vb.net

```
<IS_ID>
     <PROPERTIES SOURCE="Correction" USER="123@xyz.com" DATE="14-Sep-2012 15:47:27" />
     <HEADER Action='Update' />
     <HEADER EMO_ID="12503652" />
     <HEADER SourceResolutionID="JT-362" />
     <DETAIL Type=Cumulative/Service Pack/Patch Release />
     <DETAIL Language=English />
     <DETAIL ServicePack="11" />
     <DETAIL ExternalDefectID=FIN-17243 />
     <DETAIL ResolutionID=JT_1239 />
     <DETAIL Classification=M3 Applications />
 </IS_ID> 
```

我可以将属性转换为`String`使用下面的代码，但同样不适用于`HEADER`和`DETAIL`元素，因为它们对每个属性都有结束标记。我该如何解决这个问题？

```
Dim sbProperties As New System.Text.StringBuilder
sbProperties.Append("<PROPERTIES>")
If Not xmlAttributes Is Nothing Then
    For Each xmlAttribute In xmlAttributes
        sbProperties.Append("<" & xmlAttribute.Name.ToUpper & ">" & xmlAttribute.Value & "</" & xmlAttribute.Name.ToUpper & ">")
    Next
    sbProperties.Append("</PROPERTIES>")
    Dim strProperties As String = sbProperties.ToString
End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:39:18.660

如前所述，您的示例“XML”是无效的。但是，您应该使用 XML 解析类之一，例如`XMLReader`与`StringBuilder`.

有关如何使用 VB 和 C# 执行此操作的信息，您可能会发现[此链接很有帮助。](http://msdn.microsoft.com/en-us/library/cc189056%28v=vs.95%29.aspx)

# javascript - Opera 上的 ember-1.0.pre.js '未处理错误：Object.defineProperty：第一个参数不是对象'

> ID：12485357
> 
> 赞同：0
> 
> 时间：2012-09-18T21:30:07.623
> 
> 标签：javascript, ember.js, opera

我在 Opera（12.02 build 1578，Windows 64 位上的最新版本）中使用 ember.1.0.pre.js 的应用程序正在抛出

`'Unhandled Error: Object.defineProperty: first argument not an Object'`

```
g ember-1.0.pre.min.js:9
(anonymous) ember-1.0.pre.min.js:9
(global) ember-1.0.pre.min.js:9 
```

但是我在 Chrome、Safari 或 Firefox 中没有收到此错误。我尝试使用调试版本来获取更多信息，但是当我使用 ember-1.0.pre.js **（调试版本）**时，我会抛出此错误

```
"Unhandled Error: assertion failed: Ember Handlebars requires Handlebars 1.0.beta.5 or greater"

Ember.assert ember-1.0.pre.js:43
(anonymous) ember-1.0.pre.js:17765
(global) ember-1.0.pre.js:17956 
```

注意：我正在使用 requirejs，该实现适用于除歌剧之外的所有内容

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T17:22:53.970

确保您`handlebars.js`以正确的顺序包含在您的 HTML 页面中，即在`ember.js`加载 javascript 之前的顺序。

```
<script src="/javascripts/handlebars.js" type="text/javascript"></script>
<script src="/javascripts/ember.js" type="text/javascript"></script> 
```

并不是

```
<script src="/javascripts/ember.js" type="text/javascript"></script>
<script src="/javascripts/handlebars.js" type="text/javascript"></script> 
```

我曾经遇到过同样的错误—— `"Unhandled Error: assertion failed: Ember Handlebars requires Handlebars 1.0.beta.5 or greater"` 在我意识到加载顺序错误之前。我设置正确后错误消失了。

编辑：刚刚注意到您提到您正在使用`requirejs`. 我对 requirejs 不是很精通，但据我所知，请确保您正确使用 shim 配置：

```
requirejs.config({
    shim: {
        'ember': {
            deps: ['handlebars', 'jquery'],
            exports: 'Ember'
        }
    }
}); 
```

# jquery - jq网格。2列表。（几行）

> ID：12485366
> 
> 赞同：0
> 
> 时间：2012-09-18T21:30:43.467
> 
> 标签：jquery, asp.net, visual-studio-2010, jquery-ui, jqgrid

我正在努力实现这一点，也许你们中的一些人以前来过这里。

我使用 jqgrid 是为了让整个页面看起来相似，我需要的非常简单，只显示数据，而不是排序等。我需要显示一个 2 列的表。这是一些粗略的例子。

```
Name:             Dan
Last Name:        McMillan
Address:          47 st.
Number:           555-55555
Married:          No 
```

依此类推，再多几行……左列几乎总是相同的静态信息。右列（所有数据本身）保存在 C# 变量中。

有没有办法将我的左列设置`Headers`为 jqgrid 的？垂直使用值而不是通常的方式。然后我怎样才能将正确的列附加到它？

# ant - 未捕获服务器主机密钥 - ant script exec

> ID：12485374
> 
> 赞同：0
> 
> 时间：2012-09-18T21:31:26.117
> 
> 标签：ant, ssh, exec

```
I have created the script which will execute the command in the host machine.

    <target name="Testpssh">
        <property name="failonerror" value="true"/>
            <exec executable="cmd" failonerror="${failonerror}">
       "plink -pw ${password} ${username}@${host} ${command}"/>
       </exec>
     </target>

I have given the host, username and pwd correctly. while running am getting error as 
```

服务器的主机密钥未缓存在注册表中。您
无法保证服务器就是您
认为的计算机。
服务器的密钥指纹是：
***** ***** *server fingerpint here* ****
如果您信任此主机，请输入“y”将密钥添加到
PuTTY 的缓存中并继续连接。
如果您只想进行一次连接，而不
将密钥添加到缓存中，请输入“n”。
如果您不信任此主机，请按 Return 放弃
连接。
将密钥存储在缓存中？(y/n)
已放弃连接。

```
any idea to overcome this problem in code? thanks in advance. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:04:56.690

自答：

在客户端机器的腻子中，对目标机器进行了 ssh，接受了指纹，然后运行了我的 ant 脚本，没有错误。

# c++ - 我无法使用 TerminateProcess 杀死子进程

> ID：12485379
> 
> 赞同：2
> 
> 时间：2012-09-18T21:31:42.650
> 
> 标签：c++, createprocess

我在使用`TerminateProcess`. 我调用这个函数并且进程仍然存在（在任务管理器中）。这段代码被多次调用，多次启动相同的program.exe，这些进程在任务管理器中，我认为这不好。实际上一直创建两个进程：program.exe和conhost.exe。

我将非常感谢任何帮助。

这是代码：

```
STARTUPINFO childProcStartupInfo;
memset( &childProcStartupInfo, 0, sizeof(childProcStartupInfo));
childProcStartupInfo.cb = sizeof(childProcStartupInfo);
childProcStartupInfo.hStdInput = hFromParent;   // stdin
childProcStartupInfo.hStdOutput = hToParent;    //  stdout
childProcStartupInfo.hStdError = hToParentDup;  // stderr
childProcStartupInfo.dwFlags = STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW;
childProcStartupInfo.wShowWindow = SW_HIDE;

PROCESS_INFORMATION childProcInfo;  /* for CreateProcess call */

bOk = CreateProcess(
    NULL,           // filename
    pCmdLine,   // full command line for child
    NULL,           // process security descriptor */
    NULL,           // thread security descriptor */
    TRUE,           // inherit handles? Also use if STARTF_USESTDHANDLES */
    0,              // creation flags */
    NULL,           // inherited environment address */
    NULL,           // startup dir; NULL = start in current */
    &childProcStartupInfo,          // pointer to startup info (input) */
    &childProcInfo);            // pointer to process info (output) */

CloseHandle( hFromParent );
CloseHandle( hToParent );
CloseHandle( hToParentDup );

CloseHandle( childProcInfo.hThread);
CloseHandle( childProcInfo.hProcess);

TerminateProcess( childProcInfo.hProcess ,0);  //this is not working, the process 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T21:35:34.350

我知道有两个可能的原因：

*   您不能杀死在与调用 TerminateProcess 的进程不同的安全上下文中运行的进程（[请参见此处](http://support.microsoft.com/kb/155075)）
*   该进程正在[内核](http://blogs.technet.com/b/markrussinovich/archive/2005/08/17/unkillable-processes.aspx)模式下执行某些操作（例如，驱动程序进行的一些未完成的 I/O 操作等） - 我相信这是在 Vista 中引入的，但我可能错了

# javascript - 在javascript中访问对象与变量的属性

> ID：12485380
> 
> 赞同：2
> 
> 时间：2012-09-18T21:31:45.617
> 
> 标签：javascript

为什么当我尝试访问不存在的变量时，javascript 会抛出异常，但是当我尝试访问对象中不存在的属性时，javascript 会返回一个`undefined`值？

例如，这种情况下返回一个`undefined`值：

```
function Foo(){
    console.log(this.bar);
}

Foo(); 
```

但是，在另一个示例中，javascript 抛出异常：

```
function Foo(){
    console.log(bar);
}

Foo(); 
```

ReferenceError: bar 未定义

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:37:34.433

由于 JavaScript 中的每个对象都是一个字典，在其他语言中也称为 map，`this.bar`相当于`this['bar']`，即通过键访问值。在大多数语言中，例如在 Java 中，返回`null`、`NULL`或`undefined`允许您有条件地创建此插槽（如果它尚不存在），而无需处理异常或任何其他副作用。

但是，如果您只是编写`console.log(bar)`而不为 指定上下文`bar`，则不可能创建一个合理的模式，其中返回`undefined`将具有语义含义。有多个上下文，其中一些是动态的，例如`window`浏览器中的全局上下文，其中`bar`可能是在运行时定义的，因此它不能是编译时错误（与 Java 或 C++ 不同）。因此，当无法解析变量名时会引发运行时异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T23:19:17.900

属性解析与标识符解析根本不同。简单的答案是 ECMA-262 指定尝试读取不存在的变量将引发错误，而尝试读取不存在的对象属性则不会，它只是返回特殊的[未定义](http://ecma-international.org/ecma-262/5.1/#sec-4.3.9)值。

要了解原因，您需要先询问 Brendan Eich，他首先开发了 ECMA-262 所基于的 JavaScript。然而，一个合理的猜测是，Brendan 想让 JavaScript 成为一种具有松散类型的简单语言，而不是必须执行以下操作：

```
if ( 'foo' in obj) {
  /* do something with obj.foo */
} 
```

每次您第一次想要访问一个属性时，该语言都允许尝试访问未定义的属性。

另一方面，对变量应用相同的方法会产生比解决更多的问题，因此`typeof`可以用来查看标识符是否存在：

```
if (typeof foo != 'undefined') {
  /* ok to use foo */
} 
```

否则，属性和标识符解析非常相似。不同之处在于，首先从对象开始，沿着一串内部`[[Prototype]]`对象（继承链），最后到`null`对象，而变量解析从局部变量对象开始，沿着属于外部上下文的一串相似对象（范围链）到全局对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:45:20.430

```
function Foo(){
    console.log(window.bar);
}

Foo(); 
```

也会给你`undefined`。

`this.bar`方法`this["bar"]`

# mysql - 锁定与本机锁定功能的数据库列

> ID：12485382
> 
> 赞同：0
> 
> 时间：2012-09-18T21:31:47.767
> 
> 标签：mysql, database, oracle, locking

通常，每当我需要锁定数据库中的一行时，我都会使用一个 bool 类型的专用列，我已经打开和关闭了它。我最近了解到，在 MySQL 等各种数据库中都有内置的锁定功能。与使用列进行锁定和解锁相比，使用这些本机锁定功能有什么优势。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:37:55.800

1.  可读性。没有人会期待您的“锁定布尔值”。
2.  比赛条件。没有锁，你如何自动更新你的“锁定布尔值”？
3.  表现。当只需要一个时，您可能正在执行三个更新（锁定、更新、解锁）。

好吧，我现在累了。

# c++ - 没有匹配的函数可以调用

> ID：12485391
> 
> 赞同：1
> 
> 时间：2012-09-18T21:32:12.827
> 
> 标签：c++, qt

我从我的设计类中调用它，稍后将它们添加到布局中，但我总是收到该函数的错误消息`ladeBild(QLabel l, QString s)`

```
 void Levels::erzeugen(Levels *)
{
....

    ladeBild(l01,"l01.png");
    ladeBild(l02,"l02.png");
    ladeBild(l03,"l03.png");
    ladeBild(l04,"l04.png");
    ladeBild(l05,"l05.png");
    ladeBild(l06,"l06.png");
    ladeBild(l07,"l07.png");
    ladeBild(l08,"l08.png");
    ladeBild(l09,"l09.png");
    ladeBild(l10,"l10.png");
    ladeBild(l11,"l11.png");
    ladeBild(l12,"l12.png");
...
}

    void Levels::ladeBild(QLabel l,QString s)
{

    l = new QLabel();
    l.setBackgroundRole(QPalette::Dark);
    l.setAutoFillBackground(true);
    image = new QImage(s);//Muss im debug-Ordner sein!!!
    l.setPixmap(QPixmap::fromImage(*image));
    l.setMaximumHeight(image->height());
    l.setMaximumWidth(image->width());

} 
```

我收到以下错误消息（对于每次调用`ladeBild`）

> ```
> In member function 'void Levels::erzeugen(Levels*)': Fehler:no
> matching function for call to 'Levels::ladeBild(QLabel*&, const char
> [8])' candidates are: void Levels::ladeBild(QLabel, QString) Fehler:no
> match for 'operator=' in 'l = (QFlags<Qt::WindowType>(0u), (operator
> new(20u), (<statement>, ((QLabel*)<anonymous>))))' candidates are:
> QLabel& QLabel::operator=(const QLabel&)` 
> ```

无法解决这个问题...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:34:48.390

`Levels::ladeBild`期望 a `QLabel`，但应该是`QLabel*`。

# .net - 使用 TOR 设置 Privoxy

> ID：12485394
> 
> 赞同：1
> 
> 时间：2012-09-18T21:32:25.757
> 
> 标签：.net, vb.net, proxy, tor

所以我在 Visual Basic 中编写了一个程序，但 Visual Basic 使用 Internet 的默认 IE 设置。

我想知道是否可以使用 Privoxy 设置 IE 并将 Privoxy 与 TOR 连接。我知道 Privoxy 使用 127.0.0.1:8118 但我不知道如何将 Privoxy 与 TOR 连接。

***你不能谷歌吗？***
我确实尝试过，相信我，但每次我搜索时，我都会看到 2009 年使用旧 TOR 指南的页面。如果您不知道我在说什么，Privoxy 曾经与 TOR 捆绑在一起，但在 2010-2011 之间的某个地方被放弃了支持，并且没有关于它的指南。

更糟糕的是，在 Privoxy 中没有可以用来连接它的简单设置，我必须编辑这个文本文件并且它没有说明我必须在文本文件上编辑的位置（我检查了网站，没有帮助那里也有）

我只是尝试使用我的 Visual Basic 2010 程序（它使用 .NET Framework 4）打开一个 .onion 网站，所以如果有人有任何更简单的选项（如内置的 SOCKS5 代理）会有所帮助。我确实尝试将 IE 与 TOR 连接，并且在检查“http://check.torproject.org”时成功在 TOR 上显示即时消息，但是在尝试访问 .onion 站点时，它失败了。

任何人都可以帮助我吗？我尝试了所有我能想到但仍然失败的可能性:(

谢谢！

# c++ - 为什么我的程序最多只能编译 16 条记录？

> ID：12485398
> 
> 赞同：1
> 
> 时间：2012-09-18T21:32:40.423
> 
> 标签：c++, arrays, oop, file-io, time

下面是我的程序，它应该创建一个对象数组，然后告诉。每个循环需要多长时间运行。循环只是从文件和内存中读取/写入，程序应该在完成时比较这些方法。出于某种原因，如果创建的记录数为 16 或更少，程序只会显示时间。我似乎无法找出原因。我也看不出为什么我的比率不起作用。可能是因为每个变量都小于一秒，所以它可能试图将 0 除以 0？

```
#include <iostream>
#include <fstream>
#include <string>
#include <ctime>
#include <iomanip>
using namespace std;

class TestRecord
{
private:
int _number;
string _data;
public:
TestRecord ()
{_number = 0; _data = "no data";}

TestRecord (int number, string data)
{_number = number; _data = data;}

void setNumber (int number)
{_number = number;}

void setData (string data)
{_data = data;}

int getNumber() const
{return _number;}

string getData() const
{return _data;}

friend ostream &operator <<(ostream &out, TestRecord &records)
{
    out << records._number << " " << records._data;
    return out;
}
};

int main ()
{
    string string256 = "AaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronAaronA";
int recordsToBeCreated = 0;

cout << " How many records should be created?" << endl;
cin >> recordsToBeCreated;

TestRecord* recordObj = new TestRecord[recordsToBeCreated]; 

//--------------------------------------writing

clock_t startTime1 = clock();
for (int count = 0; count < recordsToBeCreated; count++)  //fill object array
{
    srand(count);
    recordObj[count].setData(string256);
    recordObj[count].setNumber(rand()% 10000 + 1000);

}
clock_t endTime1 = clock();
ofstream outFile;

clock_t startTime2 = clock();
for (int count1 = 0; count1 < recordsToBeCreated; count1++) //write to disk
{
    outFile.open("data.txt");
    outFile << recordObj[count1] << endl;
}
clock_t endTime2 = clock();
outFile.close();
//----------------------------------------reading
clock_t startTime3 = clock();
for(int count2 = 0; count2 < recordsToBeCreated; count2++) //read/write from mem
{
    int *tempNumber = new int;
    string *tempString = new string;

    *tempNumber = recordObj[count2].getNumber();
    *tempString = recordObj[count2].getData();

    delete tempNumber;
    delete tempString;
}
clock_t endTime3 = clock();
ifstream inFile;
clock_t startTime4 = clock();
for(int count3 = 0; count3 < recordsToBeCreated; count3++) //read/write from disk
{
    int *tempNumber = new int;
    string *tempString = new string;
    inFile.open("data.txt");

    inFile >> *tempNumber;
    inFile >> *tempString;

    delete tempNumber;
    delete tempString;
}
clock_t endTime4 = clock();
inFile.close();
//---------------------------------random reading comp

int randomNumber = rand()%recordsToBeCreated;

clock_t startTime5 = clock(); //traverse array to random index
for(int count4 = 0; count4 > randomNumber; count4++)
{
    recordObj[count4];
}
clock_t endTime5 = clock();

clock_t startTime6 = clock();
inFile.open("data.txt");
for(int count5 = 0; count5 < randomNumber; count5++)
{
    string *tempString = new string;
    cin.ignore();
    inFile >> *tempString;
}
clock_t endTime6 = clock();
inFile.close();

double seconds1 = endTime1 - startTime1;
seconds1 = seconds1 / CLOCKS_PER_SEC;
double seconds2 = endTime2 - startTime2;
seconds2 = seconds2 / CLOCKS_PER_SEC;
double seconds3 = endTime3 - startTime3;
seconds3 = seconds3 / CLOCKS_PER_SEC;
double seconds4 = endTime4 - startTime4;
seconds4 = seconds4 / CLOCKS_PER_SEC;
double seconds5 = endTime5 - startTime5;
seconds5 = seconds5 / CLOCKS_PER_SEC;
double seconds6 = endTime6 - startTime6;
seconds6 = seconds6 / CLOCKS_PER_SEC;

cout << "Time to write to memory:                      " << fixed << setprecision (5) << seconds1 << " seconds" << endl;
cout << "Time to write to file:                        " << setprecision (5) << seconds2 << " seconds" <<  endl;
cout << "Ratio of (write to disk)/(write to memory):   " << seconds2/seconds1 <<  endl;
cout << "\n\n";
cout << "Runtime to read from memory:                  " << setprecision (5) << seconds3 << " seconds" <<  endl;
cout << "Runtime to read from disk:                    " << setprecision (5) << seconds4 << " seconds" <<  endl;
cout << "Ratio of (read from disk)/(read from memory): " << seconds4/seconds3 << endl;
cout << "\n\n";
cout << "Runtime to find random index from memory:     " << setprecision (5) << seconds5 << " seconds" <<  endl;
cout << "Runtime to find random line from disk:        " << setprecision (5) << seconds6 << " seconds" <<  endl;
cout << "Ratio of (read from disk)/(read from memory): " << seconds6/seconds5 << endl;

delete [] recordObj;
system("pause");
return 0; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:12:12.990

编辑：

这条线

```
for(int count4 = 0; count4 > randomNumber; count4++) 
```

很危险。您不会仅仅因为迟早会`count4`环绕而进入无限循环，但这是一个糟糕的情况。`2^32-1`不应该`count 4 < randomNumber`吗？

编辑2：

tempInt/tempString 的分配只能进行一次（在循环之前），而不是在循环本身。

老东西：

第一个（相当明显的）建议：停止动态分配所有内容。

代替

```
for(int count2 = 0; count2 < recordsToBeCreated; count2++) //read/write from mem
{
   int *tempNumber = new int;
   string *tempString = new string;

   *tempNumber = recordObj[count2].getNumber();
   *tempString = recordObj[count2].getData();

   delete tempNumber;
   delete tempString;
} 
```

只做

```
for(int count2 = 0; count2 < recordsToBeCreated; count2++) //read/write from mem
{
   int tempNumber;
   string tempString;

   tempNumber = recordObj[count2].getNumber();
   tempString = recordObj[count2].getData();
} 
```

正如您应该知道的，`tempNumber`并且`tempString`将在堆栈上分配，并且它们在每次迭代结束时被释放。

现在的错误。

在这个循环中

```
for (int count1 = 0; count1 < recordsToBeCreated; count1++)
{
    outFile.open("data.txt");
    outFile << recordObj[count1] << endl;
} 
```

您在每次迭代时覆盖文件。我想这应该是

```
outFile.open("data.txt");
// write 'em all
for (int count1 = 0; count1 < recordsToBeCreated; count1++)
{
    outFile << recordObj[count1] << endl;
} 
```

在这个循环中

```
for(int count3 = 0; count3 < recordsToBeCreated; count3++) //read/write from disk
{
   int *tempNumber = new int;
   string *tempString = new string;
   inFile.open("data.txt");

   inFile >> *tempNumber;
   inFile >> *tempString;

   delete tempNumber;
   delete tempString;
} 
```

您再次重新打开“data.txt”，因此您只阅读了第一行。

这应该是（删除分配）

```
inFile.open("data.txt");
for(int count3 = 0; count3 < recordsToBeCreated; count3++) //read/write from disk
{
   int tempNumber;
   string tempString;

   inFile >> tempNumber;
   inFile >> tempString;
} 
```

# haskell - 约束类型类或实例的派生变量

> ID：12485403
> 
> 赞同：6
> 
> 时间：2012-09-18T21:32:54.317
> 
> 标签：haskell

我正在为我的`pipes`库编写一个类型类来定义一个类类型的抽象接口`Proxy`。类型类看起来像：

```
class ProxyC p where
    idT   :: (Monad m) => b' -> p a' a b' b m r
    (<-<) :: (Monad m)
          => (c' -> p b' b c' c m r)
          -> (b' -> p a' a b' b m r)
          -> (c' -> p a' a c' c m r)
    ... -- other methods 
```

我还在为以下`Proxy`形式的类型编写扩展：

```
instance (ProxyC p) => ProxyC (SomeExtension p) where .... 
```

...并且我希望这些实例能够施加额外的约束，即 if`m`是 a `Monad`then`p a' a b' b m`是 a`Monad`对于所有`a'`, `a`, `b'`, and `b`.

但是，我不知道如何将其干净地编码为`ProxyC`类或实例的约束。我目前知道的唯一解决方案是在类的方法签名中进行编码：

```
 (<-<) :: (Monad m, Monad (p b' b c' c m), Monad (p a' a b' b m))
          => (c' -> p b' b c' c m r)
          -> (b' -> p a' a b' b m r)
          -> (c' -> p a' a c' c m r) 
```

...但我希望会有一个更简单、更优雅的解决方案。

**编辑**：甚至最后一个解决方案也不起作用，因为编译器不会推断出这`(Monad (SomeExtension p a' a b' b m))`意味着`(Monad (p a' a b' b m))`特定的变量选择，即使给出以下实例：

```
instance (Monad (p a b m)) => Monad (SomeExtension p a b m) where ... 
```

**编辑#2**：我正在考虑的下一个解决方案只是在`Monad`类中复制类的方法`ProxyC`：

```
class ProxyC p where
    return' :: (Monad m) => r -> p a' a b' b m r
    (!>=) :: (Monad m) => ... 
```

...然后用每个`ProxyC`实例实例化它们。这对我的目的来说似乎没问题，因为这些`Monad`方法只需要在内部用于扩展编写，并且原始类型仍然有一个适合`Monad`下游用户的实例。所有这些只是将`Monad`方法公开给实例编写器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T04:40:30.667

一个相当简单的方法是使用 GADT 将证明移动到价值级别

```
data IsMonad m where
  IsMonad :: Monad m => IsMonad m 

class ProxyC p where
  getProxyMonad :: Monad m => IsMonad (p a' a b' b m) 
```

您需要在需要的地方显式打开字典

```
--help avoid type signatures
monadOf :: IsMonad m -> m a -> IsMonad m
monadOf = const

--later on
case getProxyMonad `monadOf` ... of
  IsMonad -> ... 
```

使用 GADT 来通过命题证明的策略非常普遍。如果您可以使用约束类型，而不仅仅是 GADT，您可以改用 Edward Kmett 的`Data.Constraint`包

```
class ProxyC p where
  getProxyMonad :: Monad m => Dict (Monad (p a' a b' b m)) 
```

它可以让你定义

```
getProxyMonad' :: ProxyC p => (Monad m) :- (Monad (p a' a b' b m))
getProxyMonad' = Sub getProxyMonad 
```

然后使用一个花哨的中缀运算符告诉编译器在哪里寻找 monad 实例

```
 ... \\ getProxyMonad' 
```

实际上，`:-`蕴含类型形成了一个类别（其中对象是约束），并且这个类别有*很多*很好的结构，也就是说它很适合做证明。

ps 这些片段都没有经过测试。

编辑：您还可以将值级别证明与新类型包装器结合起来，而无需到处打开 GADT

```
newtype WrapP p a' a b' b m r = WrapP {unWrapP :: p a' a b' b m r}

instance ProxyC p => Monad (WrapP p) where
  return = case getProxyMonad of
                Dict -> WrapP . return
  (>>=) = case getProxyMonad of
               Dict -> \m f -> WrapP $ (unWrapP m) >>= (unWrapP . f)

instance ProxyC p => ProxyC (WrapP p) where
  ... 
```

我怀疑，但显然没有测试过，这种实现也会相对有效。

# ruby-on-rails-3 - 如何使用 ActiveModel::Serializers 为同一模型实现多个不同的序列化器？

> ID：12485404
> 
> 赞同：42
> 
> 时间：2012-09-18T21:32:59.827
> 
> 标签：ruby-on-rails-3, json, rest, activemodel

假设您正在 Rails 中实现一个 REST API。提供集合时，您可能只想包含几个属性：

```
/people 
```

但是在提供单一资源时，您希望包含所有属性：

```
/people/1 
```

我不知道如何使用 ActiveModel::Serializers 来做到这一点，因为这些示例都使用了为每个模型定义一个序列化器（使用标准命名约定）并让 AMS 在您这样做时自动在控制器中使用正确的序列化器的模式：

```
render json: @people 
```

或者：

```
render json: @person 
```

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2012-10-25T15:48:36.697

您*可以*为同一模型拥有多个序列化程序，例如

```
class SimplePersonSerializer < ActiveModel::Serializer
  attributes :id, :name
end 
```

和

```
class CompletePersonSerializer < ActiveModel::Serializer
  attributes :id, :name, :phone, :email
end 
```

一个控制器中的人员的简单信息：

```
render json: @people, each_serializer: SimplePersonSerializer 
```

另一个人的完整信息：

```
render json: @people, each_serializer: CompletePersonSerializer 
```

一个人的简单信息：

```
render json: @person, serializer: SimplePersonSerializer 
```

一个人的完整信息：

```
render json: @person, serializer: CompletePersonSerializer 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-06-17T21:33:37.263

```
class CompletePersonSerializer < ActiveModel::Serializer
  root :person
  attributes :id, :name, :phone, :email
end 
```

或者

```
render json: @people, each_serializer: CompletePersonSerializer, root: :person 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-27T04:50:58.667

为避免将视图问题混入模型中（通过序列化变体），请使用视图为每个操作呈现 JSON，就像我们为 HTML 所做的那样。

[jbuilder](https://github.com/rails/jbuilder)和[rabl](https://github.com/nesquena/rabl)都很好地满足了这种数据模板化需求。

**2013-12-16 更新**：[ActiveModelSerializers](https://github.com/rails-api/active_model_serializers)库确实支持为一个模型定义多个序列化器，正如@phaedryx 稍后回答的那样，通过使用[自定义序列化](https://github.com/rails-api/active_model_serializers#3-subclass-the-serializer-and-specify-using-it)器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-10T20:30:11.537

除了@phaedryx 所说，我为此做的是调用一个返回正确序列化程序的方法......对于你的问题，我会使用：

```
class MyController < ApplicationController

  def index
    render json: @people, each_serializer: serializer_method
  end

  private

  def serializer_method
    defined?(@people) ? PeopleSerializer : PersonSerializer
  end

end 
```

# d3.js - 到达数组末尾时删除额外的数据点

> ID：12485407
> 
> 赞同：1
> 
> 时间：2012-09-18T21:33:09.723
> 
> 标签：d3.js

我正在使用数组切片来分页数据。当我到达最后一页（只有 7 个元素而不是 10 个）时，我无法删除最后 3 个条。.exit().remove() 适用于页面上的其他元素，但由于某种原因不适用于条形图。如何删除最后一页上的 8-10 条？

这是关于 jsfiddle 的示例：http: [//jsfiddle.net/PMEAT/1/](http://jsfiddle.net/PMEaT/1/)

这是来自 jsfiddle 的代码：

```
var data = [1,1,1,1,1,1,1,1,6,7,3,3,3,3,3,3,3];
var chart = d3.select("body").append("svg")
.attr("class","chart")
.attr("width",440)
.attr("height",300);
var barnumber = 10;
var page = 1;

var y = d3.scale.linear()
.domain([0,10])
.range([0,300])

var viewdata = data.slice((page-1)*barnumber,page*barnumber);

var rect = chart.selectAll("rect")
.data(viewdata);

rect.enter().insert("rect")
    .attr("x",function(d,i){ return i*20})
    .attr("y",function(d) {return 300 - y(d);})
    .attr("width", 20)
    .attr("height", y);

chart.selectAll("text")
.data(viewdata)
    .enter().append("text")
    .attr("x", function(d,i) { return i*20+8; })
    .attr("y", 290)
    .text(String);

$('#next').click(function() {
    page++;
    viewdata = data.slice((page-1)*barnumber,page*barnumber);
    redraw();
});

$('#last').click(function() {
    page--;
    viewdata = data.slice((page-1)*barnumber,page*barnumber);
    redraw();
});

function redraw() {
rect.data(viewdata)
    .transition()
    .duration(500)
    .attr("x",function(d,i){ return i*20})
    .attr("y",function(d) {return 300 - y(d);})
    .attr("width", 20)
    .attr("height", y);

    chart.selectAll("text")
.data(viewdata)
     .transition()
    .duration(500)
    .text(String);

rect.exit().remove();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T23:14:32.940

数据运算符不会就地计算数据连接；它返回一个新的选择。您没有保存[selection.data](https://github.com/mbostock/d3/wiki/Selections#wiki-data)的结果，因此您的`rect`选择没有得到更新。

您需要先保存数据连接，而不是直接从数据连接的更新选择中链接转换：

```
// First save the result of the data-join.
rect = rect.data(viewdata);

// Then update.
rect.transition()
    .duration(500)
    …

// Then exit.
rect.exit().remove(); 
```

当然，如果您要删除退出选择，您可能还需要附加到输入选择。否则，当您到达最后一页并尝试返回时，您将永远只能停留在 7 个小节上，而不是回到 10 个小节。

# java - 将 Eclipse 与 Windows 7 中的 src (.java) 文件相关联

> ID：12485410
> 
> 赞同：3
> 
> 时间：2012-09-18T21:33:31.043
> 
> 标签：java, eclipse

有没有一种方法可以将 Eclipse 与 Windows 中的文件扩展名 .java 相关联？因此，当我在 Windows 资源管理器或 Total Commander 中双击该文件时，它会自动在 Eclipse 中打开 .java 文件以进行查看和编辑。当您单击 c# .cs 文件或任何其他类型时，类似于 Visual Studio...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:37:37.520

您可以右键单击 .java 文件。然后单击属性，然后更改打开方式选项。现在将显示一个对话框窗口，您只需在对话框中找到您的 eclipse.exe。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:49:32.173

有两种方法可以简单地做到这一点：

```
right click on .java file > open with > eclipse > check 'set as default program' 
```

或通过控制面板访问它（不确定哪个文件夹下的哪个选项。尝试“默认程序”菜单

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:38:43.613

您是否尝试过右键单击-> 打开方式-> 其他-> Eclipse？

# c++ - SetupDiEnumDeviceInterfaces 失败问题

> ID：12485414
> 
> 赞同：0
> 
> 时间：2012-09-18T21:33:52.127
> 
> 标签：c++, windows, handle

我在使上述功能正常工作时遇到问题。我已经阅读了 MSDN 和文档，这就是我想出的，但是它失败了。

因此，我使用 SetupDiGetClassDevs 列出了所有设备，然后将其存储到句柄中。哪个工作正常，下一步是使用 SetupDiEnumDeviceInterfaces 枚举每个设备并传递句柄值。这是我丢失它的地方，它总是返回错误。希望能得到一些关于我哪里出错的建议。谢谢阅读。

```
#include <windows.h>
#include <setupapi.h>
#include <stdio.h>
#pragma comment(lib,"SetupAPI") 
//
int main() 
{
    // Set up handles and data storage
    HDEVINFO hDevInfo;
    // Load GUID Classes
    static GUID GUID_DEVINTERFACE_USB_HUB={ 0xf18a0e88, 0xc30c, 0x11d0, {0x88, 0x15, 0x00, 0xa0, 0xc9, 0x06, 0xbe, 0xd8} }; 
    static GUID GUID_DEVINTERFACE_USB_DEVICE ={ 0xA5DCBF10L, 0x6530, 0x11D2, { 0x90, 0x1F, 0x00, 0xC0, 0x4F, 0xB9, 0x51, 0xED } }; 
    static GUID GUID_DEVINTERFACE_USB_HOST_CONTROLLER={ 0x3abf6f2d, 0x71c4, 0x462a, {0x8a, 0x92, 0x1e, 0x68, 0x61, 0xe6, 0xaf, 0x27}}; 
    // 
    SP_DEVICE_INTERFACE_DATA ifdata;
    // Create a HDEVINFO with all present devices.
    hDevInfo = SetupDiGetClassDevs(NULL,0, 0, DIGCF_PRESENT | DIGCF_ALLCLASSES | DIGCF_DEVICEINTERFACE);
    //
        if (INVALID_HANDLE_VALUE == hDevInfo)
        {
        return FALSE;
        }
        else
        {
        printf("Device info set handle for all devices attached to system: 0x%x\n", hDevInfo);
        }
    //
    BOOL bResult = TRUE;
    DWORD nCount = 0;
    //
        while (bResult)
        {
        //
            ifdata.cbSize=sizeof(ifdata);
            //  
            bResult = SetupDiEnumDeviceInterfaces(
            hDevInfo,  
            NULL,   
            &GUID_DEVINTERFACE_USB_DEVICE,   
            (ULONG)nCount,  
            &ifdata); 

        //
        if(!bResult)
            {       
            printf("Error Failed\n");       
            //fails here with error 6 invalid handle 
            }
        }

    // Cleanup
    SetupDiDestroyDeviceInfoList(hDevInfo);
    //
    system ("pause");
    //
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T23:10:00.080

您的调用`SetupDiGetClassDevs`不正确，因为它返回的设备信息集元素最终缺少`SetupDiEnumDeviceInterfaces`需要工作的设备接口列表。

[`SetupDiGetClassDevs`请参阅msdn](http://msdn.microsoft.com/en-us/library/windows/hardware/ff551069%28v=vs.85%29.aspx)上文档的备注部分：

> 要返回支持任何类的设备接口的设备，请设置 DIFCF_DEVICEINTERFACE 标志，设置 DIGCF_ALLCLASSES 标志，并将 ClassGuid 设置为 NULL。该函数向设备信息集添加表示此类设备的设备信息元素，然后向设备信息元素添加包含设备支持的所有设备接口的设备接口列表。

`SetupDiGetClassDevs`因此，通过添加以下`DIGCF_DEVICEINTERFACE`标志来修复您的呼叫：

```
hDevInfo = SetupDiGetClassDevs(NULL,0,0, DIGCF_PRESENT | DIGCF_ALLCLASSES | DIGCF_DEVICEINTERFACE); 
```

# c# - 按位移位 - 在 C# 中获得与在 php 中不同的结果

> ID：12485416
> 
> 赞同：2
> 
> 时间：2012-09-18T21:34:04.130
> 
> 标签：c#, php, bit-manipulation

我正在尝试将一些 PHP 转换为 C#，但按位函数给了我不同的结果。

PHP 将返回 248

```
protected function readInt8()
{
    $ret = 0;
    if (strlen($this->_input) >= 1)
    {
        $sbstr = substr($this->_input, 0, 1);
        $ret = ord($sbstr);
        $this->_input = substr($this->_input, 1);
    }
    return $ret;
} 
```

C# 将返回 63

```
private int ReadInt8()
{
    int ret = 0;
    if (input.Length >= 1)
    {
        string substr = input.Substring(0, 1);
        ASCIIEncoding ascii = new ASCIIEncoding();
        byte[] buffer = ascii.GetBytes(substr);
        ret = buffer[0]; // 63

        this.input = this.input.Substring(1);
    }

    return ret;
} 
```

否则它将返回 14337

```
private int ReadInt8()
{
    int ret = 0;

    if (input.Length >= 1)
    {
        string substr = input.Substring(0, 1);

        ret = (int)(substr[0]); // 14337
        this.input = this.input.Substring(1);
    }

    return ret;
} 
```

这里的[另一个问题](https://stackoverflow.com/questions/6006574/bitwise-shift-getting-different-results-in-c-net-vs-php)适用于较大的值，但不适用于较小的值。我想知道问题是什么。

对不起。昨天有点晚了。

![来自服务器的字节](../Images/5aad52488e2478916bd79db349ffbb06.png)

使用以下函数转换的输入 = "Ԁϸ㠁Ǹϸ붻ȁ";

```
public string GetString(byte[] bytes)
{
    char[] chars = new char[bytes.Length / sizeof(char)];
    System.Buffer.BlockCopy(bytes, 0, chars, 0, bytes.Length);
    return new string(chars);
} 
```

关于换班。我认为它可能需要转变，因为 ReadInt16() 需要它。

```
private int ReadInt16()
{
    int ret = 0;
    if (input.Length >= 2)
    {
        ret  = ((int)(this.input.Substring(0, 1)[0]) & 0xffff) >> 8;
        ret |= ((int)(this.input.Substring(1, 1)[0]) & 0x0000) >> 0;
        this.input = input.Substring(2);
    }
    return ret;
 } 
```

我应该说。我可能误解了 PHP 中函数的使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:42:29.850

不要将字符串视为等同于字节数组。字符编码会干扰和破坏数据（如果它实际上不是文本）。如果您必须将原始数据作为文本传输，则必须对其进行适当的编码/解码，例如使用 base64 编码。

# c# - 阅读类型 从配置

> ID：12485421
> 
> 赞同：0
> 
> 时间：2012-09-18T21:34:29.563
> 
> 标签：c#, generics

> **可能重复：**
> [如何使用反射调用泛型方法？](https://stackoverflow.com/questions/232535/how-to-use-reflection-to-call-generic-method)

我有一个带有以下签名的方法

```
public string Register<T>()
{
  //code
} 
```

可以像这样调用

`var result = Register<Employee>()`;

我的要求是通过从配置文件中读取类型 T 来调用该方法，

*即：* 在调用时，我应该能够通过读取配置文件来动态提供它，而不是硬编码“Employee”。

关于如何做的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:40:40.360

好吧，您可以使用反射，特别是[MakeGenericMethod](http://msdn.microsoft.com/en-us/library/system.reflection.methodinfo.makegenericmethod.aspx)，但如果您在编译时没有类型，最好将方法签名更改为`Register(Type type)`. 然后你可以从配置文件中读取类型并直接传入。

**编辑**

如果您添加对 的引用`SimpleInjector.Extensions`，您将能够访问非通用注册方法。请参阅此处源中的[NonGenericRegistrationsExtensions.cs](http://simpleinjector.codeplex.com/SourceControl/changeset/view/94569#1810697)。这将允许您执行以下操作：

```
string typeName = GetTypeNameFromConfigFile();
Type type = Type.GetType(typeName);
container.RegisterSingle(type, type); // register as self 
```

那么你根本不需要泛型。

您可能还想阅读[高级场景](http://simpleinjector.codeplex.com/wikipage?title=Advanced-scenarios)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:37:41.023

编译时需要类型参数，因此为了做到这一点，您需要使用反射。

[如何使用反射调用泛型方法？](https://stackoverflow.com/questions/232535/how-to-use-reflection-to-call-generic-method)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:42:44.843

在 web.config 上

```
<appSettings>
<!-- The assembly name of the default type. Use the format Fully.Qualified.Class.Name, Assembly.FileName -->
<add key="DefaultType" value="MyTestApp.BusinessEntitites.Employee, MyTestApp.BusinessEntitites " />
</appSettings> 
```

在 C# 上：

```
static void Main(string[] args)
{
    Type obj = Type.GetType(ConfigurationManager.AppSettings["DefaultType"]);
    ConstructorInfo constructor = obj.GetConstructor(new Type[] { });
    var myinstance = constructor.Invoke(null);
    var result = Register<myinstance>();
} 
```

# visual-studio-2010 - 如何使用 Visual Basic 2010 交叉引用 Access 数据源中的表

> ID：12485422
> 
> 赞同：0
> 
> 时间：2012-09-18T21:34:32.460
> 
> 标签：visual-studio-2010, ms-access, vba, lookup, cross-reference

我对编程很陌生。我正在使用 Visual Basic 2010。我有一个名为 CoreDataSet 的 Access 数据源，它有三个表：Rates、Vendors、Zones。I have binded the Vendors table to two Combo boxes, when a Vendors' Name is selected the first three digits of their zip code appears in a label next to the corresponding combo box. 我想使用这两个标签（或两个 3 位邮政编码）并交叉引用“区域”表。zone 表的顶部有一个三位数的 zip 列表（列名）和第二列的三位数 zip，如下所示（示例）：

```
ID| ZIP | 020    |  021   | 022 ...
--+-----+--------+--------+-----------
1 | 020 | ZONE 1 | ZONE 2 | ZONE 3 ...
2 | 021 | ZONE 2 | ZONE 1 | ZONE 3 ...
3 | 022 | ZONE 3 | ZONE 2 | ZONE 1 ... 
```

因此，从邮政编码 022 到 021 的运输将是 ZONE 3，而从 022 到 022 的运输将是 Zone 1。目标是选择两个供应商（每个组合框中一个）并在标签 1 和 2 中显示它们的 3 位数拉链（完成) 以及标签 3 中适用于它们的 UPS 区域（未完成）。交叉引用甚至可能吗？请帮忙，谢谢。

我得到了一半的工作。我已经完成了一个查询（QueriesTableAdapter.query1），如下所示：

```
Select [020]
From Zones
Where (Zip = ?) 
```

我的VB代码是：

```
Private Sub Button2_Click(ByVal...blablabla)
    Dim BTR As CoreDataSetTableAdapters.QueriesTableAdapter
    BTR = New CoreDataSetTableAdapters.QueriesTableAdapter()
    Dim returnValue As String
    Dim zip1 As String
    zip1 = Val(Label2.text)
    returnValue - CTYPE(BTR.query1(zip1), String)
    Label3.Text = returnValue
End Sub 
```

这将选择从 020 shipping 到输入 label2 的任何 zip 的区域，并且工作正常。但是，我需要选择各种“发货人”，而不仅仅是 020...

```
Select [" + Label1 + "]
From Zones
Where (Zip = ?) 
```

不起作用。如何在 select 子句中使用参数或让它将 Label1 的值识别为要选择的列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T09:17:41.927

基本上你想要这样的查询：

```
SELECT zones.[020]
FROM zones
WHERE zones.[zip]="021" 
```

现在您所要做的就是针对用标签替换字段（列）和值的连接调整查询。

例如：

```
s= "SELECT zones.[" + Label1 + "] FROM zones WHERE zones.[zip]='" + Label2 + "'" 
```

如果 label2 可以编辑，则需要参数查询。

你的桌子设计有点奇怪。

# oracle - PL/SQL 模式名称与 Oracle 关键字相同

> ID：12485423
> 
> 赞同：1
> 
> 时间：2012-09-18T21:34:36.813
> 
> 标签：oracle, plsql

我知道这听起来很奇怪，但我需要执行一些 PL/SQL，其中包的所有者与 Oracle 保留字`IF`.

本质上，对象的所有者是`IF`。当我使用 SQL Developer 执行该过程时，生成的脚本会抛出错误，因为它试图将游标变量声明为：

```
 variable_name IF.MYCUSTOM_TYPE 
```

目前我无法控制架构，所以我无法更改任何内容。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T21:42:31.240

在架构名称周围使用双引号，例如

```
"IF".MYCUSTOM_TYPE 
```

# python - Postgresql Psycopg2

> ID：12485424
> 
> 赞同：1
> 
> 时间：2012-09-18T21:34:42.683
> 
> 标签：python, django, postgresql, psycopg2, django-database

我是一个总编程n00b，刚刚开始学习django。我已经能够使用 SQLite 完成工作，但我对 PostgreSQL 完全停滞不前……我已经浏览了 Stackoverflow 和其他地方几个小时，但一直找不到好的答案。

我的 settings.py 文件：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2',
        'NAME': 'mydb',
        'USER': 'user',
        'PASSWORD': 'passwd',
        'HOST': 'localhost',
        'PORT': '',
} 
```

}

在终端中运行命令：

```
$ python manage.py validate 
```

终端输出：

```
Traceback (most recent call last):
File "manage.py", line 10, in <module>
execute_from_command_line(sys.argv)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
utility.execute()
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
self.fetch_command(subcommand).run_from_argv(self.argv)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/base.py", line 196, in run_from_argv
self.execute(*args, **options.__dict__)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/base.py", line 232, in execute
output = self.handle(*args, **options)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/base.py", line 371, in handle
return self.handle_noargs(**options)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/commands/validate.py", line 9, in handle_noargs
self.validate(display_num_errors=True)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/base.py", line 266, in validate
num_errors = get_validation_errors(s, app)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/validation.py", line 23, in get_validation_errors
from django.db import models, connection
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/db/__init__.py", line 40, in <module>
backend = load_backend(connection.settings_dict['ENGINE'])
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/db/__init__.py", line 34, in __getattr__
return getattr(connections[DEFAULT_DB_ALIAS], item)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/db/utils.py", line 92, in __getitem__
backend = load_backend(db['ENGINE'])
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/db/utils.py", line 24, in load_backend
return import_module('.base', backend_name)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
__import__(name)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/db/backends/postgresql_psycopg2/base.py", line 13, in <module>
from django.db.backends.postgresql_psycopg2.creation import DatabaseCreation
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/db/backends/postgresql_psycopg2/creation.py", line 1, in <module>
import psycopg2.extensions
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/psycopg2/__init__.py", line 67, in <module>
from psycopg2._psycopg import BINARY, NUMBER, STRING, DATETIME, ROWID
ImportError: dlopen(/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/psycopg2/_psycopg.so, 2): Symbol not found: _PQbackendPID
Referenced from: /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/psycopg2/_psycopg.so
Expected in: dynamic lookup 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T21:12:53.337

默认情况下，psycopg2 不会在 OSX 上正确编译。

维护人员建议您尽可能使用 Fink 或 Macports 的版本（[http://initd.org/psycopg/install/](http://initd.org/psycopg/install/)）。

如果您想/需要从源代码安装，他们提供这些链接来解决常见问题：http: [//initd.org/psycopg/articles/2010/11/11/links-about-building-psycopg-mac-os -X/](http://initd.org/psycopg/articles/2010/11/11/links-about-building-psycopg-mac-os-x/)

IIRC，处理此问题的最佳方法是：

*   设置环境变量以确保它们在您执行 pip/easy_install 时选择正确的 pg_config 二进制文件（它包含您正在构建的 postgresql 客户端/服务器的所有配置信息），或者如果您手动在 setup.cfg 中手动记录它建造。

*   设置环境变量以明确为您的 osx 安装设置正确的 ARCHFLAGS。有时 python 会尝试在 32 位安装上构建 64 位，反之亦然。

*   新安装让人们遇到了 libssl 的问题，我从来没有遇到过这些

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-22T02:02:59.110

Reading the error, I dont think this is a case of psycopg2 not being installed but due to it not loading correctly. Something is wrong here.

I would make sure you have libpq installed (postgresql client libraries), plus the relevant header files. then I would remove psycopg2 and try to install again.

If that fails, make sure the header files are for the same version of libpq as you have installed. It sounds like you are having issues with expected symbol exports not being there, which suggests possible library versioning issues.

# c++ - 类数据成员不可访问

> ID：12485425
> 
> 赞同：3
> 
> 时间：2012-09-18T21:34:45.363
> 
> 标签：c++, visual-studio-2010, class, compiler-errors, syntax-error

我这辈子都想不通。

```
int Warrior :: attack ()
{
  int hit;
  srand(time(0));

if (Warrior.weapon == 6)
    int hit = rand() % 5 + 1;
else if (Warrior.weapon == 7)
    int hit = rand() % 7 + 4;
else if (Warrior.weapon == 8)
    int hit = rand() % 7 + 9;
else if (Warrior.weapon == 9)
    int hit = rand() % 7 + 14;
else if (Warrior.weapon == 10)
    int hit = rand() % 7 + 19;

std::cout<< "You hit " << hit <<"!\n";

return hit;
} 
```

我收到此错误：（`Error C2059: syntax error : '.'` 我也知道我应该使用`switch`语句而不是`else if`）

谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-18T21:37:08.580

`Warrior`是类的名称。如果您在成员函数内部，则不需要使用类的名称来限定数据成员。您还应该`hit`在 if-then-else 链之前声明：

```
int hit;
if (weapon == 6)
    hit = rand() % 5 + 1;
else if (weapon == 7)
    hit = rand() % 7 + 4;
else if (weapon == 8)
    hit = rand() % 7 + 9;
else if (weapon == 9)
    hit = rand() % 7 + 14;
else if (weapon == 10)
    hit = rand() % 7 + 19; 
```

您可能会更好地使用一个`switch`语句，甚至是一组 for`%`和`+`values 对。

```
int mod[] = {0,0,0,0,0,0,5,7,7,7,7};
int add[] = {0,0,0,0,0,0,1,4,9,14,19};
int hit = rand() % mod[weapon] + add[weapon]; 
```

在上面的数组中，当`weapon`is 时，比如 8，`mod[weapon]`is`7`和`add[weapon]`is与语句`9`中的数据相匹配。`if`

# windows - 如何读/写 Windows 7 库位置？

> ID：12485427
> 
> 赞同：7
> 
> 时间：2012-09-18T21:34:52.793
> 
> 标签：windows, delphi, registry

**介绍**

在 Windows 7 中，您有一些用于文档、图片和音乐等的特殊文件夹，称为库。

如果您不知道它们，基本上每个库文件夹都可以包含位置（路径），这些位置（路径）基本上是每个库的快捷方式。

**一些例子：**

`Documents (Library)`

*   E:\个人\文档`(Location)`
*   F:\备份\文档`(Location)`

`Music (Library)`

*   E:\媒体\音乐\专辑`(Location)`
*   E:\媒体\音乐\单曲`(Location)`

`Pictures (Library)`

*   E:\媒体\照片`(Location)`

当您从 Windows 资源管理器或开始菜单单击任何这些库文件夹时，Windows 资源管理器将显示该库中定义的位置。

**任务**

我需要做的是读取每种图书馆类型的位置，并能够用我自己的位置写回（更新）图书馆。我发现库存储在用户 AppData 文件夹中，如下所示：

`C:\Users\SOMEUSER\AppData\Roaming\Microsoft\Windows\Libraries`

这些库是这种文件类型：**库 (.library-ms)** - 如果您右键单击一个并选择属性，库选项卡您可以看到与该库关联的库位置。

我没有看到提取这些并将它们放入 TStringList 以在 Delphi 中进行编辑的方法。我想知道这些库位置是否真的存储在 Windows 注册表中，所以通过谷歌的一些研究，我发现了这些路径：

*   HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell 文件夹
*   HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell 文件夹

但同样，我没有看到图书馆位置的实际列表。

那么，如何在 Delphi 中读取库文件中的位置列表，将它们添加到列表框或 TStringList，编辑条目然后写回更改？刚刚能够提取库位置路径将是一个开始。

我只是觉得这将是那些有一个我似乎找不到的简单答案的问题之一！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T22:06:39.007

使用其中一个`SHLoadLibraryFrom...()`函数，如`SHLoadLibraryFromKnownFolder()`，获取`IShellLibrary`接口，然后您可以使用它的方法来枚举和操作库，如`IShellLibrary::GetFolders()`、`IShellLibrary::AddFolder()`、`IShellLibrary::RemoveFolder()`等。

**更新：**例如：

```
uses
  ..., ActiveX, KnownFolders, ShlObj;

// The SHLoadLibraryFrom...() functions are implemented inline in the Win32 SDK
// shobjidl.h header file, so you have to implement them manually in your 
// code if you you are not using a version of Delphi that already implements
// them in the RTL's ShlObj.pas unit for you...

// SHLoadLibraryFromKnownFolder() is defined wrong in ShlObj.pas!!! See QC #109306
function My_SHLoadLibraryFromKnownFolder(const kfidLibrary: TGUID; grfMode: DWORD; riid: TIID; out ppv): HRESULT;
var
  plib: IShellLibrary;
begin
  Result := CoCreateInstance(CLSID_ShellLibrary, nil, CLSCTX_INPROC_SERVER, IShellLibrary, plib);
  if SUCCEEDED(Result) then
  begin
    Result := plib.LoadLibraryFromKnownFolder(kfidLibrary, grfMode);
    if SUCCEEDED(Result) then
      Result := plib.QueryInterface(riid, ppv);
  end;
end;

function GetLibraryFileSystemFolders(FolderID: TGUID; Folders: TStrings): Boolean;
var
  SL: IShellLibrary;
  Arr: IShellItemArray;
  Enum: IEnumShellItems;
  Item: IShellItem;
  Path: LPWSTR;
begin
  Result := False;

  if FAILED(My_SHLoadLibraryFromKnownFolder(FolderID, STGM_READ, IShellLibrary, SL)) then
    Exit;

  if FAILED(SL.GetFolders(LFF_FORCEFILESYSTEM, IShellItemArray, Arr)) then
    Exit;

  if FAILED(Arr.EnumItems(Enum)) then
    Exit;

  while Enum.Next(1, Item, nil) = S_OK then
  begin
    if FAILED(Item.GetDisplayName(SIGDN_FILESYSPATH, Path)) then
      Exit;
    try
      Folders.Add(Path);
    finally
      CoTaskMemFree(Path); 
    end;
    Item := nil;
  end;

  Result := True;
end; 
```

.

```
var
  Folders: TStringList;
begin
  Folders := TStringList.Create;
  try
    if GetLibraryFileSystemFolders(FOLDERID_DocumentsLibrary, Folders) then
    begin
      //...
    end;
  finally
    Folders.Free;
  end;
end; 
```

**更新**：`SHLoadLibraryFromKnownFolder()`仅适用于已`KNOWNFOLDERID`定义值的 Microsoft 定义的库。如果要访问自定义库，则必须使用稍微修改的方法来获取`IShellLibrary`接口，例如：

```
// SHLoadLibraryFromItem() is defined wrong in ShlObj.pas!!! See QC #109306
function My_SHLoadLibraryFromItem(const psiLibrary: IShellItem; grfMode: DWORD; const riid: TIID; out ppv): HResult;
var
  plib: IShellLibrary;
begin
  Result := CoCreateInstance(CLSID_ShellLibrary, nil, CLSCTX_INPROC_SERVER, IID_IShellLibrary, plib);
  if Succeeded(Result) then
  begin
    Result := plib.LoadLibraryFromItem(psiLibrary, grfMode);
    if Succeeded(Result) then
      Result := plib.QueryInterface(riid, ppv);
  end;
end;

function GetShellLibraryforLibrary(const LibraryName: String; grfMode: DWORD; var ppv: IShellLibrary): Boolean;
var
  SL: IShellLibrary;
  Enum: IEnumShellItems;
  Item: IShellItem;
  DisplayName: LPWSTR;
  hr: HRESULT;
begin
  Result := False;
  ppv := nil;

  if FAILED(SHGetKnownFolderItem(FOLDERID_Libraries, 0, 0, IShellItem, PPointer(@Item)^) then
    Exit;

  hr := Item.BindToHandler(nil, BHID_EnumItems, IEnumShellItems, Enum);
  if FAILED(hr) then
    Exit;

  Item := nil;
  while Enum.Next(1, Item, nil) = S_OK do
  begin
    if FAILED(Item.GetDisplayName(SIGDN_NORMALDISPLAY, DisplayName)) then
      Exit;
    try
      if AnsiSameText(DisplayName, LibraryName) then
      begin
        Result := SUCCEEDED(My_SHLoadLibraryFromItem(Item, grfMode, IShellLibrary, ppv));
        Break;
      end;
    finally
      CoTaskMemFree(DisplayName);
    end;
    Item := nil;
  end;
end;

function GetLibraryFileSystemFolders(const LibraryName: String; Folders: TStrings): Boolean;
var
  SL: IShellLibrary;
  Arr: IShellItemArray;
  Enum: IEnumShellItems;
  Item: IShellItem;
  Path: LPWSTR;
begin
  Result := False;

  if not GetShellLibraryforLibrary(LibraryName, STGM_READ, SL) then
    Exit;

  if FAILED(SL.GetFolders(LFF_FORCEFILESYSTEM, IShellItemArray, Arr)) then
    Exit;

  if FAILED(Arr.EnumItems(Enum)) then
    Exit;

  while Enum.Next(1, Item, nil) = S_OK then
  begin
    if FAILED(Item.GetDisplayName(SIGDN_FILESYSPATH, Path)) then
      Exit;
    try
      Folders.Add(Path);
    finally
      CoTaskMemFree(Path); 
    end;
    Item := nil;
  end;

  Result := True;
end; 
```

.

```
var
  Folders: TStringList;
begin
  Folders := TStringList.Create;
  try
    if GetLibraryFileSystemFolders('MyLibrary', Folders) then
    begin
      //...
    end;
  finally
    Folders.Free;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T11:28:13.410

我刚刚在 Marco Cantu 的源代码存储库中找到了他的 Mastering Delphi 书籍，这是 Delphi 2010 的一个示例，它显示了一种获取图书馆内位置的方法。

存储库的链接在这里： [http ://code.marcocantu.com/p/marcodelphibooks/source/tree/HEAD/](http://code.marcocantu.com/p/marcodelphibooks/source/tree/HEAD/)

在里面`delphi2010handbook`，`chapter 05 (Win7Libraries)`是示例源。

该演示中使用的方法基本上是使用已经提到的Windows API，该演示确认库文件确实是XML格式。

* * *

此外，我发现以下信息非常有用：

*   **SHAddFolderPathToLibrary** - 将文件夹添加到库中。
*   **SHCreateLibrary IShellLibrary** - 创建一个对象。
*   **SHLoadLibraryFromItem** - 创建 IShellLibrary 并将其加载到指定库定义文件中的对象。
*   **SHLoadLibraryFromKnownFolder** - 为指定的 KNOWNFOLDERID 创建和加载 IShellLibrary 对象。
*   **SHLoadLibraryFromParsingName** - 为指定路径创建和加载 IShellLibrary 对象。
*   **SHRemoveFolderPathFromLibrary** - 从库中删除文件夹。
*   **SHResolveFolderPathInLibrary** - 尝试解析已移动或重命名的库文件夹的目标位置。
*   **SHResolveLibrary** - 尝试查找库的位置。
*   **SHSaveLibraryInFolderPath** - 将 IShellLibrary 对象保存到磁盘。
*   **SHShowManageLibraryUI** - 显示库管理对话框，使用户能够管理库文件夹和默认保存位置。

# servlets - Java HTTPServlet 与独立应用程序 + 一些 OutOfMemory 乐趣

> ID：12485429
> 
> 赞同：0
> 
> 时间：2012-09-18T21:34:55.493
> 
> 标签：servlets, out-of-memory, futuretask

我有一个使用 Java 5 从文件系统加载多个序列化对象的函数`FutureTask`。我的电脑内存应该不是问题。

如果我在 main 方法中调用该函数，一切正常，但如果我从`init()`a 或 a`static block`中调用该函数，`HTTPServlet`我会得到各种`OutOfMemoryException`（通常是 Java 堆空间）......

有谁知道为什么通过使用 Servlet 我最终会遇到这个问题？FutureTasks 和 Servlet 可以以任何方式发生冲突吗？我可以做些什么来理解/解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:39:15.517

那么您的计算机内存和您的 JVM 内存可能是非常不同的东西（开箱即用的 JVM 仅分配 64Mb 的 RAM（取决于 JVM）。但是，如果没有一些具体的代码或示例数据大小，很难确切知道问题出在哪里在你的情况下 [。HTTPServlet](http://docs.oracle.com/javaee/1.3/api/javax/servlet/http/HttpServlet.html)没有被标记为非线程安全的。你能提供任何代码来说明你的问题吗？

# javascript - jQuery选择器帮助获取几组的最后一个元素？

> ID：12485430
> 
> 赞同：3
> 
> 时间：2012-09-18T21:35:01.743
> 
> 标签：javascript, jquery, jquery-selectors

我有这种类型的 html

```
<div id='foo'>
  <ol>
   <li>
      <a/>
      <a/>
      <ol><li><a/><a/><a/></li></ol>
   </li>
   <li>
      <a/>
      <a/>
      <ol><li><a/><a/><a/></li></ol>
   </li>
   <li>
      <a/>
      <a/>
      <ol><li><a/><a/><a/></li></ol>
   </li>
  </ol>
</div> 
```

如何在每个第一级“li”中只选择最后一个“a”标签？我尝试使用 :last 但我只得到最后一个'a'。请注意，我不希望嵌套在嵌套 'ol' 中的 'a' 元素。IE 选择器应该产生 3 个“a”标签。任何提示或示例都会很棒！谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:55:35.923

`$('#foo > ol > li > a:last-of-type');`

您还必须在 li 和 a 之间使用子选择器，否则它将返回所有作为最后一个子元素的 a 元素。

jsFiddle 示例：http: [//jsfiddle.net/48uQM/3/](http://jsfiddle.net/48uQM/3/)

更新了我的答案以使用红色背景颜色，以便更容易看到。

正如评论中提到的，这在 IE8 或更早版本或任何不支持 :last-of-type 的浏览器中都不起作用

**在 IE8 和旧版浏览器中工作是另一种解决方案**

[http://jsfiddle.net/zcH8D/](http://jsfiddle.net/zcH8D/)

```
$(document).ready(function() {
    $li = $('#foo > ol > li');
    $li.each(function () {
      $a = $(this).find(">a");
      $a.filter(":last").addClass('last');                
    });        
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T21:51:19.490

检查这个：

```
$("div ol li ol").prev().css('background-color', 'red'); 
```

[jsFiddle](http://jsfiddle.net/P4vYq/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T21:37:40.870

```
$('#foo > ol > li > a').filter(function(){
    return !$(this).next('a').length
}) 
```

[http://jsfiddle.net/mBwug/](http://jsfiddle.net/mBwug/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T21:37:45.533

```
jQuery('#foo>ol>li a:last-child'); 
```

将为您提供第一级 li 元素中的最后一个标签

等等

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-18T21:39:07.990

尝试这个

```
​//console.log($('ol li ol li a:last'))

var lists = $('ol li ol li'); 
$.each(lists, function(i){
    console.log($(this).find('a:last'))
});
​ 
```

没有循环你可以试试这个

```
 console.log($('ol li ol li > a:last-child');) 
```

[小提琴没有循环](http://jsfiddle.net/sushanth009/JUtb7/2/)

[小提琴](http://jsfiddle.net/sushanth009/JUtb7/)

# spring - 并发 BeanFactory？它存在吗？

> ID：12485433
> 
> 赞同：0
> 
> 时间：2012-09-18T21:35:24.380
> 
> 标签：spring, concurrency, javabeans, factory-pattern

是否有一个 BeanFactory 实现同时加载和缓存每个 bean？

在一个完美的场景中，我希望每个 bean 在不同的线程中运行。现在有可能吗？还是我需要为此编写自己的实现？

场景：每个 bean 都分配了一个消息队列通道，并且正在异步通信。在默认实现中，所有 bean 都在同一个线程中。这意味着如果我有 50 个 bean，每个 bean 每秒收到 10 条消息，很快就会处理大量消息，我将在处理这些消息时有延迟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:40:13.060

我认为解决方案是使用`ConcurrentMapCacheFactoryBean`

[http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/cache/concurrent/ConcurrentMapCacheFactoryBean.html](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/cache/concurrent/ConcurrentMapCacheFactoryBean.html)

例如。

```
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:cache="http://www.springframework.org/schema/cache"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
      http://www.springframework.org/schema/cache http://www.springframework.org/schema/cache/spring-cache.xsd">

    <cache:annotation-driven/>

    <bean id="cacheManager" class="org.springframework.cache.support.SimpleCacheManager">
        <property name="caches">
            <set>
                <bean class="org.springframework.cache.concurrent.ConcurrentMapCacheFactoryBean" p:name="default"/>
            </set>
        </property>
    </bean>
</beans> 
```

有关如何使用查看的一些示例：

*   [Spring 3.1.1 和缓存配置问题](https://stackoverflow.com/questions/10978731/spring-3-1-1-and-cache-configuration-issue)
*   [http://www.silviowangler.ch/tag/spring/](http://www.silviowangler.ch/tag/spring/)
*   [http://static.springsource.org/spring/docs/current/spring-framework-reference/html/cache.html](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/cache.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T12:35:01.093

今天我研究了 Spring Integration，发现它有点适合这个场景。我可以使用 ExecutorChannel 一次处理不同线程中的消息。实际上我可以很容易地使用 BlockingQueue 本身来实现这个场景。总之，谢谢关注！

顺便说一句，如果有人有兴趣，这就是我想出的：

```
Scenario for an individual Bean:
Allocate a blocking queue

Spawn a background thread which:
    Blocks until message is available in the MQ channel
    When message is available:
        Put a message inside a blocking queue and block until queue is not full
    Repeat the sequence

Spawn a background thread which:
    Blocks until queue is not empty
    Processes a message when it's available in the queue
    Removes a message from the queue indicating that processing is done
    Repeat the sequence 
```

# java - Java 中的可缩放图像

> ID：12485435
> 
> 赞同：1
> 
> 时间：2012-09-18T21:35:44.847
> 
> 标签：java, jpanel, bufferedimage

我预计在我的 Java 应用程序中使用一些图像。这些图像将使用`g.drawImage()`. JPanel 是可调整大小的，并且图像应该随着 JPanel 大小的增加/减小而缩放

两个问题：

1.  哪种图像格式最适合这种所需的可缩放图像？例如，在这个应用程序中，100x100 大小的图像可以缩放为 30x30 或 10x10 或 300x300 大小的图像。
2.  如何编写代码来进行这种缩放？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:40:02.280

1.  没关系，我不认为。（如果您希望图像在放大时不会变得模糊，请查看矢量图）。

2.  您可能希望在窗口调整大小时调用的侦听器中使用[Image.getScaledImage(int, int, int) 。](http://docs.oracle.com/javase/6/docs/api/java/awt/Image.html#getScaledInstance%28int,%20int,%20int%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T23:13:50.713

看看[Java：保持JPanel背景图片的纵横比](https://stackoverflow.com/questions/11959758/java-maintaining-aspect-ratio-of-jpanel-background-image/11959928#11959928)

我还阅读[了 Image.getScaledInstance() 的风险，](http://today.java.net/pub/a/today/2007/04/03/perils-of-image-getscaledinstance.html)还看了一下[java-image-scaling](http://code.google.com/p/java-image-scaling/)（我个人没有使用过它，但我听说过它的好消息）。

至于图片格式。我怀疑它真的会产生很大的不同，质量将取决于原始图像的质量。尝试使用大图像并将其缩小，而不是尝试放大小图像。

# html - 如何正确浮动跨度

> ID：12485440
> 
> 赞同：0
> 
> 时间：2012-09-18T21:36:03.057
> 
> 标签：html, css

我正在开发这个网站[http://indigonightlife.com/](http://indigonightlife.com/)第二部分是本周活动。该标题的右侧是 5 条蓝色小线的图像。我遇到的问题是我不能让它漂浮到容器的右侧。就像现在一样，它位于容器的中间。我尝试了各种浮动、clearfixes 等的组合，但我无法让它保持在正确的位置。下面标题为 Resident 和 Guest DJs 的部分具有相同的图像，但浮动很好。不知道有什么区别。

任何帮助，将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T21:49:03.417

从#homewidgets 中删除“高度：460px”。

该框是图像未向右浮动的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:49:26.107

您的“homewidgets” div 溢出并阻止图像一直向右浮动。在 style.css 第 245 行删除 height 属性：

```
#homewidgets {
    float: right;
    height: 460px;
    width: 307px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:51:39.490

尝试

```
.heading {
font-family: neuro;
font-size: 37px;
color: white;
width: 800px;
display: inline-block;
vertical-align: top;
}

.bluestripes{display: inline-block;
width: 132px;
} 
```

# c++ - 使用 Boost.Build 和 C++ 管理库依赖项

> ID：12485441
> 
> 赞同：2
> 
> 时间：2012-09-18T21:36:03.853
> 
> 标签：c++, boost, build, makefile, boost-build

我想开发一个可以在许多不同平台上构建的项目。项目代码将使用 C++，管理库的最佳方式是什么？

我计划使用 bjam 作为构建系统，因为我也将依赖 Boost 及其单元测试框架。

这两个依赖项是 Boost 本身和 FLTK。

图书馆管理想到的可能性是：

1.  在树中包含所有受支持平台的构建工件（二进制文件）和标头
2.  在树中包含所有库依赖项的完整源代码，并以某种方式将它们编写为依赖项
3.  1 和 2 的组合，就像 node.js 与 v8 一样
4.  通知用户他们需要自己构建库，然后将它们放在 PATH 或某个特殊目录中，就像 libcurl 对其依赖项所做的那样
5.  依赖 *nix 构建工具（即 libtool）mozilla 风格，然后告诉用户他们必须使用 MSYS 在 windows 上构建

这里最好的方法是什么？在接下来的六个月里，这个项目可能不会超过几千行，但我想在这里做出**正确**的选择，这样我以后就不必再回来换所有的东西了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T01:46:37.020

这是一个主观的答案。

首先，关于 Boost：一旦构建了 Boost，无论以何种方式，您都不需要使用 bjam。因此，您可以使用任何适合您的构建系统，同时要求某些库位于系统上或某些路径中，无论它们是如何构建的。附带说明一下，boost 的大部分内容都是仅标头（即使是单元测试框架也可以使用仅标头 IIRC，但建议使用库版本）。假设您需要 boost 二进制文件。

处理项目 IMO 的最佳方法是使用您自己选择的最适合您自己项目的构建系统，并要求“预构建”依赖项（增强）。它们的预构建方式取决于每个依赖项；有些人可能使用您选择的相同构建系统，其他人将使用他们自己的构建系统。有些将适用于所有平台，例如，有些将在 windows 上编译，但没有适合 windows 的最佳构建系统。如果它们是小型库，您可以将它们集成到您的构建系统中，否则只需将它们视为开发人员在构建项目之前“以某种方式”必须拥有的“依赖项”。这里的“不知何故”将在自述文件中进行解释。

例如，我在我的项目中使用 cmake，但在我的项目中使用 boost 和其他一些库。cmake 允许我为 MSVC、C::B、GNUMake 等生成项目文件，但是我不能希望我的所有依赖项也使用 cmake。对于非常小的、稳定的库，我可以为它们制作一个 cmake 项目，然后事情就变得非常简单。对于更大或更易变的库，最好将每个库留给自己的构建系统。易失性库经常更改，因此如果您为它们构建任何“自定义”内容，您将不得不不断调整您的“自定义”以适应库中的更改。对于我使用的每个库，我都有一些 cmake 变量，例如 BOOST_LIB_INCLUDE_PATHS 和 BOOST_LIB_LIBRARY_PATHS 和 BOOST_LIB_LIBRARIES，可以由编译我的项目的开发人员将其定义为它们的值。

您可以自行决定是否向这些库提供源代码；这没什么错，尤其是在您想要依赖特定版本的库的情况下。但是除了对易失性库的维护之外，将它们编写为依赖项可能会变得一团糟。

但是，我知道当 Google Chromium 项目构建时，会下载、签出、构建和链接大约一百个库。Chromium 使用 GYP 作为构建系统 IIRC。

# tsql - 如何通过尝试插入变量表的变量（动态 sql）执行 sql 语句？

> ID：12485445
> 
> 赞同：0
> 
> 时间：2012-09-18T21:36:11.650
> 
> 标签：tsql, variables, temp-tables

> **可能重复：**
> [如何在动态 sql 语句中使用表变量？](https://stackoverflow.com/questions/4626292/how-to-use-table-variable-in-a-dynamic-sql-statement)

如果我用 TEMPORARY TABLE 做我想做的事，它可以正常工作：

```
DECLARE @CTRFR VARCHAR(MAX)

SET @CTRFR = 'select blah blah blah' -- <-- very long select statement. this returns a 0 or some greater number. Please note! --> I NEED THIS NUMBER.

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo][#CTRFRResult]') AND type IN (N'U') ) 
   DROP TABLE [dbo].[#CTRFRResult]

CREATE TABLE #CTRFRResult
(
  CTRFRResult VARCHAR(MAX)
)

SET @CTRFR = 'insert into #CTRFRResult ' + @CTRFR
EXEC(@CTRFR) 
```

以上工作正常。

问题是几个数据库正在使用同一个 TEMP 表。因此我需要使用 VARIABLE 表（而不是临时表）。

我在下面的内容不起作用，因为它说必须声明该表。

```
DECLARE @CTRFRResult TABLE
(
   CTRFRResult VARCHAR(MAX)
)

SET @CTRFR = 'insert into @CTRFRResult ' + @CTRFR -- I think the issue is here.
EXEC(@CTRFR) 
```

设置`@CTRFR`为`insert into...`不起作用，因为我假设表名超出范围。我将如何使用变量表来模仿临时表代码？

我收到的错误消息是：

> *必须声明表变量“@CTRFRResult”*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:40:40.543

您不能像这样使用带有动态 SQL 的 @ 表，您还必须在动态 sql 语句中创建表。

但我不认为你真的有使用 # 表的问题。

# 表将仅对当前会话可用 - 您可以拥有 100 个会话，每个会话都可以毫无问题地创建自己的版本。

如果要创建其他会话可以访问的临时表，则需要改用##。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:40:51.267

您不能像这样插入表变量，因为`exec`在它自己的范围内运行。

来自 Erland Sommarskog 的[动态 SQL 的诅咒和祝福](http://www.sommarskog.se/dynamic_sql.html)：

> 接下来要注意的是动态 SQL 不是存储过程的一部分，而是构成了它自己的范围。调用动态 SQL 块类似于调用临时创建的无名存储过程。这有很多后果：
> 
> 在动态 SQL 块内，不能访问局部变量（包括表变量）或调用存储过程的参数。但是，如果使用 sp_executesql，则可以将参数（输入和输出）传递给动态 SQL 块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T22:00:42.720

虽然您无法将表变量作为参数发送到动态 sql 或其他存储过程，但您可能仍会在特定情况下使用它。代替

```
SET @CTRFR = 'insert into @CTRFRResult ' + @CTRFR -- I think the issue is here.
EXEC(@CTRFR) 
```

你可能会说：

```
insert into @CTRFRResult
  exec sp_executesql @CTRFR 
```

# shell - 如何覆盖默认的 init.tcl

> ID：12485447
> 
> 赞同：1
> 
> 时间：2012-09-18T21:36:25.397
> 
> 标签：shell, tcl

我正在做一个项目，我想使用 TCL 作为命令解释器。我有一个工作的 c 库对象，我可以从 tcl shell 中加载它，但我的问题是找到一种在启动 tclsh 时自动执行此操作的方法。

本质上，我的最终目标是能够运行脚本并让它加载我的库并运行一些初始启动 tcl 代码，然后以交互模式将我拉回 tclsh 命令提示符。

例如

```
tclsh -f myscript.tcl --then-switch-to-interactive 
```

或者

```
EXPORT TCLINIT=myscript.tcl 
tclsh 
```

基本目标是避免分发 tclsh 而是依赖于本地用户安装的 tcl。我想要分发的只是我的库、一个启动脚本和一个 shell 命令，用于启动预加载库的 tclsh。

我试过使用环境变量`TCLINIT`，`TCL_LIBRARY`但它们似乎没有效果。

到目前为止，我发现的唯一可行的解​​决方案是将“source myscript.tcl”添加`/usr/share/tcltk/tcl8.5.init.tcl`到`~/.tclshrc`

然而，这两个“解决方案”都不是完美的，因为它们需要修改默认用户工作区。

让我感到震惊的是，在 TCL 中必须有一种方法来处理这个问题，但我的研究到目前为止还没有产生任何结果。

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T08:55:31.697

Tcl 不提供任何替换的能力`init.tcl`；*它用于在用户或库*代码应该运行之前设置语言的一部分。唯一一次调整它是在打包系统中`tclkit`（它在那里做了额外的工作来初始化内部虚拟文件系统）。

我也不建议依靠用户来编辑他们的`~/.tclshrc`，因为那是*他们*的，而不是你的。在非交互式运行时它也永远不会被获取（嗯，除非你添加代码来实际阅读它）。

相反，我建议您考虑：

*   将库作为 Tcl 包分发/安装，因此需要它的代码可以执行以下操作：

    ```
    package require itsname 
    ```

    像那样，想要它的代码可以只声明事实，而不需要它的代码则不受影响。

*   使用充当交互式外壳的脚本分发/安装您的库。[TclX 包](http://sourceforge.net/projects/tclx)中的[`commandloop`](http://wiki.tcl.tk/1968)命令在这里可能会有所帮助，但该 Wiki 页面也有您自己的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T14:28:54.760

在 myscript.tcl 中：

```
package require Tclx
# Your script
commandloop; # Start interactive session
# other commands 
```

该`commandloop`命令将创建一个交互式命令循环。此时，如果用户键入`exit`，则脚本将退出而不执行该`commandloop`行后面的其他命令。另一方面，如果用户键入 Crtl+D 或 Ctrl+Z 退出`commandloop`，其他命令将被执行。

参考`commandloop`：[http ://wiki.tcl.tk/1968](http://wiki.tcl.tk/1968)

### 自定义提示

如果您不喜欢默认提示，请创建一个`proc`以返回自定义提示并将其传递给`commandloop`：

```
proc customPrompt {} { return "tcl> " }
commandloop -prompt1 customPrompt 
```

# android - CursorLoader，获取本地数据库的 URI

> ID：12485448
> 
> 赞同：14
> 
> 时间：2012-09-18T21:36:26.690
> 
> 标签：android, sqlite, uri, android-cursorloader

我是一名新手 android 程序员，我最近关注了一个教程，该教程展示了如何创建本地 SQLite 数据库，然后使用 SQLiteDatabase.rawQuery 访问数据库以返回光标。我想修改我的应用程序以使用 CursorLoader 这显然是访问数据库的更好方法。我的问题是 CursorLoader 构造函数需要一个 URI。我只输入“file:///[db 路径]”吗？好像有点乱

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T21:49:39.687

游标加载器接受 URI 的原因是它希望查询 contentProvider 而不是原始数据库。

所以我建议你创建一个在内部使用你的数据库的内容提供者，这样你就可以直接使用 CursorLoader 类。

使用内容提供者的优势在于它可以更好地封装您的数据，并且您可以轻松地直接利用来自 android 的大量 api。

以下是有关如何创建内容提供者的一些指南

[http://developer.android.com/guide/topics/providers/content-provider-creating.html](http://developer.android.com/guide/topics/providers/content-provider-creating.html)

[http://thinkandroid.wordpress.com/2010/01/13/writing-your-own-contentprovider/](http://thinkandroid.wordpress.com/2010/01/13/writing-your-own-contentprovider/)

如果您选择不创建 ContentProvider，您可以直接扩展[AsyncTaskLoader](http://developer.android.com/reference/android/content/AsyncTaskLoader.html)或游标加载器以按照您想要的方式查询数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T21:52:59.160

看看 CommonsWare 的[LoaderEx](https://github.com/commonsguy/cwac-loaderex#readme)库。它允许您将 a`Loader`与本地一起使用`SQLiteDatabase`，因此您不必费心创建自己的`ContentProvider`.

# testing - 如何找到未分配（但可分配）的 IP 地址以用于测试目的？

> ID：12485452
> 
> 赞同：0
> 
> 时间：2012-09-18T21:36:53.787
> 
> 标签：testing, ip-address, asp.net-web-api

我正在测试各种以 IP 号码作为参数的免费/公共网络 API。

我想看看他们在各种错误条件下返回什么样的结果。

如何找到尚未使用/分配/出售的常规 IP 地址？

我知道有一些特殊的**保留**IP 范围永远无法分配，但我想专门针对**可分配空间**中 IP 地址的情况进行测试，因为其中一些 Web API 可能有不同的代码来处理这些情况并返回不同形式的结果.

* * *

**例子：**

`freegeoip.net`保留 IP 的响应[`http://freegeoip.net/json/192.168.1.2`](http://freegeoip.net/json/192.168.1.2)

```
{"city": "", "region_code": "", "region_name": "", "metrocode": "", "zipcode": "", "longitude": "0", "latitude": "0", "country_code": "RD", "ip": "192.168.1.2", "country_name": "Reserved"} 
```

但是对于不在其数据库等中的 IP 号码，它会返回什么？

我想要一种方法来查找用于测试任何此类 Web API 的 IP 地址，而不仅仅是`freegeoip.net`.

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2017-09-26T13:37:32.073

这是一个 IP 地址，编码为“意大利”，没有城镇或地区。5.90.235.59 , , Italy IP 地址有效。

# java - Junit @BeforeClass 和 @AfterClass 在多个测试用例的情况下的行为

> ID：12485457
> 
> 赞同：3
> 
> 时间：2012-09-18T21:37:25.007
> 
> 标签：java, junit

伙计们，

假设我有一个定期运行的复杂的子类测试套件。作为其中的一部分，我试图确保每个测试类一个接一个地严格执行，并且在's完成之前不会启动' `Test2`s方法。这是一个有效的假设吗？`@BeforeClass``Test1``@AfterClass`

示例场景：

类`TestBase`有一个`@BeforeClass`和一个`@AfterClass`方法。

类`T1`派生自`TestBase`.

类`T2`派生自`TestBase。

我们从 Ant / Eclipse 一起运行`T1`和运行。`T2`有一些来自 TestBase 的常见静态对象在`T1`and之间重用`T2`，这意味着我必须完全确定这些对象`AfterClass`在下一轮`BeforeClass`开始初始化之前完全销毁。我可以通过上面概述的基本用法确定这一点吗？

我强烈怀疑这不会发生，但简单的测试并不能证明是一样的。文档也没有谈论这个。所以我想确保我不会试图解决一个可以通过其他方式解决的系统性问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T06:38:39.437

排除并行执行，JUnit 应该总是在之后运行一个测试类，即 T1 在 T2 之前（或相反），所以你的场景应该可以工作。

要注意的另一件事是运行测试的顺序，这可能会混淆问题。请参阅我对[Has JUnit4 是否开始支持测试排序的回答？是故意的吗？](https://stackoverflow.com/questions/7845929/has-junit4-begun-supporting-ordering-of-test-is-it-intentional/7846712#7846712)，这解释了为什么测试可能以不同的顺序执行。

我认为您最好的解决方案是使用[ClassRule](http://kentbeck.github.com/junit/javadoc/latest/org/junit/ClassRule.html)。这允许您定义一个实现您的`AfterClass`&`BeforeClass`行为的类。例如：

```
public class UsesExternalResource {
  public static Server myServer= new Server();

  @ClassRule
  public static ExternalResource resource= new ExternalResource() {
    @Override
    protected void before() throws Throwable {
      myServer.connect();
    };

    @Override
    protected void after() {
      myServer.disconnect();
    };
  };
} 
```

使用它可以消除对静态变量的需要，因为您可以在 中进行所有设置`ClassRule`，所有内容都可以是其中的实例变量。您也许可以`TestBase`完全删除父类。

# r - 当另一列中的值为 X 时查找一列的最大值

> ID：12485458
> 
> 赞同：3
> 
> 时间：2012-09-18T21:37:25.113
> 
> 标签：r, max

当 C 列 = X 的值时，如何找到一列（B 列）的最大值。我如何保留 A 列的标签。假设我的数据称为 my.data，a 列 = 国家名称，列b = 出生的孩子数，C 栏 = 孩子出生的年份。那么如何找到 2001 年出生的孩子的最大数量，同时保持国家名称一致呢？

谢谢，非常抱歉，我是 R 新手

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T23:29:19.477

R中有很多选项（以及关于SO的问题）可以进行这种操作

我会给出一个`data.table`解决方案，因为我喜欢这种查询的简单语法

# 数据表

提高大型数据集的效率。我还提供了一个非常简单的子集语法。（.SD 引用由`i`and创建的子集`by`）

```
library(data.table)
DT <- data.table(my.data)
DT[year==2001, .SD[which.max(births)]] 
```

或者这是相同的，不需要 .SD

```
DT[year==2001][which.max(births)] 
```

# 示例数据

```
my.data <- expand.grid(
  Country = c('Swaziland', 'Australia', 'Tuvalu', 'Turkmenistan'),
  year = 1990:2012 )
my.data$births <- rpois(nrow(my.data), lambda = 500)
DT <- data.table(my.data)
DT[year==2001, .SD[which.max(births)]]

##      Country year births
## 1: Swaziland 2001    501 
```

# 使用基础 R

```
births_2001 <- subset(my.data, year == 2001)
births_2001[which.max(births_2001$births),]

##      Country year births
## 45 Swaziland 2001    501 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-18T23:36:28.130

有很多方法可以做到这一点。我会分解它，以便您希望看到发生了什么更好的事情。

```
 my.data <- data.frame(
    country=c("Australia","France","Germany","Honduras","Nepal","Honduras"),
    children=c(120000,354000,380000,540000,370000,670000),
    year=c(2000,2001,2001,2002,2001,2003)
    )

 myd01 <- my.data[my.data$year==2001,]  # pulls out the 2001 data
 myd01[myd01$children==max(myd01$children),]  # finds the rows with the maximum 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-18T08:46:21.453

```
> aggregate(.~ year,data=my.data, FUN= max) 
```

这也将解决问题。

# jquery - 为什么我的 jQuery 手风琴不起作用？

> ID：12485469
> 
> 赞同：0
> 
> 时间：2012-09-18T21:38:02.257
> 
> 标签：jquery, accordion, jquery-ui-accordion

我的手风琴不工作了。我检查以确保我正在采购正确的 js 文件以及 google 的 jQuery UI。你能看出我做错了什么吗？

[http://amandapampena.com/anthonys/anthonys_menu](http://amandapampena.com/anthonys/anthonys_menu)

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T21:40:34.043

您需要先加载 jQuery，然后再加载与之关联的插件。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js" type="text/javascript"></script> 
```

更改加载顺序。由于 jQuery UI 是使用 jQuery 构建的，它不会识别前者是否在前者之后加载

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T21:40:09.447

您在 jQuery 本身之前加载 jQuery-Ui。更改顺序以修复错误。

# excel - Excel VBA：作为数据透视表数据源的命名范围的活动选择

> ID：12485488
> 
> 赞同：1
> 
> 时间：2012-09-18T21:39:36.163
> 
> 标签：excel, vba

我正在尝试将当前活动选择转换为命名范围，我可以将其作为数据透视表的数据源引用。我的函数 selectByUsedRows 提供了基于 usedCol 中有多少行以及在 selectStartCol 和 selectEndCol 处开始和停止的选择。当您只希望您的选择包含与选择之外的列的行数匹配的单元格时，这很有用。我无法为这个选择命名。任何帮助都会很棒。

**Excel 数据**

```
 A        B         C
1    CaseNum  Branch    Name
2    1234     APL       George
3    2345     VMI       George
4    3456     TEX       Tom
5    4567     NYC       Tom
6    5678     VMI       Sam
7    6789     TEX       Tom
8    7890     NYC       George 
```

**VBA**

```
'Check reference column and select the same number of rows in start and end columns
Sub selectByUsedRows(usedCol As String, selectStartCol As String, selectEndCol As String)
n = Range(usedCol & "1").End(xlDown).Row
Range(selectStartCol & "1:" & selectEndCol & n).Select
End Sub

'Dynamically select columns A to C with as many rows as are in A
Sub test()
refCol = "A"
selectStartCol = "A"
selectEndCol = "C"
selectByUsedRows refCol, selectStartCol, selectEndCol

'Code works until this point. There is now an active selection of A1:C8\. 
'The following is hypothetical

Dim rngSelection As Range
Set rngSelection = ActiveSelection
Range(rngSourceData).CurrentRegion.Name = "rngSourceData"

Set objTable = Sheet5.PivotTableWizard

ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _
    rngSourceData, Version:=xlPivotTableVersion14).CreatePivotTable _
    TableDestination:="Sheet5!R1C4", TableName:="PivotTable1", DefaultVersion _
    :=xlPivotTableVersion14
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T23:06:53.480

我认为您应该考虑创建一个动态范围，而不是静态范围。像 A1:C8 这样的静态范围将很好地填充您的数据透视表，直到有人在 RefColumn 中输入更多数据。如果您创建一个动态范围，例如

```
=$A$1:INDEX($C:$C,COUNTA($A:$A),1) 
```

这样您就不必在每次范围更改时都创建数据透视表。

```
Sub MakePT()

    Dim sh As Worksheet
    Dim pc As PivotCache
    Dim pt As PivotTable
    Dim rUsed As Range

    'Make a dynamic range name and return a reference to it
    Set rUsed = MakeNamedRange(Sheet1, 1, 1, 3, "rngSourceData")

    'Add a new sheet for the pivot table
    Set sh = ThisWorkbook.Worksheets.Add

    'Create a blank pivot table on the new sheet
    Set pc = ThisWorkbook.PivotCaches.Add(xlDatabase, rUsed)
    Set pt = pc.CreatePivotTable(sh.Range("A3"), "MyPivot")

End Sub

Public Function MakeNamedRange(sh As Worksheet, lRefCol As Long, lStartCol As Long, lEndCol As Long, sName As String) As Range

    Dim sRefersTo As String
    Dim nm As Name

    'Comments refer to lRefCol = 1, lStartCol = 1, lEndCol = 3

    '=$A$2:
    sRefersTo = "=" & sh.Cells(1, lStartCol).Address(True, True) & ":"

    '=$A$2:INDEX($C:$C,
    sRefersTo = sRefersTo & "INDEX(" & sh.Cells(1, lEndCol).EntireColumn.Address(True, True) & ","

    '=$A$2:INDEX($C:$C,COUNTA($A:$A),1)
    sRefersTo = sRefersTo & "COUNTA(" & sh.Cells(1, lRefCol).EntireColumn.Address(True, True) & "),1)"

    Set nm = ThisWorkbook.Names.Add(sName, sRefersTo)

    Set MakeNamedRange = sh.Range(sName)

End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T22:24:53.853

我假设您正在努力使数据透视表基于“代码工作到这一点”

以下提示输入范围，然后在新工作表上提供基本的数据透视表轮廓

```
Option Explicit

Private Sub someControlOrEvent_Click()
Dim rRange As Range
Dim pTable As Worksheet

    On Error Resume Next
    Set rRange = Application.InputBox(prompt:= _
    "Please select a new data range to name", _
        Title:="SPECIFY RANGE", Type:=8)
    On Error GoTo 0

    If rRange Is Nothing Then
        Exit Sub
    Else

    'Define Named Range (but not used any further)
     ThisWorkbook.Names.Add Name:="MyRange", RefersTo:=rRange

        Set pTable = ThisWorkbook.Sheets.Add

        ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _
            rRange, Version:=xlPivotTableVersion14).CreatePivotTable _
            TableDestination:=pTable.Range("A1"), TableName:="PivotTable1", DefaultVersion _
            :=xlPivotTableVersion14
        End If

End Sub 
```

在这种情况下`rRange`，是您想要的任何范围，如本例中的提示，或者可以是命名范围、当前选择等。它还假设数据透视表从新工作表的单元格 A1 开始。

# java - JSCH Sftp printWorkingDirectory

> ID：12485491
> 
> 赞同：0
> 
> 时间：2012-09-18T21:40:01.180
> 
> 标签：java, android, ftp, sftp, jsch

在 apache commons net ftpclient 中有 ftpClient.printWorkingDirectory() 来获取当前目录的字符串。

如何使用 jsch sftp 客户端实现相同的目标？有一个名为 realpath(String) 的方法，但它似乎不正确，我无法让它工作。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T04:23:52.350

SFTP 没有当前目录或“工作目录”的概念，这就是为什么你什么都找不到的原因。SFTP 中的所有路径都必须是绝对路径。相对路径的使用不是由标准定义的，而是特定于服务器的（因此，在不同的服务器上执行相同的操作时，您可能会大吃一惊）。

# jquery - 寻找一个类似于暴雪的 jQuery Carousel

> ID：12485493
> 
> 赞同：0
> 
> 时间：2012-09-18T21:40:02.687
> 
> 标签：jquery, html, css, carousel

我正在寻找一个类似于[暴雪主页](http://us.blizzard.com/en-us/)上居中的 jQuery 轮播，即使轮播的内容超出浏览器的宽度，也不显示水平滚动条，支持图像淡入淡出，并包括分页。

我玩过 SlidesJS 和 carouFredSel，但这些轮播不兼容。经过数小时的测试，我意识到这是因为这些插件依赖于容器的固定宽度，这导致当轮播比浏览器宽度更宽时会出现水平滚动条。

我想知道是否有一个使用类似代码结构的轮播，并通过 CSS 将图像嵌入为 div 的背景：

```
<div id="carousel">
  <div class="slide">
    <div class="content">Slide01</div>
  </div>
  <div class="slide">
    <div class="content">Slide02</div>
  </div>
  <div class="slide">
    <div class="content">Slide03</div>
  </div>
</div>

.carousel {
  margin: 0 auto;
}

.slide {}

.content {
  background: url(http://www.placehold.it/1200x500 center top no-repeat;
  min-width: 960px;
  height: 500px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:39:01.787

一方面，暴风雪滑块是基于 Flash 的。要让它与 jquery 一起工作，你必须做一个 jquery 函数来触发调整大小以获得窗口宽度：

```
$(window).resize(function(){
       var w = $(window).width(); 
       $('#sliderContainer').css({width: w});
}); 
```

# ruby-on-rails-3 - 如何使用 bundler 在两个不同的环境中安装两个不同版本的 gem

> ID：12485502
> 
> 赞同：1
> 
> 时间：2012-09-18T21:40:36.690
> 
> 标签：ruby-on-rails-3, bundler, gemfile

我想在两个不同的环境中安装特定 gem 的 2 个不同版本，我该怎么做。例如，我想在阶段环境中安装 2.13.0 版本的 gem，在生产环境中安装 3.1.0 来测试两个不同版本 gem 的使用。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:30:57.770

在您的 Gemfile 中：

```
group :development do
  gem "gem_name", "2.13.0"
end

group :production do
  gem "gem_name", "3.1.0"
end 
```

滚动到页面底部：http: [//gembundler.com/gemfile.html](http://gembundler.com/gemfile.html)

# ruby-on-rails - Rails 简单文件下载

> ID：12485506
> 
> 赞同：0
> 
> 时间：2012-09-18T21:40:44.127
> 
> 标签：ruby-on-rails

嗨，帮我解决一个简单的问题：

如何发布简单下载：

我的公共/数据我有 some.txt 或 some.pdf 文件（带有一些文本）

我想用户单击某个按钮并开始下载此文件。

我做这样的事情

```
<%= link_to "Terms" ,:action => :download, :file_name => 'some.txt' %>

def download
    send_file "#{RAILS_ROOT}/public/data/#{params[:file_name]}", :type=>"application/zip"
end 
```

但是接下来该怎么办？

PS如果你有一些关于这个主题的教程或例子（比如下载文件），我将非常感激

![在此处输入图像描述](../Images/1ed3a2f3ccded2c2991883ef431139d1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T14:15:13.580

你肯定错过了你的路线`routes.rb`：

```
resources :posts do
  get :download, :on => :collection

  resource :comments
end 
```

然后你可以有一个链接，如：

```
<%= link_to "Terms" ,:action => :download, :file_name => 'some.txt' %> 
```

这可能会产生类似的东西：

```
<a href="/posts/download?file_name=some.txt">Terms</a> 
```

我认为这仍然不是最好的解决方案，但可以解决您的问题。

我建议快速查看 Rails 指南的这一部分以澄清这一点：http: [//guides.rubyonrails.org/routing.html#adding-more-restful-actions](http://guides.rubyonrails.org/routing.html#adding-more-restful-actions)

完整阅读本指南总是好的，也强烈推荐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:48:30.967

你到底是什么意思“下一步”？除了 application/zip mime 类型与您的文件（它是 .txt，因此可能是文本/纯文本）不匹配这一事实之外，您编写的内容基本上是正确的。

有两件事要记住，因为您的文件位于公共目录中，您不需要`send_file`通过控制器严格使用，您可以改为这样写：

```
<%= link_to "Terms", '/data/some.txt' %> 
```

其次，如果您要使用`send_file`服务器更大的文件，您可能需要查看 xsendfile 来提高性能。不过，这必须由您的网络服务器支持（例如，使用 mod_sendfile for apache。）

但是所有这些都说您的代码应该按原样工作。

# ajax - 单个页面上的多个图表：iFrame 与 Ajax

> ID：12485510
> 
> 赞同：0
> 
> 时间：2012-09-18T21:40:59.167
> 
> 标签：ajax, jsp, iframe, jfreechart, bar-chart

我试图在一个页面上显示多个`Bar Charts`使用，来自同一域的所有图表。`Jfreechart API`想知道使用 iFrame 是否会更好，或者还有其他替代方案吗？如果我要使用 Ajax 执行此操作，例如在页面加载时显示每个条形图`div's`，该怎么做？如果有人能对此有所了解，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T22:09:05.667

我会推荐[Flot](http://www.flotcharts.org/)用于基于 Web 的图表，即使是在我自己的开源 API [XChart 上](http://xeiam.com/xchart.jsp)，它更适合桌面应用程序。[这](http://xeiam.com/helloflot.jsp)是一个 HelloWorld 类型的示例应用程序，其源代码演示了我曾经制作的 Flot。如果您对获取包含图表的 JPEG 更感兴趣，您可以查看[我如何使用 XChart 进行操作](http://xeiam.com/xchart_examplecode.jsp)（奖金示例，页面底部），您可能可以使用`JFreeChart`.

# php - 如何在本地编辑php文件？

> ID：12485516
> 
> 赞同：-2
> 
> 时间：2012-09-18T21:41:28.380
> 
> 标签：php

使用 HTML 文件，我可以在保存并进行更改（并使用 LiveReload）后在本地工作并在浏览器中预览文件，但使用 PHP，浏览器只会加载代码。我是否需要运行本地服务器才能在本地处理它，还是有更简单的方法？

我的 PHP 的范围是对页眉和页脚使用 include 语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:43:15.967

是的，您需要一个本地服务器来在本地运行 PHP 脚本。查看适用于 Mac 的 MAMP 或适用于 PC 的 XAMPP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:43:20.977

是的，您需要安装诸如 WAMP 之类的东西

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:43:32.380

不 - 因为 php 是一种服务器端解释语言，所以您必须运行服务器。最简单的方法是安装[`xampp`](http://www.apachefriends.org/de/xampp.html)whick 带来你需要的一切——apache、mysql、php。

在 Windows 上，您还可以安装 IIS 服务器，它是 Windows 的一部分

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T21:43:38.720

您可以非常轻松地下载和设置服务器 - 需要注意的*是*，确实*需要*设置 PHP 和 Apache 才能使 PHP 正常工作。

我可能会建议像[WAMP](http://www.wampserver.com/en/)这样的东西——它基本上是预先设置的，只需要很少的配置即可启动和运行。这将与 Apache 服务器、MySQL 和 PHP 一起很好地一起工作，并带有一个非常易于使用的点击界面。哦，它甚至安装了 PHPMyAdmin，这样如果您不熟悉控制台控件，您就可以轻松地使用您的数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T21:44:18.197

您需要设置一个可以适当地处理 php 请求的服务器。然而，这非常容易做到。只需谷歌如何安装 LAMP 服务器（在 Linux 上），或查看 WAMP（在 Windows 上）。如果这对您来说仍然太多，请考虑购买共享主机帐户或其他东西。我有一个小的，每年大约 15 美元。他们将为服务器设置您需要的一切；你只需要上传文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-18T21:44:57.637

是的，您需要运行本地服务器才能“使用它”。我建议[XAMPP](http://www.apachefriends.org/en/xampp.html)。要实际编辑文件，您当然需要一个文本编辑器。据我所知，任何编辑器都可以，但我自己使用 Notepad++，甚至使用 NetBeans IDE。

# jpa - 使用 JPA 2.0 Criteria api 创建“IN”查询

> ID：12485521
> 
> 赞同：1
> 
> 时间：2012-09-18T21:42:06.630
> 
> 标签：jpa, illegalstateexception

我正在使用 tje JPA 标准 API 创建“IN”查询。我想选择特定类别中的课程。类别应该在查询的 IN 部分结束。

这是课程实体。它引用了 Category 实体，因为每个 Course 都在一个 Category 中。

```
@Entity
public class Course implements DomainObject {

private Long id;
private Integer version;
private String name;
private Category category;

@Override
@Id
@GeneratedValue
public Long getId() {
    return id;
}

public void setId(Long id) {
    this.id = id;
}

@ManyToOne
public Category getCategory() {
    return category;
}

public void setCategory(Category category) {
    this.category = category;
}

public String getName() {
    return name;
}

public void setName(String name) {
    this.name = name;
}

public Integer getVersion() {
    return version;
}

public void setVersion(Integer version) {
    this.version = version;
} 
```

}

在我的服务中，我想选择属于某个类别（列表）的课程。

```
public List<Course> findCourses(CourseFilter filter) {
    CriteriaBuilder criteriaBuilder = entityManager.getCriteriaBuilder();
    CriteriaQuery<Course> criteriaQuery = criteriaBuilder.createQuery(Course.class);
    Root<Course> root = criteriaQuery.from(Course.class);
    List<Predicate> predicateList = new ArrayList<Predicate>();

    if (!filter.getCategories().isEmpty()) {
        Predicate predicate = root.get(Course_.category).in(filter.getCategories());
        predicateList.add(predicate);
    }

    Predicate[] predicates = new Predicate[predicateList.size()];
    predicateList.toArray(predicates);

    criteriaQuery.where(predicates);
    TypedQuery<Course> typedQuery = entityManager.createQuery(criteriaQuery);

    return typedQuery.getResultList();
} 
```

当查询在方法的最后一行执行时，它会抛出一个错误：

```
HTTP Status 500 - Request processing failed; nested exception is
org.springframework.dao.InvalidDataAccessApiUsageException:
org.hibernate.TransientObjectException: object references an unsaved transient instance
save the transient instance before flushing:nl.codebasesoftware.produx.domain.Category;
nested exception is java.lang.IllegalStateException:
org.hibernate.TransientObjectException: object references an unsaved transient instance
save the transient instance before flushing: nl.codebasesoftware.produx.domain.Category 
```

我什至不确定我是否使用正确的方法来创建 IN 查询。我认为标准 API 非常复杂。但在我担心 IN 查询之前，我想知道为什么 Hibernate 会抛出这个 TransientObjectException。filter.getCategories **()**调用会产生实际的类别，填充主键 id 等。

## 添加：

以下是我获取用于稍后获取课程的 Category 实例的方法。这也是一个 DAO 方法，通过 @Controller 方法中的 @Service 调用。

```
public Category findByName(String name) {
    CriteriaBuilder builder = entityManager.getCriteriaBuilder();
    CriteriaQuery<Category> query = builder.createQuery(Category.class);
    Root<Category> root = query.from(Category.class);
    Predicate predicate = builder.equal(root.get(Category_.urlTitle), name);
    query.where(predicate);
    TypedQuery<Category> typedQuery = entityManager.createQuery(query);
    return getSingleResult(typedQuery);
} 
```

因此，Hibernate 告诉我我正在使用以某种方式引用未保存实体的 Category 对象，但我不知道如何。从这个方法返回的 Category 只是一个由 Hibernate 获取的 Category。在将它发送到获取课程的方法之前，我没有对它做任何事情。

这是我的控制器方法：

```
@RequestMapping(method = RequestMethod.GET, value = "/{categoryUrlName}")
public String setup(@PathVariable("categoryUrlName") String categoryUrlName, Model model){
    // Fetch the category
    Category category = categoryService.findByName(categoryUrlName);

    // if no category found, throw a 404
    if(category == null){
        throw new ResourceNotFoundException();
    }
    // Fetch courses in this category
    List<Course> courses = courseService.findCourses(category);

    model.addAttribute("courses", courses);
    model.addAttribute("category", category);
    model.addAttribute("mainContent", "content/category");
    return "main";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:50:33.850

在执行查询之前，Hibernate 会刷新您对会话中的持久实体所做的更改。这确保了查询将搜索所有实体的最新状态。不幸的是，Hibernate 尝试刷新的脏实体之一引用了一个瞬态实体，因此无法刷新，这会导致异常。异常不是来自查询本身，而是来自执行查询之前的刷新。

在执行查询之前，您可能执行了以下操作：

```
Cat cat = em.find(Cat.class, catId); // cat is a persistent persistent entity
cat.setMate(new Mouse()); // the mouse has not been persisted, and cat references it. 
```

# asp.net - 无法在新的 appDomain 中加载程序集

> ID：12485523
> 
> 赞同：0
> 
> 时间：2012-09-18T21:42:09.837
> 
> 标签：asp.net, asp.net-mvc-3, c#-4.0, appdomain, appdomainsetup

我有一个 mvc3 应用程序。我的应用程序项目中有一个名为“插件”的子文件夹

存储在该文件夹中的所有 dll 都应该在运行时更新，所以我们放下 appdomain 并重新加载新版本的 dll，所以我尝试将所有插件 dll 加载到不同的 appDomain 并设置它的 shadowCopy 属性.

通过 SO、msdn 和一些博客，我得到了这个“解决方案”。（这是在我的 Application_Start 期间调用的）

```
static AppDomain pluginDomain;
static PluginHolder()
        {
            AppDomainSetup domainSetup = AppDomain.CurrentDomain.SetupInformation;
            domainSetup.ApplicationName = "Plugins";
            domainSetup.PrivateBinPathProbe = domainSetup.PrivateBinPath;
            domainSetup.PrivateBinPath = GetPluginsDirectory();
            domainSetup.ShadowCopyFiles = "true";
            domainSetup.ShadowCopyDirectories = domainSetup.PrivateBinPath;

            pluginDomain= AppDomain.CreateDomain("Plugins", null, domainSetup);
            var item = pluginDomain.Load(File.ReadAllBytes(GetPluginsDirectory() + "Item.dll"));
        } 
```

“Item.dll”是我试图加载的 dll。最后一行抛出“无法加载文件或程序集项或其依赖项之一”。这似乎是其他人成功的方式，但它对我不起作用。

我以前没有使用 AppDomains 的经验，所以我不确定如何解决这个问题，或者我是否正确处理它。

我的程序集通过新的 AppDomain 加载是一种好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T15:24:50.043

要解密这些类型的错误消息，您应该使用[Assembly Binding Log Viewer](http://msdn.microsoft.com/en-us/library/e74a18c4%28v=vs.100%29.aspx)。

还要注意[AppDomain.Load(byte[])](http://msdn.microsoft.com/en-us/library/7hcs6az6.aspx)文档页面上的备注部分。如果要在新的 AppDomain 上加载程序集，则应改用[CreateInstanceAndUnwrap](http://msdn.microsoft.com/en-us/library/system.appdomain.createinstanceandunwrap.aspx)。

如果您想在 .NET 中实现插件引擎，那么您将需要了解 AppDomain、程序集解析和加载，然后选择用于不同 AppDomain 的对象之间通信的机制。大多数关于 .NET 和 CLR 的好书都包含一两章关于 AppDomains 的内容，它们会让你快速上手。现在就跨 AppDomain 通信而言，您可以使用 WCF 或 .NET Remoting ( [MarshalByRefObject](http://msdn.microsoft.com/en-us/library/System.MarshalByRefObject.aspx) )。

祝你好运。

# database - 如何在 Vertica 数据库中启用加入溢出？

> ID：12485524
> 
> 赞同：1
> 
> 时间：2012-09-18T21:42:13.607
> 
> 标签：database, join, vertica

我需要知道如何在 Vertica 6.0 EE 中启用加入溢出？
是否有任何参数可以让我这样做？
如果是这样，请解释一下这个过程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T00:49:07.580

```
select set_vertica_options('EE','ENABLE_JOIN_SPILL'); 
```

但我只会在 Vertica 支持/专业服务的推荐下使用它

# php - 如何从这个“非最佳实践表”中减去

> ID：12485533
> 
> 赞同：0
> 
> 时间：2012-09-18T21:42:49.437
> 
> 标签：php

最后一部分需要帮助。我怎样才能把费用总和从收入中减去来得到剩下的……

收入-费用=剩余...你明白了..

猜猜我的mysql表不是最好的方法，但我是一个菜鸟，这就是我想出的......

```
// summary income

$query_income = "SELECT type, SUM(january), SUM(february), SUM(march), SUM(april),     SUM(may), SUM(june), SUM(juli), SUM(august), SUM(september), SUM(october), SUM(november), SUM(december) FROM data WHERE year = '2012' AND type = '1'";
$results = mysql_query($query_income);

while($row = mysql_fetch_array( $results )) {

   $total_income = $row['SUM(january)'] + $row['SUM(february)'] + $row['SUM(march)'] + $row['SUM(april)'] + $row['SUM(may)'] + $row['SUM(june)'] + $row['SUM(juli)'] + $row['SUM(august)'] + $row['SUM(september)'] + $row['SUM(october)'] + $row['SUM(november)'] + $row['SUM(december)'];

 echo "<tr>";
  echo "<td><b>Income</b></td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(january)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(february)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(march)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(april)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(may)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(june)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(juli)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(august)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(september)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(october)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(november)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row['SUM(december)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($total_income) ."</td>";
 echo "</tr>";

}

// summary expenses

$query_expense = "SELECT type, SUM(january), SUM(february), SUM(march), SUM(april), SUM(may), SUM(june), SUM(juli), SUM(august), SUM(september), SUM(october), SUM(november), SUM(december) FROM data WHERE year = '2012' AND type = '2'";
  $results = mysql_query($query_expense);

while($row1 = mysql_fetch_array( $results )) {

   $total_expense = $row1['SUM(january)'] + $row1['SUM(february)'] + $row1['SUM(march)'] + $row1['SUM(april)'] + $row1['SUM(may)'] + $row1['SUM(june)'] + $row1['SUM(juli)'] + $row1['SUM(august)'] + $row1['SUM(september)'] + $row1['SUM(october)'] + $row1['SUM(november)'] + $row1['SUM(december)'];

   echo "<tr>";
  echo "<td><b>Expenses</b></td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(january)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(february)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(march)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(april)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(may)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(june)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(juli)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(august)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(september)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(october)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(november)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($row1['SUM(december)']) ."</td>";
  echo "<td style='text-align:right'>" . number_format($total_expense) ."</td>";
 echo "</tr>";

}

// summary, whats left

   echo "<tr>";
  echo "<td><b>Leftover</b></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
  echo "<td style='text-align:right'></td>";
 echo "</tr>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:59:54.460

您可以在一个查询中执行此操作，如下所示：

```
SELECT type, SUM(january) AS `jan`, SUM(february) AS `feb`, ...
FROM data
WHERE `year` = '2012'
GROUP BY type
ORDER BY type ASC 
```

然后处理结果如下：

```
$totals = array();

while($row = mysql_fetch_array( $results )) {
   $type = 'unknown';
   switch ((integer)$row['type']) {
       1:
           $type = 'income';
           break;
       2:
           $type = 'expense';
           break;
   }
   unset($row['type']);
   $totals[$type] = $row;
}

$total_income = array_sum($totals['income']);
$total_expense = array_sum($totals['expenses']); 
```

现在您有了一个多维数组，您可以轻松地使用它来对整个 arr 求和

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:59:46.023

这样的事情怎么样？

```
SELECT 
    income.1 - expense.1 AS 1,
    income.2 - expense.2 AS 2,
    income.3 - expense.3 AS 3,
    income.4 - expense.4 AS 4,
    income.5 - expense.5 AS 5,
    income.6 - expense.6 AS 6,
    income.7 - expense.7 AS 7,
    income.8 - expense.8 AS 8,
    income.9 - expense.9 AS 9,
    income.10 - expense.10 AS 10,
    income.11 - expense.11 AS 11,
    income.12 - expense.12 AS 12
FROM
    (SELECT
        SUM(january) AS 1, 
        SUM(february) AS 2,  
        SUM(march) AS 3,  
        SUM(april) AS 4,  
        SUM(may) AS 5,  
        SUM(june) AS 6,  
        SUM(juli) AS 7,  
        SUM(august) AS 8,  
        SUM(september) AS 9, 
        SUM(october) AS 10, 
        SUM(november) AS 11, 
        SUM(december) AS 12
    FROM data 
    WHERE year = '2012' AND type = '1') income,
    (SELECT type  AS 1,  
        SUM(january) AS 1, 
        SUM(february) AS 2,  
        SUM(march) AS 3,  
        SUM(april) AS 4,  
        SUM(may) AS 5,  
        SUM(june) AS 6,  
        SUM(juli) AS 7,  
        SUM(august) AS 8,  
        SUM(september) AS 9, 
        SUM(october) AS 10, 
        SUM(november) AS 11, 
        SUM(december) AS 12
    FROM data 
    WHERE year = '2012' AND type = '2') expense 
```

# image - joomla 1.5 包中网站图像和文本的位置

> ID：12485545
> 
> 赞同：0
> 
> 时间：2012-09-18T21:43:30.973
> 
> 标签：image, text, joomla, directory

一个 joomla 1.5 网站被黑了，我被委托从头开始重建它，因为当前版本无法使用。

托管公司“清理”了它并使其无法使用。

我个人从未使用过 joomla，我只是下载了 Joomla 文件和文件夹，希望我能找到网站仍在运行时使用的原始文本和图像。

没有这样的运气。

有谁知道客户端上传的图像和文本在 joomla 1.5 文件夹树中的位置？

提前致谢。

担

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:46:27.277

文本存储在#__content 中的数据库中。每篇文章都将在一个新行中。用户上传的图像存储在 joomla 安装的 images 子文件夹中。但是请记住，如果与它们一起安装，一些可能会存储在组件或模块子文件夹中。

# font-size - 将 HTML 元素向上移动 1 行高

> ID：12485548
> 
> 赞同：0
> 
> 时间：2012-09-18T21:43:41.280
> 
> 标签：font-size, css, em

我有一些标记：

```
<dl><dt>1</dt><dd>One</dd><dt>2</dt><dd>Two</dd><dt>3</dt><dd>Three</dd></dl> 
```

我想设计这样的样式，使`<dd>`s 与`<dt>`s 一致。我的文档`line-height`设置为`1.3`. 知道`em`s 等于`font-size`并且`line-height`是 的百分比`font-size`，我尝试了：

```
body { line-height: 1.3; font-size: 75%; }
dd { margin-top: -1.3em; margin-left: 10em; } 
```

为我的数据提供`<dt>`合理的间距。这不起作用，因为以像素为单位`line-height`测量`15px`但`1.3em`测量`15.6px`。根据[http://www.brunildo.org/test/line-height-approx.html](http://www.brunildo.org/test/line-height-approx.html)，不同的浏览器计算行高的确切像素值不同 - 我在 Chrome 中开发，很幸运被它抓住了.

出于这个问题的目的，我想避免像素 - 指定`line-height`, 和`margin-top`以像素为单位可以工作，但调整大小会很差。

这是一个显示问题的uri：

```
data:text/html,<style>body { line-height: 1.3; font-size: 75%; } dd { margin-top: -1.3em; margin-left: 1em; }</style><dl><dt>1</dt><dd>One</dd><dt>2</dt><dd>Two</dd><dt>3</dt><dd>Three</dd></dl> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:49:04.900

根据我对您想要实现的目标的理解，您希望每个 dt/dd 对在同一行上吗？

这是一个有效的 jsfiddle 示例：http: [//jsfiddle.net/w9YQx/1/](http://jsfiddle.net/w9YQx/1/)

使用浮动，并清除。行高、字体大小等无关紧要。

```
dt {
    float: left;
    width: 150px;
    clear: left;
    text-align: right;
}
dd {
    margin-left: 10px;
}
​ 
```

您可以将宽度设置为任何您想要的，这只是一个示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:56:50.540

`<ol>`在这种情况下似乎更合适，但您可以执行以下操作：

```
dl {
    font: 200%/1.3 Arial;
    overflow: hidden;
}

dt {
    clear: both;
}

dt, dd {
   float: left;
   margin-left: 0.5em;
}
​ 
```

[http://jsfiddle.net/MgBvV/1/](http://jsfiddle.net/MgBvV/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T21:49:00.037

```
position: relative;
bottom: 1.3em; /* same as line height */ 
```

[见小提琴](http://jsfiddle.net/FjbTb/1/)

# lync - 如何在没有工作流 sdk 的情况下接受 PIN 作为 ucma 应用程序的身份验证方法？

> ID：12485549
> 
> 赞同：0
> 
> 时间：2012-09-18T21:43:52.613
> 
> 标签：lync, lync-2010, ucma

希望看到一个 ucma 机器人中的示例实现，它仅使用核心 ucma api（不使用工作流 sdk）通过 pin 验证调用者

我尝试将它与`ToneReceived`事件联系起来，`ToneController`但它只能知道我试图按下拨号器的一系列数字的第一个数字。

有人见过这样的实现吗？请指点我...

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T08:10:51.103

听起来你已经完成了 99% 的工作。该`ToneReceived`事件一次只会听一种音调。因此，对于多个数字，事件将触发多次，您需要将收到的每个音调添加到集合或数组中，然后决定何时取消注册事件（可能在输入 4 个音调之后），然后评估阵列以获得正确的 PIN。

SDK 中包含一个 QuickStart 示例，该示例应位于您的计算机上：

`%ProgramFiles%\Microsoft UCMA 3.0\SDK\Core\Sample Applications\QuickStarts\AudioVideoCall\ToneController`

但老实说，听起来你已经拥有了大部分 UCMA 特定的东西。

祝你好运！

# java - 如何将 Bash 与 Java 集成

> ID：12485552
> 
> 赞同：1
> 
> 时间：2012-09-18T21:44:18.073
> 
> 标签：java, linux, bash

任何人都可以帮助我如何将 bash 脚本编译为 java 程序的一部分。我正在编写一个简单的 java 程序，我想用它来调用 bash 脚本命令。

* * *

我的 java 代码如下所示：

```
 try{
            Process p = Runtime.getRuntime().exec("myscript.sh"); 
        BufferedReader in = new BufferedReader(new InputStreamReader(p.getInputStream())); 

        String line = null;  

        while ((line = in.readLine()) != null){  
                    System.out.println(line); 
        }  
    }
    catch(IOException e){
        System.out.println(e.getMessage());
    } 
```

并且“mysrcipt.sh”文件是一个简单的脚本，包含以下几行

* * *

# !/bin/bash

echo "输入您的输入，然后 [ENTER]:"

读取 -e 选择

回声$选择

* * *

我的问题是，即使我输入多行并按回车键，程序也会等待脚本中读取命令的输入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:47:26.617

您可以使用：

```
Process p = Runtime.getRuntime().exec("bash_script.sh"); 
BufferedReader in = new BufferedReader(new InputStreamReader(p.getInputStream()));  
String line = null;  
while ((line = in.readLine()) != null) {  
   // use bash script line output
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:51:19.830

查看一些显示您要完成的工作的代码会很有帮助。

在 Java 中执行 bash 脚本可以使用类似以下的方法来完成...

```
Runtime runtime = Runtime.getRuntime();
Process process = runtime.exec("YOUR COMMAND STRING");

List<String> lines = IOUtils.readLines(process.getInputStream()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T22:08:12.633

Runtime.exec() 是执行 bash 脚本所需要的，但请注意存在一些缺陷。在开始调用外部脚本时，我发现[这是一篇好文章。](http://www.javaworld.com/jw-12-2000/jw-1229-traps.html?page=4)

它是为 Windows 平台编写的，但讨论的很多内容也与 *nix 有关。

另请参阅[此问题](https://stackoverflow.com/questions/609762/need-sample-java-code-to-run-a-shellscript)。

# java - 如何在 Java 中正确设置最小尺寸？

> ID：12485555
> 
> 赞同：14
> 
> 时间：2012-09-18T21:44:40.053
> 
> 标签：java, swing, resize, autoresize

对于我在 Java 中创建的 GUI 应用程序，我有以下内容：

*   一个 JFrame，设置为具有 (300,200) 的最小大小
*   一个 JSplitPane，其中包含：
    *   在左边，一个最小尺寸为 (100,0) 的 JScrollPane（包含一个 JTree）（我只想将宽度限制为 200）
    *   在右侧，最小尺寸为 (200,0) 的 JPanel

在以下条件下，尺寸不会给我任何问题：

*   一直调整 JSplitPane 的大小（到 JScrollPane 的最小大小），然后调整窗口大小
*   只是在一定程度上调整窗口大小

当我将 JSplitPane 移动得太靠近右侧时会出现问题，因此调整窗口大小时 JSplitPane 右侧的 JPanel 无法遵守我设置的最小宽度。

我尝试在 JScrollPane 上设置最大宽度，这似乎根本没有帮助。

有没有我必须做的涉及最大尺寸的事情？或者也许有一种方法可以将 Listener 附加到其中一个面板以强制执行我想要的行为？最终，我只希望 JSplitPane 中的右侧面板的宽度永远不会小于 200 像素。

这是我遇到的行为示例：

```
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.GridLayout;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JSplitPane;
import javax.swing.JTree;

public class ResizeTest
{
    private JFrame frame;
    public static void main(String[] args)
    {
        EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                try
                {
                    ResizeTest window = new ResizeTest();
                    window.frame.setVisible(true);
                }
                catch(Exception e)
                {
                    e.printStackTrace();
                }
            }
        });
    }
    public ResizeTest()
    {
        initialize();
    }
    private void initialize()
    {
        frame = new JFrame();
        frame.setMinimumSize(new Dimension(300, 200));
        frame.setBounds(100,100,450,300);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.getContentPane().setLayout(new GridLayout(0, 1, 0, 0));

        JSplitPane splitPane = new JSplitPane();
        frame.getContentPane().add(splitPane);

        JScrollPane scrollPane = new JScrollPane();
        scrollPane.setMinimumSize(new Dimension(100, 0));
        splitPane.setLeftComponent(scrollPane);

        JTree tree = new JTree();
        tree.setMinimumSize(new Dimension(100, 0));
        scrollPane.setViewportView(tree);

        JPanel panel = new JPanel();
        panel.setMinimumSize(new Dimension(200, 0));
        splitPane.setRightComponent(panel);
    }
} 
```

**更新：**

恐怕我不完全理解在提议的解决方案中试图提出的观点，除了 setPreferred() 和 setMinimum/Maximum() 最好避免。

我的问题是，*在使用这些方法之外限制 JSplitPane 分隔符的选项是什么*？ **MadProgrammer**提到了监听 componentResized 事件，但我需要进一步说明原因。我是否调用 setDividerLocation() 来响应此事件？

如果附加的问题完全是一个单独的 StackOverflow 问题，我提前道歉，如有必要，我可以在此处发布另一个问题并链接。

**更新 2：**

只是不规范用户如何选择窗口大小并在 JScrollPane 中设置右侧面板是一个可行的选项吗？在我看来，这有点像一种标准做法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-18T23:08:33.940

首先，该方法`setMinimumSize`是对`LayoutManager`API 的建议。一个可能被忽略的建议。

为了能够接近支持这一点，您将需要使用[ComponentListener](http://docs.oracle.com/javase/7/docs/api/java/awt/event/ComponentListener.html)之类的东西并监视[componentResized](http://docs.oracle.com/javase/7/docs/api/java/awt/event/ComponentListener.html#componentResized%28java.awt.event.ComponentEvent%29)事件。

我能想到的最佳解决方案是使用`LayoutManager`实际使用最小和最大尺寸约束的 a，例如`GridBagLayout`.

在“内容”窗格上使用它并将您`JSplitPane`放在上面（相应地设置它的最小和最大尺寸），然后将“内容”窗格添加到框架中。

**更新**

抱歉，我可能遗漏了一些非常明显的东西，但我把这个小测试放在一起，我希望它有一些帮助：P

```
public class TestFrameSize extends JFrame {

    public TestFrameSize() throws HeadlessException {

        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setSize(600, 600);
        setLocationRelativeTo(null);

        setMinimumSize(new Dimension(250, 250));

        JLabel left = new JLabel("Left");
        JLabel right = new JLabel("Right");

        Dimension pSize = new Dimension(100, 100);
        Dimension mSize = new Dimension(25, 100);

        left.setPreferredSize(pSize);
        left.setMinimumSize(mSize);
        right.setPreferredSize(pSize);
        right.setMinimumSize(mSize);

        JSplitPane pane = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT, left, right);

        JPanel content = new JPanel(new GridBagLayout());
        content.add(pane);

        setLayout(new BorderLayout());
        add(content);

    }

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {

        new TestFrameSize().setVisible(true);

    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T23:52:27.200

在此[示例](https://stackoverflow.com/a/10110232/230513)中，a 内容的首选大小`JSplitPane`最初设置为 中组件首选大小的小倍数`getPreferredSize()`。请注意，`JSplitPane`将不小于面板的最小尺寸，由封闭的`Jlabel`.

![图片](../Images/7e0be5fdcd0016210293c3211f11df40.png)

# javascript - Highcharts 返回错误 14

> ID：12485560
> 
> 赞同：6
> 
> 时间：2012-09-18T21:45:09.783
> 
> 标签：javascript, highcharts

在花了几个小时试图弄清楚如何将 JSON 字符串处理成 javascript 数组之后，我试图用 highcharts 绘制一个饼图。这就是我所拥有的

```
gateway_useage: function(usage_data) {
        var options = {
            chart: {
                renderTo:'gateway-usage',
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false
            },
            title: { text: 'Gateway Usage' },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage}%</b>',
                percentageDecimals: 1
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        color: '#000000',
                        connectorColor: '#000000',
                        formatter: function() {
                            return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %';
                        }
                    },
                    showInLegend: true
                }
            },
            series: [{
                type: 'pie',
                name: 'Usage',
            }]
        }

        var serie1 = usage_data.map( function(e) {
            return [e.gateway, e.val];
        });
        options.series.push({data: serie1});

        var chart = new Highcharts.Chart(options);

    } 
```

加载页面并检查错误控制台后显示“Uncaught Highcharts error #14: www.highcharts.com/errors/14”。做错了什么，请帮帮我

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-19T06:43:56.643

[Highcharts 错误 #14](http://www.highcharts.com/errors/14)清楚地说

> 发送到 series.data 的字符串值，如果您将字符串作为数据点传递，则预期会发生此数字

数据点是 yValue，如果你`serie.data`的形式是

```
[y1,y2,y2] 
```

或者

```
[[x1,y1],[x2,y2],[x3,y3]] 
```

或者

```
[
{ x : x1 ,y : y1 },
{ x : x2 ,y : y2 },
{ x : x3 ,y : y3 }
] 
```

在上述任何一种形式中，存储在 & 中的数据类型`y1`应该`y2`是`y3`数字。您可以在javascript中简单地使用[`parseFloat()`](http://www.w3schools.com/jsref/jsref_parsefloat.asp)or来实现这一点[`parseInt()`](http://www.w3schools.com/jsref/jsref_parseint.asp)

```
var serie1 = usage_data.map( function(e) {
            return [e.gateway, parseFloat(e.val)];
}); 
```

或者在你正在使用的服务器技术中进行
（PHP 4 >= 4.2.0, PHP 5）[`floatval()`](http://php.net/manual/en/function.floatval.php)可以使用

```
$float_value_of_var = floatval("123.456"); 
```

# php - 使用漂亮的 url 提交 onChange

> ID：12485563
> 
> 赞同：3
> 
> 时间：2012-09-18T21:45:15.303
> 
> 标签：php, jquery

我已经针对这个问题提出了一个问题，但它的表述非常糟糕，因此我没有得到很好的回应......所以再试一次......希望没关系

* * *

我有一个带有选定标签的表单和里面的一些选项

```
<form>
  <select>
     <option selected="selected"></option>
     <option value="1" data-seourl="food-intake">Food intake</option>
     <option value="2" data-seourl="homemade-cake">Homemade cake</option>
     <option value="3" data-seourl="good-fruits">Good fruits</option>
     <option value="4" data-seourl="apple-type">Apple type</option>
  </select>
</form> 
```

当我选择一个选项（onchange）时，我想向与此类似的服务器提交一个友好的 url：

```
http://www.mywebsite/kitchen/food-intake.1
http://www.mywebsite/kitchen/homenade-cake.2
... 
```

而不是发送默认值：

```
http://mywebsite/kitchen/?category=1
http://mywebsite/kitchen/?category=2 
```

我知道如何使用 mod_rewrite，所以这不是问题。我需要了解如何提交友好的网址而不是默认网址？

javascript（在这种情况下为 jQuery）是唯一的解决方案还是有本机解决方案？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:49:22.807

试试这个：

```
$('select').change(function()
{
    var $option = $(this).find('option:selected');
    if ($option.length)
    {
        window.location.href = 'http://www.mywebsite/kitchen/'+
                               $option.attr('data-seourl')+'.'+
                               $option.attr('value');
    }
}); 
```

注意：从技术上讲，这不是`<form>`提交，但实际上您可以合理地做所有事情，因为表单会尝试附加您不想要的查询字符串。不过，这两种方法都会产生 HTTP GET 请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T21:55:08.237

与 jimp 的回答类似，您可以使用 jQuery 的 AJAX 函数：

```
$('select').change(function() {
    var $option = $(this).find('option:selected');
    var url = 'http://www.mywebsite/kitchen/'
        + $option.attr('data-seourl') 
        + '.' 
        + $option.attr('value');
    if ($option.length) {
        console.log("Sending this data via POST request: ", $("form").serialize());
        $.post(url, $("form").serialize(), function(data) {
            console.log("POST request got this response back:", data);
        });
    }
}); 
```

也可以看看：

*   [基本 jQuery AJAX 教程/示例](http://net.tutsplus.com/tutorials/javascript-ajax/submit-a-form-without-page-refresh-using-jquery/)
*   [jQuery.get](http://api.jquery.com/jQuery.get/)
*   [jQuery.post](http://api.jquery.com/jQuery.post/)
*   [jQuery.ajax](http://api.jquery.com/jQuery.ajax/)

# php - 有没有办法以我们在远程服务器上获得的相同格式（如 /home/MyUserName/public_html）在 localhost 上获取文档根目录？

> ID：12485567
> 
> 赞同：1
> 
> 时间：2012-09-18T21:45:27.990
> 
> 标签：php, codeigniter, webserver, localhost, security

CodeIgniter 文档说：

> 为了获得最佳安全性，***系统***和任何***应用程序*** 文件夹都应放置在 Web 根目录之上，这样它们就不能通过浏览器直接访问。移动它们后，打开您的主 index.php 文件并设置 $system_folder 和 application_folder 变量，最好使用完整路径，例如“/www/MyUser/system”。

通过回显 PHP`$_SERVER['DOCUMENT_ROOT']`变量，我得到了远程服务器的文档根目录，`/home/MyUserName/public_html`但是当我尝试在本地主机上执行相同操作时，我得到了不同类型的路径（Windows 路径），它是`D:/xampp/htdocs`. 为什么？有没有一种方法可以让我在本地主机上获得像第一个路径一样的路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:51:03.490

在目标平台（此处为 Linux）上开发/测试总是更可取，但如果您想继续在 Windows 上开发，可以查看[http://cygwin.com/之类的内容。](http://cygwin.com/)它会让你更接近。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:47:47.510

第一个路径是 unix 文件系统路径 - 第二个是 windows 路径。没有必要在 Windows 上有一个 unix 风格的路径。您唯一需要做的就是将 codeigniter 放置在从外部无法访问的路径中 - 例如`D:/xampp/some_other_path`

# c# - 跨平台项目架构

> ID：12485577
> 
> 赞同：2
> 
> 时间：2012-09-18T21:47:13.930
> 
> 标签：c#, .net, architecture, projects-and-solutions

我正在构建一个跨平台的 C# 应用程序。

所有平台通过使用以下方式共享大量代码：

*   跨平台库（适用于所有平台），例如可移植类库项目。
*   特定平台库（每个平台一个单独的 DLL）。

每个平台可能需要自己的一些不同的引导代码，或者某些部分的其他定制版本。

我正在寻找有关如何设置项目（结构）以成功适应多个平台的具体指南。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T05:57:23.720

到目前为止，我只参与了其中一次这样的讨论，

[http://sharpsnmplib.codeplex.com/discussions/390251](http://sharpsnmplib.codeplex.com/discussions/390251)

但是 mel 使用的方法，如[https://github.com/moljac/MonoMobile.SharpSNMP](https://github.com/moljac/MonoMobile.SharpSNMP)中所示，并不能说服我这是最好的方法。

我是 Monologue 的订阅者，到目前为止，我没有从该来源看到任何关于这个问题的重要帖子。我想每个人都还在研究/实验。

# python - 清理绑定表单域的值

> ID：12485586
> 
> 赞同：0
> 
> 时间：2012-09-18T21:48:01.623
> 
> 标签：python, django

我有一个 django 表单-

```
{{ field }} 
```

这给了我以下 HTML：

```
<input id="id_producers" type="text" class="long-input" value="[Lawrence Bender]" /> 
```

我需要清理 value 属性。为此，我编写了以下模板标签：

```
{{ field|clean_list_string }}

def clean_list_string(field):
    value = field.value()
    if str(value).startswith('[') and str(value).endswith(']'):
        value = ast.literal_eval(value)
        if str(value)[1] == '(':
            value = ', '.join('(' + ', '.join(i) + ')' for i in value)
        else:
            value = ', '.join(value)

    return ??? (value) 
```

我将如何返回正确的绑定方法，以使返回的 HTML 具有更改的值：

```
<input id="id_producers" type="text" class="long-input" value="Lawrence Bender" /> 
```

# python - 将“增长”表的命令式算法转换为纯函数

> ID：12485591
> 
> 赞同：4
> 
> 时间：2012-09-18T21:48:35.670
> 
> 标签：python, functional-programming, software-design, imperative-programming

我的程序是用 Python 3 编写的，它有很多地方都以（非常大的）类似表的数字数据结构开始，并按照某种算法向其中添加列。（算法在每个地方都不一样。）

我正在尝试将其转换为纯函数式方法，因为我遇到了命令式方法的问题（难以重用、难以记忆中间步骤、难以实现“惰性”计算、由于依赖状态而容易出错等） .

该类`Table`被实现为字典字典：外部字典包含行，索引为`row_id`; 内部包含一行中的值，由 . 索引`column_title`。该表的方法非常简单：

```
# return the value at the specified row_id, column_title
get_value(self, row_id, column_title)

# return the inner dictionary representing row given by row_id
get_row(self, row_id) 

# add a column new_column_title, defined by func
# func signature must be: take a row and return a value
add_column(self, new_column_title, func) 
```

到目前为止，我只是在原始表中添加了列，每个函数都将整个表作为参数。当我转向纯函数时，我必须使所有参数不可变。因此，初始表变得不可变。任何其他列都将创建为独立列，并仅传递给需要它们的那些函数。一个典型的函数会获取初始表和一些已经创建的列，并返回一个新列。

我遇到的问题是如何实现独立列（`Column`）？

我可以给他们每个人做一本字典，但它似乎很贵。事实上，如果我需要对每个逻辑行中的 10 个字段执行操作，我将需要进行 10 次字典查找。最重要的是，每一列都将包含键和值，使其大小增加一倍。

我可以制作`Column`一个简单的列表，并在其中存储对从 row_id 到数组索引的映射的引用。好处是这个映射可以在对应于同一个初始表的所有列之间共享，并且一旦查找一次，它就适用于所有列。但这会产生任何其他问题吗？

如果我这样做，我可以更进一步，并将映射实际存储在初始表本身中吗？我可以将`Column`对象的引用放回创建它们的初始表吗？它似乎与我想象的一种功能性工作方法大不相同，但我看不出它会导致什么问题，因为一切都是不可变的。

一般来说，函数式方法是否不赞成在返回值中保留对其中一个参数的引用？看起来它不会破坏任何东西（比如优化或惰性评估），因为无论如何这个参数都是已知的。但也许我错过了一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T17:19:54.080

这是我的做法：

1.  [从freezeset](http://docs.python.org/library/stdtypes.html#frozenset)派生您的表类。
2.  每行应该是元组的子类。

现在你不能修改表 -> 不变性，太棒了！下一步可能是将每个函数视为一个突变，将其应用于表以生成一个新函数：

```
f T -> T' 
```

这应该被理解为在表 T 上应用函数 f 以生成新表 T'。您也可以尝试客观化表数据的实际处理，并将其视为您应用或添加到表中的操作。

```
add(T, A) -> T' 
```

这里最棒的一点是，加法可以是减法，而不是为您提供一种简单的方法来模拟撤消。当您进入这种心态时，您的代码变得非常容易推理，因为您没有可以搞砸的状态。

下面是一个示例，说明如何在 Python 中以纯函数方式实现和处理表结构。恕我直言，Python 不是学习 FP 的最佳语言，因为它使命令式编程变得容易。我认为 Haskell、F# 或 Erlang 是更好的选择。

```
class Table(frozenset):
    def __new__(cls, names, rows):
        return frozenset.__new__(cls, rows)

    def __init__(self, names, rows):
        frozenset.__init__(self, rows)
        self.names = names

def add_column(rows, func):
    return [row + (func(row, idx),) for (idx, row) in enumerate(rows)]

def table_process(t, (name, func)):
    return Table(
        t.names + (name,),
        add_column(t, lambda row, idx: func(row))
        )

def table_filter(t, (name, func)):
    names = t.names
    idx = names.index(name)
    return Table(
        names,
        [row for row in t if func(row[idx])]
        )

def table_rank(t, name):
    names = t.names
    idx = names.index(name)
    rows = sorted(t, key = lambda row: row[idx])
    return Table(
        names + ('rank',),
        add_column(rows, lambda row, idx: idx)
        )

def table_print(t):
    format_row = lambda r: ' '.join('%15s' % c for c in r)
    print format_row(t.names)
    print '\n'.join(format_row(row) for row in t)

if __name__ == '__main__':
    from random import randint
    cols = ('c1', 'c2', 'c3')
    T = Table(
        cols,
        [tuple(randint(0, 9) for x in cols) for x in range(10)]
        )
    table_print(T)

    # Columns to add to the table, this is a perfect fit for a
    # reduce. I'd honestly use a boring for loop instead, but reduce
    # is a perfect example for how in FP data and code "becomes one."
    # In fact, this whole program could have been written as just one
    # big reduce.
    actions = [
        ('max', max),
        ('min', min),
        ('sum', sum),
        ('avg', lambda r: sum(r) / float(len(r)))
        ]
    T = reduce(table_process, actions, T)
    table_print(T)

    # Ranking is different because it requires an ordering, which a
    # table does not have.
    T2 = table_rank(T, 'sum')
    table_print(T2)

    # Simple where filter: select * from T2 where c2 < 5.
    T3 = table_filter(T2, ('c2', lambda c: c < 5))
    table_print(T3) 
```

# matlab - 是否可以更改maloglog 图的数据点大小？

> ID：12485593
> 
> 赞同：1
> 
> 时间：2012-09-18T21:48:39.860
> 
> 标签：matlab

是否可以在matlab中更改maloglog图的数据点大小？

我可以用`scatter(X,Y,S)`.

但是maloglog有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T23:09:13.940

当然，生成你的情节，说

```
h=maloglog(Red,Green,'title','Red vs Green','FactorLines',3,'LABELS',maStruct.Names); 
```

要将标记形状更改为`o`'s：

```
set(h,'Marker', 'o'); 
```

或者，根据您的问题，更改大小：

```
set(h, 'MarkerSize', 10) 
```

或者，将 10 设置为您喜欢的任何大小。

# javascript - 如何使图像出现在 Javascript 中

> ID：12485600
> 
> 赞同：2
> 
> 时间：2012-09-18T21:49:07.910
> 
> 标签：javascript, image, gallery

我对javascript不是很流利，我觉得这真的很基础，但我似乎无法在**任何地方**在线找到它。

我想创建一个链接，该链接将触发一个 javascript 函数，该函数使图像出现在单独的 div 中。不能在flash中，否则我对编码语言没有异议。

我有几张图片，所以我认为最好的方法是将它们全部叠加在一起，然后在每次点击它们的链接时增加 z-index，但你可能有一个更好的主意。

我真的只是想以某种方式创建一种不使用闪光灯的原始图片库，并在单击相应链接时在其 div 中显示照片。

提前致谢， 亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T21:55:56.553

正如 Jessegavin 所说（在[这里](https://stackoverflow.com/a/5454306/1406409)找到）

您可以使用 Javascript DOM API。特别是，查看 createElement() 方法。

您可以创建一个可重用的函数，该函数将创建一个像这样的图像......

```
function show_image(src, width, height, alt) {
  var img = document.createElement("img");
  img.src = src;
  img.width = width;
  img.height = height;
  img.alt = alt;

  // This next line will just add it to the <body> tag
  document.body.appendChild(img); 
} 
```

然后你可以像这样使用它......

```
<button onclick="show_image('http://google.com/images/logo.gif', 
  276,110, 'Google Logo");'>Add Google Logo</button> 
```

上面不应该有换行符，我添加了它以便它可以在不滚动的情况下显示查看 jsFiddle 上的工作示例：http: [//jsfiddle.net/Bc6Et/](http://jsfiddle.net/Bc6Et/)

这应该回答你的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T21:54:23.760

有大量的 javascript 库、插件（用于 jQuery）和其他解决此问题的方法。

我要做的第一件事是仔细阅读这样的网站，看看有什么可用的：[http ://sixrevisions.com/javascript/free_javascript_image_galleries/](http://sixrevisions.com/javascript/free_javascript_image_galleries/)

我以前用过这个，而且很简单： http: [//lokeshdhakar.com/projects/lightbox2/](http://lokeshdhakar.com/projects/lightbox2/)

一般来说，尽管您可以这样做`<a href="javascript: showImage()">Link</a>`并单击它将调用`showImage()`您在某处定义的javascript函数。然后分层 div 将按照您的描述工作。

# jquery-ui - 将可拖动的 jquery ui 与 jquery.gantt 集成（有效但会中断滚动）

> ID：12485605
> 
> 赞同：1
> 
> 时间：2012-09-18T21:49:22.453
> 
> 标签：jquery-ui, jquery-ui-draggable, gantt-chart

我在[这里](http://taitems.github.com/jQuery.Gantt/)`draggable`使用带有 jquery.gantt 的 jquery-ui 组件。我可以很容易地启用对项目的拖动，但这样做的问题是，一旦我们开始使用下面的滑块从左到右滚动图形，移动的元素将保持在它们所在的位置，而不是随图形滚动。`$('.ganttRed').draggable()`

我查看了源代码，据我了解`margin-left`，滚动期间正在更改；但`jquery-ui`使用该`left`属性并在`left`元素存在的情况下保持其位置。我的 CSS 知识就到此为止了，所以如果你们中的任何人愿意就如何解决这个问题提供任何建议；我将不胜感激。

我创建了一个小提琴来演示这个问题：http: [//jsfiddle.net/Y2cxa/](http://jsfiddle.net/Y2cxa/)。为了看到我所说的行为：

*   滚动图表（使用鼠标滚轮或底部的滑块）；事物的外观和行为应符合预期。
*   移动任何洋红色（-ish）条，然后滚动。

再次感谢您的宝贵时间，我们将不胜感激。

最好的祝福

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T14:23:35.450

您现在可能已经解决了这个问题或做了其他事情，但因为我也需要这个，所以我解决了它。

在这里为您提供解决方案：

[http://jsfiddle.net/Y2cxa/18/](http://jsfiddle.net/Y2cxa/18/)

首先，我只是将左值复制到 margin-left，然后完全删除了左值，但这导致了一些奇怪的数字。

为了解决这个问题，我将 left 的起始值与 left 的最终值进行了比较，并将相同的像素差异应用于左边距！

只需更换：

```
$('.ganttRed').draggable({axis:'x'}); 
```

和：

```
$('.ganttRed').draggable({
    axis:'x',
    start: function(event, ui) {
        $(this).data("startx",$(this).offset().left);
    },
    stop: function(event, ui) {
        var change = $(this).offset().left - $(this).data("startx");
        var value = $(this).css('margin-left');
        value = value.split("px");
        value = parseInt(value[0]) + change;
        $(this).css('margin-left', value);
        $(this).css('left', '');
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-12T09:32:55.280

我相信下面是一个更好的解决方案，我在我的应用程序中使用它

**用于垂直和水平拖动**

```
$('.ganttRed').draggable(
{
        start: function (event, ui) {
        $(this).data("startx", $(this).css('left').split("px")[0]);
        $(this).data("starty", $(this).css('top').split("px")[0]);
    },
    stop: function (event, ui) {
        var left = parseInt($(this).css('left').split("px")[0]);
        var changex = left - parseInt($(this).data("startx"));
        var top = parseInt($(this).css('top').split("px")[0]);
        top -= top % 24;
        $(this).css('top', top);
        var changey = top - parseInt($(this).data("starty"));
    }
}); 
```

`changex`,`changey`将在数据库更新时用于计算

**用于水平调整大小**

```
$(".ganttRed").resizable({ handles: 'e, w' }); 
```

# ssrs-2008 - 将 SSRS 报告部署到 Dynamics AX 2009 时出错

> ID：12485611
> 
> 赞同：1
> 
> 时间：2012-09-18T21:49:36.247
> 
> 标签：ssrs-2008, dynamics-ax-2009

我有一个非常简单的 Dynamics AX Reporting 项目，其数据集使用 Dynamics AX 数据源命中我在 AOT 中创建的自定义查询。报告在 VS2008 中成功构建，当我尝试部署报告时，返回错误“**部署意外失败并显示消息：以下组件尚未安装或配置不正确：报告扩展**”。“保存到 AOD”功能也返回“未知错误”。

VS2008 错误显示问题出在文件中引用 DeployToReportsServerTask 的行：Microsoft.Dynamics.Framework.Design.Reporting.Modeling.targets

![发生错误的第 374 行的代码片段](../Images/5cf85cb9c72dc487f9221a262eb84832.png)

在 AX 中，使用报告服务器表单（管理 > 设置 > 业务分析 > 报告服务 > 报告服务器），验证（按钮）返回“成功”消息。另外，我可以通过 IE 浏览服务器和本地 PC 上的报告目录。我的 AX 客户端配置也会启动并连接到正确的 AOS。

关于可能是什么问题的任何想法？不知道我还能检查什么。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T07:02:49.750

这有帮助吗？

> 然后登录到aos服务器。打开互联网浏览器。浏览报表服务器和管理器 url。如果您可以看到动态 ax 文件夹，请尝试进入该文件夹并手动浏览单个报告。如果您可以浏览，则 eixt 没有问题。只需重新启动报告服务器上的 iis。如果您可能无法浏览，则将特定端口添加到防火墙。或禁用防火墙。同时，您可以使用 NTLM 身份验证或 kerberos 身份验证。

来自： [http ://daynamicsaxaptatutorials.blogspot.no/2012/03/reports-get-build-up-secussfully-bot.html](http://daynamicsaxaptatutorials.blogspot.no/2012/03/reports-get-build-up-secussfully-bot.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T07:31:53.420

使用 Dynamics AX 配置实用程序，目标“业务连接器（仅限非交互式使用）”是否设置为指向正确的 AOS？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T15:14:19.967

问题是报告工具也必须安装在 AOS 服务器上（带有报告扩展）。报告工具只安装在我的开发箱上。此外，我的部署过程也不正确。在我的环境中正确的过程是：

(按照提示进行操作）。3) 在 IE 中打开并运行报告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-06T05:02:02.557

我有同样的错误，但我通过在管理模式下使用 VS 解决了这个问题，即以管理员身份打开 VS。

不知道如何，但它会帮助我。

高温高压

萨钦

# actionscript-3 - 将光标制作成锤子动画 ActionScript 3.0

> ID：12485614
> 
> 赞同：0
> 
> 时间：2012-09-18T21:49:48.943
> 
> 标签：actionscript-3, animation, cursor, movieclip

我制作了一个自定义光标 - 作为锤子，并希望在单击按钮时运行动画。当用户单击任何按钮时，锤子将击中（锤击）该按钮。我在 Cursor() 类中使用了 2 个关键帧来制作锤子动画，并在我的程序中使用了几种方法来实现它——比如 gotoAndStop()、play() 等。但没有任何效果......

因此，如果您向我展示解决此问题的方法，我将不胜感激。这是我的代码：

```
var menuCursor:MovieClip = new Cursor();
Mouse.hide();
menuCursor.mouseEnabled = false;
addEventListener(Event.ENTER_FRAME, cursorMenuMove);
menuCursor.gotoAndStop(1);
function cursorMenuMove(event:Event )
{
    menuCursor.x = mouseX;
    menuCursor.y = mouseY;
}

.
.
.

howToImageOn.addEventListener( MouseEvent.CLICK, run1HowTo );

.
.
.

function run1HowTo( event:MouseEvent )
{
       menuCursor.gotoAndStop(2);
   //    or   menuCursor.play();
    whackSound.play(0,1);
    menuMusicChannel.stop();
    howToImageOn.removeEventListener( MouseEvent.MOUSE_OUT, howTo1Out );
    playImageOff.removeEventListener( MouseEvent.MOUSE_OVER, play1Over );
    creditsImageOff.removeEventListener( MouseEvent.MOUSE_OVER, credits1Over );
    removeChild( playImageOff );
    removeChild(howToImageOn);
    removeChild( creditsImageOff);
    removeChild( menuCursor );
    gotoAndStop( "HowToPlay" );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T23:12:09.617

我从不喜欢使用 gotoAndStop 和 gotoAndPlay，所以我一直都是这样：

创建第一个包含非动画版本光标的 MovieClip/Sprite 和第二个包含动画版本（循环动画）的 MovieClip/Sprite，并在应该扩展 MovieClip 的自定义类 Cursor 中在它们之间切换 - 删除第一个，添加第二个 - 对于前任。点击后。通过这种方式，您可以轻松添加更多光标类型（和动画），甚至更轻松地在它们之间切换 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T19:07:16.793

我用这段代码解决了这个问题：

```
stage.addEventListener(MouseEvent.MOUSE_DOWN, down);
stage.addEventListener(MouseEvent.MOUSE_UP, up);

function down(e:MouseEvent){
    menuCursor.gotoAndStop(2);
}

function up(e:MouseEvent){
    menuCursor.gotoAndStop(1);
} 
```

# delphi - 使用按位/其他运算符的 Pascal 脚本回合

> ID：12485622
> 
> 赞同：4
> 
> 时间：2012-09-18T21:50:39.517
> 
> 标签：delphi, operators, bit-manipulation, rounding

编辑：

使用**shl**、**MOD**、**DIV**、**shr**或任何其他运算符。我无法获得条件工作。

在不断向上取整一个扩展的数字，例如

常数 aaa = 3.14; bbb = 3.14; // 向上取整

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T23:01:27.713

通常人们会使用`trunc()`or `round()`。如果这对您不起作用，我建议您尝试查找专门用于 PaxCompiler 或 PascalScript 的论坛。您不可能是第一个想要这样做的人，更熟悉这些编译器的人可能知道如何使用这些编译器解决问题。

我在[Free Pascal](http://www.freepascal.org)中尝试过它，它在那里工作。IIRC 它也适用于 Borland Delphi 和 Turbo Pascal（自从我用 Pascal 编程以来已经有好几年了，所以我可能是错的）。

如果以上都不起作用，那么您可以尝试将其放入全局变量中。即使全局变量不好，有时也是最不坏的事情。

# nhibernate - 如何使用 NHibernate 展平模型

> ID：12485623
> 
> 赞同：0
> 
> 时间：2012-09-18T21:50:41.297
> 
> 标签：nhibernate, nhibernate-mapping, one-to-many, many-to-one

假设我有三个表 Products、Languages 和 ProductTranslations，如下所示：

(1) 产品 ID
(1) 标准名称
(1) 价格

(2) 语言标识
(2) 语言名称

和

(3) ProductTranslationId
(3) ProductId
(3) LanguageId
(3) LocalName
(3) LocalDescription

在我的对象模型中，我需要一个包含以下内容的对象（单个类映射）

(3) ProductTranslationId
(2) 语言
(3) LocalName
(3) LocalDescription
(1) 价格

该对象仅用于显示，所以只读（不可变）就可以了。

ProductTranslationId 唯一标识一行。

如有必要，此对象还可以包含 LanguageID 和 ProductID 值。重要的特征是，这需要包含来自该一对多关系的 ONE 一侧的 Language 和 Price 值。

我可以看到如何使用多对一在 3 个单独的类中执行此操作，但是如何使用一个类执行此操作，其中 ProductTranslationId 是 <id> 值？

是否有不需要在数据库中创建视图的替代方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T10:14:22.437

## 选项1

```
// FluentNHibernate Mapping
public class ProductTranslationDtoMap : ClassMap<ProductTranslationDto>
{
    public ProductTranslationDtoMap()
    {
        ReadOnly();
        Table(" ProductTranslation");
        Id(x => x.Id, "ProductTranslationId");

        Map(x => x.Language).Formula("(SELECT l.LanguageName FROM Language l WHERE l.LanguageId = LanguageId)");  // simple and highly portable sql formula
        Map(x => x.LocalName);
        Map(x => x.LocalDescription);
        Map(x => x.Price).Formula("(SELECT p.Price FROM Products p WHERE p.ProductId =  ProductId)");
    }
} 
```

选项 2

```
Product prod = null;
Language lang = null;
TranslationDto alias = null;
var results = session.QueryOver<ProductTranslation>()
    .JoinAlias(pt => pt.Language, () => lang)
    .JoinAlias(pt => pt.Product, () => prod)
    .SelectList(list => list
        .Select(pt => pt.Id).WithAlias(() => alias.ProductTranslationId)
        .Select(() => lang.Name).WithAlias(() => alias.Language)
        ...)
    .TransformUsing(Transformers.AliasToBean<TranslationDto>())
    .List<TranslationDto>(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T10:29:51.053

除了使用 NHibernate 映射，您还可以使用像 AutoMapper 这样的类映射器来创建复杂对象图的平面表示。如果您的数据库架构发生更改，其优点是可以减少维护一个休眠映射（尽管 Firo 的流利变体提供编译器语法检查）。缺点当然是速度，因为您首先必须让 nhibernate 创建复杂的对象图，然后将该图转换为平面对象。如果您只需要这个平面对象，则最好使用单个 NH 映射。如果您考虑创建更多视图，类映射器可能值得一看。

# c# - .NET Windows Store 应用程序中 CultureInfo.GetCultures 的替换

> ID：12485626
> 
> 赞同：3
> 
> 时间：2012-09-18T21:50:55.293
> 
> 标签：c#, windows-runtime, microsoft-metro, windows-store-apps

CultureInfo.GetCultures 在用于 Windows 应用商店应用的 .NET API 中不存在。我们怎么能阅读所有可用的文化呢？

我知道语言列表和主要应用程序语言。我可以通过这种方式阅读应用程序可用的所有语言。但我需要阅读系统上可用的所有文化（语言）。以前使用 CultureInfo.GetCultures 很容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T09:26:49.787

詹姆斯的评论为我指明了正确的方向。这是我开发的代码。我使用单元测试检查了代码，以确保返回的中性、特定和所有文化与 CultureInfo.GetCultures 返回的文化相同（它们确实是:-)）。

```
public class LocalesRetrievalException : Exception
{
    public LocalesRetrievalException(string message)
        : base(message)
    {
    }
}

public static class CultureHelper
{
    #region Windows API

    private delegate bool EnumLocalesProcExDelegate(
       [MarshalAs(UnmanagedType.LPWStr)]String lpLocaleString,
       LocaleType dwFlags, int lParam);

    [DllImport(@"kernel32.dll", SetLastError = true, CharSet = CharSet.Unicode)]
    private static extern bool EnumSystemLocalesEx(EnumLocalesProcExDelegate pEnumProcEx,
       LocaleType dwFlags, int lParam, IntPtr lpReserved);

    private enum LocaleType : uint
    {
        LocaleAll = 0x00000000,             // Enumerate all named based locales
        LocaleWindows = 0x00000001,         // Shipped locales and/or replacements for them
        LocaleSupplemental = 0x00000002,    // Supplemental locales only
        LocaleAlternateSorts = 0x00000004,  // Alternate sort locales
        LocaleNeutralData = 0x00000010,     // Locales that are "neutral" (language only, region data is default)
        LocaleSpecificData = 0x00000020,    // Locales that contain language and region data
    }

    #endregion

    public enum CultureTypes : uint
    {
        SpecificCultures = LocaleType.LocaleSpecificData,
        NeutralCultures = LocaleType.LocaleNeutralData,
        AllCultures = LocaleType.LocaleWindows
    }

    public static IReadOnlyCollection<CultureInfo> GetCultures(
       CultureTypes cultureTypes)
    {
        List<CultureInfo> cultures = new List<CultureInfo>();
        EnumLocalesProcExDelegate enumCallback = (locale, flags, lParam) =>
        {
            try
            {
                cultures.Add(new CultureInfo(locale));
            }
            catch (CultureNotFoundException)
            {
                // This culture is not supported by .NET (not happened so far)
                // Must be ignored.
            }
            return true;
        };

        if (EnumSystemLocalesEx(enumCallback, (LocaleType)cultureTypes, 0,
           (IntPtr)0) == false)
        {
            int errorCode = Marshal.GetLastWin32Error();
            throw new LocalesRetrievalException("Win32 error " + errorCode +
               " while trying to get the Windows locales");
        }

        // Add the two neutral cultures that Windows misses 
        // (CultureInfo.GetCultures adds them also):
        if (cultureTypes == CultureTypes.NeutralCultures ||
           cultureTypes == CultureTypes.AllCultures)
        {
            cultures.Add(new CultureInfo("zh-CHS"));
            cultures.Add(new CultureInfo("zh-CHT"));
        }

        return new ReadOnlyCollection<CultureInfo>(cultures);
    }
} 
```

# javascript - ajax论坛上的无状态（pushState？）后退按钮

> ID：12485628
> 
> 赞同：1
> 
> 时间：2012-09-18T21:50:57.540
> 
> 标签：javascript, ajax

我需要一种无状态的方式来实现 ajax 论坛中的后退按钮功能，这样如果用户在主题 ajax 页面的第 2 页上，然后点击消息 - 当用户然后点击后退按钮时，他们可以返回主题 ajax 页面上的消息点。- 您的帮助将不胜感激。

::请记住我想要一种无状态的方式来做到这一点，这样它就可以在客户端完成::

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:58:43.327

您唯一的选择是实现客户端路由机制，您可以通过在更改*state*`#`时更改 url来实现。例如，您的主题页面有一个类似的 url ，每当用户单击消息时，您就会将（客户端）重定向到.*`yourforum.html#topics``yourforum.html#message/3`*

 *你的 JavaScript 代码应该监听这些哈希变化，并通过加载主题/消息做出相应的反应。

客户端路由有两种方式：

*   像我做的例子一样改变哈希
*   HTML5 推送状态

许多现代 JavaScript 框架，如 Backbone、JavaScriptMVC 等……都支持路由。所以你可以看看那些。[TodoMVC](http://todomvc.com)可能是一个很好的起点。否则，请尝试谷歌搜索一些 jQuery 插件，它们可以为您提供这种功能。*

# php - 添加谷歌可信商店徽章

> ID：12485629
> 
> 赞同：0
> 
> 时间：2012-09-18T21:50:58.537
> 
> 标签：php, javascript, magento, magento-1.4, magento-1.6

我已按照此处的步骤 [将 Google 信任徽章添加到 Magento](https://stackoverflow.com/questions/10939583/add-google-trust-badge-to-magento)

然后在这里： http: [//www.magentocommerce.com/magento-connect/google-trusted-stores.html](http://www.magentocommerce.com/magento-connect/google-trusted-stores.html)

在所有页面中，第一个 javascript 部分显示正常。在结帐成功页面中，它没有显示正常的代码。（见下面的更新）我知道我正在编辑正确的文件，因为我在 success.phtml 中输入了静态文本但是在订购之后，我看不到应该生成的生成的 html。

我将该代码放在文件的末尾。

```
<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2011 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
123
<div class="page-title">
    <h1><?php echo $this->__('Your order has been received') ?></h1>
</div>
<?php echo $this->getMessagesBlock()->getGroupedHtml() ?>
<h2 class="sub-title"><?php echo $this->__('Thank you for your purchase!') ?></h2>

<?php if ($this->getOrderId()):?>
<?php if ($this->getCanViewOrder()) :?>
    <p><?php echo $this->__('Your order # is: %s.', sprintf('<a href="%s">%s</a>', $this->escapeHtml($this->getViewOrderUrl()), $this->escapeHtml($this->getOrderId()))) ?></p>
<?php  else :?>
    <p><?php echo $this->__('Your order # is: %s.', $this->escapeHtml($this->getOrderId())) ?></p>
<?php endif;?>
    <p><?php echo $this->__('You will receive an order confirmation email with details of your order and a link to track its progress.') ?></p>
<?php if ($this->getCanViewOrder() && $this->getCanPrintOrder()) :?>
    <p>
        <?php echo $this->__('Click <a href="%s" onclick="this.target=\'_blank\'">here to print</a> a copy of your order confirmation.', $this->getPrintUrl()) ?>
        <?php echo $this->getChildHtml() ?>
    </p>
<?php endif;?>
<?php endif;?>

<?php if ($this->getAgreementRefId()): ?>
    <p><?php echo $this->__('Your billing agreement # is: %s.', sprintf('<a href="%s">%s</a>', $this->escapeHtml($this->getAgreementUrl()), $this->escapeHtml($this->getAgreementRefId())))?></p>
<?php endif;?>

<?php if ($profiles = $this->getRecurringProfiles()):?>
<p><?php echo $this->__('Your recurring payment profiles:'); ?></p>
<ul class="disc">
<?php foreach($profiles as $profile):?>
<?php $profileIdHtml = ($this->getCanViewProfiles() ? sprintf('<a href="%s">%s</a>', $this->escapeHtml($this->getProfileUrl($profile)), $this->escapeHtml($this->getObjectData($profile, 'reference_id'))) : $this->escapeHtml($this->getObjectData($profile, 'reference_id')));?>
    <li><?php echo $this->__('Payment profile # %s: "%s".', $profileIdHtml, $this->escapeHtml($this->getObjectData($profile, 'schedule_description')))?></li>
<?php endforeach;?>
</ul>
<?php endif;?>

<div class="buttons-set">
    <button type="button" class="button" title="<?php echo $this->__('Continue Shopping') ?>" onclick="window.location='<?php echo $this->getUrl() ?>'"><span><span><?php echo $this->__('Continue Shopping') ?></span></span></button>
</div>

<script type="text/javascript">
<!--
/* NexTag ROI Optimizer Data */
var id = '3551264';
var rev = '<<?php echo Mage::getSingleton('core/session')->getScriptRevenue(); ?>>';
var order = '<<?php echo $this->getOrderId(); ?>>';
var cats = '<?php echo Mage::getSingleton('core/session')->getScriptCats(); ?>';
var prods = '<?php echo Mage::getSingleton('core/session')->getScriptProds(); ?>';
var units = '<?php echo Mage::getSingleton('core/session')->getScriptUnits(); ?>';
//-->
</script>
<script type="text/javascript" src="https://imgsrv.nextag.com/imagefiles/includes/roitrack.js"></script>

<?php 
$order = Mage::getModel('sales/order')->loadByIncrementId(Mage::getSingleton('checkout/session')->getLastRealOrderId()); 
$amount = number_format($order->getGrandTotal(),2); 
?> 

<?php
    $orderId = $this->getOrderId();
    $order = Mage::getModel('sales/order')->loadByIncrementId($orderId);
    $customer = Mage::getModel('customer/customer')->load($order->getCustomerId());
    $address = $order->getShippingAddress();
    $backorder = false; // some backorder logic
    $download = false; // some download logic
    $shipDate = new Zend_Date(); // some logic to determine ship date
?>
<!-- START Trusted Stores Order -->
<div id="gts-order" style="display:none;">

<!-- start order and merchant information -->
<span id="gts-o-id"><?php echo $orderId; ?></span>
<span id="gts-o-domain">{www.theprinterdepo.com}</span>
<span id="gts-o-email"><?php echo htmlentities($customer->getEmail()); ?></span>
<span id="gts-o-country"><?php echo htmlentities($address->getCountryId()); ?></span>
<span id="gts-o-currency">USD</span>
<span id="gts-o-total"><?php echo $order->getGrandTotal(); ?></span>
<span id="gts-o-discounts">-<?php echo $order->getDiscountAmount(); ?></span>
<span id="gts-o-shipping-total"><?php echo $order->getShippingAmount(); ?></span>
<span id="gts-o-tax-total"><?php echo $order->getTaxAmount(); ?></span>
<span id="gts-o-est-ship-date"><?php echo $shipDate->toString('yyyy-MM-dd'); ?></span>
<span id="gts-o-has-preorder"><?php echo $backorder ? 'Y' : 'N'; ?></span>
<span id="gts-o-has-digital"><?php echo $download ? 'Y' : 'N'; ?></span>
<!-- end order and merchant information -->

<!-- start repeated item specific information -->
<?php foreach ($order->getAllItems() as $item): ?>
<span class="gts-item">
<span class="gts-i-name"><?php echo htmlentities($item->getName()); ?></span>
<span class="gts-i-price"><?php echo $item->getBasePrice(); ?></span>
<span class="gts-i-quantity"><?php echo (int)$item->getQtyOrdered(); ?></span>
<span class="gts-i-prodsearch-country">US</span>
<span class="gts-i-prodsearch-language">en</span>
</span>
<?php endforeach; ?>
<!-- end repeated item specific information -->

</div>
<!-- END Trusted Stores --> 
```

**更新：** 我删除了第一个链接中显示的代码，并安装了 magento 扩展程序，该扩展程序应自动将代码插入需要的位置。在任何页面和订单成功页面检查html后，我可以看到代码确实生成了，我看不到谷歌所说的验证栏。

（我仍然看不到徽章）

很奇怪，当我右键单击查看源代码时，我看不到 hte html 代码，但是如果用 firebug lite 检查代码就在那里

```
<div id="gts-order" style="display: none; ">
<span id="gts-o-id">900001439</span>
<span id="gts-o-domain">{www.theprinterdepo.com}</span>
<span id="gts-o-email">sam.x.x@outlook.com</span>
<span id="gts-o-country">US</span>
<span id="gts-o-currency">USD</span>
<span id="gts-o-total">449.8400</span>
<span id="gts-o-discounts">-0.0000</span>
<span id="gts-o-shipping-total">34.8500</span>
<span id="gts-o-tax-total">0.0000</span>
<span id="gts-o-est-ship-date">2012-09-18</span>
<span id="gts-o-has-preorder">N</span>
<span id="gts-o-has-digital">N</span>
<span class="gts-item">
<span class="gts-i-name">HP LaserJet Pro 100 M175nw MFP Printer</span>
<span class="gts-i-price">414.9900</span>
<span class="gts-i-quantity">1</span>
<span class="gts-i-prodsearch-country">US</span>
<span class="gts-i-prodsearch-language">en</span>
</span>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T20:34:44.447

这只能在美国 IP 地址中完成，否则不会出现验证工具栏和预览徽章。我连接到我们的桌面，然后我可以进行所有验证。

# html - margin-right: -100% 在 1024px 宽显示器上在 IE8/9 中留下巨大空间

> ID：12485634
> 
> 赞同：0
> 
> 时间：2012-09-18T21:51:23.263
> 
> 标签：html, css

我在 Drupal 中使用 Flexslider 以及带有 Omega 3 主题（html5+960 网格）的 Views Slideshow，但我不确定这个问题是否重要。

[在 IE8/9 的这个页面上](http://test.kreesindustrial.com)，当在 1024 像素宽的显示器上查看时，它在右侧留下了一个巨大的空白。[请参阅此屏幕截图](http://ubuntuone.com/2sTasFQUv32yzyznTy8WLL)。

我怀疑它是 flexslider js，因为它在页面加载后添加了负边距。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T17:02:57.553

是 flex-control-nav 的宽度和定位。原来它也发生在 Chrome 上，我只是认为它是 IE，因为虚拟机处于该分辨率。

[Outline Block Elements 小书签](http://aymanh.com/css-debugging-bookmarklets)是真正拯救了这一天的东西，事实证明，[这个](https://stackoverflow.com/questions/12488950/unwanted-white-margin-on-right-side-of-screen-behaves-differently-in-chrome-ff/12498924#12498924)几乎相同的问题是解决这个问题的动机。

# php - ajax jquery php 提交

> ID：12485635
> 
> 赞同：1
> 
> 时间：2012-09-18T21:51:24.557
> 
> 标签：php, jquery, ajax

我在 php 中有一个简单的表单，它有一个用户文本框和传递文本框，我们称之为 login.php。我有另一个 php 页面，我们称之为 sendtologin.php，我想通过 jquery ajax“发送”凭据以发布到 login.php。login.php 在 server1 上，而 sendtologin.php 在 server2 上。当我尝试加载 sendtologin.php 时，我得到状态代码 0 和错误。这是我的脚本。

```
$(document).ready(function () {
        $.ajax({
            type: "POST",
            url: "http://server1/login.cgi",
            data: { lang_changed: "no", username: "me", password: "me" },
            success: function (data) { alert("success!"); },
            error: function (request, type, errorThrown) {
                alert("request: " + request.status + 
                      "\nrequestText: " + request.statusText +
                      "\nType: " + type + 
                      "\nException: " + errorThrown); }
        });
    }); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:22:40.087

您最好的选择是将登录凭据传递到您的“login.php”（如果它与您的 ajax 调用位于同一服务器上），然后使用 PHP 的 cURL 函数将发布的变量传递给您的第二个域的“login2.php”。

我经常使用这种网关/直通技术，它可以解决那些讨厌的跨域策略问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:28:18.953

我也遇到了这个问题，问题是出于安全原因，Ajax 调用的目的是在单个服务器上工作，因此当您将调用发送到另一台服务器时，您不会收到答案，因此“成功”的方法是行不通的。这并不意味着 server1 没有收到数据，但您无法验证它是否正确。

另一种解决方案是，如果您在 server1 上的数据库上有登录信息，您可以使用 php 连接到数据库并授予对原始服务器的访问权限，然后您可以根据该数据库连接进行所有 ajax 调用。

# joomla - VirtueMart 自定义结帐步骤

> ID：12485641
> 
> 赞同：2
> 
> 时间：2012-09-18T21:52:03.840
> 
> 标签：joomla, virtuemart

我需要帮助编辑 VirteuMart 2.0.10 结帐步骤。而不是默认的东西，我需要的是收集用户信息，如姓名、地址、电话号码等以及购物车中物品的详细信息。然后向用户显示有关他们如何通过本地移动货币解决方案进行支付的信息。

我需要这样，因为目前没有用于上述支付解决方案的 VM 插件或扩展。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T01:36:34.500

我不确定这是否是您所追求的，但如果您希望在结帐时使用 1-2-3-4 步骤删除“结帐栏”，这在设置中很简单。

转到管理 > 配置。选择“结帐”选项卡。取消选择“启用结帐栏”选项，然后直接选择您希望在结帐时启用的选项。

希望这可以帮助 ：）

# android - Android RSS 阅读器在启动时崩溃

> ID：12485642
> 
> 赞同：-2
> 
> 时间：2012-09-18T21:52:11.870
> 
> 标签：android, rss

我正在为 Android 开发一个简单的 RSS 阅读器。这是我的代码：

```
package com.example.rssreader;

public class MainActivity extends ListActivity {

List headlines;
List links;
static final int DIALOG_ERROR_CONNECTION = 1;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    if (!isOnline(this)) {
        showDialog(DIALOG_ERROR_CONNECTION);
    } else {

    // initializing instance variables
    headlines = new ArrayList();
    links = new ArrayList();

    try {
        URL url = new URL("http://feeds.pcworld.com/pcworld/latestnews");

        XmlPullParserFactory factory = XmlPullParserFactory.newInstance();
        factory.setNamespaceAware(false);
        XmlPullParser xpp = factory.newPullParser();

        // We will get the XML from an input stream
        xpp.setInput(getInputStream(url), "UTF_8");

        /* We will parse the XML content looking for the <title> tag which appears inside the <item> tag.
         * However, we should take in consideration that the rss feed name also is enclosed in a <title> tag.
         * As we know, every feed begins with these lines: <channel><title>Feed_Name</title>...
         * so we should skip the <title> tag which is a child of <channel> tag,
         * and take in consideration only <title> tag which is a child of <item>
         * 
         * In order to achieve this, we will make use of a boolean variable.
         */

        boolean insideItem = false;

        // Returns the type of current event: START_TAG, END_TAG, etc..
        int eventType = xpp.getEventType();
        while (eventType != XmlPullParser.END_DOCUMENT) {
            if (eventType == XmlPullParser.START_TAG) {

                if (xpp.getName().equalsIgnoreCase("item")) {
                    insideItem = true;
                } else if (xpp.getName().equalsIgnoreCase("title")) {
                    if (insideItem)
                        headlines.add(xpp.nextText()); // extract the headline
                } else if (xpp.getName().equalsIgnoreCase("link")) {
                    if (insideItem)
                        links.add(xpp.nextText()); // extract the link of article
                }
            } else if (eventType == XmlPullParser.END_TAG && xpp.getName().equalsIgnoreCase("item")) {
                insideItem = false;
            }

            eventType = xpp.next(); // move to next element
        }
    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (XmlPullParserException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    // Binding data
    ArrayAdapter adapter = new ArrayAdapter(this, android.R.layout.simple_list_item_1, headlines);

    setListAdapter(adapter);

    }
}

public InputStream getInputStream(URL url) {
    try {
        return url.openConnection().getInputStream();
    } catch (IOException e) {
        return null;
    }
}

public boolean isOnline(Context c) {
    ConnectivityManager cm = (ConnectivityManager) c.getSystemService(Context.CONNECTIVITY_SERVICE);
    NetworkInfo ni = cm.getActiveNetworkInfo();

    if(ni!=null && ni.isConnected())
        return true;
    else
        return false;
}

@Override
protected Dialog onCreateDialog(int id) {
    Dialog dialog = null;
    switch(id) {
    case DIALOG_ERROR_CONNECTION:
        AlertDialog.Builder errorDialog = new AlertDialog.Builder(this);
        errorDialog.setTitle("Error");
        errorDialog.setMessage("No internet connection.");
        errorDialog.setNeutralButton("OK", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int id) {
                dialog.dismiss();
            }
        });

        AlertDialog errorAlert = errorDialog.create();
        return errorAlert;

        default:
            break;
    }
    return dialog;
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    Uri uri = Uri.parse((String) links.get(position));
    Intent intent = new Intent(Intent.ACTION_VIEW, uri);
    startActivity(intent);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}
} 
```

我在代码中没有任何错误，但是当我尝试启动它时，它崩溃了。我不知道为什么。这是我的日志：

```
09-19 09:49:18.207: E/AndroidRuntime(3360): FATAL EXCEPTION: main
09-19 09:49:18.207: E/AndroidRuntime(3360): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.rssreader/com.example.rssreader.MainActivity}: android.os.NetworkOnMainThreadException
09-19 09:49:18.207: E/AndroidRuntime(3360):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1967)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1992)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at android.app.ActivityThread.access$600(ActivityThread.java:127)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1158)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at android.os.Looper.loop(Looper.java:137)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at android.app.ActivityThread.main(ActivityThread.java:4441)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at java.lang.reflect.Method.invokeNative(Native Method)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at java.lang.reflect.Method.invoke(Method.java:511)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at dalvik.system.NativeStart.main(Native Method)
09-19 09:49:18.207: E/AndroidRuntime(3360): Caused by: android.os.NetworkOnMainThreadException
09-19 09:49:18.207: E/AndroidRuntime(3360):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1108)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:84)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.io.IoBridge.connectErrno(IoBridge.java:133)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.io.IoBridge.connect(IoBridge.java:118)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:459)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at java.net.Socket.connect(Socket.java:849)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.net.http.HttpConnection.<init>(HttpConnection.java:77)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:351)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:86)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.net.http.HttpConnection.connect(HttpConnection.java:117)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:308)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.net.http.HttpEngine.connect(HttpEngine.java:303)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:282)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:232)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.net.http.HttpURLConnectionImpl.getResponse(HttpURLConnectionImpl.java:273)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at libcore.net.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java:168)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at com.example.rssreader.MainActivity.getInputStream(MainActivity.java:108)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at com.example.rssreader.MainActivity.onCreate(MainActivity.java:57)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at android.app.Activity.performCreate(Activity.java:4465)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
09-19 09:49:18.207: E/AndroidRuntime(3360):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1931)
09-19 09:49:18.207: E/AndroidRuntime(3360):     ... 11 more 
```

我希望你们中的一些人可以帮助我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T07:54:56.037

这个问题有两个解决方案。

1）不要在主 UI 线程中编写网络调用，为此使用异步任务。

2) 在 setContentView(R.layout.activity_main); 之后将以下代码写入 MainActivity 文件；

```
if (android.os.Build.VERSION.SDK_INT > 9) {
    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:00:30.733

```
Caused by: java.lang.SecurityException: ConnectivityService: Neither user 10111 nor current process has android.permission.ACCESS_NETWORK_STATE. 
```

添加权限：

```
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

# java - 为新的 JVM 语言重用 Java 编译器后端的有效方法

> ID：12485643
> 
> 赞同：4
> 
> 时间：2012-09-18T21:52:14.830
> 
> 标签：java, compiler-construction, programming-languages

我正在编写一种针对 JVM 的语言，我目前正在将编译器放在一起。对我来说很明显，从逻辑上讲，在创建字节码方面，我的新语言与 Java 有许多相同的需求。仅举几个例子：

*   找出以点分隔的标识符序列指的是什么：abc 可以指局部变量 a、字段 a、类 a 或类 ab
*   转换算术运算的原始类型：对于 intVar*doubleVar，必须将 intVar 强制转换为 double
*   找到一组参数的匹配方法：具有正确的继承和与上面相同的原始转换
*   在相关说明中，自动装箱
*   泛型类型检查，例如是否`List<X<? super Y>> l = new List<X<Z>>();` 兼容

可能还有更多，而且我不知何故不想重新发明这些轮子（制作一门新语言，当然我已经在重新发明*一些*轮子了......），所以我想知道重用的最佳方法是什么（部分) 一个现有的 Java 编译器，将其传递给它需要弄清楚上述内容的 AST 片段。

我确实已经有了词法分析器和解析器（ANTLR），所以我真的在寻找关于那里有哪些编译器的建议，这样我就可以相对容易地使用它们（例如，我对 ECJ 进行了一些研究，但是如果有人告诉我它不能满足我的要求，或者另一个编译器会更容易使用，那就太好了）。

总结一个明确的问题：哪些 Java 编译器具有易于访问的后端，适合与非 Java JVM 语言的前端一起使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T06:48:11.163

以下是我在阅读学术论文时听说的两个可扩展编译器后端：

*   [多语言可扩展编译器框架](http://www.cs.cornell.edu/Projects/polyglot/)
*   [加斯特加](http://jastadd.org/web/jastaddj/)

对于特定领域的语言工程，我建议

*   [Xtext](http://www.eclipse.org/Xtext/)，例如[Xtend](http://www.eclipse.org/xtend/)，Java 的一种变体

这些项目看起来很成熟。我从来没有仔细看过他们，但我真的很想;）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T00:06:52.427

冒着有点迟钝的风险，我的答案是 Scala。

Scala 是一种基于 JVM 的语言，在最新版本中[具有宏系统](http://scalamacros.org)。宏（当它们比与 C 相关的宏更强大时）是一种在现有语言之上构建特定领域语言的技术，无需从头开始。宏系统允许您使用现有语言编写代码，并通过新结构进行增强，并将新结构编译成基础语言。

如果您想直接从 Java 构建，可能值得考虑[Java Syntax Extender](http://jse.sourceforge.net/)，但是 JSE 没有被广泛使用，并且可能非常粗糙。（事实上​​，可能还有我没听说过的更成熟的 Java 宏系统。）

# actionscript-3 - ActionScript 3：找不到上传的文件

> ID：12485645
> 
> 赞同：0
> 
> 时间：2012-09-18T21:52:36.103
> 
> 标签：actionscript-3, file-upload, actionscript, file-io

这是我的第一个**ActionScript 3**应用程序。它应该**将数据上传到特定位置**，该位置应该是 www 根位置 - upload.php 所在的位置。

运行 ActionScript 应用程序后，我可以选择文件，我可以看到正在上传数据，但**我找不到它**。

请你好心，帮我了解发生了什么，我怎样才能找到上传的数据？我检查了两个：临时文件位置和目标目的地。

*这是动作脚本代码：*

```
 package {
    import flash.display.Sprite;
    import flash.events.*;
    import flash.net.*;
    import flash.text.*;
    public class ch30ex2 extends Sprite {
        protected var fileRef:FileReference;
        protected var uploadButton:TestButton;
        protected var tf:TextField;
        protected const YOUR_UPLOAD_URL:String = "http://localhost/Saifa/www/upload.php";

        public function ch30ex2() {
            fileRef = new FileReference();
            fileRef.addEventListener(Event.SELECT, selectHandler);
            fileRef.addEventListener(Event.CANCEL, cancelHandler);
            fileRef.addEventListener(ProgressEvent.PROGRESS, progressHandler);
            fileRef.addEventListener(IOErrorEvent.IO_ERROR, errorHandler);
            fileRef.addEventListener(SecurityErrorEvent.SECURITY_ERROR, errorHandler);
            fileRef.addEventListener(Event.COMPLETE, completeHandler);

            var btn:TestButton;
            btn = new TestButton(100, 25, "Browse...");
            btn.addEventListener(MouseEvent.CLICK, function(event:Event):void {
                fileRef.browse();
            });
            btn.x = btn.y = 20;
            addChild(btn);

            uploadButton = btn = new TestButton(100, 25, "Upload");
            btn.addEventListener(MouseEvent.CLICK, function(event:Event):void {
                fileRef.upload(new URLRequest(YOUR_UPLOAD_URL));
            });
            btn.x = 20; btn.y = 55;
            addChild(btn);

            tf = new TextField();
            tf.defaultTextFormat = new TextFormat("_sans", 11, 0);
            tf.multiline = tf.wordWrap = true;
            tf.autoSize = TextFieldAutoSize.LEFT;
            tf.width = 300; tf.x = 130; tf.y = 58;
            addChild(tf);

            cancelHandler(null);
        }
        protected function selectHandler(event:Event):void {
            tf.text = fileRef.name;
            uploadButton.mouseEnabled = uploadButton.tabEnabled = true;
            uploadButton.alpha = 1;
        }
        protected function cancelHandler(event:Event):void {
            tf.text = "";
            uploadButton.mouseEnabled = uploadButton.tabEnabled = false;
            uploadButton.alpha = 0.3;
        }
        protected function progressHandler(event:ProgressEvent):void {
            tf.text = "Uploading " + 
                event.bytesLoaded + " / " + event.bytesTotal + "bytes ...";
        }
        protected function errorHandler(event:ErrorEvent):void {
            tf.text = event.text;
        }
        protected function completeHandler(event:Event):void {
            tf.text = "Upload complete!";
        }
    }
}
import flash.display.*;
import flash.text.*;
class TestButton extends Sprite {
    public var label:TextField;
    public function TestButton(w:Number, h:Number, labelText:String) {
        graphics.lineStyle(0.5, 0, 0, true);
        graphics.beginFill(0xa0a0a0);
        graphics.drawRoundRect(0, 0, w, h, 8);
        label = new TextField();
        addChild(label);
        label.defaultTextFormat = new TextFormat("_sans", 11, 0, true, false,
            false, null, null, "center");
        label.width = w;
        label.height = h;
        label.text = labelText;
        label.y = (h - label.textHeight)/2 - 2;
        buttonMode = true;
        mouseChildren = false;
    }
} 
```

*这是 PHP 代码，它应该复制临时上传的文件：*

```
<?php
move_uploaded_file($_FILES[‘Filedata’][‘tmp_name’], ‘./‘.time().$_FILES[‘Filedata’][‘name’]);
?> 
```

*所有代码均来自[ActionScript Bible](http://actionscriptbible.com/) book*

我想请教以下内容：

*   **我的问题的可能根源是什么？**
*   **看起来我的代码正确吗？它由 FlashBuilder 编译，没有问题**
*   **如何确定问题的根源？**
*   **如果您有一个运行 ActionScript + PHP 应用程序的示例，我会很高兴看到它。**

当我花了几个小时尝试各种事情和组合时，我希望有人可能遇到过类似的问题。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:16:52.333

# selenium-webdriver - 如何在 Selenium WebDriver (Java) 中同时取消选中多个复选框

> ID：12485650
> 
> 赞同：1
> 
> 时间：2012-09-18T21:53:17.150
> 
> 标签：selenium-webdriver

我试图在 Java 中的 Selenium WebDriver 中同时取消选中多个复选框。我尝试了以下建议：

[Selenium 复选框属性“已选中”](https://stackoverflow.com/questions/8187772/selenium-checkbox-attribute-checked)

但是，一次只能取消选中一个复选框。

我希望能够同时取消选中多个复选框。复选框都有不同的 id。

感谢您的任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T22:31:13.943

我能够在Java中解决这个问题。替别人发帖。

```
WebElement parent = driver.findElement(By.xpath("<enter parent xpath>"));  
List<WebElement> children = parent.findElements(By.cssSelector("input:checked[type='checkbox']"));  
for (int i = 0; i < children.size(); i++) { children.get(i).click(); } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T10:35:38.170

```
WE can use as well using "foreach" clause in jaca example like

Webelement parent = driver.findElement(By.xpath("<enter parent xpath>"));  

List<WebElement> children = parent.findElements(By.cssSelector("input:checked[type='checkbox']"));  

foreach(Webelement we : children)
{
we.click()
} 
```

# java - 在 Java 中在运行时合成新方法？

> ID：12485657
> 
> 赞同：1
> 
> 时间：2012-09-18T21:54:15.447
> 
> 标签：java

> **可能重复：**
> [Java 类可以在运行时向自身添加方法吗？](https://stackoverflow.com/questions/6680674/can-a-java-class-add-a-method-to-itself-at-runtime)

是否可以在运行时为 Java 中的类合成新方法？有没有图书馆可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:04:28.697

进入一个已经加载的类？据我所知不是。

但是，您可能有兴趣生成一个新类。我看到两个选项：

*   我最近做了一个项目，它基于包含代码的字符串生成一个类，并将其加载到系统中，并运行它的主要方法。但是，这需要安装JDK =高度不可靠
*   通过 BCEL。这也有坏处，但总体上似乎更好。它要求您事先拥有该方法的字节码。现在你可以做一些诡计，例如，制作一个方法

像这样：

```
public static void printTest() {
    System.out.println("Hey!");
} 
```

然后查看字节码，看看 ConstantPool 中的“嘿！” 存储，然后获取该方法的字节码，将其缓存到一个字节数组中，然后使用预定义的字节 + 常量池（您之前检查过）动态创建一个方法，并使用您的字符串修改常量池。尽管对于更复杂的方法，这将变得非常棘手（注意：可以执行相同的操作来更改它调用的方法或获取的字段，例如更改为 err）

由于据我所知没有任何好的选择，所以这些是你最好的选择

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T22:31:49.033

除了字节码工程库，如果你的类有接口，你可以使用 Java 的`Proxy`类。

带接口：

```
public interface Foo {
    void bar();
} 
```

具体类：

```
class FooImpl {
    public void bar() {
        System.out.println("foo bar");
    }
} 
```

要处理调用的方法，请使用[`InvocationHandler`](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/InvocationHandler.html)：

```
class FooInvocationHandler implements InvocationHandler {

    private Foo foo;

    FooInvocationHandler(Foo foo) {
        this.foo = foo;
    }

    public Object invoke(Object proxy, Method method, Object[] args) throws Exception {
        if (method.getName().equals("bar"))
            System.out.println("foo me");
            // return null if you don't want to invoke the method below
        }
        return method.invoke(foo, args); // Calls the original method
    }
} 
```

然后使用以下方法创建一个`FooFactory`来生成和包装`FooImpl`实例[`Proxy`](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Proxy.html)：

```
public class FooFactory {
    public static Foo createFoo(...) {
        Foo foo = new FooImpl(...);
        foo = Proxy.newProxyInstance(Foo.class.getClassLoader(),
                new Class[] { Foo.class },
                new FooInvocationHandler(foo));
        return foo;
    }
} 
```

这将包装`FooImpl`对象，以便：

```
Foo foo = FooFactory.createFoo(...);
foo.bar(); 
```

印刷：

```
foo me
foo bar 
```

这是 BCEL 库的替代方案，它可以执行此操作以及更多功能，包括从运行时信息生成类，但 BCEL 库不是本机的。（从 1.3 开始，一切都`Proxy`在`java.lang.reflect`。）

# wpf - 设置新行Datagrid的内容

> ID：12485664
> 
> 赞同：3
> 
> 时间：2012-09-18T21:54:56.320
> 
> 标签：wpf, database

我有一个 DataGrid 显示一些具有相当多列的数据库。
我希望，当用户编辑新行时，会自动设置一些值。
使用 Windows 窗体 DataGrid 会很容易，因为有 RowsAdded 事件处理程序。但是我怎么能用 wpf DataGrid 处理这个？
编辑：我的 DataGrid 在 Xaml 中绑定到一个 ITable 的公共属性。当用户在 ComboBox 中选择一个表时，该属性将更新为相应的表。是的，有自动生成列，用户输入新行的方式是编辑最后一个空白行（默认行为）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T07:20:55.560

您可以在 LoadingRow 事件中执行此操作。尝试这样的事情：

```
private void myDataGrid_LoadingRow(object sender, System.Windows.Controls.DataGridRowEventArgs e)
{
    MyObject myObject = e.Row.Item as MyObject;
    if (myObject != null)
    {
        myObject.PropertyOne = "test";
        myObject.PropertyTwo = 2;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T17:06:03.810

好的，我想我明白了。
当 DataTable 绑定到 DataGrid 时，会创建一个 CollectionView 以便查看它。您可以使用（静态/共享）CollectionView.GetDefaultView(ThePropertyThatIsBound) 方法获取它。
由于它实现了 ICollectionChanged，因此您可以将事件处理程序添加到 CollectionChangedEvent。

在 CollectionChanged 事件处理程序中，如果您有一个新项目 (e.NewItems.Count>0)，则必须对照 System.Windows.Data.CollectionView.NewItemPlaceholder 检查它，如果它不是占位符，则它是全新的项目，我可以设置所有默认值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-11T20:49:10.187

`CollectionViewSource`为您分配一个`DataGrid`然后收听`CollectionChanged`事件，如下所示：

```
..
public CollectionViewSource ViewSource { get; set; }
..
this.ViewSource = new CollectionViewSource();
this.ViewSource.Source = new List<YourObjectType>();
this.ViewSource.View.CollectionChanged += View_CollectionChanged;

..

private void View_CollectionChanged(object sender,System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
{
    if (e.NewItems.Count > 0)
    {
        YourObjectType myObject = e.NewItems[e.NewItems.Count-1] as YourObjectType;
        if (myObject != null)
        {
            myObject.Property        = TheValueYouWant;
            ..
        }
    }
}
..
<DataGrid ItemsSource="{Binding ViewSource.View}" ../> 
```

# c# - WebAuthenticationBroker 是否在 Windows 8 Metro App post Release Candidate 中工作

> ID：12485665
> 
> 赞同：2
> 
> 时间：2012-09-18T21:55:00.373
> 
> 标签：c#, .net, windows-8, microsoft-metro

**解决方案** 我的工作解决方案可以在答案或我的更新二中找到。

1) 现在确保，为了在 localhost 上进行测试，您已经为 localhost 端口上的入站设置了 windows 防火墙。如果您有路由器上的端口转发。

2) 然后你需要告诉 IIS Express 请求来自本地主机外部是可以的：找到 Documents\IISExpress\config 并编辑 applicationhost.config。在列表中找到您的站点并**从绑定中删除 localhost**。

```
 <site name="S-Innovations.TrafficTheory.Web2" id="1591449597">
            <application path="/" applicationPool="Clr4IntegratedAppPool">
                <virtualDirectory path="/" physicalPath="G:\Documents\Visual Studio 2012\Projects\S-Innovations.TrafficTheory\S-Innovations.TrafficTheory.Web2" />
            </application>
            <bindings>
                <binding protocol="http" bindingInformation="*:909090:localhost" />
            </bindings>
        </site> 
```

2a）ISS需要以管理员身份运行，以管理员身份运行visual studio也以管理员身份启动ISS...

3) 找到您的 ip，www.myip.com 并将 ACS 返回 uri 更改为：`http://90.90.90.90:909090/api/federation/`

4）更改网络经纪人以使用您的IP：

```
 WebAuthenticationResult webAuthenticationResult = await WebAuthenticationBroker.AuthenticateAsync(
WebAuthenticationOptions.None,
new Uri("https://traffictheory.accesscontrol.windows.net:443/v2/wsfederation?wa=wsignin1.0&wtrealm=http%3a%2f%2flocalhost%3a48451%2f"),
new Uri("http://99.99.99.99:909090/api/federation/end")); 
```

一切都像这样对我有用。我得到了一个 hello world 作为令牌传递到我的 Metro 应用程序。

**问题**

我已经设置了 WCF 服务和 Metro 应用程序。WCF 服务设置为使用 Azure ACS 进行身份验证。

我制作了一个适用于 WebService 和 ACS 的控制台应用程序：

```
 static void Main(string[] args)
        {
            try
            {

                // First start the web project, then the client
                WebClient client = new WebClient();
                var token = RetrieveACSToken();
                client.Headers.Add("Authorization", token);
                client.Headers.Add("Content-type", "text/xml");
                var url = new Uri("http://traffictheory.azurewebsites.net/UserService.svc/Users");
                //var url = new Uri("http://localhost:4000/UserService.svc/Users");//
                Stream stream = client.OpenRead(url);
                StreamReader reader = new StreamReader(stream);
                String response = reader.ReadToEnd();
                Console.Write(response);

            }
            catch (Exception ex)
            {
                Console.Write(ex.Message);
            }
              Console.ReadLine();
        }

        private static string RetrieveACSToken()
        {
            var acsHostName     = ConfigurationManager.AppSettings.Get("ACSHostName");
            var acsNamespace    = ConfigurationManager.AppSettings.Get("ACSNamespace");
            var username        = ConfigurationManager.AppSettings.Get("ServiceIdentityUserName");
            var password        = ConfigurationManager.AppSettings.Get("ServiceIdentityCredentialPassword");
            var scope = "http://traffictheory.azurewebsites.net/"; 
            //var scope = "http://localhost:4000/";// 
            // request a token from ACS
            WebClient client = new WebClient();
            client.BaseAddress = string.Format("https://{0}.{1}", acsNamespace, acsHostName);
            NameValueCollection values = new
            NameValueCollection();
            values.Add("wrap_name", username);
            values.Add("wrap_password", password);
            values.Add("wrap_scope", scope);
            byte[] responseBytes =
            client.UploadValues("WRAPv0.9", "POST", values);
            string response =
            Encoding.UTF8.GetString(responseBytes);
            string token = response
            .Split('&')
            .Single(value =>
            value.StartsWith("wrap_access_token=",
            StringComparison.OrdinalIgnoreCase))
            .Split('=')[1];
            var decodedToken = string.Format("WRAP access_token=\"{0}\"", HttpUtility.UrlDecode(token));
            return decodedToken;
        } 
```

当我想从我的 Metro App 中使用它时，我现在面临两个问题。第一个与服务无关，与 WebAuthenticationBroker 有关。

1）当我使用

```
WebAuthenticationResult webAuthenticationResult = await WebAuthenticationBroker.AuthenticateAsync(
                WebAuthenticationOptions.None,
                new Uri("https://s-innovations.accesscontrol.windows.net:443/v2/wsfederation?wa=wsignin1.0&wtrealm=http%3a%2f%2ftraffictheory.azurewebsites.net%2f"),
                new Uri("https://s-innovations.accesscontrol.windows.net")
            ); 
```

我可以使用 LiveID、Facebook 等登录。不是谷歌，因为 ACS 没有正确包含 ID。但我没有得到任何形式的代币或索赔。我只得到：

[https://s-innovations.accesscontrol.windows.net/v2/wsfederation?wa=wsignin1.0](https://s-innovations.accesscontrol.windows.net/v2/wsfederation?wa=wsignin1.0) https://s-innovations.accesscontrol.windows.net/v2/facebook?cx=cHI9d3NmZWRlcmF0aW9uJn...cmFmZmljdGhlb3J5LmF6dXJld2Vic2l0ZXMubmV0JTJmJmlwPUZhY2Vib29rLTM1NTk5MjQ2NzgxNzc5OQ2&code=AQDagvqoXQ …………

我如何获得这部电影结尾的声明： http: [//channel9.msdn.com/Events/BUILD/BUILD2011/SAC-858T](http://channel9.msdn.com/Events/BUILD/BUILD2011/SAC-858T) 他的应用程序有效！

2) 上面显示的控制台应用程序在调用 API 时经过身份验证并获取要传递给服务的令牌，我如何从 Metro 应用程序中获取此令牌。

**更新**

我按照建议创建了控制器：

```
[HttpPost]
public ActionResult End()
{
    return Json("Hello World");
} 
```

我已经设置了一个断点，看看它是否得到它。还没有命中。

```
 WebAuthenticationResult webAuthenticationResult = await WebAuthenticationBroker.AuthenticateAsync(
WebAuthenticationOptions.None,
new Uri("https://traffictheory.accesscontrol.windows.net:443/v2/wsfederation?wa=wsignin1.0&wtrealm=http%3a%2f%2flocalhost%3a48451%2f"),
new Uri("http://localhost:909090/Federation/End")); 
```

在我的依赖方申请中，我有

```
Realm http://localhost:909090/
Return Url: Nothing  (have tried http://localhost:909090/Federation/End ) 
```

响应数据包含：`http://localhost:909090/Federation/End`现在。

**更新 2**

如您在另一篇文章中所示，我还尝试了 api 控制器：

公共类联邦控制器：ApiController {

```
public HttpResponseMessage Post()
{
    var response = this.Request.CreateResponse(HttpStatusCode.Redirect);
    response.Headers.Add("Location", "/api/federation/end?acsToken=" + ExtractBootstrapToken());

    return response;
}
public string Get()
{
    return "hello world";
}
protected virtual string ExtractBootstrapToken()
{
    return "Hello World";
} 
```

}

现在登录屏幕只是挂起并以您正在寻找的服务尚未准备好（或类似的东西）结束。

acs返回网址`http://localhost:48451/api/Federation`

```
 WebAuthenticationResult webAuthenticationResult = await WebAuthenticationBroker.AuthenticateAsync(
WebAuthenticationOptions.None,
new Uri("https://traffictheory.accesscontrol.windows.net:443/v2/wsfederation?wa=wsignin1.0&wtrealm=http%3a%2f%2flocalhost%3a909090%2f"),
new Uri("http://localhost:909090/api/federation/end")); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T03:02:34.767

只是继续浏览，`WebAuthenticationBroker`直到下一个请求的页面是`callbackUri`参数指定的页面。那时它会返回最终的 URL 给你，所以如果你想取回任何东西，它需要在那个 URL 中编码。

在依赖方的 ACS 控制面板中，您需要指定站点上某处的返回 URL。例如`https://traffictheory.azurewebsites.net/federationcallback`. 然后创建一个控制器来处理接受该 URL 的帖子。该帖子将有一个表单字段`wresult`，该字段是一些包含从 ACS 返回的令牌的 xml。

`WebAuthenticationBroker`然后，您可以通过重定向将令牌发送回`https://traffictheory.azurewebsites.net/federationcallback/end?token={whatever you want to return}`

然后，您需要将身份验证代理的使用更改为以下内容：

```
var webAuthenticationResult = await WebAuthenticationBroker.AuthenticateAsync(
            WebAuthenticationOptions.None,
            new Uri("https://s-innovations.accesscontrol.windows.net:443/v2/wsfederation?wa=wsignin1.0&wtrealm=http%3a%2f%2ftraffictheory.azurewebsites.net%2f"),
            new Uri("https://traffictheory.azurewebsites.net/federationcallback/end")
        );

// The data you returned
var token = authenticateResult.ResponseData.Substring(authenticateResult.ResponseData.IndexOf("token=", StringComparison.Ordinal) + 6); 
```

我用于处理身份验证回调帖子的控制器如下所示。

```
public class FederationcallbackController : ApiController
{
    public HttpResponseMessage Post()
    {
        var response = this.Request.CreateResponse(HttpStatusCode.Redirect);
        response.Headers.Add("Location", "/api/federationcallback/end?acsToken=" + ExtractBootstrapToken());

        return response;
    }

    protected virtual string ExtractBootstrapToken()
    {
        return HttpContext.Current.User.BootstrapToken();
    }
} 
```

`BootstrapToken()`扩展方法是`wif.swt`NuGet 包的一部分。默认情况下，WIF 不会将任何内容保存到引导令牌属性中，您需要通过在 web.config 中包含元素`saveBootstrapTokens="true"`上的属性来启用它。我的看起来像这样：`<service>``<microsoft.identityModel>`

```
<microsoft.identityModel>
    <service saveBootstrapTokens="true">
        <audienceUris>
            <add value="http://localhost:3949/" />
        </audienceUris>
        <federatedAuthentication>
            <wsFederation passiveRedirectEnabled="true" issuer="https://xyz.accesscontrol.windows.net/v2/wsfederation" realm="http://localhost:3949/" reply="http://localhost:3949/" requireHttps="false" />
            <cookieHandler requireSsl="false" path="/" />
        </federatedAuthentication>
        <issuerNameRegistry type="Microsoft.IdentityModel.Swt.SwtIssuerNameRegistry, Wif.Swt">
            <trustedIssuers>
                <add name="https://readify.accesscontrol.windows.net/" thumbprint="{thumbprint}" />
            </trustedIssuers>
        </issuerNameRegistry>
        <securityTokenHandlers>
            <add type="Microsoft.IdentityModel.Swt.SwtSecurityTokenHandler, Wif.Swt" />
        </securityTokenHandlers>
        <issuerTokenResolver type="Microsoft.IdentityModel.Swt.SwtIssuerTokenResolver, Wif.Swt" />
    </service>
</microsoft.identityModel> 
```

# python - Python，删除文件夹中早于 X 天的所有文件

> ID：12485666
> 
> 赞同：65
> 
> 时间：2012-09-18T21:55:02.063
> 
> 标签：python, python-2.7

我正在尝试编写一个 python 脚本来删除文件夹中早于 X 天的所有文件。这是我到目前为止所拥有的：

```
import os, time, sys

path = r"c:\users\%myusername%\downloads"
now = time.time()

for f in os.listdir(path):
  if os.stat(f).st_mtime < now - 7 * 86400:
    if os.path.isfile(f):
      os.remove(os.path.join(path, f)) 
```

当我运行脚本时，我得到：

`Error2 - system cannot find the file specified`,

它给出了文件名。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-18T22:06:54.520

`os.listdir()`返回一个裸文件名列表。这些没有完整路径，因此您需要将其与包含目录的路径结合起来。当您去删除文件时，您正在执行此操作，但不是在您删除文件时`stat`（或当您这样做时`isfile()`）。

最简单的解决方案是在循环顶部执行一次：

```
f = os.path.join(path, f) 
```

现在`f`是文件的完整路径，您可以`f`在任何地方使用（将您的`remove()`调用更改为也可以使用`f`）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2017-01-17T19:00:41.557

我认为新的**pathlib**与日期的**箭头**模块一起使代码更整洁。

```
from pathlib import Path
import arrow

filesPath = r"C:\scratch\removeThem"

criticalTime = arrow.now().shift(hours=+5).shift(days=-7)

for item in Path(filesPath).glob('*'):
    if item.is_file():
        print (str(item.absolute()))
        itemTime = arrow.get(item.stat().st_mtime)
        if itemTime < criticalTime:
            #remove it
            pass 
```

*   **pathlib**使列出目录内容、访问文件特征（例如创建时间）和获取完整路径变得容易。
*   **箭头**使计算时间更容易和更整洁。

**这是显示pathlib**提供的完整路径的输出。（无需加入。）

```
C:\scratch\removeThem\four.txt
C:\scratch\removeThem\one.txt
C:\scratch\removeThem\three.txt
C:\scratch\removeThem\two.txt 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-09-18T22:02:52.370

您还需要给它路径，否则它会在 cwd 中查找 .. 具有讽刺意味的是，您在其他地方做了，`os.remove`但没有其他地方......

```
for f in os.listdir(path):
    if os.stat(os.path.join(path,f)).st_mtime < now - 7 * 86400: 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-03-01T12:10:17.943

您需要使用`if os.stat(os.path.join(path, f)).st_mtime < now - 7 * 86400:`而不是`if os.stat(f).st_mtime < now - 7 * 86400:`

我发现使用`os.path.getmtime`更方便:-

```
import os, time

path = r"c:\users\%myusername%\downloads"
now = time.time()

for filename in os.listdir(path):
    # if os.stat(os.path.join(path, filename)).st_mtime < now - 7 * 86400:
    if os.path.getmtime(os.path.join(path, filename)) < now - 7 * 86400:
        if os.path.isfile(os.path.join(path, filename)):
            print(filename)
            os.remove(os.path.join(path, filename)) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-08-12T08:28:04.240

我以更充分的方式做到了

```
import os, time

path = "/home/mansoor/Documents/clients/AirFinder/vendors"
now = time.time()

for filename in os.listdir(path):
    filestamp = os.stat(os.path.join(path, filename)).st_mtime
    filecompare = now - 7 * 86400
    if  filestamp < filecompare:
     print(filename) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-04-12T08:59:59.900

一个简单的 python 脚本，用于删除超过 10 天的 /logs/ 文件

```
#!/usr/bin/python

# run by crontab
# removes any files in /logs/ older than 10 days

import os, sys, time
from subprocess import call

def get_file_directory(file):
    return os.path.dirname(os.path.abspath(file))

now = time.time()
cutoff = now - (10 * 86400)

files = os.listdir(os.path.join(get_file_directory(__file__), "logs"))
file_path = os.path.join(get_file_directory(__file__), "logs/")
for xfile in files:
    if os.path.isfile(str(file_path) + xfile):
        t = os.stat(str(file_path) + xfile)
        c = t.st_ctime

        # delete file if older than 10 days
        if c < cutoff:
            os.remove(str(file_path) + xfile) 
```

你可以用`__file__`你的路径替换。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-02-08T22:10:46.390

这是我在 Windows 机器上的操作方法。它还使用 shutil 来删除在下载中创建的子目录。我也有一个类似的工具来清理我儿子电脑硬盘上的文件夹，因为他有特殊需要并且倾向于让事情快速失控。

```
import os, time, shutil

paths = (("C:"+os.getenv('HOMEPATH')+"\Downloads"), (os.getenv('TEMP')))
oneday = (time.time())- 1 * 86400

try:
    for path in paths:
        for filename in os.listdir(path):
            if os.path.getmtime(os.path.join(path, filename)) < oneday:
                if os.path.isfile(os.path.join(path, filename)):
                    print(filename)
                    os.remove(os.path.join(path, filename))
                elif os.path.isdir(os.path.join(path, filename)):
                    print(filename)
                    shutil.rmtree((os.path.join(path, filename)))
                    os.remove(os.path.join(path, filename))
except:
    pass

print("Maintenance Complete!") 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-01-20T22:41:37.963

有了推导，可以是：

```
import os
from time import time

p='.'
result=[os.remove(file) for file in (os.path.join(path, file) for path, _, files in os.walk(p) for file in files) if os.stat(file).st_mtime < time() - 7 * 86400]
print(result) 
```

*   使用 match = os.remove(file) 删除文件
*   将所有文件循环到 path = for file in
*   生成所有文件 = (os.path.join(path, file) for path, _, files in os.walk(p) for file in files)
*   p 是文件系统的目录
*   验证 mtime 是否匹配 = if os.stat(file).st_mtime < time() - 7 * 86400

可能会看到：[https ://ideone.com/Bryj1l](https://ideone.com/Bryj1l)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-08-31T17:33:52.887

这将删除超过 60 天的文件。

```
import os

directory = '/home/coffee/Documents'

os.system("find " + directory + " -mtime +60 -print")
os.system("find " + directory + " -mtime +60 -delete") 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-21T14:07:55.660

其他一些答案也有相同的代码，但我觉得它们使一个非常简单的过程过于复杂

```
import os
import time

#folder to clear from
dir_path = 'path of directory to clean'
#No of days before which the files are to be deleted
limit_days = 10

treshold = time.time() - limit_days*86400
entries = os.listdir(dir_path)
for dir in entries:
    creation_time = os.stat(os.path.join(dir_path,dir)).st_ctime
    if creation_time < treshold:
        print(f"{dir} is created on {time.ctime(creation_time)} and will be deleted") 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-01-17T17:23:24.337

想添加我想出的来完成这项任务。该函数在登录过程中被调用。

```
 def remove_files():
        removed=0
        path = "desired path"
        # Check current working directory.
        dir_to_search = os.getcwd()
        print "Current working directory %s" % dir_to_search
        #compare current to desired directory
        if dir_to_search != "full desired path":
            # Now change the directory
            os.chdir( desired path )
            # Check current working directory.
            dir_to_search = os.getcwd()
            print "Directory changed successfully %s" % dir_to_search
        for dirpath, dirnames, filenames in os.walk(dir_to_search):
           for file in filenames:
              curpath = os.path.join(dirpath, file)
              file_modified = datetime.datetime.fromtimestamp(os.path.getmtime(curpath))
              if datetime.datetime.now() - file_modified > datetime.timedelta(hours=1):
                  os.remove(curpath)
                  removed+=1
        print(removed) 
```

# perl - 从 ArrayRef[HashRef] 强制 ArrayRef[MyClass]

> ID：12485673
> 
> 赞同：3
> 
> 时间：2012-09-18T21:55:34.193
> 
> 标签：perl, moose, type-coercion

在尝试回答[如何从大哈希中实例化 Moose 类时](https://stackoverflow.com/q/12483775/468327)，我想我遇到了另一个我不完全理解 Moose 类型强制的地方。出于某种原因，以下代码会发出警告：

```
You cannot coerce an attribute (departments) unless its type (ArrayRef[Company::Department]) has a coercion at ./test.pl line 12.
You cannot coerce an attribute (employees) unless its type (ArrayRef[Company::Person]) has a coercion at ./test.pl line 23. 
```

但随后成功。

```
#!/usr/bin/env perl

use warnings;
use strict;

package Company;
use Moose;
use Moose::Util::TypeConstraints;

has 'id'   => (is => 'ro', isa => 'Num');
has 'name' => (is => 'ro', isa => 'Str');
has 'departments' => (is => 'ro', isa => 'ArrayRef[Company::Department]', coerce => 1);

coerce 'ArrayRef[Company::Department]',
  from 'ArrayRef[HashRef]',
  via { [ map { Company::Department->new($_) } @$_ ] };

package Company::Department;
use Moose;

has 'id'   => (is => 'ro', isa => 'Num');
has 'name' => (is => 'ro', isa => 'Str');
has 'employees' => (is => 'ro', isa => 'ArrayRef[Company::Person]', coerce => 1);

package Company::Person;
use Moose;
use Moose::Util::TypeConstraints;

has 'id'         => (is => 'ro', isa => 'Num');
has 'name'  => (is => 'ro', isa => 'Str');
has 'age'        => (is => 'ro', isa => 'Num');

coerce 'ArrayRef[Company::Person]',
  from 'ArrayRef[HashRef]',
  via { [ map { Company::Person->new($_) } @$_ ] };

package main;

my %hash = (
    company => {
        id => 1,
        name => 'CorpInc',
        departments => [
            {
                id => 1,
                name => 'Sales',
                employees => [
                    {
                        id => 1,
                        name => 'John Smith',
                        age => '30',
                    },
                ],
            },
            {
                id => 2,
                name => 'IT',
                employees => [
                    {
                        id => 2,
                        name => 'Lucy Jones',
                        age => '28',
                    },
                    {
                        id => 3,
                        name => 'Miguel Cerveza',
                        age => '25',
                    },
                ],
            },
        ],
    }
);

my $company = Company->new($hash{company});
use Data::Dumper;
print Dumper $company; 
```

这应该怎么做？PS我试着简单地做

```
coerce 'Company::Department',
  from 'HashRef',
  via { Company::Department->new($_) }; 
```

但它死得很惨。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T22:23:00.857

好吧，它并没有完全成功，当您尝试使用`coerce => 1`. 这就是[为什么](http://search.cpan.org/~drolsky/Moose-1.10/lib/Moose/Manual/Delta.pod)：

> **你不能通过 coerce => 1 除非属性的类型约束有强制**
> 
> 以前，这是被接受的，并且它有点工作，除了如果您在创建对象后尝试设置属性，您将收到运行时错误。现在，当您尝试定义属性时会出现错误。

不过，我想我找到了解决它的方法，首先是引入子类型，然后更改包的顺序：

```
package Company::Person;
use Moose;
use Moose::Util::TypeConstraints;

subtype 'ArrayRefCompanyPersons',
  as 'ArrayRef[Company::Person]';

coerce 'ArrayRefCompanyPersons',
  from 'ArrayRef[HashRef]',
  via { [ map { Company::Person->new($_) } @$_ ] };

has 'id'         => (is => 'ro', isa => 'Num');
has 'name'  => (is => 'ro', isa => 'Str');
has 'age'        => (is => 'ro', isa => 'Num');

package Company::Department;
use Moose;

has 'id'   => (is => 'ro', isa => 'Num');
has 'name' => (is => 'ro', isa => 'Str');
has 'employees' => (is => 'ro', isa => 'ArrayRefCompanyPersons', coerce => 1);

package Company;
use Moose;
use Moose::Util::TypeConstraints;

subtype 'ArrayRefCompanyDepartments',
  as 'ArrayRef[Company::Department]';

coerce 'ArrayRefCompanyDepartments',
  from 'ArrayRef[HashRef]',
  via { [ map { Company::Department->new($_) } @$_ ] };

has 'id'   => (is => 'ro', isa => 'Num');
has 'name' => (is => 'ro', isa => 'Str');
has 'departments' => (is => 'ro', isa => 'ArrayRefCompanyDepartments', coerce => 1); 
```

其余代码与您的版本相同。这可以在没有任何警告的情况下工作，并且 more-o-less 的行为就像（再次，我认为）它应该是。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T16:17:11.417

来自[`Moose::Manual::Type`](https://metacpan.org/module/Moose%3a%3aManual%3a%3aTypes#LOAD-ORDER-ISSUES)文档：

> **装货单问题**
> 
> 因为 Moose 类型是在运行时定义的，所以您可能会遇到加载顺序问题。特别是，您可能希望在定义该类型之前使用该类的类型约束。
> 
> 为了改善这个问题，我们建议在一个模块 MyApp::Types 中定义所有自定义类型，然后在所有其他模块中加载这个模块。

因此，要添加到`raina77ow`子类型和包订单答案（+1），我建议创建一个`Company::Types`模块：

```
package Company::Types;
use Moose;
use Moose::Util::TypeConstraints;

subtype 'CompanyDepartments'
  => as 'ArrayRef[Company::Department]';

subtype 'CompanyPersons'
  => as 'ArrayRef[Company::Person]';

coerce 'CompanyDepartments'
  => from 'ArrayRef[HashRef]'
  => via { 
       require Company::Department; 
       [ map { Company::Department->new($_) } @$_ ]; 
     };

coerce 'CompanyPersons'
  => from 'ArrayRef[HashRef]'
  => via { require Company::Person; [ map { Company::Person->new($_) } @$_ ] };

1; 
```

然后把`use Company::Types`你所有的`Company::`课都放进去。

# mono - 如何为 Mono.Fuse 创建可再分发的 RPM？

> ID：12485676
> 
> 赞同：0
> 
> 时间：2012-09-18T21:55:42.967
> 
> 标签：mono, rpm, fuse, opensuse

首先，我显然*试图*获得[Mono.Fuse](http://www.jprl.com/Projects/mono-fuse/)项目的二进制版本，但唯一可用的下载是源文件。（实际上似乎最新版本在覆盖中有语法错误）

所以我尝试将它从 git 安装到 Linux 机器上，成功，但我很快需要将它与我的 Xcopy-deployable 应用程序一起带到生产服务器上。

我不喜欢在生产机器上编译软件，特别是因为我需要从 YaST 安装 loooooooooooots 的开发工具。所以现在我有了这个包含所有源文件和编译文件的 git 克隆目录。

如何创建一个 RPM 包，我可以使用简单的命令将其安装在多台生产机器上，而无需解决`configure.sh`与 glib-2.0-devel 等大量不需要的库的依赖关系？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T00:02:34.843

看看[Open Build Service](http://openbuildservice.org/)。

# javascript - 将文件附件名称和 URL 添加到 Javascript

> ID：12485677
> 
> 赞同：2
> 
> 时间：2012-09-18T21:55:53.810
> 
> 标签：javascript, wordpress, attachment

我正在努力将 jPlayer 整合到我们的 WordPress 网站中。我并不特别关心可用的两个插件，因为我们的客户在技术上有点不足。我们希望完成的是将标题和 Mp3 加载到 jPlayer 播放列表的 JavaScript 中。目前，一切都加载得很好并返回了适当的文本，但是我无法正确加载文件名和附件 URL。在这方面，我对 java 和 wordpress 还很陌生。如果您想查看实时站点示例，请访问[http://www.ourgoodfight.com/?p=6054](http://www.ourgoodfight.com/?p=6054)

```
<!--Begin Jplayer Playlist -->
<script type="text/javascript">
    //<![CDATA[
    $(document).ready(function(){
        new jPlayerPlaylist({
            jPlayer: "#jquery_jplayer_1",
            cssSelectorAncestor: "#jp_container_1"
        }, [
         <?php
            global $post;
                $jukebox_args = get_posts( array(
                    'post_type' => 'attachment',
                    'posts_per_page' => -1,
                    'post_mime_type' => 'audio/mpeg',
                    'orderby' => 'menu_order',
                    'order'  => 'ASC',
                    'post_parent' => $post->ID
                        ));
                $the_jukebox_query = new WP_Query( $jukebox_args );        
        ?>
        <!--This is what needs to loop -->
            <?php
                $loop = new WP_Query( $jukebox_args );
                    while ( $loop->have_posts() ) : $loop->the_post(); ?>
                {
                    title:<?php echo apply_filters( 'the_title', $attachment->post_title ); ?>,
                    mp3:<?php echo wp_get_attachment_url( $attachment->ID, false ); ?>,
                },
            <?php endwhile;?>
        <!--This would be the end of the loop -->
        ], {
            swfPath: "<?php echo get_template_directory_uri(); ?>/js",
            supplied: "mp3",
            wmode: "window"
        });
    });
    //]]>
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T20:22:16.867

您正在尝试使用 var $attachment 访问您的附件数据。但是您从未将 $attachment var 设置为实际包含任何数据，因此它当前为空。当您使用 $loop->the_post(); 在循环中设置您的帖子数据时 你应该能够;

```
title:<?php echo apply_filters( 'the_title', get_the_title() ); ?>,
mp3:<?php echo wp_get_attachment_url( get_the_ID(), false ); ?>, 
```

[http://codex.wordpress.org/Class_Reference/WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)

请注意关于使用 wp_reset_postdata() 重新设置帖子数据的要点。

# java - Java/JSP 输出一个文本文件

> ID：12485681
> 
> 赞同：1
> 
> 时间：2012-09-18T21:56:36.180
> 
> 标签：java, google-app-engine, jsp

我需要在我的网站上提供一个“文本”文件，以便合作伙伴可以每天阅读数据。我希望动态生成这个“文本”文件。我们为我们的页面使用 JSP 和 Java Servlet

有没有办法在用户访问我的 JSP 或 Java Servlet url 时动态生成要下载的文本文件？

我尝试过使用没有任何 html 的 JSP。它确实在页面上放置了一些文本，但我似乎无法在输出中包含换行符，因此我认为将其作为要下载的文件提供可能会更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:05:45.677

要生成一些文本并下载它，您可以使用以下内容：

```
import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet( name = "TextOutputServlet", urlPatterns = { "/servlets/giveMeSomeText" } )
public class TextOutputServlet extends HttpServlet {

    protected void processRequest( HttpServletRequest request, HttpServletResponse response )
            throws ServletException, IOException {

        response.setContentType( "text/plain;charset=UTF-8" );
        response.setHeader( "Content-Disposition", "attachment;filename=MyTextFile.txt" );
        PrintWriter out = response.getWriter();

        try {

            out.println( "Some content..." );
            out.println( "Some more..." );

        } finally {            
            out.close();
        }

    }

    @Override
    protected void doGet( HttpServletRequest request, HttpServletResponse response )
            throws ServletException, IOException {
        processRequest( request, response );
    }

    @Override
    protected void doPost( HttpServletRequest request, HttpServletResponse response )
            throws ServletException, IOException {
        processRequest( request, response );
    }

} 
```

# c - 从用户空间调用驱动程序 API 的成本

> ID：12485686
> 
> 赞同：1
> 
> 时间：2012-09-18T21:56:44.613
> 
> 标签：c, linux, linux-kernel, linux-device-driver

这一切都在 Linux 和 C 中。

我有一个用户空间库函数，最多需要调用设备驱动程序的读/写函数 8 次。（我正在编写库和设备驱动程序。）我看到了两种实现方式：

1.  让库调用读/写所需的次数。
2.  让驱动程序处理读取/写入设备所需的次数。

驱动程序已经根据先前的 ioctl 调用知道所需的次数，无论如何都会发生。选项 1 需要在用户空间和内核空间之间进行更多切换，我知道这会降低性能。另一方面，选项 2 会产生问题。对于读取调用，传递回用户空间的缓冲区最多将大 8 倍，除非可以一次将 1 个读取传递回用户空间，而无需在两种模式之间切换。除非每次都写入相同的数据，否则 write 调用也会有同样的问题。因此，选项 2 的最坏情况需要比选项 1 来回传递的缓冲区大 8 倍。

最终，哪一个更有效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-21T22:44:21.977

正如评论员所建议的那样，如果您关心效率，那么没有任何猜测可以替代基准测试和分析。“效率”可能会受到大量因素的影响，分析您的每个选项是确定最佳选项的正确方法。

# matlab - 使用 isspace 识别空格字符时遇到问题

> ID：12485687
> 
> 赞同：3
> 
> 时间：2012-09-18T21:56:45.180
> 
> 标签：matlab, removing-whitespace

帮助！出于某种原因，我的功能不是在所有数据集上识别空间。见下文：

我在我的代码中使用以下函数：

```
function [ll]=f_get_length(A)

 l1=length(A);
  for ii=1:l1
   if A(ii) == ' '
    ll=ii;
     break
   end
end 
```

但我得到一个给出以下错误的数据集：

```
Error in ==> f_get_length at 3
l1=length(A);

??? Output argument "ll" (and maybe others) not assigned during call to
"/home/geovault-01/abutcher/scripts/meghans_codes/SdP_codes/3DKirchhof/f_get_length.m>f_get_length".

Error in ==> process_sacdataSP10_PICASSO at 62
ll=f_get_length(SS); 
```

当我试图找出问题时，我发现在使用时空格没有被识别为空格`isspace`，但以下证明第4个字符后有空格：

```
strtrim(A)
ans =
  CAVN

length(A)
ans =
  8

display(['test' A(6) 'test'])
  test test
display(['test' A(5) 'test'])
  test test
display(['test' A(4) 'test'])
  testNtest
display(['test' A(7) 'test'])
  test test
display(['test' A(8) 'test'])
  test test

length(A)
ans =
  8

strtrim(A)
ans =
  CAVN    

length(A)
ans =
  8

isspace(A(6))
ans =
  0

isspace(A)
ans =
  0     0     0     0     0     0     0     0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T01:45:26.273

如果输入中没有空格，则不会分配`A`输出。`ll`

要解决该问题，您应该在函数末尾添加：

`ll=l1;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T10:23:03.833

您可以使用条件，而不是使用`isspace`或更有限的`A(ii) == ' '`

```
A(ii) <= ' ' || isspace(A(ii)) 
```

第一部分将处理所有非打印 ASCII 字符（例如，在空格之前的所有 ASCII 字符），`isspace`然后处理剩余的非打印 Unicode 字符。

或者，您可以使用

```
if ~isletter(A(ii)), break; end 
```

并且，正如 Oli 已经指出的那样，确保*在所有可能的路径*`ll`中分配。意思是，如果（空）或（NULL 字符）或（由于前导空格它将返回长度 1）等，您的函数将失败。*`A = ''``A = char(1)``A = ' THE_REAL_STRING'`*

 *此外，您可以像这样对整个事物进行矢量化：

```
ll = find(A <= ' ' | isspace(A), 1); 
```

使整个循环变得不必要。*

# awk - awk 数学 - 获取自然数

> ID：12485689
> 
> 赞同：-1
> 
> 时间：2012-09-18T21:57:14.670
> 
> 标签：awk

我有两列：

```
100011780   100016332  
10100685    10105465      
101190948   101195542  
101286838   101288018  
101411746   101413662  
101686767   101718138  
101949793   101950504  
101989424   101993757  
102095320   102106147  
102133372   102143125 
```

我想得到这些数字的中间值。
试着：

```
awk '{print $1"\t"$2-$1}' input | awk '{print $1"\t"$2/2}' | awk '{print $1+$2}' > output 
```

但是除以 2 后的一些数字不再自然，可能我的输出是这样的：

```
100014056
10103075
101193245
101287428
101412704
1.01702e+08
1.0195e+08
1.01992e+08
1.02101e+08
1.02138e+08 
```

也许可以找到非自然值和 -/+ 0.5 使其自然？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:18:49.150

您当然不需要调用 awk 3 次来获得两个数字的平均值。

```
awk '{printf("%d\n", ($1+$2)/2)}' input 
```

用于`printf()`控制输出。

```
100014056
10103075
101193245
101287428
101412704
101702452
101950148
101991590
102100733
102138248 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T22:21:37.573

您可以在 AWK 文件中添加和使用此轮函数：

```
function round(x) {
    ival = int(x);

    if (ival == x)
            return x;

    if (x < 0) {
            aval = -x;
            ival = int(aval);
            fraction = aval - ival;
            if (fraction >= .5)
                    return int(x) - 1;
            else
                    return int(x);
    } else {
            fraction = x - ival;
            if (fraction >= .5)
                    return ival + 1;
            else
                    return ival;
    }
} 
```

例如，平均值将是：

```
{print round(($1+$2)/2)} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T22:27:27.283

当总和不均匀时不确定您想要什么，但您可以一次性完成所有操作：

```
gawk '{printf "%i\n", ($1 + $2) / 2}' input 
```

您正在寻找的是printf的[格式控制选项。](http://www.gnu.org/software/gawk/manual/gawk.html#Control-Letters)

# c# - 将字符串转换为字典的 C# 函数

> ID：12485691
> 
> 赞同：-1
> 
> 时间：2012-09-18T21:57:19.563
> 
> 标签：c#, c#-4.0, linq-to-objects

我有一个使用下面的代码将字符串转换为字典的函数。我需要添加第三个分隔符，它是行或记录分隔符必不可少的。目前“，”分隔[属性，值]和“|” 分隔每一对。我不知道如何添加第三个分隔符来分隔行并将它们添加到我的字典中。

```
 var dict = feed.Split(',')
                   .Select(x => x.Split('|'))
                   .ToDictionary(x => x[0], x => x[1]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:06:30.387

以 '/' 作为行分隔符

```
var dict = x.Split('/').SelectMany(s => s.Split('|')).ToDictionary(t => t.Split(',')[0], t => t.Split(',')[1]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:06:12.587

换行符通常用于指示新记录，例如 CSV 文件。真的，任何特殊字符或序列都可以。

# python - Python、Flask 和 jinja 模板 - 如何迭代字典创建的服务器端

> ID：12485694
> 
> 赞同：3
> 
> 时间：2012-09-18T21:57:36.220
> 
> 标签：python, flask, jinja2

我正在使用烧瓶。

当页面加载时，我在服务器服务器上创建了一个字典。

```
@app.route('/edit_creative', methods=["GET", "POST"])
@login_required
def edit_creative():
    if request.method == "POST": 
        pass

    query = """select * from mystable"""
    print query
    rows = execute_query(query,select=True)
    creative_handler={}
    for row in rows:
        j = row[2].strip("'")
        j = json.loads(j)
        creative_handler[row[1]]=j

    return render_template("edit_creatives.html",title = 'Edit Creative') 
```

在客户端，我想遍历哈希：

```
{% for crid, object in creative_handler.iteritems() %}

{{ crid }}<br>

{% endfor %} 
```

在页面上我收到此错误

```
UndefinedError: 'creative_handler' is undefined 
```

那么..我如何使用 jinja 模板来迭代哈希创建服务器端？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T22:01:27.463

您需要传递`creative_handler`给模板：

```
return render_template("edit_creatives.html", title='Edit Creative', creative_handler=creative_handler) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T22:04:09.227

好吧，您需要在模板中传入要使用的变量。

```
>>> from flask import render_template
>>> help(render_template)
render_template(template_name, **context)
    Renders a template from the template folder with the given
    context.

    :param template_name: the name of the template to be rendered
    :param context: the variables that should be available in the
                    context of the template. 
```

所以`return render_template("edit_creatives.html",title = 'Edit Creative', creative_handler = creative_handler)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T22:02:16.323

尝试

```
return render_template("edit_creatives.html",title = 'Edit Creative', creative_handler = creative_handler) 
```

如果 creative_handler 仍然包含您的数据。

您必须将对象实际传递给模板，以便可以看到它并为其命名，然后在模板中使用该名称。另外仅供参考，代码不是在客户端执行的，它是在您的应用程序中构建的，然后发送到客户端。他们只看到循环产生的 HTML 等。

# jquery - 使用 jquery colorbox 显示 div 标签的问题

> ID：12485695
> 
> 赞同：0
> 
> 时间：2012-09-18T21:58:01.797
> 
> 标签：jquery, colorbox

这是我的 HTML 代码

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
   <title></title>
   <link href="css/colorbox.css" rel="stylesheet" type="text/css"/>
   <script src="js/jquery-1.7.2.min.js"></script>
   <script src="js/jquery.colorbox-min.js"></script>
   <script>
     function alertme(){
       alert(""+$("#text1").val()+$("#text2").val());
     }
     function enable_colorbox(){
       console.log("inside colorbox");
       jQuery("#inline").colorbox({inline:true});
     }
   </script> 
</head>
<body>
  <div id="inline" style="display: none;">
    <input type="text" id="text1" />
    </br>
    <input type="text" id="text2" />
    <input type="submit" value="clickme" onclick="alertme()"/>
  </div>
  <input type="submit" onclick="enable_colorbox()" />
</body>
</html> 
```

我有一个不可见的 div 标签，在 div 标签之外，我有一个提交按钮，点击它会调用 div 标签上的颜色框。什么都没发生。我不确定是什么问题。我在控制台中没有任何错误。

js 和 css 文件在我的本地服务器中。我可以启动 html 文件并通过浏览器查看 css 和 js 文件。

请指教

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:10:47.877

改变这个：

```
jQuery("#inline").colorbox({inline:true}); 
```

对此：

```
$.colorbox({inline:true, href: "#inline" }); 
```

**添加演示：** [jsfiddle.net/TpVn6/](http://jsfiddle.net/TpVn6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:02:38.783

这是什么：`jQuery("#inline").colorbox(**{inline:true}**);`？不应该`display:inline`吗？

# android - 使用带有片段的上下文操作栏

> ID：12485698
> 
> 赞同：13
> 
> 时间：2012-09-18T21:58:16.287
> 
> 标签：android, android-listfragment

我目前正在开发 android 项目并使用片段和 ListViews/ListFragments。我有用于标准活动的上下文操作栏，例如 ListActivity。

现在我正在尝试做同样的事情，但在片段布局上。我有一个 MainActivity，它扩展了 Activity，它为包含 2 个片段、片段 A 和片段 B 的布局扩展 XML。

Fragment A 扩展 ListFragment 并包含一个 ListView，它是从 SQLite 数据库中的数据填充的。当我有一个在标准 ListActivity 上工作的上下文操作栏时，我有一个扩展 ListView.MultiChoiceModeListener 的类，但这不适用于 ListFragment 类或标准活动，所以我将如何实现它。

我想要实现的基本目标是，当有人长按扩展 ListFragment 的 FragmentA 内的 ListView 中的项目时，操作栏会根据上下文发生变化，然后用户可以从 ListView 中选择多个项目。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-26T09:14:37.430

> 当我有一个在标准 ListActivity 上工作的上下文操作栏时，我有一个扩展 ListView.MultiChoiceModeListener 的类，但这不适用于 ListFragment 类或标准活动，所以我将如何实现它。

我不明白怎么`MultiChoiceModeListener`不可用（也许我不明白你想做什么）。根据您的评论，我假设您使用了兼容性包中的片段。下面是一个`FragmentActivity`带有两个静态片段的示例，每个片段都使用自己的菜单选项触发上下文操作栏。

`FragmentActivity`非常简单，它只包含以下两个片段：

```
// the list fragment
public class ListCABFragment extends ListFragment {

    private String[] mCountries = { "Romania", "Germany", "England", "USA",
            "Japan", "France" };
    private static final boolean POST_HONEYCOMB = Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB;

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        if (POST_HONEYCOMB) {
            // make sure we are on a version above Honeycomb otherwise will
            // access things that aren't available
            postHoneycombCAB();
        } else {
            // probably do nothing and implement the normal context menu?!?
        }
        setListAdapter(new ArrayAdapter<String>(getActivity(),
                android.R.layout.simple_list_item_1, mCountries));
    }

    @SuppressLint({ "NewApi", "NewApi" })
    private void postHoneycombCAB() {
        getListView().setChoiceMode(ListView.CHOICE_MODE_MULTIPLE_MODAL);
        getListView().setOnItemLongClickListener(new OnItemLongClickListener() {

            @Override
            public boolean onItemLongClick(AdapterView<?> parent, View view,
                    int position, long id) {
                ((ListView) parent).setItemChecked(position,
                        ((ListView) parent).isItemChecked(position));
                return false;
            }
        });
        getListView().setMultiChoiceModeListener(new MultiChoiceModeListener() {

            private int nr = 0;

            @Override
            public boolean onCreateActionMode(ActionMode mode, Menu menu) {
                getActivity().getMenuInflater().inflate(R.menu.listcab_menu,
                        menu);
                return true;
            }

            @Override
            public boolean onPrepareActionMode(ActionMode mode, Menu menu) {
                return false;
            }

            @Override
            public boolean onActionItemClicked(ActionMode mode, MenuItem item) {
                switch (item.getItemId()) {
                case R.id.item1:
                    Toast.makeText(getActivity(), "Option1 clicked",
                            Toast.LENGTH_SHORT).show();
                    break;
                case R.id.item2:
                    Toast.makeText(getActivity(), "Option2 clicked",
                            Toast.LENGTH_SHORT).show();
                    break;

                }
                return false;
            }

            @Override
            public void onDestroyActionMode(ActionMode mode) {
                nr = 0;
            }

            @Override
            public void onItemCheckedStateChanged(ActionMode mode,
                    int position, long id, boolean checked) {
                if (checked) {
                    nr++;
                } else {
                    nr--;
                }
                mode.setTitle(nr + " rows selected!");
            }
        });
    }
} 
```

还有A的另一个片段，该片段`Fragment`的布局是由A组成的，该布局在选择A`RadioGroup`时触发CAB `RadioButton`：

```
public class SimpleCABFragment extends Fragment implements Callback {

    private static final boolean POST_HONEYCOMB = Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB;

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        return inflater.inflate(R.layout.frag_simplecabfragment, container,
                false);
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        RadioGroup rg = (RadioGroup) getView().findViewById(R.id.radioGroup1);
        rg.setOnCheckedChangeListener(new OnCheckedChangeListener() {

            @Override
            public void onCheckedChanged(RadioGroup group, int checkedId) {
                if (POST_HONEYCOMB) {
                    // this could be improved so we don't need to create the
                    // option
                    // menu if it is already available
                    getActivity().startActionMode(SimpleCABFragment.this);
                } else {
                    // something else
                }
            }
        });
    }

    @Override
    public boolean onActionItemClicked(ActionMode mode, MenuItem item) {
        if (item.getItemId() == R.id.itemradio) {
            Toast.makeText(getActivity(), "CAB for Radiogroup!",
                    Toast.LENGTH_SHORT).show();
        }
        return false;
    }

    @Override
    public boolean onCreateActionMode(ActionMode mode, Menu menu) {
        getActivity().getMenuInflater().inflate(R.menu.simplecab_menu, menu);
        return true;
    }

    @Override
    public void onDestroyActionMode(ActionMode mode) {
    }

    @Override
    public boolean onPrepareActionMode(ActionMode mode, Menu menu) {
        return false;
    }
} 
```

看看这是否是您正在寻找的（您可以[在我的 github 项目](https://github.com/luksprog/DroidPlayground/blob/master/src/com/luksprog/playground/fragment/SimpleCABFragment.java)中找到包括布局和菜单文件的完整示例）。

# android - 单击项目后将子项目添加到列表视图项目

> ID：12485700
> 
> 赞同：1
> 
> 时间：2012-09-18T21:58:33.933
> 
> 标签：android, listview, subitem

我正在开发一个 android 应用程序，我喜欢在列表视图中执行如下图所示的操作：

[![](../Images/52a1eda720472e19dfc8cfd93b61488a.png)](https://i.stack.imgur.com/4b07I.png)

如您所见，列表视图有一个自定义适配器，可以从我的一个类中生成一个列表。单击后，我想在 Listview 项下添加一个类似于 Linearlayout 或其他内容的视图。我怎样才能做到这一点？PS：我必须在哪里放置一个 onItemClickListener()？在我的适配器类或 onCreate() 方法之后的主页中？PPS：在图片中，我的意思是 SUBITEM FOR ITEM1……对不起……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:46:20.027

您本质上想要做[这个人](https://stackoverflow.com/questions/10106921/nullpointerexeption-when-using-listview-inside-a-viewstub)对 a所做的事情`ViewStub`，并实现一个`OnClickListener`附加到每个`ListItem`.

如果不清楚，或者您找不到一个好的例子，请告诉我，我会看看我能做些什么。:)

# android - 国家字母选择器未出现

> ID：12485702
> 
> 赞同：0
> 
> 时间：2012-09-18T21:58:48.877
> 
> 标签：android, android-edittext, android-softkeyboard

我要做的是实现一个能够将字母着色为绿色或红色的文本输入。我的一段代码可以做到这一点，但有一个问题。我不能写国家信函，因为弹出窗口没有出现。

* * *

```
edit_text.addTextChangedListener(new TextWatcher() {
    boolean input_changed = false;        

    private boolean isInputBlocked()
    {
        this.input_changed = !this.input_changed;                
        return !this.input_changed;                
    }

    @Override
    public void afterTextChanged(Editable s) 
    {
        // Prevent recursive 
        if (isInputBlocked()) return;                                

        // Some staff                                                

        Outer.this.edit_text.setText(Html.fromHtml(html_input.toString()));
    }

    @Override
    public void beforeTextChanged(CharSequence s, int start, int count,
            int after) {}

    @Override
    public void onTextChanged(CharSequence s, int start, int before,
            int count) 
    {}        
}); 
```

* * *

当我评论*Outer.this.edit_text.setText(Html.fromHtml(html_input.toString()));* ，出现弹出窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T20:47:00.713

InputFilter 帮我解决了这个问题：

```
InputFilter filter = new InputFilter() {
        final String good_letter = "<font color='#2FEE0D'>$</font>";
        final String bad_letter = "<font color='#FF0000'>$</font>";

        public CharSequence filter(CharSequence source, int start, int end, 
                Spanned dest, int dstart, int dend) 
        {
            String input = dest.toString().substring(0, dstart) + source.
                    subSequence(start, end) + dest.toString().substring(dend);
            StringBuffer output = new StringBuffer();
            List<Entry<Character, Boolean>> correction = Learn.this.
                learn_manager.getLetters(input);

            Log.d(TAG, "afterTextChanged: input size (" + input.length() + 
                    ")");

            System.out.println(input);

            for (int i = dstart; i < dstart + end; i++)
            {                    
                if (correction.get(i).getValue())
                {
                    output.append(this.good_letter.replace('$', correction.
                            get(i).getKey()));
                } else {

                    output.append(this.bad_letter.replace('$', correction.
                            get(i).getKey()));
                }
            }

            return Html.fromHtml(output.toString());
        } 
}; 
```

# jquery - 如何在滚动时逐渐减小 div 高度？

> ID：12485706
> 
> 赞同：0
> 
> 时间：2012-09-18T21:59:08.830
> 
> 标签：jquery, parallax

我`div`的页面顶部有一个从其内容中获取高度的。页面加载时，它使用 jQuery 向下滑动。我想要做的是`div`在滚动时慢慢降低高度，直到它达到 0。我需要`div`在滚动时逐渐隐藏它，就像 slideUp 函数一样。

我尝试了插件 Scrollorama，但我认为对于这么小的功能来说它太重了。

我尝试了另一个博客的脚本，它的作用相反，但我无法让它工作。

我对确切的问题做了一个小提琴：http: [//jsfiddle.net/HYPyw/8/](http://jsfiddle.net/HYPyw/8/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:18:19.553

很难想象您要做什么，但是我从您的要求中想出了这个[jsFiddle 。](http://jsfiddle.net/HYPyw/19/)如果它不是您要查找的内容，请详细说明。

# python - Python从HDFS读取文件作为流

> ID：12485718
> 
> 赞同：29
> 
> 时间：2012-09-18T22:00:22.903
> 
> 标签：python, hadoop, subprocess, hdfs

这是我的问题：我在 HDFS 中有一个文件可能很大（= 不足以容纳所有内存）

我想做的是避免将此文件缓存在内存中，并且只像处理常规文件一样逐行处理它：

```
for line in open("myfile", "r"):
    # do some processing 
```

我正在寻找是否有一种简单的方法可以在不使用外部库的情况下正确完成这项工作。我可能可以使它与[libpyhdfs](http://code.google.com/p/libpyhdfs/)或[python-hdfs](https://github.com/traviscrawford/python-hdfs)一起使用，但如果可能的话，我希望避免在系统中引入新的依赖项和未经测试的库，特别是因为这两个似乎都没有得到大量维护并且声明它们不应该是用于生产。

我正在考虑使用使用 Python`subprocess`模块的标准“hadoop”命令行工具来做到这一点，但我似乎无法做我需要的事情，因为没有命令行工具可以做我的处理，我想以流方式为每一行执行 Python 函数。

有没有办法使用 subprocess 模块将 Python 函数应用为管道的正确操作数？或者更好的是，像文件一样打开它作为生成器，这样我就可以轻松处理每一行？

```
cat = subprocess.Popen(["hadoop", "fs", "-cat", "/path/to/myfile"], stdout=subprocess.PIPE) 
```

如果有另一种方法可以在不使用外部库的情况下实现我上面描述的内容，我也很开放。

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-09-18T22:04:22.797

你想要[xreadlines](http://docs.python.org/release/2.3/lib/module-xreadlines.html)，它从文件中读取行而不将整个文件加载到内存中。

**编辑**：

现在我看到了你的问题，你只需要从你的`Popen`对象中获取标准输出管道：

```
cat = subprocess.Popen(["hadoop", "fs", "-cat", "/path/to/myfile"], stdout=subprocess.PIPE)
for line in cat.stdout:
    print line 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-01-15T10:15:33.553

如果您想不惜一切代价避免添加外部依赖项，Keith 的答案就是要走的路。 另一方面，[Pydoop可以让你的生活更轻松：](http://pydoop.sourceforge.net)

```
import pydoop.hdfs as hdfs
with hdfs.open('/user/myuser/filename') as f:
    for line in f:
        do_something(line) 
```

关于您的担忧，Pydoop 正在积极开发中，并已在[CRS4](http://www.crs4.it)用于生产多年，主要用于计算生物学应用。

西蒙娜

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-03T16:00:39.137

在过去的两年里，Hadoop-Streaming 发生了很多变化。根据 Cloudera，这非常快：http: [//blog.cloudera.com/blog/2013/01/a-guide-to-python-frameworks-for-hadoop/](http://blog.cloudera.com/blog/2013/01/a-guide-to-python-frameworks-for-hadoop/) 我已经取得了很好的成功。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-09T16:57:36.500

您可以使用 WebHDFS Python 库（建立在 urllib3 之上）：

```
from hdfs import InsecureClient
client_hdfs = InsecureClient('http://host:port', user='root')
with client_hdfs.write(access_path) as writer:
    dump(records, writer)  # tested for pickle and json (doesnt work for joblib) 
```

或者你可以在 python 中使用 requests 包：

```
import requests
from json import dumps
params = (('op', 'CREATE')
('buffersize', 256))
data = dumps(file)  # some file or object - also tested for pickle library
response = requests.put('http://host:port/path', params=params, data=data)  # response 200 = successful 
```

希望这可以帮助！

# codeigniter - 不同功能的构造函数会话验证

> ID：12485719
> 
> 赞同：1
> 
> 时间：2012-09-18T22:00:29.813
> 
> 标签：codeigniter

我在构造函数中进行验证，检查用户是否已启动会话。

然后我会为各种事情投入一些控制器。

我的问题是 - 我可以让一些控制器不受构造函数（会话验证）的影响，还是我必须把它放到另一个文件中？原因是，我想在构造函数中有两组函数——一组在用户登录时使用，另一组在用户未登录时使用。

我曾经有两个文件并在它们之间切换，但后来我决定将它们合并为一个。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T00:13:35.103

您需要做的是设置一个基本控制器，它将为您处理会话并通过继承将您登录的控制器与注销的控制器分开。

我给你的建议是看看菲尔鲟鱼关于[保持干燥](http://philsturgeon.co.uk/blog/2010/02/CodeIgniter-base-Classes-Keeping-it-DRY)的帖子。在他的帖子中，Phil 解释了如何以这样一种方式实现控制器的基础知识，即父控制器将照顾会话，因此您不必每次都检查它。

举个例子：

## MY_控制器：

```
class MY_Controller extends CI_Controller{
    function __construct(){
        parent::__construct();
        //do things in here that ALL controllers should do.
    }
} 
```

## MY_In_Controller：

```
class MY_In_Controller extends MY_Controller{
    function __construct(){
        parent::__construct();
        //if user doesnt have the session redirect them out NOW!
    }
} 
```

## MY_Out_Controller：

```
class MY_Out_Controller extends MY_Controller{
    function __construct(){
        parent::__construct();
        //if the user has the session, redirect them in NOW.
    }
} 
```

## 登录控制器：

```
class Login extends MY_Out_Controller{
    function __construct(){
        parent::__construct();
    }

    function index(){
        //folks that have a session (already logged in) will never even get here.
        //because the parent class MY_Out_Controller already redirected them back in.
    }
} 
```

## 管理控制器：

```
class Manage extends MY_In_Controller{
    function __construct(){
        parent::__construct();
    }

    function index(){
        //folks that don't a session (logged out) will never even get here.
        //because the parent class MY_In_Controller already redirected them out.
    }
} 
```

简而言之，不要直接在控制器中编写会话检查。您将过于频繁地编写它并违反[DRY 原则](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)。

**更新：我建议在**[CodeIgniter 的 Base Classes Revisited](http://www.highermedia.com/articles/nuts_bolts/codeigniter_base_classes_revisited)中使用 Shane Pearson 的方法来改进 Phil 的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-22T09:50:02.977

如前所述，为什么不为特定目的使用单独的不同基本控制器。

我会建议你这样

让我们分两部分，一个说前端控制器不需要会话，另一个控制器说后端控制器需要会话现在，

```
//application/core/Front_controller.php

class Front_Controller extends MY_Controller
{
 function __construct()
     {
             parent::__construct();

   }
 } 
```

core/backend_controller 下的另一个类

```
class backend_Controller extends MY_Controller
    {
     function __construct()
     {
             parent::__construct();
             $this->load->library('session');

     }
 } 
```

现在您可以为那些不需要会话的控制器扩展front_controller，并扩展需要来自应用程序/控制器的会话的后端控制器

# java - 如何让文本显示在图形上？

> ID：12485721
> 
> 赞同：1
> 
> 时间：2012-09-18T22:00:34.637
> 
> 标签：java

我是 Java 新手，所以感谢您的时间和帮助！

基本上我想让文本显示在我创建的图形上。基本上我做了一个奖杯，希望它在上面显示“#1”。

谁能帮助我如何做到这一点？再次感谢你

以下是我到目前为止编写的代码。您可以看到“#1”的位置已全部设置并完成，但它出现在图形后面。

```
import javax.swing.JApplet;
import java.awt.*; 
import java.net.*;
import javax.imageio.*;
import java.io.*;
import java.awt.Graphics2D;

public class BusinessCard extends JApplet
{

    /**
     * Paint method for applet.
     * 
     * @param  g   the Graphics object for this applet
     */
    public void paint(Graphics page)
    {
        //Variables used in rectangle
        int x = 0;
        int y = 0;
        int width = 500;
        int height = 300;

        page.drawRect(x, y, width, height);  //draws the rectangle using variables

        //Displays name
        Font f = new Font("Helvetica", Font.BOLD, 26);
        page.setFont(f);
        page.drawString ("anonymous", 300,100);

        //Displays company
        Font g = new Font("Helvetica", Font.PLAIN, 18);
        page.setFont(g);
        page.drawString ("blank", 320, 120);

        //Displays email
        Font h = new Font("Helvetica", Font.PLAIN, 15);
        page.setFont(h);
        page.drawString ("email", 315,140);

        //int for the logo
        final int MID = 350;
        final int TOP = 168;

        setBackground (Color.yellow);  //Revisit. For some reason it only turns yellow                   after you resize the window

        Font i = new Font("Helvetica", Font.BOLD, 16);
        page.setFont(i);
        page.drawString ("#1", MID+20, TOP+20);

        page.setColor (Color.orange);
        page.fillOval (MID, TOP, 60, 60); //bottom half of the trophy. the rounded part.
        page.drawArc (MID-8, TOP+15, 25, 25, 100, 160); //left arc
        page.drawArc (MID+43, TOP+15 , 25, 25, 280, 160); //right arc
        page.fillRect (MID+1, TOP+1, 59, 25); //make the top of the trophy flat basically
        page.fillRect (MID+22, TOP+60, 15, 25); //neck of the trophy
        page.drawLine (MID+48, TOP+84, MID+10, TOP+84); //base of the trophy

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:03:05.630

我认为你必须先画奖杯，然后再写文字！

无论您绘制什么，都会出现在控件的顶层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T22:11:44.423

首先，按照 sabre_raider 所说的去做。你以前确实想要它，但也必须修复其他东西

你在橙色上画橙色。您绘制奖杯，然后将页面背景设置为黄色，然后再次将“#1”绘制为橙色。更改`setBackground`为`page.setColor`以黄色绘制（这似乎是您想要的）。setBackground 设置小程序的背景，我假设这不是您想要的，而是用黄色绘制“#1”。如果您确实打算设置背景，请确保在`Applet`'`init`方法中进行设置！不是每次重画。（除此之外，在 init 中，设置了 setSize(500, 300) 以正确调整窗口大小以适应您的消息大小）

另外，我建议将其拆分为不同的方法，因为这只会使其更具可读性。以下是您的方法的一般外观：

```
/**
 * Paint method for applet.
 * 
 * @param g
 *            the Graphics object for this applet
 */
public void paint(Graphics page)
{
    drawBorder( page );
    drawText( page );
    drawTrophy( page, 1 );
}

private void drawBorder(Graphics page) {
    int x = 0;
    int y = 0;
    int width = 500;
    int height = 300;

    page.setColor( Color.black );
    page.drawRect( x, y, width, height );
}

private void drawText(Graphics page) {
    // Displays name
    Font f = new Font( "Helvetica", Font.BOLD, 26 );
    page.setFont( f );
    page.drawString( "anonymous", 300, 100 );

    // Displays company
    Font g = new Font( "Helvetica", Font.PLAIN, 18 );
    page.setFont( g );
    page.drawString( "blank", 320, 120 );

    // Displays email
    Font h = new Font( "Helvetica", Font.PLAIN, 15 );
    page.setFont( h );
    page.drawString( "email", 315, 140 );
}

private void drawTrophy(Graphics page, int number) {
    final int MID = 350;
    final int TOP = 168;
    page.setColor( Color.orange );
    page.fillOval( MID, TOP, 60, 60 ); // bottom half of the trophy. the rounded part.
    page.drawArc( MID - 8, TOP + 15, 25, 25, 100, 160 ); // left arc
    page.drawArc( MID + 43, TOP + 15, 25, 25, 280, 160 ); // right arc
    page.fillRect( MID + 1, TOP + 1, 59, 25 ); // make the top of the trophy flat basically
    page.fillRect( MID + 22, TOP + 60, 15, 25 ); // neck of the trophy
    page.drawLine( MID + 48, TOP + 84, MID + 10, TOP + 84 ); // base of the trophy

    Font i = new Font( "Helvetica", Font.BOLD, 16 );
    page.setColor( Color.yellow );
    page.setFont( i );
    page.drawString( "#" + number, MID + 20, TOP + 20 );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T23:01:41.770

首先，我不会直接在顶级容器上绘画。我会使用类似 a 的东西`JPanel`来进行自定义绘画，然后将其添加到顶级容器中。

其次，您应该尽可能避免覆盖`paint`。如果您按照第一点的建议使用自定义组件，则应`paintComponent`改为使用。

第三，总是调用`super.paint`（或者`super.paintComponent`如果您使用的是自定义组件）。

第四，任何其他身体都是正确的。您应该尝试在图形之后绘制文本...

这是我使用的代码：

```
public class BusinessCard extends JApplet {

    /**
     * Paint method for applet.
     *
     * @param g the Graphics object for this applet
     */
    public void paint(Graphics page) {

        super.paint(page);

        //Variables used in rectangle
        int x = 0;
        int y = 0;
        int width = 500;
        int height = 300;

        page.drawRect(x, y, width, height);  //draws the rectangle using variables

        //int for the logo
        final int MID = 350;
        final int TOP = 168;

        page.setColor(Color.orange);
        page.fillOval(MID, TOP, 60, 60); //bottom half of the trophy. the rounded part.
        page.drawArc(MID - 8, TOP + 15, 25, 25, 100, 160); //left arc
        page.drawArc(MID + 43, TOP + 15, 25, 25, 280, 160); //right arc
        page.fillRect(MID + 1, TOP + 1, 59, 25); //make the top of the trophy flat basically
        page.fillRect(MID + 22, TOP + 60, 15, 25); //neck of the trophy
        page.drawLine(MID + 48, TOP + 84, MID + 10, TOP + 84); //base of the trophy

        page.setColor(Color.yellow);  //Revisit. For some reason it only turns yellow                   after you resize the window

        Font font = UIManager.getFont("Label.font");

        page.setFont(font.deriveFont(Font.BOLD, 16));
        page.drawString("#1", MID + 20, TOP + 20);

        //Displays name
        page.setFont(font.deriveFont(Font.BOLD, 26));
        page.drawString("anonymous", 300, 100);

        //Displays company
        page.setFont(font.deriveFont(Font.PLAIN, 18));
        page.drawString("blank", 320, 120);

        //Displays email
        page.setFont(font.deriveFont(Font.PLAIN, 15));
        page.drawString("email", 315, 140);

    }
} 
```

它产生了

![在此处输入图像描述](../Images/dba207685b74c302c1b9267c9f6fdece.png)

请注意，每个人都可能安装了您尝试使用的字体（您的代码导致小程序崩溃）

# java - 在 Java 中更改鼠标灵敏度

> ID：12485722
> 
> 赞同：0
> 
> 时间：2012-09-18T22:00:39.057
> 
> 标签：java, mouse, sens

你如何获得鼠标的灵敏度，改变它，然后将它应用到鼠标上？

-进度被移除，显示点击速度而不是移动速度-

我已经研究过这个“无处不在”，但没有关于这个主题的任何内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:24:35.307

首先，我认为 arg0.getXOnScreen 将为您提供鼠标的绝对 x 坐标，而不是您通过定义名为 oldX 的变量所假设的旧位置。getX 应该为您提供面板内的位置或（类似小部件的东西，我不知道您正在使用的 api）。第二件事是......你是什么意思'鼠标灵敏度'你想从java更改鼠标的全局系统设置吗？我认为这甚至是不可能的。看[这里](https://stackoverflow.com/questions/2450966/java-how-to-change-mouse-speed-in-windows)这将需要您将 jni 库添加到项目并调用一些本机库，因此您使您的代码平台依赖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-03T16:14:41.857

您可能不得不修补 Robot 类并监听鼠标事件。因此，您必须侦听鼠标按下事件，然后使用机器人将鼠标移动的像素比鼠标实际移动的像素多 3 倍，然后您必须通过 Robot 类执行鼠标向上事件，将鼠标重新定位到原始位置后跟通过机器人的鼠标按下事件。

看看这有什么问题？这将是非常受用例驱动的，而不是一般要做的事情。我做 Java 已经很长时间了，所以我可能会成功，但这不是新手可能会做的事情，因为在调试过程中会出现其他需要解决的问题。

在处理旋转视图的 3d API 时注意到了这个线程。

# php - PHP 会话数组

> ID：12485724
> 
> 赞同：0
> 
> 时间：2012-09-18T22:00:43.510
> 
> 标签：php, arrays, session

我在存储数组的页面上有一个会话

```
<?php session_start();
if (!isset($_SESSION['pages'])) {
$_SESSION['pages'] = array();
array_push($_SESSION['pages'],$description);
}
print_r($_SESSION['pages']);
?> 
```

有没有办法在重写第一个数组之前将数组限制为只有 3 个描述。例如

```
array[0] => page1
array[1] => page2
array[2] => page3 
```

不，当我访问第 4 页时，我希望它重写 1 并只保留 3 条记录，所以它看起来像

```
array[0] => page4
array[1] => page2
array[2] => page3 
```

我不知道这是否可能！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:04:17.883

据我所知，如果您创建一个新课程，这将是可能的。该类可以有一个列表和一个索引作为它的成员。

当您调用 my_class_push 时，您可以将元素推送到当前索引并增加它。如果 index==3 则再次将其设置为 0。

那有意义吗？

或者，您可以将索引存储在会话变量中，然后编写自己的推送函数，该函数将获取会话的索引变量并进行必要的分配并更改会话索引变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:06:51.277

它只是一个数组，所以非常简单。

但是，如果有超过 3 个元素，我会在开始时添加一个元素并在最后删除一个元素：

```
session_start();
if (!isset($_SESSION['pages']))
{
  $_SESSION['pages'] = array();
}

// add an element at the start
array_unshift($_SESSION['pages'], $description);

// remove an element at the end
if (count($_SESSION['pages']) > 3)
{
  array_pop($_SESSION['pages']);
}

print_r($_SESSION['pages']); 
```

这样您的订单总是相同的（最后，上一个，2 前）。

# haskell - 包含不同类型的列表

> ID：12485726
> 
> 赞同：2
> 
> 时间：2012-09-18T22:00:52.777
> 
> 标签：haskell

我目前正在编写自己的结构，它可以同时处理整数和字符串：

就像是

```
data Collection = One Int | Two String | Three(Collection)(Collection) 
```

但是，我正在尝试编写一个可以将我的结构转换为列表的函数。

我是否认为这是不可能的，因为默认情况下会：

> [1,2,"测试"]

在控制台中不起作用，因此我的功能必然会失败？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T22:14:40.167

您可能应该只定义

```
type Collection = [Either Int String] 
```

然后，而不是做

```
l = [1,2,"test"] 
```

你可以做

```
l :: Collection
l = [Left 1, Left 2, Right "test"] 
```

如果您需要两种以上的类型，则需要定义自己的成员类型。所以你也会做这样的事情

```
data MemberType = MyInt Int | MyString String | MyFloat Float deriving Show
type Collection = [MemberType]
l :: Collection
l = [MyInt 1, MyInt 2, MyString "test", MyFloat 2.2] 
```

这`deriving Show`不是必需的，但能够简单地`print l`以一种很好的方式打印列表是很好的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T22:05:46.707

您的数据结构基本上是一棵二叉树，它在每个叶子上存储一个`Int`或一个。`String`遍历这棵树自然会是一个`[Either Int String]`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T22:03:37.970

Haskell 中的列表只能有一种类型。如果您想要一个列表来处理多种类型，您需要创建一个新的包装器类型，它可以代表您想要放入其中的两种类型，以及提取原始类型并处理它的函数。例如，您可以使用[`Either`](http://www.haskell.org/ghc/docs/6.12.2/html/libraries/base-4.2.0.1/Data-Either.html).

# python - Django：在模型中创建子模型

> ID：12485733
> 
> 赞同：1
> 
> 时间：2012-09-18T22:02:02.870
> 
> 标签：python, django

假设我有两个模型，Book 和 Page，这样 Page 到 Book 之间存在一对多的关系。我希望每个 Book 模型都有一个为各自的 Book 模型创建一堆 Pages 的函数，但我不确定如何将每个 Page 的外键关联回它创建的 Book 实例。

我目前有一个关联功能，可以在所有可能的书籍中找到正确的书籍，我确信有更好的方法，但我似乎找不到它。是否可以将外键设置为自我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T22:30:15.500

```
class Page(models.Model):
    # default related_name would be `page_set` but `pages`
    # seems a bit more intuitive, your choice.
    book = models.ForeignKey("yourapp.Book", related_name="pages")

class Book(models.Model):
    # ...

    # you can use self as the instance and magically you have
    # this `pages` attr which is a related manager, like `Page.objects`
    # but limited to the particular Book's pages.
    def special_page_create(self, *args, **kwargs):
        self.pages.create(
            # ...
        )
        # ... 
```

然后，你有一个书本实例，你有一个相关的经理，

```
book = Book.objects.get(...
book.pages.create(...
page, created = book.pages.get_or_create(...
pages_gte_42 = book.pages.filter(num__gte=42)
# etc 
```

让我知道你还需要知道什么。反向关系是半神奇的；您没有在 Book 类上声明任何内容，但您在`Book`实例上获得了相关的管理器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T22:15:30.990

会尝试这样的事情：

```
Class Page(models.Model):
    #Your fields, like a name or whatever
    name = models.CharField(max_length=60)

    Book= models.ForeignKey("Book")

Class Book(models.Model):
    #Your fields again       

    def create_page(self):
        "Adds a page to the book"
        #Do what you need to do
        page = Page(name="TitlePage", Book=self)
        page.save() 
```

或者类似的东西......我认为课程的顺序也很重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T22:16:35.467

Book 和 Page 之间存在一对多的关系。这意味着一本书有几页，每页只有一本书。

在数据库中（因此在 ORM 映射器中），您可以通过在 Page 中创建外键来对此进行建模。此外键将指向包含这些页面的 Book 实例。

如果要查找 Book 的 Pages，您将查询 Pages 表以查找具有与 Book 的主键相同的外键的所有 Pages。

# facebook - 将 API 添加到具有 OAuth 凭据的 WSO2 API Manager

> ID：12485734
> 
> 赞同：0
> 
> 时间：2012-09-18T22:02:05.240
> 
> 标签：facebook, api, oauth, wso2, wso2-am

我们正在尝试测试 WSO2 API 管理器并且在添加一些 API 时遇到了麻烦。MailChimp 很容易添加，因为 MC 本身没有 OAuth 凭据。但是，当尝试添加 Facebook 或其他拥有自己的 API 管理器的 API 时，它不起作用并不断得到 401 Unauthorized。这是因为 Facebook 和 WSO2 API Manager 都需要 OAuth 令牌，显然您只能发送一个 Authorization 标头。这里有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T09:10:54.857

WSO2 ApiManager 1.0 仍然不支持开箱即用的 (OAuth) 安全后端服务。因此，无法通过 APIM 注册 facebook、twitter api。

现在，应用程序正在使用 APIM 颁发的密钥向 APIM 发送和授权标头。理想情况下，如果您发送另一个授权标头，它将被转发到 facebook api，但在 API 网关级别，您需要删除属于 APIM 授权的已处理标头。

添加具有安全性的后端服务将作为新功能添加到 APIM 未来版本中。

问候，/女娲

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:11:11.700

您能解释一下为什么要在这里使用 API 管理器吗？您可以直接将您的请求发送到授权请求的 Facebook。

# memory-management - 操作系统和内存管理（理论）

> ID：12485737
> 
> 赞同：1
> 
> 时间：2012-09-18T22:02:16.910
> 
> 标签：memory-management, operating-system, theory

嘿，我有一个问题和一个答案，但我无法理解答案的第二部分！可以请任何人帮助我吗？

这里是：

问题;

计算机具有 32 位虚拟地址和 4 KB 页。程序和数据一起放入最低页 (0-4095) 堆栈放入最高页。如果使用传统（一级）分页，页表中需要多少条目？两级分页需要多少页表项，每部分 10 位？

回答;

对于一级页表，需要 2^32 /2^12 或 1M 页。因此页表必须有 1M 个条目。**对于两级分页，主页表有 1K 个条目，每个条目指向第二个页表。仅使用其中两个。因此总共只需要三个页表条目，一个在顶级表中，一个在每个低级表中。**

我看不懂加粗的。例如，我无法理解这个 1K 是如何出现的。

谢谢你的时间，

干杯!

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-19T00:42:37.037

我认为，问题第一部分的答案是错误的，因为您没有使用问题的上下文：`The program and data toget­her fit in the lowest page (0-4095) The stack fits in the highest page`. 因此，虽然页表条目的总数为 1048576，但您只使用 2 个条目，这 2 个页面中的每一个（条目 0 指向代码/数据页，条目 1048575 指向堆栈页）。

对于问题的第二部分，您会得到一个非常有用的提示：`two-level paging, with 10 bits in each part`. 但首先，让我们回到上面的更简单的情况......

在一个页表的情况 1 中，虚拟地址：

1.  有 32 位（给定为`A computer has 32-bit virtual addresses`）
2.  它们的 12 个最低有效位指示页面内的位置（给出为`A computer has ... 4-K.B pages`，也为`fit in the lowest page (0-4095)`）

剩下的 20 个最高有效位显然选择了页表中的一个条目。选定的页表条目包含页的物理地址。

因此，虚拟地址如下所示：

```
most significant bits                            least significant bits
| 20 bits = index into the page table | 12 bits = index into the page | 
```

因此，CPU 使用这个公式来访问内存：

```
PhysicalAddress = PageTable[VirtualAddress / 4096] + VirtualAddress modulo 4096 
```

现在，让我们回到案例 2。

您仍然有 12 个 LSB 位来选择页面中的一个字节。

但是有什么新东西？是`two-level paging, with 10 bits in each part`。

这 10 位是页表索引的长度，您现在有两个。

有了这个，我们得出以下虚拟地址的细分：

```
most significant bits                       least significant bits
| 10 bits = PT index | 10 bits = PT index | 12 bits = page index | 
```

地址翻译公式自然是：

```
PhysAddr = PageTable[VirtAddr / (1024*4096)][(VirtAddr / 4096) modulo 1024] + VirtAddr modulo 4096 
```

现在，我们仍然有占用 2 页的相同程序。

指向代码/数据页的虚拟地址是（二进制）：

```
0000000000|0000000000|xxxxxxxxxxxx 
```

指向堆栈页的虚拟地址是（也是二进制的）：

```
1111111111|1111111111|xxxxxxxxxxxx 
```

从这里您可以看到您在级别 1 使用了 2 个不同的页表条目（由索引 0000000000 和 1111111111 选择），并且在级别 2 使用了类似的 2 个不同的页表条目。

因此，在情况 2 中，程序运行所需的总页表条目为 2+2=4。

PS如果你不记得：2 ^(10) = 1024, 2 ^(12) = 4096, 2 ^(20) = 1048576。

# ios - 分组标题UItableview中单词的字体和颜色分开

> ID：12485739
> 
> 赞同：0
> 
> 时间：2012-09-18T22:02:23.087
> 
> 标签：ios, uilabel, uifont, uitableview

我想在分组表视图的标题中显示三个字符串。问题是我附加了这个字符串`tableView titleForHeaderInSection`，我想用不同的颜色和字体在不同的行中显示每个字符串。

我目前拥有的是：

![在此处输入图像描述](../Images/a46af9f594196598a3bb9abd39c01d2d.png)

我想要的是：

![在此处输入图像描述](../Images/142bf711a509aa12cee5d9af4f189f1f.png)

我得到并附加这三个字符串如下

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection: (NSInteger) section 
{

    NSString * presenter = [[self agenda] getBriefingPresenter:section];
    NSString * time = [[self agenda] getBriefingTime:section];
    NSString * subject = [[[[self agenda] getMeetingBriefings] objectAtIndex:section] objectForKey:@"subject"];

    return [NSString stringWithFormat:@"%@\n%@  %@", subject, time, presenter ];

} 
```

处理页眉字体的方法

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {

    NSString *sectionTitle = [self tableView:tableView titleForHeaderInSection:section];
    if (sectionTitle == nil) {
        return nil;
    }

    // Create label with section title
    UILabel *label = [[UILabel alloc] init];
    label.frame = CGRectMake(45, 0, 484, 23);
    label.textColor = [UIColor whiteColor];
    label.font = [UIFont fontWithName:@"Century Gothic" size:17];
    label.text = sectionTitle;
    label.lineBreakMode = UILineBreakModeWordWrap;
    label.numberOfLines = 2;
    [label sizeToFit];
    label.backgroundColor = [UIColor clearColor];

    // Create header view and add label as a subview
    UIView *view = [[UIView alloc] initWithFrame:CGRectMake(100, 300, 320, 400)];
    [view addSubview:label];

    return view;
} 
```

那么如何解析这个 `sectionTitle`并在三行中打印为三个不同的标签呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:14:46.703

在`(UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section`中，创建 3 个具有特定字体和颜色的不同标签。您不能在单个 UILabel 上设置不同的字体/颜色；

所以你的代码更新了：

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {

    NSString * presenter = [[self agenda] getBriefingPresenter:section];
    NSString * time = [[self agenda] getBriefingTime:section];
    NSString * subject = [[[[self agenda] getMeetingBriefings] objectAtIndex:section] objectForKey:@"subject"];

    // Create label with section title
    UILabel *presenterLabel = [[UILabel alloc] initWithFrame:CGRectMake(45, 0, 484, 23)];
    presenterLabel.textColor = presenterColor;
    presenterLabel.font = presenterFont;
    presenterLabel.text = presenter;
    presenterLabel.backgroundColor = [UIColor clearColor];
    [presenterLabel sizeToFit];

    UILabel *timeLabel = [[UILabel alloc] initWithFrame:CGRectMake(45, presenterLabel.frame.size.height, 484, 23)];
    timeLabel.textColor = timeColor;
    timeLabel.font = timeFont;
    timeLabel.text = time;
    timeLabel.backgroundColor = [UIColor clearColor];
    [timeLabel sizeToFit];

    UILabel *subjectLabel = [[UILabel alloc] initWithFrame:CGRectMake(45, timeLabel.frame.origin.y + timeLabel.frame.size.height, 484, 23)];
    subjectLabel.textColor = subjectColor;
    subjectLabel.font = subjectFont;
    subjectLabel.text = subject;
    subjectLabel.backgroundColor = [UIColor clearColor];
    [subjectLabel sizeToFit];

    // Create header view and add label as a subview
    UIView *view = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 400)];
    [view addSubview:presenterLabel];
    [view addSubview:timeLabel];
    [view addSubview:subjectLabel];

    return view;
} 
```

你不需要`- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection: (NSInteger) section`

# javascript - 将窗口的高度应用于 margin-bottom 属性

> ID：12485741
> 
> 赞同：-3
> 
> 时间：2012-09-18T22:02:37.617
> 
> 标签：javascript, html, css, window, height

我有以下代码：

html:

```
<div id="footer-container">
    last line in page
</div> 
```

CSS：

```
#footer-container {
    margin-bottom:800px; // needs improvement
} 
```

这个想法是让用户完全看到背景图像。有用。但`800px`可以更短或更长，具体取决于用户窗口的尺寸。

是否可以`margin-bottom`在没有 javascript 的情况下提供窗口的当前高度值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T23:25:17.687

不可以。JavaScript 是访问元素呈现尺寸的唯一方法。但是，背景图像可以在现代浏览器中缩放：

[https://developer.mozilla.org/en-US/docs/CSS/background-size](https://developer.mozilla.org/en-US/docs/CSS/background-size)

# r - 如何增加 R 箱线图中箱线的粗细？

> ID：12485744
> 
> 赞同：7
> 
> 时间：2012-09-18T22:02:44.280
> 
> 标签：r, plot, boxplot

如何使用基本 R 图或箱线图函数增加箱线图“箱”部分的轮廓线的粗细？也就是说，我如何加粗定义分位数的框线。

对于这样的情节：

```
boxplot(rnorm(100,50,10), horizontal = TRUE, notch = TRUE) 
```

我猜我需要包括一个`pars =`声明

```
boxplot(rnorm(100,50,10), horizontal = TRUE, notch = TRUE, pars = ...) 
```

编辑：我对使用的猜测`pars =`来自对文档的第一眼看，该文档`boxplot`表明`pars =`可以调用“（可能有很多）更多图形参数的列表，例如 boxwex 或 outpch；这些被传递给 bxp（如果 plot 为真)..."

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-18T22:09:50.213

请参阅（链接到 from ）`boxlwd`中讨论的参数。例如`?bxp``?boxplot`

```
boxplot(rnorm(100,50,10), horizontal = TRUE, notch = TRUE, boxlwd = 4) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T22:06:02.707

您是在谈论围绕绘图区域的矩形吗？如果是这样，那么这可以跟随你的情节调用：

```
 box(lwd=5) 
```

# codeigniter - 仅使用用户名（无密码）的 Codeigniter 登录（身份验证）

> ID：12485749
> 
> 赞同：0
> 
> 时间：2012-09-18T22:03:10.747
> 
> 标签：codeigniter, authentication

有没有办法只使用用户名而不使用密码对 Codeigniter 进行身份验证？

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:22:06.680

当然，如果您不需要安全性，您可以轻松地基于单个用户名设置会话。这在 Codeigniter 中与在 PHP 或其他框架/语言中一样可能。

控制器示例：

```
function authenticate()
{
    // check postdata
    if ($this->input->post('username')):
       if (!$this->auth_model->login($this->input->post('username',true))):
            $this->session->set_flashdata('message', 'Bad username!');
       else:
            // go to user page or such...
       endif;
    endif;
    redirect('login'); // take user back to login page
} 
```

在上面的示例中，我假设您有一个模型（auth_model），它检查数据库中的用户名并为您设置登录会话。如果用户未登录，那么您会收到一条错误消息并被发送回登录页面...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T23:26:18.233

当然。希望您不要尝试存储任何安全的东西。简洁的 Datamapper ORM 解决方案将类似于以下内容。如果需要，适应 Active Record。

## CodeIgniter

```
class Login extends CI_Controller{
    function try_username(){
        $p = $this->input->post();
        if($p){
            $u = new User();
            $u->where('username', $p['username'])->get();
            if($u->exists()){
                $data = array("loggedin" => true "username" => $p['username']);
                $this->session->set_userdata($data);
                redirect('logged_in_controller');
            }

        }   
    }
} 
```

## 现在你的 HTML：

```
<form action='login/try_username' method='post'>
    <input type='text' name='username'/>
    <input type='submit'/>
</form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-12T14:07:23.683

你只需要用户名 = abc@gmail.com

公共函数 login_ulogin($identity, $remember=FALSE) {

```
 $this->trigger_events('pre_login');

    $this->trigger_events('extra_where');

    $query = $this->db->select('username,group_id, email, id, password, active, last_login')
        ->where('username', $identity)
        ->from('users')
        ->get();

    if ($query->num_rows() == 1)
    {

        $user = $query->row();

        $password = TRUE;//$this->hash_password_db($user->id, $password);

        if ($password === TRUE)
        {

            $this->set_session($user);

            $this->update_last_login($user->id);

            $this->clear_login_attempts($identity);

            if ($remember && $this->config->item('remember_users', 'ion_auth'))
            {
                $this->remember_user($user->id);
            }

            $this->trigger_events(array('post_login', 'post_login_successful'));
            $this->set_message('login_successful');

            return TRUE;
        }
    }

    //Hash something anyway, just to take up time
    //$this->hash_password($password);

    $this->increase_login_attempts($identity);

    $this->trigger_events('post_login_unsuccessful');
    $this->set_error('login_unsuccessful');

    return FALSE;
} 
```

# spring - 您能否在 Grails 中对复合 id 进行数据绑定，使其（或其中的一部分）变得可更新？

> ID：12485755
> 
> 赞同：2
> 
> 时间：2012-09-18T22:03:46.650
> 
> 标签：spring, hibernate, grails, grails-orm

我正在尝试通读 dataBind 文档，但还不是很清楚：

[http://grails.org/doc/2.1.0/ref/Controllers/bindData.html](http://grails.org/doc/2.1.0/ref/Controllers/bindData.html)

我有一个由 4 列组成的复合 ID，我需要更新其中之一。它拒绝 .save() 甚至不抛出错误。是否有一些配置可以让我更改这些值并保存模型？

如果我删除它并创建一个新记录，它将碰撞我在浏览器端使用数据表/jeditable 的 rowid，这不是一个真正的选择。但是，即使我将所有参数都包含在一个空列表中：

```
def a = WaiverExemption.find("from WaiverExemption as e where e.exemptionRowId = ?", [params.rowid])
a.properties = params
bindData(a, params, [include: []])
a.save(flush: true, failOnError: true) 
```

这似乎不起作用。我还尝试用它们自己和“id”明确命名列/属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T15:43:20.093

我对 bindData() 的实际作用感到困惑。对此仍然感到困惑。

如果您在 Grails 中有一个复合 id 并希望更改一个或多个列值，则 save() 将永远不会按照问题中的建议执行。相反，您需要使用 .executeUpdate()。您可以传入 HQL 以更新（尽管网络上的大多数示例都是用于删除）有问题的表，其语法几乎与正确的 SQL 相同。类似于“update domain d set d.propertyName = ?”的东西 应该管用。

我不知道这是否是明智之举，或者它是否违反了 Grails 应用程序应该如何工作的一些哲学规则，但它实际上会进行更新。我建议谨慎并进行大量测试。这废话对我来说都是巫术。

# javascript - onClick 函数“this”返回窗口对象

> ID：12485759
> 
> 赞同：21
> 
> 时间：2012-09-18T22:04:21.573
> 
> 标签：javascript, function, onclick, window, this

我的 JavaScript 应用程序遇到了一个令人头疼的问题。

如果我写一个这样的元素：

```
<li onClick="alert(this.tagName)"></li> 
```

我得到“LI”。

但是，如果我这样做：

```
<li onClick="foo()"></li> 
```

其中“foo（）”是：

```
function foo(){ alert(this.tagName); } 
```

我得到“未定义”。

我不知道“这个”在附加功能方面应该如何工作。但是，我很困惑，因为“this”没有提取元素，而是显然默认为“window”。我无法弄清楚为什么会这样。

有人有解释吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-18T22:47:42.063

这是因为您没有在 JavaScript 函数调用中传递对*this的引用。*JavaScript 函数中的*this引用的对象与**onClick*示例中的对象不同。试试这个：

```
 <li onClick="foo(this)"></li>

 function foo(item){ alert(item.tagName); } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-18T22:53:28.357

在内联侦听器中：

```
> <li onClick="alert(this.tagName)"></li> 
```

onclick 属性值有效地包装在一个函数中，并使用设置为 this 的元素调用，例如

```
function anon() {
  /* attribute value */
}

anon.call(element); 
```

当你在 body 中放置一个函数时，你基本上得到：

```
function anon() {
  foo();
} 
```

在这里，`this`within`anon`将是元素，但由于`foo`在没有设置的情况下调用`this`，它将是未定义的。在非严格模式下，`this`将默认为全局对象（`window`在浏览器中）。在严格模式下，`this`inside`foo`将是未定义的。

一种解决方案是将元素引用传递给函数：

```
<li onclick="foo(this)" ... > 
```

然后在函数中：

```
function foo(callingElement) {
  ...
} 
```

甚至：

```
<li onclick="foo.call(this)" ... >

function foo() {
  var callingElement = this;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T23:17:59.140

正如其他答案已经提到的那样， 的值`this`将取决于如何调用包含它的函数。但是由于您的示例是关于事件处理程序的，所以我想强调 cjc343 在评论中所说的内容：

> 如果您删除内联事件处理程序，您可能会发现它更明智。

实际上，这很简单。考虑到这个 HTML：

```
<ul id="list">
    <li id="item1">item 1</li>
    <li id="item2">item 2</li>
    <li id="item3">item 3</li>
</ul> 
```

以下 JavaScript 将说明删除内联处理程序和使用委托：

```
var list = document.getElementById('list');
list.addEventListener('click', function(evt){
    console.log("this is the element the event is bound to: " + this.id);
    console.log("the event target is the clicked element: " + evt.target.id);
}); 
```

[http://jsfiddle.net/J3Gje/](http://jsfiddle.net/J3Gje/)

这将适用于所有符合 W3C 事件模型的浏览器，包括 IE9。对于较旧的 IE，您必须使用`attachEvent`而不是`addEventListener`，并在事件名称前加上`"on"`. 更多细节[在这里](https://developer.mozilla.org/en-US/docs/DOM/element.addEventListener#Compatibility)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T22:56:07.623

[另一种选择是使用call](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)或[apply](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)，因此您不必将**其**作为参数传递。**这是一种在函数中设置this**值的内置机制。虽然我要指出，将事件处理程序直接添加到 html 有点过时。您可能想查看用于事件委托的 JS 框架（[jQuery](http://jquery.com/)、[Prototype](http://prototypejs.org/)、[Dojo](http://dojotoolkit.org/)、[YUI](http://yuilibrary.com/)等）。

 **小提琴：http: [//jsfiddle.net/bboone/Q2CkV/2/](http://jsfiddle.net/bboone/Q2CkV/2/)

**HTML**

```
<div onClick='alert(this.tagName);'>test</div>
<div onClick='foo.call(this);'>test2</div>​ 
```

**JS**

```
function foo(){ alert(this.tagName); } 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-18T22:50:44.893

如果您是 JavaScript 新手，请不要使用`this`or`new`关键字，否则您会弄错，或者您的代码会不必要地低效和复杂。但是，您要完成的工作如下：

```
<li onclick="foo(this)">some text</li> 
```

在该示例中，该列表项的单击事件会触发一个名为 foo 的函数。关键字作为`this`变量传入。关键字仅指调用相关函数的`this`实体，如果找不到该实体，它将引用`window`浏览器的对象。在这种情况下，调用该函数的实体是 DOM 中的列表项节点。

我仍然建议永远不要使用`this`关键字，以避免这种混乱向前发展。

编辑：另外，不要使用 tagName 属性，因为这不是标准的。而是使用该`nodeName`属性。**

# ruby-on-rails - 无法在开发盒上从 github 安装 gem

> ID：12485762
> 
> 赞同：0
> 
> 时间：2012-09-18T22:04:46.093
> 
> 标签：ruby-on-rails, ruby-on-rails-3, github, gem, bundler

我有一个可以在本地正常工作的 gem 文件。在我的 gem 文件中，我的一个 gem 使用这样的 github 位置安装...

```
gem 'rails3-jquery-autocomplete', :git => 'https://github.com/willfults/rails3-jquery-autocomplete.git' 
```

问题是当我在我的开发箱中运行 ssh 并运行 bundle 或 bundle install 时，我的服务器上出现以下错误...

```
Fetching gem metadata from https://rubygems.org/..
Fetching https://github.com/willfults/rails3-jquery-autocomplete.git
fatal: failed to open '/srv/www/socialu.com/https://github.com/willfults/rails3-jquery-autocomplete.git/objects': No such file or directory
Git error: command `git clone 'https://github.com/willfults/rails3-jquery-autocomplete.git' "/srv/www/socialu.com/https:/github.com/willfults/rails3-jquery-autocomplete.git/ruby/1.9.1/cache/bundler/git/rails3-jquery-autocomplete-186d8dd59401e0d4dd8c2860261d9ba55e0793f2" --bare --no-hardlinks` in directory /srv/www/socialu.com has failed. 
```

我该如何解决？谢谢。

更新：使用 git url 我得到以下内容......

> 获取 git://github.com/willfults/rails3-jquery-autocomplete.git 远程：计数对象：1846，完成。远程：压缩对象：100% (784/784)，完成。远程：总计 1846（增量 1072），重复使用 1688（增量 957） 接收对象：100%（1846/1846），481.07 KiB | 764 KiB/s，完成。解决增量：100% (1072/1072)，完成。ssh：无法解析主机名/srv/www/socialu.com/https：名称或服务未知致命：远程端意外挂断Git错误：`git clone --no-checkout "/srv/www/socialu.com/https:/github.com/willfults/rails3-jquery-autocomplete.git/ruby/1.9.1/cache/bundler/git/rails3-jquery-autocomplete-6e048304dc5207eafc457581b1fa2d0073d2e1ed" "/srv/www/socialu.com/https:/github.com/willfults/rails3-jquery-autocomplete.git/ruby/1.9.1/bundler/gems/rails3-jquery-autocomplete-060f2bea5e46"` 目录/srv/www/socialu.com中的命令失败。如果此错误仍然存​​在，您可以尝试删除缓存目录 '/srv/www/socialu.com/https:/github.com/willfults/rails3-jquery-autocomplete.git/ruby/1.9.1/cache/bundler/git/ rails3-jquery-autocomplete-6e048304dc5207eafc457581b1fa2d0073d2e1ed'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:29:37.453

这是一个路径问题，您可以看到 URL 与文件夹路径混合在一起。尝试使用 git:// URL 而不是 https://。

不确定它是否会起作用，但这是某个地方的路径问题。

还要检查服务器上的 ruby​​gems 版本，并在需要时进行更新（最新版本是 v1.8.24）。如果它按原样工作，您的机器上会有一些不同的东西。

```
gem -v 
```

希望有帮助。

# c# - 如何在 JPG 图像中找到每英寸像素值？

> ID：12485764
> 
> 赞同：0
> 
> 时间：2012-09-18T22:05:00.187
> 
> 标签：c#, asp.net, image, jpeg, ppi

我正在尝试验证某些图像不允许低于每英寸 300 像素的图像，有没有办法使用 C# 在 ASP.NET 上找到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-13T14:47:55.563

.NET Framework的`Image`对象将为您提供位图（包括 JPG）的 PPI。

```
Image image = new Bitmap(@"C:\myimage.jgp");
float ppi = image.HorizontalResolution; // the image's pixels per inch
float widthInInches = image.PhysicalDimension.Width / ppi; 
```

似乎对我有用。我能够辨别出我在 PDF 中使用的特定图像是 90 ppi。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T23:23:15.937

您必须从图像中读取 EXIF 数据。

在这里，您有一个使用 ExifLib 的示例，说明如何做到这一点

[ExifLib - 用于 .NET 2.0+ 的快速 Exif 数据提取器](http://www.codeproject.com/Articles/36342/ExifLib-A-Fast-Exif-Data-Extractor-for-NET-2-0)

请注意，并非所有 jpeg 图像都有分辨率信息。而且，即使他们拥有它，您也可以使用完全不同的分辨率打印它们。即 200px 宽的图片可以使用 1 英寸宽为 200dpi 打印。使用 2 英寸打印的相同图像是 100dpi，使用 1/2 英寸打印是 400dpi。

**编辑：甚至可以使用本机 .NET 框架**[Image.PropertyItems 属性](http://msdn.microsoft.com/en-us/library/system.drawing.image.propertyitems.aspx)获取此信息

# hibernate - hql 不支持 DML 操作

> ID：12485766
> 
> 赞同：1
> 
> 时间：2012-09-18T22:05:03.760
> 
> 标签：hibernate, model, hql, sql-update

我正在尝试更新查询，但此错误不断出现：

```
public List<Object[]> rosterGrdUpdate(String stuBunValue, String stuGrdValue, String pcID, String crsCd) {
List<Object[]> updateRosterInfo = null;
java.util.Date today = new java.util.Date();
Date Date_toDay = new java.sql.Date(today.getTime());
String modifyFlagUpdate = "U";
String modifyFlagWh = "N";
Query querySt  = null;
String sql1 = "update WgRoster wr set wr.grade= :gr, wr.modify_flag= :mf, wr.grade_date= :gd, wr.user_id= :ud" +
" where wr.stubun= :stb and wr.crs_cd= :cr and wr.modify_flag !=  :mfu";
querySt  = session.createQuery(sql1);
querySt.setParameter("gr", stuGrdValue);
querySt.setParameter("mf", modifyFlagUpdate);
querySt.setParameter("gd", Date_toDay);
querySt.setParameter("ud", pcID);
querySt.setParameter("stb", stuBunValue);
querySt.setParameter("cr", crsCd);
querySt.setParameter("mfu", modifyFlagWh);  
int res = querySt.executeUpdate();  
return  (List<Object[]>)querySt.list(); 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-04T12:58:23.950

`querySt`对象只能支持给定的`executeUpdate()`操作性质。删除`querySt.list()`. 进行另一个查询，即

```
query  = session.createQuery("from WgRoster"); 
```

然后打电话`query.list();`

# php - 高效的 cronjob 推荐

> ID：12485770
> 
> 赞同：0
> 
> 时间：2012-09-18T22:05:22.423
> 
> 标签：php, algorithm, mongodb, cron

关于我的用例的简要概述：考虑一个具有一百万个条目的数据库（很可能是 mongodb）。每个条目的值需要每天通过调用 API 进行更新。如何设计这样的cronjob？我知道 Facebook 也有类似的做法。我唯一能想到的就是有多个作业，将数据库条目分成批次，每个作业更新一个批次。我确信那里有更聪明的解决方案。我也不确定使用什么技术。任何建议表示赞赏。

-卡兰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T14:13:09.630

鉴于“保持缓存温暖”的更新问题上下文，除非该数据能够舒适地放入可用内存中，否则接触所有数据库文档的策略可能会减少而不是提高性能。

[MongoDB 中的缓存](http://www.mongodb.org/display/DOCS/Caching)依赖于文件系统缓存的操作系统行为，这通常通过遵循最近最少使用 (LRU) 方法来释放缓存。这意味着随着时间的推移，内存中的工作数据集自然应该是“温”数据。

如果您强制将数据读入内存，您可能会加载最终用户很少（或从不）访问的文档......可能会以牺牲应用程序用户实际上可能更频繁地请求的数据为代价。

有一个“预热”缓存的用例..例如，当您重新启动 MongoDB 服务器并希望将数据或索引加载到内存中时。

在 MongoDB 2.2 中，您可以为此目的使用新[`touch`命令。](http://docs.mongodb.org/manual/reference/command/touch/)

其他预热策略本质上是使用[`explain()`](http://www.mongodb.org/display/DOCS/Explain). 与其尝试最小化索引条目 ( `nscanned`) 和文档 ( `nscannedObjects`) 的数量，不如编写一个有意最大化这些条目的查询。

根据您的 API 响应时间目标.. 即使某人的初始调用需要将他们的数据提取到内存中，这仍然应该是一个相当快速的索引检索。除非您的应用程序有很多处理开销，否则 3 到 4 秒响应的目标似乎很慷慨：MongoDB 中默认的“慢”查询值为 100 毫秒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:23:31.970

从技术角度来看，您可以在 mongodb shell 中执行脚本，并通过 cron 执行它们。如果您安排 cron 运行如下命令：

`./mongo server:27017/dbname--quiet my_commands.js`

Mongodb 将执行 my_commands.js 脚本的内容。现在，举一个过于简单的例子来说明这个概念。如果您想找到一个名为`sara`并插入属性的人（是的，不切实际的示例），您可以在`.js`脚本文件中输入以下内容。

```
person = db.person.findOne( { name : "sara" } );
person.validated = "true";
db.people.save( person ); 
```

然后每次 cron 运行时，该记录都会更新。现在，给你的 api 添加一个循环和一个调用，你可能会有一个解决方案。有关这些命令和示例的更多信息可以在[mongodb 文档](http://downloads.mongodb.org/docs/mongodb-docs-2011-09-15.pdf)中找到。

但是，从设计的角度来看，您确定需要每晚更新每条记录吗？有没有办法确定需要处理的更合理的记录子集？或者，当数据被检索并提供给将要使用它的任何人时，是否可以在数据上调用 api？

# facebook - 防止在 facebook 上重复发布 watch action

> ID：12485774
> 
> 赞同：0
> 
> 时间：2012-09-18T22:05:45.193
> 
> 标签：facebook, facebook-graph-api, publish

我已在我的网站上成功实施 Facebook 观看操作。问题是每次我打开一个特定的视频时，根据我打开的次数，它会将每个视频记录为单独的观看操作。我想为每个独特的视频只记录一次观看动作。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:28:40.157

1）检查您自己的数据库，看看您是否已经针对该对象发布了该操作，并且根本不发布两次 - 您已经记录了这个，因为有必要存储操作实例 ID 以删除监视操作稍后，如果用户要求您

2) 在操作的 OG 设置中将操作设置为唯一。这可能不适用于内置操作，我不确定 100%，但在一般情况下，您可以将操作标记为“唯一”，并且每个操作/对象组合只能为用户发布一次

# android - 运行 Android 4.04 的 socket.connect() Galaxy Tab 2 上的 NullPointer 异常

> ID：12485785
> 
> 赞同：3
> 
> 时间：2012-09-18T22:07:00.247
> 
> 标签：android, samsung-mobile, galaxy-tab

我似乎在 socket.connect() 上遇到了这个奇怪的错误：

```
09-18 14:41:22.968: W/System.err(2593): java.lang.NullPointerException
09-18 14:41:22.968: W/System.err(2593):     at android.sec.enterprise.BluetoothUtils.**isSocketAllowedBySecurityPolicy**(BluetoothUtils.java:106)
09-18 14:41:22.968: W/System.err(2593):     at android.bluetooth.BluetoothSocket.connect(BluetoothSocket.java:220)
09-18 14:41:22.968: W/System.err(2593):     at com._._.android._._.bluetoothmodule.BluetoothController.connectToDevice(BluetoothController.java:136)
09-18 14:41:22.976: W/System.err(2593):     at com._._.android._._.controllermodule.ControllerModule.connectToDevice(ControllerModule.java:235)
09-18 14:41:22.976: W/System.err(2593):     at com._._.android._._.controllermodule.ControllerModule.connectToDevice(ControllerModule.java:263)
09-18 14:41:22.976: W/System.err(2593):     at com._._.android._._.service.ConnectionService.onHandleIntent(ConnectionService.java:70)
09-18 14:41:22.976: W/System.err(2593):     at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:65)
09-18 14:41:22.976: W/System.err(2593):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-18 14:41:22.976: W/System.err(2593):     at android.os.Looper.loop(Looper.java:137)
09-18 14:41:22.976: W/System.err(2593):     at android.os.HandlerThread.run(HandlerThread.java:60) 
```

是的，我在连接之前检查套接字是否为空。我似乎只在**运行 4.0.4 的 Galaxy Tab 2 上**遇到这个问题。我的代码在其他设备/android 版本 [包括 JB] 上运行良好。不知道这里可能发生了什么。下面列出的是一小块演示我如何初始化我的套接字：

```
Method m = bluetoothDevice.getClass().getMethod(
            "createInsecureRfcommSocket", new Class[] { int.class });
Logging.getInstance().logMessage(this.getClass().getSimpleName(), "Returned the Reflection method successfully..",Logging.LOG_ERROR);
      // get readSocket
    mreadSocket = (BluetoothSocket) m.invoke(bluetoothDevice, 1);
      assert (mreadSocket != null) : "readSocket is Null";
 if (mreadSocket != null) {

        mreadSocket.connect();
} 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T04:31:42.257

**警告：以下代码可能不安全，使用风险自负**

在我的情况下，我能够使用`createInsecureRfcommSocketToServiceRecord`而不是连接，`createRfcommSocketToServiceRecord`但我看到你已经在这样做了。我的代码看起来更像这样（删除了错误/异常检查）：

```
BluetoothDevice device;
String deviceName = ... selected or hardcoded device name. See Android HDR sample code
BluetoothDevice[] mAllBondedDevices = (BluetoothDevice[]) mBluetoothAdapter.getBondedDevices().toArray(new BluetoothDevice[0]);

for (BluetoothDevice d : mAllBondedDevices) {
  if (deviceName.equals(d.getName())) {
    device = d;
    break;
  }
}

UUID uuid = device.getUuids()[0].getUuid();
//FAILED: socket = device.createRfcommSocketToServiceRecord(uuid);
// Succeeds: Warning, INSECURE!
socket = device.createInsecureRfcommSocketToServiceRecord(uuid);
socket.connect();
this.dos = new DataOutputStream(new BufferedOutputStream(socket.getOutputStream()));
this.dis = new DataInputStream(new BufferedInputStream(socket.getInputStream()));
//etc 
```

请注意，虽然不安全的连接并不完美，但在我们的例子中，不安全的连接比没有连接更可取。我发布了这个答案，以便您可以尝试备用代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-14T00:18:40.590

我在 Galaxy tab 2 上遇到了同样的问题，我解决了：

```
 BluetoothSocket tmp = null;
        try {
            tmp = device.createRfcommSocketToServiceRecord(SPP_UUID);

            // for others devices its works with:
            // Method m = device.getClass().getMethod("createRfcommSocket", new Class[] {int.class});

            // for galaxy tab 2 with:
            Method m = device.getClass().getMethod("createInsecureRfcommSocket", new Class[] {int.class});

            tmp = (BluetoothSocket) m.invoke(device, 1);
        } catch (IOException e) {
            Log.e(TAG, "failed! error: " + e.getMessage());
        }
        socket = tmp;

        socket.connect();
        Log.i(TAG, "Client Connected!"); 
```

希望这会有所帮助 =D

# c++ - 支持windows的p2p c++ 库？

> ID：12485787
> 
> 赞同：0
> 
> 时间：2012-09-18T22:07:09.773
> 
> 标签：c++, windows, visual-c++, udp, p2p

我有一个由 opengl 制成的基本虚拟环境 (VE)。它有许多可移动的立方体。它有一个用户控制的球体，可以碰撞并改变 VE 中可移动立方体的位置。我想将 VE 扩展到多用户控制。为了在不同用户的 VE 副本中移动对象位置保持一致，我需要在用户之间创建一个 P2P 组。我已经使用 Visual Studio 在 Windows 上创建了应用程序。哪些简单的 P2P、c++ 库支持 P2P 组的形成和对等点之间的 UDP 消息传递？

此外，我希望通过将 VE 划分为小区域来减少对等点之间的通信并形成区域，从而创建许多单独的 P2P 组，例如在一个区域的边界上的用户可以属于 2 个 p2p 组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T12:20:01.390

我建议从[ZeroMQ](http://www.zeromq.org/)中获利。它是轻量级的，但非常强大和可靠，社区很大。在他们的网站上，您还可以找到许多实现不同类型的客户端-服务器应用程序的示例。

# jquery - jQuery固定大小

> ID：12485789
> 
> 赞同：1
> 
> 时间：2012-09-18T22:07:37.473
> 
> 标签：jquery, css

我尝试修复背景和图像大小并与 JQuery 发生冲突。我在这里练习：http: [//jsfiddle.net/Cyber​​Tramp /uZXQu/](http://jsfiddle.net/CyberTramp/uZXQu/)

问题是背景图像和 div 应该具有与浏览器分辨率“始终居中”相同的大小，我的原始图像宽度为 1500 像素

我有的：

CSS

```
.right_circle
{
    position: relative;
    width: 50%;
    height: 300px;
    overflow: hidden;   
    background-image: url('http://cloud.graphicleftovers.com/9583/261791/blue-and-orange-circle-globe.jpg'); //original size 500 × 500 must = screen resolution
}
.left_circle
{    position: relative;
    background-image: url('http://www.kidopo.com/wp-content/uploads/2011/05/Circle-mazep.gif');    
}​ 
```

HTML

```
<body class='left_circle'>
<div class='right_circle'></div>
</body>​ 
```

jQuery

```
$('html').mousemove(function(e) {
    var page = $('html').width();
    if (page / 2 > e.pageX) {
        $('.right_circle').css('width', page - e.pageX);
    } else {
        $('.right_circle').css('width', page - (e.pageX - (page / 2)) - (page / 2));
    }
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:47:14.293

> 问题是背景图像和 div 应该具有与浏览器分辨率“始终居中”相同的大小

添加以下 CSS：

```
background-repeat: no-repeat;
background-position:center;
background-attachment:fixed;
background-size: 100% 100%; 
```

还要尝试重新组织您的样式，以仅指定共享样式。

完整的 CSS：

```
.right_circle, .left_circle{
    background-repeat: no-repeat;
    background-position:center;
    background-attachment:fixed;
    background-size: 100% 100%
}

.right_circle{ 
    width: 50%;
    height: 300px;
    background-image: url('http://cloud.graphicleftovers.com/9583/261791/blue-and-orange-circle-globe.jpg');  
}

.left_circle{    
    background-image: url('http://www.kidopo.com/wp-content/uploads/2011/05/Circle-mazep.gif');
}​ 
```

### [DEMO](http://jsfiddle.net/FranWahl/NT8PU/) - background-image & div 与浏览器大小相同并居中

# facebook - 授权 facebook 标签应用

> ID：12485799
> 
> 赞同：0
> 
> 时间：2012-09-18T22:08:39.397
> 
> 标签：facebook, node.js, express, facebook-javascript-sdk

我需要开发一个在页面选项卡内运行的 facebook 应用程序。只有喜欢此页面的用户才能使用该应用程序（并因此对其进行授权）。

使用**signed_request**参数可以很容易地知道给定的 facebook 用户是否喜欢该页面：

```
var isFan = false;
if (req.facebook.signedRequest && req.facebook.signedRequest.page){
    isFan = req.facebook.signedRequest.page.liked;
} 
```

这工作得很好。现在，一旦用户喜欢该页面，我会显示一个“启动此应用程序”按钮，该按钮将对其进行授权：

```
$('#authApp').click(function(){

                FB.login(function(response) {

                    if (response.authResponse) {
                        window.location = window.location;
                    }
                }, {scope: 'user_likes,user_photos'});
                return false;
            }); 
```

如您所见，如果应用程序授权成功，我会重新加载页面。

但是，当页面重新加载时，**signed_request.page**参数会丢失。因此，非粉丝的 html 标记出现了。

这是在授权应用程序后重新加载时 signed_request 的样子：

{

> 算法：'HMAC-SHA256'，代码：'...'，issued_at：1348003786，user_id：'100...'}

如果我在那之后直接刷新页面。一切都很好，页面信息又出现了：

> {算法：'HMAC-SHA256'，过期：1348009200，issued_at：1348004248，oauth_token：'AA..'，页面：{ id：'490 ...'，喜欢：true，admin：true}，用户：{国家: 'ec', 语言环境: 'en_US', 年龄: { min: 21 } }, user_id: '100...' }

这是应该如何工作的吗？

解决此问题的推荐方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T09:31:51.663

> 但是，当页面重新加载时，signed_request.page 参数会丢失。

当然是，因为它仅在*初始*加载到 iframe 时传递给您的应用程序（通过提交到 iframe 的带有 method=post 的表单）。

如果您想在页面重新加载后获得其中包含的数据，您有两种选择：

*   将其放入您自己的会话中，以便您可以随时从那里访问它。

*   不要只是在 iframe 中重新加载您的应用程序，而是要重新加载整个 Facebook 页面（JavaScript、top.location）。然后，您的应用程序将再次加载到 iframe 中，并且还会第二次发布 signed_request。

# jquery - 隐藏某些行后获取表格行数

> ID：12485801
> 
> 赞同：1
> 
> 时间：2012-09-18T22:08:45.857
> 
> 标签：jquery, html

我正在尝试获取表中的行数，例如...

```
<table>
   <tr id="siteA">
      <td>1</td>
      <td>siteA</td>
   </tr>

   <tr id="siteB">
      <td>2</td>
      <td>siteB</td>
   </tr>

   <tr id="siteA">
      <td>3</td>
      <td>siteA</td>
   </tr>
</table> 
```

使用以下 JQuery 代码...

```
var rowCount = $('table tr').length; 
```

如果表未更改，则返回的行数为 3。

在尝试隐藏几行（例如#siteA）并再次计算行数后，我仍然得到 3。

```
$("tr#siteA").hide();
var rowCount = $('table tr').length; 
```

如何确保计算的行数不包括已隐藏的行数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T22:11:19.463

您可以使用`:visible`选择器。

```
var rowCount = $('table tr:visible').length; 
```

# mockito - 如何为动作类编写模拟测试（struts2）

> ID：12485802
> 
> 赞同：1
> 
> 时间：2012-09-18T22:08:46.173
> 
> 标签：mockito

`

> 块引用

如何使用 mockito 编写测试类来测试动作类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T00:12:48.067

你在使用 JUnit 吗？考虑为您的类必须满足的每个要求或要求的每个特定场景使用一种测试方法。计划好每种测试方法后，制定

*   您需要在每种测试方法中设置什么，
*   在测试方法中对你的类的实际调用会是什么样子，
*   在测试方法结束时需要验证的内容。

当您的任何测试方法可能使用您实际尝试测试的类*之外的功能时，请使用 Mockito。*模拟就是从测试期间发生的事情中删除其他类（协作者类）的行为。一旦您确定了这些其他类是什么，以及您希望它们具有什么行为，那么您就可以开始使用 Mockito。

但是你真的需要先计划好你的测试。Mockito 不是为您测试事物的灵丹妙药。

抱歉，我真的无法给出比这更详细的答案，除非您愿意为您的问题添加一些细节。现在，你的问题非常模糊。

# django - 带有 Django 的 bat 文件的 Apache 权限

> ID：12485804
> 
> 赞同：0
> 
> 时间：2012-09-18T22:09:04.410
> 
> 标签：django, apache, permissions, batch-file

我见过很多类似的问题，但我仍然失败了。我有 win XP、Apache 2.2、Django 1.4、Python 2.7 和 mod_wsgi 3.3。我要做的就是当您点击 bat 文件执行的页面并回显 hi。这在我在 django 内部开发服务器上运行时有效。但是当我到达 Apache 时，它​​失败了，并且在 error.log 中我收到了消息

> 系统无法写入指定的设备。
> 系统无法写入指定的设备。
> 系统无法写入指定的设备。
> 系统无法写入指定的设备。
> 系统无法写入指定的设备。

我在其他许多地方都没有看到这个错误。大多数人似乎得到“权限被拒绝”。我仍然认为权限是错误的。所以当我运行它是我在控制台中得到的 django 内部服务器：

> 验证模型...
> 
> 使用设置 'testsite.settings'发现 0 个错误Django 版本 1.4
> 开发服务器正在 http://127.0.0.1:8000/ 上运行
> 使用 CTRL-BREAK 退出服务器。
> 
> C:\Sites\cprm>echo hi
> hi
> [18/Sep/2012 14:58:45] "GET / HTTP/1.1" 200 63

这似乎很好。唯一让我失望的是我是从 /testsite 而不是 /cprm 运行的。我可以 cd .. 之前。无论如何，因为在内部服务器中它正在写入控制台，我想我需要在 apache 中做同样的事情。我不确定 apache 控制台在哪里。我尝试向 apache 日志文件添加权限，因为这是生成错误的地方。我不确定这是否等同于常规控制台。

我的 Apache 文件如下所示（忽略反引号）：

```
<`VirtualHost *>

ServerName http://example.com:80

WSGIScriptAlias /cprm "C:/sites/cprm/wsgi.py"
WSGIScriptAlias /testsite "C:/sites/testsite/wsgi.py"

<Directory "C:/sites">
        AllowOverride None
        Options None
        Order allow,deny
        Allow from all
</Directory>

<Directory "C:/Program Files/Apache Software Foundation/Apache2.2/logs">
        AllowOverride None
        Options None
        Order allow,deny
        Allow from all
</Directory>

<`/VirtualHost> 
```

我的观点看起来像这样：

```
from django.http import HttpResponse
import datetime, os

def home(request):
    os.system('C:/Sites/testsite/testsite/test.bat')
    now = datetime.datetime.now()
    html = "<html><body>It is now %s.</body></html>" % now
    return HttpResponse(html) 
```

这基本上只是我尝试做的一个快速测试。

* * *

编辑

嗨，帕查。感谢您的回复。我现在已经阅读了一些关于这个主题的内容。所以我做了你指出的改变。我的 wsgi.py 文件如下所示：

> 导入操作系统、系统
> 
> path = 'C:/Sites/testsite'
> 
> 如果路径不在 sys.path:
> sys.path.append(path)
> 
> os.environ.setdefault("DJANGO_SETTINGS_MODULE", "testsite.settings")
> sys.stdout = sys.stderr
> print 'hi'
> from django.core.wsgi import get_wsgi_application
> application = get_wsgi_application()

然后，当我转到 error.log 时，我确实看到打印了“hi”。所以这很好。但是，带有 echo hello 的 test.bat 文件没有执行，我仍然收到相同的消息。并感谢您的许可建议。我现在不再使用虚拟。我还没有准备好。关于我可以尝试的任何其他想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T23:25:52.457

您的问题似乎与标准输出的处理方式有关。WSGI 默认禁用标准输出。这就是为什么您的程序在开发服务器中运行良好（它将输出重定向到启动服务器的终端）但不适用于 Apache。

您可以使用放入虚拟主机 conf 文件中的配置指令（与其他 WSGI 指令一起）在 WSGI 中启用标准输出：

```
WSGIRestrictStdout Off 
```

但是，请考虑到 Apache 没有与任何终端关联。如果您想查看程序的输出，那么您可以做的一件事是将标准输出重定向到标准错误流，方法是将其添加到您的 WSGI 文件中：

```
sys.stdout = sys.stderr 
```

重新启动 Apache，您应该会在 Apache 的 error.log 文件中看到应用程序的任何输出（或任何子进程，如您的情况）。

**注意**：不要将 Apache 日志文件目录添加到您的虚拟主机配置中。您没有授予 Apache 对这些文件的权限，而是允许*任何人*查看它们，这是您可以想象的不小的安全风险。

* * *

**更新**

*避免权限问题*

您可能想尝试在守护程序模式下使用 WSGI。这样，Web 应用程序就可以在您的用户名下执行（很像使用内部开发服务器时）。在您的情况下，配置指令应该是这样的：

```
WSGIDaemonProcess site1 user=<USERNAME> group=<GROUP> processes=1 threads=1
WSGIScriptAlias /testsite "C:/sites/testsite/wsgi.py"

<Directory "C:/sites/testsite/">
    WSGIProcessGroup site1
    WSGIApplicationGroup %{GLOBAL}
    Order allow,deny
    Allow from all
</Directory> 
```

您必须在您的 Windows 机器中用您的用户名和组进行替换（尽管它可能只通过设置用户名来工作）`<USERNAME>`。`<GROUP>`这通常是避免权限问题的好方法，因为您的应用程序将以与开发服务器执行的方式非常相似的方式执行。（请注意，我们只使用一个进程和一个线程只是为了使 Apache 的行为更加接近开发服务器的行为。您肯定希望在生产中将这些值更改为更高的值）。

[您可以在此处](http://code.google.com/p/modwsgi/wiki/ConfigurationDirectives#WSGIDaemonProcess)查看守护程序模式文档

*执行你的脚本*

要从 Python 代码调用外部程序，模块`subprocess`通常优于`os.system`调用。前者允许您更好地控制新进程的执行方式，而后者只是将调用传递给操作系统。

你可以试试这个`subprocess.check_output`功能。它执行脚本/程序并允许您捕获其输出：

```
print subprocess.check_output(['C:\Sites\testsite\testsite\test.bat'], shell=True) 
```

它还有一个额外的优势，即您可以在字符串变量中捕获输出。（顺便说一句，在调用 bat 脚本时，您可能需要也可能不需要`shell=True`Windows 中的参数，我不确定）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T01:38:24.957

**检查事项**

1.  权限 文件 C:/Sites/testsite/testsite/test.bat 的用户权限是什么？

它们是为运行 Apache 进程的同一用户读取的吗？

1.  您是否为所有登录用户安装了 python，而不仅仅是为了？

2.  您是否查看过您的 Apache conf 指令？用户/组：运行 httpd 的用户/组的名称（或#number）。与大多数系统服务一样，创建一个专门的用户和组来运行 httpd 通常是一种很好的做法。

    用户 carlos 组管理员

同一用户是否有权读取文件系统上的文件？

```
<Directory "C:/Sites/testsite/testsite/">
    AllowOverride None
    Options None
    Order deny,allow
   Allow from all
</Directory> 
```

# c# - C# 动态调用

> ID：12485808
> 
> 赞同：0
> 
> 时间：2012-09-18T22:09:17.407
> 
> 标签：c#

再会，

我有一种情况，我正在使用包含一个名为 ImportFileContext 的类的代码。代码如下所示：

```
// One of 5 different types can be passed in
public AddImportData(CustomType ModelData)
{
    // Depending on which 5 different types, the formatted type will change
    FormattedType data = ConvertModelDataToFormattedData(ModelData);
    using (var db = new ImportFileContext())
    {
        // Can this next line be made dynamic?
        db.ImportFormattedData.Add(data);
        db.SaveChanges();
    }
} 
```

基本上，CustomType 将始终传递给该方法。但是，可以传入五种不同的自定义类型。根据可以传入的5种，将修改数据。

用例：

1.  传入的自定义类型，将数据格式化为特定格式，然后将该项目添加到数据库实例的列表中。
2.  传入的自定义类型 2，将数据格式化为特定格式，然后将该项目添加到数据库实例的列表中。
3.  传入的自定义类型 3，将数据格式化为特定格式，然后将该项目添加到数据库实例的列表中。

所以我正在寻找一种根据数据类型将项目添加到列表的方法，而无需编写几种不同的方法来测试我收到的类型然后添加项目。我知道策略模式并且我可以使用它，但是将项目添加到列表中呢？

我真的在努力避免编写如下所示的代码：

```
// One of 5 different types can be passed in
public AddImportData(CustomType ModelData)
{
    // Depending on which 5 different types, the formatted type will change
    FormattedType data = ConvertModelDataToFormattedData(ModelData);
    using (var db = new ImportFileContext())
    {
        if (typeof(ModelData) == "CustomType")
            db.ImportFormattedData.Add(data);
        elseif (typeof(ModelData) == "CustomType1")
            db.ImportCsvData.Add(data);
        elseif (typeof(ModelData) == "CustomType2")
            db.ImportTabDelimetedData.Add(data);
        db.SaveChanges();
    }
} 
```

TIA,

科森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:38:05.960

我不知道这对您的应用程序有多可行，但您始终可以将特定行为添加到 CustomType 类，并且子类可以根据需要实现它。

```
public class CustomType
{
    public virtual void FormatAndWriteToDB(DataBase db);
} 
```

然后根据需要子类覆盖

```
public class CustomType1 : CustomType
{
    public override void FormatAndWriteToDB(DataBase db)
    {
        FormattedType data = ConvertModelDataToFormattedData(ModelData);
        db.ImportCsvData.Add(data);
    }
} 
```

这将使您的代码在示例方法中非常干净：

```
public AddImportData(CustomType ModelData)
{
    ModelData.FormatAndWriteToDB(db);
    db.SaveChanges();
} 
```

当然你可以稍微改变一下。例如，如果 FormattedType 调用对它们都是通用的，则可以将其保留在 AddImportData 方法中，并将其作为参数传递给 FormatAndWriteToDB 方法。

这样做的好处是未来的添加只需要实现 CustomType 的新子类，并且不需要对 AddImportData 进行修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T13:44:50.237

在我看来，您正在寻找双重调度。您可以使用访问者模式来做到这一点——这基本上是 David Mason 所详述的——通过将逻辑（访问）放入包含数据的类中，您可以将算法与数据分离。这当然有效，但需要您修改算法之外的类才能访问。

我发现这很复杂，而且它确实存在，因为静态类型的面向对象语言通常不会进行运行时重载。幸运的是，在 C# 4 中，他们引入了`dynamic`允许使用更容易实现双重分派的关键字——或者至少以一种看起来更像方法重载的方式。这意味着您创建方法重载，将值分配给动态变量，然后调用该方法。将在运行时根据该值选择被调用的方法。例如：

```
public static void AddImportData(CustomType ModelData)
{
    FormattedType data = ConvertModelDataToFormattedData(ModelData);
    using (var db = new ImportFileContext())
    {
        dynamic temp = ModelData;
        ImportData(ModelData, data, db);
    }
}

private static void ImportData(CustomType modelData, FormattedType data, ImportFileContext db)
{
    db.ImportFormattedData.Add(data);
    db.SaveChanges();
}

private static void ImportData(CustomType1 modelData, FormattedType data, ImportFileContext db)
{
    db.ImportCsvData.Add(data);
    db.SaveChanges();
}
private static void ImportData(CustomType1 modelData, FormattedType data, ImportFileContext db)
{
    db.ImportTabDelimetedData.Add(data);
    db.SaveChanges();
} 
```

我在我的博客上有更多详细信息：http: [//msmvps.com/blogs/peterritchie/archive/2010/05/24/using-the-dynamic-keyword-in-c-to-improve-object-orientation.aspx](http://bit.ly/ghLVqk)

# c# - 如何为动态数据生成 JSON

> ID：12485809
> 
> 赞同：0
> 
> 时间：2012-09-18T22:09:19.340
> 
> 标签：c#, json

我有一组数据（键值对）需要映射到 json，注意键不固定，键名不固定。谢谢，例如

如何映射

```
dict<string, list<string>>
    {"Module",new List<String>(){"Allprice"}},  
        {"Code",new List<String>(){"PA0000606", "PA0000669"}},  
     {"ContinuosForwardPeriod", new List<string>() {"0"} ,
     { "TimeStampID", new List<string>{"0"},
    {"PriceTypeID": "8"} 
```

到

```
[
 { "Module": "Allprice", 
   "Code": "PA0000606", 
   "ContinuosForwardPeriod": "0", 
   "TimeStampID": "0", 
   "PriceTypeID": "8" 
 },
 { "Module": "Allprice", 
   "Code": "PA0000669", 
   "ContinuosForwardPeriod": "0", 
   "TimeStampID": "0", 
   "PriceTypeID": "8" 
 }
] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:14:01.227

```
using System.Web.Script.Serialization.JavaScriptSerializer;    
JavaScriptSerializer oSerializer = new JavaScriptSerializer();
string JSON = oSerializer.Serialize(yourDict); 
```

# android - s.replace() 在 TextWatcher 中的 Android EditText 中不起作用

> ID：12485810
> 
> 赞同：1
> 
> 时间：2012-09-18T22:09:23.943
> 
> 标签：android, android-layout, android-edittext

我有一个 EditText，用户应该在其中输入一个包含小数的数字，我希望在输入数字上自动添加一个千位分隔符我尝试了其他几种方法，但有些方法不允许浮点数，所以我想出了这个有效的代码只是字符串输入没有被实时编辑为一个可能有千位分隔符的字符串，并且错误似乎源于 s.replace();

```
am2 = new TextWatcher(){
    public void beforeTextChanged(CharSequence s, int start, int count, int after) {
    }
    public void onTextChanged(CharSequence s, int start, int before, int count) {}
    public void afterTextChanged(Editable s) {
        if (s.toString().equals("")) {
            amount.setText("");
            value = 0;
        }else{
            StringBuffer strBuff = new StringBuffer();
            char c;
            for (int i = 0; i < amount2.getText().toString().length() ; i++) {
                c = amount2.getText().toString().charAt(i);
                if (Character.isDigit(c)) {
                    strBuff.append(c);
                }
            }
            value = Double.parseDouble(strBuff.toString());
            reverse();
            NumberFormat nf2 = NumberFormat.getInstance(Locale.ENGLISH);
            ((DecimalFormat)nf2).applyPattern("###,###.#######");
            s.replace(0, s.length(), nf2.format(value));
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:42:48.297

我认为您应该`setText()`在更改文本后使用 edittext `editext.setText(s);`在替换字符串后执行类似的操作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-24T11:10:09.007

简单`s = s.replace(0, s.length(), nf2.format(value));` 即 `s`需要分配变量。

# c# - 需要双正则表达式吗？

> ID：12485811
> 
> 赞同：1
> 
> 时间：2012-09-18T22:09:25.203
> 
> 标签：c#, regex

我正在尝试使用正则表达式来解析网址。

url的格式可以是这样的

yadayadahttp://www.theurl.com/apage
yadayadahttp://www.theurl.com/yadayadahttp
://www.theurl.com
yadayadahttp://meow.theurl.com/apage
yadayadahttp://theurl.com
yadayadahttp: //theurl.com/

这是我的两个正则表达式来处理有和没有 www（或任何其他子域）。

www 正则表达式：

```
 \bhttp:\/\/\b\w*[a-z0-9]\.\w*[a-z0-9]\.\w*[a-z0-9] 
```

和非 www 正则表达式：

```
 \bhttp:\/\/\b\w*[a-z0-9]\.\w*[a-z0-9] 
```

有没有办法把它们结合起来？我知道有，但我似乎做不到。我已经尝试了几个小时了。

他们似乎也返回了空匹配项，这给了我的列表不必要的项目，是否可以返回不为空的匹配项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:15:58.730

这可能对你有用..

```
\bhttp:\/\/(\b\w*[a-z0-9]\.)?\w*[a-z0-9]\.\w*[a-z0-9] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:12:38.217

以下可能会做到这一点：

```
\bhttp:\/\/([\w\d\-\.]+\.)?[\w\d\-\.]+\.[\w\d]+\/? 
```

# r - ggplot 闪避条形图

> ID：12485813
> 
> 赞同：2
> 
> 时间：2012-09-18T22:09:40.060
> 
> 标签：r, ggplot2

我正在拼命寻找这个问题的解决方案：

我想从以下数据框创建一个条形图：

```
means <- c(2.4,3,3,3.16,2.5,2.5,3,4.5)
sds <- c(1.0,1.2,1.0,1.1,2.1,0.7,2.8,0.7)
teams <- c(1,1,1,1,2,2,2,2)
scales <- c(1,2,3,4,1,2,3,4)

datas <- data.frame(teams, scales, means, sds) 
```

之前，它运行良好，我得到了一张蓝色和红色并排的图片，带有标准偏差。

```
graph <- ggplot(data=datas,  aes(scales, y=means))
graph + 
  geom_bar(aes(fill=teams), stat="identity", position="dodge") + 
  no_margins + 
  geom_errorbar(aes(ymin= means - sds, ymax = means + sds, width=0.2), position=position_dodge(width=0.90)) + 
  coord_flip() 
```

安装最新版本的 R (2.15.1) 后，我得到的只是一个文件，其中 4 个条形显示为蓝色且不闪避（彼此并排）

有谁知道变化（颜色，闪避）来自哪里？

我花了几个小时才得到结果，所以非常感谢您的任何建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:25:25.627

我不确定为什么它不能正常工作，但这是一个可以正常工作的版本。

```
graph <- 
    ggplot(data=datas,  aes(scales, y=means, group=teams)) + 
    geom_bar(aes(fill=teams), stat="identity", 
             position="dodge") + 
    geom_errorbar(aes(ymin= means - sds, ymax = means + sds, width=0.2), 
                  position=position_dodge(width=0.90)) +
    coord_flip() 
```

我投入`group=teams`了美学；它不应该是必要的，因为你有一个`fill=teams`in `geom_bar`。

![在此处输入图像描述](../Images/f10ab770459986b70b28c172609f95f5.png)

# kml - 在 Gmap V3 中查看 V2 中使用的 KML 时出现问题

> ID：12485816
> 
> 赞同：1
> 
> 时间：2012-09-18T22:09:41.357
> 
> 标签：kml, sidebar

我在 Gmap V3 中显示我的 KML 时遇到问题；它在我的 V2 代码中运行良好，但无法在 V3 中显示。

我在谷歌地图页面上对其进行了测试，但我看到的只是文件夹名称；文件夹不会打开，网站也不会出现。
我也可以在 GE 中打开 KML，但这些站点没有出现在地图上，只出现在侧边栏中，并且信息窗口中的链接不起作用。

我可以使用我找到的一些[测试代码查看](http://timhaverland.s3.amazonaws.com/work/finss/kmllayersimpletest02.html "test code")[我的 kml](http://landval.gsfc.nasa.gov/doc4T.kml "我的 KML")的较小原型，但我无法 使用相同的测试代码查看我的[完整版 kml 。](http://landval.gsfc.nasa.gov/doc6T.kml "full version KML")并且还不能让任何一个 KML 显示在我自己的任何 v3 代码中。

完整的 KML 包含 4 个文件夹和数百个站点，但即使是包含少于 100 个点的较小原型也不会显示在我自己的 V3 代码中，但如前所述，它在我的 v2 地图中运行良好（这实际上仍然是原型），可[在此处查看](http://landval.gsfc.nasa.gov/Test/GM_sidebar2.html%20here)

（我不想在这个 v2 上走得更远，只需要在几个月内迁移到 v3。）

我想要实现的是类似于[这个例子](http://www.geocodezip.com/geoxml3_test/v3_geoxml3_kmltest_icon_linkto.html?filename=http://www.geocodezip.com/geoxml3_test/visualisationmagazine_com_lacreativemap_kml.xml "这个例子")的东西。

（此示例是否应该能够通过更改 URL 中的文件名来显示任何公开可用的 KML？）

这是迄今为止我所见过的最接近我想要的东西：

我需要一个侧边栏来显示很多点，用户可以打开和关闭这些点。我还需要文件夹。
最后，我想要一个完整的全局视图——因此，不能使用 GE。

请问你能提供任何建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T03:15:25.970

geoxml3 遵循相同的域 xmlhttp 安全策略。它只能使用代理显示来自其他域的 kml 文件。

看起来您正在使用 GeoXml 第三方解析器。在以下位置有一个 v3 版本：

[http://code.google.com/p/geoxml-v3/](http://code.google.com/p/geoxml-v3/)

您的第二个文件在技术上无效：

```
<Placemark>
        <name>Dillon</name>
        <description><![CDATA[Click on the site name to proceed to the ftp 
                    directory for the <a href="ftp://ladsweb.nascom.nasa.gov/subsets/cn_Dillon_18_WSW_MT/">Dillon</a> CRN site.]]></description>
        <styleUrl>#CRN</styleUrl>
        <Point>
            <coordinates>-113.0057,45.158,0</coordinates>
        </Point>                    
            <altitudeMode>relativeToGround</altitudeMode>
</Placemark> 
```

从 4T 文件有`<Point>...</Point>`，这与 6T 文件不同`<point>...</point>`：

```
<Placemark>
  <name>Dillon</name>
  <description><![CDATA[Click on the site name link below to proceed to the subset ftp directory for the <a href="ftp://ladsweb.nascom.nasa.gov/subsets/cn_Dillon_18_WSW_MT">Dillon</a> CRN site.]]>    </description>
  <styleUrl>#CRN</styleUrl>
  <point><coordinates>-113.0057,45.158,0</coordinates></point>
 </Placemark> 
```

# html - 嵌入在 HTML 表格单元格中的 SVG 会溢出该单元格吗？

> ID：12485818
> 
> 赞同：2
> 
> 时间：2012-09-18T22:10:12.040
> 
> 标签：html, svg, html-table, overflow

当我在表格单元格中嵌入 SVG（内联 XML）时，无论我尝试什么，SVG 图像的溢出部分都被隐藏了。我想在多个单元格中使用 SVG 并使用透明背景来实现这样的效果，其中图形跨越多个单元格。

![例子](../Images/58bcf11431fb6c26cd947742d6209a94.png)

表格形式在这里最合适：其他数据（未显示）将在其他列中。

起点jsfiddle：http: [//jsfiddle.net/ApWTS/](http://jsfiddle.net/ApWTS/)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Untitled Page</title>
</head>
<body>
<table>
<tr>
<td style="width:200px;height:100px;background-color: red;">top cell</td>
</tr>
<tr>
<td style="width:200px;height:100px;background-color: yellow;overflow:visible;">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
  <circle cx="100" cy="50" r="80" stroke="black" stroke-width="2" fill="red"/>
</svg>
</td>
</tr>
<tr>
<td style="width:200px;height:100px;background-color: green;">bottom cell</td>
</tr>
</table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T22:38:38.003

尝试给 svgs an`absolute position`和单元格 a`relative position`和`overflow: visible`

# model-view-controller - 更改 content [] 对象属性而不删除或添加

> ID：12485819
> 
> 赞同：2
> 
> 时间：2012-09-18T22:10:18.017
> 
> 标签：model-view-controller, ember.js

我设置了一个对象列表，将它们添加到 content[] 数组列表中。到目前为止一切顺利。App.list 中的 Ember DOM 显示正确的数据。现在，当我开始更改内容属性而不删除/添加/replaceAt() App.list 中的任何对象时，Ember 似乎没有选择它。

查看：{{#App.list.content 中的每个项目}} {{item.title}} {{/each}}

代码：function myApp() { App = Ember.Application.create({});

```
 App.Item = Ember.Object.extend({
    title: null,
    parent: null
  });

  App.MyList = Ember.Object.extend({
    title: null,
    content: [],
    changed: function() {
      console.log('here');
    }.observes('content')
  });

  App.list = App.MyList.create({
    title: "foobar",
    content: [
      App.Item.create({
        title: "item1"
      }),
      App.Item.create({
        title: "item2"
      })
    ]
  });
  console.log(App.list.content);

  // Add 3rd object to list
  App.list.get('content').pushObject(
    App.Item.create({
      title: "item3"
    })
  );
} 
```

..后来在一些随机的 Ember ArrayController 中我这样做： for (var i = 0; i < 2; i++) { App.list.content[i].title = "I CHANGED YOU"; }

查看我的 App.list 内容是正确的，但视图不正确。我错过了什么吗？如果我不得不猜测 ArrayHasChanged() 似乎被操纵以改变数组大小或改变我没有做的对象，我正在更改 content[] 数组的特定对象内的属性数据。有可能还是我必须删除At（）/添加/删除对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:46:20.587

您需要使用 get 和 set 以便观察者/绑定触发您的更改。

```
// Bad
App.list.content[i].title = "blah";

// Good
App.get('list').objectAt(i).set('title', 'blah'); 
```

如果这仍然对您不起作用，则可能缺少其他内容。如果您可以发布一个 jsfiddle，那将有很大帮助！

# cocos2d-iphone - Cocos2d 一次加载多张图片？

> ID：12485823
> 
> 赞同：0
> 
> 时间：2012-09-18T22:10:50.207
> 
> 标签：cocos2d-iphone, kobold2d

我一直在搜索 cocos2d 论坛，但我不明白人们正在使用的一些概念。在我的游戏中，我必须加载超过 100 张图像作为主菜单的动画，但我遇到的问题是这些图像需要大约 3 到 5 秒才能加载，然后我的游戏就会启动。加载图像后动画运行良好，但问题在于加载。我会使用精灵表，但图像太大，所以我必须单独加载它们。那么我应该制作一个加载屏幕来首先加载所有这些图像，如果是这样，最好的方法是如何实现呢？这是我第一次尝试做这样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T01:30:36.903

@Stephen : Two ways to do this. With TexturePacker you can create a .tps file, one for each source image, then under File->Export Image. Set the geometry to 1024x1024 for your images. Specify .pvr format, enable pre-multiplied alpha, and toy with dithering (this may actually benefit some textures, ie improve on .png's). You could also probably benefit from RGBA4444 for menus (gain on memory required, with no significant loss on rendered quality).

You can also use the builtin texturetool as follows:

before you do this, you must convert toto.png to a POT file (1024x1024) in your case, with photoshop for example.

MrEvil:pvrCenter$ /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/texturetool -m -f PVR -e PVRTC toto.png -o toto.pvr

MrEvil:pvrCenter$ gzip toto.pvr

this gives excellent compressions after a gzip (from 691Kb png to 295Kb).

I used texturetool because i can script that in shell, and process a whole lot of images with a single command (play D3 while the box churns out the images :) ).

**EDIT 1** : some info on packing and file sizes.

ok, i started with one of my own 960x640 8 bits PNG, 691 Kb.

load it TexturePacker, set format to RBGA8888, 1024x1024, i get 766 Kb (this gives my my POT file).

export to RGBA8888 as a .pvr.ccz, 996 Kb. export to RGBA8888 as a .pvr.gz, 1.001 Mb export to RGBA4444 as a .pvr.ccz, 193Kb.

if i use texturetool on the 766 Kb file, then gzip the file 305Kb (RGBA8888). I cant really explain the difference between 305Kb and 996 Kb. It could be related to the dithering processing by TexturePacker, not certain.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:39:48.720

是的，一定要使用纹理图集（精灵表不是正确的术语，但含义相同）。一个很好的工具是[TexturePacker](http://www.codeandweb.com/texturepacker)。

纹理图集将在加载时节省时间，并节省内存。您还可以尝试不同的图像颜色深度和压缩选项，以进一步提高内存使用率和加载时间，但许多选项会在不同程度上影响图像质量，具体取决于您的图像。

顺便说一句，这些图像有多大？假设每个都是 512x512，并且您加载其中的 100 个，它们将消耗 100 MB 的内存。我提到这一点是因为这经常被忽视，并且磁盘上的文件大小只是图像作为纹理消耗的一小部分。

# c# - 如果使用 C# 的内容长度 > 7kb，则无法在 WebRequest 上发布

> ID：12485824
> 
> 赞同：6
> 
> 时间：2012-09-18T22:10:57.267
> 
> 标签：c#, json, web-services, httpwebrequest, httpwebresponse

我正在尝试将 Json 发布到我们的网络服务。我的问题是当我的 request.ContentLength 超过 7kb 时。我将在 request.GetResponse() 处获得一个 Web 异常 500。但是如果我的 request.ContentLength 小于 7kb，我的帖子就发送成功了。

错误信息：

```
 The remote server returned an error: (500) Internal Server Error. 
```

源代码：

```
public static string JsonPost(string url, string method, string postData)
{
    Uri address = new Uri(url + method);
    HttpWebRequest request = WebRequest.Create(address) as HttpWebRequest;
    request.Method = "POST";
    request.ContentType = "application/json";
    byte[] byteData = UTF8Encoding.UTF8.GetBytes(postData);
    request.ContentLength = byteData.Length;
    using (Stream postStream = request.GetRequestStream())
    {
        postStream.Write(byteData, 0, byteData.Length);
    }
    try
    {
        using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
        {
            StreamReader reader = new StreamReader(response.GetResponseStream());
            string JsonResponse = reader.ReadToEnd();
            return JsonResponse;
        }
    }
    catch (WebException ex)
    {
        string message = ((System.Net.HttpWebResponse)(ex.Response)).StatusDescription;
        if (message.Contains("busy"))
            return message;
        else
            throw new Exception(message);
    }
} 
```

网络配置：

```
 <?xml version="1.0"?>

<configuration>
  <appSettings>
    <add key="webpages:Version" value="1.0.0.0"/>
    <add key="ClientValidationEnabled" value="true"/>
    <add key="UnobtrusiveJavaScriptEnabled" value="true"/>
  </appSettings>

  <system.web>
    <httpRuntime executionTimeout="180" maxRequestLength="1048576" useFullyQualifiedRedirectUrl="false" minFreeThreads="8"
    minLocalRequestFreeThreads="4" appRequestQueueLimit="100" enableVersionHeader="true" />

    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      </assemblies>
    </compilation>

    <authentication mode="Forms">
      <forms loginUrl="~/Home/" cookieless="AutoDetect" timeout="2880" />
    </authentication>

    <membership>
      <providers>
        <clear/>
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices"
             enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false"
             maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
             applicationName="/" />
      </providers>
    </membership>

    <profile>
      <providers>
        <clear/>
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/" />
      </providers>
    </profile>

    <roleManager enabled="false">
      <providers>
        <clear/>
        <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
      </providers>
    </roleManager>

    <pages>
      <namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages"/>
      </namespaces>
    </pages>
  </system.web>

  <system.webServer>
    <security>
      <requestFiltering>
        <requestLimits maxAllowedContentLength="1073741824" />
      </requestFiltering>
    </security>
    <validation validateIntegratedModeConfiguration="false"/>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="3.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration> 
```

异常日志：

```
 (System.Net.HttpWebResponse)(ex.Response)   {System.Net.HttpWebResponse}    System.Net.HttpWebResponse
    base    {System.Net.HttpWebResponse}    System.Net.WebResponse {System.Net.HttpWebResponse}
        CharacterSet    "ISO-8859-1"    string
        ContentEncoding ""  string
        ContentLength   1047    long
        ContentType "text/html" string
        Cookies {System.Net.CookieCollection}   System.Net.CookieCollection
        Headers {
            Access-Control-Allow-Origin: *
            Content-Length: 1047
            Cache-Control: private
            Content-Type: text/html
            Date: Tue, 18 Sep 2012 22:33:36 GMT
            Set-Cookie: ASP.NET_SessionId=belurseo1i0ureppkspetw1a; path=/; HttpOnly
            Server: Microsoft-IIS/7.0
            X-AspNet-Version: 4.0.30319
            X-Powered-By: ASP.NET
        }   System.Net.WebHeaderCollection
        IsMutuallyAuthenticated false   bool
        LastModified    {9/19/2012 6:34:07 AM}  System.DateTime
        Method  "POST"  string
        ProtocolVersion {1.1}   System.Version
        ResponseUri {http://localhost/service.svc/Update}   System.Uri
        Server  "Microsoft-IIS/7.0" string
        StatusCode  InternalServerError System.Net.HttpStatusCode
        StatusDescription   "The server encountered an error processing the request. Please see the server logs for more details."  string
        SupportsHeaders true    bool 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:55:38.330

您可能必须在 web.config 中启用大文件支持（httpRuntime、maxRequestLength 参数）。
**这是一个示例**

```
<httpRuntime 
 ...
 ...
 maxRequestLength="20485760" 
 ...
 ...
 .../> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:41:50.473

尝试这个：

```
%windir%\system32\inetsrv\appcmd set config -section:requestFiltering -requestLimits.maxAllowedContentLength:1000000 
```

或者如果您只想为您的应用设置它：

```
%windir%\system32\inetsrv\appcmd set config "Default Web Site/<your app>" -section:requestFiltering -requestLimits.maxAllowedContentLength:1000000 
```

[您可以在此处](http://technet.microsoft.com/en-us/library/cc754791%28v=ws.10%29.aspx)找到更多限制选项。

希望这可以帮助

# regex - Perl regexp 如何获取文件名？

> ID：12485828
> 
> 赞同：0
> 
> 时间：2012-09-18T22:11:32.883
> 
> 标签：regex, perl

我有这个目录路径：

```
\main\ABC_PRD\ABC_QEM\1\testQEM.txt\main\ABC_QEM\1 
```

如何`testQEM.txt`从上面的字符串中获取文件名？

我用这个：

```
$file =~ /(.+\\)(.+\..+)(\\.+)/; 
```

但是得到这个结果：

```
file = testQEM.txt\main\ABC_QEM 
```

谢谢，

吉荣

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T23:42:49.407

我不确定我是否理解，因为路径不能在它们中间有一个文件节点！是否以某种方式连接了多个路径？

无论如何，我建议您通过路径寻找第一个验证为真实文件的节点，使用[`-f`](http://perldoc.perl.org/functions/-X.html)

这是一个例子

```
use strict;
use warnings;

my $path = '\main\ABC_PRD\ABC_QEM\1\testQEM.txt\main\ABC_QEM\1';

my @path = split /\\/, $path;
my $file = shift @path;
$file .= '\\'.shift @path until -f $file or @path == 0;

print "$file\n"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T22:31:13.557

这有点困难，因为目录名称可以包含句点。对于 *nix 系统尤其如此，但在 Windows 下也有效。

因此，每个可能的子路径都必须针对文件性进行迭代测试。

我可能会尝试这样的事情：

```
my $file;
my $weirdPath = q(/main/ABC_PRD/ABC_QEM/1/testQEM.txt/main/ABC_QEM/1);
my @parts = split m{/} $weirdPath;

for my $i (0 .. $#parts) {
   my $path = join "/", @parts[0 .. $i];
   if (-f $path) { # optionally "not -d $path"
     $file = $parts[$i];
     last;
   }
}
print "file=$file\n"; # "file=testQEM.txt\n" 
```

我`split`在所有斜杠上都是奇怪的路径（如果互操作性对您来说不是问题，请更改为反斜杠）。然后我将第一个`$i+1`元素连接在一起并测试路径是否为普通文件。如果是这样，我存储路径的最后一部分并退出循环。

如果您可以保证该文件是路径中唯一包含句点的部分，那么最好使用其他解决方案之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T22:19:40.723

```
/[^\\]+\.[^\\]+/ 
```

`.`捕获由两个反斜杠之间的分隔的任何内容。这就是你要找的东西吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T06:32:11.640

我建议你可以理解正则表达式回溯的原理，比如 * 和 + 是如何工作的。您只需对您的正则表达式进行一点更改：

```
/(.+\\)(.+\..+?)(\\.+)/ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-19T03:11:11.360

```
>echo "\main\ABC_PRD\ABC_QEM\1\testQEM.txt\main\ABC_QEM\1"|perl -pi -e "s/.*([\\][a-zA-Z]*\.txt).*/\1/"
\testQEM.txt 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-18T22:20:48.710

```
my $file = '\main\ABC_PRD\ABC_QEM\1\testQEM.txt\main\ABC_QEM\1';
my ($result) = $file =~ /\\([^\\]+\.[^\\]+)\\/; 
```

$result 周围的括号强制右侧表达式上的列表上下文，这反过来又返回括号中的匹配项。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-18T23:34:51.830

使用正则表达式模式`/(?=[^\\]+\.)([^\\]+)/`

```
my $path = '\main\ABC_PRD\ABC_QEM\1\testQEM.txt\main\ABC_QEM\1';
print $1 if $path =~ /(?=[^\\]+\.)([^\\]+)/; 
```

[在此处](http://ideone.com/3xqQj)测试此代码。

# javascript - 没有 html 的基本实时文本输入的

> ID：12485829
> 
> 赞同：-1
> 
> 时间：2012-09-18T22:11:37.700
> 
> 标签：javascript, html, canvas

我正在尝试启动一个项目，该项目要求 javascript 知道输入的每个单词。我会尝试完成的一个例子是你会键入，网页上`4 + 4`的解释器知道你的意思，并自动穿上`= 8`到该行的末尾以显示它是计算出来的，而无需提交任何内容或按下任何按钮。

我已经研究了元素，但我不想重新发明轮子或违背规范所说的。通过将 a`<textarea>`作为输入放在画布上，页面上的 javascript 只能在用户提交文本时知道文本框中的内容。有什么可以帮助解决这个问题的吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:31:12.100

要获取 textarea 的值，您可以通过 DOM 访问它：

```
var textArea = document.getElementById("id-of-textarea"); 
```

到 textarea 你可以附加不同的事件监听器，在你的情况下我会使用`onkeypress`

```
textArea.onkeypress = function () {
   var ta_value = textArea.value;
   alert(ta_value);
} 
```

当然，您必须编写自己的解释器，我不建议`eval`在输入上运行...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:35:26.960

尝试添加一个隐藏的输入元素并在页面加载完成时为其提供焦点，并使用`onkeyup`处理程序做任何你想做的事情。

# google-apps-script - 在 google-apps-script 中按字母递增

> ID：12485832
> 
> 赞同：1
> 
> 时间：2012-09-18T22:11:58.547
> 
> 标签：google-apps-script, google-sheets

我在第 3-15 行的多列中有数据。我想找到该数据集中的所有唯一值并将其输出在一列中。

独特的功能一次只做一列，所以它不适用于我的目的。

我正在编写一个脚本，该脚本将打开一个新工作表并将值复制并粘贴到同一列中（将多列中的数据组合到一个较长的列中）。然后，我将在包含所有数据的单列上运行 unique 函数，以获得原始数据集中所有唯一值的输出 (Items!B3:Z15)

我已经编写了代码，但无法弄清楚如何增加一个字符。如果有更好的方法来实现这一点，我愿意接受建议，但我也很好奇是否可以增加字母。

感谢您的帮助，这是我当前的代码：

```
function uniqueIngredients() {

  var book = SpreadsheetApp.getActiveSpreadsheet();
  var r=1;  // starting with row 1 new sheet
  var d='B';
  for (i=1; i<4; i++){  //testing by running 3 iterations
    var m = 'Ingredients!A'+r;  //Intially return Ingredients!A1 then incremented by 11 ex A12
    var c = 'Items!'+d+'4:'+d+'15';  // Initially return Items!B3:B15 then incremented by letter ex Items!C3:C15
    r = r+12;  // add 12 spaces before next copy (max number of ingredients for each item)
    d++;
    book.getRange(c).copyTo(book.getRange(m), {contentsOnly:true});
  }
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T23:03:29.987

您可以为 getRange() 方法使用[替代参数规范](https://developers.google.com/apps-script/class_sheet#getRange)，该方法使用列号而不是 A1 字符串表示法。这将更容易增加。

话虽如此，由于您仅复制值，因此在块中获取源范围并使用 Javascript 转换为单列数组，然后设置值可能会更好（更有效）：

```
function uniqueIngredients() {
  var ss = SpreadsheetApp.getActive();
  var sourceValues = ss.getSheetByName('Items').getRange('A3:D15').getValues();
  var target = ss.getSheetByName('Ingredients');
  var result = [];
  for (var i = 0; i < sourceValues[0].length; i++) {
    for (var j = 0; j < sourceValues.length; j++) {
      result.push([sourceValues[j][i]]);
    }
  }
  target.getRange(1, 1, result.length, 1).setValues(result); 
} 
```

*话*虽如此，您可以使用一些解决方法来仅使用电子表格函数提供最终结果：

```
=ArrayFormula(UNIQUE(TRANSPOSE(SPLIT(CONCATENATE('Items'!A3:D15&CHAR(9));CHAR(9))))) 
```

# ruby - 如何使用 watir webdriver 检索元素属性列表

> ID：12485833
> 
> 赞同：4
> 
> 时间：2012-09-18T22:12:00.447
> 
> 标签：ruby, watir-webdriver

我正在尝试编写一个 watir webdriver 脚本来检索元素的属性，然后获取它们的值。给定元素

```
 <input id="foobar" width="200" height="100" value="zoo" type="text"/> 
```

希望我可以做以下事情：

```
 testElement = $b.element(:id, "foobar")
  testElement.attributes.each do |attribute|
    puts("#{attribute}: #{testElement.attribute_value(attribute)}")
  end 
```

我希望得到

```
 id: foobar
  width: 200
  height: 100
  value: zoo
  type: text 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-19T14:19:10.040

我见过人们使用 javascript 来获取属性列表。下面展示了如何向 Watir::Element 添加方法以获取属性列表（尽管扩展 Watir 是可选的）。

```
#Add the method to list attributes to all elements
require 'watir-webdriver'
module Watir
    class Element
        def list_attributes
            attributes = browser.execute_script(%Q[
                var s = [];
                var attrs = arguments[0].attributes;
                for (var l = 0; l < attrs.length; ++l) {
                    var a = attrs[l]; s.push(a.name + ': ' + a.value); 
                } ;
                return s;], 
                self )      
        end
    end
end

#Example usage
browser = Watir::Browser.new
browser.goto('your.page.com')
el = browser.text_field(:id, 'foobar')
puts el.list_attributes
#=> ["width: 200", "type: text", "height: 100", "value: zoo", "id: foobar"] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-23T22:19:05.283

@Željko-Filipin 的答案可能已经过时了......他链接到的文档，截至 15 年 8 月，[列出`attribute_value`](http://watir.github.io/watir-webdriver/doc/Watir/Element.html#attribute_value-instance_method)了一种提取 DOM 元素属性值的方法。

我有`commonwatir-4.0.0`、`watir-webdriver-0.6.11`和 Ruby 2.2.2 - 例如，上述方法提取标签`href`的`a`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T12:12:36.747

你想做什么？

据我所见，`Element`类没有`#attributes`方法：[http ://watir.github.com/watir-webdriver/doc/Watir/Element.html](http://watir.github.com/watir-webdriver/doc/Watir/Element.html)

您可以获取元素的 HTML 并对其进行解析：

```
browser.element.html 
```

# python - 获取要在 with 语句中执行的命令块

> ID：12485837
> 
> 赞同：5
> 
> 时间：2012-09-18T22:12:32.570
> 
> 标签：python, scope, with-statement

`with`在阅读声明（[链接](http://www.python.org/dev/peps/pep-0343/)）的规范时，我有一些我想玩的东西。这不适用于任何生产代码或任何东西，我只是在探索，所以如果这是一个坏主意，请不要太苛刻。

我想做的是在上面的链接文档中获取名为“BLOCK”的部分，并在对`__enter__`. （请参阅链接的文档，就在动机和摘要部分的开始之后。）

这个想法是创建我自己的动态本地命名空间。像这样的东西：

```
with MyNameSpace(some_object):
    print a #Should print some_object.a
    x = 4 #Should set some_object.x=4 
```

基本上，我希望`with`块内的语句从属于`some_object`.

在我的具体情况下，`some_object`可能是一个特殊的数据数组，它有我自己的按列操作或其他东西。在这种情况下，类似的说法`x = y + 5 if y > 4 else y - 2`可能是一些花哨的 NumPy 矢量化操作，但我不需要显式调用`some_object`这些方法的接口。在命名空间中，表达式应该“正常工作”（但是我将它们定义为在类中推断`MyNameSpace`。

我的第一个想法是以某种方式中断该`with`过程并获取`try`块中的代码。然后在被调用时解释该代码，并用其他东西`__enter__`替换块中的代码（也许如果这样可行，但可能会恢复到原始变量范围并保留其新更改的变量）。`try``pass``some_object`

一个简单的测试用例是这样的：

```
my_dict = {'a':3, 'b':2}
with MyNameSpace(my_dict):
    print a # Should print 3
    x = 5 # When the block finishes, my_dict['x'] should now be 5 
```

如果这个想法已经存在于某个地方，我很感兴趣。

我知道分配变量的最佳实践。这是一个宠物项目，所以请假设，为了这个想法，我们可以忽略最佳实践。即使您不喜欢以这种方式分配变量，它在我当前的项目中也可能很有用。

**编辑**

为了澄清我可能想做的棘手的事情，并解决下面声称无法完成的答案，请考虑`testLocals.py`下面的示例文件：

```
my_dict = {'a':1, 'b':2}
m = locals()
print m["my_dict"]['a']
m["my_dict"]['c'] = 3
print my_dict

class some_other_scope(object):
    def __init__(self, some_scope):
        x = 5
        g = locals()
        some_scope.update(g)
        some_scope["my_dict"]["d"] = 4

sos = some_other_scope(m)
print my_dict
print x 
```

当我以非交互方式运行它时，它会给出以下内容：

```
ely@AMDESK:~/Desktop/Programming/Python$ python testLocals.py
1
{'a': 1, 'c': 3, 'b': 2}
{'a': 1, 'c': 3, 'b': 2, 'd': 4}
5 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T22:36:47.847

尝试这个。

```
import sys 
class MyNameSpace(object):
    def __init__(self,ns):
        self.ns = ns
    def __enter__(self):
        globals().update(self.ns)
    def __exit__(self, exc_type,exc_value,traceback):
        self.ns.update(sys._getframe(1).f_locals)

my_dict = {'a':3, 'b':2} 
with MyNameSpace(my_dict) as ns:
    print(a) # Should print 3
    x = 5 # When the block finishes, my_dict['x'] should now be 5 

print(my_dict['x']) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T22:27:50.690

这是我几个月前尝试过的类似方法：

```
import sys
import inspect
import collections

iscallable = lambda x: isinstance(x, collections.Callable)

class Namespace(object):
    def __enter__(self):
        """store the pre-contextmanager scope"""
        f = inspect.currentframe(1)
        self.scope_before = dict(f.f_locals)
        return self

    def __exit__(self, exc_type, exc_value, traceback):
        """determine the locally declared objects"""
        f = inspect.currentframe(1)
        scope_after = dict(f.f_locals)
        scope_context = set(scope_after) - set(self.scope_before)

        # capture the local scope, ignoring the context manager itself
        self.locals = dict(
            (k, scope_after[k]) for k in scope_context if not isinstance(scope_after[k], self.__class__)
        )

        for name in self.locals:
            obj = scope_after[name]
            if iscallable(obj):
                # closure around the func_code with the appropriate locals
                _wrapper = type(lambda: 0)(obj.func_code, self.locals)
                self.__dict__[name] = _wrapper
                # update locals so the calling functions refer to the wrappers too
                self.locals[name] = _wrapper
            else:
                self.__dict__[name] = obj

            # remove from module scope
            del sys.modules[__name__].__dict__[name]

        return self

with Namespace() as Spam:
    x = 1
    def ham(a):
        return x + a      
    def cheese(a):
        return ham(a) * 10 
```

它在上下文管理器中使用检查来修改局部变量，然后在完成后重新分配回原始值。

它并不完美——我不记得它在哪里遇到了问题，但我确信它确实如此——但它可能会帮助你入门。

# bash - 如何使 linux 脚本超时

> ID：12485839
> 
> 赞同：1
> 
> 时间：2012-09-18T22:12:41.603
> 
> 标签：bash

我搜索了 coreutils 超时和其他超时脚本，他们申请了 CDM
，但我想为 linux 脚本申请超时，如果一段时间没有完成的话。喜欢：

```
cd XXX && CMD && sleep 3 && kill -0 XX 
```

怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:31:12.670

您可以将子shell 的生成传递给超时，并让子shell 运行需要超时的代码：

```
#!/bin/bash
timeout 5 bash -c "ping google.com -c 2; ping yahoo.com -c 10" 
```

如果你明确你需要什么，可能会有更清洁的方法来实现这一点。

# c# - 如果已选择，则禁用下拉选项

> ID：12485841
> 
> 赞同：0
> 
> 时间：2012-09-18T22:12:54.833
> 
> 标签：c#, .net, drop-down-menu

我有一个网站，人们可以将图像上传到某种“图像拼接”中。他们可以从 36 个不同位置的下拉列表中进行选择。如果已经选择了下拉菜单，有没有办法从下拉列表中禁用某些选择。我不在乎它是否变灰、删除、禁用，或者只是在错误标签中显示错误消息（已经存在并且正在运行）说“请选择不同的位置”（或我稍后决定的任何内容）。

我只是不希望人们选择重复的位置并让应用程序提交视频。我可以在里面做什么样的检查？

```
protected void PopulateImagePosition()
{
    String[] imagePositions = video.ListImagePositions();

    image_position.Items.Add(new ListItem("----- Please Select -----", ""));
    foreach (String tmpPosition in imagePositions)
    {
        String[] parts = tmpPosition.Split(new char[] { '|' });

        image_position.Items.Add(new ListItem(parts[1], parts[0]));
    }
} 
```

这是 C# .NET。如果我需要额外的；代码请告诉我，任何帮助将不胜感激。预先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:48:38.400

必须尝试说明显而易见的

```
foreach (String tmpPosition in imagePositions)
{
    // add logic here to skip if imagePosition has already been selected 
    // or just don't include it in imagePositions if it has already been selected
    String[] parts = tmpPosition.Split(new char[] { '|' });
    image_position.Items.Add(new ListItem(parts[1], parts[0]));
} 
```

# java - 在 Eclipse 中使用 ControlP5 进行处理会导致按键时出现 IllegalArgumentException

> ID：12485842
> 
> 赞同：0
> 
> 时间：2012-09-18T22:13:07.607
> 
> 标签：java, eclipse, applet, processing

我有一个处理项目，它使用在 eclipse 中运行的 ControlP5 库，在该库中，在键盘上的任何键按下时，都会因 IllegalArgumentException 而崩溃：

```
 Exception in thread "Animation Thread" java.lang.IllegalArgumentException: argument type mismatch
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at processing.core.PApplet$RegisteredMethods.handle(PApplet.java:1076)
    at processing.core.PApplet.handleKeyEvent(PApplet.java:2848)
    at processing.core.PApplet.dequeueKeyEvents(PApplet.java:2793)
    at processing.core.PApplet.handleDraw(PApplet.java:2132)
    at processing.core.PGraphicsJava2D.requestDraw(PGraphicsJava2D.java:197)
    at processing.core.PApplet.run(PApplet.java:1998)
    at java.lang.Thread.run(Unknown Source) 
```

该程序（在小程序中运行）可以通过鼠标拖动、滑块等完美运行，直到按下一个键。似乎有某种未知的 keylistener 等待输入并错误地使用它？很难说，因为异常是指与我编写的处理代码无关的 java 代码。

即使我有一个只定义 ControlP5 对象的程序，该程序也会遇到相同的错误：

```
import processing.core.*;
import controlP5.*;

public class Lensing extends PApplet {
    ControlP5 controlP5;

    public Lensing() {

    }

    public void setup() {
        controlP5 = new ControlP5(this);
    }

    public void draw() {

    }

    public static void main(String args[]) {
        PApplet.main(new String[] { "--present", "edu.umd.astro.Lensing" });
    }
} 
```

注释掉单个controlP5的定义，不会出现异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T23:33:27.383

[原来这是与使用 2.0b1 核心 jar 文件相关的问题，可以通过从http://processing.org/download/](http://processing.org/download/)更新到 2.0b3 来解决

信用在这里回复[https://forum.processing.org/topic/using-controlp5-with-processing-in-eclipse-results-in-illegalargumentexception-on-keypress](https://forum.processing.org/topic/using-controlp5-with-processing-in-eclipse-results-in-illegalargumentexception-on-keypress)

# r - R中非数值数据的条形图

> ID：12485844
> 
> 赞同：4
> 
> 时间：2012-09-18T22:13:41.523
> 
> 标签：r, plot

我将如何使用 R 绘制非数值数据频率的条形图？

例如，如果给定`v = c("B","A","B","A","B","D","C","D","D","D","C")`

我想得到一个条形图，其中每个条形代表向量中的一个唯一值，每个条形的高度与该值的频率相对应：

![在此处输入图像描述](../Images/0508a3a533b962b6e4031c046d55cea3.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-18T22:18:00.897

Calculate the table of values for the barplot using the `table()` function, e.g.:

```
v <- c("B","A","B","A","B","D","C","D","D","D","C")
barplot(table(v)) 
```

This produces

![barplot example figure](../Images/0cb98baf6a82072b063e523aced75949.png)

# c# - 暂存更新以在 SQL Server 2008 的时间点发生

> ID：12485845
> 
> 赞同：0
> 
> 时间：2012-09-18T22:13:42.083
> 
> 标签：c#, sql-server-2008

我正在开发一个系统管理员可以安排中断的管理应用程序。为了使中断发生，我需要在单个表上运行一个简单的更新语句。问题是我希望他们能够在下午 12 点登录并在晚上 9 点安排中断，这样我们就不必让员工在线执行此操作。

SQL Server 中是否有某种内置方式来安排这样的更新 stmt？

理想情况下，我的管理 web 应用程序能够在 SQL Server 上调用某些东西，并说在晚上 9 点而不是之前运行它，否则我知道我可以创建一个线程和计时器来在我的 web 应用程序中运行更新，但这个想法让我畏缩.. .

提前致谢。克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:24:22.880

正如 Crispalot 爵士所解释的，SQL Server 代理是一种方式。但是，如果您想要即使在 SQL Azure 或 SQL Server Express（不支持 SQL Server 代理）上也能正常工作的低租金，SQL Server 代理被禁用，或者您无权创建作业，T-SQL 也可以这样做：

```
WAITFOR TIME '21:00:00';
---- do your thing here; 
```

然后当然还有其他外部选项——Azure 中的工作角色、Windows 中的任务调度程序、PowerShell 中的作业机制……所有这些都可以直接或间接调用某些 SQL 或调用存储过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:17:47.527

I think you might be looking for the SQL Server Agent.

You can use it to do pretty much anything you like - run a backup plan, call a stored procedure, etc.

[This documentation](http://msdn.microsoft.com/en-us/library/ms187061%28v=sql.100%29.aspx) should give you the pointers you need to get started, and specifically [this explains how to create a job](http://msdn.microsoft.com/en-us/library/ms186273%28v=sql.100%29.aspx).

# perl - 传输 perl 模块 (RHEL)

> ID：12485847
> 
> 赞同：0
> 
> 时间：2012-09-18T22:13:59.867
> 
> 标签：perl, module, cpan, data-transfer

我需要在我的测试环境中安装几个 perl 模块（JSON 和 JSON::XS）。但是，镜像生产的测试环境不能安装 gcc。我确实有一个安装了 gcc 的开发环境。我使用 CPAN 来下载和编译这些模块。

问题是，我现在如何将它们从我的开发环境迁移到我的 UAT（最终是生产）环境？所有环境都是相同的架构，等等。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T09:33:57.693

这两个模块都可用于 RHEL 的预打包。它们位于[EPEL](http://fedoraproject.org/wiki/EPEL)存储库中。将系统配置为使用此存储库后，安装模块就像`sudo yum install perl-JSON perl-JSON-XS`.

如果您或您的管理层对使用第三方存储库感到不舒服，那么另一种选择是从 CPAN 下载 tarball 并使用[cpanspec](http://fedoraproject.org/wiki/Perl/cpanspec)和 rpmbuild 之类的工具构建您自己的 RPM。

如果您正在使用 Red Hat 系统，那么使用本机打包系统几乎可以肯定是让软件进入不同环境的最简单方法。

# php - 使用 jQuery，我可以做到这一点，除非填写了必填字段，否则提交按钮将无法“工作”

> ID：12485849
> 
> 赞同：-3
> 
> 时间：2012-09-18T22:14:37.573
> 
> 标签：php, jquery

我希望用户能够点击提交，但是如果没有填写正确的字段，它将不会通过并且会出现错误。这可能吗？我知道如何处理错误部分，但阻止提交部分很烦人。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T22:22:39.693

处理表单上的提交事件：

```
$(document).ready(function() {
     $("#yourFormIdHere").submit(function(e) {
         // process fields
         if (thereWereErrors) {
             e.preventDefault();
         }
     });
}); 
```

如果您在事件处理程序中调用该[`event.preventDefault()`方法](http://api.jquery.com/event.preventDefault/)，它会阻止该事件的默认操作发生，在提交事件的情况下，默认当然是提交表单...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T22:17:14.440

This is what you want: (I reckon) **working demo** [http://jsfiddle.net/8YsAx/](http://jsfiddle.net/8YsAx/)

Good link: [http://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

API: `validate` [http://docs.jquery.com/Plugins/Validation/validate#options](http://docs.jquery.com/Plugins/Validation/validate#options)

Hope it fits the cause `:)`

**script**

```
 <script type='text/javascript' src="http://ajax.microsoft.com/ajax/jquery.validate/1.7/jquery.validate.min.js"></script> 
```

**code**

```
$(document).ready(function(){
    $("#registerForm").validate();
  });​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T22:19:24.003

```
<form method="post/get" action"url" onsubmit="return Validation();"> 
```

The onsubmit is called when the submit is clicked. The Validation function should return true for continue and false if you want to prevent the form from being submitted.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T22:25:52.200

您需要在表单中添加一个提交事件监听器：

```
$('#myForm').submit(function() {
    // return true (proceed submit) | false (stop submit)     
    // In case the form is not valid you can render your errorMessages first    
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T22:21:27.460

如果你问怎么做（而不是你实际问的是“这可能”），那么你可以在你的 jquery 代码中做这样的事情。如果您要提交多个表单，这是一种方法。

```
if($(your_field_here).html() === '') {
  error = 1;
  error_field .= "<br />your_field_here is not filled out!";
}
if($(your_second_field_here).html() === '') {
  error = 1;
  error_field .= "<br />your_field_here is not filled out!";
}

if(error === 1){
  $(your_error_field).html(error_field);
} else {
  // do your ajax / w.e call here
} 
```

编辑：这是我个人一直在做的事情。如果有更简单的方法，请通过评论告诉我。

# c++ - QT-Dbus 信号/插槽？

> ID：12485853
> 
> 赞同：1
> 
> 时间：2012-09-18T22:15:00.103
> 
> 标签：c++, qt, dbus, qdbus

如何连接我的 QT 插槽以响应某些 3rd 方服务生成的 D-BUS 信号？

以下是对的吗？

```
QDBusConnection bus = QDBusConnection::systemBus();
bus.connect("com.me.foo", "/", "com.me.foo.bar", "foo",
                this, SLOT(fooSignal())); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-07-27T16:16:35.020

首先，您必须找出该服务在哪条总线上注册（系统或会话）。对于会话总线，您必须将 QDBusConnection::systemBus() 更改为 QDBusConnection::sessionBus()

要为 connect() 获取正确的参数值，您必须获取服务名称、对象路径、接口和信号名称。

完成这两项任务的最简单方法是使用 qdbusviewer 应用程序，它是 Qt 开发工具（Ubuntu 中的 qt4-dev-tools 或 qttools5-dev-tools）的一部分。它允许查看两条总线上的服务、遍历对象树和列出方法。D-Bus 接口的属性和信号，由每个注册对象实现。

# objective-c - 重启后应用崩溃

> ID：12485858
> 
> 赞同：0
> 
> 时间：2012-09-18T22:15:33.303
> 
> 标签：objective-c, ios

我是 iphone 开发的新手，为了感受一下，我创建了一个新视图，在每次加载时都会弹出一个警报。

这工作正常，但是当我关闭应用程序，然后重新打开它时，整个应用程序崩溃。我唯一要做的就是显示警报。

这是我的警报代码：

```
 UIAlertView *alert = [[UIAlertView alloc]
                      initWithTitle: @"Announcement"
                      message: @"This is really annoying just to make"
                      delegate: nil
                      cancelButtonTitle:@"OK"
                      otherButtonTitles:nil];
[alert show]; 
```

我想我应该放`[alert release];`，但 Xcode 一直说不`release`可用。

`[alert release]`我的应用程序在退出/重启时不断崩溃的原因是什么？

谢谢！

编辑：继承我调用 UIAlertView 的周围代码

```
- (void)viewDidLoad
{
    [super viewDidLoad];
// Do any additional setup after loading the view.

//just testing alerts..this shows up after the first load only
UIAlertView *alert = [[UIAlertView alloc]
                      initWithTitle: @"Announcement"
                      message: @"This is really annoying just to make"
                      delegate: nil
                      cancelButtonTitle:@"OK"
                      otherButtonTitles:nil];
[alert show];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:42:53.550

`release`如果您使用 ARC 将不可用

此外，正如@rdelmar 在评论中所说，一个简单的警报导致崩溃是非常不寻常的，你真的需要提供更多关于你的问题的信息......你可以尝试的一件事是显示你的`UIAlertView`内部`viewDidAppear`而不是`viewDidLoad`方法。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-09-18T22:40:48.760

是的，你应该把[警报发布]。为了分析应用程序崩溃，您应该提供一些信息。

# c++ - 我应该将所有 .o 文件放入库中吗？

> ID：12485862
> 
> 赞同：0
> 
> 时间：2012-09-18T22:15:46.050
> 
> 标签：c++, g++, static-libraries

我想创建一个库，让我的程序使用一个类，我们称之为 A，它有一些简洁的方法等等......不过，这个类依赖于其他一些（B 和 C），它包括他们的`.hpp`文件在其`.cpp`文件中。

构建过程如下：

```
g++ -c B.cpp
g++ -c C.cpp
g++ -c A.cpp

ar rvs A.a *.o 
```

通过这样做，我的其他项目现在只需要包含我的 A 类的文件`A.hpp`和`A.a`. 我是否正确制作了静态库？我是否应该只将 Ao 放入存档（库）中（这样做会产生错误）？

仅供参考，这是使用 A 类的程序的编译方式：

```
g++ test1.cpp A.a -o test1 
```

**编辑：**有没有办法隐式告诉链接器将我的程序与 Aa 链接？就像我不需要手动将它与 iostream 链接一样......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:21:33.640

这很好，你现在怎么做。将所有目标文件放入静态库中。

# mysql - 如何在 MySQL 中的 SELECT 查询后更新所有结果

> ID：12485866
> 
> 赞同：0
> 
> 时间：2012-09-18T22:16:03.367
> 
> 标签：mysql

在我执行了一个 SELECT 查询后，我用它来显示页面上的所有结果，我希望用 +1 更新所有的 shot.views int 列，这意味着每次它显示这些结果时，它也会更新它的 shot.views。

你们认为我应该如何以最好的方式和一个小例子来做到这一点？当然我想限制查询的数量。我现在有点不知所措。提前致谢！

```
$query = mysql_query("
SELECT 
shots.id,
shots.large, 
shots.title,
shots.datetime 

FROM notifications

INNER JOIN shots

ON notifications.target = shots.id

WHERE notifications.uid = (SELECT id FROM users WHERE username ='$username') AND (notifications.type = 'picture' OR notifications.type = 'video' OR notifications.type = 'reshot')

ORDER BY datetime DESC

") or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:18:46.173

由于`UPDATE`并没有真正返回任何东西，我认为你坚持使用两个查询。不过，这是一个崇高的目标！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:21:08.977

```
SELECT value FROM counters WHERE id = 1 FOR UPDATE;
UPDATE counters SET value = value + 1 WHERE id = 1; 
```

这就是你要找的:)

# php - PHP imap_append - 设置 SEEN 选项

> ID：12485868
> 
> 赞同：4
> 
> 时间：2012-09-18T22:16:20.833
> 
> 标签：php, imap

我想将消息附加到 imap 发送箱 - 下面的代码只是将消息视为新消息。

据我了解，添加 SEEN 选项应该将其标记为已读，但是我已经尝试了该选项的所有可能位置，但仍然将消息标记为新消息。

看过 imap_setflag_full 后，这需要一个邮件号码来设置标志，并且鉴于电子邮件刚刚添加，我看不出有办法抓住号码来设置标志（？）。

有什么建议么？

```
 imap_append($inbox, "{mail.domain.com:143/imap/notls}INBOX.Sent"
                       , "From: $fromaddress\r\n"
                       . "To: $toaddress\r\n"
                       . "Subject: [Email Processed] $subject\r\n"
                       . "Date: $date_return  \r\n"
                       . "X-Mailer: Cmail_v2.0 \r\n"
                       . "X-Originating-IP: {$_SERVER['REMOTE_ADDR']}\r\n"
                       . "MIME-Version: 1 \r\n"
                       . "Content-Type: text/html;\r\n\tcharset=\"ISO-8859-1\"\r\n"
                       . "Content-Transfer-Encoding: 8bit \r\n"
                       . "\r\n\r\n"
                       . "$message_return \r\n"
                       ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T23:09:26.623

通过`$options`参数传递你的标志。

[http://php.net/manual/en/function.imap-append.php#74907](http://php.net/manual/en/function.imap-append.php#74907)

> 最后一个参数 $options 是与 imap_setflag_full 一起使用的标志。

**编辑：** 再次阅读您的帖子后，我意识到您可能已经通过 $options 参数传递了标志。这很好，但如果你通过“SEEN”，那就是你的问题。IMAP4 RFC：第[2.3.2 节。标志消息属性](http://www.faqs.org/rfcs/rfc2060.html)将其定义为带有反斜杠和大写 S 的“\Seen”。该标志字符串是否解决了您的问题？

# iphone - 只有一个导航控制器（和子视图控制器）处于横向

> ID：12485871
> 
> 赞同：0
> 
> 时间：2012-09-18T22:16:38.837
> 
> 标签：iphone, ios, ios5, uistoryboard

我有一个几乎总是纵向的故事板应用程序。我确实有一个需要处于横向模式的导航控制器（带有 2 个视图控制器）。它连接回应用程序的主选项卡控制器，应用程序中的所有其他视图控制器和导航控制器都需要保持纵向模式。我尝试将方向设置为横向并允许左右方向，但这会解锁所有视图控制器以切换到横向模式。有没有办法只允许这两个？

谢谢你的帮助！本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T00:52:45.237

首先，不要继承 UINavigationController ！

只有 LandScape Orientation 在需要位于 Landscape 的 ViewController 类中使用它：

```
 - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return ((interfaceOrientation == UIInterfaceOrientationLandscapeLeft) || (interfaceOrientation == UIInterfaceOrientationLandscapeRight));
} 
```

这将使您的视图仅处于横向模式。不要创建 UINavigationController 的子类来将上面的代码段放入其中！这将导致您的所有视图保持锁定在横向！

希望对您有所帮助:)！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T22:26:55.023

您必须`-(BOOL) shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation`在应用程序的每个视图控制器中进行子类化，并且只允许 2 个视图控制器使用它。但是对于您的标签栏，您还需要在呈现这些视图控制器时将其设置为 YES（您可能需要将标签栏子类化才能做到这一点），否则为 NO

# javascript - Javascript: Modal Dialog Window - Inactive Tab Page

> ID：12485876
> 
> 赞同：4
> 
> 时间：2012-09-18T22:17:00.493
> 
> 标签：javascript, tabs, dialog, window, modal-dialog

I have a modal dialog popup being called from a parent window after 30 seconds of launch.

The modal window then closes automatically after 10 seconds of its launch.

The problem is when the parent window tab is inactive the modal window launches but does not seem to register due to which the timer on the modal is not triggered and it never closes.

Once I click on the flashing inactive tab the timer kicks off and the modal window then times out after 10 seconds.

I must user modal window as one of my requirement is to notify the user about idle time when the browser session is idle.

Can someone help?

# math - x4网格中的行数公式

> ID：12485877
> 
> 赞同：0
> 
> 时间：2012-09-18T22:17:07.407
> 
> 标签：math, formula

好的，所以我目前正在设置一个网格，每行将有 4 个对象。行数必须根据这个约束来计算。

所以如果我有 15 个对象，我需要 4 行。如果我有 12 个对象，我需要 3 行。

不知何故，我需要某种数学公式来执行并返回这个数字。因此，当我对函数说我有 x 个对象时，它将返回行数。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:25:19.643

```
ceil(x / 4.0) 
```

您需要上限，而不是结果值的下限。否则，您将无法将 15 列放入 4 行中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-18T22:20:39.027

警告：可读性沼泽

> 地板((obj - 1) / 4) + 1

其中 obj 是您问题中的对象数。

甚至更简洁：

> 地板((obj + 3) / 4)

一个班轮！

Floor 通常带有语言的整数除法运算符（例如，Java、C++），因此实现起来可能更短。

# c++ - 将文件从 Boost filtering_streambuf 解压到 std::vector ?

> ID：12485881
> 
> 赞同：1
> 
> 时间：2012-09-18T22:17:43.843
> 
> 标签：c++, boost, vector, deflate

我正在尝试解压缩使用 DEFLATE 算法压缩的文件并将其填充到`vector<unsigned char>`. 从我到目前为止所做的研究来看，似乎我可以使用 a`boost::iostreams::filtering_streambuf`然后使用`boost::iostreams::copy()`将其放入 a 中`boost::interprocess::basic_vectorstream<std::vector<unsigned char>>`，然后将底层向量从向量流中拉出。但是，我得到了大量的编译器错误，从这个开始：

```
/usr/include/boost/iostreams/copy.hpp: In function ‘std::streamsize boost::iostreams::detail::copy_impl(Source, Sink, std::streamsize) [with Source = boost::reference_wrapper<boost::iostreams::filtering_streambuf<boost::iostreams::input> >, Sink = boost::reference_wrapper<boost::interprocess::basic_vectorstream<std::vector<unsigned char> > >, std::streamsize = long int]’:
/usr/include/boost/iostreams/copy.hpp:245:79:   instantiated from ‘std::streamsize boost::iostreams::copy(Source&, Sink&, std::streamsize, typename boost::enable_if<boost::iostreams::is_std_io<Source> >::type*, typename boost::enable_if<boost::iostreams::is_std_io<Sink> >::type*) [with Source = boost::iostreams::filtering_streambuf<boost::iostreams::input>, Sink = boost::interprocess::basic_vectorstream<std::vector<unsigned char> >, std::streamsize = long int, typename boost::enable_if<boost::iostreams::is_std_io<Source> >::type = void, typename boost::enable_if<boost::iostreams::is_std_io<Sink> >::type = void]’
ValueFileReader.cpp:92:41:   instantiated from here
/usr/include/boost/iostreams/copy.hpp:178:5: error: static assertion failed: "(is_same<src_char, snk_char>::value)" 
```

我正在使用的代码如下（为了简洁起见，缩短并执行“使用命名空间”）：

```
using namespace boost::iostreams;
using namespace boost::interprocess;

filtering_streambuf<input> in;
std::ifstream file(filename, std::ifstream::in);
in.push(zlib_decompressor());
in.push(file);

basic_vectorstream<std::vector<unsigned char>> vectorStream;
copy(in, vectorStream);
std::vector<unsigned char> chars(vectorStream.vector()); 
```

我看过[这个线程](https://stackoverflow.com/questions/9557555/how-can-i-decompress-a-vector-of-deflated-data-with-boost)，但我不确定是否将所有内容复制到向量中，然后从向量中解压缩将是最有效的方法。

有没有更好的方法可以解决这个问题，还是我有正确的想法但代码中有一些错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T22:51:14.500

问题是你的`ifstream`和`filtering_streambuf`使用`char`作为它们的底层字符类型，而你的`basic_vectorstream`使用`unsigned char`作为它的值类型。Boost 代码有一个静态断言，要求这些类型相同，以便在使用两种不可转换的不同类型时不会出现编译器错误。

幸运的是，这里的修复很简单——改变：

```
basic_vectorstream<std::vector<unsigned char>> vectorStream;
copy(in, vectorStream);
std::vector<unsigned char> chars(vectorStream.vector()); 
```

到：

```
basic_vectorstream<std::vector<char>> vectorStream;
copy(in, vectorStream);
std::vector<unsigned char> chars(
    vectorStream.vector().begin(),
    vectorStream.vector().end()
); 
```

这是安全的，因为C++ 标准保证`char`并`unsigned char`保证具有相同的对象表示（第 3.9.1/1 节）。

* * *

与您的直接问题无关，但您还需要传递`std::ios::binary`给`file`' 的构造函数，否则由于行尾转换，您将获得损坏的数据。

# c# - What is the standard way to name a file based on CultureInfo?

> ID：12485886
> 
> 赞同：0
> 
> 时间：2012-09-18T22:18:00.803
> 
> 标签：c#, .net, naming-conventions, cultureinfo, culture

Looking a recommendation for my criteria.

I need to create a file for different countries and looking at the best naming strategy for this.

I am working with .net 4.5\. So example I need to create a file with Russian data, should it be named

```
rus_myfile.txt [ThreeLetterISOLanguageName]

ru_myfile.txt [TwoLetterISOLanguageName] 
```

or another?

Is there any standard for naming conventions based on the .Net [CultureInfo](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx) object? Any gotchas in this area?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:33:22.057

您可以遵循资源文件 (.resx) 的命名约定：

```
<file basename>.<culture>.txt 
```

您的示例如下所示：

```
myfile.ru-RU.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T15:45:52.357

对于“.resx”文件的官方命名约定规则（这确实是标准），请参阅[http://msdn.microsoft.com/en-us/library/w24xty37(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/w24xty37(v=vs.100).aspx). 如果您只想要“中性”文化，请参阅“CultureInfo.Parent”。您可能还想看看“CultureInfo.IsNeutralCulture”（您可能需要它）。如果需要，您甚至可以编写“CultureInfo”扩展方法（检索中性文化），但如果在不变文化的实例上调用它时要小心（在这种情况下可能返回 null 或空字符串）。此外，对于中文，请注意“zh-CHS”与“zh-Hans”（均为“简体”）和“zh-CHT”与“zh-Hant”（均为“繁体”）。在每种情况下，后一个名称都是较新的版本，MSFT 从旧版本更改为支持称为 IETF 标准的东西（不要问）。然而，旧的和新的仍然受支持（MSFT 官方表示如果可以的话，使用新名称），所以当你调用“CultureInfo.DislayName”时，有时你可能会看到附加的“Legacy”一词（取决于版本.NET 你正在使用）。还要注意您通常使用的 .NET 版本。有时会添加新的文化，与早期版本相比，V4.0 中的内容要多得多，尽管不是真正的主流文化。IOW，如果您尝试通过将区域性名称传递给其构造函数来实例化“CultureInfo”，它可能适用于 .NET 的一个版本，但会在另一个版本上引发“ArgumentException”。这可能会或可能不会影响您的特定应用程序，但需要注意（例如，它会影响我的应用程序）。因此，您有时可能会在调用“CultureInfo.DislayName”时看到附加的“Legacy”一词（取决于您使用的 .NET 版本）。还要注意您通常使用的 .NET 版本。有时会添加新的文化，与早期版本相比，V4.0 中的内容要多得多，尽管不是真正的主流文化。IOW，如果您尝试通过将区域性名称传递给其构造函数来实例化“CultureInfo”，它可能适用于 .NET 的一个版本，但会在另一个版本上引发“ArgumentException”。这可能会或可能不会影响您的特定应用程序，但需要注意（例如，它会影响我的应用程序）。因此，您有时可能会在调用“CultureInfo.DislayName”时看到附加的“Legacy”一词（取决于您使用的 .NET 版本）。还要注意您通常使用的 .NET 版本。有时会添加新的文化，与早期版本相比，V4.0 中的内容要多得多，尽管不是真正的主流文化。IOW，如果您尝试通过将区域性名称传递给其构造函数来实例化“CultureInfo”，它可能适用于 .NET 的一个版本，但会在另一个版本上引发“ArgumentException”。这可能会或可能不会影响您的特定应用程序，但需要注意（例如，它会影响我的应用程序）。还要注意您通常使用的 .NET 版本。有时会添加新的文化，与早期版本相比，V4.0 中的内容要多得多，尽管不是真正的主流文化。IOW，如果您尝试通过将区域性名称传递给其构造函数来实例化“CultureInfo”，它可能适用于 .NET 的一个版本，但会在另一个版本上引发“ArgumentException”。这可能会或可能不会影响您的特定应用程序，但需要注意（例如，它会影响我的应用程序）。还要注意您通常使用的 .NET 版本。有时会添加新的文化，与早期版本相比，V4.0 中的内容要多得多，尽管不是真正的主流文化。IOW，如果您尝试通过将区域性名称传递给其构造函数来实例化“CultureInfo”，它可能适用于 .NET 的一个版本，但会在另一个版本上引发“ArgumentException”。这可能会或可能不会影响您的特定应用程序，但需要注意（例如，它会影响我的应用程序）。它可能适用于 .NET 的一个版本，但会在另一个版本上引发“ArgumentException”。这可能会或可能不会影响您的特定应用程序，但需要注意（例如，它会影响我的应用程序）。它可能适用于 .NET 的一个版本，但会在另一个版本上引发“ArgumentException”。这可能会或可能不会影响您的特定应用程序，但需要注意（例如，它会影响我的应用程序）。

# iis - MS WebPI 包 runCommand 在 Manifest.xml 中不起作用

> ID：12485887
> 
> 赞同：0
> 
> 时间：2012-09-18T22:18:05.850
> 
> 标签：iis, webmatrix, msdeploy, web-platform-installer

通过 Web 平台安装程序安装时，如何让[runCommand 提供程序](http://technet.microsoft.com/en-us/library/ee619740%28v=ws.10%29.aspx)在 MS Deploy 包中工作？`Manifest.xml`

我正在尝试构建一个简单的测试 MS Web 部署包，可由 Web 平台安装程序通过[自定义提要](http://blogs.iis.net/kateroh/archive/2009/10/24/web-pi-extensibility-custom-feeds-installing-custom-applications.aspx)安装。我正在尝试在[Manifest.xml](https://github.com/rpatterson/iiswsgi/blob/05d68464d8fdc360387b9976984b74dd4e0d6827/sample.msdeploy/Manifest.xml)`runCommand`文件中使用提供程序：

```
<?xml version="1.0" encoding="utf-8" ?>
<msDeploy.iisApp>
  <iisApp path="IISWSGISampleApp" />
  <runCommand path="set" />
</msDeploy.iisApp> 
```

仅用于输出运行命令的`set`环境，但它不适用于任何数量的不同`path` 值。当我通过具有任何属性的 Web 平台安装程序安装包时，`path`我得到相同的错误：

```
[13:54:312]Source runCommand (set) does not match destination (set) differing in attributes (isSource). Update pending.
[13:54:315]Updating runCommand (set).
    Details:
    operationType: Update
    providerName: runCommand
    path: set
EXCEPTION: System.IO.FileNotFoundException: Could not find file '\\?\C:\Users\rpatterson\Documents\My Web Sites\IISWSGISampleApp'.
File name: '\\?\C:\Users\rpatterson\Documents\My Web Sites\IISWSGISampleApp'
... 
```

如果我`<runCommand>`从`Manifest.xml`. 我还确认`C:\Users\rpatterson\Documents\My Web Sites\IISWSGISampleApp`当 WebPI 显示错误时确实存在。另外，我发现`\\?\`样式路径是为了[安全地引用 Windows 中的长路径](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx#maxpath)，所以可能是长路径支持的某些部分被破坏了。

我在 Windows 7 Professional、Web Platform Installer 4.0 和 Web Matrix 2.0 RC 下执行所有这些操作，它们的 about 对话框显示：

```
Version 2.0 RC
WebMatrix: 7.1.1587.0
IIS Express: 8.0.8298.0
.NET Framework: 4.0.30319.17379 built by: FXBETAREL
Web Deploy: 7.1.1516.0
SQL Server Compact: 4.0.8854.1
Web Platform Installer: 7.1.1586.1
ASP.NET Web Pages: 2.0.20505.0
ASP.NET Web Pages: 1.0.20105.407 
```

所有这一切背后的代码都[在 GitHub 上的 IISWSGI 中](https://github.com/rpatterson/iiswsgi)，[使用此提交](https://github.com/rpatterson/iiswsgi/commit/05d68464d8fdc360387b9976984b74dd4e0d6827)进行测试。要重现我正在使用的环境，请参阅[IISWSGI 文档](https://github.com/rpatterson/iiswsgi#sample-package)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T13:30:41.123

`runCommand`在能够重现错误之后，我曾经能够无错误地使用，除了一些组合机器重启并使用 WebPI 在两者之间安装应用程序之外什么都不做。经过进一步测试，我现在可以通过以下方式重现错误：

*   重启机器
*   使用 WebPI 安装应用程序
*   退出 WebPI
*   使用 WebPI 再次安装应用程序（无需重新启动）

然后，如果我重新启动机器，我可以使用 WebPI 再次安装应用程序。IOW，WebPI 似乎有一个错误，即如果不重新启动机器就无法启动两次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T11:00:29.590

尝试将您的`set`命令移动到`.bat`/`.cmd`并将其作为`runCommand`. [只要您不向文件传递任何参数](https://stackoverflow.com/questions/12672893/pass-parameters-to-batch-file-in-msdeploy-runcommand)，它就会包含在包中并在您将包同步到其他地方时运行。

# php - How to convert mysql array result into new array for json encoding

> ID：12485889
> 
> 赞同：0
> 
> 时间：2012-09-18T22:18:07.780
> 
> 标签：php

I can’t seem to get the result I need. Here is the array as it is provided by the sql query:

```
Array (
 [0] => Array ( 
     [id] => 7
     [description] => Accepted )
 [1] => Array ( 
     [id] => 8
     [description] => Declined )
 [2] => Array (
     [id] => 11 
     [description] => Deferred ) 
     ) 
```

Here is the format for how I need to have it foreach of the objects listed above:

```
['7'][‘7’] = “Accepted”;
['7'][‘8’] = “Declined ”;
['7'][‘11’] = “Deferred”; 
```

...where the first array[‘7’] is an added value and needed for each object.

Seems easy enough, but the foreach statements I created return an error “cannot use scalar value as an array”</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T22:23:06.387

```
$rows = /*Your Data above*/
$data = array('7'=>array());
foreach($rows as $row)
    $data['7'][$row['id']] = $row['description'];

$jsonData = json_encode($data); 
```

可能会完成

# ruby-on-rails - Error when installing memcache gem

> ID：12485890
> 
> 赞同：1
> 
> 时间：2012-09-18T22:18:18.697
> 
> 标签：ruby-on-rails, ruby

I am running gem install memcache -v '1.2.13', and I am getting this error on ruby 1.9.3 on OSX 10.8

```
ld: library not found for -lruby.1.9.1
collect2: ld returned 1 exit status
make: *** [native_server.bundle] Error 1

Gem files will remain installed in /Users/username/.rvm/gems/ruby-1.9.3-p125/gems/memcache-1.2.13 for inspection.
Results logged to /Users/username/.rvm/gems/ruby-1.9.3-p125/gems/memcache-1.2.13/ext/gem_make.out 
```

I have no idea what to do at this point.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T09:48:38.657

好吧，也许有点晚了，但对于每个有同样问题的人，你可以看看我的帖子，它是关于同一主题的。我找到了解决这个问题的方法。

-->[安装内存缓存时出错 (1.2.13)](https://stackoverflow.com/questions/19910329/error-while-installing-memcache-1-2-13?lq=1)

希望对你也有帮助！;-)

# java - 使用 DOM 在 Java 中解析 xml 文件

> ID：12485899
> 
> 赞同：2
> 
> 时间：2012-09-18T22:19:03.097
> 
> 标签：java, xml, dom, xml-parsing

我想解析这个 xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string-array name="descripciones">
        <item>one</item>
        <item>two</item>
    </string-array>
</resources> 
```

原始文件是一个更大的数组。这是我的代码：

```
builder = builderFactory.newDocumentBuilder();
Document document = builder.parse(new FileInputStream("descripciones.xml"));
Element rootElement = document.getDocumentElement();
NodeList nl = rootElement.getElementsByTagName("string-array");

Element nl1 =(Element) nl.item(0);
NodeList nl2=nl1.getChildNodes();

for(int i=0; i<nl2.getLength();i++){
    String text=nl2.item(i).getTextContent();
    System.out.println(i+text);
} 
```

问题是当我打印结果时，我得到每一行我得到一个空项目：

```
1 one
2
3 two
4 
```

有没有办法解决它？有没有更好的方法来提取标签之间的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T23:57:10.443

您正在处理 的所有子节点`string-array`，包括节点之前和之后的文本`item`节点。尝试

```
int pos = 0;
for(int i=0; i<nl2.getLength();i++){
    Node n = nl2.item(i);
    if (n.getNodeType() == Node.ELEMENT_NODE)
    {
        pos++;
        String text=n.getTextContent();
        System.out.println(pos + text);
    }
} 
```

这将跳过`string-array`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T22:38:59.560

你需要在 getTextContent() 上做一个 trim() 例如

```
String text=nl2.item(i).getTextContent().trim(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-25T09:58:08.923

```
for (int i = 0; i < nl2.getLength(); i++) {
     Node nt = nl2.item(i);
     if (nt.getFirstChild() != null) {
         String text = nt.getFirstChild().getNodeValue();
         System.out.println(text);
     }
} 
```

# oracle - Best way to insert

> ID：12485904
> 
> 赞同：1
> 
> 时间：2012-09-18T22:19:21.753
> 
> 标签：oracle, oracle10g, sql-loader

What is the best way to insert into a table. I have to insert 10,00,000 plus records in a bulk fashion. The approach which I am using right now is many simple inserts.

```
insert into Table1 values ('1','2','3','4');
insert into Table1 values ('5','2','7','4');
insert into Table1 values ('9','1','3','4');
..............
..............
.........
commit; 
```

Is there a better way of doing this in 10g? Can I do this in a PL/SQL ?

I am pretty new to Oracle.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:57:05.497

由于您从一个分隔的文本文件开始，您应该摆脱`sed`调用并简单地使用[SQL*Loader 实用程序](http://docs.oracle.com/cd/B19306_01/server.102/b14215/part_ldr.htm#i436326)将数据加载到数据库中（您也可以将文件复制到数据库服务器，然后使用外部表将具有非常相似的语法）。您的控制文件最终可能与[本示例](http://docs.oracle.com/cd/B19306_01/server.102/b14215/ldr_concepts.htm#i1004722)非常相似。对列的长度进行一些疯狂的猜测，控制文件将类似于

```
load data
infile '<<name of your data file>>
into table <<name of your table>>
fields terminated by '|' 
(col1 char(5),
 col2 char(7),
 col3 char(9),
 col4 char(11),
 col5 char(13)) 
```

# macos - Integrity checks for kernel extensions in OSX

> ID：12485906
> 
> 赞同：2
> 
> 时间：2012-09-18T22:19:23.990
> 
> 标签：macos, kernel, kernel-extension

is there any way to check for the integrity and validity of a Kernel Extension in OS X? I have to make sure that an extension which bundle name starts with com.apple is a real extension from Apple. Maybe a certificate or whatever footprint that reveal if the kernel extension comes from Apple or Not.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:09:08.187

在解决了这个问题之后，最后我发现没有办法检查内核扩展的任何有效占用空间。例如，默认情况下，每台机器都有一大组标有 com.apple 标识符的扩展，您几乎可以使用相同的捆绑标识符来构建自己的扩展，因此无法区分哪些扩展来自 Apple，哪些不是. 总之，您可能在系统中安装了网络钓鱼的扩展，并且安装安全，没有任何机会检测和删除它。这假设 OS X 的安全层有一个大漏洞。

# java - Java：根据字符串的内容创建对象

> ID：12485912
> 
> 赞同：1
> 
> 时间：2012-09-18T22:20:11.533
> 
> 标签：java, methods

> **可能重复：**
> [使用类名创建实例并调用构造函数](https://stackoverflow.com/questions/6094575/creating-an-instance-using-the-class-name-and-calling-constructor)

如何根据传递给方法的字符串的内容创建对象？例如

```
createObj(String nameclass){
 **class passed** obj;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T22:22:08.693

您可以使用`Class.newInstance()`该类来构造一个实例。但是，您将需要`Class<>`使用`Class.forName(...)`

```
<T> T createObj(String nameclass) throws ClassNotFoundException,
        InstantiationException, IllegalAccessException {

    Class<T> clazz = (Class<T>) Class.forName(nameclass);

    // assumes the target class has a no-args Constructor
    return clazz.newInstance();
} 
```

# java - 仅添加 1 个产品

> ID：12485922
> 
> 赞同：0
> 
> 时间：2012-09-18T22:21:03.423
> 
> 标签：java, html, jsp, servlets

每次我点击添加到购物车时，下面的图库，我希望它传递特定选定项目的 ID

问题：1-servlet 将 1 个产品添加到购物车（第一个），并且 url 如下所示：local.../DisplayCart?productId=01&productId=02&action=addtocart

```
 <form action="/DisplayCart">
 <c:forEach var="product" items="${products}">
                    <tr>
                        <td>${product.name}</td>
                        <td>${product.description}</td>
                        <td>${product.price}</td>
                        <td></td>
                        <td>
                            <input type="hidden" name="productId" value="${product.id}">
                            <input type="submit" name="action" value="addtocart"></td>
                    </tr>
                </c:forEach>

         <form action="<c:url value='/DisplayCart'/>">
        <table>
            <c:forEach var="item" items="${cart.items}">
                    <tr>
                        <td>
       <input type="hidden" name="productId" value="${item.product.id}">
        <input type="text" size="2" name="quantity" value="${item.quantity}">
                            <input type="submit" value="Update">
                        </td>
                        <td>${item.product.name}</td>
                        <td>${item.product.description}</td>
                        <td>${item.product.price}</td>
               <td><input type="submit" name="removeButton" value="Remove">       </td>
                    </tr>
            </table>
                </form>
            </c:forEach> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T23:57:19.157

我发现了它的一个很好的部分。

替换这个

```
 <td><input type="submit" name="removeButton" value="Remove">       </td> 
```

有了这个

```
 <td><a href="<c:url value='/DisplayCart?productId=${product.id}'/>">add</a></td> 
```

并且 url 始终显示为 /DisplayCart?productId=xx

快乐的

# mongodb - 使用 Mongo Shell 连接到 Mongo 服务器时出现问题

> ID：12485925
> 
> 赞同：0
> 
> 时间：2012-09-18T22:21:14.353
> 
> 标签：mongodb, mongo-shell

我对 Mongo shell 很陌生，我正在尝试使用 shell 切换服务器。我当前的服务器当然是 localhost。我正在尝试连接到 someserver 并且我用于此的命令基本上是

mongodb://someserver

我也尝试

mongodb://someserver:27017

在这两种情况下，我的命令后面都是 ... 然后它什么也不做。我还在本地主机上。

请注意，someserver 上不需要凭据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T23:09:17.403

您不能直接从 mongo shell 提示符切换到不同的连接。您*可以*打开其他连接：

```
var somedb = connect('someserver/somedb'); 
```

要使用新的 mongo 服务器重新开始，请在命令 shell 提示符下：

```
mongo someserver/somedb 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T23:27:30.707

您可以远程登录到该主机和端口组合吗？当我遇到问题时，这是我做的第一件事，以确保我至少可以看到该服务。

# excel - 在excel VB中复制而不是插入行

> ID：12485932
> 
> 赞同：1
> 
> 时间：2012-09-18T22:21:41.783
> 
> 标签：excel, vba

我目前正在运行以下脚本

```
Sub Gift_Certificate()

    'Select Bridge Data from tab, cell A2
    Sheets("Bridge Data").Select
    Range("A2").Select

    'Loop while activecell is not blank (goes down the column)
    Do While ActiveCell <> ""
        'Repeat below step if data needs to be sorted into multiple wksts'
        '  Also, create individual worksheets for each
        If InStr(1, ActiveCell, "Gift Certificate", 1) <> 0 Then
            ActiveCell.EntireRow.Copy
            Sheets("GC Redeemed").Select
            Range("A10").Select

        Else
            'If it's not an extension you have specified, it highlites the cell because its cool'
            ActiveCell.Interior.ColorIndex = 6
            GoTo SKIPPING
        End If

        Range("A10").Select
        'Loops down until there's an open cell'
        Do While ActiveCell <> ""
            ActiveCell.Offset(1, 0).Select
        Loop

        ActiveSheet.PasteSpecial

        'Go back to the starting sheet & iterate to the next row
        Sheets("Bridge Data").Select
SKIPPING:
        ActiveCell.Offset(1, 0).Select
    Loop

End Sub 
```

我正在使用它来扫描一个选项卡上的数据并将选择的数据复制到另一个选项卡上。我遇到的问题是我想从新粘贴的数据中运行公式，但是当脚本运行时，它会将新行插入选项卡，将我的所有公式向下推。

我只想让脚本将数据复制到新选项卡中，而不是插入。

有什么建议吗？

ps，我在vb方面的经验几乎为零，所以请放心！

谢谢，

-肖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T23:56:43.720

这是一种非常不同的方法，它使用过滤来选择满足您条件的范围并将其复制到目标工作表的末尾。我不确定它将如何影响您的公式要求，但请尝试一下：

```
Sub Gift_Certificate()
Dim wsSource As Excel.Worksheet
Dim wsTarget As Excel.Worksheet
Dim SourceLastRow As Long
Dim TargetNextRow As Long

Set wsSource = ThisWorkbook.Sheets("Bridge Data")
Set wsTarget = ThisWorkbook.Sheets("GC Redeemed")
'Find the next empty row in the target sheet
With wsTarget
    TargetNextRow = .Range("A" & .Rows.Count).End(xlUp).Row + 1
End With
With wsSource
    'Find the last filled row in the source sheet
    SourceLastRow = .Range("A" & .Rows.Count).End(xlUp).Row
    'Turn off any Autofilters in case they are in other columns
    'I think this is the best way to handle this
    If .AutoFilterMode Then
        .AutoFilterMode = False
    End If
    'Filter to non-matching, and fill with yellow
    .Range("A1").AutoFilter Field:=1, Criteria1:="<>Gift Certficate*", Operator:=xlAnd
    .Range("A2:A" & SourceLastRow).Interior.ColorIndex = 6
    'Filter to matching and copy to target sheet
    .Range("A1").AutoFilter Field:=1, Criteria1:="=Gift Certficate*", Operator:=xlAnd
    .Range("A2:A" & SourceLastRow).EntireRow.Copy Destination:= _
                                                  wsTarget.Range("A" & TargetNextRow)
'Turn off autofilter
    .AutoFilterMode = False
End With
End Sub 
```

# .htaccess - .htaccess 重定向 index.* 并将 url 重写为查询字符串

> ID：12485941
> 
> 赞同：0
> 
> 时间：2012-09-18T22:22:47.063
> 
> 标签：.htaccess, mod-rewrite, redirect

我目前正在尝试在我网站的 /sub/ 文件夹中的 .htaccess 文件中使用两个重写规则。一种是重定向以删除 url 末尾的 index.php、index.html 等，例如 /sub/index.php -> /sub/：

```
RewriteCond %{REQUEST_URI} ^(.*)/index\.[^\.]+$
RewriteRule index.* %1/ [r=301,L] 
```

另一种是重写 php 的 url 以获取查询字符串 eg /sub/testing-testing -> /sub/index.php?field=testing-testing：

```
RewriteRule ^(.*)$ index.php?command_name=$1 [L,QSA] 
```

这些似乎没有问题，但我只是不知道如何让它们一起工作。

我可以看到第二条规则可能出了什么问题，因为第一个规则匹配“index（...）”所以我尝试了这些的不同变体，但我总是以无休止的重定向循环或被重定向回来进入网站的根目录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:28:17.313

您需要匹配实际请求，而不是删除`index.php`. 两条规则不能一起工作的原因是因为 mod_rewrite 一直循环遍历所有规则，直到 URI 停止更改。第二条规则将 URI 重写为`index.php`，第一条规则匹配并删除它，然后第二条规则将其重写回来，等等。

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /(.*)index\.(php|html?)
RewriteRule ^ /%1 [R=301,L] 
```

然后你应该能够保持第二条规则不变。

# mysql - mysql load data infile 无法获取文件的统计信息

> ID：12485942
> 
> 赞同：1
> 
> 时间：2012-09-18T22:22:49.467
> 
> 标签：mysql

我正在尝试使用以下命令将 csv 文件加载到 mySQL 中：

```
LOAD DATA INFILE '/tmp/alcoa_2012_05_15.csv' into table alcoa fields terminated by ','
enclosed by '"'
lines terminated by '\n'
(@var1, Time, volume, open, close, min, max)
set date = STR_TO_DATE(@var1, '%d-%b-%y') 
```

我收到以下错误

```
error 13, load data infile can't get stat of file Errcode: 2 
```

它说它找不到数据文件。我尝试了命令的小变化：

```
LOAD DATA LOCAL INFILE ... 
```

其他一切都一样，现在我收到以下错误消息：

```
ERROR 1148, The used command is not allowed with this MySQL version! 
```

我在 Ubuntu 12.04 上使用最新下载的 MySQL（都在 2 周前安装）

我很困惑，经过大量搜索后，这个论坛已经回答了以前的问题，这些问题很接近，但并不完全是答案。

谢谢

杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-01-04T07:45:59.930

尝试用“LOAD DATA **LOCAL** ”替换您的“LOAD DATA”

*   “LOAD DATA”用于数据库服务器上的文件。
*   “LOAD DATA LOCAL”用于客户端上的文件。你有哪个？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T06:05:44.693

这个问题真是令人沮丧，直到我发现 MySQL`systemd-private-abcdef`在`/tmp`. 所以它永远找不到文件并加载数据。

`PrivateTmp=false`解决方案是在`/etc/systemd/system/mysqld.service`文件中设置：

在我的情况下，文件最终看起来像这样：

```
.include /usr/lib/systemd/system/mysqld.service
[Service]
LimitNOFILE=20000
PrivateTmp=false 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-05T06:44:01.063

我遇到了同样的问题，无法将数据加载到 MySQL 表中，然后我自己解决了这个问题。

错误代码 13 只不过是权限问题。

错误代码 02 是找不到文件。

***这是解决方案：***

检查你的文件的路径，如果它是正确的，那么它的权限问题可以解决如下： 默认`local-infile`设置为值 0。为了使用`LOAD DATA LOCAL INFILE` **它必须启用。**

所以像这样*启动MySQL*：

> mysql -u 用户名 -p --local-infile

这将`LOCAL INFILE`在启动期间启用，因此使用它不会有任何问题！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-11T13:24:42.050

我认为这里的另一个重要问题尚未为用户解决。这是一个简单的问题，无论是使用命令行中的命令还是命令（错误代码 2）
都无法找到文件。 一个非常自然的 unix/linux 用户假设是用户是：`mysql> shell``mysqlimport`

1.  从给定目录运行导入操作
2.  跑步`mysqlimport`或`shell`
3.  找到他想在那里导入的文件
4.  然后假设不需要额外的路径，即只需要文件名或相对路径。

但对我来说很明显，MySQL 使用的相对路径位于 MySQL 的数据库目录的位置，即`/usr/lib/mysql/<dbname>`.
**它正在那里寻找没有任何路径命名的文件**，因此错误代码 2！

那是用户想要导入的数据库的主目录，所以它看起来在那里，而不是您启动 shell 的目录，尤其是命令行导入命令`mysqlimport`.

`mysqlimport`这对于我称之为缺陷的命令来说是非常违反直觉的。我不确定 MySQL db 目录是否是安装 MySQL 时的可控位置，因此对于任何特定系统来说它可能会有所不同。
**解决方案是始终提供要导入的文件的绝对路径。** 答对了！我通过授予在此处写入文件的权限（dir 由“MySQL”用户拥有），然后使用相对路径以及 shell 和命令行命令上的绝对路径访问它来测试这一点。确保在使用 MySQL 权限后重新创建了数据库！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-13T10:47:05.460

谢谢@raina77ow，关于[检查文件权限的建议](https://stackoverflow.com/questions/12485942/mysql-load-data-infile-cant-get-the-stat-of-file#comment16799240_12485942)。
我花了很长时间查看其他所有内容。终于看到了你的帖子，看了看。

我的问题不是权限，而是我在文件上放置的额外扩展名，因为该文件夹被设置为隐藏已知扩展名。

在 Windows 资源管理器中查看文件的属性使我能够`.txt`在最后看到并更正额外内容。

一旦我修复它，加载数据本地 infile 就像其他文件一样具有魅力。

希望这对其他人有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-28T22:21:07.623

如果您使用的是 Debian，另一种解决方案是将文件移动到您的“/tmp”目录中。这为我解决了问题。

# html - jQuery 加载并提交表单

> ID：12485943
> 
> 赞同：1
> 
> 时间：2012-09-18T22:22:58.530
> 
> 标签：html, href

我有一个“简单”的任务......

我正在寻找一种提交和加载的方法...

```
<script>
    $(document).ready(function(){
      $(".navigation").click(function(){
        $("#main").load('demoAvisos_2.asp');
        return (false)
      });

    });

    </script>

</head>

<body><br><br>

<div class="container">
<br>
<!---- cabealho ------>
<div>

</div>
<br>
<!-- +#+#+#+#+#+#+#+ -->
<!------ sidebar1 ----->
    <div class="sidebar1" id="side1">
        <ul class="nav">

            <%
            dasql =" QUERY and call"

            count = 1
            taviso = da.recordcount

            do while not da.eof     
            %>  
                <li>

                <a href="#"  class="navigation"><%=da("aviso")%></a>
                <input type="hidden" value="teste_2" name="r">

                </li>

            <%
            Session("teste_"&count) = da("aviso")
            'Response.Write(Session("teste_"&count))
            count = count+1

            da.movenext
            loop

            Session("count") = count
            'Response.Write(Session("count"))
            %>

        </ul>
    </div>

<!-- +#+#+#+#+#+#+#+ -->
<!------- main -------->
    <div class="content" id="main">

    </div>
<!-- +#+#+#+#+#+#+#+ -->
</div> 
```

我需要通过页面 demoAvisos_2.asp 的链接提交信息，并将其加载到

我只是查看了其他论坛，但我只是找到了如何加载（）或提交（）而不是展位！

有人可以帮助我吗？

# jquery - 通过使用 jquery 检查 z-index 找到最上面的 div

> ID：12485947
> 
> 赞同：1
> 
> 时间：2012-09-18T22:23:13.267
> 
> 标签：jquery, z-index

我需要通过检查 z-index 找到最上面的 div：

```
<div>
<div id="box_1">some image</div>
<div id="box_444">some image</div>
<div id="box_555">some image</div>
<div id="box_888">some image</div>
<div id="box_999">some image</div>
</div> 
```

我能解释的最好方法就像在黑暗中洗牌一副图像而不知道哪个图像在上面。基本上我需要检查哪个 div 具有最高的 z-index 并通过 div 的 id 来识别。

任何 jquery 专家可以帮助我吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:29:01.197

> 基本上我需要检查哪个 div 具有最高的 z-index 并通过 div 的 id 识别

你在寻找这样的东西吗？

```
var allDivs = $('div div');
var topZindex = 0;
var topDivId;
allDivs.each(function(){
    var currentZindex = parseInt($(this).css('z-index'), 10);
    if(currentZindex > topZindex) {
        topZindex = currentZindex;
        topDivId = this.id;
    }
});

console.log(topDivId);
console.log(topZindex); 
```

[http://jsfiddle.net/emLcY/](http://jsfiddle.net/emLcY/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T22:32:32.187

尝试这个

```
var greatest = 0;
var greatestDiv;

$('div').each(function(){
    if($(this).css('z-index') > greatest){
        greatest = $(this).css('z-index');
        greatestDiv = $(this).attr('id');
    }
})

console.log(greatest);
console.log(greatestDiv); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T22:37:13.913

[这](http://jsfiddle.net/Ljptw/5/)将使您到达那里：

```
$(function(){
    var highest = -1, el = null;
    $('div[id^="box"]').each(function(){

        var z = parseInt($(this).css('z-index'), 10);

        if (z > highest) { 
            el = this;
            highest = z;                    
        }
    });

    console.log('the highest is:', el)
});​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T22:40:04.280

尝试这个

```
$(function() {
    var $divs = $('div > div');   
    var maxId = '';
    var max = 0;

    $.each($divs, function(i){
       var a = $($divs[i]).css('z-index');
        console.log(a);
        if(parseInt(a) > parseInt(max)){
           max = a;
           maxId = $(this).attr('id');
        }
    });    
    alert(maxId);
});
​ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-18T22:48:11.010

[**工作演示**](http://jsfiddle.net/8FgKZ/3/)

```
$.fn.topmost = function () {
    var positionedDivs = this.filter( function() {
        return !isNaN( parseInt( $(this).css("z-index"), 10 ) );
    });
    var topElem = positionedDivs.first();

    positionedDivs.each( function() {
        if ( $(this).css('z-index') > +topElem.css("z-index") ) {
            topElem = $(this);
        }
    });

    return topElem.get(0) || this.get(0);
};

$(function() {
    var topDiv = $('div > div').topmost();
    console.log( topDiv.id )
});​ 
```

# php - Html 标题部分出现在带有空格的正文中

> ID：12485949
> 
> 赞同：4
> 
> 时间：2012-09-18T22:23:40.893
> 
> 标签：php, html

一些更新后，我的登录页面刚刚坏了。检查 chrome 中的元素时有一个空的头部部分，并且所有头部项目都放在 body 标记中。但是当我寻找http响应时，一切都是正确的。

身体部分的开头也有一个空间，打破了布局。在这里你可以看到它[http://www.sporapp.com/](http://www.sporapp.com/)

顺便提一句。它正在本地工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T22:37:27.020

在 doctype 声明之前，我看到一些空行作为响应。从 Chrome 网络选项卡复制/粘贴 HTML 后，我发现了一些？doctype 之前的符号（看起来这是notepad ++由于某种原因无法显示的符号）。在服务器上的 vim 中检查该文件。假设您会在本地计算机上没有的 doctype 之前找到一个符号。删除它并假设它会工作（它在我的机器上工作，至少 head 被正确解析） ![在此处输入图像描述](../Images/9070855d43609d50590d1c0b15ead268.png)

**来自问题作者：**

对于 BOM，感谢 Mercurial，它破坏了编码并导致 BOM。还有一个包含 ?> 的 php 文件，然后是空格。更新损坏的文件并删除空格后，终于可以了:) ..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T22:30:52.100

通过验证器运行它：http: [//validator.w3.org/check ?uri=http%3A%2F%2Fwww.sporapp.com%2F&charset=%28detect+automatically%29&doctype=Inline&group=0](http://validator.w3.org/check?uri=http://www.sporapp.com/&charset=%28detect%20automatically%29&doctype=Inline&group=0)

我猜是元标记错误导致了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T22:28:59.403

只需删除开始正文标记后的空行即可：)

# jquery - jQuery UI Accordion div 包含大量数据打开新的手风琴不向上滚动页面

> ID：12485953
> 
> 赞同：0
> 
> 时间：2012-09-18T22:24:12.080
> 
> 标签：jquery, jquery-ui, accordion

我正在使用运行手风琴功能的 jquery ui。我有`<h3></h3><div></div>`很多数据，垂直填充页面。当您向下滚动以单击并打开下一个手风琴选择时，它会向上拉页面，因此会隐藏一些内容，直到我向上滚动为止。

有没有办法防止这种情况？一种单击方式使当前选定的`h3`标签将用户带到顶部`<h3>`？

编辑：我在这里寻找的主要想法是确保`<h3></h3>`单击的内容不在查看区域之外。理想情况下，我希望它从顶部向下大约 50 px 左右。

这是进度的小提琴：http: [//jsfiddle.net/rwyvh/](http://jsfiddle.net/rwyvh/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T23:41:52.440

这是[jsFiddle](http://jsfiddle.net/rwyvh/1/)。我不得不用它`ui.newHeader`来获得`change`事件中的位置。

```
$("#accordion").accordion({
    autoHeight: false,
    collapsible:true,
    navigation:true,
    active:false,
    change: function(event, ui) {
        $(window).scrollTop(ui.newHeader.position().top - 50);
    }
});​ 
```

# devise - 设计：如何创建一个替代的新会员注册周期？

> ID：12485957
> 
> 赞同：1
> 
> 时间：2012-09-18T22:24:56.863
> 
> 标签：devise, ruby-on-rails-3.2

**环境**

红宝石 1.9.3p194（2012-04-20 修订版 35410）[x86_64-darwin10.8.0]；导轨 3.2.6；OSX 10.6.8：设计（2.0.4）

**背景**

我们有一个定期的设计会员注册周期，其中：

1.  注册表格附有大量相关信息；
2.  并且在其中成功注册 (sign_up) 会调用会员帐户页面——也包含大量相关信息。
3.  **我们还需要一个单独的注册周期，而这两个视图都没有相对大量的信息。**

**客观的**

我们想创建**一个单独的注册 (sign_up) 周期**，其中：

1.  **为手持设备配置的最小注册表单**需要注册信息（没有我们常规现有周期的海量相关信息）；
2.  **但是哪个注册成功的过程没有登录注册人；**
3.  因此，在成功注册的情况下**，注册后的注册会显示一个最小确认页面，其中包含最终许多进一步注册中的每一个的注册信息**（从不属于已登录的会员，也不会将私人信息存储到用户代理）；
4.  并通过这个简单的注册信息页面手动链接回最小的注册表单 (1)，以使用我们所谓的“信息亭模式”进行进一步的注册。

**问题**

我们将如何使用 Devise 做到这一点？

# python - 将 striplist() 合并到 python3 代码中？

> ID：12485960
> 
> 赞同：0
> 
> 时间：2012-09-18T22:25:05.107
> 
> 标签：python, strip

我有一个 csv 阅读器，可以将数据值拉入列表中，一旦将这些数据放入列表中，我想去除列表中的空格。我在网上查看并看到人们使用`striplist()`

例如

```
def striplist(l):
    return([x.strip() for x in l]) 
```

但是，作为一个新手并尝试合并代码，我运气不佳，对此问题的指导或对我做错了什么的了解将不胜感激。我的代码如下：

```
import csv

import time

csvfile = open("example.csv")

filetype = csv.Sniffer().has_header(csvfile.read(1024))

csvfile.seek(0)

reader = csv.reader(csvfile,filetype)

csvreaderlist = []

csvfilecounter = 0

if filetype:
    next(reader)
    print("CSV file located, headers present, importing data")
    time.sleep(3)
    for data in reader:
            csvreaderlist.append(data)
            print(data)
            csvfilecounter = csvfilecounter +1
            summarycounter = summarycounter +1

else:
    print("CSV file located, no headers found, importing data")
    time.sleep(3)
    for data in reader:
            csvreaderlist.append(data)
            csvfilecounter = csvfilecounter +1
            summarycounter = summarycounter +1
            print(data)

if csvfilecounter == csvfilecounter:
    print(len(csvreaderlist),'Lines were successfully imported from the CSV file')
    time.sleep(3)
def striplist(csvreaderlist):
    return([data.strip() for data in csvreaderlist]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:40:05.907

您的功能示例：

```
def strip_list(the_list):
    return [line.strip() for line in the_list]

lines = ['foo\n', 'bar\r\n', 'baz']
stripped_list = strip_list(lines)
print(stripped_list) 
```

会输出：

```
['foo', 'bar', 'baz'] 
```

* * *

在这里作为一个丑陋的记忆效率低下的单线，只是为了展示使用`splitlines()`:)

```
return ''.join(csvreaderlist).splitlines() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T08:23:14.843

如果我正确理解了这个问题，您是在问您应该在哪里应用您的`strip_list`函数，以便您导入的 CSV 数据全部被剥离字符串。关键位置是您从 CSV 阅读器获得的“数据”列表。这将始终是一个字符串列表，因此您可以`strip_list`在将其附加到结果数组之前将其传递给您的函数。

顺便说一句，您目前在`if`语句的两个分支中复制了 CSV 读取循环的核心部分。那是不必要的。以下是如何在不重复的情况下做到这一点：

```
if filetype:
    next(reader)
    print("CSV file located, headers present, importing data")
else:
    print("CSV file located, no headers found, importing data")

time.sleep(3)

for data in reader:
        csvreaderlist.append(strip_list(data)) # do stripping here!
        csvfilecounter = csvfilecounter +1
        summarycounter = summarycounter +1 
```

请注意`strip_list`，如果要在模块级别（而不是作为函数的一部分）运行它，则需要将定义移动到此代码上方的某个位置。

顺便说一句，您当前将`True`or （的`False`返回值`csv.Sniffer().has_header()`）作为. 这可能不是你想要做的。相反，您需要单独的变量和：`dialect``Reader``dialect``has_header`

```
csvfile = open("example.csv")
top = csvfile.read(1024)
csvfile.seek(0)

sniffer = csv.Sniffer()

dialect = sniffer.sniff(top)
has_header = sniffer.had_header(top)

reader = csv.reader(csvfile, dialect)
if has_header:
    next(reader) 
```

# c - 当我没有窗口句柄时，如何从另一个进程获取消息？

> ID：12485961
> 
> 赞同：3
> 
> 时间：2012-09-18T22:25:15.087
> 
> 标签：c, winapi, inter-process-communicat

我有 2 个程序，我需要一种方法让其中一个程序以某种方式向另一个程序发送消息。我研究了 Win32 API 中的 SendMessage 函数，虽然只要你有窗口句柄它就可以很好地工作，但我的程序需要能够在服务下注销时运行，这意味着它不能创建窗口句柄.

有什么方法可以在不创建窗口句柄的情况下接收来自另一个进程的消息？我一直在寻找Win32是否有其他方式可以连接到消息传递中，这样我就不需要依赖窗口句柄，但是必须有某种方式在基本级别的进程之间进行通信，不是不在那里？

我已经研究过使用 Pipe 来做到这一点，但遇到了巨大的权限问题，除此之外，它的级别比我真正想要的要高得多。我需要做的就是发送一个简单的自定义 int 消息，以便我的进程知道是时候关闭了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T23:00:02.507

如果它真的像通知其他程序关闭一样简单，那么您可以[创建一个命名事件](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682396%28v=vs.85%29.aspx)。两个进程都创建具有相同名称的事件。一个监视它，另一个可以发出信号。观看者可以通过使用[MsgWaitForMultipleObjects](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684242%28v=vs.85%29.aspx)而不是 PeekMessage 的修改后的消息泵来做到这一点。

这里存在轻微的拒绝服务风险，因为恶意进程可能会创建同名事件并导致您的其他应用程序退出。

如果您需要更复杂的通信，您将需要管道、邮槽、共享内存、文件监视、注册表监视或使用另一个可同步的内核事件（互斥锁、信号量等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-12T21:15:09.993

这工作正常：

```
// msg.c:

#include <windows.h>
#include <stdio.h>

int CALLBACK WinMain (_In_ HINSTANCE hInstance, _In_ HINSTANCE hPrevInstance, _In_ LPSTR lpCmdLine, _In_ int nCmdShow) {
    MSG msg;
    DWORD curThreadId;

    curThreadId = GetCurrentThreadId();

    // Send messages to self:
    PostThreadMessage(curThreadId, WM_USER, 1, 2);
    PostThreadMessage(curThreadId, WM_USER+1, 3, 4);
    PostThreadMessage(curThreadId, WM_USER+2, 5, 6);
    PostThreadMessage(curThreadId, WM_USER+3, 7, 8);
    PostThreadMessage(curThreadId, WM_QUIT, 9, 10);

    while (GetMessage(&msg, NULL, 0, 0)) {
        printf("message: %d; wParam: %d; lParam: %d\n", msg.message, msg.wParam, msg.lParam);
    }

    return (int) msg.wParam;
} 
```

制作：

```
> g++ -m64 -mwindows -c -o msg.o msg.c
> g++ -s -o msg.exe msg.o
> msg.exe
message: 1024; wParam: 1; lParam: 2
message: 1025; wParam: 3; lParam: 4
message: 1026; wParam: 5; lParam: 6
message: 1027; wParam: 7; lParam: 8

> echo %ERRORLEVEL%
9 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-12T21:35:10.587

如果您的 IPC 不需要任何参数，则您的服务可以实现其`Handler/Ex()`查找的自定义控制代码，然后其他应用程序可以使用[`ControlService()`](https://docs.microsoft.com/en-us/windows/desktop/api/winsvc/nf-winsvc-controlservice)该控制代码将该控制代码发送到服务。

不过，可以改为使用以编程方式关闭服务`ControlService(SERVICE_CONTROL_STOP)`。`Handler/Ex()`该服务应在收到`SERVICE_CONTROL_STOP`请求时自行关闭。

# iphone - 基于 iPhone 列表的应用程序

> ID：12485964
> 
> 赞同：-1
> 
> 时间：2012-09-18T22:25:23.463
> 
> 标签：iphone, objective-c, ios

我有一个基于列表的应用程序，它使用 Core Data 来存储大部分信息，而文档目录只是用来保存图像，因为它们太大了。我真的很想给用户一种方法来备份那里的数据，但我不想使用我自己的服务器。

我不确定在 iCloud 上备份数据的用户是否会将我的应用程序的所有图片存储在文档目录中。关于干净、简单的解决方案有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T22:27:22.327

它应该备份 Documents 目录。正是由于这个原因，自推出 iCloud 以来，在那里存储缓存文件导致 App Store 遭到拒绝。

# sql - 复制 SQL Server 2008 数据库并重命名

> ID：12485966
> 
> 赞同：12
> 
> 时间：2012-09-18T22:25:43.310
> 
> 标签：sql, database, sql-server-2008, sql-server-2012

我有一个 SQL Server 2008 数据库，我想在服务器上复制并创建一个新数据库（使用不同的名称）。我不关心维护数据，可以在没有数据的情况下创建新数据库。我要做的是以下几点：

*   创建旧数据库的新数据库维护结构
*   设置新数据库的名称
*   将所有 varchar 和 char 数据类型更改为 nvarchar 和 nchar
*   将所有文本数据类型更改为 nvarchar(MAX)

顺便说一句，我还有 2 个问题不属于我的任务，但想考虑以下问题：

*   如何将 sql server 数据库升级到 sql server 2012
*   我需要对数据库进行任何准备工作以确保我可以轻松升级它吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-18T23:36:30.910

这确实是多个问题的组合。

* * *

# 问题 1 和 2

> *   创建旧数据库的新数据库维护结构
>     
> *   设置新数据库的名称

最简单的备份命令是：

```
BACKUP DATABASE dbname TO DISK = 'C:\some folder\dbname.bak' WITH INIT;
-- or WITH INIT, COMPRESSION if you are on Enterprise or Developer 
```

现在要将其还原为不同的数据库，您需要知道文件名，因为它会尝试将相同的文件放在同一个位置。因此，如果您运行以下命令：

```
EXEC dbname.dbo.sp_helpfile; 
```

您应该会看到包含数据和日志文件的名称和路径的输出。当你构建你的恢复时，你需要使用这些，但是将路径替换为新数据库的名称，例如：

```
RESTORE DATABASE newname FROM DISK = 'C:\some folder\dbname.bak'
  WITH MOVE 'dbname' TO 'C:\path_from_sp_helpfile_output\newname_data.mdf',
  MOVE 'dbname_log' TO 'C:\path_from_sp_helpfile_output\newname_log.ldf'; 
```

您必须将`dbname`and替换`newname`为您的实际数据库名称，以及`C:\some folder`您`C:\path_from_sp_helpfile_output\`的实际路径。除非我知道那些是什么，否则我无法更具体地回答。

* * *

这是一个完整的复制品：

```
CREATE DATABASE [DB-A];
GO

EXEC [DB-A].dbo.sp_helpfile; 
```

部分结果：

```
name     fileid filename
-------- ------ ---------------------------------
DB-A     1      C:\Program Files\...\DB-A.mdf
DB-A_log 2      C:\Program Files\...\DB-A_log.ldf 
```

现在我运行备份：

```
BACKUP DATABASE [DB-A] TO DISK = 'C:\dev\DB-A.bak' WITH INIT; 
```

当然，如果克隆目标（在这种情况下`DB-B`）已经存在，你会想要删除它：

```
USE [master];
GO
IF DB_ID('DB-B') IS NOT NULL
BEGIN
  ALTER DATABASE [DB-B] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
  DROP DATABASE [DB-B];
END
GO 
```

现在此还原将成功运行，为您提供重命名为 DB-B 的 DB-A 副本：

```
RESTORE DATABASE [DB-B] FROM DISK = 'C:\dev\DB-A.bak'
  WITH MOVE 'DB-A'     TO 'C:\Program Files\...\DB-B.mdf',
       MOVE 'DB-A_log' TO 'C:\Program Files\...\DB-B_log.ldf'; 
```

* * *

# 问题 3 和 4

> *   将所有 varchar 和 char 数据类型更改为 nvarchar 和 nchar
>     
> *   将所有文本数据类型更改为 nvarchar(MAX)

* * *

重构是一个主要的痛苦，特别是如果其中一些列参与约束。您可以通过这种方式构建一个非常基本的脚本，但您将需要更强大的工业实力来处理所有这些变量。这假设所有列都可以为空并且不参与约束。

```
DECLARE @sql NVARCHAR(MAX) = N'';

SELECT @sql += '
  ALTER TABLE ' + 
  QUOTENAME(OBJECT_SCHEMA_NAME(c.[object_id])) 
  + '.' + QUOTENAME(OBJECT_NAME(c.[object_id]))
  + ' ALTER COLUMN ' + QUOTENAME(c.name) + ' '
  + CASE t.name WHEN N'text' 
     THEN N'nvarchar(max)' 
     ELSE N'n' + t.name + '(' + RTRIM(c.max_length) + ')'
  END + ';'
FROM sys.columns AS c
INNER JOIN sys.types AS t
ON c.user_type_id = t.user_type_id
WHERE c.system_type_id IN (35, 167, 175)
AND OBJECTPROPERTY(c.[object_id], 'IsMsShipped') = 0;

PRINT @sql;
-- EXEC sp_executesql @sql; 
```

您可以使用 PRINT 输出来验证脚本的前 8K，当您认为它看起来不错时，取消注释`EXEC`.

完成后，您将需要重建所有索引。

也就是说，按照 Tony 的建议编写数据库脚本（或使用像[Red Gate 的 SQL Compare 之](http://www.red-gate.com/products/sql-development/sql-compare/)类的工具- 或其[众多替代方案之一](http://bertrandaaron.wordpress.com/2012/04/20/re-blog-the-cost-of-reinventing-the-wheel/)- 针对空数据库）可能会容易得多，特别是如果其中一些列参与约束 - 这可能需要删除并重新创建才能更改类型。

* * *

# 问题 5 和 6

> *   如何将 sql server 数据库升级到 sql server 2012
>     
> *   我需要对数据库进行任何准备工作以确保我可以轻松升级它吗？

您不能只升级 2008 实例上的单个数据库。您要么就地升级，要么设置一个新实例（如托尼所述），然后迁移您的数据库（最好使用备份/恢复 - 许多人会告诉您分离/附加，但这远不安全）。你应该做的准备工作包括：

*   运行[SQL Server 2012 升级顾问](http://msdn.microsoft.com/en-us/library/ms144256.aspx)
*   确保您的所有数据库都没有兼容级别 80 或更低

升级后，您需要：

*   将兼容级别设置为 110
*   更新所有统计信息

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-20T06:35:02.217

[复制数据库的脚本的](http://sqlhint.com/sqlserver/sqlserver/how-to/tsql/copy-clone-database)源。

```
USE master;

DECLARE
    @SourceDatabaseName AS SYSNAME = '<SourceDB>', 
    @TargetDatabaseName AS SYSNAME = '<TargetDB>'

-- ============================================
-- Define path where backup will be saved
-- ============================================
IF NOT EXISTS (SELECT 1 FROM sys.databases WHERE name = @SourceDatabaseName)
    RAISERROR ('Variable @SourceDatabaseName is not set correctly !', 20, 1) WITH LOG       

DECLARE @SourceBackupFilePath varchar(2000)
SELECT @SourceBackupFilePath = BMF.physical_device_name
FROM
    msdb.dbo.backupset B
    JOIN msdb.dbo.backupmediafamily BMF ON B.media_set_id = BMF.media_set_id
WHERE B.database_name = @SourceDatabaseName
ORDER BY B.backup_finish_date DESC

SET @SourceBackupFilePath = REPLACE(@SourceBackupFilePath, '.bak', '_clone.bak')

IF @SourceBackupFilePath IS NULL
        RAISERROR ('Could not determine file path for backup file!', 16, 1) WITH LOG

-- ============================================
-- Backup source database
-- ============================================
DECLARE @Sql NVARCHAR(MAX) 
SET @Sql = 'BACKUP DATABASE @SourceDatabaseName TO DISK = ''@SourceBackupFilePath'''
SET @Sql = REPLACE(@Sql, '@SourceDatabaseName', @SourceDatabaseName)
SET @Sql = REPLACE(@Sql, '@SourceBackupFilePath', @SourceBackupFilePath)
SELECT 'Performing backup...', @Sql as ExecutedSql
EXEC (@Sql)

-- ============================================
-- Automatically compose database files (.mdf and .ldf) paths
-- ============================================
DECLARE
          @LogicalDataFileName as NVARCHAR(MAX)
        , @LogicalLogFileName as NVARCHAR(MAX)
        , @TargetDataFilePath as NVARCHAR(MAX)
        , @TargetLogFilePath as NVARCHAR(MAX)

SELECT
        @LogicalDataFileName = name,
        @TargetDataFilePath = SUBSTRING(physical_name,1,LEN(physical_name)-CHARINDEX('\',REVERSE(physical_name))) + '\' + @TargetDatabaseName + '.mdf'
FROM sys.master_files
WHERE
        database_id = DB_ID(@SourceDatabaseName)        
        AND type = 0            -- datafile file

SELECT
        @LogicalLogFileName = name,
        @TargetLogFilePath = SUBSTRING(physical_name,1,LEN(physical_name)-CHARINDEX('\',REVERSE(physical_name))) + '\' + @TargetDatabaseName + '.ldf'
FROM sys.master_files
WHERE
        database_id = DB_ID(@SourceDatabaseName)        
        AND type = 1            -- log file     

SELECT  
    @LogicalDataFileName as LogicalDataFileName,
    @LogicalLogFileName as LogicalLogFileName,
    @TargetDataFilePath as TargetDataFilePath,
    @TargetLogFilePath as TargetLogFilePath                

IF @TargetDataFilePath IS NULL OR @TargetLogFilePath IS NULL
    RAISERROR ('Could not determine target paths!', 16, 1) WITH LOG

-- ============================================
-- Restore target database
-- ============================================
IF EXISTS (SELECT 1 FROM sys.databases WHERE name = @TargetDatabaseName)
    RAISERROR ('A database with the same name already exists!', 20, 1) WITH LOG        

SET @Sql = 'RESTORE DATABASE @TargetDatabaseName
FROM DISK = ''@SourceBackupFilePath'' 
WITH MOVE ''@LogicalDataFileName'' TO ''@TargetDataFilePath'',
MOVE ''@LogicalLogFileName'' TO ''@TargetLogFilePath''' 
SET @Sql = REPLACE(@Sql, '@TargetDatabaseName', @TargetDatabaseName)
SET @Sql = REPLACE(@Sql, '@SourceBackupFilePath', @SourceBackupFilePath)
SET @Sql = REPLACE(@Sql, '@LogicalDataFileName', @LogicalDataFileName)
SET @Sql = REPLACE(@Sql, '@TargetDataFilePath', @TargetDataFilePath)
SET @Sql = REPLACE(@Sql, '@LogicalLogFileName', @LogicalLogFileName)
SET @Sql = REPLACE(@Sql, '@TargetLogFilePath', @TargetLogFilePath)
SELECT 'Restoring...', @Sql as ExecutedSql
EXEC (@Sql) 
```

# xquery - XQuery：从存储在查询变量中的字符串末尾删除换行符/返回字符

> ID：12485969
> 
> 赞同：0
> 
> 时间：2012-09-18T22:25:53.373
> 
> 标签：xquery, flwor, functx

如何从变量末尾删除换行符/返回？我试图`functx:substring-before-last`尝试删除新行（将其表示为`\r`，`\n`也表示为`\r\n`），但是当我输出该变量的值时，换行符仍在其中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T22:58:01.143

您可以使用[`fn:normalize-space($arg as xs:string?)`](http://www.w3.org/TR/xpath-functions/#func-normalize-space)删除所有额外的空格：

> 摘要：`$arg`通过去除前导和尾随空格并用单个空格替换一个或多个空格字符的序列，返回归一化空格的值`#x20`。

或者你可以只使用[`fn:replace(..)`](http://www.w3.org/TR/xpath-functions/#func-replace)一个正则表达式：

```
fn:replace($string, '(\r?\n|\r)$', '') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T22:59:38.760

CR 和 NL 可以指定为`&#13;`和`&#10;`。以下正则表达式将从您的输入字符串中删除所有尾随换行符：

```
replace($string, '(&#xd;?&#xa;)*$', '') 
```

如果要规范化字符串的所有空格，`normalize-string`是另一个更具可读性的选项：

```
normalize-space($string) 
```

# c# - 以编程方式更改 WPF Datagrid Cell 的内容

> ID：12485970
> 
> 赞同：0
> 
> 时间：2012-09-18T22:26:02.323
> 
> 标签：c#, .net, wpf, wpfdatagrid

我有一个 WPF DataGrid（.NET 框架 4），它从 myObject 的数组中获取它的 ItemsSource。myObject 的列/变量之一是 DateTime。有没有办法更改 DataGrid 行的绘图事件，以便我可以在该列的单元格中显示除每个对象的 DateTime 之外的其他内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T22:28:59.150

设置`AutoGenerateColumns`为 False，并使用`DataGridTextColumn`DataGridTemplateColumn 等手动定义列。

* * *

**使用事件进行**编辑**`AutoGeneratingColumn`，您可以通过添加以下内容来修改列的输出`IValueConverter`：**

 **```
 void MyGrid_AutoGeneratingColumn(object sender, DataGridAutoGeneratingColumnEventArgs e)
    {
        // check if the current column is the target
        if (e.PropertyName == "MyDateproperty")
        {
            // assuming it's a Text-type column
            var column = (e.Column as DataGridTextColumn);
            if (column != null)
            {
                var binding = column.Binding as Binding;
                if (binding != null)
                {
                    // add a converter to the binding
                    binding.Converter = new StringFormatConverter();
                }
            }
        }
    } 
```

现在，`StringFormatConverter`以通常的方式定义，将日期/时间值转换为：

```
public class StringFormatConverter: IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var col = (DateTime?)value;
        return (col == null) ? null : col.Value.ToShortDateString();
    }
    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```**

# r - 在 R 中使用 facet_grid 单独突出显示数据

> ID：12485979
> 
> 赞同：6
> 
> 时间：2012-09-18T22:27:06.770
> 
> 标签：r, ggplot2, facet

我在 R 中使用 facet_grid 绘制 5 个不同组的 RT 数据。我想强调每组 5% 到 95% 之间的数据。

使用下面的代码，我使用的是整个数据框的百分位数，而不是每个组的百分位数。关于我如何仍然使用 facet_grid 并在图中突出显示每个组的唯一百分位数的任何想法。

```
rect <- data.frame (xmin=quantile(ss$RT, c(0.05)), 
                    xmax=quantile(ss$RT, c(0.95)), 
                    ymin=-Inf, ymax=Inf)

qplot(prevRT, RT, group=ss, color = prim, 
      geom = c("smooth"), 
      method="lm", data =ss) + 
   facet_grid(~ Groupe) + 
   geom_rect(data=rect, 
             aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), 
             color="grey20", alpha=0.5, inherit.aes = FALSE) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T17:36:20.693

感谢 DWin 的建议，我使用**ave**分别为每个组查找 xmin 和 xmax，并将其直接合并到绘图命令中。

可能有一种更优雅的方式来做到这一点（欢迎提出建议），但它确实有效。

```
qplot(prevRT, RT, group=ss, color = prim, 
 geom = c("smooth"), 
 method="lm", data =ss) + 
 facet_grid(~ Groupe) + 
 geom_rect(data=ss, 
      aes(xmin=ave(ss$RT, ss$Groupe, FUN = function(x)quantile(x,c(0.05))),      
      xmax=ave(ss$RT, ss$Groupe, FUN = function(x)quantile(x,c(0.95))),
      ymin=-Inf,ymax=Inf), color="green", alpha=1/280, inherit.aes = FALSE) 
```

![在此处输入图像描述](../Images/6ace4adae629387b66fc5aa41ddbdd94.png)

# javascript - jquery replaceWith 没有响应点击调用

> ID：12485980
> 
> 赞同：1
> 
> 时间：2012-09-18T22:27:09.437
> 
> 标签：javascript, jquery, html, replacewith

所以我有一个浮动的 div，我想用 jQuery 替换它的内容。在这里，我以 Bing 和 Google 徽标为例，但尽管检查了文档，但似乎无法找出问题所在。我注意到其他人在用标签替换旧内容之前遇到了问题，但这并没有奏效。问题是因为嵌套的 div，还是...？

```
<style>
#content {
  float: right;
  width: 650px;
  overflow-x: hidden;
  color:fff;
}

#contentWrapper {
  position: relative;
}

#explainWrapper1 {
  float:left;
  width:350px;
  }
</style>

<script>
$('#amd1').click(function () {
             $('#content').replaceWith('<img src="http://www.google.com/images/srpr/logo3w.png">');
            });
            </script>

...

<a href="#" id="amd1">Amendment 1</a>
            <div id="contentWrapper">
                <div id="content">
      <img src="http://www.smartinsights.com/wp-content/uploads/2012/07/bing-logo.png">
    </div>
<div id="explainWrapper1">
</div></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T22:30:09.720

您应该将代码放在文档就绪处理程序中：

```
$(document).ready(function(){
   $('#amd1').click(function () {
      $('#content').replaceWith('<img src="http://www.google.com/images/srpr/logo3w.png">');
   });
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T22:28:53.427

请粘贴您的完整 html bruv，问题似乎在其他地方：

**工作演示** [http://jsfiddle.net/3L37W/](http://jsfiddle.net/3L37W/)

**代码**

```
$('#amd1').click(function () {
             $('#content').replaceWith('<img src="http://www.google.com/images/srpr/logo3w.png">');
            });​ 
```

# vim - 使用 argdo 打开多个文件时，vim 中未打开语法突出显示

> ID：12485981
> 
> 赞同：9
> 
> 时间：2012-09-18T22:27:11.627
> 
> 标签：vim

我经常从 MacVim 中一次打开整套文件。为此，我通常使用以下命令：

```
args *PATTERN*
argdo tabedit 
```

这会将工作目录中与模式匹配的所有文件加载到参数列表中，然后在单独的选项卡中打开它们。当我这样做时，语法突出显示不会自动打开，我必须手动设置它。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-19T09:25:23.763

我已经在类似问题中[发布了解决方法](https://stackoverflow.com/a/10515142/813602)；`:bufdo`这是一个扩展版本，也可以处理您的用例。解决自动设置的问题`'eventignore'`非常棘手，因此对其进行了充分评论：

```
" Enable syntax highlighting when buffers are displayed in a window through
" :argdo and :bufdo, which disable the Syntax autocmd event to speed up
" processing.
augroup EnableSyntaxHighlighting
    " Filetype processing does happen, so we can detect a buffer initially
    " loaded during :argdo / :bufdo through a set filetype, but missing
    " b:current_syntax. Also don't do this when the user explicitly turned off
    " syntax highlighting via :syntax off.
    " The following autocmd is triggered twice:
    " 1\. During the :...do iteration, where it is inactive, because
    " 'eventignore' includes "Syntax". This speeds up the iteration itself.
    " 2\. After the iteration, when the user re-enters a buffer / window that was
    " loaded during the iteration. Here is becomes active and enables syntax
    " highlighting. Since that is done buffer after buffer, the delay doesn't
    " matter so much.
    " Note: When the :...do command itself edits the window (e.g. :argdo
    " tabedit), the BufWinEnter event won't fire and enable the syntax when the
    " window is re-visited. We need to hook into WinEnter, too. Note that for
    " :argdo split, each window only gets syntax highlighting as it is entered.
    " Alternatively, we could directly activate the normally effectless :syntax
    " enable through :set eventignore-=Syntax, but that would also cause the
    " slowdown during the iteration Vim wants to avoid.
    " Note: Must allow nesting of autocmds so that the :syntax enable triggers
    " the ColorScheme event. Otherwise, some highlighting groups may not be
    " restored properly.
    autocmd! BufWinEnter,WinEnter * nested if exists('syntax_on') && ! exists('b:current_syntax') && ! empty(&l:filetype) && index(split(&eventignore, ','), 'Syntax') == -1 | syntax enable | endif

    " The above does not handle reloading via :bufdo edit!, because the
    " b:current_syntax variable is not cleared by that. During the :bufdo,
    " 'eventignore' contains "Syntax", so this can be used to detect this
    " situation when the file is re-read into the buffer. Due to the
    " 'eventignore', an immediate :syntax enable is ignored, but by clearing
    " b:current_syntax, the above handler will do this when the reloaded buffer
    " is displayed in a window again.
    autocmd! BufRead * if exists('syntax_on') && exists('b:current_syntax') && ! empty(&l:filetype) && index(split(&eventignore, ','), 'Syntax') != -1 | unlet! b:current_syntax | endif
augroup END 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-19T01:38:08.400

像这样的东西应该工作：

```
:argdo set eventignore-=Syntax | tabedit 
```

`Syntax`从`eventignore`设置中删除。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T23:32:58.867

`argdo`添加`Syntax`到`'eventignore'`设置中（请参阅`:h argdo`）。这意味着您没有对这些文件进行任何突出显示，因为不会为该缓冲区触发语法自动命令事件。这使它看起来像`'filetype'`没有被设置。这不是真的。您可以通过执行来检查`:set ft?`。您可以运行`:syntax on`以重新启用语法突出显示。但这并不是真正可取的，而且感觉很笨拙。

可能更好的方法是让自己摆脱使用制表符，而是使用缓冲区和相关的缓冲区命令。Arglist 相关的缓冲区命令是：`:next`、、、和。您可以打开特定文件或在新拆分中打开缓冲区。`:previous``:first``:last``:b file.c``:sb file.c`

我意识到这是一颗难以下咽的药丸，当然有时您可能真的希望每个缓冲区都放在自己的标签页中。一旦你强迫自己更多地使用缓冲区，你会发现很少需要制表符。您可能想查看 Drew Neil关于[如何使用选项卡的出色](http://vimcasts.org/episodes/how-to-use-tabs/)[Vimcast](http://vimcasts.org/)。我还建议使用 Tim Pope 的[unimpaired.vim](https://github.com/tpope/vim-unimpaired)来更轻松地在参数列表中移动。

如果您真的必须在自己的选项卡中使用每个文件，`:argdo tabe`那么您可能应该在它后面加上一个`:syntax on`或`:tabdo doautocmd Syntax`

如需更多帮助，请参阅：

```
:h :argdo
:h arglist
:h buffers
:h :b
:h :sb
:h :next
:h :tabdo
:h :doa
:h Syntax
:h :syn-on 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T22:36:34.573

我不熟悉，`args`或者`argdo`如果您需要在不同的选项卡中打开与模式匹配的文件，您可以使用以下内容：

```
:next *
:tab ball 
```

`:next *`使用正确的语法突出显示打开所有匹配该模式的文件，但是`:tab ball`打开内存中的所有文件，如果您有不需要在选项卡中打开的缓冲区，这可能是一个问题。

# neo4j - Neo4JClient - 如何将节点添加到索引

> ID：12485986
> 
> 赞同：2
> 
> 时间：2012-09-18T22:27:42.183
> 
> 标签：neo4j, neo4jclient

我需要一个非常简单的示例，说明如何使用 Neo4JClient 将节点添加到索引

在以下 C# 代码中，我创建了一个索引和一个员工节点。

**问题：**
在下面的代码中，如何将创建的节点添加到索引中？解决方案应允许搜索 EmployeeID 或 Name。

```
    课堂节目
    {
        静态无效主要（字符串 [] 参数）
        {
            //连接到 Neo4J
            var graphClient = new GraphClient(new Uri(@"http://localhost:7474/db/data"));
            graphClient.Connect();

            //创建索引
            graphClient.CreateIndex("employee", new IndexConfiguration() { Provider = IndexProvider.lucene, Type = IndexType.exact }, IndexFor.Node);

            //创建一个员工节点
            var employee = new Employee() { EmployeeID = "12345", Name = "Mike"};
            NodeReference employeeRef = graphClient.Create(employee);

            //将刚刚创建的节点添加到Employee索引中。  

        }

```

```
        私人类雇员
        {
            [JsonProperty("EmployeeID")]
            公共字符串 EmployeeID { 获取；放; }

            [JsonProperty("名称")]
            公开

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T00:08:36.623

**注意：**此答案适用于 Neo4jClient 1.0.0.474。确保您已更新。

创建节点时，您可以提供索引条目：

```
var employeeRef = graphClient.Create(
    employee,
    new IRelationshipAllowingParticipantNode<Employee>[0],
    new []
    {
        new IndexEntry("employee")
        {
            {"EmployeeID", 1234 },
            { "Name", "Mike" }
        }
    }
); 
```

由于以下几个原因，它看起来有点冗长：

1.  如果没有至少一个关系，您几乎永远不会创建节点。这些关系将在第二个参数中很好地叠加。

2.  一个节点可以在多个索引中结束，并且键和值不必与该节点匹配。

我们想让这个语法更适合默认场景，但还没有做到。

更新节点时，您还需要提供新的索引条目：

```
graphClient.Update(employeeRef,
    e =>
    {
        e.Name = "Bob";
    },
    e => new[]
    {
        new IndexEntry("employee") { { "Name", e.Name } }
    }); 
```

您可以重新索引节点而不使用更新节点本身`graphClient.ReIndex`。

如果要将现有节点添加到索引而不更新它，也可以使用`graphClient.ReIndex`。（该方法不对节点已经在索引中做出任何假设。）

# ffmpeg - 在 CentOS 上安装 ffmpeg-php

> ID：12485991
> 
> 赞同：5
> 
> 时间：2012-09-18T22:28:08.110
> 
> 标签：ffmpeg, ffmpeg-php

我正在尝试在服务器（CentOS）上安装 ffmpeg-php，但在“make”命令之后，我得到一个错误：

```
 from /usr/local/src/ffmpeg-php-0.6.0/ffmpeg-php.c:40:
  /usr/include/bits/stat.h:91: error: field 'st_atim' has incomplete type
  /usr/include/bits/stat.h:92: error: field 'st_mtim' has incomplete type
  /usr/include/bits/stat.h:93: error: field 'st_ctim' has incomplete type
  In file included from /usr/local/include/php/main/php_streams.h:28,
             from /usr/local/include/php/main/php.h:400,
             from /usr/local/src/ffmpeg-php-0.6.0/ffmpeg-php.c:40:
  /usr/include/sys/stat.h:367: error: array type has incomplete element type
  /usr/include/sys/stat.h:374: error: array type has incomplete element type
  In file included from /usr/local/include/php/main/php.h:406,
             from /usr/local/src/ffmpeg-php-0.6.0/ffmpeg-php.c:40:

/usr/local/include/php/TSRM/tsrm_virtual_cwd.h:218: error: expected specifier-qualifier-list before 'time_t'
/usr/local/include/php/TSRM/tsrm_virtual_cwd.h:246: error: expected declaration specifiers or '...' before 'time_t'
/usr/local/src/ffmpeg-php-0.6.0/ffmpeg-php.c: In function 'zm_startup_ffmpeg':
/usr/local/src/ffmpeg-php-0.6.0/ffmpeg-php.c:94: warning: implicit declaration of function 'avcodec_init'
make: *** [ffmpeg-php.lo] Error 1 
```

ffmpeg 以及 mplayer 和 mencoder 安装成功。

ffpeg：

```
 configuration: --enable-gpl --enable-libmp3lame --enable-libtheora --enable-libvo-aacenc --enable-libvorbis --enable-libvpx --enable-libx264 --enable-version3
 libavutil      51\. 73.101 / 51\. 73.101
 libavcodec     54\. 56.100 / 54\. 56.100
 libavformat    54\. 27.101 / 54\. 27.101
 libavdevice    54\.  2.100 / 54\.  2.100
 libavfilter     3\. 16.104 /  3\. 16.104
 libswscale      2\.  1.101 /  2\.  1.101
 libswresample   0\. 15.100 /  0\. 15.100
 libpostproc    52\.  0.100 / 52\.  0.100 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T02:42:03.857

听起来 ffmpeg-php 不适用于较新的 libavcodec，它们将 avcodec_init 替换为另一个函数，如果它的替换返回相同的内容，您可能可以重新编码一个调用。ffmpeg-php 好像很久没有更新了，但是你可能想试试 svn 的 HEAD 版本

[http://lists.mplayerhq.hu/pipermail/ffmpeg-devel/2012-April/123454.html](http://lists.mplayerhq.hu/pipermail/ffmpeg-devel/2012-April/123454.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-29T15:01:36.857

**安装FFmpeg的简单方法**

本教程将引导您在 CentOS 8、7、6 上安装 FFmpeg

1.  部署一个新的 CentOS 云服务器实例。
2.  登录到 root ssh 下载[Bitvise SSH 客户端](https://tutsfx.com/best-ssh-clients-for-windows-server-root-access-software/)

**在 CentOS 8 上安装 FFmpeg**

```
yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm
```

```
yum install https://download1.rpmfusion.org/free/el/rpmfusion-free-release-8.noarch.rpm https://download1.rpmfusion.org/nonfree/el/rpmfusion-nonfree-release-8.noarch.rpm
```

```
yum install http://rpmfind.net/linux/epel/7/x86_64/Packages/s/SDL2-2.0.10-1.el7.x86_64.rpm
```

```
yum install ffmpeg ffmpeg-devel -y
```

[在 CentOS 7 上安装 FFmpeg](https://tutsfx.com/how-install-ffmpeg-centos-8-vps-dedicated/)

# java - 等待 Netbeans 平台应用程序反序列化所有以前打开的窗口

> ID：12485995
> 
> 赞同：0
> 
> 时间：2012-09-18T22:28:22.977
> 
> 标签：java, netbeans, netbeans-7, rcp

我正在开发一个 Netbeans 平台应用程序并面临以下问题：关闭我的应用程序时，打开的窗口 A 和 B 仍然存在。重新打开我的应用程序后，窗口会被一一反序列化。先A后B。很有可能在重新打开窗口A的过程中我收到了窗口B的新信息。此时程序逻辑决定是打开新窗口B还是使用现有窗口。但由于窗口 B 尚不存在，它会打开一个新窗口。之后通过反序列化打开“旧”窗口 B。

有没有办法等到所有窗户都打开？我可以延迟打开其他窗户，直到所有窗户都打开。

我在[Windows 系统 API](http://bits.netbeans.org/dev/javadoc/org-openide-windows/org/openide/windows/doc-files/api.html)或 WindowManager 类中什么也没找到。

还有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T17:29:56.993

13浏览0回答，我们需要更多的netbeans平台开发者！

```
 WindowManager.getDefault().addWindowSystemListener(new WindowSystemListener() {

        @Override
        public void beforeLoad(WindowSystemEvent wse) {
        }

        @Override
        public void afterLoad(WindowSystemEvent wse) {
            // at this point all windows are opened
        }

        @Override
        public void beforeSave(WindowSystemEvent wse) {
        }

        @Override
        public void afterSave(WindowSystemEvent wse) {
        }
    }); 
```