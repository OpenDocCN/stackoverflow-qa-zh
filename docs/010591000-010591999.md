# StackOverflow 问答 10591000-10591999

# python - 在 Pandas csv 阅读器中指定数据类型

> ID：10591000
> 
> 赞同：71
> 
> 时间：2012-05-14T21:01:58.680
> 
> 标签：python, pandas

我刚刚开始使用 Pandas，我正在使用该[`read_csv()`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html)方法读取 csv 文件。我遇到的困难是阻止熊猫将我的电话号码转换为大数字，而不是将它们保存为字符串。我定义了一个转换器，它只留下数字，但它们仍然转换为数字。当我将转换器更改为在电话号码前加上“z”时，它们就保持不变。有没有办法在不修改字段值的情况下保留它们的字符串？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2013-08-29T01:22:23.857

从 Pandas 0.11.0 开始，您可以使用 dtype 参数显式指定每列的数据类型：

```
d = pandas.read_csv('foo.csv', dtype={'BAR': 'S10'}) 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-05-28T08:16:28.780

看起来您无法避免 pandas 尝试转换 CSV 文件中的数字/布尔值。查看用于 IO 解析器的 pandas 的源代码，特别是函数`_convert_to_ndarrays`和`_convert_types`. [https://github.com/pydata/pandas/blob/master/pandas/io/parsers.py](https://github.com/pydata/pandas/blob/master/pandas/io/parsers.py)

阅读文件*后，*您始终可以分配所需的类型：

```
df.phone = df.phone.astype(str) 
```

# java - 计算文本文件中从 A 点到 B 点的行数

> ID：10591002
> 
> 赞同：0
> 
> 时间：2012-05-14T21:02:09.263
> 
> 标签：java, loops, io, count, text-files

我试图弄清楚如何在给定的文本文件中找到字符串的第一个实例，开始计算从第一行开始的行数与该字符串的实例，然后在找到另一个/不同的字符串时停止计数一条新线。

基本上我有一个文本文件，如：

```
CREATE PROCEDURE "dba".check_diff(a smallint,
                             b       int, 
                             c       int,
                             d  smallint,
                             e smallint,
                             f   smallint,
                             g   smallint,
                             h     smallint,
                             i    smallint)

RETURNING int;
DEFINE p_ret int;
LET p_ret = 0;

END IF;

RETURN p_ret;

END PROCEDURE; 
```

我只想找到“CREATE PROCEDURE”的第一个实例并增加一个变量，直到我到达“END PROCEDURE;”的实例，然后重置变量。

我一直在尝试的是...

```
import java.io.*;

public class countFile 
{
    public static void main(String args[])
    {
      try
      {
          int i = 0;
          // Open the file that is the first 
          // command line parameter
          FileInputStream fstream = new FileInputStream("C:/results.txt");
          // Stream to write file
          FileOutputStream fout = new FileOutputStream("C:/count_results.txt");     
          // Get the object of DataInputStream
          DataInputStream in = new DataInputStream(fstream);
          BufferedReader br = new BufferedReader(new InputStreamReader(in));
          String strLine;
          //Read File Line By Line
          while ((strLine = br.readLine()) != null)   
          {
              if (strLine.contains("CREATE PROCEDURE"))
              {
                  while (!strLine.contains("END PROCEDURE;"))
                  {
                      i++;
                      break;
                  }
                  new PrintStream(fout).println (i);
              }
          }
          //Close the input stream
          in.close();
          fout.close();
      }
      catch (Exception e)
      {
          //Catch exception if any
          System.err.println("Error: " + e.getMessage());
      }
    }
} 
```

但是，这只是计算“CREATE PROCEDURE”实例的总数，并在每次递增时写出变量 i ......不是我要找的。

有什么帮助吗？

**找到的解决方案**：

```
import java.io.*;

public class countFile 
{
    public static void main(String args[])
    {
      try
      {
          int i = 0;
          boolean isInProcedure = false;
          // Open the file that is the first 
          // command line parameter
          FileInputStream fstream = new FileInputStream("C:/results.txt");
          // Stream to write file
          FileOutputStream fout = new FileOutputStream("C:/count_results.txt");     
          // Get the object of DataInputStream
          DataInputStream in = new DataInputStream(fstream);
          BufferedReader br = new BufferedReader(new InputStreamReader(in));
          String strLine;
          // Read File Line By Line
          while ((strLine = br.readLine()) != null)   
          {
              // If the line contains create procedure...
              if (strLine.contains("CREATE PROCEDURE")) 
              {
                  // Set this flag to true
                  isInProcedure = true;
              }
              // If the line contains end procedure, stop counting...
              if (strLine.contains("END PROCEDURE;")) 
              {
                 // Write to the new file
                 new PrintStream(fout).println(i);
                 // Set flag to false
                 isInProcedure = false;
                 // Reset counter
                 i = 0;
              }
              // Used to count lines between create procedure and end procedure
              else
              {
                  if (isInProcedure == true)
                  {
                      //Increment the counter for each line
                      i++;
                  }
              }
          }
          //Close the input stream
          in.close();
          fout.close();
      }
      catch (Exception e)
      {
          //Catch exception if any
          System.err.println("Error: " + e.getMessage());
      }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:13:05.000

尝试这个：

```
while (br.ready()) {
   if (br.readLine().contains("CREATE PROCEDURE")) {
      while (!br.readLine().contains("END PROCEDURE;")) {
         i++;
      }
    }
    new PrintStream(fout).println(i);
    i = 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:09:42.973

```
import java.io.BufferedReader;
import java.io.FileReader;

public class Test
{
    public static void main( String args[] )
    {
        try
        {
            BufferedReader bufferedReader = new BufferedReader( new FileReader( "c:\\test.txt" ) );

            String line;
            Boolean count = false;
            Integer lines = 0;

            while ( ( line = bufferedReader.readLine() ) != null )
            {
                if ( line.toUpperCase().contains( "CREATE PROCEDURE" ) )
                {
                    count = true;
                }

                if ( line.toUpperCase().contains( "END PROCEDURE;" ) )
                {
                    break;
                }

                if ( count == true )
                {
                    lines++;
                }
            }

            System.out.println( lines );
        }
        catch ( Exception exception )
        {
            exception.printStackTrace();
        }
    }
} 
```

# java - 如何使用 Hibernate 映射 byte[] 属性？

> ID：10591004
> 
> 赞同：8
> 
> 时间：2012-05-14T21:02:12.097
> 
> 标签：java, string, hibernate, encoding, sha1

我正在使用 Hibernate/Java 将实体持久保存到数据库中。该实体有一个*密码*字段，它是一个**String**。在我的应用程序中注册用户时，我使用 SHA-1 对密码进行哈希处理（我承认这有点弱）。这会产生一个**byte[]** ，然后我将 其转换为**String**`new String(byte[] arr);` 每当我想登录用户时，我只需从数据库中检索散列密码（作为**String**）并将其与登录时输入密码的摘要进行比较 `hashedPasswordFromDatabase.equals(SHA1_HASH(inputPassword));`

**这**在我的开发系统（Windows 7、JDK 1.6.0_23 / JDK 1.7、MySQL 5.5、Tomcat 6.0.26）上运行良好，但是在我们的服务器上部署它（在 Linux 上运行 JDK 1.6）时，*equals*方法甚至永远不会评估为 TRUE对于相同的密码。我快速设置了一个新的开发系统（Ubuntu 12.04、MySQL 5.5、JDK 1.7.0_03、Tomcat 7.0.22），但它也不能在那里工作。

我知道**String**类的 Java API 文档中说明的可能的编码问题，并且在 SO 的几个地方也有说明。我尝试了这个论坛上建议的几种编码（例如 Base64、Latin-1），最终得到了**UnsupportedEncodingException**。我想我最好避免字符串转换。那么如何设计我的数据库，以便 Hibernate 生成的实体类为*密码字段提供***byte[]**而不是**String**？

 **** * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T21:08:11.070

是的，问题很可能在于`byte[]`转换`String`。您必须知道 SHA 会产生原始`byte`数组，并且不保证任意`byte[]`会产生 valid `String`，而与编码无关。因此，您的代码只是*偶然地*工作。

通过以下方式完全避免该问题：

*   在 BLOB 中存储 raw `byte[]`- 最安全和最有效的存储方式。在 Hibernate 中，只需`byte[]`在您的 POJO 上使用属性。

*   `byte[]`使用[base64](/questions/tagged/base64 "显示标记为“base64”的问题")进行编码（查看[Decode Base64 data in Java](https://stackoverflow.com/questions/469695)）并将其存储为字符串。

顺便说一句[，记得加盐](http://en.wikipedia.org/wiki/Salt_(cryptography))！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T14:21:41.313

就我而言，糟糕的数据库设计促使我在 Clob 的情况下使用 Blob。解决方案是使用 Lob 注释将属性映射到休眠状态，并将另一个属性放入 String 类型。

在其他级别的代码中，当我调用 get 或 set 时，我使用 String 属性和这个属性，获取或设置字节数组值。

```
@Entity
@Table(name = "CMUN_TAGS")
@SequenceGenerator(name = "idSeqTag", sequenceName = "SEQ_CMUN_TAGS")
public class CmunTagsDO implements java.io.Serializable {
  private BigDecimal lngIdTag;
  private byte[] blobValTag;
  private String strValTag;

  @Id
  @Column(name = "LNG_ID_TAG", unique = true, nullable = false, precision = 20, scale = 0)
  @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "idSeqTag")
  public BigDecimal getLngIdTag() {
    return this.lngIdTag;
  }

  public void setLngIdTag(BigDecimal lngIdTag) {
    this.lngIdTag = lngIdTag;
  }

  @Column(name = "BLOB_VAL_TAG", nullable = false)
  @Lob
  public byte[] getBlobValTag() {
    return this.blobValTag;
  }

  public void setBlobValTag(byte[] blobValTag) {
    this.blobValorTag = blobValorTag;
  }

  @Transient
  public String getStrValTag() {
    strValTag = new String(getBlobValTag());
    return strValTag;
  }

  public void setStrValTag(String strValTag) {
    setBlobValTag(strValTag.getBytes());
    this.strValTag = strValTag;
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T21:10:55.017

您可以将字节转换为十六进制表示，如下所示：

```
public String encryptPassword(String passwordInClear) {
            // Salt all you want here.
            MessageDigest sha256 = MessageDigest.getInstance("SHA-256");
    byte[] digest = sha256.digest(passwordInClear.getBytes());
    return digestToString(digest);
}

private String digestToString(byte[] digest) {
    StringBuilder hashString = new StringBuilder();
    for (int i = 0; i < digest.length; i++) {
        String hex = Integer.toHexString(digest[i]);
        if (hex.length() == 1) {
            hashString.append('0');
            hashString.append(hex.charAt(hex.length() - 1));
        } else {
            hashString.append(hex.substring(hex.length() - 2));
        }
    }
    return hashString.toString();
} 
```***

# c# - 从 IQueryable 中删除 OrderBy

> ID：10591010
> 
> 赞同：12
> 
> 时间：2012-05-14T21:02:28.687
> 
> 标签：c#, .net, linq, linq-to-sql, iqueryable

我有一个分页 API，它返回用户请求的行，但一次只能返回这么多行，而不是整个集合。API 按设计工作，但我必须计算可用记录的总数（用于正确的页面计算）。在 API 中，我使用 Linq2Sql，并且在我最终提出请求之前，我使用 IQueryable 做了很多工作。当我去计数时，我会调用类似：totalRecordCount = queryable.Count();

生成的 SQL 仍然很有趣，但它也添加了不必要的 Order By，这使得查询非常昂贵。

```
exec sp_executesql N'SELECT COUNT(*) AS [value]
FROM (
    SELECT TOP (1) NULL AS [EMPTY]
    FROM [dbo].[JournalEventsView] AS [t0]
    WHERE [t0].[DataOwnerID] = @p0
    ORDER BY [t0].[DataTimeStamp] DESC
    ) AS [t1]',N'@p0 int',@p0=1 
```

因为我使用的是 IQueryable，所以我可以在 IQueryable 进入 SQL 服务器之前对其进行操作。

我的问题是，如果我已经有一个带有 OrderBy 的 IQueryable，是否可以在调用 Count() 之前删除该 OrderBy？

比如：totalRecordCount = 可查询。**NoOrder** .Count();

如果没有，没什么大不了的。我看到很多关于如何 OrderBy 的问题，但没有任何涉及从 Linq 表达式中删除 OrderBy 的问题。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T23:41:30.953

因此，下面的代码是针对内存数组的尖峰。使用 Entity Framework（或其他一些任意的 IQueryProvider 实现）可能会遇到一些障碍。基本上，我们要做的是访问表达式树并查找任何 Ordering 方法调用，然后将其从树中删除。希望这能为您指明正确的方向。

```
class Program
{
    static void Main(string[] args)
    {
        var seq = new[] { 1, 3, 5, 7, 9, 2, 4, 6, 8 };

        var query = seq.OrderBy(x => x);

        Console.WriteLine("Print out in reverse order.");
        foreach (var item in query)
        {
            Console.WriteLine(item);
        }

        Console.WriteLine("Prints out in original order");
        var queryExpression = seq.AsQueryable().OrderBy(x => x).ThenByDescending(x => x).Expression;

        var queryDelegate = Expression.Lambda<Func<IEnumerable<int>>>(new OrderByRemover().Visit(queryExpression)).Compile();

        foreach (var item in queryDelegate())
        {
            Console.WriteLine(item);
        }

        Console.ReadLine();
    }
}

public class OrderByRemover : ExpressionVisitor
{
    protected override Expression VisitMethodCall(MethodCallExpression node)
    {
        if (node.Method.DeclaringType != typeof(Enumerable) && node.Method.DeclaringType != typeof(Queryable))
            return base.VisitMethodCall(node);

        if (node.Method.Name != "OrderBy" && node.Method.Name != "OrderByDescending" && node.Method.Name != "ThenBy" && node.Method.Name != "ThenByDescending")
            return base.VisitMethodCall(node);

        //eliminate the method call from the expression tree by returning the object of the call.
        return base.Visit(node.Arguments[0]);
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-14T21:05:39.613

不仅有一个不需要的 ORDER BY，还有一个虚假的 TOP(1)。

```
SELECT TOP (1) NULL AS [EMPTY] ... 
```

该子选择将仅返回 0 或 1 行。事实上，如果没有 TOP，在子选择中使用 ORDER BY 是不合法的。

> ORDER BY 子句在视图、内联函数、派生表、子查询和公用表表达式中无效，除非还指定了 TOP 或 FOR XML。：SELECT COUNT(*) FROM (SELECT * FROM Table1 ORDER BY foo)

[sqlfiddle](http://sqlfiddle.com/#!3/a2c7d/1)

我认为您可能在 LINQ 中做错了什么。`.Take(1)`在致电之前，您确定您没有在查询中的某处写过或类似的信息`.Count()`吗？

这是错误的：

```
IQueryable<Foo> foo = (...).OrderBy(x => x.Foo).Take(1);
int count = foo.Count(); 
```

你应该这样做：

```
IQueryable<Foo> foo = (...);
Iqueryable<Foo> topOne = foo.OrderBy(x => x.Foo).Take(1);
int count = foo.Count(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T21:24:30.393

恐怕没有简单的方法可以`OrderBy`从可查询中删除运算符。

但是，您可以做的是`IQueryable`根据从重写`queryable.Expression`（[参见此处](http://msdn.microsoft.com/en-us/library/system.linq.iqueryable.aspx)）获得的新表达式重新创建省略`OrderBy`调用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-14T21:16:34.910

如果您无法消除根本原因，这里有一个解决方法：

```
totalRecordCount = queryable.OrderBy(x => 0).Count(); 
```

SQL Server 的查询优化器将删除这种无用的排序。它不会有运行时成本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T21:55:50.233

我认为您错误地实现了分页代码。您实际上需要查询数据库两次，一次用于分页数据源，一次用于总行数。这就是设置的外观。

```
public IList<MyObj> GetPagedData(string filter, string sort, int skip, int take)
{
   using(var db = new DataContext())
   {
      var q = GetDataInternal(db);
      if(!String.IsNullOrEmpty(filter))
         q = q.Where(filter); //Using Dynamic linq

      if(!String.IsNullOrEmpty(sort))
         q = q.OrderBy(sort); //And here

      return q.Skip(skip).Take(take).ToList();
   }
}

public int GetTotalCount(string filter)
{
    using(var db = new DataContext())
    {
       var q = GetDataInternal(db);
       if(!String.IsNullOrEmpty(filter))
         q = q.Where(filter); //Using Dynamic linq

       return q.Count(); //Without ordering and paging.
    }
}

private static IQuerable<MyObj> GetDataInternal(DataContext db)
{
   return 
        from x in db.JournalEventsView 
        where ...
        select new ...;
} 
```

过滤和排序是使用[动态 linq 库完成的](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-15T01:32:46.537

我知道这不是您要查找的内容，但是包含 DataTimeStamp 的 [DataOwnerID] 上的索引可以使您的查询成本更低。

# c# - 这个日期可以自动转换吗？

> ID：10591011
> 
> 赞同：2
> 
> 时间：2012-05-14T21:02:29.310
> 
> 标签：c#, .net, parsing, datetime, date

我知道 C# 有一些很棒的日期转换工具。我想知道是否可以自动将此字符串转换为日期对象：

```
"Fri May 11 00:00:00 EDT 2012" 
```

我想我必须手动解析月、日和年，但我希望有一种更简单的内置方法。任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T21:07:27.653

您可以使用[`DateTime.ParseExact`](http://msdn.microsoft.com/en-us/library/system.datetime.parseexact.aspx)或[`DateTime.TryPraseExact`](http://msdn.microsoft.com/en-us/library/system.datetime.tryparseexact.aspx)提供自定义格式：

```
DateTime result;
if (!DateTime.TryParseExact(
        "Fri May 11 00:00:00 EDT 2012", 
        "ddd MMM dd HH:mm:ss EDT yyyy", 
        CultureInfo.InvariantCulture, 
        DateTimeStyles.None, 
        out result)) {
    // handle invalid date
} 
```

所有格式选项都列在 MSDN 上的[自定义日期和时间格式字符串](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)页面上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T21:06:10.917

[http://msdn.microsoft.com/en-us/library/xhz1w05e.aspx](http://msdn.microsoft.com/en-us/library/xhz1w05e.aspx)

看看那个。应该能帮到你。

例子：

```
 // Convert a string returned by DateTime.ToString("R").
      String dateString = "Sat, 10 May 2008 14:32:17 GMT";
      ConvertToDateTime(dateString); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T21:06:54.317

是的，您可以将字符串解析为 DateTime 对象：

```
String format = "ddd MMM dd hh:mm:ss EDT yyyy";
String dateString = "Fri May 11 00:00:00 EDT 2012";
DateTime result = DateTime.ParseExact(dateString, format, CultureInfo.InvariantCulture); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T21:10:45.050

`Convert.ToDateTime("Fri May 11 00:00:00 EDT 2012")`应该可以正常工作。

# asp.net - 显示 div 几秒钟后使用 asp.net 代码消失

> ID：10591013
> 
> 赞同：-1
> 
> 时间：2012-05-14T21:02:54.157
> 
> 标签：asp.net

```
protected void Page_Load(object sender, EventArgs e)
        {
            if(!Page.IsPostBack)
                divStatus.Visible = true;
                Page.ClientScript.RegisterStartupScript(this.GetType(), "somekey", "function autoHide(){ setTimeout(function() {document.getlementById('" + divStatus.ClientID + "').style.display='none';},5000);};", true); 
        }

  <form id="form1" runat="server">
    <div>
    <div class="success" id="divStatus" runat="server" visible="false" >sssssssssssssssss</div>

    </div>
    </form> 
```

我需要添加什么才能在几秒钟后自行淡出？目前我正在显示 div，但用户必须明确单击才能关闭 div，有没有办法使用 asp.net 自行关闭 div？

是的，我知道如果您提供计时器，它确实适用于淡入淡出和淡出，但它不适用于后面的 asp.net 代码。

//html:

```
 <div class="success" id="divStatus" runat="server" visible="false" ></div> 
```

//后面的代码：

```
protected void lnkbtn_add_Click(object sender, EventArgs e)
{
       ........//more code for deleting
       if (deleted)
       {
           divStatus.visible = true;
       }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:14:17.307

> 是的，我知道如果您提供计时器，它确实适用于淡入淡出和淡出，但它不适用于背后的 asp.net 代码。

没有区别。ASP.NET 控件呈现为常规 html 控件。我的预感是您没有使用正确的客户端 ID。你有两个选择：

*   在您的标记中添加 ClientIDMode="static"，如下所示：

    ```
    <div clientidmode="static" class="success" id="divStatus" runat="server" visible="false" ></div> 
    ```

然后添加javascript函数自动隐藏div：

```
function autoHide()
{  //hide after 5 seconds
   setTimeout(function(){document.getlementById('divStatus').style.display='none';},5000);
} 
```

*   只需使用`<%=divStatus.ClientID%>`来获取最终在页面上呈现的客户端 ID，如下所示：

    ```
    function autoHide() {  //hide after 5 seconds   
      setTimeout(function() {document.getlementById('<%=divStatus.ClientID%>').style.display='none';},5000);
    } 
    ```

从代码隐藏中，您可以简单地调用：

```
 ........//more code for deleting
Page.ClientScript.RegisterStartupScript(this.GetType(),"somekey","autoHide();",false); 
```

**更新**

如果您甚至想`autoHide`在后面的代码中定义函数，请执行以下操作（请注意，`true`在这种情况下，最后一个参数是，而不是`false`前面的示例）：

```
 ........//more code for deleting
string script = @"document.getElementById('" + divStatus.ClientID + "').innerHTML='You are done!' ;setTimeout(function(){document.getElementById('" + divStatus.ClientID + "').style.display='none';},5000);";
Page.ClientScript.RegisterStartupScript(this.GetType(), "somekey", script, true); 
```

# jquery - 多种尺寸使用 Ryan Fait 的 jQuery 样式脚本的元素我是一个完全的 java 新手，我自己几乎可以做 nil。我想知道如何修改 Ryan Fait 的输入样式 jQuery 以允许 2 种不同类型的元素。这是他非常有用的代码的链接：http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/ 基本上它工作得非常顺利，但我不知道如何做两种不同的尺寸（一个大，一个小的，因此也具有不同的背景图像）的菜单。提前致

> ID：10591017
> 
> 赞同：0
> 
> 时间：2012-05-14T21:03:04.407
> 
> 标签：jquery, css, select, input

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:48:49.553

您遇到的问题是元素的大小在源代码中是硬编码的，这是代码编写方式的不幸副作用。虽然您可以对源代码进行大量更改以使其接受多种样式，但最好*只使用 CSS*和一些额外的 HTML。

如果您的 HTML 如下所示：

```
<label for="first">Specially styled select box</label>
<div class="styled-select">
    <select name="first">
        <option>Here is the first option</option>
        <option>The second option</option>
    </select>
</div>

<label for="first">Specially styled select box, with massive text</label>
<div class="styled-select">
    <select name="second" class="massive">
        <option>Here is the first option</option>
        <option>The second option</option>
    </select>
</div>
​ 
```

您的样式表可能如下所示：

```
.styled-select {
    width: 240px;
    height: 34px;
    overflow: hidden;
    background: url(http://cdn.bavotasan.com/wp-content/uploads/2011/05/down_arrow_select.jpg) no-repeat right #DDD;
}
.styled-select select {
    background: transparent;
    width: 268px;
    padding: 5px;
    border: 1px solid #CCC;
    font-size: 16px;
    height: 34px;
    -webkit-appearance: none;
    -webkit-border-radius: 3px;
    border-radius: 3px;
}

select.massive {
    font-size: 24px;
    padding-top: 1px;
    padding-right: 55px;
    padding-bottom: 0;
} 
```

[使用这个 jsfiddle](http://jsfiddle.net/PjmHy/8/)查看它的实际效果。

（来源：[bavotsan.com](http://bavotasan.com/2011/style-select-box-using-only-css/)）

# php - 使用 htmlspecialchars() 只转义单引号（不理会双引号）

> ID：10591027
> 
> 赞同：7
> 
> 时间：2012-05-14T21:03:39.000
> 
> 标签：php, escaping, htmlspecialchars

我知道还有其他方法可以只转义单引号（[例如这个答案](https://stackoverflow.com/questions/6269188/how-to-escape-only-single-quotes)），但在我看来应该有一种使用[htmlspecialchars()](http://php.net/manual/en/function.htmlspecialchars.php)的方法。

根据手册，应该是它们常量的某种组合，但根据他们的解释，我看不到。

是否可以只转义单引号，而单独留下双引号`htmlspecialchars()`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-14T21:11:37.950

```
str_replace("'", "\\'", $string); 
```

那里。

或者，使用`ENT_QUOTES`

```
htmlspecialchars($string, ENT_QUOTES); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-18T09:42:49.130

这是您正在寻找的常量组合。

```
$escaped_string = htmlspecialchars($string, ENT_QUOTES & ~ENT_COMPAT, $encoding); 
```

这将逃脱`& ' < >`，但`"`独自离开。`ENT_QUOTES & ~ENT_COMPAT`是位操作语言，意思是“*双引号，减去双引号*”。

这是因为这些常量是如何定义的。[php-src/ext/标准/html.h](https://github.com/php/php-src/blob/master/ext/standard/html.h)

```
#define ENT_HTML_QUOTE_NONE         0
#define ENT_HTML_QUOTE_SINGLE       1
#define ENT_HTML_QUOTE_DOUBLE       2

#define ENT_COMPAT      ENT_HTML_QUOTE_DOUBLE
#define ENT_QUOTES      (ENT_HTML_QUOTE_DOUBLE | ENT_HTML_QUOTE_SINGLE)
#define ENT_NOQUOTES    ENT_HTML_QUOTE_NONE 
```

为什么你想转义单引号，而不是双引号？好吧，与您转义双引号而不是单引号的原因相反：因为您有一个包含很多`"`双引号而只有几个`'`单引号的字符串，所以您想将其粘贴在`'`-delimited细绳。

一个例子：

```
<div data-myobject='<?= htmlspecialchars(json_encode($myobject), ENT_QUOTES & ~ENT_COMPAT, 'UTF-8') ?>' 
```

`json_encode()`创建大量双引号，因此将结果粘贴在单引号分隔的属性中并保持双引号未转义是有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T21:11:14.390

使用 htmlspecialchars(...)

然后在双引号上加上 str_replace(...)

# .htaccess - .htaccess 重定向到子目录而不更改 url

> ID：10591029
> 
> 赞同：1
> 
> 时间：2012-05-14T21:03:45.170
> 
> 标签：.htaccess, redirect, subdirectory

我有网站

www.site.com

我想从 /en 子目录中读取根目录

无需将网址更改为

地址栏上的 www.site.com/en

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:35:04.677

将它放在根目录的 .htaccess 文件中应该可以解决问题，当然前提是已安装并启用了 mod_rewrite，并且在 conf 文件的 VirtualHost 中设置了 AllowOverride All。它不会改变地址栏。

```
RewriteEngine On
RewriteRule ^(.*)$ en/$1 [L, NC, QSA] 
```

# ruby-on-rails - Sass::Engine.render 没有导入蓝图库……为什么？

> ID：10591030
> 
> 赞同：2
> 
> 时间：2012-05-14T21:03:48.187
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, sass, blueprint-css

我正在尝试使用[`Sass::Engine.new`](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#using_sass). 我遇到了一个问题，我不知道如何让它允许`@import GEMMIFIED_SASS_MODULE`。例如，这就是我正在尝试的：

```
?> sass = "@import \"blueprint/reset\"\nh1\n  width: 100%"
=> "@import \"blueprint/reset\"\nh1\n  width: 100%"
>> puts sass # For readable version
@import "blueprint/reset"
h1
  width: 100%
=> nil
>> Sass::Engine.new(sass, :syntax => :sass).render
Sass::SyntaxError: File to import not found or unreadable: blueprint/reset.
Load path: /Users/username/projects/my_app
        from (sass):1
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/import_node.rb:64:in `rescue in import'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/import_node.rb:42:in `import'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/import_node.rb:25:in `imported_file'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/perform.rb:149:in `rescue in visit_import'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/perform.rb:154:in `visit_import'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/base.rb:37:in `visit'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/perform.rb:18:in `visit'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/base.rb:53:in `block in visit_children'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/base.rb:53:in `map'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/base.rb:53:in `visit_children'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/perform.rb:27:in `block in visit_children'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/perform.rb:39:in `with_environment'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/perform.rb:26:in `visit_children'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/base.rb:37:in `block in visit'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/perform.rb:47:in `visit_root'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/base.rb:37:in `visit'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/perform.rb:18:in `visit'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/visitors/perform.rb:7:in `visit'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/tree/root_node.rb:20:in `render'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/engine.rb:299:in `_render'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/sass-3.1.15/lib/sass/engine.rb:246:in `render'
        from (irb):30
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/railties-3.2.3/lib/rails/commands/console.rb:47:in `start'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/railties-3.2.3/lib/rails/commands/console.rb:8:in `start'
        from /Users/username/.rvm/gems/ruby-1.9.2-p290@my_app/gems/railties-3.2.3/lib/rails/commands.rb:41:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>' 
```

当我将一些 sass 放入文件并`@import blueprint/reset`在顶部使用时，这样做没有问题，它能够在开发模式和 via 中即时编译为 CSS `rake assets:precompile`。但是我有一个新的用例，我需要自己渲染一些并且遇到了这个问题。在尝试渲染它之前，我尝试添加`require 'compass'`,`require 'compass-rails'`和`require 'compass/rails'`，但它不起作用。需要工作（因为它说`true`或在需要文件之后），但在我的通话`false`中似乎仍然不可用。`Sass::Engine.new().render`

在我的 Gemfile 中，我有：

```
gem 'haml-rails'
gem 'sass-rails'
gem 'compass-rails' 
```

任何人都知道在使用 Sass::Engine 时我可以做些什么来使库可见？[我在参考](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#using_sass)或[文档](http://sass-lang.com/docs/yardoc/Sass/Engine.html)中找不到任何内容

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T11:38:30.120

您没有提供蓝图的路径，SASS 找不到它。

Compass 是为解决此问题而创建的工具。它提供了一个可以直接导入而无需提供路径的扩展生态系统。

你正试图用普通的 SASS 来做到这一点。要解决此问题，您必须让 SASS 熟悉 Compass 扩展的存储位置：

```
# Allowing vanilla SASS use Compass extensions
Compass.sass_engine_options[:load_paths].each do |path|
  Sass.load_paths << path
end 
```

# java - 如何为 Spring 3 / Hibernate 4 LocalSessionFactoryBean 设置事件侦听器？

> ID：10591033
> 
> 赞同：6
> 
> 时间：2012-05-14T21:04:09.560
> 
> 标签：java, spring, hibernate, dependency-injection

我正在使用 Spring 3.1.0.RELEASE 和 Hibernate 4.0.1.Final。如何为我的 SessionFactory 设置事件监听器？最终，我试图在这个线程之后将 bean 注入 Hibernate 实体——[通过 Spring 将字段注入 Hibernate 加载的实体中](https://stackoverflow.com/questions/3505421/injecting-fields-via-spring-into-entities-loaded-by-hibernate)。但是，这是失败的，但有以下例外。我的配置文件看起来像

```
<bean class="org.springframework.orm.hibernate4.LocalSessionFactoryBean" id="sessionFactory">
    <!-- <property name="configLocation"> <value>classpath:hibernate.cfg.xml</value> 
        </property> -->
    <property name="dataSource" ref="dataSource" />
    <property name="annotatedClasses">
        <list>
            <value>com.myco.myproject.domain.Registration</value>
            <value>com.myco.myproject.domain.Role</value>
            <value>com.myco.myproject.domain.EventFeed</value>
            <value>com.myco.myproject.domain.Event</value>
            <value>com.myco.myproject.domain.Address</value>
            <value>com.myco.myproject.domain.Category</value>
        </list>
    </property>
    <property name="hibernateProperties">
        <props>
            <prop key="show_sql">true</prop>
            <prop key="dialect">org.hibernate.dialect.MySQLDialect</prop>
        </props>
    </property>
    <property name="eventListeners">
        <map>
            <entry key="post-load">
                <bean class="com.myco.myproject.listeners.myprojectLoadListener"></bean>
            </entry>
        </map>
    </property>
</bean> 
```

这是令人讨厌的例外...

```
java.lang.IllegalStateException: Failed to load ApplicationContext
    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:157)
    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:109)
    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:75)
    at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:321)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:211)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:288)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:290)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'searchEventsController': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.myco.myproject.services.EventService com.myco.myproject.controllers.SearchEventsController.eventService; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'eventService': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.myco.myproject.dao.EventFeedsDao com.myco.myproject.services.EventServiceImpl.eventFeedsDao; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'eventFeedsDao': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.hibernate.SessionFactory com.myco.myproject.dao.EventFeedsDaoImpl.sessionFactory; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in URL [file:src/test/resources/testApplicationContext.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property 'eventListeners' of bean class [org.springframework.orm.hibernate4.LocalSessionFactoryBean]: Bean property 'eventListeners' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:103)
    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:1)
    at org.springframework.test.context.support.DelegatingSmartContextLoader.loadContext(DelegatingSmartContextLoader.java:228)
    at org.springframework.test.context.TestContext.loadApplicationContext(TestContext.java:124)
    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:148)
    ... 24 more
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.myco.myproject.services.EventService com.myco.myproject.controllers.SearchEventsController.eventService; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'eventService': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.myco.myproject.dao.EventFeedsDao com.myco.myproject.services.EventServiceImpl.eventFeedsDao; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'eventFeedsDao': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.hibernate.SessionFactory com.myco.myproject.dao.EventFeedsDaoImpl.sessionFactory; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in URL [file:src/test/resources/testApplicationContext.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property 'eventListeners' of bean class [org.springframework.orm.hibernate4.LocalSessionFactoryBean]: Bean property 'eventListeners' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
    ... 39 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'eventService': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.myco.myproject.dao.EventFeedsDao com.myco.myproject.services.EventServiceImpl.eventFeedsDao; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'eventFeedsDao': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.hibernate.SessionFactory com.myco.myproject.dao.EventFeedsDaoImpl.sessionFactory; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in URL [file:src/test/resources/testApplicationContext.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property 'eventListeners' of bean class [org.springframework.orm.hibernate4.LocalSessionFactoryBean]: Bean property 'eventListeners' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:790)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
    ... 41 more
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private com.myco.myproject.dao.EventFeedsDao com.myco.myproject.services.EventServiceImpl.eventFeedsDao; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'eventFeedsDao': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.hibernate.SessionFactory com.myco.myproject.dao.EventFeedsDaoImpl.sessionFactory; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in URL [file:src/test/resources/testApplicationContext.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property 'eventListeners' of bean class [org.springframework.orm.hibernate4.LocalSessionFactoryBean]: Bean property 'eventListeners' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
    ... 52 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'eventFeedsDao': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.hibernate.SessionFactory com.myco.myproject.dao.EventFeedsDaoImpl.sessionFactory; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in URL [file:src/test/resources/testApplicationContext.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property 'eventListeners' of bean class [org.springframework.orm.hibernate4.LocalSessionFactoryBean]: Bean property 'eventListeners' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:790)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
    ... 54 more
Caused by: org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.hibernate.SessionFactory com.myco.myproject.dao.EventFeedsDaoImpl.sessionFactory; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in URL [file:src/test/resources/testApplicationContext.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property 'eventListeners' of bean class [org.springframework.orm.hibernate4.LocalSessionFactoryBean]: Bean property 'eventListeners' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:506)
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:284)
    ... 65 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in URL [file:src/test/resources/testApplicationContext.xml]: Error setting property values; nested exception is org.springframework.beans.NotWritablePropertyException: Invalid property 'eventListeners' of bean class [org.springframework.orm.hibernate4.LocalSessionFactoryBean]: Bean property 'eventListeners' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1396)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1118)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:790)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
    ... 67 more
Caused by: org.springframework.beans.NotWritablePropertyException: Invalid property 'eventListeners' of bean class [org.springframework.orm.hibernate4.LocalSessionFactoryBean]: Bean property 'eventListeners' is not writable or has an invalid setter method. Does the parameter type of the setter match the return type of the getter?
    at org.springframework.beans.BeanWrapperImpl.setPropertyValue(BeanWrapperImpl.java:1064)
    at org.springframework.beans.BeanWrapperImpl.setPropertyValue(BeanWrapperImpl.java:924)
    at org.springframework.beans.AbstractPropertyAccessor.setPropertyValues(AbstractPropertyAccessor.java:76)
    at org.springframework.beans.AbstractPropertyAccessor.setPropertyValues(AbstractPropertyAccessor.java:58)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1393)
    ... 78 more 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T11:52:03.907

Hibernate4 改变了 EventListeners 的注册方式，不再为 EventListeners 映射提供 setter。有不同的解决方案来处理这个问题，看看这个线程：

[使用休眠 4.0 和 spring 3.1.0.release 的事件监听器？](https://stackoverflow.com/questions/8616146/eventlisteners-using-hibernate-4-0-with-spring-3-1-0-release)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-20T19:28:21.470

我知道这是一个老问题，但我写了一个小库，可以很容易地注册事件监听器：

[https://github.com/carmanconsulting/hibiscus](https://github.com/carmanconsulting/hibiscus)

# c# - .net 3.5 windows 窗体应用程序，使用网络摄像头

> ID：10591036
> 
> 赞同：0
> 
> 时间：2012-05-14T21:04:12.937
> 
> 标签：c#, windows, winforms, webcam

在搜索了网络摄像头的原生 c# 挂钩后，我发现了 5 种与摄像头交互的基本方式。

1.  Windows 视频 (VFW)
2.  DirectX
3.  `avicap32.dll`
4.  威亚
5.  第三者工具

我的要求是拍照。该应用程序将在一些旧版 Windows XP 和 Vista 机器上使用，但需要 Windows 7 及更高版本。那么对于广泛的安装基础来说，最好的方法是什么？只是阅读 WIA 看起来像是要走的路，但看起来做了一些改变，所以现在它的工作方式有点不同（我不确定）。我知道有些人做过组合。

可能需要裁剪照片，但仅此而已。

用于学校访客监控。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T09:13:56.173

我认为最好的办法是使用 WIA。我知道一个第三方工具包可以帮助你满足你的要求，那就是leadtools。您可以查看本[教程](http://www.leadtools.com/help/leadtools/v175/dh/to/leadtools.topics.wia~wa.topics.wiaacquiringanimage.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:23:55.307

我总是会尝试在网上找到一些已经在网上的东西，然后根据自己的需要进行调整……一些开源项目或我的应用程序的主要部分已经制作好的示例。

在 Codeplex 上，你可以找到一个很好的库来处理网络摄像头，它被简单地称为

> [带有 C# 和 VB.NET 的 WinForm 和 WPF 网络摄像头库](http://easywebcam.codeplex.com/)

试试看，也许你甚至可以通过贡献你自己的发现来帮助这个项目，每个人都是赢家......开源不是一个好主意吗？！

# javascript - 除了数据绑定，backbone.js（或knockout.js）有什么优势

> ID：10591041
> 
> 赞同：2
> 
> 时间：2012-05-14T21:04:23.983
> 
> 标签：javascript, backbone.js, knockout.js, javascript-framework, javascript-databinding

我们在网站上使用的 JavaScript 代码库的结构非常好（如果有人感兴趣，请[在此处列出）。](https://stackoverflow.com/questions/8916337/managing-javascript-complexity-in-a-large-project)

我一直在考虑将backbone.js（或针对某些功能的knockout.js）集成到我们的代码中——但经过仔细考虑，我认为我不太关心数据绑定（我的应用程序不做密集型客户端） <->服务器数据交换，它更偏向于服务器->客户端->js数据管道），所以我真的不在乎我是否没有动态数据绑定和同步。

由于我对这些库不是很熟悉，我担心通过选择不使用这些库，我会错过一些其他非常有用的功能。我是吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T21:16:28.513

如果我正在构建一个完整的单页网络应用程序，我个人会使用主干。如果您的网站主要是 HTML，但使用 JS 来实现一些次要的附加功能，我不会担心。Backbone 擅长处理客户端数据模型并将更改绑定到这些模型以查看更新。

就个人而言，我使用过敲除，发现它对 HTML 中的数据绑定的依赖令人困惑。这对我来说效果不佳。构建部分动态的网站可能更友好一些，因为很多逻辑都直接进入 html 视图层。您可能想收听最近的播客采访淘汰赛的创建者，因为它可能会阐明一些事情。[http://javascriptjabber.com/](http://javascriptjabber.com/)

就我而言，在构建一个包含一些动态元素的大型网站时，我一直坚持使用一些全局 jQuery 插件和页面特定 JS 的模式。它适用于对特定页面的简单添加。

我不知道这个问题是否非常具体，所以这是一个通用的答案:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-24T20:54:59.453

我首先要指出，虽然声明性数据绑定是 KnockoutJS 的关键特性，但它不是核心骨干框架的一部分。确实存在多个插件，例如（[Rivets.js](http://rivetsjs.com/)和[Orchestrator](http://lorefnon.github.com/Orchestrator)），它们在 Backbone JS 中提供此类功能。

现在来到您问题的主要方面 - 就数据绑定以外的优势而言，KnockoutJS 没有太多可提供的东西。但是，即使交互式数据绑定不是主要问题，您也绝对应该考虑使用 BackboneJS。原因是 Backbone 捆绑了客户端路由系统和一种简洁但最小的方法来管理从服务器获取的 javascript 数据。

正如您所提到的，您的应用程序是数据驱动的，您在客户端中获取的数据可能不是一次全部获取，而是增量更新。在这种情况下，拥有可观察的模型和集合可能会帮助您很好地管理您的应用内数据依赖关系（以及保持任何用于可视化数据同步的小部件。）

# sql - 如何编写SQL来选择每组中的最大值？

> ID：10591044
> 
> 赞同：1
> 
> 时间：2012-05-14T21:04:42.320
> 
> 标签：sql

假设我们有一个像这样的城市的州 (varchar)、城市 (varchar) 和人口 (int) 表，

```
New York, New York, 8175133
Los Angeles, California, 3792621
Chicago, Illinois, 2695598
San Diego, California, 1307402 
```

我想选择每个州人口最多的城市。结果是，

```
New York, New York, 8175133
Los Angeles, California, 3792621
Chicago, Illinois, 2695598 
```

如何编写 SQL 来做到这一点？

更新：

让我说清楚：结果应该包含每个人口最多的州一个城市。在上面的示例中，“圣地亚哥”的人口少于“洛杉矶”，因此它不会出现在结果中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T21:14:45.153

在极少数情况下，两个或多个城市的人口相同，两者都将显示：

```
SELECT 
    t.*
FROM 
    tableX  t
  JOIN
    ( SELECT State
           , MAX(Population) AS Population 
      FROM tableX
      GROUP BY State
    ) maxp  
        ON  maxp.State = t.State
        AND maxp.Population = t.Population 
```

* * *

如果您的 DBMS 具有分析（窗口）功能，您也可以使用它（与前面显示的关系）：

```
SELECT 
    City
  , State
  , Population
FROM 
    ( SELECT City
           , State
           , Population
           , RANK() OVER ( PARTITION BY State 
                           ORDER BY Population DESC )
               AS RankN
      FROM tableX
    ) maxp  
WHERE RankN = 1 ; 
```

或者这个（关系已解决，每个状态只返回一行）：

```
SELECT 
    City
  , State
  , Population
FROM 
    ( SELECT City
           , State
           , Population
           , ROW_NUMBER() OVER ( PARTITION BY State 
                                 ORDER BY Population DESC 
                                        , City ASC )
               AS RowN
      FROM tableX
    ) maxp  
WHERE RowN = 1 ; 
```

* * *

在[SQL-Fiddle中测试](http://sqlfiddle.com/#!3/f563c/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:57:03.067

```
select *
from pop 
where (state, population) in 
   (select state, max(population) 
    from pop 
    group by state); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T21:10:45.310

去做就对了：

```
SELECT state, city, MAX(population) AS LargestPeople FROM yourtable GROUP BY state DESC 
```

# groovy - 如何使用soapUI通过AMF请求向我发送png的字节数组？

> ID：10591045
> 
> 赞同：0
> 
> 时间：2012-05-14T21:04:50.477
> 
> 标签：groovy, bytearray, soapui, amf

我目前正在尝试使用soapUI 为我的API 创建负载测试，以发送Adobe 消息格式请求。我有一个需要 byte[] 数据类型的请求，但我对 Groovy 或 Java 几乎一无所知。

我已经将来自不同线程的信息拼凑在一起，我正在尝试按照“${byte[] contents = new File("C:/Users/jloiselle/Desktop/TestDragon.png") 的行创建一个属性扩展。 getBytes()}" 这显然不起作用。

任何人都可以帮助我或至少指出我正确的方向吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:27:52.513

您有获取文件字节的正确方法；

```
new File("C:/Users/jloiselle/Desktop/TestDragon.png").bytes 
```

您如何尝试将此数组发送到请求？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T13:49:34.997

再次查看soapUI 教程后，我意识到我试图错误地引用该属性。

解决方案如下：

在我的请求的脚本窗口中，我添加了：

* * *

def temp = new File("C:/Users/jloiselle/Desktop/TestDragon.png").bytes

参数['内容'] = temp

* * *

感谢您验证获取文件字节的语法。

# javascript - JavaScript window.opener 调用父函数

> ID：10591050
> 
> 赞同：16
> 
> 时间：2012-05-14T21:05:06.673
> 
> 标签：javascript, window.opener

我正在尝试从子窗口调用父级中定义的 javascript 函数。我有两个这样的文件：

家长：

```
<html>
<head>
<title>Test</title>
<script type="text/javascript">
function foo () {
alert ("Hello from parent!");
}
function doStuff () {
var w = window.open("testa.html");
}
</script>
</head>
<body>
<input type="button" value="open" onClick="doStuff();" />
</body>
</html> 
```

和孩子：

```
<html>
<head>
<title>Test A</title>
<script type="text/javascript">
function get() {
window.opener.foo();
}
</script>
</head>
<body>
<input type="button" value="Call Parent" onClick="get();" />
</body>
</html> 
```

在我的一生中，我不能从子进程中调用函数 foo 。我认为 window.opener 对象应该可以做到这一点，但我似乎无法做到这一点。有什么建议么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-14T22:25:23.293

确保您通过 http:// 访问它，这样同源策略就会通过，您可以从孩子访问 opener。如果您只使用 file://，它将无法正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-03T15:43:55.157

回答拉胡尔的问题：

每个浏览器都可以从服务器或本地文件系统加载页面。要从本地文件系统加载文件，您应该将这样的地址放入浏览器`file://[path]`，其中 [path] 是文件系统中文件的绝对路径（包括 Windows 上的驱动器号，请参阅[http://blogs.msdn.com/b/即/archive/2006/12/06/file-uris-in-windows.aspx](http://blogs.msdn.com/b/ie/archive/2006/12/06/file-uris-in-windows.aspx)了解详细信息）。

要从本地 HTTP 服务器（如果有的话）加载文件，您应该使用类似这样的地址`http://localhost:[port]/[path]`，其中 [port] 是您的服务器正在运行的端口（默认为 80），而 [path] 是文件的相对路径到服务器的文档根文件夹。文档根文件夹取决于服务器配置。

因此，如您所见，同一个本地文件可以通过两种方式加载到浏览器中。然而，这两种方式之间存在很大差异。在第一种情况下，浏览器不使用 HTTP 协议来加载文件，因此缺少许多不同机制正常工作所必需的东西。例如 AJAX 不适用于本地文件，因为 HTTP 响应状态不是 200 等。

在这个特定的示例中，浏览器安全机制没有获取原始信息，并阻止访问父窗口。

# c++ - 构造函数 MyClass(QWidget *parent = 0) 中 (QWidget *parent = 0) 的含义；

> ID：10591059
> 
> 赞同：5
> 
> 时间：2012-05-14T21:05:51.853
> 
> 标签：c++, qt, constructor

只是 Qt 中常见结构化类的一部分：

```
class MyClass  :  public QWidget           
{

Q_OBJECT

 public:

   MyClass(QWidget *parent = 0);
.
.
.
} 
```

看构造函数看不懂参数的意思`(QWidget *parent = 0)`？这是什么意思？

问候

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-14T21:10:21.867

`MyClass(QWidget *parent = 0)`定义了一个可以采用`QWidget*`.

您可能会对此部分感到困惑，即[默认参数](http://msdn.microsoft.com/en-us/library/91563f79%28v=vs.100%29.aspx)`= 0`的 C++ 语法。默认参数允许您使用该函数而无需指定该特定参数。在这种情况下，您可以像这样调用此构造函数：

```
mc = MyClass(); 
```

这相当于调用：

```
mc = MyClass(0); // or MyClass(NULL) 
```

这意味着`MyClass`object 将没有 parent `QWidget`，因为`= 0`意味着 parent 是一个空指针。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T21:07:15.893

当你构造一个新的 MyClass 时，你给它一个指向你想成为新的父级的 QWidget 的指针。这`= 0`意味着如果您不提供参数，它将没有父级。或者，更严格地说，它的父指针将被设置为 NULL。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-04-28T07:17:07.127

**首先，在构造函数之后使用显式关键字很好**

```
explicit MyClass(QWidget *parent = 0 ); 
```

通过使用显式，这意味着您将无法进行隐式分配。

为了更好地理解让我们举个例子

假设您创建了一个 MyInteger 类，它在构造函数中接受一个整数。然后你可以写这样的东西：

```
MyInteger integer = 5; 
```

对于简单的类，这可以正常工作，但是当您有复杂的类时，隐式赋值可能会导致错误。因此最好有明确的分配：

```
MyInteger integer = MyInteger(5); 
```

这样你就可以确定一切都是正确的。是一种保障。

**语句“QWidget *parent = 0”怎么样！**

**那是做什么用的？**

您定义一个具有默认值的构造函数。这种情况下的默认值意味着没有父级。将 0 分配给指针（在这种情况下）

```
MyClass(QWidget *parent = 0) 
```

意味着您创建了一个指向任何内容的指针。在任何正常情况下，您都希望指针指向内存中的某个地址，例如父窗口小部件的地址。但是，例如，当您不想设置父小部件时，您可以不指向任何内容。请注意，尽管在使用指针时，请始终检查它是否确实指向某些东西（最好是正确的东西），或者不要对它做任何事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-14T21:11:09.017

这是一个**默认参数**。如果未提供参数，则使用提供的参数。

# performance - Python，迭代正则表达式但在第一次匹配时停止的最快方法

> ID：10591068
> 
> 赞同：15
> 
> 时间：2012-05-14T21:06:34.923
> 
> 标签：performance, python-3.x, python

我有一个函数，如果字符串与列表中的至少一个正则表达式匹配，则返回 True，否则返回 False。该函数经常被调用，以至于性能是一个问题。

当通过 cProfile 运行它时，该函数大约 65% 的时间用于匹配，35% 的时间用于遍历列表。

我认为会有一种使用 map() 或其他东西的方法，但我想不出一种方法让它在找到匹配项后停止迭代。

有没有办法让函数更快，同时在找到第一个匹配项时仍然返回？

```
def matches_pattern(str, patterns):
    for pattern in patterns:
        if pattern.match(str):
            return True
    return False 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-14T21:09:17.187

首先想到的是使用生成器表达式将循环推到 C 端：

```
def matches_pattern(s, patterns):
    return any(p.match(s) for p in patterns) 
```

可能您甚至不需要单独的功能。

您应该尝试的另一件事是使用交替运算符构建单个复合正则表达式`|`，以便引擎有机会为您优化它。如果有必要，您还可以从字符串模式列表动态创建正则表达式：

```
def matches_pattern(s, patterns):
    return re.match('|'.join('(?:%s)' % p for p in patterns), s) 
```

当然，您需要以字符串形式使用正则表达式才能使其正常工作。只需分析这两个并检查哪个更快:)

您可能还想查看[在 Python 中调试正则表达式的一般技巧](https://stackoverflow.com/a/143636/916657)。这也有助于找到优化的机会。

**更新：**我很好奇并写了一个小基准：

```
import timeit

setup = """
import re
patterns = [".*abc", "123.*", "ab.*", "foo.*bar", "11010.*", "1[^o]*"]*10
strings = ["asdabc", "123awd2", "abasdae23", "fooasdabar", "111", "11010100101", "xxxx", "eeeeee", "dddddddddddddd", "ffffff"]*10
compiled_patterns = list(map(re.compile, patterns))

def matches_pattern(str, patterns):
    for pattern in patterns:
        if pattern.match(str):
            return True
    return False

def test0():
    for s in strings:
        matches_pattern(s, compiled_patterns)

def test1():
    for s in strings:
        any(p.match(s) for p in compiled_patterns)

def test2():
    for s in strings:
        re.match('|'.join('(?:%s)' % p for p in patterns), s)

def test3():
    r = re.compile('|'.join('(?:%s)' % p for p in patterns))
    for s in strings:
        r.match(s)
"""

import sys
print(timeit.timeit("test0()", setup=setup, number=1000))
print(timeit.timeit("test1()", setup=setup, number=1000))
print(timeit.timeit("test2()", setup=setup, number=1000))
print(timeit.timeit("test3()", setup=setup, number=1000)) 
```

我机器上的输出：

```
1.4120500087738037
1.662621021270752
4.729579925537109
0.1489570140838623 
```

所以`any`似乎并不比你原来的方法快。动态构建正则表达式也不是很快。但是，如果您可以设法预先构建一个正则表达式并多次使用它，这可能会带来更好的性能。您还可以调整此基准来测试其他一些选项:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-14T21:08:38.277

最快的方法是将所有正则表达式组合成一个`"|"`，然后在它们之间进行一次正则表达式匹配调用。此外，您需要编译一次以确保避免重复的正则表达式编译。

例如：

```
def matches_pattern(s, pats):
    pat = "|".join("(%s)" % p for p in pats)
    return bool(re.match(pat, s)) 
```

这是`pats`作为字符串，而不是编译模式。如果你真的只编译过正则表达式，那么：

```
def matches_pattern(s, pats):
    pat = "|".join("(%s)" % p.pattern for p in pats)
    return bool(re.match(pat, s)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T15:59:30.590

除了上面的优秀答案之外，请确保将 re.match 的输出与 None 进行比较：

```
>>> timeit('None is None')
0.03676295280456543
>>> timeit('bool(None)')
0.1125330924987793
>>> timeit('re.match("a","abc") is None', 'import re')
1.0200879573822021
>>> timeit('bool(re.match("a","abc"))', 'import re')
1.134294033050537 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-14T20:54:19.620

这不完全是 OP 所要求的，但这对我来说作为长迭代匹配的替代方案很有效。

以下是一些示例数据和代码：

```
import random
import time
mylonglist = [ ''.join([ random.choice("ABCDE") for i in range(50)]) for j in range(3000) ]

# check uniqueness
print "uniqueness:"
print len(mylonglist) == len(set(mylonglist))

# subsample 1000
subsamp = [ mylonglist[x] for x in random.sample(xrange(3000),1000) ]
# join long string for matching
string = " ".join(subsamp)

# test function 1
def by_string_match(string, mylonglist):
    counter = 0
    t1 = time.time()
    for i in mylonglist:
        if i in string:
            counter += 1
    t2 = time.time()
    print "It took {} seconds to find {} items".format(t2-t1,counter)

# test function 2
def by_iterative_match(subsamp, mylonglist):
    counter = 0
    t1 = time.time()
    for i in mylonglist:
        if any([ i in s for s in subsamp ]):
            counter += 1
    t2 = time.time()
    print "It took {} seconds to find {} items".format(t2-t1,counter)

# test 1:
print "string match:"
by_string_match(string, mylonglist)
# test 2:
print "iterative match:"
by_iterative_match(subsamp, mylonglist) 
```

# apache - 通过符号链接“未指定输入文件”

> ID：10591069
> 
> 赞同：2
> 
> 时间：2012-05-14T21:06:37.030
> 
> 标签：apache, .htaccess

我确实有两个网站。由于我只有一个 SSL 证书，我想将一个证书与证书一起用于访问另一个证书（例如，对于管理员）。我会考虑足够好，以便能够访问这样的文件：`https://site1.dom/site2.dom/`.

所以我做到`ln /home/site2/www/ /home/site1/www/site2.dom -s`了，并确保了这一点`+FollowSymLinks`。

不过，`No input specified`当我尝试访问`https://site1.dom/site2.dom/`或时收到一条消息`http://site1.dom/site2.dom/`。

这些目录由不同的 unix 用户拥有。大多数（如果不是全部）文件权限是`755`.

怎么了？-我问。提前致谢。

# objective-c - iPad：MFMailComposeViewController 与附件崩溃

> ID：10591071
> 
> 赞同：2
> 
> 时间：2012-05-14T21:06:46.623
> 
> 标签：objective-c, ios, xcode, cocoa-touch, ipad

我的应用程序包含一个表单，用户可以在其中选择一些 PDF 文件，然后将这些文件附加到电子邮件中。所有 PDF 文件都相对较小，介于 250 KB 和 1.0 MB 之间，但如果我在 iPad 3 上附加超过 4 个 PDF 文件（附加一两个似乎没问题），整个应用程序都会崩溃。它不会在模拟器中崩溃。

这是在使用 ARC 的 iOS 5.1 上运行的，所以不应该有泄漏。当我使用 Instruments 使用 Allocations 对其进行分析时，总字节数从 9.3 MB 变为 22.4 MB，这当然是一个峰值，但我认为这不会导致崩溃。

这是我的代码：

```
if ([MFMailComposeViewController canSendMail]) {
  MFMailComposeViewController *mail = [[MFMailComposeViewController alloc] init];
  mail.modalPresentationStyle = UIModalPresentationFormSheet;
  mail.mailComposeDelegate = self;
  [mail setSubject:subject];
  [mail setMessageBody:body isHTML:NO];

  for (NSString *document in documents) {
    @autoreleasepool {
      NSError *error;
      NSData *data = [NSData dataWithContentsOfFile:[[NSBundle mainBundle] pathForResource:document ofType:@"pdf"] options:NSDataReadingMappedIfSafe error:&error];
      if (error) {
        NSLog(@"Unresolved error loading document %@, %@", error, [error userInfo]);
      }
      [mail addAttachmentData:data mimeType:@"application/pdf" fileName:document];
      data = nil;
    }
  }

  [self presentModalViewController:mail animated:YES];
} 
```

# c# - webBrowser1 打开网页

> ID：10591078
> 
> 赞同：-1
> 
> 时间：2012-05-14T21:07:50.010
> 
> 标签：c#, winforms, browser

如何在 webBrowser1 中打开网页？

我在新窗口中添加了新的 webBrowser 组件，当我添加按钮时，这是此按钮上的代码：

```
 private void button1_Click(object sender, EventArgs e)
    {
        string URL = @"http://www.site.com/search?=N";
        this.webBrowser1.Url = new Uri(URL); 
        this.webBrowser1.Navigate("URL");
        this.webBrowser1.Refresh();

    } 
```

但它不起作用 - 没有报告错误，但 webBrowser1 在按下按钮后不显示任何数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:09:24.050

代替：

```
this.webBrowser1.Navigate("URL"); 
```

尝试：

```
this.webBrowser1.Navigate(URL); 
```

这样，您无需导航到站点`"URL"`（显然不存在），而是导航到 URL 变量指向的站点（即`http://www.site.com/search?=N`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:09:51.793

尽量不要加`URL`引号：

```
this.webBrowser1.Navigate(URL); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T21:10:26.623

您是否尝试过：

```
this.webBrowser1.Navigate(URL); 
```

# shell - shell 脚本头文件（#!/bin/sh vs #!/bin/csh）

> ID：10591086
> 
> 赞同：113
> 
> 时间：2012-05-14T21:08:22.403
> 
> 标签：shell, unix

为什么所有脚本文件都以

```
#!/bin/sh 
```

或与

```
#!/bin/csh 
```

这是必需的吗？这样做的目的是什么？两者有什么区别？

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2012-05-14T21:15:02.533

这被称为`Shebang`：

[http://en.wikipedia.org/wiki/Shebang_(Unix)](http://en.wikipedia.org/wiki/Shebang_%28Unix%29)

> #!interpreter [可选参数]

shebang 仅在脚本具有执行权限时才相关（例如 chmod u+x script.sh）。

当 shell 执行脚本时，它将使用指定的解释器。

例子：

```
#!/bin/bash
# file: foo.sh
echo 1

$ chmod u+x foo.sh
$ ./foo.sh
  1 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-05-14T21:51:44.677

该`#!`行告诉内核（特别是[`execve`](http://linux.die.net/man/2/execve)系统调用的实现）该程序是用解释语言编写的；后面的绝对路径名标识解释器。编译为机器代码的程序以不同的字节序列开头——在大多数现代 Unix 上，`7f 45 4c 46`( `^?ELF`) 将它们标识为这样。

您可以在之后放置*您想要的任何程序*的绝对路径`#!`，只要该程序本身不是`#!`脚本即可。内核重写了一个调用

```
./script arg1 arg2 arg3 ... 
```

where`./script`以 开头，`#! /usr/bin/perl`就好像命令行实际上是

```
/usr/bin/perl ./script arg1 arg2 arg3 
```

或者，如您所见，您可以使用`#! /bin/sh`编写一个旨在由`sh`.

*仅当您直接*调用脚本（在命令行上）时`#!`才会处理该行；该文件还必须是可执行的 ( )。如果您这样做，则不需要该行（如果存在则将被忽略），并且该文件不必是可执行的。该功能的*重点*是允许您直接调用解释语言程序，而不必知道它们是用什么语言编写的。（这样做——您会发现实际上有很多库存程序都在使用此功能。）*`./script``chmod +x script``sh ./script``#!`*`grep '^#!' /usr/bin/*`**

 **以下是使用此功能的一些规则：

*   `#!`必须是文件中的前两个*字节*。特别是，文件*必须*是 ASCII 兼容的编码（例如 UTF-8 可以工作，但 UTF-16 不行），并且*不能*以“字节顺序标记”开头，否则内核将无法将其识别为`#!`脚本。
*   后面的路径`#!`必须是绝对路径（以 开头`/`）。它不能包含空格、制表符或换行符。
*   `#!`在和之间放置一个空格是很好的风格，但不是必需的`/`。不要在那里放置多个空格。
*   您不能将 shell 变量放在`#!`行中，它们不会被扩展。
*   您可以在绝对路径之后放置*一个*命令行参数，并用一个空格将其隔开。与绝对路径一样，此参数不能包含空格、制表符或换行符。有时这是使事情正常工作所必需的（`#! /usr/bin/awk -f`），有时它只是有用的（`#! /usr/bin/perl -Tw`）。不幸的是，您不能在绝对路径之后放置*两个或更多参数。*
*   有些人会告诉你使用`#! /usr/bin/env interpreter`而不是`#! /absolute/path/to/interpreter`. **这几乎总是一个错误。**它使您的程序的行为取决于`$PATH`调用脚本的用户的变量。并不是所有`env`的系统都具备。
*   需要`setuid`或`setgid`特权的程序不能使用`#!`；它们必须被编译成机器码。（如果您不知道是什么`setuid`，请不要担心。）

关于`csh`，它与`sh`Nutrimat [Advanced Tea Substitute](http://everything2.com/title/Advanced+tea+substitute)对茶的作用大致相同。与交互式使用相比，它具有（或者更确切地说，现代实现`sh`已经赶上）许多优势`sh`，但是将它（或其后代`tcsh`）用于脚本[几乎总是一个错误](http://www.grymoire.com/Unix/CshTop10.txt)。如果您对 shell 脚本不熟悉，我强烈建议您忽略它并专注于`sh`. 如果您使用`csh`亲戚作为您的登录 shell，请切换到`bash`or `zsh`，以便交互式命令语言与您正在学习的脚本语言相同。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-14T21:13:23.813

这定义了您用于解释/运行脚本的 shell（命令解释器）。每个 shell 在与用户交互和执行脚本（程序）的方式上都略有不同。

当您在 Unix 提示符下键入命令时，您正在与 shell 交互。

例如，`#!/bin/csh`指的是 C-shell、`/bin/tcsh`t-shell、`/bin/bash`bash shell 等。

您可以知道您正在使用哪个交互式 shell

```
 echo $SHELL 
```

命令，或者

```
 env | grep -i shell 
```

您可以使用命令更改命令外壳`chsh`。

每个都有稍微不同的命令集和分配变量的方式以及它自己的一组编程结构。例如，带有 bash 的 if-else 语句看起来与 C-shell 中的不同。

[这个页面](http://joelinoff.com/blog/?page_id=235)可能很有趣，因为它在 bash 和 tcsh 命令/语法之间“转换”。

在 shell 脚本中使用该指令允许您使用不同的 shell 运行程序。例如，我以`tcsh`交互方式使用 shell，但经常使用脚本文件中的 /bin/bash 运行 bash 脚本。

在旁边：

这个概念也扩展到其他脚本。例如，如果你用 Python 编程，你会放

```
 #!/usr/bin/python 
```

在 Python 程序的顶部**

# ios - addSkipBackupAttributeToItemAtURL -> NSString 参数？

> ID：10591087
> 
> 赞同：0
> 
> 时间：2012-05-14T21:08:24.937
> 
> 标签：ios, nsstring, backup, icloud

为了遵循数据存储指南，我必须使用以下方法添加一个标志，表示不将其备份到 iCloud。但是，这里的参数是针对 NSURL 的。我需要像这样从一行中传递一个 NSString

```
return [[self offlineQueuePath] stringByAppendingPathComponent:@"SHKOfflineQueue.plist"]; 
```

这是接受 URL 的方法。

```
 - (BOOL)addSkipBackupAttributeToItemAtURL:(NSURL *)URL
{
    if (&NSURLIsExcludedFromBackupKey == nil) { // iOS <= 5.0.1
        const char* filePath = [[URL path] fileSystemRepresentation];

        const char* attrName = "com.apple.MobileBackup";
        u_int8_t attrValue = 1;

        int result = setxattr(filePath, attrName, &attrValue, sizeof(attrValue), 0, 0);
        return result == 0;
    } else { // iOS >= 5.1
        NSError *error = nil;
        [URL setResourceValue:[NSNumber numberWithBool:YES] forKey:NSURLIsExcludedFromBackupKey error:&error];
        return error == nil;
    }
} 
```

**无论如何，在将 NSString 作为参数的同时，我将如何修改上述方法以实现相同的效果？**

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:11:23.673

您不需要修改方法。将您的字符串转换为 URL。

```
NSURL *url = [NSURL URLWithString:@"your string"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-10T10:08:02.727

使用此方法

```
 NSURL *pathURL113= [NSURL fileURLWithPath:[NSString stringWithFormat:@"%@",Your string]]; 
```

这是完美的代码。

# sql-server-2008 - 如何使用不同的配置多次运行同一个 SSIS 包

> ID：10591091
> 
> 赞同：2
> 
> 时间：2012-05-14T21:08:38.903
> 
> 标签：sql-server-2008, ssis

由于这些令人敬畏[的“SQL Server 2008 R2 中集成服务功能的行为更改”](http://msdn.microsoft.com/en-us/library/bb500430%28v=sql.105%29.aspx)，SQL Server 2008 中有没有办法

1) 使用不同的配置多次运行同一个 SSIS 包

2) 同时仍然在 BIDS 的设计时启用配置以进行测试

基本上在 2005 年，我可以创建 SSIS 包，在 BIDS 中启用配置以进行测试，并在测试后将包部署到服务器并使用具有 3 种不同配置的 SQL 代理运行它 3 次。

我怎么能在 2008 年做到这一点，否则我必须在部署之前禁用 BIDS 中的配置？问题是如果开发人员忘记在 BIDS 中禁用它们，将始终使用设计时配置而不是指定的配置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T12:38:48.577

为什么你不能运行包 3 次？

只需使用 /config 运行 dtexec 并指定配置文件以从中提取值

或者您可以创建一个包含 3 个步骤的 sql 作业，并在每个步骤上运行相同的包，通知配置选项卡上的不同配置文件。

我真的没有看到问题。“包”和“配置文件”是两个不同的东西。在 BIDS 内部，如果你禁用配置并运行包，它当然不会读取任何配置文件，但如果你启用，它会从配置（文件或服务器或其他任何东西）中读取值并使用它们，即使你有包装上设置的不同值。

那么，为什么开发人员不能使用启用的配置并在配置文件上设置需要的值呢？

编辑：

我想你误会了。从您发布的页面：

> 1- 该实用程序首先应用设计时配置。

*   这意味着，读取配置文件中的配置

> 2 - 该实用程序随后会应用您在启动该实用程序时在命令行上指定的运行时选项。

-这意味着，例如使用 dtexec 上的 /set 选项设置变量值

> 3- 最后，实用程序重新加载并重新应用设计时配置。

这意味着，重新加载配置文件中的配置

这就是为什么您在 SQL Server 2008 中的多个地方阅读到，您不能使用 /Set 选项来覆盖也由配置设置的值。

这实际上并不意味着您不能，这意味着配置文件中的值将优先于命令行设置的任何值。

不用担心，在 BIDS 中设置的值不会覆盖您在配置文件中设置的值。

# machine-learning - weka AdaBoost 没有改善结果

> ID：10591092
> 
> 赞同：3
> 
> 时间：2012-05-14T21:08:43.020
> 
> 标签：machine-learning, data-mining, weka, bayesian, adaboost

在我的学士论文中，我应该在文本分类问题上使用 AdaBoostM1 和 MultinomialNaiveBayes 分类器。问题在于，在大多数情况下，M1 在没有提升的情况下比 MultinomialNaiveBayes 更差或相等。

我使用以下代码：

```
AdaBoostM1 m1 = new AdaBoostM1();
m1.setClassifier(new NaiveBayesMultinomial());
m1.buildClassifier(training); 
```

所以我不明白 AdaBoost 怎么不能改善结果？不幸的是，由于大多数人似乎对 AdaBoost 非常满意，我在网上找不到其他任何相关信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T01:47:20.310

AdaBoost 是一个二元/二分法/2 类分类器，旨在提升仅优于 1/2 精度的弱学习器。AdaBoostM1 是一个 M 类分类器，但仍然要求弱学习器的准确率优于 1/2，而人们预计机会水平约为 1/M。最初使用平衡/加权来获得相等的流行等级，但 AdaBoost 固有的重新加权可以迅速破坏这一点。一个解决方案是基于机会校正的措施，如 Kappa 或 Informedness (AdaBook)。

随着 M 的增长，例如文本分类，这种不匹配会增长，因此需要一个比机会强得多的分类器。因此，当 M=100 时，几率约为 1%，但 AdaBoostM1 需要 50% 的最低准确度。

随着基本分类器变得更强大（即不再勉强超越机会），提升以改进事物的范围缩小 - 它已经将我们拉到了搜索空间的一个非常特定的部分。它越来越有可能过度拟合错误和异常值，因此无法平衡各种变体。

一些关于知情的资源（包括 matlab 代码和 xls 表和早期论文）在这里：[http](http://david.wardpowers.info/BM) ://david.wardpowers.info/BM与其他机会校正 kappa 度量的比较在这里：[http ://aclweb.org /anthology-new/E/E12/E12-1035.pdf](http://aclweb.org/anthology-new/E/E12/E12-1035.pdf)

Adaboost 的 weka 实现和实验使用 Bookmaker 通知可用 - 联系作者。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-19T19:03:46.970

在文本分类上很难击败朴素贝叶斯。此外，boosting 是为具有高[偏差](http://www.aiaccess.net/English/Glossaries/GlosMod/e_gm_bias_variance.htm)的弱分类器设计的，这就是 boosting 表现良好的地方。提升会减少偏差但会增加方差。因此，如果您希望 AdaBoost + 朴素贝叶斯组合的性能优于朴素贝叶斯，您必须拥有一个大的训练数据集并跨越边界，其中训练集的扩大不会进一步提高朴素贝叶斯的性能（而 AdaBoost 仍然受益于扩大的训练数据集）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-26T07:08:59.600

您可能想阅读以下检查朴素贝叶斯提升的论文。它表明，在一组自然域中，boosting 不会像通常预期的那样提高朴素贝叶斯分类器的准确性：

[http://onlinelibrary.wiley.com/doi/10.1111/1467-8640.00219/abstract](http://onlinelibrary.wiley.com/doi/10.1111/1467-8640.00219/abstract)

希望它提供一个很好的见解。

# drupal - 在 Drupal 7 中，如果您关注一个群组，如何在群组更新内容时通知您？

> ID：10591096
> 
> 赞同：0
> 
> 时间：2012-05-14T21:08:44.877
> 
> 标签：drupal, notifications

我想构建这样的功能，允许用户关注其他用户，并且当被关注的人更新信息时，关注者可以获得他们正在做什么的通知。

我认为构建跟随功能，我可以使用标志模块，但对于通知，什么样的模块适合使用？我很困惑; 通知，消息传递等模块太多了，甚至nodejs模块都可以通知，有没有教程可以让我对此有所了解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T01:06:32.977

如果您需要关注用户或群组，您的描述有点不清楚。

如果您只是关注其他用户，那么您真正需要的只是 Flag 和[Notifications](http://dgo.to/notifications)。

如果您想在将任何新内容添加到组时通知用户，您将需要[OG Notifications](http://dgo.to/og_notifications)来执行此操作。从项目页面：

> 用户将能够订阅/取消订阅组中发布的所有新节点。并且将能够编辑他的订阅。

# facebook - 如何知道我的页面与谁共享

> ID：10591097
> 
> 赞同：0
> 
> 时间：2012-05-14T21:08:45.237
> 
> 标签：facebook, twitter, social-networking, facebook-social-plugins

我想创建一个 Facebook/Twitter 应用程序并使用 Facebook 的社交插件/Twitter API 让人们在 Facebook 上分享我的页面或在推特上发布相关信息。

有什么方法可以找出用户在 Twitter/Facebook 上与谁分享了我的页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T23:17:11.857

除非共享是使用您自己的应用程序完成的，并且您记录发布，否则无法知道

# backbone.js - Backbone.js 模型的 destroy 方法不会触发成功或错误事件

> ID：10591099
> 
> 赞同：7
> 
> 时间：2012-05-14T21:08:48.340
> 
> 标签：backbone.js, requirejs, mustache, backbone-events, js-amd

我开始学习 Backbone.js，我从[这个样板](https://github.com/thomasdavis/backboneboilerplate)开始，并通过从磁盘上的静态文件加载 JSON 数据并将其显示在 html 表中来制作示例。

然后我尝试在一个按钮上绑定一个事件，该按钮应该从集合中删除一个元素，然后从 DOM 中删除。事情正常，点击触发`destroy`方法，`remove`事件在集合上触发，但没有任何结果`success`或`error`回调`destroy`

有人有线索吗？

该模型 ：

```
define([
  'underscore',
  'backbone'
], function(_, Backbone) {
  var memberModel = Backbone.Model.extend({
    url: "/members.json",
    defaults: {
      email: "",
      firstname: "",
      lastname: "",
      gender: "",
      language: "",
      consent: false,
      guid: "",
      creationDate: ""
    },
    initialize: function(){
    }

  });

  return memberModel;

}); 
```

风景 ：

```
define([
  'jquery',
  'underscore',
  'backbone',
  'mustache',
  'collections/members',
  'text!templates/members/page.html'
], function($, _, Backbone, Mustache, membersCollection, membersPageTemplate){
  var membersPage = Backbone.View.extend({
    el: '.page',
    initialize: function(){
        this.members = new membersCollection();

        this.members.on('remove', function(){
                // works fine
            $('.members-body tr').first().remove();
            console.log('removed from collection');
        });
    },

    render: function () {
        var that = this;

        this.members.fetch({success: function(){

            var wrappedMembers = {"members" : that.members.toJSON()};

            that.$el.html(Mustache.render(membersPageTemplate, wrappedMembers));

            $('#delete-member').click(function(){
                that.members.at(0).destroy({ 
                        // prints nothing!!!
                    success: function(){ console.log('sucess'); }, 
                    error: function(){ console.log('error'); }
                });

            });

        }});

    }
  });
  return membersPage;
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T03:24:37.417

*我同意这很奇怪。我不完全确定发生了什么，但这是我怀疑的......*

您的`Destroy()`调用未返回有效的 JSON。

*   看萤火虫、提琴手或其他什么，你的 destroy() 响应是什么样的？
*   我也很好奇`that`您的删除单击功能何时被触发。
*   destroy 是否返回 false 或 jqXHR 对象？

骨干网有点脱节（至少一开始我是这样的）。当为此调用`destroy()`或获取/保存时，调用是异步的。调用后立即触发删除事件，您的集合可以响应。但是，在文档中深入挖掘，另一个事件被触发确认删除：

> **和**“同步”事件，**在**服务器成功确认模型删除后

因此，您的集合是在删除成功的假设下进行的。如果您希望您的收藏响应确认的删除，请查找该`sync`事件。

这留下了一个令人烦恼的问题——为什么你的错误处理程序没有触发？好吧，回调旨在响应删除的确认。但我敢打赌，JS 调用堆栈不知道如何将它返回的响应解释为成功或错误。您可能偶然发现了 AJAX 的现实。我在骨干网、jquery 和许多其他框架中发现，您可能会混淆 ajax 错误处理。谷歌“未调用 jquery ajax 错误”，您会发现许多未触发错误事件的不同场景。

* * *

**更新**

在来回评论之后……发生了两件事。首先，您的模型被认为是“新的”，这意味着`Destroy()`不发出服务器请求的调用。因此，您的成功/错误不会触发。请参阅[此提交](https://github.com/documentcloud/backbone/pull/232)。

话虽如此，我不认为你认为你的模型是新的（没有持久化到服务器上）。你需要做两件事之一。在您的模型中包含一个名为`id` **OR**的属性，将您的模型 ID（`guid`我假设）映射到模型的 ID。通过将以下行应用于您的模型，映射很容易：`idAttribute: "guid"`. 您可以在此处查看有关[idAttribute](http://documentcloud.github.com/backbone/#Model-idAttribute)的更多信息。

# matlab - Matlab - 当a是矩阵时find（x == a）

> ID：10591103
> 
> 赞同：0
> 
> 时间：2012-05-14T21:09:04.843
> 
> 标签：matlab, octave

我不知道该怎么做。我有一些具有重复值的矩阵，我想对它们进行排序并获得排序索引的矩阵。例如：

```
a = [1 4 3 10 8 2];
b = sort(a);

% This doesn't work but I wish it did - that's what I'm looking for.
% idx = find(a==b);  idx = [1 6 3 2 5 4];

[v idx] = ismember(b,a); 
```

但是，当存在重复值和 NaN 时，这会产生错误。试试这个：

```
a = [1 NaN 4 2 10 8 2];
b=sort(a);
[v, i] = ismember(b,a); 
```

给出 [1 7 7 3 6 5 0] 这是有效的，但我需要它是 [1 4 7 3 6 5 0]。

我可以稍后处理这个问题，但如果它返回上面的结果会更加优雅。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:12:11.913

`sort`有两个输出值版本，可以准确地为您提供您正在寻找的索引：

```
a = [1 4 3 10 8 2];
[b, idx] = sort(a); 
```

输出

```
idx =
     1     6     3     2     5     4 
```

这也适用于`NaN`s ：

```
a = [1 NaN 4 2 10 8 2];
[b, idx] =sort(a);
>> idx
idx =
     1     4     7     3     6     5     2
>> b
b =
     1     2     2     4     8    10   NaN 
```

# php - Ant 找不到 phpunit

> ID：10591105
> 
> 赞同：2
> 
> 时间：2012-05-14T21:09:14.013
> 
> 标签：php, ant, jenkins, phpunit

我目前在 Windows 7 机器上的 localhost 上运行 Jenkins，并已将 Ant 设置为在构建时运行。

我的 build.xml 是根据[http://jenkins-php.org/](http://jenkins-php.org/)设置的。

当我安排构建时，它失败并出现以下错误。

```
构建失败
C:\..\build.xml:127: Execute failed: java.io.IOException: Cannot run program "phpunit": CreateProcess error=2, 系统找不到指定的文件

```

如果我尝试从命令行运行 ant，我会检索到相同的错误。

phpunit 已设置并且可以从命令行正常工作。（Windows 路径环境变量包括 'c:..\php'，phpunit.bat 所在的位置）

关于如何设置 Ant、Jenkins 或 build.xml 以正确运行 phpunit 的任何想法？

谢谢

编辑：下面的 Oers 解决方案在 cmd 中有效！现在我的问题是 Jenkins 无法识别 phpunit.bat。我对 Ant 有同样的问题，我必须在 Jenkins 系统设置中手动设置 ANT_HOME。不幸的是，同样设置 Path 变量不起作用。然后Ant再次被识别。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T12:33:15.837

我发现这个很棒的指南对我帮助很大！

[http://www.pelshoff.com/2011/07/setting-up-a-kickass-development-environment-on-windows](http://www.pelshoff.com/2011/07/setting-up-a-kickass-development-environment-on-windows)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T06:20:26.350

.bat 文件通常不能直接执行

从[文档](https://ant.apache.org/manual/Tasks/exec.html)：

> 任务委托给 Runtime.exec，后者显然调用 ::CreateProcess。正是后者的 Win32 函数定义了调用的确切语义。特别是，如果您没有在可执行文件上添加文件扩展名，则只会查找“.EXE”文件，而不是“.COM”、“.CMD”或环境变量 PATHEXT 中列出的其他文件类型。这仅由外壳使用。
> 
> 请注意，.bat 文件通常不能直接执行。通常需要使用 /c 开关执行命令 shell 可执行 cmd。

```
<target name="phpunit">
  <exec executable="cmd">
    <arg value="/c"/>
    <arg value="phpunit.bat"/>
    <arg value="..."/>
  </exec>
</target> 
```

# algorithm - 面试算法：在大小为 n 的数组中找到两个最大的元素

> ID：10591112
> 
> 赞同：8
> 
> 时间：2012-05-14T21:09:56.093
> 
> 标签：algorithm, sorting

这是我在网上看到的一个面试问题，我不确定我的想法是否正确。

问题在这里：

> 设计一个算法，在 n 个数字的序列中找到两个最大的元素。比较次数需要为 n + O(log n)

我想我可能会选择快速排序并在找到两个最大元素时停止？但不能100%确定。任何人有想法请分享

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-14T21:33:46.163

递归拆分数组，在每一半中找到最大的元素，然后找到与最大元素进行比较的最大元素。第一部分需要 n 次比较，最后一部分需要 O(log n)。这是一个例子：

```
1 2 5 4 9 7 8 7 5 4 1 0 1 4 2 3
2   5   9   8   5   1   4   3
5       9       5       4
9               5
9 
```

在每一步，我都会合并相邻的数字并取两者中较大的一个。需要 n 次比较才能得出最大的数字 9。然后，如果我们查看将 9 与 (5, 5, 8, 7) 进行比较的每个数字，我们会看到最大的数字是 8，它一定是数组中的第二大。由于其中有 O(log n) 级别，因此需要 O(log n) 比较才能做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T04:56:34.740

对于只有**2 个**最大的元素，正常的选择可能就足够了。它基本上是 O(2*n)。

对于更一般的“从数组大小 n 中选择 k 个元素”的问题，快速排序是一个不错的想法，但您不必真正对整个数组进行排序。

试试这个

1.  您选择一个枢轴，将数组拆分为 N[m] 和 N[nm]。
2.  如果 k < m，忘记 N[nm] 部分，执行 N[m] 中的步骤 1。
3.  如果 k > m，忘记 N[m] 部分，进入 N[nm]。这一次，您尝试在 N[nm] 中找到第一个 km 元素。
4.  如果 k = m，你明白了。

它基本上就像在数组 N 中定位 k。您需要 log(N) 迭代，并平均移动 (N/2)^i 个元素。所以它是一个 N + log(N) 算法（满足您的要求），并且具有非常好的实际性能（比普通快速排序更快，因为它避免了任何排序，所以输出没有排序）。

# postgresql - 从 Postgres 数据库中删除所有函数

> ID：10591113
> 
> 赞同：23
> 
> 时间：2012-05-14T21:10:04.793
> 
> 标签：postgresql, postgis

我有一个数据库，其中安装了旧版本的 PostGIS。我想轻松删除数据库中的所有函数（它们都来自 PostGIS）。有没有一种简单的方法可以做到这一点？即使只是简单地提取函数名称列表也是可以接受的，因为我可以做一个大的`DROP FUNCTION`陈述。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-14T21:14:30.880

这个问题的一个[很好的答案可以在这里找到](http://www.postgresonline.com/journal/archives/74-How-to-delete-many-functions.html)：

```
SELECT 'DROP FUNCTION ' || ns.nspname || '.' || proname 
       || '(' || oidvectortypes(proargtypes) || ');'
FROM pg_proc INNER JOIN pg_namespace ns ON (pg_proc.pronamespace = ns.oid)
WHERE ns.nspname = 'my_messed_up_schema'  order by proname; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T23:01:41.810

就像有一个[`postgis.sql`启动器安装脚本](http://postgis.refractions.net/docs/postgis_installation.html#create_new_db)一样，也有一个`uninstall_postgis.sql`卸载脚本。

```
psql -d [yourdatabase] -f /path/to/uninstall_postgis.sql 
```

警告：准备好看到您的几何/地理列和数据消失！

# jquery - 在 MVC3 中使用带有模型的 jQuery 函数

> ID：10591117
> 
> 赞同：2
> 
> 时间：2012-05-14T21:10:25.143
> 
> 标签：jquery, asp.net-mvc-3, razor, model

我正在 MVC3 ASP.NET 应用程序中尝试 jQuery，但我在模型方面苦苦挣扎。

这不起作用：

我已经声明了一个 TextBox Watermark 库：

```
<script src="../../Scripts/jquery.tinywatermark-3.1.0.js" type="text/javascript"></script> 
```

然后我添加我的 jQuery：

```
<script type="text/javascript">
    $(function () {
        $('.watermarked').watermark('watermark', 'Please Enter...');
    });
</script> 
```

然后将带水印的类添加到我的 div 模型字段中：

```
<div class="editor-field">
     @Html.EditorFor(model => model.SchemeName, new { @class = "watermarked" }) 
    @*<input class="watermarked"  @Html.EditorFor(model => model.SchemeName) />*@
    @Html.ValidationMessageFor(model => model.SchemeName) 
```

如果我取消注释该部分它有点工作但我想维护 Razor 模型，有什么想法，有人吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T21:13:39.803

以下行：

```
@Html.EditorFor(model => model.SchemeName, new { @class = "watermarked" }) 
```

不做你认为它做的事。您传递给`EditorFor`助手的第二个参数并没有按照您的想法执行。它将附加视图数据发送到自定义编辑器模板。它不会应用您可能想的任何 html 属性。如果您希望此语法正常工作，您可以编写自定义元数据提供程序和自定义编辑器模板，[如下文](http://webcache.googleusercontent.com/search?q=cache%3atJTYtfAilzoJ%3aaspadvice.com/blogs/kiran/archive/2009/11/29/Adding-html-attributes-support-for-Templates-_2D00_-ASP.Net-MVC-2.0-Beta_2D00_1.aspx+asp.neT+MVC+custom+metadata+provider+htmlproperties&cd=1&hl=en&ct=clnk)所示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T00:45:51.930

我不确定`EditorFor()`您需要它的偏好是什么，但这应该可以正常工作

```
@Html.TextBoxFor(model => model.SchemeName, new { @class = "watermarked" }) 
```

# java - Netty + JMeter，重用连接时出错

> ID：10591120
> 
> 赞同：5
> 
> 时间：2012-05-14T21:10:28.470
> 
> 标签：java, jmeter, netty

我使用 Netty 构建了一个简单的 TCP 服务器，我想用 JMeter 对其进行基准测试。我正在使用 JMeter TCP 采样器，使用 BinaryTCPClientImpl 类名来发送字节。我检查了“无延迟”和“重用连接”。我假设这些是针对 SO_NODELAY 和 SO_REUSEADDR 的。我正在运行 75 个线程，每个线程执行 1000 个 TCP 请求。我一直看到大约 11% 的请求失败：

> 500 java.net.SocketException：软件导致连接中止：套接字写入错误

如果我取消选中“重用连接”，那么所有 75,000 个请求都会成功，不会出现一个错误，但吞吐量仅为原来的 33% 左右。

我需要对我的 Netty 服务器做些什么来防止这些错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:22:01.783

我应该注意我的服务器是这样工作的：接受连接，接收一些数据，发送一些数据，一旦发送数据就关闭连接。JMeter 文档说 TCP Sampler 会关闭连接，除非选中“重用套接字”，所以我猜这不是 SO_REUSEADDR。我假设在某些情况下客户端发送数据，接收数据，在服务器关闭套接字之前，客户端尝试再次发送数据，然后服务器关闭套接字并且 JMeter 认为请求失败。

因此，解决方案是不检查“重用地址”。关闭每个请求的套接字是预期的行为，因为我的客户端通信相对不频繁。

# database - 数据库实施帮助：时间序列数据

> ID：10591129
> 
> 赞同：2
> 
> 时间：2012-05-14T21:11:20.023
> 
> 标签：database, postgresql, database-design, time-series

[这是我之前问题](https://stackoverflow.com/questions/10588933/ordered-timeseries-data-stock-market-data-using-structure-variants)的重新提交：

我有一组有序的时间序列数据（股票分钟价格信息）。我当前使用 PostgreSQL 的数据库结构如下：

`symbol_table`- 我将符号列表`symbol_id`作为主键（序列）。 `time_table, date_table`- 时间/日期值存储在那里。time_id/date_id 是主键（序列号/序列号）。

我的主要`minute_table`包含分钟定价信息， `date_id|time_id|symbol_id`主键在哪里（也是相应表中的外键）

使用这个主要`minute_table`我正在执行不同的统计分析并将结果保存在单独的表格中，例如`one_minute_std`- 保存一分钟标准偏差测量。

每天晚上，我都会使用前一天收盘价的当前价格信息更新表格。

在当前的实现中，我的表包含所有符号，每个符号大约有 50m 条记录。主键被索引。

如果我想查询，`all the symbols where closing price > x and one_minute_std >2 and one_minute_std < 4 for the specific date`搜索大约需要 3-4 分钟。

为了加快这个过程，我正在考虑将每个符号分离到自己的表中，但不能 100% 确定这是否是一种“正确”的做法。

你能告诉我如何加快查询过程吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T00:21:38.320

听起来您想要多种方法的组合。

首先，您应该研究表分区。这将跨多个存储单元（“文件”）存储单个表，但仍为您提供单个表的灵活性。（这里是 postgres 文档[http://www.postgresql.org/docs/current/interactive/ddl-partitioning.html](http://www.postgresql.org/docs/current/interactive/ddl-partitioning.html)）。

您可能希望按天或按股票代码进行分区。我的第一反应是按时间（日/周/月），因为这是更新的单位。但是，如果您仅通过单个代码进行分析并且通常跨越数天，那么就有理由使用它来代替。

分区后，您可能需要考虑索引。但是，我怀疑分区会解决您的性能问题。

由于您的更新是在晚上进行的，因此您应该在总结过程中加入更新。例如，one_minute_std 应在此过程中计算。您可能会发现最好将每晚的数据加载到临时表中，对 one_minute_std 等摘要进行计算，然后将数据加载到最终的分区表方案中。

有这么多行但列这么少，使用良好的分区方案可能比索引方案更好。特别是索引有空间开销，每行中的记录越小，使用索引所产生的开销就越大，相当于扫描整个表。

# javascript - js节点-socket.io聊天修改

> ID：10591134
> 
> 赞同：2
> 
> 时间：2012-05-14T21:11:48.073
> 
> 标签：javascript, jquery, node.js, chat, socket.io

这是一个简单的聊天示例。如何修改脚本以便：

前5s，第一个用户可以发消息，接下来的5s，用户不能发消息 在接下来的5s（当第一个用户不能发消息时），第二个用户可以发消息，第一个用户获得一个 div (apIdv1) 来显示 index.html：

```
<script src="/socket.io/socket.io.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script>
    var socket = io.connect('http://localhost:8080');

    // on connection to server, ask for user's name with an anonymous callback
    socket.on('connect', function(){
        // call the server-side function 'adduser' and send one parameter (value of prompt)
        socket.emit('adduser', prompt("What's your name?"));
    });

    // listener, whenever the server emits 'updatechat', this updates the chat body
    socket.on('updatechat', function (username, data) {

        $('#conversation').append('<b>'+username + ':</b> ' + data + '<br>');
    });

    // listener, whenever the server emits 'updaterooms', this updates the room the client is in
    socket.on('updaterooms', function(rooms, current_room) {
        $('#rooms').empty();
        $.each(rooms, function(key, value) {
            if(value == current_room){
                $('#rooms').append('<div>' + value + '</div>');
            }
            else {
                $('#rooms').append('<div><a href="#" onclick="switchRoom(\''+value+'\')">' + value + '</a></div>');
            }
        });
    });

    function switchRoom(room){
        socket.emit('switchRoom', room);
    }

    // on load of page
    $(function(){
        // when the client clicks SEND
        $('#datasend').click( function() {
            var message = $('#data').val();
            $('#data').val('');
            // tell server to execute 'sendchat' and send along one parameter
            socket.emit('sendchat', message);
        });

        // when the client hits ENTER on their keyboard
        $('#data').keypress(function(e) {
            if(e.which == 13) {
                $(this).blur();
                $('#datasend').focus().click();
            }
        });
    });

</script>

<style type="text/css">
#apDiv1 {
    position:absolute;
    width:200px;
    height:115px;
    z-index:1;
    left: 150px;
    top: 20px;
    background-color: #FF9900;
    display:none;
}
</style>

<div style="float:left;width:100px;border-right:1px solid black;height:300px;padding:10px;overflow:scroll-y;">
    <b>ROOMS</b>
    <div id="rooms"></div>
</div>
<div style="float:left;width:300px;height:250px;overflow:scroll-y;padding:10px;">
    <div id="conversation"></div>
    <input id="data" style="width:200px;" />
    <input type="button" id="datasend" value="send" />
</div>
<div id="apDiv1"></div> 
```

应用程序.js

```
var app = require('express').createServer()
var io = require('socket.io').listen(app);

app.listen(8080);

// routing
app.get('/', function (req, res) {
  res.sendfile(__dirname + '/index.html');
});

// usernames which are currently connected to the chat
var usernames = {};

// rooms which are currently available in chat
var rooms = ['room1','room2','room3'];

io.sockets.on('connection', function (socket) {

    // when the client emits 'adduser', this listens and executes
    socket.on('adduser', function(username){
        // store the username in the socket session for this client
        socket.username = username;
        // store the room name in the socket session for this client
        socket.room = 'room1';
        // add the client's username to the global list
        usernames[username] = username;
        // send client to room 1
        socket.join('room1');
        // echo to client they've connected
        socket.emit('updatechat', 'SERVER', 'you have connected to room1');
        // echo to room 1 that a person has connected to their room
        socket.broadcast.to('room1').emit('updatechat', 'SERVER', username + ' has connected to this room');
        socket.emit('updaterooms', rooms, 'room1');
    });

    // when the client emits 'sendchat', this listens and executes
    socket.on('sendchat', function (data) {
        // we tell the client to execute 'updatechat' with 2 parameters
        io.sockets.in(socket.room).emit('updatechat', socket.username, data);
    });

    socket.on('switchRoom', function(newroom){
        // leave the current room (stored in session)
        socket.leave(socket.room);
        // join new room, received as function parameter
        socket.join(newroom);
        socket.emit('updatechat', 'SERVER', 'you have connected to '+ newroom);
        // sent message to OLD room
        socket.broadcast.to(socket.room).emit('updatechat', 'SERVER', socket.username+' has left this room');
        // update socket session room title
        socket.room = newroom;
        socket.broadcast.to(newroom).emit('updatechat', 'SERVER', socket.username+' has joined this room');
        socket.emit('updaterooms', rooms, newroom);
    });

    // when the user disconnects.. perform this
    socket.on('disconnect', function(){
        // remove the username from global usernames list
        delete usernames[socket.username];
        // update list of users in chat, client-side
        io.sockets.emit('updateusers', usernames);
        // echo globally that this client has left
        socket.broadcast.emit('updatechat', 'SERVER', socket.username + ' has disconnected');
        socket.leave(socket.room);
    });
}); 
```

如何将前 5 秒的 apDiv1 显示给一个用户，然后让它消失，反之亦然？

更新答案：

为什么这现在不起作用？

应用程序.js

```
var app = require('express').createServer()
var io = require('socket.io').listen(app);

app.listen(8080);

// routing
app.get('/', function (req, res) {
  res.sendfile(__dirname + '/index.html');
});

// usernames which are currently connected to the chat
var usernames = {};

// rooms which are currently available in chat
var rooms = ['room1','room2','room3'];

io.sockets.on('connection', function (socket) {

    // when the client emits 'adduser', this listens and executes
    socket.on('adduser', function(username){
        // store the username in the socket session for this client
        socket.username = username;
        // store the room name in the socket session for this client
        socket.room = 'room1';
        // add the client's username to the global list
        usernames[username] = username;
        // send client to room 1
        socket.join('room1');
        // echo to client they've connected
        socket.emit('updatechat', 'SERVER', 'you have connected to room1');
        // echo to room 1 that a person has connected to their room
        socket.broadcast.to('room1').emit('updatechat', 'SERVER', username + ' has connected to this room');
        socket.emit('updaterooms', rooms, 'room1');
    });

    // when the client emits 'sendchat', this listens and executes
    socket.on('sendchat', function (data) {
        // we tell the client to execute 'updatechat' with 2 parameters
        io.sockets.in(socket.room).emit('updatechat', socket.username, data);
    });

    socket.on('switchRoom', function(newroom){
        // leave the current room (stored in session)
        socket.leave(socket.room);
        // join new room, received as function parameter
        socket.join(newroom);
        socket.emit('updatechat', 'SERVER', 'you have connected to '+ newroom);
        // sent message to OLD room
        socket.broadcast.to(socket.room).emit('updatechat', 'SERVER', socket.username+' has left this room');
        // update socket session room title
        socket.room = newroom;
        socket.broadcast.to(newroom).emit('updatechat', 'SERVER', socket.username+' has joined this room');
        socket.emit('updaterooms', rooms, newroom);
    });
    function redLightGreenLight() {
   socket1.emit('redLight');
   socket2.emit('greenLight');
}

setTimer('redLightGreenLight()', 5000);
    // when the user disconnects.. perform this
    socket.on('disconnect', function(){
        // remove the username from global usernames list
        delete usernames[socket.username];
        // update list of users in chat, client-side
        io.sockets.emit('updateusers', usernames);
        // echo globally that this client has left
        socket.broadcast.emit('updatechat', 'SERVER', socket.username + ' has disconnected');
        socket.leave(socket.room);
    });
}); 
```

索引.html

```
<script src="/socket.io/socket.io.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script>
    var socket = io.connect('http://localhost:8080');

    // on connection to server, ask for user's name with an anonymous callback
    socket.on('connect', function(){
        // call the server-side function 'adduser' and send one parameter (value of prompt)
        socket.emit('adduser', prompt("What's your name?"));
    });

    // listener, whenever the server emits 'updatechat', this updates the chat body
    socket.on('updatechat', function (username, data) {
        $('#conversation').append('<b>'+username + ':</b> ' + data + '<br>');
    });

    // listener, whenever the server emits 'updaterooms', this updates the room the client is in
    socket.on('updaterooms', function(rooms, current_room) {
        $('#rooms').empty();
        $.each(rooms, function(key, value) {
            if(value == current_room){
                $('#rooms').append('<div>' + value + '</div>');
            }
            else {
                $('#rooms').append('<div><a href="#" onclick="switchRoom(\''+value+'\')">' + value + '</a></div>');
            }
        });
    });

    function switchRoom(room){
        socket.emit('switchRoom', room);
    }
*socket.on('greenLight', function (data) {
    // change div to enable sending a message
});
socket.on('redLight', function (data) {
    // change div to index.html*
});
    // on load of page
    $(function(){
        // when the client clicks SEND
        $('#datasend').click( function() {
            var message = $('#data').val();
            $('#data').val('');
            // tell server to execute 'sendchat' and send along one parameter
            socket.emit('sendchat', message);
        });

        // when the client hits ENTER on their keyboard
        $('#data').keypress(function(e) {
            if(e.which == 13) {
                $(this).blur();
                $('#datasend').focus().click();
            }
        });
    });

</script>
<style type="text/css">
#greenLight {
    position:absolute;
    width:200px;
    height:115px;
    z-index:1;
    left: 150px;
    top: 20px;
    background-color: #FF9900;
    display:none;
}
</style>

<div style="float:left;width:100px;border-right:1px solid black;height:300px;padding:10px;overflow:scroll-y;">
    <b>ROOMS</b>
    <div id="rooms"></div>
</div>
<div style="float:left;width:300px;height:250px;overflow:scroll-y;padding:10px;">
    <div id="conversation"></div>
    <input id="data" style="width:200px;" />
    <input type="button" id="datasend" value="send" />
</div>
***<div id="greenLight"></div>*** 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T23:33:08.873

Quoth beginerplus，“也许服务器更好地完成工作......如何更改我的脚本来做到这一点？请在答案中写下示例”：

在服务器上：

```
function redLightGreenLight() {
   socket1.emit('redLight');
   socket2.emit('greenLight');
}

setTimer('redLightGreenLight()', 5000); 
```

在客户端：

```
socket.on('greenLight', function (data) {
    // change div to enable sending a message
});
socket.on('redLight', function (data) {
    // change div to index.html
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T21:36:03.360

有两种方法：

1.  服务器在 5 秒后使用 setTimer （或 setInterval 以防您需要重复）向每个客户端发送一条消息：客户端 #1 不能再发送消息，客户端 #2 可以。然后每个客户端通过更改 div 内容来处理消息。
2.  每个客户端都自己使用 setTimer 或 setInterval；根据您的用例，这可能具有一些优点，但可能具有计时器不会在完全相同的时间启动的缺点。

# android - 在某些设备上，有时在 bindService 之后不会调用 onServiceConnected

> ID：10591136
> 
> 赞同：4
> 
> 时间：2012-05-14T21:12:09.497
> 
> 标签：android, service

我查看了许多具有类似标题的其他线程，但似乎没有一个能解决我的问题。所以，就这样吧。

我正在使用 Google 市场扩展文件 (apkx) 库和示例代码，并进行了一些修改。此代码依赖于从处理后台下载、许可证检查等的服务接收回调。

我有一个错误，服务没有正确连接，导致软锁。为了使这更加无用，此错误从未在某些设备上发生，但在其他设备上大约有三分之二的时间发生。我相信它独立于 Android 版本，当然我有两台运行 2.3.4 的设备，其中一台（Nexus S）没有问题，另一台（HTC Evo 3D）有。

要尝试连接到服务，调用 bindService 并返回 true。OnBind 然后按预期调用并返回一个合理的值，但是（当错误发生时）onServiceConnected 没有发生（我等了 20 分钟以防万一）。

有没有其他人见过这样的事情？如果没有，对我可能做了什么导致这种行为有任何猜测吗？如果没有人有任何想法，我明天会发布一些代码。

编辑：这是相关的代码。如果我错过了什么，请询问。

在添加此代码时，我发现了一个小错误。修复它导致我试图解决的问题的频率在我正在测试的手机上从 3 次中的 2 次变为 6 次中的 1 次；不知道对其他手机的影响。这继续向我暗示比赛条件或类似情况，但我不知道是什么。

OurDownloaderActivity.java（从 Google 示例代码复制和更改）

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ...

    //Test the licence is up to date
    //if (current stored licence has expired)
    {
        startLicenceCheck();
        initializeDownloadUI();
        return;
    }

    ...
}

@Override
protected void onResume() {
    if (null != mDownloaderClientStub) {
        mDownloaderClientStub.connect(this);
    }
    super.onResume();
}

private void startLicenceCheck()
{
    Intent launchIntent = OurDownloaderActivity.this
            .getIntent();
    Intent intentToLaunchThisActivityFromNotification = new Intent(OurDownloaderActivity
            .this, OurDownloaderActivity.this.getClass());
    intentToLaunchThisActivityFromNotification.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK |
            Intent.FLAG_ACTIVITY_CLEAR_TOP);
    intentToLaunchThisActivityFromNotification.setAction(launchIntent.getAction());

    if (launchIntent.getCategories() != null) {
        for (String category : launchIntent.getCategories()) {
            intentToLaunchThisActivityFromNotification.addCategory(category);
        }
    }

    // Build PendingIntent used to open this activity from Notification
    PendingIntent pendingIntent = PendingIntent.getActivity(OurDownloaderActivity.this,
            0, intentToLaunchThisActivityFromNotification,
            PendingIntent.FLAG_UPDATE_CURRENT);

    DownloaderService.startLicenceCheck(this, pendingIntent, OurDownloaderService.class);
}

initializeDownloadUI()
{
    mDownloaderClientStub = DownloaderClientMarshaller.CreateStub
            (this, OurDownloaderService.class);

    //do a load of UI setup
    ...
}

//This should be called by the Stub's onServiceConnected method
/**
 * Critical implementation detail. In onServiceConnected we create the
 * remote service and marshaler. This is how we pass the client information
 * back to the service so the client can be properly notified of changes. We
 * must do this every time we reconnect to the service.
 */
@Override
public void onServiceConnected(Messenger m) {
    mRemoteService = DownloaderServiceMarshaller.CreateProxy(m);
    mRemoteService.onClientUpdated(mDownloaderClientStub.getMessenger());
} 
```

DownloaderService.java （在 Google 市场扩展库中，但有些编辑）

```
//this is the onBind call that happens fine; the value it returns is definitely not null
@Override
public IBinder onBind(Intent paramIntent) {
    return this.mServiceMessenger.getBinder();
}

final private IStub mServiceStub = DownloaderServiceMarshaller.CreateStub(this);
final private Messenger mServiceMessenger = mServiceStub.getMessenger();

//MY CODE, derived from Google's code
//I have seen the bug occur with a service started by Google's code too,
//but this code happens more often so is more repeatably related to the problem
public static void startLicenceCheck(Context context, PendingIntent pendingIntent, Class<?> serviceClass)
{       
    String packageName = serviceClass.getPackage().getName();
    String className = serviceClass.getName();

    Intent fileIntent = new Intent();
    fileIntent.setClassName(packageName, className);
    fileIntent.putExtra(EXTRA_LICENCE_EXPIRED, true);
    fileIntent.putExtra(EXTRA_PENDING_INTENT, pendingIntent);
    context.startService(fileIntent);
}

@Override
protected void onHandleIntent(Intent intent) {
    setServiceRunning(true);
    try {
        final PendingIntent pendingIntent = (PendingIntent) intent
            .getParcelableExtra(EXTRA_PENDING_INTENT);

        if (null != pendingIntent)
        {
            mNotification.setClientIntent(pendingIntent);
            mPendingIntent = pendingIntent;
        } else if (null != mPendingIntent) {
            mNotification.setClientIntent(mPendingIntent);
        } else {
            Log.e(LOG_TAG, "Downloader started in bad state without notification intent.");
            return;
        }

        if(intent.getBooleanExtra(EXTRA_LICENCE_EXPIRED, false))
        {
            //we are here due to startLicenceCheck
            updateExpiredLVL(this);
            return;
        }
    ...
    }
}

//MY CODE, based on Google's, again
public void updateExpiredLVL(final Context context) {
    Context c = context.getApplicationContext();
    Handler h = new Handler(c.getMainLooper());
    h.post(new LVLExpiredUpdateRunnable(c));
}

private class LVLExpiredUpdateRunnable implements Runnable
{
    LVLExpiredUpdateRunnable(Context context) {
        mContext = context;
    }

    final Context mContext;

    @Override
    public void run() {
        setServiceRunning(true);
        mNotification.onDownloadStateChanged(IDownloaderClient.STATE_LVL_UPDATING);
        String deviceId = getDeviceId(mContext);

        final APKExpansionPolicy aep = new APKExpansionPolicy(mContext,
                new AESObfuscator(getSALT(), mContext.getPackageName(), deviceId));

        // Construct the LicenseChecker with a Policy.
        final LicenseChecker checker = new LicenseChecker(mContext, aep,
                getPublicKey() // Your public licensing key.
        );
        checker.checkAccess(new LicenseCheckerCallback() {
            ...
        });
    }
} 
```

DownloaderClientMarshaller.java（在谷歌市场扩展库中）

```
public static IStub CreateStub(IDownloaderClient itf, Class<?> downloaderService) {
    return new Stub(itf, downloaderService);
} 
```

和来自同一文件的 Stub 类：

```
private static class Stub implements IStub {
    private IDownloaderClient mItf = null;
    private Class<?> mDownloaderServiceClass;
    private boolean mBound;
    private Messenger mServiceMessenger;
    private Context mContext;
    /**
     * Target we publish for clients to send messages to IncomingHandler.
     */
    final Messenger mMessenger = new Messenger(new Handler() {
        @Override
        public void handleMessage(Message msg) {
            switch (msg.what) {
                case MSG_ONDOWNLOADPROGRESS:                        
                    Bundle bun = msg.getData();
                    if ( null != mContext ) {
                        bun.setClassLoader(mContext.getClassLoader());
                        DownloadProgressInfo dpi = (DownloadProgressInfo) msg.getData()
                                .getParcelable(PARAM_PROGRESS);
                        mItf.onDownloadProgress(dpi);
                    }
                    break;
                case MSG_ONDOWNLOADSTATE_CHANGED:
                    mItf.onDownloadStateChanged(msg.getData().getInt(PARAM_NEW_STATE));
                    break;
                case MSG_ONSERVICECONNECTED:
                    mItf.onServiceConnected(
                            (Messenger) msg.getData().getParcelable(PARAM_MESSENGER));
                    break;
            }
        }
    });

    public Stub(IDownloaderClient itf, Class<?> downloaderService) {
        mItf = itf;
        mDownloaderServiceClass = downloaderService;
    }

    /**
     * Class for interacting with the main interface of the service.
     */
    private ServiceConnection mConnection = new ServiceConnection() {

        //this is the critical call that never happens

        public void onServiceConnected(ComponentName className, IBinder service) {
            // This is called when the connection with the service has been
            // established, giving us the object we can use to
            // interact with the service. We are communicating with the
            // service using a Messenger, so here we get a client-side
            // representation of that from the raw IBinder object.
            mServiceMessenger = new Messenger(service);
            mItf.onServiceConnected(
                    mServiceMessenger);
            mBound = true;                
        }

        public void onServiceDisconnected(ComponentName className) {
            // This is called when the connection with the service has been
            // unexpectedly disconnected -- that is, its process crashed.
            mServiceMessenger = null;
            mBound = false;
        }
    };

    @Override
    public void connect(Context c) {
        mContext = c;
        Intent bindIntent = new Intent(c, mDownloaderServiceClass);
        bindIntent.putExtra(PARAM_MESSENGER, mMessenger);
        if ( !c.bindService(bindIntent, mConnection, 0) ) {
            if ( Constants.LOGVV ) {
                Log.d(Constants.TAG, "Service Unbound");
            }
        }

    }

    @Override
    public void disconnect(Context c) {
        if (mBound) {
            c.unbindService(mConnection);
            mBound = false;
        }
        mContext = null;
    }

    @Override
    public Messenger getMessenger() {
        return mMessenger;
    }
} 
```

DownloaderServiceMarshaller.java（在谷歌市场扩展库中，不变）

```
private static class Proxy implements IDownloaderService {
    private Messenger mMsg;

    private void send(int method, Bundle params) {
        Message m = Message.obtain(null, method);
        m.setData(params);
        try {
            mMsg.send(m);
        } catch (RemoteException e) {
            e.printStackTrace();
        }
    }

    public Proxy(Messenger msg) {
        mMsg = msg;
    }

    @Override
    public void requestAbortDownload() {
        send(MSG_REQUEST_ABORT_DOWNLOAD, new Bundle());
    }

    @Override
    public void requestPauseDownload() {
        send(MSG_REQUEST_PAUSE_DOWNLOAD, new Bundle());
    }

    @Override
    public void setDownloadFlags(int flags) {
        Bundle params = new Bundle();
        params.putInt(PARAMS_FLAGS, flags);
        send(MSG_SET_DOWNLOAD_FLAGS, params);
    }

    @Override
    public void requestContinueDownload() {
        send(MSG_REQUEST_CONTINUE_DOWNLOAD, new Bundle());
    }

    @Override
    public void requestDownloadStatus() {
        send(MSG_REQUEST_DOWNLOAD_STATE, new Bundle());
    }

    @Override
    public void onClientUpdated(Messenger clientMessenger) {
        Bundle bundle = new Bundle(1);
        bundle.putParcelable(PARAM_MESSENGER, clientMessenger);
        send(MSG_REQUEST_CLIENT_UPDATE, bundle);
    }
}

private static class Stub implements IStub {
    private IDownloaderService mItf = null;
    final Messenger mMessenger = new Messenger(new Handler() {
        @Override
        public void handleMessage(Message msg) {
            switch (msg.what) {
                case MSG_REQUEST_ABORT_DOWNLOAD:
                    mItf.requestAbortDownload();
                    break;
                case MSG_REQUEST_CONTINUE_DOWNLOAD:
                    mItf.requestContinueDownload();
                    break;
                case MSG_REQUEST_PAUSE_DOWNLOAD:
                    mItf.requestPauseDownload();
                    break;
                case MSG_SET_DOWNLOAD_FLAGS:
                    mItf.setDownloadFlags(msg.getData().getInt(PARAMS_FLAGS));
                    break;
                case MSG_REQUEST_DOWNLOAD_STATE:
                    mItf.requestDownloadStatus();
                    break;
                case MSG_REQUEST_CLIENT_UPDATE:
                    mItf.onClientUpdated((Messenger) msg.getData().getParcelable(
                            PARAM_MESSENGER));
                    break;
            }
        }
    });

    public Stub(IDownloaderService itf) {
        mItf = itf;
    }

    @Override
    public Messenger getMessenger() {
        return mMessenger;
    }

    @Override
    public void connect(Context c) {

    }

    @Override
    public void disconnect(Context c) {

    }
}

/**
 * Returns a proxy that will marshall calls to IDownloaderService methods
 * 
 * @param ctx
 * @return
 */
public static IDownloaderService CreateProxy(Messenger msg) {
    return new Proxy(msg);
}

/**
 * Returns a stub object that, when connected, will listen for marshalled
 * IDownloaderService methods and translate them into calls to the supplied
 * interface.
 * 
 * @param itf An implementation of IDownloaderService that will be called
 *            when remote method calls are unmarshalled.
 * @return
 */
public static IStub CreateStub(IDownloaderService itf) {
    return new Stub(itf);
} 
```

# javascript - Rails：在一个请求中渲染 html 和 js

> ID：10591138
> 
> 赞同：1
> 
> 时间：2012-05-14T21:12:17.250
> 
> 标签：javascript, ruby-on-rails

当用户访问我的站点时，我想同时呈现 index.html.haml 和 index.js.haml。（我正试图让我的 JS 离开视图。）

目前，它只呈现 html。当然，添加一个`respond_to`同时包含 html 和 js 的块只会呈现 html。

我该怎么做呢？有没有更好的办法？我不想在 /assets/js 中包含 JS，因为 ruby​​ 在 JS 中执行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T23:26:35.273

Rails 控制器操作一次只能响应一个 HTTP 请求，即使它可以响应多个 HTTP 请求，也会从 HTML 请求 JS，但初始请求会以任何方式发出（因此它是一个单独的请求）。

如果您想将 Javascript 保存在另一个文件中以清楚起见，您可以创建一个部分并以这种方式加载它。

在响应控制器操作的视图中，@my_var 传递给部分（./views/mycontroller/my_action.html.erb）：

```
<%= render 'my_action_js', :my_var => @my_var %> 
```

和部分（./views/mycontroller/_my_action_js.html.erb）

```
<script type="text/javascript">
    alert(<%= my_var %>);
</script> 
```

# c# - 在具有长时间运行进程的视图上使用 MVVM

> ID：10591141
> 
> 赞同：1
> 
> 时间：2012-05-14T21:12:31.840
> 
> 标签：c#, wpf, silverlight, mvvm

我在这里有一个例子，它复制了我想要完成的事情。正如以下代码所示 - 我有 ViewModel 更新绑定到视图的 ObservableCollection 属性。通常我会根据从模型中检索到的结果来更新集合，但希望这个示例就足够了。

```
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;
using System.Text;
using System.Threading;
using System.Windows.Controls;

namespace MVVMWpf.ViewModel
{
    public class ListViewModel
    {

        public ObservableCollection<int> SomeObjectCollection { get; set; }

        public ListViewModel()
        {

            SomeObjectCollection = new ObservableCollection<int>();

        }

        public void Do()
        {
             for (int i = 1; i < 1000000; i++)
             {
                 int i1 = i;
                 SomeObjectCollection.Add(i1);
             }
        }

    }
} 
```

不幸的是，这会阻止这个 UI。它只会在循环运行完成时更新视图。我解决它的方式打破了 MVVM 概念。这就是为什么我需要你的帮助。我是这样做的。

```
public class ListViewModel
{
    private delegate void LongRunningProcess();
    public ObservableCollection<int> SomeObjectCollection { get; set; }
    private ListBox listBox;
    public ListViewModel(ListBox listBox)
    {
        this.listBox = listBox;
        SomeObjectCollection = new ObservableCollection<int>();

    }

    public void Do()
    {
        Thread thread = new Thread(() =>
        {
           for (int i = 1; i < int.MaxValue; i++)
           {
               int i1 = i;
               listBox.Dispatcher.Invoke(
                   new LongRunningProcess(() =>
                   SomeObjectCollection.Add(i1);
                 }});

        thread.SetApartmentState(ApartmentState.STA);
        thread.Start();
    }

} 
```

如您所见，ViewModel 现在知道 UI 中的 listBox 元素。并且查看 MVVM 图，只有 View 应该通过绑定来引用 ViewModel。如何克服这个问题？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T21:26:25.210

你需要让你的循环释放屏幕更新——某种 DoEvents() 会做：

```
public static void DoEvents() 
{ 
    Application.Current.Dispatcher.Invoke(
    DispatcherPriority.Background,new Action(delegate { })); 
} 
```

添加它并从您的循环中调用它。

* * *

使用计时器作为另一个选项，您的代码应该看起来像这样：

```
private System.Timers.Timer operationsTimer = new System.Timers.Timer();
private int x; 
```

在你的 ctor 中：

```
operationsTimer.Elapsed += new System.Timers.ElapsedEventHandler 
(operationsTimer_Elapsed);
operationsTimer.Enabled = true; 
```

在你的计时器中：

```
operationsTimer_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
{ 
    operationsTimer.Enabled = false;
    //add item to collection code
    x++;
    if(x<100)
        operationsTimer.Enabled = true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T21:38:02.517

考虑使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)，这是一种执行异步任务的简单方法，具有报告进度和已完成事件的功能。最重要的是，您不必在调度程序上调用任何东西，因为 BackgroundWorker 的函数与 UI 线程同步。

# c - Libelf：函数的未定义参考

> ID：10591145
> 
> 赞同：3
> 
> 时间：2012-05-14T21:12:46.077
> 
> 标签：c, undefined-reference

我正在尝试使用 Libelf 库来获取有关某些 elf 文件的一些信息。但我不断收到这些“未定义的对 [...] 的引用”。我从突触安装了 libelf（也尝试从网站获取），并且 lib 似乎安装得很好。

我的代码：

```
#include <err.h>
#include <fcntl.h>
#include <sysexits.h>
#include <unistd.h>

#include <stdio.h>
#include <stdlib.h>
#include <libelf.h>

int main(int argc, char * argv[]) {
    Elf *elf_file;
    Elf_Kind  elf_kind_file;
    int file_descriptor;

    if((argc!=2)) 
        printf("Argumento em formato nao esperado\n");

    file_descriptor = open(argv[1], O_RDONLY, 0);
    elf_file = elf_begin(file_descriptor, ELF_C_READ, NULL);
    elf_kind_file = elf_kind(elf_file);

    elf_end(elf_file);
    close(file_descriptor);

    return 0;
} 
```

这是我从终端得到的（目前使用的是 Ubuntu 11.4）：

```
gcc sample.c -o sample
/tmp/ccP7v2DT.o: In function `main':
sample.c:(.text+0x57): undefined reference to `elf_begin'
sample.c:(.text+0x67): undefined reference to `elf_kind'
sample.c:(.text+0x77): undefined reference to `elf_end'
collect2: ld returned 1 exit status 
```

**更新**

解决了我在编译期间将 -lelf 放在我的文件之前的所有问题。最后一个我只能解决将我的 libelf 更新到新版本（在 Synaptic Manager 上不可用）：

```
wget http://ftp.br.debian.org/debian/pool/main/e/elfutils/libelf-dev_0.153-1_i386.deb
wget http://ftp.br.debian.org/debian/pool/main/e/elfutils/libelf1_0.153-1_i386.deb
sudo dpkg -i libelf-dev_0.153-1_i386.deb libelf1_0.153-1_i386.deb 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T21:26:33.383

You probably need to link to the library. The standard way to do this is:

```
gcc sample.c -l elf -o sample 
```

This searches the standard library directories for libelf.a, and includes the relevant object files in that archive into the build. Assuming the library has been installed correctly, libelf.a or a similarly-named file should exist.

# mysql - 尝试编写查询以选择我、我的朋友写的帖子或我的朋友喜欢的帖子

> ID：10591150
> 
> 赞同：0
> 
> 时间：2012-05-14T21:13:09.943
> 
> 标签：mysql, sql, sqlalchemy

我有 3 个表格 - 帖子、友谊和喜欢 - 下面描述的重要字段。

帖子：`id, user_id, title`

友谊：`requester_id, accepter_id, is_confirmed`

喜欢：`post_id, user_id`

我有一个名为 get_relevant_posts() 的方法，它应该返回我写的、我确认的朋友写的或者我确认的朋友喜欢的帖子。我已经在 SQLAlchemy 中实现了这个，但是我的查询中有一个错误，因为它只有在友谊表不为空时才有效（不管里面有什么，只是不能为空）。如果它为空，则不会返回任何内容（不正确的连接？）。

这不是一个大问题，因为友谊表中 99.99% 的时间都会有一些东西。但我仍然想退后一步，用普通的 SQL 来写这个——我似乎无法理解它。

**SQLALCHEMY 代码**

```
Friendship1 = aliased(Friendship)
Friendship2 = aliased(Friendship)
Friendship3 = aliased(Friendship)
Friendship4 = aliased(Friendship)
return (DBSession.query(Post)
        .outerjoin(Friendship1, Post.user_id==Friendship1.accepter_id)
        .outerjoin(Friendship2, Post.user_id==Friendship2.requester_id)
        .outerjoin(Like, Post.id==Like.post_id)
        .filter(or_(
            # My post
            self.id==Post.user_id,
            # My friends post, where I'm the requester of the friendship
            and_(self.id==Friendship1.requester_id,
                 Friendship1.is_confirmed==True),
            # My friends post, where I'm the accepter of the friendship
            and_(self.id==Friendship2.accepter_id,
                 Friendship2.is_confirmed==True),
            # Somebodies post, which my friends found interesting
            and_(self.id==Friendship3.requester_id,
                 Friendship3.is_confirmed==True,
                 Like.user_id==Friendship3.accepter_id),
            and_(self.id==Friendship4.accepter_id,
                 Friendship4.is_confirmed==True,
                 Like.user_id==Friendship4.requester_id)))
        .order_by(Post.created_at.desc())
        .limit(limit)
        .offset(offset)
        .all()) 
```

**产生这个**

```
SELECT posts.title AS posts_title
FROM friendships AS friendships_1, friendships AS friendships_2, posts LEFT OUTER JOIN friendships AS friendships_3 ON posts.user_id = friendships_3.accepter_id LEFT OUTER JOIN friendships AS friendships_4 ON posts.user_id = friendships_4.requester_id LEFT OUTER JOIN likes ON posts.id = likes.post_id LEFT OUTER JOIN users AS users_1 ON users_1.id = posts.user_id 
WHERE (posts.user_id = %s OR friendships_3.requester_id = %s AND friendships_3.is_confirmed = %s OR friendships_4.accepter_id = %s AND friendships_4.is_confirmed = %s OR friendships_1.requester_id = %s AND friendships_1.is_confirmed = %s AND likes.user_id = friendships_1.accepter_id OR friendships_2.accepter_id = %s AND friendships_2.is_confirmed = %s AND likes.user_id = friendships_2.requester_id) ORDER BY posts.created_at DESC 
LIMIT %s 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:26:29.737

假设我们有 MS SQL 2005

```
With rels
(
   Select f.requesterId as target_id
   From friendships f 
   Where is_confirmed = 1 and f.accepter_id='Your Id'
   Union 
   Select 'Your id'
)
Select p.*
From posts p 
  left join rel r on r.target_id = p.user_id  -- this will be null on for non-target users
  left join likes l on p.post_id=l.post_id -- here we will pick likes
  left join rel r1 on r1.target_id=l.user_id
where coalesce(r1.target_id, r2.target_id) is not null -- telling sql to pick posts we are interested in 
```

或用子查询替换 CTE rel。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T05:53:07.713

以不同的方式想通了。使用 IN 子句进行子查询以检查喜欢该帖子的任何用户是否在我确认的朋友列表中。其他部分非常简单（检查是我写的还是朋友写的）。

# android - 进度条不显示在屏幕上

> ID：10591154
> 
> 赞同：-1
> 
> 时间：2012-05-14T21:13:29.243
> 
> 标签：android, android-activity, progress-bar

填充进度条后，我需要显示第二个活动。我尝试了下面的代码，但它没有显示进度条，只显示了我的第二个活动。

这是代码：

```
 public class MiSuper2 extends Activity {
        String strListas[] = null;
        private ProgressBar mProgress;
        private int mProgressStatus = 0;
        private Handler mHandler = new Handler();
        private StoreData stdArticulos = null;
        public Cursor cursor = null;
        private long fileSize = 0;

        /** Called when the activity is first created. */
        @Override
        public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        stdArticulos = new StoreData(this);

        fileSize = 0;
        setContentView(R.layout.main);
        stdArticulos = new StoreData(this);
        cursor = stdArticulos.leerArticulos();

        mProgress = (ProgressBar) findViewById(R.id.progressbar_activity);

        new Thread(new Runnable() {
            public void run() {
                while (mProgressStatus < 100) {
                    mProgressStatus = doWork();

                    mHandler.post(new Runnable() {
                        public void run() {
                            mProgress.setProgress(mProgressStatus);
                        }
                    });
                }
            }
        }).start();

        if(cursor.moveToFirst()) {
            do{
                strListas[cursor.getPosition()] = cursor.getString(cursor.getPosition());
            }while(cursor.moveToNext());
        }       

        Intent intent = new Intent(MiSuper2.this, PntArticulo.class);
        startActivity(intent);

    }

    public int doWork() {       
        while (fileSize <= 1000000) {
            fileSize++;
            return (int) fileSize;
        }
        return 100;
    }
} 
```

这是 main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="center_horizontal"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/imvLogo"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/presentacion" 
        android:contentDescription="@string/logo"/>

    <ProgressBar
        android:id="@+id/progressbar_activity"
        style="?android:attr/progressBarStyleHorizontal"
        android:layout_width="200dp"
        android:layout_height="wrap_content" android:layout_marginTop="100dp"/>

</LinearLayout> 
```

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:33:39.043

看起来您正在使用该`doWork()`功能来占用时间，以便进度条执行某些操作。即使您编写了一个大循环，它仍然执行得非常快，因此您看不到进度条移动。相反，你想模拟你的线程做一些计算密集型的事情，使用`Thread.sleep()`which 接受一个参数，即睡眠时间（以毫秒为单位）。

尝试将您的代码更改为：

```
new Thread(new Runnable() {
    public void run() {

        while (mProgressStatus < 100) {
            try {
                mProgressStatus += doWork();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

            mHandler.post(new Runnable() {
                public void run() {
                    mProgress.setProgress(mProgressStatus);
                }
            });
        }

        runOnUiThread(new Runnable() {
            @Override
                public void run() {
                    startActivity(new Intent(MiSuper2.this, Second.class));
                }
            });
        }
}).start(); 
```

和...

```
public int doWork() throws InterruptedException {
    Thread.sleep(1000);
    return 1;
} 
```

这将使您的进度条每秒增加 1%。最后，文档`Thread.sleep()`：[https](https://developer.android.com/reference/java/lang/Thread.html#sleep(long) ://developer.android.com/reference/java/lang/Thread.html#sleep(long )

编辑：Ramz 在这个答案上击败了我，但没有解释为什么它是答案。希望我的解释有所帮助。

EDIT2：我认为你编辑了你的问题，因为我开始第二次看它。以前您的 XML 中有一些错误，但现在它已经消失了。无论如何，您现在的问题是您需要在`startActivity()`工作线程内部调用。否则，UI 线程不会等待`doWork()`函数返回，而是在您的应用启动时立即启动另一个 Activity。对不起，我应该在之前提到这一点。我在上面发布的代码随此更改而更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:27:57.580

请尝试此代码 **SplashScreen.java**

```
package com.cud.point;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.widget.ProgressBar;
import android.widget.TextView;

public class SplashScreen extends Activity {

 ProgressBar bar;

 TextView txt;

 int total=0;

 boolean isRunning=false;

 // handler for the background updating

 Handler handler=new Handler() {

 @Override

 public void handleMessage(Message msg) {

 total=total+20;

 String perc=String.valueOf(total).toString();

 txt.setText(perc+"% completed");

 bar.incrementProgressBy(20);

 }

 };

@Override

public void onCreate(Bundle savedInstanceState) {

super.onCreate(savedInstanceState);

setContentView(R.layout.splash);

bar=(ProgressBar)findViewById(R.id.progress);

 txt=(TextView)findViewById(R.id.txt);
 Handler x = new Handler();
 x.postDelayed(new SplashHandler(), 5000);
 }
 class SplashHandler implements Runnable 
 {

    public void run() {
        // TODO Auto-generated method stub
        startActivity(new Intent(getApplication(),YourSecound Activity.class));
        SplashScreen.this.finish();
    }

}

public void onStart() {

 super.onStart();

 // reset the bar to the default value of 0

 bar.setProgress(0);

  // create a thread for updating the progress bar

 Thread background=new Thread(new Runnable() {

 public void run() {

 try {

 for (int i=0;i<5 && isRunning;i++) {

 // wait 100ms between each update

 Thread.sleep(1000);

 handler.sendMessage(handler.obtainMessage());

 }

 }

 catch (Throwable t) {

   }     }     });

 isRunning=true;

  // start the background thread

 background.start();

 }

 public void onStop() {

 super.onStop();

 isRunning=false;

 }

} 
```

**飞溅.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:padding="15px" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="Loading......" />

<TextView
    android:id="@+id/txt"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" 
    android:layout_below="@+id/imageView1"/>

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/splash" />

<ProgressBar
    android:id="@+id/progress"
    style="?android:attr/progressBarStyleHorizontal"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/imageView1"
    android:layout_alignLeft="@+id/imageView1"
    android:max="100" />

</RelativeLayout> 
```

这是我的项目的一个例子，所以请在 xml 文件中进行必要的更改

# java - .txt Java 的文件数

> ID：10591155
> 
> 赞同：-6
> 
> 时间：2012-05-14T21:13:29.533
> 
> 标签：java, count

我需要一个 Java 类的帮助，该类可以计算默认项目目录中 .txt 文件的数量。任何代码或链接都会有所帮助，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T21:17:48.763

```
import java.io.File;
import java.io.FilenameFilter;

public class FileCountFilter {

public File[] findFilesInDir(String dirName){
    File dir = new File(dirName);

    return dir.listFiles(new FilenameFilter() { 
             public boolean accept(File dir, String filename)
                  { return filename.toLowerCase().endsWith(".txt"); }
    } );

}

} 
```

findFilesInDir 方法返回的Length`File[]`将是您要查找的内容。

# c - 如何打开文件以用C读取？

> ID：10591156
> 
> 赞同：6
> 
> 时间：2012-05-14T21:03:34.530
> 
> 标签：c, gcc

当我处理从文件中读取时，这件事让我在 C 编程中感到头疼。

我不明白这两种方法之间的区别：

```
FILE *fd;
fd=fopen(name,"r");  // "r" for reading from file, "w" for writing to file
                      //"a" to edit the file 
```

如果文件无法打开，fd 返回 NULL，对吗？

我使用的第二种方法是：

```
int fd;
fd=open(name,O_RDONLY); 
```

如果打开文件时发生错误，fd 将为 -1。

有人愿意向我解释一下吗？提前致谢：）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-14T21:09:32.847

使用 fopen() 允许您使用 C stdio 库，这比直接使用文件描述符要方便得多。例如，没有内置的等效于 fprintf(...) 的文件描述符。

除非您需要进行低级 I/O，否则 stdio 函数可以很好地服务于绝大多数应用程序。它更方便，并且在正常情况下，正确使用时也一样快。

# c# - MVC 3 中的 MySQL：不支持指定的方法

> ID：10591159
> 
> 赞同：1
> 
> 时间：2012-05-14T21:13:40.167
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, linq, mysql-connector

在我的 MVC 3 项目中，我使用的是 MySQL 连接器。当我尝试调用该方法时，我得到了`Specified method is not supported`错误。为什么 ？

```
 public IList<Order> GetOrders()
    {
        return (from x in db.Order 
                where (x.Address.FirstOrDefault() != null) 
                orderby x.Created //it's a DateTime
                descending select x).ToList(); 
    } 
```

## 编辑

我看有问题`x.Address.FirstOrDefault() != null`

## 编辑2

该代码也有效

```
return (from x in db.Order
             from y in db.Address
             where (y.OrderID == x.OrderID)
        orderby x.Created descending
        select x).ToList(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T21:22:54.793

对于某些 ORM 工具，并非所有 LINQ 方法都支持开箱即用。我知道我过去曾使用 NHibernate 收到过确切的信息。为了实现这一点，您必须重写逻辑以使用更*传统*的方法。尝试这个：

```
return (from x in db.Order 
            where x.Address.Count() > 0 
            orderby x.Created //it's a DateTime
            descending select x).ToList(); 
```

或者，如果由于某种原因您不喜欢上述内容，您的另一种选择是首先通过解析将集合放入内存，然后执行您的逻辑（尽管请记住，这会**更慢**，因为它会从数据库中带回更多数据):

```
return (from x in db.Order
            orderby x.Created //it's a DateTime
            descending select x)
       .ToList() //resolve the query, now work with it in memory from here
       .Where(x => x.Address.FirstOrDefault() != null)
       .ToList(); 
```

# itext - 在 iText 2.0.7 中一次为所有单元格设置固定高度

> ID：10591163
> 
> 赞同：0
> 
> 时间：2012-05-14T21:14:21.323
> 
> 标签：itext

有没有我们可以将每个单元格的高度设置为特定高度的地方？我使用创建了多个单元格`PdfPCell`，高度对所有单元格都是通用的，所以我想一次设置每个单元格的高度以缩短我的代码，目前我正在使用`PdfPCell`'s`setFixedHeight`方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:38:03.967

检索[默认 PdfPCell](http://api.itextpdf.com/itext/com/itextpdf/text/pdf/PdfPTable.html#getDefaultCell%28%29)并设置其固定高度。之后的所有单元格`PdfPTable`将具有相同的高度。但是，必须为每个表重复此操作。

# ios - 如何获取不可见的 UITableViewCell 的值？

> ID：10591165
> 
> 赞同：3
> 
> 时间：2012-05-14T21:14:29.850
> 
> 标签：ios, uitextfield

我有一个表格视图单元格，其中有很多行带有 UITextView。在这些 UITextView 中，用户可以输入值。

我遇到的问题是，如果我想在隐藏行时获取行的值，我会得到 nil。

```
NSString *cellValue = ((UITextField *)[[[self.table cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:1]] contentView] viewWithTag:[self.table cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:1]].tag]).text; 
```

我正在考虑保存用户在 UITextField 中输入的值，但是如果用户单击执行计算的行，则不会调用委托 textFieldDidEndEditing。

我不知道如何以安全的方式获取这些值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T21:20:46.737

您应该以 UITableView 后面的数据源为目标。UITableView 只是一种显示机制，而不是获取数据的主要资源。您可以根据标题获取单元格的索引，但随后我会查看数据源以获取您的实际数据。更好的是，如果可能的话，我只会处理针对数据源本身的所有操作。当您最初构建表格时，您的数据源是某种列表或数组，我确信您可以使用它。您可能需要在视图上创建一个变量并将列表/数组保留在那里以确保您拥有它并且您应该已准备就绪。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:31:29.533

如前所述，您通常会使用`UITableView`数据源来访问它。

也就是说，您可能看不到您期望的数据，因为您正在使用出列单元格。如果单元格的数量很少，您可以考虑将自己的单元格缓存在`NSDictionary`其键是部分和行的某种组合中，并通过您自己的缓存访问它们的视图层次结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-28T09:17:55.507

您可以通过直接引用所需的`tableView`'s来访问当前未显示的行。`dataSource``IndexPath`

您可以通过执行以下操作来实现此目的（使用**Swift 3**时）：

`UITableViewCell cell = self.tableView(self.tableView, cellForRowAt: indexPath)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T21:29:12.823

What is happening most likely is your reusing cells. So when your cell with the textfield goes off screen it gets reused so you cannot access it anymore. What you will need to do is grab the value out the the textfield right after they enter it and store it somewhere. You can use `– textField:shouldChangeCharactersInRange:replacementString:` so that when ever the user enters a character into the textfield you can save the string.

# c# - WPF 上缺少 WM_Messages

> ID：10591171
> 
> 赞同：2
> 
> 时间：2012-05-14T21:14:57.683
> 
> 标签：c#, .net, wpf, winapi

我在通过单击 Windows 任务栏来最小化/恢复我的 wpf 应用程序时遇到问题。有时它起作用，有时它不起作用。因此，[我在应用程序主窗口中添加了一个钩子](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/6b97a6de-0480-4339-8ed0-cb7cdb27bd83/)，以尝试查看事件是否即将到来。有时他们会，有时他们不会。然后我使用[Spy++](http://msdn.microsoft.com/en-us/library/aa264396%28v=vs.60%29.aspx)来查看是否至少启动了事件......是的！他们是。那么为什么我只收到其中一些呢？

```
public MyMainWindow()
{
    InitializeComponent();
    this.SourceInitialized += new EventHandler(OnSourceInitialized);
}

void OnSourceInitialized(object sender, EventArgs e)
{
    HwndSource source = (HwndSource)PresentationSource.FromVisual(this);
    source.AddHook(new HwndSourceHook(HandleMessages));
}

private IntPtr HandleMessages(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)
{
    switch (msg) {
        case  0x0112://WM_SYSCOMMAND:
            switch ((int)wParam & 0xFFF0) {
                case  0xF020://SC_MINIMIZE:
                    break;
                case  0xF120://SC_RESTORE:
                    break;
            }
            break;
    }
} 
```

我有[一个自定义 main](http://sudhirdotnet.wordpress.com/2011/09/27/wpf-adding-a-custom-main-method-in-wpf-application-2/)，我正在使用[Caliburn Micro 和自定义 Bootstrapper](http://caliburnmicro.codeplex.com/wikipage?title=Customizing%20The%20Bootstrapper&referringTitle=Documentation)。

* * *

我想我做了一个简化的案例，可以看到这个问题（不确定这是否是我的问题的同一来源）。我使用 Timer 来模拟一直在等待异步套接字/activeX 响应。可以看到，单击任务栏，有时窗口不会被最大化/最小化。

还是不知道怎么解决。

```
using System;
using System.Threading;
using System.Windows;
using System.Windows.Threading;
using Timer = System.Timers.Timer;

namespace Garbage
{
/// <summary>
/// Interaction logic for MainWindow.xaml
/// </summary>
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        var dispatcherTimer = new DispatcherTimer { Interval = new TimeSpan(0,0,0,0,10) };
        dispatcherTimer.Tick += (o, e) =>
                                    {
                                        var waintingForSocketAsyncRenponseEmulation = new Timer(10);

                                        waintingForSocketAsyncRenponseEmulation.Elapsed += delegate
                                                            {
                                                                lock (this)
                                                                {
                                                                    Monitor.Pulse(this);
                                                                }
                                                            };

                                        waintingForSocketAsyncRenponseEmulation.Start();

                                        lock (this)
                                        {
                                            Monitor.Wait(this);
                                        }
                                    };
        dispatcherTimer.Start();
    }
} 
```

}

# xna - XNA 但不是游戏

> ID：10591187
> 
> 赞同：0
> 
> 时间：2012-05-14T21:16:38.740
> 
> 标签：xna, xna-4.0

我正在做一个程序。但是，与其使用大量后台工作人员和线程来更新 UI，我可以改用 XNA 吗？它是一个应用程序，因此不会部署到 Xbox。

我了解不使用 WinForms 和 WPF 控件的局限性，但这不会成为问题，因为我可以快速编写我需要的唯一控件，即滑块。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T08:15:02.727

您的问题有点不清楚，但希望这可以回答：

是的，您绝对可以使用 XNA。在没有 Game 类的情况下这样做有点烦人，因为使用 XNA 的内容系统加载图形资产需要了解图形设备（这一切都隐藏在 Game 的实现下）。基本上你必须实现你自己的 IServiceProvider（几乎只是一个类型到对象的字典），XNA 的内容系统将使用它来获取 IGraphicsDeviceService，你还必须在任何管理你的图形的对象上实现它（我们称之为 GrahpicsManager，真正的原始：P）。在 GraphicsManager 上，您只需创建一个 PresentationParameters 对象，填写您要设置的所有参数（包括您的窗口或控件句柄和大小），然后使用它来创建一个 GraphicsDevice。

这是我自己的 IServiceProvider 实现（您基本上只是实例化其中一个并在任何地方共享它）：

[http://pastebin.com/1gX7v5b4](http://pastebin.com/1gX7v5b4)

创建 IGraphicsDeviceService 后，请确保将其添加到该服务提供商。我还削减了图形服务的实现，以便您查看。请注意，您需要添加自己的实际使用 GraphicsDevice 的 Draw 方法，并在最后调用 GraphicsDevice.Present。

[http://pastebin.com/wBvDiWBu](http://pastebin.com/wBvDiWBu)

请参阅第 36 行了解我将自己添加到服务容器的位置，以及第 73 行了解我设置图形设备的位置（请注意，设置需要一个 IntPtr 作为它将绘制到的窗口句柄）。

您实际上也可以使用 Game 来制作应用程序，但这很烦人，因为 Game 接管了您的主循环（通常这意味着您必须自己负责在 Update 中推送 Windows 消息泵，我已经尝试过了，它很烂）。

无论如何，希望能回答你的问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T21:25:37.240

虽然 Xna 主要用于游戏，但我相信您可以将其用于应用程序，如果您真的想要大量图形和其他可以在游戏中找到的东西。我没有对音频进行太多尝试，但我相信有一些方法可以为您的 dj 应用程序“混合”它。尝试一下，看看它是否符合您的期望。如果您需要的不仅仅是滑块，您还可以使用 Neoforce Controls (http://neoforce.codeplex.com/) 轻松创建其他控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T01:20:51.887

对于 DJ 应用程序，我不建议使用 XNA。它的音频支持非常有限，并且在尝试向后播放曲目等时会出现问题。此外，如果没有正确预加载，加载资产（音频文件）可能需要一些时间，我认为这对于一个体面的 DJ 库来说会很复杂。

您可能必须使用背景库进行音频管理和播放，但我不确定这有多容易。考虑到 XNA 在访问音频子系统时施加的限制，我还认为加载和播放外部音频文件可能是一个挑战。

# eclipse - 将 EJB 项目更改为 Web 应用程序

> ID：10591188
> 
> 赞同：3
> 
> 时间：2012-05-14T21:16:47.653
> 
> 标签：eclipse, spring, ejb

我在 Eclipse 中创建了一个 Java EE 项目。但现在我决定改用 Spring，所以我希望它是一个更简单的动态 Web 应用程序。我认为这意味着我必须删除“EJB 模块”项目方面并添加“动态 Web 模块”方面。但 Eclipse 拒绝让我这样做，抱怨“无法卸载 EJB 3.1 模块”。我不敢相信 Eclipse 让我的意图变得不可能，那么我该如何正确地做到这一点呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:18:22.577

我能够通过手动编辑`.project`文件来删除 Java EE 方面，更改性质以删除 Java EE 性质：

```
<natures>
    <nature>org.eclipse.jdt.core.javanature</nature>
    <nature>org.eclipse.m2e.core.maven2Nature</nature>
    <nature>org.eclipse.mylyn.wikitext.ui.wikiTextNature</nature>
</natures> 
```

# php - MySQL 性能 - “冗余”与速度/系统性能

> ID：10591192
> 
> 赞同：1
> 
> 时间：2012-05-14T21:17:16.253
> 
> 标签：php, mysql, performance, redundancy

所以......假设我有一个包含三个表的数据库：
表**客户端**
表**数据**
和表**clients_to_data**

而且我有一个 API，它允许客户端访问来自 Table **data**的数据。每个客户端在 Table **clients**中都有一条记录（例如 IP 地址等）。为了记录谁访问了什么，我正在记录表**clients_to_data**（其中包含表**客户端**的 ID 、表**数据**和时间戳。）
每次用户访问我的 API，他登录到**clients_to_data**表。（所以**客户端**和**数据**中的记录不会更新，只是读取。）
我还希望能够获得每个客户端的点击量。很简单，只需查询**clients_to_data**带有 client_id 的表并计算结果。但是随着我的数据库的增长，我将在**clients_to_data**表中拥有数万条记录。这是我的问题：将字段“命中”添加到存储该用户的命中数量并在每次用户查询 API 时递增的表**客户端**
是否是一种更好的做法 所以这将添加到我的数据库中听说一般是坏事。但在这种情况下，我认为它会加快检索点击量的过程。 那么在这种情况下哪种方法更好更快呢？谢谢你的帮助！ **`redundancy`** 

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:27:43.710

显然，从表中选择单个整数列会比从表中选择 count() 行更快。

复杂性的权衡有点没有意义。一种方式是您需要编写更复杂的 sql，另一种方式是您需要在代码中更新/插入 2 个表。

多久查询一次命中数？您的客户会查看它，还是您每月检查一次？如果你只是偶尔看一下，我可能不会太在意选择 count(*) 所花费的时间。

如果您的客户查看每个请求的命中数，那么我会考虑存储命中列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T21:33:43.807

什么时候更快？追加到表会比查找记录和更新记录更快，比读取记录、递增和更新记录要快得多。

然而，“预先计算”的命中将比聚合查询更快地计算它们。

您在回旋处失去的挥杆中获得了什么，您做出的选择取决于您当前的使用模式。那么，您准备好放慢添加命中的速度，以显着提高您的命中数吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T21:32:10.210

现在我们的表结构都已经明确定义了，让我们开始工作吧。

您想在数据库中记录一些内容，即每个客户端访问数据的次数，换句话说，

为每个客户“印象”插入一条记录到表“client_to_data”中。

你担心两件事，

**1\. 冗余
2\. 检索计数时的性能**

存储计数时的性能如何。（插入语句）..？

**这是一个经典场景，我会将要插入的数据写入 memcache，并在一天结束时进行批量插入。**

**更重要的是，我会在将数据插入数据库之前对其进行规范化。至于选择，创建索引。如果是文本，请安装 sphinx。**

谢谢。**

# javascript - {} 和 function(){} 之间的区别

> ID：10591193
> 
> 赞同：0
> 
> 时间：2012-05-14T21:17:23.533
> 
> 标签：javascript

我认为这些是等价的。

```
var __Panel = {
 this.header = null;
};

var __Panel = function() {
 this.header = null;
}; 
```

第一个为 提供编译器错误“预期标识符或字符串”，为 提供`this`“预期'，'” `;`。

有人可以为我澄清一下吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T21:18:21.740

`{}`用于定义对象，`function(){}`用于定义函数。

里面的主体`{}`必须是一系列以逗号分隔的`key: value`对，如下所示：

```
var man = {
  age: 24,
  height: 6,
  occupation: "programmer"
}; 
```

您的示例不起作用有三个原因。首先，`this.header`它不是一个有效的键，因为它包含一个点，`:`而不是`=`用于将键与值分开的标记，并且`,`用于代替`;`分隔键值对。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:28:39.253

这对我来说很有趣：

```
js> var p = { this.header = null; };
js: "<stdin>", line 11: invalid property id
js: var p = { this.header = null; };
js: ..............^
js: "<stdin>", line 11: syntax error
js: var p = { this.header = null; };
js: ..............................^ 
```

对此的夸张解释如下：

犀牛提出了答案：`this.header`文本将被解释为属性 id，而作为属性 id，它是无效的。因此，您了解到`{ }`的是一个“包含”属性的对象，而属性名称不能看起来像`this.header`. 您可以进一步检查“对象”的语法；它看起来很简单`{ propertyId1 : value1, propertyId2 : value2, ...}`。

```
js> var p = { header:0, doit: function(){this.header=null;} }; 
```

这被接受了，实际上“对象语法”得到了尊重；我们定义了一个具有两个属性的对象，一个`header`是整数 0，`doit`另一个是一个函数。

现在你可以想知道为什么有`{this.header=null;}`接受；这是因为您不必将对象的语法与`{}`“分隔”代码“块”的用法混淆，在这种情况下，“包含”函数本身，即其代码。那些`{}`并不代表“赤裸”所代表的同一事物`{}`，而在他们面前的存在则清楚地表明了这一点`function()`。

```
js> p.header;
0 
```

这表明该属性`header`为 0，这是一个简单明了的事实。

```
js> p.doit(); 
```

这将执行属性中保存的函数`doit`。我们期望它发生什么？这个问题源于询问是什么`this`。

```
js> p.header;
null 
```

当我们再次检查属性的内容时`header`，我们看到它被修改为 null。这意味着`this`在函数中的属性`doit`是指“包含”该属性的对象，即对象 p 本身。

**原始的、已删除的社区 wiki 帖子是**：

这对我来说很有趣：

```
js> var p = { this.header = null; };
js: "<stdin>", line 11: invalid property id
js: var p = { this.header = null; };
js: ..............^
js: "<stdin>", line 11: syntax error
js: var p = { this.header = null; };
js: ..............................^
js> var p = { header:0, doit: function(){this.header=null;} };
js> p.header;
0
js> p.doit();
js> p.header;
null 
```

**原帖结束**

所有这些可能以不同的方式回答了这个问题，通过一条路径，以一种默契和隐含的方式，社区 Wiki 模式本可以通过更多的“说话的例子”（通过实践学习和解释错误技术）帮助成长。

但它并没有被“抓住”，而是添加了明确的“演绎”步骤。

# c# - Ninject 3 InRequestScope 没有为同一个请求返回同一个实例

> ID：10591203
> 
> 赞同：10
> 
> 时间：2012-05-14T21:18:00.183
> 
> 标签：c#, asp.net-mvc-3, ninject, ninject-extensions

最近，我将我的一个 MVC3 项目从 Ninject 2 升级到了 Ninject 3。

几分钟后试图找出 InRequestScope 不再可用的原因，我发现它现在是 Ninject.Web.Common 的扩展。

现在，当我尝试运行应用程序时，Ninject 的工作方式就像所有与范围 InRequest 绑定的类型都是 InTransientScope；每次都会创建一个新实例。

在我从 NinjectModule 继承的类中，我有一个像这样的简单绑定：

```
Bind<ViewModel.Activity>().ToSelf().InRequestScope(); 
```

在我的控制器中，我有 2 个带有 Ninject 属性的 ViewModel.Activity 类型的属性。

```
 [Inject]
  public ViewModel.Activity Activity { get; set; }

  [Inject]
  public ViewModel.Activity Activity1 { get; set; } 
```

如果我在调试模式下查看这两个属性的 HashCode 的值，它们都有不同的值，但 HttpContext 是相同的；我有同样的要求。

我错过了如何正确使用新版本的 Ninject.Web.Common.InRequestScope 和新版本的 Ninject 3？

非常感谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T18:13:57.237

**添加为答案，因此可以关闭**

不要使用自定义工厂。只需安装 Ninject.MVC3 并将您的绑定复制到 NinjectWebCommon.cs 文件，然后删除所有旧代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-14T23:09:27.870

Ninject.Web.Common 不能单独使用。您必须使用一些额外的 web 或 wcf 扩展或自己实现 InRequestScope。

# c# - 列表 到 sql "in" 查询

> ID：10591209
> 
> 赞同：4
> 
> 时间：2012-05-14T21:18:46.677
> 
> 标签：c#, sql, linq

我需要列出一个列表并对其进行 Linq，这样我才能得出适合 sql“in”的东西。这就是我现在正在使用的。有没有更清洁的 Linq 方法来获得这个`"(333,333,54445,56667)"`

```
List<int> vendorIds;
string snipet = "";
for (int i = 0; i < vendorIds.Count; i++)
{
    snipet += (i > 0) ? "," + vendorIds[i].ToString() : vendorIds[i].ToString();
} 
```

就是想。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T21:21:10.020

在.NET <= 3.5

```
string.Join(",", vendorIds.Select(x => x.ToString()).ToArray()) 
```

在.NET >= 4

```
string.Join(",", vendorIds) 
```

我更喜欢为自己编写一个方法，例如：

```
string Concat(this IEnumerable<string> items) { ... } 
```

# html - 无论DTD，浏览器如何，都将href img左上对齐

> ID：10591210
> 
> 赞同：0
> 
> 时间：2012-05-14T21:18:51.750
> 
> 标签：html, css

我将如何在不填充当前网页中的任何内容的情况下将`href`图像固定在`top left`页面上，并且无论浏览器和 DTD 如何，我的行为几乎完全相同。

我遇到的问题是我需要向各种网站提供一段代码，将所述图像放在同一个地方，以便有人可以轻松点击。

我假设我将包含一个`DIV`.

```
 <div style="position: absolute;left:0px;top:0px;">
    <a href="some.link.com">
      <img src="someimage.jpg" alt="someimage">
    </a>
  </div> 
```

或者它已经做到了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:25:05.753

如果你想让它固定，我想你应该使用“位置：固定”属性..不是吗？也许 z-index 对您也有用（将 div 放在最高层，然后是其他内容）。

据我了解，您想向某些用户提供一些 HTML，这些用户会将其添加到他们自己的网站（或自己添加，如 ADS）。如果我是对的，您还应该考虑其他 css 属性，这些属性未在您的 div 中定义，但可以在 css 中的不同网站（我的意思是边距、填充等）上定义，并将自动应用于您的 div .

# linux - 用户程序还是内核模块？

> ID：10591214
> 
> 赞同：-1
> 
> 时间：2012-05-14T21:19:05.360
> 
> 标签：linux, events, module, linux-device-driver

一个运行 Linux 的 sbc。我正在运行该板专用于机器人大脑的项目。我计划制作一个监听按钮事件的守护进程。按下按钮时，将触发用户程序。该程序将加载一些驱动程序，例如电机驱动程序、传感器……或者该触发程序最好是模块本身？还有比这更好的方法吗？请提供你的论据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:37:10.537

如果您没有充分的理由在内核中执行此操作，我会选择用户空间。SBC 可能已经将按钮导出为 GPIO 类设备，因此使用 poll 检测更改将非常简单。

# javascript - 为表单元素设置 cookie

> ID：10591215
> 
> 赞同：0
> 
> 时间：2012-05-14T21:19:13.703
> 
> 标签：javascript, forms, cookies

我正在尝试从 from 中获取值，然后在提交时将值转换为 cookie。这就是我所拥有的，但我想知道是否有办法做到这一点，所以我不必为所有变量写出同样的东西。

```
function submitValues(){

var firstName = document.forms["frm1"]["first_name"].value;
var lastName  = document.forms["frm1"]["last_name"].value;
var number    = document.forms["frm1"]["phNum"].value;

setCookie("firstName",firstName,365);
setCookie("lastName",lastName,365);
setCookie("number",number,365);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:38:43.297

您可以通过在变量中保存对表单的引用来缩短它，如下所示：

```
var form = document.forms["frm1"];

var firstName = form["first_name"].value;
//...and so on 
```

或者通过循环遍历`<input>`表单中的所有元素来进一步缩短它：

```
var formInputs = document.forms["frm1"].getElementsByTagName("input");
for (var i=0;i<formInputs.length;i++) {
    setCookie(formInputs[i].name, formInputs[i].value, 365);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T21:41:33.983

如果要为所有表单元素设置 cookie，请使用[DOM2`form.elements`集合](https://developer.mozilla.org/en/DOM/form.elements)：

```
var els = document.forms.frm1.elements;
for (var i=els.length;i--;){
  setCookie(els[i].name, els[i].value, 365);
} 
```

如果您只想要特定的，那么编写您的代码，如下所示：

```
var els = document.forms.frm1.elements;
var cookiesToSet = ['first_name','last_name','phNum'];
for (var i=cookiesToSet.length;i--;){
  var name = cookiesToSet[i];
  setCookie(name, els[name].value, 365);
} 
```

上式中，`els[name]`等价于`document.forms.frm1.elements[name]`。

一般来说，JavaScript 中每个对象的每个属性都可以通过“点符号”（`foo.bar`）或“括号符号”（`foo["bar"]`）访问。当属性名称不是有效标识符（`foo["names[]"]`或`foo["12 freakin' whales!"]`）或从变量（`foo[name]`或`foo["item"+i]`）构造属性名称时，您必须使用后者。

# javascript - 调用javascript函数太多次

> ID：10591216
> 
> 赞同：2
> 
> 时间：2012-05-14T21:19:15.337
> 
> 标签：javascript, jquery, function, call

我刚刚开始使用 Javascript，并且使用不同的代码段多次遇到相同的问题：我有一个创建一种元素类型的函数和一个对这种类型的元素执行某些操作的函数。对我来说很明显我需要在创建元素后调用“做某事”函数，但是当我这样做时，它最终运行的次数比我想要的要多。

这是我的问题的一个例子：

```
function rightClick(){
    $(".element").mousedown(function(e){
        switch (e.which){case 3: alert( $(this).attr("id") )};
    });
};

function doubleClick(){
    var counter = 0;
    $(document).dblclick(function(e){
        counter++;
        elementId = "element" + counter;
        $("#new_elements").append("<div class='element'"          +
                                   "id='"    + elementId + "'"   +
                                   "style='position:absolute;"   +
                                   "top:"    + e.pageY + ";"     +
                                   "left:"   + e.pageX + ";'>"   +
                                    elementId+ "</div>");
    rightClick();
}); 
```

在此示例中，如果我创建 4 个元素并右键单击我创建的第一个元素，我最终会得到 4 个警报框而不是一个。如果我右键单击我创建的第二个元素，我会收到三个警报；第三个：2 个警报；第四种：一次警报。

谁能向我解释为什么会发生这种情况，以及如何解决它，以便每次右键单击一个元素时我只会收到一个警报？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T21:21:09.180

1.  绑定是将事件与 DOM 元素相关联的行为。和类似的`.mousedown`事件只绑定在已经存在的元素上。
2.  每次调用时`rightClick()`，都会将新事件绑定到所有当前`.element`元素。
3.  您可以根据需要将函数绑定到同一个元素，这就是为什么您会看到函数被多次调用的原因。
4.  对于动态元素应该结帐`.on`或`.delegate`像这样工作：

[jQuery.fn.on](http://api.jquery.com/on/) 示例

```
 $(document.body).on("mousedown", ".element", function(e) {
   if (e.which === 3) alert($(this).attr("id"));
 }); 
```

[jQuery.fn.delegate](http://api.jquery.com/delegate/) 示例

```
 $(document.body).delegate(".element", "mousedown", function(e) {
   if (e.which === 3) alert($(this).attr("id"));
 }); 
```

只调用一次，你应该没问题。如果您不使用 jQuery 1.7 或更高版本，您将希望`.delegate()`使用`.on`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:24:05.987

每次将元素插入 DOM 时，您都不需要绑定事件。您可以使用[`.on`](http://api.jquery.com/on/)为动态插入的元素附加事件处理程序。

```
$(document).on('mousedown','.element', (function(e){
    switch (e.which){
            case 3: alert( $(this).attr("id") ); 
            break; 
    };
});

var counter = 0;
$(document).dblclick(function(e){
    counter++;
    elementId = "element" + counter;
    $("#new_elements").append("<div class='element'"          +
                               "id='"    + elementId + "'"   +
                               "style='position:absolute;"   +
                               "top:"    + e.pageY + ";"     +
                               "left:"   + e.pageX + ";'>"   +
                                elementId+ "</div>");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T21:21:41.730

我相信您会多次添加相同的处理程序，这意味着当您单击按钮时，您会将操作重新绑定到相同的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T21:22:04.013

您已将事件处理程序绑定到类“.element”。这意味着页面上每个具有“.element”类的元素都会在发生右键单击时触发该事件。

# autohotkey - 使用 Autohotkey 监听 Eval / RegExp

> ID：10591217
> 
> 赞同：1
> 
> 时间：2012-05-14T21:19:19.677
> 
> 标签：autohotkey

我认为这一定是可能的，但我无法在 autohotkey 的任何地方的文档中找到它

我想做类似的事情：

```
[a-z0-9]::
SoundPlay, %A_WinDir%\Media\[\1].wav
SoundPlay *-1 
```

即听所有键 a 到 z 和 0-9 找到相关的 wav 文件（a.wav 等）并播放它。如果找不到 播放默认声音。

这是出AHK的联盟吗？我应该坚持在python中这样做吗？？！提前谢谢了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T15:02:23.220

您可以使用[热键命令](http://www.autohotkey.com/docs/commands/Hotkey.htm)将所有可能的热键分配给标签。

这里的第一个循环使用了一个技巧，将值转换为它们的[ASCII 码](http://www.asciitable.com/)，进行数学运算，然后将它们转换回字符。逻辑是这样的， “ ***'a'****之后的第 5 个字符是什么？”* **- 它回复**'f'**。**

 **```
#Persistent 

Loop, 26
  Hotkey, % Chr(Asc("a") + A_Index - 1), MyLabel

Loop, 10
   Hotkey, % A_Index - 1, MyLabel
return

MyLabel:
MsgBox You pressed %A_ThisHotkey%
return 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T03:16:37.450

我不知道使用正则表达式指定热键的方法，但这就是我在我的一个脚本中所做的：

```
@::
a::
b::
c::
; (all other alpha keys...)
    ; Pass key on, if not in subscription list
    If(in_edit_screen())
    {
        ; Handle caps lock
        If(GetKeyState("Capslock", "T"))
        {
            ; Send uppercase letter
            StringUpper key, A_ThisHotkey
            Send %key%
        }
        Else
        {
            Send %A_ThisHotkey%
        }
        Return
    }
    ; etc.
    Return 
```

这是当某个窗口聚焦时调用的例程的一部分，但有问题的窗口有几种不同的模式；在其中一种模式下（由`in_edit_screen`标志指示），我只想通过键，而在另一种模式下，我希望键做一些特别的事情。`A_ThisHotkey`是告诉例程用户实际按下哪个键/键组合的变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T11:33:41.253

为什么不在您使用的地方启动脚本：

输入，CI_KeyVar，I L1

然后读出按下了哪个键（变量= CI_KeyVar），做你的事情（检查ascii代码是否在0和Z之间，因为这个输入将作用于任何输入）并重新启动脚本以等待下一个键按....

出路将是触发例如 esc 键，因此脚本停止。**

# ios - iOS xcode 按钮未链接。

> ID：10591218
> 
> 赞同：0
> 
> 时间：2012-05-14T21:19:21.917
> 
> 标签：ios, xcode, button

我的主故事板上有一个按钮。我很确定它已正确链接，但是当我运行模拟器并按下按钮时，它什么也没做。我缺少什么来获得打开 Safari 的按钮？

**视图控制器.h**

```
#import <UIKit/UIKit.h>

@interface testViewController : UIViewController
- (IBAction)openSafari:(id)sender;

@end 
```

**视图控制器.m**

```
#import "testViewController.h"

@interface testViewController ()

@end

@implementation testViewController

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (IBAction)openSafari:(id)sender {
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"www.google.com"]];
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:22:41.167

URL 需要方法和地址，所以试试@"http://www.google.com"。要证明您的操作是否正确连接，请从该方法打印一条日志消息（或使用断点）。

# java - 节点列表的实现

> ID：10591219
> 
> 赞同：2
> 
> 时间：2012-05-14T21:19:23.117
> 
> 标签：java, xml, xpath, implementation, nodelist

我`NodeList`是这样实现的：

```
import java.util.ArrayList;
import java.util.Collections;

import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

public class MyNodeList  implements NodeList{

    //// local member  ... 
    ArrayList<Node> arrayNode   = new ArrayList<Node>() ; 
    ////

    @Override
    public int getLength() {
        return arrayNode.size() ; 
    }

    @Override
    public Node item(int index) {
        return (arrayNode.get(index)).cloneNode(true); 
    }

    public void reverse ()  {
        Collections.reverse(arrayNode);
    }

    public void castNodeToMyNode (NodeList nodeListToCast) {
        int lenList = nodeListToCast.getLength();
        for (int i = 0; i < lenList; i++) {
            this.arrayNode.add(nodeListToCast.item(i)) ; 
        }
    }
    public void appendNodeList (NodeList nodeListToappend) {
        this.castNodeToMyNode(nodeListToappend)  ; 
    }

} 
```

我必须这样做，因为我需要方法`reverse` - 修改`NodeList`.

我的问题是：什么时候使用`evaluate`功能-`Object result = xpath.evaluate(expression, source, XPathConstants.NODESET);`

我想在实现时设置`source`参数。可以将 设置为when 是 的对象吗？我做了这样的事情，但我认为这对.`item``MyNodeList``sourcec``myNodeAfterProbExp.item(indexOfNode)``myNodeAfterProbExp``MyNodeList``evaluate`

提前致谢。

# android - 主题不适用于 Android 上的 DialogFragment

> ID：10591221
> 
> 赞同：46
> 
> 时间：2012-05-14T21:19:27.247
> 
> 标签：android, dialog, styles, themes, compatibility

我正在将旧 Dialogs 切换为 DialogFragment，但主题和样式似乎不起作用。

我正在使用兼容性库 v4 中的 DialogFragment，并且在 onCreate 方法中我尝试调用 setStyle(style, theme); 有很多不同的主题，但对话框总是在运行 Android 4.0.3 的模拟器中显示为“旧”对话框（即，它不显示在 Holo 主题中）。

还有什么我应该做的吗？使用兼容性库是否会禁用 Holo 主题或任何东西？如果是这种情况，我是否应该创建两个 DialogFragment，一个用于旧版本，一个用于新版本？

谢谢！

* * *

这是我的对话框的（简化）代码。我已经尝试过 Theme_Holo_Dialog_NoActionBar 和 Theme_DeviceDefault_Dialog_NoActionBar，但 Android 4 模拟器总是将对话框显示为“旧”对话框，而不是使用 Holo 主题。我究竟做错了什么？:(

```
[...]
import android.support.v4.app.DialogFragment;
[...]

public class AlertDialogFragment extends DialogFragment {

  public static AlertDialogFragment newInstance(int id) {

    AlertDialogFragment f = new AlertDialogFragment();
    Bundle args = new Bundle();
    args.putInt("id", id);
    f.setArguments(args);

 }

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    int style = DialogFragment.STYLE_NORMAL, theme = 0;
    theme = android.R.style.Theme_Holo_Dialog_NoActionBar;
    setStyle(style, theme);     
  }

  @Override
  public Dialog onCreateDialog(Bundle savedInstanceState) {

    mId = getArguments().getInt("id");
    AlertDialog.Builder builder = new AlertDialog.Builder(getActivity())
        .setTitle(mTitle)
        .setMessage(mMessage)
        .setPositiveButton(getString(R.string.btn_ok), new DialogInterface.OnClickListener() {      
            @Override
            public void onClick(DialogInterface dialog, int which) {
                dismiss();                  
            }
        });
        return builder.create();
    } 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-12-13T14:58:42.987

您不应将 AlertDialog.Builder(Context, int) 构造函数与支持库一起使用，因为它仅从 API 11 开始可用。

要为对话框设置主题，请改用 ContextThemeWrapper，如下所示：

```
ContextThemeWrapper context = new ContextThemeWrapper(getActivity(), android.R.style.Theme_Holo_Dialog_NoActionBar);
AlertDialog.Builder builder = new AlertDialog.Builder(context); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-05-18T13:55:44.533

我相信您需要在实际 Dialog 而不是 Fragment 上设置主题

使用此构造函数创建您的 AlertDialog：

```
 AlertDialog.Builder(Context context, int theme) 
```

IE

```
 AlertDialog.Builder builder = new AlertDialog.Builder(getActivity(), theme) 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2014-06-23T22:27:46.930

我只是为此浪费了很多时间，但我终于找到了一种完全在 xml 中执行此操作的方法。

在应用程序主题中，对话框实际上是单独主题的。因此，要使用绿色按钮和绿色 EditText 提示设置所有 DialogFragments 的样式，您可以创建如下样式：

```
<style name="DialogTheme" parent="@android:style/Theme.Holo.Light.Dialog">
    <item name="android:buttonStyle">@style/button_green</item>
    <item name="android:textColorHint">@color/green</item>
</style> 
```

然后将此主题作为 dialogTheme 添加到您的应用程序主题中

```
<style name="MyTheme" parent="android:Theme.Holo.Light">
    <item name="android:dialogTheme">@style/DialogTheme</item>
</style> 
```

非常感谢写[这篇文章](https://sites.google.com/site/androidhowto/how-to-1/customize-alertdialog-theme)的人向我展示了我一直在寻找的道路！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-17T19:18:55.077

这是一个更新的答案，使用 23 的目标 SDK 和 14 的最小 SDK，此代码非常适合我。

问题中代码的主要变化是在构造函数中设置主题，仅覆盖`onCreateDialog()`，并使用 v7 支持库中的 AlertDialog 类。

使用此代码，绿色文本扁平（无边框）按钮显示在 4.4.4 上，而不是带边框的默认灰色按钮。

```
import android.support.v7.app.AlertDialog;
import android.app.Dialog;
import android.support.v4.app.DialogFragment;
import android.content.DialogInterface;
import android.os.Bundle;

public class MyDialog extends DialogFragment {

    String message;

    public MyDialog(String m) {
        message = m;
        int style = DialogFragment.STYLE_NORMAL, theme = 0;
        theme = android.R.style.Theme_Holo_Dialog_NoActionBar;
        setStyle(style, theme);
    }

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {

        return new AlertDialog.Builder(getActivity())
                .setMessage(message)
                .setPositiveButton("OK",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int whichButton) {
                            ((EnterPhoneNumberActivity)getActivity()).doPositiveClick();
                        }
                    }
                )
                .setNegativeButton("EDIT",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int whichButton) {
                            ((EnterPhoneNumberActivity)getActivity()).doNegativeClick();
                        }
                    }
                )
                .create();
    }
} 
```

AppCompatActivity 中的用法：

```
 String message = "test";
    if (message != null) {
        DialogFragment newFragment = new MyDialog(message);
        newFragment.show(getSupportFragmentManager(), "dialog");
    } 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2013-12-20T06:45:38.697

您应该在“onCreateView”中编写这些代码。

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
      Bundle savedInstanceState) {
    getDialog().getWindow().requestFeature(Window.FEATURE_NO_TITLE);
    View view = inflater.inflate(R.layout.dialog_your_theme, container);
    return view;
} 
```

# c# - 如何替换正则表达式中除了最后一个重复的字母之外的所有字母？

> ID：10591222
> 
> 赞同：1
> 
> 时间：2012-05-14T21:19:30.210
> 
> 标签：c#, regex, backreference

这是我想在正则表达式中进行的转换的表格：

```
From       To
================
CAT        CAT
EGG        EGG
A          A
Z          Z
AA         ZA
BB         ZB
ZZ         ZZ
AAA        ZZA
HHHHH      ZZZZH 
```

换句话说，如果字符串是重复 2 次或更多次的相同字母，我想用 Z 替换*除*最后一个之外的所有字母。

我在这里被精神封锁了。到目前为止，这是我想出的，但它不起作用：

```
FIND:     ^(?<=\1*?)([A-Z])(?=\1+)$
REPLACE:  Z 
```

我不确定是否可以在捕获组之前使用反向引用，但无论哪种方式，用第一个替换`\1`都`.`没有帮助。

我正在使用 C#，所以我正在寻找 .NET 风格的正则表达式。我当然可以通过正常的字符串操作来做到这一点，但我有一个特定于业务案例的需要使用正则表达式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T23:40:16.363

有人订购了一些[黑魔法](https://stackoverflow.com/questions/10591222/how-can-i-replace-all-but-the-last-repeated-letter-in-regex#comment13719278_10591901)吗？

```
FIND:    \G([A-Z])(?=\1)
REPLACE: Z 
```

`\G`像 dos 一样将每个匹配项锚定到字符串的开头`\A`，或者锚定到前一个匹配项结束的位置。换句话说，`([A-Z])`你的正则表达式中的 总是试图匹配下一个字符，并且由于前瞻`(?=\1)`- 你知道下一个字符与你刚刚替换的那个相同。

此外，您自我回答中的正则表达式对我不起作用。没有做任何有用的`+`事情（毕竟你只关心下一个角色），但它也不会伤害任何东西。它对我有用的是删除`$`.

更新：我没有注意到字符串必须是两个或多个相同字符*而没有别的*要求。这意味着 the`+`和 the`$`都是必需的。在此期间，我将解决字符串`XX`、、`XXX`和应该单独放置`II`的附加要求。`III`瞧！

```
\G(?!\A(?:XXX?|III?)$)([A-Z])(?=\1+$) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T23:05:40.043

有可能，只需先匹配您想要的字符，然后进行前瞻和后瞻，包括那些锚点而不是主表达式中的锚点，因为您希望表达式逐个字符匹配。

```
([A-Z])(?<=^\1*)(?=\1+$) 
```

但是，它不会非常高效，因为它会遍历每个字符的整个字符串。

你最好使用正则表达式来检测字符串是否由相同的字符组成，然后用正常的字符串替换方法用 Z 替换除最后一个之外的所有字符，或者创建一个长度为原始字符串的 Z 字符串例如，减一，并附加原始字符的第一个字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T01:30:12.093

可能类似匹配然后替换的东西可能会起作用。

```
string [] Samps = {  "CAT",  "EGG",  "A",  "Z",  "AA",  "BB",  "ZZ",  "AAA",  "HHHHH" };
foreach (var item in Samps)
{
    string line = item + "\t\t";
    line += Regex.Match(item, @"^([A-Z])\1+$").Success ?
            Regex.Replace(item, @".(?!$)", "Z") :
            item;
    Console.WriteLine(line);
} 
```

输出

```
CAT             CAT
EGG             EGG
A               A
Z               Z
AA              ZA
BB              ZB
ZZ              ZZ
AAA             ZZA
HHHHH           ZZZZH 
```

# java - 如何让电脑“点击”按钮？

> ID：10591223
> 
> 赞同：-2
> 
> 时间：2012-05-14T21:19:35.583
> 
> 标签：java, button, swt

我正在用 java swt 编写井字游戏程序，并试图弄清楚如何让计算机“单击”按钮以显示 X/O。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T21:22:18.227

我认为您正在寻找[机器人](http://docs.oracle.com/javase/6/docs/api/java/awt/Robot.html)课程。有了这个，您可以移动鼠标并单击它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:41:27.307

首先，您必须将鼠标移动到按钮位置，然后按下并释放鼠标按钮：

```
Robot r = new Robot();
r.mouseMove(500, 340); //Assuming this is the button location.
r.mousePress( InputEvent.BUTTON1_MASK );
r.mouseRelease( InputEvent.BUTTON1_MASK ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T21:22:20.217

参见[`Robot.mousePress(int)`](http://docs.oracle.com/javase/7/docs/api/java/awt/Robot.html#mousePress%28int%29)激活按钮。

# css - 更改光标图像

> ID：10591224
> 
> 赞同：0
> 
> 时间：2012-05-14T21:19:40.563
> 
> 标签：css, attributes, cursor

我用css设置了一个光标图像：

```
#scroll_up{
    display: block; 
    position: absolute; 
    width: 960px; 
    height: 300px; 
    cursor: url(../imgs/cursor_up.png), auto;
} 
```

此样式应用于 div，因此当我翻转此 div 时，我将光标视为图像：

```
<div id="scroll_up">...</div> 
```

我写了一个函数来改变 N 循环后的光标图像：

```
$("#scroll_up").css({ cursor : "url(imgs/cursor_down.png)" }); 
```

但它不起作用......有什么建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T09:29:48.997

我找到了解决方案：

```
$("#scroll_dwn").css({ "cursor" : "url(imgs/cursor_up.png), auto" }); 
```

最后的“汽车”有所不同。希望能帮助到你！

# java - 如何为面向对象工具动态生成代码？

> ID：10591225
> 
> 赞同：0
> 
> 时间：2012-05-14T21:19:55.927
> 
> 标签：java, oop, generics

我有点进退两难。我想创建一个工具，通过从用户那里获取各种参数来动态生成代码。这些代码有一些相似的特性，很少有东西需要从一个代码更改为另一个代码。根据参数，我可以有 15 种不同的代码。到目前为止，我一直在使用 Java 中的文件处理来实现这一点，因为我在不同的文件中创建了代码，但这似乎不是一个好方法。你能推荐一些比这更好的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T09:18:50.540

从 Java 1.6 开始，你可以在内存中编译任何你想要的东西。看看这段代码：

[http://code.google.com/p/cachos/source/browse/trunk/cachos/src/com/peyrona/cachos/InMemoryCompiler.java](http://code.google.com/p/cachos/source/browse/trunk/cachos/src/com/peyrona/cachos/InMemoryCompiler.java)

[http://code.google.com/p/cachos/source/browse/trunk/cachos/src/com/peyrona/cachos/InMemoryExecutor.java](http://code.google.com/p/cachos/source/browse/trunk/cachos/src/com/peyrona/cachos/InMemoryExecutor.java)

在此示例中，您可以看到如何编译存储在内存中的字符串中的源代码，而无需使用磁盘。

来源（西班牙语）：[http ://www.javahispano.org/portada/2011/12/12/compilar-y-ejecutar-codigo-java-en-memoria.html](http://www.javahispano.org/portada/2011/12/12/compilar-y-ejecutar-codigo-java-en-memoria.html)

我想这就是你要找的。

# android - 从 django 应用程序触发的 android 应用程序实现简单通知的最简单方法是什么？

> ID：10591226
> 
> 赞同：0
> 
> 时间：2012-05-14T21:19:56.870
> 
> 标签：android, django, push-notification, pusher

我正在开发我的第一个 Django 应用程序，该应用程序已经在我的站点中的某些部分使用了 Pusher 的服务——它工作得很好。

我想为 Android 添加一个通知应用程序，它会提醒注册用户有关该特定用户的新活动。

我想知道：

1）实现它的最佳方法是什么？我应该为此使用 Pusher 还是应该使用 Google 的推送服务（或者可能是其他服务？）？什么是最简单的？

2) Android 应用程序用户如何通过 Django 身份验证？应用程序如何“知道”用户是否同时使用设备的浏览器登录并且不应该发送通知？

我是安卓新手。如果有人可以回答/描述一般架构/导致适当的文档，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:07:55.250

您可以使用 Android 的云到设备消息传递 (C2DM) - [https://developers.google.com/android/c2dm/](https://developers.google.com/android/c2dm/)。

对于第 3 方，有 Urban Airship - [http://urbanairship.com/](http://urbanairship.com/)。

如果您使用 C2DM，您将获得特定于用户的令牌。您使用该令牌向用户发送消息。

您需要确定用户是否在线（浏览），这样您就不需要发送通知。您可以查看此应用程序：[https](https://bitbucket.org/zalew/django-online-status/wiki/Home) ://bitbucket.org/zalew/django-online-status/wiki/Home 。

# mysql - 如何查看 sql_mode 的具体值？

> ID：10591231
> 
> 赞同：108
> 
> 时间：2012-05-14T21:20:17.960
> 
> 标签：mysql

`sql_mode`MySQL中有一些值：

`ANSI`,

`IGNORE_SPACE`,

`STRICT_TRANS_TABLES`， ETC

我怎样才能看到一个特定的值？手册说：

> 您可以通过发出 SELECT @@sql_mode 语句来检索当前模式。

但它什么也没显示，只是表中的一个空白字段`@@sql_mode`作为列名。

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2012-05-14T21:29:03.150

它对你来说只是空白，因为你没有设置 sql_mode。如果您设置它，那么该查询将向您显示详细信息：

```
mysql> SELECT @@sql_mode;
+------------+
| @@sql_mode |
+------------+
|            |
+------------+
1 row in set (0.00 sec)

mysql> set sql_mode=ORACLE;
Query OK, 0 rows affected (0.00 sec)

mysql> SELECT @@sql_mode;
+----------------------------------------------------------------------------------------------------------------------+
| @@sql_mode                                                                                                           |
+----------------------------------------------------------------------------------------------------------------------+
| PIPES_AS_CONCAT,ANSI_QUOTES,IGNORE_SPACE,ORACLE,NO_KEY_OPTIONS,NO_TABLE_OPTIONS,NO_FIELD_OPTIONS,NO_AUTO_CREATE_USER |
+----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-09-18T11:12:57.530

你也可以试试这个来确定当前的*全局* `sql_mode`值：

```
SELECT @@GLOBAL.sql_mode; 
```

或*会话* `sql_mode`值：

```
SELECT @@SESSION.sql_mode; 
```

我也有感觉，*SQL模式*确实是空的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2021-02-05T06:28:03.070

您需要先使用登录到您的 mysql 终端 `mysql -u username -p password`

然后使用这个：

```
SELECT @@sql_mode; or SELECT @@GLOBAL.sql_mode; 
```

输出将是这样的：

STRICT_TRANS_TABLES,STRICT_ALL_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,TRADITIONAL,NO_AUTO_CREATE_USER,NO_ENGINE_SUB

您还可以通过以下方式设置 sql 模式：

```
SET GLOBAL sql_mode=TRADITIONAL; 
```

# ruby-on-rails-3 - Rails 3.2 尝试减少 jQuery Ajax 远程表单中的重复

> ID：10591234
> 
> 赞同：0
> 
> 时间：2012-05-14T21:20:22.470
> 
> 标签：ruby-on-rails-3, jquery, ruby-on-rails-3.1, coffeescript

我在 Rails 3.2 中开发了一个后端，允许管理员使用 ajax 和 jQuery 执行 CRUD 操作。我已经使用 js.coffee 文件处理了几个控制器/视图来处理 ajax。我的视图的文件结构示例如下。

```
views
  users
    index.html.erb
    _form.html.erb
    _edit_form.html.erb
    _user.html.erb
    create.js.coffee
    edit.js.coffee        
    update.js.coffee
    destroy.js.coffee
  customers
    index.html.erb
    _form.html.erb
    _edit_form.html.erb
    _customer.html.erb
    create.js.coffee
    edit.js.coffee        
    update.js.coffee
    destroy.js.coffee
   email_blasts
     index.html.erb
     _form.html.erb
     _edit_form.html.erb
     _blast.html.erb
     create.js.coffee
     edit.js.coffee        
     update.js.coffee
     destroy.js.coffee
  .
  .
  .
  . 
```

下面是用户视图和客户视图的示例 create.js.coffee。请注意遵循精确模式的实例变量和 div 名称。下面的所有咖啡脚本都遵循我上面列出的所有视图中的确切结构。上面列出的所有 create.js.coffee 文件实际上是相同的。我的问题是减少重复的最佳方法是什么？这会是我应该为其创建插件的东西吗？我应该把它放在一个助手中......等等。我不确定如何在 Rails 中处理这个问题，因为我是一名前 php 程序员 :( 任何人的帮助将不胜感激！

用户视图的 create.js.coffee：

```
$('#errors').empty()
$('#errors').show()
<% if @user.errors.any? %>
  $('<%= escape_javascript(render :partial => "errors", :locals => {:target => @user })%>')
    .appendTo('#errors')
<% else %>
  $('<%= escape_javascript(render(:partial => @user))%>')
    .appendTo('#user_table')
    .hide()
    .fadeIn(200)
$('#errors').hide()
$('#new_user')[0].reset()
$('#users_count').html '<%= users_count %>'
<% end %>
$('#error_close').click ->
  $('#errors').fadeOut() 
```

客户视图的 create.js.coffee

```
$('#errors').empty()
$('#errors').show()
<% if @customer.errors.any? %>
  $('<%= escape_javascript(render :partial => "errors", :locals => {:target => @customer })%>')
    .appendTo('#errors')
<% else %>
  $('<%= escape_javascript(render(:partial => @customer))%>')
    .appendTo('#customer_table')
    .hide()
    .fadeIn(200)
  $('#errors').hide()
  $('#new_customer')[0].reset()
  $('#customers_count').html '<%= customers_count %>'
<% end %>
$('#error_close').click ->
  $('#errors').fadeOut() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T11:44:45.233

您应该构建您的代码，如果您想重用它，请停止混合 javascript 和 erb。制作完成这项工作的 JavaScript 类，并将数据放在页面中的脚本标记旁边......

尝试使用一些框架，通过提供像 Backbone.js 这样的结构来帮助你。

这可能对您有用：

*   [http://documentcloud.github.com/backbone/](http://documentcloud.github.com/backbone/)
*   [http://backbonetutorials.com/](http://backbonetutorials.com/)
*   [http://ricostacruz.com/backbone-patterns/](http://ricostacruz.com/backbone-patterns/)

或凌乱的方式：

```
# Function 
foo = (condition, firstBlock, secondBlock) ->
  $('#errors').empty()
  $('#errors').show()
  if condition
    firstBlock
      .appendTo('#errors')
  else
    secondBlock
      .appendTo('#customer_table')
      .hide()
      .fadeIn(200)
    $('#errors').hide()
    $('#new_customer')[0].reset()
    $('#customers_count').html '<%= customers_count %>'
  $('#error_close').click ->
    $('#errors').fadeOut()

# Execution
foo(<% @user.errors.any? %>, $('<%= stuff %>'), $('<%= moreStuff %>')) 
```

# sockets - .NET：如何在读取超时后继续使用套接字？

> ID：10591235
> 
> 赞同：0
> 
> 时间：2012-05-14T21:20:28.557
> 
> 标签：sockets, timeout

在我的应用程序中，我想要一个轮询循环，它会阻止套接字接收操作，但会在 100 毫秒后超时。这将允许我在需要时退出循环（例如，用户单击 UI 中的某些内容），同时避免使用繁忙循环或 Thread.sleep。

但是，似乎一旦打开 .NET 套接字，它只能超时一次。在第一次超时之后，任何会阻塞的调用都会立即抛出异常。

根据[这个问题](https://stackoverflow.com/questions/5973342/how-to-handle-timeout-in-async-socket)，“你不能超时或取消异步`Socket`操作。” 为什么不？有没有更好的方法来解决 .NET 世界中的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T14:08:53.080

要在 .NET 套接字上编写非忙轮询循环，可以使用 Poll 套接字方法，如下所示：

```
for (keepGoing) {
    if (mySocket.Poll(1000 * timeout_milliseconds, SelectMode.SelectRead)) {
        // Assert: mySocket.Available > 0.
        // TODO: Call mySocket.Receive or a related method
    }
} 
```

在这种情况下，`Poll`如果在指定的超时时间内没有数据可从套接字读取，则返回 false。如果另一个线程`keepGoing`想要干净地关闭轮询循环，它可以重置为 false。

# php - Dojo 中的 SimpleSaveWriteStore - 如何读取元素

> ID：10591238
> 
> 赞同：1
> 
> 时间：2012-05-14T21:20:33.857
> 
> 标签：php, javascript, ajax, json, dojo

一般是dojo和javascript的新手。我正在使用一段代码，该代码需要一个不同的按钮，具体取决于 php 数据库查询返回的内容。php脚本已经写好了，我目前的代码是：

```
var store = new SimpleSaveWriteStore( {url: "info_get.php"} ); 
```

info_get.php 将数据作为 JSON 对象返回，但访问 store 内的数据成员的语法是什么？我已经搜索过这个，但我在 SimpleSaveWriteStore 上找不到很多文档。

TL;DR - 我将如何访问在上述代码中检索到的特定数据？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:05:57.130

`SimpleSaveWriteStore`不是 Dojo 的一部分，所以我假设这是您从中获取代码的地方：

[http://kennethfranqueiro.com/2010/06/custom-save-logic-itemfilewritestore/](http://kennethfranqueiro.com/2010/06/custom-save-logic-itemfilewritestore/)

此代码扩展了`dojo.data.ItemFileWriteStore`，您可以查询商店。

[http://dojotoolkit.org/reference-guide/1.7/dojo/data/ItemFileReadStore.html#query-syntax](http://dojotoolkit.org/reference-guide/1.7/dojo/data/ItemFileReadStore.html#query-syntax)

有几点需要注意。Dojo 正在转向`dojo.store`api 而不是`dojo.data`api（即 ItemFileRead 和 ItemFileWrite 存储）。dojo store api 文档可以在以下位置找到：

[http://dojotoolkit.org/reference-guide/1.7/dojo/store.html](http://dojotoolkit.org/reference-guide/1.7/dojo/store.html)

此外，如果您从 php 脚本返回的数据非常简单，则可能甚至不需要存储。您可以`dojo.xhr`用来发出请求并获取 json 数据。然后只需使用 json 数据来获取您需要的值。数据和存储 api 用于`dojo.xhr`获取数据。`dojo.xhrGet`可以在以下位置找到文档

[http://dojotoolkit.org/reference-guide/1.7/dojo/xhrGet.html](http://dojotoolkit.org/reference-guide/1.7/dojo/xhrGet.html)

# php - Web 服务 - PHP Zend（空白页 - 无错误）

> ID：10591239
> 
> 赞同：0
> 
> 时间：2012-05-14T21:20:34.217
> 
> 标签：php, web-services, zend-framework, soap, wsdl

我制作了我的代码的简单版本。它没有给出任何错误，但它根本不起作用。（我为 PHP 启用了 Soap）

带函数的类：（Metodo.php）

```
class Teste {

    /*
    * @return string
    */
    function SayHello() {
        return "Hello, WORLD";
    }

} 
```

**服务器：**（Server.php）

```
<?php

require_once('Metodo.php');

if($_SERVER['QUERY_STRING'] == "wsdl") {

    try {

        require_once('Zend/Soap/AutoDiscover.php');
        $wsdl = new Zend_Soap_AutoDiscover();
        $wsdl->setClass('Teste');
        $wsdl->handle();

    }catch(exception $e) {
        echo $e->getMessage();
    }

} else {

    $wsdl_url = sprintf('http://%s%s?wsdl', $_SERVER['HTTP_HOST'], $_SERVER['SCRIPT_NAME']);

    require_once('Zend/Soap/Server.php');
    $server = new SoapServer($wsdl_url);
    $server->setClass('Teste');
    $server->handle();

}

?> 
```

**客户端：**（Client.php）

```
<?php

    require_once('Zend/Soap/Client.php');
    $wsdl_url = "http://localhost:8090/WebService/Server.php?wsdl";
    $client = new Zend_Soap_Client($wsdl_url);

    try {
        echo $client->SayHello();
        echo ":)";
    } catch (SoapFault $e) {
        echo $e->getMessage();
    }

    ?> 
```

它只是打印“:)”，没有错误，但它不会调用方法 SayHello()。如果有人愿意帮助我，我将不胜感激。真的。太感谢了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T22:19:54.623

一些东西：

```
$server = new SoapServer($wsdl_url); 
```

应该：

```
$server = new Zend_Soap_Server($wsdl_url); 
```

没有它也可以工作，但是既然你需要在 Zend Soap Server 类之前就行了，你不妨使用它。

在 Server.php 中：

```
$wsdl_url = sprintf('http://%s%s?wsdl', $_SERVER['HTTP_HOST'], $_SERVER['SCRIPT_NAME']); 
```

确保此 URL 包含正确的端口（因为您使用的是端口 8090）。如果 HTTP_HOST 有或没有，我不记得了。

然后最重要的是，在你的课堂上：

```
/*
* @return string
*/
function SayHello() {
    return "Hello, WORLD";
} 
```

应该：

```
/**
* @return string
*/
function SayHello() {
    return "Hello, WORLD";
} 
```

请注意评论开头的额外 * 。自动发现类使用 PHPDoc 块工作，该块必须以 /** 开头才能有效。（很容易错过！）

如果在这些更改之后仍然无法正常工作，请绝对确保 PHP 没有缓存您的错误 WSDL 文件（默认情况下，PHP 缓存 WSDL 文件）。最简单的方法是从 /tmp/ 文件夹（或系统上的等效文件夹）中删除所有以“wsdl”开头的文件。进行这些更改后，我使用您的代码得到了正确的输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T22:10:05.297

应该在某处记录错误。检查服务器和 PHP 日志。SOAP 客户端还有一些“跟踪/调试”设置。启用这些功能后，您可能会在上次通话/回复中获得更多信息。

没有更多信息，这里有一些观察：

*   非标准函数名。在 ZF camelCase 是规范。
*   非标准端口，不知道为什么但可能相关

您是否尝试过使用浏览器访问 WSDL？它解决了吗？

freenodes 的#zftalk 频道 (IRC) 也是一个很好的资源。如果您确实在那里找到答案，请在此处回复。

# sql - 这个嵌套查询有什么问题？

> ID：10591242
> 
> 赞同：2
> 
> 时间：2012-05-14T21:21:00.230
> 
> 标签：sql, postgresql

我正在尝试编写一个查询来返回存储在数据库中的最新版本的市场索引的 id。

```
SELECT miv.market_index_id market_index_id from ref_market_index_version miv 
INNER JOIN ref_market_index mi ON miv.market_index_id = mi.id 
WHERE mi.short_name='dow30' 
AND miv.version_num = (SELECT MAX(m1.version_num) FROM ref_market_index_version m1 INNER JOIN ref_market_index m2 ON m1.market_index_id = m2.id ) 
```

上面的 SQL 语句可以（大致）翻译成以下形式：

```
SELECT some columns FROM SOME CRITERIA MATCHED TABLES 
WHERE mi.short_name='some name'
AND miv.version_num = SOME NUMBER 
```

我不明白的是，当我提供一个实际数字（而不是子查询）时，SQL 语句有效——而且，当我测试用于确定最新版本号的 SUB 查询时，它也有效——但是，当我尝试在外部（父？）查询中使用子查询返回的结果，它返回 0 行 - 我在这里做错了什么？

顺便说一句，我还尝试了一个`IN CLAUSE`而不是严格的相等匹配，即

```
... AND miv.version_num IN (SUB QUERY) 
```

这也导致了 0 行，尽管和以前一样，当使用硬编码版本号运行父查询时，我得到 1 行返回（如预期的那样）。

顺便说一句，我正在使用 postgeresql，但我更喜欢与 db 无关的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T21:33:46.330

问题可能是“dow30”不存在 max(version_num)。

尝试以下相关子查询：

```
SELECT miv.market_index_id market_index_id
from ref_market_index_version miv  INNER JOIN
     ref_market_index mi
     ON miv.market_index_id = mi.id 
WHERE mi.short_name='dow30' AND
      miv.version_num = (SELECT MAX(m1.version_num)
                         FROM ref_market_index_version m1 INNER JOIN
                              ref_market_index m2
                              ON m1.market_index_id = m2.id
                         where m1.short_name = 'dow30'
                        ) 
```

我在子查询中添加了 where 子句。

# javascript - 有没有办法使比较运算符成为变量？

> ID：10591243
> 
> 赞同：7
> 
> 时间：2012-05-14T21:21:07.050
> 
> 标签：javascript, comparison, operators

类似于[python：使变量等于运算符（+，/，*，-）](https://stackoverflow.com/questions/7815938/python-make-a-variable-equal-an-operator)

我有一些代码，用户可以在其中选择要运行的比较类型和要比较的值。我很想知道 Javascript 中是否有任何方法可以将该用户提供的比较值转换为实际比较，从而允许我执行以下操作：

```
if (user_val user_comparison other_val) {
    do_something();
} 
```

而不必做类似的事情：

```
if (user_comparison = '<') {
    if (user_val < other_val) {
        do_something();
    }
else if (user_comparison = '<=') {
    if (user_val <= other_val) {
        do_something();
    }
....etc 
```

请注意，如果任何比较匹配，将执行相同的代码。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-14T21:29:25.783

No that is not possible. But you can structure your code in a better way. For example you can have a lookup table:

```
var operator_table = {
    '>': function(a, b) { return a > b; },
    '<': function(a, b) { return a < b; }
    // ...
}; 
```

and later:

```
if(operator_table[user_comparison](user_val, other_val)) {
    // do something
} 
```

Of course you should also handle the case when `user_comparison` does not exist in the table.

These also gives you a better control over allowed and not allowed operators.

Here is a [**DEMO**](http://jsfiddle.net/jonypawks/Cq8Hd/) create by [@Jesse](https://stackoverflow.com/users/627918/jesse).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T21:27:47.893

Assuming that you are checking the user provided operands and operators properly to ensure that they contain the data you want instead of other javascript executable code, you can concatenate the two operands with the operator in between and feed it to `eval()` to get it executed.

Now, `eval()` is **dangerous** because it can execute any JavaScript code. The user can feed executable and possibly malicious JavaScript code as the operator and `eval()` would evaluate it. Therefore, when you do the concatenation, you should do it after validating that the operand is safe. To stress this point, I'll write one of the most important tenets of computer security in large fonts:

> # All input is evil until proven otherwise.

Also, note that `eval()` calls the JavaScript interpreter to interpret, compile and execute your code. This is slow. While you may not notice any observable performance issue if you are just using `eval()` once in a while, you may notice performance issues if you are calling `eval()` very frequently, say, on every keyevent.

Considering these drawbacks of `eval()`, you might want to go for a neater solution like the one posted by Felix Kling. However, it is also possible to solve this problem using `eval()` in a safe manner as shown below:

```
function compare(a, op, b)
{
  // Check that we have two numbers and an operator fed as a string.
  if (typeof a != 'number' || typeof b != 'number' || typeof op != 'string')
    return

  // Make sure that the string doesn't contain any executable code by checking
  // it against a whitelist of allowed comparison operators.
  if (['<', '>', '<=', '>=', '==', '!='].indexOf(op) == -1)
    return

  // If we have reached here, we are sure that a and b are two integers and
  // op contains a valid comparison operator. It is now safe to concatenate
  // them and make a JavaScript executable code.
  if (eval(a + op + b))
    doSomething();
} 
```

Note that validating the input against a whitelist is almost always a better idea than validating it against a blacklist. See [https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet#White_List_Input_Validation](https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet#White_List_Input_Validation) for a brief discussion on it.

Here is a demonstration of this solution: [http://jsfiddle.net/YrQ4C/](http://jsfiddle.net/YrQ4C/) (Code also reproduced below):

```
function doSomething()
{
  alert('done something!')
}

function compare(a, op, b)
{
  if (typeof a != 'number' || typeof b != 'number' || typeof op != 'string')
    return

  if (['<', '>', '<=', '>=', '==', '!='].indexOf(op) == -1)
    return

  if (eval(a + op + b))
    doSomething();
}

// Positive test cases
compare(2, '<', 3)
compare(2, '<=', 3)

// Negative test cases
compare(2, '>', 3)
compare(2, '>=', 3)

// Attack tests
compare('alert(', '"attack!"', ')')

// Edit: Adding a new attack test case given by Jesse
// in the comments below. This function prevents this
// attack successfully because the whitelist validation
// for the second argument would fail.
compare(1, ';console.log("executed code");2==', 2) 
```

Edit: Demo with Jesse's test case included: [http://jsfiddle.net/99eP2/](http://jsfiddle.net/99eP2/)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-14T21:37:42.523

由于@Susam Pal 代码不起作用。我正在发布一个工作版本

```
<html>
  <head>
   <script>
       function CompareSomething(val1, compareString, val2) {  
           eval('if(' + val1 + ' ' + compareString + ' ' + val2 + '){conditionPassed();}else{conditionFailed();}'); 
  }
  function compare(a, op, b) { 
      if (eval(a + op + b))
          conditionPassed();
      else
         conditionFailed();
  }
  function conditionPassed() {
      alert('condition passed');
  }
  function conditionFailed() {
      alert('condition failed');
  }
    </script>
  </head> 
<body>
a:<input id='txt1' type="text" />&nbsp;op:<input id='txt2' type="text" />&nbsp;b:<input id='txt3' type="text" /><br/>
<button id='compare'  onclick='CompareSomething(document.getElementById("txt1").value,document.getElementById("txt2").value,document.getElementById("txt3").value)'>Compare Esen Method</button><br/>
<button id='compare'  onclick='Compare(document.getElementById("txt1").value,document.getElementById("txt2").value,document.getElementById("txt3").value)'>Compare Susam Method</button>
  </body>
 </html> 
```

# facebook - 查询 Facebook 以收集某个地区所有生日的信息

> ID：10591247
> 
> 赞同：0
> 
> 时间：2012-05-14T21:21:22.483
> 
> 标签：facebook, uri, facebook-fql

第一次海报所以请温柔。我正在寻找一种运行 FQL 查询的方法，该查询将返回给定地理区域的所有生日。例如：返回居住在俄勒冈州波特兰市 50 英里范围内的每个人的所有（公开共享或可用的访问令牌）生日。

我已经通过简单的查询使用了 FQL，但是一旦我遇到了多查询的东西，它就会变得更加混乱。Facebook 的开发人员页面提供了一个在 PHP 中运行查询的示例，但我只想找出正确的 URI 变量并在浏览器窗口中手动完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:34:48.223

我假设您是在询问当前/应用用户的朋友？

如果是这样，您最好只提取所有朋友的生日和当前位置，以及朋友指定位置的位置，进行自己的匹配 - API 不会让您按当前位置查询用户

# ruby-on-rails - 康康能力定义：整个控制器作为一个对象

> ID：10591249
> 
> 赞同：0
> 
> 时间：2012-05-14T21:21:39.210
> 
> 标签：ruby-on-rails, controller, cancan

我的问题绝对是理论上的，例如“这样做对吗？”。我特别是 Rails 和一般的 Ruby 新手，我正在尝试将 Cancan 自动化解决方案用于我的 Rails 应用程序。

假设我们有一个像这样的简单控制器，一对关联的视图和一个带有 DB 表的用户模型。

```
class UsersController < ApplicationController
  def index
    @users = User.all
  end
  def show
    @user = User.find(params[:id])
  end
end 
```

目标是将“index”方法的访问权限限制为除管理员之外的所有人，并允许普通用户仅查看他们自己的页面，例如允许 id==5 的用户查看页面“users/5”。对于这个范围，我为 Cancan 创建了一个能力类。这里是：

```
class Ability
  include CanCan::Ability

  def initialize user, options = {}
    default_rules
    if user
      admin_rules(user) if user.role.eql? "admin"
      player_rules(user) if user.role.eql? "player"
    end
  end

  def admin_rules user
    can :read, UsersController
  end

  def player_rules user
    can :read, User do |user_requested|
      user_requested.id == user.id
    end 
  end

  def default_rules 
  end
end 
```

我的问题是：如果我没有方便的 User 类型的对象，我应该在“can”方法中使用 UsersController 作为对象吗？稍后通过控制器的“index”方法中的“authorize! :show, UsersController”应用它。还是应该以其他方式完成？谢谢你的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:35:52.780

不，您不想将 UsersController 添加到 CanCan。

CanCan 旨在授权资源，而不是 Rails 控制器。

我建议如下：

```
def initialize(user)
  if user.is_admin?
    can :manage, User
  else
    can :manage, User, :id => user.id
  end
end 
```

这将只允许用户访问他自己的用户，除非他是管理员。请参阅CanCan Wiki 中的[定义能力页面](https://github.com/ryanb/cancan/wiki/defining-abilities)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T01:39:09.637

在 wiki 中，我找到了另一种设置能力的方法。不过，它有点先进，[请在此处查看](https://github.com/ryanb/cancan/wiki/Abilities-in-Database)。

```
 ApplicationController.subclasses.each do |controller|
        if controller.respond_to?(:permission)  
          clazz, description = controller.permission
          write_permission(clazz, "manage", description, "All operations")
          controller.action_methods.each do |action|
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T21:47:02.690

我使用了一个符号，例如，在技能类中

```
def initialize(user)
  if user.is_admin?
    can :any, :admin
  end
end 
```

并在控制器中

```
authorize! :any, :admin 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T07:42:07.187

*+1 @Tigraine。*

按照他的指示...

```
class Ability
  include CanCan::Ability

  def initialize user, options = {}
    default_rules
    if user
      admin_rules(user) if user.role.eql? "admin"
      player_rules(user) if user.role.eql? "player"
    end
  end

  def admin_rules user
    can :manage, User
  end

  def player_rules user
    can :manage, User :id => user.id
  end

  def default_rules 
  end
end 
```

并在您的控制器中执行此操作...

```
class UsersController < ApplicationController
  load_and_authorize_resource
  # => @users for index
  # => @user for show

  def index
  end
  def show
  end
end 
```

有关 load_and_authorize_resource 的详细信息，请参阅[此链接的底部](https://github.com/ryanb/cancan/wiki/Controller-Authorization-Example)

# jquery - 如何对齐两个 div 的底边？

> ID：10591255
> 
> 赞同：0
> 
> 时间：2012-05-14T21:21:49.710
> 
> 标签：jquery, html, css, grid, alignment

我在网格的不同列中有几个`div`框，我想识别底部边缘比任何其他框高不到 50px 的框，并调整其高度以确保它们在底部“对齐”。

见小提琴：http: [//jsfiddle.net/YFURR/](http://jsfiddle.net/YFURR/)

在该示例中，我想确定 box1 和 box4 的底边彼此之间的距离小于 50px，并将 box4 的高度扩展为“对齐”到 box1 的底边。与 box2 和 box5 相同。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:41:42.163

您可以设置一个高度的CSS：100％；

.mydivs { 显示：块；高度：100%；}

要使 100% 高度起作用，还要确保您的包含元素设置了高度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T21:32:31.820

我不是 100% 确定您要做什么，但 css min-height 可能是您正在寻找的。

```
your_selector {
    min-height:50px;
} 
```

# wordpress - 仅在使用 Nginx 重写的根上从 URL 中删除 index.php

> ID：10591258
> 
> 赞同：4
> 
> 时间：2012-05-14T21:22:16.213
> 
> 标签：wordpress, url-rewriting, seo, nginx, ipb

我使用 Wordpress 作为我网站的根目录，使用 Invision Power Boards 作为论坛。

```
http://localhost -> Wordpress
http://localhost/forum -> IPB 
```

我已经使用 Nginx-rewrite 从 Wordpress URL 中成功删除了“index.php”，但是当我尝试在 IPB 上使用 SEO 友好 URL 时，nginx 只是返回到 Wordpress 的 404 页面。

我的配置是这样的：

```
#This removes "index.php" from Wordpress URLs
location / {
   index index.php index.html index.htm;
   try_files    $uri $uri/ /index.php?q=$uri&$args;
} 
```

然后我按照此链接修改我的 nginx conf 文件，以便能够使用 IPB 的 SEO 友好 URL：http: [//www.devcu.com/forums/topic/262-furl-friendly-urls-with-ipb-和-nginx/](http://www.devcu.com/forums/topic/262-furl-friendly-urls-with-ipb-and-nginx/)

```
#This part is to be able to use IPB SEO
location /forum/ {
    index index.php;
    try_files $uri $uri/ /forum/index.php?$uri&$args;
    rewrite ^ /index.php? last;
} 
```

当我单击论坛上的链接时，`(for example: http://localhost/forum/index.php/forum/51-sport/)`nginx 只会将我重定向到`(http://localhost/forum/forum/51-sport/)`显示 Wordpress 404 错误页面的页面。

我对正则表达式知之甚少，因此将不胜感激。

* * *

这是我修改后的整个 conf 文件，有点乱我接受。

```
server {
    listen      80; ## listen for ipv4; this line is default and implied
    #listen     [::]:80 default ipv6only=on; ## listen for ipv6

    root    /home/user_name/public_html;

    access_log  /var/log/nginx/a/access.log;
    error_log  /var/log/nginx/a/error.log

    server_name localhost;
    server_tokens off;

    location / {
        try_files   $uri $uri/ @wordpress;
    }

    location @wordpress {
        fastcgi_pass php-fpm;
            fastcgi_param SCRIPT_FILENAME /home/user_name/public_html$fastcgi_script_name;
            include /etc/nginx/fastcgi_params;
            fastcgi_index index.php;
        fastcgi_param SCRIPT_NAME /index.php;
    }

    location /forum {
        try_files $uri $uri/ try_files $uri $uri/ /forum/index.php?q=$uri;
    }

    location /forum/ {
        try_files $uri $uri/ try_files $uri $uri/ /forum/index.php?q=$uri;
    }

    #location / {
        #index      index.php index.html index.htm;
        #try_files  $uri $uri/ /index.php?q=$uri&$args;
    #}

    location = /favicon.ico {
        log_not_found off;
        access_log off;
    }

    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }

    location ~ \.php$ {
        fastcgi_split_path_info ^(/)(/.*)$;
    }

    # Add trailing slash to */wp-admin and */forum requests.
    rewrite /wp-admin$ $scheme://$host$uri/ permanent;

    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9001
        #location ~ \.php$ {
    #   fastcgi_split_path_info ^(/)(/.*)$;
    #   fastcgi_index   index.php;
        #       fastcgi_param SCRIPT_FILENAME /home/user_name/public_html$fastcgi_script_name;
        #       fastcgi_param PATH_INFO $fastcgi_script_name;
        #       include /etc/nginx/fastcgi_params;

        #REMOVE THIS        
        #fastcgi_read_timeout 60000;
        #fastcgi_send_timeout 6000;
        #}
} 
```

自上一篇文章以来，我一直在使用 IPB 的 SEO 配置，并设法从 URL 中删除“index.php”。当然不影响结果。但似乎`location /`决定了要做什么，因此链接被视为 Wordpress 永久链接。

* * *

**编辑 - 解决方案**

```
 # Upstream to abstract backend connection(s) for php
upstream php {
#        server unix:/tmp/php-cgi.socket;
        server 127.0.0.1:9001;
}

server {
        ## Your website name goes here.
        server_name localhost;
        ## Your only path reference.
        root /home/username/public_html;
        ## This should be in your http block and if it is, it's not needed here.
        index index.php;

        location = /favicon.ico {
                log_not_found off;
                access_log off;
        }

        location = /robots.txt {
                allow all;
                log_not_found off;
                access_log off;
        }

        location / {
                # This is cool because no php is touched for static content
                try_files $uri $uri/ /index.php;
        }

    location /forum {       
        try_files $uri $uri/ /forum/index.php;
        rewrite ^ /forum/index.php? break;
    }

    location ~ ^/forum/index.php {
        if ($args != "") {
            rewrite ^ http://www.google.com/ permanent;
        }
        try_files $uri $uri/ /forum/index.php;
        rewrite ^ /forum/index.php? last;
    }

    location /forum/admin/ {
        try_files $uri $uri/ /forum/admin/index.php;
        rewrite ^ /forum/admin/index.php? last;
    }

        location ~ \.php$ {
                #NOTE: You should have "cgi.fix_pathinfo = 0;" in php.ini
            include /etc/nginx/fastcgi_params;
                fastcgi_intercept_errors on;
                fastcgi_pass php;
        }

        location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
                expires max;
                log_not_found off;
        }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-06-10T03:38:57.963

我也在 nginx 上使用 wordpress 和 ipb，现在配置，我将 wordpress 永久链接添加到 ipb 配置并打开 seo 重写 URL，强制友好 URL

```
location / {
try_files $uri $uri/ /index.php?$args;
} 
```

它对我有用

# javascript - 画布绘图应用程序无法在 Firefox 中运行

> ID：10591261
> 
> 赞同：0
> 
> 时间：2012-05-14T21:22:31.253
> 
> 标签：javascript, html, canvas

我正在研究这个小绘图应用程序类型的东西，但它在 Firefox 中不起作用。不过，它在 chrome 中运行良好。这是javascript，然后我在HTML中有一个常规的旧画布元素。任何帮助表示赞赏！

```
/* FOR THE DRAWING APPLICATION */
/* =========================== */

var canvasMouse, contextMouse;

var started = false;
var x, y;

function initMouse() {

    // Get the drawing canvas
    canvasMouse = document.getElementById('drawing');
    contextMouse = canvasMouse.getContext('2d');

    // Add some event listeners so we can figure out what's happening
    // and run a few functions when they are executed.
    canvasMouse.addEventListener('mousemove', mousemovement, false);
    canvasMouse.addEventListener('mousedown', mouseclick, false);
    canvasMouse.addEventListener('mouseup', mouseunclick, false);

}

function mouseclick() {
    // When the mouse is clicked. Change started to true and move
    // the initial position to the position of the mouse
    contextMouse.beginPath();
    contextMouse.moveTo(x, y);
    started = true;

}
function mousemovement(e) {

    // Get moust position
    x = e.offsetX;
    y = e.offsetY;

    // If started is true, then draw a line
    if(started) {

        contextMouse.lineTo(x, y);
        contextMouse.stroke();

    }

}

function mouseunclick() {
    // Change started to false when the user unclicks the mouse
    if(started) {
        started = false;    
    }

} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T00:57:16.840

`offsetX`并且`offsetY`在 Firefox 中不受支持（请参阅[此处的兼容性表](http://www.reloco.com.ar/mozilla/compat.html)）。相反，您需要使用`layerX`and `layerY`。

以下将在 Firefox 中工作（见[fiddle](http://jsfiddle.net/kr33F/3/)）：

```
/* FOR THE DRAWING APPLICATION */
/* =========================== */

var canvasMouse, contextMouse;

var started = false;
var x, y;

function initMouse() {

    // Get the drawing canvas
    canvasMouse = document.getElementById('drawing');
    contextMouse = canvasMouse.getContext('2d');

    // Add some event listeners so we can figure out what's happening
    // and run a few functions when they are executed.
    canvasMouse.addEventListener('mousemove', mousemovement, false);
    canvasMouse.addEventListener('mousedown', mouseclick, false);
    canvasMouse.addEventListener('mouseup', mouseunclick, false);

}

function mouseclick(e) {
    // When the mouse is clicked. Change started to true and move
    // the initial position to the position of the mouse

    // Get moust position
    x = e.layerX;
    y = e.layerY;

    console.log("coords", x, y);

    contextMouse.beginPath();
    contextMouse.moveTo(x, y);
    started = true;

}
function mousemovement(e) {

    // Get mouset position
    x = e.layerX;
    y = e.layerY;

    console.log("coords", x, y);

    // If started is true, then draw a line
    if(started) {               
        contextMouse.lineTo(x, y);
        contextMouse.stroke();

    }

}

function mouseunclick() {
    // Change started to false when the user unclicks the mouse
    if(started) {
        started = false;    
    }

}

initMouse(); 
```

如果您想避免浏览器特定的条件代码和/或您的画布元素在 DOM 层次结构中偏移（请阅读上面链接的兼容性表中 layerX 和 layerY 的限制），可能存在使用 jQuery 及其[`position()`方法](http://api.jquery.com/position/)的论据。

# c++ - 为什么 std::string 不定义乘法或文字？

> ID：10591262
> 
> 赞同：0
> 
> 时间：2012-05-14T21:22:33.090
> 
> 标签：c++, string, c++11, multiplication, user-defined-literals

在我第一次接触的语言中，有一个函数`repeat()`，它接受一个字符串，并重复它`n`多次。例如，`repeat ("hi", 3)`给出 的结果`"hihihi"`。

我确实有很多次使用这个函数，但令我沮丧的是，我从未在 C++ 中找到类似的东西。是的，我可以很容易地自己制作，或者让它更易于使用，但我有点惊讶它还没有包含在内。

它非常适合的一个地方是`std::string`：

```
std::string operator* (const std::string &text, int repeatCount);
std::string operator* (int repeatCount, const std::string &text); 
```

这将允许以下语法：

```
cout << "Repeating \"Hi\" three times gives us \"" << std::string("Hi") * 3 << "\"." 
```

现在它本身还不是很好，但它可能会更好，这让我想到了我的另一部分：文字。

每当我们使用字符串运算符时，例如`operator+`，我们必须确保一个参数实际上是一个字符串。他们为什么不直接为它定义一个文字，比如`""s`？不以下划线开头的文字后缀是为实现保留的，所以这不应该冲突，因为在任何人真正开始制作自己的之前如何添加它。

回到重复的例子，语法就是：

```
cout << "123"s * 3 + "456"s; 
```

这将产生：

```
123123123456 
```

同时，也可以包括一个字符，以满足`cout << '1's + '2's;`

为什么不包括这两个功能？它们肯定有明确的含义，并且使编码更容易，同时仍然使用标准库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T21:26:05.177

好吧，至于乘法，它并不真正符合 C++ 的哲学：像 Ruby 这样的语言“包含电池”并具有“最少意外原则”。它们旨在将许多这些小细节作为超越最低限度的功能。C++ 是一种系统级语言，旨在“更接近金属”，这非常清楚，因为 a`string`甚至不是该语言的核心数据类型，而是库提供的插件。甚至 FORTRAN 也具有原生字符串类型，因此您可以看到低级 C++ 的定位。这是故意的：如果您正在编写具有 1K 存储的嵌入式芯片并且不需要字符串怎么办？只是不要包括他们。

无论如何，乘法运算符应该做什么并不是 100% 清楚的。换句话说，在 C++ 的核心语言和库中，除非似乎几乎*每个人*都同意提议的功能，否则没有任何功能可以加入。它必须是非常普遍的。

我可能会认为“123”* 3 可以给出“369” - 将任何数字乘以 3。我进一步建议这种解释是“理智的”，足以防止您的重复运算符解释成为唯一明确的解释。

字面符号更容易和更清楚地回答：`std::string`是标准库的一部分，它是语言语法本身之上的一个抽象级别。换句话说，文字符号将突破分离“语言特性”和“您可以期望与编译器捆绑的库”的抽象级别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:28:31.637

std::string.append(numtimes, char to repeat); 那里。确实如此。现在，这适用于字符文字，因为对于字符串来说，没有办法以声明方式做到这一点。还要注意，std::string 类不是语言类型，c++ 中的字符串字面量是 const char *。一个指针。哪些数组衰减为指针，这就是 std::string 类处理它包含的内容的方式，即字符数组，即 char 或 std::wstring 的 wchar_t。有这些类型的模板。

# c# - 暂停程序以允许用户在 wpf 中进行交互

> ID：10591269
> 
> 赞同：2
> 
> 时间：2012-05-14T21:23:24.380
> 
> 标签：c#, multithreading, user-interface, user-interaction

好的，所以这是一种通用程序。我正在尝试编写一个扑克程序，用户可以在其中与计算机玩家互动。但是，为了简化它，我正在使用一个更简单的程序进行测试，其中两个玩家试图从计算机中猜测一个数字。一个是人类玩家，另一个是电脑玩家。

在游戏中，玩家轮流猜测程序设置的蜜蜂数量。电脑播放器只是随机化数字，用户应该输入一个数字并按下猜测按钮（或者可以选择退出）。

我的问题是，当人类玩家轮流行动时，我如何暂停游戏的执行，以便人类通过按下按钮或输入文本来做出响应？

我尝试过使用 Timer 并启动它并等待线程结束，但似乎它仍然冻结了 gui。

我还尝试从后台工作线程发送消息以更新 gui，但这给了我一个错误，即无法从另一个线程访问 gui 元素。

有没有人对如何实现这一点有任何建议？

请注意，这不是一个完整的程序，因为我只是为了了解如何在执行过程中与 gui 交互。

猜数字类：

```
public class NumberGuesser {

    public Player HumanPlayer { get; private set; }

    public Player ComputerPlayer { get; private set;}

    private Player[] _players = new Player[2];

    private int _maxNumber = 20;

    private bool _done = false;

    private Random random;

    public NumberGuesser() {

        HumanPlayer = new HumanPlayer("Me");

        ComputerPlayer = new ComputerPlayer("HAL9000");

        _players[0] = HumanPlayer;
        _players[1] = ComputerPlayer;

        random = new Random((int) DateTime.Now.Ticks);

    }

    public void Play() {

        var myNumber = random.Next(_maxNumber);
        var index = 0;
        while (!_done) {

            var currentPlayer = _players[index];

            var guess = currentPlayer.Act(_maxNumber);
            if (guess == myNumber) {
                currentPlayer.Score++;
            }

            index = (1 + index)%2;
        }

    }
} 
```

电脑玩家：

```
public class ComputerPlayer : Player {

    private readonly Random _random = new Random((int)DateTime.Now.Ticks);

    public ComputerPlayer(string name) : base(name) {
    }

    public override int Act(int max) {

        return _random.Next(max);

    }
} 
```

人类玩家：

```
public class HumanPlayer : Player {

    public HumanPlayer(string name) : base(name) {

    }

    public override int Act(int max) {

        return UserGuess();

    }

    private int UserGuess() {

        return 0;

    }
} 
```

玩家等级：

```
public class Player {
    public string Name { get; private set; }
    public int Score { get; set; }

    public Player(string name) {
        Name = name;
    }

    public virtual int Act(int max) {
        // How should the human enter the guess here???
        return 0;
    }
} 
```

我的主窗口：

```
<Window x:Class="GuessMyNumber.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="395" Width="728">
<Grid>
    <Label Content="Guess my number!" Height="28" HorizontalAlignment="Left" Margin="122,58,0,0" Name="label1" VerticalAlignment="Top" />
    <Grid Height="174" HorizontalAlignment="Left" Margin="31,170,0,0" Name="grid1" VerticalAlignment="Top" Width="272" DataContext="{Binding Path=HumanPlayer}">
        <Label Content="Human player" Height="28" HorizontalAlignment="Left" Margin="6,6,0,0" Name="label2" VerticalAlignment="Top" />
        <TextBox Height="23" HorizontalAlignment="Left" Margin="55,92,0,0" Name="textBox1" VerticalAlignment="Top" Width="120" 
                 Text="{Binding Path=HumanGuess, UpdateSourceTrigger=PropertyChanged}"/>
        <Button Content="Guess" Height="23" HorizontalAlignment="Left" Margin="79,130,0,0" Name="button1" VerticalAlignment="Top" Width="75"
                Command="{Binding Path=GuessCommand}"/>
        <Label Content="{Binding Path=Name}" Height="28" HorizontalAlignment="Left" Margin="96,6,0,0" Name="label3" VerticalAlignment="Top" />
        <Label Content="Score" Height="28" HorizontalAlignment="Left" Margin="6,40,0,0" Name="label4" VerticalAlignment="Top" />
        <TextBox Height="23" HorizontalAlignment="Left" Margin="55,42,0,0" Name="textBox2" VerticalAlignment="Top" Width="75" Text="{Binding Path=Score, UpdateSourceTrigger=PropertyChanged, Mode=OneWay}" />
        <Button Content="Quit" Height="23" HorizontalAlignment="Left" Margin="182,130,0,0" Name="buttonQuit" VerticalAlignment="Top" Width="75" Command="{Binding Path=QuitCommand}" />
    </Grid>
    <Grid Height="174" HorizontalAlignment="Left" Margin="328,170,0,0" Name="grid2" VerticalAlignment="Top" Width="270" DataContext="{Binding Path=ComputerPlayer}" >

        <Label Content="Computer player" Height="28" HorizontalAlignment="Left" Margin="6,6,0,0"  VerticalAlignment="Top" />
        <TextBox Height="23" HorizontalAlignment="Left" Margin="55,92,0,0"  VerticalAlignment="Top" Width="120" Text="{Binding Path=HumanGuess, UpdateSourceTrigger=PropertyChanged}"/>

        <Label Content="{Binding Path=Name}" Height="28" HorizontalAlignment="Left" Margin="111,6,0,0" VerticalAlignment="Top" />
        <Label Content="Score" Height="28" HorizontalAlignment="Left" Margin="6,40,0,0" VerticalAlignment="Top" />
        <TextBox Height="23" HorizontalAlignment="Left" Margin="55,42,0,0"  VerticalAlignment="Top" Width="75" Text="{Binding Path=Score, UpdateSourceTrigger=PropertyChanged, Mode=OneWay}" />
    </Grid>
    <Button Content="Start Playing" Height="23" HorizontalAlignment="Left" Margin="254,59,0,0" Name="buttonStartPlay" VerticalAlignment="Top" Width="75" Click="buttonStartPlay_Click" />
</Grid> 
```

以及背后的代码：

```
/// <summary>
/// Interaction logic for MainWindow.xaml
/// </summary>
public partial class MainWindow : Window {

    private readonly NumberGuesser _numberGuesser;

    public MainWindow() {
        InitializeComponent();
        _numberGuesser = new NumberGuesser();
        DataContext = _numberGuesser;

    }

    private void buttonStartPlay_Click(object sender, RoutedEventArgs e) {

        _numberGuesser.Play();

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:51:50.177

你必须从不同的角度来处理问题。与要求用户采取行动的同步运行的方法不同，就像您可能与本地计算机进行交互一样，您需要请求它，然后异步等待某事（例如事件）告诉您用户已完成。（更类似于请求远程计算机的某些东西）

这里有一些东西可以帮助你开始：

```
public abstract class Player
{
    public string Name { get; private set; }
    public int Score { get; set; }

    public Player(string name)
    {
        Name = name;
    }

    public abstract void ActAsync(int max);

    public virtual event EventHandler<ActEventArgs> ActComplete;
}
public class ActEventArgs : EventArgs
{
    public int Result { get; private set; }
    public ActEventArgs(int result)
    {
        this.Result = result;
    }
}
public class HumanPlayer : Player
{
    public HumanPlayer(string name)
        : base(name)
    {
    }

    public override void ActAsync(int max)
    {
        // button1 should be the user's guess button; anything else you need to do to allow them to interact should be done here
        button1.IsEnabled = true;
        // this will result in a handler being added each time the user is asked to act; you'll actually want to attach just once
        button1.Click += (s, e) =>
            {
                button1.IsEnabled = false;
                if (ActComplete != null)
                    ActComplete(this, new ActEventArgs(int.Parse(data.HumanGuess))); // data.HumanGuess is their input, as a string
            };
    }

    public override event EventHandler<ActEventArgs> ActComplete;
}
public class ComputerPlayer : Player
{
    private readonly Random _random = new Random((int)DateTime.Now.Ticks);

    public ComputerPlayer(string name)
        : base(name)
    {
    }

    public override void ActAsync(int max)
    {
        if (ActComplete != null)
            ActComplete(this, new ActEventArgs(_random.Next(max)));
    }
    public override event EventHandler<ActEventArgs> ActComplete;
} 
```

编辑：与 Jmyster 的解决方案（恕我直言）相比：他更适合简单的交互，即本地用户到本地计算机，但如果您打算将其扩展到多用户场景，事件会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:46:12.983

我不会使用那个 While 循环来玩游戏。我会做这样的事情：

```
private int numberToGuess = 0;

private void buttonStartPlay_Click(object sender, RoutedEventArgs e) 
{        
    numberToGuess = //Create Random Int;
}  

private void buttonHumanGuess_Click(object sender, RoutedEventArgs e) 
{        
    if(IsAnswerCorrect(//HumanGuess))
         //Human Wins
    else
        ComputerGuess();
        //Or
        MoveToNextPlayer();
}  

private void MoveToNextPlayer()
{
    //Do something to figure out who the next player is
}

private int ComputerGuess()
{
    //Do something to get computer answer
    if(IsAnswerCorrect(//ComputerGuess))
         //Computer Wins
}

private bool IsAnswerCorrect(int answer)
{
    if(answer == numberToGuess)
        return true;
    else
        return false;
} 
```

这是非常通用的，但想法是让用户输入一些内容，然后单击猜测按钮。处理完答案后，运行计算机猜测。

**编辑：** @蒂姆。解决方案将处理更高级的方法。根据计时器是否是评分的一部分，您可能还需要使用线程。这些应该是您的起点。

# c++ - ReadProcessMemory 更快

> ID：10591270
> 
> 赞同：1
> 
> 时间：2012-05-14T21:23:24.700
> 
> 标签：c++, c, winapi, memory

我正在制作一个应用程序，该应用程序将根据变量的值使用鼠标/键盘（宏）模拟动作。

在这里，我有我制作的扫描代码：

```
void ReadMemory(int value){
        DWORD primeiroAddress = 0x000000;
        DWORD finalAddress = 0xFFFFFF;
        DWORD address=0;
        std::ostringstream ss;
        int i=0;
        TListItem *ListIt;
        int valor;
        HANDLE phandle = OpenProcess(PROCESS_VM_READ,0,TargetPID);
        if(!phandle){
                ShowMessage("Não encoutrou o processo");
        }else{
                for(address=primeiroAddress;address<=finalAddress;address+=sizeof(valor)){
                        ReadProcessMemory(phandle,(void*)address,&valor,sizeof(valor),0);
                        if(valor==value){
                                i++;
                                ss << std::hex << address;
                                Form1->Label5->Caption=i;
                                ListIt = Form1->ListView1->Items->Add();
                                ListIt->Caption = AnsiString(ss.str().c_str()).UpperCase();
                                ListIt->SubItems->Add(IntToStr(valor));
                                ss.str(std::string());
                        }
                }
        }
} 
```

我想知道我能做些什么来加快扫描速度

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T21:46:08.210

你`int`一次读一本。而是调用`ReadProcessMemory`一次，一口气读取 16MB，然后在您自己的进程中扫描内存。它会快很多。

# css - css背景图片不重复-x

> ID：10591271
> 
> 赞同：0
> 
> 时间：2012-05-14T21:23:24.717
> 
> 标签：css

我在一个网站上有一个小问题，它的 CSS 中的背景元素不会低于页面上的某个点。这是您可以在页脚中看到我在说什么的链接：http: [//www.stuffforyourdog.com/collegeadvisors/admissions.html](http://www.stuffforyourdog.com/collegeadvisors/admissions.html)

在其他页面上一切都很好，但是在这个页面上，我无法弄清楚为什么背景图像没有像它应该的那样一直向下。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T21:28:53.340

你的背景图片的高度太小，如果你设置

```
.tail-top2 {
    background: url(images/bg2.png) bottom repeat-x;
} 
```

而不是顶部对齐，您可以看到页面对于您的图像来说太大了。您需要将背景图像高度设置为大于或等于最大页面高度。

# css - 如何从打印中隐藏 CSS 媒体查询？“非”逻辑运算符不起作用

> ID：10591273
> 
> 赞同：25
> 
> 时间：2012-05-14T21:23:28.130
> 
> 标签：css, media-queries

我试图隐藏一个媒体查询不被打印，所以我想出了`@media not print and (min-width:732px)`. 但无论出于何种原因，这个（以及我尝试过的许多变体）都没有像我在浏览器中所期望的那样显示。

我能想到的唯一选择是使用`@media screen and (max-width:732px)`，但我想避免这种情况，因为它排除了除屏幕之外的所有其他媒体类型。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2014-02-10T06:18:26.443

至少可以说，媒体查询语法非常有限。

但是使用 CSS3（不是 CSS2.1），您似乎可以嵌套`@media`规则。

```
@media not print {
    @media (min-width:732px) {
        ...
    }
} 
```

这基本上执行为`(not print) and (min-width:732px)`.

有关更多信息，请参阅[https://stackoverflow.com/a/11747166/3291457](https://stackoverflow.com/a/11747166/3291457)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-14T23:08:24.780

这样的事情怎么样？

```
body { min-width:732px; }
@media print {
   body { min-width:initial; }
} 
```

除 print 之外的所有内容的最小宽度都将设置为 732，它将获得您指定的其他值。根据您的情况，您可以设置不同的宽度，或尝试类似“thiswontwork”（有时会导致将值设置为初始值）或“继承”之类的东西。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-05T01:40:06.333

如果我对您预期的行为的假设是正确的，那么问题是[的优先级`not`低于`and`](https://developer.mozilla.org/en-US/docs/CSS/Media_queries#Operator_precedence).

`@media not print and (min-width:732px)`表示“除打印机之外的任何媒体，视口至少为 732px 宽”（因此它将适用于任何非打印机和瘦打印机）而不是“除打印机之外的任何媒体，只要该媒体具有至少 732px 宽的视口” （这是我假设你所期望的）。

由于括号在媒体类型周围无效并且`@media`规则不能嵌套，因此解决它有点烦人。对于简单的情况，[brentonsrine 的答案](https://stackoverflow.com/a/10592198/3625)是一个很好的解决方案，但对于包含许多样式的查询，确保它们都被正确覆盖可能会很​​麻烦。

今天早些时候我试图自己解决这个问题时，我整理了一些[示例媒体查询。](http://jsfiddle.net/qbdyj/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-01T22:56:53.310

因为你不能放这样的东西

`@media screen,handheld,projection,tv,tty and (max-width:732px) { ... }`

您应该为每种媒体编写对，如下所示：

```
@media screen and (max-width:732px), handheld and (max-width:732px), projection and (max-width:732px), tv and (max-width:732px), tty and (max-width:732px) { ... } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T21:28:40.773

您可以尝试以下方法：

```
@media screen,handheld,projection,tv,tty { ... } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-13T10:29:10.433

上面的嵌套查询对我不起作用，但是[在 MDN 上阅读了 Media Queries Media Types 之后](https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Using_media_queries#Media_types)`screen`，您可以通过指定类型从打印样式中排除您的媒体查询

因此，如果您有这样一个没有指定类型的媒体查询，它将具有隐含的`all`, 类型（这将影响打印样式）

```
@media (min-width:400px) {
     ...
} 
```

要从打印样式中排除样式，您需要将其更改为：

```
@media screen and (min-width:700px) {
      ...
} 
```

# vb.net - 带有实体框架的活动记录

> ID：10591275
> 
> 赞同：0
> 
> 时间：2012-05-14T21:23:36.783
> 
> 标签：vb.net, entity-framework, activerecord, entity-framework-4, ef-code-first

我正在开发一个使用 ADO.NET (raw sql) 和 Active Record 模式构建的项目。我正在慢慢地将它从 ADO.NET 移到 Entity Framework Code First 4.3。

这是该模式的示例。该接口是一个静态加载和一个实例保存（和删除——未显示）。

```
Public Class Part
    Public Property Id as Integer

    Public Shared Function Load(_id As Integer) As Part
        Using context As New DataContext()
            Return context.Find(_id)
        End Using
    End Function

    Public Sub Save()
        Using context As New DataContext()
            If Id = 0 Then
                context.Parts.Add(Me)
            Else
                context.Entry(Me).State = Data.EntityState.Modified
            End If

            context.SaveChanges()
        End Using
    End Sub
End Class 
```

我意识到 Active Record 并不适合 EF，但我想让它能够删除所有 ADO.NET 代码，同时不触及其余代码。

这主要是可行的，但我遇到了一个我不知道如何解决的问题。为了保持外键同步，我们这样处理：

```
Public Sub Save()
    ParentPart = Part.Load(ParentPartId)
    ChildPart = Part.Load(ChildPartId)

    Using context = New iTracContext()

        If bid = 0 Then
            context.BillOfMaterials.Add(Me)
        Else
            context.Entry(Me).State = Data.EntityState.Modified
        End If

        context.SaveChanges()
    End Using
End Sub 
```

这确保 EF 不会抱怨我们有不匹配的关系——Id 总是赢。

问题是当我保存时它现在抛出异常。

> ObjectStateManager 中已存在具有相同键的对象。ObjectStateManager 无法跟踪具有相同键的多个对象。

这是从行中抛出的：

```
context.Entry(Me).State = Data.EntityState.Modified 
```

在这种情况下，什么是什么`ObjectStateManager`？它是全新的，应该是空的，不是吗？

如果我删除这两`Part.Load(...)`行，它工作正常。

是否有某种类型的更改跟踪器存在于我不知道的上下文之外？这似乎会扼杀任何对 Active Record 模式的尝试。

我也愿意接受有关如何使 Active Record 与 EF 一起使用的任何建议。这`context.Entry`条线很糟糕，但我不知道还能做什么。

告诉我不要做 Active Record 没有帮助，但请随意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:32:31.717

我相信 Entity Framework 可能仍在从您加载它的上下文中跟踪对象，因为您为每个 Load 和 Save 调用创建了一个新上下文。如果是这种情况，请在加载对象后尝试分离它们：

```
Public Shared Function Load(_id As Integer) As Part
    Using context As New DataContext()
        Part part = context.Find(_id)
        context.Entry(part).State = EntityState.Detached ' Detach from the initial context
        Return part
    End Using
End Function 
```

# android - View.performClick 未触发

> ID：10591276
> 
> 赞同：1
> 
> 时间：2012-05-14T21:23:41.297
> 
> 标签：android

我在适配器中有以下代码来处理 CheckBox 上的点击。`gview`引用适配器中的 View 参数`getView()`

适配器代码：

```
 selected.setOnCheckedChangeListener(new OnCheckedChangeListener() {

        @Override
        public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
            if (isChecked)
                if (selection.size() == 0)
                    gview.performLongClick();
                else
                    gview.performClick();
            else
                if (selection.size() == 1)
                    gview.performLongClick();
                else
                    gview.performClick();
        }

    }); 
```

逻辑在包含`ListView`where`performLongClick()`触发器`OnItemLongClick`和`performClick()` **应该**触发的活动中，`onItemClick()` **但我的问题是它没有**：

活动代码：

```
 @Override
    public void onItemClick(AdapterView<?> arg0, View arg1, int arg2, long itemId) {
    if (listMode == MODE_NAVIGATION){
        home.browserFragment.loadUrl(bookmarks.findById((int)itemId).getUrl());
        home.browserFragment.closeBookmarks();
    } else{
        updateMultipleItemsSelection((int)itemId);

    }
}

  @Override
   public boolean onItemLongClick(AdapterView<?> arg0, View arg1, int arg2, long itemId) {
    if (listMode == MODE_SELECTION){
        deactivateSelectionMode();
    }else{
        activateSelectionMode();
        updateMultipleItemsSelection((int)itemId);
    }
    return true;
} 
```

有没有人看到这个问题的可能解决方案？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:46:40.863

因为复选框是可聚焦的，所以周围的列表视图项不是。尝试在 XML 中将列表视图项设置为可聚焦。如果这不起作用，您可以尝试将复选框设置为*不可*聚焦（它仍然可以选中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-30T05:25:27.663

```
 enter code here
@Override
    public void onItemClick(AdapterView<?> arg0, View v, int position, long arg3) {
        // TODO Auto-generated method stub
        CheckBox cb = (CheckBox) v.findViewById(R.id.checkBox1);
        TextView tv = (TextView) v.findViewById(R.id.textView1);
        pi = (PackageInfo) arg0.getItemAtPosition(position);
        cb.performClick();
        if (cb.isChecked()) {
            checkedValue.add(tv.getText().toString());
        } else if (!cb.isChecked()) {
            checkedValue.remove(tv.getText().toString());
        }
    } 
```

# hadoop - Hadoop MapReduce：映射器的默认数量

> ID：10591278
> 
> 赞同：3
> 
> 时间：2012-05-14T21:23:46.097
> 
> 标签：hadoop, mapreduce

如果我不指定映射器的数量，如何确定数量？是否有从配置文件（例如 mapred-site.xml）读取的默认设置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T04:15:14.760

在 Chris 上面添加的内容中添加更多内容：

1.  映射的数量通常由输入文件中 DFS 块的数量决定。虽然这会导致人们调整他们的 DFS 块大小以调整地图的数量。

2.  地图的正确并行度水平似乎在 10-100 个地图/节点左右，尽管对于非常 cpu-light 的地图任务，这可以达到 300 左右。任务设置需要一段时间，因此最好至少花费一分钟来执行地图。

3.  您可以通过修改 JobConf 的 conf.setNumMapTasks(int num) 来增加 Map 任务的数量。注意：这可能会增加映射任务的数量，但不会设置低于 Hadoop 通过拆分输入数据确定的数量。

最后控制地图的数量是微妙的。mapred.map.tasks 参数只是对 InputFormat 地图数量的提示。默认的 InputFormat 行为是将总字节数拆分为正确数量的片段。但是，在默认情况下，输入文件的 DFS 块大小被视为输入拆分的上限。可以通过 mapred.min.split.size 设置拆分大小的下限。

因此，如果您期望 10TB 的输入数据和 128MB 的 DFS 块，那么您最终会得到 82k 个地图，除非您的 mapred.map.tasks 更大。最终，InputFormat 决定了地图的数量。

阅读更多：[http ://wiki.apache.org/hadoop/HowManyMapsAndReduces](http://wiki.apache.org/hadoop/HowManyMapsAndReduces)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T22:20:12.017

这取决于许多因素：

*   输入格式和格式的特定配置属性
*   对于基于文件的输入格式（TextInputFormat、SequenceFileInputFormat 等）：
    *   输入文件/路径的数量
    *   文件是可拆分的（通常压缩文件不是，SequenceFiles 是一个例外）
    *   文件的块大小

可能还有更多，但希望你能明白

# javascript - 表单选择 GT 9 时脚本失败

> ID：10591279
> 
> 赞同：0
> 
> 时间：2012-05-14T21:23:49.857
> 
> 标签：javascript, jsfiddle

希望在这里得到一些帮助。我敢肯定这很简单，我只是对此有点不知所措。

我正在处理的这个脚本：http：[//jsfiddle.net/rvpnu/9/](http://jsfiddle.net/rVPnu/9/)选择大于9时会失败。

**有人可以解释为什么以及如何解决这个问题，所以如果我选择 11 它会显示 11 个 div？**

我确实注意到代码中的这一行：

```
// var gh = tee.charAt(tee.length-1);  // get the int form id will (fail if GT 9) 
```

非常感谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:33:54.147

问题是`var gh = tee.slice(-1);`。它采用元素 ID 的最后一个字符，在第 11 个选择的情况下是`npup10`并返回`0`。

如果所有元素都以 npup 开头，则可以改为`tee.slice(4)`.

# asp.net-mvc - 何时检查是否应允许帐户使用 Web 应用程序？

> ID：10591286
> 
> 赞同：2
> 
> 时间：2012-05-14T21:24:25.557
> 
> 标签：asp.net-mvc

所以我有这个网络应用程序，理论上它有朝一日可能成为付费应用程序——如果有人真的觉得它有用且值得的话。

我有处理付款的所有逻辑，检查帐户是否逾期等。它全部存储在 RavenDB（实际上是 RavenHQ）中——这与手头的问题无关。

现在，我正在尝试遵循最佳实践，并且我希望我的应用程序具有高性能，即不是微优化，但我希望以一种能够随着负载相对较好地扩展的方式来做事（如果它起飞，它将被托管- 我希望不必为超过严格必要的服务器付费）。

我的应用程序使用接近默认登录/帐户模型的东西。用户通过 https 使用表单身份验证安全登录。

我应该在什么时候检查用户是否真的被允许（关于支付状态等 - 一个领域模型问题真的）使用 Web 应用程序？考虑到这将意味着从 RavenDB 后端请求单个文档并检查当前付款期限是否已过期。

我是不是该：

*   每次用户登录时检查，让他们超过x小时无法“记住我”，其中x是一个相对较小的数字？

*   签入一些用户相对经常访问的中央控制器操作 - 如果这些操作不可用，应用程序将基本上受到严格限制。

*   执行一个全局操作过滤器，检查每个请求，然后重定向到“Pay nooooow！” 东西过期后的页面？

*   另外一个选项？

RavenDB 做了聪明的缓存，所以我不认为对这个文档的请求会影响性能，但是如果应用程序真的起飞（不太可能，但可以梦想），每个 http 请求的额外数据库请求可能会导致 Ayende 追捕我倒下并无情地殴打我。我不想要那个。

在我看来，这是其他人会考虑并解决的问题，所以我在问 - 处理这个问题的正确方法是什么？

感谢您的任何见解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:42:04.560

我不认为这是一个严格的框架问题，它更像是您希望您的网站表现如何，然后使用框架来支持它。一般而言，您希望网站可用且限制性不强，除非有必要，例如不受任何限制地浏览网站，但签出应该非常安全。

# c# - 在主线程上观察时是否需要同步可观察对象？

> ID：10591287
> 
> 赞同：2
> 
> 时间：2012-05-14T21:24:27.680
> 
> 标签：c#, multithreading, c#-4.0, system.reactive

这 .Synchronize() 需要吗？如果没有，什么时候真正需要使用？

```
_subject.SubscribeOn(Scheduler.TaskPool).ObserveOn(SynchronizationContext.Current).Synchronize().Subscribe(OnNext) 
```

我认为这可能是必要的原因是因为我正在从多个线程调用主题的 OnNext。不过，我确实希望在主线程上执行 OnNext 方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T00:28:55.387

`Synchronize`扩展方法用于两件事：

1.  确保应用它的可观察对象遵循适当的可观察“合同” - 即`OnNext*(OnError|OnCompleted)`.
2.  确保每个都`OnNext`被序列化 - 如果在不同的线程上调用，则不会重叠。

但是，在您的情况下，您正在同步到当前上下文，因此会自动为您处理第二点。

# deployment - JBoss 7 中的缓存控制

> ID：10591291
> 
> 赞同：2
> 
> 时间：2012-05-14T21:24:39.123
> 
> 标签：deployment, jboss7.x, cache-control

在 JBoss 5 中，我在 web.xml 中配置了缓存控制。

```
<filter>
  <filter-name>CacheControlFilter</filter-name>
  <filter-class>org.jboss.web.tomcat.filters.ReplyHeaderFilter</filter-class>
  <init-param>
     <param-name>Cache-Control</param-name>
     <param-value>max-age=3600</param-value>
  </init-param> 
```

```
<filter-mapping>
   <filter-name>CacheControlFilter</filter-name>
    <url-pattern>/images/*</url-pattern>
</filter-mapping>
<filter-mapping>
   <filter-name>CacheControlFilter</filter-name>
  <url-pattern>*.js</url-pattern>
</filter-mapping> 
```

但是当我尝试将战争部署到 JBoss 7 时。它失败了，因为过滤器不见了。JBoss 7 中是否有一个等效的类来替换 org.jboss.web.tomcat.filters.ReplyHeaderFilter？

谢谢

换句话说，JBoss 7 是如何处理缓存控制的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T17:26:58.513

我从下载 jbossweb-service.jar

[http://www.java2s.com/Code/Jar/j/Downloadjbosswebservicejar.htm](http://www.java2s.com/Code/Jar/j/Downloadjbosswebservicejar.htm)

但我仍然想知道为什么它不在 JBoss 7 中。

# java - 使用 Matlab Builder JA 的问题

> ID：10591292
> 
> 赞同：2
> 
> 时间：2012-05-14T21:24:46.320
> 
> 标签：java, matlab, compiler-errors, matlab-deployment

首先我要提前感谢大家阅读这么长的帖子。我真的很感谢你的帮助。

问题是我一直在研究如何为我正在为大学工作的项目“连接”Matlab 和 Java。我认为最合适的选择是使用 Matlab Builder JA，但我遇到了很多麻烦。

我逐步按照教程中描述的说明进行操作（下面的视频链接），但一遍又一遍地出现编译错误，我真的不知道如何修复它们。本教程是关于使用 MATLAB（“com.demo”）创建一个 Java 包（demo.jar），其中包含一个类（MLTestClass），该类具有一个`makeSqr(n)`返回 n × n 方阵的函数。然后我转到 Eclipse，将 javabuilder.jar 和 demo.jar 这两个库添加到项目中，然后创建以下类：

```
public class Driver {

    public static void main (String[] args) {
        MLTestClass x = null;
        Object result [] = null;

        try {
            x = new MLTestClass ();
            result = x.makeSqr (1, 5);
            System.out.println (result [0]);
        } catch (MWException e) {
            e.printStackTrace();
        }

    }

} 
```

当然我导入 com.demo.* 和 com.mathworks.toolbox.javabuilder.*。

以下是控制台给我的错误：

```
线程“主”java.lang.ExceptionInInitializerError 中的异常
在 com.mathworks.toolbox.javabuilder.internal.MCRConfiguration.getProxyLibraryDir(MCRConfiguration.java:163)
    在 com.mathworks.toolbox.javabuilder.internal.MCRConfiguration$MCRRoot.get(MCRConfiguration.java:77)
    在 com.mathworks.toolbox.javabuilder.internal.MCRConfiguration$MCRRoot.<clinit>(MCRConfiguration.java:87)
    在 com.mathworks.toolbox.javabuilder.internal.MCRConfiguration.getMCRRoot(MCRConfiguration.java:92)
    在 com.mathworks.toolbox.javabuilder.internal.MCRConfiguration$ModuleDir.<clinit>(MCRConfiguration.java:66)
    在 com.mathworks.toolbox.javabuilder.internal.MCRConfiguration.getModuleDir(MCRConfiguration.java:71)
    在 com.mathworks.toolbox.javabuilder.internal.MWMCR.<clinit>(MWMCR.java:1573)
    在 com.demo.DemoMCRFactory.(DemoMCRFactory.java:122)
    在 com.demo.MLTestClass.(MLTestClass.java:63)
    在 Driver.main(Driver.java:12)
引起：java.lang.NullPointerException
    在 com.mathworks.toolbox.javabuilder.internal.MCRConfiguration$ProxyLibraryDir.get(MCRConfiguration.java:143)
    在 com.mathworks.toolbox.javabuilder.internal.MCRConfiguration$ProxyLibraryDir.<clinit>(MCRConfiguration.java:158)
    ... 10 更多

```

以防万一，链接教程（这是视频）： http: [//www.mathworks.nl/products/javabuilder/description2.html](http://www.mathworks.nl/products/javabuilder/description2.html)

任何人都有任何想法可能是什么问题？它说了一些关于 NullPointerException 的内容，但我不知道如何解决它，因为构造函数是由用 MATLAB 创建的类提供的。我安装 MCR 没有任何问题，顺便说一下，我有 MacOS，我希望这不是问题的根源:)。

再次，很抱歉，很长的帖子，感谢您的时间。

本托。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:32:05.010

是的，请安装 MCR。安装还提到设置环境变量等`LD_LIBRARY_PATH`。如果您使用的是 eclipse，我建议您更新环境变量

*   右键->
*   属性->
*   运行/调试设置->
*   环境变量

我还必须确保该变量`MCR_CACHE_ROOT`指向不同的目录，因为我的主目录不够大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T12:13:40.533

您已安装 MCR（可在[http://www.mathworks.com/products/compiler/mcr/index.html](http://www.mathworks.com/products/compiler/mcr/index.html)中获得）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-11T19:55:38.137

上述解决方案都没有帮助我（我已经安装了 MCR 并且 Mac 使用 DYLD_LIBRARY_PATH 而不是 LD_LIBRARY_PATH），而且网上似乎没有其他人知道。最后在绝望中，我尝试编辑 DYLD_LIBRARY_PATH 并最终通过删除它的最后一部分使其工作：/Applications/MATLAB/MATLAB_Compiler_Runtime/v82/sys/java/jre/maci64/jre/lib

现在教程中的演示应用程序可以工作了。

接下来是尝试让我的代码工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-13T10:31:35.047

用于运行时部署的 OS X 路径

使用这些 setenv 命令设置您的 MATLAB 运行时路径。

```
setenv DYLD_LIBRARY_PATH \
       mcr_root/version/runtime/maci64 \
       mcr_root/version/bin/maci64 \
       mcr_root/version/sys/os/maci64 
```

来源： http: [//www.mathworks.com/help/compiler_sdk/java/mcr-path-settings-for-run-time-deployment.html](http://www.mathworks.com/help/compiler_sdk/java/mcr-path-settings-for-run-time-deployment.html)

# c - C中的＆符号错误和生命周期

> ID：10591293
> 
> 赞同：-4
> 
> 时间：2012-05-14T21:24:51.137
> 
> 标签：c, pointers, compiler-warnings, local-variables

众所周知，局部变量具有局部作用域和生命周期。考虑以下代码：

```
 int* abc()
      {
            int m;
            return(&m);
       }
       void main()
       {
             int* p=abc();
             *p=32;
        } 
```

这给了我一个警告，一个函数返回一个局部变量的地址。我认为这是合理的：一旦 abc() 完成，本地可验证 m 就会被释放。所以我们在主函数中取消引用一个无效的内存位置。

但是，请考虑以下代码：

```
 int* abc()
      {
           int m;
           return(&m);
           int p=9;
       }
       void main()
       {
           int* p=abc();
           *p=32;
       } 
```

在这里，我得到了同样的警告。但我猜 m 返回时仍然会保留它的生命周期。怎么了？请解释错误。我的理由错了吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-14T21:33:20.543

首先，请注意`int p=9;`永远不会达到，因此您的两个版本在功能上是相同的。程序将为该内存分配内存`m`并返回该内存的地址；return 语句下面的任何代码都是无法访问的。

其次，局部变量`m`在函数返回后实际上并没有被释放。相反，程序会考虑内存可用空间。该空间可能用于其他目的，或者它可能保持未使用状态并永远保持其旧值。因为您无法保证函数退出后内存会发生什么，所以`abc()`您不应尝试以任何方式访问或修改它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-14T21:31:44.397

一旦遇到 return 关键字，控制权就会返回给调用者，并且被调用的函数超出范围。因此，所有局部变量都从堆栈中弹出。因此，第二个示例中的最后一条语句无关紧要，**警告是合理的**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T22:21:28.040

*从逻辑上讲*，`m`从函数返回时不再存在，一旦函数退出，对它的任何引用都是无效的。

*物理*上，图片有点复杂。占用的内存单元`m`肯定仍然存在，如果您在其他任何东西有机会写入它们之前访问这些单元，它们将包含在函数中写入它们的值，因此**在正确**的情况下可能您可以在返回后读取存储的`m`内容。 **不要依赖这种行为是可重复的；****这是一个编码错误**。 `p``abc`

 **从语言标准（[C99](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)）：

> **6.2.4 对象的存储持续时间**
> ...
> 2 对象的*生命周期*是程序执行期间保证为其保留存储的部分。一个对象存在，具有一个常量地址，^(25))并在其整个生命周期中保留其最后存储的值。^(26)) **如果对象在其生命周期之外被引用，则行为未定义。当指针指向的对象到达其生命周期的末尾时，指针的值变得不确定。**
> 
> * * *
> 
> 25) 术语“恒定地址”意味着在可能不同时间构造的两个指向对象的指针将比较相等。在同一程序的两次不同执行期间，地址可能不同。
> 
> 26) 在 volatile 对象的情况下，最后的存储不需要在程序中明确显示。

强调我的。基本上，您正在做一些语言定义明确称为*未定义行为*的事情，这意味着编译器可以自由地以任何它想要的方式处理这种情况。它可以发出诊断（你的编译器正在做的），它可以在*不*发出诊断的情况下翻译代码，它可以在那个时候停止翻译，等等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-14T21:37:42.587

退出函数时，使 m 仍然有效内存（与代码保持最大相似性）的唯一方法是在它前面加上 static 关键字

```
int* abc()
{
           static int m;
           m = 42;
           return &m;
} 
```

返回后的任何内容都是永远不会执行的“死分支”。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-14T21:28:03.340

`int m` should be locally visible. You should create it as `int* m` and return it directly.**

# c# - 重置 Win CE 注册表

> ID：10591296
> 
> 赞同：0
> 
> 时间：2012-05-14T21:25:01.500
> 
> 标签：c#, windows-ce

我正在使用 win CE 5.0 设备并将 Launch50（通常是 explorer.exe）的注册表值更改为指向我的应用程序。问题是注册表项中指定的路径错误，设备无法正常启动。我无法将此设备连接到我的 PC。有没有办法通过启动到 SD 卡或类似的东西来修复注册表项。如果有我该怎么做？该设备是一个迷你销售点 (Wintec IDT700)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T23:17:17.720

这很难。恢复到出厂状态是非常特定于设备的。第一站是与 OEM 核对。

设备是否具有在启动时从插入的媒体或类似媒体自动运行应用程序的机制？如果y\so，创建一个应用程序来修改注册表将是另一种选择。

# java - java iText1.4.8.jar时找不到PDF头签名

> ID：10591297
> 
> 赞同：0
> 
> 时间：2012-05-14T21:25:03.930
> 
> 标签：java, itext

我需要将 100 个 PDF 文件合并为一个合并的 PDF 文件，并且该合并的 PDF 是动态创建的。当文件夹中没有合并的 PDF 文件时，它将被创建。但如果已经有一个，那么我将删除它并创建另一个同名的。这是我收到此错误的地方。

```
An Error occurred while merging the PDF files PDF header signature not found.
An Error occurred while closing the Document The document has no pages. 
```

# c++ - 没有得到正确的功能报告

> ID：10591304
> 
> 赞同：0
> 
> 时间：2012-05-14T21:25:46.157
> 
> 标签：c++, device, hid, wdk

我之前问过一个类似的问题，但是 1\. 没有人回答 2\. 有点不同。我已经设法获得正确的文件路径并使用 CreateFile 创建了一个处理程序。然后我尝试使用 HidD_GetFeature() 函数，但是当我打印出报告时，它都是符号 - 不是字母、数字或可读符号。有谁知道它为什么这样做？这是我的代码：

```
/*****************************Mainframe.cpp**************************************/
#include"DeviceManager.h"

int main()
{
    int iQuit;
    DeviceManager deviceManager;

    //deviceManager.ListAllDevices();
    deviceManager.GetDevice("8888", "0308");

    std::cin >> iQuit;

    return 0;
}

/***********************************DeviceManager.h***************************/
#include <windows.h>
//#include <hidsdi.h>
#include <setupapi.h>
#include <iostream>
#include <cfgmgr32.h>
#include <tchar.h>
#include <devpkey.h>

extern "C"{
    #include <hidsdi.h>
}

//#pragma comment (lib, "setupapi.lib")

class DeviceManager
{
public:
    DeviceManager();
    ~DeviceManager();

    void ListAllDevices();
    void GetDevice(std::string vid, std::string pid);

    HANDLE PSMove;
    byte reportBuffer[57];
    GUID guid;
private:
    HDEVINFO deviceInfoSet;             //A list of all the devices
    SP_DEVINFO_DATA deviceInfoData;     //A device from deviceInfoSet

    SP_DEVICE_INTERFACE_DATA deviceInterfaceData;
    SP_DEVICE_INTERFACE_DETAIL_DATA deviceInterfaceDetailedData;

};

/********************************DeviceManager.cpp*********************************/
#include"DeviceManager.h"

DeviceManager::DeviceManager()
{
    HidD_GetHidGuid(&guid);
    deviceInfoSet = SetupDiGetClassDevs(&guid, NULL, NULL, DIGCF_PRESENT|DIGCF_DEVICEINTERFACE); //Gets all Devices
}

DeviceManager::~DeviceManager()
{
}

void DeviceManager::ListAllDevices()
{
    DWORD deviceIndex = 0;

    deviceInfoData.cbSize = sizeof(deviceInfoData);

    while(SetupDiEnumDeviceInfo(deviceInfoSet, deviceIndex, &deviceInfoData))
    {
        deviceInfoData.cbSize = sizeof(deviceInfoData);

        ULONG tcharSize;
        CM_Get_Device_ID_Size(&tcharSize, deviceInfoData.DevInst, 0);
        TCHAR* deviceIDBuffer = new TCHAR[tcharSize];   //the device ID will be stored in this array, so the tcharSize needs to be big enough to hold all the info.
                                                        //Or we can use MAX_DEVICE_ID_LEN, which is 200

        CM_Get_Device_ID(deviceInfoData.DevInst, deviceIDBuffer, MAX_PATH, 0); //gets the devices ID - a long string that looks like a file path.

        /*
        //SetupDiGetDevicePropertyKeys(deviceInfoSet, &deviceInfoData, &devicePropertyKey, NULL, 0, 0);
        if( deviceIDBuffer[8]=='8' && deviceIDBuffer[9]=='8' && deviceIDBuffer[10]=='8' && deviceIDBuffer[11]=='8' && //VID
            deviceIDBuffer[17]=='0' && deviceIDBuffer[18]=='3' && deviceIDBuffer[19]=='0' && deviceIDBuffer[20]=='8') //PID
        {
            std::cout << deviceIDBuffer << "\t<-- Playstation Move" << std::endl;
        }
        else
        {
            std::cout << deviceIDBuffer << std::endl;
        }*/

        std::cout << deviceIDBuffer << std::endl;

        deviceIndex++;
    }
}

void DeviceManager::GetDevice(std::string vid, std::string pid)
{
    DWORD deviceIndex = 0;
    deviceInfoData.cbSize = sizeof(deviceInfoData);

    while(SetupDiEnumDeviceInfo(deviceInfoSet, deviceIndex, &deviceInfoData))
    {
        deviceInfoData.cbSize = sizeof(deviceInfoData);

        ULONG IDSize;
        CM_Get_Device_ID_Size(&IDSize, deviceInfoData.DevInst, 0);

        TCHAR* deviceID = new TCHAR[IDSize];

        CM_Get_Device_ID(deviceInfoData.DevInst, deviceID, MAX_PATH, 0);

        if( deviceID[8]==vid.at(0) && deviceID[9]==vid.at(1) && deviceID[10]==vid.at(2) && deviceID[11]==vid.at(3) && //VID
            deviceID[17]==pid.at(0) && deviceID[18]==pid.at(1) && deviceID[19]==pid.at(2) && deviceID[20]==pid.at(3)) //PID
        {
            DWORD deviceInterfaceIndex = 0;
            deviceInterfaceData.cbSize = sizeof(deviceInterfaceData);

            //HDEVINFO deviceInterfaceSet = SetupDiGetClassDevs(&guid, NULL, NULL, DIGCF_DEVICEINTERFACE);

            if(SetupDiEnumDeviceInterfaces(deviceInfoSet, &deviceInfoData, &guid, deviceInterfaceIndex, &deviceInterfaceData))
            {
                deviceInterfaceData.cbSize = sizeof(deviceInterfaceData);
                deviceInterfaceDetailedData.cbSize = sizeof(deviceInterfaceDetailedData);

                DWORD requiredSize;

                SetupDiGetDeviceInterfaceDetail(deviceInfoSet, &deviceInterfaceData, NULL, 0, &requiredSize, &deviceInfoData); //Gets the size
                SetupDiGetDeviceInterfaceDetail(deviceInfoSet, &deviceInterfaceData, &deviceInterfaceDetailedData, requiredSize, NULL, NULL); //Sets the deviceInterfaceDetailedData

                //std::cout << deviceInterfaceDetailedData.DevicePath << std::endl;

                PSMove = CreateFile(deviceInterfaceDetailedData.DevicePath, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);

                reportBuffer[0] = 0;
                ULONG reportBufferLength = sizeof(reportBuffer);
                HidD_GetFeature(PSMove, &reportBuffer, reportBufferLength);
                std::cout << reportBuffer << std::endl;
                //deviceInterfaceIndex++;
            }
            break;
        }

        deviceIndex++;
    }
} 
```

HidD_GetFeature() 函数位于这个巨大代码块的底部。

更新：我现在设法打印报告，但它只是一个随机的 8 位十六进制。每次我关闭程序并再次运行它时，它都会打印出不同的结果。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:03:43.070

该`ListAllDevices()`函数未正确显示信息，因为您正在输出 a`wchar_t*`到`std::cout`. 您需要`std::wcout`用于宽字符。

# email - 如何在 Confluence 中邮寄一个页面，向每个收件人显示所有收件人？

> ID：10591306
> 
> 赞同：1
> 
> 时间：2012-05-14T21:25:49.440
> 
> 标签：email, share, confluence

我安装了 confluence 3.5（但我也很好，如果你告诉我 4.2 中有这样的选项）。有一个共享按钮，可让您通过电子邮件将页面发送给一群收件人。遗憾的是，所有收件人都输入为密件抄送（或者电子邮件任务为每个收件人执行一次）。问题：我也想让收件人知道该页面已共享给谁。

我不敢相信我找不到关于该主题的任何内容（只是那个描述：[http](http://confluence.atlassian.com/display/CONF35/E-mailing+a+Page) ://confluence.atlassian.com/display/CONF35/E-mailing+a+Page ）。所以，如果这对你来说是一个愚蠢的问题，融合裂缝在那里，我很抱歉，但很高兴，如果你给我一个提示。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T08:30:46.587

是的，这是在 Confluence 4.2 中添加的，它真的很方便！

现在，您收到的电子邮件显示“也共享给”部分，其中包含其他所有人的姓名和头像。

# iphone - CABasicAnimation how to make it easy

> ID：10591307
> 
> 赞同：6
> 
> 时间：2012-05-14T21:25:54.537
> 
> 标签：iphone, objective-c, ios, core-animation, cabasicanimation

I'm currently using the following animation on a `UITableViewCell`:

```
CATransform3D rotationTransform = CATransform3DMakeRotation(1.0f * M_PI, 0, 0, 1.0);
CABasicAnimation* rotationAnimation = [CABasicAnimation animationWithKeyPath:@"transform"];

rotationAnimation.toValue = [NSValue valueWithCATransform3D:rotationTransform];
rotationAnimation.duration = 0.25f;
rotationAnimation.cumulative = YES;
rotationAnimation.repeatCount = 1;

[cell.rotatingImage.layer addAnimation:rotationAnimation forKey:@"rotationAnimation"]; 
```

However, when ~3 cells are animated as above the animations become very laggy. Is there any way I can reduce this lag?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:08:47.043

我要做的第一件事是将动画创建代码从`-tableView:cellForRowAtIndexPath:`方法中删除到（比如说）`viewDidLoad`. 然后将动画添加到`-tableView:cellForRowAtIndexPath:`方法中的单元格中。

对象创建和矩阵计算代价高昂，因此每次调用`-tableView:cellForRowAtIndexPath:`都会减慢代码速度。

在代码中，我会有类似于以下内容的内容：

```
- (void) viewDidLoad 
{
    // Normal viewDidLoad code above
    ...

    // Assume that rotationAnimation is an instance variable of type CABasicAnimation*;
    rotationAnimation = [CABasicAnimation animationWithKeyPath:@"transform"];

    CATransform3D rotationTransform = CATransform3DMakeRotation(1.0f * M_PI, 0, 0, 1.0);

    rotationAnimation.toValue = [NSValue valueWithCATransform3D:rotationTransform];
    rotationAnimation.duration = 0.25f;
    rotationAnimation.cumulative = YES;
    rotationAnimation.repeatCount = 1;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    // create cell
    ...
    // Now apply the animation to the necessary layer.
    [cell.rotatingImage.layer addAnimation:rotationAnimation forKey:@"rotationAnimation"];

    return cell;
} 
```

这行吗？

# c# - Is non-trivial constructor in IoC paradigm a bad thing?

> ID：10591310
> 
> 赞同：3
> 
> 时间：2012-05-14T21:26:04.777
> 
> 标签：c#, dependency-injection, inversion-of-control

I'm using dependency injection in my C# projects and generally everything is ok. Nevertheless, I often hear the rule "constructor must only consist of trivial operations - assign dependencies and do nothing more" I.e:

```
//dependencies
interface IMyFooDependency
{
   string GetBuzz();
   int DoOtherStuff();
}

interface IMyBarDependency
{
  void CrunchMe();
}

//consumer
class MyNiceConsumer
{
  private readonly IMyFooDependency foo;
  private readonly  IMyBarDependency bar;
  private /*readonly*/ string buzz;//<---question here
  MyNiceConsumer(IMyFooDependency foo, IMyBarDependency bar)
  { 
     //omitting null checks
     this.foo = foo;
     this.bar = bar;
     //OR
     this.buzz = foo.GetBuzz();//is this a bad thing to do? 
  }  
} 
```

**UPD**: assume `IMyFooDependency` can't be replaced with the `GetBuzz()`, as in that case the answer is obvious: "do not depend on `foo`".

**UPD2**: Please, understand that this question is not about eliminating dependency from foo in a hypothetic code, but about understanding a principle of good constructor design.

So, my questions is following: is this really a **bad pattern** to include non-trivial logic in constructor(i.e. obtaining `buzz` value, making some calculations based on dependencies.)

Personally I, unless lazy load is necessary, would include `foo.GetBuzz()` in constructor, as object need to be initialized after call to its constructor.

The only drawback I see: by including non-trivial logic you increase the number of places where something might go wrong, and you'll get an obfuscated error message from your IoC container(but same things happen in case of invalid parameter, so the drawback is rather minor)

Any other considerations for eliding non-trivial constructors?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:53:10.957

如果您`IMyFooDependency`只需要`buzz`创建，那么您实际上需要嗡嗡声：

```
class MyNiceConsumer
{
  private readonly IMyBarDependency bar;
  private readonly string buzz;

  MyNiceConsumer(string buzz, IMyBarDependency bar)
  { 
     this.buzz = buzz;
     this.bar = bar;
  }  
} 
```

并以这种方式创建好消费者的实例：

```
new MyNiceConsumer(foo.GetBuzz(), bar); 
```

我看不出在将参数传递给构造函数之前获取嗡嗡声或在构造函数内部获取它之间有什么区别。将从存储库返回相同的值。因此，您不需要依赖存储库。

更新：从技术上讲，构造函数中复杂的初始化逻辑没有任何问题。看一下 winforms`InitializeComponent`方法，其中所有控件都被创建、初始化并添加到表单中。

但它违反了 SRP（创建和初始化）并且难以测试。[您可以在编写可测试代码指南](http://misko.hevery.com/code-reviewers-guide/flaw-constructor-does-real-work/)中阅读有关此缺陷的更多信息。大意：

> 不要在构造函数中创建协作者，而是将它们传递进去。（不要找东西！要东西！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T16:36:04.950

在构造函数中不做任何工作的理由来自于分两个阶段查看程序的执行。第一阶段是连接您的对象图。第二阶段是做“实事”。

这种理想与有效维护类的不变量和内部状态之间存在矛盾。您可以在构造函数中进行的设置越少，实现所有方法的难度就越大，因为它们必须考虑到对象可能变化的内部状态。请记住，构造函数是唯一可以确定为对象调用的代码。

解决这个难题的方法是认识到一个对象的“实际工作”是由它与其他对象相关的接口和行为定义的。也就是说，提供给构造函数的依赖项和作为参数提供给以后的方法的对象。

随意在构造函数中进行任何类型的设置，这些设置不会对系统中的其他对象产生明显影响。同样，对对象构造中的时间问题非常敏感。

如果您确定没有用户提供的文件名就不能存在 File 对象：不要在构造函数中调用 keyboard.filename_from_keyboard()。相反，您设计您的系统，以便在执行期间使用提供给构造函数的文件名由工厂（提供者）创建对象，或者您允许 File 对象在没有文件名的情况下存在。也许它可以在执行期间获得自己的文件名？这是管理对象生命周期的一部分，也是 IMO 中最难的部分。这变得非常微妙，因为“实际工作”也涉及创建对象。但我离题了...

在您的示例中，您必须确定 foo.GetBuzz() 是否打破该条件。如果 GetBuzz() 是一个引用透明函数，那么您几乎总是可以在构造函数中调用它。如果 GetBuzz() 涉及任何 I/O、用户交互或更改任何其他对象的任何明显内部状态，那么它可能不需要从构造函数中调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T00:37:03.140

正如lazyberezovsky 正确提到的那样，不要寻找东西！问东西！

如果创建代码（比方说，`MyNiceCreator`）将`foo`其视为不透明的值并更新`MyNiceConsumer`，那么很可能创建不应该是`MyNiceCreator`. 创建`MyNiceConsumer`实例的代码必须能够为构造函数提供所需的值。更好的模式： `MyNiceCreator`应该“询问”一个`MyNiceConsumer`实例。这样，`MyNiceConsumer`实例的创建将由适当的类负责。

# xaml - 将选项卡绑定到 xaml 模型中的 observablecollection

> ID：10591312
> 
> 赞同：0
> 
> 时间：2012-05-14T21:26:14.340
> 
> 标签：xaml, c#-4.0, data-binding, observablecollection

我有一个关于标签数据绑定的问题。我有以下 xaml 代码：

```
<Window x:Class="SuperAtomsController.GUI.windowAnalog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"          
    Title="windowAnalog" Height="900" Width="1400"
    DataContext="{Binding RelativeSource={RelativeSource self}}">

    <Grid>
        <TabControl Height="459" HorizontalAlignment="Left" Margin="188,278,0,0" Name="tabControl1" ItemsSource="{Binding Path=model.sequences}" VerticalAlignment="Top" Width="883">

        </TabControl>
    </Grid>
</Window> 
```

以及背后的代码：

```
public partial class windowAnalog : Window
{
    public Data model;                           
    public windowAnalog(Data model)
    {
        this.model = model;
        InitializeComponent();                             
    }
} 
```

但是有了这个，tabcontrol 中什么也没有出现（model.sequences 是类型`ObservableCollection<>`）。如果删除 xaml 中的 itemssource 并在它工作正常`tabControl1.ItemsSource = model.sequences;`之后在c# 代码中添加以下内容。`InitializeComponent();`我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T02:48:24.757

显然您的绑定没有解决，请检查您的调试输出窗口以获取有用的诊断消息。

我不记得了，但我认为模型可能需要成为 WPF 属性路径才能工作的属性而不是字段。否则可能是 DataContext 的问题。您可以尝试在 InitializeComponent() 而不是 DataContext xaml 之前对您的构造函数执行 this.DataContext = this。

# c# - 哪个更好？这还重要吗？

> ID：10591315
> 
> 赞同：0
> 
> 时间：2012-05-14T21:26:27.397
> 
> 标签：c#, optimization

这可能是一个愚蠢的问题，但假设我想从`OnSelectedIndexChanged`我的 ASP .NET 应用程序中的事件中获取两个值。
哪个更好？

```
var personId = Convert.ToInt32(((GridView)sender).SelectedDataKey.Values["PersonId"]);
var name = ((GridView)sender).SelectedDataKey.Values["Name"].ToString(); 
```

或者

```
var gView = (GridView)sender;
var personId = Convert.ToInt32(gView.SelectedDataKey.Values["PersonId"]);
var name = gView.SelectedDataKey.Values["Name"].ToString(); 
```

就速度而言，两次投射 GridView 是否会产生如此大的差异？如果我拉更多的价值怎么办？有没有其他的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T21:29:35.600

后者（施放一次）会稍微快一些。我也更喜欢它的可读性。性能差异是如此之小，以至于在这种情况下真正考虑它很可能是毫无意义的微优化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T21:29:00.280

编译器将为您优化。为了可读性，我更喜欢第二个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T21:28:49.703

不铸造更好。理论上它在实践中更快，这并不重要。但是，您转换一次的事实会导致代码更清晰。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T21:28:59.620

我会选择不投超过我需要的。在这种情况下，性能方面并不重要，但它更容易遵循。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-14T21:33:10.763

由于一个铸造和可读性，我会选择几乎没有改进的第二个选项

```
var key = ((GridView)sender).SelectedDataKey;
var personId = Convert.ToInt32(key.Values["PersonId"]);
var name = key.Values["Name"].ToString(); 
```

此代码也更好地显示了意图 - 您在此处使用 DataKey，而不是使用整个 GridView，因此您不需要保留对 GridView 对象的引用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-14T21:33:03.023

施放两次比施放一次花费更多。
有一个选项，编译器将在两种情况下输出相同的 .dll，这意味着它已经为您优化它 - 更确定的是 - 使用第一个选择编译它并保存您获得的 .DLL，然后使用第二个选择编译它.
比较两个 .DLL 的大小 - 如果它相同 - 编译器已经为您优化了它，否则选择第二个选择，因为它更具可读性和更优化。

# linux - Running cron produces different result than running its command

> ID：10591318
> 
> 赞同：0
> 
> 时间：2012-05-14T21:26:48.097
> 
> 标签：linux, bash, shell, amazon-s3, cron

I have the following script that saves a db backup to s3:

```
# next, backup the mysql `premiered` database to the backups folder
echo successfully backed up mysql databasee
mysqldump --single-transaction -u root test | gzip  > $BACKUPFOLDER/$CONNECT

# finally, save the backups to s3 via s3fs
s3fs test-backups ./s3fs
cp $BACKUPFOLDER/$CONNECT ./s3fs/$CONNECT
echo succeessfully saved sql file to s3 
```

When I run this as a shell command, `$ ./backup.sh`, it correctly saves the file to S3\. However, when I run this command via cron, it literally saves the file to the local `./s3fs` folder and does not save it to S3\. Why does this occur and what do I need to do to fix this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:34:43.637

cron 作业在`cron`默认情况下无权访问您的 S3 凭据的用户下执行。我想您将它们存储在您的`S3_*`环境变量中，但是 cron 作业在几乎空的环境中执行。

# php - 未定义的索引 uid 调用 GET fetch

> ID：10591320
> 
> 赞同：0
> 
> 时间：2012-05-14T21:27:01.733
> 
> 标签：php, html, sql, fetch

我有一个调用 SQL 查询的函数，该函数是 fetch_user 类型

现在我在调用查询时收到未定义索引错误，错误消息是

> 未定义索引：第 3 行 profile.php 中的 uid

但问题是我找不到错误，

这是我的 user.inc.php 有这个功能

```
function fetch_user_info($uid){
    $uid = (int)$uid;

    $sql = "SELECT
    `user_name` AS `username`,
    `user_email` AS `email`
    FROM `users`
    WHERE `user_id` = {$uid} ";

    $result = mysql_query($sql);

    return mysql_fetch_assoc($result);

}

?> 
```

这是我的 profile.php 获取功能

```
$user_info = fetch_user_info($_GET['uid']);
print_r($user_info); 
```

任何想法可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:34:18.433

你确定GET请求中有uid参数吗？

我的意思是网址中有这样的东西吗？

[http://example.com/profile.php?uid=1](http://example.com/profile.php?uid=1)

也许最好通过使用 isset($_GET['uid']) 来检查 $_GET['uid'] 是否为 isset？

我会这样尝试：

```
$uid = isset($_GET['uid']) ? (int)$_GET['uid'] : 0; 
```

然后尝试调用该函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:30:08.813

这意味着 GET 变量`uid`未设置，因此您在调用页面时做错了。您是否尝试过 profile.php?uid=000 （其中 000 是 a `uid`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-28T21:31:33.960

好吧，我今天在我的脚本中进行了一些更新后遇到了这样的错误，由于 .htaccess 文件，问题没有发生，我错过了这个：

`Options -MultiViews`

所以，现在问题已经解决了。谢谢你。

# iphone - NSData initWithContentsOfFile 为空

> ID：10591324
> 
> 赞同：1
> 
> 时间：2012-05-14T21:27:36.943
> 
> 标签：iphone, nsxmlparser, nsdata

我创建了一个简单的测试项目来解析 XML。我在我的应用程序中为此测试创建了一个 .plist 文件。我将它复制到documentsDirectory。我可以看到文件被复制了。当我尝试将其初始化为 NSXMLParser 的 NSData 对象时，我得到：

```
The operation couldn’t be completed. (NSXMLParserErrorDomain error 4.) 
```

这告诉我该文件不存在。我检查了 NSData 不是 nil，并且 fileExistsAtPath，并且都检查好了。我有点坚持下一步要尝试什么。有什么想法吗？谢谢。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    [self createEditableCopyOfDatabaseIfNeeded];

    NSString *path = [[self applicationDocumentsDirectory] stringByAppendingPathComponent:@"testList.plist"];

    NSData *data = [[NSData alloc] initWithContentsOfFile:path];
if (data == nil) {
    NSLog(@"yes nil");
}
    NSXMLParser *parser = [[NSXMLParser alloc] initWithData:data];
    parser.delegate = self;
    [parser parse];

}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (void)createEditableCopyOfDatabaseIfNeeded  
{ 
    // First, test for existence. 
    BOOL success; 
    NSFileManager *fileManager = [NSFileManager defaultManager]; 
    NSError *error; 

    NSString *writableDBPath = [[self applicationDocumentsDirectory] stringByAppendingPathComponent:@"testList.plist"]; 
    success = [fileManager fileExistsAtPath:writableDBPath]; 
    if (success) return; 
    // The writable database does not exist, so copy the default to the appropriate location. 
    NSString *defaultDBPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"testList.plist"]; 
    success = [fileManager copyItemAtPath:defaultDBPath toPath:writableDBPath error:&error]; 
    if (!success) { 
        NSAssert1(0, @"Failed to create writable database file with message '%@'.", [error localizedDescription]); 
    }
}

- (NSString *)applicationDocumentsDirectory {
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); 
    NSString *documentsDirectory = [paths objectAtIndex:0]; 
    return documentsDirectory;
}

#pragma mark - NSXMLParserDelegate
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict {
    if ([elementName isEqualToString:@"hg19Packet0.bin"]) {
        NSLog(@"first");
    }
}

- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError {
    NSLog(@"%@", [parseError localizedDescription]);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:30:50.890

您是否从文本编辑器查看过您的示例 plist？如果您将其保存为二进制属性列表，则无法使用 NSXMLParser 解析它（我相信）。但是，您可以使用 NSPropertyListSerialization 来解析它。

# visual-studio - format the source code from TAB to Space

> ID：10591325
> 
> 赞同：0
> 
> 时间：2012-05-14T21:27:40.263
> 
> 标签：visual-studio

VS2010 IDE: Downloaded some source code from internet and the project is tab formatted. How can I change it to be use white space instead of tabs?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T21:29:47.037

编辑 -> 高级 -> 取消选中所选行

# emacs - 为当前行号着色

> ID：10591334
> 
> 赞同：3
> 
> 时间：2012-05-14T21:28:01.153
> 
> 标签：emacs, elisp

我正在使用`global-linum-mode`行号。如果当前行的行号用不同的颜色（和/或不同的背景）突出显示，那就太好了。有人知道如何实现这一目标吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T01:40:30.963

我从我之前对[Emacs 中的相对行号](https://stackoverflow.com/questions/6874516/relative-line-numbers-in-emacs/6928112#6928112)的回答中得出了这个答案，因为它处理了在 linum 格式过程中记住当前行号的相同问题。

我从`linum`面部继承，但使用来自`hl-line`. 如果前景和背景不能很好地匹配，您可以使用显式分配前景色
`M-x` `customize-face` `RET` `my-linum-hl` `RET`

```
(require 'hl-line)

(defface my-linum-hl
  `((t :inherit linum :background ,(face-background 'hl-line nil t)))
  "Face for the current line number."
  :group 'linum)

(defvar my-linum-format-string "%3d")

(add-hook 'linum-before-numbering-hook 'my-linum-get-format-string)

(defun my-linum-get-format-string ()
  (let* ((width (1+ (length (number-to-string
                             (count-lines (point-min) (point-max))))))
         (format (concat "%" (number-to-string width) "d")))
    (setq my-linum-format-string format)))

(defvar my-linum-current-line-number 0)

(setq linum-format 'my-linum-format)

(defun my-linum-format (line-number)
  (propertize (format my-linum-format-string line-number) 'face
              (if (eq line-number my-linum-current-line-number)
                  'my-linum-hl
                'linum)))

(defadvice linum-update (around my-linum-update)
  (let ((my-linum-current-line-number (line-number-at-pos)))
    ad-do-it))
(ad-activate 'linum-update) 
```

与其他答案一样，这在生成动态宽度方面比默认`dynamic`格式更有效，但是您可以通过注释掉该行来使用静态宽度以获得最大速度`(add-hook linum-before-numbering-hook 'my-linum-get-format-string)`（并可选择修改初始值`my-linum-format-string`以设置您的首选宽度）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-09-25T05:01:06.560

它可以通过[hlinum](http://melpa.milkbox.net/#/hlinum)扩展来实现。

```
(require 'hlinum)
(hlinum-activate) 
```

您可以更改`linum-highlight-face`以自定义背景和前景色。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T22:27:46.087

我不确定行号，但您可以使用`global-hl-line-mode`突出显示当前行。

# python - Remove all occurrences of several chars from a string

> ID：10591337
> 
> 赞同：16
> 
> 时间：2012-05-14T21:28:06.380
> 
> 标签：python, string, string-formatting, built-in

Is there a pythonic way to do what the [`str.strip()`](http://docs.python.org/library/stdtypes.html#str.strip) method does, except for *all* occurrences, not just those at the beginning and end of a string?

Example:

```
>> '::2012-05-14 18:10:20.856000::'.strip(' -.:')
>> '2012-05-14 18:10:20.856000' 
```

I want

```
>> '::2012-05-14 18:10:20.856000::'.crazy_function(' -.:')
>> '20120514181020856000' 
```

Does Python provides me a built-in `crazy_function`???

I could easily do it programatically, but I want to know if there is a built-in for that. Couldn't find one. Thank you for your help.

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-14T21:30:19.480

使用该[`translate`](http://docs.python.org/library/stdtypes.html#str.translate)功能删除不需要的字符：

```
>>> '::2012-05-14 18:10:20.856000::'.translate(None, ' -.:')
'20120514181020856000' 
```

确保您的字符串是`str`type 而不是`unicode`，因为函数的参数不会相同。对于 unicode，使用以下语法；它包括从要删除的字符中构建 unicode 序数的字典并将它们映射到`None`：

```
>>> u'::2012-05-14 18:10:20.856000::'.translate({ord(k):None for k in u' -.:'})
u'20120514181020856000' 
```

与 进行性能比较的一些时间安排`re`：

```
>>> timeit.timeit("""re.sub(r"[ -.:]", r"", "'::2012-05-14 18:10:20.856000::'")""","import re")
7.352270301875713
>>> timeit.timeit("""'::2012-05-14 18:10:20.856000::'.translate(None, ' -.:')""")
0.5894893344550951 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T21:30:54.133

你可以很容易地做到这一点`re.sub`

```
>>> import re
>>> re.sub(r"[ -.:]", r"", "'::2012-05-14 18:10:20.856000::'")
'20120514181020856000'
>>> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T21:32:06.470

不，我认为没有内置的。

我会这样做：

```
>>> s = '::2012-05-14 18:10:20.856000::'
>>> 
>>> ''.join(x for x in s if x not in ' -.:')
'20120514181020856000'
>>> 
```

# octave - Gradient Descent implementation in octave

> ID：10591343
> 
> 赞同：45
> 
> 时间：2012-05-14T21:28:42.883
> 
> 标签：octave

I've actually been struggling against this for like 2 months now. What is it that makes these different?

```
hypotheses= X * theta
temp=(hypotheses-y)'
temp=X(:,1) * temp
temp=temp * (1 / m)
temp=temp * alpha
theta(1)=theta(1)-temp

hypotheses= X * theta
temp=(hypotheses-y)'
temp=temp * (1 / m)
temp=temp * alpha
theta(2)=theta(2)-temp

theta(1) = theta(1) - alpha * (1/m) * ((X * theta) - y)' * X(:, 1);
theta(2) = theta(2) - alpha * (1/m) * ((X * theta) - y)' * X(:, 2); 
```

The latter works. I'm just not sure why..I struggle to understand the need for the matrix inverse .

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2014-03-19T19:01:34.327

What you're doing in the first example in the second block you've missed out a step haven't you? I am assuming you concatenated X with a vector of ones.

```
 temp=X(:,2) * temp 
```

The last example will work but can be vectorized even more to be more simple and efficient.

I've assumed you only have 1 feature. it will work the same with multiple features since all that happens is you add an extra column to your X matrix for each feature. Basically you add a vector of ones to x to vectorize the intercept.

You can update a 2x1 matrix of thetas in one line of code. With x concatenate a vector of ones making it a nx2 matrix then you can calculate h(x) by multiplying by the theta vector (2x1), this is (X * theta) bit.

The second part of the vectorization is to transpose (X * theta) - y) which gives you a 1*n matrix which when multiplied by X (an n*2 matrix) will basically aggregate both (h(x)-y)x0 and (h(x)-y)x1\. By definition both thetas are done at the same time. This results in a 1*2 matrix of my new theta's which I just transpose again to flip around the vector to be the same dimensions as the theta vector. I can then do a simple scalar multiplication by alpha and vector subtraction with theta.

```
X = data(:, 1); y = data(:, 2);
m = length(y);
X = [ones(m, 1), data(:,1)]; 
theta = zeros(2, 1);        

iterations = 2000;
alpha = 0.001;

for iter = 1:iterations
     theta = theta -((1/m) * ((X * theta) - y)' * X)' * alpha;
end 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-16T22:47:40.597

在第一个中，如果 X 是一个 3x2 矩阵并且 theta 是一个 2x1 矩阵，那么“假设”将是一个 3x1 矩阵。

假设 y 是一个 3x1 矩阵，那么您可以执行 (hypotheses - y) 并得到一个 3x1 矩阵，那么该 3x1 的转置是一个分配给 temp 的 1x3 矩阵。

然后将 1x3 矩阵设置为 theta(2)，但这不应该是矩阵。

代码的最后两行有效，因为使用我上面的 mxn 示例，

```
(X * theta) 
```

将是一个 3x1 矩阵。

然后将该 3x1 矩阵减去 y（一个 3x1 矩阵），结果是一个 3x1 矩阵。

```
(X * theta) - y 
```

所以3x1矩阵的转置是1x3矩阵。

```
((X * theta) - y)' 
```

最后，一个 1x3 矩阵乘以一个 3x1 矩阵将等于一个标量或 1x1 矩阵，这就是您要寻找的。我相信你已经知道了，但为了彻底，X(:,2) 是 3x2 矩阵的第二列，使其成为 3x1 矩阵。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-10-18T21:45:37.553

```
function [theta, J_history] = gradientDescent(X, y, theta, alpha, num_iters)
% Performs gradient descent to learn theta. Updates theta by taking num_iters 
% gradient steps with learning rate alpha.

% Number of training examples
m = length(y); 
% Save the cost J in every iteration in order to plot J vs. num_iters and check for convergence 
J_history = zeros(num_iters, 1);

for iter = 1:num_iters
    h = X * theta;
    stderr = h - y;
    theta = theta - (alpha/m) * (stderr' * X)';
    J_history(iter) = computeCost(X, y, theta);
end

end 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-10-22T19:21:48.507

当您更新时，您需要这样做

```
Start Loop {

temp0 = theta0 - (equation_here);

temp1 = theta1 - (equation_here);

theta0 =  temp0;

theta1 =  temp1;

} End loop 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-11-01T12:13:33.323

这可以更简单地用

```
h = X * theta   % m-dimensional matrix (prediction our hypothesis gives per training example)
std_err = h - y  % an m-dimensional matrix of errors (one per training example)
theta = theta - (alpha/m) * X' * std_err 
```

请记住`X`， 是设计矩阵，因此 的每一行`X`代表一个训练示例，而 的每一列`X`代表所有训练示例中的给定组件（例如第零个或第一个组件）。因此， 的每一列`X`正是我们想要将元素与`std_err`之前求和的东西相乘以获得 theta 向量的相应分量。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2019-03-19T19:59:12.117

```
function [theta, J_history] = gradientDescent(X, y, theta, alpha, num_iters)
m = length(y); % number of training examples
J_history = zeros(num_iters, 1);
for iter = 1 : num_iters
    hypothesis = X * theta;
    Error = (hypothesis - y);
    temp = theta - ((alpha / m) * (Error' * X)');
    theta = temp;
    J_history(iter) = computeCost(X, y, theta);
end
end 
```

* * *

## 回答 #7

> 赞同：-9
> 
> 时间：2014-06-05T15:55:36.447

```
.
.
.
.
.
.
.
.
.
Spoiler alert

m = length(y); % number of training examples
J_history = zeros(num_iters, 1);

for iter = 1:num_iters

% ====================== YOUR CODE HERE ======================
% Instructions: Perform a single gradient step on the parameter vector
%               theta. 
%
% Hint: While debugging, it can be useful to print out the values
%       of the cost function (computeCost) and gradient here.
% ========================== BEGIN ===========================

t = zeros(2,1);
J = computeCost(X, y, theta);
t = theta - ((alpha*((theta'*X') - y'))*X/m)';
theta = t;
J1 = computeCost(X, y, theta);

if(J1>J),
    break,fprintf('Wrong alpha');
else if(J1==J)
    break;
end;

% ========================== END ==============================

% Save the cost J in every iteration    
J_history(iter) = sum(computeCost(X, y, theta));
end
end 
```

# playframework-2.0 - Play! 2.0.1 - css in assets

> ID：10591344
> 
> 赞同：3
> 
> 时间：2012-05-14T21:28:46.443
> 
> 标签：playframework-2.0, playframework

Underneath the `app` directory, I can reference a javascript file, `ajavascriptfile.js`, inside of a package, from an html document:

```
<script src="/assets/css/test/ajavascriptfile.js"></script> 
```

![enter image description here](../Images/617e35f752223c7a77248f369e6c1880.png)

However, I **can't** reference the css file, `acssfile.css`, inside of an html document:

```
<script src="/assets/css/test/acssfile.css"></script> 
```

No error is thrown except in the console, which states the file is not found. Is there a route I'm missing? For organization, it just seems makes sense to use packages to manage them, as opposed to the public folders (where I'm putting 3rd party files).

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T12:21:18.627

H.Buzz 是对的，资产在 Play 2.0 中的工作方式，您需要将静态资产放入`public/`. `app/assets/`开箱即用，`app/assets/`Play 处理的唯一文件是以`.js`,`.coffee`或`.less`.

您的 JavaScript 文件作为 Google Closure Compiler 编译的一部分被复制。对于 CSS 文件，没有等效的处理，因此不会被复制。

您需要将文件放入`public/`或扩展 Play 的资产处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T01:55:21.150

1.  检查文件

{projectfolder}/**公共**/css/test/acssfile.css

1.  编辑代码

```
 link rel="stylesheet" media="screen" href="@routes.Assets.at("css/test/acssfile.css")"> :)

```

# c# - 如何首先在实体框架/代码中将密钥与另一个对象包装起来

> ID：10591346
> 
> 赞同：0
> 
> 时间：2012-05-14T21:28:49.887
> 
> 标签：c#, entity-framework-4.1, ef-code-first

我刚开始先在实体框架/代码中对我们现有的对象模型进行原型设计，然后遇到了我的第一个障碍。不幸的是，这方面的文档似乎非常稀缺。

我的密钥不是原始的，而是包装原始的对象。我如何让它首先与 EF/Code 一起使用：

```
public class EFCategoryIdentity 
{
    public string IdentityValue { get; private set; }
    public EFCategoryIdentity(string value)
    {
        IdentityValue = value;
    }
}

public class EFCategory
{
    [Key]
    public EFCategoryIdentity CategoryIdentity { get; set; }
    public string Name { get; set; }
    public virtual ICollection<EFProduct> Products { get; set; }
}

public class EFProduct
{
    [Key]
    public int ProductId { get; set; }
    public string Name { get; set; }
    public virtual EFCategory Category { get; set; }
} 
```

我需要在这里放什么才能完成这项工作？

```
public class MyTestContext : DbContext
{
    public DbSet<EFCategory> Categories { get; set; }
    public DbSet<EFProduct> Products { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<EFCategory>()
            .// Help!
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T06:28:45.363

实体框架只能使用原始类型作为键。每次您将一些映射属性包装到单独的类型时，您都在创建复杂类型。复杂类型有一些限制

*   它们不能是钥匙
*   它们不能包含密钥
*   它们不能包含导航属性
*   等等

# jquery - Scrollto a class not in view, added with jQuery

> ID：10591352
> 
> 赞同：1
> 
> 时间：2012-05-14T21:29:05.673
> 
> 标签：jquery, scrollto, soundcloud

So I'm having a problem with my songs not scrolling into view when the selected song is not in view.

I'm using Soundcloud's API custom player, so

```
<div class="sc-player">
    <a href="http://soundcloud.com/user/song">Song Name</a>
</div> 
```

turns into this on page load: [http://nowthatsgenius.com/clients/ageniusalbum/](http://nowthatsgenius.com/clients/ageniusalbum/) (too much to add, but there's my example).

So when a song ends and the next song begins, the LI class 'active' is removed from the prev song and appended to the new song's LI. So I need the ScrollTo script to scroll the next song into view. I'm only a UI designer, with some jQuery knowledge, but not enough to solve this problem.

The end goal is mobile. While you're listening, if you need to check which song you are on, if say for example the phone goes to sleep, you turn the phone back and check, the active song should be in view and you shouldn't have to scroll and find the active song.

I'm using this script: [http://flesler.blogspot.com/2007/10/jqueryscrollto.html](http://flesler.blogspot.com/2007/10/jqueryscrollto.html)

```
$(document).ready(function() {
$(".sc-player").scrollTo($('.sc-trackslist li.active'), 800 );
}); 
```

My attempt to call the ScrollTo function, but when that happens, I get the:

"Uncaught TypeError: Cannot read property 'slice' of undefined" error

If you know of a lead to a solution, please let me know.

Thanks!

# regex - .htaccess 将目录 1 重定向到目录 2 而不匹配目录 2

> ID：10591358
> 
> 赞同：0
> 
> 时间：2012-05-14T21:29:12.993
> 
> 标签：regex, .htaccess

我有一种情况，我试图将所有对 site.com/news 的访问重定向到 site.com/dir/news。无论我做什么，如果不匹配 site.com/dir/news，我似乎都无法匹配 site.com/news，这会导致无限重定向循环，直到浏览器超时。

这是我当前的代码。有人看到我在这里缺少什么吗？

```
RewriteRule ^(.*)news $1dir/news [R=301,L]
```

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:46:28.040

```
RewriteRule ^news(.*) dir/news$1 [R=301,L,QSA,NC] 
```

# jquery - 具有动态内容的颜色框无法正确调整组的大小

> ID：10591368
> 
> 赞同：0
> 
> 时间：2012-05-14T21:30:00.243
> 
> 标签：jquery, colorbox

我有一个组 ColorBox，我想显示来自动态源的信息，并使用 pervious 和 next 按钮遍历组。

所以：

```
$(".colorbox").colorbox({rel:'group', transition:"fade"});

<a class="colorbox" id="l_152957" rel="group" title="" href="object_snippet.php?id=152957" ><img src="images/46636_140.jpg" alt=""></a> 

<a class="colorbox" id="l_74911" rel="group" title="" href="object_snippet.php?id=74911" ><img src="images/46536_140.jpg" alt=""></a> 

<a class="colorbox" id="l_202703" rel="group" title="" href="object_snippet.php?id=202703" ><img src="images/46336_140.jpg" alt=""></a> 
```

object_snippet.php 中的 html 数据是通过 id=XXX url 变量动态生成的

我让它工作正常，但是在我单击下一个和上一个按钮后，颜色框不会调整大小以适应内容。内容在那里，但只是在一个非常小的窗口中。

知道如何实现这一点并让颜色框重新调整大小以适应动态生成的内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T01:54:20.177

当 colorbox 加载 ajax 内容时，它会将标记添加到文档中，然后使用 jQuery 来测量宽度和高度。为什么您的标记不报告您想要的尺寸？有CSS问题吗？标记是否包含您未指定尺寸的 img 元素？

# jasper-reports - JasperReports：报告 XLSX 导出工作表名称

> ID：10591370
> 
> 赞同：2
> 
> 时间：2012-05-14T21:30:09.670
> 
> 标签：jasper-reports, jasperserver

我有一个从*JR 服务器*运行的 JR 报告，我正在导出到 Excel。这是 7 个子报表，每个子报表都有自己的工作表。如果我导出到**XSL**，那么我通过设置***net.sf.jasperreports.export.xls.sheet.name***属性创建的工作表名称可以正常工作。如果我导出为**XLSX格式，大约是****XLS**大小的 1/3 ，页面名称会显示为 page1、page2 等。

**有没有办法像XLS**一样格式化**XLSX**输出的工作表名称？

 **我正在使用*iReport*和*JasperReports Server*来创建和生成报告。**

# ruby-on-rails - 确认离开页面，除非他们点击保存按钮

> ID：10591378
> 
> 赞同：0
> 
> 时间：2012-05-14T21:30:57.643
> 
> 标签：ruby-on-rails, coffeescript

我有一个创建模型的表单，如果用户离开页面，我希望出现一个对话框，除非他们单击保存/创建按钮。

我有这个 javascript 代码，可以在用户离开页面时使用；这意味着当用户单击保存/创建时，仍会出现此对话框。

```
#javascripts/workouts.js.coffee
window.confirmExit = () ->
  "Your changes will not be saved.";

#workouts/new.html.haml
= render 'form'
:javascript
  window.onbeforeunload = confirmExit

#workouts_form.html.haml
= simple_form_for(@workout) do |f|
# some input fields
= f.button :submit 
```

现在我知道我只想在`submit`未单击按钮时调用确认退出，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:38:57.983

我通常做的是仅在实际对表单进行更改时才显示确认信息。为此，您需要扫描页面上的表单，将它们序列化并将其存储在内存中。然后，当用户离开页面时，再次序列化表单，看看是否有区别。

否则，您可能希望绑定一些函数来提交表单的事件，将一些全局布尔值设置`window.formSubmitted`为 true。离开页面时检查该变量以确定是否要显示确认框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T22:34:13.347

所以我想通了，至少它适用于 chrome 和 safari，尽管现在我的印象是它不适用于 ie。我所做的是创建一个设置为 false 并且仅在选择提交按钮时设置为 true 的布尔值。

```
#javascripts/workouts.js.coffee
window.submitButtonClicked = false
window.confirmExit = () ->
  if window.submitButtonClicked
    null
  else
    "Your changes will not be saved."

$(document).ready ->
  $('#target').submit ->
    window.submitButtonClicked = true

#workouts/new.html.haml
:javascript
  window.onbeforeunload = confirmExit

#workouts_form.html.haml
#target
  = simple_form_for(@workout) do |f|
    # some input fields
    = f.button :submit 
```

我希望这可以帮助任何好奇的人。请注意，该`#target`行是实际的 haml，而不是注释。

# python - 在 Linux 上调度 Python 脚本

> ID：10591379
> 
> 赞同：4
> 
> 时间：2012-05-14T21:31:00.357
> 
> 标签：python, linux, cron

我一直在寻找最好的方法来做到这一点，但并没有真正走得太远。我有一个每天在 cron 上运行多次的 python 脚本，该脚本确定需要安排另一个脚本运行的时间和日期。该脚本需要运行的时间、日期和持续时间变化很大，它们是一次性事件。

我的问题是如何实际安排这些事件。任何人都可以建议一个合适的python或linux方法吗？

谢谢

更新：感谢小伙子的提示。

对于其他搜索此内容的人，这就是我所做的，脚本 foobar.py 在 7 月 14 日上午 9.15 运行：

```
import subprocess
subprocess.Popen(['python foobar.py | at 9.15am Jul 14',], shell=True) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T21:34:05.443

使用`at`python 脚本中的命令。[请参阅此处](http://unixhelp.ed.ac.uk/CGI/man-cgi?at)的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T03:49:16.270

```
import time,sched; 
```

我认为 sched 是您正在寻找的东西

# c# - 为什么 ItemContainerGenerator.ContainerFromIndex() 返回 null 以及如何避免这种行为？

> ID：10591391
> 
> 赞同：18
> 
> 时间：2012-05-14T21:32:28.610
> 
> 标签：c#, .net, wpf, datagrid, datarow

我正在使用这个片段来分析我在数据网格上选择的行。

```
for (int i = 0; i < dgDetalle.Items.Count; i++)
{
    DataGridRow row = (DataGridRow)dgDetalle.ItemContainerGenerator.ContainerFromIndex(i);
    FrameworkElement cellContent = dgDetalle.Columns[0].GetCellContent(row);
    // ... code ...
} 
```

循环运行平稳，但是在处理某些索引时，第二行抛出了一个空异常。MSDN 的文档说，`ItemContainerGenerator.ContainerFromIndex(i)`如果“如果未实现该项目”，它将返回 null，但这并不能帮助我猜测如何获得所需的值。

如何扫描所有行？还有其他方法吗？

**更新**

我正在使用此代码段来阅读[此处](https://stackoverflow.com/q/10502960/199419)`CheckBox`解释的内容。所以除非我改变很多东西，否则我不能使用绑定或根本无法使用。而我不能。我正在做代码维护。`ItemSource`

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2015-01-06T05:32:58.760

试试这个，

```
DataGridRow row = (DataGridRow)grid.ItemContainerGenerator.ContainerFromIndex(index);
        if (row == null)
        {
                          grid.UpdateLayout();
            grid.ScrollIntoView(grid.Items[index]);
            row = (DataGridRow)grid.ItemContainerGenerator.ContainerFromIndex(index);
        } 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-14T21:41:04.480

这`DataGrid`是虚拟化项目，相应的行（即容器）仅在行在视图中时创建。

您可以[关闭虚拟化](http://msdn.microsoft.com/en-us/library/system.windows.controls.virtualizingstackpanel.isvirtualizing.aspx)（如果您有很多项目，这会使第一次加载非常慢，内存使用率也会更高），或者您只需遍历数据并检查应该绑定的数据对象属性的值到数据网格。通常你根本不需要 UI 元素......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-26T13:14:24.787

使用此订阅：

```
TheListBox.ItemContainerGenerator.StatusChanged += (sender, e) =>
{
  TheListBox.Dispatcher.Invoke(() =>
  {
     var TheOne = TheListBox.ItemContainerGenerator.ContainerFromIndex(0) as ListBoxItem;
       if (TheOne != null)
         // Use The One
  });
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-03T01:27:57.037

除了其他答案：控件类（页面/窗口/等）的构造函数中没有可用的项目。

如果要在创建后访问它们，请使用`Loaded`事件：

```
public partial class MyUserControl : UserControl
{
    public MyUserControl(int[] values)
    {
        InitializeComponent();

        this.MyItemsControl.ItemsSource = values;

        Loaded += (s, e) =>
        {
            for (int i = 0; i < this.MyItemsControl.Items.Count; ++i)
            {
                // this.MyItemsControl.ItemContainerGenerator.ContainerFromIndex(i)
            }
        };
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-19T14:37:36.117

在我的情况下`grid.UpdateLayout();`没有帮助我需要一个`DoEvents()`代替：

```
 DataGridRow row = (DataGridRow)grid.ItemContainerGenerator.ContainerFromIndex(index);

    if (row == null)
    {

        WPFTools.DoEvents();

        grid.ScrollIntoView(grid.Items[index]);
        row = (DataGridRow)grid.ItemContainerGenerator.ContainerFromIndex(index);
    }

    /// <summary>
    /// WPF DoEvents
    /// Source: https://stackoverflow.com/a/11899439/1574221
    /// </summary>
    public static void DoEvents()
    {
        var frame = new DispatcherFrame();

        Dispatcher.CurrentDispatcher.BeginInvoke(DispatcherPriority.Background,
            new DispatcherOperationCallback(
                delegate (object f)
                {
                    ((DispatcherFrame)f).Continue = false;
                    return null;
                }), frame);

        Dispatcher.PushFrame(frame);
    } 
```

# scala - 如何从 Play 2 上的路由反向生成 URL？

> ID：10591396
> 
> 赞同：2
> 
> 时间：2012-05-14T21:32:43.320
> 
> 标签：scala, playframework-2.0

在 Play 1.4.x 下，如果我想反向生成一个 URL，我可能会使用如下内容：

```
Map<String, Object> map = new TreeMap();
map.put("myParam", myParam);
ActionDefinition ad = Router.reverse("MyAction.query", map);
String url = ad.url; 
```

根据始终简洁的 Play 2.x[文档](http://www.playframework.org/documentation/2.0.1/ScalaRouting)，在 Play 2 with Scala 下，我应该使用重定向：

```
val action = Action {Redirect(routes.MyAction.query(myParam))} 
```

但是我如何处理获取实际 URL 的操作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-15T07:04:51.700

```
val relative = routes.MyAction.query(myParam).url 
```

或绝对

```
val url = routes.MyAction.query(myParam).absoluteURL() 
```

或绝对 https

```
val securedUrl = routes.MyAction.query(myParam).absoluteURL(true) 
```

# java - 插件的反射

> ID：10591398
> 
> 赞同：1
> 
> 时间：2012-05-14T21:33:00.133
> 
> 标签：java, reflection

在 CI 中，可以通过让共享库实现以下接口来编写插件：

```
extern "C" int initialize(SomeArgument * state);
extern "C" int shutdown(SomeArgument * state); 
```

显然这是一个*非常*高级的界面，但我认为它明白了这一点。我听说反射的一个很好的用途是编写插件，但是为什么这会比我这里的更好呢？使用这样的接口具有以下优点：

*   更快（反射不快，查找方法和间接调用）
*   内存（反射有内存开销）
*   直截了当（插件的入口/出口点非常明显）

我只是错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:38:05.203

我能想到的主要优点是您可以使用包含`plugins`在运行时动态加载的属性文件（通过反射）。

或者您可以扫描特定目录中的插件并（尝试）通过反射自动加载/实例化它们。

当然，这并不意味着这些插件不应该实现特定的接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T16:47:38.873

我想没有明确的理由为什么应该在接口上使用反射，并且有很多理由使用接口而不是反射。我想这很清楚。

所有提供答案的人，谢谢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T22:04:53.177

考虑这个有用的插件接口：

```
public interface EntityAuditor {

    <T> void auditEntity(Class<T> clazz, T entity);

} 
```

具有 T 必须是合法注释的 JPA @Entity 的约束，否则将引发运行时异常。创建某种您希望插件审核的系统中的每个实体都必须遵守的接口是不切实际的。您可以有某种“可审计实体”接口来返回插件所需的信息，但现在实体内部有关于如何以及什么被审计的实现和耦合！该插件的重点是将其抽象出来，并能够在*不*更改实体的情况下更改审计方式/内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T07:15:31.873

1.  反射可用于读取类静态变量和调用类静态方法。读取类静态变量可用于获取有关插件的信息（如其版本号），而无需首先创建实例。调用类静态方法可用于将插件实现为单例。
2.  如果插件不是单例，可以使用反射来调用接受参数的构造函数，而没有反射则只能调用无参数构造函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T22:15:49.990

一种观点是，与您列出的“C”接口不同，插件可以很好地集成到 Eclipse 或 Visual Studio .NET 等 IDE 中。例如，在 IDE 中，该工具可以列出所有公共/公开的功能，包括参数。现在使用 OO 编程，接口更加复杂。如果插件与 IDE 配合得很好，那么界面就更容易理解了。

一些插件是基于 GUI 的并公开事件/侦听器，这比“C”接口更复杂。这一切有意义吗？

# javascript - 如何使用带有 ListLayout 布局的 WinJS.UI.ListView 实现组

> ID：10591405
> 
> 赞同：1
> 
> 时间：2012-05-14T21:33:28.047
> 
> 标签：javascript, html, windows-8

如何使用带有 ListLayout 的 WinJS.UI.ListView 实现组：

```
 <div id="itemTemplate" data-win-control="WinJS.Binding.Template">
            <div data-win-bind="innerText: title"></div>
        </div>  
        <div id="headerTemplate" data-win-control="WinJS.Binding.Template">
            <div data-win-bind="innerText: group"></div>
        </div>  
        <div id="menu" data-win-control="WinJS.UI.ListView" data-win-options="{automaticallyLoadPages:false, groupHeaderTemplate:select('#headerTemplate'), groupDataSource:QuickGuide.itemListGrouped.groups.dataSource, itemDataSource:QuickGuide.itemListGrouped.dataSource, itemTemplate:select('#itemTemplate'), layout:{type:WinJS.UI.ListLayout}}">
        </div> 
```

JS文件：

```
function getGroupKey(dataItem) {
    return dataItem.group;
}

function getGroupData(dataItem) {
    return {
        group: dataItem.group
    };
}

var dataList = new WinJS.Binding.List(dataArray);
var dataListGrouped = dataList.createGrouped(getGroupKey, getGroupData);

WinJS.Namespace.define("QuickGuide", {
    data: dataArray,
    itemList: dataList,
    itemListGrouped: dataListGrouped
}); 
```

它仅适用于 GridLayout，不适用于 ListLayout。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T13:46:00.210

我认为不认为`ListLayout`支持 a 。参考 MSDN 文档，有属性，但没有。也许微软认为有一个for没有意义，因为在我看到的所有示例中，垂直滚动要么没有“组”，要么将“groupHeader”显示为列表项而不是真实的（参考：VS11 生成的 GridLayout 应用程序）中的项目。如果您不想水平滚动，那么只需使用 css 使其看起来像“列表项”而不是“网格”（参考：/Build// 消费者预览商店中的应用程序）`groupHeader``GridLayout`[`WinJS.UI.GridLayout`](http://msdn.microsoft.com/en-us/library/windows/apps/br211751.aspx)`groupHeader`[`WinJS.UI.ListLayout`](http://msdn.microsoft.com/en-us/library/windows/apps/br211792.aspx)`groupHeader``ListLayout``ListLayout``ListView``ListView``groupHeader`

# javascript - Sencha Touch 2 Ext.List - 以编程方式添加详细视图

> ID：10591406
> 
> 赞同：1
> 
> 时间：2012-05-14T21:33:37.530
> 
> 标签：javascript, sencha-touch, extjs, sencha-touch-2, ext.list

我正在尝试根据列表中的录音项目添加不同的详细信息视图。

*   我有使用列表组件的主屏幕，此视图显示 ['Real Estate', 'Vehicles', 'Jobs']... 作为菜单项。
*   根据列表中的选定项目，我想显示不同的视图。
    *   我想遵循 MVC 设计模式..

这是一些代码... App.js

```
Ext.application({
name: 'App',

controllers: ['Main'],
views: ['Viewport', 'HomePage'],
stores: ['HomePageItems'],
models: ['HomePageItem'],

launch: function () {
    Ext.Viewport.add(Ext.create('App.view.Viewport'));
} 
```

});

视口.js

```
Ext.define("App.view.Viewport", {
extend: 'Ext.navigation.View',

requires: [ 'App.view.realestate.Realestate',
            'App.view.HomePage',
            'App.view.jobs.Jobs',
            'App.view.other.Other',
            'App.view.vehicles.Vehicles'
           ],

config: {
    items: [
        {
            xtype: 'homepage'
        }
    ]
} 
```

});

HomePage.js ( xtype = "主页" )

```
Ext.define('App.view.HomePage', {
extend: 'Ext.List',
xtype: 'homepage',
id: 'homepage',

config: {
    title: 'Oglasi',
    itemTpl: '<strong>{name}</strong><p style="color:gray; font-size:8pt">{description}</p>',
    store: 'HomePageItems',
    onItemDisclosure: true
} 
```

});

主.js

```
Ext.define('App.controller.Main', {
extend: 'Ext.app.Controller',

config: {
    refs: {
        main: '#homepage'
    },

    control: {
        'homepage': {
            disclose: 'HookUpDetailView'
        }
    }
},

HookUpDetailView: function (element, record, target, index, ev) {
    // TO DO: I have 4 differente views to load programmaticaly based on selected item in List
    //'App.view.realestate.Realestate'
    //'App.view.jobs.Jobs'
    //'App.view.other.Other'
    //'App.view.vehicles.Vehicles'
} 
```

});

我找到了一个例子，但它对我不起作用（推送方法不存在）

```
this.getMain().push({
        xtype: 'realestatehome'
    }); 
```

预先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T05:33:38.910

您正在寻找的方法是

[http://docs.sencha.com/touch/2-0/#!/api/Ext.Container-method-add](http://docs.sencha.com/touch/2-0/#!/api/Ext.Container-method-add)

```
this.getMain().add({xtype: 'realestatehome'}); 
```

但是你所拥有的没有意义，realestatehome 是一个列表，你不能在它下面添加一个组件。您需要阅读有关布局的信息来自上面的链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T05:22:47.273

推应该工作。你可以试试这样的。

```
 HookUpDetailView: function (list, record) {

           if(record.data.description==='real estate'){

                  this.getRealEstate().push({
                      xtype: 'realestatehome',
                      title: record.data.description,
                      data.  record.data

           });

           if(record.data.description==='Vehicles'){

                  this.getVehicles().push({
                      xtype: 'vehicles',
                      title: record.data.description,
                      data.  record.data

           });

     }
} 
```

一个特定的视图可能看起来像

```
Ext.define('App.view.RealEstateHome', {
    extend: 'Ext.Panel',
    xtype: 'realestatehome',
    config: {
        styleHtmlContent: true,
        scrollable: 'vertical',
        tpl: [
            '{description}, {example}, {example}, {example}'
        ]
    }
}); 
```

访问您的特定视图的参考应该看起来像

```
refs: {
        realEstate: 'realestatehome',
        vehicles:   'vehicleshome'
    }, 
```

希望有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T11:46:58.423

我在控制器 this.getMain() get main 中犯了一个错误，它正在返回 Ext.List，我需要具有“push”方法的 Ext.navigation.View。

所以......我在我的视口（“容器”）中添加了 xtype 和 id 并且我的控制器中的快速更改解决了我的麻烦......

```
refs: {
    main: '#homepage',
    container: '#container'
} 
```

而不是获取 Ext.List 对象

```
this.getContainer().push({
    xtype: 'realestatehome'
}); 
```

而这项工作就像一个魅力:)

# mysql - 如何创建“跟随”表？

> ID：10591413
> 
> 赞同：0
> 
> 时间：2012-05-14T21:33:49.680
> 
> 标签：mysql, database, database-design

我正在设计一个简单的 twitter 网站（用于学习），但有一点不同：用户可以关注其他用户、关键字和列表。我想知道如何创建一个下表来放置有关关注的信息。

这种方法（下）正确吗？

下表：

```
id ( id of the following table )
type ( type can be 1 ( user ), 2 ( keyword ) or 3 ( list ) )
idtype ( id of the type table )
user ( user's id ) 
```

但是没有关键字表。所以我不知道。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:31:56.813

这是不正确的，因为您无法从`idtype`父表创建外键，因为“父表”会根据`type`. 顺便说一句，如果用户可以关注多个关键字，那么您将无法避免为此设置一个单独的表（除非您想通过将多个值“打包”到同一字段中来[打破 1NF ，这是一个非常糟糕的主意）。](http://en.wikipedia.org/wiki/First_normal_form#Atomicity)

有几种方法可以解决这个问题，可能最简单的一种是`id`为每个可能的父表使用单独的字段，然后限制它们，使它们中只有一个可以是非 NULL。

**但是**，由于[InnoDB 表是聚集的](http://www.ovaistariq.net/521/understanding-innodb-clustered-indexes/)，并且聚集表中的二级索引很昂贵，我宁愿使用这样的东西（未显示推文表）：

![在此处输入图像描述](../Images/986c9f251e2fa4d28722d145fcea6c66.png)

这将使您能够非常有效地回答查询：“哪些用户关注给定用户（或关键字或列表）”。如果您需要回答：“给定用户关注了哪些用户（或关键字或列表）”，请颠倒上面显示的 PK 中的字段顺序。如果您两者都需要，那么您需要双向索引（并支付集群价格）。

# ios - 价格等级生效日期

> ID：10591416
> 
> 赞同：4
> 
> 时间：2012-05-14T21:33:55.493
> 
> 标签：ios, app-store-connect

我不明白 iTunes 中价格等级生效日期和价格等级结束日期的含义。请任何人都可以解释我这些领域？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-14T21:44:41.973

这些字段的含义在当前[*iTunesConnect 开发人员指南*](https://developer.apple.com/library/ios/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide/Chapters/ChangingAppStatus.html)的“调度价格等级更改”部分中有明确说明。简而言之，它们指的是价格变化的开始和结束日期。例如，您可以将您的应用设置为在月初更改为不同的价格，然后在每月 15 日（或任何其他日期）恢复为之前的价格。

# jsf - 在 a4j:repeat jsf 标签中绑定 EL 变量

> ID：10591420
> 
> 赞同：0
> 
> 时间：2012-05-14T21:34:07.390
> 
> 标签：jsf, el, ajax4jsf

我正在使用如下验证器验证邮政编码。

```
<h:inputText id="zipCode">
    <f:validator validatorId="ZipValidator"/>
    <f:attribute name="plus4" value="#{plus4}" />
    <f:attribute name="country" value="#{country}" />
</h:inputText>
<h:inputText id="zipCodePlus4" binding="#{plus4}"/>
<h:selectOneMenu id="country" binding="#{country}"> 
```

当只有一个地址时，这可以按预期工作，但是当我在 a4j:repeat 中有一个包含多个地址的页面时，绑定会中断。我尝试使用索引变量，但我不知道如何让它与实际绑定一起工作。我尝试了一些在下面不起作用的愚蠢的东西。

```
<h:selectOneMenu id="country" binding="#{country}#{index}">
<h:selectOneMenu id="country" binding="#{country + index}"> 
```

# javascript - Bootstrap Carousel 图像未正确对齐

> ID：10591422
> 
> 赞同：96
> 
> 时间：2012-05-14T21:34:19.793
> 
> 标签：javascript, jquery, twitter-bootstrap, carousel

请看下图，我们使用引导轮播来旋转图像。但是，当窗口宽度较大时，图像无法正确对齐边框。

但是，无论窗口的宽度如何，bootstrap 提供的轮播示例总是可以正常工作。按照代码。

有人可以解释为什么轮播的行为不同吗？这与图像大小或缺少某些引导配置有关吗？

```
<section id="carousel">
<div class="hero-unit span6 columns">
    <h2>Welcome to TACT !</h2>
    <div id="myCarousel" class="carousel  slide" >
      <!-- Carousel items -->
      <div class="carousel-inner">
        <div class="item  active" >
            <img alt=""  src="/eboxapps/img/3pp-1.png">
            <div class="carousel-caption">
                <h4>1\. Need a 3rd party jar?</h4>
            </div>
        </div>
        <div class="item">
            <img alt=""  src="/eboxapps/img/3pp-2.png">
            <div class="carousel-caption">
                <h4>2\. Create Request</h4>
            </div>
        </div>
        <div class="item">
            <img alt=""  src="/eboxapps/img/3pp-3.png">
            <div class="carousel-caption">
                <h4>3\. What happens?</h4>
            </div>
        </div>
        <div class="item">
            <img alt=""  src="/eboxapps/img/3pp-4.png">
            <div class="carousel-caption">
                <h4>4\. Status is Emailed</h4>
            </div>
        </div>
      </div>
      <!-- Carousel nav -->
      <a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
      <a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
    </div>
</div> 
```

![轮播图片](../Images/c75d2ae240d8b00e89c1199fac68bf64.png)

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2013-03-27T13:59:04.357

解决方案是将此 CSS 代码放入您的自定义 CSS 文件中：

```
.carousel-inner > .item > img {
  margin: 0 auto;
} 
```

* * *

## 回答 #2

> 赞同：128
> 
> 时间：2014-08-22T18:37:12.830

使用 bootstrap 3，只需添加 responsive 和 center 类：

```
 <img class="img-responsive center-block" src="img/....jpg" alt="First slide"> 
```

这会自动调整图像大小，并使图片居中。

编辑：

使用引导程序 4，只需添加`img-fluid`类

```
<img class="img-fluid" src="img/....jpg"> 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-12-17T23:07:53.910

我遇到了同样的问题，用这种方法解决了：可以将非图像内容插入到 Carousel 中，这样我们就可以使用它了。您应该首先插入**`div.inner-item`**（您将在其中进行中心对齐），然后在此 div 中插入图像。

这是我的代码（红宝石）：

```
<div id="myCarousel" class="carousel slide">
    <!-- Carousel items -->
    <div class="carousel-inner">
        <div class="active item">
            <%= image_tag "couples/1.jpg" %>
        </div> 
        <% (2..55).each do |t|%>
            <div class="item">
                <div class='inner-item'>
                    <%= image_tag "couples/#{t}.jpg" %>
                </div>
            </div> 
        <% end -%>
    </div>
    <!-- Carousel nav -->
    <a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
    <a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
</div> 
```

还有我的 css 代码（.scss）：

```
.inner-item {
    text-align: center;
    img {
        margin: 0 auto;
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-09-06T23:13:44.410

虽然[vekozlov](https://stackoverflow.com/a/13923777/146622)的答案将在 Bootstrap 3 中使您的图像居中，但当轮播按比例缩小时它会中断：图像保持其大小，而不是随着轮播按比例缩小。

相反，请在顶级 carousel 上执行此操作`div`：

```
<div id="my-carousel" class="carousel slide"
    style="max-width: 900px; margin: 0 auto">
    ...
</div> 
```

这将使整个轮播居中，并防止它超出图像的宽度（即 900 像素或您想要设置的任何值）。然而，当轮播按比例缩小时，图像也会随之缩小。

当然，您应该将此样式信息放在您的 CSS/LESS 文件中。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-04-06T10:45:55.510

在 Bootstrap 4 中，您可以将`mx-auto`类添加到您的`img`标签。

例如，如果您的图像宽度为 75%，则应如下所示：

```
<img class="d-block w-75 mx-auto" src="image.jpg" alt="First slide"> 
```

Bootstrap 将自动转换`mx-auto`为：

```
ml-auto, .mx-auto {
    margin-left: auto !important;
}

.mr-auto, .mx-auto {
    margin-right: auto !important;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-17T22:28:24.543

我想我有一个解决方案：

在您的个人样式表页面中，指定宽度和高度以**匹配**您的图像尺寸。

在该顶部 div 上创建一个额外的单独“类”，以使用跨度来占用空间......（如下所示）

```
 <div class="span6 columns" class="carousel">
            <div id="myCarousel" class="carousel slide">
                <div class="carousel-inner">
                <div class="item active"> 
```

无需接触 bootstrap.css，在您自己的样式表中，调用“carousel”（或您选择的任何标签）以匹配原始像素的宽度和高度！

```
.carousel       {
            width: 320px;
            height: 200px; 
```

}

因此，就我而言，我使用 320x200 的小图像进行轮播。bootstrap.css 中可能有预设尺寸，但我不喜欢更改它，因此我可以尝试与未来版本保持同步。希望这有帮助~~

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-22T23:23:33.423

这可能与你的风格有关。就我而言，我在父“项目” div 中使用了一个链接，所以我不得不更改我的样式表以说明以下内容：

```
.carousel .item a > img {
  display: block;
  line-height: 1;
} 
```

在预先存在的 boostrap 代码下：

```
.carousel .item > img {
  display: block;
  line-height: 1;
} 
```

我的图像看起来像：

```
<div class="active item" id="2"><a href="http://epdining.com/eats.php?place=TestRestaurant1"><img src="rimages/2.jpg"></a><div class="carousel-caption"><p>This restaurant is featured blah blah blah blah blah.</p></div></div> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-15T06:19:29.833

您的图像是否具有与 span6 一样的 460px 宽度？在我的情况下，对于不同的图像尺寸，我在我的图像上放置了一个高度属性，以确保它们都是相同的高度，并且轮播不会在图像之间调整大小。

在您的情况下，尝试设置一个高度，以便此高度与轮播内部 div 的宽度之间的比率与图像的 aspectRatio 相同

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-06-28T14:18:16.740

**尝试这个**

```
 .item img{
      max-height: 300px;
      margin: auto;
    } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-08-20T18:02:24.497

我和你面临同样的问题。根据@thuliha 的提示，以下代码解决了我的问题。

在该`html`文件中，修改为以下示例：

```
<img class="img-responsive center-block" src=".....png" alt="Third slide"> 
```

在 中`carousel.css`，修改类：

```
.carousel .item {
  text-align: center;
  height: 470px;
  background-color: #777;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-09-18T16:23:01.577

对于轮播，我相信所有图像的高度和宽度都必须完全相同。

此外，当您从引导程序返回脚手架页面时，我很确定 span16 = 940px。考虑到这一点，我认为我们可以假设，如果您有

```
<div class="row">
     <div class="span4"> 
        <!--left content div guessing around 235px in width -->
     </div>
     <div class="span8">
        <!--right content div guessing around 470px in width -->
     </div>
</div> 
```

所以是的，在一行内设置跨度空间时必须小心，因为如果图像宽度太大，它会将你的 div 发送到下一个“行”，这并不好玩：P

[链接 1](http://twitter.github.com/bootstrap/scaffolding.html)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-03-23T09:01:19.157

将此插入到轮播所在的 css 父 div 类中。

```
<div class="parent_div">
     <div id="myCarousel" class="carousel slide">
            <div class="carousel-inner">
              <div class="item active">
                <img src="assets/img/slider_1.png" alt="">
                <div class="carousel-caption">
                </div>
              </div>
            </div>
     </div>      
</div> 
```

CSS

```
.parent_div { 
margin: 0 auto;
min-width: [desired width];
max-width: [desired width];
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-11-27T12:15:18.030

@Art L. Richards 的解决方案没有奏效。现在在bootstrap.css中，原来的代码变成了这样。

```
.carousel .item > img {
  display: block;
  line-height: 1;
} 
```

@rnaka530 的代码会破坏引导程序的流畅特性。

我没有一个好的解决方案，但我确实修复了它。我非常仔细地观察了引导程序的轮播示例[http://twitter.github.com/bootstrap/javascript.html#carousel](http://twitter.github.com/bootstrap/javascript.html#carousel)。

我发现 img 宽度必须大于网格宽度。在`span9`中，宽度最大为 870px，因此您必须准备一个大于 870px 的图像。如果您在 img 之外有更多容器，因为所有容器都有边框或边距，您可以使用宽度较小的图像。

# iframe - 如何创建自定义 StumbleUpon 按钮？

> ID：10591424
> 
> 赞同：1
> 
> 时间：2012-05-14T21:34:29.917
> 
> 标签：iframe, stumbleupon

StumbleUpon 发布了一个[Widget 脚本](https://platform.stumbleupon.com/1/widgets.js)，并[记录](http://www.stumbleupon.com/help/business-tools/badges#article4)了如何使用它来将 stumbleUpon 按钮（他们称之为*徽章*）插入网站。

[您可以使用他们的在线工具](http://www.stumbleupon.com/dt/badges/create)为按钮生成标记。它看起来像这样：

```
<!-- Place this tag where you want the su badge to render -->
<su:badge layout="2" location="http://example.com"></su:badge>

<!-- Place this snippet wherever appropriate -->
<script type="text/javascript">
  (function() {
    var li = document.createElement('script');
    li.type = 'text/javascript';
    li.async = true;
    li.src = 'https://platform.stumbleupon.com/1/widgets.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(li, s);
  })();
</script> 
```

该脚本元素只是延迟加载 widgets.js 事物的一种方式。仅从外观来看，我认为它可以通过扫描文档中的`<su:badge>`元素并将它们替换为`iframes`. 然后 iframe 本身从 stumbleupon 获取源内容，网址如下：`http://badge.stumbleupon.com/badge/embed/4/?url=http%3A%2F%2Fexample.com`.

iframe 在视觉上呈现如下： ![在此处输入图像描述](../Images/4952e5bc6807c8d46952ca408a7b1806.png)

stumbleupon 按钮是第二个。我展示其他的进行比较。如您所见，StumbleUpon 渲染看起来与所有其他人不同。SU 使他们的按钮看起来像一个“徽章”，而所有其他社交分享小部件看起来像......呃....一个按钮。

* * *

我正在尝试使 Stumbleupon 小部件看起来像一个按钮。我很确定这是可能的。例如， mashable 就是这样做的（[例子](http://mashable.com/2011/02/27/facebook-like-button-takes-over-share-button-functionality/)）。这是它的样子：

![在此处输入图像描述](../Images/0ada334fe43666c9ed049601b91ee277.png)

如您所见，stumbleupon 按钮看起来像一个按钮。这不是徽章。Mashable 没有使用这个`su:badge`东西——他们已经渲染了自己的`<a>`标签，并对其进行了样式设置。

视觉渲染不是问题；我可以弄清楚如何使跨度看起来像一个按钮，没问题。当我单击标签或跨度时会出现问题。在我看来，使用 StumbleUpon 使用的 iframe-thing，它会调用此 URL 来提交一个页面以供共享：

> [http://www.stumbleupon.com/badge/?url=http%3A//example.com/whatever](http://www.stumbleupon.com/badge/?url=http%3A//example.com/whatever) HTTP/1.1

iframe 使用 javascript`window.open`来请求，并限制调整大小等。这就是它在 mashable 上的工作方式。生成的窗口如下所示：

![在此处输入图像描述](../Images/06ced8f59caf054d5ab8cb638be1e788.png)

这也是可混搭页面所做的，尽管它不使用 iframe。Mashable 页面包含的 javascript 只是直接从主 mashable 页面中打开“stumbleupon submit”窗口。

*但是当我从我的*页面尝试同样的事情时，固定的小窗口从 StumbleUpon 获得 302 重定向，然后是另一个 302，最终将其指向

> [http://www.stumbleupon.com/submit/visitor](http://www.stumbleupon.com/submit/visitor)

...不允许共享链接。

这是一个很长的故事，但是：
**有没有人知道如何说服 StumbleUpon 让我通过 iframe 中未包含的按钮共享链接或 URL？**

mashable 的秘密是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T01:21:38.113

好的，这就是我发现的。

当以下两个都为真时，最终将我指向 /submit/visitor 的 302 发生：

*   用户未登录
*   该文章之前没有在stumbleupon中被偶然发现

发生这种情况时，stumbleupon 会邀请您（用户）登录。它不会带您进入“提交 url”页面。

如果用户没有登录，但之前已经提交过文章，那么它会将您带到没有 302 的提交窗口。如果您继续提交，最终会要求您登录。但是在这种情况下，stumbleupn 网站的第一个视图会给你一个视觉指示，表明你正在提交一些东西。

如果用户已登录，并且之前没有提交过文章，那么您将直接进入提交页面。

* * *

所以我没有做错什么。我只需要第一次登录。这只是 StumbleUpon 提供的用户体验的产物。在我看来，这有点奇怪。这是令人惊讶的，因此是错误的。但那只是我的个人意见。

# python - 在python中传递一个方法

> ID：10591427
> 
> 赞同：2
> 
> 时间：2012-05-14T21:34:39.187
> 
> 标签：python

我在函数中传递方法时遇到问题。我已经看过这个以前的帖子。

[如何在 Python 中将方法作为参数传递](https://stackoverflow.com/questions/706721/how-do-i-pass-a-method-as-a-parameter-in-python)

这是我尝试过的一个简单示例。

```
def passMethod(obj, method):
    return obj.method()

passMethod('Hi', lower) 
```

最后，我将使用它来帮助编写一个处理 GIS（地理信息系统）数据的函数。数据就像一个数组。我想在数组中添加一个新列 NAME1。然后该数组具有调用列array.NAME1 的方法。

问候，亚历克斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T21:40:10.847

当你给出 name时，这意味着在全局命名空间中`lower`查找 name 。`lower`它不存在，因为您正在寻找`lower`字符串（`str`类）的方法。那是拼写`str.lower`。

然后，在您的函数中，意味着`obj.method`查找`method`. `obj`它与名为 的参数无关`method`，并且不能那样工作。相反，由于您有一个未绑定的方法，因此将对象作为`self`参数显式传递：因此，`method(obj)`. 这给了我们：

```
def passMethod(obj, method):
    return method(obj)

passMethod('Hi', str.lower) 
```

或者，我们可以使用字符串作为方法的名称来查找传入的对象。看起来像：

```
def passMethod(obj, method):
    return getattr(obj, method)()

passMethod('Hi', 'lower') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:42:34.090

我不确定您想要什么，但将方法名称作为字符串传递更有意义：

```
def passMethod(obj, method_name):
    return getattr(obj, method_name)()

passMethod('Hi', 'lower') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T22:13:13.897

嗯，第一个问题是您在返回之前调用该方法。而不是返回 obj.method() 只是返回 obj.method。

```
class Foo:
    def bar(self):
        print 'foobar!'

def pass_bar(obj):
    return obj.bar

f = Foo()
method = pass_bar(f)
method() # prints 'foobar!' 
```

另一个问题是你究竟传递了什么来告诉代码你想要哪种方法。也许是一个字符串？如果是这样，请尝试类似

```
def pass_method(obj, method_name):
    return getattr(method_name) 
```

# mysql - MySQL选择事件前7天和事件后7天

> ID：10591429
> 
> 赞同：4
> 
> 时间：2012-05-14T21:34:44.960
> 
> 标签：mysql, events

我有包含用户生日和姓名的数据库。我想选择从 7 天前到未来 7 天生日/命名日的所有用户，此选择有效，但我不知道如何解决生日/命名日为 31.12 的用户的问题。例如。PHP 将返回“用户在 3 天前过生日”，此选择仅在年底前 7 天和新年后 7 天有效。非常感谢您的帮助。

```
SELECT `name`, `surname`, `gender`, ('birthday') AS event,
  DATEDIFF(NOW(), DATE(REPLACE(`birthday`, YEAR(`birthday`), YEAR(NOW())))) AS diff
FROM `users`
WHERE DATEDIFF(NOW(), DATE(REPLACE(`birthday`, YEAR(`birthday`), YEAR(NOW()))))
BETWEEN -7 AND 7
UNION
  SELECT `name`, `surname`, `gender`, ('namesday') AS event,
    DATEDIFF(NOW(), DATE(REPLACE(`namesday`, YEAR(`namesday`), YEAR(NOW())))) AS diff
  FROM `users`
  WHERE DATEDIFF(NOW(), DATE(REPLACE(`namesday`, YEAR(`namesday`), YEAR(NOW()))))
  BETWEEN -7 AND 7 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T23:20:18.493

我认为这很简单，使用 to_days()。这种方式依赖于数据库中设置的日历，因此您不必担心闰年。

```
select
    `name`, `surname`, `gender`, ('birthday') AS event,
    to_days(concat(year(current_date()),'-',month(`birthday`), '-',day_of_month(`birthday`))) as current_yr_bday 
FROM `users`
WHERE 
    to_days(concat(year(current_date()),'-',month(`birthday`), '-',day_of_month(`birthday`))) between to_days(date_sub(current_date() interval 7 days) and to_days(date_add(current_date() interval 7 days 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:40:27.283

好问题。这是我到目前为止所做的。我不确定它是否完美，但这可能是一个好的开始。试试看。

```
select *,
if(right(birthday,5)>=right(curdate(),5),concat(year(curdate()),'-',right(birthday,5)),concat(year(curdate()+interval 1 year),'-',right(birthday,5))) as next_birthday,
if(right(birthday,5)<right(curdate(),5),concat(year(curdate()),'-',right(birthday,5)),concat(year(curdate()-interval 1 year),'-',right(birthday,5))) as prev_birthday
from users
having next_birthday 
between curdate() - interval 7 day and curdate() + interval 7 day
or prev_birthday 
between curdate() - interval 7 day and curdate() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T22:41:02.197

蛮力方法是计算 YEAR-1、YEAR、YEAR+1 的差异，然后检查这三个总和中的任何一个是否满足您的条件。

算出现在和一月一日之间的差异并据此计算年份，就不是那么蛮力了。

有趣的问题，如果我想到别的东西，我会回来的。

# django - 项目布局和项目实用程序/库？

> ID：10591434
> 
> 赞同：3
> 
> 时间：2012-05-14T21:35:12.170
> 
> 标签：django

我对自 Django 1.4 以来创建的项目布局有点困惑。我想添加一些全局实用程序以在我的整个项目和应用程序中使用。我试图在我的应用程序的同一级别添加一个 utils 包，但 Django 没有看到它。

```
mysite/
    manage.py
    myapp/
        __init__.py
        models.py
    mysite/
        __init__.py
        settings.py
        urls.py
    utils/
        __init__.py
        shortcuts.py 
```

关于如何使用这样一个全球实用程序包的任何建议/最佳实践？

谢谢迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-27T09:18:23.333

您可以考虑将其添加到 INSTALLED_APPS 变量中的 django 设置 (mysite/settings.py) 中，而不是将其添加到您必须在安装项目的每台机器上执行的 PYTHONPATH 中：

```
INSTALLED_APPS=(myapp, utils) 
```

这具有将 utils 添加到 python 路径的效果，因此您可以执行以下操作：

```
from utils import shortcuts 
```

# javascript - Salesforce - $.ajax 调用的成功处理程序

> ID：10591438
> 
> 赞同：3
> 
> 时间：2012-05-14T21:35:37.017
> 
> 标签：javascript, jquery, salesforce

我有一个通过标准表单提交操作提交给 Salesforce 的表单。默认情况下，您可以告诉 Salesforce 在 POST 完成后将您重定向到给定的 URL。

我不再希望被重定向，因为我在表单页面上有其他活动。没问题，我的页面已经在使用 jQuery，所以我可以使用方便的 $.ajax 实用程序，如下所示：

```
$('#wrapper').on('click', '#formsubmit', function(e) {
    e.preventDefault();

    var formData = $('#subForm').serialize();
    $.ajax({
      type: "POST",
      url: "https://www.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8",
      data: formData,
      success: function() {
        console.log('success!'); // or not!
      },
      error:function (xhr, ajaxOptions, thrownError){
                    console.log(xhr.status); // 0
                    console.log(thrownError); // empty
                }
    });
}); 
```

在我误入歧途的大脑中，我想象 Salesforce 会返回我的良好重定向，这将算作我可以丢弃/忽略的“成功”。确实误入歧途！

*   我可以看到 200 OK 结果（通常意味着“成功”），但成功回调没有被触发。
*   潜在*客户*添加到 Salesforce 数据库
*   检查返回的内容显示为零；响应中没有内容。
*   错误回调*被*触发（尽管 200 OK）但可能是由于故意不重定向它被视为“资源不可用”？（所以我的状态码是0，throwError里面没有内容？）。

关于将其识别为成功的 POST 以便我可以在回调中触发其他操作的任何建议？我不想完全忽略响应，否则我最终可能会遇到这样的情况，即我正在处理失败的 POST，就好像它成功了一样。我需要以某种方式捕捉成功。

我想到这也可能是一个跨站点脚本问题，但由于应用程序不交换 JSONP 中的数据，我不确定如何解决这个问题（我不确定如何识别它首先）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T21:43:38.770

这里有几件事：

1) Salesforce API 发送的重定向响应很可能被解释为错误代码。

2）后续页面（重定向后）的响应码是200 OK，从它的声音来看。

3) 无法使用 JSONP 进行 POST 请求。这是 JSONP 的限制；这实际上不是 AJAX 请求，而是包装在动态生成的*脚本*标记内的 HTTP GET 请求。此外，JSONP 仅在请求产生 200 OK 的 HTTP 响应时才有效。

我建议使用您自己的服务器端中介来处理您的 AJAX POST 请求。这将充当您的前端应用程序和销售人员 API 之间的代理。这也将允许您更好地控制发送到您的应用程序的响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T21:39:42.780

```
var formData = $('#subForm').serialize();
   var response = $.ajax({
      type: "POST",
      url: "https://www.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8",
      data: formData,
      success: function() {
        console.log('success!'); // or not!
      },
      error:function (xhr, ajaxOptions, thrownError){
                    console.log(xhr.status); // 0
                    console.log(thrownError); // empty
                }
    }).responseText; 
```

其中 var response 将包含您的 ajax 调用的返回值

# c# - Excel中的多个选定工作表是什么对象类型？

> ID：10591443
> 
> 赞同：1
> 
> 时间：2012-05-14T21:36:09.290
> 
> 标签：c#, excel, late-binding

与我的想法相反，多个选定的工作表不是 Worksheets 对象类型。

在多选 2 张或更多张之后。我得到选择的方式是这样的：

```
var selection = ExcelApp.Selection; //Returns object type 
```

我已经尝试让“名称”属性尝试通过使用后期绑定来给我一个提示：

```
string name = selection.GetType().InvokeMember("Name", System.Reflection.BindingFlags.GetProperty, null, selection, null).ToString(); 
```

但这会为给定的选择类型引发错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T22:37:05.400

在 VBA 中，`ActiveWindow.SelectedSheets`返回一个`Sheets`集合，所以我想它在 C# 中会很相似

是的：http : [//msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.window.selectedsheets (v=office.11​​).aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.window.selectedsheets(v=office.11).aspx)

# php - 将 SQL 从一台服务器复制到另一台服务器并忽略 Duplicatess

> ID：10591446
> 
> 赞同：0
> 
> 时间：2012-05-14T21:36:51.243
> 
> 标签：php, mysql, database, cron

我有 2 个网站提供完全相同的内容，只是布局不同，我目前每天都在更新两个网站，在两者上都放置相同的内容，我想制作一个 php 脚本或类似的东西并在 cron 上运行以自动复制数据库一台服务器到另一台服务器，但我不希望它复制已经存在的内容，数据库有一个可以检查的唯一字段。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T23:10:06.517

您应该只有 1 个数据库，以及 2 个以上用于显示内容的模板（皮肤）。当数据集之间没有差异时，在生产中复制相同的数据是毫无意义的。

--编辑-- 美国东部时间 2012 年 5 月 15 日下午 7:06 如果您*真的*想维护重复的生产数据库，我建议使用一种将数据从一个站点发送到另一个站点的 Web 服务。您还可以考虑在数据库中使用触发器。它确实取决于您的设置、Web 服务器所在的位置、数据库服务器等。

# java - 带有版本附加的 css 文件

> ID：10591449
> 
> 赞同：1
> 
> 时间：2012-05-14T21:37:10.697
> 
> 标签：java, css, jsf-2, richfaces

我想创建一种以自动方式（通过 ant 等）更新对 jsf 中 css 文件的引用的方法。这种做法的常见做法是什么？是否有任何可用的自动化工具？

基本上我希望能够部署我的war文件并确保客户端下载修改后的css文件的任何更改，而无需清除缓存。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T21:53:58.587

您可以使用 JSF 内置资源库版本控制。`/resources`如果尚未完成，您只需要在 webapp 的文件夹中引入资源库。然后，您可以使用该模式创建一个版本子文件夹`\d(_\d)*`。例如，

```
/resources/default/1_0/css/layout.css 
```

您参考如下：

```
<h:outputStylesheet library="default" name="css/layout.css" /> 
```

库版本作为`v`参数附加在生成`<link>`元素的查询字符串中。

```
<link type="text/css" rel="stylesheet" href="/contextname/javax.faces.resource/css/layout.js.xhtml?ln=default&amp;v=1_0" /> 
```

当您需要部署更新时，将`1_0`子文件夹重命名为`1_1`或其他名称（可以由 ant 完成），它将被更新，并且浏览器将被迫下载它而不是使用缓存的。

这同样适用于JS`<h:outputScript>`和`<h:graphicImage>`图像资源。

# facebook - Facebook 安全表单

> ID：10591450
> 
> 赞同：0
> 
> 时间：2012-05-14T21:37:17.490
> 
> 标签：facebook, forms, security, https, tabs

我正在使用 Facebook 中的 html 输入选项卡构建一些表单。我的表单操作是发布和插入链接到外部托管的 php 函数文件。

问题是，如果用户没有使用 Facebook 的新 https 设置，则会显示一个带有“不安全表单”的弹出窗口

有没有为什么要提供一个外部托管的安全处理程序，还是我会更深入地研究 Facebook ap 制作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T00:00:20.413

Facebook 将您的应用加载到 iframe 中（使用 POSTing 表单）。当用户在 facebook 中使用 https 时，他们使用应用程序设置中的*Secure Canvas URL*属性，当用户未进行安全浏览时，他们使用*Canvas URL*。因此，您的页面不是从 https 而是从 http 加载的，这就是浏览器向用户显示该警告的原因。

您可以做的是检查您的页面何时加载使用的协议，如果不是 https，则从 https 重新加载页面。类似的东西（使用[window.location 对象](http://www.w3schools.com/jsref/obj_location.asp)）：

```
var location = window.location;
if (location.protocol != "https:") {
    window.location.href = "https://" + location.host + "/" + location.pathname + location.search
} 
```

或者，如果您不希望在查询字符串中有 url，您可以简单地替换：

```
window.location.href = window.location.href.replace("http", "https"); 
```

# php - 新 PHP 版本出现 Amfphp 错误

> ID：10591452
> 
> 赞同：1
> 
> 时间：2012-05-14T21:37:29.357
> 
> 标签：php, apache-flex, amfphp

我希望有人可能会遇到这个问题。我通过谷歌搜索了这个问题，我发现很少有解决方法的选项。但这对我没有帮助。所以我在这里发布。

在我以前的服务器中，我们使用的是 Fedora 5.2.5 版本的 PHP。但是在我当前的服务器中，我们使用的是 REDHAT 和 PHP 5.3 和 amfphp 版本 1.4。在旧的服务器中，我们没有遇到任何问题。但是使用 Redhat 我得到了以下错误。

```
(mx.rpc::Fault)#0
errorID = 0
faultCode = "Client.Error.MessageSend"
faultDetail = "Channel.Connect.Failed error NetConnection.Call.BadVersion: "
faultString = "Send failed"
message = "faultCode:Client.Error.MessageSend faultString:'Send failed' faultDetail:'Channel.Connect.Failed error NetConnection.Call.BadVersion: '"
name = "Error"
rootCause = (Object)#1
code = "NetConnection.Call.BadVersion"
description = ""
details = ""
level = "error" 
```

您对此有任何想法吗？我该如何解决此问题。如果您对此有任何想法，请告诉我。

我关注的参考网站：1）[http://sourceforge.net/projects/amfphp/forums/forum/247252/topic/3941969](http://sourceforge.net/projects/amfphp/forums/forum/247252/topic/3941969) 2）[http://www.gotoandlearnforum.com/viewtopic.php?t=20525](http://www.gotoandlearnforum.com/viewtopic.php?t=20525)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:55:18.587

[感谢所有查看我的问题的人。现在我在这个](http://sourceforge.net/projects/amfphp/forums/forum/247252/topic/3941969)链接中使用 charles 工具解释后解决了这个问题。

**错误一：**

我遇到了什么问题，解释一下[这个](http://www.howtoforge.com/php-it-is-not-safe-to-rely-on-the-systems-timezone-settings)链接，即

```
t is not safe to rely on the system's timezone settings. You are *required* to use the date.timezone setting or the date_default_timezone_set() function. 
```

所以把线

```
date_default_timezone_set("America/New_York"); 
```

在 gateway.php 中

我也添加了这条线

```
error_reporting(0); below $gateway->setErrorHandling(E_ALL ^ E_NOTICE); 
```

因为我们在现场。但不确定它是否有帮助。如果我错了，请告诉我。

**错误2：**

第二个我得到了[这个](http://creative-geeks.com/blog/2009/12/11/amfphp-and-php-5-3-bugfix/)link.ie中解释的问题

```
function eregi_replace is depreciated. 
```

所以我选择了他们在上面链接中发布的解决方案。用上面链接中的建议替换了 amfphp/core/shared/util/MethodTable.php 文件。

希望这会有所帮助。:)

# mysql - SQL 现在选择（）

> ID：10591454
> 
> 赞同：3
> 
> 时间：2012-05-14T21:37:33.830
> 
> 标签：mysql, sql, date

嘿，您会为标题中的所有大写字母感到抱歉，但实际上应该是这样的。

我在查询中运行它

`SELECT NOW()`

它返回这个

`2012-05-14 17:35:37`

我如何删除时间，我只想要日期。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T21:39:45.330

[CURDATE()](http://www.w3schools.com/sql/func_curdate.asp)怎么样？

```
SELECT CURDATE() 
```

（注意：这在网页中被列为 MySQL。不确定您正在运行的 SQL 的供应商/版本。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T21:40:56.667

这个 MySQL 选择应该返回没有时间的日期。

```
SELECT CURRENT_DATE(); 
```

请享用 ：）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T21:41:36.857

我认为这也可能有效

```
SELECT CONVERT(VARCHAR(10),GETDATE(),111) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T21:40:01.563

您可以使用以下[`LEFT()`](http://dev.mysql.com/doc/refman/5.6/en/string-functions.html#function_left)功能：

```
SELECT LEFT(NOW(), 10); 
```

这是一个小演示：

```
mysql> SELECT LEFT(NOW(), 10);
+-----------------+
| LEFT(NOW(), 10) |
+-----------------+
| 2012-05-14      |
+-----------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-12T07:42:00.320

这完美地唤醒了我：

```
SELECT * FROM table WHERE DATE(myDate) = DATE(NOW()) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-14T21:42:51.033

```
DATE(NOW()) 
```

是我使用的 - 它只保留日期部分

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-15T09:01:06.213

您还可以创建日期格式并使用`NOW()`.

```
| date_int | date         | YES  |     | NULL    |       |
+----------+--------------+------+-----+---------+-------+
mysql> UPDATE borderaux SET date_int = NOW();

+------------+
| date_int   |
+------------+
| 2013-07-15 |
+------------+ 
```

# perl - 从输入文件锁定和解锁

> ID：10591458
> 
> 赞同：0
> 
> 时间：2012-05-14T21:37:50.120
> 
> 标签：perl, locking, sleep

我有一个子例程，我试图在其中专门锁定一组文件（一次一个）并在给定的时间内（通过[sleep](http://perldoc.perl.org/functions/sleep.html)）保持该锁定。我正在尝试添加让用户在按下某个键（例如回车键）时解锁当前锁定（睡眠）文件的功能。我只是不确定要朝着哪个方向努力。使用 STDIN 和检查 \n 的每一次尝试都没有奏效。谢谢。

下面是子程序。我切换到我想要文件的目录。创建从 1 到指定文件数的文件。对于每个文件，都会设置一个排他锁，然后休眠一段指定的时间。

**编辑：**我没有提到这一点是我的错，但是这个脚本将在 Windows 环境中运行。理想情况下，我想要一个不需要安装 Perl 中不包含的额外模块的解决方案。（这是因为 breqwas 解决方案中的模块不支持 Windows 而提出的）。谢谢。

```
sub lockFiles{
    #creates files that are locked for a specific amount of seconds.
    chdir("lock files")or die "Unable to enter dir $!\n";
    opendir(DIR,".") or die "Can't open the current directory: $!\n";

    #file iterator
    my $i=1;
    #for each file lock it and sleep the given amount of time
    while($i<=$numberOfFiles){
        open FILE, ">>", "test$i.txt" or die $!;
        flock(FILE, 2) or die "Could not lock test$i.txt\n";
        print "test$i.txt locked, locking for $timeToSleep seconds\n";
        print "Press ctrl+c to kill this\n";

        sleep($timeToSleep);

        $i++;
        close(FILE);
    }
    closedir(DIR);
    #change back to the parent folder
    chdir("..") or die "Can't change to the directory: $!\n";
    print "subRoutine lockFiles success\n";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T01:49:39.580

我没有安装带有 perl 的 Windows 机器来检查它是否在那里工作，但 Term::ReadKey 上的文档暗示它应该。Term::ReadKey 是一个提供非阻塞和定时读取功能的模块。它有一些有限的 Windows 支持。

```
use Time::HiRes qw(time sleep);
use Term::ReadKey;

sub wait_for_key {
    my $timeout = shift;

    my $started = time();
    while (1) {
        last if $started + $timeout < time();

        my $str = '';
        while (my $char = ReadKey(-1)) {
            $str .= $char;
        };

        last if $str =~ m/\n/s;
        sleep 0.1;
    }
} 
```

不过，我确信有更好的方法可以做到这一点。也许有 perl-on-windows 经验的人会出现。

诅咒你，Windows。在任何其他系统上，上面的代码如下所示：

```
sub wait_for_key { ReadLine(shift) } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T22:20:01.903

像这样尝试：

```
use Sys::SigAction qw(sig_alarm set_sig_handler);

sub wait_for_key {
    my $timeout = shift;

    eval {
        my $sa = set_sig_handler('ALRM', sub { die "enough" }, {} );
        eval {
            sig_alarm($timeout);
            my $keyboard = <>;
            sig_alarm(0);
        };
        sig_alarm(0);
    }
} 
```

此函数将在任何输入（“Enter”键）或超时后退出，因此您只需调用它而不是 sleep()。基本思想是：

1）无限等待输入
2）但为您需要的超时设置警报。

看起来很邪恶，但工作正常。

这实际上是使用超时调用某些代码的通用方法 - 只需让此函数接受作为函数引用的第二个参数，然后调用该引用而不是`my $keyboard = <>`line。而且，好吧，检查错误并做我在这个示例中遗漏的所有无聊的东西。

# java - 为什么 VisualVM Profiler 不能分析我的 Scala 控制台应用程序？

> ID：10591463
> 
> 赞同：9
> 
> 时间：2012-05-14T21:38:27.773
> 
> 标签：java, scala, jvm, profiling, visualvm

[我认为这个问题与这个](https://stackoverflow.com/questions/9296258/why-wont-the-visualvm-profiler-profile-my-application)问题密切相关，但它是封闭的，解决方案对我来说似乎并不明确。

我正在尝试使用 VisualVM 来分析我的控制台 Scala 应用程序。我通过启动 VisualVM、启动我的 Scala 应用程序、在 VisualVM 中打开其节点、转到“Profiler”选项卡并单击“CPU”来做到这一点。该按钮会变灰一段时间（而状态永远不会从“分析不活动”更改为任何内容），然后恢复活动但不显示分析数据。

应用程序执行一些文件读取、数据处理（大约需要一分钟）、stdout 数据输出和退出。我还尝试添加`Thread.sleep(60000)`到程序的开头和结尾，以确保 VisualVM 有足够的时间来捕获它并完成工作，但没有任何改变。

与我链接到的相关问题不同，我不会从 Eclipse 或其他任何东西启动我的应用程序 - 我使用以下命令行启动它：

```
java -classpath myapp.jar:lib/* MyApp.Main 
```

所有库（包括`scala-library.jar`）都放在`lib/`. 该应用程序按预期工作。

更新：

*   我已经尝试过 YourKit Java Profiler 11.0.2，但它以 `AttachNotSupportedException`.
*   我通过[手动附加代理](http://www.yourkit.com/docs/95/help/agent.jsp)来管理 YourKit 。
*   似乎值得强调的是，我既没有从 IDE（或构建工具）运行应用程序，也没有修改任何 JVM 选项，除了类路径。据我了解，这个问题似乎取决于 JVM 版本和用户/权限问题。*目标是找出问题的实际机制以及配置所有工作的方式*。

使用的软件版本：

*   YourKit Java Profiler 11.0.2
*   视觉虚拟机 1.3.4
*   SBT 0.12.3（构建但不运行（我实际上都尝试过））
*   斯卡拉 2.9.2
*   甲骨文 Java 1.7.0_04-b20
*   XUbuntu Linux 12.04 32 位 i386
*   Linux 内核 3.2.0-24-generic-pae

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T03:20:50.343

两天前我使用 VisualVM 分析了一个 Scala 应用程序，所以我相信它应该可以工作。以下是我的建议：

*   将YourKit从等式中取出并在没有它的情况下运行
*   从等式中取出 scala，尝试分析一个 Java hello world`while (true) { Thread.sleep(10000); }`
*   让它工作，然后放回 Scala，然后放回 YourKit。

编辑：根据您的输入，我建议显式设置远程 JMX 连接。您可以使用以下选项启动 java：

```
-Dcom.sun.management.jmxremote=true
-Dcom.sun.management.jmxremote.port=20000
-Dcom.sun.management.jmxremote.ssl=false
-Dcom.sun.management.jmxremote.authenticate=false 
```

然后在 VisualVM 中，将 JMX 连接添加到`localhost:20000`.

# shell - 直接调用和通过 shell 脚本调用时的“echo -e”

> ID：10591467
> 
> 赞同：2
> 
> 时间：2012-05-14T21:38:43.407
> 
> 标签：shell, echo

我注意到`echo`直接调用时的行为略有不同

`root$echo "line1\nline2"`

当通过脚本调用时：

```
#! /bin/sh

echo "line1\nline2"

[...] 
```

第一个案例将打印：

```
line1\nline2 
```

，而后者将打印

```
line1
line2 
```

所以在脚本中使用时`echo`总是假定有标志？`-e`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T21:41:55.027

您的脚本有一个 shebang 行`#! /bin/sh`，而您的交互式 shell 可能是 Bash。如果您想要 Bash 行为，请将脚本更改为`#! /bin/bash`。

这两个程序是*不同*`sh`的shell。即使在相同程序的系统上，它的行为也会因您使用哪个命令来调用它而有所不同。（虽然它不像在 Bash 模式下默认打开，所以你可能在一个真正的系统上。）`bash`*`/bin/sh``/bin/bash``echo``-e``sh``sh``dash`*

 *如果您`sh`在提示符下键入，您会发现其`echo`行为方式与您的脚本中的方式相同。但是`sh`对于交互使用来说并不是一个非常友好的shell。

如果您正在尝试编写最大程度地可移植的 shell 脚本，您应该坚持使用 vanilla`sh`语法，但如果您不是为广泛的分发而编写，您可以使用 Bash 脚本 - 只需确保告诉系统它们是，在事实上，Bash 脚本，通过放入`bash`shebang 行。

顺便说一句，该`echo`命令可能是 shell 中最臭名昭著的不一致命令。因此，如果您追求可移植性，最好完全避免使用它，而不是直接输出、无选项、无转义、始终为换行符输出。一个非常便携的选项是[printf](http://linux.die.net/man/1/printf)。*

# javascript - 使用 jQuery 设置 Flash 播放器

> ID：10591472
> 
> 赞同：1
> 
> 时间：2012-05-14T21:39:08.957
> 
> 标签：javascript, jquery, internet-explorer, internet-explorer-8

我有一个 Flash 播放器（仅用于不支持 html5 视频的浏览器），设置如下：

```
<object id="mpl" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="400" height="300">
    <param name="id" value="mpl" />
    <param name="movie" value="/r/player.swf" />
    <param name="quality" value="high" />
    <param name="allowfullscreen" value="true" />
    <param name="allowscriptaccess" value="always" />
</object> 
```

对于那些需要 Flash 的情况，这就是我尝试动态设置 url 的方式。它适用于 Chrome，但不适用于 IE8（IE8 模式下的 IE9），这是我真正需要它工作的地方。

我得到的错误是 jquery 中的“无效参数”，在对应于 append 方法的行上。

IE8 是否希望我以不同的方式执行此操作？

```
data.videoPlayerContainer.find("object").append($('<param name="flashvars" value="width=400&height=300&displayheight=300&file=' + encodeURIComponent(flashUrl) + ' &autostart=true&type=flv&bufferlength=10&javascriptid=mpl&enablejs=true" />'));
data.videoPlayerContainer.find("object").append($('<embed src="/r/player.swf" name="mpl" width="400" height="300" bgcolor="#ccc3ad" allowfullscreen="true" allowscriptaccess="always" flashvars="width=400&height=300&displayheight=300&file=' + encodeURIComponent(flashUrl) + '&type=flv&bufferlength=10&showicons=false&shownavigation=false&autostart=true&javascriptid=mpl&enablejs=true" />')); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:40:28.373

看看[https://github.com/swfobject/swfobject](https://github.com/swfobject/swfobject)这应该可以帮助您找到合适的解决方案。

# javascript - 根据元素 ID 更改类值

> ID：10591482
> 
> 赞同：0
> 
> 时间：2012-05-14T21:40:50.893
> 
> 标签：javascript, jquery, html

如果我做错了就打我一巴掌，我是初学者。

这是我的设置，我猜这在视觉上与 Outlook 的 UI 非常相似。

左窗格（浮动 div）包含您可以单击的容器列表（如电子邮件）。右侧窗格包含一组不可见的容器，当它们的类更改为不同的 css 类时，它们应该变得可见。

我正在尝试将其设置为，如果您单击左窗格中的元素，它会执行 onclick javascript 操作（存储在外部 .js 文件中），在两个 css 类之间切换右 div 的类值。

左窗格 div 中的 onclick 将 $_row['uniqueID'] 传递给函数。那是唯一递增的列名。它也是右窗格的 ID 值。

总而言之，有人可以指导我如何做到这一点吗？

**左窗格...**

```
<div onclick=\"toggleMenu('".$row['uniqueIdentifier'],"'); \"> 
```

**右窗格...**

```
<div id=".$row['uniqueIdentifier']," class=\"mL\"> 
```

**css...**

```
div.mL {display:none;}
div.mL.active {display:block;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:44:55.390

```
function toggleMenu(div){
    $('#'+div).addClass('active');
} 
```

jQuery 有`.addClass()`和`.removeClass()`方法。

我想这就是你所追求的，如果不是，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:50:57.173

通过不更改太多代码，我建议这样做：

```
div.mL {display:none;}
div.mLactive {display:block;} 
```

我删除了这个点，所以你现在有 2 个不同的类。因此，单击时只需将具有正确 id 的 div 的类更改为 mLactive。

在 Jquery 中，这可以通过 $(#'theid').addClass('mLactive'); 来完成。这只会添加新类。您还想使用 $(#'theid').removeClass('mL'); 删除上一个类

另一种方式： $(#'theid').attr( "class" , "mLactive" ); 这不需要删除以前的课程。你的选择。这种方法的另一个优点是 javascript 有一种方法可以完成不需要 Jquery 的操作。

Jquery 也有简单的选项 $(#'theid').show(); 和 $(#'theid').hide() 顺便说一句。

# c++ - 我可以从对象外部调用 VFunc 吗？

> ID：10591487
> 
> 赞同：0
> 
> 时间：2012-05-14T21:41:02.140
> 
> 标签：c++, virtual

我喜欢这段代码的结果，但我很好奇，是否可以从 main() 调用 B::VFun​​c()？我知道在 C 内部编写`B::VFunc();`会调用它，但是否可以从对象外部调用该函数？

[http://ideone.com/Dg8aa](http://ideone.com/Dg8aa)

```
#include <cstdio>
class I { public: virtual void VFunc()=0; };
class B : public I { public: void VFunc() { printf("B\n"); } };
class C : public B { public:  void VFunc() { printf("C\n"); } };

int main(){
    C v;
    B&i = v;
    i.VFunc();
} 
```

输出：

```
C 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T21:47:58.800

这将做到：

```
#include <cstdio>
class I { public: virtual void VFunc()=0; };
class B : public I { public: void VFunc() { printf("B\n"); } };
class C : public B { public:  void VFunc() { printf("C\n"); } };

int main(){
    C v;
    B&i = v;
    i.B::VFunc();
} 
```

示例：http: [//ideone.com/MfyYJ](http://ideone.com/MfyYJ)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:42:08.677

您可以使用切片：

```
C v;
B i = (B)v; 
```

[http://ideone.com/YVI2T](http://ideone.com/YVI2T)

的动态类型`v`丢失了，所以`B::VFunc`叫。

# javascript - 显示格式化的经过时间

> ID：10591496
> 
> 赞同：0
> 
> 时间：2012-05-14T21:41:39.963
> 
> 标签：javascript, jquery

在我的上传文件页面上，我想以这种格式显示经过的时间（用户上传文件的时间）：，`00:26`即 26 秒。`17:34`将是 17 分 34 秒等。

我怎么能这样做？我有一个在上传开始时被调用的事件，因此我可以从那里设置一个 Date 变量，并且我还有一个定期调用的函数来更新经过的时间。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T21:52:21.750

手动：离开我的头顶。

```
var s = 0;
var startTime = new Date();
var interval = setInterval(function(){
    s++;
    var temps = s%60;
    var m = Math.floor(s/60);
    document.querySelector("#timebox").innerHTML = ""+m+":"+ (temps>9?"":"0") + temps;
},1000); 
```

然后当它完成上传......它需要调用

```
clearInterval(interval); 
```

不过，我建议使用[Moment.js 之](http://momentjs.com/)类的东西。健壮得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T21:49:30.053

客户端我猜。

当然，setInterval() 是一个计数器函数，它从上传的“点击”开始。您的计数器功能可能会返回到屏幕一种“进度” - 这是您的意思吗？

# objective-c - UIImagePickerController 不会录制视频

> ID：10591498
> 
> 赞同：4
> 
> 时间：2012-05-14T21:41:48.350
> 
> 标签：objective-c, ios, cocoa-touch, ios5, uiimagepickercontroller

我想用 录制视频`UIImagePickerController`。我的问题是该方法 `[imagePickerController startVideoCapture];`总是返回 0。我正在使用运行 iOS 5.1 的 iPhone 4S 测试应用程序。有人可以帮我解决这个问题：

```
- (IBAction)playButtonPushed:(id)sender
{
    if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]) 
    {
        UIView *videoView = self.videoViewController.view;
        UIImagePickerController *imagePickerController = [[UIImagePickerController alloc] >init];
        imagePickerController.sourceType = UIImagePickerControllerSourceTypeCamera;
        imagePickerController.mediaTypes = [[NSArray alloc] initWithObjects: (NSString >*)kUTTypeMovie, nil];
        imagePickerController.showsCameraControls = NO;
        imagePickerController.toolbarHidden = NO;
        imagePickerController.wantsFullScreenLayout = YES;
        imagePickerController.allowsEditing = YES;
        imagePickerController.videoQuality = UIImagePickerControllerQualityTypeMedium;
        imagePickerController.videoMaximumDuration = 30;
        [imagePickerController startVideoCapture];
        imagePickerController.cameraViewTransform = > CGAffineTransformScale(self.imagePickerViewController.cameraViewTransform, CAMERA_TRANSFORM,  CAMERA_TRANSFORM);
        imagePickerController.delegate = self;

        [self.imagePickerViewController setCameraOverlayView:videoView];
        NSLog(@"%s videoCapture: %d", __PRETTY_FUNCTION__, [imagePickerController > startVideoCapture]
              );
        [self presentModalViewController:imagePickerViewController animated:YES];
    }
}

 - (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    NSLog(@"didFinishPickingMediaWithInfo");
    NSURL *videoURL = [info objectForKey:UIImagePickerControllerMediaURL];
    NSData *videoData = [NSData dataWithContentsOfURL:videoURL];
}

- (void)imagePickerControllerDidCancel:(UIImagePickerController *)picker
{
    NSLog(@"Cancel");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T21:00:17.297

如果我没记错的话，“startVideoCapture”方法是一个布尔值

直接取自苹果文档：

开始视频捕捉

使用 UIImagePickerControllerCameraDevice 属性指定的相机开始视频捕获。- (BOOL)startVideoCapture 返回值

YES 成功或 NO 失败。由于各种原因，此方法可能会返回 NO 值，其中包括：

```
Movie capture is already in progress

The device does not support movie capture

The device is out of disk space 
```

讨论

将此方法与自定义叠加视图结合使用以启动电影的编程捕获。您可以在不离开界面的情况下拍摄多部电影，但这样做需要您隐藏默认的图像选择器控件。

在捕获电影时调用此方法无效。您必须调用 stopVideoCapture 方法，然后等到关联的委托对象收到 imagePickerController:didFinishPickingMediaWithInfo: 消息后，才能捕获另一部电影。

当图像选择器的源类型设置为 UIImagePickerControllerSourceTypeCamera 以外的值时调用此方法会导致抛出 NSInvalidArgumentException 异常。

如果您需要其他选项或对电影捕获进行更多控制，请使用 AV Foundation 框架中的电影捕获方法。请参阅 AV 基础框架参考。可用性

```
Available in iOS 4.0 and later. 
```

在 UIImagePickerController.h 中声明 stopVideoCapture

停止视频捕获。- (void)stopVideoCapture 讨论

调用此方法停止视频采集后，系统会调用图像选择器委托的 imagePickerController:didFinishPickingMediaWithInfo: 方法。可用性

```
Available in iOS 4.0 and later. 
```

在 UIImagePickerController.h 中声明

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-09-10T11:52:05.317

我遇到了同样的问题，Apple 的文档没有帮助。那是因为他们没有提到 startVideoCapture() 如果您没有像这样将捕获模式设置为 .video 可以返回 false：

```
picker.cameraCaptureMode = .video 
```

这对我有用，我现在可以捕捉视频了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-28T08:41:32.937

认为您需要在调用 presentModalViewController:animated: 之后而不是之前调用 startVideoCapture 方法。

在 UIImagePickerController 出现在屏幕上并且动画停止之后，您可能还需要短暂的延迟（<1s？），然后调用 startVideoCapture，否则有时它不会开始录制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-19T10:31:31.343

我有完全相同的问题。AndyV 说得对，在出现选择器之前不会开始录制。我花了很多时间试图引入睡眠延迟，但最简单的解决方案是在使用显示选择器后启动一个计时器

```
NSTimer *timer = [NSTimer scheduledTimerWithTimeInterval: 1.0 target:self selector:@selector(startRecording) userInfo:nil repeats: NO]; 
```

然后 ..

```
- (void)startRecording
{
    BOOL result = [picker startVideoCapture];
} 
```

# extjs - extjs 4.1 将动态组合框转换为动态无线电组

> ID：10591502
> 
> 赞同：0
> 
> 时间：2012-05-14T21:42:00.173
> 
> 标签：extjs, extjs4

在加载用户角色 [id, name] 存储后，我可以轻松创建以下表单字段，该字段动态填充角色下拉列表（用户、管理员、...）

```
{
    xtype: 'combobox',
    name: 'roleIds',
    queryMode: 'local',
    pinList: false,
    fieldLabel: 'Role',
    store: 'Roles',
    displayField: 'name',
    valueField: 'id',
    allowBlank: false
} 
```

这很好用，但是将其变成无线电组所需的正确步骤是什么？如何确保在编辑记录时选择了正确的单选按钮？当表单为空并创建新用户时，如何指定默认值？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:55:08.023

这基本上是非常相似的事情。最后你需要有这样的东西：

```
{
    xtype: 'radiogroup',
    fieldLabel: 'Two Columns',
    // Arrange radio buttons into two columns, distributed vertically
    columns: 2,
    vertical: true,
    items: [
        { boxLabel: 'Item 1', name: 'rb', inputValue: '1' },
        { boxLabel: 'Item 2', name: 'rb', inputValue: '2', checked: true},
        { boxLabel: 'Item 3', name: 'rb', inputValue: '3' },
        { boxLabel: 'Item 4', name: 'rb', inputValue: '4' },
        { boxLabel: 'Item 5', name: 'rb', inputValue: '5' },
        { boxLabel: 'Item 6', name: 'rb', inputValue: '6' }
    ]
} 
```

所以在你从服务器接收到数据后，做一个简单的循环并创建项目数组（每个项目都是`Ext.form.field.Radio`然后创建一个单选组并将这个数组传入。

# unit-of-work - 如何处理工作单元模式中的新对象

> ID：10591516
> 
> 赞同：0
> 
> 时间：2012-05-14T21:43:49.010
> 
> 标签：unit-of-work

我正在实现工作单元模式，但我对新对象感到困惑。在我的 UoW 实现中，我将对象记录在带有索引的数组中，`ClassName.ID`但是当创建一个新对象时它没有 ID（直到它保存到 DB 中），那么我应该如何在 UoW 中跟踪这些对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:53:25.657

我已遵循 [dradu] 的建议并相应地实施了它。因此，对于新项目，我使用的`tempID`是一个以下划线开头的唯一字符串，因此即使该字符串包含所有数字，我仍然可以轻松识别`tempID`. 在保存每个新项目之前，我会得到它`tempID`，如果成功保存，我会从包含 key 的 UoW 中删除对象`ClassName.tempID`，然后再次添加相同的项目。由于此时该项目具有正确的`ID`，因此它添加到 UoW`ClassName.ID`和以后可以很容易地被跟踪。

# caching - 删除 applicationDataDirectory 中的文件

> ID：10591520
> 
> 赞同：2
> 
> 时间：2012-05-14T21:44:00.833
> 
> 标签：caching, mobile, titanium, delete-file

在钛中，删除 applicationDataDirectory 中特定文件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T04:40:12.783

最好的方法很简单：

```
var file = Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory,filename);
if ( file.exists() ) {
     file.deleteFile();
} 
```

有关完整的详细信息[Titanium.Filesystem.File](http://developer.appcelerator.com/apidoc/desktop/latest/Titanium.Filesystem.File-object.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T06:53:42.190

删除文件就是这么简单，

```
var f = Ti.Filesystem.getFile(Ti.Filesystem.applicationDataDirectory, 'delete_me.txt');
f.write('foo');
// make sure there's content there so we're sure the file exists
// Before deleting, maybe we could confirm the file exists and is writable
// but we don't really need to as deleteFile() would just return false if it failed
if (f.exists() && f.writeable) {
    var success = f.deleteFile();
    Ti.API.info((success == true) ? 'success' : 'fail'); // outputs 'success'
} 
```

关于文件系统的最佳材料之一：[https ://wiki.appcelerator.org/display/guides/Filesystem+Access+and+Storage#FilesystemAccessandStorage-Deletingfiles](https://wiki.appcelerator.org/display/guides/Filesystem+Access+and+Storage#FilesystemAccessandStorage-Deletingfiles)

# python - 如何修复 Berkeley DB 文件中不正确的 XML 标签

> ID：10591525
> 
> 赞同：1
> 
> 时间：2012-05-14T21:44:48.367
> 
> 标签：python, berkeley-db

我有一个 Berkeley DB 文件，它的记录中有一些数据已损坏。

记录包含 xml 且 xml 标记不正确。

在其中一项记录中包含：

```
"<modifications></modificatio" 
```

我如何编辑此记录以解决此问题

```
"<modifications></modifications>" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:28:40.230

Berkeley 数据库文件是一个二进制文件，其中包含由应用程序放置在那里的数据库记录。

您通常会首先使用您用来生成文件的任何工具“编辑”文件。如果这对您不可用，最简单的解决方案可能是使用`db_dump`and`db_load`命令。

该`db_dump`命令将数据库转换为文本格式，如下所示：

```
$ db_dump my_broken_database
format=print
type=hash
h_nelem=77
db_pagesize=4096
HEADER=END
 key1\00
 this is a value\00
 key2\00
 this is another value\00
DATA=END 
```

您可以将其转储到文件中...

```
$ db_dump my_broken_database > data.txt 
```

...并使用您最喜欢的文本编辑器进行编辑。进行编辑后，将其输入`db_load`以重新生成数据库：

```
$ db_load my_fixed_database < data.txt 
```

# sql - 将纪元时间值转换为 teradata 中的时间戳（6）

> ID：10591528
> 
> 赞同：0
> 
> 时间：2012-05-14T21:45:13.423
> 
> 标签：sql, teradata

如何将纪元时间值转换为 teradata 中的时间戳（6）？

让我们以 1336987231051 作为示例纪元时间（注意这是以毫秒为单位，而纪元时间以秒为单位），我做了这样的事情

```
// miliseconds epoch time 
select cast(1336987231051 as timestamp(6))

// seconds epoch time 
select cast((1336987231051/1000) as timestamp(6)) 
```

对于上述两个选择语句，我都会收到此错误消息：

```
[Error] Script lines: 12-12 ------------------------
[Teradata Database] [TeraJDBC 13.10.00.31] [Error 5407] [SQLState HY000] Invalid operation for DateTime or Interval. 
```

我在[http://www.epochconverter.com/](http://www.epochconverter.com/)中验证了1336987231051 是有效的纪元时间。

teradata 中的正确 sql 是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T07:27:04.903

```
select
    cast(cast(700101 as date) + seconds_from_epoch / 86400 as timestamp(6)) +
        (seconds_from_epoch mod 86400) * interval '00:00:01' hour to second
from my_table 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-15T23:55:28.053

将 EPOCH 转换为 TERADATA TIME 的最简单方法。

```
SELECT
   1336987231051/1000 as unix_epoc_time   ,
   to_timestamp(unix_epoc_time) utc,
   cast(cast(utc as char(19))||'+00:00' as timestamp(0) with time zone) AT LOCAL    
; 
```

1.  如果您的纪元是 10 位数，则不需要`/1000`.
2.  请记住，Unix 时间是 UTC。
3.  您的系统会将这个“UTC”视为本地。因此，让我们通过添加“+00:00”来了解它是 UTC，然后使用`AT LOCAL`OR 使用“America Central”、“America Eastern”、“America Mountain”等中的任何一个将其转换为您的 LOCAL。

# floating-point - Inno Setup - 将整数 652 转换为浮点数给出 6.52？

> ID：10591529
> 
> 赞同：2
> 
> 时间：2012-05-14T21:45:39.400
> 
> 标签：floating-point, inno-setup

这可能更像是一个 Pascal 问题而不是 Inno Setup 问题。我怎么会这样做：

```
floatnum := 652; 
```

存储在浮点数中的实际值是 6.5200000 而不是 652.000000？

更新：有人指出 6.52 实际上是 652，这让我感到困惑，所以我想我应该更具体一些。这是一些我遇到问题的代码：

```
floatnum := 305 / 600; 
```

我预计 floatnum 将保持在 0.5083333 附近，但事实并非如此，而是保持 5.08333325。这对我来说不合适。我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T23:25:25.530

我认为您只是错过了整个调试器的价值解释。请参阅以下屏幕截图：

![在此处输入图像描述](../Images/216216e1e70cf19d5fe8b909fa749d7b.png)

what的值[`6.52000000000000E+0002 is actually 652`](http://www.wolframalpha.com/input/?i=6.52000000000000E%2b0002)也证实了下一行：

![在此处输入图像描述](../Images/931e9f1f88eca1b7bd3cbaa6eb804509.png)

# php - 列出多个文件扩展名的 PHP 文件

> ID：10591530
> 
> 赞同：64
> 
> 时间：2012-05-14T21:45:40.537
> 
> 标签：php

这是我当前的代码：

```
$files = glob("*.jpg"); 
```

这工作正常。但是，我想列出其他图像类型，例如 .png、gif 等。

我可以请一些帮助来修改上面的代码以使其正常工作。我尝试了以下但没有成功：

```
$files = glob("*.jpg","*.png","*.gif");

$files = glob("*.jpg,*.png,*.gif); 
```

和其他变体...

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2012-05-14T21:48:09.873

```
$files = glob("*.{jpg,png,gif}", GLOB_BRACE); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-13T18:05:42.930

我的两分钱：

```
$availableImageFormats = [
"png",
"jpg",
"jpeg",
"gif"];
$searchDir = /*yourDir*/;
$imageExtensions = "{";
foreach ($availableImageFormats as $extension) {
    $extensionChars = str_split($extension);
    $rgxPartial = null;
    foreach ($extensionChars as $char) {
        $rgxPartial .= "[".strtoupper($char).strtolower($char)."]";
    }
    $rgxPartial .= ",";
    $imageExtensions .= $rgxPartial;
};
$imageExtensions .= "}";
glob($searchDir."/*.".$imageExtensions, GLOB_BRACE) 
```

有了这个，您可以创建一个包含您正在寻找的所有扩展的数组，而不必担心不正确的案例使用。希望能帮助到你

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-05-07T04:40:55.690

# 05 2021

这只是@Jeroen 答案的扩展。

## 要记住的事情

### “标志”很重要

由于您使用的是大括号，因此请记住`GLOB_BRACE`必需。如果没有标志，您将得到一个空数组 if items

```
$files = glob("*.{jpg,png,gif}", GLOB_BRACE); 
```

### 排序

这也将帮助您以您编写的方式对文件进行排序。

```
$files = glob("*.{jpg,png,gif}", GLOB_BRACE);
xx.jpg
xx.jpg
xx.png
xx.gif
xx.gif

$files = glob("*.{gif,jpg,png}", GLOB_BRACE);
xx.gif
xx.gif
xx.jpg
xx.jpg
xx.png 
```

### +奖金

如果你必须列出所有文件但没有文件夹，你可以使用这个

```
$files = glob("*.{*}", GLOB_BRACE); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-21T06:38:52.663

我只是需要这个用于我自己的项目。我做了一个从数组到字符串的转换器。

```
function whitelistToBrace($whitelist) {
  $str = "{";
  $whitelist = !empty($whitelist) ? $whitelist : ['*'];

  foreach($whitelist as $extension) {
    $str .= '*.' . strtolower($extension) . ',';
  };

  $str = substr($str, 0, -1) . '}';

  return $str;
} 
```

**用法**

```
$whitelist = [
  'png',
  'jpg'
];

// glob('my/path/*.{*.png,*.jpg}', GLOB_BRACE);
$glob = glob('my/path/' . whitelistToBrace($whitelist), GLOB_BRACE);
print_r($glob); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-24T00:40:16.670

我找到了一个比使用 GLOB_BRACE 更简单的解决方案，它不区分大小写：

```
$files = array_filter(glob('path/*.*'), function ($filename) { return preg_match('/\.(jpe?g|png|gif)$/i', $filename); });
sort($files); 
```

或者你可以简单地这样做：

```
$files = preg_grep('/\.(jpe?g|png|gif)$/i', glob('path/*.*'));
sort($files); 
```

只是我的两分钱，希望它对最终来到这里的人有所帮助。

# unix - 替代signalfd

> ID：10591531
> 
> 赞同：5
> 
> 时间：2012-05-14T21:45:42.420
> 
> 标签：unix, signals

有没有 signalfd 的替代品（在 Mac OS X 上不可用）？我正在使用多路复用 I/O，`select`并希望以某种同步方式接收信号。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T11:42:42.160

`man kqueue`并在那里寻找`EVFILT_SIGNAL`。

返回的描述符`kqueue()`应该是`poll()`able/ `select()`able。可以使用`kevent()`调用注册和读出事件。

[原始 kqueue 纸](http://people.freebsd.org/~jlemon/papers/kqueue.pdf)

PS我希望我没有离开太多，我自己还没有机会使用kqueue。

# jquery - 通过 AJAX 加载内容，转到下一页，返回，内容不再存在

> ID：10591535
> 
> 赞同：0
> 
> 时间：2012-05-14T21:46:24.720
> 
> 标签：jquery, ajax, back-button, browser-history

我在页面上有一个按钮，上面写着“添加位置”。单击它，表单元素会从 AJAX 请求中出现。当您提交页面并返回时，页面上不再存在这些表单元素。

用户返回时是否可以保持页面的“状态”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:48:39.797

除非您将其保存在 cookie 或`local-storage`HTML5 中，否则不会。

**HTML - Javascript - Web 开发是无状态的。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T21:49:49.593

您可以实现`Dom Storage`功能：

[https://developer.mozilla.org/en/DOM/Storage](https://developer.mozilla.org/en/DOM/Storage)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T21:50:00.503

您可以在 pageLoad 上运行 AJAX 请求，否则您可以使用会话变量或 Cookie 来保存您的数据并在用户导航回页面时重新加载它

# java - 根据括号和下一个字符拆分字符串

> ID：10591540
> 
> 赞同：2
> 
> 时间：2012-05-14T21:47:17.510
> 
> 标签：java, string, split

我在尝试根据括号拆分刺痛时遇到问题。我有一个像这样 Fe(C5H5)2FeO3 的字符串，我需要将字符串拆分为一个数组，以便数组读取

铁

(C5H5)2

三氧化二铁

我正在使用此代码。

```
String form = "Fe(C5H5)2FeO3";
from.split([()]+); 
```

我无法让“）”之后的字符分开。这也必须适用于同一字符串中的多组 ()。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T22:00:36.540

积极向前看和向后看可以做到这一点：

```
String formula = "Fe(C5H5)2FeO3";      
String regex = "(?=\\()|(?<=\\)\\d)";
String[] tokens = formula.split(regex );
System.out.println(Arrays.toString(tokens)); 
```

有关这方面的更多信息，请查看[正则表达式教程](http://www.regular-expressions.info/lookaround.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:07:27.563

您可以使用简单的正则表达式来匹配序列的一部分，而不是在正则表达式上拆分：

```
import java.util.*;
import java.util.regex.*;
import java.lang.*;

class Main {
    public static void main (String[] args) throws java.lang.Exception
    {
            String formula = "Fe(C5H5)2FeO3";
            Pattern p = Pattern.compile("[^(]+|[(][^)]*[)]\\d+");
            Matcher m = p.matcher(formula);
            while (m.find()) {
                    System.out.println(m.group());
            }
    }
} 
```

该程序[产生](http://ideone.com/SOkck)以下输出：

```
Fe
(C5H5)2
FeO3 
```

# c# - 获取 SQL Server 查询元数据

> ID：10591541
> 
> 赞同：0
> 
> 时间：2012-05-14T21:47:23.017
> 
> 标签：c#, sql, sql-server, tsql, metadata

我的问题是是否可以在 C# 中使用本机或其他 API 或在 SQL Server 中访问 SQL 查询的元数据。

在处理标准语句时查找模式信息很容易`SELECT`，但在执行以下操作时变得更加困难：

```
SELECT COUNT(DISTINCT [ColumnA]) as 'CountResult' 
FROM MyTable 
```

目标是找出`CountResult`创建别名的语句的源列，甚至找出语句。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:04:59.140

这可能会有所帮助：`SqlDataReader.GetSchemaTable();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T22:06:48.937

动态管理视图 (DMV) 还提供了相当多的系统信息。要获取快速列表，您可以在此[博客](http://blog.sqlauthority.com/2010/05/15/sql-server-list-all-the-dmv-and-dmf-on-server/)中运行此查询列表。DMV 的名称是不言自明的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T06:15:44.190

不确定这是否有帮助，但您可以在执行计划中获得一些信息。例如，之前使用 SET SHOWPLAN_XML ON 语句执行您的查询。它返回包含有关语句的详细信息的 xml。唯一的问题是，有很多信息，所以您的简单查询示例将获得这样的输出列列表代码。

```
<OutputList>
    <ColumnReference Column="Expr1234" />
</OutputList> 
```

通过查看 Expr1234，您可以发现 Expr2345 的结果被转换为 int：

```
<ColumnReference Column="Expr1234" />
<ScalarOperator ScalarString="CONVERT_IMPLICIT(int,[Expr2345],0)">
    <Convert DataType="int" Style="0" Implicit="1">
        <ScalarOperator>
            <Identifier>
                <ColumnReference Column="Expr2345" />
            </Identifier>
        </ScalarOperator>
    </Convert>
</ScalarOperator> 
```

下一步将是找到 Expr2345，您可以在其中得到：

```
<ColumnReference Column="Expr2345" />
<ScalarOperator ScalarString="Count(*)">
    <Aggregate AggType="countstar" Distinct="0" />
</ScalarOperator> 
```

因此，如果您需要与查询中一样的精确列语句，则很难从计划中获取它。但是，如果允许自定义格式，只是为了了解列中发生的情况，这种方式可能会有所帮助。

# android - 如何创建自定义按钮..如附图中所示？

> ID：10591542
> 
> 赞同：0
> 
> 时间：2012-05-14T21:47:32.463
> 
> 标签：android, layout, button

我想创建 android 按钮，但看起来像图片中的那个。![脸书状态栏](../Images/5678523b5cf6dd65cfa06230497a1749.png)

普通的 android 按钮是弯曲的，并且它们的边界没有连接......我想要我的布局

有没有办法创建这样的布局？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T21:51:08.337

您可以通过在其上设置一个来将任何`ImageView`变成按钮`onClickListener`。

编辑以更好地回答问题：您显示的布局可以通过将一堆 ImageViews 放在水平 LinearLayout 中来创建。LinearLayout 有蓝色背景。为 ImageView 提供源的图像具有透明背景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T06:22:18.267

按钮只是 TextViews 扩展。您只需使用具有三种状态的 xml 可绘制对象更改其背景

# mongodb - MongoDB：如何查询字段为空或未设置的记录？

> ID：10591543
> 
> 赞同：121
> 
> 时间：2012-05-14T21:47:54.260
> 
> 标签：mongodb, null, mongodb-query, exists

我有一个包含日期字段的`Email`文档：`sent_at`

```
{
  'sent_at': Date( 1336776254000 )
} 
```

如果`Email`尚未发送，则该`sent_at`字段为空或不存在。

我需要获取所有已发送/未发送的计数`Emails`。我一直在试图找出查询这些信息的正确方法。我认为这是获取发送计数的正确方法：

```
db.emails.count({sent_at: {$ne: null}}) 
```

但是我应该如何计算未发送的数量？

* * *

## 回答 #1

> 赞同：201
> 
> 时间：2012-05-14T21:55:02.540

如果该`sent_at`字段在未设置时不存在，则：

```
db.emails.count({sent_at: {$exists: false}}) 
```

如果它存在并且为空，或者根本不存在：

```
db.emails.count({sent_at: null}) 
```

如果它在那里并且为空：

```
db.emails.count({sent_at: { $type: 10 }}) 
```

* * *

MongoDB 手册的[Query for Null or Missing Fields](https://docs.mongodb.com/manual/tutorial/query-for-null-fields/)部分描述了如何查询空值和缺失值。

> ## 平等过滤器
> 
> 该`{ item : null }`查询匹配包含其值为`null` *或*不包含该`item`字段的 item 字段的文档。
> 
> ```
> db.inventory.find( { item: null } ) 
> ```

> ## 存在检查
> 
> 以下示例查询不包含字段的文档。
> 
> `{ item : { $exists: false } }`查询匹配不包含该`item`字段的文档：
> 
> ```
> db.inventory.find( { item : { $exists: false } } ) 
> ```

> ## 类型检查
> 
> 该查询*仅*`{ item : { $type: 10 } }`匹配包含值为;的字段的文档。即项目字段的值是[BSON 类型](https://docs.mongodb.com/manual/reference/bson-types/)（类型号）：*`item``null` `Null``10`*
> 
>  *```
> db.inventory.find( { item : { $type: 10 } } ) 
> ```*

 ** * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-01-17T03:46:43.493

如果您只想计算`sent_at`值定义为的文档`null`（不要计算`sent_at`未设置的文档）：

```
db.emails.count({sent_at: { $type: 10 }}) 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2017-04-06T07:03:23.840

利用：

```
db.emails.count({sent_at: null}) 
```

它计算所有 sent_at 属性为 null 或未设置的电子邮件。上面的查询与下面的相同。

```
db.emails.count($or: [
  {sent_at: {$exists: false}},
  {sent_at: null}
]) 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-04-07T11:04:03.803

似乎你可以只做单行：

```
{ "sent_at": null } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-09-28T08:27:13.817

以上所有答案都是惊人的和正确的。只想对正在使用的答案添加一项改进`$type`。

[从 MongoDB 3.2 开始](https://docs.mongodb.com/manual/reference/operator/query/type/#available-types)，您可以避免使用`10`（因为硬编码文字会降低代码的可读性），而是可以简单地使用字符串别名，即`"null"`. 所以总结一下——

### 1.如果要选择`sent_at`存在且具有价值的记录`null`

```
db.emails.count({sent_at: { $type: 'null' }});

// or
// This reduces the code readability as your peer might not know
// that what is the meaning of value 10
db.emails.count({sent_at: { $type: 10 }}); 
```

### 2.如果你想选择有`sent_at: null`或`sent_at`不存在的记录

```
// This will ensure both the conditions
db.emails.count({ sent_at: null }) 
```

### 3.如果你只想要不`sent_at`存在的记录

```
db.emails.count({sent_at: { $exists: false }}); 
```

### 4.如果你只想选择`sent_at`字段存在的位置并且可能有任何值

```
db.emails.count({sent_at: { $exists: true }}); 
```

请记住，这将拉取任何`emails`具有任何价值的文档，包括`null`, `0`, `''`, `false`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-11T17:31:40.410

你也可以试试这个：

```
db.emails.find($and:[{sent_at:{$exists:true},'sent_at':null}]).count() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-10T13:11:42.553

您可以使用 $in 运算符来检查这两种情况

```
db.emails.find({"sent_at": {$in:[null,""]}).count() 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-16T13:37:06.643

如果需要在同一文档中检查属性和值是否存在等于 null -

```
db.emails.count($or: [
  {sent_at: {$exists: false}},
  {sent_at: null}
]) 
```

以上可以在单行查询中完成，这将花费更少的时间，因为-

```
db.emails.count($or: [ {sent_at: nil }]) 
```

因为`nil`如果`doesn't exist`除了 value 之外的 key 也是`null`.
[最好看一下](https://www.mongodb.com/community/forums/t/query-if-a-field-exist-or-is-null-from-golang/105943)它节省了我一天的来源。

> 注意：在较新版本的 mongodb 中使用`nil`，而不是。`null`

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2020-09-10T15:49:23.947

```
db.employe.find({ $and:[ {"dept":{ $exists:false }, "empno": { $in:[101,102] } } ] }).count(); 
```*

# sql - 如何在 SQL 中查找上周最畅销的书籍

> ID：10591545
> 
> 赞同：0
> 
> 时间：2012-05-14T21:48:02.753
> 
> 标签：sql, sql-server

我正在尝试为我的家庭作业建立一个在线书店。
我想按时间（上周、上个月、所有时间）列出最畅销的书籍。
我写了所有时间查询，但无法计算上周查询。
有人可以帮帮我吗？

这是表格：

```
TbSoldBooks (saleID, BookID, SaleDate) 
```

（我搜索了但找不到答案）

更新：这是有史以来最畅销的书籍。

```
SELECT b.bookID, COUNT(b.bookID) AS All-Time  
FROM TbSoldBooks b  
GROUP BY b.bookID 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:49:31.457

好吧，我不想毁了你*所有*的功课，但你可以尝试`GROUP`通过 BookID 和`COUNT`每本书的销售量。

编辑：我看到你对比较日期感到困惑。那就看看吧[`DATEADD`](http://www.w3schools.com/sql/func_dateadd.asp)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:01:35.960

```
SELECT top 10 b.bookID, COUNT(b.bookID) 
FROM TbSoldBooks b  
GROUP BY b.bookID
Where SaleDate >= DateAdd(day, -7, getDate()) -- last week
Order by 2 desc

SELECT top 10 b.bookID, COUNT(b.bookID) 
FROM TbSoldBooks b  
GROUP BY b.bookID
Where SaleDate >= DateAdd(month, -1, getDate()) -- last month
Order by 2 desc 
```

# javascript - 如何从 url 获取 youtube 视频 ID

> ID：10591547
> 
> 赞同：15
> 
> 时间：2012-05-14T21:48:19.190
> 
> 标签：javascript, jquery, youtube

我正在尝试检查一个 url 是否是一个有效的 youtube 视频 URL 并从中获取 youtube 视频 ID，到目前为止，我正在使用一个简单的 javascript 拆分函数来实现这一点，但是这有一些小缺点，因为 youtube 有多个 URL .

我一直在查看其他 stackoverflow 线程，但是它们都只支持 1 个特定的 URL，这不是我需要的。

我需要与所有这些 URL 匹配的东西：

> http(s)://www.youtu.be/videoID
> 
> http(s)://www.youtube.com/watch?v=videoID

（以及可选的任何其他短 URL，脚本会自动检测它是否包含 youtube 视频）

非常感谢浏览器可以快速/高效处理的任何想法！

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-05-14T21:52:42.397

尝试这个：

```
var url = "...";
var videoid = url.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&]+)/);
if(videoid != null) {
   console.log("video id = ",videoid[1]);
} else { 
    console.log("The youtube url is not valid.");
} 
```

见正则表达式：

```
/
(?:https?:\/{2})? // Optional protocol, if have, must be http:// or https://
(?:w{3}\.)?      // Optional sub-domain, if have, must be www.
youtu(?:be)?  // The domain. Match 'youtu' and optionally 'be'. 
\.(?:com|be) // the domain-extension must be .com or .be
(?:\/watch\?v=|\/)([^\s&]+) //match the value of 'v' parameter in querystring from 'watch' directory OR after root directory, any non-space value.
/ 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-14T21:54:39.587

也许您应该查看 Youtube API 并尝试查看是否有一种方法可以通过 API 解析 URL 来获取 videoID。

看看这个 SO 帖子： [Youtube API - 提取视频 ID](https://stackoverflow.com/questions/6556559/youtube-api-extract-video-id)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-14T21:57:24.277

这可能很快：

```
var url = 'http://www.youtu.be/543221'; 
         //http://www.youtube.com/watch?v=SNfYz6Yw0W8&feature=g-all-esi would work also
var a = url.split("v=")[1];
a = a != undefined ? a : url.split("youtu.be/")[1];
b = a.split("&")[0]; 
```

变量 c 将具有您的 ID。快的。正则表达式更好......虽然更难阅读。我已经修改了我的代码来解决这两个问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-17T02:16:26.460

种类太多了：

*   最新短格式：`http://youtu.be/NLqAF9hrVbY`
*   框架：`http://www.youtube.com/embed/NLqAF9hrVbY`
*   iframe（安全）：`https://www.youtube.com/embed/NLqAF9hrVbY`
*   对象参数：`http://www.youtube.com/v/NLqAF9hrVbY?fs=1&hl=en_US`
*   对象嵌入：`http://www.youtube.com/v/NLqAF9hrVbY?fs=1&hl=en_US`
*   手表：`http://www.youtube.com/watch?v=NLqAF9hrVbY`
*   用户：`http://www.youtube.com/user/Scobleizer#p/u/1/1p3vcRhsYGo`
*   yt放映室：`http://www.youtube.com/ytscreeningroom?v=NRHVzbJVx8I`
*   什么都行！：`http://www.youtube.com/sandalsResorts#p/c/54B8C800269D7C1B/2/PPS-8DMrAn4`
*   任何/子域/也是：`http://gdata.youtube.com/feeds/api/videos/NLqAF9hrVbY`
*   更多参数：`http://www.youtube.com/watch?v=spDj54kf-vY&feature=g-vrec`
*   查询可能有点：（`http://www.youtube.com/watch?v=spDj54kf-vY&feature=youtu.be` 来源：[如何使用正则表达式在字符串中查找所有 YouTube 视频 ID？](https://stackoverflow.com/questions/5830387/how-to-find-all-youtube-video-ids-in-a-string-using-a-regex)）

最好的方法是限制输入数据。

祝你好运

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-16T03:30:45.103

试试这个代码

```
var url = "...";
var videoid = url.match((?:youtube(?:-nocookie)?\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11}));
if(videoid != null) {
    console.log("video id = ",videoid[1]);
} else { 
    console.log("The youtube url is not valid.");
} 
```

正则表达式来自 [YouTube 视频 ID 正则表达式](https://gist.github.com/afeld/1254889)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-27T19:39:22.893

您可以使用 preg_match 轻松做到这一点，例如：
`$url = "http://www.youtube.com/watch?v=YzOt12co4nk&feature=g-vrec"; preg_match('/v=([0-9a-zA-Z]+)/', $url, $matches); $vid = $matches[1];`
现在您将拥有视频 ID：$vid = YzOt12co4nk;

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-03T16:41:37.660

我找到了一种不使用正则表达式的简单方法。

我做了一个为你做的函数：

```
function getLink(url){
    fetch('www.youtube.com/oembed?url=' + url).then(res => {
     var thumbnailUrl = res.thumbnail_url;
     var id = thumbnail_url.split('vi/')[1].substring(0, 11);
     return id;}
      )
}

console.log(getLink(your_url));
// here replace 'your_url' with your specified youtube url. 
```

所有这一切都是，它使用 youtube api 并将您的 url 作为参数传递，而 youtube 会处理 url 的类型，因此您不必担心。接下来的事情是，该函数然后从该 api 获取“thumbnail_url”数据，然后相应地拆分缩略图的 url 以找到视频的 ID。

# javascript - jQuery click() 并更改选中的值

> ID：10591548
> 
> 赞同：1
> 
> 时间：2012-05-14T21:48:36.100
> 
> 标签：javascript, javascript-events, jquery

看下面的jsfiddle：http: [//jsfiddle.net/RA3GS/4/](http://jsfiddle.net/RA3GS/4/)

如果您手动选中复选框，您会看到它们在选中时表示已选中并保持选中状态。但是，如果您按下测试按钮，您会看到它们要么说它们已检查，然后变为未选中，要么说它们未检查，然后说它们已检查。

这是问题所在：如果我选择不事先设置选中的值，则最后会正确选中复选框，但单击的函数错误地声明它未选中。如果我确实设置了选中的值，那么 click() 函数正确地指出复选框已选中，但随后一些其他事件（取消）有助于在最后取消选中复选框。

jsfiddle 是一个测试；在我的实际实现中，我将无法控制输入元素上的 click() 函数，因此这不仅仅是更改 click 函数中的登录名的问题。

这正是我想要的行为：

*   你点击按钮。
*   任何 click() 函数都会被触发并相信要检查的元素。
*   所有其他事件都认为该复选框被选中。
*   当一切都说完了，复选框仍然被选中。

## 更简单的例子

我在这里放了一个更简单的 jsfiddle：http: [//jsfiddle.net/49jUL/](http://jsfiddle.net/49jUL/)

在不更改`status`功能的情况下，无论您选中哪个复选框，我都希望控制台显示相同。当前输出为：

**点击手册**

```
A tester received the following event change
Value:  100  Checked:  true
A tester received the following event click
Value:  100  Checked:  true 
```

**点击控制器**

```
A tester received the following event click
Value:  100  Checked:  true
A tester received the following event change
Value:  100  Checked:  false 
```

我发现有趣的是，如果我单击手动单选按钮，`change`首先调用*然后* `click`调用，而如果我触发单击，`click`调用*然后* `change`调用。

请注意，当我尝试调用它时，`$target.change().click()`它只是调用`change`, then `click`，然后 finally`change`再次`checked`设置为 false。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T16:47:35.880

^(根据我的评论——)

该`checked`字段是*property*，而不是*attribute*，因此我建议对“已检查”状态使用适当的访问器和 mutator：

```
$('#checkBoxElId').prop("checked"); 
```

和

```
$('#checkBoxElId').prop("checked", true/false); 
```

或者，您可以使用`is()`带有`:checked`伪选择器的函数来查看它是否被选中：

```
$('#checkBoxElId').is(':checked'); 
```

“checked”属性在复选框初始加载后不会改变。有关复选框状态的更多信息，请参阅[jQuery 文档。](http://api.jquery.com/prop/)`prop()`

* * *

**编辑：解决方案**

在找到解释此行为[的错误报告](http://bugs.jquery.com/ticket/3827#comment:9)后，我对错误注释中记录的解决方法进行了一些实验：使用 of`triggerHandler("click")`而不是调用`click()`.

`click()`只是一个快捷方式`trigger("click")`，它将触发选择器找到的所有元素上的匹配事件，并且还将调用本机处理程序。`triggerHandler("click")`, OTOH，只会触发选择器找到的第一个元素的事件，并且会阻止默认（本机）行为的发生。这是与复选框的“选中”状态混淆的本机行为。通过避免它，您可以获得所需的行为。

这是我的解决方案的[更新 jsFiddle](http://jsfiddle.net/49jUL/3/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T22:05:33.370

您不能简单地触发单击复选框，您需要验证当前状态，然后采取相应措施：

```
$('#pushbutton').on("click", function() {
    var $obj = $('#myCheckBoxID');
    $obj.prop('checked', !$obj.prop('checked'));
    alert('now check is: ' + $obj.prop('checked'));
}); 
```

请参阅此[小提琴示例！](http://jsfiddle.net/zuul/j85S6/)

### 已编辑

ThiefMaster 在第一条评论中给出了改进。

# nhibernate - NHibernate 的自定义 ADO.Net 提供程序

> ID：10591549
> 
> 赞同：1
> 
> 时间：2012-05-14T21:48:37.727
> 
> 标签：nhibernate, ado.net

我的公司正在使用一个名为 U2 Universe 的数据库。数据库制造商为我们提供了与 Microsoft 的实体框架一起使用的 ADO.Net 提供程序。

是否可以扩展 NHibernate 以使其与 ADO.Net 提供程序一起使用？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T23:11:54.513

当然是。你需要实现`IDriver`and `Dialect`（你可以使用`GenericDialect`，但它通常太有限了）

例如，查看现有[驱动程序](https://github.com/nhibernate/nhibernate-core/tree/master/src/NHibernate/Driver)和[方言](https://github.com/nhibernate/nhibernate-core/tree/master/src/NHibernate/Dialect)的来源。

# linux - 计算下一个 ASCII 字符的 Linux 命令或 Bash 语法

> ID：10591553
> 
> 赞同：7
> 
> 时间：2012-05-14T21:49:05.980
> 
> 标签：linux, perl, bash, awk

我有一台 Linux 机器（[Red Hat Linux](http://en.wikipedia.org/wiki/Red_Hat_Linux) 5.1），我需要将以下任务添加到我的 Bash 脚本中。

哪个 Linux 命令或 Bash 语法将计算下一个 ASCII 字符？

备注 - 命令语法也可以是[AWK](http://en.wikipedia.org/wiki/AWK) /Perl，但此语法必须在我的 Bash 脚本中。

例子：

```
 input                  results

 a    --> the next is   b
 c    --> the next is   d
 A    --> the next is   B 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T21:57:51.457

使用翻译 ( `tr`)：

```
echo "aA mM yY" | tr "a-yA-Y" "b-zB-Z" 
```

它打印：

`bB nN zZ`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T21:58:57.303

Perl 的[`++`运算符](http://perldoc.perl.org/perlop.html#Auto-increment-and-Auto-decrement)在一定程度上也处理字符串：

```
perl -nle 'print ++$_' 
```

`-l`这里需要带有 autochomp的选项，因为`a\n`example 否则会返回`1`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T21:52:44.773

您可以为 Bash使用`chr()`和函数（请参阅*[如何将 ASCII 字符转换为其十进制（或十六进制）值并返回？](http://mywiki.wooledge.org/BashFAQ/071)*）：`ord()`

```
# POSIX
# chr() - converts decimal value to its ASCII character representation
# ord() - converts ASCII character to its decimal value 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T21:56:01.037

```
perl -le "print chr(ord(<>) + 1)" 
```

交互的：

```
breqwas@buttonbox:~$ perl -le "print chr(ord(<>) + 1)"
M
N 
```

非交互：

```
breqwas@buttonbox:~$ echo a | perl -le "print chr(ord(<>) + 1)"
b 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-24T05:35:25.073

字符值：

```
c="a" 
```

要将字符转换为其 ASCII 值：

```
v=$(printf %d "'$c") 
```

您要添加到此 ASCII 值的值：

```
add=1 
```

通过向其添加 $add 来更改其 ASCII 值：

```
((v+=add)) 
```

要将结果转换为 char：

```
perl -X -e "printf('The character is %c\n', $v);" 
```

我曾经`-X`禁用所有警告

* * *

**您可以将所有这些组合在一行中，并将结果放入变量 $r 中：**

```
c="a"; add=1; r=$(perl -X -e "printf('%c', $(($add+$(printf %d "'$c"))));") 
```

您可以打印结果：

```
echo "$r" 
```

* * *

**您可以创建一个函数来返回结果：**

```
achar ()
{
     c="$1"; add=$2
     printf "$(perl -X -e "printf('%c', $(($add+$(printf %d "'$c"))));")"
} 
```

您可以使用以下功能：

```
x=$(achar "a" 1) // x = the character that follows a by 1 
```

或者你可以做一个循环：

```
array=( a k m o )
for l in "${array[@]}"
do
     echo "$l" is followed by $(achar "$l" 1)
done 
```

# ruby - 如何使用 Mongoid 为 MongoDB 文档定义我自己的主键

> ID：10591564
> 
> 赞同：0
> 
> 时间：2012-05-14T21:50:01.047
> 
> 标签：ruby, mongodb, mongoid

我不想用`_id`作主键，但想定义自己的键。给定以下 mongo 对象，我如何使用 mongoid 来做到这一点。

```
class Product
  include Mongoid::Document

end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T22:39:22.347

如果您想使用具有其他名称的键作为主键，那么您不能这样做。每个文档都必须有一个名为 的键`_id`，其值将是主键索引条目。这就是 MongoDB 的工作方式。

但是，字段的值`_id`不必是 ObjectID。你可以在那里拥有任何你喜欢的东西（除了数组，IIRC）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T21:53:37.530

从 MongoDB[网站](http://www.mongodb.org/display/DOCS/Object+IDs)：

“在 MongoDB shell 中，ObjectId() 可用于创建 ObjectIds。ObjectId(string) 从指定的十六进制字符串创建对象 ID。”

那里也有一个代码示例

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-08T14:02:35.787

Sergio Tulentsev 说得对，_id 不一定是 ObjectID。

但是，我担心 Lynn Langit 的回答可能会产生误导。'ObjectId(string) 从指定的十六进制字符串创建对象 ID' 是真的，但这里的字符串必须是有效的 ObjectID。您不能从有意义的字符串创建 ObjectID。

# java - 为按住的控制按钮生成 KeyStroke

> ID：10591566
> 
> 赞同：0
> 
> 时间：2012-05-14T21:50:18.140
> 
> 标签：java, swing, user-interface, keyboard

我正在尝试进行键绑定。我想生成一个 KeyStroke ，如果仅在按住控制键的情况下执行操作。我不明白我做错了什么我对我的其他键绑定（Control+up、Control+down、up、c、p 和其他按钮）使用相同的技术，我尝试使用 CTRL_DOWN_MASK、CTRL_MASK 、VK_CONTROL 和“CONTROL”，但这些似乎都不起作用。我知道它不是我将其绑定到的方法，因为当我将其他两个键绑定到该操作 (Control+Z) 时它可以工作，但我只想将它绑定到 (Control) 这是我正在使用的代码。如果可以的话请帮忙。

```
InputMap imap = leftPanel.getInputMap(mapName);
KeyStroke leftArrowKey = KeyStroke.getKeyStroke("LEFT");
imap.put(leftArrowKey, "left");
KeyStroke rightArrowKey = KeyStroke.getKeyStroke("RIGHT");
imap.put(rightArrowKey, "right");
KeyStroke upArrowKey = KeyStroke.getKeyStroke("UP");
imap.put(upArrowKey, "up");
KeyStroke cKey = KeyStroke.getKeyStroke('c');
imap.put(cKey, "c");
KeyStroke spaceKey = KeyStroke.getKeyStroke("SPACE");
imap.put(spaceKey, "space");
KeyStroke zoomInKeys = KeyStroke.getKeyStroke(VK_DOWN, CTRL_DOWN_MASK);
imap.put(zoomInKeys, "zoomin");
KeyStroke zoomOutKeys = KeyStroke.getKeyStroke(VK_UP, CTRL_DOWN_MASK);
imap.put(zoomOutKeys, "zoomout");
KeyStroke panKeys = KeyStroke.getKeyStroke("CONTROL");
imap.put(panKeys, "pan");

ActionMap amap = leftPanel.getActionMap();
amap.put("left", moveLeft);
amap.put("right", moveRight);
amap.put("up", increaseSpeed);
amap.put("c", changePaddleMode);
amap.put("space", nextBall);
amap.put("zoomin", zoomIn);
amap.put("zoomout", zoomOut);
amap.put("pan", pan); 
```

问题出现在最后一个 KeyStroke (panKeys) 中，我不知道在 getKeyStroke() 方法中放入什么，以使其响应被按住的控制键。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:09:39.997

这似乎对我有用：

```
public static void main(String[] args) {

  JLabel label = new JLabel("Foo");
  int condition = JLabel.WHEN_IN_FOCUSED_WINDOW;
  InputMap inputmap = label.getInputMap(condition);
  ActionMap actionmap = label.getActionMap();

  // first to test that this works.
  final String xKeyPressed = "x key pressed";
  inputmap.put(KeyStroke.getKeyStroke(KeyEvent.VK_X, 0), xKeyPressed );
  actionmap.put(xKeyPressed, new AbstractAction() {

     @Override
     public void actionPerformed(ActionEvent arg0) {
        System.out.println(xKeyPressed);
     }
  });

  // Next to try it with just the control key
  final String controlKeyPressed = "control key pressed";
  inputmap.put(KeyStroke.getKeyStroke(KeyEvent.VK_CONTROL, 
          KeyEvent.CTRL_DOWN_MASK), controlKeyPressed );
  actionmap.put(controlKeyPressed, new AbstractAction() {

     @Override
     public void actionPerformed(ActionEvent arg0) {
        System.out.println(controlKeyPressed);
     }
  });
  JOptionPane.showMessageDialog(null, label);
} 
```

# forms - sfWidgetFormDoctrineChoice 添加额外的选择字段

> ID：10591570
> 
> 赞同：0
> 
> 时间：2012-05-14T21:50:35.523
> 
> 标签：forms, symfony1, render

我正在使用 sfWidgetFormDoctrineChoice 并且正在从表中读取选项。是否可以轻松添加一个选项并将其放在第一个不在此表中的位置？

选项我的意思是 html 选项：

```
<select>
   <option val="new"></option>
</select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:00:11.483

您始终可以本地化选择，然后在结果数组前面加上您想要使用的值：

```
$choice = new sfWidgetFormDoctrineChoice(array('model' => 'MODEL', 'order_by' => array('name', 'asc')));

$choices = $choice->getChoices();

array_unshift($choices, array('key' => 'My Custom Value'));

$this->widgetSchema['widget_name']      = new sfWidgetFormChoice(array('choices' => $choices));
$this->validatorSchema['widget_name']   = new sfValidatorChoice(array('choices' => array_keys($choices)); 
```

# android - 当我尝试加载纹理时，android上的gles20会出现黑屏

> ID：10591576
> 
> 赞同：0
> 
> 时间：2012-05-14T21:51:37.010
> 
> 标签：android, opengl-es, opengl-es-2.0, textures

我正在尝试在我的应用程序中加载纹理（480x720px）作为背景，但它显示为黑色。我对 GLES20 有点陌生，所以我在互联网上遵循了一些示例来构建我的代码，但这并没有让我走运。怎么修？

这是我的着色器代码：

```
public class Shaders {

private int mProgram;
private int maPositionHandle;
private int texCoords;

FloatBuffer texBuffer;
int iBaseMap;

private final String vertexShaderCode = 
                "attribute vec4 a_position;" +
                "attribute vec2 a_texCoords;" +
                "varying vec2 v_texCoords;" +
                "void main()" +
                "{" +
                "gl_Position = a_position;" +
                "v_texCoords = a_texCoords;" +
                "}";

private final String fragmentShaderCode = 
                "precision mediump float;" +
                "varying vec2 v_texCoords;" +
                "uniform sampler2D u_baseMap;" +
                "void main()" +
                "{" +
                "gl_FragColor = texture2D(u_baseMap, v_texCoords);" +
                "}";

private int loadShader(int type, String shaderCode){

    // create a vertex shader type (GLES20.GL_VERTEX_SHADER)
    // or a fragment shader type (GLES20.GL_FRAGMENT_SHADER)
    int shader = GLES20.glCreateShader(type); 

    // add the source code to the shader and compile it
    GLES20.glShaderSource(shader, shaderCode);
    GLES20.glCompileShader(shader);

    return shader;
}

public void initShaders() {

    GLES20.glEnable(GLES20.GL_TEXTURE_2D);

    GLES20.glClearColor(0.5f, 0.5f, 0.5f, 1.0f);

    int vertexShader = loadShader(GLES20.GL_VERTEX_SHADER, vertexShaderCode);
    int fragmentShader = loadShader(GLES20.GL_FRAGMENT_SHADER, fragmentShaderCode);

    mProgram = GLES20.glCreateProgram();             // create empty OpenGL Program
    GLES20.glAttachShader(mProgram, vertexShader);   // add the vertex shader to program
    GLES20.glAttachShader(mProgram, fragmentShader); // add the fragment shader to program
    GLES20.glLinkProgram(mProgram);                  // creates OpenGL program executables

    // get handle to the vertex shader's vPosition member
    maPositionHandle = GLES20.glGetAttribLocation(mProgram, "a_position");
    iBaseMap = GLES20.glGetUniformLocation(mProgram, "u_baseMap");
    texCoords = GLES20.glGetAttribLocation(mProgram, "a_texCoords");

    GLES20.glDeleteShader(vertexShader);
    GLES20.glDeleteShader(fragmentShader);

    GLES20.glViewport(0, 0, Settings.width, Settings.height);

}

public int getMPH() {

    return maPositionHandle;

}

public int getMProg() {

    return mProgram;

}

public int getIBaseMap() {

    return iBaseMap;

}   

public int getTexCoords() {

    return texCoords;

}   

public int loadTexture(GLSurfaceView view, int imgResID){

    Bitmap img = null;
    int textures[] = new int[1];

    img = BitmapFactory.decodeResource(view.getResources(), imgResID);

    System.out.println(imgResID);

    GLES20.glGenTextures(1, textures, 0);

    GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textures[0]);

    GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_S, GLES20.GL_CLAMP_TO_EDGE);

    GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_T, GLES20.GL_CLAMP_TO_EDGE);

    GLUtils.texImage2D(GLES20.GL_TEXTURE_2D, 0, img, 0);

    img.recycle();

    return textures[0];

} 
```

}

以及我绘制背景的课程：

```
public class Background {

Shaders shaders;

int texId;

private GLSurfaceView mGLView;

private float BackgroundCoords[] = {

        // X, Y, Z
        -1f, -1f, 0, 0,0,
        -1f,  1f, 0, 0, 1,
         1f,  1f, 0, 1, 0,
         1f, -1f, 0, 1, 1

    };

private FloatBuffer backBuffer;

public void setAct(Shaders s, GLSurfaceView v) {

    shaders = s;
    mGLView = v;

    texId = shaders.loadTexture(mGLView, R.raw.ground_tex);

    System.out.println(texId);

}

public Background() {

    // a float has 4 bytes so we allocate for each coordinate 4 bytes
    ByteBuffer vertexByteBuffer = ByteBuffer.allocateDirect(BackgroundCoords.length * 4);
    vertexByteBuffer.order(ByteOrder.nativeOrder());

    // allocates the memory from the byte buffer
    backBuffer = vertexByteBuffer.asFloatBuffer();

    // fill the vertexBuffer with the vertices
    backBuffer.put(BackgroundCoords);

    // set the cursor position to the beginning of the buffer
    backBuffer.position(0);

}

/** The draw method for the square with the GL context */
public void draw() {

    // Add program to OpenGL environment
    GLES20.glUseProgram(shaders.getMProg());

    // Point to our vertex buffer
    backBuffer.position(0);
    GLES20.glVertexAttribPointer(shaders.getMPH(), 3, GLES20.GL_FLOAT, false, 5 * 4, backBuffer);
    GLES20.glEnableVertexAttribArray(shaders.getMPH());

    backBuffer.position(3);
    GLES20.glVertexAttribPointer(shaders.getTexCoords(), 2, GLES20.GL_FLOAT, false, 5 * 4, backBuffer);
    GLES20.glEnableVertexAttribArray(shaders.getTexCoords());   

    GLES20.glActiveTexture(GLES20.GL_TEXTURE0);
    GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texId);
    GLES20.glUniform1i(shaders.getIBaseMap(), 0);

    // Draw the vertices as triangle strip
    GLES20.glDrawArrays(GLES20.GL_TRIANGLES, 0, 4);

} 
```

}

如果我只尝试使用简单的着色器，则此代码有效，尽管填充背景的两个三角形中只有一个被着色。

每次调用 GLES 时都会出现源自 loadTexture 函数的错误“E/libEGL(8971)：在没有当前上下文的情况下调用 OpenGL ES API（每个线程记录一次）”=。

我真的希望有人能帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T01:50:35.697

> `"color = texture2D(u_baseMap, gl_PointCoord);"`

Why did you decide to use gl_PointCoord here? You're drawing triangles, and according to the [documentation](http://www.opengl.org/sdk/docs/manglsl/xhtml/gl_PointCoord.xml):

> If the current primitive is not a point, then values read from gl_PointCoord are undefined.

If you want to use gl_PointCoord, than draw GL_POINTS, not GL_TRIANGLES. Otherwise generate and send texture coordinates.

# android - 从我的按钮打开墙纸应用程序

> ID：10591578
> 
> 赞同：0
> 
> 时间：2012-05-14T21:51:48.110
> 
> 标签：android, wallpaper

如何从我的应用程序中打开系统壁纸应用程序（单击按钮）？我可以像浏览图片一样等待结果吗？

让我更具体一点：我的应用程序会根据电池电量更改壁纸。因此，超过 75% 的人使用一个文件，超过 50% 的人使用另一个文件，依此类推……为此，我允许用户浏览他/她想要打开文件浏览器并选择文件的图像文件。为此，有一个带有“打开浏览器”文本的按钮。我等待结果并获取图像。

现在我正在尝试这个：我想让用户点击另一个带有文本“打开壁纸选择器”的按钮，并希望打开它（系统默认壁纸选择器）。然后我将等待结果，获取新壁纸并将其保存到文件中，以便在电池电量进一步达到该水平时再次使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T07:01:11.860

您可以尝试使用[WallpaperManager](http://developer.android.com/reference/android/app/WallpaperManager.html)获取当前壁纸。不过，不确定如何提示标准壁纸选择器。

另一种方法是只使用通用图像选择器（这是对[类似问题的答案中](https://stackoverflow.com/a/3707280/663469)使用的方法）

# mongodb - mongodb - 查询嵌入式文档 - 仅返回嵌入式集合中每个软件的中等屏幕截图

> ID：10591580
> 
> 赞同：-1
> 
> 时间：2012-05-14T21:52:09.397
> 
> 标签：mongodb, nosql

我有这个简单的 mongo 集合：

```
{
  "_id": ObjectId("4fb176f964debef01e000000"),
  "applicationId": NumberInt(1),
  "screenshots": [
    {
      "caption": "ddd",
      "images": [
        {
          "size": "large",
          "file": {
            "$ref": "File",
            "$id": ObjectId("4fb176f964debef01e000001"),
            "$db": "flukeytest"
          }
        },
        {
          "size": "medium",
          "file": {
            "$ref": "File",
            "$id": ObjectId("4fb176f964debef01e000002"),
            "$db": "flukeytest"
          }
        },
        {
          "size": "small",
          "file": {
            "$ref": "File",
            "$id": ObjectId("4fb176f964debef01e000003"),
            "$db": "flukeytest"
          }
        }
      ]
    },
    {
      "caption": "tetsss",
      "images": [
        {
          "size": "large",
          "file": {
            "$ref": "File",
            "$id": ObjectId("4fb1771164debe9c1a000000"),
            "$db": "flukeytest"
          }
        },
        {
          "size": "medium",
          "file": {
            "$ref": "File",
            "$id": ObjectId("4fb1771164debe9c1a000001"),
            "$db": "flukeytest"
          }
        },
        {
          "size": "small",
          "file": {
            "$ref": "File",
            "$id": ObjectId("4fb1771164debe9c1a000002"),
            "$db": "flukeytest"
          }
        }
      ]
    }
  ]
} 
```

我已经阅读了很多关于 $where 函数和 map reduce 的内容，但可惜我并没有走得太远。我正在尝试为一个应用程序 ID 选择每个屏幕截图的所有中等图像。我不确定如何只返回每个屏幕截图的中等图像，仅此而已。有任何想法吗？任何指针都会很棒:)

编辑：`db.Screenshot.find({ "applicationId": 1, "$where": "function() { return this.screenshots.images.size == 'medium'; }" }).sort([ ]);`我已经走了这么远，但它不起作用。唉。仍在阅读我在谷歌上可以找到的所有内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:55:31.833

你为什么试图只返回中等屏幕截图？是出于性能原因吗？如果每个 applicationId 有一个文档，那么仅返回中等屏幕截图不会更有效（例如，MongoDB 将执行相同数量的物理 IO 从磁盘加载数据）。在这种情况下，MongoDB 与 RDBMS 有很大不同。

除非有问题的文档很大，并且您尝试在一个查询中返回许多应用程序的中等屏幕截图，否则不会有太多（如果有的话）性能优势。我建议您只需通过 applicationId 查询文档，然后在代码中过滤掉您想要的屏幕截图。

最终，您可能能够使用新的[聚合框架](http://www.mongodb.org/display/DOCS/Aggregation#Aggregation-AggregationFramework)来做这种事情，但它要到 2.2 才会发布。

# jquery - jQuery-File-Upload 在花哨的盒子或灯箱内

> ID：10591590
> 
> 赞同：2
> 
> 时间：2012-05-14T21:53:46.380
> 
> 标签：jquery, file, uploader

我和许多其他人都想知道如何让 jquery 文件上传器在不使用 iframe 的情况下在精美的盒子中工作，这可能吗？

我已经尝试了一个 php 包含，你可以让它显示它只是 dosnt 正常工作:(

我真的很感激任何帮助谢谢堆！

这是与同一问题有关的另一篇文章 [https://github.com/blueimp/jQuery-File-Upload/issues/947](https://github.com/blueimp/jQuery-File-Upload/issues/947)

# linux - 将命令粘贴到终端并让它们一个接一个地运行，即使一个需要密码

> ID：10591591
> 
> 赞同：2
> 
> 时间：2012-05-14T21:53:46.870
> 
> 标签：linux, bash, terminal

如果我尝试运行多个命令，并且假设我必须执行一个需要密码的 SSH，那么一旦我输入所述密码，其余命令就不会执行。

在您告诉我设置 SSH 密钥之前，具有讽刺意味的是，该过程是通过粘贴命令来设置 SSH 密钥。

如果我在某个地方失去了你，请告诉我，我会重新措辞。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:59:46.733

您可以通过使用运算符分隔多个命令来串行执行多个命令`&&`。如果前一个命令成功执行，它将继续执行下一个命令。

例子：

```
cat /proc/cpuinfo && /bin/true 
```

由于第一个命令而导致第二个命令未执行的示例：

```
/bin/false && cat /proc/cpuinfo 
```

（这是假设您使用的是 bash shell）

如果您不关心命令是否成功执行，可以用分号分隔它们`;`。

# sql-server-2008 - 解析 XML 字段的值

> ID：10591592
> 
> 赞同：0
> 
> 时间：2012-05-14T21:53:54.090
> 
> 标签：sql-server-2008, tsql

我希望在 XML 字段上做一个 WHERE。下面的代码是我到目前为止的一个例子：

```
SELECT *
FROM @TEMP
WHERE xmltest.exist('/Attributes/Attribute[upper-case(@name)="TEST"]/text()[upper-case(.) = "A1"]') = 1 
```

问题是我的 TEST 属性可以包含逗号分隔的字段，例如 A1,3,A12，我需要对这些字段进行标记并查找特定值（包含在此处不起作用）。我知道 SQL Server 2008 不支持`tokenize()`，但有没有其他方法可以做到这一点？

# c# - 通用静态缓存和协方差

> ID：10591593
> 
> 赞同：0
> 
> 时间：2012-05-14T21:53:54.657
> 
> 标签：c#, generics, caching, reflection, covariance

我试图构建一个静态通用缓存，它将保存应用（事件 e）形式的几种方法的方法信息。RedirectToWhen 中使用了类似的代码，来自 CQRS Lokad 框架。

问题是通用缓存不考虑派生类（如果有的话）。这是一个显示不良行为的简单测试：

```
 [TestMethod]
    public void TestGenericsInheritance()
    {
        var sut = new DerivedFromAbstractType();
        Utils.UsefulMethod<DerivedFromAbstractType>(sut);
        Assert.AreEqual(10, sut.Value);
    }

    public abstract class AbstractType
{
    public int Value { get; set; }
}

public class DerivedFromAbstractType : AbstractType
{
    public void AnyOtherMethod()
    {
        Value = 10;
    }
}

public static class Utils
{
    public static void UsefulMethod<T>(T instance)
    {
        MethodInfo info = typeof(T)
            .GetMethods(BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance)
            .Where(m => m.Name == "AnyOtherMethod")
            .Where(m => m.GetParameters().Length == 0).FirstOrDefault();
        info.Invoke(instance,null);
     }
} 
```

typeof(T) 返回 AbstractType，所以我不能用它来构建一个通用的静态缓存。我怎样才能为知道派生类型的方法获得通用缓存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-13T13:15:52.610

利用

```
instance.GetType() 
```

如果实例不为空且 typeof(T) os 实例为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-10T19:08:08.413

我知道这有点坏死，但我遇到了同样的问题，typeof(T) 返回基本类型。这在想要创建实现 Emit/Apply 模式的 BaseAggregate 时很有用。我这样解决了：

```
 private static class Cache
        {
            private static readonly IDictionary<Type, IDictionary<Type, MethodInfo>> _dict =
                new Dictionary<Type, IDictionary<Type, MethodInfo>>();

            public static IDictionary<Type, MethodInfo> GetDictionaryForType(Type type)
            {
                if (_dict.ContainsKey(type))
                {
                    return _dict[type];
                }
                var dict = type.GetMethods(BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance)
                    .Where(m => m.Name == "When")
                    .Where(m => m.GetParameters().Length == 1)
                    .ToDictionary(m => m.GetParameters().First().ParameterType, m => m);
                _dict.Add(type, dict);
                return dict;
            }
        } 
```

这仍然很好地缓存，并`object.GetType()`返回要输入此方法的正确类型。

# sql-server-2005 - 根据名称选择广告商，但也包括其父广告商名称

> ID：10591595
> 
> 赞同：1
> 
> 时间：2012-05-14T21:54:24.350
> 
> 标签：sql-server-2005

我有三张桌子：

Advertisers：产生广告的企业列表，Adverts：广告本身和 AdvertiserChild：Advertiser 父母表；请注意，这是一个扁平的层次结构，单个广告商可以与父级一起多次列出，只要它们只是“父级”，就没有关于“级别”的暗示。

因此，我试图选择在其名称与用户输入匹配的特定日期之间投放广告的所有广告商。问题是该名称还可以匹配父广告商。让我尝试换一种说法，只要孩子在指定日期之间有一些有效的广告，用户输入就可以匹配父广告商或子广告商的名称。

我只是在概念上在获取父信息方面遇到了麻烦：

```
SELECT     NewsPaperAd.AdvertiserID AS ADID, Advertiser.NameAbbrev AS Name
FROM         NewsPaperAd INNER JOIN
                  Advertiser ON NewsPaperAd.AdvertiserID = Advertiser.AdvertiserID
WHERE     (NewsPaperAd.PubDate BETWEEN '1/1/2012' AND '4/1/2012') 
```

好的，我想我有它！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T23:24:34.853

我假设层次结构是使用 Advertiser 表中的 ParentID 或类似列定义的。然后这样的事情可能会起作用：

```
DECLARE @search NVARCHAR(255);
SET @search = '%some search phrase%';

;WITH a AS
(
  SELECT a.AdvertiserID, a.NameAbbrev, Parent = p.NameAbbrev
    FROM dbo.Advertiser AS a
    LEFT OUTER JOIN dbo.Advertiser AS p
    ON a.ParentID = p.AdvertiserID
    WHERE a.NameAbbrev LIKE @search
    OR p.NameAbbrev LIKE @search
)
SELECT ADID = a.AdvertiserID, a.NameAbbrev, a.Parent
  FROM dbo.NewsPaperAd AS n
  INNER JOIN a
  ON a.AdvertiserID = a.AdvertiserID
  WHERE n.PubDate >= '20120101'
  AND n.PubDate < '20120401'; 
```

一些建议：（1）不要更改列输出名称。ADID 对我说的和 AdvertiserID 不同；缩写的意义何在？(2) 不要将 BETWEEN 用于日期/时间范围查询...虽然如果您的数据类型是 DATE 则可以，但由于您使用的是 SQL Server 2005，因此在您的场景中情况并非如此。 (3)不要对字符串文字使用区域格式，例如 m/d/y。事实上，我仍然不确定您的查询应该在 4 月 1 日还是 1 月 4 日结束。根据语言和区域设置，SQL Server 也可能会出错。

# php - 将 FOSRestBundle 与表单一起使用

> ID：10591596
> 
> 赞同：8
> 
> 时间：2012-05-14T21:54:27.120
> 
> 标签：php, symfony, fosuserbundle

Noob，与 FOSRestBundle、JMSSerializerBundle 和模板有关的问题。

我正在尝试替换一些当前通过 twig 输出 json 的现有代码以使用 FOSRestBundle。这在从控制器传递的内容最初是在数组中的情况下是成功的，但是现在我试图将一个表单传递给 FOSRestBundle，结果是我的值永远不会被返回。

下面的代码复制了场景

```
/**
 *  my sample get action
 * @View(templateVar="form")   
 */
public function getAction($id)
{
    ...         
     $form = $this->createFormBuilder(array('myValue' => 'SOMEVALUE'))
        ->add('myValue', 'hidden')
        ->getForm();

    $view = FOSView::create($form);
    $view->setFormat('json');

    return $this->get('fos_rest.view_handler')->handle($view);
} 
```

返回

```
{"children":{"_token":[],"myValue":[]}} 
```

我期望在这里看到的是：

```
{"children":{"_token": "mylongtoken","myValue": "SOMEVALUE"}} 
```

我的代码一直基于 LiipHelloBundle 中的示例，除非我弄错了这与他们提供的示例相匹配？有什么想法我哪里出错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T00:02:22.867

好的，这不是我在 Symfony 中期望的最干净的解决方案，但它似乎是这样工作的：

```
$form->createView()->get('form')->get('form')->getChild('myValue')->get('choices') 
```

返回我的 myValue 实体：

> {"28":"Default1","103":"test"}

# ruby-on-rails - rake db:migration 不适用于 travis-ci 构建

> ID：10591599
> 
> 赞同：14
> 
> 时间：2012-05-14T21:54:42.463
> 
> 标签：ruby-on-rails, ruby, github, rake, travis-ci

我正在尝试从 Travis-CI 上的 github 构建我的 Ruby on Rails 项目，但我遇到了迁移问题。它为迁移运行 rake 任务，但之后它抱怨相同的迁移步骤。

它遵循我的 .travis.yml 文件：

```
language: ruby
rvm:
  - 1.9.2
before_script:
  - "rake db:migrate RAILS_ENV=test" 
```

这是构建输出：

```
1Using worker: ruby4.worker.travis-ci.org:travis-ruby-3
2
3
4
5$ cd ~/builds
6
7
8$ git clone --depth=100 --quiet git://github.com/rafaelportela/bacilo.git rafaelportela/bacilo
9
10
11
12$ cd rafaelportela/bacilo
13
14$ git checkout -qf 7553b7351b7a642e39ea7b55204de6cd4f320c36
15
16
17$ export TRAVIS_RUBY_VERSION=1.9.2
18
19$ rvm use 1.9.2
20Using /home/vagrant/.rvm/gems/ruby-1.9.2-p290
21
22$ ruby --version
23ruby 1.9.2p290 (2011-07-09 revision 32553) [i686-linux]
24
25$ gem --version
261.8.17
27
28
29$ export BUNDLE_GEMFILE=/home/vagrant/builds/rafaelportela/bacilo/Gemfile
30
31$ bundle install
32Fetching gem metadata from https://rubygems.org/.......
33Using rake (0.9.2.2) 
34Installing i18n (0.6.0) 
35Installing multi_json (1.3.4) 
36Installing activesupport (3.2.2) 
37Installing builder (3.0.0) 
38Installing activemodel (3.2.2) 
39Installing erubis (2.7.0) 
40Installing journey (1.0.3) 
41Installing rack (1.4.1) 
42Installing rack-cache (1.2) 
43Installing rack-test (0.6.1) 
44Installing hike (1.2.1) 
45Installing tilt (1.3.3) 
46Installing sprockets (2.1.3) 
47Installing actionpack (3.2.2) 
48Installing mime-types (1.18) 
49Installing polyglot (0.3.3) 
50Installing treetop (1.4.10) 
51Installing mail (2.4.4) 
52Installing actionmailer (3.2.2) 
53Installing arel (3.0.2) 
54Installing tzinfo (0.3.33) 
55Installing activerecord (3.2.2) 
56Installing activeresource (3.2.2) 
57Installing bcrypt-ruby (3.0.1) with native extensions 
58Installing coffee-script-source (1.3.1) 
59Installing execjs (1.3.1) 
60Installing coffee-script (2.2.0) 
61Installing rack-ssl (1.3.2) 
62Installing json (1.7.0) with native extensions 
63Installing rdoc (3.12) 
64Installing thor (0.14.6) 
65Installing railties (3.2.2) 
66Installing coffee-rails (3.2.2) 
67Installing orm_adapter (0.0.7) 
68Installing warden (1.1.1) 
69Installing devise (2.0.4) 
70Installing jquery-rails (2.0.2) 
71Installing pg (0.13.2) with native extensions 
72Using bundler (1.1.3) 
73Installing rails (3.2.2) 
74Installing sass (3.1.16) 
75Installing sass-rails (3.2.5) 
76Installing sqlite3 (1.3.6) with native extensions 
77Installing uglifier (1.2.4) 
78Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed.
79Post-install message from rdoc:
80Depending on your version of ruby, you may need to install ruby rdoc/ri data:
81
82<= 1.8.6 : unsupported
83 = 1.8.7 : gem install rdoc-data; rdoc-data --install
84 = 1.9.1 : gem install rdoc-data; rdoc-data --install
85>= 1.9.2 : nothing to do! Yay!
86
87
88$ rake db:migrate RAILS_ENV=test
89==  DeviseCreateUsers: migrating ==============================================
90-- create_table(:users)
91   -> 0.0174s
92-- add_index(:users, :email, {:unique=>true})
93   -> 0.0017s
94-- add_index(:users, :reset_password_token, {:unique=>true})
95   -> 0.0010s
96==  DeviseCreateUsers: migrated (0.0239s) =====================================
97
98
99$ bundle exec rake
100You have 1 pending migrations:
101  20120508052346 DeviseCreateUsers
102Run `rake db:migrate` to update your database then try again.
103
104
105Done. Build script exited with: 1 
```

我会很感激任何建议！=]

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-19T17:15:18.950

当我试图让我的 Rails 3.2 应用程序与 Travis CI 一起工作并编写一个`.travis.yml`实际工作的文件时，[这篇博文给了我极大的帮助。](http://matthew.mceachen.us/blog/howto-test-your-rails-application-with-travis-ci-on-different-database-engines-1220.html)这是我的供您参考，希望对您有所帮助：

**.travis.yml**

```
language: ruby
rvm:
  - 1.9.2
  - 1.9.3
env:
  - DB=sqlite
  - DB=mysql
  - DB=postgresql
script: 
  - RAILS_ENV=test bundle exec rake db:migrate --trace
  - bundle exec rake db:test:prepare
  - bundle exec rspec spec/
before_script:
  - mysql -e 'create database my_app_test'
  - psql -c 'create database my_app_test' -U postgres
bundler_args: --binstubs=./bundler_stubs 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-14T22:55:40.353

而不是运行`rake db:migrate RAILS_ENV=test`运行`rake db:test:prepare`。

这是因为`rake db:migrate`将对您的测试数据库运行*所有*迁移，如果您有很多迁移，这可能需要很长时间。该`db:test:prepare`任务不会那样做，它只会使用来自`db/schema.rb`.

试一试，看看是否有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-21T04:06:51.203

The solution that fixed the problem for me was running: `rake db:schema:load` instead of `rake db:migrate RAILS_ENV=test`

# c# - 通过 OleDb 使用 Microsoft Access 数据库引擎将 DataTable 插入 Excel

> ID：10591600
> 
> 赞同：3
> 
> 时间：2012-05-14T21:54:48.433
> 
> 标签：c#, excel, oledb

我今天遇到了使用`OleDbConnection`以下网站从 Microsoft Excel 文件中读取数据的说明：[OLE DB Providers](http://www.carlprothman.net/Default.aspx?tabid=87#OLEDBProviderForMicrosoftJetExcel)

这使我可以读取 Excel 文件中的所有数据：

```
private const string EXCEL_CON =
  @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source={0};" +
  @"Extended Properties='Excel 8.0;HDR=Yes;IMEX=1;'";

    public DataTable ExtractExcel(string fullFilename, string tableName)
    {
        var table = new DataTable();
        string strCon = string.Format(EXCEL_CON, fullFilename);
        using (var xlConn = new System.Data.OleDb.OleDbConnection(strCon))
        {
            ConnectionState initialState = xlConn.State;
            try
            {
                if ((initialState & ConnectionState.Open) != ConnectionState.Open)
                {
                    xlConn.Open();
                }
                string sql = string.Format("SELECT * FROM `{0}`;", tableName);
                using (var cmd = new System.Data.OleDb.OleDbCommand(sql, xlConn))
                {
                    table.Load(cmd.ExecuteReader());
                }
            }
            finally
            { // it seems like Access does not always close the connection
                if ((initialState & ConnectionState.Open) != ConnectionState.Open)
                {
                    xlConn.Close();
                }
            }
        }
        return table;
    } 
```

当我插入数据时，第 1 步是在添加、更改或删除列的情况下清除 Microsoft Access 数据库中的现有表：

```
public void InsertExcel(OleDbConnection dbConn, DataTable table) {
  ConnectionState initState = dbConn.State;
  try {
    if ((initState & ConnectionState.Open) != ConnectionState.Open) {
      dbConn.Open();
    }
    string sql = string.Format("SELECT * FROM {0};", table.TableName);
    DataTable original = new DataTable();
    using (OleDbCommand cmd = new OleDbCommand(sql, dbConn)) {
      try {
        original.Load(cmd.ExecuteReader());
      } catch (Exception) { // table does not exist
      }
    }
    if (0 < original.Rows.Count) {
      sql = string.Format("DROP TABLE {0};", table.TableName);
      using (OleDbCommand cmd = new OleDbCommand(sql, dbConn)) {
        cmd.ExecuteNonQuery();
      }
    }
    // ****************
    // CODE NEEDED HERE
    // ****************
  } finally {
    if ((initState & ConnectionState.Open) != ConnectionState.Open) {
      dbConn.Close();
    }
  }
} 
```

`DROP TABLE`执行命令后（在该`CODE NEEDED HERE`部分中），我需要以某种方式将信息插入**DataTable**。

如果我没有任何类型的主键、列名或列数据类型，我将如何插入表？

[OleDbParameter](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbparameter)具有[AddWithValue](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbparametercollection.addwithvalue.aspx)方法，该方法允许添加数据而无需知道数据类型。**有没有类似的东西可以用来转储整个`DataTable`（或`DataSet`）？**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-14T22:50:45.673

这是`static class`我通过合并我找到或开发的各种代码而构建的。您需要注意的主要方法是`ExportToExcelOleDb`，在给定 a`DataSet`和连接字符串的情况下，会将其写入`DataSet`您选择的 Excel 文件，并按原样格式化`DataSet`。

请注意，Access Engine 写入 Excel 的方式存在“错误” - 在写入 Excel 工作簿时无法保留数据类型，这意味着所有数据类型都以 Excel `TEXT`/形式写入`STRING`。反正这里是...

```
 // Structures used for conversion between data-types.
    private struct ExcelDataTypes
    {
        public const string NUMBER = "NUMBER";
        public const string DATETIME = "DATETIME";
        public const string TEXT = "TEXT"; // also works with "STRING".
    }

    private struct NETDataTypes
    {
        public const string SHORT = "int16";
        public const string INT = "int32";
        public const string LONG = "int64";
        public const string STRING = "string";
        public const string DATE = "DateTime";
        public const string BOOL = "Boolean";
        public const string DECIMAL = "decimal";
        public const string DOUBLE = "double";
        public const string FLOAT = "float";
    }

    /// <summary>
    /// Routine to export a given DataSet to Excel. For each DataTable contained 
    /// in the DataSet the overloaded routine will create a new Excel sheet based 
    /// upon the currently selected DataTable. The proceedure loops through all 
    /// DataRows in the selected DataTable and pushes each one to the specified 
    /// Excel file using ADO.NET and the Access Database Engine (Excel is not a 
    /// prerequisit).
    /// </summary>
    /// <param name="dataSet">The DataSet to be written to Excel.</param>
    /// <param name="connectionString">The connection string.</param>
    /// <param name="fileName">The Excel file name to export to.</param>
    /// <param name="deleteExistFile">Delete existing file?</param>
    public static void ExportToExcelOleDb(DataSet dataSet, string connectionString, 
                                                      string fileName, bool deleteExistFile)
    {
        // Support for existing file overwrite.
        if (deleteExistFile && File.Exists(fileName))
            File.Delete(fileName);
        ExportToExcelOleDb(dataSet, connectionString, fileName);
    }

    /// <summary>
    /// Overloaded version of the above.
    /// </summary>
    /// <param name="dataSet">The DataSet to be written to Excel.</param>
    /// <param name="connectionString">The SqlConnection string.</param>
    /// <param name="fileName">The Excel file name to export to.</param>
    public static bool ExportToExcelOleDb(DataSet dataSet, string connectionString, string fileName)
    {
        try
        {
            // Check for null set.
            if (dataSet != null && dataSet.Tables.Count > 0)
            {
                using (OleDbConnection connection = new OleDbConnection(String.Format(connectionString, fileName)))
                {
                    // Initialise SqlCommand and open.
                    OleDbCommand command = null;
                    connection.Open();

                    // Loop through DataTables.
                    foreach (DataTable dt in dataSet.Tables)
                    {
                        // Build the Excel create table command.
                        string strCreateTableStruct = BuildCreateTableCommand(dt);
                        if (String.IsNullOrEmpty(strCreateTableStruct))
                            return false;
                        command = new OleDbCommand(strCreateTableStruct, connection);
                        command.ExecuteNonQuery();

                        // Puch each row into Excel.
                        for (int rowIndex = 0; rowIndex < dt.Rows.Count; rowIndex++)
                        {
                            command = new OleDbCommand(BuildInsertCommand(dt, rowIndex), connection);
                            command.ExecuteNonQuery();
                        }
                    }
                }
            }
            return true;
        }
        catch (Exception eX)
        {
            Utils.ErrMsg(eX.Message);
            return false;
        }
    }

    /// <summary>
    /// Build the various sheet names to be inserted based upon the 
    /// number of DataTable provided in the DataSet. This is not required
    /// for XCost purposes. Coded for completion.
    /// </summary>
    /// <param name="connectionString">The connection string.</param>
    /// <returns>String array of sheet names.</returns>
    private static string[] BuildExcelSheetNames(string connectionString)
    {
        // Variables.
        DataTable dt = null;
        string[] excelSheets = null;

        using (OleDbConnection schemaConn = new OleDbConnection(connectionString))
        {
            schemaConn.Open();
            dt = schemaConn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);

            // No schema found.
            if (dt == null)
                return null;

            // Insert 'TABLE_NAME' to sheet name array.
            int i = 0;
            excelSheets = new string[dt.Rows.Count];
            foreach (DataRow row in dt.Rows)
                excelSheets[i++] = row["TABLE_NAME"].ToString();
        }
        return excelSheets;     
    }

    /// <summary>
    /// Routine to build the CREATE TABLE command. The conversion of 
    /// .NET to Excel data types is also handled here (supposedly!). 
    /// Help: http://support.microsoft.com/kb/316934/en-us.
    /// </summary>
    /// <param name="dataTable"></param>
    /// <returns>The CREATE TABLE command string.</returns>
    private static string BuildCreateTableCommand(DataTable dataTable)
    {
        // Get the type look-up tables.
        StringBuilder sb = new StringBuilder();
        Dictionary<string, string> dataTypeList = BuildExcelDataTypes();

        // Check for null data set.
        if (dataTable.Columns.Count <= 0)
            return null;

        // Start the command build.
        sb.AppendFormat("CREATE TABLE [{0}] (", BuildExcelSheetName(dataTable));

        // Build column names and types.
        foreach (DataColumn col in dataTable.Columns)
        {
            string type = ExcelDataTypes.TEXT;
            if (dataTypeList.ContainsKey(col.DataType.Name.ToString().ToLower()))
            {
                type = dataTypeList[col.DataType.Name.ToString().ToLower()];
            }
            sb.AppendFormat("[{0}] {1},", col.Caption.Replace(' ', '_'), type);
        }
        sb = sb.Replace(',', ')', sb.ToString().LastIndexOf(','), 1);
        return sb.ToString();   
    }

    /// <summary>
    /// Routine to construct the INSERT INTO command. This does not currently 
    /// work with the data type miss matches.
    /// </summary>
    /// <param name="dataTable"></param>
    /// <param name="rowIndex"></param>
    /// <returns></returns>
    private static string BuildInsertCommand(DataTable dataTable, int rowIndex)
    {
        StringBuilder sb = new StringBuilder();

        // Remove whitespace.
        sb.AppendFormat("INSERT INTO [{0}$](", BuildExcelSheetName(dataTable));
        foreach (DataColumn col in dataTable.Columns)
            sb.AppendFormat("[{0}],", col.Caption.Replace(' ', '_'));
        sb = sb.Replace(',', ')', sb.ToString().LastIndexOf(','), 1);

        // Write values.
        sb.Append("VALUES (");
        foreach (DataColumn col in dataTable.Columns)
        {
            string type = col.DataType.ToString();
            string strToInsert = String.Empty;
            strToInsert = dataTable.Rows[rowIndex][col].ToString().Replace("'", "''");
            sb.AppendFormat("'{0}',", strToInsert);
            //strToInsert = String.IsNullOrEmpty(strToInsert) ? "NULL" : strToInsert;
            //String.IsNullOrEmpty(strToInsert) ? "NULL" : strToInsert);
        }
        sb = sb.Replace(',', ')', sb.ToString().LastIndexOf(','), 1);
        return sb.ToString();
    }

    /// <summary>
    /// Build the Excel sheet name.
    /// </summary>
    /// <param name="dataTable"></param>
    /// <returns></returns>
    private static string BuildExcelSheetName(DataTable dataTable)
    {
        string retVal = dataTable.TableName;
        if (dataTable.ExtendedProperties.ContainsKey(TABLE_NAME_PROPERTY))
            retVal = dataTable.ExtendedProperties[TABLE_NAME_PROPERTY].ToString();
        return retVal.Replace(' ', '_');
    }

            /// <summary>
    /// Dictionary for conversion between .NET data types and Excel 
    /// data types. The conversion does not currently work, so I am 
    /// pushing all data upto excel as Excel "TEXT" type.
    /// </summary>
    /// <returns></returns>
    private static Dictionary<string, string> BuildExcelDataTypes()
    {
        Dictionary<string, string> dataTypeLookUp = new Dictionary<string, string>();

        // I cannot get the Excel formatting correct here!?
        dataTypeLookUp.Add(NETDataTypes.SHORT, ExcelDataTypes.NUMBER);
        dataTypeLookUp.Add(NETDataTypes.INT, ExcelDataTypes.NUMBER);
        dataTypeLookUp.Add(NETDataTypes.LONG, ExcelDataTypes.NUMBER);
        dataTypeLookUp.Add(NETDataTypes.STRING, ExcelDataTypes.TEXT);
        dataTypeLookUp.Add(NETDataTypes.DATE, ExcelDataTypes.DATETIME);
        dataTypeLookUp.Add(NETDataTypes.BOOL, ExcelDataTypes.TEXT);
        dataTypeLookUp.Add(NETDataTypes.DECIMAL, ExcelDataTypes.NUMBER);
        dataTypeLookUp.Add(NETDataTypes.DOUBLE, ExcelDataTypes.NUMBER);
        dataTypeLookUp.Add(NETDataTypes.FLOAT, ExcelDataTypes.NUMBER);
        return dataTypeLookUp;
    } 
```

我希望这对你有一些用处。

*笔记。我知道这种类型的答案是不受欢迎的，但是我花了一些时间来开发它，最后没有用它——而是转向 COM/interop。不分享太可惜了！*

# javascript - 为什么我必须在 onDeviceReady 中请求文件系统？

> ID：10591604
> 
> 赞同：0
> 
> 时间：2012-05-14T21:55:30.520
> 
> 标签：javascript, android, file, cordova

我正在使用 PhoneGap 的文件 API（W3C 文件）。所有文件读取示例都强制您在 onDeviceReady 中调用 window.requestFileSystem(...)...为什么？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T13:00:22.707

因为您需要确保 Cordova/Phonegap 已准备就绪。

来自 Cordova 1.6.1 的源代码，第 431 行：

*   onDeviceReady 触发用户事件以指示 Cordova 已准备就绪

在触发此事件之前，您无法确定 Phonegap 是否已为您准备好。requestFileSystem 定义在：lib/common/plugin/requestFileSystem.js

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T07:23:06.287

因为onDeviceReady中肯定存在window.requestFileSystem

# android - 应用程序适合多种屏幕尺寸。但我知道的一个

> ID：10591606
> 
> 赞同：0
> 
> 时间：2012-05-14T21:55:44.077
> 
> 标签：android

我将我的应用程序发布到了 Play 商店。适合 SGSII Epic 4.5"、LG Optimus V 3.2"、LG Optimus Black 4.0"、Evo shift 3.6" mytouch 4g 3.8"，但不适合 droid bionic 4.3"。有谁知道为什么不适合屏幕？屏幕尺寸为 4.3 英寸，但该应用程序仅在 4.3 英寸屏幕上占用 3.6 英寸屏幕的空间。此外，三星在向一侧倾斜时会注入 4g，它会尝试进入横向模式，我将其设置为 android:screenOrientation清单中的 =“肖像”

这是我的主要 xml

```
android:layout_width="320dp"

android:layout_height="485dp"

android:orientation="vertical"

android:padding="15dp"

android:background="@drawable/graybkg"

 >

<Button
    android:id="@+id/national"

    android:layout_width="300dp"

    android:layout_height="120dp"

    android:layout_gravity="center"

    android:background="@drawable/custtomnatbut"

     />

<Button
    android:id="@+id/yorgeys"

    android:layout_width="300dp"

    android:layout_height="120dp"

    android:layout_gravity="center"

    android:background="@drawable/custtomyorgeys"

    /> 
```

```
 android:layout_width="300dp"

    android:layout_height="60dp"

    android:layout_gravity="center"

    android:background="@drawable/custtomfoursq"

    />

<LinearLayout 
    android:layout_width="300dp"

    android:layout_height="60dp"

    android:layout_gravity="center"
    >

<Button
    android:id="@+id/facebook"

    android:layout_width="150dp"

    android:layout_height="60dp"

    android:background="@drawable/custtomface"

    />

<Button

    android:id="@+id/website"

    android:layout_width="150dp"

    android:layout_height="60dp"

    android:background="@drawable/custtom_web"

     />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T22:07:25.657

您真的不应该将屏幕视为物理屏幕尺寸。对于布局而言，重要的是屏幕上 dp 单位的数量。

我相信 Droid Bionic 是在 hdpi 上运行的 qHD (960x540) 屏幕。就 dp 单位而言，这是 640x360dp。将此与 533x320dp 的典型 HVGA (800x480) hdpi 进行比较。

您显示的布局似乎是用插入所有内容的绝对大小编写的。如果这就是你正在做的事情，那么你注定要失败。你不能像有一个真正的屏幕尺寸来统治他们一样写作。您编写*布局*的原因是为了描述您的 UI，以便平台可以移动其元素以适应屏幕。试图强迫它成为一个固定的定位系统将导致你与系统发生冲突，并最终被埋没在试图支持另一个又一个屏幕尺寸变化的过程中。

考虑到 Galaxy Nexus 和其他新推出的手机都是 1280x800 xhdpi 屏幕，这为您提供了另一种尺寸——640x400dp。

# java - db4o 客户端/服务器同步中的复制错误

> ID：10591613
> 
> 赞同：0
> 
> 时间：2012-05-14T21:56:52.093
> 
> 标签：java, exception, replication, sync, db4o

我在 7.12 和 8.0 中出现了一个奇怪的错误。我正在尝试双向复制一个对象。它们都是 db4o 数据库，客户端通过嵌入式连接到本地数据库，并连接到 db4o 服务器以开始复制。

系统是 Mac OS X 10.7.3，Java 版本：

```
java version "1.6.0_31"
Java(TM) SE Runtime Environment (build 1.6.0_31-b04-415-11M3635)
Java HotSpot(TM) 64-Bit Server VM (build 20.6-b01-415, mixed mode) 
```

服务器上的错误是：

```
objc[7665]: Object 0x7ff03c0020e0 of class __NSArrayM autoreleased with no pool in place
- just leaking - break on objc_autoreleaseNoPool() to debug 
```

客户端的错误是：

```
java.lang.NullPointerException
at com.db4o.internal.handlers.array.MultidimensionalArrayIterator.moveNext(MultidimensionalArrayIterator.java:47)
at com.db4o.internal.handlers.array.MultidimensionalArrayHandler.writeElements(MultidimensionalArrayHandler.java:99)
at com.db4o.internal.handlers.array.ArrayHandler.write(ArrayHandler.java:407)
at com.db4o.internal.marshall.MarshallingContext.writeObjectWithCurrentState(MarshallingContext.java:272)
at com.db4o.internal.FieldMetadata.marshall(FieldMetadata.java:775)
at com.db4o.internal.handlers.StandardReferenceTypeHandler$4.processAspect(StandardReferenceTypeHandler.java:155)
at com.db4o.internal.metadata.MarshallingInfoTraverseAspectCommand.processAspect(MarshallingInfoTraverseAspectCommand.java:52)
at com.db4o.internal.metadata.StandardAspectTraversalStrategy.traverseAllAspects(StandardAspectTraversalStrategy.java:24)
at com.db4o.internal.ClassMetadata.traverseAllAspects(ClassMetadata.java:2089)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.traverseAllAspects(StandardReferenceTypeHandler.java:258)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.marshallAspects(StandardReferenceTypeHandler.java:163)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.write(StandardReferenceTypeHandler.java:123)
at com.db4o.internal.Handlers4.write(Handlers4.java:309)
at com.db4o.internal.ObjectReference.continueSet(ObjectReference.java:171)
at com.db4o.internal.ObjectContainerBase.stillToSet(ObjectContainerBase.java:1900)
at com.db4o.internal.ObjectContainerBase.store3(ObjectContainerBase.java:1721)
at com.db4o.internal.ObjectContainerBase.store2(ObjectContainerBase.java:1650)
at com.db4o.internal.ObjectContainerBase.storeAfterReplication(ObjectContainerBase.java:1632)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1618)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1616)
at com.db4o.internal.ObjectContainerBase.asTopLevelCall(ObjectContainerBase.java:437)
at com.db4o.internal.ObjectContainerBase.asTopLevelStore(ObjectContainerBase.java:423)
at com.db4o.internal.ObjectContainerBase.storeInternal(ObjectContainerBase.java:1616)
at com.db4o.internal.TransportObjectContainer.storeInternal(TransportObjectContainer.java:191)
at com.db4o.internal.marshall.MarshallingContext.writeObject(MarshallingContext.java:252)
at com.db4o.internal.marshall.MarshallingContext.writeObjectWithCurrentState(MarshallingContext.java:266)
at com.db4o.internal.FieldMetadata.marshall(FieldMetadata.java:775)
at com.db4o.internal.handlers.StandardReferenceTypeHandler$4.processAspect(StandardReferenceTypeHandler.java:155)
at com.db4o.internal.metadata.MarshallingInfoTraverseAspectCommand.processAspect(MarshallingInfoTraverseAspectCommand.java:52)
at com.db4o.internal.metadata.StandardAspectTraversalStrategy.traverseAllAspects(StandardAspectTraversalStrategy.java:24)
at com.db4o.internal.ClassMetadata.traverseAllAspects(ClassMetadata.java:2089)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.traverseAllAspects(StandardReferenceTypeHandler.java:258)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.marshallAspects(StandardReferenceTypeHandler.java:163)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.write(StandardReferenceTypeHandler.java:123)
at com.db4o.internal.Handlers4.write(Handlers4.java:309)
at com.db4o.internal.ObjectReference.continueSet(ObjectReference.java:171)
at com.db4o.internal.ObjectContainerBase.stillToSet(ObjectContainerBase.java:1900)
at com.db4o.internal.ObjectContainerBase.store3(ObjectContainerBase.java:1721)
at com.db4o.internal.ObjectContainerBase.store2(ObjectContainerBase.java:1650)
at com.db4o.internal.ObjectContainerBase.storeAfterReplication(ObjectContainerBase.java:1632)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1618)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1616)
at com.db4o.internal.ObjectContainerBase.asTopLevelCall(ObjectContainerBase.java:437)
at com.db4o.internal.ObjectContainerBase.asTopLevelStore(ObjectContainerBase.java:423)
at com.db4o.internal.ObjectContainerBase.storeInternal(ObjectContainerBase.java:1616)
at com.db4o.internal.TransportObjectContainer.storeInternal(TransportObjectContainer.java:191)
at com.db4o.internal.marshall.MarshallingContext.writeObject(MarshallingContext.java:252)
at com.db4o.internal.marshall.MarshallingContext.writeObjectWithCurrentState(MarshallingContext.java:266)
at com.db4o.internal.FieldMetadata.marshall(FieldMetadata.java:775)
at com.db4o.internal.handlers.StandardReferenceTypeHandler$4.processAspect(StandardReferenceTypeHandler.java:155)
at com.db4o.internal.metadata.MarshallingInfoTraverseAspectCommand.processAspect(MarshallingInfoTraverseAspectCommand.java:52)
at com.db4o.internal.metadata.StandardAspectTraversalStrategy.traverseAllAspects(StandardAspectTraversalStrategy.java:24)
at com.db4o.internal.ClassMetadata.traverseAllAspects(ClassMetadata.java:2089)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.traverseAllAspects(StandardReferenceTypeHandler.java:258)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.marshallAspects(StandardReferenceTypeHandler.java:163)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.write(StandardReferenceTypeHandler.java:123)
at com.db4o.internal.Handlers4.write(Handlers4.java:309)
at com.db4o.internal.ObjectReference.continueSet(ObjectReference.java:171)
at com.db4o.internal.ObjectContainerBase.stillToSet(ObjectContainerBase.java:1900)
at com.db4o.internal.ObjectContainerBase.store3(ObjectContainerBase.java:1721)
at com.db4o.internal.ObjectContainerBase.store2(ObjectContainerBase.java:1650)
at com.db4o.internal.ObjectContainerBase.storeAfterReplication(ObjectContainerBase.java:1632)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1618)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1616)
at com.db4o.internal.ObjectContainerBase.asTopLevelCall(ObjectContainerBase.java:437)
at com.db4o.internal.ObjectContainerBase.asTopLevelStore(ObjectContainerBase.java:423)
at com.db4o.internal.ObjectContainerBase.storeInternal(ObjectContainerBase.java:1616)
at com.db4o.internal.TransportObjectContainer.storeInternal(TransportObjectContainer.java:191)
at com.db4o.internal.marshall.MarshallingContext.writeObject(MarshallingContext.java:252)
at com.db4o.internal.marshall.MarshallingContext.writeObjectWithCurrentState(MarshallingContext.java:266)
at com.db4o.internal.marshall.MarshallingContext.writeObject(MarshallingContext.java:260)
at com.db4o.internal.handlers.array.ArrayHandler.writeElements(ArrayHandler.java:422)
at com.db4o.internal.handlers.array.ArrayHandler.write(ArrayHandler.java:407)
at com.db4o.internal.marshall.MarshallingContext.writeObjectWithCurrentState(MarshallingContext.java:272)
at com.db4o.internal.FieldMetadata.marshall(FieldMetadata.java:775)
at com.db4o.internal.handlers.StandardReferenceTypeHandler$4.processAspect(StandardReferenceTypeHandler.java:155)
at com.db4o.internal.metadata.MarshallingInfoTraverseAspectCommand.processAspect(MarshallingInfoTraverseAspectCommand.java:52)
at com.db4o.internal.metadata.StandardAspectTraversalStrategy.traverseAllAspects(StandardAspectTraversalStrategy.java:24)
at com.db4o.internal.ClassMetadata.traverseAllAspects(ClassMetadata.java:2089)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.traverseAllAspects(StandardReferenceTypeHandler.java:258)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.marshallAspects(StandardReferenceTypeHandler.java:163)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.write(StandardReferenceTypeHandler.java:123)
at com.db4o.internal.Handlers4.write(Handlers4.java:309)
at com.db4o.internal.ObjectReference.continueSet(ObjectReference.java:171)
at com.db4o.internal.ObjectContainerBase.stillToSet(ObjectContainerBase.java:1900)
at com.db4o.internal.ObjectContainerBase.store3(ObjectContainerBase.java:1721)
at com.db4o.internal.ObjectContainerBase.store2(ObjectContainerBase.java:1650)
at com.db4o.internal.ObjectContainerBase.storeAfterReplication(ObjectContainerBase.java:1632)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1618)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1616)
at com.db4o.internal.ObjectContainerBase.asTopLevelCall(ObjectContainerBase.java:437)
at com.db4o.internal.ObjectContainerBase.asTopLevelStore(ObjectContainerBase.java:423)
at com.db4o.internal.ObjectContainerBase.storeInternal(ObjectContainerBase.java:1616)
at com.db4o.internal.TransportObjectContainer.storeInternal(TransportObjectContainer.java:191)
at com.db4o.internal.marshall.MarshallingContext.writeObject(MarshallingContext.java:252)
at com.db4o.internal.marshall.MarshallingContext.writeObjectWithCurrentState(MarshallingContext.java:266)
at com.db4o.internal.FieldMetadata.marshall(FieldMetadata.java:775)
at com.db4o.internal.handlers.StandardReferenceTypeHandler$4.processAspect(StandardReferenceTypeHandler.java:155)
at com.db4o.internal.metadata.MarshallingInfoTraverseAspectCommand.processAspect(MarshallingInfoTraverseAspectCommand.java:52)
at com.db4o.internal.metadata.StandardAspectTraversalStrategy.traverseAllAspects(StandardAspectTraversalStrategy.java:24)
at com.db4o.internal.ClassMetadata.traverseAllAspects(ClassMetadata.java:2089)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.traverseAllAspects(StandardReferenceTypeHandler.java:258)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.marshallAspects(StandardReferenceTypeHandler.java:163)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.write(StandardReferenceTypeHandler.java:123)
at com.db4o.internal.Handlers4.write(Handlers4.java:309)
at com.db4o.internal.ObjectReference.continueSet(ObjectReference.java:171)
at com.db4o.internal.ObjectContainerBase.stillToSet(ObjectContainerBase.java:1900)
at com.db4o.internal.ObjectContainerBase.store3(ObjectContainerBase.java:1721)
at com.db4o.internal.ObjectContainerBase.store2(ObjectContainerBase.java:1650)
at com.db4o.internal.ObjectContainerBase.storeAfterReplication(ObjectContainerBase.java:1632)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1618)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1616)
at com.db4o.internal.ObjectContainerBase.asTopLevelCall(ObjectContainerBase.java:437)
at com.db4o.internal.ObjectContainerBase.asTopLevelStore(ObjectContainerBase.java:423)
at com.db4o.internal.ObjectContainerBase.storeInternal(ObjectContainerBase.java:1616)
at com.db4o.internal.TransportObjectContainer.storeInternal(TransportObjectContainer.java:191)
at com.db4o.internal.marshall.MarshallingContext.writeObject(MarshallingContext.java:252)
at com.db4o.internal.marshall.MarshallingContext.writeObjectWithCurrentState(MarshallingContext.java:266)
at com.db4o.internal.FieldMetadata.marshall(FieldMetadata.java:775)
at com.db4o.internal.handlers.StandardReferenceTypeHandler$4.processAspect(StandardReferenceTypeHandler.java:155)
at com.db4o.internal.metadata.MarshallingInfoTraverseAspectCommand.processAspect(MarshallingInfoTraverseAspectCommand.java:52)
at com.db4o.internal.metadata.StandardAspectTraversalStrategy.traverseAllAspects(StandardAspectTraversalStrategy.java:24)
at com.db4o.internal.ClassMetadata.traverseAllAspects(ClassMetadata.java:2089)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.traverseAllAspects(StandardReferenceTypeHandler.java:258)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.marshallAspects(StandardReferenceTypeHandler.java:163)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.write(StandardReferenceTypeHandler.java:123)
at com.db4o.internal.Handlers4.write(Handlers4.java:309)
at com.db4o.internal.ObjectReference.continueSet(ObjectReference.java:171)
at com.db4o.internal.ObjectContainerBase.stillToSet(ObjectContainerBase.java:1900)
at com.db4o.internal.ObjectContainerBase.store3(ObjectContainerBase.java:1721)
at com.db4o.internal.ObjectContainerBase.store2(ObjectContainerBase.java:1650)
at com.db4o.internal.ObjectContainerBase.storeAfterReplication(ObjectContainerBase.java:1632)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1618)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1616)
at com.db4o.internal.ObjectContainerBase.asTopLevelCall(ObjectContainerBase.java:437)
at com.db4o.internal.ObjectContainerBase.asTopLevelStore(ObjectContainerBase.java:423)
at com.db4o.internal.ObjectContainerBase.storeInternal(ObjectContainerBase.java:1616)
at com.db4o.internal.TransportObjectContainer.storeInternal(TransportObjectContainer.java:191)
at com.db4o.internal.marshall.MarshallingContext.writeObject(MarshallingContext.java:252)
at com.db4o.internal.marshall.MarshallingContext.writeObjectWithCurrentState(MarshallingContext.java:266)
at com.db4o.internal.FieldMetadata.marshall(FieldMetadata.java:775)
at com.db4o.internal.handlers.StandardReferenceTypeHandler$4.processAspect(StandardReferenceTypeHandler.java:155)
at com.db4o.internal.metadata.MarshallingInfoTraverseAspectCommand.processAspect(MarshallingInfoTraverseAspectCommand.java:52)
at com.db4o.internal.metadata.StandardAspectTraversalStrategy.traverseAllAspects(StandardAspectTraversalStrategy.java:24)
at com.db4o.internal.ClassMetadata.traverseAllAspects(ClassMetadata.java:2089)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.traverseAllAspects(StandardReferenceTypeHandler.java:258)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.marshallAspects(StandardReferenceTypeHandler.java:163)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.write(StandardReferenceTypeHandler.java:123)
at com.db4o.internal.Handlers4.write(Handlers4.java:309)
at com.db4o.internal.ObjectReference.continueSet(ObjectReference.java:171)
at com.db4o.internal.ObjectContainerBase.stillToSet(ObjectContainerBase.java:1900)
at com.db4o.internal.ObjectContainerBase.store3(ObjectContainerBase.java:1721)
at com.db4o.internal.ObjectContainerBase.store2(ObjectContainerBase.java:1650)
at com.db4o.internal.ObjectContainerBase.storeAfterReplication(ObjectContainerBase.java:1632)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1618)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1616)
at com.db4o.internal.ObjectContainerBase.asTopLevelCall(ObjectContainerBase.java:437)
at com.db4o.internal.ObjectContainerBase.asTopLevelStore(ObjectContainerBase.java:423)
at com.db4o.internal.ObjectContainerBase.storeInternal(ObjectContainerBase.java:1616)
at com.db4o.internal.TransportObjectContainer.storeInternal(TransportObjectContainer.java:191)
at com.db4o.internal.marshall.MarshallingContext.writeObject(MarshallingContext.java:252)
at com.db4o.internal.marshall.MarshallingContext.writeObjectWithCurrentState(MarshallingContext.java:266)
at com.db4o.internal.FieldMetadata.marshall(FieldMetadata.java:775)
at com.db4o.internal.handlers.StandardReferenceTypeHandler$4.processAspect(StandardReferenceTypeHandler.java:155)
at com.db4o.internal.metadata.MarshallingInfoTraverseAspectCommand.processAspect(MarshallingInfoTraverseAspectCommand.java:52)
at com.db4o.internal.metadata.StandardAspectTraversalStrategy.traverseAllAspects(StandardAspectTraversalStrategy.java:24)
at com.db4o.internal.ClassMetadata.traverseAllAspects(ClassMetadata.java:2089)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.traverseAllAspects(StandardReferenceTypeHandler.java:258)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.marshallAspects(StandardReferenceTypeHandler.java:163)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.write(StandardReferenceTypeHandler.java:123)
at com.db4o.internal.Handlers4.write(Handlers4.java:309)
at com.db4o.internal.ObjectReference.continueSet(ObjectReference.java:171)
at com.db4o.internal.ObjectContainerBase.stillToSet(ObjectContainerBase.java:1900)
at com.db4o.internal.ObjectContainerBase.store3(ObjectContainerBase.java:1721)
at com.db4o.internal.ObjectContainerBase.store2(ObjectContainerBase.java:1650)
at com.db4o.internal.ObjectContainerBase.storeAfterReplication(ObjectContainerBase.java:1632)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1618)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1616)
at com.db4o.internal.ObjectContainerBase.asTopLevelCall(ObjectContainerBase.java:437)
at com.db4o.internal.ObjectContainerBase.asTopLevelStore(ObjectContainerBase.java:423)
at com.db4o.internal.ObjectContainerBase.storeInternal(ObjectContainerBase.java:1616)
at com.db4o.internal.TransportObjectContainer.storeInternal(TransportObjectContainer.java:191)
at com.db4o.internal.marshall.MarshallingContext.writeObject(MarshallingContext.java:252)
at com.db4o.internal.marshall.MarshallingContext.writeObjectWithCurrentState(MarshallingContext.java:266)
at com.db4o.internal.FieldMetadata.marshall(FieldMetadata.java:775)
at com.db4o.internal.handlers.StandardReferenceTypeHandler$4.processAspect(StandardReferenceTypeHandler.java:155)
at com.db4o.internal.metadata.MarshallingInfoTraverseAspectCommand.processAspect(MarshallingInfoTraverseAspectCommand.java:52)
at com.db4o.internal.metadata.StandardAspectTraversalStrategy.traverseAllAspects(StandardAspectTraversalStrategy.java:24)
at com.db4o.internal.ClassMetadata.traverseAllAspects(ClassMetadata.java:2089)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.traverseAllAspects(StandardReferenceTypeHandler.java:258)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.marshallAspects(StandardReferenceTypeHandler.java:163)
at com.db4o.internal.handlers.StandardReferenceTypeHandler.write(StandardReferenceTypeHandler.java:123)
at com.db4o.internal.Handlers4.write(Handlers4.java:309)
at com.db4o.internal.ObjectReference.continueSet(ObjectReference.java:171)
at com.db4o.internal.ObjectContainerBase.stillToSet(ObjectContainerBase.java:1900)
at com.db4o.internal.ObjectContainerBase.store3(ObjectContainerBase.java:1721)
at com.db4o.internal.ObjectContainerBase.store2(ObjectContainerBase.java:1650)
at com.db4o.internal.ObjectContainerBase.storeAfterReplication(ObjectContainerBase.java:1632)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1618)
at com.db4o.internal.ObjectContainerBase$10.apply(ObjectContainerBase.java:1616)
at com.db4o.internal.ObjectContainerBase.asTopLevelCall(ObjectContainerBase.java:437)
at com.db4o.internal.ObjectContainerBase.asTopLevelStore(ObjectContainerBase.java:423)
at com.db4o.internal.ObjectContainerBase.storeInternal(ObjectContainerBase.java:1616)
at com.db4o.internal.TransportObjectContainer.storeInternal(TransportObjectContainer.java:191)
at com.db4o.internal.ObjectContainerBase.store(ObjectContainerBase.java:1598)
at com.db4o.internal.ExternalObjectContainer.store(ExternalObjectContainer.java:154)
at com.db4o.internal.ExternalObjectContainer.store(ExternalObjectContainer.java:141)
at com.db4o.internal.Serializer.marshall(Serializer.java:26)
at com.db4o.internal.query.processor.QConEvaluation.marshallUsingDb4oFormat(QConEvaluation.java:56)
at com.db4o.internal.query.processor.QConEvaluation.marshall(QConEvaluation.java:45)
at com.db4o.internal.query.processor.QCon.marshall(QCon.java:531)
at com.db4o.internal.query.processor.QConObject.marshall(QConObject.java:262)
at com.db4o.internal.query.processor.QConClass.marshall(QConClass.java:108)
at com.db4o.internal.query.processor.QQueryBase.marshall(QQueryBase.java:766)
at com.db4o.cs.internal.ClientObjectContainer.executeQuery(ClientObjectContainer.java:972)
at com.db4o.internal.query.processor.QQueryBase.executeQuery(QQueryBase.java:476)
at com.db4o.internal.query.processor.QQueryBase.getQueryResult(QQueryBase.java:471)
at com.db4o.internal.query.processor.QQueryBase$3.run(QQueryBase.java:340)
at com.db4o.internal.query.processor.QQueryBase$3.run(QQueryBase.java:339)
at com.db4o.internal.query.processor.QQueryBase.triggeringQueryEvents(QQueryBase.java:574)
at com.db4o.internal.query.processor.QQueryBase.execute(QQueryBase.java:339)
at com.db4o.internal.query.NativeQueryHandler.execute(NativeQueryHandler.java:44)
at com.db4o.internal.ObjectContainerBase.query(ObjectContainerBase.java:1375)
at com.db4o.internal.ExternalObjectContainer.query(ExternalObjectContainer.java:120)
at com.db4o.internal.ExternalObjectContainer.query(ExternalObjectContainer.java:116)
at au.com.kingdomsolutions.tt.Views.MainWindow$6.widgetSelected(MainWindow.java:247)
at org.eclipse.swt.widgets.TypedListener.handleEvent(Unknown Source)
at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Display.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Widget.notifyListeners(Unknown Source)
at org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source)
at org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)
at au.com.kingdomsolutions.tt.Views.MainWindow.open(MainWindow.java:86)
at au.com.kingdomsolutions.tt.TeamTasks.main(TeamTasks.java:105)
Closing database connection.
[db4o 7.12.250.16103   2012-05-15 07:44:47] 
'/Users/dmuse/.tt/tt.db4o' closed by ShutdownHook. 
```

我一直试图让它工作几天，但还没有走得很远。

该异常似乎与数组有关，但是，我没有在我的对象中使用任何类似数组的东西。然而，这可能是一个内部 db4o 结构。

无论如何，所有帮助表示赞赏！

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T09:35:36.510

嗯，我在第二个堆栈跟踪中没有看到任何复制堆栈帧，只有一个本机查询。

消息“objc [7665]：__NSArrayM 类的对象 0x7ff03c0020e0 自动释放，没有适当的池 - 只是泄漏 - 在 objc_autoreleaseNoPool() 上中断以进行调试”

在我看来很可疑。就像 db4o 试图用 MacOS 内部的东西来存储或序列化一个 UI 对象一样。我怀疑常规 Java 对象是否使用任何 __NSArray 和引用计数。

所以我的猜测是你正在对服务器运行本机查询。该查询无法翻译为[SODA](http://community.versant.com/documentation/reference/db4o-8.1/net/reference/Content/basics/querying/soda/soda_example_catelog.htm)。在这种情况下，db4o 尝试序列化查询对象并将其发送到服务器。查询可能是一个内部类并引用它的外部上下文，其中包含 GUI 对象。然后导致这个问题。

我的建议：只对服务器的查询使用 SODA 查询。本机查询在客户端-服务器模式下有很多问题。将查询更改为导致此问题的 SODA 查询，看看它是否解决了问题。

# javascript - 通过键名调用 JSON 对象的方法有什么区别？

> ID：10591614
> 
> 赞同：1
> 
> 时间：2012-05-14T21:57:02.810
> 
> 标签：javascript, syntax

我尽力想出这个问题的名称，如果我能得到一些术语来帮助我会改变它

我能描述的最好的方式就是这样

```
obj1 = {
    "a":{"var":1},
    "b":{"var":2},
    "c":{"var":3}
}

// What's the difference between
resulta = obj1['a']['var']

// and...
resultb = obj1.a.var 
```

那么，使用 [''] 和 . ?

我意识到你只能使用 . 运行函数，但这是唯一的区别吗？

一种方法比另一种更快吗？（甚至一点点？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:05:06.220

如果您要动态构建对象的属性键，则使用方括号的第一种方法很方便：

```
var myDynamicKey = "a";
var result = obj[myDynamicKey]["var"];
var result = obj["someOtherKey_" + myDynamicKey]["var"]; 
```

如果您事先知道属性是什么，那么第二个绝对是首选。

请注意，您可以混合和匹配它们：

```
var result = obj[myDynamicKey].var; 
```

我愿意打赌使用点表示法访问属性会更快，但我没有实际数据来支持这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:06:11.853

如果您使用 [''] 那么您可以将键的名称作为动态变量传递......它可以在运行时更改。如果您使用 .key.key 方法，那么您必须在构建时知道键是什么。

例子：

```
var keys = ['name','phone','email'];
var object = {"name": ,"phone": , "email"};
function updateKeys(name,phone,email){
    for(var i = 0; i < keys; i++){
        object[keys[i]] = arguments[i]
    }
} 
```

对比

```
function updateKeys(name, phone, email){
    object.name = name; 
    object.phone = phone;
    object.email = email
} 
```

[''] 方式更加灵活，允许更多的代码重用。大多数图书馆都会使用这种方法，或者使用一些自制的替代 [''] 做事方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T22:05:24.350

有各种网站提供这方面的信息。

[http://www.quirksmode.org/js/associative.html](http://www.quirksmode.org/js/associative.html)
或
[http://www.hunlock.com/blogs/Mastering_JSON_(_JavaScript_Object_Notation_)](http://www.hunlock.com/blogs/Mastering_JSON_%28_JavaScript_Object_Notation_%29)
或
[http://www.mongodb.org/display/DOCS/Dot+Notation+ （到达+进入+对象）](http://www.mongodb.org/display/DOCS/Dot+Notation+%28Reaching+into+Objects%29)

我会调用的第一个`dot notation`可用于访问对象的方法和属性，第二个是关联数组。

# javascript - Javascript：以编程方式构造 html 元素 ID

> ID：10591615
> 
> 赞同：0
> 
> 时间：2012-05-14T21:57:09.340
> 
> 标签：javascript, html

我需要访问页面中多个字段的值并对它们执行相同的计算。我想做这样的事情，允许我动态访问不同的表单元素，但我无法让它工作：

```
function numInFamily(famID) {
    var numAdults;
    var numChildren;
    var adultFieldID;
    var childFieldID;

    adultFieldID = 'numAdultsFam' + toString(famID);
    childFieldID = 'numKidsFam' + toString(famID);

    numAdults = parseInt(document.getElementById(adultFieldID).value,10);
    numChildren = parseInt(document.getElementById(childFieldID).value,10);

    return numAdults + numChildren;
} 
```

谁能解释我如何动态引用这些元素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:00:12.223

没有内置的`toString`全局函数。但是您不需要这样的函数，因为`+`运算符会自动进行字符串转换。只需将前两个作业替换为：

```
adultFieldID = 'numAdultsFam' + famID;
childFieldID = 'numKidsFam' + famID; 
```

* * *

此外，您可以像这样重写函数：

```
var numInFamily = (function () {     
    function getVal ( id ) {
        return parseInt( document.getElementById( id ).value, 10 );
    }

    return function ( famID ) {
        return getVal( 'numAdultsFam' + famID ) + getVal( 'numKidsFam' + famID );
    };    
}()); 
```

这将删除代码重复。

# ruby - Ruby：在另一个哈希中包含一个哈希

> ID：10591622
> 
> 赞同：0
> 
> 时间：2012-05-14T21:58:15.713
> 
> 标签：ruby, hash

我有以下哈希：

```
EMAIL_PWD_HASH = Hash.new
EMAIL_PWD_HASH[ "email" ] =  { "label" => EMAIL_STR, "type" => "email_field" }
EMAIL_PWD_HASH[ "password" ] = { "label" => PWD_STR, "type" => "password_field" } 
```

和以下哈希：

```
NEW_USER_HASH = Hash.new
NEW_USER_HASH[ "first" ] = { "label" => FIRST_STR, "type" => "text_field" }
NEW_USER_HASH[ "last" ] =  { "label" => LAST_STR, "type" => "text_field" }

NEW_USER_HASH[ "title" ] =  { "label" => TITLE_STR, "type" => "text_field" }
NEW_USER_HASH[ "bio" ] =  { "label" => BIO_STR, "type" => "text_field" } 
```

我想在最后一个生物之前和之前将电子邮件和密码添加到 NEW_USER_HASH。添加 EMAIL_PWD_HASH 的语法是什么（顺序很重要）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:04:38.887

```
NEW_USER_HASH.merge!(EMAIL_PAD_HASH) 
```

另请注意，ruby 中的哈希值没有排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T23:29:44.810

我不知道该怎么做你问的，我怀疑这是可能的，但这是一种*快速而肮脏*的方法来做你需要的事情：

```
NEW_USER_HASH['email']    = EMAIL_PWD_HASH['email']
NEW_USER_HASH['password'] = EMAIL_PWD_HASH['password']
NEW_USER_HASH['bio']      = NEW_USER_HASH.delete('bio')  # deletes bio and reinsert in the end 
```

`email`正如你所问的，现在`password`是 after`last`和 before 。`bio`:)

# c# - 使用 Log4Net 进行日志记录在 Windows 服务中工作，现在在系统托盘应用程序中失败

> ID：10591624
> 
> 赞同：1
> 
> 时间：2012-05-14T21:58:23.900
> 
> 标签：c#, .net-4.0, log4net, system-tray

正如标题所说，Log4Net 不工作。尽管创建了日志文件（作为 CSV），但不会将事件记录到其中。我在 Windows 服务中工作，但是当我将代码移到系统托盘应用程序时，日志记录停止工作。我没有想法，可以使用一些建议......

这是系统托盘应用程序的主程序。我在 Main 方法中配置 Log4Net：

```
 static class Program
    {
        private static readonly ILog log = LogManager.GetLogger(typeof(HostSwitcher.Program));

        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            log4net.Config.XmlConfigurator.Configure();

            if (!SingleInstance.Start()) { return; }
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            try
            {
                var applicationContext = new CustomApplicationContext();

                Application.Run(applicationContext);

            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message, "Program Terminated Unexpectedly",
                    MessageBoxButtons.OK, MessageBoxIcon.Error);
            }

            SingleInstance.Stop();

        }

    } 
```

这是我的 app.config 文件：

```
 <?xml version="1.0"?>
<configuration>
  <appSettings>
    <add key="log4net.Internal.Debug" value="true"/>
  </appSettings>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler,Log4net"/>
  </configSections>
  <system.diagnostics>
    <trace autoflush="true">
      <listeners>
        <add
            name="textWriterTraceListener"
            type="System.Diagnostics.TextWriterTraceListener"
            initializeData="C:\temp\log4net.txt" />
      </listeners>
    </trace>
  </system.diagnostics>
  <log4net>
    <root>
      <level value="DEBUG"/>
      <appender-ref ref="CsvFileAppender"/>
    </root>
    <appender name="LogFileAppender" type="log4net.Appender.RollingFileAppender">
      <param name="LockingModel" type="log4net.Appender.FileAppender+MinimalLock" />
      <param name="File" value="C:\temp\emotiv_log.txt"/>
      <param name="AppendToFile" value="true"/>
      <rollingStyle value="Size"/>
      <maxSizeRollBackups value="10"/>
      <maximumFileSize value="10MB"/>
      <staticLogFileName value="true"/>
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern" value="%-5p%d{yyyy-MM-dd hh:mm:ss} – %m%n"/>
      </layout>
    </appender>
    <appender name="CsvFileAppender" type="log4net.Appender.FileAppender">
      <!--<param name="LockingModel" type="log4net.Appender.FileAppender+MinimalLock" />-->

      <file type="log4net.Util.PatternString" value="C:\\logs\\emotiv_log.csv"></file>
      <appendToFile value="true"/>
      <layout type="DataMindLoggerService.CsvPatternLayout, DataMindLoggerService">
        <header value="DateTime,ElapsedTime,Level,UserId,Action,Value&#13;&#10;" />
        <conversionPattern value="%date{M/d/yyyy H:mm:ss.fff}%newfield%property{ElapsedTime}%newfield%level%newfield%property{UserId}%newfield%property{Action}%newfield%property{Value}%endrow" />
      </layout>
    </appender>
  </log4net>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
</configuration> 
```

在我的 AssemblyInfo 文件中，我有以下内容：

```
[assembly: log4net.Config.XmlConfigurator(Watch = true)] 
```

而且，在我写入日志文件的每个类的顶部，我有以下内容：

```
protected static readonly ILog log = LogManager.GetLogger(typeof(SomeNamespace.SomeClass)); 
```

此外，我尝试右键单击我的 app.config 文件并使用“如果较新则复制”、“始终复制”和“如果从不复制”进行编译，但上述任何一项似乎都不重要。

有什么建议么。到目前为止，对我来说唯一明显的事情是它在 Windows 服务中工作并且在系统托盘应用程序中停止工作。但是，我没有想法 - 建议？

谢谢。

# python - 执行 SQL 查询的更有效方法？

> ID：10591626
> 
> 赞同：2
> 
> 时间：2012-05-14T21:58:43.470
> 
> 标签：python, mysql, sql

有没有更好的方法来进行以下计算`sales - returns = total`？

```
exchange_rates = self.rates_dict

self.DBConnection.cursor.execute("SELECT royalty_price, royalty_currency FROM sales_raw WHERE provider='%s' AND sales_or_return = 'S' AND date='%s'"%(provider, self.date))
data = list(self.DBConnection.cursor.fetchall())
sales_in_usd = sum(float(price) * exchange_rates[currency] for price, currency in data)

self.DBConnection.cursor.execute("SELECT royalty_price, royalty_currency FROM sales_raw WHERE provider='%s' AND sales_or_return = 'R' AND date='%s'"%(provider, self.date))
data = list(self.DBConnection.cursor.fetchall())
returns_in_usd = sum(float(price) * exchange_rates[currency] for price, currency in data)

total_in_usd = sales_in_usd - returns_in_usd 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T22:09:31.977

```
SELECT    
    royalty_currency,
    SUM (
          CASE sales_or_return 
          when 'R' then royalty_price * -1
          else royalty_price
       ) as TotalSales
  WHERE provider=%s AND date = %s AND sales_or_return IN ('S', 'R')
    GROUP BY royalty_currency 
```

我不是 100% 确定这会在 MySQL 上编译，首先尝试一下。如果是...很好...如果不是，请告诉我，因为我有另一个想法。一旦你得到这个，乘以给定货币的汇率。

编辑：`AND sales_or_return IN ('S', 'R')`根据@ypercube 的建议添加。此外，这假设所有货币都是相同的。您仍然需要根据他们的汇率迭代结果。如果汇率存储在数据库中，那么您可以在汇率表中加入数据。作为一名出色的会计师，我不知道您是否想在销售时获取汇率，或者是否所有内容都按照当前汇率计算。我的假设是，此时，您正在根据您通过 Web 服务获得的当前汇率计算销售额。

另一种查询可能是：

```
SELECT sales.royalty_currency, sales.GrossSales, returns.GrossReturns, sales.GrossSales - returns.GrossReturns, 
(SELECT sum(royalty_price) GrossSales, royalty_currency 
    FROM sales_raw 
    WHERE provider=%s AND sales_or_return = 'S' AND date=%s) sales
JOIN 
(SELECT sum(royalty_price) GrossReturns, royalty_currency 
    FROM sales_raw 
    WHERE provider=%s AND sales_or_return = 'R' AND date=%s) returns
on sales.royalty_currency = returns.royalty_currency 
```

这个也可以再完善一点。它还可以为您提供一些其他信息，这些信息可能对其他报告目的有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T22:02:33.477

当然，让数据库完成工作（通过`sum`直接在您的 sql 语句中使用）。

编辑：您可以`group by`使用货币类型为`total`每种货币类型设置一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T22:17:01.517

不是最少的代码行，而是直观和可读的，如果需要，可以压缩以跳过步骤

1.  将汇率放入您的数据库中。让我们假设它在数据库中的列royal_currency 和 exrate

2.  将汇率表与 sales_raw 表连接起来

    (SELECT sales_raw.provider, sales_raw.royalty_price, sales_raw.royalty_currency, sales_raw.sales_or_return, exchange_rates.exrate FROM sales_raw INNER JOIN exchange_rates ON sales_raw.royalty_currency = exchange_rates.royalty_currency) 销售额

3.  以销售和退货为轴心

    （选择供应商，版税_货币，exrate CASE sales_or_return WHEN 'S' THEN Royalty_price ELSE 0 AS 版税_sales

4.  计算总数

    SELECT SUM(royalty_sales * exrate) - SUM(royalty_returns * exrate) AS total_sum FROM pivoted_sales

# apache-flex - 有谁知道如何在 Flex Mobile 中访问 *Native* 声音通知或设备“音频”状态？

> ID：10591629
> 
> 赞同：2
> 
> 时间：2012-05-14T21:59:18.193
> 
> 标签：apache-flex, mobile, audio, vibration, air-native-extension

有谁知道允许您访问设备通知声音的 AIR 本机扩展 (ANE)？或者，一种查询设备是否处于“静音”或“振动”模式的方法？

我已设置推送通知，但我的 (Android) 设备上没有声音播放。

我知道我可以播放自己的声音，但我想使用本机通知声音（与 SMS 或电子邮件警报声音相同），如果不应该播放声音（即静音模式 /振动模式）。

我一直在寻找几个小时，并且有一个“振动 ANE”，其他人也在寻找相同类型的功能，但我还没有找到任何可用于原生声音通知的东西。

我相信iOS在收到推送通知时会自动播放通知声音（我认为），但Android只是闪烁“阴影标题”并显示通知的应用程序图标。

也许其他人偶然发现了解决方案？？？=)

非常感谢！托德=D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T22:04:56.267

我认为您可能必须小心尝试访问 iOS 上的内置声音。

我们绝对可以编写一个播放任何系统声音的扩展。但是我相信这些声音是受版权保护的，我对 Apple ToS 的理解是，如果您直接使用它们，您的应用程序可能会被 AppStore 拒绝。

这就是为什么像通知扩展这样的东西只使用“默认通知”值来访问用户设置的系统声音。这些声音在某些系统事件上播放。

声音都通过未记录的 ID 访问：http: [//iphonedevwiki.net/index.php/AudioServices](http://iphonedevwiki.net/index.php/AudioServices)

所以是的，我们一直非常谨慎地编写任何可能使开发人员在 AppStore 中遇到麻烦的内容。你有足够的问题让应用程序按原样通过。但是，如果您以其他方式阅读，请告诉我。

# cakephp - CakePHP：双向自引用 hasMany 关联

> ID：10591630
> 
> 赞同：5
> 
> 时间：2012-05-14T21:59:20.887
> 
> 标签：cakephp, associations, has-many-through

我试图通过 CakePHP 中的关系来了解双向自引用 hasMany（真是满口！）。

我正在做一个图片匹配网站。

*   图片通过“匹配”（连接模型）与其他图片相关联。
*   每场比赛有两张图片并存储当前评分和总票数。
*   查看图片时，从任一方向查看图片的所有相关图片都应该可用（通过其匹配）。

我首先通过与连接模型的关系定义了一个 hasMany。

图片匹配连接表具有以下结构：

```
id | picture_id | partner_id | rating | total_votes 
```

我的匹配加入模型关联如下所示：

```
class PictureMatch extends AppModel {

...

    public $belongsTo = array(
        'Picture' => array(
            'className' => 'Picture',
            'foreignKey' => 'picture_id',
            'conditions' => '',
            'fields' => '',
            'order' => ''
        ),
        'Partner' => array(
            'className' => 'Picture',
            'foreignKey' => 'partner_id',
            'conditions' => '',
            'fields' => '',
            'order' => ''
        )
    );
} 
```

每张图片都需要能够从任一方向访问其相关图片，但这是我无法掌握的地方。看起来我需要保存关系的双方，但这会破坏连接模型中存储的额外数据 - 有两个数据库条目，投票可能会因方向而异。

任何人都可以阐明在 CakePHP 中执行此操作的最佳方法吗？我比较困惑。
是否可以即时创建反向关系？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T15:56:17.007

您可以通过 Model::bindModel() 动态创建 realtions，这是非常有用的东西，它可以让您绑定反向关系，或者更确切地说是您想要动态绑定的任何方向。

[http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html)

此外，使用 Containable 行为，您可以创建无限链来检索您的关联日期前。

包含（'Picture.PictureMatch.Partner.PictureMatch.Picture.....'）

基本上你可以遍历你的所有模型，只要每个链与下一个链有某种关联，以更好地解释它简单的例子（请忽略其中的逻辑）

圆属于正方形 正方形属于三角形

所以 Triangle 与 Circle （直接）无关，但 Square 介于两者之间

```
Circle->find('all', array('...', contain => array('Square.Triangle')); 
```

或者为了获得更多乐趣，让我们一圈一圈地循环

```
Circle->find('all', array('...', contain => array('Square.Trinagle.Square.Circle')); 
```

等等，当然这些例子是无用的，也没有任何编程逻辑，但我希望你明白你可以在无限数量的关系中来回循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-25T18:24:49.887

我认为这已被放弃，但它很容易解决——它与阶段有关

> 销毁存储在连接模型中的额外数据

这意味着您的保存正在运行`deleteAll`并在匹配时插入记录...相反，您需要查找并更新该记录...

这可以通过几种方式完成，但最简单的方法是在保存调用之前，查找它，并将主键包含在匹配记录数据中。基本上不要将其保存为 HABTM，并且仅在您已经尝试查找现有匹配记录主键 ( `id`) 并更新数据以使用它保存时将其保存为 hasMany。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-21T07:46:06.140

我不确定这是否是最好的解决方案，但如果你这样做：

```
public $belongsTo = array(
    'Picture1' => array(
        'className' => 'Picture',
        'foreignKey' => 'picture_id',
    ),
    'Picture2' => array(
        'className' => 'Picture',
        'foreignKey' => 'picture_id',
    ),
    'Partner' => array(
        'className' => 'Partner',
        'foreignKey' => 'partner_id',
    ),
); 
```

然后，当您进行搜索时，您只需搜索，`($this->data['Picture1'] == $var || $this->data['Picture2'] == $var)`只要您`recursive`设置为 1 或 2，您就应该取回所有相关数据`Picture`。

# .net - 没有 SP1 的 Windows 2008 R2 服务器是否支持 Parallel.ForEach 循环？

> ID：10591631
> 
> 赞同：1
> 
> 时间：2012-05-14T21:59:21.983
> 
> 标签：.net, c#-4.0, .net-4.0, windows-server-2008-r2

从平台部分下的**[文档](http://msdn.microsoft.com/en-us/library/dd992001.aspx)**中，它说它只有在服务器核心支持 SP1 或更高版本时才会运行。

我的服务器规格是：

> **处理器**：Intel Xenon 2.93GHz（4 个处理器）
> **系统类型**：64 位
> **操作系统**：Windows Server R2 Enterprise

**另一个问题：**

“不支持服务器核心”是什么意思？

**接受的答案**

**[Marius Oiaga](http://news.softpedia.com/news/NET-Framework-4-on-Windows-Server-2008-R2-SP1-Server-Core-179774.shtml)**接受的答案和帖子在这里有所帮助。它说。

> **客户需要 Windows Server 2008 R2 SP1 才能在服务器核心部署中利用 .Net Framework 4。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:03:25.490

服务器核心是服务器的简化安装，缺少许多非必要功能（包括大部分 gui）

如果你的服务器上有一个 gui，你应该没问题。

# php - PHP中的内联elseif

> ID：10591632
> 
> 赞同：6
> 
> 时间：2012-05-14T21:59:35.637
> 
> 标签：php

有没有办法在 PHP 中使用内联 if 语句，其中还包括 elseif？

我会假设逻辑会是这样的：

```
$unparsedCalculation = ($calculation > 0) ? "<span style=\"color: #9FE076;\">".$calculation : ($calculation < 0) ? "<span style=\"color: #FF736A;\">".$calculation : $calculation; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-14T22:01:38.613

`elseif`无非是*，*`else if`所以，实际上，没有，这只是一种方便。三元运算符没有提供同样的便利，因为三元运算符旨在用于非常短的逻辑。*`elseif`*

 *```
if ($a) { ... } elseif ($b) { ... } else { ... } 
```

等同于

```
if ($a) { ... } else { if ($b) { ... } else { ... } } 
```

因此，三元等价物是

```
$a ? ( ... ) : ( $b ? ( ... ) : ( ... ) ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T22:04:01.713

您可以使用嵌套的三元运算符

```
 (IF ? THEN : ELSE) 
      (IF ? THEN : ELSE(IF ? THEN : ELSE(IF ? THEN : ELSE)) 
```

为了更好的可读性编码标准可以在[这里找到](https://stackoverflow.com/questions/243217/which-coding-style-you-use-for-ternary-operator)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T22:04:51.433

您需要将其中的一些包含在括号中以解决操作顺序问题，但可以肯定的是，您可以这样做。虽然三元运算符没有“elseif”，但实际上是一回事

`if (condition) ? (true) : (false> if (condition) ? (true) : (false));`

虽然你真的不应该这样编码......从可读性的角度来看它是令人困惑的。没有人会看到它并“甜蜜，忍者！” 他们会说“呃，wtf”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-20T13:57:45.110

试试这个，

```
(($condition_1) ? "output_1" : (($condition_2) ?  "output_2" : "output_3")); 
```

在您的情况下，它将是：

```
$unparsedCalculation = (($calculation > 0) ? "<span style=\"color: #9FE076;\">".$calculation : (($calculation < 0) ?  "<span style=\"color: #FF736A;\">".$calculation : $calculation)); 
```*

# javascript - 单击javascript时删除按钮

> ID：10591634
> 
> 赞同：2
> 
> 时间：2012-05-14T21:59:40.703
> 
> 标签：javascript, html, highcharts

我有一些代码在将线条添加到图表时创建一个按钮。单击按钮时，我想从图表中删除线条并删除按钮。该示例可以在[这里](http://whichchart.com/)查看。

也就是说，成功添加按钮的代码是：

```
function getChartData(option){
    var category = $('#category').val();
    var option = option.value;
    var seriesTitle = category+option;
    $.ajax({
        url: "getData.php?action=getChartData",
        type: "GET",
        dataType:"json",
        data: {
            category:category,
            option:option
        },
        success: function(json){
            chart.addSeries({
                name: seriesTitle,
                data : []
            });
            $.each(json.Data,function(){   
                chart.series[chart.series.length-1].addPoint([parseFloat(this.Year), parseFloat(this[option])]);
            });
        }

    });
    var series = document.createElement('button');   
    series.onclick = function(){
        removeLine(seriesTitle);
    }
    series.setAttribute('id',seriesTitle);
    series.innerHTML=seriesTitle;
    $('#removeLine').append(series);

} 
```

然后，当单击按钮时，此代码不执行任何操作：

```
function removeLine(seriesTitle){
    chart.series[seriesTitle].remove();
    $(seriesTitle).remove();
} 
```

错误是：

```
Uncaught TypeError: Cannot call method 'remove' of undefined
removeLine    oil.js:172
series.onclick 
```

任何知道我如何根据变量在 highcharts 中调用特定行的人的奖励积分，例如：

```
chart.series[chart.series.length-1].remove(); 
```

这不会：

```
chart.series[seriesTitle].remove(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:33:40.843

当您使用`chart.series[something].remove();`“某事”时，必须是意甲位置，如您**[在此处](http://www.highcharts.com/stock/ref/#series-object)**看到的那样。所以你必须通过参数传递位置。这就是为什么`chart.series[0].remove();`有效。

所以如果你想解决这个问题，你可以在删除之前根据标题找到意甲位置，如下所示。

```
function removeLine(seriesTitle){
    for(var postion = 0; position < chart.options.series.length; position++) {
        if(chart.options.series[position].name == seriesTitle) {
            chart.options.series[position].remove();
            break;
        }
    }
} 
```

或者

```
function removeLine(seriesTitle){
    $.each(chart.options.series, function(pos, serie){
        if(serie.name == seriesTitle) {
            chart.series[pos].remove();
        }
    });
} 
```

要解决删除按钮时的问题，您必须添加一个哈希标签，如下所示：

```
$('#' + seriesTitle).remove(); 
```

**因此，您的功能将如下所示：**

```
function removeLine(seriesTitle){
    for(var postion = 0; position < chart.options.series.length; position++) {
        if(chart.options.series[position].name == seriesTitle) {
            chart.options.series[position].remove();
            break;
        }
    }
    $('#' + seriesTitle).remove();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:30:42.857

我认为问题出在线条上

```
 seriesTitle = chart.addSeries({
            name: seriesTitle,
            data : []
        }); 
```

`seriesTitle`这里指的是`seriesTitle`创建者

```
var seriesTitle = category+option; 
```

并覆盖其值。我猜那`addSeries`是返回一个对象或`undefined`. `seriesTitle`使用此值传递给`removeLine`，并且您将其用作数组的键`chart.series`。

尝试删除那里的分配（看起来你真的不想要它），或者只是在它前面加上 var （它将成为匿名函数的本地）。

* * *

如果您不确定 的键值对，`chart.series`则将其传递给它`console.log()`，您可以检查它以查看您的键应该是什么样子（以及值是什么）。

# qt - 我可以在 QGraphicsItem 中获取鼠标事件吗？

> ID：10591635
> 
> 赞同：18
> 
> 时间：2012-05-14T21:59:45.790
> 
> 标签：qt, qgraphicsview, qgraphicsitem, qmouseevent

我有子类化`QGraphicsRectItem`，它没有收到任何鼠标事件。我已经看到与此类似的其他问题说我需要启用鼠标跟踪，但`setMouseTracking`在 QWidget 中，并且 QGraphicsItem 似乎不是 QWidget。

我已经实施`paint`了，这很有效。在我的子类 QGraphicsView 中，我收到了鼠标事件。

文档似乎认为我应该重写 mousePressEvent 函数（例如），我应该开始获取事件。我是否将 mousePressEvent 转发到 QGraphicsView 的超类似乎没有任何区别。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-14T22:03:59.277

在您的子类 QGraphicsView 中，如果您希望它们向下传播到项目，则需要调用覆盖鼠标事件方法的默认实现。例如：

```
CustomView::mousePressEvent(QMouseEvent *event)
{
    // handle the event as you like

    QGraphicsView::mousePressEvent(event); // then call default implementation
} 
```

如果要接受悬停事件，则需要调用`QGraphicsItem::setAcceptHoverEvents(true);`. 否则，您不需要启用任何特定的鼠标跟踪。

编辑：这是一个完整的工作示例：

```
#include <QtGui>

class CustomView : public QGraphicsView
{
protected:
    void mousePressEvent(QMouseEvent *event)
    {
        qDebug() << "Custom view clicked.";
        QGraphicsView::mousePressEvent(event);
    }
};

class CustomItem : public QGraphicsRectItem
{
protected:
    void mousePressEvent(QGraphicsSceneMouseEvent *event)
    {
        qDebug() << "Custom item clicked.";
    }
};

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);

    CustomItem item;
    item.setRect(20, 20, 60, 60);

    QGraphicsScene scene(0, 0, 100, 100);
    scene.addItem(&item);

    CustomView view;
    view.setScene(&scene);
    view.show();
    return a.exec();
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-07-10T13:47:31.560

我遇到了您遇到的相同问题，我想在安东尼非常好的答案之上添加一些见解。这是我写的一个例子，展示了一些可以使用鼠标事件和键盘事件实现的功能。

请注意，事件不会传播到`QGraphicsItem`a`QGraphicsItemGroup`或 a 中的s `QList<QGraphicsItem>`（我花了一段时间才弄清楚）。

```
#include <QtGui>
#include <QGraphicsRectItem>
#include <QGraphicsView>
#include <QApplication>
#include <QGraphicsSceneMouseEvent>

class CustomItem : public QGraphicsEllipseItem
{
protected:
    void mousePressEvent(QGraphicsSceneMouseEvent *event)
    {
        if(event->button() == Qt::LeftButton) {
            if(event->modifiers() == Qt::ShiftModifier) {
                qDebug() << "Custom item left clicked with shift key.";
                // add the item to the selection
                setSelected(true);
            } else if(event->modifiers() == Qt::AltModifier){
                qDebug() << "Custom item left clicked with alt key.";
                // resize the item
                double radius = boundingRect().width() / 2.0;
                _center = QPointF(boundingRect().topLeft().x() + pos().x() + radius, boundingRect().topLeft().y() + pos().y() + radius);
                QPointF pos = event->scenePos();
                qDebug() << boundingRect() << radius << this->pos() << pos << event->pos();
                double dist = sqrt(pow(_center.x()-pos.x(), 2) + pow(_center.y()-pos.y(), 2));
                if(dist / radius > 0.8) {
                    qDebug() << dist << radius << dist / radius;
                    _isResizing = true;
                } else {
                    _isResizing = false;
                }
            } else {
                qDebug() << "Custom item left clicked.";
                QGraphicsItem::mousePressEvent(event);
                event->accept();
            }
        } else if(event->button() == Qt::RightButton) {
            qDebug() << "Custom item right clicked.";
            event->ignore();
        }
    }
    void mouseMoveEvent(QGraphicsSceneMouseEvent *event)
    {
        if(event->modifiers() == Qt::AltModifier && _isResizing){
            QPointF pos = event->scenePos();
            double dist = sqrt(pow(_center.x()-pos.x(), 2) + pow(_center.y()-pos.y(), 2));
            setRect(_center.x()-this->pos().x()-dist, _center.y()-this->pos().y()-dist, dist*2, dist*2);
        } else if(event->modifiers() != Qt::AltModifier) {
            qDebug() << "Custom item moved.";
            QGraphicsItem::mouseMoveEvent(event);
            qDebug()<<"moved"<<pos();
        }
    }
    void mouseReleaseEvent(QGraphicsSceneMouseEvent *event)
    {
        if(event->modifiers() == Qt::AltModifier && _isResizing) {
            _isResizing = false;
        } else if(event->modifiers() != Qt::ShiftModifier) {
            QGraphicsItem::mouseReleaseEvent(event);
        }
    }

    int type() const
    {
        // Enable the use of qgraphicsitem_cast with this item.
        return UserType+1;
    }
private:
    QPointF _center;
    bool _isResizing;
};

class CustomScene : public QGraphicsScene
{
protected:
    void mousePressEvent(QGraphicsSceneMouseEvent *event)
    {
        qDebug() << "Custom scene clicked.";
        QGraphicsScene::mousePressEvent(event);
        if(!event->isAccepted()) {
            if(event->button() == Qt::LeftButton) {
                // add a custom item to the scene
                QPointF pt = event->scenePos();
                CustomItem * item = new CustomItem();
                item->setRect(pt.x()-25, pt.y()-25, 50, 50);
                item->setFlags(QGraphicsItem::ItemIsSelectable|
                              QGraphicsItem::ItemIsMovable);
                addItem(item);
            } else if(event->button() == Qt::RightButton) {
                // check whether there is an item under the cursor
                QGraphicsItem * itemToRemove = NULL;
                foreach(auto item, items(event->scenePos())) {
                    if(item->type() == QGraphicsItem::UserType+1) {
                        itemToRemove = item;
                        break;
                    }
                }
                if(itemToRemove) {
                    // remove the item from the graphicsScene
                    removeItem(itemToRemove);
                }
            }
        }
    }
    void mouseMoveEvent(QGraphicsSceneMouseEvent *event)
    {
        qDebug() << "Custom scene moved.";
        QGraphicsScene::mouseMoveEvent(event);
    }
    void keyPressEvent(QKeyEvent * event) {
        if(event->key() == Qt::Key_Backspace) {
            // remove all selected items
            qDebug() << "selected items" << selectedItems().size();
            while(!selectedItems().isEmpty()) {
                removeItem(selectedItems().front());
            }
        } else {
            QGraphicsScene::keyPressEvent(event);
        }
    }
};

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);

    CustomItem item;
    item.setRect(20, 20, 60, 60);
    item.setFlags(QGraphicsItem::ItemIsSelectable|
                  QGraphicsItem::ItemIsMovable);

    CustomScene scene;
    scene.setSceneRect(0, 0, 500, 500);
    scene.addItem(&item);

    QGraphicsView view;
    view.setScene(&scene);
    view.show();
    return a.exec();
} 
```

希望它也有帮助！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-02-02T17:10:48.827

我有一个类似的问题，视图不接受鼠标点击。问题是我需要启用视图（ ui->view->setEnabled(true) ）。

# android - Android EditText 中背景的默认颜色渐变是什么？

> ID：10591640
> 
> 赞同：0
> 
> 时间：2012-05-14T22:00:08.567
> 
> 标签：android

我正在尝试在 Android EditText 中重用相同的灰色渐变背景？我想用它作为 TextView 的颜色背景？如何为我的 TextView 指定此渐变？我对文本本身的渐变不感兴趣，只是在 EditText 上写入的背景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:04:35.507

此信息通常位于您设备的特定主题中。有关如何阅读和使用主题的更多信息，请参阅 Android 网站上的[主题页面。](http://developer.android.com/guide/topics/ui/themes.html)根据您的设备，您可能有各种不同的活动主题，因此您需要找到您正在寻找的主题的来源以获得准确的渐变。

# javascript - Ajax Big Post Data 在 wordpress 中返回 500 错误

> ID：10591641
> 
> 赞同：0
> 
> 时间：2012-05-14T22:00:09.333
> 
> 标签：javascript, jquery, ajax, wordpress, post

我在 WordPress 中编写了一个插件，它使用 Ajax 来保存插件数据。问题是当帖子大小变大时（见图）：

![](../Images/193b4f57474b6ab2891dc352c8763995.png)

服务器抛出错误 500 。较小的帖子数据大小不会发生这种情况

任何想法 ？我已经尝试过 post_max_size 并且似乎与此无关。

代码是：

```
var mainarray = jQuery('.master-settings').serialize();
var data = {
        action: 'sliders_ajax',
    postdata: mainarray
};
jQuery.post(ajaxurl, data, function(response) {
    if(window.console){
        console.log('Got this from the server: ' + response);
    }
    jQuery('#save-ajax-loading').css('visibility', 'hidden');
    jQuery('.saveconfirmer').html('Options saved.');
    jQuery('.saveconfirmer').fadeIn('fast').delay(2000).fadeOut('fast');
});
return false; 
```

# asp.net - asp.net MVC 3/4 相当于一个 response.filter

> ID：10591651
> 
> 赞同：5
> 
> 时间：2012-05-14T22:00:58.543
> 
> 标签：asp.net, asp.net-mvc-3, response.filter

我需要拦截将发送到浏览器的所有 html 并替换那里的一些标签。这需要在全球范围内针对每个视图进行。使用 C# 在 ASP.NET MVC 3 或 4 中执行此操作的最佳方法是什么？过去，我使用 Global.asax (vb) 中的“response.filter”在 ASP.net Webforms 中完成了此操作

```
Private Sub Global_PreRequestHandlerExecute(ByVal sender As Object, ByVal e As System.EventArgs) Handles MyBase.PreRequestHandlerExecute
    Response.Filter = New ReplaceTags(Response.Filter)
End Sub 
```

这调用了我创建的一个类，它继承自 system.io.stream 并遍历 html 以替换所有标签。我不知道如何使用 C# 在 ASP.NET MVC 4 中执行此操作。正如您可能已经注意到的那样，我是 MVC 世界的新手。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T07:44:45.190

您仍然可以在 ASP.NET MVC 中使用响应过滤器：

```
public class ReplaceTagsFilter : MemoryStream
{
    private readonly Stream _response;
    public ReplaceTagsFilter(Stream response)
    {
        _response = response;
    }

    public override void Write(byte[] buffer, int offset, int count)
    {
        var html = Encoding.UTF8.GetString(buffer);
        html = ReplaceTags(html);
        buffer = Encoding.UTF8.GetBytes(html);
        _response.Write(buffer, offset, buffer.Length);
    }

    private string ReplaceTags(string html)
    {
        // TODO: go ahead and implement the filtering logic
        throw new NotImplementedException();
    }
} 
```

然后编写一个自定义操作过滤器，它将注册响应过滤器：

```
public class ReplaceTagsAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var response = filterContext.HttpContext.Response;
        response.Filter = new ReplaceTagsFilter(response.Filter);
    }
} 
```

现在剩下的就是装饰您想要应用此过滤器的控制器/操作：

```
[ReplaceTags]
public ActionResult Index()
{
    return View();
} 
```

如果要应用于所有操作，或者将其注册为 Global.asax 中的全局操作过滤器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-19T20:37:53.117

答案是正确的但是。使用了一段时间后，我遇到了一个案例，响应被分成许多部分，因此 html 不正确

```
Part 1: 
<html>.....<labe

Part 2: 
l/>...</html> 
```

部分渲染也可能会产生意想不到的情况。他们的 html 也不在主流之外。所以我的解决方案是在所有流式传输完成后在 Flush 方法中执行此操作。

```
 /// <summary>
    /// Insert messages and script to display on client when a partial view is returned
    /// </summary>
    private class ResponseFilter : MemoryStream
    {
        private readonly Stream _response;
        private readonly IList<object> _detachMessages;

        public override void Flush()
        {

            // add messages and remove
            // filter is called for a number of methods on one page (BeginForm, RenderPartial...)
            // so that we don't need to add it more than once

            var html = MessageAndScript(_detachMessages);
            var buffer = Encoding.UTF8.GetBytes(html);
            _detachMessages.Clear();
            _response.Write(buffer, 0, buffer.Length);

            base.Flush();
        }

        public ResponseFilter(Stream response, IList<object> detachMessages)
        {
            _response = response;
            _detachMessages = detachMessages;
        }

        public override void Write(byte[] buffer, int offset, int count)
        {
            _response.Write(buffer, offset, buffer.Length);    
        }

        private static string MessageAndScript(IList<object> detachMessages)
        {

            if (detachMessages.Count == 0)
                return null;

            var javascript = CustomJavaScriptSerializer.Instance.Serialize(detachMessages);

            return "$(function(){var messages = " + javascript + @";
// display messages
base.ajaxHelper.displayMessages(messages);
})";
        }
    } 
```

# ios - initWithContentsOfFile Plist in viewWillAppear 内存泄漏

> ID：10591664
> 
> 赞同：0
> 
> 时间：2012-05-14T22:02:06.303
> 
> 标签：ios, memory-leaks, nsmutablearray, plist, initwithcontentsoffile

我正在 ViewVillAppear 中加载我的 plist 文件，如下所示。在第一次加载时，我没有泄漏，但是按下其他 tabBar 按钮/项目并返回到此视图时，我得到了泄漏。我已经在 dealloc 中发布了这个 NSMutableArray 但是它仍然泄漏。有点困惑为什么。（theProducts3 是一个 NSMutableArray，就像 .h 中的 ivar 一样，它不是 @property 或保留的）

```
- (void)viewWillAppear:(BOOL)animated {
[super viewWillAppear:animated];  

NSString *rootPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0]; NSString *plistPath = [rootPath stringByAppendingPathComponent:@"basket.plist"];
theProducts3 = [[NSMutableArray alloc] initWithContentsOfFile:plistPath];

NSLog(@"Number of objects in item array %i", [theProducts3 count]);
} 
```

在这里释放 NSMutable 数组。

```
-(void)dealloc{
[theProducts3 release];
[super dealloc];
} 
```

任何指针最感激！谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:08:24.707

`dealloc`不是 的倒数`viewWillAppear:`。是 的倒数`alloc`。的倒数`viewWillAppear:`是`viewWillDisappear:`。

发生的事情是，当您的视图出现时，您正在分配内存，然后您将转到另一个视图控制器，然后返回，您的视图再次出现，您正在分配更多内存，从而泄漏原始内存。

如果只要您的视图在内存中，您的数组只需要挂起，那么将其分配`viewDidLoad:`并释放到`viewDidUnload:`and中`dealloc`。请记住在释放实例变量`nil`后将其设置为。

# objective-c - 单击 UIBarButtonItem 重新加载 RSSFeed

> ID：10591666
> 
> 赞同：0
> 
> 时间：2012-05-14T22:02:32.023
> 
> 标签：objective-c, ios, uibarbuttonitem

我是 iOS 开发的新手，我没有太多的编程经验。我要么想`UITableView`从遵循以下教程的 RSS 提要重新加载：[RSS 教程](http://www.raywenderlich.com/2636/how-to-make-a-simple-rss-reader-iphone-app-tutorial)

我似乎无法为其添加重新加载按钮，因为有时它第一次加载失败并且想在顶部栏中添加一个按钮以重新加载数据。

就像我说的那样，我几乎没有使用 Objective-C 的经验，但任何帮助都将不胜感激。

以下代码是刷新提要的代码的一部分：

```
- (void)viewDidLoad {
    [super viewDidLoad];    
    self.title = @"News";
    self.allEntries = [NSMutableArray array];
    self.queue = [[[NSOperationQueue alloc] init] autorelease];
    self.feeds = [NSArray arrayWithObjects:@"http://yourllanelli.org.uk/index.php?format=feed&type=atom",
        nil];    
    [self refresh];

    _reloadButton = [[[UIBarButtonItem alloc]
                                       initWithTitle:@"Settings" style:UIBarButtonItemStyleBordered
                                       target:self action:@selector(reloadClick)]  autorelease];
}

-(void)reloadClick {    
    [UITableView refresh];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:17:59.557

`reloadClick`调用该操作时，您实际上并没有再次从 RSS 提要中获取数据。

你想调用你的`refresh`方法，一旦你的 ASIHTTPRequests 都完成了，你想调用`[UITableView reloadData]`

```
-(void)reloadClick
{    
    [self refresh];
}

- (void) requestDidFinish:(ASIHTTPRequest *)request {
     // you need to reload your UITableView once your ASIHTTPRequests finish.
     // since you are sending many requests to get the contents of different feeds, 
     // it would be better to call the following line only once, 
     // when all of the requests have finished
     [UITableView reloadData];
} 
```

# java - 使用 KeyBIndings 响应按钮

> ID：10591669
> 
> 赞同：3
> 
> 时间：2012-05-14T22:02:43.493
> 
> 标签：java, swing, jbutton, key-bindings

我想制作一个具有这些目标的程序：

1）制作一个 JButton 2）使用 KeyBindings 将按钮附加到一个键（“A”键）3）单击“A”时执行一些代码

这是我到目前为止的代码：

```
// Imports

Public class Test{

JButton button = new JButton();

//...

Test(){

button.getInputMap().put(KeyStroke.getKeyStroke("A"), "Pressed");

//...

}

// Where do I add the code that responds when button is pressed?
} 
```

现在我在哪里添加我希望它在按下按钮时执行的代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T22:13:44.733

我能想到的两种方法：

*   让 JButton 和 Key Bindings 共享相同的 AbstractAction，或者更好
*   `doClick()`只需从键绑定中调用按钮即可。

KeyBindingEg.java

```
import java.awt.event.*;
import javax.swing.*;

public class KeyBindingEg extends JPanel {
   private JButton btnA = new JButton();

   public KeyBindingEg() {
      Action btnAction = new ActionOne("A");
      Action keyBindingAction = new ActionTwo();

      int condition = JLabel.WHEN_IN_FOCUSED_WINDOW;
      InputMap inputmap = btnA.getInputMap(condition);
      ActionMap actionmap = btnA.getActionMap();

      final String aKeyPressed = "a key pressed";
      inputmap.put(KeyStroke.getKeyStroke(KeyEvent.VK_A, 0), aKeyPressed );

      actionmap.put(aKeyPressed, keyBindingAction);
      // actionmap.put(aKeyPressed, btnAction); // one or the other, your choice

      btnA.setAction(btnAction);
      add(btnA);
   }

   private class ActionOne extends AbstractAction {
      public ActionOne(String text) {
         super(text);
      }

      @Override
      public void actionPerformed(ActionEvent e) {
         sharedMethod();
      }
   }

   private class ActionTwo extends AbstractAction {
      @Override
      public void actionPerformed(ActionEvent e) {
         btnA.doClick();
      }
   }

   private void sharedMethod() {
      System.out.println("Method called by either key bindings or action listener");
   }

   private static void createAndShowGui() {
      JFrame frame = new JFrame("KeyBindingEg");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(new KeyBindingEg());
      frame.pack();
      frame.setLocationRelativeTo(null);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T22:08:49.327

您需要添加一个动作监听器，特别是对于 actionPerformed。在构造函数中的某处声明它：

```
import java.awt.event.ActionEvent;
import javax.swing.AbstractAction;
import javax.swing.Action;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.KeyStroke;

public class Main {
    public static void main(String[] argv) throws Exception {

        JButton component = new JButton();
        MyAction action = new MyAction();
        component.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke("F2"),
            action.getValue(Action.NAME));
    }
}

class MyAction extends AbstractAction {
    public MyAction() {
        super("my action");
    }

    public void actionPerformed(ActionEvent e) {
        //Here goes the code where the button does something
        System.out.println("hi");//In this case we print hi
    }
} 
```

在这个例子中，如果我们按下 F2 就相当于按下按钮。

# php - 有人知道 PHP 的默认异常代码吗？

> ID：10591670
> 
> 赞同：1
> 
> 时间：2012-05-14T22:03:01.593
> 
> 标签：php, mysql, exception, exception-handling

有人知道 PHP 的默认异常代码吗？主要针对数据库异常。

我知道：

```
42000 is a sql syntax error
23000 is duplicate unique key entry 
```

还有哪些我应该知道的其他异常代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T22:11:43.333

没有“PHP 的默认异常代码”，但看起来您正在寻找 MySQL 错误代码的解释，您可以在[此处](http://dev.mysql.com/doc/refman/5.5/en/error-messages-server.html)找到:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-14T22:06:54.660

您可能想查看[mysql_error()](http://php.net/manual/en/function.mysql-error.php)：

```
<?php
$link = mysql_connect("localhost", "mysql_user", "mysql_password");

mysql_select_db("nonexistentdb", $link);
echo mysql_errno($link) . ": " . mysql_error($link). "\n";

mysql_select_db("kossu", $link);
mysql_query("SELECT * FROM nonexistenttable", $link);
echo mysql_errno($link) . ": " . mysql_error($link) . "\n"; # <- text message
?> 
```

# linux - 编程 NASM，启动指南？

> ID：10591672
> 
> 赞同：0
> 
> 时间：2012-05-14T22:03:05.743
> 
> 标签：linux, unix, assembly, x86, nasm

我对 Intel x86 架构和 Linux 上的编程汇编器很感兴趣。经过一些初步研究，这让我相信除了 FASM、NASM 和 MASM，我想要 NASM。

从现在开始，在 Linux 上编写一个 NASM 汇编器“文本文件”并执行它有多容易？是不是比较简单？我需要确保安装了哪些软件包（gcc 等）？有谁知道任何演练指南？我还没有找到任何东西。哪个Linux发行版重要吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T02:20:49.790

你不说Linux是什么味道的。在 Ubuntu 上，安装就像`sudo apt-get install nasm`. 之后，您可能会从 NASM 项目的[链接页面](http://www.nasm.us/links.php)开始，这将引导您访问大约数不胜数的教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-08T16:02:58.023

我在网上找到的最好的一个是[John Carter 的 PC Assembly](http://www.drpaulcarter.com/pcasm/)。它针对的是NASM，它是全面的，但有意识的，它也是针对Linux和Nasm的。
所有你需要知道的开始，都可以在前几章中找到。它也是在 GPL 许可下发布的。

# wolfram-mathematica - 动态生成操纵“滑块”

> ID：10591680
> 
> 赞同：1
> 
> 时间：2012-05-14T22:04:17.973
> 
> 标签：wolfram-mathematica

Mathematica 的 Manipulate 函数将您想要滑块的参数列表及其值范围作为其最终参数。但为什么不列出列表呢？这样我就可以轻松地为我拥有的这个大的转换规则列表生成所有滑块，例如：

```
parms = {a -> 2, b -> 4, c -> 5};
Table[{{parms[[i]][[1]], parms[[i]][[2]]}, 0, 10}, {i, 1,Length[parms]}]

{{{a, 2}, 0, 10}, {{b, 4}, 0, 10}, {{c, 5}, 0, 10}} 
```

然而，我想要的是：

```
{{a, 2}, 0, 10}, {{b, 4}, 0, 10}, {{c, 5}, 0, 10} 
```

我现在在单元格之间复制粘贴，这相当混乱。我确信有更好的方法来做到这一点。请帮忙，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T23:49:30.137

请在类似问题上查看[此](https://mathematica.stackexchange.com/a/4108/125)和[此。](https://mathematica.stackexchange.com/a/1200/125)

您需要的是`Sequence@@`在用作输入时获取要被视为所需输出的列表列表。

也许是这样的：

```
ClearAll[a, b, c];
parms = {a -> 2, b -> 4, c -> 5}; 
With[{values = Table[parms[[i]][[1]], {i, 1, Length[parms]}],
controls = Sequence @@
 Table[{{parms[[i]][[1]], parms[[i]][[2]], 
   Style[ToString[parms[[i]][[1]]], Red, Bold]}, 0, 10}, {i, 1, 
  Length[parms]}]},
Manipulate[values, controls]] 
```

这使

![在此处输入图像描述](../Images/0cd45b0f758820badceecace838320e5.png)

# ios - 这种 View Presentation Style 的名称是什么？

> ID：10591684
> 
> 赞同：0
> 
> 时间：2012-05-14T22:04:49.033
> 
> 标签：ios, view, presentation-model

![在此处输入图像描述](../Images/b7beda2aea3283cd5eb7858f80c9c54e.png)

这种视图的名称是什么，如何实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:08:28.420

它被称为[UIModalPresentationStyleFormSheet](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/c_ref/UIModalPresentationFormSheet)

# c# - 如何使用 Json.NET 从 [WebMethod] 返回 JArray？

> ID：10591687
> 
> 赞同：1
> 
> 时间：2012-05-14T22:04:52.037
> 
> 标签：c#, jquery, ajax, json.net, webmethod

是否可以从使用 jQuery ajax 和 Json.NET的返回`JArray`对象？`[WebMethod]`例子：

```
[WebMethod]
public JArray GetJsonData()
{
    JArray jArray = new JArray();
    JObject jObject = new JObject();
    jObject.Add(new JProperty("name", "value"));
    jArray.Add(jObject);
    return jArray;
} 
```

当我使用 jQuery ajax 调用它时，它会返回如下所示的内容：

`[[[[]]]]`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:14:35.353

我相信你需要返回一个字符串。

```
[WebMethod]
public string GetJsonData()
{
    JArray jArray = new JArray();
    JObject jObject = new JObject();
    jObject.Add(new JProperty("name", "value"));
    jArray.Add(jObject);
    return jArray.ToString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-14T21:23:17.520

我将我的更改`$.get()`为 a `$.getJSON()`，并将我的后端更改为：

```
[HttpGet]
public JArray GetJSON(string id)
{
    JArray items = Populate(id);
    return items;
} 
```

# php - PHP 2 数组 - 将两个数组中存在的值合并到一个数组

> ID：10591689
> 
> 赞同：2
> 
> 时间：2012-05-14T22:04:55.193
> 
> 标签：php, arrays

我有 2 个数组：

```
$array1 = array(1,2,3,4,5);
$array2 = array(3,4,5,6,7); 
```

是否有任何 PHP 函数可以做到这一点？

```
$finalArray = unknown_php_function($array1,$array2);
// result: $finalArray = array(3,4,5); 
```

它合并两个数组并删除两个数组中都不存在的值。我必须建立一个 foreach 循环还是有更简单的方法？谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-14T22:06:12.960

你想要[`array_intersect`](http://php.net/manual/en/function.array-intersect.php)这个，基本上是两个集合（在这种情况下是数组）的交集，就像在学校里一样。:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T22:09:04.407

你正在寻找[`array_intersect()`](http://www.php.net/manual/en/function.array-intersect.php). 这是一个演示：

```
$array1 = array(1,2,3,4,5);
$array2 = array(3,4,5,6,7);

$finalArray = array_intersect($array1,$array2);
print_r($finalArray); 
```

输出：

```
Array
(
    [2] => 3
    [3] => 4
    [4] => 5
) 
```

# c - 如何将参数传递给可变参数宏？

> ID：10591690
> 
> 赞同：4
> 
> 时间：2012-05-14T22:04:57.607
> 
> 标签：c, function, macros, variadic-functions, variadic-macros

我有一个可变参数函数：

```
LogWrite(FILE * fp, int level, const char * filename, const char * function, ...) 
```

它应该这样调用：

```
LogWrite(fp, int Level, __FILE__, __FUNCTION__, "Message: %s", message) 
```

但是，我想编写一个可变参数宏以使其更易于调用：

```
1: #define LOGWRITE_L1(...) LogWrite(file, 1, __FILE__, __FUNCTION__, ...)
or
2: #define LOGWRITE_L1(file, ...) LogWrite(file, 1, __FILE__, __FUNCTION__, ...) 
```

这样开发人员就可以使用以下方式调用它：

```
LOGWRITE_L1(myfile, "Hello!"); 
```

代替

```
LogWrite(myfile, 1, __FILE__, __FUNCTION__, "Hello!") 
```

但是，这两种方法都给我一个编译器错误。

```
1: expected expression before '...'
2:'file' undeclared (first use in this function) 
```

这是可能的还是我在浪费时间？我以前从未使用过可变参数函数，所以不确定。我的函数有效......我使用完整的声明调用它，并将它写入我想要的文件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T22:09:32.557

您必须`__VA_ARGS__`替换可变参数：

```
#define LOGWRITE_L1(file, ...) LogWrite(file, 1, __FILE__, __FUNCTION__, __VA_ARGS__) 
```

这只是 C99、C11 和 C++11 标准的一部分。一些编译器提供与可变参数宏处理有关的扩展；检查你的手册。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T22:11:17.843

使用`__VA_ARGS__`代替`...`

```
#define LOGWRITE_L1(file, ...) LogWrite(file, 1, __FILE__, __FUNCTION__, __VA_ARGS__) 
```

# android - 在所有适配器中更新 TextView - 最有效的方式

> ID：10591697
> 
> 赞同：0
> 
> 时间：2012-05-14T22:05:52.883
> 
> 标签：android

我有一个项目清单。他们每个人都有一组用`TextView`s 显示的数据。该数据基本保持不变。但是我有一个**距离**字段，每当我从位置提供者那里获得新锁时，我都想更新它。

问题是：**我应该只更新我的数据并调用`notifyDataSetChanged()`我的适配器还是有更有效的方法？**

重新加载所有列表（我在 ViewPager 中有几个）似乎非常昂贵，因为每个列表项中的一个 TextView 需要更新。

这是我`getView()`的适配器。它可能会有所帮助：

```
public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder;
    if (convertView == null) {
        convertView = mInflater.inflate(R.layout.eventrow, parent, false);

        // Creates a ViewHolder and store references to the two children views
        // we want to bind data to.
        holder = new ViewHolder();

        holder.title = (TextView) convertView.findViewById(R.id.eventTitle);
        holder.distance = (TextView) convertView.findViewById(R.id.eventDistance);

        convertView.setTag(holder);
    } else {
        holder = (ViewHolder) convertView.getTag();
    }

    holder.title.setText(((EventItem) getItem(position)).getTitle());
    holder.distance.setText(String.valueOf(((EventItem) getItem(position)).getDistance()));

    return convertView;
} 
```

**我也考虑过直接引用，`holder.distance`但在外面做这件事似乎是个坏主意`getView()`。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:25:50.000

修改数据的正确方法是更改​​列表项，然后调用`notifyDataSetChanged()`.

我想到的唯一选择是在列表视图上再次设置适配器，这要贵得多。没有其他方法。

所以答案是：你必须通过`notifyDataSetChanged()`.

# php - Kohana hMVC：有没有办法列出所有模型实例？

> ID：10591699
> 
> 赞同：1
> 
> 时间：2012-05-14T22:06:00.103
> 
> 标签：php, model-view-controller, kohana

在 Kohana 中，有没有办法输出当前实例化的所有模型的列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T02:57:33.133

不确定 Kohana，但可以在原生 PHP 中完成：

**代码**

```
 $article = new Model_Article();
    $declared_classes = get_declared_classes();
    $target_parent_class = 'Model';
    foreach($declared_classes as $class){
        if(is_subclass_of($class,$target_parent_class))
            echo "$class is a subclass of $target_parent_class <br/>";
    } 
```

**输出**

```
 Kohana_ORM is a subclass of Model
    ORM is a subclass of Model
    Model_Article is a subclass of Model 
```

如果您只想列出`Model_Article`, 设置`$target_parent_class = 'ORM';`

# php - PHP Xpath：获取所有包含“字母”的href

> ID：10591700
> 
> 赞同：5
> 
> 时间：2012-05-14T22:06:00.507
> 
> 标签：php, xpath, html-parsing

假设我有一个已加载的 html 文件，我运行以下查询：

```
$url = 'http://www.fangraphs.com/players.aspx';
$html = file_get_contents($url);    
$myDom = new DOMDocument;
$myDom->formatOutput = true;
@$myDom->loadHTML($html);
$anchor = $xpath->query('//a[contains(@href,"letter")]'); 
```

这给了我这些锚点的列表，如下所示：

```
<a href="players.aspx?letter=Aa">Aa</a> 
```

但我需要一种只获取“players.aspx?letter=Aa”的方法。

我想我可以试试：

```
$anchor = $xpath->query('//a[contains(@href,"letter")]/@href'); 
```

但这给了我一个 php 错误，说当我尝试以下操作时无法附加节点：

```
$xpath = new DOMXPath($myDom);
$newDom = new DOMDocument;
$j = 0;
while( $myAnchor = $anchor->item($j++) ){
   $node = $newDom->importNode( $myAnchor, true );    // import node
   $newDom->appendChild($node);
} 
```

知道如何仅获取第一个查询选择的 href 标记的值吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T13:12:23.923

**使用**：

```
//a/@href[contains(., 'letter')] 
```

**这将选择任何`href`其`a`字符串值（属性的）包含字符串`"letter"`**的任何属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:31:11.020

您的 XPath 查询返回的是属性本身（即`DOMAttr`对象）而不是元素（即`DOMElement`对象）。很好，这似乎是您想要的，但是将它们附加到文档是问题所在。A`DOMAttr`不是文档树中的独立节点；它与 a`DOMElement`但不是通常意义上的*孩子相关联。*因此，直接将 a 附加`DOMAttr`到文档是无效的。

从[W3C 规范](http://www.w3.org/TR/2003/WD-DOM-Level-3-Core-20030226/DOM3-Core.html#core-ID-637646024)：

> `Attr`对象继承了`Node`接口，但由于它们实际上不是它们所描述的元素的子节点，因此 DOM 不会将它们视为文档树的一部分。. . . DOM 认为属性是元素的属性，而不是与它们关联的元素具有单独的标识

要么将`DOMAttr`a 与 a关联`DOMElement`并附加该元素，要么提取`DOMAttr`' 的值并根据需要使用它。

要仅附加其纯文本值，请在`DOMText`节点中使用其值并附加该值。例如，更改此行：

```
 $newDom->appendChild($node); 
```

对此：

```
 $newDom->appendChild(new DOMText($node->value)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T00:01:12.823

尝试这个..

```
$xml_string = 'your xml string';
$xml = simplexml_load_string($xml_string);
foreach($xml->a[0]->attributes() as $href => $value) {
    $myAnchorsValues[] = $value;
}

var_dump($myAnchorsValues); 
```

# django - 用 Django 做 REST 与 MVC 不同吗？

> ID：10591706
> 
> 赞同：-3
> 
> 时间：2012-05-14T22:06:36.380
> 
> 标签：django, model-view-controller, rest

我正在前端使用 jQuery/CSS3/HTML 构建我的第一个 Web 应用程序，该应用程序将从 DJANGO 中实现的后端获取/发布数据。

为此，我想在 DJANGO 中构建经过 ReSTified 的实体。DJANGO 站点[https://www.djangoproject.com/](https://www.djangoproject.com/)主要讨论 DJANGO MVC。我不认为我想要 MVC。我想对了吗？如果是这样，我将如何让 DJango 为我做 ReST？

此外，哪种建筑风格更好？MVC 还是休息？

你能给些建议么？

问候， 马纳夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T07:19:19.010

这些是完全正交的概念。

Django 建立在 MVC 模式（实际上是 MVC 模式的一个变体，更好地称为 MTV）之上。这只是指应用程序的结构——在 Django 的例子中，是模型、视图和模板。如果您使用的是 Django，则无法摆脱这一点。

REST 是一种应用程序如何与其调用者交互的模式——即通过使用 HTTP 动词并提供（通常）JSON。您不能“在 REST 中构建应用程序”，但您可以使用您喜欢的任何结构（包括 MVC）编写 REST 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T22:17:21.767

Django 本身就是一个 MVC 框架。但是，有一些可用的应用程序允许您为模型创建 API。

我相信最常见的是[django-tastypie](https://github.com/toastdriven/django-tastypie)和[django-piston](https://bitbucket.org/jespern/django-piston/wiki/Home)

# c# - 框架视图模型

> ID：10591707
> 
> 赞同：0
> 
> 时间：2012-05-14T22:06:47.110
> 
> 标签：c#, wpf, mvvm, frame

我想了解如何通过视图模型加载框架。我知道如何通过代码隐藏加载，但现在想将所有内容移动到链接 frame.content 的 ViewModel 或绑定到 Frame 的其他属性。

你有提示或建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T13:22:46.030

我的回答有点偏离主题，因为我在这里对你真正想要完成的事情进行了一次飞跃。

如果您正在寻找导航实现，您可能会考虑其他方法。

1.  使用 Prism 的 Navigation 功能，RegionManager 进行了足够的抽象，您可以在 VM 中使用它并导航到 Uri。
2.  使用 TabControl，您可以用简单的样式去除标题。现在您可以将 TabControl SelectedItem 绑定到 VM，想象每个选项卡都是一个视图（或 VM），您现在可以通过切换选项卡来控制导航。

HTH爱丽儿

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T13:17:05.777

将框架的内容绑定到 Page 对象

```
<Page>
    <Viewbox Stretch="Fill" Margin="15">
        <Frame Height="800" Width="1280" Content="{Binding SlideFrame}"/>
    </Viewbox>
</Page> 
```

```
using System.Windows.Controls;

private Page _slideFrame;

// Property
public Page SlideFrame
{
    get { return _slideFrame; }
    set
    {
        _slideFrame = value;
        NotifyPropertyChanged("SlideFrame");
    }
} 
```

# python - 尝试从列表中的元素创建变量

> ID：10591711
> 
> 赞同：0
> 
> 时间：2012-05-14T22:06:59.040
> 
> 标签：python, list, element

这是我第二次尝试问这个问题，希望这次能更简洁。

我有一个板球得分计算器的击球手列表，我正在尝试启动和运行。例如。

```
 batsmen = ['S Ganguly', 'M Brown', 'R Uthappa', 'A Majumdar', 'S Smith', 'A Mathews', 'M Manhas', 'W Parnell', 'B Kumar', 'M Kartik', 'A Nehra'] 
```

有了这个列表，我有一个 for 循环，我目前在没有列表的情况下运行它，它只能计算 2 个团队并找到一个获胜者。

```
 for overs in range(overlimit):
       for balls in range(6):
          balls_team = balls_team+ 1
          runtotal_team = input('Enter runs: ') 
```

我正在尝试利用该列表作为保持得分以及为每个击球手保持价值的手段。

我希望你们中的一个可以提供帮助。我假设可以使用while循环，但我无法弄清楚如何实现列表..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T22:11:30.207

字典？

```
batsmenDict = {
 'A Majumdar': 0,
 'A Mathews': 0,
 'A Nehra': 0,
 'B Kumar': 0,
 'M Brown': 0,
 'M Kartik': 0,
 'M Manhas': 0,
 'R Uthappa': 0,
 'S Ganguly': 0,
 'S Smith': 0,
 'W Parnell': 0}

batsmenDict['M Manhas'] += 1 
```

甚至还有一种称为 defaultdict 的特殊集合类型，它可以让您为每个玩家设置默认值 0：

```
from collections import defaultdict

batsmenDict = defaultdict(int)
print batsmenDict['R Uthappa']
# 0
batsmenDict['R Uthappa'] +=1 
print batsmenDict['R Uthappa']
# 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:10:57.140

您想使用 a [`dict`](http://docs.python.org/library/stdtypes.html#dict)，那么击球手的名字可以成为 dict 的键，并且他们的运行/得分值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T22:13:41.287

使用字典

```
>>> batsmen = [ ... ]
>>> d = dict.fromkeys(batsmen)
>>> d['A Mathews'] = 14
>>> d['A Mathews']
14 
```

# objective-c - 在ios中订购容器？

> ID：10591712
> 
> 赞同：0
> 
> 时间：2012-05-14T22:07:02.067
> 
> 标签：objective-c, ios, stl, containers

是否有任何有序的容器，例如在 Objective-C 中设置的 C++ STL map，或者我应该重新发明轮子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T22:09:53.273

NSArray 是一个有序的容器。如果您正在寻找有序地图，不，它没有。一个常见的解决方案是使用普通的 NSDictionary 并使用数组（如果排序是任意的）或 NSSortDescriptor（如果排序基于对象固有的东西）跟踪排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T22:11:47.797

如果你问的是数组之类的东西，Objective-C 提供了 NSArray、NSSet 和 NSDictionary。其中每一个都有一个可变的变体。（分别是 NSMutableArray、NSMutableSet 和 NSMutableDictionary。）

NSArray 是有序集合，NSSet 是无序集合。NSDictionary 提供基于键值的存储。

# ruby - 在 Ruby 中创建 tgz 文件

> ID：10591715
> 
> 赞同：-2
> 
> 时间：2012-05-14T22:07:47.797
> 
> 标签：ruby, linux, unix, ubuntu, zip

我创建了一个包含一些子目录的目录，在那些漂亮的小子目录中有一些文件。

我想把那个健壮的根目录很好地压缩到一个 .tgz 文件中。

我的代码是`tar cvzf('/Users/me/Desktop/things.tgz', '/Users/me/Desktop/')`

谷歌搜索错误`undefined method ‘cvzf’ for main:Object`没有产生任何结果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:26:49.953

该错误正确描述了您的问题：您正在调用一个`cvzf`以两个文件路径作为参数调用的方法，但是 Ruby 中没有这样的方法。（Ruby 也不知道是什么`tar`，但另一个错误恰好先被捕获）

如果您只想从 Ruby 脚本中调用 shell 命令，只需将命令用反引号括起来，如下所示：

```
`tar cvzf "/Users/me/Desktop/things.tgz" "/Users/me/Desktop"` 
```

但是，只有当您的系统具有 tar 程序时，这才有效。否则，您可以尝试安装一些[Ruby gem](http://rubygems.org/search?query=tar)，为 Ruby 添加 tar 功能。

# arrays - 引用movieClips 时遇到问题

> ID：10591716
> 
> 赞同：0
> 
> 时间：2012-05-14T22:07:51.150
> 
> 标签：arrays, actionscript-3, button, dynamic

我正在开发一个从 XML 动态生成导航的 Flash 项目。现在我正试图让它与数组一起工作，这样一旦我知道逻辑有效，我就可以将它调整为 xml。我是 as3 的新手，学习有点坎坷。我一直在寻找解决方案，但是我看到的许多示例要么太简单而无法回答我的问题，要么太复杂而无法理解，因为我是新人。这是我正在使用的代码。

```
var clientList:Array = new Array("Client1","Client2","Client3","Client4","Client5","Client6","Client7","Client8","Client9","Client10","Client11","Client12","Client13","Client14","Client15");
for each (var cName in clientList){
    var newClientBtn:btnClientNav = new btnClientNav();
    newClientBtn.x = workX;
    newClientBtn.y = workY;
    workY += newClientBtn.height;
    newClientBtn.mcClientName.text = cName;
    lContent.mcWork.addChild(newClientBtn.name);
    trace(newClientBtn);
} 
```

我不知道如何正确引用动态创建的剪辑。我在按钮中有一个动态文本框，但不知道如何正确引用它来更改它，那么我的下一个问题将是引用按钮以进行翻转和单击代码。我知道这可能很容易解决，但我已经看它太久了，我的眼睛开始交叉..提前感谢您提供的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:15:29.967

为什么不将您正在创建的剪辑存储在您以后可以访问的对象中？

但是，如果您想按名称引用影片剪辑，一种方法是：

```
var referenceMC:MovieClip = MovieClip(containerMC.getChildByName(“targetMC”)); 
```

如果它是您所追求的文本字段或按钮，我相信您会做同样的事情，而是将 getChildByName 的结果转换为您想要的控件。

我也相信您想将按钮本身添加为孩子，而不是将其名称传递给您的 addChild 调用？

# jquery - jQuery - 移动元素并返回到它之前的确切位置？

> ID：10591723
> 
> 赞同：7
> 
> 时间：2012-05-14T22:08:45.517
> 
> 标签：jquery, dom-manipulation

我正在尝试使用 jQuery 将元素从 DOM 中的一个位置移动到另一个位置。旁边有与原始容器相同的元素，那么如何存储其先前的确切位置以便返回到它？这是一个例子......

```
<div class="container"></div>
<ul>
    <li></li>
    <li><div class="move">Content</div></li>
    <li></li>
    <li><div class="move">Content</div></li>
    <li></li>
</ul> 
```

...“移动” div 分别移动到“容器” div，然后通过 jQuery .appendTo() 返回到它们在事件上的先前位置。如何通过检测每个“移动” div 的移动位置（它在 DOM 中相对于文档的确切位置，或以其他方式指定的父容器）来确保每个“移动”div 返回到其确切的先前位置？

编辑：我已经更正了 div 上的类，因为我正在处理的特定情况下，列表项彼此（结构上）完全重复，并且在它们各自的元素中具有独特的内容。此外，将“移动”div 移回其原始位置的事件是在其中单击的按钮。被移动的元素如何知道移动后要回到哪里（具体来说，它如何知道列表中的哪个列表项）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T22:12:51.643

您可以使用`clone`它们，`append`它们，最后`hide`是原始 div，并作为回报`remove`克隆 div 和`show`原始 div。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T22:10:56.547

在移动元素之前，将其存储`.parent()`在一个变量中，然后在准备好时使用`.append()`或`.appendTo()`返回它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T23:58:51.403

下面是我所做的。你的帖子遗漏了一些重要的细节，所以我猜想它们会适用于你的情况。

我猜你在`div.move`将它们移动到`container`div 的元素上有一个点击处理程序。

CSS：

```
.placeholder { display:none; } 
```

JS：

```
var id,
    gid = 0;

$('.move').click(function(e){
    if(!$(this).parents('.container')){
        // Move to container
        id = 'placeholder-' + gid++;
        $(this)
            .before('<div class="placeholder ' + id + '"></div>')  // Save a DOM "bookmark"
            .appendTo('.container')                               // Move the element to container
            .data('placeholder', id);                              // Store it's placeholder's info
    }
    else{
        // Move back out of container
        $(this)
            .appendTo('.placeholder.' + $(this).data('placeholder'))  // Move it back to it's proper location
            .unwrap()                               // Remove the placeholder
            .data('placeholder', undefined);        // Unset placeholder data
     }
 }); 
```

单击第一个后，您的 HTML 将如下所示`div.move`：

```
<div class="container">
    <div class="move>Content</div>
</div>
<ul>
    <li></li>
    <li><div class="placeholder placeholder-0"></div></li>
    <li></li>
    <li><div class="move">Content</div></li>
    <li></li>
</ul> 
```

我有这个工作，虽然上面的代码未经测试。希望它传达了这个想法。我喜欢这种方法的地方：

1.  没有重复的元素（例如，这可能会破坏唯一 ID 要求）
2.  最小的 DOM 影响
3.  移动项目上的事件和处理程序保持不变，但不重复

完美吗？不，但它工作得很好而且很干净。YMMV。

干杯

# windows - 列出文件名过长的 WinXP 文件

> ID：10591724
> 
> 赞同：0
> 
> 时间：2012-05-14T22:08:48.577
> 
> 标签：windows, batch-file, windows-xp

你能推荐一种方法来列出 WinXP 磁盘上总文件名（驱动器+文件夹+子文件夹+文件名+ext）大于某个值或 MAX_PATH 的文件吗？理想情况下，这将是批处理或 VB 脚本。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T23:07:59.587

```
@echo off
setlocal
if "%~1%~2"=="%~2%~1" (
    echo Usage: drive maxlength
    echo Example: %0 d: 200
    goto :EOF
)
for /F %%A in ('dir /S/B/A:-D "%~d1\*" 2^>nul') do call :chkpath "%%~A" %2
goto :EOF
:chkpath
set #=%~1%
set len=0
:longer
if defined # (set "#=%#:~1%"&set /A len += 1&goto longer)
if %len% GTR %2 echo.%~1
goto :EOF 
```

我想windows脚本主机更快......

# c# - 如何在未选中的 WPF 功能区选项卡中获取按钮

> ID：10591726
> 
> 赞同：1
> 
> 时间：2012-05-14T22:08:58.980
> 
> 标签：c#, wpf, ribbon, findcontrol

我们正在对主屏幕进行更改，并且正在使用 WPF。主窗口包含 6 个选项卡，每个选项卡中都有一些按钮。当应用程序启动时，它会验证允许用户打开哪个屏幕（由每个按钮打开）。如果用户无法打开其中一个窗口，则与该屏幕对应的按钮将被禁用，并且图标将发生变化。我们的问题是，我所做的这种方法只将此更改应用于选定的选项卡。

代码：

```
/// <summary>
/// Encontra todos os objetos na tela
/// </summary>
/// <typeparam name="T"></typeparam>
/// <param name="objetoTela"></param>
/// <returns></returns>
public static IEnumerable<T> FindVisualChildren<T>(DependencyObject objetoTela) where T : DependencyObject
{
    if (objetoTela != null)
    {
        for (int i = 0; i < VisualTreeHelper.GetChildrenCount(objetoTela); i++)
        {
            DependencyObject objetoFilho = VisualTreeHelper.GetChild(objetoTela, i);
            if (objetoFilho != null && objetoFilho is T)
            {
                yield return (T)objetoFilho;
            }

            foreach (T componenteObjetoFilho in FindVisualChildren<T>(objetoFilho))
            {
                yield return componenteObjetoFilho;
            }
        }
    }
} 
```

这个方法 FindVisualChildren() 在我们的窗口中搜索指定的类型。你可以在这里看到：

```
foreach (RibbonTab tab in FindVisualChildren<RibbonTab>(this.Ribbon)) 
```

代码：

```
foreach (MenuResources item in Enum.GetValues(typeof(MenuResources)))
                {
                   foreach (RibbonTab tab in FindVisualChildren<RibbonTab>(this.Ribbon))
                    {
                        foreach (RibbonButton button in FindVisualChildren<RibbonButton>(tab))
                        {
                            if (button.Name.Equals("rbb" + item.ToString()))
                            {
                                if (authorizationService.CheckAccess((Int64)item, true))
                                {
                                    button.LargeImageSource = (ImageSource)FindResource("ImageMenu" + item.ToString());
                                    button.IsEnabled = true;
                                }
                                else
                                {
                                    button.LargeImageSource = (ImageSource)FindResource("ImageMenuDesabilitado" + item.ToString());
                                    button.IsEnabled = false;
                                }
                            }
                        }
                    }
                } 
```

这是我们的 RibbonTabs（例如，这里没有按钮，只有选项卡）：

```
<ribbon:RibbonTab x:Name="rbtOperacaoLCG" ContextualTabGroupHeader="Operação" Header="LCG" BorderBrush="White" KeyTip="O" Foreground="Black" Background="White"/>
<ribbon:RibbonTab x:Name="rbtSeguranca"  Header="Segurança" KeyTip="S" Foreground="Black" FontWeight="Normal"/>
<ribbon:RibbonTab x:Name="rbtManutencao" Header="Manutenção" KeyTip="M" Foreground="Black"/>
<ribbon:RibbonTab x:Name="rbtComunicacao" Header="Comunicação" KeyTip="C" Foreground="Black" />
<ribbon:RibbonTab x:Name="rbtOperacaoComum" ContextualTabGroupHeader="Operação" Header="Comum" BorderBrush="White" KeyTip="O" Foreground="Black" Background="White" IsSelected="True"/>
<ribbon:RibbonTab x:Name="rbtOperacaoLTQ" ContextualTabGroupHeader="Operação" Header="LTQ" BorderBrush="White" KeyTip="O" Foreground="Black" Background="White"/> 
```

所以，这是我们的问题。我怎样才能将所有 RibbonTabs 的所有 RibbonButtons 放入我们的主窗口？

此致，

古斯塔沃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T07:59:37.777

为什么将“this”传递给第二个 FindVisualChildren 调用？（查找VisualChildren（本））。您是否尝试过传递“标签”？：

```
foreach (RibbonTab tab in FindVisualChildren<RibbonTab>(this.Ribbon))
{ 
    foreach (RibbonButton button in FindVisualChildren<RibbonButton>(tab)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-22T11:22:41.323

我有同样的问题，并尝试了2个案例

1.  `FindVisualChildren<RibbonButton>(tab)`-> 起点选项卡 -> 结果 0
2.  `FindVisualChildren<RibbonButton>(window)`-> 起点窗口仅从主选项卡获取按钮

我需要来自特定选项卡的按钮，所以我写了以下内容（正在使用选项卡的“项目”属性）......请注意，我只检查“功能区组”中的按钮，所以这是一种特定的解决方案，但你可以明白如何为拿到它，为实现它。

```
 protected Button GetDeleteButton(Window window, string tabName){
            var tab = FindVisualChildren<RibbonTab>(window).FirstOrDefault(n => n.Name == tabName);
            if (tab == null){
                return null;
            }
            var groups = tab.Items.Cast<object>().Where(n => n is RibbonGroup).Cast<RibbonGroup>();

            foreach (var group in groups){
                var buts = group.Items.Cast<object>().Where(n => n is RibbonButton).Cast<RibbonButton>();
                var myButton = buts.FirstOrDefault(n => (string)n.Tag == "Delete");
                if (myButton != null){
                    return myButton;
                }
            }

            return null;
        }

        public static IEnumerable<T> FindVisualChildren<T>(DependencyObject depObj) where T : DependencyObject {
            if (depObj != null) {
                for (int i = 0; i < VisualTreeHelper.GetChildrenCount(depObj); i++) {
                    DependencyObject child = VisualTreeHelper.GetChild(depObj, i);
                    if (child != null && child is T) {
                        yield return (T)child;
                    }

                    foreach (T childOfChild in FindVisualChildren<T>(child)) {
                        yield return childOfChild;
                    }
                }
            }
        } 
```

希望有所帮助

# qt - QT 中缺少 Kernel32.dll

> ID：10591737
> 
> 赞同：2
> 
> 时间：2012-05-14T22:10:14.363
> 
> 标签：qt

首先感谢那些将指导或提示我提交的问题的人。我正在使用 QT4.7.4（32 位）。问题是我的 QT 创建者可以在 QT 上构建一些示例项目，但有些不能。如果它无法构建项目，则会显示 kernel32.dll 丢失。谁能告诉我可能是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-12-22T11:14:53.963

下次，如果您有应用程序并想知道它们需要什么 DLL，我建议使用一个名为[Depends.exe](http://www.dependencywalker.com/)的小工具。

将 exe（或 DLL）拖到它上面后，它会给出 DLL 的完整列表以及它丢失的那些。

[![在此处输入图像描述](../Images/1acd7c42d151549de7b8b34d37f49211.png)](https://i.stack.imgur.com/bdIFF.png)

由于我构建了许多不同类型的应用程序，这一直是救命稻草。只需找到并复制应用程序旁边列出的 DLL，它就会运行，无论 Visual Studio 版本、SDK 版本还是 Windows 版本。

# python - Tab 补全在 IPython 0.12 中看不到我的模块

> ID：10591738
> 
> 赞同：2
> 
> 时间：2012-05-14T22:10:24.050
> 
> 标签：python, macos, ipython, tab-completion, enthought

导入时，IPython 无法对当前目录中的模块名称进行制表符补全。

如果我在当前目录中有一个名为 Blah.py 的文件，我想（在 ipython 提示符下）输入 import Bl 并完成“import Blah”。不过，当我按 Tab 时似乎什么也没发生。其他情况下的制表符完成似乎工作正常。

我在 Mac OSX 版本 10.5.8 上使用 EPD 7.2-2 64 位。它带有 IPython 0.12 版。

这种制表符补全曾经适用于我在 Mac 上使用 IPython 版本 0.10.2（尽管它不是 EPD 的一部分）。我在此 EPD 版本中注意到的唯一其他区别是，每次您在字符串中对目录名称进行制表符补全时，制表符补全也会关闭引号。

任何想法表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T21:35:33.920

问题出在`sys.path`. 第一个条目是一个空字符串`''`。我猜完成者不明白这意味着要查看当前目录（也许在以前的版本中可以理解？）。如果您添加`'./'`到路径，那么一切正常。

一开始我刚刚添加的 ipython_config.py 文件

```
import sys
sys.path.insert(0, './') 
```

这样就永久解决了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T22:16:41.503

你安装了readline吗？

```
pip install readline 
```

# javascript - 如何将 mousemove 滚动和调整大小全部绑定到一个函数中

> ID：10591741
> 
> 赞同：1
> 
> 时间：2012-05-14T22:10:36.517
> 
> 标签：javascript, jquery

目前，我在鼠标移动时“做事”。但是，如果用户调整浏览器大小或向下滚动浏览器，我也想做同样的事情。jQuery(document).bind('mousemove',function(e){ var x, y; x = e.pageX; // x coord y = e.pageY; // y coord //other stuff });

我试着做

```
jQuery(document).bind('mousemove resize scroll',function(e){... 
```

但它没有用。我也试过

```
jQuery(document, window).bind('mousemove resize scroll',function(e){... 
```

但它也没有用。

我也知道你可以使用检测滚动

```
$(window).scroll(function(){ 
```

并使用检测调整大小

```
$(window).resize(function() { 
```

但是如果我使用这些检测，我将没有“e”参数来获取鼠标的 x 和 y 坐标

如何将所有 3 个事件全部绑定到一个函数中？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:26:15.417

您仍然在滚动和调整大小方法中拥有事件数据。尝试使用 3 个处理程序将您的代码包装到一个函数中。on() 方法需要 jQuery 1.7+

```
function reusable(eData){
    // Heres what you want to do every time
}
$(document).on({
    mousemove: function(e) { reusable(e); },
    scroll   : function(e) { reusable(e); }
);
$(window).on({
    resize   : function(e) { reusable(e); }
}); 
```

* * *

*已编辑*

事件应该在它们正确的对象中`window`，`document`或者你会得到意想不到的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:37:36.770

从您的评论中：

> 问题是当调整大小或滚动事件被激活时 e.pageX 未定义，这破坏了我的应用程序

那么，当您知道它们是当前对象属性时，为什么还要使用它们`undefined`呢？为什么不使用全局变量并在其中保存最后一个值？

> [JsBin 中的实例](http://jsbin.com/ugigak/5/edit#javascript)

```
var clientX = 0, clientY = 0,
    screenX = 0, screenY = 0,
    pageX = 0,   pageY = 0;    

// bind the events in the correct objects
jQuery(window).bind('resize',function(e) { getBindingValues(e); });
jQuery(document).bind('mousemove scroll',function(e) { getBindingValues(e); });

// your one-function
function getBindingValues(e) {

  clientX = e.clientX ? e.clientX : clientX;
  clientY = e.clientY ? e.clientY : clientY;

  screenX = e.screenX ? e.screenX : screenX;
  screenY = e.screenY ? e.screenY : screenY;

  pageX = e.pageX ? e.pageX : pageX;
  pageY = e.pageY ? e.pageY : pageY;

  $("#hello").html(    
    "*** Safe values ***<br/>" + 
    "mouse: X." + clientX + " Y." + clientY + "<br/>" +
    "page: X." + pageX + " Y." + pageY + "<br/>" +
    "screen: X." + screenX + " Y." + screenY + "<br/><br/>" +
    "*** More values ***<br/>" + 
    "window: W." + $(window).width() + " H." + $(window).height() + "<br/>" +
    "type: <b>" + e.type + "</b>"
  );
} 
```

* * *

`e`您可以在（事件）对象下方比较`mousemove`和`scroll`

*在滚动*

![在此处输入图像描述](../Images/fbc6b71f4dffb5b4d3f8a33c7cfb20ac.png)

*鼠标移动*

![在此处输入图像描述](../Images/f9469891275577d94cf0fa95496d3ab5.png)

# android - viewpager 中的三个片段

> ID：10591742
> 
> 赞同：1
> 
> 时间：2012-05-14T22:10:48.607
> 
> 标签：android, android-fragments, android-viewpager

我有这个问题，如下图所示：

1) [http://imageshack.us/photo/my-images/19/schermata20120512a09444.png/](http://imageshack.us/photo/my-images/19/schermata20120512a09444.png/) 2) [http://imageshack.us/photo/my-images/651/schermata20120512a09444.png/](http://imageshack.us/photo/my-images/651/schermata20120512a09444.png/)

我已经用三个片段完成了一个 viewpager，但是当滚动时，我看到其中一个，我会看到两个片段。

我的问题是：

公共类 FragmentProjetSwipePageActivity 扩展 FragmentActivity {

```
// derived from http://thepseudocoder.wordpress.com/2011/10/05/android-page-swiping-using-viewpager/

// list contains fragments to instantiate in the viewpager
List<Fragment> fragmentsV1 = new Vector<Fragment>();

// page adapter between fragment list and view pager
private PagerAdapter mPagerAdapter;
// view pager
private ViewPager mPager;

// activity data
public String p2text,p3text;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    // creating fragments and adding to list
    fragmentsV1.add(Fragment.instantiate(this,Page1Fragment.class.getName()));
            fragmentsV1.add(Fragment.instantiate(this,Page2Fragment.class.getName()));
    fragmentsV1.add(Fragment.instantiate(this,Page3Fragment.class.getName()));

    // creating adapter and linking to view pager
    mPager = (ViewPager) super.findViewById(R.id.pager1);
    this.mPagerAdapter = new PagerAdapter(super.getSupportFragmentManager(),fragmentsV1,this );
    mPager.setAdapter(this.mPagerAdapter);

    //Set a listener that will be invoked whenever the page changes or is incrementally scrolled. 
```

} }

PagerAdapter.java

公共类 PagerAdapter 扩展 FragmentPagerAdapter {

```
// fragments to instantiate in the viewpager
private List<Fragment> fragments;
FragmentManager fm;
private static int NUM_PAGER_VIEWS = 2;

Context contex;

// constructor
public PagerAdapter(FragmentManager _fm,List<Fragment> fragments) {
    super(_fm);
    this.fragments = fragments;
    fm=_fm;

}

// return access to fragment from position, required override
@Override
public Fragment getItem(int position) {

    return this.fragments.get(position);
}

// number of fragments in list, required override
@Override
public int getCount() {

    return NUM_PAGER_VIEWS;
    //return this.fragments.size();

} 
```

}

谢谢

# perl - 在 Path-Class-Dir 模块中创建目录树

> ID：10591745
> 
> 赞同：3
> 
> 时间：2012-05-14T22:10:58.137
> 
> 标签：perl, module, directory, traversal

该[`Path::Class`](https://metacpan.org/module/Path%3a%3aClass)模块是一个顶级模块，在 cpan.org上有很好的[评论。](http://cpanratings.perl.org/dist/Path-Class)我想知道[`Path::Class:Dir`](https://metacpan.org/module/Path%3a%3aClass%3a%3aDir)模块是否可以创建这样的目录树*：

```
/home/scottie/perl/lib/Path-Class-0.25
  -> lib/
     -> Path/
        -> Class/
           -> Dir.pm
           -> Entity.pl
           -> File.pl
        -> Class.pl
  -> t/
     -> 01-basic.t
     -> 02-foreign.t
     -> 03-filesystem.t
     -> 04-subclass.t
     -> 05-traverse.t
     -> author-critic.t
  -> Build.PL
  -> Changes
  -> dist.ini
  -> INSTALL
  -> LICENSE
  -> Makefile.PL
  -> MANIFEST
  -> META.yml
  -> README
  -> SIGNATURE 
```

*) 来源：`Path-Class-0.25.tar.gz`文件和字符串末尾的“/”表示目录（如`ls -p`在 *nix 系统中）

而**不是**这样（从根目录的完整路径）：

```
 /home/scottie/perl/lib/Path-Class-0.25
  -> /home/scottie/perl/lib/Path-Class-0.25/lib/
     -> /home/scottie/perl/lib/Path-Class-0.25/lib/Path/
        -> /home/scottie/perl/lib/Path-Class-0.25/lib/Path/Class/
           -> /home/scottie/perl/lib/Path-Class-0.25/lib/Path/Class/Dir.pm
           -> /home/scottie/perl/lib/Path-Class-0.25/lib/Path/Class/Entity.pl
           -> /home/scottie/perl/lib/Path-Class-0.25/lib/Path/Class/File.pl
        -> /home/scottie/perl/lib/Path-Class-0.25/lib/Path/Class.pl
  -> /home/scottie/perl/lib/Path-Class-0.25/t/
     -> /home/scottie/perl/lib/Path-Class-0.25/t/01-basic.t
     -> /home/scottie/perl/lib/Path-Class-0.25/t/02-foreign.t
     -> /home/scottie/perl/lib/Path-Class-0.25/t/03-filesystem.t
     -> /home/scottie/perl/lib/Path-Class-0.25/t/04-subclass.t
     -> /home/scottie/perl/lib/Path-Class-0.25/t/05-traverse.t
     -> /home/scottie/perl/lib/Path-Class-0.25/t/author-critic.t
  -> /home/scottie/perl/lib/Path-Class-0.25/Build.PL
  -> /home/scottie/perl/lib/Path-Class-0.25/Changes
  -> /home/scottie/perl/lib/Path-Class-0.25/dist.ini
  -> /home/scottie/perl/lib/Path-Class-0.25/INSTALL
  -> /home/scottie/perl/lib/Path-Class-0.25/LICENSE
  -> /home/scottie/perl/lib/Path-Class-0.25/Makefile.PL
  -> /home/scottie/perl/lib/Path-Class-0.25/MANIFEST
  -> /home/scottie/perl/lib/Path-Class-0.25/META.yml
  -> /home/scottie/perl/lib/Path-Class-0.25/README
  -> /home/scottie/perl/lib/Path-Class-0.25/SIGNATURE 
```

我试图这样做，但我的代码有问题：

```
#------------------8<------------------
my $dir = Path::Class::Dir->new('/home/scottie/perl/lib/Path-Class-0.25');

my $nfiles = $dir->traverse(sub {
    my ($child, $cont) = @_;
    return if -l $child; # don't follow symlinks

    #print Dumper($child);
    #print "$child\n";

    print $child->{'dir'}{'dirs'}[-1];
    print " -> ";
    print $child->{'file'};
    print "\n";
    return $cont->();
});
#------------------8<------------------ 
```

您能否看一下我的代码并告诉我如何在没有完整路径的情况下制作目录树`$child`？

非常感谢！

最好的问候，
斯科蒂

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T00:50:52.520

您需要使用 的`basename`方法`Class::Path::File`（也可以作为 的方法使用`Class::Path::Dir`）来仅提取路径的最后一个元素。

您还必须使用回调参数来跟踪当前的缩进级别。

该程序似乎可以满足您的要求。

```
use strict;
use warnings;

use Path::Class;

my $dir = dir('/home/scottie/perl/lib/Path-Class-0.25');

$dir->traverse(sub {

  my ($child, $cont, $indent) = @_;
  $indent //= 0;

  if ($indent == 0) {
    print $child, "\n";
  }
  else {
    print '   ' x ($indent - 1), '-> ', $child->basename;
    print '/' if $child->is_dir;
    print "\n";
  }

  $cont->($indent + 1);
}); 
```

# javascript - 制作类似谷歌日历的拖动界面

> ID：10591747
> 
> 赞同：5
> 
> 时间：2012-05-14T22:11:23.477
> 
> 标签：javascript, jquery, draggable

当您使用 Google 日历并想要创建一个新事件时，您可以从开始时间拖动到结束时间，这会在所需范围内创建事件。

我想使用 jQuery 为我的网站实现相同的功能。

有谁知道我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T22:18:06.010

基本思想是有时间“槽”元素，每个元素都指一个特定的时间（通常是 15 分钟间隔）。每个插槽元素都有一个 onmouseup 和 onmousedown 处理程序。mousedown 处理程序在触发时存储该插槽引用的时间并更新一个布尔变量，该变量指示是否正在发生拖动。当 mouseup 被触发时，处理程序检查是否开始拖动，如果是，则确定这是结束槽。您现在有了一个开始时间和结束时间，您可以从那里开始显示一些完成其余预订的对话框。

**演示：** [http](http://www.dstrout.net/pub/appointment.htm)
://www.dstrout.net/pub/appointment.htm 该演示还包括防止文本选择的代码，因为这是拖动的“副作用”。查看代码以了解其工作原理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T23:15:46.893

这是我对这个问题的看法。它以小时为单位，但很容易适应半小时或十五分钟的间隔。

的HTML：

```
<div id="hours">
    <div class="hour">8am</div>
    <div class="hour">9am</div>
    <div class="hour">10am</div>
    <div class="hour">11am</div>
    <div class="hour">...</div>
</div> 
```

Javascript：

```
var dragging;
var yOnMousedown;

$('.hour').mousedown( function(e) {
    e.preventDefault();
    $(this).addClass( 'hour-highlighted' );
    dragging = true;
    yOnMousedown = e.pageY;
} );​​​

$(document).mouseup( function(e) {
    e.preventDefault();
    dragging = false;
} );

$(document).mousemove( function(e) {
    if( dragging ) {
        e.preventDefault();
        $('.hour').each( function() {
            var top = $(this).offset().top;
            var bottom = top + $(this).height();
            if( bottom > yOnMousedown && e.pageY > top )
                $(this).addClass( 'hour-highlighted' );
            else
                $(this).removeClass( 'hour-highlighted' );
        } );
    }
} ); 
```

jsfiddle在这里：http: [//jsfiddle.net/cv9LM/](http://jsfiddle.net/cv9LM/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T22:21:53.313

类似于 mousedown、mousemove 和 mouseup 的东西

```
var dragging = false
$(someelement).mousedown(function(){
    dragging = true;
});

$(body).mousemove(function(){
    // In here you want to do all of the dragging functionality. Try using body,
    // window, document etc to see what works the best.
});

$(body).mouseup(function(){
    dragging = false;
    /* If you use an element here instead of body, document or window, when the
     user moves outside the element and lets go of the mousebutton, the dragging
     won't stop. */
}); 
```

# javascript - Rails 3 Uploadify和Paperclip Param Hash不可用？

> ID：10591749
> 
> 赞同：0
> 
> 时间：2012-05-14T22:11:32.803
> 
> 标签：javascript, ruby-on-rails-3, hashtable, uploadify

当用户通过 Uploadify 输入要与父上传一起提交的新文件 Uload_image 时，我正在调试我的 rails 应用程序。现在它没有保存任何记录，我目前正在调试为什么所以我在我的 upload_image 控制器的 create 方法中删除了一个 require 'debugger' 并评估了 params 哈希，这就是我得到的......

```
{"Filename"=>"sample.pdf", "folder"=>"/uploads/", "upload_id"=>"3", "authenticity_token"=>"gyUCME24FB4PyndTbkrzYZQkLVPtLiJQycnASK/kxbI=", "_pro-template-app-31_session"=>"BAh7CkkiD3Nlc3Npb25faWQGOgZFRkkiJTU4MTBiNzg2Mjg4OGJjNGUzMDY0ZmU0ZjJmMWJjZjFhBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMWd5VUNNRTI0RkI0UHluZFRia3J6WVpRa0xWUHRMaUpReWNuQVNLL2t4Ykk9BjsARkkiGXdhcmRlbi51c2VyLnVzZXIua2V5BjsAVFsISSIJVXNlcgY7AEZbBmkGSSIiJDJhJDEwJHVSSXZYaDREV1p6U0tSMndtLjFRNU8GOwBUSSIOb25saW5lX2F0BjsARlU6IEFjdGl2ZVN1cHBvcnQ6OlRpbWVXaXRoWm9uZVsISXU6CVRpbWUN1REcwCCtBu8GOgtAX3pvbmVJIghVVEMGOwBUSSIfQ2VudHJhbCBUaW1lIChVUyAmIENhbmFkYSkGOwBGSXU7Bw3QERzAIK0G7wY7CEkiCFVUQwY7AFRJIgplcnJvcgY7AEZJIgAGOwBU--feba71517b823faffc30a993cc96455fa2478f71", "_method"=>"post", "format"=>"json", "_http_accept"=>"application/javascript", "Filedata"=>#<ActionDispatch::Http::UploadedFile:0x00000006af6328 @original_filename="sample.pdf", @content_type="application/octet-stream", @headers="Content-Disposition: form-data; name=\"Filedata\"; filename=\"sample.pdf\"\r\nContent-Type: application/octet-stream\r\n", @tempfile=#<File:/tmp/RackMultipart20120514-22783-xg2pm2>>, "Upload"=>"Submit Query", "action"=>"create", "controller"=>"uploads"} 
```

我不知道从哪里开始解析 Filedata 哈希信息作为我可以实际保存的东西......也许我在我的 JS 中做错了什么？...

```
<script type="text/javascript" charset="utf-8">
<%- session_key = Rails.application.config.session_options[:key] -%> 
$(document).ready(function() {
    // Create an empty object to store our custom script data
    var uploadify_script_data = {};

    // Fetch the CSRF meta tag data
    var csrf_token = $('meta[name=csrf-token]').attr('content');
    var csrf_param = $('meta[name=csrf-param]').attr('content');

    // Now associate the data in the config, encoding the data safely
    uploadify_script_data[csrf_token] = encodeURI(encodeURI(csrf_param));

    // Now associate the data in the config, encoding the data safely
    uploadify_script_data[csrf_token] = encodeURI(csrf_param)

    $('.uploadify').uploadify(
    {
        uploader : '/uploadify/uploadify.swf',
        cancelImg : '/uploadify/cancel.png',
        multi : true,
        auto : true,
        script : '/uploads',
        onComplete : function(event, queueID, fileObj, response, data) 
        { 
            var dat = eval('(' + response + ')');
            $.getScript(dat.upload);
        },
        scriptData : 
        {
            '_http_accept': 'application/javascript',
            'format' : 'json',
            '_method': 'post',
            '<%= session_key %>' : encodeURIComponent('<%= u cookies[session_key] %>'),
            'authenticity_token': encodeURIComponent('<%= u form_authenticity_token %>'),
            'upload_id' : '<%= Upload.last.id + 1 %>'
          }
    });

}); 
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T17:44:44.657

好的，就获取上传文件信息而言，答案很简单：

```
@new_upload_image = UploadImage.new(:image => params[:Filedata]) 
```

我还有其他并发症，但我会为此提出一个新问题。

# java - Java 外部类实例生命周期

> ID：10591750
> 
> 赞同：1
> 
> 时间：2012-05-14T22:11:39.823
> 
> 标签：java, class, nested, instance, parent

我对以下内容缺乏理解：如果我使用“速记”创建内部类的实例，即使我没有创建它的显式实例，访问外部类也是一个坏主意吗？

例如，考虑以下代码：

```
class OuterClass
{
    int i;

    OuterClass() { i = 2; }

    class InnerClass
    {
        int get_parent_i() { return (OuterClass.this.i); }
    }
} 
```

以下编译并返回预期结果（2）：

```
OuterClass.InnerClass ic = new OuterClass().new InnerClass();

System.out.println(ic.get_parent_i()); 
```

我的困惑源于这样一个事实，即我没有显式创建 OuterClass 对象来实例化 InnerClass 对象，尽管无论如何似乎都存在。有人能告诉我发生了什么吗，如果我出于任何原因访问或忘记幻影实例？

太感谢了！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T22:15:01.347

`new OuterClass()`如果没有显式创建它的实例，您认为会做什么？:)

您没有明确*存储对它的引用*，但这是另一回事。无论您对结果做什么，调用构造函数都会创建一个实例。内部类有一个对外部类的内置`$this`引用，因此只要您保留内部类，就会始终保留对它的引用。

使用内部类是否是*一个*好主意在历史上是一个有争议的话题，但这种特殊用法并没有什么特别的错误。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-14T22:29:27.703

您的代码的第一块是 100% 可接受且正确的。然而，这种模式经常被用作一个巨大的外部类（例如内部工厂）的内部机制。

关于您的代码的第二个块。如果将（内部和外部类）都公开可见，则不需要创建 OuterClass 的对象。这样 InnerClass 对其余包可见，而无需接触 OuterClass。

然而，如果你在你的例子中这样做，你将有一个 NullPointerException，因为你正在使用部分 Outerclass (i)。

此外，如果你有。

```
public class OuterClass
{
    static int i;

    static {
        i = 3;
    }

    OuterClass() { i = 2; }

    public class InnerClass
    {
        int get_parent_i() { return (OuterClass.this.i); }
    }
} 
```

"i" 将等于 3，除非您将来启动 OuterClass 并将其值更改为 2。

希望我有所帮助！

# html - d3.js 的 HTML5 画布替代品，图形可视化库

> ID：10591753
> 
> 赞同：21
> 
> 时间：2012-05-14T22:11:46.510
> 
> 标签：html, web-applications, html5-canvas, d3.js

是否有任何类似于 d3.js 的 Canvas 库（是 svg 库）。[我在这里](http://www.bunch-it.com)有一个网站，我用 svg 元素编写了一个图表，但是它在智能手机的浏览器上效率不高，而且运行速度很慢。我现在想用它的 2d 画布类型来改变它，看看它是否更好。你能推荐一个对此有用的画布库吗？

谢谢...

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-15T12:49:35.827

D3 不一定是仅 svg 的库 - 在许多情况下都使用 svg，但该库可以执行您想做的任何类型的表示。请参阅 Kai Chang 在 D3 中使用画布的平行坐标示例：http: [//bl.ocks.org/2409451](http://bl.ocks.org/2409451)

另请参阅此处以获取有关性能问题等的一些讨论，这可能会有所帮助：[https ://groups.google.com/d/topic/d3-js/mtlTsGCULVQ/discussion](https://groups.google.com/d/topic/d3-js/mtlTsGCULVQ/discussion)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-04-07T17:08:50.017

我知道我迟到了，但时代变了，我相信这个问题值得一个更新的答案。多年来，SVG 的性能有了很大的提高，尤其是对于非平凡的图形可视化，它通常提供卓越的性能；但这实际上取决于确切的用例：如果可视化很简单并且由数千个元素组成，尤其是在移动设备上，Canvas 可能是更快的选择。如果可视化几乎是微不足道的，那么 WebGL 提供了最好的性能并轻松击败了 Canvas——尤其是在移动设备上！

然而，特别是 WebGL 和 Canvas 比 SVG 使用的声明性方法更难使用。像 CSS 动画和过渡这样的事情很容易用 SVG 完成，并且由于硬件加速并且完全独立于 JavaScript 性能而提供了良好的性能。Canvas 和 WebGL 总是需要 JavaScript。

如果您查看[用于 HTML 的商业图形绘制库 yFiles，](https://www.yworks.com/yfileshtml)您会发现它同时提供了所有三种技术。这是因为这三个都可能是最佳选择，具体取决于确切的用例。

有一篇[博客文章](https://www.yworks.com/blog/svg-canvas-webgl)比较了 SVG、Canvas 和 WebGL 的性能，尤其是在图形可视化的上下文中。它比较了各种图形大小和设备类别。“结论”是没有明确的赢家。很多时候，这三种技术的结合会产生最好的结果。但是，对于较小的图形，SVG 在大多数情况下都能提供非常好的结果，并且使用起来很愉快。这也是 d3.js 专注于 SVG 而不是 Canvas 和 WebGL 的原因，我想说。

该博客条目链接了一个交互式[演示](http://live.yworks.com/demos/view/largegraphs/)，让您可以使用各种技术并了解它们的优缺点。当然demo主要比较了那个库中使用的三种技术，所以你的结果可能会有所不同，但是他们花了很多时间优化那个库中的所有三种技术，所以我认为结果并没有太大的偏差。

^(免责声明：我为创建上述库的公司工作，但我在这里不代表我的雇主。我认为我所说的应该不仅适用于那个图书馆。)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-14T22:35:51.487

对于[Samsung Olympic Genome Project facebook 应用程序](http://www.facebook.com/samsunggenomeproject/app_197458140327772)，我们使用[http://thejit.org](http://thejit.org)为该应用程序制作了力有向图样式的动画。当然，我和我团队中的其他人对它进行了大量修改，在应用程序中只占很小的一部分，但它是一个非常强大的框架。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-03-26T10:20:58.080

Chart.js 是一个刚刚问世的 JavaScript 库，它使用 HTML5 创建图表进行渲染。它不像 D3 那样具有包容性，但它正在努力成为未来的那样。[http://www.chartjs.org/](http://www.chartjs.org/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-12-05T16:26:42.090

看看[Cytoscape.JS](http://cytoscape.github.com/cytoscape.js/)，它使用 HTML5 画布进行渲染。在撰写本文时，它还处于起步阶段，但该项目似乎很有希望。根据其 wiki，该库支持桌面和移动浏览器：

> Cytoscape.js 很容易集成到您的 web 应用程序中，特别是因为 Cytoscape.js 支持桌面浏览器（如 Chrome）和移动浏览器（如 iPad）。

# maven-2 - Maven 替换插件 - 输出目录

> ID：10591755
> 
> 赞同：0
> 
> 时间：2012-05-14T22:12:00.060
> 
> 标签：maven-2, maven-plugin

我正在使用具有以下配置的Maven 替换插件[http://code.google.com/p/maven-replacer-plugin/](http://code.google.com/p/maven-replacer-plugin/)

```
<configuration>
    <includes>
        <include>api/**/*.java</include>
    </includes>
    <token>@Start.*?@End</token>
    <value></value>
    <regexFlags>
        <regexFlag>DOTALL</regexFlag>
    </regexFlags>
    <outputBasedir>publicapi</outputBasedir>
</configuration> 
```

我的项目结构是 ap​​i/src/main/java/...xxx.java。我希望替换插件以这种结构生成文件 - publicapi/src/main/java/...xxx.java 而在当前配置下，插件会生成这样的文件 -publicapi/ **api** /src/main/java/...xxx .java

我不想要介于两者之间的“api”目录。这个插件中是否有任何可用的属性可以解决我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T08:23:49.707

根据文档，您正在搜索的是[outputDirectory 。](http://code.google.com/p/maven-replacer-plugin/wiki/UsageGuide)

# c# - 随机呈现面板超过 20 次

> ID：10591756
> 
> 赞同：0
> 
> 时间：2012-05-14T22:12:07.297
> 
> 标签：c#, windows

所以这里是基本代码：

```
 namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        protected Random random;

        public Form1()
        {
            InitializeComponent();
            random = new Random();
        }

        private void Form1_Load(object sender, EventArgs e)
        { }

        private void button1_Click(object sender, EventArgs e)
        {
            bool button1Clicked = true;
            if (button1Clicked == true) { ITIpanel.Visible = true; }
        }

        private void ITIpanel_Paint(object sender, PaintEventArgs e)
        {
            ITItimer.Enabled = true;
        }

        private void ITItimer_Tick(object sender, EventArgs e)
        {
            double rand = random.NextDouble();
            if (rand < .50d) { bluestimPanel.Visible = true; }
            else if (rand > .5d) { redstimPanel.Visible = true; }

            ITItimer.Enabled = false;
        }

        private void bluestimPanel_Paint(object sender, PaintEventArgs e)
        {
            Trialtimer.Enabled = true;
        }

        private void redstimPanel_Paint(object sender, PaintEventArgs e)
        {
            Trialtimer.Enabled = true;
        }

        private void Trialtimer_Tick(object sender, EventArgs e)
        {
            bluestimPanel.Visible = false;
            redstimPanel.Visible = false;
            Trialtimer.Enabled = false;
            ITIpanel.Visible = true;
        }
    }
} 
```

如您所见，程序本身相当简单。在 ITItimer 的滴答声中，红色或蓝色面板随机出现。我想修改它，如果 ITItimer 总共滴答 10 次，红色和蓝色面板将分别出现 5 次。

我已经研究了一周左右，还没有找到解决方案。关于如何最好地完成此任务的任何想法？

我实际上得到了以下工作：

```
double rand = random.NextDouble();
if (rand < .50d && blue < 5) { bluestimPanel.Visible = true; }
else if (blue == 5) { redstimPanel.Visible = true; }
if (rand > .5d && red < 5) { redstimPanel.Visible = true; }
else if (red == 5) { bluestimPanel.Visible = true; }
if (red >= 5 && blue >= 5) { panel1.Visible = true; } 
```

这并不是世界上最漂亮的东西。但它可以完成工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T23:02:54.473

使用大多数普通库例程的随机数是伪随机性的低质量来源。如果这是一项随机科学研究，这将是您的方案设计中的一个缺陷。

我推荐的方法是将此视为一种随机安排至少 N 次试验的会话的方法，其中有 X 种试验类型。

以下是用于说明该概念的伪代码。

```
Let MinimumTrials be N MOD X + X
Let SessionList be a List<Trial>
For Each TrialType 
    add X instances of that trial type to SessionList
Shuffle(SessionList) 
```

然后，您的会话引擎可以在遍历 SessionList 时调用各个 Trials，以平均分配可能的试用订单。请注意，Shuffle 是一个需要一定程度的技巧才能正确的操作，搜索 SO 是一个很好的起点。

# visual-studio - 描述具有十进制内容和字符串属性的 XML 元素的 XSD 语法？

> ID：10591759
> 
> 赞同：0
> 
> 时间：2012-05-14T22:12:30.710
> 
> 标签：visual-studio, xsd

我已经阅读了 W3C 文档，阅读了教程，阅读了这里的各种帖子，但仍然不明白为什么以下架构定义在 Visual Studio 2010（版本 10.0.4.0219.1）中被标记为无效。

将不胜感激可能提供的任何帮助。这是演示该问题的示例架构定义。

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema 
  attributeFormDefault="unqualified" 
  elementFormDefault="qualified" 
  targetNamespace="http://www.tempuri.org/WhyDoesThisFail" 
  xmlns:xs="http://www.w3.org/2001/XMLSchema" 
  xmlns:why="http://www.tempuri.org/WhyDoesThisFail">

<!-- Write a valid XSD to describe the following:
   <SomeField alias="SomeAlias">1234.5678</SomeField>
-->
<xs:attributeGroup name="FieldAlias">
  <xs:attribute name="alias" type="xs:string" />
</xs:attributeGroup>

<xs:complexType name="DecimalWithAlias">
  <xs:simpleContent>
    <xs:restriction base="xs:decimal">
      <xs:attributeGroup ref="why:FieldAlias" />
    </xs:restriction>
  </xs:simpleContent>
 </xs:complexType>

 <xs:element name="SomeField" type="why:DecimalWithAlias"/>

</xs:schema> 
```

Visual Studio 中显示的消息（xs:restriction 上的蓝色下划线）是：

> 未定义的 complexType "http://www.w3.org/2001/XMLSchema:decimal" 用作复杂类型限制的基础。

其他人表示必须添加 simpleType 或 complexType 来定义基本类型的限制——但我无法做到这一点，而不会收到同样的错误消息。

感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:32:01.220

XSD 有两种不同的继承方式——扩展和限制。这是一个扩展的案例。这个特定[示例](http://www.w3schools.com/schema/el_extension.asp)与您的类似，通过添加属性将简单类型扩展为复杂类型。

# c++ - 收到错误的“对象的 SELECT 权限被拒绝......”以及“未声明游标”。

> ID：10591760
> 
> 赞同：0
> 
> 时间：2012-05-14T22:12:31.287
> 
> 标签：c++, mfc, sql-server-2008-r2

好吧.. 考虑到 SELECT 权限被拒绝错误以及难以涉足所有“您需要在您的表上授予选择权限...”响应，这尤其棘手。但是，我们已经尝试了几个帐户，其中一个具有 db 所有者权限，并且确实可以确认 SELECT 有效。

服务器本身是 2008 R2，带有 2 个 DB。一个是在**SQL 2000 兼容模式下运行**，并且使用 MFC 连接到该数据库可以正常工作。

第二个是2008兼容模式，无论我们使用哪个用户登录，或者我们尝试访问哪个表，我们都会收到**“对象'TABLE'，数据库'db'，模式'dbo'的SELECT权限被拒绝。游标未声明”**

我们使用的连接字符串是：

```
m_TABLENAME.OpenEx(_T("Driver={SQL Server};Server=0.0.0.0\\instance;Database=db;User=user;Password=password;"), CDatabase::noOdbcDialog) 
```

这是使用 Visual Studio 2010，开发站是 Windows XP，但我们也将可执行文件复制到 Win7 机器并收到相同的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T16:21:11.660

这是一个连接字符串问题。“用户”和“密码”应该是“uid”和“pwd”：

```
 "Driver={SQL Server};Server=0.0.0.0\\instance;Database=db;uid=user;pwd=password;" 
```

# jquery - 如何在 .getJSON() 方法中的嵌套 .each() 循环中将“this”传递给函数

> ID：10591762
> 
> 赞同：0
> 
> 时间：2012-05-14T22:12:37.320
> 
> 标签：jquery, json, scope, this, each

所以我知道问题是什么，但我不知道修复它的正确方法（语法）。

如果您从“myFunction”获取代码并将其放入我调用“myFunction”的 .each 循环中，那么我的代码可以工作，因为“this”正在被定义并且在我引用的 JSON 对象的范围内。

但是，当我编写函数并在 JSON 对象范围之外声明它时，它不再知道“this”是什么并返回“undefined”值。

如何将“this”作为参数传递给我的函数，以便正确获取值？

```
 $.getJSON('labOrders.json', function(json) {
    var aceInhibitors = "",
        antianginal = "",
        anticoagulants = "",
        betaBlocker = "",
        diuretic = "",
        mineral = "",
        myFunction = function () {
            aceInhibitors += "<div class='row drugLineItem'>",
            aceInhibitors += "<div class='columns moneydot' style='background:none;'></div>",
            aceInhibitors += "<div class='columns drugTitleWrap'>",
            aceInhibitors += "<div class='row drugTitle'>"+this.name+"</div>",
            aceInhibitors += "<div class='row drugDose'>"+this.strength+"</div>",
            aceInhibitors += "<div class='columns'></div>",
            aceInhibitors += "<div class='columns orderDeets dxRefill'>"+this.refills+"</div>",
            aceInhibitors += "<div class='columns orderDeets dxPillCount'>"+this.pillCount+"</div>",
            aceInhibitors += "<div class='columns orderDeets dxSig'>"+this.sig+"</div>",
            aceInhibitors += "<div class='columns orderDeets dxRoute'>"+this.route+"</div>",
            aceInhibitors += "<div class='columns orderDeets drugTab'>"+this.dose+"</div>"
        }

  $.each(json.medications, function(index, orders) {
    $.each(this.aceInhibitors, function() {
        myFunction();

    });
    $.each(this.antianginal, function() {

    });
  });

  $('#loadMedSections').append(aceInhibitors);

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T22:18:45.493

你有两个选择：

```
 $.each(this.aceInhibitors, myFunction); 
```

不需要包装器函数，它会有正确的上下文。

第二种选择：

```
$.each(this.aceInhibitors, function() {
    myFunction.call(this);
}); 
```

这将把它称为包装函数上下文的上下文。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:19:31.253

有一个名为 的函数`call`，它允许您为 设置显式值`this`。

例如，如果您执行以下操作：

```
myFunction.call(someobject); 
```

然后`myFunction`将被调用`this = someobject`。

在您的情况下，您可能可以这样做：

```
$.each(this.aceInhibitors, function() {
  myFunction.call(this); // will use the current value of "this" inside myFunction as well.
}); 
```

# ssas - SSAS大维度

> ID：10591763
> 
> 赞同：0
> 
> 时间：2012-05-14T22:12:40.027
> 
> 标签：ssas, cube

我有一个 SSAS 多维数据集，其中我的一个维度有 500 万个记录。当我尝试查看维度的数据时，报表或 Excel 数据透视表变得冗长，而且性能也很差。我无法对特定维度数据进行分类。我能想到的限制数据的唯一方法是从具有度量值的维度中选择前 10K 行。除了将其限制为前 10K 维度记录之外，任何人都可以建议其他可能性吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:27:27.777

你设置聚合了吗？我冒昧地猜测，将数据带到观察点所花费的大部分时间都与您的措施有关。如果我是你，我会尝试添加聚合或提高聚合百分比，以便通过将此工作负载传递给维度/多维数据集的处理时间来减轻查询时的一些压力。

通常，人们将他们的聚合水平设置在 30% 左右开始。

如果您已经这样做了，我会考虑在您的多维数据集所在的服务器上升级您的硬件。（取决于你已经拥有的）

这些只是建议，因为它也可能是您的多维数据集设计中的一个问题，导致运行时间过长。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-23T05:46:42.450

我建议您创建一个层次结构来显示 500 万条记录。按级别 1 中的子字符串分组，（如果需要级别 2 中的某些字符），然后是属于该组的数据。例如 ：

```
Level 1           Value
A                 Apple
A                 Ant 
```

这意味着您不会一次显示所有 500 万条记录，而且现在使用聚合也非常有效。

# html - 谷歌地图地面覆盖的 canvas.toDataURL

> ID：10591765
> 
> 赞同：1
> 
> 时间：2012-05-14T22:12:57.127
> 
> 标签：html, google-maps, html5-canvas

Google 地图 API 都不支持旋转地图叠加层的功能。对于我正在编写的应用程序，我需要将地图叠加层旋转到任意角度。

所以我想我可以将我的图像资源渲染到一个画布上，比如：

```
 overlay = new Image();
overlay.onload = function(){
    if (context != false){
        context.translate(canvas.width / 2, canvas.height / 2);
        context.rotate(Math.PI / 4);
        context.drawImage(overlay,0,0,67,360);

    }
};
overlay.src = 'myimage.png'; 
```

使用 Google 地图 API，我现在可以创建一个地面叠加层：

```
var thing = new google.maps.GroundOverlay(href, bounds); 
```

其中 href 是 canvas.toDataURL('image/png');

不幸的是，上述想法行不通。目前它仅适用于实际的图像 url，例如[http://www.mydomain/theimage.png](http://www.mydomain/theimage.png)

寻找文档似乎可以使用画布来呈现自定义标记

[如何创建类似谷歌纵横的标记？](https://stackoverflow.com/questions/5792533/how-to-create-google-latitude-like-markers)

但我需要这个才能用于地面覆盖。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T07:46:10.947

画布绝对可以用作图像源。`toDataURL`准确地为您提供它所说的内容，并且数据 URL 可以与支持它们的浏览器中的图像 URL 互换（在大多数情况下）。正如广泛指出的那样，您首先要受到相同来源的限制才能获取数据 URL，但如果图像来自同一个域（或正确启用了[CORS](http://enable-cors.org/)），那应该不是问题。

无法查看您的代码以了解发生了什么，这里有一个关于 jsbin 的工作示例：

[JSBin：Canvas.toDataURL 覆盖](http://jsbin.com/onudem/2)

（它在画布上绘制了许多小图像，而不是像您在帖子中提到的更大的旋转图像，但希望这能提供足够的想法）。

关键部分：

```
var canvasImage = canvas.toDataURL('image/png');

var canvasOverlay = new google.maps.GroundOverlay(
    canvasImage,
    overlayLatLngBounds);
canvasOverlay.setMap(map); 
```

没有理由在其他地方不起作用。确保仔细检查控制台是否存在任何可能的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T03:41:45.727

`toDataURL`只有在遵守[同源政策](https://developer.mozilla.org/en/Same_origin_policy_for_JavaScript)的情况下，使用 Canvas生成图像才会有效。

# asp.net - ASP.NET CrystalReportViewer 静态标题

> ID：10591766
> 
> 赞同：0
> 
> 时间：2012-05-14T22:12:59.743
> 
> 标签：asp.net, crystal-reports

是否有人对如何将静态标题添加到 ASP.NET Web 应用程序的 CrystalReportViewer 中显示的 Crystal Report 有任何想法？当用户向下滚动报告中的数据时，我需要标题标签保持可见。

谢谢，

詹姆士

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T04:47:01.137

请不要为此浪费时间进行研究。Crystal Reports 中没有支持浮动标题的功能。

# iphone - 哪里可以下载 iPhone 系统声音文件

> ID：10591770
> 
> 赞同：1
> 
> 时间：2012-05-14T22:13:30.073
> 
> 标签：iphone, ios

我需要在我的应用程序中播放 iPhone 系统声音文件，例如，消息发送、消息接收。

我期待在 iOS 中默认找到这些声音文件，但如果我错了，请纠正我。

是否可以下载这些默认系统 iPhone 声音。我主要需要发送消息，接收消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:27:08.950

要在您的应用程序中使用声音，您需要自己创建这些声音，或者从许多不同的网站购买声音效果。由于您的应用程序是沙盒化的，因此您无法访问 SMS 发送/接收声音*（例如）*。我也怀疑 Apple 会允许你“窃取”他们的声音以便在你的应用程序中使用。尝试搜索免费音效，[一个例子](http://www.grsites.com/archive/sounds/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T02:26:35.093

为了补充 WrightCS 所说的内容，Apple 明确表示，您被允许使用的唯一媒体资产（声音和图片）是他们明确提供的媒体资产。如果您尝试使用他们的声音，他们肯定会拒绝您的应用。

他们也不希望您将他们的媒体用于他们打算做的事情之外的任何事情。如果他们的人机界面人员发现有人将他们精心挑选的 UI 元素重新用于其他用途，他们就会有一大堆小猫，并且会以极端的偏见拒绝您的应用程序。

简而言之，不要这样做。它会让你被拒绝。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-05T17:25:35.570

这些资源应该可以帮助您入门。

[https://github.com/TUNER88/iOSSystemSoundsLibrary](https://github.com/TUNER88/iOSSystemSoundsLibrary)

[https://developer.apple.com/library/ios/documentation/AudioToolbox/Reference/SystemSoundServicesReference/Reference/reference.html](https://developer.apple.com/library/ios/documentation/AudioToolbox/Reference/SystemSoundServicesReference/Reference/reference.html)

# linux - 使用 bash 脚本比较两个文件并写入新文件

> ID：10591775
> 
> 赞同：0
> 
> 时间：2012-05-14T22:14:01.647
> 
> 标签：linux, bash

我是 bash 脚本的新手，想编写一个 bash 脚本来执行以下操作。我有两个制表符分隔的文件，如下所示：

```
# file1 #
## position id 
.
.
.

# file2
## position type
. 
.
. 
```

文件 2 是关于位置列的文件 1 的子集。我想生成file3，这样对于file2中的每一行，它都会在file1中查找具有相同位置的行并将以下内容写入file3

```
position id type
.
.
. 
```

所以，我想基本上找到 file1 和 file2 （第一列）之间的共同位置，并将它们连同它们的 id 和类型（各自文件中的第 2 列）一起写出来。我知道如何使用 python 来做到这一点，但我想学习如何使用 bash 脚本来执行这样的过程 - 我将不胜感激上述问题的任何示例代码。

> 额外说明：

每列的值如下

*   位置：chr1:887799
*   编号：R2A
*   类型：字母字符串

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T22:23:00.783

```
join -a 1 <(sort file1) <(sort file2) 
```

应该带你到那里

join 的手册页有更多的背景和示例：

*   [http://linux.die.net/man/1/join](http://linux.die.net/man/1/join)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-14T22:22:20.207

首先，您需要使文件以制表符分隔，然后就像

```
join -j 1 first.txt second.txt 
```

# java - 使用自定义安全标头请求后，WSIT 不理解 SOAP 安全标头

> ID：10591777
> 
> 赞同：4
> 
> 时间：2012-05-14T22:14:11.527
> 
> 标签：java, soap, wsit, wcf-interoperability

我正在使用 Metro/WSIT 库编写 Java Web 服务客户端，而我需要访问的 Web 服务是 WCF 服务。（我几乎无法控制服务端和 WSDL。）

Web 服务使用传输级安全性 (SSL) 和使用安全令牌服务 (WS-Trust/WS-Security) 的联合安全模型来保护。我使用 Windows Identity Foundation 在 .NET 中轻松实现了客户端，首先发出安全令牌，然后使用 ( [CreateChannelWithIssuedToken](http://msdn.microsoft.com/en-us/library/ee708924.aspx) ) 方法向其他 Web 服务发出请求。

不过，使用 Metro/WSIT 时，我很难在 Java 中模仿这种行为。据我了解，由于 WSDL 中缺少 WS-Policy 信息，WSIT 不会启用与服务通信的安全处理。在发送请求之前，我通过操作 SOAP 请求标头来手动完成此操作，现在我收到的消息与我在 .NET 客户端收到的消息相同。

现在，我的问题是我收到以下错误：

```
Exception in thread "main" javax.xml.ws.soap.SOAPFaultException: MustUnderstand headers:[{http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd}Security] are not understood
at com.sun.xml.ws.protocol.soap.MUTube.createMUSOAPFaultException(MUTube.java:148)
at com.sun.xml.ws.protocol.soap.ClientMUTube.processResponse(ClientMUTube.java:96)
at com.sun.xml.ws.api.pipe.Fiber.__doRun(Fiber.java:972)
at com.sun.xml.ws.api.pipe.Fiber._doRun(Fiber.java:910)
at com.sun.xml.ws.api.pipe.Fiber.doRun(Fiber.java:873)
at com.sun.xml.ws.api.pipe.Fiber.runSync(Fiber.java:775)
at com.sun.xml.ws.client.Stub.process(Stub.java:429)
at com.sun.xml.ws.client.sei.SEIStub.doProcess(SEIStub.java:168)
at com.sun.xml.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:119)
at com.sun.xml.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:102)
at com.sun.xml.ws.client.sei.SEIStub.invoke(SEIStub.java:151) 
```

因为 SOAP 响应在标头中有一个 Security 部分：

```
<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:u="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
<s:Header>
    <o:Security s:mustUnderstand="1" xmlns:o="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
        <u:Timestamp u:Id="_0">
            <u:Created>2012-05-14T21:20:08.782Z</u:Created>
            <u:Expires>2012-05-14T21:25:08.782Z</u:Expires>
        </u:Timestamp>
    </o:Security>
</s:Header>
<s:Body>
    ... 
```

鉴于我无法修改 WSDL，有没有办法可以手动强制 Metro/WSIT 启用响应的安全处理，以免引发此异常？我不打算使用安全标头，并且响应的有效负载符合预期。我知道如果客户端不理解 mustunderstand="1" 的标头，我所看到的是正确的行为，但我正在寻找一种方法来抑制此异常。

我已经阅读了其他问题，例如[这个](https://stackoverflow.com/questions/2555029/wsit-metro-doesnt-understand-security-soap-header)问题，这似乎与我想要的很接近，但我还没有找到答案。任何建议/解决方案/等。不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:09:20.110

我找到了一种解决方法（暂时适用），其中涉及插入 Metro 处理管道的自定义“管”。

I created a custom processing tube class that extends `com.sun.xml.ws.api.pipe.helper.AbstractFilterTubeImpl`, and overrides `processResponse( Packet packet )`, searching for headers with the name "Security" and calling `packet.getMessage().getHeaders().understood( int )` for the index in the header list of the security header I found. This prevents processing down the tube from trying to understand the security headers (since the problem is that it doesn't).

After this I created a tube factory (implementing `com.sun.xml.ws.assembler.TubeFactory`) for my custom tube.

I then copied the contents of webservices-rt.jar/META-INF/metro-default.xml to META-INF/metro.xml in my project, and added a `<tube-factory>` element for my factory class; under `<client-side>` I put it just above the transport tube factory, and under `<endpoint-side>` I put it at the top of the list, above the transport tube factory.

Hopefully this helps anybody with a similar problem. Being able to add custom processing to the Metro pipeline seems immensely powerful but also dangerous; YMMV.

# jquery - 父级中的 jQuery

> ID：10591778
> 
> 赞同：-2
> 
> 时间：2012-05-14T22:14:18.883
> 
> 标签：jquery

我在将代码推送到父窗口时遇到问题。它目前在 iFrame 中，我已经为此烦恼了一段时间。我对父函数的经验很少。任何帮助都会很棒，谢谢！

```
 $(document).ready(function(){
      $("a[rel*=2gain]").facebox({
           loadingImage : 'rc/loading.gif',
           closeImage   : 'rc/closelabel.png'
      });
 }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:18:30.627

您必须从父文档和 jQuery 对象的上下文中进行操作。

**来自 IFRAME**

```
$(function() {
    var $p = window.parent.$;
    $p("a[rel*=2gain]").facebox({
           loadingImage : 'rc/loading.gif',
           closeImage   : 'rc/closelabel.png'
      });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T22:18:06.783

你试过`parent.document`吗？

```
$(document).ready(function(){
      $(parent.document).find("a[rel*=2gain]").facebox({
           loadingImage : 'rc/loading.gif',
           closeImage   : 'rc/closelabel.png'
      });
 }); 
```

# asp.net-mvc - MVC中的简单jqgrid删除

> ID：10591781
> 
> 赞同：0
> 
> 时间：2012-05-14T22:14:33.337
> 
> 标签：asp.net-mvc, jqgrid

我一直在网上寻找答案，也许它比我预期的更复杂（或者我只是不理解解决方案），但我正在寻找一种方法来简单地从我的 jqgrid 通过单击垃圾桶图标。

目前我的网格正在填充 Linq to SQL 数据。这是我的网格：

```
jQuery("#grid").jqGrid({
                     url: '<%= ResolveUrl("~/Home/GetData") %>',
                     datatype: "json",
                     mtype: 'GET',
                     postData: { DDLid: function () { return jQuery("#DDL option:selected").val(); } },
                     colNames: ['Col1', 'Col2'],
                     colModel: [
                        { name: 'Col1', index: 'Col1', width: 200, editable: false },
                        { name: 'Col2', index: 'Col2', width: 200, editable: false }
                        ],
                     jsonReader: {
                         repeatitems: false
                     },
                     rowNum: 10,
                     pager: jQuery('#gridpager'),
                     sortname: 'Type',
                     viewrecords: true,
                     sortorder: "asc",
                     caption: "Table"
                 }).navGrid('#gridpager', { del: true, add: false, edit: false, search: false }, {}, {}, {url: "Delete"}); 
```

现在 post 数据中的 'id' 不是该表中的主键 - 我只需要它来帮助填充网格。我想得到的是选定的行 id 并将其传递给 Delete 方法，但我找不到任何方法来做到这一点。

我曾尝试`jQuery("#grid").getGridParam('selrow')`在 postData 中使用，但它总是返回 null。

任何帮助将不胜感激。

这是我的删除方法，供参考：

```
[AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Delete(int DDLid) 
    {
        int row = Convert.ToInt32(/*I NEED THIS ID*/);
        var query = from x in _ctx.DataTable
                    where ((x.id == row))
                    select x;
        _ctx.DataTable.DeleteOnSubmit(query.Single());
        _ctx.SubmitChanges();
        return Json(true);
    } 
```

这个方法被调用并且很好，但是我得到了错误的 id。我需要所选行的 ID。这会中断，因为 DDLid 返回不止一行（因为它用于填充网格）。

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:29:13.643

我发现我将在哪里传递选定的索引（但后来我意识到我正在寻找主键，而不是选定的索引，但无论如何它都是相同的结果）

我需要将此添加到我的导航网格中：

```
 {url: "Delete", mtype: "POST", reloadAfterSubmit: true, 
       serializeDelData: function (postdata) {
                         var selectedrowindex = jQuery("#grid").jqGrid('getGridParam', 'selrow');
                         var dataFromCellByColumnIndex = jQuery('#grid').jqGrid ('getCell', selectedrowindex , 1); 
                         return {DDLid: postdata.id, name: dataFromCellByColumnIndex};
       }
 }); 
```

因此，这会将列值传递给我的删除方法以及 DDLid，但我可以轻松地将 dataFromCellByColumnIndex 与 selectedrowindex 交换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T22:29:16.057

您应该只执行`Delete`具有`id`参数的操作：

```
public JsonResult Delete(string id) {
    ...
} 
```

要引用我将使用的 JavaScript 代码中的操作，`'url: <%= Url.Action("Delete") %>'`而不是`url: "Delete"`您当前使用的操作。

您可以[在此处下载我为](http://www.ok-soft-gmbh.com/jqGrid/jqGridAutorefresh.zip)[答案](https://stackoverflow.com/a/10461964/315935)创建的演示项目。该项目实现了行的删除以及您当前不需要的许多其他功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T04:46:37.423

您可以使用自己的参数在 delete 方法中创建另一个帖子。定义网格后，您可以详细定义每个动作。它正在使用正确的 ID 发布实际删除，而原始的正在发布虚假 ID。JQgrid 使用行计数来删除而不是主键。他们可能会用最近的版本来改变它，但这是工作 Jqgrid 3.8

```
 jQuery("#ClientGrid").jqGrid('navGrid', '#ClientGridPager',
{ view: true, edit: true, search: false }, //options
{height: 240, caption: 'Edit Client', beforeShowForm: hideIDColumn, reloadAfterSubmit: true, mtype: 'POST', url: "/Settings/EditClient", jqModal: false, closeOnEscape: true, bottominfo: "Fields marked with (*) are required" }, // edit options
{height: 340, caption: 'Add Client', beforeShowForm: hideIDColumn, reloadAfterSubmit: true, mtype: 'POST', url: "/Settings/CreateClient", jqModal: false, closeOnEscape: true, bottominfo: "Fields marked with (*) are required", closeAfterAdd: true }, // add options
//delete method
{reloadAfterSubmit: true, beforeSubmit: function (postdata, formid)
{
    var lastselectedID = -1;
    if (ClientGridrow != null || typeof (ClientGridrow) != "undefined")
    {
        lastselectedID = $("#ClientGrid").getCell(ClientGridrow, 'ID_PK');
    }
    //CUSTOME delete to send taskid instead of rowid
    $.ajax({ type: "POST", url: "/Settings/DeleteClient/?objid=" + lastselectedID,
        data: "", success: function (response)
        {
            $("#ClientGrid").trigger("reloadGrid"); //reloadAfterSubmit: true is not working in Chrome
        }
    });
    return [true, "Delete failed message"];

}, caption: 'Delete Client', datatype: 'local', url: "/Settings/DeleteClient/?objid=-1", jqModal: false, closeOnEscape: true
}, // del options..we make two posts
  {closeOnEscape: true }, // search options
  {height: 230, width: 350, jqModal: false, closeOnEscape: true} // view options
   ); 
```

# php - 如何在版本控制下处理特定于平台的代码

> ID：10591788
> 
> 赞同：1
> 
> 时间：2012-05-14T22:15:52.830
> 
> 标签：php, svn, version-control

我们在 Windows 和 Linux 上都有使用 SVN 的 Web 开发人员。一些 PHP 文件引用本地路径（例如 Smarty/Geolocation 库），因此在它们各自的平台上是不同的。我们需要保持这些文件处于修订状态，但开发人员开始只是在这些特定文件上添加 svn:ignore 属性以防止冲突。我能想出的唯一解决方案是放置一些代码来确定正在运行的操作系统，但这对于生产代码来说似乎很臃肿。

```
if (PHP_OS == "WIN32" || PHP_OS == "WINNT") {
        define('SMARTY_DIR', 'c:/xampp/smarty/');
    } else { 
        define('SMARTY_DIR', '/usr/local/lib/php/Smarty/');
    } 
```

我很想听听其他人是如何解决这个问题的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T23:34:45.070

执行此操作的典型方法是使用 config.php.template 文件。模板文件受版本控制，开发人员将其复制到 config.php 以进行本地设置。

# c++ - 使用 compareandswap() 实现线程安全链表

> ID：10591791
> 
> 赞同：1
> 
> 时间：2012-05-14T22:16:38.913
> 
> 标签：c++, thread-safety, linked-list

我试图了解线程安全。想象一下我实现了一个简单的链表（只是我熟悉的一个例子），我有一个从列表中删除给定节点的函数。我被告知了这个功能

int CompareAndSwap(int *address, int oldvalue, int newvalue);

这是我必须用来确保线程安全的唯一方法，我能想象如何使用的唯一方法是发送 oldvalue 和 newvalue 节点的内存地址，但是从节点指针转换为 int 会失去精度并导致编译器错误所以很明显我用错了。

有人可以给我一个在这种情况下如何使用它的例子吗？谢谢。

# python-2.7 - Python Pandas：聚合从 0.7.1 更改为 0.7.3

> ID：10591796
> 
> 赞同：1
> 
> 时间：2012-05-14T22:17:20.967
> 
> 标签：python-2.7, pandas

由于某种原因，我编写并使用 0.7.1 的脚本不适用于 0.7.3

我恢复到 0.7.1，一切正常。问题似乎与聚合方法有关。我正在对`agg`不同的列（`np.mean`，`np.sum`...等）使用不同聚合方法的字典。使用 0.7.3 运行时，这会引发

> ```
> "No numeric values to aggregate" 
> ```

错误。

对此有什么想法吗？我想让一切都在 0.7.3 版本中工作......也许一些语法改变了？

# basic-authentication - 使用 HTML5 音频播放安全的音频流

> ID：10591798
> 
> 赞同：9
> 
> 时间：2012-05-14T22:17:28.370
> 
> 标签：basic-authentication, html5-audio

是否可以使用 HTML5 音频标签播放受保护的流？我正在播放的流是受密码保护的（HTTP 基本身份验证），我如何提供凭据？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-04T11:18:41.610

在**源**标签中使用特殊的 HTTP URL 格式[http://username:password@example.com/your_stream](http://username:password@example.com/your_stream) - 这会在标准 HTTP“授权”标头中发送凭据。

# html - 告诉IE9使用兼容模式？

> ID：10591803
> 
> 赞同：0
> 
> 时间：2012-05-14T22:18:01.020
> 
> 标签：html, ie8-compatibility-mode

我有一张JetPhoto软件生成的项目体验图……太棒了，正是我需要的。不幸的是，它似乎卡在了 IE9 中。如果我告诉 IE9 使用“兼容模式”，所有引脚都可以正常加载（就像在其他所有浏览器中一样）。投资组合在这里：[http ://www.aboutcis.com/experience/](http://www.aboutcis.com/experience/)

有没有办法告诉 IE9 为所有用户在兼容性视图中加载页面？

我不太喜欢 HTML（与我学习它时相比，它变得如此复杂），但我遇到了以下标签......

```
<meta http-equiv="X-UA-Compatible" content="IE=7"> 
```

这是此标签的预期用途吗？我在正确的轨道上吗？有没有人有提示或想法可以帮助我理解如何克服这个问题？这可能是一个 DOCTYPE 问题（我对此一无所知）？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T22:21:44.307

兼容模式的语法是：

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9" > 
```

content 属性指定页面的模式；要模仿 Internet Explorer 7 的行为，请指定 IE=EmulateIE7。指定 IE=5、IE=7、IE=8 或 IE=9 以选择其中一种兼容模式。您还可以指定 IE=edge 来告诉 Internet Explorer 使用可用的最高模式。

**了解文档兼容模式**

Internet Explorer 支持多种文档兼容性模式，这些模式可启用不同的功能并影响内容的显示方式：

*   IE9 模式为已建立和新兴的行业标准提供最高支持，包括 HTML5（工作草案）、W3C 级联样式表第 3 级规范（工作草案）、可缩放矢量图形 (SVG) 1.0 规范等。
*   IE8 模式支持许多已建立的标准，包括 W3C Cascading Style Sheets Level 2.1 Specification 和 W3C Selectors API；它还为 W3C 级联样式表第 3 级规范（工作草案）和其他新兴标准提供有限的支持。
*   IE7 模式呈现内容，就好像它是由 Internet Explorer 7 在标准模式下显示的一样，无论页面是否包含`<!DOCTYPE>` 指令。
*   模拟 IE9 模式告诉 Internet Explorer 使用该`<!DOCTYPE>` 指令来确定如何呈现内容。标准模式指令以 IE9 模式显示，怪癖模式指令以 IE5 模式显示。与 IE9 模式不同，Emulate IE9 模式尊重该 `<!DOCTYPE>`指令。
*   模拟 IE8 模式告诉 Internet Explorer 使用该`<!DOCTYPE>` 指令来确定如何呈现内容。标准模式指令以 IE8 模式显示，怪癖模式指令以 IE5 模式显示。与 IE8 模式不同，Emulate IE8 模式尊重该 `<!DOCTYPE>`指令。
*   Emulate IE7 模式告诉 Internet Explorer 使用该`<!DOCTYPE>` 指令来确定如何呈现内容。标准模式指令以 Internet Explorer 7 标准模式显示，怪癖模式指令以 IE5 模式显示。与 IE7 模式不同，Emulate IE7 模式尊重该`<!DOCTYPE>`指令。对于许多网站来说，这是首选的兼容模式。
*   IE5 模式呈现内容，就好像它是由 Internet Explorer 7 以 quirks 模式显示的一样，这与 Microsoft Internet Explorer 5 中显示内容的方式非常相似。
*   边缘模式告诉 Internet Explorer 以可用的最高模式显示内容。对于 Internet Explorer 9，这相当于 IE9 模式。如果 Internet Explorer 的（假设的）未来版本支持更高的兼容性模式，则设置为边缘模式的页面将以该版本支持的最高模式显示。当使用 Internet Explorer 9 查看时，这些相同的页面仍会以 IE9 模式显示。

由于边缘模式文档使用用于查看网页的 Internet Explorer 版本可用的最高模式显示网页，因此建议您仅将此文档模式用于测试目的。请勿将其用于生产用途。

有关 IE 兼容模式的更多信息，请查看[此](http://msdn.microsoft.com/en-us/library/cc288325%28v=vs.85%29.aspx)内容。

# google-apps-script - 从函数更新锚点

> ID：10591806
> 
> 赞同：0
> 
> 时间：2012-05-14T22:18:17.467
> 
> 标签：google-apps-script

在我的过程中，我有一个页面，用户可以从列表框中选择各种项目。这些值是电子表格中的一个单元格。该电子表格的另一列包含电子表格的 URL。因此，在用户从列表框中选择值后，包含 URL 的单元格将使用 createServerClickHandler 存储到变量中。我已经可以做的就是将该 URL 传递回显示 URL 的主页上的文本框。我想做的是在主页上显示一个锚点，以便用户可以单击它来打开列表框中当前选择的电子表格。

`var urlText = 'Click here to see selected spreadsheet'; var urlLink = bldrapp.createAnchor(urlText, **urlURL**).setId('spreadsheetURL').setVisible(true);`

从我的功能（e） `app.getElementById('infoURL').setText(**docToProcessURL**).setVisible(true);`

'infoURL' 是我在主页上的文本框。是否可以将该值传递给锚点中的“urlURL”？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T23:27:47.197

是的，你可以这样做：

```
app.getElementById('spreadsheetURL').setHref(docToProcessURL); 
```

# c# - 如何监控console.out？

> ID：10591814
> 
> 赞同：1
> 
> 时间：2012-05-14T22:19:15.697
> 
> 标签：c#, stream, console, tracelistener

如果我看到一些关键词出现在`Console.Out`. 这是因为我们使用了第三方 DLL，它有一个问题，即当它遇到某些特定异常时它永远不会退出。

对我们来说唯一的不满似乎是监视填充回的日志`console.Out`。并且基于登录`console.out`，主机应用程序可以决定遇到此类异常时要做什么。

有人告诉我，我可以使用跟踪侦听器......但我不确定。你们有什么感想？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T22:26:15.477

该类`Console`提供了[**`SetOut`**](http://msdn.microsoft.com/en-us/library/system.console.setout.aspx)可用于将输出写入自定义流的方法。例如，您可以流式传输到 StringBuilder 并监视更改，或者编写监视关键字的自定义流实现。

例如，这是一个`KeywordWatcherStreamWrapper`监视指定关键字的类，并在看到关键字时为所有侦听器引发一个事件：

```
public class KeywordWatcherStreamWrapper : TextWriter
{
    private TextWriter underlyingStream;
    private string keyword;
    public event EventHandler KeywordFound;
    public KeywordWatcherStreamWrapper(TextWriter underlyingStream, string keyword)
    {
        this.underlyingStream = underlyingStream;
        this.keyword = keyword;
    }

    public override Encoding Encoding
    {
        get { return this.underlyingStream.Encoding; }
    }

    public override void Write(string s)
    {
        this.underlyingStream.Write(s);
        if (s.Contains(keyword))
            if (KeywordFound != null)
                KeywordFound(this, EventArgs.Empty);
    }

    public override void WriteLine(string s)
    {
        this.underlyingStream.WriteLine(s);
        if (s.Contains(keyword))
            if (KeywordFound != null)
                KeywordFound(this, EventArgs.Empty);
    }
} 
```

示例用法：

```
var kw = new KeywordWatcherStreamWrapper(Console.Out, "Hello");
kw.KeywordFound += (s, e) => { throw new Exception("Keyword found!"); };

try {   
    Console.SetOut(kw);
    Console.WriteLine("Testing");
    Console.WriteLine("Hel");
    Console.WriteLine("lo");
    Console.WriteLine("Hello");
    Console.WriteLine("Final");
} catch (Exception ex) { Console.Write(ex.Message); } 
```

在包含整个关键字的第二`Write`条语句中，将引发事件并因此引发异常。另请注意，这会默默地包装底层流并仍对其进行写入，因此仍会正常生成控制台输出。

样本输出：

```
Testing
Hel
lo
Hello
Keyword found! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T22:26:26.333

如果你可以把它包装成一个 exe，也许你可以使用 Process.StandardOutput。

# jquery - 将 Google 地图标记绑定到非地图侧边栏条目

> ID：10591816
> 
> 赞同：0
> 
> 时间：2012-05-14T22:19:23.917
> 
> 标签：jquery, google-maps, binding, google-maps-markers, sidebar

我正在尝试在 Google Map V3 标记和地图外边栏条目上的事件侦听器之间添加 2 路绑定。我寻求实现这一目标的示例，但无法找到最佳实践。在 Google Maps API V3 发布后，ESA 2009 能够在侧边栏条目和标记之间建立这种类型的关联。是否有一种现代方法可以实现这一点，可能使用 jQuery.Callbacks()？这个[ESA 2009 示例](http://koti.mbnet.fi/ojalesa/boundsbox/makemarker_sidebar.htm)已经使用了 3 年，但是很少有（如果有的话）成功的模拟实现能够在标记和相应的非地图侧边栏条目之间干净地复制 ESA 2009 优雅的双向绑定功能。[这个插件](http://www.bjornblog.com/web/jquery-store-locator-plugin#more-109)是一个很好的开始，但是当直接单击标记时，JQuery 缺乏突出或识别所选侧边栏项目的能力。

ESA 2009 方法在 SidebarItem() 和 makeMarker() JS 函数中使用内部函数、闭包和原型来建立侧边栏条目和标记之间的双向绑定。单击标记时，侧边栏条目会突出显示（反之亦然），而不会出现明显的内存泄漏或过度递归。ESA 2009 技术在概念上对我来说很难掌握或扩展。这种行为很有用，但没有被广泛采用。当用户单击侧边栏项目时，会出现典型的 Google 地图行为：地图平移和信息窗口打开。这是标准的，但在 ESA 2009 版本中还有一个额外的部分，即非地图侧边栏项目监听和响应（通过带有焦点的 CSS）到相应的标记点击。这种 2-way listener 效果很难通过 JQuery 移植，或者很难在任何最近的商店定位器解决方案中本地合并。所需的功能是：

> **当用户单击标记或其侧边栏条目时，现有突出显示将被清除并打开选定的信息窗口并并行识别相应的侧边栏项目......反之亦然。**

实现这种有用效果的最佳实践是什么？有谁知道集成双向触发器的当前示例？如何在从 Google 服务器呈现的特定标记与同一页面上但在地图之外（例如，侧边栏项目）的相应事件侦听器之间实现最佳链接。我们是否应该使用任何 JQuery 最新的（1.7）回调处理功能？有更好的非 JQuery 技术吗？

下面是“最先进的”熟悉的片段，在名为“map”的 Map() 上创建 Marker 和 InfoWindow，并在名为“sidebar”的 DIV 中创建侧边栏行，其中 markerArray 和 markerBounds 收集标记。SidebarItem() 构造函数由 ESA 2009 的优秀示例中的 makeMarker() 函数调用：

```
 var infoWindow = new google.maps.InfoWindow();
 var markerBounds = new google.maps.LatLngBounds();
 var markerArray = [];

    function makeMarker(options){
    var pushPin = new google.maps.Marker({map:map});
    pushPin.setOptions(options);
    google.maps.event.addListener(pushPin, "click", function(){
      infoWindow.setOptions(options);
      infoWindow.open(map, pushPin);
      if(this.sidebarButton)this.sidebarButton.button.focus();
    });
    var idleIcon = pushPin.getIcon();
    if(options.sidebarItem){
      pushPin.sidebarButton = new SidebarItem(pushPin, options);
  pushPin.sidebarButton.addIn("sidebar");
}
markerBounds.extend(options.position);
markerArray.push(pushPin);
     return pushPin;
  }

google.maps.event.addListener(map, "click", function(){
  infoWindow.close();
});

function SidebarItem(marker, opts){
var tag = opts.sidebarItemType || "button";
var row = document.createElement(tag);
row.innerHTML = opts.sidebarItem;
row.className = opts.sidebarItemClassName || "sidebar_item";  
row.style.display = "block";
row.style.width = opts.sidebarItemWidth || "120px";
row.onclick = function(){
google.maps.event.trigger(marker, 'click');
}
row.onmouseover = function(){
google.maps.event.trigger(marker, 'mouseover');
}
row.onmouseout = function(){
google.maps.event.trigger(marker, 'mouseout');
}
this.button = row;
}
// adds a sidebar item to a 

SidebarItem.prototype.addIn = function(block){
if(block && block.nodeType == 1)this.div = block;
else
this.div = document.getElementById(block)
|| document.getElementById("sidebar")
|| document.getElementsByTagName("body")[0];
this.div.appendChild(this.button);
}
// deletes a sidebar item
SidebarItem.prototype.remove = function(){
if(!this.div) return false;
this.div.removeChild(this.button);
return true;
} 
```

SidebarItem() 和 makeMarker() 是公共领域的函数，但对于像我这样的新手来说，它们很难理解、采用和集成。任何建议或当前示例将不胜感激。具体来说，ESA 2009 方法是否已经过时？我没有发现这种策略的最新用法。将非地图 DOM 元素与特定 Google 地图标记相关联的最佳现代方式是什么？

提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T01:13:42.350

我认为您要实现的目标没有任何魔力，但您确实需要注意变量范围。最简单的方法是声明地图标记和侧边栏条目，并在同一范围内（例如在 onload 处理程序中）定义它们的事件处理程序，以便它们可以相互寻址。我没有详细浏览过你的代码，所以你在这方面可能已经没问题了。

您可能还想尝试使用`.triggerHandler()`，`.trigger()`否则可能 A 将触发 B 并且 B 将立即触发 A 等等。如果是这样，那么调用堆栈可能会填满或浏览器可能会卡住。

* * *

编辑：

这是类似的东西，取自一个应用程序，其中谷歌地图标记和相应的外部链接都被赋予了 mouseover 和 mouseout 处理程序以相互突出显示。整个应用程序有数千行长，并组织成命名空间，每个命名空间都有一个大写的名称（例如`GOOGLEMAP`, `DATA`）。

您将看到数据结构`DATA.locationData`是标记和外部链接之间交互的关键。它允许处理程序在不同的名称空间（即不同的范围）中附加到链接和标记。

命名空间“GOOGLEMAP”（简化）：

```
var GOOGLEMAP = (function(){//NAMESPACE pattern
    //...
    var mouseoverLocMarker_closure = function(loc) {
        return function() {
            $(loc.link).addClass('hilight');
        };
    };
    var mouseoutLocMarker_closure = function(loc) {
        return function() {
            $(loc.link).removeClass('hilight');
        };
    };
    //...
    var init = function(...) {
        //...
        for(var name in DATA.locationData) {
            //...
            var loc = DATA.locationData[name];//lookup in a large hardcoded data structure in the DATA namespace
            loc.marker = new google.maps.Marker({ map:map, icon:'images/symbols/green.gif', zIndex:0 });//makes the marker available in other scopes
            //Here we attach functions returned by "_closure" functions, in order to correctly remember loc.
            google.maps.event.addListener( loc.marker, 'mouseover', mouseoverLocMarker_closure(loc) );
            google.maps.event.addListener( loc.marker, 'mouseout', mouseoutLocMarker_closure(loc) );
            //...
        }
    };
    //...
})(); 
```

一个 jQuery“文档就绪”闭包（简化）：

```
$(function(){
    $('#towns a.location').each(function(){
        //...
        var loc = DATA.locationData[name];//lookup in a large hardcoded data structure in the DATA namespace
        if(loc){
            //...
            $this.mouseover(function(){
                if(loc.marker) {
                    loc.icon = loc.marker.getIcon();
                    loc.marker.setIcon('images/symbols/red.gif');
                }
            });
            $this.mouseout(function(){
                if(loc.marker) {
                    loc.marker.setIcon(loc.icon);
                }
            });
            loc.link = this;//makes the link available to other scopes
        }
        else {
            //...
        }
    });
    //...
}); 
```

老实说，我不能说这段代码是典型的——它可能更有效地使用内存——但它组织得很好并且非常可靠。

# java - 在跟踪订单的同时导航 XML 文件

> ID：10591817
> 
> 赞同：0
> 
> 时间：2012-05-14T22:19:24.387
> 
> 标签：java, xml, dom

我需要转换 IOB 格式的 XML 文件。

XML 文件代表了Latex 编写的论文的结构，即具有部分和小节。在这种表示中，部分被编码为 BODY，然后我有一个 HEADER，然后是段落或小节。

例子：

```
<DIV DEPTH="1"> 
<HEADER ID="H-8"> Practical Results </HEADER>
<P TYPE="TXT"> 
<S ID="S-56" TYPE="TXT"> To assess its performance , <REF REFID="R-12" ID="C-36">Grover et al. 1993</REF> tried various methods . </S> 
<S ID="S-57" TYPE="TXT"> The grammar is defined in metagrammatical formalism which is compiled into a unification-based ` object grammar ' -- a syntactic variant of the Definite Clause Grammar formalism <REF REFID="R-21" ID="C-37">Pereira and Warren 1980</REF> -- containing 84 features and 782 phrase structure rules . </S> 
<DIV DEPTH="2"> 
<HEADER ID="H-9"> Comparing the Parsers </HEADER> 
<P TYPE="TXT"> 
<S ID="S-61" TYPE="TXT"> In the first experiment , the ANLT grammar was loaded and a set of sentences was input to each of the three parsers . </S> 
</P>
<IMAGE ID="I-0"/>
</DIV> 
```

我想要做的是保留所有文本，但将其转换为不同的格式，即我想删除 BODY 结构，只需像这样标记 HEADER 和文本部分：

```
Practical/B-Header Results/I-Header ./O 
To/B-Text assess/I-Text its/I-Text performance/I-Text ,/I-Text Grover/I-Text et/I-Text al./I-Text tried/I-Text various/I-Text methods/I-Text ./O 
The/B-Text grammar/I-Text ... ./O 
```

等等。

我知道一些 Java 中的 DOM 解析（例如，我一直在使用 jdom2 一段时间）但我不知道如何保持文本的顺序：例如，我想获取 REF 标签的内容（位于 S 内部，请看示例），但其父级的文本在 REF 标记之前和之后扩展。

任何指针？应该相当简单，但是像“在一定深度后去除 XML 标签”这样的搜索对我没有帮助:-(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T23:37:28.750

我会使用基于事件的 xml 解析器，如 sTax、sax 等。然后您可以在处理每个标签时跟踪级别、顺序和其他内容。

# java - Java DateUtils.ceiling 和 DateUtils.truncate 之间的区别

> ID：10591821
> 
> 赞同：9
> 
> 时间：2012-05-14T22:19:44.840
> 
> 标签：java, datetime

Java 文档中不清楚[DateUtils.ceiling](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/time/DateUtils.html#ceiling%28java.util.Calendar,%20int%29)和[DateUtils.truncate](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/time/DateUtils.html#truncate%28java.util.Calendar,%20int%29)之间的区别是什么。java文档错了吗？有人可以澄清一下吗？

> 天花板
> 
> 公共静态日期上限（日期日期，int字段）
> 
> Ceil 此日期，保留指定为最重要字段的字段。
> 
> 例如，如果您的日期时间为 2002 年 3 月 28 日 13:45:01.231，如果您通过 HOUR，**它将返回 28 Mar 2002 13:00:00.000**。如果这与 MONTH 一起传递，它将返回 2002 年 3 月 1 日 0:00:00.000。

对比

> 截短
> 
> 公共静态日期截断（日期日期，int字段）
> 
> 截断此日期，将字段指定为最重要的字段。
> 
> 例如，如果您的日期时间为 2002 年 3 月 28 日 13:45:01.231，如果您通过 HOUR，**它将返回 28 Mar 2002 13:00:00.000**。如果这与 MONTH 一起传递，它将返回 2002 年 3 月 1 日 0:00:00.000。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T23:16:12.380

为了补充吉姆的答案，我怀疑天花板方法存在 Javadoc 错误。[使用3.0 javadoc](http://commons.apache.org/lang/api-3.0/org/apache/commons/lang3/time/DateUtils.html#ceiling%28java.util.Date,%20int%29)更新了对 ceiling(Date,int) 的描述（与相同方法的[2.5 javadoc](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/time/DateUtils.html#ceiling%28java.util.Date,%20int%29)相比）......虽然其他的没有更新，但该方法使用日历版本通用的代码......或者使用一个简单的测试用例，您可以看到它们的行为相同（对我来说至少是 3.1 :)）

```
@Test
public void testCeil() {
    final Calendar date = new GregorianCalendar();
    date.clear();
    date.set(2002, 3, 28, 13, 45, 01);

    System.out.println(date.getTime());
    System.out.println(DateUtils.ceiling(date, Calendar.HOUR).getTime());
    System.out.println(DateUtils.ceiling(date.getTime(), Calendar.HOUR));
    System.out.println(DateUtils.truncate(date, Calendar.HOUR).getTime());
    System.out.println(DateUtils.truncate(date.getTime(), Calendar.HOUR));
    System.out.println(date.getTime());
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T22:53:28.460

答案在文档中：

> truncate、ceiling 和 round 方法可以被认为是日期的 Math.floor()、Math.ceil() 或 Math.round 版本。这样，日期字段将按自下而上的顺序被忽略。

我会解释为“你是对的，但这是有原因的”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T23:16:37.867

ceil() 方法的一些旧版本的文档是错误的。它已在某些时候得到纠正，这是 3.1 中的文档：

```
public static Date ceiling(Date date,
                           int field)
Ceil this date, leaving the field specified as the most significant field.

For example, if you had the datetime of 28 Mar 2002 13:45:01.231, if you passed with HOUR, it would return 28 Mar 2002 14:00:00.000\. If this was passed with MONTH, it would return 1 Apr 2002 0:00:00.000. 
```

因此，虽然 ceil() 和 trunc() 都最小化了所有剩余的字段（在某些情况下设置为 0，但对于 MONTH，它会将日期设置为 1）， ceil() 实际上会将您传入的字段增加 1，而 trunc 不会。

# jsf-2 - 在 PF3.1 中使用 onRowKey (p:datatable) 传递多个参数

> ID：10591824
> 
> 赞同：1
> 
> 时间：2012-05-14T22:19:55.647
> 
> 标签：jsf-2, primefaces

我希望从以下 Primefaces 3.1 p:datatable 传递多个参数：

```
 <p:dataTable value="#{tableBean.carsModel}" var="var" rowkey="#{var.model}" 
              selection="#{tableBean.car}" selectionMode="single">
    <p:ajax event="rowSelect" listener="#{tableBean.onRowClick}"></p:ajax>
    <p:column>
        <f:facet name="header">
            <h:outputText styleClass="outputText" value="Model"></h:outputText>
        </f:facet>
        <h:outputText styleClass="outputText" value="#{var.model}"></h:outputText>
    </p:column>
    <p:column>
        <f:facet name="header">
            <h:outputText styleClass="outputText" value="Color"></h:outputText>
        </f:facet>
        <h:outputText styleClass="outputText" value="#{var.randomColor}"></h:outputText>
    </p:column>
</p:dataTable> 
```

我有一种情况，我有多个主键作为主键，我正在使用 `rowkey="#{var.model}`但是，如何使用多个主键。

我也在使用`CarDataModel extends ListDataModel<Car> implements SelectableDataModel<Car>{` 类。有人可以告诉我如何使用吗？

```
@Override
public Car getRowData(String rowKey) {
    //In a real app, a more efficient way like a query by rowKey 
    //should be implemented to deal with huge data
    List<Car> cars = (List<Car>) getWrappedData();
    for(Car car : cars) {
        if(car.getModel().equals(rowKey))
            return car;
    }
    return null;
}

@Override
public Object getRowKey(Car car) {
    return car.getModel();
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T22:34:50.640

您需要将复合键用作行键。

例如

```
rowKey="#{car.compositeKey}" 
```

或者，如果您坚持使用`SelectableDataModel`：

```
@Override
public Car getRowData(String rowKey) {
    List<Car> cars = (List<Car>) getWrappedData();

    for (Car car : cars) {
        if (car.getCompositeKey().equals(rowKey))
            return car;
    }

    return null;
}

@Override
public Object getRowKey(Car car) {
    return car.getCompositeKey();
} 
```

至于具体的实现`getCompositeKey()`，目前还不清楚你有哪两个主键，你使用的是什么持久化 API。例如，JPA 已经支持复合键，因此您的实体应该已经支持它。但是，如果您出于某种原因没有使用 JPA，那么这里有一个示例，它假设 the`model`和 the都`color`表示复合键，只是为了说明这个想法：

```
public String getCompositeKey() {
    return model + "." + color;
} 
```

或者

```
public Object[] getCompositeKey() {
    return new Object[] { model, color };
} 
```

或者基于`Object#equals()`合同唯一表示为复合键的任何东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-09-26T07:39:28.047

您可以直接编写包含所有键的 rowKey：

```
<p:dataTable id="productItemsTable" var="i" value="#{b2BOrdersBean.listProductItems}" 
                rowKey="#{i.id.orderId}_#{i.id.productType}_#{i.id.partId}" 
                selectionMode="single" selection="#{b2BOrdersBean.selectedProductItemRow}"> 
```

你不需要担心创建一个函数来解决这个问题。

只需在 rowKey 中键入它有效的每个键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T13:36:51.893

我通过扩展基类提供唯一（行）键解决了这个问题，使用传递对象的属性对其进行初始化，并添加一个带有计数器值的附加 Id 字段。尚未尝试，但应该使用反射来自动化属性字段的副本。我很困惑为什么 PF 没有提供这样一个隐含的机制。

# python - Django：查询多个外键

> ID：10591828
> 
> 赞同：4
> 
> 时间：2012-05-14T22:20:29.907
> 
> 标签：python, django, orm, models

首先，我确定这是一个简单的问题。我刚刚开始使用 Django，就像所有初学者一样，我想我会建立一个简单的博客。

我有一个简单的数据模型，一个包含通过 FK 链接到用户的 Post 模型。

**模型.py**

```
class Post(TimeStampedActivate):
    """
    A blog post
    """
    title = models.CharField(max_length=255)
    slug = models.SlugField()
    excerpt = models.TextField(blank=True)
    body = models.TextField()
    publish_at = models.DateTimeField(default=datetime.datetime.now())
    created = models.DateTimeField(auto_now_add=True)
    modified = models.DateTimeField(auto_now=True)
    active = models.BooleanField(default=False, help_text='Is the blog post active?')
    user = models.ForeignKey(User, related_name='post_user')

    def __unicode__(self):
        return self.title 
```

然后，我想要一个页面，其中列出了所有帖子以及创建帖子的人的用户名。我当前的视图如下所示：

**视图.py**

```
def index(request):
    posts = Post.objects.filter(active=True)   
    user = User.objects.get(id=1)
    return render(request, 'blog/index.html', {'posts': posts, 'user': user}) 
```

**我的模板** 目前这仅显示与 ID 为 1 匹配的用户名。

```
{% for post in posts %}
    <h2><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></h2>
    <p>{{ post.excerpt|truncatewords:30 }}</p>
    <p>Posted by {{ user.first_name }} {{ user.last_name }}</p>
{% endfor %} 
```

我将如何修改我的 views.py 文件以确保我获得负责该帖子的用户的名字和姓氏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T22:40:55.607

看法：

```
def index(request):
    posts = Post.objects.filter(active=True)   
    return render(request, 'blog/index.html', {'posts': posts}) 
```

模板：

```
{% for post in posts %}
    <h2><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></h2>
    <p>{{ post.excerpt|truncatewords:30 }}</p>
    <p>Posted by {{ post.user.first_name }} {{ post.user.last_name }}</p>
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:37:50.787

在您的模板中使用“post.user”，而不仅仅是“user”。

```
{{ post.user.first_name }} {{ post.user.last_name }} 
```

“user”是当前登录的用户。

如果您使用 RequestContext 并将身份验证添加到您的 TEMPLATE_CONTEXT_PROCESSORS，则用户等于 request.user。[https://docs.djangoproject.com/en/dev/topics/auth/#authentication-data-in-templates](https://docs.djangoproject.com/en/dev/topics/auth/#authentication-data-in-templates)

# ios - 将数据传递给视图控制器

> ID：10591830
> 
> 赞同：0
> 
> 时间：2012-05-14T22:20:42.730
> 
> 标签：ios

我有一个可变的值数组，用于 tableviewcontroller、mapviewcontroller 和调用viewcontroller。我一直在更新它们，即。

```
[dataArray addObject:object atIndex:0];
[tvc. dataArray addObject:object atIndex:0];
[mvc. dataArray addObject:object atIndex:0]; 
```

有没有办法在表中声明 dataArray 并映射视图控制器，使它们指向 callViewController 中的 dataArray？所以我只需要更新一个？

***好吧，伙计们，我在这里犯了一个非常愚蠢的错误。在某些时候，我更改了初始化并将 nil 作为 dataArray 传递，出于某种原因，我有一个“if (!dataArray) create new”子句来隐藏它。

卡恩是对的。[dataArray addObject:object atIndex:0]; 这就是我们所需要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:28:41.943

这涉及更多一点，但我认为这将是最好的解决方案。您应该有一些方法让所有这些不同的 ViewController 引用管理数据的单个对象。这可能是一个委托，也可能是一个拥有主 dataArray 的单例。

在此处或在 google 上搜索这两个术语，您应该能够开始使用任一路线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T22:44:26.080

如果您在 AppDelegate 类中创建数组，那么您可以从应用程序中的任何其他类访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T23:58:37.827

在您发表评论后：

你如何声明一个`dataArray`在你的tableView和mapView以及callingView中调用的属性。然后，在您的调用视图控制器中，您初始化一个名为 myFirstArray 的可变数组并执行以下操作：

```
NSMutableArray *myFirstArray = [NSMutableArray array];
self.dataArray = myFirstArray;
myTableView.dataArray = myFirstArray;
myMapView.dataArray = myFirstArray; 
```

这样，它们都将指向同一个对象，并且您在其中所做的更改将反映在另一个对象中。试试看！

# python - 将数组打印为树

> ID：10591831
> 
> 赞同：1
> 
> 时间：2012-05-14T22:20:49.860
> 
> 标签：python, arrays, tree, pretty-print

我有一个数组（树），例如：

```
['Humidity\n', ['High', ['Outlook\n', ['Sunny', ['Temp\n', ['Hot', ['Wind\n', ['Weak', ['No']], ['Strong', ['No']]]], ['Mild', ['No']]]], ['Overcast', ['Temp\n', ['Hot', ['Yes']], ['Mild', ['Yes']]]], ['Rain', ['Temp\n', ['Mild', ['Wind\n', ['Weak', ['Yes']], ['Strong', ['No']]]]]]]], ['Normal', ['Wind\n', ['Weak', ['Outlook\n', ['Rain', ['Yes']], ['Overcast', ['Temp\n', ['Cool', ['Yes']], ['Hot', ['Yes']]]], ['Sunny', ['Yes']]]], ['Strong', ['Temp\n', ['Cool', ['No']], ['Mild', ['Outlook\n', ['Rain', ['Yes']], ['Sunny', ['Yes']]]]]]]]] 
```

我想把它打印成一棵树。这是我的尝试

```
def printTree(treeToPrint, tab):
    print tab + treeToPrint[0]
    newTab = tab + "--"
    nextTree = treeToPrint[1:]
    for tree in nextTree:
        print newTab + tree[0]
        printTree(tree[1], newTab + "--") 
```

它正在打印输出，例如：

```
Humidity

--High
----Outlook

------Sunny
--------Temp

----------Hot
------------Wind

--------------Weak
----------------No
--------------Strong
----------------No
----------Mild
------------No
------Overcast
--------Temp

----------Hot
------------Yes
----------Mild
------------Yes
------Rain
--------Temp

----------Mild
------------Wind

--------------Weak
----------------Yes
--------------Strong
----------------No
--Normal
----Wind

------Weak
--------Outlook

----------Rain
------------Yes
----------Overcast
------------Temp

--------------Cool
----------------Yes
--------------Hot
----------------Yes
----------Sunny
------------Yes
------Strong
--------Temp

----------Cool
------------No
----------Mild
------------Outlook

--------------Rain
----------------Yes
--------------Sunny
----------------Yes 
```

有人可以帮我以漂亮的格式表示这棵树。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T22:26:11.623

有时，`pprint`做得很好：

```
>>> from pprint import pprint
>>> pprint(x)
['Humidity\n',
 ['High',
  ['Outlook\n',
   ['Sunny',
    ['Temp\n',
     ['Hot', ['Wind\n', ['Weak', ['No']], ['Strong', ['No']]]],
     ['Mild', ['No']]]],
... 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-14T22:49:25.127

您可以使用[此处](http://www.redditgadgetguide.com/r/Python/comments/bqia6/easiest_way_to_draw_a_graphical_data_tree_with/)找到的代码示例：

```
from turtle import *
from types import *

myTree = ["A",["B",["C",["D","E"],"F"],"G","H"]];

s = 50;
startpos = (0,120)
def cntstrs(list):
  return len([item for item in list if type(item) is StringType])
def drawtree(tree, pos, head=0):
  c = cntstrs(tree)
  while len(tree):
    goto(pos)
    item = tree.pop(0)
    if head:
        write(item,1)
        drawtree(tree.pop(0),pos)
    else:
        if type(item) is StringType:
            newpos = (pos[0] + s*c/4 - s*cntstrs(tree), pos[1] - s)
            down()
            goto((newpos[0], newpos[1] + 15))
            up()
            goto(newpos)
            write(item,1)
        elif type(item) is ListType:
            drawtree(item,newpos)

up()
drawtree(myTree, startpos,1) 
```

此代码使用 python`TkInter`包在单独的窗口中绘制树。您可以通过以下命令在 linux 中安装 TkInter：`sudo apt-get install python-tk`

如果你想产生这样的东西，你可以使用它：http: [//upload.wikimedia.org/wikipedia/commons/thumb/f/f7/Binary_tree.svg/220px-Binary_tree.svg.png](http://upload.wikimedia.org/wikipedia/commons/thumb/f/f7/Binary_tree.svg/220px-Binary_tree.svg.png)

正如您在评论中提出的那样。但这不能用于控制台中的打印..

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T23:14:47.930

这是类似的：

```
from collections import deque
class BTreeNode:
    def __init__(self, data, left=None, right=None):
        self.data = data
        self.left = left
        self.right = right

    def insertNode(self, node):
        if node.data < self.data:
            if self.left == None:
                self.left = node
            else:
                self.left.insertNode(node)
        else:
            if self.right == None:
                self.right = node
            else:
                self.right.insertNode(node)

    def printLevel(self):
        """ Breadth-first traversal, print out the data by level """
        level = 0
        lastPrintedLevel = 0
        visit = deque([])
        visit.append((self, level))
        while len(visit) != 0:
            item = visit.popleft()
            if item[1] != lastPrintedLevel:  #New line for a new level
                lastPrintedLevel +=1
                print
            print item[0].data,
            if item[0].left != None:
                visit.append((item[0].left, item[1] + 1))
            if item[0].right != None: 
                visit.append((item[0].right, item[1] + 1))

bt=BTreeNode(1,left=BTreeNode(2,left=BTreeNode(4)), 
   right=BTreeNode(3,left=BTreeNode(5),right=BTreeNode(6)))     

bt.printLevel() 
```

输出：

```
1
2 3
4 5 6 
```

另一个替代品：

```
import math
from cStringIO import StringIO

def show_tree(tree, total_width=33, fill=' '):
    """Pretty-print a tree."""
    output = StringIO()
    last_row = -1
    for i, n in enumerate(tree):
        if i:
            row = int(math.floor(math.log(i+1, 2)))
        else:
            row = 0
        if row != last_row:
            output.write('\n')
        columns = 2**row
        col_width = int(math.floor((total_width * 1.0) / columns))
        output.write(str(n).center(col_width, fill))
        last_row = row
    print output.getvalue()
    print '-' * total_width
    print
    return

show_tree(range(15)) 
```

印刷：

```
 0                
       1               2        
   3       4       5       6    
 7   8   9   10  11  12  13  14 
--------------------------------- 
```

现在只需决定数据的根是什么，然后递归地附加到 BTree 就可以了。

# pdf - 使用外部资源制作 PDF

> ID：10591840
> 
> 赞同：-1
> 
> 时间：2012-05-14T22:21:52.293
> 
> 标签：pdf, pdf-generation

有没有人尝试使用图像/样式/脚本等外部资源制作 PDF 文件？每当打开 PDF 时，应从 Internet 加载这些外部资源。

有人告诉我 metasploit 可以做到，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T08:12:03.443

PDF 文件不是网页，您不应该依赖在线资源在**打开**它时显示在其中。

但是，如果您的意思是在**创建**PDF 文件时使用在线资源，我会说任何 PDF 创建库都可以做到这一点。我个人最喜欢的是一个名为[iText](http://www.itextpdf.com)的 Java 库。如果您更喜欢 C#，它已被移植为[iTextSharp](https://sourceforge.net/projects/itextsharp/)。

# python - 与谷歌日历 API v3 的未经授权的交互

> ID：10591849
> 
> 赞同：3
> 
> 时间：2012-05-14T22:23:18.517
> 
> 标签：python, google-api, oauth-2.0, google-calendar-api, google-api-python-client

我和[这个人](https://stackoverflow.com/questions/10112939/login-required-401-unauthorized-message-when-calling-the-v3-google-calendar-ap)的情况相同（只是我的问题出在 python 上）：我正在尝试使用服务帐户检索数据（使用[此示例](http://code.google.com/p/google-api-python-client/source/browse/samples/service_account/tasks.py)并在阅读[此博客条目](http://googleappsdeveloper.blogspot.com.ar/2011/12/calendar-api-v3-2-legged-oauth-java.html)后，因为我的应用程序是谷歌应用程序）但是我遇到**需要登录**的错误，我不明白为什么。

让我用一个完整的例子来表示它：

```
In [1]: import httplib2                                                          
In [2]: from apiclient.discovery import build                                   
In [3]: from oauth2client.client import SignedJwtAssertionCredentials            
In [4]: f = open('abd45679ffg32343-privatekey.p12', 'rb')
In [5]: key = f.read()                                                          
In [6]: f.close()                                                               
In [7]: credentials = SignedJwtAssertionCredentials(                            
        '2127313127654990@developer.gserviceaccount.com', key,                     
        scope=['https://www.googleapis.com/auth/calendar',                      
               'https://www.googleapis.com/auth/calendar.readonly'])            
In [8]: http = httplib2.Http()                                                  
In [9]: http = credentials.authorize(http)                                      
In [10]: service = build(serviceName='calendar', version='v3', http=http,       
   ....:         developerKey='XcddfRgtyt676grggtT')        
2012-05-14 18:24:35,170 INFO  [root][MainThread] URL being requested: https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest                                                              
2012-05-14 18:24:35,170 INFO  [oauth2client.client][MainThread] Attempting refresh to obtain initial access_token
2012-05-14 18:24:35,179 INFO  [oauth2client.client][MainThread] Refresing access_token
In [11]: service.calendarList().list().execute()                                
2012-05-14 18:25:00,418 INFO  [root][MainThread] URL being requested https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json&key=XcddfRgtyt676grggtT          
---------------------------------------------------------------------------     
HttpError                                 Traceback (most recent call last)     
/home/mariano/Code/Kalendar/rest/kalendar/<ipython-input-12-0cb769615d74> in <module>()
----> 1 service.calendarList().list().execute()                                 
/home/mariano/Code/Kalendar/rest/env/local/lib/python2.7/site-packages/google_api_python_client-1.0beta8-py2.7.egg/apiclient/http.pyc in execute(self, http)                                     
387                                                                         
388       if resp.status >= 300:                                            
--> 389         raise HttpError(resp, content, self.uri)                        
390     return self.postproc(resp, content)                                 
391                                                                         
HttpError: <HttpError 403 when requesting https://www.googleapis.com/calendar/v3/users/me/calendarList?alt=json&key=XcddfRgtyt676grggtT returned "The user must be signed up for Google Calendar."> 
```

任何有关为什么会发生这种情况以及如何解决它的指示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T07:28:21.630

服务帐户可供我使用并与日历 API 一起使用。

您需要更改以下语句：

```
credentials = SignedJwtAssertionCredentials('2127313127654990@developer.gserviceaccount.com', key, scope=['https://www.googleapis.com/auth/calendar', 'https://www.googleapis.com/auth/calendar.readonly']) 
```

到

```
credentials = SignedJwtAssertionCredentials('2127313127654990@developer.gserviceaccount.com', key, scope=['https://www.googleapis.com/auth/calendar', 'https://www.googleapis.com/auth/calendar.readonly'], prn='requestor@domain.com') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T03:25:35.343

服务帐户确实可以与日历 API 一起使用。您还必须授予对域管理的访问权限。

`"prn=requestor@domain.com"`按照 user1260486 和 btspierre 说的做，并将`SignedJWTAssertionCredentials`.

然后转到您的域管理并添加您`client_id`对 API 的访问权限。

这是一个关于它的[演练。](http://support.google.com/a/bin/answer.py?hl=en&answer=162106)对于范围指定`"https://www.googleapis.com/auth/calendar, https://www.googleapis.com/auth/calendar.readonly"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T23:10:18.517

我不认为日历 API 可以使用服务帐户。服务帐户没有自己的日历。

# java - 我应该在 ReferenceQueue 上同步吗？

> ID：10591851
> 
> 赞同：11
> 
> 时间：2012-05-14T22:23:33.563
> 
> 标签：java, concurrency

我正在查看源代码`WeakHashMap`并偶然发现：

```
private final ReferenceQueue<Object> queue = new ReferenceQueue<>();

private void expungeStaleEntries() {
    for (Object x; (x = queue.poll()) != null; ) {
        synchronized (queue) {
           /* snip */
        }
    }
} 
```

为什么这个方法在 上同步`ReferenceQueue`？[`WeakHashMap`](http://docs.oracle.com/javase/7/docs/api/java/util/WeakHashMap.html)本身并没有声称是线程安全的：

> 像大多数集合类一样，这个类是不同步的。可以使用 Collections.synchronizedMap 方法构造同步的 WeakHashMap。

这让我相信这个实现细节是为了以某种方式确保`ReferenceQueue`自身的线程安全（因为 GC 将从它自己的 GC 中修改它`Thread`）。但是，[文档`ReferenceQueue`](http://docs.oracle.com/javase/7/docs/api/java/lang/ref/ReferenceQueue.html)没有提到任何关于并发问题的内容，查看源代码`ReferenceQueue`会发现它甚至不同步自身（它使用内部锁）。

为什么`WeakHashMap`在其上进行同步`ReferenceQueue`？`ReferenceQueue`我应该在每次使用时同步吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T14:31:06.740

如果您看一下，[`ReferenceQueue`](http://docs.oracle.com/javase/6/docs/api/java/lang/ref/ReferenceQueue.html)您会发现它明确支持平台内部的线程，因为它声明该`remove()`方法将阻塞，直到有新条目可用。

`synchronized`您看到的是`WeakHashMap`关于确保访问 a`ReferenceQueue`的多个线程正确同步。

您可能会[在 bugs.sun.com 上发现这个相关的错误很](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6425537)有趣。

要回答您的问题，我认为`ReferenceQueue`如果您确保它仅由单个线程访问，则不需要外部同步。我不会使用（也想不出一个很好的理由）将单个`ReferenceQueue`用作来自多个线程的消费者。

# java - 如何从 InputStream 转换为 AudioInputStream

> ID：10591852
> 
> 赞同：3
> 
> 时间：2012-05-14T22:23:43.290
> 
> 标签：java, audio, casting, inputstream, javasound

是否可以从 InputStream 转换为 AudioInputStream？

我想在某些事件中播放小声音文件，所以我按照 SoundThread

```
import java.io.*;
import javax.sound.sampled.*;

public class SoundThread implements Runnable{

    private String filename;

    SoundThread(String filename) {
        this.filename = filename;
    }

    public void run() {
        try {
            InputStream in = ClassLoader.getSystemResourceAsStream("sounds/"+filename+".wav");
            Clip clip = AudioSystem.getClip();
            clip.open((AudioInputStream)in);
            clip.start();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (NullPointerException e) {
            e.printStackTrace();
        } catch (LineUnavailableException e){
            e.printStackTrace();
        } 
    }
} 
```

我运行它

```
new Thread(new SoundThread("nameOfTheSoundFile")).start(); 
```

一开始我用 sun.audio.AudioPlayer 和 sun.audio.AudioStream 处理它，但是当我将该代码放入 eclipse 中时，它向我显示了错误。所以我尝试了

```
AudioInputStream in = (AudioInputStream)ClassLoader.getSystemResourceAsStream("sounds/"+filename+".wav"); 
```

将 InputStream 转换为 AudioInputStream（eclipse 没有显示任何错误），但运行它会引发 ClassCastException。这个问题有什么解决办法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T22:34:09.963

使用直接从资源 `AudioSystem`中获取。`AudioInputStream``URL`

```
URL url = ClassLoader.getResource("/sounds/"+filename+".wav");
AudioInputStream ais = AudioSystem.getAudioInputStream(url);
Clip clip = AudioSystem.getClip();
clip.open(ais); 
```

另见[`AudioSystem.getAudioInputStream(InputStream)`](http://docs.oracle.com/javase/7/docs/api/javax/sound/sampled/AudioSystem.html#getAudioInputStream%28java.io.InputStream%29)，但这“更危险”。Java Sound 通常需要一个可重新定位的输入流。出于某种我不太清楚的原因，`Class.getResourceAsStream()`变体有时会返回**不可**重新定位的流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:35:01.980

你不能投。在 Java 中，仅当您要转换的真实对象*已经*是目标类型的实例时，才能对引用类型进行类型转换。例如：

```
 String myString = new String("42");
    Object obj = (Object) myString;  // OK
    String mystery = (String) obj;   // OK
    String mystery2 = (Integer) obj; // FAIL 
```

前两个成功是因为我们在第一行创建的字符串对象是 的实例`Object`（因为`String`是 的子类型`Object`）和 的实例`String`。第三个失败，因为 a`String`不是`Integer`。

* * *

在您的示例中，您从中获取的对象`getSystemResourceAsStream`是包含（可能）音频数据的原始流。它不是音频流；即不是`AudioInputStream`.

您必须*包装*原始输入流，如下所示：

```
 InputStream in = ClassLoader.getSystemResourceAsStream(
        "sounds/"+filename+".wav");
    AudioFormat format = ...
    int length = ...
    AudioInputStream audio = new AudioInputStream(in, format, length); 
```

或使用一种`AudioSystem.getAudioInputStream(...)`工厂方法，它在引擎盖下进行包装。

有关执行此操作的正确方法的详细信息，请参阅 Andrew Thomson 的回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T22:33:32.497

`InputStream`返回的不是`getSystemResourceAsStream`一个`AudioInputStream`，所以强制转换它永远不会起作用。只需创建一个新的[`AudioInputStream`](http://docs.oracle.com/javase/7/docs/api/javax/sound/sampled/AudioSystem.html#getAudioInputStream%28java.io.InputStream%29)。

# jquery - jquery Cycle高级幻灯片

> ID：10591854
> 
> 赞同：0
> 
> 时间：2012-05-14T22:24:15.373
> 
> 标签：jquery, jquery-cycle

我正在使用 jQuery 循环插件[http://jquery.malsup.com/cycle/](http://jquery.malsup.com/cycle/)，我正在尝试创建类似的滑块效果，如本页[http://themeforest.net/item/doover-premium-wordpress-theme/ full_screen_preview/2279114](http://themeforest.net/item/doover-premium-wordpress-theme/full_screen_preview/2279114) 就是标题和描述在不同时间从不同方向滑动。他们也在使用 jQuery 循环滑块。

我不知道该怎么做。任何建议都会很好，我会很高兴。

这是我的 HTML 代码：[https ://gist.github.com/2697871](https://gist.github.com/2697871)

这是我的 CSS 代码：[https ://gist.github.com/2697874](https://gist.github.com/2697874)

这是我的 JS 代码：[https ://gist.github.com/2697877](https://gist.github.com/2697877)

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:59:18.803

首先，在**javascript**中，将当前幻灯片类设置为活动。
然后，在**Css**中将您的元素位置设置在幻灯片之外

```
.title{position:absolute; top:0; left:100%; }
.text{position:absolute; top:0; left:-100%;} 
```

最后，在 Css 中，当父级设置为活动时添加一个动画

```
.active .title{animation: animateTitle 2s 1 ease-out forwards;}
.active .text{animation: animateText 2s 1 ease-out forwards;}

@keyframes animateTitle {
    0%   { left: 100%; }
    100% { left: 0; }
}

@keyframes animateTtext {
    0%   { left: -100%; }
    100% { left: 0; }
} 
```

# c - 如何在 C 中的 3d 数组中使用 memcpy

> ID：10591856
> 
> 赞同：5
> 
> 时间：2012-05-14T22:24:27.863
> 
> 标签：c

我有一个 3 维数组`int32_t x[1024][4][256]`。我需要将数组的所有元素复制到另一个相同类型和大小的数组`int32_t y[1024][4][256]`。

我可以用`memcpy(y, x, sizeof(x));`吗？

之后我可以访问与数组`y`相同的元素`x`吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-14T22:26:01.580

> 我可以用`memcpy(y, x, sizeof(x))`吗？

是的。

> 之后我可以访问与数组`y`相同的元素`x`吗？

是的。

请注意，如果您动态分配数组（例如使用`malloc()`），这种方法会失效。如果你这样做，`sizeof()`将不再给你数组的大小（它会给出指针的大小），你必须自己跟踪数组的尺寸。

# javascript - 将 Google Analytics 集成到前往预订引擎并来自 Flash 的中介 301 上？

> ID：10591857
> 
> 赞同：1
> 
> 时间：2012-05-14T22:24:30.233
> 
> 标签：javascript, google-analytics

我有一个我没有源代码的快速预订小部件，它转到一个中间页面，该页面应该转到一个预订引擎（我还没有编程）。

我希望在中间页面上实现跨域 GA 跟踪，因为我不控制 Flash 预订小部件。它只是`redirect.php`与应该提供给预订引擎的参数一起使用。

我遇到了这些答案：

*   [重定向的 HTTP 引荐来源网址](https://stackoverflow.com/questions/8668773/http-referrer-on-redirection)
*   [在 301 重定向之前处理数据？](https://stackoverflow.com/questions/2954799/process-data-before-a-301-redirect)
*   [使用谷歌分析跟踪重定向页面](https://stackoverflow.com/questions/9506669/track-a-redirect-page-with-google-analytics)

但这确实没有明确的解决方案。有没有人遇到过类似的困境，如果有，你能分享一下你是如何集成跟踪的吗？

具体问题：

*   新的谷歌代码使用异步方法，但是我可以绑定一个事件处理程序来调用它自己，它可以`location.href`在页面被跟踪之后进行设置吗？

# java - java和c++中的多维数组有什么区别？

> ID：10591859
> 
> 赞同：4
> 
> 时间：2012-05-14T22:25:07.160
> 
> 标签：java, c++

```
char a[][4] = {{'a','a','a'},
               {'a','a','a'},
               {'a','a','a'},
               {'a','a','a'}}; 
```

在 c++ 中，您必须初始化数组的最后一个索引。

在java中，如果你这样做会导致错误。

**有人可以解释一下为什么吗？？**

另外，当我在 java 中检查这样的数组长度时。

```
System.out.println(a[0].length); 
```

结果是数组中列的长度

让我们说数组末尾有一个'\ 0'，当我像这样检查c ++中数组的长度时。

```
cout << strlen(a[0]) 
```

我得到了整个数组的长度。

**我可以像在java中一样在c ++中获取数组中行或列的长度吗？**

这是因为java中的数组是一个对象吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-14T22:44:59.327

在Java 中，多维数组是包含数组的数组（并且多维数组变量不一定包含多维数组，即它可以为空）。在 C++ 中，多维数组变量本身就是一个巨大的数组，可以立即创建，其多维性质只是语法糖。在 C++ 中，您必须初始化数组的第一个索引以外的所有索引，以便告诉编译器如何在多维数组语法和它在幕后实际使用的单个巨大数组之间进行转换。

通过将多维数组初始化为指向数组指针数组的指针，而不是简单地作为数组数组，您可以在 C++ 中获得更多类似 Java 的行为（Java 中的对象主要等同于 C++ 中的对象指针）。当然，那么您将不得不担心 Java 为您做的内存管理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T23:16:09.310

有一个简单的模板可用于让编译器为您提供数组的大小：

```
template <typename T, size_t N>
size_t array_size( T (&)[N] ) {
   return N;
} 
```

该模板可以与整个数组一起使用，也可以与包含的数组一起使用：

```
char a[][4] = {{'a','a','a'},
               {'a','a','a'},
               {'a','a','a'},
               {'a','a','a'}};
std::cout << array_size(a)    << std::endl;    // 4
std::cout << array_size(a[0]) << std::endl;    // 4 
```

如果您想知道为什么两者都会产生相同的结果，那么数组的大小是先行后列。在您的情况下，您正在使用三个元素初始化 4 行（第四个元素将被初始化，即归零）。如果您打算有 4 行 3 列，您的定义应该是：`char a[][3]`.

# php - 是否可以使用类似函数的运算符？

> ID：10591873
> 
> 赞同：4
> 
> 时间：2012-05-14T22:26:16.883
> 
> 标签：php

> **可能重复：**
> [我可以在 PHP 中使用运算符作为函数回调吗？](https://stackoverflow.com/questions/1692626/can-i-use-operators-as-function-callback-in-php)

是否可以在 PHP 中使用类似函数的运算符？

例如，我编写了一个如下所示的小函数：

```
function aggregate($values,$function,$initial=null) {
    $agg = $initial === null ? array_shift($values) : $initial;
    while($values) {
        $agg = call_user_func($function,$agg,array_shift($values));
    }
    return $agg;
} 
```

我想知道是否可以用类似的东西来调用它

```
 agggregate(array(1,2,3),'+'); 
```

这将产生`1+2+3=6`.

如果没有，我想我可以这样称呼它：

```
 agggregate(array(1,2,3),function($a,$b){return $a+$b;}); 
```

但它没有那么紧凑。

* * *

我刚刚注意到这与`array_reduce`; 没有必要指出这一点；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:27:36.207

使用匿名函数是 PHP 的方式。不幸的是，它没有类似 python 的`operator`模块。

# html - 将 PDF 渲染为图像并提取超链接

> ID：10591874
> 
> 赞同：3
> 
> 时间：2012-05-14T22:26:17.767
> 
> 标签：html, pdf, hyperlink, imagemagick

我使用 imagemagick 将 PDF（由 pdfLaTex 生成）呈现为图像：

```
convert -density 120 test.pdf -trim test.png 
```

然后我在一个 HTML 文件中使用这个图像（为了在自己的 wiki 引擎中包含乳胶代码）。

但当然，PNG 文件没有 PDF 文件包含的任何超链接。

是否也有可能提取超链接的坐标和目标 URL，以便我可以构建 HTML[图像映射](http://en.wikipedia.org/wiki/Image_map)？

如果它有所作为：我只需要外部 (http://) 超链接，不需要 PDF 内部超链接。像这样的基于文本的解决方案`pdftohtml`是不可接受的，因为 PDF 也包含图形和公式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T07:07:21.950

Imagemagick 使用 Ghostscript 将 PDF 文件呈现为图像。您还可以使用 Ghostscript 来提取链接注释。事实上，PDF 解释器已经这样做是为了 pdfwrite 设备的好处，因此它可以生成与原始文件具有相同超链接的 PDF 文件。

您需要进行少量 PostScript 编程，如果您需要更多详细信息，请告诉我。

在 gs/Resource/Init 中，文件 pdf_main.ps 包含 PDF 解释器的大部分内容。在那里你会发现这个：

```
 /Link {
    mark exch
    dup /BS knownoget { << exch { oforce } forall >> /BS exch 3 -1 roll } if
    dup /F knownoget { /F exch 3 -1 roll } if
    dup /C knownoget { /Color exch 3 -1 roll } if
    dup /Rect knownoget { /Rect exch 3 -1 roll } if
    dup /Border knownoget {
....
    } if
    { linkdest } stopped 
```

该代码处理链接注释（PDF 文件中的超链接）。您可以将“linkdest”替换为 PostScript 代码，以将数据写入文件，从而为您提供超链接。请注意，您还需要在命令行上设置 -dDOPDFMARKS，因为这种处理通常对无法使用它的渲染设备禁用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-29T06:45:00.197

我的同事发现了一个不错的库 PDFMiner，其中包括一个`tools/dumppdf.py`我需要的功能，请参阅[http://www.unixuser.org/~euske/python/pdfminer/](http://www.unixuser.org/~euske/python/pdfminer/)

还有另一个 SO 问题对此有答案，请参阅[寻找 linux PDF 库以从 PDF 中提取注释和图像](https://stackoverflow.com/questions/7131747/looking-for-a-linux-pdf-library-to-extract-annotations-and-images-from-a-pdf) 显然 Ruby 的 pdfreader 也可以这样做[https://github.com/yob/pdf-reader](https://github.com/yob/pdf-reader)

# c# - 在 C# 中使用内存映射文件时是否可以避免数据副本？

> ID：10591878
> 
> 赞同：5
> 
> 时间：2012-05-14T22:27:07.473
> 
> 标签：c#, performance, memory-mapped-files

我对 C# 中内存映射文件如何工作的理解是，每个数据请求都会产生一个副本。例如，如果您将大型数据结构作为文件持久化，则使用内存映射文件将导致实际文件映射到 RAM 的内存，并且一旦从文件中读取，副本就会驻留在 GC 堆中。

我假设这是因为一般来说指针和 GC 不能很好地相处。

那么，有没有办法解决这个问题？

*   也许通过一些可以在内存映射数据上公开托管 API 的混合模式 C++？
*   使用不安全的 C# 直接操作指针怎么样？

我试图解决的一般问题是在多个进程之间共享一个大型数据结构。数据结构用于回答一小部分可以作为简单 API 公开的“问题”（即基本上是一堆其他数据的高度专业化的索引）。

附带说明一下，这不会使 .NET API 对于“共享大量数据”的场景变得无用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T22:32:12.457

您可以使用不安全的代码直接访问映射的内存。我建议您查看“blittable structs”，它们是可以在内存中复制而无需修改的结构类型。这是一个例子：

```
struct MyDataRecord { public int X, Y; }

...

for (var i = 0 .. 10) {
 ((MyDataRecord*)pointerToUnmanagedMemory)[i] = new MyDataRecord() { X = i, Y = i * i };
} 
```

这是非常高效和方便的。

# php - 将 mp3 流式传输到浏览器，而不是将数据保存为文件

> ID：10591881
> 
> 赞同：0
> 
> 时间：2012-05-14T22:27:17.177
> 
> 标签：php, streaming, readfile

我正在使用以下 php 类将文本转换为语音： http: [//www.masnun.me/2009/12/14/googles-text-to-speech-api-a-php-wrapper-class.html](http://www.masnun.me/2009/12/14/googles-text-to-speech-api-a-php-wrapper-class.html)

它使用google的API，现在代码将文件保存在本地，但是我希望它强制将文件流式传输到用户的浏览器。这就是我想出的：

```
function saveToFile($filename) {
    $filename = trim($filename);
    if(!empty($filename)) {
            header("Content-type: application/octet-stream");
            header('Content-length: ' . filesize($this->mp3data));
            header('Content-Disposition: filename="' . $filename);
            header('X-Pad: avoid browser bug');
            header('Cache-Control: no-cache');
            readfile($this->mp3data);
    } else { return false; }
} 
```

但生成的文件是 0kb 的空 mp3 文件。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:48:32.647

`readfile()`接受文件名作为参数，而不是文件的内容。尝试用这个替换 readfile 行：

```
echo $this->mp3data; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:47:19.043

是否`readfile`真的回显到浏览器？如果它只是返回一些东西，它不会像你期望的那样工作：

```
echo readfile($this->mp3data); 
```

我也知道 readfile 可以使用路径，如果是这种情况，请尝试：

```
echo $this->mp3data; 
```

# css - Div 无缘无故地在高度上有另一个像素

> ID：10591887
> 
> 赞同：2
> 
> 时间：2012-05-14T22:28:21.047
> 
> 标签：css

我不知道 chrome 中的 1px 高度差 Firefox 和 ie9 中的 2 px 高度差是从哪里来的？似乎 div.entry 是它的来源，但我无法修复它。

[http://goo.gl/kM3U3](http://goo.gl/kM3U3)

```
#middle {width:900px;}
#middle div.homepage img {width:900px;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:33:09.423

似乎是您网站上 img 标记末尾的一个空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T22:36:10.877

我用这种方法解决了这个问题：

```
<div class="homepage" style="line-height:0">
  <img title="Homepage" alt="Homepage" src="/wp-content/uploads/Homepage.jpg">
</div> 
```

问题是您在图像下方有一条线，可能是文档源上的a`\n`或 a ！`blank space`

要解决此类问题，您可以`line-height`将`0`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T22:39:22.017

改变

`#middle div.homepage img {width:900px;}`

到

`#middle div.homepage img {display: block; width:900px;}`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-14T22:55:06.433

有时像这样的问题与边界有关。IE、Firefox 和 Chrome 与默认边框有一些细微差别，所以你必须建立一个。在这种情况下，**css-reset.css**设置了一些您不想要的东西。

改变：

```
line-height: 1; 
```

到：

```
line-height: 0; 
```

图片下方多余的白线将不再存在，但我不知道这是否会导致您的页面出现其他一些不需要的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-14T22:32:25.553

可能是每个浏览器中的默认选项略有不同。

我从不制作没有[重置 CSS](http://meyerweb.com/eric/tools/css/reset/)样式表的网站。

正是这样做，将所有默认设置重置为一个新的公共基础，以便以后应用的所有内容在每个浏览器中都应该表现相同。

# ios - 如何让 UITableViewController 在两个不同的高度显示两个不同的 UITableViewCell？

> ID：10591891
> 
> 赞同：0
> 
> 时间：2012-05-14T22:28:36.180
> 
> 标签：ios, ios5, uitableview

我有一个 UITableView 控制器、UITableView xib 和两个带有 xib 的 UITableViewCell 子类。我为每个 xib 拖出了一个单独的单元格。我的第一个单元格的高度是 115，而我的另一个单元格具有默认高度。当在我的控制器中调用 cellForRowAtIndexPath 时，我有一个条件语句，将第一行设置为我更大的单元格。之后的每一行都设置为我的另一个单元格。即使正在渲染较大的单元格，默认单元格也不会识别第一个单元格大于默认单元格的事实，因此默认单元格与较大的单元格重叠。我在较大单元格的底部设置了一个 distanceLabel 插座，以向您展示我的意思：

![在此处输入图像描述](../Images/18ba112dbae9362288a2d24da68e1afe.png)

**注意：** 2.3 英里是第一个单元格的一部分。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // load the cell nib
    UINib *nib = [UINib nibWithNibName:@"CustomViewCell" bundle:nil];
    UINib *bigNib = [UINib nibWithNibName:@"BigCell" bundle:nil];

    //Register the nib
    [[self tableView] registerNib:nib forCellReuseIdentifier:@"CustomViewCell"];
    [[self tableView] registerNib:bigNib forCellReuseIdentifier:@"BigCell"];
}
- (UITableViewCell *)tableView:(UITableView *)tableView
         cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
        if (indexPath.row == 0) {
        BigCell *cell = [tableView dequeueReusableCellWithIdentifier:@"BigCell"];
        NSString *title = [self.frontList objectAtIndex:indexPath.row];
        [[cell nameLabel] setText:title];
        [[cell distanceLabel] setText:@"2.3 miles"];
        return cell;
    } else {

        CustomFrontCell *cell  = [tableView dequeueReusableCellWithIdentifier:@"CustomViewCell"];
        NSString *titles = [self.frontList objectAtIndex:indexPath.row];
        [[cell nameLabel] setText:titles];
        return cell;
    }
} 
```

如何使这些单元格以正确的间距和高度呈现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:40:06.683

您可以使用 UITableViewDelegate 方法[`tableView:(UITableView *)tableView heightForRowAtIndexPath:`](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDelegate/tableView%3aheightForRowAtIndexPath%3a)来控制高度。

# delphi - 从 Delphi 6 应用程序中的 FOURCC ID 查找压缩器/过滤器友好名称？

> ID：10591894
> 
> 赞同：4
> 
> 时间：2012-05-14T22:28:54.793
> 
> 标签：delphi, compression, directshow, vfw, fourcc

我有一个 Delphi 6 应用程序，它要求用户使用 AVISaveOptions() 选择音频和视频压缩器。然后我将每个选择的 FOURCC ID 存储在一个数据文件中。我想使用属于每个压缩器/过滤器的 FOURCC ID 查找每个选择的过滤器友好名称，因此我可以稍后向用户显示他们当前的选择，压缩器/过滤器友好名称显示在所选 FOURCC ID 旁边. 我怎样才能做到这一点？

请注意，我只想向用户显示与 AVISaveOptions() 对话框中显示的相同的长表单名称，该对话框通过向用户提供一个包含友好名称的列表框来提示用户进行选择。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T04:42:57.760

[`ICOpen`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd756960%28v=vs.85%29.aspx)打开给定的驱动程序`FourCC`，然后为[`ICGetInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd743156%28v=vs.85%29.aspx)您[`ICINFO`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd743162%28v=vs.85%29.aspx)提供带有描述的结构。

# php - 分页的条件 str_replace

> ID：10591900
> 
> 赞同：0
> 
> 时间：2012-05-14T22:29:54.963
> 
> 标签：php, javascript, html, pagination

大家好，

我有以下内容：

```
$html = '<ul class="pagination-all">';
    $html .= '<li class="pagination-start"><div class="img-start"></div>'.$list['start']['data'].'</li>';
    $html .= '<li class="pagination-prev"><div class="img-prev"></div>'.$list['previous']['data'].'</li>';
    $html .= '<ul class="pagination-data">';
    foreach($list['pages'] as $page) {
        $html .= '<li>'.$page['data'].'</li>';
    }
    $html .= '</ul>';
    $html .= '<li class="pagination-next">'. $list['next']['data'].'<div class="img-next"></div></li>';
    $html .= '<li class="pagination-end">'. $list['end']['data'].'<div class="img-end"></div></li>';
    $html .= '</ul>';

    return $html; 
```

我想知道如何制作它，所以如果它找到 Start ，字符串将“img-start”替换为“img-start-active”。如果找到 span class="pagenav"> End ，字符串将“img-end”替换为“img-end-active”。

我尝试过：

```
$string = $html;
if(strstr($string, '<span class="pagenav"> Start </span>'))
{
echo str_replace("img-start", "img-start-active", $string);
}
else
{
echo " ";
} 
```

不幸的是，我认为我没有正确使用它。最终结果是 - 虽然我在给定条件下得到了所需的字符串替换，但它呼应了整个分页，但没有格式化。

这是图像：![在此处输入图像描述](../Images/77014e421ab4a4038ae3880f329f6e87.png)

所以这是一团糟。

有没有办法进行这种搜索和替换但不创建第二个“分页”？

回答：

```
 $string = $html;
        if(strstr($string, '<span class="pagenav">Start</span>'))
        {
        return str_replace("img-start", "img-start-active", $string);
        }
        else
        {
        echo " ";
        } 
```

消除`return $html;`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:50:52.050

什么样的格式丢失了？原始字符串`$html`也没有格式:) 如果您`echo $html;`会看到那里也没有格式。如果需要，您可以`\n`在每行末尾添加换行符（确保也将字符串周围的单引号替换为双引号）。因此，例如，您的第二行将如下所示：

```
$html .= '<li class="pagination-start"><div class="img-start"></div>'.$list['start']['data']."</li>\n"; 
```

**编辑**（问题更新后）：

在这种情况下，可能是因为未设置新类名的 CSS。在您的 css 文件中，如果您创建新类`img-start-active`并`img-end-active`具有相同的内容，`img-start`并且`img-end`您不应该丢失任何格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:28:13.537

```
$string = $html;
    if(strstr($string, '<span class="pagenav">Start</span>'))
    {
    return str_replace("img-start", "img-start-active", $string);
    }
    else
    {
    echo " ";
    } 
```

消除`return $html;`

# internet-explorer-8 - TextRange offsetLeft 和 offsetTop 在 Internet Explorer 8 标准模式 (IE8) 中损坏

> ID：10591903
> 
> 赞同：9
> 
> 时间：2012-05-14T22:30:36.660
> 
> 标签：internet-explorer-8, textrange

在查找文本范围的位置时，我似乎发现 Internet Explorer 8 存在问题 - 例如当前选定的文本。我发现无法在 StackOverflow 或其他地方找到有关此问题的任何报告。

TextRange.offsetLeft 和 TextRange.offsetTop 报告范围的左上角，并且在我在 IE8 中看到的所有情况下，它们大致正确，*除非范围在 IFrame 内*。当范围在 IFrame 内时，offsetLeft 和 offsetTop 的值相对于 IFrame 在其父级中的位置移动负数。（见下面的例子）

此问题仅在以下情况下出现：

*   浏览器是IE8
*   该页面处于标准模式

**在以下情况下不会**出现此问题：

*   浏览器是IE7或IE10
*   该页面处于怪癖模式

我的问题：

*   其他人可以确认这个问题还是我疯了？
*   这是一个已知的问题？
*   是否有任何理智的解决方案或解决方法？（一个理智的解决方案是框架中的 JS 不需要知道任何关于其父窗口的信息）

谢谢。

问题示例：（查看 IE8 与 IE9 的区别）

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <title>IE8 IFrame Text Range Position Test Page</title>
        <style type="text/css">
            body {
                font-family: Tahoma;
            }
            #target {
                background-color: #CCC;
                position: absolute;
                left: 50px;
                top: 50px;
            }

            #bullsEye {
                position: absolute;
                background-color: red;
                width: 5px;
                height: 5px;
            }

            iframe {
                margin: 10px 75px;
            }
        </style>
        <script type="text/javascript" charset="utf-8">
            function target() {
                var range = document.body.createTextRange();
                range.moveToElementText(document.getElementById('target'));
                range.select();
                var bullsEye = document.createElement('div');
                bullsEye.id = 'bullsEye';
                bullsEye.style.left = range.offsetLeft + 'px';
                bullsEye.style.top = range.offsetTop + 'px';
                document.body.appendChild(bullsEye);
                document.getElementById('output').innerHTML = 'range.offsetLeft = ' + range.offsetLeft + ', range.offsetTop = ' + range.offsetTop;
            }
        </script>
    </head>
    <body>
        <div id="target">Target</div>
        <input type="button" value="Hit Target" onclick="target();"> <span id="output"></span>
        <br><br><br><br><br>
        <script>
            if (window.parent == window) document.write('<iframe src="?tfr" height="150" width="500"></iframe>');
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-06T00:58:47.383

过去，当尝试在浏览器中对选择位置进行一致的读取时，我已经退回到在选择所在的位置插入 span 元素并从该元素中读取……这有点笨拙，但似乎更可靠。

通过以这种方式处理事情，您应该完全规避那个特定的错误......我不知道这是否会被归类为理智;）虽然它已经过测试并且适用于所有这些用户代理：

1.  Mac OSX FF15/FF16
2.  Mac OSX Safari 5.1.7
3.  Mac OSX 铬 22
4.  Mac OSX 歌剧 12
5.  赢 XP FF 3.6
6.  赢 XP Safari 3.1
7.  赢XP IE7/IE8
8.  赢 7 IE9
9.  赢 7 FF15
10.  赢 7 铬 22

*（以下代码依赖于 jQuery，最好是 1.8+）*

**jsfiddle**

[http://jsfiddle.net/vCWha/](http://jsfiddle.net/vCWha/)

**css**

```
#__span__    {
  display: inline !important;
  *display: inline-block !important; /* IE7 works better with inline-block */
}

/* you can obviously ignore these, they are just used to show accuracy */
.crosshair-v {
  height: 0;
  width: 20px;
  border-bottom: 1px solid red;
  position: absolute;
  margin-left: -10px;
}

.crosshair-h {
  height: 20px;
  width: 0;
  border-right: 1px solid red;
  position: absolute;
  margin-top: -9px;
} 
```

**javascript**

```
(function($){
  $(function(){
    var span = $('<span id="__span__" />').get(0),
        crv = $('<div class="crosshair-v" />'),
        crh = $('<div class="crosshair-h" />');
    $('body').append(crv).append(crh);
    var getSelectionTopLeft = function(){
      var s,e,a,p,o,r,t;
      try{
        /// IE9+, FF, Chrome, Safari, Opera
        if ( window.getSelection ){
          s = window.getSelection();
          r = s.getRangeAt(0);
          a = r.startContainer;
          p = a.parentNode;
          if ( a.nodeType == 3 ){
            t = a.splitText(r.startOffset);
            p.insertBefore(span, t);
          }
          else if ( a.nodeType == 1 ){
            p.insertBefore(span, a);
          }
          o = $(span).position();
        }
        /// IE8-
        else if ( (s = document.selection) && (s.type != 'Control') ) {
          r = s.createRange();
          r.move('character',0);
          $('#__span__').remove();
          r.pasteHTML(span.outerHTML);
          o = $('#__span__').position();
        }
        /// quick fallback for certain older browsers for 
        /// whom $().position() fails.
        if ( o && o.left === 0 && o.left === o.top ) {
          e = span;
          while( e.offsetParent ){
            o.left += e.offsetLeft;
            o.top += e.offsetTop;
            e = e.offsetParent;
          }
        }
      }catch(ex){}
      return o;
    }
    $(document).mouseup(function(e){
      /// execute our function to calculate the selection position
      var o = getSelectionTopLeft();
      if ( o ){
        /// update the crosshair
        crv.css(o);
        crh.css(o);
      }
    });
  });
})(typeof jQuery != 'undefined' && jQuery); 
```

## 更新

昨晚有更多的时间来处理这个问题，所以这是我在您的示例中改进的代码 - 以下应该是完全跨浏览器的（至少在合理范围内）：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <title>IE8 IFrame Text Range Position Test Page</title>
  <style type="text/css">
    body {
        font-family: Tahoma;
    }

    #__span__    {
      display: inline !important;
      display: inline-block !important;
      min-height: 1em;
    }

    #target {
        background-color: #CCC;
        position: absolute;
        left: 50px;
        top: 50px;
    }

    #bullsEye {
        position: absolute;
        background-color: red;
        width: 5px;
        height: 5px;
    }

    iframe {
        margin: 10px 75px;
    }
  </style>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <script type="text/javascript" charset="utf-8">
    (function($){
        var bullsEye = $('<div id="bullsEye" />'), span = $('<span id="__span__"></span>').get(0);

        /// var is missed here on purpose to make the function globally accessible
        target = function() {                
          moveSelectionToElement( document.getElementById('target') );
          bullsEye
            .css( getSelectionTopLeft() )
            .appendTo('body');
        }

        /// because selectNodeContents seems to select outside the node we 
        /// need our own rangeToNodeContents that only highlights text nodes
        /// this is a side effect of having code inserted ranges & selections.
        var rangeToNodeContents = function(r, node){
          var i, l, tns = [];
          if ( node.nodeType == 1 && node.childNodes && (l = node.childNodes.length) ){
            for ( i=0;i<l;i++ ){
              if ( node.childNodes[i] && node.childNodes[i].nodeType == 3 ) {
                tns.push(node.childNodes[i]);
              }
              if ( tns.length > 1 ) {
                r.setStart(tns[0],0);
                r.setEnd(tns[tns.length-1],tns[tns.length-1].nodeValue.length);
              }
              else {
                r.selectNodeContents(node);
              }
            }
          }
          else {
            r.selectNodeContents(node);
          }
        }

        /// cross browser selection creator
        var moveSelectionToElement = function(elm) {
          var s,w,r,d; w = window; d = document;
          if (w.getSelection && d.createRange) {
            s = w.getSelection();
            r = d.createRange();
            rangeToNodeContents( r, elm );
            s.removeAllRanges();
            s.addRange(r);
          } else if (d.selection && d.body && d.body.createTextRange) {
            r = elm.createTextRange();
            r.select();
          }
        }

        /// cross browser getSelectionTopLeft
        var getSelectionTopLeft = function(){
          var s,e,a,p,o,r,t; o = {left:0,top:0};
          try{
            if ( window.getSelection ){
              s = window.getSelection();
              r = s.getRangeAt(0);
              a = r.startContainer;
              p = a.parentNode;
              if ( a.nodeType == 3 ){
                t = a.splitText(r.startOffset);
                p.insertBefore(span, t);
              }
              else if ( a.nodeType == 1 ){
                  p.insertBefore(span, a);
              }
              o = $(span).offset();
            }
            else if ( (s = document.selection) && (s.type != 'Control') ) {
              r = s.createRange();
              r.move('character',0);
              $('#__span__').remove();
              r.pasteHTML(span.outerHTML);
              o = $('#__span__').offset();
            }
            if ( o && o.left === 0 && o.left === o.top ) {
              e = span;
              while( e.offsetParent ){
                o.left += e.offsetLeft;
                o.top += e.offsetTop;
                e = e.offsetParent;
              }
            }
          }catch(ex){}
          return o;
        }

    })(typeof jQuery != 'undefined' && jQuery);
  </script>
</head>
<body>
  <div id="target">Target <b>abc</b> test</div>
  <input type="button" value="Hit Target" onmouseup="target();"> <span id="output"></span>
  <br><br><br><br><br>
  <script>
    if (window.parent == window){
      document.write('<iframe src="?tfr" height="150" width="500"></iframe>');
    }
  </script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T18:17:51.883

*   我仍然认为这是 IE8 中的一个错误，但有一个解决方法
*   在标准模式下使用`boundingLeft`和`boundingRight`。但在怪癖模式下使用`offsetLeft`和`offsetRight`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-10T20:01:11.590

我已经在我的 IE 8（在 Windows XP 上）中测试了您的示例页面，并且我已经能够重现该问题，因此我可以确认该问题，但我不能说它是否是一个已知问题。[我在这个答案](https://stackoverflow.com/questions/7133812/getting-offsetleft-of-a-text-range)
上找到了一个可行的解决方案（至少在 IE 8 上；我不能说它是否也适用于 IE 7 或 IE 9，因为我没有这些版本的测试环境）。 这是我修改后的测试页面：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <title>IE8 IFrame Text Range Position Test Page</title>
        <style type="text/css">
            body {
                font-family: Tahoma;
            }
            #target {
                background-color: #CCC;
                position: absolute;
                left: 50px;
                top: 50px;
            }

            #bullsEye {
                position: absolute;
                background-color: red;
                width: 5px;
                height: 5px;
            }

            iframe {
                margin: 10px 75px;
            }
        </style>
        <script type="text/javascript" charset="utf-8">
            function getSelectionTopLeft() {     
                var x = 0, y = 0;     // Use standards-based method only if Range has getBoundingClientRect     
                if (window.getSelection && document.createRange && 
                    typeof document.createRange().getBoundingClientRect != "undefined") {         
                    var sel = window.getSelection();         
                    if (sel.rangeCount > 0) {             
                        var rect = sel.getRangeAt(0).getBoundingClientRect();             
                        x = rect.left;             
                        y = rect.top;         
                    }     
                } else if (document.selection && document.selection.type != "Control") {         // All versions of IE         
                    var textRange = document.selection.createRange();         
                    x = textRange.boundingLeft;         
                    y = textRange.boundingTop;     
                }     
                return { x: x, y: y }; 
            }                   

            function target() {
                var range = document.body.createTextRange();
                range.moveToElementText(document.getElementById('target'));
                range.select();
                var bullsEye = document.createElement('div');
                bullsEye.id = 'bullsEye';
                bullsEye.style.left = range.offsetLeft + 'px';
                bullsEye.style.top = range.offsetTop + 'px';
                document.body.appendChild(bullsEye);
                //document.getElementById('output').innerHTML = 'range.offsetLeft = ' + range.offsetLeft + ', range.offsetTop = ' + range.offsetTop;
                var tl = getSelectionTopLeft();
                document.getElementById('output').innerHTML = tl.x + ',' + tl.y;
            }
        </script>
    </head>
    <body>
        <div id="target">Target</div>
        <input type="button" value="Hit Target" onclick="target();"> <span id="output"></span>
        <br><br><br><br><br>
        <script>
            if (window.parent == window) document.write('<iframe src="?tfr" height="150" width="500"></iframe>');
        </script>
    </body>
</html> 
```

也看看[Rangy 库](http://code.google.com/p/rangy/)：

> 一个跨浏览器的 JavaScript 范围和选择库。它提供了一个简单的基于标准的 API，用于在所有主要浏览器中执行常见的 DOM 范围和选择任务，抽象出 Internet Explorer 直至版本 8 和兼容 DOM 的浏览器之间该功能的完全不同的实现。

# mongodb - Grails - MongoDB 和插件域类

> ID：10591908
> 
> 赞同：0
> 
> 时间：2012-05-14T22:31:04.650
> 
> 标签：mongodb, grails, grails-domain-class, database

我需要 Hibernate，因为我使用的一些插件依赖于它。所以我同时使用 MongoDB 和 Hibernate 插件。

有没有办法让 MongoDB 处理插件域类而不直接编辑域类文件？最干净的方法是什么？

任何建议都是最受欢迎的。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T09:53:34.617

当然有办法

你应该添加

```
static mapWith = "mongo" 
```

例如在您的域类中

```
class Example {
  static mapWith = "mongo"
  ObjectId id
  String someProperty
} 
```

最好的解决方案是制作包含一些属性的抽象类

```
abstract class BaseDomain implements Serializable {
    static mapWith = "mongo"
    ObjectId id
} 
```

然后在您的域类上扩展它

```
class Example extends BaseDomain{
  String someProperty
} 
```

# php - 监控 mysql 表中的订单并存储订单历史记录

> ID：10591914
> 
> 赞同：0
> 
> 时间：2012-05-14T22:31:53.357
> 
> 标签：php, mysql, sql

1.  当用户可以单击“订单”并将他的订单保存到订单表时，我有一些网站。
2.  Orders 表有 3 个字段：`id`, `user_id`, `book_id`。

我需要一些脚本来监控订单表中的变化——如果出现一些订单，它将读取它们、“执行”并从订单表中删除。

我怎样才能有效地做到这一点？我以前从来没有做过这样的事情——我想到了一些 php 脚本，它会以一定的时间间隔（10-15 秒——它必须很快）执行，并且会读取订单表。但是后来我认为我必须保留订单历史记录 - 还有第二个问题 - 我应该为订单历史记录创建第二个表还是只是在订单表中添加“已完成”之类的字段？我一次问这两个问题，因为它们是相互关联的——也许当我的订单表将包含已完成的订单时，通过我的脚本查询它会效率不高。我正在寻找最佳解决方案。

我使用 MySQL 5.0 数据库...

- - - - - 编辑

我不能使用触发器 - 当订单出现在订单表中时，我必须执行一些 php 脚本来处理订单！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T23:02:52.120

你需要一个触发器。像这样的东西会起作用。

```
create trigger newOrderTrigger after insert on order_table for each row
//you order execution code goes here 
```

请参阅[MySQL 触发器文档](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)。我还发现本[教程](http://forge.mysql.com/wiki/Triggers)很有帮助。

至于你的第二个问题，这取决于你的要求。如果您需要完整的可审计历史记录，您可能应该将更改复制到新表中。如果你不这样做，添加一个 order_status 并将值从 open 更改为 complete 会减少工作量。

# jasper-reports - JasperReports 服务器：Excel 的预定导出不同于手动导出

> ID：10591917
> 
> 赞同：2
> 
> 时间：2012-05-14T22:32:04.537
> 
> 标签：jasper-reports, jasperserver

我有一个 JR 报告正在*JR 服务器*上运行。我已将其设置为使用`isIgnorePagination="true"`and导出`OnePagePerSheet="true"`。当我手动运行报告并从*JR 服务器*Web 界面和*iReport*界面选择导出时，这可以按预期工作，但是如果我安排报告自动运行，则导出的电子表格有很多页，而不是我期望的 7 页。基本上，它在计划时忽略***isIgnorePagination***设置，但在手动运行时忽略。有什么区别？

# javascript - jQuery animate() 在 Chrome 中不起作用

> ID：10591921
> 
> 赞同：1
> 
> 时间：2012-05-14T22:32:40.230
> 
> 标签：javascript, jquery

我有一个滚动回到顶部的按钮，它可以让用户顺利滑回页面顶部。它适用于 Firefox，但不适用于 Chrome：

```
$('a#scroll-to-top').click(function() {
    $('html').animate({
        scrollTop: 0
    }, 500);
    return false;
});

<a href="#" id="scroll-to-top">Up Top</a> 
```

如何让它在 Chrome 中工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T22:38:51.043

您想使用此代码：

```
$('a#scroll-to-top').click(function() {
    $('html, body').animate({
        scrollTop: 0
    }, 500);
    return false;
}); 
```

​这里是[例子](http://jsfiddle.net/ZemdY/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-23T11:00:44.023

只需使用**body**而不是**html**如下所示：

```
$('a#scroll-to-top').click(function() {
  $('body').animate({
    scrollTop: 0
 }, 500);
  return false;
}); 
```

# android - 修改 android.jar 类并在 Android 设备中替换它？

> ID：10591924
> 
> 赞同：2
> 
> 时间：2012-05-14T22:33:08.467
> 
> 标签：android, android-widget, dex

我下载了Android SDK的源代码并修改了android.widget.TextView类。

现在，我想弄清楚如何用修改后的设备替换在我的设备上运行的实际 TextView。

我发现编译的类位于我手机上的 /system/framework 中。

关于如何替换适当的 jar 和 odex 文件的任何指示？

注意：我还在 google 群组中读到，修改 android 的 bits-n-pieces 是行不通的，我们需要构建整个源代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T00:23:34.293

> 我还在 google 群组中读到，修改 android 的 bit-n-pieces 是行不通的，我们需要构建整个源代码。

如果您只想在这里和那里更改几行，则不必重建整个系统。基本上，您需要手机，您可以在其中使用`adb`、 和`apktool`或拉取（和推送！！）文件`smali`，具体取决于您计划更改的资源或代码。

如果是资源（本地化、翻译）：

1.  从手机中提取 framework-res.jar，用于`apktool if framework-res.jar`将其设置为您未来操作的默认框架。**每次**使用新手机或新版本的 Android 时，您都必须拉取和导入框架。

2.  拉出要更改的文件。

3.  用于`apktool d`反编译文件。

4.  进行所需的更改。

5.  用于`apktool b`编译新文件。

6.  拉链并签名。

7.  将新文件推送到手机。

如果您想更改代码，请使用`framework.jar`而不是`framework-res.jar`和`smali/backsmali`来编译/反编译`.dex`文件。

此外，最好为您将要更改的文件制作备份副本，以防万一出现问题。

# c# - 创建和使用 C# DLL

> ID：10591926
> 
> 赞同：0
> 
> 时间：2012-05-14T22:33:18.393
> 
> 标签：c#, dll

我正在使用 VS 2010。我创建了一个 C# 类并将其编译为 DLL，然后向其中添加了一个 windows 窗体项目来测试 dll。我在解决方案资源管理器的 TestApp 项目中添加了对 DLL 的引用。两个项目都编译没有错误。但是当我运行 TestApp 时，当我在 dll 中调用一个方法时，我会得到一个 NullReferenceException。错误说没有对象的实例，我不明白它是被调用的方法。

我所做的一切都与我在互联网上找到的其他 DLL 示例相同。例如： http: [//msdn.microsoft.com/en-us/library/3707x96z (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/3707x96z(v=vs.100).aspx)

[http://coderock.net/how-to-create-a-dll-file-in-visual-studio-2010/](http://coderock.net/how-to-create-a-dll-file-in-visual-studio-2010/)

但我显然错过了一些基本的东西。

// DLL 项目

```
namespace SLink
{
    public class AmpAPI
    {
        public String[] ReadID( Int32 id )
        {
            String[] result = new string[] { "A", "B", "C", "D" };
            return result;
        }
    }
} 
```

// 测试应用

```
using SLink;

namespace TestApp
{
    public partial class frmMain : Form
    {
        AmpAPI amp;

        public frmMain()
        {
            InitializeComponent();
        }

        private void frmMain_Load( object sender, EventArgs e )
        {
            amp = new AmpAPI();
        }

        private void btnUpdate_Click( object sender, EventArgs e )
        {
            String[] result = new String[] { "", "", "", "" };
            result = amp.ReadID( 0 ); // <-- NullReferenceException
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T22:35:21.067

`frmMain_Load`加载表单时，您的方法似乎没有被调用。

您只是复制并粘贴代码吗？这还不足以将该方法注册为事件的事件处理程序`Load`。

*   您可以`Load`通过在设计器中双击表单来为表单的事件添加新的处理程序。然后您可以编辑方法的主体。
*   或者，您可以选择现有方法来处理事件。为此，请单击设计器中的表单，转到属性，选择事件，查找`Load`，然后从下拉列表中选择您的方法。

![在 WinForms 设计器中向 Load 事件添加处理程序](../Images/43418822d8b125cf3e123b2a49faaf75.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T22:49:54.043

尝试这个：

```
 private void btnUpdate_Click( object sender, EventArgs e )
    {
        String[] result = amp.ReadID( 0 );
    } 
```

不确定它是否喜欢你以前的初始化数组的实现。

# mysql - MySQL 月度趋势

> ID：10591932
> 
> 赞同：0
> 
> 时间：2012-05-14T22:34:07.890
> 
> 标签：mysql, timestamp, trending

我正在使用一个图表程序来显示每月的库存总额。到目前为止，我只有 5 月的数据（6 月的数据将在 6 月 1 日自动插入到表中并加盖时间戳）。

我正在使用以下查询，它返回 1 行，显示 5 月份的 375 台设备，如下所示：

```
devices     created_month
-------     -------------
375         5/1/2012 
```

此查询设置是否正确，以便在 6 月 1 日，如果我有 380 台设备，我将收到以下输出？

```
devices     created_month
-------     -------------
375         5/1/2012
380         6/1/2012 
```

我只是想确认我正确地解释了这个查询。

```
SELECT count(device_type) as devices, description, ip_address, user_tag,                  
  DATE_FORMAT(LAST_UPDATE,"%Y-%m") as created_month 
FROM ahrq_inventory_internal 
GROUP BY created_month 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T23:05:07.553

是的，我相信您的代码会正常工作。

您在查询 ( ) 中有其他列，`description, ip_address, user_tag`它们不是必需的。

事实上，让他们在那里会产生误导。列中的任何值都没有意义，因为如果您按月对它们进行分组，这些值将毫无意义——除非它们对于整个月的每条记录都具有相同的值！

因此，出于这个原因，我建议将其更改为：

```
SELECT count(device_type) as devices, 
  DATE_FORMAT(LAST_UPDATE,"%Y-%m") as created_month 
FROM ahrq_inventory_internal 
GROUP BY created_month 
```

# ios - iOS 上的 AirPrint：如何将 RAW 数据发送到 Boca 打印机？

> ID：10591936
> 
> 赞同：2
> 
> 时间：2012-05-14T22:34:39.003
> 
> 标签：ios, airprint, thermal-printer, raw-data

我正在编写一个需要使用 Boca 热敏打印机打印的 iOS 应用程序。他们使用专有语言 (FGL) 以 ASCII 字符串形式使用命令来布局内容。我已经使用可免费下载的 AirPrint 激活工具为 Boca 打印机启用了 AirPrint。

我的问题是，使用`UIPrintInteractionController`，我所能做的就是发送已经格式化的文本（BOCA 将无法识别 FGL 命令，像普通文本一样打印它们）或者`NSData`需要一个 PDF 标题（我的数据没有没有，所以我不能这样打印）。

有没有办法绕过这个框架并将原始 ASCII 数据发送到打印机？我应该使用`NSStream`s 并以低级别的方式管理打印作业吗？

在那种情况下，有没有办法在网络上获取打印机的地址，以便我可以建立到它的套接字连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T04:52:57.817

听起来好像您需要一个 3rd Party 库或自己编写一个

但我不确定网络打印机功能的内部结构，但我是你我会问自己：

*   打印机是否将其 IP 地址广播到网络？
*   如果不是，它提供了哪些功能使其能够被其他设备自我发现？
*   打印机是否响应来自想要连接的设备的特定广播消息？
*   它是否仅依赖于 UDP 或 TCP 数据包？

如果您可以与他们的客户服务取得联系，如果网络上没有记录这些信息，您可能会获得这些信息。

对不起，我不能给你一个直接的答案，但希望这些问题能帮助你找到答案

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T04:41:16.860

大多数打印机都有某种自检功能，可以打印有关打印机的一些信息，包括它的 IP 地址。看看它是否在在线手册中提到它。这通常类似于在打开它的同时按住 Feed 按钮。获得 IP 地址后，打开与它的连接并发送数据应该相当简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-10T12:05:34.240

OP 很可能已经完成了这项工作，但是本着 StackOverflow 的精神，在这个利基问题上......

如果您知道打印机的 IP 地址（您可以使用打印机上的一个按钮通过测试打印找到此地址），您可以通过端口 9100 上的 TCP 套接字发送 FGL 命令。我在此使用[过 FastSocket](https://github.com/dreese/FastSocket)通过以太网连接的 BOCA 热敏票据打印机。

假设包含 FGL 命令的文本文件`Tickets/test.txt`在您的应用程序包中，实现此目的的代码（在 Swift 中）是：

```
let client:FastSocket = FastSocket(host: PRINTER_IP_ADDRESS, andPort: "9100")
client.connect()

let ticketPath:String! = NSBundle.mainBundle().pathForResource("test", ofType: "txt", inDirectory: "Tickets")
let count:Int = client.sendFile(ticketPath)

// Do some error checking here

client.close() 
```

等效的 Objective-C 代码应该很容易计算出来。

由于 FastSocket 同步执行上述命令，请确保在后台线程中运行上述代码以防止 UI 冻结。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T22:39:58.180

您可以尝试[外部附件框架](https://developer.apple.com/library/ios/#documentation/ExternalAccessory/Reference/ExternalAccessoryFrameworkReference/_index.html)将数据发送到您的打印机。它用于连接外部外围设备。可能这就是您正在寻找的。

# .net - 获取括号中的值 String VB.NET

> ID：10591937
> 
> 赞同：1
> 
> 时间：2012-05-14T22:34:44.260
> 
> 标签：.net, vb.net, string, split

我有一个这样的字符串：

```
Dim value as string = "hy the number is (30.01)" 
```

我怎样才能把这个数字 30.01 变成另一个变量？我正在考虑使用`split`，我如何使用来获得这个值谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T22:43:38.857

使用正则表达式 (System.Text.RegularExpressions)：

```
Dim m As Match = Regex.Match(value, "\((?<n>\d+\.\d{2})\)")
If m.Success Then
  Dim n As Decimal = Decimal.Parse(m.Groups("n").Value)
End If 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T22:51:12.160

如果您的格式将完全相同，您可以尝试像您提到的那样使用拆分。如果发生任何变化，这可能非常脆弱。

看看这是否适合你。

```
Dim result As Double
Dim value As String = "hy the number is (30.01)"
Dim subValue() As String = value.Split("(")
subValue(1) = subValue(1).TrimEnd(")")
If Not Double.TryParse(subValue(1), result) Then
    'Error handling code here
End If 
```

# action - 打开图形操作“post”因语法错误而不断被拒绝

> ID：10591945
> 
> 赞同：0
> 
> 时间：2012-05-14T22:35:11.413
> 
> 标签：action, grammar, facebook-opengraph

我正在创建一个名为“发布”的 Facebook 开放图形操作。它仅以过去时出现，您可以查看下面的屏幕截图以了解其措辞方式。我找不到任何语法问题。有其他人能够权衡为什么这会被拒绝吗？

[http://i.stack.imgur.com/uTfJf.png](http://i.stack.imgur.com/uTfJf.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T07:26:33.300

At the moment, you MUST provide a present and a past tense (even though in this case, the present tense makes no sense). No matter, the present tense version won't ever be displayed as long as your start_time == end_time for the action.

So you need to submit: present: 'is posting' past: 'posted'

This requirement is being reviewed but thats the state of play at the moment.

# systemc - 在 systemC 中，如何在 end_of_simulation 例程中获得 sc_time

> ID：10591949
> 
> 赞同：2
> 
> 时间：2012-05-14T22:35:28.767
> 
> 标签：systemc

我想报告模拟结束时的时间。我以为我会使用 end_of_simulation 例程，只需在例程中执行一个 sc_timestamp 即可。

问题是内核在 end_of_simulation 之前终止，我得到了一个虚假的时间戳。

我不能真正使用线程来确定这一点，因为让我脱离模拟的是所有线程都在等待事件。没有“主线程”我可以只存储时间戳。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-24T17:52:09.633

你可以使用类似的东西：

```
cout << "Start of simulation is " << sc_time_stamp() << endl;
sc_start (); // sc_start (-1);
cout << "End of simulation is " << sc_time_stamp() << endl; 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T01:27:21.010

这似乎有点骇人听闻，但是您可以在代码中可能是 sim 结束的关键点使用 sc_time_stamp() 更新全局时间变量，例如在等待之前或从耗时函数返回之前？然后从 sc_start() 返回后，您将获得您关心的代码的最后时间值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T14:44:58.927

我不确定我是否理解你的问题。

要运行模拟，必须规定它必须花费的总时间。sc_start（总时间，SC_NS）。

total_time 是模拟的最后时间。

# mysql - 左加入为新列？

> ID：10591952
> 
> 赞同：9
> 
> 时间：2012-05-14T22:35:52.407
> 
> 标签：mysql, database, join

我试图在表的同一列上执行多个 LEFT JOIN。我需要将“table2.words”与“table1.color”和“table2.words”与“table1.food”进行左连接。我该怎么做呢？我可以通过使左连接的“table2.words”成为一个新列来做到这一点吗？

**我的 SQL 代码：**

```
SELECT table1.id, table1.color, table2.words
FROM table1
LEFT JOIN table2 ON table1.color=table2.id
LEFT JOIN table2 ON table1.food=table2.id 
```

**表格1：**

```
--------------------------------
| id     | color    | food     |
--------------------------------
| 1      | 1        | 3        |
| 2      | 1        | 4        |
| 3      | 1        | 3        |
| 4      | 1        | 4        |
| 5      | 2        | 3        |
| 6      | 2        | 4        |
| 7      | 2        | 3        |
| 8      | 2        | 4        |
-------------------------------- 
```

**表2：**

```
---------------------------
| id     | words          |
---------------------------
| 1      | yellow         |
| 2      | blue           |
| 3      | cookies        |
| 4      | milk           |
--------------------------- 
```

**我试图输出的内容：**

```
----------------------------------------
| id     | colorname    | foodname     |
----------------------------------------
| 1      | yellow       | cookies      |
| 2      | yellow       | milk         |
| 3      | yellow       | cookies      |
| 4      | yellow       | milk         |
| 5      | blue         | cookies      |
| 6      | blue         | milk         |
| 7      | blue         | cookies      |
| 8      | blue         | milk         |
---------------------------------------- 
```

注意：我无法更改表结构。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-14T22:41:30.650

```
SELECT
    table1.id,
    table2_A.words colorname,
    table2_B.words foodname
FROM table1 
LEFT JOIN table2 table2_A ON table1.color=table2_A.id 
LEFT JOIN table2 table2_B ON table1.food=table2_B.id; 
```

您的样本数据

```
mysql> drop database if exists supercoolville;
Query OK, 2 rows affected (0.06 sec)

mysql> create database supercoolville;
Query OK, 1 row affected (0.00 sec)

mysql> use supercoolville;
Database changed
mysql> create table table1
    -> (
    ->     id int not null auto_increment,
    ->     color int,
    ->     food int,
    ->     primary key (id)
    -> );
Query OK, 0 rows affected (0.06 sec)

mysql> insert into table1 (color,food) values
    -> (1,3),(1,4),(1,3),(1,4),
    -> (2,3),(2,4),(2,3),(2,4);
Query OK, 8 rows affected (0.06 sec)
Records: 8  Duplicates: 0  Warnings: 0

mysql> create table table2
    -> (
    ->     id int not null auto_increment,
    ->     words varchar(20),
    ->     primary key (id)
    -> );
Query OK, 0 rows affected (0.05 sec)

mysql> insert into table2 (words) values
    -> ('yellow'),('blue'),('cookies'),('milk');
Query OK, 4 rows affected (0.07 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> select * from table1;
+----+-------+------+
| id | color | food |
+----+-------+------+
|  1 |     1 |    3 |
|  2 |     1 |    4 |
|  3 |     1 |    3 |
|  4 |     1 |    4 |
|  5 |     2 |    3 |
|  6 |     2 |    4 |
|  7 |     2 |    3 |
|  8 |     2 |    4 |
+----+-------+------+
8 rows in set (0.01 sec)

mysql> select * from table2;
+----+---------+
| id | words   |
+----+---------+
|  1 | yellow  |
|  2 | blue    |
|  3 | cookies |
|  4 | milk    |
+----+---------+
4 rows in set (0.00 sec) 
```

我的查询结果

```
mysql> SELECT
    ->     table1.id,
    ->     table2_A.words colorname,
    ->     table2_B.words foodname
    -> FROM table1
    ->     LEFT JOIN table2 table2_A ON table1.color=table2_A.id
    ->     LEFT JOIN table2 table2_B ON table1.food=table2_B.id
    -> ;
+----+-----------+----------+
| id | colorname | foodname |
+----+-----------+----------+
|  1 | yellow    | cookies  |
|  2 | yellow    | milk     |
|  3 | yellow    | cookies  |
|  4 | yellow    | milk     |
|  5 | blue      | cookies  |
|  6 | blue      | milk     |
|  7 | blue      | cookies  |
|  8 | blue      | milk     |
+----+-----------+----------+
8 rows in set (0.00 sec)

mysql> 
```

**更新 2012-05-14 19:10 EDT**

如果食物或颜色的值不存在，这里是调整后的查询：

```
SELECT
    table1.id,
    IFNULL(table2_A.words,'Unknown Color') colorname,
    IFNULL(table2_B.words,'Unknown Food') foodname
FROM table1 
LEFT JOIN table2 table2_A ON table1.color=table2_A.id 
LEFT JOIN table2 table2_B ON table1.food=table2_B.id; 
```

我将向 table1 添加行并运行这个新查询

```
mysql> drop database if exists supercoolville;
Query OK, 2 rows affected (0.13 sec)

mysql> create database supercoolville;
Query OK, 1 row affected (0.00 sec)

mysql> use supercoolville;
Database changed
mysql> create table table1
    -> (
    ->     id int not null auto_increment,
    ->     color int,
    ->     food int,
    ->     primary key (id)
    -> );
Query OK, 0 rows affected (0.08 sec)

mysql> insert into table1 (color,food) values
    -> (1,3),(1,4),(1,3),(1,4),
    -> (2,3),(2,4),(2,3),(2,4),
    -> (5,3),(5,4),(2,6),(2,8);
Query OK, 12 rows affected (0.07 sec)
Records: 12  Duplicates: 0  Warnings: 0

mysql> create table table2
    -> (
    ->     id int not null auto_increment,
    ->     words varchar(20),
    ->     primary key (id)
    -> );
Query OK, 0 rows affected (0.08 sec)

mysql> insert into table2 (words) values
    -> ('yellow'),('blue'),('cookies'),('milk');
Query OK, 4 rows affected (0.06 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> select * from table1;
+----+-------+------+
| id | color | food |
+----+-------+------+
|  1 |     1 |    3 |
|  2 |     1 |    4 |
|  3 |     1 |    3 |
|  4 |     1 |    4 |
|  5 |     2 |    3 |
|  6 |     2 |    4 |
|  7 |     2 |    3 |
|  8 |     2 |    4 |
|  9 |     5 |    3 |
| 10 |     5 |    4 |
| 11 |     2 |    6 |
| 12 |     2 |    8 |
+----+-------+------+
12 rows in set (0.00 sec)

mysql> select * from table2;
+----+---------+
| id | words   |
+----+---------+
|  1 | yellow  |
|  2 | blue    |
|  3 | cookies |
|  4 | milk    |
+----+---------+
4 rows in set (0.00 sec)

mysql> SELECT
    ->     table1.id,
    ->     IFNULL(table2_A.words,'Unknown Color') colorname,
    ->     IFNULL(table2_B.words,'Unknown Food') foodname
    -> FROM table1
    -> LEFT JOIN table2 table2_A ON table1.color=table2_A.id
    -> LEFT JOIN table2 table2_B ON table1.food=table2_B.id;
+----+---------------+--------------+
| id | colorname     | foodname     |
+----+---------------+--------------+
|  1 | yellow        | cookies      |
|  2 | yellow        | milk         |
|  3 | yellow        | cookies      |
|  4 | yellow        | milk         |
|  5 | blue          | cookies      |
|  6 | blue          | milk         |
|  7 | blue          | cookies      |
|  8 | blue          | milk         |
|  9 | Unknown Color | cookies      |
| 10 | Unknown Color | milk         |
| 11 | blue          | Unknown Food |
| 12 | blue          | Unknown Food |
+----+---------------+--------------+
12 rows in set (0.00 sec)

mysql> 
```

给定任何无效数据，`LEFT JOIN`仍然需要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T22:41:51.633

尝试：

```
SELECT table1.id, colorcodes.words, foodcodes.words
FROM table1
LEFT JOIN table2 as colorcodes
    ON colorcodes.id = table1.color
LEFT JOIN table2 as foodcodes
    ON foodcodes.id= table1.food 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T22:49:56.203

这是查询：

```
SELECT a.id as id, b.words as colorname, c.words as foodname
FROM table1 a
  LEFT JOIN table2 b ON b.id = a.color
  LEFT JOIN table2 c ON c.id = a.food 
```

注意：从您的数据中可以看出 a`LEFT JOIN`是不需要的。如果 table1 中没有 color 或 food 为 null 的行，那么您可以省略`LEFT`.

# javascript - 修复底部的div。（不使用javascript）

> ID：10591956
> 
> 赞同：1
> 
> 时间：2012-05-14T22:36:12.043
> 
> 标签：javascript, html, css, layout

为了解释我的问题，我做了以下代码：

[http://jsfiddle.net/Ridermansb/REYZ6/](http://jsfiddle.net/Ridermansb/REYZ6/)

问题是。

div“页脚”**应始终粘在屏幕**底部（底部：0）。
**但是**如果 div“内容”增长到创建滚动条的地步，那么 div“页脚”应该就在 div“内容”的下方

一个永远不应该相互重叠！

正如您在示例中看到的，如果屏幕太小，“#footer”将覆盖“#content”。这不可能发生！

谢谢！

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T12:51:16.677

```
.container {
    position: relative;
}
.container .glued_bottom {
    position: absolute;
    bottom: 0;
    height: 20px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T07:40:07.800

根据我对你的小提琴的理解，你想要做的事情是不可能用**css**做的。也就是说，我在 jquery 中想出了一行，你可以用它来做我认为你想做的事情：

```
$('#spacer').height($("#footer > div").height());​ 
```

[演示](http://jsfiddle.net/Daedalus/6arBM/2/)

非jquery代码：

```
document.getElementById('spacer').style.height = document.getElementById('​​​footer-inner').offsetHeight + "px";​​​​​ 
```

[演示](http://jsfiddle.net/Daedalus/6arBM/3/)

然而，这两个片段都需要对您的 HTML 结构稍作更改；他们都添加了一个`spacer`div，该 div 将内容从`footer`div 下推出。然而，第二个片段要求您也为页脚的内部 div 提供一个 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T22:50:46.980

解决页脚布局的几种方法

在某些情况下使用百分比高度可以工作

```
html, body { height:100%;}
#header {height:10%; }
#content { height:80%; }
#footer { height:10%;} 
```

欣赏它可能不适合您网站的内容，但值得一看作为唯一的 css 选项。

另一个是使用背景css元素，将页面着色为页脚颜色（比如说绿色）

并将标题和内容元素设置为例如白色

```
body { background-color:green; }
#header { background-color:white; }
#content { background-color:white; } 
```

...几个非 Javascript 的想法可能会玩

是的，固定或绝对定位将导致重叠，而无需添加一些 Javascript 来保持监视并进行重新定位更改。

希望有一点帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T23:17:16.650

通过[这个粘性页脚教程](http://jsfiddle.net/REYZ6/19/)。以下代码应该是创建粘性页脚所需的全部内容。

```
* {
    margin: 0;
}
html, body {
    height: 100%;
}
.wrapper {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -142px; /* the bottom margin is the negative value of the footer's height */
}
.footer, .push {
    height: 142px; /* .push must be the same height as .footer */
}

/*

Sticky Footer by Ryan Fait
http://ryanfait.com/

*/ 
```

在您的情况下，除了 html 和 body 的 100% 高度之外，您几乎错过了上述所有 css。我已经更新了你的 jsfiddle。

[现场演示](http://jsfiddle.net/REYZ6/19/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-14T22:38:47.053

`position:fixed;`在底部和左侧设置的元素上使用 CSS 。例如：

```
#footer {
position: fixed;
bottom: 0px;
left: 0px;
} 
```

# php - 如何关闭 PHP 错误记录

> ID：10591958
> 
> 赞同：1
> 
> 时间：2012-05-14T22:36:52.503
> 
> 标签：php, apache, logging

我们最近将服务器从 PHP4 升级到 PHP5.4

有一个正在运行的应用程序在日志文件中记录了很多错误。其中大多数是不推荐使用的错误，或者由于 PHP 版本的变化而导致的一些小问题。

我现在没有时间解决所有问题，但 error_log 文件在短短几天内就膨胀到了 10G。

在 php.ini 我设置 log_errors = Off

我还可以做些什么 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T22:51:43.437

**只需在 php.ini 中关闭这些警告**

```
error_reporting  = E_ALL & ~E_DEPRECATED 
```

**在运行时：**

```
error_reporting(E_ALL & ~E_DEPRECATED); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T22:53:59.813

这取决于您要报告哪些错误（如果有）。如果您不希望报告任何错误（我认为这是个坏主意），请使用：

```
error_reporting(0); 
```

在脚本的顶部。

如果您只想关闭已弃用的错误，则需要使用一些使用[预定义错误常量的](http://www.php.net/manual/en/errorfunc.constants.php)[位运算符](http://php.net/manual/en/language.operators.bitwise.php)。我相信以下内容会起作用并符合您的想法：

```
error_reporting(E_ALL ^ (E_DEPRECATED & E_STRICT & E_NOTICE)) 
```

这仍然会留下致命错误和可捕获错误（这 3 个中的 2 个将停止脚本，因此它们很容易捕获），但会忽略“你的脚本是旧的”类型错误。

也可以将不太需要的错误发送到另一个错误日志，以便以后处理它们，但不会阻塞主错误日志。问有没有兴趣。

## 快速编辑：

因为`E_STRICT`不包含在 中`E_ALL`，所以上面会打开*（* `E_STRICT`只有当我们假设**ALL**意味着所有这些（所有位都翻转）时才会混淆。所以这将产生关闭这三个错误的预期结果：

```
error_reporting(E_ALL ^ (E_DEPRECATED & E_NOTICE)) 
```

或者，要吃掉我对zuul答案的评论的话，这也可以（尽管逻辑让我头疼）：

```
error_reporting(E_ALL & ~(E_DEPRECATED | E_STRICT | E_NOTICE)) 
```

此外，由于您特别提到了 Apache，您应该知道您不能在 PHP 脚本之外使用预定义的错误常量，您必须使用实际的位掩码值。在这种情况下，您可以将以下内容添加到 config 或 htaccess 文件中：

```
php_value error_reporting 22519 
```

我在文档中找不到在这种情况下支持按位操作的任何地方，因此如果您想调整 error_reporting 级别，您可以简单地创建一个具有以下内容的 php 脚本：

```
echo E_ALL & ~(E_DEPRECATED | E_STRICT | E_NOTICE); 
```

这将输出该位掩码的十进制形式以使用（显然更改常量以匹配您要关闭的内容）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T22:43:44.927

您可以尝试将以下内容添加到文件顶部：

```
error_reporting(E_NONE); 
```

# php - Preg 从文本中替换 soundcloud 链接

> ID：10591959
> 
> 赞同：0
> 
> 时间：2012-05-14T22:36:52.827
> 
> 标签：php, replace, soundcloud

```
$text='some text and text http://soundcloud.com/disclosuremusic/whats-in-your-head some other text http://soundcloud.com/bad-panda-records/indian-wells-04 and again text blabla'; 

$text = preg_replace('#(?:https?://).soundcloud\.com/([\-a-z0-9_]+/[\-a-z0-9_]+)#siU','<object height="81" width="100%"><param name="movie" value="http://player.soundcloud.com/player.swf?url=$1&amp;g=bb"></param><param name="allowscriptaccess" value="always"></param><embed allowscriptaccess="always" height="81" src="http://player.soundcloud.com/player.swf?url=$1&amp;g=bb" type="application/x-shockwave-flash" width="100%"></embed></object> <a href="$1">$1</a>', $text); 
```

试图从文本中预置一个声音云链接，但似乎没有运气。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:43:02.407

这 ”。” 在“soundcloud\.com”匹配失败之前

```
'%(?:https?://)(?:www\.)?soundcloud\.com/([\-a-z0-9_]+/[\-a-z0-9_]+)%im' 
```

你需要考虑www。有吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T23:49:39.103

```
$text='some text and text http://soundcloud.com/qcntoz some other text http://soundcloud.com/qcntoz and again text blabla'; 

$text = preg_replace('#(?:https?://).soundcloud\.com/([\-a-z0-9_]+/[\-a-z0-9_]+)#siU','<object height="81" width="100%"><param name="movie" value="http://player.soundcloud.com/player.swf?url=$1&amp;g=bb"></param><param name="allowscriptaccess" value="always"></param><embed allowscriptaccess="always" height="81" src="http://player.soundcloud.com/player.swf?url=$1&amp;g=bb" type="application/x-shockwave-flash" width="100%"> </embed></object> <a href="$1">$1</a>', $text); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T22:52:43.970

这将做到：

```
$text = preg_replace('/((http?:\/\/)soundcloud\.com\/([\-a-z0-9_]+/[\-a-z0-9_]+))/i','<object height="81" width="100%"><param name="movie" value="http://player.soundcloud.com/player.swf?url=$1&amp;g=bb"></param><param name="allowscriptaccess" value="always"></param><embed allowscriptaccess="always" height="81" src="http://player.soundcloud.com/player.swf?url=$1&amp;g=bb" type="application/x-shockwave-flash" width="100%"></embed></object> <a href="$1">$1</a>', $text); 
```

您在“soundcloud”之前有一个额外的点，并且您没有正确逃脱。

# iphone - /n 在来自 XML 解析的数组中

> ID：10591961
> 
> 赞同：1
> 
> 时间：2012-05-14T22:36:56.267
> 
> 标签：iphone, ios, ios5, xml-parsing

我正在使用 NSXMLParser 解析远程 XML 文件以在我的应用程序中显示信息。

我将字符串存储在 NSMutableArray 中。该信息在 4 个标签中提供，这些标签会以更多信息重复。

现在，我以“/n”“”的形式在索引处获取对象。“真实数据”、“/n”、“真实数据”

我曾尝试使用 Stringsbyreplacingoccurencesofstring 函数，但这似乎只是删除了 /n 并返回了一个空索引。

请帮忙。

编码：

```
 - (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict{

    currentElement = elementName ;

}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{

    string1 = string;
    string1 = [string1 stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@" \n\t"]];
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{

    if([currentElement isEqualToString:@"CourseID"])
    {

        [CourseID addObject:string1];
    }

    if([currentElement isEqualToString:@"CourseName"])
    {
        [CourseName addObject:string1];

    }
    if ([currentElement isEqualToString:@"CourseDescription"])
    {
        [CourseDescription addObject:string1];
    }
    if ([currentElement isEqualToString:@"DescriptionType"])
    {
        [DescriptionType addObject:string1];

    }

}

- (void)parserDidEndDocument:(NSXMLParser *)parser{

    NSLog(@"Course Name: %@",CourseName);
    NSLog(@"CourseID: %@",CourseID);
    NSLog(@"CourseDescription: %@",CourseDescription);
    NSLog(@"DescriptionType: %@",DescriptionType);

} 
```

输出：

```
 2012-05-15 04:03:09.011 DispatchTestPrep[2290:f803] Course Name: (
    "Weather Theory",
    Turbulence,
    "Non-Graphic Weather",
    "Graphic Weather",
    Airport
)
2012-05-15 04:03:09.012 DispatchTestPrep[2290:f803] CourseID: (
    1,
    2,
    3,
    4,
    5
)
2012-05-15 04:03:09.012 DispatchTestPrep[2290:f803] CourseDescription: (
    "Aviation Weather Theory",
    Turbulence,
    "Non-Graphic Weather",
    "Graphic Weather",
    Airport
)
2012-05-15 04:03:09.012 DispatchTestPrep[2290:f803] DescriptionType: (
    Text,
    "",
    Text,
    "",
    Text,
    "",
    Text,
    "",
    Text,
    "",
    ""
) 
```

如您所见，最后一个“DescriptionType”数组在索引处显示那些空对象。

正在解析的 XML 文件是：

```
<NewDataSet><Table><CourseID>1</CourseID><CourseName>Weather Theory</CourseName><CourseDescription>Aviation Weather Theory</CourseDescription><DescriptionType>Text</DescriptionType></Table><Table><CourseID>2</CourseID><CourseName>Turbulence</CourseName><CourseDescription>Turbulence</CourseDescription><DescriptionType>Text</DescriptionType></Table><Table><CourseID>3</CourseID><CourseName>Non-Graphic Weather</CourseName><CourseDescription>Non-Graphic Weather</CourseDescription><DescriptionType>Text</DescriptionType></Table><Table><CourseID>4</CourseID><CourseName>Graphic Weather</CourseName><CourseDescription>Graphic Weather</CourseDescription><DescriptionType>Text</DescriptionType></Table><Table><CourseID>5</CourseID><CourseName>Airspace & Airport</CourseName><CourseDescription>Airspace & Airport</CourseDescription><DescriptionType>Text</DescriptionType></Table></NewDataSet> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T04:13:48.710

试试这个 ：

```
- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string { 
string =[string stringByReplacingOccurrencesOfString:@"\t" withString:@""];
string =[string stringByReplacingOccurrencesOfString:@"\n" withString:@""];
if(!currentElement) 
    currentElement = [[NSMutableString alloc] initWithString:string];
else
    [currentElement appendString:string]; 
```

}

# android - 如何在 Rails 3 应用程序中使用 Sencha Touch 2？

> ID：10591962
> 
> 赞同：3
> 
> 时间：2012-05-14T22:37:04.473
> 
> 标签：android, ruby-on-rails, ruby-on-rails-3, sencha-touch, sencha-touch-2

Sencha Touch 2 是一个用于编写面向移动设备的 Web 或本机应用程序的框架。见：[http ://www.sencha.com/products/touch/](http://www.sencha.com/products/touch/)

我可以在标准 LAMP 安装下快速制作开箱即用的应用程序，但是当我尝试在一个活跃的现有项目中使用 Sencha 和 Rails 时，事情很快就崩溃了。此外，我不能像大多数教程希望你做的那样把它放在根目录中。

我已经对代码进行了足够的配置，以允许应用程序位于 m.example.com/ 并通过 example.com/sencha/app (app.json)、example.com/sencha/js (sencha-touch) 公开其资源.js) 和 example.com/sencha/css (sencha-touch.css)。

我可以通过在 Rails 视图中包含引导 js 来在浏览器中加载我的应用程序，但我只看到蓝屏和 3 个闪烁的点。Chrome 控制台中没有错误，也没有其他任何事情发生。

Web 上的教程很少，而且我在不同的场合完成了大部分教程，但它们都是针对我所见过的 Rails 2 的。我试过了

*   [http://mikehoitomt.wordpress.com/2011/03/10/sencha-touch-application-with-ruby-on-rails-part-1/](http://mikehoitomt.wordpress.com/2011/03/10/sencha-touch-application-with-ruby-on-rails-part-1/)和
*   [http://blog.joshsoftware.com/2011/12/14/sencha-touch-mvc-with-rails/](http://blog.joshsoftware.com/2011/12/14/sencha-touch-mvc-with-rails/)

但我也看到了[Sencha Touch Rails 3.1](https://stackoverflow.com/questions/8301957/sencha-touch-rails-3-1)的问题，所以我知道*有人*在某个地方让它工作了。

我在哪里可以找到有关使 Sencha Touch 2 在现有 Rails 3 应用程序中工作的帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T02:01:30.793

在 Safari 下尝试或检查 Chrome 控制台是否有错误。我认为 Chrome 在与安全相关的基本设置中给出了错误：

[Phonegap + Sencha + Android：带有基本访问身份验证的ajax请求失败](https://stackoverflow.com/questions/8068557/phonegap-sencha-android-ajax-request-with-a-basic-access-authentication-fa)

在这个问题中，我使用了指向 Sencha Touch 2 CDN 的 index.html。这就是您设置 ST2 所需的全部内容。

[创建带有居中按钮的 2x2 按钮网格？](https://stackoverflow.com/questions/10126628/creating-a-2x2-button-grid-with-centered-buttons)

# asp.net-mvc-3 - 如何使用 https 保护登录弹出窗口

> ID：10591964
> 
> 赞同：1
> 
> 时间：2012-05-14T22:37:06.940
> 
> 标签：asp.net-mvc-3, security, login

我们正在开发一个带有多个“号召性用语”链接的网站，如果用户未登录，则会显示“注册/登录”弹出窗口。该弹出窗口通过 jquery UI 弹出窗口显示。我们希望使用 HTTPS 保护登录/注册页面。当这些是独立页面时，如何做到这一点很清楚。但是对于可能显示登录弹出窗口的“正常”页面，解决方案是什么？

显然，如果我们强制整个网站通过 HTTPS 工作，那么这将得到解决。但是还有其他方法吗？

不确定这是否重要，但我们正在使用 C# MVC3 和 jQuery 1.7

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T01:09:33.143

通常，从 http url 发布到 https url 是有问题的。旧版本的 IE 将完全阻止这一点。您可以在 jQuery 弹出窗口中加载 https iframe，但这会变得混乱。此外，如果只有 iframe 是 https，用户的地址栏中不会有漂亮的绿色锁。最干净的方法是将整个站点推送到 https 或至少包含“注册/登录”弹出窗口的页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T01:17:11.040

由于您不关心地址栏中的 SSL 通知程序，我想说我能想到的满足您要求的唯一解决方案是通过加载到 jQuery 弹出窗口中的 iframe 提供登录表单。

这将防止您必须在每个可能不使用它的页面上启用 HTTPS，并且通过使用 jQuery 动态创建 iframe，安全连接实际上只会在必要时使用。

# regex - Netbeans - 查找不包含特定文本的文件

> ID：10591965
> 
> 赞同：3
> 
> 时间：2012-05-14T22:37:15.567
> 
> 标签：regex, search, netbeans

是否可以使用不包含例如文本 'mysql.php' 的正则表达式通过 Netbeans 函数“在项目中查找”（CTRL+SHIFT+F）查找文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T07:22:56.307

是的，有可能。

您可以尝试正则表达式`"[^(mysql.php)]"`，它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-02T13:20:46.943

由于我无法在短时间内在 netbeans 中实现这一点，因此我通过控制台 (bash) 解决了这个问题：

```
netbeans --open $(grep -IRiL "mysql.php" .) 
```

# php - 如何计算与给定序列 (A) 具有给定相关性的随机值序列 (B)

> ID：10591967
> 
> 赞同：6
> 
> 时间：2012-05-14T22:37:30.090
> 
> 标签：php, math, random, correlation

对于一个教育网站，我的目的是让学生在价值系列和他们的整理中有所作为。例如，学生可以输入两个计算相关性的数组：

```
$array_x = array(5,3,6,7,4,2,9,5);
$array_y = array(4,3,4,8,3,2,10,5);

echo Correlation($array_x, $array_y); // 0.93439982209434 
```

代码完美运行，可以在这篇文章的底部找到。然而，我现在面临挑战。我想要的是以下内容：

*   学生输入一个 $array_x (5,3,6,7,4,2,9,5)
*   学生输入相关性（0.9）
*   学生输入 $array_y 的边界（例如，介于 1 和 10 之间或介于 50 和 80 之间）
*   该脚本返回一个随机数组（例如：4,3,4,8,3,2,10,5），它具有（大约）给定的相关性

因此，换句话说，代码必须像这样工作：

```
$array_x = array(5,3,6,7,4,2,9,5);
$boundaries = array(1, 10);
$correlation = 0.9;

echo ySeries($array_x, $boundaries, $correlation); // array(4,3,4,8,3,2,10,5) 
```

在 Stackexchange 数学论坛上，@ilya 回答（作为图像插入，因为公式的乳胶格式似乎不适用于 stackoverflow）：

![在此处输入图像描述](../Images/e091925c0b07f6ec1cd4e2cbdf92b8b6.png)

PS 用于计算相关性的代码：

```
function Correlation($arr1, $arr2) {        
  $correlation = 0;  
  $k = SumProductMeanDeviation($arr1, $arr2);
  $ssmd1 = SumSquareMeanDeviation($arr1);
  $ssmd2 = SumSquareMeanDeviation($arr2);
  $product = $ssmd1 * $ssmd2;
  $res = sqrt($product);
  $correlation = $k / $res;

  return $correlation;
}

function SumProductMeanDeviation($arr1, $arr2) {
  $sum = 0;
  $num = count($arr1);
  for($i=0; $i < $num; $i++) {
    $sum = $sum + ProductMeanDeviation($arr1, $arr2, $i);
  }
  return $sum;
}

function ProductMeanDeviation($arr1, $arr2, $item) {
  return (MeanDeviation($arr1, $item) * MeanDeviation($arr2, $item));
}

function SumSquareMeanDeviation($arr) {
  $sum = 0;
  $num = count($arr);
  for($i = 0; $i < $num; $i++) {
    $sum = $sum + SquareMeanDeviation($arr, $i);
  }
  return $sum;
}

function SquareMeanDeviation($arr, $item) {
  return MeanDeviation($arr, $item) * MeanDeviation($arr, $item);
}

function SumMeanDeviation($arr) {
  $sum = 0;
  $num = count($arr);
  for($i = 0; $i < $num; $i++) {
    $sum = $sum + MeanDeviation($arr, $i);
  }
  return $sum;
}

function MeanDeviation($arr, $item) {
  $average = Average($arr);
  return $arr[$item] - $average;
}    

function Average($arr) {
  $sum = Sum($arr);
  $num = count($arr);
  return $sum/$num;
}

function Sum($arr) {
  return array_sum($arr);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-20T18:59:11.500

因此，这是您的算法的 php 实现，它使用 Dawkins 的 weasel 逐渐减少错误，直到达到所需的阈值。

```
<?php
function sqrMeanDeviation($array, $avg)
{
    $sqrMeanDeviation = 0;
    for($i=0; $i<count($array); $i++)
    {
        $dev = $array[$i] - $avg;
        $sqrMeanDeviation += $dev * $dev;
    }

    return $sqrMeanDeviation;
}

// z values are non-0 an can value between [-abs_z_bound, abs_z_bound]
function random_z_element($abs_z_bound = 1)
{
    $a = (mt_rand() % (2*$abs_z_bound) ) - ($abs_z_bound-1);
    if($a <= 0)
        $a--;
    return $a;
}

// change z a little
function copy_z_weasel($old_array_z, $error_probability = 20 /*error possible is 1 in error_probability*/, $abs_z_bound = 1)
{
    $new_z = array();

    for($i = 0; $i < count($old_array_z); $i++)
        if(mt_rand() % $error_probability == 0 )
            $new_z[$i] = random_z_element($abs_z_bound);
        else
            $new_z[$i] = $old_array_z[$i];

    return $new_z;
}

function correlation_error($array_y, $array_x, $avg_x, $sqrMeanDeviation_x, $correlation)
{
    // checking correlation
    $avg_y = array_sum($array_y)/count($array_y);

    $sqrMeanDeviation_y = 0;
    $covariance_xy = 0;

    for($i=0; $i<count($array_x); $i++)
    {
        $dev_y = $array_y[$i] - $avg_y;
        $sqrMeanDeviation_y += $dev_y * $dev_y;

        $dev_x = $array_x[$i] - $avg_x;
        $covariance_xy += $dev_y * $dev_x;
    }
    $correlation_xy = $covariance_xy/sqrt($sqrMeanDeviation_x*$sqrMeanDeviation_y);
    return abs($correlation_xy - $correlation);
}

function ySeries($array_x, $low_bound, $high_bound, $correlation, $threshold)
{
    $array_y = array();

    $avg_x = array_sum($array_x)/count($array_x);
    $sqrMeanDeviation_x = sqrMeanDeviation($array_x, $avg_x);

    // pre-compute beta
    $beta_x_sQMz = $sqrMeanDeviation_x * sqrt( 1 / ($correlation*$correlation) - 1 );

    $best_array_z = array();
    $n = 0;
    $error = $threshold + 1;

    while($error > $threshold)
    {
        ++$n;

        // generate z 
        $array_z = array();
        if(count($best_array_z) == 0)
            for($i=0; $i<count($array_x); $i++)
                $array_z[$i] = random_z_element();
        else
            $array_z = copy_z_weasel($best_array_z);

        $sqm_z = sqrMeanDeviation($array_z, array_sum($array_z)/count($array_z) );
        // this being 0 implies that for every beta correlation(x,y) = 1 so just give it any random beta
        if($sqm_z)
            $beta = $beta_x_sQMz / $sqm_z;
        else
            $beta = 10;
        // and now we have y
        for($i=0; $i<count($array_x); $i++)
            $array_y[$i] = $array_x[$i] + ($array_z[$i] * $beta);

        // now, change bounds (we could do this afterwards but we want precision and y to be integers)
        // rounding
        $min_y = $array_y[0];
        $max_y = $array_y[0];
        for( $i=1; $i<count($array_x); $i++ )
        {
            if($array_y[$i] < $min_y)
                $min_y = $array_y[$i];
            if($array_y[$i] > $max_y)
                $max_y = $array_y[$i];
        }

        $range = ($high_bound - $low_bound) / ($max_y - $min_y);
        $shift = $low_bound - $min_y;
        for( $i=0; $i<count($array_x); $i++ )
            $array_y[$i] = round($array_y[$i] * $range + $shift);

        // get the error
        $new_error = correlation_error($array_y, $array_x, $avg_x, $sqrMeanDeviation_x, $correlation);

        if($new_error < $error)
        {
            $best_array_z = $array_z;
            $error = $new_error;
        }

    }
    echo "Correlation ", $correlation, " approched within " , $new_error, " in ", $n ," iterations.\n";

    return $array_y;
}

?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T22:52:17.103

一种简单的方法，虽然效率很低，但从给定区间中的随机数开始，并尝试添加更多数字，只要它们不会过多地违反相关性：

```
function ySeries(array_x, boundaries, correlation) {
  array_y = [random(boundaries)]
  while (len(array_y) < len(array_x)) {
    do {    
      y = random(boundaries)
    } while (Correlation(array_x, array_y + [y]) > correlation + epsilon)

    array_y.push(y)
  }
} 
```

可能会很好，只要数字很小

# javascript - 如何使我的替换代码工作？

> ID：10591970
> 
> 赞同：1
> 
> 时间：2012-05-14T22:37:55.870
> 
> 标签：javascript, jquery

我正在尝试制作一个每次替换匹配项的基本替换代码。

```
(function($) {
    $.fn.replace = function(obj) {
        var a = $(this).html();
        for (var i in obj) {
            $(this).html(a.replace(i, obj[i]));
        }
    };
    $('#myDiv').replace({
        ':\)': '<img src="http://bit.ly/dbtoez" />'
    });
})(jQuery);​ 
```

但它不起作用。此外，当我将更多属性放入对象中以替换 div 时，它不起作用。img 元素是笑脸。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T22:40:49.243

你基本上扔掉了所有的替代品，但最后一个。`a`在您的循环中修改并在最后更新 HTML：

```
var a = $(this).html();
for (var i in obj) {
    a = a.replace(new RegExp(i, 'g'), obj[i]);
}
$(this).html(a); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:47:47.060

小提琴：http: [//jsfiddle.net/iambriansreed/kCtLh/](http://jsfiddle.net/iambriansreed/kCtLh/)

```
(function($) {
    $.fn.replace = function(obj) {
        var a = $(this).html();
        for (var i in obj){
           a = a.replace(new RegExp(i.replace(/([.?*+^$[\]\\(){}|-])/g, "\\$1"), "g"), obj[i]);
        }
        return $(this).html(a);
    };
})(jQuery);

$('#myDiv').replace({
    ':)': '<img src="http://bit.ly/dbtoez" />'
});​ 
```

最终版本。它为您转义了所有字符。:)

# jquery - Django jquery 扩展器插件不适用于换行符

> ID：10591972
> 
> 赞同：0
> 
> 时间：2012-05-14T22:38:32.863
> 
> 标签：jquery, django, jquery-plugins

嗨，我正在使用 django 和 jquery 扩展器插件[http://plugins.learningjquery.com/expander/](http://plugins.learningjquery.com/expander/)。当我使用默认示例时，一切正常。但是当我尝试将它与数据库数据一起使用时，它不起作用。是否有可能在渲染数据之前执行脚本？有什么建议可以解决这个问题吗？

# 编辑

好的，我发现了问题。linebreakfilter 生成多个 p 标签和一堆 br 标签。

js：

```
$(document).ready(function() {
   $('div.expandable p').expander({
      slicePoint:       50,  // default is 100
      expandPrefix:     ' ', // default is '... '
      expandText:       'show more', // default is 'read more'
      userCollapseText: 'show less'  // default is 'read less'
   });
}); 
```

html工作：

```
<div class="expandable">
<p>ljddf adfsdf esaf nmnj asdf adsfsdafsdf</p>
</div> 
```

html工作：

```
<div class="expandable">
<p>{{ object.description }}</p>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:53:40.890

我已经指出了问题。linebreaksfilter 添加了一些 p 和 br 标签来格式化输出。代替：

```
<p>some text...
some text...</p> 
```

它创建了这样的东西：

```
<p>some text...<br>
some text...</p>
<p>some text...<br>
some text...</p> 
```

因此，jquery 扩展器插件无法与 djangos 换行过滤器的输出一起正常工作。

# design-patterns - 面部模式识别

> ID：10591982
> 
> 赞同：2
> 
> 时间：2012-05-14T22:39:53.683
> 
> 标签：design-patterns, measurement, face-recognition

我正在研究遗传疾病，我需要一些库或 SDK 或 API，它们可以识别人脸并进行一些人体测量学测量，如眼睛之间的距离、耳朵位置或一些模式，如眼睛方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:43:35.610

您可以先尝试 [libface](http://libface.sourceforge.net/file/Home.html)或使用[Cybula 的](http://www.cybula.com/)面部识别技术。

[这个问题感觉和这个](https://stackoverflow.com/questions/953714/face-recognition-library)问题很相似。你应该检查一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:58:17.863

您可以尝试检测面部特征坐标的[Luxand FaceSDK 。](http://www.luxand.com/facesdk/)

# java - Java中的贪婪与非贪婪模式匹配

> ID：10591986
> 
> 赞同：-1
> 
> 时间：2012-05-14T22:40:20.123
> 
> 标签：java, regex, greedy

使用 JAVA 在给定字符串中捕获以下组的正则表达式是什么：

```
hey,soul,345 
```

约束条件是第一个单词也可以包含逗号。我有以下正则表达式：

```
(.*),(.*),(.*) 
```

但我基本上只想匹配最后 3 个逗号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T22:44:54.787

我不认为你真的需要正则表达式......如果你有一个值由逗号分隔的单个字符串，并且你只想要最后 3 个逗号分隔的值（意味着有“三个”值，但首先可能有一个逗号它），您可以在逗号处分解/拆分字符串并拥有一个值数组。然后只需弹出 #2 和 #3 值的最后 2 个数组元素，并为 #1 内爆/加入剩下的任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T22:47:16.420

您可以将 a 添加`$`到正则表达式的末尾以匹配字符串的最后一部分，然后在每个捕获组中，而不是匹配 a `.`（任何字符），您可以匹配任何非逗号字符：`[^,]`. 如果您想通过正则表达式进行操作，那应该会为您提供最后三个逗号分隔的组。所以你的正则表达式是：

```
(.*),([^,]*),([^,]*)$ 
```

# r - 如何在没有 .R 扩展名的情况下将 vim 缓冲区源设为 R

> ID：10591987
> 
> 赞同：0
> 
> 时间：2012-05-14T22:40:21.447
> 
> 标签：r, vim, macvim

> **可能重复：**
> [我可以让 vim 在没有扩展名的 C++ 头文件上进行语法突出显示吗？](https://stackoverflow.com/questions/10584580/can-i-make-vim-do-syntax-highlighting-on-c-headers-that-dont-have-extensions)

我正在使用[R.vim](http://www.vim.org/scripts/script.php?script_id=2104)脚本将我的 .R 文件从 vim 获取到使用 Applescript 的 R-GUI。但是，这仅在我在 vim 中打开的文件具有 .R 扩展名时才有效。

当我打开 MacVim 时，缓冲区没有扩展名，所以我必须先将文件保存为 temp.R，然后才能使用 R-vim 提供的快捷方式来获取 R-GUI。我主要是 R 用户，所以我想这样做，默认情况下，当 MacVim 打开时，它假定文件类型是 R，我可以立即开始获取缓冲区。

有没有办法自动告诉缓冲区文件类型是 R，这样我就不需要在采购到 R 之前写缓冲区？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T12:18:54.423

`:set filetype=R`您可以使用或短设置缓冲区的文件类型`:set ft=R`

# html - 在忘记密码页面中添加附加表单

> ID：10591989
> 
> 赞同：0
> 
> 时间：2012-05-14T22:40:30.537
> 
> 标签：html, forms, cgi, tcl

我有这个忘记密码的表格，它检查用户名，如果它有效，就会向他的电子邮件发送一个临时密码。

它工作正常，但我需要的是在我提交用户名后，我需要页面显示另一个表单，其中显示带有安全问题的表单，如果它有效，则创建临时密码并通过电子邮件发送。到目前为止，这是我的代码，我不知道在哪里添加新表单以及在哪里准确验证它。

```
HTML::cgi_read

    ###############################################################
    #   READ / VERIFY CGI VARIABLES
    ###############################################################
    SET_GLOBAL_VARS

    if { [catch {set REMOTE_ADDR        $CGI_DATA(REMOTE_ADDR)      } e] }  { set REMOTE_ADDR   "" }
    if { [catch {set HTTP_USER_AGENT    $CGI_DATA(HTTP_USER_AGENT)  } e] }  { set HTTP_USER_AGENT   "" }
    if { [catch {set COOKIE         $CGI_DATA(HTTP_COOKIE)      } e] }  { set COOKIE        "" }
    if { [catch {set MSG            $CGI_DATA(msg)          } e] }  { set MSG       "" }
    if { [catch {set USERNAME       $CGI_DATA(username)     } e] }  { set USERNAME      "" }
    if { [catch {set SECQUESTION        $CGI_DATA(secquestion)      } e] }  { set SECQUESTION   "" }
    if { [catch {set SECANSWER      $CGI_DATA(secanswer)        } e] }  { set SECANSWER     "" }

    ###############################################################
    #   ONLY ALLOW HTML START TO HAPPEN ONCE!
    #       Remember:   Redirects don't have HTML Start
    #               Meta Tags have to have it beforehand
    #               Cannot do both a redirect and a meta tag
    ###############################################################
    set HTMLSTARTFLAG 0
    proc HTML_START { } {
        global HTMLSTARTFLAG

        if {$HTMLSTARTFLAG < 1} {
            HTML::Start
            set HTMLSTARTFLAG 1
        }
    }

    ###############################################################
    #   START OF SCRIPT
    ###############################################################

    if {$USERNAME != ""} {
        ################################
        #   Do the hit for the entered user
        ################################
        set queryresult1 [InfxGetLogin $USERNAME]

        #any errors go back and show the blank login page
        if { [regexp -nocase "error" [lindex [split $queryresult1 ,] 0] ] } {
            set junk [InfxInsertLoginHistory $USERNAME "ForgotPassword" "$REMOTE_ADDR|$HTTP_USER_AGENT" "Error"]
            Redirect_Login "DB Error, Please try again."
            exit
        }

        set login   [lindex [lindex $queryresult1 0] 0]
        set locked  [lindex [lindex $queryresult1 0] 4]
        set dbquestion  [lindex [lindex $queryresult1 0] 5]
        set dbanswer    [lindex [lindex $queryresult1 0] 6]
        set emailTo [lindex [lindex $queryresult1 0] 7]
        set userId  [lindex [lindex $queryresult1 0] 8]

        ################################
        #   Validate user info
        ################################
        if {$login == ""} {
            set junk [InfxInsertLoginHistory $USERNAME "ForgotPassword" "$REMOTE_ADDR|$HTTP_USER_AGENT" "DoesNotExist"]
            Redirect_LoginForgotPass "Login Does Not Exist"
            exit
        }

        #locked people shouldn't get here, but if they do, they entered the page directly, send them away
        if {$locked == "t"} {
            set junk [InfxInsertLoginHistory $login "ForgotPassword" "$REMOTE_ADDR|$HTTP_USER_AGENT" "AcctLocked"]
            Redirect_LoginForgotPass "Account is Locked"
            exit
        }

        ################################
        #   Create temporary password
        #       Base64 encoding an rc4 encrypted text, then removing all special characters
        #       and taking the 1st 6 characters.
        ################################
        set pass [::base64::encode [rc4::rc4 -key [clock scan "now"] "randomizeme"]]
        regsub -all {[^a-zA-Z0-9]} $pass "" pass
        set pass [string range $pass 0 5]

        ################################
        #   Update DB w/ temporary password
        ################################
        set result [InfxResetUserPassword $userId $pass]

        if { $result != "ok" } {
            set junk [InfxInsertLoginHistory $login "ForgotPassword" "$REMOTE_ADDR|$HTTP_USER_AGENT" "Error"]
            Redirect_LoginForgotPass "DB Error, Please try again."
            exit
        }

        set result "ERROR"
        set result [HTML::mail "test@test.com $emailTo" "$emailFrom" "$emailSubj" "$emailMsg"]

        ################################
        #   Go back to login screen on success
        ################################
        if { $result == "0" } {
            Redirect_Login "Password Changed and Email Sent"
            exit
        } else {
            set junk [InfxInsertLoginHistory $login "ForgotPassword" "$REMOTE_ADDR|$HTTP_USER_AGENT" "EmailError"]
            Redirect_LoginForgotPass "Error Sending Email"
            exit
        }
    } else {
        ################################
        #   Initial display of username form
        ################################
        HTML_START

        puts {
        <head>
            <link rel="stylesheet" type="text/css" href="css/login.css" type="text/css">
            <script type="text/javascript" src="js/login.js"></script>

            <title> Services</title>

        </head>
        <body>
            <br><br>
            <img src="images/.gif" />
            <br><br><br>
            <div id="login">
                <form onsubmit="return validate_login_username(this)" action="login_forgotpw.cgi" method="post">
                    <table cellpadding="0" cellspacing="0">
                        <tr>
                            <th colspan="2"> Password Reset</th>
                        </tr>
                        <tr>
                            <td><label>Username:</label></td>
                            <td><input name="username"></input></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td><input type="submit" value="Submit"></input></td>
                        </tr>
                    </table>
                </form>
            </div>
        }

    puts "  <h3 class=\"errormessage\">$MSG</h3>"

        exit
    } 
```

这是表单，我想添加和验证，最好在同一页面中。

```
puts "<form action='login_forgotpw.cgi' method='post'>"
    puts "<td><label><b>Security Question : </b></td><td>$dbquestion ?</label></td></tr>"
    puts "<tr>"
    puts "<td><label><b>Answer:</b></td><td><input type='text' name='secanswer'></input></td>"
    puts "<td><input type='submit' value='Submit'></input></td>" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T10:16:42.397

一般来说，如果您正在执行多阶段表单，那么您可以通过以下两种机制之一将前面步骤中的数据向前传递：

1.  将来自前面步骤的数据放入一个短暂的（例如，可能是 1 小时？）数据库记录中，并将记录密钥（一个 UUID？）存储在会话 cookie 中。
2.  将来自先前步骤的数据放在`<input type="hidden">`您发送给用户以处理后续步骤的表单中的隐藏字段 ( ) 中。

这两种方法都非常适合您，前提是您在部署时有一个安全的通信通道（在您的环境中设置 HTTPS 完全超出了本讨论的范围）。我无法告诉您如何根据您的逻辑决定使用哪种形式；这取决于你知道而我不知道的约束。我可以说在上述两种*实现技术*之间，#1 的优点是它使整体消息更小，#2 的优点是它意味着更少的状态管理（因为所有状态都保留在客户端，直到你'准备好处理完全指定的密码更改）并且有人猜测会话密钥没有问题；我自己有点安全意识，我更喜欢使用隐藏字段。

* * *

生成表单时，分几个步骤进行：

```
puts {
<form ...>...blah static stuff
}
# Now a dynamic bit
puts "<input type='hidden' name='whatever' value='$whatever'>"
# Back to a static part
puts {
</form>
} 
```

或者考虑使用[Tcllib](http://tcllib.sourceforge.net/doc/html.html)中的 html 包来做模板。[Tcler's Wiki](http://wiki.tcl.tk/16714)对此进行了更多讨论。

# objective-c - 在使用 classFromString 实例化的类中调用方法？

> ID：10591995
> 
> 赞同：0
> 
> 时间：2012-05-14T22:41:32.767
> 
> 标签：objective-c, ios, xcode

在另一个问题（[如何在 Objective-C 中从字符串实例化类对象？](https://stackoverflow.com/questions/2226611/how-to-instantiate-an-object-of-class-from-string-in-objective-c)）中，有人建议这样做：

```
id myclass = [[NSClassFromString(@"MyClass") alloc] init];
[myclass FunctioninClass]; 
```

但是，`[myClass FunctioninClass]`会产生错误，因为编译器不知道是否`FunctioninClass`存在。

我确实知道可能存在的班级都是一位父母的所有后代。并且该父级具有我要调用的方法的原型，除了我要调用覆盖的后代方法。这是否建议解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T23:03:42.590

您可以改用 performSelector。这是苹果[文档](https://developer.apple.com/library/mac/ipad/#documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html)

```
[myClass performSelector:@selector(FunctioninClass)]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T22:44:36.093

在@user523234 发表评论后，我决定改进我的答案并更正它。然而，在我看来，他的回答不够好​​，如果选择器不可用，它会使您的代码崩溃。

所以这里是解决方案：

```
id myclass = [[NSClassFromString(@"MyClass") alloc] init];

if ([myclass respondsToSelector:@selector(FunctioninClass)])
{
    [myClass performSelector:@selector(FunctioninClass)];
} 
```

使用[-responsToSelector:](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html#//apple_ref/occ/intfm/NSObject/respondsToSelector%3a)将确保您检查该部门是否存在于类中。但是，您每次都需要使用 preformSelector。我不确定您是否可以动态类型转换标识符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T02:01:03.853

由于您知道所有可能的类都派生自一个父类，并且该类包含您需要的方法，因此只需：

```
ParentClass *myclass = [[NSClassFromString(@"MyClass") alloc] init];
[myclass FunctioninClass]; 
```

您`NSClassFromString`用来选择要实例化哪个子类的事实甚至并不真正相关。这只是一个简单的继承情况：`myclass`“is-a” `ParentClass`，所以你可以调用`ParentClass`它的任何方法。

# drupal - 如何在具有多个提交表单元素的表单上设置默认提交按钮？

> ID：10591996
> 
> 赞同：1
> 
> 时间：2012-05-14T22:41:51.107
> 
> 标签：drupal, drupal-7, drupal-modules, drupal-fapi, drupal-forms

去年提出了一个与此完全相同的问题，但这个问题是针对 Drupal 6 的，我想知道 Drupal 7 是否有变化。

[我可以将 Drupal 表单中的第二个或以后的按钮设为默认按钮吗？](https://stackoverflow.com/questions/8154912/can-i-make-the-second-or-later-button-in-a-drupal-form-the-default-button)

在我的表单中，我有大约四个提交按钮表单元素。四个中的三个具有指定的提交函数，另一个使用默认的 hook_form_submit() 函数来处理它的提交。

所以这就是三个按钮的样子：

```
$form['reset'] = array(
   '#type' => 'submit',
   '#value' => t('Reset Values'),
   '#submit' => array('_phonebook_reset_config'),
); 
```

这是主按钮的样子：

```
$form['submit'] = array(
   '#type' => 'submit',
   '#value' => t('Update'),
); 
```

这是在表单中创建按钮的顺序：`(Button_1, Button_2, Main_Button, Button_4)`。

现在，如果我在表单上按 Enter，`Button_1`就会被执行。我希望主按钮成为默认按钮，这样当用户按下回车键时，该主按钮不会被提交`Button_1`。

在上面提到的帖子中，答案之一是使用重量。我尝试使用重量，但所做的只是改变按钮在屏幕上的排列方式。是的，这确实允许`Main_Button`, 被提交，但是我需要该按钮在其原始位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T04:05:10.033

仅使用 HTML 无法做到这一点。（所以表单 API 无能为力）因为没有标准也没有 html 属性来处理多个提交表单中的默认提交。您应该使用 CSS，但如果您不想重新设置样式，可以使用 jQuery。祝你好运！

```
 //Not tested
  $("#target").keypress(function(event) {
    if ( event.which == 13 ) {
       event.preventDefault();
       $('correctSubmit').submit();
     }
  }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-10T04:56:05.353

在[如何确定 HTML 表单上的默认提交按钮中确定的解决方案？](https://stackoverflow.com/questions/925334/how-is-the-default-submit-button-on-an-html-form-determined/9491141#9491141)显示了解决此问题的纯 HTML / CSS 方式。我在[http://pahsah.com/2015/08/10/html-forms-specifying-a-default-submit-button-pure-htmlcss-approach/](http://pahsah.com/2015/08/10/html-forms-specifying-a-default-submit-button-pure-htmlcss-approach/)上扩展了该主题。

# mobile - 视图中的 Xpages 单选按钮

> ID：10591998
> 
> 赞同：0
> 
> 时间：2012-05-14T22:41:57.127
> 
> 标签：mobile, user-interface, xpages

我在 xpages 中使用标准视图控件，它有一个复选框，用于选择随后可以处理的多个文档。我想为视图中的每个文档添加一个单选按钮（是/否）选择。实现这一目标的最佳和最简单的选择是什么？

已编辑：我正在寻找的是内联编辑，我猜想在 xpages 视图中使用单选按钮编辑视图中每个文档的值。

顺便说一句，它不必是标准视图控件，我可以将其更改为数据表或重复控件，如果这有助于我实现这一目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T14:22:04.913

Could you simply use the Checkbox property in the view column? ![checkbox property on a view column](../Images/90454783b38f07aaf82ca2d5831e59bf.png)

Then you could also make use of the SSJS with something like this:

```
var viewPanel=getComponent("viewPanel1");get the componet of viewPanel
var docIDArray=viewPanel.getSelectedIds(); get the array of document ids
for(i=0;i < docIDArray.length; i++){
    var docId=docIDArray[i];
    var doc=database.getDocumentByID(docId); 
    //.. your code to deal with the selected document
} 
```

# xcode - 如何解决 xcode ui 中的 git pull 冲突

> ID：10591999
> 
> 赞同：11
> 
> 时间：2012-05-14T22:42:21.847
> 
> 标签：xcode, git, pull, git-pull

我将 Xcode 存储库 GUI 与最新版本的 Xcode 一起使用，而不是命令行。我对代表进行了初步拉动，没有任何问题。我对本地文件进行了一些更改。同时，我的另一个开发者做了一些改变。我将更改提交给本地代表，但需要他的更改才能进行正确的构建。我们只有 1 个分店。

我尝试拉取并且 Xcode UI 报告了 6 个冲突（这是我所期望的，因为我需要 6 个文件来进行正确的构建）。

我的问题是如何解决冲突？我在线阅读我应该可以使用屏幕底部的左右按钮让我选择哪个文件版本。我浏览了所有 6 个文件并使用适当的按钮来选择我想要的更改。

但是，右下角的“拉动”按钮被禁用并变灰。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-06T06:41:04.693

**提交屏幕的文件列表上方是三个图标，一个目录视图，一个文档视图，最后一个看起来像一些水平线。当我遇到类似问题时，我发现单击这些文件会显示我尚未解决的其他文件。**

我解决了那些我可以解决的问题，尽管注意到其中一些文件包括一些 .DS-Store 是隐藏的 Apple（桌面服务商店）文件，这些文件已在其他地方指出会导致 git 问题。

[我使用如何从 Git 存储库中删除 .DS_Store 文件中](https://stackoverflow.com/questions/107701/how-can-i-remove-ds-store-files-from-a-git-repository)的说明将 .DS_Store 放入 .gitignore ？

那为我修好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-04T16:51:56.160

就我而言，我只是有更多我没有看到的冲突。奇怪的是，自从使用 Xcode 6 以来，这是我第一次真正不得不处理冲突——而且我制造了它们！（在不同的机器上）

无论如何，只需向下滚动一点，就会发现文件中存在更多冲突，一旦我选择“右”或“左”（或“先右后左”/“左后右”），“拉动”按钮启用，我能够完成我的拉动...

哇！希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-12T13:51:09.873

我在 Xcode 9.4.1 中发生了这种情况，在解决了所有冲突之后，我需要做的事情如下：

*   切换到树视图上方左窗格中的源代码控制视图（其中带有十字符号的框）
*   将顶级项目条目旁边的复选框从关闭切换为打开。这将启用“拉动”按钮，但只是一秒钟，不足以单击它。
*   将复选框切换回关闭，然后再次打开。现在 Pull 按钮保持启用状态。
*   单击*拉动*。

这感觉很像一个错误。我还没有验证问题是否仍然存在，并且解决方案在 Xcode 10 中仍然有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-02T18:33:54.390

只需从命令行执行“git pull”，然后重建以找到冲突标记并手动修复它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-23T18:48:07.787

对我来说，这是一个已在分支中删除但仍存在于 Master 中的文件。一旦我取消选中该文件，我就可以拉取。