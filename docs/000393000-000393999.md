# StackOverflow 问答 000393000-000393999

# .net - .Net 矩阵

> ID：393005
> 
> 赞同：3
> 
> 时间：2008-12-25T17:55:23.767
> 
> 标签：.net, matrix

有标准的.Net 矩阵类吗？如果有的话我找不到。

如果不是，为什么不呢？这听起来像是人们经常需要的东西。您可以推荐任何非标准库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-25T18:01:44.830

XNA 框架具有矩阵结构。我不知道主框架的任何部分都有一个 Matrix 类。

[http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.matrix.aspx](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.matrix.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-25T18:08:58.390

我不相信有，部分原因是任何数组在技术上都可以称为“矩阵”，如果它是长度为 n 的一维数组，它是一个 nx 1 矩阵。还有一个问题是您是否希望矩阵保存整数、双精度数或其他可能在某些 Matrix 函数中起作用的数值。

确实存在像[这里](http://www.extremeoptimization.com/)和[这里](http://www.centerspace.net/products.php)这样的各种地方，它们可能将一些矩阵类与其他线性代数函数捆绑在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-25T18:52:50.187

[您可以在Lydos.MatLab 库](http://www.dgp.toronto.edu/~alexk/lydos.matlab.html)（[文档](http://www.dgp.toronto.edu/~alexk/lydos.matlab.doc/index.html)）中找到一个 Matrix 类，该库在[zlib/libpng 许可](http://www.opensource.org/licenses/zlib-license.php)下作为开源项目分发。

C# 中的示例用法：

```
using Lydos.Matlab;
using System;

public class Example
{
    static void Main()
    {
        Engine e = new Engine();
        Matrix m = new Matrix(2, 2), n;

        m[0, 0] = 0;
        m[0, 1] = 1;
        m[1, 0] = 2;
        m[1, 1] = 3;

        e.SetMatrix("m", m);
        e.Evaluate("m = m + 1");
        n = e.GetMatrix("m");

        Console.WriteLine(m); // [0 1; 2 3]
        Console.WriteLine(n); // [1 2; 3 4]

        m.Dispose();
        n.Dispose();
        e.Close();
    }
} 
```

# java - Java中数组中的最大元素（整数数组int []的Collections.max（））

> ID：393017
> 
> 赞同：5
> 
> 时间：2008-12-25T18:05:08.833
> 
> 标签：java, stl, collections

有没有类似的东西`Collections.max`可以在标准 java 运行时库中的常规数组的数组中找到最大值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T19:36:56.853

如果你有一个对象数组，你可以使用

```
Collections.max(Arrays.asList(array)); 
```

如果你有一个原始数组，你可以使用一个简单的循环。

```
long[] array;
long max = array[0];
for(long l : array) if (max < l) max = l; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-25T19:14:23.390

您可以使用[Arrays.sort(int[])](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Arrays.html#sort(int[]))然后访问它的第一个（或最后一个）元素。或者您可以简单地遍历数组并寻找最大/最大的元素。这基本上是不费吹灰之力的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-25T19:28:56.450

不，至少在 Java 6 中没有 Arrays.max 或类似的。

如果您查看 Collections.max 的签名和实现，它会大量使用参数化类型。在 Java 中，泛型数组至少可以说是有问题的，因此在 Java 中为数组提供泛型 max 实现并继续关注（泛型）集合可能不是一个好主意。

编辑：正如 newacct 正确指出的那样，*使用*泛型数组不一定比使用泛型集合更成问题，所以我编辑了上面的文本，因为原文是错误的。尽管如此，“泛型数组有问题”的主要论点在我看来仍然有效，并且集合应该优先于引用类型数组。

```
public static <T> T max(Collection<? extends T> coll, Comparator<? super T> comp) {
    if (comp==null)
        return (T)max((Collection<SelfComparable>) (Collection) coll);

Iterator<? extends T> i = coll.iterator();
T candidate = i.next();

    while (i.hasNext()) {
    T next = i.next();
    if (comp.compare(next, candidate) > 0)
    candidate = next;
}
return candidate;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-25T19:31:07.753

您还可以为 Collection 创建一个[装饰器](http://en.wikipedia.org/wiki/Decorator_pattern)，其中包含诸如 getMaximumValue() 之类的额外方法，并在需要时更新每次添加/删除元素时返回的值。

这只有在您在程序中大量使用最大值时才有意义，这意味着每次迭代列表都会导致大量开销。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-12-25T18:24:47.420

据我所知，没有。您可以查看 asList ( [http://java.sun.com/j2se/1.5.0/docs/api/java/util/Arrays.html#asList(T...)](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Arrays.html#asList(T...)) )，但这可能不值得。

# factor-lang - 你打算使用 Factor 编程语言吗？

> ID：393026
> 
> 赞同：10
> 
> 时间：2008-12-25T18:16:58.577
> 
> 标签：factor-lang

你打算使用[Factor](http://factorcode.org/)吗？你看过吗？检查了它。你了解面向堆栈的编程吗？

[http://www.youtube.com/watch?v=f_0QlhYlS8g](http://www.youtube.com/watch?v=f_0QlhYlS8g)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-25T18:40:29.340

除了基于语言的堆栈的乐趣之外，我还没有看到，但 Forth 与它相似，并简要地研究了 Factor 研究 I。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-25T18:37:25.243

Factor 看起来很有趣，但它急需更多的介绍性教程和文章。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-13T05:07:42.970

我打算在完成我的 Clojure 学习冒险后学习它。

更新：

经过许多个月后，我最近一直在使用 Factor 做一些事情，我会说这是一种了不起的语言。唯一的问题是与 GUI 工具的方式相关的仍然存在的问题。Factor UI 工具包严重缺乏很多常见的东西，并且在撰写本文时没有任何工具包的绑定。对于任何现实世界的桌面应用程序来说，这可能会破坏交易。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-03-21T11:45:35.000

我已经使用 Factor 几个月了，它确实是一门令人印象深刻的语言。

感觉就像是 Forth（显然）、Smalltalk（基于图像、高度反射、“集成”IDE）和 LISP（代码即数据、语法级抽象、REPL）的混合……在某种程度上，语言例如 Python 或 Ruby，强调实用主义和开放性（例如“包括电池”）。

此外，性能对设计人员来说似乎很重要，因为优化编译器已经花费了很多工作，就像 Common Lisp 的 SBCL 实现一样。

该项目仍然受到他年轻的影响，语言变化频繁，部分系统文档不足，社区相对较小。但即使在这个阶段，我认为它已经足够成熟，可以开始一些不平凡的事情。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-25T18:24:04.753

我不能具体谈论因素，但我在 HP Calculators 上做了很多工作。它附带的基于堆栈的 RPN 语言非常复杂。已经为这些计算器编写了大量软件。

[http://www.hpcalc.org/](http://www.hpcalc.org/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-11T14:04:10.023

我正在考虑将 Factor 用于我的下一个大型非工作项目。我试图在 Factor、OCaml、D 和 Python 之间进行选择。通常，Python 是我选择的语言，但为此我正在寻找不同的东西。我正在考虑使用 D（我使用 C++ 很多年，并希望将 D 用作更清洁的 C++），但它似乎并不是我真正想要的。

剩下的就是 OCaml 和 Factor，我很难做出决定。OCaml 对我来说会更容易掌握，因为我的串联编程有点生疏，我也非常喜欢这种语言，但 Factor 也一直在吸引我（而且我是串联语言的忠实粉丝） . Hrm犹豫不决..

更新：从那以后，我决定正确学习 Factor 并将其用于我即将进行的大型个人项目。与此同时，我正在解决[Programming Challenges](https://rads.stackoverflow.com/amzn/click/com/0387001638) in Factor 中的一些问题。

更新2：因素并没有完全削减它。不是因为语言，语言很棒，我建议大家看看它。原因是 Qt 绑定。这对我来说是一个重要的交易破坏者。我会自己绑定 Qt 并贡献它，但是我有两个项目而不是一个，我根本没有时间。所以，对不起因素。我改为用 C++ 编写代码，但我现在正在考虑将其移植到 Clojure 或在 Clojure 中编写未来的代码。

# c - Yacc 问题：使数据在下一个非终端中可用

> ID：393041
> 
> 赞同：0
> 
> 时间：2008-12-25T18:39:25.333
> 
> 标签：c, parsing, yacc, generator

我想让我在 b 中生成的一些变量在 c 中可用：

```
a   :   b c { ...some code...} 
```

一个简单的例子：

```
b :  X  { int result = 0; } 
  |  Y  { int result = 1; } 
```

所以我可以，稍后在 c 中说：

```
c : D   { printf(result + 1); }
  | E   { printf(result + 2);  } 
```

有没有机会这样做？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-25T18:45:39.827

`result`应该是一个全局变量。您可以通过包括

```
%{
    int result;
%} 
```

在 YACC 文件的顶部。当然，你也应该分别用和替换`int result = 0`和。`int result = 1``result = 0``result = 1`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-25T19:49:20.730

您可以按照 Can 的建议进行操作，但通常在语法规则中使用全局变量并不是一个好主意。声明一个类型`b`，`c`因此您的规则如下所示：

```
%union {
    int result;
};

%type <result> a b

%start a

%%

b : X {$$ = 0;} | Y {$$ = 1;} ;
c : D {$$ = 1;} | E {$$ = 2;} ;
a : b c {printf("%d", $1 + $2);}; 
```

# python - 发电机输出长度

> ID：393053
> 
> 赞同：150
> 
> 时间：2008-12-25T18:50:18.977
> 
> 标签：python, generator, iterable

Python 提供了一种很好的方法来获取急切迭代的长度，`len(x)`即。但是对于由生成器理解和函数表示的惰性迭代，我找不到任何类似的东西。当然，写这样的东西并不难：

```
def iterlen(x):
  n = 0
  try:
    while True:
      next(x)
      n += 1
  except StopIteration: pass
  return n 
```

但我无法摆脱我正在重新实现自行车的感觉。

（当我输入函数时，我突然想到：也许真的没有这样的函数，因为它“破坏”了它的论点。不过，这对我来说不是问题）。

PS：关于第一个答案 - 是的，类似的东西`len(list(x))`也可以，但这会大大增加内存的使用。

PPS：重新检查...忽略PS，似乎我在尝试时犯了一个错误，它工作正常。抱歉，添麻烦了。

* * *

## 回答 #1

> 赞同：281
> 
> 时间：2011-08-28T20:04:50.497

最简单的方法可能就是`sum(1 for _ in gen)`gen 是你的生成器。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2018-06-01T14:41:45.083

对于那些想知道该讨论摘要的人。使用以下方法计算 5000 万长度的生成器表达式的最终最高得分：

*   `len(list(gen))`,
*   `len([_ for _ in gen])`,
*   `sum(1 for _ in gen),`
*   `ilen(gen)`（来自[more_itertools](https://pypi.org/project/more-itertools/)），
*   `reduce(lambda c, i: c + 1, gen, 0)`,

按执行性能（包括内存消耗）排序，会让你大吃一惊：

```
#1: test_list.py:8: 0.492 KiB
    gen = (i for i in data*1000); t0 = monotonic(); len(list(gen))
('list, sec', 1.9684218849870376)

#2: test_list_compr.py:8: 0.867 KiB
    gen = (i for i in data*1000); t0 = monotonic(); len([i for i in gen])
('list_compr, sec', 2.5885991149989422)

#3: test_sum.py:8: 0.859 KiB
    gen = (i for i in data*1000); t0 = monotonic(); sum(1 for i in gen); t1 = monotonic()
('sum, sec', 3.441088170016883)

#4: more_itertools/more.py:413: 1.266 KiB
    d = deque(enumerate(iterable, 1), maxlen=1)

    test_ilen.py:10: 0.875 KiB
    gen = (i for i in data*1000); t0 = monotonic(); ilen(gen)
('ilen, sec', 9.812256851990242)

#5: test_reduce.py:8: 0.859 KiB
    gen = (i for i in data*1000); t0 = monotonic(); reduce(lambda counter, i: counter + 1, gen, 0)
('reduce, sec', 13.436614598002052) 
```

所以，`len(list(gen))`是最频繁和更少的内存消耗

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2008-12-25T18:53:39.983

没有，因为在一般情况下您无法做到 - 如果您有一个惰性无限生成器怎么办？例如：

```
def fib():
    a, b = 0, 1
    while True:
        a, b = b, a + b
        yield a 
```

这永远不会终止，但会生成斐波那契数。您可以通过调用获得任意数量的斐波那契数字`next()`。

如果您确实需要知道项目的数量，那么无论如何您都无法线性迭代它们一次，因此只需使用不同的数据结构，例如常规列表。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-07-13T04:22:31.997

```
def count(iter):
    return sum(1 for _ in iter) 
```

或者更好：

```
def count(iter):
    try:
        return len(iter)
    except TypeError:
        return sum(1 for _ in iter) 
```

如果它不可迭代，它将抛出一个`TypeError`.

或者，如果您想计算生成器中的特定内容：

```
def count(iter, key=None):
    if key:
        if callable(key):
            return sum(bool(key(x)) for x in iter)
        return sum(x == key for x in iter)
    try:
        return len(iter)
    except TypeError:
        return sum(1 for _ in iter) 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-25T19:55:48.017

您可以使用 enumerate() 循环遍历生成的数据流，然后返回最后一个数字——项目数。

我尝试将 itertools.count() 与 itertools.izip() 一起使用，但没有运气。这是我想出的最好/最短的答案：

```
#!/usr/bin/python

import itertools

def func():
    for i in 'yummy beer':
        yield i

def icount(ifunc):
    size = -1 # for the case of an empty iterator
    for size, _ in enumerate(ifunc()):
        pass
    return size + 1

print list(func())
print 'icount', icount(func)

# ['y', 'u', 'm', 'm', 'y', ' ', 'b', 'e', 'e', 'r']
# icount 10 
```

Kamil Kisiel 的解决方案要好得多：

```
def count_iterable(i):
    return sum(1 for e in i) 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-03-28T19:51:29.567

根据定义，只有一部分生成器会在一定数量的参数（具有预定义的长度）之后返回，即使这样，这些有限生成器中也只有一部分具有可预测的结束（访问生成器可能会产生副作用可以更早地停止发电机）。

如果你想为你的生成器实现长度方法，你必须首先定义你认为的“长度”（它是元素的总数吗？剩余元素的数量？），然后将你的生成器包装在一个类中。这是一个例子：

```
class MyFib(object):
    """
    A class iterator that iterates through values of the
    Fibonacci sequence, until, optionally, a maximum length is reached.
    """

    def __init__(self, length):
        self._length = length
        self._i = 0

     def __iter__(self):
        a, b = 0, 1
        while not self._length or self._i < self._length:
            a, b = b, a + b
            self._i += 1
            yield a

    def __len__(self):
        "This method returns the total number of elements"
        if self._length:
            return self._length
        else:
            raise NotImplementedError("Infinite sequence has no length")
            # or simply return None / 0 depending
            # on implementation 
```

以下是如何使用它：

```
In [151]: mf = MyFib(20)

In [152]: len(mf)
Out[152]: 20

In [153]: l = [n for n in mf]

In [154]: len(l)
Out[154]: 20

In [155]: l
Out[155]: 
[1,
 1,
 2,
...
6765]

In [156]: mf0 = MyFib(0)

In [157]: len(mf0)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-157-2e89b32ad3e4> in <module>()
----> 1 len(mf0)

/tmp/ipython_edit_TWcV1I.py in __len__(self)
     22             return self._length
     23         else:
---> 24             raise NotImplementedError
     25             # or simply return None / 0 depending
     26             # on implementation

NotImplementedError: 

In [158]: g = iter(mf0)

In [159]: l0 = [g.next(), g.next(), g.next()]

In [160]: l0
Out[160]: [1, 1, 2] 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-09-05T07:32:31.763

使用[reduce(function, iterable[, initializer])](http://docs.python.org/2/library/functions.html#reduce)获得内存高效的纯函数解决方案：

```
>>> iter = "This string has 30 characters."
>>> reduce(lambda acc, e: acc + 1, iter, 0)
30 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-12-12T17:57:35.310

尝试该[`more_itertools`](http://more-itertools.readthedocs.io/en/latest/api.html)软件包以获得简单的解决方案。例子：

```
>>> import more_itertools

>>> it = iter("abcde")                                         # sample generator
>>> it
<str_iterator at 0x4ab3630>

>>> more_itertools.ilen(it)
5 
```

有关另一个应用示例，请参见[这篇文章](https://stackoverflow.com/a/41106564/4531270)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-03-14T18:24:23.270

这是一个 hack，但如果你真的想`len`处理一个通用的可迭代对象（顺便使用它），你可以创建自己的`len`.

该`len`函数本质上等同于以下函数（尽管实现通常会提供一些优化以避免额外的查找）：

```
def len(iterable):
    return iterable.__len__() 
```

因此，我们可以定义我们的`new_len`来尝试，如果`__len__`不存在，则通过使用可迭代来自己计算元素的数量：

```
def new_len(iterable):
    try:
      return iterable.__len__()
    except AttributeError:
      return sum(1 for _ in iterable) 
```

以上适用于 Python 2/3，并且（据我所知）应该涵盖所有可能的迭代类型。

# .net - 如何在 .NET 中创建自己的原始数据类型？

> ID：393061
> 
> 赞同：5
> 
> 时间：2008-12-25T18:55:12.007
> 
> 标签：.net, vb.net

如何创建自己的原语？例如，范围为 1-10 的整数。

编辑：这来自于 Rosetta Code 的一项任务。

> 定义原始数据类型：演示如何定义行为类似于整数但最低有效值为 1 和最高有效值为 10 的类型。

我在这里添加它是因为我认为它可能对其他人有用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-25T19:26:19.200

好吧，让我们来看看。首先，CLR 中内置了一些数据类型。这些不能修改或添加新的，因为它们是标准的一部分。[您可以在此处](http://msdn.microsoft.com/en-us/library/exx3b86w.aspx)或[此处](http://msdn.microsoft.com/en-us/library/ya5y69ds.aspx)找到列表。那是 C#，但对于 VB.net，该列表也应该存在于某处，并且它应该看起来相同，因为底层 CLR 是相同的。此外，该列表不完整，因为缺少浮点数和字符，但您明白了。

但是，有一些结构封装了这些数据类型并添加了一些额外的功能。例如， System.Int32 只是一个普通的标准结构，不涉及任何魔法。随意在 Reflector 中查看它，它在 mscorlib 中：

```
[Serializable, StructLayout(LayoutKind.Sequential), ComVisible(true)]
public struct Int32 : IComparable, IFormattable, IConvertible, IComparable<int>, IEquatable<int> 
```

所以你想要你自己的“1 到 10”整数？然后我建议查看最接近的合适类型，即`Int16`or 或`Byte`。如果您查看它们，您会发现它们看起来都有些相似，但它们是基于一种内置数据类型。

仅仅复制/粘贴和修改一些内置结构（ie `System.Byte`）并不完全有效，因为有些成员是内部的（ie `NumberFormatInfo.ValidateParseStyleInteger`），但[Reflector](http://www.red-gate.com/products/reflector/)可以在这里提供帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-25T18:56:20.743

```
Structure LimitedInt
  Implements IComparable(Of LimitedInt)
  Implements IEquatable(Of LimitedInt)

  Private m_Value As Integer 'treat the default, 0 as being really 1'

  Public ReadOnly Property Value() As Integer
   Get
     Return If(m_Value = 0, 1, m_Value)
   End Get
  End Property

  Public Sub New(ByVal value As Integer)
   If value < 1 Or value > 10 Then 
      Throw New ArgumentOutOfRangeException("value")
   End If
   m_Value = value
  End Sub

  Public Function CompareTo(ByVal other As LimitedInt) As Integer _
      Implements System.IComparable(Of LimitedInt).CompareTo
   Return Me.Value - other.Value
  End Function

  Public Overloads Function Equals(ByVal other As LimitedInt) As Boolean _
     Implements System.IEquatable(Of LimitedInt).Equals
   Return Me.Value = other.Value
  End Function

  Public Overrides Function GetHashCode() As Integer
   Return Value.GetHashCode
  End Function

  Public Overrides Function Equals(ByVal obj As Object) As Boolean
   If TypeOf obj Is LimitedInt Then Return CType(obj, LimitedInt) = Me
  End Function

  Public Shared Operator =(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As Boolean
   Return left.Equals(right)
  End Operator

  Public Shared Operator <>(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As Boolean
   Return Not (left = right)
  End Operator

  Public Shared Operator +(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As LimitedInt
   Dim temp As Integer = left.Value + right.Value
   Select Case temp
     Case 1 To 10 : Return New LimitedInt(temp)
     Case Else : Throw New OverflowException
   End Select
  End Operator

  Public Shared Operator -(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As LimitedInt
   Dim temp As Integer = left.Value - right.Value
   Select Case temp
     Case 1 To 10 : Return New LimitedInt(temp)
     Case Else : Throw New OverflowException
   End Select
  End Operator

  Public Shared Operator *(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As LimitedInt
   Dim temp As Integer = left.Value * right.Value
   Select Case temp
     Case 1 To 10 : Return New LimitedInt(temp)
     Case Else : Throw New OverflowException
   End Select
  End Operator

  Public Shared Operator /(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As Double
   Return left.Value / right.Value
  End Operator

  Public Shared Operator \(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As LimitedInt
   Dim temp As Integer = left.Value \ right.Value
   Select Case temp
     Case 1 To 10 : Return New LimitedInt(temp)
     Case Else : Throw New OverflowException
   End Select
  End Operator

  Public Shared Operator Mod(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As LimitedInt
   Dim temp As Integer = left.Value Mod right.Value
   Select Case temp
     Case 1 To 10 : Return New LimitedInt(temp)
     Case Else : Throw New OverflowException
   End Select
  End Operator

  Public Shared Operator And(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As LimitedInt
   Dim temp As Integer = left.Value And right.Value
   Select Case temp
     Case 1 To 10 : Return New LimitedInt(temp)
     Case Else : Throw New OverflowException
   End Select
  End Operator

  Public Shared Operator Or(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As LimitedInt
   Dim temp As Integer = left.Value Or right.Value
   Select Case temp
     Case 1 To 10 : Return New LimitedInt(temp)
     Case Else : Throw New OverflowException
   End Select
  End Operator

  Public Shared Operator Xor(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As LimitedInt
   Dim temp As Integer = left.Value Xor right.Value
   Select Case temp
     Case 1 To 10 : Return New LimitedInt(temp)
     Case Else : Throw New OverflowException
   End Select
  End Operator

  Public Shared Operator ^(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As Double
   Return left.Value ^ right.Value
  End Operator

  Public Shared Operator <(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As Boolean
   Return left.Value < right.Value
  End Operator

  Public Shared Operator >(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As Boolean
   Return left.Value > right.Value
  End Operator

  Public Shared Operator <=(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As Boolean
   Return left.Value <= right.Value
  End Operator

  Public Shared Operator >=(ByVal left As LimitedInt, _
     ByVal right As LimitedInt) As Boolean
   Return left.Value >= right.Value
  End Operator

  Public Shared Widening Operator CType(ByVal left As LimitedInt) As Integer
   Return left.Value
  End Operator

  Public Shared Narrowing Operator CType(ByVal left As Integer) As LimitedInt
   Return New LimitedInt(left)
  End Operator

End Structure 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-25T20:00:18.053

通过使用 Delphi.Net 或 Delphi Prism（两种 .Net 语言），您可以定义如下变量：

```
MyAge : 0..120;
NumOfFingersAfterNewYear : 0..10; 
```

一个很好的优势是您将使用它进行编译时范围检查。

# yacc - Yacc：每个非终结符之后的代码

> ID：393104
> 
> 赞同：0
> 
> 时间：2008-12-25T19:30:15.090
> 
> 标签：yacc

有没有办法在每个终端之后执行代码？

所以这样的事情是可能的：

```
a : B { code } C { some code } 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-25T19:38:31.873

您给出的示例应该按原样工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-25T19:41:40.260

你说的对。在插入代码后，我不知道 C 是 3 美元，而不是 2 美元……真的很奇怪。

# cygwin - 如何运行 Windows 和 Cygwin 都无法执行的二进制文件？

> ID：393105
> 
> 赞同：1
> 
> 时间：2008-12-25T19:30:26.320
> 
> 标签：cygwin

我还没有加载 Linux 的虚拟机（我的机器上的虚拟机上有 OpenSUSE），但是每当我在 Cygwin 下运行可执行文件时，我都会收到错误消息“无法执行二进制文件”。Windows (PowerShell) 告诉我它找不到作为文件名的命令，或者如果我使用 ./，它告诉我没有应用程序可以打开此文件。此外，在 Windows（命令提示符）中，我收到一条消息，指出该文件未被识别为命令或可运行程序。

请注意，我已经在 Cygwin 上使用 chmod 将文件设置为可执行文件。

我不知道这是什么语言，但它是一个可执行文件。我试图能够在我的本地机器上执行这个文件，这样我就可以完成它的实际分配，即对应用程序进行黑盒测试。不幸的是，我要出差，不想依赖学校的服务器，因为在我回家之前我无法获得可靠的 Internet 访问。

感谢您提供有关处理此问题的任何建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-25T19:50:10.027

Cygwin 不执行 Linux 可执行文件，因此您不能只以这种方式运行 Linux 二进制文件。

为了在 Cygwin 下执行某些东西，您需要为此专门编译它。

因此，我认为你只需要在 Linux 机器或 VM 上运行它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-25T19:39:46.380

使用[“文件”实用程序](http://gnuwin32.sourceforge.net/packages/file.htm)首先确定二进制文件的类型...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-25T19:38:28.597

我认为运行应用程序需要了解更多信息。它是32位还是64位？为windows或linux编译的可执行文件？它依赖于哪些库/平台/应用程序？

# asp.net - 找出重点控制

> ID：393110
> 
> 赞同：1
> 
> 时间：2008-12-25T19:33:43.817
> 
> 标签：asp.net, jquery, vb.net, reflection

我正在尝试向控件添加一个 CSS 类，以便在呈现页面后获得焦点。虽然 Page 类的 SetFocus() 方法允许我设置 Control，但没有相应的 GetFocus() 方法。

根据 .Net 来源，信息存储在 Page 类的私有成员 _focusedControl 中。属性 FocusedControl 标记为内部。

有没有办法通过使用反射来获取私有成员或内部属性的值？

任何帮助将不胜感激。

**澄清：** 这就是我要添加 CssClass 服务器端的原因：我正在尝试应用以下 JQuery 脚本，该脚本会更改焦点元素的背景：

```
$(document).ready(function() {
  var elements = jQuery("textarea, select, multi-select, :text, :password, :file");

  elements.bind
  (
    'focus',
    function() {
      jQuery(this).addClass('highlightinput');
    }
  );

  elements.bind
  (
    'blur',
    function() {
      jQuery(this).removeClass('highlightinput');
    }
  );
}) 
```

只要我没有在我的 aspx.vb 中专门设置一个焦点控件，它就可以正常工作。如果我确实设置了一个焦点控件（我认为是由于时间问题），焦点是在我的处理程序附加到输入字段之前设置的，因此输入不会突出显示。所以我的方法是在呈现页面之前将 highlightinput 类添加到焦点控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-27T06:57:41.407

如果您正在寻找一个突出重点元素的 CSS 解决方案，我相信您可以使用 ':focus' 选择器。我没有尝试过，但我相信这是一个有效的选择器。你可以在你的 css 文件中使用它：

```
:focus{ background-color: yellow;}
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-25T19:48:44.723

焦点控制可能在回传之间发生了变化，这就是为什么我认为你不能轻易找到它的原因。在 ViewState 中保留每个控件的整个状态可能太昂贵了。

也许您可以使用 javascript 在客户端的隐藏字段中跟踪哪个控件具有焦点，并在服务器上读取它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-27T07:10:57.857

为什么不直接通过 JavaScript 来完成呢？就像是：

`body.onLoad = function() { document.activeElement.style.color = '#ff0000'}`

这可能是错误的，但我认为这是一个好的开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T18:00:30.647

我不知道我是否正确理解了你的问题...

你不能只添加一个cssclass来控制你在服务器端的设置焦点吗？

```
controlObj).CssClass = "highlightinput"
Page.SetFocus(controlObj) 
```

# c# - 是否可以根据收到的 cookie 理解成功登录？

> ID：393118
> 
> 赞同：1
> 
> 时间：2008-12-25T19:39:59.280
> 
> 标签：c#, authentication, cookies, httpwebrequest

在开发 C# 应用程序（我的第一个 C# 应用程序）时：

*   从用户（id，pass）获取登录信息，
*   打开`HttpWebRequest`到 ASP.NET 网页的新连接
*   尝试使用获得的 [id,pass] 元组登录到此页面。如果登录成功，我的`HttpWebRequest`对象包含一个 cookie，它将用于登录另一个页面。

在请求第二个（受保护的）页面之前，我想确保第一次登录成功。首先，我认为只有在登录成功的情况下，服务器才会发送一个 cookie。但事实并非如此。:)

是否可以从收到的 cookie 对象中了解我的登录成功？或者您可以为我提出其他解决此问题的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-25T23:53:32.500

感谢所有回复。这是我奇怪的解决方案。:) 我写这个是因为将来有人可能需要它。

我收到的 cookie 不包含特定的 [name,value] 对，例如 [logged,true]。我收到的唯一东西是：

```
Set-Cookie: ASP.NET_SessionId=ah0b2kj40oi0vuufv0mmot35; path=/; HttpOnly\r\n 
```

所以，我以为我走错了方向，并试图找到另一种方法来分析登录是否成功。我的解决方案是使用响应的 StatusCode。我意识到（感谢 Jason 关于错误代码 401 的评论）如果登录成功，服务器会返回一个 HTTP 302 Found 状态代码。但如果登录不成功，它会返回相同的登录页面（即 HTTP 200 OK）。因此，根据收到的响应的 HTTP 代码，我决定它是否成功。这是示例代码：

```
//In LoginForm.cs
if (((HttpWebResponse)request.GetResponse()).StatusCode.ToString().Equals("Found"))
            {
                    nextUrl = ((HttpWebResponse)request.GetResponse()).Headers.Get(4);
                    StringBuilder FullUrl = new StringBuilder(this.server_address);
                    FullUrl.Append(nextUrl);
                    this.setSecretURL(FullUrl.ToString());

                    setLoginSuccess(true);
                    // now we can send out cookie along with a request for the protected page
                    request = WebRequest.Create(SECRET_PAGE_URL) as HttpWebRequest;
                    request.CookieContainer = cookies;
                    StreamReader responseReader = new StreamReader(request.GetResponse().GetResponseStream());

                    // and read the response
                    result = responseReader.ReadToEnd();
                    responseReader.Close();

     } else 
     {
          setLoginSuccess(false);                   
     } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-25T19:56:52.320

如果用户未获得授权，则 Web 服务器应返回 HTTP 错误代码 401

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-25T20:07:26.700

我会做两件事之一。

1.  我可以使用 Web 服务，而不是使用 aspx 页面。webservice login 方法会返回一个 xml 响应，告诉你登录是否成功，除了给你一个 cookie。（一些 StackOverflowers 可能不同意在 web 服务中使用 cookie，但我喜欢它们。）

2.  您的登录页面可能更像是一个 API。假设您的网址如下所示：

    [http://mywebsite.com/api.aspx?method=login&userid=sampleuser&password=password](http://mywebsite.com/api.aspx?method=login&userid=sampleuser&password=password)

    在响应 html 中，您可以发回可解析的消息，可以只是文本或 xml。例如，结果页面可能只是说“成功”。您的 c# 应用程序可以读取此内容并看到您已成功登录。

    注意：您可能希望通过 POST 请求发送用户名和密码，并可能在发送之前对密码进行哈希处理。

祝你好运！

# java - 在 Java 中提取标签值对的正则表达式

> ID：393121
> 
> 赞同：7
> 
> 时间：2008-12-25T19:44:35.777
> 
> 标签：java, regex, pattern-matching

我有一个包含几行的文件，类似于：

```
Name: Peter
Address: St. Serrano número 12, España
Country: Spain 
```

而且我需要使用正则表达式提取地址，考虑到它可以包含点、特殊字符（ñ、ç）、áéíóú...

当前代码有效，但看起来很丑：。

```
Pattern p = Pattern.compile("^(.+?)Address: ([a-zA-Z0-9ñÑçÇáéíóú., ]+)(.+?)$",
                            Pattern.MULTILINE | Pattern.DOTALL);
Matcher m = p.matcher(content);
if (m.matches()) { ... } 
```

**编辑：地址字段也可以分为多行**

```
Name: Peter
Address: St. Serrano número 12,   
Madrid
España
Country: Spain 
```

编辑：我不能使用 Properties 对象或 YAML 解析器，因为该文件也包含其他类型的信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-26T21:13:16.847

我不太了解 Java 的正则表达式对象，但类似这种模式的东西可以做到：

```
^Address:\s*((?:(?!^\w+:).)+)$ 
```

假设 multiline 和 dotall 模式打开。

这将匹配任何以 Address 开头的行，然后是任何内容，直到换行符和一个单词后跟一个冒号。

如果您知道下一个字段必须是“国家/地区”，您可以稍微简化一下：

```
^Address:\s*((?:(?!^Country:).)+)$ 
```

诀窍在于重复组中的前瞻断言。'（？！国家：）。' 将匹配除字符串 'Country:' 开头之外的所有内容，因此我们只需将其放在非捕获括号 (?:...) 中并用 + 量化它，然后将所有这些分组在正常捕获括号中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-25T20:55:46.600

您可能想查看[`Properties`](http://java.sun.com/javase/6/docs/api/)类而不是正则表达式。它为您提供了管理纯文本或 XML 文件以表示键值对的方法。

因此，您可以读取示例文件，然后在加载到`Properties`对象后获取如下值：

```
Properties properties = new Properties();
properties.load(/* InputStream of your file */);

Assert.assertEquals("Peter", properties.getProperty("Name"));
Assert.assertEquals("St. Serrano número 12, España", properties.getProperty("Address"));
Assert.assertEquals("Spain", properties.getProperty("Country")); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-26T04:42:00.233

假设“内容”是一个包含文件内容的字符串，那么您的主要问题是您正在使用的`matches()`地方应该使用`find()`.

```
Pattern p = Pattern.compile("^Address:\\s*(.*)$", Pattern.MULTILINE);
Matcher m = p.matcher(content);
if ( m.find() )
{
  ...
} 
```

关于 MULTLINE 和 DOTALL 模式的其他答案似乎有些混乱。MULTILINE 让`^`和`$`锚点分别匹配逻辑行的开头和结尾。DOTALL 让点（句点、句号等）匹配行分隔符，如`\n`（换行）和`\r`（回车）。此正则表达式**必须**使用 MULTILINE 模式，**不得**使用 DOTALL 模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T02:22:30.000

我并不是要陷入困境，但是您必须使用正则表达式吗？为什么不让未来的自己（或其他人）头疼，然后做：

```
String line = reader.readLine();
while(line != null)
{
    line = line.trim();
    if(line.startsWith("Address: "))
    {
        return line.substr("Address: ".length()).trim();
    }
    line = reader.readLine();
}
return null; 
```

当然，这也可以稍微参数化并放入方法中。

否则，我会支持 Properties 或 JYaml 建议。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-25T19:54:06.367

不是 Java 人，但不会`"Address: (.*)$"`工作？

编辑：没有 Pattern.MULTILINE | Pattern.DOTALL 选项它应该只匹配该行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-25T19:57:31.523

它可以包含换行符吗？如果它不能包含换行符，则不需要使用多行修饰符，而是可以使用

```
Pattern p = Pattern.compile("^Address: (.*)$"); 
```

如果可以的话，我能想到的另一种选择是

```
Pattern p = Pattern.compile("Address: (.*)\nCountry", Pattern.MULTILINE); 
```

如果没有 DOTALL，点将不会匹配换行符，因此您可以在正则表达式中明确指定它，从而允许您执行您所要求的操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-26T00:21:59.603

你绝对应该检查[YAML](http://yaml.org)。

你可以试试[JYaml](http://jyaml.sourceforge.net/)。

最重要的是，它有多种语言的实现。

*ps 我已经尝试过[YAML::XS](http://search.cpan.org/perldoc?YAML::XS)中的示例文本，并且效果很好。*

# asp.net - 使用 jQuery 打开新页面的模态对话框

> ID：393123
> 
> 赞同：0
> 
> 时间：2008-12-25T19:45:04.467
> 
> 标签：asp.net, javascript, jquery

我看到很多使用 jquery 打开弹出窗口的示例，但没有看到任何可以让我在弹出窗口（模式对话框）中打开新页面的内容。任何帮助表示赞赏。

我想要做的是，当单击项目时，它将在模型对话框中打开项目描述页面，调用详细页面的 url。我正在使用 asp.net，如果有很好的方式来处理弹出窗口，我想使用 jquery。

* * *

### 另请参阅：[JQuery 中的 PopupWindow](https://stackoverflow.com/questions/392698/popupwindow-in-jquery)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-25T20:07:40.350

当然; 实际上有[很多](http://plugins.jquery.com/search/node/modal+type%3Aproject_project)。例如：[jqModal](http://dev.iceburg.net/jquery/jqModal/)。有关如何将单独的页面[`<iframe>`](http://www.pixeline.be/experiments/ThickboxToJqModal/)加载[到](http://www.pixeline.be/experiments/ThickboxToJqModal/).

# ruby-on-rails - 方法在控制台中有效，但在控制器中无效？

> ID：393129
> 
> 赞同：0
> 
> 时间：2008-12-25T19:51:02.753
> 
> 标签：ruby-on-rails

抱歉:: 我忘记了控制器中不存在 params[:user_id] ，使用 current_user.id ！

我编写了一个方法，该方法返回用户出价的位置值数组，例如 [2, 8, 10]。在 Rails 控制台中它可以正常工作，但是来自控制器的实例变量将 nil 返回给浏览器。这是怎么回事？

此方法从控制台返回一个数组，例如 [1, 2, 3]

```
 def bid_places(bid_user_id, auction_id)

    unique_bids = Bid.find_all_by_auction_id(auction_id).uniq
    unique_bids.sort! {|a, b| b.point <=> a.point }

    a, n, places = 0, 0, []
    until a == 3 || n == unique_bids.count
      place = n + 1
      user = unique_bids.values_at(n).first.user_id
      if user == bid_user_id
        places[a] = place
        a += 1
      end
      n += 1
    end
    places
  end 
```

在控制器中，这将返回 [] （使用调试器）

```
@user_places = @bid.bid_places(params[:user_id], params[:auction_id])
=> [] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-25T20:10:44.943

小心，您可能会看到脚本/控制台的交互性比您的方法中实际发生的情况更能告诉您。

问题，您的方法实际上是否返回了一些东西？尝试明确定义退货，看看它是否适合您？

script/console (and irb) often times do STDOUT evaluations that return you things that aren't actually being returned to offer more debugging help.

# objective-c - 创建结构数组的最简单方法是什么？

> ID：393151
> 
> 赞同：19
> 
> 时间：2008-12-25T20:12:09.123
> 
> 标签：objective-c, cocoa

在 Cocoa 中创建结构数组的最简单方法是什么？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-12-25T22:15:43.570

如果你想使用 NSArray ，你需要把你的结构装箱。您可以使用 NSValue 类对它们进行编码。

像这样编码：

```
struct foo {
    int bar;
};

struct foo foobar;
foobar.bar = 3;
NSValue *boxedFoobar = [NSValue valueWithBytes:&foobar objCType:@encode(struct foo)]; 
```

然后把它拿回来：

```
struct foo newFoobar;

if (strcmp([boxedFoobar objCType], @encode(struct foo)) == 0)
    [boxedFoobar getValue:&newFoobar]; 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-12-25T20:55:31.470

或动态分配：

```
struct foo {
    int bar;
};

int main (int argc, const char * argv[]) {
    struct foo *foobar = malloc(sizeof(struct foo) * 3);
    foobar[0].bar = 7; // or foobar->bar = 7;

    free(foobar);
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-25T20:52:33.533

如果您对常规的旧 C 数组没问题：

```
struct foo{
    int bar;
};

int main (int argc, const char * argv[]) {
    struct foo foobar[3];
    foobar[0].bar = 7;
} 
```

如果你想要一个 NSArray，你需要一个包装对象。大多数原语使用 NSNumber，但这可能不适用于您的结构。包装器不会很难编写，尽管这违背了使用结构的目的！

编辑：这是我没有做过但只是想到的事情。如果您考虑一下，NSDictionary 基本上是对象的结构。您的键可以是结构组件的名称，如 NSStrings，您的值可以是包装在适用的 Cocoa 包装器中的相应数据类型。然后把这些字典放在一个 NSArray 中。

我想要点是你有很多选择。如果我是你，我会做一些实验，看看什么效果最好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-26T05:39:57.497

它需要是一个结构吗？如果可以的话，通常最好把它变成一个对象。然后你可以使用 KVC 和 Bindings 之类的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-11T06:45:37.707

使用类更容易，但是如果您需要使用 C 和目标 c 结构（如 CGRect 或其他）怎么办。我尝试使用 NSValue，但它的工作原理很奇怪......：

```
CGRect rect =CGRectMake(20,220,280,30);
NSValue* rectValue = [NSValue valueWithCGRect:rect];
NSArray *params1;
params1= [NSArray arrayWithObjects:rectValue,nil]; 
```

但是，我只能得到 CGRect 值：

```
CGRect cgr = [[params1 objectAtIndex:0] CGRectValue]; 
```

当我使用这个时：

```
id currentVal = [params1 objectAtIndex:0];  
void* buffer;
buffer=[currentVal pointerValue]; 
```

它导致错误...

* * *

问题[在这里解决](https://stackoverflow.com/questions/7036665/nsvaluegetvalue-strange-behavior-why-this-happens)

# c# - 为什么 foreach 语句接受实现“集合”模式的对象，而不是只接受实现 IEnumerable 的对象？

> ID：393152
> 
> 赞同：2
> 
> 时间：2008-12-25T20:12:17.093
> 
> 标签：c#, foreach, ienumerable

很多人问我为什么，我没有很好的答案。

显然有一个很好的理由。有人知道吗？

我在这里搜索并找到[了这个问题](https://stackoverflow.com/questions/127233/does-class-need-to-implement-ienumerable-to-use-foreach)。它解释了它是如何工作的，但没有解释为什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-25T20:49:44.897

假设您想要等效的 an`IEnumerable<int>`但正在使用 C# 1.0。您*可以*实施`IEnumerable`- 但这需要在每次迭代时进行装箱和拆箱。使用那种鸭子打字版本的`foreach`你可以不用任何拳击就可以逃脱。在许多情况下，拳击实际上并没有那么有害（我倾向于发现[性能影响被夸大了](http://msmvps.com/blogs/jon_skeet/archive/2008/10/08/why-boxing-doesn-t-keep-me-awake-at-nights.aspx)），但它仍然不雅。

我强烈、*强烈*怀疑，如果泛型出现在 C# 1.0 中，`foreach`就会被限制在`IEnumerable<T>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-15T17:45:13.077

与 IEnumerable 相比，鸭式 foreach 有几个优点：

1.  有些东西足以满足“IEnumerable”合同的要求，可以与“foreach”一起使用，但不能完全满足合同，尤其是重复获得独立枚举数的能力。关于这一点，让“foreach”接受 IEnumerator [通用或非通用] 或 IEnumerable [同样] 将是一种替代解决方案。
2.  尽管 IEnumerable.GetEnumerator 的某些实现返回一个实现 IEnumerator 的结构，并且虽然这在使用鸭子类型时很有用，但在某些情况下该行为可能会出现问题。foreach 使用鸭子类型的事实允许编译器有一个公共 GetEnumerator() 函数返回一个结构类型枚举器（它不实现任何接口）并让编译器使用它，同时让 IEnumerable.GetEnumerator 返回一个类。

第二个优势实际上只能通过鸭式打字来实现。

# x86 - 与 smalltalk 对象的动态链接

> ID：393154
> 
> 赞同：0
> 
> 时间：2008-12-25T20:14:56.823
> 
> 标签：x86, smalltalk, dynamic-linking, language-implementation

我计划在我的 smalltalk 方言中实现动态链接。问题在于让消息传递与动态链接一起工作。

消息传递本身就是这么简单：将带有选择器的消息发送给对象，对象从它的协议中选择与选择器匹配的方法，然后处理与消息绑定的数据并返回结果。

在基于图像的实现中，可以以非常直接的方式实现消息传递 - 您的消息选择器可以只是从全局符号表转换而来的整数，您的协议可以只是其中包含整数和地址的哈希表。假设它全部用该全局符号表编译成一个大图像。

在动态链接中，您不能假设符号表指向正确的选择器。您可以使用字符串作为选择器来解决问题，但您注定语言会变慢。

有一种方法，它涉及复制协议和选择器表，以便进程正确地重新定位它们。但这听起来像是一项相当多的工作。

有没有更好的方法来解决这个问题？另外，动态链接值得吗？如何实现选择器和协议的重定位？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-02T21:01:57.477

当然你可以假设一个全局符号表，你只需要更新它并确保在链接时代码只使用该表中的符号实例。你看过吱吱吗？加载代码是图像级的（不是虚拟机），因此很容易从任何 Squeak 图像中浏览。

# .net - 如何在 WebBrowser 控件中禁用单击声音

> ID：393166
> 
> 赞同：23
> 
> 时间：2008-12-25T20:36:03.723
> 
> 标签：.net, winforms, audio, webbrowser-control

我使用 Javascript 单击 webbrowser 控件中的链接。但我不想听到 IE 的“咔哒”声。

有没有办法做到这一点？

附言

*   我不想更改系统设置。
*   我见过这个（[HowTo Disable WebBrowser 'Click Sound' only in your app](https://stackoverflow.com/q/10456)），但`Document.Write`不是我的选择。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-04-10T10:41:01.823

对于 IE7 及更高版本，您可以使用以下命令：

```
int feature = FEATURE_DISABLE_NAVIGATION_SOUNDS;
CoInternetSetFeatureEnabled(feature, SET_FEATURE_ON_PROCESS, true); 
```

使用以下 DLL 导入

```
private const int FEATURE_DISABLE_NAVIGATION_SOUNDS = 21;
private const int SET_FEATURE_ON_THREAD = 0x00000001;
private const int SET_FEATURE_ON_PROCESS = 0x00000002;
private const int SET_FEATURE_IN_REGISTRY = 0x00000004;
private const int SET_FEATURE_ON_THREAD_LOCALMACHINE = 0x00000008;
private const int SET_FEATURE_ON_THREAD_INTRANET = 0x00000010;
private const int SET_FEATURE_ON_THREAD_TRUSTED = 0x00000020;
private const int SET_FEATURE_ON_THREAD_INTERNET = 0x00000040;
private const int SET_FEATURE_ON_THREAD_RESTRICTED = 0x00000080;

...

[DllImport("urlmon.dll")]
[PreserveSig]
[return:MarshalAs(UnmanagedType.Error)]
static extern int CoInternetSetFeatureEnabled(
int FeatureEntry,
[MarshalAs(UnmanagedType.U4)] int dwFlags,
bool fEnable); 
```

（在 MS 反馈站点上作为 WPF 团队的解决方案找到：[https](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=345528&wa=wsignin1.0) ://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=345528&wa=wsignin1.0 ）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-06-08T02:22:05.230

我已将此功能包装到一个随时可用的类中。我使用了来自所选答案和[MSDN 参考](http://msdn.microsoft.com/en-us/library/ms537023%28v=VS.85%29.aspx)的部分信息。

希望这对某人有用。

**用法**

```
URLSecurityZoneAPI.InternetSetFeatureEnabled(URLSecurityZoneAPI.InternetFeaturelist.DISABLE_NAVIGATION_SOUNDS, URLSecurityZoneAPI.SetFeatureOn.PROCESS, false); 
```

**URLSecurityZoneAPI**

```
 /// <summary>
  /// Enables or disables a specified Internet Explorer feature control
  /// Minimum availability: Internet Explorer 6.0
  /// Minimum operating systems: Windows XP SP2
  /// </summary>
  internal class URLSecurityZoneAPI
  {

    /// <summary>
    /// Specifies where to set the feature control value
    /// http://msdn.microsoft.com/en-us/library/ms537168%28VS.85%29.aspx
    /// </summary>
    public enum SetFeatureOn : int
    {
      THREAD = 0x00000001,
      PROCESS = 0x00000002,
      REGISTRY = 0x00000004,
      THREAD_LOCALMACHINE = 0x00000008,
      THREAD_INTRANET = 0x00000010,
      THREAD_TRUSTED = 0x00000020,
      THREAD_INTERNET = 0x00000040,
      THREAD_RESTRICTED = 0x00000080
    }

    /// <summary>
    /// InternetFeaturelist
    /// http://msdn.microsoft.com/en-us/library/ms537169%28v=VS.85%29.aspx
    /// </summary>
    public enum InternetFeaturelist : int
    {
      OBJECT_CACHING = 0,
      ZONE_ELEVATION = 1,
      MIME_HANDLING = 2,
      MIME_SNIFFING = 3,
      WINDOW_RESTRICTIONS = 4,
      WEBOC_POPUPMANAGEMENT = 5,
      BEHAVIORS = 6,
      DISABLE_MK_PROTOCOL = 7,
      LOCALMACHINE_LOCKDOWN = 8,
      SECURITYBAND = 9,
      RESTRICT_ACTIVEXINSTALL = 10,
      VALIDATE_NAVIGATE_URL = 11,
      RESTRICT_FILEDOWNLOAD = 12,
      ADDON_MANAGEMENT = 13,
      PROTOCOL_LOCKDOWN = 14,
      HTTP_USERNAME_PASSWORD_DISABLE = 15,
      SAFE_BINDTOOBJECT = 16,
      UNC_SAVEDFILECHECK = 17,
      GET_URL_DOM_FILEPATH_UNENCODED = 18,
      TABBED_BROWSING = 19,
      SSLUX = 20,
      DISABLE_NAVIGATION_SOUNDS = 21,
      DISABLE_LEGACY_COMPRESSION = 22,
      FORCE_ADDR_AND_STATUS = 23,
      XMLHTTP = 24,
      DISABLE_TELNET_PROTOCOL = 25,
      FEEDS = 26,
      BLOCK_INPUT_PROMPTS = 27,
      MAX = 28
    }

    /// <summary>
    /// Enables or disables a specified feature control. 
    /// http://msdn.microsoft.com/en-us/library/ms537168%28VS.85%29.aspx
    /// </summary>            
    [DllImport("urlmon.dll", ExactSpelling = true), PreserveSig, SecurityCritical, SuppressUnmanagedCodeSecurity]
    [return: MarshalAs(UnmanagedType.Error)]
    static extern int CoInternetSetFeatureEnabled(int featureEntry, [MarshalAs(UnmanagedType.U4)] int dwFlags, bool fEnable);

    /// <summary>
    /// Determines whether the specified feature control is enabled. 
    /// http://msdn.microsoft.com/en-us/library/ms537164%28v=VS.85%29.aspx
    /// </summary>
    [DllImport("urlmon.dll", ExactSpelling = true), PreserveSig, SecurityCritical, SuppressUnmanagedCodeSecurity]
    [return: MarshalAs(UnmanagedType.Error)]
    static extern int CoInternetIsFeatureEnabled(int featureEntry, int dwFlags);

    /// <summary>
    /// Set the internet feature enabled/disabled
    /// </summary>
    /// <param name="feature">The feature from <c>InternetFeaturelist</c></param>
    /// <param name="target">The target from <c>SetFeatureOn</c></param>
    /// <param name="enabled">enabled the feature?</param>
    /// <returns><c>true</c> if [is internet set feature enabled] [the specified feature]; otherwise, <c>false</c>.</returns>
    public static bool InternetSetFeatureEnabled(InternetFeaturelist feature, SetFeatureOn target, bool enabled)
    {
      return (CoInternetSetFeatureEnabled((int)feature, (int)target, enabled) == 0);
    }

    /// <summary>
    /// Determines whether the internet feature is enabled.
    /// </summary>
    /// <param name="feature">The feature from <c>InternetFeaturelist</c></param>
    /// <param name="target">The target from <c>SetFeatureOn</c></param>
    /// <returns><c>true</c> if the internet feature is enabled; otherwise, <c>false</c>.
    /// </returns>
    public static bool IsInternetSetFeatureEnabled(InternetFeaturelist feature, SetFeatureOn target)
    {
      return (CoInternetIsFeatureEnabled((int)feature, (int)target) == 0);
    }

  } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-25T20:49:38.407

正如评论和[@James Crowley](https://stackoverflow.com/users/33682/james-crowley)的回答所指出的，这确实是可能的。

* * *

~~如果您在 IE 中导航，并因此在该控件中导航，您将获得点击。除非您更改设置，或者像那个链接那样伪造它，否则不，您无法摆脱点击。~~

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-18T00:51:59.890

我不能让它在 VB.net 上工作，试过这个：

```
Private Const FEATURE_DISABLE_NAVIGATION_SOUNDS As Integer = 21
Private Const SET_FEATURE_ON_THREAD As Integer = &H1
Private Const SET_FEATURE_ON_PROCESS As Integer = &H2
Private Const SET_FEATURE_IN_REGISTRY As Integer = &H4
Private Const SET_FEATURE_ON_THREAD_LOCALMACHINE As Integer = &H8
Private Const SET_FEATURE_ON_THREAD_INTRANET As Integer = &H10
Private Const SET_FEATURE_ON_THREAD_TRUSTED As Integer = &H20
Private Const SET_FEATURE_ON_THREAD_INTERNET As Integer = &H40
Private Const SET_FEATURE_ON_THREAD_RESTRICTED As Integer = &H80

Declare Function CoInternetSetFeatureEnabled Lib "urlmon.dll" ( _
ByVal FeatureEntry As Integer, ByVal dwFlags As Long, _
ByVal fEnable As Long) As Long 
```

...

```
CoInternetSetFeatureEnabled(FEATURE_DISABLE_NAVIGATION_SOUNDS, SET_FEATURE_ON_PROCESS, True) 
```

编辑：发现问题，在声明之内。真正的一个是：

```
<SecurityCritical, SuppressUnmanagedCodeSecurity, DllImport("urlmon.dll", ExactSpelling:=True)> _
Public Shared Function CoInternetSetFeatureEnabled(ByVal featureEntry As Integer, ByVal dwFlags As Integer, ByVal fEnable As Boolean) As Integer
End Function 
```

感谢[http://msdn.microsoft.com/en-us/library/ms537168%28VS.85%29.aspx上的 dmex](http://msdn.microsoft.com/en-us/library/ms537168%28VS.85%29.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-22T04:29:37.277

Imports System.Runtime.InteropServices < Imports System.Security

qxxx use those imports

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-25T21:14:02.757

您唯一的其他选择是将计算机静音，但这不是一个好主意...

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-25T21:35:39.377

所以这是已知的限制......

是否有任何肮脏的黑客/解决方法，例如挂钩 ActiveX 的声音调用并禁用它们（不确定是否可能不深入）

# .net - .NET 互操作：使用 C# 查找正在运行的 COM 对象的所有实例

> ID：393167
> 
> 赞同：4
> 
> 时间：2008-12-25T20:36:29.433
> 
> 标签：.net, interop, automation, ms-office, com-interop

# 背景

我正在通过命令行工具自动化一些 Office 应用程序（Word 和 PowerPoint）。

我的工具需要做的一件事是找到所有正在运行的 Word 实例。

我知道如何获得对其中一个实例的引用......

```
Object running_obj = null;
{
    running_obj = System.Runtime.InteropServices.Marshal.GetActiveObject(progid);
}
catch (System.Exception)
{
    //failed to find the object;
}
if (running_obj!=null)
{
   var running_obj_type = System.Type.GetTypeFromProgID(progid);
   Microsoft.Office.Interop.Word.Application running_obj_wrapper;
   running_obj_wrapper = 
            (Microsoft.Office.Interop.Word.Application)
            System.Runtime.InteropServices.Marshal.CreateWrapperOfType(
                  running_obj, running_obj_type);
} 
```

# 我的问题

如何找到我正在寻找的应用程序的*所有实例，而不仅仅是其中一个。*

注意：虽然我的具体问题是关于 Office 应用程序的，但我*也*对更一般的答案感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-25T22:29:50.123

没试过。但它看起来是正确的解决方案。来自[Oliver Bock 博客](http://blocko.blogspot.com/2006/10/driving-excel-and-powerpoint-with-c.html)。

# c# - 可嵌入文件打开对话框

> ID：393168
> 
> 赞同：2
> 
> 时间：2008-12-25T20:38:18.353
> 
> 标签：c#, .net, fileopendialog

我正在寻找一个能够嵌入 FileOpenDialog 的功能而无需使用模式对话框的控件。这样的东西已经存在了吗？（理想情况下在 .Net 2.0 框架、C# 中）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T02:43:05.497

我还没有遇到过，但我不得不做一些很像你为我最近的项目建议的事情。我所做的是一种从`DataGridView`.

[CodeProject 上](http://www.codeproject.com/KB/list/FileSystemListView.aspx)有一个很好的例子，关于如何制作一个看起来像 FileOpenDialog 中标准的 ListView。它使用一点 P/Invoke 来获取系统映像列表，您可能必须自己摆弄它才能使其正常工作，但它非常有效。我以此为起点，也许它会帮助您朝着正确的方向开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T06:00:04.053

谢谢。我看到了这个例子，但我只能把它评为“好拥有”和“必备”。这*几乎*是值得的，因为我也可以在其他地方使用它，但我现在无法证明它的合理性。

我做了一些更多的搜索，并没有真正遇到我正在寻找的任何东西。

# asp.net - 设置具有多个工作站和 Visual Studio 2008 的开发环境

> ID：393169
> 
> 赞同：0
> 
> 时间：2008-12-25T20:40:44.137
> 
> 标签：asp.net, visual-studio-2008, development-environment

我目前有一台小型笔记本电脑和一台用于开发的台式机（+ 游戏装备）。我更喜欢在家中使用工作站，因为它有多个大型显示器和性能，而笔记本电脑则具有移动性。当我需要处理 Visual Studio 2008 Web 项目时，我会通过 Internet 将 RDP 导入我的桌面。我想在我的桌面上本地完成这项工作，但是来回传输文件很麻烦。

我使用[Beyond Compare](http://www.scootersoftware.com/)来保持源文件同步，使用[Redgate SQL 比较](http://www.red-gate.com/products/SQL_Compare/index.htm)来保持数据库同步。我的开发服务器是一个运行 VMWare 的 Ubuntu 服务器，带有 Windows Server 2003 实例，每个项目都有 IIS 和 SQL Server。该服务器可通过中央 FTP 集线器通过 FTP 访问。我不在一个团队中工作，所以不需要 Subversion（或类似的）......虽然我并不反对使用它。我不会编译，直到从我的桌面推送到生产环境。

有没有人有任何改进建议可以使这个多工作站环境更简单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-25T20:45:46.717

使用两者都可以访问的源代码控制几乎肯定会使生活变得更简单。我还要说源代码控制不仅仅是在团队中工作。它允许您进行试验而不会丢失现有工作，保持稳定的版本和开发分支等。

有很多公共源代码控制解决方案——我最近开始使用[git](http://code.google.com/p/msysgit/)，而且[github](http://github.com)真的很容易使用。（我只在命令行中使用 git - 它不像在 Visual Studio 中使用[VisualSvn](http://www.visualsvn.com/)或类似的东西那样流畅，但如果你对命令行感到满意，那应该不是问题。）

无论您选择哪个，源代码控制系统肯定是我建议的多工作站解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-25T21:04:32.357

我放弃了使用我的两个工作站进行开发，转而只使用我的移动笔记本电脑作为我的主要开发人员/业务机器。

使用 HP 工作站扩展坞，我获得了双屏设置。然后我有一台台式机作为我的本地服务器和备份机。

为您的笔记本电脑获取一些 SSD 闪存存储，它会比固定的更快！

安迪

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-28T21:02:43.230

我强烈建议对多系统开发（或单系统开发）使用源代码控制。除了可以轻松地跨多个系统同步更改之外，它还可以帮助您跟踪更改并备份您的工作。我发现能够实施有风险的更改是非常宝贵的，因为我知道只需单击几下我就可以将我的工作恢复到更早的阶段。

Subversion 可以很好，我通常会推荐开源免费软件，但我建议给[perforce](http://www.perforce.com)一个机会。它有一个免费的 2 用户/5 个工作站许可证，因此对于大多数家庭使用来说，它仍然像啤酒一样免费。该界面易于使用，有很多不错的功能，如果您记得安装 perforce SCC 插件，它会直接透明地与 Visual Studio 集成（包括编辑时自动检出）。

# command-line - 监视一组文件的更改并在更改时对其执行命令

> ID：393176
> 
> 赞同：4
> 
> 时间：2008-12-25T20:49:08.363
> 
> 标签：command-line, scripting, file, sysadmin

我想到的（命令行）界面是这样的：

```
watching FILE+ do COMMAND [ARGS] (and COMMAND [ARGS])* 
```

其中任何出现的“ `{}`”`COMMAND`都将替换为更改的文件的名称。请注意，“ `do`”和“ `and`”是关键字。

例如：

```
> watching foo.txt bar.txt do scp {} somewhere.com:. and echo moved {} to somewhere 
```

或者：

```
> watching foo.c do gcc foo.c and ./a.out 
```

不过，我并不喜欢那个界面。我将添加我的脚本作为答案，看看是否有人有更好的方法或改进它的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-25T20:49:18.627

```
#!/usr/bin/perl
# Run some commands whenever any of a set of files changes (see USAGE below).
# Example:
# ./watching.pl foo.txt bar.txt do scp foo.txt remote.com:. and cat bar.txt
# To only do something to the file that changed, refer to it as {}.

$| = 1;  # autoflush

my $p = position("do", @ARGV); # position of 1st occurrence of "do" in @ARGV.
if (@ARGV < 3 || $p == -1 || !($p >= 1 && $p < $#ARGV)) {
  die "USAGE: watching FILE+ do COMMAND [ARGS] (and COMMAND [ARGS])*\n";
}

my $cmdstr = join(' ', splice(@ARGV, $p+1));  # grab stuff after the "do"
my @cmds = split(/\s+and\s+/, $cmdstr);
pop(@ARGV);  # remove the "do" on the end.
my @targets = @ARGV;
print "Watching {", join(' ', @targets), "} do (", join('; ', @cmds), "):\n";

# initialize the %last hash for last mod time of each file.
for my $t (@targets) {
  ($dev,$ino,$mode,$nlink,$uid,$gid,$rdev,$size,
   $atime,$mtime,$ctime,$blksize,$blocks) = stat($t);
  $last{$t} = $mtime;
}

my $i = 1;
while(1) {
  if($i % (45*60) == 0) { print "."; }

  for my $t (@targets) {
    ($dev,$ino,$mode,$nlink,$uid,$gid,$rdev,$size,
     $atime,$mtime,$ctime,$blksize,$blocks) = stat($t);

    if ($mtime != $last{$t}) {
      print "\nCHANGE DETECTED TO $t\n";
      for (@cmds) { my $tmp = $_; $tmp =~ s/\{\}/$t/g; system($tmp); }
      $last{$t} = $mtime;
    }
  }
  sleep(1);
  $i++;
}

# Call like so: position($element, @list).
sub position {
  my $x = shift;
  if(@_==0) { return -1; }
  if($x eq $_[0]) { return 0; }
  shift;
  my $p = position($x,@_);
  if($p==-1) { return -1; }
  return 1+$p;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T20:35:36.577

请检查[`inotify`工具](http://inotify-tools.sourceforge.net/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T22:03:40.083

我刚刚发现这个[`every_change`脚本](http://marginalhacks.com/bin/every_change)是用 perl 编写的，这与我在答案中发布的非常相似。

> 该脚本非常适合代码开发。每次更改时监视文件并运行它（或其他东西）。在一个窗口中编写代码，然后在另一个窗口中观察它自动执行。

所以基本上每次文件更改时它都会做一些事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-06T17:44:24.850

您可以使用[`entr`](http://entrproject.org/)，例如

```
ls foo.txt bar.txt | entr sh -c 'rsync -vuar *.txt somewhere.com:. && echo Updated' 
```

不幸的是，您无法检查哪个文件已更改，但使用`rsync -u`会自动跳过未更改的文件。

这是第二个例子：

```
ls foo.c | entr sh -c 'gcc foo.c && ./a.out' 
```

或简单地使用`make`，例如

```
ls -d * | entr sh -c 'make && make test' 
```

要查看目录的更改，请使用`-d`包装在 shell 循环中的参数，例如：

```
while true; do find path/ | entr -d do_stuff; done 
```

# c# - 哪个单元测试框架以及如何开始（对于 asp.net mvc）

> ID：393184
> 
> 赞同：11
> 
> 时间：2008-12-25T20:57:14.133
> 
> 标签：c#, asp.net-mvc, unit-testing

我以前从未做过单元测试，但现在我愿意尝试一下。

**什么框架最适合初学者？** 优点和缺点

**在开始任何编码之前我应该​​阅读什么？** 书籍/文章/代码/博客

**是否有任何开源“示例项目”？**

我将使用 asp.net mvc/C# 来使用它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-25T21:04:13.747

如果您在 Visual Studio 中集成了单元测试（我认为它是 Professional 的一部分并且更好），请从它开始，因为它是集成的。缺点是据我所知，在 Visual Studio 或 Team Foundation Server 之外没有任何测试运行程序会取消它进行自动化测试的资格，但我不确定这些信息的最新情况。

其他替代品是[xUnit.net](http://www.codeplex.com/xunit)、[NUnit](http://www.nunit.org/index.php)和[mbUnit](http://www.mbunit.com/)。由于缺乏经验，我无法真正谈论利弊，但我现在使用 xUnit.net 因为 a) 我知道自 1.1 版以来有一个有效的 ASP.net MVC 模板和 b) Assert.Throws 只是性感。我在 Visual Studio 中使用免费的个人版[TestDriven.net作为我的测试运行程序。](http://testdriven.net/)

xUnit 有一个“如何开始”指南：http: [//www.codeplex.com/xunit/Wiki/View.aspx? title=HowToUse](http://www.codeplex.com/xunit/Wiki/View.aspx?title=HowToUse)

同样，由于缺乏使用 NUnit 和 mbUnit 的经验，我无法真正比​​较它们，但我相信这三个都相当稳定和可用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-25T21:01:28.820

我使用在 Visual Studio 中添加的一个添加了[TestDriven.Net](http://www.testdriven.net)的右键单击菜单项，允许我在有/没有调试器的情况下运行单个测试。我开始使用 NUnit。任何一个都可能没问题。我更喜欢主要在 VS 中使用一个，因此我不必同时支持这两种工具，但是集成有一些优势，特别是如果您使用 Team System。

我相信 TestDriven.Net 支持很多不同的框架。您还需要使用覆盖分析器来帮助您查看代码的哪些部分已被测试覆盖，并帮助您确定可能需要的其他测试。您可能需要 Team system 才能对 VS 进行覆盖分析，但总有 NCover（随 TestDriven.Net 提供）。

我建议从[Pragmatic Programmers](http://www.pragprog.com)或[Test Driven Development with C#查看](http://www.microsoft.com/learning/en/us/books/6778.aspx)[Pragmatic Unit Testing in C](http://www.pragprog.com/titles/utc2/pragmatic-unit-testing-in-c-with-nunit) # 。两者都会有例子。

Rob Conery 的[StoreFront](http://blog.wekeroad.com/mvc-storefront/)示例是 ASP.NET MVC 的一个很好的示例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-25T21:05:07.520

Rob Conery 制作了[一系列视频](http://blog.wekeroad.com/mvc-storefront/)，展示了如何使用 MVC 创建电子商务应用程序。他正在使用完整的测试驱动方法（使用 Visual Studio 2008 中的内置测试框架）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-27T12:50:02.600

我建议您研究一下[用于 .NET 的 Gallio 自动化平台，](http://www.gallio.org/)因为它提供了一个中立的（免费的）工具，可以在一个 GUI 工具下为您实现多个单元测试框架。它是由 mbUnit 背后的人创建的。

对于任何单元测试框架，我的主要优点是它让您对自己的代码充满信心，并且练习 TDD 成为一件非常自然的事情。

主要缺点是 ASP.NET 网络表单（我倾向于在其中编写代码）不容易进行单元测试，这就是 ASP.NET MVC 对人们如此有吸引力的原因。另一个缺点是您需要深入了解它需要重构测试与他们使用的代码一样多，如果不是更多的话。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-26T00:32:07.663

我唯一要补充的是**a）**给他们一个尝试，看看你喜欢什么*[这是一个废话的答案，但每个人都有自己的好恶，所以'试试'卡被玩了很多]*以及你有什么摩擦点遇到和**b)**在 XUnit CodePlex 站点上查看主要单元测试框架的一个[很好的比较。](http://www.codeplex.com/xunit/Wiki/View.aspx?title=Comparisons)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-25T01:34:13.563

我不是想混淆你，如果你是一名开发人员并且想要测试 ASP.NET MVC 项目然后使用 XUnit，它很好，由微软的员工开发。它有控制台和 gui 运行器，有助于自动测试。XUnit 现在被大多数开发人员使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-26T00:59:51.740

让我们先从一些基础知识开始，好吗？单元测试是指对尽可能小的代码进行测试，通常是代码中的函数/过程/方法。我建议看一下 Martin Fowler 的“重构”，这是一本关于单元测试如何在重构中发挥作用的好书。

根据您设置代码的方式，您可能需要研究模拟框架，例如 RhinoMocks、NMocks、.Net MockObjects，以便您可以设置测试装置来处理调用可能需要的预执行条件。那里可能有不止一些模拟对象单元测试示例，asp.net-mvc 上的教程应该有一两个测试示例。

不要忘记 asp.net-mvc 仍处于测试阶段，随着各种问题的解决，可能会做出更多改变。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-28T14:55:59.830

我正在使用[Selenium RC](http://seleniumhq.org/documentation/remote-control/languages/dotnet.html)和[Moq](http://code.google.com/p/moq/)。到目前为止，我还没有遇到太多我无法测试并获得良好覆盖的领域。

查看[Selenium RC 示例代码](http://svn.openqa.org/fisheye/viewrep/~raw,r=HEAD/selenium-rc/trunk/clients/dotnet/src/IntegrationTests/GoogleTest.cs)。这很简单，很容易理解......

# macos - Spotlight 可以索引 MacFUSE 文件系统吗？

> ID：393191
> 
> 赞同：3
> 
> 时间：2008-12-25T21:11:42.730
> 
> 标签：macos, spotlight, macfuse

Spotlight 在文件级别进行索引，因此可能需要将包含复杂数据结构的文件拆分为一组文件，以便 Spotlight 以有用的方式对其进行索引。

你可以使用 MacFUSE 更动态地实现这一点吗？

Spotlight 会索引 MacFUSE 卷吗？

MacFUSE 可以处理必要的每个文件的元数据吗？

MacFUSE 进程能否在文件属性更改时通知 Spotlight？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-25T16:17:16.533

我自己一直在测试这个。

我在 MacFuse Wiki 上找到了这个：( [http://code.google.com/p/macfuse/wiki/OPTIONS](http://code.google.com/p/macfuse/wiki/OPTIONS) ) 如果你想在 MacFUSE 卷上使用 Spotlight，你需要使用 allow_other。

我发现它也适用于allow_root。

但是，我必须通过在 /Volume 上使用 mdutil -i 来启用自己的索引（正如 codelogic 已经提到的）

因此，如果它不起作用，请尝试 allow_root 或 allow_other

更多测试： Allow_root 不起作用。它可以索引一次，但似乎没有索引子文件夹中新创建的文件。当更改为 allow_other 时，似乎聚光灯可以检测到新的更改，并索引新文件。==> allow_other 是一个要求

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-25T21:35:19.470

您可以使用[mdutil](http://developer.apple.com/DOCUMENTATION/Darwin/Reference/ManPages/man1/mdutil.1.html)命令启用对外部卷的索引。它也应该适用于 MacFUSE 卷。

```
sudo mdutil -i on /Volumes/SomeVolume 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-25T22:34:16.480

> 因此，可能需要将包含复杂数据结构的文件拆分为一组文件，以便 Spotlight 以有用的方式对其进行索引。

如果你想索引一个自定义文件，你需要编写自己的 Spotlight 索引器来理解这个文件类型——XCode 有一个模板。

# delphi - delphi应用程序中的背景音乐

> ID：393194
> 
> 赞同：3
> 
> 时间：2008-12-25T21:16:26.607
> 
> 标签：delphi, background

关于如何制作它的任何想法？我认为 Delphi 的背景音乐组件是一个很好的选择，但是该死的，我在任何地方都找不到下载，甚至是试用版.. 主页已关闭，所有下载站点都使用原始下载链接（主页）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-25T21:57:43.123

您可以创建一个线程并使用 windows 媒体播放器界面播放。

或者

您可以将 MP3 添加为资源并使用音频实验室等组件进行播放，要在后台执行此操作，您可以创建一个线程。

[http://www.mitov.com/html/audiolab.html](http://www.mitov.com/html/audiolab.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T04:42:02.947

媒体播放器完成了这项工作。但是，有些旧机器没有安装它，你永远不知道会出现什么版本，所以你不知道它是否可以在任何地方工作。

如果你只是想玩一个芯片，你可能想试试 BassMod。它播放 XM、IT、S3M、MOD、MTM 和 UMX，并有一个示例 Delphi 项目。

BassMod 页面：[http ://www.un4seen.com/bassmod.html](http://www.un4seen.com/bassmod.html)

BassMod 下载：[http ://www.un4seen.com/download.php?bassmod20](http://www.un4seen.com/download.php?bassmod20)

* * *

还有一个组件似乎包含了完整的低音音频库。我还没用过这个，但这个演示看起来很酷：它是一个加载 Winamp 插件（可视化、输入、dsp）并具有均衡器、回声和混响的 delphi 应用程序。它可以播放 AAC、MP1、MP2、MP3、Ogg Vorbis、AIFF、WMA。

TBASSPlayer 201 下载：[http ://www.torry.net/vcl/mmedia/audio/TBASSPlayer201.zip](http://www.torry.net/vcl/mmedia/audio/TBASSPlayer201.zip)

我现在要去玩这个了.. :)

哦，你确实需要外部 dll，而且你仍然需要检查如何从嵌入式资源中播放某些东西。在最坏的情况下，你可以在播放之前提取你的东西。

# php - 在 PHP 的扩展类中使用父变量

> ID：393204
> 
> 赞同：6
> 
> 时间：2008-12-25T21:37:42.150
> 
> 标签：php, class, object, extends

我有 2 个课程，主要课程和扩展课程。我需要在扩展类中使用主变量。

```
<?php
class Main {
  public $vars = array();
}

$main = new Main;

$main->vars['key'] = 'value';

class Extended extends Main { }

$other = new Extended;

var_dump($other->vars);

?> 
```

我谁能做到？

无效例如：

```
<?php
class Extended extends Main {
  function __construct ($main) {
    foreach ($main as $k => $v) {
      $this->$k = $v;
    }
  }
}
?> 
```

我需要一些更透明和更有效的解决方案:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-03-02T12:46:41.333

使用简单的构造函数很容易

```
<?php

class One {

    public static $string = "HELLO";

}

class Two extends One {

    function __construct()
    {
        parent::$string = "WORLD";
        $this->string = parent::$string;
    }

}

$class = new Two;
echo $class->string; // WORLD

?> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-25T21:46:57.513

**编辑：这可以通过***控制反转*（IoC）和*依赖注入*（DI）更好地解决。如果您使用自己的框架或没有*依赖注入容器*的框架，请尝试[League/Container](http://container.thephpleague.com/)

左下方的答案是愚蠢答案的历史。

* * *

我想的正确方法。

```
<?php
class Config {
    protected $_vars = array();

    protected static $_instance;

    private function __construct() {}

    public static function getInstance()
    {
        if (!isset(self::$_instance)) {
            self::$_instance = new self();
        }
        return self::$_instance;
    }

    public function &__get($name) {
        return $this->_vars[$name];
    }

    public function __set ($name, $value) {
        $this->_vars[$name] = $value;
    }
}

$config = Config::getInstance();
$config->db = array('localhost', 'root', '');
$config->templates = array(
    'main' => 'main',
    'news' => 'news_list'
);

class DB {
    public $db;

    public function __construct($db)
    {
        $this->db = $db;
    }

    public function connect()
    {
        mysql_connect($this->db[0], $this->db[1], $this->db[2]);
    }
}

$config = Config::getInstance();
$db = new DB($config->db);
$db->connect();

class Templates {
    public $templates;

    public function __construct($templates)
    {
        $this->templates = $templates;
    }

    public function load ($where) {
        return $this->templates[$where];
    }
}

$config = Config::getInstance();
$templates = new Templates($config->templates);
echo $templates->load('main') . "\n"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-06T11:58:27.057

我意识到这是超级旧的，但万一其他人需要线索......

您是否考虑过使用静态变量？

PHP OOP 设计模式使得*父类中静态声明的变量在**子*类中也保持不变。

例如...

```
<?php
class A {
    public static $test = 'a';

    public function test() {
        echo 'Test is: '.self::$test;
    }

}
class B extends A {
    public static $test = 'b';
}
$obj = new B;
$obj->test();
?> 
```

运行这段代码（在 PHP 5.3 上——我相信其他版本也一样）会给你以下结果：

***测试是：a***

根据我在您的 OP 中收集到的信息，您正在寻找一种保留*父类变量*的方法——即使在扩展类中也是如此。这解决了这个问题。

要在类范围之外公开调用变量（即通常编写*$obj->vars*的地方），您需要在父类中创建一个引用的函数，`self::$variable_name`以便它可以将该变量返回给代码它利用该类或任何其他扩展它的类。

例如，类似：

```
public function get_variable() {
    return self::$variable;
} 
```

您还可以创建一个魔术方法，该方法会根据您向实例询问的内容动态地返回 self::$variable - 即方法或变量。在任何情况下，您都可以连接代码以返回 self::$variable 等效项。

阅读[http://php.net/manual/en/language.oop5.magic.php](http://php.net/manual/en/language.oop5.magic.php)以获取有关允许您执行此类操作的各种魔术方法的更多信息。

OP 有点神秘，所以我不确定这是否正是你想要的，但我没有看到这里有其他人引用静态变量，所以我想我会插话 - 希望它有帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-25T23:14:20.783

我认为你需要更清楚你想要什么。想象一下，您有几个 Main 和 Extended 实例。它们是否应该都引用相同的数据，以便如果您更改其中任何一个中的数据，它们都会受到影响？

如果是这样，那么一种方法是使用静态变量，它与类而不是单个实例相关联。另一种方法是创建一个单独的对象（属于不同的类）来存储您的数据，并在创建它们时将其传递给 Main 和 Extended 类。他们每个人都可以存储对它的引用，例如：

```
class Main {
   public $data;
   function __construct(Data $data) {
     $this->data = $data;
   }
}
class Extended extends Main {}

$ourData = new Data();
$ourData->vars = array(1,2,3);

$main = new Main($ourData);
$other = new Extended($ourData); 
```

如果不是，那么您需要数据的副本，而不是对相同数据的引用。在这种情况下，您的第二个示例更接近，尽管我不会盲目地复制所有成员。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-25T23:41:07.860

哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦哦

你要这个：

```
class Config
{
    private $m_vars = array();

    function __get($name)
    {
        return $this->m_vars[$name];
    }

    function & __set($name, $value) // << the & is important!
    {
        $this->m_vars[$name] = $value;
    }
}

class Db
{
    funciton __construct(Config $config)
    {
        $this->Connect($config->host, $config->user, $config->pass, $config->db);
    }
}

$config = new Config();
$config->host = "localhost";
...
$db = new Db($config); 
```

:)

编辑：

另外，您可以这样做：

```
class Templator
{
    private $m_config = null;
    function __construct($config)
    {
        $this->m_config = $config;
    }

    function PrintTemplate($name)
    {
        echo file_get_contents($this->m_config->template_path . $name);
    }

}

$config->template_path = "./templates/";
$temp = new Templator($config);
$temp->PrintTemplate("index.html"); 
```

# c - 清理代码的最佳命令行工具是什么？

> ID：393208
> 
> 赞同：33
> 
> 时间：2008-12-25T21:48:23.610
> 
> 标签：c

当我编写 C 代码时，我只使用编辑器和 gcc。我想知道是否有人可以提出一个好的简单工具来查找未使用的变量、函数声明并可能进行一些优化。

有人知道一个好工具吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-26T00:35:30.747

正如 Dan Fego 所指出的，GCC 可以捕获未使用的变量和未使用的静态函数。它通常不会找到未使用的外部函数，因为它通常一次只处理一个源文件。

GCC (v4.3.2) 有数百个甚至数千个选项。一个可能有帮助的方法是 ' `--combine`' 来组合源文件（只要您不习惯将相同的函数或变量名放在不同的源文件中）。

选项“ `--help`”告诉你更多；选项 ' `--help=optimizers`' 和 ' `--help=warnings`' 每个都给你几百行输出。警告包括：

```
-Wunused                    This switch lacks documentation
-Wunused-function           Warn when a function is unused
-Wunused-label              This switch lacks documentation
-Wunused-macros             Warn about macros defined in the main file that
                            are not used
-Wunused-parameter          Warn when a function parameter is unused
-Wunused-value              Warn when an expression value is unused
-Wunused-variable           Warn when a variable is unused 
```

* * *

*补充*：这是一个脚本`glint`，我用它来清理我的代码。它已经很老了，所以第一行没有使用' `#!/bin/sh`'符号，而是说' `$*`'而不是' `"$@"`'，两者都应该修复，但都不需要紧急修复。请注意，即使 GCC 4.x 不再支持 ' `-fwriteable-strings`' 选项，它仍然支持 ' `-Wwrite-strings`' 选项并且具有价值。

该脚本演示了您只需少量工作即可从现有工具中获得大量收益。您几乎可以配置它使用的每个选项——尽管主要是通过环境而不是命令行。当然，您可以在命令行中添加额外的警告选项；你不能做的是删除预先确定的选项，除了通过环境。但这没关系；默认情况下选择它们是有充分理由的。这些天来，我可能会设置 ' `GLINT_ANSI=-std=c99`' 或修复脚本；我最近没有使用它，因为我的代码非常接近`glint`强制执行的标准。（请注意，“ `-o /dev/null`”表示您一次只能执行一个文件；黑客修复！）

```
:   "@(#)$Id: glint.sh,v 1.5 2002/08/09 21:40:52 jleffler Exp jleffler $"
#
#   Use GCC as excruciatingly pedantic lint
#   Not a complete replacement for lint -- it doesn't do inter-file checking.
#   Now configurable via the environment.
#   Use GLINT_EXTRA_FLAGS to set extra flags via the environment.
#   NB: much Solaris code won't work with -undef enabled.

: ${GLINT_GCC:='gcc'}

: ${GLINT_ANSI='-ansi'}
: ${GLINT_FNO_COMMON='-fno-common'}
: ${GLINT_FSHORT_ENUMS='-fshort-enums'}
: ${GLINT_PEDANTIC='-pedantic'}
: ${GLINT_UNDEF='-undef'}
: ${GLINT_W='-W'}
: ${GLINT_WAGGREGATE_RETURN='-Waggregate-return'}
: ${GLINT_WALL='-Wall'}
: ${GLINT_WCAST_ALIGN='-Wcast-align'}
: ${GLINT_WCAST_QUAL='-Wcast-qual'}
: ${GLINT_WCONVERSION='-Wconversion'}
: ${GLINT_WMISSING_DECLARATIONS='-Wmissing-declarations'}
: ${GLINT_WREDUNDANT_DECLS='-Wredundant-decls'}
: ${GLINT_WMISSING_PROTOTYPES='-Wmissing-prototypes'}
: ${GLINT_WNESTED_EXTERNS='-Wnested-externs'}
: ${GLINT_WPOINTER_ARITH='-Wpointer-arith'}
: ${GLINT_WSHADOW='-Wshadow'}
: ${GLINT_WSTRICT_PROTOTYPES='-Wstrict-prototypes'}
: # ${GLINT_WTRADITIONAL='-Wtraditional'}
: ${GLINT_WWRITE_STRINGS='-Wwrite-strings'}

exec ${GLINT_GCC} \
    ${GLINT_ANSI} \
    ${GLINT_FNO_COMMON} \
    ${GLINT_FSHORT_ENUMS} \
    ${GLINT_PEDANTIC} \
    ${GLINT_UNDEF} \
    ${GLINT_WAGGREGATE_RETURN} \
    ${GLINT_WALL} \
    ${GLINT_WCAST_ALIGN} \
    ${GLINT_WCAST_QUAL} \
    ${GLINT_WCONVERSION} \
    ${GLINT_WMISSING_DECLARATIONS} \
    ${GLINT_WREDUNDANT_DECLS} \
    ${GLINT_WMISSING_PROTOTYPES} \
    ${GLINT_WNESTED_EXTERNS} \
    ${GLINT_WPOINTER_ARITH} \
    ${GLINT_WSHADOW} \
    ${GLINT_WSTRICT_PROTOTYPES} \
    ${GLINT_WTRADITIONAL} \
    ${GLINT_WWRITE_STRINGS} \
    ${GLINT_W} \
    ${GLINT_EXTRA_FLAGS} \
    -o /dev/null -O4 -g -c $* 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-25T22:13:43.323

[Lint](http://en.wikipedia.org/wiki/Lint_programming_tool)是检查 C 程序样式的经典工具。它有更现代的化身，称为[夹板。](http://en.wikipedia.org/wiki/Splint_(programming_tool)) [这个 Wikipedia 条目](http://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis#C)有一个静态代码分析工具列表，有些是免费的，有些是商业的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-05T12:09:10.827

尽管我确信这不是*静态代码分析*工具的完整列表，但这里是我对过去使用过的一些不同工具的印象。（我主要与 C 一起工作。）

1.  [Splint](http://www.splint.org/ "夹板")：我经常使用 Splint，因为它可用于许多 GNU/Linux 发行版。它相对容易使用；但是，在最严格的环境下运行时，它往往会变得不堪重负。此外，有时需要使用注解会使易于阅读的代码变得混乱和混淆。无论如何，我建议使用它。

2.  [Uno](http://spinroot.com/uno/ "宇野")：Uno 绝对是一个很有前途的，但它不像 Splint 那样严谨（通过设计）。相反，它侧重于其警告的清晰性和实用性。对我来说，Uno 仅作为 Splint 的补充有用（清楚地指出隐藏在 Splint 发出的相对较多的警告中）。

3.  [PC-lint](http://www.gimpel.com/html/pcl.htm "PC棉绒")：我发现 PC-lint 对于专有程序来说很笨拙。我曾经在为 MS-DOS 开发时使用过它，它用于错误的神秘名称使其非常难以使用。据我所知，在 MS-DOS 上可以使用许多更好的产品。

4.  [Pscan](http://www.striker.ottawa.on.ca/~aland/pscan/ "扫描")：（死链接）Pscan 非常适合查找格式字符串漏洞！与 Uno 一样，我建议将其用作 Splint 的补充。

如果您不使用 C，您可能还想查看：[维基百科 - 静态代码分析工具列表](http://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis "维基百科 - 静态代码分析工具列表")、[检查/审查工具、源代码/二进制代码静态分析器](http://www.laatuk.com/tools/review_tools.html "检查/审查工具、源代码/二进制代码静态分析器")和[源代码安全分析器](https://samate.nist.gov/index.php/Source_Code_Analyzers "源代码安全分析器")。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-25T21:53:59.293

如果您使用 -Wall 运行 gcc，它会捕获您提到的一些内容，例如未使用的变量（可能还有未使用的函数）。在优化方面，我不知道，尽管总的来说编译器足够聪明，可以进行重要的优化，所以我不会太担心。只是不要使用可怕的算法。;-)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-26T02:01:26.140

夹板（[http://www.splint.org/](http://www.splint.org/)）非常好；我在兆行代码上使用它来寻找这种东西，

（更新：每个人都想成为艺术总监。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T20:42:29.963

如何使用分析器并找到运行最多的代码，并专注于这些部分。

也许 gprof 可以帮忙？

/约翰

编辑：或者既然您谈到了清理，请颠倒我上面的答案并删除永远不会执行的代码。

# html - 为什么 HTML id 不像命名空间那样工作？

> ID：393212
> 
> 赞同：2
> 
> 时间：2008-12-25T21:51:10.467
> 
> 标签：html

对我来说，HTML 支持这一点似乎很自然：

```
<div id="comment1">
    <div id="helpText">...</div>
</div>

<div id="comment2">
    <div id="helpText">...</div>
</div>

<div id="comment3">
    <div id="helpText">...</div>
</div>

#comment1#helpText
#comment2#helpText
#comment3#helpText 
```

但由于 HTML id 必须是唯一的，我需要这样做：

```
<div id="comment1">
    <div id="helpText1">...</div>
</div>

<div id="comment2">
    <div id="helpText2">...</div>
</div>

<div id="comment3">
    <div id="helpText3">...</div>
</div>

#comment1#helpText1
#comment2#helpText2
#comment3#helpText3 
```

这似乎是不必要的多余，尤其是当我有多个嵌套的 DIV 时：

```
<div id="comment1">
    <div id="header1">...</div>
    <div id="introduction1">...</div>
    <div id="helpText1">...</div>
    <div id="footer1">...</div>
</div>

<div id="comment2">
    <div id="header2">...</div>
    <div id="introduction2">...</div>
    <div id="helpText2">...</div>
    <div id="footer2">...</div>
</div>

<div id="comment3">
    <div id="header3">...</div>
    <div id="introduction3">...</div>
    <div id="helpText3">...</div>
    <div id="footer3">...</div>
</div> 
```

谁能给我一些关于为什么会这样的背景，也许还有一些解决方法可以让 HTML id 更多地按照命名空间隐喻的方式工作？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-25T21:56:36.307

使用`class`.

An`id`标识该元素并且仅标识该元素。它就像 C++ 中指向对象的指针。没有 an 的元素`id`就像没有命名 (?) 指针的对象。

`Class`es 就像属性。元素可以有零个或多个`class`es 的任意组合。他们给你你想要的。

```
/* CSS */
#comment1 .header
#comment3 .helpText

<!-- (X)HTML -->
<div id="comment1">
    <div class="header">...</div>
    <div class="introduction">...</div>
    <div class="helpText">...</div>
    <div class="footer">...</div>
</div> 
```

DOM 本身并没有很好的 Javascript（和其他脚本语言）选择器，但是像 JQuery 这样的工具包允许您很好地按类名选择元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-25T21:56:41.737

在第一个示例中，您可以使用：

```
#comment1 .helpText
#comment2 .helpText
#comment3 .helpText 
```

您不必为 helpText 元素定义一个 id，而是一个带有`class="helpText"`.

您还可以使用以下规则操作所有子 div：

```
#comment1 div
#comment2 div
#comment3 div 
```

如果您想操作“评论”节点的所有子节点，您可以添加`class="comment"`到这些评论 div 并使用

```
div.comment 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-26T00:19:32.383

你可能真的想问一个问题，“为什么我们需要 CSS 中的 ID？” -- 如果一个类可以是唯一的或非唯一的，为什么我们需要另一种必须唯一的标识符？

我的回答是，我们实际上在 CSS 中并不需要它们，但在 DOM 中用于其他目的需要它们。例如，`<label>`元素可以使用该元素的唯一 ID 来识别它正在标记的其他元素。

如果它们要在 DOM 中存在，我们需要在 CSS 中访问它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-25T21:55:53.673

使用类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-25T21:59:02.277

什么stesch说。像这样：

```
 <div id="comment1">
    <div class="helpText">...</div>
</div>

<div id="comment2">
    <div class="helpText">...</div>
</div>

<div id="comment3">
    <div class="helpText">...</div>
</div> 
```

进而：

```
#comment1.helpText
#comment2.helpText
#comment3.helpText 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-25T22:07:52.820

正如 strager 所写：使用类。

请记住，一个元素可以同时属于多个类：

```
<div id="comment1">
    <div class="header introduction">...</div>
    <div class="introduction">...</div>
    <div class="footer introduction somethingelse">...</div>
</div> 
```

# bug-tracking - 单独开发人员设置的工具？

> ID：393223
> 
> 赞同：8
> 
> 时间：2008-12-25T22:00:20.683
> 
> 标签：bug-tracking, project-planning

我是一个孤独的开发人员，想为我的项目建立一些结构。我的硬件设置是一台运行 Windows XP 的笔记本电脑和一台运行 Ubuntu 的台式机，用作存储服务器。

我目前使用 Mercurial 作为我的源代码控制系统，并将存储库的工作副本存储在我的笔记本电脑上，并每隔几天将存储库克隆到 Ubuntu 机器作为备份。

对于单独的开发人员，您会推荐哪些其他工具来执行错误跟踪、项目规划等工作？我正在寻找一些简单的东西，要么必须在 Windows 上运行，要么作为 Apache 上的 Web 应用程序运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-25T22:03:41.737

我喜欢[Redmine](http://redmine.org)。它支持多个 SCM 系统，并提供了很多不错的功能 :) 它是一个 RoR 应用程序，在 ubuntu 中很容易设置，

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-26T00:10:03.557

我是我的最后一份工作，我们是[Trac](http://trac.edgewall.org/)的粉丝。它有一个错误跟踪器和一个完全集成的文档 wiki，您可以通过 wiki 系统中的 id 和错误系统中的 wiki 页面引用错误。它可以在各种 Linux 发行版、Mac OS X、FreeBSD、NetBSD 和 MS Windows 上运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-25T22:05:13.700

[Mantis 错误跟踪](http://www.mantisbt.org/)很有趣，您可以轻松自定义[工作流程。](http://manual.mantisbt.org/manual.customizing.mantis.customizing.status.values.php)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-25T23:49:27.657

[请求跟踪器](http://bestpractical.com/rt)是我个人的最爱。也有一本关于它的 O'Reilly 书。

我认为您还需要一个 wiki，您需要 MediaWiki。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-25T22:32:24.190

[试试](http://www.fogcreek.com/FogBugz/)FogBuz 。它有很多功能，最多可供两个开发人员免费使用。像[Freemind](http://freemind.sourceforge.net/wiki/index.php/Main_Page)这样的思维导图软件也很适合头脑风暴。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-25T22:37:00.547

我也是一只独狼，对于项目管理 + 错误跟踪 + 待办事项，我使用[todolist](http://www.abstractspoon.com/)。这很棒。小，支持很多东西，简单好用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-25T22:28:42.607

我使用一个简单的基于行的日志，我可以在其中记录任务、错误和子任务。我按时间顺序显示它们，并且可以将事情标记为已完成。它已集成到我的 IDE (Eclipse) 中，因此我可以直接将行项目与特定行或源位相关联。

我知道有些人使用 Mylyn（通过 Eclipse）与错误报告系统进行单独交互。

不要误会我的意思，正确的问题跟踪对于协作项目至关重要，但对于许多较小的项目，它有时可能是一个显着的矫枉过正。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-26T00:26:55.397

您可能想查看[Axosoft 的 OnTime](http://axosoft.com/products/ontime.aspx)。我们使用付费版本，但单用户安装是[免费](http://axosoft.com/products/ontime.aspx?cn=otm_pricing)的！它是一个完整的需求管理、错误跟踪、wiki 托管、支持工单跟踪系统和许多其他功能。我们已经在生产中使用它一年了，我们跟踪其中的所有内容。

它在 Windows 上运行，您可以使用免费的 MS-SQL Express（我相信）。我认为对于一个单独的程序员来说，这为您提供了很多功能，并且易于安装和管理。祝你好运！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-10T19:48:44.213

Try [Mylyn](http://eclipse.org/mylyn) or [Tasktop](http://tasktop.com) for accessing your bug tracker and managing your issues/tasks. If you've set up a compatible bug/issue tracker, you can access it on your desktop via Tasktop to streamline your workflow. If you haven't set up an issue tracker, you can use local tasks to track your work.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-02-24T15:01:51.353

I'd suggest you take a look at using virtual machines. I don't know Ubuntu, but I'd imagine you should be able to setup VirtualBox on it easily enough.

I've found creating VMs not only simpilifies the work that I have to do (testing a new release? Just roll the VM back to a 'clean' state and get started on your install..), but also makes testing different install scenarios much cleaner. (ie, supporting different databases, web servers etc..)

# javascript - 如何使用 jQuery 处理 JSON 编码的字符串

> ID：393224
> 
> 赞同：3
> 
> 时间：2008-12-25T22:02:16.123
> 
> 标签：javascript, jquery, django, json

我目前正在使用 Django 构建使用 jQuery.getJSON() 检索的 JSON 编码对象。标准的 simplejson 编码器根据 JSON [“标准”](http://www.json.org)对字符串进行编码，即任何包含 '/' 的字符串都被转换为 '/'。因此，如果我的参数之一是 url，例如[http://example.com/image.jpg](http://example.com/image.jpg)，它将作为 http://example.com/image.jpg 传递给客户端。JQuery 不会解码这些字符串（它会直接进行 eval），因此我尝试将 url 作为 src 属性用于它不起作用的图像。在 JavaScript 中处理“JSON 转义”的字符串（例如 url）的最佳方法是什么？

**更新：**代码中的其他地方有一个错误，jQuery.getJSON() 进行了正确的转义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-25T22:19:42.237

看起来[JSON.parse](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)会做到这一点。

# ruby - Ruby 亚马逊图书搜索

> ID：393234
> 
> 赞同：6
> 
> 时间：2008-12-25T22:19:39.990
> 
> 标签：ruby, amazon-product-api

有没有人有一个很好的 Ruby 脚本来使用他们的 API 在亚马逊上查找书籍（或其他产品）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-26T22:38:34.363

我一直在使用[Amazon/ECS](http://www.pluitsolutions.com/projects/amazon-ecs)并取得了巨大的成功。重要的一点是它不是 GPL 的（而 Ruby/AWS 似乎是），所以如果它对你的情况很重要，请小心。

这是一个示例：

```
require 'amazon/ecs'

# default options; will be camelized and converted 
# to REST request parameters.
Amazon::Ecs.options = {:aWS_access_key_id => [your access key]}
res = Amazon::Ecs.item_search('ruby') 
```

您可能还想查看一些与 Mephisto 博客系统[集成的示例。](http://github.com/thbar/mephisto_amazon/tree/master)

干杯！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-25T22:33:40.350

我想这种脚本必须使用[Ruby/AWS](http://www.caliban.org/ruby/ruby-aws/)，比如这个[test](http://www.semanticpool.de/ruby-awss3-tests/)。

你在这里有一个[快速的介绍](http://clarkware.com/cgi/blosxom/2007/02/01)。

你有一个涉及搜索书籍的[完整示例。](http://www.ddj.com/showArticle.jhtml?articleID=184405959)

```
response = r.keyword_search
('ruby programming', 'books') 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-26T22:31:48.870

VonC 的第三个链接是部分答案。它让我找到了 ruby​​-aaws（注意 - 与 ruby​​-aws 不同）。

然后我找到了这篇[博客文章](http://www.somelifeblog.com/2008/12/ruby-amazon-associates-web-services-aws.html)，其中有一个使用它的例子。

# c++ - 读\写 boost::binary_oarchive 到管道

> ID：393241
> 
> 赞同：0
> 
> 时间：2008-12-25T22:26:07.107
> 
> 标签：c++, windows, visual-studio-2005, boost, pipe

我将继续构建两个简单的进程，通过简单的（匿名）管道将类对象相互投掷（参见我的上一篇文章）。现在我为自己揭示了 boost::serialization （感谢回答的人），并试图通过 ::WriteFile::ReadFile 对某些类进行序列化。所以 - 我做错了什么？

* * *

1）我创建了一些类

```
 #pragma once
 #include "wtypes.h"
 #include <boost\archive\binary_oarchive.hpp>
 #include <boost\archive\binary_iarchive.hpp>
 #include <boost\serialization\binary_object.hpp>

 class CTextContainer
 {
 friend class boost::serialization::access;
     template<class Archive>
     void serialize(Archive & ar, const unsigned int version)
     {
         ar & m_sText;
         ar & m_dwCRC;
         ar & m_dwSize;
     }

 public:
      CTextContainer() : m_dwCRC(0), m_dwSize(0)
      {
          ZeroMemory(m_sText, sizeof(m_sText));
          m_dwSize = sizeof(*this);
      }
      CTextContainer(LPCTSTR sText) : m_dwCRC(0), m_dwSize(0)
      {
         ZeroMemory(m_sText, sizeof(m_sText));
         wcsncpy_s(m_sText, 1024, sText, wcslen(sText));
         m_dwSize = sizeof(*this);
      }
      virtual ~CTextContainer(){}
      LPTSTR GetText() const{return (LPTSTR) m_sText;}
      protected:
      DWORD m_dwCRC;
      DWORD m_dwSize;
      TCHAR m_sText[1024];
 }; //end of class 
```

2）现在我正试图从这个类中读取二进制存档并将其内容写入管道的一端......

```
boost::archive::binary_oarchive oa(ofs);
oa << tc;
::WriteFile(hPipe, &oa, dwRead, &dwWritten, NULL) == FALSE 
```

它不会那样工作，对吧？那么，会如何呢？

3) 另一边的操作相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T15:03:07.193

我认为这里的问题是您正在尝试将指针传递给 WriteFile 函数中的存档对象。你应该做的是提供一个指向序列化数据的指针。

```
std::stringstream ss;
boost::archive::binary_oarchive oa(ss);
oa << tc;
::WriteFile(hPipe, ss.str().data(), ss.str().data().size(), &dwWritten, NULL) 
```

作为更好的选择，您应该为 binary_oarchive 构造函数提供一个直接写入文件句柄的 ostream 实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-09T15:11:25.193

假设您为 dwRead 传递了正确的值，我认为问题在于流尚未被刷新。确保在块内创建 binary_oarchive，这样当它超出范围时，它的析构函数会刷新流。

```
std::ofstream ofs("filename");
{
    boost:archive::binary_oarchive oa(ofs);
    oa << tc;
}

// Set up your pipe and assign a value to dwRead
// ...

::WriteFile(hPipe, &oa, dwRead, &dwWritten, NULL); 
```

# c - 计算文本文件中单词的出现次数

> ID：393248
> 
> 赞同：5
> 
> 时间：2008-12-25T22:34:51.783
> 
> 标签：c, algorithm, nlp, counting

我怎样才能跟踪一个单词在文本文件中出现的次数？我想对每个单词都这样做。

例如，如果输入是这样的：

“那个男人跟那个男孩打招呼。”

每个“man said hi to boy”都会出现 1 次。

"the" 的出现次数为 2。

我正在考虑保留带有单词/出现对的字典，但我不确定如何在 C 中实现这一点。与解决方案的任何类似或相关问题的链接都会很棒。

* * *

编辑：为了避免推出我自己的哈希表，我决定学习如何使用 glib。一路上，我发现了一个很好的教程，它解决了类似的问题。[http://bo.majewski.name/bluear/gnu/GLib/ch03s03.html](http://bo.majewski.name/bluear/gnu/GLib/ch03s03.html)

我对不同方法的数量感到震惊，尤其是 Ruby 实现的简单性和优雅性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-25T22:49:59.913

是的，具有单词出现对的字典可以正常工作，实现这种字典的通常方法是使用哈希表（或者，有时，二叉搜索树）。

您还可以使用复杂性对于这个问题渐近最优的[trie](http://en.wikipedia.org/wiki/Trie)（或其压缩版本，[“Patricia trie”](http://en.wikipedia.org/wiki/Radix_tree) /Radix trie），尽管我怀疑在实践中它可能比（好的）哈希表实现慢。

[我真的认为哈希表或尝试是否更好取决于输入中单词的分布-例如，哈希表需要将每个单词存储在其哈希桶中（以防止冲突），而如果您有很多具有公共前缀的单词，在 trie 中，这些公共前缀是共享的，并且每个只需要存储一次，但仍然存在所有指针的开销......如果你碰巧同时尝试了这两个，我很想知道如何他们比较。]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-26T00:23:33.157

出于好奇，这里有一个简单的 Ruby 解决字数问题的方法。它应该与 C 中的算法基本相同，只是代码更多。

```
h = Hash.new(0)
File.read("filename.txt").split.each do |w|
  h[w] += 1
end
p h 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-26T00:24:15.883

这算不算？

```
#include <stdio.h>
#include <stdlib.h>
int main(int argc, char **argv)
{
    char buffer[2048];
    if (argc != 2)
    {
        fprintf(stderr, "Usage: %s file\n", argv[0]);
        exit(EXIT_FAILURE);
    }
    snprintf(buffer, sizeof(buffer), "tr -cs '[a-z][A-Z]' '[\\n*]' < %s |"
                                     " sort | uniq -c | sort -n", argv[1]);
    return(system(buffer));
} 
```

它基本上封装了说明如何在 Unix 上将单词计数为 shell 脚本的规范脚本。

' `tr`' 命令将任何非字母字符转换为换行符并挤出重复项。第一个 ' `sort`' 将每个单词的所有出现组合在一起。' `uniq -c`' 计算每个单词的连续出现次数，打印单词及其计数。第二个 ' `sort`' 将它们按重复次数增加的顺序排列。您可能需要选择 ' `tr`'; 它不是从系统到系统的最稳定的命令，它设法让我经常进行手动抨击。在使用 /usr/bin/tr 的 Solaris 10 上，上面的代码产生（在它自己的源代码上）：

```
 1
   1 A
   1 EXIT
   1 FAILURE
   1 Usage
   1 Z
   1 a
   1 c
   1 cs
   1 exit
   1 file
   1 fprintf
   1 if
   1 main
   1 return
   1 sizeof
   1 snprintf
   1 stderr
   1 stdio
   1 stdlib
   1 system
   1 tr
   1 uniq
   1 z
   2 argc
   2 char
   2 h
   2 include
   2 int
   2 s
   2 sort
   3 argv
   3 n
   4 buffer 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-25T22:37:30.297

您可以使用哈希表，并让哈希表中的每个条目都指向一个结构，该结构包含该单词和到目前为止已找到的次数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-26T09:50:27.990

对于单个单词，根本不需要编写程序，除非这是更大的一部分：

```
sed -e 's/[[:space:]]/\n/g' < file.txt | grep -c WORD 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T15:47:35.010

在 Perl 中：

```
my %wordcount = ();
while(<>){map {$wordcount{$_}++} (split /\s+/)}
print "$_ = $wordcount{$_}\n" foreach sort keys %wordcount; 
```

在 Perl Golf 中（只是为了好玩）：

```
my%w;                       
map{$w{$_}++}split/\s+/while(<>); 
print"$_=$w{$_}\n"foreach keys%w; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-25T22:52:03.013

**警告**未经测试的代码：

```
#include <stdio.h>

struct LLNode
{
    LLNode* Next;    
    char*   Word;
    int     Count;
};

void PushWord(LLNode** list, const char* word)
{
    LLNode* node = NULL;
    unsigned int len = 0;
    if (*list == NULL) 
    {
        $list = new LLNode;
        $list = "\0";
    }
    node = *list;
    while ((node = node->Next) != NULL) // yes we are skipping the first node
    {
        if (!strcmp(node->Word, word))
        {
            node->Count++;
            break;
        }

        if (!node->Next)
        {
            LLNode* nnode = new LLNode;
            nnode->Count = 1;
            node->Next = nnode;
            len = strlen(word);
            node->Word = new char[len + 1];
            strcpy(node->Word, word);
            break;
        }
    }
}

void GetCounts(LLNode* list)
{
    if (!list)
        return;
    LLNode* node = list;
    while ((node = node->Next) != NULL) // yes we are skipping the first node
    {
        printf("Word: %s, Count: %i", node->Word, node->Count);
    }
}

void PushWords(LLNode** list, const char* words)
{
    char ch = '\0';
    unsigned int len = strlen(words);
    char buff[len]; // to be sure we have no buffer ovverunes. May consume too much memery for your application though.
    int index = 0;
    for (unsigned int i = 0; i < len; i++)
    {
        ch = words[i];
        if (index > 0 && ch == ' ')
        {
            ch[index + 1] = '\0';
            PushWords(list, buff);
            index = 0;
        }
        else if (ch != ' ')
        {
            ch[index++] = ch;
        }
    }

    if (index > 0 && ch == ' ')
    {
        ch[index + 1] = '\0';
        PushWords(list, buff);
        index = 0;
    }
}

int main()
{
    LLNode* list = NULL;
    PushWords(&list, "Hello world this is a hello world test bla");
    GetCount(list);
    // release out memery here
} 
```

我刚刚写了这个，所以它可能不会工作 - 但这是一般的想法。

这次用 C++ 编写的另一个草稿（注意：std::map 的搜索时间非常好）：

```
#include <iostream>
#include <string>
#include <map>

using namespace std;

typedef map<string, int> CountMap;

void PushWords(CountMap& list, const char* words)
{
    char ch = '\0';
    unsigned int len = strlen(words);
    string str;
    int index = 0;
    for (unsigned int i = 0; i < len; i++)
    {
        ch = words[i];
        if (index > 0 && ch == ' ')
        {
            list[str] = list[str] + 1;
            index = 0;
        }
        else if (ch != ' ')
        {
            str += ch;
            index++;
        }
    }

    if (index > 0 && ch == ' ')
    {
        list[str] = list[str] + 1;
    }
}

void PrintCount(CountMap& list)
{
    CountMap::iterator iter = list.begin(), end = list.end();
    for (; iter != end; ++iter)
    {
        cout << (*iter).first << " : " << (*iter).second;
    }
}

int main()
{
    CountMap map;
    PushWords(map, "Hello world this is a hello world test bla");
    PrintCount(map);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T15:21:37.600

```
#include <conio.h>
#include <iostream.h>
#include <fstream.h>
#include <cstdlib>

struct stdt
{
       char name[20] ;
       int id ;

}; //std

int main()
{
      stdt boy ;
      int a = 0 ;
      ofstream TextFile ;
      cout << "Begin File Creation \n" ;
      TextFile.open("F:\\C++ Book Chapter Program\\Ch  7\\File.txt" );
      if ( !TextFile)
      {
           cerr <<"Erro 100 Openoing File.DAT" ;
           exit(100);     
      }//end if
      while ( a < 3 )
      {
            TextFile.write( (char*) &boy , sizeof (boy) ) ;
            cout << "\nEnter Name : " ;
            cin  >> boy.name;
            cout << "\nEnter ID : " ;
            cin  >> boy.id ;
            a++;
      }//end while

      TextFile.close();
      cout << "\nEnd File Creation" ;

      ifstream TextFile1 ;
      TextFile1.open("F:\\C++ Book Chapter Program\\Ch  7\\File.txt" );
      while ( TextFile1.read( (char*) &boy , sizeof (boy) ) )
      {
            cout << "\nEnter Name : " << boy.name; 
            cout << "\nEnter ID : " << boy.id ;

      }// end While

      getch();
      return 0 ;
}//end main 
```

# java - 将泛型参数转换为 java 中的 int，前提是它是一个数字

> ID：393252
> 
> 赞同：4
> 
> 时间：2008-12-25T22:40:13.443
> 
> 标签：java, generics

简而言之，这就是我一直在尝试做的事情：

```
class example <T extends Number>
{
    private int function(T number)
    {
        int x = (int) number;
        ...
    }
    ...
} 
```

基本上，我试图让它 T 是一个数字，这样我就可以将它转换为该函数内的 int 。问题是我得到了一个“不可转换的类型”错误，所以我一定做错了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-25T22:47:36.627

考虑到抽象类`Number`是类 * `BigDecimal`、`BigInteger`、 * `Byte`、`Double`、`Float`、 * `Integer`、`Long`和`Short`...的超类

如果你想有一个 int 表示，你应该使用这个`.intValue()`函数。

如果那是你想要做的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-25T23:47:36.770

对于您的示例，我认为您不需要泛型。我认为你可以：

```
private int func(Number n) {
  return n.intValue();
} 
```

如果你想用泛型做一些事情，我现在会把它拿出来，首先让上面的工作正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-25T22:47:02.557

采用

```
x=number.intValue(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-02-20T20:38:32.940

我知道这个问题很老了。仅出于练习目的（不建议在生产中使用），您可以使用包装类 Integer 而不是原始类型 int。

```
int x = (Integer) number; 
```

关键是将泛型类型转换为原始类型会引发错误，诸如 Number、BigInteger 或 Integer 之类的包装类会更有效。

# jquery - jQuery淡入淡出

> ID：393254
> 
> 赞同：2
> 
> 时间：2008-12-25T22:42:07.947
> 
> 标签：jquery

我有三个 div：A、B 和 C。A 当前可见，我希望 B 替换它。我可以通过以下方式轻松做到这一点：

```
$('#A').hide();
$('#B').show(); 
```

但是，这将导致更改非常突然。但是，如果我将“hide”替换为“fadeOut”，将“show”替换为“fadeIn”，那么 A 仍在淡出，而 B 仍在淡入，看起来很混乱。如何让 B 在开始淡入之前等待 A 淡出？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-25T22:49:08.557

fadeOut 可以带一个回调函数，在第一个效果完成后运行：

```
$('#A').fadeOut(function () {
    $('#B').fadeIn();
}); 
```

那应该这样做。

# translation - Poedit 有什么好的替代品？

> ID：393267
> 
> 赞同：51
> 
> 时间：2008-12-25T22:52:04.650
> 
> 标签：translation, gettext, poedit

我正在寻找 .po/.mo 编辑器。我正在使用 gettext 翻译文件，但不太喜欢 Poedit。它必须在 Windows Vista 上运行，如果它内置到 Visual Studio 2008 中会更好，这样我就可以开发和翻译。

我真的想要一些可以帮助我翻译并使翻译更容易的东西。我想要建议和拼写检查。

【没有选择？如果真的没有选择，我还不如做一些事情并编写一些代码，以便再次轻松翻译。您甚至可以集成 http://dict.leo.org 或查看 Google 翻译为查询提供的内容。]

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-12-27T03:45:27.693

[以下是Poedit](http://poedit.net)的一些不错的替代品：

# 翻译编辑

*   [Lokalize](http://userbase.kde.org/Lokalize)：适用于 KDE 用户（[KBabel](http://kbabel.kde.org/)现在已过时）。
*   [GTranslator](http://gtranslator.sourceforge.net/)：适用于 GNOME 用户。
*   [GTed](http://www.gted.org/)[死链接]：在 Eclipse 运行的任何地方运行。
*   [虚拟](https://virtaal.translatehouse.org/)：Windows、Linux、Mac。GNOME 用户的好选择。

# 文本编辑器

*   Vim：可以使用[Vim 脚本对 po 文件进行编辑](http://vim.sourceforge.net/scripts/script.php?script_id=695)
*   Emacs：您可以使用[po 模式](http://www.gnu.org/software/autoconf/manual/gettext/PO-Mode.html#PO-Mode)进行编辑。

# 其他注意事项

有一个 php 应用程序可用于协作编辑。实际上，与颠覆系统同步无论如何都可以使用这些工具中的任何一个来解决问题。但是，如果有人确实记得更多应用程序，请随时添加。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-25T23:06:03.220

[GTed](http://www.gted.org/)是 PoEdit 的一个有趣的替代方案。

![泰达](https://i.stack.imgur.com/2KoLB.gif)

既然是 Eclipse 插件，那么首先假设安装了 eclipse：它不是一个独立的应用程序。但是，它仍然可以完成这项工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-10-09T10:26:07.243

仅供参考：[Google Translator Toolkit](http://translate.google.com/toolkit/)[自 2012 年起](http://google-opensource.blogspot.de/2012/03/localize-your-apps-and-content-more.html)允许翻译 po-Files 。我从来没有真正使用过它。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-13T09:39:14.993

我建议[使用 Virtaal](http://virtaal.org)，它是跨平台的，设置和使用非常简单，但功能非常强大。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-01-28T13:58:28.467

看看[poeditor.com](http://www.poeditor.com)。看起来不错，并且在协作方面可以满足我们的需求。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-01-28T07:18:03.583

我已经与[Transifex](http://www.transifex.net)合作了一段时间。它本身并不是一个很好的编辑器，而是一个协作翻译平台。他们有合理的在线编辑设施。它还允许您将翻译拉下来以在本地使用它们，所以我也很想看到一个好的编辑器。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-05-02T15:29:27.340

在 Windows 上，您可能会考虑使用[Bettter PO Editor](http://sourceforge.net/projects/betterpoeditor/) 或[gorm](http://gorm.po.dk/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-24T15:58:46.363

[LocFactory](http://www.triplespin.com/en/products/locfactoryeditor.html)是另一种选择 - 抱歉，它仅适用于 OSX，但它可能对阅读这篇文章的其他人有用。

不幸的是，我发现 poEdit 是非常糟糕的一群中最好的。我很想找一个替代品。

# c - 带有 recv-timeout 的套接字：这段代码有什么问题？

> ID：393276
> 
> 赞同：10
> 
> 时间：2008-12-25T23:09:42.743
> 
> 标签：c, linux, sockets

我正在尝试实现一个接收超时为 1 秒的套接字：

```
int sockfd;
struct sockaddr_in self;
struct sockaddr_in client_addr;
int addrlen=sizeof(client_addr);
ssize_t nBytes;

sockfd = socket(AF_INET, SOCK_STREAM, 0);

self.sin_family = AF_INET;
self.sin_port = htons(PORT);
self.sin_addr.s_addr = INADDR_ANY;

int on = 1;
setsockopt( sockfd, SOL_SOCKET, SO_REUSEADDR, &on, sizeof(on);

// 1 Sec Timeout
tv.tv_sec  = 1;  
tv.tv_usec = 0;
setsockopt( sockfd, SOL_SOCKET, SO_RCVTIMEO, &tv, sizeof(tv);

bind(sockfd, (struct sockaddr*)&self, sizeof(self));

listen(sockfd, 20);

clientfd = accept(sockfd, (struct sockaddr*)&client_addr, &addrlen);

nBytes = recv(clientfd, buffer, MAXBUF-1, 0); 
```

如果没有 'setsockopt(sockfd, SOL_SOCKET, SO_RCVTIMEO, &tv, sizeof(tv);' 调用接受和接收工作，但接收阻塞。

使用 'setsockopt( sockfd, SOL_SOCKET, SO_RCVTIMEO, &tv, sizeof(tv);' 调用接受会产生错误 '资源暂时不可用'。

有人可以告诉我这种方法有什么问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-25T23:51:18.400

您希望在哪个套接字上设置一秒超时？一个接受连接，还是由`accept()`?

我假设后者 - 所以尝试在退货`clientfd`后设置接收超时。`accept()`你也可以到达你需要使用的地方`select()`，但你不应该这样做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-06-06T14:50:27.540

这有点离题，但我真的很想分享这个解决方案来在 Windows 和 unix 上设置 recv 超时。也许是我，但我花了很多时间才弄清楚为什么我的程序不起作用以及如何正确设置超时。希望你觉得它有用。它将超时设置为 10 秒。

对于 Windows：

```
DWORD sock_timeout = 10*1000; 
```

对于 Unix：

```
const struct timeval sock_timeout={.tv_sec=10, .tv_usec=0}; 
```

对彼此而言：

```
setsockopt(socket, SOL_SOCKET, SO_RCVTIMEO, (char*)&sock_timeout, sizeof(sock_timeout)); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-25T23:35:19.697

这是一个使用的片段`select`：

```
FD_ZERO(&masterfds);
FD_SET(sockfd,&masterfds);
memcpy(&readfds,&masterfds,sizeof(fd_set));
timeout.tv_sec = 2;
timeout.tv_usec = 0;
if (select(sockfd+1, &readfds, NULL, NULL, &timeout) < 0)
{
    printf("select error");
    exit(1);
}

if (FD_ISSET(sockfd, &readfds))
{
    //printf("Read from socket\n");
    // read from the socket
    res = recvfrom(sockfd, (char *)hdrbuf, sizeof(hdrbuf), MSG_PEEK, recvaddr, address_len);
}
else
{
    // the socket timedout
    //printf("Socket timeout started=%d\n",packets_started); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-18T19:47:04.257

没有错...错误代码EAGAIN（资源暂时不可用）正是您在超时到期后应该得到的！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-06T01:23:23.443

You need one more closing parenthesis at each of these two lines.

```
- setsockopt( sockfd, SOL_SOCKET, SO_REUSEADDR, &on, sizeof(on);
+ setsockopt( sockfd, SOL_SOCKET, SO_REUSEADDR, &on, sizeof(on));
- setsockopt( sockfd, SOL_SOCKET, SO_RCVTIMEO, &tv, sizeof(tv);
+ setsockopt( sockfd, SOL_SOCKET, SO_RCVTIMEO, &tv, sizeof(tv)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-25T23:33:39.450

在调用 recv() 或 accept() 之前尝试使用 select()。

select() 接受一个文件描述符数组（包括套接字），并在其中至少一个准备好接收时返回。它也可以在超时时返回。

在 linux 中，您也可以尝试 poll() （不确定 Winsock 是否提供此功能）。

# java - 尝试创建自定义类的通用数组的 Java 转换错误

> ID：393286
> 
> 赞同：0
> 
> 时间：2008-12-25T23:34:24.580
> 
> 标签：java, generics

这就是我想要做的：

```
import java.lang.reflect.*;

class exampleOuter <T extends Number>
{
    private exampleInner<T>[] elements;

    public exampleOuter(Class<T> type, int size)
    {
        elements = (exampleInner<T>[]) Array.newInstance(type, size);
    }
} 
```

有人告诉我，如果我想创建 T 类型的通用数组，我应该使用

```
elements = (T[]) Array.newInstance(type,size); 
```

因此，我尝试将其扩展到我的自定义类并得到一个 ClassCastException (Ljava.lang.Double; cannot be cast to L *mypackagename* .exampleInner; 我在 main 中声明该类，如下所示：

```
exampleOuter<Double> test = new exampleOuter(Double.class,15); 
```

我可以很好地声明内部类，也可以声明不是内部类通用的数组，所以我想它是外部类的构造函数中的东西。有任何想法吗？

编辑：我明白问题是什么。当我创建数组的一个新实例时，我创建了一个双精度数组，而不是 exampleInner。我认为。如果这是正确的，我需要找到一种方法来创建一个 exampleInner 数组，同时将 Double.class 传递给函数。

编辑 2：我意识到泛型数组不是类型安全的，但无论如何我都必须使用它们，因为我的老师要求我们使用它们。

编辑 3：有人告诉我，要使用泛型数组，我必须以这种方式分配它们，为此我需要反射，我想。编译器告诉我该类正在使用不安全或未经检查的操作，但我必须使用泛型数组，这就是我知道的方式。如果有更好的方法，我会更改代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-25T23:59:20.460

这是我想出的解决方案：

```
public exampleOuter(Class<T> type, int size)
{
    innerClass<T> aux = new innerClass<T>(); 
    elements = (exampleInner<T>[]) Array.newInstance(aux.getClass(), size);
} 
```

我认为这也可以：

```
elements = (exampleInner<T>[]) Array.newInstance(innerClass<T>.class, size); 
```

但它没有，可能是因为泛型在 Java 中的实现方式（类型擦除等等）。

第一种方法的问题是我被迫创建一个新对象并实例化，尽管实际上并不需要它。另外，它使代码更加臃肿。

编辑：第二种方法不起作用，因为我使用`innerClass<T>.class`的是`innerClass.class`. 谢谢你的建议，我现在就用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T18:26:39.773

您在这里没有“通用数组创建”。数组的组件类型是“exampleInner”（嗯，应该是exampleInner，但是数组组件类型必须是“reified types”，所以不能在运行时存储），编译时就知道了。所以你不需要传入 Double.class 参数。

您真正需要做的是创建一个参数化类型的数组。一种方法是创建一个原始类型的数组，并将其转换为参数化数组类型。这将允许您像往常一样使用数组，并获得泛型的好处，即当您取出东西时不必强制转换。

从技术上讲，这是一个未经检查的强制转换，因为理论上它可能会在以后导致意想不到的问题，因为它不能阻止您将错误类型的对象放入数组中。但是由于这是您班级中的私有变量，并且我假设您仅在班级中对其进行操作，并且如果您相信自己的代码可以正确使用它，那么它将起作用。

```
import java.lang.reflect.*;

class exampleOuter <T extends Number>
{
    private exampleInner<T>[] elements;

    @SuppressWarnings("unchecked")
    public exampleOuter(int size)
    {
        elements = (exampleInner<T>[]) new exampleInner[size];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-25T23:42:46.577

您正在为某些特定`T`的类型创建一个对象`T[]`并将其分配给一个类型的字段，`exampleInner<T>[]`这将是一个错误。

For `T extends Number`: 的擦除类型`T[]`是`Number[]`; 对于被擦除的类型`exampleInner<T>[]`是`exampleInner[]`。但是编译器警告应该表明你做错了什么。

但是你几乎可以肯定不需要反射，所以不要使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-25T23:49:31.617

T 扩展了 Number 并且您试图将其转换为 exampleInner，我怀疑它在 Number 层次结构中的正确位置。

不用你的 exampleInner 试试看。或者尝试将 exampleInner 作为类型参数传递给 exampleOuter 构造函数。

# .net - NHibernate：映射到 DateTime 以非标准方式存储的值的最佳方法

> ID：393306
> 
> 赞同：0
> 
> 时间：2008-12-26T00:02:26.943
> 
> 标签：.net, nhibernate, orm, mapping

我刚刚开始使用 NHibernate（似乎是第 15 次）并且遇到了以下问题。

下表：

```
Table Facility
Column FACILITY_ID integer
Column NAME varchar2(50)
Column MONTH varchar2(5) 
```

无论出于何种原因，月份都是一个字符串而不是原生 Date 类型，如下所示：

```
"200811" represents 11/01/2008
"200307" represents 07/01/2003
you get the idea 
```

我想将它映射到以下类

```
public class Facility {
  int Id {get; set;}
  string Name {get; set;}
  DateTime Month {get; set;}
} 
```

我想将 MONTH 列映射到 Month 属性，但不太知道如何处理这种情况。显然，我可以有一个受保护的属性字符串 MonthString 并让 Month 属性解析该列，但这似乎很恶心。有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T02:07:56.020

我认为最好的解决方案可能是使用[自定义值类型](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/mapping.html#mapping-types-custom)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T03:43:37.227

如果您无法修改数据库架构，答案是`IUserType`. [这是一篇很好的文章](http://www.lostechies.com/blogs/rhouston/archive/2008/03/23/mapping-strings-to-booleans-using-nhibernate-s-iusertype.aspx)。

有许多扩展点可以帮助您解决 NHibernate 中的复杂问题。最有用的扩展点是 IUserType。

# graphics - 将 3d 球体投影到屏幕上的 2d 圆中

> ID：393307
> 
> 赞同：3
> 
> 时间：2008-12-26T00:03:52.760
> 
> 标签：graphics, 3d, particles, rasterizing

有哪些光栅化算法可以将 3d 球体投影到像素网格中？我想避免光线投射。本质上，给定一个 3d 坐标和一个半径，有没有一种快速的方法可以在像素网格上创建一个 2d 圆/椭圆？

例如：半径为 4 的 (2,2,2) 处的圆被投影到五个像素： p1(2,0)p2(0,1) p3(1,1) p4(2,1)p5(1,2 )

我遇到过诸如粒子系统的像素飞溅之类的技术，但我还没有找到关于如何做到这一点的明确答案。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T00:35:26.160

你有什么投影？

我很确定投影不是最有趣的圆圈。嗯。我想我会这样做的方法是在 3d 中找到其轴*与相机点对齐的圆周。从圆圈中选择任何需要的点，然后将它们转换为屏幕空间。最简单的是，这会给你一个多边形，但插值样条曲线可能也应该给你很好的结果。

*：旋转对称轴

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T22:52:23.147

很酷，所以假设您只是将 x,y 从球体的 x,y,z 中取出来形成您的圆圈。您如何在像素网格上对适当的像素进行着色？基本上，光栅化圆的算法是什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T21:08:31.970

也许最简单的方法（如果您不介意一些线性代数）是使用 4x4 投影变换矩阵。事实上，几乎任何类型的 3D 转换都可以使用 4x4 矩阵执行。

这是一篇帮助您入门的[Wikipedia 文章。](http://en.wikipedia.org/wiki/Transformation_matrix)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T04:38:06.303

听起来你愿意忍受对真实投影的一点不忠，以获得更简单的计算。如果是这样，请跟随...

我将首先假设您可以移动、旋转和调整球体的大小以匹配投影圆的坐标系。让我们将它们的半径称为 r，并假设球体的中心位于 (0,0,0) 处，圆的中心位于 (0,0) 处。两者的 X 轴从左向右运行，Y 轴从下向上运行，Z 轴从后向前运行。

这是有趣的部分：你已经完成了。球体和圆的 X 和 Y 坐标相同！如果 Z 坐标为正，则该点可见，如果为负，则该点隐藏在球体的背面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-26T06:51:59.097

我不明白你的问题 100%。您的像素网格 = 屏幕空间中的像素还是有固定比率？

根据我的最佳猜测，您可以尝试以下方法：

将内部视口坐标与屏幕空间像素映射并计算比率。使用该比率将您的对象准确地放置在您想要的位置。我使用这种方法编写了一个基于窗口（不是全屏）的 D3D 应用程序，以允许鼠标与 3D 对象交互。这允许使用鼠标移动和调整对象的大小，使其感觉就像普通的 Windows 应用程序。我通过反复试验计算出了这个比率（我不擅长矩阵计算）。

如果你没有像我上面那样干扰视图投影矩阵，3D 坐标是从左到右和从下到上的 -1.0f 到 1.0f。因此，您可以使用上述相同的方法轻松计算出比例并适当放置对象

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-10-19T03:00:44.943

球体在平面上的投影是一个椭圆，但它可以近似为一个圆。这可以与点的透视投影几乎相同。

假设屏幕中心为(X=0,Y=0)，观看者位于(X=0,Y=0,Z=0)。如果球体位于 (sX,sY,sZ) 处，半径为 sR，并且屏幕距离观察者 D 个单位（焦距），则圆将位于 (cX = sX * D / sZ, cY = sY * D / sZ)，半径为 cR = sR * D / sZ。一切都简单地按 D / sZ 缩放。

如果焦距 (D) 较大，或者球体的 sX 和 sY 坐标接近于零，则该圆仅是球体投影的良好近似。

# c# - C#、If 语句、最小值和最大值

> ID：393316
> 
> 赞同：-4
> 
> 时间：2008-12-26T00:22:12.317
> 
> 标签：c#

晚上好; 我正在编写一些代码来解决以下等式。

X 是设备的大小 Y 是设备的数量 A 是分母 Z 是总多样化值

(X * Y)/A = Z

这是我不知道如何完成的部分。A 的值由 Y 的量求得。如果 Y 在 3 和 6 之间，则 A = .7，如果 Y 在 6 和 9 之间，则 A = .6；如果 Y 在 6 和 9 之间，则 A = .6；等等。

我应该使用什么功能来完成上述操作？任何帮助是极大的赞赏。

问候，

格雷格·拉特利奇

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-26T00:42:29.047

IMO有3种方法：

1) 公式计算。因此，如果您有足够的数据，您想知道 A 给出的 Y 是什么，例如，将 0.7 用于 3<=Y<6，将 .6 用于 6

```
A = .8-(Y/3)/10.0; 
```

如果 Y 不是 3 的倍数，您可能需要在 Y/3 部分上使用强制转换或截断函数，或者您可以这样做以取出小数部分： (Y-(Y % 3))/3

2）使用while循环结构取出Y的3，注意while中的语句是缩写的，这可能会让人有点不清楚：

```
int Holder = Y, A=.8;
while (Holder > 0)
{
    A-= .1;
    Holder-= 3;
} 
```

3）如果/否则。如果 Y 是有界的，那么您可以使用蛮力分配策略：

```
 If Y<3 
    A=.8
 Else if Y < 6 
    A=.7
 Else if Y < 9 
    A=.6 
```

等等

这是我考虑解决此类问题的顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T00:26:29.577

您可以使用 if 和比较运算符 (<=)。在家工作？

“等等”是什么意思？如果案例是常规的，那么也许您可以使用公式而不是一堆 if 语句。

```
if(Y <= 3.0)      A = ...; 
else if(Y <= 6.0) A = 0.7; 
else if(Y <= 9.0) A = 0.6;
... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T00:48:09.597

假设 A 从 0.8 开始并随着 Y 每增加 3 减少 0.1：

```
int temp = Y / 3;
float A = 0.8f - (temp / 10f); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T01:12:40.063

好的，使用您刚刚发布的代码，我认为这就是您要查找的内容：

```
if ((cb5_1.Checked)&&(cb5_2.Checked)&&(cb5_3.Checked))
{
    //if the first three text boxes are checked calculate based on the following. 
    decimal a, b, c, d, z;
    decimal aa, bb, cc, zz;
    a = decimal.Parse(cbx5_1a.Text);
    b = decimal.Parse(cbx5_2a.Text);
    c = decimal.Parse(cbx5_3a.Text);
    aa = decimal.Parse(cbx5_1q.Text);
    bb = decimal.Parse(cbx5_2q.Text);
    cc = decimal.Parse(cbx5_3q.Text);
    z = (aa+bb+cc);

    d = 0.8m - ((z / 3) / 10m);

    zz = ((a*aa)+(b*bb)+(c*cc))*d;

    tb5_atotal.Text = Math.Round(z,2).ToString(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-26T01:59:44.053

如果值是在列表中预定义的，而不是使用函数创建的。

基本上每个对象都有一个 minValue、maxValue、value、minLink 和 maxLink。

跟随链接直到找到目标值或空指针。

```
if Y <= maxValue then 
    if Y >= minValue then
        return value
    else
        follow minLink
else 
    follow maxLink 
```

# .net - 鼠标在窗口中时WPF动画变慢

> ID：393318
> 
> 赞同：0
> 
> 时间：2008-12-26T00:23:56.243
> 
> 标签：.net, wpf, f#

我正在尝试创建一个移动矩形（矩形）。这是相关代码：

```
let timer = new Threading.DispatcherTimer();
timer.Tick.Add(fun _ -> Canvas.SetLeft(rect, Canvas.GetLeft(rect)+0.01) |> ignore)
timer.Start() 
```

问题是如果我将鼠标移到窗口上，动画会变慢。如果我设置计时器的间隔：

```
timer.Interval <- TimeSpan.FromMilliSeconds(30.0) 
```

然后动画根本不起作用。我究竟做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-26T06:25:55.750

我有两个建议：

1) 如果您使用 f# 交互式检查您是否安装了 WFP 事件循环。F# interactive 默认情况下设置了一个 winforms 事件循环，winforms 和 WFP 事件循环之间存在一些兼容性，但并非一切都能正常工作。要安装事件循环，请使用以下脚本：

```
#light

// When running inside fsi, this will install a WPF event loop
#if INTERACTIVE

#I "c:/Program Files/Reference Assemblies/Microsoft/Framework/v3.0";;
#I "C:/WINDOWS/Microsoft.NET/Framework/v3.0/WPF/";;
#r "presentationcore.dll";;
#r "presentationframework.dll";;
#r "WindowsBase.dll";;

module WPFEventLoop = 
    open System
    open System.Windows
    open System.Windows.Threading
    open Microsoft.FSharp.Compiler.Interactive
    open Microsoft.FSharp.Compiler.Interactive.Settings
    type RunDelegate<'b> = delegate of unit -> 'b 

    let Create() = 
        let app  = 
            try 
                // Ensure the current application exists. This may fail, if it already does.
                let app = new Application() in 
                // Create a dummy window to act as the main window for the application.
                // Because we're in FSI we never want to clean this up.
                new Window() |> ignore; 
                app 
             with :? InvalidOperationException -> Application.Current
        let disp = app.Dispatcher
        let restart = ref false
        { new IEventLoop with
             member x.Run() =   
                 app.Run() |> ignore
                 !restart
             member x.Invoke(f) = 
                 try disp.Invoke(DispatcherPriority.Send,new RunDelegate<_>(fun () -> box(f ()))) |> unbox
                 with e -> eprintf "\n\n ERROR: %O\n" e; rethrow()
             member x.ScheduleRestart() =   ()
                 //restart := true;
                 //app.Shutdown()
        } 
    let Install() = fsi.EventLoop <-  Create()

WPFEventLoop.Install();;

#endif 
```

2）我没有很好地测试这个，但我认为使用动画故事板会给出更一致的结果，而不是使用计时器。我认为这看起来像（更改宽度属性尚未解决如何更改位置）：

```
#light

open System
open System.Windows
open System.Windows.Controls
open System.Windows.Shapes
open System.Windows.Media
open System.Windows.Media.Animation

let rect = new Rectangle(Fill = new SolidColorBrush(Colors.Red), Height = 20., Width = 20., Name = "myRectangle")

let canvas = 
    let c = new Canvas()
    c.Children.Add(rect) |> ignore
    c

NameScope.SetNameScope(canvas, new NameScope());
canvas.RegisterName(rect.Name, rect)

let window = new Window(Content = canvas)

let nfloat f = new Nullable<float>(f)

let myDoubleAnimation = new DoubleAnimation(From = nfloat 20.0, To = nfloat 50.0,
                                            Duration = new Duration(TimeSpan.FromSeconds(5.)),
                                            RepeatBehavior = RepeatBehavior.Forever)
let myStoryboard = 
    let sb = new Storyboard()
    sb.Children.Add(myDoubleAnimation)
    sb

Storyboard.SetTargetName(myDoubleAnimation, rect.Name);
Storyboard.SetTargetProperty(myDoubleAnimation, new PropertyPath(Rectangle.WidthProperty))

rect.Loaded.Add(fun _ -> myStoryboard.Begin canvas)

let main() =
    let app = new Application()
    app.Run window |> ignore

[<STAThread>]
do main() 
```

# java - Java - UserInput.* 在我的 Mac 上不起作用

> ID：393322
> 
> 赞同：1
> 
> 时间：2008-12-26T00:29:56.107
> 
> 标签：java, macos, user-input

我在大学的 Windows 终端上完成了大部分编程工作。但是，我的计算机是 Mac，由于某种原因，当我使用 UserInput 方法时，javac 命令会引发错误。是否有任何安装或替代命令可用于使其正确编译？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T00:42:53.117

哪些用户输入方法？JDK 6 中没有 UserInput 类。您希望它们在哪个包中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T01:29:41.820

您可能在大学里使用老师提供的特殊包 UserInput 或类似的东西。如果是这种情况，那么你只需要在你的 Mac 上“安装”那个包，或者使用 java.util.Scanner 类来处理用户输入。

# c# - 递归调用同一个方法两次

> ID：393346
> 
> 赞同：2
> 
> 时间：2008-12-26T00:55:05.837
> 
> 标签：c#, .net, fibonacci

在斐波那契数列中，我见过递归调用相同方法两次的常规实现：

```
public void fibonacci(int i)
{
fibonacci(1) + fibonacci(2);
} 
```

现在这种方法不是我所看到的完全复制或解决问题的正确方法，但我已经看到两种方法像上面一样加在一起。所以该方法不是递归调用的，而是递归调用两次。在 C# 中编写这样的代码时究竟会发生什么？这两种方法是否在单独的线程上运行？引擎盖下发生了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-26T00:57:20.093

不，他们一个接一个地被调用。除非您明确要求（使用 System.Threading 的东西），否则不会创建其他线程。我不确定它们被调用的顺序，但我猜是从左到右。C# 规范肯定有它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-26T01:47:33.533

这是考虑计算机的工作方式很有用的时候之一。

让我们从函数开始。我将用 Python 风格的伪代码编写它，因为我希望您暂时不要考虑语言。

```
def fib(n):
    if n == 0: return 0
    if n == 1: return 1
    if n >  1: return fib(n-2) + fib(n-1) 
```

现在让我们来看看 fib(2)

`fib(2)`有*n>1*，所以它需要第三个分支，

```
 return fib(2-2) + fib(2-1) 
```

所以它用 0 调用*fib()*，也就是 0

```
 return 0 + fib(2-1) 
```

用 1调用*fib()*

```
 return 0 + 1 
```

我们看到结果 1。现在考虑 fib(3)：

n>1，所以

```
return fib(3-2)+fib(3-1) 
```

由于 3-2 为 1，我们得到第一项的 fib(1)，即 1：

```
return 1 + fib(3-1) 
```

现在当我们调用 fib(3-1)，也就是 fib(2) 时，我们还没有直接的答案；n>1。所以它变成

```
return 1 +
    return fib(2-2) + fib(2-1) 
```

变成

```
 return 0 + 1 
```

我们回到之前的电话

```
return 1 + 1 
```

并得到值 2。所以，你看，没有单独的线程，它只是在表达式中运行。我将把它作为一个练习来制定 fib(4) 的示例；不过，我敢打赌，如果你这样做，你会成功的。

小测验：*为什么*迭代版本的效率如此之高？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T01:00:33.223

它们按顺序进行估值。ie`fibonacci(1)`在 is 之前被评估`fibonacci(2)`。如果您想将其可视化，则需要先从第一个调用树（使用它自己的“拆分递归”）向下走，然后再向下走第二个三棵树。

顺便说一句，这通常用作如何*不*使用递归的示例，因为这是评估斐波那契数列的一种明显但低效的方式。首选选项是迭代方法（计算第一个数字，然后是下一个数字，等等，直到所需的数字），或者更好的是封闭形式的方程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T19:38:40.093

在 C# 中，您可以按照您的建议轻松实现该方法 - 它可能看起来像这样

```
public static int Fib(int i) {
   if (i == 0) return 0;
   if (i == 1) return 1;
   return Fib(i - 2) + Fib(i - 1);
} 
```

然而，这里没有魔法。它只是一次递归调用，然后是另一个。即所有代码在同一个线程上按顺序运行。

由于每次迭代的两个递归调用，性能也非常糟糕，因此即使对于`i`这个实现的非常小的值也可能没有用。如果您需要性能，最好自己处理状态来避免递归调用。

# c# - 匹配回合

> ID：393363
> 
> 赞同：1
> 
> 时间：2008-12-26T01:29:24.240
> 
> 标签：c#, regex

我有一些具有以下结构的文本：

```
Round 1

some multiline text ...

Round 2

some multiline text ...

...

Round N

some multiline text ... 
```

我想将回合与他们的多行文本相匹配。

没有一个表达式产生正确的结果：

(圆\s\d+)((?!圆).*?)

(圆\s\d+)(.*?)

有人可以帮助我吗？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T01:37:14.630

默认情况下，点 ( `.`) 字符匹配**除**换行符以外的所有字符。在许多语言中，您可以使用`s`修饰符使点匹配**所有**字符，包括换行符。它应该看起来像这样：

```
/(Round\s\d+)(.*?)(Round\s\d+|$)/s 
```

（不是 100% 确定这个正则表达式是否有效，我只是向您展示如何使用`s`修饰符。）

**编辑：**在 regexpal.com 上测试，它似乎工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T01:38:18.357

直接在多行上使用正则表达式可能并不容易（就可读性和可维护性而言）。

我会逐行处理文本，并使用数据结构来保存到目前为止所看到的任何内容。当您有标题、正文等时，您可以将其与电子邮件处理进行比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T01:45:55.207

这是一个 C# 问题吗？

(圆\s\d+)(.*?)

使用 RegexOptions.Singleline

Singleline 指定单行模式。更改点 (.) 的含义，使其匹配每个字符（而不是除 \n 之外的每个字符）。

而且您可能应该使用 Matches 而不是 Match。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T14:15:30.807

这将使用 RegexOptions.SingleLine 集来解决问题：

```
Round\s+\d+(.*?)(?=Round\s\d|$) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-26T14:33:12.330

Alan，正则表达式的好技巧，我没有足够的前瞻练习。

`/(Round\s+\d+)(.*?)(?=Round\s+\d+|$)/s`正是我需要的。

`/(Round\s+\d+)((?!Round).)*/s`也可以，但会导致每个字母都是单独的捕获。

非常感谢。

要更准确地描述我的数据，您可以查看此处，例如： [http ://www.rsssf.com/tablesi/ital09.html](http://www.rsssf.com/tablesi/ital09.html)

实际上，我需要将所有关于回合、比赛、结果、日期的信息导入我的数据库。

***我还有另一个问题要解决***：如何将我已经存储的球队与比赛结果中的球队联系起来。例如，我的数据库中有一个团队“Inter”。但匹配结果可能如下所示： `Internazionale 1-1 Juventus` 或
`FC Inter 1-1 Juventus`

将来我想进行正则表达式查询，例如*“获取国际米兰的所有匹配结果”*，以免查看整个内容。

所以我的想法是为每个团队存储他们可能的名称（标签），然后通过`|`.

例如：
`/(Inter|Internazionale|FC Inter)\s+\d+-\d+\d+(\w+)/s`

我也怀疑`(\w+)`任何团队比赛。恐怕我必须将所有团队名称标签与 | 连接起来 并在那里使用。对于 30 个团队和 2-3 个标签，这将是一个巨大的正则表达式。

我感谢您的帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-26T04:03:42.620

使用不情愿的量词作为正则表达式中的最后一件事，即使是正确的，也很少是正确的。在这个正则表达式中：

```
/(Round\s+\d+)(.*?)/s 
```

...该`(.*?)`部分所做的第一件事是尝试匹配零个字符。这是一个完全合法的匹配，因为量词不情愿，它就停在那里。如果你打算这样做，必须在 之后有一些东西`(.*?)`，像这样：

```
/(Round\s+\d+)(.*?)(Round\s+\d+)/s 
```

这样，`(.*?)`就不能停在零个字符上；它必须保持匹配消耗字符，直到它到达正则表达式的下一部分`(Round\s+\d+)`可以接管的位置。但是你不想使用那个正则表达式，因为它消耗了应该是下一场比赛的一部分。坚持这种格式，您可以使用前瞻作为结束条件：

```
/(Round\s+\d+)(.*?)(?=Round\s+\d+|$)/s 
```

现在它被迫匹配整个条目，但匹配位置留在下一个条目的开头，因此下一次匹配尝试将从那里开始。（编辑：添加`|$`到前瞻中以匹配最后一个条目。）

编辑：我也打算评论您的其他正则表达式：

```
/(Round\s+\d+)((?!Round).*?)/s 
```

在这里，您似乎在尝试使用先发制人的*负*前瞻，而不是使用积极的前瞻作为结束条件。为此，必须在允许点消耗字符之前在每个位置执行前瞻。这意味着点必须用前瞻括在括号中，量词在括号外：

```
/(Round\s+\d+)((?:(?!Round).)*)/s 
```

出于与另一个相同的原因，您也不能在此正则表达式中使用不情愿的量词。

可能有更好的方法来做到这一点，但在我提出任何建议之前，我需要更多地了解数据和您的要求。

（请注意，我使用了类似 Perl 的语法，带有斜线分隔符和尾随 's' 修饰符用于单行模式，因为没有它们，正则表达式往往会混淆网站的语法高亮。）

# java - Java 似乎并没有正确比较双精度数

> ID：393366
> 
> 赞同：1
> 
> 时间：2008-12-26T01:35:20.453
> 
> 标签：java, generics, double

我创建了一个链接列表，具有插入、搜索和删除功能。我还为它创建了一个迭代器。现在，假设我这样做：

```
myList<Integer> test = new myList();
test.insert(30);
test.insert(20);
test.insert(10);
myList.iterator it = test.search(20);
if(it.hasNext())
    System.out.println(it.next()); 
```

瞧，它起作用了（它在节点上打印元素的值，在本例中为 20）。现在，如果我这样做：

```
myList<Double> test = new myList();
test.insert(30.1);
test.insert(20.1);
test.insert(10.1);
myList.iterator it = test.search(20.1);
if(it.hasNext())
    System.out.println(it.next()); 
```

它没有，因为迭代器指向 null。下面是搜索功能的实现：

```
public iterator search(T data)
{
    no<T> temp = first;
    while( (temp != null) && (temp.data != data) )
        temp = temp.next;
    return (new iterator(temp));
} 
```

以下是我如何知道比较有问题的方法：如果我像这样更改上述代码的一部分：

```
while( (temp != null) && (temp.data != data) )
     System.out.println(temp.data + " " + data);
     temp = temp.next; 
```

我可以看到它打印列表中的数字。它在某一时刻打印“20.1 20.1”（例如）。那么我该如何解决这个问题呢？该函数似乎是正确的，但似乎 Java 没有正确比较数字。

编辑：wth，BigDecimal 也给了我同样的问题。

编辑 2：equals() 有效，没有意识到还有其他问题。对不起。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-26T01:58:04.183

请注意，使用`.equals()`来比较**双打**可能会导致错误。`Double.equals()`使用它作为它的平等测试：

```
 d1.doubleValue() == d2.doubleValue() 
```

**双精度**和**浮点数**是存储在内存中固定空间中的数字 的*近似值。*

为了正确比较*浮点数*，您需要注意，由于浮点数的性质，会有一些错误。

请参阅：[http ://www.google.com/search?q=floating+point+equality](http://www.google.com/search?q=floating+point+equality)

比较双打的一种快速简便的方法是使用`Math.abs(a-b)<ACCEPTABLE_ERROR` where ACCEPTABLE_ERROR 可能`.000000000001`取决于您的具体操作。 **（注意这不处理边缘情况，例如 NaN 和 INFINITY）**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T01:43:51.077

您不希望使用 != 运算符。它比较参考。你想要的`.equals()`方法：

```
public iterator search(T data)
{
    no<T> temp = first;
    while (!data.equals(temp.data)) {
        temp = temp.next;
    }
    return (new iterator(temp));
} 
```

另外，请注意[自动装箱](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)。您可能会发现`test.search(20.1)`框 20.1 到 a `Float`not a `Double`，这可能会破坏您的比较。将结果与 进行比较`test.search(20.1d)`。如果我没记错的话，表达式：

```
new Float(20.1).equals(new Double(20.1)) 
```

是假的。

# php - Facebook 应用程序 FBML 'profile.setFBML' 参数是什么？

> ID：393376
> 
> 赞同：1
> 
> 时间：2008-12-26T01:46:30.273
> 
> 标签：php, facebook, fbml

好的，我已经阅读了文档，但我不太确定传递的参数是什么。我正在查看列出的示例请求：

`$facebook->api_client->profile_setFBML(NULL, 128009, 'profile', NULL, 'mobile_profile', 'profile_main');`

并思考，他们从哪里得到这些论点，他们做了什么？

有人有解释吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T01:55:51.347

这适用于 PHP 库，其他库可能有自己的语法。

```
$facebook->api_client->profile_setFBML(session_key, uid, 'profile', 'profile_action', 'mobile_profile', 'profile_main'); 
```

**session_key** - 您正在设置其 FBML 的用户的会话密钥。仅当未指定 uid 时，Web 应用程序才需要它，因此在提供的示例中为 NULL。

**uid** - 您正在更新其个人资料的用户的用户 ID，或页面 ID（如果是主页）。如果未指定此参数，则默认为会话用户。

**profile** - 用于显示在用户配置文件的 Boxes 选项卡上的应用程序配置文件框的 FBML。

**mobile_profile** - 用于移动设备的 FBML。

**profile_action** - 已弃用，因此在提供的示例中为 NULL。

**profile_main** - FBML 用于用户配置文件的 Wall 和 Info 选项卡上的窄配置文件框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-02T04:17:44.973

不好意思，开头有4个**必填**参数：api_key、c​​all_id、sig和v。为什么示例不需要传递它们？

# multithreading - 在 servlet 容器中启动线程池

> ID：393378
> 
> 赞同：3
> 
> 时间：2008-12-26T01:48:13.297
> 
> 标签：multithreading, tomcat, servlets

我有一个处理来自 3rd 方站点的回调的 servlet S。

回调调用以特定顺序发生。因此，我需要将它们排队。

我建议使用内存队列，如

```
java.util.ConcurrentLinkedQueue 
```

所以逻辑看起来像这样：

*   Servlet S 接收回调并将接收到的项目排队到队列 Q 中。
*   此时，承载 servlet S 实例的线程将终止。
*   一个消费者线程从 Q 中读取并依次处理每一个。

据我了解，Servlet S 的每个实例都在其自己的线程中执行。

如何为将服务于 Queue 的整个 webapp（战争）创建单个消费者线程？基本上我需要单例实例：

1.  线程池
2.  并发链接队列

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-26T02:01:44.567

这不是 servlet 容器的用途。如果您打算使用基于标准的方法，那么您确实需要一个更成熟的 J2EE 应用程序服务器。否则，您将拥有的是 hack，但它们可能足以完成您的任务。

我可能会尝试创建一个 DaemonServlet。这只是一个没有映射到 URL 的普通 servlet（可能除了用于监视目的的盲 URL，尽管对于这种事情更喜欢 JMX）。`init()`加载 servlet 时调用该方法。您可以在其中启动一个线程。可以说，您可能需要创建两个：一个可以完成工作。另一个确保第一个正在运行并`destroy()`在调用时优雅地终止它。

或者，如果您正在使用[Spring](http://www.springsource.org/)（并且，让我们面对现实，什么样的 whacko 不使用 Spring？），您可以简单地在应用程序上下文中创建一个 bean，它做很多相同的事情，除了 Spring 生命周期事件（例如，在 InitializingBean 上的 afterPropertiesSet()）。

其实我有一个更好的建议。使用[异步消息消费者](http://static.springframework.org/spring/docs/2.5.x/reference/jms.html#jms-asynchronousMessageReception)，这将更清洁和更具可扩展性，但这是基于基于[JMS](http://java.sun.com/products/jms/)的解决方案，而不仅仅是一个`LinkedBlockingQueue`（无论如何 JMS 可能是一个更好的主意）。但是，根据您的限制，您可能没有可用的 JMS 作为选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T01:58:05.680

请记住，虽然您的 servlet 位于单独的线程中，但它们位于同一个 VM 实例中，因此它们存在于共享内存空间中。如果您创建一个 Singleton 实例，它将自动由所有 servlet 共享。您还可以创建一个单独的 servlet 来充当您的共享数据，这样做的好处是您可以根据需要使用容器服务来持久化它。

OReilly 的关于 servlet 编程的书中对执行此操作的方法进行了彻底的检查——技术上称为“servlet 协作”，可[在此处](http://books.huihoo.org/oreilly/javaenterprise/servlet/ch11_03.htm)在线获得。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T01:59:37.877

哦，另一个想法：您不想做的一件事*是*尝试在 servlet 容器中管理自己的线程池；它可以比你做得更好，除非你把它弄乱了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T02:26:17.807

我支持说管理自己的线程池是一个坏主意的评论。

Servlet 用于处理 HTTP 请求。HTTP 是一种同步请求/响应协议。如何处理它们的逻辑属于其他地方。该处理程序可能是同步的或异步的，但这应该取决于处理程序的实现。servlet 应该决定对于给定的响应要推迟到哪个处理程序，仅此而已。

即使您使用 Tomcat 或 servlet/JSP 引擎，您仍然可以通过将 ActiveMQ 添加到 Tomcat 实现来使用 Spring、JMS 和 MDP。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-22T06:34:56.550

使用监听器，我创建了一个线程池，我可以使用 ServletContext 与旧版 Tomcat 应用程序集成以存储线程池并让监听器管理生命周期，这样它就不会逗留。

```
@WebListener
public class MyThreadPool implements ServletContextListener {

    private static final String CONTEXT_ATTRIBUTE = "MyThreadPool";
    private ExecutorService myThreadPool;

    @Override
    public void contextInitialized(ServletContextEvent sce) {
        myThreadPool = Executors.newFixedThreadPool(10);
        sce.getServletContext().setAttribute(CONTEXT_ATTRIBUTE, myThreadPool);
    }

    public static ExecutorService getPool(Servlet servlet) {
        return (ExecutorService) servlet.getServletConfig()
               .getServletContext().getAttribute(CONTEXT_ATTRIBUTE);
    }

    @Override
    public void contextDestroyed(ServletContextEvent sce) {
        myThreadPool.shutdown();
        sce.getServletContext().removeAttribute(CONTEXT_ATTRIBUTE);
    }
} 
```

# sql-server - 从 MS Access 使用 SQL Server GUID 的建议

> ID：393381
> 
> 赞同：1
> 
> 时间：2008-12-26T01:54:09.277
> 
> 标签：sql-server, ms-access, database-design

我正在将现有的 MS Access 后端升级到 SQL Server 2008，并且因为我们想要使用[SQL Server 合并复制](http://msdn.microsoft.com/en-us/library/ms151329.aspx)，所以我必须将所有当前主键（当前标准自动增量整数）更改为 GUID。

所以这里有问题：

*   关于将主键从整数更改为 GUID 有什么建议吗？
*   关于在 Access 客户端中使用和操作代码中的 GUID 有什么建议吗？
*   我应该使用哪种 SQL Server GUID 类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-26T05:49:58.770

[Chris](https://stackoverflow.com/questions/393381/recommendations-on-using-sql-server-guid-from-ms-access#393447)说得对：（1）合并复制不需要 GUID，（2）只有一种 GUID 类型，但您必须知道：

1.  GUIDS 可以按照不同的规则生成。你可以[在这里查看](http://vadivel.blogspot.com/2007/09/newid-vs-newsequentialid.html)
2.  设置复制时，如果每个表不存在，SQL 会系统地为每个表添加一个 GUID（生成为 newsequentialid），并调用它`rowguid`。当然，如果每个表中已经有这样的 GUID/newSequentialId，SQL 会使用它。但是我不建议您将复制 GUID 与 PK GUID“混合”：您可以将 GUID 类型的所有主键声明为“newSequentialIds”，但是（a）您将失去在客户端生成 GUID 值的可能性- 见下文 - 并且 (b) 你的 PK 将是“可预测的”，这个想法让我感到不舒服......
3.  保持自动增量整数并通过复制管理它们的范围意味着大量开销（您必须为每个表/每个发布分配范围）以及从不同来源复制时潜在的冲突来源。
4.  [此外，像这个](http://support.microsoft.com/?scid=kb%3Ben-us%3B943281&x=16&y=11)特定于范围分配的一些 SQL 错误仍然没有得到妥善解决：应用累积包 5 并没有解决我们的问题，我们必须找到另一种方法来重新启动复制过程。
5.  无论如何，我深信从整数切换到 GUID 作为主键是强制性的。造成这种情况的原因有很多，其中一个与这些范围管理有关，可能是头痛和通宵故障排除的潜在来源。

关于从整数到 GUIDS 的变化，我建议您编写一个分步模块，该模块将：

*   在修改所有现有表之前备份它们
*   向每个表添加一个 GUID 字段
*   在请求的地方添加相应的 FK 字段
*   通过使用现有关系构建的视图更新 FK 字段（基于整数字段）
*   断绝关系
*   将 PK 从整数字段更改为 GUID 字段
*   重新创建关系

花点时间编写这段代码。在它正常工作之前，您将多次使用它。您应该利用 DAO 对象、tabledef、索引等。请记住，您**必须始终能够**回到起点，因此不要忘记初始备份过程。

从 VBA 操作 GUID 怎么样？有几点需要了解：

*   GUID 属于 Variant 类型
*   正如我[在这里](https://stackoverflow.com/questions/345865/getting-primary-key-after-an-insert-in-aspnet-visual-basic#346420)提出的那样，在应用程序的客户端生成您的 GUID 作为主键是可能且容易的。
*   当您尝试从表单中的控件（通常作为组合框中的链接字段）获取 GUID 值时，您将获得 '?????' 但没有值。您必须参考记录集中的字段值才能获得正确的数据。您可以在您的应用程序中打开这样的表单，转到“立即”窗口，然后尝试以下操作：

* * *

```
? myForm.myControl
?????

? myForm.recordset.fields("myFieldName")
{000581EB-9CBF-418C-A2D9-5A7141A686CC} 
```

*   在使用诸如 recordset.findfirst 之类的表达式浏览记录集时，您可能必须将您的 guid 转换为字符串：

* * *

```
myFirstRecordset.FindFirst "stringFromGUID(myGuidId) = " & StringFromGUID(mySecondRecordset.Fields("myGuidId").Value) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T03:50:16.343

这可能有点离题。但是，您不必使用 GUID 来执行合并复制。您仍然可以使用自增整数并将不同的范围分配给不同的数据库实例。这样就不会生成具有相同 ID 的行。

此外，SQL 2008 中只有一个 GUID 类型字段 - uniqueidentifier

# javascript - 垂直缩放 div 直到显示所有内容？

> ID：393385
> 
> 赞同：2
> 
> 时间：2008-12-26T01:58:46.973
> 
> 标签：javascript, scriptaculous

我有一个设置高度为 200 的 div，有时里面有足够的内容必须滚动。有什么方法可以缩放/增长 div 直到 Scriptaculous 中没有溢出？

编辑：我查看了 wiki，尤其是 Effect.Scale（这似乎是我想要的），但我找不到一种方法来做我想做的事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-26T02:29:42.060

使用 CSS？

```
/*In non-IE css:*/
.myclass {
min-height: 270px;
}

/*In css for IE:*/
.myclass {
height: expression(this.scrollHeight < 270? "270px" : "auto" );
} 
```

# ruby-on-rails - 如何从 Rails 观察者/模型调用 expire_fragment？

> ID：393395
> 
> 赞同：29
> 
> 时间：2008-12-26T02:12:41.423
> 
> 标签：ruby-on-rails, ruby, caching, memcached

我几乎尝试了一切，但似乎无法使用模型中的 expire_fragment ？我知道你不应该这样做，而且它不是 MVC，但肯定有很多方法可以做到这一点。

我在 lib/cache_helper.rb 中创建了一个模块，其中包含我所有的过期助手，其中每个只是一堆 expire_fragment 调用。我在 /app/sweepers 下设置了所有缓存清除程序，并在我的应用程序控制器中有一个“包含 CacheHelper”，因此当通过控制器调用时，应用程序中的过期缓存工作正常。

然后事情是我有一些外部守护进程，尤其是一些重复的 cron 任务，它们调用调用某个方法的 rake 任务。此方法进行一些处理并将条目输入到模型中，之后我需要使缓存过期。

最好的方法是什么，因为我无法在模型中指定缓存清扫器。直截了当的观察者似乎是最好的解决方案，但它抱怨 expire_fragment 未定义等，我什至尝试将 ActionController 缓存类包含到观察者中，但没有奏效。我很想知道如何为此创建解决方案。谢谢。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-19T21:14:04.440

免责声明：我的铁轨有点生锈，但这个或类似的东西应该可以工作

```
ActionController::Base.new.expire_fragment(key, options = nil) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-01-05T14:45:03.467

Orion 提供的解决方案完美运行。作为增强和方便起见，我将以下代码放入`config/initializers/active_record_expire_fragment.rb`

```
class ActiveRecord::Base
  def expire_fragment(*args)
    ActionController::Base.new.expire_fragment(*args)
  end
end 
```

现在，您可以在 ActiveRecord::Base 的所有实例上使用 expire_fragment，例如`User.first.expire_fragment('user-stats')`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-03T23:36:30.700

这很容易做到。您可以实现 Orion 的建议，但您也可以实现下面说明的更广泛的技术，这使您可以从任何模型访问当前控制器，以及您决定打破 MVC 分离的任何目的（例如，弄乱片段缓存、访问`current_user`、生成路径/URL 等）

***为了从任何*模型访问*当前请求的控制器*（如果有的话）***，请将以下内容添加到新插件中`environment.rb`，或者最好添加到新插件中（例如`vendor/plugins/controller_from_model/init.rb`，包含以下代码的创建）：*

 *```
module ActiveRecord
  class Base
    protected
      def self.thread_safe_current_controller #:nodoc:
        Thread.current[:current_controller]
      end

      def self.thread_safe_current_controller=(controller) #:nodoc:
        Thread.current[:current_controller] = controller
      end

      # pick up the correct current_controller version
      #  from @@allow_concurrency
      if @@allow_concurrency
        alias_method :current_controller,  :thread_safe_current_controller
        alias_method :current_controller=, :thread_safe_current_controller=
      else
        cattr_accessor :current_controller
      end
  end
end 
```

那么，在`app/controllers/application.rb`，

```
class ApplicationController < ActionController::Base
  before_filter { |controller|
    # all models in this thread/process refer to this controller
    #  while processing this request
    ActiveRecord::Base.current_controller = controller
  }

  ... 
```

然后，**从任何模型**，

```
if controller = ActiveRecord::Base.current_controller
  # called from within a user request
else
  # no controller is available, didn't get here from a request - maybe irb?
fi 
```

无论如何，在您的特定情况下，您可能希望在相关控制器类加载时将代码注入到您的各个`ActiveRecord::Base`后代中，以便实际的控制器感知代码仍然驻留在 中`app/controllers/*.rb`，但为了获得某些功能而不必这样做（虽然丑陋且难以维护。）

玩得开心！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-26T02:55:39.247

在我的一个脚本中，我使用了以下 hack：

```
 require 'action_controller/test_process'

  sweepers = [ApartmentSweeper]

  ActiveRecord::Base.observers = sweepers
  ActiveRecord::Base.instantiate_observers

  controller = ActionController::Base.new
  controller.request = ActionController::TestRequest.new
  controller.instance_eval do
    @url = ActionController::UrlRewriter.new(request, {})
  end

  sweepers.each do |sweeper|
    sweeper.instance.controller = controller
  end 
```

然后，一旦调用了 ActiveRecord 回调，清扫器就可以调用 expire_fragment。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-27T08:59:46.333

我有点像 Rails 菜鸟，所以这可能不正确，甚至没有帮助，但尝试从模型中调用控制器操作似乎是错误的。

是否不可能在控制器中编写一个执行您想要的操作，然后从您的 rake 任务中调用控制器操作？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-02T05:08:30.357

为什么不让您的外部 rake 任务调用控制器上的 expiry 方法。然后你仍然是 MVC 兼容的，你没有建立对一些范围黑客等的依赖。

就此而言，您为什么不将所有守护程序/外部功能放在控制器上并让 rake / cron 调用它。这将更容易维护。

——马库斯

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-01T18:22:20.460

将当前控制器作为参数传递给模型方法调用不是更容易和更干净吗？如下：

```
def delete_cascade(controller)

  self.categories.each do |c|
    c.delete_cascade(controller)
    controller.expire_fragment(%r{article_manager/list/#{c.id}.*})                
  end
  PtSection.delete(self.id)
  controller.expire_fragment(%r{category_manager/list/#{self.id}.*})        
end 
```

您可以从模型中访问控制器的所有公共方法和属性。只要不修改控制器的状态，应该没问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-03T12:53:18.890

这可能不适用于您正在做的事情，但您可以在模型上定义自定义回调：

```
class SomeModel < ActiveRecord::Base
    define_callback :after_exploded

    def explode
        ... do something that invalidates your cache ...
        callback :after_exploded
    end
end 
```

然后，您可以像往常一样使用扫地机：

```
class SomeModelSweeper < ActionController::Caching::Sweeper
  observe SomeModel 

    def after_exploded(model)
      ... expire your cache
    end
end 
```

让我知道这是否有用！

# .net - Velocity 之外的 .NET 缓存框架

> ID：393406
> 
> 赞同：1
> 
> 时间：2008-12-26T02:36:03.060
> 
> 标签：.net, caching

除了代号为 Velocity 的项目之外，还有哪些其他缓存框架可用于 .NET。ALT.NET 选项有哪些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T03:05:22.923

总有[Oracle Coherence](http://www.oracle.com/technology/products/coherence/index.html)。[这里](https://stackoverflow.com/questions/383920/what-is-the-best-library-for-java-to-gridcluster-enable-your-application#383929)提到的许多缓存技术也有 .Net 库（例如[memcached](http://www.danga.com/memcached/) .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T03:28:04.407

分布式缓存框架？免费的？

有一个 Windows 版本的 memcached，但它不是很好。有[Cacheman](http://www.sriramkrishnan.com/blog/2008/02/cacheman-fast-distributed-hashtable-for.html)，这似乎还可以。我会推荐 Velocity，我已经看到 Velocity 在一个流量很大的网站上使用，它可以完成工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T04:44:43.237

有[Ncache](http://www.alachisoft.com/ncache/index.html)和免费的[NCache Express](http://www.alachisoft.com/ncache/ncache_express.html)。另请查看[ScaleOut State Server](http://www.scaleoutsoftware.com/products/stateServer/index.html)。

# http - 为什么 HTTP 协议以纯文本方式设计？

> ID：393407
> 
> 赞同：34
> 
> 时间：2008-12-26T02:36:07.897
> 
> 标签：http, text, binary, protocols

昨天，我和同事讨论了 HTTP。有人问为什么HTTP是以纯文本方式设计的。当然，它可以像 TCP 协议一样以二进制方式设计，使用标志来表示不同类型的方法（POST、GET）和变量（HTTP 标头）。那么，为什么 HTTP 是这样设计的呢？是否有任何技术或历史原因？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-12-26T02:41:42.083

技术和历史的一个*原因*是文本协议在 Unix 世界中几乎总是首选。

好吧，这不是真正的原因，而是一种*模式*。这背后的基本原理是文本协议允许您通过转储所有经过的内容来*查看网络上正在发生的事情。*您不需要像 TCP/IP 那样需要专门的分析器。这使得调试和维护更容易。

不仅 HTTP，而且许多协议都是基于文本的（例如，FTP、POP3、SMTP、IMAP）。

你可能想看看*The Art of Unix Programming*以获得关于这个 Unix 东西的更详细的解释。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-26T03:30:05.010

使用 HTTP，请求的*内容*几乎总是比协议开销大几个数量级。将协议转换为二进制协议将节省非常少的带宽，并且文本协议提供的易于调试性*很容易*胜过二进制协议的少量带宽节省。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-26T02:39:33.350

许多 Internet 应用程序协议或多或少地使用纯文本协议（请参阅 FTP、POP、SMTP 等）。

它使互操作性和故障排除变得更加容易。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-26T02:40:22.070

HTTP 代表“超文本传输​​协议”。

它最初被设计为一种服务文本文档的方式，因此是基于文本的协议。

我们现在对 HTTP 所做的事情远远超出了它的初衷。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-26T02:55:40.540

与[HTTP 1.1 的 RFC 2616 第 3.7.1 节](http://www.ietf.org/rfc/rfc2616.txt)一样，命令或标题行的关键标识符是文本换行符 CRLF；基于文本的应用程序协议使纯粹与 Telnet 客户端进行对话（用于故障排除）变得更加容易。它还可以更轻松地使用 ReadLine() 调用和匹配文本字符串进行编程。

CRLF 参数中断还提供了近乎无限的任意头扩展，这与固定大小的 TCP 或 IP 头不同，后者通过位偏移进行硬编码。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-26T02:39:50.340

所以更容易“读取”流量或创建客户端或服务器？

你可以争论它是否*真的*让事情变得更容易，但这肯定是意图。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-03-03T12:27:50.503

在 http 的情况下，有些人使用它的“二进制”版本，他们称之为嵌入式二进制 HTTP (EBHTTP)

[https://datatracker.ietf.org/doc/html/draft-tolle-core-ebhttp-00](https://datatracker.ietf.org/doc/html/draft-tolle-core-ebhttp-00)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-26T20:29:34.953

从历史上看，这一切都始于 RFC822（ARPA 互联网文本消息格式标准），其最新版本是 RFC5322（互联网消息格式）。SMTP (RFC 821) 是基于 RFC822 的最流行的协议之一。而且，HTTP 诞生于 SMTP（您的邮件协议）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-20T16:25:07.267

我喜欢：

> ...在 Unix 世界中是首选。

原因，但它没有解释原因。

为了理解为什么您需要将自己置于想要制作可用产品的设计师的位置。

A）您可以用无意义的胡言乱语（二进制）记录狗屎。

B）开发或希望其他人开发工具，以有意义的方式描绘您的无意义的胡言乱语。

或者

A）您可以利用语言作为自记录协议的工具，从有意义的文本中记录狗屎。

B) 不需要额外的工具，额外的工具会更容易编写和调试。

它创建了分阶段交付，并创建了在进行未来开发时更容易理解和回忆的东西。它还创造了一种不再需要更高级别抽象的情况。

Imagine a world where setting a header value isn't as simple as dictionary/Map somewhere in your framework. When running into errors you'd have to constantly question whether or not your framework is correct or not, because you couldn't easily see it's doing the right thing without additional tools. That would be the world of HTTP if each framework needed to invent/implement it's own higher level abstraction (browsers come to mind).

Many protocol designer's want efficiency, this design focuses on usability, which is paramount in the software development industry. Unusable tools that are prematurely optimized create an unnecessary burden for software developers, and this burden manifests across the board.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-09T07:50:07.490

Now,HTTP/2 based Binary,it is much less error-prone.

[https://http2.github.io/faq/#why-is-http2-binary](https://http2.github.io/faq/#why-is-http2-binary)

# php - 使用 phpmsnclass 自动接受联系人

> ID：393410
> 
> 赞同：3
> 
> 时间：2008-12-26T02:38:57.843
> 
> 标签：php, class, msn

我目前正在使用[phpmsnclass](http://code.google.com/p/phpmsnclass/)向 MSN 网络上的联系人发送消息。但是要让我的“机器人”上的昵称起作用，我必须接受我的联系人发送给我的“朋友请求”。

从调试信息中，我发现文件 msn.clas.php 中的第 1672 行附近是一种自动接受功能。但我不能使用具有此功能的 doLoop 函数，因为它永远不会结束。

那么有没有人有时间帮我检查一下，或者有另一个框架可以与 msn 一起工作，这可能会更好？现在已经阅读了很多关于 MSN 网络的内容，但我还没有完全了解如何做到这一点，我需要一些提示。

提前：谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T05:14:32.350

我不太确定你会怎么做，但你有没有想过两部分检查？一个在程序处于活动状态时运行，然后在它处于活动状态时检查是否有人试图添加机器人的功能。如果有人继续自动接受。不过，这将需要响应时间。我希望下面的伪代码虽然很粗糙，但至少能有所帮助。

```
while (program is running) 
   if (pendingRequest == true){
        doSomething
   }
} 
```

# c# - Lua 在 C# 中相对于 CSharpCodeProvider 在动态代码执行方面的优势是什么？

> ID：393422
> 
> 赞同：1
> 
> 时间：2008-12-26T02:48:02.850
> 
> 标签：c#, lua

在我的场景中，我想解释一个脚本文件并从程序集中执行方法。Lua 会给我带来什么好处？如果您同时使用了 Lua 和 CSharpCodeProvider，请将您的经验与两者进行对比。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-27T12:13:12.393

C# 的主要优点是它是编译和 JITted 的（尽管 LUA 在这些路线上有实验性代码）。

LUA 的主要优点是它不需要编译。它运行速度较慢，但​​具有更好的引导时间。它还具有较少数量的引导代码（例如，您不需要使用 System; ... namespace MyNs { ... class MyClass { ... 等等）。

最后，LUA 在脚本世界中的统治是至高无上的：但它无法抵抗 C# 在性能世界中的表现，反之亦然。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T19:12:40.783

你检查过 IronPython 吗？它与 Lua 非常相似，但它是一种原生 CLR 语言。

# wpf - 禁用窗口时WPF更改按钮背景颜色

> ID：393428
> 
> 赞同：0
> 
> 时间：2008-12-26T03:01:32.213
> 
> 标签：wpf, listview, textbox, transparency, button

我在 wpf 窗口上有一个透明背景的按钮。

问题是，当我用 .showdialog 打开另一个窗口时，表单和按钮一样被禁用，导致按钮变白（并且像拇指一样突出）；列表视图和文本框控件也是如此。标签和分组框不会以这种方式受到影响，并且看起来仍然很好。

如何在禁用按钮、列表视图和文本框时保留它们的透明度颜色？

谢谢，罗伯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T04:13:43.300

我不确定您的按钮模板是什么样的，我建议您发布您的 XAML。但是请查看有关[按钮模板的 MSDN 文档](http://msdn.microsoft.com/en-us/library/ms753328.aspx)

# wcf - 双工通信是否需要开放通道？

> ID：393432
> 
> 赞同：2
> 
> 时间：2008-12-26T03:06:54.683
> 
> 标签：wcf, duplex

简短版本：当我在使用双工通信的客户端上使用 ChannelFactory 创建通道时，是否需要保持通道打开才能接收回调，或者我可以调用 ChannelFactory.Close()？

长版：我正在开发我的第一个 WCF 服务，并且我创建了自己的 ClientProxy 类，它实现了几个不同的服务并将其合并为一个。我使用 ChannelFactory 来创建每个通道，我在网上的一般阅读表明我应该缓存 ChannelFactory，但我应该只在需要时打开和关闭实际通道。

所以我调用 ChannelFactory.Open 来打开一个通道并执行一个双工操作（单向操作，后来调用回调）。我是否应该在请求操作后通过调用 ChannelFactory.Close 来关闭此频道，如果我这样做了，我还会收到回调吗？

基本测试似乎表明，如果我关闭连接，我将收到回调，但我只是想确定一下。另外，这种缓存 ChannelFactory 的方法是否正确？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-26T19:21:21.330

当您希望接收回调时，您应该保持客户端代理打开，完成后您应该关闭通道。

以下是 Juval Lowy 的《Programming WCF Services》一书的引述（我建议您阅读有关回调的整章）：

5.3.4\. 回调连接管理

回调机制提供的服务与管理服务和回调端点之间的连接没有什么类似的高级协议。开发人员需要提出一些应用程序级协议或用于管理连接生命周期的一致模式。如前所述，服务只能在客户端通道仍然打开的情况下回调客户端，通常通过不关闭代理来完成。保持代理打开也将防止回调对象被垃圾收集。如果服务在回调端点上维护了一个引用，并且客户端代理已关闭或客户端应用程序本身已消失，则当服务调用回调时，它将从服务通道获得 ObjectDisposedException。因此，当客户端不再希望接收回调或客户端应用程序正在关闭时，最好通知服务。为此，您可以在服务契约中添加一个显式的 Disconnect() 方法。由于每个方法调用都带有回调引用，因此在 Disconnect() 方法中，服务可以从其内部存储中删除回调引用。

# flash - 滥用 Adob e Flash

> ID：393438
> 
> 赞同：1
> 
> 时间：2008-12-26T03:35:44.890
> 
> 标签：flash

许多野外网站似乎通过自动启动基于 Flash 的广告/预告片等来滥用访问者。现代浏览器提供了哪些防御措施，例如，

1.  禁止自动播放特定 URL/站点/域
2.  禁止使用扬声器[闪光灯不允许配置此功能，我对扬声器滥用特别恼火]？

当然，完全删除闪光灯不是一种选择:)

想法？

更新：澄清：我访问有问题的网站是因为它们有有用的内容......但我不在乎他们占用我的扬声器......我可以忍受的带宽牺牲......IE确实有一个“播放声音在网页上”选项，但不是每个页面/站点。我确实需要 Flash 本身 [用于观看播客等]。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-26T03:50:31.960

通常我会立即[使用 Hosts 文件](http://www.mvps.org/winhelp2002/hosts.htm)来阻止许多不需要的站点。

至于浏览器实现：Internet Explorer 提供了通过配置区域并向其中添加站点来阻止事物的能力。（这实际上与使用主机文件相同）

当前的浏览器还使用它们定期从 Internet 下载的列表来帮助您防止恶意网站，这些列表使用警告，因此您不会意外访问它们。

除了这些东西之外，还有很多可用于阻止图像、javascript、flash 等的插件......你可以在其他答案中找到其中的一些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T03:47:50.247

有几种手段：

*   [停止 Autoplay](https://addons.mozilla.org/en-US/firefox/addon/1765)，这是一个显而易见的 Firefox 插件；
*   [Flashblock](https://addons.mozilla.org/en-US/firefox/addon/433)，类似的交易；
*   [FlashMute](http://lifehacker.com/software/distraction/download-of-the-day-flashmute-194339.php)，用于控制 Flash 音频（我发现自动播放 Flash 音频的网站最烦人，几乎总是立即关闭）；和
*   卸载闪存。我的笔记本电脑没有安装它，你会惊讶地发现你没有错过它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T03:44:27.243

我认为当前的任何浏览器都没有提供这样的功能——插件内部发生的事情基本上超出了浏览器的关注范围。我认为目前，最终遏制这种行为的是社交——我只看到过一次带有自动播放音频的广告横幅，一两天后，在同一个网站上，管理员发了一个帖子道歉并解释说他已更改横幅提供商。

话虽如此，浏览器范围内的“静音插件”功能将是一个好主意。我只是不认为目前有一个。我也希望 Flash 在上下文菜单中放置一个“静音”选项，但目前还不是这样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T11:55:09.467

首先使用 IE 不要安装 flash。要停止提示安装它，请将其添加到注册表

```
[HKEY_LOCAL_MACHINE\Software\Microsoft\Internet Explorer\ActiveX Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}]
"Compatibility Flags"=dword:00000400 
```

然后，对于您必须为其安装 Flash 的奇怪站点，请使用其他浏览器（例如 Opera 或 Chrome）来安装 Flash。

# .net - 从 Microsoft Exchange Server 2003 检索联系人

> ID：393468
> 
> 赞同：-1
> 
> 时间：2008-12-26T04:19:44.317
> 
> 标签：.net, exchange-server

如何使用 .net 从 Microsoft Exchange Server 2003 中检索联系人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T08:31:02.033

访问 Exchange 2000-2003 的一种方法是使用 webdav。

这里有几篇文章

*   [http://blogs.technet.com/kclemson/archive/2004/01/23/62247.aspx](http://blogs.technet.com/kclemson/archive/2004/01/23/62247.aspx)
*   [http://www.msexchange.org/articles/Access-Exchange-2000-2003-Mailbox-WebDAV.html](http://www.msexchange.org/articles/Access-Exchange-2000-2003-Mailbox-WebDAV.html)

还可以在 stackoverflow 中搜索[webdav 交换](https://stackoverflow.com/search?q=webdav+exchange)，以获取其他几个相关的问题和答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T15:53:39.597

如果这将在客户端计算机上运行，​​那么您应该尝试针对 Outlook 对象库进行编程。这些比与 Exchange 2003 本身交谈要容易得多。

如果您需要在没有客户端或服务器的情况下运行它，那么您最好的选择是查看 Exchange 2003 WebDAV api。

# php - Best way to transfer an array between PHP and Javascript

> ID：393479
> 
> 赞同：20
> 
> 时间：2008-12-26T04:39:37.397
> 
> 标签：php, javascript, ajax, arrays, dom

So I have an array of records retreived from a database. The array is in the format;

```
$rows[0]['id']=1;
$rows[0]['title']='Abc';
$rows[0]['time_left']=200;

$rows[1]['id']=2;
$rows[1]['title']='XYZ';
$rows[1]['time_left']=300;
//And so on upto 10-20 rows 
```

What's the best way of transferring this array over to my javascript code? I'd like the javascript to be able to loop through all of the records, and using the 'id' attribute, update the div with that id with some information.

My javascript code is in an external .js file, but i'm able to execute php code in the HTML code of my page. So I could do something like this:

**In my_file.js:**

```
var rows=New Array(); 
```

**In HTML code:**

```
<html>
<head>
<script type="text/javascript" src="js/my_file.js"></script>

<script type="text/javascript">
<? foreach ($rows as $row):?>
<? extract($row);?>
rows[<?=$id;?>]['title']="<?=$title;?>";
//And so on
<? endforeach;?>
</script> 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-26T05:08:08.167

I tend to use a JSON object for this:

*   On the server side, JSON encode your data: `json_encode($data);`
*   On the JavaScript side, I write a function that takes a JSON object as a parameter and unpack it.

When you unpack the object, you can print the array's contents into a `<DIV>` tag, or where ever you would like on the page (jQuery does a pretty sweet job of this).

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-26T05:52:49.763

If you're doing inline data, I've always been fond of doing

```
<script type="text/javascript">
window.sitescriptdata = {}; 
window.sitescriptdata.foo = ( <?php echo json_encode( $structure ); ?> );
</script> 
```

For basic stuff, saves you doing an AJAX callback. Also, if you want to glue data to a DOM node, the "metaobject" way is something I really love.

```
<div id="foobar">
 <div><object class="metaobject">
        <param name="data" value="<?php echo htmlentities(json_encode($data), ENT_QUOTES );?>" />
 </object></div>
</div> 
```

Now this may not look great, but its an effective way of associating data directly with a DOM node without needing to know the exact unique path to that node. Very handy if you have many many datasets that need to be attached to specific screen elements.

I usually use [http://noteslog.com/metaobjects/](http://noteslog.com/metaobjects/) plugin for jQuery, but its so simple I have on occasion written it myself ( there was a time I couldn't find the plugin, but new how it worked )

When done, there will be

$("div#foobar > div").get().data.($yourarrayhere)

Visible to your code.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T05:31:19.337

To follow up to your question (and my reply, I ran out of space on the comment reply), here is a very simplified subset of the code I use:

Javascript AJAX handler in jQuery:

```
$.ajax({
   type: "POST",
   url: "BACKEND.php",
   timeout: 8000,
   data: "var1=" + myVar,
   dataType: "json",
   error: function(){
     $("#DIVID").html("<div class='error'>Error!</div>");
   },  
   success: function(jsonObj){
     $("#DIVID").html(jsonObj.mydata);
   }
 });

PHP Array:
$data['mydata'] = $myData; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T12:35:58.187

In an AJAX example like [here](http://netisoft.net/basic_tutorial_ajax.html) you can solve this problem on this way:

.php file (ajax return function)

```
$myArray = array("object_id"=>1, "object_title"=>"Testobject");
return json_encode($myArray); 
```

.js file (javascript function)

```
...
if(g_httpRequest.readyState == 4)
{
var jsonRes = JSON.parse(g_httpRequest.responseText);
alert(jsonRes.object_title)
}
... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-10T12:03:06.307

im still fairly new too say maybe this method isnt the most secure, but you can always turn your javascript array into a string and then pass it through the URL for the php to GET.

so:

```
for(var i=0;i < jsarray.length;i++) 
{
var x = jsarray[i];
urlstring += "myvalue[]="+x+"&";
}

document.location.href = "mypage.php?"+urlstring; 
```

and then the php would be:

```
$phparray = $_GET['myvalue']; 
```

hope that helps

# cocoa-touch - 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“-[UIViewController loadView] 加载了 nib 但未设置视图

> ID：393483
> 
> 赞同：2
> 
> 时间：2008-12-26T04:44:32.660
> 
> 标签：cocoa-touch, interface-builder

根据我对 SDK 的了解，当 IB 中的绑定不正确时会引发此异常。但就我而言，前两次视图加载正常。然后我使用 NavigationController 从视图返回。

第三次尝试打开视图时，出现此异常。它前两次打开正确的事实意味着绑定正确并且视图很好！但是为什么它第三次失败了呢？

任何指针？谢谢。

我正在调用`-initWithNibName:bundle:`初始化在 IB 中创建的视图。不调用`-loadView`方法。

* * *

它没有收集垃圾。AFAIK，iPhone SDK 中没有垃圾收集，我们需要明确地释放东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-10-28T10:56:55.963

看来您还没有将视图绑定到它的文件所有者。

要修复这个问题，请打开您在此 ViewController 中使用的 xib。右键单击您的主视图，然后将此视图绑定到 File Owener 的视图属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T12:06:41.347

您可能内存不足，这会迫使系统将内存不足的消息发送到实例化的视图控制器。-didReceiveMemoryWarning 的默认实现会清除视图成员变量。从理论上讲，下次需要该视图时，应该重新实例化它，但您可能已经覆盖了阻止该视图的某些内容。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-12-26T07:00:23.853

视图对象可能超出范围，并被垃圾收集。

# c# - 我在哪里可以找到一个好的 FFT 示例实现/教程？

> ID：393490
> 
> 赞同：6
> 
> 时间：2008-12-26T04:55:34.480
> 
> 标签：c#, fft, sample

我一直在到处寻找（最好是）C# 中的示例快速傅立叶变换实现/教程。

但是，我发现的每个人都无法解释正在发生的事情，和/或评论不佳；或者他们假设您已经知道 FFT 算法，或者他们是关于如何使用 FFT 的教程。

有人知道一个好的示例/教程吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-29T10:44:06.307

*抱歉缺少超链接，我无权添加它们*:(

你在这里要求两件事

**1) FFT的解释**

非常简短：

如果要获得信号的频域表示，请使用*傅里叶变换*，这是一种数学变换，可将信号从时域变换到频域。在对数字信号进行操作时，我们有一组离散样本，因此我们必须使用*离散傅里叶变换*或 DFT。然而，这是一个相当慢的操作并且很容易优化，所以我们改为使用*快速傅里叶变换*算法或 FFT。

这是一个很大的信号处理主题，所以我建议你找一本信号处理书籍作为参考。我建议“数字信号处理：一种实用的方法”。当然还有无处不在的维基百科文章。

**2) FFT 的实现**

由于 FFT 平台和语言的高度优化特性通常具有特定的实现，因此您应该检查标题和文档（通常会在“音频”部分中找到）以防它包含在标准库中。

如果您想自己实现该算法，我建议您找到一份 Numerical Recipes 的副本，其中包含有关 FFT 的一整章，以及有关“傅立叶和光谱应用”的一章。有据可查的伪代码，应该很容易转录成任何语言。

对于第三方解决方案，一个流行的选择是 FFTW，一个 C 库。我在谷歌搜索“FFT 库”将为您提供一些替代方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-13T00:30:46.403

请参阅 sourceforge 上的 Kissfft。它缺乏一点 FFTW 的速度，但弥补了它的小尺寸和可读性。sourceforge 上还有一个关于推导的 pdf 文件——如果你想理解它，就需要它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T06:16:07.267

维基百科对 FFT 有很好的描述：[http](http://en.wikipedia.org/wiki/Fft) ://en.wikipedia.org/wiki/Fft 。

就实现而言，FFTW 是我用过的最快的，但是代码非常难以理解，因为它经过了疯狂的优化。有大量指向基本 FFT 实现的链接，包括 C# 中的大量链接；[谷歌](http://www.google.com/search?q=fft+c%23)是你的朋友。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T06:55:54.127

[http://www.cmlab.csie.ntu.edu.tw/cml/dsp/training/coding/transform/fft.html](http://www.cmlab.csie.ntu.edu.tw/cml/dsp/training/coding/transform/fft.html) （是的，我发现这很有用，但字体和布局很糟糕。我希望它只是我的浏览器很奇怪）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-26T06:57:51.050

数字运算的旧标准书：数字食谱，可能有足够的解释。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-26T07:19:44.970

如果你能找到一份副本，Hal Chamberlin 于 1983 年出版的《微处理器的音乐应用》（？）可能有一部分 FFT - 可惜我的副本现在正在工作，所以我无法专门查看这本书以了解 FFT 智慧。但我确实学习了许多音频滤波、采样等基础知识，并且有很多关于傅立叶变换及其用途的材料。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-26T05:09:20.537

谷歌出现了一些：

*   [外皮层DSP](http://www.exocortex.org/dsp/)

*   [FFTW](http://www.fftw.org/)（可以 [从 C# 调用的 C 库 DLL）](http://www.sdss.jhu.edu/~tamas/bytes/fftwcsharp.html)

建议使用 FFTW 库作为快速 FFT 的解决方案。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-26T05:46:56.763

这是另一个用 C 编写的。

[http://www.archelon.com/fft.html](http://www.archelon.com/fft.html)

另外，你能把你的问题说得更具体一些吗？例如，您想将 DFT 与 FFT 进行比较吗？您是否对 FFT 的速度如此之快感兴趣？

如果我没记错的话，DFT 类似于 N^2 次乘法，而 FFT 大约是 N log N 次乘法，其中 N 是信号中的样本数。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-12-07T21:36:32.413

问题在于将您的“好”一词解释为两种完全不同的事物。

快速的现代优化 FFT，例如 FFTW，对于解释正在发生的事情几乎没有用处。与基本的 FFT 算法相比，大部分代码通常是与编译器提示、流水线、并行性、缓存阻塞等有关的性能优化。

而 FFT 代码的一个很好的短（半页或更少的代码）递归示例可能看起来与 FFT 的（干净优雅的短）教科书推导之一的摘要完全相同，但与 FFTW 相比，它非常慢并且使用更多内存（或矢量化 pffft 等）。

# debugging - 有调试生产功能程序的实际经验吗？

> ID：393492
> 
> 赞同：16
> 
> 时间：2008-12-26T04:59:29.340
> 
> 标签：debugging, haskell, f#, functional-programming, scheme

我对用于诊断大型功能程序中的缺陷的工具和方法感兴趣。什么工具有用？我目前的理解是“printf”调试（例如添加日志记录和重新部署）是通常使用的。

如果你已经调试了一个功能系统，那么调试一个用 OO 或过程语言构建的系统有什么不同呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-26T07:22:03.780

遗憾的是，`printf`调试似乎是标准 ML、Objective Caml 和 Haskell 的实践状态。在交互式读取-评估-打印循环中进行了一些调试，但是一旦您的应用程序达到 25,000 或 50,000 行，就不太有用了。

如果你有幸使用 Haskell，**有一个例外**：[QuickCheck](http://www.cs.chalmers.se/~rjmh/QuickCheck/)对于测试和调试是*必不可少的。*QuickCheck 甚至可以用于 Haskell 和 C 代码的组合，正如使用[Xmonad 窗口管理器](http://xmonad.org/)的经验所证明的那样。

值得注意的是，大约在 1990 年，Andrew Tolmach 为新泽西的标准 ML 构建了一个非常好的时间旅行调试器，但它被认为不值得维护。还值得注意的是，OCaml 调试器（也是一种时间旅行调试器）曾经只在字节码上工作，这很不方便，并且拒绝违反抽象障碍，这使得它毫无用处。这大约是 3.07 版左右；也许情况有所改善。

同样在 1990 年代初期，Henrik Nilsson 为 Haskell 构建了一个有趣的调试器，但它所做的主要是防止调试器意外改变程序的评估行为。这很有趣，但仅适用于 lavzy-evaluation 小妞。

作为一个用所有这三种语言构建或工作过大型应用程序的人，**我发现游戏状态令人沮丧**。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-10T17:16:24.977

我们在工作中使用的主要工具（Haskell 商店）是：

1.  [快速检查](http://book.realworldhaskell.org/read/testing-and-quality-assurance.html)
2.  [HPC](http://projects.unsafeperformio.com/hpc/)：可视化 Haskell 程序覆盖工具（我们在内部开发）
3.  记录/printf/trace
4.  有时，[GHCI 调试器](http://www.haskell.org/ghc/docs/latest/html/users_guide/ghci-debugger.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-26T05:27:56.520

我目前的工作是实现新功能并支持用 ocaml 和 C# 实现的大型系统。大多数“逻辑”在 caml 中实现，GUI 和数据访问在 C# 中。调试技术与您描述的大量日志记录和断言非常相似，以找出问题所在。

此外，我们还有大量的单元测试，它们只是用于测试逻辑并帮助发现任何回归错误的 caml 脚本。

我们还使用持续集成来检查构建和运行夜间测试脚本，包括通过我们的“自动化”样式脚本界面对 GUI 进行一些自动化测试。

我经常使用 C# 调试器来调试应用程序的 C# 部分，ocaml 调试器在 windows 下仍然可以工作，所以我们不使用它。虽然我们希望有一天我们可以解决这个问题，但这并不是我们的首要任务。我偶尔使用 windbg 来调查托管和非托管内存问题，但结果证明这是由用 C# 实现的第三方组件引起的。

所以总的来说，没有什么不寻常的，但它似乎工作正常，我们没有看到太多的生产问题。

谢谢，罗伯

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-14T04:45:24.487

F# 具有 Visual Studio 集成，因此您可以将调试器附加到您的程序并设置断点、监视等，就像使用任何其他 .NET 语言一样。

但是，我更喜欢通过编写可以单独进行单元测试的简短函数来尽可能避免调试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-26T16:05:06.890

几年前，当我这样做时，我不得不结合使用 printf 调试和 QuickCheck。这些天我也会使用 ghci 内置调试​​器。

最让人头疼的其实是懒惰导致时空泄漏。这些似乎仍然没有一个好的答案：只需进行大量分析并继续尝试找出答案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T13:03:03.463

OCaml 和 F# 都有出色的调试器。OCaml 是时间可逆的。F# 具有出色的 IDE 和多线程支持。

# .net - 当我们将字节内容从 unicode 转换为 ansi 字符时如何删除 (?)

> ID：393495
> 
> 赞同：0
> 
> 时间：2008-12-26T05:03:02.810
> 
> 标签：.net, unicode, character-encoding

我需要将 unicode 字符转换为 ansi 字符

```
byte[] encode = Encoding.Convert(Encoding.Unicode, Encoding.Default, report); 
```

我使用这段代码。当我查看这个时，我发现了额外的？在第一部分添加字符

?FF EE 20 12

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T05:17:54.623

如果您发布输入字符串以及输出，这将很有帮助。

Encoding.Convert() 将输出一个“？” 当它试图转换在目标编码中没有对应字符的源中的字符时。

输出开头的序列看起来非常接近字节顺序标记 (BOM)。ANSI 代码页没有这些，因此如果您的 Unicode 流在开始时有 BOM，您可以尝试在将数据传递给转换器之前将其剥离。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T18:50:19.817

在这种特殊情况下，您的输入数据似乎包含不应该存在的内容（参见[迈克尔的回答](https://stackoverflow.com/questions/393495/how-to-remove-while-we-convert-our-byte-content-from-unicode-to-ansi-characte/393506#393506)）。

在一般情况下，在编码之间进行转换时，您可以使用**class****实现自己的编码回退机制[`EncoderReplacementFallback`](http://msdn.microsoft.com/en-us/library/system.text.encoderreplacementfallback.aspx)**。对于不受支持的字符，您可以轻松地将其返回为空。只需提供一个`Encoding`在转换时使用您的后备的。

# sql - Stackoverflow 的相关问题

> ID：393505
> 
> 赞同：3
> 
> 时间：2008-12-26T05:17:53.063
> 
> 标签：sql, algorithm, linq-to-sql

只是想知道您将如何实施类似于 stackoverflow 的相关问题。你会简单地匹配标签，匹配标题中的相似词，还是整个问题中的词？

对 linqtosql 方法特别感兴趣。

干杯!

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-26T06:08:08.217

在 Stackoverflow 的[播客 32](https://blog.stackoverflow.com/2008/12/podcast-32/)中，Jeff Atwood 讨论了“相关问题”功能的工作原理。我建议听听更多细节，但基本上他说这是比较问题标签、问题标题和问题文本的组合。

但是，他会提取所有问题的文本并删除前 10,000 个最常用的英语单词。剩下的基本上是与该问题相关的唯一单词，删除了所有填充英语。

因此，虽然我没有为您提供 linq-to-sql 信息，但希望这可以让您走上正轨。

# windows - CoTaskMemAlloc 的用法？

> ID：393509
> 
> 赞同：16
> 
> 时间：2008-12-26T05:26:56.117
> 
> 标签：windows, winapi, com

什么时候适合使用 CoTaskMemAlloc？有人可以举个例子吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2011-02-15T17:36:44.773

将本机 C++ 库中的 char* 作为字符串返回到 .NET 时使用 CoTaskMemAlloc。

C＃

```
[DllImport("test.dll", CharSet=CharSet.Ansi)]
extern static string Foo(); 
```

C

```
char* Foo()
{
    std::string response("response");
    int len = response.length() + 1;
    char* buff = (char*) CoTaskMemAlloc(len);
    strcpy_s(buff, len, response.c_str());
    return buff;
} 
```

[由于 .NET 使用 CoTaskMemFree](http://blogs.msdn.com/b/dsvc/archive/2009/06/22/troubleshooting-pinvoke-related-issues.aspx)，因此您必须像这样分配字符串，不能使用 malloc / new 在堆栈或堆上分配它。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-26T13:17:09.397

天哪，我不得不为此考虑一段时间——我已经使用 ATL 完成了大量的小型 COM 编程，并且很少需要使用它。

虽然想到了一种情况：[Windows Shell extensions](http://www.codeproject.com/KB/shell/namespcextguide1.aspx)。如果您正在处理一组文件系统对象，您可能必须处理[PIDL](http://msdn.microsoft.com/en-us/library/cc144090(VS.85).aspx#unknown_13653)（指向 ID 列表的指针）。这些是奇怪的小文件系统对象抽象，需要使用可识别 COM 的分配器（例如`CoTaskMemAlloc`. 还有另一种选择，[`IMalloc`](http://msdn.microsoft.com/en-us/library/ms678425(VS.85).aspx)从`SHGetMalloc`(deprecated) 获得的接口指针或`CoGetMalloc`-- 它只是一个要使用的抽象层，因此您的代码不绑定到特定的内存分配器，并且可以使用任何适当的内存分配器。

使用`CoTaskMemAlloc`or`IMalloc`而不是的要点`malloc()`是内存分配/释放需要是“COM 感知的”，以便在运行时一致地执行其分配和释放，即使分配和释放是由完全不相关的代码（例如，Windows 分配内存，将其传输到您的 C++ 代码，然后再解除分配，或者您的 C++ 代码分配，将其传输到其他人的 VB 代码，然后再解除分配）。两者都`malloc()`不能`new`与系统的运行时堆进行互操作，因此您不能使用它们来分配内存以传输给其他 COM 对象，或者从其他 COM 对象接收内存并取消分配。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-26T05:53:47.343

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa366533(VS.85).aspx)比较了一些由 Win32 公开的各种分配器，包括 CoTaskMemAlloc。它主要用于 COM 编程——尤其是当 COM 服务器的实现需要分配内存以返回给客户端时。如果您不编写 COM 服务器，那么您可能不需要使用它。

（但是，如果您调用使用 CoTaskMemAlloc 分配内存的代码并将其返回给您，则需要使用[CoTaskMemFree](http://msdn.microsoft.com/en-us/library/ms680722(VS.85).aspx)释放返回的分配。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-06-20T21:52:29.093

没有太多可能出错的地方，因为以下调用都以相同的分配结束：

```
CoTaskMemAlloc/SHAlloc -> IMalloc.Alloc -> GlobalAlloc(GMEM_FIXED) 
```

仅当您使用非 Windows（编译器库）调用`malloc()`时才会出错。

正式应该`CoTaskMemAlloc`用于 COM 调用（例如分配 FORMATETC.ptd 字段）

这`CoTaskMemAlloc`等于`GlobalAlloc()`将保持这种方式，直到在剪贴板 api 与 com STGMEDIUM 中看到永恒。STGMEDIUM 使用剪贴板结构和方法，而 STGMEDIUM 是 com，因此是 CoTaskMemAlloc，剪贴板 API 规定`GlobalAlloc()`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-29T15:31:27.593

CoTaskMemAlloc 与 malloc 相同，只是前者用于分配跨进程边界使用的内存。

即，如果我们有两个进程，process1 和process2，假设process1 是一个COM 服务器，而process2 是一个COM 客户端，它使用process1 公开的接口。如果 process1 必须发送一些数据，那么他可以使用 CoTaskMemAlloc 分配内存来分配内存并复制数据。process2 可以访问该内存位置。

COM 库自动进行编组和解组。

# java - 您会为全新项目推荐 Java/Glassfish/Metro 吗？

> ID：393510
> 
> 赞同：-1
> 
> 时间：2008-12-26T05:26:59.470
> 
> 标签：java, .net, wcf, glassfish, legacy

我在 ASP.NET 2.0 中开发了一段时间，而在 Java/Spring/Hibernate 中开发的时间略短。现在我开始开发新的网络服务并且对以下选择感到困惑：

.NET WCF 3.5 与 Java/Metro。

从一方面来看，WCF 似乎是一个出色开发的解决方案，一个软件框架的杰作，具有对函数式语言的所有支持、简单的向导、简单的体系结构。缺点是它似乎只在 Windows 上运行（Mono 不支持 WCF），并且没有与 Ruby on Rails 完美集成（通过 JRuby，就像 Java 那样）。

Java 似乎真的过时了——没有运算符重载或泛型数组？！

所以，我的主要问题是：**这里有人会使用 Java 开始一个新项目，还是它只是遗留软件的垂死语言？**

PS。性能*和数据库连接性**都是*主要优先事项，因此速度慢的 Perl、Ruby 或 Python 以及对数据库不友好的 C++ 都无从谈起。

 *聚苯乙烯。对于表示层，我使用的是 Ruby on Rails。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T14:04:32.530

如果您正在构建 Rails 应用程序，Glassfish 上的 JRuby 是一个成功的组合。我有五个 Rails 应用程序部署到 Glassfish，到目前为止我还没有遇到任何问题。我对性能印象深刻，部署非常简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T19:21:51.983

Java 世界中的大量活动。我与许多使用 Java 部署新项目的客户交谈。我还在 JRuby 和其他动态语言中看到了很多活动。查看 Tiobe 指数了解更多信息： [http ://www.tiobe.com/index.php/content/paperinfo/tpci/index.html](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)

至于 Metro，在 GlassFish 上，您可以从动态语言调用 Java 库（反之亦然），因此可以选择使用 Java、JRuby 等的 Project Metro。

GlassFish 集团产品经理 John Clingan

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T13:04:31.903

我认为你的观察是相当有偏见的。最主要的是需要。您是否需要通用数组来处理所有事情，或者您可以在没有通用数组的帮助的情况下有效地完成所有事情...... :) 而且 Java 并没有过时.. 它实际上是一个 GIANT。诉大巨人。这取决于您的项目，您将如何管理它以及您将运行哪些服务，正如您自己所说的 ROR。试一试Java，您肯定会生活在其中:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T13:10:52.357

我猜这两个建议都同样适合您的需求。因此，当您更熟悉 .NET 工具和库时，您应该坚持下去，因为学习两件（大约）相同的事情并没有太大价值。特别是当这些事情很复杂时。

# .net - 无法将服务引用添加到任何 WCF 服务

> ID：393524
> 
> 赞同：0
> 
> 时间：2008-12-26T05:50:35.960
> 
> 标签：.net, visual-studio, wcf, .net-3.5

我在 Vista 上的 .NET 3.5 SP1 上使用 Visual Studio 2008 SP1

每当我尝试向任何 WCF 服务添加服务引用时，我都会收到一条错误消息，提示“无法从程序集 'System.ServiceModel,Version=3.0.0.0, Culture=neutral, PublicKeyToken= 加载类型 'System.ServiceModel.FaultImportOptions' ……”

当我尝试连接到本地 WCF 服务或在 Internet 上运行的服务时，就会发生这种情况。

如果我创建空白的 WCF 服务库并点击运行，它会按预期显示 WCF 测试客户端，然后在其错误对话框中显示相同的错误。

我在谷歌上搜索了这个问题，发现有几个人提到了同样的问题，但没有一个有明确的解决办法。有些人建议卸载 .NET 3.5 并重新安装，我这样做了，但似乎没有帮助。

我什至卸载了 .NET 3.5 SP1 并将其替换为仅 .NET 3.5 并且仍然得到相同的行为。

我尝试卸载所有 .NET，但在卸载 3.5 后，我看不到卸载 .NET 3 或 2 的方法。它们出现在程序列表中，但没有卸载它们的选项。我发现[这篇](http://blogs.msdn.com/astebner/archive/2008/08/01/8803442.aspx)文章包含在 Vista 中将其全部删除的明确说明，但 .NET 2 和 3 中要删除的部分并未按所述显示。

所有其他 .NET 的东西似乎都可以正常工作。我没有遇到 ASP.NET 开发或其他任何问题 - 连接到 WCF 服务似乎是唯一的问题。不过，这也是我目前学习的重点。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-26T07:22:50.750

我通过重新安装 VS 2008 SP1 解决了这个问题。安装和重新启动后的东西似乎工作正常。

哇！

# java - 用 Java 开发游戏服务器的好工具/框架？

> ID：393528
> 
> 赞同：5
> 
> 时间：2008-12-26T05:57:57.740
> 
> 标签：java, frameworks

我正在为回合制游戏制作游戏服务器。不是基于 Web 的服务器，而是基于进程的服务器。我希望它具有可扩展性，并且我希望开发过程尽可能顺利。我已经很久没有使用过 Java，我需要提高自己的技能，所以我真的不知道那里有什么框架或工具。现在看起来我将使用[Terracotta](http://www.terracotta.org/web/display/orgsite/Home)，因为它具有集群功能。我只是想知道除此之外还有什么可以使开发基于 TCP 的游戏服务器更容易的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-27T14:41:58.757

您可能想看看[Project Darkstar](http://www.projectdarkstar.com/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T13:08:35.387

看看马拉罗亚。它是用于回合制游戏的客户端服务器框架。甚至还有一个基于它的 MORPG，将回合时间设置为只有 300 毫秒。

但它不是为集群支持而设计的。

[http://arianne.sf.net/wiki/index.php/Marauroa](http://arianne.sf.net/wiki/index.php/Marauroa)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T07:51:33.227

你看过[SmartFoxServer](http://www.smartfoxserver.com/)吗？它是 Java 并且已经支持[Terracotta](http://www.terracotta.org)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-07T07:13:39.093

无耻插件：这里是我写的一个[java游戏服务器](https://github.com/menacher/java-game-server)。支持UDP和TCP。jetserver 也有一个 java 客户端以及已经开发的 flash 动作脚本客户端。聚类尚未实现。

# javascript - 谷歌浏览器：JavaScript 错误消息

> ID：393529
> 
> 赞同：17
> 
> 时间：2008-12-26T05:58:26.133
> 
> 标签：javascript, google-chrome

使用 Google Chrome 时，我收到以下错误消息：

错误：

```
Uncaught SyntaxError: Unexpected token < 
```

它直接出现在我的 HTML 页面顶部的 doctype 声明之后

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

知道这个 JavaScript 错误消息是什么吗？它似乎只发生在 Google Chrome 上（在 Safari、Firfox 和 IE 中运行良好）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-02-26T14:27:15.440

当我使用 JQuery 从 HTML 的 XMLHTTPRequest 加载 HTML 时，我发生了这个问题，但 mime 类型是 text/javascript。

例如，我有一些代码，例如：

```
jQuery.ajax({
    data:'params=here',
    success:function(request) {
        jQuery('#country_list_container').html(request);
    },
    type:'get',
    url:'/getHtml'
}); 
```

jQuery 正在向 getHtml 发送请求，而 getHtml 正在返回一个简单的 HTML 片段，但 mime/type 为`"text/javascript"`. `getHtml`操作返回的原因`text/javascript`是来自 jQuery 的请求的接受标头是：

```
"Accept:text/javascript, text/html, application/xml, text/xml, */*" 
```

所以，我所要做的就是强制一个标题，`text/html`一切都很完美。

您看到的解析错误是 Javascript 尝试评估内容的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-02T23:31:30.903

就我而言，这是由`eval()`声明中止引起的。当我解决问题时，错误消息消失了。

目前（2010 年 6 月）Chrome Javascript 有一个错误的`eval()`声明。如果语句中的变量已分配保留字“ ” `eval()`，则将中止而不发出错误消息。我花了将近一周的时间才发现这个错误，因为中止没有任何警告或错误消息，而且中止有令人讨厌的副作用。`eval()``delete``eval()`

我是`eval()`用来实现这个结果的：obj.delete = somevalue。

此代码将导致 eval() 中止：

```
var obj = new Object();
var x = 'delete';
var y = 2;
eval('obj.' + x + ' = y'); 
```

此代码有效：

```
var obj = new Object();
var x = 'delete';
var y = 2;
eval('obj[\'' + x + '\'] = y'); 
```

总之，不要使用`eval()`来构造`obj.delete = somevalue`. 用于`eval()`构造等效语句`obj["delete"] = somevalue`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-08T06:01:24.137

尝试切换 css 和 js 声明的顺序。为我工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T07:09:27.237

也许 HTTP 内容类型不是`text/html`或`application/xhtml+xml`？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-26T07:09:59.200

我发现了这个 Google Groups 问题。

其他一些人遇到问题但没有解决方案。

[http://www.google.com/support/forum/p/Chrome/thread?tid=7e9f87870a37e401&hl=en](http://www.google.com/support/forum/p/Chrome/thread?tid=7e9f87870a37e401&hl=en)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-15T05:54:14.260

冒着挖掘旧线程的风险（我认为最好将所有信息保存在一个地方），Chrome 似乎仍在抛出这些错误。我在开发网站时得到了以下内容，并尝试使用页面 JS 和 PHP 来摆脱它。我得到的错误是：

```
error in event handler for 'undefined': SyntaxError: Unexpected token ILLEGAL
chrome/EventBindings:183 
```

最终，在 FireFox 中检查代码有效性时，我偶然发现了答案，作为警告，`'&'`在某些文本中应该转换为`'&amp;'`- 一旦完成，Chrome 错误就消失了。

史蒂夫

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-06-06T20:10:03.697

如果您以 JSON 格式返回对 ajax 请求的响应，请确保使用`'application/json'`Content-Type。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-29T14:53:21.707

如果它是 Rails 应用程序，请检查 format.js 是否在 response_to 块中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-23T21:56:52.587

当我尝试`.innerHTML`使用 php 设置动态生成时遇到了这个问题（它是多行生成的）。

用空格替换换行符解决了这个问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-31T00:42:29.460

我在 Chrome 开发工具中也遇到了这个错误，我的原因与 Matthew O'Riordan 的类似，只是它不是 Accept MIME 类型，而是损坏的 AJAX URL。

我重新排列了我的文件夹结构并忘记更新 URL；一旦我修复了 URL，Dev Tools JS 错误就消失了。希望这可以帮助！:)

# curl - 必须加载扩展文件“curl”

> ID：393532
> 
> 赞同：1
> 
> 时间：2008-12-26T06:04:55.837
> 
> 标签：curl, xampp

使用 XAMPP 1.6.7 我安装了 Magento 的社区版本。但是好像有问题。我收到错误消息“必须加载扩展文件“curl””。在另一台计算机上，一切似乎都很好。

（另一台计算机）
intel(R) Pentium(R) Dual CPU，E2140 @ 1.60Hz，
1.60 GHz。504 MB RAM
和 XP Professional 2002 sp2

我的计算机功能较弱（Inet Pentium 4 1.6 GHz。带有 sp2。）

请帮助我，谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-26T08:27:08.640

来自[http://www.menyhart.net/blog/developer-stuff/enabling-curl-on-xampp/](http://www.menyhart.net/blog/developer-stuff/enabling-curl-on-xampp/)

> 在“xampp-win32-1.6.2-installer.exe”上，您将有 4 个 php 文件要编辑：
> 
> C:\xampp\apache\bin\php.ini
> C:\xampp\php\php.ini
> C:\xampp\php\php4\php.ini
> C:\xampp\php\php4\php4.ini
> 
> 一次打开一个文件 使用“Notepad++” 按 Ctrl F 并搜索\查找“cUrl”，您将看到“;extension=php_curl.dll”，您所要做的就是删除“; ” 从所有 4 个文件中制作它们：
> extension=php_curl.dll 并重新启动 Xampp 服务器。现在卷曲支持将打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-29T09:02:31.960

谢谢您的帮助，

我使用的是 xampp 1.7.3，只需要编辑 C:\xampp\php\php.ini，它就可以工作。

不要忘记重新启动 xmapp。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T13:37:04.440

编辑 xampp/php/php.ini - 更改行：

```
;extension=php_curl.dll 
```

至

```
extension=php_curl.dll 
```

（只需删除行`;`前的）

请记住在尝试再次安装 Magento 之前重新启动服务器。

有关更多信息，请参阅： http: [//www.magentocommerce.com/wiki/general/installing_on_windows_with_xampp_and_wamp](http://www.magentocommerce.com/wiki/general/installing_on_windows_with_xampp_and_wamp)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-10T05:32:29.210

对于 XAMPP 1.7x 用户，只需要编辑一个文件。只需更改`php.ini`文件以取消注释并保存`;extension=php_curl.dll`即可。`extension=php_curl.dll`您还需要从 XAMPP 控制面板重新启动 Apache 服务器。

# robots.txt - Robots.txt 禁止一切，只允许站点/页面的特定部分。Ultraseek 和 FAST 等爬虫是否支持“允许”？

> ID：393539
> 
> 赞同：4
> 
> 时间：2008-12-26T06:15:11.357
> 
> 标签：robots.txt, fast-esp, ultraseek

只是想知道是否可以禁止整个网站供爬虫使用，只允许特定网页或部分？FAST 和 Ultraseek 等爬虫是否支持“允许”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-26T07:40:58.093

有一个[允许指令](http://en.wikipedia.org/wiki/Robots.txt#Allow_directive)，但不能保证特定的机器人会支持它（就像不能保证机器人甚至会检查你的 robots.txt 开始）。您可能可以通过检查您的博客来判断特定机器人是否仅索引您允许的网站部分。

仅允许网站的特定页面或部分的格式可能如下所示：

```
Allow: /public/section1/
Disallow: / 
```

这（应该）防止机器人抓取或索引除 /public/section1 下的内容之外的任何内容

# visual-studio - How Can I add additional functions to Visual Studio's Server Explorer?

> ID：393544
> 
> 赞同：1
> 
> 时间：2008-12-26T06:23:37.453
> 
> 标签：visual-studio, add-in

I am trying to write simple Visual Studio Add-In for code generation. In my solution explorer window there is a database connection an I want to get table names from this active connection.How can I do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T23:15:48.843

[Example](http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework.windowsforms/topic53084.aspx)

This looks to be what you need.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T10:10:30.487

I have done this using DDEX Designer. For more information you can see example from [Get data sources, data providers and data connections from a Visual Studio](http://www.mztools.com/articles/2007/MZ2007018.aspx)

# c# - 从 gridview 行获取总价格

> ID：393552
> 
> 赞同：0
> 
> 时间：2008-12-26T06:47:21.697
> 
> 标签：c#

我有一个 gridview (C#)，其中包含产品名称、产品价格、产品代码......在页面加载时，我需要将 n 行产品价格的总和添加到标签......（没有 sql数据库在这里）...任何人都可以帮助我...

谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-26T07:09:46.330

您必须遍历行并将其总结。类似于以下内容：

```
double Total = 0;
foreach(GridViewRow row in MyGridView.Rows)
    Total += Convert.ToDouble(row.Cells[PRICE_COLUMN].Text); 
```

# python - Python sqlite3 和并发

> ID：393554
> 
> 赞同：96
> 
> 时间：2008-12-26T06:51:54.713
> 
> 标签：python, sqlite

我有一个使用“线程”模块的 Python 程序。每秒一次，我的程序启动一个新线程，从网络上获取一些数据，并将这些数据存储到我的硬盘驱动器中。我想使用 sqlite3 来存储这些结果，但我无法让它工作。问题似乎与以下行有关：

```
conn = sqlite3.connect("mydatabase.db") 
```

*   如果我将这行代码放在每个线程中，我会收到一个 OperationalError 告诉我数据库文件已锁定。我想这意味着另一个线程通过 sqlite3 连接打开了 mydatabase.db 并锁定了它。
*   如果我将这行代码放在主程序中，并将连接对象（conn）传递给每个线程，我会得到一个 ProgrammingError，说在一个线程中创建的 SQLite 对象只能在同一个线程中使用。

以前我将所有结果存储在 CSV 文件中，并且没有任何这些文件锁定问题。希望这可以通过 sqlite 实现。有任何想法吗？

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2010-05-24T05:03:46.793

与流行的看法相反，较新版本的 sqlite3**确实**支持从多个线程进行访问。

这可以通过可选的关键字参数启用`check_same_thread`：

```
sqlite.connect(":memory:", check_same_thread=False) 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-12-26T07:10:39.340

您可以使用消费者-生产者模式。例如，您可以创建线程之间共享的队列。从 Web 获取数据的第一个线程将这些数据排入共享队列。另一个拥有数据库连接的线程从队列中取出数据并将其传递给数据库。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-04-05T12:41:29.853

[在mail.python.org.pipermail.1239789](http://mail.python.org/pipermail/python-list/2010-March/1239789.html) 上找到的以下内容

我找到了解决方案。我不知道为什么 python 文档没有关于这个选项的一个字。所以我们必须向连接函数添加一个新的关键字参数，我们将能够在不同的线程中创建游标。所以使用：

```
sqlite.connect(":memory:", check_same_thread = False) 
```

非常适合我。当然，从现在开始，我需要注意对数据库的安全多线程访问。无论如何，感谢所有试图提供帮助的人。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-12-26T16:51:24.347

切换到[多处理](http://docs.python.org/library/multiprocessing.html)。它要好得多，可扩展性好，可以通过使用多个CPU来超越使用多核，并且接口与使用python线程模块相同。

或者，正如阿里建议的那样，只使用[SQLAlchemy 的线程池机制](http://www.sqlalchemy.org/docs/05/reference/sqlalchemy/pooling.html#sqlalchemy.pool.SingletonThreadPool)。它将自动为您处理所有事情，并具有许多额外的功能，仅引用其中一些：

1.  SQLAlchemy 包括 SQLite、Postgres、MySQL、Oracle、MS-SQL、Firebird、MaxDB、MS Access、Sybase 和 Informix 的方言；IBM 还发布了一个 DB2 驱动程序。因此，如果您决定离开 SQLite，则不必重写您的应用程序。
2.  工作单元系统是 SQLAlchemy 的对象关系映射器 (ORM) 的核心部分，它将挂起的创建/插入/更新/删除操作组织到队列中，并在一批中将它们全部刷新。为了实现这一点，它对队列中的所有修改项执行拓扑“依赖排序”，以遵守外键约束，并将冗余语句组合在一起，有时它们可​​以被进一步批处理。这产生了最大的效率和交易安全，并最大限度地减少了死锁的机会。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-12-26T21:59:14.520

您根本不应该为此使用线程。[这对twisted](http://twistedmatrix.com/)来说是一项微不足道的任务，无论如何这可能会让你走得更远。

只使用一个线程，并让请求完成触发一个事件来进行写入。

twisted 会为您处理日程安排、回调等。它会将整个结果作为字符串传递给您，或者您可以通过流处理器运行它（我有一个[twitter API](https://github.com/dustin/twitty-twister)和一个[friendfeed API](https://github.com/dustin/twisted-friends)，它们都会在结果仍在下载时向调用者触发事件）。

根据您对数据的处理方式，您可以将完整的结果转储到 sqlite 中，在完成时将其转储并转储，或者在读取数据的同时将其转储并在最后转储。

我有一个非常简单的应用程序，它做的事情接近你在 github 上想要的。我称之为[pfetch](https://github.com/dustin/pfetch)（并行获取）。它按计划抓取各种页面，将结果流式传输到文件，并在成功完成每个页面后可选择运行脚本。它还做了一些花哨的东西，比如条件 GET，但仍然可以作为你正在做的任何事情的一个很好的基础。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-12-26T18:31:37.843

或者如果你像我一样懒惰，你可以使用[SQLAlchemy](http://www.sqlalchemy.org/)。它将为您处理线程（[使用线程本地和一些连接池](http://www.sqlalchemy.org/docs/05/reference/sqlalchemy/pooling.html#sqlalchemy.pool.SingletonThreadPool)），它的处理方式甚至是[可配置](http://www.sqlalchemy.org/docs/05/reference/dialects/sqlite.html#threading-behavior)的。

为了额外的好处，如果/当您意识到/决定将 Sqlite 用于任何并发应用程序将是一场灾难，您将不必更改代码以使用 MySQL、Postgres 或其他任何东西。你可以直接切换。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-07-18T15:24:57.540

您需要在对数据库的*每个事务*`session.close()`之后使用，以便在同一个线程中使用相同的游标，而不是在导致此错误的多线程中使用相同的游标。

 ** * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-08-19T18:49:37.413

使用[threading.Lock()](http://docs.python.org/library/threading.html#lock-objects)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-05-01T07:17:50.807

我在上述任何答案中都找不到任何基准，因此我编写了一个测试来对所有内容进行基准测试。

我尝试了 3 种方法

1.  从 SQLite 数据库顺序读取和写入
2.  使用 ThreadPoolExecutor 读/写
3.  使用 ProcessPoolExecutor 读/写

基准测试的结果和要点如下

1.  顺序读取/顺序写入效果最好
2.  如果一定要并行处理，使用ProcessPoolExecutor并行读取
3.  不要使用 ThreadPoolExecutor 或 ProcessPoolExecutor 执行任何写入，因为您将遇到数据库锁定错误，您将不得不重新尝试再次插入块

您可以在我的 SO 答案中找到基准测试的代码和完整解决方案，希望对您有所帮助[！](https://stackoverflow.com/questions/524797/python-sqlite-and-threading)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-26T12:51:53.410

我喜欢 Evgeny 的回答 - 队列通常是实现线程间通信的最佳方式。为了完整起见，这里有一些其他选项：

*   当生成的线程完成使用它时关闭数据库连接。这将解决您的问题`OperationalError`，但由于性能开销，像这样打开和关闭连接通常是不可以的。
*   不要使用子线程。如果每秒一次的任务是相当轻量级的，你可以做 fetch 和 store，然后睡到合适的时刻。这是不可取的，因为获取和存储操作可能需要超过 1 秒的时间，并且您会失去使用多线程方法所拥有的多路复用资源的好处。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-26T19:32:37.390

您需要为您的程序设计并发性。SQLite 有明确的限制，您需要遵守它们，请参阅[常见问题解答](http://sqlite.org/faq.html#q5)（也是以下问题）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-28T05:55:27.180

[Scrapy](http://dev.scrapy.org/)似乎是我问题的潜在答案。它的主页描述了我的确切任务。（虽然我不确定代码有多稳定。）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-11-28T20:39:23.337

我会看一下用于数据持久性的 y_serial Python 模块：http: [//yserial.sourceforge.net](http://yserial.sourceforge.net)

它处理围绕单个 SQLite 数据库的死锁问题。如果对并发性的需求变得很重，可以轻松地设置许多数据库的类 Farm 来分散随机时间的负载。

希望这对您的项目有所帮助......它应该足够简单，可以在 10 分钟内实施。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2013-11-08T13:33:32.433

您收到锁定数据库错误的最可能原因是您必须发出

```
conn.commit() 
```

完成数据库操作后。如果不这样做，您的数据库将被写锁定并保持这种状态。等待写入的其他线程将在一段时间后超时（默认设置为 5 秒，有关详细信息，请参阅[http://docs.python.org/2/library/sqlite3.html#sqlite3.connect](http://docs.python.org/2/library/sqlite3.html#sqlite3.connect)） .

正确和并发插入的示例如下：

```
import threading, sqlite3
class InsertionThread(threading.Thread):

    def __init__(self, number):
        super(InsertionThread, self).__init__()
        self.number = number

    def run(self):
        conn = sqlite3.connect('yourdb.db', timeout=5)
        conn.execute('CREATE TABLE IF NOT EXISTS threadcount (threadnum, count);')
        conn.commit()

        for i in range(1000):
            conn.execute("INSERT INTO threadcount VALUES (?, ?);", (self.number, i))
            conn.commit()

# create as many of these as you wish
# but be careful to set the timeout value appropriately: thread switching in
# python takes some time
for i in range(2):
    t = InsertionThread(i)
    t.start() 
```

如果你喜欢 SQLite，或者有其他使用 SQLite 数据库的工具，或者想用 SQLite db 文件替换 CSV 文件，或者必须做一些罕见的事情，比如跨平台 IPC，那么 SQLite 是一个很棒的工具，非常适合这个目的。如果感觉不对，不要让自己被迫使用不同的解决方案！

# arrays - 何时在数组/数组列表上使用链表？

> ID：393556
> 
> 赞同：223
> 
> 时间：2008-12-26T06:52:53.057
> 
> 标签：arrays, list, arraylist, linked-list

我使用了很多列表和数组，但我还没有遇到过这样的场景：数组列表不能像使用链表一样容易，如果不是更容易的话。我希望有人能给我一些链接列表何时明显更好的例子。

* * *

## 回答 #1

> 赞同：304
> 
> 时间：2008-12-26T07:12:04.860

**在以下情况下，链表优于数组：**

1.  您需要从列表中进行恒定时间的插入/删除（例如在时间可预测性绝对关键的实时计算中）

2.  您不知道列表中有多少项目。使用数组，如果数组变得太大，您可能需要重新声明和复制内存

3.  您不需要随机访问任何元素

4.  您希望能够在列表中间插入项目（例如优先级队列）

**在以下情况下最好使用数组：**

1.  您需要对元素进行索引/随机访问

2.  您提前知道数组中的元素数量，以便为数组分配正确的内存量

3.  按顺序遍历所有元素时，您需要速度。您可以在数组上使用指针数学来访问每个元素，而您需要根据链表中每个元素的指针来查找节点，这可能会导致页面错误，从而导致性能下降。

4.  记忆是一个问题。填充数组比链表占用更少的内存。数组中的每个元素只是数据。每个链表节点都需要数据以及一个（或多个）指向链表中其他元素的指针。

数组列表（如 .Net 中的那些）为您提供数组的好处，但为您动态分配资源，因此您无需过多担心列表大小，您可以轻松删除任何索引处的项目或重新洗牌周围的元素。在性能方面，arraylists 比原始数组慢。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2008-12-26T07:08:06.723

数组有 O(1) 的随机访问，但是添加东西或从中删除东西真的很昂贵。

链表在任何地方添加或删除项目并进行迭代真的很便宜，但随机访问是 O(n)。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2017-08-01T08:52:25.423

```
Algorithm           ArrayList   LinkedList
seek front            O(1)         O(1)
seek back             O(1)         O(1)
seek to index         O(1)         O(N)
insert at front       O(N)         O(1)
insert at back        O(1)         O(1)
insert after an item  O(N)         O(1) 
```

ArrayLists 适用于一次写入多次读取或附加程序，但不适合从前面或中间添加/删除。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-12-26T09:13:52.273

为了补充其他答案，大多数数组列表实现在列表末尾保留额外容量，以便可以在 O(1) 时间内将新元素添加到列表末尾。当超出数组列表的容量时，会在内部分配一个新的更大的数组，并复制所有旧元素。通常，新数组的大小是旧数组的两倍。这意味着在这些实现中*，平均而言*，将新元素添加到数组列表的末尾是一个 O(1) 操作。所以即使你事先不知道元素的个数，数组列表在添加元素方面可能仍然比链表更快，只要你在最后添加它们。显然，在数组列表的任意位置插入新元素仍然是 O(n) 操作。

访问数组列表中的元素也比链表更快，即使访问是顺序的。这是因为数组元素存储在连续的内存中并且可以轻松缓存。链表节点可能分散在许多不同的页面上。

如果您知道要在任意位置插入或删除项目，我建议仅使用链表。几乎所有其他事情，数组列表都会更快。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-26T07:07:49.517

如果您需要在中间插入项目并且不想开始调整数组大小和移动东西，那么列表的优势就会出现。

你是对的，通常情况并非如此。我遇到过一些非常具体的案例，但不是太多。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-04-16T09:32:25.883

这完全取决于您在迭代时执行的操作类型，所有数据结构都在时间和内存之间进行权衡，并且根据我们的需要，我们应该选择正确的 DS。所以在某些情况下，LinkedList 比数组更快，反之亦然。考虑数据结构的三个基本操作。

*   **搜索**

由于数组是基于索引的数据结构搜索 array.get(index) 将花费 O(1) 时间，而 linkedlist 不是索引 DS 所以你需要遍历 index ，其中 index <=n ， n 是链表的大小，所以当随机访问元素时，数组比链表更快。

*Q.那么这背后的美丽是什么？*

由于数组是连续的内存块，它们中的大块将在第一次访问时加载到缓存中，这使得访问数组的剩余元素相对较快，就像我们访问数组中的元素一样，引用的局部性也会增加，因此捕获较少未命中，缓存局部性是指在缓存中的操作，因此与在内存中相比执行得更快，基本上在数组中，我们最大化了顺序元素访问在缓存中的机会。虽然链接列表不一定在连续的内存块中，但不能保证在列表中顺序出现的项目实际上在内存中彼此靠近排列，这意味着更少的缓存命中，例如

*   **插入**

这在 LinkedList 中既简单又快速，因为与数组相比，LinkedList（在 Java 中）中的插入是 O(1) 操作，考虑数组已满的情况，如果数组已满，我们需要将内容复制到新数组，这使得插入在最坏的情况下，将元素放入 O(n) 的 ArrayList 中，而 ArrayList 还需要更新其索引，如果您在除数组末尾之外的任何位置插入内容，则在链表的情况下，我们不需要调整它的大小，您只需要更新指针。

*   **删除**

它像插入一样工作，并且在 LinkedList 中比数组更好。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-07-04T13:26:41.007

这些是 Collection 最常用的实现。

**数组列表：**

*   在末尾插入/删除通常 O(1) 最坏情况 O(n)

*   在中间插入/删除 O(n)

*   检索任何位置 O(1)

**链表：**

*   在任何位置插入/删除 O(1) （注意是否有对元素的引用）

*   在中间检索 O(n)

*   检索第一个或最后一个元素 O(1)

矢量：不要使用它。这是一个类似于 ArrayList 的旧实现，但所有方法都是同步的。这不是多线程环境中共享列表的正确方法。

**哈希映射**

在 O(1) 中按键插入/删除/检索

**TreeSet** 插入/删除/包含在 O(log N) 中

**HashSet** 在 O(1) 中插入/删除/包含/大小

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-06-07T04:46:35.613

实际上，内存局部性在实际处理中具有巨大的性能影响。

在“大数据”处理与随机访问中，磁盘流的使用越来越多，这表明围绕它构建应用程序可以显着提高更大范围内的性能。

如果有任何方法可以按顺序访问数组，那是迄今为止性能最好的。如果性能很重要，那么至少应该考虑以此为目标进行设计。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-26T07:28:20.257

嗯，我猜 Arraylist 可以用于以下情况：

1.  你不确定会有多少元素出现
2.  但是您需要通过索引随机访问所有元素

例如，您需要导入和访问联系人列表中的所有元素（您不知道其大小）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-24T15:30:52.523

使用链表对数组进行基数排序和多项式运算。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-09-05T12:01:21.537

1) 如上所述，与 ArrayList(O(n)) 相比，LinkedList 中的插入和删除操作提供了良好的性能 (O(1))。因此，如果应用中需要频繁的增删改查，那么LinkedList是最好的选择。

2）搜索（get方法）操作在Arraylist（O（1））中很快，但在LinkedList（O（n））中不快，所以如果添加和删除操作较少，搜索操作要求较多，ArrayList将是您的最佳选择。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-01-31T16:00:36.147

我认为主要区别在于您是否经常需要从列表顶部插入或删除内容。

对于数组，如果从列表顶部删除某些内容，则复杂度为 o(n)，因为数组元素的所有索引都必须移动。

对于链表，它是 o(1)，因为您只需要创建节点，重新分配头并将对 next 的引用分配为前一个头。

在列表末尾频繁插入或删除时，数组更可取，因为复杂度将是 o(1)，不需要重新索引，但对于链表，它将是 o(n)，因为您需要从头开始到最后一个节点。

我认为在链表和数组中搜索都将是 o(log n)，因为您可能会使用二进制搜索。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-05-08T13:33:08.943

我做了一些基准测试，发现列表类在随机插入方面实际上比 LinkedList 更快：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            int count = 20000;
            Random rand = new Random(12345);

            Stopwatch watch = Stopwatch.StartNew();
            LinkedList<int> ll = new LinkedList<int>();
            ll.AddLast(0);
            for (int i = 1; i < count; i++)
            {
                ll.AddBefore(ll.Find(rand.Next(i)),i);

            }
            Console.WriteLine("LinkedList/Random Add: {0}ms", watch.ElapsedMilliseconds);

            watch = Stopwatch.StartNew();
            List<int> list = new List<int>();
            list.Add(0);
            for (int i = 1; i < count; i++)
            {
                list.Insert(list.IndexOf(rand.Next(i)), i);

            }
            Console.WriteLine("List/Random Add: {0}ms", watch.ElapsedMilliseconds);

            Console.ReadLine();
        }
    }
} 
```

链表需要 900 毫秒，列表类需要 100 毫秒。

它创建后续整数的列表。每个新整数都插入到列表中已经存在的随机数之后。也许 List 类使用了比数组更好的东西。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-02-13T15:00:20.477

到目前为止，数组是使用最广泛的数据结构。然而，链表以其独特的方式证明是有用的，其中数组是笨拙的——或者至少可以说是昂贵的。

链表对于在大小可变的情况下实现堆栈和队列很有用。链表中的每个节点都可以在不干扰大多数节点的情况下被推送或弹出。在中间某处插入/删除节点也是如此。然而，在数组中，所有元素都必须移动，这在执行时间方面是一项昂贵的工作。

二叉树和二叉搜索树、哈希表和尝试是其中的一些数据结构 - 至少在 C 中 - 您需要链表作为构建它们的基本成分。

但是，在期望能够通过索引调用任意元素的情况下，应避免使用链表。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-07-06T17:45:18.567

可以使用以下几点给出该问题的简单答案：

1.  当需要类似类型的数据元素的集合时，将使用数组。而链表是称为节点的混合类型数据链接元素的集合。

2.  在数组中，可以在 O(1) 时间内访问任何元素。而在链表中，我们需要花费 O(n) 时间从头到所需节点遍历整个链表。

3.  对于数组，最初需要声明一个特定的大小。但是链表的大小是动态的。

# wcf - 没有 SSL 的 WCF 身份验证

> ID：393580
> 
> 赞同：16
> 
> 时间：2008-12-26T07:15:28.097
> 
> 标签：wcf, security, rest, ssl

有没有办法在不实际设置 SSL 证书的情况下设置身份验证（ala“基本身份验证”）？我也想在 REST 或常规 SOAP WCF 服务中执行此操作，最好是在 REST 中，但希望能够混合这些服务。换句话说，“我希望能够发送一个常规的旧用户名和密码，就像在基本身份验证中一样，但没有 SSL。” 有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-26T12:49:07.970

使用 TransportCredentialOnly 安全模式。这篇文章解释了如何做到这一点：

[http://developers.de/blogs/damir_dobric/archive/2006/07/31/890.aspx](http://developers.de/blogs/damir_dobric/archive/2006/07/31/890.aspx)。

不要忘记您还必须在 IIS 中启用基本身份验证。

# java - 如何在 Java 中准备 SQL 查询时设置整数列表

> ID：393595
> 
> 赞同：3
> 
> 时间：2008-12-26T07:41:56.080
> 
> 标签：java, mysql, prepared-statement

我有这样的查询 - select * from tbl where ... and colname in (2,3,4)

当我在 Java 中使用 PreparedStatement 准备查询（... ' colname in (?)' ）时，我应该调用什么 setter 方法来设置这些整数？整数在 int 数组中可用，并且大小不同。如果重要的话，数据库是 MySQL 并且有问题的列是 int 类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-26T08:08:42.140

你可以使用另一种语法

```
WHERE colname = ANY (?) 
```

并调用 PreparedStatement.setArray()。您必须提供 java.sql.Array 的实例作为参数。ANY 代替 IN 的一个优点是，您可以传递一个空数组而不会导致 SQL 语法错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T01:31:28.683

作为学习解释的附录：

创建一个数组可能很棘手。

JDK 1.6 及更高版本的 Connection 中有一个 creator 方法。 [http://download.java.net/jdk7/docs/api/java/sql/Connection.html#createArrayOf(java.lang.String,%20java.lang.Object[])](http://download.java.net/jdk7/docs/api/java/sql/Connection.html#createArrayOf(java.lang.String,%20java.lang.Object[]))

由于 JDK1.6 是最新的稳定版本，您的 JDBC 驱动程序可能不支持它。

您可以尝试创建自己的 Array 实现，但这可能不适用于所有 JDBC 连接器实现。

# php - PHP UML 生成器

> ID：393603
> 
> 赞同：114
> 
> 时间：2008-12-26T08:00:08.523
> 
> 标签：php, uml, class-diagram

如何根据 PHP 中的现有类生成 UML 图？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-26T17:24:01.323

[pear](http://pear.php.net/package/PHP_UML/)还提供了 PHP UML 工具。

PHP_UML：

*   可以在 1.4 版或 2.1 版（逻辑、组件和部署视图）中生成 UML/XMI 文件
*   可以生成 HTML 格式的 API 文档
*   可以从给定的 XMI 文件生成 PHP 代码（代码骨架）
*   可以将 UML/XMI 内容从 1.4 版转换到 2.1 版

通过以下方式在命令行上安装它：

`$ pear install pear/php_uml`

（这曾经是，`$ pear install pear/php_uml-alpha`但包已经稳定了。）

生成你的 xmi：

`$ phpuml -o project.xmi`

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-05-19T20:24:11.350

我强烈推荐[BOUML](http://www.bouml.fr/)，它：

*   速度极快（有史以来最快的 UML 工具，查看[基准测试](http://www.bouml.fr/benchmark.html)），
*   具有坚如磐石的**PHP 导入和导出**支持（也支持 C++、Java、Python）
*   是多平台（Linux、Windows、其他操作系统），
*   功能齐全，令人印象深刻的密集开发（看看[发展历史](http://www.bouml.fr/historic.html)，很难相信如此快速的进步是可能的）。
*   支持插件，具有模块化架构（这允许[用户贡献](http://www.bouml.fr/contrib.html)，看起来 BOUML 社区正在形成）

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-12-11T18:12:39.460

# **[PHUML](https://github.com/jakobwesthoff/phuml)**

> phUML 是用 PHP 编写的全自动 UML 类图表生成器，在 BSD 许可下获得许可。它能够解析任何 PHP5 面向对象的源代码，并根据 UML 规范创建 oo 结构的适当图像表示。

![UML 示例](https://i.stack.imgur.com/rTSYH.jpg)

```
./phuml -r /var/www/my_project -graphviz -createAssociations false -neato out.png 
```

[分步指南](http://dasunhegoda.com/class-diagram-from-php-code-using-phuml/867/)

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-04-15T10:27:45.667

我发现做 PHP 和 UML 的最好的（Windows）软件是[Sparx Systems](http://www.sparxsystems.com.au/) [Enterprise Architect](http://www.sparxsystems.com.au/products/ea/index.html)。除了众多的[功能](http://www.sparxsystems.com.au/products/ea/features.html)外，它还支持PHP的[以下功能：](http://www.sparxsystems.com.au/platforms/php_uml.html)

*   将面向对象的 PHP 逆向工程为 UML 类图
*   从 UML 类图生成 PHP 类定义
*   将 UML 类中所做的更改同步到相应的 PHP 类定义中
*   将 PHP 类定义中所做的更改同步到相应的 UML 类中
*   创建 UML 序列图以显示 PHP 类使用什么以及如何使用它们
*   以标准 RTF 和 HTML 格式生成 PHP 代码的详细文档
*   对模型执行代码工程以生成基础 PHP 页面。

不是免费的（199 美元），但绝对物有所值。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-27T16:46:35.883

还有[php2xmi](http://tech.motion-twin.com/php_php2xmi.html)。您必须做一些手动工作，但它会生成所有类，因此您只需将它们拖到[Umbrello](http://uml.sourceforge.net/)中的类图中即可。

否则，使用反射和 graphviz 生成图表相当简单。我[在这里](https://github.com/troelskn/konstrukt/blob/master/script/docs_api.php)有一个片段，您可以将其用作起点。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-12-26T08:46:29.927

你试过[Autodia](http://www.aarontrevena.co.uk/opensource/autodia/)了吗？上次我尝试它并不完美，但已经足够好了。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-12-14T08:32:28.337

我是这样做的（直接从代码到 PDF 绘图，无需手动绘制任何东西）：

1.  使用[BOUML](http://bouml.free.fr/)进行“逆向工程 PHP 代码”[原文如此] 以提取类模型（BOUML 可从 Ubuntu 的“universe”存储库中获得）。这一步我强烈推荐 BOUML，因为与我尝试过的许多其他程序相比，它真的很快。此外，BOUML 似乎正确地提取了模型（对于 BOUML 甚至试图提取的部分）。
2.  使用 BOUML 将模型导出为 XMI 1.4 文件
3.  使用[ArgoUML](http://argouml.tigris.org/)导入上述 XMI 文件（此步骤可以使用 webstart 版本）
4.  从 ArgoUML 导出 XMI（我不知道输出是哪个 XMI 版本/变体，但它与 BOUML 的输出结果不同。argouml-graphviz 无法直接从 BOUML 处理 XMI 文件）。
5.  使用[argouml-graphviz](http://argouml-graphviz.tigris.org/)将 ArgoUML 导出的 XMI 文件转换为点格式（由于使用 XSLT2，您可能需要使用[saxon](http://saxon.sourceforge.net/)而不是 xsltproc 才能使其工作）
6.  使用[dot](http://www.graphviz.org/category/graphviz-terms/dot)或[fdp](http://www.graphviz.org/category/graphviz-terms/fdp)或[sfdp](http://www.graphviz.org/category/graphviz-terms/sfdp)来呈现类图。

下面是使用 fdp 输出 PDF 图表的合适命令行示例（假设 argouml-graphviz XLST 处理生成的 dot 文件保存为 xmi-model.dot）：

```
fdp -Tpdf -Gmaxiter=1000 -Gmindist=0.5 -Gpackmode=node \
  -Eweight=0.05 -Elen=1.0 -Eminlen=1.0 -Gsplines=true \
  -Goverlap=false xmi-model.dot -oxmi-model.pdf 
```

作为替代方案，您可以尝试[PHP_UML](http://pear.php.net/package/PHP_UML/)或[php2xmi](http://tech.motion-twin.com/php_php2xmi.html)而不是 BOUML 来执行“逆向工程”部分。我还没有尝试过。

（我使用“逆向工程”这个短语，因为似乎 UML 人在使用这些词的意思是从*源代码*中提取类和方法信息时。我个人会将这些词解释为从可执行二进制文件中提取信息或捕获的原始信息线数据。）

如果您更喜欢手工绘制类图（而不是使用计算机完成所有绘图），您可以使用 BOUML 或 ArgoUML 进行绘图。在这种情况下，通过 BOUML 使用“逆向工程”数据将有所帮助。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-12-14T18:20:58.837

如果您希望从现有的 PHP 类轻松生成 UML，您可能需要考虑 PHPStorm 3.0 IDE。它在将现有代码复制到 UML 方面做得很好。

查看[PHP Storm 功能列表](http://www.jetbrains.com/phpstorm/whatsnew/)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-10-10T13:35:46.977

理论上，您可以使用 PhpStorm 使用 UML 可视化您的类。这一代不是很好，但你可以有效地重构东西，至少以一种很好的方式预览父级、实现、常量、属性、方法和它们的可见性。

**情况**

我想将现有组件之间的通信可视化给同事。

**使用 PHPStorm 处理**

[https://blog.jetbrains.com/phpstorm/2017/09/uml-diagrams-in-phpstorm-2017-2/](https://blog.jetbrains.com/phpstorm/2017/09/uml-diagrams-in-phpstorm-2017-2/)

**优点**

*   漂亮的用户界面，最终图表。
*   能够从图表重构代码。
*   可以添加注释。
*   类图很好地象征了私有/公共属性、构造函数、方法。

**缺点**

*   不支持 PHP 7。
*   痛苦地使用。无法调整生成的框的大小。
*   添加新关系时，以前的关系会随机丢失：O wtf？
*   重新启动 PhpStorm 会破坏图表
*   改变主意，无法使用关系

**结果**

无论如何，经过一段痛苦的工作后，我只能生成不相关的框，并且不得不使用额外的程序来链接关系。特别糟糕。但我相信一旦他们让它正常工作，这将是一个很棒的功能，因为随着代码的变化，图表会自动更新！

**目前，不要将 PhpStorm 用于 UML 图。**

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-02-07T08:11:13.950

您可以将 Visual Paradigm 用于 UML。这可能不是收入最高（699 美元）的产品，如果有人想尝试，这只是一个选择。它可以从 PHP 创建类图，反之亦然，不仅是 PHP，还有很多语言可供选择，例如 C#、C++、Ruby、Java、VB.NET、Python、Objective C、Perl 等。还有一个试用版可以查看。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-07-08T16:08:05.533

老实说，首先你不应该从代码生成 UML 模型，而是从 UML 模型生成代码；）。

即使您在极少数情况下，当您需要进行逆向工程时，通常建议您手动完成或至少整理图表，因为自动生成的 UML 的视觉效果非常差（=信息）大部分时间都很有价值。

如果您只需要生成图表，最好问问自己为什么？谁是目标受众，目标是什么？自动生成的图表必须提供什么，哪些代码没有？

基本上我只接受这个问题的一个答案。它只是变得太大而且难以理解。

这也是首先从 UML 开始的一个原因，而不是开始编码；）它被称为分析，而且它正在下降，因为每个业务人员都认为它有点太贵了，而且没有必要。

# javascript - Javascript 下拉菜单

> ID：393616
> 
> 赞同：1
> 
> 时间：2008-12-26T08:29:45.950
> 
> 标签：javascript, drop-down-menu, overflow

我使用 JavaScript 做了一个下拉菜单，鼠标悬停在下拉菜单中。现在，由于我在侧边菜单中使用它，我希望当我越过下拉菜单时，而不是下拉项目越过下方的项目，我希望下方的项目向下移动以腾出空间。

我设法通过删除 CSS 中的溢出来实现这一点，但问题是当我进入网页时，下拉菜单会完全展开，直到我用鼠标越过它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-26T11:35:44.640

将溢出：隐藏在 CSS 中。

当您希望菜单出现时添加到元素 style.overflow = "visible" 并在希望再次隐藏时在元素上使用 style.overflow = "hidden" 或 style.overflow=""。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T15:54:55.443

您需要获取/计算下拉层的高度（假设它在不同的层中）并将此高度添加到底层菜单项框元素（当然检查下拉是否可见）。

# unit-testing - RSpec vs Cucumber（RSpec 故事）

> ID：393622
> 
> 赞同：136
> 
> 时间：2008-12-26T08:41:24.447
> 
> 标签：unit-testing, rspec, cucumber, integration-testing, rspec-stories

我什么时候应该为 Rails 应用程序使用规范，什么时候应该使用 Cucumber（以前的 rspec-stories）？当然，我知道规范的工作方式和积极使用规范的方式。但是使用 Cucumber 仍然感觉很奇怪。我目前对此的看法是，当您为客户端实现应用程序并且还不了解整个系统应该如何工作时，使用 Cucumber 很方便。

但是如果我在做自己的项目呢？大多数时候，我知道系统的各个部分是如何交互的。我需要做的就是编写一堆单元测试。那么我需要 Cucumber 的可能情况是什么？

并且，作为相应的第二个问题：如果我写 Cucumber 故事，我是否必须写规范？这不是对同一件事进行双重测试吗？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-01-09T22:19:02.023

如果您还没有，您可能想查看 Dan North 的优秀文章，[故事中有什么？](http://dannorth.net/whats-in-a-story)作为起点。

Cucumber 故事有两个主要用途。首先，因为故事形式非常具体，它有助于集中产品所有者对他想要构建的功能的阐述。这是故事的“对话令牌”使用，无论我们是否在代码中实现故事都是有价值的。其次，如果流程运行良好，以至于我们在开始编写功能*之前*就有了完整的故事（更多的是我们为之奋斗的理想，而不是日常现实），那么您就可以清楚地说明您的验收标准，并且您确切地知道什么以及如何很多东西要建造。

在我们的 Rails 工作中，Cucumber 故事不能替代 rspec 单元测试。两者齐头并进。在实践中，单元测试倾向于推动模型和控制器的开发，而故事倾向于推动视图的开发（我们倾向于不为我们的视图编写 rspec）并从整体上提供对应用程序的良好测试用户的视角。

如果您是单独工作，通信方面可能对您来说不是那么有趣，但您从 Cucumber 获得的集成测试可能会很有趣。如果您利用[webrat](http://github.com/brynary/webrat/tree/master)，对于您的许多基本功能，编写 Cucumber 可以快速而轻松。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2010-03-02T23:17:33.527

把它想象成一个循环：

编写您的 Cucumber 功能，然后在开发该功能的部分时，编写规范以完成各个组件。继续完成规范，直到您编写了足够的功能以使该功能通过，然后再编写您的下一个功能。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-09-27T09:10:49.743

我的看法是，在大多数情况下使用 Cucumber 是个坏主意，因为它的语法会给您带来生产力成本。我在[为什么要打扰黄瓜测试？](http://www.jackkinsella.ie/2011/09/26/why-bother-with-cucumber-testing.html)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-07-01T13:11:23.593

Cucumber 故事更多的是描述您的应用程序正在解决的整体问题，而不是单个代码位是否有效（即单元测试）。

正如 Abie 所描述的，它几乎是应用程序应满足的要求的列表，并且对于与您的客户沟通以及可直接测试非常有帮助。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-08-09T06:23:13.253

现在，您可以将 rspec 与 Capybara 和 Selenium Webdriver 一起使用，而不必构建和维护所有 Cucumber 故事解析器。以下是我的建议：

1.  写出你的故事
2.  使用 RSpec，我将创建一个集成测试 ex：spec/integrations/socks_rspec.rb
3.  然后我将创建一个集成测试，其中包含一个新的描述，并为每个场景阻塞
4.  然后我将实现获得集成测试所需的最小功能，并且在深入回溯（进入控制器和模型等）的同时，我将对控制器和模型进行 TDD。
5.  当您回来时，您的集成测试应该通过，您可以继续向集成测试添加步骤
6.  重复

然而，需要注意的一件事是控制器和集成测试有重叠，这可能不是必需的，因此您必须使用最佳判断，以免浪费时间。

此外，一旦您找到了自己的最佳状态，您会发现使用 BDD 进行开发是最令人愉快的，在此之前，如果您觉得自己做得不够完美并且不要过度思考，请不要感到内疚。你会做得很好！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-12-15T15:51:29.877

> 但是如果我在做自己的项目呢？大多数时候，我知道系统的各个部分是如何交互的。我需要做的就是编写一堆单元测试。那么我需要 Cucumber 的可能情况是什么？

你仍然需要黄瓜。您需要它来记录您如何看待系统工作，并且您需要它来确保您在更改内容时没有破坏功能。

换句话说，您需要 Cucumber 故事的原因与您需要单元测试的原因相同——它们只是在更高级别的抽象上工作。

# asp.net - 服务器没有发回正确的 XML 响应

> ID：393623
> 
> 赞同：2
> 
> 时间：2008-12-26T08:41:40.357
> 
> 标签：asp.net, fckeditor

我正在使用 FCKEditor，因为当单击“浏览服务器”按钮时，会引发以下错误。

> 服务器没有发回正确的 XML 响应。请联系您的系统管理员。
> 
> XML 请求错误：未找到 (404)
> 
> 请求的网址：
> 
> /fckeditor/editor/filemanager/connectors/asp/connector.asp?Command=....

我正在使用 .NET 在 IIS7 上开发和测试我的网站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-27T21:59:14.007

我想您需要确保已将 FCK 配置为将 ASPX 用于 FileBrowserLanguage 和 QuickUploadLanguage 而不是 asp。

我在 CustomFckConfig.js 文件中设置了这个，而不是修改核心 FckConfig.js 文件：

```
// The following value defines which File Browser connector and Quick Upload
// "uploader" to use. It is valid for the default implementaion and it is here
// just to make this configuration file cleaner.
// It is not possible to change this value using an external file or even
// inline when creating the editor instance. In that cases you must set the
// values of LinkBrowserURL, ImageBrowserURL and so on.
// Custom implementations should just ignore it.
var _FileBrowserLanguage    = 'aspx' ;  // asp | aspx | cfm | lasso | perl | php | py
var _QuickUploadLanguage    = 'aspx' ;  // asp | aspx | cfm | lasso | perl | php | py 
```

我无法想象现在 IIS7 被配置为提供 .asp 页面 - 它不是为 .aspx 准备的吗？看到您已将此问题标记为 asp.net，我假设您网站的其余部分在 .Net 中运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-23T11:32:11.470

我们在 .net 3.5 中构建并托管在 IIS7 上的网站存在同样的问题。我找到了对我们有帮助的解决方案。我们更改了 fckeditor 的源代码（小修复）并将响应过滤器属性设置为 null。错误与 asp.net 中的服务器响应压缩有关。[我们在这里](http://www.icodefactory.com/lab/post/FCKEditor-with-ASPNET-Fix-The-server-did-not-send-back-a-proper-XML-response-error.aspx)找到了帮助我们的文章。我希望它也能帮助你。

此致，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-07T09:46:39.003

一直在走过——我可能会补充很长的一段路——很多建议的解决方案，但从来没有找到一个可以解决我的问题的解决方案。

我不断得到相同的回应：

> 服务器没有发回正确的 XML 响应。请联系您的系统管理员。
> 
> XML 请求错误：OK (200)
> 
> 请求的 URL：https:.../fckeditor/editor/filemanager/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=%2F&uuid=1260177467559
> 
> 响应文本：window.location.replace("http:.../fckeditor/editor/filemanager/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=%2F&uuid=1260177467559

直到最后，我走近，再次重新阅读响应，并注意到请求和响应使用不同的协议。

仅供参考，编辑器是在站点的安全部分中实现的，只有站点管理员可以访问。我们正在使用自动切换 HTTP/HTTPS 请求的[Ventaur 组件](http://www.codeproject.com/KB/web-security/WebPageSecurity_v2.aspx)。

图像——我们只需要上传/浏览图像类型——驻留在一个子目录中，该子目录也被配置为使用 HTTPS。

这让我知道问题出在哪里，所以我开始将 fckeditor 目录设置为也使用 HTTPS。

这终于奏效了，我能够上传/浏览图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T14:46:25.267

除了 Zhaph 的评论，检查服务器编码并确保与您的 FCKEditor 配置相符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-26T08:48:46.990

使用[FireBug](http://www.getfirebug.com)，检查服务器发回给您的响应。

您可以通过在单击“浏览服务器”按钮后检查*控制台选项卡来执行此操作。*

这样，您就可以看到从服务器接收到的确切信息，从而可以对其进行调试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-26T08:50:30.980

这意味着要么未进行 URI 映射，要么缺少文件。它试图访问某个 URI，但找不到它（404 状态代码）。

您确定您的安装/配置是完整且正确的吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-03T10:27:46.827

确保您的 fckeditor.dll 在 Bin 文件夹的路径上，并确保您拥有正确的版本

# perl - 如何在 Perl 中快速找到用户的终端 PID？

> ID：393627
> 
> 赞同：4
> 
> 时间：2008-12-26T08:47:35.603
> 
> 标签：perl, terminal, pid

以下代码片段用于查找用户终端的 PID，方法是使用 ptree 并从它返回的结果中获取**第三个**PID。所有终端 PID 都以用户登录作为密钥存储在哈希中。

```
 ## If process is a TEMINAL.
   ## The command ptree is used to get the terminal's process ID.
   ## The user can then use this ID to peek the user's terminal.
   if ($PID =~ /(\w+)\s+(\d+) .+basic/) {
    $user = $1;
    if (open(PTREE, "ptree $2 |")) {
     while ($PTREE = <PTREE>) {
      if ($PTREE =~ /(\d+)\s+-pksh-ksh/) {
       $terminals{$user} = $terminals{$user} . " $1";
       last;
      }
      next;
     }
     close(PTREE);
    }
    next;
   } 
```

下面是一个示例 ptree 执行：

```
ares./home_atenas/lmcgra> ptree 29064
485   /usr/lib/inet/inetd start
  23054 /usr/sbin/in.telnetd
    23131 -pksh-ksh
      26107 -ksh
        29058 -ksh
          29064 /usr/ob/bin/basic s=61440 pgm=/usr/local/etc/logon -q -nr trans
            412   sybsrvr 
```

我想知道是否有更好的编码方法。这是脚本中运行时间最长的部分。

注意：此代码与其他代码片段一起位于循环内并执行了几次。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-26T12:42:16.923

我认为主要问题是这段代码在循环中。您无需多次运行 ptree 并解析结果！您需要想出一种方法来运行一次 ptree 并将其放入以后可以使用的数据结构中。可能是某种简单的哈希就足够了。您甚至可以只保留 %terminals 哈希并继续重用它。

一些挑剔...

*   你的两个“下一个”陈述对我来说似乎都是不必要的......你应该能够删除它们。

*   代替

    ```
    $terminals{$user} = $terminals{$user} . " $1"; 
    ```

和：

```
 $terminals{$user} .= " $1"; 
```

*   将您用作文件句柄的裸字 PTREE 替换为 $ptreeF 或类似的东西......大约 10 年前，文件句柄不需要使用裸字:)

*   我不知道为什么你的 $PID 变量都是大写的......它可能会让你的代码的读者感到困惑，因为看起来这个变量有一些特别的东西，但实际上并没有。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-26T13:58:06.413

我认为通过避免重复执行外部命令（`ptree`在本例中为 ）的开销，您将获得最佳的性能改进。`ptree`我会寻找一个为正在读取的数据结构提供直接接口的 CPAN 模块。检查[Linux::](http://search.cpan.org/search?query=Linux%3A%3A&mode=all)命名空间，也许？（我不确定是否`ptree`是[setuid](http://en.wikipedia.org/wiki/Setuid)；这可能会使事情复杂化。）

除了上面的建议，一些额外的样式和健壮性注释仅基于发布的片段（如果更大的代码使它们无效，请原谅我）：

*   `strict`至少 我会从使用开始。[词法文件句柄](https://stackoverflow.com/questions/318789)也是一个好主意。

*   当您无法`open()`执行`ptree`命令时，您似乎在默默地忽略大小写。发生这种情况的原因有很多，其中一些我无法想象你会想忽略，比如……</p>

*   您没有使用`ptree`命令的完整路径，而是假设它在您的路径中——并且您路径中的路径是正确的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-26T17:30:36.670

*我正在考虑使用 ps 来获取父母的 pid，但我需要循环它来获取曾祖父母的 pid。那是我需要的。谢谢。– 拉姆克罗*

* * *

*对不起，有很多用户，每个人最多可以打开三个终端。整个脚本用于查找正在使用文件的终端。我使用 fuser 来查找使用文件的进程。然后使用 ptree 查找终端的 pid。– 拉姆克罗*

* * *

如果您有（或可以获得）使用文件的 PID 列表，并且只需要该 PID 的所有祖父母，那么肯定有一种更简单的方法。

```
#!perl

use warnings;
use strict;

#***** these PIDs are gotten with fuser or some other method *****
my($fpids) = [27538, 31812, 27541];

#***** get all processes, assuming linux PS *****
my($cmd) = "ps -ef";
open(PS, "$cmd |") || die qq([ERROR] Cannot open pipe from "$cmd" - $!\n);

my($processlist) = {};
while (<PS>) {
    chomp;

    my($user, $pid, $ppid, $rest) = split(/ +/, $_, 4);
    $processlist->{$pid} = $ppid;
}

close PS;

#***** lookup grandparent *****
foreach my $fpid (@$fpids) {
    my($parent) = $processlist->{$fpid} || 0;
    my($grandparent) = $processlist->{$parent} || 0;

    if ($grandparent) {
        #----- do something here with grandparent's pid -----
        print "PID:GRANDPID - $fpid:$grandparent\n";
    }
    else {
        #----- some error condition -----
        print "ERROR - Cannot determine GrandPID: $fpid ($parent)\n";
    }
} 
```

这对我来说产生：

```
ERROR - Cannot determine GrandPID: 27538 (1)
PID:GRANDPID - 31812:2804
PID:GRANDPID - 27541:27538 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-26T14:02:11.053

系统上有多少用户？你能把这个倒过来吗？列出系统中的所有 -pksh-ksh 进程及其 EUID，并从中构建映射 - 这可能只是 ps/ptree 的一次执行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-26T14:17:09.277

您是否考虑过使用 ' `who -u`' 来告诉您哪个进程是给定 tty 的登录 shell 而不是 using `ptree`？这将简化您的搜索 - 无论您还应该进行哪些其他更改。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-26T14:08:24.707

我只是根据您的脚本在这里做了一些琐碎的计时（调用“cat ptree.txt”而不是 ptree 本身）并证实了我的想法，即您所有的时间都花在了创建新的子进程和运行 ptree 本身上。除非您可以考虑调用 ptree 的需要（也许有一种方法可以打开连接一次并重复使用它，例如使用 nslookup），否则您不会看到任何真正的收益。

# python - FastCGI maxrequests、maxspare、minspare、maxchildren 使用什么值？

> ID：393629
> 
> 赞同：6
> 
> 时间：2008-12-26T08:49:51.903
> 
> 标签：python, django, fastcgi

我正在使用 FastCGI 和 lighttpd 运行 Django 应用程序。

有人可以解释我在决定 maxrequests、maxspare、minspare、maxchildren 使用什么值时应该考虑什么吗？

这些选项没有很好的文档记录，但似乎非常重要。

不要只告诉我他们做了什么；我想了解它们的*含义*以及我应该如何决定使用哪些值。

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-26T09:00:13.753

让我们从定义开始

```
    maxrequests：子服务器在被杀死之前有多少请求
                 和一个新的分叉
    maxspare ：保持运行的最大备用进程数
    minspare ：要预分叉的最小备用进程数
    maxchildren：prefork 模式下的硬限制进程数

```

这意味着您的网络服务器中的任何给定时间最多有*maxchildren*进程运行，每个进程都针对*maxrequests*请求运行。在服务器启动时，您将获得*minspare*进程，如果有更多请求到来，它将继续增长直到*maxspare*（或*maxchildren ）。*

因此，*minspare*可以让您说出您期望最少有多少并发请求（如果您从一个开始，避免创建进程很重要，最好从 10 开始），而*maxspare*可以让您说出您的并发请求数量服务器最多参加（不影响它的预期响应时间等。需要压力测试来验证）。maxrequests是在*谈论*每个孩子的生命周期，以防它们由于任何类型的限制而无法永远运行。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-26T09:34:20.253

不要忘记将您的 fcgi 设置与您的 apache worker 设置相协调。我通常比 fcgi 工作人员保留更多的 apache 工作人员......它们的重量较轻，并且如果并发量达到高于我的 maxspare 时，它​​们将等待可用的 fcgi 工作人员释放以处理请求。

# iphone - 对于iphone开发，如何翻转一个UIImageView？

> ID：393633
> 
> 赞同：3
> 
> 时间：2008-12-26T08:55:06.180
> 
> 标签：iphone, cocoa-touch

我想翻转一个 imageView（左/右），但我找不到 UIView（或 UIImageView）方法来做到这一点？任何的想法？

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-26T19:49:55.733

我认为您唯一要寻找的是：

UIView 的

```
+ (void)setAnimationTransition:(UIViewAnimationTransition)transition forView:(UIView *)view cache:(BOOL)cache; 
```

和

```
UIViewAnimationTransitionFlipFromLeft,
UIViewAnimationTransitionFlipFromRight, 
```

这些动画过渡只能在动画块中使用。在容器视图上设置过渡，然后将旧视图换成新视图，然后提交动画。

像：

```
CGContextRef context = UIGraphicsGetCurrentContext();

[UIView beginAnimations:nil context:context];
[UIView setAnimationTransition:UIViewAnimationTransitionFlipFromLeft forView:yourContainerView cache:YES];
[yourContainerView exchangeSubviewAtIndex:0 withSubviewAtIndex:1];
[UIView commitAnimations]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T09:27:32.903

将您的 UIIMageView 放入 UIView 并使用此代码（来自实用程序应用项目示例）

```
- (void)loadFlipsideViewController {

    FlipsideViewController *viewController = [[FlipsideViewController alloc] initWithNibName:@"FlipsideView" bundle:nil];
    self.flipsideViewController = viewController;
    [viewController release];

    // Set up the navigation bar
    UINavigationBar *aNavigationBar = [[UINavigationBar alloc] initWithFrame:CGRectMake(0.0, 0.0, 320.0, 44.0)];
    aNavigationBar.barStyle = UIBarStyleBlackOpaque;
    self.flipsideNavigationBar = aNavigationBar;
    [aNavigationBar release];

    UIBarButtonItem *buttonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(toggleView)];
    UINavigationItem *navigationItem = [[UINavigationItem alloc] initWithTitle:@"Test123"];
    navigationItem.rightBarButtonItem = buttonItem;
    [flipsideNavigationBar pushNavigationItem:navigationItem animated:NO];
    [navigationItem release];
    [buttonItem release];
}

- (IBAction)toggleView {    
    /*
     This method is called when the info or Done button is pressed.
     It flips the displayed view from the main view to the flipside view and vice-versa.
     */
    if (flipsideViewController == nil) {
        [self loadFlipsideViewController];
    }

    UIView *mainView = mainViewController.view;
    UIView *flipsideView = flipsideViewController.view;

    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:1];
    [UIView setAnimationTransition:([mainView superview] ? UIViewAnimationTransitionFlipFromRight : UIViewAnimationTransitionFlipFromLeft) forView:self.view cache:YES];

    if ([mainView superview] != nil) {
        [flipsideViewController viewWillAppear:YES];
        [mainViewController viewWillDisappear:YES];
        [mainView removeFromSuperview];
        [infoButton removeFromSuperview];
        [self.view addSubview:flipsideView];
        [self.view insertSubview:flipsideNavigationBar aboveSubview:flipsideView];
        [mainViewController viewDidDisappear:YES];
        [flipsideViewController viewDidAppear:YES];

    } else {
        [mainViewController viewWillAppear:YES];
        [flipsideViewController viewWillDisappear:YES];
        [flipsideView removeFromSuperview];
        [flipsideNavigationBar removeFromSuperview];
        [self.view addSubview:mainView];
        [self.view insertSubview:infoButton aboveSubview:mainViewController.view];
        [flipsideViewController viewDidDisappear:YES];
        [mainViewController viewDidAppear:YES];
    }
    [UIView commitAnimations];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-13T08:14:05.597

mainView 和 flipToView 是 imageViews 的对象， containerView 是 UIView 的对象。

下面给出了两个示例代码，用于卷曲 imageView 并将 ImageView 从左向右翻转

```
- (void)curlAction:(id)sender
{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.75];

    [UIView setAnimationTransition:([mainView superview] ? UIViewAnimationTransitionCurlUp : UIViewAnimationTransitionCurlDown)forView:containerView cache:YES];
    if ([flipToView 超级视图])
    {
        [flipToView removeFromSuperview];
        [containerView addSubview:mainView];
    }
    别的
    {
        [mainView removeFromSuperview];
        [containerView addSubview:flipToView];
    }

    [UIView 提交动画];
}

```

并将图像从左到右带到这里的代码

```
- (void)flipAction:(id)sender
{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.75];

    [UIView setAnimationTransition:([mainView superview] ?
                                        UIViewAnimationTransitionFlipFromLeft : UIViewAnimationTransitionFlipFromRight)
                                        forView:containerView 缓存:YES];
    if ([flipToView 超级视图])
    {
        [flipToView removeFromSuperview];
        [containerView addSubview:mainView];
    }
    别的
    {
        [mainView removeFromSuperview];
        [containerView addSubview:flipToView];
    }

    [UIView 提交动画];
}

```

感谢&问候

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-05T10:49:15.997

[我的仓库](https://github.com/aakash272/imgOrient)中提供了另一种解决方案，但它还没有涉及动画！它只操纵图像方向以提供一些图像效果，即垂直/水平翻转和左/右旋转 90 度。

# apache-flex - Flex 是否支持数据 uri 方案？

> ID：393635
> 
> 赞同：2
> 
> 时间：2008-12-26T08:59:44.393
> 
> 标签：apache-flex, base64, png, data-uri-scheme

我希望在 XML 响应中将许多小的 PNG 文件作为 base64 编码的 URI 传递，但似乎没有办法让 flex 呈现这些图像。我在考虑数据 uri 方案，但似乎不受支持。

## 建议的解决方案

1.  使用 Loader.LoadBytes

试过了，它似乎不起作用（没有触发任何事件）。

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="1276" height="849" creationComplete="drawImage()">
    <mx:Script>
        <![CDATA[
                import mx.controls.Alert;
                import mx.utils.Base64Decoder;

                private function loaderCompleteHandler(event:Event):void {
                        Alert.show("loader done");
            }

            private function errorHandler(e:IOErrorEvent):void {
                Alert.show("error" + e.toString());
            }

                public function drawImage() : void
                {
                        var b64png : String = "iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9YGARc5KB0XV+IAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAF1JREFUGNO9zL0NglAAxPEfdLTs4BZM4DIO4C7OwQg2JoQ9LE1exdlYvBBeZ7jqch9//q1uH4TLzw4d6+ErXMMcXuHWxId3KOETnnXXV6MJpcq2MLaI97CER3N0vr4MkhoXe0rZigAAAABJRU5ErkJggg==";
                        var l : Loader = new Loader();

                        var decoder : Base64Decoder = new Base64Decoder();
                        decoder.decode(b64png);
                        var bytes : ByteArray = decoder.flush();

                        l.addEventListener(Event.COMPLETE, loaderCompleteHandler);
                        l.addEventListener(IOErrorEvent.IO_ERROR, errorHandler);

                        l.loadBytes(bytes);

                }
        ]]>
    </mx:Script>
    <mx:Image x="10" y="10" width="155" height="118" id="image1"/>
</mx:Application> 
```

有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T15:43:53.157

如果将图像数据解码为 ByteArray，则可以使用 Loader.loadBytes(byteArray) 将其作为图像加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T13:59:20.853

您可以使用它来加载图像：

```
var deco64:Base64Decoder = new Base64Decoder;

deco64.decode("base64StringWithTheImageData");

var arrBytes:ByteArray = deco64.toByteArray();

img.load(arrBytes); 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-03T05:19:00.827

您可以将从解码器返回的字节数组直接分配给图像的源属性。

```
 <?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical" creationComplete="init()">
    <mx:Script>
        <![CDATA[
            import mx.utils.Base64Decoder;

            private function init():void {
                var b64png : String = "iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9YGARc5KB0XV+IAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAF1JREFUGNO9zL0NglAAxPEfdLTs4BZM4DIO4C7OwQg2JoQ9LE1exdlYvBBeZ7jqch9//q1uH4TLzw4d6+ErXMMcXuHWxId3KOETnnXXV6MJpcq2MLaI97CER3N0vr4MkhoXe0rZigAAAABJRU5ErkJggg==";
                var decoder : Base64Decoder = new Base64Decoder();
                decoder.decode(b64png);
                var bytes : ByteArray = decoder.flush();
                img.source = bytes;
            }
        ]]>
    </mx:Script>
    <mx:Image id="img" />
</mx:Application> 
```

# python - Django + FastCGI - 随机引发 OperationalError

> ID：393637
> 
> 赞同：8
> 
> 时间：2008-12-26T09:04:03.247
> 
> 标签：python, django, exception, fastcgi, lighttpd

我正在运行一个 Django 应用程序。之前在Apache + mod_python下有过，一切OK。切换到 Lighttpd + FastCGI。现在我随机得到以下异常（无论是地点还是时间似乎都无法预测）。由于它是随机的，并且仅在切换到 FastCGI 后才会出现，因此我认为它与某些设置有关。

google 时发现了一些结果，但似乎与设置 maxrequests=1 有关。但是，我使用默认值，即 0。

任何想法在哪里寻找？

PS。我正在使用 PostgreSQL。也可能与此有关，因为在进行数据库查询时会出现异常。

```
 File "/usr/lib/python2.6/site-packages/django/core/handlers/base.py", line 86, in get_response
   response = callback(request, *callback_args, **callback_kwargs)

 File "/usr/lib/python2.6/site-packages/django/contrib/admin/sites.py", line 140, in root
   if not self.has_permission(request):

 File "/usr/lib/python2.6/site-packages/django/contrib/admin/sites.py", line 99, in has_permission
   return request.user.is_authenticated() and request.user.is_staff

 File "/usr/lib/python2.6/site-packages/django/contrib/auth/middleware.py", line 5, in __get__
   request._cached_user = get_user(request)

 File "/usr/lib/python2.6/site-packages/django/contrib/auth/__init__.py", line 83, in get_user
   user_id = request.session[SESSION_KEY]

 File "/usr/lib/python2.6/site-packages/django/contrib/sessions/backends/base.py", line 46, in __getitem__
   return self._session[key]

 File "/usr/lib/python2.6/site-packages/django/contrib/sessions/backends/base.py", line 172, in _get_session
   self._session_cache = self.load()

 File "/usr/lib/python2.6/site-packages/django/contrib/sessions/backends/db.py", line 16, in load
   expire_date__gt=datetime.datetime.now()

 File "/usr/lib/python2.6/site-packages/django/db/models/manager.py", line 93, in get
   return self.get_query_set().get(*args, **kwargs)

 File "/usr/lib/python2.6/site-packages/django/db/models/query.py", line 304, in get
   num = len(clone)

 File "/usr/lib/python2.6/site-packages/django/db/models/query.py", line 160, in __len__
   self._result_cache = list(self.iterator())

 File "/usr/lib/python2.6/site-packages/django/db/models/query.py", line 275, in iterator
   for row in self.query.results_iter():

 File "/usr/lib/python2.6/site-packages/django/db/models/sql/query.py", line 206, in results_iter
   for rows in self.execute_sql(MULTI):

 File "/usr/lib/python2.6/site-packages/django/db/models/sql/query.py", line 1734, in execute_sql
   cursor.execute(sql, params)

OperationalError: server closed the connection unexpectedly
       This probably means the server terminated abnormally
       before or while processing the request. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-03-23T21:57:07.560

可能的解决方案：[http ://groups.google.com/group/django-users/browse_thread/thread/2c7421cdb9b99e48](http://groups.google.com/group/django-users/browse_thread/thread/2c7421cdb9b99e48)

> 直到最近我还想在 Django 1.1.1 上测试它。会不会再次抛出这个异常......惊喜，它又出现了。我花了一些时间来调试这个，有用的提示是它只在（预）分叉时显示。因此，对于那些随机获得这些异常的人，我可以说...修复您的代码 :) 好吧.. 说真的，这样做的方法总是很少，所以让我先解释一下问题出在哪里。如果您在任何模块将导入时访问数据库，例如从数据库读取配置，那么您将收到此错误。当你的 fastcgi-prefork 应用程序启动时，首先它会导入所有模块，并且只有在这之后才会派生子模块。如果您在导入期间建立了数据库连接，则所有子进程都将拥有该对象的精确副本。此连接在请求阶段结束时关闭（request_finished 信号）。因此，第一个将被调用来处理您的请求的孩子将关闭此连接。但是其余的子进程会发生什么？他们会相信他们已经打开了与数据库的连接，并且可能正在工作，因此任何数据库操作都会导致异常。为什么这没有在线程执行模型中显示？我想是因为线程正在使用相同的对象并且知道任何其他线程何时关闭连接。如何解决这个问题？最好的方法是修复你的代码......但这有时会很困难。另一个选项，在我看来很干净，是在你的应用程序的某处写一小段代码：因此，第一个将被调用来处理您的请求的孩子将关闭此连接。但是其余的子进程会发生什么？他们会相信他们已经打开了与数据库的连接，并且可能正在工作，因此任何数据库操作都会导致异常。为什么这没有在线程执行模型中显示？我想是因为线程正在使用相同的对象并且知道任何其他线程何时关闭连接。如何解决这个问题？最好的方法是修复你的代码......但这有时会很困难。另一个选项，在我看来很干净，是在你的应用程序的某处写一小段代码：因此，第一个将被调用来处理您的请求的孩子将关闭此连接。但是其余的子进程会发生什么？他们会相信他们已经打开了与数据库的连接，并且可能正在工作，因此任何数据库操作都会导致异常。为什么这没有在线程执行模型中显示？我想是因为线程正在使用相同的对象并且知道任何其他线程何时关闭连接。如何解决这个问题？最好的方法是修复你的代码......但这有时会很困难。另一个选项，在我看来很干净，是在你的应用程序的某处写一小段代码：但是其余的子进程会发生什么？他们会相信他们已经打开了与数据库的连接，并且可能正在工作，因此任何数据库操作都会导致异常。为什么这没有在线程执行模型中显示？我想是因为线程正在使用相同的对象并且知道任何其他线程何时关闭连接。如何解决这个问题？最好的方法是修复你的代码......但这有时会很困难。另一个选项，在我看来很干净，是在你的应用程序的某处写一小段代码：但是其余的子进程会发生什么？他们会相信他们已经打开了与数据库的连接，并且可能正在工作，因此任何数据库操作都会导致异常。为什么这没有在线程执行模型中显示？我想是因为线程正在使用相同的对象并且知道任何其他线程何时关闭连接。如何解决这个问题？最好的方法是修复你的代码......但这有时会很困难。另一个选项，在我看来很干净，是在你的应用程序的某处写一小段代码：但这有时可能很困难。另一个选项，在我看来很干净，是在你的应用程序的某处写一小段代码：但这有时可能很困难。另一个选项，在我看来很干净，是在你的应用程序的某处写一小段代码：

```
from django.db import connection 
from django.core import signals 
def close_connection(**kwargs): 
    connection.close() 
signals.request_started.connect(close_connection) 
```

不理想的想法，两次连接到数据库充其量是一种解决方法。

* * *

可能的解决方案：使用连接池（pgpool，pgbouncer），这样您就可以将数据库连接池化且稳定，并快速传递给您的 FCGI 守护进程。

问题是这会触发另一个错误，psycopg2 引发*InterfaceError*因为它试图断开两次连接（pgbouncer 已经处理了这个）。

现在罪魁祸首是 Django 信号*request_finished*触发*connection.close()*，即使它已经断开连接，也会大声失败。我不认为这种行为是可取的，好像请求已经完成，我们不再关心数据库连接。纠正这个问题的补丁应该很简单。

相关回溯：

```
 /usr/local/lib/python2.6/dist-packages/Django-1.1.1-py2.6.egg/django/core/handlers/wsgi.py in __call__(self=<django.core.handlers.wsgi.WSGIHandler object at 0x24fb210>, environ={'AUTH_TYPE': 'Basic', 'DOCUMENT_ROOT': '/storage/test', 'GATEWAY_INTERFACE': 'CGI/1.1', 'HTTPS': 'off', 'HTTP_ACCEPT': 'application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5', 'HTTP_ACCEPT_ENCODING': 'gzip, deflate', 'HTTP_AUTHORIZATION': 'Basic dGVzdGU6c3VjZXNzbw==', 'HTTP_CONNECTION': 'keep-alive', 'HTTP_COOKIE': '__utma=175602209.1371964931.1269354495.126938948...none); sessionid=a1990f0d8d32c78a285489586c510e8c', 'HTTP_HOST': 'www.rede-colibri.com', ...}, start_response=<function start_response at 0x24f87d0>)
  246                 response = self.apply_response_fixes(request, response)
  247         finally:
  248             signals.request_finished.send(sender=self.__class__)
  249 
  250         try:
global signals = <module 'django.core.signals' from '/usr/local/l.../Django-1.1.1-py2.6.egg/django/core/signals.pyc'>, signals.request_finished = <django.dispatch.dispatcher.Signal object at 0x1975710>, signals.request_finished.send = <bound method Signal.send of <django.dispatch.dispatcher.Signal object at 0x1975710>>, sender undefined, self = <django.core.handlers.wsgi.WSGIHandler object at 0x24fb210>, self.__class__ = <class 'django.core.handlers.wsgi.WSGIHandler'>
 /usr/local/lib/python2.6/dist-packages/Django-1.1.1-py2.6.egg/django/dispatch/dispatcher.py in send(self=<django.dispatch.dispatcher.Signal object at 0x1975710>, sender=<class 'django.core.handlers.wsgi.WSGIHandler'>, **named={})
  164 
  165         for receiver in self._live_receivers(_make_id(sender)):
  166             response = receiver(signal=self, sender=sender, **named)
  167             responses.append((receiver, response))
  168         return responses
response undefined, receiver = <function close_connection at 0x197b050>, signal undefined, self = <django.dispatch.dispatcher.Signal object at 0x1975710>, sender = <class 'django.core.handlers.wsgi.WSGIHandler'>, named = {}
 /usr/local/lib/python2.6/dist-packages/Django-1.1.1-py2.6.egg/django/db/__init__.py in close_connection(**kwargs={'sender': <class 'django.core.handlers.wsgi.WSGIHandler'>, 'signal': <django.dispatch.dispatcher.Signal object at 0x1975710>})
   63 # when a Django request is finished.
   64 def close_connection(**kwargs):
   65     connection.close()
   66 signals.request_finished.connect(close_connection)
   67 
global connection = <django.db.backends.postgresql_psycopg2.base.DatabaseWrapper object at 0x17b14c8>, connection.close = <bound method DatabaseWrapper.close of <django.d...ycopg2.base.DatabaseWrapper object at 0x17b14c8>>
 /usr/local/lib/python2.6/dist-packages/Django-1.1.1-py2.6.egg/django/db/backends/__init__.py in close(self=<django.db.backends.postgresql_psycopg2.base.DatabaseWrapper object at 0x17b14c8>)
   74     def close(self):
   75         if self.connection is not None:
   76             self.connection.close()
   77             self.connection = None
   78 
self = <django.db.backends.postgresql_psycopg2.base.DatabaseWrapper object at 0x17b14c8>, self.connection = <connection object at 0x1f80870; dsn: 'dbname=co...st=127.0.0.1 port=6432 user=postgres', closed: 2>, self.connection.close = <built-in method close of psycopg2._psycopg.connection object at 0x1f80870> 
```

这里的异常处理可以增加更多的宽大处理：

**/usr/local/lib/python2.6/dist-packages/Django-1.1.1-py2.6.egg/django/db/__init__.py**

```
 63 # when a Django request is finished.
   64 def close_connection(**kwargs):
   65     connection.close()
   66 signals.request_finished.connect(close_connection) 
```

或者它可以在 psycopg2 上得到更好的处理，所以如果我们想要做的只是断开连接并且它已经是，那么就不会抛出致命错误：

**/usr/local/lib/python2.6/dist-packages/Django-1.1.1-py2.6.egg/django/db/backends/__init__.py**

```
 74     def close(self):
   75         if self.connection is not None:
   76             self.connection.close()
   77             self.connection = None 
```

除此之外，我缺乏想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T09:43:27.020

在交换机中，您是否更改了 PostgreSQL 客户端/服务器版本？

我在 php+mysql 上看到过类似的问题，罪魁祸首是客户端/服务器版本之间的不兼容（即使它们具有相同的主要版本！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T17:29:32.383

闻起来像是可能的线程问题。尽管文件内文档似乎表明 Django/FCGI 可以以这种方式运行，但Django 并*不能保证线程安全。*尝试使用 prefork 运行，然后将垃圾从服务器中剔除。如果问题消失...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T17:29:29.383

两种设置（Apache+mod_python 和 lighttpd + FastCGI）的 PYTHONPATH 和 PATH 环境变量可能不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T11:23:49.783

最后，我切换回 Apache + mod_python（除了这个，我还遇到了 fcgi 的其他随机错误），现在一切都很好而且很稳定。

这个问题仍然悬而未决。如果将来有人遇到此问题并解决它，他们可以在此处记录解决方案以供将来参考。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-13T23:56:27.060

在使用未将默认 ORM 用于其功能之一的 geodjango 模型时，我修复了类似的问题。当我添加一行手动关闭连接时，错误消失了。

[http://code.djangoproject.com/ticket/9437](http://code.djangoproject.com/ticket/9437)

但是，在使用用户登录/会话进行操作时，我仍然会随机看到错误（约 50% 的请求）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-27T19:17:03.837

我最近遇到了同样的问题（lighttpd、fastcgi 和 postgre）。找了几天的解决方案没有成功，万不得已改用mysql。问题消失了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-07T00:07:35.073

为什么不将会话存储在缓存中？放

```
SESSION_ENGINE = "django.contrib.sessions.backends.cache" 
```

您也可以尝试将 postgres 与*pgbouncer*一起使用（postgres - prefork 服务器，每次不喜欢多次连接/断开连接），但首先检查您的 postgresql.log。

另一个版本 - 您在会话表中有许多记录，*django-admin.py cleanup*可以提供帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-16T18:46:07.967

问题可能主要与进口有关。至少这就是发生在我身上的事。在网上一无所获后，我编写了自己的解决方案。请在此处查看我的博文：[Simple Python Utility to check all Imports in your project](http://nandakishore.posterous.com/simple-djangopython-utility-to-check-all-the)

当然，这只会帮助您很快找到原始问题的解决方案，而不是您问题的实际解决方案本身。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-03-05T23:06:49.823

从 method=prefork 更改为 method=threaded 为我解决了这个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-10-14T14:57:08.777

即使我没有使用 django 而是使用金字塔作为框架，我也会尝试对此给出答案。很长一段时间以来我都遇到了这个问题。问题是，为测试产生这个错误真的很困难......无论如何。最后，我通过挖掘会话、范围会话、会话实例、引擎和连接等所有内容来解决它。我发现了这个：

[http://docs.sqlalchemy.org/en/rel_0_7/core/pooling.html#disconnect-handling-pessimistic](http://docs.sqlalchemy.org/en/rel_0_7/core/pooling.html#disconnect-handling-pessimistic)

这种方法只是简单地将监听器添加到引擎的连接池中。在侦听器中，向数据库查询静态选择。如果它失败，池尝试在它完全失败之前建立到数据库的新连接。重要提示：这发生在将任何其他内容扔到数据库之前。因此，可以预先检查连接以防止其余代码失败。

这不是一个干净的解决方案，因为它本身不能解决错误，但它就像一个魅力。希望这可以帮助某人。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-03-08T21:19:27.213

适用报价：

`"2019 anyone?" - half of YouTube comments, circa 2019`

如果有人仍在处理这个问题，请确保您的应用程序“急切地分叉”，以便您的 Python DB 驱动程序（`psycopg2`对我而言）不会在进程之间共享资源。

我通过添加`lazy-apps = true`选项在 uWSGI 上解决了这个问题，这导致直接派生应用程序进程，而不是等待写时复制。我想其他 WSGI / FastCGI 主机也有类似的选项。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-04-29T18:35:06.703

您是否考虑过降级到 Python 2.5.x（特别是 2.5.4）？我认为 Django 在 Python 2.6 上不会被认为是成熟的，因为存在一些向后不兼容的更改。但是，我怀疑这会解决您的问题。

此外，Django 1.0.2 修复了一些邪恶的小错误，因此请确保您正在运行它。这很好地解决了你的问题。

# apache-flex - Flex XML 元素与代码

> ID：393638
> 
> 赞同：1
> 
> 时间：2008-12-26T09:05:14.977
> 
> 标签：apache-flex

在 Flex 应用程序中，可以在 XML 和代码中声明元素，例如 HTTPService 元素。

也就是说，要么： ...

或在代码中： var hs : HTTPService = ...

我的问题是我什么时候应该更喜欢哪种选择？在 XML 中使用内容与在代码中使用普通的旧 var 有什么优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T15:30:31.687

MXML 非常适合进行声明式布局，比在 ActionScript 中以编程方式进行所有操作更容易遵循。如果您使用 ServiceLocator 之类的东西在您的应用程序中定义 HTTPService、RemoteObject 等，那么通过 MXML 声明它们也很简单快捷。基本上，如果您想快速轻松地向对象的 displayList 添加任何内容，MXML 是一个很好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T15:20:49.740

元素比 AS3 代码更简洁紧凑，当然最终它们都变成了同一件事。例如，您可以在 mxml 的“一行”中声明一个 HTTPService 并设置它的几个属性。在脚本中，您需要在多行初始化代码中执行此操作。如果您有很多全局变量，这可能会开始变得不守规矩。

# php - PHP中的2列Mysql日期范围搜索

> ID：393639
> 
> 赞同：2
> 
> 时间：2008-12-26T09:09:44.060
> 
> 标签：php, mysql, search, date, range

MySQL 列 > sdate, edate （它的 2 列）。

sdate 是项目开始的开始日期， edate 是项目结束的结束日期。

所以我需要在他们之间进行搜索..

```
<strong>Search</strong><br />
<form method="post" action="search.php">
  Start Report Date : <input type="text" name="sdate" />
  End Report Date : <input type="text" name="edate" />
  <input type="submit" name="Submit" value="Search" />
</form>

This is example data in mysql
sdate             Project Name      edate
22 December 2008  project 1         23 December 2008
25 December 2008  project 2         26 December 2008
24 December 2008  project 3         27 December 2008
1  January 2008   project 4         20 January 2008
10 December 2008  project 5         12 December 2008 
```

假设用户输入了 sdate（例如，2008 年 12 月 22 日）和 edate（例如，2008 年 12 月 30 日）。

它应该显示

```
22 December 2008  project 1         23 December 2008
25 December 2008  project 2         26 December 2008
24 December 2008  project 3         27 December 2008 
```

所以我需要一个 php 代码 sql 查询，它应该显示条目位于这两个日期之间。

请帮我..

非常感谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-26T11:55:48.983

假设您的`sdate`and`edate`是 MySQL 列类型`DATE`，您可以执行以下操作：

```
SELECT  
  Project_Name
, sdate
, edate
FROM your_table 
WHERE 
  sdate <= '2008-12-26'
 AND 
  edate >= '2008-12-26' 
```

或者你可以使用 DATEDIFF

```
SELECT  
  Project_Name
, sdate
, edate
FROM your_table 
WHERE 
  DATEDIFF(sdate, '2008-12-26') <= 0
 AND 
  DATEDIFF(edate, '2008-12-26') >= 0 
```

第一个更有效，因为 MySQL 可以将表中的所有行与静态值进行比较。对于第二种解决方案，它需要计算表中每一行的差异。

如果您的 `sdate`和`edate`列不是 DATE 列，那么您很不走运，需要先更改它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T09:34:50.220

似乎带有“where”子句的简单选择查询可以解决问题。

Peuso代码：

```
select sdate, name, edate 
from your_table 
where sdate >= '22 December 2008' and edate <= '30 December 2008' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T09:39:36.590

顺便说一句，为了帮助 UI，我建议使用 phps strtotime() 方法...它使输入日期*非常*灵活

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T15:07:20.687

首先对用户的输入使用 mktime()

```
$time = mktime(format from user); 
```

然后做

```
SELECT Project_Name, sdate, edate FROM table WHERE 
  UNIX_TIMESTAMP(STR_TO_DATE(sdate, '%e %m %Y')) <= '$time'
 AND 
  UNIX_TIMESTAMP(STR_TO_DATE(edate, '%e %m %Y')) >= '$time' 
```

那应该行得通。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T17:12:33.723

SELECT project_name, sdate, edate FROM projects WHERE sdate <= $_POST['edate'] AND edate >= $_POST['sdate']

为您提供开始日期和结束日期与表单开始日期和结束日期重叠的任何项目。（假设 sdate 和 edate 格式正确）

# delphi - 有没有人将 D2007 + TntControls 应用程序移植到 D2009 的经验？

> ID：393641
> 
> 赞同：5
> 
> 时间：2008-12-26T09:12:20.967
> 
> 标签：delphi, delphi-2009, delphi-2007, porting

我有一个用 Delphi 2007 编写的相当大的（免费软件）项目，它同时使用`TntUnicodeControls`了库和`TntLXControls`库，我计划迁移到 Delphi 2009。

不幸的是，我在我的项目中到处使用这些库：

*   替换 VCL 控件以提供 Unicode 功能
*   Win32 API 包装器（主要用于比较字符串）
*   `TntLXForms`, `TntLXRegistry`, ...的功能增强
*   使用`TntControls`. （VirtualTrees、SpTBXLib、D2009 更新可用）

您对将此类项目移植到 Delphi 2009 有任何经验和/或建议吗？是否建议先切换到（商业）`TMS`Unicode 控件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-26T10:03:24.983

安装 GExperts；有一个“替换组件”IDE 插件可以帮助将 TTntXXX 转换为 TXXXX 控件。试一次，如果没问题，只需检查“替换项目中的任何地方”。

SpTbx 和 VirtualTrees 只能重新编译 - 它们都支持 D2009。

如果您使用 WinAPI 包装器只是为了调用 Unicode API-s，它们也应该在 D2009 中工作。

剩下的就是 TntLX 控件（TntLXForms、TntLXRegistry、...）。由于它们不受支持，因此无论如何可能是更改它们的好时机。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-26T10:04:31.987

我可以帮助解决其中的一些问题，因为我正在移植一个从 2007 年到 2009 年使用 TNT 的 C++Builder 应用程序。在 D2009 中切换到 Unicode 是迟到的，并且值得欢迎。然而，不幸的是，对于那些过去不需要 unicode 并且可能仍然不需要的人来说，过渡可能更容易。如果像我一样，您需要 Unicode 并使用 Troy Wolbrink 强大的 TNT 控件来提供它，那么您的工作就相当复杂了……

好消息是，[TMS Software](http://www.tmssoftware.com/site/tmsuni.asp)推出了支持 D2009 的新版本 TNTControls。我没有看过这个，但希望它只是原生 VCL 组件之上的一个“外观”层，以简化可移植性。我会考虑是否可以重建您的其他库以使用它。

但是，您最好回到原生 VCL 控件，原因是字符串类型。TNT 控件一直使用 WideString 来回传递 Unicode 字符串，您可能会在自己的代码中分散使用 WideString。这会起作用，但它并不理想，因为 WideString 应该只用于 COM 互操作，因为它“包装”了 COM BSTR 类型。D2009 中的本机 unicode 字符串是引用计数的，应该会明显更快。

如果您决定用原生 VCL 替换 TNT 组件，您可以使用 GExperts“替换组件”命令 - 或者，也许更简单，在您的 .DFM 和 .PAS 文件中进行搜索和替换（您确实有文本形式的文件，你不是）用T替换TTNT。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-26T13:02:02.140

我推荐以下资源：

Marco Cantu 的 Delphi 2009 手册第 3 章（移植到 unicode） [http://www.marcocantu.com/dh2009/](http://www.marcocantu.com/dh2009/)

Nick Hodges 的文章（Unicode 世界中的 Delphi） [http://blogs.codegear.com/nickhodges/2008/11/20/39149](http://blogs.codegear.com/nickhodges/2008/11/20/39149)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T09:54:36.217

我认为无论哪种方式都会有很多工作。可能比您之前没有完成所有工作以使其兼容 unicode 更重要。我个人会忘记 tms Unicode 控件，然后回到 vcl。这将在未来节省更多的痛苦。（请注意，没有违反这些控件的内容。）

另请记住，D2009 的字符串与 D2007 的 Widestring 不同，您在应用程序中无疑使用了后者。所以所有 Widestring 实例，你从 string（它是 AnsiString）如此努力地改变，需要再次回到 string（现在是 unicodestring）。

# sql - SQL查询还是子查询？

> ID：393644
> 
> 赞同：1
> 
> 时间：2008-12-26T09:26:56.040
> 
> 标签：sql, mysql

我在 MySQL 中有一个学生信息表，如下所示（简化）：

```
|   age : int   |   city : text   |   name : text   |
-----------------------------------------------------
|               |                 |                 | 
```

我希望选择给定城市内的所有学生姓名和年龄，以及每个学生在他的年龄组中有多少其他学生（即有多少学生共享他的年龄值）。

我设法通过子查询做到了这一点；就像是：

```
select 
   name, 
   age as a, 
   (select 
       count(age) 
    from 
       tbl_students 
    where 
       age == a) 
from 
   tbl_students 
where 
   city = 'ny' 
```

但这似乎有点慢，而且我不是 SQL-wiz，所以我想我会问是否有更聪明的方法来做到这一点。该表按年龄和城市编制索引。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-26T09:34:19.283

```
select 
    t1.name, 
    t1.age as a, 
    count(t2.age) NumberSameAge
from 
   tbl_students t1 inner join tbl_students t2
    on t1.age=t2.age
where 
   city = 'ny'
group by t1.name, t1.age 
```

未经测试，但类似的东西。Iow 一个 groupby 加入。这有时会更快，因为您正在运行的查询正在为返回的*每一*行执行嵌套子查询，而我在上面发布的查询（或至少，具有连接和 groupby 的结构）只对相关学生执行查询一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T10:39:14.613

获取一次获取所有内容的子查询可能更容易（与运行子查询 1000 次的 1000 行相比）。

```
SELECT Age, count(*) AS SameAge FROM tbl_students 
```

进行完整查询：

```
SELECT t.Name, t.Age, s.SameAge
FROM tbl_students t
  INNER JOIN (
    SELECT Age, count(*) AS SameAge FROM tbl_students
  ) AS s
    ON (t.Age = s.Age) -- m:1
WHERE t.City = 'NY' 
```

# php - Delphi for PHP - 源码位置

> ID：393646
> 
> 赞同：0
> 
> 时间：2008-12-26T09:29:24.630
> 
> 标签：php, delphi4php

我刚刚安装了 Delphi for PHP 以了解它的工作原理，并创建了一个简单的应用程序，该应用程序带有一个按钮，当单击该按钮时，它会将文本放入列表框中。如果我将所有需要的文件复制到我的网络服务器并从那里运行它，该应用程序就可以工作。如果我将项目保存在标准路径中，它也可以工作：“c:\documents and settings\username\My Documents\Delphi for PHP Projects”

但是，如果我将项目保存在另一个目录中，则当应用程序从那里运行时，不会触发 ButtonClick 事件。我在事件中设置了一个断点，以查看它是否停在那里，但它没有。

表单的 OnShow 事件照常工作。

它似乎确实是项目所在的路径，以使其工作或不工作。正如我所说，到目前为止我还没有使用 Delphi for PHP 的经验，它可能只是一个我看不到的简单解决方案......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T12:02:23.540

您的源代码应该与您的 Delphi 4 PHP 安装的驱动程序相同，它可以防止跨站点脚本。

所以，如果你在 C: 下安装 D4PHP，你的代码也应该在 C: 下。

这不是 Delphi 4 PHP 的限制，而是事情的工作方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-04T19:03:52.270

您必须使用部署向导来部署您的项目；）

# asp.net - 响应内容类型为 CSV

> ID：393647
> 
> 赞同：374
> 
> 时间：2008-12-26T09:32:40.990
> 
> 标签：asp.net, http, csv

我需要在 HTTP 响应中发送一个 CSV 文件。如何将输出响应设置为 CSV 格式？

这不起作用：

```
Response.ContentType = "application/CSV"; 
```

* * *

## 回答 #1

> 赞同：550
> 
> 时间：2008-12-26T11:26:39.887

使用`text/csv`是最合适的类型。

您还应该考虑`Content-Disposition`在响应中添加标头。通常文本/csv 将由 Internet Explorer 直接加载到 Excel 的托管实例中。这可能是也可能不是理想的结果。

```
Response.AddHeader("Content-Disposition", "attachment;filename=myfilename.csv"); 
```

以上将导致出现文件“另存为”对话框，这可能是您想要的。

* * *

## 回答 #2

> 赞同：188
> 
> 时间：2009-03-16T18:47:19.113

CSV 的 MIME 类型`text/csv`符合[RFC 4180](https://www.rfc-editor.org/rfc/rfc4180)。

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2008-12-26T09:36:43.023

用作`text/csv`内容类型。

* * *

## 回答 #4

> 赞同：54
> 
> 时间：2009-11-12T01:11:39.870

多年来，我一直在为此磨练一套完美的标头，这些标头在我所知道的所有浏览器中都能出色地工作

```
// these headers avoid IE problems when using https:
// see http://support.microsoft.com/kb/812935
header("Cache-Control: must-revalidate");
header("Pragma: must-revalidate");

header("Content-type: application/vnd.ms-excel");
header("Content-disposition: attachment; filename=$filename.csv"); 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2008-12-26T09:37:12.663

尝试其中一种其他 mime 类型（来自这里： http: [//fileext.com/file-extension/CSV](http://filext.com/file-extension/CSV)）

*   文本/逗号分隔值
*   文本/csv
*   应用程序/csv
*   应用程序/excel
*   应用程序/vnd.ms-excel
*   应用程序/vnd.msexcel

此外，mime 类型*可能*区分大小写......

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-04-28T12:54:13.677

就这样使用

```
Response.Clear();
Response.ContentType = "application/CSV";
Response.AddHeader("content-disposition", "attachment; filename=\"" + filename + ".csv\"");
Response.Write(t.ToString());
Response.End(); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-07-25T11:35:41.417

在 ASP.net MVC 中，可以使用 a`FileContentResult`和`File`方法：

```
public FileContentResult DownloadManifest() {
    byte[] csvData = getCsvData();
    return File(csvData, "text/csv", "filename.csv");
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-02-16T12:20:31.643

我发现 IE 的问题在于它会嗅探返回的数据并自行决定它认为已发送的内容类型。这会导致许多副作用，例如总是打开文本文件的另存为对话框，因为您正在使用数据传输压缩。解决方案是（在php代码中）......

```
header('X-Content-Type-Options: nosniff'); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-28T01:39:03.520

如上所述设置内容类型和内容配置会在不同的浏览器中产生截然不同的结果：

IE8：根据需要另存为对话框，Excel 作为默认应用程序。100% 好。

Firefox：SaveAs 对话框确实出现了，但 Firefox 不知道它是一个电子表格。建议用 Visual Studio 打开它！50% 好

Chrome：提示被完全忽略。CSV 数据显示在浏览器中。0% 好。

当然，在所有这些情况下，我指的是开箱即​​用的浏览器，没有自定义 mime/应用程序映射。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-06-13T21:59:36.793

我建议在 'myfilename.cvs' 前面插入一个 '/' 字符

```
Response.AddHeader("Content-Disposition", "attachment;filename=/myfilename.csv"); 
```

我希望你能得到更好的结果。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-03-27T11:35:41.883

对于 C# MVC 4.5，您需要这样做：

```
Response.Clear();
Response.ContentType = "application/CSV";
Response.AddHeader("content-disposition", "attachment; filename=\"" + fileName + ".csv\"");
Response.Write(dataNeedToPrint);
Response.End();
return new EmptyResult();  //this line is important else it will not work. 
```

# mfc-networking - 获取连接到机器的共享列表

> ID：393654
> 
> 赞同：1
> 
> 时间：2008-12-26T09:38:53.440
> 
> 标签：mfc-networking

考虑到我已经连接到远程机器的多个共享（\\machineA\share1、\\machineA\share2....）以及其他远程机器上的共享。

现在我的问题是如何只找到那些连接到特定机器的共享。例如，只有那些连接到 machineA 的共享。

我已经遇到了 WNetOpenEnum 和 WNetEnumResource。但是这些效率非常低，它们将返回连接到我的机器的所有共享，然后我将不得不搜索连接到 machineA 的共享的结果:(

我需要知道是否有其他功能，使用它我可以找到共享。

我正在研究 VC++ 6.0。

***编辑：***嘿家伙有另一个麻烦。每当我尝试连接到机器上的共享时，我都会收到以下错误： **“引用的帐户当前被锁定，可能无法登录”** 有没有人遇到过这个问题以及如何解决

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T23:19:53.057

要解决锁定问题，请登录目标服务器（或者，如果它在域上，请登录该域上的任何域控制器），转到控制面板 > 管理工具 > Active Directory 用户和计算机，导航到您的用户'正在登录并解锁它。

如果系统不在域中，只需登录它并通过 compmgmt.msc 中的“本地用户和组”工具解锁帐户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T21:00:15.310

```
foreach (string systemName in systemNames)
 System.IO.Directory.GetDirectories("\\"+systemName+"\"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T13:35:45.473

遍历所有共享并仅选择您想要的共享，对我来说，看起来尽可能高效。有什么情况你不能做到吗？（除了懒惰;））

# .net - AddExtensionObject - 性能

> ID：393661
> 
> 赞同：2
> 
> 时间：2008-12-26T09:55:06.373
> 
> 标签：.net, xslt, internationalization

.NET XSLT 引擎允许通过 AddExtensionObject 方法将对象传递给 XSLT 处理引擎。

有人可以评论使用它来检索要在 XSLT 中使用的本地化字符串的性能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-26T21:13:03.553

如果 XSLT 转换的一部分被认为是低效的，则可以使用**[扩展对象来提高性能。](http://msdn.microsoft.com/en-us/library/tf741884.aspx)**

虽然使用扩展方法的方法不会降低性能（不包括错误和低效的代码），**但如果使用适当的 XSLT 技术来访问本地化字符串，它们不会显着提高性能**。

**如果不是迫切需要扩展对象，那么创建一个纯 XSLT 解决方案总是好的。这为提供兼容 XSLT 处理器的任何平台提供了可移植性的额外好处**。

可以将给定语言的所有本地化字符串放在单独的 XML 文件中。将使用 XSLT[**`document()`**](http://www.w3.org/TR/xslt#function-document)函数访问此文件。每个字符串将使用指令建立的索引按其`@msgId`属性进行索引。在转换中，将使用 XSLT函数[**`<xsl:key>`**](http://www.w3.org/TR/xslt#key)获取单个消息。[**`key()`**](http://www.w3.org/TR/xslt#function-key)

下面是一个小代码示例，展示了如何通过 msgId 和语言代码从 xml 文件中检索消息，其中存储了所有语言的消息。为方便起见，我们将消息放在 XSLT 样式表本身中。实际上，消息可以位于单独的 XML 文件中：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/> 
```

```
 <xsl:key name="kMsgByLangAndId" match="msg"
      use="concat(../@name, @msgId)"/> 
```

```
 <xsl:param name="pLang" select="'De'"/>
 <xsl:param name="pTime" select="19"/> 
```

```
 <xsl:variable name="vMsgEn">
  <msg msgId="MornGreet">Good morning.</msg>
  <msg msgId="AftnGreet">Good afternoon.</msg>
  <msg msgId="EvnGreet">Good evening.</msg>
 </xsl:variable> 
```

```
 <xsl:variable name="vMsgDe">
  <msg msgId="MornGreet">Guten morgen.</msg>
  <msg msgId="AftnGreet">Guten tag.</msg>
  <msg msgId="EvnGreet">Guten abend.</msg>
 </xsl:variable> 
```

```
 <xsl:template match="/">
      <xsl:variable name="vLangVarName"
           select="concat('vMsg', $pLang)"/> 
```

```
 <xsl:variable name="vMsgId">
      <xsl:choose>
       <xsl:when test="not($pTime >= 12)">MornGreet</xsl:when>
       <xsl:when test="not($pTime >= 18)">AftnGreet</xsl:when>
       <xsl:otherwise>EvnGreet</xsl:otherwise>
      </xsl:choose>
    </xsl:variable> 
```

```
 <xsl:for-each select="document('')">
    <xsl:value-of select=
      "key('kMsgByLangAndId',
            concat($vLangVarName,$vMsgId)
            )"/>
   </xsl:for-each> 
```

```
 </xsl:template>
</xsl:stylesheet> 
```

当此转换应用于任何源 XML 文档（忽略）时，会产生所需的结果：

**`Guten abend.`**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T11:33:33.617

老实说，我不会担心——它应该*绰绰有余*。我使用扩展对象来执行诸如 regex-replace 和其他复杂的字符串操作（在 xslt 中并不总是简单）之类的事情，并且它很有效。

如果你只做一些全局字符串，那么你也可以使用模板级参数（而不是扩展）；但是如果你有很多东西要查找（或者它们是动态的），那么扩展对象就很有意义了。

如果可能，请使用`XslCompiledTransform`，这*将*提高性能（当然，扩展方法中的 C# 方法将`<script>`胜过 xslt 中的方法）。除此之外，如果你有一个瓶颈，很可能是没有正确使用 xsl-indexes、Muenchian-grouping 等。

# c - 在可可中使用结构列表有意义吗？

> ID：393662
> 
> 赞同：5
> 
> 时间：2008-12-26T09:55:42.813
> 
> 标签：c, objective-c, cocoa

这个问题是从这个问题中衍生出来的[。](https://stackoverflow.com/questions/393151/whats-the-easiest-way-to-create-an-array-of-structs)在可可中使用结构列表并不简单。要么使用 NSArray 并进行编码/解码，要么使用 C 类型的数组而失去 NSArray 的商品。结构应该很简单，但是当需要一个列表时，人们倾向于构建一个类。

什么时候在可可中使用结构列表有意义？

我知道已经有很多关于结构与类的问题，而且我读过用户争辩说每种语言的答案都是相同的，但至少 cocoa 应该对此有自己的特定答案，如果仅仅是因为 KVC 或绑定（如彼得就第一个问题提出建议）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-26T14:06:18.017

Cocoa 有一些常见的类型是结构，而不是对象：NSPoint、NSRect、NSRange（以及它们的 CG 对应物）。

如有疑问，请跟随 Cocoa 的脚步。如果您发现自己要处理大量小的、主要是数据的对象，您可能希望将它们改为结构以提高效率。

使用 NSArray/NSMutableArray 作为顶级容器，并将结构包装在 NSValue 中可能会让你的生活更轻松。如果您发现 NSArray 是性能瓶颈，或者如果数组本质上是只读的，我只会使用直接的 C 类型数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T08:30:42.563

有时使用结构既方便又有用，尤其是当您不得不使用 C 语言时，例如在使用现有库或做系统级工作时。有时你只想要一个没有类开销的紧凑数据结构。如果您需要许多此类结构的实例，它会对性能和内存占用产生真正的影响。

另一种处理结构数组的方法是使用[NSPointerArray](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSPointerArray_Class/Introduction/Introduction.html#//apple_ref/occ/cl/NSPointerArray)类。设置起来需要更多的思考，但之后它的工作原理就像 NSArray 一样，您不必费心装箱/拆箱或包装在一个类中，因此访问数据更方便，而且它没有占用一堂课的额外记忆。

```
NSPointerFunctions *pf = [[NSPointerFunctions alloc] initWithOptions:NSPointerFunctionsMallocMemory |
                          NSPointerFunctionsStructPersonality |
                          NSPointerFunctionsCopyIn];
pf.sizeFunction = keventSizeFunction;
self.pending = [[NSPointerArray alloc] initWithPointerFunctions:pf]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T18:21:58.157

一般来说，结构的使用意味着存在一个相对简单的数据类型，它没有与之关联的逻辑，也不应该有任何与之关联的逻辑。举个`NSPoint`例子——它只是一个 (x,y) 表示。鉴于此，它的使用也产生了一些问题。一般来说，这对于这种类型的数据是可以的，因为我们通常观察点的变化而不是点的 y 坐标（从根本上说，（0,1）与（1,1）移动不同减少 1 个单位）。如果这是不受欢迎的行为，那么使用类可能是一个更好的主意。

# c# - ASP.Net Ajax：如何将自定义控件从其 DLL 添加到 asp.net 2.0 工具箱

> ID：393663
> 
> 赞同：0
> 
> 时间：2008-12-26T09:57:19.177
> 
> 标签：c#, asp.net, asp.net-ajax

我有一个 MS AJAX 工具包 DLL，我想将它作为选项卡添加到工具箱项中。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-26T10:10:24.877

1.  打开IDE左侧的工具箱，找到`Ajax Controls`Tab

2.  右键单击选项卡，然后选择`Choose Items`（将需要一些时间来加载）（*图像显示单击`General`选项卡而不是`Ajax Control Toolkit`*：（ [来源：][[xstandard.com](http://xstandard.com/6B8EB276-820E-40B8-B681-8C6164FA5281/integration-net-toolbox-2005.gif)][）][![替代文字](https://i.stack.imgur.com/9OEsD.gif)](https://i.stack.imgur.com/9OEsD.gif)

3.  窗口打开后`Choose Toolbox Items`，单击`.NET Framework Components`选项卡：

[![替代文字](https://i.stack.imgur.com/gGpB7.jpg)](https://i.stack.imgur.com/gGpB7.jpg)
[（来源：[idautomation.com](https://www.idautomation.com/reporting_services/barcode_cri/Reporting_Services_Choose_Toolbox_Items.JPG)）]

最后单击`Browse...`按钮，然后从那里选择您的 DLL。

之后，您的控件应出现在选项卡中。

# sql-server-2005 - 禁用或覆盖 Reporting Services 中的 excel 和 pdf 导出功能

> ID：393669
> 
> 赞同：2
> 
> 时间：2008-12-26T10:23:47.360
> 
> 标签：sql-server-2005, excel, reporting-services, export

有没有办法禁用或覆盖 SQL Server Reporting Services 中的 excel 和 pdf 导出功能。我想要我自己的自定义 excel 导出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-26T19:09:13.320

要禁用它们，您可以编辑 ReportServer RSReportServer.Config 文件。从渲染部分删除 Excel 和 PDF 扩展。

更多信息：http: [//msdn.microsoft.com/en-us/library/cc627537.aspx](http://msdn.microsoft.com/en-us/library/cc627537.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-12T09:12:58.813

找到文件名`RSReportDesigner.config`在

> “Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies\RSReportDesigner.config”。

然后添加`visible = false`
您的 PDF 导出将在报表服务器中不可见

# coding-style - 使用 return 语句效果很好！

> ID：393675
> 
> 赞同：2
> 
> 时间：2008-12-26T10:38:38.220
> 
> 标签：coding-style, methods, return-value, fluent-interface

当我使用返回值创建方法时，我通常会尝试进行设置，以便永远不会出现以必须返回某些默认值的方式调用该方法的情况。当我开始的时候，我经常会编写一些方法来做某事，或者返回他们所做的事情，或者如果他们没有做任何事情，就会返回 null。但我讨厌在我的代码中到处都是丑陋的`if(!null)`陈述，

我正在阅读我很多个月前阅读的实用程序员的 ruby​​ 重新指南，我注意到他们经常返回`self`(ruby's `this`)，而他们通常不会返回任何东西。他们说，这是为了能够链接方法调用，就像在这个例子中使用返回他们设置属性的对象的 setter 一样。

```
tree.setColor(green).setDecor(gaudy).setPractical(false) 
```

起初我觉得这种东西很有吸引力。有几次我很高兴能够链接方法调用，`Player.getHand().getSize()`但这有点不同，因为方法调用的对象一步一步地变化。

Stack Overflow 对返回值有什么看法？当您想到返回值时，是否有任何模式或习语会温暖地浮现在脑海中？有什么好方法可以避免挫败感和增加美感？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-26T11:22:35.323

以我的拙见，您应该考虑三种退货情况：

## 对象属性操作

首先是对象属性的操作。您在此处描述的模式在操作对象时经常使用。一个非常典型的场景是与工厂一起使用它。考虑这个假设的创建调用：

```
// When the object has manipulative methods:
Pizza p = PizzaFactory().create().addAnchovies().addTomatoes(); 
// When the factory has manipulative methods working on the 
// object, IMHO more elegant from a semantic point of view:
Pizza p = PizzaFactory().create().addAnchovies().addTomatoes().getPizza(); 
```

它允许快速掌握正在创建的确切内容或如何操作对象，因为这些方法形成了一个人类可读的表达式。这绝对不错，但不要过度使用。一个经验法则是，这可能与返回值也可以声明为 void 的方法一起使用。

## 评估对象属性

第二个可能是当方法评估对象上的某些内容时。例如，考虑方法`car.getCurrentSpeed()`，它可以被解释为向对象询问当前速度并返回该消息的消息。它只会返回值，不会太复杂。:)

## 让对象做这个或那个

第三个可能是当一个方法执行一个操作时，返回某种值，表明调用者的意图被实现的程度——但布局这样的方法可能很困难：

```
int new_gear = 20;
if (car.gears.changeGear(new_gear)) // does that mean success or fail? 
```

这是您可以看到设计该方法的困难之处。它应该在成功还是失败时返回 0？如果无法设置档位，-1 怎么样，因为汽车只有 5 个档位？这是否意味着当前档位现在也处于-1？该方法可以返回它更改为的齿轮，这意味着您必须将提供给该方法的参数与返回代码进行比较。那会奏效。另一方面，您可以简单地返回 true 或 false 表示失败，或者返回 false 或 true 表示失败。可以通过估计您是否希望这些方法调用失败或成功来决定使用哪一个。

在我看来，有一种方法可以更好地表达这些返回值的语义，通过给它们一个语义描述。未来与您的对象交互的开发人员会喜欢您，因为您不必为您的方法查找注释或文档：

```
class GearSystem {
// (...)
public:
enum GearChangeResult
{ GearChangeSuccess, NonExistingGear, MechanicalGearProblem };

GearChangeResult changeGear (int gear);
}; 
```

这样，对于任何查看您的代码的程序员来说，返回值的含义就变得非常明显了（考虑一下：`if (gears.changeGear(20) == GearSystem::GearChangeSuccess)`- 比上面的示例更清楚这意味着什么）

## 反模式：失败作为返回码。

我实际上省略了返回值的第四种可能性，因为在我看来它不是任何：当您的程序中出现错误时，例如逻辑错误或需要处理的故障 - 您理论上可以返回一个值指示所以。但是今天，这不再经常（或不应该）这样做，因为为此，有例外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T11:19:56.530

我不同意方法永远不应该返回 null。最明显的例子来自系统编程。例如，如果有人要求打开一个文件，如果打开失败，您只需给他们 null。没有明智的选择。在链表的最后一个节点上调用时，还有其他适用于 null 的情况，例如 getNextNode(node) 方法。所以我猜这些情况的共同点是 null 代表“没有对象”（没有文件句柄或没有列表节点），这是有道理的。

在其他情况下，该方法永远不会失败，并且有适当的异常工具。然后，我认为像您的示例这样的方法链接可以起到很好的作用。我认为您似乎认为这是“实用程序员”的创新，这有点可笑。事实上，如果不是更早的话，它可以追溯到 Lisp。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T17:12:19.077

Returning`this`也用于“构建器模式”，这是另一种方法链接可以增强可读性和编写便利性的情况。

null 通常作为带外值返回，以指示无法产生任何结果。我认为，当没有结果是正常事件时，这是完全合理的；示例将包括从`readLine()`文件末尾返回空值，或者在向 a 的`get(...)`方法提供不存在的键时返回空值`Map`。读取到文件末尾是正常行为（与 IOException 相反，IOException 表示尝试读取时出现异常错误）。同样，查找密钥并被告知它没有价值是正常情况。

在某些情况下，null 的一个很好的替代方法是“null object”，它是结果类的完整实例，但对于“nobody's home”情况具有适当的状态和行为。例如，查找不存在的用户 ID 的结果很可能是一个 NullUser 对象，该对象的名称长度为零，并且没有在系统中执行任何操作的权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T11:22:21.063

这让我很困惑。OO 编程语言需要 Smalltalk 的分号：

```
tree color: green;
     decor: gaudy;
     practical: false. 
```

对象方法1；方法2。表示“在 obj 上调用 method1，然后在 obj 上调用 method2”。这种对象设置很常见。

# oracle - 通过 Hibernate 在 Oracle 中存储日期

> ID：393678
> 
> 赞同：0
> 
> 时间：2008-12-26T10:43:16.417
> 
> 标签：oracle, hibernate

我通过休眠将一个简单的 java.util.date 存储在 Oracle XE 数据库中。

在使用 JUnit 进行测试时，如果我可以检索到正确的值，我会收到如下错误：

```
junit.framework.AssertionFailedError: 
  expected:<Sun Dec 28 11:20:27 CET 2008> 
  but was:<2008-12-28 11:20:27.0> 
```

该值存储在 Oracle 日期列（应该具有第二精度）中，这对我来说看起来不错。另外，令我惊讶的是 11:20:27 不等于 11:20:27.0。还是这与时区有关？

欢迎任何帮助。

托尔斯滕

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T18:29:21.060

好吧，再努力一点...

1.  Oracle 日期列仅存储精度为一秒的值。
2.  Java 日期确实包含毫秒，但通常不打印。所以

    预期的：

实际上是由像 11:20:27,345 这样的日期创建的，当然不等于 11:20:27.0

解决方案：

*   要么只使用完整的第二个日期来存储和检索，要么
*   获取休眠以创建正确的 Oracle 数据类型 (TIMESTAMP) - 这非常依赖于休眠配置中指定的方言（OracleDialect 和 Oracle10gDialect 创建不同的类型）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T18:15:58.497

如果将 a`java.util.Date`与`java.sql.Date`表示同一时间的 a 进行比较，`equals(Object)`将返回 false（它认为不同类的两个对象**永远**不相等）。

您的测试需要考虑到这一点。最简单的方法是将日期转换为 UNIX 时间（例如`java.util.Date.getTime()`）并比较这些值。

# sql - 将 Oracle 合并查询转换为 mysql mySQL 查询

> ID：393679
> 
> 赞同：2
> 
> 时间：2008-12-26T10:45:53.900
> 
> 标签：sql, mysql, oracle

```
 MERGE INTO PAGEEDITCONTROL A
      USING (SELECT
              '1585' AS PAGEID
       ,'admin' AS EDITUSER
       ,sysdate AS EDITDATE
          FROM DUAL) B
      ON (A.PAGEID = B.PAGEID)
      WHEN MATCHED THEN
      UPDATE SET
      A.EDITUSER = B.EDITUSER
     ,A.EDITDATE = B.EDITDATE
      WHEN NOT MATCHED THEN
   INSERT  (
      A.PAGEID
     ,A.EDITUSER
     ,A.EDITDATE
      )VALUES(
      B.PAGEID
     ,B.EDITUSER
     ,B.EDITDATE
      ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T09:12:59.010

```
INSERT INTO  
pageeditcontrol (pageid, edituser, editdate) 
VALUES  ('1585', 'admin', sysdate()) 
ON DUPLICATE KEY UPDATE 
edituser = values(edituser), 
editdate = values(editdate); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-27T13:21:44.987

MySQL 有一个类似的构造，它看起来不太像 upsert，但更像是 insate:（`INSERT ... ON DUPLICATE KEY UPDATE`请参阅[MySQL 参考手册](http://dev.mysql.com/doc/refman/5.1/en/insert-on-duplicate.html)）。

# windows-ce - 使用 VS.NET 2005 和 2008 时出现与 Windows CE 模拟器相关的错误

> ID：393681
> 
> 赞同：0
> 
> 时间：2008-12-26T10:51:13.827
> 
> 标签：windows-ce, fatal-error

我有一种情况，我需要在 Vs.NET 2008 和 VS.NET 2005 中调试 Windows CE 应用程序。

在这两个环境中的模拟器之间切换几次后，我得到了错误：

> 发生致命错误，需要终止调试。HRESULT=0x8013110e。错误代码 = 0x0。

为什么只有来回切换后才会发生？任务管理器显示足够的内存，我无法调试它。

可能是什么问题呢 ？

问候， 查克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-26T12:11:26.750

如果您在 XP 上[安装了 PAE](http://support.microsoft.com/kb/891667) ，这些仿真器会出现许多问题，肯定比链接的 MS 技术说明中建议的要多。尝试禁用 PAE 并查看它是否能解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T11:15:15.507

谢谢 。我们试过这个。但是，当我们在 VS.NET 2005 上部署应用程序时，它会这样做，但在 VS.NET 2008 应用程序上执行相同操作时，它无法在模拟器中加载。因此，共享资源似乎存在一些损坏。

如果我们卸载 2005 并仅在 2008 中工作，它就可以工作。

谢谢，查克。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-02T16:05:17.123

我敢打赌，这与同时安装两个开发环境有关。您可以一次安装多个 Visual Studio 日期版本，但它们必须按日期顺序安装。也许 2008 模拟器包与 2005 冲突？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T07:48:32.840

也许吧，但在我阅读您的邮件之前，我们只是将这两个装置放在两个不同的盒子上。也许就是这样。

谢谢。

# reportviewer - 更改 ReportViewer 货币格式？

> ID：393686
> 
> 赞同：3
> 
> 时间：2008-12-26T11:10:13.663
> 
> 标签：reportviewer, currency

我想知道如何将 Microsoft ReportViewer 中特定文本框的货币格式从美元 ($) 更改为欧元 (€)？

因为它总是在前面显示一个美元符号，格式是##,###.##，而对于欧元，它必须像##.###,##

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-03-02T18:04:44.093

添加到已经说明的选项：

您可以通过 Business Intelligence Studio（支持 SSRS 项目的 VS）将报表的 Language 属性设置为**=User!Language**。然后，这将获取当前线程的文化/语言环境。

当来自多个地区的用户使用相同的报告时，我不得不使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-26T12:04:03.757

那么解决该问题的方法是将通用报告 rdlc 语言更改为某些欧洲国家（例如我已将其更改为德语），并且货币字段按预期显示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-14T09:23:40.357

谢谢以上。在您的帮助下，我解决了我的问题，但我只是想为此添加一些细节，对于我们这些刚开始使用报表查看器的人。

我在VB2010中一步一步地做到了这一点

在解决方案资源管理器中右键单击报告选择打开方式然后选择自动编辑器选择器 (xml) 在报告标签旁边，输入以下标签。en-gb 应更改为您的国家/地区代码。

```
<Language>en-gb</Language> 
```

所以它应该看起来像这样

```
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition">
  <Language>en-gb</Language>
  <DataSources>
    <DataSource Name="DataSet"> 
```

希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-11T16:34:03.070

正如您所发现的，您需要更改报告的语言。

一些额外信息：您似乎无法通过 GUI 执行此操作，您需要编辑 RDLC 文件的 xml 中的 <Languuge> 元素。[此链接](http://msdn.microsoft.com/en-us/library/ms153956.aspx)是关于 RDL 文件的，但 RDLC 的详细信息相同。

# c# - 如何将我的属性添加到代码生成的 Linq2Sql 类属性？

> ID：393687
> 
> 赞同：23
> 
> 时间：2008-12-26T11:10:27.577
> 
> 标签：c#, linq-to-sql, attributes, code-generation

我想向 Linq 2 Sql 类属性添加属性。比如这个 Column 在 UI 中是可浏览的，或者在 UI 中是只读的等等。

我考虑过使用模板，有人知道如何使用它吗？或不同的东西？

一般来说，您会通过代码生成的类来解决这个问题吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-20T17:21:34.467

您可以利用 System.ComponentModel.DataAnnotations 中的新元数据功能，这将允许我们将元数据与现有域模型分开。

例如：

```
[MetadataType (typeof (BookingMetadata))]
public partial class Booking
{
 // This is your custom partial class     
}

public class BookingMetadata
{
 [Required] [StringLength(15)]
 public object ClientName { get; set; }

 [Range(1, 20)]
 public object NumberOfGuests { get; set; }

 [Required] [DataType(DataType.Date)]
 public object ArrivalDate { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-27T16:38:37.540

根据要求，这是一种使用 a`CustomTypeDescriptor`在运行时编辑属性的方法；这里的例子是win-forms，但是将它换成WPF看看它是否有效应该很简单......

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
// example POCO
class Foo {
    static Foo()
    {   // initializes the custom provider (the attribute-based approach doesn't allow
        // access to the original provider)
        TypeDescriptionProvider basic = TypeDescriptor.GetProvider(typeof(Foo));
        FooTypeDescriptionProvider custom = new FooTypeDescriptionProvider(basic);
        TypeDescriptor.AddProvider(custom, typeof(Foo));
    }
    public string Name { get; set; }
    public DateTime DateOfBirth { get; set; }
}
// example form
static class Program {
    [STAThread]
    static void Main() {
        Application.EnableVisualStyles();
        Application.Run( new Form {
                Controls = {
                    new DataGridView {
                        Dock = DockStyle.Fill,
                        DataSource = new BindingList<Foo> {
                            new Foo { Name = "Fred", DateOfBirth = DateTime.Today.AddYears(-20) }
                        }
                    }
                }
            });
    }
}

class FooTypeDescriptionProvider : TypeDescriptionProvider
{
    ICustomTypeDescriptor descriptor;
    public FooTypeDescriptionProvider(TypeDescriptionProvider parent) : base(parent) { }
    public override ICustomTypeDescriptor GetTypeDescriptor(Type objectType, object instance)
    {   // swap regular descriptor for bespoke (Foo) descriptor
        if (descriptor == null)
        {
            ICustomTypeDescriptor desc = base.GetTypeDescriptor(typeof(Foo), null);
            descriptor = new FooTypeDescriptor(desc);
        }
        return descriptor;
    }
}
class FooTypeDescriptor : CustomTypeDescriptor
{
    internal FooTypeDescriptor(ICustomTypeDescriptor parent) : base(parent) { }
    public override PropertyDescriptorCollection GetProperties()
    {   // wrap the properties
        return Wrap(base.GetProperties());
    }
    public override PropertyDescriptorCollection GetProperties(Attribute[] attributes)
    {   // wrap the properties
        return Wrap(base.GetProperties(attributes));
    }

    static PropertyDescriptorCollection Wrap(PropertyDescriptorCollection properties)
    {
        // here's where we have an opportunity to swap/add/remove properties
        // at runtime; we'll swap them for pass-thru properties with
        // edited atttibutes
        List<PropertyDescriptor> list = new List<PropertyDescriptor>(properties.Count);
        foreach (PropertyDescriptor prop in properties)
        {
            // add custom attributes here...
            string displayName = prop.DisplayName;
            if (string.IsNullOrEmpty(displayName)) displayName = prop.Name;

            list.Add(new ChainedPropertyDescriptor(prop, new DisplayNameAttribute("Foo:" + displayName)));
        }
        return new PropertyDescriptorCollection(list.ToArray(), true);
    }
}

class ChainedPropertyDescriptor : PropertyDescriptor
{
    // this passes all requests through to the underlying (parent)
    // descriptor, but has custom attributes etc;
    // we could also override properties here...
    private readonly PropertyDescriptor parent;
    public ChainedPropertyDescriptor(PropertyDescriptor parent, params Attribute[] attributes)
        : base(parent, attributes)
    {
        this.parent = parent;
    }
    public override bool ShouldSerializeValue(object component) { return parent.ShouldSerializeValue(component); }
    public override void SetValue(object component, object value) { parent.SetValue(component, value); }
    public override object GetValue(object component) { return parent.GetValue(component); }
    public override void ResetValue(object component) { parent.ResetValue(component); }
    public override Type PropertyType {get { return parent.PropertyType; } }
    public override bool IsReadOnly { get { return parent.IsReadOnly; } }
    public override bool CanResetValue(object component) {return parent.CanResetValue(component);}
    public override Type ComponentType { get { return parent.ComponentType; } }
    public override void AddValueChanged(object component, EventHandler handler) {parent.AddValueChanged(component, handler);  }
    public override void RemoveValueChanged(object component, EventHandler handler) { parent.RemoveValueChanged(component, handler); }
    public override bool SupportsChangeEvents { get { return parent.SupportsChangeEvents; } }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T11:15:51.000

您可能需要考虑[为 Linq To Sql 使用 Damien Guard 的 T4 模板](http://damieng.com/blog/2008/09/14/linq-to-sql-template-for-visual-studio-2008)。修改他的模板很可能会给你你想要的结果。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T11:25:17.267

这是代码生成的常见问题；虽然您可以通过额外的部分类添加成员和*类级别属性，但您不能向生成的成员添加属性。*作为补偿，一些基于属性的机制允许您在类中指定属性（命名成员），但不能指定您引用的任何属性。

一个核心选​​项是编写一个为属性`TypeDescriptionProvider`提供自定义定义的。`PropertyDescriptor`这将允许您完全控制 UI 绑定工具（如`PropertyGrid`、`DataGridView`等）使用的元数据。

但是，如果您也可以手动设置它们，那么仅仅设置一些 UI 属性可能是太多的工作！但是，如果您有兴趣追求该选项，请告诉我 - 这是我熟悉的领域，但如果您不想要它，编写示例的代码太多。

注意：如果你使用的是`PropertyGrid`，那么你*不能*手动设置属性，但是你可以写一个`TypeConverter`，这比一个完整的工作少一点`TypeDescriptionProvider`；只需继承`ExpandableObjectConverter`并覆盖`GetProperties()`. 你仍然需要一个垫片`PropertyDescriptor`，所以仍然不是微不足道的......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-26T14:25:41.457

您可以使用分部类使您的实体实现一个接口，该接口声明您的实体的相同属性，然后将属性放在接口上。

这样您就可以使用接口类型从属性中获取属性。

我不知道您是否能够以这种方式使用属性，但您可以尝试类似的方法。

例子：

```
 public interface IConcept {
    long Code { get; set; }
    [Unique]
    string Name { get; set; }
    bool IsDefault { get; set; }
}

public partial class Concept : IConcept { }

[Table(Name="dbo.Concepts")]
public partial class Concept
{
//...
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-26T14:39:48.997

您还可以编写/使用另一个代码生成器来代替默认的 MSLinqToSQLGenerator。

一个开始的选择是[这个](http://www.codeplex.com/ULinqGen)。

我根据自己的需要建立了自己的。我不知道是否有一种方法可以使用 DBML Designer 或 xml 文件指示必须在每个属性中放置哪些属性，但也许您可以找到一种方法来使用这种替代方法来帮助您解决问题。

# asp.net-mvc - 在 ASP.NET MVC 框架中使用 MicrosoftReportView 控件的最佳方法是什么？

> ID：393698
> 
> 赞同：3
> 
> 时间：2008-12-26T11:28:35.777
> 
> 标签：asp.net-mvc, reportviewer

和我的问题标题一模一样

在 ASP.NET MVC 框架中使用 MicrosoftReportView 控件的最佳方法是什么？

我需要在 asp.net mvc 应用程序中使用报表查看器控件，但我很困惑如何在 mvc 框架中使用该控件而不违反 mvc 模式。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T11:52:44.793

您可以在同一个应用程序中混合使用 WebForms 和 MVC 页面，因此您可能只想为需要 ReportView 的页面开发一个 WebForms 页面。Hanselman在他的博客[中描述了一个类似的场景。](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)如果您在 MVC 页面中需要它，您可能希望查看以下内容以获取有关如何执行此操作的提示。我不知道这个特定的控件是否会起作用，因为我还没有尝试过。

[http://codebetter.com/blogs/david.hayden/archive/2007/12/27/asp-net-mvc-and-accessing-server-controls-in-codebehind.aspx](http://codebetter.com/blogs/david.hayden/archive/2007/12/27/asp-net-mvc-and-accessing-server-controls-in-codebehind.aspx)

[http://flux88.com/blog/leveraging-existing-asp-net-features-in-asp-net-mvc/](http://flux88.com/blog/leveraging-existing-asp-net-features-in-asp-net-mvc/)

# c# - 为什么 C# 编译器不调用隐式强制转换运算符？

> ID：393701
> 
> 赞同：6
> 
> 时间：2008-12-26T11:32:20.733
> 
> 标签：c#, casting, operator-overloading, compiler-errors

假设我们有以下类型：

```
struct MyNullable<T> where T : struct
{
    T Value;

    public bool HasValue;

    public MyNullable(T value)
    {
        this.Value = value;
        this.HasValue = true;
    }

    public static implicit operator T(MyNullable<T> value)
    {
        return value.HasValue ? value.Value : default(T);
    }
} 
```

并尝试编译以下代码片段：

```
MyNullable<int> i1 = new MyNullable<int>(1);
MyNullable<int> i2 = new MyNullable<int>(2);

int i = i1 + i2; 
```

这剪辑编译得很好，没有错误。i1 和 i2 转换为整数并评估加法。

但是如果我们有以下类型：

```
struct Money
{
    double Amount;
    CurrencyCodes Currency; /*enum CurrencyCode { ... } */

    public Money(double amount, CurrencyCodes currency)
    {
        Amount = amount;
        Currency = currency;
    }

    public static Money operator + (Money x, Money y)
    {
        if (x.Currency != y.Currency)
            // Suppose we implemented method ConvertTo
            y = y.ConvertTo(x.Currency); 

        return new Money(x.Amount + y.Amount, x.Currency);
    }
} 
```

尝试编译另一个代码片段：

```
MyNullable<Money> m1 = 
   new MyNullable<Money>(new Money(10, CurrenciesCode.USD));
MyNullable<Money> m2 = 
   new MyNullable<Money>(new Money(20, CurrenciesCode.USD));

Money m3 = m1 + m2; 
```

现在的问题是，为什么编译器会生成“*错误 CS0019：运算符 '+' 不能应用于 'MyNullable<Money>' 和 'MyNullable<Money>' 类型的操作数*”？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-26T11:57:57.807

这是一个有趣的问题......它适用于`Decimal`，例如，但不是`TimeSpan`，它们都是正确的 .NET 类型（不像`float`等是原语）并且都有一个 + 运算符。好奇的！

当然，您可以使用以下方法扭动手臂：

```
Money m3 = (Money)m1 + (Money)m2; 
```

当然，您只需使用`Nullable<T>`它就可以免费工作 - 再加上您可以获得编译器 + 运行时（装箱）支持。有理由不在这里使用`Nullable<T>`吗？

我会看看规格；在此期间，您可能会考虑将运算符提升到`MyNullable<T>`; 使用常规`Nullable<T>`，C# 编译器为该类型支持的那些提供“提升”运算符，但您不能自己这样做。你能做的最好的就是提供所有明显的，并希望类型支持它；-p 要使用泛型访问运算符，请参见[此处，可在](http://www.pobox.com/~skeet/csharp/miscutil/usage/genericoperators.html)[此处](http://www.pobox.com/~skeet/csharp/miscutil/)免费下载。

请注意，您可能希望应用适当的“提升”检查 - 即

```
x + y => (x.HasValue && y.HasValue)
          ? new MyNullable<T>(x.Value + y.Value)
          : new MyNullable<T>(); 
```

**更新**

*不同的处理看起来与 14.7.4（ECMA 334 v4）“加法运算符”有关，其中它是为包括*十进制在内的一系列类型预定义的（所以这对我来说是一个糟糕的测试），因为从 14.2.4（同样）“二元运算符重载决议”，预定义的运算符确实得到特别提及。不过，我并不声称完全理解它。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-27T12:16:54.947

Marc 在正确的路线上 - 它是 C# 3.0 规范中的第 7.2.4 节 - 二进制运算符重载解决方案。

基本上步骤是：

*   我们需要解决“X + Y”的实现，其中 X 和 Y 都是`MyNullable<Money>`。
*   查看第 7.2.5 节（候选用户定义的运算符），我们最终得到一个空集，因为`MyNullable<T>`不会重载 +。
*   在 7.2.4 中，候选运算符集是内置的二元运算符集，用于 +，即 int+int、decimal+decimal 等。
*   *然后*应用7.4.3 中的重载解决规则。当我们这样做时`MyNullable<int> + MyNullable<int>`，由于每个参数的隐式转换为`int`- 但当我们这样做`MyNullable<Money> + MyNullable<Money>`时它*不起作用，*因为`Money + Money`不在候选运算符集中。

# c# - 如何在 C# XML 注释中链接/分组重载？

> ID：393707
> 
> 赞同：6
> 
> 时间：2008-12-26T11:45:03.670
> 
> 标签：c#, overloading, sandcastle, xml-comments

在 C# 的 XML 文档注释中，有没有办法将两个或多个函数标记为彼此重载，以便它们自动相互引用？理想情况下，它们也会以某种方式被分组在沙堡生成的文档中。

目的：通常，我想链接到这组函数，例如在实用函数列表中，只需提及其中一个重载，并让其他重载从那里很容易被发现。

目前我正在添加链接，但这很乏味。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T12:08:47.710

XMl 文档和 Sandcastle 已经识别和分组了多个重载之间的关系。

`see`使用或`seealso`标签创建指向其他成员的链接。

例如。

```
///See <see cref="M:AnotherMethod(System.String)"> 
```

虽然我发现 Sandcastle 成员解析可能有点不稳定，所以我倾向于使用完全限定名称。

```
///See <see cref="M:MyCompany.Myapp.MyClass.AnotherMethod(System.String)"> 
```

注意 M: 表示一个成员被引用，你也使用 E: 来指向一个事件。T: 用于类型，但如果不存在则假定为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-09T16:34:54.590

分组是由 Sandcastle 自动完成的，对，但是如果你想给重载组一个通用的描述，请使用 <overloads> 标记（与 <summary> 相同）。它不是一个标准的 XML 文档标签，但是 Sandcastle Help File Builder 支持它。

# vb6 - Vista ProgramData 文件夹中缺少文件

> ID：393708
> 
> 赞同：2
> 
> 时间：2008-12-26T11:46:08.520
> 
> 标签：vb6, windows-vista, vista64, programdata

我有一个旧版 VB6 程序，它在公共数据文件夹 (CSIDL_COMMON_APPDATA) 的子目录中安装了一个 Access 文件。我现在已经在 64 位 Vista 系统上安装了这个程序，并且该程序运行良好并且可以访问 C:\ProgramData\Wow\WowCat.mdb 中的文件，但是这个文件没有显示在 Windows 资源管理器中。

我想用从我的旧 PC 获取的更高版本覆盖这个数据库，但是使用资源管理器我看不到 C:\ProgramData\Wow\ 中的文件（我正在显示所有隐藏文件和系统文件）。如果我继续复制新的 WowCat.mdb，程序仍然可以与旧的程序一起使用。

在 VB 中单步执行代码，它肯定是在以下位置打开文件：C:\ProgramData\Wow\WowCat.mdb。搜索 C: 驱动器只显示新副本，那么程序正在访问的那个在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T12:10:19.030

这是因为 Windows Vista 中的文件夹重定向。如果您通常无权将某些内容写入 C:\Program Files 文件夹，Vista 将默默地将这些写入重定向到您用户目录中的“秘密”文件夹中。该文件对于创建该文件的用户（以及以该用户身份运行的任何程序）仍然可见，但对其他人不可见。因此，您的程序可能以与 Explorer 不同的用户身份运行，因此 Explorer 看不到它。

在我的 Vista 64 位机器上查看 dir /aL 的以下输出：

```
C:\ProgramData>dir /aL
 Volume in drive C has no label.
 Volume Serial Number is 74DB-58F8

 Directory of C:\ProgramData

02.11.2006  16:41    <JUNCTION>     Application Data [C:\ProgramData]
02.11.2006  16:41    <JUNCTION>     Desktop [C:\Users\Public\Desktop]
02.11.2006  16:41    <JUNCTION>     Documents [C:\Users\Public\Documents]
02.11.2006  16:41    <JUNCTION>     Favorites [C:\Users\Public\Favorites]
02.11.2006  16:41    <JUNCTION>     Start Menu [C:\ProgramData\Microsoft\Windows\Start Menu]
02.11.2006  16:41    <JUNCTION>     Templates [C:\ProgramData\Microsoft\Windows\Templates]
               0 File(s)              0 bytes
               6 Dir(s)  62 040 051 712 bytes free 
```

该功能称为重解析点或交汇点，具体取决于您在何处阅读它们。它们与 Unix 中的符号链接非常相​​似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T19:10:07.497

正确执行此操作需要运行提升的 Windows 安装程序 MSI 或旧版安装程序，在 CommonAppDataFolder 下创建一个子文件夹，为每个人（或适当的组）提供对该文件夹的完全控制，最后将您的 MDB 放在那里。您还可以创建文件夹，将 MDB 文件移到那里，然后仅对文件设置权限。

如果 EXE 运行提升或检测到遗漏并产生提升的进程来完成这项工作，那么 EXE 本身也可以在第一次运行时执行此操作。标准规定，此操作应通过显示 UAC Shield 图标的菜单项或按钮启动，而不仅仅是弹出 UAC 提示。

不过，通过 MSI 包，这一切都容易得多。

# java - Oracle ATG 和 Struts 的区别？

> ID：393723
> 
> 赞同：16
> 
> 时间：2008-12-26T12:31:33.607
> 
> 标签：java, model-view-controller, struts, atg

Oracle ATG 和 Struts 有什么区别？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-12-30T12:17:18.813

Struts 是一个用于在 J2EE Web 应用程序中使用的框架，它试图为 Web 应用程序提供基于 MVC 模式的编码方法。它包括一些用于表单数据验证等的附加实用程序。它是一个开源项目，非常擅长解决 Web 应用程序难题的特定部分，并且仅限于解决特定部分。

另一方面，ATG (ATG Dynamo) 是一个应用程序平台 - 一个解决方案和一个框架 - 用于构建数据和内容驱动的 Web 应用程序 - 主要用于商业和出版。在框架级别，它是一个基于 Java 的应用程序平台，用于托管基于 Web 的应用程序以及 RMI 可访问的业务组件，具有 ORM 层、组件容器、MVC 框架和一组用于 JSP 的标记库。组件框架（The Nucleus）是一个轻量级容器，用于管理 Java 组件对象（bean）的生命周期和依赖绑定（依赖注入）。从这个意义上说，它有点类似于 Spring bean 容器，并且是 ATG 框架的核心——所有其他服务和框架都托管在其中。ORM 层框架（存储库）将对象映射到关系数据库（正如您所期望的那样）。但它也可以使用相同的一致数据访问 API 处理与 LDAP、XML 和文件系统数据源的映射。用于将页面上的表单元素绑定到业务对象等的值的 JSP 标记比我见过的任何其他框架中的表单绑定标记都更加优雅和简洁。与标准 J2EE 标记相比，编写您自己的标记库等效项（Droplets）的机制与 Servlet API 更加一致。

MVC 框架（基本的 Form 处理程序模式）有点类似于 Struts 的 Form 和 Action 类——但它提供了一个比 Struts 更基本的框架。开箱即用，在大多数开发人员工作的级别上，ATG 模型是页面驱动的，而不是控制器驱动的。在内部，它肯定是控制器驱动的，使用管道方法链接调度程序和控制器。

此外，基本级别的框架为您提供了 RMI 容器、分布式缓存、分布式锁定和分布式单例、分布式事件和消息传递、任务调度程序、规则引擎以及用于定义具有自定义操作和结果的业务工作流的机制，用于业务工作流的图形编辑器，支持版本化数据，支持角色和权限，日志记录和审计——所有这些都是开箱即用的，并且都使用非常一致和一致的 API

然后在解决方案级别，您拥有用于处理用户分析、身份管理和个性化、内容创作、版本控制和发布、内容搜索、有形和无形商品的产品目录、产品搜索和引导导航、定价的组件和 API，税收计算、促销、购物车、礼品清单和愿望清单、付款方式、运输方式、订单跟踪、客户关系管理等。

ATG 的扩展点和集成点通常设计得非常好，并且有很好的文档记录。它们支持与电子商务和出版领域的几乎任何人进行集成，例如创作和内容管理、身份管理和安全、产品目录、搜索和引导导航等。此外，框架的几乎所有领域都是可扩展的和可插入的，因此您可以编写自己的组件来增强或替换开箱即用的组件。

比较两者并没有多大意义。但是，鉴于您的问题，我想您真正感兴趣的是 ATG 的 MVC 部分

对于 MVC，Struts 比 ATG 提供的更多（但 Spring MVC 比 Struts 提供的更多）。但是，与使用 ATG 相比，Struts 更容易陷入框架机制的困境。

就我个人而言，我认为 ATG 的基于表单处理程序的模型比我见过的大多数其他 Web MVC 框架更优雅、更简洁、更易于使用，并且 API 与 Servlet API 更一致。

还要记住，大多数“web-MVC”框架不像真正的 MVC（即在 Smalltalk 甚至 Java Swing 等中用于 GUI 编程的模式）。Struts 和 ATG 都没有提供（如设计的那样）真正的 MVC——尽管 ATG 实际上更接近。关于术语有很多混淆。

例如，

1.  真正的**MVC**中的模型不是您的数据模型，也不是您的域模型对象。它是代表视图中所有数据的模型。如果这恰好是一个域模型对象，那么很好——但通常情况下，您会发现您需要一组不同的视图或表单对象。此外，模型负责保持自身的更新——它是与下层业务服务交互的模型。ATG 倾向于将模型和控制器融合为一个组件——表单处理程序。Struts 倾向于保持视图数据模型的不同（表单对象），但不鼓励将其用作真正 MVC 意义上的模型——它不是与其他业务服务交互以保持自身更新的表单对象。

2.  MVC 中的控制器不是您的业务**控制器**。MVC 中的控制器是视图和模型之间的管道。它对视图中的更改或在视图上执行的操作做出反应，并指示模型相应地更新自身。在 Struts 中，他们谈论的 Controller 根本不是 MVC 控制器——它实际上是一个调度程序。许多属于控制器的代码最终都在您的 Action 类中。但是按照 Struts 的设计方式，Action 类实际上是为了做模型所做的事情。

3.  **MVC**中的View 应该由模型填充 - 它是模型更新视图的推送机制，而不是视图查询模型的拉取机制。在大多数 web-MVC 框架中，视图（通常是 JSP）从模型中提取状态以显示自身。ATG 的页面驱动方法尤其如此。如果您发现在呈现页面时正在获取数据，则意味着您的 MVC 设计有问题。

在 Struts 中，MVC Controller 的功能分布在 Struts 控制器和 Action 上，而 MVC Model 的功能分布在 Form 对象和 Action 上。

在 ATG 中，MVC Controller 和 MVC Model 的功能都在 Form-handler 中

话虽如此，由于 HTTP 的请求-响应特性，Web-MVC 框架中 Controller 的功能非常有限。对于 Web 应用程序，我们倾向于在提交表单时获得完全更新的视图，而不是像使用丰富的 UI 框架那样进行大量小的更改（例如，每次按键或鼠标单击，或每个更改的输入字段）。AJAX 的使用正在改变这一点——我们必须更多地考虑正确实现 MVC。

请记住，MVC 是一种设计模式——也就是说，它是设计应用程序的 GUI 方面时要使用的设计时原则。Struts 和 ATG 是框架 - 即它们是在构建应用程序时要扩展、实现或配置的类和对象。框架不能强制使用设计模式——它只能鼓励它。选择使用特定的框架不会让你更好地设计你的 ciode - 最多它可能会鼓励某种学科。

如果你的 MVC 设计得很好，那么无论你使用 Struts 类还是 ATG 类来实现它都不会有很大的不同。同样，如果您设计的 MVC 很糟糕，希望您选择的框架能够弥补您的不足，那么无论您使用 Struts 还是 ATG，都不会产生太大的影响。如果您了解并使用设计原则，您会发现在框架之间来回切换非常容易。

最好的代码将是在抽象中遵循良好的设计原则（例如，真正的 MVC），并使用所选框架中可用的正确工具以预期使用的方式实现它（实现它）的代码。

回到你的问题；

如果您正在处理 ATG 项目，则应使用 ATG 提供的框架。将 Struts 硬塞到 ATG 应用程序中当然是可能的——我自己很多年前就做过了——但付出的努力远远超过了它的价值——而且你放弃了很多 ATG 开箱即用的东西对象生命周期管理、表单数据绑定等。

如果您即将开始一个新项目并且可以选择要使用的框架——我个人会推荐一个开源应用程序服务器（如 JBoss）和 Spring 框架——它为您提供了 ATG 和 Struts 提供的最好的东西。它有一个类似 Nucleus 的组件容器（应用程序上下文），它集成了所有优秀的 ORM 解决方案（如 Hibernate），并包含一个 MVC 框架，在我看来，它已经远远超过了 Struts。此外，我建议查看 Spring Web-flow 以获得更高级别的 GUI 流设计。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-08-05T10:37:40.957

The main difference in the UK is that as an ATG contractor you can get £500 per day, but as a general Struts guy you're lucky to get £350\.

Not that I'm bitter at all.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-04-05T10:03:13.987

ATG 是专有软件...资源较少...

# .net - 如何将 CMS 添加到现有网站

> ID：393725
> 
> 赞同：9
> 
> 时间：2008-12-26T12:34:37.563
> 
> 标签：.net, asp.net, content-management-system

我有一个现有的 ASP.NET 网站，我想轻松地添加 CMS 功能。

该网站是房地产经纪人的房地产网站，并由数据库等支持。但是有些页面如“关于我们”等。我希望用户能够使用简单的 CMS 进行编辑。我还希望用户能够创建新页面并将它们放入导航系统。

该站点是多语言的，数据库部分使用资源文件来存储它使用的字符串。该站点使用 ASP.NET 母版页和主题，我希望 CMS 使用这些来添加新页面并支持多语言。

现在我可以清楚地编写自己的简单 CMS，但不想重新发明轮子，是否有任何现有的 ASP.NET CMS 可以添加到现有站点并利用我已经拥有的母版页模型。

编辑：我看过 DNN、Umbraco、My Web Pages Starter Kit、Graffti CMS、Sitefinity.net，但据我所知，这些都不容易改装。我还想避免（如果可能）使用 FCK 编辑器编写我自己的系统。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-26T13:36:11.900

我会第二次提到N2。它是唯一不接管站点并为您提供对内容存储库的编程访问权限的站点之一。大多数 CMS 都面向网站的整个前端展示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T12:40:54.540

如果您只想要一个“简单”的所见即所得编辑器，请尝试使用[FCKEditor](http://www.fckeditor.net/) ( [.Net Integration](http://docs.fckeditor.net/FCKeditor_2.x/Developers_Guide/Integration/ASP.NET) ) 或[WMD-Editor](http://wmd-editor.com/) (Stack Overflow 使用的那个)

...或者，如果您的目标是一个成熟的 CMS 系统，请查看[DotNetNuke](http://www.dotnetnuke.com/)或[N2](http://n2cms.com/)，它们都是基于开源 .NET 的 CMS

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-26T22:19:05.417

请记住，DNN 是在 VB Net 上编写的，但 N2 和 Cuyahoga 是在 C# 上编写的，我认为两者都是在 .net 框架 3.5 上编写的；两者都是可扩展的，我认为你可以在你的网站上使用它们，N2 更像是一个开发你的 CMS 的框架。

希望这可以帮助你

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T22:08:09.263

对于简单的东西，最简单的方法是使用 FCKEditor（或类似的）、VARCHAR(MAX) 字段和后端管理工具将您自己的类似 CMS 的功能写入管理工具。我已经使用我正在处理的应用程序完成了这项工作，该应用程序不容易适应任何 CMS 模型，但需要一些 CMS 功能。

当您的应用程序适合 CMS 的核心功能或者可以轻松扩展而无需破解或增加不必要的复杂性时，CMS 似乎效果最佳。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-23T23:24:23.383

查看[webYEP](http://www.obdev.at/products/webyep/index.html)。它不是免费的，但它并不离谱。我相信它只需要 PHP 来运行编辑器，并且您的网站可以是 HTML 或 .NET 或其他格式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-24T20:58:59.833

[http://www.cushycms.com/](http://www.cushycms.com/)应该可以使用，假设您可以使用 DIV。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-26T22:58:24.807

我建议查看 Kentico CMS。它非常灵活并使用母版页。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T06:41:20.333

Christopher-我会尝试 Bizzuka CMS。易用性、灵活性和可扩展性都在那里。如果你想免费试驾，我可以给你钥匙。我与 Joomla、Drupal 和许多其他人一起工作，这里的 UI 非常出色。如果您想尝试，请告诉我 ( [http://twitter.com/chasl](http://twitter.com/chasl) )，我会给您一个用户名和密码。

# delphi - 使用 Delphi Win32 编写 SOAP 1.2 客户端的最佳方法是什么

> ID：393727
> 
> 赞同：10
> 
> 时间：2008-12-26T12:41:10.530
> 
> 标签：delphi, soap, components, soap-client

到目前为止，没有任何 Delphi 版本支持[SOAP](http://en.wikipedia.org/wiki/SOAP_%28protocol%29) 1.2 客户端或服务器。

我已经尝试了几个星期让它工作，但每次出现新问题时，使用 VS/C# 我可以做同样的事情，并在 3 天内完成工作，但我需要使用 Delphi 2009。

“我使用 Rem Objects SDK 编写了一个新版本”，但结果并不比我使用 Delphi SOAP 库的结果好。

但我想知道我还有什么选择，哪个库/组件完全支持 SOAP 1.2？

我发现来自 Bruneau 的一条消息，建议使用 Pocket SOAP [http://www.pocketsoap.com/pocketsoap/](http://www.pocketsoap.com/pocketsoap/) 我不知道这是如何工作的，我会调查一下，看看我能做什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-29T04:10:37.203

记得在 codegear 的 QC 上投票支持 SOAP 1.2：

[http://qc.codegear.com/wc/qcmain.aspx?d=66864](http://qc.codegear.com/wc/qcmain.aspx?d=66864)

目前，它被选为 Delphi 的#2 报告（在 64 位支持之后）。我真的很确定 CodeGear 不会忽视这一点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-03-20T20:19:12.473

跟进。 [这已在 Delphi 2010 中实现](http://qc.embarcadero.com/wc/qcmain.aspx?rc=66864)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T10:23:49.743

我建议你深入挖掘源头。使用 Delphi 7，我可以通过将 SOAP 代码复制到我的应用程序文件夹并仔细编辑它来添加各种附加功能。在一种情况下，我做了一些字符串操作来调整传入的 SOAP 数据包，使其与 Delphi 的工作方式一致。我还没有用 RemObjects 做这个，但是你也得到了它的源代码。另外，他们有活跃的新闻组，您可以在上面提问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-20T12:35:53.093

在某些情况下，我发现用 C# 和 VS 编写代理 SOAP 服务要容易得多，并通过简化的服务描述 (WSDL) 从 Delphi 中使用它。从长远来看，它是最有效的解决方案，在稳定性或性能方面没有任何问题。Delphi 中的 SOAP 支持并不是它的亮点之一。

# c# - 通用转换功能似乎不适用于 Guid

> ID：393731
> 
> 赞同：49
> 
> 时间：2008-12-26T12:45:12.080
> 
> 标签：c#, .net, generics, typeconverter

我有以下代码：

```
public static T ParameterFetchValue<T>(string parameterKey)
{
    Parameter result = null;

    result = ParameterRepository.FetchParameter(parameterKey);

    return (T)Convert.ChangeType(result.CurrentValue, typeof(T), CultureInfo.InvariantCulture);  
} 
```

的类型**`result.CurrentValue`是字符串**。我希望能够将其转换为 Guid，但我不断收到错误消息：

> 从 System.String 到 System.Guid 的无效转换

这与原始数据类型完美配合。
有什么方法可以**使这项工作适用于非原始数据类型**？

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2008-12-26T13:52:13.367

怎么样：

```
T t = (T)TypeDescriptor.GetConverter(typeof(T)).ConvertFromInvariantString(text); 
```

适用于`Guid`和大多数其他类型。

# java - 如何使用文件中的测试数据预填充模型对象？

> ID：393733
> 
> 赞同：1
> 
> 时间：2008-12-26T12:47:37.600
> 
> 标签：java, windows

我在我的 Java 客户端应用程序中使用了一些模型对象。稍后，这些模型对象将从远程服务（例如 SOAP）中填充/检索。现在我想在实现这些服务之前对前端进行手动/自动测试。模型对象主要是 POJO，我想将一些示例测试数据存储在文件中，并用一些简单的方法填充它们。

例如，有模型对象学校（名称（字符串）和教师（列表））和教师的姓氏和名字，我想将实际测试数据存储在一些 XML/文本文件中，并从这些数据中创建一些包含教师的学校。

你在这种情况下使用什么？我还不熟悉 TTD，但我无法想象没有通用框架可以做到这一点。

[编辑] 我选择 Spring 来模拟我的示例数据/服务，但这里提到的其他替代方案也可以。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-26T13:27:54.193

听起来像是很好地使用了 XML 序列化。您可以使用任何您喜欢的 XML 序列化工具：XStream 等。

另一个不错的工具是 SOAP UI。如果您将它指向您的服务的 WSDL，它将为您创建 XML 请求。填写值，然后离开。这些可以保存，所以也许这是生成测试用例的好方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T13:53:02.710

您还可以使用 Spring 来模拟您的远程服务及其响应。在这种情况下，您所要做的就是加载一个 applicationContext，它将通过准确回复您想要的测试目的来模拟您的后端系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T14:06:50.730

为什么不将测试数据保存在 Java 中？您无需处理额外的阶段、格式或库。它速度很快，而且您拥有 Java 的强大功能和熟悉度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T16:48:07.690

首先，我同意 duffymo 的观点，即 XStream 和 SOAP UI 是可行的选择。但是，我也使用了 Tom Hawtin 描述的方法，如下所述。

帮助类构建模型类的一组测试实例，一些有效的和一些无效的以特定方式，并构建适当的对象图。初始测试用例使用有效的对象对象图。后续测试用无效对象替换初始设置中的有效对象，检查是否返回了适当的错误。

帮助器类为构造对象提供了单点控制，这些对象的内容与测试所需的场景适当相关。

# css - 如何创建 Facebook 风格的固定状态栏？

> ID：393736
> 
> 赞同：7
> 
> 时间：2008-12-26T12:50:24.550
> 
> 标签：css, layout

我想通过网络表单创建固定状态栏以向用户显示各种状态/消息/通知，我可以使用固定的 CSS 属性，但我想在 ie 6/7 和 Firefox 中实现。和所有的浏览器。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T20:31:18.397

这是关于如何修复底部页面上的元素/栏的快速简便的解决方案：

[jixedbar - 固定底部栏，如 Facebook](http://jixedbar.rawswift.com/)

现在您接下来要做的就是找到一个 AJAX 框架（原型、jquery 等）并开始编写您的自定义菜单（应用程序、通知、滑块等）或类似于 Facebook 中的菜单。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-26T13:08:47.040

Dean Edwards 的[“IE7”JavaScript 库](http://dean.edwards.name/IE7/)可能会有所帮助。它固定位置：固定在 IE6 中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-26T13:45:56.297

我想你想要一个[粘性页脚](http://ryanfait.com/sticky-footer/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-24T11:31:35.970

那里有几个。例如，看看tickbar，它看起来很可配置：[http ://www.ticketmy.com/bumpin/socialbar/index.php](http://www.ticketmy.com/bumpin/socialbar/index.php)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-15T01:38:51.010

这是一个非常简单的[通知栏](http://www.hellobar.com/solo/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T22:49:36.160

我想知道是否有一种快速而肮脏的方法来保存站点中那个酒吧中某些东西的状态......

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-08-24T01:14:08.183

查看此帖子[Facebook 样式页脚管理面板](http://www.sohtanaka.com/web-design/facebook-style-footer-admin-panel-part-1/)

# python - 程序化表单提交

> ID：393738
> 
> 赞同：3
> 
> 时间：2008-12-26T12:54:27.413
> 
> 标签：python, forms, screen-scraping, submit

我想抓取网页的内容。内容是在该网站上的表格填写并提交后生成的。

我已阅读有关如何抓取最终结果内容/网页的信息 - 但如何以编程方式提交表单？

我正在使用 python 并已阅读我可能需要获取带有表单的原始网页，解析它，获取表单参数，然后执行 X?

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T13:25:55.383

您需要生成一个包含表单数据的 HTTP 请求。

表单将类似于：

```
<form action="submit.php" method="POST"> ... </form> 
```

这告诉您请求的 url 是 www.example.com/submit.php 并且您的请求应该是 POST。

在表单中会有几个输入项，例如：

```
<input type="text" name="itemnumber"> ... </input> 
```

您需要为附加到您请求的 URL 末尾的 URL 创建所有这些输入名称 = 值对的字符串，该 URL 现在变为 www.example.com/submit.php?itemnumber=5234&otherinput=othervalue 等...对于 GET 可以正常工作。POST 有点棘手。

```
</motivation> 
```

只需按照 S.Lott 的链接获取一些更易于使用的库支持：P

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T13:29:29.573

使用python，我认为它需要以下步骤：

1.  解析包含表单的网页，找出表单提交地址和提交方法（“post”或“get”）。

[这解释了 html 文件中的表单元素](http://www.w3.org/TR/html401/interact/forms.html)

2.  使用 urllib2 提交表单。您可能需要一些函数，如 urllib 中的“urlencode”、“quote”来为 post 方法生成 url 和数据。阅读图书馆文档了解详情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-26T13:45:29.417

从一个类似的问题 - [options-for-html-scraping](https://stackoverflow.com/questions/2861/options-for-html-scraping) - 你可以了解到使用 Python 你可以使用[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)。

> Beautiful Soup 是一个 Python HTML/XML 解析器，专为屏幕抓取等快速周转项目而设计。三个功能使其功能强大：
> 
> 1.  如果你给它错误的标记，Beautiful Soup 不会窒息。它会生成一个解析树，其意义与您的原始文档大致相同。这通常足以收集您需要的数据并逃跑。
> 2.  Beautiful Soup 提供了一些用于导航、搜索和修改解析树的简单方法和 Pythonic 习惯用法：用于剖析文档和提取所需内容的工具包。您不必为每个应用程序创建自定义解析器。
> 3.  Beautiful Soup 自动将传入文档转换为 Unicode，将传出文档自动转换为 UTF-8。您不必考虑编码，除非文档未指定编码并且 Beautiful Soup 无法自动检测编码。然后你只需要指定原始编码。

这个不寻常的名字[引起了我们主持人的注意](https://blog.stackoverflow.com/2008/11/podcast-29/)，2008 年 11 月 12 日。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-26T13:10:50.190

你可以用javascript来做到这一点。如果表格是这样的：

```
<form name='myform' ... 
```

然后你可以在javascript中做到这一点：

```
<script language="JavaScript">
function submitform()
{
document.myform.submit();
}
</script> 
```

您可以使用链接或按钮的“onClick”属性来调用此代码。要在加载页面时自动调用它，请使用元素的“onLoad”属性：

```
<body onLoad="submitform()" ...> 
```

# delphi - Delphi Windows 服务命令行参数

> ID：393742
> 
> 赞同：6
> 
> 时间：2008-12-26T13:02:04.747
> 
> 标签：delphi, windows-services

我有一个基于 Deplhi 的 Windows 服务，它在安装时会解析一些命令行参数。我希望将这些参数添加到服务命令行（注册表上的 ImagePath 值），以便始终使用它们启动服务。

我怎样才能做到这一点？

我希望 regedit 看起来像这样：
在注册表项 HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\MyService

*   `ImagePath = C:\Path\to\my\service.exe **-some -arguments**`

谢谢

更新：安装完成`>MyService.exe /install -some -arguments`。这些参数是我想在命令行中保留的参数。

更新：我通过直接写入注册表找到了一个解决方案（请参阅[此处](https://stackoverflow.com/questions/393742/delphi-windows-services-command-line-arguments#394493)），但我仍然想要一个更优雅的解决方案，比如使用一些 TService 属性或类似的东西。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-27T00:06:50.240

好的，经过一番研究，我放弃了一种优雅的方法，而直接向注册表写入了直截了当的路径。

为了简单起见，我这样做了：我将要传递的参数存储在我的 TService 中的变量中。然后，我将 AfterInstall 事件设置为直接将我想要的命令行写入注册表（使用 TRegistry 对象）。

```
uses Registry;
procedure MyService.AfterInstall(Sender: TObject) ;
var
  reg:TRegistry;
begin
  reg := TRegistry.Create;
  try
    reg.RootKey := 'HKEY_LOCAL_MACHINE';
    if reg.OpenKey('SYSTEM\CurrentControlSet\Services\MyService', True) then
    begin
      reg.WriteExtendString ('ImagePath', ParamStr(0) + ' -some -arguments') ;
      reg.CloseKey;
    end;
  finally
    reg.Free;
  end;
end; 
```

不是我正在寻找的优雅解决方案，但它确实可以完成工作。

感谢您通过其他答案！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-26T21:01:01.690

服务参数可以在 lpBinaryPathName 参数中传递给[CreateService](http://msdn.microsoft.com/en-us/library/ms682450(VS.85).aspx)函数。在 Delphi 的 TService 中，这在 TServiceApplication.RegisterServices.InstallService 中被调用，您无法（轻松地）覆盖它。

因此，我怀疑最简单的方法是处理 TService.AfterInstall 事件并通过[ChangeServiceConfig](http://msdn.microsoft.com/en-us/library/ms681987(VS.85).aspx)自己更新注册表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-06-17T09:46:10.467

我刚刚发现了一些令人惊讶的东西，值得分享。

您可以（至少）通过以下方式为 Windows 服务指定参数：

1.  在 Service Manager GUI 中将其输入为“Startparameter”。
2.  将其作为参数传递给： sc.exe YourService param1 param2
3.  在注册表中输入 ImagePath=..\YourService.exe param1 param2

在 Delphi 中有两种查询应用程序/服务参数的方法：

*   System.ParamCount/System.ParamStr：这样就得到了上面3.的参数。
*   TService.ParamCount/TService.Param[]：这样就得到了上面1.和2.的参数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-17T11:05:53.857

您应该使用 SCM API 正确安装服务并对其进行配置。SC.EXE 是 SCM API 的命令行界面。在这种情况下，您不应该直接操作注册表，它可以工作，但也取决于服务帐户拥有的权限。无论如何，我想知道如果将它们嵌入代码中，为什么需要命令行参数 - 通常这些参数是在服务之外设置的（由安装程序、配置器等）以更改服务行为。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-26T15:58:40.100

我不认为你可以让服务从它们开始，但如果你将这些参数存储在注册表中，你可以修改程序以在未来启动时总是去抓取它们。（即如果 ParamCount = 0 则从注册表中检索参数）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-28T12:45:23.383

巴勃罗，我有同样的问题，找不到任何东西，也去了编辑注册表的路线。此外，我还使用自定义操作来创建其他安装目录和复制文件（在 C# 中）。您的建议很有帮助，我也不再寻找“优雅”的方式。谢谢

# asp.net - 一个 URL 下的两个 Web 应用程序的可能性！

> ID：393751
> 
> 赞同：0
> 
> 时间：2008-12-26T13:11:40.420
> 
> 标签：asp.net

我有两个使用 ASP.Net 开发的 Web 应用程序。我喜欢在应用程序 A 中提供一个链接以访问应用程序 B 中的 aspx 页面。这样我可以使用单个 URL 访问这两个应用程序。

可能吗？如果有可能，那么我应该如何进行？

苏雷什

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-26T13:41:17.537

（我的）定义的 Web 应用程序具有唯一的 URL。所以，不，你真的不能在一个 URL 下拥有两个单独的 Web 应用程序。但是，您可以在同一台服务器上拥有多个应用程序，它们位于各自独立的[虚拟目录](http://msdn.microsoft.com/en-us/library/zwk103ab.aspx)中。这样你就可以拥有：

[http://www.mydomain.com/ApplicationA](http://www.mydomain.com/ApplicationA)

和

[http://www.mydomain.com/ApplicationB](http://www.mydomain.com/ApplicationB)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T13:25:39.597

这样做的唯一方法是发送

1.  用于访问 A 或 B 的不同 GET 查询字符串
2.  不同的 COOKIE 指示您想要 A 还是 B
3.  服务器端检测一些其他数据（即：用户 IP、用户客户端字符串等）

然而，这听起来像是一个 BadIdea™，它可能会成为一个令人头疼的维护问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T15:30:09.283

您是否正在寻找[Server.Transfer](http://msdn.microsoft.com/en-us/library/ms525800.aspx)？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T14:19:04.200

这样做的目的是什么？并不是说本身有什么问题，而是它有一些应该避免的标志。也许如果您通过共享 URL 的需要来澄清您的问题，我们可以提供对您有所帮助的答案，而不仅仅是猜测您的要求。

# c# - 为什么 C# 是一种函数式编程语言？

> ID：393757
> 
> 赞同：33
> 
> 时间：2008-12-26T13:22:16.407
> 
> 标签：c#, functional-programming

有人说 C# 可以被视为一种函数式编程语言，尽管它被广泛认为是一种 OO 编程语言。

那么，什么特性集使 C# 成为函数式编程语言？

我只能想到：

1.  委托（即使没有匿名方法和 lambda 表达式）
2.  关闭

还要别的吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-12-26T14:40:37.840

C# 借鉴了 ML 和 Haskell 的许多特性，例如：

*   C# 2.0 为我们带来了参数多态性（或“泛型”）。我听说 F# 的创建者之一 Dom Syme 主要负责在 .NET BCL 中实现泛型。

*   C# 2.0 还允许程序员将函数作为高阶函数的值传递和返回，并且对匿名委托的支持有限。

*   C# 3.0 和 3.5 改进了对真正闭包的匿名函数的支持。

*   LINQ 可以被认为是 C# 自己的列表推导式。

*   匿名类型看起来像 ML 记录的近似值

*   类型推断是给定的。

*   我不了解你，但 C#[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)看起来很像 Haskell[类型类](http://en.wikipedia.org/wiki/Type_class)。

*   在 C# 4.0 中有很多关于“动态”关键字的讨论。我不能 100% 确定它的实现细节，但我相当肯定它会使用[结构类型](http://en.wikipedia.org/wiki/Structural_type_system)而不是后期绑定来保持 C# 的编译时安全性。结构类型大致相当于“静态语言的鸭子类型”，这是 Haskell 和 ML 黑客多年来一直喜欢的功能。

这并不是说 C# 是一种函数式编程语言。它仍然缺少重要的功能，例如模式匹配、尾调用优化以及列表和元组文字。此外，惯用的 C# 从根本上来说是必不可少的，它严重依赖于可变状态。

我不一定认为上面提到的某些功能是函数式编程语言独有的，但很明显，C# 开发人员在过去几年中从函数式编程语言中获得了很多灵感。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-12-26T13:44:22.010

“面向对象语言”、“功能语言”、“过程语言”没有严格的定义，任何语言都可以大体符合任何分类；可以编写过程式 Java、面向对象的 C 和函数式 C++。我通常使用基于主要语义特征支持的分类以及常见的开发实践。看待这个问题的一个好方法是检查内置的和流行的框架，看看它们使用什么风格。

函数式语言大多被定义为具有一流函数原语的语言，其开发风格使用这些原语来降低复杂性，例如“map”。另一个常见功能是模式匹配，但我不认为这是唯一的功能。“纯”函数式语言也没有副作用，但这不是强制性的（看看这些概念有多模糊？:)。

那么，什么是 C#？好吧，它具有一流的函数样式原语，带有委托（并且已经获得了对匿名委托和 lambda 样式的更好的语法支持）。这是否使它起作用？也许，如果一个人以实用的风格写作。框架是否使用这种风格？不，不是。

因此，我不会在一般讨论中将 C# 归类为函数式 - 它充其量是多范式，具有一些函数式风格。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-26T13:46:25.390

好吧，委托和闭包允许它以一种主要的功能方式运行......例如：

```
var sum = data.Sum(x=>x.SomeProp); 
```

ETC

您可以使用 lambdas / delegates 编写大多数高阶函数。类型推断与 F# 等纯函数式语言*不太*一样，但 C# 泛型类型推断仍然相当不错（尤其是在 C# 3.0 中）。

在 .NET 3.5 和 C# 3.0 中尤其如此，其中 LINQ 对许多问题采用了高度功能化的方法。但是您仍然可以在 .NET 2.0 和 C# 2.0 中使用 C# 的功能方面。使用 C# 3.0 和 lambdas 会更容易；-p

实际上，C# 是一种*实用*的编程语言。它旨在使使用多种范式成为可能，而如果您想做不同的事情，则不会对您造成可怕的惩罚。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-26T13:47:53.047

函数指针是 C# 在函数类别中的另一个特性。

然而，我不认为 C# 被广泛认为是一种函数式语言。我确实认为重要的是要指出，您可以用许多不是纯函数*式的语言以函数式风格进行编程。*

从[函数式编程](http://en.wikipedia.org/wiki/Functional_programming)：

> 在计算机科学中，函数式编程是一种编程范式，它将计算视为对数学函数的评估，并避免了状态和可变数据。它强调函数的应用，与强调状态变化的命令式编程风格相反。

使用该定义，您几乎可以使用任何过程语言以函数式风格进行编程。 [纯函数式](http://en.wikipedia.org/wiki/Purely_functional)语言只是强制执行它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-26T13:54:09.680

我大多同意这里的其他人的观点，他们说 C# 被更好地描述为多范式而不是函数式。但我会在 C# LINQ 中添加功能特性的示例，这是一个用于编写 monad 的一流且相对易于理解的系统。虽然纯函数式语言不需要使用 monad，但 Haskell 的示例表明它们非常有用。然而，对于许多刚接触 Haskell 的人来说，它们是最难掌握的东西之一。另一方面，在 C# 中，如今许多人编写 LINQ 查询时甚至没有意识到他们正在编写 monad。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-26T15:18:26.517

您可以在 Andrew Kennedy（来自 MS Research）的演示文稿中找到有关语言特性的精彩概述，称为[C# 是一种函数式编程语言](http://sneezy.cs.nott.ac.uk/fun/nov-06/FunPm.ppt)。我关于[C# 和 F# 中的函数式编程的](http://tomasp.net/blog/functional-overview.aspx)文章从更高层次（尤其是接近尾声）给出了概述。

T。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-26T13:46:07.387

C# 具有一些函数式语言特性，例如闭包。.NET 库不是以函数式风格编写的，因此实际上 C# 不是函数式语言。几乎所有事情都是通过突变完成的。集合类型都是可变的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-25T01:55:42.747

这些是使 c# 功能化的要点 1-Lamba 表达式 2-扩展方法 3-类型推断 4-对象和集合初始化器 5-闭包 6-匿名类型 7-Linq

# opengl - 如何为加色叠加设置混合？

> ID：393785
> 
> 赞同：14
> 
> 时间：2008-12-26T13:49:46.117
> 
> 标签：opengl

是否可以在 opengl 中设置混合以实现加色叠加？

红色 + 绿色 = 黄色，青色 + 洋红色 = 白色等。（[见图](http://en.wikipedia.org/wiki/File:AdditiveColor.svg)）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-26T14:20:08.457

```
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE); 
```

应该这样做。

[查看glBlendFunc](http://pyopengl.sourceforge.net/documentation/manual-3.0/glBlendFunc.xhtml)的完整描述

编辑：[旧教程链接](http://www.processingblogs.org/2007/03/31/mini-tutorial-additive-blending/)似乎已死（403 Forbidden）。 [Wayback'd](http://web.archive.org/web/20081207015323/http://www.processingblogs.org/2007/03/31/mini-tutorial-additive-blending/) .

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-29T16:40:05.990

使用 glBlendFunc (GL_ONE, GL_ONE) 实现简单的加法混合。您需要注意 OpenGL 的颜色值范围限制为 [0,1]，大于 1 的值将被限制为 1，因此添加明亮的颜色可能不会产生物理上正确混合的颜色。如果你想实现这一点，你将不得不在你自己的软件中添加和缩放颜色，而不是让 OpenGL 处理它，或者编写一个在渲染时执行此操作的着色器程序。

# ruby-on-rails - 用一些动态编程重构？

> ID：393786
> 
> 赞同：0
> 
> 时间：2008-12-26T13:52:10.167
> 
> 标签：ruby-on-rails, ruby, dynamic, metaprogramming

我在这里有一段代码，我真的可以在重构方面使用一些帮助。我需要不同的方法在 rails 的表单中添加关系数据。代码取自[http://railscasts.com/episodes/75-complex-forms-part-3](http://railscasts.com/episodes/75-complex-forms-part-3)，我的问题是我需要同时拥有 Material 模型和 Answer 模型的方法。所以我需要两次完全相同的代码，用“答案”替换“材料”。

看来这应该通过一些动态编程来解决？但我对此完全没有经验。

这是如何解决的？

```
after_update :save_materials
after_update :save_answers  

def new_material_attributes=(material_attributes)
  material_attributes.each do |attributes|
    materials.build(attributes)
  end
end

def existing_material_attributes=(material_attributes)
  materials.reject(&:new_record?).each do |material|
    attributes = material_attributes[material.id.to_s]
    if attributes
      material.attributes = attributes
    else
      materials.delete(material)
    end
  end
end

def save_materials
  materials.each do |material|
    material.save(false)
  end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-26T14:43:33.387

您可能还想看看这个网站：

[http://refactormycode.com/](http://refactormycode.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T15:11:43.173

如果我理解正确，您希望使用与 for 相同的方法`answers`，`materials`但复制最少的代码。做到这一点的方法是抽象一些私有方法，这些私有方法适用于任何一个，`answers`或者`materials`从这些模型特定的方法中用适当的模型调用它们。我在下面给出了一个示例。请注意，我没有对这些`save_`方法做任何事情，因为我觉得它们足够短，抽象它们并没有节省多少。

```
after_update :save_materials
after_update :save_answers  

// Public methods

def new_material_attributes=(material_attributes)
  self.new_with_attributes(materials, material_attributes)
end

def new_answer_attributes=(answer_attributes)
  self.new_with_attributes(answers, answer_attributes)
end

def existing_material_attributes=(material_attributes)
  self.existing_with_attributes(materials, material_attributes)
end

def existing_answer_attributes=(answer_attributes)
  self.existing_with_attributes(answers, answer_attributes)
end

def save_materials
  materials.each do |material|
    material.save(false)
  end
end

def save_answers
  answers.each do |answer|
     answer.save(false)
  end
end

// Private methods    

private
def new_with_atttributes(thing,attributes)
    attributes.each do |attribute|
       thing.build(attribute)
    end
end

def existing_with_attributes=(things, attributes)
  things.reject(&:new_record?).each do |thing|
    attrs = attributes[thing.id.to_s]
    if attrs
      thing.attributes = attrs
    else
      things.delete(thing)
    end
  end
end 
```

# java - Nice 编程语言作为 Java 泛型的替代品

> ID：393793
> 
> 赞同：2
> 
> 时间：2008-12-26T13:56:45.603
> 
> 标签：java, generics, nice-language

我一直在阅读 Bruce Eckel 的[Thinking In Java](http://www.mindview.net/Books/TIJ/)和泛型一章，他简要提到[Nice 编程语言](http://nice.sourceforge.net/index.html)比 Java 更好地处理参数化类型，但编译成 Java 字节码。

有人对这个有经验么？泛型让我头疼，因此与 Java 互操作的替代方案的前景很有吸引力……但我觉得这就像尝试同时学习法语和魁北克人，如果我把它们混在一起就会被大喊大叫错误的上下文。（没有冒犯的意思，所以请不要因为我不是个人电脑而责备我）而且任何想出“Nice”这个名字的人都应该被枪杀，因为它使得除了 sourceforge 之外的任何网站都无法搜索。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-26T17:22:55.967

我还建议查看[Scala](http://www.scala-lang.org/)，这是一种在 JVM 上运行的多范式（OO 和函数式）语言。Martin Odersky，“Scala 之父”也是 Java 泛型实现的主要贡献者，包括他在 Pizza 和 GJ 实现方面的工作。

*Java 中当前的类型擦除机制确实迫使人们理解一些实现细节以理解限制，但可以公平地说，在任何*语言中使用全面的泛型支持都需要学习曲线。

我发现[Java 泛型和集合](https://rads.stackoverflow.com/amzn/click/com/0596527756)是在 Java 5 中使用泛型的编写良好的介绍和指南。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T14:01:33.393

也许要问的问题是，“为什么仿制药会让你头疼？” 你是如何使用它们导致如此痛苦的？

我同意 Java 中的泛型存在缺陷，并且有些情况（例如，扩展）确实会导致问题，但您的问题到底是什么？

使用另一种编译为字节码的语言可能会在短期内对您有所帮助，但如果您所在的团队提供的系统必须由其他人维护，您可能会在引入像 Nice 这样的技术时遇到问题，无论它多么优雅.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-28T18:18:04.187

我会说看看 Scala 或 Groovy。在我的印象中，Nice 是一种从未受到关注的实验性语言。如果您根本不喜欢 Java 的泛型，那么您可能更喜欢动态类型的 groovy。如果您喜欢泛型的想法，但发现 Java 对它们的实现令人困惑（就像我一样），那么您可能会喜欢 scala，它可以更明智地处理泛型。

# cocoa - 从可可应用程序访问网络服务器

> ID：393803
> 
> 赞同：4
> 
> 时间：2008-12-26T14:05:37.100
> 
> 标签：cocoa, macos, osx-leopard

我正在编写一个可可应用程序，我想在其中从网络服务器下载文件。这样做最方便的方法是什么？我应该选择 NSSockets 还是 NSUrlRequest？或者有没有其他更简单的方法来实现这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-26T17:20:50.013

如果要将文件的内容加载到内存中，许多 Cocoa 数据类，如 NSString、NSData 甚至 NSDictionary 都有`initWithURL:`方法，这些方法直接使用 Web 请求的内容进行初始化。它们非常易于使用，但它们不是很灵活或提供良好的错误处理。如果需要，NSURLConnection 提供了一种更灵活的方式来加载数据。

如果您想将文件直接下载到磁盘，那么 NSURLDownload 将是最好的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T22:41:17.633

一个警告：initWithURL: 方法是阻塞的，如果文件很大，服务器很慢，用户的互联网连接很慢等，这是一个大问题。不要从主线程调用它们。

您也不会收到任何进度报告，因此*当*下载速度较慢时，您无法告诉用户它走了多远或需要多长时间。

在几乎所有情况下，您都应该使用 NSURLDownload 或 NSURLConnection 来代替。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T14:44:16.537

最简单的做法可能是使用 NSURLDownload 和 NSURLRequest。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T14:30:45.160

如果你想从 web 服务中获取数据到 NSString 或 NSData 中，NSURLConnection 是很好的选择。确保在 NSURLConnection 方法中进行异步调用并处理错误和数据

这是 REST 风格调用的一个很好的例子 [http://kosmaczewski.net/2008/03/26/playing-with-http-libraries/](http://kosmaczewski.net/2008/03/26/playing-with-http-libraries/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T22:40:40.147

NSURLConnection 确实给了你最大的粒度，但要小心 NSURLConnection 的 sendSynchronousRequest() 方法。 [它每次都会泄漏内存](http://lists.apple.com/archives/Macnetworkprog/2008/Nov/msg00006.html)（已附加 XCode Leak Instrumentation 工具并运行它以向我自己证明）并且有时会无缘无故地给出奇怪的 HTTP 204 响应。 [我在这里写过关于这个的博客](http://denverdev.blogspot.com/2009/01/iphone-sdk-cocoa-restful-web-services.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-28T15:25:15.533

另一种方法是使用预装在任何 OS X 系统上的 libcurl。如果你使用这种方法，你最好确保像代理等系统设置受到尊重。

# jquery - 从 jqModal 打开另一个弹出窗口

> ID：393813
> 
> 赞同：0
> 
> 时间：2008-12-26T14:09:48.603
> 
> 标签：jquery, popup

我正在使用 jqModal 制作一个弹出窗口，并且我有一个主弹出窗口。单击确定后，我必须关闭该窗口并打开另一个弹出窗口。我如何实现这一目标？

我的问题是点击事件不起作用。当我按下按钮 {#b} 时，除了单击按钮之外，我还必须打开另一个弹出窗口。

### 我的代码

```
<html>
    <head>
        <script src="jquery-latest.js" type="text/javascript"></script>
        <script src="jqModal.js" type="text/javascript"></script>
        <script type="text/javascript">
            $().ready(function() {
                $('#ex3a').jqm(
                { trigger: '#ex3aTrigger',
                  overlay: 30,
                  overlayClass: 'Overlay'}) .jqDrag('.jqDrag');

            $('input.jqmdX') .hover( function(){ $(this).addClass('jqmdXFocus'); },
            function(){ $(this).removeClass('jqmdXFocus'); })
                .focus( function(){ this.hideFocus=true;
                    $(this).addClass('jqmdXFocus'); })
                .blur( function(){ $(this).removeClass('jqmdXFocus'); });
            $("#b").click(function () {
                alert("hello"); });
            });
        </script>
    </head>
    <body>
        <a href="#" id="ex3aTrigger">
           view</a> dialog
        <div id="ex3a" class="jqmDialog">
            <div class="jqmdTL">
                <div class="jqmdTR">
                    <div class="jqmdTC jqDrag">[Dialog Title] </div>
                </div>
            </div>
            <div class="jqmdBL">
                <div class="jqmdBR">
                    <div class="jqmdBC">
                        <div class="jqmdMSG"> Welcome Page <br/> <br/>
                            <div id="b"> <button> OK </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T20:36:00.150

尝试`$("#b").click`在 jqModal 的 onShow 回调中设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-06T11:22:18.160

碰巧我遇到了这个问题，这个问题很久以前就发布了，7 年前。现在我们有很多插件和引导设计，这变得非常容易。

[http://getbootstrap.com/javascript/#modals](http://getbootstrap.com/javascript/#modals)

# sql - 使用EntLib缓存块的Sql缓存依赖

> ID：393816
> 
> 赞同：2
> 
> 时间：2008-12-26T14:12:19.160
> 
> 标签：sql, caching, dependencies

如何使用企业库应用程序块实现 sql 缓存依赖？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-15T02:02:42.417

David Hayden 在他的网站上有一篇文章/博客文章，介绍了如何做到这一点：

[http://davidhayden.com/blog/dave/archive/2006/04/30/2930.aspx](http://davidhayden.com/blog/dave/archive/2006/04/30/2930.aspx)

# git - 将 git 与 SSH 和（有时）开瓶器一起使用

> ID：393824
> 
> 赞同：2
> 
> 时间：2008-12-26T14:19:19.020
> 
> 标签：git, ssh, openssh

我需要通过 SSH 使用 git（这是一个自我强加的限制，但我不愿意打破这个限制）。如果我的笔记本电脑在我的家庭网络上，一切都很好。但是，当我在工作或通过 VPN 登录时，我需要使用开瓶器来访问我的远程存储库，我可以毫无问题地进行设置。

如果可能的话，我想保持懒惰，并且不指定每次从哪里拉/推到哪里，所以我的问题是：如何将 SSH 配置为仅在需要时使用开瓶器（例如，基于当前 IP 地址） ? 或者，有没有一种方法可以让 git 根据 IP 地址检测是否从特定主机拉取/推送到特定主机？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T14:33:04.797

我通过设置指向我的服务器的免费 DynDNS 帐户为自己解决了这个问题。然后，我通过该地址克隆。这意味着无论我在哪里，它都可以工作。不利的一面是，即使我与服务器在同一个本地网络上，我的笔记本电脑仍然通过 DynDNS 进行拉取。

我无法想出一个完全满足您需要的解决方案 - 设置多个遥控器并注意您从中拉出的遥控器似乎比我想要的更复杂。

# text-files - 文本文件有大小限制吗？

> ID：393833
> 
> 赞同：16
> 
> 时间：2008-12-26T14:32:33.253
> 
> 标签：text-files, limits

### 重复：[.txt 文件大小是否有上限？](https://stackoverflow.com/questions/391794/is-there-an-upper-limit-on-txt-file-size)

* * *

您可以向文本文件写入多少内容的限制是多少？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-26T14:34:41.597

除了磁盘大小和文件系统对文件的限制外，没有任何限制。

例如，文件大小限制：

*   NTFS：16 TiB - 64 KiB
*   分机 4：16 TB
*   FAT32：4GB - 1

在磁盘上，文本文件和任何其他类型的文件没有区别。它们都只存储数据字节。

写入二进制文件和文本文件时的唯一概念区别是，当对文本文件执行写入操作时，\n 字符可能会替换为 \r\n 字符或其他一些行结束符（s ）。

# xpath - 使用 XPath 按包含空格的值定位节点

> ID：393840
> 
> 赞同：11
> 
> 时间：2008-12-26T14:35:12.297
> 
> 标签：xpath, whitespace

我需要使用 XPath 通过其值在 xml 文件中定位节点。当要查找的节点包含内部带有空格的值时，就会出现问题。铁：

```
<Root>
  <Child>value</Child>
  <Child>value with spaces</Child>
</Root> 
```

我无法构造定位第二个子节点的 XPath。

简单的 XPath /Root/Child 对两个孩子都适用，但 /Root[Child=value with spaces] 返回一个空集合。

我已经尝试使用**%20**和**#20;来屏蔽空格。**, 并使用引号和双引号。

仍然没有运气。

有人有想法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-26T17:33:37.817

**根据您的具体情况，有不同的 XPath 表达式将选择 node**，其值包含一些空格。

首先，让我们回想一下，这些字符中的任何一个都是“空白”：

    **`&#x09;`** -- 标签

    **`&#xA;`** - 新队

    **`&#xD;`** -- 回车

    **`' '`**或者**`&#x20;`** ——空间

如果您知道节点的确切值，说它是`Hello World`带有空格的“”，那么最直接的 XPath 表达式：

     **`/top/aChild[. = 'Hello World']`**

将选择此节点。

*然而，指定一个包含空格的值的困难在于，我们看到所有的空格字符就像......好吧，空格*并且不知道它是一组空格还是单个制表符。

**在[XPath 2.0](http://www.w3.org/TR/xpath20/)中可以使用[正则表达式](http://www.w3.org/TR/xpath-functions/#regex-syntax)，它们提供了一种简单方便的解决方案**。因此，我们可以使用 XPath 2.0 表达式，如下所示：

    **`/*/aChild[matches(., "Hello\sWorld")]`**

选择顶部节点的任何子节点，其值为字符串“Hello”，后跟空格，后跟字符串“World”。**注意**[**`matches()`**](http://www.w3.org/TR/xpath-functions/#func-matches)函数和**`\s`**匹配空格的“”模式的使用。

**在[XPath 1.0](http://www.w3.org/TR/xpath)**中，一个给定字符串是否包含任何空白字符的方便测试是：

**`not(string-length(.)= stringlength(translate(., ' &#9;&#xA;&#xD;','')))`**

在这里，我们使用该[**`translate()`**](http://www.w3.org/TR/xpath#function-translate)函数消除四个空白字符中的任何一个，并将结果字符串的长度与原始字符串的长度进行比较。

因此，如果在文本编辑器中，节点的值显示为

“你好世界”，

我们可以使用 XPath 表达式安全地选择此节点：

**`/*/aChild[translate(., ' &#9;&#xA;&#xD;','') = 'HelloWorld']`**

在许多情况下，我们还可以使用 XPath 函数[**`normalize-space()`**](http://www.w3.org/TR/xpath#function-normalize-space)，它从它的字符串参数生成另一个字符串，其中前导和尾随空格组被剪切，并且字符串中的每个空格都被单个空格替换。

在上述情况下，我们将简单地使用以下 XPath 表达式：

**`/*/aChild[normalize-space() = 'Hello World']`**

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-26T15:11:24.003

试试这个：

```
/Root/Child[normalize-space(text())=value without spaces] 
```

或者

```
/Root/Child[contains(text(),value without spaces)] 
```

或（因为看起来您的测试值可能是问题所在）

```
/Root/Child[normalize-space(text())=normalize-space(value with spaces)] 
```

还没有实际执行任何这些，因此语法可能很不稳定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-03T07:43:10.597

**使用 XPath 按包含空格的值定位属性**

我有一个输入类型元素，其值包含空格。

例如：

```
<input type="button"  value="Import&nbsp;Selected&nbsp;File"> 
```

我通过使用这个 xpath 表达式解决了这个问题。

```
//input[contains(@value,'Import') and contains(@value ,'Selected')and contains(@value ,'File')] 
```

希望这对你们有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T15:10:27.607

你试过#x20 吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-26T16:14:46.010

我在[第二个链接](http://www.mail-archive.com/users@jackrabbit.apache.org/msg05777.html)上搜索了这个：

尝试使用“ *x0020* ”替换空格

这似乎对这个人有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-05T10:58:50.190

**“ *x0020* ”**在一个基于jackrabbit 的CQ5/AEM 存储库中为我工作，其中属性名称有空格。以下适用于属性“记录 ID”-

```
[(jcr:contains(jcr:content/@Record_x0020_ID, 'test'))] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-20T17:15:33.423

以上所有解决方案都对我不起作用。但是，有一个更简单的解决方案。

创建 XMLDocument 时，确保将***PreserveWhiteSpace***属性设置为 true；

```
 XmlDocument xmldoc = new XmlDocument();
        xmldoc.PreserveWhitespace = true;
        xmldoc.Load(xmlCollection); 
```

# python - Python 和带有 Unicode 的正则表达式

> ID：393843
> 
> 赞同：87
> 
> 时间：2008-12-26T14:40:04.597
> 
> 标签：python, regex, character-properties

我需要从字符串 'بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ' 中删除一些 Unicode 符号

我知道它们肯定存在于此。我试过：

```
re.sub('([\u064B-\u0652\u06D4\u0670\u0674\u06D5-\u06ED]+)', '', 'بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ') 
```

但它不起作用。字符串保持不变。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2008-12-26T14:57:57.850

您使用的是 python 2.x 还是 3.0？

如果您使用的是 2.x，请尝试使用 'u' 将正则表达式字符串设为 unicode-escape 字符串。由于它是正则表达式，因此最好将正则表达式字符串设为原始字符串，并使用“r”。此外，将整个模式放在括号中是多余的。

```
re.sub(ur'[\u064B-\u0652\u06D4\u0670\u0674\u06D5-\u06ED]+', '', ...) 
```

[http://docs.python.org/tutorial/introduction.html#unicode-strings](http://docs.python.org/tutorial/introduction.html#unicode-strings)

编辑：

对 unicode 正则表达式使用 re.UNICODE/re.U/(?u) 标志也是一种好习惯，但它只影响像 \w 或 \b 这样的字符类别名，这种模式不使用任何别名，因此不会受到影响。

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2008-12-26T15:55:11.650

使用[Unicode](http://www.amk.ca/python/howto/unicode)字符串。使用[re.UNICODE](http://docs.python.org/library/re.html#re.UNICODE)标志。

```
>>> myre = re.compile(ur'[\u064B-\u0652\u06D4\u0670\u0674\u06D5-\u06ED]+', 
                      re.UNICODE)
>>> myre
<_sre.SRE_Pattern object at 0xb20b378>
>>> mystr = u'بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ'
>>> result = myre.sub('', mystr)
>>> len(mystr), len(result)
(38, 22)
>>> print result
بسم الله الرحمن الرحيم 
```

阅读*Joel Spolsky*的文章[《每个软件开发人员绝对、肯定必须了解 Unicode 和字符集的绝对最小值》（没有任何借口！）](http://www.joelonsoftware.com/articles/Unicode.html)

# linux - 什么是好的 Linux 退出错误代码策略？

> ID：393845
> 
> 赞同：5
> 
> 时间：2008-12-26T14:40:55.157
> 
> 标签：linux, unix, error-handling

我有几个独立的可执行 Perl、PHP CLI 脚本和 C++ 程序，我需要为其开发退出错误代码策略。这些程序由其他程序使用我创建的用于`exec()`PHP 的包装类调用。所以，我将能够得到一个错误代码。基于该错误代码，调用脚本将需要做一些事情。

我做了一些研究，似乎 1-254（或者可能只是 1-127）范围内的任何东西都可能是用户定义的错误代码的公平游戏。

我只是想知道在这种情况下其他人是如何处理错误处理的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-26T14:48:20.850

唯一的约定是您返回 0 表示成功，返回 0 以外的值表示错误。大多数著名的 Unix 程序都记录了它们可以返回的各种返回码，您也应该如此。尝试为任何任意程序可能返回的所有可能的错误代码创建一个通用列表没有多大意义，否则你最终会[像其他一些操作系统一样得到数以万计的](http://msdn.microsoft.com/en-us/library/ms681381(VS.85).aspx)错误代码，即使那样，它也没有' 并不总是涵盖您要返回的特定类型的错误。

所以只要保持一致，并确保记录您决定使用的任何方案。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-26T14:49:47.213

1-127 是可用范围。超过 127 的任何东西都应该是“异常”退出 - 由信号终止。

当您使用它时，请考虑使用标准输出而不是退出代码。退出代码传统上用于指示成功、失败，并且可能是另一种状态。尝试使用 expr 和 wc 使用 stdout 的方式，而不是使用退出代码。然后，您可以在调用者中使用反引号或类似的东西来提取结果。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-26T15:42:27.013

Unix宣言指出 -

> 出错时尽快退出并尽可能大声

或类似的东西

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-26T16:57:49.840

不要试图将*太多*含义编码到退出值中：详细的状态和错误报告应该像 Arkadiy 建议的那样转到 stdout / stderr。

但是，我发现在退出值中仅表示少数状态非常有用，使用二进制数字对其进行编码。例如，假设您有以下人为的含义：

```
0000 : 0 (no error)
0001 : 1 (error)
0010 : 2 (I/O error)
0100 : 4 (user input error)
1000 : 8 (permission error) 
```

然后，用户输入错误的返回值为 5 (4 + 1)，而没有写入权限的日志文件的返回值可能为 11 (8 + 2 + 1)。由于返回值中的不同含义是独立编码的，因此您可以通过检查设置了哪些位来轻松查看发生了什么。

作为一种特殊情况，要查看是否有错误，您可以将返回码与 1 相加。

通过这样做，您可以在返回代码中以清晰和简单的方式对几个不同的内容进行编码。我只用它来做出简单的决定，例如“是否应该重新启动进程”、“是否需要将返回值和相关日志发送给管理员”之类的事情。任何详细的诊断信息都应该转到日志或 stdout/stderr。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-28T03:55:41.447

正常的退出状态从 0 到 255 运行（有关原因的讨论，请参阅[退出代码大于 255 可能）。](https://stackoverflow.com/questions/179565/exitcodes-bigger-than-255-possible)通常，状态 0 表示成功；其他任何事情都是实现定义的错误。我知道一个通​​过退出状态报告 DBMS 服务器状态的程序。这是实现定义的退出状态的特例。请注意，您可以定义程序状态的实现。

我无法将其放入 300 个字符中；否则这将是对@Arkadiy 答案的评论。

Arkadiy 是对的，在退出状态字的一部分中，非零值表示终止进程的信号，第 8 位通常表示核心转储，但退出状态的那部分与主 0..255 不同地位。但是，当进程因信号而死亡时，shell（无论它是哪个 shell）都会出现问题。有 16 位数据要以 8 位值呈现，这总是很棘手。贝壳似乎做的是获取信号编号并将其添加 128。因此，如果进程因中断（信号号 2，SIGINT）而死，shell 将退出状态报告为 130。但是，内核将状态报告为 0x0002；shell 修改了内核报告的内容。

下面的 C 代码演示了这一点。有两个程序

*   `suicide`它使用您选择的信号杀死自己（默认中断）。
*   `exitstatus`它运行命令（例如`suicide`）并报告内核退出状态。

这是`suicide.c`：

```
/*
@(#)File:           $RCSfile: suicide.c,v $
@(#)Version:        $Revision: 1.2 $
@(#)Last changed:   $Date: 2008/12/28 03:45:18 $
@(#)Purpose:        Commit suicide using kill()
@(#)Author:         J Leffler
@(#)Copyright:      (C) JLSS 2008
@(#)Product:        :PRODUCT:
*/

/*TABSTOP=4*/

#if __STDC_VERSION__ >= 199901L
#define _XOPEN_SOURCE 600
#else
#define _XOPEN_SOURCE 500
#endif /* __STDC_VERSION__ */

#include <signal.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include "stderr.h"

static const char usestr[] = "[-V][-s signal]";

#ifndef lint
/* Prevent over-aggressive optimizers from eliminating ID string */
extern const char jlss_id_suicide_c[];
const char jlss_id_suicide_c[] = "@(#)$Id: suicide.c,v 1.2 2008/12/28 03:45:18 jleffler Exp $";
#endif /* lint */

int main(int argc, char **argv)
{
    int signum = SIGINT;
    int opt;
    char *end;

    err_setarg0(argv[0]);

    while ((opt = getopt(argc, argv, "Vs:")) != -1)
    {
        switch (opt)
        {
        case 's':
            signum = strtol(optarg, &end, 0);
            if (*end != '\0' || signum <= 0)
                err_error("invalid signal number %s\n", optarg);
            break;
        case 'V':
            err_version("SUICIDE", &"@(#)$Revision: 1.2 $ ($Date: 2008/12/28 03:45:18 $)"[4]);
            break;
        default:
            err_usage(usestr);
            break;
        }
    }
    if (optind != argc)
        err_usage(usestr);
    kill(getpid(), signum);
    return(0);
} 
```

这是`exitstatus.c`：

```
/*
@(#)File:           $RCSfile: exitstatus.c,v $
@(#)Version:        $Revision: 1.2 $
@(#)Last changed:   $Date: 2008/12/28 03:45:18 $
@(#)Purpose:        Run command and report 16-bit exit status
@(#)Author:         J Leffler
@(#)Copyright:      (C) JLSS 2008
@(#)Product:        :PRODUCT:
*/

/*TABSTOP=4*/

#if __STDC_VERSION__ >= 199901L
#define _XOPEN_SOURCE 600
#else
#define _XOPEN_SOURCE 500
#endif /* __STDC_VERSION__ */

#include <stdio.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/wait.h>
#include "stderr.h"

#ifndef lint
/* Prevent over-aggressive optimizers from eliminating ID string */
extern const char jlss_id_exitstatus_c[];
const char jlss_id_exitstatus_c[] = "@(#)$Id: exitstatus.c,v 1.2 2008/12/28 03:45:18 jleffler Exp $";
#endif /* lint */

int main(int argc, char **argv)
{
    pid_t pid;

    err_setarg0(argv[0]);

    if (argc < 2)
        err_usage("cmd [args...]");

    if ((pid = fork()) < 0)
        err_syserr("fork() failed: ");
    else if (pid == 0)
    {
        /* Child */
        execvp(argv[1], &argv[1]);
        return(1);
    }
    else
    {
        pid_t corpse;
        int status;
        corpse = waitpid(pid, &status, 0);
        if (corpse != pid)
            err_syserr("waitpid() failed: ");
        printf("0x%04X\n", status);
    }
    return(0);
} 
```

基本上可以在我发布的任何程序中轻松找到缺失的代码`stderr.c`和。`stderr.h`如果您急需，请从[IIUG 软件档案库](http://www.iiug.org/software)的 SQLCMD 程序中获取；或者，通过电子邮件与我联系（请参阅我的个人资料）。

# php - 检测特定查询的正则表达式

> ID：393852
> 
> 赞同：2
> 
> 时间：2008-12-26T14:48:33.657
> 
> 标签：php, regex

我想知道是否有人可以构造一个正则表达式来检测一个人是否搜索“site:cnn.com”或“site:www.globe.com.ph/”之类的东西。我一直很难弄清楚。提前非常感谢！

编辑：抱歉忘了提我的脚本是用 PHP 编写的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T16:10:30.793

好的，对于任意文本字段的输入，如下所示的简单操作将起作用：

```
\bsite:(\S+) 
```

括号将捕获他们尝试搜索的任何站点/域。它不会验证它是否有效，但验证 urls/domains 是复杂的，并且有许多易于谷歌搜索的正则表达式可以做到这一点，例如，这里有[一个](http://immike.net/blog/2007/04/06/5-regular-expressions-every-web-programmer-should-know/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T15:16:11.387

你在匹配什么？推荐人网址？

假设您正在与如下所示的引荐来源网址进行匹配：

```
http://www.google.com/search?client=safari&rls=en-us&q=whatever+site:foo.com&ie=UTF-8&oe=UTF-8 
```

像这样的正则表达式应该可以解决问题：

```
\bsite(?:\:|%3[aA])(?:(?!(?:%20|\+|&|$)).)+ 
```

笔记：

*   “站点”之后的冒号可以是未编码的，也可以是百分比编码的。大多数用户代理不会对其进行编码（我认为这实际上与标准相反），但这将同时处理
*   我假设站点：... url 的右边界是空格字符、字段结尾 (&) 或字符串结尾 ($)
*   我没有假设 x-www-form-urlencoded 编码（空格 == '+'）或使用百分比编码（空格 == %20）编码的空格。这将同时处理
*   (?:...) 是一个非捕获组。(?!...) 是负面的前瞻。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T15:26:10.167

不，这不是推荐人网址。我的 php 脚本基本上会吐出有关域的信息（例如反向链接、pagerank 等），我需要该正则表达式，以便它知道用户正在搜索什么。如果用户输入的内容与正则表达式不匹配，它会改为执行常规网络搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T16:00:00.143

如果这就是你想要做的，我想我会采取更简单的方法，然后做：

```
$entry = $_REQUEST['q'];
$tokens = split(':', trim($entry));
if (1 < count($tokens) && strtolower($tokens[0]) == 'site')
  $site = $tokens[1]; 
```

# java - Java：泛型和集合类型检测的问题

> ID：393853
> 
> 赞同：0
> 
> 时间：2008-12-26T14:49:21.003
> 
> 标签：java, generics, types, hashset

我有一个名为 DataSet 的类，它有各种构造函数，每个构造函数都指定不同类型的变量。它可能看起来有点像这样：

```
public class DataSet
{
    private HashSet Data;

    public DataSet( DataObject obj )
    {
        Data = new <DataObject>HashSet();
        Data.add( obj );
    }

    public DataSet( ObjectRelationship rel )
    {
        Data = new <ObjectRelationship>HashSet();
        Data.add( rel );
    }
    // etc. 
```

注意：由于部分不完整（我现在正在构建），我尚未测试该代码。

在我当前正在构建的函数中`getDataObjects()`，我需要返回该集合表示的所有 DataObject 对象。对于初始化类的 HashSet 的构造函数，`Data`其类型不是`DataObject`（例如上述`ObjectRelationship`），显然不会有任何 DataObjects 存储在其中。在这种情况下，我需要能够检测 HashSet 'Data' 的启动类型（例如，判断它是否是 'ObjectRelationship'，我的意思是）。我该怎么做呢？

**tl;dr**：我如何判断在我的代码中启动集合（在本例中为 HashSet）的类型（例如使用“if”或“switch”语句或其他内容）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-26T15:12:42.690

听起来你想让整个类通用——在类的声明中添加一个模板参数，并使用该模板参数为类型定义你的 HashSet 和检索函数。

不过，我现在是一个 .Net 人，所以我不能给你 Java 语法，但是使用 C#*语法*它看起来像这样：

```
public class DataSet<T>
{
    private Set<T> Data;

    public DataSet( T obj )
    {
        Data = new HashSet<T>();
        Data.add( obj );
    }

    public Iterator<T> getDataObjects()
    {
        return Data.iterator;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T14:56:31.583

您可以从集合中获取一个对象并验证其类型。

或者你可以有多个集合来包含不同的类型。

或者你可以有一个 Class 类型的实例变量作为实例变量的鉴别器。

或者您可以使用最后一种技术为 HashSet 创建一个代理对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T18:08:41.570

听起来您的设计需要重新考虑。

另外，要明确泛型；您无法在运行时访问该类型。type 参数仅用于编译时检查，并且在运行时完全消失（类型擦除）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T16:45:04.577

您可以使用地图到集合

```
HashMap <Class<?>, HashSet<Object>> data;
HashSet temp = data.get(DataObject.class);
if(temp == null)
{
   temp = new HashSet();
   data.put(DataObject.class, temp);
}
temp.add(obj); 
```

然后，您将获得两全其美。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-26T14:58:21.767

这个类提供了什么 CachedRowSet 没有？

抱歉，我不认为这是一个很好的抽象。如果我是你们团队的一员，我不会使用它。

你的语法对我来说也不正确。IntelliJ 同意我的观点：它不会编译。

这样做：

```
import java.util.HashSet;
import java.util.Set;
import java.util.Arrays;

public class DataSet
{
    private Set<DataObject> data;

    public DataSet(DataObject obj)
    {
        this.data = new HashSet<DataObject>();
        data.add(obj);
    }

    public DataSet(DataObject[] objs)
    {
        data = new HashSet<DataObject>();
        data.addAll(Arrays.asList(objs));
    }
    // etc.
} 
```

仍然是一个糟糕的抽象。重新考虑一下。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-26T15:05:41.580

您可以向数据集类添加一个属性（枚举值、布尔值或类型），指定用于初始化哈希集的类型。

在适当的构造函数中设置属性。这允许您绕过从集合中获取元素来检查其类型。

伪代码：

```
public class DataSet
{
private HashSet Data;
private Type _iw = null;
public Type InitializedWith { return _iw; }

public DataSet(DataObject)
{
...
_iw = typeof(DataObject);
}

public DataSet(ObjectRelationship)
{
...
_iw = typeof(ObjectRelationship)
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-26T16:22:44.390

我将遵循 duffymo 的建议并使用更好的抽象。我将为我计划使用的每种特定类型创建多个类（每个实现一个公共接口），这样我就可以绕过这个愚蠢的问题。

在创建每个正确类型的 DataSet 对象的过程中，它会增加一点点开销，但我想这就是它的方式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-26T17:38:08.340

我不知道 DataObject 在 Object 之外给你什么。

我认为针对您的问题的面向对象的方法将使用反映您感兴趣的领域的类（例如，发票、客户等）。持久层将隐藏持久性细节。

实现此目的的常用方法是使用数据访问对象，它在 Java 中可能如下所示：

```
public interface GenericDao<T>
{
    T find(Serializable id);
    List<T> find();
    void save(T obj);
    void update(T obj);
    void delete(T obj);
} 
```

现在您处理的是对象，而不是带有关系数据库味道的东西。所有的 CRUD 细节都隐藏在 DAO 界面后面。

# macos - OSX - 总是隐藏某些文件

> ID：393868
> 
> 赞同：3
> 
> 时间：2008-12-26T15:11:38.183
> 
> 标签：macos, terminal

我知道如何在终端中显示和隐藏隐藏文件 - 但是有没有办法在显示隐藏文件时隐藏某些文件，如 .DS_STORE？让某些文件超级隐藏，可以这么说吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-07T10:04:09.030

`chflags`与隐藏选项一起使用

即：`chflags hidden fileToHide`从 Finde 隐藏文件

并`chflags nohidden fileToHide`显示文件

请记住手册页中的警告：

> 只有有限数量的实用程序可以识别 chflags。其中一些工具包括 ls(1)、cp(1)、find(1)、install(1)、dump(8) 和 restore(8)。特别是当前不支持 chflags 的工具是 pax(1) 实用程序。

这意味着虽然您不会在 Finder 或打开/保存对话框中看到它，但终端仍然会看到它，并且可能还会看到其他不尊重 BSD 标志的程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-26T15:55:10.777

为了跟进@ibz 的回答，别名可以正常工作，但您可能希望制作一个带有参数的shell 脚本以获得更多的灵活性。

```
#!/bin/bash

/bin/ls $@ | grep -v .DS_Store 
```

在 ~/bin 中创建上述内容并将其命名为`lv`chmod 755 ，并记住将 ~/bin 添加到 .bash_profile 中的路径中

```
export PATH=~/bin:$PATH 
```

您也可以命名它`ls`，只要您将 ~/bin 首先放在 PATH 中并在脚本中使用 /bin/ls 的完整路径，这样您就不会得到递归解释。每当您想使用 real`ls`时，您都需要指定完整路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-26T16:05:48.043

要跟进@tvanfosson 的答案，脚本可以正常工作，但您可以通过在 .bashrc 中定义一个函数来使其更简单。:)

```
function lv { ls $@ | grep -v .DS_Store; } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T15:45:53.213

在你的 .bashrc 中做这样的事情

```
alias lv="ls -al | grep -v .DS_Store" 
```

现在使用 lv 代替 ls 来查看所有文件（包括隐藏文件），但不包括 .DS_Store。

# python - 在 Python 应用程序中编写脚本

> ID：393871
> 
> 赞同：5
> 
> 时间：2008-12-26T15:12:10.287
> 
> 标签：python, scripting

我想在我的一个应用程序中包含**Python 脚本**，它是用 Python 本身编写的。

我的应用程序必须能够调用外部 Python 函数（由用户编写）作为**回调**。必须对代码执行进行一些控制；例如，如果用户提供的代码有语法错误，应用程序必须发出信号。

做这个的最好方式是什么？
谢谢。

*编辑*：问题不清楚。我需要一种类似于 VBA 事件的机制，其中有一个“声明”部分（在其中定义全局变量）和事件，带有脚本代码，在特定点触发。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-26T15:36:49.927

用于`__import__`导入用户提供的文件。此函数将返回一个模块。使用它从导入的文件中调用函数。

使用`try..except`on`__import__`和 on 实际调用来捕获错误。

例子：

```
m = None
try:
    m = __import__("external_module")
except:
    # invalid module - show error
if m:
    try:
        m.user_defined_func()
    except:
        # some error - display it 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-26T16:01:20.000

如果您希望用户以交互方式输入命令，我强烈推荐[代码](http://docs.python.org/library/code.html)模块，它是标准库的一部分。InteractiveConsole 和 InteractiveInterpreter 对象允许轻松输入和评估用户输入，并且可以很好地处理错误，并提供回溯以帮助用户正确处理。

只要确保抓住 SystemExit！

```
$ python
Python 2.5.1 (r251:54863, Jan 17 2008, 19:35:17) 
[GCC 4.0.1 (Apple Inc. build 5465)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> shared_var = "Set in main console"
>>> import code
>>> ic = code.InteractiveConsole({ 'shared_var': shared_var })
>>> try:
...     ic.interact("My custom console banner!")
... except SystemExit, e:
...     print "Got SystemExit!"
... 
My custom console banner!
>>> shared_var
'Set in main console'
>>> shared_var = "Set in sub-console"
>>> sys.exit()
Got SystemExit!
>>> shared_var
'Set in main console' 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-26T15:34:26.327

[RestrictedPython](http://pypi.python.org/pypi/RestrictedPython)为 Python 提供了一个受限的执行环境，例如用于运行不受信任的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T20:00:14.513

“我的应用程序必须能够调用外部 Python 函数（由用户编写）作为回调”。

有一个通常更简单的替代方案。

定义在特定点调用方法函数的类。您提供默认实现。

然后，您的用户可以扩展类并提供适当的方法函数而不是回调。

这很少需要全局变量。实现起来也更简单，因为您的用户执行以下操作

```
import core_classes
class MyExtension( core_classes.SomeClass ):
    def event_1( self, args ):
        # override the default behavior for event_1.

core_classes.main( MyExtension ) 
```

这工作非常顺利，并允许最大的灵活性。错误总是在他们的代码中，因为他们的代码是“主”模块。

# objective-c - NSString 实例将其类报告为 NSCFString

> ID：393873
> 
> 赞同：20
> 
> 时间：2008-12-26T15:12:56.590
> 
> 标签：objective-c, cocoa, class, nsstring, class-cluster

我的目标非常简单——我试图设置`NSString`一些测试数据，然后返回应该是`NSString`. 这是我的代码：

```
NSString* stringer = [NSString stringWithFormat: @"Test"];
NSLog(@"%@", [stringer class]); 
```

日志说该类是`NSCFString`，不是`NSString`。这里发生了什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-26T15:21:09.160

NSString 实际上是一个容器类，用于不同类型的字符串对象。通常，NSString 构造函数*会*返回一个实际上是 NSCFString 类型的对象，它是核心基础 CFString 结构的薄包装。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-26T17:12:42.290

NSString 是一个[类 cluster](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CocoaFundamentals/CocoaObjects/chapter_3_section_9.html)，以及其他 Foundation 类型，例如 NSNumber 和 NSArray：

> 类集群是 Foundation 框架广泛使用的一种设计模式。类簇将许多私有的具体子类组合在一个公共的抽象超类之下。以这种方式对类进行分组简化了面向对象框架的公开可见架构，而不会降低其功能丰富性。类集群基于“Cocoa 设计模式”中讨论的抽象工厂设计模式。</p>

# c# - P/Invoking CreateToolhelp32Snapshot 在 Compact Framework 中失败

> ID：393881
> 
> 赞同：1
> 
> 时间：2008-12-26T15:23:06.100
> 
> 标签：c#, .net, compact-framework, windows-ce

嘿，我正在为我的智能手机做一个小应用程序，使用 Windows Mobile 6。我试图让所有当前正在运行的 processec，但方法 CreateToolhelp32Snapshot 总是返回 -1。所以现在我卡住了。我尝试调用 GetLastError() 方法时出错，但该方法返回 0 值。这是我的代码片段。

```
private const int TH32CS_SNAPPROCESS = 0x00000002;
[DllImport("toolhelp.dll")]
public static extern IntPtr CreateToolhelp32Snapshot(uint flags, 
                                                     uint processid);

public static Process[] GetProcesses()
    {
        ArrayList procList = new ArrayList();
        IntPtr handle = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);

        if ((int)handle > 0)
        {
            try
            {
                PROCESSENTRY32 peCurr;
                PROCESSENTRY32 pe32 = new PROCESSENTRY32();

                // get byte array to pass to API call
                byte[] peBytes = pe32.ToByteArray();
                // get the first process
                int retval = Process32First(handle, peBytes); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-26T17:23:02.893

*   首先，您的句柄检查是错误的。句柄中的高位打开是很常见的，导致它在转换为有符号整数时看起来像一个负数。您应该检查它不是 NULL (0) 或 INVALID_HANDLE_VALUE (-1 / 0xffffffff)。
*   您不应该“调用 GetLastError”，而是调用 Marshal.GetLastWin32Error()
*   您没有在 P/Invoke 声明中设置 SetLastError 属性。在 C# 中默认为 false，在 VB 中默认为 true。
*   您的 PROCESS32 实施在哪里？[文档明确](http://msdn.microsoft.com/en-us/library/aa915359.aspx)指出必须在调用之前设置 dwLength 成员，如果发生这种情况，这里还不清楚。

附带说明一下，[Smart Device Framework](http://www.smartdeviceframework.com)的[OpenNETCF.ToolHelp 命名空间](http://opennetcf.com/library/sdf/html/a2bccceb-fc28-262d-c05c-26565a0986d1.htm)已实现所有这些并且可以正常工作（以防您不想重新发明轮子）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-22T19:49:42.603

代替

```
CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0); 
```

采用

```
private const int TH32CS_SNAPNOHEAPS = 0x40000000;
CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS | TH32CS_SNAPNOHEAPS, 0); 
```

默认情况下，CreateToolhelp32Snapshot 将尝试对堆进行快照，这可能会导致内存不足错误。

[在https://social.msdn.microsoft.com/Forums/en-US/e91d845d-d51e-45ad-8acf-737e832c20d0/createtoolhelp32snapshot-windows-mobile-5?forum=vssmartdevicesnative](https://social.msdn.microsoft.com/Forums/en-US/e91d845d-d51e-45ad-8acf-737e832c20d0/createtoolhelp32snapshot-windows-mobile-5?forum=vssmartdevicesnative)找到了这个，它解决了我的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T16:05:20.367

如果您没有看到有效的“最后一个错误”信息，您可能需要在 API 的 DllImport 属性上添加“SetLastError”属性（[带有代码示例的 MSDN 参考](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.dllimportattribute.setlasterror.aspx)）。根据此属性的文档，您应该将 SetLastError 设置为...

> ...true 表示被调用者将调用 SetLastError；否则为假。默认值为假。
> 
> 运行时封送处理程序调用 GetLastError 并缓存返回的值以防止它被其他 API 调用覆盖。您可以通过调用 GetLastWin32Error 来检索错误代码

至于您看到的 API 故障，我没有发现任何明显的临时问题。[您拥有的代码似乎与此处](http://msdn.microsoft.com/en-us/library/aa446560.aspx)的示例代码非常相似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-17T01:15:27.533

这是基于 MSDN 文档的正确实现

```
private const int INVALID_HANDLE_VALUE = -1;

[Flags]
private enum SnapshotFlags : uint
{
    HeapList = 0x00000001,
    Process = 0x00000002,
    Thread = 0x00000004,
    Module = 0x00000008,
    Module32 = 0x00000010,
    Inherit = 0x80000000,
    All = 0x0000001F,
    NoHeaps = 0x40000000
}

[DllImport("toolhelp.dll"]
private static extern IntPtr CreateToolhelp32Snapshot(SnapshotFlags dwFlags, int th32ProcessID);

[StructLayout(LayoutKind.Sequential)]
public struct PROCESSENTRY32
{
    public uint dwSize;
    public uint cntUsage;
    public uint th32ProcessID;
    public IntPtr th32DefaultHeapID;
    public uint th32ModuleID;
    public uint cntThreads;
    public uint th32ParentProcessID;
    public int pcPriClassBase;
    public uint dwFlags;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)] public string szExeFile;
};

IntPtr hSnap = CreateToolhelp32Snapshot(SnapshotFlags.Process, 0);

if (hSnap.ToInt64() != INVALID_HANDLE_VALUE)
{
    PROCESSENTRY32 procEntry = new PROCESSENTRY32();
    procEntry.dwSize = (uint)Marshal.SizeOf(typeof(PROCESSENTRY32));

    if (Process32First(hSnap, ref procEntry))
    {
        do
        {

            //do whatever you want here

        } while (Process32Next(hSnap, ref procEntry));
    }
}

CloseHandle(hSnap); 
```

Most importantly is this line, because you must set the size of the procEntry:

`procEntry.dwSize = (uint)Marshal.SizeOf(typeof(PROCESSENTRY32));`

# security - 禁用密码缓存的跨浏览器技术

> ID：393882
> 
> 赞同：12
> 
> 时间：2008-12-26T15:23:49.530
> 
> 标签：security, browser, passwords

保存和自动归档用户名/密码是大多数现代浏览器的功能。并且用户通常可以选择在每个域的基础上禁用此功能。但是网站本身是否有防止密码缓存的标准方法？

这里的重点是跨浏览器，所以如果有必要我会使用多个并行机制。

（我已经看到在存在非标准登录字段的情况下有效地禁用了缓存，例如，额外的隐藏密码字段。但我宁愿不依赖其行为可能在未来意外改变*的副作用。）*

相反，是否有浏览器/版本在没有任何禁用功能的情况下实现密码缓存？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-26T16:20:18.293

添加`autocomplete="off"`到您的`<input>`元素中。适用于所有现代浏览器，IIRC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T16:21:17.293

我想浏览器在提交表单时会保存表单的字段。如果您使用 AJAX 获取密码字段的值，发送它，然后清除该字段怎么办？表单实际上永远不会被提交，因此理论上浏览器永远没有机会保存这些值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T15:25:37.187

为密码输入一个随机生成的名称，只有您可以识别。例如，将该名称存储在隐藏字段中，然后使用该名称获取插入的密码。这样，即使浏览器确实缓存了密码，下次用户访问时也无法将其恢复。

此时，您的用户可能会继续将密码缓存在显示器侧面的便利贴上，但这确实是一场完全不同的战斗。

同样的方法对垃圾邮件也很有效，因为大多数机器人都依赖于查找常见的字段名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T16:24:17.490

AFAIK，屏蔽字段（显示“*”而不是您键入的符号的字段）永远不会保存用于自动完成。您想防止用户在浏览器的密码保存工具中记住您网站的密码吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-15T21:13:22.287

只需在用户名和密码之间添加另一个密码字段并将样式设置为不显示。

```
<!-- Username label and text here> ... <--!>
<input type="password" id='txtPasswordDud' style='display: none;' />
<!-- Actual Password label and text here> ... <--!> 
```

# c++ - 最小正数的最佳/最快算法

> ID：393885
> 
> 赞同：7
> 
> 时间：2008-12-26T15:26:51.943
> 
> 标签：c++, algorithm, optimization

简单的问题 - 在 C++ 中，获取两个数字（u0 和 u1）中哪个是最小正数的最简洁方法是什么？（这仍然有效）

我尝试的每一种方式都涉及到大的 if 语句或复杂的条件语句。

谢谢，丹

这是一个简单的例子：

```
bool lowestPositive(int a, int b, int& result)
{
    //checking code
    result = b;
    return true;
}

lowestPositive(5, 6, result); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-26T15:46:33.260

如果值以二进制补码表示，则

```
result = ((unsigned )a < (unsigned )b) ? a : b; 
```

将起作用，因为二进制补码中的负值在被视为无符号时大于正值。与 Jeff 的回答一样，这假设至少有一个值是正数。

```
return result >= 0; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-26T16:28:14.753

我更喜欢清晰而不是紧凑：

```
bool lowestPositive( int a, int b, int& result )
{
   if (a > 0 && a <= b) // a is positive and smaller than or equal to b
      result = a;
   else if (b > 0) // b is positive and either smaller than a or a is negative
      result = b;
   else
      result = a; // at least b is negative, we might not have an answer

   return result > 0;  // zero is not positive
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-26T15:52:00.877

```
unsigned int mask = 1 << 31;
unsigned int m = mask;
while ((a & m) == (b & m)) {
  m >>= 1;
}
result = (a & m) ? b : a;
return ! ((a & mask) && (b & mask)); 
```

编辑：认为这不是那么有趣，所以我删除了它。但是再想一想，把它留在这里是为了好玩:)这可以被认为是道格答案的转储版本:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-26T16:02:55.317

可能会让我失望，但只是为了好玩，这里是没有任何比较的结果，因为比较是为了心血来潮。:-)

```
bool lowestPositive(int u, int v, int& result)
{
  result = (u + v - abs(u - v))/2;
  return (bool) result - (u + v + abs(u - v)) / 2;
} 
```

注意：如果 (u + v) > max_int 则失败。至少一个数字必须是正数，返回码才是正确的。也对 polythinker 的解决方案表示敬意:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-26T18:26:58.630

[这是 C 语言中使用位旋转](http://www-graphics.stanford.edu/~seander/bithacks.html#IntegerMinOrMax)来查找的快速解决方案`min(x, y)`。它是[@Doug Currie 答案](https://stackoverflow.com/questions/393885/neatest-fastest-algorithm-for-smallest-positive-number#393907)的修改版本，灵感来自[Find the Minimum Positive Value问题](https://stackoverflow.com/questions/376657/find-the-minimum-positive-value)[的答案](https://stackoverflow.com/questions/376657/find-the-minimum-positive-value#380149)：

```
bool lowestPositive(int a, int b, int* pout)
{
  /* exclude zero, make a negative number to be larger any positive number */
  unsigned x = (a - 1), y = (b - 1);    
  /* min(x, y) + 1 */
  *pout = y + ((x - y) & -(x < y)) + 1; 
  return *pout > 0;
} 
```

例子：

```
/** gcc -std=c99 *.c && a */
#include <assert.h>
#include <limits.h>
#include <stdio.h>
#include <stdbool.h>

void T(int a, int b) 
{           
  int result = 0;   
  printf("%d %d ", a, b);       
  if (lowestPositive(a, b, &result))    
    printf(": %d\n", result);       
  else              
    printf(" are not positive\n");  
}

int main(int argc, char *argv[])
{
  T(5, 6);
  T(6, 5);
  T(6, -1);
  T(-1, -2);

  T(INT_MIN, INT_MAX);
  T(INT_MIN, INT_MIN);
  T(INT_MAX, INT_MIN);
  T(0, -1);
  T(0, INT_MIN);
  T(-1, 0);
  T(INT_MIN, 0);
  T(INT_MAX, 0);
  T(0, INT_MAX);
  T(0, 0);

  return 0;
} 
```

输出：

```
5 6 : 5
6 5 : 5
6 -1 : 6
-1 -2  are not positive
-2147483648 2147483647 : 2147483647
-2147483648 -2147483648  are not positive
2147483647 -2147483648 : 2147483647
0 -1  are not positive
0 -2147483648  are not positive
-1 0  are not positive
-2147483648 0  are not positive
2147483647 0 : 2147483647
0 2147483647 : 2147483647
0 0  are not positive 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-26T15:45:56.677

我建议您将函数重构为更简单的函数。此外，这允许您的编译器更好地执行预期的输入数据。

```
unsigned int minUnsigned( unsigned int a, unsigned int b )
{
   return ( a < b ) ? a : b;
}

bool lowestPositive( int a, int b, int& result )
{
   if ( a < 0 && b < 0 )  // SO comments refer to the previous version that had || here
   {
       return false;
   }

   result = minUnsigned( (unsigned)a, (unsigned)b );  // negative signed integers become large unsigned values
   return true;
} 
```

这适用于 ISO C 允许的所有三种有符号整数表示：二进制补码、一个补码，甚至符号/大小。我们所关心的是任何正符号整数（MSB 清零）与 MSB 集的任何值进行比较。

[正如您在 Godbolt Compiler Explorer 上看到的](http://gcc.godbolt.org/#compilers:!((compiler:clang380,options:'-Wall+-Wextra+-std%3Dgnu%2B%2B14+-fverbose-asm+-O3+',source:'unsigned+int+minUnsigned(+unsigned+int+a,+unsigned+int+b+)%0A%7B%0A+++return+(+a+%3C+b+)+%3F+a+:+b%3B%0A%7D%0A%0Abool+lowestPositive(+int+a,+int+b,+int%26+result+)%0A%7B%0A+++if+(+a+%3C+0+%26%26+b+%3C+0+)++//+comments+refer+to+the+previous+version+that+had+%7C%7C+here%0A+++%7B%0A+++++++return+false%3B%0A+++%7D%0A%0A+++result+%3D+minUnsigned(+(unsigned)a,+(unsigned)b+)%3B++//+negative+signed+integers+become+large+unsigned+values%0A+++return+true%3B%0A%7D')),filterAsm:(commentOnly:!t,directives:!t,intel:!t,labels:!t),version:3)那样，这实际上可以使用 x86 的 clang 编译成非常好的代码。不幸的是，gcc 5.3[做得更差](http://gcc.godbolt.org/#compilers:!((compiler:g530,options:'-Wall+-Wextra+-std%3Dgnu%2B%2B14+-fverbose-asm+-O3+',source:'unsigned+int+minUnsigned(+unsigned+int+a,+unsigned+int+b+)%0A%7B%0A+++return+(+a+%3C+b+)+%3F+a+:+b%3B%0A%7D%0A%0Abool+lowestPositive(+int+a,+int+b,+int%26+result+)%0A%7B%0A+++if+(+a+%3C+0+%26%26+b+%3C+0+)++//+comments+refer+to+the+previous+version+that+had+%7C%7C+here%0A+++%7B%0A+++++++return+false%3B%0A+++%7D%0A%0A+++result+%3D+minUnsigned(+(unsigned)a,+(unsigned)b+)%3B++//+negative+signed+integers+become+large+unsigned+values%0A+++return+true%3B%0A%7D')),filterAsm:(commentOnly:!t,directives:!t,intel:!t,labels:!t),version:3)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-26T17:06:18.013

这将根据您的要求处理所有可能的输入。

```
bool lowestPositive(int a, int b, int& result)
{
    if ( a < 0 and b < 0 )
        return false

    result = std::min<unsigned int>( a, b );
    return true;
} 
```

话虽如此，您提供的签名允许出现偷偷摸摸的错误，因为很容易忽略此函数的返回值，或者甚至不记得有一个返回值必须检查才能知道结果是否正确。

您可能更喜欢这些替代方案之一，这使得更难忽视必须检查成功结果：

```
boost::optional<int> lowestPositive(int a, int b)
{
    boost::optional<int> result;
    if ( a >= 0 or b >= 0 )
        result = std::min<unsigned int>( a, b );
    return result;
} 
```

或者

```
void lowestPositive(int a, int b, int& result, bool &success)
{
    success = ( a >= 0 or b >= 0 )

    if ( success )
        result = std::min<unsigned int>( a, b );
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-26T17:25:50.627

这里的大量答案都忽略了零不是正数的事实:)

使用棘手的铸造和燕鸥：

```
bool leastPositive(int a, int b, int& result) {
    result = ((unsigned) a < (unsigned) b) ? a : b;
    return result > 0;
} 
```

不那么可爱：

```
bool leastPositive(int a, int b, int& result) {
    if(a > 0 && b > 0)
        result = a < b ? a : b;
    else
        result = a > b ? a : b:
    return result > 0;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-26T15:49:35.640

三元运算符的使用（滥用？）的三行

```
int *smallest_positive(int *u1, int *u2) {
    if (*u1 < 0) return *u2 >= 0 ? u2 : NULL;
    if (*u2 < 0) return u1;
    return *u1 < *u2 ? u1 : u2;
} 
```

不知道效率或如果 u1 和 u2 都是负数该怎么办。我选择返回 NULL（必须在调用者中检查）；返回指向静态 -1 的指针可能更有用。

编辑以反映原始问题的变化:)

```
bool smallest_positive(int u1, int u2, int& result) {
    if (u1 < 0) {
        if (u2 < 0) return false; /* result unchanged */
        result = u2;
    } else {
        if (u2 < 0) result = u1;
        else result = u1 < u2 ? u1 : u2;
    }
    return true;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-26T15:56:26.080

使用“魔法常数”-1 破解：

```
enum
{
    INVALID_POSITIVE = -1
};

int lowestPositive(int a, int b)
{
    return (a>=0 ? ( b>=0 ? (b > a ? a : b ) : INVALID_POSITIVE ) : INVALID_POSITIVE );
} 
```

这没有假设数字是正数。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-26T15:57:43.940

伪代码，因为我手头没有编译器：

```
////0 if both negative, 1 if u0 positive, 2 if u1 positive, 3 if both positive
switch((u0 > 0 ? 1 : 0) + (u1 > 0 ? 2 : 0)) {
  case 0:
    return false; //Note that this leaves the result value undef.
  case 1:
    result = u0;
    return true;
  case 2:
    result = u1;
    return true;
  case 3:
    result = (u0 < u1 ? u0 : u1);
    return true;
  default: //undefined and probably impossible condition
    return false;
} 
```

这是紧凑的，没有很多 if 语句，但依赖于三元“？：”运算符，它只是一个紧凑的 if、then、else 语句。"(true ? "yes" : "no")" 返回 "yes"，"(false ? "yes" : "no") 返回 "no"。

在每个 case 之后的正常 switch 语句中，你应该有一个 break;，退出 switch。在这种情况下，我们有一个 return 语句，所以我们退出了整个函数。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-26T18:07:16.270

恕我直言，您的问题可能是用于描述问题的英文短语确实隐藏了一些复杂性（或至少一些未解决的问题）。根据我的经验，这也是“现实世界”中错误和/或未实现期望的常见来源。以下是我观察到的一些问题：

*   一些程序员使用一种命名约定，其中前导`u` 表示无符号，但您没有明确说明您的“数字”是无符号还是有符号（或者，就此而言，它们是否应该是整数！）

*   我怀疑我们所有读过它的人都假设如果一个论点是肯定的而另一个不是，那么（唯一的）肯定论点值是正确的响应，但这没有明确说明。

*   如果两个值都不是正数，该描述也没有定义所需的行为。

*   最后，在这篇文章之前提供的一些回复似乎暗示回复者（错误地）认为 0 是积极的！更具体的需求声明可能有助于防止任何误解（或明确说明在编写需求时尚未完全考虑到零的问题）。

我并不想过分批评。我只是建议更精确地编写要求可能会有所帮助，并且可能还会清楚您在实现中关注的某些复杂性是否真的隐含在问题的本质中。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-27T01:10:26.367

```
uint lowestPos(uint a, uint b) { return (a < b ? a : b); } 
```

您正在寻找最小的**正值**，仅在这种情况下接受正值是明智的。您不必在函数中捕获负值问题，您应该在调用函数的较早点解决它。出于同样的原因，我离开了布尔 oit。

前提条件是它们不相等，您可以这样使用它：

```
if (a == b)
  cout << "equal";
else
{
  uint lowest = lowestPos(a, b);
  cout << (lowest == a ? "a is lowest" : "b is lowest");
} 
```

如果要更改结果，则可以在要防止更改或引用时引入 const 。在正常情况下，计算机会优化甚至内联该功能。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-04-11T08:30:23.037

没有聪明，合理的清晰度，适用于整数和浮点数：

```
template<class T>
  inline
  bool LowestPositive( const T a, const T b, T* result ) {
  const bool b_is_pos = b > 0;
  if( a > 0 && ( !b_is_pos || a < b ) ) { 
    *result = a;
    return true;
  }
  if( b_is_pos ) {
    *result = b; 
    return true;
  }
  return false;
} 
```

*   请注意，0（零）不是正数。
*   OP 要求处理*数字*（我将其解释为整数*和*浮点数）。
*   仅在有肯定结果时才取消引用结果指针（性能）
*   只测试 a 和 b*一次*（性能——不确定这样的测试是否昂贵？）

**另请注意，[接受的答案](https://stackoverflow.com/a/393945/1956362)（由 tvanfosson 提供）是错误的**。如果 a 为正而 b 为负（即“都不是正的”），则失败。（这是我添加单独答案的唯一原因——我没有足够的声誉来添加评论。）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-26T16:23:50.767

我的想法是基于使用最小值和最大值。并将结果分为三种情况，其中

*   最小值 <= 0 和最大值 <= 0
*   最小值 <= 0 且最大值 > 0
*   最小值 > 0 和最大值 > 0

最好的事情是它看起来不太复杂。代码：

```
bool lowestPositive(int a, int b, int& result)
{
    int min = (a < b) ? a : b;
    int max = (a > b) ? a : b;

    bool smin = min > 0;
    bool smax = max > 0;

    if(!smax) return false;

    if(smin) result = min;
    else result = max;

    return true;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-27T00:07:46.040

在我的第一篇文章被拒绝后，请允许我建议你过早地优化问题，你不应该担心有很多 if 语句。你写的代码自然需要多个'if'语句，无论是用三元if操作符（A ? B : C）还是经典的if块表示，执行时间都是一样的，编译器几乎要优化所有代码都发布到几乎相同的逻辑中。

关注代码的可读性和可靠性，而不是试图智取未来的自己或任何阅读代码的人。据我所知，发布的每个解决方案都是 O(1)，也就是说，每个解决方案都对代码性能的贡献微不足道。

我想建议将这篇文章标记为“过早的优化”，发帖者不是在寻找优雅的代码。

# xml - 将具有其属性的对象序列化为 xml

> ID：393886
> 
> 赞同：1
> 
> 时间：2008-12-26T15:29:51.907
> 
> 标签：xml, serialization

## 完全重复：[有没有办法将对象（及其属性）序列化为 xml？](https://stackoverflow.com/questions/390800/is-there-a-way-to-do-object-with-its-attributes-serializing-to-xml)

颇具讽刺意味的是，它是发帖人上一个问题的重复。

* * *

我想创建一个对象，它包含一些验证应用程序块属性，例如： [Serializable] public class FormElement:IValidated {

```
 [StringLengthValidator(1, 50, MessageTemplate = "The Name must be between 1 and 50 characters")]
    public String username
    {
        get;
        set; 
    }

    [RangeValidator(2007,RangeBoundaryType.Inclusive,6000,RangeBoundaryType.Inclusive,MessageTemplate="input should be in 2007 to 6000")]
    public int sequencenumber
    {
        get;
        set;
    }

    [RegexValidator(@"^\d*\.{0,1}\d+$", MessageTemplate = "input value can not be empty or negative")]
    public string medicalvalue
    {
        get;
        set;
    }

} 
```

如何将这些属性序列化为 xml？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-26T16:44:10.303

使用 XmlSerializer 类：

```
//Create serializer instance, passing in the type of the class 
XmlSerializer serializer = 
  new XmlSerializer(typeof(FormElement));
// Create a FileStream to write with (could be any other stream)
Stream writer = new FileStream(filename, FileMode.Create);
// Serialize the object, and close the TextWriter
 serializer.Serialize(writer, i);
writer.Close(); 
```

根据我的经验，序列化错误是相当清楚的，如果您也在反序列化并希望处理错误，那么 XmlSerializer 类有一些有用的事件可以连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-26T15:55:36.207

您想将您的类序列化为 XML。它不会序列化单个属性或元素。

使用[这个类](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)来做你需要的工作，但要小心翼翼地使用它。有时很难解决反序列化对象时发生的错误。这可能很重要，用户需要更改 XML 文件（配置等）并且不正确。

# asp.net - ASP.NET 中的转换错误

> ID：393888
> 
> 赞同：0
> 
> 时间：2008-12-26T15:30:29.237
> 
> 标签：asp.net, casting

我在 App_Code 文件夹中声明了一个类。该类包含一个返回类型 Portfolio 的公共共享方法。

当我尝试调用此方法以在其中一个 ASCX 控件中初始化 Portfolio 类型的对象时，我收到“无法将 Jaguar.Portfolio 类型的值转换为 Jaguar.Portfolio”消息。

这是一个“网站”项目。我尝试使用 CType 和 DirectCast，但在尝试构建站点时仍然遇到相同的编译错误。

我在 ascx 控件的代码隐藏文件中使用下面列出的代码行

```
将 pObjSvc 调暗为 Jaguar.Portfolio = ClassName.GetPortfolio
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T15:36:10.100

您有网页或用户控件，也称为 Portfolio 吗？您可能会遇到名称空间冲突，混淆了使用哪个 Portfolio 对象。如果是这种情况，您将需要更改类/模块的名称或类后面的控件或页面的代码，您应该已准备就绪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T16:38:22.860

似乎还有其他人有同样的问题：

[ASP Net - “MyNamespace.MyClassName”类型的值不能转换为“MyNamespace.MyClassName”](http://www.velocityreviews.com/forums/t81384-value-of-type-quotmynamespacemyclassnamequot-cannot-be-converted-to-quotmynamespacemyclassnamequot.htm)

> 我有一个 ASP.Net 应用程序，它使用来自其他几个解决方案的程序集。在我的机器上测试应用程序时，我使用 nmake 构建所有引用的程序集。最新的程序集放置在我的 ASP.NET 应用程序引用的公共目录中。
> 
> 有时我会收到以下错误：在进行调试构建时，“MyNamespace.MyClassName”类型的值无法转换为“MyNamespace.MyClassName”（不同的类有很多）。我试过以下没有运气：
> 
> 构建 ASP.Net 应用程序 重建 ASP.Net 应用程序 关闭 VS 并构建 ASP.Net 应用程序 关闭 VS.Net 作为重建 asp.Net 应用程序 IISreset 并构建/重建应用程序
> 
> 似乎唯一可行的是，如果我运行 nmake 来**构建所有引用的程序集**，然后我就可以构建 ASP.Net 应用程序。
> 
> 关于是什么原因的任何想法？有没有更简单的方法来修复它？

可悲的是，问题的作者没有找到明确的答案。但也许它包含一个提示，可能有助于找到解决方案。

*更新*：我不确定这在 ASP.NET 网站中是否可行，但也许您不小心添加了对项目本身的（临时）程序集的引用？这将解释错误。还尝试删除 bin 和 obj 文件夹的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-26T16:18:52.180

只是一个调试提示：

尝试**重命名 Portfolio 类**并重新编译。也许在某个地方有一个旧程序集或 .vb 您的文件中包含一个具有相同名称的类的其他代码？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-27T20:20:42.113

当创建一个与业务对象类同名的 aspx 页面时，我曾见过类似的情况。您是否也有一些带有代码隐藏类 Portfolio 的 aspx 页面？

# jquery - 使用 jQuery 的 Internet Explorer 7 不支持返回链接

> ID：393895
> 
> 赞同：0
> 
> 时间：2008-12-26T15:34:52.630
> 
> 标签：jquery, internet-explorer, browser, internet-explorer-7

我正在使用 jQuery 和 Ajax，我的`Ajax.php`文件将以下字段返回到主文件中。当我在 Mozilla 和 Chrome 中单击时，它工作正常并发出警报，但是当我使用 Internet Explorer 7（版本 7.0.5730.13）时，它不受支持。我需要在浏览器端做任何事情还是必须修改它？

这是我的`Ajax.php`文件的内容：

```
echo " <a href='#' onclick=\"javascript:alert('hello')\ "> link</a>"; 
```

它返回到主 .html 文件。我在 Internet Explorer 7 中没有收到警报。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T15:44:25.340

您可能想去掉右括号后的多余空格（不过，这可能只是您帖子中的一个错字），输入一个分号，然后返回 false 以便它不会尝试跟随链接。

```
echo " <a href='#' onclick=\"javascript:alert('hello'); return false;\"> link</a>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-26T16:06:36.997

它可能是 和 之间的`/`空间`"`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-21T15:34:57.333

您的 onClick 事件中也不需要标签“javascript”。

[*您可以在 Stack Overflow 问题Proper way of call a JavaScript method*](https://stackoverflow.com/questions/3761167/proper-way-of-calling-a-javascript-method/3761175#3761175)[的回答](https://stackoverflow.com/questions/3761167/proper-way-of-calling-a-javascript-method/3761175#3761175)*中阅读更多相关信息。*

 *# c# - 我什么时候应该明确指定一个 StructLayout？

> ID：393943
> 
> 赞同：6
> 
> 时间：2008-12-26T16:25:01.217
> 
> 标签：c#, interop, struct, marshalling

我正在摆弄从 C# 调用 DLL，并且遇到了定义我自己的结构的需要。许多文章强制结构的顺序布局

```
[StructLayout(LayoutKind.Sequential)]
struct Foo ... 
```

因此，我遵循套件，并且我的程序有效。现在，当我把线拿出来时，它仍然有效。为什么我需要它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-26T16:41:45.893

托管结构的内部布局未记录且无法发现。成员订单和包装等实施细节被故意隐藏。使用 [StructLayout] 属性，您可以强制 P/Invoke 编组器强制执行特定的布局和打包。

默认值恰好与您使代码工作所需的内容相匹配，这只是一个意外。虽然并不罕见。请注意 Type.StructLayoutAttribute 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-17T04:43:20.633

有趣的一点。我确信在我输入显式 LayoutKind.Sequential 之前我的代码会失败，但是我已经确认即使在 1.1 中，Sequential 也是结构的默认设置。

请注意，[VB Reference for Structure](http://msdn.microsoft.com/en-us/library/k69kzbs1.aspx) 在 Remarks > Behavior > Memory Consumption 中暗示您确实需要指定 StructLayout 以确认内存布局，但[StructLayoutAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute.aspx)的文档 状态 Sequential 是 Microsoft 编译器中结构的默认设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-27T12:02:58.360

我不完全确定，但它可能会影响二进制序列化 - 它可能会按顺序吐出字段而没有命名或排序信息（导致文件更小），但这完全是一时兴起。

# java - 桌面应用的对象持久化策略

> ID：393948
> 
> 赞同：4
> 
> 时间：2008-12-26T16:31:38.770
> 
> 标签：java, desktop, object-persistence

我正在开发一个基于 Java 的桌面应用程序。我需要保存从应用程序对象模型生成的一些数据（最好保存到文件中）。还需要保护持久文件，以便其他人无法从数据中获取对象模型详细信息。做这些的最佳策略是什么？我的印象是，这些要求对于桌面应用程序来说非常普遍。但是，我还没有找到很多有用的信息。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T16:37:35.467

如果您不需要修改此文件，您可以将对象图序列化为文件。内容是二进制的，只能使用编写它们的类来读取。

您还可以使用 Java DB（我认为自 1.5 以来随 java 一起提供）和诸如 Hibernate 之类的 ORM 工具。

**编辑**

它从 1.6 [http://developers.sun.com/javadb/开始捆绑](http://developers.sun.com/javadb/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-26T19:05:13.467

你的问题有两个部分。1st：如何持久化数据？第二：如何保护它们？

有很多方法可以持久化数据。从简单的 XML、java 序列化到自己的数据格式。没有办法仅仅通过“纯文本”来防止逆向工程数据。你可以让它变得更难，但并非不可能。为了使它完全不可能，您需要使用强加密，这就出现了一个问题。如何加密数据并且不泄露安全令牌。如果您正在与您的应用程序一起分发安全令牌，那么找到它并解决问题只是时间问题。因此，在安装期间输入安全令牌不是一种选择。如果用户必须通过身份验证才能使用应用程序，它应该会有所帮助，但这是同样的问题。下一个选项是使用自定义保护双射算法来混淆数据。最后一个选项是什么都不做，只是保持数据格式私有，不要'

最好的价值是使用自定义数据格式和混淆应用程序对数据进行简单的混淆（XOR 素数）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-26T16:54:31.143

如果您想对文件进行简单的 xml 读取和写入，[XStream就可以工作。](http://xstream.codehaus.org/)Xstream 允许您获取任何 java 对象并将其写入文件并从文件中读取。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-26T17:00:07.853

我认为“序列化”是这个词：

[http://java.sun.com/developer/technicalArticles/Programming/serialization/](http://java.sun.com/developer/technicalArticles/Programming/serialization/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-26T18:23:39.263

如果您确实需要语句中隐含的安全性（“...保护持久文件，以便其他人无法从数据中派生对象模型详细信息。”），我会序列化内存中的数据（以 Java 序列化形式、XML 或其他），然后将该字节流加密为文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-26T19:23:33.930

[您可以尝试使用像 Berkeley DB Java 版 ( http://www.oracle.com/database/berkeley-db/je/index.html](http://www.oracle.com/database/berkeley-db/je/index.html) )这样的嵌入式数据库。他们的直接持久层 API 很可能会满足您的需求。数据库内容同步到磁盘上的文件。仅仅直接看文件，从数据中找出对象模型并不容易。我在这方面有过很好的体验，它速度极快，并且与桌面应用程序配合得很好。

# user-interface - BlackBerry - 将项目添加到 ListField

> ID：393950
> 
> 赞同：6
> 
> 时间：2008-12-26T16:32:59.843
> 
> 标签：user-interface, blackberry, listfield

有人可以给我一个简单的例子，说明如何将三行添加到 ListField 以便列表显示类似这样的内容吗？

项目 1

第 2 项

第 3 项

我只想显示一个列表，用户可以在其中选择一个项目，程序会根据所选项目做一些事情。

我在整个互联网上搜索，但似乎不可能找到一个简单的例子来说明如何做到这一点（我发现的大多数例子都不完整）而且黑莓文档很糟糕。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-30T21:24:28.007

您可能想看看使用 ObjectListField。处理选择操作是通过包含的 Screen 对象完成的，我在下面使用 MenuItem 完成了此操作，我不确定如何设置默认选择侦听器，您可能必须检测键和滚轮事件。

一些示例代码：（未经测试！）

```
MainScreen screen = new MainScreen();
screen.setTitle("my test");

final ObjectListField list = new ObjectLIstField();
String[] items = new String[] { "Item 1", "Item 2", "Item 3" };
list.set(items);

screen.addMenuItem(new MenuItem("Select", 100, 1) {
    public void run() {
        int selectedIndex = list.getSelectedIndex();
        String item = (String)list.get(selectedIndex);
        // Do someting with item
    });
screen.add(list); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T01:55:13.787

您可以像这样覆盖 navigationClick 方法：

```
ObjectListField list = new ObjectListField()
{
    protected boolean navigationClick(int status, int time)
    {
        // Your implementation here.
    }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-03T04:16:31.350

```
final class SimpleListScreen extends MainScreen
{
    public SimpleListScreen()
    {
        super(Manager.NO_VERTICAL_SCROLL);

        setTitle("Simple List Demo");

        add(new LabelField("My list", LabelField.FIELD_HCENTER));
        add(new SeparatorField());

        Manager mainManager = getMainManager();

        SimpleList listField = new SimpleList(mainManager);

        listField.add("Item 1");
        listField.add("Item 2");
        listField.add("Item 3");
        }
    }

    //add listener so that when an item is chosen,it will do something 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T12:47:28.357

您可以通过覆盖来检测对每个列表项的点击

```
protected boolean navigationClick(int status,int time) 
```

然后，您只需要弄清楚如何响应点击。我这样做的方法是使用为每个列表项设置的匿名类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-29T11:16:45.133

```
private ListField fList = new ListField(){
        protected boolean navigationClick(int status, int time) {
            System.out.println("omt Click");
            return true;
        };
    }; 
```

# c++ - 如何将 OpenCV IplImage 转换为 SDL_Surface？

> ID：393954
> 
> 赞同：6
> 
> 时间：2008-12-26T16:35:52.647
> 
> 标签：c++, opencv, sdl, iplimage

我正在尝试编写一个程序，该程序需要一个`SDL_Surface`，将其转换为`IplImage`，使用 cvBlobsLib 查找 blob，将 blob 绘制为图像上的点，然后将输出转换`IplImage`回`SDL_Surface`.

我快完成了：只有将`IplImage`back 转换为 an`SDL_Surface`尚未完成。这个 IplImage 有 3 个图像通道，每像素 8 位。我想我可以使用两个电话：

```
SDL_Surface *SDL_CreateRGBSurface(Uint32 flags, int width, int height, int depth, Uint32 Rmask, Uint32 Gmask, Uint32 Bmask, Uint32 Amask);
SDL_Surface *SDL_CreateRGBSurfaceFrom(void *pixels, int width, int height, int depth, int pitch, Uint32 Rmask, Uint32 Gmask, Uint32 Bmask, Uint32 Amask); 
```

我目前正在尝试使用`SDL_CreateRGBsurfaceFrom`. 但是，我不知道 pitch、Rmask、Gmask 和 Bmask 的正确值是多少。（Amask 为 0，因为没有 Alpha 通道。）

任何人都可以通过解释如何做到这一点来帮助我吗？

谢谢！

**编辑**：例如，这是我尝试使用的代码：

```
SDL_Surface *ipl_to_surface (IplImage *opencvimg)
{
    int pitch = opencvimg->nChannels*opencvimg->width;
    printf("Depth %d, nChannels %d, pitch %d\n", opencvimg->depth,
                    opencvimg->nChannels, pitch);
    SDL_Surface *surface = SDL_CreateRGBSurfaceFrom((void*)opencvimg->imageData,
                    opencvimg->width,
                    opencvimg->height,
                    opencvimg->depth,
                    pitch,
                    0x0000ff, 0x00ff00, 0xff0000, 0
                    );
    return surface;
} 
```

（SDL 文档写道“Pitch 是表面扫描线的大小，以字节为单位，即 widthInPixels*bytesPerPixel。”）这会输出“Depth 8, nChannels 3, pitch 1920”并显示一个完全红色的图像。我*认为*一个解决方案是将我的 8 位图像转换为 24 位（每个通道 1 个字节），但我不知道该怎么做。有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-27T21:02:29.097

好的，我得到它的工作！

我想我对 OpenCV 深度为 8 意味着*一个像素每个通道有 8 位这一事实感到困惑，因此在 3 通道图像中，一个像素有 24 位*。因此，当将其转换为深度的 SDL 含义时，我们会得到`8 * 3 = 24`位。

图像毕竟是 SDL 支持的 24 位。因此将图像转换为 SDL 非常简单：

```
SDL_Surface *surface = SDL_CreateRGBSurfaceFrom((void*)opencvimg->imageData,
                opencvimg->width,
                opencvimg->height,
                opencvimg->depth*opencvimg->nChannels,
                opencvimg->widthStep,
                0xff0000, 0x00ff00, 0x0000ff, 0
                );
return surface; 
```

很抱歉造成混乱，我希望这可以帮助任何寻找相同答案的人。

其他感兴趣的链接： [http://www.libsdl.org/cgi/docwiki.cgi/Pixel_Access](http://www.libsdl.org/cgi/docwiki.cgi/Pixel_Access)
完整的子程序位于： [http://paster.dazjorz.com/?p=3714](http://paster.dazjorz.com/?p=3714)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-21T10:24:58.953

首先：谢谢！！

第二：它与 3 通道图像完美配合，但我想显示 Single-Channel-IplImage

所以我们开始了：

```
SDL_Surface *single_channel_ipl_to_surface (IplImage *opencvimg)
{
    SDL_Surface *surface = SDL_CreateRGBSurfaceFrom((void*)opencvimg->imageData,
                           opencvimg->width,
                           opencvimg->height,
                           opencvimg->depth*opencvimg->nChannels,
                           opencvimg->widthStep,
                           0xffffff, 0xffffff, 0xffffff,0);
    return surface;
} 
```

# java - Java：有没有一种简单、快速的方法来对集合进行 AND、OR 或 XOR？

> ID：393968
> 
> 赞同：20
> 
> 时间：2008-12-26T16:43:11.197
> 
> 标签：java, union, set, intersection

也就是说，如果我有两个或更多集合，并且我想返回一个新集合，其中包含：

1.  每组的所有元素都具有共同点 (AND)。
2.  每组 (OR) 的所有元素总数。
3.  每组独有的所有元素。（异或）。

有没有一种简单的、预先存在的方法来做到这一点？

**编辑：** 这是错误的术语，不是吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-26T17:03:20.577

假设 2 设置对象 a 和 b

AND（两组的交集）

```
a.retainAll(b); 
```

OR（两组的并集）

```
a.addAll(b); 
```

XOR 要么滚动你自己的循环：

```
foreach item
if(a.contains(item) and !b.contains(item) ||  (!a.contains(item) and b.contains(item)))
 c.add(item) 
```

或这样做：

```
c.addAll(a); 
c.addAll(b);
a.retainAll(b); //a now has the intersection of a and b
c.removeAll(a); 
```

请参阅[设置文档](http://java.sun.com/javase/6/docs/api/java/util/Set.html)和此[页面](http://java.sun.com/docs/books/tutorial/collections/interfaces/set.html)。更多。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-12-28T19:28:48.193

您可以使用[Google-Collections Sets 类](https://github.com/google/guava/blob/master/guava/src/com/google/common/collect/Sets.java)，它具有方法 intersection() union() 和 symmetricDifference()。

```
Sets.intersection(set1, set2);
Sets.union(set1, set2);

SetView view = Sets.intersection(Sets.union(set1, set2), set3);
Set result = view.copyInto(new HashSet()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-26T17:02:55.337

@Milhous 说：

> 查看设置 api。如果你使用 addAll 你可以得到或。如果你使用retainAll，你可以得到and。我不知道Xor。

看起来如果你有集合`s1`，`s2`你可以这样做来获得 XOR：

1.  将集合复制`s1`到`s3`
2.  `s1.removeAll(s2);` （s1 现在包含所有不在 s2 中的元素）
3.  `s2.removeAll(s3);` （s2 现在包含所有不在 s3 = 旧 s1 中的元素）
4.  `s1.addAll(s2);` （s1 现在包含上述两组的并集）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-26T16:48:08.097

查看设置[api](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Set.html)。如果你使用 addAll 你可以得到或。如果你使用retainAll，你可以得到and。我不知道Xor。

**编辑：**来自集合文档。

...如果指定的集合也是一个集合，则 addAll 操作有效地修改这个集合，使其值是两个集合的并集。

....如果指定的集合也是一个集合，则此操作有效地修改此集合，使其值是两个集合的交集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-27T22:59:19.627

我很确定 Jakarta Common Collections API 支持联合、交叉等。

如果 Google Collections API 没有那么好，我会感到惊讶。

# c - 限制 Linux 静态库中的符号

> ID：393980
> 
> 赞同：29
> 
> 时间：2008-12-26T16:48:18.660
> 
> 标签：c, linux, gcc, static

我正在寻找限制导出到 Linux 静态库（存档）的 C 符号数量的方法。我想将它们限制为仅属于库官方 API 的那些符号。我已经使用“静态”将大多数函数声明为静态，但这将它们限制在文件范围内。我正在寻找一种方法来限制图书馆的范围。

我可以使用 Ulrich Drepper 的[How to Write Shared Libraries](http://people.redhat.com/drepper/dsohowto.pdf)中的技术为共享库执行此操作，但我无法将这些技术应用于静态档案。在他早期[的图书馆设计良好实践](http://people.redhat.com/drepper/goodpractice.pdf)论文中，他写道：

> 唯一的可能性是使用“ld -r”将需要某些内部资源的所有目标文件组合成一个，然后限制由该组合目标文件导出的符号。GNU 链接器有选项可以做到这一点。

谁能帮我发现这些选项可能是什么？我用'strip -w -K prefix_*'取得了一些成功，但这感觉很野蛮。理想情况下，我想要一个适用于 GCC 3 和 4 的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-06T08:40:52.870

我不相信 GNU ld 有任何这样的选择。Ulrich 一定是指`objcopy`，它有很多这样的选项：`--localize-hidden`, `--localize-symbol=symbolname`, `--localize-symbols=filename`.

特别`--localize-hidden`是允许人们对暴露的符号进行非常精细的控制。考虑：

```
int foo() { return 42; }
int __attribute__((visibility("hidden"))) bar() { return 24; }

gcc -c foo.c
nm foo.o
000000000000000b T bar
0000000000000000 T foo

objcopy --localize-hidden foo.o bar.o
nm bar.o
000000000000000b t bar
0000000000000000 T foo 
```

所以`bar()`不再从对象中导出（即使它仍然存在并且可用于调试）。你也可以`bar()`用`objcopy --strip-unneeded`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-26T19:49:02.413

对于使用 GCC 3.x 或 4.x 编译的代码，静态库无法执行您想要的操作。

如果您可以使用共享对象（库），GNU 链接器可以使用称为版本脚本的功能来满足您的需求。这通常用于提供特定于版本的入口点，但退化的情况只是区分公共符号和私有符号而没有任何版本控制。使用 ld 的 --version-script= 命令行选项指定版本脚本。

使入口点 foo 和 bar 公开并隐藏所有其他接口的版本脚本的内容：

```
{ global: foo; bar; local: *; }; 
```

请参阅 ld 文档：http: [//sourceware.org/binutils/docs/ld/VERSION.html#VERSION](http://sourceware.org/binutils/docs/ld/VERSION.html#VERSION)

我是共享库的大力倡导者，这种限制全局变量可见性的能力是他们的一大优点。

[在http://developers.sun.com/solaris/articles/linker_mapfiles.html](http://developers.sun.com/solaris/articles/linker_mapfiles.html)上提供了一份文档，它提供了共享对象的更多优点，但为 Solaris 编写（由快乐记忆的 Greg Nakhimovsky 编写）

我希望这有帮助。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-05-12T07:50:00.500

这个答案的优点将取决于您使用静态库的原因。如果它允许链接器稍后删除未使用的对象，那么我几乎没有什么可添加的。如果它是为了组织的目的 - 最大限度地减少必须传递以链接应用程序的对象的数量 - 这个扩展的 Employed Russian's answer 可能是有用的。

在编译时，可以使用以下方法设置编译单元中所有符号的可见性：

```
-fvisibility=hidden
-fvisibility=default 
```

这意味着可以编译具有默认可见性的单个文件“interface.c”和具有隐藏可见性的大量实现文件，而无需注释源。然后，可重定位链接将生成一个对象文件，其中“隐藏”了非 api 函数：

```
ld -r interface.o implementation0.o implementation1.o -o relocatable.o 
```

现在可以对组合的目标文件进行 objcopy：

```
objcopy --localize-hidden relocatable.o mylibrary.o 
```

因此，我们有一个目标文件“库”或“模块”，它只公开预期的 API。

* * *

上述策略与链接时间优化的交互效果适中。使用 -flto 编译并通过编译器将 -r 传递给链接器来执行可重定位链接：

```
gcc -fuse-linker-plugin -flto -nostdlib -Wl,-r {objects} -o relocatable.o 
```

像以前一样使用 objcopy 本地化隐藏符号，然后最后一次调用链接器以剥离本地符号以及它可以在 post-lto 对象中找到的任何其他死代码。遗憾的是，relocatable.o 不太可能保留任何 lto 相关信息：

```
gcc -nostdlib -Wl,-r,--discard-all relocatable.o mylibrary.o 
```

lto 的当前实现似乎在可重定位链接阶段处于活动状态。开启 lto 后，隐藏的=>local 符号被最终的可重定位链接剥离。如果没有 lto，隐藏的=>local 符号会在最终的可重定位链接中幸存下来。

lto 的未来实现似乎可能会通过可重定位链接阶段保留所需的元数据，但目前可重定位链接的结果似乎是一个普通的旧目标文件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-07-14T16:58:13.443

这是对 EmployedRussian 和 JonChesterfield 答案的改进，如果您同时生成动态库和静态库，这可能会有所帮助。

从在 DSO 中隐藏符号的标准机制（lib 的动态版本）开始。用 .编译*所有*文件`-fvisibility=hidden`。在定义 API 的头文件中，更改要公开的类和函数的声明：

```
 #define DLL_PUBLIC __attribute__ ((visibility ("default")))
   extern DLL_PUBLIC int my_api_func(int); 
```

有关详细信息，请参见[此处](https://gcc.gnu.org/wiki/Visibility)。这适用于 C 和 C++。这对于 DSO 来说已经足够了，但是您需要为静态库添加这些构建步骤：

```
ld -r obj1.o obj2.o ... objn.o -o static1.o
objcopy --localize-hidden static1.o static2.o
ar -rcs mylib.a static2.o 
```

该`ar`步骤是可选的 - 您可以只链接到`static2.o`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-26T17:09:01.113

我的做法是用 INTERNAL 标记不导出的所有内容，包括保护所有 .h 文件，使用 -DINTERNAL= 编译开发版本，并使用包含所有其他库 .c 文件的单个 .c 文件编译发布版本使用 -DINTERNAL=静态。

# .net - DDE 还重要吗？有哪些替代方案？

> ID：393996
> 
> 赞同：10
> 
> 时间：2008-12-26T17:05:29.140
> 
> 标签：.net, excel, automation, oledb, dde

我正在开发一个证券交易所信息平台，我们正在考虑在我们的平台和自制 Excel 文件之间提供链接。金融市场仍然受制于旧的 DDE 服务器方法，现在它仍然重要吗？

对 Excel 文件、OLE DB 查询进行自动在线数据更新的替代方法有哪些？我想知道是否有人有任何在 C# 和 .NET 中实现 OLE DB 提供程序的示例。

我们的 API 将完全在线和 RESTful，是否有任何 Web 服务替代方案可以将这些数据链接到 Excel？我记得 Excel 2003 有一个 Web 服务工具包，但我在 Excel 2007 中找不到任何类似的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-28T06:12:55.600

我可以推荐阅读这个页面。它几乎谈到了 DDE 的各个方面：

[http://www.angelfire.com/biz/rhaminisys/ddeinfo.html](http://www.angelfire.com/biz/rhaminisys/ddeinfo.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-26T17:27:11.873

在与 Excel 交互方面，[OLE 自动化/COM](http://en.wikipedia.org/wiki/OLE_Automation)取代了 DDE 的使用。

您可能想看看[VSTO](http://msdn.microsoft.com/en-us/office/aa905533.aspx)（Visual Studio Tools for Office）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-28T05:32:06.900

您也可以试试这个（旧的，但我认为仍然相关）[在 Excel 2002 中构建实时数据服务器（MSDN）](http://msdn.microsoft.com/en-us/library/aa140059(office.10).aspx)

在 Reuters 在实时数据领域工作多年，我必须说我已经有十多年没有研究过 DDE 了。我认为它仍然可以使用，但它确实很旧并且已经被很多东西所取代。虽然我一直在使用与实时 API 对话的桌面应用程序。

其他一些链接：

*   [在 Excel 中从 Web 获取实时数据](http://www.windowsdevcenter.com/pub/a/windows/2005/02/08/xcel_mm.html)

*   [在 Delphi 5 - XE4 中为 Excel 2013、2010、2007 开发实时数据服务器 (RTD)](http://www.add-in-express.com/add-in-delphi/excel-rtd-servers.php)

*   [发现 Excel 的 COM 实时源](http://www.codeguru.com/vb/gen/vb_general/ideincludingvisualstudionet/article.php/c6075)****