# StackOverflow 问答 10355000-10355999

# java - 使用正则表达式拆分括号

> ID：10355000
> 
> 赞同：-1
> 
> 时间：2012-04-27T17:12:11.003
> 
> 标签：java, regex

我有一个这样的字符串：`R3(a1b1,a1c1,b2c1),`或者`R3(a1b1,a1c1,b2c1).` 我想把它分成两个数组`[R3]`和`[a1b1,a1c1,b2c1]`. 我尝试了一些天真的方法，例如`String line1[] = line.replaceAll("\\(", ",").replaceAll("\\)", "").replaceAll("\\.", "").split(",");`将字符串拆分为数组，然后拆分数组，但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:18:16.150

你的正则表达式应该是

```
String rx1 = "[()]";
String rx2 = ","; 
```

# git - 连接两个 Git 存储库的历史？

> ID：10355001
> 
> 赞同：7
> 
> 时间：2012-04-27T17:12:11.313
> 
> 标签：git, merge, repository, history, commit

我有一个旧的 Git 存储库，称之为`app`. 然后，一年后，我想从头开始重建应用程序，所以我做了一个新的 repo，调用它`app-2`。

现在，我意识到我应该只创建一个新分支或其他东西，而不是一个新的回购，因为我想将历史移到`app-2`顶部`app`然后摆脱，`app-2`这样现在就有了+`app`的所有历史。`app``app-2`

这可能吗？

更新：

`app`我尝试通过删除`app`（目录除外`.git`）中的所有文件并进行提交来“重置”存储库。然后：

```
cd ~/Projects/app-2
git format-patch --stdout --root master > ../app/app-2-patches.txt
cd ../app
git am app-2-patches.txt 
```

但是，我在有分支机构的地方发生了冲突`app-2`。

是否可以`app-2`在保持历史分支结构的同时应用提交`app-2`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:22:56.657

您可以为此使用 git 的嫁接点。`app`首先从遥控器中提取历史记录`app-2`，然后按照[此答案](https://stackoverflow.com/a/1491057/176922)中的说明进行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:51:41.487

第一步是在一个仓库中获取两个应用程序；第二步是以某种合理的方式合并它们。

对于第一步，我会说将 app-2 中的所有存储库分支推送到应用程序存储库中的分支：

```
$ cd /path/to/app-2
$ git remote add app-repo /path/to/app
$ git push app-repo master:app-2-master     # master in app-2 goes to app-2-master in app repo
# repeat for other branches in app-2 
```

现在，在应用程序存储库中，您拥有它的所有分支和所有 app-2 分支。假设您（想要）将 app-2 视为派生自 app. 然后你 rebase 所有 app-2 on app ：

```
$ cd /path/to/app
$ git checkout app-2-master
$ git rebase master 
```

这可能涉及解决冲突的大量工作，但 git 也会为您完成大量工作。

# sql - rails 范围检查关联是否不存在

> ID：10355002
> 
> 赞同：30
> 
> 时间：2012-04-27T17:12:12.263
> 
> 标签：sql, ruby-on-rails, associations, scopes

我正在寻找一个范围来返回所有没有特定关联的记录。

**foo.rb**

```
class Foo < ActiveRecord::Base    
  has_many :bars
end 
```

**bar.rb**

```
class Bar < ActiveRecord::Base    
  belongs_to :foo
end 
```

我想要一个可以找到所有`Foo's`没有*的*范围`bars`。使用 很容易找到具有关联的那些`joins`，但我还没有找到相反的方法。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2014-04-30T13:14:35.020

Rails 4 让这变得太容易了 :)

```
Foo.where.not(id: Bar.select(:foo_id).uniq) 
```

这输出与 jdoe 的答案相同的查询

```
SELECT "foos".* 
FROM "foos" 
WHERE "foos"."id" NOT IN (
  SELECT DISTINCT "bars"."foo_id"
  FROM "bars" 
) 
```

并作为一个范围：

```
scope :lonely, -> { where.not(id: Bar.select(:item_id).uniq) } 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2017-08-08T17:11:19.023

### 对于 Rails 5+（Ruby 2.4.1 和 Postgres 9.6）

我有 100`foos`和 9900 `bars`。其中99 个`foos`有 100 个`bars`，其中一个没有。

```
Foo.left_outer_joins(:bars).where(bars: { foo_id: nil }) 
```

产生一个 SQL 查询：

```
Foo Load (2.3ms)  SELECT  "foos".* FROM "foos" LEFT OUTER JOIN "bars" ON "bars"."foo_id" = "foos"."id" WHERE "bars"."foo_id" IS NULL 
```

并返回`Foo`没有的`bars`

当前接受的`Foo.where.not(id: Bar.select(:foo_id).uniq)`答案*不起作用*。它产生两个 SQL 查询：

```
Bar Load (8.4ms)  SELECT "bars"."foo_id" FROM "bars"
Foo Load (0.3ms)  SELECT  "foos".* FROM "foos" WHERE ("foos"."id" IS NOT NULL) 
```

它返回所有`foos`，因为所有`foos`都有一个`id`不为空的。

需要将其更改为`Foo.where.not(id: Bar.pluck(:foo_id).uniq)`将其减少为一个查询并找到我们的`Foo`，但它在基准测试中表现不佳

```
require 'benchmark/ips'
require_relative 'config/environment'

Benchmark.ips do |bm|
  bm.report('left_outer_joins') do
    Foo.left_outer_joins(:bars).where(bars: { foo_id: nil })
  end

  bm.report('where.not') do
    Foo.where.not(id: Bar.pluck(:foo_id).uniq)
  end

  bm.compare!
end

Warming up --------------------------------------
    left_outer_joins     1.143k i/100ms
           where.not     6.000  i/100ms
Calculating -------------------------------------
    left_outer_joins     13.659k (± 9.0%) i/s -     68.580k in   5.071807s
           where.not     70.856  (± 9.9%) i/s -    354.000  in   5.057443s

Comparison:
    left_outer_joins:    13659.3 i/s
           where.not:       70.9 i/s - 192.77x  slower 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-01-10T09:54:24.110

在 foo.rb

```
class Foo < ActiveRecord::Base    
  has_many :bars
  scope :lonely, lambda { joins('LEFT OUTER JOIN bars ON foos.id = bars.foo_id').where('bars.foo_id IS NULL') }
end 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-27T18:02:24.023

我更喜欢使用[squeel](https://github.com/ernie/squeel) gem 来构建复杂的查询。它以这样的魔力扩展了 ActiveRecord：

```
Foo.where{id.not_in Bar.select{foo_id}.uniq} 
```

构建以下查询：

```
SELECT "foos".* 
FROM "foos" 
WHERE "foos"."id" NOT IN (
  SELECT DISTINCT "bars"."foo_id"
  FROM "bars" 
) 
```

所以，

```
# in Foo class
scope :lonely, where{id.not_in Bar.select{foo_id}.uniq} 
```

是您可以用来构建请求范围的内容。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-07-07T10:22:18.867

将 NOT EXISTS 与 LIMIT-ed 子查询一起使用会更快：

```
SELECT foos.* FROM foos
WHERE NOT EXISTS (SELECT id FROM bars WHERE bars.foo_id = foos.id LIMIT 1); 
```

使用 ActiveRecord (>= 4.0.0)：

```
Foo.where.not(Bar.where("bars.foo_id = foos.id").limit(1).arel.exists) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-22T20:31:57.020

此方法利用`includes`并允许范围链接。它应该适用于 Rails 5+

```
scope :barless, -> {
  includes(
    :bars
  ).where(
    bars: {
      id: nil
    }
  )
} 
```

# php - mod重写麻烦

> ID：10355006
> 
> 赞同：1
> 
> 时间：2012-04-27T17:12:44.823
> 
> 标签：php, regex, apache, mod-rewrite

我想使用 modrewrite 给我干净的网址，例如：

`http://www.mydomain.com/about/`

成为：

`http://www.mydomain.com/index.php?page=about`

并进入三层。我写了这个，但它根本不起作用：

```
RewriteRule ^([^/\.]+)/?$ /index.php?page=$1 [L]
RewriteRule ^([^/\.]+)/([^/\.]+)/?$ /index.php?section=$1&page=$2 [L]
RewriteRule ^([^/\.]+)/([^/\.]+)/([^/\.]+)/?$ /index.php?section=$1&subsection=$2&page=$3 [L] 
```

我通过添加 print_r($_GET); 进行了测试 当我去的时候它是空的

mydomain.com/about/

编辑，让它工作。愚蠢的我，我在 index.php 之前不需要上面的“/”。

但是，现在它不会显示我的 CSS/图像。我添加了这个，但它仍然无法正常工作。

```
RewriteRule \.(css|jpe?g|gif|png)$ - [L] 
```

它正在做的是将 url 参数附加到图像请求中，如下所示：

/page/images/bg.jpg

而不是：

/images/bg.jpg

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T20:16:17.480

Replace your existing with this:

```
# If the request is for a valid directory
RewriteCond %{REQUEST_FILENAME} -d [OR]
# If the request is for a valid file
RewriteCond %{REQUEST_FILENAME} -f [OR]
# If the request is for a valid link
RewriteCond %{REQUEST_FILENAME} -l 
# don't do anything
RewriteRule ^ - [L]

RewriteRule ^([^/]+)/([^/]+)/([^/]+)/?$ index.php?section=$1&subsection=$2&page=$3 [L,QSA]

RewriteRule ^([^/]+)/([^/]+)/?$ index.php?section=$1&page=$2 [L,QSA]

RewriteRule ^([^/]+)/?$ index.php?page=$1 [L,QSA] 
```

# php - php中的全局变量

> ID：10355009
> 
> 赞同：0
> 
> 时间：2012-04-27T17:12:58.027
> 
> 标签：php, global-variables

我有 2 个文件。让我们说：

第一个.php

```
$a = 'blah';
echo 'echo2='.$a;

function foo(){
global $a;
echo 'echo3='.$a;
return $a;
} 
```

第二个.php

```
require_once(path/to/the/file/first.php);
echo 'echo='.$a;
$b = foo();
echo 'echo4='.$b; 
```

运行 second.php 文件，我得到以下输出：

```
echo=blah
echo2=blah
echo3=
echo4= 
```

我的问题是“为什么我不能访问函数 foo 中的变量 $a ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T17:13:59.003

更改`$global`为`global`。那应该解决它。

[http://php.net/manual/en/language.variables.scope.php](http://php.net/manual/en/language.variables.scope.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:16:12.077

or use

```
 $GLOBALS["Your_var_without_dollar_sign"]; 
```

[http://php.net/manual/en/reserved.variables.globals.php](http://php.net/manual/en/reserved.variables.globals.php)

# javascript - 函数 (..) 抛出“eval is evil”消息

> ID：10355010
> 
> 赞同：4
> 
> 时间：2012-04-27T17:12:59.727
> 
> 标签：javascript, eval, jslint

我没有使用 eval，我不确定 Crockford 的以下问题是什么。是否有更好的方法来解决以下问题，或者这只是我需要忽略的事情（如果有需要改进的地方，我更喜欢完善/改进我的解决方案）。

我正在使用一些像素跟踪的东西，在这种情况下，客户端已将 JS 函数绑定到`onclick`HTML 图像标记的属性，该标记会重定向到站点之外。我需要可靠地跟踪点击，而不会在图像上遇到多个事件侦听器的竞争条件。策略是在运行时覆盖事件，在我自己的函数中复制并运行它。请注意，这适用于我无法控制且无法更改的站点。所以解决方案看起来像：

```
...
func = Function(img.attr('onclick'));
...
img.attr('onclick', '');
... //some custom tracking code
func.call(this); 
```

并且 JSLint 检查器会抛出`eval is evil`错误。

`href`有没有更好的方法来避免围绕动作的多个事件的竞争条件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T17:16:05.683

您正在隐式使用`eval`，因为您要求回调函数*，因为它在 HTML 中作为字符串指定为属性，*然后`Function`用它构造 a 。

只需使用`img.onclick` *属性*，您将直接获得浏览器从属性中构建的功能，然后您可以`.call`：

```
var func = img.onclick; // access already compiled function
img.onclick = null;     // property change updates the attribute too

... // some custom tracking code

func.call(img, ev);     // call the original function 
```

或者更好：

```
(function(el) {
    var old = el.onclick;
    el.onclick = function() {
        // do my stuff
        ..
        // invoke the old handler with the same parameters
        old.apply(this, arguments);
    }
})(img); 
```

后一种方法的优点有两个：

1.  它不会创建新的全局变量 - 一切都隐藏在匿名闭包中
2.  它确保使用与提供给替换函数的参数完全相同的参数调用原始处理程序

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T17:34:10.013

```
var oldClick = myImg.onclick;
myImg.onclick = function(evt){ 
  // Put you own code here
  return oldClick.call( this, evt );
}; 
```

# javascript - 如何在我的网站上发布与 facebook 页面相同的 FB 帖子？

> ID：10355011
> 
> 赞同：0
> 
> 时间：2012-04-27T17:13:03.487
> 
> 标签：javascript, facebook, feed

我知道如何从 FB.api 检索帖子数据，并且已经开始解析数据并显示每个帖子的内部数据。但我希望每个提要看起来与 facebook 主页提要看起来一样。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T05:50:12.377

您可以使用 Open Graph 来完成。结果是一个 JSON 数据馈送，您可以将其作为 html 流式传输到您的站点或加载到网页中。我建议使用 ajax 或使用 JavaScript 将其加载为 RAW JSON 来呈现它......

```
 var Appid = 12341234; // User the one FB gave you
            var AppSecret = "YOUR_APP_SECRET"; // Use the one FB gave You
            var PageIdOrName = "matt.j.crawford"; // This could be a number or an offical name

            var tokenRequest = String.Format("https://graph.facebook.com/oauth/access_token?client_id={0}&client_secret={1}&grant_type=client_credentials", Appid, AppSecret);
            var token = new System.Net.WebClient().DownloadString(tokenRequest).Split(new char[] { '=' })[1];
            var feedRequest = String.Format("https://graph.facebook.com/{0}/feed?access_token={1}", PageIdOrName, token);
            var feed = new System.Net.WebClient().DownloadString(feedRequest).Replace("\\/", "/");

            var jss = new System.Web.Script.Serialization.JavaScriptSerializer();
            var finalObject = jss.Deserialize<dynamic>(feed); 
```

这些不是关于此的任何真实文档，所以...我只是想通了。

在渲染页面之前不要加载它，因为它需要几秒钟才能完成加载，一种选择是使用 IHttpHandler 并将其加载为 JavaScript 文件并在服务器端渲染它......

另一种选择是在页面加载后使用 ajax 加载呈现的 html。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:35:36.890

[https://developers.facebook.com/docs/reference/plugins/like-box/](https://developers.facebook.com/docs/reference/plugins/like-box/)从页面获取提要并以与 Facebook 相同的格式显示。否则，您需要自己手动设置样式，确保它看起来不会与 Facebook 自己的界面相似。

# javascript - 在 HTML 中提交时引用另一个 div id

> ID：10355012
> 
> 赞同：0
> 
> 时间：2012-04-27T17:13:06.573
> 
> 标签：javascript, html

我有一个包含提交按钮的表单。当我单击此提交按钮时，我想转到另一个 id 为 home 的 div。这就是我现在正在做的事情（这是行不通的）：

```
<input type="submit" class="submit" href="#home" name="action" value="Redirect"/> 
```

例如，如果我有：

```
 <div id="home"><ul><li>Hello World</li></ul></div>
 <input type="submit" class="submit" href="#home" name="action" value="Redirect"/> 
```

这行不通。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:19:20.700

href 不是输入元素的有效属性。试试这个：

```
<input type="submit" class="submit" onclick="location.href = '#home'" name="action" value="Redirect"/> 
```

如果这是在表单内，它将提交表单，除非您有阻止这种情况发生的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:21:17.547

您需要将表单的操作设为“#home”。然后在 home div 上方添加一个命名锚。

```
<html>
    <body>
        <a name="home"></a>
        <div style="height:1500px;">

        </div>
        <form action="#home">
            <input type="submit" value="Home">
        </form>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T17:24:09.410

只是你在一个函数中提到重定向页面....然后通过 onclcik="function_name" 调用该函数名；

```
for eg:

function_name
{
some code .......
location.href = 'home.html';
}
<input type="button" onclick="function_name">
your code.......... 
```

# c# - WPF 中的动态控件 - 添加可变数量的控件

> ID：10355013
> 
> 赞同：2
> 
> 时间：2012-04-27T17:13:33.300
> 
> 标签：c#, wpf

我试图弄清楚是否有办法将控件动态添加到另一个控件中（我知道这有点含糊......）。我的程序在 C# 4.0 和 WPF 中。基本上，我正在尝试创建一个数据网格，但与拥有普通类型的“单元格”（即文本、超链接等）相反，我需要每个单元格来保存许多项目。我认为这在数据网格中是不可能的，所以我正在尝试执行以下操作：使用堆栈面板，添加可变数量的包装面板。每个包装面板将包含 7 个网格，每个网格将保存我想要的数据（我可能会使用一些用户控件来代替我认为的网格......）

我到目前为止的代码示例...

```
 <StackPanel Height="559" HorizontalAlignment="Left" Margin="24,11,0,0" Name="tyStackPanel" VerticalAlignment="Top" Width="783">
                <WrapPanel Height="100">
                    <Grid Width="100" Height="100">

                    </Grid>
                </WrapPanel>
                <WrapPanel Height="100">

                </WrapPanel>
            </StackPanel> 
```

有没有办法创建可变数量的包裹面板？（即，就像您在数据网格中有可变数量的行一样）

非常感谢任何帮助和建议！

PS图我应该解释一下我想要更好地实现的目标。我有一个项目集合，每个项目都有 5 个我想一起显示的属性。这些项目按名称（如数据列中的一行）和列标题（不是 5 个属性之一）分组。我想按 (Name, ColumnHeader) 对对集合进行分组，然后在每个“单元格”中显示这 5 个属性。在我尝试在上面进行设置的方式中，每个“名称”都有一个 WrapPanel，每个 ColumnHeader 都包含一个单元格/网格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:18:28.040

WPF supports this very well with the `ItemsControl` and its various derived controls, one of which is the `DataGrid`, which actually *does* support the scenario you're looking for.

Basically, when you use an `ItemsControl`, `DataGrid` or one of these item controls, you bind the `ItemsSource` to whatever property holds your data items, and define the `DataTemplate`s for each item, which can be any arbitrarily-complex block of XAML. For `DataGrid`, you can swap a normal column for a `DataGridTemplateColumn`, which can, again, be as complex as you want.

Check out the [Data Templating Overview](http://msdn.microsoft.com/en-us/library/ms742521.aspx) for, well, an overview.

# opencv - 如何比较二值模式图像的两个轮廓？

> ID：10355015
> 
> 赞同：2
> 
> 时间：2012-04-27T17:13:43.997
> 
> 标签：opencv, compare, pattern-matching

我正在用 C 语言创建一个零件扫描仪，它将扫描零件的所有可能性作为目录中的图像提取出来。我的代码当前从该目录中获取所有图像并将它们转储到向量中。然后我为所有图像生成轮廓组。然后程序进入一个while循环，它不断地从网络摄像头中抓取图像，并为这些图像生成轮廓。我已经为零件设置了一个夹具，因此方向和尺寸不是问题，但是我不想校准机器，因此模板图像和拍摄的零件图像之间可能存在移动。

比较轮廓的最佳方法是什么？我尝试了几种方法，包括没有轮廓的matchTemplate，但是如果你看看下面的两个部分，你会发现这两个非常接近，所以matchShapes和matchTemplate无法像我使用的那样区分它们他们。我也不确定如何使用 cvMatchShapes。它仅适用于将图像直接加载到匹配形状中，但结果尚无定论。我认为轮廓是要走的路，我只是不确定如何实施比较阶段。任何帮助都会很棒。

您可以在此处查看模板：[http](http://www.cryogendesign.com/partDetection.html) ://www.cryogendesign.com/partDetection.html “

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T10:55:05.387

如果您准备好自己动手，一种方法可能是计算“距离图像”（为每个像素分配到作为参考的轮廓的最小欧几里德距离）。请参阅[http://en.wikipedia.org/wiki/Distance_transform](http://en.wikipedia.org/wiki/Distance_transform)。

使用此距离图像，您可以快速计算新轮廓到参考轮廓的平均距离（对于每个轮廓像素，获取距离图像的距离）。平均距离为您提供拟合优度的指示，并让您找到与一组参考模板的最佳匹配。

如果零件有一定的移动自由度，情况会有点困难：在计算平均距离之前，您必须将新轮廓拟合到参考轮廓。您将需要应用合适的变换（平移、旋转、可能缩放），并找到将最小化...平均距离的参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-03T18:32:06.267

您可以计算两个轮廓之间的倒角距离：

![倒角](../Images/1f4f5f070ac295f40f01ce4e1567ee86.png)

`T`和`E`是模板和图像的边缘集，`x`是开始比较两组边缘的参考点。所以对于每一个`x`你得到不同的价值。

DT 是图像的距离变换。Matlab 在[这里](http://www.mathworks.com/help/images/ref/bwdist.html)提供了算法。

如果您想了解如何计算倒角距离的更详细版本，请查看[此处](http://research.microsoft.com/en-us/um/people/ablake/papers/ablake/Shotton_ICCV05.pdf)。

# javascript - 在现有行之后插入表格行

> ID：10355025
> 
> 赞同：0
> 
> 时间：2012-04-27T17:14:34.433
> 
> 标签：javascript, html-table

我有一个 MVC 应用程序，其中一个页面通过 ajax 调用控制器方法，然后返回具有大量表行的局部视图。请注意，不返回完整表，而只返回表行。

我需要在表格中的特定位置添加这些表格行。我有一个对表的引用，需要在之后添加行（或者在添加新行之后，实际上引用的行将被删除）。使用 jQuery 这将非常简单：

```
$(newRows).insertAfter(tr);
tr.remove(); 
```

问题是 newRows html 可能非常非常大，我发现通过 jQuery 插入它们可能需要相当长的时间。仅通过纯 javascript 插入没有 jQuery 的行要快得多。

我的问题是我一生都无法弄清楚如何在给定表格行之后或之前插入新行。我已经尝试过 insertBefore、insertAfter 和 appendTo 方法，但问题是 newRows 变量只是一个 html 字符串而不是实际的 DOM 节点。有没有办法只在参考表行之前或之后插入 html 而不必将表行的 html 字符串转换为 DOM 元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:24:55.260

您可以尝试返回一个对象数组（json）并使用此数组通过 JS 创建新行并将它们附加到您想要的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:24:58.757

您可以使用 innerHTML，但在您的情况下需要考虑一下，因为您只想追加行，而不是完全覆盖内容。使用 innerHTML 总是比 DOM 操作更快。也许您可以将行放在新表中，但将表放在现有表的下方以使其看起来像它的一部分？就个人而言，我对 jquery 的速度很好奇，我发现 jquery 通常不是问题的根源，更多的是它是如何使用的——

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T17:31:29.540

转换字符串的方法是创建一个空 div 并将字符串设置为 innerHTML。它们将被转换为 DOM，并且可以通过 div childNodes 访问；

然后你可以使用一个文档片段插入所有的 DOM 元素，使用 appendChild()

完成后，您只需插入文档片段，因此在实际文档上只插入一个而不是多个。

一篇关于文档片段的好文章[http://ejohn.org/blog/dom-documentfragments/](http://ejohn.org/blog/dom-documentfragments/)

# networking - 如何创建显示数据如何在 TCP 中传输的时空图？

> ID：10355029
> 
> 赞同：-1
> 
> 时间：2012-04-27T17:14:50.640
> 
> 标签：networking, tcp, network-programming

我需要绘制一个客户端连接到服务器，然后请求数据，服务器发送 x 字节数据，然后服务器关闭连接的时空图。

首先，我不确定会有多少次来回旅行，我在想：

1.  客户端请求连接
2.  服务器接受 3 个客户端发送 ACK
3.  客户端请求数据
4.  服务器发送 x 字节的数据
5.  客户端发送 ACK
6.  服务器关闭连接
7.  客户端发送 ACK

那是对的吗？？

另外，我需要指定 SEQ、ACK 编号和 SYN/ACK/FIN 位，我得到了第一部分，但是 SYN/ACK/FIN “位”是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T21:42:27.770

我找到了一个不错的网站，可以帮助你。[这里](http://www.pcvr.nl/tcpip/tcp_conn.htm)这张照片显示了三次握手和最后的断开连接。注意客户端和服务器交换数据包时 SYN 和 ACK 号的变化。FIN 是断开连接的触发器。它可以由客户端或服务器发送。来源：[http ://www.pcvr.nl/tcpip/tcp_conn.htm](http://www.pcvr.nl/tcpip/tcp_conn.htm)

![在此处输入图像描述](../Images/a8c34f5040625b5fd840edce9b002d60.png)

# mahout - 评估推荐人 - 在 x 种情况下无法推荐

> ID：10355031
> 
> 赞同：4
> 
> 时间：2012-04-27T17:15:00.427
> 
> 标签：mahout

我正在更详细地探索 Mahout in Action 中的一些代码示例。我已经建立了一个小测试来计算应用于我的数据的各种算法的 RMS。

当然，多个参数会影响 RMS，但我不理解运行评估时生成的“无法在...情况下推荐”消息。

查看 StatsCallable.java，这是在评估程序遇到 NaN 响应时生成的；训练集中的数据或用户偏好可能没有足够的数据来提供推荐。

似乎 RMS 分数不受大量“无法推荐”案例的影响。这个假设正确吗？我是否应该不仅在 RMS 上评估我的算法，还要评估“无法推荐”案例与我的整体训练集的比率？

我会很感激任何反馈。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T17:44:30.947

是的，这基本上意味着根本没有数据可以作为估计的基础。这通常是数据稀疏的症状。这应该很少见，并且只发生在数据非常少或与他人断开连接的用户身上。

我个人认为这没什么大不了的，除非它是一个非常重要的百分比（20%+？）如果你根本无法为许多用户生成任何记录，我会更担心。

# mysql - 如何在mysql查询中在运行时配置表

> ID：10355034
> 
> 赞同：1
> 
> 时间：2012-04-27T17:15:17.023
> 
> 标签：mysql, sql

人们知道我们可以像这样使用 if 语句在 select 语句中配置查询

```
select if(var=1,amount,amount/2) from mytable; 
```

但是，如果我想实现这样的目标怎么办：

```
select amount from if(var=1,mytable1,mytable2); 
```

有没有办法在运行时配置表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:20:19.060

```
SELECT amount FROM mytable1 WHERE @var = 1
UNION
SELECT amount FROM mytable2 WHERE @var = 0 
```

**UPD：**下面是 MySQL`EXPLAIN`的查询部分的样子，它的条件评估为`FALSE`：

![](../Images/0377640afd5195f210c99a346f66faa1.png)

注意`Impossible WHERE`部分。MySQL 认识到 in 中的表达式`WHERE`不断评估为`FALSE`，因此它甚至不会尝试执行查询。因此，使用这种方法时没有性能开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:27:44.133

（*升级到答案*）

**是从哪里来`var`的？**

1.  如果它是另一种语言的变量，您可以用另一种语言对其进行测试，然后根据需要构造不同的 SQL：

    ```
    $sql = "SELECT amount FROM " . ($var = 1 ? "mytable1" : "mytable2"); 
    ```

2.  如果它是 SQL 中的用户变量，您可以类似地使用围绕两个替代[`IF`语句](http://dev.mysql.com/doc/refman/5.5/en/if-statement.html)`SELECT`的语句：

    ```
    DELIMITER ;;

    IF @var = 1 THEN
      SELECT amount FROM mytable1;
    ELSE
      SELECT amount FROM mytable2;
    END IF;;

    DELIMITER ; 
    ```

3.  如果是其他任何内容（例如表中的字段），那么您的问题就没有多大意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:04:45.030

根据 mysql 手册页，您似乎无法使用传统语法执行此操作。

“用户变量旨在提供数据值。它们不能直接在 SQL 语句中用作标识符或标识符的一部分，例如在需要表或数据库名称的上下文中，或作为保留字（如 SELECT） 。” - [http://dev.mysql.com/doc/refman/5.6/en/user-variables.html][1]

例外情况是您可以组装准备好的语句，但对于大多数编程任务可能不是更好的解决方案。最好将 sql 字符串的生成留给调用 mysql 的语言。

但是，如果您将此作为“仅限 sql”任务的一部分，例如导入，那么这似乎是您必须采用的方法。

```
SET @s = CONCAT("SELECT * FROM ", if(true, "table1", "table2"), " LIMIT 1");
PREPARE stmt FROM @s;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;

SET @s = CONCAT("SELECT * FROM ", if(false, "table1", "table2"), " LIMIT 1");
PREPARE stmt FROM @s;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

# macos - Using jarbundler ant task to add dependencies to the app

> ID：10355035
> 
> 赞同：0
> 
> 时间：2012-04-27T17:15:17.417
> 
> 标签：macos, ant, jar, jarbundler

I have a Netbeans Java project. When I build my project it create a directory **dist** and **dist/lib**. It stores the Jar of the file in **dist** and other jar files on which the main jar file depends, in the **lib** directory.

Now I want to create a release for OSX. For that I am using the [*jarbundler* ant task](http://informagen.com/JarBundler/) like this

```
<target name="mac">
        <mkdir dir="release"/>
        <taskdef name="jarbundler"
        classname="net.sourceforge.jarbundler.JarBundler" />
        <jarbundler dir="release"
            name="MyApp"
            mainClass="controller.MyApp"
            jar="dist/MyApp.jar" />
</target> 
```

This creates the app with the jar, but how do I add the dependent libraries to the app.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:38:09.233

这是需要的

**jar**属性应该像这样替换为**jarfileset**。

```
<target name="mac">
      <mkdir dir="release"/>
      <taskdef name="jarbundler"
               classname="net.sourceforge.jarbundler.JarBundler" />

               <jarbundler dir="release"
                           name="MyApp"
                           mainClass="controller.MyApp">
                      <jarfileset dir="dist">
                          <include name="**/*.jar" />
                      </jarfileset>
               </jarbundler>
</target> 
```

# c# - Mvc 3 model auto binding

> ID：10355037
> 
> 赞同：-1
> 
> 时间：2012-04-27T17:15:23.697
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3

I have a ViewModel that I want to autobind to another ViewModel on post.

Eg. if I have

```
public class ViewModelA{
    public string Stuff {get;set;}
}

public class ViewModelB{
    public string MyStuff {get;set;}
    .
    .
    .
} 
```

For display/rendering purposes, I want the partial to bind to ViewModelA, because it's a much simpler object and hence it'll hopefully be much more reusable since creating an interactive view is a costly proposition.

However, I need all the form information on the page **on post**. I suppose I could widen the controller action to take both ViewModelA and ViewModelB, and then do additional logic to assign ViewModelA property into ViewModelB, but is there a cleaner, more declarative way to do this?

I guess I'm wondering if I could tag ViewModelA, with some attribute like this:

```
 [Bind(Prefix = "ViewModelB", Include = "MyStuff")] 
```

I know I can do it at the action level, but can I inject this logic at the ViewModel level?

Also would be nice if Razor follows a more CQRS approach. eg.

```
Html.TextBoxFor(target => target.Property, model => model.Property2) 
```

So that on render, the textbox is initialized with Property2 value, but on post, it's posted to target.Property.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:24:24.193

如果您的两个模型出于绑定目的而具有相同的属性名称，那么无论您是通过继承还是通过具有其业务是设置真实属性名称的辅助属性来实现这一点，这将更加直接。

这将使 ViewModelB 期望能够以不同的方式处理某些属性名称并使视图模板不那么混乱更加清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:25:12.507

只需将其指定`ViewModelB`为处理表单帖子的操作的参数。

例如：

```
[HttpPost]
public ActionResult Create(ViewModelB newWidget) {
    // handle creation of widget... all information on the form pertaining to viewmodelB will be
    // available in newWidget
} 
```

使用什么模型来生成视图并不重要；只要有与 ViewModelB 中的属性名称匹配的表单字段名称，Model Binder 就会为您处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T17:21:05.473

不能继承`ViewModelB`吗`ViewModelA`？

```
public class ViewModelA : ViewModelB
{
     public string Stuff {get;set;}
     // etc.
}  

public class ViewModelB
{     
    public string MyStuff {get;set;}
    // etc.
} 
```

然后在您的 Controller 方法中，只需指定更宽`ViewModelB`的值，模型绑定仍应映射所有内容。

```
[HttpPost]
public ActionResult(ViewModelB model)
{
    // etc.
} 
```

# ios5 - CBCentralManager how to send passkey?

> ID：10355048
> 
> 赞同：0
> 
> 时间：2012-04-27T17:16:15.170
> 
> 标签：ios5, core-bluetooth, bluetooth-lowenergy

I am new to BLE, and the LE security says it supports passkey Just Works, Out of Band and Passkey Entry. Given scenarios that the devices expects the passkey, then how to pass it through CentralManager while connecting to peripheral?.. Or do we have any alternate way to communicate with Security Manager ? Kindly provide the inputs.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T10:57:54.687

请参阅 Apple 的蓝牙指南。有观点认为外围设备必须发送一个不足的自动化。然后IOS做所有自动

# php - 刷新浏览器后如何让数组和会话变量恢复为空白？

> ID：10355049
> 
> 赞同：0
> 
> 时间：2012-04-27T17:16:26.943
> 
> 标签：php, javascript, json

我有一个问题，每次刷新浏览器时，我都希望包含 $_SESSION 变量的数组恢复为空白。现在假设我上传了 2 个文件，然后刷新浏览器，当我上传另一个文件时，它会显示以前上传的文件的名称，而不是它不应该上传的文件。如果刷新浏览器，如何让数组和会话变量恢复为空白？

下面是代码：

```
 function stopImageUpload(success){

          var imageNameArray = new Array();
// WHEN PAGE IS REFRESH, ARRAY SHOULD GO BACK TO BEING BLANK

 imageNameArray = <?php echo json_encode(isset($_FILES ['fileImage']['name']) ? $_FILES ['fileImage']['name'] : null); ?>;
//RETRIEVES THE SESSION VARIABLE FROM THE PHP SCRIPT OF THE FILE NAMES WHICH HAVE BEEN UPLOADED

          var result = '';

          if (success == 1){
             result = '<span class="msg">The file was uploaded successfully!</span><br/><br/>';

                for(var i=0;i<imageNameArray.length;i++)  //LOOP THROUGH ALL UPLOADED FILE NAMES
        {
             $('.listImage').append(imageNameArray[i]+ '<br/>');//APPEND FILE NAME

         }

          }
          else {
             result = '<span class="emsg">There was an error during file upload!</span><br/><br/>';
          }

    return true;

    } 
```

下面是 php 脚本，它从上面的 javascript 函数上传另一个页面上的文件：

```
<?php

    session_start();

    $result = 0;
    $errors = array ();
    $dirImage = "ImageFiles/";

if (isset ( $_FILES ['fileImage'] ) && $_FILES ["fileImage"] ["error"] == UPLOAD_ERR_OK) {

$fileName = $_FILES ['fileImage'] ['name'];

$fileExt = pathinfo ( $fileName, PATHINFO_EXTENSION );
$fileExt = strtolower ( $fileExt );

$fileDst = $dirImage . DIRECTORY_SEPARATOR . $fileName;

        if (count ( $errors ) == 0) {
            if (move_uploaded_file ( $fileTemp, $fileDst )) {
                $result = 1;

            }
        }

    }

    ?>

<script language="javascript" type="text/javascript">window.top.stopImageUpload(<?php echo $result;?>);</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T17:19:39.130

提交表单并且您的 PHP 完成工作后，您需要执行 303 重定向到您希望显示的页面。然后，当用户刷新页面时，您不会再次提交表单。

例如：

```
header('Location: ' . $_SERVER['PHP_SELF'], true, 303); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:25:51.210

虽然我同意@Reza Sanaie 的评论，但您可以通过在成功上传后取消设置变量来解决您的特定问题：

```
 if (success == 1)
     {
         result = '<span class="msg">The file was uploaded successfully!</span><br/><br/>';

         for(var i=0;i<imageNameArray.length;i++)  //LOOP THROUGH ALL UPLOADED FILE NAMES
         {
             $('.listImage').append(imageNameArray[i]+ '<br/>');//APPEND FILE NAME

         }

         $_SESSION ['fileImage'] = NULL; // or use unset()
     } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T17:56:18.937

只需在 PHP 中进行错误检查，然后将数组传递给 HTML 页面以显示页面中上传文件的列表。你不需要javascript。

看看[如何在 PHP 中上传文件](http://www.w3schools.com/php/php_file_upload.asp)

# python - 如何分隔变量中的两个单独的单词？

> ID：10355051
> 
> 赞同：-1
> 
> 时间：2012-04-27T17:16:34.307
> 
> 标签：python

我有一个变量，其中包含两个用空格分隔的单词，我想将它分成两个变量，每个单词一个。我该怎么做？

例如，我的字符串是`hello there`并且我想将其拆分为变量`word1`和`word2`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T17:17:19.910

```
s = 'hello there'

word1, word2 = s.split() 
```

会为你做这件事。例如，

```
In [63]: s = 'hello there'
In [64]: word1, word2 = s.split()
In [65]: print word1
hello
In [66]: print word2
there 
```

`split()`非常通用，您还可以指定要拆分的其他字符。有关更多信息，`split()`请参阅[http://docs.python.org/library/stdtypes.html?highlight=split#str.split](http://docs.python.org/library/stdtypes.html?highlight=split#str.split)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-27T17:17:30.530

你应该使用[`string.split(s[, sep[, maxsplit]])`](http://docs.python.org/library/string.html#string.split)：

```
s = "hello world"
word1, word2 = s.split(' ', 1) 
```

它通过您作为参数提供的字符将字符串拆分为列表。默认是一个空格，但我将其用作参数只是为了使其更清晰。

您还可以提供`maxsplit`参数并确保字符串被拆分不超过`maxsplit`多次（就像在我们的字符串中一样 - 我们必须有一个拆分，因为我们将拆分的单词插入到两个变量中。）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T17:17:49.567

```
word1, word2 = 'hello there'.split() 
```

# ruby - 两个表之间的sequel one_to_one 关系失败

> ID：10355053
> 
> 赞同：1
> 
> 时间：2012-04-27T17:16:41.903
> 
> 标签：ruby, sqlite, sequel

我有两张表，它们之间有 one_to_one 关系

表一：User - 有用户相关的列 表二：Security_Option - 有安全相关的列和 user_id（它引用了 User 表）

在 user.rb 我有

```
one_to_one :security_option 
```

同样在 security_option.rb 我有

```
one_to_one :user 
```

当我有一个访问 security_option 的用户对象时，但是当我有 SecurityOption 对象并尝试访问该用户时，我得到一个 sql 异常

```
Sequel::DatabaseError: SQLite3::SQLException: no such column: users.security_option_id 
```

我知道我可以在 users 中添加一个 security_option_id 列，这将解决问题，但不应该可以通过 security 表中的 user_id 获取用户吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:37:21.190

one_to_one 应该在关联的一侧使用，而 many_to_one 应该在另一侧使用。包含外键的模型应该使用many_to_one，被外键引用的模型应该使用one_to_one。请参阅[http://sequel.jeremyevans.net/rdoc/files/doc/association_basics_rdoc.html](http://sequel.jeremyevans.net/rdoc/files/doc/association_basics_rdoc.html)。

# php - PJAX 不工作

> ID：10355055
> 
> 赞同：1
> 
> 时间：2012-04-27T17:16:57.257
> 
> 标签：php, jquery, ruby-on-rails, ajax, pjax

我的 pjax 不工作，因为我看到时间变化..

你能发现我的代码有问题吗？

```
<html><head>
<script src="jquery.js"></script>
<script src="jquery.cookie.js"></script>
<script src="jquery.pjax.js"></script>
<script type="text/javascript">
$('a[data-pjax]').pjax()
</script>
</head><body>
<?php
$header = "this is first part
<br/> <a href='pjax2.php' data-pjax='main'>GO</a>";
$date = date("Y-m-d H:i:s");
$footer = "this is second part";
$headers = getallheaders();
if(($headers['X-PJAX'] == 'true')){
echo "<div id='main'>first change</div>";
}else{
echo "$header<br/>$date<br /><div id='main'>first page</div><br />$footer";
}
?>
</body></html> 
```

最佳，MJ

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T05:10:28.863

编辑：**主要问题是您尝试使用尖端浏览器功能而没有掌握网页的基本调试。**

你用 php 解决了这个错误`getallheaders()`，所以这对你来说应该很容易。

第一步：加载[http://www.bluereservations.com/pjax.php](http://www.bluereservations.com/pjax.php)，打开浏览器控制台，刷新页面，查看控制台消息。

它报告一个错误，即`$ is not defined`. 这表明`jquery`没有成功加载。

第 2 步：加载[http://www.bluereservations.com/jquery.js](http://www.bluereservations.com/jquery.js)

一个谜团解开了。

在解决了页面的所有明显问题之后，再看看更模糊的东西。对于将涉及检查网络资源、http 请求和响应标头等的 pjax。

如果您使用 Firebug for Firefox，请阅读[http://getfirebug.com/wiki/index.php/Net_Panel](http://getfirebug.com/wiki/index.php/Net_Panel)了解详细信息。对于 pjax，您需要打开该`persist`选项以防 pjax 失败。

**以下内容可能会解决您的测试页的其他问题...**

响应`X-PJAX`请求时，您只发送主要内容，而不是整个页面。对于您的测试用例，例如

```
<?php $headers = getallheaders();
      if($headers['X-PJAX'] == 'true'): ?>
first change
<?php else: ?>
<html>
<head>
<script src="jquery.js"></script>
<script src="jquery.cookie.js"></script>
<script src="jquery.pjax.js"></script>
<script type="text/javascript">
$(function() { $('a[data-pjax]').pjax(); });
</script>
</head>
<body>
<?php
  $header = "this is first part
    <br/> <a href='pjax2.php' data-pjax='main'>GO</a>";
  $date = date("Y-m-d H:i:s");
  $footer = "this is second part";
  echo "$header<br/>$date<br /><div id='main'>first page</div><br />$footer";
?>
</body>
</html>
<?php endif; ?> 
```

jquery-pjax 确实允许您发送整个文件以响应`X-PJAX`请求。在文档中查找该`fragment`选项。

就个人而言， [HTMLDecor](http://github.com/shogun70/HTMLDecor)是一种更容易获得免费`pushState`支持的方法，但我有偏见。

# cakephp - 蛋糕php元素缓存

> ID：10355057
> 
> 赞同：1
> 
> 时间：2012-04-27T17:17:13.340
> 
> 标签：cakephp, caching

我不能使元素缓存工作：

```
echo $this->element('categorytree', array(
    'cache' => array(
        'key'=>'categorytree-cache','time' => '+1 hour'
    )
)) 
```

我检查了 core.php：

```
// In development mode, caches should expire quickly.
$duration = '+999 days';
/*if (Configure::read('debug') >= 1) {
    $duration = '+10 seconds';
}*/ 
```

如您所见并发表评论 - 以防止在调试模式下进行短缓存...

但是当我刷新页面时，会显示缓存元素通过 requestAction() 执行的 SQL 查询......所以没有缓存......为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T20:39:56.990

我可能在这里错了，但我认为正确的电话是：

```
echo $this->element('categorytree', array(), array(
    'cache' => array(
        'key'=>'categorytree-cache','time' => '+1 hour'
    )
)) 
```

请注意，第二个参数是元素*参数*，而第三个是元素*选项*（您在这里需要什么）。

[您可以在此处](http://api20.cakephp.org/view_source/view#line-270)查看函数签名。

# iphone - Illegal attempt to establish a relationship between objects in different contexts.. why do i get this error?

> ID：10355064
> 
> 赞同：1
> 
> 时间：2012-04-27T17:17:29.050
> 
> 标签：iphone, objective-c, ios, xcode, core-data

I have this code:

```
Entry *entry = [Entry create];

NSOrderedSet *media = [[NSOrderedSet alloc] init];
entry.media = media;

EntryTableInfo *entryTableInfo = [[EntryTableInfo alloc] init];
entry.entryTableInfo = entryTableInfo;

[[CoreDataStore mainStore] save]; 
```

And when it saves, it's giving me the error `Illegal attempt to establish a relationship between objects in different contexts`.

The `NSOrderedSet` code was already there, and was working fine. The `EntryTableInfo` code wasn't, that's new, and that's the cause of the crash, but I'm not sure why?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T17:38:40.523

看起来您的`Entry`和`EntryTableInfo`类是托管对象（的子类`NSManagedObject`）。

托管对象应该仅在托管对象上下文（`NSManagedObjectContext`对象）内“存在”。特别是它们应该只在这样的上下文中创建。

您的`[Entry create]`方法可能会这样做，但`[[EntryTableInfo alloc] init]`会创建一个没有上下文的托管对象，这是错误的。

尝试查看方法实现代码并以类似方式`[Entry create]`创建实例。`EntryTableInfo`

# nstimer - NSTimer only counting down seconds?

> ID：10355072
> 
> 赞同：0
> 
> 时间：2012-04-27T17:18:01.573
> 
> 标签：nstimer

My NSTimer is working but only counting down seconds? The minutes show up as "00" and the seconds count down, minutes stay at zero. The int countdownInt comes from user input and I have been testing by entering "45" for a 45 minute count down timer. The only thing that happens is that the seconds are counting down from "45"? countdownInt, seconds and minutes have all been declared int in the .h file

Thanks for your help!

```
 countdownInt -=1;
 seconds = countdownInt % 60;
 minutes = (countdownInt / 60) % 60;
countdownTimerLabel.text = [NSString stringWithFormat:@"%02d:%02d", minutes, seconds]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:21:56.977

如果您希望用户输入以分钟为单位，您可能应该在开始递减秒数之前将其乘以 60。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:24:47.747

如果输入是 countDownInt（以分钟为单位），则

```
int countDownIntSeconds = countDownInt;

countDownIntSeconds -= 1;
seconds = countDownIntSeconds;
minutes = countDownIntSeconds % 60;
countdownTimerLabel.text = [NSString stringWithFormat:@"%02d:%02d", minutes, seconds]; 
```

# git - How do I pick an specific version from previous commits in git?

> ID：10355079
> 
> 赞同：0
> 
> 时间：2012-04-27T17:18:39.957
> 
> 标签：git

I need to revert files from various commits to their previous state.

The reason is we won't deliver a particular functionality in this release.

I have spotted the commits already.

I think cherry-pick and/or rebase is in order but the search results I have confuse me a bit more.

How do I pick an specific version from previous commits in git?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T17:19:49.053

如果您只想将单个文件恢复到之前提交中的状态，请使用`checkout`：

```
git checkout <previous commit SHA> -- /path/to/file 
```

如果要撤消整个提交，请使用`revert`：

```
git revert <SHA of commit to undo the effects of> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T23:23:59.960

如果您只是尝试返回到较早状态的一个文件，那么结帐是正确的解决方案

```
git checkout <sha-1 hash in hex> filename.ext 
```

如果您希望将整个文件夹/提交返回到较早的状态

```
git revert <sha-1 of commit to reverse> 
```

请注意，使用`revert`sha-1 哈希是***您尝试反转的提交，***而不是您尝试恢复的提交，这不是我最初的预期，我一直做错了，当它给出时变得非常沮丧我尝试时出现难以理解的错误消息。

# php - running a php page via crontab and having issues with if file_exists

> ID：10355081
> 
> 赞同：-1
> 
> 时间：2012-04-27T17:19:02.573
> 
> 标签：php, crontab, file-exists

I have a question...I am running a php page daily through a crobtab and I seem to be getting erros when this code is run..

```
include(CLASS_PATH .'EmailAddressValidator.php'); 
```

so I applied this code...

```
if(file_exists('/var/www/testsite/classes/EmailAddressValidator.php')){
    include('/var/www/testsite/classes/EmailAddressValidator.php');
}else{
    include(CLASS_PATH .'EmailAddressValidator.php');
} 
```

but I also have live site at

`/var/www/livesite/classes/EmailAddressValidator.php`

and its been a pain doing back and forth changing my code from`testsite` to `livesite` is there an easier way to do this..

I've tried..

```
if(file_exists('/var/www/testsite/classes/EmailAddressValidator.php')){
    include('/var/www/testsite/classes/EmailAddressValidator.php');
elseif(file_exists('/var/www/livesite/classes/EmailAddressValidator.php')){
    include('/var/www/livesite/classes/EmailAddressValidator.php');
}else{
    include(CLASS_PATH .'EmailAddressValidator.php');
} 
```

Testing out all answers...will have a vote by monday end day

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T19:07:30.530

您可以改用相对路径

```
../classes/EmailAddressValidator.php 
```

或任何路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T19:15:38.660

您需要确保使用**一致定义的目录位置**，尤其是当您经常在生产环境和开发环境之间切换时。如果你还在不同的操作系统上工作，那么正确的目录结构可能会让人头疼，所以如果你把事情集中起来，它会让你的生活变得更轻松。

例如，您确定要定义`CLASS_PATH`为常量吗？

我建议在执行其他任何操作之前先找到当前目录的位置：

```
$current_dir = dirname(__FILE__); 
```

然后使用这个变量继续向上：

```
$test_dir = $current_dir . '../testsite/';
$live_dir = $current_dir . '../livesite/';
$class_dir = $current_dir . '../classes/';

if(file_exists("$test_dir/EmailAddressValidator.php"))
{
    include("$test_dir/EmailAddressValidator.php");
}
elseif(file_exists("$live_dir/EmailAddressValidator.php"))
{
    include("$live_dir/EmailAddressValidator.php");
}
else
{
    include("$class_dir/EmailAddressValidator.php");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T19:08:04.100

1.）您可以使用配置文件或环境变量来设置您的“环境”：

环境.ini

```
environment = livesite 
```

cronscript.php：

```
$config      = parse_ini_file("./environment.ini");
$environment = $config["environment"];

include "/var/www/$environment/classes/EmailAddressValidator.php"; 
```

现在将 environment.ini 添加到您的 livesite 和 testsite，每个在配置文件中都有相应的条目。

当然你也可以使用其他的配置类型，比如常量（`define("MY_ENVIRONMENT", "livesite")`.

2.) 另一种方法是使用相对文件路径：

```
include "../relative/path/to/classes/EmailAddressValidator.php" 
```

3.) 使用[自动装载机](http://php.net/manual/en/language.oop5.autoload.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-29T19:09:50.083

好吧，您可以使用该`$_SERVER['SCRIPT_FILENAME']`变量在运行时操作 if else 。

我的意思是你可以得到你是否正在使用`testsite`或`livesite`通过做一些`substr`或`explode`在变量上，并通过`if else`语句中的路径传递它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-02T14:33:52.990

通常您会执行以下操作

```
include dirname(__FILE__) . DIRECTORY_SEPARATOR . 'classes' . DIRECTORY_SEPARATOR . 'EmailAddressValidator.php'; 
```

这将自动找到当前运行文件的路径，并根据其相对于运行文件的位置包含您想要的文件。

使用 DIRECTORY_SEPARATOR 常量将确保您的代码可以在 windows 或 linux 系统上运行

# post - 如何对Red5媒体服务器保存的视频进行后期处理

> ID：10355091
> 
> 赞同：0
> 
> 时间：2012-04-27T17:19:42.407
> 
> 标签：post, video, red5

我有一个用例，在将视频流发送到 Red5 服务器后，我想在视频保存后对视频进行后期处理。我想在它们上添加一些元数据标签。

我发现这可以在 ApplicationAdapter 的 appDisconnect() 方法中完成，但还有其他方法可以保存视频，例如使用 ClientBroadcastStream。

例子

```
ClientBroadcastStream stream = (ClientBroadcastStream) app.getBroadcastStream(
    conn.getScope(), "hostStream");
// Stop recording
stream.stopRecording(); 
```

我想知道是否有任何我可以收听的事件（比如告诉我视频已保存并使用此文件名保存在此位置）以对视频进行后处理。这样我就不需要在多个地方放钩子了。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T16:00:37.067

“ez”方式是通过扩展这个基类来实现自己的ClientBroadcastStream。然后简单地覆盖“stopRecording()”方法。如果您想花点时间在问题跟踪器上添加增强请求，我很乐意考虑为此类事物添加范围事件。使用范围事件，您可以在任何地方监听它们并适当地处理它们。Red5 问题跟踪器：[http ://code.google.com/p/red5/issues/list](http://code.google.com/p/red5/issues/list)

使用自定义流类将在 red5-common.xml 中配置，如下所示：

```
<bean id="clientBroadcastStream" scope="prototype" lazy-init="true" class="com.mypackage.MyClientBroadcastStream">
</bean> 
```

# javascript - JavaScript：从其中获取完全限定的函数名称？

> ID：10355093
> 
> 赞同：5
> 
> 时间：2012-04-27T17:19:47.960
> 
> 标签：javascript, reflection, naming

看看下面的片段。有没有我可以编写的函数来代替`...`生成路由，可以在另一个函数中重用？可能是什么`var route = this.show.fullyQualifiedName`？

```
var services = {
    'github.com': {
        api: {
            v2: {
                json: {
                    repos: {
                        show: function(username, fn) {
                            var route = ...; 
                            // route now == 'github.com/api/v2/json/repos/show'

                            route += '/' + username;

                            return $.getJSON('http://' + route).done(fn);
                        }
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T17:24:03.170

不，没有，至少没有使用“反射”风格的操作。

对象不知道包含它们的对象的名称，尤其是因为同一个对象（引用）可能包含在*许多*对象中。

您可以做到的唯一方法是从顶部对象开始并向内工作，例如：

```
function fillRoutes(obj) {
    var route = obj._route || '';
    for (var key in obj) {
        if (key === '_route') continue;
        var next = obj[key];
        next._route = route + '/' + key;
        fillRoutes(next);
    }
} 
```

`_route`这将在包含该对象路径的每个对象中放置一个新属性。

见[http://jsfiddle.net/alnitak/WbMfW/](http://jsfiddle.net/alnitak/WbMfW/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:26:36.357

您不能像**Alnitak**所说的那样进行递归搜索，但是可以进行自上而下的搜索，尽管根据对象的大小可能会有些慢。您将遍历对象的属性，检查它是否有子对象。如果它确实有一个孩子，循环遍历它，等等。当你到达链的末端并且你还没有找到你的函数时，移动到下一个孩子并继续搜索。

现在没有时间写一个例子，但希望你能从中拼凑出一些东西。

# browser - 我如何模拟请求浏览器 C#？

> ID：10355097
> 
> 赞同：-1
> 
> 时间：2012-04-27T17:20:14.450
> 
> 标签：browser, request, simulation

我需要模拟对页面的请求，但我需要通过代码来模拟它。我正在使用这段代码，但没有得到好的结果

`private string RemoteURLChecking(string url)` `{try{`

```
 HttpWebRequest request = WebRequest.Create(url) as HttpWebRequest;
    request.Method = "HEAD";
    request.Timeout = 8000;
    HttpWebResponse response = (HttpWebResponse)request.GetResponse();
    if (!response.ResponseUri.ToString().ToLower().Contains("pagenotfound"))
        return "The page exists";
    else
        return "Page not Found"; 
```

} `catch (Exception ex)` `{`

```
 return "Page not Found";
} 
```

`}`

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:33:24.630

你有几个选择，每个选择都有很多 MSDN 上的例子：

[网络客户端](http://msdn.microsoft.com/en-us/library/system.net.webclient.webclient.aspx)

[网页浏览器控制](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)

# algorithm - 寻找最长的重复子串

> ID：10355103
> 
> 赞同：14
> 
> 时间：2012-04-27T17:20:59.390
> 
> 标签：algorithm, pattern-recognition, suffix-tree, suffix-array

解决这个问题的最佳方法（性能方面）是什么？我被推荐使用后缀树。这是最好的方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-20T06:19:55.113

查看此链接：http: [//introcs.cs.princeton.edu/java/42sort/LRS.java.html](http://introcs.cs.princeton.edu/java/42sort/LRS.java.html)

```
/*************************************************************************
 *  Compilation:  javac LRS.java
 *  Execution:    java LRS < file.txt
 *  Dependencies: StdIn.java
 *  
 *  Reads a text corpus from stdin, replaces all consecutive blocks of
 *  whitespace with a single space, and then computes the longest
 *  repeated substring in that corpus. Suffix sorts the corpus using
 *  the system sort, then finds the longest repeated substring among 
 *  consecutive suffixes in the sorted order.
 * 
 *  % java LRS < mobydick.txt
 *  ',- Such a funny, sporty, gamy, jesty, joky, hoky-poky lad, is the Ocean, oh! Th'
 * 
 *  % java LRS 
 *  aaaaaaaaa
 *  'aaaaaaaa'
 *
 *  % java LRS
 *  abcdefg
 *  ''
 *
 *************************************************************************/

import java.util.Arrays;

public class LRS {

    // return the longest common prefix of s and t
    public static String lcp(String s, String t) {
        int n = Math.min(s.length(), t.length());
        for (int i = 0; i < n; i++) {
            if (s.charAt(i) != t.charAt(i))
                return s.substring(0, i);
        }
        return s.substring(0, n);
    }

    // return the longest repeated string in s
    public static String lrs(String s) {

        // form the N suffixes
        int N  = s.length();
        String[] suffixes = new String[N];
        for (int i = 0; i < N; i++) {
            suffixes[i] = s.substring(i, N);
        }

        // sort them
        Arrays.sort(suffixes);

        // find longest repeated substring by comparing adjacent sorted suffixes
        String lrs = "";
        for (int i = 0; i < N - 1; i++) {
            String x = lcp(suffixes[i], suffixes[i+1]);
            if (x.length() > lrs.length())
                lrs = x;
        }
        return lrs;
    }

    // read in text, replacing all consecutive whitespace with a single space
    // then compute longest repeated substring
    public static void main(String[] args) {
        String s = StdIn.readAll();
        s = s.replaceAll("\\s+", " ");
        StdOut.println("'" + lrs(s) + "'");
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-27T18:09:21.050

也可以查看[http://en.wikipedia.org/wiki/Suffix_array](http://en.wikipedia.org/wiki/Suffix_array) - 它们非常节省空间，并且有一些合理的可编程算法来生成它们，例如 Karkkainen 和 Sanders 的“简单线性工作后缀数组构造”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-30T00:29:07.907

这是使用最简单的后缀树的最长重复子串的简单实现。后缀树以这种方式很容易实现。

```
#include <iostream>
#include <vector>
#include <unordered_map>
#include <string>
using namespace std;

class Node
{
public:
    char ch;
    unordered_map<char, Node*> children;
    vector<int> indexes; //store the indexes of the substring from where it starts
    Node(char c):ch(c){}
};

int maxLen = 0;
string maxStr = "";

void insertInSuffixTree(Node* root, string str, int index, string originalSuffix, int level=0)
{
    root->indexes.push_back(index);

    // it is repeated and length is greater than maxLen
    // then store the substring
    if(root->indexes.size() > 1 && maxLen < level)
    {
        maxLen = level;
        maxStr = originalSuffix.substr(0, level);
    }

    if(str.empty()) return;

    Node* child;
    if(root->children.count(str[0]) == 0) {
        child = new Node(str[0]);
        root->children[str[0]] = child;
    } else {
        child = root->children[str[0]];
    }

    insertInSuffixTree(child, str.substr(1), index, originalSuffix, level+1);
}

int main()
{
    string str = "banana"; //"abcabcaacb"; //"banana";  //"mississippi";
    Node* root = new  Node('@');

    //insert all substring in suffix tree
    for(int i=0; i<str.size(); i++){
        string s = str.substr(i);
        insertInSuffixTree(root, s, i, s);
    }

    cout << maxLen << "->" << maxStr << endl;

    return 1;
}

/*
s = "mississippi", return "issi"
s = "banana", return "ana"
s = "abcabcaacb", return "abca"
s = "aababa", return "aba"
*/ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-08-30T02:53:04.913

LRS 问题是最好使用后缀树或后缀数组来解决的问题。两种方法都具有 O(n) 的最佳时间复杂度。

这是使用后缀数组的 LRS 问题的 O(nlog(n)) 解决方案。如果您有后缀数组的线性构造时间算法（这很难实现），我的解决方案可以改进为 O(n)。代码取自我的[图书馆](https://github.com/williamfiset/Algorithms)。如果您想了解有关后缀数组如何工作的更多信息，请务必查看我的[教程](https://www.youtube.com/playlist?list=PLDV1Zeh2NRsCQ_Educ7GCNs3mvzpXhHW5)

```
/**
 * Finds the longest repeated substring(s) of a string.
 * 
 * Time complexity: O(nlogn), bounded by suffix array construction
 *
 * @author William Fiset, william.alexandre.fiset@gmail.com
 **/

import java.util.*;

public class LongestRepeatedSubstring {

  // Example usage
  public static void main(String[] args) {

    String str = "ABC$BCA$CAB";
    SuffixArray sa = new SuffixArray(str);
    System.out.printf("LRS(s) of %s is/are: %s\n", str, sa.lrs());

    str = "aaaaa";
    sa = new SuffixArray(str);
    System.out.printf("LRS(s) of %s is/are: %s\n", str, sa.lrs());

    str = "abcde";
    sa = new SuffixArray(str);
    System.out.printf("LRS(s) of %s is/are: %s\n", str, sa.lrs());

  }

}

class SuffixArray {

  // ALPHABET_SZ is the default alphabet size, this may need to be much larger
  int ALPHABET_SZ = 256, N;
  int[] T, lcp, sa, sa2, rank, tmp, c;

  public SuffixArray(String str) {    
    this(toIntArray(str));    
  }

  private static int[] toIntArray(String s) {   
    int[] text = new int[s.length()];   
    for(int i=0;i<s.length();i++)text[i] = s.charAt(i);   
    return text;    
  }

  // Designated constructor
  public SuffixArray(int[] text) {
    T = text;
    N = text.length;
    sa = new int[N];
    sa2 = new int[N];
    rank = new int[N];
    c = new int[Math.max(ALPHABET_SZ, N)];
    construct();
    kasai();
  }

  private void construct() {
    int i, p, r;
    for (i=0; i<N; ++i) c[rank[i] = T[i]]++;
    for (i=1; i<ALPHABET_SZ; ++i) c[i] += c[i-1];
    for (i=N-1; i>=0; --i) sa[--c[T[i]]] = i;
    for (p=1; p<N; p <<= 1) {
      for (r=0, i=N-p; i<N; ++i) sa2[r++] = i;
      for (i=0; i<N; ++i) if (sa[i] >= p) sa2[r++] = sa[i] - p;
      Arrays.fill(c, 0, ALPHABET_SZ, 0);
      for (i=0; i<N; ++i) c[rank[i]]++;
      for (i=1; i<ALPHABET_SZ; ++i) c[i] += c[i-1];
      for (i=N-1; i>=0; --i) sa[--c[rank[sa2[i]]]] = sa2[i];
      for (sa2[sa[0]] = r = 0, i=1; i<N; ++i) {
          if (!(rank[sa[i-1]] == rank[sa[i]] &&
              sa[i-1]+p < N && sa[i]+p < N &&
              rank[sa[i-1]+p] == rank[sa[i]+p])) r++;
          sa2[sa[i]] = r;
      } tmp = rank; rank = sa2; sa2 = tmp;
      if (r == N-1) break; ALPHABET_SZ = r + 1;
    }
  }

  // Use Kasai algorithm to build LCP array
  private void kasai() {
    lcp = new int[N];
    int [] inv = new int[N];
    for (int i = 0; i < N; i++) inv[sa[i]] = i;
    for (int i = 0, len = 0; i < N; i++) {
      if (inv[i] > 0) {
        int k = sa[inv[i]-1];
        while( (i + len < N) && (k + len < N) && T[i+len] == T[k+len] ) len++;
        lcp[inv[i]-1] = len;
        if (len > 0) len--;
      }
    }
  }

  // Finds the LRS(s) (Longest Repeated Substring) that occurs in a string.
  // Traditionally we are only interested in substrings that appear at
  // least twice, so this method returns an empty set if this is not the case.
  // @return an ordered set of longest repeated substrings
  public TreeSet <String> lrs() {

    int max_len = 0;
    TreeSet <String> lrss = new TreeSet<>();

    for (int i = 0; i < N; i++) {
      if (lcp[i] > 0 && lcp[i] >= max_len) {

        // We found a longer LRS
        if ( lcp[i] > max_len )
          lrss.clear();

        // Append substring to the list and update max
        max_len = lcp[i];
        lrss.add( new String(T, sa[i], max_len) );

      }
    }

    return lrss;

  }

  public void display() {
    System.out.printf("-----i-----SA-----LCP---Suffix\n");
    for(int i = 0; i < N; i++) {
      int suffixLen = N - sa[i];
      String suffix = new String(T, sa[i], suffixLen);
      System.out.printf("% 7d % 7d % 7d %s\n", i, sa[i],lcp[i], suffix );
    }
  }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-01T22:57:44.267

```
public class LongestSubString {

    public static void main(String[] args) {
        String s = findMaxRepeatedString("ssssssssssss this is a ddddddd word with iiiiiiiiiis and loads of these are ppppppppppppps");
        System.out.println(s);
    }

    private static String findMaxRepeatedString(String s) {
        Processor p = new Processor();
        char[] c = s.toCharArray();
        for (char ch : c) {
            p.process(ch);
        } 
        System.out.println(p.bigger());
        return new String(new char[p.bigger().count]).replace('\0', p.bigger().letter);
    }

    static class  CharSet {
        int count;
        Character letter;
        boolean isLastPush;

        boolean assign(char c) {
            if (letter == null) {
                count++;
                letter = c;
                isLastPush = true;
                return true;
            }
            return false;
        }

        void reassign(char c) {
            count = 1;
            letter = c;
            isLastPush = true;
        }

        boolean push(char c) {
            if (isLastPush && letter == c) {
                count++;
                return true;
            }
            return false;
        }

        @Override
        public String toString() {
            return "CharSet [count=" + count + ", letter=" + letter + "]";
        }

    }

    static class  Processor {

        Character previousLetter = null;
        CharSet set1 = new CharSet();
        CharSet set2 = new CharSet();

        void process(char c) {
            if ((set1.assign(c)) || set1.push(c)) {
                set2.isLastPush = false;
            } else if ((set2.assign(c)) || set2.push(c)) {
                set1.isLastPush = false;                
            } else {
                set1.isLastPush = set2.isLastPush = false;
                smaller().reassign(c);
            }
        }       

        CharSet smaller() {
            return set1.count < set2.count ? set1 : set2;
        }

        CharSet bigger() {
            return set1.count < set2.count ? set2 : set1;
        }

    }   
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-15T02:00:26.607

我有一个面试，我需要解决这个问题。这是我的解决方案：

```
public class FindLargestSubstring {

public static void main(String[] args) {
    String test = "ATCGATCGA";
    System.out.println(hasRepeatedSubString(test));
}

private static String hasRepeatedSubString(String string) {
    Hashtable<String, Integer> hashtable = new Hashtable<>();
    int length = string.length();
    for (int subLength = length - 1; subLength > 1; subLength--) {
        for (int i = 0; i <= length - subLength; i++) {
            String sub = string.substring(i, subLength + i);
            if (hashtable.containsKey(sub)) {
                return sub;
            } else {
                hashtable.put(sub, subLength);
            }
        }
    }
    return "No repeated substring!";
}} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-04-27T17:25:08.587

**影响性能**的事情太多了，我们无法仅用您给我们的内容来回答这个问题。（操作系统、语言、内存问题、*代码本身*）

如果您只是在寻找算法效率的数学分析，您可能想要更改问题。

*编辑*

当我提到“内存问题”和“代码”时，我没有提供所有细节。您将要分析的字符串的长度是一个重要因素。此外，代码不能单独运行——它必须位于程序内部才能发挥作用。该程序的哪些特征会影响该算法的使用和性能？

基本上，在您有实际情况要测试之前，您无法进行性能调整。您可以对什么可能表现最好做出非常有根据的猜测，但是在您拥有真实数据和真实代码之前，您永远无法确定。

# python - PyQt - 关于 QSlider 和 QGraphicsTextItem 的问题

> ID：10355108
> 
> 赞同：0
> 
> 时间：2012-04-27T17:21:20.887
> 
> 标签：python, qt, pyqt

我完全陷入了两个问题：

1）我正在使用 QSlider 设置一些值（它们是浮点数~0.5，所以我使用 *1000）。SingleStep 和 PageStep 适用于键盘输入和鼠标滚轮，刻度都已设置...但是当我使用鼠标拖动滑块时 - 它会忽略所有这些刻度、步骤等，我希望它只从一滴一滴。

```
self.ui.x_coord.setMaximum(l_d*1000)
self.ui.x_coord.setSingleStep(l_d/N*1000)
self.ui.x_coord.setTickInterval(l_d/N*1000)
self.ui.x_coord.setTickPosition(QtGui.QSlider.TicksBothSides)
self.ui.x_coord.setPageStep(l_d/N * 10000) 
```

我的代码中是否缺少某些东西（可能像 setMouseStep 之类的东西）？

2) QSlider 连接到一个函数

```
self.graph = BPlot(self.ui)
self.ui.x_coord.valueChanged.connect(self.setCoordLabelValue)

....

def setCoordLabelValue(self):
    x = self.ui.x_coord.value()/1000
    y = self.ui.y_coord.value()/1000
    self.graph.setCoordText(x,y)

....

class BPlot(QtGui.QGraphicsView):
    def __init__(self, ui, parent=None):
        super(BPlot, self).__init__(parent)
        self.scene = QtGui.QGraphicsScene()
        self.ui = ui

        self.coordText = QtGui.QGraphicsTextItem(None, self.scene)
        self.coordText.setPlainText("123")

        self.x_offset = 40
        self.y_offset = 20

        self.currentPoint = QtGui.QGraphicsRectItem(None, self.scene)
        self.cph = 4
            self.cpw = 4

    def resizeEvent(self, event):
        size = event.size()

    def showEvent(self, event):
        aw = self.viewport().width()
        ah = self.viewport().height()
        self.scene.setSceneRect(0,0,aw,ah)
        self.setScene(self.scene)

        self.axis_pen = QtGui.QPen(QtCore.Qt.DashDotLine)
        self.scene.addLine(0, 3/4*ah, aw, 3/4*ah, self.axis_pen)

        self.normal_pen = QtGui.QPen(QtCore.Qt.SolidLine)
        self.scene.addLine(self.x_offset, 3/4*ah - self.y_offset, aw - self.x_offset, 3/4*ah - self.y_offset)
        self.currentPoint.setRect(self.x_offset - self.cpw/2, 3/4*ah - self.y_offset - self.cph/2, self.cpw, self.cph) 

    def setCoordText(self, x, y):
        self.coordText.setPlainText(str(x) + ":" + str(y)) 
```

问题是 setCoordText 函数不会重绘 coordText。如果我使用 print(coordText.toPlainText()) - 我会得到正确的输出，但在屏幕上仍然会有来自 __init__ 的“123”

我已经尝试将 self.scene.update() 添加到 setCoordText 的末尾，但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T06:47:43.697

呃……解决了。逻辑，你在哪里，我亲爱的朋友？？？

```
def setCoordLabelValue(self):
    x = self.ui.x_coord.value()/1000
    y = self.ui.y_coord.value()/1000
    self.graph.setCoordText(x,y)
    self.graph.invalidateScene()

.......

def paintEvent(self, event):
        painter = QtGui.QPainter(self.viewport())

        # set color and width of line drawing pen
        painter.setPen(QtGui.QPen(QtCore.Qt.black, 2))

        # drawLine(x1, y1, x2, y2) from point (x1,y1) to (x2,y2)
        # draw the baseline
        painter.drawText(10,20,str(x_coord))
        # set up color and width of the bars
        width = 20
        painter.setPen(QtGui.QPen(QtCore.Qt.red, width))
        delta = width + 5
        x = 30
        painter.end()

        self.viewport().update() 
```

# javascript - jquery ui 自动完成：导航 json 对象

> ID：10355109
> 
> 赞同：1
> 
> 时间：2012-04-27T17:21:27.307
> 
> 标签：javascript, jquery, jquery-ui, jquery-autocomplete

[Paz](https://stackoverflow.com/a/3222639/156561)的出色回答让我在本周通过自动完成 jQuery UI 交易度过了一个艰难的补丁。

综上所述，如果您的 json 响应中有两个不同的“基础”对象，如何选择正确的 json 响应。

简单地说，我有一个由两个模型组成的 ruby​​ 实例变量，Pitch 和 User。我想根据这个实例变量自动完成。json响应是，比如说

```
[{"user":{"id":1,"name":"Blah Hugo"}},
{"user":{"id":3,"name":"Blaz Foobar"}},
{"pitch":{"id":2,"name":"Blasters On Business Apparel"}}] 
```

自动完成 javascript 文件现在看起来像这样，它可以工作 < 仅片段 >：

```
.data( "autocomplete" )._renderItem = function( ul, item ) {
  return jQuery( "<li></li>" )
  .data( "item.autocomplete", item )
  .append( "<a>" + (item.user ? item.user.name : item.pitch.name) + "</a>" )
  .appendTo( ul );
}; 
```

我的问题再次是我不得不使用的这个三元组。 `item[0].name`不起作用，`item.item[0].name` 如果您不知道两者的名称，是否没有办法获得通用的“用户”或“音高”？

虽然其中一个会。你说什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T19:10:54.267

我认为您所拥有的并没有太大的问题，但可能会有轻微的改进：

```
.data("autocomplete")._renderItem = function(ul, item) {
    item = item.user || item.pitch;

    return jQuery("<li></li>")
        .data("item.autocomplete", item)
        .append("<a>" + item.name + "</a>")
        .appendTo(ul);
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:06:18.713

您可以尝试使用`||`(logical OR) 来简化您在`.append()`方法中使用的三元运算符。

这是否符合您的要求？

```
.data( "autocomplete" )._renderItem = function( ul, item ) {
    item = item.user || item.pitch || {name:""};
    .append( "<a>" + item.name + "</a>" )
    return jQuery( "<li></li>" )
    .data( "item.autocomplete", item )
    .append( "<a>" + item.name  + "</a>" )
    .appendTo( ul );
}; 
```

这将返回参数列表中的第一个“非假”值；在这种情况下`item.user.name`和`item.pitch.name`。在这种情况下，如果您的 JSON 对象具有`user`属性，`name`则将返回该值。如果 JSON 对象有`pitch`属性，则`name`返回该值。如果这两个操作都返回`undefined`，则将返回一个空白字符串并将其附加到`a`标签中。

此[答案](https://stackoverflow.com/a/476445/1011616)提供了有关使用和特殊情况的更多信息，以便在使用“或”方法时牢记在心。

**更新**：修复`null`了异常的可能性。

# visual-studio-2010 - VC++ 中是否有任何内置函数对数字进行排序？

> ID：10355110
> 
> 赞同：0
> 
> 时间：2012-04-27T17:21:41.200
> 
> 标签：visual-studio-2010, c++-cli

我有两列数据。例如，

[78, c]

[28, 一个]

[34，克]

我想看看是否有任何内置函数可以对数字进行排序并告诉我订单信息。例如，（从小到大）该函数将返回 [2, 3, 1] 因为第 2 行具有最小的第 1 列元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:54:41.873

你的数据结构是什么？

如果您使用 C++/CLI，那么您可以使用整个 .NET 框架。

也就是说，我不相信有任何内置的东西会告诉你顺序。我相信一切都会真正做到这一点。

如果您真的需要订单，而不是排序列表，我相信这会做到。这会创建新的对象来记住它们的原始列表位置，对它们进行排序，然后读回原始索引是什么。

```
// I'm assuming you have a class similar to this already.
ref class MyData
{
public:
    int number;
    String^ letter;
};

ref class SortHelper : IComparable<SortHelper^>
{
public:
    MyData^ data;
    int originalIndex;

    SortHelper(MyData^ data, int index)
    {
        this->data = data;
        this->originalIndex = index;
    }

    virtual CompareTo(SortHelper^ other)
    {
        return this->data->number.CompareTo(other->data->number);
    }
};

void List<int> GetSortedIndexes(List<MyData>^ input)
{
    List<SortHelper>^ working = gcnew List<SortHelper>();
    for(int i = 0; i < input->Count; i++)
    {
        working->Add(gcnew SortHelper(input[i], i));
    }

    working->Sort();

    List<int>^ result = gcnew List<int>();        
    for each(SortHelper^ helper in working)
    {
        result->Add(helper->originalIndex);
    }

    return result;
} 
```

# lisp - 为什么 Lisp 如此频繁地与“符号计算”相关联

> ID：10355112
> 
> 赞同：4
> 
> 时间：2012-04-27T17:21:42.167
> 
> 标签：lisp

我们知道数学既有*符号*计算也有*数值*计算。但是为什么**Lisp**作为一种通用的编程语言，与*符号*计算的联系更紧密呢？

**Lisp**的哪些部分使它适用于*符号*问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-27T17:44:05.783

当时，符号是 Lisp 中的第一类对象，而在其他语言中则更少。大多数其他语言都专注于数值计算 (1 + 2 + SIN(PI / 2))。

在 Lisp 中，符号是一种特定的语言工件（不同于字符串），它使处理非数字的事物变得非常容易。由于这些是系统中的第一类对象，Lisp 提供了这些对象的“免费”解析器、读取器和写入器。

'(A + B / 2) 在现成的 Lisp 中表示是微不足道的。

表示的易用性减轻了阅读和编写符号计算应用程序的这些方面的负担，使得更容易专注于核心问题（方程约简、问题求解器、定理证明等）

即使在今天，仍然很少有语言具有符号的一流概念。但是有足够多的实用程序，因此它们在今天的重要性不及在这种工作中基本的 Lisp、Fortan 和 Pascal 的时代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-12T20:08:38.083

在 LISP 中，您可以在没有预先声明的情况下输入符号。此外，复杂的数据结构被支持为任意复杂度的链表。由于符号操作最好在复杂数据结构的上下文中完成，因此 LISP 非常适合。此外，当使用复杂的数据结构来建模问题时，其他语言需要您花费大量精力来遍历数据结构。在 lisp 中，数据结构遍历是自动化的，您可以在更高的抽象级别上工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-30T14:04:36.180

经常与 Lisp 相关联的符号计算一词令千禧一代感到困惑，他们在计算机被用于人类和社会生活的所有领域的时代长大。早在 Lisp 出现的那一天，计算机很昂贵，它们的使用主要用于科学/会计环境。数字运算。将已知的数学算法转化为程序。现有语言难以优雅地解决问题的一个领域是具有多项式表达式的代数公式。Lisp 提供了一流的结构，使计算机代数系统的设计能够与传统的数学推理无缝映射，因此有了这个术语。符号计算在今天仍然很重要，特别是在逻辑编程、约束求解、人工智能等领域。

# java - JDialog 输入建议

> ID：10355115
> 
> 赞同：3
> 
> 时间：2012-04-27T17:21:59.567
> 
> 标签：java, input, jdialog

我需要一些关于 JDialog 的建议。

我需要捕获“输入”数据，我想知道，最好的方法是什么。好的，这是完整的问题。当用户单击按钮（位于 JFrame 上）时，会弹出 JDialog，并且有 3 个文本字段用于条目和一个组合框。用户按下确定后，我需要在 JFrame 中返回这些数据。好吧，我可以在路上做到这一点，但是意大利面条代码太多了 :)) 我应该使用哪个监听器？如果您愿意给我代码示例，我将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:27:56.637

嗯，有很多方法可以解决它，也许您可​​以尝试使用如下接口的委托方法：

```
public interface DialogListener {
    public boolean okClicked(String input1, String input2, String input3, String combo);
    public void cancelClicked();
} 
```

（布尔值是您决定是否关闭对话框）。

如果您使用 MVC 方法并将该组件添加为自定义对话框的侦听器，请在您的框架或框架控制器中实现它。

另一种方法是在对话框上设置属性，然后您的框架或控制器可以在对话框中查询输入值。

这取决于您希望事物的通用性。

你也可以有这样的东西，它更通用、可重用但不太方便：

```
public interface DialogListener {
    public boolean okClicked(JDialog dialog, Map<String, JComponent> components);
    public void cancelClicked();
} 
```

# apache - 只需更改 apache Mahout 分类器输入中的 csv 标头会产生不同的模型吗？

> ID：10355118
> 
> 赞同：3
> 
> 时间：2012-04-27T17:22:34.107
> 
> 标签：apache, machine-learning, classification, mahout

我正在尝试通过 Mahout 分类器示例（donut.csv）。但我发现，简单地更改标题行中某些列的名称，并在分类器命令中更改相应的预测变量名称，会导致不同的模型。这根本不符合逻辑。

首先，您通过以下方式获得 donut.csv

```
mahout cat donut.csv |tail -40 > donut0.csv 
```

（“尾巴”是因为 mahout cat 产生了一些初始信息行）

然后我们使用以下命令来训练 donut0.csv ：（正如“Mahout in action”一书中所建议的那样）

```
mahout trainlogistic --input donut0.csv \
--output ./model \
--target color --categories 2 \
--predictors x y a b c  --types numeric \
--features 20 --passes 100 --rate 50 
```

它给出了以下输出

```
color ~ 7.068*Intercept Term + 0.581*a + -1.369*b + -25.059*c + 0.581*x + 2.319*y
      Intercept Term 7.06759
                   a 0.58123
                   b -1.36893
                   c -25.05945
                   x 0.58123
                   y 2.31879
    0.000000000     0.000000000     0.000000000     0.000000000     0.000000000    -1.368933989     0.000000000     0.000000000     0.000000000     0.000000000     0.581234210     0.000000000     0.000000000     7.067587159     0.000000000     0.000000000     0.000000000     2.318786209     0.000000000   -25.059452292 
12/04/27 09:29:21 INFO driver.MahoutDriver: Program took 789 ms (Minutes: 0.01315) 
```

但如果只是将标题中的“x”列更改为“xa”，并在命令中更改相应的预测器名称，则输出模型会完全改变。

```
$ head -3 donut4.csv 
xa,y,shape,color,k,k0,xx,xy,yy,a,b,c,bias
0.923307513352484,0.0135197141207755,21,20,4,8,0.852496764213146,0.0124828536260896,0.000182782669907495,0.923406490600458,0.0778750292332978,0.644866125183976,1
0.711011884035543,0.909141522599384,22,20,3,9,0.505537899239772,0.64641042683833,0.826538308114327,1.15415605849213,0.953966686673604,0.46035073663368,1

mahout trainlogistic --input donut4.csv \
--output ./model \
--target color --categories 2 \
--predictors xa y a b c  --types numeric \
--features 20 --passes 100 --rate 50

color ~ 6.380*Intercept Term + -1.913*a + -0.577*b + -23.236*c + 2.647*xa + 3.009*y
      Intercept Term 6.38017
                   a -1.91308
                   b -0.57676
                   c -23.23552
                  xa 2.64657
                   y 3.00925
    0.000000000     0.000000000     0.000000000     0.000000000     0.000000000    -0.576759549     0.000000000     0.000000000     2.646572912     0.000000000    -1.913075634     0.000000000     0.000000000     6.380173126     0.000000000     0.000000000     0.000000000     3.009245162     0.000000000   -23.235521029 
12/04/27 10:21:10 INFO driver.MahoutDriver: Program took 728 ms (Minutes: 0.012133333333333333) 
```

我还没有验证新模型，也许它也适合数据，但简单地更改名称应该不会影响算法的工作方式。正确的？？

谢谢杨

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T23:10:28.350

我怀疑这是标题的变化。我更容易期望这是因为算法中选择了不同的随机值值。尝试两次没有变化的运行，看看是否有任何变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T23:41:11.237

它与特征散列有关。特征名称用于确定权重在特征向量中的位置。

在 20 个新闻组示例中，特征向量是在`org.apache.mahout.classifier.sgd.TrainNewsGroups`类中完成的。通话

```
Vector v = helper.encodeFeatureVector(file, actual, leakType, overallCounts); 
```

是实际创建特征向量的原因。

它使用“特征散列”，这样可以将多个特征“散列”到向量中的同一索引中。实际的特征散列发生在`NewsgroupHelper`使用以下编码器的类中：

```
 private final FeatureVectorEncoder encoder = new StaticWordValueEncoder("body"); 
```

您传入 20 个特性（使用 --features 20）命令行参数，但只使用 5 个特性（--predictors xa yabc）。

回顾 NewsgroupHelper 代码，`encoder.addToVector(word, Math.log1p(words.count(word)), v);`调用，它将单词添加到编码器。显然发生的是，对于“x”特征，哈希索引没有与其他 5 个特征发生冲突。但是，当您使用“xa”特征时，它的哈希值会与另一个名称发生冲突，并将它们的权重添加到特征向量中。

如果看`org.apache.mahout.vectorizer.encoders.StaticWordValueEncoder`encoding方法，它使用`int n = hashForProbe(originalForm, data.size(), name, i);`方法来计算特征索引：originalForm是特征的名称，data.size()是特征的个数，name是编码器的常量名，i是“探针编号”已更改。

TL;DR 'x' 和 'xa' 名称在特征散列中发生冲突，并且您没有循环足够的探针来找到一组没有冲突的编码向量。

# matlab - 在 MATLAB 中寻找邻域

> ID：10355122
> 
> 赞同：0
> 
> 时间：2012-04-27T17:22:49.817
> 
> 标签：matlab

我需要知道如何在 x0 附近找到坐标为 (x,y) 且 r < r0 的节点，其中 r 是 sqrt(x^2+y^2)。事实上，我写了它，但由于我的节点数是 10000，需要一段时间才能得到答案。我正在为它寻找一个 MATLAB 命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T09:11:51.283

我会尝试为节点组件构建 Delaunay 三角剖分。然后更容易（也更有效）找到邻居。

请看一下“DelaunayTri”课程 [http://www.mathworks.ch/help/techdoc/ref/delaunaytriclass.html](http://www.mathworks.ch/help/techdoc/ref/delaunaytriclass.html)

和“DelaunayTri”本身，看看它是否适合您的需求。 [http://www.mathworks.ch/help/techdoc/ref/delaunaytri.html](http://www.mathworks.ch/help/techdoc/ref/delaunaytri.html)

# javascript - 使用正则表达式在 url 中间找到第一次出现的字符 ~

> ID：10355126
> 
> 赞同：0
> 
> 时间：2012-04-27T17:23:14.693
> 
> 标签：javascript, regex

我需要使用正则表达式检索 url 的某些部分。网址如下所示：

```
/xxxx/bbbb/good/city/games_in_the_city.~cccccc~dddddd~eeeee.html 
```

我需要检索 games_in_the_city。我得到了第一部分，直到 / 被删除。现在需要找到字符串中第一次出现的~，以便将其余部分也删除。我现在拥有的正则表达式`(.*\/good\/city\/)(.*)(\.html)`得到 `games_in_the_city.~cccccc~dddddd~eeeee`

如何修改我的正则表达式，以便`~cccccc~dddddd~eeeee`也可以删除。最终输出应该是我不知道url 中可以出现`games_in_the_city` 多少个（波浪号）。`~`有时它可能是一到n。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:27:56.443

假设您只想要`aaaa`字符串，可以执行以下操作：

```
/.*\/([^~]*)/ 
```

基本上，说'从最后一个开始`/`，匹配所有不是`~`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:28:36.460

试试`([^~]*)~`- 那里的组将有所有的 as 和下划线。

根据您的语言/工具，可能会有更好的支持，例如在 perl 中，我将使用`s/~.*//;`从波浪号删除到末尾，而不必捕获以前的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T17:31:56.093

将每个捕获放在一个组中怎么样。这将为您提供 URL 的每个单独部分：

```
^/([\w]+)/([\w]+)/([\w]+)/([\w]+)\.~([\w]+)~([\w]+)~([\w]+)\.html$ 
```

# wpf - SQLITE 日志模式 = OFF，在 WPF 中使用流利的 nhibernate

> ID：10355128
> 
> 赞同：0
> 
> 时间：2012-04-27T17:23:30.253
> 
> 标签：wpf, sqlite, fluent-nhibernate

我正在使用 SQlite 和 Fluent Nhibernate 在 WPF 中开发一个巨大的应用程序。会话.保存（我的对象）；仅 100 kb 的数据需要 10 分钟。我想禁用日记模式并将其关闭或持久化，以便在我的应用程序中获得更多时间

# javascript - 创建一个函数 javascript/jquery 来检测画布上的点击

> ID：10355129
> 
> 赞同：0
> 
> 时间：2012-04-27T17:23:30.323
> 
> 标签：javascript, jquery

我需要创建一个功能，如果我单击网站上的特定图像，它将播放仅与该图片关联的特定音频文件。我有一些代码，但我似乎无法让功能部分正确。我希望每次您单击图像时，它都会播放特定的音频，当您再次单击它时，它会暂停。我的网站上有很多图片。太感谢了！

编辑：由于我是新成员，该网站不允许我发布代码的屏幕截图，

[小提琴。网络链接][2]

[2]：http://jsfiddle.net/c8KTg/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:46:16.797

你应该修改你的音频标记：

```
<audio controls="controls" id="clips">
   <source src="1.mp3" />
   <source src="2.mp3" />    
</audio> 
```

那么这样的事情可能会做到这一点：

```
$('.images').each(function(index, element) {
    $(this).click(function(e) {
        var id = this.attr('id');
        var sound_id = id.split('image')[1];
        var music = $('#clips').get(sound_id);
        music.play();
    });
}); 
```

# ruby-on-rails - 即使我使用 attr_accessible 也无法批量分配受保护的属性

> ID：10355130
> 
> 赞同：0
> 
> 时间：2012-04-27T17:23:37.390
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, mass-assignment, attr-accessible

我正在开发具有 JSON API 的 Rails 3.2.2 应用程序，并且我使用 CLI 客户端插入一些数据。除了作者模型外，它工作正常。当我尝试创建一个新帖子时（帖子 belongs_to :author 和 Author has_many :posts）我收到以下错误：

```
<h1>
  ActiveModel::MassAssignmentSecurity::Error in PostsController#create
</h1>
<pre>Can't mass-assign protected attributes: name</pre> 
```

我对该主题进行了大量研究，但没有找到可行的解决方案:-(

我使用 attr_accessible 来避免 MassAssignent 错误，它适用于所有其他模型，但不适用于“作者”名称属性。

这是作者模型：

```
class Author < ActiveRecord::Base
  attr_accessible :name, :email

  extend FriendlyId
  friendly_id :name, use: :slugged

  # some validations

  has_many :posts
  #authlogic
  acts_as_authentic

  # some stuffs
end 
```

实际上，我禁用了 whitelist_attributes 并且它解决了我的问题，但我认为这不是执行此操作的便捷方式（而且可能不是一个好主意）。

我的问题是： 为什么 attr_accessible 在这里不起作用？以及如何在不禁用白名单的情况下解决问题？

谢谢，

瑞文

**编辑 ：**

创建新帖子的方法：

```
def create
  @post = Post.new(params[:post])
  @post.author = current_author
  # respond to etc.
end 
```

current_author 使用给定的 API 密钥查找作者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T14:52:51.433

我找到了解决方案！:-)

问题是我使用了acts_as_taggable_on_steroids插件，它在Rails 3.2上不起作用......

由于“作者”是唯一具有 :name 属性的模型，我认为问题来自作者……但问题出在标签模型中（在acts_as_taggable_on_steroid 插件中）。事实上，它的 :name 属性不是“可访问的”。

所以，我使用在 Rails 3.x 上正确工作的acts_as_taggable_on gem ( [https://github.com/mbleigh/acts-as-taggable-on )](https://github.com/mbleigh/acts-as-taggable-on)

# jsf - 如何提供没有EL表达式的bean方法

> ID：10355131
> 
> 赞同：0
> 
> 时间：2012-04-27T17:23:46.837
> 
> 标签：jsf, el

正如我在网站上被告知和发现的那样，只有在我的`.xhtml`.

是否可以在没有任何 EL 表达式的情况下调用我的 bean？

我需要这个，因为我`HomeController`正在调用一个方法来检查会话状态和我的`home.xhtml`，并且现在不需要这个 bean。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:32:13.410

您需要从不同的方向寻找解决方案。

如果您正在开发用户身份验证而不是使用容器管理的身份验证，那么您通常使用[servlet 过滤器](https://stackoverflow.com/tags/servlet-filters/info)来检查用户是否登录。

servlet 过滤器可以像 servlet (like `FacesServlet`) 一样映射到特定的 URL 模式。然后它将在与该 URL 模式匹配的每个请求上调用。您可以浏览过滤器中的请求/会话数据，然后通过继续过滤器链或发送重定向来相应地处理请求/响应。

您需要[`javax.servlet.Filter`](http://docs.oracle.com/javaee/6/api/javax/servlet/Filter.html)相应地实现接口。`doFilter()`这是假设您有一个`@SessionScoped`托管 bean 应该如何实现该方法的启动示例`LoginController`。JSF 将会话范围的托管 bean 存储为`HttpSession`.

```
@Override
public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException, ServletException {
    HttpServletRequest request = (HttpServletRequest) req;
    HttpServletResponse response = (HttpServletResponse) res;
    HttpSession session = request.getSession(false);
    LoginController loginController = (LoginController) (session != null) ? session.getAttribute("loginController") : null;

    if (loginController == null || !loginController.isLoggedIn()) {
        response.sendRedirect(request.getContextPath() + "/login.xhtml"); // No logged-in user found, so redirect to login page.
    } else {
        chain.doFilter(req, res); // Logged-in user found, so just continue request.
    }
} 
```

将此过滤器映射到覆盖受限页面的 URL 模式，例如`/app/*`.

```
@WebFilter("/app/*")
public class LoginFilter implements Filter {
    // ...
} 
```

* * *

**如果`login.xhtml`也被此 URL 模式覆盖并且您确实无法更改它，则更新它，然后按如下方式更改**块**`if`：**

 **```
if (!request.getRequestURI().endsWith("/login.xhtml") && (loginController == null || !loginController.isLoggedIn())) {
    // ...
} 
```**

# wix - 使用 Wix 为 GAC 程序集配置文件

> ID：10355137
> 
> 赞同：1
> 
> 时间：2012-04-27T17:24:03.693
> 
> 标签：wix, configuration-files, gac

我知道这在过去被问过几次。我已经阅读了所有的回复和答案，但似乎都不合适。

我尝试将 .config 放在同一个组件和不同的组件中。我在同一个组件和不同的组件中尝试过 CompanionFile。我试过 CopyFile。我尝试了自定义操作。

该组件需要在 GAC 中，因为它是许多不同子系统（服务、网站等）使用的通用日志记录 dll。但它对所有系统的配置都是相同的。

所以现在我将文件安装到 SDK 目录并告诉用户复制文件。

唯一可行的方法是手动复制文件并对“您需要管理员权限才能执行此操作”说“是”。

```
<File Id="SDK.Logging.dll.config"
      Source="$(var.LOGGER_DIR)\SDK.Logging.dll.config"
      Vital="yes">
</File>

<Property Id="XCOPY">xcopy.exe</Property>
<CustomAction Id="Copy.SDK.Logging.dll.config"
              Property="XCOPY"
              ExeCommand='"[INSTALLLOCATION]SDK.Logging.dll.config" "[GAC.SDK.Logging.Dir]"' /> 
```

# jquery - jQuery - “|” 专注于文本框时光标未对齐

> ID：10355141
> 
> 赞同：3
> 
> 时间：2012-04-27T17:24:22.647
> 
> 标签：jquery

我的 html 正文中有一个文本框：`input type="text" id="text-input"`

当用户按下回车键时，我正在使用它来聚焦：

```
<script>
    $(document).keypress(function(e) {
        if(e.keyCode == 13) {
            $("#text-input").focus();
        }
    });
</script> 
```

我用来试用的网页中只有文本框。当我单击空白区域并按回车键时，“|” 提示将向下错位。如果我重复此单击并按 Enter，则应该在文本框中的“|”会越来越向下移动。

什么地方出了错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:32:36.347

尝试使用`keyup`而不是`keypress`

```
$(document).keyup(function(e) {
    if(e.keyCode == 13) {
        $("#text-input").focus();
    }
});​ 
```

**示例：** [**keypress**](http://jsfiddle.net/qWQkH/1/)和[**keyup**](http://jsfiddle.net/qWQkH/)

在 chrome 中测试，结果不同。

**注意：** keypress=（keydown 和 keyup **2 个**事件）。可能是这个问题，但不确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:33:55.753

***[我发现返回 false 可以纠正这种行为：](http://jsfiddle.net/RUb2P/2/)***

```
$(document).keypress(function(e) 
{
    if(e.keyCode === 13) 
    {
        $("#text-input").focus();

        return false;
    }
});​ 
```

* * *

为了改进这一点，您实际上可以使用 and 而不是的组合`e.preventDefault();`来`e.stopImmediatePropagation();`确保`return false;`一旦这个处理程序被命中，除了您想要的之外什么都不会发生`.focus()`：

```
$(document).keypress(function(e) 
{
    if (e.keyCode === 13) 
    {
        $("#text-input").focus();

        e.preventDefault();
        e.stopImmediatePropagation();
    }
}); 
```

唯一需要注意的是，它`e.stopImmediatePropagation();`仅适用于代码中此处理程序*之后*定义的事件处理程序。这意味着，如果您在 之前有另一个处理程序绑定到文档的按键`.focus()`，它将继续被击中。因此，要确保仅调用 this ，您需要确保它是代码中定义的第一个处理程序。

***[在此处查看示例](http://jsfiddle.net/RUb2P/3/)***

# android - Listview中的自定义适配器，获取对象变量

> ID：10355144
> 
> 赞同：0
> 
> 时间：2012-04-27T17:24:34.920
> 
> 标签：android

我有一个带有自定义适配器的列表视图，该适配器包含两个`TextViews`和一个`ImageButton`。该列表包含我班级的对象`Firm`。当用户按下`ImageButton`我想从`Firm`对象中获取一些信息时，使用`get()-method`.

**下面的一些代码片段**

**我的自定义适配器**

```
import java.util.Vector;
import android.app.Activity;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;
import android.widget.Toast;

public class CustomAdapter extends ArrayAdapter<Firm>
{
 Context context;
 int layoutResourceId;   
 static String datesort; 
 ImageButton call;
 Firm mrb;

 Firm currentMRB;
 Vector<Firm> data;
/** Called when the activity is first created. */
// TODO Auto-generated constructor stub
public CustomAdapter(Context context, int layoutResourceId, Vector<Firm> data) 
{
    super(context,layoutResourceId,data);
    this.layoutResourceId = layoutResourceId;
    this.context=context;
    this.data = data;
}
@Override
public View getView(int position, View convertView, ViewGroup parent)
{
    View row = convertView;
    MyStringReaderHolder holder;

    if(row==null)
    {
        LayoutInflater inflater = ((Activity)context).getLayoutInflater();
        row = inflater.inflate(layoutResourceId, parent,false);

        holder= new MyStringReaderHolder();

        holder.gtumcaTvFirstName =(TextView)row.findViewById(R.id.gtumcaTvFirstName);
        holder.gtumcaTvLastName =(TextView)row.findViewById(R.id.gtumcaTvLastName);
        call = (ImageButton)row.findViewById(R.id.imageButton1);

        row.setTag(holder);
    }
    else
    {
        holder=(MyStringReaderHolder) row.getTag();
    }

    mrb =data.elementAt(position);
    System.out.println("Position="+position);

    holder.gtumcaTvFirstName.setText(mrb.getCompanyName());
    int price = (int)mrb.getPrice();
    String priceString = Integer.toString(price);
    holder.gtumcaTvLastName.setText(priceString);

    call.setOnClickListener(new OnClickListener() {

        public void onClick(View arg0) {

            Toast.makeText(context, mrb.getNumber(), Toast.LENGTH_LONG).show(); 

        }
    });

    return row;

} 
```

看一下`getView()`函数，它包含一个`OnClickListener()`我想在用户按下 中的一项时运行的方法，该函数应该使用对象的方法`ListView`引发 a`Toast``get()`

但它不起作用。有人知道我如何完成这项任务吗？提前致谢。

**更新**

我发现出了什么问题，我忘记了 Button 是 a`ImageButton`而不是常规的`Button`. 但是我怎样才能得到对象编号呢？我的 Toast 只是根据所有对象从 getNumber() 方法生成随机数，更具体地，我想要对象的编号，例如我列表中的位置 3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:43:37.617

```
call = (ImageButton)row.findViewById(R.id.imageButton1);
call.setFocusable(false);   <----- add this line
row.setTag(holder); 
```

获取数字使用**位置**变量

```
Toast.makeText(context, ""+position, Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:48:53.860

如果您想要在 ListView 中单击的项目，请使用此侦听器：

```
listView.setOnItemClickListener(new OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
       // The position is passed here, do as you please
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:00:33.933

我通过这样做解决了我的问题：

```
 static class MyStringReaderHolder
 {
    TextView gtumcaTvFirstName,gtumcaTvLastName,gtumcaTvBirthDate;
    ImageView gtumcaIvIcon;
    ImageButton call;
 } 
```

并创建一个静态类的新实例

```
 holder= new MyStringReaderHolder();
        holder.call = (ImageButton)row.findViewById(R.id.imageButton1);
        holder.call.setFocusable(false); 
```

最后我添加了`OnClickListener`一个`ImageButton`

```
holder.call.setOnClickListener(new OnClickListener() {

        public void onClick(View arg0) {

        Toast.makeText(context,  "" +  data.elementAt(position).getCompanyName(), Toast.LENGTH_SHORT).show(); 

        }
    }); 
```

多谢你们！:)

# python - 没有金字塔的变色龙宏

> ID：10355146
> 
> 赞同：1
> 
> 时间：2012-04-27T17:24:44.160
> 
> 标签：python, pyramid, chameleon

这是我在 Pyramid 中使用的一些代码，用于将宏加载到我的 Chameleon 模板中：

```
@subscriber(BeforeRender)
def add_base_templates(event):
    """Define the base templates."""
    main_template = get_renderer('../templates/restaurant.pt').implementation()
    event.update({ 'main_template': main_template }) 
```

如果没有 Pyramid，我将如何实现同样的目标？例如，在这段代码中：

```
from chameleon import PageTemplateFile

path = os.path.dirname(__file__)
lizard = PageTemplateFile(os.path.join(path, '..', 'emails', template+'.pt'))
html = lizard(**data) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T20:04:02.293

让我们看看你的代码做了什么；要在金字塔之外使用宏，您所要做的就是复制它。

1.  当您调用`.implementation()`金字塔时，您实际上是在检索`PageTemplateFile`加载了正确模板路径的实例。

2.  该`BeforeRender`事件让您从视图修改 dict 响应，并在您的`add_base_templates`事件处理程序中添加一个名为 的新条目`main_template`。

将这两者结合起来，在你自己的代码中得到同样的效果，在`main_template`调用你的模板时传入一个宏`lizard`模板：

```
from chameleon import PageTemplateFile

path = os.path.dirname(__file__)
main_template = PageTemplateFile(os.path.join(path, '..', 'templates', 'restaurant.pt'))
lizard = PageTemplateFile(os.path.join(path, '..', 'emails', template+'.pt'))
html = lizard(main_template=main_template, **data) 
```

这就是它的全部，真的。

# php - 未定义索引：HTTP_ACCEPT_ENCODING

> ID：10355149
> 
> 赞同：2
> 
> 时间：2012-04-27T17:24:50.497
> 
> 标签：php, apache, gzip

我使用来自[http://sourceforge.net/projects/quickcache](http://sourceforge.net/projects/quickcache)的快速缓存来缓存一些动态页面一段时间

在我的服务器 [HTTP_ACCEPT_ENCODING] => gzip，放气

但来自 quickcache_main.php

```
if (strpos($_SERVER["HTTP_ACCEPT_ENCODING"],'x-gzip') !== false) 
```

和

```
if (strpos($_SERVER["HTTP_ACCEPT_ENCODING"],'gzip') !== false) { 
```

被调用我在 error_log 中得到标题错误。当脚本创建新的缓存页面时，我没有看到从 mysql 表加载这些缓存页面或访问未缓存（或过期）页面有任何问题。我也从未见过我的测试触发了像标题这样的新错误日志。无论如何，我经常看到它们被列出。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-05-14T11:52:24.253

将您的代码更改为：

```
if (!isset($_SERVER['HTTP_ACCEPT_ENCODING'])) {
    ob_start();            
}
elseif (strpos(' ' . $_SERVER['HTTP_ACCEPT_ENCODING'], 'x-gzip') == false) {
    if (strpos(' ' . $_SERVER['HTTP_ACCEPT_ENCODING'], 'gzip') == false) {
        ob_start();
    }
    elseif(!ob_start("ob_gzhandler")) {
        ob_start();
    }   
}
elseif(!ob_start("ob_gzhandler")) {
    ob_start();
} 
```

# sip - SIP 邀请内容长度

> ID：10355150
> 
> 赞同：0
> 
> 时间：2012-04-27T17:24:51.803
> 
> 标签：sip

我正在开发一个 SIP 提供商应用程序。我使用传输 UDP。我有一个问题，我发送一个邀请消息 SIP 服务器。

```
INVITE sip:102@192.168.1.33 SIP/2.0
Via: SIP/2.0/UDP 192.168.1.33:5001;branch=z9hG4bK9232c352-a28c-4467-988e-8027e0031209;rport
To: <sip:102@192.168.1.33>
From: "101"<sip:101@192.168.1.33:5060>;tag=rkktjbvq
CSeq: 1 INVITE
Call-ID: lrfnpvlvrbojabxnuldgejvncshccjpwsfxsobpcpmjrnsvkeh
Max-Forwards: 70
Contact: <sip:101@192.168.1.33:5001>
User-Agent: Iconium
Content-Type: application/sdp
Content-Length: 849

v=0
o=101 940412967 940412967 IN IP4 192.168.1.33
s=Ozeki VoIP SIP SDK
c=IN IP4 192.168.1.33
t=0 0
m=audio 5003 RTP/AVP 8 0 101 98 9 3 100 97 103 15 4 104 105 106 107 18
a=rtpmap:8 PCMA/8000
a=rtpmap:0 PCMU/8000
a=rtpmap:101 telephone-event/8000
a=rtpmap:98 iLBC/8000
a=fmtp:98 mode=30
a=rtpmap:9 G722/8000
a=fmtp:9 bitrate=64000
a=rtpmap:3 GSM/8000
a=rtpmap:100 SPEEX/16000
a=rtpmap:97 SPEEX/8000
a=rtpmap:103 L16/8000
a=rtpmap:15 G728/8000
a=rtpmap:4 G723/8000
a=rtpmap:104 G726-16/8000
a=rtpmap:105 G726-24/8000
a=rtpmap:106 G726-32/8000
a=rtpmap:107 G726-40/8000
a=rtpmap:18 G729/8000
a=fmtp:18 annexb=no
a=sendrecv
m=video 5005 RTP/AVP 102 99 34
a=rtpmap:102 H263-1998/90000
a=fmtp:102 QCIF=1;CIF=1
a=rtpmap:99 H264/90000
a=fmtp:99 packetization-mode=1
a=rtpmap:34 H263/90000
a=fmtp:34 QCIF=1;CIF=1
a=sendrecv 
```

一切都好。并且 SIP 服务器使用 Proxy-Authenticate 响应

```
SIP/2.0 407 Proxy Authentication Required
Via: SIP/2.0/UDP 192.168.1.33:5001;branch=z9hG4bK9232c352-a28c-4467-988e-8027e0031209;rport=5001
Proxy-Authenticate:Digest nonce="414d535c05ab5fd821:79225947c170510b155be0828d92e7e4", algorithm=MD5, realm="3CXPhoneSystem"
To: <sip:102@192.168.1.33>;tag=d92fe85a
From: "101"<sip:101@192.168.1.33:5060>;tag=rkktjbvq
Call-ID: lrfnpvlvrbojabxnuldgejvncshccjpwsfxsobpcpmjrnsvkeh
CSeq: 1 INVITE
User-Agent: 3CXPhoneSystem 10.0.23053.0
Content-Length: 0 
```

我用 ACK 发送验证；

```
INVITE sip:102@192.168.1.33 SIP/2.0
Via: SIP/2.0/UDP 192.168.1.33:5001;branch=z9hG4bKaaf896d5-bd08-48f2-8e3d-0cf043e8324e;rport
To: <sip:102@192.168.1.33>
From: "101"<sip:101@192.168.1.33:5060>;tag=rkktjbvq
CSeq: 2 INVITE
Call-ID: lrfnpvlvrbojabxnuldgejvncshccjpwsfxsobpcpmjrnsvkeh
Max-Forwards: 70
Contact: <sip:101@192.168.1.33:5001>
User-Agent: Iconium
Content-Type: application/sdp
Proxy-Authorization:Digest username="101", realm="3CXPhoneSystem", nonce="414d535c05ab5fd821:79225947c170510b155be0828d92e7e4", response="8592afb1b7f3440afd9607dc3db588cb", uri="sip:102@192.168.1.33", algorithm=MD5
Content-Length: 849

v=0
o=101 940412967 940412967 IN IP4 192.168.1.33
s=Ozeki VoIP SIP SDK
c=IN IP4 192.168.1.33
t=0 0
m=audio 5003 RTP/AVP 8 0 101 98 9 3 100 97 103 15 4 104 105 106 107 18
a=rtpmap:8 PCMA/8000
a=rtpmap:0 PCMU/8000
a=rtpmap:101 telephone-event/8000
a=rtpmap:98 iLBC/8000
a=fmtp:98 mode=30
a=rtpmap:9 G722/8000
a=fmtp:9 bitrate=64000
a=rtpmap:3 GSM/8000
a=rtpmap:100 SPEEX/16000
a=rtpmap:97 SPEEX/8000
a=rtpmap:103 L16/8000
a=rtpmap:15 G728/8000
a=rtpmap:4 G723/8000
a=rtpmap:104 G726-16/8000
a=rtpmap:105 G726-24/8000
a=rtpmap:106 G726-32/8000
a=rtpmap:107 G726-40/8000
a=rtpmap:18 G729/8000
a=fmtp:18 annexb=no
a=sendrecv
m=video 5005 RTP/AVP 102 99 34
a=rtpmap:102 H263-1998/90000
a=fmtp:102 QCIF=1;CIF=1
a=rtpmap:99 H264/90000
a=fmtp:99 packetization-mode=1
a=rtpmap:34 H263/90000
a=fmtp:34 QCIF=1;CIF=1
a=sendrecv 
```

和 Sıp 服务器响应与

```
SIP 2.0/400 Bad Content-Length(larger than datagram) 
```

但是在 Ozeki Voip SDK 中，虽然 content-length=851 一切正常。（使用 UDP 传输）

我该怎么办？我的问题在哪里？

**编辑：** 我的 UDP 客户端：

```
 private void SendSIPMessage(string mesaj, bool korumalı)
        {

            IPEndPoint remotendpoint = new IPEndPoint(IPAddress.Any, port);
            UdpClient udpClient = new UdpClient();
            try
            {
                udpClient.Connect("192.168.1.33", 5060);
                Byte[] sendBytes = Encoding.ASCII.GetBytes(mesaj);
                udpClient.Send(sendBytes, sendBytes.Length);
                string receivedMessage = string.Empty;
                Byte[] receiveBytes = udpClient.Receive(ref remotendpoint);
                receivedMessage = Encoding.ASCII.GetString(receiveBytes);
                label1.Text += receivedMessage + "\n";

        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-22T08:54:30.723

这可能是因为您的 UDP SIP 数据包超过 MTU 或 1300 字节。

RFC 3261 - 18.1.1 发送请求

> 如果请求在路径 MTU 的 200 字节内，或者大于 1300 字节且路径 MTU 未知，则必须使用 RFC 2914 [43] 拥塞控制传输协议（例如 TCP）发送请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T18:49:52.000

只是服务器可能有一个设置来拒绝太大的 UDP 数据包。我建议从您的软件中删除一些编解码器。你的清单太大了，我认为没有任何理由。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-02T01:58:28.207

大多数 SIP 代理都可以通过 UDP 接受该大小的消息。您可能想尝试不同的 SIP 服务器。在生产系统中，SIP 消息大于单个 MTU 是很正常的，但是当 UDP 数据包被分成两部分时，这仍然有效。

# ruby-on-rails - 带图片上传器的多步表单

> ID：10355152
> 
> 赞同：7
> 
> 时间：2012-04-27T17:24:54.613
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, carrierwave

我想建立 3 步用户注册，并在第 2 步上传头像。所以我遵循 Ryan Bates 的指南[http://railscasts.com/episodes/217-multistep-forms](http://railscasts.com/episodes/217-multistep-forms)。我正在使用 CarrierWave gem 来处理上传。但似乎我无法在用户会话中存储上传的文件信息（我得到 can't dump File 错误）。我在控制器中使用以下技术

```
if params[:user][:img_path]
  @uploader = FirmImgUploader.new
  @uploader.store!(params[:user][:img_path])
  session[:img] = @uploader
  params[:user].delete(:img_path)
end 
```

它实际上有帮助。但是当我上传禁止的文件类型时，这条线上的一切都崩溃了

```
@uploader.store!(params[:user][:img_path]) 
```

有这个错误

```
CarrierWave::IntegrityError in UsersController#create
You are not allowed to upload "docx" files, allowed types: ["jpg", "jpeg", "gif", "png"] 
```

而不是正常的表单验证错误。

我怎么解决这个问题 ？谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T20:15:26.730

其实我解决了我的问题。这是使用carrierwave上传文件的多步表单的工作代码

```
if params[:user][:img_path]
  @uploaded = params[:user][:img_path]
  params[:user].delete(:img_path)
end
session[:user_data].deep_merge!(params[:user]) if params[:user]
@user = User.new(session[:user_data])    

if @uploaded
  # here how validation will work
  @user.img_path = @uploaded
end
@user.current_stage = session[:register_stage]
if @user.valid?
  if @user.last_stage?
    @user.img_path  = session[:img] if @user.last_stage?
    @user.save
  else  
    @user.next_stage
  end
  # now we can store carrierwave object in session
  session[:img] = @user.img_path
  session[:register_stage] = @user.current_stage
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-07T18:56:37.850

这对于 OP 来说可能有点晚了，但希望这对某人有所帮助。我需要在用户会话中存储上传的图像（同样是多步骤表单），我也是从 Ryan 的[Railscast #217](http://railscasts.com/episodes/217-multistep-forms)开始的，但应用程序很快就超越了这一点。请注意，我的环境是 Ruby 2 上的 Rails 4，使用 Carrierwave 和 MiniMagick 以及[activerecord-session_store](https://github.com/rails/activerecord-session_store)，我将在下面解释。

我相信 OP 和我都遇到的问题是我们试图将所有 POST 参数添加到用户的会话中，但是通过文件上传，其中一个参数是实际的 UploadedFile 对象，这对于那个来说很大. 下面描述的方法是该问题的另一种解决方案。

免责声明：正如广泛指出的那样，在用户会话中存储复杂对象并不理想，最好存储记录标识符或其他标识符数据（例如图像的路径）并在需要时查找该数据。保持会话和模型/数据库数据同步（一项重要任务）的两个主要原因，以及默认的 Rails 会话存储（使用 cookie）限制为 4kb。

我的模型（submission.rb）：

```
class Submission < ActiveRecord::Base
    mount_uploader :image_original, ImageUploader
    # ...
end 
```

控制器（submissions_controller.rb）：

```
def create
  # If the submission POST contains an image, set it as an instance variable, 
  # because we're going to remove it from the params
  if params[:submission] && params[:submission][:image_original] && !params[:submission][:image_original].is_a?(String)
    # Store the UploadedFile object as an instance variable
    @image = params[:submission][:image_original]
    # Remove the uploaded object from the submission POST params, since we 
    # don't want to merge the whole object into the user's session
    params[:submission].delete(:image_original)
  end

  # Merge existing session with POST params
  session[:submission_params].deep_merge!(params[:submission]) if params[:submission]

  # Instantiate model from newly merged session/params
  @submission = Submission.new(session[:submission_params])
  # Increment the current step in the session form
  @submission.current_step = session[:submission_step]

  # ... other steps in the form

  # After deep_merge, bring back the image
  if @image
    # This adds the image back to the Carrierwave mounted uploader (which 
    # re-runs any processing/versions specified in the uploader class):
    @submission.image_original = @image
    # The mounted uploader now has the image stored in the Carrierwave cache, 
    # and provides us with the cache identifier, which is what we will save 
    # in our session:
    session[:submission_params][:image_original] = @submission.image_original_cache
    session[:image_processed_cached] = @submission.image_original.url(:image_processed)
  end

  # ... other steps in the form

  # If we're on the last step of the form, fetch the image and save the model
  if @submission.last_step?
    # Re-populate the Carrierwave uploader's cache with the cache identifier 
    # saved in the session
    @submission.image_original_cache = session[:submission_params][:image_original]
    # Save the model
    @submission.save
    # ... render/redirect_to ...
  end
end 
```

我的上传文件主要是一些自定义处理的库存。

注意：为了加强会话，我使用了 activerecord-session_store，它是从 v4 中的 Rails 核心提取的一个 gem，它提供了一个数据库支持的会话存储（从而增加了 4kb 的会话限制）。请按照[文档](https://github.com/rails/activerecord-session_store)获取安装说明，但在我的情况下，设置它并忘记它非常快速且轻松。高流量用户注意：剩余的会话记录似乎没有被 gem 清除，所以如果你获得足够的流量，这个表可能会膨胀到无数行。

# javascript - 按下按钮时添加 Cookie

> ID：10355164
> 
> 赞同：3
> 
> 时间：2012-04-27T17:25:23.537
> 
> 标签：javascript, jquery, cookies, onclick, jquery-events

我在添加 cookie 时遇到问题。阅读几个答案，但如果您以前从未与他们合作过，就很难理解。

如果有人单击指定的按钮，我基本上想要的是添加一个 cookie。因此，例如，如果有人单击“喜欢按钮”，无论他前进/后退还是刷新页面，隐藏的内容都会显示出来，并且 cookie 会在几天后被删除。

我用来隐藏内容的内容如下：

***HTML：***

```
<div id="fd">
    <p>Button from below will become active once you hit like button!</p>
    <div id="get-it">
        <a class="button"><img src="img/get-button.png"></a>
    </div>
</div>
<div id='feedback' style='display:none'></div> 
```

***javascript:***

```
FB.Event.subscribe('edge.create', function (response) {
    $('#feedback').fadeIn().html('<p>Thank you. You may proceed now!</p><br/><div id="get-it"><a class="button2" href="pick.html"><img src="img/get-button.png"></a></div>');
    $('#fd').fadeOut();
}); 
```

但是，如果我在内容页面上点击刷新或返回/前进，它将再次被隐藏。这就是我想在按钮点击时添加 cookie 的原因。谁能给我一些解释或示例代码？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-27T17:31:11.897

我建议使用[jQuery-cookie 插件](https://github.com/carhartl/jquery-cookie)。以下是一些使用示例：

```
// Create a cookie
$.cookie('the_cookie', 'the_value');

// Create expiring cookie, 7 days from then:
$.cookie('the_cookie', 'the_value', { expires: 7 });

// Read a cookie
$.cookie('the_cookie'); // => 'the_value'
$.cookie('not_existing'); // => null

// EDIT
// Attaching to a button click (jQuery 1.7+) and set cookie
$("#idOfYourButton").on("click", function () {
    $.cookie('the_cookie', 'the_value', { expires: 7 });
});

// Attaching to a button click (jQuery < 1.7) and set cookie
$("#idOfYourButton").click(function () {
    $.cookie('the_cookie', 'the_value', { expires: 7 });
}); 
```

您还需要检查 cookie 是否存在（在重新加载浏览器时：

```
if ($.cookie('the_cookie')) {
    // Apply rule you want to apply
    $('.ClassToSelect').css("display", "none");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-27T17:28:56.897

[我建议您使用localStorage](http://www.w3schools.com/html/html5_webstorage.asp)而不是 cookie 。

# c# - 套接字异常：一个现有的连接被远程主机强行关闭

> ID：10355169
> 
> 赞同：1
> 
> 时间：2012-04-27T17:25:39.857
> 
> 标签：c#, sockets, proxy, asyncsocket, serversocket

最近，在我的学校有一个关于http代理类的项目。所以它的目的是当你在浏览器上输入url时，请求到达你的代理，提取主机后，你重新创建一个新的请求并请求目标服务器，然后，你将从目标服务器接收数据并发送回浏览器到渲染一个页面。

我创建了一个异步 http 代理服务器类。在 StateObject 类中，我有两个套接字，一个是 workSocket 来处理来自浏览器的新请求，第二个是 destinationSocket 来处理目标套接字。

在从浏览器向目标服务器发送新请求之前，我将 destinationSocket 和处理程序套接字存储到 StateObject 对象。通过这样做，在 AsynCallBack ReceiveFromDestinationServer 函数中，我可以检索 destinationSocket 以从目标服务器接收数据，并检索 workSocket 以将接收到的数据发送回浏览器。并且 BeginReceive 再次运行，直到接收到的数据结束。

我在回调 ReceiveFromDestinationServer 方法的 Socket 中的 Send 方法中得到了这个异常。

请帮我修复它。谢谢阅读。

这是我的代码：

```
public class ServerListerner
{
    private const int TCPPort = 80;
    private const string EOF = "\r\n";        
    // Thread signal.
    public static ManualResetEvent allDone = new ManualResetEvent(false);

    public void StartListening()
    {
        // Data buffer for incoming data.
        byte[] bytes = new Byte[1024];

        // Establish the local endpoint for the socket.
        IPEndPoint localEndPoint = new IPEndPoint(IPAddress.Any, 9000);

        // Create a TCP/IP socket.
        Socket listener = new Socket(AddressFamily.InterNetwork,
            SocketType.Stream, ProtocolType.Tcp );

        // Bind the socket to the local endpoint and listen for incoming connections.
        try {
            listener.Bind(localEndPoint);
            listener.Listen(100);

            while (true) {
                // Set the event to nonsignaled state.
                allDone.Reset();

                // Start an asynchronous socket to listen for connections.                    
                listener.BeginAccept(new AsyncCallback(AcceptCallback), listener);

                // Wait until a connection is made before continuing.
                allDone.WaitOne();
            }

        } catch (Exception e) {
            MessageBox.Show(e.ToString());
        }       
    }

    private void AcceptCallback(IAsyncResult ar) {
        // Signal the main thread to continue.
        allDone.Set();
        // Get the socket that handles the client request.
        Socket listener = (Socket) ar.AsyncState;
        Socket handler = listener.EndAccept(ar);

        // Create the state object.
        StateObject state = new StateObject();
        state.workSocket = handler;
        // And begin receive data from client
        handler.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0,
            new AsyncCallback(ReadCallback), state);
    }

    private void ReadCallback(IAsyncResult ar)
    {
        String content = String.Empty;        
        // Retrieve the state object and the handler socket
        // from the asynchronous state object.
        StateObject state = (StateObject) ar.AsyncState;
        Socket handler = state.workSocket;

        // Read data from the client socket. 
        int bytesRead = handler.EndReceive(ar);
        Thread.Sleep(10);
        if (bytesRead > 0) {            
            // There  might be more data, so store the data received so far.
            state.sb.Append(Encoding.ASCII.GetString(state.buffer));

            content = state.sb.ToString();
            if(content != "")
            {
                // All the data has been read from the client. 
                // Change data to string array to easy access.
                string[] requestLines = Regex.Split(content, EOF);
                // Get remote host
                string remoteHost = requestLines[0].Split(' ')[1].Replace("http://", "").Split('/')[0];

                // Create a destination socket and connect to remote host at TCP port
                Socket destinationSocket= new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
                destinationSocket.Connect(remoteHost, TCPPort);
                // Send the data to destination socket.
                state.workSocket = handler;
                state.destinationSocket = destinationSocket;
                destinationSocket.Send(state.buffer);
                destinationSocket.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0, new AsyncCallback(ReceiveFromDestinationServer), state);
            } else {
                // Not all data received. Get more.
                handler.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0,
                    new AsyncCallback(ReadCallback), state);
            }
        }
    }

    private void ReceiveFromDestinationServer(IAsyncResult ar)
    {                        
            StateObject state = (StateObject)ar.AsyncState;
            Socket destinationSocket = state.destinationServer;
            Socket client = state.workSocket;
            int bytesRead = destinationSocket.EndReceive(ar);
            if (bytesRead > 0)
            {                    
                client.Send(state.buffer, bytesRead, SocketFlags.None);                    
                destinationSocket.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0, new AsyncCallback(ReceiveFromDestinationServer), state);
            }
            else
            {
                // Exception here
                destinationSocket.Shutdown(SocketShutdown.Both);                
                destinationSocket.Close();
                client.Close();
            }             

    }
} 
```

**更新**：ReceiveFromDestinationServer 函数我在 bytesRead 之后添加了 Thread.Sleep(10)。我认为睡眠很重要，当设置为10时，有些站点加载速度很快，有些站点只加载一些信息，当设置为100时，加载站点后，应用程序会自动退出。**但例外仍然存在。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:46:42.627

我认为您的代码用于在客户端和服务器之间进行交互。“AcceptCallback”中的“处理程序”是用于将字节发送回浏览器而不是发送到目的地的套接字。
因此，您需要编写另一个工作对（异步）/一个（同步）套接字来实现 http 代理。首先，您应该明确请求和响应的样子。
浏览器首先发送给您：

```
browserIP ===> proxyIP
GET domainname.com
.... 
```

然后代理做依赖：

```
proxyIP ===> domainname.com'sIP
GET domain name
.... 
```

在您的代理收到 domainname.com 的响应后，将其发送回 browserIP。这就是你要做的，在 .NET 中，你还需要处理一些特定于代理的 http 标头，例如 X-forwarded-by。等等

但在您的代码部分：
Socket listener = (Socket) ar.AsyncState;
Socket handler = listener.EndAccept(ar);//这行创建一个新的套接字只是为了将字节发送回浏览器：所以你的浏览器将得到与其请求相同的回复。

```
 // Create the state object.  
    StateObject state = new StateObject(); 
```

所以你需要创建另一个新的 Socket 和一对新的处理程序。才能真正将请求发送到目的地。在你创建它们之前。您需要获取目标的真实 IP 地址（您的代理不知道，您的客户端不知道目标的 IP 地址[domainname.com]）

## 改变这两个，看看它是否有效：

1.  您的 StateObject 中有两个套接字destinationServer 和destinationSocket ？？？并且似乎 destinationServer 始终为空，因此在 ReceiveFromDestinationServer:line2 您应该使用**state.destinationSocket**；
2.  在 ReadCallback:line29 你应该使用**destinationSocket.Send(state.buffer,bytesRead,SocketFlags.None);** 相反，否则您会将整个缓冲区发送到目的地，那么您肯定会收到“400 错误请求”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:44:14.003

可能是远程主机未运行或未侦听您尝试连接的端口。您可能需要使用 telnet 检查服务器应用程序的状态

```
 telnet ipaddr port 
```

# wordpress-theming - 在循环期间修改 Wordpress 中的 $post 变量是否合理？

> ID：10355170
> 
> 赞同：1
> 
> 时间：2012-04-27T17:25:50.883
> 
> 标签：wordpress-theming, wordpress

所以我开始编写一个 Wordpress 主题，我试图将一些变量从`The Loop`my传递`index.php`到我的实际内容渲染器中`content.php`。

由于范围问题，我不能只创建一个变量`index.php`然后尝试在`content.php`. 使用的想法`global`让我不寒而栗，所以我想也许我会把它标记到`$post`变量上（这已经是全局的）。这是标准做法吗？`$post`除了意外修改标准成员变量之外，我还有什么不想这样做的原因吗？有没有一种惯用的 Wordpress 方式来做到这一点？

这是我的一个例子`index.php`：

```
$post->is_n = false; # bad idea?                                
if($post_number === $n){
    $post->is_n = true
}
get_template_part( 'content', get_post_format() ); 
```

然后在我的`content.php`：

```
if($post->is_n){$article_classes .= " is-n";} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:46:08.280

$post 变量在 WordPress 中已经是一个全局变量，因此创建或不创建另一个全局变量来传递值实际上只是样式问题，而不是其他任何事情。鉴于其起源于 OOP PHP 4.x 之前的日子，WordPress 本身就非常广泛地使用了全局值。

将值附加到 $post 会起作用，但是 $post 对象有可能在循环迭代之间不会被完全破坏，因此您的自定义属性可能会在 $post 变量的后续迭代中结束，并且可能会导致意外的副作用，如果你不小心。同样，您必须确保适当地命名该属性，以免与未来 WordPress 对 $post 的更改发生冲突。

在 WordPress 中创建一个新的全局变量来传递变量并不会与众不同，将自定义属性附加到 $post 变量会有点不寻常。如果您想命名事物并将您的值排除在 $_GLOBAL 之外，您可以创建一个快速注册表类，但在这种情况下这可能是矫枉过正。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T04:03:29.123

修改 $post 变量很常见，尽管我可能会选择与您描述的设计不同的设计。但是当一个人正在学习时，必须自己找出这些东西:^)

修改 $post 变量后，您可以调用[wp_reset_postdata](http://codex.wordpress.org/Function_Reference/wp_reset_postdata)函数。[这在您使用WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)对象时更常用。

# c - 在 C 中，在函数头和函数体之间声明变量是什么意思？

> ID：10355177
> 
> 赞同：6
> 
> 时间：2012-04-27T17:26:01.243
> 
> 标签：c, syntax

现在有几次，我遇到过这样的代码：

```
int
main(argc, argv)
int argc; char **argv;
{
    ...
} 
```

为什么都以这种`argc`方式`argv`声明？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-27T17:26:51.303

这是用于 K&R*[样式](http://en.wikipedia.org/wiki/Indent_style#K.26R_style)参数列表的语法。

* K&R - Brian Kernighan 和 Dennis Ritchie，《[C 编程语言](http://en.wikipedia.org/wiki/The_C_Programming_Language)》一书的作者。
[Dennis Ritchie](http://en.wikipedia.org/wiki/Dennis_Ritchie)还是 C 编程语言和 UNIX 操作系统 Ken Thompson 的创造者。

# android - 如何将一个按钮放在Android中另一个按钮的中心

> ID：10355179
> 
> 赞同：0
> 
> 时间：2012-04-27T17:26:11.803
> 
> 标签：android, layout, imagebutton

我有两个图像按钮，button1 和 button2。对于按钮 1，我正在设置一个更大的图像，而对于按钮 2，我正在设置一个小图像。我必须将 button2 准确地放在 button1 的中心。我如何实现这一目标？

我正在使用相对布局，我必须在[XML](http://en.wikipedia.org/wiki/XML)文件中进行此更改。我还需要分别为这两个按钮接收点击事件。

我已经尝试了下面的代码，但我没有收到单独的点击事件。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"
    android:id="@+id/linearLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ImageView
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:src="@drawable/mainscreen"
        android:scaleType="fitXY" />

    <com.google.ads.AdView
        android:id="@+id/adView"
        android:layout_width="320dp"
        android:layout_height="50dp"
        ads:adUnitId="xxxx"
        ads:adSize="BANNER"
        ads:loadAdOnCreate="true"/>

    <ImageButton android:id="@+id/star"
        android:layout_width ="wrap_content"
        android:layout_height ="wrap_content"
        android:layout_toRightOf="@+id/adView"
        android:src="@drawable/star"
        android:background="@layout/selector"
        android:layout_marginLeft="40dp"
        android:focusable="false" />

    <ImageButton android:id="@+id/image1"
        android:layout_width ="wrap_content"
        android:layout_height ="wrap_content"
        android:layout_below="@+id/adView"
        android:src="@drawable/drum"
        android:background="@layout/selector"
        android:layout_marginTop="30dp"
        android:layout_marginLeft="20dp"
        android:layout_marginRight="10dp"
        android:focusable="false" />
    <ImageButton android:id="@+id/image2"
        android:layout_width ="wrap_content"
        android:layout_height ="wrap_content"
        android:src="@drawable/drum1"
        android:layout_alignLeft="@+id/image1"
        android:layout_alignTop="@+id/image1"
        android:layout_alignRight="@+id/image1"
        android:layout_alignBottom="@+id/image1"
        android:focusable="false" />

    <ImageButton android:id="@+id/image3"
        android:layout_width ="wrap_content"
        android:layout_height ="wrap_content"
        android:src="@drawable/drum2"
        android:background="@layout/selector"
        android:layout_alignLeft="@+id/image1"
        android:layout_alignTop="@+id/image1"
        android:layout_alignRight="@+id/image1"
        android:layout_alignBottom="@+id/image1"
        android:focusable="false" />

    <ImageButton android:id="@+id/image4"
        android:layout_width ="wrap_content"
        android:layout_height ="wrap_content"
        android:layout_below="@+id/adView"
        android:src="@drawable/drum"
        android:background="@layout/selector"
        android:layout_marginTop="30dp"
        android:layout_toRightOf="@+id/image1"
        android:focusable="false" />

    <ImageButton android:id="@+id/image5"
        android:layout_width ="wrap_content"
        android:layout_height ="wrap_content"
        android:src="@drawable/drum1"
        android:background="@layout/selector"
        android:layout_alignLeft="@+id/image4"
        android:layout_alignTop="@+id/image4"
        android:layout_alignRight="@+id/image4"
        android:layout_alignBottom="@+id/image4"
        android:focusable="false" />

    <ImageButton android:id="@+id/image6"
        android:layout_width ="wrap_content"
        android:layout_height ="wrap_content"
        android:src="@drawable/drum2"
        android:background="@layout/selector"
        android:layout_alignLeft="@+id/image4"
        android:layout_alignTop="@+id/image4"
        android:layout_alignRight="@+id/image4"
        android:layout_alignBottom="@+id/image4"
        android:focusable="false" />
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:37:06.513

使用您当前的布局，您将需要嵌套项目。但由于您只对 imagebutton 的图像部分感兴趣，因此您可以只使用 FrameLayout 作为您当前调用的“button1”，就像在我的示例中一样（适应您的情况）：

```
<FrameLayout android:id="@+id/button1"
  ...
  android:background="@drawable/image1"
  >

  <ImageButton
    android:id="@+id/button2"
    android:layout_gravity="center"
    android:src="@drawable/image2" />

</FrameLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:28:48.680

请尝试使用 FrameLayout 来包含两个按钮

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T17:29:09.687

对于第二张图像，设置属性`aligncenterinparent = true`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T17:41:37.033

使用框架布局。将 button1 作为填充父级，将 button 2 作为带有 layout_gravity="center" 的包装内容。看下面的代码：

```
<?xml version="1.0" encoding="utf-8"?>
    <FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/frameLayout1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <ImageButton
            android:id="@+id/imageButton1"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:src="@android:drawable/dialog_frame" />

        <ImageButton
            android:id="@+id/imageButton2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/pic_2" 
            android:layout_gravity="center"/>

    </FrameLayout> 
```

# php - PHP/Javascript 将 js 变量发布到 php 页面

> ID：10355182
> 
> 赞同：1
> 
> 时间：2012-04-27T17:26:26.843
> 
> 标签：php, javascript, arrays

虽然是 javascript 的新手，但我需要使用 javascript 变量（一个数组）来反映用户在客户端所做的事情，然后在提交时将其发布到 PHP 服务器页面。

有人建议我将其作为值包含在表单中的隐藏字段中以发布到 php 页面。但是，由于 JS 变量是由用户动态创建的，因此除非我调用刷新页面的函数，否则我无法写入页面以包含在表单中。为避免双页刷新，我希望提交函数既获取数据又同时将其发布到 php 脚本。如果我理解正确，则不需要 AJAX，因为我可以在提交时重新加载页面。我只是不想重新加载两次。

下面使用安德鲁建议的函数来设置js变量和post。当我得到表单中的另一个隐藏变量时，表单发布，但我没有得到 js 设置的变量，可能是因为变量的命名有误。

```
 <html>
     <head>
    <style type="text/css">
        select
        {
            width:100px;
        }
    </style>
    <script type="text/Javascript">
        function moveToRightOrLeft(side)
        {
            if (side == 1)
            {
                var list1 = document.getElementById('selectLeft');
                var list2 = document.getElementById('selectRight');
            }
            else
            {
                var list1 = document.getElementById('selectRight');
                var list2 = document.getElementById('selectLeft');
            }

            if (list1.options.length == 0)
            {
                alert('The list is empty');
                return false;
            }
            else
            {
                var selectedItem = list1.options[list1.selectedIndex];
                move(list2, selectedItem.value, selectedItem.text);
                list1.remove(list1.selectedIndex);
                if (list1.options.length > 0)
                    list1.options[0].selected = true;
            }
            return true;
        }

        function move(listBoxTo, optionValue, optionDisplayText)
        {
            var newOption = document.createElement("option");
            newOption.value = optionValue;
            newOption.text = optionDisplayText;
            listBoxTo.add(newOption, null);
            return true;
        }

        function postData(listBoxID)
        {
            var options = document.getElementById(listBoxID).options;
            for (var i = 0; i < options.length; i++) 
            window.location = "posttoserver.php?data="+options[i].value;

        }

        function setTheValue(val) {
    var options = document.getElementById(listBoxID).options;
    var form = document.forms['myForm'];
    hiddenField = oFormObject.elements["data"];
    hiddenField.value = "val";
}
    </script>
    </head>
    <body>
    <select id="selectLeft" multiple="multiple">
        <option value="1">Value 1</option>
        <option value="2">Value 2</option>
        <option value="3">Value 3</option>
    </select>
    <button onclick="moveToRightOrLeft(2)">&lt;</button>
    <button onclick="moveToRightOrLeft(1)">&gt;</button>
    <select id="selectRight" multiple="multiple">
    </select>
    <form id="myForm" action="getdata.php" method="get">
    <input type="hidden" name="data" />
    <input type="hidden" name="mode" value="savedit">
    <button onclick="setTheValue(options)">Submit Data</button>
</form>
     </body>
     </html> 
```

另一方面，我在 getdata.php 中：

```
<?php
$mode = $_REQUEST['mode'];
$option = $_REQUEST['data'];
echo $mode;
echo $option;
print_r ($option);;
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T12:16:44.117

几天后终于用 document.getElementById('varname').value 解决了它 对于像我这样的新手来说，document.getElementById 不仅仅像您想象的那样检索数据，而且大多数文档都提到了。它还设置数据。

关键是将语句向后写，并且（正如您必须做的那样检索一个值）将 id== 放入您要设置的元素中。

如果你写 var test = document.getElementById('text'); 并且您已将 id="text" 放在某个字段中，它将检索文本的值。这就是通常的文档所提到的。但是，如果你写：

document.getElementById('varname').value = "dog" 它将“dog”插入到包含 id=varname 的元素中。

虽然这对于更有经验的人来说可能是显而易见的，但它确实让我感到困惑。

以下代码有效。

```
<html>
<head>
<script>

 function Post(data)
        { 
            document.getElementById('varname').value = data

        }
</script>
</head>
<body>
<form action = "" method="get">
<input id="varname" type="hidden" name="d">
<button onclick="Post('dog')">Post to Server</button>
</form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:19:21.630

您可以像往常一样创建一个带有空隐藏字段的表单：

```
<form id="myForm" action="posttoserver.php" method="get">
    <input type="hidden" name="data" />
    ...
    <input type="submit" value="Submit" />
</form> 
```

您可以使用 JavaScript 函数来设置隐藏字段的值：

```
function setTheValue(val) {
    var form = document.forms['myForm'];
    hiddenField = oFormObject.elements["data"];
    hiddenField.value = "val";
} 
```

然后，您可以在单击按钮时调用函数 setTheValue(val) 或其他任何内容。我希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:22:58.767

jQuery 实际上使这变得非常简单。你有正确的想法，但使用 window.location 会改变你的页面。您要做的是在您留在当前页面时向另一个 url 发出异步请求。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# visual-studio-2010 - Visual Studio 调试器问题

> ID：10355183
> 
> 赞同：0
> 
> 时间：2012-04-27T17:26:32.070
> 
> 标签：visual-studio-2010

当我在 Visual Studio 中调试时，我设置了一个断点，然后按 F5。当我继续按 F11 逐步了解程序如何运行时，当我到达标准库函数（例如 std::cout）时，将运行 .

无论如何我可以阻止它并让它更加本地化吗？我玩过设置，但没有偶然发现一种方法。

我对编程完全陌生，所以如果这是一个简单的修复，我深表歉意。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:29:35.087

还有两个可能对您有帮助的步进命令：

*   Step Over (F10) - 跳过一个函数而不进入它。
*   Step Out (Shift + F11) - 跳出当前函数。

# php - phpbb3 如何让自定义配置文件字段显示在用户发布的帖子上？

> ID：10355188
> 
> 赞同：1
> 
> 时间：2012-04-27T17:26:54.697
> 
> 标签：php, phpbb3

我有这个代码：但它不起作用。

来自 viewtopic_body.html

```
<!-- BEGIN custom_fields -->
    <!-- IF postrow.custom_fields.PROFILE_FIELD_NAME eq "ingame_name" -->
        <dd><strong>{postrow.custom_fields.PROFILE_FIELD_NAME}:</strong> {postrow.custom_fields.PROFILE_FIELD_VALUE}</dd>
    <!-- ENDIF -->
<!-- END custom_fields --> 
```

我的自定义字段名称称为“ingame_username”，并设置为在选项中尽可能显示，我在进行更改后删除了缓存但仍然不显示。

如何显示上面的代码结构，如何在模板的其他部分调用它？

关于此的文档非常有限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T21:30:30.430

我同意这不是很直接，因为您需要在 ACP 下检查一些选项，并且您还必须编辑您的模板。以下是步骤：

1.  转到“ACP > 用户和组（选项卡）> 自定义配置文件字段（链接）> 单击设置图标”将您的自定义字段从“ingame_username”重命名为“ingameusername”，因为低于分数会导致问题。
2.  在同一页面上，确保为相关字段选中“在 viewtopic 屏幕上显示”选项。
3.  转到“ACP > 常规（选项卡）> 服务器配置（部分）> 加载设置（链接）”，并确保选中“在主题页面上显示自定义配置文件字段”单选选项。
4.  在“viewtopic_body.html”中找到包含以下内容的行：

    {postrow.POSTER_FROM}

在它下面，添加以下行（phpbb 3.0.10 中的第 184 行）：

```
<!-- IF postrow.custom_fields.PROFILE_INGAMEUSERNAME_NAME --><dd><strong>{postrow.custom_fields.PROFILE_INGAMEUSERNAME_NAME}:</strong> {postrow.custom_fields.PROFILE_INGAMEUSERNAME_VALUE}</dd><!-- ENDIF --> 
```

就是这样！您现在将在 Viewtopic 页面上看到自定义字段及其值。

![在此处输入图像描述](../Images/6e991c38cb70bb7ad1909099f4761403.png)

皮特

# css - 如何在 Django 1.4 中为本地开发提供静态文件

> ID：10355194
> 
> 赞同：7
> 
> 时间：2012-04-27T17:27:12.663
> 
> 标签：css, django, static

我刚刚下载了最新的 Django 版本（1.4.1），在本地使用 runserver 进行开发时，我不知道如何提供 css 文件。我已经阅读了有关[静态文件的相关 Django 文档](https://docs.djangoproject.com/en/dev/howto/static-files/)以及这里的许多问题和答案......听起来它应该或多或少是自动的，但它对我不起作用。

我正在开发本教程中的民意调查应用程序。

**来自日志的 404**

```
[27/Apr/2012 01:04:09] "GET /polls/ HTTP/1.1" 200 210
[27/Apr/2012 01:04:09] "GET /polls/css/styles.css HTTP/1.1" 404 2596 
```

**目录结构**

```
mysite
|-- manage.py
|-- mysite
    |-- __init__.py
    |-- settings.py
    |-- urls.py
    |-- wsgi.py
|-- polls
    |-- __init__.py
    |-- models.py
    |-- tests.py
    |-- views.py
    |-- static
        |-- css
            |-- styles.css
|-- templates
    |-- polls
        |-- index.html 
```

**索引.html**

```
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/styles.css"> 
```

**设置.py**

```
MEDIA_ROOT = ''
MEDIA_URL = ''
STATIC_ROOT = ''
STATIC_URL = '/static/'
STATICFILES_DIRS = ()
STATICFILES_FINDERS = (
'django.contrib.staticfiles.finders.FileSystemFinder',
'django.contrib.staticfiles.finders.AppDirectoriesFinder',
)
TEMPLATE_CONTEXT_PROCESSORS = (
"django.core.context_processors.auth",
"django.core.context_processors.debug",
"django.core.context_processors.i18n",
"django.core.context_processors.media",
'django.core.context_processors.static',
) 
```

^^^ 当我启动项目时我在 settings.py 中没有 TEMPLATE_CONTEXT_PROCESSORS 变量并且必须手动添加它 - 我应该担心吗？

STATICFILES_DIRS 是空的，因为 css 文件位于 polls 应用程序中名为 static 的目录中，这是 Django 自动查找它的地方 - 对吧？

我的 INSTALLED_APPS 中也有 django.contrib.staticfiles。

**网址.py**

我在文档中看到，该解决方案适用于 runserver 以外的本地开发服务器*-*听起来好像没有必要，对吧？（我目前已将其注释掉。）

编辑：我取消注释这些行，但没有看到变化 - 在 css 文件上仍然得到相同的 404

```
from django.contrib.staticfiles.urls import staticfiles_urlpatterns
urlpatterns += staticfiles_urlpatterns() 
```

我的目录结构设置错误吗？我是否缺少 settings.py 中的必要设置？任何帮助将不胜感激！谢谢！

* * *

编辑：

我接受了 Mark 的建议并阅读了 RequestContext。改变我的观点：

```
return render_to_response('polls/index.html', {'latest_poll_list': latest_poll_list}) 
```

到

```
from django.template import RequestContext
...
return render_to_response('polls/index.html', {'latest_poll_list': latest_poll_list}, context_instance=RequestContext(request)) 
```

得到 /static/ url 注册：

```
[27/Apr/2012 13:56:55] "GET /static/css/styles.css HTTP/1.1" 200 19 
```

这解决了问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-27T18:33:38.720

为了`STATIC_URL`在模板中使用，您需要确保使用 a`RequestContext`以及添加`'django.core.context_processors.static'`到`TEMPLATE_CONTEXT_PROCESSORS`. 如果您使用`render`快捷方式，这将为您完成。如果您不使用 a`RequestContext`那么您可以使用模板标签库`{% get_static_prefix %}`中的模板标签。`staticfiles`这在此处的文档中有详细说明：[https ://docs.djangoproject.com/en/1.4/ref/contrib/staticfiles/#other-helpers](https://docs.djangoproject.com/en/1.4/ref/contrib/staticfiles/#other-helpers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T13:19:29.287

。我遇到了同样的问题，并且几乎与上面提到的相同的coinfuration这成功了：我在setting.py中添加了STATICFILES_DIRS中我的静态目录的路径：

```
STATICFILES_DIRS = (
os.path.join(PROJECT_DIR,'static'),
) 
```

当还在 settings.py PROJECT_DIR 设置为：

```
PROJECT_DIR=os.path.dirname(os.path.abspath(__file__)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T17:31:30.540

从您的 404 来看，您的模板中似乎没有包含 {{ STATIC_URL }}。这大概就是问题所在。而不是仅仅“css/file”，做“{{ STATIC_URL}}css/file”

不用太努力，您的设置看起来还不错。如果上述方法不起作用，请尝试运行 ./manage.py collectstatic 并查看是否有帮助（它将静态文件从应用程序目录移动到项目静态目录中）。

并且绝对取消注释 urls.py 中的这些行！如果您没有静态 url 模式，那么当它从 /static/ 请求某些内容时，它将不知道该怎么做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T16:15:12.910

这在开发服务器下对我有用：
1\. 我在我的应用程序“myblog”目录下添加了“静态”文件夹。
2\. 在“static”文件夹中添加了“myblog.css”文件。
3\. 将样式表链接到我的应用程序模板，代码如下。

```
<link rel="stylesheet" href="{{ STATIC_URL }}myblog.css" type="text/css" media="screen" /> 
```

我没有更改 settings.py 或 urls.py 文件以修复 css，所做的更改仅根据教程进行，所以你应该有相同的。

# java - .vimrc 中的示例 neocomplcache 设置适用于 MacVim，但不适用于 Linux 控制台 vim

> ID：10355196
> 
> 赞同：0
> 
> 时间：2012-04-27T17:27:14.790
> 
> 标签：java, linux, macos, vim, macvim

我在我的电脑、macbook air 和 Linux ubuntu 11.10 中都安装了 neocomplcache for vim 我在 macbook air 上使用 macVim，但我在 ubuntu 上使用控制台 vim。

首先，我将示例代码复制到 macVIm 的 .vimrc 中。它适用于我的 macbook，并且不会发生错误。

之后，我将代码复制到控制台vim的.vimrc中。当我每次尝试在终端上运行 vim 时。它告诉我下面的句子是错误的表达。

```
let g:neocomplcache_dictionary_filetype_lists = {\ 'default' : '',
        \ 'vimshell' : $HOME.'/.vimshell_hist',
            \ 'scheme' : $HOME.'/.gosh_completions'
              \ } 
```

虽然我看不到这个插件的功能有任何负面影响，（我使用java完成）它发生了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T15:16:19.737

似乎在`\`in之前缺少换行符`s = {\ '`。这可能是由不同的换行符分隔符（CR 与 LF）引起的。

# php - 如何制作一个只显示 MySQL 的最后 20 个值的 php 动态表？

> ID：10355201
> 
> 赞同：0
> 
> 时间：2012-04-27T17:27:49.570
> 
> 标签：php, mysql

我制作了一个显示来自 MySQL 表的数据的 php 表。这是完美的工作。但是，MySQL 表不断更新，因此我的 php 表变得非常长且大。我只想保持简短，所以如果可能的话，我只想让它显示桌子上的最后 20 个项目。

此外，表格不会动态更新，要查看新的更新，您必须不断刷新页面，*如果它可以自行更新，我希望它*。 [这](http://gtap.strangled.net/test_chart/table3.php)是（长）表外观的页面。

这是我现在的php代码：

```
<?php
    $con = mysql_connect("$host","$username","$pass"); 
    if (!$con)
    {
    die('Could not connect: ' . mysql_error());
    }
    mysql_select_db("$db_name", $con); //database name
    $result = mysql_query("SELECT * FROM $db_table"); //table

    echo "<table cellpadding='0' cellspacing='0' class='ver-minimalist'>
    <tr>
    <th>Photoresistor</th>
    <th>Accelerometer</th>
    </tr>";

    while($row = mysql_fetch_array($result))
    {
    echo "<tr>";
    echo "<td>" . $row['Photoresistor'] . "</td>";
    echo "<td>" . $row['Accelerometer'] . "</td>";
    echo "</tr>";
    }
    echo "</table>";

    mysql_close($con);
    ?> 
```

我知道我将不得不做一个循环，但我不确定哪一个是最好的选择。拜托，我真的很感激你的帮助。

如果有帮助，MySQL 表确实有一个 ID -主键。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T17:29:39.377

使您的查询：

```
SELECT * FROM $db_table ORDER BY id DESC LIMIT 20 
```

限制允许您限制从查询中获得的结果数量。通过按 ID 排序，您可以获得表中的最后 20 个结果。

# javascript - 连接列表控件

> ID：10355207
> 
> 赞同：0
> 
> 时间：2012-04-27T17:28:11.223
> 
> 标签：javascript, jquery

对不起我的英文谷歌翻译。我有三个连接列表

```
$( ".listaAvisosConectados" ).sortable({
    connectWith: ".listaAvisosConectados",
    dropOnEmpty:true,

    }).disableSelection(); 
```

在线示例： http: [//test.vertudemo.com/](http://test.vertudemo.com/)

我需要实现任何元素都可以添加到红色列表中，但列表项不能是绿色或蓝色添加到相反列表中。红色接受所有。绿色只接受绿色，蓝色只接受蓝色。

我尝试了几种方法，但无法做到。

如果我为每个绿色和红色列表添加不同的类。红名单和添加两个类都不太好用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:53:14.663

看起来有一个“取消”方法可以用来响应“接收”事件——例如（在伪代码中）

```
bluelist.sortable(
recieve: function(event, ui){
if(ui.element.class == "green"){ //I don't remember exactly how to get the element off the top of my head, but I think it's something like ui.element
$(this).sortable('cancel');
}} 
```

# c# - 如何在 WPF 中制作自定义形状的面板？

> ID：10355208
> 
> 赞同：1
> 
> 时间：2012-04-27T17:28:12.523
> 
> 标签：c#, .net, wpf

据我所见，我面临着一个以前在这里已经被问过的问题。我阅读了其中的大部分内容，但没有找到正确的答案。

这就是我需要的：

*   复杂形状的区域（即：国家，州..）
*   有可能获得事件（尤其是鼠标）
*   可以在其中放置一些控件（即：图像、按钮）

我看到有些使用用户控件，控件模板..但是我应该怎么做那种形状？大多数问题是针对标准形状的一些基本组合。
（我在 Blend 中看到我们可以用笔制作路径对象，有没有办法用它来定义区域的形状？）

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:09:02.343

创建您自己的控件并使其主容器成为 Canvas。让画布背景透明，然后您可以在其上放置所需的所有控件。您可以使用多边形作为画布内的主要形状，并将所需的所有控件放在画布上（但我想出于您的目的，您需要确保不要将它们放置在多边形覆盖的区域之外。

让您使用的每个对象处理 mousedown 事件，然后您可以单独拖动它们。当 mousedown 发生时，在您单击的对象上使用 CaptureMouse() 方法，以便您单击的对象仍会捕获所有拖动（在主窗口上或离开主窗口）。确保在 mouseup 事件中调用 ReleaseMouse()。

您可以根据需要创建任意数量的控件实例。所有具有由每个包含的多边形定义的不同形状。您可以将所有这些对象放在一个网格或画布上，一切顺利。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-15T12:29:20.413

您可以使用`PathPanel`Expression Blend SDK 中提供的类。 [更多信息在这里](https://docs.microsoft.com/en-us/previous-versions/visualstudio/design-tools/expression-studio-4/ff726421(v=expression.40))

# windows-8 - Windows 8 博客阅读器示例

> ID：10355210
> 
> 赞同：0
> 
> 时间：2012-04-27T17:28:35.997
> 
> 标签：windows-8

我正在尝试[这个示例](http://msdn.microsoft.com/en-us/library/windows/apps/br211380.aspx)，我可以在 GridView 中列出所有博客的第一页。但是当我点击一个时，我应该看到博客列表，其中包含一个可以阅读博客的区域——相反，我在下面不断收到这个错误。

集合属性 __implicit_items 为空 第 82 行位置 45

我在 SplitPage.xaml 的第 82 行有以下内容。它在 SplitPage 的构造函数中失败，看起来像这样

```
 public SplitPage()
    {
        this.InitializeComponent();
    } 
```

我经历了它并再次经历它，看看我是否错过了什么，但如果有什么我明显做错了，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:47:54.513

我也在研究这个示例，并将他们提供的 XAML 调整为

```
<TextBlock.Transitions>
    <TransitionCollection>
        <ContentThemeTransition />
    </TransitionCollection>
</TextBlock.Transitions> 
```

这似乎解决了错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T23:05:03.317

弄清楚了。实际错误是解析 XAML 的问题，但这是由于此集合可能为空。无论如何，我在问题中提到的第 82 行删除了这个动画 XAML，并且该应用程序现在可以工作了。稍后会看动画。

# eclipse - 在 openCv 中使用 calcCovarMatrix 时出错

> ID：10355213
> 
> 赞同：1
> 
> 时间：2012-04-27T17:28:40.713
> 
> 标签：eclipse, opencv, computer-vision, covariance

我正在尝试在我的代码中计算协方差矩阵，但这样做时出现错误。我有要使用的平均值数组。这是我的代码

```
Mat Zt(Z);
Mat Zttranspose;
Mat covarZ=cvCreateMat(image->nChannels,image->nChannels,CV_32FC1);

Zttranspose=Zt.t();

Mat_<float> arraymean=(Mat_<float>(3,3)<< meanb, meang, meanr);

calcCovarMatrix(Zt,covarZ,arraymean,CV_COVAR_USE_AVG,CV_64F) 
```

但我收到以下错误：

```
OpenCV Error: Assertion failed (((flags & CV_COVAR_ROWS) != 0) ^ ((flags & CV_COVAR_COLS) != 0)) in calcCovarMatrix, file /usr/local/src/OpenCV-2.3.0/modules/core/src/matmul.cpp, line 2127 terminate called after throwing an instance of 'cv::Exception' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T10:02:35.023

垫 covarZ=cvCreateMat(..); 我认为你已经混合了 C 和 C++ API。

您可能想看看这个链接[http://pastebin.com/cWQi4ngv](http://pastebin.com/cWQi4ngv)。

我已经尝试过了，它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-30T20:55:18.110

这将解决您的问题

-

calcCovarMatrix(Zt,covarZ,arraymean,CV_COVAR_USE_AVG **| CV_COVAR_ROWS** ,CV_64F)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-01T20:06:02.323

您正在使用 CV_32FC1 创建矩阵，然后使用 CV_64F 调用 calcCovarMatrix - 您需要使它们对初学者保持一致。

# php - 在一组字符 PHP 中查找一个单词

> ID：10355216
> 
> 赞同：0
> 
> 时间：2012-04-27T17:28:56.857
> 
> 标签：php, string, find, word, strpos

我正在寻找一种方法来确定一个单词是否在一组字符中的某个位置。例如，如果单词“looking”在“hereisthewordim*looking*for”中

```
if( strpos("looking", "hereisthewordimlookingfor")  !== false) {
 echo "true";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:37:23.173

您需要替换参数：

```
strpos("hereisthewordimlookingfor", "looking") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:38:52.237

我想你正在寻找这个：

```
if(stristr("hereisthewordimlookingfor","looking")) {
    echo "true";
}; 
```

# php - 使用 PHP 强制下载文件

> ID：10355219
> 
> 赞同：0
> 
> 时间：2012-04-27T17:29:07.537
> 
> 标签：php, image, download

我的 PHP 知识有限，我正在尝试在我的网站中实现[http://www.tutorialchip.com/php-download-file-script/](http://www.tutorialchip.com/php-download-file-script/)这个脚本。我在这里[http://brooksmemories.com/test/](http://brooksmemories.com/test/)上推了他们的文件不变。如果单击文件，我会收到以下错误

`Strict Standards: main() [function.main]: It is not safe to rely on the system's timezone settings. Please use the date.timezone setting, the TZ environment variable or the date_default_timezone_set() function. In case you used any of those methods and you are still getting this warning, you most likely misspelled the timezone identifier. We selected 'America/Chicago' for 'CDT/-5.0/DST' instead in /home/inspire/public_html/brooksmemories.com/test/download.php on line 16`

`Notice: Use of undefined constant __DIR__ - assumed '__DIR__' in /home/inspire/public_html/brooksmemories.com/test/download.php on line 16`

我不确定如何纠正这些错误以使其正常工作。任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:35:36.060

检查您的 PHP 版本...`__DIR__`是仅在 PHP 5.3+ 中可用的新常量，在旧版本的 PHP 中实现相同的方法是：`dirname(__FILE__)`代替`__DIR__`

可以使用 php.ini 条目来修复时区消息：

```
;approx line 1005
[Date]
date.timezone = "America/Chicago"; 
```

或者通过添加[`date_default_timezone_set`](http://ca.php.net/date_default_timezone_set)到 PHP 文档的顶部：

```
<?php
date_default_timezone_set('America/Chicago');
//... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:33:36.887

第一个警告是关于某些日期功能的使用。在这种情况下，我认为警告本身会激活它（它将它存储在日志中）。服务器警告更重要，它提到了未定义的魔术常量`__DIR__`（当前脚本目录）的使用。它是在 PHP 5.3 中引入的。

所以，你有两个选择。

1.  更新到 PHP~~5.3~~5.4
2.  替换`__DIR__`为`dirname(__FILE__)`。

# gwt - GWT 列关闭自动换行

> ID：10355221
> 
> 赞同：1
> 
> 时间：2012-04-27T17:29:13.597
> 
> 标签：gwt, formatting, word-wrap

我正在使用具有多个列的 Gwt DataGrid。列的默认行为是自动换行。我希望其中一列不自动换行而只是切断。这可能吗？

例如，当前显示的是：

```
I am making a
sandwich 
```

我希望它显示：

```
I am making a 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T14:06:56.183

除了`overflow:hidden`您可能需要`white-space:nowrap`并最终添加一个`text-overflow: ellipsis`，因此向用户显示不完整文本的指示符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T21:11:59.387

您可以设置`overflow: hidden`每个列的样式。

您可以使用`DataGrid.addColumnStyleName`在单个列上设置样式，或者只是`addStyleName`将样式添加到整个小部件。

# android - 在android中放置/重叠（z-index）

> ID：10355225
> 
> 赞同：0
> 
> 时间：2012-04-27T17:29:34.000
> 
> 标签：android, z-index, overlapping

我想将布局作为第一个屏幕截图。 [（来源：][[nocookie.net](https://images1.wikia.nocookie.net/__cb20090901163013/uncyclopedia/images/e/eb/Blank.jpg)][）][![需要](../Images/22c43dc0e1224e4284ed5058b304311e.png)](https://i.stack.imgur.com/OepDC.jpg)

我试图这样做，但结果如第二张截图 所示[（来源：][[nocookie.net](https://images1.wikia.nocookie.net/__cb20090901163013/uncyclopedia/images/e/eb/Blank.jpg)][）][![有](../Images/0dbc9e9f65b84718ca78733f7bdc4a67.png)](https://i.stack.imgur.com/hxzvj.jpg)

这是我的布局

```
<?xml version="1.0" encoding="utf-8"?> 
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content" 
    android:gravity="center" 
    android:orientation="vertical" 
    android:padding="20dip" > 

    <LinearLayout 
        android:layout_width="wrap_content" 
        android:layout_height="0dip" 
        android:layout_weight="1" 
        android:background="@color/red" 
        android:orientation="vertical" 
        android:paddingBottom="40dip" 
        android:paddingLeft="10dip" 
        android:paddingRight="10dip" 
        android:paddingTop="10dip" > 

        <LinearLayout 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content" 
            android:background="@color/black" 
            android:gravity="center_vertical" > 

            <ScrollView 
                android:layout_width="wrap_content" 
                android:layout_height="wrap_content" 
                android:layout_marginLeft="-20dip"  > 

                <TextView 
                    android:id="@+id/textView1" 
                    android:layout_width="wrap_content" 
                    android:layout_height="wrap_content" 
                    android:layout_gravity="center" 
                    android:gravity="center" 
                    android:text="lololo"  /> 
            </ScrollView> 

            <ImageView 
                android:id="@+id/lady" 
                android:layout_width="wrap_content" 
                android:layout_height="wrap_content" 
                android:src="@drawable/temp" /> 
        </LinearLayout> 
    </LinearLayout> 

    <LinearLayout 
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content" 
        android:layout_marginTop="-20dip" 
        android:gravity="center" > 

        <Button 
            android:id="@+id/button1" 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content" 
            android:background="@drawable/button_left" 
            android:text="next" /> 

        <Button 
            android:id="@+id/button2" 
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content" 
            android:background="@drawable/button_right" 
            android:text="prev" /> 
    </LinearLayout> 

</LinearLayout> 
```

我想知道我们如何将一个视图放在另一个视图之上，并具有不同的 z-index？我想知道我们如何将一个视图放在另一个视图之上，并具有不同的 z-index？我想知道我们如何将一个视图放在另一个视图之上，并具有不同的 z-index？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T23:19:54.663

使用`RelativeLayout`.

您可以使用此示例：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="200dp"
    android:layout_height="200dp"
    android:orientation="vertical"
    android:padding="10dp" >

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <!-- Bottom layer -->
        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_alignParentLeft="true"
            android:layout_alignParentTop="true"
            android:layout_margin="20dp"
            android:background="#DDDDDD" >

            <!-- Other views -->
        </LinearLayout>

        <!-- Top layer -->
        <LinearLayout
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:layout_alignParentLeft="true"
            android:layout_alignParentTop="true"
            android:background="#F0AB00" >

            <!-- Other views -->
        </LinearLayout>
    </RelativeLayout>

</LinearLayout> 
```

它看起来像这样：

![在此处输入图像描述](../Images/4afa915c53645f8e74c2c248bf29e44c.png)

如图所示，小矩形位于大（灰色）矩形的上方。这可以通过将视图一个接一个地添加到 RelativeLayout 中来实现（它们之间没有引用）。

问候

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:50:28.440

使用 RelativeLayour 并重新设计您的布局....

你会得到你想要的完美结果..

RelativeLayour 允许您轻松完成这样的事情......

# javascript - 同步，如何确保执行谷歌分析跟踪请求

> ID：10355228
> 
> 赞同：4
> 
> 时间：2012-04-27T17:29:46.780
> 
> 标签：javascript, jquery, google-analytics, click-tracking

假设我需要使用谷歌分析脚本来跟踪我的点击。我知道确保触发跟踪事件的标准方法是将延续传递到跟踪队列并从单击事件处理程序返回 false，如下所示：

```
 $('a').click(function () {
    var url = $(this).attr('href');
    _gaq.push(['_trackEvent', smth]);
    _gaq.push(function(){ document.location = url ;}
    return false;
}); 
```

我的挑战是我想在新标签中打开这个链接。
我的完美解决方案是 target="_blank"，但你不能用 javascript 来做。
window.open(url,'_blank') 将在除火狐之外的所有浏览器中弹出新窗口，并且默认情况下通常会阻止此窗口。
这意味着我必须从点击处理程序**返回 true 。**

所以这就是我需要以某种方式同步等待 ga 脚本请求它的跟踪像素这一事实背后的原因。是某种[什么是 sleep() 的 JavaScript 版本？](https://stackoverflow.com/questions/951021/javascript-sleep)功能可以帮助我吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T17:35:57.953

您要确保在访问者被带到新页面之前触发跟踪像素的唯一原因是链接将您带到*同一窗口*中的新页面。换句话说，您要确保跟踪代码在当前窗口被卸载之前完成它的工作。

如果您的链接正在打开一个新窗口...无论您如何打开新窗口...您不必担心这种事情，因为您当前的窗口没有被卸载。

# javascript - 摆脱评估

> ID：10355230
> 
> 赞同：0
> 
> 时间：2012-04-27T17:30:14.737
> 
> 标签：javascript, eval, google-closure-compiler

我有一个方法的名称作为 javascript 变量中的字符串，我想得到它调用变量的结果：

```
var myMethod = "methodToBeCalled";
var result;
eval("result = "+myMethod+"();") 
```

这有效，没有问题。但是这个代码对于 Google Closure Compiler 是不可接受的。如何修改它以使用它？谢谢！

编辑：

当方法的名称在某个对象内部时，建议的解决方案似乎不起作用，例如：

```
var myFunction = function () { return "foo!" }
var myObject = {
    itsMethod: function() { return "foo!" }
};
...
var fstMethodToCall = "myFunction"
var sndMethodToCall = "myObject.itsMethod";
...
window[fstMethodToCall](); // foo!
window[sndMethodToCall](); // undefined 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:31:15.903

假设您不在某种嵌套范围内，请尝试：

```
var result = window['methodToBeCalled'](); 
```

或者

```
var myMethod = 'methodToBeCalled';
var result = window[myMethod](); 
```

要根据字符串规范执行任意深度的任意函数，而不执行 eval：

```
var SomeObject = {
    level1: {
        level2: {
            someFunc: function () {
                console.log('hello');
            }
        }
    }
};

var target = 'SomeObject.level1.level2.someFunc';

var obj;
var split = target.split('.');
for (var i = 0; i < split.length; i++) {
    obj = (obj || window)[split[i]];
}

obj(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T17:31:31.953

您可以使用索引器表示法：

```
result = window[myMethod](); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T15:34:27.747

闭包编译器不禁止'eval'，如果你觉得方便，你可以继续使用它，但你必须明白编译器不会试图理解你的eval语句中发生的事情，并假设你的eval是“安全的”：

```
function f(x, y) {
  alert(eval("y")); // fails: hidden reference to "y"
  alert(eval('"'+x+'"'));   // might be valid
}
f('me', 'you'); 
```

当编译器优化此函数时，它会尝试删除“y”并重命名剩余参数。这将是第一个失败的评估，因为“y”不再存在。第二个评估将正确显示警报“我”。

因此，通过 SIMPLE 优化，您可以使用 eval 来引用全局变量和对象属性，因为它们不会被重命名或删除（但不是本地的）。

使用高级优化，它有点棘手，因为编译器试图删除和重命名全局变量和局部变量。因此，您需要导出需要保留的值。如果您使用字符串尝试通过其他方式引用名称，这也是正确的：

```
var methodName = "myMethod";
(window[methodName])() 
```

或者

```
var methodName = "myMethod";
eval(methodName+"()") 
```

编译器根本不会尝试确定“methodName”是否是对函数的引用。这是一个高级模式导出的简单示例：

```
window['myMethod'] = myMethod; 
```

该赋值做了两件事：如果 myMethod 函数将被删除，它会保留它，并且通过使用字符串将其分配给属性来为其提供固定名称。如果确实需要引用本地值，则需要稍微复杂一点并使用 Function 构造函数。我的第一个示例中的“f”定义，可以评估本地人：

```
var f = new Function("x", "y", "alert(eval('y')); alert(eval('\"' + x + '\"'));"); 
```

您可能会发现此页面很有用：

[https://developers.google.com/closure/compiler/docs/limitations](https://developers.google.com/closure/compiler/docs/limitations)

# silverlight - WCF 数据服务和 Silverlight：DataServiceQuery 不会重新执行查询

> ID：10355232
> 
> 赞同：0
> 
> 时间：2012-04-27T17:30:32.507
> 
> 标签：silverlight, entity-framework, wcf-data-services

使用 Silverlight 4、Oracle 11g 和实体框架 4。

我使用 DataServiceQuery 来填充 DataGrid。然后，一些本地（非 EF）代码更新数据库。我想使用相同的查询来用更新/新数据刷新 DataGrid。问题是，当我这样做时，它会返回旧的原始结果。我已经验证了这些更改实际上已在此代码运行之前提交到数据库：

```
DataServiceContext<T> dsContext= new DataServiceContext<T>(uri);
dsContext.MergeOption = MergeOption.NoTracking;
dsContext.SaveChangesDefaultOptions = SaveChangesOptions.ReplaceOnUpdate;
DataServiceQuery<T> dsQuery = dsContext.CreateQuery<T>(typeof(T).Name);
// oldQuery is an IQueryable<T>
dsQuery = (DataServiceQuery<T>)oldQuery;

var dsQuery = (DataServiceQuery<T>)oldQuery;
dsQuery.BeginExecute(new AsyncCallback(c =>
   {
      IEnumerable<T> result = dsQuery.EndExecute(c);
      listSelectedRecord = new List<T>();
      listSelectedRecord = result.ToList();
   }), dsQuery); 
```

据我所知，新`dsQuery`的甚至没有被发送到 Oracle 服务器，即使`DataServiceContext`正在创建一个新的。它显然发现它在某处有一个缓存副本。如果我在浏览器中输入查询，它会返回更新的结果。

关于如何强制 DS 重新执行查询的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:40:54.930

分配`oldQuery`给新实例化的`dsQuery`对象显然会从某处复制缓存的结果。我在这里使用的解决方案是替换

```
 dsQuery = (DataServiceQuery<T>)oldQuery; 
```

和

```
dsQuery = (DataServiceQuery<T>)(dsQuery.Provider.CreateQuery<T>(oldQuery.Expression)); 
```

我仍然想准确了解这些结果的缓存位置、原因和方式。文档对此`DataServiceQuery<T>`只字未提：

[http://msdn.microsoft.com/en-us/library/cc646574(v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/cc646574(v=vs.95).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-08T21:38:01.250

这个问题的惊人答案似乎可以在这里找到：

[Silverlight 是否缓存 Web 服务调用？](https://stackoverflow.com/questions/3857379/does-silverlight-cache-web-service-calls)

和

[https://connect.microsoft.com/VisualStudio/feedback/details/340931/silverlight-webclient-does-not-download-updated-resources](https://connect.microsoft.com/VisualStudio/feedback/details/340931/silverlight-webclient-does-not-download-updated-resources)

似乎存在某种模糊的共识，即 SLx 确实依赖于*浏览器*`DataService`缓存，而不是您从、`DataServiceContext`或`DataServiceQuery`docs 中 知道这一点。

**因此，至少在 IE 8 中，最简单的解决方法是关闭浏览器缓存。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T08:16:31.537

如果在调试时看到此行为，您可以尝试删除 .suo 文件。

# php - OAuth API 调用参数不具体

> ID：10355233
> 
> 赞同：0
> 
> 时间：2012-04-27T17:30:36.577
> 
> 标签：php, api, oauth, freelancer.com-api

我最近第一次使用 OAuth，我已经获得了访问令牌以及之前的所有内容，但我偶然发现了我认为最简单的部分:(

API调用需要一个不是很具体的参数，他们只是称之为'oauth'。我已经将我的访问令牌和秘密放入签名中，'oauth' 参数中应该包含什么？

[这](http://developer.freelancer.com/GetInboxMessages)就是我要说的。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:37:47.673

对于 oAuth 1.0 (Twitter) oAuth HTTP 标头可能如下所示：

```
Authorization: OAuth oauth_consumer_key="*****", oauth_nonce="fcde5bfc94d489c307f59aa384df9ef3", oauth_signature="tWE9gf3Dw0rBiKkN%2BcgO%2Fz%2FE%2FjA%3D", oauth_signature_method="HMAC-SHA1", oauth_timestamp="1335428402", oauth_token="*****", oauth_version="1.0" 
```

# javascript - 编写由一个人控制的棋盘游戏的最佳方法是什么？

> ID：10355234
> 
> 赞同：0
> 
> 时间：2012-04-27T17:30:38.570
> 
> 标签：javascript, html, programming-languages

我爸爸想让我编写一个棋盘游戏。该棋盘游戏将在课堂环境中使用，教师将在课堂上控制棋盘游戏。因此，如果学生答对了问题，老师就会按下其中一个按钮，棋盘游戏就会继续进行。

游戏状态还必须可以保存为教师可以保存在 USB 驱动器上的文件。

对我来说，后端听起来非常简单，包括将数据存储在文件中。在我看来，我不需要这么简单的数据库。

但是，我更关心前端，以及一般使用哪种编程语言。从我从他需要运行它的计算机中看出，它们都在运行 Windows 7。我确实拥有所需的所有图形。它基本上是以线性方式从一个方格移动到下一个方格的棋子，每个棋子都有自己的路径。

现在，我正在考虑用 HTML5/JS 做它，但我担心计算机不支持它。我爸爸正在研究它，包括他们是否可以在计算机上安装 Chrome。我相信这将是理想的，因为他还表示对 iPad 版本感兴趣，该版本可以作为网页使用。

但是如果这些电脑不支持 HTML5/JS，或者你更有经验的人告诉我 HTML5/JS 将是一个糟糕的选择，你会为这个项目推荐什么？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:45:32.933

您可能需要考虑 Adob​​e Flash。它使用 Flash 插件发布到 Web，并作为 Adob​​e AIR 应用程序发布到 Windows、Mac OS、Android 和 iOS。此外，如果您想包含声音和视频或动画，它对动画和媒体的处理非常好。

如果您不想从 adobe 购买 Flash，您可以使用其他工具（例如 Stencyl）至少部分发布它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:38:07.793

考虑到您对图形的要求，您甚至不需要 HTML5 高级功能，而且浏览器已经使用 CSS2/HTML4 支持了十年的所有功能都可以正常工作。将状态保存简化为仅输出序列化转储以供用户复制或生成`data:`URL 以供下载，甚至是`prompt`'ing 序列化保存数据，您将拥有几乎可以在任何具有浏览器的任何东西上运行的代码。

# firefox - CSS3 转换（挂钩到 JS 类更改）在 FF 中不起作用

> ID：10355235
> 
> 赞同：0
> 
> 时间：2012-04-27T17:30:42.240
> 
> 标签：firefox, css, transitions

每当某些 JavaScript 将包含元素的类名更改为包含“活动”时，我设置了一个 CSS3 转换以在 h1 元素上触发。为此，我有两个 CSS 声明：

```
#idname .classname h1 {
    opacity: 0;
    left: -1.25em;
    z-index: 3;
    position: relative;
} 
```

其次是：

```
#idname .classname.active h1 {
    opacity: 1;
    left: 0; 
    -webkit-transition : all 4s ease;
    -moz-transition    : all 4s ease;
    -ms-transition     : all 4s ease;
    -o-transition      : all 4s ease;
    transition         : all 4s ease;
} 
```

这在 webkit 浏览器中运行良好，但在 Firefox 中似乎失败了。我怀疑这与我如何根据类名更改触发有关，尽管我可能是错的。Firefox 不允许您这样做吗？有没有人有一个好的解决方法？提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-26T02:23:58.367

我的问题通过在向 DOM 添加内容和添加特定类名以触发动画之间添加轻微延迟来解决。20 毫秒足够我让它在 Firefox 中运行。

# java - 使用 Maven 构建多架构 SWT 应用程序

> ID：10355237
> 
> 赞同：11
> 
> 时间：2012-04-27T17:30:48.017
> 
> 标签：java, eclipse, maven, swt

我已经为 SWT 应用程序设置了一个 Maven 项目。此应用程序在多个平台（OS X、Windows 64 位、Windows 32 位、Linux 64 位和 Linux 32 位）上运行，我已对其进行设置，以便在运行 Maven 并打包时检测到平台应用程序转到不同的目标目录。以下是 pom.xml 中实现此目的的相关部分：

```
<profiles>
  <profile>
    <id>linux_x86_64</id>
    <activation>
      <os>
        <name>linux</name>
        <arch>amd64</arch>
      </os>
    </activation>
    <build>
      <directory>${project.basedir}/target/${project.version}/linux_x86_64</directory>
    </build>
  </profile>

  <profile>
    <id>win32_x86_64</id>
    <activation>
      <os>
        <name>linux</name>
        <arch>i386</arch>
      </os>
    </activation>
    <build>
      <directory>${project.basedir}/target/${project.version}/win32_x86_64</directory>
    </build>
    </profile>
  ...
</profiles> 
```

用于 SWT 的依赖是这样的：

```
<dependencies>
  <dependency>
    <groupId>org.eclipse</groupId>
    <artifactId>swt</artifactId>
    <version>3.7.2.v3740</version>
  </dependency>
...
</dependencies> 
```

为了清楚起见，我在本地存储库中安装了 SWT 虚拟包（org.eclipse.swt_3.7.2.v3740f.jar）和*所有*特定于平台的包（org.eclipse.swt.gtk.linux.x86_64_3.7.2 .v3740f、org.eclipse.swt.win32.x86_64_3.7.2.v3740f 等）。

我打包依赖项的方式是使用 maven-dependency-plugin 的“lib”文件夹，Maven 足够聪明，可以复制 SWT 虚拟包和我打包应用程序的特定平台机器。到目前为止，一切都很好...

问题是我想从一台机器上为不同平台编译应用程序。我将如何实现这一目标？

我尝试使用每个平台所需的 SWT jar 在每个配置文件中设置一个属性，如下所示（Windows 64 位的示例）：

```
<properties>
  <swt.artifactId>swt.win32.x86_64</swt.artifactId>
  <swt.version>3.7.2</swt.version>
</properties> 
```

但是采用这种方法，特定于配置文件的 SWT jar*和*我正在运行 Maven 的特定于平台的 jar 都被复制到“lib”目录中，最终得到三个 jar：

*   swt-3.7.2.v3740.jar
*   swt.gtk.linux.x86_64-3.7.2.jar
*   swt.win32.x86_64-3.7.2.jar

有没有一种方法可以指定一个配置文件而忽略我正在运行它的机器，这样我就不需要手动删除它的 SWT jar？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T20:29:08.550

不确定依赖插件如何处理它，但如果你只有一个这样的依赖项，它应该可以工作：

```
 <dependency>
        <groupId>${swt.groupId}</groupId>
        <artifactId>${swt.artifactId}</artifactId>
        <version>3.7.2</version>
        <scope>compile</scope>
    </dependency> 
```

然后像这样的配置文件：

```
<profile>
  <id>gtk_linux_x86_64</id>
  <activation>
    <os>
      <name>linux</name>
      <arch>x86_64</arch>
    </os>
  </activation>
  <properties>
    <swt.groupId>org.eclipse.swt.gtk.linux</swt.groupId>
    <swt.artifactId>x86_64</swt.artifactId>
  </properties>
</profile> 
```

现在，所需的 SWT 版本会自动使用，但也可以设置为您需要的版本（例如，在构建版本时），也可以使用：

`mvn -P gtk_linux_x86_64`

注意：根据需要更改您的 groupId 和 artifactId。

# iphone - 在 iPhone 项目中使用编译资源而不是源文件

> ID：10355238
> 
> 赞同：0
> 
> 时间：2012-04-27T17:30:48.563
> 
> 标签：iphone, xcode

当我必须使用第三方代码（例如：three20）时，我通常将源代码导入我的 iPhone XCode 项目。有没有办法导入已编译的库（仅一个文件）而不是导入所有源文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:38:28.747

您可以使用静态库。你可以参考这篇文章（XCode 3.X）的例子：

[http://blog.stormyprods.com/2008/11/using-static-libraries-with-iphone-sdk.html](http://blog.stormyprods.com/2008/11/using-static-libraries-with-iphone-sdk.html)

它不仅解释了如何使用该库，还解释了如何自己制作一个。

这是一个（也许更好），但在 XCode 4 中显示相同：

[http://blog.carbonfive.com/2011/04/04/using-open-source-static-libraries-in-xcode-4/#using_a_static_library](http://blog.carbonfive.com/2011/04/04/using-open-source-static-libraries-in-xcode-4/#using_a_static_library)

# wordpress - 在wordpress中制作登录表单

> ID：10355242
> 
> 赞同：0
> 
> 时间：2012-04-27T17:31:20.023
> 
> 标签：wordpress, wordpress-login

我用这个链接做了一个登录表单[http://wplift.com/how-to-create-a-custom-login-page-for-your-wordpress-theme](http://wplift.com/how-to-create-a-custom-login-page-for-your-wordpress-theme)

当我登录时，它会重定向到个人资料页面，但我想与用户会话保持在同一页面上！是否可以？

我有 PHP 知识，但这是我第一次使用 wordpress，我不习惯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T21:05:07.957

有几个很好的登录重定向插件可以设置为将用户（例如基于角色）返回到推荐页面或预定页面，而不是仪表板。

这是我用过几次的，它有一些很棒的选择

[http://wordpress.org/extend/plugins/peters-login-redirect/](http://wordpress.org/extend/plugins/peters-login-redirect/)

# javascript - jHtmlArea "enter" 键生成的 HTML 不跨浏览器

> ID：10355253
> 
> 赞同：1
> 
> 时间：2012-04-27T17:32:35.657
> 
> 标签：javascript, jquery, asp.net, jhtmlarea

我正在尝试使用基于 jQuery 的 jHtmlArea WYSIWYG 编辑器。

我的问题是编辑器对“输入键”的行为因浏览器而异，例如，IE 呈现**p**标签，Chrome 呈现**div**标签，Firefox 呈现**br**标签。

这是什么原因造成的？我怎样才能使它保持一致？

谢谢。

# oracle10g - oracle中组内的行数

> ID：10355257
> 
> 赞同：0
> 
> 时间：2012-04-27T17:33:13.607
> 
> 标签：oracle10g

为了在 ireport 中生成报告，我需要在 oracle 10g 中进行此查询。

学校：

```
SELECT STID,NAME,DEPT,SUM(CHARGE)

STID | PROG  | DEPT | CHARGE
1      1        A      1
2      1        B      2
3      2        A      2
4      2        B      1
5      1        A      2 
```

所需的输出：

```
DEPT | PROG | NBER_OF_STID | TOT_CHG
A       1       2             3
        2       1             2
B       1       1             2
        2       1             1 
```

这是我的查询

```
SELECT DISTINCT DEPT, DISTINCT PROG, COUNT(STID), SUM (CHARGE) TOT_CHG
FROM SCHOOL
GROUP BY DEPT, PROG, STID, CHARGE 
```

帮助 谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T09:39:47.940

您只需`group by`要不聚合的列。
试试这个：

```
SELECT DEPT, PROG, COUNT(STID) NBER_OF_STID, SUM (CHARGE) TOT_CHG
FROM SCHOOL
GROUP BY DEPT, PROG 
```

注意：在您的查询中，您将始终获得表格视图，因此结果将如下所示：

```
DEPT | PROG | NBER_OF_STID | TOT_CHG
A       1       2             3
A       2       1             2
B       1       1             2
B       2       1             1 
```

恕我直言，视觉格式应该在报告本身（ireport）中进行

# jquery - “on”不绑定到动态添加的元素

> ID：10355258
> 
> 赞同：6
> 
> 时间：2012-04-27T17:33:21.330
> 
> 标签：jquery

我的 HTML

```
<div>    
    <span  class="more-available" data-completeMessage="This is the complete message you see after clicking more">Hello</span>​
</div> 
```

我动态地在末尾添加了一个锚标记，然后想将一个点击处理程序附加到锚标记。所以我这样做

```
$(document).ready(function() {

   //Attach future proof click event to an anchor tag
   $('a.more').on('click', function() {
      var $parent = $(this).parent();
      $parent.text($parent.data('completemessage'));
   });

   //Add the anchor tag
   $('span.more-available').append($('<a class="more">...more</a>'));
});;​ 
```

这不起作用。**如果我用“live”替换“on”，它就可以工作**。（但活是折旧的）

我知道我能做到

```
$(document).ready(function() {

    $('div').on('click','a.more', function() {
        var $parent = $(this).parent();
        $parent.text($parent.data('completemessage'));
    });

    $('span.more-available').append($('<a class="more">...more</a>'));
});;​ 
```

它有效，但我的问题是......

假设“on”提供了live的所有功能，我错了吗？“on”不会绑定到未来的元素吗？这是正确的行为，还是我做错了什么。

小提琴：http: [//jsfiddle.net/arishlabroo/pRBke/5/](http://jsfiddle.net/arishlabroo/pRBke/5/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-27T17:35:41.317

`on()`只是一个允许目标委托的活页夹。它更像是替代 for`delegate()`而不是 for `live()`。

`$('foo').live('click',fn);`本质上是`$(document).on('click','foo',fn);`

考虑到这一点，您只需将 click 事件绑定到常量父包装器并委托给您的目标，如下所示：

```
$('span.more-available').on('click', 'a.more', function(){
    var $parent = $(this).parent();
    $parent.text($parent.data('completemessage'));
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T17:35:43.990

像下面这样使用它，

```
$('span.more-available').on('click', 'a.more', function () {
   //..your code
}); 
```

您不能只替换替换`.live`，`.on`而是需要将处理程序绑定到具有特定选择器的父元素，这意味着当匹配选择器触发事件​​时，将委托句柄。在上面，您正在添加一个侦听器，仅当触发`span.more-available`匹配的选择器时才会执行处理程序。`a.more`

简而言之，请按照两个步骤替换`.live`为`.on`,

1.  查找要动态添加元素的最近的父元素。
2.  使用动态元素选择器作为第二个参数将处理程序绑定到父元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T17:39:55.747

根据该方法的 jQuery[文档](http://api.jquery.com/live/)`$.live()`：

> 从 jQuery 1.7 开始，不推荐使用 .live() 方法。使用 .on() 附加事件处理程序。旧版本 jQuery 的用户应该使用 .delegate() 而不是 .live()。

进一步的文档`$.live()`向我们展示了用于此方法的后续方法的方法和语法：

> 根据其继承者重写 .live() 方法很简单；这些是对所有三种事件附件方法进行等效调用的模板：

```
$(selector).live(events, data, handler);                // jQuery 1.3+
$(document).delegate(selector, events, data, handler);  // jQuery 1.4.3+
$(document).on(events, selector, data, handler);        // jQuery 1.7+ 
```

如果您使用的是 jQuery 1.7 或更高版本，请使用上述`$.on()`方法。

# jquery - jquery循环同步在淡出时不淡入内容

> ID：10355261
> 
> 赞同：2
> 
> 时间：2012-04-27T17:33:29.227
> 
> 标签：jquery, jquery-cycle

因此，我对淡入/淡出同步的解释是，当第一张图像开始淡出时，第二张图像开始淡入，但是在我的脚本中，在下一张图像开始淡入之前，我有大约一秒钟的空白，这是由于。

```
 $(function(){
            $('#up').cycle({
                fx:    'fade',
                sync:  true,
                delay: -2000
             });
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:35:34.237

我不确定问题是什么。`sync`应该按照你说的去做。此外，您真的根本不需要`sync: true`，因为它是默认设置。如果可能，请发布一个 jsfiddle。

但首先尝试设置`fx: 'fadeout'`。看：

[http://jquery.malsup.com/cycle/fadeout.html](http://jquery.malsup.com/cycle/fadeout.html)

和

[https://github.com/malsup/cycle/commit/f769b0fabe925b6cf8b4b5197b8c868ceb0c9261](https://github.com/malsup/cycle/commit/f769b0fabe925b6cf8b4b5197b8c868ceb0c9261)

这会淡出“顶部”图像以在所有情况下显示下方的“底部”图像，因此永远不会有您所谓的“空白空间”。（Alsup 是一个超级英雄，但必须说`fx`文档中没有很好地解释各种设置。）要理解的是，脚本是用一个线程为两个元素（通常是图像）设置动画。因此，例如，如果您使用默认`fx`设置（即 ）`fade`，并且在白色背景上放置了两张深色图像，您将在每个幻灯片过渡的中点看到令人讨厌的背景显示。（就我个人而言，我在日常使用中对所有内容都使用“淡出”。恕我直言，它确实应该是默认设置`fx`。）

最后，要明白这`delay`只会影响第一次过渡的时间。它对后续的转换没有影响。

# php - 从包含相同名称的对象数组中删除元素

> ID：10355264
> 
> 赞同：0
> 
> 时间：2012-04-27T17:33:52.430
> 
> 标签：php, arrays, algorithm

如何从具有相同名称的对象数组中删除元素？在下面的情况下，我想删除元素 0 和 2，因为名称相同。我想我可以遍历每个案例，但这似乎很浪费。

```
array(1) { 
 [0]=> object(stdClass)#268 (3) { 
         ["term_id"]=> string(3) "486" 
         ["name"]=> string(4) "2012" 
         ["count"]=> string(2) "40"
 } 
 [1]=> object(stdClass)#271 (3) { 
         ["term_id"]=> string(3) "488" 
         ["name"]=> string(8) "One more"
         ["count"]=> string(2) "20"  
 } 
 [2]=> object(stdClass)#275 (3) { 
         ["term_id"]=> string(3) "512" 
         ["name"]=> string(8) "2012"
         ["count"]=> string(2) "50"  
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:39:25.503

如果它是您可以修改的类的对象，您可以让该`__toString()`方法返回`name`属性并使用[`array_unique()`](http://php.net/manual/en/function.array-unique.php)：

> 当且仅当 (string) $elem1 === (string) $elem2 时，才认为两个元素相等。换句话说：当字符串表示相同时。将使用第一个元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T17:44:15.010

您可以遍历数组，计算每个名称出现的次数。[然后使用array_filter](http://php.net/array_filter)过滤掉那些多次出现的元素。与天真的情况相比，这将具有`O(n)`（假设为数组）的平均运行时复杂度。`O(1)``O(n^2)`

代码：

```
$counter = array();
foreach($array as $val) {
  $n = $val->name;
  $counter[$n] = (!isset($counter[$n])) ? 1 : 2;
}
$result = array_filter(
            $array,
            function ($item) use ($counter) { return $counter[$item->name] == 1; }
          ); 
```

对于 5.3 之前的 PHP 版本，您不能使用闭包，因此在这种情况下，请将您的代码修改为：

```
$counter = array();
foreach($array as $val) {
  $n = $val->name;
  $counter[$n] = (!isset($counter[$n])) ? 1 : 2;
}

function my_filter($item) {
    global $counter;
    return $counter[$item->name] == 1;
}
$result = array_filter(
            $array,
            'my_filter'
          ); 
```

请注意，这仅在实际中对大型数组有用，因为涉及一些开销。如果您不了解正在执行的操作，也可能难以阅读。对于小型数组（大约几百个元素），我建议您使用朴素的二次时间循环方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T17:37:19.380

```
$result = array_filter(
  $array,
  function ($item) use ($name) { return $item->name != $name; }
); 
```

请注意，这正是您提到的“遍历每个案例”。如果您想检查每个项目，没有其他解决方案。

# json - spring mvc rest，json和xml输出包含包名

> ID：10355266
> 
> 赞同：0
> 
> 时间：2012-04-27T17:33:57.313
> 
> 标签：json, spring-mvc, xml-serialization

我们需要支持对象的 XML 和 JSON 输出，我有一个以 json 和 xml 格式显示的列表，我面临的问题是它还显示了底层类，下面我显示了以输出
域开头的所有代码部分对象配置和控制器

```
**XML Output**

    "<**com.bookstore.Books**> Unwanted
    <books>
    <com.bookstore.Book>
    <name>book0</name>
    </com.bookstore.Book>
    <com.bookstore.Book>
    <name>book1</name>
    </com.bookstore.Book>
    </books>
    </com.bookstore.Books>" 

    **JSON Output** Unwanted part is in bold

    **"org.springframework.validation.BindingResult.books**" 
    :[{"isbn":"03601","authors":[{"autho

    I have defind book class as
    @XStreamAlias("book")
    public class Book {....}
    and Books
    @XStreamAlias("books")
    public class Books {...

List<Book> books; 
```

**上下文设置是这样的**

```
 <beans:bean id="xmlView"
      class="org.springframework.web.servlet.view.xml.MarshallingView">
      <beans:constructor-arg>
         <beans:bean class="org.springframework.oxm.xstream.XStreamMarshaller">
            <beans:property name="autodetectAnnotations" value="true"/>
         </beans:bean>
      </beans:constructor-arg>
   </beans:bean>
   <beans:bean id="jsonView"
      class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
   </beans:bean> 
   <beans:bean id="jsonConverter" class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter">
   </beans:bean> 
```

**控制器部分是：**

```
 @RequestMapping(value = "/books/xml")
        public ModelAndView getAllBooksXML() {
            List<Book> books = bookService.getAllBooks();
            ModelAndView mav = 
                new ModelAndView("xmlView", BindingResult.MODEL_KEY_PREFIX + "books", books);
            return mav;
        }

    @RequestMapping(value = "/books/json")
        public ModelAndView getAllBooksJson() {
            List<Book> books = bookService.getAllBooks();
            ModelAndView mav = 
                new ModelAndView("jsonView", BindingResult.MODEL_KEY_PREFIX + "books", books);
            return mav;
        }

Please let me know otherwie i will have t 
```

我写了一个自定义转换器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T12:15:35.010

您提供的代码似乎使用 XStream 注释，而您的 spring 配置配置为使用 jackson。

你试过jackson支持的注解吗？ [https://github.com/FasterXML/jackson-annotations/wiki/JacksonAnnotations](https://github.com/FasterXML/jackson-annotations/wiki/JacksonAnnotations)

# android - Eclipse/adb 经常与我的设备断开连接

> ID：10355268
> 
> 赞同：30
> 
> 时间：2012-04-27T17:34:04.567
> 
> 标签：android

在调试时，我的设备经常与我的 PC 断开连接，通常是在每次调试会话之后。该设备仍出现在 DDMS 列表中，但状态为“离线”。修复它的唯一方法是重新连接 USB 线，每小时连接 10 次后会变得很痛苦。发生时没有可见的错误消息。

我认为这是我的 USB 线或设备的物理连接问题，但我最近使用全新的 USB 线升级到全新的 Galaxy Nexus，但它仍然发生。现在我确信这是一个软件问题。

我的设备经常离线有什么原因吗？是否有任何已知会干扰 Android/ADB 连接的程序？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-27T17:46:21.427

是的，你是对的。这似乎是一个软件问题。我多次遇到这个烦人的事情，它时不时发生。我认为发生的情况是 adb 与设备/模拟器的连接中断或出现故障，因此 android 开始将设备显示为**脱机**。

要纠正这个问题。转到**DDMS--> 设备选项卡--> 单击选项“重置 adb”**（这是最后一个选项，单击下拉箭头）。然后，您将在控制台中看到一些错误报告，但一分钟后，您的模拟器就可以毫无问题地使用了。我一直都这样做，而且效果很好。试试这个，而不是手动插入/拔出设备。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-01-23T18:27:15.973

请检查此答案[https://stackoverflow.com/a/26425489/1200583](https://stackoverflow.com/a/26425489/1200583)适用于 mac，但对于其他操作系统可能相同

![在此处输入图像描述](../Images/aff7ade8c3b1ae3f7eaec76d3f9cf2a8.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-27T17:48:57.313

我发现插入/拔出更快，但是在命令行中执行以下操作应该做同样的事情：

```
adb kill-server
adb start-server 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T17:49:44.343

我们感受到你的痛苦。如果你使用命令行，你可以通过输入“adb kill-server”来做同样的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-22T19:49:42.983

我可以通过更新三星 Kies 来彻底解决这个问题，它为我的手机安装了更新的驱动程序。我建议您尝试重新安装任何设备驱动程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-25T04:34:36.710

耐心地尝试通过按摩 USB 线并将其重新连接到 USB 集线器，但不要太紧。另外，不要连接太多的 USB 延长线或集线器，否则设备与 Eclipse IDE 之间的连接会干扰持续时间。

还有一件事，是否尝试将您的设备和 USB 线放在任何平面（例如桌子）以支持长电缆？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-09T15:27:52.540

我在运行 CM 10.1 的 Galaxy Nexus 上遇到了同样的问题。

用最新版本更新 KIES 似乎已经解决了这个问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-23T10:49:57.913

我也遇到过这个问题。每次从 Eclipse 将应用程序安装到 android 设备后，adb 都会断开我的 Android 设备。问题出在我的 USB 电缆上。我使用的是黑莓手机的 USB 数据线。为了解决这个问题，我刚刚用 Android 的 USB 电缆（新 Android 手机随附的电缆）更换了 USB 电缆，一切都开始正常工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-09-15T06:50:12.427

通过有源 USB 集线器连接您的设备。有些机器，包括新的苹果 macbook，USB 端口没有足够的电量，导致 ADB 不断断开连接。

如果您的设备已root，您可以通过wifi将其连接到adb。这很舒服，比有线 USB 好得多。当然，您并不总是拥有一个根设备。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-10-17T09:53:08.520

如果您在 Mac OS Sierra 和 Android Studio 2.1.2 或 2.2.0 上运行，那么只需将您的 SDK-Platform Tools 升级到 24.0.4 并重新启动 Android Studio。这将解决它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-05-31T06:03:27.270

以下两个解决方案对我有用。

您可以尝试两者中的任何一个或两者。

1.  重启设备。
2.  释放一些内部存储空间（在大多数情况下有效）。

# c# - MVC3 中的复选框不会从模型中刷新

> ID：10355270
> 
> 赞同：0
> 
> 时间：2012-04-27T17:34:14.003
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我的复选框正在更新数据库，但刷新时“已检查”值不存在。

```
<input type="checkbox" id="chkPriorityOnly" @if(Model.PriorityOnly){<text>  checked="checked" </text>}/> Priority Only <br /> 
```

然后按照建议，我使用了：

```
 @Html.CheckBoxFor(model => Model.PriorityOnly, new { id = "chkPriorityOnly" }) Priority Only<br /> 
```

这是我保存选择后的 html：

```
<input id="chkPriorityOnly" name="PriorityOnly" type="checkbox" value="true" /><input name="PriorityOnly" type="hidden" value="false" /> Priority Only<br /> 
```

这是我的保存：

```
 function OnRestrictionsSaveClick() {

            $.ajax({
                type: 'POST',
                url: '@Url.Content("~/Audience/UpdateRestrictions?audienceID=" + Model.AudienceID)'                
                + '&priorityOnly=' + $('#chkPriorityOnly:checked').val() 
                + '&home=' + $('#chkHome:checked').val() 
                + '&work=' + $('#chkWork:checked').val() 
                + '&cell=' + $('#chkCell:checked').val() 
                + '&text=' + $('#chkText:checked').val() 
                + '&other=' + $('#chkOther:checked').val() ,
                success: function (data) {SaveRestrictionsResponse(data); }
            });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:38:41.690

为什么不使用该`Html.CheckboxFor`方法？

```
@Html.CheckBoxFor(model => model.PriorityOnly) Priority Only<br /> 
```

至少可以说，您进行 AJAX 保存的方式很不稳定。您正在指定 POST 但构建了一个查询字符串，这很奇怪。

相反，请尝试：

```
function OnRestrictionsSaveClick() {
    $.post({
        url: '@Url.Action("UpdateRestrictions", "Audience")',
        data: $("input:checkbox").serialize(),
        success: function(data) { SaveRestrictionsResponse(data); }
    });
} 
```

这样，jQuery 为您完成了构建 POST 请求数据的繁重工作，自动获取所有选中复选框的值。*不会发送未*选中的复选框，因此传递给 UpdateRestrictions() 操作的视图模型应默认所有布尔属性为“false”（模型绑定器将自动将选中的属性设置为“true”。）

此外，您可以使用该`Url.Action`方法为您想要的操作生成 URL。您永远不应该将 URL 硬编码为操作。始终使用其中一种`UrlHelper`或`HtmlHelper`路由感知方法来构建这些 URL。这是因为它们会尊重您的路由表，因此您可以轻松更改路由，而无需更改视图中的 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T19:54:31.483

我不知道这是否会回答您的问题，但是您在 javascript 中所做的事情是不正确的。

$("*:checked") 选择器将查找选中的复选框。

意思是 $("#chkHome:checked") 如果未选中复选框，将返回 null 。

使用 .val() 将检索输入的值属性。如果已检查，则调用 $("#chkHome:checked").val() 将返回“true”（输入的 value 属性），否则返回 null。

您应该改用 $("#chkHome").is(":checked") （如果选中则返回 true，否则返回 false）。

没有隐藏的输入，而是使用：

```
<input type="checkbox" name="chkPriorityOnly" id="chkPriorityOnly" @(Model.PriorityOnly ? "checked=checked" : "") value="true" />
<label for="chkPriorityOnly">Priority only</label> 
```

如果 name 属性与模型上的属性名称匹配（例如 PriorityOnly 与 chkPriorityOnly）用于数据绑定，它也可能更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:56:30.400

当表单发布时，仅发布选中的复选框。并且因为 Html.CheckBoxFor 有隐藏字段：当未选中复选框时，隐藏字段的 false 值会被发布而不是什么都没有（注意隐藏字段与复选​​框具有相同的名称）

试试这个：

```
+ '&priorityOnly=' + $('#chkPriorityOnly').val() 
```

而不是这个：

```
+ '&priorityOnly=' + $('#chkPriorityOnly:checked').val() 
```

# binary - 在代码中使用二进制数会提高性能吗？

> ID：10355273
> 
> 赞同：0
> 
> 时间：2012-04-27T17:34:27.283
> 
> 标签：binary, numbers

我见过很多在代码中使用二进制数的例子，比如 32,64,128 等等（例如，非常有名的例子 - minecraft）

我想问一下，在 Java / C++ 等高级语言中使用二进制数有什么帮助吗？

我知道汇编，你总是宁愿使用这些，因为在低级语言中，如果你超过寄存器限制，它会使事情变得过于复杂。

如果您使用二进制数，程序会运行得更快/节省更多内存吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:40:41.230

与大多数事情一样，“这取决于”。

在编译语言中，更好的编译器会推断出慢的机器指令有时可以用不同的更快的机器指令来完成（但仅限于特殊值，例如 2 的幂）。有时编码人员知道这一点并相应地编程。（例如乘以 2 的幂很便宜）

其他时候，算法适用于涉及 2 的幂的表示（例如，许多分而治之的算法，如快速傅里叶变换或合并排序）。

在其他时候，它是表示布尔值（如位掩码）的最紧凑的方式。

最重要的是，其他时候它对于内存目的效率更高（通常是因为用 2 的幂来乘除逻辑非常快，操作系统/硬件/等将使用缓存行/页面大小/等的幂二，因此您最好为您的重要数据结构提供两种大小的强大功能）。

然后，除此之外，其他时候......程序员只是习惯于使用 2 的幂，以至于他们只是这样做，因为这看起来是一个不错的数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:49:09.630

在程序中使用两个数字的幂有一些好处。位掩码是其中的一种应用，主要是因为位运算符（`&`、`|`、`<<`、`>>`等）非常快。

在 C++ 和 Java 中，这是相当不错的——尤其是在 GUI 应用程序中。您可以拥有一个包含 32 个不同菜单选项的字段（例如可调整大小、可移动、可编辑等），并应用每个选项，而无需经过复杂的值相加。

就原始加速或任何性能改进而言，这实际上取决于应用程序本身。GUI 包可能*很大*，因此在应用菜单/界面选项时从这些包中获得任何加速都是一个巨大的胜利。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T17:53:01.953

从您的问题的标题看来，您的意思是，“如果您以二进制形式编写常量，是否会使您的程序更有效率？” 如果这就是你的意思，那么答案肯定是，不。编译器在编译时将所有常量转换为二进制，所以到程序运行时，它没有任何区别。我不知道编译器是否可以比十进制更快地解释二进制常量，但差异肯定是微不足道的。

但是您的问题的主体似乎表明您的意思是“使用二进制整数的常量”，而不是必须用二进制数字表示它们。

大多数情况下，答案是否定的。例如，如果计算机必须将两个数字相加，那么添加一个恰好是二进制整数的数字不会比添加一个非整数数字快。

乘法可能会稍微快一些。一些编译器足够聪明，可以将乘以 2 的幂转换为位移运算，而不是硬件乘法，并且位移通常比乘法更快。

回到我的汇编语言时代，我经常使数组中的元素大小为 2 的幂，因此我可以通过位移而不是乘法来索引数组。但是在高级语言中很难做到，因为你必须做一些研究来找出你的原语在内存中占用了多少空间，编译器是否在它们之间添加了填充字节等等。如果您确实向数组元素添加了一些字节以将其填充为 2 的幂，整个数组现在更大了，因此您可能会产生额外的页面错误，即操作系统内存不足并且必须写入块将您的数据存储到硬盘驱动器，然后在需要时将其读回。一个额外的硬盘权利比 1000 次乘法需要更多的时间。

在实践中，（a）差异是如此微不足道，几乎不值得担心；(b) 您通常不知道在低级别发生的所有事情，因此通常很难预测具有预期后果的更改是否会有所帮助或有害。

简而言之：不要打扰。使用问题自然的常数值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T17:40:49.583

不，您的代码将以相同的方式运行，无论您使用什么号码。

如果用二进制数表示数字是 2 的幂，例如：2、4、8、16、1024 ......它们通常是由于空间优化而常见的。例如，如果您有一个 8 位指针，它能够指向 256（即 2 的幂）地址，所以如果您使用的地址少于 256，您就是在浪费您的指针......所以通常您分配一个 256 的缓冲区...这同样适用于所有其他 2 数字的幂....

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-27T18:37:18.200

在大多数情况下，答案几乎总是否定的，没有明显的性能差异。

但是，在某些情况下（非常少），不使用二进制数作为数组/结构大小/长度会带来显着的性能优势。这些是您填充缓存的情况，并且因为您正在循环填充缓存的结构，因此每次循环遍历数组/结构时都会发生缓存冲突。这种情况非常罕见，除非您的代码执行速度比理论上的限制要慢得多，否则不应进行预优化。此外，这种情况非常依赖于硬件，并且会因系统而异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-27T17:37:11.810

使用它们的原因可能不同 - 例如位掩码。

如果您在数组大小中看到它们，它并没有真正提高性能，但通常内存是按 2 的幂分配的。例如，如果您编写`char x[100]`，您可能会获得 128 个分配的字节。

# android - Android Layout在水平布局中左右对齐

> ID：10355274
> 
> 赞同：21
> 
> 时间：2012-04-27T17:34:39.467
> 
> 标签：android, android-layout

我有一个 ImageView 和一个 ImageButton。我让它们在水平布局中彼此相邻。我正在尝试使图像在屏幕上左对齐，并且按钮右对齐。我试过设置重力，但似乎没有什么不同。我哪里错了？

```
<LinearLayout
    android:id="@+id/linearLayout1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" 
    >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="left"
        android:layout_weight="1"
        android:gravity="left"
        android:src="@drawable/short_logo" />

    <ImageButton
        android:id="@+id/terminateSeed"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:gravity="right"
        android:background="@null"
        android:src="@drawable/unregister_icon" />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-27T17:36:56.213

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:src="@drawable/ic_launcher" />

    <Button
        android:id="@+id/button1"
        style="?android:attr/buttonStyleSmall"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:text="Button" />

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-27T17:40:46.300

采用...

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal"
    android:weightSum="1.0" >

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="left"
    android:layout_marginRight="80dp"
    android:layout_weight="0.5"
    android:gravity="left"
    android:src="@drawable/ic_launcher" />

<ImageButton
    android:id="@+id/terminateSeed"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="0.5"
    android:gravity="right"
    android:layout_marginLeft="80dp"
    android:background="@null"
    android:src="@drawable/ic_launcher" />
</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-04T07:08:50.317

如果您想使用 LinearLayout 而不给出权重，请使用此示例

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
>

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="left"
       />

    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="center_vertical"
        android:gravity="right"
        />
    </LinearLayout> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T17:39:34.083

```
<RelativeLayout 
android:id="@+id/linearLayout1"
android:layout_width="match_parent"
android:layout_height="wrap_content"

>

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="left"

    android:layout_alignParentLeft="true"
    android:src="@drawable/short_logo" />

<ImageButton
    android:id="@+id/terminateSeed"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:background="@null"
    android:src="@drawable/unregister_icon" />
</RelativeLayout > 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-27T17:41:35.573

`imageview`相应地设置和`imagebutton` `wrap_content`设置`layout_gravity`为左和右。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-27T17:47:18.703

a`RelativeLayout`可以快速解决您的问题，但是如果您仍然坚持使用 LinearLayout（只是因为我们很糟糕并且做事很艰难），您可以这样做：

您的父 LinearLayout 是填充父级、左对齐和水平方向的，并且包含您的 ImageView 和另一个 LinearLayout。

```
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="horizontal"
android:gravity="left" 
```

第二个 LinearLayout 是填充父级、右对齐和水平方向的，并且包含您的 ImageButton。

```
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="horizontal"
android:gravity="right" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-23T15:55:25.193

`LinearLayout`, 使用`layout_weight`和的另一种方法`gravity`：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal">
    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:gravity="center"
        android:text="BUTTON 1"/>
    <Button
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:gravity="center"
        android:text="BUTTON 2" />
</LinearLayout> 
```

# html - 在另一个 div 中左右定位 div

> ID：10355278
> 
> 赞同：1
> 
> 时间：2012-04-27T17:35:19.093
> 
> 标签：html, css, css-float, positioning

我对 css 和 html 很陌生，我在另一个 div 中浮动 div 时遇到了麻烦，我在网上做了很多研究，但还没有找到解决方案。

**这些是我读过的网站，但没有用：**

几乎没有/screencast/html-training/css/positioning/

stackoverflow /questions/580195/css-layout-2-column-fixed-fluid

mirificampress /show.php?id=106

[如何让固定宽度 DIV 内的浮动 DIV 水平继续？](https://stackoverflow.com/questions/1015809/how-to-get-floating-divs-inside-fixed-width-div-to-continue-horizontally)

我的代码可以在[这里的 jsFiddle 上找到](http://jsfiddle.net/qf3BB/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:46:37.323

我希望这将有所帮助。CSS：

```
#left, #right {
 width: 100px; //change this to whatever required
 float: left;
} 
```

HTML：

```
<div id="wrapper">
    <div id="left">
       <p class="t0">lorum itsum left</p>
    <div>
    <div id="right">
       <p class="t0">lorum itsum right</p>
    <div>
<div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:43:16.750

像这样？

[http://jsfiddle.net/Ev474/](http://jsfiddle.net/Ev474/)

```
<div id="wrapper">
    <div id="inner">
        <div id="left">
            Left Content
        </div>
        <div id="right">
            Right Content
        </div>
    </div>
</div>

div {
    height: 50px;
}
#wrapper {
    width: 200px;
    overflow-x: auto;
    overflow-y: hidden;
    background-color: #ccc;
}
#inner {
    width: 400px;
}
#left {
    width: 150px;
    float: left;
    background-color: #f00;
}
#right {
    width: 150px;
    float: left;
    background-color: #0f0;
}​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-05T13:01:29.167

因为你是初学者。我会直截了当。以下是您的代码的提取。我使用了内部样式表。您的示例正在使用外部样式表。使用 float 属性，您可以将其设置为左右。这里使用 float:left 将一个 div 向左点亮，float:right 将另一个 div 向右点亮。每个打开的标签都必须是关闭的标签。

```
 <head>
    </head> 
    <!--Internal style sheet-->
    <style>
    .left{
    float:left;
    }
    .right{
    float:right;
    }
    </style>

    <body>
    <div id="wrapper" >
        <div class="left">
            <p class="t0">lorum itsum left</p>
        </div>
        <div class="right">
            <p class="t0">lorum itsum right</p>
        </div>
    </div>
    </body>
    </html> 
```

附加说明：如果要调整左右 div 的大小，请在样式表中使用宽度。请参阅下面的更新样式表。我将左侧 div 宽度设置为屏幕宽度的 80%，右侧宽度设置为 20%。（总计应为 100%）。相应调整。背景色用于设置div的背景色。

```
.left{
float:left;
background-color:powderblue;
width:80%;
}
.right{
float:right;
width:20%;
background-color:yellow;
} 
```

# css - 水平下拉菜单（子菜单）在 chrome、ie9、firefox 和 safari 中定位不同

> ID：10355280
> 
> 赞同：0
> 
> 时间：2012-04-27T17:35:21.313
> 
> 标签：css, firefox, cross-browser, internet-explorer-9, drop-down-menu

我花了 3 天时间试图解决这个问题，但无法提出可行的解决方案。

我什至尝试使用 javascript 来加载为每个浏览器量身定制的样式表，但即使这样也没有用。

我的问题是我的水平菜单（http://mydomainsample.com/fire_rebuild）在 chrome 中显示得非常好，但是当我在 safari 或 firefox 中加载时，子菜单位置不合适。奇怪的是，IE(9) 比其他两个更接近正确，但即使这样也不太正确。

我玩过样式表试图弄清楚它，但是当我在 fff、safari 中正确使用它时，或者它在 chrome 中搞砸了。

我似乎找不到适用于所有浏览器的解决方案。

有人可以帮我找到解决方案吗？我尝试使用不同的菜单，但这个看起来最好，我使用的任何垂直下降都会给我菜单和幻灯片之间的 z-index 问题，我似乎无法修复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:47:56.230

jQuery 已经更新到 v1.7.2；我会更新你所有的插件，看看是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:43:39.260

我不认为 src 是链接标签的可选属性。用像前两个一样的 href 替换它。当我在 Firefox 中查看页面时，我没有看到上面的两个文件被导入。

这些链接标签中文件的顺序也非常重要。

href="样式表/reset.css"

href="样式表/coda-slider-2.0.css"

我不知道你是否已经拥有它们，但是 firefox 和 chrome 拥有使生活更轻松的 firebug 和 web 开发者插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:06:09.727

首先，删除您应用的所有javascript以匹配不同的浏览器。然后删除 style.css 第 83 行上的`width:750px;`and `left: 548px;`(ul#nav li:hover > ul)

希望这能解决你的问题

此外，您的页面宽度为 1220 像素。坚持使用 960px 宽度以兼容小屏幕尺寸。

# iphone - 什么是 UIGobblerGestureRecognizer？

> ID：10355281
> 
> 赞同：10
> 
> 时间：2012-04-27T17:35:28.093
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我只有一个普通的 UITableView，我运行了这个代码：

```
UITableView *tableView = [[UITableView alloc] init];
for(UIGestureRecognizer *gesture in tableView.gestureRecognizers)
 {
   NSString *className = NSStringFromClass([gesture class]);
   NSLog(@"ClassName:%@", className);
 } 
```

其中一条输出线是：`ClassName:UIGobblerGestureRecognizer`

令人惊讶的是，谷歌对此一无所知。有人知道它是什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T17:39:10.680

这很可能是 Apple 使用的内部类。我遇到过 Apple 为某些特定用途创建的 UIGestureRecognizers 的自定义子类。我确信他们出于各种原因需要创建自定义手势识别器，就像我一样，并不是所有这些类都公开供我们使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-07T03:30:19.553

我非常确定它用于在特定单元格显示删除确认按钮时防止正常交互，并将任何触摸识别为触发该单元格返回到非编辑状态。

它有这个方法，我假设 excludeView 是显示删除确认按钮的单元格，因为您通常仍然可以与处于此状态的单元格进行交互。

`- (id)initWithTarget:(id)arg1 action:(SEL)arg2 excludedView:(id)arg3;`

[https://github.com/nst/iOS-Runtime-Headers/blob/master/Frameworks/UIKit.framework/UIGobblerGestureRecognizer.h](https://github.com/nst/iOS-Runtime-Headers/blob/master/Frameworks/UIKit.framework/UIGobblerGestureRecognizer.h)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-16T19:45:16.273

查看[http://oleb.net/blog/2013/02/new-undocumented-apis-ios-6-1/](http://oleb.net/blog/2013/02/new-undocumented-apis-ios-6-1/)

> BJ Homer 认为 UIGobblerGestureRecognizer 用于在动画进行时避免识别。否则，它是不活动的。在一次有趣的 Twitter 对话中，Filippo Bigarella 和 Conrad Kramer 发现 UIGobblerGestureRecognizer 可以“吞噬”触摸，以防止其他手势识别器在某些情况下接收到它们。那些是什么情况，我不知道。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-27T15:10:10.583

简而言之，从我读过的内容和我的实验结果来看，当状态转换（由用户的触摸或滑动启动）时，“gobbler”似乎会吞噬并触摸表格视图（实际上是表格单元格）正在进行中，以便在用户再次触摸表格之前完成状态转换。Apple 可能会在其他情况下使用它，但它是在我观察到 gobblers 的表格视图中。

现在长话短说：假设您的表格视图在表格单元格上实现了一个“抽屉”，例如 Apple 的邮件应用程序或消息应用程序。当您向后滑动打开抽屉并对抽屉中的任何按钮进行操作时，一切都很好。但是，如果您只是通过第四次滑动来关闭平局，您可能会发现您在随机单元格上的下一次向后滑动不起作用。但是，如果您继续向后滑动，下一次滑动通常会再次显示抽屉。简单地说，如果你只是通过滑动打开和关闭随机单元格上的抽屉，你会发现有时抽屉打不开。

我在我的桌子上看到这种行为，并认为我做错了什么。我尝试了很多东西，最终实现了我自己的 UITableView 子类，它也支持 UIGestureRecognizerDelegate。在我的子类中，我实现了委托的 shouldBeRequiredToFailByGestureRecognizer 函数，只是为了打印出 gestureRecognizer 和 otherGestureRecognizer 对。然后我发现，当识别到向后滑动时，成对中不存在 gobbler。但是，当背面滑动不起作用时，gobbler 肯定是存在的。

网络上的普遍看法是，使用 gobbler 来防止用户在一个转换已经在进行时在桌子上引起另一个状态转换。如果用户确实采取了一些行动（通过触摸抽屉中的按钮），那很好。但是当用户刚刚关闭抽屉时，gobbler 应该被取消。或者仅当用户采取行动时才应添加 gbbler。在我意识到之后，我继续尝试我对 Apple 应用程序的理论。我已经知道邮件应用程序可以完美响应每次滑动。但是消息应用程序会间歇性地重复抽屉打开滑动，就像我的应用程序一样。所以我猜 Mail 的开发者会更加小心，并使用内部知识来做对。我的观察是在 iPhone 6 和 iPad 2 上的 iOS 8.4 上完成的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-27T17:39:19.817

它绝对应该是私有 API 的一部分 ..

我会建议远离它

# c# - 通过 SQL 更改 Cisco UCCE 密码

> ID：10355283
> 
> 赞同：0
> 
> 时间：2012-04-27T17:35:36.140
> 
> 标签：c#, sql, voip, cisco

我们正在开发一个应用程序来更改我们 UCCE 环境中用户的密码。我找到了这些数据的存储位置，我可以更新用户的密码。

然而，它似乎只适用于 UCCE 环境中的基于 Web 的应用程序，而不适用于 CAD 和 CSD 等物理应用程序。对于我的生活，我无法弄清楚为什么会发生这种情况。

有没有人成功地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:29:25.990

这是我从 Cisco 得到的回复

大家好，首先，您可能有一些 LDAP 问题，但同步确实会每 10 分钟检查一次更改。您可能遇到 LDAP 同步问题。其次，超级用户密码不存储在同一个表中。我提到的表格是针对代理的。管理员密码存储在几个不同的地方，包括更新 AD，我认为它不像代理表那样容易更改。此外，密码不会在桌面更新 - 它仅存储在 LDAP 中，并在代理尝试登录时进行验证

此外，仅通过在 SQL 中更改它，我不确定是否将其填充到其他记录器、HDS 等（实际上我很确定它不会）。正常的方法是在 AW 中进行更改，然后将更改推送到路由器（通过 UPCC.dll），路由器将更改发送到记录器以更新其数据库，最后也返回给 AW 作为确认与其他 AW/HDS 一样。有一些检查/程序来填充更改——其中之一是每台服务器上的恢复密钥。

通过您尝试执行的操作，您很可能会导致所有数据库损坏，因为它们依赖于恢复密钥来确保它们全部同步。所以我不太确定在 SQL 中更改它是一个非常好的主意，Cisco 或 Calabrio 也不会支持它。你很可能会破坏数据库，因为你绕过了中央控制器保持一切同步的方式。

最后，CAD 与此/这些更改没有任何关系——它只会查询数据库并更新 LDAP，但如前所述，我认为您正在更改代理密码，因此不会更改主管。我强烈建议您不要尝试更改 SQL 中的任何内容，因为我们已经看到了足够多的数据库不同步和/或损坏的情况——当这种情况发生时，这并不是很有趣！

希望这有助于解释更多。

谢谢，

克里斯

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-03-03T12:00:55.883

更正您在 SQL 中所做的密码更改不会填充到其他 AW/HDS、ETC。我100%肯定不会，你会面对

1.  恢复密钥不匹配问题。
2.  _Real_Time Table Data Mismatched Issue 表示同步问题。

# c# - 以编程方式在另一个窗口中单击鼠标

> ID：10355286
> 
> 赞同：30
> 
> 时间：2012-04-27T17:35:44.973
> 
> 标签：c#, windows, click, mouse, message

是否可以以编程方式单击另一个窗口中的位置而不将鼠标移动到该位置，即使该窗口不在顶部？我想向另一个窗口发送一种消息以模拟鼠标单击某个位置。

我试图用 PostMessage 来完成这个：

```
PostMessage(WindowHandle, 0x201, IntPtr.Zero, CreateLParam(300,300));
PostMessage(WindowHandle, 0x202, IntPtr.Zero, CreateLParam(300,300)); 
```

我以这种方式制作了 CreateLParam 函数：

```
private static IntPtr CreateLParam(int LoWord, int HiWord)
{
     return (IntPtr)((HiWord << 16) | (LoWord & 0xffff));
} 
```

问题是窗口被锁定在他的位置上。我认为我的应用程序点击了 (1,1) 坐标。有人可以帮我解决这个问题吗？

编辑：这是 PostMessage：

```
[return: MarshalAs(UnmanagedType.Bool)]
[DllImport("user32.dll")]
public static extern bool PostMessage(IntPtr WindowHandle, int Msg, IntPtr wParam, IntPtr lParam); 
```

0x201 和 0x202 分别是 WM_LBUTTONDOWN 和 WM_LBUTTONUP。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-27T18:26:22.847

您不能通过发送消息来做到这一点，而是使用 SendInput Windows API。

调用方法 ClickOnPoint，这是来自表单点击事件的示例，`this.handle`表单句柄也是如此，注意这些是发送窗口女巫句柄上的客户端坐标，您可以轻松更改它并发送屏幕坐标，在这种情况下您不需要下面的句柄或 ClientToScreen 调用。

```
ClickOnPoint(this.Handle, new Point(375, 340)); 
```

更新：现在使用 SendInput，tnx Tom。

顺便提一句。我只使用了此示例所需的声明，还有一个不错的库：[Windows Input Simulator (C# SendInput Wrapper - Simulate Keyboard and Mouse)](http://inputsimulator.codeplex.com/)

```
 public class ClickOnPointTool
  {

    [DllImport("user32.dll")]
    static extern bool ClientToScreen(IntPtr hWnd, ref Point lpPoint);

    [DllImport("user32.dll")]
    internal static extern uint SendInput(uint nInputs, [MarshalAs(UnmanagedType.LPArray), In] INPUT[] pInputs,  int cbSize);

#pragma warning disable 649
    internal struct INPUT
    {
      public UInt32 Type;
      public MOUSEKEYBDHARDWAREINPUT Data;
    }

    [StructLayout(LayoutKind.Explicit)]
    internal struct MOUSEKEYBDHARDWAREINPUT
    {
      [FieldOffset(0)]
      public MOUSEINPUT Mouse;
    }

    internal struct MOUSEINPUT
    {
      public Int32 X;
      public Int32 Y;
      public UInt32 MouseData;
      public UInt32 Flags;
      public UInt32 Time;
      public IntPtr ExtraInfo;
    }

#pragma warning restore 649

    public static void ClickOnPoint(IntPtr wndHandle , Point clientPoint)
    {
      var oldPos = Cursor.Position;

      /// get screen coordinates
      ClientToScreen(wndHandle, ref clientPoint);

      /// set cursor on coords, and press mouse
      Cursor.Position = new Point(clientPoint.X, clientPoint.Y);

      var inputMouseDown = new INPUT();
      inputMouseDown.Type = 0; /// input type mouse
      inputMouseDown.Data.Mouse.Flags = 0x0002; /// left button down

      var inputMouseUp = new INPUT();
      inputMouseUp.Type = 0; /// input type mouse
      inputMouseUp.Data.Mouse.Flags = 0x0004; /// left button up

      var inputs = new INPUT[] { inputMouseDown, inputMouseUp };
      SendInput((uint)inputs.Length, inputs, Marshal.SizeOf(typeof(INPUT)));

      /// return mouse 
      Cursor.Position = oldPos;
    }

  } 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-06-23T02:46:48.290

我过去发现了一种向*Windows Media Player*发送消息的方法， 所以我用它来模拟我想要的应用程序中的点击！

使用[这个类](http://www.mediafire.com/download/4fnx82pfjo8sc18)（下面的代码）找到窗口并发送你想要的消息！

```
using System;
using System.Runtime.InteropServices;

namespace Mouse_Click_Simulator
{
    /// <summary>
    /// Summary description for Win32.
    /// </summary>
    public class Win32
    {
        // The WM_COMMAND message is sent when the user selects a command item from 
        // a menu, when a control sends a notification message to its parent window, 
        // or when an accelerator keystroke is translated.
        public const int WM_KEYDOWN = 0x100;
        public const int WM_KEYUP = 0x101;
        public const int WM_COMMAND = 0x111;
        public const int WM_LBUTTONDOWN = 0x201;
        public const int WM_LBUTTONUP = 0x202;
        public const int WM_LBUTTONDBLCLK = 0x203;
        public const int WM_RBUTTONDOWN = 0x204;
        public const int WM_RBUTTONUP = 0x205;
        public const int WM_RBUTTONDBLCLK = 0x206;

        // The FindWindow function retrieves a handle to the top-level window whose
        // class name and window name match the specified strings.
        // This function does not search child windows.
        // This function does not perform a case-sensitive search.
        [DllImport("User32.dll")]
        public static extern int FindWindow(string strClassName, string strWindowName);

        // The FindWindowEx function retrieves a handle to a window whose class name 
        // and window name match the specified strings.
        // The function searches child windows, beginning with the one following the
        // specified child window.
        // This function does not perform a case-sensitive search.
        [DllImport("User32.dll")]
        public static extern int FindWindowEx(
            int hwndParent, 
            int hwndChildAfter, 
            string strClassName, 
            string strWindowName);

        // The SendMessage function sends the specified message to a window or windows. 
        // It calls the window procedure for the specified window and does not return
        // until the window procedure has processed the message. 
        [DllImport("User32.dll")]
        public static extern Int32 SendMessage(
            int hWnd,               // handle to destination window
            int Msg,                // message
            int wParam,             // first message parameter
            [MarshalAs(UnmanagedType.LPStr)] string lParam); // second message parameter

        [DllImport("User32.dll")]
        public static extern Int32 SendMessage(
            int hWnd,               // handle to destination window
            int Msg,                // message
            int wParam,             // first message parameter
            int lParam);            // second message parameter
    }
} 
```

例如：

```
 Win32.SendMessage(iHandle, Win32.WM_LBUTTONDOWN, 0x00000001, 0x1E5025B); 
```

[这是我创建的应用程序源代码](http://www.mediafire.com/download/v8n68xpuph36mrh)，用于在特定时间间隔内自动单击“BlueStacks”应用程序！

对于`FindWindow`, `wParam`,`lParam`等，你可以随时问我怎么做！这不是太难:) ;) 希望它有所帮助！:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-02-20T16:29:12.620

我无法添加评论：D

为我工作：

```
[DllImport("User32.dll")]
    public static extern Int32 SendMessage(
    int hWnd,               
    int Msg,                
    int wParam,            
    IntPtr lParam); 
```

并像这样在 lParam 中组合坐标：

```
private static IntPtr CreateLParam(int LoWord, int HiWord)
    {
        return (IntPtr)((HiWord << 16) | (LoWord & 0xffff));
    } 
```

并使用：

```
Clicktoapp.SendMessage(0x00040156, Clicktoapp.WM_LBUTTONDOWN, 0x00000001, CreateLParam(150,150));
        Clicktoapp.SendMessage(0x00040156, Clicktoapp.WM_LBUTTONUP, 0x00000000, CreateLParam(150, 150)); 
```

0x00040156 - 窗口句柄。

我一直在寻找使用spy ++的窗口句柄，每次都是新的，所以最好使用FindWindow。

附言

应用程序窗口的屏幕截图，即使窗口不在顶部

[https://stackoverflow.com/a/911225/12928587](https://stackoverflow.com/a/911225/12928587)

我使用这个解决方案。工作得很好。

# sql-server-2008 - 所有池连接都在使用中并且达到最大池大小

> ID：10355289
> 
> 赞同：0
> 
> 时间：2012-04-27T17:36:05.810
> 
> 标签：sql-server-2008

我正在编写一个 .NET 4.0 控制台应用程序

1.  打开连接 使用数据阅读器在键列表中游标
2.  对于每个键读取，调用 Web 服务
3.  将 Web 服务的结果存储在数据库中

然后，我生成此进程的多个线程，以提高每秒可以处理的最大记录数。

当我的进程超过大约 30 个线程时，我收到以下错误：

```
System.InvalidOperationException: Timeout expired.  The timeout period elapsed prior to obtaining a connection from the pool.   This may have occurred because all pooled connections were in use and max pool size was reached. 
```

是否有服务器或客户端选项可以调整以允许我从连接池中获取更多连接？

我正在调用一个 sql 2008 r2 数据库。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:40:35.043

这听起来像是一个设计问题。数据库中的总记录数是多少？遍历阅读器会*非常*快。即使您有数十万行，浏览该阅读器也会很快。这是您可以采取的另一种方法：

遍历阅读器并将数据存储在对象列表中。然后以您选择的数量（例如，一次两个，一次三个等）遍历您的对象列表，并生成该数量的线程以并行调用您的 Web 服务。

这样您就不会打开与数据库的多个连接，并且您正在处理可能是真正的瓶颈（对 Web 服务的 HTTP 调用）的并行处理。

这是一个例子：

```
List<SomeObject> yourObjects = new List<SomeObject>();

if (yourReader.HasRows) {
    while (yourReader.Read()) {
        SomeObject foo = new SomeObject();
        foo.SomeProperty = myReader.GetInt32(0);
        yourObjects.Add(foo);
    }
}

for (int i = 0; i < yourObjects.Count; i = i + 2) {
    //Kick off your web service calls in parallel.  You will likely want to do something with the result.
    Task[] tasks = new Task[2] {
        Task.Factory.StartNew(() => yourService.MethodName(yourObjects[i].SomeProperty)),
        Task.Factory.StartNew(() => yourService.MethodName(yourObjects[i+1].SomeProperty)),
    };

    Task.WaitAll(tasks);
}

//Now do your database INSERT. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:40:59.817

为您的所有请求打开一个新连接是*非常*低效的。如果您只是想使用相同的连接来继续请求事物，那是不可能的。您可以打开一个连接，然后`SqlCommand`通过该连接运行尽可能多的命令。只需保留 ONE 连接，并在所有线程完成后将其丢弃。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-11-22T13:49:36.723

请重新启动您将能够连接的 IIS

# python - 错误：必须是 str，而不是 Python 中的生成器

> ID：10355290
> 
> 赞同：2
> 
> 时间：2012-04-27T17:36:09.197
> 
> 标签：python

我正在使用 python，这是我的一段代码：

```
wp = open(outfile, 'w')
fields = line.split('\t')
gene_ID = fields[0]
chr = fields[1]
strand = fields[2]
start = int(fields[3])
end = int(fields[4])
bc = {'A': 'T', 'C': 'G', 'G': 'C', 'T': 'A', 'N':'N'}       
if strand == '+':
    wp.write(chr_string[start:end]) 
if strand == '-':
    newstart, newend = -(start + 1), -(end + 1)
    wp.write(bc[base.upper()] for base in chr_string[newstart:newend]) <--error pointed at this line 
```

当我尝试运行我的整个代码时，我收到以下消息：

```
TypeError: must be str, not generator 
```

有人知道我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T17:39:02.537

`bc[base.upper()] for base in chr_string[newstart:newend]`是一个生成器表达式。`join`您需要通过 eg方法从中创建一个字符串：`''.join(c[base.upper()] for base in chr_string[newstart:newend])`

# html - 如何将我的 css 连接到存储在 WEB-INF 文件夹中的 JSP 文件？Websphere/JSP

> ID：10355292
> 
> 赞同：6
> 
> 时间：2012-04-27T17:36:39.360
> 
> 标签：html, css, jsp

我正在使用 ibm websphere 并创建一个*动态 web 项目*。我所有的`JSP`文件都在我的 WEB-INF 文件夹中，并且我在我的文件中使用 servlet 映射 `web.xml`来使它们可以访问。到目前为止，这工作得很好。但是我的 CSS 有问题。与往常一样，我的`CSS`文件位于`WebContent`名为 css 的文件夹中。这是我的链接`jsp`

```
<link rel="stylesheet" href = "css/styles.css"> 
```

我没有运气让我的CSS显示......
我错过了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-27T17:53:32.510

生成的 HTML 输出中的相对 URL 是由浏览器相对于请求 URL（如您在浏览器的地址栏中看到的）解释的，而不是它们在服务器磁盘文件系统中的物理位置。即必须通过 HTTP 请求下载它们的网络浏览器，而不是必须以某种方式从磁盘包含它们的网络服务器。

其中一种方法是对这些资源使用域相对路径，即以`/`. 您可以使用`${pageContext.request.contextPath}`动态内联当前 webapp 的上下文路径。

```
<link rel="stylesheet" href="${pageContext.request.contextPath}/css/styles.css"> 
```

这将在生成的 HTML 输出中结束，如下所示：

```
<link rel="stylesheet" href="/yourContextPath/css/styles.css"> 
```

这样浏览器将能够正确下载它们。

### 也可以看看：

*   [调用转发到 JSP 的 Servlet 时，浏览器无法访问/查找相关资源，如 CSS、图像和链接](https://stackoverflow.com/questions/3655316/servlets-browser-cant-access-css-images-when-doing-a-forward-to-a-jsp/3658735#3658735)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:40:51.900

我想你需要从浏览器的角度来看，它是怎样的页面的URL，上下文路径和当前路径。

如果您的应用程序上下文路径是例如“myApp”，那么您可以执行以下操作以使其工作：

```
<link rel="stylesheet" href = "/myApp/css/styles.css"> 
```

如果你想让它相对而不依赖于上下文路径，那么如果你的 url 看起来像[http://localhost:8080/myApp/myservlet/file.jsp](http://localhost:8080/myApp/myservlet/file.jsp)

那么你的链接标签将是

```
<link rel="stylesheet" href = "../css/styles.css"> 
```

Firebug 或 chrome 控制台可能对了解浏览器试图获取的内容非常有帮助。

希望这可以帮助！

# scala - Scala Duck 打字新手

> ID：10355296
> 
> 赞同：3
> 
> 时间：2012-04-27T17:37:06.923
> 
> 标签：scala

我再次使用 Scala 并有一个我希望是关于鸭子类型的基本问题，或者它可能真的与函数定义有关。让我解释：

给定以下代码：

```
 package johnmcase.scala.oneoffs

object DuckTyping extends App {

  def printIt(x:Int, y:Int) = println("Value with " + x + " = " + y);

  // This method will accept ANY object that has a method named foo of type (Int) => Int
  def duckTyped(duck: {def foo: (Int) => Int}) = {
    List(1,2,3,4,5) foreach (i => printIt(i, duck.foo(i)))
  }

  println(new DoublerThatWontWork().foo(5))
  println(new Doubler().foo(5))
  println("DOUBLER:");
  duckTyped(new Doubler());
  println("Squarer:");
  duckTyped(new Squarer());
  println("AlwaysSeven:");
  duckTyped(new AlwaysSeven());
  println("DoublerThatWontWork :");
  duckTyped(new DoublerThatWontWork ()); // COMPILER ERROR!!
}

class DoublerThatWontWork { // WHY??
  def foo(x:Int) = x*2
}

class Doubler {
  def foo = (x:Int) => x*2
}

class Squarer {
  def foo = (x:Int) => x*x
}

class AlwaysSeven {
  def foo = (x:Int) => 7
} 
```

所以基本上我有一个方法“duckTyped”，只要该对象有一个名为“foo”的方法，它是一个 Int=>Int 函数，它就会接受任何对象。

为什么“DoublerThatWontWork”类中foo的函数声明不满足函数duckTyped的参数类型？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T17:49:26.177

你的签名说有一个没有参数的方法 foo，它返回一个从 Int 到 Int 的函数。您所拥有的是具有 Int 参数和 Int Result 的方法。

你要

```
duck: {def foo(i: Int) : Int} 
```

（参数名称不必匹配）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-27T20:32:01.107

> 所以基本上我有一个方法“duckTyped”，只要该对象有一个名为“foo”的方法，它是一个 Int=>Int 函数，它就会接受任何对象。

实际上，这是不正确的。要使其正确，请将其更改为：

> 一个名为“foo”的无**参数**方法，它**返回**一个 Int => Int 函数。

没有方法“是” an `Int => Int`，因为那是一种类型，并且方法没有类型（即它们不是对象），只是类型签名。

类型表明你是什么类型的对象。

类型签名指示如何调用方法及其返回的内容。

为了清楚起见，下面的两件事是不一样的：

```
def f(x: Int): Int = x * 2
def f: Int => Int = x => x * 2 
```

第一个方法返回一个`Int`，第二个方法返回一个`Int => Int`。第一种方法有一个参数列表，有一个`Int`参数，而第二种方法没有参数列表。

# java - 找不到主类：Main。程序将会退出

> ID：10355299
> 
> 赞同：2
> 
> 时间：2012-04-27T17:37:17.077
> 
> 标签：java, build, jar

好的，在您关闭此线程或回答完全超出主题的问题之前，请先听我说。我已经检查了所有的解决方案。我已经阅读了所有其他类似的 SO 主题，并尝试了他们在那里所说的一切。我正在使用 NetBeans，是的，它确实成功地运行了我的程序，而且我的命令 promt 也完美地运行了我的程序。我得到“找不到主类：Main。程序将退出。” 仅当我尝试双击 jar 时。是的，我有清单文件，它告诉我的主类在哪里。我什至尝试使用仅创建一帧的 Main 类创建新项目，然后构建它，但仍然出现相同的错误。

这是我在默认包中的主类（唯一类）：

```
public class Main {

    public static void main(String[] args) {
        JFrame frame = new JFrame("Test");
        frame.setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        frame.setVisible(true);
        frame.setBounds(450, 170, 400, 400);
    }
} 
```

这是清单文件：

```
Manifest-Version: 1.0
Ant-Version: Apache Ant 1.8.2
Created-By: 1.7.0_02-b13 (Oracle Corporation)
Class-Path: 
X-COMMENT: Main-Class will be added automatically by build
Main-Class: Main 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-05T23:53:07.227

经过漫长而紧张的时间试图找到解决方案，我终于发现了问题所在。如您所见，出于某种原因，NetBeans 默认使用 JDK7，但运行 .jar 文件时，我的系统使用 JRE6。所以我更改了我的 NetBeans 设置以使用和编译 JDK6 并让它工作。我的代码也有 JDK6 不支持的菱形运算符。

# ssh - ssh scp 命令不起作用

> ID：10355303
> 
> 赞同：-1
> 
> 时间：2012-04-27T17:37:35.590
> 
> 标签：ssh

我正在使用 PuTTY 将我的 Windows 机器与远程机器连接，并且我能够连接到远程机器但是当我使用 SCP 命令将一些文件下载到我的本地 Windows 机器时，它说：

```
ssh: connect to host XXXXXXXXXX port 22: Connection refused
lost connection 
```

我正在写这个命令：

```
scp * username@mywindowsmachine:~/Desktop 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T17:40:29.807

使用 winscp 执行此操作：

[http://winscp.net/eng/docs/introduction](http://winscp.net/eng/docs/introduction)

WinSCP 将使您能够与服务器交换文件，而 ssh 用于在此服务器上发出 shell 命令（并且在您的情况下无能为力，因为您的本地 Windows 机器可能无法响应其 ssh 连接）。

如果你在 shell 上，你会使用 scp，但是当你在 windows 上时（可能不使用 cygwin 之类的东西），你会发现 winscp 是最简单的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:42:52.560

如果您管理您尝试连接的服务器，请在启用调试的情况下启动 SSHD，您将看到它拒绝连接的确切原因

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T18:26:50.810

如果 sudo chown -R www-data:webmasters/dir/dir/dotfile - 可能需要通过 ssh 向您的 bash“用户”授予权限。

# java - Check if embeded Tomcat was started

> ID：10355320
> 
> 赞同：3
> 
> 时间：2012-04-27T17:39:11.790
> 
> 标签：java, tomcat, tomcat7

I am embedding Tomcat 7 into my Java application. In the constructor I set the variable:

```
this.tomcat = new Tomcat();
this.started = false; 
```

I then have another method called at a later point to start it:

```
this.tomcat.start();
this.started = true; 
```

I use the `this.started` variable to keep track of whether I ever started the server. Means that the state of the server is kept multiple times (internally by Tomcat and again in the variable). Ideally, I would like to just use the Tomcat API to get the status of the server, but I have not been able to find a method to do it.

The best alternative that I have found is trying to open a connection to the server. It seems like a slow (in CPU time scale) and resource inefficient solution.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T16:58:08.610

this.tomcat.getServer().getState();

or

this.tomcat.getServer().getStateName();

Those are standard Lifecycle methods and can be called on the Server or any Engine, Host, Context, Connector, Realm etc.

# macos - 减少 xcodebuild 写入命令行的数量

> ID：10355325
> 
> 赞同：7
> 
> 时间：2012-04-27T17:39:37.780
> 
> 标签：macos, command-line, xcodebuild

我有一个为 C++ 项目运行 xcodebuild 的简单脚本。然而，它为每个编译的文件打印出大量的输出，10-20 行，这使得它无法轻松阅读。理想情况下，我只想查看已编译文件的列表，每行一个。

我不是一个 nix 人，但似乎 nix 命令行几乎可以做任何事情......有没有一种巧妙的方法来做到这一点？xcodebuild 本身似乎没有任何详细程度的控制选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-19T07:09:45.697

这个问题可能会有所帮助：

[如何过滤 xcodebuild 命令行输出？](https://stackoverflow.com/questions/2244637/how-to-filter-the-xcodebuild-command-line-output)

基本上，您可以通过管道输出并使用 grep 搜索您需要显示的内容。

# linux - 如何从先前的输出中引用特定的行？

> ID：10355328
> 
> 赞同：1
> 
> 时间：2012-04-27T17:39:52.287
> 
> 标签：linux, bash, shell, command-line

在 bash 上，我有以下（典型）场景：

```
~/some/dir$ find | grep java 
```

例如，它的输出

```
./subdir1/subdir2/file1.java
./subdir1/subdir3/file2.java
./subdir1/subdir4/file3.java
./subdir1/subdir2/file4.java
./subdir1/subdir6/file5.java 
```

现在我知道`file5.java`我正在寻找的文件（例如）在那个子目录上，所以我执行：

```
vi subdir1/subdir6/file5.java 
```

但为了做到这一点，我必须输入路径（我知道使用 TAB 键可以加快速度）或复制并粘贴路径到文件

问题是：bash（或任何其他shell）上是否有引用上一个命令输出的行的快捷方式/变量，所以我可以说

```
vi [whatever the previous command returned on the 5th line] 
```

，这将是一个很好的节省时间

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:58:35.987

借助 BASH 历史，您可以接近`[whatever the previous command returned on line 5]`

这是一个例子

```
 $ find -name "*.java"
 src/file1.java
 ...
 src/file5.java
 ...
 $ vi $( !! | head -5 | tail -1 ) 
```

在此示例中`!!`表示`[whatever the previous command returned]`命令再次执行。

以下命令 是从输入`| head -5 | tail -1`中说的一种相当尴尬的方式`[take line 5]`

如果您在特定文件名之后，您也可以在搜索表达式中将其指定为

```
$ vi $( !find | grep file5 ) 
```

如果`find`执行需要很长时间，您可以将输出保存`find`到文件中并改用该文件。

```
$ find -name "*.java" | tee filelist.save
 src/file1.java
 ...
 src/file5.java
 ...
 $ vi $( grep file5 filelist.save ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:47:38.180

在您的 grep 命令中添加 -n 5 即可。

~/some/dir$ 查找 | grep -n 5 java

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-13T20:31:02.883

这个工具正是我需要的：

[http://facebook.github.io/PathPicker/](http://facebook.github.io/PathPicker/)

# php - 是否可以从 HTML 表单（复选框）发布多个“值”？

> ID：10355330
> 
> 赞同：3
> 
> 时间：2012-04-27T17:40:00.480
> 
> 标签：php, html, arrays, forms, post

我正在为某些产品开发一个 PHP 订购页面。用户需要能够选择多种类型的产品，因此 HTML 表单中需要复选框。

我已经通过“名称”属性为复选框建立了一个数组。

我的问题是，我想在确认页面上显示用户选择的内容，所以我希望这些复选框的“值”最终返回产品名称和产品价格。据我所知，我只会坚持一个值，所以我试图解决这个问题：

```
<?php
//variables for the array and the count
$parray = $_POST['product'];
$pcount = count($parray);

//arrays for each product's information; i've only listed one for simplicity
$br = array("Big Red", 575);

/*The idea for this was for each product ordered to add a line giving the product information and display it. When the $key variable is assigned, it is stored simply as a string, and not an array (yielding [0] as the first letter of the string and [1] as the second), which I expected, but my general idea is to somehow use $key to reference the above product information array, so that it can be displayed here*/

if (!empty($parray))
{
    for ($i=0; $i < $pcount; $i++)
{
    $key = $parray[i];
    echo "<tr><td height='40'></td><td>" . $key[0] . "</td><td>" . $key[1] . "</td></tr>";

}
}
?> 
```

有没有办法让我的 $key 变量实际上就像它设置的数组名称一样？如果没有，有什么好的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-27T17:53:22.743

因此，在您的 HTML 表格中，您需要像这样呈现每个复选框：

```
<input type="checkbox" name="selectedIDs[]" value="$key" /> 
```

`$key`项目编号在哪里。

然后，在您的 PHP 中，您将拥有一个`$_POST["selectedIDs"]`变量，它是一个包含所有已检查项目编号的数组。

假设你有一个这样的产品列表数组：

```
$products = array( 1 => array("Big Red", 575), 2 => array("Spearmint", 525)); 
```

然后，您可以使用如下循环打印所选产品的列表：

```
for($i = 0; $i < count($_POST["selectedIDs"]); $i++) {
    $key = $_POST["selectedIDs"][$i];
    $product = $products[$key];
    echo "<tr><td height='40'></td><td>" . $product[0] . "</td><td>" . $product[1] . "</td></tr>";
} 
```

这和你写的唯一真正的区别是我的`$products`数组是二维的，我`$key`的用于从`$products`数组中获取相关产品。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-27T17:42:59.043

可以给`value`s`option`的对应项的 ID 值。然后您将收到一个 ID 数组，然后您可以再次将其映射到该`$br`数组，您可以在其中通过 ID 查找商品的名称和价格。您可以使用数组键作为 ID，因此：

```
<!-- Form: -->
<input type="checkbox" name="product[]" value="1" />
<input type="checkbox" name="product[]" value="..." />
<input type="checkbox" name="product[]" value="15" />
[...]

<?php
$product = array();
$product[1] = array('name' => "Big Red", 'price' => 575);
$product[...] = array('name' => "...", 'price' => ...);
$product[15] = array('name' => "Small Green", 'price' => 475);

foreach ($_POST['product'] as $pId)
{
    echo $products[$pId]['name'] . " costs " . $products[$pId]['price'];
}
?> 
```

如果您的数组当然来自数据库，您可以使用表的 ID 作为复选框的值。然后，您可以用逗号将 $_POST['product'] （当然在转义后）内爆，并在`SELECT ... WHERE ID IN ($productIds)`查询中使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T17:46:35.087

如果我对你的理解正确，你会有这样的复选框：

```
<input type="checkbox" name="product_id[]" value="1">Product #1<br/>
<input type="checkbox" name="product_id[]" value="2">Product #2<br/>
<input type="checkbox" name="product_id[]" value="3">Product #3<br/> 
```

这应该将检查的任何内容作为数组发布到您的服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-09T11:49:23.830

gen_paper1.php

```
<div style="overflow: auto; height: 500px; border: 1px solid;">
                                <form action="" method="post">
                                <fieldset style="font-size: 15px; font-weight: bolder;">
                                    <h4><u>Your Existing Header's are listed below</u> </h4>
                                    <hr / >

                                <?php
                                        $xhdr = mysql_query("SELECT * from s_user_header ORDER BY 'ASC'");
                                            while($rheader = mysql_fetch_array($xhdr)){
                                                    $h = $rheader['h_content'];
                                                    $hid = $rheader['h_id'];?>
                                    <script>
                                        $(document).ready(function(){
                                            //$('input[type=checkbox]').val('<?php echo $hid ; ?>').tzCheckbox({labels:['<?php echo $h; ?>','<?php echo $h; ?>']});
                                            //$('#c').tzCheckbox({labels:['<?php echo $h; ?>','<?php echo $h; ?>']});
                                            $('').tzCheckbox({labels:['<?php echo $h; ?>','<?php echo $h; ?>']});
                                        });
                                    </script>
                                    <table>
                                            <td><input type="checkbox" id="c" name="u_hdr[]" value="<?php echo $hid; ?>"></td>
                                            <td style="font-weight: bolder"><?php echo $h."<br />"; ?></td>
                                    </table>
                                    <?php } ?>
                                </fieldset>
                            </div> 
```

gen_paper2.....3.....我需要在另一页中的所有这些值，所以采取了隐藏变量

```
<input type="hidden" name="hstdid" value="<?php echo $stdid; ?>">
                        <input type="hidden" name="hsubid" value="<?php echo $subid; ?>">
                        <input type="hidden" name="hdifid" value="<?php echo $difid; ?>">
                        <input type="hidden" name="hmarks" value="<?php echo $t_marks; ?>">
                        <input type="hidden" name="h_hid[]" value="<?php echo $hh; ?>"> 
```

gen_paper4.php

```
 $getstdid = $_POST['hstdid3'] ;
           $getsubid = $_POST['hsubid3'] ;
           $getdifid = $_POST['hdifid3'] ;
           $gethmarks = $_POST['htmarks'] ;
           $hdr= $_POST['h_hdrid'] ;
           $h = implode($hdr);

<table>
                                            <?php 
                                                    $h1 = explode(",",$h);
                                                    count($h1) . "<br />";
                                                    for($i=0;$i<count($h1);$i++){
                                                        $h1[$i];
                                                            $xheader = mysql_query("SELECT * from s_user_header WHERE h_id = ".$h1[$i]);
                                                            while($row = mysql_fetch_array($xheader)){ ?>
                                                                <tr>
                                                                <td><b>
                                                                <?php echo $i + 1 . ".&nbsp&nbsp&nbsp"; ?>
                                                                </b></td><td>
                                                                <?php echo  $header = $row['h_content'] . "<br />";
                                                                ?></td>
                                                                </tr>
                                                                <?php
                                                            }
                                                    }
                                            //echo $header; ?>
                                            </table> 
```

# php - 遍历从具有非唯一元素名称的 Google Maps REST API 接收的 simplexml_load_file 对象

> ID：10355331
> 
> 赞同：0
> 
> 时间：2012-04-27T17:40:02.087
> 
> 标签：php, xml, google-maps, simplexml

我试图从 Google 地图 REST API 返回的 XML中获取`<address_component>`对应的元素内的值。`<type>postal_code</type>`

例如，在下面：

```
 ...

  <result>    
    <type>
      route
    </type>    
    <formatted_address>
      Rose Ln, Liverpool, Merseyside L18 5ED, UK
    </formatted_address>    
    <address_component>      
      <long_name>
        Rose Ln
      </long_name>      
      <short_name>
        Rose Ln
      </short_name>      
      <type>
        route
      </type>      
    </address_component>    
    <address_component>      
      <long_name>
        Liverpool
      </long_name>      
      <short_name>
        Liverpool
      </short_name>      
      <type>
        locality
      </type>      
      <type>
        political
      </type>      
    </address_component>    
    <address_component>      
     ...      
    </address_component>    
    <address_component>      
    ...
    </address_component>    
    <address_component>      
      <long_name>
        L18 5ED
      </long_name>      
      <short_name>
        L18 5ED
      </short_name>      
      <type>
        postal_code
      </type>      
    </address_component>    
    <address_component>      
    ...      
    </address_component>    
   ...    
  </result>

  ... more result elements 
```

我们看到了其中一个`<result>`元素。嵌套在里面的是多个`<address_component>`元素。其中之一是`<type>postal_code</type>`。

我的问题是我将如何区分这些相同的命名元素并仅选择归因于它的`<address_component>`元素`<type>postal_code</type>`？

如果它们被唯一命名，那将是一个简单的例子：

```
foreach ($address_rsponse->result as $address_option) {
    $val = $address_option->some_unique_name;      
} 
```

但是，当命名相同时，我对通过子元素挑选元素的方法感到困惑。

任何人都可以阐明正确的方法。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:44:09.277

您可以将[XPath](http://www.w3.org/TR/xpath/)与 SimpleXML ( [docs](http://php.net/simplexmlelement.xpath) ) 一起使用。

以下将为您提供一个包含`<address_component>`您正在寻找的元素的数组。

```
$address_rsponse->result->xpath(
    'address_component[normalize-space(type)="postal_code"]') 
```

如果您想遍历`<result>`元素，以下将为您提供一个包含您要查找的元素的数组`<address_component>`，并为每个元素输出第一个`<result>`。

```
foreach ($address_rsponse->result as $result) {
    $postal_codes = $result->xpath('address_component[normalize-space(type)="postal_code"]');
    // Do whatever with the postal code(s)
    echo trim($postal_codes[0]->long_name);
} 
```

# nhibernate - NHibernate 3.3：生成了带有键属性的复合ID？

> ID：10355333
> 
> 赞同：4
> 
> 时间：2012-04-27T17:40:08.507
> 
> 标签：nhibernate, composite-id

我读过这个映射在 NHibernate 3.3 中是不可能的：

```
<class name="Digital" table="DIGITALS">
    <composite-id>
      <key-many-to-one name="Person" class="Person" column="PERSONID" />
      <key-property name="Id" column="ID">
        **<generator class="increment"/>**
      <key-property/>
    </composite-id>
    <property name="Nombre" column="NOMBRE" /> 
```

基本上我需要一个由 NH 自动计算的复合 ID 属性。

也许存在一种技术来获得类似的东西？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T07:01:53.670

你必须自己实现它，因为 CompositeIds 总是由分配给 NH 生成的

```
class Digital
{
    private static long number = 0;

    private static long NextNumber()
    {
        return Interlocked.Increment(ref number);
    }

    public Digital()
    {
        Id = NextNumber();
    }
} 
```

# javascript - 如何通过点击绘制多条折线？

> ID：10355335
> 
> 赞同：0
> 
> 时间：2012-04-27T17:40:24.020
> 
> 标签：javascript, arrays, google-maps, google-maps-api-3, google-polyline

我一直在寻找解决方案，但都是如何从 json 文件中绘制折线等。主要问题是每次单击“新建折线”按钮时如何获得创建新折线并将旧折线存储在数组中的功能？二、点击“新建折线”按钮后如何在地图上留下折线并绘制新的，只有点击右键才能清理和恢复？可能更好的方法是将折线存储在类之外，或者为此创建一个新的单独类？你可能不得不以不同的方式处理这个问题吗？

糟糕的演示，但突出了我希望的意思：[jsfiddle](http://jsfiddle.net/bartek/x8A7V/)

数组已移至全局范围，但无法在最后一条折线上设置地图只能通过 clearOverlays 函数工作。现在，其他按钮出现了并发症。我创建了额外的全局对象 newPoly 但不知道好主意是否可以更好地从 myPolyline 获取对象？在其他方面，无法在存储在数组折线中的地图上设置恢复情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T19:07:51.347

要保存您制作的折线，请创建另一个全局变量来存储折线并将它们推入，同时在数组中的最后一条折线上设置映射（null）。您不能将您制作的多段线存储在同一个对象中，因为您每次都在制作一个新的。所以移动：

```
this.polyLines = []; 
```

离开类，进入全局范围，或进入另一个类，将标记数组留在那里很好，因为这是该折线实例的本地。

这也应该有所帮助 - [https://developers.google.com/maps/documentation/javascript/overlays#OverlaysOverview](https://developers.google.com/maps/documentation/javascript/overlays#OverlaysOverview)

# c - 如何在c语言的多个源文件之间共享一个变量及其值？

> ID：10355339
> 
> 赞同：6
> 
> 时间：2012-04-27T17:40:40.853
> 
> 标签：c, global-variables

我有 2 个名为 file1.c 和 file2.c 的源文件 (.c)，它们需要在它们之间共享一个变量，因此如果在一个源文件中更新了变量，那么在访问此变量时在另一个源文件中进行更改将被看到。

我所做的是创建另一个名为 file3.c 的源文件和名为 file3.h 的头文件（当然，它包含在 file1.c file2.c 和 file3.c 中）

```
in file3.c:

int myvariable = 0;

void update(){//updating the variable

    myvariable++;

}

int get(){//getting the variable

    return myvariable;

}

in file3.h:

extern int myvariable;

void update(void);

int get(void);

in file1.c:
.
.
.
printf("myvariable = %d",get());//print 0
update();
printf("myvariable = %d",get());//print 1
.
.
.

in file2.c:
.
.
.
printf("myvariable = %d",get());//print 0 but should print 1
.
.
. 
```

但问题是当`file1.c`调用 in update 并更新 myvariable 时，无法看到更改，`file2.c`因为在 file2.c 中调用 get 并打印 myvariable 然后打印 0，只有在 file2.c 中调用 update 然后更改被看到了。似乎该变量是共享的，但是对于每个源文件，该变量都有不同的变量值/不同的内存

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T17:53:28.347

当您需要变量时，您可以在其他文件中将变量声明为[extern ...](http://en.wikipedia.org/wiki/External_variable)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T17:54:24.617

包含`file3.h`在 file1.c 和 file2.c 中

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-27T18:27:34.183

由于代码混乱，我建议避免使用`extern`变量——使用该全局变量在每个文件中重复外部变量。通过将全局变量绑定到某个文件范围通常会更好`static`。然后使用`interface`函数来访问它。在您的示例中，它将是：

```
// in file3.h
void update(int x);
int get(void);

// in file3.c:
static int myVariable = 0;

void update(int x){
  myVariable = x;
}

int get(){
  return myVariable;
}

// in other files - include file3.h and use 
// update() / get() to access static variable 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-27T19:16:14.390

这只是一种可能的解决方案。这样做，变量对整个应用程序不是全局的，只能使用访问函数读取/写入。如果您有任何问题，请告诉我。

文件：`access.c access.h file2.c main.c`
编译：`gcc main.c file2.c access.c -o test`
运行：`./test`

文件：main.c

```
#include <stdio.h>
#include "access.h"

int main( int argc, char *argv[] )
{
    int value;

    put( 1 );
    printf("%d\n", get());

    put( getValue() + 1 );
    printf("%d\n", getValue());

    return(0);
} 
```

文件：access.c

```
#include "access.h"

static int variable = 0;

int get( void )
{
    return(variable); 
}

void put( int i )
{
    variable = i;
    return;
} 
```

文件：file2.c

```
#include <stdio.h>
#include "access.h"

int getValue( void )
{
    int i = get();

    printf("getValue:: %d\n", i);

    put(++i);
    printf("after getValue:: %d\n", get());
    return( i );
} 
```

文件：access.h

```
extern int getValue( void );
extern int get( void );
extern void put( int i ); 
```

这是运行输出：

```
[root@jrn SO]# ./test
1
getValue:: 1
after getValue:: 2
getValue:: 3
after getValue:: 4
4 
```

我希望这有帮助。

# c# - 在 CheckedListBox C# 中显示目录结构

> ID：10355340
> 
> 赞同：1
> 
> 时间：2012-04-27T17:40:40.957
> 
> 标签：c#, visual-studio

我的最终目标是允许用户选择他们想要的目录作为复选框类型的东西。我可以使用此控件在每个文件夹旁边显示带有复选框的向下钻取目录结构，还是应该使用不同的路径？

编辑：更多信息。

我在 Visual Studio 中有一个使用 c# 的 Windows 窗体应用程序。这是为了让我自己和一些精选的朋友每天自动将文件夹备份到 amazon s3。我需要弄清楚如何显示计算机目录结构，您可以深入了解并选中您想要的任何文件夹旁边的框。这样，该应用程序将仅备份您选择的文件夹。CheckBoxList 似乎是正确的方法，但我不知道如何使它成为一个向下钻取列表。它似乎只显示项目列表。我可以尝试的另一种控制方法或我可以探索的另一种方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:44:39.563

如果您需要显示层次结构，只需使用带有复选框的 TreeView。

你没有告诉你是否在 Windows 窗体、WPF、ASP.NET、MVC 等中......在所有这些平台上仍然应该有这样的“可复选框”TreeView。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:45:02.287

A`CheckedListBox`显示扁平结构。A`TreeView`更适合呈现嵌套的目录结构。

# sql - 返回字符串中子字符串的所有结果

> ID：10355346
> 
> 赞同：0
> 
> 时间：2012-04-27T17:40:56.373
> 
> 标签：sql, sql-server-2008

我在供应商数据库中有一些奇怪的数据，但需要能够从数据库中的一个字段中提取多个不同的参数。

所以从这个例子中我想拉出所有介于 (" % ") 之间的项目

引号之间是一个字符串，忽略它看起来像代码：

"Func_GetParameterLatestValue("IBW 患者身高 RT 评估") kHeight =Func_GetParameterLatestValue("IBW 通风口其他高度") If (kSex) = "" Then
Return_Value =NULL Else If kHeight > 0 Then If kSex=1 Then Return_Value= Round(( (kHeight - 152.4)*.91)+50,0) Else
Return_Value= Round(((kHeight - 152.4)*.91)+45.5,0) End IF Else Return_Value = NULL End IF End IF ' Return_Value = kHeight '( "IBW 患者身高 RT 评估")"

所以返回值是：

```
IBW Patient Height RT Assess,
Height For IBW Vent Misc,
IBW Patient Height RT Assess 
```

我愿意接受任何建议来尝试完成这项工作。理想情况下，我希望能够在子查询中猛烈抨击结果，以确保它们存在于另一个表中。

此查询当前返回第一个实例

```
select vbs.Name, 
        SUBSTRING(sd.FormulaDetails, 
                  CHARINDEX('("', sd.FormulaDetails)+2,(CHARINDEX('")',sd.FormulaDetails) - CHARINDEX('("', sd.FormulaDetails))-2)
from StatementDefinitions sd, MvVBScript vbs
where sd.ScriptID = vbs.ID 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T02:35:40.323

您可以使用 WITH 语句递归地执行此操作。这是一个镜头。将 varchar(max) 更改为您的 FormulaDetails 列的任何数据类型。如果您需要，此查询将返回 ScriptID 并编号它找到的块的位置（因此“IBW Vent Misc 的高度”将出现 2）

```
with Chunks(id,occurrence,position,token,remainder) as (
  select
    ScriptID,
    cast(0 as int),
    charindex(@token,FormulaDetails),
    cast('' as varchar(max)),
    substring(c,charindex(@token,FormulaDetails)+1,len(FormulaDetails))
  from StatementDefinitions
  where FormulaDetails like '%'+@token+'%'
  union all
  select
    id,
    occurrence+1,
    charindex(@token,remainder)+position,
    cast(substring(remainder,1,charindex(@token,remainder)-1) as varchar(max)),
    substring(remainder,charindex(@token,remainder)+1,len(remainder))
  from Chunks
  where remainder like '%'+@token+'%'
)
  select id, occurrence, token from Chunks
  where occurrence > 0
  order by id; 
```

# html - CSS 径向剪辑

> ID：10355352
> 
> 赞同：0
> 
> 时间：2012-04-27T17:42:01.017
> 
> 标签：html, css

我有一个圆圈（png）的图像，我想用`clip`它来掩盖它的一部分。有这种类型的径向夹吗？（假设我想将圆圈转换为饼图，例如仅 32%）使用剪辑蒙版

编辑：如果这不可能，也许关于 SVG 覆盖的提示会很好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:43:50.417

使用画布（以及一小部分 jquery 来获取节点引用）：

```
var ctx = $( '#canvasTag' )[0].getContext( '2d' );

// draw your image
ctx.drawImage( $( '#imgTag' )[0], x, y );

// change composite operation so that only the image below the arc below shows
ctx.globalCompositeOperation = 'destination-in';

// draw part of a circle
ctx.beginPath();
ctx.arc( x, y, radius, startAngle, endAngle, false ); // draw outer arc
ctx.lineTo( x, y );                                   // draw to center
ctx.closePath();
ctx.fill(); 
```

# svg - 从 svg 到 Raphael

> ID：10355355
> 
> 赞同：2
> 
> 时间：2012-04-27T17:42:10.010
> 
> 标签：svg, raphael

我有一个 svg 文件，我正试图在 Raphael 中进行渲染。问题在于转型。我无法获得扩展和转换的路径。谁能告诉我我做错了什么？

这是我在 svg 中的原始代码：

```
<svg  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" width="1000.000000pt" height="618.000000pt" viewBox="0 0 1024 768" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" zoomAndPan="magnify" onload="javascript: init(evt);">
<g transform="translate(0.000000,309.000000) scale(0.100000,-0.100000)" fill="#cc6633" stroke="none">
<path d="M410 1078 c0 -20 -8 -32 -27 -42 -16 -9 -54 -39 -86 -68 l-58 -53 67 -75 c67 -76 78 -83 217 -140 58 -24 77 -37 77 -51 0 -11 -7 -19 -17 -19 -15 0 -16 -2 -3 -10 21 -13 53 -12 73 3 19 13 46 110 47 165 0 17 5 32 11 32 27 0 50 44 47 89 -3 39 -7 48 -30 59 -38 18 -35 39 9 80 30 27 35 35 22 42 -8 5 -90 10 -182 12 l-167 3 0 -27z" id="Allegheny" label="Allegheny" >
</path>
</g>
</svg> 
```

这是我的拉斐尔代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>Raphaël </title>
        <style>
            #canvas {

            }
            #paper {

            }
            #Allegheny {

            }
        </style>
        <script src="raphael-min.js" type="text/javascript" charset="utf-8"></script>
        <script type="text/javascript" charset="utf-8">
        window.onload = function () {
            var R = Raphael("paper", 1000, 800);
            var attr = {
                fill: "#ccc",
                stroke: "#333",
                "stroke-width": 1,
                "stroke-linejoin": "round"

            };
            var pa = {};
            pa.Allegheny = R.path("M410 1078 c0 -20 -8 -32 -27 -42 -16 -9 -54 -39 -86 -68 l-58 -53 67 -75 c67 -76 78 -83 217 -140 58 -24 77 -37 77 -51 0 -11 -7 -19 -17 -19 -15 0 -16 -2 -3 -10 21 -13 53 -12 73 3 19 13 46 110 47 165 0 17 5 32 11 32 27 0 50 44 47 89 -3 39 -7 48 -30 59 -38 18 -35 39 9 80 30 27 35 35 22 42 -8 5 -90 10 -182 12 l-167 3 0 -27z").attr(attr);
            R.setViewBox(0, 0, 1024, 768, false);
        R.transform(T0,309);
        R.transform(s0.1);

        };
        </script>
    </head>
    <body>
        <div id="canvas">
            <div id="paper"></div>
            <div id="Allegheny"></div>
        </div>

    </body>
</html> 
```

你可以看到[http://blogs.sites.post-gazette.com/demo/index.html](http://blogs.sites.post-gazette.com/demo/index.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:04:23.160

几件事：

1.  为 的参数加上引号`transform()`。
2.  您可以在一次调用中包含所有转换（请参阅[API](http://raphaeljs.com/reference.html#Element.transform)）。
3.  你可能想要转型`pa.Allegheny`，而不是`R`

所以：

```
pa.Allegheny.transform("T0,309s0.1"); 
```

# mysql - 使用更新增加列或创建更新触发器 - mysql

> ID：10355358
> 
> 赞同：0
> 
> 时间：2012-04-27T17:42:44.703
> 
> 标签：mysql, performance, triggers, sql-update

当 A 或 B 或 C 列更新时，我必须增加 D 列（在同一张表中）。1\. 我应该在 A、B 或 C 更新后使用另一个更新语句来增加 D 列吗？或者 2\. 我应该使用触发器吗？

哪种方式更好更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:49:58.710

使用触发器。这就是他们的目的。

# android - 使用 Ant 构建项目并运行 JUnit Test Android 应用程序，但 Ant Junit Test 失败

> ID：10355363
> 
> 赞同：4
> 
> 时间：2012-04-27T17:43:02.563
> 
> 标签：android, ant, junit

我创建了一个简单的 Android 项目。我还为该项目创建了 Junit 案例。我在同一个项目中有我的 Android 应用程序和 TestCases。我的结构如下：

```
-AndroidApp
    -src
       -SampleActivity
    -tests
       -SampleActivityTest 
```

我更改了 Order 和 export 选项，并确保 JUnit 位于顶部。
我已经添加了

```
<instrumentation android:name="android.test.InstrumentationTestRunner"
android:targetPackage="com.sample.app"
android:label="UnitTest" />
<uses-library android:name="android.test.runner" /> 
```

在 Eclipse 中运行 Android JUnit Test 工作正常，但是当我尝试使用 Ant 构建和 Junit 测试应用程序时，项目/应用程序构建但测试失败。

这是错误：

```
test-run:
       [junit] Test com.mark.prototype.test.SampleAndroidAppTest FAILED

compile-and-test:
BUILD SUCCESSFUL
Total time: 3 seconds 
```

无法弄清楚为什么它在 Ant 中失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T06:22:15.037

最好的方法是通过 Export 创建自动 ant 构建，然后选择 Ant BuildFiles，然后根据您的要求进行修改。

# box-api - curl 文件下载示例不起作用

> ID：10355364
> 
> 赞同：1
> 
> 时间：2012-04-27T17:43:10.987
> 
> 标签：box-api

如果我按照 box api 2.0 curl 示例获取文件的元数据，我会得到信息。当我将 /data 附加到 url 以下载文件时，curl 说：

curl：（52）来自服务器的空回复

我用两个文件做了这个，都是文本文件，结果相同。

这里的系统是 OpenBSD 5.0。

在 python 3 中，相同的请求引发了一个异常，表明来自服务器的回复包含一个空的状态行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T16:41:39.317

我遇到过同样的问题。问题是您需要将`CURLOPT_FOLLOWLOCATION`选项设置为true。Box 将执行从 API 调用到实际文件的重定向。没有它，它将返回一个空响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T09:03:39.350

我遇到了同样的问题。我已成功上传文件，检索了文件 ID，然后当我尝试下载文件时，没有任何反应。就像提到的原始海报一样，如果我去掉 URL 的“/data”部分，那么我可以成功获取有关该文件的所有信息。

这是我的“下载代码”，它是从带有该特定文件 ID 的简单“下载文件”按钮的表单中调用的。

```
$boxkey = "ThisIsMyAPIKey";
$auth_token = $_POST['auth_token'];
$url = "https://www.box.com/api/2.0/files/".$_POST['file_id']."/data";
$header = array("Authorization: BoxAuth api_key=".$boxkey."&auth_token=".$auth_token);

$ch = curl_init(); 

curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HTTPHEADER, $header);

curl_exec($ch);

curl_close($ch); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T21:33:05.227

如果文件本身为空，则应返回空响应。例如，如果两个文本文件中没有任何文本，则不会返回任何文本，即这似乎是预期的行为。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-05-14T14:34:29.797

```
$url = "https://api.box.com/2.0/files/$fileId/content?access_token=$accessToken";
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
$data = curl_exec($ch);
curl_close($ch); 
```

# php - Zend fetchAll foreach 2 次运行不循环第二次；

> ID：10355367
> 
> 赞同：0
> 
> 时间：2012-04-27T17:43:32.473
> 
> 标签：php, zend-framework, foreach

这很容易理解

图像类

```
<?php
class Image extends Zend_Db_Table_Abstract {

    protected $_name = 'images';

    public function getList() {
        return $this->fetchAll();
    }
}?> 
```

我的 PHP 代码

```
<?php

require 'config.php';

$imgTable = new Image();  // Create Object

$imgList = $imgTable->getList(); // fetch Data

$template = new Template('portfolio'); // Initialize Template and tell which template to pick

$template->imgList = $imgList; // set template variable

$template->render(); // Generate Template output

?> 
```

我可以使用 $this 访问模板内的模板变量

下面的代码来自模板内部

```
$xback = 0;
foreach ($this->imgList as $images) {
    echo 'imageArray[' . $xback . '] = "' . $images['sef'] . '";';
    $xback++;
}
?>
.......
<?php

foreach ($this->imgList as $images) {

?>
    <div class="portfolio_item">
    <img src="<?php echo PATH_WEB . $images['image_thumb'] ?>" height="146" width="209" />
    <div class="title"><?php echo $images['image_title'] ?></div>
    <div class="right link">
        <a href="javascript:;" onclick="showItemDetails('<?php echo $images['sef'] ?>')">View Details</a>
    </div>
    </div>
<?php
}

?> 
```

上面的代码工作正常，但在几行下面，我必须再次迭代相同的数据，不输出任何东西。如果我评论第一个，第二个开始工作。

第一个是创建 JS 数组并在 head 部分，第二个部分是在 HTML 中显示图像

我希望它是一个指针问题，我可能必须将循环当前项目设置为启动，但我现在不理解它....`reset($this->imgList)`没用

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T19:46:18.320

我认为这与`fetchAll`通话有关，试试这个：

```
<?php
class Image extends Zend_Db_Table_Abstract {

    protected $_name = 'images';
    protected $images;

    public function getList() {

        // Employ lazy loading pattern to load images if they aren't set yet
        if (!isset($this->$images)) {
            $this->images = $this->fetchAll();
        }

        return $this->images;
    }
}?> 
```

# vb.net - 如何克服“从'字节'到'字符串'的转换不能发生在常量表达式中。” 在VB中？

> ID：10355371
> 
> 赞同：0
> 
> 时间：2012-04-27T17:43:39.790
> 
> 标签：vb.net, list, variables, constants, type-conversion

我有这个代码：

```
Public Class Beryllium
    Public Const AtomicNumber As Byte = 4
    Public Const Symbol As String = "Be"
    Public Const Name As String = "Beryllium"
    Public Const AtomicMass As Double = 9.012182

    Public Const List = AtomicNumber & vbNewLine & Symbol & vbNewLine & Name & vbNewLine & AtomicMass 'This line
End Class 
```

我想列出所有常量（AtomicNumber、Symbol、Name 和 AtomicMass）。我想让列表也成为一个常数。当我运行上面的代码时，我收到一个突出显示 AtomicNumber 的错误（在我评论“这一行”的那一行）。我尝试了 .ToString() 和 CStr() 但我都得到了错误。也许有一种不同的方法可以使这些常量成为一个字符串或列表（必须是公共的并且有新的行）？有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:46:33.423

创建`List`一个只读属性。

这将允许您使用`ToString()`.`AtomicNumber`

```
Public ReadOnly Property List() As String
  Get
    Return AtomicNumber.ToString() & vbNewLine & Symbol & vbNewLine & Name & vbNewLine & AtomicMass
  End Get
End Property 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:56:42.260

您不能在常量表达式中执行此操作，因为常量表达式需要在编译时计算值。但是，double 的“ToString()”值在编译时是未知的，因为 ToString 是 Double 类在运行时运行的方法。所以，编译器不知道它最终会返回什么。但是，.NET 具有`readonly`处理此类情况的修饰符。如果您将线路更改为：

```
Public Shared ReadOnly List = AtomicNumber & vbNewLine & Symbol & vbNewLine & Name & vbNewLine & AtomicMass 
```

你会看到它会起作用。这个只读字段在类加载到内存后立即计算，并且不能被任何客户端更改，因此它几乎等同于 const。当然，唯一的区别是，您在计算该值时会产生一些开销。此外，使用 consts，编译器可以执行一些其他优化，例如直接替换常量值而不是取消引用它。即，如果您的代码说：

```
Public Const Name As String = "Beryllium"

If (something = Name)... 
```

如果您查看编译后的代码，它实际上会说：

```
If (something = "Beryllium") 
```

# java - 返回类型与继承的方法不兼容

> ID：10355374
> 
> 赞同：3
> 
> 时间：2012-04-27T17:43:52.170
> 
> 标签：java, oop, inheritance, types, incompatibility

```
 class A {
        public A get() { }
 }

 class B extends A {

 } 
```

返回类型与继承的方法不兼容，如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T19:26:52.990

从 JDK 5 开始，Java 允许您更改被覆盖方法的返回类型，只要新类型是原始类型的子类即可。这称为[协变返回类型](http://en.wikipedia.org/wiki/Covariant_return_type)。以下代码将正确编译：

```
class A {

    A get() {
        return new A();
    }

    void sayHello(){
        System.out.println("Hello");    
    }
}

class B extends A {

    @Override
    B get() {
        return new B();
    }

    void sayGoodbye(){
        System.out.println("Goodbye");
    }
}

class Test{
    void check(){
        B two=new B();
        two.get().sayGoodbye();
    } 
} 
```

请记住，被覆盖方法的返回类型应该是返回类型的子类，以允许您在 A 变量上调用该方法并获取有效的 A 对象（实际上是 B 实例）：

```
 void check(){
            A two=new B();
            A copy=two.get();
            copy.sayHello();
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:57:18.500

我假设您想编写`B b = new B().get();`类似 Nikita Beloglazov 建议的没有显式类型转换的东西，尽管这不是 Java 支持的习语。尤金的回答效果很好，尽管这仍然涉及强制转换`T`并产生一个丑陋的编译器警告。就个人而言，我会编写更像以下的代码：

```
class A {
    private A() {}

    public A get() {
        return new A();
    }
}

class B extends A {
    private B() {}

    @Override
    public A get() {
        return new B();
    }

    public B getB() {
        return (B) get();
    }
} 
```

你仍然不能做`B b = new B().get();`，但你可以做`B b = new B().getB();`，这同样容易，而且更容易自我记录，因为你已经知道你想要一个`B`对象，而不仅仅是任何`A`对象。并且`A a = new B().get();`会创建一个 B 对象，尽管它只能访问在`A`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:07:18.447

使用泛型：

```
 class A<T extends A> {
        public T get() { }
 }

 class B extends A<B> {

 }

B b = new B();
B got = b.get(); 
```

# php - PHP - 使用 cURL 的 DENIC whois 查询效果不佳

> ID：10355375
> 
> 赞同：0
> 
> 时间：2012-04-27T17:43:52.950
> 
> 标签：php, curl, whois

当我使用 fsockopen 检查 .de-domain 的可用性时，它始终会提供结果，但是当使用 cURL 执行相同操作时，大约 75% 的查询会失败。curl_errno 然后提供错误代码 56 (CURLE_RECV_ERROR)。当我尝试使用 whois.crsnic.net 检查 .com-domain 时，cURL 每次都可以正常工作。只有 whois.denic.de 会惹麻烦。

这是代码：

```
$domain = "google.de";
$whois_server = "whois.denic.de";

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $whois_server.":43"); // Whois Server
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_TIMEOUT, 10);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, $domain."\r\n"); // Query
$whois = curl_exec ($ch);  

echo "RESULT: ".$whois;
echo "<br/>";
echo curl_errno ($ch);
echo "<br/>"; 
```

这是 fsockopen 查询：

```
fsockopen($whois_server,43, $errno, $error, 5); 
```

有谁知道可能出了什么问题？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-04T14:28:14.737

`whois.denic.de`需要`-T dn`在您的请求之前添加。

例如：

```
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "-T dn $domain\r\n"); // Query 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T19:48:52.443

你是linux还是windows？如果在linux中只执行：

```
system('whois google.de'); 
```

# php - Ajax iFrame：PHP 不会在我的循环中添加来自 SQL 的不同字符串（以重建 HTML 代码）。

> ID：10355376
> 
> 赞同：0
> 
> 时间：2012-04-27T17:43:57.803
> 
> 标签：php, javascript, ajax, string, while-loop

下面的 PHP 代码有错误。我尝试根据访问者的某些选择重建一个列表，并通过 Ajax iframe 将其放回我的 HTML 中。

当我尝试在循环中添加字符串时，问题来自这一行：

```
$tempr.='<option value=\"'.$donnees['name'].'\">'.$donnees['name'].'</option>'); 
```

确实，当我将其替换为（例如）时：

```
$tempr.='<option value=\"loop\">loop</option>; 
```

它完美地工作。我试图分开不同的字符串，str_replace，把/放在任何地方，但它不起作用。我想知道我的 SQL 数据库是否太大……但这不太可能。好吧，我迷路了。

感谢我们的帮助！！！！

```
$req = $bdd->prepare('SELECT name FROM regions WHERE country = :country');
$req->execute(array('country' => $_SESSION['codepays']));
$donnees = $req->fetch();

$tempr='<select name=\"regionm\" id=\"regionm\" onchange=\"validregion();\">';

$req = $bdd->prepare('SELECT name FROM regions WHERE country = :country');
                $req->execute(array('country' => $_SESSION['codepays']));
                $donnees = $req->fetch();
                $i='0';
                while($donnees)
                    {   

                        $tempr.='<option value=\"'.$donnees['name'].'\">'.$donnees['name'].'</option>');    

                        $donnees = $req->fetch();
                    }

$tempr.='<option value=\"test\">test</option></select>';    

echo '<script language="JavaScript" type="text/javascript">'."\n";
echo 'var parDoc = window.parent.document;'."\n";
echo 'parDoc.getElementById("regionreplace").innerHTML="'.$tempr.'";'."\n";
echo "\n".'</script>';      

$req->closeCursor(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:48:49.047

我能想到的唯一潜在问题是`" < >`你的字符串中有类似的字符。试试这个代码：

```
 $tempr.='<option value=\"'.htmlspecialchars($donnees['name']).'\">'.$donnees['name'].'</option>'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:59:36.927

也许：

```
$donnees = $req->execute(array('country' => $_SESSION['codepays']));
while(!$donnees->EOF)
{   
    $tempr.='<option value="'.htmlspecialchars($donnees->fields['name']).'">'.$donnees->fields['name'].'</option>';
    $req->MoveNext();
} 
```

# wpf - 网格背景图像不透明度动画

> ID：10355379
> 
> 赞同：1
> 
> 时间：2012-04-27T17:44:08.920
> 
> 标签：wpf, animation

[使用 wpf 创建了一个类似 jquery-nivo](http://nivo.dev7studios.com/)的简单滑块，并希望在幻灯片之间添加一个动画，该动画淡化背景，更改背景图像，最后淡出新的背景图像。我正在尝试执行以下操作....我没有收到错误，背景更改，但也没有任何动画...我做错了什么？

```
public void SetSlider(MyItem item)
    {
        //Fade out
        DoubleAnimation fadeOutAnimation = new DoubleAnimation(0, TimeSpan.FromSeconds(3));
        fadeOutAnimation.AutoReverse = false;
        grdContent.Background.BeginAnimation(Brush.OpacityProperty, fadeOutAnimation);

        //set background
        ImageBrush bgBrush = new ImageBrush();
        bgBrush.ImageSource = new BitmapImage(new Uri(item.ImageFile.SavedDirectoryAndFile, UriKind.Absolute));
        grdContent.Background = bgBrush;

        //Set title
        txtTitle.Text = item.Title;

        //set Summary
        txtSummary.Text = item.Summary;

        //Fade back in
        DoubleAnimation fadeInAnimation = new DoubleAnimation(1, TimeSpan.FromSeconds(3));
        fadeInAnimation.AutoReverse = false;
        grdContent.Background.BeginAnimation(Brush.OpacityProperty, fadeInAnimation);        
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T20:23:46.797

想通了...我必须将动画应用于背景属性中设置的画笔...而不是背景属性本身，我必须进行一些时间更改。这是我的最终解决方案：

```
public void SetSlider(MyItem item)
    {
        //Create the fade out animation. 
        DoubleAnimation fadeOutAnimation = new DoubleAnimation(0, TimeSpan.FromMilliseconds(500));
        fadeOutAnimation.AutoReverse = false;

        //wait until the first animation is complete before changing the background, or else it will appear to just "fadeIn" with now fadeout.
        fadeOutAnimation.Completed += delegate(object sender, EventArgs e)
        {
            //once the fadeout is complete set the new back ground and fade back in. 
            //Create a new background brush. 
            ImageBrush bgBrush = new ImageBrush();
            bgBrush.ImageSource = new BitmapImage(new Uri(item.ImageFile.SavedDirectoryAndFile, UriKind.Absolute));
            bgBrush.Opacity = 0;

            //Set the grid background to the new brush. 
            grdContent.Background = bgBrush; 

            //Set the brush...(not the background property) with the animation. 
            DoubleAnimation fadeInAnimation = new DoubleAnimation(1, TimeSpan.FromMilliseconds(500));
            fadeInAnimation.AutoReverse = false;
            bgBrush.BeginAnimation(Brush.OpacityProperty, fadeInAnimation);
        };

        //Fade out..before changing the background. 
        var currentBackground = grdContent.Background;
        currentBackground.BeginAnimation(Brush.OpacityProperty, fadeOutAnimation);

        //Set title
        txtTitle.Text = item.Title;

        //set Summary
        txtSummary.Text = item.Summary;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:10:29.303

一种更简单的方法是使用[Transitional](http://transitionals.codeplex.com)，他们有一个图像动画示例项目。

参考：

```
xmlns:trans="clr-namespace:Transitionals;assembly=Transitionals"
xmlns:transc="clr-namespace:Transitionals.Controls;assembly=Transitionals"
xmlns:transt="clr-namespace:Transitionals.Transitions;assembly=Transitionals"
xmlns:refl="clr-namespace:System.Reflection;assembly=mscorlib"

 <transc:TransitionElement x:Name="TransitionBox" Grid.Row="1" Content="{Binding 
             CurrentImage}">
   <transc:TransitionElement.Transition>
      <transt:TranslateTransition StartPoint="1,0" EndPoint="0,0"  
                Duration="0:0:0.6"/>
        </transc:TransitionElement.Transition>
    </transc:TransitionElement> 
```

或者如果它是自动转换，则使用它具有的幻灯片控件。

```
 <transc:Slideshow.TransitionSelector>
                <trans:RandomTransitionSelector>
                    <trans:RandomTransitionSelector.TransitionAssemblies>
                        <refl:AssemblyName Name="Transitionals" />
                    </trans:RandomTransitionSelector.TransitionAssemblies>
                </trans:RandomTransitionSelector>
 </transc:Slideshow.TransitionSelector> 
```

# c# - WCF服务最简单的安全方法是什么

> ID：10355384
> 
> 赞同：4
> 
> 时间：2012-04-27T17:44:22.270
> 
> 标签：c#, wcf, wcf-binding, wcf-security

它运行在 IIS 7.0 中托管的 Intranet、.net 框架 3.5 中，并且它使用具有 null 安全性的 wsHttpBinding。现在我必须保护它，只允许特定用户可以运行它。

似乎我应该使用 SSL 和证书，但我真的很想远离它，因为看起来很复杂，基本上我正在寻找最简单的方法。

我看了一下netTcpBinding，在我看来这是正确的方法，如果是这样，您能否确认是否使用net.tcp 它可以被某些asp.net 站点使用。

欢迎任何意见。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:17:57.977

您说您正在使用 Intranet 应用程序。

如果是这样，您可以打开 Windows 身份验证，并仅允许 IIS 中的特定用户（这也在 web.config 中进行控制）。如果每个人都在 Intranet 上，它应该自动进行身份验证，用户无需输入密码或用户名。

但是，如果您的 Intranet 之外的任何人需要访问此服务，则您需要包含 SSL 和 https 以保护发送到该服务的凭据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T18:17:58.550

在您的情况下，您有一个 Intranet，这意味着您有内部用户。这取决于对 WCF 服务的调用来自何处。

如果我们假设：

*   登录到 Windows 域的内部用户
*   客户端机器和服务器在同一个域中
*   用户在他们的机器上运行一个 Windows 应用程序，这使得 WCF 调用

那么最简单的解决方案就是使用windows认证

*   The client makes the call in the security context of the logged on user
*   The server checks the group membership of the user to determin if it should allow access

# java - 递归 - 在 Java 中无法理解这个简单的算术

> ID：10355391
> 
> 赞同：-1
> 
> 时间：2012-04-27T17:44:58.170
> 
> 标签：java, recursion

我正在研究我大学的旧试卷，以便为即将到来的考试做准备。从最简单的问题到最复杂的问题，一切都很容易理解。但是，为了我的一生，我无法弄清楚以下一个。

```
class k{
    static int g(int n) {
        if (n==0){
            return 1;
        } else {
            return 2*g(n-1);
        }
    }
    public static void main(String[] args) {
        System.out.println(g(3));
    }
} 
```

为什么此代码返回 8 作为答案。我知道它基本上是一个幂函数，其中输入的数字计算为 2 的该数字的幂，因此在这种情况下的答案是 8。但真正发生了什么。我不明白。有人可以用简单的英语解释一下吗？我真的很感激。

顺便说一句，这个问题只问输出是什么，而不是为什么。但如果我知道为什么会这样，我会感觉更舒服。

PS：人们以 5 为例给出答案的原因是我在上面的代码中错误地把 5 而不是 3 放在了上面，我现在已经更正了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T17:46:29.517

这称为递归。除非 n 为零，否则将 n 减 1 并乘以 2。

```
return 2 * g(5-1)

return 2 * g(4-1) 
```

ETC..，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T17:55:03.090

就像大家说的那样递归，但是对于 n 的初始值似乎有些混乱。示例中为 3。

```
g(3) = return 2 * g(2);

g(2) = return 2 * g(1);

g(1) = return 2 * g(0);

g(0) = return 1; 
```

即 2 * 2 * 2 * 1 = 8

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T17:51:49.193

你应该学习[递归](http://en.wikipedia.org/wiki/Recursion)。上面的例子确实如此`2 ^ n`。所以为`n=4`你得到`16`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-27T17:53:28.100

它是一个递归函数，一次取一小部分算术，然后将其余部分发送，直到满足某个结束条件。

以著名的阶乘递归方法为例。

```
public long factorial(int n) {
     return n == 0 ? 1 : n * factorial(n-1)
} 
```

如果我们调用`factorial(3)`，我们需要执行以下操作。

```
factorial(3) => 3 * factorial(3-1) => 3 * 2 * factorial(2-1) => 3 * 2 * 1 * factorial(1-1) 
```

你可以从这里看到递归展开。将这种类似的策略应用到你的代码片段中，你就会明白为什么答案是这样的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-27T17:57:00.993

g(1) = 2*g(0) = 2

g(2) = 2*g(1) = 4

g(3) = 2*g(2) = 8

g(4) = 2*g(3) = 16

g(5) = 2*g(4) = 32

g(5) 将是 32。g(3) 将是 8。

# java - 什么时候建议使用 ThreadLocal 单例而不是请求属性？

> ID：10355394
> 
> 赞同：1
> 
> 时间：2012-04-27T17:45:03.580
> 
> 标签：java, servlets, httprequest, thread-local

如果我的 ThreadLocal 单例无论如何都只会在请求的生命周期内存活，那么为什么不直接使用请求属性呢？这只是一种无需通过或到达请求对象即可在单个线程中获取上下文的简单方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:47:00.470

我的观点是，使用请求属性比使用`ThreadLocal`变量更可取。

它使代码更干净，您不必担心清理`ThreadLocal`（因为它可能会在另一个重新使用同一线程的请求的上下文中被重新使用）。

虽然，正确设计和编码的本地请求存储通过`ThreadLocal`是很好的，如果使用`ThreadLocal`被封装并且您不只是在不同的类之间共享一个实例（并且它的生命周期得到了正确处理）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:53:48.663

在较大的多层应用程序中，您通常不希望假设工作范围是 Web 请求，或者依赖于较低层内的固有“Web”事物。如果您将此工作单元作为后台作业执行会怎样？或者它是通过您最终支持的一些遗留二进制接口到达的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T17:56:29.020

使用 ThreadLocal 单例的缺点与在任何其他上下文中使用单例的缺点相同。您失去了封装、可重用性和模拟功能的能力。

优点是易于使用、类型安全（无强制转换）和可能的性能（但在整体方案中可能微不足道）。

我建议不要使用 ThreadLocal 单例，除非功能被很好地封装并且只能在非常高级的代码层中访问（明确地将您的上下文传递到更深层次的类和函数中，而不是让它们访问单例）。

# ruby-on-rails - rspec ./spec/controllers/pages_controller_spec.rb:13 # PagesController GET 'home' 应该有正确的标题

> ID：10355398
> 
> 赞同：0
> 
> 时间：2012-04-27T17:45:22.153
> 
> 标签：ruby-on-rails, rspec

我正在阅读 Michaels Hartls Ruby on Rails 教程。在第 3 章中，我按照说明设置了 R Spec 和自动测试。到目前为止，我已经完成了教程中指示的所有内容，但我不断收到此错误消息。

```
rspec ./spec/controllers/pages_controller_spec.rb:13 # PagesController GET 'home' should have the right title
rspec ./spec/controllers/pages_controller_spec.rb:31 # PagesController GET 'contact' should have the right title
rspec ./spec/controllers/pages_controller_spec.rb:43 # PagesController GET 'about' should have the right title
rspec ./spec/controllers/pages_controller_spec.rb:57 # PagesController GET 'help' should have the right title' 
```

我的 Gemfile 显示

```
source 'https://rubygems.org'

gem 'rails', '3.2.3'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'
gem 'heroku'

group :development do

 gem 'autotest', '4.4.6'
 gem 'rspec-rails', '2.9.0'
end
# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

group :production do
# gems specifically for Heroku go here  
   gem 'pg'
end
group :test do

gem 'rspec',  '2.9.0'
gem 'webrat', '0.7.3'
gem "spork",  '0.9.0'

end
  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
   gem 'therubyracer', :platform => :ruby
   gem 'execjs'
  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'ruby-debug19', :require => 'ruby-debug' 
```

我的 application.html.erb 显示

```
 <!DOCTYPE>
<html>
    <head>
        <title><%= title %></title>
        <%= csrf_meta_tag %>
        </head>
    <body>
        <%= yield %>
    </body>
</html> 
```

我的 page_controller_spec.rb 显示了这个

```
 require 'spec_helper'

describe PagesController do
render_views
#home

  describe "GET 'home'" do
    it "should be successful" do
      get 'home'
      response.should be_success
    end

    it "should have the right title" do
      get 'home'
      response.should have_selector("title", 
                      :content => @base_title + " | Home")
     end

     it "should have a non-blank body" do
  get 'home'
  response.body.should_not =~ /<body>\s*<\/body>/
end
 end 
  #contact

  describe "GET 'contact'" do
    it "should be successful" do
      get 'contact'
      response.should be_success
    end 
      it "should have the right title" do
      get 'contact'
      response.should have_selector("title",
                      :content => @base_title + " | Contact")
  end
  end
#about
  describe "GET 'about'" do
    it "should be successful" do
      get 'about'
            response.should be_success
      end      
             it "should have the right title" do
      get 'about'
      response.should have_selector("title", 
                      :content =>  @base_title  + "  | About")
    end 
    end

    #help

  describe "GET 'help'" do
    it "should be successful" do
      get 'help'
            response.should be_success
      end      
             it "should have the right title" do
      get 'help'
      response.should have_selector("title", 
                      :content => @base_title + "| Help")
    end 
    end  
  end 
```

pages_helper.rb 有

```
module PagesHelper

      # Return a title an a per-page basis
    def title
      base_title = "Ruby on Rails Tutorial Sample App"
      if @title.nil?
        base_title
      else
        "#{base_title} | #{@title}"
      end
    end
    end 
```

pages_controller.rb 有

```
class PagesController < ApplicationController

  def home
        @title = 'home'
     end

  def contact
    @title = 'contact'
  end

  def about
    @title = 'about'
  end

   def help
    @title = 'help'
  end

end 
```

一切都在浏览器中显示良好。但是当我使用 rspec spec/.. 运行我的测试时，我仍然会遇到这些错误。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T20:04:07.867

你需要设置`@base_title`. 您可以在使用它之前在规范中的任何位置设置它，但由于它在任何地方都是相同的，您可以将它放在一个`before`块中，即

```
before(:each) do
  @base_title = ...
end 
```

你也可以使用`let`（但是规范需要使用`base_title`而不是`@base_title`

# wordpress - Wordpress 创建带有帖子索引的特殊子页面

> ID：10355400
> 
> 赞同：1
> 
> 时间：2012-04-27T17:45:27.983
> 
> 标签：wordpress, themes

我有一个 wordpress 博客，我将首页设置为一个页面而不是一系列帖子。现在我想在子页面上创建最新帖子的索引。例如，我想在用户输入 /domain.com/articles/ 时列出最近的帖子，并在有人输入 /domain.com/ 时显示一个页面

我不想使用插件，我想直接将其编码到主题中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:00:17.037

如果您为 slug 创建一个包含文章的新页面（即 www.domain.com/articles，其中文章是“slug”），您可以在主题中创建名为 page-articles.php 的自定义模板文件，该文件将为文章页面设置样式. 然后，您可以将循环代码从 index.php 转移到 page-articles.php。

# http - 如何在 URL 中传递用户名和密码

> ID：10355401
> 
> 赞同：0
> 
> 时间：2012-04-27T17:45:30.147
> 
> 标签：http, url, url-rewriting, web

我们有一个很长的供应商列表，每个供应商网站都有自己的用户名和密码，我们想制作一个 URL 列表，所以一个员工可以点击其中一个 URL，他/她可以直接登录到供应商网站，而无需必须输入登录详细信息。

我尝试使用从 firebug 传递的参数（包括用户名和密码）复制位置，但这不起作用，它将我重定向到登录页面，有没有更好的方法来做到这一点？

# android - Android 微调器的自定义布局问题

> ID：10355404
> 
> 赞同：0
> 
> 时间：2012-04-27T17:45:43.097
> 
> 标签：android, android-layout, custom-controls, spinner

我知道有很多关于自定义微调器的讨论，但是我仍然无法掌握如何去做。我想要的是一个微调器，它具有下拉项的自定义布局以及未“激活”时微调器的自定义布局。当应用程序运行时，微调器具有特定的布局（未激活时），但是当激活时它会崩溃，这让我相信 xml 可能存在问题。但是就这样（顺便说一句，我使用单声道和 c#）；

我以这种方式为微调器创建了一个 ArrayAdapter，在这里我为微调器 Resource.Layout.SpinnerView 和下拉 Resource.Layout.SpinnerRow 设置了一个布局：

```
ArrayAdapter  spinnerArrayAdapter = new ArrayAdapter(this.Context,Resource.Layout.SpinnerView,Resource.Id.spinnertext,_listOfUmbracoItems);       
spinnerArrayAdapter.SetDropDownViewResource(Resource.Layout.SpinnerRow); 
```

Resource.Layout.SpinnerView：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:local="http://schemas.android.com/apk/res/dk.appsfabrikken.cmsapp"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    >
  <ImageView
      android:src="@drawable/eduvalg"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"
       android:scaleType="centerInside"
       android:padding="0.0dp"
       android:layout_alignParentTop="true"
       android:id="@+id/backgroundimageview" />
  <TextView
      android:id="@+id/spinnertext"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:layout_marginTop="0.0dp" />
</RelativeLayout> 
```

Resource.Layout.SpinnerRow：

```
<?xml version="1.0" encoding="utf-8"?>
    <TextView xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_centerInParent="true"
        android:background="@drawable/down"
        android:gravity="center"
        android:layout_height="wrap_content" /> 
```

我使用以下 xml 将微调器添加到活动布局中：

```
<CmsApp.Droid.Controls.UmbracoSpinner
      android:id="@+id/spinnerMenu"
      android:layout_width="fill_parent"
      android:layout_height="wrap_content"
      android:background="@android:color/transparent"
      android:drawSelectorOnTop="true"
      /> 
```

我尝试对两者使用相同的布局 Resource.Layout.SpinnerView 然后应用程序不会崩溃 - 但是我没有正确的下拉项目自定义布局。

我希望有人可以帮助我并指出我正确的方向。

---更新---以下是我崩溃时的日志，它似乎是一个我不完全理解的空指针。

```
04-26 22:45:47.423: E/AndroidRuntime(11536): FATAL EXCEPTION: main
04-26 22:45:47.423: E/AndroidRuntime(11536): java.lang.NullPointerException
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:353)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.ArrayAdapter.getDropDownView(ArrayAdapter.java:376)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.Spinner$DropDownAdapter.getDropDownView(Spinner.java:329)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.Spinner$DropDownAdapter.getView(Spinner.java:325)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.AbsListView.obtainView(AbsListView.java:1315)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.ListView.measureHeightOfChildren(ListView.java:1198)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.ListView.onMeasure(ListView.java:1109)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.view.View.measure(View.java:8171)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1012)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.LinearLayout.measureVertical(LinearLayout.java:381)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.LinearLayout.onMeasure(LinearLayout.java:304)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.view.View.measure(View.java:8171)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1012)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.LinearLayout.measureVertical(LinearLayout.java:381)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.LinearLayout.onMeasure(LinearLayout.java:304)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at com.android.internal.widget.WeightedLinearLayout.onMeasure(WeightedLinearLayout.java:60)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.view.View.measure(View.java:8171)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:245)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.view.View.measure(View.java:8171)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:245)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.view.View.measure(View.java:8171)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.view.ViewRoot.performTraversals(ViewRoot.java:801)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.view.ViewRoot.handleMessage(ViewRoot.java:1727)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.os.Looper.loop(Looper.java:123)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at android.app.ActivityThread.main(ActivityThread.java:4627)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at java.lang.reflect.Method.invokeNative(Native Method)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at java.lang.reflect.Method.invoke(Method.java:521)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-26 22:45:47.423: E/AndroidRuntime(11536):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:48:19.477

也许在您的 Resource.Layout.SpinnerRow 中，必须检查 textview textview

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T10:25:42.103

好吧，伙计们，我自己解决了，我不确定这可能是一个新手错误。我需要更改我的布局 xml 文件。textview 的 id 必须相同，否则会导致空指针异常。

我已将我的 xml 更改为以下

Resource.Layout.SpinnerView：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:local="http://schemas.android.com/apk/res/dk.appsfabrikken.cmsapp"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    >
  <ImageView
      android:src="@drawable/eduvalg"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"
       android:scaleType="centerInside"
       android:padding="0.0dp"
       android:layout_alignParentTop="true"
       android:id="@+id/backgroundimageview" />
  <TextView
      android:id="@+id/spinnertext"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:layout_marginTop="0.0dp" />
</RelativeLayout> 
```

Resource.Layout.SpinnerRow：

```
<?xml version="1.0" encoding="utf-8"?>
    <TextView xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/spinnertext"
        android:layout_width="wrap_content"
        android:layout_centerInParent="true"
        android:background="@drawable/down"
        android:gravity="center"
        android:layout_height="wrap_content" /> 
```

# jsf - 如何获取过滤的rich:datatable的记录数

> ID：10355407
> 
> 赞同：2
> 
> 时间：2012-04-27T17:45:47.530
> 
> 标签：jsf, richfaces, seam, richdatatable

我正在使用Seam，并且正在使用rich:datable 显示数据库中的项目。知道项目的数量很简单，因为我知道列表的大小。

当用户使用由 rich:datatable 自动处理的过滤器之一时，就会出现问题。在那种情况下，由于它自己处理代码，我不知道显示列表的大小。

当用户使用一个（或多个）过滤器时，如何获取显示的记录数？

# mercurial - 如何将 Hg 克隆选项添加到 Mercurial Jenkins 插件

> ID：10355409
> 
> 赞同：2
> 
> 时间：2012-04-27T17:45:52.637
> 
> 标签：mercurial, jenkins, jenkins-plugins

我们正在从 CCNet 迁移到 Jenkins，并开始使用 Mercurial。该 repo 与 Jenkins 位于不同的服务器上，因此它需要通过网络进行克隆。在我的测试`hg clone`中，使用该 `--uncompressed`选项来拉取网络要快得多（如[文档](http://www.selenic.com/mercurial/hg.1.html#clone)中所述），所以我想告诉[Mercurial Jenkins 插件](https://wiki.jenkins-ci.org/display/JENKINS/Mercurial+Plugin)添加它。我看到 Jenkins 正在运行这个命令来更新本地仓库：

`C:\Program Files\TortoiseHg\hg.exe" --debug clone --rev default --noupdate http://remoteserver/project D:\local_repo\project`

我希望它运行这个命令：

`C:\Program Files\TortoiseHg\hg.exe" --debug --uncompressed clone --rev default --noupdate http://remoteserver/project D:\local_repo\project`

我怀疑我可能不得不直接修改詹金的 XML 项目，因为我在詹金的 GUI 中没有看到可以做的地方，但是我找不到任何文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:15:03.390

不需要它：Jenkins 只会克隆一次远程存储库，然后进行（小）更新。

Jenkins 有一个带有远程存储库克隆的内部缓存，所有链接到同一个远程存储库的作业实际上都将使用这个缓存进行更新。

# animation - IE10 - CSS 动画不起作用

> ID：10355411
> 
> 赞同：6
> 
> 时间：2012-04-27T17:46:06.943
> 
> 标签：animation, css, internet-explorer-10

我有一个在 IE10 中工作了大约一天然后停止的比例动画。我没有做任何改变，也不确定会发生什么破坏它。

有没有人有任何想法？当我查看 IE 开发工具时，它没有选择动画名称，而是选择了所有其他属性。

这是CSS：

```
@-ms-keyframes move97
{
    0% {
        transform:scale(1,1);
        -ms-transform:scale(1,1); 
        -moz-transform:scale(1,1); 
        -webkit-transform:scale(1,1); 
        -o-transform:scale(1,1); 
    }
    50% {
        transform:scale(0.97,0.97);
        -ms-transform:scale(0.97,0.97); 
        -moz-transform:scale(0.97,0.97); 
        -webkit-transform:scale(0.97,0.97); 
        -o-transform:scale(0.97,0.97); 
    }
    100% {
        transform:scale(1,1);
        -ms-transform:scale(1,1); 
        -moz-transform:scale(1,1); 
        -webkit-transform:scale(1,1); 
        -o-transform:scale(1,1); 
    }
}

.press97
{
    -ms-animation-name: move97 0.2s; /* note MS has this different.... ugh */
    animation: move97 0.2s;
    -moz-animation: move97 0.2s; /* Firefox */
    -webkit-animation: move97 0.2s; /* Safari and Chrome */ 

    animation-timing-function: linear;
    -moz-animation-timing-function: linear; 
    -webkit-animation-timing-function: linear;
    -ms-animation-timing-function: linear;   

    animation-fill-mode: forwards;
    -webkit-animation-fill-mode: forwards;
    -moz-animation-fill-mode: forwards;
    -ms-animation-fill-mode: forwards;
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-04T14:29:46.847

[Internet Explorer 10 支持](http://msdn.microsoft.com/en-us/library/windows/apps/hh453858.aspx)标准语法，不需要`-ms`关键帧声明上的前缀，也不需要`animation-name`属性上的前缀。事实上，IE10 和其他厂商的产品一样，`animation`也只支持简写属性：

```
@keyframes myanimation {
    0%   { color: black; }
    80%  { color: gold; transform: translate(20px,20px); }
    100% { color: black; translate(0,0); }
}

#anim {
    display: inline-block;
    animation: myanimation 5s 5; /* use myanimation 5s duration, 5 times */
} 
```

小提琴：http: [//jsfiddle.net/ZfJ4Z/1/](http://jsfiddle.net/ZfJ4Z/1/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-27T22:43:10.967

显然我关注的帮助链接不正确。当我将其更改为 -ms-animation: move97 0.2s 时，它可以工作。这是我最初拥有的，但它不起作用，所以我将其更改为上面显示的内容，它确实有效。

我关注的帮助链接：http: [//msdn.microsoft.com/library/ie/hh673530.aspx](http://msdn.microsoft.com/library/ie/hh673530.aspx)

我被告知它将被纠正。

# .net - .net 绑定图表的代码问题

> ID：10355413
> 
> 赞同：0
> 
> 时间：2012-04-27T17:46:08.343
> 
> 标签：.net, vb.net

我试图将 Telerik 图表与下面的代码绑定，然后根据屏幕截图它正在考虑一个错误。

任何人都知道如何处理这个错误。

逻辑解释：我将数据表分配为**listdata**数据源并尝试根据表行数绑定数据。

```
Dim listdata As new DataList 
        listdata.DataSource   = ds.Tables.Item(0)

        BaselineRadChart.Clear()    
        Dim chartSeries As New ChartSeries("Baseline", ChartSeriesType.Line) 
            chartSeries.Appearance.ShowLabels = False
            Dim i As Integer = 0
            While i < ds.Tables(0).Rows.Count
                chartSeries.AddItem(New ChartSeriesItem(listData[i].x, listData[i].y))
                i = i + 1
            End While  

            BaselineRadChart.AddChartSeries(chartSeries)
            BaselineRadChart.ChartTitle.TextBlock.Text = title
            BaselineRadChart.PlotArea.XAxis.AxisLabel.TextBlock.Text = xaxislableName
            BaselineRadChart.PlotArea.XAxis.AxisLabel.Visible = True
            BaselineRadChart.PlotArea.XAxis.IsZeroBased = False
            BaselineRadChart.PlotArea.YAxis.AxisLabel.TextBlock.Text = yaxislableName
            BaselineRadChart.PlotArea.YAxis.AxisLabel.Visible = True
            BaselineRadChart.PlotArea.YAxis.IsZeroBased = True 
```

我试图通过使用下面的参考代码来开发上面的代码（bcz我们相同的功能，如果下面的代码有效，那么我的代码肯定有效）。它正在为他工作。

```
ChartSeries chartSeries = new ChartSeries("Altitude", ChartSeriesType.Line); 
chartSeries.Appearance.ShowLabels = false; 
incrementCount = 1; 

for (int i = 0; i < listData.Count; i = i + incrementCount) 
    {
        chartSeries.AddItem(new ChartSeriesItem(listData[i].x, listData[i].y)); 
    }

RadChart2.AddChartSeries(chartSeries);
RadChart2.ChartTitle.TextBlock.Text = title;
RadChart2.PlotArea.XAxis.AxisLabel.TextBlock.Text = 
"Distance (Miles)"; 
RadChart2.PlotArea.XAxis.AxisLabel.Visible = true; 
RadChart2.PlotArea.XAxis.IsZeroBased = true; 
RadChart2.PlotArea.YAxis.AxisLabel.TextBlock.Text = yAxisLabel;
RadChart2.PlotArea.YAxis.AxisLabel.Visible = true; 
RadChart2.PlotArea.YAxis.IsZeroBased = false; 
```

![在此处输入图像描述](../Images/980b84be907620d9386c6e6b3ae77432.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:57:00.993

您不是要从表中提取数据吗？

```
While i < ds.Tables(0).Rows.Count
    chartSeries.AddItem(New ChartSeriesItem(_
        ds.Tables(0).Rows(i)("x"), ds.Tables(0).Rows(i)("y")))
    '               ^^^^^^^^^^^^^ get from the tabel
    i = i + 1
End While 
```

# php - 表中没有数据

> ID：10355427
> 
> 赞同：1
> 
> 时间：2012-04-27T17:47:18.440
> 
> 标签：php, mysql, html

我想在表中显示数据的这段代码，代码中没有错误，但是即使查询具有我想要的结果，我仍然有一个空表，这里是更多理解的代码

```
<?php
$connectdb = mysql_connect('localhost','root','sara', true ) or die ("Not Connect");
 if (!$connectdb)
 {
    die('Could not connect :'. mysql_errno());
  }
 $selestdb  = mysql_select_db('iexa', $connectdb) or die ("not selected database");
  if (isset($_POST['examID'])) {
   $examID = $_POST['examID'];
   }
    echo $examID;
    echo "<br />";
   $query = mysql_query("SELECT  Question  , Choise_1  , Choise_2 , Choise_3 , Choise_4 , Correct_Answer
   FROM question_bank WHERE E_No='examID' ORDER BY Question asc") or die ("mysql error");
 echo "<table width='40%' border='1' cellpadding='5'>
  <tr>
    <td>Qusetion </td>
    <td>Choise 1</td>
    <td>Choise 2</td>
    <td>Choise 3</td>
    <td>Choise 4</td>
    <td>The correct answer</td>
    </tr>";
   echo $query;
  while ($row = mysql_fetch_assoc($query)){
 echo '
  <tr>
   <td>'.$row['Question'].'</td>
   <td>' .$row['Choise_1'].'</td>
    <td>' .$row['Choise_2'].'</td>
   <td>' .$row['Choise_3'].'</td>
   <td>' .$row['Choise_4'].'</td>
    <td>' .$row['Correct_Answer'].'</td>
    </tr>';
     };
     echo "</table>";
     mysql_close($connectdb);
     ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:53:00.207

问题可能出在`E_No='examID'`它应该是：

```
E_No='" . mysql_real_escape_string($_POST['examID']) . "' 
```

如果它是整数值，您始终可以将其类型转换为整数。查询看起来像：

```
"SELECT  Question  , Choise_1  , Choise_2 , Choise_3 , Choise_4 , Correct_Answer FROM question_bank WHERE E_No='" . mysql_real_escape_string($_POST['examID']) . "' ORDER BY Question asc" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:53:12.977

您正在寻找文字`'examId'`

试试这个：

```
$examID = mysql_real_escape_string($_POST['examID']);
$query = mysql_query("SELECT  Question  , Choise_1  , Choise_2 , Choise_3 , Choise_4 , Correct_Answer
FROM question_bank
WHERE E_No='$examID' ORDER BY Question asc");
#           ^ here 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T17:54:57.987

您是否尝试过替换或死亡（“mysql错误”）；与或死（mysql_error（））；?

似乎考试 id 在开始时也需要一个 $。

# python - python/tornado 中的自定义 json 编码器

> ID：10355431
> 
> 赞同：3
> 
> 时间：2012-04-27T17:47:32.980
> 
> 标签：python, json, tornado, cyclone

我正在建造龙卷风（实际上是旋风），而 RequestHandler.write 被我的一些对象窒息。如何在龙卷风中为这些对象编写 JSONencoder？

一个复杂的问题：一些对象是从外部库借来的，所以我真的无法访问它们的构造函数。

很抱歉没有发布代码——我只是不知道如何从这里开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-01T08:38:40.410

是的，您可以更改默认编码器，方法是在您的主循环之前添加它

```
import json
json._default_encoder = YourJSONEncoder() #patch json 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-08T17:05:14.187

基本上，答案是tornado不支持自定义json格式，所以你必须使用json库。这是我最后使用的代码：

```
import json

class MongoEncoder(json.JSONEncoder):
    def default(self, obj):
        if isinstance(obj, ObjectId):
            return str(obj)
        return json.JSONEncoder.default(self, obj)

print json.dumps(my_mong_obj, cls=MongoEncoder, indent=2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T14:14:39.483

对于具有 json 格式的 datetime 对象，它看起来像这样

```
 import json

    dthandler = lambda obj: obj.isoformat() if isinstance(obj, datetime) else None
    response = json.dumps(data, ensure_ascii=False, default=dthandler) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-19T10:44:12.577

这是我的猴子补丁：

```
import json, datetime
from tornado import escape
DT_HANDLER = lambda obj: obj.isoformat() if isinstance(obj, datetime.datetime) or     isinstance(obj, datetime.date) else None
def json_encode(value):
    return json.dumps(value, default=DT_HANDLER).replace("</", "<\/")

escape.json_encode = json_encode 
```

# django - Django 没有始终如一地记录……视图缓存？

> ID：10355433
> 
> 赞同：1
> 
> 时间：2012-04-27T17:47:35.023
> 
> 标签：django, google-app-engine, djangoappengine

我正在运行 Python2.7、djangoappengine 和 AppEngine 1.6.5

我的问题是我的 logging.debug() 消息没有被一致地打印到输出中。我已经将我的代码剥离回一个非常简单的主页视图

```
def home(request):
    logging.debug("Serving homepage")
    if request.user.is_authenticated():
        template = 'home-loggedin.html'
    else:
        template = 'home.html'
    return render_to_response(template, locals(), RequestContext(request)) 
```

这个想法是我会在日志输出中始终看到“服务主页”。但是，它只记录第一次，而不是随后的命中。

```
DEBUG    2012-04-27 17:33:02,616 views.py:8] Serving homepage
INFO     2012-04-27 17:33:02,711 dev_appserver.py:2891] "GET / HTTP/1.1" 200 -
INFO     2012-04-27 17:33:02,848 dev_appserver.py:2891] "GET /static/bootstrap/css/bootstrap.css HTTP/1.1" 200 -
[ .. Lots of 200 responses for my JS and CSS ..]
>> LOOK NO DEBUGGING LINE :(
INFO     2012-04-27 17:33:10,758 dev_appserver.py:2891] "GET / HTTP/1.1" 200 -
INFO     2012-04-27 17:33:10,844 dev_appserver.py:2891] "GET /static/bootstrap/css/bootstrap.css HTTP/1.1" 304 -
INFO     2012-04-27 17:33:10,854 dev_appserver.py:2891] "GET /static/bootstrap/css/bootstrap-responsive.css HTTP/1.1" 304 -
[ .. Lots of 304 Not Modified for my JS and CSS ..] 
```

我没有在我的 urlconf 中缓存视图，我在我的 settings.py 中启用了 memcached，但我还没有使用它。

我真正感受到的痛苦是在一个具有更高级逻辑的模块中，由于没有记录调试，我无法跟踪代码的执行。

任何帮助表示赞赏

# sql - 如何从庞大的数据转储中删除我想要的内容？

> ID：10355434
> 
> 赞同：0
> 
> 时间：2012-04-27T17:47:37.293
> 
> 标签：sql, file, text

我有一个 3.55 GB 的 .txt 文件，它太大而无法进入 Access。它有大约 500 万条记录，而我只是其中的一小部分。我需要一种方法来解析出我需要的数据行并删除大量数据。每行文本是 651 个字符，但幸运的是我们可以按前三位排序。如果我可以删除任何不以 044、067、122 或 107 开头的行，我会将文件缩小到可以加载到 Access 中的大小。我已经将 cygwin 和 mysql 都加载到了机器上，现在我正盯着命令提示符想知道下一步该做什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:50:40.310

如果你有 cygwin，那么类似

```
grep '^(044|067|122|107)' file.csv > newfile.csv 
```

会成功的。可能需要启用 grep 的正则表达式选项，但我的大脑现在处于 Friday Mush 模式，不记得它们是什么。

# jquery - 禁用文本框和 ViewState 问题

> ID：10355438
> 
> 赞同：0
> 
> 时间：2012-04-27T17:48:04.790
> 
> 标签：jquery, viewstate

我有一个禁用的 asp.net 文本框：

```
<asp:TextBox ID="txtEmpName" runat="server" Enabled="false"></asp:TextBox> 
```

使用 jQuery，然后我根据单击的两个单选按钮启用或禁用文本框。

```
$(document).on("change", "input[id*='_rbtnIsFullTime_']", function ($e) {
  if ($(this).val() == "1")
    $("input[id$='_txtEmpName']").removeAttr('disabled');
  else
    $("input[id$='_txtEmpName']").attr('disabled', 'disabled');
}); 
```

我遇到的问题是，当通过 jQuery 启用文本框时，用户输入的任何文本都不会随页面一起提交，因为 ViewState 在页面最初呈现时仍将文本框显示为禁用。

关于如何解决这个问题并使 ViewState 与 jQuery 很好地配合的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:50:18.867

使用相同的文本创建第二个文本框并禁用 ti。然后相应地切换两个框的可见性？

# c# - 从静态方法返回引用是线程安全的吗？

> ID：10355439
> 
> 赞同：8
> 
> 时间：2012-04-27T17:48:09.773
> 
> 标签：c#, multithreading

我有一堂课：

```
class PrintStringDataBuilder
{
    PrintStringDataBuilder() { }
    public static GetInstance()
    {
        return new PrintStringDataBuilder();
    }

    //other class methods and fields, properties
} 
```

从客户端代码访问为：

```
PrintStringDataBuilder instance = PrintStringDataBuilder.GetInstance(); 
```

**上面的调用是线程安全的吗？**

编辑：只是想避免写 PrintStringDataBuilder builder = new PrintStringDataBuilder(); 在 asp.net mvc web 应用程序中多次。PrintStringDataBuilder 类中没有其他静态方法、静态字段或静态属性。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-27T17:49:54.413

是的？在不了解该类构造函数的内部结构的情况下，您可以说调用`GetInstance()`是线程安全的。但是，该实例上的任何方法都不能保证是线程安全的，特别是因为您没有提供任何这些方法。

这简称为工厂模式。

编辑：如果你想返回一个单例，你可以这样做：

.NET 4+

```
private static Lazy<PrintStringDataBuilder> _instance = new Lazy<PrintStringDataBuilder>(() =>
  {
      return new PrintStringDataBuilder();
  });

public static PrintStringDataBuilder GetInstance()
{
    return _instance.Value;
} 
```

.NET 3.5 及以下

```
private static PrintStringDataBuilder _instance = null;
private static object _lockObject = new object();

public static PrintStringDataBuilder GetInstance()
{
    if(_instance == null)
    {
         lock(_lockObject)
         {
              if(_instance == null)
                 _instance = new PrintStringDataBuilder();
         }
    }

    return _instance;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-27T17:51:11.527

通过“线程安全”，您是否担心调用您的静态方法的多个线程将获得相同的 PrintStringDataBuilder？答案是否定的，调用是线程安全的。

话虽如此，没有人可以从您给出的小片段中判断该类的其余部分是，还是它的构造函数。类实例不是线程安全的原因有很多。如果他们引用没有锁定的静态属性就是一个例子。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-27T18:44:15.653

输入方法始终是线程安全的。访问共享数据可能不是。所以这段代码是线程安全的，因为没有共享数据。

如果您的意图是为所有线程创建一个实例，`PrintStringDataBuilder`那么您的代码将无法工作。你需要合适的单身人士。在 .NET 4 中，代码可以非常紧凑：

```
private static Lazy<PrintStringDataBuilder> instance = new Lazy<PrintStringDataBuilder>();

public static PrintStringDataBuilder Instance
{
    get { return instance.Value; }
} 
```

这将保证在每个线程中都`PrintStringDataBuilder.Instance`将指向相同且只有一个`PrintStringDataBuilder`对象实例，该实例将以惰性方式创建，即仅在第一次使用时才被创建，并且不会很快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T00:11:42.843

@Tejs，

实际上，在 .NET 中，您不需要使用双重检查锁定机制 - 有更好的解决方法。但是如果你选择这样做，你的双重检查锁的实现是不正确的并且不是真正的线程安全的。编译器可以优化初始化`_instance = new PrintStringDataBuilder();`- 有 3 种可能的修改可以使您的示例真正线程安全：

1.  内联初始化静态成员 - 绝对是最简单的！

```
 private static PrintStringDataBuilder _instance = new PrintStringDataBuilder;
    public static PrintStringDataBuilder GetInstance()
    {
        return _instance;
    } 
```

2\. 使用 'volatile' 关键字来确保 JIT 的初始化`PrintStringDataBuilder`不会被 JIT 优化。

```
 private static volatile PrintStringDataBuilder _instance = null;
private static object _lockObject = new object();

public static PrintStringDataBuilder GetInstance()
{
    if(_instance == null)
    {
         lock(_lockObject)
         {
              if(_instance == null)
              {
                 _instance = new PrintStringDataBuilder();
              }
         }
    }

    return _instance;
}
```

3\. 使用带有双重检查锁的 Interlocked.Exchange：

```
 private static PrintStringDataBuilder _instance = null;
private static object _lockObject = new object();

public static PrintStringDataBuilder GetInstance()
{
    if(_instance == null)
    {
         lock(_lockObject)
         {
              if(_instance == null)
              {
                 var temp = new PrintStringDataBuilder();
                 Interlocked.Exchange(ref _instance, temp);
              }
         }
    }

    return _instance;
}
```

希望这可以帮助。

# extjs - GXT Grid ListStore - 获取未修改的记录

> ID：10355440
> 
> 赞同：0
> 
> 时间：2012-04-27T17:48:15.197
> 
> 标签：extjs, gxt

我有一个允许用户更新列（即模型数据中的属性）的网格。有没有办法让我看到未修改的记录（即 ModelData）？

当用户单击“提交”按钮时：我可以使用***List modifiedRecords = listStore.getModifiedRecords();*** 用于修改的记录。我可以使用***Map changedFieldsMap = modifiedRecord.getChanges();*** 查看已更改的列，但我看不到未更改的值是什么...我可以吗？！？！

〜理查德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:53:27.563

朋友，如果您可以获取已修改记录的列表，那么您可以通过创建一个新的虚拟存储轻松检索未修改记录的列表，只需通过与单个循环和一些条件进行斗争就可以轻松地从中删除修改过的记录。

# zend-framework - Zend Framework：此行已被标记为只读

> ID：10355442
> 
> 赞同：7
> 
> 时间：2012-04-27T17:48:25.827
> 
> 标签：zend-framework

这是我第一次遇到这个问题。保存我的一个模型时，我收到错误消息：“该行已被标记为只读”。不知道为什么我会收到此错误以及如何解决它。堆栈跟踪对我没有帮助。如何解决此问题以便保存记录？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-28T02:30:28.663

将行标记为只读可能是以下任何操作的结果：

*   `Zend_Db_Select`查询与另一个表连接
*   `setIntegrityCheck(false)`在选择对象上设置
*   一列或多列是评估表达式的结果

如果上述任何一个条件为真，那么生成的行对象将被标记为只读，因为 Zend_Db 不能保证结果中的所有列都引用了选择对象的原始父表。因此，对行对象调用`update()`、`save()`或的任何尝试都将失败。`delete()`

其中一些信息散布在整个[Zend_Db_Table 参考](http://framework.zend.com/manual/en/zend.db.table.html)中，如果您在其中搜索，`integrity`您可以看到许多行将被标记为只读的实例。

# ruby-on-rails - Rails 会破坏嵌套条目。

> ID：10355443
> 
> 赞同：1
> 
> 时间：2012-04-27T17:48:26.520
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我的应用程序设置如下：

- 为类别和产品生成脚手架。

-Products belongs_to Categories 和 Categories has_many Products。

我目前可以删除/删除单个类别，但是该类别中的产品仍保留在数据库中。我如何能够删除一个类别以及仅包含在该特定类别中的所有产品？

目前我的类别控制器如下所示：

```
def destroy
@Category = Category.find(params[:id])
@Category.destroy

respond_to do |format|
  format.html { redirect_to (:back) }
  format.json { head :ok }
end 
```

结尾

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T18:10:01.673

看看这个： http: [//guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

```
class Category < ActiveRecord::Base
  has_many :products, :dependent => :destroy
end

class Product < ActiveRecord::Base
  belongs_to :category
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:52:21.487

你需要里面 category.rb

```
has_many :products, :dependent => :destroy 
```

# java - 用java读取midi IO设备

> ID：10355456
> 
> 赞同：0
> 
> 时间：2012-04-27T17:49:51.987
> 
> 标签：java, javasound

我正在尝试解析连接到我的笔记本电脑的 midi 设备的输入。所以我想找到设备，连接到它并接收它的输入。

我从[java 中的 select midi 设备](https://stackoverflow.com/questions/7507046/select-midi-device-in-java)开始，但是我在解决这个问题时遇到了一些麻烦。我考虑过 jFugue，它提供了一种访问 java 声音 API 的方法，但由于我没有他们的书，所以没有资源。此外，jMusic 提供了一些功能，但它主要用于 midi 文件 IO，而不是 midi 设备 IO。所以你知道关于这个主题的任何实用教程（可能直接使用Java声音API）。

与往常一样，任何帮助都将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:10:10.953

查看 Java 声音教程：[http](http://docs.oracle.com/javase/tutorial/sound/accessing-MIDI.html) ://docs.oracle.com/javase/tutorial/sound/accessing-MIDI.html它包含对 Java MIDI API 的很好解释，还包含有关如何枚举设备的示例源代码。

有以下示例源代码：

```
// Obtain information about all the installed synthesizers.
Vector synthInfos;
MidiDevice device;
MidiDevice.Info[] infos = MidiSystem.getMidiDeviceInfo();
for (int i = 0; i < infos.length; i++) {
  try {
    device = MidiSystem.getMidiDevice(infos[i]);
  } catch (MidiUnavailableException e) {
      // Handle or throw exception...
  }
  if (device instanceof Synthesizer) {
    synthInfos.add(infos[i]);
  }
}
// Now, display strings from synthInfos list in GUI. 
```

当您获取 MIDI 设备时，您可以（在以前的源代码中）

*   通过调用获取设备名称`infos[i].getName`
*   通过调用获取设备供应商`infos[i].getVendor()`
*   检查这是输入还是输出设备（如果一个“物理”设备提供输入和输出端口，它们将在 Java 中被视为两个设备，一个用于输入，第二个用于输出）通过调用`device.getMaxReceivers()`and `device.getMaxTransmitters()`。

有关详细信息，请参阅 API 文档： - [http://docs.oracle.com/javase/1.5.0/docs/api/javax/sound/midi/MidiDevice.html](http://docs.oracle.com/javase/1.5.0/docs/api/javax/sound/midi/MidiDevice.html) - [http://docs.oracle.com/javase /1.5.0/docs/api/javax/sound/midi/MidiDevice.Info.html](http://docs.oracle.com/javase/1.5.0/docs/api/javax/sound/midi/MidiDevice.Info.html)

# java - j_spring_security_check 404

> ID：10355457
> 
> 赞同：0
> 
> 时间：2012-04-27T17:49:52.263
> 
> 标签：java, spring, spring-security

我们正在尝试将现有的 Web 应用程序从 Spring 2.x 升级到 Spring 3，并相信在一切恢复正常之前我们已经解决了最后一个问题。我们使用 CAS，可以访问 JASIG CAS 登录，但是登录时出现 404 错误。我们让服务器管理员从 CAS 服务器中提取 Catalina 日志，它指出登录成功并且正在返回到应用程序。然而，在来自 tomcat 服务器的调试输出中，它声明匿名用户的访问被拒绝，我不是。

Web.xml 片段

```
<context-param>
    <param-name>log4jConfigLocation</param-name> 
    <param-value>/WEB-INF/classes/log4j.properties</param-value> 
</context-param>
<filter>
    <filter-name>springSecurityFilterChain</filter-name> 
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class> 
</filter>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name> 
    <url-pattern>/*</url-pattern> 
</filter-mapping> 
```

应用程序上下文.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:security="http://www.springframework.org/schema/security"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:tx="http://www.springframework.org/schema/tx"
xmlns:task="http://www.springframework.org/schema/task"
xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd">

    <import resource="classpath:edu/umt/brp/spring/run-env.xml"/>

<!-- NEW SECURITY (Begin) -->
<security:http access-denied-page="/myAccessDeniedPage" entry-point-ref="casProcessingFilterEntryPoint">
    <security:port-mappings>
    <!--<security:port-mapping http="8080" https="8081"/> -->
    <security:port-mapping http="8080" https="443"/> 
    </security:port-mappings>

    <security:intercept-url pattern="/infoGriz.html*" access="ROLE_EMPLOYEE" />
    <security:intercept-url pattern="/**/frameset**" access="ROLE_EMPLOYEE" />
<!--        <security:logout logout-url="/logout" logout-success-url="https://logintest.umt.edu/cas/logout" invalidate-session="true"/> -->
    <!--  next line may fix problem --> 
    <security:logout logout-url="/logout" logout-success-url="${casLogoutUrl}" invalidate-session="true"/>
</security:http>     
<security:global-method-security secured-annotations="enabled" jsr250-annotations="enabled" />

<security:authentication-manager alias="authenticationManager">
    <security:authentication-provider ref="casAuthenticationProvider" />
</security:authentication-manager>

<security:ldap-server id="ldapServer" url="${ldapUrl}"/>

<bean id="userService" class="org.springframework.security.ldap.userdetails.LdapUserDetailsService">
    <constructor-arg>
        <bean id="userSearch" class="org.springframework.security.ldap.search.FilterBasedLdapUserSearch">
            <constructor-arg index="0" value="cn=users,dc=umt,dc=edu"/>
            <constructor-arg index="1" value="(uid={0})"/>
            <constructor-arg index="2" ref="ldapServer" />
        </bean>     
    </constructor-arg>
    <constructor-arg>
        <bean class="edu.umt.brp.security.AuthoritiesPopulator">
            <constructor-arg ref="ldapServer" />
            <constructor-arg value="cn=groups,dc=umt,dc=edu" />
            <property name="groupSearchFilter" value="(uniqueMember={0})"/>
            <property name="searchSubtree" value="true"/>

            <property name="grouperServiceUrl" value="${grouperServiceUrl}"/>
            <property name="grouperUser" value="${grouperUser}"/>
            <property name="grouperPass" value="${grouperPass}"/>

        </bean>
    </constructor-arg>
    <property name="userDetailsMapper">
        <bean class="org.springframework.security.ldap.userdetails.PersonContextMapper"/>
    </property>
</bean>

<bean id="serviceProperties" class="org.springframework.security.cas.ServiceProperties">
    <property name="service" value="${applicationHost}/infoGriz/j_spring_cas_security_check"/> 
    <property name="sendRenew" value="false"/>
</bean> 

<bean id="casProcessingFilter" class="org.springframework.security.cas.web.CasAuthenticationFilter">
    <property name="authenticationManager" ref="authenticationManager"/>
    <property name="authenticationFailureHandler">
        <bean class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler">
            <property name="defaultFailureUrl" value="http://www.google.com"/>
        </bean>
    </property>
</bean>

<bean id="casProcessingFilterEntryPoint" class="org.springframework.security.cas.web.CasAuthenticationEntryPoint">
    <property name="loginUrl" value="${casLoginUrl}"/>
    <property name="serviceProperties" ref="serviceProperties"/>
</bean>

<bean id="casAuthenticationProvider" class="org.springframework.security.cas.authentication.CasAuthenticationProvider" >
    <property name="userDetailsService" ref="userService"/>
    <property name="serviceProperties" ref="serviceProperties" />

    <property name="ticketValidator">
        <bean class="org.jasig.cas.client.validation.Cas20ServiceTicketValidator">
            <constructor-arg index="0" value="${casValidateUrl}" />
        </bean>
    </property>
    <property name="key" value="an_id_for_this_auth_provider_only"/>
</bean>
<!-- NEW SECURITY (End) --> 
```

我们有另一个 Web 应用程序已经在 Spring 3 上，我们正在使用 spring security 3.0.2 作为模型，但两者之间似乎没有什么不同。让我知道是否有任何其他文件会有所帮助。

谢谢，

伊恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T07:39:16.987

基于 Spring Security 3[参考](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/cas.html)，您还需要将*CAS auth 过滤器*添加到安全配置中：

```
<security:http ... >
    <security:custom-filter position="CAS_FILTER" ref="casProcessingFilter" />
</security:http> 
```

`/infoGriz.html*`我有一个问题是和之间的关系是什么`/infoGriz/j_spring_cas_security_check`？如果您希望`intercept-url`标签捕获第二个标签，它不会！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-02-27T16:12:53.593

如果您使用的是 Spring Security 4，请将其添加到 xml

```
<csrf disabled="true"/> 
```

# sparql - Dbpedia 不返回完整结果

> ID：10355461
> 
> 赞同：2
> 
> 时间：2012-04-27T17:50:00.857
> 
> 标签：sparql, dbpedia

DBPedia/SPARQL/语义数据初学者。我运行了以下查询以“找出每个运动员的运动”

```
select ?athlete ?sport where 
{
   ?athlete rdf:type <http://dbpedia.org/ontology/Athlete>.   #query1
   ?athlete dbpedia2:sport ?sport                             #query2
} 
```

它确实给出了结果，但不是我正在寻找的全套。“query1”本身返回更多的运动员，但结合“query2”，我得到的结果集要少得多。

请解释差异。我错过了什么吗？有什么替代方案？

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T18:39:42.443

您的查询选择同时具有 rdf:type 和 dbpedia2:sport 属性的所有运动员*节点*。`optional`即使某些属性未绑定，您也可以使用子句检索节点。例如：

```
select ?athlete ?sport where {
    ?athlete rdf:type <http://dbpedia.org/ontology/Athlete>. #query1
    optional {?athlete dbpedia2:sport ?sport} #query2
} 
```

更好的运动方式：

```
select ?athlete ?type where {
    ?athlete rdf:type <http://dbpedia.org/ontology/Athlete>.
    optional {
        ?athlete rdf:type ?type.
        ?type rdfs:subClassOf <http://dbpedia.org/ontology/Athlete>
    }
} 
```

# .htaccess - htaccess 重定向域，除了一个子域

> ID：10355463
> 
> 赞同：2
> 
> 时间：2012-04-27T17:50:07.290
> 
> 标签：.htaccess, redirect, dns, subdomain

我有 domain.net 和 store.domain.net。

我需要将 domain.net 下的所有内容都重定向到 newdomain.com。但是，我希望 store.domain.net 保持不变，而不是转发。

此外，所有路径保持不变。即：domain.net/category/post123 与newdomain.com/category/post123 的内容相同。

我在想我可以通过一个简单的 302 重定向通过 htaccess 来做到这一点，但是有异常给我带来了问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T23:13:25.780

试试这个`.htaccess`：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} !^store\.domain\.net$ [NC] 
RewriteCond %{HTTP_HOST} ^(.+\.)?domain\.net$ [NC] 
RewriteRule ^/?(.*)$ http://%1newdomain.com/$1 [R=302,L] 
```

# c# - 滚动时无法很好地填充大列表框

> ID：10355464
> 
> 赞同：0
> 
> 时间：2012-04-27T17:50:14.327
> 
> 标签：c#, windows-phone-7, xaml, listbox, scroll

我的应用程序中有一个相当大的列表框控件。它大约是......说200个左右的元素大。当我快速向下滚动时，我倾向于看到列表框的全部内容消失，然后我必须重新加载页面才能再次看到内容。

这是一个已知的问题？如果是这样，是否有可能的解决方法？对于我的应急计划，我将限制列表框的大小为... 100。但如果可以的话，我不想这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T20:36:17.577

解决方案是使用针对这种情况进行了优化的 LongListSelector：http: [//msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.phone.controls.longlistselector(v=vs.105)。 aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.phone.controls.longlistselector(v=vs.105).aspx)

# c# - 从程序集中获取所有 DLLImports？

> ID：10355467
> 
> 赞同：1
> 
> 时间：2012-04-27T17:50:21.863
> 
> 标签：c#, .net, reflection

如何使用反射从程序集中枚举所有 DLLImport？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T17:52:00.843

循环遍历每个类中的每个方法，并检查是否`GetCustomAttributes(typeof(DllImportAttribute))`返回任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-27T18:05:21.333

```
assembly.GetTypes()
        .SelectMany(t => t.GetMethods(flags))
        .Where(m => Attribute.GetCustomAttribute(m, typeof(DllImportAttribute)) != null); 
```

# events - 如何获取主页事件列表？

> ID：10355473
> 
> 赞同：9
> 
> 时间：2012-04-27T17:50:51.807
> 
> 标签：events, facebook-graph-api

我是 FB 图表的新手，无法获取与页面关联的事件集合。有没有办法获取页面创建的所有事件的列表？

我已经尝试了这些不成功：

`https://graph.facebook.com/search?type=event&place=PAGE_ID`

这不是一个有效的查询。

`https://graph.facebook.com/PAGE_ID/events`

返回一个空集，我认为是因为它正在寻找此页面正在参加的活动（而不是它创建的活动）。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-27T18:32:53.760

`https://graph.facebook.com/PAGE_ID/events`是获取由页面创建的事件列表的正确方法。您需要有效的访问令牌才能返回页面的事件列表。

访问[https://developers.facebook.com/tools/explorer](https://developers.facebook.com/tools/explorer)测试这个过程。

我看到在 4 月 23 日星期一之后创建的事件存在错误，其中所有事件都没有被有效的 Graph API 或 FQL 调用返回。有关更多信息，请参阅此帖子：[Graph API / FQL 不返回页面的所有事件](http://facebook.stackoverflow.com/questions/10336916/graph-api-fql-does-not-return-all-events-for-a-page)

我没有在[https://developers.facebook.com/bugs/](https://developers.facebook.com/bugs/)上创建错误的权限。如果您遇到相同的问题并且可以发布错误，请这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-22T15:16:58.813

这是使用 Javascript SDK 的答案

```
FB.api(
  '/{page-id}/events',
  'GET',
  {"fields":"timezone,cover,id,end_time,name,place,type,start_time,owner,event_times,description"},
  function(response) {
      // Insert your code here
  }
); 
```

在这里我列出了这个页面创建的事件，对于每个事件我想要时区、封面（图像）、id、开始和结束时间、地点、名称、描述和事件的时间

# ruby-on-rails - Ruby：包含的反义词有吗？对于 Ruby 数组？

> ID：10355477
> 
> 赞同：212
> 
> 时间：2012-04-27T17:51:24.780
> 
> 标签：ruby-on-rails, ruby

我的代码中有以下逻辑：

```
if !@players.include?(p.name)
  ...
end 
```

`@players`是一个数组。有没有一种方法可以避免`!`？

理想情况下，此代码段将是：

```
if @players.does_not_include?(p.name)
  ...
end 
```

* * *

## 回答 #1

> 赞同：411
> 
> 时间：2012-10-31T09:44:58.203

```
if @players.exclude?(p.name)
    ...
end 
```

ActiveSupport 将[`exclude?`](https://apidock.com/rails/Enumerable/exclude%3F)方法添加到`Array`、`Hash`和`String`。这不是纯 Ruby，但很多 Ruby 爱好者都在使用它。

来源：[Active Support Core Extensions（Rails 指南）](https://guides.rubyonrails.org/active_support_core_extensions.html#exclude-questionmark)

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2012-04-27T17:55:04.070

干得好：

```
unless @players.include?(p.name)
  ...
end 
```

您可以查看[Ruby Style Guide](https://github.com/bbatsov/ruby-style-guide)以获取有关类似技术的更多信息。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2018-04-04T17:59:03.537

只看红宝石：

**TL;博士**

使用`none?`传递一个块`==`来进行比较：

```
[1, 2].include?(1)
  #=> true
[1, 2].none? { |n| 1 == n  }
  #=> false 
```

* * *

[`Array#include?`](http://ruby-doc.org/core-2.5.1/Array.html#method-i-include-3F)接受一个参数并用于`==`检查数组中的每个元素：

```
player = [1, 2, 3]
player.include?(1)
 #=> true 
```

[`Enumerable#none?`](http://ruby-doc.org/core-2.5.0/Enumerable.html#method-i-none-3F)也可以接受一个参数，在这种情况下它`===`用于比较。为了获得相反的行为，`include?`我们省略了参数并将其传递给`==`用于比较的块。

```
player.none? { |n| 7 == n }
 #=> true 
!player.include?(7)    #notice the '!'
 #=> true 
```

在上面的例子中，我们实际上可以使用：

```
player.none?(7)
 #=> true 
```

那是因为`Integer#==`和`Integer#===`是等价的。但请考虑：

```
player.include?(Integer)
 #=> false
player.none?(Integer)
 #=> false 
```

`none?`返回`false`，因为`Integer === 1 #=> true`. 但真正的合法`notinclude?`方法应该返回`true`。所以就像我们之前做的那样：

```
player.none? { |e| Integer == e  }
 #=> true 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-04-27T17:55:32.773

以下情况如何：

```
unless @players.include?(p.name)
  ....
end 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-04-27T17:56:38.360

```
module Enumerable
  def does_not_include?(item)
    !include?(item)
  end
end 
```

好的，但说真的，除非工作正常。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-27T17:55:03.200

使用`unless`：

```
unless @players.include?(p.name) do
  ...
end 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-09-10T14:10:45.957

试试这个，它是纯 Ruby，所以不需要添加任何外围框架

```
if @players.include?(p.name) == false do 
  ...
end 
```

几天来，我一直在为类似的逻辑苦苦挣扎，在检查了几个论坛和问答板后，发现解决方案实际上非常简单。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-09-12T04:02:39.947

你可以使用：

```
unless @players.include?(p.name) do
...
end 
```

`unless`是相反的`if`，或者你可以使用`reject`.

您可以`reject`使用不需要的元素：

```
@players.reject{|x| x==p.name} 
```

获得结果后，您可以进行实施。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-27T10:35:36.603

using`unless`对于带有单个`include?`子句的语句很好，但是，例如，当您需要检查一个包含某些内容`Array`但另一个不包含某些内容时，使用`include?`with`exclude?`更友好。

```
if @players.include? && @spectators.exclude? do
  ....
end 
```

但是正如上面dizzy42所说，使用`exclude?`需要ActiveSupport

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-18T15:45:06.677

尝试这样的事情：

```
@players.include?(p.name) ? false : true 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-08-24T18:56:50.733

我正在为自己查找这个，找到这个，然后找到一个解决方案。人们正在使用令人困惑的方法和一些在某些情况下不起作用或根本不起作用的方法。

我知道现在为时已晚，考虑到这是 6 年前发布的，但希望未来的访问者能找到这个（希望它可以清理他们和你的代码。）

简单的解决方案：

```
if not @players.include?(p.name) do
  ....
end 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-02-03T19:06:27.477

如果您对`!`-operator 的反对主要是它需要放在您的支票前面，这会破坏您的打字流程，那么就有了`.!`方法。您只需将其放在检查后以反转布尔值：

```
if @players.include?(p.name).! 
```

# ruby-on-rails - 我的 gem 如何响应某些路径而不在应用程序的 routes.rb 中指定它们？

> ID：10355478
> 
> 赞同：0
> 
> 时间：2012-04-27T17:51:34.493
> 
> 标签：ruby-on-rails, routes, gem

我正在开发一个可以响应某些路径的 gem，为它们呈现自己的内容。例如：

> /my_gem_path

将被 gem 识别，它会呈现自己的视图，因此不会涉及使用 gem 的应用程序（至少作为控制器或视图）。

我遇到的问题是 '/my_gem_path' 没有映射为路由，因为不存在具有该名称的控制器，并且该路径的路由中没有条目。

我在想：

*   宝石是否/如何在加载时添加自己的路线？还是应用程序必须定义路由？
*   如果从 application_controller 进行渲染（比如在 before_filter 中），那么该路由可能是什么样的？
*   如果我打算这一切都错了？

谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:53:52.167

您希望专注于创建“引擎”，而不是 gem。引擎可以安装在 /my_gem_path 并从那里接管

瑞安在这里的引擎上有很棒的东西：[http ://ryanbigg.com/guides/engines.html](http://ryanbigg.com/guides/engines.html)

# jquery - isset($_GET['var']) 的 jQuery 等效项

> ID：10355484
> 
> 赞同：5
> 
> 时间：2012-04-27T17:52:04.117
> 
> 标签：jquery

我目前有一个 jQuery 函数，我需要知道是否存在任何`GET`数据。我不需要查询字符串中的数据，只需要是否运行两个函数之一。

等效的PHP：

```
if (isset($_GET['datastring'])) {
    // Run this code
} else {
    // Else run this code
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T17:56:32.590

您将不得不尝试类似的事情：（您不必使用变量，但如果您愿意，可以使用）

```
$.urlParam = function(name){
    var results = new RegExp('[\\?&]' + name + '=([^&#]*)').exec(window.location.href);
    return results[1] || 0;
}

if ($.urlParam('variable_name') != '') {  // variable_name would be the name of your variable within your url following the ? symbol
    //execute if empty
} else {
    // execute if there is a variable
} 
```

如果您想使用变量：

```
// example.com?param1=name&param2=&id=6
$.urlParam('param1'); // name
$.urlParam('id');        // 6
$.urlParam('param2');   // null 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:55:04.357

像这样？

```
if (yourUrlStringVar.indexOf('?')>-1) {
  return true;
} else {
  return false;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T17:57:25.350

```
location.search != "" 
```

如果有任何 GET 参数，将返回 true。

从[http://www.w3schools.com/jsref/prop_loc_search.asp](http://www.w3schools.com/jsref/prop_loc_search.asp)， location.search 从“？”返回 URL 的“查询部分”。符号起。因此，对于 page `http://www.mysite.com/page?query=3`， location.search 是`?query=3`。对于`http://www.google.com/`， location.search 是一个空字符串。

# mysql - EBS AMI 上的 MySQL 和持久性

> ID：10355485
> 
> 赞同：1
> 
> 时间：2012-04-27T17:52:06.527
> 
> 标签：mysql, amazon-web-services

我正在尝试在 EBS 支持的 AMI 上安装 MySQL。

EBS 支持的 AMI 是指存储在 EBS 中而不是 S3 中的 AMI。

*   我选择了一个由 Amazon/Ubuntu 提供的现有 EBS 支持的 Ubuntu AMI，我启动它，对其进行自定义并创建一个新的 AMI，以满足我的特定需求。应该使用什么流程来创建这个新的 AMI？我是否应该小心任何公钥和 .SSH 文件夹（我这么说是因为我试过这个但无法登录）

*   一旦我有了新的 AMI ID，原始 EBS 的快照就会添加到卷列表中，这就是新的自定义 AMI 所在的位置。从 AMI 列表中，我现在可以启动这个新的 AMI。当我启动新创建的 AMI（自定义）时，快照大小（根卷大小）与原始 AMI 的根大小相同。我想增加这个大小以获得更多的存储空间。我怎么做 ？

*   一旦我有足够的存储空间，我想在这个 AMI 上安装 MySQL。在此之后，我是否应该重新创建另一个新的 AMI 来保存这个新安装？还是会自动保存在根 EBS 卷中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:15:43.840

以下是与您描述的问题和情况相关的一些要点：

*   如果您正在创建一个供其他人或公众使用的 AMI，那么您需要非常小心地处理任何涉及磁盘的信息。其他人甚至可以从已删除的文件中恢复信息。这是我写的一篇文章，涉及到这一点：[http ://alestic.com/2011/06/ec2-ami-security](http://alestic.com/2011/06/ec2-ami-security)

*   如果您要创建一个 AMI 供您自己使用（而不是供其他人使用），那么您不必非常注意敏感信息。请记住，您*永远无法*将曾经包含敏感信息的私有实例转换为公共 AMI。

*   您应该能够使用 ec2-create-image 命令或 AWS 控制台中的等效命令从正在运行的实例创建私有 AMI。新的 AMI 应该支持传入新的 ssh 密钥，并且（正如您所提到的）可能允许您使用创建 AMI 时放置的任何 ssh 密钥进行 ssh。

*   EBS 启动 AMI 存储在 EBS 快照中。EBS 快照存储在 S3 的幕后，但您无法通过标准 S3 API 访问它们。当您运行 EBS 启动 AMI 时，它会启动一个 EBS 启动实例，其中根磁盘是一个 EBS 卷（从 AMI 的 EBS 快照创建）。

*   您可以在运行实例时使用块设备映射参数来启动具有比 AMI 指定的更大的引导磁盘的实例。这是我写的一篇文章解释了这一点： http: [//alestic.com/2009/12/ec2-ebs-boot-resize](http://alestic.com/2009/12/ec2-ebs-boot-resize)

*   您可以更改已在运行的实例的根磁盘大小，方法是停止它，用更大的副本替换 EBS 卷，然后重新启动它。我在这里提供示例步骤：http: [//alestic.com/2010/02/ec2-resize-running-ebs-root](http://alestic.com/2010/02/ec2-resize-running-ebs-root)

*   我建议将您的 MySQL 数据库文件分离到一个单独的数据 EBS 卷上。我写了一篇文章，描述了执行此操作的步骤：http: [//aws.amazon.com/articles/1663](http://aws.amazon.com/articles/1663)

*   如果您使用单独的数据 EBS 卷，您可能不需要调整根 EBS 卷的大小。

*   无论您使用一个还是两个 EBS 卷，无论您是否创建新的 AMI，这些卷以及安装在其上的软件和数据都会保持不变。事实上，创建一个包含完整数据库的 AMI 有点奇怪，因为数据库中的信息会很快变得陈旧。也就是说，您应该定期对 EBS 卷进行快照，尤其是那些包含数据的卷。

*   始终准确记录/自动化您如何启动新实例，包括软件安装和配置。将来能够重现这一点将派上用场，尤其是在某些紧急情况下。

我对你的问题思考得越多，我认为你可能越是假设你需要做你不需要做的事情。这是我的建议：

1.  启动 EBS 启动实例，并开始记录您在以下步骤中所做的一切。

2.  为 MySQL 和其他数据附加一个单独的 EBS 卷（请参阅上面的文章）。

3.  安装和自定义所有其他软件。

4.  为两个 EBS 卷设置常规 EBS 快照。

您可能不需要创建自定义 AMI，也可能不需要调整根磁盘的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:02:33.977

实际上，EBS ami 意味着实例将从 EBS 卷而不是实例存储启动的 ami。无论如何，实际的 ami 都以相同的方式存储。

您确实需要注意 ami 中的数据 - 不要在此处留下您不希望 ami 用户看到的任何内容。

当您启动 ami 时，其中一个选项是块设备映射。您可以使用它来增加引导设备的大小，添加额外的设备。请注意，这不会改变分区本身 - 你仍然需要运行 resize2fs 之类的东西来扩大分区（一些 Amis 已设置为你运行它）

从 ami 开始对实例所做的任何更改都不会影响 ami 本身。

# asp.net - .NET MVC 是否接受 DateTime 对象的单个数字日期/月份字符串？

> ID：10355486
> 
> 赞同：0
> 
> 时间：2012-04-27T17:52:14.653
> 
> 标签：asp.net, asp.net-mvc, string, web-applications

在客户端，我正在验证将被推送到 .NET 框架的字符串，我需要知道 .NET 框架将有效和识别哪些格式。

[http://msdn.microsoft.com/en-us/library/1k1skd40.aspx](http://msdn.microsoft.com/en-us/library/1k1skd40.aspx)列出了识别的格式，但没有回答我的所有问题。

对于日期：单个数字的日期/月份是否有效？
2位数的年份有效吗？

时间：上午/下午的哪些格式有效？我可以看到的可能字符串是：('a','p','a','p','am','pm','am','pm')

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T17:54:37.820

.NET 可以毫无问题地解析具有单日/月和 2 位数年份的日期。

您需要为此使用[自定义格式字符串](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)。

```
DateTime.ParseExact("9/1/12", "d/M/yy", 
                    CultureInfo.InvariantCulture,
                    DateTimeStyles.None) 
```

如果要测试多种格式，可以将格式字符串数组作为第二个参数传递：

```
DateTime.ParseExact("9/1/12", new [] { "d/M/yy", "dd/MM/yyyy" } 
                    CultureInfo.InvariantCulture,
                    DateTimeStyles.None) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:57:46.160

是的，DateTime 解析函数接受一位数的月份和日期以及两位数的年份。我不知道“a”代表“我”的头顶。

但只是一个建议——我并不是要在这里刻薄，我的意思是一个建设性的建议：这是一个你可以通过编写一个 5 行测试程序并运行它来更快地回答的问题，然后看看会发生什么而不是将其发布在论坛上。这样您不仅不必坐在那里等待答案，而且您可以 100% 确信答案是正确的，并且不会因为有人发布错误的答案而浪费时间。

# regex - 使用查询字符串将一个域重写为另一个域

> ID：10355496
> 
> 赞同：0
> 
> 时间：2012-04-27T17:53:11.247
> 
> 标签：regex, wordpress, mod-rewrite, redirect

我已将我的网站移至另一个域。我想将旧域重定向到新域，并保留查询字符串。以下只是我的尝试之一。重定向有效，但不添加查询字符串。

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^www.mydomain.com$ [NC]  
RewriteRule ^(.*)$ http://www.mynewdomain.com/$1 [R=301,L] 
```

我想要完成的示例：

用户访问： `http://www.mydomain.com/blog`

他们被重定向到： `http://www.mynewdomain.com/blog`

难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:04:26.403

打算尝试回答我自己的问题！

我似乎上面的代码确实有效，但只有当用户在域之前明确键入 http:// 时。我将代码更改为以下内容以支持`http://`和`www`. 它现在似乎可以正常工作。

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^(.*)mydomain.com$ [NC]
RewriteRule ^(.*)$ http://www.mynewdomain.com/$1 [R=301,L] 
```

现在它允许域之前的任何内容。如果有人看到这方面的问题，请告诉我。谢谢！

# java - JSP：未为 HttpServletResponse 类型定义方法 sendStatus(int, String)

> ID：10355499
> 
> 赞同：0
> 
> 时间：2012-04-27T17:53:14.373
> 
> 标签：java, jsp

我正在尝试发回用一些 HTML 编码的 HTTP。我收到“HttpServletResponse 类型的方法 sendStatus(int, String) 未定义”错误。我也尝试只使用代码。如果我改用 sendError()，则不会发送 HTML。

```
<%@page contentType="text/html; charset=utf-8" %>
<%@ page isErrorPage = "true"%>
<%response.sendStatus(500, "TEST 500 ERROR WITH HTML PAGE");%>

<html>
<body>
<h1>
Test HTTP Error: 500 ERROR with HTML page
</h1>
</body>
</html> 
```

我越来越：

```
ERROR_500_subjectdoc_htmlheader_error_realhtmlerrorpage.jsp:3:12: The method sendStatus(int, String) is undefined for the type HttpServletResponse
<%response.sendStatus(500, "TEST 500 ERROR WITH HTML PAGE");%> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:56:21.220

您是指已弃用的[`setStatus`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletResponse.html#setStatus%28int,%20java.lang.String%29)方法吗？或者也许[`sendError`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletResponse.html#sendError%28int,%20java.lang.String%29)？错误消息非常清楚 - 没有这样的方法`sendStatus(int, String)`，并且文档证实了这一点。

你*真的*需要设置一条带有状态的消息吗？有什么理由不使用`setStatus(500)`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:56:12.010

你有HttpServletResponse 上的`setStatus(int, String)`或方法`sendError(int, String)`

[HttpSevletResponse javadoc](http://docs.oracle.com/cd/E17802_01/products/products/servlet/2.3/javadoc/javax/servlet/http/HttpServletResponse.html#sendError%28int%29)

祝你好运

# node.js - Node.js 中的“连接 EMFILE”错误

> ID：10355501
> 
> 赞同：68
> 
> 时间：2012-04-27T17:53:17.517
> 
> 标签：node.js, express, socket.io, connect

我最近收到了大量运行 Node.js 的网站的流量。随着交通量的增加，它开始出现很多崩溃，这是以前从未发生过的。我的日志中出现以下错误：

```
{ [Error: connect EMFILE] code: 'EMFILE', errno: 'EMFILE', syscall: 'connect' }
Error: connect EMFILE
    at errnoException (net.js:670:11)
    at connect (net.js:548:19)
    at net.js:607:9
    at Array.0 (dns.js:88:18)
    at EventEmitter._tickCallback (node.js:192:40) 
```

任何人都知道它为什么会崩溃？以及如何解决的想法？

我正在使用 Express.js 和 Socket.io。它在 Ubuntu 上运行。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-05-02T21:04:05.293

`EMFILE`错误意味着操作系统拒绝您的程序打开更多文件/套接字。

看看：[如何更改 Linux 中打开文件的数量限制？](https://stackoverflow.com/q/34588/511300)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-05-14T13:55:27.770

`EMFILE`表示`error maximum files`操作系统拒绝您的程序打开更多文件描述符。

注意系统中打开的文件包括磁盘文件、命名管道、网络套接字和所有进程打开的设备。

您的操作系统指定每个进程的打开文件限制。

要检查系统使用`ulimit -a`命令的打开文件限制。通常在类 unix 系统上默认为 1024。

如果限制为 1024，则意味着您/进程最多可以打开 1024 个文件。如果超过此限制意味着`open`，系统调用将失败`pipe`并`dup`产生 EMFILE 错误。

当您得到`EMFILE`它时，它主要表明您的代码中存在泄漏。如果程序中存在泄漏，将 ulimit 增加到更高的值并不是一个好的解决方案。

您应该尝试找出泄漏的原因。以下可用于在 unix 之类的操作系统中进行调试：

1.  `lsof`含义`list open files`命令给出打开文件的列表。假设您的 nodeJS 程序有泄漏，以便找出您的程序打开的文件描述符的总数：

    **lsof | grep 节点 | wc -l**

2.  要找出套接字的文件描述符，请使用：

    **lsof -n -i -P | grep 节点**

使用它，我们可以找出泄漏的位置，然后我们可以纠正它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-01-04T21:59:11.680

就我而言，我们已经设置了最高的 ulimit 集和 kern.maxfiles 配置，它可以在 Mac 上运行。

修复它的是限制全局最大套接字的数量。在更高版本的节点中，限制是无穷大。

尝试添加这些代码行：

```
var https = require('https');
var http = require('http');

https.globalAgent.maxSockets = 5;
http.globalAgent.maxSockets = 5; 
```

在使用请求库的情况下，您可以配置这些设置。

见：[https ://github.com/request/request#request---simplified-http-client](https://github.com/request/request#request---simplified-http-client)

以下是关于 maxSockets 的更多信息：[https ://nodejs.org/api/http.html#http_agent_maxsockets](https://nodejs.org/api/http.html#http_agent_maxsockets)

# sql - SQL 查询不返回结果

> ID：10355507
> 
> 赞同：0
> 
> 时间：2012-04-27T17:53:45.400
> 
> 标签：sql, filter

我正在使用三类复选框来过滤来自 WordPress 的帖子（这个问题是关于查询的），并且我知道事实上我应该使用以下查询返回结果（我根据过滤器中选择的内容自动生成第 7 行):

```
SELECT * FROM wp_posts 
LEFT JOIN wp_postmeta ON(wp_posts.ID = wp_postmeta.post_id) 
LEFT JOIN wp_term_relationships ON(wp_posts.ID = wp_term_relationships.object_id) 
LEFT JOIN wp_term_taxonomy ON(wp_term_relationships.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id) 
LEFT JOIN wp_terms ON(wp_terms.term_id = wp_term_taxonomy.term_id) 
WHERE 
    wp_terms.slug IN ('academia') AND wp_terms.slug IN ('early-career') 
    AND wp_term_taxonomy.taxonomy = 'jobtype' 
    AND wp_posts.post_status = 'publish' 
    AND wp_posts.post_type = 'jobs' 
GROUP BY wp_posts.ID ORDER BY wp_posts.post_date DESC 
```

我至少有 5 个帖子属于`academia`AND类别`early-career`。

如果我将第 7 行更改为只有一个`IN`语句，它会很好地过滤一个类别：

```
wp_terms.slug IN ('academia','journalism') //More than one from same category
AND wp_term_taxonomy.taxonomy = 'jobtype'...... 
```

它会找到所有学术或新闻工作（正是我所期望的），但是当我添加另一个`IN`语句时，没有返回任何内容（即使我有符合逻辑的帖子）。

谁能告诉我是否有问题（可能是`IN`值和值之间的空格？），因为我已经在这几天没有运气了。

任何帮助是极大的赞赏！谢谢！

**PS**如果有人想看看这个网站（看看我的意思）：[http ://www.libertyguide.com/jobs](http://www.libertyguide.com/jobs)

目前我有一个 global`OR`而不是 any `IN`，直到我让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T17:56:32.777

在子句中指定多个值`IN`表示该行必须与这些值中的一个匹配。指定 2 个`IN`子句表明该行必须同时匹配 BOTH，这是不可能的（varchar 不能同时是“学术”和“早期职业”）。

尝试将以下内容添加到查询的末尾：

```
HAVING COUNT(*) > [NUMBER OF VALUES SELECTED] 
```

所以它变成：

```
SELECT * FROM wp_posts 
LEFT JOIN wp_postmeta ON(wp_posts.ID = wp_postmeta.post_id) 
LEFT JOIN wp_term_relationships ON(wp_posts.ID = wp_term_relationships.object_id) 
LEFT JOIN wp_term_taxonomy ON(wp_term_relationships.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id) 
LEFT JOIN wp_terms ON(wp_terms.term_id = wp_term_taxonomy.term_id) 
WHERE 
    wp_terms.slug IN ('academia', 'early-career') 
    AND wp_term_taxonomy.taxonomy = 'jobtype' 
    AND wp_posts.post_status = 'publish' 
    AND wp_posts.post_type = 'jobs' 
GROUP BY wp_posts.ID ORDER BY wp_posts.post_date DESC
HAVING COUNT(*) = 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T17:59:56.703

```
SELECT * FROM wp_posts 
LEFT JOIN wp_postmeta ON(wp_posts.ID = wp_postmeta.post_id) 
LEFT JOIN wp_term_relationships ON(wp_posts.ID = wp_term_relationships.object_id) 
LEFT JOIN wp_term_taxonomy ON(wp_term_relationships.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id) 
LEFT JOIN wp_terms wt1 ON(wt1.term_id = wp_term_taxonomy.term_id) 
LEFT JOIN wp_terms wt2 ON(wt2.term_id = wp_term_taxonomy.term_id) 
WHERE 
   wt1.slug = 'academia' AND wt2.slug = 'early-career' 
    AND wp_term_taxonomy.taxonomy = 'jobtype' 
    AND wp_posts.post_status = 'publish' 
    AND wp_posts.post_type = 'jobs' 
GROUP BY wp_posts.ID ORDER BY wp_posts.post_date DESC 
```

**编辑** 要支持 N 个类别，您可以试试这个：

```
SELECT * FROM wp_posts 
LEFT JOIN wp_postmeta ON(wp_posts.ID = wp_postmeta.post_id) 
LEFT JOIN wp_term_relationships ON(wp_posts.ID = wp_term_relationships.object_id) 
LEFT JOIN wp_term_taxonomy ON(wp_term_relationships.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id) 
WHERE 
    wp_term_taxonomy.taxonomy = 'jobtype' 
    AND wp_posts.post_status = 'publish' 
    AND wp_posts.post_type = 'jobs' 
    AND wp_term_taxonomy.term_id IN (SELECT term_id from wp_terms where slug = 'academia')
    AND wp_term_taxonomy.term_id IN (SELECT term_id from wp_terms where slug = 'early-career')
GROUP BY wp_posts.ID ORDER BY wp_posts.post_date DESC 
```

您可以根据需要在代码中多次添加 AND wp_term_taxonomy... 行。

# wordpress - WordPress URL 重写 - 可选值

> ID：10355512
> 
> 赞同：1
> 
> 时间：2012-04-27T17:53:59.153
> 
> 标签：wordpress, rewrite

我正在尝试在 WP 中重写以下 URL： [http ://www.example.com/?compra=arriendo&propertytype=apartamentos&location=bogota&habitaciones=2-habitaciones](http://www.example.com/?compra=arriendo&propertytype=apartamentos&location=bogota&habitaciones=2-habitaciones)

至： http: [//www.viveya.co/arriendo/apartamentos/bogota/2-habitaciones](http://www.viveya.co/arriendo/apartamentos/bogota/2-habitaciones)

这是我的代码：

> 函数 eg_add_rewrite_rules() { 全局 $wp_rewrite;
> 
> ```
> $new_rules = array(
>     '(.+)/(.+)/(.+)/(.*)/?$' => 'index.php?compra=' . $wp_rewrite->preg_index(1) . '&propertytype=' . 
> ```
> 
> $wp_rewrite->preg_index(2) 。'&位置='。$wp_rewrite->preg_index(3) 。'&habitaciones=' 。$wp_rewrite->preg_index(4) ); $wp_rewrite->规则 = $new_rules + $wp_rewrite->规则；
> 
> }
> 
> add_action('generate_rewrite_rules', 'eg_add_rewrite_rules');

现在，我希望习惯是可选的。因此，如果我输入以下网址： http: [//www.viveya.co/arriendo/apartamentos/bogota/](http://www.viveya.co/arriendo/apartamentos/bogota/)

它仍然可以工作。（原始 URL 将是 &habitaciones=）。

当 habitaciones 为空时，我的代码不起作用。我不知道为什么。我的正则表达式有什么问题？

提前致谢！亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T10:55:17.757

这不是用正则表达式可以解决的问题。

您需要使用 PHP 解析 URL 段。未经测试的概念证明：

```
$segments = explode( '/', $url );

$query = array();

while ( $segments ) {
  $part = array_shift( $segments );

  if ( in_array( $part, array( 'taxonomy1', 'taxonomy2', ... ) ) {
    $query[ $part ] = array_shift( $segments );
  }
} 
```

编辑：好吧，我想你也可以使用正则表达式，但你需要为每个可选值添加一个额外的重写规则：

```
function eg_add_rewrite_rules() {
    global $wp_rewrite;

    $new_rules = array(
        'event/(industry|location)/(.+)/(industry|location)/(.+)/?$' => 'index.php?post_type=eg_event&' . $wp_rewrite->preg_index(1) . '=' . $wp_rewrite->preg_index(2) . '&' . $wp_rewrite->preg_index(3) . '=' . $wp_rewrite->preg_index(4),
        'event/(industry|location)/(.+)/?$' => 'index.php?post_type=eg_event&' . $wp_rewrite->preg_index(1) . '=' . $wp_rewrite->preg_index(2)
    );
    $wp_rewrite->rules = $new_rules + $wp_rewrite->rules;
}
add_action( 'generate_rewrite_rules', 'eg_add_rewrite_rules' ); 
```

资料来源：[http ://thereforei.am/2011/10/28/advanced-taxonomy-queries-with-pretty-urls/](http://thereforei.am/2011/10/28/advanced-taxonomy-queries-with-pretty-urls/)

# javascript - JQuery 动画边框

> ID：10355516
> 
> 赞同：5
> 
> 时间：2012-04-27T17:54:32.750
> 
> 标签：javascript, jquery, html, css

我有这个 html 代码

```
<nav id="mainNav">
    <ul>
        <li><a href="#">Home</a></li>
        <li><a href="#">Services</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Contact</a></li>        
    </ul>
</nav> 
```

它有这样的css风格

```
 #mainNav { display:block; padding:5px; }
    #mainNav ul { display:block; list-style-type:none; width:500px; border-collapse:collapse; }
    #mainNav li { display:inline-block; width:100px; height:66px; text-align:center; padding-top:10px; float:left; background-color:gray; cursor:pointer; border-bottom:0px solid red; }
    #mainNav a { color:white; text-decoration:none; text-transform:capitalize; }
    #mainNav a.aHover { color:red; } 
```

附在上面的是 JQuery 代码

```
$(document).ready(function() {
$('#mainNav li').mouseover(function() {
    var el = $(this);
    $(this).animate({
    "border-bottom-width":"+=5px"
    },{ queue: false, duration: 500 }, function() {
    el.css('border-bottom-width', '5px');   
    });
    $(this).children('a').addClass('aHover');
});
$('#mainNav li').mouseout(function() {
    var el = $(this);
    $(this).animate({
    "border-bottom-width":"-=5px"
    },{ queue: false, duration: 500 }, function() {
    el.css('border-bottom-width', '0px');   
    });
    $(this).children('a').removeClass('aHover');
});
}); 
```

现在我想要它做的是将边框颜色淡化为红色并将其淡出，或者如代码中所写，在悬停时将边框扩展到最大 5px，然后将边框放气回 0px。

问题是，如您所见，我尝试在动画结束时更改 LI 元素的类以确保边框达到其最大或最小宽度，但这不起作用，为什么？

你将如何淡入和淡出边框颜色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T18:02:10.513

试试下面，

[**演示**](http://jsfiddle.net/skram/dEK9A/4/)

```
$(document).ready(function() {
    $('#mainNav li').hover(function() {
        var el = $(this);
        $(this).stop(true, true).animate({
            "border-bottom-width": "5px"
        }, {
            queue: false,
            duration: 500
        });
        $(this).children('a').addClass('aHover');
    }, function() {
        var el = $(this);
        $(this).stop(true, true).animate({
            "border-bottom-width": "0px"
        }, {
            queue: false,
            duration: 500
        });
        $(this).children('a').removeClass('aHover');
    });
}); 
```

变了，

1.  `mouseover`事件，`mouseenter`因为它更适合您的情况
2.  改为`mouseenter/mouseleave`_`hover`
3.  更改为和。`+=5px`_`-=5px``5px``0px`
4.  添加`.stop(true, true)`以确保动画完成并清除队列。

# jpa - JPA Controller 类方法编辑不检查实体是否已存在，而是添加新实体

> ID：10355519
> 
> 赞同：1
> 
> 时间：2012-04-27T17:54:40.363
> 
> 标签：jpa, controller, persistence

JPA 控制器类方法 edit() 不检查实体是否已存在，而是添加新实体。我认为它应该抛出异常，因为我们想要编辑现有实体而不是添加新实体。谢谢。例如：

```
import controller.exceptions.NonexistentEntityException;
import controller.exceptions.PreexistingEntityException;
import entity.PersonNew;
import java.io.Serializable;
import java.util.List;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Query;
import javax.persistence.EntityNotFoundException;
import javax.persistence.criteria.CriteriaQuery;
import javax.persistence.criteria.Root;

public class PersonNewJpaController implements Serializable {

    public PersonNewJpaController(EntityManagerFactory emf) {
        this.emf = emf;
    }
    private EntityManagerFactory emf = null;

    public EntityManager getEntityManager() {
        return emf.createEntityManager();
    }

    public void create(PersonNew personNew) throws PreexistingEntityException, Exception {
        EntityManager em = null;
        try {
            em = getEntityManager();
            em.getTransaction().begin();
            em.persist(personNew);
            em.getTransaction().commit();
        } catch (Exception ex) {
            if (findPersonNew(personNew.getId()) != null) {
                throw new PreexistingEntityException("PersonNew " + personNew + " already exists.", ex);
            }
            throw ex;
        } finally {
            if (em != null) {
                em.close();
            }
        }
    }

    public void edit(PersonNew personNew) throws NonexistentEntityException, Exception {
        EntityManager em = null;
        try {
            em = getEntityManager();
            em.getTransaction().begin();
            personNew = em.merge(personNew);
            em.getTransaction().commit();
        } 
        catch (Exception ex) 
        {
            String msg = ex.getLocalizedMessage();
            if (msg == null || msg.length() == 0) 
            {
                Long id = personNew.getId();
                if (findPersonNew(id) == null) {
                    throw new NonexistentEntityException("The personNew with id " + id + " no longer exists.");
                }
            }
            throw ex;
        } 
        finally {
            if (em != null) {
                em.close();
            }
        }
    }

    public void destroy(Long id) throws NonexistentEntityException {
        EntityManager em = null;
        try {
            em = getEntityManager();
            em.getTransaction().begin();
            PersonNew personNew;
            try {
                personNew = em.getReference(PersonNew.class, id);
                personNew.getId();
            } catch (EntityNotFoundException enfe) {
                throw new NonexistentEntityException("The personNew with id " + id + " no longer exists.", enfe);
            }
            em.remove(personNew);
            em.getTransaction().commit();
        } finally {
            if (em != null) {
                em.close();
            }
        }
    }

    public List<PersonNew> findPersonNewEntities() {
        return findPersonNewEntities(true, -1, -1);
    }

    public List<PersonNew> findPersonNewEntities(int maxResults, int firstResult) {
        return findPersonNewEntities(false, maxResults, firstResult);
    }

    private List<PersonNew> findPersonNewEntities(boolean all, int maxResults, int firstResult) {
        EntityManager em = getEntityManager();
        try {
            CriteriaQuery cq = em.getCriteriaBuilder().createQuery();
            cq.select(cq.from(PersonNew.class));
            Query q = em.createQuery(cq);
            if (!all) {
                q.setMaxResults(maxResults);
                q.setFirstResult(firstResult);
            }
            return q.getResultList();
        } finally {
            em.close();
        }
    }

    public PersonNew findPersonNew(Long id) {
        EntityManager em = getEntityManager();
        try {
            return em.find(PersonNew.class, id);
        } finally {
            em.close();
        }
    }

    public int getPersonNewCount() {
        EntityManager em = getEntityManager();
        try {
            CriteriaQuery cq = em.getCriteriaBuilder().createQuery();
            Root<PersonNew> rt = cq.from(PersonNew.class);
            cq.select(em.getCriteriaBuilder().count(rt));
            Query q = em.createQuery(cq);
            return ((Long) q.getSingleResult()).intValue();
        } finally {
            em.close();
        }
    }

} 
```

主班

```
PersonNew p = new PersonNew();
p.setId(new Long(22));
p.setName("Ahh adas");
p.setAddress("Salatiga, Indonesia");
p.setPhonenumber("+6281390989669");
EntityManagerFactory emf = Persistence.createEntityManagerFactory("simple-jpaPU");
PersonNewJpaController con=new PersonNewJpaController(emf);

try 
{
 con.edit(p);
} 

catch (NonexistentEntityException ex) 
{
  Logger.getLogger(Demo.class.getName()).log(Level.SEVERE, null, ex);
} 
catch (Exception ex) 
{
  Logger.getLogger(Demo.class.getName()).log(Level.SEVERE, null, ex);
} 
```

现在，如果 ID 为 22 的 Person 不存在，它会创建一个新的，而是应该更新实体，如果 ID 为 22 的实体不存在，它应该抛出异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:47:44.810

在您的 edit(PersonNew) 方法中，您有以下代码：

```
em.getTransaction().begin();
personNew = em.merge(personNew);
em.getTransaction().commit(); 
```

但是，合并的行为更像是创建或更新，而不是您想要的纯更新。如果您添加一点手动检查，您可以自己处理逻辑。就像是：

```
em.getTransaction().begin();
Long newId = personNew.getId();
PersonNew personOld = em.find(PersonNew.class, newId);
if (personOld == null)
    throw new NonexistentEntityException("The personNew with id "
        + newId + " no longer exists.");
personNew = em.merge(personNew);
em.getTransaction().commit(); 
```

这样，如果新 ID 不存在，您将抛出您想要的异常。

您还必须在此之后立即摆脱您的`catch (Exception ex)`位，否则它会干扰。但这没关系，因为这应该完成你在那里尝试做的事情，以及`throws Exception`从方法签名中删除可怕的部分。

# asp.net-mvc - asp.net mvc 3 条件总是返回 false

> ID：10355520
> 
> 赞同：-1
> 
> 时间：2012-04-27T17:54:42.703
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我有一个 UserManager 模型。它看起来像：

```
public class UserManager
{
    private ToLetDBEntities TLE = new ToLetDBEntities();
    public string GetUserPassword(string usermail)
    {
        var user = from o in TLE.users where o.email_add == usermail select o;
        if (user.ToList().Count > 0)
        {
            return user.First().password;

        }
        else
            return string.Empty;
    }
} 
```

我有一个 AccountController 像：

```
public class AccountController : Controller
{
    [HttpPost]
    public ActionResult LogOn(UserLogOn model)
    {
        if (ModelState.IsValid)
        {
            UserManager um = new UserManager();
            string pass = um.GetUserPassword(model.email_add);

            if (model.password==pass)
            {
                FormsAuthentication.SetAuthCookie(model.email_add, false);
                return RedirectToAction("Welcome", "Home");
            }
            else
            {
                ModelState.AddModelError("", "The  provided  password is incorrect.");

            }

        }

        return View(model);
    }
} 
```

我有一个 UserLogon 模型包含（email_add，密码）。当我运行此控制器时，它总是给我“提供的密码不正确”错误消息。if(model.password==pass) 这个条件总是给出假的。请任何人帮助我。在此先感谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:03:31.387

你需要做一些简单的调试。

IE

*   在 GetUserPassword 中，user == null 还是与用户一起返回？
*   如果用户回来 - 他们的密码属性值是多少？

更新：来自评论

因为您使用 nchar(15) 作为数据库列类型，所以来自数据库的字符串将被额外的空格填充。

您可以通过在返回密码时修整密码来解决此问题 - 如下所示：

```
return user.First().password.Trim(); 
```

但更好的解决方法是使用 nvarchar 作为数据库列类型，这样就不会出现空白填充问题。

奖励：在 GetUserPassword 方法中，您将`user`两次枚举 IQueryable 集合 - 这将导致两个数据库调用。

将其更改为这样的内容以避免这种情况：

```
public class UserManager
{
    private ToLetDBEntities TLE = new ToLetDBEntities();
    public string GetUserPassword(string usermail)
    {
        var user = TLE.users.FirstOrDefault(x => x.email_add == usermail);
        if (user != null)
        {
            return user.password;

        }
        else
            return string.Empty;
    }
} 
```

# jquery - jquery验证电话号码和分机

> ID：10355521
> 
> 赞同：2
> 
> 时间：2012-04-27T17:54:52.960
> 
> 标签：jquery, validation

我还没有看到使用 jQuery validate 插件验证电话号码和分机的良好 RegEx。有没有人对此有很好的解决方案？可以向用户显示所需的格式：即

`Example: (555) 555-1234 x 1234`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T20:10:58.353

您可以查看[additional-methods.js](https://github.com/jzaefferer/jquery-validation/blob/master/additional-methods.js)文件，其中有一些选择。但是它们都不支持扩展，因此您必须修改一个以匹配您想要的（@jahroy 建议的扩展部分）。这是一个类似的：

```
jQuery.validator.addMethod("phoneUS", function(phone_number, element) {
    phone_number = phone_number.replace(/\s+/g, "");
    return this.optional(element) || phone_number.length > 9 &&
        phone_number.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})\s*-?[2-9]\d{2}-?\d{4}(\s*x\s*\d{4})?$/);
}, "Please specify a valid phone number"); 
```

您必须自己决定是否允许扩展是可选的（我将其保留为可选）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T17:58:00.610

根据您的帖子，您可以使用类似于以下的正则表达式：

```
([0-9]{3}) [0-9]{3}-[0-9]{4} x [0-9]{4} 
```

这可能不完全正确......您可能必须使用一些转义字符，但这应该是基本思想。

更多阅读[在这里](http://www.regular-expressions.info/tutorial.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T20:48:59.230

```
// custom extension regex
phone: function(value, element) {
    return this.optional(element) || /^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})\s*-?[2-9]\d{2}-?\d{4}(\s*x\s*\d{4})?$/.test(value);
}, 
```

# java - 符合给定条件的 Scala/Java ORM

> ID：10355528
> 
> 赞同：6
> 
> 时间：2012-04-27T17:55:06.427
> 
> 标签：java, scala, orm

哪些 Scala ORM 最适合并最符合以下要求？

*   足够类型安全。
*   不受 22 字段限制的影响。
*   适用于 MySQL 5.5。
*   适用于 Scala 2.9.1。
*   已准备好生产。

如果没有 Scala ORM 符合标准，请建议一个 Java 替代方案。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T18:41:02.213

检查[Squeryl](http://squeryl.org/)，相当不错。

# mysql - 为什么两个不同的 mysql 函数在从单个 mysql_query() 检索的数据上执行时返回不同的行？

> ID：10355529
> 
> 赞同：2
> 
> 时间：2012-04-27T17:55:30.730
> 
> 标签：mysql

我尝试将此作为测试目的。我不知道为什么会这样。那就是我需要专家的帮助。谢谢。

让我们假设我们有一个数据库并且我们已经建立了与数据库的连接。假设有一个名为 的表`table`。表格内有两列 - id 和 name。表中有 5 行数据。表结构是

```
| id |  name  |
---------------
| 1  |  name1 |
| 2  |  name2 |
| 3  |  name3 |
| 4  |  name4 |
| 5  |  name5 | 
```

现在我的代码在这里-

```
 <?php
    mysql_connect("localhost","root","") or die(mysql_error());
    mysql_select_db("test") or die(mysql_error());

    $result  = mysql_query("SELECT * FROM `table`");

    /* let's store this value in two different variables. */

    $result1 = $result;
    $result2 = $result;

    /* let's perform mysql_fetch_array() and mysql_fetch_row() functions */
    $result22 = mysql_fetch_row($result);
    var_dump($result22);
    $result11 = mysql_fetch_array($result);
    var_dump($result11);
?> 
```

结果：

```
array
  0 => string '1' (length=1)
  1 => string 'name1' (length=5)

array
  0 => string '2' (length=1)
  'id' => string '2' (length=1)
  1 => string 'name2' (length=5)
  'name' => string 'name2' (length=5) 
```

如果我改变函数的顺序，它会导致：

```
array
  0 => string '1' (length=1)
  'id' => string '1' (length=1)
  1 => string 'name1' (length=5)
  'name' => string 'name1' (length=5)

array
  0 => string '2' (length=1)
  1 => string 'name2' (length=5) 
```

似乎当我对 mysql_query 的结果执行一个函数时，该函数只是从结果中删除第一行，即使它在调用函数之前存储在其他变量中。

如果我添加一个条件 WHERE `id`= 1 则第二个函数返回 false，例如：

```
array
  0 => string '1' (length=1)
  'id' => string '1' (length=1)
  1 => string 'name1' (length=5)
  'name' => string 'name1' (length=5)

boolean false 
```

为什么会这样？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:59:10.670

此行不返回“结果”，它返回可用于访问结果的[资源](http://www.php.net/manual/en/language.types.resource.php)对象：

```
$result = mysql_query("SELECT * FROM `table`"); 
```

这些行只是将相同的资源分配给两个不同的变量：

```
$result1 = $result;
$result2 = $result; 
```

您不应将其视为两个独立的结果集。您刚刚为同一资源指定了两个不同的名称。

# xcode - UIView 动画不起作用

> ID：10355533
> 
> 赞同：1
> 
> 时间：2012-04-27T17:55:43.960
> 
> 标签：xcode, animation, uiview, uiimageview

代码非常基本：

```
UIImageView *testView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 80, 80)];
[self.view addSubview:testView];
[testView setImage:[UIImage imageNamed:@"button.png"]];
[UIView animateWithDuration:100
                 animations:^{testView.center =  CGPointMake(140,350);}
                 completion:^(BOOL finished){NSLog(@"animation finished");
                 }
 ]; 
```

不知何故，动画就是行不通。图像仅显示在结束位置。NSLog 消息确实会显示出来。

**有谁知道什么可能会使动画失败？**

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-11T20:59:57.367

这里提供的解决方案都没有真正起作用，因为他可能在代码中的错误位置调用了他的轮换代码。

在这里调用它，它会工作

```
-(void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:YES];

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:00:33.177

```
[self.view addSubview:testView]; 
```

添加子视图后..UI不会立即更新..刷新需要一点时间..但是您的动画在它可以调用更新之前被调用..所以UI仅在动画完成后更新..我会建议`[self.view setNeedsDisplay]`在动画之前调用 .. 或稍等片刻后调用动画

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T12:02:46.250

我不确定粘贴的代码是否是您的确切代码！它的动画持续时间为 100 秒。这是故意的行为吗？？

还可以尝试直接更改框架而不是中心。

```
UIImageView *testView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 80, 80)];
[self.view addSubview:testView];
[testView setImage:[UIImage imageNamed:@"button.png"]];
[UIView animateWithDuration:0.5
                 animations:^{testView.frame =  CGRectMake(140,350,80,80);}
                 completion:^(BOOL finished){NSLog(@"animation finished");
                 }
 ]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-27T18:57:15.897

添加 QuartzCore 框架：

```
#import <QuartzCore/QuartzCore.h> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-12T21:22:31.727

**您在动画代码中缺少几行。**

```
[UIView animateWithDuration:100 
    delay:0 
    options:UIViewAnimationOptionAllowAnimatedContent 
    animations:^{
        testView.center =  CGPointMake(140,350);
    } completion:^(BOOL finished){NSLog(@"animation finished")}
]; 
```

这些动画是唯一的`iOS 7`，并且是比您上面举例说明的更好的解决方案。

您可能早就回答了这个问题，但我希望这个答案能帮助任何偶然发现这个答案的人。

# css - 如何对表格进行 CSS 样式设置，使其宽度在页面宽度的 [min, max] 百分比范围内，并尽可能宽？

> ID：10355537
> 
> 赞同：1
> 
> 时间：2012-04-27T17:55:57.940
> 
> 标签：css, width, css-tables

如何对表格进行 CSS 样式设置

1.  它的宽度最多为页面宽度的 80%，并且，

2.  至少为页面宽度的 50%，并且

3.  是否尽可能宽？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T17:57:08.597

使用`min-width`和`max-width`

```
min-width: 50%;
max-width: 80%; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:06:38.687

我想你想要两个`min-width`和`max-width`：

```
<style type="text/css">
table
{
  min-width: 50%;
  max-width: 80%;
}
</style> 
```

这将使表格至少占其容器宽度的 50%。它将增长（如果需要）最大为页面宽度的 80%。

# java - 在克隆对象时需要我的逻辑帮助

> ID：10355539
> 
> 赞同：2
> 
> 时间：2012-04-27T17:56:04.930
> 
> 标签：java, nullpointerexception, compareto, cloneable

在发布此之前，我阅读了以前的一些帖子，我真的没有看到我的逻辑有什么问题。（我已经花了 3 个小时了，这可能会扼杀我的欢乐时光）****我从不想知道答案，我喜欢努力工作，所以如果有人可以问我一个关于我正在努力实现什么的问题可以引导我使用您的线索或提示来思考答案。将不胜感激。**** obj2 没有被克隆，所以在异常 stackTrace 后面，我发现同一行有一个 nullpointer 异常，这意味着 obj2 永远不会被克隆。请帮助我更努力地思考。

```
package testbankaccount;

/**
 *
 * @author 
 */
public interface Cloneable {

} 
```

我的家长班

```
package testbankaccount;

/**
 *
 * @author 
 */
public abstract class BankAccount implements Cloneable, Comparable {
    private double balance; 
    private int numberofDeposits; 
    private int numberofWithdrawals; 
    private double annualInterestRate; 
    private double monthlyServiceCharges; 
    private String customerName;

protected BankAccount(){
    this(1.0, 1.0);
}

protected BankAccount(double balance, double annualInterestRate){
    this.balance = balance;
    this.annualInterestRate = annualInterestRate;
}

public void deposit(double deposit){
    balance += deposit;
    numberofDeposits++; 
}

public void withdraw(double withdrawal){
    balance -= withdrawal;
    numberofWithdrawals++;
}

public void calcInterest(){
    double monthlyInterestRate = annualInterestRate/1200;
    double monthlyInterest = balance * monthlyInterestRate;
    balance += monthlyInterest; 
}

public void setMonthlyServiceCharge(double serviceCharge){
    monthlyServiceCharges = serviceCharge;
}

public void monthlyProcess(){
    balance -= monthlyServiceCharges;
    calcInterest();
    numberofWithdrawals = 0;
    numberofDeposits = 0;
    monthlyServiceCharges = 0.0;
}
public void setBalance(double balance){
     this.balance = balance;
}

public double getBalance(){
    return balance;
}

public int getNumberWithdraws(){
    return numberofWithdrawals;
}

@Override
    public Object clone() throws CloneNotSupportedException {

        return super.clone();

      }

    @Override
public abstract String toString();

    @Override
public abstract boolean equals(Object obj);

} 
```

我的子类

```
package testbankaccount;

/**
 *
 * @author Darren Wright
 */
public class SavingsAccount extends BankAccount implements Cloneable, Comparable {

private boolean status;

public SavingsAccount(){
    this(1.0,1.0);
}

public SavingsAccount(double balance, double annualInterestRate){
    super(balance,annualInterestRate);

}

public void setActivity(){
    if (getBalance() > 25.0)
     status = true;
    else status = false;
}

    @Override
public void withdraw(double withdrawal){
    if (status = true)
    super.withdraw(withdrawal);     
}

@Override
public void deposit(double deposit){
    if (status = false && (deposit + getBalance()) > 25.0)
    {
            status = true;
            super.deposit(deposit);
    }
    else if (status = true)
            super.deposit(deposit);
}

    @Override
public void monthlyProcess(){
        double result = 0.0;
        if(getNumberWithdraws() >4)
        result = getNumberWithdraws() - 4;
        setMonthlyServiceCharge(result);
        setActivity();
}
@Override
    public String toString() {
        throw new UnsupportedOperationException("Not supported yet.");
    }

@Override
    public Object clone() throws CloneNotSupportedException {

        return super.clone();

      }

    @Override
    public boolean equals(Object obj) {
        return (getBalance() == ((SavingsAccount)obj).getBalance());
    }

  public int compareTo(Object obj) {
    if (getBalance() > ((SavingsAccount)obj).getBalance())
      return 1;
    else if (getBalance() < ((SavingsAccount)obj).getBalance())
      return -1;
    else
      return 0;
  }

} 
```

我的测试班

```
package testbankaccount;

/**
 *
 * @author 
 */
public class TestBankAccount{

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args)  throws CloneNotSupportedException {
        SavingsAccount obj1 = new SavingsAccount(500,8.25); 
        try{
            SavingsAccount obj2 = (SavingsAccount)obj1.clone();
            System.out.println(obj1.compareTo(obj2));
            System.out.println(obj1.equals(obj2));
         }
         catch (CloneNotSupportedException ex) {
             ex.printStackTrace();
        }

    }
} 
```

我的错误输出

```
java.lang.CloneNotSupportedException: testbankaccount.SavingsAccount
    at java.lang.Object.clone(Native Method)
    at testbankaccount.BankAccount.clone(BankAccount.java:69)
    at testbankaccount.SavingsAccount.clone(SavingsAccount.java:60)
    at testbankaccount.TestBankAccount.main(TestBankAccount.java:16)
BUILD SUCCESSFUL (total time: 0 seconds) 
```

我在思考过程中遗漏了什么？我创建了接口，实现了它并在我的超类和子类中覆盖了它。我的子类将 super.clone() 引用到超类，而我认为超类中的 super.clone() 是指 Object 的 clone 方法。我在测试类中正确投射，但 obj2 在 compareTo 和 equals 中最终都为 null。我在想什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T17:58:55.517

您不应该创建自己的`Cloneable`界面。您应该使用[内置的](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Cloneable.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:02:41.053

不要创建自己的公共接口 Cloneable。现在你得到的是你定义的而不是系统的。因此，不是实现“真正的”可克隆，而是实现自己的，然后 Object.clone 函数不会将其识别为使对象可克隆。

您还需要为您希望能够克隆的每个类编写一个公共克隆函数，以覆盖从私有到公共的保护。

由于我不明白的原因，Java 使对象可克隆成为一大难题。

# mysql - 如何将数组插入数据库表？

> ID：10355545
> 
> 赞同：3
> 
> 时间：2012-04-27T17:56:22.913
> 
> 标签：mysql, ruby, postgresql, pg

我有以下 Ruby 代码：

```
 94   def open_connection(info)
 95     self.log "opening #{info.inspect}"
 96     db = Mysql.init
 97     db.options(Mysql::SET_CHARSET_NAME, 'utf8')
 98     db.real_connect(info.host, info.user, info.password, info.dbname, info.port)
 99     db.query("SET NAMES utf8")
100 »···res = db.query("SELECT realname FROM profiles")
101 
102 »···conn = PGconn.connect("localhost", 5432, '', '', "dbname", "user", "pwd") 
```

如何获取`res`变量并循环遍历它以将其插入我的 Postgres 数据库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T18:40:20.583

MySQL`query`方法为您提供了一个`Mysql::Result`实例，因此您可以使用[`each`](http://rubydoc.info/gems/mysql/Mysql/Result#each-instance_method)将每一行作为数组获取：

```
res = db.query('select realname from profiles')
res.each do |a|
    # a is an array of strings
    realname = a.first
    # ...
end 
```

如果结果集中有更多列，那么[`each_hash`](http://rubydoc.info/gems/mysql/Mysql/Result#each_hash-instance_method)可能更容易使用，它使用 Hash 调用块，将列名映射到它们的值。

要将数据插入 PostgreSQL，请使用[`exec`](http://rubydoc.info/gems/pg/PG/Connection#exec-instance_method)：

```
pg_conn.exec('insert into some_table (some_column) values ($1)', [ realname ]) 
```

请使用占位符而不是插值，没有必要像 1999 年的 PHP 程序员那样聚会。

您还可以使用[`prepare`](http://rubydoc.info/gems/pg/PG/Connection#prepare-instance_method)and [`exec_prepared`](http://rubydoc.info/gems/pg/PG/Connection#exec_prepared-instance_method)：

```
pg_conn.prepare('ins', 'insert into some_table (some_column) values ($1)')
pg_conn.exec_prepared('ins', [ realname1 ])
pg_conn.exec_prepared('ins', [ realname2 ])
# ... 
```

`prepare`如果您要一遍又一遍地执行相同的 SQL，这种方法会更好。

将它们结合起来即可完成工作：

```
res = db.query('select realname from profiles')
pg_conn.prepare('ins', 'insert into some_table (some_column) values ($1)')
res.each { |a| pg_conn.exec_prepared('ins', a) } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T18:45:46.120

使用[Sequel](http://sequel.rubyforge.org/index.html) DB 库，您可以使用[`import`](http://sequel.rubyforge.org/rdoc/classes/Sequel/Dataset.html#method-i-import)：

```
# When `res` is an array of just values
res = MYSQLDB[:profiles].select_map(:realname)
PGDB[:profiles].import([:realname],res) 
```

…或者你可以使用[`multi_insert`](http://sequel.rubyforge.org/rdoc/classes/Sequel/Dataset.html#method-i-multi_insert)：

```
# When `res` is an array of hashes mapping column name to value
res = MYSQLDB[:profiles].select(:realname).all
PGDB[:profiles].multi_insert(res) 
```

使用上述任何一种方法，您都可以选择传递带有分批插入选项的最后一个参数（这可能会使用更少的内存并因此提高性能）：

```
PGDB[:profiles].import([:realname],res,commit_every:500)
PGDB[:profiles].multi_insert(res,commit_every:500) 
```

# c# - 无法将类型“System.ConsoleKey”隐式转换为“char”

> ID：10355557
> 
> 赞同：0
> 
> 时间：2012-04-27T17:57:03.857
> 
> 标签：c#, .net, compiler-errors

我在c#中编写了以下代码，代码有错误：

```
switch (Console.ReadKey(true).KeyChar)
{
    case ConsoleKey.DownArrow:
        Console.SetCursorPosition(x,y);
        break;
} 
```

错误：

> 错误 1 ​​无法将类型“System.ConsoleKey”隐式转换为“char”。存在显式转换（您是否缺少演员表？）

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T17:59:12.293

您想要[`Key`](http://msdn.microsoft.com/en-us/library/system.consolekeyinfo.key.aspx)属性（返回`ConsoleKey`），而不是[`KeyChar`](http://msdn.microsoft.com/en-us/library/system.consolekeyinfo.keychar.aspx)（返回`char`）。

如果有疑问，如果编译器提示存在类型问题，您应该查看它的预期和实际得到的 - 并找出哪些不是您预期的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T17:59:01.850

你需要

```
switch (Console.ReadKey(true).Key)
{
    case ConsoleKey.DownArrow:
        Console.SetCursorPosition(x,y);
        break;
} 
```

反而。

常量`ConsoleKey.DownArrow`是类型`ConsoleKey`，while`Console.ReadKey(true).KeyChar`是类型`char`。由于`char`和`ConsoleKey`是不同的类型，因此此代码无法编译。相反，如果你使用返回值的[Key](http://msdn.microsoft.com/en-us/library/system.consolekeyinfo.key.aspx)属性，你会得到一个，它与 switch 语句中的 case 类型相同。`ReadKey``ConsoleKey`

# dojo - Dojo 垃圾收集/资源释放技术？

> ID：10355559
> 
> 赞同：5
> 
> 时间：2012-04-27T17:57:10.340
> 
> 标签：dojo

我最近创建了一个我认为是基于页面的应用程序，现在它被用作嵌入式控件。“控件”需要多次卸载/重新加载。这会导致未销毁的订阅和 dijit 控件出现问题。我已经制定了必要的断开连接，registry.destroy 逻辑，但这很乏味。是否有使控件集合可销毁的最佳实践？

这是显示基本逻辑可以做什么的示例代码：http: [//pastebin.com/bUUBUMP9](http://pastebin.com/bUUBUMP9)

我在问是否存在类似于 AppDomain 的框架，可以清理在该上下文中创建的任何内容。类似于将控件嵌入到 IFRAME 中......但不是。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T00:09:12.833

我可以看到两种让你的生活更轻松的做法：

1.  Dijit 小部件扩展`dijit/_WidgetBase`，因此小部件提供`(dis)connect`和`(un)subscribe`方法。您应该使用它们而不是通用用途`aspect.connect()`和`topic.subscribe()`连接小部件时，因为这样小部件在被销毁时会*断开连接*并自动*取消订阅*，因此您不必这样做。

2.  通过 组织你的小部件`dijit/layout`，例如使用`dijit/layout/ContentPane`而不是将小部件放入 DOM，因为这样你`destroyRecursive()`只需要在 上调用`ContentPane`它，它就会正确地销毁它的所有子级。根据您的需要嵌套容器以实现适当的粒度和视觉吸引力（与 Java 的概念相同`JPanel`）。

应用上述原则，您可能只需要调用`destroyRecursive()`层次结构中最高的容器来销毁 dijit。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T20:42:14.597

phusick 提供的答案更好，但在这种情况下并不是一个真正的选择。我想出了这样的解决方案：

```
var dcHandles = [], dsHandles = [], dc = dojo.connect, ds = dojo.subscribe;

dojo.connect = function () {
    var h = dc.apply ( dojo, arguments );
    dcHandles.push ( h );
    return h;
};

dojo.subscribe = function () {
    var h = ds.apply ( dojo, arguments );
    dsHandles.push ( h );
    return h;
};

dojo.subscribe ( "unload", function () {    
    // restore dojo methods
    dojo.connect = dc;
    dojo.subscribe = ds;

    var w, mll;

    mll = dojo._windowUnloaders;
    while (mll.length) {
        ( mll.pop () ) ();
    }

    if ( dijit.registry ) {
        w = dijit.byId ( "topLevelItem1" );
        w && w.destroyRecursive ();
        w = dijit.byId ( "topLevelItem2" );
        w && w.destroyRecursive ();

        // destroy any other wijits
        dijit.registry.forEach ( function ( w ) {
            try
            {
                w.destroyRecursive ();
            }
            catch ( ex )
            {
                $.error ( ex );
            }
        } );
    }

    dojo.forEach ( dcHandles, function ( h ) {
        dojo.disconnect ( h );
    } );

    dojo.forEach ( dsHandles, function ( h ) {
        dojo.unsubscribe ( h );
    } );

   // reset monad-like values
    my.global.values.value1 = null;

    dcHandles = [];
    dsHandles = [];

} ); 
```

上面给了我一些保证，在不更改大量代码的情况下，所有内容都会被取消注册/销毁/取消引用。

# php - 变量 $u 在放入 mysql_select_db 时不起作用

> ID：10355563
> 
> 赞同：0
> 
> 时间：2012-04-27T17:57:35.443
> 
> 标签：php, sql, get

我正面临这个问题。感谢任何建议。

我有一个名为 home.php 的文件。这个 home.php 将从一个名为 user 的 url 参数中获取数据。

## 主页.php

```
$u = $GET_["user"];
include('config.php'); 
```

每当 ppl 输入 www.mydomain.com/index.php?user=hello 时，文本“hello”将被捕获并放入变量 $u。

我为该特定用户有一个名为“hello”的数据库。在 config.php 中，我将使用以下代码对数据库进行 sql 连接。

## 配置文件

```
define('DB_NAME', $u); 
define('DB_HOST', 'localhost');
define('DB_USERNAME', 'admin');
define('DB_PASSWORD', '123456');

$db = DB::getInstance();
//connect to database
$db->connect(DB_HOST,DB_USERNAME,DB_PASSWORD,DB_NAME); 
```

## 数据库连接类

```
function connect($host, $username, $password, $database) {
    mysql_connect($host, $username, $password) or die('Server connexion not possible.');
    mysql_select_db($database) or die('Database connexion not possible.');
} 
```

以上都是代码片段。

我的问题是我不断收到数据库连接不可能的错误。我相信一切在逻辑上都是正确的。为了调试这个，每当我替换 define('DB_NAME', $u); 用定义（'DB_NAME'，“你好”）；-> 它有效。看来我不能动态使用 $u 中的值。

谢谢。帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:00:10.390

你正在寻找使用`$_GET`- 没有这样的东西`$GET_`

```
$u = $_GET["user"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:00:48.793

尝试使用`$_GET["user"]`而不是`$GET_["user"]`.

更多文档在这里：[http ://www.php.net/manual/en/reserved.variables.get.php](http://www.php.net/manual/en/reserved.variables.get.php)

# css - Chrome 中的背面可见性损坏（某些平台/版本）

> ID：10355564
> 
> 赞同：10
> 
> 时间：2012-04-27T17:57:45.190
> 
> 标签：css, google-chrome, webkit

所以我环顾四周，似乎`-webkit-backface-visibility`功能有点参差不齐。在 Mac 和 Linux 上的 Chrome 18 中，它运行良好。在 Windows 上的 Chrome 18 中，它没有。但是，我看到其他人在 Mac 上运行 Chrome，但它也不起作用。

这是我的测试小提琴：http: [//jsfiddle.net/csaltyj/TYuL3/](http://jsfiddle.net/csaltyj/TYuL3/)

不幸的是，由于我正在制作卡片翻转动画，我需要使用它`-webkit-backface-visibility: hidden`来隐藏卡片的背面。无论如何，有没有可以在 Chrome 上 100% 使用的等价物？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T16:24:04.517

好吧，我做了一些研究，显然这取决于机器和使用的 chrome 版本。

由于铬跟随铬发展，我们可以看到这个问题有时会出现[http://code.google.com/p/chromium/issues/detail?id=39044](http://code.google.com/p/chromium/issues/detail?id=39044)

我找到了 2 个我*无法*尝试的解决方案，因为这个 CSS 可以在我的计算机上运行。

*   尝试使用此选项启动 chrome：--enable-accelerated-compositing
*   尝试[https://stackoverflow.com/a/9276526/460368](https://stackoverflow.com/a/9276526/460368)
*   等待新版本的 chrome ;)

* * *

[你可以](http://www.cssplay.co.uk/menu/css3-3d-card.html)从 cssplay获得灵感

CSS：

```
#container {position: relative; height:362px; width: 282px; margin: 0 auto;
-webkit-perspective: 800px;
-moz-perspective: 800px;
}
#container div {position:absolute; left:0; top:0; width:242px; height: 322px; padding:20px; background:#463;
-ms-border-radius: 5px;
-moz-border-radius: 5px;
-webkit-border-radius: 5px;
border-radius: 5px;

-webkit-transition: 1.5s ease-in-out;
-moz-transition: 1.5s ease-in-out;
-ms-transition: 1.5s ease-in-out;
-o-transition: 1.5s ease-in-out;
transition: 1.5s ease-in-out;
}
#container div.lower {font-family: verdana, arial, sans-serif; background:#642;
background: -moz-linear-gradient(-45deg, #642, #864 50%, #642 100%);  
background: -webkit-gradient(linear, 0 0, 100% 100%, from(#642), color-stop(50%, #a86), color-stop(100%, #642));
-moz-transform-style: preserve-3d;
-moz-backface-visibility: hidden;
-webkit-transform-style: preserve-3d;
-webkit-backface-visibility: hidden;
-moz-transform: rotateY(-180deg);
-webkit-transform: rotateY(-180deg);
}
#container div.lower h1 {font-size:20px; padding:0; margin:0; color:#fff; line-height:40px;}
#container div.lower p {font-size:11px; padding:0; margin:0; color:#eee; line-height:20px;}
#container div.lower a {color:#ff0;}

#container div.upper {
-moz-transform-style: preserve-3d;
-moz-backface-visibility: hidden;
-webkit-transform-style: preserve-3d;
-webkit-backface-visibility: hidden;
background: -moz-linear-gradient(-45deg, #463, #8a7 50%, #463 100%);  
background: -webkit-gradient(linear, 0 0, 100% 100%, from(#463), color-stop(50%, #8a7), color-stop(100%, #463)); 
}
#container div.upper img {border:1px solid #fff;}

#container:hover div.lower {
-moz-transform: rotateY(0);
-webkit-transform: rotateY(0);
}
#container:hover div.upper {
-webkit-transform: rotateY(180deg);
-moz-transform: rotateY(180deg);
} 
```

HTML：

```
<div id="container">
    <div class="lower">

        <h1>The Barn Owl</h1>
        <p>(Tyto alba) is the most widely distributed species of owl, and one of the most widespread of all birds. It is also referred to as Common Barn Owl, to distinguish it from other species in the barn-owl family Tytonidae. These form one of two main lineages of living owls, the other being the typical owls (Strigidae). T. alba is found almost anywhere in the world except polar and desert regions, Asia north of the Alpide belt, most of Indonesia, and the Pacific islands.</p>
        <p>Source <a href="http://en.wikipedia.org/wiki/Barn_Owl">Wikipedia</a>
    </div>
    <div class="upper">
        <img src="cssplay7/owl.jpg" alt="Barn owl" />
    </div>

</div> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-19T09:46:07.273

我发现了非常优雅的解决方法，在不透明度上使用过渡延迟将其隐藏在动画的中间。

[http://jsfiddle.net/TeXTQ/](http://jsfiddle.net/TeXTQ/)

```
div {
    -webkit-transition-property: -webkit-transform, opacity;
    -webkit-transition-duration:2s, 0;
    -webkit-transition-timing-function:ease-in-out,ease-in-out;
    -webkit-transition-delay:0,1s;
}
div:hover {
    -webkit-transform: rotateX(-180deg) rotateY(0deg);
    opacity:0;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-15T21:00:47.710

我现在偶然发现了这个问题，我的原型。我以为我不小心更改了一些基本的编码 - 但不，恢复到它确实有效的先前提交并没有帮助。

信不信由你：**重新启动**Chrome 为我修复了它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-01T17:18:53.377

我使用这个 css`transform-style: preserve-3d;`或更准确地说这个 Compass mixin解决了这个问题`@include transform-style(preserve-3d);`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-06T21:42:17.597

```
-webkit-transition: -webkit-transform 1s ease-in-out, opacity .1s .5s  ease-in-out; 
```

不透明度`:hover`设置为 0。

动画需要 1 秒，在 0.5 秒内卡是不可见的，因为它在用户旁边，所以这是在 0.1 秒内出现 opacit => 0 的时间。它工作得很好。

# arrays - 无法访问 Perl 哈希中的元素

> ID：10355569
> 
> 赞同：1
> 
> 时间：2012-04-27T17:58:02.433
> 
> 标签：arrays, perl, hash, array-splice

我有一个哈希，填充了以下测试数据：

```
my %non_root_files = ('views/SPYGLASS_HOME/bin/sample_sgdc_file_contents_1.sgdc' => 1, 
                  'views/SPYGLASS_HOME/bin/sample_sgdc_file_contents.sgdc' => 1,
                  'views/SPYGLASS_HOME/bin/test_2.sgdc' => 1,
                  'views/SPYGLASS_HOME/bin/test_4.sgdc' => 1,
                  'views/SPYGLASS_HOME/bin/test_5.sgdc' => 1,
                  'views/SPYGLASS_HOME/bin/test_6.sgdc' => 1); 
```

在另一个数组中，我有以下数据：

```
my @files = ('views/SPYGLASS_HOME/bin/sample_sgdc_file_contents.sgdc', 
             'views/SPYGLASS_HOME/bin/test_2.sgdc',
             'views/SPYGLASS_HOME/bin/sample_sgdc_file_contents_1.sgdc',
             'views/SPYGLASS_HOME/bin/test_5.sgdc',
             'views/SPYGLASS_HOME/bin/test_7.sgdc',
             'views/SPYGLASS_HOME/bin/sample_sgdc_file_contents_2.sgdc'); 
```

我需要做的是检查数组中的每个条目是否存在于哈希中，并从原始数组中删除，所以我这样做如下：

```
sub deleteDuplicate{

    $originalList_ref = shift;
    my $index = 0;
    foreach my $element (@{$originalList_ref})
    {
       if(exists $non_root_files{$element})
       {
          splice(@{$originalList_ref}, $index, 1);
       }
       $index++;
    }
} 
```

但是，对于某些实际存在于散列中的条目，使用存在的查找失败。该元素存在于哈希中，但如果条件返回 false。谁能解释一下这个原因以及如何纠正它？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T18:11:12.610

布赖恩的评论是正确的；你要：

```
 if(exists $non_root_files{$element})
   {
      splice(@{$originalList_ref}, $index, 1);
   }
   else
   {
      $index++;
   } 
```

（如果删除数组中的一个条目，下一个条目将移回相同的索引）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-27T23:14:20.193

关于[perldoc perlsyn](https://metacpan.org/module/perlsyn#Foreach-Loops)`foreach`中的循环：

> 如果 LIST 的任何部分是一个数组，如果你在循环体中添加或删除元素，foreach 将变得非常混乱，例如使用 splice。所以不要那样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-16T12:24:38.830

有一种更简单的方法可以做到这一点：

```
sub deleteDuplicate {
    $original_ref = shift;
    $originalList_ref = [ grep { ! exists $non_root_files{$_} } @$originalList_ref ];
} 
```

# android - Android：应用小部件的仪器测试

> ID：10355570
> 
> 赞同：5
> 
> 时间：2012-04-27T17:58:04.043
> 
> 标签：android, testing, junit, android-appwidget

我正在寻找自动测试主屏幕小部件。我查看了[android 测试页面](http://developer.android.com/guide/topics/testing/testing_android.html "安卓测试页面")和[InstrumentationTestRunner 类](http://developer.android.com/reference/android/test/InstrumentationTestRunner.html)。我还查看了 CTS 源代码；但我找不到任何有用的东西。

我能找到的最接近的是这个[Robolectric ShadowAppWidgetManager](http://pivotal.github.com/robolectric/javadoc/com/xtremelabs/robolectric/shadows/ShadowAppWidgetManager.html)，但我不确定我将如何使用它。

您能否分享一下您是如何测试应用小部件的？有没有我可以使用的框架或库？

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-19T23:10:23.190

我认为也许一个好方法是制作一个单独的测试项目来测试你的小部件的功能并在一个文件中报告测试/失败，以后你可以“adb pull”。

编译可以通过命令行和通过 ant 自动化完成。您也可以通过命令行启动和 android 模拟器，也可以使用 adb 安装 apk，运行应用程序，并通过命令行获取结果。我同意很多工作。好消息是测试部分代码明智地独立于模拟器中，并且很容易适应安装在真实设备上。

# java - 通过 Spring 将 Google guava 缓存构建器注入 bean

> ID：10355571
> 
> 赞同：16
> 
> 时间：2012-04-27T17:58:04.947
> 
> 标签：java, spring, guava

有人可以提供一个很好的片段来通过xml构造和注入 Google guava`CacheBuilder`到依赖 bean 中吗？`Spring`

概括地说，我需要一些示例`Spring`来说明使用构建器模式构建对象。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-27T23:34:26.280

通过在下一个 Guava 版本（版本 12）中添加[CacheBuilderSpec](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/cache/CacheBuilderSpec.html)，您将能够使用[CacheBuilder.from(String spec)](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/cache/CacheBuilder.html#from%28java.lang.String%29)静态工厂方法`CacheBuilder`在 xml 中创建一个 bean 。

它看起来像这样：

```
<bean id="legendaryCacheBuilder"
      class="com.google.common.cache.CacheBuilder"
      factory-method="from">
    <constructor-arg value="maximumSize=42, expireAfterAccess=10m, expireAfterWrite=1h" />
</bean> 
```

您甚至可以使用 Spring 的 .properties 将配置字符串外部化到 .properties 文件中`PropertyPlaceholderConfigurer`。

在那之前，您应该使用 Sean Patrick Floyd 的解决方案（它还具有类型安全的优点）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-27T20:39:40.373

虽然可以使用[属性](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-factory-class-instance-factory-method "4.3.2.3。 使用实例工厂方法进行实例化")[调用 Spring XML 中的任意方法`factory-method`](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-factory-class-instance-factory-method "4.3.2.3。 使用实例工厂方法进行实例化")，但您会发现对于 Builder-Pattern 样式的链式调用几乎是不可能的。

相反，对于此类复杂场景，请[`FactoryBean`](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-factory-extension-factorybean)使用[基于 Java 的容器配置。](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-java)恐怕XML 不会让你走那么远。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-03-23T17:00:22.310

还想补充一点，如果您对不同缓存的不同缓存构建器不感兴趣，您可以直接在缓存管理器中使用缓存规范。

初始化缓存管理器时，您不需要按名称指定每个缓存，每个新的缓存请求都将基于提供的 CacheBuilder 构建一个，或者在这种情况下使用提供的 Cache Spec（这会产生相应的 CacheBuilder）。

你的 Spring XML 最终变得非常优雅：

```
<bean id="cacheManager" class="org.springframework.cache.guava.GuavaCacheManager">
    <property name="cacheSpecification" value="maximumSize=300000,expireAfterWrite=10h" />
</bean> 
```

另请注意：不要忘记通过在应用程序配置 xml 中包含以下内容来告诉 spring 您正在使用缓存：

```
<cache:annotation-driven/> 
```

您当然需要定义：

```
xmlns:cache="http://www.springframework.org/schema/cache"
xsi:schemaLocation="http://www.springframework.org/schema/cache classpath:org/springframework/cache/config/spring-cache-4.2.xsd" 
```

如果您没有做这样简单的事情，并且您确实希望为不同的用例拥有多个 CacheBuilder，那么您可能希望创建自己的工厂类和方法。

# iphone - while 循环添加一个字符而不是添加

> ID：10355573
> 
> 赞同：0
> 
> 时间：2012-04-27T17:58:16.437
> 
> 标签：iphone, objective-c, ios5

我正在遍历字典的结果，第一个键是“TC”，下一个键是“TC2”，依此类推。下面代码中的 while 语句循环到 TC1，然后循环到 TC12。它是添加一个字符而不是对 i 进行添加。如何通过循环为每个 TC 添加 1。

例如：TC1、TC2、TC3等。

```
NSString *key = @"TC";

dict = [resp objectForKey:key];
NSString* cNum = [dict objectForKey:@"CSHR_NUM"];
NSString* usrn = [dict objectForKey:@"CSHR_POS_NAME"];
NSLog( @"First for Cashier Num=%@, Cashier Name=%@", cNum, usrn);

if (cNum  != IDNUM) {

   // key = [NSString stringWithFormat:@"%@%d", key, i];
    NSLog(@"KEY after if %@", key);
    dict = [resp objectForKey:key];
    cNum = [dict objectForKey:@"CSHR_NUM"];
    usrn = [dict objectForKey:@"CSHR_POS_NAME"];
            NSLog(@"c1= %@ , %@", cNum, usrn);

    while (cNum  != NULL) {
        int i = 0;
        NSLog(@"Key on While %@", key);
        i++;

        key = [NSString stringWithFormat:@"%@%d", key, i];
        dict = [resp objectForKey:key];
        cNum = [dict objectForKey:@"CSHR_NUM"];
        usrn = [dict objectForKey:@"CSHR_POS_NAME"];

        NSLog(@"c2= %@ , %@", cNum, usrn);

        NSLog(@"KEY %@", key);

    }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:11:25.307

正如 JoshL 提到的那样：

```
NSString *rootKey = @"TC";
....

key = [NSString stringWithFormat:@"%@%d", rootKey, i]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T18:09:15.317

保留原始“根”键的值，以便您可以在每次迭代时为其附加一个新数字。然后，不要在您的 stringWithFormat 调用中使用“key”，而是使用“rootKey”。

# powershell - 为什么 PowerShell 告诉我字符串不是字符串？并且仅在调用 String.Length 时，首先

> ID：10355578
> 
> 赞同：6
> 
> 时间：2012-04-27T17:58:40.493
> 
> 标签：powershell

我正在使用字符串设置 XML 属性，PowerShell 告诉我“只有字符串可以用作设置 XmlNode 属性的值”。这是一个简单的例子。首先，我运行这个：

```
$xmlDoc = [xml]@"
<root>
  <ComponentRef Id="a" />
</root>
"@

$newId = "b"

$length = $newId.Length

Write-Host ("`n`$newId is a string, see: `$newId.GetType().FullName = " + $newId.GetType().FullName + "`n")
Write-Host ("Running `"`$xmlDoc.root.ComponentRef.Id = `$newId`"...`n")
$xmlDoc.root.ComponentRef.Id = $newId
Write-Host ("ComponentRef.Id is now: " + $xmlDoc.root.ComponentRef.Id) 
```

对我来说，输出是：

```
$newId is a string, see: $newId.GetType().FullName = System.String

Running "$xmlDoc.root.ComponentRef.Id = $newId"...

Cannot set "Id" because only strings can be used as values to set XmlNode properties.
At D:\Build\Tools\mass processing\Untitled4.ps1:14 char:27
+ $xmlDoc.root.ComponentRef. <<<< Id = $newId
    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException
    + FullyQualifiedErrorId : PropertyAssignmentException

ComponentRef.Id is now: a 
```

该错误消息一定是错误的。等号右侧的值*是*一个字符串，如上面的输出所示。但它出错了，所以 XML 属性仍然读取“a”。现在它变得更奇怪了。让我们注释掉调用 $newId.length 的行，并观察它是否正常工作。

像这样注释掉：`#$length = $newId.Length`。现在的输出是：

```
$newId is a string, see: $newId.GetType().FullName = System.String

Running "$xmlDoc.root.ComponentRef.Id = $newId"...

ComponentRef.Id is now: b 
```

我不是要求修复，因为我知道如何通过转换为最后一个赋值运算符右侧的 [string] 来解决此问题。我想知道的是：

谁能解释为什么调用 $newId.Length （一个吸气剂！）会导致 PowerShell 认为 $newId 不再是一个字符串？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T23:19:18.917

这是 V2 扩展类型系统中的一个不幸的错误，其中`psobject`可以围绕基本 .NET 类型创建包装器。当您向对象添加成员或访问不存在的属性时，可能会发生这种情况。当您访问`psobject`对象 IIRC 例如的属性时，也会发生这种情况`$newId.psobject`。当您留在 PowerShell 中时，这通常不会导致任何问题。

更新：调用 .NET 不是问题。一些快速的 .NET 测试代码表明它为属性设置器获取了一个未包装的对象。在查看它之后，`Trace-Command`它似乎是 PowerShell 中的一个错误`XmlNodeAdapater`：

```
DEBUG: ETS Information: 0 :  Method      Enter PSObject..ctor():object = System.Management.Automation.RuntimeException:
 Cannot set "Id" because only strings can be used as values to set XmlNode properties. --->
System.Management.Automation.SetValueException: Cannot set "Id" because only strings can be used as values to set
XmlNode properties.
   at System.Management.Automation.XmlNodeAdapter.PropertySet(PSProperty property, Object setValue, Boolean
convertIfPossible)
   at System.Management.Automation.Adapter.BasePropertySet(PSProperty property, Object setValue, Boolean convert)
   at System.Management.Automation.PSProperty.SetAdaptedValue(Object setValue, Boolean shouldConvert)
   at System.Management.Automation.PSProperty.set_Value(Object value)
   at System.Management.Automation.PropertyReferenceNode.SetValue(PSObject obj, Object property, Object value,
ExecutionContext context)
   --- End of inner exception stack trace ---
   at System.Management.Automation.PropertyReferenceNode.SetValue(PSObject obj, Object property, Object value,
ExecutionContext context)
   at System.Management.Automation.AssignablePropertyReference.SetValue(Object value, ExecutionContext context)
   at System.Management.Automation.AssignmentStatementNode.Execute(Array input, Pipe outputPipe, ExecutionContext
context)
   at System.Management.Automation.StatementListNode.ExecuteStatement(ParseTreeNode statement, Array input, Pipe
outputPipe, ArrayList& resultList, ExecutionContext context) 
```

确保您始终获得`base`.NET 对象的一种方法是：

```
$xmlDoc.root.ComponentRef.Id = $newId.psobject.baseobject 
```

好消息是这个问题在 V3 中已修复，例如：

```
PS> $xmlDoc = [xml]@"
<root>
  <ComponentRef Id="a" />
</root>
"@

PS> $newId = "b"

PS> $newId.Length
1

PS> $newId.psobject.typenames
System.String
System.Object

PS> $xmlDoc.root.ComponentRef.Id = $newId

PS> $xmlDoc | format-xml # From PowerShell Community Extensions
<root>
  <ComponentRef Id="b" />
</root> 
```

# c# - AppDomain.CreateInstanceAndUnwrap 在网站中不起作用

> ID：10355589
> 
> 赞同：1
> 
> 时间：2012-04-27T17:59:43.067
> 
> 标签：c#, appdomain, marshalbyrefobject

我有一个非常简单的类 CompiledFunction (MarshalByRefObject) - 我尝试在这样的新域中创建它的实例

```
var appDomainSetup = new AppDomainSetup();
appDomainSetup.ApplicationBase = Path.GetDirectoryName(typeof(CompilerService).Assembly.CodeBase);
var evidence = AppDomain.CurrentDomain.Evidence;
SandboxDomain = AppDomain.CreateDomain("Sandbox", evidence, appDomainSetup);

CompiledFunction<T> result = (CompiledFunction<T>)SandboxDomain.CreateInstanceAndUnwrap(
    assemblyName: typeof(CompiledFunction<T>).Assembly.GetName().Name,
    typeName: typeof(CompiledFunction<T>).FullName); 
```

这在控制台应用程序中工作正常，但在 ASP .NET MVC 应用程序中我得到以下异常 - 任何人都可以提供任何建议，说明为什么这在 Web 应用程序中不起作用？我传递的 T 参数是 System.Decimal

```
System.IO.FileLoadException was caught
  Message=The given assembly name or codebase, 'Ems.Scripting, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null', was invalid.
  Source=mscorlib
  FileName=Ems.Scripting, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
  FusionLog==== Pre-bind state information ===
LOG: User = EMSLaptop\PeterMorris
LOG: DisplayName = Ems.Scripting, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
 (Fully-specified)
LOG: Appbase = /C:/Users/PeterMorris/Documents/Visual Studio 2010/Projects/MvcApplication26/MvcApplication26/bin
LOG: Initial PrivatePath = NULL
Calling assembly : (Unknown).
===
LOG: This bind starts in default load context.
LOG: Found application configuration file (C:\Program Files\Common Files\Microsoft Shared\DevServer\10.0\WebDev.WebServer40.exe.Config).
LOG: Using application configuration file: C:\Program Files\Common Files\Microsoft Shared\DevServer\10.0\WebDev.WebServer40.exe.Config
LOG: Using host configuration file: 
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v4.0.30319\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL /C:/Users/PeterMorris/Documents/Visual Studio 2010/Projects/MvcApplication26/MvcApplication26/bin/Ems.Scripting.DLL.

  StackTrace:
       at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
       at System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
       at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks)
       at System.Reflection.RuntimeAssembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)
       at System.Activator.CreateInstance(String assemblyName, String typeName, Boolean ignoreCase, BindingFlags bindingAttr, Binder binder, Object[] args, CultureInfo culture, Object[] activationAttributes, Evidence securityInfo, StackCrawlMark& stackMark)
       at System.Activator.CreateInstance(String assemblyName, String typeName)
       at System.AppDomain.CreateInstance(String assemblyName, String typeName)
       at System.AppDomain.CreateInstanceAndUnwrap(String assemblyName, String typeName)
       at System.AppDomain.CreateInstanceAndUnwrap(String assemblyName, String typeName)
       at Ems.Scripting.CompilerService.Compile[T](String[] scripts, Dictionary`2 variableDefinitions, IEnumerable`1 referencedAssemblies, ICompiledFunction`1& function, IEnumerable`1& compilerErrors) in C:\Data\EMS\Lib\Ems.Scripting\CompilerService.cs:line 43
  InnerException: 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T22:33:47.600

问题是 Assembly.Code 库以 file:///{rest of path here} 开头 - 在这样的路径上使用 Path.GetDirectoryName 时，它​​会用一个正斜杠替换 file:///；所以你最终得到“/c:\myfolder\myfile.dll”

让 Uri 告诉我本地路径是解决方案

```
if (SandboxDomain == null)
{
    var appDomainSetup = new AppDomainSetup();
    string appBase = typeof(CompilerService).Assembly.CodeBase;

    //Added the following line
    appBase = new Uri(appBase).LocalPath;
    appDomainSetup.ApplicationBase = Path.GetDirectoryName(appBase);
    var evidence = AppDomain.CurrentDomain.Evidence;
    SandboxDomain = AppDomain.CreateDomain("Sandbox", evidence, appDomainSetup);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:04:55.530

看起来您没有为 Web 项目正确复制 Ems.Scripting 程序集或为您的新域设置错误的 ApplicationBase（更有可能）。

Path.GetDirectoryName 调用在计算 ApplicationBase 属性时是可疑的。

# objective-c - 无法使用 NSOpenPanel 打开图像

> ID：10355591
> 
> 赞同：0
> 
> 时间：2012-04-27T17:59:52.350
> 
> 标签：objective-c, xcode, cocoa, nsopenpanel

我使用下面的代码使用 NSOpenPanel 打开图像但不起作用

```
//panel=NSOpenPanel
 NSString *imgg = [NSString stringWithFormat:@"%@",panel.URL];
 self.imgUser.image=[NSImage imageNamed:imgg]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T18:14:37.133

问题是 +[NSImage imageNamed:] 不会通过 URL 加载图像。如果您阅读文档，它会解释它的实际作用：它会查找以该名称存储在缓存中的图像，或以该文件名存储在应用程序包或 AppKit 框架中的图像。

有很多方法可以通过 URL 实际打开图像。您可能正在寻找的是：

```
NSImage *image = [[[NSImage alloc] initWithContentsOfURL:panel.URL] autorelease]; 
```

此外，作为一个附带问题，您尝试将 URL 转换为路径的方式是不正确的。如果您有一个文件：//localhost/Users/user437064/Pictures/mypic.jpg 的 NSURL，只需将其转换为字符串即可为您提供 @"file://localhost/Users/user437064/Pictures/mypic.jpg"。这不是您可以与基于路径的 API 一起使用的路径。你真正想要的是@"/Users/user437064/Pictures/mypic.jpg"，你得到的方式是-[NSURL 路径]。所以“NSString *imgg = [panel.URL 路径];”。但这无关紧要；除非您需要处理非常旧的 OS X 版本或不常见的 API，否则几乎总是有一种方法为每个采用路径的方法采用 URL，并且通常不推荐使用基于路径的方法。

作为一个更遥远的问题，您不需要 stringWithFormat: 将某些内容转换为字符串；"[panel.URL description]" 给出了与 "[NSString stringWithFormat:@"%@", panel.URL]" 完全相同的结果，更简单，更有效。

# c# - 索引（从零开始）必须大于或等于零且小于参数列表的大小

> ID：10355592
> 
> 赞同：0
> 
> 时间：2012-04-27T17:59:54.760
> 
> 标签：c#, database, sqlite

我正在尝试在数据库中创建一个新表，该表具有结帐名称和我放入 {0} 的支票号码。但是当我运行程序时，它会出现“Productlist varchar(50)”标题中显示的错误

```
SQLiteCommand tableCreateCommand = myConnection.CreateCommand();
tableCreateCommand.CommandText = string.Format("create table Checkout{0} (ID int, Productlist varchar{0}, Date varchar {0}, Time varchar (50), Total double)");
tableCreateCommand.ExecuteNonQuery(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T18:02:03.697

您正在调用`string.Format`包括`{0}`在各个地方，表明您希望替换占位符......但您没有提供占位符值。

你想要这样的东西：

```
tableCreateCommand.CommandText = string.Format("...", checkNumber); 
```

但是，我怀疑您*实际上*需要多个参数（`{0}`,等） `{1}`，`{2}`而不仅仅是一个。您*期望*从结果中得到什么 SQL `string.Format`？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-27T18:02:15.343

您没有为 String.Format 中的占位符指定任何值。

```
string.Format("create table Checkout{0} (ID int, Productlist varchar{0}, 
Date varchar {0}, Time varchar (50), Total double)",  <you need to specify  
the list of values for place holders here...>) 
```

它应该是这样的。请注意从第二个参数开始指定的值。您可以使用常量或某个变量来代替此处显示的常量。逗号后指定的值将替换索引顺序中的占位符。`{0}`将使用值**123456**，`{1}`将使用**50**，`{2}`将使用**65**并将`{3}`使用**75**。

```
string.Format("create table Checkout{0} (ID int, Productlist varchar({1}), 
Date varchar({2}), Time varchar ({3}), Total double)", 123456, 50, 65, 75) 
```

如果您需要为结帐指定的 varchar 使用相同的占位符，则应该是这样的。我不确定这是否是您的意图。这里所有占位符 {0} 将使用相同的值 100。

```
string.Format("create table Checkout{0} (ID int, Productlist varchar({0}), 
Date varchar({0}), Time varchar (50), Total double)", 100) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:02:15.547

您尚未将字符串传递给 string.Format，它需要放入您的 {0} 占位符。你错过了一个变量吗？

```
...string.Format("your long format string {0}", someMissingStringVar); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T18:03:07.113

在此示例中，您`String.Format`使用包含占位符`{0}`但未提供任何参数的字符串进行调用。您需要删除占位符或提供参数以填充`{0}`插槽

如果您想从字面上放入`{0}`字符串，请不要使用`String.Format`或通过`{{0}}`.

# jquery - 在 jquery 对话框中使用复选框

> ID：10355593
> 
> 赞同：1
> 
> 时间：2012-04-27T17:59:56.287
> 
> 标签：jquery, checkbox

我有一个 jquery 对话框，它使用非 jquery javascript 函数来完成功能，具体取决于选择了哪个按钮。我在对话框中添加了一个复选框，用户必须选中该复选框以表示了解将发生的情况。

当我将选中状态的测试添加到非 jquery javascript 时，选中状态始终返回为 false。

以下是代码。前两个警报和返回语句用于测试：

```
function acceptPitch()
{

    // the two alerts and return false are for testing only
    alert('jq=' + $('#understand').prop("checked"));
    alert('checkbox=' + document.getElementById('understand').checked);
    return false;
    if (document.getElementById('understand').checked)
    {
        handleUserDelay();
        $('#decision').val('yes');
        document.forms['cancellationForm'].submit();
        return true;
    }
    else
    {
        alert('[appropriate message here]');
        return false;
    }
} 
```

如果复选框不在对话框中，则上述功能按预期工作。但是当它被放置在对话框中时，“checked”的测试总是返回 false。

这是对话框的主要代码：

```
var $dialog_cancel = $('#rh-dialog.cancel');
$dialog_cancel.dialog(
{
    autoOpen:false,
    width:500,
    modal:true,
    draggable:true,
    resizable:false
});

$('#reason').change(function()
{
    var reason1 = $(this).val().substr(0,1);
    if (reason1 == 'n')
    {
        $('#pitch').html($('#pitch-no').html());
        $('#acceptPitchButton').val($('#free-button-text').html());
    }
    else if (reason1 == 'y')
    {
        $('#pitch').html($('#pitch-yes').html());
        $('#acceptPitchButton').val($('#perp-button-text').html());
    }
    else
    {
        validCancelReason();
    }
});

$('#requestCancelButton').click(function()
{
    if (validCancelReason())
    {
        $dialog_cancel.dialog('open');
    }
}); 
```

以下是从“查看源代码”列表中获取的标记。请注意，jquery 仅用于显示最后四个 div 中的两个，并且 jquery 还进行了一些其他调整：

```
<div id="rh-dialog" class="cancel" title="Confirm Cancellation">
    <p>
        This will request cancellation of your continuing subscription service.<br />
    </p>
    <div id="pitch"></div>
    <p style="font-style: italic; margin-top:10px;">
        Please click <strong>YES!</strong> to continue your plan, or <strong>No, Thank You</strong> to cancel.
    </p>
    <div>
        <div id="rh-dialog-button-1">
            <input type="button" id="acceptPitchButton" value="Don't Cancel"  onclick="bar1.showBar(); acceptPitch();" />
        </div>
        <div id="rh-dialog-button-2">
            <input type="button" id="rejectPitchButton" value="No, Thank You, Just Cancel" onclick="bar1.showBar(); rejectPitch();" />
        </div>
    </div>
</div>
<div id="pitch-no" class="no-disp"><strong>GET ONE FREE MONTH!</strong><br />It is very important to us that all of our subscribers have success with our service, not only in speaking with reps but in actually growing your business. Given you are canceling because you were unsatisfied, we would like to offer you <strong>one FREE month.</strong><br /><br />To take advantage of this offer simply click <strong>Yes! Free Month</strong> and your credit card or PayPal account will not be charged for the next month.<br /><br />After your free month, you can choose to cancel your subscription or continue on with our Maintenance plan.<br/><br/><form id="agree-form"><input type="checkbox" id="understand"><strong>I understand</strong> that by requesting a free month I am not canceling my subscription, and that after the free month is over, my credit card or PayPal account will be charged for the next month of service and again every month thereafter until I do cancel.</input></form></div>
<div id="pitch-yes" class="no-disp"><strong>BARGAIN PRICE PERPETUITY PLAN!</strong><br />You realize that placing quality sales reps requires a continual effort trolling for reps at all times because timing is of the essense. For that reason, we would like to offer you our <strong>Perpetuity Plan</strong>.<br /><br />This plan is only USD $79/month, cancel anytime, and you can lock into that rate for life.<br /><br />Click <strong>Yes! Perpetuity Plan</strong> to switch to the Perpetuity Plan.</div>
<div id="free-button-text" class="no-disp">Yes! Free Month - Continue Subscription</div>
<div id="perp-button-text" class="no-disp">Yes! Perpetuity Plan</div> 
```

另外，我正在添加一个屏幕截图：

[![显示带有复选框的对话框的屏幕截图](../Images/1334314a7b6879004cb5d859799f44ce.png)](https://i.stack.imgur.com/aNeEO.png)
[（来源：[oofdah.com](http://www.oofdah.com/wp-content/uploads/2012/04/Screen-Shot-2012-04-27-at-4.38.13-PM.png)）]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T21:56:57.143

尝试以下（假设您`$dialog_cancel`在全球范围内）

```
if ($('#understand', $dialog_cancel).is(':checked'))
{
    // code
} 
```

代替

```
if (document.getElementById('understand').checked)
{
    // code
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T19:55:08.427

我已采用上述评论中提到的潜在解决方案作为解决方案。该解决方案改编自[jQuery UI Dialog with ASP.NET button postback](https://stackoverflow.com/questions/757232/jquery-ui-dialog-with-asp-net-button-postback)。

基本上，我从另一个问题中使用的方法如下：

```
dlg.parent().appendTo(jQuery("form:first")); 
```

在我的例子中，我通过在定义我的对话框后添加这个 jQuery 语句来适应这种方法：

`$dialog_cancel.parent().appendTo($('#cancellationForm'));`

出现该语句后，jQuery 和纯 javascript 方法都可以工作。也就是说，可以使用以下两个语句中的任何一个：

```
alert('jq=' + $('#understand').prop("checked"));
alert('checkbox=' + document.getElementById('understand').checked); 
```

使用这种方法后，由于对 DOM 的更改，我不得不稍微调整样式，因为由于 DOM 更改而应用了样式。

# php - 回声语句使每个回声都换行

> ID：10355595
> 
> 赞同：1
> 
> 时间：2012-04-27T17:59:58.560
> 
> 标签：php, echo

我有一个基本的 php echo statment，如下所示，它回显一个 70*70 的缩略图，但它每次都回显一个新行。有没有办法阻止这一切？

```
echo "<div class='imageIcon'><a href='index.php?menu=GaleriaYVideo&catAll=$var_catergoryAll&image=".$var_showImageAll."'><img src=".$var_showImageIcnAll." ></a></div>"; 
```

基本上我想呼应我所有的拇指，所以在同一行。任何帮助都非常感谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-27T18:02:17.013

您将输出包装在块级`div`元素中。删除它，或设置`display:inline`或`display:inline-block`它们都将是内联的。或者浮动元素并给它们一个宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:01:49.703

您可能没有为班级设置宽度和高度。

设置类似

```
.imageIcon {
width:70px;
height:70px;
float:left;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:02:36.983

你应该添加`.imageIcon {display:inline;}`到你的风格

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T18:02:56.687

导致新行的不是回声，而是 div 元素

# google-maps - 谷歌地图标记图标自动更改

> ID：10355596
> 
> 赞同：0
> 
> 时间：2012-04-27T18:00:04.557
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers, auto-update

我需要`marker`根据自动更新的 DOM 元素的内部内容自动更改 Google 地图图标。

我查看了`addListener`and的文档`addDomListener`，但都是鼠标悬停和点击之类的东西。我需要它来检测相关元素的纯 HTML 内容的变化，如果该值满足某些条件，则根据它更改标记的图标。

这是我正在使用的代码：

```
infowindow=new google.maps.InfoWindow();
for (i=0;i<buildings.length;i++){
    marker=new google.maps.Marker({
        position:new google.maps.LatLng(buildings[i][4],buildings[i][5]),
        map:map,
        shadow:shadow,
        icon:greenIcon,
        title:buildings[i][0]+" \n"+buildings[i][1],
        zIndex:buildings[i][6]
    });
} 
```

我正在考虑将 a`setInterval`与 jQuery 一起添加以强制`buildings[i][7]`数组值（上面未包含）等于相关 div 的内容，然后运行一些条件语句以确定它是否符合更改图标的正确标准标记。

但在那之后，我不知道如何让标记根据动态更新的值实际改变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T18:36:04.777

要设置与 关联的图标`Marker`，请尝试该`Marker.setIcon`功能。它接受一个参数，可以是：

1.  A`string`包含图标图像文件的相对位置（如您的代码中所示），或者 -
2.  一个[MarkerImage](https://developers.google.com/maps/documentation/javascript/reference#MarkerImage)，它可以让您更好地控制图标图像的显示方式（锚点、原点、大小等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:01:41.490

来自谷歌 api 文档

```
 var beachMarker = new google.maps.Marker({
      position: myLatLng,
      map: map,
      icon: image
  });
  map.addOverlay (beachMarker ); 
```

# java - 对于 GenerationType.IDENTITY，JPA 持久化失败

> ID：10355601
> 
> 赞同：2
> 
> 时间：2012-04-27T18:00:30.040
> 
> 标签：java, jpa, derby, jboss6.x

我有一个在 JBOss 5、JPA 和 Derby 中运行良好的旧应用程序。我现在将它移植到 JBoss 6，却发现系统无法插入带有错误消息的实体：

列“ID”不能接受 NULL 值。

其中，ID 是一个标识列：

```
@Entity
public class Customer {
    @Id 
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    int id;
    ...
} 
```

我检查了生成的模式，它看起来不错：

```
CREATE TABLE "APP"."CUSTOMER" (
    "ID" INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1), 
    "EMAIL" VARCHAR(255), 
    "NAME" VARCHAR(255),
    "PHONE" VARCHAR(255)); 
```

您可以在下面的链接中查看应用程序的代码。任何帮助表示赞赏。

[https://docs.google.com/open?id=0B_lXBrNTL1s-R3NHb2hYZlJ1Znc](https://docs.google.com/open?id=0B_lXBrNTL1s-R3NHb2hYZlJ1Znc)

拉吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T17:04:34.720

嗯，我有事情要做。基本上，当您使用 JPA 在 Derby 中生成模式时，它可以很好地创建表，但是在插入带有标识列的行时会出现问题。解决方案不是从 JPA 生成模式。我手动创建了模式并注释掉了模式生成选项。

```
<persistence version="1.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">
<persistence-unit name="ContactsPU" transaction-type="JTA">
    <jta-data-source>java:DerbyDS</jta-data-source>
    <class>com.webage.contacts.Customer</class>
    <!-- 
    <properties>
        <property name="hibernate.dialect" value="org.hibernate.dialect.HSQLDialect"/>
        <property name="hibernate.hbm2ddl.auto" value="create-drop"/>
    </properties>
     -->
</persistence-unit>
</persistence> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-14T03:45:13.320

您无需自己创建方案即可解决此问题。只需从 GenerationType.IDENTITY 更改为 GenerationType.TABLE。

@GeneratedValue(strategy=GenerationType.TABLE)

我在德比中遇到了同样的问题，这解决了它。

# java - 以编程方式设置视图的重力

> ID：10355603
> 
> 赞同：24
> 
> 时间：2012-04-27T18:00:30.703
> 
> 标签：java, android, view, gravity

我正在研究`View`Android 源代码。我想知道我们如何设置多个重力，自定义`View`

这是 XML

```
<com.android.systemui.statusbar.policy.Clock
        android:id="@+id/clock"
        android:textAppearance="@style/TextAppearance.StatusBar.Clock"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:singleLine="true"
        android:paddingLeft="6dip"
        android:gravity="center_vertical|left"
        /> 
```

如您所见，默认重力是 center_vertical|left，所以我的 Java 代码应该是这样的

```
 View clock = mStatusBarView.findViewById(R.id.clock);

    if (clock != null) {
        SOMEHOW SET GRAVITY -> mCenterClock ? Gravity.CENTER : (Gravity.CENTER_VERTICAL | Gravity.LEFT);
    } 
```

setGravity 方法不起作用`View`。那么有没有一种设置重力而不丢失默认宽度和高度的替代方法？

提前致谢。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-04-27T18:21:10.257

由于 com.android.systemui.statusbar.policy.Clock 扩展了 TextView，因此只需将其转换为 TextView 并设置重力。

```
 TextView clock = (TextView) mStatusBarView.findViewById(R.id.clock);
 clock.setGravity(mCenterClock ? Gravity.CENTER : (Gravity.CENTER_VERTICAL | Gravity.LEFT)); 
```

参考：[源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.1_r1/com/android/systemui/statusbar/policy/Clock.java)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-27T18:05:09.057

你有没有尝试过？

```
clock.setGravity(Gravity.CENTER | Gravity.CENTER_VERTICAL); 
```

编辑：

由于您不能使用`setGravity`普通的`View`，请执行以下操作，

您可以使用`RelativeLayout`并设置这样的规则...

```
RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT);
params.addRule(RelativeLayout.CENTER_HORIZONTAL|RelativeLayout.CENTER_IN_PARENT, clock.getId()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-27T18:02:53.930

```
 com.android.systemui.statusbar.policy.Clock clock = (com.android.systemui.statusbar.policy.Clock)mStatusBarView.findViewById(R.id.clock);

 clock.setGravity(Gravity.CENTER_VERTICAL); 
```

尝试上面的代码并删除 View clock = mStatusBarView.findViewById(R.id.clock);

# configuration - 是否可以使用不在默认位置之一的配置文件启动 activemq？

> ID：10355607
> 
> 赞同：4
> 
> 时间：2012-04-27T18:00:37.590
> 
> 标签：configuration, activemq

好吧，所有你的activemq大师都在那里......

目前activemq在运行前需要一个配置文件。它出现在其调试输出消息中：

```
$ ./activemq start -h
 INFO: Using default configuration (you can configure options in one of these file: /etc/default/activemq      /home/user_name/.activemqrc) 
```

你*只能*把它放在这两个位置之一。有谁知道是不是这种情况？是否有一些命令行参数来指定其位置？

谢谢！-罗杰-

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-07-31T22:25:41.820

对的，这是可能的。这里有 3 个可能的答案。

如果类路径设置正确：

```
activemq start xbean:myconfig.xml

activemq start xbean:file:./conf/broker1.xml 
```

不使用类路径：

```
activemq start xbean:file:C:/ActiveMQ/conf/broker2.xml 
```

参考： [http ://activemq.apache.org/activemq-command-line-tools-reference.html](http://activemq.apache.org/activemq-command-line-tools-reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-09T14:07:28.583

我一直无法找到这个问题的答案，我自己也为此苦苦挣扎了一段时间，但我找到了一些解决方法。当您使用 bin/activemq create 时，您可以创建一个可运行的实例，该实例将具有自己的 bin、conf 和 data 目录。然后，您可以更好地控制该可运行实例，并且 .activemqrc 变得不那么重要。

有关创建选项的详细信息，请参见此处：http: [//activemq.apache.org/unix-shell-script.html](http://activemq.apache.org/unix-shell-script.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T19:47:51.033

尝试这个：

`bin/activemq start xbean:/home/user/activemq.xml`

请注意，如果 xml 文件包含其他文件，例如 jetty.xml，那么它也需要位于该目录中。

如果使用最近的 5.6 SNAPSHOT，您可以将环境变量 ACTIVEMQ_CONF 设置为指向您拥有配置文件的位置

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-23T06:23:50.620

在 # CONFIGURATION # 下的 /bin/activemq 脚本中，对于使用实例，您可以添加或删除您想要的任何文件目标。

尽管它在文件的第一次出现时忽略了其他文件，但请在此处阅读更多内容

[Unix 配置](http://activemq.apache.org/unix-shell-script.html)

快乐编码！

# tsql - 获取与分区上的最大值关联的标签 (SQL)

> ID：10355610
> 
> 赞同：1
> 
> 时间：2012-04-27T18:00:51.337
> 
> 标签：tsql

我知道必须有更好的方法来做到这一点，我今天脑死了。

我有两张桌子：

```
Reference
Id         Label
1          Apple
2          Banana
3          Cherry  

Elements
Id    ReferenceId    P1   P2   Qty
1     1              1    2    8
2     2              2    3    14
3     1              3    2    1
4     3              2    1    6
5     3              1    2    3 
```

我想主要按 (P1, P2) 将它们分组，但独立于 P1 和 P2 的顺序 - 以便 (1,2) 和 (2,1) 映射到同一组。没关系。

另一部分是我想获得给定 P1、P2 对的总和（数量）较大的标签 - 换句话说，我希望结果集为：

```
 P1   P2  TotalQty  MostRepresentativeLabel
 1    2   17        Cherry
 2    3   15        Banana 
```

我能想到的就是这个可怕的混乱：

```
select endpoint1, endpoint2, totalTotal, mostRepresentativeLabelByQty from 
(
select SUM(qty)as total
,case when (p1<p2) then p1 else p2 end as endpoint1
,case when (p1<p2) then p2 else p1 end as endpoint2
,reference.label as mostRepresentativeLabelByQty

from elements inner join reference on elements.fkId = reference.id
group by case when (p1<p2) then p1 else p2 end
,case when (p1<p2) then p2 else p1 end
,label
) a inner join 
(
select MAX(total) as highestTotal, SUM(total) as totalTotal from 
(
select SUM(qty)as total
,case when (p1<p2) then p1 else p2 end as endpoint1
,case when (p1<p2) then p2 else p1 end as endpoint2
,reference.label as mostRepresentativeLabelByQty

from elements inner join reference on elements.fkId = reference.id
group by case when (p1<p2) then p1 else p2 end
,case when (p1<p2) then p2 else p1 end
,label
) byLabel
group by endpoint1, endpoint2
) b
on a.total = b.highestTotal 
```

哪个..有效...但我不相信。这最终将在更大的数据集（200,000 行左右）上运行，所以我不喜欢这种方法 - 有没有更简单的方法来表达“使用该列中的值，而其他列被最大化”我'我完全空白？

(SQL Server 2008 R2 by the way)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T22:48:06.193

I use the sum of the BINARY_CHECKSUM's of P1 and P2 to uniquely identify each group. This SUM is identified by the BC alias, and permits the grouping needed to find the largest group labels.

```
DECLARE @Reference TABLE(ID INT, Label VARCHAR(10));
DECLARE @Elements TABLE(ID INT, ReferenceID INT, P1 INT, P2 INT, Qty INT);

INSERT INTO @Reference VALUES
(1,'Apple')
, (2,'Banana')
, (3,'Cherry');

INSERT INTO @Elements VALUES
(1,1,1,2,8)
, (2,2,2,3,14)
, (3,1,3,2,1)
, (4,3,2,1,6)
, (5,3,1,2,3);

; WITH a AS (
    SELECT
    P1, P2=P2, Qty, BC=ABS(BINARY_CHECKSUM(CAST(P1 AS VARCHAR(10))))+ABS(BINARY_CHECKSUM(CAST(P2 AS VARCHAR(10))))
    , Label
    , LabelSum=SUM(Qty)OVER(PARTITION BY ABS(BINARY_CHECKSUM(CAST(P1 AS VARCHAR(10))))+ABS(BINARY_CHECKSUM(CAST(P2 AS VARCHAR(10)))),Label)
    , GroupSum=SUM(Qty)OVER(PARTITION BY ABS(BINARY_CHECKSUM(CAST(P1 AS VARCHAR(10))))+ABS(BINARY_CHECKSUM(CAST(P2 AS VARCHAR(10)))))
    FROM @Elements e
    INNER JOIN @Reference r on r.ID=e.ReferenceID
)
, r AS (
    SELECT *, rnk=RANK()OVER(PARTITION BY BC ORDER BY LabelSum DESC)
    FROM a
)
SELECT P1=MIN(P1)
, P2=MAX(P2)
, TotalQty=GroupSum
, MostRepresentativeLabel=Label
FROM r
WHERE rnk=1
GROUP BY GroupSum,Label
ORDER BY GroupSum DESC;
GO 
```

Result:

![enter image description here](../Images/7aa91fc58ff969e42e13edeb2f6e8c6d.png)

**EDIT** Wrap each BINARY_CHECKSUM in ABS to maximize the entropy of the sums of each group's BINARY_CHECKSUM. Because BINARY_CHECKSUM is a signed BIGINT, this will decrease the chances of a collision between two different groups where a positive BINARY_CHECKSUM is summed with a negative BINARY_CHECKSUM.

# matlab - Matlab 开关盒

> ID：10355618
> 
> 赞同：2
> 
> 时间：2012-04-27T18:01:55.593
> 
> 标签：matlab, switch-statement

我正在尝试编写一个函数，将单元格数组中每个事物的类、长度和值放入一个结构中，但是我不断收到 switch 语句的错误

```
function [ out, common ] = IDcell( cA )
%UNTITLED Summary of this function goes here
%   Detailed explanation goes here
cl={};
val={};
len={};
for x=1:length(cA)
    switch cA(x)
        case isnum
            cl(x)='double';
        case ischar
            cl(x)='char';
        case islogical
            cl(x)='logical';
        case iscell
            cl(x)= 'cell';
    end

val=[val cA{x}];
len=[len size(value(x))];
end

out=struct('value', val, 'class', cl, 'length', len);

end

[out]=IDcell(cA)
SWITCH expression must be a scalar or string constant.
Error in IDcell (line 8)
switch cA(x) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T18:18:23.547

`isnum`不是 Matlab 函数。 `isnumeric`可能是你想的，但不是你输入的。这意味着您的代码正在查看`case isnum`并且它不知道到底`isnum`是什么，所以它会告诉您它是什么，如果您想在那里使用它，您需要使它的值可以计算为一个数字（标量的含义）或一段文本（字符串常量的含义）。

此外，`ischar`是一个 matlab 函数，但您没有以正确的方式使用它。`ischar(cA(x))`例如，您必须使用它，然后评估`true`是否`cA(x)`是字符串或文本片段，评估`false`是否`cA(x)`是其他任何内容。

如果以`switch`这种方式工作会很可爱，但事实并非如此。您不能在`switch`零件中放置一个东西，然后只列出需要对该零件中的那个东西进行评估的函数 `switch`。

你可以做的事情是这样的：

```
switch class(x)
    case 'double'
        fprintf('Double\n');
    case 'logical'
        fprintf('Logical\n');
end 
```

在这里，我以需要使用`class`的方式使用了该函数，其中包含一个参数。然后我根据该函数的输出切换我的案例，类输出一个字符串。

# networking - UDP 数据包大小和数据包丢失

> ID：10355626
> 
> 赞同：6
> 
> 时间：2012-04-27T18:02:22.603
> 
> 标签：networking, network-programming

我一直在编写一个程序，它在 UDP 之上使用停止和等待协议通过 LAN 和 WAN 发送数据包。我最近一直在测试我的程序，并注意到较大数据包（接近 64k 字节）的数据包丢失率更高。直觉上这是有道理的，但真正的原因是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-27T18:46:20.393

大于承载它们的网络的[MTU 大小](http://en.wikipedia.org/wiki/Maximum_transmission_unit)的 UDP 数据包将自动拆分为多个数据包，然后由接收方重新组合。如果这些多个子数据包中的任何一个被丢弃，那么接收器也将丢弃其余的子数据包。

因此，例如，如果您发送一个 63k UDP 数据包，并且它通过以太网，它将被分解成 47+ 个更小的“片段”数据包（因为以太网的 MTU 是 1500 字节，但其中一些用于 UDP 标头等，因此 UDP 数据包中可用的用户数据空间量小于此值）。如果所有 47 个以上的片段数据包都可以通过，接收器将只会“看到”该 UDP 数据包。如果这些片段包中只有一个被丢弃，则整个操作将失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T22:24:19.210

好吧，数据网络远非可靠；数据包一直被丢弃。过载的路由器、完整的缓冲区和损坏的数据包是其中一些原因。由于 UDP 没有流量控制功能，因此在接收端过载等情况下，它不会减速。

正如 Jeremy 解释的那样，有效载荷越大，它将被分割成的数据包越多，因此丢失其中一些数据包的可能性就越大。

UDP 用于此处丢弃的数据包不会影响任何事情或您需要及时到达那里或根本不需要的情况。（VOIP、流媒体视频等）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-22T16:40:57.127

这都是关于 IP 碎片和碎片整理的。超过 MTU 的数据包会被碎片化，并且必须在最终主机上进行碎片整理，碎片也有可能在路径上再次碎片化，这又会增加延迟。有时，如果某些 N/W 元素被配置为第 4 层过滤，那么它会整理碎片（不是最终主机）应用规则，然后再次进行碎片整理和转发。这就是需要性能的应用程序总是尝试发送大小 <= (MTU-ETHHDR-IPHDR) 的数据的原因

# macos - GLSL 1.2：glBindAttribLocation 中使用的不同索引的默认属性是什么

> ID：10355628
> 
> 赞同：0
> 
> 时间：2012-04-27T18:02:24.603
> 
> 标签：macos, opengl, osx-snow-leopard, glsl

```
GLuint index = 0;
glBindAttribLocation(mprogram, index, name); 
```

例如，'0' 索引是 gl_position，但其他索引如 1 和 2 呢？

@Nicolas问题是，当我将索引设置为零时，我注意到对 glVertexAttrib(index...) 的调用会修改顶点位置而不是我分配给它的属性...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:34:05.643

首先，`gl_Position`是顶点着色器的*输出*位置，而不是输入。它不是顶点属性，而且从来都不是。你大概在想`gl_Vertex`。

`gl_Vertex`其次，最重要的是，像,等内置属性`gl_Color`没有通用属性索引。`gl_Vertex`与通用属性 0 不同。OpenGL 规范明确*禁止*这两者相同。通用属性（具有属性索引的事物）和内置属性不会相互“别名”。它们不共享相同的资源或空间。

现在，NVIDIA 的 OpenGL 实现允许混叠，这违反了 OpenGL 规范。但是这样的代码是不可移植的（而且很糟糕）。如果您想确切了解 NVIDIA 是如何进行映射的，我相信 NVIDIA 网站上的文档会在某处说明这一点。

# php - 合并包含相同名称的对象数组中的元素

> ID：10355629
> 
> 赞同：1
> 
> 时间：2012-04-27T18:02:29.640
> 
> 标签：php, arrays, object

如何从具有相同名称的对象数组中删除元素，使其仅存在一次？

在下面的情况下，我想删除元素 2，因为名称与元素 0 相同。（对我来说，术语 id 或 count 不同并不重要）。

```
array(1) { 
 [0]=> object(stdClass)#268 (3) { 
         ["term_id"]=> string(3) "486" 
         ["name"]=> string(4) "2012" 
         ["count"]=> string(2) "40"
 } 
 [1]=> object(stdClass)#271 (3) { 
         ["term_id"]=> string(3) "488" 
         ["name"]=> string(8) "One more"
         ["count"]=> string(2) "20"  
 } 
 [2]=> object(stdClass)#275 (3) { 
         ["term_id"]=> string(3) "512" 
         ["name"]=> string(8) "2012"
         ["count"]=> string(2) "50"  
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:22:18.323

如果对象的 'name' 属性是公开的，像这样：

```
$filteredObjArr = array();
$existNames = array();
foreach($objArray as $k => $obj) {
  if(!in_array($obj->name, $existNames)) {
    $filteredObjArr[$k] = $obj;
    $existNames[] = $obj->name;
  }
} 
```

`$objArray`是原始数组，`$filteredObjArr`是您所需要的。

如果 'name' 属性不是公共的，则使用方法返回 'name' 而不是`$obj->name`. 例如：

```
$obj->getName(); //this method name is example 
```

如果该类没有返回“名称”的方法，则必须添加它：

```
Class OriginalClass {

    //...something

    // add
    public function getName() {
        return $this->name;
    }
} 
```

如果您不想更改原始课程，请扩展它：

```
Class ExtendedClass extends OriginalClass {
    public function getName() {
        return $this->name;
    }
} 
```

# c# - 泛型集合类型测试

> ID：10355635
> 
> 赞同：5
> 
> 时间：2012-04-27T18:02:48.933
> 
> 标签：c#, types, generic-collections

无论泛型类型如何，我都想根据给定的集合类型（使用反射）进行一些操作。

这是我的代码：

```
 void MyFct(Type a_type)
    {
        // Check if it's type of List<>
        if (a_type.Name == "List`1")
        {
            // Do stuff
        }
        // Check if it's type of Dictionary<,>
        else if (a_type.Name == "Dictionary`2")
        {
            // Do stuff
        }
    } 
```

它现在有效，但对我来说很明显它不是最安全的解决方案。

```
 void MyFct(Type a_type)
    {
        // Check if it's type of List<>
        if (a_type == typeof(List<>))
        {
            // Do stuff
        }
        // Check if it's type of Dictionary<,>
        else if (a_type == typeof(Dictionary<,>))
        {
            // Do stuff
        }
    } 
```

我也尝试过，它实际上可以编译但不起作用...我还尝试测试给定集合类型的所有接口，但这意味着集合中接口的排他性...

我希望我说清楚了，我的英语缺乏训练:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-27T18:06:02.033

如果您想查看某个东西是否实现了特定的泛型类型，那么您需要这样做：

```
if(a_type.IsGenericType && a_type.GetGenericTypeDefinition() == typeof(List<>)) 
```

该`GetGenericTypeDefinition()`方法将返回无界泛型类型供您测试。

# c# - InvalidOperationException：SqlDataReader.Close() 处的内部连接致命错误

> ID：10355636
> 
> 赞同：1
> 
> 时间：2012-04-27T18:02:51.857
> 
> 标签：c#, sqldatareader

我有带有逻辑的遗留代码，如下所示：

```
using (SqlDataReader drColor = ColorDal.GetColors())
{
   if (drColor.HasRows)
   {
      string colorCacheKey = string.Empty;
      //_log.Debug("Total Color Count loaded from database: " + dsColor.Tables.Count.ToString());

      // Retrieve each colorfamily present in the dataset.
      while (drColor.Read())
      {
         ......
      }
   }

   drColor.Close(); // This is line # in the exception.
} 
```

我在我的 ASP.NET MVC 应用程序中间歇性地收到以下异常：

> [InvalidOperationException：内部连接致命错误。]
> System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) +6355814
> System.Data.SqlClient.SqlDataReader.CloseInternal(Boolean closeReader) + 308
> 系统.Data.SqlClient.SqlDataReader.Close() +293

可以关闭`SqlDataReader`内部`using{}`会是它的原因吗？

谢谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-09-23T13:18:44.090

这可能会有所帮助......不确定他们在哪里处理这个错误，但它可能会给你一个开始的地方：

[http://connect.microsoft.com/VisualStudio/feedback/details/772492/internal-connection-fatal-error-system-invalidoperationexception](http://connect.microsoft.com/VisualStudio/feedback/details/772492/internal-connection-fatal-error-system-invalidoperationexception)

# javascript - 基于页面宽度的 js 条件问题

> ID：10355637
> 
> 赞同：0
> 
> 时间：2012-04-27T18:02:51.917
> 
> 标签：javascript, jquery, responsive-design

我正在尝试使用下面的代码根据页面宽度使侧边栏菜单具有粘性或不粘性。基本上，如果窗口宽度超过 768 像素，“unstick”应该为 false，或者小于 768px 时为 true。如果用户调整页面大小，它也应该更新。

它在初始页面加载时正常工作，但在调整大小时并非总是如此。如果页面开始 > 768，并且缩小，unstick 会从 false 变为 true，就像我想要的那样；但是然后它就这样卡住了，如果页面放大就不会变回来。

如果页面开始 <768，unstick 开始设置为 true，就像我想要的那样，但是调整页面大小不会改变任何东西——它总是保持 true。

我的条件有问题吗？

```
$(function(){
  $(window).resize(function(){
     if($(this).width() >= 768){
         jQuery('#info').containedStickyScroll({
             duration: 0,
             unstick: false
         });
     } else {
         jQuery('#info').containedStickyScroll({
             duration: 0,
             unstick: true
         });
     }
  })
  .resize();//trigger resize on page load
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:46:08.083

看起来您的插件没有删除它的旧事件/dom 元素。每次调用 .containedStickyScroll 时，它都会保留之前的一些选项。

这是我为修复它所做的：

```
$(function(){
    $(window).resize(function(){
        if($(this).width() >= 768){
            jQuery('#info').containedStickyScroll({
                duration: 0,
                unstick: false
             });
             $(".scrollFixIt").remove();
             $(window).unbind("scroll");
         } else {
             jQuery('#info').containedStickyScroll({
                 duration: 0,
                 unstick: true
             });
         }
    })
    .resize();//trigger resize on page load
}); 
```

希望这可以帮助。

# sencha-touch - 添加按钮并在视图之间导航

> ID：10355639
> 
> 赞同：1
> 
> 时间：2012-04-27T18:02:54.797
> 
> 标签：sencha-touch, extjs, sencha-touch-2

1.) 我需要添加 2 个按钮，一个在另一个下方。我到目前为止的工作如下所示；它只显示一个按钮，但如何在此按钮下方添加另一个按钮图像不同的按钮？

2.) 当用户点击一个按钮时，我需要导航到另一个屏幕。我怎样才能做到这一点 ？我需要相当于下面的objective-c代码吗？

```
View1 *view1 = [[View1 alloc] initWithNibName:@"View1" bundle:nil];
            [self.navigationController pushViewController:View1 animated:YES]; 
```

3.）如何添加导航栏（相当于iPhone中显示的导航栏）

第一个问题的代码；

```
{
                items:[
                    {
                        xtype:'button',
                        text: 'Submit',
                        ui:'confirm',
                        handler: function(){
                          var values = Ext.getCmp('contactForm').getValues();

                          Ext.Ajax.request({

                            url: 'http://loonghd.com/service/',

                            failure: function (response) {
 //do something
            },                              success: function (response) {
                                                                         // do something
                            }

                           });
                        }
                    }
                ]

            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:32:03.757

也许导航视图对您有用？这是相同的想法，但它就像从 UITableView 开始：

[http://docs.sencha.com/touch/2-0/#!/example/navigation-view](http://docs.sencha.com/touch/2-0/#!/example/navigation-view)

在 app/controller/Application.js 中，当您点击联系人时，会推送详细信息视图。所有源代码都在示例目录中。

```
    onContactSelect：函数（列表、索引、节点、记录）{
        var editButton = this.getEditButton();

        如果（！this.showContact）{
            this.showContact = Ext.create('AddressBook.view.contact.Show');
        }

        // 将记录绑定到显示联系人视图
        this.showContact.setRecord(record);

        // 将显示联系人视图推送到导航视图中
        this.getMain().push(this.showContact);
    },

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:45:46.233

**1）**为了让两个按钮一个在另一个之下，您可以添加两个单独的按钮（具有不同的 ui 属性）作为表单面板的子项。我想，这就是你需要的。

像这样，

```
 ....
   ....
   items : [
       {
         xtype:'button',
         text: 'Submit',
         ui:'confirm', // makes the button color as green
         handler: function(){
            var values = Ext.getCmp('contactForm').getValues();
            Ext.Ajax.request({
                 url: 'http://loonghd.com/service/',
                 failure: function (response) {
                        //do something
                  },

                 success: function (response) {
                         // do something
                 }
            });
           }
          },
          {
              xtype:'button',
              text:'Second button',
              ui:'decline', // makes the button color as red.
              listeners : {
                  tap : function() {
                     Ext.Msg.alert('You just clicked Second button');
                  }
               } 
           } 
  ]
  ....
  .... 
```

**2）3）**对于您的第二个和第三个问题，`navigationview`是解决方案。发布的解决方案`M-x`很棒，但它是非常高级的示例，而且一开始也很难理解。

这是 Sencha Docs 的一个简单解决[**方案。**](http://docs.sencha.com/touch/2-0/#!/guide/navigation_view)`navigatioview`

```
//create the navigation view and add it into the Ext.Viewport
var view = Ext.Viewport.add({
    xtype: 'navigationview',

    //we only give it one item by default, which will be the only item in the 'stack' when it loads
    items: [
        {
            //items can have titles
            title: 'Navigation View',
            padding: 10,

            //inside this first item we are going to add a button
            items: [
                {
                    xtype: 'button',
                    text: 'Push another view!',
                    handler: function() {
                        //when someone taps this button, it will push another view into stack
                        view.push({
                            //this one also has a title
                            title: 'Second View',
                            padding: 10,

                            //once again, this view has one button
                            items: [
                                {
                                    xtype: 'button',
                                    text: 'Pop this view!',
                                    handler: function() {
                                        //and when you press this button, it will pop the current view (this) out of the stack
                                        view.pop();
                                    }
                                }
                            ]
                        });
                    }
                }
            ]
        }
    ]
}); 
```

# c++ - C++ 二叉搜索树状态访问冲突错误与添加节点

> ID：10355641
> 
> 赞同：0
> 
> 时间：2012-04-27T18:02:57.893
> 
> 标签：c++, add, binary-search-tree

我正在开发一个使用二叉树的程序。在树中添加新节点时出现错误。我可以添加一个节点，但添加另一个节点后，我收到 STATUS_ACCESS_VIOLATION 错误。我认为错误可能与处理搜索功能的函数参数有关。如果可以，请你帮助我。

这是我写的他.h文件：

```
#ifndef P4_H
#define P4_H
#include <iostream>
#include <iomanip>
#include <fstream>
#include <cctype>
#include <string>
using namespace std;

struct TreeNode //ListNode structure with components
{
   int acctNum;
   TreeNode *left;
   TreeNode *right;
};

typedef TreeNode* nodePtr;  //defines a pointer to a treenode struct

class Tree
{
   private:
            nodePtr root;
            int numElements;

   public:

   Tree()
   { root = NULL; numElements = 0; }

   bool treeEmpty()
   { return (numElements == 0); }

   void addNode()
   {
      int key;
      cout << "Enter account number to add: ";
      cin >> key;
      cout << endl << endl;

      nodePtr location = NULL, parent = NULL, p = NULL;

      bool found = searchTree(key, &location, &parent);

      cout << found << " " << location << " " << parent << endl << endl;

      if (found)
      {
         cout << "Error! Account number: " << key << " already exists within"
         << " the tree." << endl << endl;
      }
      else
      {
         if (parent == NULL)
         {
            root = new TreeNode;
            root->acctNum = key;
         }
         else
         {
            if (parent->acctNum > key)
            {
               parent->left = new TreeNode;
               p = parent->left;
               p->acctNum = key;
            }
            else
            {
               parent->right = new TreeNode;
               p = parent->right;
               p->acctNum = key;
            }
         }
      }
   }

   bool searchTree(int key, nodePtr *location, nodePtr *parent)
   {
      bool found = false;
      nodePtr p = root;
      *location = root;
      parent = NULL;

      while (p != NULL && !found)
      {
         *location = p;
         if (key == p->acctNum)
            found = true;
         else if (key < p->acctNum)
         {
            *parent = p;
            p = p->left;
         }
         else if (key > p->acctNum)
         {
            *parent = p;
            p = p->right;
         }
      }
      return found;
   }

   void deleteNode()
   {
      int key;
      nodePtr location = NULL, parent = NULL;

      cout << "Enter account number to delete: ";
      cin >> key;
      cout << endl << endl;

      bool found = searchTree(key, &location, &parent);

      if (!found)
      {
         cout << "Error! Account number: " << key << " was not found."
         << endl << endl;
      }
      else if (location->left != NULL && location->right != NULL)
      {  //delete node with left and right subtrees
         nodePtr leftmost = location->right, leftmostParent = NULL;

         while (leftmost->left != NULL)
         {
            leftmostParent = leftmost;
            leftmost = leftmost->left;
         }

         leftmost->left = location->left;
         leftmost->right = location->right;
         leftmostParent->left = NULL;

         if (parent->acctNum > location->acctNum)
            parent->left = leftmost;
         else
            parent->right = leftmost;

         delete location;
         location = NULL;
      }
      else if (location->left != NULL && location->right == NULL)
      {  //delete node with only a left subtree
         if (parent->acctNum > location->acctNum)
            parent->left = location->left;
         else
            parent->right = location->left;

         delete location;
         location = NULL;
      }
      else if (location->left == NULL && location->right != NULL)
      {  //delete node with only a right subtree
         nodePtr leftmost = location->right, leftmostParent = NULL;

         while (leftmost->left != NULL)
         {
            leftmostParent = leftmost;
            leftmost = leftmost->left;
         }

         leftmost->right = location->right;
         leftmostParent->left = NULL;

         if (parent->acctNum > location->acctNum)
            parent->left = leftmost;
         else
            parent->right = leftmost;

         delete location;
         location = NULL;
      }
      else
      {  //delete a leaf node
         if (location->acctNum > parent->acctNum)
            parent->right = NULL;
         else
            parent->left = NULL;

         delete location;
         location = NULL;
      }
   }

   void displayAscend(nodePtr p, int count)
   {
      if (p->left != NULL)
         displayAscend(p->left, count);
      cout << count << ". " << p->acctNum << endl;
      count ++;
      if (p->right != NULL)
         displayAscend(p->right, count);
   }

   void displayDescend(nodePtr p, int count)
   {
      if (p->right != NULL)
         displayAscend(p->right, count);
      cout << count << ". " << p->acctNum << endl;
      count ++;
      if (p->left != NULL)
         displayAscend(p->left, count);
   }

   void readFile()
   {
      char filename[50];

      cout << "Enter name of file to open: ";
      cin.getline(filename,51);
      cout << endl << endl;

      ifstream inFile;
      inFile.open(filename);

      while (!inFile)
      {
         cout << "Error opening file! Please try again." << endl << endl;
         cout << "Enter name of file: ";
         cin.getline(filename,51);
         cout << endl << endl;
      }

      int num;

      while (!inFile.eof())
      {
         inFile >> num;

         nodePtr location = NULL, parent = NULL, p = NULL;

         bool found = searchTree(num, &location, &parent);

         if (found)
         {
            cout << "Error! Account number: " << num << " already exists"
            << " within the tree." << endl << endl;
         }
         else
         {
            if (parent == NULL)
            {
               root = new TreeNode;
               root->acctNum = num;
            }
            else
            {
               if (parent->acctNum > num)
               {
                  parent->left = new TreeNode;
                  p = parent->left;
                  p->acctNum = num;
               }
               else
               {
                  parent->right = new TreeNode;
                  p = parent->right;
                  p->acctNum = num;
               }
            }
         }
      }

   }
};
#endif 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:06:36.643

在 searchTree 中，在循环之前将 parent 设置为 NULL，然后在循环中取消引用它。

# javascript - 添加一个带有 Jquery 或 Javascript 的类来标记

> ID：10355644
> 
> 赞同：1
> 
> 时间：2012-04-27T18:03:15.157
> 
> 标签：javascript, jquery, addclass, removeclass

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T18:06:36.527

试试这样的事情（你可能需要使用不同的属性`location`，比如`href`或`pathname`，但你明白了）：

```
$('ul.menubar a').each(function(){
    if(location.href === this.href){
        $(this).addClass('selected');
        $('ul.menubar a').not(this).addClass('none');
        return false;
    }
}); 
```

或者更好：

```
$('ul.menubar a').addClass('none').filter('a[href="'+location.pathname+'"]')
    .removeClass('none').addClass('selected'); 
```

`location`以下是有关该对象的更多信息： [https ://developer.mozilla.org/en/DOM/window.location](https://developer.mozilla.org/en/DOM/window.location)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:06:19.553

一个非常简单的方法，但不能保证效率。HTML：

```
<ul class="menubar">
    <li><a href="home.php" class="selected" id="Home">Home</a></li>
    <li><a href="services.php" class="none" id="Services">Services</a></li>
    <li><a href="aboutus.php" class="none" id="About Us">About Us</a></li>
    <li><a href="contact.php" class="none" id="Contact Us">Contact Us</a></li>
</ul> 
```

Javascript：

```
$(document).ready(function() {
 $("#"+ $.trim( $("title").html() ) ).addClass("selected");
}); 
```

编辑：添加了 $.trim()，只是一个额外的步骤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:06:50.053

只需将 ID 属性添加到您的“a 标签”并使用 jQuery 即可：

```
$("#home").addClass('selected'); 
```

# mysql - MYSQL 计算 2 个表中的相关行

> ID：10355645
> 
> 赞同：3
> 
> 时间：2012-04-27T18:03:17.427
> 
> 标签：mysql

我有 3 张桌子

```
products table
productid   productname
---------   -----------
 1          product 1
 2          product 2
 5          product 3
 10         product 4
 11         product 5
 12         product 6

accounts_products table
id  productid   accountid
--  ---------   ---------
1   1           accountid 1
2   10          accountid 2
3   2           accountid3

leads_products table
id  productid    leadid
--  ---------    ---------
1   1            leadid 1
2   5            leadid 2
3   2            leadid 3 
```

我试图根据相同的productid 计算leads_products 和accounts_products 表中有多少总产品。

```
Expected result

Product ID    Product Name    Total
-----------   ------------    --------
1             product 1         2
2             product 2         2
5             product 3         1
10            product 4         1 
```

我试过到目前为止

```
SELECT p.productid as 'Product ID', 
       p.productname as 'Product Name', 
       COUNT(*) as 'Total' FROM products p
INNER JOIN leads_products l ON (l.productid=p.productid)
INNER JOIN accounts_products a ON (a.productid=p.productid)
GROUP BY p.productname,p.productid 
```

以上查询计数并显示比预期更高的数字。

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-27T18:08:21.983

试试这个：

```
SELECT p.productid as 'Product ID', 
       p.productname as 'Product Name', 
       (SELECT COUNT(*)
        FROM leads_products AS l
        WHERE l.productid = p.productid) + 
       (SELECT COUNT(*)
        FROM accounts_products AS a
        WHERE a.productid=p.productid) AS 'Total'
FROM products AS p 
```

[http://www.sqlfiddle.com/#!2/f8472/5](http://www.sqlfiddle.com/#!2/f8472/5)

使用 JOIN 的替代方法（更好的性能）：

```
SELECT p.productid as 'Product ID', 
       p.productname as 'Product Name', 
       IFNULL(l.count, 0) + IFNULL(a.count, 0) as 'Total'
FROM products AS p
LEFT JOIN (
    SELECT productid, COUNT(*) AS count
    FROM leads_products
    GROUP BY productid
) AS l
ON l.productid = p.productid
LEFT JOIN (
    SELECT productid, COUNT(*) AS count
    FROM accounts_products
    GROUP BY productid
) AS a
ON a.productid = p.productid 
```

[http://www.sqlfiddle.com/#!2/f8472/33](http://www.sqlfiddle.com/#!2/f8472/33)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-27T18:19:53.433

我使用 p.products 的左连接来保存所有产品，然后计算每个列表中的产品并将它们加在一起。第一次尝试工作。可能有十亿种方法可以做到这一点。

```
SELECT p.productid 'Product ID', 
       p.productname 'Product Name', 
       COUNT(a.accountid) + COUNT(l.leadid) total
FROM products p
LEFT JOIN accounts_products a ON p.productid = a.productid
LEFT JOIN leads_products l ON p.productid = l.productid
GROUP BY p.productid 
```

[http://www.sqlfiddle.com/#!2/f8472/37](http://www.sqlfiddle.com/#!2/f8472/37)

# oracle - Oracle OWB Cube 负载 SQL 调优

> ID：10355646
> 
> 赞同：2
> 
> 时间：2012-04-27T18:03:27.083
> 
> 标签：oracle, performance, sql-tuning

我有一个 OWB 映射，它从临时表中获取输入并将这些行添加到多维数据集。多维数据集背后的基础表是使用外键与维度连接的关系事实表。查询背后的解释计划成本相当高，映射运行时间为 30 分钟。如果您在下面看到，在第 17 步中，成本上升到 1,396,573，这也是嵌套循环开始出现的地方。有人可以提供一般指针来调整这个查询吗？

计划

```
SELECT STATEMENT  ALL_ROWSCost: 1,746,526,275  Bytes: 386,835,904  Cardinality: 464,947                                                             
    46 NESTED LOOPS OUTER  Cost: 1,746,526,275  Bytes: 386,835,904  Cardinality: 464,947                                                        
        41 NESTED LOOPS OUTER  Cost: 1,744,200,663  Bytes: 380,791,593  Cardinality: 464,947                                                    
            37 NESTED LOOPS OUTER  Cost: 1,743,270,415  Bytes: 374,747,282  Cardinality: 464,947                                                
                34 NESTED LOOPS OUTER  Cost: 1,740,476,128  Bytes: 368,702,971  Cardinality: 464,947                                            
                    29 NESTED LOOPS OUTER  Cost: 1,739,545,862  Bytes: 362,658,660  Cardinality: 464,947                                        
                        25 NESTED LOOPS OUTER  Cost: 1,710,193,475  Bytes: 356,614,349  Cardinality: 464,947                                    
                            20 NESTED LOOPS OUTER  Cost: 49,230,267  Bytes: 350,570,038  Cardinality: 464,947                               
                                17 NESTED LOOPS OUTER  Cost: 1,402,837  Bytes: 344,525,727  Cardinality: 464,947                            
                                    13 HASH JOIN RIGHT OUTER  Cost: 7,481  Bytes: 338,481,416  Cardinality: 464,947                         
                                        1 TABLE ACCESS STORAGE FULL TABLE ORION.DIM_HR_SALARY Cost: 6  Bytes: 31  Cardinality: 1                    
                                        12 HASH JOIN RIGHT OUTER  Cost: 7,472  Bytes: 324,068,059  Cardinality: 464,947                     
                                            2 TABLE ACCESS STORAGE FULL TABLE ORION.DIM_ADDRESS Cost: 2,050  Bytes: 65  Cardinality: 1                  
                                            11 HASH JOIN RIGHT OUTER  Cost: 5,420  Bytes: 293,846,504  Cardinality: 464,947                 
                                                3 TABLE ACCESS STORAGE FULL TABLE ORION.DIM_SESSION Cost: 12  Bytes: 70  Cardinality: 1             
                                                10 HASH JOIN RIGHT OUTER  Cost: 5,405  Bytes: 261,300,214  Cardinality: 464,947             
                                                    4 TABLE ACCESS STORAGE FULL TABLE ORION.DIM_LOCATION Cost: 9  Bytes: 21  Cardinality: 1         
                                                    9 HASH JOIN RIGHT OUTER  Cost: 5,393  Bytes: 251,536,327  Cardinality: 464,947          
                                                        5 TABLE ACCESS STORAGE FULL TABLE ORION.DIM_HR_EMPLOYEE Cost: 135  Bytes: 75  Cardinality: 1    
                                                        8 HASH JOIN RIGHT OUTER  Cost: 5,256  Bytes: 216,665,302  Cardinality: 464,947      
                                                            6 TABLE ACCESS STORAGE FULL TABLE ORION.DIM_CLASS_INSTRUCTOR Cost: 12  Bytes: 48  Cardinality: 1  
                                                            7 TABLE ACCESS STORAGE FULL TABLE O_STG.FACT_CLASS_INSTRUCTOR_STG2 Cost: 5,241  Bytes: 194,347,846  Cardinality: 464,947  
                                    16 VIEW SYS. Cost: 3  Bytes: 13  Cardinality: 1                         
                                        15 TABLE ACCESS BY INDEX ROWID TABLE ORION.DIM_CLASS_ATTRIBUTES Cost: 3  Bytes: 153  Cardinality: 1                     
                                            14 INDEX RANGE SCAN INDEX ORION.ALL_ATTRIBUTES_IDX_12 Cost: 2  Cardinality: 1               
                                19 VIEW SYS. Cost: 103  Bytes: 13  Cardinality: 1                           
                                    18 TABLE ACCESS STORAGE FULL TABLE ORION.DIM_COURSE Cost: 103  Bytes: 30  Cardinality: 1                        
                            24 PARTITION HASH ALL  Cost: 3,572  Bytes: 13  Cardinality: 1  Partition #: 27  Partitions accessed #1 - #8                             
                                23 VIEW SYS. Cost: 3,572  Bytes: 13  Cardinality: 1                             
                                    22 TABLE ACCESS BY LOCAL INDEX ROWID TABLE ORION.DIM_PERSON Cost: 3,572  Bytes: 31  Cardinality: 1  Partition #: 27  Partitions accessed #1 - #8                        
                                        21 INDEX RANGE SCAN INDEX ORION.ALL_ATTRIBUTES_IDX_2_P Cost: 8  Cardinality: 3,661  Partition #: 27  Partitions accessed #1 - #8                    
                        28 PARTITION RANGE ALL  Cost: 63  Bytes: 13  Cardinality: 1  Partition #: 31  Partitions accessed #1 - #7                                   
                            27 VIEW SYS. Cost: 63  Bytes: 13  Cardinality: 1                                
                                26 TABLE ACCESS STORAGE FULL TABLE ORION.DIM_TIME_TERM Cost: 63  Bytes: 27  Cardinality: 1  Partition #: 31  Partitions accessed #1 - #7                            
                    33 VIEW SYS. Cost: 2  Bytes: 13  Cardinality: 1                                         
                        32 FILTER                                   
                            31 TABLE ACCESS BY INDEX ROWID TABLE ORION.DIM_HR_JOB Cost: 2  Bytes: 38  Cardinality: 1                                
                                30 INDEX RANGE SCAN INDEX ORION.ALL_ATTRIBUTES_IDX_19 Cost: 1  Cardinality: 1                           
                36 VIEW SYS. Cost: 6  Bytes: 13  Cardinality: 1                                             
                    35 TABLE ACCESS STORAGE FULL TABLE ORION.DIM_ORG_STRUCTURE Cost: 6  Bytes: 37  Cardinality: 1                                       
            40 VIEW SYS. Cost: 2  Bytes: 13  Cardinality: 1                                                 
                39 TABLE ACCESS BY INDEX ROWID TABLE ORION.DIM_DEMOGRAPHICS Cost: 2  Bytes: 43  Cardinality: 1                                              
                    38 INDEX RANGE SCAN INDEX ORION.ALL_ATTRIBUTES_IDX Cost: 1  Cardinality: 1                                          
        45 VIEW SYS. Cost: 5  Bytes: 13  Cardinality: 1                                                     
            44 FILTER                                               
                43 TABLE ACCESS BY INDEX ROWID TABLE ORION.DIM_DEPARTMENT Cost: 5  Bytes: 31  Cardinality: 1                                            
                    42 INDEX RANGE SCAN INDEX ORION.ALL_DEPT_ATTRIBUTES_IDX Cost: 1  Cardinality: 3 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T20:58:48.097

尽管名称为“基于成本的优化器”，但实际成本通常对故障排除解释计划没有帮助。

**基数**通常是最重要的信息。只要 Oracle 估计一个数量级内的行数，该计划可能就足够了。

在这种情况下，模式中的几乎每个表`ORION`的基数都是 1。Oracle 认为该模式中的每个表都是空的，或者至少在过滤后不返回任何行，我猜这不是真的。这可能是由于统计数据不佳造成的。（没有*丢失*统计信息；如果只是丢失了统计信息，Oracle 可以使用动态抽样进行粗略猜测。）

尝试重新收集统计信息：

```
begin
    dbms_stats.gather_schema_stats('ORION');
end;
/ 
```

当然，计划变坏的方法有上百万种。如果一个简单的统计数据收集不能解决它，您需要发布查询，以及一些信息，例如您希望它运行多长时间、表的大小等。

# git - 合并另一个分支的两个修订之间的更改

> ID：10355649
> 
> 赞同：0
> 
> 时间：2012-04-27T18:03:52.947
> 
> 标签：git

这是我第一次使用 git，这是我的问题。有“master”分支和“temporary”分支，它是从 master 分支 sinse 版本 1 分支出来的。我在“temporary”分支中工作并进行了本地更改。现在我想合并自“次要”分支创建以来所做的一些“主”分支更改。

我使用 TortoiseGit。所以我点击我的工作目录，选择合并并选择“master”分支。但我没有看到任何选项来指出我想合并哪些修订。如果我按确定，它会说我的工作文件夹是最新的并且没有合并任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:07:36.493

就 git 而言，您应该`git rebase master`在`temporary`分支上执行。`master`这将在您的新分支提交之前“添加”新`temporary`分支提交（可能会相应地修改它们。）在 TortoiseGit 中寻找相关操作，这是必须的。

# scheme - 延续计划

> ID：10355651
> 
> 赞同：3
> 
> 时间：2012-04-27T18:04:15.313
> 
> 标签：scheme, continuations

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-27T18:13:25.263

延续是仍有待执行的“计算的其余部分”。在您的特定示例中，您可以将其视为要插入值的孔在`(display [])`哪里。`[]`也就是说，在被调用的那一刻，`call/cc`剩下要做的就是调用显示。

所做的是获取这个`call/cc`延续并将其置于一个可以像函数一样应用的特殊值中。它将这个值传递给它的参数（这里`f`）。在`f`中，延续势在必行`return`。所以`(return 2)`基本上会插入`2`延续，即`(display 2)`.

我不认为这个例子实际上很有帮助，所以如果你有兴趣了解更多关于延续的信息，我认为你应该阅读[PLAI （参见第 VII 部分）。](http://www.cs.brown.edu/~sk/Publications/Books/ProgLangs/)另一个很好的来源是Dan Friedman 的[这些讲义](http://www.cs.unm.edu/~williams/cs491/appcont.pdf)。

# api - Magento 批量更新属性

> ID：10355652
> 
> 赞同：8
> 
> 时间：2012-04-27T18:04:16.717
> 
> 标签：api, magento, attributes, sku

我错过了通过 SKU/UPC 批量更新属性的 SQL。

*运行 EE1.10 仅供参考*

我有所有其余的代码工作，但我不确定谁/什么/为什么实际更新我们的属性，并且无法找到它们，我的逻辑是

1.  打开 CSV 并将所有 skus 和关联的属性抓取到 2d 数组中
2.  将 SKU 解析为 entity_id
3.  获取 entity_id 和属性并运行更新直到完成
4.  采取自星期五以来的剩余时间

这是我的（几乎完成的）代码，非常感谢一些帮助。

```
 /**
     * FUNCTION: updateAttrib
     * 
     * REQS: $db_magento
     * Session resource
     * 
     * REQS: entity_id
     * Product entity value
     * 
     * REQS: $attrib
     * Attribute to alter
     * 
     */ 
```

请参阅我对工作生产代码的回复。希望这可以帮助 Magento 社区中的某个人。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-29T18:50:06.317

虽然这在技术上可能可行，但您编写的代码只是您应该执行此操作的最后一种方式。

在 Magento 中，您确实应该使用代码提供的模型，而不是自己编写数据库查询。

在您的情况下，如果您需要更新 1 个或多个产品的属性，有一种方法可以非常快速（并且非常安全）完成。

如果您查看：/app/code/core/Mage/Adminhtml/controllers/Catalog/Product/Action/AttributeController.php，您会发现此控制器专用于快速更新多个产品。

如果您查看 saveAction() 函数，您会发现以下代码行：

```
Mage::getSingleton('catalog/product_action')
    ->updateAttributes($this->_getHelper()->getProductIds(), $attributesData, $storeId); 
```

此代码负责更新您想要的所有产品 ID，一次只更新任何单个商店的更改属性。

第一个参数基本上是一个产品 ID 数组。如果您只想更新单个产品，只需将其放入数组中即可。

第二个参数是一个数组，其中包含您要为给定产品更新的属性。例如，如果您想将价格更新为 10 美元并将重量更新为 5，您将传递以下数组：

```
array('price' => 10.00, 'weight' => 5) 
```

最后，第三个也是最后一个属性是您希望这些更新发生在的商店 ID。这个数字很可能是 1 或 0。

我会玩弄这个函数调用并使用它，而不是编写和维护自己的数据库查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T20:17:16.683

一般更新查询将如下所示：

```
UPDATE 
  catalog_product_entity_[backend_type] cpex 
SET
  cpex.value = ? 
WHERE cpex.attribute_id = ? 
  AND cpex.entity_id = ? 
```

为了找到与属性关联的 [backend_type]：

```
SELECT 
  backend_type
FROM
  eav_attribute
WHERE entity_type_id =
  (SELECT
    entity_type_id
  FROM
    eav_entity_type
  WHERE entity_type_code = 'catalog_product')
AND attribute_id = ? 
```

您可以从以下博客文章中获得更多信息：http:
[//www.blog.magepsycho.com/magento-eav-structure-role-of-eav_attributes-backend_type-field/](http://www.blog.magepsycho.com/magento-eav-structure-role-of-eav_attributes-backend_type-field/)

希望这对您有所帮助。

# c# - 更改系统时间不接受时区

> ID：10355655
> 
> 赞同：2
> 
> 时间：2012-04-27T18:04:25.953
> 
> 标签：c#, .net, winapi, interop

我有这个代码来改变系统时间。

此代码有效，但不知何故不接受本地系统时区。

看来我必须添加更多方法才能做到这一点，或者？？

怎么可能？？？

有什么线索吗？

```
public static class SystemFunctions
    {
        public struct SystemTime
        {
            public ushort Year;
            public ushort Month;
            public ushort DayOfWeek;
            public ushort Day;
            public ushort Hour;
            public ushort Minute;
            public ushort Second;
            public ushort Millisecond;
        };

        [DllImport("kernel32.dll", EntryPoint = "GetSystemTime", SetLastError = true)]
        public extern static void Win32GetSystemTime(ref SystemTime sysTime);

        [DllImport("kernel32.dll", EntryPoint = "SetSystemTime", SetLastError = true)]
        [return: System.Runtime.InteropServices.MarshalAsAttribute(System.Runtime.InteropServices.UnmanagedType.Bool)]
        public extern static bool Win32SetSystemTime(ref SystemTime sysTime);

        public static bool SetSystemTime(DateTime dateTime)
        {
            SystemTime updatedTime = new SystemTime();
            updatedTime.Year = (ushort)dateTime.Year;
            updatedTime.Month = (ushort)dateTime.Month;
            updatedTime.Day = (ushort)dateTime.Day;
            // UTC time; it will be modified according to the regional settings of the target computer so the actual hour might differ
            updatedTime.Hour = (ushort)dateTime.Hour;
            updatedTime.Minute = (ushort)dateTime.Minute;
            updatedTime.Second = (ushort)dateTime.Second;
            // Call the unmanaged function that sets the new date and time instantly
            return Win32SetSystemTime(ref updatedTime);
        }
    } 
```

* * *

更新

所以最终的解决方案是将本地时间转换为`ToUniversalTime`并应用它。 **但在我们必须应用正确的时区之前。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:11:51.223

[SetSystemTime](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724942%28v=vs.85%29.aspx)仅接受 UTC 时间。因此，如果需要，您需要在 C# 代码中将本地转换为 UTC。

> 设置当前系统时间和日期。系统时间以协调世界时 (UTC) 表示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:16:26.030

您的意思是在调用api之前需要将时间从本地时间转换为UTC？

```
 var utcTime=TimeZone.CurrentTimeZone.ToUniversalTime(new DateTime(){...}); 
```

# database - Sqlite 选择查询 - 返回默认行？

> ID：10355659
> 
> 赞同：0
> 
> 时间：2012-04-27T18:04:48.860
> 
> 标签：database, sqlite, select

例如，我有一个像这样的表 Emp。

```
----------------------
eName      | eId
----------------------
Anusha       1
Sunny        2 
```

假设我正在寻找一个 id 为 3 的条目。我想编写一个查询来找到该行并显示它。但如果它没有找到它，它应该显示一个默认行 (temp,999)

```
select case
when (total != 0) then (select eName from Emp where eId = 3)
when (total == 0) then "temp"
end as eName,
case
when (total != 0) then (select eId from Emp where eId = 3)
when (total == 0) then 999
end as eId
from Emp,(select count(*) as total from Emp where eId = 3); 
```

使用我编写的这个查询，它给了我两行结果。

```
temp  999
temp  999 
```

我认为这是因为 `(select count(*) as total from Emp where eId = 3)`查询列表中的这个查询。

我尝试使用 distinct 子句，它只给了我一行。但是我有点怀疑我是否弄乱了查询并且只是试图使用黑客来做到这一点。请建议是否有更好的方法来做到这一点或者我是否错了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:33:45.257

我将介绍如何正确执行此操作，但首先让我给您一个长长的答案，以帮助您理解 SQL。使用情况是这样的：

您的 select 子句不会影响您获得的记录数。所以为了理解发生了什么，让我们稍微简化一下查询。让我们把它改成，

```
select * from emp, (select count(*) as total from emp where eid=3) 
```

我不确定你认为“emp”后面的逗号在这里做了什么，但 SQL 将其视为两个表的旧式连接：emp 和由 select count(*) 创建的临时表等。没有WHERE 子句，所以这是一个交叉连接，但是第二张表无论如何只有一条记录，所以那部分无关紧要。但是没有 WHERE 子句的事实意味着您将获得 emp 中的每条记录，并加入到计数中。所以这个查询的输出是：

```
ename   eid  count(*)
Anusha  1    0
Sunny   2    0 
```

如果您有 100 条记录，您将获得 100 个结果。

坦率地说，在 SQL 中没有真正干净的方法来做你想做的事情。这是在代码中更简洁的事情：执行简单的“select ... where eid=3”，如果没有记录，请在运行时填写默认值。

但是假设您出于某种原因需要在 SQL 中执行此操作，我认为最简单的方法是：

```
select eid, ename from emp where eid=3
union
select 999 as eid, 'temp' as ename
where not exists (select 1 from emp where eid=3) 
```

在某些 SQL 版本中，您需要在第二次选择时提供一个虚拟表名，例如 Oracle 要求您说“从双重”。

# c - c - 错误：在数字常量之前出现 ')'

> ID：10355661
> 
> 赞同：1
> 
> 时间：2012-04-27T18:04:52.410
> 
> 标签：c, struct, avr

我在头文件中有以下代码：

```
#ifndef BUFFER_H
#define BUFFER_H
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct c_buff
{
    void *buffer;     // data buffer
    void *buffer_end; // end of data buffer
    size_t capacity;  // maximum number of items in the buffer
    size_t count;     // number of items in the buffer
    size_t sz;        // size of each item in the buffer
    void *head;       // pointer to head
    void *tail;       // pointer to tail
};

void cb_init(c_buff *cb, size_t capacity, size_t sz)
{
    cb->buffer = malloc(capacity * sz);
    if(cb->buffer == NULL) {
        // handle error
    }
    cb->buffer_end = (char *)cb->buffer + capacity * sz;
    cb->capacity = capacity;
    cb->count = 0;
    cb->sz = sz;
    cb->head = cb->buffer;
    cb->tail = cb->buffer;
}
#endif 
```

以及下面的c文件

```
#include <avr/io.h>
#include <avr/interrupt.h>
#include <stdio.h>
#include <common.h>
#include <usart.h>
#include <buffer.h>

struct c_buff usart_buffer;
struct c_buff *usart_buffer_ptr;

cb_init(usart_buffer_ptr, USART_BUFFER_SIZE, sizeof(char));

void initUSART(void) {
    SETBIT(UCSR0A, UDRE0);
    //SETBIT(UCSR0A, U2X0);
    SETBIT(UCSR0C, UCSZ01);
    SETBIT(UCSR0C, UCSZ00);

    UBRR0 = 25;

    SETBIT(UCSR0B, RXCIE0);
    SETBIT(UCSR0B, TXCIE0);
    SETBIT(UCSR0B, RXEN0);
    SETBIT(UCSR0B, TXEN0);
}

ISR(USART_RX_vect) {
    char data;
    data = UDR0;
    UDR0 = data;
}

ISR(USART_TX_vect) {

} 
```

当我尝试编译它时，我得到一个指向这一行的错误：

```
cb_init(usart_buffer_ptr, USART_BUFFER_SIZE, sizeof(char)); 
```

它只是在数字常量之前说“错误：预期的'）'。

谷歌告诉我这是某种预处理器错误。但我不明白怎么会是这样。

我是 C 的新手，所以如果这是完全显而易见的事情，我深表歉意。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T18:07:13.097

您不能在顶层进行裸函数调用。

```
cb_init(usart_buffer_ptr, USART_BUFFER_SIZE, sizeof(char)); 
```

是一个裸函数调用。把那个移到里面`main()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-27T18:07:18.780

您不能在全局范围内运行函数。它必须主要完成：

```
int main(int argc, char *argv[] {
cb_init(usart_buffer_ptr, USART_BUFFER_SIZE, sizeof(char));
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-27T18:07:51.807

问题是您正在尝试在文件级别执行方法。

```
cb_init(usart_buffer_ptr, USART_BUFFER_SIZE, sizeof(char)); 
```

C 语言只允许此级别的声明/定义，而不是实际执行的语句。此调用需要移至函数定义中。

# c++ - 如何在 Windows 中从我的 VS2008/C++ 应用程序中执行一个程序来替换调用者并在 xp/vista/7 上运行？

> ID：10355662
> 
> 赞同：0
> 
> 时间：2012-04-27T18:04:52.417
> 
> 标签：c++, visual-studio, winapi

我的应用程序从服务器下载更新。下载后运行 updater.exe（设置为以管理权限运行），因此它可以将更新 foo.exe 复制到我的应用程序上。由于您无法在运行帮助应用程序时替换文件，因此很有必要。

我正在执行以下系统调用来运行它： result=_execl(updaterexe,updaterstr,updateFilestr,exeFilestr,exeFilestr,NULL);

包含的参数：

c:\program files\foo\updater.exe "c:\program files\foo\updater.exe" "c:\downloads\newfoo.exe" ""c:\program files\foo\foo.exe"

在 vista 下，这按预期工作。在 Windows 7 下，它返回错误代码 22，这是无效参数。我也尝试引用第一个参数无济于事。怀疑 Windows 7 可能不支持旧的 _execl 我尝试调整所有参数并调用 _wexecl 但行为没有改变。

任何人都可以建议对我正在进行的调用进行更正，或者建议一个不同的系统调用，它可以在 Windows 版本之间一致地工作吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-27T18:31:54.003

还有很多其他替代方案，其中任何一个都可以从 Windows 95 开始工作：

*   CreateProcess() // 推荐的 Win32 API

*   外壳执行 ()

*   系统 （）

# jersey - WebApplicationException 怪异

> ID：10355667
> 
> 赞同：0
> 
> 时间：2012-04-27T18:05:00.227
> 
> 标签：jersey

我用 UnauthorizedException 扩展了 WebApplicationException：

```
public class UnauthorizedException extends WebApplicationException { 
```

我的 REST 类扩展了一个实现 authCheck 的基类，它是一个子类方法：

```
try{
  authCheck();
  RecordingList recordings = CODIRecording.getRecordings(type, timeframe);
  return Response.ok().entity(recordings).build();
}catch(WebApplicationException e){
  throw e; // Results in 500
  throw new UnauthorizedException(); // Results in 401
} 
```

当 authCheck 失败时，它会抛出 UnauthorizedException。如果子类方法没有 catch/try（异常只是从 authCheck 传播出去），或者如果它重新抛出异常，客户端会收到 500。

如果该方法的 catch 抛出一个*NEW* UnauthorizedException ，则客户端会按预期收到 401。

这是“正常”行为吗？这似乎很奇怪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T19:33:07.013

我猜你实际捕捉到的不是 UnauthorizedException，而是其他一些 WebApplicationException。你试过调试器吗？或者只是在 catch 子句中执行 e.printStackTrace() 来确定。

# mono - 在单声道中使用 System.Data.SqlConnection，第二次无效登录尝试导致“对象引用未设置为对象实例”

> ID：10355669
> 
> 赞同：2
> 
> 时间：2012-04-27T18:05:09.900
> 
> 标签：mono, sqlconnection, system.data

使用 Mono 的 System.Data.SqlConnection 尝试建立新连接（通过提示用户输入用户名和密码），如果用户多次输入错误的用户名，我得到一个异常：“对象引用未设置为对象的实例“当我在第二次尝试及以后调用 MyConnection.Open() 时。我应该得到一个更详细的异常消息，理想情况下类似于第一个错误响应，它说用户名/密码组合无效或某种程度。

这似乎是一个单声道错误，但我可能是错的。

一些相关细节： Ubuntu 12.04 LTS, 2.10.8.1 出现（来自 synaptic）是安装的 mono-devel 包的版本。

这是一些带有注释的代码，请记住，我从未声称它是好的代码：

```
protected void LoginClick (object sender, System.EventArgs e)
{
    SQLConn = "Data Source=<datasrc goes here>;Initial Catalog=<database name goes here>;User ID=" + UserText.Text + ";Password=" + PassText.Text +  ";MultipleActiveResultSets=True;";//the problem is not in the connection string; it logs in right with the right user/pass

MyConnection=null;
    try
    {
            MyConnection = new SqlConnection(SQLConn);
            ShowMessage("test1");   
            MyConnection.Open();
            ShowMessage("test2"); 
```

...还有更多，但除非我输入有效的用户/密码，否则它永远不会到达 test2 标记，它总是会到达 test1 标记.. ...

```
 }
catch (Exception ex)
    {
        if  (MyConnection!=null){
            MyConnection.Close();
        }
        ShowMessage("Error logging into Database: "+ex.Message);    
    } 
```

如果您需要了解调试 ShowMessage() 的外观，我将包括它：

```
public void ShowMessage(string Msg){
        Gtk.MessageDialog md=new Gtk.MessageDialog(this,DialogFlags.Modal,MessageType.Error,ButtonsType.Ok,Msg);
        md.Run();
        md.Destroy();
} 
```

这是我在这里的第一篇文章，如果我使用这个网站错误，请重定向我。

我的问题：我做错了什么，还是应该报告单一项目的错误？

# http - Google Analytics 如何知道 HTTPS 入站自然搜索流量的来源？

> ID：10355672
> 
> 赞同：2
> 
> 时间：2012-04-27T18:05:36.397
> 
> 标签：http, https, http-headers, google-analytics, search-engine

在 google 开始[为登录用户使用 https](http://googleblog.blogspot.com/2011/10/making-search-more-secure.html)之后，当用户通过 https 有机搜索进入网站时，Google Analytics 开始[显示“（未提供）”作为关键字。](http://analytics.blogspot.com/2011/10/making-search-more-secure-accessing.html)例如：![](../Images/051b7f772b35e4b118d26f0fc2566e0d.png)

鉴于当用户使用 HTTPS 时引荐来源不可用，谷歌分析如何能够判断 HTTPS 用户来自搜索引擎？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T19:02:12.903

Google 结果的目标是重定向到所需 URL 的中间页面，例如：

```
http://www.google.com/url?sa=t&rct=j&q=yahoo&esrc=s&source=web&cd=1&sqi=2&ved=0CDEQFjAA&url=http%3A%2F%2Fwww.yahoo.com%2F&ei=sOuaT6qMEaW80QWw8JjuDg&usg=AFQjCNG7Ba-stir4109vlLygPQX7QGf8bg 
```

当您将 Google 与 https 一起使用时，结果会定位到相同的 URL，但参数为空`q`：

```
http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&sqi=2&ved=0CDEQFjAA&url=http%3A%2F%2Fwww.yahoo.com%2F&ei=sOuaT6qMEaW80QWw8JjuDg&usg=AFQjCNG7Ba-stir4109vlLygPQX7QGf8bg 
```

所以有一个 http 引用者，但没有任何关键字信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:10:43.283

谷歌欺骗您认为您点击的目标是您在将鼠标悬停在链接上时看到的 URL（可能是通过使用 JavaScript 更改状态栏）。

如果您右键单击并复制链接（例如，取决于您的浏览器），您会看到您从 Google 搜索中单击的每个链接首先通过 Google 服务器，查询中包含各种参数，这可能会有所帮助它将它与您使用的搜索关键字联系起来。（尚不清楚这是否适用于其他搜索引擎。）

# google-maps-api-3 - Google Maps API v3 街道地址与城市，zip

> ID：10355674
> 
> 赞同：0
> 
> 时间：2012-04-27T18:05:48.627
> 
> 标签：google-maps-api-3

我正在使用 Google Maps API v3 距离。它适用于我数据库中的大多数地址。但是，似乎某些地址在 Google 地图中不可用，并且它似乎选择了最近的街道地址匹配，这可能是很遥远的。在这种情况下，我希望谷歌地图能够提供基于城市和邮政编码的答案。有没有人有办法解决吗？我曾想过通过地理编码在数学上进行双重检查，并检查雅虎地图（或其他网站）是否有一些偏离但会增加处理时间并且不是一个非常优雅的解决方案。必须有一些我缺少的设置或其他类似的工作。

谢谢！

顺便说一句，向新的 Json 序列化器大喊大叫！无论如何，这对我来说是新的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T06:00:16.763

您应该使用y 对象来确定返回的精度`location_type`。`geometr`我建议检查返回的结果是否表明结果是否不是`ROOFTOP`or `RANGE_INTERPOLATED`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:11:30.020

你如何格式化你发送的地址？

我使用 Google Maps API 进行了一些反向地理编码，如果找不到街道（由于拼写错误或您有什么），Google 将返回历史悠久的市中心的 lat lng。

我将地址结构化为 Country、city cityzip、street nr。

# objective-c - WebView 下载图片

> ID：10355676
> 
> 赞同：0
> 
> 时间：2012-04-27T18:05:53.840
> 
> 标签：objective-c, xcode, cocoa, webview

如果我有一个 WebView，并且我加载了一个带有图像的页面。如果我右键单击它并单击“下载图像”，菜单将被关闭，并且我看不到任何事情发生。

有人可以告诉我这是如何工作的吗？它是否将它保存在我不看的地方？

提前谢谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:26:57.193

它会保存到您的相机胶卷中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:50:15.353

如果这是一篇关于 OS X 中应用程序的帖子（不完全清楚），那么图像“应该”保存到用户下载文件夹中。

> /用户/用户名/下载

# matlab - 使用 matlab 在同一张图上绘制 3xN 矩阵（N 个 3D 点）

> ID：10355677
> 
> 赞同：1
> 
> 时间：2012-04-27T18:05:54.283
> 
> 标签：matlab, graph, 3d, plot

我有一个`3xN`矩阵在`W`哪里 `N``50`

`W(1,1)`是`x`点
`W(2,1)`的`y`坐标 是同一点
`W(3,1)`的`z`坐标 是同一点的坐标

同理：
`W(1,2)`是`x`另一点
`W(2,2)`的`y`坐标 是同一点
`W(3,2)`的`z`坐标 是同一点的坐标

……

现在我想使用 matlab 在同一个图形上 3d 绘制所有这些 3d 点。如何在同一个图中绘制所有这些点？

是否可以使用单个函数调用（在 matlab 中）绘制此矩阵？

我知道 plot3 可以使用，但一次只能用于一个图表。

所以`plot3(v(1,1),v(1,2),v(1,3));`只是一个点。但是我如何绘制所有 N 个点？

有没有更简单更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:09:59.380

我想你可以使用`plot3(w(1,:),w(2,:),w(3,:))`.

# php - Doctrine2 迁移使用 DBAL 而不是 $this->addSql

> ID：10355678
> 
> 赞同：15
> 
> 时间：2012-04-27T18:05:55.007
> 
> 标签：php, doctrine-orm, database-migration

所以我已经完成了一堆 Doctrine2 迁移（https://github.com/doctrine/migrations），但我有一个关于我正在尝试做的新迁移的问题。

我一直在深入研究这个库，我看到它`$this->addSql()`用于构建一个要执行的 SQL 列表，然后它会在以后执行。

我想做一些事情，我选择一些数据，遍历行，基于它插入新数据，然后删除我选择的数据。这很容易适用于 DBAL 库，但我想知道，我可以`protected $connection`在迁移中安全地使用它吗？还是因为它会在我的任何`$this->addSql()`SQL 被执行之前执行语句而变得糟糕？此外，这似乎会破坏`dry-run`我在代码中看到的设置。有没有人有过这种迁移的经验？有没有最佳实践？

以下是我想做的迁移，但我不确定 Doctrine Migrations 是否支持它：

```
public function up(Schema $schema)
{
    // this up() migration is autogenerated, please modify it to your needs
    $this->abortIf($this->connection->getDatabasePlatform()->getName() != "mysql");

    $this->addSql("ALTER TABLE article_enclosures ADD is_scrape TINYINT(1) NOT NULL");
    $this->addSql("ALTER TABLE images DROP FOREIGN KEY FK_E01FBE6AA536AAC7");

    // now lets take all images with a scrape and convert the scrape to an enclosure
    // 
    // Select all images where not scrape_id is null (join on article_image_scrape)
    // for each image:
    //     insert into article_enclosures
    //     update image set enclosure_id = new ID
    //     delete from article_image_scrape where id...
    //
    // insert into article_enclosures select article_image_scrapes...

    $sql = "SELECT i.id img_id, e.* FROM images i JOIN article_image_scrapes e ON i.scrape_id = e.id";
    $stmt = $this->connection->prepare($sql);
    $stmt->execute();
    $scrapesToDelete = array();
    while ($row = $stmt->fetch()) {
        $scrapeArticle = $row['article_id'];
        $scrapeOldId = $row['id'];
        $scrapeUrl = $row['url'];
        $scrapeExtension = $row['extension'];
        $scrapeUrlHash = $row['url_hash'];
        $imageId = $row['image_id'];

        $this->connection->insert('article_enclosures', array(
            'url' => $scrapeUrl,
            'extension' => $scrapeExtension,
            'url_hash' => $scrapeUrlHash
        ));

        $scrapeNewId = $this->connection->lastInsertId();

        $this->connection->update('images', array(
            'enclosure_id' => $scrapeNewId,
            'scrape_id' => null
        ), array(
            'id' => $imageId
        ));

        $scrapesToDelete[] = $scrapeOldId;
    }

    foreach ($scrapesToDelete as $id) {
        $this->connection->delete('article_image_scrapes', array('id' => $id));
    }

    $this->addSql("INSERT INTO article_scrapes (article_id, url, extension, url_hash) "
            ."SELECT s.id, s.url, s.extension, s.url_hash"
            ."FROM article_image_scrapes s");

    $this->addSql("DROP INDEX IDX_E01FBE6AA536AAC7 ON images");
    $this->addSql("ALTER TABLE images DROP scrape_id, CHANGE enclosure_id enclosure_id INT NOT NULL");
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-09-02T21:08:23.220

你可以使用`$connection`这样的

```
$result = $this->connection->fetchAssoc('SELECT id, name FROM table1 WHERE id = 1');
$this->abortIf(!$result, 'row with id not found');
$this->abortIf($result['name'] != 'jo', 'id 1 is not jo');
// etc.. 
```

您应该只读取数据库而不是使用连接来进行更新/删除，这样它就不会破坏空运行选项。

在您的示例中，您应该进行两次迁移。第一个会做两个alter table。第二个将执行“带有刮擦的图像并将刮擦转换为外壳”例程。如果出现问题，使用多次迁移更容易恢复它们。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-05-12T18:30:58.070

仅供参考，最新的文档显示了这个例子，使用“postUp”方法更好

[http://symfony.com/doc/current/bundles/DoctrineMigrationsBundle/index.html](http://symfony.com/doc/current/bundles/DoctrineMigrationsBundle/index.html)

```
// ...
use Symfony\Component\DependencyInjection\ContainerAwareInterface;
use Symfony\Component\DependencyInjection\ContainerInterface;

class Version20130326212938 extends AbstractMigration implements ContainerAwareInterface
{

    private $container;

    public function setContainer(ContainerInterface $container = null)
    {
        $this->container = $container;
    }

    public function up(Schema $schema)
    {
        // ... migration content
    }

    public function postUp(Schema $schema)
    {
        $em = $this->container->get('doctrine.orm.entity_manager');
        // ... update the entities
    }
} 
```

# javascript - 使用纯 JavaScript 切换

> ID：10355683
> 
> 赞同：0
> 
> 时间：2012-04-27T18:06:14.600
> 
> 标签：javascript

```
<script>
function toggleMenu() {
    var thisMenu = document.getElementById(id).getElementsByTagName('ul')[0];
    if( thisMenu.style.display == 'block' ) {
        thisMenu.style.display = 'none';
    } else { 
        thisMenu.style.display = 'block';
    }
    return thisMenu;
}

<li class="NavLinks test2" id="menuItem">
    <a onclick="toggleMenu('menuItem');">Tutorial</a>
    <ul>
        <li><a href="http://www.google.com">google</a></li>     
        <li><a href="http://www.yahoo.com">yahoo</a></li>
    </ul>
</li>

</script> 
```

*********描述****** ** *** ** *** *****

 **onClick on Tutorial hide 是子菜单项，但是如果我单击 Tutorial 并将鼠标悬停在子菜单项上并将鼠标悬停在项目列表项不隐藏。如果我的代码需要修改，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:08:28.427

你还没有定义`id`论点。

改变

```
function toggleMenu(){ 
```

至

```
function toggleMenu(id){ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:09:01.690

目前，您的`toggleMenu`函数不接受任何参数。您的 html 也在您的脚本标签内

```
<script>
function toggleMenu( id ){
  var thisMenu = document.getElementById(id).getElementsByTagName('ul')[0];
  if( thisMenu.style.display == 'block' ) {
    thisMenu.style.display = 'none';
  }
  else {
    thisMenu.style.display = 'block';
  }
  return thisMenu ;
}
</script>
<li class="NavLinks test2" id="menuIteam">
<a onclick="toggleMenu('menuIteam');">Tutorial</a>
<ul>
<li><a href="http://www.google.com">google</a></li>     
<li><a href="http://www.yahoo.com">yahoo</a></li>
</ul>
</li> 
```**

# grep - HUP父子进程的脚本

> ID：10355687
> 
> 赞同：1
> 
> 时间：2012-04-27T18:06:26.793
> 
> 标签：grep, freebsd, kill, pid, nohup

我需要一个 shell 脚本来向父进程和子进程发送 HUP。

我正在使用带有 tcsh 的 freeBSD？#/bin/sh

不知何故，我需要将 pgrep 的 PID 输出通过管道在 shell 脚本的循环中杀死 -HUP。

最终，我想将此脚本作为 cron 作业运行。

我只是还没有技能。

谢谢 - 布拉德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T20:26:28.107

（这不是一个完整的答案，但我显然不能在没有至少 50 名声望的情况下发表评论）。

首先，FreeBSD 上的 /bin/sh 是与 Boune 兼容的 shell，而不是 tcsh（即 /bin/tcsh）。开始将类似于以下内容：

```
#!/bin/sh
for pid in $(pgrep <process name>); do kill -HUP $pid; done 
```

没有更多细节，我真的不能说更多。

# python - 文本文件中的列表

> ID：10355691
> 
> 赞同：-1
> 
> 时间：2012-04-27T18:06:39.623
> 
> 标签：python, file, list, text, count

我需要你的帮助。

我有一个包含多行列表的文本文件，每行代表一个项目列表。我需要提取所有频率 >=2 的项目并将它们输出到另一个文件中。这里是一个例子。

```
['COLG-CAD-406', 'CSAL-CAD-030', 'COLG-CAD-533', 'COLG-CAD-188']

['COLG-CAD-188']

['CSAL-CAD-030']

['EPHAG-JAE-004']

['COLG-CAD-188', 'CEM-SEV-004']

['COL-CAD-188', 'COLG-CAD-406'] 
```

输出应该是

```
['COLG-CAD-406'], 2

['CSAL-CAD-030'], 2

['COLG-CAD-188'], 3 
```

依此类推，直到文件结束

非常感谢您提前提供的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:20:38.293

关于什么：

```
for x in f.readlines():
    words = ast.literal_eval(x)
    count = {}
    for w in words:        
        count[w] = count.get(w, 0) + 1
    for word, freq in count.iteritems():
        if freq >= 2:
            print word, freq 
```

`f`你的文件在哪里

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T14:03:46.777

Input:

```
['COLG-CAD-406', 'CSAL-CAD-030', 'COLG-CAD-533', 'COLG-CAD-188']

['COLG-CAD-188']

['CSAL-CAD-030']

['EPHAG-JAE-004']

['COLG-CAD-188', 'CEM-SEV-004']

['COL-CAD-188', 'COLG-CAD-406'] 
```

Output

```
>>> from collections import Counter
>>> from ast import literal_eval
>>> with open('input.txt') as f:
        c = Counter(word for line in f if line.strip() for word in literal_eval(line))

>>> print '\n'.join('{0}, {1}'.format([word],freq) for word,freq in c.iteritems() if freq >= 2)
['CSAL-CAD-030'], 2
['COLG-CAD-406'], 2
['COLG-CAD-188'], 3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:50:48.583

如果您使用的是 python 2.7 及更高版本，请使用此输入（称为`list1.txt`）：

```
['COLG-CAD-406', 'CSAL-CAD-030', 'COLG-CAD-533', 'COLG-CAD-188']
['COLG-CAD-188']
['CSAL-CAD-030']
['EPHAG-JAE-004']
['COLG-CAD-188', 'CEM-SEV-004']
['COLG-CAD-188', 'COLG-CAD-406'] 
```

这个python程序：

```
from collections import Counter
import ast

cnt = Counter()

with open("list1.txt") as lfile:
    for line in lfile:
        # eval() could lead to python code injection so use literal_eval
        # the result is a list that we can directly use to update cnt keys
        cnt.update(ast.literal_eval(line))

for k, v in iter(cnt.items()):
    if v>=2:
        print("%s: %d"%  (k, v)) 
```

你得到你想要的：

```
CSAL-CAD-030: 2
COLG-CAD-406: 2
COLG-CAD-188: 4 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T19:13:58.697

这是一个完整的脚本，它使用正则表达式*完全*满足您的要求：

```
from collections import defaultdict
import re

myarch = 'C:/code/test5.txt'   #this is your archive
mydict = defaultdict(int)

with open(myarch) as f:
    for line in f:
        codes = re.findall("\'(\S*)\'", line)
        for key in codes:
            mydict[key] +=1

out = []
for key, value in mydict.iteritems():
    if value > 1:
        text = "['%s'], %s" % (key, value)
        out.append(text)

#save to a file
with open('C:/code/fileout.txt', 'w') as fo:
    fo.write('\n'.join(out)) 
```

这可以简化为：

```
from collections import defaultdict
import re

myarch = 'C:/code/test5.txt'
mydict = defaultdict(int)

with open(myarch) as f:
    for line in f:
        for key in re.findall("\'(\S*)\'", line):
            mydict[key] +=1

out = ["['%s'], %s" % (key, value) for key, value in mydict.iteritems() if value > 1]

#save to a file
with open('C:/code/fileout.txt', 'w') as fo:
    fo.write('\n'.join(out)) 
```

# sql-server-2005 - SQL查询，将SELECT的结果存储在局部变量中

> ID：10355694
> 
> 赞同：77
> 
> 时间：2012-04-27T18:07:07.143
> 
> 标签：sql-server-2005

我创建了一个查询，其中一些结果被重用。我搜索了一种将结果放入变量并使用它的方法。

一种简单的方法来查看我想要的东西看起来像这样 - 我想要这个：

```
DECLARE @result1 ?????

SET @result1 = SELECT a,b,c FROM table1
SELECT a AS val FROM @result1
UNION
SELECT b AS val FROM @result1
UNION
SELECT c AS val FROM @result1 
```

不是这个 ：

```
 SELECT a AS val FROM (SELECT a,b,c FROM table1)
 UNION
 SELECT b AS val FROM (SELECT a,b,c FROM table1)
 UNION
 SELECT c AS val FROM (SELECT a,b,c FROM table1) 
```

我关心的不是这个查询的结果，而是：

1.  停止多次选择结果 - 在我的示例中，我重新选择了表格 3 次

2.  的查询`@result1`通常要复杂得多。因此，使用变量，代码会更清晰。

也许我想要很多 - 或者有一种局部变量。或者使用类型表并在里面设置数据。

你有什么建议？

谢谢

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-04-27T18:11:06.307

您可以创建表变量：

```
DECLARE @result1 TABLE (a INT, b INT, c INT)

INSERT INTO @result1
SELECT a, b, c
FROM table1

SELECT a AS val FROM @result1
UNION
SELECT b AS val FROM @result1
UNION
SELECT c AS val FROM @result1 
```

这应该可以满足您的需要。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-27T19:24:06.413

以下是您可以采取的其他一些方法。

**1\. 带工会的 CTE：**

```
;WITH cte AS (SELECT a, b, c FROM table1)
SELECT a AS val FROM cte
UNION SELECT b AS val FROM cte
UNION SELECT c AS val FROM cte; 
```

**2\. 带 unpivot 的 CTE：**

```
;WITH cte AS (SELECT a, b, c FROM table1)
SELECT DISTINCT val
FROM cte
UNPIVOT (val FOR col IN (a, b, c)) u; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-04-26T16:40:42.953

当然，如果我正确理解了这个问题，这不是一个更简单的解决方案。

我想将名为“垃圾邮件”的表中的电子邮件地址加载到变量中。

```
select email from spam 
```

产生以下列表，例如：

```
.accountant
.bid
.buiilldanything.com
.club
.cn
.cricket
.date
.download
.eu 
```

加载到变量@list：

```
declare @list as varchar(8000)
set @list += @list (select email from spam) 
```

@list 现在可以插入到表中，等等。

我希望这有帮助。

要将其用于 .csv 文件或在 VB 中，请使用以下代码：

```
declare @list as varchar(8000)
set @list += @list (select '"'+email+',"' from spam)
print @list 
```

它会生成现成的代码以在其他地方使用：

```
".accountant,"
".bid,"
".buiilldanything.com,"
".club,"
".cn,"
".cricket,"
".date,"
".download,"
".eu," 
```

一个人可以很有创意。

谢谢

尼科

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-11-27T20:50:36.540

我带着类似的问题/问题来到这里，但我只需要从查询中存储一个值，而不是原始帖子中的结果数组/表。我能够将上面的表格方法用于单个值，但是我偶然发现了一种更简单的方法来存储单个值。

`declare @myVal int; set @myVal = isnull((select a from table1), 0);`

确保将 isnull 语句中的值默认为变量的有效类型，在我的示例中，我们存储的 table1 中的值是 int。

# api - 移动 HTML5 应用程序如何使用 OAuth 2 协议？

> ID：10355699
> 
> 赞同：2
> 
> 时间：2012-04-27T18:07:36.167
> 
> 标签：api, mobile, cordova, oauth

我正在使用 PhoneGap 创建一个带有 HTML、CSS 和 JS 的移动应用程序。

我需要实现某种身份验证来连接到我的 API - 我认为 OAuth 1 或 OAuth 2 应该可以很好地解决这个问题。

但是，使用 OAuth 1，我需要将消费者机密存储在我的 JS 中，这会将其暴露给任何有脑子的人。

使用 OAuth 2，我可以通过完全不使用一个秘密来避免暴露秘密，而只需提供一个预先在 API 提供者注册的重定向 URL。这保证了用户只被发送回正确的 URL（他们不能被劫持）。

但是，使用 PhoneGap，我无法真正提供重定向 url，因为 PhoneGap url 类似于 file://www/index.html...

如何将 Oauth 1 或 OAuth 2 与移动 HTML5 应用程序一起使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T19:26:48.877

Libby 有一个关于如何使用 PhoneGap 进行 OAuth 1 的很好的教程：

[http://www.mobiledevelopersolutions.com/home/start/twominutetutorials/tmt5p1](http://www.mobiledevelopersolutions.com/home/start/twominutetutorials/tmt5p1)

至于您的消费者秘密，您可以将其存储在本机代码中，然后使用插件从 JavaScript 的本机端检索它。已经有一个可用于 iOS 的称为[Keychain](https://github.com/phonegap/phonegap-plugins/tree/master/iPhone/Keychain)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-01T20:44:07.057

对于这个主题的新手，英特尔开发者专区还有一个[关于使用 OAuth2 和 PhoneGap/Cordova 的教程](https://software.intel.com/en-us/xdk/article/oauth2-with-intelxdk-cordova-html5)。为避免在应用程序中使用客户端密码，您将使用 OAuth2 隐式流程。从上面的链接

> 以下是在 Cordova* HTML5 应用程序中执行 Oauth2 隐式授权流程所涉及的步骤：
> 
> 1.  在 Cordova InAppBrowser 中打开 Oauth2 授权页面
> 2.  使用 loadstart 事件侦听器从重定向的 URL 哈希片段中获取 access_token

# android - 从局域网中的任何设备连接到在 VMWare 上运行的 apache Web 服务器

> ID：10355702
> 
> 赞同：1
> 
> 时间：2012-04-27T18:07:39.730
> 
> 标签：android, networking, vmware

我正在使用 Ubuntu（**在 Windows 7 上的 VMWare**上）运行 Apache Web 服务器。我正在尝试从我的 android 设备（使用 local-ip）浏览到这个 web 服务器（不用说 android 设备正在连接到 Ubuntu 和 windows 7 的同一个无线 LAN）但还没有成功。当我从 Windows 7 浏览到该 Web 服务器时，它成功了。

我已阅读有关转发代理的信息，但我想知道这是否是解决此问题的最佳解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:30:08.003

查看您的 VMWare 虚拟机的 IP 地址。可能有一个由 VMWare 创建的虚拟 LAN，这就是您的 Windows 机器可以连接到 VM 的方式。

最简单的解决方案是设置端口转发，然后将例如 Windows 机器上的端口 8888 转发到 VM 的 IP 地址（端口 80，如果您的 apache 配置为使用默认端口）。看看例如这个：[http ://www.quantumg.net/portforward.php](http://www.quantumg.net/portforward.php)

# django - 允许在 ModelAdmin 上进一步覆盖 save_formset

> ID：10355703
> 
> 赞同：7
> 
> 时间：2012-04-27T18:07:42.460
> 
> 标签：django, django-forms, django-admin

这里非常基本的使用场景。我想保存创建对象的用户和最后修改它的用户。但是，它是一个内联模型，所以我当然需要使用`save_formset`. Django 文档有以下示例代码：

```
class ArticleAdmin(admin.ModelAdmin):
    def save_formset(self, request, form, formset, change):
        instances = formset.save(commit=False)
        for instance in instances:
            instance.user = request.user
            instance.save()
        formset.save_m2m() 
```

问题是，如果你注意到，因为`super`从来没有被调用，这是一个死胡同。如果`ModelAdmin`是子类并且此方法以相同的方式被覆盖，您将失去父级中固有的功能。这很重要，因为这是一个常见的使用场景，我想将功能分解出来，所以我创建了以下内容：

```
class TrackableInlineAdminMixin(admin.ModelAdmin):
    def save_formset(self, request, form, formset, change):
        instances = formset.save(commit=False)
        for instance in instances:
            if hasattr(instance, 'created_by') and hasattr(instance, 'modified_by'):
                if not instance.pk:
                    instance.created_by = request.user
                instance.modified_by = request.user
            instance.save()
        formset.save_m2m()
        super(TrackableInlineAdminMixin, self).save_formset(request, form, formset, change) 
```

`super`出于习惯，我比其他任何事情都更倾向于呼吁，没想到它实际上会导致表单集保存两次。尽管如此，它仍然适用于所有场景，除了一个：删除。一旦您尝试在管理员中删除内联，您就会收到错误消息。该错误非常模糊，与我在这里的问题并不真正相关，但我相信它与您刚刚删除其中一个实例后尝试再次保存表单集有关。当调用`super`被删除时，代码工作得很好。

总而言之，我是否缺少任何方法来自定义表单集保存行为*并*允许子类进行自己的覆盖？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T01:26:11.970

这是一个doozie。

我玩得很开心，似乎所有的动作都发生在这里`django.forms.models.BaseModelFormSet`。

问题是`ModelFormSet.save()`无论标志如何都会删除实例，`commit`并且不会修改表单以反映已删除状态。

如果`save()`再次调用，它会遍历表单并在`ModelChoiceField`清理中尝试提取引用的 ID 并引发无效选择错误。

```
def save_existing_objects(self, commit=True):
    self.changed_objects = []
    self.deleted_objects = []
    if not self.initial_forms:
        return []

    saved_instances = []
    for form in self.initial_forms:
        pk_name = self._pk_field.name
        raw_pk_value = form._raw_value(pk_name)

        # clean() for different types of PK fields can sometimes return
        # the model instance, and sometimes the PK. Handle either.
        pk_value = form.fields[pk_name].clean(raw_pk_value) 
        pk_value = getattr(pk_value, 'pk', pk_value)

        obj = self._existing_object(pk_value)
        if self.can_delete and self._should_delete_form(form):
            self.deleted_objects.append(obj)
            obj.delete()  
            # problem here causes `clean` 6 lines up to fail next round

            # patched line here for future save()
            # to not attempt a second delete
            self.forms.remove(form) 
```

我能够解决此问题的唯一方法是修补`BaseModelFormset.save_existing_objects`以在删除对象时删除表单`self.forms`。

做了一些测试，似乎没有任何不良影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-17T17:15:08.947

@Chris Pratt 帮助：

> 出于习惯，我对 super 的调用比其他任何事情都多，没想到它实际上会导致表单集保存两次。

我试图进一步覆盖 a`save_formset`以发送保存后信号。我只是无法理解调用`super()`只是第二次保存表单集。

为了解决这个`super()`问题，我用我的自定义代码创建了一个方法，当我通过孩子`save_formset_now`覆盖时我会调用它。`save_formset``admin.ModelAdmin`

这是代码，它似乎也处理了删除问题，在 2016 年使用 Django 1.10。

```
class BaseMixinAdmin(object):
    def save_formset_now(self, request, form, formset, change):
        instances = formset.save(commit=False)
        for obj in formset.deleted_objects:
            obj.delete()
        for instance in instances:
            # *** Start Coding for Custom Needs ***
                ....
            # *** End Coding for Custom Needs ***
            instance.save()
        formset.save_m2m()

class BaseAdmin(BaseMixinAdmin, admin.ModelAdmin):
    def save_formset(self, request, form, formset, change):
        self.save_formset_now(request, form, formset, change)

class ChildAdmin(BaseAdmin):
    def save_formset(self, request, form, formset, change):
        self.save_formset_now(request, form, formset, change)
        my_signal.send(...) 
```

# javascript - 如何创建动态加载的页面 URL？

> ID：10355704
> 
> 赞同：3
> 
> 时间：2012-04-27T18:07:43.377
> 
> 标签：javascript, jquery, ajax

我注意到许多网站都使用此 AJAX 加载的 URL 结构“#！”，例如 twitter: (https://twitter.com/#!/apolinariosteps)，但我找不到它的文档（我不知道该怎么做搜索）

我不确定这是否是解决方案（但我仍然想知道如何做到这一点），我想要的是当我使用 Jquery 加载一些内容时，这会导致 URL 以某种方式发生更改，因此我可以与具体内容加载链接。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:27:42.477

无需重新加载的 URL 更改通过[浏览器历史对象](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history)原生存在于较新的浏览器中，并且可以使用[balupton 的 history.js](https://github.com/balupton/history.js/)轻松填充。基本语法将是`history.pushState(stateObject, title, URL)`.

# java - 并发编程更网格化还是集群化？

> ID：10355705
> 
> 赞同：1
> 
> 时间：2012-04-27T18:07:48.797
> 
> 标签：java, multithreading, concurrency

我试图将我的大脑围绕并行/并发编程（在 Java 中）并被挂在我一直在阅读的任何教程中似乎没有涵盖的一些基础知识上。

当我们谈论“多线程”或“并行/并发编程”时，这是否意味着我们正在处理一个大问题并将其分散到多个线程上，或者我们是否首先明确地将其分解为更小的子问题，然后通过每个子问题都有自己的线程？

例如，假设我们有`EndWorldHungerTask implements Runnable`，并且任务完成了一些巨大的问题。为了完成它的目标，它必须做一些非常繁重的工作，比如一亿次：

```
public class EndWorldHungerTask implements Runnable {

    public void run() {
        for(int i = 0; i < 100000000; i++)
            someReallyExpensiveOperation();
    }
} 
```

为了使这个“并发”或“多线程”，我们是否会将其传递`EndWorldHungerTask`给 100 个工作线程（JVM 告诉 100 个工作线程中的每一个何时处于活动状态并在下一次迭代/`someReallyExpensiveOperation()`调用中工作)，还是我们会手动/显式地重构它，以便 100 个工作人员中的每一个都在循环/待完成工作的不同部分进行迭代？在这两种情况下，100 名工人中的每一个都只迭代了一百万次。

但是，在第一个范例下，Java 告诉每个线程何时执行。第二种情况下，开发者需要提前手动（在代码中）划分问题，并将每个子问题分配给一个新的线程。

我想我在问它在 Java 领域是如何“正常完成”的。而且，不仅针对这个问题，而且总体而言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:15:05.137

> 我想我在问它在 Java 领域是如何“正常完成”的。而且，不仅针对这个问题，而且总体而言。

这高度依赖于手头的任务。

Java 中的标准范例是您必须自己将工作拆分成块。将这些块分布到多个线程/核心是一个单独的问题，并且存在多种模式（队列、线程池等）。

有趣的是，存在可以自动利用多个内核`for`并行执行循环之类的框架（例如，[OpenMP](http://supercomputingblog.com/openmp/tutorial-parallel-for-loops-with-openmp/)）。但是，我不知道有任何此类 Java 框架。

最后，可能是完成大部分工作的低级库可以使用多个内核。在这种情况下，更高级别的代码可能能够保持单线程并且仍然受益于多核硬件。一个例子可能是在幕后使用[MKL](http://software.intel.com/en-us/articles/intel-mkl/)的数字代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:15:06.520

> 当我们谈论“多线程”或“并行/并发编程”时，这是否意味着我们正在处理一个大问题并将其分散到多个线程上，或者我们是否首先明确地将其分解为更小的子问题，然后通过每个子问题都有自己的线程？

我认为这在很大程度上取决于问题。有时，您需要使用相同的代码调用 1000 次或数百万次相同的任务。这是`ExecutorSerivce.submit()`模式的类型。您有来自文件的数百万行，并且您在每一行上运行一些处理方法。我想这是您的“将其传播到多个线程”类型的问题。这适用于简单的线程模型。

但在其他情况下，问题空间由大量非同质任务组成。有时你可能会产生一个线程来处理一些后台保持活动，而有时你可能会在这里和那里产生一个线程池来处理一些工作队列。通常，问题的范围越大，并发模型越复杂，使用的池和线程类型就越多。我想这是您的“将其分解为较小的子问题”类型。

> 为了使这个“并发”或“多线程”，我们是否会将这个 EndWorldHungerTask 传递给 100 个工作线程（其中 100 个工作线程中的每一个都由 JVM 告知何时处于活动状态并在下一次迭代中工作/ someReallyExpensiveOperation() 调用），还是我们会手动/显式地重构它，以便 100 个工作人员中的每一个都在循环/待完成工作的不同部分上进行迭代？在这两种情况下，100 名工人中的每一个都只迭代了一百万次。

就您而言，我看不出您如何使用一组线程代码来解决世界饥饿问题（使用您的类比）。我认为您必须“将其分解为较小的子问题”，这对应于我上面解释的后一种情况：运行不同代码的整个线程系列。一些子解决方案可以在线程池中完成，而一些子解决方案将使用单独的线程完成，每个线程运行单独的代码。

> 我想我在问它在 Java 领域是如何“正常完成”的。而且，不仅针对这个问题，而且总体而言。

“通常”在很大程度上取决于问题及其复杂性。根据我的经验，我通常会`ExecutorService`尽可能多地使用这些构造。但是对于任何体面的问题，您会发现自己有许多不同的线程池、Spring 计时器线程、自定义一次性线程任务、生产者/消费者模型等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:14:50.940

通常，您希望每个线程从头到尾执行一个任务形式，将任务完成一半，然后停止该线程上的执行并“调用”另一个线程来完成工作，您将一无所获。Java当然为这种线程同步提供了工具，但是当一个任务依赖于另一个任务来完成时，它们确实被使用了——而不是让另一个线程可以完成任务。

大多数时候你会遇到一个大问题，它由几个任务组成，如果这些任务可以同时执行，那么产生线程来执行这些任务是有意义的。与创建线程相关的开销，因此如果所有任务都是顺序的并且必须等待另一个完成，那么产生多个线程根本没有好处，只产生一个线程，这样你就不会阻塞主线程.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T20:19:04.360

“多线程”<>“并行/并发编程”。

编写多线程应用程序通常是为了利用抢占式多任务程序的高 I/O 性能。一个例子可能是网络爬虫/下载器。即使在只有一个 CPU 内核的机器上运行时，多线程爬虫通常也会比单线程版本好很多。DNS查询获取站点地址，连接到站点，下载页面，将其写入磁盘文件的操作都是需要很少CPU但需要大量IO等待的操作。因此，许多这些不可避免的等待可以由许多线程并行执行。当 DNS 查询进入、HTTP 客户端连接或磁盘操作完成时，请求它的线程已准备好/正在运行，并且可以继续进行下一个操作。

出于这个原因，绝大多数应用程序主要是编写为多线程的。这就是为什么我在上面写这篇文章的盒子有 98 个进程（其中 94 个有多个线程）、1360 个线程和 3% 的 CPU 使用率——这与将 CPU 工作拆分为核心无关——主要是关于 IO表现。

并行/并发编程实际上可以使用多个 CPU 内核进行。对于那些具有 CPU 密集型工作的应用程序，可以将其分解为较大的包以跨内核分发，可以小心地使用接近内核数量的加速因子。

自然会有一些溢出——I/O 绑定的网络爬虫往往会在具有更多内核的机器上表现更好，这仅仅是因为中断/驱动程序开销对整体性能的影响较小，但它不会好很多。

如果他们都在等待庄稼生长，那么您有多少工人可用于 EndWorldHunger 任务并不重要。

# scp - 只允许 scp 没有 shell

> ID：10355712
> 
> 赞同：2
> 
> 时间：2012-04-27T18:08:18.103
> 
> 标签：scp, sshd

我可以使用 /etc/ssh/sshd_config 来制作它，以便用户只能将文件 scp 到服务器但打开 shell。我尝试使用以下命令，但连接已关闭。

匹配用户网站 X11Forwarding no AllowTcpForwarding no ForceCommand scp

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T16:00:01.940

您需要将用户的 shell 设置为 rssh - [http://www.pizzashack.org/rssh/](http://www.pizzashack.org/rssh/)。这个 shell 只允许执行 sftp/scp 请求。

# solr - 搜索字符串类型字段时面临问题

> ID：10355713
> 
> 赞同：1
> 
> 时间：2012-04-27T18:08:20.393
> 
> 标签：solr, solrj

我在 Solr 搜索中遇到问题。我的架构如下

```
<fieldType name="c_text" class="solr.TextField">
<analyzer type="index">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
</analyzer>
<analyzer type="query">
    <tokenizer class="solr.WhitespaceTokenizerFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
</analyzer>
</fieldType>
<field name="parentId" type="string" indexed="true" stored="true"/>
<field name="data_s" type="c_text" indexed="true" stored="true"/>
<field name="email" type="string" indexed="true" stored="true"/>
<field name="receivedDate" type="tdate" indexed="true" stored="true"/> 
```

我正在搜索电子邮件字段。其中包含以下格式的数据
Tarun Nagpal <tarunn@abc.com>

```
//This is working fine
email:*tarun* 
```

但是以下没有结果

```
email:"Tarun Nagpal" 
```

你能帮忙吗，为什么它不像在电子邮件字段上搜索那样搜索短语。在 data_s 字段上搜索工作正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T10:17:43.160

您需要使用文本字段类型，因为您打算搜索标记：

具体来说`Tarun Nagpal <tarunn@abc.com>`：

字符串**字段**将回答`==`等式和通配符查询，例如`*un Nagp*`，`*unn@abc.com>`甚至更明显的外来查询。

**文本**字段将回答标记`tarun`、`nagpal`和。`tarunn` `abc``com`

其他实现 N-gram 和 Soundex 的字段类型甚至可以更正您的拼写。

* * *

请参阅优秀的[ht​​tps://stackoverflow.com/a/2119479/604511](https://stackoverflow.com/a/2119479/604511)

# iphone - iPhone如何使用NSPredicate按父实体过滤Core Data？

> ID：10355716
> 
> 赞同：1
> 
> 时间：2012-04-27T18:08:26.893
> 
> 标签：iphone, objective-c, ios, core-data, nspredicate

我的核心数据是这样定义的：用户有很多事件；事件具有单一的用户关系；

用户和事件都是核心数据实体。用户实体通过情节提要 segue 传入。

我正在尝试配置 NSPredicate 以仅使用该特定用户的事件填充该用户的详细 UITableView。

到目前为止我已经尝试过

```
//does not work
 NSPredicate* onlyThisUserPredicate = [NSPredicate predicateWithFormat:@"user == %@",self.appUser];

//does not work
 NSPredicate* onlyThisUserPredicate = [NSPredicate predicateWithFormat:@"SELF.user == %@",self.appUser]; 
```

**比较事件并仅返回用户对象等于指定用户对象的事件的正确语法是什么？**

更新：

我正在尝试使用这种获取的结果控制器向用户添加事件：

```
-(NSFetchedResultsController*)fetchedResultsController
{
    if (__fetchedResultsController != nil) {
        return __fetchedResultsController;
    }

    // Set up the fetched results controller.
    // Create the fetch request for the entity.
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    // Edit the entity name as appropriate.
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Event" inManagedObjectContext:[Event managedObjectContext]];
    [fetchRequest setEntity:entity];

    // Set the batch size to a suitable number.
    [fetchRequest setFetchBatchSize:20];

//I need to configure this user
    NSPredicate* onlyThisUserPredicate = [NSPredicate predicateWithFormat:@"user = %@",self.appUser];

    // The first sort key must match the section name key path key if present, otherwise the initial dataset would be messed up: rows in incorrect sections

    NSString* firstSortKey = @"createDate";
    NSSortDescriptor *firstSortDescriptor = [[NSSortDescriptor alloc] initWithKey:firstSortKey ascending:YES];
    NSArray *sortDescriptors = [NSArray arrayWithObjects:firstSortDescriptor, nil];

    [fetchRequest setSortDescriptors:sortDescriptors];
    [fetchRequest setPredicate:onlyThisUserPredicate];

    // Edit the section name key path and cache name if appropriate.
    // nil for section name key path means "no sections".
    NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:[Event managedObjectContext] sectionNameKeyPath:nil cacheName:@"Events"];
    self.fetchedResultsController = aFetchedResultsController;
    aFetchedResultsController.delegate = self;

    //    [aFetchedResultsController release];
    [sortDescriptors release];
    [fetchRequest release];

    NSError *error = nil;
    if (![__fetchedResultsController performFetch:&error]) {
        /*
         Replace this implementation with code to handle the error appropriately.

         abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. 
         */
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        //      abort();
    }

    return __fetchedResultsController;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:28:47.017

那么这个谓词对于用户实体是否正确？如果是这样，您是否尝试过：

```
NSPredicate* onlyThisUserPredicate = [NSPredicate predicateWithFormat:@"SELF == %@",self.appUser]; 
```

然后您可以通过以下方式访问您的活动：

```
[self.appUser events]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:56:49.233

好的，我能想到的有几件事可能会导致这种行为。

首先，您是否在此函数中验证了 self.appUser 的值？它设置为您的期望吗？

其次，您是否确保您的标头都是最新的并包含在此文件中？有时，当我的标头未与 coredata 模型保持同步时，我会遇到奇怪的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:21:38.757

如果您已经从 Core Data 存储中检索了“用户”，那么您应该能够通过遵循该关系来访问其事件——无需执行单独的获取请求：

```
NSSet *events = self.appUser.events; 
```

另一方面，如果`self.appUser`不是托管对象，那么`==`在谓词中使用运算符可能是问题所在。所以让我假设这`self.appUser`只是一个包含用户名的字符串，而不是数据存储中的用户对象。然后你会在你的谓词中使用'like'运算符：

```
NSPredicate* onlyThisUserPredicate = [NSPredicate predicateWithFormat:@"user like %@",self.appUser]; 
```

此外，请确保您在获取请求中指定了正确的实体。对于您所描述的内容，您应该使用事件实体的实体描述进行提取。

# sql - 如何使用来自 HTTP FORM 的值列表执行类似于“NOT IN”的 WHERE？

> ID：10355719
> 
> 赞同：0
> 
> 时间：2012-04-27T18:08:38.717
> 
> 标签：sql, sql-server, forms

我有一个用 C# 开发的 Web 应用程序，其中一个页面显示 SQL 查询的输出；查询是对存储过程的 linq 调用，我使用的是 SQL Server 2008。

其中一列显示与结果行关联的标签；在同一页面上显示复选框列表，每个复选框对应一个标签，如果用户打开或关闭一个或多个复选框，我想过滤查询。

我最简单的 SQL 解决方案对我们来说是“NOT IN”，如下所示：

```
select * from [mytable] where [tags] not in ('tag1','tag2, etc...) 
```

鉴于我将 FORM POST 转换为带有逗号分隔值的字符串。例子：

```
string tags = ParseFormAndConvertCheckBoxToCSV(Page.Request.Form);
string sqlcmd = "select * from [mytable] where [tags] not in (" + tags + ")"; 
```

但我不想动态构建 SQL，因为据我所知[那会很糟糕](http://www.sommarskog.se/dynamic_sql.html)。

我可以想象几种[在 SQL 中用逗号分隔的值列表拆分字符串并将值存储到内存表中的](https://stackoverflow.com/questions/878833/passing-a-varchar-full-of-comma-delimited-values-to-a-sql-server-in-function)方法：

```
declare @tagscsv nvarchar(MAX)
declare @notags TABLE(Value nvarchar(50))

set @tagscsv = 'taxi,ivf'

Declare @x XML 
select @x = cast('<A>'+ replace(@tagscsv,',','</A><A>')+ '</A>' as xml)

insert into @notags
select t.value('.', 'nvarchar(50)') as v from @x.nodes('/A') as x(t)

select * from [mytable] where [tags] not in (select * from @notags) 
```

...但这听起来也像是一个肮脏的把戏。

对我来说，这看起来应该是一个非常普遍的情况，我发现很多人过去都面临过这个问题，但是在谷歌上搜索我找不到一个优雅的解决方案。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T19:05:59.890

**编辑**：错过了存储过程部分。使用存储过程，您没有很多选择。我通常会做你所做的，拆分逗号分隔的字符串并将值保存到临时表（或表变量）中。

```
CREATE PROCEDURE SplitAndStuff
    @List nvarchar(MAX) = NULL,
    @SplitOn nvarchar(5) = ','  --This can be replaced with a literal if it is always a comma.
AS
BEGIN
    DECLARE @Pos int;
    DECLARE @SplitOnLength int;
    DECLARE @Results TABLE (value nvarchar(MAX))
    SET @SplitOnLength = DATALENGTH(@SplitOn) / 2;

    IF (RIGHT(@List, @SplitOnLength) <> @SplitOn) SET @List = @List + @SplitOn; --Add trailling split string if there is not one already.

    SET @Pos = CHARINDEX(@SplitOn, @List, 1)                                    --Initalize for loop.  (The starting position returned is 1-based, not 0-based.)

    WHILE @Pos > 0
    BEGIN
        INSERT INTO @Results (value) SELECT CAST(SUBSTRING(@List,1,@Pos-1)AS int);

        SET @List = SUBSTRING(@List, @Pos+@SplitOnLength, DATALENGTH(@List) / 2);
        SET @Pos = CHARINDEX(@SplitOn, @List, 1);
    END
END
GO 
```

如果您的存储过程没有做任何其他事情（除了查找），您可以在下面使用我原来的 LINQ 答案：

由于您使用的是 LINQ，因此您需要拆分`tagscsv`并使用结果数组来执行“在哪里”查询：

```
string[] tags = tagscsv.Split(',');
var output = from q in db.Table where !tags.Contains(q) select q; 
```

也可以看看：

*   [http://msdn.microsoft.com/en-us/library/ms132407.aspx](http://msdn.microsoft.com/en-us/library/ms132407.aspx)
*   [使用 LINQ 执行“WHERE IN (Value1,Value2)”查询](http://weblogs.asp.net/dwahlin/archive/2008/05/09/using-linq-to-perform-quot-where-in-value1-value2-quot-queries.aspx)
*   [LINQ to SQL 中的 NOT IN 子句](http://introducinglinq.com/blogs/marcorusso/archive/2008/01/14/the-not-in-clause-in-linq-to-sql.aspx)

# jquery - slides.js slides_control 的高度为 0，幻灯片放映不工作

> ID：10355726
> 
> 赞同：0
> 
> 时间：2012-04-27T18:09:22.343
> 
> 标签：jquery, jquery-plugins, slideshow

我正在尝试在新 shoify 网站的主页上使用 slides.js 实现幻灯片放映，

[http://naturallog.myshopify.com/](http://naturallog.myshopify.com/)

如您所见，图像正在加载到页面，但 div#slides_control 的高度为零并且幻灯片放映不工作。我在 firebug 和 jquery 中看不到任何 js 错误，并且 slides.js 也正在加载到页面中。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T15:55:36.590

插件需要更新 NVM jquery 版本

# c++ - 在 Rails 中使用 Ruby 扩展时要考虑什么？

> ID：10355727
> 
> 赞同：1
> 
> 时间：2012-04-27T18:09:22.680
> 
> 标签：c++, ruby, ruby-on-rails-3

我想为 Ruby 制作一个 C++ 扩展（使用外部库，即 stdlib 和 OpenCV），然后将其引入 Rails 项目。我应该做些什么来使它与 Rails 兼容，或者更好的是，是否有一个 Rails 框架可以让编写扩展（尤其是 C++）更容易？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T13:51:25.253

无论 Rails 是什么，您都可以使用 C 扩展创建 gem。

我建议您观看 RailsCast 以了解如何创建 gem：

[http://railscasts.com/episodes/245-new-gem-with-bundler](http://railscasts.com/episodes/245-new-gem-with-bundler)

并从那里查看 RubyGems 教程，了解如何添加 C 扩展

[http://guides.rubygems.org/c-extensions/](http://guides.rubygems.org/c-extensions/)

我从未做过 C++ 扩展，但 EventMachine 是用 C++ 构建的

[https://github.com/eventmachine/eventmachine](https://github.com/eventmachine/eventmachine)

# jquery - 在非 ajax 页面上使用 ajaxComplete？

> ID：10355728
> 
> 赞同：0
> 
> 时间：2012-04-27T18:09:23.943
> 
> 标签：jquery

祝福大家，

我使用 jQuery 的 ajaxComplete 来确保在执行我的函数之前完成所有 ajax 调用。如果之前有 ajax 调用，它工作得很好。但是，如果页面上没有 ajax 调用，我自己的函数就不会被执行。

我的问题是如何执行以下操作？

1）如果页面上有ajax调用，使用ajaxComplete确保所有内容都先加载完毕。

2）如果没有ajax调用，函数仍然执行。

有人可以阐明这个问题吗？任何帮助，将不胜感激，

迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:16:17.670

如果要确保首先加载所有内容，可以使用：

```
$(document).ready(function(){ ... }) 
```

# javascript - 从孩子更改窗口父 url 不更改完整 url

> ID：10355731
> 
> 赞同：3
> 
> 时间：2012-04-27T18:09:49.990
> 
> 标签：javascript

从我的子窗口我试图刷新父窗口。我尝试了几个 js 函数刷新或更改父窗口 url，但它们都没有给我我需要的东西。

```
alert(window.opener.location.href);  //gave null

//all the functions bellow changed the url to 
// http://mydomain/www.google.com
window.opener.location.assign("www.google.com");
window.opener.location.replace("www.google.com");
window.opener.location.href = "www.google.com";
window.opener.location = "www.google.com"; 
```

我也尝试过`parent.location.href`但没有更改父网址。

有没有办法可以将父网址设置为所需的网址？或者只是让它刷新页面？有什么想法吗？

**编辑** 我不能发布示例代码，因为我在做什么有点复杂。我正在使用一个调用新窗口（asp.net 页面）的 salesforce 按钮。除了 .aspx 页面之外，我对该页面没有太多访问权限。它是我们购买的项目的编译版本。在 .aspx 页面中，我尝试调用 js 函数，因为我无权访问该页面背后的代码。一旦用户按下任一（是或否），我的 js 函数应该刷新父页面。

```
<cc1:ImageButton ID="btnNo" runat="server" OnClick="btnNo_Click" 
OnClientClick="pop()" Text="No" Width="40px" />

<script type="text/javascript" language="JavaScript">
    function pop(){

            window.opener.location.reload(true);
          //window.opener.location.href = "www.google.com";

    }

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:11:32.453

这应该有效：

```
window.opener.location.reload(false); 
```

**编辑**

根据您的评论，听起来您违反了[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)。

# c# - 如果转换为 null，为什么 Convert.ToString(null) 会返回不同的值？

> ID：10355736
> 
> 赞同：120
> 
> 时间：2012-04-27T18:10:18.350
> 
> 标签：c#, .net

```
Convert.ToString(null) 
```

返回

```
null 
```

正如我所料。

但

```
Convert.ToString(null as object) 
```

返回

```
"" 
```

为什么这些不同？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2012-04-27T18:13:16.030

`ToString`这里有 2 个重载

```
Convert.ToString(object o);
Convert.ToString(string s); 
```

C# 编译器本质上试图选择最具体的重载，它将与输入一起工作。值`null`可以转换为任何引用类型。在这种情况下`string`比更具体`object`，因此它将被选为获胜者。

在`null as object`您已将表达式的类型固化为`object`. 这意味着它不再与`string`重载兼容，并且编译器会选择`object`重载，因为它是唯一剩下的兼容的。

C# 语言规范的第 7.4.3 节介绍了这种打破平局如何工作的真正令人毛骨悚然的细节。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2012-04-27T18:30:33.323

继[JaredPar 出色的重载解决方案](https://stackoverflow.com/a/10355772/2199)答案之后 - 问题仍然是“为什么`Convert.ToString(string)`返回 null，但`Convert.ToString(object)`返回`string.Empty`”？

答案是......因为[文档是](http://msdn.microsoft.com/en-us/library/astxcyeh.aspx)[这样](http://msdn.microsoft.com/en-us/library/1a2xyyx8.aspx)说的：

> Convert.ToString(string) 返回“指定的字符串实例；不执行实际转换。”
> 
> Convert.ToString(object) 返回“value 的字符串表示形式，如果 value 为 null，则返回 String.Empty”。

编辑：至于这是否是“规范中的错误”、“非常糟糕的 API 设计”、“为什么要这样指定”等 - 我会试一试为什么我看不到的理由这很重要。

1.  `System.Convert`具有将每种基本类型转换为*自身*的方法。这很奇怪——因为不需要或不可能进行转换，所以这些方法最终只返回参数。`Convert.ToString(string)`行为相同。我认为这些是用于代码生成场景的。
2.  `Convert.ToString(object)`通过时有3个选择`null`。抛出、返回 null 或返回 string.Empty。投掷会很糟糕-假设这些用于生成的代码，情况会更加糟糕。返回 null 需要您的调用者进行 null 检查 - 同样，这在生成的代码中不是一个很好的选择。返回 string.Empty 似乎是一个合理的选择。其余`System.Convert`处理值类型 - 具有默认值。
3.  返回 null 是否更“正确”值得商榷，但 string.Empty 肯定更有用。改变`Convert.ToString(string)`意味着打破“没有实际转换”的规则。由于`System.Convert`是静态实用程序类，因此每个方法都可以在逻辑上视为自己的方法。在现实世界中，这种行为应该“令人惊讶”的场景很少，所以让可用性战胜（可能的）正确性。

# jquery - 在动态地图容器中加载谷歌地图？

> ID：10355740
> 
> 赞同：1
> 
> 时间：2012-04-27T18:10:34.607
> 
> 标签：jquery, ajax, google-maps-api-3

我试图在动态地图容器中加载谷歌地图，但我无法得到它......

**过程：** 我单击一个按钮，它对 show.php 进行 ajax 调用，我想在从 show.php 加载的 div 中显示谷歌地图

**.js 文件：**

```
var id = $(this).attr('rel');
var coords = jQuery(this).attr('coords');
jQuery.ajax({
                type: "POST",
                url: "show",
                data: "sec=load_shop&id=" + id,
                success: function(msg){
                    jQuery("#" + id).html(msg);
ini_map(coords, id);
                },
                error: function(msg){
                    console.log(msg.statusText);
                }
            }); 
```

**ini_map 函数：**

```
function ini_map(coords, id_shop) {
      var lat_lon = coords.split(",");

       var myOptions = {
                zoom: 15,
                center: new google.maps.LatLng(lat_lon[0],lat_lon[1]),
                disableDefaultUI: true,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };

       var map = new google.maps.Map(document.getElementById('map_' + id_shop), myOptions);

       var infowindow = new google.maps.InfoWindow();

       var marker = new google.maps.Marker({
                position: map.getCenter(),
                map: map,
                title: 'Dirección'
            });

        google.maps.event.addListener(marker, 'click', function() {
                infowindow.setContent("<strong>OKAY!</strong>");
                infowindow.open(map, this);
        });

   } 
```

**显示.php**

```
$id = $_POST['id'];
echo '<div id="map_'.$id.'" class="gmaps"></div>'; 
```

我用萤火虫检查了 php 输出是好的，ej.:

```
<div id="map_20" class="gmaps"></div> 
```

但我得到这个错误：

```
TypeError: 'null' is not an object (evaluating 'a[gb]') 
```

我认为谷歌地图 api 找不到地图容器。

知道怎么做吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T09:56:36.787

我解决了它：

[https://developers.google.com/maps/documentation/javascript/basics?hl=es-ES#Async](https://developers.google.com/maps/documentation/javascript/basics?hl=es-ES#Async)

# c# - ExtJS 表单：链接的组合框

> ID：10355745
> 
> 赞同：0
> 
> 时间：2012-04-27T18:10:51.483
> 
> 标签：c#, javascript, json, extjs, coolite

我有一个带有一堆下拉列表作为过滤器的页面。假设我有一个租金过滤器：类型（公寓、房屋等...）、附近（海洋、山脉、河流、火车、摩天大楼...）、城市（纽约、洛杉矶、迈阿密、芝加哥）。 ..) 等等......每个过滤器都会进行回发并重新计算其他过滤器。例如，如果选择：靠近山脉并看到迈阿密没有山脉，因此迈阿密和其他城市不会在城市过滤器中......到目前为止等等......

我只是将此页面作为 iFrame 插入到其他页面中......但真的很难看。想要使用其中的一些 ExtJs 对象来帮助我。有很多网格面板的例子，但没有这样的......请给我一些建议或例子，这会很好。谢谢。

* * *

更多细节：

我找到了一些开始：[http](http://examples.ext.net/#/Form/ComboBox/Ajax_Linked_Combos/) ://examples.ext.net/#/Form/ComboBox/Ajax_Linked_Combos/ 或版本 1：[http](http://examples1.ext.net/#/Form/ComboBox/Ajax_Linked_Combos/) ://examples1.ext.net/#/Form/ComboBox/Ajax_Linked_Combos/ 这是一个好例子。但是在我将代码移动到它自己的自定义用户控件之后，请求会命中主页的 on-Load 方法和用户控件以及页面的其他生命周期方法，而不仅仅是 CitiesRefresh() 方法。 ..我不想要那种行为，所以我改用代理`<ext:HttpProxy Url="mypage.aspx" Method="POST" />`...

但我没有选定的值，如何发送？也许使用`ExtraParams`，但我不确定。

另一件事是多个下拉菜单。所以我想我可以用 ddltarget 回复一个项目列表......比如：

```
data.Add(new { Id = id, Name = name, dllTarget= "Cities" });

<Fields>
    <ext:RecordField Name="id" Type="String" Mapping="Id" />
    <ext:RecordField Name="name" Type="String" Mapping="Name" />
    <ext:RecordField Name="ddlTarget" Type="String" Mapping="ddlTarget" />
</Fields> 
```

但是怎么读？？？当“城市”设置为它时使用 ddlTarget。？？？？

```
<Load Handler="#{Cities}.setValue(#{Cities}.store.getAt(0).get('id'));" /> // doesn't care ddlTarget 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T15:07:35.067

需要为每个 Combobox 创建一个存储，并为所有将使用 Json 进行 POST 调用并检索数据的所有存储创建一个全局存储。我检索的数据是一组集合值：如下所示：

```
class dataJson{
    public List<ItemClass> CollectionType {get; set;}
    public List<ItemClass> CollectionNearBy {get; set;}
    public List<ItemClass> CollectionCity {get; set;}
} 
```

当数据返回时，只需按要求更新组合框的存储：（Load 是全局存储的侦听器）

```
<Load Handler=" #{TypeComboBox}.clearValue(); 
#{TypeComboBox}.loadData(this.reader.jsonData);
#{NearByComboBox}.clearValue(); 
#{NearByComboBox}.loadData(this.reader.jsonData);
#{CityComboBox}.clearValue(); 
#{CityComboBox}.loadData(this.reader.jsonData);" /> 
```

每个 ComboBox 应该通过 > 的属性过滤`Root`数据`ext:Store`，例如`Reader`应该是`Root``NearByComboBox store``"CollectionNearBy"`

# java - 为什么此代码适用于此 TopCoder 问题？

> ID：10355746
> 
> 赞同：6
> 
> 时间：2012-04-27T18:10:54.883
> 
> 标签：java, algorithm, huffman-code

从 HOURS 开始，我一直在尝试思考这个 TopCoder 问题，但无法提供完美的解决方案，并发现下面给出的解决方案使用得非常漂亮！

我试图弄清楚这个解决方案如何适用于给定的问题？而我当初怎么会想到呢？在阅读了解决方案后，我认为它是霍夫曼编码的一种变体，但这是我所能得到的。我真的很着迷，想知道什么样的思路可以导致这个解决方案..

这是问题所在：http: [//community.topcoder.com/stat ?c=problem_statement&pm=11860&rd=15091](http://community.topcoder.com/stat?c=problem_statement&pm=11860&rd=15091)

> Fox Ciel 有很多功课要做。作业由一些相互独立的任务组成。不同的任务可能需要不同的时间来完成。您将获得一个 int[] workCost。对于每个 i，第 i 个任务需要 workCost[i] 秒才能完成。她想参加一个聚会和认识她的朋友，因此她想尽快完成所有任务。
> 
> 主要的问题是，包括夏尔在内的所有狐狸都非常讨厌做作业。每只狐狸只愿意做其中一项任务。幸运的是，来自 22 世纪的机器猫哆啦A梦给了 Fox Ciel 一把分裂锤：一个可以将任何狐狸分成两只狐狸的魔法小工具。
> 
> 你得到一个 int splitCost。在狐狸身上使用劈锤是瞬间的。一旦在狐狸身上使用锤子，狐狸就会开始分裂。splitCost 秒后，她会变成两只狐狸——原来的狐狸和另一只全新的狐狸。狐狸在劈叉时，不能再用锤子打她。
> 
> 一项任务的工作不能被打断：一旦狐狸开始执行一项任务，她就必须完成它。不允许多只狐狸在同一任务上合作。狐狸在使用锤子被劈开时无法完成任务。可以多次拆分同一只狐狸。在狐狸完成其中一项任务之前和之后都可以分裂狐狸。
> 
> 计算并返回狐狸可以解决所有任务的最短时间。

这是我在此[链接上找到的解决方案](http://community.topcoder.com/stat?c=problem_solution&rm=312431&rd=15091&pm=11860&cr=23056191)

```
import java.util.*; 

public class FoxAndDoraemon { 
  public int minTime(int[] workCost, int splitCost) { 
    PriorityQueue<Integer> pq = new PriorityQueue<Integer>(); 

    for(int i : workCost) pq.offer(i); 

    while(pq.size()>=2) { 
      int i = pq.poll(); 
      int j = pq.poll(); 
      pq.offer(Math.max(i, j) + splitCost); 
    } 
    return pq.poll(); 

  } 
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T18:47:22.713

首先，您确实意识到“max(i, j) + splitCost”背后的原因。不是吗？基本上，如果您有一只狐狸，您可以将其分成两部分并独立执行每项任务。让我们称这个过程为“合并”。

现在假设我们有三个工作 a、b 和 c，使得 a>b>c。您可以执行合并（合并（a，b），c）或合并（合并（a，c），b）或合并（合并（b，c），a）。做数学，你可以证明 merge(merge(b,c),a) 在这三个中最少。

您现在可以使用归纳法来证明此解决方案适用于任意数量的工作（不仅仅是 3 个）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-27T19:11:12.393

它正在从头开始建造一棵树。

该算法使用一个基本事实来工作：如果删除两个最小元素，则计算最小元素的成本始终小于下一个最小元素的成本加上拆分。（请参阅 ElKamina 的帖子以获得更彻底的证明）。

因此，如果您的树中只有两个元素（例如 4 和 2）并且您的拆分成本为 4，那么最短的时间始终是 8（下一个最小的元素加上拆分成本。

所以，要构建我们的树：假设我们得到了 workCost [1,3,4,5,7,8,9,10]，我们的 splitCost 是 3。

所以，我们看两个最小的元素：1,3。计算这些的“成本”至少为 6（最大数字加上拆分的成本。然后将 6 重新插入队列中，您实际上是在添加子树：

```
 6
1   3 
```

其中“高度”/“成本”总共为 6。通过重复此过程，您将使用尽可能小的子元素（现有的子树或未完成的新作业）构建一棵树。

解决方案最终将如下所示：（其中 S(X) 是拆分成本加上解决它下面的所有问题）

```
 S(17)
            S(13)       S(14)
       S(10)     9   10      S(11)
  S(6)      7            S(8)     8
1     3                 4    5 
```

如果你向后追溯这棵树，很容易看出公式是如何解决它的：1 和 3 的成本是 S(6)，4 和 5 是 S(8)，然后 S(6) 和 7 是 S(10) ), 8 和 S(8) 是 S(11) 等。

# javascript - onclick 事件 - 为什么 Javascript 在加载时运行它

> ID：10355747
> 
> 赞同：2
> 
> 时间：2012-04-27T18:10:59.180
> 
> 标签：javascript, function, onclick, dom-events

```
<p id="specialp">some content</p>
<script>
document.getElementById('specialp').onclick=alert('clicked');
</script> 
```

我刚开始使用 Javascript，我不明白为什么在页面加载时会执行警报，但在我单击该段落时不会。

当我将它内联时，处理程序按我预期的方式工作，如下所示：

```
<p id="specialp" onclick="alert('clicked')" >some content</p> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T18:16:40.783

这是因为您没有将分配包装`onclick`为实际函数，因此它尝试将结果分配给`alert('clicked')`onclick 事件处理程序（这意味着它可能`undefined`在分配时）。您需要做的是为该处理程序分配一个函数，如下所示：

```
document.getElementById('specialp').onclick = function()
{
    alert('clicked');
}; 
```

当你在 HTML 中做同样的事情时，DOM 会自动为你将内容包装在一个函数中。

# ms-access - 通过coldfusion从单选按钮插入MS访问数据库

> ID：10355748
> 
> 赞同：0
> 
> 时间：2012-04-27T18:11:02.670
> 
> 标签：ms-access, coldfusion, radio-button

我正在尝试将单选按钮中的值插入数据库。下面是我的js代码：

```
 for (i = 0; i < document.form.repnumber.value; i++)
    {
            newInnerHTML = newInnerHTML +'Name: <input type=\"text\" name=\"rep' +(i+1) +'\" value=\"\" size=\"50\">*<br> ';
            newInnerHTML = newInnerHTML +'Email:<input type=\"text\" name=\"rep' +(i+1) +'\email" value=\"\" size=\"60\"><br> ';
            newInnerHTML = newInnerHTML +'UI Alum? <input type=\"checkbox\" name=\"rep' +(i+1) +'\alumn" value=\"alumn\" ><br> ';
            newInnerHTML = newInnerHTML +'<b>Break-Out Sessions</b>: *<br>';
            newInnerHTML = newInnerHTML +'New Recruiters <input type=\"radio\" name=\"rep' +(i+1) +'\sessions" value=\"1\" checked=\"checked\"><br>';
            newInnerHTML = newInnerHTML +'Seasoned Recruiters <input type=\"radio\" name=\"rep' +(i+1) +'\sessions" value=\"2\"><br>';
            newInnerHTML = newInnerHTML +'Community Partners <input type=\"radio\" name=\"rep' +(i+1) +'\sessions" value=\"3\"><br><br>';
    } 
```

而对于动作页面，代码就像

```
insert  into tablename(rep1sessions ...) values (#rep1sessions#...) 
```

但是现在，在我的数据库中，“会话”列仅显示数字/文本的 0 或 -1，选中/取消选中是/否。我的目标只是在列中显示 1,2,3 三个不同的值。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T19:15:44.770

我建议您需要考虑您的数据库结构。

您绝对不想将逗号分隔的列表存储在任何数据库的列中。您也不希望列名采用“mycolumnx”形式，其中 x 是一个数字。

就您如何处理这样的动态表单字段而言，它真的非常容易。所有变量都在结构中。这包括诸如 form 和 url 之类的范围。

结构及其键可以作为关联数组访问。这意味着 form.rep1session 可以作为 form["rep1session"] 进行访问。推断这一点，您可以在循环中访问表单变量，用变量替换数字，例如。形式[“代表”&我&“会话”]

之后，您只需将值存储在适当的关系数据库结构中。

# text - 文本挖掘 MS Word 文档？

> ID：10355751
> 
> 赞同：-2
> 
> 时间：2012-04-27T18:11:15.300
> 
> 标签：text, ms-word, data-mining, text-mining

我有大约 30 个 .docx 文档（简历），其中包含有关人员姓名、技能等的数据。我需要使用其中的一些信息填充电子表格，并且为了减少手动工作，我认为我可以使用文本挖掘方法。

是否有任何工具或方法可用于从这些文档中挖掘（某种半结构化）信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T05:14:00.987

您可以尝试使用`catdoc` [http://www.wagner.pp.ru/~vitus/software/catdoc/](http://www.wagner.pp.ru/~vitus/software/catdoc/)工具，该工具将从 MS Word 文件中提取文本内容，然后执行您想要的任何文本处理。我可能只是`grep`因为简历中存在某些单词而不是 catdoc 的输出。过度设计解决方案毫无意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:22:48.937

我能想到的最好的方法是使用 perl，因为我知道您可以[从 word 文档中提取](https://stackoverflow.com/questions/1124676/how-can-i-extract-data-in-a-word-document-using-perl)（尽管这本身可能很棘手）并使用 perl 模块[填充 xml 电子表格。](http://www.ibm.com/developerworks/linux/library/l-pexcel/)

好久没生气写perl了，所以我不能提供怎么做的例子，但是如果我把一些东西放在一起做这个，我会推荐perl。我相信有人会说在 python 中，甚至在 Ruby 中也有等价的函数，但是我使用的是 perl，而且我发现它对于操作/匹配/解析/处理文本非常有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-09T17:12:50.713

在 docx 或 doc 中有多种读取 word 文件的方法，docx 文件只是一个花哨的容器。但是 doc 文件很难提取。

我会告诉你一些从word中提取文本的方法

1.  .doc/docx >> open with open suit >> 使用 python 的用户 pyUNO 并获取您的数据。
2.  .doc/docx >> 使用 python .docx 模块和 Textract 和提取数据。
3.  .doc/docx >> 使用 R 编程，其中有许多模块，如officer 和 ReporterRS >> 提取数据。
4.  使用文本挖掘将文本从一种形式转换为另一种形式。

# php - 在 adLDAP 中对用户进行身份验证时，结果是“用户身份验证不成功”

> ID：10355752
> 
> 赞同：0
> 
> 时间：2012-04-27T18:11:20.393
> 
> 标签：php, authentication, active-directory

**信息：**我正在尝试验证和 adLDAP

**问题：** adLDAP 告诉我“用户身份验证失败”

**问题：**当没有错误告诉我如何处理此问题时，我如何找出我需要做的事情。

**搜索/尝试：**

1.  [http://adldap.sourceforge.net/faq.php](http://adldap.sourceforge.net/faq.php)
2.  stackoverflow.com/questions/2465260/using-adldap-php-class-but-getting-error-when-looking-for-group-user-belongs-to
3.  adldap.sourceforge.net/wiki/doku.php?id=documentation_examples#authenticating_a_user
4.  [http://phreek.org/blog/2011/12/enable-php-ldap-module-in-xampp](http://phreek.org/blog/2011/12/enable-php-ldap-module-in-xampp)

**代码：**

```
require_once(dirname(__FILE__) . '/adLDAP.php');
$adldap = new adLDAP();

$username = "user";
// $username = "domain\user"; // I have also tried
$password = "pass";

$authUser = $adldap->authenticate($username, $password);
if ($authUser == true) {
  echo "User authenticated successfully";
}
else {
  echo "User authentication unsuccessful";
}

echo('<hr />');

$result=$adldap->user_info("jboyle");
print_r($result); 
```

**HTML 输出：**

```
User authentication unsuccessful

Fatal error: Call to undefined method adLDAP::user_info() in C:\xampp\htdocs\adLDAP\compare.php on line 18 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T13:30:11.617

**代替：**

```
echo "User authentication unsuccessful"; 
```

和

```
echo "Username '{$username}' login failed: ".$adldap->getLastError(); 
```

**结果：**

```
Username 'user' login failed: Can't contact LDAP server 
```

**信息/来源：**

[https://sourceforge.net/projects/adldap/forums/forum/358759/topic/1719128?message=4368835](https://sourceforge.net/projects/adldap/forums/forum/358759/topic/1719128?message=4368835) http://adldap.sourceforge.net/wiki/doku.php?id=ldap_over_ssl#tell_apache_how_to_use_ldaps

执行 phpinfo() 并检查 HOME 变量在 Apache 环境中指向的位置。创建符号链接或将 ldap.conf 复制到此位置。

如果您收到连接错误，可能是因为您的本地 OpenSSL 安装无法识别服务器提供的证书（或其授权）。这可以通过在您的服务器或类似服务器上的 ldap.conf 中添加以下行来规避：

将 TLS_REQCERT 允许更改为 TLS_REQCERT 从不

Apache 必须能够读取 ldap.conf，您不能跳过此步骤。

# jquery - 数据表 + jquery UI 按钮

> ID：10355755
> 
> 赞同：0
> 
> 时间：2012-04-27T18:11:27.257
> 
> 标签：jquery, jquery-ui, datatables

我正在使用数据表（如在 Datatables.net 中）并自己对其进行格式化。为了使分页按钮看起来不错，我正在这样做：

```
$(function(){
    $('#data').dataTable({
        "fnDrawCallback" : function() {
            $('#data_next').button();
            $('#data_previous').button();
        }           
    });
} ); 
```

问题是，虽然 fnDrawCallback 事件在页面更改时被触发，但 .button() 调用似乎是在 Datatable 完成 DOM 之前发生的。看起来内部仍然有 Button 类，但它本身已将它们删除。

我认为 fnDrawCallback 发生*在*Datatable 完成绘图之后，但显然不是。

建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T18:37:24.660

您应该阅读文档，您的答案就在那里：

[http://datatables.net/styling/custom_classes](http://datatables.net/styling/custom_classes)

要考虑的另一件事是 DataTable 作为完整的 Jquery UI 集成：

[http://datatables.net/examples/basic_init/themes.html](http://datatables.net/examples/basic_init/themes.html)

**有了这个初始化：**

```
$(document).ready(function() {
  oTable = $('#example').dataTable({
    "bJQueryUI": true,
    "sPaginationType": "full_numbers"
  });
}); 
```

*您只需要设置您喜欢的主题并对 css 进行任何更改即可。*

* * *

**更进一步，**查看 Jquery UI ThemeRoller 支持的 dataTable 演示：http: [//datatables.net/styling/themes/redmond](http://datatables.net/styling/themes/redmond)

# java - 缓存实现

> ID：10355756
> 
> 赞同：1
> 
> 时间：2012-04-27T18:11:27.437
> 
> 标签：java, caching, ehcache, distributed-caching

我已经研究了一个星期，但我想对我的特殊情况有一些想法......

2台物理服务器：

*   服务器 A - 公共 WAR，管理 WAR

*   服务器 B - 公共 WAR

要求：

*   两个 WAR 都需要查看相同的数据。

*   管理员 WAR 修改/添加数据到缓存。

*   公共 WAR 修改缓存的其他部分/向其中添加数据。

*   整个缓存需要驻留在每个物理服务器的内存中（如果我在服务器 A 管理 WAR 或公共 WAR 上添加一些内容，它需要显示在服务器 B 的公共 WAR 上）所以如果发生故障，我们不会等待要填充的缓存的一半

*   1,500 个活跃用户/服务器，绝大多数流量被读取，很少写入

额外的硬件是不可能的。

是否有适合这种情况的第三方缓存解决方案？似乎大多数分布式缓存系统都希望将一半的数据留在服务器 A 上，一半留在服务器 B 上，这无法满足我们的故障转移性能需求。

感谢您的任何想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:14:58.823

[http://www.gigaspaces.com/](http://www.gigaspaces.com/)有一个解决方案，它允许您创建“空间”作为复制模式下的缓存，因此每个节点都将拥有数据的精确副本。

他们还提供故障转移或热备用解决方案。

编辑：Gigaspace 不仅仅是一个共享缓存，但您可以只使用缓存解决方案。它被称为内存数据网格。他们极大地改变了他们的网页，所以我找不到确切的页面。但是，如果您搜索文档，您会找到它。

您可以从这里开始 [http://www.gigaspaces.com/datagrid](http://www.gigaspaces.com/datagrid)

但这项技术不是免费的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:18:51.937

你应该看看[Redis](http://redis.io/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:20:00.810

> 似乎大多数分布式缓存系统都希望将一半的数据留在服务器 A 上，一半留在服务器 B 上，这无法满足我们的故障转移性能需求。

不，您可以轻松调整它。否则，您需要粘性看见（您必须确切地知道，哪个缓存存储您的数据）。您可以选择市场上的任何解决方案 EhCache、GigaSpace、GridGain 等。我建议使用 JBoss Cache，恕我直言，最简单且正是您所需要的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T18:16:53.703

查看[EhCache 的复制选项](http://ehcache.org/documentation/replication)。

听起来您一直在搜索有关“分布式缓存”的信息，它的定义与“复制缓存”不同。分布式缓存是一个更大的缓存系统，分布在许多机器中，因此集群中任何一台机器的丢失都不会导致整个缓存下降，而只是一部分。在这种情况下，缓存的总大小可以达到（机器数量乘以每台机器的内存）。

在复制缓存中，缓存的数据在每台机器上复制，将您的总缓存大小限制为最大（任何一台机器的内存）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-27T18:24:34.670

这个领域有很多解决方案。

*   [内存缓存](http://memcached.org/)
*   [缓存](http://ehcache.org/)
*   [英菲尼斯潘](http://www.jboss.org/infinispan.html)

它们都可以配置为分布式缓存。AFAIK Infinispan 在 JBoss AS 中留下嵌入式缓存时效果最佳，最后我检查了它很难集成到其他应用程序服务器中。如果你有钱，我会推荐Terracotta 的[BigMemory](http://terracotta.org/products/bigmemory)。它是 EhCache 的商业衍生产品，并提供了许多额外的好功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-27T18:35:38.093

我们使用[Apache Commons JCS](http://commons.apache.org/jcs/)并且对它非常满意。它声称[几乎是 EHCache 的两倍](http://commons.apache.org/jcs/faq.html#jcs-vs-ehcache)。对于您所描述的情况，您可能会配置一个[横向 TCP 缓存](http://commons.apache.org/jcs/LateralTCPAuxCache.html)。

# sql - SQL 为嵌套选择创建别名列？

> ID：10355761
> 
> 赞同：6
> 
> 时间：2012-04-27T18:11:47.383
> 
> 标签：sql, database, ms-access

假设我有一张`Person`桌子和一张`Courses`桌子。在`Person`表中我有列`PersonName`。在表中，`Courses`假设我有`CourseTitle`和。是 1-4（4 是最难的）。我如何从每个人那里返回一个人员列表，每个人都有一个列显示他们正在上的最难的课程。`PersonName``CourseDifficulty``CourseDifficulty``Person``CourseTitle`

据我所知，通过执行以下操作，我将获得 Brett 上最难的课程的 CourseTitle：

```
SELECT CourseTitle 
FROM Courses 
WHERE PersonName = 'Brett' 
  AND CourseDifficulty = (SELECT MAX(CourseDifficulty) 
                          FROM Courses 
                          WHERE PersonName='Brett') 
```

但是我如何为 Person 表中的每个人运行它呢？我希望结果类似于

```
Brett-SQL For Dummies 4
Tim-Quantum Mechanics
Jane-Thermodynamics 2 
```

对不起noobness。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T18:40:32.477

你可以使用以下

```
SELECT p.name ,p.address, c.courseTitle ,c.courseDifficulty FROM (
        SELECT personName, courseTitle, MAX(courseDifficulty) AS courseDifficulty
        FROM course
        GROUP BY personName 
) AS c RIGHT JOIN person AS p ON p.name = c.personName 
```

这里我假设 personName 是唯一的。否则，您可以在此处使用唯一 ID 而不是人名，并在选择语句中添加此字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:17:26.200

尝试这个：

```
SELECT c.CourseTitle, c.PersonName, c.CourseDifficulty
  FROM Courses c
 WHERE c.CourseDifficulty=(SELECT MAX(c2.CourseDifficulty) FROM Courses c2 WHERE c2.PersonName=c.PersonName) 
```

# java - 从无状态 Bean 返回有状态 Java Bean？

> ID：10355765
> 
> 赞同：1
> 
> 时间：2012-04-27T18:12:36.687
> 
> 标签：java, jakarta-ee, ejb, javabeans

我想按如下方式处理登录场景：

1.  客户端连接到无状态 Java Bean (SLJB) 并尝试登录；
2.  如果登录成功，SLJB 会向用户返回一个 Stateful Java Bean (SFJB)，以便客户端可以继续使用应用程序。

我目前正在做第二步：

```
return new StatefulBean(some params); 
```

这是正确的方法吗？在我得到例外时，这似乎不是：

```
Class org.eclipse.persistence.internal.jpa.EntityManagerImpl is not Serializable 
```

运行我的应用程序时，我认为它与所描述的方法有关。

从 SLJB 向客户端返回对 SFJB 的引用的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T18:24:14.250

首先，这是完全错误的：

```
new StatefulBean(some params) 
```

EJB 容器负责创建和销毁 bean 的实例，您永远不应该手动创建它们。

在您的场景中，我将反转流程：客户端连接到有状态 bean，它可能作为帮助程序无状态会话 bean。无需传递 bean，客户端始终使用相同的 bean。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T20:10:54.173

正如 Tomasz 所提到的，您可能需要重新考虑您的流程。

也就是说，您可以通过使用我们在启动时分配给每个 bean 的可移植 JNDI 名称进行 JNDI 查找来获取新的有状态实例。

# javascript - Javascript - 在类的函数成员中正确使用“this”

> ID：10355766
> 
> 赞同：2
> 
> 时间：2012-04-27T18:12:39.340
> 
> 标签：javascript, annotations, google-closure-compiler

我想`this`在类的函数成员中使用该对象。该函数可以根据类的实例而有所不同。它工作正常，但 Google Closure Compiler 会向我发送警告，这让我觉得我做得不对。

因此我的问题是：`this`在既不是原型也不是构造函数的函数中使用的正确方法是什么？如果没有，我应该怎么做而不是尝试在`this`那里使用？

这是我正在尝试做的一个说明：

```
/** @constructor */
function MyAlert() {}
/** @type {string} */
MyAlert.prototype.name = "joe";
/** @type {function()} */
MyAlert.prototype.myAlert;

/** @type {MyAlert} */
var formalAlert = new MyAlert();

/** @type {MyAlert} */
var informalAlert = new MyAlert();

informalAlert.myAlert = function() {alert("Hi " + this.name);}
formalAlert.myAlert = function() {alert("Good morning Mr " + this.name);}

formalAlert.myAlert();
informalAlert.myAlert(); 
```

在[编译](http://closure-compiler.appspot.com/home#webservice)时，我收到此警告并且找不到解决方法：

```
JSC_USED_GLOBAL_THIS: dangerous use of the global this object at line 11 character 57
formalAlert.myAlert = function() {alert("Good morning" + this.name);}
                                                         ^ 
```

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T03:52:05.250

从你的例子：

```
formalAlert.myAlert = function() {...} 
```

在formalAlert 上创建一个新的静态属性，它会遮蔽（而不是替换）原型。虽然仍然是完全有效的 javascript，但重要的是要意识到编译器正确地将这些视为不同的属性。

要消除此警告，您只需告诉编译器“this”对象的类型：

```
formalAlert.myAlert = /** @this {MyAlert} */ function() {...}; 
```

# sqlite - 我应该如何处理 SQLalchemy 和 SQLite 中的小数

> ID：10355767
> 
> 赞同：26
> 
> 时间：2012-04-27T18:12:46.133
> 
> 标签：sqlite, sqlalchemy, decimal, type-conversion

当我使用带有 SQLite 数据库引擎的 Numeric 列时，SQLalchemy 给了我以下警告。

> SAWarning：方言 sqlite+pysqlite 本身*不*支持 Decimal 对象

我正在尝试找出`pkgPrice = Column(Numeric(12,2))`在仍然使用 SQLite 的同时使用 SQLalchemy 的最佳方法。

这个问题 [1][如何将 Python 十进制转换为 SQLite 数字？](https://stackoverflow.com/questions/6319409/how-to-convert-python-decimal-to-sqlite-numeric)展示了一种使用`sqlite3.register_adapter(D, adapt_decimal)`SQLite 接收和返回小数，但存储字符串的方法，但我不知道如何深入 SQLAlchemy 核心来做到这一点。类型装饰器看起来是正确的方法，但我还没有理解它们。

有没有人有一个 SQLAlchemy 类型装饰器配方，它将在 SQLAlchemy 模型中包含数字或十进制数字，但将它们作为字符串存储在 SQLite 中？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-29T09:49:30.833

由于看起来您使用小数来表示货币价值，我建议您采取安全措施并将货币价值存储在最低面额中，例如 1610 美分而不是 16.10 美元。然后你可以只使用一个整数列类型。

它可能不是您期望的答案，但它解决了您的问题，并且通常被认为是理智的设计。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-04-30T16:15:16.570

```
from decimal import Decimal as D
import sqlalchemy.types as types

class SqliteNumeric(types.TypeDecorator):
    impl = types.String
    def load_dialect_impl(self, dialect):
        return dialect.type_descriptor(types.VARCHAR(100))
    def process_bind_param(self, value, dialect):
        return str(value)
    def process_result_value(self, value, dialect):
        return D(value)

# can overwrite the imported type name
# @note: the TypeDecorator does not guarantie the scale and precision.
# you can do this with separate checks
Numeric = SqliteNumeric
class T(Base):
    __tablename__ = 't'
    id = Column(Integer, primary_key=True, nullable=False, unique=True)
    value = Column(Numeric(12, 2), nullable=False)
    #value = Column(SqliteNumeric(12, 2), nullable=False)

    def __init__(self, value):
        self.value = value 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-09-26T22:28:21.383

这是一个受@van 和@JosefAssad 启发的解决方案。

```
class SqliteDecimal(TypeDecorator):
    # This TypeDecorator use Sqlalchemy Integer as impl. It converts Decimals
    # from Python to Integers which is later stored in Sqlite database.
    impl = Integer

    def __init__(self, scale):
        # It takes a 'scale' parameter, which specifies the number of digits
        # to the right of the decimal point of the number in the column.
        TypeDecorator.__init__(self)
        self.scale = scale
        self.multiplier_int = 10 ** self.scale

    def process_bind_param(self, value, dialect):
        # e.g. value = Column(SqliteDecimal(2)) means a value such as
        # Decimal('12.34') will be converted to 1234 in Sqlite
        if value is not None:
            value = int(Decimal(value) * self.multiplier_int)
        return value

    def process_result_value(self, value, dialect):
        # e.g. Integer 1234 in Sqlite will be converted to Decimal('12.34'),
        # when query takes place.
        if value is not None:
            value = Decimal(value) / self.multiplier_int
        return value 
```

就像@Jinghui Niu 提到的，当十进制作为字符串存储在sqlite 中时，某些查询不会总是按预期运行，例如session.query(T).filter(T.value > 100) 或sqlalchemy.sql 之类的东西。 expression.func.min，甚至 order_by，因为 SQL 比较的是字符串（例如字符串中的“9.2”>“19.2”），而不是我们在这些情况下所期望的数值。

# ruby-on-rails - ActionMailer 不使用默认发件人或任何“发件人”

> ID：10355769
> 
> 赞同：1
> 
> 时间：2012-04-27T18:12:49.510
> 
> 标签：ruby-on-rails, ruby, email, mailer

我正在尝试向我的用户发送“欢迎电子邮件”，但是默认的 :from 不起作用。它使用我在 config/application.rb 文件中指定的用户名。

这是我目前拥有的代码。

配置/应用程序.rb

```
ActionMailer::Base.smtp_settings = {
  :address              => "smtp.gmail.com",
  :port                 => "587",
  :domain               => "domain.com",
  :user_name            => "myemail@gmail.com",
  :password             => "password",
  :authentication       => "plain",
  :enable_starttls_auto => true
} 
```

user_mailer.rb

```
class UserMailer < ActionMailer::Base
  default :from => 'email_i_want_to_send_from@gmail.com'

  def welcome_email
    mail(:to => "myemail@gmail.com", :subject => "welcome")
  end
end 
```

用户不会收到来自 email_i_want_to_send_from@gmail.com 的电子邮件，而是会收到来自**myemail@gmail.com**的**电子邮件**。（是的，我在测试时使用了实际的电子邮件地址和密码）。

任何人对为什么会发生这种情况有任何想法？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-07T17:54:10.593

Google 不允许您“欺骗”发件人地址。我使用发送网格发送我的电子邮件。

# matlab - 什么是 ppmreader 以及如何在 matlab 中打开 ppm 文件

> ID：10355770
> 
> 赞同：1
> 
> 时间：2012-04-27T18:12:58.340
> 
> 标签：matlab, ppm

我正在尝试在 matlab 中打开一个 .ppm 文件，我该怎么做？

```
i = imread('pic.ppm'); 
```

在线有 ppm 阅读器。这是什么文件转换？以及如何从 ppm 文件中读取？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:28:48.410

```
function [ r, g, b ] = ppma_read ( file_name )

%*****************************************************************************80
%
%% PPMA_READ opens an ASCII PPM file and reads the data.
%
%  The PPMA file is assumed to have the format:
%
%    P3
%    # feep.ppma
%    ncol nrow
%    maxrgb, the largest legal value for the data.
%    row 1, a list of ncol triples between 0 and maxrgb.
%    row 2, a list of ncol triples between 0 and maxrgb.
%    ...
%    row nrow, a list of ncol triples between 0 and maxrgb.
%
%    Lines beginning with '#' are comments.
%
%  Example:
%
%    P3
%    # feep.ppma
%    4 4
%    15
%     0  0  0  0  0  0    0  0  0   15  0 15
%     0  0  0  0 15  7    0  0  0    0  0  0
%     0  0  0  0  0  0    0 15  7    0  0  0
%    15  0 15  0  0  0    0  0  0    0  0  0
%
%  Licensing:
%
%    This code is distributed under the GNU LGPL license.
%
%  Modified:
%
%    21 February 2004
%
%  Author:
%
%    John Burkardt
%
%  Parameters:
%
%    Input, string FILE_NAME, the name of the PPMA file to read.
%
%    Output, integer R{NROW,NCOL], G{NROW,NCOL], B{NROW,NCOL] is the RGB data read from the file.
%
  FALSE = 0;
  TRUE = 1;

  r = [];
  g = [];
  b = [];

  fid = fopen ( file_name, 'r' );

  if ( fid < 0 )
    fprintf ( 1, '\n' );
    fprintf ( 1, 'PPMA_READ - Fatal error!\n' );
    fprintf ( 1, '  Could not open the input file.\n' );
    error ( 'PPMA_READ - Fatal error!' );
    return;
  end
%
%  Read the first line.
%
  line = fgets ( fid );
%
%  Verify that the first two characters are the "magic number".
%  Matlab strncmp returns 1 for equality, and 0 for inequality.
%
  if ( strncmp ( line, 'P3', 2 ) == 0 )
    return;
  end
%
%  Move to the next noncomment line.
%
  while ( 1 )
    line = fgets ( fid );
    if ( line(1) ~= '#' ) 
      break;
    end
  end
%
%  Extract NCOL and NROW.
%
  [ array, count ] = sscanf ( line, '%d' );
  ncol = array(1);
  nrow = array(2);
%
%  Move to the next noncomment line.
%
  while ( 1 )
    line = fgets ( fid );
    if ( line(1) ~= '#' ) 
      break;
    end
  end
%
%  Extract MAXRGB, and ignore it.
%
  [ array, count ] = sscanf ( line, '%d' );
  maxRGB = array(1);
%
%  Set aside space for R, G< B.
%
  r = zeros ( nrow, ncol );
  g = zeros ( nrow, ncol );
  b = zeros ( nrow, ncol );

  i = 1;
  j = 0;
  p = 0;
  done = FALSE;

  while ( done == FALSE )
%
%  Move to the next noncomment line.
%
    while ( 1 )
      line = fgets ( fid );
      if ( line(1) ~= '#' ) 
        break;
      end
    end
    [ array, count ] = sscanf ( line, '%d' );
%
%  Each value that you read goes into the "next" open entry.
%  When reading R, we update the row and column indices.
%
    for k = 1 : count

      if ( p == 0 )
        j = j + 1;
        if ( ncol < j )
          j = 1;
          i = i + 1;
        end
        r(i,j) = array(k);
      elseif ( p == 1 )
        g(i,j) = array(k);
      elseif ( p == 2 )
        b(i,j) = array(k);
        if ( i == nrow & j == ncol )
          done = TRUE;
        end
      end

      p = mod ( p+1, 3 );

    end 

  end

  fclose ( fid );

  return
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:21:12.720

句法

```
A = imread(filename, fmt)
[X, map] = imread(...)
[...] = imread(filename)
[...] = imread(URL,...)
[...] = imread(...,Param1,Val1,Param2,Val2...) 
```

# device-driver - WinXPe NDIS 5.1 设备驱动程序 IPv6

> ID：10355773
> 
> 赞同：2
> 
> 时间：2012-04-27T18:13:21.003
> 
> 标签：device-driver, wdk, ndis

编写 WinXPe NDIS 5.1 设备驱动程序。从 DDK 的 Intel E100 驱动程序源开始并适应 Altera 三速以太网内核。通过分散收集DMA接收数据包运行良好，可以看到良好的数据。通过单独的分散收集 DMA 传输数据包声称运行良好。问题是 ipconfig 仅显示 NIC 的 IPv6 IP 地址。控制面板、网络配置、Internet 协议，已设置静态 IPv4 IP 地址且没有 DHCP。但是 ipconfig 没有看到它。找不到任何 OID 似乎可以告诉 WinXPe 有关 IPv6 与 IPv4 的任何信息。控制面板，网络配置正确更新以太网连接和断开连接，但似乎没有什么可以取悦 ipconfig。ipconfig 从哪里获取其 IPv6 信息，驱动程序如何影响它？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T23:50:35.050

问题是 OID_GEN_CURRENT_PACKET_FILTER 的不完整实现，它禁止更高级别的驱动程序将 IPv4 数据包传递给/从驱动程序。尽管 OID_GEN_CURRENT_PACKET_FILTER 中的所有标志位似乎都与 IPv4 [或 IPv6] 无关，但它很重要。在我的 MSDN 帐户上致电 Microsoft 以解决此问题。

# java - JBoss SAR 与 EAR/WAR 封装

> ID：10355778
> 
> 赞同：16
> 
> 时间：2012-04-27T18:14:04.730
> 
> 标签：java, jboss, jmx, mbeans, sar

我什么时候会选择部署为 JBoss SAR 而不是 EAR？

这更像是一个一般性问题，我正在寻找解释每种部署模型的优缺点以及何时适用的指南。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-27T18:45:44.653

当您想要扩展服务器的功能时，您将构建一个 SAR（服务存档）。例如，JBoss 将 SAR 用于 EJB 部署程序或消息传递。您可以为自己的服务监控创建一个（即，观察您的一项自定义服务的一些指标）。据我所知，SAR 是 JBoss 独有的。

根据我的个人经验，我曾经创建了一个 SAR 来跟踪 Web 服务。我主要使用服务组件来跟踪 Web 服务组件创建的事物列表的长度。这是我可以在 jmx-console 中查看并找出有关对 Web 服务的传入请求的一些指标的一种方法。

SAR 基于 JMX 规范，因此创建它们并不难。您基本上创建了一个标准 MBean 接口并实现该接口。您还需要确保目录`jboss-service.xml`中有文件`META-INF`。

另一方面，WAR 和 EAR 用于标准应用程序打包，您希望容器在其中管理和处理应用程序的请求。您不希望应用程序像 SAR 打包应用程序那样作为匿名服务组件运行。

希望这可以帮助！

# c - 如何在菜单项上捕获 gtk 滚动事件

> ID：10355779
> 
> 赞同：3
> 
> 时间：2012-04-27T18:14:36.520
> 
> 标签：c, gtk, glib, gtk3, gdk

Gtk 小部件发出一个信号[scroll-event](http://developer.gnome.org/gtk3/3.3/GtkWidget.html#GtkWidget-scroll-event)。我想将一个函数连接到 MenuItem 上的该信号。以下示例代码不起作用。

```
$ cat scroll-event-on-menu-item.c 
#include <gtk/gtk.h>

void scroll_cb(GtkStatusIcon* icon, GdkEvent* ev, gpointer userdata)
{
    g_message("scrolled!");
}

void quit_cb(GtkMenuItem* item, GdkEventButton* ev, gpointer userdata)
{
    gtk_main_quit();
}

void click_cb(GtkStatusIcon* icon, GdkEventButton* ev, gpointer userdata)
{
    GtkWidget* menu = gtk_menu_new();
    GtkWidget* item = gtk_image_menu_item_new_from_stock(GTK_STOCK_QUIT, NULL);
    gtk_menu_shell_append(GTK_MENU_SHELL(menu), item);
    gtk_widget_show(menu);
    gtk_widget_show(item);
    g_signal_connect(item, "button-press-event", G_CALLBACK(quit_cb), NULL);
    g_signal_connect(item, "scroll-event", G_CALLBACK(scroll_cb), NULL);
    gtk_menu_popup(GTK_MENU(menu), NULL, NULL, gtk_status_icon_position_menu,
            icon, ev->button, ev->time);
}

int main(int argc, char *argv[])
{
    gtk_init(&argc, &argv);

    GtkStatusIcon* icon = gtk_status_icon_new_from_stock(GTK_STOCK_INFO);
    g_signal_connect(icon, "button-press-event", G_CALLBACK(click_cb), NULL);

    gtk_main();

    return 0;
}

$ cat Makefile 
CFLAGS := $(shell pkg-config --cflags gtk+-3.0)
LDFLAGS := $(shell pkg-config --libs gtk+-3.0)
scroll-event-on-menu-item: 
```

如何捕捉菜单项上的滚动事件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-27T19:51:29.073

您必须启用 GDK_SCROLL_MASK 掩码才能接收滚动事件。

```
gtk_widget_add_events(GTK_WIDGET(item), GDK_SCROLL_MASK); 
```

# c# - 密码不应包含用户的帐户名或超过两个连续字符的用户全名部分

> ID：10355781
> 
> 赞同：0
> 
> 时间：2012-04-27T18:14:38.817
> 
> 标签：c#, regex

实际上，我有一个小问题是我正在开发应用程序，其中注册用户的表单和验证结束密码不能包含用户名，并且不能包含连续的 2 个字母形式的用户名。

假设用户名 id 为“Aspnetmvc”，那么密码不应包含整个单词“Aspnetmvc”甚至用户名的一部分，如 asp、net、mvc。这可以通过自定义逻辑来解决，但我想做的是通过编程逻辑来解决，但我想做的是找到用正则表达式解决这个问题的方法。

有人知道这个 C# 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T16:25:54.823

一个非常简单的解决方案是创建一个方法，该方法将从用户名和实名中提取所有可能的 3 个字母组合，并检查这些是否是密码的一部分。3 个字符的每个可能部分（超过 2 个）的方法可以编写为简单的扩展方法，然后您可以使用该`IEnumerable.Any`方法查看这些部分是否是密码的一部分：

```
using System;
using System.Linq;
using System.Collections.Generic;

namespace ConsoleApplication5
{
    static class Program
    {
        static void Main(string[] args)
        {
            string password = "1234567890";

            string username = "125689";
            string realName = "890";

            bool usernameOk = !username.AllPartsOfLength(3)
                .Any(part => password.Contains(part));
            bool realNameOk = !realName.AllPartsOfLength(3)
                .Any(part => password.Contains(part));
        }

        public static IEnumerable<string> AllPartsOfLength(this string value, int length)
        {
            for (int startPos = 0; startPos <= value.Length - length; startPos++)
            {
                yield return value.Substring(startPos, length);
            }
            yield break;
        }
    }
} 
```

我发现这比任何包含正则表达式的解决方案更容易阅读。

你甚至可以这样做：

```
passwordOk = !username.AllPartsofLength(3)
    .Concat(realName.AllPartsOfLength(3))
    .Any(part => password.Contains(part)); 
```

由于这些使用惰性评估，因此在找到第一部分时评估将停止。

确实没有必要，也没有充分的理由尝试使用正则表达式来执行此操作。您可以使用的唯一表达式是检查字符串中是否存在任何 3 个字母部分的表达式。所以你仍然必须将字符串分成 3 部分，然后构建一个表达式，让运行时为此构建一个状态机，根据输入检查它，然后丢弃表达式。对于手头的问题，这是昂贵的。

它看起来像这样：

```
IEnumerable<string> parts = username.AllPartsOfLength(3)
    .Concat(realName.AllPartsOfLength(3))
    .Select(part => Regex.Escape(part));

string regex = "(" + string.Join("|", parts) + ")";

bool isPasswordOk = !Regex.Match(regex).Success; 
```

* * *

**添加基准**

根据 sln 的要求，一个简短的基准：

> 方法：StringManipulationOnly 所用时间：26,0015 毫秒。通过：3333。失败 6666。
> 
> 方法：RegexStringJoinAllParts 耗时：486,0278ms。通过：3333。失败 6666。
> 
> 方法：RegexZeroWidthPlusOneAndDotSplat 耗时：5686,3252ms。通过：3333。失败 6666。
> 
> 方法：RegexZeroWidth 耗时：2659,1521ms。通过：3333。失败 6666。

**编辑** 在删除 e.* 的情况下进行了另一次测试，但额外的 . 保存在那里

> 方法：RegexZeroWidthPlusOne 耗时：2601,1488ms。通过：3333。失败 6666。

正如您所看到的那样，要么`.*`导致另一个 50% 的延迟，而且所有使用正则表达式拆分字符串的解决方案都比使用 string.Join 创建一个大表达式慢得多。到目前为止，明显的赢家不是使用正则表达式。

`.*constant`对慢于的事实的解释`constant`可能是由于 .* 将首先获取整个输入，然后开始回溯（从字符串的末尾）以查找常量，而`constant`只会查找第一个的发生`constant`。

一个简单的测试似乎证实了这一点（使用`.*?`代替`.*`）：

> 方法：RegexZeroWidthPlusOneDotSplatReluctant 所用时间：2646,1514ms。通过：3333。失败 6666。

我确实对代码做了一些更改，我删除了区分大小写检查（OP 没有要求）我删除了参数验证，我将代码更改为提前失败。这确保了不同方法之间的公平比较。[代码可以在这里找到](http://pastebin.com/jTeXS4f7)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T22:08:28.680

您应该让正则表达式为您完成工作`(?=(..)).`

**重做 4-29**

```
static class Program
{
    static void Main(string[] args)
    {
        string Password = "(O*@aJY^+{PC";
        string Account  = "email@Abc.com";
        string Name     = "Ted Nelson";
        if (Password.IsNotSequentialChars(Account, 2) && Password.IsNotSequentialChars(Name, 2))
            Console.WriteLine("Passed");
        else
            Console.WriteLine("Failed");
    }

    public static bool IsNotSequentialChars(this string Src, string Dest, int check_len)
    {
        if (check_len < 1 || Src.Length < check_len) return true;
        Match m = Regex.Match(Src, "(?=(.{" + check_len + "})).");
        bool bOK = m.Success;

        while (bOK && m.Success)
        {
            // Edit: remove unnecessary '.*' from regex.
            // And btw, is regex needed at all in this case?
            bOK = !Regex.Match(Dest, "(?i)" + Regex.Escape(m.Groups[1].Value)).Success;
            if (!bOK)
                Console.WriteLine("Destination contains " + check_len + " sequential source letter(s) '" + m.Groups[1].Value + "'");
            m = m.NextMatch();
        }
        return bOK;
    }
} 
```

欢迎提供基准...

# mysql - Mysql存储过程导出

> ID：10355782
> 
> 赞同：3
> 
> 时间：2012-04-27T18:14:47.210
> 
> 标签：mysql, stored-procedures, backup

我已经使用 username@XX.XX.XX.XX 作为 DEFINER 值创建了所有存储过程。现在，由于我更改了我的位置，因此我无法查看或导出代码的 IP 地址。

我的代码在共享主机上，支持团队不想就此事提供帮助。

关于如何获取代码的任何想法？即使是完整的数据库导出也不包含存储过程代码。它只有插入到 ROUTINES 表中的数据

```
INSERT INTO `ROUTINES` (`SPECIFIC_NAME`, `ROUTINE_CATALOG`, `ROUTINE_SCHEMA`,
    `ROUTINE_NAME`, `ROUTINE_TYPE`, `DTD_IDENTIFIER`,
    `ROUTINE_BODY`, `ROUTINE_DEFINITION`, `EXTERNAL_NAME`, `EXTERNAL_LANGUAGE`,
    `PARAMETER_STYLE`, `IS_DETERMINISTIC`, `SQL_DATA_ACCESS`, `SQL_PATH`,
    `SECURITY_TYPE`, `CREATED`, `LAST_ALTERED`, `SQL_MODE`, `ROUTINE_COMMENT`,
    `DEFINER`, `CHARACTER_SET_CLIENT`, `COLLATION_CONNECTION`,
    `DATABASE_COLLATION`)
VALUES ('sp_sample_name', NULL, 'XXX',
    'sp_sample_name', 'PROCEDURE', NULL,
    'SQL', NULL, NULL, NULL,
    'SQL', 'NO', 'CONTAINS SQL', NULL,
    'DEFINER', '2012-03-26 01:01:14', '2012-03-26 01:01:14', 'STRICT_TRANS_TABLES',
    '', 'username@XX.XX.XX.XX', 'latin1', 'latin1_swedish_ci',
    'latin1_swedish_ci'), 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:21:50.240

你可以打电话[`SHOW CREATE PROCEDURE`](http://dev.mysql.com/doc/refman/5.6/en/show-create-procedure.html)。

# javascript - 强制单击 javascript 页面

> ID：10355784
> 
> 赞同：0
> 
> 时间：2012-04-27T18:14:53.857
> 
> 标签：javascript, code-injection

我有一个 HTML/JavaScript 页面，我需要强制点击一个隐藏按钮。该按钮被禁用，直到视频播放完毕这里是按钮的来源

```
<TD valign=top align=center><a href="javascript:nextbutton();"
    onMouseOver="if (ITnext != null) document['continue'].src='skins/'+vidnextdown" 
    onMouseOut="if (ITnext != null) document['continue'].src='skins/'+vidnextup">
<img src='blank.gif' name='continue' border=0 width=72 height=72 alt='Next Topic'></a> 
```

我努力了

```
$('/#continue').trigger("click"); 
```

和

```
javascript:$('/#nextbutton').trigger("click"); 
```

在浏览器中没有运气。

我也被迫使用 Internet Explorer。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:16:42.930

你为什么不直接为你的 onClick 执行回调函数呢？您不需要强制点击事件。

# iphone - 在 iPhone 上获取焦距

> ID：10355785
> 
> 赞同：4
> 
> 时间：2012-04-27T18:14:55.243
> 
> 标签：iphone, ios

有谁知道如何获得用 iPhone 拍摄的照片的焦距？我正在寻找一个 API 来执行此操作（即时）或在拍摄照片后从 EXIF 数据中获取信息的方式。到目前为止，我没有运气。我愿意以编程方式拍摄低分辨率照片以获取其 exif 数据，但更喜欢在 iPhone 处于“预览”模式时读取焦距的方法。

# asp.net - 缺少参数值

> ID：10355792
> 
> 赞同：0
> 
> 时间：2012-04-27T18:15:29.323
> 
> 标签：asp.net, crystal-reports

我收到错误“缺少参数值”。我浏览了许多帖子并尝试了所有帖子。

```
protected void Page_Load(object sender, EventArgs e)
    {
        PaystubParms pparms = new PaystubParms();

        pparms.periodstart = 20120316;
        pparms.periodend = 20120331;
        pparms.empno = "91065";
        pparms.checknbr = 2306;

        PaystubCrystalReportSource.ReportDocument.SetDatabaseLogon("Abra_Reports","123456","Tsysmas","AbraHrms_Live");

        ParameterField pfield0 = PaystubCrystalReportViewer.ParameterFieldInfo[0];
        ParameterDiscreteValue pfield0val = new ParameterDiscreteValue();

        pfield0val.Value = pparms.periodstart;
        pfield0.CurrentValues.Add(pfield0val);
        //-------------------------------------------------------------------------
        ParameterField pfield1 = PaystubCrystalReportViewer.ParameterFieldInfo[1];
        ParameterDiscreteValue pfield1val = new ParameterDiscreteValue();

        pfield1val.Value = pparms.periodend;
        pfield1.CurrentValues.Add(pfield1val);

        //-------------------------------------------------------------------------
        ParameterField pfield2 = PaystubCrystalReportViewer.ParameterFieldInfo[2];
        ParameterDiscreteValue pfield2val = new ParameterDiscreteValue();

        pfield2val.Value = pparms.empno;
        pfield2.CurrentValues.Add(pfield1val);
        //-------------------------------------------------------------------------
        ParameterField pfield3 = PaystubCrystalReportViewer.ParameterFieldInfo[3];
        ParameterDiscreteValue pfield3val = new ParameterDiscreteValue();

        pfield3val.Value = pparms.periodstart;
        pfield3.CurrentValues.Add(pfield1val);

        PaystubCrystalReportSource.ReportDocument.SetParameterValue(0, pfield0.CurrentValues.Add(pfield0val));

        *******************************************************************
        I have also tried
        PaystubCrystalReportSource.ReportDocument.SetParameterValue(0, pparms.periodstart);
        *******************************************************************************

        PaystubCrystalReportSource.ReportDocument.SetParameterValue(1, pfield1.CurrentValues.Add(pfield1val));
        PaystubCrystalReportSource.ReportDocument.SetParameterValue(2, pfield2.CurrentValues.Add(pfield2val));
        PaystubCrystalReportSource.ReportDocument.SetParameterValue(3, pfield3.CurrentValues.Add(pfield3val));

        PaystubCrystalReportViewer.ReportSource = PaystubCrystalReportSource;

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:22:20.553

确保所有参数都是 Crystal 期望的类型。

有时传递错误类型的参数会导致“缺少参数”错误。例如，为整数参数传递十进制值。

# mysql - 在 MySQL 中使用带有 ON DUPLICATE KEY UPDATE 的 IF()

> ID：10355798
> 
> 赞同：17
> 
> 时间：2012-04-27T15:09:25.607
> 
> 标签：mysql, mysql-error-1064

我有一个运行 MySQL 查询的 PHP 脚本。

```
$query = "INSERT INTO table (col1, col2)
          VALUES('$val1', '$val2')
          ON DUPLICATE KEY UPDATE col2= IF(IS NOT NULL '$val1', 'test', 'col2)"; 
```

这是我想要做的： Col1 是主键。如果有重复，它会检查 col2 的插入值是否为空。如果不是，它将更新该值，否则该值将保持不变。

此插入失败。当我尝试在 sqlyog 中手动运行它（插入实际值代替变量）时，出现以下错误：错误代码：1064

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获得在“IS NOT NULL .....”附近使用的正确语法

我已经检查了 IS NOT NULL 比较运算符（[http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#operator_is-not-null](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#operator_is-not-null)）的 MySQL 参考手册，以及INSERT ... ON DUPLICATE KEY UPDATE Syntax ( [http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html) ) 并相信我使用正确，但显然这不是案子。

我究竟做错了什么？

作为参考，我使用的是 MySQL 5，并且脚本在 RHEL5 服务器上运行。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-27T16:22:04.550

语法`IS NOT NULL column`错误。正确：`column IS NOT NULL`。我不确定这`'test'`是怎么回事。您说要更新列或保持原样。

```
$query = "INSERT INTO table (col1, col2)
          VALUES('$val1', '$val2')
          ON DUPLICATE KEY UPDATE col2 = IF('$val2' IS NOT NULL, '$val2', col2)"; 
```

也可以写成：

```
$query = "INSERT INTO table (col1, col2)
          VALUES('$val1', '$val2')
          ON DUPLICATE KEY UPDATE 
            col2 = COALESCE( VALUES(col2), col2)"; 
```

# php - 如何通过 apache 渲染 .phtml 文件

> ID：10355805
> 
> 赞同：3
> 
> 时间：2012-04-27T18:16:51.220
> 
> 标签：php, apache, .htaccess

我想通过 Apache 呈现一个 .phtml 文件，但是当我尝试时，它将页面呈现为文本而不是 html。

在我的 vhost 配置中，如果我尝试渲染 index.php，它会正确执行。但是，当我将 DirectoryIndex 更改为 index.phtml 并尝试呈现公共目录中的 index.phtml 时，它只会呈现文本。

虚拟主机配置为： `code` ServerName parminder.com DocumentRoot "C:/workspace/parminder_local_net/public" ErrorLog logs/parmindercom.log
选项索引 FollowSymLinks AllowOverride All Order allow,deny Allow from all DirectoryIndex index.phtml *

我还需要配置什么才能使其正常工作？我需要使用 .htaccess 吗？基本概念是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T18:20:29.727

htaccess 文件根文件夹 --> 文件夹 --> html 页面和子文件夹

尝试将其添加到其中：

`AddHandler php-script .php .php5 .php4 .php3 .html .htm .phtm`l

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:22:09.610

您需要配置 Apache，以便它知道您希望将 .phtml 文件视为 PHP。[请参阅PHP 安装指南](http://www.php.net/manual/en/install.unix.apache2.php)的第 8 步。

```
<FilesMatch "\.ph(p[2-6]?|tml)$">
    SetHandler application/x-httpd-php
</FilesMatch> 
```

...但是 .phtml 是用于 PHP 2 的文件扩展名。您可能应该审核它们，使它们符合现代 PHP 编码实践并重命名它们以遵循当前约定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T18:34:26.767

安装完apache服务器后，需要说明apache解析器会读取哪些文件，

这是通过提及文件类型来完成的。像

**

```
> <FilesMatch \.php$>
>     SetHandler application/x-httpd-php </FilesMatch> 
```

**

并且为了允许 .php、.php2、.php3、.php4、.php5、.php6 和 .phtml 文件作为 PHP 执行，请使用以下

```
<FilesMatch "\.ph(p[2-6]?|tml)$">
    SetHandler application/x-httpd-php
</FilesMatch> 
```

# javascript - 通过显示相应的 DIV 进行下一个和上一个导航

> ID：10355810
> 
> 赞同：3
> 
> 时间：2012-04-27T18:17:25.750
> 
> 标签：javascript, html, navigation

我正在寻找一个可以一次显示一个 DIV 并隐藏其余部分的脚本（在我的示例中为 2 个）此外，我希望用户来回导航

IE

一旦用户单击下一个 DIV 1 就会显示如此直到 DIV3 他也应该能够从 DIV2 遍历 - DIV1 等等

我确实觉得这个发展很有趣

[http://jsfiddle.net/meetrk85/Y7mfF/](http://jsfiddle.net/meetrk85/Y7mfF/)

提前十亿谢谢......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T19:31:48.077

给定以下 HTML：

```
<div class="sample">div1</div>
<div class="sample">div2</div>
<div class="sample">div3</div>
<a href="#" id="display" class="display">next</a>
<a href="#" id="display1" class="display">prev</a> 
```

以下 jQuery 似乎可以满足您的要求：

```
// selects all the divs of class='sample',hides them, finds the first, and shows it
$('div.sample').hide().first().show();

// binds a click event-handler to a elements whose class='display'
$('a.display').on('click', function(e) {
    // prevents the default action of the link
    e.preventDefault();

    // assigns the currently visible div.sample element to a variable
    var that = $('div.sample:visible'),
        // assigns the text of the clicked-link to a variable for comparison purposes
        t = $(this).text();

    // checks if it was the 'next' link, and ensures there's a div to show after the currently-shown one
    if (t == 'next' && that.next('div.sample').length > 0) {
        // hides all the div.sample elements
        $('div.sample').hide();

        // shows the 'next'
        that.next('div.sample').show()
    }
    // exactly the same as above, but checking that it's the 'prev' link
    // and that there's a div 'before' the currently-shown element.
    else if (t == 'prev' && that.prev('div.sample').length > 0) {
        $('div.sample').hide();
        that.hide().prev('div.sample').show()
    }
});​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Y7mfF/10/)。

参考：

*   [`first()`](http://api.jquery.com/first/).
*   [`hide()`](http://api.jquery.com/hide/).
*   [`next()`](http://api.jquery.com/next/).
*   [`on()`](http://api.jquery.com/on/).
*   [`prev()`](http://api.jquery.com/prev/).
*   [`show()`](http://api.jquery.com/show/).
*   [`text()`](http://api.jquery.com/text/).
*   [`:visible`选择器](http://api.jquery.com/visible-selector/)。

* * *

## 附加物：

快速解释为什么我[在链接的演示中更改了 html](http://jsfiddle.net/meetrk85/Y7mfF/)：

```
<div name="sample">div1</div>
<div name="sample">div2</div>
<div name="sample">div3</div>
<a href="#" id="display" value="display">next</div>
<a href="#" id="display1" value="display">prev</div> 
```

*   该`name`属性在 a 中`div`毫无用处。如果所有元素都共享相同的名称，则肯定不是（它们不是`input`元素，它们由 链接到`a`，所以使用`class`名称）。

*   [value 属性与element](http://www.w3.org/TR/html4/index/attributes.html)没有[关联`a`](http://www.w3.org/TR/html4/index/attributes.html)，据我所知，它没有任何用途。为此，在上面的脚本中，我再次选择使用`class`名称，因为属性的相同“值”是共享的，尽管`data-*`可以使用属性，并且该属性是有效的。

*   结束`</div>`标签没有关闭任何东西，所以它们被改为`</a>`.

# c# - C# AddFontResource 不起作用 - 仅在 1 种字体上调用时返回 2 种安装的字体

> ID：10355815
> 
> 赞同：1
> 
> 时间：2012-04-27T18:17:41.513
> 
> 标签：c#, fonts, pinvoke

我正在尝试在 Win7 64 位上以编程方式在 C# 中安装 True-Type 字体。

出于某种原因，当我调用 AddFontResource 时，字体没有正确安装，即使我只添加一种字体，我也会得到“2”的返回。

如果我只是双击它并使用常规的 Windows 字体安装界面安装它，字体就会正确安装，所以我知道它是正确的字体。如果我在无效路径上调用 AddFontResource，那么对于没有安装字体，我会得到正确的返回 0，所以它似乎在做“某事”并找到字体文件，但无论它在做什么，它都不起作用。

这是我正在使用的代码：

```
 [DllImport("user32.dll")]
    public static extern int SendMessage(int hWnd,  uint Msg, int wParam,  int lParam);
    [DllImport("gdi32")]
    public static extern int AddFontResource(string lpFileName); 
    public static void InstallFonts()
    {
        const int WM_FONTCHANGE = 0x001D;
        const int HWND_BROADCAST = 0xffff;
        int Ret = AddFontResource(@"C:\FontFile.ttf");
        int Res = SendMessage(HWND_BROADCAST, WM_FONTCHANGE, 0, 0);
    } 
```

字体“FontFile.ttf”显然存在。正如我所提到的，AddFontResource 返回 2，这是没有意义的，而 SendMessage 返回 1，因此它可以正确发送。

有什么想法可能会出错吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-28T22:42:53.670

字体文件通常包含多个字体。例如，foo.ttf 可能包含字体 Foo、Foo Bold、Foo Italic 等。因此返回值 2 是正确的并且表示成功，因为`fontFile.ttf`可能还包含字体的粗体或斜体版本。

# xml - Ext-JS 4：修改网格“单元格编辑”示例的数据存储以使用 JSON 而不是 XML

> ID：10355816
> 
> 赞同：0
> 
> 时间：2012-04-27T18:17:42.450
> 
> 标签：xml, json, extjs, extjs4, datastore

下面是 Sencha.com Ext JS 4 示例中“cell-editing.js”文件的片段。我想使用 json.get 将此 xml 数据存储转换为 json 数据存储。并获取一个示例 json 文件，以便我可以将其转换为动态 json。请注意，请参阅“// 创建数据存储”下的代码块。现在，它显示的是 xml 格式。如何才能做到这一点？

例子：

[http://dev.sencha.com/deploy/ext-4.1.0-gpl/examples/grid/cell-editing.html](http://dev.sencha.com/deploy/ext-4.1.0-gpl/examples/grid/cell-editing.html)

（4.1.0 的版本将来可能会改变）

我对他们的 treegrid.js 文件做了类似的事情，但是因为单元格编辑示例的结构包含多种字段类型（字符串、组合框/选择、布尔值等），我不知道json文件需要。这是 treegrid.js 代码：

```
var store = Ext.create('Ext.data.TreeStore', {
    model: 'Task',
    proxy: {
        type: 'ajax',
        url: 'http://localhost:8888/TreeGrid.ashx'  // OR set to static file 'treegrid.json'
    },
    folderSort: true
}); 
```

**“cell-editing.js”文件：**

```
Ext.Loader.setConfig({
    enabled: true
});
Ext.Loader.setPath('Ext.ux', '../ux');

Ext.require([
    'Ext.selection.CellModel',
    'Ext.grid.*',
    'Ext.data.*',
    'Ext.util.*',
    'Ext.state.*',
    'Ext.form.*',
    'Ext.ux.CheckColumn'
]);

Ext.onReady(function(){

    function formatDate(value){
        return value ? Ext.Date.dateFormat(value, 'M d, Y') : '';
    }

    Ext.define('Plant', {
        extend: 'Ext.data.Model',
        fields: [
            // the 'name' below matches the tag name to read, except 'availDate'
            // which is mapped to the tag 'availability'
            {name: 'common', type: 'string'},
            {name: 'botanical', type: 'string'},
            {name: 'light'},
            {name: 'price', type: 'float'},
            // dates can be automatically converted by specifying dateFormat
            {name: 'availDate', mapping: 'availability', type: 'date', dateFormat: 'm/d/Y'},
            {name: 'indoor', type: 'bool'}
        ]
    });

    // create the Data Store
    var store = Ext.create('Ext.data.Store', {
        // destroy the store if the grid is destroyed
        autoDestroy: true,
        model: 'Plant',
        proxy: {
            type: 'ajax',
            // load remote data using HTTP
            url: 'plants.xml',
            // specify a XmlReader (coincides with the XML format of the returned data)
            reader: {
                type: 'xml',
                // records will have a 'plant' tag
                record: 'plant'
            }
        },
        sorters: [{
            property: 'common',
            direction:'ASC'
        }]
    });

    var cellEditing = Ext.create('Ext.grid.plugin.CellEditing', {
        clicksToEdit: 1
    });

    // create the grid and specify what field you want
    // to use for the editor at each header.
    var grid = Ext.create('Ext.grid.Panel', {
        store: store,
        columns: [{
            id: 'common',
            header: 'Common Name',
            dataIndex: 'common',
            flex: 1,
            editor: {
                allowBlank: false
            }
        }, {
            header: 'Light',
            dataIndex: 'light',
            width: 130,
            editor: {
                xtype: 'combobox',
                typeAhead: true,
                triggerAction: 'all',
                selectOnTab: true,
                store: [
                    ['Shade','Shade'],
                    ['Mostly Shady','Mostly Shady'],
                    ['Sun or Shade','Sun or Shade'],
                    ['Mostly Sunny','Mostly Sunny'],
                    ['Sunny','Sunny']
                ],
                lazyRender: true,
                listClass: 'x-combo-list-small'
            }
        }, {
            header: 'Price',
            dataIndex: 'price',
            width: 70,
            align: 'right',
            renderer: 'usMoney',
            editor: {
                xtype: 'numberfield',
                allowBlank: false,
                minValue: 0,
                maxValue: 100000
            }
        }, {
            header: 'Available',
            dataIndex: 'availDate',
            width: 95,
            renderer: formatDate,
            editor: {
                xtype: 'datefield',
                format: 'm/d/y',
                minValue: '01/01/06',
                disabledDays: [0, 6],
                disabledDaysText: 'Plants are not available on the weekends'
            }
        }, {
            xtype: 'checkcolumn',
            header: 'Indoor?',
            dataIndex: 'indoor',
            width: 55
        }],
        selModel: {
            selType: 'cellmodel'
        },
        renderTo: 'editor-grid',
        width: 600,
        height: 300,
        title: 'Edit Plants?',
        frame: true,
        tbar: [{
            text: 'Add Plant',
            handler : function(){
                // Create a model instance
                var r = Ext.create('Plant', {
                    common: 'New Plant 1',
                    light: 'Mostly Shady',
                    price: 0,
                    availDate: Ext.Date.clearTime(new Date()),
                    indoor: false
                });
                store.insert(0, r);
                cellEditing.startEditByPosition({row: 0, column: 0});
            }
        }],
        plugins: [cellEditing]
    });

    // manually trigger the data store load
    store.load({
        // store loading is asynchronous, use a load listener or callback to handle results
        callback: function(){
            Ext.Msg.show({
                title: 'Store Load Callback',
                msg: 'store was loaded, data available for processing',
                modal: false,
                icon: Ext.Msg.INFO,
                buttons: Ext.Msg.OK
            });
        }
    });
}); 
```

**“植物.xml”文件：**

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<catalog>
  <plant>
    <common>Bloodroot</common>
    <botanical>Sanguinaria canadensis</botanical>
    <zone>4</zone>
    <light>Mostly Shady</light>
    <price>2.44</price>
    <availability>03/15/2006</availability>
    <indoor>true</indoor>
  </plant>
  <plant>
    <common>Columbine</common>
    <botanical>Aquilegia canadensis</botanical>
    <zone>3</zone>
    <light>Mostly Shady</light>
    <price>9.37</price>
    <availability>03/06/2006</availability>
    <indoor>true</indoor>
  </plant>
</catalog> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:39:58.967

将代理阅读器类型更改为“json”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T19:23:52.060

从第 82 页开始，我能够在“Ext JS 4 First Look”一书中找到有关 Ext-JS 数据存储主题的一些文档。请注意，我必须在阅读器匿名对象上添加“root”属性。我注释掉了 XML 格式的行，并用 JSON 实现替换了这些行。我还包含了一个示例 JSON 文件。“light”字段是一个 ComboBox（选择标签或下拉列表的 Ext-JS 版本）。确保这些值与实际对象中定义的值一致。

**“cell-editing.js”文件：**

```
// create the Data Store
var store = Ext.create('Ext.data.Store', {
    // destroy the store if the grid is destroyed
    autoDestroy: true,
    model: 'Event',
    proxy: {
        type: 'ajax',
        // load remote data using HTTP
        //url: 'plants.xml',
        url: 'plants.json',
        // specify a XmlReader (coincides with the XML format of the returned data)
        reader: {
            //type: 'xml',
            type: 'json',
            // records will have a 'plant' tag
            //record: 'plant',
            root: 'plants'
        }
    },
    sorters: [{
        property: 'common',
        direction:'ASC'
    }]
}); 
```

**“植物.json”文件：**

```
{
    "plants": [
        {
            "common": 'Bloodroot',
            "botanical": 'Sanguinaria canadensis',
            "zone": 4,
            "light": 'Mostly Shady',
            "price": 2.44,
            "availability": '03/15/2006',
            "indoor": 'true'
        },
        {
            "common": 'Bloodroot',
            "botanical": 'Sanguinaria canadensis',
            "zone": 4,
            "light": 'Mostly Shady',
            "price": 2.44,
            "availability": '03/15/2006',
            "indoor": 'true'
        }
    ]
} 
```

# algorithm - 使用 N 个点从图像创建一个凹多边形

> ID：10355821
> 
> 赞同：0
> 
> 时间：2012-04-27T18:17:59.493
> 
> 标签：algorithm, polygon

我正在寻找一种算法，该算法将从图像中生成凹多边形（具有 N 个点，其中 N > 3 - 用户输入此值）。

我对算法的想法：

```
 // Every pixel in image is checked and a minimal orientated bounding box  is generated  (transparent pixels are ignored)
 boundingBox = createImageBoundingBox(image);
 curpoints = 4, A = 0, B = 1, tmppoints = curpoints;
 while(curpoints < maxNumberOfPoints)
 { 
    add a new point between point A and point B (A and B are points from the boundingBox)
    reposition points so that it will contain the minimal surface
    A++; B++;
    curpoints++;

    if(A == tmppoints) 
    { A = 0; B = 1; tmppoints=curpoints; }
 } 
```

我面临的问题是我不知道如何最佳地重新定位点。这可以通过任何其他方式完成（更好/更快的方式）。将不胜感激任何想法。

谢谢

编辑：

图像必须至少为 10x10。我需要 N 点参数，以便用户可以调节要使用的点数（用于优化）。另一种方法是使用一个因子 (0-1)，它告诉您希望多边形具有多少细节（多少点）（0 是 4 个点，> 0 5 个或更多点）。但不确定如何实施。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-23T13:24:49.260

您可以使用 delaunay 三角剖分并获得平均边长。然后尝试删除比平均值更长的边缘。这个概念来自阿尔法形状。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T02:57:39.533

凹形船体可以用[阿尔法形状](http://biogeometry.duke.edu/software/alphashapes/index.html)建造。[CGAL 链接。](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Alpha_shapes_2/Chapter_main.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T19:28:15.943

1.) 在方形图像的中间选择一个点。

2.) 从中心随机抖动这个点N次，生成N个新点。

3.) 根据与中心点的最大角度对这些点进行排序

4.）使用边界框中的四个点和按升序角度排序的中点来创建凹多边形的有序点列表。

我不确定我是否理解您上面的“最小表面”步骤，但我相信这个算法可以用于截取图像以生成凹多边形。我认为这比你上面的要快，但我不确定，因为我不完全理解那一步。

这将始终生成与原始图像具有相同边界的凹多边形。如果您不想要这个，您可以添加一个步骤 0.)，它会抖动您的边界框，然后根据此更改您的中点抖动。我认为，这两个想法都会产生一个带有 n 大小点块的边界四边形。

*   这需要 n > 4 （如果您希望这需要 n > 3，则将两个边界框点合并为一个，就像您说的那样。）

# c# - Caliburn Micro Conductor + TransitioningContentControl

> ID：10355823
> 
> 赞同：4
> 
> 时间：2012-04-27T18:18:21.390
> 
> 标签：c#, silverlight, caliburn.micro

我在让我的 CM Conductor 保持 Active 与 TransitioningContentControl 内容的正确绑定时遇到问题。

万一这很重要，我正在使用`Conductor<Screen>.Collection.OneActive`

**重现问题的步骤**

创建一个绑定到导体 ActiveItem 的 TransitioningContentControl：

```
<toolkit:TransitioningContentControl x:Name="ActiveItem" /> 
```

创建两个按钮：

```
<Button x:Name="Nav1" Content="Test1"></Button>
<Button x:Name="Nav2" Content="Test2"></Button> 
```

在视图模型中，连接 Nav1 和 Nav2 单击事件以设置活动项

```
public void Nav1()
{
    ActiveItem = _viewModel1;
}

public void Nav2()
{
    ActiveItem = _viewModel2;
} 
```

乍一看，这似乎工作正常 - 但是有一个问题。假设活动项目代表 Nav1 (_viewModel1)。

如果您随后单击 Nav2，并在 transitioniningContentControl 完成转换之前单击 Nav1，即使 ActiveItem 成功设置回 _viewModel1，Nav2 的视图仍将显示在屏幕上。

这会使您处于 ActiveItem 为 _viewModel1 的无效状态，但正在显示的视图与 _viewModel2 绑定。

想法？直接绑定到 ActiveItem 有什么问题吗？

编辑：

关闭“只是我的代码”调试后，我看到在转换期间设置 ActiveItem 时抛出了 ArgumentException。堆栈跟踪显示：

```
at MS.Internal.XcpImports.CheckHResult(UInt32 hr)
(lots of junk)
Caliburn.Micro!Caliburn.Micro.View.SetContentPropertyCore(object targetLocation, object view) + 0xec bytes  
Caliburn.Micro!Caliburn.Micro.View.SetContentProperty(object targetLocation, object view) + 0x84 bytes  
Caliburn.Micro!Caliburn.Micro.View.OnModelChanged(System.Windows.DependencyObject targetLocation, System.Windows.DependencyPropertyChangedEventArgs args) + 0xda bytes 
```

不确定这是否有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T07:52:24.317

尝试使用 Conductors ActivateItem 方法来设置 ActiveItem 属性。

```
public void Nav1()
{
    ActiveItem(_viewModel1);
} 
```

我希望这个能帮上忙

马丁

# jquery - 使用 PHP 标记自动完成（如 SO）

> ID：10355826
> 
> 赞同：6
> 
> 时间：2012-04-27T18:18:31.700
> 
> 标签：jquery, tags

是否存在用于像 Stack Overflow 上的标记的 jQuery（最好）插件？当您发布问题时，“标签”字段可让您输入标签。

我需要一些可以让你输入标签的任何部分的东西，并且会生成这个标签的 x 建议，就像下拉菜单一样。另一个要求是，当我输入下一个标签时，将生成更多建议，并且当您单击建议的标签时，它会结束您正在输入的标签，而不仅仅是将其附加到输入字段。

我已经在许多网站上看到过这样做，但找不到任何插件来做到这一点。

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-27T18:21:34.853

听起来像标记它。jQuery UI 是必需的。您可以在 Github 上找到项目和源代码：[https ://github.com/aehlke/tag-it](https://github.com/aehlke/tag-it)

![在此处输入图像描述](../Images/14caa027650916827fc2058ca1b2f901.png)

# ruby-on-rails-3 - thomas-mcdonald / bootstrap-sass 是否支持使用生成器？得到一个错误说找不到

> ID：10355828
> 
> 赞同：0
> 
> 时间：2012-04-27T18:18:47.967
> 
> 标签：ruby-on-rails-3, twitter-bootstrap, sass

一个简单的问题。这个版本支持生成器吗？

我想测试一下使用它并跟随我使用不同版本的 Ryan Bates 屏幕截图。

我今天一直在玩桌子，想看看它是如何使用带有脚手架生成模型及其所有组件的生成器工作的。

运行 rails g bootstrap:themed 返回

找不到生成器引导程序：主题

所以我尝试使用 rails g install:bootstrap 重新安装

类似的错误导致我尝试查找它是否支持这些命令。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-06T17:50:37.300

它不需要资产文件的生成器，因为我们通过使用 Rails 引擎连接到资产管道 - 配置选项可通过使用[变量](http://twitter.github.com/bootstrap/download.html#variables)获得（使用此作为参考，Sass 变量实际上`$x`而不是`@x`并且需要*在*导入 bootstrap)、Sass'`@extend`和 Bootstrap 的`@makeRow`和`@makeColumn`mixins 以及其他 Bootstrap mixins之前定义。

主题脚手架会很有趣，但通常维护起来会很痛苦 - 无论如何，视图脚手架往往会很快被撕裂。也许一个“理智的”`application.html.erb`布局生成器可能会有用。

所以是的，我们目前没有生成器，不需要资产，主题脚手架可能不会很快出现，除非有人有足够的兴趣来完成它的工作，可能是管道中的布局生成器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T03:09:13.997

结帐 [https://github.com/decioferreira/bootstrap-generators](https://github.com/decioferreira/bootstrap-generators)

似乎是你所要求的。

-瑞克

# orm - Coldfusion ORM Macromedia][Oracle JDBC Driver][Oracle]ORA-02289: 序列不存在

> ID：10355833
> 
> 赞同：2
> 
> 时间：2012-04-27T18:19:18.883
> 
> 标签：orm, coldfusion

我有一个 ColdFusion ORM 应用程序，它使用 oracle 序列作为主键字段的生成器。我已经验证我可以像在 SQL 导航器中一样以 ColdFusion 连接到数据库的用户身份访问序列。

我的问题是当我尝试在任何对象上保存实体（）时出现以下错误

> 根本原因：java.sql.SQLException：[Macromedia][Oracle JDBC Driver][Oracle]ORA-02289：序列不存在

我已经尝试了以下带有和不带`akc.`前缀的语法。我确实在 CFC 中定义了 akc 架构

```
<cfproperty name="KEY_BREED_PAGE" fieldtype="id" generator="sequence" params="{sequence='akc.seq_breed_page_display'}" /> 
```

和

```
<cfproperty name="KEY_BREED_PAGE" fieldtype="id" generator="sequence" sequence="akc.seq_breed_page_display" /> 
```

关于我可以做些什么来解决这个问题的任何想法？ORM 在更新时工作正常，但在每次尝试创建新记录时都失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:32:17.127

当我没有架构时，我也有类似的情况。您的示例和我的示例之间的唯一区别是我设置了 column 属性。

```
<cfproperty name="KEY_BREED_PAGE" fieldtype="id" column="KEY_BREED_PAGE" generator="sequence" sequence="akc.seq_breed_page_display" /> 
```

# ubuntu - 我在哪里可以找到 Ubuntu ARM init 的源代码？

> ID：10355834
> 
> 赞同：0
> 
> 时间：2012-04-27T18:19:19.040
> 
> 标签：ubuntu, init

我有一个启动时间测量，我想以非常精确的方式执行，我需要使用 init 来执行此操作。Ubuntu ARM 使用什么版本的 init，我在哪里可以找到它的源代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:38:11.287

我不确定您是在寻找“init”进程，还是 Linux 引导程序初始化代码。

无论哪种方式——它们都是标准 Linux 源代码树的一部分，可免费获得，并且有据可查：

例如：

*   [http://www.ubuntu.com/](http://www.ubuntu.com/)

*   [http://www.kernel.org](http://www.kernel.org)

*   [http://www.cnx-software.com/2012/03/27/cross-compiling-the-arm-linux-kernel-in-ubuntu-12-04-lts/](http://www.cnx-software.com/2012/03/27/cross-compiling-the-arm-linux-kernel-in-ubuntu-12-04-lts/)

# facebook - OAuth 后无法接收墙贴

> ID：10355837
> 
> 赞同：0
> 
> 时间：2012-04-27T18:19:46.017
> 
> 标签：facebook, facebook-wall, authentication

首先，我不熟悉使用 Facebook 的 Graph 界面，但我已经阅读了文档，但仍然无法检索到所需的结果。首先，我能够设置一个应用程序帐户并检索我的应用程序 ID 和应用程序密钥，然后我设置并推进 OAuth 对话框，该对话框将要求用户提供 read_stream 权限（访问新闻源）。我已经成功地让三个用户通过了身份验证器，它让我可以看到他们的更多数据，但仍然没有墙帖（我认为这是新闻提要）。如果有人可以提供帮助，以下是我遵循的步骤。谢谢。（旁注 - 以下所有网址均直接来自 facebook 文档。）

[https://www.facebook.com/dialog/oauth?client_id=XXXXXXX&redirect_uri=http://myurl.com/wheredataisdisplayed&scope=read_stream&state=SomethingIndentifiable](https://www.facebook.com/dialog/oauth?client_id=XXXXXXX&redirect_uri=http://myurl.com/wheredataisdisplayed&scope=read_stream&state=SomethingIndentifiable)

返回：state and code=1XXXXXXXX，然后我用它来获取 OAuth Token

[https://graph.facebook.com/oauth/access_token?client_id=XXXXXXX&redirect_uri=http://myurl.com/wheredataisdisplayed&client_secret=XXXXXXXXXXXXXXXXXXXXX&code=1XXXXXXXX](https://graph.facebook.com/oauth/access_token?client_id=XXXXXXX&redirect_uri=http://myurl.com/wheredataisdisplayed&client_secret=XXXXXXXXXXXXXXXXXXXX&code=1XXXXXXXX)

返回 access_token = XXXXXXXXXXXXXXXXX 和 expires = 9875067805，然后我尝试查询该用户的数据

[https://graph.facebook.com/me?access_token=XXXXXXXXXXXXXXXXX](https://graph.facebook.com/me?access_token=XXXXXXXXXXXXXXXXX)

最终结果是比公开可用的数据更多，但我仍然无法访问用户墙数据。我想做的另一件事是将它与无限会话密钥一起使用，这样一旦用户这样做，他们就可以继续访问他们的数据，但我可以稍后解决，提前感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:48:40.843

您是否`/me/feed`正确访问，如果是，您在访问时是否收到错误消息，或者只是没有返回？

`/me/feed`应该为此工作。您还可以请求`/me/permissions`检查是否授予了正确的权限，这可能会帮助您解决问题

# actionscript-3 - 使用自定义字体时，如何在 TLFTextField 中居中文本？

> ID：10355840
> 
> 赞同：0
> 
> 时间：2012-04-27T18:20:00.833
> 
> 标签：actionscript-3, flash-cs5

根据标题，我该怎么做？这是一个反映我的场景的最小工作示例：

```
import fl.text.TLFTextField;
import flashx.textLayout.formats.*;
import flashx.textLayout.elements.TextFlow;
import flashx.textLayout.edit.*;

var tf:TLFTextField = new TLFTextField();
tf.embedFonts = true;
tf.text = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean suscipit semper viverra.';
var format:TextLayoutFormat = new TextLayoutFormat();
format.fontFamily = 'MyPlainFont';
format.fontLookup = FontLookup.EMBEDDED_CFF;    
format.fontSize = 14;
format.textAlign = TextAlign.CENTER;

var editManager:EditManager = new EditManager();
var sel:SelectionState = new SelectionState(tf.textFlow, 0, 86);
tf.textFlow.interactionManager = editManager;
editManager.applyLeafFormat(format, sel);

var format2:TextLayoutFormat = new TextLayoutFormat();
format2.fontFamily = 'MyBoldFont';
format2.fontLookup = FontLookup.EMBEDDED_CFF;
format2.fontSize = 14;
format2.textAlign = TextAlign.CENTER;
var sel2:SelectionState = new SelectionState(tf.textFlow, 0, 20);
editManager.applyLeafFormat(format2, sel2);

tf.width = 100;
tf.wordWrap = true;

addChild(tf); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T16:55:02.083

对于普通的 TextFields，您必须在添加文本之前指定格式，否则它不适用，尝试过吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-06T01:56:15.017

下面的代码将解决您的问题。就像 Sidrich 说的，**总是最后设置 text 属性！我还添加了 autoSize 属性，因为如果不设置它，我会看到一些奇怪的定位故障。**

```
import fl.text.TLFTextField;
import flashx.textLayout.formats.TextLayoutFormat;
import flashx.textLayout.edit.EditManager;
import flashx.textLayout.formats.TextAlign;
import flashx.textLayout.edit.SelectionState;
import flash.text.TextFieldAutoSize;

var tf:TLFTextField = new TLFTextField();
tf.embedFonts = true;
tf.border = true;

var format:TextLayoutFormat = new TextLayoutFormat();
format.fontFamily = 'MyPlainFont';
format.fontLookup = FontLookup.EMBEDDED_CFF;    
format.fontSize = 14;
format.textAlign = TextAlign.CENTER;
var editManager:EditManager = new EditManager();
var sel:SelectionState = new SelectionState(tf.textFlow, 0, 86);
tf.textFlow.interactionManager = editManager;
editManager.applyLeafFormat(format, sel);

var format2:TextLayoutFormat = new TextLayoutFormat();
format2.fontFamily = 'MyBoldFont';
format2.fontLookup = FontLookup.EMBEDDED_CFF;
format2.fontSize = 14;
format2.textAlign = TextAlign.CENTER;
var sel2:SelectionState = new SelectionState(tf.textFlow, 0, 20);
editManager.applyLeafFormat(format2, sel2);

tf.width = 100;
tf.wordWrap = true;
tf.autoSize = TextFieldAutoSize.CENTER;
tf.text = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean suscipit semper viverra.';

addChild(tf); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T09:47:58.580

我有同样的问题我已经实现了 [http://flashthusiast.com/2010/05/05/getting-started-with-the-tlftextfield-class-in-actionscript-3-0-and-flash-cs5/comment-page -1/#comment-72699](http://flashthusiast.com/2010/05/05/getting-started-with-the-tlftextfield-class-in-actionscript-3-0-and-flash-cs5/comment-page-1/#comment-72699)

并刚刚添加`textAlign='center'`到段落标签以进入中心。

它属于 tlf flashx text-formats 的文本格式

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flashx/textLayout/formats/TextAlign.html#CENTER](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flashx/textLayout/formats/TextAlign.html#CENTER)

# ruby-on-rails - 在 HAML 中混合表单和布局标签

> ID：10355843
> 
> 赞同：1
> 
> 时间：2012-04-27T18:20:03.747
> 
> 标签：ruby-on-rails, haml

我有一个表单（Rails）并希望将提交从表单字段中分离到一个单独的 DIV 中：

```
.row
  .span
    = form_for [@household, @payment], do |h|
      %fieldset
        = h.label :lastname
        = h.text_field :lastname
        -# etc etc

  .span
    = h.submit "Submit" 
```

Haml 缩进规则说“提交”标签必须距离“.span”2 个空格。但这破坏了表单，它希望它与“%fieldset”在同一级别上缩进。

我怎样才能让这个表单在两个 DIV 上分裂？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:23:55.277

试试这个把你的提交放在字段集之外：

```
.row
    = form_for [@household, @payment], do |h|
        %fieldset.span
            = h.label :title
            = h.text_field :title
            -# etc etc

        .span
            = h.submit "Submit" 
```

顺便说一句，如果你认为没有办法让你的模板更简洁，那么看看[slim](http://slim-lang.com/)。

# java - 为什么 java.text.DateFormat 在 Android 上为 en_US 和 en_GB 返回相同的日期格式？

> ID：10355847
> 
> 赞同：10
> 
> 时间：2012-04-27T18:20:39.773
> 
> 标签：java, android, locale, date-format

我有一个小型 Android 应用程序，用于根据区域设置以不同格式打印特定日期。

这是我的代码（使用`java.text.DateFormat`）：

```
Locale[] locales = {new Locale("en", "US"), new Locale("en", "GB"), new Locale("en", "AU"), new Locale("en", "NZ"), new Locale("en", "ZA")};
for(int i = 0; i < locales.length; ++i) {
    Log.d(logKey, locales[i].toString() + " - " + DateFormat.getDateInstance(DateFormat.SHORT, locales[i]).format(Calendar.getInstance().getTime()));
} 
```

因此，LogCat 中的输出为：

```
D/FormatPoC(  390): en_US - 4/27/12
D/FormatPoC(  390): en_GB - 4/27/12
D/FormatPoC(  390): en_AU - 4/27/12
D/FormatPoC(  390): en_NZ - 4/27/12
D/FormatPoC(  390): en_ZA - 4/27/12 
```

所以我的问题是——为什么所有这些都是一样的？在 Java SE 中，我得到：

```
en_US - 4/27/12
en_GB - 27/04/12
en_AU - 27/04/12
en_NZ - 27/04/12
en_ZA - 2012/04/27 
```

这是我所期望的。我知道我可以`android.text.format.DateFormat`根据用户的当前语言环境和日期顺序设置来获得正确的结果，但这并不能解释为什么使用`java.text.DateFormat`获取以编程方式指定的语言环境的格式不会返回正确的结果。

此外，它不仅仅是`SHORT`日期格式 -`MEDIUM`并且还`LONG`显示了 Android 和 Java SE 之间的不一致（即，Android 对我指定的所有 5 个区域设置返回相同的格式）。

我已经在 3 种不同的设备（2.3 和 4.0）和模拟器（2.3 和 4.0）上对其进行了测试，结果都相同。我还测试了使用`Locale.US`and`Locale.UK`只是为了看看它们是否有所不同，但结果是一样的。

有没有其他人遇到过这个，或者知道为什么会这样？

**更新：2012-07-18**

这似乎是模拟器以及美国制造的许多设备的问题。使用 Dalvik 资源管理器：

[https://play.google.com/store/apps/details?id=org.jessies.dalvikexplorer&hl=en](https://play.google.com/store/apps/details?id=org.jessies.dalvikexplorer&hl=en)

我已经能够看到系统在不同设备（包括模拟器）上为 en_GB 返回了什么。有些返回适当的格式，有些返回 en_US 格式。我认为这只是每个设备的操作系统中内置了哪些格式资源的问题，尽管*模拟器*返回错误的格式以及我的许多美国制造的设备，我想知道英国开发人员的想法，或者他们是否见过这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T15:06:11.483

这不是答案（我还没有足够的代表来添加评论......）

作为一名英国开发人员，我遇到了这个问题。正如您所描述的，我在 Galaxy S3 上看到了这个问题。

我不得不求助于允许用户选择日期格式作为首选项。不是很好。

DalvikExplorer 程序也显示了这个问题：

![在此处输入图像描述](../Images/396fe67f4d6c04c5a37f3cc84c353084.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:28:35.477

尝试这个：

```
 int style = DateFormat.MEDIUM;
    //Also try with style = DateFormat.FULL and DateFormat.SHORT
    Date date = new Date();
    DateFormat df;
    df = DateFormat.getDateInstance(style, Locale.UK);
    Log.d("Locale.UK","Locale.UK - "+df.format(date));
    System.out.println("United Kingdom: " + df.format(date));
    df = DateFormat.getDateInstance(style, Locale.US);
    Log.d("Locale.US","Locale.US - "+df.format(date));
    df = DateFormat.getDateInstance(style, Locale.FRANCE);
    Log.d("Locale.FRANCE","Locale.FRANCE - "+df.format(date));
    df = DateFormat.getDateInstance(style, Locale.ITALY);
    Log.d("Locale.ITALY","Locale.ITALY - "+df.format(date));
    df = DateFormat.getDateInstance(style, Locale.JAPAN);
    Log.d("Locale.JAPAN","Locale.JAPAN - "+df.format(date)); 
```

# android - Android 下拉“命令”菜单

> ID：10355848
> 
> 赞同：0
> 
> 时间：2012-04-27T18:20:42.627
> 
> 标签：android, android-widget

我想使用一个下拉菜单让用户选择一个动作（在这种情况下，他们从列表中选择一些项目，并使用菜单选择“删除”、“移动”等）

Spinner 的工作方式非常接近我想要的，除了 Spinner 显然是为选择一些数据而设计的，而不是发出命令。

*   在单击之前，我希望下拉菜单看起来像一个箭头（没有用于显示“当前选定”数据的相邻空间
*   理想情况下，下拉菜单会出现在箭头的正下方，而不是屏幕中间。
*   菜单中的项目不应该有一个单选按钮来指示它们是否被选中

有没有比 Spinner 更合适的组件，或者我应该通过调整 Spinner 来实现这些目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:24:50.393

你应该使用[ContextMenu](http://developer.android.com/reference/android/view/ContextMenu.html)来做你正在寻找的东西。在开发指南中有一个关于菜单的[页面](http://developer.android.com/guide/topics/ui/menus.html#context-menu)和一个关于 ContextMenus 的部分，这将有助于实现。如果您花一些时间为这个菜单设置皮肤，您可以更改外观以匹配您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:29:41.557

可能我没有得到你，但你可以使用**你**可以根据需要处理的操作表

# google-maps - 谷歌地图信息窗口自动更新

> ID：10355852
> 
> 赞同：1
> 
> 时间：2012-04-27T18:21:13.283
> 
> 标签：google-maps, google-maps-api-3, auto-update, infowindow

我有一个应用程序，我需要在其中`infowindow`自动更新气泡中的数据。我已经检查过了，我看到了移动标记、更新标记颜色等的方法，但没有直接更新 infowindow 内容。我正在`building[i][7]`从内容自动更新的隐藏 DOM 元素中提取必要的值（例如 ），并且我需要 infowindow 的内容与它一起自动更新。

这是我用来绘制`infowindow`气泡的代码。

```
infowindow=new google.maps.InfoWindow();
for (i=0;i<buildings.length;i++){
    marker=new google.maps.Marker({
        position:new google.maps.LatLng(buildings[i][4],buildings[i][5]),
        map:map,
        shadow:shadow,
        icon:greenIcon,
        title:buildings[i][0]+" \n"+buildings[i][1],
        zIndex:buildings[i][6]
    });
}
google.maps.event.addListener(marker,'click',(function(marker,i){
    return function(){
        infowindow.setContent(
            '<h2>'+buildings[i][0]+'</h2>'+
            '<p>'+buildings[i][2]+'</p>'+
            '<p>'+buildings[i][7]+'</p>'
        );infowindow.open(map,marker);
    }
})(marker,i)); 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T23:12:58.290

JavaScript 中没有内置方法可以在内容`DIV`更改时收到通知，但我相信[jQuery.bind()](http://api.jquery.com/bind/)函数或更新的 (jQuery v1.7) [jQuery.on()](http://api.jquery.com/on/)函数提供了一种方法实现你想要达到的目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:24:22.073

在功能调用上运行

```
 infowindow.setContent(
        '<h2>'+buildings[i][0]+'</h2>'+
        '<p>'+buildings[i][2]+'</p>'+
        '<p>'+buildings[i][7]+'</p>'
    );infowindow.open(map,marker); 
```

# mongoid - cancan access_by w/ mongoid 标准语法

> ID：10355854
> 
> 赞同：1
> 
> 时间：2012-04-27T18:21:19.430
> 
> 标签：mongoid, cancan

我有一个用 mongoid 标准定义的能力，它没有填充 mongoid 标准选择器。

```
can :manage, Number, :issuer_id.in => user.owner_of.map{ |p| p.id } 
```

返回

```
-> Number.accessible_by(Ability.new(user))
=> #<Mongoid::Criteria
  selector: {},
  options:  {},
  class:    Number,
  embedded: false> 
```

如果我直接用相同的条件查询 mongoid

```
-> Number.where(:issuer_id.in => user.owner_of.map{ |p| p.id })
=> #<Mongoid::Criteria
  selector: {:issuer_id=>{"$in"=>[BSON::ObjectId('4f9ae0f1e1607c7a67000002')]}},
  options:  {},
  class:    Number,
  embedded: false> 
```

能力实例返回...

```
-> Ability.new(user)
=> #<Ability:0x007f8c9d0c1030 @rules=[
     #<CanCan::Rule:0x007f8c9a5b0210
       @match_all=false,
       @base_behavior=true,
       @actions=[:manage],
       @subjects=[Number],
       @conditions={issuer_id=>[BSON::ObjectId('4f9ae0f1e1607c7a67000002')]},
       @block=nil
     >
   ]> 
```

我尝试过以多种方式定义我的能力

```
can :manage, Number, :issuer => { :owner_id => user.id }
can :manage, Number, :issuer_id.in => user.owner_of.map{ |p| p.id }
can :manage, Number, :issuer_id => { "$in" => user.owner_of.map{ |p| p.id }} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T00:34:32.287

解决了。`user.owner_of.map{ |p| p.id }`正在返回一个 BSON 对象数组。我需要一个字符串数组。`user.owner_of.map{ |p| p.id.to_s }`解决了。啊！

# node.js - 如何将二进制数据附加到 node.js 中的缓冲区

> ID：10355856
> 
> 赞同：95
> 
> 时间：2012-04-27T18:21:23.010
> 
> 标签：node.js, binary, append, buffer

我有一个包含一些二进制数据的缓冲区：

```
var b = new Buffer ([0x00, 0x01, 0x02]); 
```

我想追加`0x03`.

如何附加更多二进制数据？我在文档中搜索，但是对于附加数据，它必须是一个字符串，如果不是，则会发生错误（*TypeError: Argument must be a string*）：

```
var b = new Buffer (256);
b.write ("hola");
console.log (b.toString ("utf8", 0, 4)); //hola
b.write (", adios", 4);
console.log (b.toString ("utf8", 0, 11)); //hola, adios 
```

然后，我在这里看到的唯一解决方案是为每个附加的二进制数据创建一个新缓冲区，并将其复制到具有正确偏移量的主缓冲区：

```
var b = new Buffer (4); //4 for having a nice printed buffer, but the size will be 16KB
new Buffer ([0x00, 0x01, 0x02]).copy (b);
console.log (b); //<Buffer 00 01 02 00>
new Buffer ([0x03]).copy (b, 3);
console.log (b); //<Buffer 00 01 02 03> 
```

但这似乎有点低效，因为我必须为每个追加实例化一个新缓冲区。

您知道附加二进制数据的更好方法吗？

**编辑**

我编写了一个[BufferedWriter](https://github.com/Gagle/Node-BufferedWriter)，它使用内部缓冲区将字节写入文件。与[BufferedReader](https://github.com/Gagle/Node-BufferedReader)相同，但用于写入。

一个简单的例子：

```
//The BufferedWriter truncates the file because append == false
new BufferedWriter ("file")
    .on ("error", function (error){
        console.log (error);
    })

    //From the beginning of the file:
    .write ([0x00, 0x01, 0x02], 0, 3) //Writes 0x00, 0x01, 0x02
    .write (new Buffer ([0x03, 0x04]), 1, 1) //Writes 0x04
    .write (0x05) //Writes 0x05
    .close (); //Closes the writer. A flush is implicitly done.

//The BufferedWriter appends content to the end of the file because append == true
new BufferedWriter ("file", true)
    .on ("error", function (error){
        console.log (error);
    })

    //From the end of the file:
    .write (0xFF) //Writes 0xFF
    .close (); //Closes the writer. A flush is implicitly done.

//The file contains: 0x00, 0x01, 0x02, 0x04, 0x05, 0xFF 
```

**最后更新**

使用[连接](http://nodejs.org/api/buffer.html#buffer_class_method_buffer_concat_list_totallength)。

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2012-04-27T18:47:05.027

## 更新了 Node.js 的答案 ~>0.8

Node 现在能够自行[连接缓冲区](http://nodejs.org/api/buffer.html#buffer_class_method_buffer_concat_list_totallength)。

```
var newBuffer = Buffer.concat([buffer1, buffer2]); 
```

## Node.js 的旧答案 ~0.6

我使用一个模块来添加一个`.concat`功能，其中包括：

[https://github.com/coolaj86/node-bufferjs](https://github.com/coolaj86/node-bufferjs)

我知道这不是一个“纯粹的”解决方案，但它非常适合我的目的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-27T18:41:06.870

缓冲区始终具有固定大小，没有内置的方法可以动态调整它们的大小，因此将其复制到更大的缓冲区的方法是唯一的方法。

但是，为了提高效率，您可以使缓冲区大于原始内容，因此它包含一些“空闲”空间，您可以在其中添加数据而无需重新分配缓冲区。这样你就不需要创建一个新的 Buffer 并在每个追加操作中复制内容。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-08-20T12:51:26.267

这是为了帮助任何来到这里寻找想要一种纯粹方法的解决方案的人。我建议理解这个问题，因为它可能发生在很多不同的地方，而不仅仅是 JS Buffer 对象。通过了解问题存在的原因以及如何解决它，您将提高您在未来解决其他问题的能力，因为这个问题非常重要。

对于我们这些必须用其他语言处理这些问题的人来说，设计一个解决方案是很自然的，但是有些人可能没有意识到如何抽象出复杂性并实现一个普遍有效的动态缓冲区。下面的代码可能有进一步优化的潜力。

*我没有实现 read 方法以使示例保持较小的大小。*

C（或任何处理内在分配的语言）中的`realloc`函数不保证在不移动现有数据的情况下扩展分配的大小 - 尽管有时是可能的。因此，当需要存储未知数量的数据时，大多数应用程序将使用如下方法而不是不断地重新分配，除非重新分配非常罕见。这本质上是大多数文件系统处理将数据写入文件的方式。文件系统只是分配另一个节点并将所有节点链接在一起，当您从中读取时，复杂性被抽象掉，因此文件/缓冲区似乎是一个连续的缓冲区。

*对于那些希望了解仅仅提供高性能动态缓冲区的困难的人，您只需查看下面的代码，并研究内存堆算法以及内存堆如何为程序工作。*

出于性能原因，大多数语言将提供固定大小的缓冲区，然后提供另一个大小动态的版本。一些语言系统选择了第三方系统，它们将核心功能保持在最低限度（核心分发），并鼓励开发人员创建库来解决附加或更高级别的问题。这就是为什么您可能会质疑为什么一种语言不提供某些功能。这个小的核心功能可以降低维护和增强语言的成本，但是您最终不得不编写自己的实现或依赖第三方。

```
var Buffer_A1 = function (chunk_size) {
    this.buffer_list = [];
    this.total_size = 0;
    this.cur_size = 0;
    this.cur_buffer = [];
    this.chunk_size = chunk_size || 4096;

    this.buffer_list.push(new Buffer(this.chunk_size));
};

Buffer_A1.prototype.writeByteArrayLimited = function (data, offset, length) {
    var can_write = length > (this.chunk_size - this.cur_size) ? (this.chunk_size - this.cur_size) : length;

    var lastbuf = this.buffer_list.length - 1;

    for (var x = 0; x < can_write; ++x) {
        this.buffer_list[lastbuf][this.cur_size + x] = data[x + offset];
    }

    this.cur_size += can_write;
    this.total_size += can_write;

    if (this.cur_size == this.chunk_size) {
        this.buffer_list.push(new Buffer(this.chunk_size));
        this.cur_size = 0;
    }

    return can_write;
};

/*
    The `data` parameter can be anything that is array like. It just must
    support indexing and a length and produce an acceptable value to be
    used with Buffer.
*/
Buffer_A1.prototype.writeByteArray = function (data, offset, length) {
    offset = offset == undefined ? 0 : offset;
    length = length == undefined ? data.length : length;

    var rem = length;
    while (rem > 0) {
        rem -= this.writeByteArrayLimited(data, length - rem, rem);
    }
};

Buffer_A1.prototype.readByteArray = function (data, offset, length) {
    /*
        If you really wanted to implement some read functionality
        then you would have to deal with unaligned reads which could
        span two buffers.
    */
};

Buffer_A1.prototype.getSingleBuffer = function () {
    var obuf = new Buffer(this.total_size);
    var cur_off = 0;
    var x;

    for (x = 0; x < this.buffer_list.length - 1; ++x) {
        this.buffer_list[x].copy(obuf, cur_off);
        cur_off += this.buffer_list[x].length;
    }

    this.buffer_list[x].copy(obuf, cur_off, 0, this.cur_size);

    return obuf;
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-31T11:38:12.503

将字节插入特定位置。

```
insertToArray(arr,index,item) {
   return Buffer.concat([arr.slice(0,index),Buffer.from(item,"utf-8"),arr.slice(index)]);
} 
```

# haskell - 为什么字符串不是枚举？

> ID：10355862
> 
> 赞同：4
> 
> 时间：2012-04-27T18:22:02.027
> 
> 标签：haskell

为什么是`[Char]`的实例`Ord`，而不是的实例`Enum`？

```
Prelude> let succ_a = "a" ++ [minBound::Char]
Prelude> "a" < succ_a
True
Prelude> succ_a < "a "
True
Prelude> succ_a < succ_a ++ [minBound::Char]
True 
```

我认为“a”和 - 之间没有字符串，那`succ_a`为什么不`succ "a" == succ_a`呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-27T19:24:21.297

由于字符串是 Haskell 中的列表，您不妨问一下为什么列表不在 中`Enum`，因为您不能只为没有扩展的字符串编写实例。但这没关系。问题是**按字典顺序的枚举不是很有用**，因为您只是无限期地在末尾附加最小的字符。

为简单起见，使用字母表`a..z`，字典顺序只是让我们重复第一个字母。

```
"", "a", "aa", "aaa", "aaaa", "aaaaa" ... 
```

枚举字符串更有用的顺序是按长度。这样，我们首先得到空字符串，然后是长度为 1 的所有字符串，然后是长度为 2 的所有字符串，以此类推。

```
"", "a", "b", ... "z", "aa", "ba", ... "za", "ab", ... "zz", "aaa", "baa" ... 
```

这本质上与枚举整数相同，只是数字颠倒了，所以当你到达时，`"zz"`你进位并得到`"aaa"`，就像从 99 到 100 一样。

但是，这与`Ord`使用字典顺序的列表的实例不一致。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-27T18:47:03.980

免责声明：我对 Haskell 了解不多。

但是，从[http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Enum](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Enum)看来，枚举必须支持 toEnum 和 fromEnum 才能从枚举类型转换为再次返回。这对字符串有什么作用？如果`succ_a = "a" ++ [minBound::Char]`，则任何 Int 都映射到一个字符串“a”，并附加了一些`minBound::Char`' （或者更实际地，任何 Int`n`映射到一个`n`仅包含的大小列表`minBound::Char`）。因此，“b”不会映射到任何 Int。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-27T18:24:12.640

首先，你对“a”和“aa”是错误的：

```
Prelude> "a" < "aA" && "aA" < "aa"
True 
```

“foo”之后的下一个字符串是什么？是“fop”吗？是“福阿”吗？是“foo\0”吗？

# java - 根据 GWT 中的浏览器用户代理更改 UiTemplate

> ID：10355864
> 
> 赞同：1
> 
> 时间：2012-04-27T18:22:09.267
> 
> 标签：java, css, gwt, user-agent, uibinder

我一直在开发一个将被 iPad 和桌面浏览器使用的 Web 应用程序。我创建了两个具有相同字段的 UiBinder 模板，只是使用不同的 CSS 重新排列不同。

当检测到移动浏览器的用户代理时，有没有办法让 GWT 自动使用不同的 UiTemplate？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-13T16:25:33.143

您可能想看看 m-gwt ( [http://www.m-gwt.com](http://www.m-gwt.com) )。这是 GWT 的移动小部件库。

# java - 使用继承的类创建 Jar 文件

> ID：10355876
> 
> 赞同：0
> 
> 时间：2012-04-27T18:23:16.927
> 
> 标签：java, inheritance, jar

我的 Program.java 是这样声明的类：

```
public class Program extends JFrame {
... 
```

该程序编译并运行得很好，但是当我创建一个 jar 文件时，我收到了这个错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: Program/jar
Caused by: java.lang.ClassNotFoundException: Program.jar
at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
at java.lang.ClassLoader.loadClass(ClassLoader.java:266) 
```

这是我创建 jar 文件的方式（Linux）：

```
javac Program.java
echo Main-Class: Program >manifest.txt
jar cvfm Program.jar manifest.txt Program.class 
```

这是因为我没有在我的 jar 创建中包含 JFrame.class 吗？如果是这样，JFrame 的源是否可用，以便我可以包含它？

谢谢你，祝你好运！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:30:47.583

您需要寻找以下内容：

*   您的 jar 文件包含 META-INF 上的清单文件
*   该清单文件包括主类。
*   您的 .class 文件位于相应的文件夹中。
*   你的主类有一个`public static void main(String[] args)`方法。

然后你应该能够通过调用来运行程序

```
java -jar yourjar.jar 
```

干杯。

# .net - WCF 中 NetPeerTcpBinding 的替代方案

> ID：10355878
> 
> 赞同：13
> 
> 时间：2012-04-27T18:23:23.970
> 
> 标签：.net, wcf

[自 .NET 4.5 起， NetPeerTcpBinding](http://msdn.microsoft.com/en-us/library/system.servicemodel.netpeertcpbinding(v=vs.110).aspx)已过时。我想知道.NET 项目有哪些可行的替代方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T19:04:32.863

看看[Mesh.Net](http://eigenein.info/mesh-net/)，它是一个开源项目，旨在取代 PeerToPeer 绑定，因为 MSFT 不再支持它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T19:23:52.003

虽然从技术上讲不是一个答案，但也许我们可以让 MS 将它留在框架中。请到这里投票！

[https://connect.microsoft.com/VisualStudio/feedback/details/776917/netpeertcpbinding-and-other-classes-have-been-marked-obsolete-in-net-4-5-please-restore-them#details](https://connect.microsoft.com/VisualStudio/feedback/details/776917/netpeertcpbinding-and-other-classes-have-been-marked-obsolete-in-net-4-5-please-restore-them#details)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T20:28:56.717

这绝对是令人不安的，因为我也在考虑开发一个利用它的解决方案。到目前为止，我发现的唯一可行的解​​决方案是由高通公司赞助的[AllJoyn 。](https://www.alljoyn.org/)AllJoyn 的问题在于，除了 WinRT 应用程序之外，Windows 支持仅限于本机 C/C++ 实现，因此不支持 .NET（除非您愿意使用 P/Invoke 自己移植它）。

# c# - 压缩流显示为空

> ID：10355880
> 
> 赞同：0
> 
> 时间：2012-04-27T18:23:30.740
> 
> 标签：c#, gzip, memorystream, gzipstream

我需要使用 GZip 按指定大小（而不是整体）压缩文件。我可以成功填充 byte[] 缓冲区，但是在将其复制到压缩流中之后，它只会使输出流为空。

```
public void Compress(string source, string output)
    {
        FileInfo fi = new FileInfo(source);
        byte[] buffer = new byte[BufferSize];
        int total, current = 0;
        using (FileStream inFile = fi.OpenRead())
        {
            using (FileStream outFile = File.Create(output + ".gz"))
            {
                while ((total = inFile.Read(buffer, 0, buffer.Length)) != 0)
                {
                    using (MemoryStream compressedStream = new MemoryStream())
                    {
                        using (MemoryStream bufferStream = new MemoryStream())
                        {
                            CopyToStream(buffer, bufferStream);
                            using (GZipStream Compress = new GZipStream(compressedStream, CompressionMode.Compress, true))
                            {
                                bufferStream.Position = 0;
                                bufferStream.CopyTo(Compress);
                                current += total;
                            }
                            compressedStream.Position = 0;
                            compressedStream.CopyTo(outFile);
                        }
                    }
                }
            }
        }
    }

    static void CopyToStream(byte[] buffer, Stream output)
    {
        output.Write(buffer, 0, buffer.Length);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:33:21.320

您需要通过在之前设置 Position=0 来倒带压缩流 `compressedStream.CopyTo(outFile);`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:40:40.100

您试图使事情过于复杂...您不需要额外的 MemoryStreams 或缓冲区...

取自 MSDN... [http://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream.aspx](http://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream.aspx)

```
public static void Compress(FileInfo fi)
    {
        // Get the stream of the source file.
        using (FileStream inFile = fi.OpenRead())
        {
            // Prevent compressing hidden and 
            // already compressed files.
            if ((File.GetAttributes(fi.FullName) 
                & FileAttributes.Hidden)
                != FileAttributes.Hidden & fi.Extension != ".gz")
            {
                // Create the compressed file.
                using (FileStream outFile = 
                            File.Create(fi.FullName + ".gz"))
                {
                    using (GZipStream Compress = 
                        new GZipStream(outFile, 
                        CompressionMode.Compress))
                    {
                        // Copy the source file into 
                        // the compression stream.
                    inFile.CopyTo(Compress);

                        Console.WriteLine("Compressed {0} from {1} to {2} bytes.",
                            fi.Name, fi.Length.ToString(), outFile.Length.ToString());
                    }
                }
            }
        }
    } 
```

# python - Python 2.7 未在 Cygwin 中加载

> ID：10355883
> 
> 赞同：1
> 
> 时间：2012-04-27T18:24:13.547
> 
> 标签：python, path, cygwin

我有一个问题，让我安装的 python27 在 Cygwin 中正确加载。我的安装有 2.6 `(/bin/python@ )`，但我希望默认 Python 环境为 2.7 ( `/cygdrive/c/Python27/python.exe`)。我知道如何更改我的 $PATH 和所有内容，但是当我尝试通过 Cygwin 运行这个 2.7 安装时，转到它的目录并输入`python`它永远不会加载；我必须用 CTRL-c 结束命令。这是 Cygwin 问题、Windows 问题还是我的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T20:15:38.823

I think you can find some answers in [this other question](https://stackoverflow.com/questions/3250749/using-windows-python-from-cygwin).

It is rather a problem of using the Windows version of Python with the Cygwin terminal.

Quick summary:

*   for interactive mode, add the -i option
*   if you want to see the output of your script, add the -u option.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T19:33:17.360

I faced the same problem with Python 2.7 on Cygwin. Launching Python with -i option did get me to the interpreter, but it would not allow the use of the "up" cursor key to repeat older commands.

What you need to do is to launch the /bin/bash.exe from a DOS prompt. This will launch the standard Windows console instead the Cygwin console.

[This](https://superuser.com/questions/365132/cygwin-terminals-dont-run-some-native-windows-programs) answer sums it up pretty well.

# sql - 查询未收集所有数据

> ID：10355885
> 
> 赞同：0
> 
> 时间：2012-04-27T18:24:15.810
> 
> 标签：sql, time

我创建了一个屏幕来显示来自查询的数据。该查询应该从一个过程中收集材料的日常生产。查询如下：

```
Select SUM(ltv.val) "CE" FROM LADLE_TAP_VALUE ltv, LADLE_TAP_ID lti where ltv.id=108 AND ltv.ladletapid =lti.ladletapid and lti.tapid IN (Select ti.TapID FROM tap_index ti WHERE ti.tapno like 'CE%' AND ti.starttime>=to_date('20120426', 'yyyymmdd hh24:mi:ss') and ti.endtime<=to_date('20120427 00:00:00', 'yyyymmdd hh24:mi:ss')); 
```

我面临的问题是，有时开始时间接近一天结束，而结束时间是在第二天的第一个小时。我不确定如何使用查询的时间处理部分进行调整。这是一个问题，因为我每天都会错过我的显示器上应该存在的产品。

```
tap_index table
tapid tapno plant taphole drytap status startime endtime slagstart readytime 
21437   CN121348    1   1   1   0   26-APR-12 06:00:26  26-APR-12 07:42:41  26-APR-12 06:56:34  26-APR-12 06:00:00
21436   CE121347    1   2   1   0   26-APR-12 03:21:10  26-APR-12 05:40:48  26-APR-12 04:39:27  26-APR-12 03:21:00
21435   CN121346    1   1   1   0   26-APR-12 01:48:07  26-APR-12 03:01:23  26-APR-12 02:27:34  26-APR-12 01:48:00
21434   CE121345    1   2   1   0   25-APR-12 23:27:23  26-APR-12 01:28:08  26-APR-12 00:44:09  25-APR-12 23:27:00
21433   CN121344    1   1   1   0   25-APR-12 21:18:24  25-APR-12 23:07:17  25-APR-12 22:31:04  25-APR-12 21:18:00
21432   CE121343    1   2   1   0   25-APR-12 19:55:08  25-APR-12 20:58:59  25-APR-12 20:22:39  25-APR-12 19:55:00
21431   CN121342    1   1   1   0   25-APR-12 18:09:28  25-21422    CE121333    1   2   1   0   24-APR-12 22:56:17  25-APR-12 00:29:23  24-APR-12 23:32:27  24-APR-12 22:56:00 
```

21421 CN121332 1 1 1 0 24-APR-12 20:49:25 24-APR-12 22:36:37 24-APR-12 21:59:30 24-APR-12 20:49:00 21420 CE121331 1 2 1 0 24-APR-12 18:15:12 24-APR-12 20:30:16 24-APR-12 19:19:42 24-APR-12 18:15:00 21419 CN121330 1 1 1 0 24- APR-12 16:06:06 24-APR-12 17:55:12 24-APR-12 17:02:33 24-APR-12 16:06:00 21418 CE121329 1 2 1 0 24-APR-12 14 :04:36 24-APR-12 15:44:40 24-APR-12 14:50:33 24-APR-12 14:04:00

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T18:32:28.083

您似乎正在尝试提取给定日期的所有记录。通常，最好的方法是使用以下逻辑构造查询：

*   DateField < trunc(:EndDate) + 1：获取 EndDate 后一天之前的所有记录
*   DateField >= trunc(:StartDate): 在 StartDate 开始时或之后获取所有记录

我提到“trunc”，因为像这样的查询的参数化输入通常包括时间部分。trunc 从日期中删除时间部分。

在您的示例中，我想查询可以如下所示 - 我只是将“ti.endtime”更改为使用“<”而不是“<=”，这样您就不会从 4 月 27 日开始获得记录。

```
Select SUM(ltv.val) "CE" 
  FROM LADLE_TAP_VALUE ltv, LADLE_TAP_ID lti 
 where ltv.id=108 
   AND ltv.ladletapid =lti.ladletapid 
   and lti.tapid IN (Select ti.TapID 
                       FROM tap_index ti 
                      WHERE ti.tapno like 'CE%' AND ti.starttime>=to_date('20120426', 'yyyymmdd hh24:mi:ss') and ti.endtime < to_date('20120427 00:00:00', 'yyyymmdd hh24:mi:ss')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:40:18.907

`ti.starttime >= $start and ti.endtime <= $end`选择完全适合 [$start..$end] 的所有跨度。

`ti.endtime >= $start and ti.starttime <= $end`将以某种方式选择与 [$start..$end] 相交的所有跨度。

# python - 如何重置 pycurl 对象中的 HTTPHEADERs？

> ID：10355893
> 
> 赞同：0
> 
> 时间：2012-04-27T18:24:56.370
> 
> 标签：python, pycurl

我设置了一些额外的标题使用

```
c.setopt(self.c.HTTPHEADER, ['Accept: */*', ..., ...]) 
```

现在我想要的是在不破坏 pycurl 对象或关闭会话的情况下重置/清除该标题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T21:14:42.030

您可以重置标头，将其值设置为空白字符串

```
                        # 删除 2 个标题并保留其他标题
c.setopt(self.c.HTTPHEADER, ["User-Agent:","Accept:"])

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-04T21:12:44.120

您可以通过以下方式轻松做到这一点：

```
c.reset() 
```

# javascript - 使 onKeyDown 触发 HTML 按钮的 onClick 事件

> ID：10355895
> 
> 赞同：0
> 
> 时间：2012-04-27T18:24:59.890
> 
> 标签：javascript, html, javascript-events

我有一个名为 Calculator 的基本 HTML 表单，带有一个名为“btnOne”的按钮。我想要的是当用户按下键盘上的“1”键时，“btnOne”HTML 按钮的 onClick 事件就会发生。

为了尝试实现这一点，我将此函数放置在文档的 Head 标记中：

```
<head>
     <SCRIPT LANGUAGE="JavaScript"> 

         //other functions...

        document.onkeydown = function(e){
            if (!e) e = window.event;
            if(e.keycode == '49') {
                document.Calculator.btnOne.click();
            }
            return false;
        }
      </SCRIPT>
</head> 
```

我只是把这个片段放在错误的地方吗？我还需要做些什么来使函数运行吗？我真的是网络开发的初学者，不知道自己在做什么！当然，一旦我弄清楚如何让这个按钮工作，我将为所有其他按钮添加 if 语句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:37:12.463

查看[http://api.jquery.com/category/events/](http://api.jquery.com/category/events/)以获得更简单和更简洁的编写方式。您所拥有的基本上是正确的，尽管您最好将其包装在文档就绪事件中，以便在 dom 加载*后绑定事件。*

使用 jQuery，您的代码看起来像这样

```
jQuery(function() {
    jQuery(window).keypress(function(e){
         if (e.which === 49) {
               jQuery("#btnOne").click();
         }
    });
}) 
```

继承人一个工作的 JS Fiddle 将证明这一点

[http://jsfiddle.net/HXYAD/](http://jsfiddle.net/HXYAD/)

但是，将 click 的事件处理程序抽象为参数化函数可能是个好主意，这样您就没有

```
 jQuery('#btnOne').click(function(){
     //some code
 });

 jQuery('#btnTwo').click(function(){
     //some similar code
 });     
 jQuery('#btnThree').click(function(){
     //some more similar code
 }); 
```

# mysql - 计算时间戳间隔平均值

> ID：10355896
> 
> 赞同：1
> 
> 时间：2012-04-27T18:25:00.383
> 
> 标签：mysql, timestamp, using, average, intervals

感谢您对此的帮助。

我正在尝试根据用户选择的间隔计算平均值，这些间隔是 5 的倍数。因此，用户可以在运行查询时一次选择 10 分钟的间隔，并且可以选择任何其他间隔，如 15、20、...直到其他跑步间隔 60 分钟。

输入文件具有 5 分钟间隔平均值的列。

假设这是输入文件 myTable

```
timestamp                     units     
4/25/2012 12:00:00 AM          50        
4/25/2012 12:00:05 AM          45
4/25/2012 12:00:10 AM          78
4/25/2012 12:00:15 AM          56
.                              .
.(in 5 mins increment)         .
.                              .
4/25/2012 12:00:50 AM          45
4/25/2012 12:00:55 AM          60
4/25/2012 1:00:00 AM           40
4/25/2012 1:00:05 AM           50
.                              . 
.                              .            
.                              .
4/25/2012 11:55:00 PM          39
.
. 
```

假设我们选择了 10 分钟的间隔。输出应该像

```
timestamp          Average
4/25/2012 0:00     50
4/25/2012 0:10     60.5   -- which is (45+ 78)/2
.
.
.
4/25/2012 0:50    .
4/25/2012 1:00    50 -- which is (60+40)/2
4/25/2012 1:10 
```

有什么建议么。谢谢！

我找到了一种使用 when then 对分钟进行分组的方法，它似乎适用于所有情况，除非下一个时间戳是下一小时。因此，在输入上表时，对于 4/25/2012 12:00:55 AM 60 4/25/2012 1:00:00 AM 40
我得到两行具有上述值而不是一个平均值。知道当时间更改为下一小时时如何解决此边界情况。

谢谢

# php - 是否有任何可能的方法来计算大于 php 中整数容量的数字？

> ID：10355897
> 
> 赞同：-1
> 
> 时间：2012-04-27T18:25:19.660
> 
> 标签：php, string, integer

出于某种原因，我需要处理 150 多个数字。我需要添加号码的数字。出于这个原因，我尝试将数字转换为字符串，但在 10 位数字后显示 EXP。这就是为什么我无法正确获取数字的原因。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:27:07.023

[是](http://www.php.net/manual/en/book.bc.php)的，[是](http://www.php.net/manual/en/book.gmp.php)的。

# java - 从文件中提取子序列 - Java - 快速方式

> ID：10355898
> 
> 赞同：0
> 
> 时间：2012-04-27T18:25:26.880
> 
> 标签：java

我有一个大文件，其中包含诸如“ABCDEabcde .....XYZxyz”之类的字符序列。现在，我想提取它的一些子序列。例如从第 10 个字符到第 50 个字符，从第 15 个字符到第 55 个字符（所有子序列具有相同的长度并且起始位置总是增加）。任何人都可以帮助我如何在 Java 中快速做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:37:07.963

您可以使用 MappedByteBuffer 并将文件作为字节缓冲区访问

[http://docs.oracle.com/javase/7/docs/api/java/nio/MappedByteBuffer.html](http://docs.oracle.com/javase/7/docs/api/java/nio/MappedByteBuffer.html)

```
RandomAccessFile raf = new RandomAccessFile(....);
FileChannel fc = raf.getChannel();

MappedByteBuffer mmap = fc.map(READ_ONLY, 0, fc.size() ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T19:04:47.787

为什么不尝试这样的事情：

```
BufferedReader br = new BufferedReader(new FileReader(<FileName>), int size); 
```

只需在此处输入缓冲区大小并继续检查您`subStrings`在该块中的大小。如果没有找到，丢弃它并转到下一个块。

# css - css last-child 匹配所有孩子

> ID：10355899
> 
> 赞同：7
> 
> 时间：2012-04-27T18:25:27.963
> 
> 标签：css, css-selectors

我正在尝试通过在每个链接的右侧创建一个边框来在我的链接之间创建一个分隔符。然后在最后一个上，将其删除。我有以下 html 和 css，但我发现每个“a”标签都与最后一个子选择器匹配。我不清楚为什么以及这样做的正确方法是什么。

```
<ul class="nav">
  <li><a href="#">link1</a></li>
  <li><a href="#">link2</a></li>
  <li><a href="#">link3</a></li>
  <li><a href="#">link4</a></li>
</ul>

.nav a { border-right:solid 1px #000;}
.nav a:last-child { border-right-width:0px;} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-27T18:27:42.000

那是因为每个`a`都是其 parent 的最后一个孩子`li`。你会想要类似的东西`.nav li:last-child a`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:27:52.337

你所有的`<a>`标签都是他们父母的最后一个孩子`<li>`

# git - 在 Git 中提交时使用 emacsclient -t

> ID：10355902
> 
> 赞同：16
> 
> 时间：2012-04-27T18:26:01.970
> 
> 标签：git, bash, shell, emacs

在我的`.bash_profile`中，我使用这个：

```
export EDITOR=emacsclient
alias e='emacsclient -t' 
```

当我使用 Git 提交更改时，它将打开一个新的 emacs 窗口，但带有`emacs --daemon`. 如何将我的默认 Git 编辑器设置为启用了 t 标志的 emacs？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-10T02:29:48.893

```
git config --global core.editor 'emacsclient -t -a=\"\"' 
```

如果还没有运行守护进程，这将启动一个守护进程。

您可能在使用引号时遇到问题，因为它在我的 .gitconfig 中显示为

```
[core]
    editor = emacsclient -t -a=\\\"\\\" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-03T16:34:03.630

```
export GIT_EDITOR="`which emacsclient` -t -s $EMACS_SERVER_FILE" 
```

在调用 EDITOR 或 GIT_EDITOR 之前，git 似乎与 PATH 变量混为一谈，因此即使通常会调用来自最新 Emacs 的 emacsclient，也会调用来自 /usr/bin 的内置 emacsclient。我通过从一个我相信有自己的环境的子进程获取可执行文件的路径来解决这个问题（无论它如何工作......）。

在 OS X 10.8.2 上测试，本地构建 Emacs 24.1，服务器运行，客户端通过套接字连接。

我还没有测试过 tcp 客户端。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T00:20:35.790

我通常不会说“阅读那本精美的手册”，但在这种情况下它只是适用。`git commit --help`关于这个话题有这样的说法：

```
ENVIRONMENT AND CONFIGURATION VARIABLES
   The editor used to edit the commit log message will be chosen
   from the GIT_EDITOR environment variable, the core.editor configuration
   variable, the VISUAL environment variable, or the EDITOR environment
   variable (in that order). See git-var(1) for details. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-04T07:59:39.353

真正的原因是emacs的版本。mac上有一个默认的emacs，该版本没有选项“-t”。另外，git似乎没有读取.bash_profile中的设置

# vb.net - 获取列表框中的选定项目并填充到文本框中

> ID：10355903
> 
> 赞同：0
> 
> 时间：2012-04-27T18:26:04.190
> 
> 标签：vb.net, listbox, listboxitems

好的，我目前有一个列表框，其中填充了各种文件。

我想做的是选择一个文件，单击添加按钮并将项目名称填充到该文本框中。

然后，选择另一个项目，单击添加按钮并将命名的项目填充到一个空文本框中。

我可以填充第一个文本框，但是一旦我选择了第二个项目，我就无法显示空文本框。

这是我当前如何填充第一个文本框的代码。注释掉的部分用于将这些项目添加到另一个列表框中，这有效，但我需要指定一个自定义顺序，我以为将每个项目添加到一个文本框中。

```
 Private Sub ButtonAdd_Click(sender As System.Object, e As System.EventArgs) Handles ButtonAdd.Click
    'Dim selectedItems = (From i In ListBox1.SelectedItems).ToArray()
    'For Each selectedItem In selectedItems
    'ListBox3.Items.Add(selectedItem)
    'ListBox1.Items.Remove(selectedItem)
    'Next

    TextBox1.Text = ListBox1.SelectedItem

    End Sub 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:59:17.303

我把一个快速的小演示放在一起。

首先是aspx页面：

```
<asp:ListBox id="lstItems" runat="server">
    <asp:ListItem>-- Select --</asp:ListItem>
    <asp:ListItem>Item 1</asp:ListItem>
    <asp:ListItem>Item 2</asp:ListItem>
    <asp:ListItem>Item 3</asp:ListItem>
    <asp:ListItem>Item 4</asp:ListItem>
</asp:ListBox>
<asp:Panel ID="pnlTextboxes" runat="server">
    <asp:TextBox ID="txt1" runat="server" />
    <asp:TextBox ID="txt2" runat="server" />
    <asp:TextBox ID="txt3" runat="server" />
    <asp:TextBox ID="txt4" runat="server" />
</asp:Panel>
<asp:Button id="btnAdd" Text="Add" runat="server" /> 
```

以及背后的代码：

```
Protected Sub btnAdd_Click(sender As Object, e As EventArgs) Handles btnAdd.Click
    If lstItems.SelectedIndex <= 0 Then
        Return
    End If
    For Each ctrl As Control In pnlTextboxes.Controls
        If TypeOf ctrl Is TextBox Then
            Dim txt = CType(ctrl, TextBox)
            If String.IsNullOrEmpty(txt.Text) Then
                txt.Text = lstItems.SelectedValue
                Exit For
            End If
        End If
    Next
End Sub 
```

请注意，如果您已经选择了该项目，这不会跟踪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:41:46.643

尝试这样的事情：

```
Private Sub ButtonAdd_Click(sender As System.Object, e As System.EventArgs) Handles ButtonAdd.Click
    If string.IsNullOrEmpty(TextBox1.Text) Then 
        TextBox1.Text = ListBox1.SelectedItem
    ElseIf string.IsNullOrEmpty(TextBox2.Text) Then 
        TextBox2.Text = ListBox1.SelectedItem
    ElseIf string.IsNullOrEmpty(TextBox3.Text) Then 
        TextBox3.Text = ListBox1.SelectedItem
    End If
End Sub 
```

# android - UDP数据报包接收循环延迟

> ID：10355906
> 
> 赞同：0
> 
> 时间：2012-04-27T18:26:23.970
> 
> 标签：android

我正在运行一个带有等待 UDP 数据包的活动循环的线程。

收到消息后，我想处理它。

我需要每秒接收几个数据包（~20）。

我举一个极简的例子，只是在接收到UDP数据包后记录

```
while (socketUDP != null) {
    message = new byte[6];
    packet = new DatagramPacket(message, message.length);

    try {
        socketUDP.receive(packet);
        command = new String (message, 0, packet.getLength());
    } catch (IOException e) {
        Log.e(LOG_TAG, LOG_TAG + " IOException: " + e.getMessage() );
    }

    Log.d(LOG_TAG, "test");
} 
```

这种行为很奇怪，因为，例如，我在 1 秒内发送了 50 个 UDP 数据包，没有人丢失，而 Android 需要大约 3/4 秒才能显示 50 条日志文本消息“测试”！

因此，似乎 Android 的 VM 将所有数据包保存在缓冲区中的某个位置，并在可能的情况下对其进行处理！

我需要尽快在 Android 中处理数据报的数据包。

看来我错过了什么。

有什么想法是最好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:47:32.303

如果你赶时间，那么：

*   在侦听 UDP 之前创建所有对象
*   在您完成接收所有数据包后记录，或者至少记录最少的数量，并且不经常记录。

现在，每次数据包到达时，您都会创建一个 DatagramPacket 和一个字符串，然后是 Log.e，所有这些都应该比接收数据包本身花费更多的时间。当然，即使经过优化，也无法保证实时交付。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-30T13:07:42.863

尝试 ping 正在发送数据包的设备。它帮助到我。例如，我在接收数据包之前使用此代码：

```
pingThread = new Thread(new Runnable() {
        @Override
        public void run() {
            Runtime runtime = Runtime.getRuntime();
            try {
                // Ping 10 times at 169.254.169.168
                runtime.exec("/system/bin/ping -c 10 169.254.169.168");
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    });
    pingThread.start(); 
```

之后，您可以致电：

```
socketUDP.receive(packet); 
```

# php - POST 控制器是否适用于 php mvc？

> ID：10355907
> 
> 赞同：0
> 
> 时间：2012-04-27T18:26:24.460
> 
> 标签：php, model-view-controller, class

我正在从头开始创建一个自定义 MVC 样式框架，现在我需要实现代码来控制在`POST`.

目前我有一个主 index.php 作为控制器并将数据传递给其他控制器，例如：

profilecontroller.class.php 论坛控制器.class.php

目前，我看到关于 POST 控制器可以去哪里的两个选项..

**第一种方法**

首先对于站点范围的帖子，例如可以在任何页面上发生的**登录**，我会在第一个 index.php 中使用类似的东西将所有 POST 重定向到特定的 POST 控制器，然后将数据发送到要处理的模型：

```
if($_POST)
    //post controller, works on specific form id's 
```

**替代方法**

我看到的另一个选择是将`POST`标识符构建到模型构建部分中，但我认为这不是非常易于管理/明智的，因为它们总是被检查并导致更多加载的代码？

那里有什么好的/简单的例子吗？

我正在创建我的 mvc 以使其尽可能轻，这就是我从头开始的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T18:45:00.650

在 RESTful 设置中，您通常会有一个对象的控制器，例如，`news`然后是、等操作。`add``edit``delete`

在您的操作中，您应该断言应该使用什么 HTTP 方法来访问该方法（如果应该使用的话）。例如：

```
<?php
class NewsController extends AbstractController {
    public function save() {
        if ($_SERVER['REQUEST_METHOD'] != 'POST') {
            header('HTTP/1.1 405 Method Not Allowed');
            die('Please use POST.');
        }
        // carry on knowing we're working with a POST request
    }
} 
```

正如您所说，为 POST 请求创建一个单独的控制器会很快变得不守规矩和难以管理。

如果您正在寻找一种在不同控制器操作中处理不同 HTTP 方法的请求的方法，那么不妨看看[ToroPHP](https://github.com/anandkunal/ToroPHP)。它是一个轻量级（单个文件）路由器，您可以将请求映射到称为处理程序的类，然后该处理程序具有用于不同 HTTP 方法的方法。一个简单的例子：

```
<?php

require 'lib/torophp/toro.php';
require 'classes/handlers/HomeHandler.php';

$toro = new ToroApplication(array(
    array('/', 'HomeHandler')
));
$toro->serve(); 
```

然后你`HomeHandler`会如下所示：

```
<?php
class HomeHandler {
    public function get() {
        echo 'Hello, world!';
    }
    public function post() {
        echo 'Try performing a GET request for the home page, buddy.';
    }
    // and so on...
} 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T18:28:48.707

这是我的默认控制器：

```
<?php
Class Controller_Home{
    public $Registery = null;

    final public function __construct($Registery){ $this->Registery = $Registery; }

    final public function Init($Method=null){
        # Quelle action on fait ?
        if($Method){
            $Split = explode('_', $Method);

            $MethodName = 'Action';
            foreach($Split as $Splitted){
                $MethodName.= '_'.ucfirst($Splitted);
            }

            if(method_exists($this, $MethodName)){
                $this->$MethodName();
            } else {
                echo '404';
                die;
            }
        } else {
            $this->Action_Default();
        }
    }

    final public function Action_Default(){
        $this->Registery->Import('Library.Account');

        var_dump($this->Registery->Account);
        echo 'Default Home';
    }
} 
```

如您所见，一旦您进入 Action_Default，您就可以根据 $_GET、$_POST 做任何您想做的事情......

因此，使用此代码：

website.com/home/bob/ 将使用`Action_Bob`控制器内的函数`Home`( `Home::Action_Bob`) ...如果你看到 $_POST 就放在`Action_Bob`这个里面

```
public function Action_Bob(){
    if($_POST){
        $this->Action_Bob_Post();
    }
    // continue
} 
```

# c# - C# 数据库问题

> ID：10355908
> 
> 赞同：0
> 
> 时间：2012-04-27T18:26:24.677
> 
> 标签：c#, sql, database, forms

有人可以告诉我为什么这不会将值添加到数据库中。表单运行良好，不返回任何错误。

```
 private void button1_Click(object sender, EventArgs e)
    {
        SqlConnection connection = new SqlConnection();
        SqlCommand command = new SqlCommand();

        connection.ConnectionString = (@"Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\John\Documents\Setup.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True");

        command.Parameters.AddWithValue("@userName", textBox1.Text);
        command.Parameters.AddWithValue("@passWord", textBox2.Text);
        command.CommandText = "INSERT INTO Setup (userName, password) VALUES(@userName, @passWord)";

        try
        {
            connection.Open();
            int rowsAffected = command.ExecuteNonQuery();

        }
        catch (Exception ex)
        {
            // handle exception
        }
        finally
        {
            connection.Close();
        }

    } 
```

仅供参考：我是“新手”我的数据库称为 Setup。我手动添加了一个名为 myTable 的表，其中包含 2 列 userName 和另一个名为 password 的表，两者都设置为 nchar(50)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T18:29:23.083

您需要指定`Table`，而不是数据库（在连接字符串中使用）。为表名添加了模式前缀：

```
command.CommandText = "INSERT INTO dbo.myTable (userName, password) VALUES (@userName, @passWord)"; 
```

并添加：

```
command.Connection = connection; 
```

将您的`Command`对象与连接对象相关联。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:46:45.820

您的代码应如下所示：

*   设置连接对象。
*   指定@LarsTech 提到的表名。
*   在指定表名时最好使用两部分表示法，例如`[Schema name].[Table Name]`. 所以，你必须指定你的表名，比如`dbo.MyTable`

*代码片段*：

```
private void button1_Click(object sender, EventArgs e)
{
    SqlConnection connection = new SqlConnection();
    connection.ConnectionString = (@"Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\John\Documents\Setup.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True;");

    SqlCommand command = new SqlCommand();
    command.Connection = connection;
    command.CommandText = "INSERT INTO dbo.MyTable  (userName, password) VALUES (@userName, @passWord)";
    command.Parameters.AddWithValue("@userName", textBox1.Text);
    command.Parameters.AddWithValue("@passWord", textBox2.Text);

    try
    {
        connection.Open();
        int rowsAffected = command.ExecuteNonQuery();
    }
    catch (Exception ex)
    {
        //handle exception
    }
    finally
    {
        connection.Close();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-27T18:37:05.647

> 表单运行良好，不返回任何错误。

那可能是因为你正在吞食它们。摆脱（或记录）您的`catch (Exception ex)`.

一般来说，.NET BCL 是经过精心设计的——如果一个方法不起作用，你会得到一个异常。

> [现在] 我有错误“ExecuteNonQuery：连接属性尚未初始化。”

正确的。您需要将 传递`SqlConnection`给`SqlCommand`：

```
SqlCommand command = new SqlCommand();
command.Connection = connection; 
```

# java - LWJGL 和光滑着色四边形不正确

> ID：10355909
> 
> 赞同：1
> 
> 时间：2012-04-27T18:26:30.190
> 
> 标签：java, lwjgl, slick2d

我正在为游戏引擎的地图编辑器开发基本 GUI。一切正常，除了程序仅将一些四边形着色为我想要的颜色（灰色），并将其他一些四边形着色为黑色，我不知道为什么。这是问题的图片。所有的四边形按钮都应该是灰色的，但事实并非如此。

![问题图片](../Images/75c92e0d5286211bc8c1548469755d44.png)

这是我绘制它们的代码。

```
import static org.lwjgl.opengl.GL11.*;

import java.awt.Font;
import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import java.nio.FloatBuffer;
import java.util.ArrayList;
import java.util.EventListener;
import java.util.EventObject;
import java.util.List;

import org.newdawn.slick.Color;
import org.newdawn.slick.geom.Vector2f;
import org.newdawn.slick.opengl.Texture;

public class MapEditorUI
{
private int cols;
private float dHeight, dWidth, bHeight, bWidth;
private Color backgroundColor;
private Vector2f startPos;
private Vector2f borderStartPos;
private GUI editorGUI = new GUI();

public GUI.Element clickedElement;

MapEditorUI()
{
    //int width = 70, xStart = 800, yStart = 330, height = 20;

    editorGUI.addElement(0, new Vector2f(910, 330), new Vector2f(1020, 350), "Fill Layer");
    editorGUI.addElement(0, new Vector2f(910, 360), new Vector2f(1020, 380), "Clear Layer");

    editorGUI.addElement(0, new Vector2f(800, 330), new Vector2f(870, 350), "Ground");
    editorGUI.addElement(0, new Vector2f(800, 360), new Vector2f(870, 380), "Mask");
    editorGUI.addElement(0, new Vector2f(800, 390), new Vector2f(870, 410), "Mask2");
    editorGUI.addElement(0, new Vector2f(800, 420), new Vector2f(870, 440), "Fringe");
    editorGUI.addElement(0, new Vector2f(800, 450), new Vector2f(880, 470), "Fringe2");

}

public void initUI(int cols, Color color)
{
    this.cols = cols;
    this.backgroundColor = color;
}

public void setLoc(float startX, float startY, float width, float height)
{ startPos = new Vector2f(startX, startY); dHeight = height; dWidth = width; }
public void setBorderLocs(float borderStartX, float borderStartY, float width, float height)
{ borderStartPos = new Vector2f(borderStartX, borderStartY); bWidth = width; bHeight = height; }

public void draw()
{
    glDisable(GL_TEXTURE_2D);

    drawBackground();
    drawBorder();
    editorGUI.draw();
}

public boolean checkMouseInUI(float x, float y)
{
    if(x > startPos.x && y > startPos.y)
        return true;
    else if(x < borderStartPos.x && x > borderStartPos.x + bWidth)
        return true;

    return false;
}

public int doMouseActions(float x, float y)
{
    clickedElement = editorGUI.checkClick(x, y);
    if(clickedElement != null) // Something was actually clicked
    {
//          System.out.println("CLICKED: " + clickedElement.text);
        return 0; // Element Clicked, have main class handle it from there
    }
    return -1;
}

private void drawBorder()
{
    backgroundColor.bind();
    glBegin(GL_QUADS);
        glVertex2f(borderStartPos.x, borderStartPos.y);
        glVertex2f(borderStartPos.x + bWidth, borderStartPos.y);
        glVertex2f(borderStartPos.x + bWidth, borderStartPos.y + bHeight);
        glVertex2f(borderStartPos.x, borderStartPos.y + bHeight);
    glEnd();
}

private void drawBackground()
{
    backgroundColor.bind();
    glBegin(GL_QUADS);
        glVertex2f(startPos.x, startPos.y);
        glVertex2f(startPos.x + dWidth, startPos.y);
        glVertex2f(startPos.x + dWidth, startPos.y + dHeight);
        glVertex2f(startPos.x, startPos.y + dHeight);
    glEnd();
}

class GUI
{
    private Text guiText = new Text();
    private List<Element> Elements = new ArrayList<Element>();

    GUI()
    {
        guiText.init("Courier", Font.PLAIN, 16);
    }

    public Element checkClick(float x, float y)
    {
        for(Element i : Elements)
        {
            if(i != null)
            {
                if(i.checkClick(x, y) == true)
                {
                    i.clicked();
                    return i;
                }
            }
        }

        return null;
    }

    public void draw()
    {
        for(Element i : Elements)
        {
            if(i != null)
                i.draw();       
        }
    }

    public void addElement(int type, Vector2f startPos, Vector2f endPos, String text)
    {Elements.add(new Element(type, startPos, endPos, text));}
    public void addElement(int type, Vector2f startPos, Vector2f endPos, String text, Color buttonBackgroundColor)
    {Elements.add(new Element(type, startPos, endPos, text, buttonBackgroundColor));}

    class Element
    {
        public int type;
        private Vector2f startPos, endPos;
        public String text;
        private byte state;
        private long timeClick;
        private Color buttonColor;

        Element(int type, Vector2f startPos, Vector2f endPos, String text)
        {this.type = type; this.startPos = startPos; this.endPos = endPos; this.text = text;}
        Element(int type, Vector2f startPos, Vector2f endPos, String text, Color buttonColor)
        {this.type = type; this.startPos = startPos; this.endPos = endPos; this.text = text; this.buttonColor = buttonColor;}

        public void draw()
        {
            checkTime();

            switch(type)
            {
            case 0: // Button

                switch(state)
                {
                case 0: // Unclicked
//                      if(buttonColor != null)
//                          buttonColor.bind();
//                      else
                        Color.gray.bind();
                    break;

                case 1: // Clicked
//                      if(buttonColor != null)
//                          new Color(buttonColor.r-50, buttonColor.g-50, buttonColor.b-50).bind();
//                      else
                        Color.red.bind();
                    break;
                }

//                  Color.green.bind();

//                  System.out.println(glGetFloat(GL_CURRENT_COLOR)[2]);
                float Minv[]=new float[16];
                ByteBuffer temp = ByteBuffer.allocateDirect(64);
                temp.order(ByteOrder.nativeOrder());
                glGetFloat(GL_MODELVIEW_MATRIX, (FloatBuffer)temp.asFloatBuffer());
                temp.asFloatBuffer().get(Minv);

                for(int i = 0; i < 16; ++i)
                    System.out.println(text + "| " + i + ": " + Minv[i]);

                glBegin(GL_QUADS);
                    glVertex2f(startPos.x, startPos.y);
                    glVertex2f(endPos.x, startPos.y);
                    glVertex2f(endPos.x, endPos.y);
                    glVertex2f(startPos.x, endPos.y);
                glEnd();

                guiText.drawString(startPos.x + 2, startPos.y - 2, text, Color.white);
                glDisable(GL_BLEND);
                break;
            }
        }

        private void checkTime()
        {
            long curTime = System.currentTimeMillis();
            long timePassed = curTime - timeClick;

            if(timePassed > 50)
                state = 0;
        }

        public boolean checkClick(float x, float y)
        {
            if((x > startPos.x && y > startPos.y) && (x < endPos.x && y < endPos.y))
            {
                return true;
            }

            return false;
        }

        public void clicked()
        {
            timeClick = System.currentTimeMillis();
            state = 1; // Clicked
        }

        public void setType(int type)
        {this.type = type;}

        public void setButtonColor(Color buttonColor)
        {this.buttonColor = buttonColor;}
    }
}
} 
```

这是我的drawString代码：

```
public void drawString(float x, float y, String text, Color color)
{
    // Make sure alpha blending is enabled, it might not be
    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

    font.drawString(x, y, text, color);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-24T10:09:23.250

您必须在`glEnable(GL_TEXTURE_2D);`之前`font.drawString();`和`glDisable(GL_TEXTURE_2D);`之后。

# c# - Socket服务器内存不断增加

> ID：10355914
> 
> 赞同：0
> 
> 时间：2012-04-27T18:27:07.980
> 
> 标签：c#, socketserver

我们有一个用 C#.Net 3.5 开发的套接字服务器。每当客户端断开连接并连接时，我都会看到服务器内存使用量增加。如果未提供有效凭据，服务器将断开客户端连接。

当客户端尝试使用无效凭据连接时，会保留更多内存并且似乎永远不会放弃。客户端每秒尝试重新连接一次。下面是处理断开连接的代码。每当客户端断开连接并且遇到读写操作错误时，都会调用此代码。

有人可以指导我如何调试/解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:37:11.663

可能是您将 state.workSocket 和 state 设置为 null，而他们没有机会处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T09:47:56.703

您如何测量内存使用情况？

如果机器上没有内存压力，GC 将不会经常执行收集。因此，即使已释放内存，任务管理器中显示的内存使用量也会上升。

您可以尝试添加一些`GC.Collect`调用来强制 GC 运行 - 这将显示您是否真的在泄漏内存。（不要在您的生产构建中留下收集呼叫）。

MSDN 文章：[.NET 应用程序的内存使用审计](http://msdn.microsoft.com/en-us/magazine/dd882521.aspx)

# macos - CGShadingGetBounds() 签名？

> ID：10355915
> 
> 赞同：2
> 
> 时间：2012-04-27T18:27:33.567
> 
> 标签：macos, assembly, reverse-engineering, quartz-graphics

我正在尝试获取方法 CGShadingGetBounds() 的签名？

我试过了，`CG_EXTERN CGRect CGShadingGetBounds(CGShadingRef);`但似乎不是这样。

有人可以帮忙找出签名吗？下面是拆解。

```
__text:000000000016BB76                 public _CGShadingGetBounds
__text:000000000016BB76 _CGShadingGetBounds proc near           ; CODE XREF: _log_LogShading+1B8p
__text:000000000016BB76                                         ; _dlr_DrawShading+1FEp ...
__text:000000000016BB76                 push    rbp
__text:000000000016BB77                 mov     rbp, rsp
__text:000000000016BB7A                 mov     rax, rdi
__text:000000000016BB7D                 cmp     byte ptr [rsi+28h], 0
__text:000000000016BB81                 jz      short loc_16BBAC
__text:000000000016BB83                 movsd   xmm0, qword ptr [rsi+30h]
__text:000000000016BB88                 movsd   qword ptr [rdi], xmm0
__text:000000000016BB8C                 movsd   xmm0, qword ptr [rsi+38h]
__text:000000000016BB91                 movsd   qword ptr [rdi+8], xmm0
__text:000000000016BB96                 movsd   xmm0, qword ptr [rsi+40h]
__text:000000000016BB9B                 movsd   qword ptr [rdi+10h], xmm0
__text:000000000016BBA0                 movsd   xmm0, qword ptr [rsi+48h]
__text:000000000016BBA5
__text:000000000016BBA5 loc_16BBA5:                             ; CODE XREF: _CGShadingGetBounds+5Ej
__text:000000000016BBA5                 movsd   qword ptr [rdi+18h], xmm0
__text:000000000016BBAA                 pop     rbp
__text:000000000016BBAB                 retn
__text:000000000016BBAC ; ---------------------------------------------------------------------------
__text:000000000016BBAC
__text:000000000016BBAC loc_16BBAC:                             ; CODE XREF: _CGShadingGetBounds+Bj
__text:000000000016BBAC                 lea     rcx, _CGRectInfinite
__text:000000000016BBB3                 movsd   xmm0, qword ptr [rcx]
__text:000000000016BBB7                 movsd   xmm1, qword ptr [rcx+8]
__text:000000000016BBBC                 movsd   qword ptr [rdi], xmm0
__text:000000000016BBC0                 movsd   qword ptr [rdi+8], xmm1
__text:000000000016BBC5                 movsd   xmm0, qword ptr [rcx+10h]
__text:000000000016BBCA                 movsd   qword ptr [rdi+10h], xmm0
__text:000000000016BBCF                 movsd   xmm0, qword ptr [rcx+18h]
__text:000000000016BBD4                 jmp     short loc_16BBA5
__text:000000000016BBD4 _CGShadingGetBounds endp 
```

我的目标是确定阴影发生的范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T09:27:37.843

我相信你提到的签名

```
CG_EXTERN CGRect CGShadingGetBounds(CGShadingRef); 
```

是正确的。例如，如果您尝试使用自定义对象重建此类函数，如下所示：

```
typedef struct
{
    long a1, a2, a3, a4, a5;
    char b6;
    CGRect r;
} MyObj;

CGRect ReconstructFunc(MyObj *o)
{
    if (o->b6) return o->r;
    return CGRectNull;
} 
```

当然，这会有所不同，但是“快速”路径（其中 b6 非零）在汇编和行为方面都与原始函数非常相似：

```
pushq   %rbp
movq    %rsp, %rbp
movq    %rdi, %rax
cmpb    $0, 40(%rsi)
je  LBB0_2
movq    72(%rsi), %rcx
movq    %rcx, 24(%rax)
movq    64(%rsi), %rcx
movq    %rcx, 16(%rax)
movq    48(%rsi), %rcx
movq    56(%rsi), %rdx
movq    %rdx, 8(%rax)
movq    %rcx, (%rax)
popq    %rbp
ret
    ... (continues) 
```

这与您发布的程序集基本相同。它还暗示了一些“约定” obj-c 和 Mac GCC 用于使用 CGRect 结构编译方法。根据[x64 ABI](http://x86-64.org/documentation/abi.pdf)参数在这些寄存器中传递：RDI、RSI、RDX（以及更多）。如果你看一下前两个，RDI 和 RSI，它们显然包含参数，第一个是指向输出结构 (CGRect) 的指针，第二个是不透明结构 (CGShadingReg)。

因此，我相信 Mac 上的 GCC 会这样翻译：

```
CGRect myrect = MyFuncReturningRect(param); 
```

进入这个：

```
CGRect myrect;
MyFuncReturningRect(&myrect, param); 
```

无论如何总结一下，我坚信你猜到的签名是正确的。如果该函数没有返回您期望的值，则它是由一些其他因素引起的（可能是由该`byte ptr [rsi+28h]`值引起的，该值必须为非空才能获得一些非虚拟信息）。

# objective-c - Cocos2d 没有释放场景（再次）

> ID：10355918
> 
> 赞同：0
> 
> 时间：2012-04-27T18:27:39.660
> 
> 标签：objective-c, cocos2d-iphone, release, dealloc

这是我的第一篇文章，所以不要对我太粗鲁。

cocos2d 有问题。我正在制作一个带有 HUD 层和游戏层的游戏。当我用 [ClassicGameLayer 场景] 调用替换主菜单场景时，我的 HUD 和游戏层以这种方式初始化：

```
+ (CCScene*)scene
{
CCScene *scene = [CCScene node];

HudLayer *hud = [[[HudLayer alloc] initWithMode:1] autorelease];
ClassicGameLayer *layer = [[[ClassicGameLayer alloc] initWithHUD:hud] autorelease];

[scene addChild:hud z:hudZ];
[scene addChild:layer z:layerZ];

return scene;
} 
```

当用户失败时，游戏 HUD 层调用

```
[[CCDirector sharedDirector] replaceScene:[GameOverLayer sceneWithMode:integer andScore:points]]]; 
```

HUD 层的 dealloc 被调用，但 ClassicGameLayer 的 dealloc 从未被调用。我搜索了几乎所有我能想到的东西，但仍然没有运气。有谁知道是什么导致了我这个问题？如果是这样，我该如何解决？我认为其他所有场景都在正确发布:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:45:28.013

如果你的自动释放池永远不会到达它释放东西的地方，它永远不会释放任何内存。我正在编写的 Mac 应用程序曾经遇到过这个问题。它也不会在 Instruments 中显示为内存泄漏。

如果您遇到此问题，我建议不要使用自动释放。

# .net - 崩溃时重新启动应用程序

> ID：10355925
> 
> 赞同：6
> 
> 时间：2012-04-27T18:28:23.133
> 
> 标签：.net

如果发生未处理的异常，我需要重新启动我的应用程序。我想模仿 Word 甚至 Visual Studio 等 Office 应用程序，当应用程序崩溃或挂起（停止响应）时，会显示一个弹出窗口并询问用户是要重新启动应用程序还是终止它。

我不确定它是如何完成的，因为我的应用程序可能完全崩溃了（如此[处](https://stackoverflow.com/questions/10282012/exception-on-native-thread-crashes-net-application-without-exception)所述）。现在我在想某种形式的看门狗或启动器应用程序，但我的直觉告诉我，这不是我提到的应用程序的方式。

因此，任何关于“最佳”或“最常被接受”的方式的说明将不胜感激。

一如既往，感谢大家的关注。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T17:45:09.253

您可以使用[Windows 错误报告 (WER)](http://msdn.microsoft.com/en-us/library/windows/desktop/bb513641%28v=vs.85%29.aspx)在未处理的异常发生之前至少运行 60 秒时注册应用程序以重新启动（甚至恢复）。

我没有尝试过，但我发现以下链接描述了如何做到这一点：

*   [http://msdn.microsoft.com/en-us/library/windows/desktop/bb525423(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb525423(v=vs.85).aspx)
*   [http://channel9.msdn.com/posts/Application-Restart-and-Recovery-on-Windows-7-in-Native-Code](http://channel9.msdn.com/posts/Application-Restart-and-Recovery-on-Windows-7-in-Native-Code)
*   [http://code.msdn.microsoft.com/Windows-Restart-and-cc461aa9](http://code.msdn.microsoft.com/Windows-Restart-and-cc461aa9)（还包含 C# 示例）

不幸的是，这似乎只适用于 Windows 7 及更高版本。

# vb.net - 使用 smtpserver 时请求在电子邮件上阅读回执

> ID：10355928
> 
> 赞同：1
> 
> 时间：2012-04-27T18:28:35.277
> 
> 标签：vb.net, smtp

我成功地使用 smtpserver 发送电子邮件。我正在编写一个 VB.Net 应用程序。

我目前的代码是：

```
 SmtpServer.Credentials = New Net.NetworkCredential(mEMailUser, mEMailPassword) 
    SmtpServer.Port = 587 
    SmtpServer.Host = mHostName 
    mail = New MailMessage() 
    mail.From = New MailAddress(mFromEMail) 
    mail.To.Add(mfrmSendAnEmail.txtTo.Text) 
    mail.Subject = mfrmSendAnEmail.txtSubject.Text 

    _Attachment = mDirectory & "\" & gcloGlobals.DocumentName & ".pdf" 
    Dim oAttch As Attachment = New Attachment(_Attachment) 
    mail.Attachments.Add(oAttch) 

    mail.Body = mfrmSendAnEmail.txtBody.Text 
    SmtpServer.Send(mail) 
```

我希望收件人收到阅读请求通知，以便当他们打开电子邮件时，他们可以选择向发件人发送已阅读的通知。

我认为这可能有效：

```
 mail.DeliveryNotificationOptions = DeliveryNotificationOptions.OnSuccess 
```

但事实并非如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:36:41.003

这是我使用的代码：

```
message.Headers.Add("Disposition-Notification-To", "\"" + fromAddress.DisplayName + "\" <" + fromAddress.Address + ">"); 
```

在您的代码中，您没有为发件人地址设置显示名称，因此您应该使用更简单的形式而不是上面给出的行：

```
message.Headers.Add("Disposition-Notification-To", mFromEMail); 
```

# iphone - 'NSURLIsExcludedFromBackupKey' 未声明

> ID：10355931
> 
> 赞同：2
> 
> 时间：2012-04-27T18:28:39.403
> 
> 标签：iphone, ios5, backup

我的 iPhone 应用程序包含大约 500 MB 数据。并且应用程序将离线使用这些数据。所以我将文件夹标记为不在 iTunes 上备份/复制。所以我使用以下网址： [https ://gist.github.com/1999985](https://gist.github.com/1999985)

但它说“NSURLIsExcludedFromBackupKey”未声明。我也尝试使用[https://developer.apple.com/library/ios/#qa/qa1719/_index.html](https://developer.apple.com/library/ios/#qa/qa1719/_index.html) 但我总是返回 false ..

所以请让我知道它是如何工作的？？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T18:48:46.687

`NSURLIsExcludedFromBackupKey`应该可以在 5.1+ SDK 上编译。
由于该密钥不适用于 5.0，因此以下代码段可以作为一种解决方法。

```
if (SYSTEM_VERSION_LESS_THAN_OR_EQUAL_TO(@"5.0.1"))
{
    const char* filePath = [[URL path] fileSystemRepresentation];            
    const char* attrName = "com.apple.MobileBackup";
    u_int8_t attrValue = 1;

    int result = setxattr(filePath, attrName, &attrValue, sizeof(attrValue), 0, 0); 
    return result == 0;
}          
if (SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(@"5.1"))
{
    NSError *error = nil;
    //[URL setResourceValue:[NSNumber numberWithBool:YES] forKey:NSURLIsExcludedFromBackupKey error:&error];
    [URL setResourceValue:[NSNumber numberWithBool:YES] forKey:@"NSURLIsExcludedFromBackupKey" error:&error];
    return error == nil;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-05T17:32:21.957

我在使用“SYSTEM_VERSION_LESS_THAN_OR_EQUAL_TO”检查操作系统版本时遇到错误，我的应用程序是在旧操作系统工具中开发的。所以我改成这个，替换为“SYSTEM_VERSION_LESS_THAN_OR_EQUAL_TO”

```
double currSysVer =[[[UIDevice currentDevice] systemVersion] doubleValue];
if (currSysVer>=5.1) {
    NSError *error = nil;
    //[URL setResourceValue:[NSNumber numberWithBool:YES] forKey:NSURLIsExcludedFromBackupKey error:&error];
    [URL setResourceValue:[NSNumber numberWithBool:YES] forKey:@"NSURLIsExcludedFromBackupKey" error:&error];
    return error == nil;
}else{

    const char* filePath = [[URL path] fileSystemRepresentation];            
    const char* attrName = "com.apple.MobileBackup";
    u_int8_t attrValue = 1;

    int result = setxattr(filePath, attrName, &attrValue, sizeof(attrValue), 0, 0); 
    return result == 0;

} 
```

# objective-c - 传递一个 int 作为 performSelectorOnMainThread 的对象：

> ID：10355935
> 
> 赞同：1
> 
> 时间：2012-04-27T18:28:52.063
> 
> 标签：objective-c, cocoa-touch, primitive

我需要调用：

```
[self performSelectorOnMainThread:@selector(chooseURL:) withObject:myIndex waitUntilDone:YES]; 
```

但我的问题是它`myIndex`是一个`int`，而**不是**一个对象。有解决方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T18:32:07.083

您必须将 int 包装在对象中，因为 int 是原始类型而不是对象。例如：

```
[self performSelectorOnMainThread:@selector(chooseURL:) 
                       withObject:[NSNumber numberWithInt:myIndex] 
                    waitUntilDone:YES]; 
```

当然，您必须编辑您的 chooseURL: 方法以接受 NSNumber 而不是 int。展开：

```
int myInt = [myIndex intValue]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T18:29:40.500

从 int 创建一个 NSNumber

[NSNumber numberWithInt:myInt];

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-27T18:35:53.940

使用 GCD 版本`performSelectorOnMainThread:...`：

```
dispatch_sync(dispatch_get_main_queue(), ^{
    [self chooseURL:myIndex];
}); 
```

主队列始终在主线程上。

`dispatch_sync()`当你已经在主线程上时不要使用，否则你会死锁。必要时检查：

```
dispatch_queue_t mainQ = dispatch_get_main_queue();
if( mainQ != dispatch_get_current_queue() ){
    dispatch_sync(mainQ, ^{
        [self chooseURL:myIndex];
    });
}
else {
    [self chooseURL:myIndex];
} 
```

对于`waitUntilDone:NO`，您可以使用`dispatch_async()`，*可以*在同一个线程中使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-27T18:33:06.147

NSNumber 可以归类为对象，因此请使用 [NSNumber numberwithint:myindex]

# list - 如何通过列表理解计算频率？

> ID：10355937
> 
> 赞同：2
> 
> 时间：2012-04-27T18:28:56.493
> 
> 标签：list, haskell

```
count :: Eq a => a -> [a] -> Int
count n [] = 0
count n (x:xs) | n == x = 1 + count n xs
           | otherwise = count n xs

rmdups :: Eq a => [a] -> [a]
rmdups [ ] = [ ]
rmdups (x:xs) = x : rmdups (filter(/= x) xs) 
```

使用这两个函数，需要创建第三个函数，称为频率：它应该计算列表中每个不同值在该列表中出现的次数。例如：频率“ababc”，应返回 [(3,'a'),(2,'b'),(1,'c')]。频率布局为：

```
frequency :: Eq a => [a] -> [(Int, a)] 
```

Ps rmdups，从列表中删除重复项，因此 rmdups "aaabc" = abc 和 count 2 [1,2,2,2,3] = 3。

到目前为止，我有：

```
frequency :: Eq a => [a] -> [(Int, a)]
frequency [] = []
frequency (x:xs) = (count x:xs, x) : frequency (rmdups xs) 
```

但这部分存在，（错误）。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:44:48.070

```
frequency xs = map (\c -> (count c xs,c)) (rmdups xs) 
```

或者，通过列表理解，

```
frequency xs = [(count c xs, c) | c <- rmdups xs] 
```

`count`是使用and定义它的最短方法`rmdups`。如果您需要按照示例中的频率（降序）对其进行排序，

```
frequency xs = sortBy (flip $ comparing fst) $ map (\c -> (count c xs,c)) (rmdups xs) 
```

使用`sortBy`from`Data.List`和`comparing`from `Data.Ord`。

如果您所拥有的只是一个`Eq`约束，那么您将无法获得太多效率，但如果您只需要它用于类型 in ，则可以使用例如or`Ord`获得更有效的实现。`Data.Set``Data.Map`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T05:26:18.603

这是我自己的“懒惰”答案，它不调用 rmdups：

```
frequency [] = []
frequency (y:ys) = [(count y (y:ys), y)] ++ frequency (filter (/= y) ys) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:57:34.943

`import qualified Data.Set as Set`

`frequency xs = map (\x -> (length $ filter (== x) xs, x)) (Set.toList $ Set.fromList xs)`

# jquery - nginx，jquery - 执行 POST 时出现 Access-Control-Allow-Origin 错误

> ID：10355938
> 
> 赞同：0
> 
> 时间：2012-04-27T18:29:02.653
> 
> 标签：jquery, json, post, nginx

这是我在 chrome 控制台中看到的错误。

XMLHttpRequest 无法加载 {URL}。Access-Control-Allow-Origin 不允许来源 {URL}。

我尝试为 CORS 配置我的 NGINX：

```
location / {
    if ($http_origin) {
        add_header Access-Control-Allow-Origin *;
        add_header Access-Control-Allow-Methods "GET,POST,OPTIONS";
    } 
```

但这似乎没有帮助。

jquery 调用如下所示：

```
var submissionData = '{"tweet_id":"'+tweet_id+'", "question_id":"'+question_id+'", '+choiceString+', "extra_passback":"'+extra_passback+'"}';
$.post("http://ec2[...].amazonaws.com/question/answer/", submissionData, function(data) {console.log("success");}); 
```

我什至不确定问题出在 jquery 还是 nginx 上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T15:24:59.367

基于[这篇文章](https://stackoverflow.com/questions/5584923/a-cors-post-request-works-from-plain-javascript-but-why-not-with-jquery)，我添加了两个额外的标题（除了你在上面的问题中提到的两个），它适用于我，使用 JQuery json 跨域请求：

```
add_header         Access-Control-Allow-Headers   Content-Type;
add_header         Access-Control-Max-Age         86400; 
```

# python - tornado 将 GET 和 POST 参数映射到列表。如何禁用此“功能”？

> ID：10355939
> 
> 赞同：17
> 
> 时间：2012-04-27T18:29:02.790
> 
> 标签：python, json, tornado, cyclone

tornado* Web 框架中的 HTTPRequest 类有助于[将 GET 和 POST 参数映射到列表](https://github.com/facebook/tornado/blob/master/tornado/httpserver.py)。我理解为什么 - 如果多次使用给定的参数名称。但是对于一些 RequestHandlers 来说，这是一种痛苦。例如，如果我想传递一个 json 对象并在服务器上按原样解析它。

禁用映射到列表行为的最直接方法是什么，以便我可以将未更改的 json 发送到龙卷风/旋风服务器？

*Cyclone，实际上，以防这里存在实施差异。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-27T21:47:24.293

`self.request.arguments`您应该使用访问器函数，而不是直接访问：

```
self.get_argument("ID", default=None, strip=False) 
```

这将返回单个项目。

如果您想将参数转换为 JSON 对象，您可以很容易地做到这一点：

```
json.dumps({ k: self.get_argument(k) for k in self.request.arguments }) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-27T18:35:06.317

我会说“你不走运”。您可以重新编写有问题的课程（看起来这不会很有趣），但除此之外我看不到很多选择。

* * *

我只会使用字典理解。

```
{k:''.join(v) for k,v in  self.request.arguments.iteritems()} 
```

# python - 如何在 Amazon S3 中复制大于 5 GB 的文件？

> ID：10355941
> 
> 赞同：26
> 
> 时间：2012-04-27T18:29:21.790
> 
> 标签：python, amazon-s3, boto

Amazon S3 REST API 文档说在 PUT 操作中上传的大小限制为 5gb。大于该大小的文件必须使用 multipart 上传。美好的。

但是，我本质上需要的是重命名可能比这更大的文件。据我所知，没有重命名或移动操作，因此我必须将文件复制到新位置并删除旧位置。大于 5gb 的文件究竟是如何完成的？我必须从存储桶到自身进行分段上传吗？在这种情况下，如何将文件分成几部分？

从阅读 boto 的源代码来看，对于大于 5gb 的文件，它似乎不会自动执行类似的操作。有没有我错过的内置支持？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-28T15:57:26.090

> 据我所知，没有重命名或移动操作，因此我必须将文件复制到新位置并删除旧位置。

没错，对于小于 5 GB 的对象/文件，通过[PUT Object - Copy](http://docs.amazonwebservices.com/AmazonS3/latest/API/RESTObjectCOPY.html)操作，然后是[DELETE Object](http://docs.amazonwebservices.com/AmazonS3/latest/API/RESTObjectDELETE.html)操作很容易做到（当然，这两者都在[boto](https://github.com/boto/boto)中受支持，请参阅[copy_key()](http://docs.pythonboto.org/en/latest/ref/s3.html#boto.s3.bucket.Bucket.copy_key)和[delete_key( )](http://docs.pythonboto.org/en/latest/ref/s3.html#boto.s3.bucket.Bucket.delete_key) ):

> PUT 操作的这种实施会创建已存储在 Amazon S3 中的对象的副本。PUT 复制操作与执行 GET 然后执行 PUT 相同。添加请求标头 x-amz-copy-source 会使 PUT 操作将源对象复制到目标存储桶中。

但是，对于大于 5 GB 的对象/文件，这确实是不可能的：

> **注意**
> [...] 您可以使用此 API 在单个原子操作中创建最大 5 GB 的对象副本。**但是，要复制大于 5 GB 的对象，您必须使用分段上传 API**。有关概念信息 [...]，请转到[使用分段上传上传对象](http://docs.amazonwebservices.com/AmazonS3/latest/dev/uploadobjusingmpu.html)[...] *[强调我的]*

同时，Boto 也通过[copy_part_from_key()](http://docs.pythonboto.org/en/latest/ref/s3.html#boto.s3.multipart.MultiPartUpload.copy_part_from_key)方法支持这一点；[不幸的是，在相应的拉取请求＃425（允许多部分复制命令）](https://github.com/boto/boto/pull/425)之外没有记录所需的方法（虽然我自己还没有尝试过）：

```
import boto
s3 = boto.connect_s3('access', 'secret')
b = s3.get_bucket('destination_bucket')
mp = b.initiate_multipart_upload('tmp/large-copy-test.mp4')
mp.copy_part_from_key('source_bucket', 'path/to/source/key', 1, 0, 999999999)
mp.copy_part_from_key('source_bucket', 'path/to/source/key', 2, 1000000000, 1999999999)
mp.copy_part_from_key('source_bucket', 'path/to/source/key', 3, 2000000000, 2999999999)
mp.copy_part_from_key('source_bucket', 'path/to/source/key', 4, 3000000000, 3999999999)
mp.copy_part_from_key('source_bucket', 'path/to/source/key', 5, 4000000000, 4999999999)
mp.copy_part_from_key('source_bucket', 'path/to/source/key', 6, 5000000000, 5500345712)
mp.complete_upload() 
```

您可能想研究有关如何最终在 Java 或 .NET 中实现此目的的相应示例，这可能会提供对一般方法的更多见解，请参阅 [使用 Multipart Upload API 复制对象](http://docs.amazonwebservices.com/AmazonS3/latest/dev/CopyingObjctsMPUapi.html)。

祝你好运！

* * *

### 附录

请注意以下关于一般复制的特殊性，很容易被忽视：

> 复制对象时，您可以保留大部分元数据（默认）或指定新元数据。**但是，ACL 不会保留，并为发出请求的用户设置为私有**。要覆盖默认 ACL 设置，请在生成复制请求时使用 x-amz-acl 标头指定新 ACL。有关更多信息，请参阅 Amazon S3 ACL。*[强调我的]*

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-10T21:10:33.053

上面非常接近工作，不幸的是应该结束`mp.complete_upload()` 而不是错字`upload_complete()`！

我在这里添加了一个工作 boto s3 多部分复制脚本，基于 AWS Java 示例，并使用超过 5 GiB 的文件进行了测试：

[https://gist.github.com/joshuadfranklin/5130355](https://gist.github.com/joshuadfranklin/5130355)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-24T18:27:24.403

我发现这种方法可以上传大于 5gigs 的文件，并将其修改为与 Boto 复制程序一起使用。这是原文：[http ://boto.cloudhackers.com/en/latest/s3_tut.html](http://boto.cloudhackers.com/en/latest/s3_tut.html)

```
import math
from boto.s3.connection import S3Connection
from boto.exception import S3ResponseError

conn = S3Connection(host=[your_host], aws_access_key_id=[your_access_key],
                    aws_secret_access_key=[your_secret_access_key])

from_bucket = conn.get_bucket('your_from_bucket_name')
key = from_bucket.lookup('my_key_name')
dest_bucket = conn.get_bucket('your_to_bucket_name')

total_bytes = key.size
bytes_per_chunk = 500000000

chunks_count = int(math.ceil(total_bytes/float(bytes_per_chunk)))
file_upload = dest_bucket.initiate_multipart_upload(key.name)
for i in range(chunks_count):
    offset = i * bytes_per_chunk
    remaining_bytes = total_bytes - offset
    print(str(remaining_bytes))
    next_byte_chunk = min([bytes_per_chunk, remaining_bytes])
    part_number = i + 1
    file_upload.copy_part_from_key(dest_bucket.name, key.name, part_number,
                                   offset, offset + next_byte_chunk - 1)
file_upload.complete_upload() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-17T14:36:45.277

现在的标准`.copy`方法将对大于 5gb 的文件执行分段上传。[官方文档](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/s3.html#S3.Client.copy)

```
import boto3
s3 = boto3.resource('s3')
copy_source = {
    'Bucket': 'mybucket',
    'Key': 'mykey'
}
s3.meta.client.copy(copy_source, 'otherbucket', 'otherkey') 
```

# java - Java 本机库调用另一个 DLL 并且不在 java.library.path 中搜索

> ID：10355949
> 
> 赞同：1
> 
> 时间：2012-04-27T18:29:54.010
> 
> 标签：java, native, java-3d

我想在 Tomcat 中部署一个带有 Java3D DLL 和 DirectX 软件渲染器的 .war。我的问题是 DirectX DLL 的调用是在 Java3D 的本机代码中完成的，它不知道`java.library.path`, 也不搜索 Tomcat 的`\bin`或`\lib`. 它只会发现我是否将 DLL 放在客户端的 Window 中`PATH`，例如在`JAVA_HOME`.

有什么方法可以配置我的部署（可能是重写 Window 的脚本`PATH`）或 Java3D（他们记录的属性在[这里](http://java.net/projects/java3d/pages/Java3DApplicationDev)）以在我的安装目录中找到 DLL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T16:41:55.143

您可以在 Tomcat 启动脚本中指定其他 JVM 属性。

您需要确保 java.library.path 指向 DLL 的适当位置。

# html - 打印时，如果图像大于单个打印页面，Firefox 会切断/裁剪图像，如何禁用此行为？

> ID：10355951
> 
> 赞同：3
> 
> 时间：2012-04-27T18:30:08.380
> 
> 标签：html, css, image, printing

如果我的网页上的图像超过了单个打印页面的高度，则在打印时（例如在打印预览中查看），它的下半部分会被 Firefox 截断/裁剪，这在 Chrome 中不会发生，并且可能不会在 IE 中发生或者，不确定 Opera 和其他人。

如何禁用此剪切/裁剪并在两页或多页上获取完整图像？

我宁愿通过 HTML/CSS/Javascript 而不是浏览器设置来完成它，但如果这是一个浏览器设置问题，我想我只需要相信我的用户就能做到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:42:54.457

这是一个打印设置——用户需要选择“Shrink To Fit”等。我相信无论如何它都是默认选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-08T18:44:18.420

试试这个

```
overflow: visible !important; 
```

# android - 创建按钮....移动到包含图像的第二个屏幕并使用缩放功能

> ID：10355952
> 
> 赞同：-1
> 
> 时间：2012-04-27T18:30:17.170
> 
> 标签：android

我想要一个按钮导航到包含图像的第二个屏幕，然后对第二个屏幕中的图像使用缩放操作。当我使用 Intent 和 Startactivity 进入第二个屏幕时，我可以在一个屏幕上执行缩放功能，但缩放功能不起作用。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:38:08.933

那是因为你开始一个新`Activity`的按钮点击，即通过使用一个，你将不得不在你的第二个中`Intent`再次设置缩放功能。`ImageView``Activity`

[看到这个，它是学习如何设置缩放功能](http://www.zdnet.com/blog/burnette/how-to-use-multi-touch-in-android-2-part-6-implementing-the-pinch-zoom-gesture/1847)的绝佳来源。

# python - 如何在 Siemens S7-1200 和 python 之间进行通信？

> ID：10355953
> 
> 赞同：10
> 
> 时间：2012-04-27T18:30:24.213
> 
> 标签：python, plc, siemens, s7-1200

我正在 S7-1200 plc 上运行一个进程，我需要它向我的 python 脚本发送一个启动信号，在脚本运行完成后，它需要向 plc 发送一些内容以启动下一阶段。哦，它必须在梯子上完成。

有没有一种快速而肮脏的方法可以通过 profibus 发送东西，或者我最好只使用 RS232 东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T10:18:00.017

在使用 libnodave 和 OPC 失败后，我创建了一个 TCON、TSEND 和 TRECV 通信事物。它通过 TCP 传输一个字节并且它可以工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-12-14T06:16:16.407

我会选择 SNAP7 和 python-snap7 库。有关如何在此博客中找到的 Raspberry pi 上安装它的示例：http: [//simplyautomationized.blogspot.com/2014/12/raspberry-pi-getting-data-from-s7-1200.html](http://simplyautomationized.blogspot.com/2014/12/raspberry-pi-getting-data-from-s7-1200.html)

**更新：**

有关如何设置的视频演练：[https ://youtu.be/yJNEsI5KJxs](https://youtu.be/yJNEsI5KJxs)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-30T09:50:54.877

我会在 PC 端使用**[libnodave](https://sourceforge.net/projects/libnodave)**来更改 PLC 中某些 M 标签或 DB 标签的值。您可以轻松地制作一个梯级梯级，该梯级将监视此标签并执行进一步的操作。尽管 libnodave 本身不支持 Python，但您可以**[在此处](http://pastebin.com/p6q0te6R)**找到 Python 包装器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-27T19:46:46.517

好吧，“python rs232”的快速谷歌出现了[一些](http://www.varesano.net/blog/fabio/serial%20rs232%20connections%20python)谈论使用[pySerial](http://pyserial.sourceforge.net/)通过 rs232 进行机器人控制的网站。因此，如果您知道如何将您的小部件连接到 rs232，您就可以走这条路。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-05T09:20:04.517

Rothenbacher GmbH 有一个名为“S7connector”的商业库（显然它不是 sourceforge 上的“s7connector”）。它适用于 .NET 框架，因此可以与 IronPython 一起使用。

它确实适用于 S7-1200 PLC。您只需确保要读取/写入的 DB 不是优化的 S7-1200 样式 DB，而是与 S7-300/400 兼容的 DB，您可以在 TIA 门户中创建 DB 时设置该选项。这个库还允许读取和写入所有 I/O 端口 - “影子寄存器”（不确定它们的正式名称）以及直接覆盖前者。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-09-06T20:56:34.790

有几个可用于 Python 的 Modbus TCP 客户端，我已经成功使用了 pyModbusTCP。S7-1200 的 TIA Portal IDE 具有 Modbus 服务器功能，您可以将其加载到 PLC 中，从而允许您直接读取和写入 PLC。

[https://support.industry.siemens.com/cs/ww/en/view/83130159](https://support.industry.siemens.com/cs/ww/en/view/83130159)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-27T10:57:22.477

与 S7-1200 PLC cpu 进行通信的最佳方式是使用 OPC UA 或 Classic OPC（通常称为 OPC DA）。Libnodave 是为 S7-300 和 S7-400 而不是 S71200（2.x 固件）。

如果您使用第三方解决方案与 S7-1200（或 S7-1500）通信，则必须通过允许 put and get 机制来降低 PLC 的安全级别。put 和 get 是纯粹的邪恶使用。您为每个进程打开 CPU 的内存。不要再使用它们了。西门子实际上应该阻止这一点。

这适用于 S7-1200 的所有固件版本。西门子推动人们使用 OPC UA 作为来自 PLC 的默认通信。有什么意义，因为 OPC UA 是工业 4.0 和 IIoT 的协议。

编辑：重写一切。信息严重过时。如果您使用固件 2 或 3 1200，请考虑更换或升级。这些版本不再受支持，并且包含蠕虫问题。

# node.js - 猫鼬和指挥官

> ID：10355955
> 
> 赞同：1
> 
> 时间：2012-04-27T18:30:38.450
> 
> 标签：node.js, mongodb, mongoose

我正在编写一些脚本，用于使用 commands.js 对[Mongoose](http://mongoosejs.com/)模型进行一些[命令](http://visionmedia.github.com/commander.js/)行操作（最终，我想使用[Cron](http://en.wikipedia.org/wiki/Cron)运行这些工具）。

现在，我已经编写了几个脚本，`commander`它们都可以正常工作，但是如果我使用 连接到 MongoDB 数据库`mongoose`，它们的脚本在完成后就会挂起。现在，我认为数据库连接使节点保持活动状态，所以我添加了`mongoose.disconnect()`一行，它仍然挂起。

我发现唯一可以让我关闭的是使用`process.exit()`，但我不愿意仅仅终止该过程。我应该做些什么来触发正常关机吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T18:53:03.117

我对[API 文档](http://mongoosejs.com/docs/api.html)的阅读意味着`.disconnect()` **必须**给它一个回调函数。看起来它是为每个断开连接的并且可能会传递一个错误而调用的。

代码中有一个检查，以确保当事情解决时它不存在时它不会被调用，但是该检查没有在错误时运行，所以如果 Mongoose 收到来自 MongoDB 客户端的错误消息，它可能是保持连接打开，这就是它没有停止执行的原因。

如果您只打开到数据库的单个连接，您可能只想调用`[Connection object].close()`，因为如果没有给出回调，该函数会正确插入一个无操作“回调”，并且看起来它会正确破坏事物。

（我对 Mongoose 的研究越多，我就越想围绕 MongoDB 客户端编写一个瘦包装器，这样我就不必处理 Mongoose 的“帮助”。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T21:16:24.813

直接关闭节点程序是隐藏症状，而不是解决问题！

我终于隔离了这个问题，发现它与 Mongoose 模式定义有关。如果您在定义 Mongoose 模式后过早关闭连接¹，应用程序将挂起并最终产生一些与 MongDB 相关的奇怪错误。

`program.parse(argv)`在运行命令应用程序之前添加一个小的超时可以解决问题。只需像这样包装代码：

```
var program  = require('commander')
  , mongoose = require('mongoose')
  , models   = null
;

// Define command line syntax.
program
  .command(...)
;

mongoose.connect(
    ..., // connection parameters.

    function() {
        // connected to database, defined schemas.
        models = require('./models');

        // Wait 1 second before running the application code.
        setTimeout(function(){
            program.parser(process.argv);
        }, 1000);
    }
); 
```

* * *

1：这是我最初的解释，我还没有（还）广泛地测试过这个理论。但是，从应用程序中删除 Mongoose 模式定义成功地防止了应用程序挂起。

* * *

实际上，只需使用`process.nextTick()`而不是`setTimeout()`调用就可以很好地解决这种情况！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:53:58.863

我使用[异步](https://github.com/caolan/async/#series)“系列”来执行操作，然后在完成时调用*mongoose.connection.close()*。它可以防止回调地狱，并允许您巧妙地一次执行一个操作，或者在所有其他方法完成后并行执行一个函数。我一直将它用于需要 mongoose 但要在所有 mongoose 操作完成后终止的脚本。

# vim - 当命令行vi模式打开外部编辑器时，如何发送回命令行？

> ID：10355959
> 
> 赞同：1
> 
> 时间：2012-04-27T18:31:04.923
> 
> 标签：vim, command-line, vi

当使用命令行 vim 模式 (set -o vi) 并输入“v”时，它会将我带到外部编辑器。如何将编辑后的命令发回命令行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:33:32.870

使用“ZZ”对我有用。

换句话说：Shift-Z + Shift-Z

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:36:14.237

你只是退出了编辑器。:wq 就像前面提到的 ZZ 一样工作。

# php - mysql查询时区转换

> ID：10355961
> 
> 赞同：1
> 
> 时间：2012-04-27T18:31:29.330
> 
> 标签：php, mysql, timezone, conventions, convert-tz

我已将显示时间存储在时区设置表中的所有东部和 ID 中。时区设置表有 Timezone_id、GMT 偏移量和时区名称。

GMT 偏移量存储为 +6、-4、+3.5、-4.5 等。

我正在尝试编写一个查询以将放映时间转换为其原始时区。我正在这样做。

```
SELECT Date_format( CONVERT_TZ( CONVERT_TZ(A.START_TIME,  '+00:00',  '-5:00'),  
'+00:00',     CONCAT(B.GMT_OFFSET , ':00' )), '%Y-%m-%e %r:%i')  
AS  'start_time' from shows A, tz_settings B AND <<JOINS>>; 
```

我在这里做的是首先将时间从 ET 转换为 GMT，然后应用 GMT 偏移量。

START_TIME 采用日期格式，如 '2012-4-23 10:15:00' 此外，还有一个问题是将“3.5”等格式转换为“3.30”以传递给 Convert_TZ

编辑：表结构。主要领域。

```
 shows: 'id', 'show_name', 'stat_time', 'tz_id'
   tz_settings: 'tz_id', 'gmt_offset','tz_name' 
```

有任何想法吗？任何其他功能将有助于混合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T20:39:38.627

真的不知道你遇到了什么问题，但我只是用你的结构构建了 2 个 MYSQL 表：

**MySQL 表**

```
TABLE shows ['id', 'show_name', 'start_time', 'tz_id']
TABLE tz_settings ['tz_id', 'gmt_offset','tz_name'] 
```

**并使用此 MySQL 查询：**

```
SELECT Date_format( CONVERT_TZ( CONVERT_TZ( A.START_TIME, '+00:00', '-5:00' ) , '+00:00', CONCAT( B.GMT_OFFSET, ':00' ) ) , '%Y-%m-%e %r:%i' ) AS 'start_time'
FROM shows A, tz_settings B
WHERE A.id =1
AND B.tz_id = A.tz_id 
```

*结果和预想的一样！*

* * *

无论如何，您应该以完整格式存储 GMT OFFSET 以简化查询，从而丢失 CONCAT 并提高性能。例如：而不是 +5，存储 +05:00

这对您有任何帮助吗？

* * *

**编辑以包括 MYSQL IF 和替换**

```
SELECT Date_format( CONVERT_TZ( CONVERT_TZ( A.STAT_TIME, '+00:00', '-5:00' ) , '+00:00', if( B.GMT_OFFSET LIKE '%.5', REPLACE( B.GMT_OFFSET, '.5', ':30' ) , CONCAT( B.GMT_OFFSET, ':00' ) ) ) , '%Y-%m-%e %r:%i' ) AS 'start_time'
FROM shows A, tz_settings B
WHERE A.`id` =1
AND B.`tz_id` = A.`tz_id` 
```

因此，如果存储的 GMT OFFSET 为 0.5，它将被替换为 :30，否则，它将 :00 附加到现有值。（经过测试并按预期返回值）

# php - 什么是资源密集型，fopen+fwrite OR mysql_query()

> ID：10355962
> 
> 赞同：0
> 
> 时间：2012-04-27T18:31:33.993
> 
> 标签：php, mysql, nginx

我正在编写一个相当大的脚本，必须处理大量数据，但是其中有一部分用于记录，我想知道，什么使用更少的资源，将文件添加到 txt 文件或 mysql 中的一行询问？我将如何进行测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T18:33:22.647

```
$start = microtime(); 

// your process here

$end = microtime();

// Compare duration. 
```

# facebook-graph-api - 是否可以检索 Facebook 页面的创建时间/日期？

> ID：10355963
> 
> 赞同：0
> 
> 时间：2012-04-27T18:31:38.217
> 
> 标签：facebook-graph-api, access-token, facebook-page

从[http://graph.facebook.com/page_id](http://graph.facebook.com/page_id)获得的信息提供了有关页面的基本信息，但不包括有关 Facebook 页面的 created_time 的任何信息。

如果检索到管理页面的访问令牌，是否可以获得此信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T18:34:31.557

不，API 中没有可检索的此类字段，但如果页面启用了时间轴，他们可能添加了“成立”日期或类似的里程碑，这可能取决于您正在做什么

# java - J2ME - 无法在客户端关闭输出流，服务器挂起等待数据 [诺基亚 J2ME 实现]

> ID：10355970
> 
> 赞同：3
> 
> 时间：2012-04-27T18:32:21.243
> 
> 标签：java, sockets, java-me, nokia

我的问题是：有没有办法执行套接字 OutputStream 关​​闭，或者它不正确/完全实现，因为它应该由诺基亚实现？（J2ME nokia 实现，在 nokia c6-00 测试并且没有关闭流，在模拟器上测试并且工作正常）

主要问题是 J2SE 服务器应用程序没有获得流信息的结尾，条件 read(buffer) == -1 永远不会为真，尝试从空流中读取并挂起，直到客户端被强制终止。这适用于服务器端应用程序上非常非常非常丑陋的解决方法

```
 Thread.sleep(10);//wait some time for data else you would get stuck........
        while ((count = dataInputStream.read(buffer)) != -1) {
            byteArrayOutputStream.write(buffer, 0, count);
            if (count != BUFFER_SIZE_1024 || dataInputStream.available() == 0) { //the worlds worst condition ever written... but works
                break;
            }
            Thread.sleep(10);//wait for data input to get some data for dataInputStream.available() to return != 0 if client still sends data else you would not read all data......
        } 
```

但是这个解决方案是绝对不能接受的（我对诺基亚 java 编码一无所知，我遗漏了一些东西，或者它可能类似于某种 nokia-J2ME 编码标准，我应该习惯它或改变平台）

发送数据后我无法关闭客户端套接字，因为服务器在接收和处理数据后向客户端发送响应。

它看起来像这样：J2ME 客户端 -> J2SE 服务器（由于客户端不执行输出流关闭而挂起读取） -> J2ME

我尝试过：关闭 J2ME 客户端上的 dataOutputStream - 无效果 setSocketOptions（KEEPALIVE、SNDBUF 等） - 无效果或错误

目标设备上似乎没有任何效果

抱歉，在与小 Java 进行了这场无意义的战斗之后，我现在有点生气。

我已经寻找解决方案，但似乎没有工作

客户端代码：

```
 SocketConnection socketConnection = (SocketConnection) Connector.open("socket://" + ip + ":" + port);
        int count;
        byte[] buffer = new byte[BUFFER_SIZE_1024];
        // client -> server
        DataOutputStream dataOutputStream = new DataOutputStream(socketConnection.openDataOutputStream());
        ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(bytes);
        while ((count = byteArrayInputStream.read(buffer)) != -1) {
            dataOutputStream.write(buffer, 0, count);
            dataOutputStream.flush();
        }
        dataOutputStream.close();
        byteArrayInputStream.close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T18:48:36.913

对于 J2SE，我的建议是从 Socket 初始化，`java.nio.channels.SocketChannel`并在合理的超时到期后中断被阻塞的线程。

我不确定您要修复哪一侧，但看起来对于 J2ME，您唯一的选择是[设置套接字超时](http://docs.oracle.com/javase/6/docs/api/java/net/Socket.html#setSoTimeout%28int%29)。

**编辑**

实际上，既然您已经发布了客户端代码，我就看到了问题所在。如果由于某种原因从 while 循环中抛出异常，则不会关闭输出流。

这是我建议的解决方法：

```
 ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(bytes);

    try
    {
        DataOutputStream dataOutputStream = new DataOutputStream(
                  socketConnection.openDataOutputStream()
                  );
        try
        {
            while ((count = byteArrayInputStream.read(buffer)) != -1) {
                dataOutputStream.write(buffer, 0, count);
                dataOutputStream.flush();
            }
        }
        finally
        {
            dataOutputStream.close();
        }
    }
    finally
    {
        byteArrayInputStream.close();
    } 
```

请注意，关闭 ByteArrayInputStream 并不是绝对必要的，但代码有变异的习惯，有一天输入流可能会变成需要显式关闭的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T00:32:12.437

我已经尝试过具有相同效果的代码 - 在模拟器上就像一个魅力，在设备上挂起但我解决了我的问题如下：

On the J2ME client before sending the 1024 byte packet I'm sending its length and its state (`IsNext` or `IsLast`) after this on the J2SE server side in a `while(true)` loop. I'm reading first the length with a `readShort`, then state with a `readByte` (I know it's better to combine it on a one short but I didn't knew if it will work and if the effort was worth it and now when it works I'm not touching this, besides it is easy to add a new state if necessarily and it works quite fast).

After this server goes in to a second nested loop [ `while (dataInputStream.available() < length) {}` - I'll have to put here a timeout but I'll worry about that later. Also note that on J2ME `dataInputStream.available()` always returns a 0 (!) so in the J2ME client read in this place is a `for (int i = 0; i < length... loop` reading a single byte]

当`while(dataInputStream.available() ...`循环中断时，我正在读取我有长度的数据块，如果状态是`IsLast`我打破`while(true)`循环。工作完美且稳定。

感谢您的建议，希望此信息对某人有所帮助

# android - 如何通过 EditText 过滤 ListView

> ID：10355971
> 
> 赞同：7
> 
> 时间：2012-04-27T18:32:22.373
> 
> 标签：android, listview, filter, android-edittext

我正在为Android制作一个类似电子书的应用程序，我想过滤书名，但每次你在edittext中输入一个单词或句子时，它都会搜索书籍的内容。

有人可以帮我弄这个吗...

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-27T20:33:46.927

试试这个，每当你在编辑文本中输入文本时，列表将显示过滤结果，因为我已经在图像中显示了内容

**最初的：**

![最初的](../Images/1004bcade53420e03dd8cc5bd588283b.png)

**过滤：**

![过滤：](../Images/d154b387671ce143789f305560d24f47.png)
这是 main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<EditText 
    android:id="@+id/etSearchbox"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    />
<ListView 
    android:id="@+id/lvFirst"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"

    ></ListView>    

</LinearLayout> 
```

这是 FilterListActivity.java

```
package com.filterlist;

import android.app.Activity;
import android.os.Bundle;
import android.text.Editable;
import android.text.TextWatcher;
import android.widget.ArrayAdapter;
import android.widget.EditText;
import android.widget.ListView;

public class FilterListActivity extends Activity{

EditText etSearchbox;
ListView lvFirst;
ArrayAdapter<String> adapter1;
String[] data = {"mehul joisar","amit mishra","amitabh","Aamir khan","jesica","katrina"};

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

etSearchbox=(EditText)findViewById(R.id.etSearchbox);
lvFirst=(ListView)findViewById(R.id.lvFirst);
lvFirst.setTextFilterEnabled(true);

adapter1 = new ArrayAdapter<String>(FilterListActivity.this, android.R.layout.simple_list_item_1, data);   
lvFirst.setAdapter(adapter1);

etSearchbox.addTextChangedListener(new TextWatcher() {

    @Override
    public void onTextChanged(CharSequence arg0, int arg1, int arg2, int arg3) {
        // TODO Auto-generated method stub
        FilterListActivity.this.adapter1.getFilter().filter(arg0);
    }

    @Override
    public void beforeTextChanged(CharSequence arg0, int arg1, int arg2,
            int arg3) {
        // TODO Auto-generated method stub

    }

    @Override
    public void afterTextChanged(Editable arg0) {
        // TODO Auto-generated method stub

    }
});

}
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-27T20:53:43.193

我有一个工作示例，试试这个：

```
filterEditText = (EditText)findViewById(R.id.filter);
filterEditText.addTextChangedListener(filterTextWatcher);

TextWatcher filterTextWatcher = new TextWatcher() {

        public void beforeTextChanged(CharSequence s, int start, int count,int after) {  

        }  
        public void onTextChanged(CharSequence s, int start, int before,int count) {  
            adapter.getFilter().filter(s);
        }

        @Override
        public void afterTextChanged(Editable s) {
            // TODO Auto-generated method stub              
        }  
    }; 
```

适配器必须`implements Filterable`

```
 @Override
            public Filter getFilter() {
//              Filter filter = null;

                if(filter == null)
                    filter = new CheeseFilter();
                return filter;
            } 
```

和过滤器类：

```
 public class CheeseFilter extends Filter {

            @Override
            protected FilterResults performFiltering(CharSequence constraint) {
                // TODO Auto-generated method stub

                constraint = constraint.toString().toLowerCase();

                FilterResults newFilterResults = new FilterResults();

                if (constraint != null && constraint.length() > 0) {

                    ArrayList<String> auxData = new ArrayList<String>();

                    for (int i = 0; i < data.size(); i++) {
                        if (data.get(i).toLowerCase().contains(constraint))
                            auxData.add(data.get(i));
                    }

                    newFilterResults.count = auxData.size();
                    newFilterResults.values = auxData;
                } else {

                    newFilterResults.count = data.size();
                    newFilterResults.values = data;
                }

                return newFilterResults;
            }

            @Override
            protected void publishResults(CharSequence constraint, FilterResults results) {

                ArrayList<String> resultData = new ArrayList<String>();

                resultData = (ArrayList<String>) results.values;

                EfficientAdapter adapter = new EfficientAdapter(context, resultData);
                list.setAdapter(adapter);

//              notifyDataSetChanged();
            }

        } 
```

您可以查看此帖子以获取更多信息：

[过滤可扩展列表](https://stackoverflow.com/questions/5775774/custom-expandable-list-view-with-child-search-filter)

[过滤列表视图](https://stackoverflow.com/questions/5658751/filter-list-view-from-edit-text)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-24T12:56:24.797

当您使用自定义 listView

适配器 ：

```
public class Adapter extends ArrayAdapter {
ArrayList<String> list = new ArrayList<>();
ArrayList<String> filteredData = new ArrayList<>();

public Adapter(@NonNull Context context, int resource) {
    super(context, resource);
}

@NonNull
@Override
public View getView(int position, @Nullable View convertView, @NonNull ViewGroup parent) {

    LayoutInflater inflate = (LayoutInflater) getSystemService(LAYOUT_INFLATER_SERVICE);
    @SuppressLint("ViewHolder") View vi = inflate.inflate(R.layout.ly_items, null);
    try {
        JSONObject js = new JSONObject(list.get(position));
        TextView txtItem = vi.findViewById(R.id.txtItem);
        ImageView imgItem = vi.findViewById(R.id.imgItem);
        txtItem.setText(js.getString("name") + " - " + js.getInt("number"));
        Picasso.get().load(js.getString("logo_url")).into(imgItem);

    } catch (JSONException e) {
        e.printStackTrace();
    }

    return vi;
}

@Override
public void add(@Nullable Object object) {
    super.add(object);
    list.add(object.toString());
    filteredData.add(object.toString());
}

@Override
public int getCount() {
    return list.size();
}

@Nullable
@Override
public Object getItem(int position) {
    return list.get(position);
}

public void filter(String charText) {
    charText = charText.toLowerCase(Locale.getDefault());
    list.clear();
    if (charText.length() == 0) {
        list.addAll(filteredData);
    } else {
        for (String wp : filteredData) {

            try {
                JSONObject json = new JSONObject(wp);
                if (json.getString("name").toLowerCase().contains(charText) || json.getString("number").contains(charText)) {
                    list.add(wp);
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }
    }
    notifyDataSetChanged();
    }
} 
```

还有你的课：

```
 Adapter adapter;
ListView list;
EditText edtSearch;

 @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

list = findViewById(R.id.list);

edtSearch = findViewById(R.id.edtSearch);

 adapter = new Adapter(this, android.R.layout.simple_list_item_1);

list.setAdapter(adapter);

edtSearch.addTextChangedListener(new TextWatcher() {
            @Override
            public void beforeTextChanged(CharSequence s, int start, int count, int after) {
            }

            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count) {
                adapter.filter(s.toString());
            }

            @Override
            public void afterTextChanged(Editable s) {
            }
        });

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T18:38:10.193

您需要为edittext 编写textChangedlistener（或）TextWatcher。在侦听器内部，您需要编写搜索逻辑。这是[APIdoc](http://developer.android.com/reference/android/widget/TextView.html#addTextChangedListener%28android.text.TextWatcher%29)。这是关于[textwatcher](http://www.technotalkative.com/android-about-edittext-textwatcher/)的示例。

# python - sed 正则表达式到 Python re

> ID：10355977
> 
> 赞同：2
> 
> 时间：2012-04-27T18:32:42.493
> 
> 标签：python, regex, sed

谁能帮我把这个正则表达式翻译成 Python`re`模块？

`sed -e "s/^[^ ]* \([^ ]*\) \([0-9]*\) \([0-9:]*\) \([0-9]*\) /\1 \2 \4 \3 /"`

据我了解，这将一个文本替换为另一个文本。如何使用`re`模块创建类似的东西？谢谢！

例如`Fri Mar 21 07:16:51 2008 -0600`将转换为`Mar 21 2008 07:16:51 -0600`.

```
source = 'Fri Mar 21 07:16:51 2008 -0600'
pattern = re.compile('^[^ ]* \([^ ]*\) \([0-9]*\) \([0-9:]*\) \([0-9]*\) ')
result = re.sub('\\1 \\2 \\4 \\3 ', source) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T19:01:49.550

也将反斜杠放在模式中的括号上，如下所示：

```
pattern = re.compile('^[^ ]* ([^ ]*) ([0-9]*) ([0-9:]*) ([0-9]*) ') 
```

按照您的方式，您正在逃避需要被识别为分组的括号，以便您实际捕获与 \1 ... \4 相对应的四个组

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T19:03:57.233

试试这个，单行版本：

```
import re
re.sub(r'^[^ ]* ([^ ]*) ([0-9]*) ([0-9:]*) ([0-9]*) ', '\g<1> \g<2> \g<3> \g<4>', source) 
```

或者，使用编译模式 - 如果要重用相同的正则表达式，效率会更高：

```
import re
pattern = re.compile(r'^[^ ]* ([^ ]*) ([0-9]*) ([0-9:]*) ([0-9]*) ')
pattern.sub('\g<1> \g<2> \g<3> \g<4>', source) 
```

# asp.net - 隐藏链接按钮

> ID：10355979
> 
> 赞同：0
> 
> 时间：2012-04-27T18:32:47.160
> 
> 标签：asp.net, vb.net, linkbutton

在 VB.NET 中，我有一个`LinkButton`，单击时会创建一个报告。我们希望根据谁登录到系统来禁用此功能。我有一个会话变量来指示这是否应该可见，但是当我设置时`idLinkButton.visible = False`，它没有效果。关于我需要做什么才能打开和关闭它的任何想法？

'code-behind
' in page_load
If Not Convert.ToBoolean(HttpContext.Current.Session("HideReports")) Then
PDFbutton.Visible = True
Else If Convert.ToBoolean(HttpContext.Current.Session("HideReports")) And HttpContext. Current.Session("LoadFromConsole") Then
PDFbutton.Visible = True
end if

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T21:29:23.140

首先，您是否尝试在 if/then 逻辑之外设置 .Visible = false ？

如果可行，那么您需要对逻辑进行故障排除。将我的第一行添加到上面显示的内容中，然后将第一行更改为我的第二行。

```
Dim hideRpt as Boolean = Convert.ToBoolean(HttpContext.Current.Session("HideReports")) 
If Not hideRpt Then 
```

现在在“If Not...”行放置一个断点。

如果您没有得到预期的结果，请添加另一行来获取会话值的字符串，以确保它确实应该转换为布尔值。

基本的故障排除，伙计，把它分解成更小的部分。有时我会启动一个新的 Windows 应用程序，只是为了有一张白板来处理细节。

# c++ - 在 C++ 中重用文件流？

> ID：10355980
> 
> 赞同：1
> 
> 时间：2012-04-27T18:32:52.663
> 
> 标签：c++, filestream, argv

我有一个将多个文件作为输入的程序。我想要做的是使用相同的文件流？尝试使用第二个文件打开流时，我不断收到错误消息。为什么代码无效并在编译时产生错误？argv[2] 是一个 const char*。

错误：不匹配调用 '(std::ifstream) (char*&)'

```
ifstream fin(argv[1]);
  //work with filestream
fin.close();

fin(argv[2]);
  //work with filestream
fin.close(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T18:35:32.290

第一行`ifstream fin(argv[1]);`是 evoking`ifstream`的构造函数，每个对象只能调用一次构造函数。您的代码正在尝试再次调用它。尝试使用[open()](http://www.cplusplus.com/reference/iostream/ifstream/open/)代替：

```
fin.open(argv[2]); 
```

[顺便说一句](http://www.cplusplus.com/reference/iostream/ios/clear/)，您可能还想在重新打开`ifstream`. 这样做的原因是，如果第一个 open()（甚至 close()）失败，`ifstream`则会设置错误位，并且不会被 close() 清除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T18:40:25.537

使用本地范围：

```
{
  ifstream fin(argv[1]);
  //work with filestream
}

{

  ifstream fin(argv[2]);
  //work with filestream
} 
```

请注意，您不需要手动关闭流，当它们超出范围时会自动处理。

# android - Gps追踪应用数据发送方法

> ID：10355985
> 
> 赞同：1
> 
> 时间：2012-04-27T18:33:16.647
> 
> 标签：android, gps

我想创建客户端-服务器 GPS 跟踪应用程序，客户端将位置数据发送到服务器，服务器将它们保存在数据库中，并为站点用户显示客户端位置车队位置并为他们提供报告。
在这个应用程序中，我不知道我可以使用哪种方法。客户端应用程序是 android 应用程序，服务器应用程序是基于 Web 的应用程序。
客户端向服务器发送数据的方法：
1) 在客户端使用 web 服务，通过 web 服务向服务器发送数据
2) 在客户端应用程序中使用 MQTT，使用 MQTT 发送数据
在第一种方法中，因为当 Web 服务想要将数据发送到使用 XML 的服务器时数据很少，这会增加数据大小！获取位置数据的Web服务器首先需要解压并从Web服务包中获取位置数据，这可以使用服务器资源！但是方法2将位置数据直接发送到服务器但难以实现和编码！
您提供哪些方法供我在此应用程序中使用？
另一个问题是，如果我想将此应用程序扩展到其他客户端平台，如 iphone，上述哪种方法是最佳的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T19:10:12.697

您是否考虑过使用 REST 服务？因此，您的跟踪设备基本上只会调用 REST url 并向其发布数据。没有数据大小或压缩过载。Android 或 iPhone 应用程序可以使用相同的 REST 服务。

# java - 如何让 Mybatis Maven 插件使用不同的 java.library.path

> ID：10355988
> 
> 赞同：1
> 
> 时间：2012-04-27T18:33:26.723
> 
> 标签：java, maven, native, pom.xml, mybatis

我目前正在使用 mybatis 生成 java 文件。问题是我需要本地库才能访问我的数据库。我将如何使用当前插件处理这个问题？

这是我的 pom 的样子：

```
<plugin>
    <groupId>org.mybatis.generator</groupId>
    <artifactId>mybatis-generator-maven-plugin</artifactId>
    <version>1.3.1</version>
    <executions>
      <execution>
        <id>Generate MyBatis Artifacts</id>
        <goals>
          <goal>generate</goal>
        </goals>
      </execution>
    </executions>
    <dependencies>
      <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.6</version>
      </dependency>
      <dependency>
        <groupId>package.needs.native</groupId>
        <artifactId>needs-native</artifactId>
        <version>1.2.3</version>
      </dependency>
    </dependencies>
  </plugin> 
```

# java - 在 OSX 上通过 Maven 运行的 Jetty - 阻止“启动器”应用程序打开

> ID：10355989
> 
> 赞同：5
> 
> 时间：2012-04-27T18:33:28.263
> 
> 标签：java, macos, maven, jetty

我们有一个使用嵌入式码头容器的 java 应用程序。当我们通过 mvn jetty:run 在 OSX 上通过 maven 启动它时，会打开一个带有 title 的 java 应用程序`org.codehaus.plexus.classworlds.launcher.Launcher`。当它打开时，它会从前景中的任何东西中窃取焦点。有什么办法可以预防吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-18T23:57:21.260

运行

```
-Djava.awt.headless=true 
```

您可以在您的 Mac 机器环境中的 MAVEN_OPTS 中添加它（即，在 ~/.profile 或您的外壳查找的任何内容中）

# c# - 用于检测另一幅图像中带有一些噪声的图像的算法

> ID：10355993
> 
> 赞同：2
> 
> 时间：2012-04-27T18:33:50.653
> 
> 标签：c#, .net, algorithm, ocr, detection

我正在寻找最好的库来搜索两个不同图像中的相同区域，所有图像都以 JPEG 压缩，有很多噪音。我很难找到一个。问题是，如果您缩放 jpeg，您会看到它看起来像莫奈，我的意思是，噪声包含与原始图像没有直接链接的调色板。因此，我需要找到“最相似的数组”，而不是在图像中搜索相同的数组。

这些图片来自googlemap类似网站的随机截图，图片不能是jpeg以外的其他格式。

我尝试了很多手动方式。

我的方法之一是：

*   将我的两个图像转换为较小的图像*   在 4bpp 图像中更改它们，甚至更少的颜色*   拍摄图像 1 的一小部分*   在图像 2 中搜索图像 1 的裁剪部分的 byte[] 数组版本*   不是寻找相同的，而是寻找相似的匹配。

    该算法有效，但我在一维数组中做所有事情，而且速度很慢。

    是否有可以直接执行此算法的现有库？

    我的算法是：

    ```
     // Where SRC is the bigger image in which I search
        // Offset is where in my small image I start to search
        // Len is how long is my searched array
        // Size is the size of the bigger image in which I'm searching.
        // private Point simpleSearch(byte[] src, int offset, int len, byte[] search, Size size)
        {
            byte[] ddd = new byte[len];
            Array.Copy(search, offset, ddd, 0, len);
            int lowest = 100000000;
            int locmatch = 0;
            for (int i = 0; i < src.Length - len; i++)
            {
                int thed = 0;
                for (int a = 0; a < len; a++)
                {
                    int diff = Math.Abs(src[i + a] - ddd[a]);
                    thed += diff;
                }

                thed = thed / len;
                if (thed < lowest)
                {
                    lowest = thed;
                    locmatch = i-len;
                }
            }

            int yy = (locmatch / size.Width);
            int xx = locmatch - (yy * size.Width);
            Point p = new Point(xx, yy);
            return p;
        } 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T21:20:10.573

是的，相关性或光谱特征是判断两个图像区域相似程度的方法。但我认为您在这里真正想要的是一种**有效搜索重叠区域**的算法。

[对应问题](http://en.wikipedia.org/wiki/Correspondence_problem)是计算机视觉中一个定义明确的问题，它试图找出图像的哪些部分对应于另一个图像的哪些部分。有基于[RANSAC](http://en.wikipedia.org/wiki/RANSAC)的算法。

还有[一种四叉树算法](http://www.iaeng.org/publication/WCE2010/WCE2010_pp687-691.pdf)可以将复杂度降低到对数顺序。

# git - 搞砸了主 git 分支......无法弄清楚我需要恢复什么

> ID：10355995
> 
> 赞同：4
> 
> 时间：2012-04-27T18:33:55.203
> 
> 标签：git, github, git-revert, git-reflog

我正在开发一个 git 存储库，它有一个 master 分支，我们称之为`ab`分支。我的团队正在`ab`分支上工作，并且有一个使用 github 的拉取请求工作流。我的一个队友从他的分支`jeremy_ab_deletions`向`ab`分支提出了拉取请求。我正在审查/测试他的更改，但是当我将它们合并到`ab`分支中时，我不小心将它们合并到了 master 中，并在我发现错误之前将 master 推送到了 github。以为我可以 git-revert 我所做的更改`git revert SHA`并且它似乎有效......

我认为这已经足够了，我很高兴地切换回我的 ab 分支并继续工作。然而，现在，我意识到以前从`ab`分支中提交的*永远不*应该在 master 中结束的提交都在 master 中。这……真是一团糟。由于他的分支最初是从 中分离出来的`ab`，然后我将它合并到 master 中，我应该使用`git revert -m 1 SHA`.

今天我试图弄清楚我到底哪里出错了，我对 git 历史和我的 reflog 感到很困惑。首先，我尝试还原还原，然后执行`git revert -m 1 SHA`但 git 告诉我：

```
fatal: Mainline was specified but commit 4c431c345dfe0a856967c090932c32f153824085 is not a merge. 
```

所以我认为好吧......也许那不是合并提交，我需要针对不同的 SHA。但是看看历史，我一生都无法弄清楚其中哪一个是合并提交......

```
This was supposed to be on AB... 
…
d985b5bcf8 Browse code
Nathan B authored 8 days ago

This was supposed to be on AB... 
…
0e01911273 Browse code
Nathan B authored 8 days ago

removed unecessary tests
4c431c345d Browse code
Nathan B authored 8 days ago
Apr 17, 2012

removing un-used views and pages
a546f90ed3 Browse code
jeremychurch authored 10 days ago 
```

说“这应该在 AB 上”的两个提交是还原提交以还原“已删除的不必要测试”和“删除未使用的视图和页面”提交。对 master 的下一次提交是今天，之前的提交是在 16 日，两者都不相关。我没有看到实际*合并*发生在哪里。

我浏览了我的 reflog，看看到底哪里出了问题。`git reset --hard HEAD@{NUM}`我使用然后检查关键文件以查看错误更改是否存在于那个位置，然后使用并检查reflog 版本。最后，我将范围缩小到这些 reflog：

```
1fe2be2 HEAD@{79}: checkout: moving from 1fe2be29c6eda9f9fc9eb0b372ee83b7c15dfc2c to jeremy_ab_deletions
1fe2be2 HEAD@{80}: HEAD@{3}: updating HEAD
4c431c3 HEAD@{81}: HEAD@{1}: updating HEAD
47a97af HEAD@{82}: commit: removed unecessary tests, routes, and controller actions
4c431c3 HEAD@{83}: merge jeremy_ab_deletions: Fast-forward
1fe2be2 HEAD@{84}: checkout: moving from master to ab
d985b5b HEAD@{85}: revert: This was supposed to be on AB...
0e01911 HEAD@{86}: revert: This was supposed to be on AB...
4c431c3 HEAD@{87}: merge jeremy_ab_deletions: Fast-forward
c121a08 HEAD@{88}: checkout: moving from jeremy_ab_deletions to master
4c431c3 HEAD@{89}: commit: removed unecessary tests
a546f90 HEAD@{90}: checkout: moving from ab_page_changes to jeremy_ab_deletions
511b340 HEAD@{91}: checkout: moving from jeremy_ab_deletions to ab_page_changes
a546f90 HEAD@{92}: pull git@github.com:REDACTED/repo.git ab-remove-stuff: Fast-forward 
```

特别是 HEAD@{88} 这里没有错误的提交，而 HEAD@{87} 有。因此有理由假设我在提交上搞砸了`merge jeremy_ab_deletions: Fast-forward`......但我无法弄清楚那将是哪个“合并提交”。我试过这个：

```
$ git revert -m 1 4c431c3
fatal: Mainline was specified but commit 4c431c345dfe0a856967c090932c32f153824085 is not a merge. 
```

我......似乎找不到实际的合并提交？有谁知道我做错了什么：/我现在很迷茫。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-27T18:44:30.810

如果没有其他人拉过这个主人（或拉过但肯定没有使用它），这就是我会做的：

1.  如果自“意外”以来没有在 master 上完成任何工作，我只需将其重置为最后一次好的提交，然后更新远程 master 分支（通过使用 -f 推送）。
2.  如果某些工作已经完成，您可以将其重置为最后一个好的提交，然后使用`git rebase -i`并删除有问题的提交，将好的提交留在列表中。然后你需要再次推动（使用`-f`）。

或者，您可以在新分支中执行所有这些操作：

1.  签出 master 中最后一个好的提交，在那里创建一个分支，
2.  然后用于`git rebase -i master`过滤掉错误的提交。
3.  然后您可以返回 master 并手动“合并”，从新分支中引入所有更改，并覆盖 master 中的所有内容（您可以使用`--no-commit`and `git checkout --theirs`）
4.  推（*不* `-f`）固定的主人。

希望这可以帮助！我讨厌*合并*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T19:50:55.980

更新：虽然这可能对其他人有所帮助，但这实际上让我更沮丧。我会把这个留在这里，以防其他人偶然发现它。

sinelaw 为我指明了正确的方向……但我在这里找到了更合适的答案： [Revert to a commit by a SHA hash in Git?](https://stackoverflow.com/questions/1895059/git-revert-to-a-commit-by-sha-hash)

答案的信息如下：

> 如果您想在当前 HEAD 之上以不同提交的确切状态提交，撤消所有中间提交，那么您可以使用 reset 来创建索引的正确状态以进行提交。

这正是我想要的。我想恢复到 HEAD@{88} 但是让它恢复它自己的提交，因为有些人已经拉了主分支，我不想让他们像我必须的那样经历重置步骤......所以这些是我使用的命令：

```
# reset the index to the desired tree
git reset HEAD@{88}

# move the branch pointer back to the previous HEAD
git reset --soft HEAD@{1}

git commit -m "Revert the bad ab merge"

# Update working copy to reflect the new commit
git reset --hard

# Clean untracked files
git clean -f -d 
```

查看历史记录，我可以看到我刚刚创建了一个提交，其中完全反转了所有应该专属于 ab 分支的更改。

（更新）：没关系，这不是我想要的。我们的仓库有几个分支，以及“主”分支。master 旨在保存其他 3 个分支中通用的更改，并且它经常合并到这些分支中。执行此 revert-with-a-commit 系列命令使 master 合并到“ab”分支（或任何分支）成为合并冲突和意外删除文件的严重噩梦（因为它们*应该*存在于 ab ，只是不在master中）。我采用了上述 sinelaw 的解决方案，并与一位非技术设计师合作，该设计师也将 master 拉回了好版本。

# ios - 应用程序是否可以更新OTA

> ID：10355997
> 
> 赞同：0
> 
> 时间：2012-04-27T18:34:12.403
> 
> 标签：ios, ota

我正在开发一个应用程序，并且我有用户为我测试该应用程序，有时我需要修复一个错误并将我的应用程序重新上传到我的网站，并让我的 beta 测试人员下载到最新版本。我的问题是我的应用程序是否有办法检查网站上是否有新版本可供下载和安装？

请记住，我目前还没有浏览应用商店，只是让几个朋友测试我的应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T09:27:07.207

您可以使用[Testflight](https://testflightapp.com/dashboard/)在您的朋友中分发您的应用程序的测试版。为此，您只需在 Xcode 中存档您的应用程序并将其上传到 Testflight。您的测试人员将通过电子邮件收到有关应用程序构建更新的通知，并将能够下载新的构建 OTA。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T18:42:08.077

是的，可以使用[TestFlight](https://testflightapp.com/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T18:35:40.497

不，它还不可能。

您的应用可以检查是否有可用更新，然后将用户重定向到应用商店页面，但您不能像核心 iOS 那样更新 OTA

# sql-server - 如何在 t-sql 中旋转和计算百分比？

> ID：10355998
> 
> 赞同：6
> 
> 时间：2012-04-27T18:34:13.757
> 
> 标签：sql-server, tsql, pivot

我有一个看起来像这样的表：

```
 DECLARE @myTable TABLE (country varchar(max), code int)  
    INSERT @myTable
    SELECT 'A', 1 UNION ALL
    SELECT 'A', 1 UNION ALL
    SELECT 'A', 1 UNION ALL
    SELECT 'A', 2 UNION ALL
    SELECT 'A', 2 UNION ALL
    SELECT 'B', 1 UNION ALL
    SELECT 'B', 1 UNION ALL
    SELECT 'B', 1 UNION ALL
    SELECT 'B', 1 UNION ALL
    SELECT 'B', 2 UNION ALL
    SELECT 'C', 1 UNION ALL
    SELECT 'C', 1 UNION ALL
    SELECT 'C', 1 ; 
```

我想关闭 A/B/C，然后计算 2 的数量并计算 2 占总数的百分比。

我可以用这个查询得到 2s 的数量

```
 DECLARE @mySecondTable TABLE (country varchar(max), code int);
    INSERT @mySecondTable
       SELECT * FROM @myTable 
       WHERE code=2;

    SELECT [A], [B], [C]
    FROM
     (SELECT Country, code
      FROM @mySecondTable) AS source
    PIVOT
    (
      COUNT(code)
      FOR Country IN ([A], [B], [C]) ) AS pvt; 
```

但我真的希望它看起来像这样：

```
 A          B         C
  2 (40.0%)   1 (20.0%)  0 
```

如何获得总数并计算百分比？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T19:17:20.287

```
DECLARE @myTable TABLE (country varchar(max), code int)  
    INSERT @myTable
    SELECT 'A', 1 UNION ALL
    SELECT 'A', 1 UNION ALL
    SELECT 'A', 1 UNION ALL
    SELECT 'A', 2 UNION ALL
    SELECT 'A', 2 UNION ALL
    SELECT 'B', 1 UNION ALL
    SELECT 'B', 1 UNION ALL
    SELECT 'B', 1 UNION ALL
    SELECT 'B', 1 UNION ALL
    SELECT 'B', 2 UNION ALL
    SELECT 'C', 1 UNION ALL
    SELECT 'C', 1 UNION ALL
    SELECT 'C', 1 ;

    DECLARE @mySecondTable TABLE (country varchar(10), pct varchar(20), code int);
    INSERT @mySecondTable
       SELECT country
       , pct=cast(count(*)over(partition by country,code) as varchar(10))
            +' ('+cast(100*
                cast(count(*)over(partition by country,code)as decimal(3,2))
                / CAST(count(*)over(partition by country) as decimal(3,2)) as varchar(10))
            +'%)'
       , code
       FROM @myTable

    SELECT [A], [B], [C]
    FROM
     (SELECT Country, pct
      FROM @mySecondTable
      WHERE code=2
      ) AS source
    PIVOT
    (
      MAX(pct)
      FOR Country IN ([A], [B], [C]) ) AS pvt; 
```

结果：

![在此处输入图像描述](../Images/4d5f94044cb3b44a5c0f2700bdf284d4.png)