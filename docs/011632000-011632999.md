# StackOverflow 问答 11632000-11632999

# java - javac完成的任何类型转换？

> ID：11632000
> 
> 赞同：9
> 
> 时间：2012-07-24T13:33:13.620
> 
> 标签：java, casting, javac

据我了解，如果可以在编译期间进行类型检查，则类型转换将在编译期间完成，不会产生任何运行时开销。

例如

```
public Child getChild() {
  Parent o = new Child();
  return (Child) o;
} 
```

类型转换是在编译期间还是在运行时完成的？

是否有任何一般规则来决定类型转换是由 javac 编译器还是由 VM 完成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:47:22.443

实际上，这种情况有三种可能：

1.  编译器`javac`可以执行优化。
2.  JIT 编译器可以执行优化。
3.  JIT 编译器的本机代码可以包含执行运行时类型检查的代码。

我希望它是选项 1\. 或 2\. 但这可能是特定于平台的。

* * *

事实上，在我的系统上，字节码并没有优化。如果要进行任何优化，它将由 JIT 编译器来完成。（这符合我所听到的……大多数 Java 字节码编译器在生成字节码之前几乎没有做任何优化。）

```
Compiled from "Test.java"
public class Test extends java.lang.Object{
public Test();
  Code:
   0:   aload_0
   1:   invokespecial   #8; //Method java/lang/Object."<init>":()V
   4:   return

public Child getChild();
  Code:
   0:   new #16; //class Child
   3:   dup
   4:   invokespecial   #18; //Method Child."<init>":()V
   7:   astore_1
   8:   aload_1
   9:   checkcast   #16; //class Child
   12:  areturn

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T13:41:26.603

当正在运行的程序尝试将对象引用转换为另一种类型时，虚拟机必须检查被转换为的类型是被引用对象的实际类还是它的超类型之一。当程序执行 instanceof 操作时，它必须执行相同类型的检查。

在任何一种情况下，虚拟机都必须查看被引用对象的类数据。当程序调用实例方法时，虚拟机必须执行动态绑定：它必须选择调用的方法不是基于引用的类型，而是基于对象的类。为此，它必须再次访问仅给定对象引用的类数据。

***编辑：***

Java 编译器不负责检查转换是否正确，就像某些绑定只在运行时发生一样。Java 虚拟机在运行时进行检查以确定实际引用对象是否是新类型的合法对象。如果没有，就会出现运行时异常：ClassCastException。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:06:48.963

当我编译

```
public class Test {
    public Child getChildVersion1() {
        Parent o = new Child();
        return (Child) o;
    }
    public Child getChildVersion2() {
        return new Child();
    }
} 
```

`javap -c Test`并使用Java 7（Windows 7 64bit）反编译该代码，它给了我这个结果

```
Compiled from "Test.java"
public class Test {
  public Test();
    Code:
       0: aload_0
       1: invokespecial #1                  // Method java/lang/Object."<init>":()V
       4: return

  public Child getChildVersion1();
    Code:
       0: new           #2                  // class Child
       3: dup
       4: invokespecial #3                  // Method Child."<init>":()V
       7: astore_1
       8: aload_1
       9: checkcast     #2                  // class Child
      12: areturn

  public Child getChildVersion2();
    Code:
       0: new           #2                  // class Child
       3: dup
       4: invokespecial #3                  // Method Child."<init>":()V
       7: areturn
} 
```

因此，编译器似乎没有`getChildVersion1`像`getChildVersion2`这样优化方法，**除了在编译**时检查类型之外，**还在运行时检查**（`9: checkcast #2`）。但正如 Stephen C[提到](https://stackoverflow.com/a/11632273/1393766)的，它可能与平台（操作系统、Java 版本）有关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T13:49:57.037

对于不需要在运行时进行测试的转换，编译器可能会进行一些优化以避免在运行时进行强制转换。

我建议阅读[JLS 第 5 章。转换和促销](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.5)以了解更多关于需要在运行时进行测试的转换类型。

> 示例 5.0-1。编译时和运行时的转换

```
A conversion from type Object to type Thread requires a run-time check to make sure that the run-time value is actually an instance of class Thread or one of its subclasses; if it is not, an exception is thrown.

A conversion from type Thread to type Object requires no run-time action; Thread is a subclass of Object, so any reference produced by an expression of type Thread is a valid reference value of type Object.

A conversion from type int to type long requires run-time sign-extension of a 32-bit integer value to the 64-bit long representation. No information is lost.

A conversion from type double to type long requires a nontrivial translation from a 64-bit floating-point value to the 64-bit integer representation. Depending on the actual run-time value, information may be lost. 
```

[5.1.6。缩小参考转换](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.1.6)：

> 这种转换需要在运行时进行测试，以确定实际引用值是否是新类型的合法值。如果不是，则抛出 ClassCastException。

[5.1.8。拆箱转换](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.1.8)；转换在运行时进行。

另见：[5.5.3。运行时检查的演员表](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.5.3)

确定转换发生的时间并不容易，例如：

```
public class Main {

    private static class Child extends Parent{

        public Child() {
        }
    }

    private static class Parent {

        public Parent() {
        }
    }

    private static Child getChild() {
        Parent o = new Child();
        return (Child) o;
    }

    public static void main(final String[] args) {
        Child c = getChild();
    }
} 
```

给出的结果`javap -c Main`是：

```
public class Main extends java.lang.Object{
public Main();
Code:
0:  aload_0
1:  invokespecial   #1; //Method java/lang/Object."<init>":()V
4:  return

public static void main(java.lang.String[]);
Code:
0:  invokestatic    #4; //Method getChild:()LMain$Child;
3:  astore_1
4:  return

} 
```

如果将方法声明更改`public static Child getChild()`为结果为：

```
public class Main extends java.lang.Object{
public Main();
Code:
0:  aload_0
1:  invokespecial   #1; //Method java/lang/Object."<init>":()V
4:  return

public static Main$Child getChild();
Code:
0:  new #2; //class Main$Child
3:  dup
4:  invokespecial   #3; //Method Main$Child."<init>":()V
7:  astore_0
8:  aload_0
9:  checkcast   #2; //class Main$Child
12: areturn

public static void main(java.lang.String[]);
Code:
0:  invokestatic    #4; //Method getChild:()LMain$Child;
3:  astore_1
4:  return

} 
```

您会看到，仅更改访问器就会对可能的优化产生很大影响。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T13:41:43.897

我猜它在两个阶段都完成了。在编译时，编译器将强制您进行正确的强制转换，以确保您没有混淆类型，就像在[任何强类型语言中](http://en.wikipedia.org/wiki/Strong_typing)一样。

但是，如果你将一个`Object`你得到的参数转换为`String`（这将适用于实际上是的对象`instanceof` `String`），JVM 仍然必须确保实现类`Object`真正扩展或是，如果它不是`String`，你将得到一个`ClassCastException`吨。

# php - 确定 PHP 表达式的元素

> ID：11632001
> 
> 赞同：1
> 
> 时间：2012-07-24T13:33:14.280
> 
> 标签：php, string, expression

像这样的表达：

*   `$var`

*   `function()`

*   `$object->getProperty($var);`

*   `$object->property`

*   `$object->property->function($var)`

*   `class::function()`

等等

我想获得所有元素的列表以及它们是什么类型。例如：

`$object->property->function($var)`

要素是：

*   $object - 变量
*   财产-财产
*   函数（） - 函数
*   $var - 变量

是否有捷径可寻？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T13:35:30.243

请参阅[`token_get_all`](http://php.net/token_get_all)及其示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T13:40:31.900

为了补充**deceze**的答案，您还可以查看[NikiC 的 PHP-Parser](https://github.com/nikic/PHP-Parser)

它将代码转换为语法树而不是标记列表。

# actionscript-3 - Flex/AS3：如何在更改多个图表属性时管理图表的重新绘制？

> ID：11632002
> 
> 赞同：2
> 
> 时间：2012-07-24T13:33:16.723
> 
> 标签：actionscript-3, apache-flex

我遗漏了有关在 Flex 中制图的一些基本知识。我正在创建一个包含自动缩放功能的自定义图表组件，该功能修改图表的 x 轴和 y 轴限制，并为图表提供新的数据系列。自定义图表组件如下所示：

```
<s:Group ...>
   ...
   private function autoScale():void {
       ...
       // this is where I compute newXmin, newXmax, newYmin, newYmax, startIndex, endIndex
       ...
       haxis.minimum = newXmin;
       haxis.maximum = newXmax;
       vaxis.minimum = newYmin;
       vaxis.maximum = newYmax;
       myChart.series.dataProvider = myData.slice(startIndex, endIndex+1);
   }
   ...
   <mx:LineChart id="myChart">

       <mx:horizontalAxis>
           <charts:MyAxis id="haxis" labelFunction="setXLabels()"/>
       </mx:horizontalAxis>

       <mx:verticalAxis>
           <mx:LinearAxis id="vaxis" labelFunction="setYLabels()"/>
       </mx:verticalAxis>

   </mx:LineChart>
   ...
</s:Group> 
```

在任何时候，用户都可以放大/缩小（代码未显示），这会调用该`autoScale()`函数。

我的想法，如果我错了，请纠正我，上面的程序重新绘制图表五次（函数中显示的每一行代码一次`autoScale()`。是否可以告诉 Flex 忽略对组件的重新绘制更改，直到我发出了一些特定的命令，上面写着：“好的，现在我已经设置了我需要的一切——继续重绘图表”？

我一直在阅读`invalidateDisplayList`，但无法弄清楚这是否是它的预期应用程序，如果是，如何在此处应用它。我只见过在用于将数据传入/传出自`invalidateDisplayList`定义组件的`set`函数中应用于自定义组件（例如，[请参见此处](http://tutorials.jenkov.com/flex-components/component-basics.html)）。在我上面的例子中，我正在讨论的属性都是在自定义组件中设置的（例如在函数中）。不确定这是否会有所作为。`get``autoScale()`

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:11:47.220

Flex 的组件生命周期将防止图表被重绘 5 次，因为属性在您描述的语句中被修改了 5 次，这就是生命周期的美妙之处。

简而言之，大多数属性更改不会立即转换为绘图，而是会引发一个标志，指示属性已更改，这样的过程称为失效。然后组件将等到下一个重绘周期，通常是一帧之后（Flash 是基于帧的动画环境）。当重绘发生时，代码可以整体评估所有情况。

Flex 的生命周期提供了细粒度的失效。开发人员可以从 `invalidateProperties()`、`invalidationSize()`和（对于 Spark 组件）中进行`invalidatDisplayList()`选择 。`invalidateSkinState()`当 Flex 经历“验证”这些失效的生命周期时`commitProperties()`，将调用 , , 来执行`measure()`验证`updateDisplayList(w, h)`。[您可以在此处](http://blogagic.com/18/flex-component-life-cycle)、[此处](http://livedocs.adobe.com/flex/3/html/help.html?content=ascomponents_advanced_2.html)和[此处](http://www.slideshare.net/rjowen/adobe-flex-component-lifecycle-presentation)`getCurrentSkinState()`找到有关组件生命周期的更多信息。

在您的情况下，您不必自己使无效，除非图表组件没有正确使某些属性无效，否则您不需要调用无效或验证方法。

# javascript - 谷歌地图：使用自定义标记显示当前用户位置

> ID：11632004
> 
> 赞同：1
> 
> 时间：2012-07-24T13:33:23.597
> 
> 标签：javascript, google-maps

我有以下示例在 Google 地图上显示当前用户位置：http: [//dev.driz.co.uk/googlemap/](http://dev.driz.co.uk/googlemap/)

如您所见，我有三个部分（我为演示借用了 Foursquare 图标）：

1.) 用户所在的标记

2.) 用户的头像（请注意，如果用户登录或未登录并且有自定义头像或只有神秘人，这可能会改变）

3.) 位于化身和标记顶部的化身框架。

**我想要做的是让化身很好地坐在框架内，也许作为背景图像而不是如果可能的话？在文档中没有看到任何关于此的内容，但框架需要位于头像上方，以便创建圆角蒙版。**

**而且我希望它们一起掉下来，因为有时框架出现在标记点下方，而不是总是在应该的顶部。所以他们需要作为一个整体，同时下降。**

有谷歌地图知识的人可以帮我解决这两个部分吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:46:32.003

关于整个动画，有几点值得注意：

*   标记 z-index 在动画期间是不一致的，因为它直到标记处于其最终位置时才设置，因此在放置期间您真正可以做的控制它的唯一方法是**`setMap`**尽可能最好地对每个标记的函数的调用进行排序哄他们在下降时按顺序堆叠。这意味着首先调用最后一个对象的函数，然后按堆叠顺序处理更接近的图像。但是，一旦动画完成，它们将始终按正确的顺序排列。
*   为了控制**`setMap`**调用的顺序，您必须唯一地命名存储**`Marker`**对象的变量。
*   标记在加载之前不会添加到地图并进行动画处理，因此最好在代码中创建图像对象并预加载图像，然后在**`onload`**完成后将标记动画设置为事件的回调.

即使所有这些都到位，图像仍然会单独下降，因此它可能不会完全达到您正在寻找的效果，但这可能是使其尽可能接近的方法。

**设置 Z 索引**

首先，您的标记的 z-index 可以轻松设置为[**`MarkerOptions`**](https://developers.google.com/maps/documentation/javascript/reference#MarkerOptions)您传递给**`Marker`**构造函数的其中一个：

```
var marker1 = new google.maps.Marker({
    animation: google.maps.Animation.DROP,
    position: pos,
    map: map,
    icon: image1,
    zIndex: 1
}); 
```

**设置图标锚定**

接下来，要更改您提供给标记的图像的位置，该**`MarkerOptions`**对象可以包含[**`MarkerImage`**](https://developers.google.com/maps/documentation/javascript/reference#MarkerImage)作为其**`icon`**成员，因此使用此对象来指示您的图标的锚点：

```
var image1 = new google.maps.MarkerImage(
    "http://dl.dropbox.com/u/1597153/00000000000000000000000000000000.png",
    null,
    null,
    new google.maps.Point(16, 49)); 
```

第二个和第三个参数是可选的，如果没有指定，将为您构造，所以我们真的只对提供锚参数的值感兴趣。

**创建图像 OnLoad 回调**

如果您要预加载图像，我强烈建议您这样做，方法是创建三个图像对象，将 OnLoad 处理程序绑定到每个对象，然后**`src`**按顺序设置图像的属性 -<strong>。您创建标记并将它们添加到地图的代码应该只在所有三个图像都加载后发生。

```
// Create image objects to force pre-loading
var domImg1 = new Image(),
    domImg2 = new Image(),
    domImg3 = new Image();

// Instantiate variables for iteration
var images = [domImg1, domImg2, domImg3],
    j = 0;

// Bind an OnLoad handler that checks to see if all three images have been pre-loaded
for (i in images) {
    images[i].onload = function() {
       if (++j == 3) {
           // Create markers and add to map here
       }
     }
}

// Set the src property to start the download and trigger the onload events
domImg1.src = "http://dl.dropbox.com/u/1597153/00000000000000000000000000000000.png";
domImg2.src = "http://dl.dropbox.com/u/1597153/pin-white.png";
domImg3.src = "http://dl.dropbox.com/u/1597153/marker.png"; 
```

我已经提供了我在[**此 Fiddle**](http://jsfiddle.net/lthibodeaux/5uGLf/)上演示的技术的工作演示，因此请查看它，希望它能让您了解它是如何组合在一起的。

# jsp - Spring MVC 中的数据绑定与 GET 请求

> ID：11632010
> 
> 赞同：0
> 
> 时间：2012-07-24T13:33:41.523
> 
> 标签：jsp, spring-mvc

我对 Spring MVC 有一个非常困扰的问题。

认为我有一个控制器，其方法响应 GET 请求和一个 JSP 表单。

现在，当表格部分填写时，我向控制器发送了一个 GET 请求。

问题是，在响应 GET 请求的方法中，支持对象中是否可以使用部分填充的数据？

# ios - ASIHTTPRequest 只为一个 URL 清除缓存

> ID：11632011
> 
> 赞同：0
> 
> 时间：2012-07-24T13:33:47.670
> 
> 标签：ios, caching, asihttprequest

我正在使用带有缓存的 ASIHTTPRequest 在我的 iOS 应用程序中下载图片。大多数图片永远不会改变，因此可以利用缓存功能。有一些确实会根据 iOS 应用程序中的特定功能进行更改。所以，我确切地知道这些图像何时会改变。如何清除某个链接的缓存（例如[http://www.test.com/image.jpg](http://www.test.com/image.jpg)）并为我的应用程序中的所有其他请求保留缓存。谢谢。

```
ASIHTTPRequest *request;
request = [ASIHTTPRequest requestWithURL:[NSURL URLWithString:@"{Image url}"]];
[request setDownloadCache:[ASIDownloadCache sharedCache]];
[request setCachePolicy:ASIAskServerIfModifiedWhenStaleCachePolicy|ASIFallbackToCacheIfLoadFailsCachePolicy];
[request setCacheStoragePolicy:ASICachePermanentlyCacheStoragePolicy];
[request setSecondsToCache:60*60*24*7]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:44:23.707

```
[[ASIDownloadCache sharedCache] removeCachedDataForURL:[NSURL URLWithString:@"{Image url}"]]; 
```

# android - android - 在gps上测量高度和准确性？

> ID：11632015
> 
> 赞同：0
> 
> 时间：2012-07-24T13:34:00.507
> 
> 标签：android, gps, altitude

在我的 android 项目中，我可以获得测量的精度和高度，它们返回一个整数（或者更确切地说是一个浮点数），但我不明白如何使用该值。海拔高度是从地面测量的米吗？准确度如何，这是否意味着 +- x 米？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T14:42:47.533

高度是 WGS84 参考椭球上方的高度，以米为单位。此处提供了更多信息：[https ://stackoverflow.com/a/9432382/1127492](https://stackoverflow.com/a/9432382/1127492)

# android - Android ListView & ArrayAdapter 错误

> ID：11632017
> 
> 赞同：0
> 
> 时间：2012-07-24T13:34:07.200
> 
> 标签：android, textview, android-arrayadapter

我正在创建一个应用程序，它以 JSON 格式从我的本地服务器中提取预订并以`ListView`.

我设法提取数据并以基本`List`格式显示，但决定创建一个更好看的`List`. 我一直在遵循[ezzylearning](http://www.ezzylearning.com/tutorial.aspx?tid=1763429)的指南，该指南向`ListView`.

我检查了代码并四处搜索，但我仍然收到`ListView`某种形式的错误。不确定如何解决或调试此问题。

* * *

Ignition.java (mainActivity) ：

```
package com.systematix.sxConcept;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.StatusLine;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONObject;

import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.widget.ListView;

public class Ignition extends Activity {

    // url to make request
    private static String url = "http://10.0.0.103/android/data";

    public String company;
    public String course;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_ignition);
        new ReadJSONFeedTask().execute(url);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_ignition, menu);
        return true;
    }

    public String readJSONFeed(String URL){
        StringBuilder stringBuilder = new StringBuilder();
        HttpClient client = new DefaultHttpClient();
        HttpGet httpget = new HttpGet(URL);
        try{
            HttpResponse response = client.execute(httpget);
            StatusLine statusLine = response.getStatusLine();
            int statusCode = statusLine.getStatusCode();
            if(statusCode == 200){
                HttpEntity entity = response.getEntity();
                InputStream content = entity.getContent();
                BufferedReader reader = new BufferedReader(
                        new InputStreamReader(content));
                String line;
                while ((line = reader.readLine()) != null){
                    stringBuilder.append(line);
                }
            }else{
                Log.e("JSON", "Failed to download list");
            }
        } catch (ClientProtocolException e){
            e.printStackTrace();
        } catch (IOException e){
            e.printStackTrace();
        }

        return stringBuilder.toString();
    }

    private class ReadJSONFeedTask extends AsyncTask<String, Void, String> {
        protected String doInBackground(String... urls){
            return readJSONFeed(urls[0]);
        }

        protected void onPostExecute(String result){
            try{
                JSONArray jsonArray = new JSONArray(result);
                Log.i("JSON", "Number of surveys in feed :" + jsonArray.length());
                ListView listView = (ListView) findViewById(R.id.listView1);

                /*String[] responseList;        
                responseList = new String[jsonArray.length()];*/

                Bookings[] booking_data;
                booking_data = new Bookings[jsonArray.length()];

                for (int i =0; i < jsonArray.length(); i++){
                    JSONObject jsonObject = jsonArray.getJSONObject(i);

                    booking_data[i] = new Bookings(jsonObject.getString("Company"),jsonObject.getString("CourseTitle"));

                    //responseList[i] = jsonObject.getString("bookdate") + " - " + jsonObject.getString("Company");
                }

                BookingsAdapter adapter = new BookingsAdapter(getBaseContext(),
                        R.layout.listview_item_row, booking_data); //export the data to a custom adapter

               /* View header = (View)getLayoutInflater().inflate(R.layout.listview_header_row, null);
                listView.addHeaderView(header);*/

                listView.setAdapter(adapter);

                /*ArrayAdapter<String> newAdapter = new ArrayAdapter<String>(getBaseContext(), android.R.layout.test_list_item, responseList);
                listView.setAdapter(newAdapter);*/

            } catch (Exception e){
                e.printStackTrace();
            }
        }
    }

} 
```

* * *

BookingsAdapter.java：

```
package com.systematix.sxConcept;

import android.app.Activity;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.TextView;

public class BookingsAdapter extends ArrayAdapter<Bookings>{

    Context context;
    int layoutResourceId;   
    Bookings data[] = null;

    public BookingsAdapter(Context context, int layoutResourceId, Bookings[] data) {
        super(context, layoutResourceId, data);
        this.layoutResourceId = layoutResourceId;
        this.context = context;
        this.data = data;
    }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            View row = convertView;
            BookingHolder holder = null;

            if(row == null)
            {
                LayoutInflater inflater = ((Activity)context).getLayoutInflater();
                row = inflater.inflate(layoutResourceId, parent, false);

                holder = new BookingHolder();
                holder.company = (TextView)row.findViewById(R.id.rowCompany);
                holder.course = (TextView)row.findViewById(R.id.rowCourse);

                row.setTag(holder);
            }
            else
            {
                holder = (BookingHolder)row.getTag();
            }

            Bookings booking = data[position];
            holder.company.setText(booking.company);
            holder.course.setText(booking.course);

            return row;
        }

        static class BookingHolder
        {
            TextView company;
            TextView course;
        }
    } 
```

* * *

预订.java：

```
package com.systematix.sxConcept;

public class Bookings {
    public String company;
    public String course;
    public Bookings(){
        super();
    }

    public Bookings(String company, String course) {
        super();
        this.company = company;
        this.course = course;
    }
} 
```

* * *

XML 布局文件是教程中 1 的副本，图标替换为`Textview`.

* * *

这些是错误：

```
07-24 12:36:10.154: E/AndroidRuntime(331): FATAL EXCEPTION: main
07-24 12:36:10.154: E/AndroidRuntime(331): java.lang.ClassCastException: android.app.ContextImpl
07-24 12:36:10.154: E/AndroidRuntime(331):  at com.systematix.sxConcept.BookingsAdapter.getView(BookingsAdapter.java:31)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.HeaderViewListAdapter.getView(HeaderViewListAdapter.java:220)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.AbsListView.obtainView(AbsListView.java:1430)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.ListView.makeAndAddView(ListView.java:1745)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.ListView.fillDown(ListView.java:670)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.ListView.fillFromTop(ListView.java:727)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.ListView.layoutChildren(ListView.java:1598)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.AbsListView.onLayout(AbsListView.java:1260)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.view.View.layout(View.java:7175)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.view.View.layout(View.java:7175)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.view.View.layout(View.java:7175)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.view.View.layout(View.java:7175)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.view.View.layout(View.java:7175)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.view.ViewRoot.performTraversals(ViewRoot.java:1140)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1859)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.os.Looper.loop(Looper.java:123)
07-24 12:36:10.154: E/AndroidRuntime(331):  at android.app.ActivityThread.main(ActivityThread.java:3683)
07-24 12:36:10.154: E/AndroidRuntime(331):  at java.lang.reflect.Method.invokeNative(Native Method)
07-24 12:36:10.154: E/AndroidRuntime(331):  at java.lang.reflect.Method.invoke(Method.java:507)
07-24 12:36:10.154: E/AndroidRuntime(331):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
07-24 12:36:10.154: E/AndroidRuntime(331):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
07-24 12:36:10.154: E/AndroidRuntime(331):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T13:45:14.137

线

```
LayoutInflater inflater = ((Activity)context).getLayoutInflater(); 
```

您正在将上下文投射到 Activity。Activity 继承自 Context 所以你不应该需要这个演员表。试试这个

```
LayoutInflater inflater = LayoutInflater inflater = LayoutInflater inflater = 
                          context.getLayoutInflater(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:39:54.773

尝试这个

```
BookingsAdapter adapter = new BookingsAdapter(Ignition.this,
                    R.layout.listview_item_row, booking_data); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T13:42:24.783

尝试这样做：

```
LayoutInflater li = LayoutInflater.from(context); 
```

或者

```
LayoutInflater li = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE); 
```

我假设这是`class cast exception`发生的第 31 行。

# php - PHP 包含不起作用

> ID：11632021
> 
> 赞同：0
> 
> 时间：2012-07-24T13:34:26.103
> 
> 标签：php, oop

我正在使用两个文件 - a.php 包含类 Background 和 b.php 包含 a.php 。*在 a.php 中，在类范围之外，有一个 echo 语句“背景检查”。

当我加载 b.php 时，我可以看到输出“背景检查”，但是当我尝试创建背景对象时，会出现下一条警告消息：

```
Fatal error: Class 'Background' not found in .... 
```

这是来自 b.php 的代码示例：

```
<?php
        include ('http://localhost/wT/sf/a.php');
        $url2="http://www.google.com";
        $b = new Background($url2);
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T13:36:13.283

如果`http://localhost/wT/sf/a.php`（在 Web 浏览器中）的输出不是 PHP 源代码，那么您的包含将不起作用。您可能（在您的情况下）必须包含文件系统中的文件，而不是通过 HTTP 地址。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T13:36:25.193

对包含使用相对路由，**而不是**URL。

换句话说，您包含的文件必须与您包含它的文件位于同一台服务器上（或能够在同一台服务器上访问）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T13:38:18.727

尝试这样的事情来完成这项工作：

```
<?php
        include ('/var/www/wT/sf/a.php'); //your filesystem location to a.php
        $url2="http://www.google.com";
        $b = new Background($url2);
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T13:38:40.967

您正在使用 web-url 而不是使用系统路径

```
<?php
        include ($_SERVER['document_root'].'/a.php');
        $url2="http://www.google.com";
        $b = new Background($url2);
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T13:41:31.320

**在包含方法中，您应该使用相对文件路径**

根据给定的文件路径包含文件，如果没有给出，则根据指定的 include_path 包含文件。如果在 include_path 中找不到该文件，则 include 最终会在失败之前检查调用脚本自己的目录和当前工作目录。如果找不到文件，include 构造将发出警告

# c# - 文件不是项目的一部分或构建操作未设置为“资源”

> ID：11632026
> 
> 赞同：5
> 
> 时间：2012-07-24T13:34:46.607
> 
> 标签：c#, wpf, resources

我得到错误

> 文件 /DocomGUI;component/Resources/logo.jpg 不是项目的一部分，或者它的“构建操作”属性未设置为“资源”。

但该`logo.jpg`文件绝对是项目的一部分，并且构建操作也设置为“资源”。

![项目结构](../Images/a8b18ea7ade22a360d10372b8c20b6c8.png) ![文件属性](../Images/7d7d90a1e4548979ce3adc68c1b1ff9c.png)

它位于`/Resources/`项目根目录的文件夹中，也位于`Resources.resx`同名文件中。

![资源文件](../Images/19382adba5384d70c02172d9fa1b694a.png)

我尝试重建解决方案，清理它，但仍然弹出错误。还有什么问题会导致找不到文件？

编码：

```
<Window x:Class="DocomGUI.AboutWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="AboutWindow" Height="180" Width="220" Background="LightGray" MinWidth="220" MinHeight="115" MaxWidth="220" MaxHeight="115">
    <Grid>
        <Label Margin="0,66,24,48">DocomGUI</Label>
        <Label Height="30" Margin="12,0,12,12" Name="VersionLabel" VerticalAlignment="Bottom"></Label>
        <Image Margin="12,12,12,0" Stretch="Fill" Height="48" VerticalAlignment="Top" Source="/DocomGUI;component/Resources/logo.jpg" />
    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:37:53.157

我以前也遇到过这种情况，实际上只需重新启动visual studio就可以解决。我不太确定为什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T14:10:39.260

如果你像这样在 window.resources 中声明它会发生什么：

```
<BitmapImage x:Key="logo" UriSource="/Resources/logo.jpg" /> 
```

并像这样使用它？

```
<Image Margin="12,12,12,0" Stretch="Fill" Height="48" VerticalAlignment="Top" Source="{StaticResource logo}" /> 
```

我建议这样做是因为我曾经遇到过类似的问题，并且这种解决方法对我有用。

# c# - 如何添加到 ObservableCollection Getter 中带有 LINQ Where() 的项目？

> ID：11632029
> 
> 赞同：2
> 
> 时间：2012-07-24T13:34:50.313
> 
> 标签：c#, linq, mvvm

我最近向我的一个域实体添加了一个 Disabled 属性。我`List<T>`在视图模型中有一个这些实体。我只是更改了 getter 以根据 UI 设置过滤列表，以选择性地显示禁用的项目。

```
public ObservableCollection<CustomVariableGroup> CustomVariableGroups
{
    get
    {
        if (this.ShowDisabled) { return this._customVariableGroups; }

        return new ObservableCollection<CustomVariableGroup>(this._customVariableGroups.Where(x => x.Disabled == false));
    }
} 
```

问题是当我现在尝试执行此操作时（在同一视图模型中），该项目不会添加到集合中。

```
this.CustomVariableGroups.Add(newGroup); 
```

而且我想我知道为什么：newGroup 被添加到 new`ObservableCollection<T>`中，而不是 _customVariableGroups 的支持字段。

如果 LINQ Where() 扩展方法能够返回`ObservableCollection<T>`（私有支持字段本身的类型）而不是 IEnumerable，我认为我不会遇到这个问题。就目前而言，由于 Where() 返回`IEnumerable<T>`，我需要将其包装在一个新的`ObservableCollection<T>`.

我在同一视图模型中添加新项目的正确/最佳方式是什么？我需要将其直接添加到私有支持字段吗？我不想这样做，因为我不想记住不要使用该属性本身。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:10:39.213

您可以绑定到**ICollectionView**并在 Disabled 属性中设置过滤器，而不是直接绑定到您的集合。无需更改源集合。

编辑：

视图模型：

```
 //this collection just init once - eg. in ctor, use add, remove, clear to alter
 public ObservableCollection<CustomVariableGroup> CustomVariableGroups {get; private set; }
 //create just once in ctor
 public ICollectionView MyView {get; private set;}

 //ctor
 this.CustomVariableGroups = new ObservableCollection<CustomVariableGroup>();
 this.MyView = CollectionViewSource.GetDefaultView(this.CustomVariableGroups);

 //in your disabled property set the filter
    public bool ShowDisabled
    {
        get { return _showDisabled; }
        set { 
            _showDisabled = value;

            if (_showDisabled)
                //show just disabled
                this.MyView.Filter = (item) =>
                                         {
                                             var myitem = (CustomVariableGroup) item;
                                             return myitem.Disabled;
                                         };
            else
            {
                //show all
                this.MyView.Filter = (item) => { return true; };
            }

            this.NotifyPropertyChanged("ShowDisabled"); }
    } 
```

xml

```
 <CheckBox Content="ShowDisabled" IsChecked="{Binding ShowDisabled}"/>
    <ListBox ItemsSource="{Binding MyView}" Grid.Row="1">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding Name}"/>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

这在我的测试项目中有效

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T16:43:09.550

正如评论中提到的，解决这个问题的正确方法是在视图中，而不是视图模型。这只是一个视图问题。我想我会发布我是如何处理它的，以防万一这对其他人有帮助。

首先，getter（视图模型）每次都应该返回完整的列表：

```
public ObservableCollection<CustomVariableGroup> CustomVariableGroups
{ get { return this._customVariableGroups; } } 
```

然后，在视图中，我将过滤器事件添加到我的 CollectionViewSource：

```
<CollectionViewSource x:Key="SortedGroups" Source="{Binding CustomVariableGroups}" Filter="CollectionViewSource_Filter"> 
```

并在每次单击 Show Disabled 复选框时刷新列表：

```
Command="{Binding RefreshVariableGroupCommand}" 
```

然后，在后面的代码中，我实现了过滤器：

```
private void CollectionViewSource_Filter(object sender, FilterEventArgs e)
{
    CustomVariableGroup customVariableGroup = e.Item as CustomVariableGroup;

    if (customVariableGroup == null) { return; }

    if ((bool)chkShowDisabled.IsChecked)
    {
        // Show everything
        e.Accepted = true;
        return;
    }

    // We are not showing disabled items, so set disabled items e.Accepted to false.
    if (customVariableGroup.Disabled == true)
    {
        e.Accepted = false;
        return;
    }

    e.Accepted = true;
} 
```

关于这一点，我不喜欢的唯一部分是我正在使用 MVVM 并试图避免代码隐藏类。但是，拥有这个比破解视图模型更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T13:57:53.977

我会做类似@Tallmaris 的事情，但不是在`MyViewModel_PropertyChanged`：

```
 CustomVariableGroups.Clear();
     foreach (var cvg in CustomVariableGroups.Where(x => !x.Disabled))
     {
         CustomVariableGroups.Add(cvg);
     } 
```

做这个：

```
 foreach(var cvg in CustomVariableGroups.Where( x => x.Disabled))
     {
         CustomVariableGroups.Remove(cvg);
     } 
```

如果这不起作用（取决于 Enumerable.Where 是否使用迭代器块，我认为），你可以这样做：

```
 foreach(var cvg in Custom VariableGroups.Where( x=> x.Disabled).ToList())
     {
         CustomVariableGroups.Remove(cvg);
     } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T13:48:18.020

我会维护您的支持列表，然后为您的 ObservableCollection 提出更改的属性。

```
public ObservableCollection<CustomVariableGroup> CustomVariableGroups
{
    get
    {
        if (this.ShowDisabled) { return this._customVariableGroups; }

        return new ObservableCollection<CustomVariableGroup>  (this._customVariableGroups.Where(x => x.Disabled == false));
    }
}

// adds to the backing list but raises on property to rebuild and
// return the ObservableCollection
public void AddCustomVariableGroup(CustomVariableGroup newGroup)
{    
    this._customVariableGroups.Add(newGroup);
    OnPropertyChanged("CustomVariableGroups");
}

//Example invocation
AddCustomVariableGroup(newGroup); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T13:49:29.077

在显示过滤结果时，我在 WinPhone 应用程序中遇到了类似的问题。我的解决方案是绑定到“ShowDisabled”属性更改，并在此事件上简单地`Clear()`将内容读入主 Observable：在这种情况下为 CustomVariableGroups。像这样的东西：

```
public bool ShowDisabled
{
    get
    {
        return showDisabled;
    }
    set
    {
        if (showDisabled!= value)
        {
            showDisabled = value;
            NotifyPropertyChanged("ShowDisabled");
        }
    }
} 
```

在构造函数中添加：`this.PropertyChanged += new PropertyChangedEventHandler(MyViewModel_PropertyChanged);`

在事件处理程序中：

```
 void MyViewModel_PropertyChanged(object sender, PropertyChangedEventArgs e)
 {
     if (e.PropertyName == "ShowDisabled")
     {
         CustomVariableGroups.Clear();
         foreach (var cvg in AllVariableGroups.Where(x => !x.Disabled))
         {
             CustomVariableGroups.Add(cvg);
         }
     }
 } 
```

绑定到 的组件`CustomVariableGroups`应该相应地更新。

免责声明：这当然会对性能产生影响，您需要确定它是否可以忽略不计。

# java - JSP 错误，在 Eclipse Juno 中禁用

> ID：11632030
> 
> 赞同：3
> 
> 时间：2012-07-24T13:34:57.423
> 
> 标签：java, eclipse, jsp

我有 Eclipse，Juno 版本。就在最近，我收到了一些无效或我不想看到的 JSP 错误。错误示例如下。

```
The function fn:replace is undefined
Attribute (cellpadding) is obsolete. Its use is discouraged in HTML5 documents. 
```

函数错误无效，因为当我运行 Web 应用程序时它工作得很好。我根本不在乎与 HTML5 相关的过时消息。我希望 Eclipse 不显示这些“错误”。

我尝试过启用特定于项目的验证，并关闭 HTML、JSP 和标签验证器，但没有任何区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T21:45:28.983

也许您的意思是您的项目正在使用旧类型的 (x)html。如果您不喜欢 Eclipse 默认使用 HTML5，请转到项目属性，然后是 Web 内容设置，然后在文档类型中选择您使用的那个。

# python - Django 视图中的异步函数

> ID：11632034
> 
> 赞同：3
> 
> 时间：2012-07-24T13:35:03.417
> 
> 标签：python, django, asynchronous, django-views

是否有可能做这样的事情：

```
def new_query(request,company_uuid,address_uuid,contact_uuid):
    mcompany = get_object_or_404(Company, uuid=company_uuid)
    if request.method == 'POST': # If the form has been submitted...
        form = forms.CompanyQueryForm(request.POST)
        if form.is_valid():
            mquery = form.save(commit = False)
            mcompany = get_object_or_404(Company, uuid = company_uuid)
            mquery.company = mcompany
            mquery.version_number = 1
            mquery.parameters = {
                                    'company':company_uuid,
                                    'address':address_uuid,
                                    'contact':contact_uuid
                                    }
            mquery.save()
            preserialise(mquery.pk, company_uuid)
            recent_update = RecentUpdate(company_query=mquery, update_type="1")
            recent_update.save()
            url = reverse('view_directory',kwargs={'company_uuid':company_uuid,
                                                                'address_uuid':address_uuid,
                                                                'contact_uuid':contact_uuid})
            return HttpResponseRedirect(url)
    else:
        form = forms.CompanyQueryForm()
    return share.output_page(request,'joinerysoft/new_query.html',{'title':unicode(u'New Company Query'),
                                                                   'form': form,
                                                                   'company':mcompany,
                                                                   'address_uuid':address_uuid,
                                                                   'contact_uuid':contact_uuid}) 
```

哪里`preserialise(mquery.pk, company_uuid)`在后台运行而不等待返回？因为预序列化需要很长时间才能完成（超过 5 分钟），从用户的角度来看，我希望它成为一场火灾并忘记。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T15:24:21.243

你总是可以触发一个线程：

```
import threading

class PreserializeThread(threading.Thread):
    def __init__(self, mquery_pk, company_uuid, *args, **kwargs):
        self.mquery_pk = mquery_pk
        self.company_uuid = company_uuid
        super(PreserializeThread, self).__init__(*args, **kwargs)

    def run(self):
        preserialize(self.mquery_pk, self.company_uuid) 
```

然后，`preserialize`在您的代码示例中替换为：

```
PreserializeThread(mquery.pk, company_uuid).start() 
```

另见：[http ://docs.python.org/library/threading.html](http://docs.python.org/library/threading.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T14:02:36.000

简单的回答，不。

在继续执行之前，您的函数将持续到序列化完成。

查看[django-celery](http://docs.celeryproject.org/en/latest/django/index.html)以获得任务队列解决方案。

截至 2020 年，[celery](https://docs.celeryproject.org/en/stable/django/first-steps-with-django.html)现在支持开箱即用的 Django。

# django - 运行大量查询

> ID：11632037
> 
> 赞同：0
> 
> 时间：2012-07-24T13:35:12.760
> 
> 标签：django, django-models

我有以下模型及其方法：

```
class TrendingTopic(models.Model):

    categories = models.ManyToManyField('Category', through='TTCategory', blank=True, null=True)
    location = models.ForeignKey(Location)

    def get_rank(self, t_date=None):
        if t_date:
            ttcs = self.trendingtopiccycle_set.filter(cycle_time__gt=t_date)
        else:
            ttcs = self.trendingtopiccycle_set.all()
        if ttcs:
            return sum([ttc.rank for ttc in ttcs])/len(ttcs)
        return 0

    def get_day_rank(self,t_date):
        ttcs = self.trendingtopiccycle_set.filter(cycle_time__year=t_date.year,
                                            cycle_time__month=t_date.month,
                                            cycle_time__day=t_date.day)
        sum_rank = sum([ttc.day_rank for ttc in ttcs if ttc.day_rank])
        if sum_rank:
            return sum_rank/len(ttcs)
        return 0 

class TrendingTopicCycle(models.Model):

    tt = models.ForeignKey(TrendingTopic)

    cycle_time = models.DateTimeField(default=datetime.now)
    from_tt_before = models.BooleanField(default=False)
    rank = models.FloatField(default=0.0)
    day_rank = models.FloatField(default=0.0) 
```

然后我有一些在视图中用于检索所需信息的函数：

*   显示当天最热门的话题：

    ```
    def day_topics(tt_date, limit=10):

        tts = [(ttc.tt, ttc.tt.get_day_rank(tt_date)) for ttc in \
            TrendingTopicCycle.objects.distinct('tt__name') \
            .filter(cycle_time__year=tt_date.year,
                    cycle_time__month=tt_date.month,
                    cycle_time__day=tt_date.day)]
        sorted_tts = sorted(tts, key=itemgetter(1), 
                       reverse=True)[:limit]
        return sorted_tts 
    ```

*   在确定的时间内显示给定位置（woeid）的最佳趋势主题：

    ```
    def hot_topics(woeid=None, limit=10):

        CYCLE_LIMIT = datetime.now() + relativedelta(hours=-5)
        TT_CYCLES_LIMIT = datetime.now() + relativedelta(days=-2)
        if woeid:
            tts = [ttc.tt for ttc in \
                    TrendingTopicCycle.objects.filter(tt__location__woeid=woeid) \
                    .distinct('tt__name') \
                    .exclude(cycle_time__lt=CYCLE_LIMIT)]
        else:
            tts = [ttc.tt for ttc in \
                    TrendingTopicCycle.objects.distinct('tt__name') \
                    .exclude(cycle_time__lt=CYCLE_LIMIT)]

        sorted_tts = sorted(tts, key=lambda tt: tt.get_rank(TT_CYCLES_LIMIT),
                    reverse=True)[:limit]    
        return sorted_tts 
    ```

当前解决方案的问题在于它运行速度非常慢，因为它执行了大量查询（100 次）来检索数据。我正在使用 django 调试工具栏来帮助我测量性能。

显然我做错了什么，我正在寻找解决方案，任何帮助将不胜感激。

编辑：

每个热门话题都有一组热门话题周期（ttc）。每个 ttc 有两个等级：一般等级（等级）和 day_rank。趋势主题排名是通过每个 ttc 循环计算的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T15:07:42.570

```
if ttcs:
            return sum([ttc.rank for ttc in ttcs])/len(ttcs)
        return 0 
```

这可以用数据库查询代替。[https://docs.djangoproject.com/en/dev/topics/db/aggregation/](https://docs.djangoproject.com/en/dev/topics/db/aggregation/)

就像是：

```
ttcs.Aggregate(Sum('rank'))["sum__rank"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T15:05:07.653

首先，请注意 django-debug-toolbar 虽然很棒，但它本身非常慢。如果您注释掉它的中间件，您的响应时间会*大大*提高。这是一个非常有用的工具，不要误会我的意思。我自己使用它，虔诚地，但关键是你不能在启用它时以“慢”之类的主观因素对你的网站进行基准测试。

其次，你的代码有点混乱，所以很难准确地说出你应该做什么。例如，`TrendingTopicCycle`有一个`rank`and`day_rank`字段，但您从不在发布的代码中使用它们。`get_day_rank`每次调用都会发出一个查询，因此如果您可以仅对`day_rank`字段本身进行过滤（消除对该查询的需要），显然会更有效，但我无法从您的代码中判断这些字段是否或何时实际设置.

您可以按原样对代码进行的一个小改进是明智地使用`select_related`. 例如，每次`ttc.tt.get_day_rank(tt_date))`在列表推导中运行时，都会发出一个查询来获取`tt`，然后另一个查询在`get_day_rank`. 简单地添加`.select_related('tt')`到您的查询集至少会消除对`tt`.

另外，我不确定它是否真的导致 Django 发出不同的查询（也许是一个效率更低的查询），但无论如何，单独过滤 、 和 没有意义`year`，*只*`month`过滤完整日期，即： *`day`*

 *```
TrendingTopicCycle.objects.distinct('tt__name') \
    .filter(cycle_time=date) 
```*

# ios - 使用委托在视图控制器之间进行通信

> ID：11632043
> 
> 赞同：2
> 
> 时间：2012-07-24T13:35:36.830
> 
> 标签：ios

在问了一些问题之后，我学会了如何将订单从一个视图控制器发送到另一个视图控制器并设法编写代码使其正常工作，但没有任何反应......

在我的项目中，我有两个名为`sayfa1`和的视图控制器`sayfa23`。当`sayfa1`点击一个按钮时，它会打开`sayfa23`并写在一个标签上（随机你好，见下面的代码）但它没有发生。在模拟器上，该按钮只打开了`sayfa23`标签，这就是它没有发生的事情。如果您查看代码，您可以更好地理解它。

说fa1.h

```
#import <UIKit/UIKit.h>

@protocol sayfa1Delegate <NSObject>

- (void)dealWithButton1;

@end

@interface sayfa1 : UIViewController

@property(nonatomic,assign) id<sayfa1Delegate> delegate;

@end 
```

sayfa1.m

```
#import "sayfa1.h"

@interface sayfa1 ()

@end

@implementation sayfa1

@synthesize delegate;

-(IBAction)button
{
    [delegate dealWithButton1];
}

@end 
```

sayfa23.h

```
#import <UIKit/UIKit.h>
#import "sayfa1.h"

@interface sayfa23 : UIViewController <sayfa1Delegate> 
{
    IBOutlet UILabel *label;
    sayfa1 *vc1 ;
}

@end 
```

sayfa23.m

```
#import "sayfa23.h"
#import "sayfa1.h"

@interface sayfa23 ()

@end

@implementation sayfa23

- (void)dealWithButton1
{
    vc1.delegate = self;    
    int random_num;
    random_num = (arc4random() % 5 - 1) + 1;
    if (random_num == 1)
    { 
        label.text = @"hello1";    
    }
    else if (random_num == 2)
        label.text = @"hello2";
    else if (random_num == 3)
        label.text = @"hello3";
    else if (random_num == 4)
        label.text = @"hello4";
}

@end 
```

编写此代码后，我连接了按钮，`sayfa23`因此它将打开新页面，我还连接了该按钮`sayfa1`以接收按钮操作，并连接了标签 (on `sayfa23`) 以`sayfa23`接收标签订单。但正如我所说的，没有发生任何错误，也没有你好，我做错了什么？我导入`sayfa1.h`或`sayfa23.h`在我的一些 h 文件的顶部导致 Xcode 给我一个关于未定义并解决该问题的错误，但这是我的错误还是其他原因。

我想要的例子。

*   用户打开应用

*   `sayfa1`显示在屏幕上

*   用户单击按钮并`sayfa23`显示标签文本`sayfa23`由按钮更改，该按钮在`sayfa1`其上写入随机 hello1..2..3 等...

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:25:56.610

重读你的问题，你问你的第一个视图控制器如何打开第二个视图控制器并设置一个文本框。如果那确实是您要尝试做的事情，那将是一个简单得多的问题，根本不需要委托协议或委托。

前两个答案是通过代表的讨论得出的，但这是为了解决不同的问题。仅当您需要第二个控制器将某些内容传递回第一个控制器时，才需要委托。但是如果你只是想让你的第二个控制器从第一个控制器接收一些东西，它很简单：

```
//  FirstViewController.h

#import <UIKit/UIKit.h>

@interface FirstViewController : UIViewController

@end 
```

使用如下实现：

```
//  FirstViewController.m

#import "FirstViewController.h"
#import "SecondViewController.h"

@implementation FirstViewController

- (NSString *)generateRandomText
{
    NSString *result;

    int random_num;
    random_num = (arc4random() % 5 - 1) + 1;
    if (random_num == 1)
        result = @"hello1";    
    else if (random_num == 2)
        result = @"hello2";
    else if (random_num == 3)
        result = @"hello3";
    else if (random_num == 4)
        result = @"hello4";

    return result;
}

// if you're using NIBs, it might be something like...
// you only need this method if you're using NIBs and you've manually hooked a button up to this
// if you're using segues, get rid of `goToNextViewController` and just use the following `prepareForSegue

- (IBAction)goToNextViewController:(id)sender
{
    SecondViewController *secondController = [[SecondViewController alloc] initWithNibName:@"SecondView" bundle:nil];
    secondController.textFromParent = [self generateRandomText];
    [self.navigationController pushViewController:secondController animated:YES];
}

// if you're using segues, give your segue an identifier, e.g. toSecondViewSegue, in Interface Builder and reference the exact same identifier here
// if you're not using segues, you don't need this prepareForSegue method

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"toSecondViewSegue"])
    {
        SecondViewController *destinationController = segue.destinationViewController;

        destinationController.textFromParent = [self generateRandomText];
    }
}

@end 
```

您的第二个控制器可能如下所示：

```
//  SecondViewController.h

#import <UIKit/UIKit.h>

@interface SecondViewController : UIViewController

@property (strong, nonatomic) NSString *textFromParent;
@property (weak, nonatomic) IBOutlet UILabel *label;

@end 
```

使用如下实现：

```
//  SecondViewController.m

#import "SecondViewController.h"

@implementation SecondViewController

@synthesize textFromParent = _textFromParent;
@synthesize label = _label;

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.label.text = self.textFromParent;
}

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T14:25:08.287

您的第一个控制器应该在实例化第二个控制器时，将第二个的委托设置为指向第一个视图控制器。因此，您的第一个视图控制器可能如下所示：

```
//  FirstViewController.h

#import <UIKit/UIKit.h>

@protocol FirstViewControllerDelegate <NSObject>

- (void)dealWithButton;

@end

@interface FirstViewController : UIViewController <FirstViewControllerDelegate>

@end 
```

使用如下实现：

```
//  FirstViewController.m

#import "FirstViewController.h"
#import "SecondViewController.h"

@implementation FirstViewController

- (IBAction)goToNextViewController:(id)sender
{
    SecondViewController *secondController = [[SecondViewController alloc] initWithNibName:@"SecondView" bundle:nil];
    secondController.delegate = self;
    [self.navigationController pushViewController:secondController animated:YES];
}

- (void)dealWithButton
{
    NSLog(@"Dealt with button from second controller");
}

@end 
```

您的第二个控制器可能如下所示：

```
//  SecondViewController.h

#import <UIKit/UIKit.h>
#import "FirstViewController.h"

@class FirstViewController;

@interface SecondViewController : UIViewController

@property (weak, nonatomic) id<FirstViewControllerDelegate> delegate;
@property (weak, nonatomic) IBOutlet UILabel *label;

- (IBAction)buttonPressed:(id)sender;

@end 
```

使用如下实现：

```
//  SecondViewController.m

#import "SecondViewController.h"

@implementation SecondViewController

@synthesize delegate = _delegate;
@synthesize label = _label;

- (IBAction)buttonPressed:(id)sender
{
    int random_num;
    random_num = (arc4random() % 5 - 1) + 1;
    if (random_num == 1)
        self.label.text = @"hello1";    
    else if (random_num == 2)
        self.label.text = @"hello2";
    else if (random_num == 3)
        self.label.text = @"hello3";
    else if (random_num == 4)
        self.label.text = @"hello4";

    [self.delegate dealWithButton];
}
@end 
```

**更新：**

您最初的问题没有明确说明您是否希望标签位于第一个控制器或第二个控制器上。我上面的回答假设您希望在第二个控制器上使用它，但回想起来，您可能希望在第一个控制器（委托）上使用它。如果是这样，下面的代码就是这样做的。请注意，我不只是在 中更新第一个视图控制器的标签`dealWithButton`，因为这很危险，因为您不知道视图是否可见（如果您收到 ，则可能已卸载`didReceiveMemoryWarning`）。所以我等待`viewWillAppear`。同样，第一个视图控制器：

```
//  FirstViewController.h

#import <UIKit/UIKit.h>

@protocol FirstViewControllerDelegate <NSObject>

- (void)dealWithButton;

@end

@interface FirstViewController : UIViewController <FirstViewControllerDelegate>

@property (weak, nonatomic) IBOutlet UILabel *label;

@end 
```

及其实现：

```
//  FirstViewController.m

#import "FirstViewController.h"
#import "SecondViewController.h"

@interface FirstViewController ()
{
    NSString *_labelText;
}
@end

@implementation FirstViewController

@synthesize label = _label;

// if you're using storyboards, it would be like:

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"delegateSegue"])
    {
        SecondViewController *destinationController = segue.destinationViewController;
        FirstViewController *sourceController = segue.sourceViewController;

        destinationController.delegate = sourceController;
    }
}

// if not using storyboards, you probably have a button like:

- (IBAction)goToNextViewController:(id)sender
{
    SecondViewController *secondController = [[SecondViewController alloc] initWithNibName:@"SecondView" bundle:nil];
    secondController.delegate = self;
    [self.navigationController pushViewController:secondController animated:YES];
}

- (void)dealWithButton
{
    // note, because this is being called by the second view controller, you should *not* update the UI
    // directly, because you can't be assured this view controller's view is still in memory (if you got
    // a didReceiveMemoryWarning while on the second view controller, this first view controller will 
    // stay in memory, but its view could have been released). So save what you want the label to be,
    // and update it on viewWillAppear (and if the view was released, it will be reloaded by the time
    // you hit viewWillAppear.
    //
    // clearly, if you were doing view controller containment and this was the parent view, you wouldn't
    // want to do this. But I assume you're dealing with a simple push/present view controller situation.

    int random_num;
    random_num = (arc4random() % 5 - 1) + 1;
    if (random_num == 1)
        _labelText = @"hello1";    
    else if (random_num == 2)
        _labelText = @"hello2";
    else if (random_num == 3)
        _labelText = @"hello3";
    else if (random_num == 4)
        _labelText = @"hello4";

    NSLog(@"Dealt with button from second controller");
}

- (void)viewWillAppear:(BOOL)animated
{
    self.label.text = _labelText;
}

@end 
```

第二个视图控制器：

```
//  SecondViewController.h

#import <UIKit/UIKit.h>
#import "FirstViewController.h"

@class FirstViewController;

@interface SecondViewController : UIViewController

@property (weak, nonatomic) id<FirstViewControllerDelegate> delegate;

- (IBAction)buttonPressed:(id)sender;

@end 
```

及其实现：

```
//  SecondViewController.m

#import "SecondViewController.h"

@interface SecondViewController ()

@end

@implementation SecondViewController

@synthesize delegate = _delegate;

- (IBAction)buttonPressed:(id)sender
{
    [self.delegate dealWithButton];
}
@end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T13:58:18.333

尝试将以下方法添加到您的 sayfa23 实现中：

```
- (void)viewDidLoad
{
    vc1 = [[sayfa1 alloc] init];
    vc1.delegate = self;
} 
```

并删除 vc1.delegate = self; 从你的 dealWithButton1 方法。

**编辑**：您必须了解该方法 dealWithButton1 永远不会被调用，因为您永远不会将消息发送到对象。因此，您永远不会设置 vc1 的委托。最好使用 viewDidLoad 方法进行一些设置，该方法在视图加载时调用。在那里您可以分配初始化（创建一个实例）sayfa1 类，并将其分配给您的属性 vc1。分配对象后，您可以向它发送消息。然后您可以设置委托。

sayfa23.h

```
#import <UIKit/UIKit.h>
#import "sayfa1.h"

@interface sayfa23 : UIViewController <sayfa1Delegate> 

{

    IBOutlet UILabel *label;
}
    @property (nonatomic, strong) sayfa1 *vc1 ;

@end 
```

sayfa23.m

```
#import "sayfa23.h"
#import "sayfa1.h"

@interface sayfa23 ()

@end

@implementation sayfa23
@synthesize vc1;

- (void)viewDidLoad
{
    vc1 = [[sayfa1 alloc] init];
    vc1.delegate = self;
}

- (void)dealWithButton1

{
    int random_num;
    random_num = (arc4random() % 5 - 1) + 1;
    if (random_num == 1)
    { 
        label.text = @"hello1";    
    }
    else if (random_num == 2)
        label.text = @"hello2";
    else if (random_num == 3)
        label.text = @"hello3";
    else if (random_num == 4)
        label.text = @"hello4";
}

@end 
```

# java - 更新 JFreeChart 时保留用户缩放状态

> ID：11632045
> 
> 赞同：0
> 
> 时间：2012-07-24T13:35:50.233
> 
> 标签：java, jfreechart

我`JFreeChart 1.0.14`用来绘制一个`XYSeries`. 我确实可以访问所有元素（`ChartPanel`、、、、`JFreeChart`）。不时有新数据要绘制，所以我更新我的系列（为简单起见，我们假设只有一个系列）：`XYSeriesCollection``XYSeries`

```
SwingUtilities.invokeLater(new Runnable() {
    @Override
    public void run() {
        XYSeries xyData = new XYSeries("Trace");
        for (int i = 0; i < n; i++)
            xyData.add(data[0][i], data[1][i], false);

        collection.removeAllSeries();
        collection.addSeries(xyData);

        chart.getXYPlot().setRangeAxis(createNewAxis());
    }
}); 
```

这一切都很好。但我有一个问题。用户可以通过在绘图中拖动来进行缩放。每次都会重置此缩放，更新数据。这是有道理的，因为我创建了新轴。如何保留用户缩放状态？由于用户还可以选择自动量程/量程，我不想对这些 ( `Axis#setRange/setAutoRange`) 进行某种破解。我发现了一些关于`ChartPanel#getScaleX()`. 但这总是`1.0`在上面提到的开头`invokeLater`。我也找不到任何`ChartPanel.setScaleX`.

我做错了什么还是有另一种方法可以在不更改轴的范围/自动范围行为的情况下保留用户缩放状态？

顺便说一句：我**必须**重新创建轴，因为它们也可以在 logscale 和 linscale 之间切换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:22:33.437

我认为您不需要在`XYSeries xyData`每次添加新点或调用时都创建一个新点`removeAllSeries()`

此示例显示如何将动态数据添加到`XYSeriesCollection`

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JPanel;

import org.jfree.chart.ChartFactory;
import org.jfree.chart.ChartPanel;
import org.jfree.chart.JFreeChart;
import org.jfree.chart.axis.LogAxis;
import org.jfree.chart.axis.NumberAxis;
import org.jfree.chart.axis.ValueAxis;
import org.jfree.chart.plot.PlotOrientation;
import org.jfree.chart.plot.XYPlot;
import org.jfree.data.time.Millisecond;
import org.jfree.data.xy.XYDataset;
import org.jfree.data.xy.XYSeries;
import org.jfree.data.xy.XYSeriesCollection;
import org.jfree.ui.ApplicationFrame;
import org.jfree.ui.RefineryUtilities;

/**
 * A demonstration application showing a XYseries chart where you can
 * dynamically add (random) data by clicking on a button.
 */
public class DynamicDataDemo1 extends ApplicationFrame {
    /**
     * Constructs a new demonstration application.
     * 
     * @param title
     *            the frame title.
     */
    public DynamicDataDemo1(String title) {
        super(title);
        MyDemoPanel demoPanel = new MyDemoPanel();
        setContentPane(demoPanel);
    }

    static class MyDemoPanel extends DemoPanel implements ActionListener {
        /** The time series data. */

        /** The most recent value added. */
        private double lastValue1 = 200.0;
        private double lastValue2 = 200.0;
        private XYPlot plot;
        private boolean logAxis = false;
        private String lastSeries = "";
        private final XYSeriesCollection dataset;
        private static String SERIES_NAME =  "Random Data ";
        private static int seriesNumber =  0;
        /**
         * Creates a new instance.
         */
        public MyDemoPanel() {
            super(new BorderLayout());
            lastSeries = SERIES_NAME + (seriesNumber++);
            XYSeries series = new XYSeries(lastSeries);
            dataset = new XYSeriesCollection(series);
            ChartPanel chartPanel = new ChartPanel(createChart(dataset));
            chartPanel.setPreferredSize(new java.awt.Dimension(500, 270));
            addChart(chartPanel.getChart());
            JPanel buttonPanel = new JPanel();
            buttonPanel.setBorder(BorderFactory.createEmptyBorder(4, 4, 4, 4));
            JButton button = new JButton("Add New Data Item");
            button.setActionCommand("ADD_DATA");
            button.addActionListener(this);
            buttonPanel.add(button);
            {
                JButton button2 = new JButton("Switch Axis");
                button2.setActionCommand("SWITCH_AXIS");
                button2.addActionListener(this);
                buttonPanel.add(button2);
            }
            {
                JButton button2 = new JButton("Add Series");
                button2.setActionCommand("ADD_SERIES");
                button2.addActionListener(this);
                buttonPanel.add(button2);
            }
            add(chartPanel);
            add(buttonPanel, BorderLayout.SOUTH);
        }

        private JFreeChart createChart(XYDataset dataset) {
            JFreeChart result = ChartFactory.createXYLineChart("Dynamic Data Demo", "Time", "Value", dataset, PlotOrientation.VERTICAL, true, true, false);
            plot = (XYPlot) result.getPlot();
            ValueAxis domainAxis = plot.getDomainAxis();
            domainAxis.setAutoRange(true);
            final ValueAxis rangeAxis = plot.getRangeAxis();
            rangeAxis.setAutoRange(true);
            return result;
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            if (e.getActionCommand().equals("ADD_DATA")) {
                double factor1 = 0.90 + 0.2 * Math.random();
                double factor2 = 0.90 + 0.2 * Math.random();
                this.lastValue1 = this.lastValue1 * factor1;
                this.lastValue2 = this.lastValue2 * factor2;
                Millisecond now = new Millisecond();
                System.out.println("Now = " + now.toString());
                XYSeries series = dataset.getSeries(lastSeries);
                series.add(this.lastValue2, this.lastValue1);
            } else if (e.getActionCommand().equals("SWITCH_AXIS")) {
                if (!logAxis) {
                    LogAxis xAxis = new LogAxis("X");
                    LogAxis yAxis = new LogAxis("Y");               
                    updateZoom(xAxis,yAxis);
                logAxis = true;
                } else {
                    NumberAxis xAxis = new NumberAxis("X");
                    NumberAxis yAxis = new NumberAxis("Y");
                    updateZoom(xAxis,yAxis);
                    logAxis = false;
                }
            } else if (e.getActionCommand().equals("ADD_SERIES")) {
                lastSeries = SERIES_NAME + (seriesNumber++);
                XYSeries series = new XYSeries(lastSeries);
                dataset.addSeries(series);
            }
        }

        private void (ValueAxis xAxis, ValueAxis yAxis) {
            double domainMin = plot.getDomainAxis().getRange().getLowerBound();
            double domainMax = plot.getDomainAxis().getRange().getUpperBound();
            System.out.println(domainMin + "," + domainMax);

            double rangeMin = plot.getRangeAxis().getRange().getLowerBound();
            double rangeMax = plot.getRangeAxis().getRange().getUpperBound();
            System.out.println(rangeMin + "," + rangeMax);                  

            xAxis.setRange(domainMin, domainMax);
            plot.setDomainAxis(xAxis);
            yAxis.setRange(rangeMin, rangeMax);
            plot.setRangeAxis(yAxis);

        }
    }

    public static JPanel createDemoPanel() {
        return new DynamicDataDemo1.MyDemoPanel();
    }

    public static void main(String[] args) {
        DynamicDataDemo1 demo = new DynamicDataDemo1("JFreeChart: Dynamic XYSeries");
        demo.pack();
        RefineryUtilities.centerFrameOnScreen(demo);
        demo.setVisible(true);
    }
} 
```

此示例基于 JFreeChart：DynamicDataDemo1.java。每次单击“添加新数据项”时，都会添加一个新点。在此示例中，缩放将在您添加数据点时保留，但在您更改轴时不会保留。

要在将轴从正常比例更改为对数比例时保持缩放，反之亦然，使用两个轴的当前上限和下限，并设置`Range`新轴的`updateZoom`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T08:27:15.233

我不知道如何将“用户缩放状态”从一个轴转移到另一个轴。因此，如果不需要，我确保不要刷新轴（=对数/线性之间的比例没有变化）。如果有变化，用户缩放状态将丢失，这是不幸的。但这不会经常发生，并且是用户控制的，因此用户可能会接受缩放状态重置。

# objective-c - 在 webView 中离开主页后，jQuery Mobile 不会触发 webViewDidStartLoad 和 webViewDidFinishLoad

> ID：11632046
> 
> 赞同：1
> 
> 时间：2012-07-24T13:35:57.963
> 
> 标签：objective-c, xcode, ios5, jquery-mobile, uiwebview

我有一个简单的 iOS 应用程序，它有一个包含 UIWebView 的视图。在我的 webView 中，我显示了我的 jQuery Mobile 网站。

由于 jQuery Mobile 通过 ajax 加载页面，一旦初始页面加载，就不会调用`webViewDidStartLoad`和`webViewDidFinishLoad`方法。我在 SO 上发现了类似的问题，例如**[this one](https://stackoverflow.com/questions/10436899/ios-jquerymobile-unable-to-capture-webview-event-when-html-file-is-loaded)**，但我不确定在哪里使用该`window.location = "localFunction"`电话，而且还没有人确认这确实有效。

这是我的问题（示例）：

1.  应用程序启动
2.  `shouldStartLoadWithRequest`叫做
3.  `webViewDidStartLoad`被调用，并显示网络活动指示器。
4.  `webViewDidFinishLoad`被调用，网络活动指示器被隐藏，webView 显示初始网页。
5.  用户点击主页上的链接
6.  `shouldStartLoadWithRequest`叫做
7.  显示第二页，但在会话`webViewDidStartLoad`期间 `webViewDidFinishLoad`不会再次调用。

有没有办法强制 jQuery Mobile 或 iOS 应用程序调用`webViewDidStartLoad`，`webViewDidFinishLoad`以便我可以执行简单的任务，例如在调用时显示网络活动指示器`webViewDidStartLoad`，并在调用时隐藏它`webViewDidFinishLoad`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:48:40.387

如果您想发出`UIWebView`页面更改的信号；您可以使用问题中 SO 帖子中讨论的自定义方案启动选项。

`window.location`在处理程序中定义更改`pagebeforechange`：（[JQM 页面更改事件](http://jquerymobile.com/demos/1.1.1/docs/api/events.html)）

```
logToIosConsole: function(msg){ 
    console.log("logToIosConsole: log://"+msg); 
    var standalone = window.navigator.standalone, 
    userAgent = window.navigator.userAgent.toLowerCase(), 
    safari = /safari/.test( userAgent ), 
    ios = /iphone|ipod|ipad/.test( userAgent ); 

    if( ios ) { 
        if ( !standalone && !safari ) { 
            //uiwebview 
            window.location = "log://"+msg; 
        }; 
    } else { 
        //not iOS 
    }; 
```

在 javascript 中使用它

```
$(document).on("pagebeforechange", function(eve, ui){
    logToIosConsole("pagebeforechange called on "+eve.currentTarget.URL);
}); 
```

在你的拦截这个custom-url-scheme`shouldStartLoadWithRequest`

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    NSString *theAnchor=[[[request URL] absoluteString] stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding] ;
    if([theAnchor hasPrefix:@"log:\/\/"]) {
        NSString *logText=[theAnchor substringFromIndex:@"log:\/\/".length];
        NSLog(@"LogMsg==>%@",logText);
        return NO; 
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:50:59.187

`webViewDidStartLoad`并且`webViewDidFinishLoad`仅在`window.location`更改时调用。`UIWebView`无法拦截 Ajax 调用。

您可以通过设置全局关闭 JQM 的 Ajax 导航，也可以`ajaxEnabled="false"`使用`data-ajax="false"`.

或者

如果问题只是显示活动指示器；您可以通过调用来使用 JQM 的内置活动指示器`$.mobile.showPageLoadingMsg`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T02:20:25.440

这是 jQuery Mobile 站点呈现页面的方式的问题。如果您禁用网站的 ajax 导航，它们会被调用。启用 Ajax 后，单击链接时不会调用 webViewDidStartLoad，因为由于页面是通过 Ajax 请求的，因此窗口位置不会更改，因此 iOS 不会注册页面更改或页面加载。

# windows-7 - 如何处理 USB 过滤器驱动程序中的 IRP_MN_QUERY_DEVICE_RELATIONS

> ID：11632050
> 
> 赞同：2
> 
> 时间：2012-07-24T13:36:03.737
> 
> 标签：windows-7, usb, driver

我是驱动程序开发的新手。我开始为 Windows7 开发 USB 过滤器驱动程序，以便向用户隐藏一些 USB 设备类型。我将驱动程序连接到 USB 集线器上，并且可以拦截 IRP_MN_QUERY_DEVICE_RELATIONS。我有几个问题：

1 - On `IRP_MN_QUERY_DEVICE_RELATIONS`（`QueryDeviceRelations.Type`是 BusRelations）我收到一个指向 .As 的指针`DEVICE_RELATIONS struct`。据我所知，结构中的 Objects 数组应该包含指向 PDO 的指针。但是，当我测试`DO_BUS_ENUMERATED_DEVICE`标志时（来自 msdn：*操作系统在每个物理设备对象（PDO）中设置了这个标志。驱动程序不能修改这个标志。*）有时我看到这个标志被打开，有时这个标志被关闭. 这是否意味着有时我会看到 PDO，有时会看到 FDO？或者这个问题的另一种解释？当我得到一些时`PDEVICE_OBJECT`，我怎么知道它是 PDO 还是 FDO？

2 - 当用户插入一些 USB 设备，并且过滤器驱动程序应该处理`IRP_MN_QUERY_DEVICE_RELATIONS`时，我如何确定对象数组中的哪个设备刚刚插入设备，哪个设备之前插入，哪个被标记为非活动？

提前致谢。费利克斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T07:26:51.147

有无证成员`DeviceNode`，`DEVOBJ_EXTENSION`因为它不是 WDM.h 和 NTDDK.h 的一部分，因此对 IO 或 PnP 管理器来说是私有的。在任何情况下，对于非 PDO 来说它都是 NULL，所以“不受支持的方式”是

```
if (DeviceObject->DeviceObjectExtension->DeviceNode) {
        // PDO!
    } else {
        // non-PDO!
    } 
```

我宁愿不使用它。取而代之的是，您可以`IoGetDeviceObjectPointer`通过 devobj 列表或从`PDRIVER_OBJECT`. 为了确定 devobj 是否为 PDO，请发送 QDR/TargetDeviceRelation（完成后`PDEVICE_OBJECT`在列表中取消引用）。如果成功，QDR 中生成的 devobj 将成为您设备的 PDO。[这是](http://blogs.msdn.com/b/doronh/archive/2006/06/12/629120.aspx)一个很好的解释。另一种选择是使用`DO_BUS_ENUMERATED_DEVICE`. 还要考虑到这个标志并不意味着*初始化*的 PDO。它在初始化之前和结构分配时设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T11:46:06.680

我从未见过 FDO 在 BusRelations 更新中到达，但也许您还有另一个过滤器驱动程序在路上？无论如何，塔米尔很好地回答了这个问题:)

关于您的第二个问题，我知道的唯一方法是保留先前收到的 Objects 数组的副本并进行比较。不要试图依赖任何特定的设备顺序，因为它可以在版本之间更改。

# ruby-on-rails - 从 Rails 3 项目的 lib 目录中访问模型

> ID：11632065
> 
> 赞同：5
> 
> 时间：2012-07-24T13:36:49.203
> 
> 标签：ruby-on-rails

我在 lib 目录中有一个文件，它使用模型中定义的一些常量，例如：

```
class User < ActiveRecord::Base
   MAX_EMAIL_ADDRESS_LENGTH = 255
end 
```

然后我在 lib/foo.rb

```
module Foo
  LONG_EMAIL_ADDRESS = "foo@bar.com".rjust(User::MAX_EMAIL_ADDRESS_LENGTH, "a")
end 
```

由于找不到类用户而失败。如何在 lib 上的该文件之前加载用户？

我通过在我的 application.rb 中加载该文件：

```
config.autoload_paths += %W(#{config.root}/lib) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T18:46:46.680

第一部分做得对：

```
config.autoload_paths += %W(#{config.root}/lib) 
```

接下来很重要的，模块

```
module Foo
  ...
end 
```

必须放入

```
lib/foo.rb 
```

文件。

然后，可以将其`include`写入应用程序代码。

```
class Comment < ActiveRecord::Base
  include Foo
  ...
end 
```

如果`foo.rb`不打算包含来自 lib 目录的文件（但它可能是错误的方式），那么要在此代码中使用 Rails 模型和其他内容，您应该将其放入 foo.rb：

```
require_relative "../config/environment.rb" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T06:24:11.573

解决方案是，我在 /lib 中的文件实际上是 rake 文件所需要的，并且似乎在 Rails 设置整个自动加载系统之前加载了 rake 文件，因此找不到模型。从 .rake 文件中删除要求后，一切都开始工作了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-09T09:23:55.427

我知道这是一个老问题，但我刚刚遇到同样的问题，经过一些搜索，我找到了解决方案，所以我认为值得分享。

我想在我的 /lib 目录中的一个必需文件中使用模型“Foo”。首先，我这样做了，但没有奏效：

```
# in my rake file
task :foo_task do
  require /some_path/lib/bar.rb
end

# in /lib/bar.rb
puts "Foo = #{Foo.count} "

# => uninitialized constant Foo 
```

经过一番搜索，我发现要访问我的 lib 文件中的模型，我需要在我的任务中指定环境。所以我只是将它添加到我的任务声明中：

```
task :foo_task => [:environment] do 
```

现在，当我调用我的任务时，它正确放置了 Foo 的数量：

```
# => Foo = 6 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T14:13:06.820

默认情况下，`YourApplicationNameHere::Application.autoload_paths`是`[]`. 我*（纯粹出于组织原因）*`app/models`也为我的目录添加了一个 glob 。

```
config.autoload_paths += Dir["#{Rails.root}/app/models/**/"]
config.autoload_paths += Dir["#{config.root}/lib"] 
```

通过此设置，我可以毫无困难地完成您在问题中提出的问题。这也应该使您受益，告诉 Rails 如果无法`User`从`lib/`模块的实例化中找到模型，该去哪里查找。

**编辑**

在您的问题中指定确切的错误消息也会有所帮助。

```
uninitialized constant Foo::User 
```

`User`表示 Ruby/Rails 在命名空间内寻找`Foo`。前缀`User`with`::`强制查找全局命名空间。

```
module Foo
  LONG_EMAIL_ADDRESS = "foo@bar.com".rjust(::User::MAX_EMAIL_ADDRESS_LENGTH, "a")
end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-24T14:19:02.220

看来您的类 User 尚未实例化，这似乎很不寻常，除非您在“模型”以外的位置有“user.rb”。通常情况下，类不会在开发中加载，除非它们专门在该目录中，但我使用的一种解决方案是这一行，您可以将其放在您希望在您拥有的违规行之前调用的代码中..

```
Rails.application.eager_load! if Rails.env == "development" 
```

条件部分可能是不必要的，但我包括它只是为了确定它的效果只发生在开发中。

# java - 从 HDFS 读取一个简单的 Avro 文件

> ID：11632067
> 
> 赞同：6
> 
> 时间：2012-07-24T13:36:54.750
> 
> 标签：java, io, avro

我正在尝试简单读取存储在 HDFS 中的 Avro 文件。我发现了如何在本地文件系统上读取它....

```
FileReader reader = DataFileReader.openReader(new File(filename), new GenericDatumReader());

for (GenericRecord datum : fileReader) {
   String value = datum.get(1).toString();
   System.out.println("value = " value);
}

reader.close(); 
```

但是，我的文件在 HDFS 中。我不能给 openReader 一个 Path 或一个 FSDataInputStream。如何在 HDFS 中简单地读取 Avro 文件？

编辑：我通过创建一个实现 SeekableInput 的自定义类（SeekableHadoopInput）来实现这一点。我从 github 上的“Ganglion”“偷”了这个。尽管如此，似乎会有一个 Hadoop/Avro 集成路径。

谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-30T21:33:07.280

FsInput类（在[avro](http://avro.apache.org/docs/1.7.3/api/java/org/apache/avro/mapred/FsInput.html) -mapred 子模块中，因为它依赖于 Hadoop）可以做到这一点。它提供了 Avro 数据文件所需的可搜索输入流。

```
Path path = new Path("/path/on/hdfs");
Configuration config = new Configuration(); // make this your Hadoop env config
SeekableInput input = new FsInput(path, config);
DatumReader<GenericRecord> reader = new GenericDatumReader<GenericRecord>();
FileReader<GenericRecord> fileReader = DataFileReader.openReader(input, reader);

for (GenericRecord datum : fileReader) {
    System.out.println("value = " + datum);
}

fileReader.close(); // also closes underlying FsInput 
```

# java - 当公共代码具有多个不兼容的返回类型时，将公共代码分解出来

> ID：11632075
> 
> 赞同：2
> 
> 时间：2012-07-24T13:37:20.833
> 
> 标签：java, refactoring

我在重构时偶然发现了一段奇怪的代码。它看起来像是分解两个 readString() 方法的共同部分的候选者，只是它似乎是不可能的（这对我来说是一个疯狂的脑筋急转弯）：

```
private final StringBuilder readStringBuilder = new StringBuilder(128);

@Override
public String readString() throws IOException {
    final int l = readInt();
    if (l <= 0) {
        switch (l) {
            case -1: return null;
            case 0: return "";
            default: throw new IOException("invalid string length encoding: " + l);
        }
    }
    readStringBuilder.setLength(0);
    for (int i=0; i<l; ++i) {
        readStringBuilder.append(readChar());
    }
    return readStringBuilder.toString();
}

@Override
public String readString(final StringCache cache) throws IOException {
    final int l = readInt();
    if (l <= 0) {
        switch (l) {
            case -1: return null;
            case 0: return "";
            default: throw new IOException("invalid string length encoding: " + l);
        }
    }
    readStringBuilder.setLength(0);
    for (int i=0; i<l; ++i) {
        readStringBuilder.append(readChar());
    }
    return cache.get(readStringBuilder, readStringBuilder);
} 
```

您会看到这两个方法的作用*几乎*相同，方法主体完全相同，除了 return 语句。但是由于有提前终止退出，我找不到可以采用主体的方法签名 - 自然地，返回类型将是 StringBuilder，只有在提前终止的情况下才会是 String ...

任何想法如何将身体分解成一个单独的方法？（请注意，空 StringBuilder 上的 toString() 确实会*创建*一个新字符串，而不是返回一个常量字符串文字）

编辑： StringCache 的定义是：

```
public interface StringCache {
    public String get(final CharSequence charSeq, final CharSequence notFoundResult);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T13:41:52.457

您不能只创建一个填充`readStringBuilder`适当的私有方法吗？

然后这两种`readString()`方法都使用它，或者`get()`在缓存上执行 a ，或者`toString()`在`readStringBuilder`?

鉴于*组合方法*重构，这是值得考虑的，它以以下原则为原则：

> 组合方法说每个方法应该做一件且只做一件事

当您遵守这一点时，您的方法通常会变得可重用（可组合）。

> 通过这次重构练习，我取得了什么成就？....现在我有了小的构建块，方法重用变得更容易，因为现在我可以混合和匹配它们

[请在此处](http://www.ibm.com/developerworks/java/library/j-eaed4/index.html)查看 Neil Ford 关于*组合方法*重构的文章。另请参见 Martin Fowler 的“ [extractMethod](http://www.refactoring.com/catalog/extractMethod.html) ”重构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T14:18:32.440

看起来`readStringBuilder`作为实例字段是某种形式的（过早的？）优化。假设是这种情况，那么这样的事情怎么样：

```
private StringBuilder readStringHelper() throws IOException {
  StringBuilder readStringBuilder = new StringBuilder(128);
    final int l = readInt();
    if (l <= 0) {
        switch (l) {
            case -1: return null;
            case 0: break;
            default: throw new IOException("invalid string length encoding: " + l);
        }
    }
    for (int i=0; i<l; ++i) {
        readStringBuilder.append(readChar());
    }
    return readStringBuilder;
}

@Override
public String readString() throws IOException {
    StringBuilder readStringBuilder = readStringHelper();
    return readStringBuilder==null ? null : readStringBuilder.toString();
}

@Override
public String readString(final StringCache cache) throws IOException {
    StringBuilder readStringBuilder = readStringHelper();
    return readStringBuilder== null ? null : cache.get(readStringBuilder, readStringBuilder);
} 
```

# java - Java中的代码注入/汇编内联？

> ID：11632078
> 
> 赞同：14
> 
> 时间：2012-07-24T13:37:35.343
> 
> 标签：java, assembly, inline-assembly

我知道 Java 是一种安全的语言，但是当需要矩阵计算时，我可以尝试更快的方法吗？

我正在学习 C++、Digital-Mars 编译器和 FASM 中的 __asm{}。我想在 Java 中做同样的事情。如何在函数中内联汇编代码？这甚至可能吗？

像这样的东西（使用 CPU 的 AVX 支持将数组的所有元素钳制为一个值而不分支的向量化循环）：

```
JavaAsmBlock(
   # get pointers into registers somehow
   # and tell Java which registers the asm clobbers somehow
     vbroadcastss  twenty_five(%rip), %ymm0
     xor   %edx,%edx
.Lloop:                            # do {
    vmovups   (%rsi, %rdx, 4), %ymm1
    vcmpltps   %ymm1, %ymm0, %ymm2
    vblendvps  %ymm2, %ymm0, %ymm1, %ymm1  # TODO: use vminps instead
    vmovups    %ymm1, (%rdi, %rdx, 4)
    # TODO: unroll the loop a bit, and maybe handle unaligned output specially if that's common
    add         $32, %rdx
    cmp         %rcx, %rdx
    jb     .Lloop                  # } while(idx < count)
    vzeroupper
);

System.out.println(var[0]); 
```

我不想使用代码注入器。我想查看 Intel 或 AT&T 风格的 x86 指令。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-24T13:42:30.230

在你的 Java 代码和底层硬件之间有一个抽象层，这使得这种事情在原则上是不可能的；从技术上讲，您无法知道代码在底层机器上是如何表示的，因为相同的字节码可以在不同的处理器和不同的架构上运行。

您正式*可以*做的是使用[Java 本地接口](http://docs.oracle.com/javase/1.5.0/docs/guide/jni/spec/jniTOC.html)(JNI) 从您的 Java 代码中调用本地代码。调用开销很大，并且与 Java 共享数据相当昂贵，因此这应该只用于相当大的本机代码块。

不过，理论上，这样的扩展应该是可能的。可以想象一个针对特定平台并允许程序集转义的 Java 编译器。编译器必须发布它的 ABI，所以你会知道调用约定。但是，我不知道有任何这样做。但是有[几个](http://www.excelsior-usa.com/jet.html) [可用的](http://jnc.mtsystems.ch/)[编译器](http://gcc.gnu.org/java/) 可以将 Java 直接编译为本机代码。其中一个可能在我不知情的情况下支持这样的事情，或者可以扩展到这样做。

最后，在完全不同的层面上，JVM 有字节码汇编器，比如[Jasmin。](http://jasmin.sourceforge.net/)字节码汇编器允许您编写直接针对 JVM 的“机器代码”，有时您可以编写比`javac`编译器生成的代码更好的代码。无论如何，玩起来很有趣。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-05-11T22:13:10.540

您不能在 Java 代码中直接内联汇编。然而，与其他一些答案所声称的相反，可以方便地调用程序集而不通过任何中间 C（或 C++）层。

**快速演练**

考虑以下 Java 类：

```
public class MyJNIClass {

    public native void printVersion();

} 
```

主要思想是使用 JNI 命名约定来声明符号。在这种情况下，在您的汇编代码中使用的损坏名称是`Java_MyJNIClass_printVersion`. 该符号必须在其他翻译单元中可见，例如可以使用`public`FASM 中的`global`指令或 NASM 中的指令来实现。如果您使用的是 macOS，请在名称前附加一个下划线。

使用目标架构的调用约定编写汇编代码（参数可以在寄存器、堆栈、其他内存结构等中传递）。传递给汇编函数的第一个参数是指向 的指针`JNIEnv`，它本身就是指向 JNI 函数表的指针。使用它来调用 JNI 函数。例如，使用 NASM 并以 x86_64 为目标：

```
global Java_MyJNIClass_printVersion

section .text

Java_MyJNIClass_printVersion:
    mov rax, [rdi]
    call [rax + 8*4]  ; pointer size in x86_64 * index of GetVersion
    ... 
```

JNI 函数的索引可以在[Java 文档](http://docs.oracle.com/javase/8/docs/technotes/guides/jni/spec/functions.html)中找到。由于 JNI 函数表基本上是一个指针数组，因此不要忘记将这些索引乘以目标架构中指针的大小。

传递给汇编函数的第二个参数是对调用 Java 类或对象的引用。所有后续参数都是您的本机 Java 方法的参数。

最后，组装您的代码以生成一个目标文件，然后从该目标文件创建一个共享库。GCC 和 Clang 可以使用类似于`gcc/clang -shared -o ...`.

**其他资源**

[此 DZone 文章](https://dzone.com/articles/pushing-the-jni-boundaries-java-meets-assembly)中提供了更全面的演练。我还在[GitHub 上创建了一个完全可运行的示例](https://github.com/PyvesB/javassembly)，请随意查看并试用它以获得更好的理解。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-31T00:31:47.260

可以使用[机器级 Java](http://www.jembryos.org/inline.html)技术从 Java 调用程序集。它将用 Java 编写但与最常用的汇编语法非常相似的汇编代码透明地打包到本机库中。接下来，您只需要调用在编写程序集的同一个类中定义的本机方法。因此，您始终停留在 Java 环境中，无需从 Java IDE 切换到某些汇编工具，然后再切换回 Java。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T10:51:18.470

您可能还想看看[Aparapi](http://code.google.com/p/aparapi/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-24T13:43:16.310

您不能直接从 Java 调用程序集。[但是你可以通过JNI](https://en.wikipedia.org/wiki/Java_Native_Interface)调用 C 代码，然后你可以从那里调用汇编。

[这篇文章展示了如何。](https://web.archive.org/web/20120208002324/http://today.java.net/pub/a/today/2006/10/19/invoking-assembly-language-from-java.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-24T13:44:04.270

您使用 JNI 或 JNA 并从 Java 调用您的本机函数。或者作为替代方案，您将字节码作为 InputStream 并从中创建一个 Java 类。

# forms - 向发布到 php 脚本的 HTML 表单添加更多元素

> ID：11632080
> 
> 赞同：0
> 
> 时间：2012-07-24T13:37:44.323
> 
> 标签：forms

我正在编写一个脚本，用户可以在其中以 HTML 形式编写信息，这些信息可以在 pdf 文件中下载。

一些用户可能希望添加比其他用户更多的信息（例如几个名称），因此我想添加功能以添加更多将信息发送到 PHP 脚本的文本框。 ![在此处输入图像描述](../Images/636cbe031f593a1999565ab8c8c7e5d4.png)

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T13:43:02.643

我正在用 jQuery 做。

[http://api.jquery.com/insertAfter/](http://api.jquery.com/insertAfter/)或[http://api.jquery.com/appendTo/](http://api.jquery.com/appendTo/)

您只需插入一段带有 jquery 设置的变量的 html(name/id/ etc)

# mysql - 统一使用 3 个表的这 2 个查询

> ID：11632084
> 
> 赞同：0
> 
> 时间：2012-07-24T13:37:48.760
> 
> 标签：mysql, sql, query-optimization, multiple-tables

我在一个组和组成员功能中工作

相关表格是：

> usuarios (id, first_name, last_name, ...)
> 
> 组（id、名称、..、id_user）
> 
> group_members (id, id_group, id_user)

使用这种设计，我需要从组表中获取创建者（groups.id_user 是创建者）和来自 group_members 的成员（group_members.id_usuario）

目前我只能通过 2 个查询来实现：

```
/* Retrieve members */
$q = 'SELECT usuarios.id as uid, usuarios.avatar, usuarios.first_name,usuarios.last_name 
                  FROM usuarios LEFT JOIN group_members ON usuarios.id = group_members.id_user
                  WHERE group_members.id_group = '.$this->id.'';
$r =  cache_query($q,'',10);
/* Retrive creator */           
$q2 = 'SELECT usuarios.id as uid, usuarios.avatar, usuarios.first_name,usuarios.last_name
                   FROM usuarios LEFT JOIN groups ON usuarios.id = groups.id_user
                   WHERE groups.id = '.$this->id;
$r2 =  cache_query($q2,'',10); 
```

有没有办法通过一个查询来实现它？（我也在考虑只是将创建者作为成员插入并且只使用第一个查询）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T13:44:15.783

如果您加入了`usuarios`两次表，那么您可以同时获取成员和组创建者信息：

```
select u.id as uid,
    u.avatar,
    u.first_name,
    u.last_name,
    uc.id as creator_uid,
    uc.avatar as creator_avatar,
    uc.first_name as creator_first_name,
    uc.last_name as creator_last_name
from groups g
inner join group_members gm on g.id = gm.id_group
left outer join usuarios u on gm.id_user = u.id
left outer join usuarios uc on g.id_user = uc.id
where g.id = ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:45:47.693

您需要结合两个查询并在子句中添加`OR`条件：`WHERE`

```
SELECT usuarios.id as uid, usuarios.avatar, usuarios.first_name,usuarios.last_name
FROM usuarios
     LEFT JOIN group_members
        ON usuarios.id = group_members.id_user
     LEFT JOIN groups
        ON usuarios.id = groups.id_user
WHERE (group_members.id_group =  '.$this->id.' OR groups.id = '.$this->id) 
```

# android - 在表的行中使用表名连接多个 SQL 表

> ID：11632085
> 
> 赞同：1
> 
> 时间：2012-07-24T13:37:49.703
> 
> 标签：android, sqlite

我正在使用 SQLite，我不确定这是否可以完成。考虑我有这些表：

```
======>Table: Total_Table

_id    Name   Ingredients

0     "A"     "table_a"<br>
1     "B"     "table_b"

=====>Table: table_a

 _id    Name

 0      "a_1" <br>
 1      "a_2"

=====>Table: table_b

_id    Name
0      "a_1" <br> 
```

行中引用的表`Total_Table`具有不同的行数，并在`Total_Table`添加行时创建。

目前，我需要构建一个查询，该查询将从`Total_Table`.

但会搜索`Ingredients`表格的条目。

例如，如果我正在查找表中`Total_Table`包含**a_1**的所有行`Ingredients`，它将返回`0,1`来自`Total_Table`.

目前，我通过查询 的所有行来执行此`Total_Table`操作，然后遍历这些条目并单独查询每个表，然后形成一个数组。

这很糟糕，因为我正在查看的表格相对较大，并且会损害性能。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T13:52:42.467

我认为您会发现使用稍微不同的数据库架构会更容易。SQLite 是一个关系数据库，所以让我们尝试相应地存储东西。基本上，我们将有 3 个表，一个用于`Total_Table`，一个用于您的成分，以及一个用于将哪些成分映射到`Total_Table`.

从逻辑上讲，它将如下所示：

```
Table: Total_Table

_id    Name
0      "A"
1      "B"

Table: Ingredients

_id    Name

0      "a_1"
1      "a_2"

Table: Total_Ingredients

total_id  ingredient_id
0         0
0         1
1         0 
```

这里的好处很多。首先，您不需要在运行时创建任何表。无论您有多少`Total_Table`条目，您都需要 3 个表格。二是查询方便。第三，您不会`a_1`在修改后的模式中的任何地方复制名称（这称为[Database normalization](http://en.wikipedia.org/wiki/Database_normalization)）。

然后，您的查询将如下所示。请注意，在示例数据中，`a_1`id 为 0，我们将用于查询目的。

```
select _id, Name from Total_Table where id in 
  (select total_id from Total_Ingredients where ingredient_id = 0) 
```

**更新：**如果我理解正确，您的其他查询非常相似。因此，您需要具有部分或全部给定成分的食谱。假设您的子集在此示例中包括 id 1、5 和 7，唯一的变化是使用`in`子句。

```
select _id, Name from Total_Table where id in 
  (select distinct total_id from Total_Ingredients where ingredient_id in (1,5,7)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:55:06.050

尝试将您的表组合为一个（最好是视图），然后进行查找。或按如下方式运行您的查询：

```
String name = "bla bla bla";

"SELECT DISTINCT _id FROM Total_Table WHERE _id IN
     ((SELECT _id FROM table_a WHERE Name='" + name + "') UNION ALL
      (SELECT _id FROM table_b WHERE Name='" + name + "'))" 
```

# actionscript-3 - 使用 AS 从舞台移除位于另一个 MovieClip 内的 MovieClip

> ID：11632087
> 
> 赞同：0
> 
> 时间：2012-07-24T13:37:58.780
> 
> 标签：actionscript-3, flash-cs5

我有两个电影剪辑。

第一个影片剪辑在舞台上，实例名称为：main

第二个影片剪辑在第一个影片剪辑内，实例名称为：temp_bar

从舞台上我想删除名为“temp_bar”的movieclip

舞台上的 main.removeChild(temp_bar) 和 removeChild(main.temp_bar) 不起作用。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T15:38:22.573

假设 temp_bar 是实例名称，请尝试使用：

`main.removeChild(main.getChildByName("temp_bar"));`

* * *

如果始终只有一个子主，请使用：

`main.removeChildAt(0);`

# c#-4.0 - 如何从任务管理器和注册表中隐藏使用 Microsoft Visual C# 制作的桌面应用程序？

> ID：11632088
> 
> 赞同：0
> 
> 时间：2012-07-24T13:37:58.643
> 
> 标签：c#-4.0, registry, taskmanager

我正在使用 Microsoft Visual c# .net 第 4 版制作桌面安全应用程序。我希望我的应用程序在 exe 运行时从注册表和任务管理器中隐藏。有什么可行的方法吗？？？

# php - 在 .htaccess 中使用 mod_rewrite 重写 url

> ID：11632089
> 
> 赞同：0
> 
> 时间：2012-07-24T13:38:01.447
> 
> 标签：php, html, url, mod-rewrite

您好，我的网站有问题。

我有一个网址看起来像的网站：

```
site.com/page.php 
```

我听说可以像这样重写网址：

```
site.com/page 
```

我正在寻找那个特定的重写，但它找不到任何东西。我发现的只是：

```
RewriteRule ^$ page.php [L]
RewriteRule ^([a-z]+)/?([0-9]*)/?$ page.php?index=$2 [L] 
```

那是行不通的。

所以如果有人可以帮助我，我真的很感激。多谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:43:03.860

试试这个

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T13:43:10.457

把它放在你的 .htaccess 中

```
RewriteEngine on 
RewriteCond %{REQUEST_FILENAME} !-d 
RewriteCond %{REQUEST_FILENAME}\.php -f 
RewriteRule ^(.*)$ $1.php 
```

然后在您的任何网址中，您可以执行以下操作：

```
http://yoursite.com/about 
```

代替 ：

```
http://yoursite.com/about.php 
```

它仍然会加载

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T13:44:51.213

尝试 ：

```
Options +FollowSymlinks
RewriteEngine on
RewriteRule ^(.+)/$ $1 [L] 
```

和/或不要忘记重新启动 apache ;)

# properties - Groovy 递归复制属性并应用每个属性的调用

> ID：11632091
> 
> 赞同：0
> 
> 时间：2012-07-24T13:38:14.970
> 
> 标签：properties, groovy, clone

使用 Groovy 2.0（测试版）......

得到一个同时具有简单（即原始）和复杂（即其他 bean 作为子级）属性的 bean。想要递归地将 bean 实例中的属性复制到新 bean 中并应用每个属性的函数调用。例如，一个属性可能包含一个表达式（即表示尚未评估的值的东西），在“克隆”/“复制”阶段，我想应用评估，以便新 bean 获得具体值。

Groovy 新手，我的胃告诉我有一种简单的方法来处理这个问题。Bean 是用 Groovy 编写的。

例如：

```
Source.name: '${xpath:applicationServer/name}'
Source.type: 'Server'
Source.create.name: 'com.bea:Name=${domain.name},Type=Domain'
.... 
```

**name**，**type**字段是 Source 类的简单部分，而create**是**复杂的（嵌套属性）。复制时，我想评估变量（即基于上下文的 ${xpath:...}、${domain.name}、公共配置设置）。请注意，复制是在同一类的对象之间完成的。

看过类似的东西：[复制 Groovy 类属性](https://stackoverflow.com/questions/9072307/copy-groovy-class-properties)，其中完成了不同类之间的交集，但嵌套属性的构造不是递归的。

# java - 更新后 BLOB 图像不会显示在 Jlabel 中

> ID：11632099
> 
> 赞同：-1
> 
> 时间：2012-07-24T13:38:47.660
> 
> 标签：java, netbeans, blob, mysql-workbench

我正在构建一个 JAVA Netbeans 和 MySQL 程序，用户可以在其中将图像插入和更新到数据库中。它被成功插入。我已将这些图像设置为显示在 Jlabel 中。但是，一旦我更新了该图像，它就会更新，但图像不会显示在 Jlabel 中。请帮我解决这个问题。这是我的代码

```
package Frames;
import Methods.DB_Con;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.sql.*;
import javax.swing.*;
import net.proteanit.sql.DbUtils;

public class EditCategory extends javax.swing.JFrame {
    private ImageIcon format=null;
    String filename = null;
     int s = 0;
     byte[] category_image = null;

    public void Update_Table(){
        try{
              ResultSet rs;
              Connection con = DB_Con.getConnection();
              String sql ="select Category_Code,Category_Name from category";
              PreparedStatement st = (PreparedStatement) con.prepareStatement(sql);
              rs=st.executeQuery();
              jTable1.setModel(DbUtils.resultSetToTableModel(rs));

              st.close();
        }
        catch(Exception e){
            JOptionPane.showMessageDialog(null, "Error loading table");
        }
    }

    public void set_Icon(){

        try{
           int row= jTable1.getSelectedRow();
           jLabel4.setText(jTable1.getModel().getValueAt(row, 0).toString());
           jTextField1.setText(jTable1.getModel().getValueAt(row, 1).toString());
           Connection con = DB_Con.getConnection();
           ResultSet rs;
           String cat_id=jTable1.getModel().getValueAt(row, 0).toString();

           String sql ="select Category_Image from category where Category_Code='"+cat_id+"'";
           PreparedStatement st = (PreparedStatement) con.prepareStatement(sql);
           rs = st.executeQuery();

           if(rs.next()){
               byte[] imagedata=rs.getBytes("Category_Image");
               format =new ImageIcon(imagedata);
               jLabel1.setIcon(format);
           }
         }
         catch(Exception e){
         }
    }

    /** Creates new form EditCategory */
    public EditCategory() {
        initComponents();

    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        jLabel12 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jLabel5 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        jLabel4 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jButton1 = new javax.swing.JButton();
        jTextField2 = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jTextField1 = new javax.swing.JTextField();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        addWindowFocusListener(new java.awt.event.WindowFocusListener() {
            public void windowGainedFocus(java.awt.event.WindowEvent evt) {
                formWindowGainedFocus(evt);
            }
            public void windowLostFocus(java.awt.event.WindowEvent evt) {
            }
        });
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowOpened(java.awt.event.WindowEvent evt) {
                formWindowOpened(evt);
            }
        });

        jLabel12.setBackground(new java.awt.Color(255, 255, 255));
        jLabel12.setFont(new java.awt.Font("Tahoma", 0, 36));
        jLabel12.setForeground(new java.awt.Color(255, 0, 0));
        jLabel12.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel12.setText("Edit Category");
        jLabel12.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED, null, new java.awt.Color(0, 153, 255), null, null));

        jTable1.setBackground(new java.awt.Color(204, 204, 255));
        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "", ""
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jTable1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable1MouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(jTable1);
        jTable1.getColumnModel().getColumn(0).setResizable(false);
        jTable1.getColumnModel().getColumn(1).setResizable(false);

        jButton2.setText("Done");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        jButton3.setText("Back");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        jLabel5.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel5.setText("**Click on table row to get values to edit**");
        jLabel5.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED, null, new java.awt.Color(0, 153, 255), null, null));

        jLabel1.setBackground(new java.awt.Color(204, 255, 204));
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jPanel1.setBackground(new java.awt.Color(204, 204, 204));
        jPanel1.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jLabel4.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel4.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel2.setText("Edit Category Name");
        jLabel2.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jButton1.setText("Browse New Image");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel3.setText("Category Code");
        jLabel3.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jTextField1.setHorizontalAlignment(javax.swing.JTextField.CENTER);

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(100, 100, 100)
                        .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, 440, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jLabel3, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jLabel2, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 128, Short.MAX_VALUE))
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGap(112, 112, 112)
                                .addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, 440, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                                .addGap(112, 112, 112)
                                .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 440, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(16, 16, 16)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(28, 28, 28)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jButton1)
                    .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(195, 195, 195)
                .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 109, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(209, 209, 209)
                .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 76, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(218, 218, 218))
            .addGroup(layout.createSequentialGroup()
                .addGap(61, 61, 61)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 437, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 115, Short.MAX_VALUE)
                .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(87, 87, 87))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap(288, Short.MAX_VALUE)
                .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 280, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(272, 272, 272))
            .addGroup(layout.createSequentialGroup()
                .addGap(160, 160, 160)
                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 246, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(434, Short.MAX_VALUE))
            .addGroup(layout.createSequentialGroup()
                .addGap(28, 28, 28)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(98, Short.MAX_VALUE))
        );

        layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {jButton2, jButton3});

        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 120, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(33, 33, 33)
                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(29, 29, 29)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(37, 37, 37)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton2)
                    .addComponent(jButton3))
                .addContainerGap(41, Short.MAX_VALUE))
        );

        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        setBounds((screenSize.width-856)/2, (screenSize.height-593)/2, 856, 593);
    }// </editor-fold>                        

    private void jTable1MouseClicked(java.awt.event.MouseEvent evt) {                                     
           set_Icon();

    }                                    

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
        JFileChooser chooser = new JFileChooser();
        chooser.showOpenDialog(null);
        File f = chooser.getSelectedFile();
        filename = f.getAbsolutePath();
       jTextField2.setText(filename);

        try {
            File image = new File(filename);
            FileInputStream fis = new FileInputStream(image);
            ByteArrayOutputStream bos = new ByteArrayOutputStream();

            byte buf[] = new byte[1024];
            for (int readNum; (readNum = fis.read(buf)) != -1;) {

                bos.write(buf, 0, readNum);
            }
            category_image = bos.toByteArray();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, e);
        }

    }                                        

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {                                         
        EditMenuMain em = new EditMenuMain();
        em.setVisible(true);
        this.setVisible(false);
    }                                        

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {                                         
        try{
            int code=Integer.parseInt(jLabel4.getText());
            String newCatName = jTextField1.getText();

            Connection con = DB_Con.getConnection();
            String sql ="update category set Category_Name='"+ newCatName+"',Category_Image='"+category_image+"' where Category_Code='"+code+"'";
            PreparedStatement st = (PreparedStatement) con.prepareStatement(sql);
            int val = st.executeUpdate(sql);

            if(val==1){

                JOptionPane.showMessageDialog(null, "Updated Category Details Successfuly");
            }
            else{
                JOptionPane.showMessageDialog(null, "Fill all fields");

            }

        }
        catch(Exception e){
        }
         Update_Table();

    }                                        

    private void formWindowOpened(java.awt.event.WindowEvent evt) {                                  
        Update_Table();
    }                                 

    private void formWindowGainedFocus(java.awt.event.WindowEvent evt) {                                       

    }                                      

    /**
    * @param args the command line arguments
    */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new EditCategory().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify                     
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextField jTextField1;
    private javax.swing.JTextField jTextField2;
    // End of variables declaration                   

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-25T09:41:38.313

```
Connection connection = null;
    PreparedStatement statement = null;

    ResultSet result;

    public DisplayImage() {
        super("Image Display");
        setSize(600,600);
        connection = getConnection();
        try {
            statement = connection.prepareStatement("select content from image where id=1");
            result = statement.executeQuery();

                byte[] image = null;
                while(result.next()) {
                    image = result.getBytes("content");

                }
                Image img = Toolkit.getDefaultToolkit().createImage(image);
                ImageIcon icon =new ImageIcon(img);
                JLabel lPhoto = new JLabel();
                lPhoto.setIcon(icon);
                add(lPhoto);

        } catch (SQLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        setVisible(true);
    }

    public Connection getConnection() {
        Connection connection = null;

        try {
            Class.forName("com.mysql.jdbc.Driver");
            connection = DriverManager.getConnection(
                    "jdbc:mysql://localhost:3306/db_name", "user", "pass");
        } catch (Exception e) {
            System.out.println("Error Occured While Getting the Connection: - "
                    + e);
        }
        return connection;
    }

    public static void main(String[] args) {
        new DisplayImage();
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T15:01:01.843

构造`ImageIcon`函数无法确定您的图像数据的格式。尝试`ImageIO.read()`方法：[http://docs.oracle.com/javase/1.4.2/docs/api/javax/imageio/ImageIO.html#read(java. io.InputStream](http://docs.oracle.com/javase/1.4.2/docs/api/javax/imageio/ImageIO.html#read(java.io.InputStream) )

将您的字节数组包装在`ByteArrayInputStream`：[http ://docs.oracle.com/javase/6/docs/api/java/io/ByteArrayInputStream.html](http://docs.oracle.com/javase/6/docs/api/java/io/ByteArrayInputStream.html)

# validation - ZF2 休息服务/准则验证

> ID：11632100
> 
> 赞同：1
> 
> 时间：2012-07-24T13:38:49.553
> 
> 标签：validation, zend-framework2

我正在努力寻找在 ZF2 Rest Service 中验证 Doctrine 2 实体的最佳方法。我最初通过扩展 Zend\InputFilter\InputFilter 来实现验证，并将验证器附加到扩展类中的过滤器。我不确定这是不是最好的方法，因为我的验证与我的实体类完全分开。

我考虑过使用 Matthew 的文章[http://mwop.net/blog/2012-07-02-zf2-beta5-forms.html](http://mwop.net/blog/2012-07-02-zf2-beta5-forms.html)中描述的注释来实现我的验证，但是在实例化实体时，我经常在构造函数中有参数，在我看来，这不适用于这种方法。

此外，根据实体的状态，我的实体通常具有不同的验证规则。例如，如果我有一个 BlogPost 实体，并且它处于“草稿”状态，我可能只需要字段的一个子集。如果它处于“已发布”状态，那么我可能需要所有字段。

关于在这里采取的最佳方法有什么想法吗？由于这是一个 REST 实现，我不需要 Zend\Form 提供的任何视觉效果。我应该继续扩展\Zend\InputFilter\InputFilter 的方法吗？还是我应该朝注释方向走？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T01:19:24.703

注释很棒，我们将它们与代码生成一起使用，以便我们可以根据 Doctrine EntityManger 返回的模式属性定义表单元素行为。我希望注解能将更多的实体定义放在一个地方并使它们更易于管理，到目前为止，这是真的。

话虽如此，我发现注释有点不灵活，因为注释分配的属性不能被子类中的其他注释覆盖。

在运行时用注解覆盖属性集很容易，但是你不能用更多的注解来做到这一点。（可能是在说显而易见的。）

所以我目前正在我的控制器操作中进行覆盖。

例子：

```
 $builder = new AnnotationBuilder();
    $form = $builder->createForm($myEntity);

    // customize the the InputFilter for myElement
    $form->getInputFilter()->get('myElement')->setAllowEmpty(FALSE);
    $form->getInputFilter()->get('myElement')->setRequired(TRUE);
    $form->getInputFilter()->get('myElement')->getValidatorChain()->addValidator(new \Zend\Validator\NotEmpty('all'));

    // carry on with the form as normal
    $form->setData($this->getRequest()->getQuery()); 
```

由于我才刚刚开始需要应用自定义验证规则，并且预计这些规则会随着时间的推移变得更加复杂，甚至可能是有条件的，因此我希望我希望将表单构建器从控制器中移到模型中。原因是，当/如果我开始定义有条件的验证规则时，该逻辑在它所属的模型中。这也将清理控制器操作，因为所有表单组件都变成了黑盒方法。

例子：

```
 $form = $myEntityModel->buildForm($myEntity);

    // carry on with the form as normal
    $form->setData($this->getRequest()->getQuery()); 
```

所以我认为你是否使用注释来定义你的默认输入规则并不重要。无论您最初如何定义它们，您都将根据业务逻辑修改它们。

在我看来，您可能会受益于将表单组装移动到模型类中以实现将验证规则与实体完全分离的目标。我相信您的直觉是正确的，业务逻辑需要保留在模型中，而不是控制器或实体中。

# c# - MS VisualStudio 2012 中的 ShimNotSupportedException

> ID：11632108
> 
> 赞同：5
> 
> 时间：2012-07-24T13:39:18.623
> 
> 标签：c#, visual-studio, microsoft-fakes, isolation, shim

我只是想熟悉 Visual Studio 2012 RC 中新的 Fakes 隔离框架，但我因此面临`ShimNotSupportedException`s.
在第一次尝试时，我尝试将委托连接到的每个单一 shim 方法`ShimNotSupportedException`在尝试运行/调试测试时都抛出了一个。

```
[TestMethod]
public void GetFoo_ValidBar_ReturnsBaz()
{
    using(ShimsContext.Create())
    {
        ShimDateTime.NowGet = () => new DateTime(2012,08,11,10,20,59);

        const string expected = "20120811_102059";
        string actual = GetFoo();

        Assert.AreEqual(expected,actual);
    }
} 
```

这是相应的堆栈跟踪：

> GetFoo_ValidBar_ReturnsBaz 测试方法引发了异常：Microsoft.QualityTools.Testing.Fakes.Shims.ShimNotSupportedException: System.DateTime at Microsoft.QualityTools.Testing.Fakes.UnitTestIsolation.UnitTestIsolationRuntime.InvokeEvent(T value, Action1 eh) at Microsoft.QualityTools。 Testing.Fakes.UnitTestIsolation.UnitTestIsolationRuntime.OnAttachedUnsupportedMethod(MethodBase 方法) 在 Microsoft.QualityTools.Testing.Fakes.UnitTestIsolation.UnitTestIsolationRuntime.CheckInstrumentation(MethodBase 方法) 在 Microsoft.QualityTools.Testing.Fakes.UnitTestIsolation.UnitTestIsolationRuntime.InternalAttachDetour(Object optionalReceiver, MethodBase方法，委托 detourDelegate) 在 Microsoft.QualityTools.Testing.Fakes.UnitTestIsolation.UnitTestIsolationRuntime.AttachDetour(Object optionalReceiver,Microsoft.QualityTools.Testing.Testing.Fakes.Shims.ShimRuntime.SetShimMethod(Delegate optionalStub, Object optionalReceiver, MethodBase method) 在 Microsoft.QualityTools.Testing.Fakes.Shims.ShimRuntime.SetShim(Delegate optionalStub, Type receiverType) 的 MethodBase 方法，委托 detourDelegate) , Object optionalReceiver, String name, ShimBinding flags, Type returnType, Type[] parameterTypes) at Microsoft.QualityTools.Testing.Fakes.Shims.ShimRuntime.SetShimPublicStatic(Delegate optionalStub, Type receiverType, String name, Type returnType, Type[] parameterTypes)在 BazTests.cs 中的 GetFoo_ValidBar_ReturnsBaz() 处的 System.Fakes.ShimDateTime.set_NowGet(Func'1 value)：第 48 行。MethodBase 方法）在 Microsoft.QualityTools.Testing.Fakes 的 Microsoft.QualityTools.Testing.Fakes.Shims.ShimRuntime.SetShim（Delegate optionalStub, Type receiverType, Object optionalReceiver, String name, ShimBinding flags, Type returnType, Type[] parameterTypes）在 Microsoft.QualityTools.Testing.Fakes。 Shims.ShimRuntime.SetShimPublicStatic(Delegate optionalStub, Type receiverType, String name, Type returnType, Type[] parameterTypes) at System.Fakes.ShimDateTime.set_NowGet(Func'1 value) at GetFoo_ValidBar_ReturnsBaz() in BazTests.cs：第 48 行。MethodBase 方法）在 Microsoft.QualityTools.Testing.Fakes 的 Microsoft.QualityTools.Testing.Fakes.Shims.ShimRuntime.SetShim（Delegate optionalStub, Type receiverType, Object optionalReceiver, String name, ShimBinding flags, Type returnType, Type[] parameterTypes）在 Microsoft.QualityTools.Testing.Fakes。 Shims.ShimRuntime.SetShimPublicStatic(Delegate optionalStub, Type receiverType, String name, Type returnType, Type[] parameterTypes) at System.Fakes.ShimDateTime.set_NowGet(Func'1 value) at GetFoo_ValidBar_ReturnsBaz() in BazTests.cs：第 48 行。在 BazTests.cs 的 GetFoo_ValidBar_ReturnsBaz() 中的 System.Fakes.ShimDateTime.set_NowGet(Func'1 value) 处键入接收器类型、字符串名称、类型 returnType、Type[] parameterTypes)：第 48 行。在 BazTests.cs 的 GetFoo_ValidBar_ReturnsBaz() 中的 System.Fakes.ShimDateTime.set_NowGet(Func'1 value) 处键入接收器类型、字符串名称、类型 returnType、Type[] parameterTypes)：第 48 行。

在阅读了我在 MSDN 上找到的处理此问题的两个线程后，我按照他们的说明（关闭 CodeCoverage，删除 .testsettings 文件）对我不起作用！
尽管如此，我还是找到了解决此问题的方法：
首先从测试资源管理器运行所有测试（而不是直接在编码区域之外使用“MSTest 测试（单击以运行）”按钮），一切正常并且没有抛出异常。之后我什至可以调试测试并且分配给 shim 方法的工作与预期一样。
这也适用于我使用的所有以下垫片。
但是现在我在尝试实现 MS Enterprise Library 的伪造品以进行数据库访问时又遇到了同样的问题。

这是测试的样子：

```
[TestMethod]
public void GetFooFromEF_NonEmptyDataReader_ObjectsCorrectlyInstantiated()
{
    using(ShimsContext.Create()){
        var dataReader = new StubIDataReader()
            {
                ItemGetString = s => 1,
                DepthGet = () => 2
            };

        ShimFoo.GetBar = guid => dataReader;

        var bar = new StubIBar()
        {
            ConvertIBarToBaz = record => null
        };

        ShimQux.AllInstances.GetBar = (a, b) => bar;

        var dbFactory = new StubDbProviderFactory();
        var db = new StubDatabase("test", dbFactory);
        ShimDatabaseFactory.CreateDatabaseString = s => db;

        List<BarInformation> actual = accessor.InvokeStatic("GetBar",
                                                                new Object[] { }) as List<BarInformation>;
        Assert.IsTrue(true);
    }
} 
```

前两个 shim 分配（ShimFoo 和 ShimQux）按预期工作。但是 ShimDatabaseFactory.CreateDatabaseString （这应该使 DatabaseFactory.CreateDatabase(string) 在尝试创建新数据库实例时返回一个存根数据库）再次引发 ShimNotSupportedException。我就是不知道为什么！
你知道这里出了什么问题吗？

我将不胜感激对此的任何意见。

谢谢，
本杰明

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T11:24:20.717

我有同样的问题。尝试删除所有 testsettings 文件（从磁盘和解决方案中），并确保您的解决方案不引用任何 testsettings 文件。

还要确保您使用的是视觉工作室测试运行程序（而不是检测代码的 resharper 等）。

我写了两篇关于这些问题的博文，可能会有所帮助：

[Visual Studio 2012 Fakes – 调试测试时出现 ShimNotSupportedException](http://blog.degree.no/2012/09/visual-studio-2012-fakes-shimnotsupportedexception-when-debugging-tests/)

[单元测试——Team City 中的 Visual Studio 2012 Fakes](http://blog.degree.no/2012/09/unit-testing-visual-studio-2012-fakes-in-team-city/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-20T15:21:50.870

我已经多次看到这个错误，原因不同：

*   您的假货生成文件中存在错误或问题，其中一些未正确生成。清理目录并重新制作您的虚假参考
*   缺少依赖的 dll。在这种情况下，您缺少一个假货 dll 所依赖的 dll。在一种情况下，我正在填充 Web 服务并缺少 System.ServiceModel dll。
*   有时您可以通过更改测试设置默认处理器架构来修复它。但是我不知道为什么，它可能会刷新一些缓存的 dll。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-07T18:53:18.170

问题与测试设置有关。我已经完成了以下链接的建议，并在尝试了许多可能的解决方案后终于奏效了

[http://blog.degree.no/2012/09/visual-studio-2012-fakes-shimnotsupportedexception-when-debugging-tests/](http://blog.degree.no/2012/09/visual-studio-2012-fakes-shimnotsupportedexception-when-debugging-tests/)

# javascript - javascript 对象是否有类似 toString 的函数？

> ID：11632113
> 
> 赞同：3
> 
> 时间：2012-07-24T13:39:32.043
> 
> 标签：javascript, debugging

在使用 javascript 进行调试和开发时，我经常想提醒对象，所以我使用了以下代码：

```
for(a in obj)
{
  alert(a +' = '+obj[a])
} 
```

它服务很好，但它太烦人了。我想知道数组是否有这样的东西：

```
var temp = ['a','b','c'];
alert(temp); // it will alert a,b,c 
```

所以我想做的是：

```
var temp = {a:'a',b:'b',c:'c'};
alert(temp) ; // It should alert json {a:'a',b:'b',c:'c'} 
```

或任何其他更好的建议，以便我可以轻松查找对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T13:49:18.833

警报调用 toString，因此您可以覆盖 toString 以进行调试：

```
Object.prototype.toString = function() {
    return JSON.stringify(this);
}; 
```

所以你可以打电话`alert(foo);`，它会显示 foo 的 JSON 表示

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T13:42:12.067

采用

```
alert(JSON.stringify(temp)) ; 
```

代替

```
alert(temp) ; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T17:08:48.833

您也可以这样做，以便警报格式可以是您想要的

```
 Object.prototype.toString = function{
    var str='';
    for(a in this)
    {
      str+=a +' = '+obj[a]);
    }    
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T13:41:56.717

javascript参考指南说javascript对象有一个toString方法，请参阅页面[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/toString](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/toString)

它在 mozilla 开发者页面上，但我相信这应该是您所需要的。摘录在这里，“ var o = new Object(); o.toString(); ”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T13:43:09.620

一种解决方案是：

[dump() - 相当于 PHP 的 print_r() 函数的 Javascript](http://www.openjs.com/scripts/others/dump_function_php_print_r.php)

Perl 为这样的工作提供了 Data::Dumper。非常适合这种情况。非常适合调试。

更好的方法是使用 JSON.stringify：

```
JSON.stringify({a:1,b:2,c:{d:1,e:[1,2]}}, null, 4); // Indented 4 spaces
JSON.stringify({a:1,b:2,c:{d:1,e:[1,2]}}, null, "\t"); // Indented with tab 
```

参考：[如何以编程方式美化 JSON](https://stackoverflow.com/questions/2614862/how-can-i-beautify-json-programmatically)

而 alert() 只会让你更伤心，开始使用控制台日志吧。它们是持久的，允许您更一致地引用输出。

参考：[如何在 google chrome javascript 控制台中打印调试消息](https://stackoverflow.com/questions/217957/how-to-print-debug-messages-in-the-google-chrome-javascript-console)

更好的是：使用 JavaScript 调试器来分析您的对象。这通常比简单地打印或警告信息更好。但是，如果您必须在许多位置执行此操作，控制台日志通常会更好。

参考：[如何在 Google Chrome 中启动 javascript 调试器？](https://stackoverflow.com/questions/66420/how-do-you-launch-the-javascript-debugger-in-google-chrome)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-24T13:44:27.607

> *或任何其他更好的建议，以便我可以轻松查找对象。*

如果您记录一个对象，大多数优秀浏览器的控制台都可以让您深入了解它。例如，使用 Chrome：

```
console.log(obj); 
```

将树视图对象记录到控制台。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-21T16:24:33.213

你可以使用这个功能：

```
function dump(arr,level) {
    var dumped_text = "";

    if(!level) level = 0;
    var level_padding = "";

    for(var j=0;j<level+1;j++)
        level_padding += "    ";

    var type = typeof(arr);

    if (arr === null){
        dumped_text = "null";
    } else if (arr instanceof Array) {
        dumped_text += "[";

        for(var item in arr) {
            var value = arr[item];
            dumped_text += dump (value, level+1) + ',';
        }

        if(dumped_text.length > 1)
            dumped_text = dumped_text.substring (0, dumped_text.length-1);
        dumped_text += "]";
    } else if(type == 'object') {
        dumped_text += "{\n";

        for(var item in arr) {
            var value = arr[item];
            dumped_text += level_padding + item + " : ";
            dumped_text += dump(value,level+1) + ',\n';
        }

        if(dumped_text.length > 2)
            dumped_text = dumped_text.substring (0, dumped_text.length-2);

        dumped_text += "\n" + level_padding.substring (0, level_padding.length-4) + "}";
    } else if (type == 'string'){
        dumped_text = "'" + arr + "'";
    } else if (type == 'number'){
        dumped_text = arr + "";
    } else if (type == 'boolean'){
        dumped_text = arr + "";
    }
 return dumped_text;
} 
```

# jquery - 选择仅由于继承样式而隐藏的元素（不是由于没有文本内容）

> ID：11632119
> 
> 赞同：3
> 
> 时间：2012-07-24T13:40:00.367
> 
> 标签：jquery, css, dom

`display: none`我想过滤掉由于自身显式或由于祖先被隐藏而不是因为它在选择时恰好没有文本而被隐藏的元素（来自给定的 jQuery 对象） 。

例如：

```
<p id="p"></p> 
```

现在，`$('#p').is(':hidden')`将是`true`因为该段落中没有文本内容，因此没有可见的宽度或高度。但是，如果我在 p 中放入一些文本，jQuery 将不再认为它是隐藏的。我的代码需要找到这种元素并将文本放入其中。

不幸的是，元素的计算样式并没有`display: none`从祖先继承，所以似乎唯一的方法是找出是否由于样式而隐藏了某些东西是遍历树直到`display: none`找到一个元素：

```
jQuery.expr.filters.reallyHidden = function(elem) {
    do {
        if (jQuery.css( elem, "display" ) === "none") {
            return true;
        }
        elem = elem.parentNode;
    } while (elem);
    return false;
}; 
```

有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:34:10.293

您可以使用[filter()](http://api.jquery.com/filter/)过滤掉您想要的元素。这将找到正文中的所有元素并返回所有具有显式显示的元素：无 css

```
$('body').find('*').filter(function(){ 
    return $(this).css('display') == 'none';
}); 
```

[http://jsfiddle.net/Yrc4M/](http://jsfiddle.net/Yrc4M/)

# java - 为什么这么红？IntelliJ 似乎认为无法找到/解决每个声明/方法

> ID：11632120
> 
> 赞同：155
> 
> 时间：2012-07-24T13:40:08.277
> 
> 标签：java, intellij-idea

我刚刚安装并重新安装了 IntelliJ。每个 Java 文件都会出现 RED。我检查了JDK；它是 1.6.##。构建工作得`maven clean install`很好。

我得到了通常突出显示的错误。在每个声明中：

> 无法解析符号 SomeEntityBean/Bean

并在每种方法上：

> 无法解析方法 SomeFunction()

如何修复这些错误错误？

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2012-07-24T14:07:38.763

即使没有 Korgen 所描述的外部更改，IntelliJ 有时也会自己感到困惑（尽管这是始终如一地重现它的好方法）。

**单击 File -> Synchronize**，IntelliJ 应该会再次看到一切正常。

如果这不起作用，IntelliJ 的缓存可能已损坏（这种情况过去比现在更频繁地发生）；在这种情况下，通过

**单击 File -> Invalidate Caches 并重新启动 IDE**

（尽管重新创建缓存时加载项目需要一段时间）。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2015-02-17T07:51:50.603

当我手动更新我的 JDK 并删除以前的 JDK 时，我遇到了这种情况

![红色关键字](../Images/f76c6182f0c248e0f42038d13d9c6dfd.png)

# 解决方案

*   在 IntelliJ 编辑器中，单击红色关键字*（`Integer`例如）*并按`ALT`+ `ENTER`（或单击灯泡图标）
*   从意图菜单中选择*设置 JDK*

![IntelliJ 意图菜单](../Images/7a8969a8c5fa709dc3763f3fae22852b.png)

*   点击`Configure`

![项目 SDK 选择对话框](../Images/1738607c01c9137966a12831ee136eb3.png)

*   就我而言，JDK 路径不正确（指向`/opt/jdk1.7.0_51`而不是`/opt/jdk1.7.0_65`）

![损坏的配置 SDK 对话框](../Images/ea45c9079f57d545c9c1c4b7af6cc9df.png)

*   单击`...`并浏览到正确的 JDK 路径

![修复了配置 SDK 对话框](../Images/7ec3114f87ed0ea780575e4b22f24f48.png)

*   让我们清除缓存：

![IntelliJ 文件菜单](../Images/0e123a6025df511df56268ca92b306cd.png)

**一切都应该恢复生机:)**

![没有红色关键字](../Images/9d04d4bdafc3aa02c50309daea36ff67.png)

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2012-07-24T14:00:59.750

IntelliJ 在导入 maven 项目然后在外部更改 pom 或在 IntelliJ 之外生成源代码后有时会感到困惑。

您可能想从项目根目录的 intellij 中尝试 maven->force reimport

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-03-12T10:35:31.230

在我的 pom.xml 中将 JDK 从 1.6 更改为 1.7 并将 Maven 3 路径 + JDK 项目设置设置为 1.7 后，我遇到了同样的问题。

为我做的是 => 文件 -> 使缓存无效并重新启动

PS：问题再次出现，所以我在删除 .idea 文件夹后重新导入了整个项目，现在它可以正常工作了：）

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2018-08-06T07:31:18.067

在我的例子中，getter 和 setter 依赖是通过 lombok 插件（使用 java 和 Spring）来实现的。而在新安装的intellij idea中，我并没有安装lombok插件。安装 lombok 插件为我修复了它。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2019-09-20T14:23:35.633

如果您仍然收到此错误，即使您已尝试了有关此问题的所有其他建议，您已检查所有 JDK、Maven 设置、缓存无效、同步您的工作区并重新启动，但仍然无法正常工作您，然后转到您的项目目录并删除整个`.idea`文件夹。重启你的 IntelliJ；下的所有文件`.idea`都将重新创建，以反映当前情况。

至少，这对我有用。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2018-05-29T09:46:27.227

我的问题通过将 jdk 更改为**default**解决了，就像这样。已安装 Open Jdk，但不知道为什么 intellij 将配置设置为 **java-8-openjdk-amd64**。这就是问题所在。我已更改为 default-java 并且不再出现红色错误。

[![在此处输入图像描述](../Images/31447429b96f3f6d2e972f221ec73a39.png)](https://i.stack.imgur.com/Qs4iO.png)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-07-17T17:59:47.293

这是如果您看到红色的 Java 类并收到此错误***“无法解析符号”***。

如果您将项目导入 IntelliJ 并且上述解决方案均不适合您，请尝试一下。当其他一切都失败时，这对我有用。

转到您的项目文件夹并重命名/删除包含项目创意设置的**.idea文件夹。**这将是从您的旧 IntelliJ 版本创建的。重命名/删除***.idea***文件夹后，将项目导入 IntelliJ。您现在应该不会看到 Java 类的任何错误。希望这有帮助。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-10-10T03:54:03.370

检查 IntelliJ 属性中是否有正确的 JVM SDK 设置。如果 invalidate-cache-and-restart 还不够，请检查您是否使用了正确的 JVM SDK，例如 Java 1.7。

查看：首选项 -> IDE 设置 -> Scala -> JVM SDK

或右键单击您的项目 -> 打开模块设置 -> 项目设置 -> 项目 -> 项目 SDK -> （设置为 Java 1.7）

打开模块设置 -> 平台设置 -> SDKs -> （确保有 Java 1.7，否则需要添加）

如果您进行了更改，那么最好重新运行 Invalidate Cache & Restart。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-06-26T23:46:27.673

我在 Mac 上有 IntelliJ IDEA 12.x，我使用 Maven 3，即使 Maven 构建很好，我的代码也会突出显示红色。以上（重新索引、强制导入等）都不适合我。我必须执行以下操作：

```
Intellij -> Preferences -> Maven -> Importing
    [ ] Use Maven3 to import projects 
```

我必须检查 Maven3 导入选项并解决问题。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-11-09T20:58:27.413

另一个解决方法！其中一个建议单击的解决方案`Alt` `Enter`没有适合我的 Setup JDK，但可以`Add ... to classpath`工作。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-07-30T09:02:16.807

尝试使缓存无效，重新导入项目，切换到内置 Maven，删除 .m2 文件夹及其部分， - 没有任何效果。在我完全破坏了 Maven 之后（虽然它之前已经成功构建了项目，但现在它不能了），我不得不从头开始重新安装它。它有帮助！

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-05-08T07:47:13.167

`There can be various reasons. you can apply following solution in order. Follow next solution if before one doesn't work.`

```
1\. Check the If project is using proper version of JDK (File -> Project Structure -> Project -> Project sdk )
2\. Invalidate cache -> (File -> Invalidate cache)
3\. Delete .idea folder and Invalidate cache. (present in project directory)
4\. Delete .idea & *.iml file and Invalidate cache. (present in project directory) 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-03-06T12:03:18.930

我有同样的问题。

就我而言，问题出在 Maven`home directory`和`user settings file`Maven 下的 Intellij Settings 中。我没有在默认目录中安装 Maven，并且还更改了`settings.xml`文件的位置。这也应该在 IntelliJ 设置中进行更改。

希望这也有帮助。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-05-29T08:22:16.717

使用 IntelliJ 2019.3 和依赖于我自己的 Gradle 项目的 Gradle 项目，唯一为我修复它的是`Reimport All Gradle Projects`（`View -> Tool Windows -> Gradle`和刷新按钮）。

在此之前我尝试重新启动 IDE，我尝试了“使缓存无效并重新启动”，我尝试了重建项目，但都没有帮助。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-07-17T00:22:31.543

我花了一天的大部分时间在这里尝试所有解决方案，但似乎没有任何效果。唯一对我有用的是完全卸载 IntelliJ 并重新安装。但是，对我来说，当我从 Application 文件夹中删除 IntelliJ 时，我重新安装它后问题又回来了。我最终要做的是使用 App Cleaner 彻底删除 IntelliJ 以及所有配置和设置文件。在我这样做然后重新安装 IntelliJ 之后，问题终于消失了。请参阅[如何在 Mac 上卸载 IntelliJ](https://nektony.com/how-to/uninstall-intellij-on-mac#uninstall_intelliJ_using_appcleaner)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-04-23T09:18:55.917

如果所有答案都不起作用，请尝试更新**Lombok 依赖**项并在 Intellij 中安装**Lombok 插件**。

用于安装/更新 Lombok 插件

*   按 Alt + Ctrl + S
*   插件
*   搜索 Lombok 安装/更新
*   文件（左上）
*   使缓存无效..
*   无效并重新启动

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-08-03T05:57:34.880

我必须先删除 .idea 文件夹，然后使用无效缓存方法重新启动 IntelliJ。仅使缓存无效是不够的

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-06-14T13:13:43.320

我试图使用上面的所有建议，但不幸的是没有人帮助我。所以最后我决定删除我的 intelij 工作区并创建新的工作区 - 它有帮助:) 但早些时候我也在清理缓存，重新导入 maven 项目，清理项目并重建它们。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-08-09T13:01:05.560

我遇到了同样的问题，在尝试了上述所有建议后，结果发现我的 IntelliJ 安装没有选择我的 JAVA_HOME 系统变量，并且没有设置 SDK/JDK。

我按照以下说明修复了它： [配置全局、项目和模块 SDK](https://www.jetbrains.com/help/idea/2016.2/configuring-global-project-and-module-sdks.html)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-10-19T09:51:49.950

对我来说，是 JDK 设置不正确。我找到了我在这里记录的解决方案：[https ://stackoverflow.com/a/40127871/808723](https://stackoverflow.com/a/40127871/808723)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-09-25T23:14:13.610

问题是我尝试导入的文件太大，IntelliJ 无法在其上运行任何 CodeInsights。

[根据此答案](https://stackoverflow.com/a/23058324/1112669)的说明将`idea.max.intellisense.filesize`选项设置为更高的值解决了我的问题。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-02-23T23:53:52.847

我在使用带有 IntelliJ 14 的 JDK 1.9 时遇到了同样的问题，我解决了使用最新版本的 JDK 1.8（在这种情况下为 1.8.0_161）重新安装 Java

我还从

HKEY_CURRENT_USER\Software\JavaSoft\JRE\Security Baseline

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2018-03-02T15:54:06.303

我有同样的问题，为我解决的问题是：

转到`File>Setting>Maven`，我设置了 Maven 主目录、设置文件和本地 repo。

转到 Maven 项目并单击`Reimport All Maven Projects`

[![在此处输入图像描述](../Images/0ee514ba4d4e1105f5833d01de5e1363.png)](https://i.stack.imgur.com/J1o9D.png)

这成功了！

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-04-08T21:30:42.930

我在全新安装 IDEA 时遇到了这个问题。我认为它带来了自己的 JDK，或者能够找到机器上已经存在的 JDK，但显然不是（现在不确定安装对话框中的复选框是做什么的）。当我单击灯泡并单击“设置 JDK”按钮，然后单击“配置”时，它显示它正在尝试从

`C:\Program Files\JetBrains\IntelliJ IDEA Community Edition 2018.1\jre64`

我四处浏览，尝试了 JetBrains 树中的几个文件夹，但至少对话框足够聪明，不会让我应用任何文件夹（包括原始文件夹），说它们不是 JDK 的有效位置。所以我浏览了 Java 树并尝试了它，它接受了这个：

`C:\Program Files\Java\jdk1.8.0_40`

在我确定配置后，它似乎没有工作；所以我去尝试使IDEA缓存无效并重新启动（如其他答案中所述），它告诉我我有后台任务正在运行。所以我取消了失效，当我这样做时，无论它正在做什么重新编译或数据库更新都完成了，编辑窗口中的所有红色都消失了。因此，JDK 配置需要几秒钟（至少）才能稳定下来。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-04-10T22:06:17.670

尝试从 C:\Users\Username 中删除 .IntelliJIdea15（取决于版本）

当您启动 IntelliJ 时，它将再次创建该文件夹。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2018-08-31T19:08:48.873

IntelliJ Ultimate 2018.2 上的另一个解决方案

*   将鼠标悬停在标记为红色的导入上
*   在左侧（下）出现的弹出窗口中选择下拉箭头
*   选择“将库...添加到类路径”

[![在此处输入图像描述](../Images/5a5624422943df523eed498c6d744be0.png)](https://i.stack.imgur.com/TdRgC.png)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2019-02-11T12:02:09.480

只需“刷新所有 Gradle 项目”即可解决

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2019-08-09T20:43:34.470

我无法让任何这些解决方案为我工作。我必须手动转到出现错误的每个方法/类并手动导入。之后一切都很好。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2020-07-14T11:36:46.380

升级 Intellij 版本时我面临同样的问题。通过使用旧的 maven 而不是与新的 Intellij 捆绑的那个，我解决了这个问题。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2020-07-25T02:42:15.443

对于 2020.1.4 Ultimate 版，我必须执行以下操作

`View -> Maven -> Generate Sources and Update Folders For all Projects`

`mvn -U clean install`对我来说，问题是图书馆没有从终端中填充。

[![在此处输入图像描述](../Images/de44fe3ea72342008fc891e41bded74d.png)](https://i.stack.imgur.com/TFOcP.jpg)

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-08-11T12:21:49.660

这里的答案都没有帮助我，但我确实设法解决了它。
我的项目结构如下所示：

```
-- myprojectname
    -- .idea
    -- backend
    -- frontend 
```

在我的后端文件夹中，每个 java 文件都显示为红色。我必须将后端文件夹标记为模块（带有蓝色方块的文件夹[![在此处输入图像描述](../Images/9b19cd506aa7f1eaf371e16718cc8f7b.png)](https://i.stack.imgur.com/wySjC.png)）。跟着这些步骤：

*   转到文件 -> 项目结构 -> 项目设置 -> 模块
*   选择添加[![在此处输入图像描述](../Images/0fc7ea90b6d130a8485d12ecf129d58c.png)](https://i.stack.imgur.com/0cy6t.png)-> 导入模块
*   查找并选择您的 pom.xml 或 build.gradle 文件 -> 确定
*   选择新模块并将 src/main/java 目录标记为“Sources”，将 src/main/resources/ 标记为“Resources”。对测试文件夹进行类似操作，将它们标记为“测试”和“测试资源”。
*   选择应用 -> 确定

如果您收到通知“安全模式，功能有限”，请在通知中选择“信任项目...”。几秒钟后，一切都应该没问题。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2021-08-16T07:44:39.557

当 Intellij 从 2021.1 更新到 2021.2 时，我遇到了这个问题。就我而言，没有一个解决方案有效。我使用 ant 作为构建工具。如果没有解决问题，请按照此方法尝试使缓存/重新启动无效。文件->项目结构->模块。在 Dependencies 选项卡下，根据您的项目重新排列依赖项并应用更改。 [![在此处输入图像描述](../Images/bac28a622b091a0d46909859134d91b4.png)](https://i.stack.imgur.com/yMXmW.png)

# c# - 对象自动更新，无需任何分配

> ID：11632121
> 
> 赞同：0
> 
> 时间：2012-07-24T13:40:08.573
> 
> 标签：c#, class, object, data-structures, binary-tree

我用 C# 编写了一个简单的程序来在二叉树中添加一个节点。我有一个对象字段“根”来保存主父节点。这样每次我添加一个节点时，我都会通过检索父节点中的数据来遍历树。

这是我的代码

```
public class BTNode
    {
        public int Value { get; set; }        
        public BTNode Left { get; set; }
        public BTNode Right { get; set; }
        public BTNode Root { get; set; }
   }

public class BinaryTree
   {
       public  BinaryTree()
        {
            size = 0;
            Root = null; //To hold the main Parent Node
         }
        int size;
        object Root;

        public void AddNode(int value)
        {
            BTNode NewNode = new BTNode();
            if (Root != null)
            {
                NewNode = (BTNode)Root; //If tree exists, Get the Root Node
            }

            while (NewNode.Root != null)
            {
                if (value < NewNode.Value)
                {
                    NewNode.Root = NewNode.Left;
                }
                else if (value > NewNode.Value)
                {
                    NewNode.Root = NewNode.Right;
                }
            }

            size++;
            NewNode.Value = value;   //OBJECT 'ROOT' GETTING UPDATED AT THIS POINT
            NewNode.Root = NewNode;  //self pointer 
            NewNode.Left = null;
            NewNode.Right = null;

            if (size == 1)
            {
                Root = (object) NewNode;  //if this is the Parent Node(First Node) 
            }                             //then update the Root to be the parent Node
        }
    } 
```

我只想在“Root”中保留二叉树的父节点。我只想在 size =1 时执行最后一行，即如果它是树的第一个节点，但无论我做什么，Root 都会为每个节点更新节点。我很难知道为什么会这样，请帮助我。我错过了任何概念，这里的逻辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T13:46:58.777

1.  您的`Root`属性可以键入到`BTNode`. 这样你就不需要投射它
2.  该行`NewNode = (BTNode)Root;`正在获取根节点引用。您所做的任何更改`NewNode`都会影响根节点。你知道**值类型**和**引用类型**吗？
3.  我不明白你为什么要*向上*（检查`Root`）而不是*向下*（检查左或右节点）。

请检查此解决方案。它使用一种简单的递归方法来放置新节点：

```
public class BinaryTree
    {
        public BinaryTree()
        {
            size = 0;
            Root = null; //To hold the main Parent Node
        }
        int size;
        BTNode Root;

        public void AddNode(int value)
        {
            size++;
            BTNode NewNode = new BTNode()
            {
                Value = value
            };

            if (this.Root == null)
            {
                this.Root = NewNode;
                return;
            }

            this.PlaceNewNode(this.Root, NewNode);
        }

        public void PlaceNewNode(BTNode RootNode, BTNode NewNode)
        {
            if (NewNode.Value < RootNode.Value)
            {
                if (RootNode.Left != null)
                {
                    PlaceNewNode(RootNode.Left, NewNode);
                }
                else
                {
                    RootNode.Left = NewNode;
                    return;
                }
            }
            else
            {
                if (RootNode.Right != null)
                {
                    PlaceNewNode(RootNode.Right, NewNode);
                }
                else
                {
                    RootNode.Right = NewNode;
                    return;
                }
            }
        }
    } 
```

希望这可以帮助。

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:28:06.513

我认为您对 Root 一词的使用令人困惑。一棵树只能有一个根对象。节点对象可以有一个父节点（除非它是根节点）。树结构非常适合递归代码。

这是一些类似于 Andre 发布的代码。

```
public class BTNode
{
    public BTNode() { }
    public BTNode(int value) { Value = value; }

    public int Value { get; set; }
    public BTNode Left { get; set; }
    public BTNode Right { get; set; }
    public BTNode Parent { get; set; }
}

public class BinaryTree
{
    public BinaryTree() { }

    public BTNode Root { get; private set; }
    public int Size { get; private set; }

    public void AddNode(int value)
    {
        BTNode insertNode = new BTNode(value);
        if (Root == null)
            Root = insertNode;
        else
            AddNodeToTree(Root, insertNode);
        Size++;
    }

    private void AddNodeToTree(BTNode parentNode, BTNode insertNode)
    {
        if (insertNode.Value >= parentNode.Value)
        {
            if (parentNode.Right != null)
                AddNodeToTree(parentNode.Right, insertNode);
            else
            {
                parentNode.Right = insertNode;
                insertNode.Parent = parentNode;
            }
        }
        else
        {
            if (parentNode.Left != null)
                AddNodeToTree(parentNode.Left, insertNode);
            else
            {
                parentNode.Left = insertNode;
                insertNode.Parent = parentNode;
            }
        }
    }

    public BTNode FindNode(int value)
    {
        return FindNode(Root, value);
    }

    public BTNode FindNode(BTNode parent, int value)
    {
        BTNode node = null;
        if (parent != null)
        {
            if (parent.Value == value)
                node = parent;
            else
            {
                if (parent.Value < value)
                    node = FindNode(parent.Right, value);
                else
                    node = FindNode(parent.Left, value);
            }
        }
        return node;
    }
} 
```

# javascript - 通过单选按钮启用\禁用元素

> ID：11632126
> 
> 赞同：0
> 
> 时间：2012-07-24T13:40:15.980
> 
> 标签：javascript, jquery, html, radio-button

假设，我有一些内容，我想根据单选按钮填写，例如，如果我单击一个`radiobutton`，3 `textarea`s（或`input`s）变为活动状态，我可以填写它们和 textarea，它“属于”其他单选按钮，变为非活动状态，我无法填写，反之亦然。

```
<form>
    <input type="radio" name="group1" value="1"> val1<br> 

    <input type="radio" name="group1" value="2" checked> val2<br>

    <input type="text" value="123123" id="id1">
    <input type="text" value="123123" id="id2">
    <input type="text" value="123123" id="id3">
    <input type="text" value="123123" id="id4">
</form> 
```

问题是，如何使用活动 val1 单选按钮启用输入 id1、id2、id3 并使用 val2 启用 id4 并禁用 id1、id2、id3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:54:46.303

试试这个 - [http://jsfiddle.net/h7ZYY/](http://jsfiddle.net/h7ZYY/)

```
$("input:text").prop("disabled", true);
$("input:radio").on("click", function() {
    $("input:text").prop("disabled", true);
    $("input.group" + $(this).val()).prop("disabled", false);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T13:56:25.647

试试这个：

```
$('input[name=group1]').change(function(){
    if (this.value == 1) {
       $('#id1, #id2, #id3').prop('disabled', false)
       $('#id4').prop('disabled', true)
    } else {
       $('#id1, #id2, #id3').prop('disabled', true)
       $('#id4').prop('disabled', false)
    }
}) 
```

[演示](http://jsfiddle.net/JAyAL/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T13:52:03.660

您可以通过以下方式禁用所有输入`<input type="text" value="123123" id="id1" disabled="disabled">`

然后，使用 Javascript，您可以执行以下操作：

```
<script>
function disable(input)
{
if (input == "2")
{
document.getElementById('id1').disabled = true;
document.getElementById('id2').disabled = true;
document.getElementById('id3').disabled = true;
document.getElementById('id4').disabled = false;
}
else
{
document.getElementById('id1').disabled = false;
document.getElementById('id2').disabled = false;
document.getElementById('id3').disabled = false;
document.getElementById('id4').disabled = true;
}
}
</script>

<form>
    <input type="radio" name="group1" value="1" onclick='disable('1');'> val1<br> 

    <input type="radio" name="group1" value="2" onclick='disable('2')'> val2<br>

    <input type="text" value="123123" id="id1" disabled="disabled">
    <input type="text" value="123123" id="id2" disabled="disabled">
    <input type="text" value="123123" id="id3" disabled="disabled">
    <input type="text" value="123123" id="id4" disabled="disabled">
</form> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T13:54:39.597

要禁用文本框，您可以写下来，

```
 document.getElementById(textBoxID).disabled = True/False 
```

显然你需要 onclick 事件，

```
<input type="radio" name="group1" value="1" onclick ="EnableDisable(this);">
function EnableDisable(e) {
      $('text1').attr("disabled", !e.checked);
  } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-24T13:54:54.967

我会将 textareas/inputs 分组属于 div 下的特定单选按钮，这样我就可以轻松选择它，并为 div 提供一个可以与单选按钮相关的 id（这里我的 Div id 格式为`"area-"+ radioButtonValue`

```
<input type="radio" name="group1" value="1"> val1<br>
<input type="radio" name="group1" value="2"> val2<br>

<div  id="area-1" class="area">
    <input type="text" value="123123" id="id1">
    <input type="text" value="123123" id="id2">
    <input type="text" value="123123" id="id3">
</div>
<div id="area-2"  class="area">    
    <p>Selcond</p>
    <input type="text" value="123123" id="id4">
</div> 
```

脚本是

```
$(function(){
   $("div.area").hide();
    $("input[type=radio]").click(function(){        
      var val=$(this).val();
      $(".area").hide();    
      $("#area-"+val).show();        
    });      
}); 
```

只要您遵循命名约定将单选按钮与其区域相关联，这将适用于 n 个单选按钮及其区域（包含文本区域/输入/其他元素）。

工作样本：http: [//jsfiddle.net/zSeYW/](http://jsfiddle.net/zSeYW/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-24T13:47:00.283

您可以在活动中完成您想要的一切：

```
onChange="myJQueryFunction()" 
```

在您的输入收音机上

之后你只需要：

```
$('id').attr('disabled','disabled'); 
```

或者：

```
$('id').removeAttr('disabled'); 
```

在你的 jquery 代码上

# java - 从scala代码中使用java中定义的递归泛型类型

> ID：11632127
> 
> 赞同：3
> 
> 时间：2012-07-24T13:40:16.410
> 
> 标签：java, scala

我在java代码中有以下定义：

抽象端口定义（由具体端口类键入）：

```
package test;

public class Port<
     PortOptions extends Port.Options, 
     ConcretePort extends Port<PortOptions, ConcretePort>> {

    public interface Options {
    }

} 
```

端口服务定义（可以通过一些回调机制对端口做一些事情）

```
package test;

import java.util.Set;

public class PortService {
    public interface Callback<T> {
        void processData(T data);
    }

    public void methodWithCallback(Callback<Set<Port>> callback) {

    }
} 
```

我想从scala注册一个回调到端口服务。我尝试的是这样的：

```
package test

import test.PortService.Callback
import java.util

class PortServiceCaller {

    def callingMethod() {
        val portService: PortService = new PortService

        portService.methodWithCallback(new Callback[java.util.Set[Port[_, _]]] {
            def processData(data: util.Set[Port[_, _]]) {

            }
        })
    }
} 
```

它惨遭失败：

```
error: type mismatch;
found   : java.lang.Object with test.PortService.Callback[java.util.Set[test.Port[_, _]]]
required: test.PortService.Callback[java.util.Set[test.Port[_ <: test.Port.Options, _ <: test.Port[?0,?1]]]]
portService.methodWithCallback(new Callback[java.util.Set[Port[_, _]]] { 
```

问题是：如何编写scala代码才能让我正确调用java服务？

我查看了 scala 打字系统，但我似乎无法弄清楚。

**后期编辑：**

解决方案其实很简单：

将回调方法声明为：

```
 public void methodWithCallback(Callback<Set<Port<?, ?>>> callback) {

    } 
```

并像这样从scala调用它：

```
 portService.methodWithCallback(new Callback[java.util.Set[Port[_, _]]] {
        def processData(data: java.util.Set[Port[_, _]]) {
        }
    }) 
```

考虑到两种语言的类型系统，这也是有道理的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T13:51:23.963

您在 Java 中所做的事情是危险的，您的代码编译只是因为 Java 编译器是惰性的并且不会检查它。当你写：

```
 public void methodWithCallback(Callback<Set<Port>> callback) {

    } 
```

您基本上丢弃了有关端口的所有类型信息：

```
Port<PortOptions extends Port.Options, ConcretePort extends Port<PortOptions, ConcretePort>> 
```

整个信息将不可用，Java 编译器允许您省略类型参数。在 scala 中这是不可能的，不仅你必须正确表达类型参数，而且还要正确表达类型约束。这里的第一个问题是为什么你写 Port 却没有说那里有一些未知的类型。

```
public void methodWithCallback(Callback<Set<Port<?,?>>> callback) {

} 
```

将是正确的写作方式。

如果现在要表达多个未知类型之间的界限关系，不能使用紧凑的 _ 表示适用于简单界限的存在类型，而必须使用 forSome

```
 class Port[A,B<:A]

  def myMethod(a:Port[A,B]forSome {type B; type B<:A}) 
```

但是，正如我倾向于说的那样，最终使用这些模式会使您的设计很弱，并且您可能有一种更清洁、更优雅的方式来解决您的问题。如果您需要丢弃有关类型安全的信息，那么使用泛型有什么意义呢？

# spring - 用于存储会话数据的加密 cookie

> ID：11632129
> 
> 赞同：2
> 
> 时间：2012-07-24T13:40:17.563
> 
> 标签：spring, spring-mvc, spring-security

我正在学习 Spring MVC，但无法理解会话数据的存储位置和方式。

我想要实现的是将会话数据存储在发送到浏览器的加密 cookie 中。这是必要的，因为我计划在没有粘性会话的 heroku 上运行应用程序。（这是我已经在 python 中使用的解决方案，通过使用金字塔和烧杯，我对此非常满意）

我有这个玩具控制器

```
public class HelloController implements Controller {

    protected final Log logger = LogFactory.getLog(getClass());

    public ModelAndView handleRequest(HttpServletRequest request,
                                      HttpServletResponse response)
            throws ServletException, IOException {

        logger.info("Returning hello view");

        Map<String, Object> myModel = new HashMap<String, Object>();
        myModel.put("key", "value");

        return new ModelAndView("hello", "model", myModel);
    }
} 
```

如果我打电话会发生什么

```
 HttpSession session = request.getSession(); 
```

在handleRequest 方法中？我认为如果会话不存在，则会启动会话，否则将返回现有会话。但是这个会话存储在哪里？在带有 cookie 的浏览器中？或者别的地方？

如何指定必须将会话放入 cookie 并设置必须用于加密它的密钥？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:22:06.557

我认为您不能直接告诉 spring/web 应用程序将会话数据存储到 cookie。

您需要执行以下操作才能满足您的要求

1.  为要存储的每个数据创建每个 cookie，然后将 cookie 添加到响应

    ```
    Cookie c = new Cookie("sessionid", sessionid);
    res.addCookie(c); 
    ```

2.  并从请求中读取 cookie 数据

    ```
    Cookie[] cookies = req.getCookies(); 
    ```

在这种情况下，您也可以完全控制加密。

自动化这个过程意味着将会话数据同步到 cookie，您将能够编写方面处理程序。

# asp.net - 页面方法未执行

> ID：11632133
> 
> 赞同：1
> 
> 时间：2012-07-24T13:40:38.617
> 
> 标签：asp.net, sharepoint, scriptmanager

我正在尝试改进 SharePoint 2010 网站，但在调用 PageMethod 时遇到了困难。这是我试图执行的脚本：

```
<script type="text/javascript">
    function BindingTitle() {
        alert("number one");
        PageMethods.BindTitle(OnSucceeded, OnFailed);
        alert("number two");
    }

    function OnSucceeded(result, userContext, methodName) {
        alert("it worked!");
    }
    function OnFailed(error, userContext, methodName) {
        alert("it didn't work!");
        alert(error);
    }

</script> 
```

绑定到脚本的控件在一个表中，但为了简洁起见，它看起来像这样：

```
<table>
  <thead>
    <tr>
      <th onclick="BindingTitle()"> alsdjlfajlskdjfla</th> //this is the control
    </tr>
  </thead>
</table> 
```

放在后面代码中的 web 方法如下所示：

```
 [WebMethod()]
    public static void BindTitle()
    {
        Console.WriteLine("things are happening");
    } 
```

脚本中的行“PageMethods.BindTitle(OnSucceeded, OnFailed) 未执行。单击控件时，显示“第一”的警报，但“第二”从未显示（当页面方法被注释掉时，确实如此）。我能想到的唯一可能是脚本管理器的原因。它在此包的母版页中声明，这是我不想更改的内容。但是使用了脚本管理器对于很多不同的事情，我对网络开发的复杂性还不够熟悉，无法知道这对我的页面有何影响。脚本管理器的定义如下所示：

```
 <asp:ScriptManager id="ScriptManager" runat="server" EnablePageMethods="true" EnablePartialRendering="true" EnableScriptGlobalization="false" EnableScriptLocalization="true" /> 
```

有没有一种方法可以在我的页面上禁用这个脚本管理器，这样我就可以声明自己的更简单的了？还应该注意的是，这是一个相当大的站点，其中有几个页面依赖于先前声明的脚本管理器。这些网站的大部分代码都非常混乱，并且是由不再为这家公司工作的人编写的。我这样说只是为了澄清一些会影响其他页面的更改在我有空的情况下是不可行的，因为在这样的更改之后需要进行大量的测试和调试。

如果我遗漏了什么，请告诉我！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:17:11.813

我试过你的代码，它运行良好。但是，当我将`ScriptManagers` `EnablePageMethods`属性更改为 时`false`，它开始按照您描述的方式运行，即它执行第一个警报并停在那里。确保该属性未在代码中的任何位置设置为 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-18T12:59:57.660

上周我遇到了这个问题，我在论坛上找到的东西都没有解决这个问题。我已经设置了一个新的 Web 应用程序（来自 VS 模板），然后将几个页面复制到项目中。有几个页面使用了 PageMethods。这些页面都在旧项目中工作。但是，调用 PageMethods 的 jscript 代码在新项目中不起作用。jscript 被击中，但它的行为就像 PageMethod 没有被击中一样。我在 PageMethod 代码中设置了断点，它从未被命中。（我在旧项目中验证了断点确实命中。）返回也达到了“成功”的 jscript 方法，但没有返回任何其他内容。

我最终发现新模板在 Global.asax.cs 文件中有几个我不认识的调用。

```
 // Code that runs on application startup
        //RouteConfig.RegisterRoutes(RouteTable.Routes);
        //BundleConfig.RegisterBundles(BundleTable.Bundles); 
```

注释掉 RouteConfig 和 BundleConfig 调用允许 PageMethod 调用正常工作。我不确定这两个电话做了什么，但我现在正在工作。

只是想分享这个，以防其他人遇到问题。

# c# - 消除根节点和第一个子节点后，从 xml 读取并绑定到树视图

> ID：11632138
> 
> 赞同：0
> 
> 时间：2012-07-24T13:41:03.110
> 
> 标签：c#, xml, winforms

我有一个结构的 xml 文件

```
<MainList>
<number>5<number/>
<first id="1" name="test" />
<second/>
<third/>
<MainList/> 
```

现在我想通过消除“MainList”和“number”在树视图中显示它

我希望树以格式显示

```
first
  id
  name
second
third 
```

我现在正在使用 xmlreader

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T10:17:45.693

根据@AS-CII 此处提供的答案（[将分层 xml 绑定到树视图](https://stackoverflow.com/q/5437713/314334)），您可以修改那里发布的代码以满足您的需求。

1.  跳过根元素和第一个子元素
2.  `TreeNode`直接在`Nodes`-collection中添加一级-s `TreeView`（因为没有根元素）
3.  `TreeNode`为`Attribute`以及为创建`Element`

例如：

```
private void Form1_Load ( object sender, EventArgs e )
{
    string xml = "<MainList><number>5</number><first id=\"1\" name=\"test\" /><second/><third/></MainList>";
    XDocument doc = XDocument.Parse ( xml );
    var elements = doc.Root // "MainList"
        .Elements () // Elements inside "MainList"
        .Skip ( 1 ); // Skip first item ("number")
    // Add a TreeNode for each element on first level (inside MainList)
    foreach ( var item in elements )
    {
        // Create first-level-node
        TreeNode node = new TreeNode ( item.Name.LocalName );
        // Create subtree, if necessary
        TreeNode[] nodes = this.GetNodes ( node, item ).ToArray ();
        // Add node with subtree to TreeView
        treeView1.Nodes.AddRange ( nodes );
    }
} 
```

上面的代码使用以下方法从 XML 文档的元素和属性创建 TreeNode：

```
private IEnumerable<TreeNode> GetNodes ( TreeNode node, XElement element )
{
    List<TreeNode> result = new List<TreeNode> ();
    // First, create TreeNodes for attributes of current element and add them to the result
    if ( element.HasAttributes )
        result.AddRange ( node.AddRange (
            from item in element.Attributes ()
            select new TreeNode ( "[A] " + item.Name.LocalName ) ) );
    // Next, create subtree and add it to the result
    if ( element.HasElements )
        result.AddRange ( node.AddRange ( 
            from item in element.Elements ()
            let tree = new TreeNode ( item.Name.LocalName )
            from newNode in GetNodes ( tree, item )
            select newNode ) );
    // If there aren't any attributes or subelements, return the node that was originally passed in
    if ( result.Count == 0 )
        result.Add ( node );
    // Return the result 
    return result;
} 
```

此外，您需要此扩展方法：

```
public static class TreeNodeEx
{
    public static IEnumerable<TreeNode> AddRange ( this TreeNode collection, IEnumerable<TreeNode> nodes )
    {
        collection.Nodes.AddRange ( nodes.ToArray () );
        return new[] { collection };
    }
} 
```

# qt - 在 Qt 中将一个信号的数据传递到多个插槽是否安全？

> ID：11632139
> 
> 赞同：5
> 
> 时间：2012-07-24T13:41:05.377
> 
> 标签：qt

我的 Qt 应用程序不断地从服务器端接收数据包，并根据数据构造对象。我必须将这些对象（一次一个）传递给三个不同的小部件。所以，我已经将一个信号连接到所有三个小部件的插槽，但我怀疑传递这样的对象是否安全？假设数据包以很快的速度到达，这些会被新的数据包覆盖吗？对象是否会因此而损坏，或者我在处理旧数据包时是否会丢失一些数据包或数据。

是否有机制确保不会发生溢出。另外，如果数据包的速度非常快，会不会有一些节流。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T14:34:20.290

将单个信号连接到多个插槽是 Qt 的设计特征。

所有（几乎？）Qt[值类都是引用计数](http://qt-project.org/doc/qt-4.8/implicit-sharing.html#implicit-data-sharing)的，因此可以安全地随意传递它们。它们大多也是“写时复制”，因此您可以在任何您想要的地方自由地复制它们，而不会造成真正的性能损失。

与任何其他多线程代码一样，如果多个线程同时写入同一个对象，则需要小心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T14:55:53.963

Qt 的信号和槽在程序的事件循环中处理。当发出信号时，对任何连接的插槽的调用都会排队，并将在事件循环的滴答声中处理。发射信号的开销非常低；根据 Qt 的文档，当连接到单个插槽时，您每秒可以发出大约 2,000,000 个信号，当连接到 i586-500 上的 2 个插槽时，您可以每秒发出 1,200,000 个信号。与发出信号所花费的时间相比，处理传入数据可能占程序响应时间的大部分。只要您的数据对象构造能够跟上来自网络的信息的速率，您就可以毫无问题地发出信号。信号将被添加到接收对象的队列中，以便通过事件循环的下一次处理，

如果您担心多个接收器修改数据包数据，只要您通过将数据对象按值传递给信号而不是引用或指针来发出传入网络数据的唯一副本，您就可以连接到多个插槽，而不必担心您的插槽会修改数据。

我已经使用信号和槽机制来处理传入的网络数据，这对一个小组学校项目有很大的影响。它使用 UDP 协议与客户端通信，以实现让人想起小行星的多人射击游戏。我使用信号和槽在服务器的各个类周围传递数据包数据没有遇到任何问题。我遇到的大部分问题都是由于游戏网络代码的算法简单性造成的。（每个数据包都会更新所有内容，没有客户端延迟补偿等）如果您有兴趣，可以在这里查看代码：http: [//foxx.arksaw.com/svn/tis/](http://foxx.arksaw.com/svn/tis/)感兴趣的是“netlib” “服务器”和“客户端”目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T14:18:49.473

我不确定其中的网络编程部分，但就信号和插槽而言，您应该能够根据需要将一个信号连接到尽可能多的插槽。

# c - C中scanf中的扫描集行为

> ID：11632143
> 
> 赞同：6
> 
> 时间：2012-07-24T13:41:17.527
> 
> 标签：c, scanf

我试图在 scanf 中使用 scanset 做一些事情，但卡在了某个地方。

当我写

```
char s1[250];
scanf("%[A-Z]",s1);

input : AHJHkiuy
Output: AHJH 
```

有了这个，

```
scanf("%[^\n]",s1);

input: abcd ABCD hie
output: abcd ABCD hie       /*that is reading white space also (till \n) */ 
```

现在我的问题是，如果我输入如下：

```
ABCDahaj ahajABCD ajak12347ab 
```

并希望输出为：

```
ABCDahaj ahajABCD ajak 
```

那么格式字符串应该怎么写呢？也就是说，应该如何使用这个扫描集？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T13:50:03.647

您可以稍微扩展您的示例并实现您的目标。

```
scanf("%[A-Za-z ]", s1); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-31T13:48:11.913

另一种方法是：

```
scanf("%[^0-9]", s1); /* Scans everything until a digit */ 
```

# java - org.apache.openjpa.persistence.ArgumentException：解析查询过滤器时出错

> ID：11632150
> 
> 赞同：-1
> 
> 时间：2012-07-24T13:41:35.937
> 
> 标签：java, persistence, openjpa

```
I am getting this Exception in Open JPA.

<openjpa-1.2.3-SNAPSHOT-r422266:1295280 nonfatal user error> org.apache.openjpa.persistence.ArgumentException: An error occurred while parsing the query filter "select a from Test a where a.something='D10584707'". Error message: The name "Test" is not a recogniz entity or identifier. Known entity names: []
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.exps.AbstractExpressionBuilder.parseException(AbstractExpressionBuilder.java:118)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getClassMetaData(JPQLExpressionBuilder.java:180)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.resolveClassMetaData(JPQLExpressionBuilder.java:150)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getCandidateMetaData(JPQLExpressionBuilder.java:225)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getCandidateMetaData(JPQLExpressionBuilder.java:195)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getCandidateType(JPQLExpressionBuilder.java:188)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.access$600(JPQLExpressionBuilder.java:69)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder$ParsedJPQL.populate(JPQLExpressionBuilder.java:1756)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.jpql.JPQLParser.populate(JPQLParser.java:56)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.ExpressionStoreQuery.populateFromCompilation(ExpressionStoreQuery.java:156)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.QueryImpl.newCompilation(QueryImpl.java:658)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.QueryImpl.compilationFromCache(QueryImpl.java:639)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.QueryImpl.compileForCompilation(QueryImpl.java:605)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.QueryImpl.compileForExecutor(QueryImpl.java:667)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.QueryImpl.getOperation(QueryImpl.java:1492)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.kernel.DelegatingQuery.getOperation(DelegatingQuery.java:123)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.persistence.QueryImpl.execute(QueryImpl.java:243)
[7/24/12 8:32:06:228 EDT] 00000015 SystemErr     R  at org.apache.openjpa.persistence.QueryImpl.getResultList(QueryImpl.java:294) 
```

这是我的持久性 XML

```
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
        http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd"
    version="1.0">
    <persistence-unit name="MyDataSource">
        <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider>
        <jta-data-source>jdbc/MyDatasource</jta-data-source>
        <class>com.vo.Test</class>      
    </persistence-unit> 
```

我已将我的应用程序变形为 Web App Archive 并且它正在工作。但是，如果我扭曲与 EJB3 相同的应用程序，那就是我遇到问题的地方。

我在 WAS 7.0 上运行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T14:22:19.627

我得到了我的问题的解决方案

我的 Persistence.xml 中缺少 RuntimeUnenhancedClasses 属性

现在我的持久性 XML 看起来像这样

```
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
    http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd"
version="1.0">
<persistence-unit name="MyDataSource">
    <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider>
    <jta-data-source>jdbc/MyDatasource</jta-data-source>
    <class>com.vo.Test</class>      
    <properties>
    <property name="RuntimeUnenhancedClasses" value="supported"/>
    <property name="openjpa.Log" value="DefaultLevel=WARN, Runtime=INFO, Tool=INFO, SQL=TRACE" />
    </properties>
</persistence-unit> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T14:56:38.493

我有同样的问题，并通过更正 jpql 来解决问题。

曾是：`SELECT c FROM NIMBUSOrganizationUnitEntityObject c WHERE **uuid** = :uuid`

到： `SELECT c FROM NIMBUSOrganizationUnitEntityObject c WHERE ***c.uuid*** = :uuid`

# python - 将两个字典中的值组合成一个列表

> ID：11632154
> 
> 赞同：3
> 
> 时间：2012-07-24T13:41:43.127
> 
> 标签：python, list, dictionary

在 python 中，如果我有两个字典，特别是看起来像这样的 Counter 对象

```
c1 = Counter({'item1': 4, 'item2':2, 'item3': 5, 'item4': 3})
c2 = Counter({'item1': 6, 'item2':2, 'item3': 1, 'item5': 9}) 
```

我可以组合这些字典，以便结果是一个列表字典，如下所示：

```
c3 = {'item1': [4,6], 'item2':[2,2], 'item3': [5,1], 'item4': [3], 'item5': [9]} 
```

其中每个值是来自适当键的前面字典的所有值的列表，并且在两个原始字典之间没有匹配键的情况下，添加一个包含一个元素列表的新 kew。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T13:42:53.147

```
from collections import Counter
c1 = Counter({'item1': 4, 'item2':2, 'item3': 5, 'item4': 3})
c2 = Counter({'item1': 6, 'item2':2, 'item3': 1, 'item5': 9})
c3 = {}
for c in (c1, c2):
    for k,v in c.iteritems():
        c3.setdefault(k, []).append(v) 
```

`c3`就是现在：`{'item1': [4, 6], 'item2': [2, 2], 'item3': [5, 1], 'item4': [3], 'item5': [9]}`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T14:23:05.903

或者使用列表理解：

```
from collections import Counter
c1 = Counter({'item1': 4, 'item2':2, 'item3': 5, 'item4': 3})
c2 = Counter({'item1': 6, 'item2':2, 'item3': 1, 'item5': 9})
merged = {}
for k in set().union(c1, c2):
    merged[k] = [d[k] for d in [c1, c2] if k in d]

>>> merged
{'item2': [2, 2], 'item3': [5, 1], 'item1': [4, 6], 'item4': [3], 'item5': [9]} 
```

## 解释

1.  将所有存在的键放入匿名集中。（这是一个集合 => 没有重复的键）
2.  对于每个键，执行 3。
3.  对于字典列表中的每个字典 d`[c1, c2]`
    *   检查当前正在处理的key是否`k`存在
        *   `d[k]`如果为真：在结果列表中包含表达式
        *   如果不是：继续下一次迭代

[这里](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)有很多例子对列表理解的详细介绍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T15:31:27.993

您可以使用`defaultdict`：

```
>>> from collections import Counter, defaultdict
>>> c1 = Counter({'item1': 4, 'item2':2, 'item3': 5, 'item4': 3})
>>> c2 = Counter({'item1': 6, 'item2':2, 'item3': 1, 'item5': 9})
>>> c3 = defaultdict(list)
>>> for c in c1, c2:
...     for k, v in c.items():
...         c3[k].append(v)
... 
>>> c3
defaultdict(<type 'list'>, {'item2': [2, 2], 'item3': [5, 1], 'item1': [4, 6],
'item4': [3], 'item5': [9]}) 
```

# c# - 可为空的日期时间值

> ID：11632164
> 
> 赞同：3
> 
> 时间：2012-07-24T13:42:01.087
> 
> 标签：c#

`DateTime`值可以吗`NULL`？

我有这个代码：

从这里我继承我的变量

```
namespace Transakcija
{
     public class Line
     {
        public System.DateTime DateOfProduction { get; set; }
     }
} 
```

然后对于每个循环：

```
foreach (var rw_det in dt_stavke.Rows)
{
    var list = new List<Transakcija.Line>();
    var l = new Transakcija.Line();

     //DateOfProduction
    if (rw_det["DPRO02"].ToString().Length <= 0)
    {
        l.DateOfProduction = default(DateTime);
    }
    else
    {
        l.DateOfProduction = new DateTime();
        prod_date = rw_det["DPRO02"].ToString();
        DateTime pro_date = DateTime.ParseExact(prod_date, "dd.MM.yyyy", CultureInfo.InvariantCulture);
        string p_date = pro_date.ToString("yyyy-MM-dd");
        l.DateOfProduction = DateTime.Parse(p_date);
    }
} 
```

所以该值`l.DateOfProduction`需要为空。我试过这个：

```
DateTime? dt = null;
l.DateOfProduction = (DateTime)dt; 
```

但我得到了错误：`nullable object must have a value`

那么这是可能的还是我必须将最小值传递`datetime`给变量？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T13:42:47.307

`DateTime`是一个值类型，所以不，它永远不会是`null`. 如果您需要“无价值”值，请使用`Nullable<DateTime>`or 简称`DateTime?`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-24T13:45:32.180

`DateTime` 您可以使用[构造函数](http://msdn.microsoft.com/en-us/library/kwxxazwb)分配可空值：

```
DateTime? dt = new Nullable<DateTime>(); 
```

`null`您可以使用以下[`HasValue`](http://msdn.microsoft.com/en-us/library/sksw8094%28v=vs.100%29.aspx)属性检查可空类型是否为：

```
if(dt.HasValue)
{
    // now you can safely use dt.Value as DateTime, 
    // otherwise accessing the Value property raises an InvalidOperationException
    DateTime otherDate = dt.Value;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T13:49:15.873

您可以通过这种方式让 DateTime Nullable

```
DateTime? dtNullable = new Nullable<DateTime>(); 

if(dtNullable.HasValue)
 l.DateOfProduction = dtNullable.Value; 
```

PS：例如，如果您将不可为空的日期时间传递给可空的日期时间，则需要强制转换

像这样

```
DateTime? nullableDateTime = (DateTime?)nonNullableDateTime; 
```

# android - 什么是 data/data/package.name/lib 文件夹

> ID：11632166
> 
> 赞同：0
> 
> 时间：2012-07-24T13:42:17.513
> 
> 标签：android

与*缓存、shared_prefs*和*数据库*等其他应用程序文件夹不同，它们仅在第一次需要时创建，*lib*始终存在，但到目前为止始终为空。这个文件夹是干什么用的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:45:06.153

项目的`lib/`目录`/data/data/your.package.here/`将保存`.so`任何 NDK 提供的库的特定于体系结构的文件。通过“特定于架构”，我的意思是，如果您运行的是 ARM CPU，它将拥有一个 ARM `.so`；如果您正在运行 x86 CPU，它将容纳 x86`.so`等。

可能还有其他东西会进入`lib/`。我的脑后部有轻微的痒，暗示有，但我不记得是什么，痒可能只是被虫子咬了。:-)

# php - 在php中拆分多维数组

> ID：11632168
> 
> 赞同：0
> 
> 时间：2012-07-24T13:42:25.327
> 
> 标签：php, arrays, multidimensional-array

我有一个来自我的数据库的数据数组，它看起来像这样

```
[0] => Array
    (
        [id] => 40
        [market] => EUR/USD
        [date] => 2012-02-29 12:20:34
        [points] => 42
    )

[1] => Array
    (
        [id] => 41
        [market] => EUR/USD
        [date] => 2012-02-29 13:23:03
        [points] => 11
    ) 
```

它一直这样持续到数据库查询结束，大约有 200 条记录。数据库有整月的信息，同一天有多条记录。

无论如何，我希望能够通过数组并取出一天的所有信息（通过为什么来自数据库的信息已经排序 DESC）。

我该怎么做？我已经查看了“array_splice”和“array_file”，但我正在努力将它们放入这个问题中。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:46:00.433

你可以做类似的事情

```
$output = array();
foreach ($input as $row) {
    $date = substr($row['date'], 0, 10);
    if(!isset($output[$date])) {
        $output[$date] = array();
    }
    $output[$date][] = $row;
}
print_r($output); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T13:47:16.093

像这样的东西？

```
$by_day = array();

foreach ($rows as $row) {
    $by_day[date('Y-m-d', strtotime($row['date']))][] = $row;
} 
```

# c++ - 即使没有焦点也想接收事件

> ID：11632171
> 
> 赞同：0
> 
> 时间：2012-07-24T13:42:31.237
> 
> 标签：c++, qt, qt-creator

我在 QGraphicView 中有一个 QGraphicsScene。即使我没有按下屏幕，我也希望它接收我的键盘事件。因为如果我按住键单击屏幕上的任意位置，我需要执行另一个操作，但现在我需要先单击，所以即使我没有关注 QGraphicsScene，我也需要捕获事件。我试图将事件放在 MainWindow 上，但它不起作用。

我得到这样的事件：

```
void AreaScene::keyPressEvent(QKeyEvent *event){
    if(event->key()==Qt::Key_Control){
        MapData::controlPress=true;
    }
}
void AreaScene::keyReleaseEvent(QKeyEvent *event){
    if(event->key()==Qt::Key_Control){
            MapData::controlPress=false;
            this->renderArea=false;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T09:43:16.347

在 QGraphicView 子类的构造函数中：

```
`installEventFilter(this)` 
```

并在课堂上实现这个功能：

```
bool eventFilter(QObject*, QEvent* e); 
```

在这个函数中，你应该编写类似的代码

```
switch(e->type())
{
...
case QEvent::NonClientAreaMouseButtonPress:
{
...
}
case QEvent::NonClientAreaMouseButtonRelease:
{
...
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:07:17.200

解决了。

我在 MainWindow 上实现了它注意：如果实现了事件方法，则窗口不会调用此方法。

# java - Android布局文件夹配置

> ID：11632173
> 
> 赞同：3
> 
> 时间：2012-07-24T13:42:31.587
> 
> 标签：java, android

我目前有 2 个布局文件夹：layout-sw480dp 和 layout-sw720dp，都包含 main.xml

我看到开发指南指出以下内容：

```
 - 320dp: a typical phone screen (240x320 ldpi, 320x480 mdpi, 480x800
   hdpi, etc).
 - 480dp: a tweener tablet like the Streak (480x800 mdpi).
 - 600dp: a 7” tablet (600x1024 mdpi).
 - 720dp: a 10” tablet (720x1280 mdpi, 800x1280 mdpi, etc). 
```

我正在使用我的 Nexus 7 进行开发（模拟器有点糟糕/慢），当我将我的应用程序上传到我的平板电脑时，我可以告诉它使用 layout-sw480dp，但为什么呢？好吧，它不是 10 英寸平板电脑，但 Nexus 7 确实有 800x1280 分辨率，我想这无关紧要？我只是有点困惑要拥有哪个 swdp。

根据 GSMArena：[http ://www.gsmarena.com/asus_google_nexus_7-4850.php](http://www.gsmarena.com/asus_google_nexus_7-4850.php)

```
 - 800 x 1280 pixels, 7.0 inches (~216 ppi pixel density) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T13:49:31.920

它`sw600dp`是最小宽度 600 dp 单位而不是像素，因此您的代码行为正确。屏幕为 600 x 961 dp 单位。

有关详细说明，请参阅此帖子 - [https://plus.google.com/105051985738280261832/posts/6eWwQvFGLV8](https://plus.google.com/105051985738280261832/posts/6eWwQvFGLV8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T16:48:28.973

为了更进一步，我在我的 Nexus 7 和 600x1024mdpi 模拟器上进行了测试，发现两者会相差很大。

解决此问题的快速方法是创建布局文件夹：

**布局-sw600dp-土地-tvdpi**

**布局-sw600dp-端口-tvdpi**

由于 tvdpi 密度很少，这已经过测试和验证，特别适用于 Nexus 7。

所以布局文件夹：

**布局-sw600dp-土地**

**布局-sw600dp-端口**

然后将用于具有 mdpi 密度的设备。有更多的设备属于第二类，所以你真的不应该依赖使用没有 tvdpi 的命名约定来支持 Nexus 7。

这显然可以适用于 Galaxy Note 和其他 hdpi 等设备。

# android - 如何在android中获取带有（.shp扩展名）的Shape File的记录数

> ID：11632181
> 
> 赞同：0
> 
> 时间：2012-07-24T13:42:47.610
> 
> 标签：android, shapefile

我正在尝试获取形状文件中的记录数。该文件是多边形形状文件。我能够获取第一条记录的详细信息，但是当计数增加到 2 时，会引发 IllegalState 异常并将记录计数设为 0。

我的 Android Activity 类是

```
package com.example.android.skeletonapp;

import java.io.BufferedInputStream;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.zip.ZipEntry;
import java.util.zip.ZipInputStream;

import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.os.Environment;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;

public class SkeletonActivity extends Activity {

    static final private int BACK_ID = Menu.FIRST;
    static final private int CLEAR_ID = Menu.FIRST + 1;

    private EditText mEditor;
    public SkeletonActivity(){}

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        int recordCount = 0;
        // Inflate our UI from its XML layout description.
        setContentView(R.layout.skeleton_activity);

        // Find the text editor view inside the layout, because we
        // want to do various programmatic things with it.
        mEditor = (EditText) findViewById(R.id.editor);

        // Hook up button presses to the appropriate event handler.
        ((Button) findViewById(R.id.back)).setOnClickListener(mBackListener);
        ((Button) findViewById(R.id.clear)).setOnClickListener(mClearListener);

        mEditor.setText(getText(R.string.main_label));
        try {

             String shpFile = Environment.getDataDirectory().getAbsolutePath().toString()+"/ne_50m_urban_areas.shp";
            ShapeReader shR = new ShapeReader(shpFile, true);
                recordCount = shR.getCount(0);

        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        mEditor.setText("Record Count == " + recordCount);
    }

    @Override
    protected void onResume() {
        super.onResume();
    }

    /**
     * Called when your activity's options menu needs to be created.
     */
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        super.onCreateOptionsMenu(menu);

        // We are going to create two menus. Note that we assign them
        // unique integer IDs, labels from our string resources, and
        // given them shortcuts.
        menu.add(0, BACK_ID, 0, R.string.back).setShortcut('0', 'b');
        menu.add(0, CLEAR_ID, 0, R.string.clear).setShortcut('1', 'c');

        return true;
    }

    /**
     * Called right before your activity's option menu is displayed.
     */
    @Override
    public boolean onPrepareOptionsMenu(Menu menu) {
        super.onPrepareOptionsMenu(menu);

        // Before showing the menu, we need to decide whether the clear
        // item is enabled depending on whether there is text to clear.
        menu.findItem(CLEAR_ID).setVisible(mEditor.getText().length() > 0);

        return true;
    }

    /**
     * Called when a menu item is selected.
     */
    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case BACK_ID:
            finish();
            return true;
        case CLEAR_ID:
            mEditor.setText("");
            return true;
        }

        return super.onOptionsItemSelected(item);
    }

    /**
     * A call-back for when the user presses the back button.
     */
    OnClickListener mBackListener = new OnClickListener() {
        public void onClick(View v) {
            finish();
        }
    };

    /**
     * A call-back for when the user presses the clear button.
     */
    OnClickListener mClearListener = new OnClickListener() {
        public void onClick(View v) {
            mEditor.setText("");
        }
    };
} 
```

ShapeFileReader 类是

```
package com.example.android.skeletonapp;

import java.io.EOFException;
import java.io.FileInputStream;
import java.io.IOException;
import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import java.nio.channels.FileChannel;
import java.nio.channels.ReadableByteChannel;
import java.util.logging.Level;
import java.util.logging.Logger;

public class ShapeReader  {
    private static final int UNKNOWN = Integer.MIN_VALUE;

    public final class Record {
        int length;

        public int number = 0;

        int offset; // Relative to the whole file

        int start = 0; // Relative to the current loaded buffer

        /** The minimum X value. */
        public double minX;

        /** The minimum Y value. */
        public double minY;

        /** The maximum X value. */
        public double maxX;

        /** The maximum Y value. */
        public double maxY;

        public ShapeType type;

        int end = 0; // Relative to the whole file

        Object shape = null;

        /** Fetch the shape stored in this record. */
        public Object shape() {
            if (shape == null) {
                buffer.position(start);
                buffer.order(ByteOrder.LITTLE_ENDIAN);
                if (type == ShapeType.NULL) {
                    shape = null;
                } else {
                    shape = handler.read(buffer, type, flatGeometry);
                }
            }
            return shape;
        }

        public int offset() {
            return offset;
        }

        /** A summary of the record. */
        public String toString() {
            return "Record " + number + " length " + length + " bounds " + minX
                    + "," + minY + " " + maxX + "," + maxY;
        }
    }     

    private ShapeHandler handler;

    private ShapefileHeader header;

    private ReadableByteChannel channel;

    ByteBuffer buffer;

    private ShapeType fileShapeType = ShapeType.UNDEFINED;

    private ByteBuffer headerTransfer;

    private final Record record = new Record();

    private final boolean randomAccessEnabled = true;

    private boolean useMemoryMappedBuffer;

    private long currentOffset = 0L;

    private int currentShape = 0;

    //private IndexFile shxReader;

    //private StreamLogging streamLogger = new StreamLogging("Shapefile Reader");

    //private GeometryFactory geometryFactory;

    private boolean flatGeometry;

    public ShapeReader(String shpFile,
            boolean useMemoryMapped) throws IOException  {
        this.channel = new FileInputStream(shpFile).getChannel();
        this.useMemoryMappedBuffer = useMemoryMapped;
        //randomAccessEnabled = channel instanceof FileChannel;
        init(true);
    }

    // ensure the capacity of the buffer is of size by doubling the original
    // capacity until it is big enough
    // this may be naiive and result in out of MemoryError as implemented...
    private ByteBuffer ensureCapacity(ByteBuffer buffer, int size,
            boolean useMemoryMappedBuffer) {
        // This sucks if you accidentally pass is a MemoryMappedBuffer of size
        // 80M
        // like I did while messing around, within moments I had 1 gig of
        // swap...
        if (buffer.isReadOnly() || useMemoryMappedBuffer) {
            return buffer;
        }

        int limit = buffer.limit();
        while (limit < size) {
            limit *= 2;
        }
        if (limit != buffer.limit()) {
            // clean up the old buffer and allocate a new one
            buffer = NIOUtilities.allocate(limit);
        }
        return buffer;
    }

    // for filling a ReadableByteChannel
    public static int fill(ByteBuffer buffer, ReadableByteChannel channel)
            throws IOException {
        int r = buffer.remaining();
        // channel reads return -1 when EOF or other error
        // because they a non-blocking reads, 0 is a valid return value!!
        while (buffer.remaining() > 0 && r != -1) {
            r = channel.read(buffer);
        }
        buffer.limit(buffer.position());
        return r;
    }

    private void init(boolean strict) throws IOException {
        if (channel instanceof FileChannel && useMemoryMappedBuffer) {
            FileChannel fc = (FileChannel) channel;
            buffer = fc.map(FileChannel.MapMode.READ_ONLY, 0, fc.size());
            buffer.position(0);
            this.currentOffset = 0;
        } else {
            // force useMemoryMappedBuffer to false
            this.useMemoryMappedBuffer = false;
            // start small
            buffer = NIOUtilities.allocate(1024);
            fill(buffer, channel);
            buffer.flip();
            this.currentOffset = 0;
        }
        header = new ShapefileHeader();
        header.read(buffer, strict);
        fileShapeType = header.getShapeType();
        //handler = fileShapeType.getShapeHandler(gf);
        //if (handler == null) {
        //    throw new IOException("Unsuported shape type:" + fileShapeType);
        //}

        headerTransfer = ByteBuffer.allocate(8);
        headerTransfer.order(ByteOrder.BIG_ENDIAN);

        // make sure the record end is set now...
        record.end = this.toFileOffset(buffer.position());
    }

    /**
     * Get the header. Its parsed in the constructor.
     * 
     * @return The header that is associated with this file.
     */
    public ShapefileHeader getHeader() {
        return header;
    }

    // do important cleanup stuff.
    // Closes channel !
    /**
     * Clean up any resources. Closes the channel.
     * 
     * @throws IOException
     *                 If errors occur while closing the channel.
     */
    public void close() throws IOException {
        // don't throw NPE on double close
        if(channel == null)
            return;
        try {
            if (channel.isOpen()) {
                channel.close();
                //streamLogger.close();
            }
            NIOUtilities.clean(buffer, useMemoryMappedBuffer);
        } finally {
            //if(shxReader != null)
            //    shxReader.close();
        }
        //shxReader = null;
        channel = null;
        header = null;
    }

    public boolean supportsRandomAccess() {
        return randomAccessEnabled;
    }

    public boolean hasNext() throws IOException {
        return this.hasNext(true);
    }

    private boolean hasNext(boolean checkRecno) throws IOException {
        // don't read past the end of the file (provided currentShape accurately
        // represents the current position)
        if(currentShape > UNKNOWN )
            return true;

        // mark current position
        int position = buffer.position();

        // ensure the proper position, regardless of read or handler behavior
        //buffer.position(getNextOffset());

        // no more data left
        if (buffer.remaining() < 8)
            return false;

        // looks good
        boolean hasNext = true;
        if (checkRecno) {
            // record headers in big endian
            buffer.order(ByteOrder.BIG_ENDIAN);
            int declaredRecNo = buffer.getInt();
            hasNext = declaredRecNo == record.number + 1;
        }

        // reset things to as they were
        buffer.position(position);

        return hasNext;
    }

    /*private int getNextOffset() throws IOException {
        if(currentShape >= 0) {
            return this.toBufferOffset(shxReader.getOffsetInBytes(currentShape));
        } else {
            return this.toBufferOffset(record.end);
        }
    }
    */

    /**
     * Fetch the next record information.
     * 
     * @throws IOException
     * @return The record instance associated with this reader.
     */
    public Record nextRecord() throws IOException {

        // need to update position
        //buffer.position(getNextOffset());
        if(currentShape != UNKNOWN)
            currentShape++;

        // record header is big endian
        buffer.order(ByteOrder.BIG_ENDIAN);

        // read shape record header
        int recordNumber = buffer.getInt();
        // silly ESRI say contentLength is in 2-byte words
        // and ByteByffer uses bytes.
        // track the record location
        int recordLength = buffer.getInt() * 2;

        if (!buffer.isReadOnly() && !useMemoryMappedBuffer) {
            // capacity is less than required for the record
            // copy the old into the newly allocated
            if (buffer.capacity() < recordLength + 8) {
                this.currentOffset += buffer.position();
                ByteBuffer old = buffer;
                // ensure enough capacity for one more record header
                buffer = ensureCapacity(buffer, recordLength + 8,
                        useMemoryMappedBuffer);
                buffer.put(old);
                NIOUtilities.clean(old, useMemoryMappedBuffer);
                fill(buffer, channel);
                buffer.position(0);
            } else
            // remaining is less than record length
            // compact the remaining data and read again,
            // allowing enough room for one more record header
            if (buffer.remaining() < recordLength + 8) {
                this.currentOffset += buffer.position();
                buffer.compact();
                fill(buffer, channel);
                buffer.position(0);
            }
        }

        // shape record is all little endian
        buffer.order(ByteOrder.LITTLE_ENDIAN);

        // read the type, handlers don't need it
        ShapeType recordType = ShapeType.forID(buffer.getInt());

        // this usually happens if the handler logic is bunk,
        // but bad files could exist as well...
        if (recordType != ShapeType.NULL && recordType != fileShapeType) {
            throw new IllegalStateException("ShapeType changed illegally from "
                    + fileShapeType + " to " + recordType);
        }

        // peek at bounds, then reset for handler
        // many handler's may ignore bounds reading, but we don't want to
        // second guess them...
        buffer.mark();
        if (recordType.isMultiPoint()) {
            record.minX = buffer.getDouble();
            record.minY = buffer.getDouble();
            record.maxX = buffer.getDouble();
            record.maxY = buffer.getDouble();
        } else if (recordType != ShapeType.NULL) {
            record.minX = record.maxX = buffer.getDouble();
            record.minY = record.maxY = buffer.getDouble();
        }
        buffer.reset();

        record.offset = record.end;
        // update all the record info.
        record.length = recordLength;
        record.type = recordType;
        record.number = recordNumber;
        // remember, we read one int already...
        record.end = this.toFileOffset(buffer.position()) + recordLength - 4;
        // mark this position for the reader
        record.start = buffer.position();
        // clear any cached shape
        // record.shape = null;

        return record;
    }

    /**
     * Parses the shpfile counting the records.
     * 
     * @return the number of non-null records in the shapefile
     */
    public int getCount(int count) throws Exception {
        try {
            if (channel == null)
                return -1;
            count = 0;
            long offset = this.currentOffset;
            try {
                goTo(100);
            } catch (UnsupportedOperationException e) {
                return -1;
            }
            while (hasNext()) {
                count++;
                nextRecord();
            }

            goTo((int) offset);

        } catch (IOException ioe) {
            count = -1;
            // What now? This seems arbitrarily appropriate !
            throw new Exception("Problem reading shapefile record",
                    ioe);
        }
        return count;
    }

    /**
     * Moves the reader to the specified byte offset in the file. Mind that:
     * <ul>
     * <li>it's your responsibility to ensure the offset corresponds to the
     * actual beginning of a shape struct</li>
     * <li>once you call this, reading with hasNext/next on sparse shapefiles
     * will be broken (we don't know anymore at which shape we are)</li>
     * </ul>
     * 
     * @param offset
     * @throws IOException
     * @throws UnsupportedOperationException
     */
    public void goTo(int offset) throws IOException,
            UnsupportedOperationException {
        if (randomAccessEnabled) {
            if (this.useMemoryMappedBuffer) {
                buffer.position(offset);
            } else {
                /*
                 * Check to see if requested offset is already loaded; ensure
                 * that record header is in the buffer
                 */
                if (this.currentOffset <= offset
                        && this.currentOffset + buffer.limit() >= offset + 8) {
                    buffer.position(this.toBufferOffset(offset));
                } else {
                    FileChannel fc = (FileChannel) this.channel;
                    fc.position(offset);
                    this.currentOffset = offset;
                    buffer.position(0);
                    buffer.limit(buffer.capacity());
                    fill(buffer, fc);
                    buffer.position(0);
                }
            }

            int oldRecordOffset = record.end;
            record.end = offset;
            try {
                hasNext(true); // don't check for next logical record equality
            } catch (IOException ioe) {
                record.end = oldRecordOffset;
                throw ioe;
            }
        } else {
            throw new UnsupportedOperationException("Random Access not enabled");
        }
    }

    /**
     * Converts file offset to buffer offset
     * 
     * @param offset
     *                The offset relative to the whole file
     * @return The offset relative to the current loaded portion of the file
     */
    private int toBufferOffset(int offset) {
        return (int) (offset - this.currentOffset);
    }

    /**
     * Converts buffer offset to file offset
     * 
     * @param offset
     *                The offset relative to the buffer
     * @return The offset relative to the whole file
     */
    private int toFileOffset(int offset) {
        return (int) (this.currentOffset + offset);
    }

    public String id() {
        return getClass().getName();
    }

    public void setFlatGeometry(boolean flatGeometry) {
        this.flatGeometry = flatGeometry;        
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-08T09:39:20.757

我会使用一个支持良好的库来满足这个要求。您可以让[Shapelib](http://shapelib.maptools.org/)（GDAL/OGR 的组件）与[NDK](https://developer.android.com/tools/sdk/ndk/index.html)一起使用。

使用 shapelib 将使您能够访问[DBFGetRecordCount](http://shapelib.maptools.org/dbf_api.html)，它返回 xBase 文件中存在的记录数。

我制作了一个[演示](https://github.com/snodnipper/shapelib-android-demo)shapefile writer 应用程序，其中包含以下内容：

`const int recordCount = DBFGetRecordCount(hDBF);`

# sql - SQL Server 2008 R2 插入数据检查

> ID：11632182
> 
> 赞同：-1
> 
> 时间：2012-07-24T13:42:49.357
> 
> 标签：sql, insert, sql-server-2008-r2, bulkinsert

我希望有人可以检查我的代码，以便将数据插入 SQL Server 2008 R2 中的表中。我一直在寻找一段时间，试图找出我的代码有什么问题。我不确定它是格式还是语法。我以前使用过数据库，但它总是需要手动输入表。

```
INSERT INTO (Topic, Location)
     VALUES ('Maths', '103') 
```

我有一个预先制作的表，其中已经创建了主题和位置，但是出现的错误消息是*“无法解析”，*然后是 *SQL 执行错误。错误来源：.Net SqlClient 数据提供程序。错误消息：'(' 附近的语法不正确。*

任何帮助将不胜感激，如果这已经得到回答，对不起！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T13:44:42.583

我没有看到表名......你需要类似的东西

```
INSERT INTO your_table (Topic, Location)
     VALUES ('Maths', '103') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:45:08.397

您需要指定表名。

```
INSERT INTO tableName (Topic, Location)
VALUES ('Maths', '103') 
```

# regex - 这是什么意思？使用表达式将匹配什么字符串？

> ID：11632186
> 
> 赞同：4
> 
> 时间：2012-07-24T13:42:52.443
> 
> 标签：regex, sizzle

我检查了嘶嘶声代码并查看了定义。

```
var chunker = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, 
```

我想知道如何找出这个正则表达式匹配的字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:55:05.730

见[这篇文章](http://codejumble.blogspot.de/2011/01/sizzle-chunker.html)。多行正则表达式中的解释：

```
var chunker = /
 (
  (?:
   # One or more sets of parentheses that contain a string, or another set of 
   parentheses with a string
   \(
   (?:
    \([^()]+\)
    |
    [^()]+
   )+
   \)
   |
   # Or one or more sets of brackets that contain a string, or another set of
   brackets with a string
   \[
   (?:
    \[[^\[\]]*\]
    |
    ['"][^'"]*['"]
    |
    [^\[\]'"]+
   )+
   \]
   |
   # Or a backslash followed by any character
   \\.
   |
   # Or one or more of any except these characters: > +~,([\
   [^ >+~,(\[\\]+
  )+
  # or any one of these characters: >+~
  |
  [>+~]
 )
 # followed by zero or one commas, which may be surrounded by whitespace
 (\s*,\s*)?
 # followed by zero or more of anything, including line endings
 ((?:.|\r|\n)*)
/g 
```

此表达式包含三个匹配组：“已验证”选择器表达式、最终逗号以及之后的所有内容。它将在选择器上不断被调用以将其拆分为多个部分，`Sizzle`有关详细信息，请参阅构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T14:47:33.343

这将是投机性的。但是，使用[RegexBuddy](http://www.regexbuddy.com/) ，您可以“记录”并可视化表达式。

![使用 RegexBuddy 的文档](../Images/74e56abce9c91f324570751f77934cab.png)

因为它是一个付费应用程序，所以我在[pastebin](http://pastebin.com/1cTHvpRs)上导出了评论。希望这会帮助你。（请注意，它不支持 Sizzle，并且我使用 JavaScript 语言来记录表达式）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T15:10:26.420

要学习如何手工完成，您可以像这样简单地分解它（这是一项将来肯定会帮助您的任务）：

```
var chunker = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, 
```

第一部分是了解正则表达式通常是如何编写的，所以在这种情况下它将是：

```
var variableName = /stuff/g;
                   ^  ^  ^^
        delimiters/---+--/|
                      |   |
                regex /   \global modifier, can also have a case modifier 
```

所以让我们去掉修饰符以及开始和结束，只计算正则表达式：

```
((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*) 
```

仍然是 gobbledygook，但让我们继续：正则表达式用于*捕获内容*，我们知道未转义（意味着他们在字符被转义之前使用反斜杠`\`）括号捕获大括号，让我们在每个括号周围添加一些换行符（仅用于检查目的！ !!）和管道的意思是“或”

```
(
  (?:
    \(
      (?:
          \(
              [^()]+
          \)
        |
          [^()]+
      )+
    \)
|
  \[
    (?:
        \[[^\[\]]*\]
      |
        ['"][^'"]*['"]
      |
        [^\[\]'"]+
    )+
  \]
|
  \\.
|
  [^ >+~,
  (
      \[\\]+)+
    |
      [>+~]
  )
  (\s*,\s*)?
  (
    (?:
        .
      |
        \r
      |
        \n
    )*
  ) 
```

方括号的意思是“有选择地匹配其中的内容作为选择集中的任何值”，所以现在我要添加一些评论，让你解决剩下的问题（而且，看起来确实有些括号是失踪）

```
(
  (?:                 //<-- start a non-capturing group (means, don't tell the app we matched)
    \(
      (?:             //<-- start a non-capturing group (means, don't tell the app we matched)
          \(
              [^()]+  //one or more paren pairs inside a paren pair
          \)
        |
          [^()]+      //or one or more paren pairs
      )+
    \)
|
  \[
    (?:
        \[[^\[\]]*\]
      |
        ['"][^'"]*['"]
      |
        [^\[\]'"]+
    )+
  \]
|
  \\.
|
  [^ >+~,
  (
      \[\\]+)+
    |
      [>+~] //either a tilde, plus or opening brace
  )
  (\s*,\s*)?
  (
    (?:
        .
      |
        \r
      |
        \n
    )*
  ) 
```

# objective-c - UIImage 作为 CAShapeLayer 内容

> ID：11632200
> 
> 赞同：3
> 
> 时间：2012-07-24T13:43:30.253
> 
> 标签：objective-c, ios, core-animation

如果我创建一个只有背景颜色的 CAShapeLayer，它会显示出来，但是如果我将内容设置为图像，则什么也不会显示。

```
CAShapeLayer* leftDot = [CAShapeLayer layer];
leftDot.opacity = 1.0;
leftDot.frame = CGRectMake(leftRef.CGPointValue.x, leftRef.CGPointValue.y, 2 * radius, 2 * radius);
leftDot.position = CGPointMake(leftRef.CGPointValue.x + 4, leftRef.CGPointValue.y + 4);
leftDot.cornerRadius = radius;
[leftDot setContents:[UIImage imageNamed: @"glow.png"]];

[self.layer addSublayer: leftDot]; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2016-06-21T12:18:52.677

*[注意：更新到 Swift 2.2 和 Swift 3]*

### 快速回答：使用 CALayer

如[CAShapeLayer 类参考](https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CAShapeLayer_class/index.html#//apple_ref/occ/cl/CAShapeLayer)中所述，a`CAShapeLayer`用于使用自定义路径绘制形状。将图像设置为其`contents`将被忽略。

如果您只想在图层中显示图像（假设您的文件名为`image.png`），则可以使用 a`CALayer`并设置其`contents`属性，以便它引用`CGImage`图像的表示：

*斯威夫特 2.2：*

```
let layer = CALayer()
layer.contents = UIImage(named: "image")?.CGImage 
```

*斯威夫特 3：*

```
let layer = CALayer()
layer.contents = UIImage(named: "image")?.cgImage 
```

* * *

### 更长的答案：继续使用 CAShapeLayer

由于 OP 专门询问了`CAShapeLayer`，因此问题可能类似于“如何使用 将图像裁剪为特定形状`CAShapeLayer`？”

我建议您尝试两种解决方案：

**1) 掩蔽**

创建一个法线`CALayer`并将图像设置为其`contents`. 然后用你喜欢的路径创建一个`CAShapeLayer`并将其用作第一层的`mask`.

*斯威夫特 2.2：*

```
let imageLayer = CALayer()
imageLayer.contents = UIImage(named: "image")?.CGImage // Assign your image
imageLayer.frame = ... // Define a frame

let maskPath = UIBezierPath(...) // Create your path
let maskLayer = CAShapeLayer()
maskLayer.path = maskPath.CGPath

imageLayer.mask = maskLayer // Set the mask 
```

*斯威夫特 3：*

```
let imageLayer = CALayer()
imageLayer.contents = UIImage(named: "image")?.cgImage // Assign your image
imageLayer.frame = ... // Define a frame

let maskPath = UIBezierPath(...) // Create your path
let maskLayer = CAShapeLayer()
maskLayer.path = maskPath.cgPath

imageLayer.mask = maskLayer // Set the mask 
```

不要忘记设置正确的框架和路径，应该可以达到你想要的效果。

**2) 填充颜色**

使用您喜欢的路径创建一个`CAShapeLayer`，然后将您的图像用作它的`fillColor`.

*斯威夫特 2.2：*

```
let path = UIBezierPath(...) // Create your path
let layer = CAShapeLayer()
layer.path = path.CGPath

let image = UIImage(named: "image") // Assign your image
layer.fillColor = UIColor(patternImage: image!).CGColor 
```

*斯威夫特 3：*

```
let path = UIBezierPath(...) // Create your path
let layer = CAShapeLayer()
layer.path = path.cgPath

let image = UIImage(named: "image") // Assign your image
layer.fillColor = UIColor(patternImage: image!).cgColor 
```

一开始您可能会发现这种方法更容易，但控制图像填充形状的方式并非易事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T13:45:15.597

CAShapeLayer 不是这样工作的。您将创建一个以图像为内容的普通 CALayer，然后使用形状图层作为该图层的蒙版以实现您想要的效果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-16T16:12:24.867

您可以通过设置`fillColor`而不是`contents`：

```
layer.fillColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"image"]].CGColor; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-26T21:13:01.683

```
layerName.contents = (id)[[UIImage imageNamed:@"img.PNG"] CGImage]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-22T07:24:02.653

您必须为图层设置 CGImage

```
leftDot.fillColor=[UIColor clearColor].CGColor ;
[leftDot setContents:(__bridge id)[UIImage imageNamed: @"glow.png"].CGImage]; 
```

# c++ - Linux上的GLSL着色器编译

> ID：11632203
> 
> 赞同：3
> 
> 时间：2012-07-24T13:43:43.113
> 
> 标签：c++, linux, opengl, glsl

我试图让我的跨平台着色器编译一个默认着色器，它只不过是这样的基本着色器程序：

顶点程序：

```
void main()
{
    //vec4 vertex = matModelView * a_vertex;
    gl_Position = ftransform();//matProj * vertex;

    gl_TexCoord[0] = gl_MultiTexCoord0;
} 
```

片段程序：

```
uniform sampler2D colorMap;

void main()
{
    gl_FragColor = texture2D(colorMap, gl_TexCoord[0].st);
} 
```

我知道 gl_ 前缀是不推荐使用的函数，但这只是一个默认着色器，所以我知道一切正常。这个示例在我的着色器类的 windows 下运行良好。

现在进入我的着色器类，当我创建一个着色器对象时，我调用加载方法，该方法采用没有文件扩展名的路径。例如： ./data/shaders/default 加载器接受这个并搜索该字符串 + .vert .geom 或 .frag 以查找适当的着色器程序。然后将它们加载并传递给创建程序的 OpenGL 部分。这似乎是哪里出了问题，我可以确认着色器程序的内容是从磁盘正确加载的，所以据我所知，这不是问题所在。

加载文件后，它会继续编译顶点和片段程序（或几何，但这是可选的）：

`a_Type`要么`GL_FRAGMENT_SHADER`要么`GL_VERTEX_SHADER`。`a_Source`是着色器程序文件（.ver​​t/.frag/.geom 文件）的内容。当我加载顶点程序时，编译立即失败并被`if( success != GL_TRUE )`击中并被评估为如此，我得到一个编译错误。我没有得到任何输出，“着色器编译输出” printf 没有打印任何关于编译的信息。（这`OGLCHECK`是一个检查 opengl 错误堆栈的宏，它也不显示任何内容。）

```
GLuint Shader::Compile(const GLuint a_Type, const char* a_Source)
{
    if(a_Source == NULL)
        return 0;

    GLuint handle = glCreateShader(a_Type); OGLCHECK
    glShaderSource(handle, 1, &a_Source, NULL); OGLCHECK
    glCompileShader(handle); OGLCHECK

    int bufflen = 0;
    GLint success = GL_FALSE;

    glGetShaderiv(handle, GL_INFO_LOG_LENGTH, &bufflen); OGLCHECK
    if(bufflen > 1)
    {
        GLchar* logString = new GLchar[bufflen + 1];
        glGetShaderInfoLog(handle, bufflen, 0, logString); OGLCHECK
        printf( "Shader compile output:\n%s\n", logString );

        delete logString;
        logString = 0;
    }

    glGetShaderiv(handle, GL_COMPILE_STATUS, &success); OGLCHECK
    if(success != GL_TRUE)
    {
        printf( "Failed to compile shader!\n" );

        glDeleteShader(handle); OGLCHECK
        handle = 0;
    }

    return handle;
} 
```

我不确定发生了什么，这个实现在 Windows 下运行良好，因为这是我移植到 linux 的渲染引擎的一部分。有人在linux下对着色器编译有类似的问题吗？

另外，我检查了 glxinfo，这里有一些信息：

```
glxinfo | grep "OpenGL version"
OpenGL version string: 4.2.0 NVIDIA 295.49 
```

我还在 fragment_program、vertex_program、geometry_program 上进行了 grep，所有这些扩展似乎都可用。我正在运行 Ubuntu 12.04。

更新：它似乎与着色器文件无关，但其他东西，当我从终端运行它时，它可以编译着色器并使用它们，但是每当我从 Code::Blocks 运行它时，它就无法编译着色器.. 他们正在加载并传递给 OpenGL。不知道发生了什么。

# jdbc - JDBC 和 MS-Access 空指针

> ID：11632206
> 
> 赞同：-1
> 
> 时间：2012-07-24T13:43:53.703
> 
> 标签：jdbc

JDBC 空指针错误。在访问数据库时。这是我正在执行的查询。

```
"INSERT INTO paritosh ( customer, contactPerson, mobileNo, phoneNo, emailId, chairman, instituteName, totalEmployees, totalFaculty, totalStudents, totalClassroom, address, state, revenue, clientRate, acceptedRate, valuePerCard, rating, finderName, finderFee, comments ) VALUES ('kinley', 'adfa' , '232131' , '2323' , '@gmail' , 'adfadf' , 'zxc' ,100,11,1000,30, 'dfdfa' , 'Delhi' , 66000,60000,60000,600, 'Hot' , 'tyu' , 8, 'dfadfadfasdf');" 
```

如果我在访问中将代码作为 sql 查询执行，则查询运行良好.....

请帮忙

JDBC代码如下：

```
String insertq="INSERT INTO paritosh ( customer, contactPerson, mobileNo, phoneNo, emailId, chairman, instituteName, totalEmployees, totalFaculty, totalStudents, totalClassroom, address, state, revenue, clientRate, acceptedRate, valuePerCard, rating, finderName, finderFee, comments )";

String query=" VALUES ('"+customer+"', '"+contact+"' , '"+mobile+"' , '"+phone+"' , '"+email+"' , '"+chairman+"' , '"+institute+"' ,"+totalEmployees+","+totalFaculty+","+totalStudents+","+classroom+", '"+address+"' , '"+state+"' , "+revenue+","+clientRate+","+accepRate+","+valPercard+", '"+Rating+"' , '"+finderName+"' , "+finderFee+", '"+comment+"');";
     String build=insertq+query;

String query2="INSERT INTO paritosh ( customer, contactPerson, mobileNo, phoneNo, emailId, chairman, instituteName, totalEmployees, totalFaculty, totalStudents, totalClassroom, address, state, revenue, clientRate, acceptedRate, valuePerCard, rating, finderName, finderFee, comments ) VALUES ('virappan', 'dussal' , '4269887' , '12334567' , 'kumar@ril.com' , 'kumar' , 'RMIT' ,300,120,3000,150, 'adfad' , 'Delhi' , 400000,380000,390000,1500, 'Hot' , 'vineet' , 9, 'afddf');"; 

try{   
  s.execute(build);  
}
catch(SQLException se)
{   
  System.out.println("SQL eception");  
}
catch(Exception e)
{
    System.out.println(e);
    System.out.println(" error after running the query");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T15:15:52.910

*   查看您的代码，我建议您考虑使用[PreparedStatement](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)而不是您正在执行的方式。

*   `execute()`确保在调用该方法之前已建立连接。请注意，这仅基于您提供的内容。如果您希望我们查看您的整体代码并帮助您，您应该考虑发布[SSCCE 。](http://sscce.org/)

# python - python - 在输入数据和属性中存储可变数量的列

> ID：11632209
> 
> 赞同：2
> 
> 时间：2012-07-24T13:43:58.823
> 
> 标签：python

我们有几个在线数据来源（数字）：

```
[ 来源 1 ]
1 52 61 17
1 2 2 12
31 4 42 1

[ 来源 2 ]

2 52 6 2 1 2
2 37 4 5 4 35
2 3 74 5 93 7
3 83 8 8 65 0

[ 来源 X ]
...

```

如您所见，每个源中有不同数量的列。我想做的是阅读（对所有数据源使用相同的脚本）所有行，但以一种让我对这些数字进行操作的方式（即右对齐它们，如果它们大于 Y 值，则在其中一些下划线， ETC）。所以我还需要存储一些关于每个数字的附加属性。存储这些数据+关于它们的属性的最佳数据结构是什么？

更新：由于有人说解决方案取决于我想用这些数字做什么，我会尝试更好地解释：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T13:55:05.410

我会尝试这样的事情（纯Python）：

```
rows = []
for source in list_of_filenames:
    with open(source) as f:
        for line in f:
            if line == '' or line.isspace():
                continue
            rows.append([(int(num), {}) for num in line.split()]) 
```

这将为您提供元组列表的列表。每个元组将包含一个数字和一个字典，您可以在其中存储元数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T19:45:56.710

使用基本 python 数据结构的自定义数据结构

这就是数据（连同元值）的样子：

*   文件中有很多行。因此，我们为每一行分配一个名称。说`line1`
*   每行都有几个数字，每个数字都有一些属性。

现在，

1.  我们构造了一个文件`list`中有尽可能`tuples`多的行数。
2.  每个元组的第一个元素是`TupleName`，第二个元素是`list`存储数字数据的
3.  在第二个元素中，元组的数量与连续的数字一样多。其中每个元组包含`number`和`dict`属性。

例子 ：

```
data_structure = [ ("line1", [ ("num1", {"attr1" : value, "attr2" : value, } ),
                               ("num2", {"attr1" : value, } ),
                                ("num3", {} ),
                             ]
                    ),

                    ("line2", [ ("num1", {"attr1" : value, "attr2" : value, } ),
                                ("num2", {"attr1" : value, "attr2" : value, } ),
                            ]
                    ),

                    ("line3", [ ("num1", {"attr1" : value, "attr2" : value, } ),
                    ],
] 
```

这显然看起来很复杂。但是，由于我们现在标准化了数据结构，我们可以编写一个`class`定义添加、删除或编辑的方法`attributes`or`numbers`或`lines`。最重要的部分是，确保您编写了一个从文件对象创建我们的数据结构的方法。

现在，您摆脱了复杂性。

您可以使用`lists`代替，`tuples`但我只是为了不干扰我们定义的数据结构而添加。

**样本类**

*可能是原始的，但它应该告诉你我实际上想要解释什么*

```
class data (object):
    def __init__(self, file_name):
        self.file_name = file_name
        self.data = open(self.file_name, "r").readlines()
        # The Data Str
        self.ds = self.makeDS()

    def getNumList(self, line_count):
        return self.data[line_count][:-1].split()

    def makeDS (self):
        ds = []
        for eachLine in self.data:
            line_count = self.data.index(eachLine)
            num_list = self.getNumList(line_count)

            eachLine_num_data = []
            for aNum in num_list:
                num_attr = {}
                eachLine_num_tuple = (aNum, num_attr)
                eachLine_num_data.append(eachLine_num_tuple)
            eachLine_tuple = (line_count, eachLine_num_data)
            ds.append(eachLine_tuple)
        return ds

    def getAttr (self, line_count, num_count):
        attr = self.ds[line_count][1][num_count]
        return attr

    def add_attr (self, line_count, num_count,
                    attr_name, attr_value):
        attr = self.ds[line_count][1][num_count][1]
        attr[attr_name] = attr_value

o = data("file.txt")
o.add_attr(0,0,"name", "value")
print o.getAttr(0, 0) 
```

*输出*

```
>>> ('2', {'name': 'value'}) 
```

**如何在文件中应用属性**

这有点复杂（不完全）。标准文本文件不支持（下划线、粗体、斜体 ..）等功能。或`.docx`任何其他格式更可能是`zip archive`格式`openXML`。您需要知道如何使用它们才能应用 about 属性。

# wpf - 奇怪的 DependencyProperty 异步行为

> ID：11632212
> 
> 赞同：1
> 
> 时间：2012-07-24T13:44:05.097
> 
> 标签：wpf

我有一个 MVVM 应用程序，其中模型层中的状态更改需要传达给视图，并且在模型层中进一步处理之前，需要同步地对状态更改进行操作。

具体场景涉及模型和视图共享的COM对象（由于构建在糟糕的遗留架构上），模型需要对共享的COM对象执行Marshal.ReleaseComObject，但视图需要释放其引用事先到 COM 对象（否则 RCW 将失效，并且此特定视图组件背后的本机实现将猛烈爆炸）。

我用来实现这一点的机制是将视图上的依赖属性数据绑定到模型上的属性，视图模型层会中继此更改通知。模型层和视图模型层都实现了必要的 INotifyPropertyChanged 接口来支持绑定。在视图中，依赖属性注册到一个附加了 PropertyChanged 处理程序的 PropertyMetadata 实例。

我发现的问题是我的 PropertyChanged 处理程序没有被同步调用。当我在模型中触发 PropertyChanged 事件时，它会正确中继到视图绑定到的属性，但此时不会触发依赖属性 PropertyChanged 事件。几行代码之后，模型调用 Marshal.ReleaseComObject，然后在该调用内部，依赖属性 PropertyChanged 事件在同一个（主 UI）线程上被调用。

在我看来，绑定非常像将依赖属性 PropertyChange 调用发布到消息循环上，并且对 ReleaseComObject 的调用导致消息循环处理该消息。

经过一上午的研究，我没有发现任何东西可以解释为什么会发生这种情况。在绑定上设置 IsAsync=false 也没有效果。

对于这个问题，我已经有了一个可以接受的解决方法，但我真的很想了解这里发生了什么。有谁知道这里发生了什么或有类似行为的经验？

# c++ - C preprocessor macro specialisation based on an argument

> ID：11632219
> 
> 赞同：18
> 
> 时间：2012-07-24T13:44:16.220
> 
> 标签：c++, c, c-preprocessor

Is it possible to have one macro expanded differently for one specific argument value and differently for all other arguments?

Say I define a current user:

```
#define CURRENT_USER john_smith 
```

What I want to be able to do is to have a macro that will be *expanded* differently if user passed matches `CURRENT_USER`. Mind you that I don't know all possible user a priori. The most basic case:

```
#define IS_CURRENT_USER(user)                   \
    /* this is not valid preprocessor macro */  \
    #if user == CURRENT_USER                    \
        1                                       \
    #else                                       \
        0                                       \
    #endif 
```

With macro like that every other macro relying on the username could be done following way:

```
#define SOME_USER_SPECIFIC_MACRO(user) SOME_USER_SPECIFIC_MACRO_SWITCH_1(IS_CURRENT_USER(user))

#define SOME_USER_SPECIFIC_MACRO_SWITCH_1(switch)   SOME_USER_SPECIFIC_MACRO_SWITCH_2(switch) // expand switch ...
#define SOME_USER_SPECIFIC_MACRO_SWITCH_2(switch)   SOME_USER_SPECIFIC_MACRO_##switch         // ... and select specific case

#define SOME_USER_SPECIFIC_MACRO_0  ... // not current user
#define SOME_USER_SPECIFIC_MACRO_1  ... // current user 
```

Is this possible?

EDIT: Let me clarify. Say each programmer defines different `CURRENT_USER` in their config header. I want user specific macros to exand to something meaningful if and only if their `user` argument matches `CURRENT_USER`. As I would like those macros to contain `_pragma`s it can't be runtime check (as proposed in some anwsers below).

EDIT: Again, clarification. Say there's macro to disable optimisation of some sections of code:

```
#define TURN_OPTIMISATION_OFF __pragma optimize("", off) 
```

Some programmers want to turn optimisation off for different sections of code but not all at one time. What I'd like is to have a macro:

```
#define TURN_OPTIMISATION_OFF(user) /* magic */ 
```

That will match `user` argument against `CURRENT_USER` macro, taken from per-programmer config file. If the user matches macro is expanded into pragma. If not, to nothing.

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-24T23:30:11.860

Well first, you can do pattern matching with the preprocessor using the `##`. This is how an `IIF` macro could be defined:

```
#define IIF(cond) IIF_ ## cond
#define IIF_0(t, f) f
#define IIF_1(t, f) t 
```

However there is one problem with this approach. A subtle side effect of the `##` operator is that it inhibits expansion. Heres an example:

```
#define A() 1
//This correctly expands to true
IIF(1)(true, false) 
// This will however expand to IIF_A()(true, false)
// This is because A() doesn't expand to 1,
// because its inhibited by the ## operator
IIF(A())(true, false) 
```

The way to work around this is to use another indirection. Since this is commonly done, we can write a macro called `CAT` that will concatenate without inhibition.

```
#define CAT(a, ...) PRIMITIVE_CAT(a, __VA_ARGS__)
#define PRIMITIVE_CAT(a, ...) a ## __VA_ARGS__ 
```

So now we can write the `IIF` macro:

```
#define IIF(c) PRIMITIVE_CAT(IIF_, c)
#define IIF_0(t, ...) __VA_ARGS__
#define IIF_1(t, ...) t

#define A() 1
//This correctly expands to true
IIF(1)(true, false) 
// And this will also now correctly expand to true
IIF(A())(true, false) 
```

With pattern matching we can define other operations, such as `COMPL` which takes the complement:

```
// A complement operator
#define COMPL(b) PRIMITIVE_CAT(COMPL_, b)
#define COMPL_0 1
#define COMPL_1 0
// An and operator
#define BITAND(x) PRIMITIVE_CAT(BITAND_, x)
#define BITAND_0(y) 0
#define BITAND_1(y) y 
```

Next, detection techniques can be used to detect if the parameter is a certain value or if it is parenthesis. It relies on variadic arguments expanding to different number of parameters. At the core of detection is a `CHECK` macro with a `PROBE` macro like this:

```
#define CHECK_N(x, n, ...) n
#define CHECK(...) CHECK_N(__VA_ARGS__, 0,)
#define PROBE(x) x, 1, 
```

This is very simple. When the probe is given to the `CHECK` macro like this:

```
CHECK(PROBE(~)) // Expands to 1 
```

But if we give it a single token:

```
CHECK(xxx) // Expands to 0 
```

So with this, we can create some detection macros. For instance, if we want to detect for parenthesis:

```
#define IS_PAREN(x) CHECK(IS_PAREN_PROBE x)
#define IS_PAREN_PROBE(...) PROBE(~)
IS_PAREN(()) // Expands to 1
IS_PAREN(xxx) // Expands to 0 
```

Next, we need to do a comparison of two tokens, we can rely on the fact that macros don't expand recursively. We force the macro to expand recursively inside of the other macro. If the two tokens are the same then the it will be expanding the macros recursively, which we will detect by trying detect if they expanded to parenthesis or not, here is the `COMPARE` macro:

```
#define COMPARE(a, b) PRIMITIVE_COMPARE(a, b)
#define PRIMITIVE_COMPARE(a, b) \
    IIF( \
        BITAND \
            (IS_PAREN(COMPARE_ ## a(()))) \
            (IS_PAREN(COMPARE_ ## b(()))) \
    )( \
        COMPL(IS_PAREN( \
            COMPARE_ ## a( \
                COMPARE_ ## b \
            )(()) \
        )), \
        0 \
    ) \ 
```

Each token you want to compare you would define like this:

```
// So you would define one for each user
#define COMPARE_john_smith(x) x
#define COMPARE_another_user_name(x) x 
```

Now, I don't fully understand the final output you want generated, so say you have a macro for generating code for the current user and one for other users:

```
#define MACRO_CURRENT_USER(user) ...
#define MACRO_OTHER_USER(user) ... 
```

Then you can write something like this:

```
// Detects if its the current user
#define IS_CURRENT_USER(user) COMPARE(user, CURRENT_USER)
// Your macro
#define MACRO(user) IIF(IS_CURRENT_USER(user))(MACRO_CURRENT_USER, MACRO_OTHER_USER)(user) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-25T14:54:09.443

Tuns out **it is possible**. This anwser is based on Pauls macros, but much simpler and does not need definition for each user.

```
#define CAT(a, ...) PRIMITIVE_CAT(a, __VA_ARGS__)
#define PRIMITIVE_CAT(a, ...) a ## __VA_ARGS__

#define IIF(c) PRIMITIVE_CAT(IIF_, c)
#define IIF_0(t, ...) __VA_ARGS__
#define IIF_1(t, ...) t

#define PROBE(x) x, 1 
```

Now, because of the [MSVC bug](http://connect.microsoft.com/VisualStudio/feedback/details/380090/variadic-macro-replacement) I had to modify `CHECK` macro a bit.

```
#define MSVC_VA_ARGS_WORKAROUND(define, args) define args
#define CHECK(...) MSVC_VA_ARGS_WORKAROUND(CHECK_N, (__VA_ARGS__, 0))
#define CHECK_N(x, n, ...) n 
```

Instead of defining `CURRENT_USER` I switched to following macros.

```
#define ENABLE_USER_gwiazdorrr () // gwiazdorrr is now enabled
#define ENABLE_USER_foo ()        // foo is also enabled
// #define ENABLE_USER_bar ()     // bar is NOT enabled 
```

It actually gives more flexibility, because one can enable multiple user at the same time. The parenthesis is required. The macros below actually detect, whether `ENABLE_USER_<user>` is expanded into parenthesis or not.

```
#define USER_ENABLED_PROBE(user)            USER_ENABLED_PROBE_PROXY( ENABLE_USER_##user ) // concatenate prefix with user name
#define USER_ENABLED_PROBE_PROXY(...)       USER_ENABLED_PROBE_PRIMIVIE(__VA_ARGS__)       // expand arguments
#define USER_ENABLED_PROBE_PRIMIVIE(x)      USER_ENABLED_PROBE_COMBINE_##x                 // merge
#define USER_ENABLED_PROBE_COMBINE_(...)    PROBE(~)                                       // if merge successful, expand to probe

USER_ENABLED_PROBE(gwiazdorrr) // expands to ~, 1
USER_ENABLED_PROBE(bar)        // expands to USER_ENABLED_PROBE_COMBINE_bar 
```

From now it is a childs play:

```
#define IS_USER_ENABLED(user) CHECK(USER_ENABLED_PROBE(user))

IS_USER_ENABLED(gwiazdorrr)   // expands to 1
IS_USER_ENABLED(bar)          // expands to 0 
```

Having this macro and `IIF` (thanks Paul!) I decided to implement the optimisation macro mentioned in the original question:

```
#define TURN_OPTIMISATION_OFF(user) IIF( IS_USER_ENABLED(user) ) \
    (\
        __pragma optimize("", off),\
        /* nothing */ \
    )

TURN_OPTIMISATION_OFF(gwiazdorrr) // expands into __pragma optimize("", off)
TURN_OPTIMISATION_OFF(foo)        // expands into __pragma optimize("", off)
TURN_OPTIMISATION_OFF(bar)        // nothing emitted 
```

Thanks for input!

EDIT: here's the GCC version: [http://ideone.com/129eo](http://ideone.com/129eo)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T13:53:59.947

If the argument to the macro is always very constant (even literally and lexically) you could play tricks with [concatenation](http://gcc.gnu.org/onlinedocs/gcc-4.7.1/cpp/Concatenation.html), something like

```
#define SOME_MACRO(T) SOME_MACRO_FOR_##T
#define SOME_MACRO_FOR_0 somethinghere()
#define SOME_MACRO_FOR_1 somethingelse() 
```

Otherwise, you could have

```
#define CURRENT_USER ((user == THE_USER)?(something()):(somethingelse())) 
```

Or use a `static inline` tiny function:

```
static inline int current_user(int user)
{
   return (user==THE_USER)?(something()):(somethingelse());
} 
```

(Notice that if `user` is a constant, perhaps after some previous compiler optimization, the compiler would optimize that to something simpler, and the compiled binary won't test `user` at runtime. See also [__builtin_constant_p](http://gcc.gnu.org/onlinedocs/gcc-4.7.1/gcc/Other-Builtins.html) if compiling with `gcc`).

But I believe your preprocessor tricks might make your code less readable. Think twice when making them.

And you didn't tell us what is your exact macro usage. Do you use it as an lvalue?

As you say, the preprocessor cannot expand to preprocessing directive, so your example :

```
#define IS_CURRENT_USER(user)                   \
  /* this is not valid preprocessor macro */  \
  #if user == CURRENT_USER                    \
      1                                       \
  #else                                       \
      0                                       \
  #endif 
```

is (as you say) incorrect.

You are only allowed to do things like :

```
 #if user == CURRENT_USER
 #define IS_CURRENT_USER(U) 1
 #else
 #define IS_CURRENT_USER(u) 0
 #endif 
```

I knowingly am using `u` not `user` as the formal argument to your macro `IS_CURRENT_USER` for readability (that formal is not expanded, only its occurrences in the macro are).

Do you realize that preprocessing happens "before" compilation? Did you run e.g. `gcc -C -E` to get the preprocessed ouput? It should be instructive!

Read more about [the C preprocessor](http://en.wikipedia.org/wiki/C_preprocessor)

BTW, did you consider generating some *C* code (perhaps to be `#include`-d somewhere) with a script (or your own generator, or [autotools](http://en.wikipedia.org/wiki/GNU_build_system), or a generic preprocessor like [autogen](http://www.gnu.org/software/autogen/) or [m4](http://www.gnu.org/software/m4/))? You could *generate* (from e.g. a user base such as `/etc/passwd` on Linux, or NIS/YP, LDAP or with `getpwent(3)` ...) an `#include`-d `myoptim.h` with things like

```
#if CURRENT_USER_ID==1234
#define OPTIMIZATION_FOR_PAUL _pragma(GCC(optimize,"-O1"))
#else
#define OPTIMIZATION_FOR_PAUL /*nothing*/
#endif
#if CURRENT_USER_ID==3456
#define OPTIMIZATION_FOR_ALICE _pragma(GCC(optimize,"-O1"))
#else
#define OPTIMIZATION_FOR_ALICE /*nothing*/
#endif 
```

and ask Paul (assuming his uid is 1234) to prefix his functions with `OPTIMIZATION_FOR_PAUL` and put `CFLAGS=-DCURRENT_USER_ID=$(shell id -u)` in your `Makefile`; I find that ugly (and it does not address the fact that optimization might alter *globally* behavior of ill-coded programs).

You could customize GCC with e.g. a [MELT](http://gcc-melt.org/) extension providing a custom pragma or builtin for your needs, but I find that weird in your particular case.

NB. Historically, `cpp` was designed to be a quick textual processor, not Turing-complete. In the old days (1980-s Unix) it ran as a separate process, with the real compilation done by `cc1`, and the `cc` compiler was just a shell script driving them (with `as` and `ld`). Today, `gcc` is a small driver program, but `cc1` incorporates the pre-processor for performance reasons. Still, the *C* standard is specified so that the pre-processing can be a separate program from the compiler proper.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-24T14:00:01.043

Preprocessing takes place before compilation.

If user is known to the preprocessor, then yes:

```
#define user 4
#define CURRENT_USER 4
#define IS_CURRENT_USER 1

#if user == CURRENT_USER
#define IS_CURRENT_USER(user) 1
#else
#define IS_CURRENT_USER(user) 0
#endif 
```

But this is utterly useless and I doubt it's what you actually have.

Otherwise, **no**. Don't abuse mecros and the preprocessor.

**After your edit:**

No, what you want is definitely not possible (turn off optimizations depending on user).

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-04-26T23:22:17.590

The code below is not sensitive to the MSVC bug. The ... arguments are not separated.

```
#define IF_USER_ENABLED(x,...) IF_USER_ARGS_GT2 (ENABLE_USER_ ## x,__VA_ARGS__) 
#define IF_USER_ARGS_GT2(x,...) ARGS_ARG2 (x,GT4,3,,__VA_ARGS__)
#define ARGS_ARG2(x,y,z,...) ARGS_ ## z (x,y,z,__VA_ARGS__)
#define ARGS_3(x,y,z,w,...) w
#define ARGS_GT4(x,y,z,w,v,...) __VA_ARGS__

#define IF_USER_DISABLED(x,...) IF_NOT_USER_ARGS_GT2 (ENABLE_USER_ ## x,__VA_ARGS__) 
#define IF_NOT_USER_ARGS_GT2(x,...) ARGS_ARG2 (x,4,GT3,,__VA_ARGS__)
#define ARGS_4(x,y,z,w,v,...) v
#define ARGS_GT3(x,y,z,w,...) __VA_ARGS__

#define ENABLE_USER_foo ,
//#define ENABLE_USER_bar , 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-24T13:51:34.003

Why didn't you use simple `if` statement? `#if` can't be used in a macro.

Here is an example:

```
// Return 1 if `user' is the current user, 0 else.
#define IS_CURRENT_USER(user) ((user) == CURRENT_USER) 
```

Or if you set your `USER` during the compilation, you can reduce the number of conditional branches.

```
#if USER == CURRENT_USER
# define IS_CURRENT_USER (1)
#else
# define IS_CURRENT_USER (0)
#endif 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-24T14:04:20.943

What's wrong with something like that?

```
#if CURRENT_USER == john_smith
    #define SOME_USER_SPECIFIC_MACRO_SWITCH  WHATEVER ## CURRENT_USER
    #define SOME_USER_SPECIFIC_MACRO_1  ... 
#else
    #define SOME_USER_SPECIFIC_MACRO_0  ... 
    #define SOME_USER_SPECIFIC_MACRO_SWITCH  WHATEVER ## Somethingelse
#endif// not current user 
```

# struts2 - 从 ActionContext (i18n) 获取 TextProvider 的最佳方式

> ID：11632222
> 
> 赞同：4
> 
> 时间：2012-07-24T13:44:26.343
> 
> 标签：struts2, displaytag

我正在修改[http://displaytag.svn.sourceforge.net/viewvc/displaytag/trunk/displaytag/src/main/java/org/displaytag/localization/I18nWebworkAdapter.java?revision=1173&view=markup](http://displaytag.svn.sourceforge.net/viewvc/displaytag/trunk/displaytag/src/main/java/org/displaytag/localization/I18nWebworkAdapter.java?revision=1173&view=markup)的代码来自 Displaytag 中的键的 i18n 资源（请参见下面的代码）。

我想知道这是否是最干净的方法（我不喜欢那里的迭代器）。然而，我看到的唯一替代方法是从 ActionInvocation (ActionContext.getContext().getActionInvocation().getAction()) 中获取 Action，并依靠对 ActionSupport 的强制转换来获取资源（实现 TextProvider）。不过，这似乎不太安全（动作可能不会扩展动作支持）。

你有什么其他的建议？

```
/**
 * @see I18nResourceProvider#getResource(String, String, Tag, PageContext)
 */
public String getResource(String resourceKey, String defaultValue, Tag tag, PageContext pageContext)
{

    // if resourceKey isn't defined either, use defaultValue
    String key = (resourceKey != null) ? resourceKey : defaultValue;

    String message = null;
    OgnlValueStack stack = TagUtils.getStack(pageContext);
    Iterator iterator = stack.getRoot().iterator();

    while (iterator.hasNext())
    {
        Object o = iterator.next();

        if (o instanceof TextProvider)
        {
            TextProvider tp = (TextProvider) o;
            message = tp.getText(key, null, null);

            break;
        }
    }

    // if user explicitely added a titleKey we guess this is an error
    if (message == null && resourceKey != null)
    {
        log.debug(Messages.getString("Localization.missingkey", resourceKey)); //$NON-NLS-1$
        message = UNDEFINED_KEY + resourceKey + UNDEFINED_KEY;
    }

    return message;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T13:57:15.330

您可以使用`LocalizedTextUtil`该类来查找消息。

```
LocalizedTextUtil.findDefaultText(key, ActionContext.getContext().getLocale()); 
```

此方法采用一个可选参数`Object[]`，该参数被替换到消息中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:53:18.110

*最好*的方法是使用与文本标签相同的方式（检查实现），或者其他标签的做法：通过搜索堆栈。

此外，您可能并不是要显式转换为`ActionSupport`，您可能想检查它是否可以转换为 a `TextProvider`，这是您真正感兴趣的。

我不确定您对迭代器的问题是什么——应该这样做，因为您的目标是遍历堆栈并尝试使用 top-most `TextProvider`。您可能不想*停留*在最顶层，这取决于您的需求/目标。

# mysql - MySQL 使用固定表引用更容易加入

> ID：11632226
> 
> 赞同：0
> 
> 时间：2012-07-24T13:44:31.457
> 
> 标签：mysql, join

我开始学习/使用 SQL，我想知道是否可以使使用更容易。我有相互引用的 ID 表。所以我经常发出这样的查询

```
SELECT ...
FROM Object o
JOIN Property p on o.uid=p.object_uid AND ... 
```

还有其他具有类似 ID 引用的表。有没有一种舒适的方法可以避免一遍又一遍地写出这些 ID 子句？我的意思是特定的对象表将始终以这种方式引用属性表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T13:51:07.713

据我所知，通过使用别名功能，您正在尽最大努力缩短查询。

或者有一个更短的语法，但两个表中只有一个相似的字段

```
 a LEFT JOIN b USING (c1,c2,c3) 
```

[http://dev.mysql.com/doc/refman/5.0/en/join.html](http://dev.mysql.com/doc/refman/5.0/en/join.html)

祝一切顺利

# java - eclipse 动态 web 项目 - 默认起始页

> ID：11632227
> 
> 赞同：11
> 
> 时间：2012-07-24T13:44:32.780
> 
> 标签：java, eclipse, jsp, project

我在 Eclipse 动态 Web 项目中创建，我在 WEB-INF 文件夹中有 index.html。我单击项目的主文件夹 Run as > Run on server 选择 Tomcat v7.0，完成，它运行正常。但是，当我将 index.html 重命名为另一个名称时，我会收到以下消息：

> 请求的资源 (/MyProject/) 不可用。

1.  如何更改默认页面？
2.  我可以放入默认页面 asp 文件吗？

我的 web.xml 是：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>MyFirstServlet</display-name>
  <welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.htm</welcome-file>
    <welcome-file>index.jsp</welcome-file>
    <welcome-file>default.html</welcome-file>
    <welcome-file>default.htm</welcome-file>
    <welcome-file>default.jsp</welcome-file>
  </welcome-file-list>
  <servlet>
    <description>new</description>
    <display-name>GrettingServlet</display-name>
    <servlet-name>GrettingServlet</servlet-name>
    <servlet-class>GrettingServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>GrettingServlet</servlet-name>
    <url-pattern>/GrettingServlet</url-pattern>
  </servlet-mapping>
</web-app> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-24T13:50:24.770

在 web.xml（在 TOMCAT_HOME/webapps/you_application 下）你有这个：

```
<welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.htm</welcome-file>
    <welcome-file>index.jsp</welcome-file>
    <welcome-file>default.html</welcome-file>
    <welcome-file>default.htm</welcome-file>
    <welcome-file>default.jsp</welcome-file>
    <welcome-file>/axis2-web/index.jsp</welcome-file>
  </welcome-file-list> 
```

更改为您的新文件名

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-24T13:50:32.290

1）如何更改默认页面？

=> 更改 web.xml 中的欢迎文件列表。更改为您使用的所需文件名。

2) 我可以放入默认页面 asp 文件吗？

=> 您可以将扩展名更改为 asp，但您需要 web.xml 中的 servlet 映射。但是，如果您在谈论`Microsoft ASP pages`，我认为您将无法根据我的知识添加它们，因为两者（jsp 和 asp）都驻留在不同的技术下

**编辑 ：**

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>MyFirstServlet</display-name>
  <welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.htm</welcome-file>
    <welcome-file>index.jsp</welcome-file>
    <welcome-file>default.html</welcome-file>
    <welcome-file>default.htm</welcome-file>
    <welcome-file>default.jsp</welcome-file>
  </welcome-file-list>
  <servlet>
    <description>new</description>
    <display-name>GrettingServlet</display-name>
    <servlet-name>GrettingServlet</servlet-name>
    <servlet-class>GrettingServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>GrettingServlet</servlet-name>
    <url-pattern>/greetings.asp</url-pattern>
  </servlet-mapping>
</web-app> 
```

在这里您将请求`GreetingServlet`使用 url`http://localhost:8080/myapp/greetings.asp`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-24T13:47:57.527

几件事情要检查。

```
1) Servlet mapping extension in web.xml
2) Welcome file definition in web.xml 
```

确保扩展名和名称与您更改时一样。

`web.xml`将在`WEB-INF`文件夹内。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-25T23:21:49.310

当出现 404 错误时也会发生这种情况，Tomcat 默认搜索索引文件。jsp/html ，您必须从 Tomcat Eclipse 的 web.xml 文件中的 Tomcat 文件夹或安装的文件夹系统中更改它（c/files Program/apache ...） o [查看此示例](https://i.stack.imgur.com/bMmwA.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-17T12:36:20.860

打开Eclipse->单击服务器->在localhost-config选择**Tomcat v9.0 Server->选择****“web.xml”** ->滚动到底部或找到“”-> **“filename.xml”**

![图片](../Images/fcb9dd13578e5bb4d5882cfdcdb27624.png)

# python - 从 Python 读取 DBISAM“dat”文件

> ID：11632230
> 
> 赞同：-4
> 
> 时间：2012-07-24T13:44:37.983
> 
> 标签：python, odbc, pyodbc

如何读取 DBISAM 数据文件？我需要在linux上做。

请给我任何链接，文档，驱动程序...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:54:26.413

谷歌快速搜索发现，Elevate 软件早在 1 月份就表示无法在 Linux 上访问 DBISAM。这是[文章的链接](http://www.elevatesoft.com/forums?action=view&category=dbisam&id=dbisam_odbc&msg=1865&page=1)

如果您可以将 DBISAM 文件保存在 Windows 上并将 Elevate Software 的 ODBC 驱动程序安装为系统 DSN，那么您可以在 Linux 上使用任何 ODBC 应用程序以及[Easysoft ODBC-ODBC Bridge](http://www.easysoft.com/products/data_access/odbc_odbc_bridge/index.html)访问您的数据。

# unicode - _wfopen 没有使用 16 位 wchar_t 字符串生成正确的文件名

> ID：11632236
> 
> 赞同：0
> 
> 时间：2012-07-24T13:44:50.663
> 
> 标签：unicode, mingw, utf-16

当我完全像这样编码时：

```
 setlocale(LC_ALL,"");
   wchar_t myString2[] = { 0x0061, 0x2660, 0x2663, 0x2665, 0x2666, 0x0000 };
   fd = _wfopen(myString2, L"w"); 
```

或者

```
 fd = _wfopen(myString2, L"w, ccs=UTF-16"); 
```

结果不是我所期望的。预期：a♠♣♥♦，但 explorer 出现 a 和 4 个小方块。但是，当我在资源管理器中输入文件重命名，然后复制文件名时，它会正确插入到编辑器中。当我输入显示此类字符的文件名时，或者假设在编辑器中复制和粘贴中文字符时，编辑器会在文件名中显示小方块。使用 -fexec-charset=xxxx 的实验甚至不会产生预期的结果。鉴于复制和粘贴实验的结果，我猜想正在发生一些非常愚蠢的事情。这是真的，解决方案应该非常简单......

系统：Win XP、Mingw 20120426、Ansi-C - 所以不需要 STLport。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T13:50:03.643

这只是字体问题。编辑器显然更聪明地为文件名中的字形选择合适的字体。值得一提的是，在 Windows 7 上，Far（使用 Consolas）和 Explorer（使用 Segoe UI）都可以正确显示文件名：

![在此处输入图像描述](../Images/73fae298baa8dc69e1c2ac50aa0d5752.png) ![在此处输入图像描述](../Images/c4388b0445a078fae9515532e2c459f9.png)

但如前所述，数据是正确的；这只是一个显示问题。

# javascript - 如何通过 JS 获取网站实际的 HTML 代码？

> ID：11632238
> 
> 赞同：-2
> 
> 时间：2012-07-24T13:44:54.037
> 
> 标签：javascript, html, dom

我有一个带有表格的网站。表单由用户填写数据，例如我向用户显示：

```
 <input type='text' value="" name="dsa" /> 
```

他用“3”的值填充它；

然后他点击“保存”按钮。现在我想拥有网站的整个 HTML，包括字段的值。所以我使用：

document.documentElement.innerHTML

但我得到：

```
 <input type='text' value="" name="dsa" /> 
```

但我想得到这个：

```
 <input type='text' value="3" name="dsa" /> 
```

注意 我想获取网站的整个 HTML，而不仅仅是一个字段。我不知道网站上会有哪些字段，所以我需要一个通用的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:48:11.037

AFAIK 您无法从 HTML 代码中获得此信息，因为当用户在 Input 文本字段中输入内容时，HTML 代码不会更改。

您可以做的是获取页面上的所有输入字段并通过以下方式获取它们的值：

```
var inputs, index;

inputs = document.getElementsByTagName('input');
for (index = 0; index < inputs.length; ++index) {
    // deal with inputs[index] element.
} 
```

代码来自这篇文章：[https](https://stackoverflow.com/a/2214077/312312) ://stackoverflow.com/a/2214077/312312 我懒得把它写下来：P

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T13:52:53.593

在 jQuery 我做

```
$(function() {
    $('input').keyup(function() {
       $(this).attr('value', $(this).val());
    }); 

});​ 
```

因为 key up 后没有设置 value 属性

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-24T14:07:27.637

您可以尝试在整个文档上设置实时事件，将属性设置为带有用户设置值的 html 或在您的提交中设置它们。

以第一种方式为例

```
$("body").on("change", "select,input,textarea", function(){
  $(this).attr("value", $(this).val());
}); 
```

但这不应该如此盲目地进行，您会遇到重置问题。您应该解决选定单选、复选框和其他属性的问题，而不仅仅是值。

第二种方法是在真正需要时序列化整个页面。

```
var serialize = function(el){
   $("select, input, textarea").each(function(){
     $(this).attr("value", $(this).val()); //the same way as upper
   });
}
$(".serialize").click(function(){
  var inner = $("body"),
      html;
  serialize(inner);
  html = inner.html(); //here you will get whole html with setted attributes
}); 
```

这种方式似乎更好，因为不会有不必要的事件委托。

[http://jsfiddle.net/CeAXL/2/](http://jsfiddle.net/CeAXL/2/) - 测试示例。

但在这两种方式中，为 DOM 本身设置永久值并不是一个好主意。

# ruby-on-rails - “NoMethodError: undefined method `destroy' for nil:NilClass”当单元测试 Rails 模型时

> ID：11632240
> 
> 赞同：1
> 
> 时间：2012-07-24T13:45:02.570
> 
> 标签：ruby-on-rails, ruby, unit-testing, model

我正在创建一个 Rails 应用程序（这方面相当新），并且我有一个不使用脚手架生成的客户端模型。我已经运行了“rake db:migrate”，并且正在使用“rake test:units”对模型进行单元测试，但是我在终端中得到了以下运行时错误的变体，几乎用于我所有的工厂测试。

```
test: Creating seven clients should show that all factories are properly created. (ClientTest):
NoMethodError: undefined method `destroy' for nil:NilClass
    /Users/myUserName/Desktop/app_name/test/unit/client_test.rb:131:in `block (2 levels) in <class:ClientTest>' 
```

我一直无法弄清楚错误是什么。我知道它无法识别客户端类，因此找不到 nil 的“销毁”方法。但是，我不确定如何解决它。

下面是我的模型代码，位于 app_name/app/models/client.rb

```
class Client < ActiveRecord::Base
  # Callbacks
  before_save :reformat_phone

  # Relationships
  has_many :assignments
  has_many :counselors, :through => :assignments
  has_many :interventions, :through => :assignments

  # Validations
  validates_presence_of :first_name, :last_name, :gender, :address, :city, :state, :zip, :phone, :active
  validates_inclusion_of :gender, :in => %w[male female], :message => "is not an option"
  validates_inclusion_of :marital_status, :in => %w[single married separated divorced], :message => "is not an option"
  validates_inclusion_of :state, :in => %w[PA OH WV], :message => "is not an option"
  validates_format_of :zip, :with => /^\d{5}$/, :message => "should be five digits long"
  validates_format_of :phone, :with => /^\(?\d{3}\)?[-. ]?\d{3}[-.]?\d{4}$/, :message => "should be 10 digits (area code needed) and delimited with dashes only"

  # Scopes
  scope :active, where('active = ?', true)
  scope :inactive, where('active = ?', false)
  scope :alphabetical, order('last_name, first_name')

  scope :receiving_gov_assistance, where('gov_assistance = ?', true)
  scope :not_receiving_gov_assistance, where('gov_assistance = ?', false)

  scope :male, where('gender = ?', 'male')
  scope :female, where('gender = ?', 'female')

  scope :by_marital_status, lambda { |status| where("marital_status = ?", status) }
  scope :by_ethnicity, lambda { |race| where("ethnicity = ?", race) }

  scope :employed, where('is_employed = ?', true)
  scope :unemployed, where('is_employed = ?', false)

  scope :veteran, where('is_veteran = ?', true)

  scope :assigned, where('current_assignment != ?', nil)
  scope :unassigned, where('current_assignment = ?', nil) 

# Other methods
  def name
    "#{last_name}, #{first_name}"
  end

  def proper_name
    "#{first_name} #{last_name}"
  end

  def current_assignment
    curr_assignment = self.assignments.select{|a| a.end_date.nil?}
    # alternative method for finding current assignment is to use scope 'current' in assignments:
    # curr_assignment = self.assignments.current    # will also return an array of current assignments
    return nil if curr_assignment.empty?
    curr_assignment.first   # return as a single object, not an array
  end

  # Misc Constants
  GENDER_LIST = [['Male', 'male'],['Female', 'female']]
  STATES_LIST = [['Ohio', 'OH'],['Pennsylvania', 'PA'],['West Virginia', 'WV']]

  # Callback code
  # -----------------------------
  private
  def reformat_phone
    phone = self.phone.to_s  # change to string in case input as all numbers 
    phone.gsub!(/[^0-9]/,"") # strip all non-digits
    self.phone = phone       # reset self.phone to new string
  end
end 
```

这是我编写的测试，位于 app_name/test/unit/client_test.rb

```
require 'test_helper'

class ClientTest < ActiveSupport::TestCase
  # Test relationships
  should have_many(:assignments)
  should have_many(:deacons).through(:assignments)
  should have_many(:interventions).through(:assignments)

  # Test basic validations
  should validate_presence_of(:last_name)
  should validate_presence_of(:first_name)
  should validate_presence_of(:gender)
  should validate_presence_of(:address)
  should validate_presence_of(:city)
  should validate_presence_of(:state)
  should validate_presence_of(:zip)
  should validate_presence_of(:phone)
  should validate_presence_of(:active)

  # Identity-based tests
      # tests for gender
      should allow_value("male").for(:gender)
      should allow_value("female").for(:gender)

      should_not allow_value(nil).for(:gender)
      should_not allow_value(1).for(:gender)
      should_not allow_value("seahorse").for(:gender)
      should_not allow_value("I believe gender is a societal construct.").for(:gender)

      # tests for ethnicity
      should allow_value("Asian").for(:ethnicity)
      should allow_value("Black").for(:ethnicity)
      should allow_value("Hispanic").for(:ethnicity)
      should allow_value("Latino").for(:ethnicity)
      should allow_value("Native American").for(:ethnicity)
      should allow_value("White").for(:ethnicity)

      should_not allow_value(nil).for(:ethnicity)
      should_not allow_value(1).for(:ethnicity)
      should_not allow_value(true).for(:ethnicity)
      should_not allow_value(0.5).for(:ethnicity)

      # tests for marital status
      should allow_value("single").for(:marital_status)
      should allow_value("married").for(:marital_status)
      should allow_value("separated").for(:marital_status)
      should allow_value("divorced").for(:marital_status)

      should_not allow_value("White").for(:marital_status)
      should_not allow_value(nil).for(:marital_status)
      should_not allow_value(1).for(:marital_status)
      should_not allow_value(true).for(:marital_status)
      should_not allow_value("I believe marriage is a societal construct.").for(:marital_status)

  # Contact-based Tests
      # tests for address
      should allow_value("123 Example Lane").for(:address)
      should allow_value("456 Another Street").for(:address)

      should_not allow_value(true).for(:address)
      should_not allow_value(101).for(:address)
      should_not allow_value(nil).for(:address)

      # tests for zip
      should allow_value("12345").for(:zip)

      should_not allow_value("bad").for(:zip)
      should_not allow_value("1234").for(:zip)
      should_not allow_value("123456").for(:zip)
      should_not allow_value("12345-6789").for(:zip)

      # tests for state
      should allow_value("OH").for(:state)
      should allow_value("PA").for(:state)
      should allow_value("WV").for(:state)
      should_not allow_value("bad").for(:state)
      should_not allow_value("NY").for(:state)
      should_not allow_value(10).for(:state)
      should_not allow_value("CA").for(:state)

      # tests for phone
      should allow_value("4122683259").for(:phone)
      should allow_value("412-268-3259").for(:phone)
      should allow_value("412.268.3259").for(:phone)
      should allow_value("(412) 268-3259").for(:phone)
      should_not allow_value("2683259").for(:phone)
      should_not allow_value("14122683259").for(:phone)
      should_not allow_value("4122683259x224").for(:phone)
      should_not allow_value("800-EAT-FOOD").for(:phone)
      should_not allow_value("412/268/3259").for(:phone)
      should_not allow_value("412-2683-259").for(:phone)

  # Assistance-based tests
      # tests for gov_assistance
      should allow_value(true).for(:gov_assistance)
      should allow_value(false).for(:gov_assistance)

      should_not allow_value(150).for(:gov_assistance)
      should_not allow_value("Yes").for(:gov_assistance)

      # tests for is_employed
      should allow_value(true).for(:is_employed)
      should allow_value(false).for(:is_employed)

      should_not allow_value(30000).for(:is_employed)
      should_not allow_value("Movie theater usher").for(:is_employed)

      # tests for is_veteran
      should allow_value(true).for(:is_veteran)
      should allow_value(false).for(:is_veteran)

      should_not allow_value(nil).for(:is_veteran)
      should_not allow_value("Marines").for(:is_veteran)

  # Establish context
  # Testing other methods with a context
  context "Creating seven clients" do
    setup do 
      @dan = FactoryGirl.create(:client)
      @barney = FactoryGirl.create(:client, :last_name => "Saha", :first_name => "Barney", :active => false, :ethnicity => "Indian" )
      @ryan = FactoryGirl.create(:client, :last_name => "Black", :first_name => "Ryan", :phone => "412-867-5309", :ethnicity => "White", :gov_assistance => true )
      @joe = FactoryGirl.create(:client, :last_name => "Oak", :first_name => "Joseph", :ethnicity => "Asian", :is_employed => false )
      @mary = FactoryGirl.create(:client, :last_name => "Clute", :first_name => "Mary", :gender => "female", :ethnicity => "White" )
      @jon = FactoryGirl.create(:client, :last_name => "Carreon", :first_name => "Jon", :is_veteran => true )
      @meg = FactoryGirl.create(:client, :last_name => "Smith", :first_name => "Megan", :ethnicity => "White", :gender => "female", :is_employed => false)
    end

    # and provide a teardown method as well
    teardown do
      @dan.destroy
      @barney.destroy
      @ryan.destroy
      @joe.destroy
      @mary.destroy
      @jon.destroy
      @meg.destroy
    end

    # test one of each factory
    should "show that all factories are properly created" do
      assert_equal "Tabrizi", @dan.last_name
      assert @ryan.active
      assert @joe.active
      assert_equal "Mary", @mary.first_name
      assert @jon.active
      assert @meg.active
      deny @barney.active
    end

    # test the callback is working 'reformat_phone'
    should "shows that Ryan's phone is stripped of non-digits" do
      assert_equal "4128675309", @ryan.phone
    end

    # test the scope 'alphabetical'
    should "shows that there are seven clients in in alphabetical order" do
      assert_equal ["Black", "Carreon", "Clute", "Oak", "Saha", "Smith", "Tabrizi"], Client.alphabetical.map{|s| s.last_name}
    end

    # test the scope 'active'
    should "shows that there are six active clients" do
      assert_equal 2, Client.active.size
      assert_equal ["Black", "Carreon", "Clute", "Oak", "Smith", "Tabrizi"], Client.active.alphabetical.map{|s| s.last_name}
    end

    # test the scope 'inactive'
    should "shows that there is one inactive client" do
      assert_equal 1, Client.inactive.size
      assert_equal ["Saha"], Client.inactive.alphabetical.map{|s| s.last_name}
    end

    # test the scope 'receiving_gov_assistance'
    should "shows that there is one client receiving government assistance" do
      assert_equal 1, Client.receiving_gov_assistance.size
      assert_equal ["Black"], Client.receiving_gov_assistance.alphabetical.map{|s| s.last_name}
    end

    # test the scope 'not_receiving_gov_assistance'
    should "shows that there are six clients not receiving government assistance" do
      assert_equal 6, Client.not_receiving_gov_assistance.size
      assert_equal ["Carreon", "Clute", "Oak", "Saha", "Smith", "Tabrizi"], Client.not_receiving_gov_assistance.alphabetical.map{|s| s.last_name}
    end

    # test the scope 'male'
    should "shows that there are five male clients" do
      assert_equal 6, Client.male.size
      assert_equal ["Black", "Carreon", "Oak", "Saha", "Tabrizi"], Client.male.alphabetical.map{|s| s.last_name}
    end

    # test the scope 'female'
    should "shows that there are two female clients" do
      assert_equal 2, Client.female.size
      assert_equal ["Clute", "Smith"], Client.female.alphabetical.map{|s| s.last_name}
    end

    # test the scope 'employed'
    should "shows that there are five employed clients" do
      assert_equal 5, Client.employed.size
      assert_equal ["Black", "Carreon", "Clute", "Saha", "Tabrizi"], Client.employed.alphabetical.map{|s| s.last_name}
    end

    # test the scope 'unemployed'
    should "shows that there are two unemployed clients" do
      assert_equal 2, Client.unemployed.size
      assert_equal ["Oak", "Smith"], Client.unemployed.alphabetical.map{|s| s.last_name}
    end

    # test the scope 'veteran'
    should "shows that there is one employed clients" do
      assert_equal 1, Client.veteran.size
      assert_equal ["Carreon"], Client.veteran.alphabetical.map{|s| s.last_name}
    end

    # test the method 'name' #DONE
    should "shows name as last, first name" do
      assert_equal "Tabrizi, Dan", @dan.name
    end   

    # test the method 'proper_name' #DONE
    should "shows proper name as first and last name" do
      assert_equal "Dan Tabrizi", @dan.proper_name
    end 

  end
end 
```

非常感谢您的帮助。如果有任何其他文件需要确定问题，请告诉我。抱歉，如果这很简单或太模糊，我是 Rails 开发的新手，我正在尽我所知使用术语

编辑

以下是我目前的客户工厂，在 app_name/test/factories.rb

```
FactoryGirl.define do
  factory :client do
    last_name "Tabrizi"
    first_name "Dan"
    gender "male"
    ethnicity "Hispanic"
    marital_status "single"
    address "123 Example Lane"
    city "Anytown"
    state "PA"
    zip "12345"
    phone { rand(10 ** 10).to_s.rjust(10,'0') }
    gov_assistance false
    is_employed true
    is_veteran false
    active true
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:18:51.553

希望您对单独的测试数据库执行测试，所以这样做是安全的：

```
teardown do
  Client.destroy_all
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:55:57.793

就像西蒙建议的那样，尝试评论或删除您的拆解。通常在这些情况下，teardown 会掩盖真正的错误，因为它会编译您的所有代码并尝试启动将失败的 destroy 方法，因为您的工厂将返回 nil。由于发生这种情况，它将返回记录的最后一个错误，这就是您收到该错误的原因。

# asp.net - sessionState 模式="InProc" 时的 Response.Cookies

> ID：11632243
> 
> 赞同：0
> 
> 时间：2012-07-24T13:45:14.207
> 
> 标签：asp.net, vb.net, web-config

我想知道下面的代码在做什么？什么时候`sessionState`模式是`"InProc"`正确的？
`Response.Cookies(My.Settings.TESTSessionCookieName).Expires = DateTime.Now.AddYears(-1)`
为什么以前的开发人员使用上面的代码而不是`Sessioin timeout="20"`删除会话。

*网络配置*

```
<sessionState mode="InProc" cookieName="TESTSession" timeout="20">
    <setting name="TESTSessionCookieName" serializeAs="String">
        <value>TESTSession</value>
    </setting> 
```

*aspx.page.vb*

```
Session.Abandon()
Response.Cookies(My.Settings.TESTSessionCookieName).Expires = DateTime.Now.AddYears(-1)
Response.Redirect(My.Settings.generalErrorURL) 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T13:49:11.400

该代码正在过期其会话（放弃和 cookie 值）。InProc 是默认的会话存储机制，所有数据都存储在 IN PROCess 中。Session Timeout = "20" 不会删除他们的会话，它只是意味着会话将持续 20 分钟而不会在到期前刷新。

# c# - 非回溯子表达式如何工作“（？> exp）”

> ID：11632247
> 
> 赞同：10
> 
> 时间：2012-07-24T13:45:17.747
> 
> 标签：c#, .net, regex

我正在努力在正则表达式方面做得更好。我很难理解是什么`(?> expression )`意思。我在哪里可以找到有关非回溯子表达式的更多信息？[这个](http://www.codeproject.com/Articles/9099/The-30-Minute-Regex-Tutorial)链接的描述说：

> 贪心子表达式，也称为非回溯子表达式。这仅匹配一次，然后不参与回溯。

这个其他链接： http: [//msdn.microsoft.com/en-us/library/bs2twtah](http://msdn.microsoft.com/en-us/library/bs2twtah(v=vs.71).aspx) (v=vs.71).aspx也有非回溯子表达式的定义，**但我仍然很难理解它是什么意味着加上我想不出一个我将使用的例子`(?>exp)`**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-24T13:54:00.547

与往常一样，[regular-expressions.info](http://www.regular-expressions.info/atomic.html)是一个不错的起点。

如果您想确保曾经匹配的任何内容都将保留在匹配中，请使用原子组。

例如，要匹配一些可能由空格分隔或不由空格分隔的“单词”，然后是冒号，用户尝试了正则表达式：

```
(?:[A-Za-z0-9_.&,-]+\s*)+: 
```

有比赛的时候，一切都很好。但是如果没有，他的 PC 会因为灾难性的回溯而在 100% 的 CPU 负载下变得无响应，因为正则表达式引擎会徒劳地尝试找到允许以下冒号匹配的单词的匹配组合。这当然是不可能的。

通过使用原子组，可以避免这种情况：

```
(?>[A-Za-z0-9_.&,-]+\s*)+: 
```

现在任何匹配的东西都保持匹配 - 没有回溯，因此失败时间很快。

我最近遇到的另一个很好的例子：

如果您想匹配所有后面没有 ASCII 字母的数字，您可能需要使用 regex `\d+(?![A-Za-z])`。但是，这会因输入失败而失败，`123a`因为正则表达式引擎会很高兴地`12`通过回溯返回匹配项，直到后面的字符不再是字母。如果您使用`(?>\d+)(?![A-Za-z])`，则不会发生这种情况。（当然，`\d+(?![\dA-Za-z])`也可以）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-24T13:54:17.060

正则表达式教程在这里有一个页面：[http ://www.regular-expressions.info/atomic.html](http://www.regular-expressions.info/atomic.html)

基本上它所做的是丢弃回溯信息，这意味着`a(?>bc|b)c`匹配`abcc`但不匹配`abc`。

它与第二个字符串不匹配的原因是它找到了与 的匹配项，并丢弃了有关交替`bc`的回溯信息。`bc|b`它基本上忘记了`|b`它的一部分。因此，`c`后面没有`bc`，匹配失败。

使用原子组最有用的方法是优化慢正则表达式。您可以在上述页面上找到更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T13:55:04.623

阅读[所有格量词](http://www.regular-expressions.info/possessive.html) `[a-z]*+`使回溯引擎只记住与之前所有匹配的步骤不匹配的上一步。

当可能有很多可接受的步骤时，这很有用，如果每个步骤都存储用于任何可能的回溯回归，它们会占用内存。

占有量词是原子团的简写。

# scripting - 从VB脚本中的txt文件中读取多个变量

> ID：11632249
> 
> 赞同：1
> 
> 时间：2012-07-24T13:45:27.483
> 
> 标签：scripting, vbscript, windows-scripting, filesystemobject

我希望能够一次将两个变量读入 VBScript。我正在做的是从一堆 HTML 文件中替换某些文本。我已经编写了一个脚本来执行此操作，但我一次只能输入一组文本。命令行示例：

C:> 替换.vbs (OldText) (NewText)

其中 (OldText) 和 (NewText) 都是参数。

```
strOldText = WScript.Arguments.Item(0)
strNewText = WScript.Arguments.Item(1) 
```

有没有办法设置一个文本文件，如：

```
(OldText) (NewText)
(OldText) (NewText)
(OldText) (NewText)
(OldText) (NewText) 
```

并让脚本一次读一个？

我的查找和替换代码完美运行。我只想自动化脚本以从文本文件中读取参数，而不是在命令提示符下一次输入一个参数。

任何帮助是极大的赞赏。如果需要更多信息，请告诉我。我希望这很清楚。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T15:11:48.433

你在寻找这样的东西吗？

```
strDelimiter = " "

strInfilePath = "C:\Path to file to read.txt"

Const ForReading = 1

Set objFso    = CreateObject("Scripting.FileSystemObject")
Set objInfile = objFso.OpenTextFile(strInfilePath, ForReading)

Do While Not objInfile.AtEndOfStream
    strLine    = objInfile.ReadLine
    arrParts   = Split(strLine, strDelimiter)
    strOldText = arrParts(0)
    strNewText = arrParts(1)
Loop 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T15:18:27.527

我可能会使用 PowerShell 来完成整个事情，而不仅仅是调用脚本，但我认为这应该可行。如果没有，问题可能在于我在示例中如何尝试调用 vbscript。

电源外壳：

```
Import-CSV textReplace.csv | % {
    wscript.exe replace.vbs $_.OldText $_.NewText
} 
```

CSV 内容：

```
OldText,NewText
"String 1","String 2"
"String 3,"String 4" 
```

# c# - 我可以从另一处获得一个附加财产的价值吗？

> ID：11632250
> 
> 赞同：0
> 
> 时间：2012-07-24T13:45:31.010
> 
> 标签：c#, xaml

如果我在一个对象上有两个附加属性

1.  资源
2.  目标

是否可以从目标属性的属性更改方法中查询到源附加属性的值，还是它们彼此不知道？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:51:36.570

当然，我一直在为需要检索 CommandParameter 对象的附加 ICommand 属性执行此操作。

例如：

```
private static void HandleKeyDown(object sender, KeyEventArgs e)
{
  var param = sender.GetValue(CommmandParameterProperty);
  GetKeyDownCommand((UIElement)sender).Execute(param);
} 
```

# android - Google 应用程序中使用了什么样的布局？

> ID：11632259
> 
> 赞同：1
> 
> 时间：2012-07-24T13:46:23.037
> 
> 标签：android

有谁知道 Android 应用中的 Google+ 流使用哪种布局？它是 GridLayout 还是自定义布局？

我正在为我的应用程序尝试 GridView，但据我发现，不可能为 GridView 中的项目提供两列的宽度，还是我遗漏了什么？GridLayout 会是显示多个（最多 50 个）视图的有效方式吗？

谢谢！

# mysql - sql查询来计算标记的帖子

> ID：11632260
> 
> 赞同：2
> 
> 时间：2012-07-24T13:46:26.080
> 
> 标签：mysql, sql, database

我有一张表，`newsPosts`我在该表中有一个列`tags`。标签列包含`comma(,)`这样的单独标签。

```
tag1,tag2,tag3 
```

在另一个表中，我在标签列下列出了所有标签，如下所示：

**标签**

```
tag1
tag2
tag3
tag4
.
.
.
. 
```

我想从新闻帖子表中查找带有say tag2 标记的帖子数量。

我怎样才能做到这一点 ？我在用`mysql 5.0`

**编辑 ：：**

我想要做的是 ::: 查找使用次数最多的标签来标记新闻帖子。

像这样 ：

```
 tag1 x 100 times
    tag2 x 1000times
                 .
                 .
    tagN x 500 times 
```

tag2 应该出现在结果的顶部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:51:26.107

说啊

```
SELECT * FROM newsPosts WHERE tags LIKE '%tag2%' 
```

## [在 sqlfiddle 演示](http://sqlfiddle.com/#!2/e68d0/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T13:49:31.530

这应该有效：

```
SELECT * FROM newPosts WHERE tags LIKE "%tag2%"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T13:55:14.023

它应该适用于所有标签`tags table`：

```
SELECT tag, (SELECT COUNT(1) 
             FROM tag_newPosts t2
             WHERE t2.tag LIKE CONCAT('%',t1.tag,'%')) AS tag_count
FROM tags t1; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T13:57:05.303

您可以使用正则表达式进行查询：

```
select *
from newsPosts
where tags regexp '(^|,)tag2(,|$)' 
```

此表达式可防止包含在其他标签中的标签进入查询结果。例如，它将选择带有 的项目`tag2`，但不选择带有 的项目`mytag22`。

# php - 如何验证是否禁用缓存（IE7）？

> ID：11632261
> 
> 赞同：0
> 
> 时间：2012-07-24T13:46:32.280
> 
> 标签：php, html, internet-explorer-7, pdflib, no-cache

我正在开发一个应用程序，该应用程序利用 PDFLib 为我的用户提供总结其帐户的动态 PDF 文件，并且需要确保这些页面没有被缓存（传递了一些敏感数据，出于安全原因，我不能将其存储在缓存中）。

我尝试使用以下代码：

```
Header("Expires:-1");
Header("Last-Modified: " . gmdate("D, d M Y H:i:s") . " GMT");
Header("Cache-Control: no-store, no-cache, must-revalidate");
Header("Cache-Control: post-check=0, pre-check=0", false);
Header("Pragma:no-cache"); 
```

首先，我没有可靠的方法来测试 IE7 是否不缓存页面，所以我的第一个问题是“我如何测试以确保我的无缓存标头正常工作？”

其次，在我将这些行添加到我的代码后，PDF 停止在 IE7 中显示。当我删除线条时，它工作正常。有人对如何避免这种行为有任何想法吗？

提前致谢！

**编辑：**第一个问题已经回答；我应该单独问他们。我的第二个问题是“如何避免 IE7 在发送无缓存标头时不呈现我的 PDFLib 页面的行为？” 仍然活跃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T13:50:00.427

要检查页面是否被缓存，请更改并刷新。请注意，`Expires`标头应包含日期，因此 的值`-1`无效。尝试使用过去的日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T13:02:13.493

我实际上找到了 IE 7 的**调试栏** [http://www.debugbar.com/download.php](http://www.debugbar.com/download.php)，它显示了所有的标题和缓存信息。我使用 HTTP(S) 选项卡，选择我的文档并查看下面的“信息和缓存”。一旦我掌握了窍门，真的很容易。

# database - 如何将 R 列表对象保存到数据库中？

> ID：11632264
> 
> 赞同：4
> 
> 时间：2012-07-24T13:46:38.527
> 
> 标签：database, r, nosql

假设我有一个 R 对象列表，它们本身就是列表。每个列表都有一个定义的结构：数据、适合数据的模型和一些用于识别数据的属性。一个例子是特定国家某些经济指标的时间序列。所以我的列表对象有以下元素：

`data`- 经济指标的历史时间序列

`country`- 国家名称，例如美国

`name`- 指标名称，例如 GDP

`model`- 以合适的格式找到的 ARIMA 订单`auto.arima`，这又可能是一个列表。

这只是一个例子。正如我所说，假设我有许多这样的对象组合成一个列表。我想把它保存成一些合适的格式。显而易见的解决方案是简单地使用`save`，但这对于大量对象来说不能很好地扩展。例如，如果我只想检查对象的子集，则需要将所有对象加载到内存中。

如果我的数据是一个，`data.frame` 我可以将它保存到数据库中。如果我想处理特定的数据子集，我会使用 SELECT 并依靠数据库来提供所需的子集。SQLite 在这方面为我提供了很好的帮助。是否可以使用 MongoDB 等花哨的数据库为我描述的列表对象复制这个？或者我应该简单地考虑如何将我的列表转换为几个相关的表？

我这样做的动机是能够轻松地生成有关拟合模型的各种报告。我可以编写一堆函数来生成给定对象的一些报告，然后只`lapply`在我的对象列表中使用。理想情况下，我想并行化这个过程，但这是另一个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T13:59:48.750

我想我以前曾在某个地方解释过这个基础知识——它的要点是

*   R 内置了完整的序列化和反序列化支持，因此您实际上可以获取任何现有的 R 对象并将其转换为二进制或文本序列化。我的摘要包使用它来使用不同的函数将序列化转换为哈希

*   R 具有您需要的所有数据库连接。

现在，什么是合适的格式和数据库模式......将取决于您的具体情况。但是（像往常一样）R中没有任何东西阻止你:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-08T20:49:47.637

这个问题已经很久没有活动了。由于我最近有类似的担忧，因此我想添加我发现的信息。我在问题中认识到这三个要求：

*   将数据存储在合适的结构中
*   在大小和访问时间方面的可扩展性
*   有效地仅读取数据子集的可能性

除了使用关系数据库的选项之外，还可以使用`HDF5`旨在存储大量可能的大型对象的文件格式。选择取决于数据的类型和访问它的预期方式。

在以下情况下应优先使用关系数据库：

*   原子数据项是小型的
*   不同的数据项具有相同的结构
*   没有预期数据将在哪些子集中被读出
*   将数据从一台计算机方便地传输到另一台计算机不是问题，或者需要数据的计算机可以访问数据库。

如果出现以下情况，应首选 HDF5 格式：

*   原子数据项本身就是大对象（例如矩阵）
*   数据项是异构的，不可能将它们组合成一个类似表的表示
*   大多数情况下，数据是按预先知道的分组读出的
*   将数据从一台计算机移动到另一台计算机应该不需要太多努力

此外，可以区分`relational`和`hierarchial`关系，其中后者包含在前者中。在 HDF5 文件中，信息块可以分层排列，例如：

```
/Germany/GDP/model/...
/Germany/GNP/data
/Austria/GNP/model/...
/Austria/GDP/data 
```

[Bioconductor](http://www.bioconductor.org/packages/2.12/bioc/html/rhdf5.html)`rhdf5`上提供了用于处理 HDF5 文件的软件包。有关 HDF5 格式的一般信息可[在此处](http://www.hdfgroup.org/HDF5/)获得。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T17:17:55.897

不确定是否相同，但我对时间序列对象有一些很好的经验：

```
str() 
```

也许你可以调查一下。

# php - imap 电子邮件解析的编码

> ID：11632265
> 
> 赞同：3
> 
> 时间：2012-07-24T13:46:48.803
> 
> 标签：php, parsing, character-encoding, imap, gmail-imap

当我尝试通过`PHP imap functions`. 我想提取正文的文本，但没有 HTML 链接（如 mailto:xxxx）或编码问题。我想我已经尝试了（几乎，我猜）一切。但是，我接近所需最终结果的唯一代码是下一个：

```
$bodyText = imap_fetchbody($inbox,$email_number,1.2);

if(!strlen($bodyText)>0)
{
   $bodyText = imap_fetchbody($inbox,$email_number,1);
}

var_dump($bodyText); 
```

关键是我遇到了最终编码的问题（我认为这是问题所在）。所以 var_dump 输出类似于：

```
> From: SomeOne <someone=40domain.com>
> To: Someone Else <someoneelse=40domain.com>
> =Date: lunes 23 de julio de 2012 13:04:43
> Subject: =46wd: =46W: URGE=21=21=21=21 Ley de Reforma del Congreso de 20=11
> =20
> Some text here, blah, blah, blah
> =20
> ---------- =46orwarded message ----------
> From: Whatever <whatever=40domain.com (mailto:whatever=40domain.com)>
> Date: 23 de julio de 2012 12:53
> Subject: =46wd: =46W: URGE=21=21=21=21 Ley de Reforma del Congreso de 20=11
> To: Someone <someone=40domain.com (mailto:someone=40domain=.com)>
> =20
> =20
> Some stuff=21=21
> =20
> ---------- =46orwarded message ----------
> =46rom: samuel l jackson <sanvuco=40domain.com (mailto:sanvuco=40domain.com)>
> Date: 2012/7/23
> Subject: =46W: URGE=21=21=21=21 Ley de Reforma del Congreso de 2011
> To: =22...Scary Monster=C2=B7=C2=B7=C2=B7 =C3=B2=5F=5F=C3=B3=22 <eowyn2=
6=40domain.com (mailto:eowyn26=40domain.com 
```

我的意思是，出现了坏而`=40`不是块`@``mailto:xxxx@domain.com`

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T14:11:31.203

运行身体字符串

```
quoted_printable_decode($bodyText); 
```

你会得到你正在寻找的可打印的、未编码的字符串。然后，您可以继续使用一些正则表达式来摆脱 mailto 并进行您喜欢的任何其他解析。这些任务的适当功能是：

```
preg_replace(); 
```

[http://www.php.net/manual/en/function.preg-replace.php](http://www.php.net/manual/en/function.preg-replace.php)

# redirect - Nginx 模块重定向

> ID：11632270
> 
> 赞同：2
> 
> 时间：2012-07-24T13:47:06.407
> 
> 标签：redirect, module, nginx

再会

我正在为 Nginx 编写一个模块，如果有几个条件适用，它应该将用户重定向到某些（本地）URL——比如 ngx_http_rewrite_module （虽然我在那个模块中找不到重定向代码）。

我的代码在所需事件上成功运行，但我无法将用户重定向到另一个页面。

我试过`ngx_http_internal_redirect`了，但没有用：

```
static ngx_str_t  ngx_redirect_script = ngx_string("/dst.php");
return ngx_http_internal_redirect(r, &ngx_redirect_script , &r->args); 
```

也许有人知道该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:36:09.043

有趣的是，这有效：

```
ngx_http_internal_redirect(r, &ngx_redirect_script , &r->args);
return NGX_HTTP_OK; 
```

# java - apache procrun 无法启动服务

> ID：11632275
> 
> 赞同：3
> 
> 时间：2012-07-24T13:47:38.007
> 
> 标签：java, multithreading, service, procrun

**编辑**

我正在使用 loaderDeamon 接口来安装和运行 Java 应用程序作为 Windows 服务。为此，Apache 的 procrun 服务工具（与 tomcat 安装的工具相同）处理服务的安装和执行。

最近通过服务管理器执行服务时，服务声称正在运行，但没有响应。没有写入日志，应用程序的客户端无法通信。这让我觉得该服务实际上并没有运行。

我试图通过 procrun 通过 //TS 命令启动服务，如下所述：[http://commons.apache.org/daemon/procrun.html](http://commons.apache.org/daemon/procrun.html)，即使我们等待，它也会挂起并且没有启动服务到 24 小时。procrun 本身会生成我们捕获的日志。完整的日志包含在下面。我有几个关于日志的问题，希望能弄清楚服务无法启动的原因。

1.  首先，“Java Worker thread finished... start with status=6”在线程终止时表示什么？
2.  其次，当我们到达“等待所有线程退出”行时，哪些线程仍在执行？
3.  第三，日志中是否还有其他在启动服务时可能出现问题的突出内容？

该服务过去执行成功，最近升级到 java 版本 1.7.5 后失败。我恢复到 java 1.7.3 生效，所以我相信 jvm 的变化是无关的，尽管值得一提。

```
[2012-07-24 07:16:04] [debug] ( prunsrv.c:1644) Commons Daemon procrun log initialized
[2012-07-24 07:16:04] [info]  ( prunsrv.c:1648) Commons Daemon procrun (1.0.10.0 32-bit) started
[2012-07-24 07:16:04] [debug] ( prunsrv.c:559 ) Installing service...
[2012-07-24 07:16:04] [info]  ( prunsrv.c:595 ) Service CProgramFilesx86XpressfeedLoaderV5serviceLoaderEngine name XF Engine - C:\Program Files (x86)\Xpressfeed Loader V5 service\Loader
[2012-07-24 07:16:04] [debug] ( prunsrv.c:611 ) Setting service description The Xpressfeed V5 loader engine, used in headless mode to run load jobs in the background.
[2012-07-24 07:16:04] [info]  ( prunsrv.c:629 ) Service 'CProgramFilesx86XpressfeedLoaderV5serviceLoaderEngine' installed
[2012-07-24 07:16:04] [info]  ( prunsrv.c:1729) Commons Daemon procrun finished
[2012-07-24 07:16:13] [debug] ( prunsrv.c:1644) Commons Daemon procrun log initialized
[2012-07-24 07:16:13] [info]  ( prunsrv.c:1648) Commons Daemon procrun (1.0.10.0 32-bit) started
[2012-07-24 07:16:13] [info]  ( prunsrv.c:1545) Debugging 'CProgramFilesx86XpressfeedLoaderV5serviceLoaderEngine' service...
[2012-07-24 07:16:13] [debug] ( prunsrv.c:1345) Inside ServiceMain...
[2012-07-24 07:16:13] [info]  ( prunsrv.c:1089) Starting service...
[2012-07-24 07:16:13] [debug] ( javajni.c:206 ) loading jvm 'C:\Program Files (x86)\Java\jre7\bin\client\jvm.dll'
[2012-07-24 07:16:13] [debug] ( javajni.c:660 ) Jvm Option[0] -Djava.net.preferIPv4Stack=true
[2012-07-24 07:16:13] [debug] ( javajni.c:660 ) Jvm Option[1] -Djava.class.path=.;conf;dist\XpressfeedLoader.jar;lib\antlr-2.7.6.jar;lib\apache-log4j-extras-1.1.jar;lib\asm.jar;lib\auth\IA64\sqljdbc_auth.dll;lib\auth\x64\sqljdbc_auth.dll;lib\auth\x86\sqljdbc_auth.dll;lib\c3p0-0.9.1.2.jar;lib\cglib-2.2.jar;lib\commons-codec-1.4.jar;lib\commons-collections-3.1.jar;lib\commons-daemon-1.0.3.jar;lib\commons-dbcp-1.4.jar;lib\commons-lang-2.5.jar;lib\commons-logging-1.0.4.jar;lib\commons-pool-1.5.5.jar;lib\derby-10.6.2.1.jar;lib\dom4j-1.6.1.jar;lib\edtftpj-pro.jar;lib\freemarker.jar;lib\gui\jcommon-1.0.16.jar;lib\gui\jfreechart-1.0.13.jar;lib\hibernate-c3p0-3.5.2-Final.jar;lib\hibernate-tools.jar;lib\hibernate3.jar;lib\hsqldb.jar;lib\IAClasses.zip;lib\jargs.jar;lib\javassist.jar;lib\jaxen-1.1.1.jar;lib\jta.jar;lib\jtidy-r8-20060801.jar;lib\jung\collections-generic-4.01.jar;lib\jung\colt-1.2.0.jar;lib\jung\concurrent-1.3.4.jar;lib\jung\j3d-core-1.3.1.jar;lib\jung\jung-3d-2.0.1.jar;lib\jung\jung-algorithms-2.0.1.jar;lib\jung\jung-api-2.0.1.jar;lib\jung\jung-graph-i
[2012-07-24 07:16:13] [debug] ( javajni.c:660 ) Jvm Option[2] -Xms256m
[2012-07-24 07:16:13] [debug] ( javajni.c:660 ) Jvm Option[3] -Xmx1024m
[2012-07-24 07:16:13] [debug] ( javajni.c:880 ) DLL search path set to 'C:\PROGRA~2\XPRESS~2\jre\bin'
[2012-07-24 07:16:13] [debug] ( javajni.c:897 ) Java Worker thread started com/capitaliq/loader/loaderservice/LoaderService:start
[2012-07-24 07:16:13] [debug] ( javajni.c:914 ) Java Worker thread finished com/capitaliq/loader/loaderservice/LoaderService:start with status=6
[2012-07-24 07:16:14] [debug] ( prunsrv.c:1148) Java started com/capitaliq/loader/loaderservice/LoaderService
[2012-07-24 07:16:14] [info]  ( prunsrv.c:1244) Service started in 1160 ms.
[2012-07-24 07:16:14] [debug] ( prunsrv.c:1496) Waiting for worker to finish...
[2012-07-24 07:16:14] [debug] ( prunsrv.c:1501) Worker finished.
[2012-07-24 07:16:14] [debug] ( prunsrv.c:1524) Waiting for all threads to exit 
```

我采取的步骤没有效果：

1.  使用调试在控制台上运行服务
2.  指定 java SE 版本 1.7.5、1.7.3
3.  只使用默认的 jvm 1.6.30，不指定它
4.  广泛的谷歌工作

任何帮助或想法表示赞赏！谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-26T18:44:39.260

最近，我也不得不尝试让 procrun 来运行我的服务。经过数小时试图了解将参数设置`--StdOutput`和`--StdError`重定向参数设置为`auto`. stderr 日志在`--LogPath`标准日志文件中生成并包含堆栈跟踪和其他启动问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T19:01:43.837

在大量使用了久经考验的调试策略（注释掉东西并运行直到它工作）之后，我最终将问题缩小到最近升级我们的**log4j** jar 的范围内。我们使用以下版本运行 apache 的 log4j：

*   apache-log4j-extras-1.0.jar
*   log4j-1.2.16.jar
*   slf4j-api-1.5.8.jar
*   slf4j-log4j12-1.5.8.jar

我们升级到以下，导致问题：

*   apache-log4j-extras-1.1.jar
*   log4j-1.2.17.jar
*   slf4j-api-1.6.6.jar
*   slf4j-log4j12-1.6.6.jar

恢复到原始 jar 文件后，服​​务能够初始化并运行而不会挂起。

不幸的是，procrun 日志**没有产生堆栈或有用的错误**（除了我在问题中发布的内容），所以我无法确定为什么 log4j 会与初始化服务冲突。如果其他人碰巧知道，我会全神贯注 - 我们很可能会坚持使用旧版本的罐子，直到了解意外的交互。

# android - Android：如何在屏幕上发布图像

> ID：11632276
> 
> 赞同：0
> 
> 时间：2012-07-24T13:47:41.630
> 
> 标签：android, user-interface

我是 Android 新手，我正计划开发一个便利贴 Android 应用程序。编辑完一张卡片后，用户可以将其发布到屏幕上，因此每次用户解锁手机时，他都会在主屏幕上看到一张小卡片。那么有什么材料和资源我可以学习来实现这种效果吗？提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T13:53:26.407

您可以通过小部件与主屏幕进行交互。您可以从这里开始了解它们：

[http://developer.android.com/guide/topics/appwidgets/index.html](http://developer.android.com/guide/topics/appwidgets/index.html)

您还可以开始研究 2D 图形框架。这里：

[http://developer.android.com/guide/topics/graphics/2d-graphics.html](http://developer.android.com/guide/topics/graphics/2d-graphics.html)

社区提供的教程和示例也很多，但是如果您是 android 新手，我认为完成您刚才提到的内容还有很长的路要走。

# java - Jnotify 是如何工作的

> ID：11632277
> 
> 赞同：2
> 
> 时间：2012-07-24T13:47:44.937
> 
> 标签：java, jnotify

我可以使用`Jnotify`文件创建、修改等监听事件。我关心的是 Jnotify 的工作原理。我的意思是它使用 get 事件。参考资源使用是否安全。我读到另一个 SO 问题 - [https://stackoverflow.com/questions/11100003/why-does-jnotify-consume-so-much-resources](https://stackoverflow.com/questions/11100003/why-does-jnotify-consume-so-much-resources) - 它消耗大量资源。

我可以解决我的问题的另一种方法是一个while循环，直到一个条件然后程序被关闭。

哪个更好用会消耗更少的资源。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T13:58:40.150

*linnotify*与内核对话以获取有关文件系统更改的通知。没有轮询，内核会通知订阅文件夹的更改。

*jnotify是一个围绕**libjnotify*的 JNI 包装器。

尽管如此，如果您使用的是 Java 7，这一切都已成为历史，被新的 java 文件 I/O (NIO.2) 包所取代。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T14:01:54.837

从[网站](http://jnotify.sourceforge.net/linux.html)...

> JNotify Linux 支持
> 
> JNotify Linux API 是 Linux INotify API 的精简包装器。由于 Linux INotify API 不支持对目录进行递归侦听，因此 JNotify 通过在监视目录下的每个子目录上（透明地）创建 INotify 监视来添加此功能。这个过程花费的时间与树中被递归监视的目录数量成线性关系，并且需要系统资源，即 - INotify 监视，这是有限的，默认情况下每个进程有 8192 个监视。

这些限制已记录在案。还提供了有关实施的想法。

您的问题与[Java 中的 File changed listener](https://stackoverflow.com/questions/494869/file-changed-listener-in-java)有关，高度投票的答案是[DefaultFileMonitor](http://commons.apache.org/vfs/apidocs/org/apache/commons/vfs2/impl/DefaultFileMonitor.html)，来自 Apache commons。我建议你试一试。

# css - 在plone中使用特定于页面的CSS

> ID：11632278
> 
> 赞同：1
> 
> 时间：2012-07-24T13:47:45.750
> 
> 标签：css, plone

有没有一种方法可以定义 css，例如，此特定页面上的所有段落 (<p>) 都根据该 css 格式化，而不是 plone 站点上的其他页面？

Inline-css 确实有效，但对于我想要设置样式的较大表格来说，这很烦人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T21:10:38.827

你应该使用

*   ploneCustom.css 或与 portal_css 注册表中的其他 CSS 文件合并的相关自定义 CSS 文件

*   使用`<body>`CSS 类仅针对单个页面

`<body>`可以根据自定义需求添加更多CSS。您需要使用 CSS 定位什么样的页面。

[http://collective-docs.readthedocs.org/en/latest/templates_css_and_javascripts/css.html#adding-new-css-body-classes](http://collective-docs.readthedocs.org/en/latest/templates_css_and_javascripts/css.html#adding-new-css-body-classes)

如果需要，您还可以将 CSS 作为`<head>`viewlet 包含在内，但不建议使用这种方法。

[http://collective-docs.readthedocs.org/en/latest/views/viewlets.html#viewlets-for-one-page-only](http://collective-docs.readthedocs.org/en/latest/views/viewlets.html#viewlets-for-one-page-only)

# javascript - 没有回调传递给 ApiClient

> ID：11632280
> 
> 赞同：2
> 
> 时间：2012-07-24T13:47:55.197
> 
> 标签：javascript, api, facebook-opengraph

当我尝试使用 JS 执行操作时`FB.api([...]`，我`No callback passed to the ApiClient [...]` 在哪里可以设置此回调？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T21:37:57.020

只需在 API 调用中添加一个回调函数：

```
 FB.api(
        '/me/[YOUR_APP_NAMESPACE]:[YOUR_ACTION]',
        'post',
        { recipe: '[LINK_TO_YOUR_OBJECT]' },
        function(response) {
            if (!response || response.error) {
                alert('Error occured');
            } 
            else {
                alert('Action was successful! Action ID: ' + response.id)
            }
         }
    ); 
```

# linux - 如何获取 IPv6 主机的范围？

> ID：11632284
> 
> 赞同：4
> 
> 时间：2012-07-24T12:21:02.610
> 
> 标签：linux, bash, ip-address, ipv6

我对 IPv6 协议了解不多，如果这个问题听起来很愚蠢，我很抱歉。当我检索网络中所有 IPv6 地址的列表时，我得到一个名为 scope 的字段，如下所示：

```
 inet6 addr: 2001:470:1:82::11/64 Scope:Global
      inet6 addr: 2001:470:1:82::10/64 Scope:Global
      inet6 addr: 2001:470:1:82::13/64 Scope:Global
      inet6 addr: fe80::21d:9ff:fe69:2c50/64 Scope:Link
      inet6 addr: 2001:470:1:82::12/64 Scope:Global
      inet6 addr: 2001:470:1:82::15/64 Scope:Global
      inet6 addr: 2001:470:1:82::14/64 Scope:Global
      inet6 addr: 2001:470:1:82::5/64 Scope:Global
      inet6 addr: 2001:470:1:82::17/64 Scope:Global
      inet6 addr: 2001:470:1:82::6/64 Scope:Global
      inet6 addr: 2001:470:1:82::16/64 Scope:Global
      inet6 addr: 2001:470:1:82::7/64 Scope:Global
      inet6 addr: 2001:470:1:82::19/64 Scope:Global
      inet6 addr: 2001:470:1:82::8/64 Scope:Global
      inet6 addr: 2001:470:1:82::18/64 Scope:Global
      inet6 addr: 2001:470:1:82::9/64 Scope:Global
      inet6 addr: 2001:470:1:82::1b/64 Scope:Global
      inet6 addr: 2001:470:1:82::a/64 Scope:Global
      inet6 addr: 2001:470:1:82::1a/64 Scope:Global
      inet6 addr: 2001:470:1:82::b/64 Scope:Global
      inet6 addr: 2001:470:1:82::1d/64 Scope:Global
      inet6 addr: 2001:470:1:82::c/64 Scope:Global
      inet6 addr: 2001:470:1:82::1c/64 Scope:Global
      inet6 addr: 2001:470:1:82::d/64 Scope:Global
      inet6 addr: 2001:470:1:82::1f/64 Scope:Global
      inet6 addr: 2001:470:1:82::e/64 Scope:Global
      inet6 addr: 2001:470:1:82::1e/64 Scope:Global
      inet6 addr: 2001:470:1:82::f/64 Scope:Global
      inet6 addr: ::1/128 Scope:Host 
```

在我的应用程序中，我需要获取范围为“链接”的地址。我本可以对 ifconfig 使用系统调用，然后解析输出以提取相应的地址。但问题是，我正在使用对 getifaddrs() 的调用，它返回结构 ifaddr 的链表，如下所示：

```
 struct ifaddrs {
           struct ifaddrs  *ifa_next;    /* Next item in list */
           char            *ifa_name;    /* Name of interface */
           unsigned int     ifa_flags;   /* Flags from SIOCGIFFLAGS */
           struct sockaddr *ifa_addr;    /* Address of interface */
           struct sockaddr *ifa_netmask; /* Netmask of interface */
           union {
               struct sockaddr *ifu_broadaddr;
                                /* Broadcast address of interface */
               struct sockaddr *ifu_dstaddr;
                                /* Point-to-point destination address */
           } ifa_ifu;
       #define              ifa_broadaddr ifa_ifu.ifu_broadaddr
       #define              ifa_dstaddr   ifa_ifu.ifu_dstaddr
           void            *ifa_data;    /* Address-specific data */
       }; 
```

问题是：如何从此列表中获取具有“链接”范围的地址？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T16:31:36.650

有辅助宏可以帮助：

```
struct sockaddr_in6 s6;
if (IN6_IS_ADDR_LINKLOCAL(&s6.sin6_addr)) {
  puts ("link-local");
} else if (IN6_IS_ADDR_SITELOCAL(&s6.sin6_addr)) {
  puts ("site-local");
} else if (IN6_IS_ADDR_V4MAPPED(&s6.sin6_addr)) {
  puts ("v4mapped");
} else if (IN6_IS_ADDR_V4COMPAT(&s6.sin6_addr)) {
  puts ("v4compat");
} else if (IN6_IS_ADDR_LOOPBACK(&s6.sin6_addr)) {
  puts ("host");
} else if (IN6_IS_ADDR_UNSPECIFIED(&s6.sin6_addr)) {
  puts ("unspecified");
} else {
  puts ("global");
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-24T14:24:08.770

一种方法是简单地检查地址是否属于`fe80::/10`. [IPv6 地址空间](https://www.iana.org/assignments/ipv6-address-space/ipv6-address-space.xml)可从 IANA 获得，其中详细说明了可能的可用范围。

我将源代码下载到[net-tools](http://net-tools.berlios.de/)（ifconfig 的源包），看起来它们解析`/proc/net/if_inet6`. （注释是我自己在下面的代码中添加的——下面的代码也非常删节，肯定不会编译。）

```
/* some defines collected around the place: */

#define _PATH_PROCNET_IFINET6   "/proc/net/if_inet6"
#define IPV6_ADDR_LOOPBACK      0x0010U
#define IPV6_ADDR_LINKLOCAL     0x0020U
#define IPV6_ADDR_SITELOCAL     0x0040U
#define IPV6_ADDR_COMPATv4      0x0080U

int scope; /* among other stuff */

/* looks like here we parse the contents of /proc/net/if_inet6: */

if ((f = fopen(_PATH_PROCNET_IFINET6, "r")) != NULL) {
while (fscanf(f, "%4s%4s%4s%4s%4s%4s%4s%4s %02x %02x %02x %02x %20s\n",
          addr6p[0], addr6p[1], addr6p[2], addr6p[3],
          addr6p[4], addr6p[5], addr6p[6], addr6p[7],
      &if_idx, &plen, &scope, &dad_status, devname) != EOF) {

/* slightly later: */

printf(_(" Scope:"));
switch (scope) {
case 0:
    printf(_("Global"));
    break;
case IPV6_ADDR_LINKLOCAL:
    printf(_("Link"));
    break;
case IPV6_ADDR_SITELOCAL:
    printf(_("Site"));
    break;
case IPV6_ADDR_COMPATv4:
    printf(_("Compat"));
    break;
case IPV6_ADDR_LOOPBACK:
    printf(_("Host"));
    break;
default:
    printf(_("Unknown"));
} 
```

那么让我们看看上面解析的是什么：

```
$ cat /proc/net/if_inet6
20010db8000008000000000000000001 03 40 00 00     eth0
fe800000000000000000000000004321 03 40 20 80     eth0
00000000000000000000000000000001 01 80 10 80       lo 
```

所以你可以看到左起第三列（`0x00`Global、`0x20`Link-Local 和`0x10`Loopback）是作用域。使用 net-tools 代码中的上述常量，您可以了解它们的含义。需要进一步调查以确定此类常量的更权威来源，以及解析是否`/proc/net/if_inet6`是您的最佳选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T14:17:31.037

我认为范围没有明确存储在该数据结构中。但是，您可以从 IP 地址本身推断范围。请参阅[http://en.wikipedia.org/wiki/IPv6_address#Address_scopes](http://en.wikipedia.org/wiki/IPv6_address#Address_scopes)

# windows-8 - WinRT MVVM 灯光示例项目

> ID：11632285
> 
> 赞同：8
> 
> 时间：2012-07-24T13:48:09.277
> 
> 标签：windows-8, mvvm-light, windows-runtime

如果有人开始使用 MVVM Light 开发 Windows 8 Metro 应用程序，请帮我创建一个 Windows 8 (WinRT) 项目模板。我对使用 Microsoft 的 Layoutaware 页面（基类）感到厌烦。我只需要在 MVVM Light 的帮助下构建类。如果有人这样做，请帮助我或提供一些链接以开始使用 MVVM Light 开发 Windows 8 Metro 应用程序。

我面临问题的主要领域是：

1.  导航（前进和后退）
2.  状态处理（Windows 8 中的墓碑）
3.  应用程序启动后的导航表单终止状态等。
4.  处理 WebService [使用 http 客户端发布]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T18:42:34.567

有一个（较旧的）使用 MVVM Light 和 windows 8 的示例在[这里](http://blog.galasoft.ch/archive/2012/02/19/impressions-slides-and-code-from-techdays-belgium-and-netherlands.aspx)找到。这里还有模板和示例作为 MVVM 光源的[一部分](http://mvvmlight.codeplex.com/SourceControl/changeset/view/b922e8ccf674)。

编辑： [这](http://msdn.microsoft.com/en-us/magazine/jj651572.aspx)是一个使用 MVVM Light 的 msdn 示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-02T13:46:37.637

[这个](https://staging.nuget.org/packages/MvvmLight/4.1.23)怎么样

但我没有尝试。我正在使用可移植类库（目标为 Windows 8.1 和 .NET x.xx），并且该库被引用到 WinRT 项目。MvvmLight for PCL 你可以在[这个链接上找到](https://www.nuget.org/packages/Portable.MvvmLightLibs/)

问题是，您无法访问本地文件和本地设置，但您可以在开始时将其从 Presentation 项目注入到可移植类库中。

这个解决方案有很多优点，其中之一是：最简单的单元测试。

有关更多信息，请查看此堆栈溢出[线程](https://stackoverflow.com/questions/24123999/mvvmlight-in-portable-class-library-how-to-do-unit-testing)

# javascript - 验证输入字段和块字符

> ID：11632287
> 
> 赞同：0
> 
> 时间：2012-07-24T13:48:13.023
> 
> 标签：javascript, validation

大家好，我有一个输入字段，我想实时验证插入的字符。我希望这个输入字段只接受字母、数字和一个空格。如果插入例如 *，脚本删除此字符。

问候

在输入字段上：

```
onkeyup="check(this,'onlyletter')" onblur="check(this,'onlyletter') 
```

在 JS 上：

```
var r={
'onlyletter': // i need correct regular expression
}

function check(o,w){
// i need function
} 
```

我有： Abc123' 123* 但我接受 Abc123 123

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-16T08:42:03.490

## 使用原始 JS：

线索在方法变换中

```
<html>
<head>
    <script>    
        function transform(elem) {
            var v = elem.value;
            var n = "";

            //loop it to cut of more than 1 -- e.g. on copy & paste
            if(v.length) {
                n = v.slice(-1);
                if( !isNaN(parseFloat(n)) && isFinite(n) ) {
                    elem.value = v.substring(0, v.length - 1);
                }
            }
       }
    </script>
</head>
<body>
    <input
        type="text"
        name="date"
        placeholder="Text only!"
        onkeyup="transform(this);"
        maxlength="10"
    >
</body>
</html> 
```

## 使用 jquery 的替代方式

屏蔽文本字段以仅接受字母。现在可以通过多种方式做到这一点。一个是查询掩码插件

你只需要查询，查询掩码，然后它是 1 行代码；）

演示：

```
<html>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.mask.min.js"></script>
<script type="text/javascript">
      $(document).ready(function(){ 
          //masked input for alphabets only 
          //constrained to 20 characters in length without spaces                      
          $("#myTextField").mask("SSSSSSSSSSSSSSSSSSSS");
      });
</script>
<body>
  <br><input type = "text" id="myTextField" name="Text Field"></br>
</body>
</html> 
```

# javascript - 如何将事件绑定到模态对话框上的组件？

> ID：11632288
> 
> 赞同：4
> 
> 时间：2012-07-24T13:48:16.907
> 
> 标签：javascript, jquery, html, modal-dialog, event-binding

我正在使用 jQuery 的[模式对话框](http://jqueryui.com/demos/dialog/#event-open)来打开包含表单的对话框。我无法解决的是如何将事件绑定到添加到我的模态对话框中的组件。在这种情况下，我想将单击或更改绑定到对话框中已定位的复选框。加载对话框时似乎没有触发任何成功方法。我就是这样做的：

这是我在我的 javascript 的开头，在 ready-function 的开头做的：

```
$( "#dialog:ui-dialog" ).dialog( "destroy" );

$( "#dialog-modal" ).dialog({
    autoOpen: false,
    show: "blind",
    hide: "explode",
    minWidth: 400,
    modal: true
 }); 
```

稍后我在单击按钮时执行此操作：

```
$('#dialog-modal').dialog( "option", "title", lang.localized_text.ADD_AGENT);
$('#dialog-modal').live('dialogopen', function(msg){
        alert("Opens");
        $("#select_all").live('click', function(msg){
               alert("clicked");  
        });

 });
$.get("https://" + hostname +  "/modules/core/useradmin/adminactivities/admin_add_agent.php",function(e){
     var obj = $.parseJSON(e);
     $("#dialog-modal").html(obj.html);
     $("#dialog-modal").dialog("open");
     addAddAgentValidation();
}
}); 
```

可以清楚地看到，alert("Opens") 是在对话框打开之前出现的。因此， dialogopen 在对话框完成加载之前被触发。但是验证处理程序（调用绑定验证检查的验证函数）有效。

警报（“点击”）；永远不会触发。

如何将任何事件绑定到模态对话框上的组件？创建对话框时是否有任何回调函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:20:06.247

由于您的选择将在 #dialog-modal 中，并且由于 #dialog-modal 存在于 domready 上（并且从未销毁？），因此您可以使用 $.on()

```
$('#dialog-modal').on('click', '#select_all', function(e){
    alert('clicked');
}); 
```

*但是，当*您将#select_all 包含到dom中时，您也可以绑定click 事件。

```
$.get("https://" + hostname +  "/modules/core/useradmin/adminactivities/admin_add_agent.php",function(e){
     var obj = $.parseJSON(e);
     $("#dialog-modal").html(obj.html);
     $('#select_all').click(function(e){
         alert('clicked');
     });
     $("#dialog-modal").dialog("open");
     addAddAgentValidation();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T14:10:43.743

您可以使用 .on 方法绑定它，该方法在最近的 jQuery 版本中替换了 .live。在这种情况下，你将它绑定到当 DOM 准备好时你知道的东西（比如 body）。现在您只需要绑定一次，每次单击#select_all 时它都会触发。

```
$("body").on('click', '#select_all', function () {
    alert("clicked");  
}); 
```

[http://api.jquery.com/on/](http://api.jquery.com/on/)

# android - 在 Android 中使用 jni：UNsatisfiedLinkError

> ID：11632290
> 
> 赞同：7
> 
> 时间：2012-07-24T13:48:18.287
> 
> 标签：android, java-native-interface, header-files, unsatisfiedlinkerror

我是 jni 的新手，我正在阅读一个教程来实现一个简单的本机方法，但我得到了一个 unsatisfiedlinkerror。据我所知，我完全按照教程中的步骤进行操作。请帮我。

这是java包装器代码：

```
package com.cookbook.jni;

public class SquaredWrapper {

    // Declare native method (and make it public to expose it directly)
    public static native int squared(int base);

   // Provide additional functionality, that "extends" the native method
   public static int to4(int base)
   {
      int sq = squared(base);
      return squared(sq);
   }

   // Load library
   static {
      System.loadLibrary("squared");
   }
} 
```

这是我的 Android.mk 文件的样子：

> LOCAL_PATH := $(调用我的目录)
> 
> 包括 $(CLEAR_VARS)
> 
> LOCAL_MODULE := squared LOCAL_SRC_FILES := squared.c
> 
> 包括 $(BUILD_SHARED_LIBRARY)

这是我的 .c 文件的样子：

```
#include "squared.h"
#include <jni.h>

JNIEXPORT jint JNICALL Java_org_edwards_1research_demo_jni_SquaredWrapper_squared
  (JNIEnv * je, jclass jc, jint base)
{
     return (base*base);
} 
```

这是我的 .h 文件的样子：

```
enter code here/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class com_cookbook_jni_SquaredWrapper */

#ifndef _Included_com_cookbook_jni_SquaredWrapper
#define _Included_com_cookbook_jni_SquaredWrapper
#ifdef __cplusplus
extern "C" {
#endif
/*
* Class:     com_cookbook_jni_SquaredWrapper
* Method:    squared
* Signature: (I)I
*/
JNIEXPORT jint JNICALL Java_com_cookbook_jni_SquaredWrapper_squared
  (JNIEnv *, jclass, jint);

#ifdef __cplusplus
}
#endif
#endif 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T13:55:54.423

您的 JNI 签名不匹配。在您的 .c 文件中，更改：

```
JNIEXPORT jint JNICALL Java_org_edwards_1research_demo_jni_SquaredWrapper_squared 
```

至

```
JNIEXPORT jint JNICALL Java_com_cookbook_jni_SquaredWrapper_squared 
```

通常有两种方法可以通过 JNI 将原生 C 语言“粘合”到 Java 函数上。第一个是您在此处尝试执行的操作，即使用 JNI 将识别并与您的适当 Java 代码相关联的预定签名。第二种是在包含库时将函数指针、签名和 Java 类名传递到 JNI。

这是将本机函数绑定到适当的 Java 代码（这将是您的 .c 文件）的第二种方法：

```
#include "squared.h"
#include <jni.h>

static const char* SquaredWrapper = "com/cookbook/jni/SquaredWrapper";

jint squared(JNIEnv * env, jobject this, jint base) {
     return (base*base);
}

// Methods to register for SquaredWrapper
static JNINativeMethod SquareWrapperMethods[] = {
        {"squared", "(I)I", squared}
};

jint JNI_OnLoad(JavaVM* vm, void* reserved) {
    JNIEnv* env;
    if ( (*vm)->GetEnv(vm, (void **) &env, JNI_VERSION_1_6) != JNI_OK)
        return JNI_ERR;

    jclass class = (*env)->FindClass(env, SquaredWrapper);
    (*env)->RegisterNatives(env, class, SquaredWrapperMethods, sizeof(SquaredWrapperMethods)/sizeof(SquaredWrapperMethods[0]));

    return JNI_VERSION_1_6;
}

void JNI_OnUnload(JavaVM* vm, void* reserved) {
    JNIEnv* env;
    if ((*vm)->GetEnv(vm, (void**) &env, JNI_VERSION_1_6) != JNI_OK)
        return;

    jclass class = (*env)->FindClass(env, SquaredWrapper);
    (*env)->UnregisterNatives(env, class);

    return;

} 
```

它的时间更长，但在绑定本机代码时它为您提供了更多的灵活性。平方和包含的定义如您所料。在第 4 行，静态 const char* SquaredWrapper 是一个转义字符串，其中包含要绑定平方的类的完全限定包名称。靠近底部的是 JNI_OnLoad 和 JNI_OnUnLoad 函数，它们负责绑定和取消绑定库加载和卸载时的函数。最后一块是 JNINativeMethod 数组。该数组包含一个大小为 3 的数组作为每个条目，其组成部分是方法的 Java 名称（如 const char*）、Java 方法的 JNI 签名以及绑定到该方法的本机 C 函数指针。JNI 函数签名告诉环境参数列表格式和 Java 函数的返回值。格式为“

[http://dev.kanngard.net/Permalinks/ID_20050509144235.html](http://dev.kanngard.net/Permalinks/ID_20050509144235.html)

祝你好运 ：）

**编辑：**哦，顺便说一句，您可能希望将 JNI_OnLoad 和 JNI_UnOnLoad 的签名添加到您的标题中，并更改本机函数原型的名称以反映新的 .c 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-21T13:52:20.300

这是一种晦涩难懂的情况，但是如果您在本机代码中遇到访问冲突，Android 将掩盖抛出的异常并抛出您遇到的错误。就我而言，本机代码引发了访问冲突，但 Java 继续运行。然后它尝试在崩溃的 NDK 上调用 JNI 方法。

为了找到访问冲突，我最终将有问题的 JNI 方法移至另一个 IDE 进行调试。

我希望这可以节省我弄清楚这一点所花费的时间。

# php - 多次写入使用 proc_open 打开的进程

> ID：11632291
> 
> 赞同：4
> 
> 时间：2012-07-24T13:48:24.620
> 
> 标签：php, process, exec, proc-open

所以我打开一个进程`$process = proc_open("my_process", $descriptors, $pipes);`

然后我使用写入进程的标准输入`fwrite($pipes[0], "some_command");`

然后我必须先关闭管道，`fclose($pipes[0]);`然后才能使用`$output = stream_get_contents($pipes[1]);`. 如果我不关闭管道，我的 php 脚本将挂在此调用上。

但是，一旦我收到来自 stdout 的输出，如果我想向进程发送另一个命令……stdin 管道已关闭，所以我无法发送它。那么是否有可能以某种方式向进程发送另一个命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:55:59.733

听起来另一个进程正在阻塞等待 STDIN 上的 EOL 或 EOF。你想执行什么？

无论如何，这很有可能会解决它：只需附加`\n`到您发送到另一个进程的命令即可。

例如

```
$process = proc_open("my_process", $descriptors, $pipes);

$command = "some_command";
fwrite($pipes[0], $command."\n");

// Fetch the contents of STDOUT 
```

现在，您可能还会遇到的一个问题与您正在使用的事实有关`stream_get_get_contents()`- 它会在 EOF 返回之前等待它。您可能需要更智能地了解如何从中检索数据`$pipes[1]`、使用`fgets()`和查找特定数量的行或字符串以指示输出的结束。

如果你告诉我们你在执行什么，我也许可以给你一个更具体的答案。

# c# - 是否可以使用 Blob 分析删除图像的小块？

> ID：11632293
> 
> 赞同：2
> 
> 时间：2012-07-24T13:48:29.560
> 
> 标签：c#, image-processing, computer-vision, aforge

我想知道 blob 到底是什么？是否可以减少图像中的背景噪音？或者是否有可能在图像中找到最大的区域，更具体地说，如果图像只包含手部和头部段，那么是否可以只分离手部或头部区域？**如果这是可能的，那么也可以选择具有较大轮廓的边界，同时消除图像中的小块**？？

> 建议我，我有一张只包含手势的图片。我使用皮肤检测技术来做到这一点。但问题是我在图像中有与手（皮肤）颜色相同的其他小噪声。我只想要典型的手势，消除噪音。帮我？？

![这是一个示例图像，我想在其中去除手部轮廓后面的噪音。](../Images/7a4b3aae8397112fae8394be7afb074c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:24:35.670

使用[aforge](http://www.aforgenet.com/framework/docs/html/78109d8e-4824-1c6f-4684-02e271ecb3f9.htm)中的示例，您有什么理由不能只清除图像中的小块？

```
// create an instance of blob counter algorithm
BlobCounterBase bc = new ...
// set filtering options
bc.FilterBlobs = true;
bc.MinWidth  = 5;
bc.MinHeight = 5;
// process binary image
bc.ProcessImage( image );
Blob[] blobs = bc.GetObjects( image, false );
// process blobs
var rectanglesToClear = from blob in blobs select blob.Rectangle;

 using (var gfx = Graphics.FromImage(image))
 {
    foreach(var rect in rectanglesToClear) 
    {
        if (rect.Height < someMaxHeight && rect.Width < someMaxWidth)
            gfx.FillRectangle(Brushes.Black, rect);
    }
  gfx.Flush();
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T15:03:44.213

看一下形态开口：这会执行腐蚀，然后是膨胀，并且基本上会删除小于“结构元素”的前景/背景区域，“结构元素”的大小（和形状）可以指定。

我不知道 aforge，但在 Matlab 中，参考在[这里](http://www.mathworks.fr/help/toolbox/images/ref/imopen.html)，在 OpenCV 中，请参见[这里](http://opencv.itseez.com/modules/imgproc/doc/filtering.html#morphologyex)。

# css - IE9渲染css3

> ID：11632294
> 
> 赞同：4
> 
> 时间：2012-07-24T13:48:32.867
> 
> 标签：css

嗨，最近我开始开发一个网站，它使用一些基本的 css3 功能，我确信 IE9 支持这些功能，因为我已经检查过了。无论我做什么，IE9 似乎都没有呈现任何 css3 属性，即使我使用*ms*前缀也是如此。

在我做了一些研究之后，我在 stackoverflow 上发现了一个问题，该问题处理了与我的类似问题，并且有人提供了该问题的解决方案。该人说要在 head 标签中添加这一行：

```
<meta http-equiv="X-UA-Compatible" content="IE=9" /> 
```

在我添加这个之后，一切似乎都奏效了。我会解释为什么我必须使用它来使 css3 功能在 IE9 中工作，它的含义是什么？

我对 Web 开发还很陌生，我尝试在大约 6 个月内学习 html/css/javasript/php/mysql。虽然我现在能够创建功能性网站，但我的脑海中似乎留下了很多空白，所以我希望这不是一个非常基本的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T13:52:38.453

这是文档兼容性。

这一切都在这篇文章中解释了 - [http://msdn.microsoft.com/en-us/library/cc288325%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/cc288325%28v=vs.85%29.aspx)

# c - char [length] 初始化和处理

> ID：11632295
> 
> 赞同：0
> 
> 时间：2012-07-24T13:48:38.623
> 
> 标签：c, c-strings

我定义了一个字符数组：

```
char d[6]; 
```

如果我在以下方面有错误，请纠正我：

此时没有为变量分配内存`d`。现在我要初始化它：

```
d="aaaaa"; 
```

在这种初始化之后，就不需要释放内存了；它会自动完成。

我怎么知道是否`char[]`已初始化？我正在寻找类似的模式

```
if (filled(d)){..} 
```

另外，如何用一种字符填充 char[] ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T13:53:14.073

> 此时没有为变量 d 分配内存。

不正确。这个：

```
char d[6]; 
```

是一个未初始化的 6 `char`s 数组，并且已为其分配了堆栈上的内存。堆栈变量不需要显式`free()`d，无论它们是否已初始化。堆栈变量使用的内存将在超出范围时被释放。只有通过`malloc()`, `realloc()`or获得的指针才`calloc()`应该传递给`free()`.

初始化：

```
char d[6] = "aaaaa"; /* 5 'a's and one null terminator. */ 
```

或者：

```
char d[] = "aaaaa"; /* The size of the array is inferred. */ 
```

而且，正如[mathematician1975](https://stackoverflow.com/users/1342730/mathematician1975)已经指出的那样，数组赋值是非法的：

```
char d[] = "aaaaa"; /* OK, initialisation. */
d = "aaaaa";        /* !OK, assignment. */ 
```

`strcpy()`, `strncpy()`, `memcpy()`,`snprintf()`等可用于`d`在声明后复制到，或分配`char`给`d`.

* * *

> 如何知道 char[] 是否已初始化？如果填充（d）{..}，我需要模式

如果数组为空终止，您可以使用`strcmp()`

```
if (0 == strcmp("aaaaaa", d))
{
    /* Filled with 'a's. */
} 
```

或使用`memcmp()`if not null 终止：

```
if (0 == memcmp("aaaaaa", d, 6))
{
    /* Filled with 'a's. */
} 
```

* * *

> 如何用一种字符填充 char[]？

使用`memset()`：

```
memset(d, 'a', sizeof(d)); /* WARNING: no null terminator. */ 
```

或者：

```
char d[] = { 'a', 'a', 'a', 'a', 'a', 'a' }; /* Again, no null. */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T13:54:33.273

如果您这样做，您的代码将无法编译（gcc 4.6.3）

```
 char d[6];
 d = "aaaaa"; 
```

你需要做

```
 char d[6] = "aaaaa" 
```

以这种方式初始化它。这是在堆栈上创建的局部变量，因此就内存问题而言，您需要担心的不是超出数组边界的写入/读取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:00:17.030

```
How to know was char[] initialized? I need pattern if filled(d){..} 
```

只需在声明字符数组时执行此操作：

```
char d[6];
d[0] = 0; 
```

然后你可以像这样检查：

```
if(strlen(d) == 0)
//d is not initialized 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T13:52:46.540

首先，每当您声明`char d[6]`已经分配了 6 个字节的内存时。

其次，除非你做 malloc，否则不需要释放你的内存

第三，如果你想用一种字符初始化它，那么这样做

```
char d[6] = "aaaaa"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T14:00:05.580

```
int d[6]; 
```

使用此声明将 6 个字节分配到堆栈上。它将被自动释放。

# php - PHP Powerpoint 和图表

> ID：11632297
> 
> 赞同：6
> 
> 时间：2012-07-24T13:48:40.737
> 
> 标签：php, charts, powerpoint

我正在尝试使用这个[库](http://phppowerpoint.codeplex.com/)通过 PHP 创建 PowerPoint 演示文稿。当我尝试在 PowerPoint 中创建图表对象时，我无法在下载文件并在 Microsoft Office 中打开它们时编辑图表。

是否有任何库可以在 PowerPoint 文件中构建图表并允许通过 Office PowerPoint 对其进行编辑？

[使用上述库创建的示例图表](http://play.mink7.com/h/linechart.pptx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-29T12:42:15.333

这很可能是 PHP Power Point 的一个错误。

但是，最新版本的[PHPExcel](https://github.com/PHPOffice/PHPExcel)支持 Charting 并得到积极维护。它允许您在 Excel 中绘制和导出数据，这些数据可以轻松复制到 PowerPoint。

*不过，就个人而言，*我建议您使用[Google Chart Tools](https://developers.google.com/chart/interactive/docs/examples)或[RaphaelJS](http://raphaeljs.com/analytics.html)。

![示例图表](../Images/b15ea58d69c1cefb715f3050f74e7b6a.png)

如果您希望能够在 PowerPoint 中使用图表，您可以轻松地将[Google 图表数据](https://google-developers.appspot.com/chart/interactive/docs/examples_96cadd85bbec1811fbc395a96a7171e4.frame)导出到 Excel (CSV)。另请参阅[此示例](http://www.tushar-mehta.com/publish_train/xl_vba_cases/excel_google_chart_api/index.htm)。

如果您专门介绍 Google Analytics，您应该阅读[本文档](http://blog.oomfo.com/2011/10/presenting-real-time-google-analytics-data-in-powerpoint-live-charts-lesser-heartburn-greater-accuracy/)，了解如何在 Google Analytics 的 PowerPoint 中创建准确的自动更新图表和数据。它基本上使用用于 PowerPoint的[oomfo 插件。](http://oomfo.com/)

或者，有像[ShufflePoint](http://www.shufflepoint.com/PowerPoint.aspx)这样的付费解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T08:54:59.547

当然，您可以使用 PHPPowerPoint 导出可编辑图表。在测试中有两个例子。第一个示例不包括 Excel 工作表，这就是图表不可编辑的原因。但是，如果您查看我认为 test8 的第二个示例，那么您将看到对 PHPExcel 的引用调用和一个包含数据表和图表的标志，然后您可以编辑数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-01T09:58:34.040

看到这个网址： -

PHP PowerPoint 2007 课程

为 PHP 编程语言提供一组类的项目，允许您写入和读取不同的文件格式，如 PowerPoint 2007，... 这个项目是围绕 Microsoft 的 OpenXML 标准和 PHP 构建的。

[http://phppowerpoint.codeplex.com/](http://phppowerpoint.codeplex.com/)

[http://phppowerpoint.codeplex.com/sourcecontrol/list/changesets?ProjectName=phppowerpoint](http://phppowerpoint.codeplex.com/sourcecontrol/list/changesets?ProjectName=phppowerpoint)

特征

[http://phppowerpoint.codeplex.com/wikipage?title=Features&referringTitle=Home](http://phppowerpoint.codeplex.com/wikipage?title=Features&referringTitle=Home)

尝试这个：-

```
<?php
/** Error reporting */
error_reporting(E_ALL);

/** Include path **/
set_include_path(get_include_path() . PATH_SEPARATOR . '/Classes/');

/** PHPPowerPoint */
include 'Classes/PHPPowerPoint.php';

// Create new PHPPowerPoint object
$objPHPPowerPoint = new PHPPowerPoint();
$objPHPPowerPoint->getProperties()->setCreator("Maarten Balliauw")->
    setLastModifiedBy("Maarten Balliauw")->setTitle("Office 2007 PPTX Test Document")->
    setSubject("Office 2007 PPTX Test Document")->setDescription("Test document for Office 2007 PPTX, generated using PHP classes.")->
    setKeywords("office 2007 openxml php")->setCategory("Test result file");

// Remove first slide
$objPHPPowerPoint->removeSlideByIndex(0);

// Create templated slide

// Create templated slide
$currentSlide = createTemplatedSlide($objPHPPowerPoint);

// Generate sample data for line chart
$seriesData = array('Jul 17' => 15, 'Jul 18' => 27, 'Jul 19' => 17, 'Jul 20' =>
    11, 'Jul 21' => 7, 'Jul 22' => 2, 'Jul 23' => 8);

// Create a line chart (that should be inserted in a shape)
$lineChart = new PHPPowerPoint_Shape_Chart_Type_Scatter();
$series = new PHPPowerPoint_Shape_Chart_Series('Visits', $seriesData);
//$series->setShowSeriesName(true);
$lineChart->addSeries($series);

// Create a shape (chart)
$shape = $currentSlide->createChartShape();
$shape->setName('# of people visiting your website')->setResizeProportional(false)->setHeight(550)->
    setWidth(700)->setOffsetX(120)->setOffsetY(80);
$shape->getShadow()->setVisible(true)->setDirection(45)->setDistance(10);
$shape->getFill()->setFillType(PHPPowerPoint_Style_Fill::FILL_GRADIENT_LINEAR)->
    setStartColor(new PHPPowerPoint_Style_Color('FFCCCCCC'))->setEndColor(new
    PHPPowerPoint_Style_Color('FFFFFFFF'))->setRotation(270);
$shape->getBorder()->setLineStyle(PHPPowerPoint_Style_Border::LINE_SINGLE);
$shape->getTitle()->setText('# of people visiting your website');
$shape->getTitle()->getFont()->setItalic(true);
$shape->getPlotArea()->setType($lineChart);
$shape->getView3D()->setRotationX(30);
$shape->getView3D()->setPerspective(30);
$shape->getLegend()->getBorder()->setLineStyle(PHPPowerPoint_Style_Border::
    LINE_SINGLE);
$shape->getLegend()->getFont()->setItalic(true);

// Save PowerPoint 2007 file
$objWriter = PHPPowerPoint_IOFactory::createWriter($objPHPPowerPoint,
    'PowerPoint2007');
$objWriter->save(str_replace('.php', '.pptx', __file__));

function createTemplatedSlide(PHPPowerPoint $objPHPPowerPoint) {
    // Create slide
    $slide = $objPHPPowerPoint->createSlide();

    // Return slide
    return $slide;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-24T09:07:25.880

正确的示例现在称为：

`Sample_05_Chart_with_PHPExcel.php`

在主 PHPPowerpoint 内的示例文件夹中（现在他们开始将其称为 PHPPresentation）文件夹

请注意，要使其正常工作，您必须更改/添加一些内容。

1.  从 GitHub 下载并将`Common`PHPOffice的文件夹保存在某处

2.  包括并注册自动加载器`Common`

3.  从 GitHub 下载并将`PHPExcel`文件夹保存在某处

4.  包括主`PHPExcel.php`文件

5.  在`Sample_Header.php`文件中我更改了行

    `Autoloader::register();`

    至

    `PhpOffice\PhpPresentation\Autoloader::register();`

    避免冲突（我们注册的是什么 Autoloader？）

6.  在`Sample_Header.php`文件中，我还删除（注释）了以下行：

    `//require_once __DIR__ . '/../vendor/autoload.php';`

    这给了我错误（我没有使用作曲家，也不想要作曲家）。

就是这样，现在它创建了一个 Powerpoint 演示文稿，其中包含可编辑的 Excel 数据。

这是修改后的 Sample_Header.php 中的最终代码（第 26-28 行）：

```
PhpOffice\PhpPresentation\Autoloader::register();

//require_once __DIR__ . '/../vendor/autoload.php'; 
```

这是在修改后的 Sample_05_Chart_with_PHPExcel.php 中添加的最终代码（第 5 行，之后`include_once 'Sample_Header.php';`）：

```
require_once '<path to phpExcel...>/Classes/PHPExcel.php';
include '<path to Common...>/Common/Autoloader.php';
PhpOffice\Common\Autoloader::register(); 
```

更改`<path to phpExcel...>`并`<path to Common...>`使用正确的路径。

# c# - 如何通知 UI 列表的一个或多个成员发生了变化

> ID：11632304
> 
> 赞同：0
> 
> 时间：2012-07-24T13:49:04.750
> 
> 标签：c#, wpf, windows-phone-7, list, binding

我有以下问题：

我正在`List<Item>`通过 a 向收藏夹列表 ()添加一个元素`ContextMenu`。每个`Item`都有一个派生属性`IsFavorite`，该属性会根据收藏夹列表而变化 - 如下所示：

```
public bool IsFavorite
{
    get { return ItemController.FavoriteList.Contains( this ); }
} 
```

当我从 中添加（或删除）某些内容时`ContextMenu`，`ContextMenu`必须立即更新。

现在，我知道这可以通过使用 ObservableCollection 来实现，但由于一些我无法控制的因素，我必须使用`List`对象。现在，有什么办法可以让我刷新吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:07:03.680

```
public void DeleteFromFavorites(Item item)
{
    Item itemInMainList = MainList.First(item);
    itemInMainList.Refresh();
} 
```

项目.cs：

```
public bool IsFavorite
{
    get { return ItemController.FavoriteList.Contains( this ); }
}

public void Refresh()
{
    NotifyPropertyChanged("IsFavorite");
} 
```

# android - 示例 NetworkUsage Android 代码在启动时崩溃？

> ID：11632307
> 
> 赞同：2
> 
> 时间：2012-07-24T13:49:12.303
> 
> 标签：android, crash, sample

我正在尝试在*Android Developers*网站（位置： http: [//developer.android.com/training/basics/network-ops/index.html](http://developer.android.com/training/basics/network-ops/index.html)）上的*networkusage.zip*文件中运行示例应用程序。

 *我没有对代码进行任何更改。但是，它在启动时立即崩溃。我尝试`onCreate`在主要活动的方法中设置断点，但它永远不会到达那里......只是立即崩溃。

我刚开始使用*Android*，但我能够完成其他培训课程并运行其他示例应用程序，所以我相信我的配置有效。我正在运行*Windows 7*，带有*Eclipse Juno*以及最新的*JDK*和*Android SDK/ADT*（均在一周前下载）。

我正在使用针对*Android 4.1 (API 16)*的模拟器。

模拟器显示一条消息说`Unfortunately, NetWork Usage has stopped working.`

任何帮助将不胜感激！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T08:16:46.207

在文件中，对于这个项目，用相对的`AndroidManifest.xml`替代绝对。`android:name``NetworkActivity`

换句话说，改变这一行：

```
android:name="com.example.networkusage.NetworkActivity" 
```

看起来像这样：

```
android:name=".NetworkActivity" 
```

问题`NetworkActivity`是不在`com.example.networkusage`（如在`AndroidManifest.xml`文件中），而是在`com.example.android.networkusage`包中。因此，Android 无法在运行时找到该类。*

# iphone - 空 NSMutableArray ，不知道为什么

> ID：11632308
> 
> 赞同：0
> 
> 时间：2012-07-24T13:49:15.163
> 
> 标签：iphone, xcode, nsmutablearray

好的，所以我像这样填充数组：

```
NSMutableArray *participants;
for(int i = 0; i < sizeofpm; i++){
        NSDictionary *pmpart_dict = [pm_participants objectAtIndex:i];
        NSString *pmpart_email = [pmpart_dict objectForKey:@"email"];
        NSString *pmpart_email_extra = [@"pm" stringByAppendingString:pmpart_email];
        [participants setValue:pmpart_email forKey:pmpart_email_extra];
        NSLog(@"%@", participants);
    } 
```

sizeofpm 为 1。即使用计数。获取数组中值的数量。如何将值存储到该数组？它似乎没有工作。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:51:44.963

您不创建数组，只需声明它。

```
NSMutableArray *participants = [NSMutableArray array]; 
```

之后，`setValue:forKey:`不会将对象添加到数组中。你需要`addObject:`：

```
[participants addObject:pmpart_email]; 
```

没有钥匙。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T13:51:48.620

你需要先分配它。尝试将第一行更改为：

`NSMutableArray* participants = [[NSMutableArray alloc] init];`

也使用`setValue:forKey:`不会与数组一起使用，`NSMutableArray`因为数组没有键。

尝试使用`[participants addObject:pmpart_email];`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T13:54:16.937

您正在将值分配给`NSMutableArray *participants`您将值分配给`NSDictionary`对象的方式。要为`NSMutableArray`您分配值，可以调用`- (void)addObject:(id)anObject`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T13:58:26.270

因此，正如其他一些答案所述，我缺少`participants`. 但是，根据您对 的使用`setValue:forKey:`以及您似乎如何构建数据来判断，您不是在寻找`NSMutableArray`，而是在寻找`NSMutableDictionary`。数组只是简单的列表，而字典维护键值关系，您似乎正在尝试利用这种关系。

试试这个：

```
// some classes provide shorthand for `alloc/init`, such as `dictionary`
NSMutableDictionary *participants = [NSMutableDictionary dictionary];
for(int i = 0; i < sizeofpm; i++){
    NSDictionary *pmpart_dict = [pm_participants objectAtIndex:i];
    NSString *pmpart_email = [pmpart_dict objectForKey:@"email"];
    NSString *pmpart_email_extra = [@"pm" stringByAppendingString:pmpart_email];
    [participants setValue:pmpart_email forKey:pmpart_email_extra];
    NSLog(@"%@", participants);
} 
```

这会给你一本字典，形式为

```
{
    pmpart_email_extra: pmpart_email
} 
```

# iphone - 是否有某种方便的解决方案来避免显式 NSNumber 到 int 的转换？

> ID：11632310
> 
> 赞同：3
> 
> 时间：2012-07-24T13:49:16.190
> 
> 标签：iphone, ios, core-data, nsnumber

我正在使用核心数据，所以我所有的数字都是 NSNumbers（因为它是一个旧模型，我没有使用似乎可用于新核心数据的标量自动转换）。

所以我的代码充满了这些转换语句：

```
[myNSNumberFromCoreDataObject intValue]   which is pretty annoying... 
```

**是否有任何方便的解决方案，或者我现在被困住了，因为我无法使用标量核心数据建模？**

编辑：理想情况下，可以编写某种预处理器语句来检查这些情况并自动自动替换它——这可能以某种方式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T14:00:26.177

您始终可以将托管对象上的属性声明为标量并在 getter/setter 中处理转换。例子：

**标题**

```
@interface MyEntity : NSManagedObject

@property (nonatomic, assign, readwrite) NSUInteger count;

@end 
```

**执行**

```
@interface MyEntity ()

@property (nonatomic, retain, readwrite) NSNumber* dbCount;

@end

@implementation MyEntity

@dynamic dbCount;

- (void)setCount:(NSUInteger)count {
    self.dbCount = [NSNumber numberWithUnsignedInteger:count];
}

- (NSUInteger)count {
    return [self.dbCount unsignedIntegerValue];
}

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:59:25.240

您可以在返回 int 的 NSManagedObject 子类上编写类别方法，例如

```
- (int)myNumberInt
{
    return [self.myNumber intValue];
} 
```

# php - 将csv文件上传并导入mysql中的多个表

> ID：11632317
> 
> 赞同：1
> 
> 时间：2012-07-24T13:49:33.077
> 
> 标签：php, mysql, csv, import

我想在 php 中创建和上传页面，并将上传的 csv 文件数据导入到多个表中。尝试在这里搜索，但似乎找不到从 csv 导入到多个表的任何内容。非常感谢这里的任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T13:53:25.570

如果您有权访问 PHPmyadmin，则可以将 CSV 上传到那里。然后将 if 复制到每个所需的表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T14:55:47.633

为了回应您的评论，即某些数据将进入一个表，而其他数据将进入另一个表，这里是一个简单的示例。

Table1 有 3 个字段：姓名、年龄和性别。Table2 有 2 个字段：头发颜色、鞋码。因此，您的 CSV 可以像这样布置：

```
john smith,32,m,blonde,11
jane doe,29,f,red,4
anders anderson,56,m,grey,9 
```

对于下一步，您将使用函数[fgetcsv](http://www.php.net/fgetcsv/)。这会将 csv 的每一行分解为一个数组，然后您可以使用该数组来构建您的 SQL 语句：

```
if (($handle = fopen($mycsvfile, "r")) !== FALSE) {
    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        // this loops through each line of your csv, putting the values into array elements
        $sql1 = "INSERT INTO table1 (`name`, `age`, `sex`) values ('".$data[0]."', '".$data[1]."', '".$data[2]."')";
        $sql2 = "INSERT INTO table2 (`haircolour`, `shoesize`) values ('".$data[3]."', '".$data[4]."')";
    }
    fclose($handle);
} 
```

请注意，这没有考虑任何 SQL 安全性，例如验证，但这基本上是它的工作方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T21:05:27.530

作为上面提出的另一个变体，您可以逐行读取 CSV 并将每一行分解为字段。每个字段将对应一个变量。

```
$handle = fopen("/my/file.csv", "r"); // opening CSV file for reading
if ($handle) { // if file successfully opened
    while (($CSVrecord = fgets($handle, 4096)) !== false) { // iterating through each line of our CSV

        list($field1, $field2, $field3, $field4) = explode(',', $CSVrecord); // exploding CSV record (line) to the variables (fields)

        // and here you can easily compose SQL queries and map you data to the tables you need using simple variables

    }
    fclose($handle); // closing file handler
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T13:54:19.507

在我看来，这个问题似乎是区分哪个字段用于哪个表。当您发送标头时

```
 table.field, table.field, table.field 
```

然后拆分标题，您将获得所有表和字段。

这可能是一条路吗？

祝一切顺利

ps：因为你的评论...

csv 文件有/可以有第一行，其中包含字段名。当需要将 csv 数据复制到多个表中时，您可以使用一种解决方法来找出哪个字段适用于哪个表。

```
 user.username, user.lastname, blog.comment, blog.title
 "sam"        , "Manson"     , "this is a comment", "and I am a title" 
```

现在，在读取 csv 数据时，您可以处理第一行，在点处拆分标题以找出使用的表以及字段。

使用这种方法，您可以将 csv 数据复制到多个表中。

但这意味着，您必须先对其进行编码:(

拆分字段名

```
// only the first line for the fieldnames
$topfields = preg_split('/,|;|\t/')
foreach( $topfields as $t => $f ) {
   // t = tablename, f = field
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-24T10:53:56.817

```
if (($handle = fopen($mycsvfile, "r")) !== FALSE) {
    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        // this loops through each line of your csv, putting the values into array elements
        $sql1 = "INSERT INTO table1 (`name`, `age`, `sex`) values ('".$data[0]."', '".$data[1]."', '".$data[2]."')";
        $sql2 = "INSERT INTO table2 (`haircolour`, `shoesize`) values ('".$data[3]."', '".$data[4]."')";
    }
    fclose($handle);
} 
```

在上面的代码中，您使用了两个插入查询，您将如何运行这些查询？

# netbeans - 告诉 Glassfish 使用现有的 Zip 文件

> ID：11632318
> 
> 赞同：0
> 
> 时间：2012-07-24T13:49:34.877
> 
> 标签：netbeans, glassfish

我正在将 Glassfish 3.1.2 与 Dojo 1.7 一起使用，并且想缩短构建过程，maven 需要花费相当长的时间来复制每个构建的 dojo js 文件。我可以使用 CDN 版本的 dojo，但我希望能够在离线时进行调试。有没有办法告诉 Glassfish 使用预压缩的 dojo 源文件？需要明确的是，我不希望 Glassfish 为我压缩文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T21:36:57.340

能不能把需要的资源放在一个独立的WAR文件里，单独部署？您将拥有依赖于新 WAR 文件的资源的上下文路径（差异 URL），但您将能够部署它一次。

如果这不令人满意，您也可以编写一个小 servlet（打包在您的普通应用程序中）来公开您从放置在`glassfishv3/glassfish/domains/domain1/lib`. 这很容易通过 restful-ws 完成，一些库（primefaces）也有助于公开资源。

# android - 如何从 Android 中的 plist 中获取值？

> ID：11632320
> 
> 赞同：0
> 
> 时间：2012-07-24T13:49:40.463
> 
> 标签：android, xml-parsing, plist, saxparser

目前我在 Android 应用程序中工作，使用 plist 在 Resource 文件夹中存储一些值，然后我从 Android 中的 Resource 获取本地 plist 值，但我无法获取这些，如何在 Android 中解析本地 plist 值？请帮我

谢谢

这里我在这里提到了 Plist 值

```
<?xml version="1.0" encoding="UTF-8"?>
<array>
    <dict>
        <key>Code</key>
        <string>11</string>
        <key>Country</key>
        <string>Afghanistan</string>
    </dict>
    <dict>
        <key>Code</key>
        <string>12213</string>
        <key>Country</key>
        <string>Aland Islands</string>
    </dict>
    <dict>
        <key>Code</key>
        <string>24144</string>
        <key>Country</key>
        <string>Albania</string>
    </dict>
    <dict>
        <key>Code</key>
        <string>35223434</string>
        <key>Country</key>
        <string>Algeria</string>
    </dict>
</array> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T13:58:24.007

检查这个：[Android PList Parser](https://github.com/tenaciousRas/android-plist-parser)

测试中的示例用法 -

```
PListXMLParser parser = new PListXMLParser();
PListXMLHandler handler = new PListXMLHandler();
parser.setHandler(handler);
parser.parse(plistContentAsString);
PList plist = ((PListXMLHandler)parser.getHandler()).getPlist();
// use the plist
plist.getRootElement(); // get root element 
```

# osgi - 从非 osgi 类访问 osgi 包

> ID：11632321
> 
> 赞同：0
> 
> 时间：2012-07-24T13:49:54.223
> 
> 标签：osgi, osgi-bundle

我们可以从非 osgi 组件访问 osgi 包吗？例如，我们可以从非 osgi struts2 操作访问 osgi 包吗？如果是，那么如何提前感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T20:44:55.370

一切是如何部署的，访问是什么意思？

bundle 只是一个 jar 文件，因此它可以像任何其他 jar 一样在 Web 服务中使用。当它部署在 OSGi 框架中时，它只是一个 OSGi 包。如果您想将其用作库，那么没有问题，许多 jar 已经以这种方式工作。如果您想访问 OSGi 服务，那就另当别论了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-08T14:48:12.577

我们可以从其他应用程序访问 osgi 包

如果您有一个应用程序使用像 MyClass.java 这样的实体类，当您将该实体作为包部署在 Apache Karaf、Eqiunox 等 OSGI 容器上时

可能使用之前已安装的相同实体包的其他应用程序

当您复制需要使用的第一个标签时，然后将其粘贴为新项目 pom.xml 下的依赖项

这样做

```
<groupId>gobito.enterprise.solution</groupId>
<artifactId>myapp</artifactId>
<version>0.0.1</version> 
```

将其作为依赖项粘贴到另一个应用程序中，您可以在导入包“gobito.enterprise.solution”后使用 MyClass.java

```
 <dependency>
    <groupId>gobito.enterprise.solution</groupId>
    <artifactId>anotherapp</artifactId>
    <version>0.0.1</version>
 </dependency> 
```

# c# - 如何将 javascript 多维数组传递给 c#？

> ID：11632323
> 
> 赞同：1
> 
> 时间：2012-07-24T13:49:55.663
> 
> 标签：c#, javascript, code-behind

我需要将一个 js 多维数组（在编译时不知道维度）传递给我在 c# 中的代码隐藏，我通过以下方式完成了此操作：

```
var AdjustItems = ""; //My string variable to store the array separated with '|' and '-'
for (var i = 0; i < adjusts.length; i++) { //adjusts is my js array
    AdjustItems += adjusts[i].Motive + '|' + adjusts[i].Amount.toFixed(2).toString() + '-';
}
if (AdjustItems != "") {
    AdjustItems = AdjustItems.substring(0, AdjustItems.length - 1);
}
g('arrAdjust').value = AdjustItems; //arrAdjust is my hidden input. 
```

有没有另一种方法可以做到这一点，我可以得到数组，就像一个数组，而不是像 c# 中的一个字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:59:49.910

> 有没有另一种方法可以做到这一点，我可以得到数组，就像一个数组，而不是像 c# 中的一个字符串？

客户端和服务器之间通信的唯一方法是使用字符串。因此，您必须使用类库[`JSON`](http://www.json.org/)来在客户端和服务器之间传递复杂的变量。

您可以使用 javascript 的[内置 JSON](https://developer.mozilla.org/en/JSON)库将您的数组转换为字符串。这会将您的示例更改为以下内容：

```
g('arrAdjust').value = JSON.stringify(adjusts); 
```

然后，使用 C#`JSON`解析库将其转换为服务器端的数组。这个[stackoverflow 问题](https://stackoverflow.com/questions/1212344/parse-json-in-c-sharp)可以帮助您使用 C# 和解析 JSON。

# android - 在 iOS 上的 ODK 聚合上上传 XML 文件

> ID：11632324
> 
> 赞同：1
> 
> 时间：2012-07-24T13:49:58.383
> 
> 标签：android, ios, xml, html

我有一个适用于 ODK Aggregate 的 android 应用程序。应用程序根据用户在 xforms 上的输入生成一个 xml 文件，并通过 ODK 数据收集器将其上传到 ODK 服务器。任务是使此应用程序与 Android、iOS 设备和 windows 手机兼容。

由于ODK只是为android实现的，我们应该想办法通过HTML5或任何其他编程语言将xml文件上传到ODK服务器上，使其成为一个跨平台的。我知道 HTML5 可能是答案，但我迷路了，不知道我应该在哪里寻找可能的解决方案。任何形式的帮助都会有所帮助。

# c# - 寻找 [也许] 设计模式

> ID：11632326
> 
> 赞同：0
> 
> 时间：2012-07-24T13:50:00.640
> 
> 标签：c#, design-patterns

这是我的场景。用户在我的软件中选择了一个文档，我的软件从文档中提取了一些关键数据。该软件处理两种格式；PDF 和 DOCX。对于这些类型中的每一种，都有几个模板，上传的文档应该属于这些模板之一。我不知道这是否是一个众所周知的问题，以及是否存在解决这种情况的既定设计模式（这就是我在 SO 上的原因）。这是我到目前为止设计的：

由于每个模板都有特定的结构/内容，我正在考虑为每个模板创建单独的类。将有一个名为 IExtractor 的顶级接口，然后将有两个名为 PdfExtractor 和 DocxExtractor 的顶级类，每个类都实现 IExtractor 接口。所有 PDF（或 DOCX）模板共有的任何功能都将进入这些父类。

在这两个父类下面，会有几个模板类，每个模板一个。例如，一个名为 Template571_PdfExtractor 的类继承自 PdfExtractor，具有特定于模板 571 的方法，但提供的结果与任何其他提取器相同。

如果这很重要，我正在使用 C# 4.0。这是骨架：

界面：

```
interface IExtractor
{
void ExtractDocument(System.IO.FileInfo document, dsExtract dsToFill);
} 
```

两个父类：

```
public class DocxExtractor : IExtractor 
{
    public virtual void ExtractDocument(System.IO.FileInfo document, dsExtract dsToFill)
    {
    }
}

public class PdfExtractor : IExtractor 
{
    public virtual void ExtractDocument(System.IO.FileInfo document, dsExtract dsToFill)
    {
    }
} 
```

具体类之一：

```
public class Template571_PdfExtractor : PdfExtractor
{
    public virtual void ExtractDocument(System.IO.FileInfo document, dsExtract dsToFill)
    {
    }
} 
```

现在有几个关键问题我不确定。所有这些都围绕着我不知道如何以及在哪里实例化具体（模板）类的对象的问题。我可以使用文件扩展名来决定是否需要进入 PdfExtractor 树节点或 DocxExtractor 节点。之后，是文件的内容告诉我用户文档所属的模板。那么我把这个“决定”代码放在哪里呢？我的想法是将它放在 PdfExtractor 类（或 DocxExtractor ）中。这是正确的方法吗？

对不起，我有点长，但我不知道如何完全描述我的情况。谢谢你的想法。

舒贾特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:08:22.693

一旦您深入研究设计模式等，您肯定会发现大多数时候没有一种正确的方法来实现某些东西......

一种可能的方法是创建所谓的工厂类：一个用于 PdfExtractors，另一个用于 DocXExtractors。每个工厂类可能都有一个静态方法，例如

```
public final class PdfExtractorFactory {
   public static PdfExtractor getExtractor(String filename) { ... }

   ... // constructor, or singleton getter here
} 
```

决定要返回的 PdfExtractor 实例的具体子类（即使用哪个模板）的逻辑将驻留在工厂方法中。这样，抽象基类 PdfExtractor 及其子类都不会被这个决策逻辑弄乱。只有工厂类需要知道 PdfExtractor 的子类（分别是 DocXExtractor），而您的其余代码将完全不知道具体的子类，因为工厂传递了超类的实例。

由于您可能只需要 PdfExtractorFactory 和 DocXExtractorFactory 的单个实例，因此您可以选择将这些工厂类实现为单例。

**更新**：当然，您可以使用*静态*工厂方法或单例模式和*非静态*工厂方法（但您不需要两者）。

# xml - 使用 XSL 1.0 对已分组的记录进行分组并从 group-head 填充信息

> ID：11632327
> 
> 赞同：0
> 
> 时间：2012-07-24T13:50:00.070
> 
> 标签：xml, xslt, import, grouping, xslt-1.0

我正在尝试将我们会计系统的 XML 输出转换为可以导入 Access 的 XML。不幸的是，Access 只接受 XSL 1.0 进行转换，所以我已经请求帮助将 XSL 2.0 解决方案转换为在 XSL 1.0 下工作的东西。（[分组问题](https://stackoverflow.com/questions/11625288/grouping-of-a-well-defined-flat-xml-for-access-import-xslt-1-0)）。那里的解决方案非常适合我认为我需要的 Access 导入。

Access 导入现在可以工作，但我意识到数据的形式仍然不能真正使用。数据由标题行和子行组成，其中不填充标题数据。但是为了有意义地聚合，需要填充数据。

这是导入到 Access 中的当前 XML 的样子：

```
DBCDATE     |DBBCPARTY         |DBCVCHTYPE     |DBCVCHNO   |DBCVCHREF    
1-Apr-2011  |                  |Stock Journal  |1          |             
            |ME KN YARN B      |               |           |             
            |ME KN YARN G      |               |           |             
            |ME KN YARN I      |               |           |             
3-Apr-2011  |                  |Stock Journal  |2          |903          
            |TIB Raw Wool      |               |           |             
            |ME KN YARN D      |               |           | 
```

标题行中的字段也需要复制到子行中：**DBCDATE、DBCVCHTYPE、DBCVCHNO、DBCVCHREF、DBCNARR**。

我可以使用 Access 中的一些 VBA 编程来做到这一点，甚至可以将数据导出到 Excel 并应用一些公式，但是数据非常大，我们正在研究提取更多数据。而且它的灵活性会降低。此外，问题可能涉及对已分组的 XML 进行更多分组的方向（现在它以 InventoryDaybook 标记结构的形式分组为可导入的行。

所以这是原始的 XML：**编辑：增强的 XML 片段以进行更好的测试**

```
<ENVELOPE>
  <DBCFIXED>  <DBCDATE>1-Apr-2011</DBCDATE>
    <DBCPARTY></DBCPARTY>
  </DBCFIXED>
  <DBCVCHTYPE>Stock Journal</DBCVCHTYPE>
  <DBCVCHNO>1</DBCVCHNO>
  <DBCVCHREF></DBCVCHREF>
  <DBCSTNO></DBCSTNO>
  <DBCSERVICETAXNO></DBCSERVICETAXNO>
  <DBCPANNO></DBCPANNO>
  <DBCCSTNO></DBCCSTNO>
  <DBCNARR>Opening balance transfar</DBCNARR>
  <DBCQTY>0.000 Kg</DBCQTY>
  <DBCRATE></DBCRATE>
  <DBCAMOUNT></DBCAMOUNT>
  <DBCADDLCOST></DBCADDLCOST>
  <DBCGROSSAMT></DBCGROSSAMT>
  <DBCLEDAMT></DBCLEDAMT>
  <DBCFIXED>  <DBCDATE></DBCDATE>
    <DBCPARTY>ME KN YARN BL 1</DBCPARTY>
  </DBCFIXED>
  <DBCVCHTYPE></DBCVCHTYPE>
  <DBCVCHNO></DBCVCHNO>
  <DBCVCHREF></DBCVCHREF>
  <DBCSTNO></DBCSTNO>
  <DBCSERVICETAXNO></DBCSERVICETAXNO>
  <DBCPANNO></DBCPANNO>
  <DBCCSTNO></DBCCSTNO>
  <DBCNARR></DBCNARR>
  <DBCQTY>0.150 Kg</DBCQTY>
  <DBCRATE>566.00/Kg</DBCRATE>
  <DBCAMOUNT>-84.90</DBCAMOUNT>
  <DBCADDLCOST></DBCADDLCOST>
  <DBCGROSSAMT></DBCGROSSAMT>
  <DBCLEDAMT></DBCLEDAMT>
  <DBCFIXED>  <DBCDATE>1-Apr-2011</DBCDATE>
    <DBCPARTY></DBCPARTY>
  </DBCFIXED>
  <DBCVCHTYPE>Stock Journal</DBCVCHTYPE>
  <DBCVCHNO>2</DBCVCHNO>
  <DBCVCHREF>903</DBCVCHREF>
  <DBCSTNO></DBCSTNO>
  <DBCSERVICETAXNO></DBCSERVICETAXNO>
  <DBCPANNO></DBCPANNO>
  <DBCCSTNO></DBCCSTNO>
  <DBCNARR>Opening balance transfar</DBCNARR>
  <DBCQTY>0.000 Kg</DBCQTY>
  <DBCRATE></DBCRATE>
  <DBCAMOUNT></DBCAMOUNT>
  <DBCADDLCOST></DBCADDLCOST>
  <DBCGROSSAMT></DBCGROSSAMT>
  <DBCLEDAMT></DBCLEDAMT>
  <DBCFIXED>  <DBCDATE></DBCDATE>
    <DBCPARTY>ME KN YARN BL 1</DBCPARTY>
  </DBCFIXED>
  <DBCVCHTYPE></DBCVCHTYPE>
  <DBCVCHNO></DBCVCHNO>
  <DBCVCHREF></DBCVCHREF>
  <DBCSTNO></DBCSTNO>
  <DBCSERVICETAXNO></DBCSERVICETAXNO>
  <DBCPANNO></DBCPANNO>
  <DBCCSTNO></DBCCSTNO>
  <DBCNARR></DBCNARR>
  <DBCQTY>0.260 Kg</DBCQTY>
  <DBCRATE>26.00/Kg</DBCRATE>
  <DBCAMOUNT>-8.70</DBCAMOUNT>
  <DBCADDLCOST></DBCADDLCOST>
  <DBCGROSSAMT></DBCGROSSAMT>
  <DBCLEDAMT></DBCLEDAMT>
  <DBCFIXED>  <DBCDATE></DBCDATE>
    <DBCPARTY>ME KN YARN BL 1</DBCPARTY>
  </DBCFIXED>
  <DBCVCHTYPE></DBCVCHTYPE>
  <DBCVCHNO></DBCVCHNO>
  <DBCVCHREF></DBCVCHREF>
  <DBCSTNO></DBCSTNO>
  <DBCSERVICETAXNO></DBCSERVICETAXNO>
  <DBCPANNO></DBCPANNO>
  <DBCCSTNO></DBCCSTNO>
  <DBCNARR></DBCNARR>
  <DBCQTY>0.360 Kg</DBCQTY>
  <DBCRATE>21.00/Kg</DBCRATE>
  <DBCAMOUNT>-45.80</DBCAMOUNT>
  <DBCADDLCOST></DBCADDLCOST>
  <DBCGROSSAMT></DBCGROSSAMT>
  <DBCLEDAMT></DBCLEDAMT>
</ENVELOPE> 
```

这是 XSL (XSLT 1.0)，与解决方案略有不同：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" omit-xml-declaration="yes" indent="yes"/>
   <xsl:key name="records" match="ENVELOPE/*[not(self::DBCFIXED)]" use="generate-id(preceding-sibling::DBCFIXED[1])" />
   <xsl:template match="/ENVELOPE">
      <Data>
         <xsl:apply-templates select="DBCFIXED" />
      </Data>
   </xsl:template>

   <xsl:template match="DBCFIXED">
      <InventoryDaybook>
         <xsl:copy-of select="./*" />
         <xsl:apply-templates select="key('records', generate-id())" />
      </InventoryDaybook>
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

**编辑：提供生成的 XML**（感谢 Martin 指出缺少的生成 XML）

这就是 XML 最终的样子： InventoryDaybook 包装标签已进一步区分为一个“标题”标签，其中包含有关日期、凭证类型、凭证编号、凭证参考和叙述的信息。需要将这些字段 DBCDATE、DBCVCHTYPE、DBCVCHNO、DBCVCHREF、DBCNARR 复制到其他 InventoryDaybook 包装标签，这些标签代表“子”行。'Headers' 可以由 DBCDATE 识别 - 此字段仅为标题行设置。

```
<Data>
   <InventoryDaybook name="header">
      <DBCDATE>1-Apr-2011</DBCDATE>
      <DBCPARTY/>
      <DBCVCHTYPE>Stock Journal</DBCVCHTYPE>
      <DBCVCHNO>1</DBCVCHNO>
      <DBCVCHREF/>
      <DBCSTNO/>
      <DBCSERVICETAXNO/>
      <DBCPANNO/>
      <DBCCSTNO/>
      <DBCNARR>Opening balance transfar</DBCNARR>
      <DBCQTY>0.000 Kg</DBCQTY>
      <DBCRATE/>
      <DBCAMOUNT/>
      <DBCADDLCOST/>
      <DBCGROSSAMT/>
      <DBCLEDAMT/>
   </InventoryDaybook>
   <InventoryDaybook name="sub">
      <DBCDATE>1-Apr-2011</DBCDATE>
      <DBCPARTY>ME KN YARN BL 1</DBCPARTY>
      <DBCVCHTYPE>Stock Journal</DBCVCHTYPE>
      <DBCVCHNO>1</DBCVCHNO>
      <DBCVCHREF/>
      <DBCSTNO/>
      <DBCSERVICETAXNO/>
      <DBCPANNO/>
      <DBCCSTNO/>
      <DBCNARR>Opening balance transfar</DBCNARR>
      <DBCQTY>0.150 Kg</DBCQTY>
      <DBCRATE>566.00/Kg</DBCRATE>
      <DBCAMOUNT>-84.90</DBCAMOUNT>
      <DBCADDLCOST/>
      <DBCGROSSAMT/>
      <DBCLEDAMT/>
   </InventoryDaybook>
   <InventoryDaybook name="header">
      <DBCDATE>1-Apr-2011</DBCDATE>
      <DBCPARTY/>
      <DBCVCHTYPE>Stock Journal</DBCVCHTYPE>
      <DBCVCHNO>2</DBCVCHNO>
      <DBCVCHREF>903</DBCVCHREF>
      <DBCSTNO/>
      <DBCSERVICETAXNO/>
      <DBCPANNO/>
      <DBCCSTNO/>
      <DBCNARR>Opening balance transfar</DBCNARR>
      <DBCQTY>0.000 Kg</DBCQTY>
      <DBCRATE/>
      <DBCAMOUNT/>
      <DBCADDLCOST/>
      <DBCGROSSAMT/>
      <DBCLEDAMT/>
   </InventoryDaybook>
   <InventoryDaybook name="sub">
      <DBCDATE>1-Apr-2011</DBCDATE>
      <DBCPARTY>ME KN YARN BL 1</DBCPARTY>
      <DBCVCHTYPE>Stock Journal</DBCVCHTYPE>
      <DBCVCHNO>2</DBCVCHNO>
      <DBCVCHREF>903</DBCVCHREF>
      <DBCSTNO/>
      <DBCSERVICETAXNO/>
      <DBCPANNO/>
      <DBCCSTNO/>
      <DBCNARR>Opening balance transfar</DBCNARR>
      <DBCQTY>0.260 Kg</DBCQTY>
      <DBCRATE>26.00/Kg</DBCRATE>
      <DBCAMOUNT>-8.70</DBCAMOUNT>
      <DBCADDLCOST/>
      <DBCGROSSAMT/>
      <DBCLEDAMT/>
   </InventoryDaybook>
   <InventoryDaybook name="sub">
      <DBCDATE>1-Apr-2011</DBCDATE>
      <DBCPARTY>ME KN YARN BL 1</DBCPARTY>
      <DBCVCHTYPE>Stock Journal</DBCVCHTYPE>
      <DBCVCHNO>2</DBCVCHNO>
      <DBCVCHREF>903</DBCVCHREF>
      <DBCSTNO/>
      <DBCSERVICETAXNO/>
      <DBCPANNO/>
      <DBCCSTNO/>
      <DBCNARR>Opening balance transfar</DBCNARR>
      <DBCQTY>0.360 Kg</DBCQTY>
      <DBCRATE>21.00/Kg</DBCRATE>
      <DBCAMOUNT>-45.80</DBCAMOUNT>
      <DBCADDLCOST/>
      <DBCGROSSAMT/>
      <DBCLEDAMT/>
   </InventoryDaybook>
</Data> 
```

有没有办法在 XSL 中做到这一点？我还想知道这是否意味着再次转换返回的 XML？这个解决方案中的东西？[双变换题的解法](https://stackoverflow.com/questions/8822956/transforming-transformed-xml-with-xsl)

我意识到我在论坛上问了两次同样的大问题，但我真的很感谢你在这方面的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T07:59:56.510

您当然可以使用单页管道解决方案。这是一个使用两个分组键的非管道解决方案。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes"/>
<xsl:strip-space elements="*" />  

   <xsl:key name="header" match="ENVELOPE/*" use="generate-id(
  (preceding-sibling::DBCFIXED[DBCDATE != '']|self::DBCFIXED[DBCDATE != ''])[last()])" />
   <!-- The header key groups all the nodes belonging to a DBCDATE. This is
        a big group containing a number of 'sub' subgroups. -->

   <xsl:key name="sub" match="ENVELOPE/*" use="generate-id(
  (preceding-sibling::DBCFIXED|self::DBCFIXED)[last()])" />
   <!-- The sub key groups all the nodes under a DBCFIXED. This corresponds to
        one row in Access -->

   <xsl:template match="/*">
    <!-- This is our entry template. We gather up all the big header groups,
         and process them one group at a time in 'header' mode. -->  
      <Data>
         <xsl:apply-templates select="DBCFIXED[DBCDATE != '']" mode="header" />
      </Data>
   </xsl:template>

   <xsl:template match="DBCFIXED" mode="header">
    <!-- In this template we process the header group. -->
      <InventoryDaybook name="header">
         <!-- The first sub-group of the header group is to be marked as
              @name="header". Process the header subgroup -->
         <xsl:apply-templates select="key('sub', generate-id())" />
      </InventoryDaybook>
      <!-- Now process the other subgroups. These will be marked @name="sub". --> 
      <xsl:apply-templates select="
        key('header', generate-id()) /
        self::DBCFIXED[DBCDATE = '']"
        mode="sub" />
   </xsl:template>

   <xsl:template match="DBCFIXED" mode="sub">
      <!-- Processing a "sub" subgroup. -->
      <InventoryDaybook name="sub">
         <xsl:apply-templates select="key('sub', generate-id())" />
         <!-- The above selects the members of the subgroup. -->
      </InventoryDaybook>
   </xsl:template>

  <xsl:template match="ENVELOPE/*
    [not(self::DBCFIXED)]
    [preceding-sibling::DBCFIXED[1][DBCDATE = '']]
    [.='']">
  <!-- When we are processing a normal node in a 'sub' subgroup AND
       it doesn't have a value, pick up the default value from
       the related 'header' subgroup. This rule doesn't work for
       the DBCFIXED node. We need a special template for that. -->
      <xsl:copy>
        <xsl:value-of select="
        key('sub', generate-id(
        preceding-sibling::DBCFIXED[DBCDATE != ''][1]))        
        [local-name()=local-name(current())][1] " />
      </xsl:copy>
   </xsl:template>

   <xsl:template match="DBCFIXED">
      <!-- Flatten out the DBCFIXED node. -->
      <xsl:apply-templates select="@*|node()"/>
   </xsl:template>

   <xsl:template match="DBCDATE[ . = '']">
     <!-- Pick-up the default date from the parent DBCDATE. -->
      <xsl:copy>
        <xsl:value-of select="
        ../preceding-sibling::DBCFIXED/
        DBCDATE[ . != ''][1]" />        
      </xsl:copy>
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>

</xsl:stylesheet> 
```

# android - 如果应用程序不在前台，则终止该应用程序

> ID：11632332
> 
> 赞同：0
> 
> 时间：2012-07-24T13:50:08.477
> 
> 标签：android

有什么方法可以在应用程序进入后台后立即杀死它。例如，如果我按下主页键并再次启动应用程序，它会进入相同的活动，但我想要的是，一旦应用程序进入后台，它应该被杀死或者它应该从第一个活动开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:57:13.710

它不会“杀死”您的应用程序本身，但这会给您带来您想要的效果。

使用 FLAG_NO_HISTORY 使意图用于开始您的第二个活动。这样他们一离开屏幕就会完成。

```
Intent i = new Intent(this, SomeOtherActivity.class);
i.addFlags(Intent.FLAG_ACTIVITY_NO_HISTORY);
startActivity(i); 
```

当您的活动离开屏幕时，它将完成，这将导致它在下次从主屏幕启动时从起始活动启动。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-24T14:01:01.383

您可以在用户按下主页按钮时捕获事件，如下所示

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if ((keyCode == KeyEvent.KEYCODE_HOME)) {
        finish();
    }
    return super.onKeyDown(keyCode, event);
} 
```

您还可以覆盖`onBackPressed()`活动中的方法并从那里调用完成。

# c# - 具有多个连接条件的 linq to sql 外部左连接

> ID：11632334
> 
> 赞同：3
> 
> 时间：2012-07-24T13:50:17.107
> 
> 标签：c#, asp.net, linq-to-sql, code-behind

我有一个需要连接并从中选择值的两个表，连接需要左外连接。我正在尝试使用 linq to sql 但得到 0 而不是实际值

**参考资料表：**

```
refType varchar(250),
description varchar(250) 
```

**演示文稿类型（我的另一个表）**

```
id int
refType varchar(250),
OtherFundings varchar(250) 
```

我正在使用的查询是

```
string organization = (string)Session["organization"];
int FiscalYear = Int32.Parse((string)Session["fiscalyear"]);
string ReportingPeriod = (string)Session["reportingperiod"];

var presentationType = from pt in OCHART.References
                       join rf in OCHART.OCHART_PresentationTypes on pt.RefType equals rf.RefType into prt                                       
                       from x in prt.Where(prt2 => prt2.OrganizationName.Equals(organization) && prt2.ReportingPeriod.Equals(ReportingPeriod) && prt2.FiscalYear == FiscalYear).DefaultIfEmpty()
                        where pt.RefType.Equals("09-10.1b")                                          
                        orderby pt.RefOrder ascending
                        select new {
                              refType = pt.RefType, 
                              refName = pt.Description,
                              otherFundings = (x.Fundings == null ? 0 : x.Fundings), 
                              id = (x.id == null ? 0 : x.id)
                         }; 
```

但是我得到 id = 0 和 otherFunding = 0 尽管第二个表中有正确的值。我真的不确定我做错了什么。

将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:55:55.260

我很讨厌在很长一段时间的头疼之后提出一个问题，而不是在我自己找到解决方案之后。

请忽略这个问题，我的问题是没有链接正确的加入字段。

再次抱歉。

# jquery - 将JQUERY操作的HTML表格数据保存到ASP.NET中（最好是Session）

> ID：11632346
> 
> 赞同：2
> 
> 时间：2012-07-24T13:50:56.797
> 
> 标签：jquery, asp.net, html, vb.net, json

我有几个 HTML 表，我正在使用 jQuery 将行从一个 html 表移动/随机排列到另一个。洗牌完成后，我需要找到一种方法将这些表保存在服务器端（最好在 Session 中），以便可以在下一页检索它们。

作为第一步，我尝试将更改后的 DOM 保存在 ASP.NET 文本框中，以便我可以将整个 html 带到 ASP.NET 端（然后使用 VB.NET 代码处理它以保存在会话/缓存中）。

```
var html = $('html').clone();
var htmlString = html.html();

$('#TextBox1').val(htmlString); 
```

但我被困在我收到以下错误的第一步

“从客户端检测到潜在危险`Request.Form`值`TextBox1 ...`”

请有人指导我如何将这些 HTML 表保存在服务器端，以便我可以使用 ASP.NET 来读取和处理它们？我应该寻找 JSON 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T15:13:20.667

如果您的目标是将表的数据发布到服务器，我通常将表的行转换为对象，并通过 ajax() 将数据作为 JSON 发布。您可以添加一个单击事件以在用户按下将触发回发或任何其他事件的按钮时自动触发此事件。

例子：

**客户端**

```
 // Wire up posting the data to the server with a ASP.NET button
    $('#<%= Save.ClientID %>').click(function (e) {
        PostTable();
    });

    // Read a row
    function GetRow(rowNum) {
        var tableRow = $('#partTable tbody tr').eq(rowNum);

        var row = {};

        row.ChangeType = tableRow.find('td:eq(1)').text();
        row.UpdateType = tableRow.find('td:eq(2)').text();
        row.Part = tableRow.find('td:eq(5)').text();
        row.Price = tableRow.find('td:eq(7)').text();
        row.UOM = tableRow.find('td:eq(8)').text();
        row.ApplyDate = tableRow.find('td:eq(9)').text();
        row.Remarks = tableRow.find('td:eq(10)').text();

        return row;
    }

    // Read all rows
    function GetAllRows() {
        var dataRows = [];

        $('#partTable tbody tr').each(function (index, value) {
            var currentRow = GetRow(index);
            dataRows.push(currentRow);
        });

        return dataRows;
    }

    // POST rows to server
    function PostTable() {
        var crossId = getParameterByName('id');
        var jsonRequest = { rows: GetAllRows(), crossId: crossId };

        $.ajax({
            type: 'POST',
            url: 'TableProcessingViajQueryAjax.aspx/SaveRows',
            data: JSON.stringify(jsonRequest),
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            async: false,
            success: function (data, text) {
                return true;
            },
            error:function (request, status, error){
                return false;
            } 
```

**服务器端**

```
 [WebMethod]
    public static bool SaveRows(List<Row> rows, int crossId)
    {
        // Do something with your data, maybe put in session/cache/db/etc...
    } 
```

**服务器端（对象必须匹配在 JS 中创建的对象）**

```
public class Row
{
    public string ChangeType { get; set; }
    public string UpdateType { get; set; }
    public string Part { get; set; }
    public double Price { get; set; }
    public int UOM { get; set; }
    public DateTime ApplyDate { get; set; }
    public string Remarks { get; set; }
} 
```

** 我正在使用 JSON.ORG 的“stringify”将我的对象转换为有效的 JSON 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T14:38:58.737

在不禁用请​​求验证的情况下解决此问题的一种方法是将 HTML 数据编码为 ASP.NET 不会检测为潜在危险请求的内容。这样的选项是[base64](http://en.wikipedia.org/wiki/Base64)编码。

由于您已经在使用 jquery；您可以使用众多 base64 插件之一轻松获取 html 并对其进行编码（[此处为一个示例](https://github.com/carlo/jquery-base64)）。

现在你需要做的就是：

```
$('#TextBox1').val(base64encodedhtmlString); 
```

并将其转换回服务器端，如下所示：

```
string encodedstring = ASCIIEncoding.UTF8.GetString(Convert.FromBase64String(text.Text)); 
```

假设您的页面使用 utf-8 编码，如：`<meta charset="utf-8">`.

**注意**：这个“解决方案”是一个 hack。我会寻找一种替代方法来做你需要做的事情而不做这样的事情。它闻起来臭臭的。

**更新**：

为您添加一个[jsfiddle](http://jsfiddle.net/JXFJU/)。请注意“管理资源”部分。我正在使用上面链接的插件。

您可以从我的示例 ( `PHRhYmxlIGlkPSJzb21ldGFibGUiIGNlbGxwYWRkaW5nPSI1IiBib3JkZXI9IjIiPgogIDx0Ym9keT48dHI+CiAgICAgPHRkPmJsYWg8L3RkPgogICAgIDx0ZD5ibGFoPC90ZD4KICAgICA8dGQ+YmxhaDwvdGQ+CiAgIDwvdHI+CjwvdGJvZHk+PC90YWJsZT4=`) 中获取输出并[在此处对其进行解码，](http://www.opinionatedgeek.com/dotnet/tools/base64decode/)以验证它实际上包含原始 html。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:03:03.897

您可以遵循以下解决方案：

```
<%@ Page Language="C#" ValidateRequest="false" %> 
```

但是验证请求检查潜在危险的请求你也可以阅读[这个](http://www.dreamincode.net/forums/topic/234664-potentially-dangerous-requestform-value-was-detected-from-the-client/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T14:11:16.367

您是否尝试过使用 HiddenField 而不是 TextBox？我不记得您是否使用 HiddenField 获得“潜在危险的 Request.Form 值”。我想它可能仍然存在。

无论如何，我会尝试使用 JSON 而不是尝试发送 HTML 表的代码（这在服务器端会更难解析）。您可以使用 jQuery 来操作您的数据并保存在 javascript 变量（对象数组？）中，而不是直接修改 HTML 表格；然后根据这些变量重建您的 HTML 表格显示。

您可以将客户端上的数据序列化为 JSON (JSON.stringify) 并将其发送到 HiddenField 中的服务器。然后在服务器上，您可以使用 JavaScriptSerializer 对其进行反序列化并在服务器上处理该数据。在另一个页面上，您可以创建另一个 HiddenField 并使用 JavaScriptSerializer 将您的数据序列化到 HiddenField；然后您的客户端代码可以反序列化 JSON 以将数据加载到变量中并使用这些变量重建 HTML 表格显示。

JSON2 示例...

```
// Serialize
var value_for_hidden_field = JSON.stringify(my_js_variable);  
$("#HiddenField1").val(value_for_hidden_field); 

// Deserialize
var my_js_variable = JSON.parse($("#HiddenField1").val()); 
```

ASP.Net 示例...
这过于简化了，因为您需要使用已设置的类来处理数据，但它可以让您大致了解要调用的方法。

```
' Deserialize
Dim jss As New System.Web.Script.Serialization.JavaScriptSerializer
Dim json_x  = jss.Deserialize(Of YourClassName)(HiddenField1.Value)

' Serialize
Dim jss As New System.Web.Script.Serialization.JavaScriptSerializer
Dim json_x As New YourClassName = GetYourData() ' Returning appropriate object
HiddenField1.Value = jss.Serialize(json_x) 
```

# c++ - memset 在模板类构造函数中泄漏 mem

> ID：11632348
> 
> 赞同：0
> 
> 时间：2012-07-24T13:50:58.950
> 
> 标签：c++, templates, constructor, memory-leaks, memset

这个类 ctor 正在泄漏内存，我不能说发生了什么。我怎么知道？如果我注释掉第二个 ctor 行，泄漏就会消失。

```
template< class T, int fixedSize >
class Resource_Cache{

private:

    ID3D11Device * m_pDeviceRef;    // the one that actually can create stuff

    UINT m_iCurrentIndex;           // next slot to be allocated, also the ID of the resources
    //UINT m_nFreedSlots;               // how many freed slot there are?

    T* m_cache[fixedSize];          // the container per se

    struct SlotInfo{

        UINT nUseCount;
        Resource_Descriptor<T> desc;

    } m_slotsInfo[fixedSize];//use a hashtable<desc,index on m_cache>;

    Resource_Cache();   //denied default ctor

public:

    Resource_Cache( ID3D11Device * pDevice_p ): m_pDeviceRef(pDevice_p), m_iCurrentIndex(0){

        memset(m_cache, NULL, fixedSize*sizeof(T*));
        memset( m_slotsInfo, 0, fixedSize*sizeof(SlotInfo));    // zero slotsInfo memory(CAUSING LEAKS)
    }
 ... 
```

可能是简单的东西，但我无能为力..

*   编辑答案 - 正如 PermanentGuest 所说：不。它不会给基本类型带来问题。但是，如果您的类型 T 的 Resource_Descriptor 有一些实现，它通过 memset 在构造函数（例如字符串）中分配内存，您将将该类的任何内部指针重置为 NULL，从而拒绝其析构函数删除内存的机会。– 永久客人

std::string 是问题，解决了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:13:25.370

代替

```
Resource_Cache( ID3D11Device * pDevice_p ): m_pDeviceRef(pDevice_p), m_iCurrentIndex(0){

        memset(m_cache, NULL, fixedSize*sizeof(T*));
        memset( m_slotsInfo, 0, fixedSize*sizeof(SlotInfo));    // zero slotsInfo memory(CAUSING LEAKS)
    } 
```

做

```
Resource_Cache( ID3D11Device * pDevice_p )
    : m_pDeviceRef( pDevice_p )
    , m_iCurrentIndex()
    , m_cache()
    , m_slotsInfo()
{} 
```

我很确定这*不会*治愈您断定是由于内存泄漏或内存泄漏（如果有）引起的症状，但至少它消除了您所关注的可能原因，方法是在 (安全的）C++ 而不是（不安全的）C。

哦，好吧，由于未指定的根本没有描述，`Resource_Descriptor<T>`它实际上可能会解决问题。`memset`但是，如果那不是 POD，您就不会使用，是吗？或者，也许你会？

# c# - 如何保存来自 RestResponse 的 cookie 并将它们传递给下一个 RestRequest？

> ID：11632351
> 
> 赞同：8
> 
> 时间：2012-07-24T13:51:11.270
> 
> 标签：c#, rest, cookies, restsharp, rightscale

如果有人可以帮助我解决我的问题，我将非常感激。

我使用 RestSharp 库编写了一个 C# 代码来与 RightScale API 交互。

该代码适用于一组用户名和密码，但是当我用新的用户名和密码替换用户名和密码时，我得到响应“基本身份验证已被不推荐用于登录以外的调用。请“登录”以获取会话并通过会议返回以采取进一步行动。”

谁能指导我正确的方向？我发现代码仅适用于一组凭据而不适用于任何其他用户名和密码，这真的很奇怪。

如何保存 cookie 并将它们作为参考传递给下一个`RestRequest`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-10-30T03:40:31.557

RestSharp 102.4+ 支持`System.Net.CookieContainer`对来自同一`IRestClient`. 通过这样做，响应中设置或取消设置的任何 cookie 都将在后续请求中使用。要使用 shared `CookieContainer`，只需`RestClient`在使用之前在实例上设置属性：

```
var client = new RestClient("http://server/");
client.CookieContainer = new System.Net.CookieContainer(); 
```

来源：[https ://github.com/restsharp/RestSharp/wiki/Cookies](https://github.com/restsharp/RestSharp/wiki/Cookies)

# python - GAE 强制推送任务队列以执行下一个任务

> ID：11632360
> 
> 赞同：3
> 
> 时间：2012-07-24T13:51:36.950
> 
> 标签：python, google-app-engine, task, task-queue

我在 GAE 中以 1/s 的速率推送任务队列。并非该队列上的每个任务都需要执行，但我只能在调用它时验证这一点。因此，每当调用任务时，我都有“if（条件）执行 else drop”语句。

现在我的问题是我有太多的任务，其中很多会被丢弃。我不想仅仅等待下一秒调用另一个任务，而是强制我的队列调用下一个任务，这样一秒就不会被浪费。

我想问的是 - 是否可以强制队列立即获得另一个任务而不是等待？还是我应该自己实施？

如果不清楚，对不起，我会尽量用更好的词来表达。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T14:08:21.740

您需要使用[拉任务](https://developers.google.com/appengine/docs/python/taskqueue/overview-pull)，因为每个推任务队列也是拉任务。当您的推送任务执行从拉取队列中租用一批任务并检查它们的条件时。
下一步将丢弃所有不再“有效”的任务并执行单个有效任务。一旦你执行了一个有效的任务，你就会返回所有剩余的任务（将它们的时间租为零）。

如果存在有效任务，则此流程应为每个推送任务授予至少一个任务。

# c# - MySQL 支持的 Entity Framework 应用程序只能在我的 PC 上运行

> ID：11632361
> 
> 赞同：0
> 
> 时间：2012-07-24T13:51:37.323
> 
> 标签：c#, mysql, entity-framework

我在 Windows 窗体中创建了这个应用程序，它通过实体框架管理 MySQL 数据库。我已经将它发布并安装在我的系统上，它运行良好......但是当我将它发送给我的朋友并且他试图运行它时，出现了这个错误（抱歉我的翻译不好）：

> System.TypeInitializationException：[类型启动器提示类型错误]'Kwestionariusz.Stuff.EntityManager'。---> System.ArgumentException：[在配置中找不到仓库的供应商或不正确] ---> System.ArgumentException：[找不到想要的应用程序数据供应商。它可能没有安装]。[输入] System.Data.Common.DbProviderFactories.GetFactory（字符串 providerInvariantName） [输入] System.Data.EntityClient.EntityConnection.GetFactory（字符串 providerString）

他们要我安装什么，为什么没有通过安装我的软件来安装？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:00:29.310

您是否在目标机器上安装了 MySQL 访问器组件？它们不包含在 .NET 框架中，您可能在开始解决方案之前也安装了它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:58:06.213

我对这项技术一无所知，但是您是否需要应用程序知道从何处获取数据的个人电脑上的 odbc 或其他替代数据定义？

你的描述我看不懂你已经这样做了，如果有问题，错误消息似乎也显示这种类型？

祝一切顺利

# php - PHP noob 上只有一个已知 ID 的多值引用

> ID：11632362
> 
> 赞同：2
> 
> 时间：2012-07-24T13:51:39.690
> 
> 标签：php, mysql

我有这个 mysql 表

```
id    parent_id
1      NULL
2       1
3       1
4       2
5       4
6       5 
```

以此类推，注意这是传销构造的结构。

id 是成员的不可重复编号，而 parent_id 是他们的上线。

在这种情况下，成员 id 6 的上线是 id 5，成员 id 4 是 id 5 的上线，成员 id 2 是成员 id 4 的上线，所有这些都使这些人成为成员 id 6 的上线。

我知道我可以通过获取其父 ID 来检索成员 ID 6 的直接上线，并且我们拥有的唯一值是成员 ID = 6，我们通过获取父 ID 来获取其直接上线，以及如何获取父的父 ID id of 6, parent id of parent id of parent id of 6 依此类推。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:58:55.263

对于递归数据，你最好看看嵌套集。那是一种使用 sql 管理树数据的技术。

[http://en.wikipedia.org/wiki/Nested_set_model](http://en.wikipedia.org/wiki/Nested_set_model)

[http://www.klempert.de/nested_sets/](http://www.klempert.de/nested_sets/)（德语）

# mysql - 从 ms 访问导出 ascii xml

> ID：11632366
> 
> 赞同：1
> 
> 时间：2012-07-24T13:51:46.790
> 
> 标签：mysql, ms-access, export

我有一个 MS ACCESS DB .accdb，并想将其转换为 mysql。问题是 MS Access 数据在 armscii 中，我想用 utf8 将它保存在 mysql 中

我已经用 php 创建了一个转换脚本

问题是我没有任何 ODBC 也不能使用 ODBC，所以我尝试将 MS Access 数据导出到 xml，但它没有 ARMSCII 编码，只有 utf8 或 utf 16

你能否给我一个建议如何实现我的目标！谢谢

# php - 无法让 PHP 调试与 Komodo 一起工作（但我快到了！）

> ID：11632369
> 
> 赞同：1
> 
> 时间：2012-07-24T13:51:53.137
> 
> 标签：php, xdebug, remote-debugging, komodo

我大约一周前发布了这个，但从那以后我做了一些进一步的故障排除，所以我认为值得再次发布：

我正在尝试使用 Komodo 附带的 Xdebug 扩展在 Komodo 7 中设置 PHP 调试。扩展似乎工作正常，当我尝试启动调试会话时，Komodo 会做出响应。

然而，Komodo 不允许我单步执行我的 PHP 代码。相反，它只是在 Komodo 窗口右下角的窗格中运行代码。

作为记录，我没有任何映射的 URI。

我非常感谢任何人能够提供的任何帮助，因为我有一个网站需要为一个伟大的非营利组织进行调试，而这个问题让我无法工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T13:13:03.360

使用[调试器连接首选项](http://docs.activestate.com/komodo/7.0/prefs.html#DebuggerConnection)将 Komodo 侦听的端口从默认值 9000 更改[为系统提供的空闲端口](http://community.activestate.com/node/7848)、8080 或远程主机或本地主机正在运行的任何端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T12:19:30.847

最后，我在 IRC 上运行了 Activestate 的技术支持（#Komodo on irc.mozilla.org），他们真的很有帮助。但是，我们无法找出问题所在，所以我最终卸载了 XAMPP 和 Komodo，重新安装了两者，然后按照 Komodo 文档中的说明进行操作。

# php - Zend 验证码 html

> ID：11632370
> 
> 赞同：2
> 
> 时间：2012-07-24T13:51:53.590
> 
> 标签：php, html, zend-framework, decorator, captcha

我正在使用以下方法创建这样的验证码`Zend_Form`：

```
class Form_Signup extends Zend_Form {

    public function __construct( array $options = null ) {

        // set method
        $this->setMethod('post');

        // other elements here        

        // captcha 
        $captcha = new Zend_Form_Element_Captcha('captcha', array(
                'id'=>'captcha',
                'title'=>'Security Check.',
                'captcha' => array(
                'captcha' => 'Image',
                'required' => true,
                'font'=> 'fonts/ARIALN.TTF',
                'wordlen'=>'4',
                'width'=>'200',
                'height'=>'50',
                'ImgAlign'=>'left',
                'DotNoiseLevel'=>'30',
                'LineNoiseLevel'=>'7', 
                'Expiration'=>'1000',
                'fontsize'=>'30',
                'gcFreq'=>'10',
                'imgdir'=> 'images/captcha/',
                'ImgAlt'=>'Captcha',
                'imgurl'=>'/images/captcha/'
                )));
        $captcha->removeDecorator('HtmlTag')
        ->removeDecorator('Label')
        ->addDecorator('Label');        

        // add captcha
        $this->addElement( $captcha );          
        $this->setDecorators( array( array( 'ViewScript', array( 'viewScript' => 'signup/signup-form.phtml' ) ) ) );    
    } 

} 
```

它正在生成这样的 HTML：

```
<img width="200" height="50" alt="Captcha" src="/images/captcha/cabf4d4d759ae8e4b7404b95e032e231.png">
<input type="hidden" name="captcha[id]" value="cabf4d4d759ae8e4b7404b95e032e231" title="Security Check." id="captcha">
<input type="text" name="captcha[input]" id="captcha" value="" title="Security Check."> 
```

**但我想要像这样的图像下方的验证码文本框：**

```
<img width="200" height="50" alt="Captcha" src="/images/captcha/cabf4d4d759ae8e4b7404b95e032e231.png">
<br />
<input type="hidden" name="captcha[id]" value="cabf4d4d759ae8e4b7404b95e032e231" title="Security Check." id="captcha">
<input type="text" name="captcha[input]" id="captcha" value="" title="Security Check."> 
```

任何想法 ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:13:20.423

Zend Captcha 元素装饰器并不复杂。解决这个问题的最佳方法是创建我们自己的装饰器。一旦你完成它。您可以根据需要更改顺序

[你可以在这里](https://stackoverflow.com/questions/5131743/customize-zend-form-captcha-output)找到完整的答案

如果你不着急，并且如果你有足够的时间，那么请阅读 Methew 的[这篇文章](http://devzone.zend.com/1240/decorators-with-zend_form/)，解释如何使用装饰器。

几乎与我[在这里](https://stackoverflow.com/questions/9734427/zend-form-captcha-decorator)提出的相同问题，我不想创建一个单独的装饰器类，但没有得到任何正确的答案。然后我做了一些css技巧并被迫`<input type='text'>`下去。所以唯一的解决方案是生成自定义验证码装饰器类。

如果你在那里没有得到任何东西，请告诉我。谢谢

# asp.net - 如何获取已读回执并存储在字符串中？

> ID：11632372
> 
> 赞同：0
> 
> 时间：2012-07-24T13:52:00.937
> 
> 标签：asp.net, sendmail

在我的项目中，我创建了一个站点，我的用户或客户可以从该站点向其他用户发送一些文档。

我还想查看收件人是否已阅读邮件/是否已发送邮件。

现在我想存储结果的值，即“已发送”，以防邮件已成功传递。并在收件人打开或阅读邮件时“查看”。

我已经完成了这段代码

```
MailMessage mailme = new MailMessage();
mailme.DeliveryNotificationOptions = DeliveryNotificationOptions.OnSuccess; 
```

正如我上面所说，我想将值“Sent”或“Viewed”存储在一个字符串中。进一步将值存储在我的表中。

我如何得到想要的结果。基本上我需要获取投递报告并报告是否已查看邮件。

我还想获取收件人查看邮件的日期和时间。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:01:21.310

你可能正在寻找这个：

```
mailme.Headers.Add("Disposition-Notification-To", "yourmail@mail.com"); 
```

`"yourmail@mail.com"`如果邮件被阅读，应该在哪里收到邮件。

# javascript - 从列表标签和表格标签中删除 HTML 中的空格

> ID：11632381
> 
> 赞同：1
> 
> 时间：2012-07-24T13:52:32.973
> 
> 标签：javascript, html, css, list, html-table

我已经搜索了几个关于删除 Javascript 菜单与其正下方图像之间的空白的在线资源和[教程。](http://uniquemethod.com/remove-white-space-between-unordered-list-elements)我什至从代码中物理删除了空格，但无济于事

```
<tr>
        <td width="43" height="999" rowspan="16">
            <img src="images/spacer.gif" width="43" height="999" alt=""></td>
        <td colspan="13">
            <img src="images/Logo.gif" width="458" height="91" alt="The App-properties logo"> 
                                 <img src="images/Banner.gif" width="456" height="91" alt="Featured realestates">

                                           <ul class='dd_menu' style="margin-top: 0; margin-bottom:0px;">
            <li>  <img src="images/homeButton.gif" width="238" height="25" alt="App-properties Hompage">    <ul><li><a href='about_us.html' title="About App-properties"><p style="margin-bottom:0;">About Us</p></a></li></ul></li>
            <li><img src="images/salesButton.gif" width="97" height="24" alt="Property buying tips">
            <ul>
                <li><a href='latest_properties.html' title="latest properties in Spain"><p style="margin-bottom:0;">Featured Property</p></a></li>
                <li><a href='guide_to_buying.html' title="How to buy real estate"><p style="margin-bottom:0;">Guide to buying in spain</p></a></li>
                <li><a href='selling_property_tips.html' title="how to sell real estate"><p style="margin-bottom:0;">Sell your property with us</p></a></li>
            </ul>
            </li>
                <li><img src="images/rentalsButton.gif" width="94" height="23" alt="Renting property and real estate in spain">
            <ul>
                <li><a href='renting_property.html' title="renting property in Spain"> <p style="margin-bottom:0;">Search for a property</p></a></li>
                <li><a href='benefits_rented_property.html' title="Benefits of renting property at App-properties" ><p style="margin-bottom:0;">Rent your property with us</p></a></li>
            </ul>
            </li>
            <li><img src="images/mortgageButton.gif" width="118" height="24" alt="Buying property in Spain on a mortgage">
            <ul>
                <li><a href='realestate_finance.html' title="Financial assistance in buying real estate"><p style="margin-bottom:0;">Financial services we offer</p></a></li>
            </ul>
            </li>
                <li><img src="images/constructionButton.gif" width="97" height="24" alt="Constructing a new structure in a real estate">
            <ul>
                <li><a href='building_construction_spain.html' title="Building construction in Spain"><p style="margin-bottom:0;">Construction, reforms, planning & licences</p></a></li>
                <li><a href='disadvantages_building_in_spain.html' title="Difficulty in building in Spain"><p style="margin-bottom:0;">Is it hard to build in Spain?</p></a></li>
            </ul>
            </li>
                <li><img src="images/contactUs.gif" width="264" height="24" alt="">
            <ul>
                <li><a href='contact_us.html' title="Location of App-properties"><p style="margin-bottom:0;">Address</p></a></li>
                <li><a href='contact_us.html' title="Email of App-properties"><p style="margin-bottom:0;">E mail</p></a></li>
                <li><a href='contact_us.html' title="Phone number of App-properties"><p style="margin-bottom:0;">Phone number </p></a></li>
            </ul>
            </li>
            </ul>
        </td>
    </tr>
    <tr>
        <td width="19" height="122" colspan="2" rowspan="3">
            <img src="images/spacer.gif" width="19" height="122" alt=""></td>
        <td colspan="10">
            <img src="images/pathShower.gif" width="880" height="32" alt="Website Current location"></td>
        <td width="16" height="883" rowspan="15">
            <img src="images/spacer.gif" width="16" height="883" alt=""></td>
        <td>
            <img src="images/spacer.gif" width="1" height="32" alt=""></td>
    </tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:37:42.803

尝试将其添加到您的 CSS 中，看看它是否会产生影响并删除空格：

```
ul, li { margin:0 !important; padding:0 !important; } 
```

如果是这样，这只是将边距或填充设置为您需要的问题。

要查看的另一件事是这些元素的行高。尝试：

```
ul, li { line-height: 100%: } 
```

要查看的实时示例页面会很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:44:05.567

首先：使用像这样的“间隔”图像和布局表是一种非常过时的技术。

您的实际问题可能是：[https ://developer.mozilla.org/en/Images,_Tables,_and_Mysterious_Gaps](https://developer.mozilla.org/en/Images,_Tables,_and_Mysterious_Gaps)

# python - GTK ComboBox set_active_text：断言 `GTK_IS_COMBO_BOX (combo_box)' 失败

> ID：11632388
> 
> 赞同：1
> 
> 时间：2012-07-24T13:52:50.513
> 
> 标签：python, gtk, pygtk

我在我的应用程序中添加了一个 MS Word 式组合框，以允许用户更改字体大小。这是设置代码：

```
sizeBox = gtk.combo_box_new_text()
for size in xrange(MIN_FONT_SIZE, MAX_FONT_SIZE+1):
    sizeBox.append_text(str(size))

def UpdateFontSize(c, box):
    newSize = box.get_active_text()
    if newSize:
        self.textViewer.SetFontSize(int(newSize))

print sizeBox.get_active_text()
sizeBox.connect("changed", UpdateFontSize, sizeBox) 
```

运行我的程序并尝试更改组合框中的选定条目给了我这个：

```
None
OutNav.py:876: GtkWarning: gtk_combo_box_get_active_text: assertion `GTK_IS_COMBO_BOX (combo_box)' failed
   newSize = box.get_active_text() 
```

所以 get_active_text 在封闭范围内工作正常，但是当我将 ComboBox 作为回调的参数提供时，它突然停止工作。谁能告诉我这里发生了什么？（我想使用 ComboBoxText 显然 gtk.combo_box_new_text 已被弃用，但由于某种原因它不在我的 PyGTK 2.24 发行版中）

# php - 范围和 MySQLi 绑定

> ID：11632389
> 
> 赞同：1
> 
> 时间：2012-07-24T13:52:51.723
> 
> 标签：php, mysqli

我已经为 PHP 使用旧的 MySQL 库已有很长时间了，我终于屈服于使用 MySQLi。准备好的陈述似乎非常有用，所以我试图让他们出去玩。

现在我正在创建一些准备好的语句并全局绑定它们的参数，然后使用一个函数来执行它们，如下所示：

```
$stmt = $mysqli->prepare("INSERT ...");
$stmt->bind_param("ss", $var1, $var2);

function process($t) {
    global $mysqli, $stmt;
    $var1 = $t['var1'];
    $var2 = $t['var2'];
    $stmt->execute();
} 
```

我遇到的问题是执行函数遇到变量仍然为空的错误。当我从中收集值时，我应该绑定/解除绑定`$t`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:04:03.147

我认为放置这样的代码应该可以工作：（假设 $t array() 中的变量存在）

```
function process ($t) {
  global $mysqli; 
  $var1 = $t['var1'];     
  $var2 = $t['var2'];

  $stmt = $mysqli->prepare("INSERT ..."); 
  $stmt->bind_param("ss", $var1, $var2);  
  $stmt->execute();

} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-24T14:05:33.417

我真是个傻子：

```
$stmt = $mysqli->prepare("INSERT INTO table (col1, col2) VALUES(?, ?)");

function process($t) { 
    global $mysqli, $stmt;
    $var1 = $t['var1'];
    $var2 = $t['var2'];
    $stmt->bind_param("ss", $var1, $var2);
    $stmt->execute();
} 
```

我认为 MySQLi 正在与变量进行一些魔术绑定。在这种情况下`bind_param`，只需将值放在准备好的语句中，而不是一味地声明某些变量“绑定”到语句中。

# streaming - Websphere Web 服务器减慢了我的输出流响应

> ID：11632392
> 
> 赞同：0
> 
> 时间：2012-07-24T13:52:56.100
> 
> 标签：streaming, websphere

我被要求查看以前的项目，该项目通过 servlet 的输出流将 pdf 发送回浏览器。在响应前面没有 Web 服务器（虚拟主机）的情况下，我们在大约 2 秒内在浏览器中获得了 pdf。但是，当我们通过 Web 服务器时，它会减慢到大约 14 秒。我们尝试了许多解决方案，但我们认为 Web 服务器在将响应中继到浏览器之前会保留响应。是否有允许数据通过 Web 服务器流式传输到浏览器的标志？抱歉，我对配置 WebSphere 还是很陌生。我们正在使用 WebSphere 6.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T10:19:51.810

IBM HTTP Server 得到了一个称为块大小的优化它指出，对于大响应，小块大小可能会损害性能。

在这里阅读更多内容：[Web 服务器插件请求和响应优化属性](http://pic.dhe.ibm.com/infocenter/wasinfo/v7r0/topic/com.ibm.websphere.zseries.doc/info/zseries/ae/uwsv_plugin_props1.html)

我想这就是你要找的。

无论如何，如果该 PDF 是静态的且未生成，您可能需要考虑使用 Web 服务器将其作为静态文件提供，而不是从 WAS 中获取。

# javascript - 从谷歌地图drawingManager V3中删除多边形

> ID：11632402
> 
> 赞同：17
> 
> 时间：2012-07-24T13:53:33.510
> 
> 标签：javascript, jquery, google-maps-api-3

我有一个用户可编辑的谷歌地图，用户可以使用绘图管理器在地图上绘制一个覆盖多边形。这工作正常，控制台记录了我需要的 lat lngs。但是，我需要添加一个按钮来清除多边形的地图，以便他们在出错时可以再次绘制。我的实现代码粘贴在下面：

```
geocoder = new google.maps.Geocoder();
      var latlng = new google.maps.LatLng(<?php echo $latitude ?>, <?php echo $longitude ?>);
       var myOptions = {
         zoom: <?php echo $zoomlevel ?>,
         center: latlng,
         mapTypeId: google.maps.MapTypeId.ROADMAP
       };
       var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

       marker = new google.maps.Marker({
         map:map,
         draggable:true,
         animation: google.maps.Animation.DROP,
         position: latlng
       })

       pos = marker.position;
       //alert(pos);
       document.getElementById("gpsite-surgery-latitude").value = pos.lat();
       document.getElementById("gpsite-surgery-longitude").value = pos.lng();

       google.maps.event.addListener(marker, "dragend", function() {
               var myLatLng = marker.latLng;

               pos = marker.position;
               //alert(pos);
               document.getElementById("gpsite-surgery-latitude").value = pos.lat();
               document.getElementById("gpsite-surgery-longitude").value = pos.lng();
       })

       google.maps.event.addListener(map, 'zoom_changed', function() {
          document.getElementById("gpsite-surgery-zoomlevel").value = map.getZoom();
       });

       var drawingManager = new google.maps.drawing.DrawingManager({
        drawingMode: google.maps.drawing.OverlayType.MARKER,
        drawingControl: true,
        drawingControlOptions: {
            position: google.maps.ControlPosition.TOP_CENTER,
            drawingModes: [google.maps.drawing.OverlayType.POLYGON]
        },
        polygonOptions: {
            fillColor: '#ffff00',
            fillOpacity: 0.4,
            strokeWeight: 3,
            clickable: true,
            zIndex: 1,
            editable: false
        }
       });

       google.maps.event.addListener(drawingManager, 'polygoncomplete', function (polygon) {
            var coordinates = (polygon.getPath().getArray());
            console.log(coordinates);
        });

       drawingManager.setMap(map);

   }); 
```

地图上还有一个标记，你可以忽略这个。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-07-24T14:36:14.147

检查这段代码，听起来和你说的完全一样，一个删除形状的按钮

[http://gmaps-samples-v3.googlecode.com/svn-history/r282/trunk/drawing/drawing-tools.html](http://gmaps-samples-v3.googlecode.com/svn-history/r282/trunk/drawing/drawing-tools.html)

***编辑：****上面的链接已损坏，但我能够在[此处](https://github.com/beekay-/gmaps-samples-v3/blob/master/drawing/drawing-tools.html)找到该代码。*

```
 // globals
  var drawingManager;
  var selectedShape;

  ...

  function clearSelection() {
    if (selectedShape) {
      selectedShape.setEditable(false);
      selectedShape = null;
    }
  }

  function setSelection(shape) {
    clearSelection();
    selectedShape = shape;
    shape.setEditable(true);
    selectColor(shape.get('fillColor') || shape.get('strokeColor'));
  }

  function deleteSelectedShape() {
    if (selectedShape) {
      selectedShape.setMap(null);
    }
  }

     google.maps.event.addListener(drawingManager, 'overlaycomplete', function(e) {
        if (e.type != google.maps.drawing.OverlayType.MARKER) {
        // Switch back to non-drawing mode after drawing a shape.
        drawingManager.setDrawingMode(null);

        // Add an event listener that selects the newly-drawn shape when the user
        // mouses down on it.
        var newShape = e.overlay;
        newShape.type = e.type;
        google.maps.event.addListener(newShape, 'click', function() {
          setSelection(newShape);
        });
        setSelection(newShape);
      }
    });

    // Clear the current selection when the drawing mode is changed, or when the
    // map is clicked.
    google.maps.event.addListener(drawingManager, 'drawingmode_changed', clearSelection);
    google.maps.event.addListener(map, 'click', clearSelection);
    google.maps.event.addDomListener(document.getElementById('delete-button'), 'click', deleteSelectedShape);

    buildColorPalette();
  } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-24T14:01:33.763

您需要在全局上下文中引用多边形。然后在按钮调用的单击处理程序函数中，polygon.setMap(null) （其中多边形是对多边形的全局引用，从您发布的不完整片段中无法判断它是否是全局的）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-26T04:21:49.147

对于单个多边形叠加，我这样做了：

```
var _myPolygon; // global variable to store the polygon instance

google.maps.event.addListener(drawingManager, 'overlaycomplete', function(e) {
    _myPolygon = e.overlay;
});

$('#delete-button').on('click', function() {
    _myPolygon.setMap(null);
}); 
```

# html - 单击标签时如何选中复选框

> ID：11632405
> 
> 赞同：3
> 
> 时间：2012-07-24T13:53:46.307
> 
> 标签：html

假设我有一个复选框控件和一个标签。

我想要做的是当我点击标签时复选框应该被选中。

我们如何做到这一点？我知道这是一个纯粹的 html 问题。我在说（gmail，facebook）中看到了这个

这是[小提琴](http://jsfiddle.net/k8Cgm/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T13:57:08.283

将`for`属性添加到您的标签和`id`复选框中 - [http://jsfiddle.net/k8Cgm/2/](http://jsfiddle.net/k8Cgm/2/)

```
<label for="chk">I am a checkbox</label>
<input name="chk" id="chk" type="checkbox" value="some" /> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-24T13:57:10.513

您必须`id`为您的复选框设置一个，然后`for`在标签的属性中引用它。

```
<input id="chk" name="chk" type="checkbox" value="some" />
<label for="chk">I am a checkbox</label> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T13:57:27.093

只需将 for 参数添加到标签和 id 到您的输入标签。

看你的例子：[jsFiddle](http://jsfiddle.net/AJ3Zc/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T14:00:36.780

您不能将标签引用到没有 id 的输入，也不能添加要引用的内容。您必须将 id 添加到输入中，并在标签中添加引用者。您可以在此处查看更新示例：

[http://jsfiddle.net/k8Cgm/3/](http://jsfiddle.net/k8Cgm/3/)

* * *

欲了解更多信息：[http ://www.w3schools.com/tags/tag_label.asp](http://www.w3schools.com/tags/tag_label.asp)

# c# - 如何使用 Microsoft Fakes Shim 隔离（绕行）类的构造函数？

> ID：11632409
> 
> 赞同：5
> 
> 时间：2012-07-24T13:54:09.473
> 
> 标签：c#, unit-testing, microsoft-fakes

是否有可能用 Microsoft Fakes 隔离/替换类的构造函数？

找到了 Mole（Fakes 的前身）的示例：http: [//thecurlybrace.blogspot.co.at/2011/11/how-do-i-detour-mole-type-constructor.html](http://thecurlybrace.blogspot.co.at/2011/11/how-do-i-detour-mole-type-constructor.html)

我尝试过这样的构造

```
ShimStreamReader.Constructor = @this => ShimStreamReader.ConstructorString(@this, "Test"); 
```

但它说 get 访问器丢失。为了澄清，更换类似的东西会很好

```
new StreamReader("filename") 
```

像这样的静态输入

```
new StreamReader(new MemoryStream(Encoding.Default.GetBytes("33\r\n1\r\n16\r\n5\r\n7"))) 
```

这样我就不必模拟 Read、ReadLine 等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-13T00:03:28.630

```
using (ShimsContext.Create())
{
    ShimStreamReader.ConstructorString = 
        delegate(StreamReader @this, string @string)
        {
            var shim = new ShimStreamReader(@this);
            shim.Read = () => 42;
        };

    var target = new StreamReader("MeaningOfLife.txt");
    Assert.AreEqual(42, target.Read());
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-26T13:08:33.360

可以通过反射替换和调用不同的构造函数：

“因此，当您替换构造函数时，您应该在构造函数中进行所有初始化。对于 StreamReader 构造函数可能是不可能的，因为您不知道原始构造函数如何在内部初始化对象并且您无权访问私有对象的成员。

所以，我们可以使用反射来调用原始构造函数来初始化对象，然后使用它。” - 请参阅[http://social.msdn.microsoft.com上的 Vikram Agrawals 回答](http://social.msdn.microsoft.com/Forums/en-US/vstest/thread/99edf49e-4f75-4bbe-a5e0-b788f783cb36)

所以关于我的问题的代码看起来像这样：

```
ShimStreamReader.ConstructorString = (@this, value) =>
{
    ConstructorInfo constructor = typeof (StreamReader).GetConstructor(new[] {typeof (Stream)});
    constructor.Invoke(@this, new object[] {new MemoryStream(Encoding.Default.GetBytes("33\r\n1\r\n16\r\n5\r\n7"))});
}; 
```

# asp.net - 无法发送带加号的电子邮件（System.Net.Mail 中的 SmtpClient.Send() 方法）

> ID：11632415
> 
> 赞同：3
> 
> 时间：2012-07-24T13:54:19.263
> 
> 标签：asp.net, asp.net-mvc, email, smtpclient, system.net.mail

System.Net.Mail 中的 SmtpClient.Send() 方法真的不能发送到其中包含加号的电子邮件地址吗？我正在发送一个电子邮件地址列表，除了包含加号 (+) 符号的那些之外，它们都被发送。有什么想法或解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T15:20:23.517

`System.Net.Mail`我使用.net 4成功地向地址中带有 + 字符的收件人发送了电子邮件。

就我而言，收件人是 gmail 地址，其中 + 和后面的任何字符都不会更改收件人。所以`something+somethingelse@gmail.com`发送一封由`something@gmail.com`帐户接收的电子邮件。但该帐户可以看到它被发送到`something+somethingelse`。

我认为这实际上是一个 sendmail 标准，而不仅仅是谷歌的东西。它派上用场了。

**编辑**：我在“加号帐户”上找到了一些 sendmail 文档：

[http://www.sendmail.com/sm/open_source/docs/m4/misc_features.html](http://www.sendmail.com/sm/open_source/docs/m4/misc_features.html)

> 有时在集中式邮件机器上合并配置很方便，例如，将所有根邮件转发到邮件服务器。在这种情况下，将根地址视为具有细微差别的一类地址可能会很有用。您可以使用 plussed 用户来执行此操作。例如，客户端可能包含别名：
> 
> 根：根+client1@server
> 
> 在服务器上，这将匹配“root+client1”的别名。如果没有找到，将尝试别名“root+*”，然后是“root”。

# ruby - 如果 `self` 始终是 Ruby 中的隐含接收者，为什么 `self.puts` 不起作用？

> ID：11632416
> 
> 赞同：6
> 
> 时间：2012-07-24T13:54:23.157
> 
> 标签：ruby

在 Ruby 中，我的理解是它`self`是任何裸方法调用的隐含接收器。然而：

```
~: irb
>> puts "foo"
foo
=> nil
>> self.puts "foo"
NoMethodError: private method `puts' called for main:Object 
```

这是什么解释？

如果有任何帮助：

```
>> method(:puts).owner
=> Kernel 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T14:04:12.620

# 私有方法不能有接收者

我认为答案是这样的：Ruby 强制方法隐私的方式是它不允许使用显式接收者调用私有方法。

一个例子：

```
class Baker
  def bake_cake
    make_batter
    self.use_oven # will explode: called with explicit receiver 'self'
  end

  private
  def make_batter
    puts "making batter!"
  end

  def use_oven
    puts "using oven!"
  end

end

b = Baker.new
b.bake_cake 
```

由于不能有明确的接收者，你当然不能做`b.use_oven`. 这就是执行方法隐私的方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T14:55:37.820

因为这就是 Ruby 中隐私的定义：私有方法只能通过隐式接收者调用。

实际上，这条规则有一个例外：因为`foo = bar` *总是*创建一个局部变量，所以你可以调用私有 setter ，因为否则你*根本*`self.foo = bar`无法调用它们（不使用反射）。

 ** * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-24T13:59:59.733

`self`当您没有明确指定一个时，您是正确的，这是隐含的接收者。不允许您这样做的原因是您不能`self.puts`使用显式接收器调用私有方法（即使该接收器是`self`），并且正如错误消息所述，`puts`它是私有方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T14:00:04.017

您不能使用`self.`语法访问 ruby​​ 中的私有方法，或者一般来说使用任何接收器（前面的东西`.`）。这仅适用于受保护的方法。*

# c# - 我怎样才能使一个无限循环有 5 秒的停顿

> ID：11632419
> 
> 赞同：7
> 
> 时间：2012-07-24T13:54:26.253
> 
> 标签：c#, multithreading, loops

```
 string connectionstring = "server =SQLVS2\\SQLVS2;database=DDM;Persist Security Info=True;uid=ddmuser;password=User02+Ddm;";
    SqlConnection myConnection = new SqlConnection(connectionstring);
    SqlCommand myCommand = new SqlCommand("GetNullHash", myConnection);
    myCommand.CommandType = CommandType.StoredProcedure;
    myConnection.Open();
    SqlDataReader rdr = myCommand.ExecuteReader();

   while (rdr.Read())
    {
        string filename = @"\\" + rdr.GetString(3);
        filename = System.IO.Path.Combine(filename, rdr.GetString(2));
        filename = System.IO.Path.Combine(filename, rdr.GetString(1));
        computeHashh1 abc = new computeHashh1();
        Console.WriteLine(abc.computeHash(filename));          
        inserthash insert = new inserthash();
       insert.InsertHash(rdr.GetString(1), abc.computeHash(filename), rdr.GetStr(2),rdr.GetString(3));

    } 
```

我怎样才能让这个循环在 5 秒内运行一次，或者直到停止。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-24T13:55:03.770

最简单的方法是：

```
while (true) {
    // code here
    Thread.Sleep(5000);
} 
```

但是，为了更稳健，我会推荐一个带有[适当计时器的](http://clifgriffin.com/2008/11/20/using-timers-in-a-c-windows-service/)[Windows 服务](http://msdn.microsoft.com/en-us/library/zt39148a%28v=vs.80%29.aspx)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-24T13:57:49.890

尝试：

```
while(true) 
{
    try 
    {
       thread.sleep(5000) 
    } 
    catch(Exception e) 
    {
      //handle the exception 
    }
} 
```

它是最简单的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-24T14:01:50.637

我会包装你的代码并使用一个计时器对象，它允许你控制计时器本身（停止、启动等）

```
System.Timers.Timer aTimer;
aTimer = new System.Timers.Timer();
aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);
aTimer.Interval = 2000;
aTimer.Enabled = true;

private void OnTimedEvent(object source, ElapsedEventArgs e)
{
    //your code
} 
```

更多信息在

[http://msdn.microsoft.com/en-us/library/system.timers.timer%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/system.timers.timer%28v=vs.100%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T14:59:08.833

好吧，如果我要这样做，并且对间隔的约束不精确，并且我想绝对确定如果我的代码偶尔花费的时间比间隔长，多个计时器事件将永远不会导致我的代码重新输入，我只会使用 sleep() 循环并让事情在没有任何无关计时器的情况下工作，这只会增加看似简单的要求的复杂性。

在必须处理消息的 GUI 线程（或必须处理启动/停止等的主服务线程）之外，定时器通常是不合适的、尴尬的，或者如果另一个线程/池必须引发定时器事件，则会浪费上下文切换。

无论如何，在 Vista/W7 上，停止已产生休眠线程的服务是没有问题的。操作系统需要大约 20 秒才能意识到，即使服务主线程已经处理了停止消息，服务进程仍然有阻塞的线程 - 然后它无论如何都会终止服务进程，杀死任何睡眠/运行/等待/任何线程.

# mysql - 从 MySQL UTC 时间戳字符串创建 ActionScript Date 对象

> ID：11632421
> 
> 赞同：2
> 
> 时间：2012-07-24T13:54:32.897
> 
> 标签：mysql, actionscript-3

我将日期存储在`datetime`MySQL 表的列中。我通过调用[MySql 的 UTC_CURRENTDATE](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_utc-timestamp)来插入当前日期。当我检索它时，它采用以下字符串格式： `"2012-07-24 12:59:58"`

当我尝试通过执行以下操作在 Action Script 中创建 Date 对象时：

```
var dateNum:Number = Date.parse(createDate); // this gives me NaN
var createDate:Date = new Date(dateNum); 
```

`Date.parse("2012-07-24 12:59:58")`给`NaN`

**解决方案：**按照 Jason 的建议，我正在执行以下操作：

选择一个[UNIX_TIMESTAMP](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_unix-timestamp) (CREATE_DATE)，它返回自 '1970-01-01 00:00:00' UTC 以来的秒数。然后在 Actionscript 中执行以下操作：

```
var createDate:Date = new Date();
var offset:Number = createDate.getTimezoneOffset() * 60 * 1000; 
createDate.time = parseInt("1343174921") * 1000 - offset; 
```

这给了我正确的日期。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T15:01:17.380

虽然我确信有一种更优雅的方法；显然你可以实现一个解析函数，例如：

```
public static function parse(date:String):Date
{
    var split:Array = date.split(" ");
    var splitDate:Array = split[0].split("-");
    var splitTime:Array = split[1].split(":");

    return new Date(splitDate[0],
                    splitDate[1] - 1,
                    splitDate[2],
                    splitTime[0],
                    splitTime[1],
                    splitTime[2]);
} 
```

称为：

```
var date:Date = parse("2012-07-24 12:59:58"); 
```

而不是处理 MySQL `DATETIME`，您的 SQL 语句可以转换为 ActionScript`Date`构造函数将接受自纪元以来的毫秒数的时间戳。

[CASA Lib](http://as3.casalib.org/docs/org_casalib_util_DateUtil.html)等框架具有很好的日期实用功能。

# struts2 - Struts2 插件 Netbeans

> ID：11632428
> 
> 赞同：0
> 
> 时间：2012-07-24T13:55:01.317
> 
> 标签：struts2

我需要使用 JSP 和 Servlet 开发 Web 应用程序。因此我必须在 Netbeans 上添加 Struts2。谁能帮我在 Netbeans 上添加 Struts2 插件。我目前使用的是 Netbeans 6.9。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:50:46.147

您可以通过将适当的框架支持插件安装到 IDE 中来添加对特定框架的支持。为此，您可以从外部站点（例如 NetBeans 插件门户）下载插件模块，然后通过插件管理器安装插件，或者，如果插件由更新中心维护，您可以向更新中心注册IDE的Plugins Manager，然后直接通过Plugins Manager下载安装插件。

有关如何下载和安装适用于 netBeans 的 Struts2 插件的详细信息，请浏览此页面

1.  [框架添加支持](http://netbeans.org/kb/docs/web/framework-adding-support.html)
2.  [netbeans-struts2-支持](http://plugins.netbeans.org/plugin/23467/netbeans-struts2-support)

# jquery - 突出显示html表格中的行？

> ID：11632439
> 
> 赞同：1
> 
> 时间：2012-07-24T13:55:15.897
> 
> 标签：jquery, css, html-table

我使用以下程序在鼠标悬停事件中创建突出显示行，它工作正常，但我的问题是，如果鼠标悬停在特定行上，突出显示栏之间是否出现空白？如何删除空格？

表创建：

```
<table border="0" id="TabDeclaration"  width="100%" cellpadding="5" cellspacing="3" border="2">
    <tr>
        <td>aaaa</td>
        <td>bbbb</td>
        <td>azaz</td>
    </tr>
    <tr>
        <td>cccc</td>
        <td>dddd</td>
    </tr>
    <tr>
        <td>eeee</td>
        <td>ffff</td>
    </tr>      
</table> 
```

用于调用 css 的 jQuery：

```
$('#TabDeclaration tr').mouseover(function() {
    if($.trim($(this).text()) != '')
       $(this).addClass('hovered');
    }).mouseout(function() {
       $(this).removeClass('hovered');
}); 
```

CSS：

```
.hovered td {
   background: #ddd;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:04:02.377

你为什么要使用javascript？仅使用 css 选择器会容易得多`:hover`。

HTML：

```
<tr>
    <td>aaaa</td>
    <td>bbbb</td>
    <td>azaz</td>
</tr>

<tr>
    <td>cccc</td>
    <td>dddd</td>
</tr>
 <tr>
    <td>eeee</td>
    <td>ffff</td>
</tr> 
```

CSS：

```
tr:hover {
  background: #ddd;
} 
```

当鼠标悬停在表格行上时，这应该可以正常工作。选择`:hover`器适用于任何 HTML 元素，而不仅仅是`<a>`标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:57:21.467

在 table 标记中，定义此属性

```
cellspacing="0" 
```

# java - 更好的编程风格？

> ID：11632441
> 
> 赞同：-4
> 
> 时间：2012-07-24T13:55:26.680
> 
> 标签：java

哪个代码更好？在每种情况下使用 return() ：

```
void someProc(String str) {
    if (str.length < 1) {
        log("bad length");
        return();
        }
    if (str.charAt(3) == "N") {
        log("N at 3");
        return();
        }
    parse(str);
} 
```

或没有 return() 的子条件：

```
void someProc(String str) {
    if (str.length < 1) log("bad length");
    else if (str.charAt(3) == "N") log("N at 3");
    else parse(str);
} 
```

什么对性能更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:58:29.287

性能上应该没有有意义的差异。编译器应该生成基本相同的指令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:02:39.960

这类问题通常会引起强烈而激烈的争论。

对我来说，我更喜欢仅在返回值时使用 return，因为我认为空返回可能会令人困惑（例如，“程序员是否忘记输入变量名”）并且我不介意多个退出点。我会写 someProc 如下：

```
void someProc(String string)
{
  if (str.length < 1)
  {
    log("bad length");
  }
  else if (str.charAt(3) == "N")
  {
    log("3 is N");
  }
  else
  {
    parse(str);
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:03:18.950

您必须在数据集上进行测试。我找不到任何明显的区别。

我认为如果您在[Code Review上发布此代码会更好](https://codereview.stackexchange.com/)

希望这有帮助！

# mysql - Mysql 一次插入和选择的最大行数

> ID：11632443
> 
> 赞同：2
> 
> 时间：2012-07-24T13:55:30.310
> 
> 标签：mysql

一次可以从 Mysql 表中写入和读取的最大记录数是多少？或最大数量或一次读写？

我想读取和写入的数据可能会有所不同。如果一个减少，那么另一个可能会上升。但仍然以每秒或每分钟为基础提供一些信息。

我不是在寻找确切的答案。我正在寻找大概的答案。此外，对于硬件，请考虑普通的共享托管服务提供商。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:17:27.417

mysql本身**没有**限制。但是，发送到服务器的数据包的最大大小受到限制。在 INSERT 或 SELECT 的情况下，底层实现会发送一个[COM_QUERY数据包。](http://forge.mysql.com/wiki/MySQL_Internals_ClientServer_Protocol#COM_QUERY)

> 可以传输到 MySQL 5.5 服务器或客户端的最大可能数据包为 1GB。当 mysqld 服务器接收到大于 **max_allowed_pa​​cket**字节的数据包时，它会发出 Packet too large 错误并关闭连接。对于某些客户端，如果通信数据包太大，您可能还会在查询错误期间丢失与 MySQL 服务器的连接。

[参考](http://dev.mysql.com/doc/refman//5.5/en/packet-too-large.html)

当涉及到并发读/写的数量时，这完全取决于正在使用的磁盘和 CPU。mysql服务器处理发送的查询越快，读写速度越快，并发读写的数量就越大。

# c# - 从Linq检索给定范围内的一周中的特定日期？

> ID：11632453
> 
> 赞同：7
> 
> 时间：2012-07-24T13:56:01.467
> 
> 标签：c#

是否可以给定一个日期范围来提取一周中的特定日期并显示它们的日期？

那么，如果我的日期范围是从 2012 年 8 月 17 日到 2012 年 9 月 17 日，是否可以使用 linq 提取所有星期四和星期二？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T14:03:33.253

您可以确定日期之间的天数，然后生成所有日期并过滤您感兴趣的星期几。

```
var start = DateTime.Parse("08/17/2012");
var end = DateTime.Parse("09/17/2012");
int numberOfDays = end.Subtract(start).Days + 1;
var daysOfWeek = new[] { DayOfWeek.Tuesday, DayOfWeek.Thursday };

var dates = Enumerable.Range(0, numberOfDays)
                      .Select(i => start.AddDays(i))
                      .Where(d => daysOfWeek.Contains(d.DayOfWeek)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T14:03:56.990

```
var start = new DateTime(2012, 8, 17);
var end = new DateTime(2012, 9, 17);

var daysToChoose = new DayOfWeek[] { DayOfWeek.Thursday, DayOfWeek.Tuesday };

var dates = Enumerable.Range(0, (int)(end - start).TotalDays + 1)
                        .Select(d => start.AddDays(d))
                        .Where(d => daysToChoose.Contains(d.DayOfWeek)); 
```

# mysql - 根据主键连接多个sql表

> ID：11632455
> 
> 赞同：2
> 
> 时间：2012-07-24T13:56:05.090
> 
> 标签：mysql

我有大约 10 张桌子。一个具有主键的表和所有其他表通过外键连接到该单个表。例如。

```
Table main : 1,2,3,4,5,6,7,8
Tablechild: 1,2,3
Tableanchild: 1,3,5
Tableachild: 1,2,4,5 
```

我想提取主表和所有其他表的完整数据，例如。

```
1      "tablechild data" "tableanchild data" tableachild data"
2      tablechild data                       tableachild data
3      tablechild data    tableanchild data
4 
5 
6
7
8 
```

我使用过`left join`，但它提供了冗余数据。对于每个显示外键的表，请提前致谢。

```
$sql = "SELECT * FROM login AS jon
                        LEFT JOIN re as rec ON jon.no=rec.no
                        LEFT JOIN bio as bio ON jon.no=bio.no   
                        LEFT JOIN pon as po ON jon.no=po.no
                        LEFT JOIN rec as re ON jon.no=re.no
                        LEFT JOIN spn as sp ON jon.no=sp.no" ; 
```

我也试过

```
" SELECT login.no,re.name ,re.num,bio.address,bio.phone,pon.lline,pon.set,rec.book,rec.pen,spn.rub,spn.stylo FROM login,re,bio,pon,rec,spn WHERE login.no=re.no AND login.no=bio.no  AND login.no=pon.no  AND login.no=rec.no  AND login.no=spn.no "; 
```

我想做 SELECT Ax , By , Bz, Cd ,Cf FROM A,B,C WHERE AX is distinct as x is primary key in A and foreign key in others 。预期产出

```
1    B data
2    B data      C data
3                C data
4    B data      C data
5 
```

现在我得到

```
 1   B data
   1   ....
   1   .......
   2   ....
   2   ......
   3
   4
   4
   5 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:10:06.897

让表`A`有 cloumn`x`和`y`B 有`x`和`z`

然后查询`select * from A, B where A.x = B.x`将给出冗余数据。如你所说。或者，您可以将查询编写为`select A.x, A.y, B.y from A, B where A.x = B.x`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T15:16:14.620

左连接应该在这里工作

这是一个例子（我使用的是sql server，但逻辑应该完全一样）

```
declare @main table (pk int)

insert into @main(pk) values (1),(2),(3),(4),(5),(6),(7),(8)

declare @childA table(afk int)
declare @childB table(bfk int)
declare @childC table(cfk int)

insert into @childA(afk) values (1),(2),(3)
insert into @childB(bfk) values (1),(3),(5)
insert into @childC(cfk) values (1),(2),(4),(5)

select * from 
    @main m
    left join @childA a on m.pk = a.afk 
    left join @childB b on m.pk = b.bfk  
    left join @childC c on m.pk = c.cfk 
```

只要确保**主**表是起始表并且不应该有多余的数据。

因此，在您的情况下，您的查询将类似于：

```
select * from 
    mainTable m
    left join childA a on m.pk = a.afk 
    left join childB b on m.pk = b.bfk  
    left join childC c on m.pk = c.cfk 
```

# java - Java web start 无法启动并出现“无效参数异常”

> ID：11632456
> 
> 赞同：2
> 
> 时间：2012-07-24T13:56:07.067
> 
> 标签：java, java-web-start, runtime.exec, invalid-argument

我正在开发一些必须使用 Java web start 启动另一个应用程序的应用程序。它的设计方式是这样的：

```
 String commandArg = new String(
    "http://143.56.56.56:8088/configuratorhome/controller?configurationid=1222222222222222222222222222222222222222222222222222222222222c&versionstamp=21593&location=England&applicationlocale=en_US&qo_productid=6178&offline=false&configurationtype=normal&project_name=Devgen+Seeds&customer_no=AAA+MYCompany+Heid+Angebote+09&project_no=A09%2F0356&user_initials=JEJ&group_name=CHD&customer_name=AAA+MYCompany++Heid+Angebote+09&conf_access_right=udv_server&project_contact_name=&product_next_version_no=2&product_version_no=1&product_locale=England&user_name=Jens+Jakobsen&header_phone=5555+55556+5555&header_zipcode=A-79000&header_mail=heid%40cimbria.com&header_fax=-&header_address2=-&header_town=Stockerau&header_country=Austria&header_name=Mycomp+Heid+GmbH&header_address1=Heid-Werkstrasse+4&");

    String[] command = new String[] { "javaws", "\"" + commandArg + "\"" };
     // Runtime.getRuntime().exec(command);
    Process proc = new ProcessBuilder(command).start(); 
```

当我运行这个应用程序时，我得到以下异常：

```
InvalidArgumentException[ Invalid arguments supplied: { }]  
 at com.sun.javaws.Main.continueInSecureThread(Unknown Source)
 at com.sun.javaws.Main$1.run(Unknown Source) 
 at java.lang.Thread.run(Unknown Source) 
```

但这实际上取决于我如何运行它。如果我从命令行使用 Java 6 64bit，它会如前所述失败。但是从内部 Eclipse 可以正常工作而不会引发异常。当我从带有 Java6 32 位的 PC 上运行它时，无论如何都会失败。

其次，如果我使命令参数更小，它就可以工作。因此，根据命令的长度，我是否得到异常。但在 Eclipse 中，无论命令的长度如何，它都能正常工作。

我不明白为什么会有这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T07:48:56.853

在使用桌面图标和 java 7 启动 webstart 应用程序时，我遇到了同样的问题。只有这种组合失败。从链接开始，jnlp 文件或 Java 6 都没有问题。

> 这是因为客户端的 Java 版本，而不是 Web 浏览器。Java web Start 在调用方法“continueInSecureThread”时抛出异常，该方法在 JRE7 上的方法签名可能与以前版本不同。来自[SAP 论坛对话](http://scn.sap.com/thread/3161284)

设置内容类型也有帮助 aResponse.setContentType("application/x-java-jnlp-file");

对我来说似乎很合理。

# c# - IL 方法调用总是返回 null

> ID：11632462
> 
> 赞同：1
> 
> 时间：2012-07-24T13:56:35.647
> 
> 标签：c#, .net, reflection, reflection.emit

我正在尝试使用反射发射（IL 代码）制作自定义代理。一切正常，但是当我调用第二种方法时，我总是没有得到任何结果，并且我得到一个试图取消装箱空值（NullReferenceException）的执行。

这是使用 Emit 动态生成的 IL 代码。（我已经评论了重要的部分）

```
.method public hidebysig newslot virtual final 
        instance int32  TestCall(int32 A_1,
                                 int32 A_2) cil managed
{
  // Code size       155 (0x9b)
  .maxstack  5
  .locals init (class [mscorlib]System.Reflection.MethodInfo V_0,
           class [BaseProxy.Console]BaseProxy.Console.TestClass V_1,
           object[] V_2,
           bool V_3,
           object V_4)
  IL_0000:  ldc.i4     0x2
  IL_0005:  newarr     [mscorlib]System.Object
  IL_000a:  stloc.2
  IL_000b:  ldloc.2
  IL_000c:  ldc.i4     0x0
  IL_0011:  ldarg      A_1
  IL_0015:  nop
  IL_0016:  nop
  IL_0017:  box        [mscorlib]System.Int32
  IL_001c:  stelem.ref
  IL_001d:  ldloc.2
  IL_001e:  ldc.i4     0x1
  IL_0023:  ldarg      A_2
  IL_0027:  nop
  IL_0028:  nop
  IL_0029:  box        [mscorlib]System.Int32
  IL_002e:  stelem.ref
  IL_002f:  ldtoken    [BaseProxy.Console]BaseProxy.Console.TestClass
  IL_0034:  call       class [mscorlib]System.Type [mscorlib]System.Type::GetTypeFromHandle(valuetype [mscorlib]System.RuntimeTypeHandle)
  IL_0039:  ldstr      "TestCall"
  IL_003e:  call       instance class [mscorlib]System.Reflection.MethodInfo [mscorlib]System.Type::GetMethod(string)
  IL_0043:  stloc.0
  IL_0044:  ldarg.0
  IL_0045:  ldfld      class [BaseProxy.Console]BaseProxy.Console.TestClass TestClassProxy::wrappedObject
  IL_004a:  stloc.1
  IL_004b:  ldc.i4.1
  IL_004c:  stloc.3
  IL_004d:  ldarg.0
  IL_004e:  ldfld      class [BaseProxy.Console]BaseProxy.Console.BasicInterceptor TestClassProxy::interception
  IL_0053:  ldloc.0
  IL_0054:  ldloc.2
  IL_0055:  ldloc.1
  IL_0056:  ldloca.s   V_3
  IL_0058:  callvirt   instance object [BaseProxy.Console]BaseProxy.Console.BasicInterceptor::Before(class [mscorlib]System.Reflection.MethodInfo,
                                                                                                     object[],
                                                                                                     object,
                                                                                                     bool&) 
  **//Here everything is ok, i can get the result.**
  IL_005d:  box        [mscorlib]System.Object
  IL_0062:  stloc.s    V_4
  IL_0064:  nop
  IL_0065:  ldloc.3
  IL_0066:  brfalse.s  IL_0093
  IL_0068:  ldarg.0
  IL_0069:  ldfld      class [BaseProxy.Console]BaseProxy.Console.TestClass TestClassProxy::wrappedObject
  IL_006e:  ldloc.2
  IL_006f:  ldc.i4     0x0
  IL_0074:  ldelem.ref
  IL_0075:  unbox.any  [mscorlib]System.Int32
  IL_007a:  ldloc.2
  IL_007b:  ldc.i4     0x1
  IL_0080:  ldelem.ref
  IL_0081:  unbox.any  [mscorlib]System.Int32
  IL_0086:  callvirt   instance int32 [BaseProxy.Console]BaseProxy.Console.TestClass::TestCall(int32,
                                                                                               int32)
  **\\This Call Always return nothing (null)**
  IL_008b:  box        [mscorlib]System.Object
  IL_0090:  stloc.s    V_4
  IL_0092:  nop
  IL_0093:  ldloc.s    V_4
  **\\And i get a Exception here because loc 4 is null**
  IL_0095:  unbox.any  [mscorlib]System.Int32
  IL_009a:  ret
} // end of method TestClassProxy::TestCall 
```

TestCall 方法是一个非常简单的方法，它返回一个 int32 值。我在 TestCall 中放置了一个断点，并且它运行良好。

PEVerify 向我返回了以下错误：

```
[IL]: Error: [GeneratedProxyModule.dll : TestClassProxy::TestCall][offset 0x0000008B][found Int32][expected ref 'System.Object'] Unexpected type on the stack. 
```

任何帮助都可以接受。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T14:42:30.243

PEVerify 输出准确地告诉您问题所在。`Object`堆栈中预期的 8B 处的框指令，但当时`Int32`就在那里。但我们想要在`Int32`那里，这就是我们想要的。那么为什么`box`期望`Object`呢？因为你是这么说的。[参数`box`告诉它*从*什么类型到盒子，而不是*从*什么类型盒子。](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.box.aspx)

因此，将您的代码更改为：

```
IL_008b:  box        [mscorlib]System.Int32 
```

应该解决你的问题。

尽管 8B 和 95 之间的所有指令在我看来都是一种复杂的无操作（装箱、存储、加载、拆箱）的方式。如果您没有任何特殊原因将它们放在那里，则应该将它们删除。

# asp.net - 文本字段未使用“另存为”对话框更新

> ID：11632463
> 
> 赞同：0
> 
> 时间：2012-07-24T13:56:36.333
> 
> 标签：asp.net

出于某种原因，当我显示另存为对话框时，我的校验和框永远不会更新。但是，如果我注释掉下面的 Content-Disposition 标头代码，那么一切正常。有任何想法吗？

```
protected void SubmitButton_Click(object sender, EventArgs e)
{
    checksumField.Text = String.Empty;

    FileInfo filename = this.CreateFileInfoFromInput();

    if (!filename.Exists)
    {
        tableField.Focus();
        tableField.BorderColor = System.Drawing.Color.Red;
        return;
    }

    this.SaveFile(filename);
    checksumField.Text = GetChecksum(filename);
}

private FileInfo CreateFileInfoFromInput()
{
    /* blah */
    return new FileInfo(blah);
}

private string GetChecksum(FileInfo filename)
{
    return "test";
}

private void SaveFile(FileInfo fileName)
{
    // Clear old headers
    Response.Clear();
    Response.Buffer = false;

    // Set the ContentType and Headers
    Response.ContentType = "application/octet-stream";
    Response.AppendHeader("Content-Disposition", "attachment; filename=" + fileName.Name);  //  <<<---- FAILING RIGHT HERE
    Response.AppendHeader("Content-Length", fileName.Length.ToString(System.Globalization.CultureInfo.InvariantCulture));
    Response.AppendHeader("Connection", "Keep-Alive"); 

    // Send data
    Response.TransmitFile(fileName.FullName);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:05:52.327

您正在缩短页面生命周期。

不是让页面自行更新并呈现到响应流，而是在响应中注入文件

我的建议是按照以下步骤操作：

1.  创建一个简单的处理程序（ashx 文件，它将基于 ID 为文件提供服务）
2.  更改您的页面以生成指向此处理程序的链接（或将打开此 url 的脚本）

当用户提交 ID 时，像您一样生成文件（希望过程很短），更新您的文本框（这应该像您一样工作）并添加到处理程序文件服务的链接。

请注意安全隐患。不要盲目发送url中指定的文件（避免文件路径注入）。

# android - db4o 没有更新我的对象的数组列表

> ID：11632474
> 
> 赞同：0
> 
> 时间：2012-07-24T13:57:19.037
> 
> 标签：android, database, eclipse, db4o, updating

我的 db4o 数据库没有更新。在我的 ViewContact 类中，我有一个按钮，按下该按钮会询问用户输入，并将其存储在数据库中。它不存储任何想法？

我在 ViewContact 类下面发布了问题代码，

```
@SuppressLint({ "ParserError", "ParserError", "ParserError", "ParserError" })
public void onClick(View v) {

    switch(v.getId())
    {

            /*THIS IS THE ADD PHRASE BUTTON*/
            case R.id.bAddP: 

        /*ALERT BOX LAUNCHES*/
            final AlertDialog.Builder alert = new AlertDialog.Builder(this);

            alert.setTitle("Title");
            alert.setMessage("Message");

        /* Set an EditText view to get user input */
            final EditText input = new EditText(this);
            alert.setView(input);

                    /*THIS IS FOR WHEN OK IS PRESSED*/
            alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int whichButton) {

                            /*VALUE OF USER INPUT*/
                String value = input.getText().toString();

          /* OPEN DB4O AND UPDATE CONTACT OBJECT*/
              ObjectContainer db = Db4oEmbedded.openFile(Db4oEmbedded
                    .newConfiguration(), db4oDBFullPathSdCard(context));
            try {

                /*QUERY BY EXAMPLE TO GET CONTACT
               USING "t" WHICH IS PARCELABLE OBJECT PASSED FROM 
               FIRST ACTIVITY*/

                ObjectSet result = db.queryByExample(new NewContact(t.getName()));
                NewContact found = (NewContact) result.next();
                /*storePhrase STORES A STRING INTO THE OBJECTS 
                                    ARRAYLIST*/
                                   found.storePhrase(value);
                /*UPDATE DATABASE, 
                                    THIS IS NOT UPDATING! HERE IS PROBLEM*/
                db.store(found);

                Class ourContact = Class.forName("com.text.q.ViewContacts");
                Intent i = new Intent(ViewContact.this, ourContact);
                                    //REPARCEL OBJECT SO NAME CAN BE USED AGAIN
                i.putExtra("New", t);
                finish();
                startActivity(i);
                   /*REFRESH ACTIVITY*/

            } catch (ClassNotFoundException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

             finally {
                db.close();
            }

});

        alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
              public void onClick(DialogInterface dialog, int whichButton) {
                // Canceled.
              }
            });

          alert.show();

        break;

}

} 
```

问题在于 bAddP 的 onClick 方法。我正在尝试更新数据库，以便当我结束并重新启动活动时，将显示新短语。“db.store(found);”行 应该更新我的数据库，但它没有。我意识到这不是完美的代码，因此任何想法都将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T09:13:39.530

没关系，我想通了，这与更新深度有关。

# asp.net - 为什么 SiteMap.CurrentNode 升级到 4.0 后返回 null

> ID：11632479
> 
> 赞同：1
> 
> 时间：2012-07-24T13:57:33.213
> 
> 标签：asp.net, c#-4.0, iis-6

我最近将一个网站升级到 ASP.NET 4.0，在将代码移动到临时服务器后，每次我浏览到类似 mysite.com/bacon/ 的页面目录时，SiteMap.CurrentNode 都是空的。但是，如果我浏览 mysite.com/bacon/default.aspx 它工作正常。服务器和站点配置为 4.0，文档默认设置为 default.aspx 是默认的第一页。

我还应该提到我的本地开发机器上没有发生这种行为，它识别出 mysite.com/bacon/ 真的是 mysite.com/bacon/default.aspx 并且 SiteMap.CurrentNode 已相应设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:40:55.430

原来 SiteMap 提供程序使用的是 HttpContext.Request.rawUrl。由于某种原因，从 .Net 2.0 更改为 4.0 rawurl 不再返回您的默认文档，因此使用 HttpContext.Request.Path 代替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-26T09:51:10.063

检查您的 Web.sitemap 节点的 url（如果您使用此类文件！）并且不要忘记在 url 末尾添加“/”。例如，这将产生错误：

```
<siteMapNode title="bacon" url="mysite.com/bacon" description="" > 
```

但这是正确的：

```
<siteMapNode title="bacon" url="mysite.com/bacon/" description="" > 
```

# c# - 何时应使用 Reference 以及何时应使用 ProjectReference

> ID：11632482
> 
> 赞同：2
> 
> 时间：2012-07-24T13:57:41.383
> 
> 标签：c#, .net, visual-studio-2010, visual-studio, reference

我相信我完全理解两者之间的区别。

*引用*只是指向使用的某个程序集（无论是指定完整路径，还是在 GAC 中查找）。

*ProjectReferences*假定被引用项目与引用项目位于相同的 VS 解决方案中，并使用项目 GUID 来确定应引用哪个项目。

拥有*ProjectReference*的好处是 Visual Studio 可以检测依赖关系并在必要时重建它们（如果我引用项目 A 并且它没有构建，它将被重建）。此外，将采用引用的项目输出（基于当前活动配置等）。

这促使我们努力并采用“All ProjectReference”方法。

我的问题是这会导致包含许多依赖项项目的解决方案文件。如果依赖项本身有引用程序集，这些将作为 ProjectReferences 添加，强制它们由同一个 .sln 文件构建，而不是独立的。

我的问题是——在什么情况下应该毫无疑问地使用 ProjectReferences？在什么情况下应该绝对避免它们？（如果曾经）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T14:04:26.367

如果您正在对这些引用进行修改并需要重新编译，最好保留项目引用，但如果依赖项开发完成，请将其编译为发布，将它们注册到 GAC 并使用程序集引用来加快编译时间！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T14:00:47.860

如果您正在为引用的项目开发代码，那么此时最好使用项目引用。但是，如果您购买第三方控件（例如 Telerik RadControls），您可能只会引用 DLL（参考）。

如果您不需要编译它，更改版本号等。只需使用参考。

此外，它不会每次都编译项目引用。仅当它看到代码已更改或导致其触发的其他一些事情（例如完全重建或它自己的引用中的某些更改）时。

# javascript - 提交带有鸟舍编辑图像的表单

> ID：11632490
> 
> 赞同：1
> 
> 时间：2012-07-24T13:57:55.537
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, image, aviary

我正在尝试使用 aviary 在我的 ruby​​ on rails 应用程序中编辑照片。我有一个表格，用户可以在其中编辑他们的个人资料，在这个表格上，他们可以选择保留他们当前的图像，用鸟舍编辑它或上传一个新的。Aviary 提供了一个新的编辑图像的临时链接，我希望在整个表单提交之前不会将这个编辑的图像发送到服务器。我该怎么做呢？

我曾希望将 url 传递到输入文件路径中，但是通过查看 firefox 所返回的内容，它说这是一个不安全的操作。输入文件的文件路径也必须是本地文件吗？

在我的表单中的 html 中：

```
<div id="testInput" >  </div> 
```

在 aviary 的 onSave 中

```
$('<input type="file" id="photo_1" name="photo_1">').appendTo('#testInput');
  var imgFile = document.getElementById("photo_1");
  imgFile.value = newURL; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T04:40:07.913

老兄，您尝试过 CarrierWave 宝石吗？我明天要试一试……它有一个叫作`remote_(file)_url`要求图像网址的助手。无论如何，您可以[在其 github 上阅读有关此内容的信息](https://github.com/jnicklas/carrierwave#uploading-files-from-a-remote-location)

希望我能帮助你

# c# - WCF 请求中缺少消息标头值

> ID：11632493
> 
> 赞同：0
> 
> 时间：2012-07-24T13:58:08.097
> 
> 标签：c#, wcf

我有一个 WCF 服务，其中包含一个用于供应商凭据的自定义消息头。我创建了一个名为“AuthHeader”的类，它继承自 SoapHeader，并添加了用户名和密码的属性。

```
public class AuthHeader : SoapHeader
{
    public string Username;
    public string Password;
} 
```

我在客户端上使用以下代码添加标头：

```
 OperationContext.Current.OutgoingMessageHeaders.Add(
    MessageHeader.CreateHeader("Identity", 
                               "http://www.my-website.com",
                               new AuthHeader
                                   {
                                       Username = "UserNameValue",
                                       Password = "PasswordValue"
                                   }
                              )); 
```

然后，我尝试使用以下内容检索服务中的标头：

```
var result = OperationContext.Current.IncomingMessageHeaders.GetHeader<AuthHeader>("Identity", "http://www.my-website.com"); 
```

虽然此代码找到了标头，但它没有正确反序列化值，而是结果对象上的用户名和密码为空。知道为什么不设置这些属性值吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:02:56.407

`AuthHeader`用属性`[DataContract]`和字段标记你的类`[DataMember]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-19T06:11:46.143

这是 Fiddler 跟踪的调用。它可能会帮助你。

```
<s:Header><SecurityHeader xmlns="http://tempuri.org" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><Channel xmlns="http://schemas.datacontract.org/2004/07/CustomMessageHeader">ChannelName</Channel><Password xmlns="http://schemas.datacontract.org/2004/07/CustomMessageHeader">Password</Password><UserName xmlns="http://schemas.datacontract.org/2004/07/CustomMessageHeader">username</UserName></SecurityHeader></s:Header><s:Body><GetLookUp xmlns="http://tempuri.org/"><categoryType>GRIEVANCE_TYPE</categoryType></GetLookUp></s:Body> 
```

# php - 使用 cUrl 打开支付网关

> ID：11632500
> 
> 赞同：1
> 
> 时间：2012-07-24T13:58:24.617
> 
> 标签：php, curl, symfony1, payment-gateway

我正在尝试访问支付网关。在银行的示例中，使用了一个简单的 html FORM，但我想通过 cURL 来完成。我的问题是当我尝试访问支付网关时没有看到 css（网关样式表）并且 javascript 失败。有什么办法可以避免这些错误？

```
 $url = sfConfig::get('app_tpv_url');

    $dsOrder = $this->getDSOrder($order);
    $dsAmount = (float)$order->getPriceWithShipping() * 100;
    $dsCurrency = sfConfig::get('app_tpv_merchant_currency');
    $dsMerchantCode = sfConfig::get('app_tpv_merchant_code');
    $dsName = sfConfig::get('app_tpv_merchant_name');
    $dsLanguage = ($this->getUser()->getCulture() == 'es') ? 1 : 2;
    $dsTerminal = sfConfig::get('app_tpv_merchant_terminal');
    $dsSignature = sfConfig::get('app_tpv_merchant_signature');
    $dsTransactionType = 0;

    sfProjectConfiguration::getActive()->loadHelpers('Url');
    $dsUrl = url_for('cart_ipn', array('sf_culture' => $this->getUser()->getCulture(),), true);

    $dsStringResult = $dsAmount + $dsOrder + $dsMerchantCode + $dsCurrency + $dsTransactionType + $dsSignature;
    $digest = sha1($dsStringResult);

    $options = array(
        'Ds_Merchant_Amount' => $dsAmount,
        'Ds_Merchant_Currency' => $dsCurrency,
        'Ds_Merchant_Order' => $dsOrder,
        'Ds_Merchant_MerchantCode' => $dsMerchantCode,
        'Ds_Merchant_MerchantName' => $dsName,
        'Ds_Merchant_ConsumerLanguage' => $dsLanguage,
        'Ds_Merchant_Terminal' => $dsTerminal,
        'Ds_Merchant_MerchantSignature' => $digest,
        'DS_Merchant_TransactionType' => $dsTransactionType,
        'Ds_Merchant_MerchantURL' => $dsUrl
    );

    $fields_string = '';
    foreach ($options as $key => $value) {
        $fields_string .= $key . '=' . $value . '&';
    }

    $ch = curl_init();

    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $fields_string);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_USERAGENT, $this->getContext()->getRequest()->getHttpHeader('User-Agent'));

    curl_exec($ch);

    curl_close($ch); 
```

# ios - 解决方案架构 - iOS 生态系统中的资产下载量和应用程序大小

> ID：11632505
> 
> 赞同：0
> 
> 时间：2012-07-24T13:58:32.937
> 
> 标签：ios, streaming, unity3d

我目前正在为 iOS 设计一个解决方案，并且精通 Unity 游戏引擎。但是，我有几个关于 Apple 和在 AppStore 上托管应用程序的问题。

1) 我计划让我的应用程序有一个瘦客户端，并在应用程序需要时下载资产和代码（以 Unity 术语 - 资产包）。这些资产和代码是否必须通过 Apple 进行验证？我的应用程序可以直接从我的服务器下载而无需任何 Apple 或 AppStore 干预吗？

2）假设上述问题的答案是肯定的，Apple 对应用程序在设备上可以占用的大小有限制吗？

3) 以上有多少适用于 Android 生态系统？

我的解决方案架构需要回答这些问题。

问候， 阿布舍克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:01:41.897

在 iOS 上，您不能下载将由您的移动应用程序执行的代码。

# php - 使用带有变量的 preg_replace 来获取数据库记录

> ID：11632510
> 
> 赞同：3
> 
> 时间：2012-07-24T13:58:57.283
> 
> 标签：php, preg-replace

我正在寻找一种解决方案，我可以使用 preg_replace 替换文本正文中的某些字符串，其中某些字符串可能包含一个变量，然后该变量将调用数据库以检索替换值（或检索该值的函数） .

例如，我可能想按如下方式替换以下字符串 -*斜体字*是我正在努力解决的字符串：

`{today} => today's date`

 `{title} => document title` 

`*{lang:12} => from "lang" table in database where id=12*`

显然，前两个很容易，但我正在努力解决第三个问题。我唯一能想到的就是替换所有没有冒号的，然后替换任何有冒号的，以触发功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:01:46.250

您可以使用此触发功能：

```
$s = preg_replace_callback('/\{lang:([0-9]+)\}/', function($m) {
  $id = $m[1];
  // Mysql query
  return $string_from_database;
}, $s); 
```

更好的是，使用所需的字符串缓存，这样就不会从数据库中多次获取它们：

```
if(preg_match_all('/\{lang:([0-9]+)\}/', $text, $m)) {
    $ids = array_unique(array_filter($m[1], function($id) {
        return (int)$id;
    }));
    $langs = array();
    if($r = mysql_query('SELECT id, txt FROM Lang WHERE id IN('.implode(', ', $ids).')')) {
        while($l = mysql_fetch_assoc($r)) $langs[$l['id']] = $l['txt'];
    }
    $text = preg_replace_callback('/\{lang:([0-9]+)\}/', function($m) use($langs) {
        $id = $m[1];
        return array_key_exists($id, $langs) ? $langs[$id] : '!!! Lang not found !!!';
    }, $text);
} 
```

# google-chrome - Chrome 开发者工具：不区分大小写的搜索

> ID：11632511
> 
> 赞同：10
> 
> 时间：2012-07-24T13:58:59.433
> 
> 标签：google-chrome, search, case-sensitive

Chrome 中的开发者工具可以执行不区分大小写的搜索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-08T14:23:08.313

当您在开发人员工具中按 CTRL+F (Windows) 或 CMD+F (Mac) 时，Google Chrome 始终会执行不区分大小写的搜索。

# python - SQLAlchemy 通过继承自省列类型

> ID：11632513
> 
> 赞同：19
> 
> 时间：2012-07-24T13:59:00.030
> 
> 标签：python, inheritance, sqlalchemy, introspection

考虑此代码（并使用 SQLAlchemy 0.7.7）：

```
class Document(Base):
    __tablename__ = 'document'
    __table_args__ = {
        'schema': 'app'
    }

    id = Column(types.Integer, primary_key=True)
    nom = Column(types.Unicode(256), nullable=False)
    date = Column(types.Date())

    type_document = Column(types.Enum('arrete', 'photographie',
        name='TYPES_DOCUMENT_ENUM'))
    __mapper_args__ = {'polymorphic_on': type_document}

class Arrete(Document):
    __tablename__ = 'arrete'
    __table_args__ = {
        'schema': 'app'
    }
    __mapper_args__ = {'polymorphic_identity': 'arrete'}

    id = Column(types.Integer, ForeignKey('app.document.id'), primary_key=True)
    numero_arrete = Column(types.Integer)
    date_arrete = Column(types.Date()) 
```

我可以轻松地检查类中定义的列的列类型`Arrete`：

```
Arrete.__table__.c['date_arrete'].type 
```

`Arrete`但是，如果我想通过类访问在类中定义的列，这不起作用`Document`。（如果我尝试访问 KeyError `c['date']`）。

有没有办法获取列类型，无论该列是在最终类中还是在其父类中定义的？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-07-24T15:57:26.247

ORM 允许您以对应于两个表的 JOIN 的继承模式定义类。这个结构是全方位的服务，也可以用来找出基本的东西，比如列上的属性类型，非常直接：

```
type = Arrete.date.property.columns[0].type 
```

请注意，这与 trugging through 的方法基本相同`__bases__`，只是您让 Python 的普通类机制来完成这项工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-24T14:58:45.493

您可以探索基类...

```
def find_type(class_, colname):
    if hasattr(class_, '__table__') and colname in class_.__table__.c:
        return class_.__table__.c[colname].type
    for base in class_.__bases__:
        return find_type(base, colname)
    raise NameError(colname)

print find_type(Arrete, 'date_arrete')
print find_type(Arrete, 'date') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:29:09.937

您需要[抽象的特殊指令](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/declarative.html#abstract)或[mixin 模式](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/declarative.html#mixin-and-custom-base-classes)。

对于mixin，你会使用这样的东西：

```
class MyMixin(object):
    __tablename__ = 'document'
    __table_args__ = {
        'schema': 'app'
    }

    id = Column(types.Integer, primary_key=True)
    nom = Column(types.Unicode(256), nullable=False)
    date = Column(types.Date())

class Arrete(MyMixin, Base):
    __tablename__ = 'arrete'

    __mapper_args__ = {'polymorphic_identity': 'arrete'}

    foreign_id = Column(types.Integer, ForeignKey('app.document.id'), primary_key=True)
    numero_arrete = Column(types.Integer)
    date_arrete = Column(types.Date())

class Document(MyMixin, Base):
    __tablename__ = 'Document'
    type_document = Column(types.Enum('arrete', 'photographie',
        name='TYPES_DOCUMENT_ENUM'))
    __mapper_args__ = {'polymorphic_on': type_document} 
```

共享的东西放在 mixin 中，非共享的东西放在子类中。

# asp.net-mvc - 需要澄清一些关于 asp.net mvc 的基本问题

> ID：11632514
> 
> 赞同：-1
> 
> 时间：2012-07-24T13:59:02.527
> 
> 标签：asp.net-mvc

我仍然使用 asp.net webform 开发应用程序，但是关于 asp.net mvc 有很多炒作。所以我将开始阅读有关它的书。

我有几个关于 asp.net mvc 的基本问题......请看看并回答。

1）如果人们开发网络应用程序uisng asp.net mvc而不是webform，是否会有任何真正的优势。如果是这样，请在此处讨论一些主要区别。

2）有多少类型的视图......我很难理解剃刀视图......它是什么以及有多少类型的视图像剃刀一样。

3) 剃须刀从哪个版本可用。它在 asp.net mvc 2.0 版中

4) 我已经安装了 VS2010，当我打开项目时，我看到只有 asp.net mvc 2.0 版可用。所以告诉我我需要在我的机器上安装什么，结果 asp.net mvc 3.0 和 4.0 将可用。

5) 我可以在asp.net mvc 项目中使用gridview 和asp.net webform 的其他控件吗？但我浏览了几个 mvc 代码示例，我看到没有人在 mvc 中使用 asp.net webform 的控件....为什么。这个不允许。

6）在mvc中有没有像webform这样的控制事件的概念，或者我们可以添加其他dll的引用等。

7) 我们知道在 mvc 中有两种视图......一种是被动的，一种是 MVP-Supervising 控制器。在 MS asp.net mvc 中，它是否支持被动视图和监督控制器。

请明智地详细讨论所有要点。多谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:10:15.740

> 1）如果人们开发网络应用程序uisng asp.net mvc而不是webform，是否会有任何真正的优势。如果是这样，请在此处讨论一些主要区别。

两者都有一些[优点和缺点](https://stackoverflow.com/questions/102558/biggest-advantage-to-using-asp-net-mvc-vs-web-forms)。我正在考虑的最大优势之一是关注点分离、单元测试友好和**对要呈现的 HTML 的更多控制**（对此非常喜欢）。

> 2）有多少类型的视图......我很难理解剃刀视图......它是什么以及有多少类型的视图像剃刀一样。

那里很少。Razor、WebFormViewEngine、Brail、Spark 等。这里有一个[很好](https://stackoverflow.com/questions/1451319/asp-net-mvc-view-engine-comparison)的比较。

```
3) razor available from which version. it is there in asp.net mvc version 2.0 
```

razor 是在 MVC3中[引入的。](http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvc3razor.aspx)它在 MVC2 中不存在。

> 4) 我已经安装了 VS2010，当我打开项目时，我看到只有 asp.net mvc 2.0 版可用。所以告诉我我需要在我的机器上安装什么，结果 asp.net mvc 3.0 和 4.0 将可用。

您需要[安装 MVC 3.0](http://www.asp.net/mvc/mvc3)。然后它将在新的项目对话框中可用。

> 5) 我可以在asp.net mvc 项目中使用gridview 和asp.net webform 的其他控件吗？但我浏览了几个 mvc 代码示例，我看到没有人在 mvc 中使用 asp.net webform 的控件....为什么。这个不允许。

MVC 中没有所谓的服务器控件。在 Web 表单中，基本上 Grid 控件将呈现 HTML 表格的标记。但是开发者很难对渲染的输出进行更多的调整/定制。但是在 MVC 中，你可以完全控制要渲染的内容（你有一个单独的 VIEW，它只用于 UI 标记）（你会喜欢这个东西的）。您可以手动编写表格的 HTML 标记。您可以根据需要对其进行任何类型的自定义。如果你需要，有很多可用的 jQuery 插件[可以](http://www.trirand.com/blog/jqgrid/jqgrid.html)让你的 HTML 表格看起来更漂亮和专业。这些插件提供了一些功能，如排序、分页等......

> 6）在mvc中有没有像webform这样的控制事件的概念，或者我们可以添加其他dll的引用等。

在 MVC 中没有称为服务器控件的东西。您仍然可以通过使用 javascript 侦听 HTML 元素的某些事件（更改/单击）并调用执行某些代码的操作方法来调用某些服务器代码。

**清除所有疑问和澄清的最好方法是开始做一个小型 MVC 项目。**那里有一些不错的[教程](http://www.asp.net/mvc/tutorials)。祝你好运

# machine-learning - 与支持向量机相比，人工神经网络有哪些优势？

> ID：11632516
> 
> 赞同：391
> 
> 时间：2012-07-24T13:59:11.770
> 
> 标签：machine-learning, neural-network, classification, svm

ANN（人工神经网络）和 SVM（支持向量机）是监督机器学习和分类的两种流行策略。对于特定项目，哪种方法更适合通常不是很清楚，我敢肯定答案总是“视情况而定”。通常，将两者与贝叶斯分类结合使用。

Stackoverflow 上的这些问题已经被问到关于 ANN 与 SVM 的关系：

[ANN和SVM分类](https://stackoverflow.com/questions/8326485/ann-and-svm-classification)

[在我的分类问题中，ANN、SVM 和 KNN 有什么区别](https://stackoverflow.com/questions/7316671/what-the-difference-among-ann-svm-and-knn-in-my-classification-question)

[支持向量机或人工神经网络进行文本处理？](https://stackoverflow.com/questions/2434536/support-vector-machine-or-artificial-neural-network-for-text-processing)

在这个问题中，我想*具体*了解 ANN（特别是多层感知器）的哪些方面可能使其在 SVM 上使用是可取的？我问的原因是因为很容易回答*相反*的问题：支持向量机通常优于人工神经网络，因为它们避免了人工神经网络的两个主要弱点：

(1) 人工神经网络经常收敛于*局部最小值*而不是全局最小值，这意味着它们有时本质上是“错过了大局”（或只见树木不见森林）

(2) 如果训练时间过长，人工神经网络通常会过*拟合*，这意味着对于任何给定的模式，人工神经网络可能会开始将噪声视为模式的一部分。

SVM 不会遇到这两个问题中的任何一个。然而，支持向量机完全替代人工神经网络这一点并不明显。那么，ANN 相对于 SVM 有哪些*特定*优势可能使其适用于某些情况？我已经列出了 SVM 相对于 ANN 的*具体*优势，现在我想查看 ANN 优势列表（如果有的话）。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2012-07-24T14:42:44.193

从您提供的示例来看，我假设 ANN 是指多层前馈网络（简称 FF 网络），例如多层感知器，因为它们与 SVM 直接竞争。

这些模型相对于 SVM 的一个具体好处是它们的大小是固定的：它们是*参数*模型，而 SVM 是非参数模型。也就是说，在人工神经网络中，您有一堆大小为*h* [1]到*h* [*n的隐藏层*]取决于特征的数量，加上偏置参数，以及这些构成你的模型。相比之下，SVM（至少是核化的）由一组支持向量组成，这些支持向量是从训练集中选择的，每个支持向量都有一个权重。在最坏的情况下，支持向量的数量正好是训练样本的数量（尽管这主要发生在小训练集或退化的情况下），并且通常它的模型大小是线性缩放的。在自然语言处理中，具有数万个支持向量的 SVM 分类器，每个具有数十万个特征，并非闻所未闻。

此外，与在线 SVM 拟合相比，FF 网络的[在线训练](https://en.wikipedia.org/wiki/Online_machine_learning)非常简单，并且预测速度会快很多。

**编辑**：以上所有内容都与内核化 SVM 的一般情况有关。线性 SVM 是一种特殊情况，因为它们*是*参数化的，并且允许使用简单算法（例如随机梯度下降）进行在线学习。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2012-11-24T21:03:43.820

人工神经网络相对于支持向量机的一个明显优势是人工神经网络可以有任意数量的输出，而支持向量机只有一个。使用支持向量机创建 n 元分类器最直接的方法是创建 n 个支持向量机并逐个训练它们。另一方面，可以一次性训练具有神经网络的 n 元分类器。此外，神经网络将更有意义，因为它是一个整体，而支持向量机是孤立的系统。如果输出是相互关联的，这将特别有用。

例如，如果目标是对手写数字进行分类，十个支持向量机就可以了。每个支持向量机只能识别一个数字，而不能识别所有其他数字。由于每个手写数字不能包含比其类别更多的信息，因此尝试用人工神经网络解决这个问题是没有意义的。

然而，假设目标是将一个人的激素平衡（几种激素）建模为易于测量的生理因素的函数，例如自上次进餐后的时间、心率等……由于这些因素都是相互关联的，因此人工神经网络回归比支持向量机回归更有意义。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2012-11-24T20:23:53.867

需要注意的一点是，两者实际上非常相关。线性 SVM 等价于单层 NN（即感知器），而多层 NN 可以用 SVM 表示。请参阅[此处](http://ronan.collobert.com/pub/matos/2004_links_icml.pdf)了解一些详细信息。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-11-25T05:39:45.053

如果你想使用内核 SVM，你必须猜测内核。然而，人工神经网络是通用的逼近器，只需要猜测宽度（逼近精度）和高度（逼近效率）。如果您正确设计优化问题，您就不会过度拟合（请参阅参考书目了解过度拟合）。它还取决于训练示例是否正确且均匀地扫描搜索空间。宽度和深度发现是整数规划的主题。

假设您在 I=[0,1] 上具有有界函数 f(.) 和有界通用逼近器，范围又为 I=[0,1] 例如，它们由紧致支持 U(.,a) 的真实序列参数化存在序列序列的性质

```
lim sup { |f(x) - U(x,a(k) ) | : x } =0 
```

`(x,y)`并且您使用分布 D 在 上绘制示例和测试`IxI`。

对于规定的支持，你要做的是找到最好的一个这样的

```
sum {  ( y(l) - U(x(l),a) )^{2} | : 1<=l<=N } is minimal 
```

让这`a=aa`是一个随机变量！，然后是过度拟合

平均使用`D and D^{N} of ( y - U(x,aa) )^{2}`

让我解释一下为什么，如果您选择`aa`使误差最小化，那么对于一组稀有的值，您将非常适合。但是，由于它们很少见，因此平均值永远不会为 0。尽管您有 D 的离散近似值，但您希望最小化第二个。请记住，支撑长度是自由的。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-11-25T09:43:13.197

我在这里缺少一个答案：多层感知器能够找到特征之间的关系。例如，在计算机视觉中，当向学习算法提供原始图像并且现在计算复杂特征时，这是必要的。本质上，中间层可以计算新的未知特征。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-11-24T19:41:45.213

我们还应该考虑到 SVM 系统可以*直接*应用于非度量空间，例如标记图或字符串的集合。事实上，只要满足核的正定性要求，内部核函数几乎可以适当地推广到任何类型的输入。另一方面，为了能够在一组标记图上使用 ANN，必须考虑显式嵌入过程。

# c++ - 如何将数据存储在 2D 数组中并使用 2 个循环显示 2D

> ID：11632519
> 
> 赞同：0
> 
> 时间：2012-07-24T13:59:18.157
> 
> 标签：c++

我试图画一个拼字游戏。您可以参考附件图片，这是我的电路板设计。我的程序将要求用户放置行和列并插入单词。示例：ROW =A 列 =5。但我不知道如何为每个声明变量。请协助。谢谢。

[http://img824.imageshack.us/img824/516/capturecba.jpg](http://img824.imageshack.us/img824/516/capturecba.jpg)

下面是我的代码：

```
void displayBoard() 
```

{ int a = 0; 静态字符串 alpha[] = {"1","2","3","4","5","6","7","8","9","10","11" ,"12","13","14","15",""};

```
cout <<"   A B C D E F G H I J K L M N O P"<<endl;

for (int j=0; j<=14; j++)
{
    cout << alpha[a];
    for ( int i = 0; i <= 15; i++)
    {
        cout << "|_";
    }
    cout <<"|";
    cout <<endl;
    a++;
} 
```

}

* * *

感谢帮助。我不太明白这一点。

```
for(i=0;i<word_length;i++)
{
board[word_i_offset][word_j_offset+i]=temporary_word_input[i];
} 
```

顺便说一句，我尝试重新做整个并停止插入。

```
void displayBoard()
{
 int i=15;
 int j=15;
 int a=0;
   static string alpha[] = {"1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9    ","10","11","12","13","14","15"," "};

  cout <<"   A B C D E F G H I J K L M N O"<<endl;

  char board[i][j];

for(int k=0; k<j; k++)
{
    cout<<alpha[a];
    for(int k=0; k<j; k++)
    {
       board[i][j]=' ';
       cout<<"|_";
    }
    cout<<"|";
    cout<<endl;
    a++;
}
cout<<endl;

 }

 int main()
  {
  int i=15;
  int j=15;
   int l=0;
  char board[i][j];
  int words,column;
  char answer,rows;

  displayBoard();

  cout<<endl;
  cout<<"Enter how many words : ";
  cin>>words;
  cout<<endl;
  cout<<"Insert on which rows : ";
  cin>>i;
  cout<<endl;
  cout<<"Insert on which column : ";
  cin>>j;
  cout<<endl;
  cout<<"Insert what words : ";
  cin>>answer;
  cout<<endl;

  for(l=0;l<words;l++)
  {
  board[i][j]=answer[];
   }

  return 0;
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:04:15.350

```
 char board[imax][jmax]; //declaration 
```

初始化：

```
for(int i=0;i<imax;i++)
{
    for(int j=0;j<jmax;j++)
    {
        board[imax][jmax]=' ';
    }

} 
```

印刷：

```
 for(int i=0;i<imax;i++)
{
    for(int j=0;j<jmax;j++)
    {
        printf("%c",board[imax][jmax]);
    }
    printf("\n");//newline
} 
```

在里面写一句话：

```
first check the bounds that word fits within the board's borders

check the horizontal borders and vertical borders, and check word length versus board length. 
```

然后：

```
for(i=0;i<word_length;i++)
{
    board[word_i_offset][word_j_offset+i]=temporary_word_input[i];
} 
```

# c# - 通过代码创建内容类型。新表格为空

> ID：11632522
> 
> 赞同：0
> 
> 时间：2012-07-24T13:59:28.077
> 
> 标签：c#, sharepoint

我正在尝试通过代码连接内容类型，（不要问为什么），哈哈。该功能工作正常，新列很好地添加到视图中。

由于某种原因，在 NEW 或 Edit 表单中，新的字段源名称不存在。当我转到高级列表设置时，它显示管理内容类型 = 否，但我在代码上将其设置为是。

我没主意了。

```
 private static void RemoveProductListAndCreateProductAndSourceList(SPWeb currentWeb)
        {
            currentWeb.AllowUnsafeUpdates = true;
            #region Adds/Removes the product and source list
                if (currentWeb.Lists.TryGetList(SponsoringCommon.Constants.LISTNAMES_PRODUCT_NAME) != null)
                {
                    currentWeb.Lists.TryGetList(SponsoringCommon.Constants.LISTNAMES_PRODUCT_NAME).Delete();
                    currentWeb.Lists.Add(SponsoringCommon.Constants.LISTNAMES_PRODUCT_NAME, string.Empty, SPListTemplateType.GenericList);
                }

                if (currentWeb.Lists.TryGetList(SponsoringCommon.Constants.LISTNAMES_SOURCES_NAME) != null)
                {
                    currentWeb.Lists.TryGetList(SponsoringCommon.Constants.LISTNAMES_SOURCES_NAME).Delete();
                    currentWeb.Lists.Add(SponsoringCommon.Constants.LISTNAMES_SOURCES_NAME, string.Empty, SPListTemplateType.GenericList);
                }
                else
                {
                    currentWeb.Lists.Add(SponsoringCommon.Constants.LISTNAMES_SOURCES_NAME, string.Empty, SPListTemplateType.GenericList);
                }
            #endregion

            #region HIde the title columns
                SPList productList = currentWeb.Lists.TryGetList(SponsoringCommon.Constants.LISTNAMES_PRODUCT_NAME);
                SPField titleField = productList.Fields.GetField("Title");
                titleField.ShowInEditForm = false;
                titleField.ShowInDisplayForm = false;
                titleField.ShowInNewForm = false;
                titleField.Update();

                SPList sourceList = currentWeb.Lists.TryGetList(SponsoringCommon.Constants.LISTNAMES_SOURCES_NAME);
                titleField = sourceList.Fields.GetField("Title");
                titleField.ShowInEditForm = false;
                titleField.ShowInDisplayForm = false;
                titleField.ShowInNewForm = false;
                titleField.Update(); 
            #endregion

            #region Add Source content type if it doesnt exist.
                SPContentType sourceContentType = currentWeb.ContentTypes[SponsoringCommon.Constants.CONTENTTYPES_SOURCES_NAME];
                SPContentTypeId sourceContentTypeid = new SPContentTypeId(SponsoringCommon.Constants.CONTENTTYPES_SOURCE_ID);
                if (sourceContentType == null)
                {
                    sourceContentType = new SPContentType(sourceContentTypeid,
                                                            currentWeb.ContentTypes,
                                                            SponsoringCommon.Constants.CONTENTTYPES_SOURCES_NAME);
                    currentWeb.ContentTypes.Add(sourceContentType);
                } 
            #endregion

            #region Removes the link from the content type column called Product Name 
                SPContentType productCT = currentWeb.ContentTypes[SponsoringCommon.Constants.CONTENTTYPES_PRODUCT_NAME];   
                productCT.DeleteFieldRefFromContentType(currentWeb.Fields[SponsoringCommon.Constants.FIELDS_PRODUCT_NAMEOLD]);                
            #endregion

            #region New fields properties
                SPFieldCurrency amountField = (SPFieldCurrency)currentWeb.Fields.GetFieldByInternalName(SponsoringCommon.Constants.FIELDS_PRICE_NAME);
                amountField.ShowInNewForm = true;
                amountField.ShowInEditForm = true;
                amountField.ShowInDisplayForm = true;

                string productFieldName = currentWeb.Fields.Add(SponsoringCommon.Constants.FIELDS_PRODUCT_NAMENEW, SPFieldType.Text, true);
                SPField productField = currentWeb.Fields.GetFieldByInternalName(productFieldName);
                productField.Group = "$Resources:SPNLSponsoring,Field_NationaleLoterijSponsoringColumns_Group";
                string schemaXmlWithResourceTokens = productField.SchemaXmlWithResourceTokens;
                int startIndex = schemaXmlWithResourceTokens.IndexOf("\"", schemaXmlWithResourceTokens.IndexOf("DisplayName=\"")) + 1;
                int endIndex = schemaXmlWithResourceTokens.IndexOf("\"", startIndex);
                int substringLength = endIndex - startIndex;
                string value = @"DisplayName=\" + schemaXmlWithResourceTokens.Substring(startIndex, substringLength);
                schemaXmlWithResourceTokens = schemaXmlWithResourceTokens.Replace(value, @"DisplayName=\$Resources:SPNLSponsoring,Field_Product_Name");
                productField.SchemaXml = schemaXmlWithResourceTokens;
                productField.ShowInNewForm = true;
                productField.ShowInEditForm = true;
                productField.ShowInDisplayForm = true;

                SPFieldLink fieldLinkProductName = new SPFieldLink(productField);
                SPFieldLink fieldLinkPriceName = new SPFieldLink(amountField);
                productCT.FieldLinks.Add(fieldLinkProductName);
                productCT.FieldLinks.Reorder(new string[] {productField.InternalName,amountField.InternalName});  //Reorder fields in the content type
                productCT.Update(true);                 

                productList.ContentTypesEnabled = true;
                productList.ContentTypes.Add(productCT);
                SPContentTypeCollection currentOrder = productList.ContentTypes; 
                List<SPContentType> result = new List<SPContentType>(); 
                foreach (SPContentType ct in currentOrder) 
                {
                    if (ct.Name.Contains(SponsoringCommon.Constants.CONTENTTYPES_PRODUCT_NAME)) 
                    { 
                        result.Add(ct); 
                    } 
                } 
                productList.RootFolder.UniqueContentTypeOrder = result; 
                productList.RootFolder.Update();

            #endregion

            string sourceFieldName = currentWeb.Fields.Add(SponsoringCommon.Constants.FIELDS_SOURCE_NAME, SPFieldType.Text, true);
            SPField sourceField = currentWeb.Fields.GetFieldByInternalName(sourceFieldName);
            sourceField.Group = "$Resources:SPNLSponsoring,Field_NationaleLoterijSponsoringColumns_Group";
            schemaXmlWithResourceTokens = sourceField.SchemaXmlWithResourceTokens;
            startIndex = schemaXmlWithResourceTokens.IndexOf("\"", schemaXmlWithResourceTokens.IndexOf("DisplayName=\"")) + 1;
            endIndex = schemaXmlWithResourceTokens.IndexOf("\"", startIndex);
            substringLength = endIndex - startIndex;
            value = @"DisplayName=\" + schemaXmlWithResourceTokens.Substring(startIndex, substringLength);
            schemaXmlWithResourceTokens = schemaXmlWithResourceTokens.Replace(value, @"DisplayName=\$Resources:SPNLSponsoring,Field_Source_Name");
            sourceField.SchemaXml = schemaXmlWithResourceTokens;
            sourceField.ShowInEditForm = true;
            sourceField.ShowInNewForm = true;
            sourceField.ShowInDisplayForm = true;

            SPFieldLink fieldLinkSourceName = new SPFieldLink(sourceField);
            sourceContentType.FieldLinks.Add(fieldLinkSourceName);
            sourceContentType.Update(true);

            sourceList.ContentTypesEnabled = true;
            sourceContentType.Update(true);

            sourceList.ContentTypes.Add(sourceContentType);              
            SPContentTypeCollection currentOrderSourceList = sourceList.ContentTypes;
            List<SPContentType> resultSourceList = new List<SPContentType>();
            foreach (SPContentType ct in currentOrderSourceList)
            {
                if (ct.Name.Contains(SponsoringCommon.Constants.CONTENTTYPES_SOURCES_NAME))
                {
                    resultSourceList.Add(ct);
                }
            }
            sourceList.RootFolder.UniqueContentTypeOrder = resultSourceList;
            sourceList.RootFolder.Update();                   

            #region Modify views.
                SPView vwAllItemsProductList = productList.GetSafeViewByName(SponsoringCommon.Constants.VIEWS_ALL_ITEMS);
                SPViewFieldCollection colvwAllItemsProductList = vwAllItemsProductList.ViewFields;
                if (vwAllItemsProductList.ViewFields.Exists("LinkTitle"))
                {
                    vwAllItemsProductList.ViewFields.Delete("LinkTitle");
                }
                colvwAllItemsProductList.Add(productField);
                colvwAllItemsProductList.Add(amountField);
                vwAllItemsProductList.Update();

                SPView vwAllItemsSourceList = sourceList.GetSafeViewByName(SponsoringCommon.Constants.VIEWS_ALL_ITEMS);
                SPViewFieldCollection colvwAllItemsSourceList = vwAllItemsSourceList.ViewFields;
                if (vwAllItemsSourceList.ViewFields.Exists("LinkTitle"))
                {
                    vwAllItemsSourceList.ViewFields.Delete("LinkTitle");
                }
                colvwAllItemsSourceList.Add(sourceField);
                vwAllItemsSourceList.Update(); 
            #endregion

            currentWeb.AllowUnsafeUpdates = false;

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T15:13:22.537

```
sourceList.ContentTypesEnabled = true; 
sourceContentType.Update(true); 

//Update the sourceList here this before you add the CT 
sourceList.ContentTypes.Add(sourceContentType); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T11:20:50.123

问题是，当我创建内容类型时，它是基于文档而不是项目，所以我将那部分更改为这个并且它起作用了。

```
 SPContentType itemCtype = currentWeb.AvailableContentTypes[SPBuiltInContentTypeId.Item];
                SPContentType sourceContentType = new SPContentType(itemCtype, currentWeb.ContentTypes, SponsoringCommon.Constants.CONTENTTYPES_SOURCES_NAME);
                sourceContentType = currentWeb.ContentTypes.Add(sourceContentType); 
```

# mysql - 如何使 SQL 脚本文件同时兼容 MYSQL 和 MSSQL？

> ID：11632524
> 
> 赞同：3
> 
> 时间：2012-07-24T13:59:42.027
> 
> 标签：mysql, sql, sql-server

有什么办法可以使 sql 脚本文件与 MYSQL 和 MSSQL 兼容？MYSQL 和 MSSQL 应该能够使用该文件来执行该文件中包含的 SQL 脚本。以下 SQL 语句只是一个示例。

```
 CREATE TABLE testTable(
   Name VARCHAR(20),
   Address VARCHAR(50),
   Gender VARCHAR(10)
   );

   INSERT INTO testTable
   VALUES
   ('Derp', 'ForeverAlone Street', 'Male'),
   ('Derpina', 'Whiterun Breezehome', 'Female');

   SELECT * FROM testTable; 
```

PS，我听说你可以使用 CSV 文件。我不知道这是不是真的。我在网上没有看到任何合适的例子。

编辑：不，您不能使用 csv 文件来执行语句。它们用于转储数据。一些 sql 语句在 MS SQL 和 MYSQL 中的写法不同。常用语句如 Create、select 语句在 MS SQL 和 MY SQL 中是相同的。不同之处之一可能是`LOAD DATA INFILE`和`BULK INSERT FROM`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:09:35.167

使用 ansi sql 将避免大多数问题，但我不确定是否有可能在所有情况下都有 100% 交叉兼容的东西

有关更多信息，请参见此处：[ANSI SQL 手册](https://stackoverflow.com/questions/1714461/ansi-sql-manual)

# javascript - 在输入的每 4 个字符后插入破折号

> ID：11632525
> 
> 赞同：37
> 
> 时间：2012-07-24T13:59:46.377
> 
> 标签：javascript, jquery, regex

我想在输入的每 4 个字符后插入一个破折号。我有一个信用卡输入框。当用户键入并到达每个第 4 个字符时，jQuery 将插入一个连字符 ( `-`)。

例如：`1234-5678-1234-1231`

**更新：**我正在尝试一些代码，我认为我非常接近正确的代码，但我有一些问题。这是我的代码示例；

```
$('.creditCardText').keyup(function() {

var cardValue = $('.creditCardText').val(),
    cardLength = cardValue.length;

if ( cardLength < 5 ) {
    if ( cardLength % 4 == 0 ) {
        console.log('4 lük geldi');
        cardValue += "-";
        $('.creditCardText').val(cardValue);
    }
} else {
    if ( cardLength % 5 == 0 ) {
        console.log('5 lük geldi');
        cardValue += "-";
        $('.creditCardText').val(cardValue);

    }
}

}); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-24T14:02:51.250

我非常喜欢这个用于自动格式化的插件： [here](http://digitalbush.com/projects/masked-input-plugin/)。

只要您已经在使用 JQuery，就是这样。

您可以使用一行代码轻松地强制使用破折号，如下所示：

```
$("#credit").mask("9999-9999-9999-9999"); 
```

当用户在字段中输入时，破折号将自动出现在正确的位置，他们将无法删除它们。

此外，您可以容纳不同长度或格式的信用卡，其中包含`?`您的面具中的字符。例如，要接受 14 位和 16 位的输入，您可以执行以下操作：

```
$("#credit").mask("9999-9999-9999-99?99"); 
```

请记住，这只是客户端验证

* * *

***编辑***：掩码插件假定该字段有一种或有限多种正确格式。例如，信用卡号只有几种格式。该插件可确保您的输入*仅*采用其中一种格式。

所以从技术上讲，如果你想在每四位数字后面加上一个破折号，但是对于*任意*数量的数字，那么这个插件不适合你。

我建议您将可能的输入限制在合理范围内，因为肯定不存在 1000 位长的信用卡之类的东西。但是如果你真的想要那个功能，你必须自己写脚本或者找另一个插件。到目前为止，我不知道一个。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-04-10T07:46:54.117

我已经修复了您的代码，但仍然强烈建议服务器验证**并**使用四个文本框，并在它们之间巧妙地切换：

```
$('.creditCardText').keyup(function() {
  var foo = $(this).val().split("-").join(""); // remove hyphens
  if (foo.length > 0) {
    foo = foo.match(new RegExp('.{1,4}', 'g')).join("-");
  }
  $(this).val(foo);
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<input type="text" class="creditCardText" />
```

[在 jsFiddle 上查看](http://jsfiddle.net/juspC/126/)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2016-06-03T14:47:58.413

### 基于@think123 的回答，在 vanilla JS 中，没有 JQuery：

```
document.querySelector('.creditCardText').addEventListener('input', function(e) {
  var foo = this.value.split("-").join("");
  if (foo.length > 0) {
    foo = foo.match(new RegExp('.{1,4}', 'g')).join("-");
  }
  this.value = foo;
});
```

```
<input class="creditCardText" type="text">
```

*我知道这个问题是关于 JQuery 的，但我认为这个答案也有帮助。*

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-10-26T08:50:39.683

如果您正在寻找纯 Javascript 解决方案，请查看下面的函数。它支持美国运通格式（15 位）以及 Visa、MasterCard 等（16 位）。

注意将替换整个值并始终将焦点放在输入末尾的简单解决方案：如果用户编辑他之前输入的内容，可能会很烦人。

```
input_credit_card = function(input) {
  var format_and_pos = function(char, backspace) {
    var start = 0;
    var end = 0;
    var pos = 0;
    var separator = " ";
    var value = input.value;

    if (char !== false) {
      start = input.selectionStart;
      end = input.selectionEnd;

      if (backspace && start > 0) // handle backspace onkeydown
      {
        start--;

        if (value[start] == separator) {
          start--;
        }
      }
      // To be able to replace the selection if there is one
      value = value.substring(0, start) + char + value.substring(end);

      pos = start + char.length; // caret position
    }

    var d = 0; // digit count
    var dd = 0; // total
    var gi = 0; // group index
    var newV = "";
    var groups = /^\D*3[47]/.test(value) ? // check for American Express
      [4, 6, 5] : [4, 4, 4, 4];

    for (var i = 0; i < value.length; i++) {
      if (/\D/.test(value[i])) {
        if (start > i) {
          pos--;
        }
      } else {
        if (d === groups[gi]) {
          newV += separator;
          d = 0;
          gi++;

          if (start >= i) {
            pos++;
          }
        }
        newV += value[i];
        d++;
        dd++;
      }
      if (d === groups[gi] && groups.length === gi + 1) // max length
      {
        break;
      }
    }
    input.value = newV;

    if (char !== false) {
      input.setSelectionRange(pos, pos);
    }
  };

  input.addEventListener('keypress', function(e) {
    var code = e.charCode || e.keyCode || e.which;

    // Check for tab and arrow keys (needed in Firefox)
    if (code !== 9 && (code < 37 || code > 40) &&
      // and CTRL+C / CTRL+V
      !(e.ctrlKey && (code === 99 || code === 118))) {
      e.preventDefault();

      var char = String.fromCharCode(code);

      // if the character is non-digit
      // OR
      // if the value already contains 15/16 digits and there is no selection
      // -> return false (the character is not inserted)

      if (/\D/.test(char) || (this.selectionStart === this.selectionEnd &&
          this.value.replace(/\D/g, '').length >=
          (/^\D*3[47]/.test(this.value) ? 15 : 16))) // 15 digits if Amex
      {
        return false;
      }
      format_and_pos(char);
    }
  });

  // backspace doesn't fire the keypress event
  input.addEventListener('keydown', function(e) {
    if (e.keyCode === 8 || e.keyCode === 46) // backspace or delete
    {
      e.preventDefault();
      format_and_pos('', this.selectionStart === this.selectionEnd);
    }
  });

  input.addEventListener('paste', function() {
    // A timeout is needed to get the new value pasted
    setTimeout(function() {
      format_and_pos('');
    }, 50);
  });

  input.addEventListener('blur', function() {
    // reformat onblur just in case (optional)
    format_and_pos(this, false);
  });
};

input_credit_card(document.getElementById('credit-card'));
```

```
<form action="" method="post">
  <fieldset>
    <legend>Payment</legend>
    <div>
      <label for="credit-card">Credit card</label>
      <input id="credit-card" type="text" autocomplete="off" />
    </div>
  </fieldset>
</form>
```

[在 jsFiddle 上查看](https://jsfiddle.net/pmrotule/217u7fru/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-01-12T09:35:11.797

通过修改***@think123***和***@TheStoryCoder***的建议，我为光标添加了 selectionStart 和 SelectionEnd。之后在合适的位置增加光标位置并修改光标位置。它应该解决光标位置不是预期的位置。

```
$('.creditCardText').keyup(function() {

  var ss, se, obj;
  obj = $(this);
  ss = obj[0].selectionStart;
  se = obj[0].selectionEnd;

  var curr = obj.val();

  var foo = $(this).val().split("-").join(""); // remove hyphens
  if (foo.length > 0) {
    foo = foo.match(new RegExp('.{1,4}', 'g')).join("-");
  }

  if (((curr.length % 5 == 0) && ss == se && ss == curr.length) || (ss == se && (ss % 5 == 0))) {
    ss += 1;
    se += 1;
  }

  if (curr != foo) {
    $(this).val(foo);
    obj[0].selectionStart = ss;
    obj[0].selectionEnd = se;
  }

});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<input class="creditCardText" type="text">
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-12-31T11:47:02.357

最简单的方法是使用简单的 javascript onkey 和函数进行以下操作......它会在您输入/键入的每 3 个字符后放置一个破折号连字符。

```
function addDash(element) {
  let ele = document.getElementById(element.id);
  ele = ele.value.split('-').join(''); // Remove dash (-) if mistakenly entered.

  let finalVal = ele.match(/.{1,3}/g).join('-');
  document.getElementById(element.id).value = finalVal;
}
```

```
<input type="text" class="form-control" name="sector" id="sector" onkeyup="addDash(this)" required>
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-08-13T11:23:40.417

在我上面回答的所有其他人都是正确的，他们的代码绝对简短而整洁，但有点先进，因为他们要么使用正则表达式，要么使用插件。类似的事情也可以通过基本的 js/jquery 来实现，从您尝试实现的示例代码来看。由于这个问题大约有 3 年的历史，你现在一定已经得到了你想要的东西，但是是的，你已经接近了。这就是你应该尝试的：

```
$('.creditCardText').keyup(function() {
  var cctlength = $(this).val().length; // get character length

  switch (cctlength) {
    case 4:
      var cctVal = $(this).val();
      var cctNewVal = cctVal + '-';
      $(this).val(cctNewVal);
      break;
    case 9:
      var cctVal = $(this).val();
      var cctNewVal = cctVal + '-';
      $(this).val(cctNewVal);
      break;
    case 14:
      var cctVal = $(this).val();
      var cctNewVal = cctVal + '-';
      $(this).val(cctNewVal);
      break;
    default:
      break;
  }
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<input type="text" class="creditCardText" maxlength="19" />
```

[JSFiddle 链接](https://jsfiddle.net/BrajinderSingh/kqg5ndxv/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-03-25T13:42:43.057

您可以使用 vanilla JS 来实现，并且不需要插件来做到这一点。请参阅下面的代码。您可以更改`var split`以适合您的需要。归功于[https://webdesign.tutsplus.com/tutorials/auto-formatting-input-value--cms-26745](https://webdesign.tutsplus.com/tutorials/auto-formatting-input-value--cms-26745)。

```
(function($, undefined) {

    "use strict";

    // When ready.
    $(function() {

        var $form = $( "#form" );
        var $input = $form.find( "input" );

        $input.on( "keyup", function( event ) {

            console.log('sss')
            // When user select text in the document, also abort.
            var selection = window.getSelection().toString();
            if ( selection !== '' ) {
                return;
            }

            // When the arrow keys are pressed, abort.
            if ( $.inArray( event.keyCode, [38,40,37,39] ) !== -1 ) {
                return;
            }

            var $this = $(this);
            var input = $this.val();
                    input = input.replace(/[\W\s\._\-]+/g, '');

                var split = 4;
                var chunk = [];

                for (var i = 0, len = input.length; i < len; i += split) {                              chunk.push( input.substr( i, split ) );
                }

                 console.log(chunk)
                $this.val(function() {
                    return chunk.join("-");
                });

        } );

        /**
         * ==================================
         * When Form Submitted
         * ==================================
         */
        $form.on( "submit", function( event ) {

            var $this = $( this );
            var arr = $this.serializeArray();

            for (var i = 0; i < arr.length; i++) {
                    arr[i].value = arr[i].value.replace(/[($)\s\._\-]+/g, ''); // Sanitize the values.
            };

            console.log( arr );

            event.preventDefault();
        });

    });
})(jQuery);
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<form id="form" method="post" action="">

        <label for="number">Enter number</label>
        <div class="flex">
            <input id="number" name="number" type="text" maxlength="15" />
        </div>

</form>
```

# mysql - Mysql - 三表查询

> ID：11632528
> 
> 赞同：2
> 
> 时间：2012-07-24T13:59:52.103
> 
> 标签：mysql

我有三个用于存储一些用户数据的表。

`sub_domains`（体验子域在这里。匹配`exp_id`和匹配。所以如果用户有多个子域，则and可以重复）`id``exp``domain_id``id``misc``user_id``exp_id`

```
+-----------+---------+------+-----+---------+----------------+
| Field     | Type    | Null | Key | Default | Extra          |
+-----------+---------+------+-----+---------+----------------+
| id        | int(11) | NO   | PRI | NULL    | auto_increment |
| user_id   | int(50) | YES  |     | NULL    |                |
| domain_id | int(10) | NO   |     | NULL    |                |
| exp_id    | int(50) | YES  |     | NULL    |                |
+-----------+---------+------+-----+---------+----------------+ 
```

`misc`

```
+----------+--------------+------+-----+---------+----------------+
| Field    | Type         | Null | Key | Default | Extra          |
+----------+--------------+------+-----+---------+----------------+
| id       | int(11)      | NO   | PRI | NULL    | auto_increment |
| name     | varchar(100) | YES  |     | NULL    |                |
| category | varchar(255) | YES  |     | NULL    |                |
+----------+--------------+------+-----+---------+----------------+ 
```

`exp`

```
+------------+--------------+------+-----+---------+----------------+
| Field      | Type         | Null | Key | Default | Extra          |
+------------+--------------+------+-----+---------+----------------+
| id         | int(11)      | NO   | PRI | NULL    | auto_increment |
| user_id    | int(11)      | YES  |     | NULL    |                |
| job_type   | varchar(60)  | YES  |     | NULL    |                |
| experience | varchar(500) | YES  |     | NULL    |                |
| exp_title  | varchar(255) | YES  |     | NULL    |                |
| domain     | varchar(125) | YES  |     | NULL    |                |
| start      | varchar(20)  | YES  |     | NULL    |                |
| end        | varchar(20)  | YES  |     | NULL    |                |
+------------+--------------+------+-----+---------+----------------+ 
```

这是我从 exp 获取数据的 atm 查询：

```
$query_str = "SELECT a.id, a.user_id, a.job_type, a.experience, a.exp_title, a.domain,     a.start, a.end, b.name
FROM exp a
JOIN misc b ON a.domain=b.id
WHERE a.user_id = ?"; 
```

我已经从中获取了域名，`misc`但我也想从中获取每个子域的名称，`misc`但我不知道如何更改查询。

编辑

我对此进行了一些研究，并提出了以下建议：

```
$query_str = "SELECT a.id, a.user_id, a.job_type, a.experience, a.exp_title, a.domain, a.start, a.end, b.name,
(SELECT GROUP_CONCAT(domain_id) FROM sub_domains sd WHERE a.id=sd.exp_id) AS subs,
(SELECT GROUP_CONCAT(name) FROM misc WHERE id IN( subs ) ) AS subcats
FROM exp a
JOIN misc b ON a.domain=b.id
WHERE a.user_id = ?"; 
```

它几乎可以工作，子猫的 var_dump 只返回表中的第`name`一个`misc`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T14:04:05.300

这应该有效：

```
SELECT a.id, a.user_id, a.job_type, a.experience, a.exp_title, a.domain, a.start, a.end, b.name
FROM exp a
     INNER JOIN misc b 
         ON a.domain=b.id
     INNER JOIN sub_domains c
         ON a.id=c.exp_id
WHERE a.user_id = ? 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-27T14:18:31.100

不确定您到底在追求什么，但这可能会有所帮助。使用 LEFT JOIN 因为您没有强制执行外键。

```
select exp.id, exp.user_id, exp.job_type, exp.experience, exp.exp_title,
       exp.domain, exp.start, exp.end,
       GROUP_CONCAT(misc.name) as sub_domain_names
from exp
left join sub_domains
    on (exp.id = sub_domains.exp_id)
left join misc
    on (sub_domains.domain_id = misc.id)
where exp.user_id = ?
group by exp.id, exp.user_id, exp.job_type, exp.experience, exp.exp_title,
         exp.domain, exp.start, exp.end; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T14:04:13.190

只需扩展您当前的查询：

```
SELECT a.id, a.user_id, a.job_type, a.experience, 
       a.exp_title, a.domain, a.start, a.end, b.name, c.id
FROM exp a
JOIN misc b ON a.domain = b.id
JOIN sub_domains c ON c.domain_id = b.id
WHERE a.user_id = ? 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-29T02:11:51.507

在研究了你的问题一段时间后，我能够弄清楚你在追求什么。

你可以试试这个解决方案：

```
SELECT    
    a.*, 
    b.name AS domain_name,
    c.subdomain_names
FROM
    exp a
LEFT JOIN 
    misc b ON a.domain = b.id
LEFT JOIN
(
    SELECT   aa.exp_id, GROUP_CONCAT(bb.name) AS subdomain_names
    FROM     sub_domains aa
    JOIN     misc bb ON aa.domain_id = bb.id
    GROUP BY aa.exp_id
) c ON a.id = c.exp_id
WHERE 
    a.user_id = ? 
```

虽然我有点困惑，如果表中已经引用了为什么你在表中有一个`user_id`列。对我来说，这似乎是可以消除的重复。`sub_domains``user_id``exp`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-30T12:26:27.793

我有同样的问题。由于您的查询很好并且运行良好。但是，您需要使用`GROUP_CONCAT()`方法显示所有名称。

不幸的是，它只显示名字。是吗 ？

`IN()`如果您手动将值放入其中，请检查您的`IN`情况

`IN('1,2,3')`此外，它会显示你的名字。

解决方案：-

保持您的查询不变。但是将下面的行与查询分开：

```
String query1= SELECT GROUP_CONCAT(domain_id) FROM sub_domains sd WHERE a.id=sd.exp_id 
```

在执行主查询之前，首先在 DAO 类（您的 DAO 方法）中运行此查询。

在 a 中获取返回值，`String`然后将 that(query1)`String`放入您的主查询`IN()`中。

我从这种类型的 DAO 操作中得到了我预期的答案。希望它的帮助充分。

# eclipse - 如何在 Eclipse 上与团队合作开展项目？

> ID：11632532
> 
> 赞同：0
> 
> 时间：2012-07-24T13:59:58.317
> 
> 标签：eclipse, git, eclipse-plugin, github

所以我在 Eclipse 中开发 Java 应用程序。直到现在我都是自己做的，但最近我的一个朋友对一个应用程序有一个很棒的想法，并建议我们都在做这个，所以我们需要共享项目文件。我在网上搜索了一些关于通过 EGit 插件使用 git 的信息。问题是我真的不明白这是如何工作的。

有没有其他方法可以做到这一点？（因为我不明白这些东西是如何工作的，所以我还没有准备好升级我的私人存储库的 git）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:07:05.000

我了解您想使用 Git，而使用 GitHub 作为平台可以说是当时最好的协作方式。最简单的开始方法是从命令行学习 Git。一旦你知道它是如何工作的，通常很容易弄清楚插件（在你的情况下是 EGit）是如何工作的。

查看[Git 参考](http://gitref.org/)和 GitHubs[学习 Git 的精彩互动教程](http://try.github.com/levels/1/challenges/1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:03:28.997

所以你在你的个人电脑上安装了 Git，你想和你的朋友分享源代码，这样你们就可以一起工作了？

我看到两个选项。

# 1 打开您的计算机，以便您的朋友可以直接从您的计算机上访问它，这可能不是最好的主意。

# 2 在网络上注册一个存储库，也许是 GitHub？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:05:29.453

只需获取 SVN 存储库或 GIT 和 Eclipse [SVN 插件](http://www.eclipse.org/subversive/)。然后您可以启动并下载代码，如果您的伴侣与您同时更改了文件，系统将提示您合并文件 - eclipse 将完成大部分工作，只需使用 svn 作为开始。

# sql-server - 用于合并客户帐户的 SQL 脚本

> ID：11632540
> 
> 赞同：1
> 
> 时间：2012-07-24T14:00:12.743
> 
> 标签：sql-server

我想出了一个脚本来选择“主”帐户和“从”帐户。公司名称和邮政编码完全匹配的地方。它认为最近更新的帐户是主帐户。

```
select
    m.ev870_acct_code, m.ev870_company_name, m.ev870_postal_code, m.ev870_iacvb_code,
    s.ev870_acct_code, s.ev870_company_name, s.ev870_postal_code, s.ev870_iacvb_code
from
    ev870_acct_master m
inner join
    ev870_acct_master s
on
    m.ev870_company_name = s.ev870_company_name
and m.ev870_postal_code = s.ev870_postal_code
and m.ev870_upd_stamp > s.ev870_upd_stamp
where
    m.ev870_class = 'o'
and s.ev870_class = 'o'
and m.ev870_status != '0'
and s.ev870_status != '0'
and (m.ev870_iacvb_code = s.ev870_iacvb_code or isnull(m.ev870_iacvb_code,'') = '' or isnull(s.ev870_iacvb_code,'') = '')
and s.ev870_company_name like '%council%'
order by
    m.ev870_upd_stamp desc 
```

脚本的问题在于它可能确定：

*   账户 1 是主账户，并且存在重复的从账户 2。
*   账户 1 是主账户，并且存在重复的从账户 3。
*   账户 2 是主账户，并且存在重复的从账户 3。

如您所见，每个步骤的结果都会影响下一个步骤。你能推荐一个更智能的查询吗？

*编辑*解决方案：

```
select
    m.ev870_acct_code, m.ev870_company_name, m.ev870_postal_code, m.ev870_iacvb_code,
    s.ev870_acct_code, s.ev870_company_name, s.ev870_postal_code, s.ev870_iacvb_code
from
    ev870_acct_master s
inner join 
    (
    select 
        ev870_acct_code, ev870_company_name, ev870_postal_code, ev870_iacvb_code, ev870_upd_stamp
        ,row_number() over (partition by ev870_company_name, ev870_postal_code, ev870_iacvb_code order by ev870_upd_stamp desc) as howRecent
    from 
        ev870_acct_master
    where
        ev870_class = 'o'
    and ev870_status != '0'
    and ev870_postal_code != ''
    and ev870_company_name like 'A%'
    ) m 
on  
    m.ev870_company_name = s.ev870_company_name
and m.ev870_postal_code = s.ev870_postal_code
and m.ev870_upd_stamp > s.ev870_upd_stamp
where
    m.howRecent = 1
and m.ev870_iacvb_code = s.ev870_iacvb_code
and s.ev870_class = 'o'
and s.ev870_status != '0' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T16:31:29.110

关注您的评论：

> @kristof 我正在识别我的应用程序中的重复帐户，然后将其合并到一个帐户中。

您可以使用类似于此的代码：

```
declare @dupExample table (
    id int identity(1,1)
    ,name varchar(50)
    ,postal varchar(50)
    ,lastUpdated datetime
)

insert into @dupExample(name, postal, lastUpdated)
values 
    ('a','pc1','20120101')
    ,('a','pc1','20120501')
    ,('a','pc1','20120601')
    ,('a','pc1','20120701')
    ,('a','pc1','20120201')
    ,('b','pc2','20120102')
    ,('b','pc2','20120202')
    ,('b','pc2','20120302')
    ,('b','pc2','20120302')
    ,('c','pc2','20120302')
    ,('d','pc2','20120302')
    ,('d','pc2','20120302')

select * from @dupExample 

/*
    to see duplicates along with how recent they are
*/
select 
    *
    ,row_number() over (partition by name, postal order by lastUpdated) as howRecent
from 
    @dupExample     

/*
    delete duplicates leaving only most recent record based on date updated
    WARNING only one record will be left for each dup even if there are multiple records 
    updated on the same date (see b, d examples)
*/
delete de
from    @dupExample de
    inner join 
    ( select 
        id
        ,row_number() over (partition by name, postal order by lastUpdated desc) as howRecent
        from 
            @dupExample     
    ) der on de.id = der.id
where
    der.howRecent > 1   

/*
    after delete
*/      
select * from @dupExample 
```

如果您有相同 dateUpdated 的重复项，您可以添加一些额外的标准来**按**部分排序，以指定在这种情况下要删除的记录 - 但希望它能给您一个好的起点。

# javascript - jquery masonry 是否复制了 imagesLoaded 函数？

> ID：11632541
> 
> 赞同：5
> 
> 时间：2012-07-24T14:00:13.963
> 
> 标签：javascript, jquery, jquery-plugins, jquery-masonry

我是 javascript 插件的新手。所以这是我的问题（关于 jQuery 砌体）。

我注意到最新的 masonry.js 里面有 imagesLoaded。然后我还注意到 masonry 网站建议用户下载 imagesLoaded 插件。

*   Q1）这是一个重复，还是两者都需要存在才能使它起作用？
*   Q2) 我是否需要包含和引用单独的 imagesLoaded.js 插件文件才能使用它？

旁注：在注意到我的砌体对象第一次加载得很好之后，我得出了这个结论，但是在随后的加载中，当我尝试初始化砌体时，它会引发错误。尽管无论如何，在不包括 imagesLoaded 插件文件本身的情况下，imagesLoaded 似乎运行得很好。

*   更新 *

我看到的错误是由于我在用新内容更新之前没有“删除”砌体内容。所以这不是更新的 imagesLoaded.js 的问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T06:02:00.537

jQuery Masonry 包含 jQuery imagesLoaded 插件 v1.1.0 的过时版本。

截至 2012 年 7 月 30 日，jQuery imagesLoaded 插件的最新版本是 v2.0.1 [https://github.com/desandro/imagesloaded/blob/master/jquery.imagesloaded.js](https://github.com/desandro/imagesloaded/blob/master/jquery.imagesloaded.js)

您可以通过在 jQuery Masonry 之后包含脚本来将 jQuery imageloaded 从版本 1.1.0 升级到 2.0.1。

但是，我不确定升级是否会破坏任何东西。但从你的问题看来，确实如此。

### 更新

jQuery Masonry 和 jQuery imagesLoaded 是同一个人 desandro 的不同项目。

由于 jQuery Masonry 建议您使用 jQuery imagesLoaded，因此他将其作为源代码的一部分，因此您不必导入其他文件。

导入一个脚本而不是两个脚本更容易。

当您包含最新版本的 jQuery imagesLoad 时，通过导入单独的脚本，您将覆盖对函数调用的旧引用。

jQuery imagesLoad 的最新版本具有更简洁的代码，但两个版本似乎具有相同的功能。

# extjs4 - 未检测到按钮单击

> ID：11632542
> 
> 赞同：0
> 
> 时间：2012-07-24T14:00:16.513
> 
> 标签：extjs4, extjs4.1, extjs-mvc

我有一个窗口，它包含一些文本字段和一个按钮。这是按钮的定义；别名.widget:'mywin', ....

```
 {
                xtype: 'button',
                height: 40,
                width: 110,
                text: 'send',
                x: 58,
                y: 12,
                action: 'buttonclick'
            }, 
```

在我的控制器中，我将检测此按钮单击并显示一个 console.log 语句。

这是代码；

初始化：函数（应用程序）{ this.control（{

```
 'mywin button[action=buttonclick]': {
            click: this.butClick
        }
    });
},

butClick: function(button,record) {
    console.log('Button clicked'); 
```

这没有显示出来，我该如何解决？

**更新**

```
Ext.define('MyApp.view.MyWindowClass', {
    extend: 'Ext.window.Window',
    alias: 'widget.mywin',
    height: 340,
    id: 'mywinid',
    width: 728,
    layout: {
        type: 'absolute'
    },

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [

                {
                    xtype: 'textareafield',
                    height: 140,
                    width: 340,
                    fieldLabel: 'Name',
                    x: 370,
                    y: 80
                },
                {
                    xtype: 'button',
                    height: 40,
                    width: 210,
                    text: 'Save',
                    x: 480,
                    y: 240,
                    action: 'submitfeedback'
                },
                {
                    xtype: 'datefield',
                    id: 'dd',
                    readOnly: true,
                    fieldLabel: 'Today',
                    x: 10                  
                }
            ],
            listeners: {
                show: {
                    fn: me.onWindowShow,
                    scope: me
                }
            }
        });
        me.callParent(arguments);
    }
}); 
```

**控制器**

```
Ext.define('MyApp.controller.MyController', {
    extend: 'Ext.app.Controller',
    models: [
        'MyController'
    ],
    stores: [
        'MyController'
    ],
    views: [
        'MyWindowClass',        
    ],
    init: function(application) {
        this.control({
            'mywin button[action=submitfeedback]': {
                click: this.butClick
            }
        });
    },
    butClick: function(button,record) {
        console.log('button clicked');
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T14:23:06.943

两种可能：

1.  这可能是一个错字，但你写了`alias.widget: 'mywin'`. 这应该是`alias: 'widget.mywin'`

2.  控制器可能未加载。在 init 函数的开头放置一个断点以查看它是否运行。

除此之外，您的代码看起来是正确的。如果您发布更多上下文（例如，您如何创建窗口、加载控制器、mywin 的完整定义），我可以进一步检查它。

**编辑**

您在选择器中的大小写错误。`myWin`应该是`mywin`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:10:41.377

`[action=buttonclick]`除了添加部分之外，您已经正确设置了侦听器。这是有关此的[文档](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.app.Controller-cfg-listeners)。

```
'mywin button': { // this line determines what view object you want to listen to
    click: this.butClick // this line determines what event you want to listen to
} 
```

# javascript - 如何向 [] 添加方法？

> ID：11632544
> 
> 赞同：4
> 
> 时间：2012-07-24T14:00:18.587
> 
> 标签：javascript, ember.js

首先，我并不清楚这个对象的类型（也许是 NativeArray ？）。对我来说，ember 通过将 NativeArray mixin 应用到 Array.prototype 来使用一些 mixin 覆盖默认的 javascript 数组。

也就是说，在我的代码中，我想通过允许进行这种覆盖：

```
["a", "b", "a"].count("a") // returns 2 
```

我试图重新打开 Enumerable Mixin （对我来说这是这种功能的正确位置）

我确定在使用 count() 方法之前执行了重新打开代码。但是我遇到了这个错误：

```
Object has no method count(). 
```

阅读代码似乎我必须将 mixin 重新应用于 Array.prototype，但不幸的是，什么都不做`Ember.Enumerable.apply(Array.prototype)`。

**更新：** 看了一些文章后，我开始了解原型。我可以将函数添加到数组中：

```
Array.prototype.newFunc = function () {
    console.log('bla');
} 
```

但就我而言，这并不令人满意，例如，一个 MutableArray 将能够调用`newFun()`

也许做我想做的唯一方法是制作一个 PR 以将我的计数方法包含到 Enumerable Mixin 中。

欢迎任何其他建议:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T17:16:08.763

您正在寻找`reopen`，它允许您修改现有的类。这是一个例子：

```
Ember.Enumerable.reopen({
    newFunc: function() {
        console.log('blah');
    }
}); 
```

**警告**：调用`reopen`不会对已经实例化的对象产生影响。它只会影响调用重新打开后创建的对象。简而言之，确保你`reopen`先打电话。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T15:32:27.180

[http://jsfiddle.net/kcjzw/249/](http://jsfiddle.net/kcjzw/249/)

```
App = Ember.Application.create();

var NativeArray = Ember.Mixin.create(Ember.NativeArray, {
    count: function(ele) {
        var noOfEle = 20;
        //add your logic to count
        return noOfEle;
    }
});

NativeArray.apply(Array.prototype);
console.log(["a", "b", "a"].count("a")); //20 
```

REF: [Emberjs 中的原生数组不支持深拷贝？](https://stackoverflow.com/questions/9693154/native-array-in-emberjs-does-not-support-deep-copy)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-05T04:42:12.060

这不是 100% 的，所以请带着一点怀疑来阅读它。看起来 mixins 在更新和创建时可以遵循两条主要路径。一个是“重新打开”方法，这最终会向对象添加另一个 mixin。第二个是“应用”，它实际上将这些 mixin 合并到对象本身中，并且您丢失了 mixin 引用。因此，除非您在定义的新类中使用它，否则更新 Ember.Enumerable 几乎不会给您带来任何好处。

您总是可以在所有 Enumerable 类型上触发“应用”方法，但这有点痛苦......也许有些检测到搜索并返回所有主要类的黑客......嗯。

另一个解决方案是分叉 repo 并添加方法（可能会为您节省大量的头痛和时间……您确实对此说过一些话）。我想在 9.8 中你曾经能够做这种事情，但是这些后来的构建对此提出了一个问题。

**编辑**：为了澄清，“合并”我的意思是把实际的方法复制到另一个对象上。例如 (Array.prototype)... 所以“检测”会找到 Ember.Enumerable 但该 Mixin 不再真正被 Array 引用（方法已复制到前面）。

我想你可以创建一个新的 mixin 并根据需要将其应用于类型（你只需要记住你是明确地这样做的）。现在，如果您只需要在 Array 上使用它，您只需将其应用到 Array.prototype。下次当你需要它时，比如说 ArrayController，你添加它。

做了一个[简单的提琴手](http://jsfiddle.net/scispear/JykhF/)，但它与其他人发布的几乎相同。我仍然不喜欢分叉回购。

# asp.net-mvc-3 - 如何修复基本 MVC3 路由上的“路径中的非法字符”？

> ID：11632546
> 
> 赞同：1
> 
> 时间：2012-07-24T14:00:23.633
> 
> 标签：asp.net-mvc-3, routes, illegal-characters

给定以下两条路线：

```
 routes.MapRoute(name: "NationalRssResults", url: "{searchTerm}/rss", defaults: new { controller = "Results", action = "SearchWholeCountryRss" });
        routes.MapRoute(name: "CityRssResults", url: "{city}-{state}/{searchTerm}/rss", defaults: new { controller = "Results", action = "SearchCityStateRss" }); 
```

导航到`localhost:51860/fire-blanket/rss`返回数据就好了，但是尝试`localhost:51860/SomeState-SomeCity/fire-blanket/rss`返回`Illegal characters in path`错误。

这些路线在我列表的顶部，所以其他人不应该干涉，对吧？

我在 RSS 内容生成过程中一直跟踪这一点，并且总是从以下内容开始：

```
<?xml version="1.0" encoding="utf-16"?><rss xmlns:a10="http://www.w3.org/2005/Atom" version="2.0"><channel><title>... 
```

视图如下所示：

```
@model MyApp.Models4.ResultsPage

@Html.Raw(Model.rssResults) 
```

我已经在[这里](https://stackoverflow.com/questions/2087246/howto-allow-illegal-characters-in-path)尝试了一些 web.config 建议- 仍然不行。

我不确定为什么会收到此错误。协助表示赞赏。

谢谢。

# android - 在不知道其位置的情况下删除 listView 中的项目（从广播意图的服务中）

> ID：11632556
> 
> 赞同：0
> 
> 时间：2012-07-24T14:00:58.717
> 
> 标签：android, android-listview, broadcastreceiver

我有一个每分钟同步数据的服务。当修改/创建数据时，我会向我的 Activity 发送广播以更新我的 ListView。

要更新视图，我想删除它并使用正确的值重新创建，但我不知道它的位置，我只有它的 textViews 的内容。

活动 ：

```
public void onCreate{
...
this.registerReceiver(this.updateListReceiver, new IntentFilter(
            "com.android.updatelist"));
}

BroadcastReceiver updateListReceiver = new BroadcastReceiver() {

    @Override
    public void onReceive(Context context, Intent intent) {

        String id = intent.getExtras().getString("AccountId");
        String name = intent.getExtras().getString("AccountName");
        boolean isNew = intent.getExtras().getBoolean("isNew");

        if (isNew) {
            Account accountInList = new Account(id, name, null, null, null,
                    null);
            adapter.add(accountInList);
        } else {

        }
    }
}; 
```

服务 ：

```
Intent intent = new Intent();
                                intent.setAction("com.android.updatelist");
                                intent.putExtra("AccountId",
                                        updatedAccount.getAccountId());
                                intent.putExtra("AccountName",
                                        updatedAccount.getName());
                                intent.putExtra("isNew", true);
                                sendBroadcast(intent); 
```

适配器 ：

```
public class AccountNameListAdapter extends ArrayAdapter<Account> {

private final Context context;
private final int layoutResourceId;
private final ArrayList<Account> data;
private final TableLayout table;
private final TextView tableName;
private final TextView tableIndustry;
private final TextView tablePhone;
private final TextView tableWebsite;
final AccountBDD accountBdd;

public AccountNameListAdapter(Context context, int layoutResourceId,
        ArrayList<Account> data) {
    super(context, layoutResourceId, data);
    this.layoutResourceId = layoutResourceId;
    this.context = context;
    this.data = data;
    table = (TableLayout) ((Activity) context)
            .findViewById(R.id.tableLayout);
    tableName = (TextView) ((Activity) context).findViewById(R.id.NameText);
    tableIndustry = (TextView) ((Activity) context)
            .findViewById(R.id.IndustryText);
    tablePhone = (TextView) ((Activity) context)
            .findViewById(R.id.PhoneText);
    tableWebsite = (TextView) ((Activity) context)
            .findViewById(R.id.WebsiteText);

    accountBdd = SQLiteApplication.getAccountBdd();

}

@Override
public View getView(final int position, View convertView, ViewGroup parent) {

    AccountHolder holder = null;

    if (convertView == null) {
        LayoutInflater inflater = ((Activity) context).getLayoutInflater();
        convertView = inflater.inflate(layoutResourceId, parent, false);

        holder = new AccountHolder();

        convertView.setClickable(true);
        convertView.setFocusable(true);

        holder.txtName = (TextView) convertView.findViewById(R.id.nom);
        holder.txtId = (TextView) convertView.findViewById(R.id.id);

        convertView.setTag(holder);

    } else {
        holder = (AccountHolder) convertView.getTag();
    }

    convertView.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            table.setVisibility(0);

            String id = data.get(position).getAccountId();
            Account displayAccount = accountBdd.getAccountWithAccountID(id);

            tableName.setText(displayAccount.getName());
            tableIndustry.setText(displayAccount.getIndustry());
            tablePhone.setText(displayAccount.getPhone());
            tableWebsite.setText(displayAccount.getWebsite());
        }

    });

    holder.txtName.setText(data.get(position).getName());
    holder.txtId.setText(data.get(position).getAccountId());

    ImageButton img = (ImageButton) convertView.findViewById(R.id.check);
    img.setTag(position);

    return convertView;
}

static class AccountHolder {
    TextView txtName;
    TextView txtId;
} 
```

}

请问我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:13:08.573

在不知道其位置的情况下，您无法删除任何项目。

一种不可行但有效的解决方案是：接收到广播后，重新创建所有内容。这意味着，无论哪个部分正在更新，刷新该部分并再次使用新值创建它。

例如：如果您的列表正在更新，请从列表中删除所有项目，然后添加所有新值，并`notifyDataSetChange`在适配器上调用方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:19:55.420

在将 account_id 作为输入的适配器中创建一个方法。它应该如下所示：

```
private void deleteData(int account_id) {
   for(int i=0; i<data.size(); i++) {
      //search for the id and delete it from the data
   }
   notifyDatasetChanged();
} 
```

从您收到的活动中`BroadcastReceiver`只需调用此方法即可。它比你想象的要快得多。

更新：`Account`是一个对象。删除不是那样工作的，因为地址存储器总是改变。

尝试在数据中找到确切对象的位置并尝试 data.remove(position)。像这样的东西，而不是`getAccountByID(int accountid)`实现这个：

```
private int getPositionFromID(int accountid) {
   for(int i=0; i<data.size(); i++) {
       if(data.get(i).getAccountID() == accountID)
           return i; //if you have a match
   }
   return -1; //error code, that is not found
} 
```

然后使用位置删除确切的点：

```
private void deleteData(int account_id) {
   int position = getPositionFromID(int accountid);
   if(position == -1) {
      //handle error
   } else {
      data.remove(position); 
      notifyDatasetChanged();
   }
} 
```

这个给你！现在你有了一个完整的复制粘贴示例！我已经做过很多次了，不需要搞砸`CursorAdapter`或类似的东西，纯硬编码的java。我很确定这确实有效，如果它在您的示例中不起作用，我会建议您调试并确保一切正常，因为我猜您的代码还有其他问题，而不是适配器没有填充.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:23:19.677

所以我是根据我的问题提出的，但你不会喜欢它。在我看来，最好的方法是实际使用 a`CursorAdapter`来`CursorLoader`刷新数据库中的内容。所以你基本上不必做这项工作。从网络获取信息并更新数据库后，您只需刷新适配器即可反映新信息。在您的情况下，您无法在`ListView`不知道其归属的情况下更改任何内容。但是用我刚才告诉你的方法，你`ListView`可以`setAdapter()`按住 ，`CursorAdapter`然后你可以刷新它。但这需要对代码进行一些修改。

# c# - 基于模型动态构建GUI

> ID：11632558
> 
> 赞同：1
> 
> 时间：2012-07-24T14:01:05.770
> 
> 标签：c#, sharepoint, controls

我有一个关于 GUI 应该显示的数据的动态组合的问题。是否有任何最佳实践或模式如何动态构建 GUI 并仍然保持关注点/分层策略的清晰分离？

这是我的商业案例：我想做一个工具来创建大量随机共享点列表项，即共享点列表。因此我想为该工具提供列表 URL。然后，该工具将查询该列表并提供一个文本框来为每个列表列输入一组随机值。由于列因列表而异，因此我无法构建静态 UI / 视图。获取列表信息后，我必须动态构建此视图。

我目前的想法是构建某种表示逻辑，它读取列表元数据，然后针对此元数据创建文本框控件。这可能发生在某种事件处理程序中。

在 MVC 的方向上思考，在我的情况下，我没有得到 MVC 中（常见）的静态视图。如果视图在其初始化例程中检查列表元数据，然后动态构建输入控件（文本框），然后将它们绑定/链接到相应的列表列，这会是一个好的设计吗？

感谢您的反馈和最好的问候帕特里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:08:49.267

听起来很像 Naked Objects 方法：

[http://en.wikipedia.org/wiki/Naked_objects](http://en.wikipedia.org/wiki/Naked_objects)

但是，您的数据层（包括数据库）需要设计得非常好，即需要与问题域相关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T09:45:12.360

试一试我的项目[FormFactory](http://formfactory.apphb.com/)。

# c# - 在 C# 中获取椭圆的更新位置

> ID：11632560
> 
> 赞同：1
> 
> 时间：2012-07-24T14:01:07.623
> 
> 标签：c#, wpf, kinect, ellipse

我目前正在开发一个用于跌倒检测的 Kinect 项目。我只对头部进行基本检测，因为这是我知道的唯一方法。无论如何，我需要获取椭圆鼠标指针的更新位置。我尝试使用 MouseMove 功能，但它似乎只更新一次。我需要它在移动时不断更新。

有没有办法做到这一点？

* * *

抱歉，如果这听起来含糊不清，但我使用 Kinect 的骨架功能来获取我的关节位置。从那里，我将大卫贝克汉姆的照片映射到头部。我要做的实际上是从像素中检测头部是否进入像素。

我现在的问题是，当我使用 MouseMove 功能时，头部的位置不会定期更新。我正在尝试找到解决方案，甚至更好，找到一种检测头部位置的新方法，因为坦率地说，我觉得我的方法有点愚蠢。

![前面板图片](../Images/57e0f365eae8127889a74ac8fa151150.png)

所以基本上这是前面板。我没有 kinect，所以我无法展示它的实际外观。

```
private void left_ankle_MouseMove(object sender, MouseEventArgs e)
    {
        Point lA = e.GetPosition(this);
        leftAnkleX = lA.X;
        leftAnkleY = lA.Y;
    }

    private void getReady()
    {
        if (null != leftAnkleX && null != leftAnkleY && null != headX && null != headY && null != rightAnkleX && null != rightAnkleY)
        {
             if ((headX > btmLeftX) && (headX <btmRightY) && (headX <topLeftY))
                ss_dis.Text = "Detected"; 

        }
    } 
```

这就是我试图抓住大卫贝克汉姆椭圆的方式，但效果不佳。

希望现在有足够的信息！

# c# - 在后面的代码中从 DataTable 设置 javascript 数组

> ID：11632561
> 
> 赞同：3
> 
> 时间：2012-07-24T14:01:10.070
> 
> 标签：c#, javascript, asp.net

我试图在中设置一个数组`Javascript`，然后从`DataTable`后面的代码中给它值，如下所示：

```
for (var i = 0; i < '<%=dt_questionVideo.Rows.Count - 1 %>'; i++) {
        videoQarray[i] = '<%=Convert.ToInt32(dt_questionVideo.Rows['+i+'][0]) %>';
    } 
```

我收到一个错误

> 字符文字中的字符过多

我该如何操作这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T14:08:05.573

你真的不能那样做。如果你需要一个这样的 javascript 数组，你将不得不在后面的代码中做这样的事情：

```
 int[] videoQarray = new int[dt_questionVideo.Rows.Count - 1];
        for (var i = 0; i < dt_questionVideo.Rows.Count - 1; i++) {
            videoQarray[i] = Convert.ToInt32(dt_questionVideo.Rows[i][0]);
        }

        string createArrayScript = string.Format("var videoQarray = [{0}];", string.Join(",", videoQarray));

        Page.ClientScript.RegisterStartupScript(this.GetType(), "registerVideoQArray", createArrayScript, true); 
```

# javascript - 平滑滚动不起作用，为什么？

> ID：11632562
> 
> 赞同：3
> 
> 时间：2012-07-24T14:01:15.830
> 
> 标签：javascript, html, css

问题是我有一个带有锚点的网页，我想平滑滚动到它。于是我上网查了一下，找到了这段代码。

```
//dezinerfolio
eval((function(){a="Scroller={speed:10,8dC.;d.while(dC.+C.}} J8N;d=5;&&M4M}d&&dM4dM}%4%} 0J8a,F4(F,fa@7a.4a.LP+F7Jend8e66.cancelBubble=true;6.Value=fa@;}&&(E(7J8di=Hner3||5.G3;hN.3;a=(Ed>ah-d>i7e@{-(h-d)7}e@{a=a+(d-a}To(0,aEa==a}=aJHit8KwHdow,A,A7,A82P;l=9;d=locatiP;D&&D.HdexOfL#)!=-1&&(l/+l=C)Kl,Gck,endEl.PGck=2l=this.hash.substr(1E9.name==l;i=setILL+(9)+),107}}}}}};Hit()",b=48;while(b>=0)a=a.replace(new RegExp("%23456789@ACDEFGHJKLMNP".charAt(b),"g"),("\042Scroller.entfunction(offsetParscrollwindow.returndocumattachEvntervala=.getElemsByTagName(a);if(offsetTop){for(i=0;i<a.length;i++.pathnamea+=Math.ceil((d-ae.stopPropagationTopa.addEvListenerbody)/speede.prevDefaultclearI(i)pageYOffsetend(this);Height .Elemev)}:a[i]lseload=dl.href);b,dcliin},((.=.=C||on".split(""))[b--]);return a})()) 
```

所以这适用于我所有的网站，所以我相信它适用于我的新网站，但它不起作用。谁能看到为什么不？？？

这是 HTML

```
<head>
<script src="smooth.pack.js" type="text/javascript"></script>
<script> Scroller.speed=7; </script>
</head> 
```

然后

```
<body>
<a href="#bottom" id="down1" class="down" style="display:block"></a> 
```

然后大约在页面的一半处。

```
<a name="bottom" id="bottom"></a>
</body> 
```

这是链接的 CSS。

```
#down1 {
position:absolute;
width:100%;
height:50%;
top:50%;
cursor: url(d.png), auto;
z-index:99;
} 
```

所以我知道这确实有效，因为我已经看到它在其他网站上有效。但不知道是什么问题？？？

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-25T04:20:01.110

我建议不要使用该脚本并使用 jQuery。这可以使用 jQuery 轻松完成。

```
<!DOCTYPE HTML>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title>Page Title</title>
</head>
<body>
  <a href="#bottom" id="down1" class="down" style="display:block"></a>
  ....
  <a name="bottom" id="bottom"></a>
  <!-- load jquery however you like I will load from Google CDN -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script>
    // Document ready shorthand statement
    $(function() {
      // Select link by id and add click event
      $('#down1').click(function() {

        // Animate Scroll to #bottom
        $('html,body').animate({
          scrollTop: $("#bottom").offset().top }, // Tell it to scroll to the top #bottom
          1000 // How long scroll will take in milliseconds
        );

        // Prevent default behavior of link
        return false;
      });
    });
  </script>
</body>
</html> 
```

编辑：

好的，发现您的代码有问题，这是您的 css。在你的CSS中你有

```
html, body { overflow-x: hidden; } 
```

将其更改为：

```
body { overflow-x: hidden; } 
```

还有一种更简单的方法来编写你的 jQuery，这样代码就更少了。

首先你需要稍微重构一下你的 HTML

在您的链接部分中，将链接的 href 更改为您希望它们链接到的 div 的 id，例如：

```
<a href="#Portfoilio" class="link" id="down1" class="down" style="display:block"></a> 
```

将更改为：

```
<a href="#bottom" id="down1" class="down link" style="display:block"></a> 
```

您还会看到我添加了第二类“链接”。这样我们就可以使用一个 jQuery 调用来定位每个对象。

并且您在底部的 jQuery 将更改为：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>
    // Document ready shorthand statement
    $(function() {
      $('.link').click(function() {
        var id = $(this).attr('href');
        $('html,body').animate({ scrollTop: $(id).offset().top }, 'slow');
        // Prevent default behavior of link
        return false;
      });
    });
</script> 
```

这是我如何更改 HTML 和 jQuery 的链接：http: [//pastebin.com/0LfyjNLx](http://pastebin.com/0LfyjNLx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-12T19:19:56.443

这是进行平滑滚动的一种超级简单的方法。使用 jQuery 和 jQuery.localScroll 插件。

下载最新的smoothscroll.js：[https ://github.com/flesler/jquery.localScroll/releases](https://github.com/flesler/jquery.localScroll/releases)

添加两个 javascript 引用：

```
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="javascript/smoothscroll.js"></script> 
```

然后确保将类“smoothScroll”添加到您的`<a>`链接中，如下所示：

```
<a href="#anchor1" class="smoothScroll">Jump to Page Location</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-16T20:48:00.373

您可以使用简单的功能，例如

```
 scrollTo(x,y){
    let x1=0
    let y1=window.scrollY
    let yDiff=y-y1
    if(yDiff>10 || yDiff<-10){
      window.scrollTo(x,y1+(yDiff/10))
     setTimeout(()=>{
       this.scrollTo(x,y,smooth)
     },10)
   }
 } 
```

# java - 如何分析内存是否正在释放而不是使用java文件并与数据库连接相关？

> ID：11632563
> 
> 赞同：-1
> 
> 时间：2012-07-24T14:01:16.967
> 
> 标签：java, performance, memory-management, memory-leaks

我在以产品为基础的公司工作。在某些模块中，我们的应用程序非常慢。因此，我们必须监视哪些 java 文件或面向数据库连接的文件正在占用内存。是否有任何工具可以识别哪些 java 文件完全在消耗这些内存？谁能帮我确定问题。提前致谢。我正在使用 IBM RSA 7.5.5 。是否有任何插件可以集成到这个 IDE 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:08:12.957

尝试使用 VisualVM，它是一个免费工具，可以帮助您直观地分析您的应用程序，并将其分解为每个类。它显示了新的类实例、不同的内存段使用（堆空间、永久空间等）以及标记垃圾收集操作。Java 不允许您像 C 那样手动“释放”对象，但是，一旦对象离开作用域，它最终会在垃圾收集器运行时被垃圾收集。

如果您发现最终会出现大量实例，而您并不期望它们会出现，那么您可能在管理范围时遇到问题，或者您可能会留下对您的对象的引用否则会期望是瞬态的。当没有对对象的引用和/或该对象超出范围时，就会发生垃圾收集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:06:41.607

Oracle 故障排除页面包括有关分析内存使用情况和查找内存泄漏的大部分内容：

*   [带有 HotSpot VM 的 Java SE 6 故障排除指南](http://www.oracle.com/technetwork/java/javase/index-137495.html)

这是关于这个主题的一个很好的SO问题：

*   [解决Java内存泄漏的一般策略？](https://stackoverflow.com/questions/1473510/general-strategy-to-resolve-java-memory-leak)

# git - 如何将我自己的 repo 分叉到一个新项目中？

> ID：11632566
> 
> 赞同：4
> 
> 时间：2012-07-24T14:01:20.553
> 
> 标签：git, github, svc

我正在开发一个 HTML5 游戏引擎。我使用 Git 作为 SV 和 GitHub 来实际托管项目。

我对设计做了一些实质性的改变（主要是切换到实体系统范式），我认为是时候换一个新引擎了。

我想以旧引擎为基础，因为我可以使用很多代码。

这样做的标准方法是什么？新引擎将有一个新名称，旧引擎将被视为“完成”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:08:32.783

如果您的意思是您想要一个带有新仓库的新项目，但与旧项目共享历史，那么简单的方法是

```
$ git clone https://github.com/your_name/old_project new_project
# make new, empty project on GitHub called new_project
$ cd new_project
$ git remote rename origin old_project
$ git remote add origin https://github.com/your_name/new_project
$ git push -u origin 
```

现在你有了一个新项目，但在你的本地克隆中，你仍然可以从旧项目中获取提交，以修复通用代码`git cherry-pick`等的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T14:04:25.050

你需要分支

```
git branch <your_new_branch>
git checkout <your_new_branch> 
```

切换回旧分支

```
git checkout master 
```

列出所有分支

```
git branch 
```

# caching - Sitecore 缓存和外部数据源

> ID：11632568
> 
> 赞同：0
> 
> 时间：2012-07-24T14:01:25.643
> 
> 标签：caching, lucene, sitecore, external

我正在一个网站上工作，其中右栏和菜单组件将专门使用外部数据源。外部源是基于 Lucene 的索引，它位于不同的服务器上。

我想在这些组件上实现 Sitecore 缓存，但我希望在索引中的组件有新数据可用时刷新缓存。新数据将非常频繁地可用。在某些情况下，我说的是秒而不是分钟或小时。在这种情况下如何实现 Sitecore 缓存？

我正在为这个网站使用 Sitecore 6.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:49:44.547

除了我上面提到的重复帖子之外，如果您的内容更新如此频繁（以秒为单位），那么如果每个缓存实例的命中次数很少，那么缓存开销甚至可能不值得。您最终将使用内存作为缓存并且几乎不使用它们。而是使用 Lucene.NET 为您的组件提供一个集合`SkinnyItem`（一个非常快速的操作），并`Item`在绑定到前端时将它们转换为最后时刻（例如 a`ItemDataBound`中的事件`Repeater`）

# sql - 尝试将 csv 导入以随机数 0 开头的 SQL Server

> ID：11632570
> 
> 赞同：0
> 
> 时间：2012-07-24T14:01:28.123
> 
> 标签：sql, sql-server, import, flat-file

基本上，我想跳过随机数的零。我认为，解决方案是在格式文件中创建一个以第一个非零值结尾的虚拟列。但是，在淘完网之后，我不知道该怎么做。

编辑：澄清每一行前面都有随机数0。

例如

```
000004412900000009982101201021042010
000000935000000009902005199322071993 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T06:15:16.357

```
ALTER Function [dbo].[fn_CSVToTable] (@CSVList Varchar(5000))
Returns @Table Table (ColumnData Varchar(50))
As
Begin
If right(@CSVList, 1) <> ','
Select @CSVList = @CSVList + ','

Declare @Pos    Smallint,
@OldPos Smallint
Select  @Pos    = 1,
@OldPos = 1

While   @Pos < Len(@CSVList)
Begin
Select  @Pos = CharIndex(',', @CSVList, @OldPos)
Insert into @Table
Select  LTrim(RTrim(SubString(@CSVList, @OldPos, @Pos - @OldPos))) Col001
Select  @OldPos = @Pos + 1
End
Return
End 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T16:03:16.270

I had to do something similar on a MLS import. Here is essentially what I did.

```
BULK INSERT TmpTable FROM [CSVPATH] 
WITH (FIELDTERMINATOR = ',' , ROWTERMINATOR = '\n') 
```

Then fix the data you need to fix (the leading zeros)

There a few ways you can do this, but I will list two.

1.  `UPDATE TmpTable Set TmpCol = CASE WHEN LEFT(TmpCol,1) = "0" THEN LTRIM(TmpCol, LEN(TmpCol) -1) ELSE TmpCol END`

    [2.](https://stackoverflow.com/questions/662383/better-techniques-for-trimming-leading-zeros-in-sql-server) `UPDATE TmpTable Set TmpCol = SUBSTRING(TmpCol, PATINDEX('%[^0]%', TmpCol + '.'), LEN(TmpCol))`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T04:09:01.273

尝试这个。

```
DECLARE @str varchar(100)='000004412900000009982101201021042010'
DECLARE @str1 varchar(100)='000000935000000009902005199322071993'

    SELECT @str,RIGHT(@str,LEN(@str)-(PATINDEX('%'+'[1-9]'+'%',@str)-1)),@str1,RIGHT(@str1,LEN(@str1)-(PATINDEX('%'+'[1-9]'+'%',@str1)-1)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T14:41:48.473

首先，我将它按原样导入到临时创建的列中的行中，然后创建一个用户定义的函数或基于这个集合

循环并删除了第一个 char 为“0”的字符

```
TempCol = CASE WHEN LEFT(TempCol,1) = "0" THEN LTRIM(TempCol, LEN(TempCol) -1)
          ESLE TempCol
END

LOOP WHILE @LEN changes

@LEN = SUM(LEN(TempCol))
SELECT @LEN 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T17:45:04.260

我假设 .csv 文件导入过程的第一步是将文件导入数据库。然后第二步就是清理数据了。

要在导入后删除零，您可以创建一个函数：

```
 create function [dbo].[RemoveLeadingZero](@strSrc as varchar(8000))
 returns varchar(8000)
 as
 begin
      declare  @strResult varchar(8000)
      set @strResult = ''
      begin
          set @strResult = Replace(Ltrim(Replace(@strSrc, '0', ' ')), ' ', '0')
      end
      return @strResult
 end
select dbo.RemoveLeadingZero('000004412900000009982101201021042010')

update myTable
set columnA = dbo.RemoveLeadingZero(columnA) 
```

# objective-c - iPhone 上的音频混合：需要建议

> ID：11632575
> 
> 赞同：3
> 
> 时间：2012-07-24T14:01:42.570
> 
> 标签：objective-c, ios, audioqueueservices, audioqueue

我正在使用 AudioQueue 服务在我的应用程序中播放音频。我需要一起播放几个音频文件。我现在所做的只是创建尽可能多的音频队列来播放文件。即我为两个音频文件创建两个音频队列并同时启动它们以获得音频混合效果。

所以基本上我想知道这是一种“优雅”的方式。

请注意，我知道音频单元服务及其 MixerHost 示例，请不要建议该选项，我需要专门使用音频队列服务进行声音混合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T11:12:15.167

```
- (void) setUpAndAddAudioAtPath:(NSURL*)assetURL toComposition:(AVMutableComposition *)composition {

    AVURLAsset *songAsset = [AVURLAsset URLAssetWithURL:assetURL options:nil];

    AVMutableCompositionTrack *track = [composition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid];
    AVAssetTrack *sourceAudioTrack = [[songAsset tracksWithMediaType:AVMediaTypeAudio] objectAtIndex:0];

    NSError *error = nil;
    BOOL ok = NO;

    CMTime startTime = CMTimeMakeWithSeconds(0, 1);
    CMTime trackDuration = songAsset.duration;
    CMTime longestTime = CMTimeMake(848896, 44100); //(19.24 seconds)
    CMTimeRange tRange = CMTimeRangeMake(startTime, trackDuration);

    //Set Volume
    AVMutableAudioMixInputParameters *trackMix = [AVMutableAudioMixInputParameters audioMixInputParametersWithTrack:track];
    [trackMix setVolume:0.8f atTime:startTime];
    [audioMixParams addObject:trackMix];

    //Insert audio into track
    ok = [track insertTimeRange:tRange ofTrack:sourceAudioTrack atTime:CMTimeMake(0, 44100) error:&error];
}

- (BOOL) exportAudio {

    if (defaultSoundPath == nil || recordingSoundPath == nil) {

        [actvityIdicatiorView stopAnimating];
        [actvityIdicatiorView setHidden:YES];

        UIAlertView *alertView=[[UIAlertView alloc]initWithTitle:@"Select Sound" message:@"Both Sound is selected" delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil];
        [alertView show];
        return NO;

    }

    AVMutableComposition *composition = [AVMutableComposition composition];
    if (audioMixParams) {
        [audioMixParams release];
        audioMixParams=nil;
    }
    audioMixParams = [[NSMutableArray alloc] initWithObjects:nil];

    //Add Audio Tracks to Composition

    NSString *sourceA= [[NSBundle mainBundle] pathForResource:@"Beach Soundscape" ofType:@"mp3"];

    //NSString *URLPath1 = pathToYourAudioFile1;

    NSURL *assetURL1 = [NSURL fileURLWithPath:sourceA];
    [self setUpAndAddAudioAtPath:assetURL1 toComposition:composition];

    NSString *sourceB = [[NSBundle mainBundle] pathForResource:@"DrumsMonoSTP" ofType:@"aif"];
    // NSString *URLPath2 = pathToYourAudioFile2;
    NSURL *assetURL2 = [NSURL fileURLWithPath:sourceB];
    [self setUpAndAddAudioAtPath:assetURL2 toComposition:composition];

    AVMutableAudioMix *audioMix = [AVMutableAudioMix audioMix];
    audioMix.inputParameters = [NSArray arrayWithArray:audioMixParams];

    //If you need to query what formats you can export to, here's a way to find out
    NSLog (@"compatible presets for songAsset: %@",
           [AVAssetExportSession exportPresetsCompatibleWithAsset:composition]);

    AVAssetExportSession *exporter = [[AVAssetExportSession alloc]
                                      initWithAsset: composition
                                      presetName: AVAssetExportPresetAppleM4A];

    exporter.audioMix = audioMix;
    exporter.outputFileType = @"com.apple.m4a-audio";

    //    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    //
    //    NSString *fileName = @"someFilename";

    //NSString *exportFile = [[paths objectAtIndex:0] stringByAppendingFormat: @"/%@.m4a", fileName];

    mixingSoundPath= [[self mixingSoundFolder] stringByAppendingFormat: @"/Mixing%@.m4a", [self dateString]];
    [mixingSoundPath retain];

    // set up export
    //myDeleteFile(exportFile);
    NSURL *exportURL = [NSURL fileURLWithPath:mixingSoundPath];
    exporter.outputURL = exportURL;

    static BOOL isComplete;

    // do the export
    [exporter exportAsynchronouslyWithCompletionHandler:^{

        int exportStatus = exporter.status;

        NSLog(@"exporter.......%i",exportStatus);

        switch (exportStatus) {

            case AVAssetExportSessionStatusFailed:
                //    NSError *exportError =exporter.error;
                isComplete=NO;
                NSLog (@"AVAssetExportSessionStatusFailed");

                NSLog (@"Error == %@", exporter.error);
                break;

            case AVAssetExportSessionStatusCompleted:
                [self mixingDidFinshing];

                isComplete=YES;
                break;
            case AVAssetExportSessionStatusUnknown:
                NSLog (@"AVAssetExportSessionStatusUnknown");
                isComplete=NO;

                break;
            case AVAssetExportSessionStatusExporting:
                isComplete=NO;

                NSLog (@"AVAssetExportSessionStatusExporting");

                break;
            case AVAssetExportSessionStatusCancelled:
                isComplete=NO;

                NSLog (@"AVAssetExportSessionStatusCancelled");

                break;
            case AVAssetExportSessionStatusWaiting:
                isComplete=NO;

                NSLog (@"AVAssetExportSessionStatusWaiting"); 

                break;
            default:  
                NSLog (@"didn't get export status"); 
                isComplete=NO;
                break;
        }

    }];

    return isComplete;

} 
```

# c# - .NET 3.5+ 是否对 DataRow.Item 属性使用类型推断？

> ID：11632577
> 
> 赞同：1
> 
> 时间：2012-07-24T14:01:46.407
> 
> 标签：c#, asp.net, ado.net, type-inference

我今天正在处理一些遗留代码，并注意到一些奇怪的东西。我们有一些旧的 ADO .NET 代码将一些数据从数据库读取到`DataTable`.

在某个时间点，以下代码

```
SubscriptionDT.Rows[0]["LastShownBenefits"].ToString().Substring(0, 10) 
```

回来

```
2001-01-01 
```

但是，现在它返回

```
1/1/2001 1 
```

如果我快速观察`SubscriptionDT.Rows[0]["LastShownBenefits"]`，它似乎能够推断出类型是`System.DateTime`. （此列是`DateTime`数据库中的一个）。但是，我有一种感觉，在我们将项目升级到 .NET 3.5 之前，这可能被认为是`System.Object`. 显然，调用`.ToString()`会在两者之间返回不同的结果......

我的问题是：

1）我对类型推断是否正确？我认为可能是这种情况，因为该`var`关键字是在 .NET 3.5 中引入的。

2) 是否有任何可用于此更改（或类似更改）的文档？我一直在搜索 MSDN 有一段时间了，但一直没有找到任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T14:03:32.713

不，你不对。原因是现在出于某种原因正在使用不同的语言环境。
这就是为什么您应该始终在调用中指定文化`ToString`以避免这种类型的问题。

需要明确的是：这与类型推断完全无关。该对象在 .NET 2.0 中是盒装的，在 .NET 3.5 中`DateTime`仍然是盒装的。`DateTime`

关键字严格来说是`var`编译时特性。`var`使用关键字的代码和明确指定变量类型的代码之间的结果 IL 没有区别，例如：

```
var date = DateTime.Now;
// results in exactly the same IL code as:
DateTime date = DateTime.Now; 
```

# mysql - 如何将 MySql 输出显示为 utf-8 而不是 latin1？

> ID：11632581
> 
> 赞同：0
> 
> 时间：2012-07-24T14:01:58.200
> 
> 标签：mysql, unicode, utf-8

我一直在寻找一段时间，并没有找到一个好的答案，但是......

有没有办法让我的选择查询以 utf-8 显示输出，而不是 mysql 默认输出中的任何内容？我 100% 肯定我的数据存储在 utf-8 中，但是当我进行选择时，我得到的输出是一堆问号。

我不想以任何方式更改任何内容，我只想让我的输出正确显示我的 utf-8 字符。这可以做到吗？或者这是终端的问题？我通过终端而不是任何 MySql gui 界面使用 MySql。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:22:03.603

查看这篇文章：[将 latin1 中的 MySQL 数据转换为 utf8 utf-8](http://www.oreillynet.com/onlamp/blog/2006/01/turning_mysql_data_in_latin1_t.html/) - 我知道那里有 php，但它可能会帮助您更接近答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:26:24.663

```
SELECT CONVERT(_latin1'output' USING utf8); 
```

# java - 模式匹配器 - 按指定长度拆分

> ID：11632582
> 
> 赞同：0
> 
> 时间：2012-07-24T14:02:00.447
> 
> 标签：java

我需要将我的字符串拆分成一些指定的长度（10 个字符）。

下面是我的代码：

```
Pattern p = Pattern.compile(".{0,10}");
Matcher m = p.matcher("012345678901234567890123456");
List<String> emailStr = new ArrayList<String>();
while(m.find())
{
   System.out.println(m.group());
} 
```

至于我的要求，我将获得最多 3 个字符串。我想将这个“n”个字符串分配给单独的变量。我对此没有任何想法。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:16:36.310

你可以使用它来得到你想要的：

```
public static String[] splitter(String str, int len) {
    String[] array = new String[(int) str.length() / len + 1];
    for (int i = 0; i < str.length() / len + 1; i++) {
        String s = "";
        for (int j = 0; j < len; j++) {
            int index = i * len + j;
            if (index < str.length())
                s += str.charAt(i * len + j);
            else
                break;
        }
        array[i] = s;
    }
    return array;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:21:59.547

基于[杰克给出的答案](https://stackoverflow.com/a/11632830/1468366)：

```
public List<String> splitter(String str, int len) {
  ArrayList<String> lst = new ArrayList<String>((str.length() - 1)/len + 1);
  for (int i = 0; i < str.length(); i += len)
    lst.add(str.substring(i, Math.min(str.length(), i + len)));
  return lst;
} 
```

不要为此使用模式匹配器。不要在不需要的地方使用正则表达式，在正则表达式不是基本概念的语言中。在[perl](/questions/tagged/perl "显示标记为“perl”的问题")中，您可以使用正则表达式做所有可以做的事情，否则不要。

# iphone - 从 iOS 应用程序中选择并发布到 Facebook 朋友的墙上

> ID：11632583
> 
> 赞同：0
> 
> 时间：2012-07-24T14:02:06.250
> 
> 标签：iphone, objective-c, ios, facebook, facebook-graph-api

我在应用程序中使用下面的 Facebook Hackbook 示例代码。**getFriendsCallAPIDialogFeed**方法说（在评论中）该方法“获取用户的朋友，允许他们选择一个并在他们的墙上发帖”

```
 /*
 * Helper method to first get the user's friends then
 * pick one friend and post on their wall.
 */
- (void)getFriendsCallAPIDialogFeed {
    // Call the friends API first, then set up for targeted Feed Dialog
    currentAPICall = kAPIFriendsForDialogFeed;
    [self apiGraphFriends];
} 
```

但是在行 **currentAPICall = kAPIFriendsForDialogFeed;** 它调用下面的请求方法，然后**调用 kAPIFriendsForDialogFeed**。

我遇到的问题是它随机选择用户的朋友。我需要用户能够选择他们选择的朋友。

谢谢你的帮助

```
- (void)request:(FBRequest *)request didLoad:(id)result {
    [self hideActivityIndicator];
    if ([result isKindOfClass:[NSArray class]] && ([result count] > 0)) {
        result = [result objectAtIndex:0];
    }
    switch (currentAPICall) {

        case kAPIFriendsForDialogFeed:
        {
            NSArray *resultData = [result objectForKey: @"data"];
            // Check that the user has friends
            if ([resultData count] > 0) {

                // Pick a random friend to post the feed to
                int randomNumber = arc4random() % [resultData count];
                [self apiDialogFeedFriend: 
                 [[resultData objectAtIndex: randomNumber] objectForKey: @"id"]];
            } else {
                [self showMessage:@"You do not have any friends to post to."];
            }
            break;
        } 
```

此代码填充了一个包含所有朋友的表格，您可以从中进行选择。选择只在他们的通知中发布消息/请求，而不是在他们的墙上——这正是我所需要的。

```
 case kAPIGetAppUsersFriendsUsing:
    {
        NSMutableArray *friendsWithApp = [[NSMutableArray alloc] initWithCapacity:1];
        // Many results
        if ([result isKindOfClass:[NSArray class]]) {
            [friendsWithApp addObjectsFromArray:result];
        } else if ([result isKindOfClass:[NSDecimalNumber class]]) {
            [friendsWithApp addObject: [result stringValue]];
        }

        if ([friendsWithApp count] > 0) {
            [self apiDialogRequestsSendToUsers:friendsWithApp];

        } else {
            [self showMessage:@"None of your friends are using Whatto."];
        }

        [friendsWithApp release];
        break;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:21:58.103

使用`resultData`填充表格，然后将发布代码移动到`didSelectRowAtIndexPath`.

```
- (void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [self apiDialogFeedFriend: 
        [[resultData objectAtIndex: indexPath.row] objectForKey: @"id"]];
} 
```

这个 SO 问题告诉您如何在朋友的墙上发帖：[Facebook API：在朋友墙上发帖](https://stackoverflow.com/questions/10773030/facebook-api-post-on-friend-wall?rq=1)

# c++ - 另一个 OpenCV / cvBlob 和架构问题

> ID：11632584
> 
> 赞同：0
> 
> 时间：2012-07-24T14:02:09.993
> 
> 标签：c++, macos, opencv

尽管之前已经有很多人问过这个问题，但这不是基本的安装问题（虽然答案可能很简单）。

好的，我正在并行安装两个 OpenCV（2.3.1 和最新的 2.4），但我主要使用 2.3.1。

所以，我之前（在同一台机器上）让 cvBlob 工作正常，但我开始重新安装。任何人，我已经成功构建了 OpenCV，并且我已经从 CvBlob 项目站点进行了更改，以将[OpenCV 库包含在 CMakeLists.txt 中](http://code.google.com/p/cvblob/wiki/HowToInstall)

为了确保 OpenCV 正常，我运行并重新运行 make 和 make install 以确保它位于 usr/local/include 目录中。使用 OpenCV 的测试应用程序工作正常，并且使用`file opencv_library.dylib`表明 opencv 库是 64 位的。

关于问题的症结，我`cmake .`从 cvblob 目录的根目录运行，一切都恢复正常。`make`然后`sudo make install`运行，我被告知一切顺利。同样，`file`表明 libcvblob 是一个 64 位库，尽管我没有使用它。

我去了一个同时使用 opencv 和 cvblob 的 c++ 程序，其中包含 opencv.hpp 和 cvblob.h 的绝对路径。

然后，这个：

`Undefined symbols for architecture x86_64: "_cvLabel", referenced from: _main in cchIl24a.o "_cvFilterByArea", referenced from: _main in cchIl24a.o ld: symbol(s) not found for architecture x86_64 collect2: ld returned 1 exit status`

除了明显的问题外，不确定出了什么问题，但它应该与 opencv 库相关联，我看不出哪里出了问题。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:11:54.980

所有这些关于 cvBlobLib 的问题和问题都来自过去，当时 OpenCV 没有 blob 跟踪器，有人写了它，然后放到了网上。由于某种原因，它变得非常流行。

但那是很多年前的事了。

现在您可以轻松使用与 opencv 捆绑在一起的[SampleBlobDetector 。](http://docs.opencv.org/modules/features2d/doc/common_interfaces_of_feature_detectors.html?highlight=blob#SimpleBlobDetector%20%3a%20public%20FeatureDetector)它更成熟，更强大，并且具有更多功能。而且您不必担心包含/链接问题。

# java - class.class 代表什么

> ID：11632585
> 
> 赞同：2
> 
> 时间：2012-07-24T14:02:20.713
> 
> 标签：java, class, synchronization

当我们同步一些静态方法锁是在 class.class 上获取的，那么 class.class 代表什么，通过谷歌搜索和阅读一些论坛，我知道了它的 java.lang.Class 实例，并且对于内存中的所有类都存在一个与它们关联的 java.lang.Class 的实例。是吗？？

除了它提供的所有主要功能在我的常规 Java 应用程序中有用的功能之外，人们可以使用它创建该类的对象并获得对它的锁定？

欢迎任何参考链接。谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:09:18.980

> ...它的实例，`java.lang.Class`对于内存中的所有类，都存在一个`java.lang.Class`与它们相关联的实例。

基本上，是的，尽管我认为每个类加载器只有一个副本，而不是全部。但是因为你通常只有一个类加载器......

`Class`实例将类作为一个整体表示，与其他类不同，就像类的实例与该类的所有其他实例不同一样。因此，由于静态方法特定于类（就像非静态方法特定于实例一样），所以在调用静态方法时对类实例进行同步是有意义的（如果方法需要同步）。这就是为什么如果您将`synchronized`关键字应用于整个方法，JLS 所说的会发生这种情况。

# maven - Maven 中的远程存储库如何工作？

> ID：11632586
> 
> 赞同：1
> 
> 时间：2012-07-24T14:02:20.440
> 
> 标签：maven

15分钟前刚开始学习Maven！还有一个愚蠢的问题：

如果我们想从远程仓库中提取，POM.XML 中是否有两个我们需要更改的地方？我的理解是我们应该做两件事：

1：在 REPOSITORIES 标签中定义远程仓库位置，然后，

2：在Dependencies标签中定义具体的依赖

我理解正确吗？这是一个好习惯吗？

我正在关注这些教程：[http ://www.mkyong.com/maven/how-do-download-from-remote-repository-maven/](http://www.mkyong.com/maven/how-do-download-from-remote-repository-maven/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T15:20:24.360

需要添加依赖项，但尽量避免添加存储库： http: [//www.sonatype.com/people/2009/02/why-putting-repositories-in-your-poms-is-a-bad-idea/](http://www.sonatype.com/people/2009/02/why-putting-repositories-in-your-poms-is-a-bad-idea/)

以下是关于 maven 及其周围基础设施的最佳书籍：http: [//www.sonatype.com/Support/Books](http://www.sonatype.com/Support/Books)

# r - 为什么 tapply 将子集作为 NA 而不是完全排除它们

> ID：11632587
> 
> 赞同：0
> 
> 时间：2012-07-24T14:02:30.180
> 
> 标签：r, subset, tapply

我有个问题。我想用平均值和误差线制作一个条形图，其中它被分组为两个因素。为了获得平均值和标准误差，我使用了函数 tapply。

但是，对于其中一个因素，我想降低一个级别。

所以我所做的是：

```
dataFE <- data[-which(plant=="FS"),] # this works fine, I get exactly the data set I want without the FS level of the factor plant 
```

然后为了得到平均误差和标准误差，我使用这个：

```
means <- with(dataFE, as.matrix(tapply(leaves, list(plant, Orchestia), mean), nrow=2)

e <- with(dataFE, as.matrix(tapply (leaves, list(plant, Orchestia), function(x) sd(x)/sqrt(length(x))), nrow=2)) 
```

并且发生了一些奇怪的事情，它不计算 FS，但是它把它放在一个带有 NA 的表中：

```
 row.names   no          yes
1   F           7.009022    5.307185

2   FS          NA          NA

3   S           2.837139    2.111054 
```

这是我不想要的，因为如果我在 barplot2（包 gplots）中使用它，那么我会得到一个 FS 的空栏，而那个根本不应该在那里。

任何使用都有解决方案或其他方法来获得漂亮的条形图:)。不管怎么说，还是要谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T14:49:06.357

如果没有您的数据样本，我只是猜测一下：

您的色谱柱设备是一个因素。虽然您已经删除了具有该值的行，但“级别”`FS`仍然存在。用`levels(data$plant)`来看。然后你可以用`droplevels`它来摆脱它。

```
dat <- data.frame(x=1:15, y=factor(letters[1:3]))

> levels(dat$y)
[1] "a" "b" "c"

dat <- dat[dat$y != 'a',]
> levels(dat$y)
[1] "a" "b" "c"
> 

> tapply(dat$x, dat$y, sum)
 a  b  c 
NA 40 45 
> 

> droplevels(dat$y)
 [1] b c b c b c b c b c
Levels: b c
> dat$y <- droplevels(dat$y)

> tapply(dat$x, dat$y, sum)
 b  c 
40 45 
> 
```

# database - SQL Anywhere 11 升级

> ID：11632589
> 
> 赞同：0
> 
> 时间：2012-07-24T14:02:39.340
> 
> 标签：database, sqlanywhere

我的系统中安装了 SQL Anywhere 11 的许可版本。当前版本是 11.0.1 48XX。我想将它升级到 SQL Anywhere 11 版本 11.0.1 56XX。我找不到我需要的修复包或升级安装程序。有人可以建议如何获得它/在哪里可以找到它？

问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T16:13:17.987

可以在 sybase.com 上找到对 SQL Anywhere 的所有升级。在顶部的支持菜单下，单击“EBF/维护”，然后单击“SQL Anywhere”。对于旧版本，您可能需要调整顶部的下拉菜单，默认为“过去 6 个月内”。

但是，最新版本的 SQL Anywhere 11.x 是 11.0.1.2825（截至 2012 年 7 月 24 日）。从来没有版本 11.0.1.48xx。

由于这不是编程问题，因此它并不适合 StackOverflow。您可能想尝试在[http://sqlanywhere-forum.sap.com/](http://sqlanywhere-forum.sap.com/)上询问 SQL Anywhere 问题。

*免责声明：我在 Sybase 的 SQL Anywhere 工程部门工作。*

# magento - Magento URL 问题

> ID：11632592
> 
> 赞同：-1
> 
> 时间：2012-07-24T14:02:44.087
> 
> 标签：magento

我对 magento 还很陌生，但我在将生产环境复制到沙盒环境方面一直在慢慢取得进展。

我目前遇到的问题是，当我访问我的网站时，我会得到一个长 URL，而不是一个经过优化的短 URL。我猜这是我需要更改的配置设置，我经历了并且必须将 index.php 添加到 url 字符串才能正常工作。

我想要做的是使用短网址，例如 /category/page.html 而不是 catalog/category/view/s/power-tools/id/261/

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T16:14:51.143

这就是我最终做的事情，它也删除了索引文件。部分问题是我在 /store/dir/ 中安装了 magento

1) 使用 URL 登录到管理部分

[http://domain.com/index.php/admin](http://domain.com/index.php/admin)

2）然后转到“系统>>配置>>Web>>搜索引擎优化”使用Web服务器重写：是

3）转到“系统>>配置>>Web>>安全”使用安全URL前端：是

****我用的是第二个****

4）然后在您的magento安装文件夹下创建.htaccess文件。

如果 magento 安装在文档根目录 (/home/username/public_html) 下，则将 follogig 规则添加到 .htaccess 文件中

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

如果magento安装在/shop或目录下，则将以下规则添加到“/home/username/public_html/shop/.htaccess”文件中。

```
<IfModule mod_rewrite.c >
RewriteEngine On
RewriteBase /shop/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /shop/index.php [L]
</IfModule > 
```

[http://www.bestdesigns.co.in/blog/remove-index-php-url-magento](http://www.bestdesigns.co.in/blog/remove-index-php-url-magento)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:10:50.990

这可能是因为您需要重新索引目录 URL 重写。转到系统-> 索引管理并重新索引。（虽然只是为了确定，但最好选择全部并重新索引！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T19:43:14.117

完成此操作后，我最终更改了 .htaccess Mage::run() 设置。我最终不得不更改 core_data_config 表中的一些基本 url 设置，以完成让一切正常工作。我还不得不设置 SEO 重写（系统配置 > 常规 > Web > 搜索引擎优化 > 使用 Web 服务器重写）= 否

我发现一旦 index.php 包含在路径中，那么我的网站就可以正常工作。

# c++ - 为什么 if 语句中未定义的参数不会导致段错误或其他错误？

> ID：11632594
> 
> 赞同：0
> 
> 时间：2012-07-24T14:02:46.313
> 
> 标签：c++, if-statement

例如：

```
array[2]={1,2};
myInt=5;

if (array[myInt-6]==2)
   cout << true << endl;
else
   cout << false << endl; 
```

if 语句中数组中的引用值明显越界。当我编译并运行它时，我得到了错误的输出，这是有道理的，因为条件不正确，但我想知道为什么没有输出错误。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T14:03:52.317

因为**未定义的行为是未定义的**。任何事情都可能发生，包括看起来有效。

编译器和运行时都不需要诊断。您必须自己处理边界检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T15:23:06.263

C++ 不是[内存安全语言](http://en.wikipedia.org/wiki/Type_system#Safely_and_unsafely_typed_systems)，因此避免此类问题是您的工作，而不是编译器或运行时的问题。

下一个问题。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-07-24T14:23:49.250

调用`array[-1]`不是错误，它几乎只是一个简写形式，`*(array - 1)`即在数组前一个 int 地址处的值。假设操作系统已将此地址分配给您的程序，您只会将一些随机数据位转换为 int。

因为存储在该位置的数据可能每次都相同，所以你会得到相同的行为——只是没有多大意义。如果你想强制这样的事情导致错误，使用标准模板库的容器之一可能是最简单的，例如[向量](http://www.cplusplus.com/reference/stl/vector/)

# c - 未定义参考？但是我已经实现了这个功能

> ID：11632602
> 
> 赞同：0
> 
> 时间：2012-07-24T14:03:18.653
> 
> 标签：c, gcc, compiler-construction, compiler-errors, linker-errors

**显示.h**

```
#ifndef PRO_DISPLAY_H
#define PRO_DISPLAY_H

/** Initializes the display **/
int pro_display_init(void);

#endif /* PRO_DISPLAY_H */ 
```

**显示.c**

```
#include "main.h"

static int height_ = 300;
static int width_ = 300;
static int bpp_ = 16;

static SDL_Surface* screen_ = NULL;

int pro_display_init(void)
{
    screen_ = SDL_SetVideoMode(width_, height_, bpp_, SDL_HWSURFACE|SDL_DOUBLEBUF);
    if (!screen_)
    {
        pro_sdl_error("Video initialization failed.");
        return 0;
    }

    return 1;
} 
```

**主文件**

```
#ifndef PRO_MAIN_H
#define PRO_MAIN_H

// standard headers
#include <stdlib.h>
#include <stdlib.h>

// conditional headers
#if defined(WIN32) || defined(_WIN32)
#include <windows.h>
#endif

// our own headers
#include "scripter.h"
#include "ttf_util.h"
#include "events.h"
#include "display.h"

// some macros
#define pro_error(...) fprintf(stderr, __VA_ARGS__)
#define pro_sdl_error(x) fprintf(stderr, "%s. \n=> %s\n", x, SDL_GetError())
#define pro_ttf_error(x) fprintf(stderr, "%s. \n=> %s\n", x, TTF_GetError())

#endif /* PRO_MAIN_H */ 
```

** main.c**

```
#include "main.h"

int main(int argc, char* argv[])
{
    pro_display_init();
    return 0;
} 
```

错误：

```
main.c|5|undefined reference to `pro_display_init()'| 
```

检查了构建过程。确保我在 gcc 的输入文件中添加了“display.c”。我无计可施。为什么会出错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:20:14.403

display.c 和 main.c 被编译成它们自己的“翻译单元”。发生的情况是，当尝试解析符号名称（即寻找`pro_display_init`）时，C 编译器认为它正在编译一个独立的 .c 单元。正确的方法是分别编译它们然后链接它们，例如

```
gcc -c display.c # creates display.o
gcc main.c display.o # compiles main.o and then link with display.o 
```

当然，您很快就会创建/重用一个 Makefile，它可以让您为所有这些定义规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:11:15.323

我认为，#include "main.h" 或 #include "display.h"（在 main.h 中）“找到”错误的包含文件。检查您的 include_path 变量。

# java - Java 与 Hibernate 数据库

> ID：11632608
> 
> 赞同：0
> 
> 时间：2012-07-24T14:03:40.420
> 
> 标签：java, database, hibernate

我有代码可以更新数据库中的列，如下所示：

```
logger.info("Entering Update Method");
        Query query =session.createQuery("update CardMaster cm set cm.otpAmount = :otpAmount" + " where cm.cardNumber = :cardnumber");
        double otpAmount= cardMaster.getOtpAmount();
        String cardNumber=cardMaster.getCardNumber();
        query.setParameter("otpAmount",otpAmount);
        query.setParameter("cardnumber",cardNumber);
        query.executeUpdate();
        logger.info("cardMasterUpdated successfully"); 
```

在这个我得到 otpamount ，cardnumber 并且它给出了executeupdate的结果为1但它没有反映在数据库中..我正在打开会话并在外面正确提交。

如果我使用`update()`休眠而不是使用它，它会正确发生。

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:52:17.697

您必须提交交易。

由于您不提交，因此其他进程看不到任何内容，例如您用于查看数据库的工具。

您可以通过 获取您的交易`session.getTransaction()`。但是，通常您会像这样手动启动事务：

```
Transaction tx = session.beginTransaction();
// Do your stuff
session.flush();
tx.commit() 
```

# database - Eclipse 在哪里（在哪个文件中）存储数据库驱动程序定义？

> ID：11632610
> 
> 赞同：0
> 
> 时间：2012-07-24T14:03:42.257
> 
> 标签：database, eclipse, configuration, driver

我正在尝试通过 SVN 控制多个 Eclipse 配置。为此，我需要知道 Eclipse 将他的配置存储在哪些文件中。我找不到的是驱动程序定义存储在哪里（我的意思是在 Preferences->Data Management->Connectivity->Driver Definitions 设置的东西）。有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T15:23:03.850

这些存储在`<Workspace>\.metadata\.plugins\org.eclipse.datatools.connectivity`.

# iphone - UITableViewCell 中的 UITextField 和模态视图中的验证

> ID：11632612
> 
> 赞同：0
> 
> 时间：2012-07-24T14:03:45.313
> 
> 标签：iphone, uitableview, delegates, uitextfield

我正在使用[此 stackoverflow 帖子](https://stackoverflow.com/questions/4375442/accessing-uitextfield-in-a-custom-uitableviewcell)中描述的方法从文本字段中检索值。我的问题是表格视图以模态方式呈现，并且我有一个`save`按钮可以验证输入并存储它。

问题是当用户单击一个（= 保存按钮，它关闭模式视图）时**没有**`textFieldDidEndEditing`调用该方法。**`UIBarButtonItem`**

 **在这种情况下（当用户想要保存输入时）我想验证它。但是这些值存储在`textFieldDidEndEditing`. 由于未调用此方法，因此我无法正确验证输入值。

有人对此有提示或解决方案吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T14:14:41.880

您应该为您的文本字段分配唯一的标签编号，然后在委托中跟踪当前处于活动状态（即使用 int iVar 存储活动文本字段标签值），`textFieldDidBeginEditing`当用户单击保存时，您应该得到最后一个文本字段的标签值，然后是文本值，因此您可以对其进行验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T10:00:27.880

好的，我们开始：

感谢@Lefteris 和他存储当前索引的想法。由于我无法将索引存储到`tag`属性中，我决定存储 active`indexPath`和另外的 active `textField`。（我知道，参考`UITextField`就足够了，但我需要它来做其他事情）

首先，我添加了这两个属性：

```
@property (nonatomic, strong) NSIndexPath *activeIndexPath;
@property (nonatomic, strong) UITextField *activeTextField; 
```

然后我实现了`textFieldDidBeginEditing:`and `textFieldDidEndEditing:`of `UITextFieldDelegate`.

```
- (void)textFieldDidBeginEditing:(UITextField *)textField
{
    NSIndexPath *indexPath = (NSIndexPath*)[self.tableView indexPathForCell:(UITableViewCell*)[[textField superview] superview]];

    self.activeTextField = textField;
    self.activeIndexPath = indexPath;
}

- (void)textFieldDidEndEditing:(UITextField *)textField 
{
    NSString *input = textField.text;    

    //assuming values from input textfield into corresponding properties
    [self assumeInput:input withIndexPath:self.activeIndexPath];

    self.activeTextField = nil;
    self.activeTextField = nil;
} 
```

在`textFieldDidEndEditing:`我通过使用方法将值存储到我的属性中（例如`self.firstName`、`self.lastName`等...）`[self assumeInput:input withIndexPath:self.activeIndexPath];`。

在我的`saveAction`-Method 中，我存储了当前活动的值`TextField`。

```
- (IBAction)saveButtonClicked:(UIBarButtonItem *)sender 
{    
    //assuming input from active field (didEndEditing _not_ called right now!)
    [self assumeInput:self.activeTextField.text withIndexPath:self.activeIndexPath];

    //test output
    NSLog(@"firstName: %@", self.firstName);
    NSLog(@"lastName: %@", self.lastName);
    NSLog(@"email: %@", self.email);
    ...
} 
```

……就是这样！

希望能帮助到你！感谢@Lefteris 的意见。

最好的，克里斯**

# asp.net - 从数据库中读取数据并显示在多选下拉列表中

> ID：11632613
> 
> 赞同：0
> 
> 时间：2012-07-24T14:03:48.430
> 
> 标签：asp.net

我在这里显示来自数据库的数据并显示在文本框上……还有一个使用 multidropdown.dll 的多选下拉菜单。我已成功在文本框中显示数据，但我应该使用什么方法在多下拉菜单中显示数据。我应该使用什么代码在多下拉菜单中显示数据，而不是......多选下拉菜单具有以下代码：

从数据库读取数据并在文本框和多下拉菜单中显示的代码：

```
<multidropdownLib:multidropdown id="multidropdown1"runnat="server"/>
 sqldatareader dr =cmd.executereader();
 while(dr.read())
 {
 textbox1.text=dr["column_name"].tostring();

  multidropdown1................=dr["column_name"].....
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:13:59.550

数据表 dt1 = 新数据表（）；

```
dt1.Columns.Add(new DataColumn("Name", typeof(System.String)));
dt1.Columns.Add(new DataColumn("ID", typeof(System.String)));

dt1.Rows.Add(new string[] { "Apple"     ,"1"  });
dt1.Rows.Add(new string[] { "Orange"    ,"2"  });
dt1.Rows.Add(new string[] { "Pear"      ,"3"  });
dt1.Rows.Add(new string[] { "Banana"    ,"4"  });
dt1.Rows.Add(new string[] { "Grapes"    ,"5"  });
dt1.Rows.Add(new string[] { "Strawberry","6"  });

MultiDropDown1.DataSource = dt1;
MultiDropdown1.DataTextField = "Name";
MultiDropdown1.DataValueField = "ID"; 
```

参考： http: [//www.codeproject.com/Articles/219977/MultiDropDown-A-multiple-selection-Dropdown-contro](http://www.codeproject.com/Articles/219977/MultiDropDown-A-multiple-selection-Dropdown-contro)

# git - 在 TeamCity 构建步骤中使用 git 命令

> ID：11632624
> 
> 赞同：45
> 
> 时间：2012-07-24T14:04:13.637
> 
> 标签：git, teamcity, teamcity-7.0

我的 TeamCity v7.0 构建项目之一依赖于使用当前开发分支和主分支之间的差异来确定需要运行的内容。我写了一个小脚本，它使用类似的东西：

```
git diff origin/master..origin/QA --name-only --diff-filter=AM | DoSomethingWithThoseFiles 
```

不幸的是，构建日志表明它`git diff`不起作用。当我进入该项目的 buildAgent/work 目录时，我看到没有`.git`文件夹，因此它无法执行所需的 git 操作。

我已经按照[TW-15873](http://youtrack.jetbrains.com/issue/TW-15873)`teamcity.git.use.local.mirrors=true`中的说明放入了`buildAgent.properties`文件，但这似乎没有任何帮助。

我有什么办法可以让我的构建步骤的脚本中两个分支之间的文件列表发生变化？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-07-27T15:43:52.130

尝试将 VCS 签出模式更改为“始终在代理上签出文件”，如此[处](http://confluence.jetbrains.com/display/TCD10/VCS+Checkout+Mode)所述。这应该使构建脚本可以访问 .git 文件夹。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-04T20:11:34.863

@Mike Two 的回答是正确的，需要将 VCS 根目录配置为在服务器上的 Agent 上自动使用 Checkout 模式，而不是在服务器上。TC 文档没有提到这个必需的设置默认隐藏为“高级”。所以这里有一张要寻找的图片。

![高级设置](../Images/3381a9b9dfdc7858c657a0a960d56538.png)

仅供参考，我的特定 VS2013 解决方案步骤错误来自 MSBuild，如下所示。我正在使用最新的 TeamCity Enterprise 9.0 EAP（内部版本 31963）。 `[PreBuildEvent] Exec [14:21:55][Exec] git rev-parse --short=9 HEAD > "C:\TeamCity\buildAgent\work\e5e910561e800525\MYPROJECT\bin\Debug\version.txt" [14:21:55][Exec] fatal: Not a git repository (or any of the parent directories): .git [14:21:55][Exec] C:\Program Files (x86)\MSBuild\12.0\bin\Microsoft.Common.CurrentVersion.targets(1131, 5): error MSB3073: The command "git rev-parse --short=9 HEAD > "C:\TeamCity\buildAgent\work\e5e910561e800525\Higgens\bin\Debug\version.txt"" exited with code 128. [14:21:55]`

//编辑; 我不知道如何将此添加到评论中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-07T22:28:13.673

设置`teamcity.git.use.shallow.clone=false`并且`teamcity.git.fetchAllHeads=true`可能是缺少的，至少在最新版本的 TC 上。

# android - 安卓getPixels

> ID：11632627
> 
> 赞同：1
> 
> 时间：2012-07-24T14:04:15.587
> 
> 标签：android, indexing, pixel, grayscale

我目前正在开发一个将边缘检测应用于预览帧区域的程序。我使用了 previewcallback 并获得了裁剪的位图，并使用以下方法转换为灰度。

```
int height1=120;
int width2=120;

            final Bitmap resizedBitmap = Bitmap.createBitmap(bmp, 260, 15, 
                    width2, height1);
            try {
                int bWidth = resizedBitmap.getWidth();
                int bHeight = resizedBitmap.getHeight();
                int[] pixels = new int[bWidth * bHeight];
                resizedBitmap.getPixels(pixels, 0, bWidth, 0, 0, bWidth, bHeight);
                for (int y = 0; y < bHeight; y++){
                    for (int x = 0; x < bWidth; x++){
                        int index = y * bWidth + x;
                        int R = (pixels[index] >> 16) & 0xff;     //bitwise shifting
                        int G = (pixels[index] >> 8) & 0xff;
                        int B = pixels[index] & 0xff;
                        int gray = (int) (.299 * R + .587 * G + .114 * B);
                    }
                } 
```

我对此很陌生，想知道 gray 是否是 120x120 像素的二维数组，或者 gray 的值是否只是被每个循环覆盖。

抱歉，如果这是非常基本的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:10:48.623

好吧，也许我错过了一些东西，但据我所知，它`gray`被覆盖了。你需要类似的东西

```
int[][] gray = new int[width][height];
// start loop 
```

在循环：

```
gray[x][y] = ...; 
```

# iis-6 - 带有 IIS 的 ServiceStack

> ID：11632631
> 
> 赞同：5
> 
> 时间：2012-07-24T14:04:25.880
> 
> 标签：iis-6, servicestack

我正在尝试发布我的网站，其中包含对 servicestack rest API 的引用。

该网站很好，但是当它尝试访问由 ServiceStack 生成的我的 REST 服务时，它返回 404 错误。

有谁知道如何在 IIS6 上发布 serviceStack REST 服务？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T16:19:08.137

根据[ServiceStack 的 Hello World 教程](http://www.servicestack.net/ServiceStack.Hello/#custompath)的说明：

> 注意：由于 IIS 6 的限制 - /custompath 必须以 .ashx 结尾，例如：path="servicestack.ashx"

名称可以是任何名称，例如，`api.ashx`如果您愿意，可以是任何名称。

[此答案](https://stackoverflow.com/questions/10005222/cant-get-servicestack-to-work-in-iis6-with-https/10005741#10005741)中解释了 ASP.NET/IIS 6 和其他可能的解决方案中处理程序映射的限制。

# iphone - 保存在 NSDocumentDirectory 中好吗？

> ID：11632636
> 
> 赞同：6
> 
> 时间：2012-07-24T14:04:40.430
> 
> 标签：iphone, ios, xcode

我的应用程序正在使用它`NSDocumentDirectory`来保存图像，我只是想问一下它是否安全地保存图像（最多 100 个）。我已经阅读了几个主题和问题以及有关它的答案，尽管我不知道该遵循哪个。有人说可以保存在那里。有人说我不应该`NSDocumentDirectory`用于保存，因为它将由`iCloud`. 那么我在哪里可以保存它，当用户退出应用程序然后再次运行应用程序时，图像应该仍然存在？我不太了解`tmp`目录或`cache`目录。但是，如果它是我应该使用的 2 之一，我如何在我的代码中使用它们：

```
 NSArray *paths = NSSearchPathForDirectoriesInDomains( NSDocumentDirectory,    NSUserDomainMask ,YES );
                NSString *documentsDir = [paths objectAtIndex:0];
                NSString *savedImagePath = [documentsDir stringByAppendingPathComponent:[NSString stringWithFormat:@"Images%d.png", i]];
                ALAssetRepresentation *rep = [[info objectAtIndex: i] defaultRepresentation];
                UIImage *image = [UIImage imageWithCGImage:[rep fullResolutionImage]];
                //----resize the images
                image = [self imageByScalingAndCroppingForSize:image toSize:CGSizeMake(256,256*image.size.height/image.size.width)];

                NSData *imageData = UIImagePNGRepresentation(image);
                [imageData writeToFile:savedImagePath atomically:YES]; 
```

十分感谢你的帮助。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-25T01:09:54.900

和目录由 iOS`tmp`定期`cache`清理。如果图像用于一般用途，请按照其他两个答案的建议使用相机胶卷。但是，如果这些图像仅适用于您的应用程序范围，您仍然可以安全地将它们存储在 Documents 目录中，您只需在保存后对每个文件添加“从 iCloud 备份中排除”功能调用，以防止 Apple拒绝您的应用程序使用过多的 iCloud 空间。当然有一个权衡，禁用这意味着如果用户删除应用程序或获取其他设备（等），无论如何都会丢失他们的照片，但这个警告比根本不让应用程序进入商店更可取。

要在文件上禁用 iCloud 备份，iOS 版本 > 5.0 有两种方法：

**更新！将两种方法合并为一个自动处理 iOS 版本的函数：**

```
#include <sys/xattr.h> // Needed import for setting file attributes

+(BOOL)addSkipBackupAttributeToItemAtURL:(NSURL *)fileURL {

    // First ensure the file actually exists
    if (![[NSFileManager defaultManager] fileExistsAtPath:[fileURL path]]) {
        NSLog(@"File %@ doesn't exist!",[fileURL path]);
        return NO;
    }

    // Determine the iOS version to choose correct skipBackup method
    NSString *currSysVer = [[UIDevice currentDevice] systemVersion];

    if ([currSysVer isEqualToString:@"5.0.1"]) {
        const char* filePath = [[fileURL path] fileSystemRepresentation];
        const char* attrName = "com.apple.MobileBackup";
        u_int8_t attrValue = 1;
        int result = setxattr(filePath, attrName, &attrValue, sizeof(attrValue), 0, 0);
        NSLog(@"Excluded '%@' from backup",fileURL);
        return result == 0;
    }
    else if (&NSURLIsExcludedFromBackupKey) {
        NSError *error = nil;
        BOOL result = [fileURL setResourceValue:[NSNumber numberWithBool:YES] forKey:NSURLIsExcludedFromBackupKey error:&error];
        if (result == NO) {
            NSLog(@"Error excluding '%@' from backup. Error: %@",fileURL, error);
            return NO;
        }
        else { // Succeeded
            NSLog(@"Excluded '%@' from backup",fileURL);
            return YES;
        }
    } else {
        // iOS version is below 5.0, no need to do anything
        return YES;
    }
} 
```

如果您的应用必须支持 5.0，那么不幸的是，您唯一的选择是将这些照片保存在 Caches 目录中，这意味着它们不会被备份（这不会因此导致 App Store 拒绝），但只要存储看门狗决定是时候清理缓存文件夹了，你会丢失这些照片。根本不是一个理想的实现，但这就是 5.0 中野兽的本质，苹果在事后添加了备份排除。

**编辑：**忘记回答问题的“如何保存到 tmp/cache 目录”部分。如果你决定走这条路：

*   保存到`tmp`：

    ```
    NSString *tempDir = NSTemporaryDirectory();
    NSString *savedImagePath = [tempDir stringByAppendingPathComponent:[NSString stringWithFormat:@"Images%d.png", i]]; 
    ```

（请注意，这在模拟器中似乎没有任何影响，但它在设备上按预期工作）

*   保存到`Cache`：

    ```
    NSString *cacheDir = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory,NSUserDomainMask,YES)lastObject];
    NSString *savedImagePath = [cacheDir stringByAppendingPathComponent:[NSString stringWithFormat:@"Images%d.png", i]]; 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T00:39:52.797

如果您希望用户能够在其他应用程序中使用图像或查看它们以及他们的照片，请按照 Mike D 的建议使用相册。如果文件是您在本地生成的仅用于您的应用程序的文件，那么您可能应该使用文档目录。您可以使用 info.plist 选项“应用程序支持 iTunes 文件共享”将文档目录暴露给 iTunes，这将允许用户通过 iTunes 添加或删除文件，但文件不会暴露给其他应用程序

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-25T02:48:30.697

您正在保存缩放的图像，因此它们实际上只对您的游戏有用。它们不会很大，也不会占用太多空间。您可以将它们保存在应用程序的库目录中，并避免整个 iCloud 的事情，因为听起来没有任何理由备份它们。此外，如果由于某些其他原因您打开了 iTunes 共享，保存库可以避免用户删除它们的可能性。

**更新：**保存到应用程序库目录的代码

```
- (void)saveSequences:(NSMutableDictionary*)sequences
{
    NSArray *path = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);
    NSString *libDirectory = [path objectAtIndex:0];
    NSString *settingsPath = [libDirectory stringByAppendingPathComponent:@"userSequences.plist"];

    NSLog(@"settingsPath %@", settingsPath);

    [sequences writeToFile:settingsPath atomically:YES];
} 
```

// 下面的代码获取到“文档”文件夹中命名目录的路径 - 如果它不存在，则创建它。如果您决定走那条路线，请调整它以使用库路径。

```
- (NSString *)getDirectoryBySequenceName:(NSString *)sequenceName 
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString * documentDirectory = [paths objectAtIndex:0];
    NSString * sequenceDirectory = [documentDirectory stringByAppendingPathComponent:sequenceName];

    NSError *error;
    BOOL success = [[NSFileManager defaultManager] createDirectoryAtPath:sequenceDirectory 
                                             withIntermediateDirectories:YES 
                                                              attributes:nil error:&error];   

    if (!success) {
        NSLog(@"Error creating data path: %@", [error localizedDescription]);
    }

    return sequenceDirectory;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T14:20:34.123

根据您的应用程序的用途，您可以将其保存到照片应用程序（`UIImageWriteToSavedPhotosAlbum(image, self, nil, nil)`我认为，[Apple 参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIKitFunctionReference/Reference/reference.html)）。保存在此处或文档目录（或任何子文件夹）中，将允许用户将这些图像备份到 iCloud 或 iTunes，如果用户也选择和/或如果他们已设置 iCloud。

由于您声明图像需要在启动之间保留，因此当应用程序从内存中删除时，临时或缓存目录会被清空，可能更快（操作系统决定）。

[有关 iOS 文件系统的更多信息](http://developer.apple.com/library/mac/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/FileSystemOverview/FileSystemOverview.html)。

# c++ - 如何同时处理多个并发实例？

> ID：11632637
> 
> 赞同：2
> 
> 时间：2012-07-24T14:04:42.540
> 
> 标签：c++, linux, qt, ubuntu, multiple-instances

这就是问题所在：我不喜欢我的程序的多个实例，这就是我禁用它们的原因。我的程序会打开一个特定的 mime 类型。在我的系统（Ubuntu 12.04）中，当我双击这些文件之一时，将执行以下操作：

```
/usr/bin/myprogram /path/to/double/clicked/file.myextension 
```

正如我所说，我不喜欢多个实例，因此，如果程序已经在运行并且用户选择打开其中一个文件，则会向已经存在的实例发送一条 DBus 消息，以便处理打开的文件。因此，如果有一个已经在运行的实例并且用户选择了 3 个文件来用我的程序打开并点击 [Enter] 按钮，系统将执行：

```
/usr/bin/myprogram /path/to/double/clicked/file1.myextension
/usr/bin/myprogram /path/to/double/clicked/file2.myextension
/usr/bin/myprogram /path/to/double/clicked/file3.myextension 
```

所有这些实例都检测到已经运行的实例并将打开的文件发送给它。完全没有问题，直到现在。

但是，如果没有一个已经在运行的实例并且用户选择用我的程序一起打开 3 个文件怎么办？系统将再次同时调用：

```
/usr/bin/myprogram /path/to/double/clicked/file1.myextension
/usr/bin/myprogram /path/to/double/clicked/file2.myextension
/usr/bin/myprogram /path/to/double/clicked/file3.myextension 
```

并且这些实例中的每一个都会意识到有一个已经在运行的实例，它会尝试向已经运行的实例发送一条 DBus 消息并退出。因此，所有 3 个进程都将执行相同的操作，并且不会运行任何内容。

我怎样才能避免这个问题？

PS：为了检测是否已经有正在运行的实例，我实现了以下代码：

```
bool already_runs(){
return !system("pidof myprogram | grep \" \" > /dev/null");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:40:13.247

我会使用一些共享内存来存储第一个进程的 pid。QSharedMemory类将在这里为您提供帮助[。](http://doc.qt.nokia.com/4.7-snapshot/qsharedmemory.html)

您的程序应该做的第一件事是尝试创建一个共享内存段（使用您自己制作的密钥）并将您的 pid 存储在其中。如果创建调用失败，那么您可以尝试附加到该段。如果成功，那么您可以从中读取原始进程的 pid。

编辑：另外，请记住在写入或读取共享内存之前使用 lock()，然后在完成后调用 unlock()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T15:05:40.113

在 DBus 中执行此操作的标准方法是在总线上获取应用程序的名称；一个实例将赢得比赛并成为运行实例。

但是，您应该能够使用 Qt 功能来做到这一点，这将更好地与您的应用程序的其余部分集成；请参阅[Qt：单实例应用程序保护的最佳实践](https://stackoverflow.com/questions/5006547/qt-best-practice-for-a-single-instance-app-protection)。

# c++ - 使用 Qt 工具栏和操作释放分配的内存

> ID：11632638
> 
> 赞同：0
> 
> 时间：2012-07-24T14:04:48.510
> 
> 标签：c++, qt, qtgui

我需要释放 Qt 工具栏和操作吗？

我以这种方式创建了它们

```
QToolBar *tb = new QToolBar(this);
tb->setWindowTitle(tr("Edit Actions"));
addToolBar(tb);

QAction *a;
a = actionUndo = new QAction(...ecc..); 
```

这些是自动释放还是我需要释放它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T14:22:48.977

简而言之，是的，它们作为 Qt 框架的一部分被自动释放，因为看起来您正确地传递了父级（即在您的情况下）。此外，在 QToolBar 的情况下，如果它还没有正确的父级，则调用 addToolBar 将导致它被“重新设置为父级”。

# json - 使用带有浏览器扩展的本地文件（kango 框架）

> ID：11632640
> 
> 赞同：1
> 
> 时间：2012-07-24T14:05:03.097
> 
> 标签：json, google-chrome-extension, cross-browser, firefox-addon, kango-framework

我正在使用“Kango Framework”（http://kangoextensions.com/）开发“浏览器扩展”

当我想链接一个 css 文件时，我必须使用外部源（href='http://mysite.com/folder/mysite.css），我应该如何更改 href 以使其成为插件文件夹中的源？（例如：href='mylocalpluginfolder/localfile.css'）

我试过'localfile.css'并将文件放在与JS文件相同的文件夹中。$("head").append("");

我应该如何更改 json 文件以使其工作？我应该将文件声明为“extended_scripts”还是“content_scripts”？

即使管理员很棒，我也很难找到对这个框架的支持！谢谢你的帮助。（请不要建议使用其他解决方案，因为我无法为 IE 编写插件，而 Kango 是我唯一的选择）。我没有找到任何符合我需要的示例，因为他们网站上唯一可用的示例是链接到外部内容（圣诞树）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T07:19:01.143

如果您想从内容脚本在页面中添加 CSS，您应该：

1.  获取 CSS 文件内容
2.  在页面中注入 CSS 代码

```
function addStyle(cssCode, id) {
    if (id && document.getElementById(id))
        return;
    var styleElement = document.createElement("style");
    styleElement.type = "text/css";
    if (id)
        styleElement.id = id;
    if (styleElement.styleSheet){
        styleElement.styleSheet.cssText = cssCode;
    }else{
        styleElement.appendChild(document.createTextNode(cssCode));
    }
    var father = null;
    var heads = document.getElementsByTagName("head");
    if (heads.length>0){
        father = heads[0];
    }else{
        if (typeof document.documentElement!='undefined'){
            father = document.documentElement
        }else{
            var bodies = document.getElementsByTagName("body");
            if (bodies.length>0){
                father = bodies[0];
            }
        }
    }
    if (father!=null)
        father.appendChild(styleElement);
}

var details = {
        url: 'styles.css',
        method: 'GET',
        async: true,
        contentType: 'text'
};
kango.xhr.send(details, function(data) {
        var content = data.response;
        kango.console.log(content);
        addStyle(content);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T13:03:55.107

我用另一种方式做。当我应该更改 css 时，我有一个包含指定网站样式的 JSON。使用 jQuery 的 CSS 在应用 CSS 方面具有优势，因为您可能知道 css() 应用内联 css 和内联 css 优先于默认网页文件中定义的类和 ID，如果是内联 CSS，它将覆盖它们。我觉得它很适合我的需要，你应该试试。使用 jQuery：

```
// i keep info in window so making it globally accessible
function SetCSS(){
    $.each(window.skinInfo.css, function(tagName, cssProps){
      $(tagName).css(cssProps);
    });
    return;
}

// json format
{
    "css":{
        "body":{"backgroundColor":"#f0f0f0"},
        "#main_feed .post":{"borderBottom":"1px solid #000000"}
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-30T05:33:47.997

根据 kango 框架结构，资源必须放在`common/res`目录中。

> 在 src/common 文件夹下创建“res”文件夹

将您的 css 文件添加到其中，然后使用

```
kango.io.getResourceUrl("res/style.css"); 
```

**您必须将此文件添加到 DOM 的 head 元素中**。

这是通过以下方式完成的。

```
// Common function to load local css into head element.
function addToHead (element) {
    'use strict';
    var head = document.getElementsByTagName('head')[0];
    if (head === undefined) {
        head = document.createElement('head');
        document.getElementsByTagName('html')[0].appendChild(head);
    }
    head.appendChild(element);
}

// Common function to create css link element dynamically.
function addCss(url) {
  var css_tag = document.createElement('link');
  css_tag.setAttribute('type', 'text/css');
  css_tag.setAttribute('rel', 'stylesheet');
  css_tag.setAttribute('href', url);
  addToHead(css_tag);
} 
```

然后你可以调用通用函数来添加你的本地 css 文件与 kango api

```
// Add css.
addCss(kango.io.getResourceUrl('res/style.css')); 
```

# php - 登录 url 会话重写

> ID：11632641
> 
> 赞同：0
> 
> 时间：2012-07-24T14:05:07.637
> 
> 标签：php, mysql, linux, cookies

我的登录会话有问题。基本上流程是这样的：

*   用户创建帐户并定义用户名；
*   用户使用 url 'http://[username].website.com' 登录
*   （用 php & mysql 编码，使用会话 cookie）

我的问题是：尝试从索引页面“www.website.com”直接登录时，我无法让我的用户登录到他的 URL [http://username.website.com](http://username.website.com)

/// 编辑 ///

假设我打开了网址“www.example.com”并在此网址中创建了一个会话变量。现在我想访问 url“test.example.com”中的会话变量。怎么做？欢迎任何解决方案

/// 编辑2 ///

在每个 php 文件的顶部，我使用了下面的代码，但我的会话变量被破坏了，我无法在另一个页面中访问会话变量。我还在“php.ini”文件上设置了 session.cookie_domain =“.website.com”。

```
ini_set('session.cookie_domain', '.website.com'); 
```

session_name("sessionid"); session_start();

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:13:55.347

正如评论中提到的 minaz，确保您在 www.website.com 上设置的 cookie 对“.website.com”上的域匹配有效。

如果您仍然不确定发生了什么，请尝试使用 --save-cookies、--load-cookies 和 --debug 使用 wget (http://www.gnu.org/software/wget/)。

# c# - .NET 事务中的 VB6 事务

> ID：11632642
> 
> 赞同：1
> 
> 时间：2012-07-24T14:05:12.480
> 
> 标签：c#, wcf, vb6

我有一个 ASP.NET WCF webservice，它从另一个服务获取数据并通过事务将其保存在数据库中。即所有的数据要么保存在数据库中（提交），要么什么都不保存（回滚）。

我需要在数据库中保存数据的过程中添加一个新阶段，该阶段涉及调用 VB6 dll 中的函数，该 dll 也使用事务连接到同一数据库。那可能吗？

这是用于调用 VB6 函数的 .NET 代码：

```
object oMissing = System.Reflection.Missing.Value;
ADODB.Recordset rsKR = new ADODB.Recordset();
rsKR.Fields.Append("F1", ADODB.DataTypeEnum.adVarChar, 10, ADODB.FieldAttributeEnum.adFldFixed, null);
rsKR.Fields.Append("F2", ADODB.DataTypeEnum.adVarChar, 10, ADODB.FieldAttributeEnum.adFldFixed, null);

rsKR.Open(oMissing, oMissing, ADODB.CursorTypeEnum.adOpenStatic,    ADODB.LockTypeEnum.adLockOptimistic, -1);
rsKR.AddNew(oMissing, oMissing);

rsKR.Fields["F1"].Value = someObject.Id;
rsKR.Fields["F2"].Value = someObject.Name;

rsKR.Update(oMissing, oMissing);
rsKR.MoveFirst();

VB6Project.ClassAPI objVBAPI = new VB6Project.ClassAPI();
objVBAPI.InsertIntoDBFunction(rsKR); 
```

提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:25:05.350

您需要做的是使用 .Net`TransactionScope`对象来包装您想要在发生异常时回滚的所有操作。您还需要确保您的 VB6 组件在 COM+ 服务中运行，并且启用了事务。

```
using (TransactionScope scope = new TransactionScope(TransactionScopeOption.Required,
        new TransactionOptions(), EnterpriseServicesInteropOption.Full))
{
    dotNetDatabaseOperations(); //call whatever .net code here
    comProxy.comMethod(); //call to your VB6 component with interop wrapper

    scope.Complete();
} //if any exception happens in either .net or COM,
  //entire transaction will be rolled back here 
```

# javascript - RequireJS 和遗留应用程序

> ID：11632646
> 
> 赞同：6
> 
> 时间：2012-07-24T14:05:29.277
> 
> 标签：javascript, backbone.js, requirejs, amd

我有一个遗留应用程序，我已将应用程序的部分重构为单独的骨干.marionette 应用程序。我没有时间或预算来重构整个事情，我希望我的代码更容易管理，这让我想到了 requirejs。

大多数文件都被缩小并合并在一起。

我可以将 requirejs 用于这种类型的混合解决方案，我可以在单独的主干模块上工作并且仍然可以访问现有的 javascript？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T20:04:50.497

作为一个刚刚开始在遗留的、使用 Backbone 的代码库上使用 Require.js 的人，我感受到了你的痛苦 :-) 我使用了多种方法，我将在此处列出。

假设您有 fileA.js 和 fileB.js，并且您想将 fileB.js 转换为使用 Require，而不更改 fileA.js：

*   滥用全球空间

    Require 不会强制您通过它导入每个变量；即使在 Require-ified 文件中，您仍然可以像使用非 Require-ified 代码一样访问全局变量。这意味着如果 fileA 在 global/window 命名空间中创建它的所有变量（如果您之前没有使用过 Require，这很有可能），无论 fileA 是否使用 Require，fileB 都可以访问它们。

    这最终成为我大部分遗留文件的解决方案；我只是让它们保持原样，并将所有新的 Require-ified 东西放在它们下面。这样，他们创建的每个全局都准备好并在 Require-ified 文件需要它们时等待。

    现在，如果 fileB 依赖于 fileA 这很好，但如果反过来呢？好吧，Require 也不会阻止你创建新的全局变量，这意味着 fileB 可以与 fileA 共享它想要的任何东西，只要它愿意将它放在全局空间中。

*   重复代码

    不要生气；我知道“DRY”编码实践的重要性。然而，对于几个文件，我最终做的是制作 Require-ified 副本。这最终是必要的，因为我使用 Handlebars 插件进行 Require 进行模板编译，所以如果我想要任何文件使用 Handlebars，我需要它是 Require-ified。

    为了解决正常的 un-DRY 问题，我在旧文件中添加了注释，有效地说“不要在这个文件中添加任何东西，Require-ified 版本是'真实'版本”。我的计划是随着时间的推移慢慢将更多的站点转换为 Require，直到我最终可以消除原始的、过时的文件。我们有一家小商店，所以它对我们有用，但在一家大公司，这可能行不通。

*   重构

    我知道，你说过你想避免这种情况，但有时一点重构可以让你物超所值。我个人几乎没有重构任何东西，但只有几个地方是一个小小的调整，大大简化了事情。

    总体而言，我认为重构是您在切换到 Require 后所做的事情（随着时间的推移，将您的非 Require-ified 代码“加入”）。

*   垫片

    Chchrist 说 shims 是解决“中途 Require”问题的好方法是正确的。但是，我个人根本没有使用它们，所以除了“看看他们”，我真的不能说太多，他们可能会有所帮助”。

# java - RabbitMQ 集群镜像队列行为

> ID：11632648
> 
> 赞同：0
> 
> 时间：2012-07-24T14:05:47.870
> 
> 标签：java, cluster-computing, rabbitmq, amqp

我正在使用 RabbitMQ 集群。我的队列处于“跨所有节点”和“持久”状态。但是，当我杀死主节点（例如，队列中有 1000 条消息）时，我的从节点继续工作，但在队列中我只能看到 0 条或少量消息。是虫子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T20:37:22.810

您是否将队列声明为 HA？

例如

Map args = new HashMap(); args.put("x-ha-policy", "all"); channel.queueDeclare("myqueue", false, false, false, args);

# ruby-on-rails - Ruby on Rails - 本地主机和 Heroku 查询

> ID：11632652
> 
> 赞同：0
> 
> 时间：2012-07-24T14:06:07.513
> 
> 标签：ruby-on-rails, postgresql, heroku

我正在使用 rails 3.2.3 和 ruby​​ 1.9.3。

我在部署到 heroku 时遇到问题。我试图实现的功能正在工作，但仅限于本地，我也在本地使用 Postgres。

查询是（我得到了更多这样的查询，但症状是一样的）：

```
pesquisa=pesquisa.joins('INNER JOIN facilities_hotels ON hotels.id=facilities_hotels.hotel_id')
         pesquisa=pesquisa.where('facilities_hotels.facility_id in (:fc_list)', :fc_list => params[:fc]).uniq
         pesquisa=pesquisa.group('hotels.id','hotel.name',<other fields>').having('count(facility_id) = :tamanho', :tamanho => params[:fc].size) 
```

在本地，这是返回所有正确的东西，但在 Heroku 上，它根本不返回任何数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T10:47:38.053

问题是数据不同。

在来自 git repo 的所有推送和拉取中，不知何故，HABTM 关联中连接表的 ID 与其主表不同。

# c# - 通过中继器添加 CSS 类

> ID：11632660
> 
> 赞同：0
> 
> 时间：2012-07-24T14:06:54.173
> 
> 标签：c#, asp.net, .net, repeater, sitecore

我有一个中继器，它使用 Sitecore (sc:Link) 动态生成选项卡链接，如下所示：

```
<asp:Repeater ID="rptTab" runat="server" OnItemDataBound="rptTab_ItemBound">
            <ItemTemplate>
                <li id= "liTabTest" runat = "server" class="tab-label">
                    <asp:HyperLink onclick = "javascript: TabClick(this)" runat="server" id="aLink">
                        <sc:Link ID="hlTabLink" Field="scTabLink" runat="server" ></sc:Link>
                    </asp:HyperLink>
                </li>
            </ItemTemplate>
       </asp:Repeater> 
```

我通过 JS 操作 CSS：

```
var loadURL;
$(document).ready(function () {
    init();
});

function init() {
     $("ul#Tab-labels li:first").addClass("TabbedPanelsTabSelected");
  };

  function TabClick(obj) {
      $("ul#Tab-labels li").removeClass("TabbedPanelsTabSelected");
      $(obj).addClass("TabbedPanelsTabSelected");

 }; 
```

不幸的是，这不起作用，因为每个选项卡都是一个单独的 .ASPX 页面，因此页面再次呈现，这就是为什么调用 JS 中的 Init() 并且每次都对第一项执行 CSS 的原因。

这是我背后的代码：

```
 protected void rptTab_ItemBound(Object sender, RepeaterItemEventArgs e)
    {
        if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
        {
            Item i = e.Item.DataItem as Item;
            Link hlTabLink = e.Item.FindControl("hlTabLink") as Link;
            hlTabLink.DataSource = i.Paths.FullPath;
            hlTabLink.Field = "Title";
            HyperLink aLink = e.Item.FindControl("aLink") as HyperLink;
            aLink.NavigateUrl = Sitecore.Links.LinkManager.GetItemUrl(i);
        }
    } 
```

我尝试通过代码隐藏添加 CSS，但它不起作用，因为我无法获取选项卡的索引（正在选择哪个选项卡）。任何解决方案将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T18:48:12.783

不要为在代码隐藏中更好（且更容易）完成的任务运行 javascript。只需为 Sitecore.Context.Item 与选项卡名称匹配的中继器项目设置活动类。ItemDataBound 中的伪代码：

```
if(i == Sitecore.Context.Item)
{
    HtmlGenericControl li = e.Item.FindControl("liTabTest");
    li.Attributes.Add("class","TabPanelTabbedSelected");
} 
```

不确定 HtmlGenericControl 在这里是否正确，或者它是否具有 CssClass 属性，但我希望您能理解。如果服务器端没有 li 的直接表示，您还可以绑定字符串文字或使用 Literal 控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T22:14:50.150

我的问题的答案是：中继器就像一个数组。所以我可以像这样得到转发器的第一个和最后一个元素：

```
string currClass =  hc.Attributes["class"].ToString();
string count = e.Item.Controls.Count.ToString();
        if (e.Item.ItemIndex == 0)
                    {
                        currClass += " TabbedPanelsTabSelected";
                    }
     else if (e.Item.ItemIndex.ToString() == count)
                    {
                        currClass += " last";
                    } 
```

通过这种方式，我可以通过Repeater将css添加到我的第一个元素和最后一个元素。

# sql - SQL 开发人员快捷方式

> ID：11632661
> 
> 赞同：2
> 
> 时间：2012-07-24T14:06:55.953
> 
> 标签：sql, oracle10g, oracle-sqldeveloper

我正在使用 SQL Developer 连接到 Oracle 数据库。

我希望能够通过命令窗口查看表的约束。通常我必须浏览表格树，然后打开表格详细信息。是否有快捷方式允许我通过编写命令来访问约束（特别是 FK 约束）？理想情况下，我想要类似的东西

```
desc table_name 
```

其中 desc 描述了该表。我知道 desc 是基于 SQL 的，但是我可以在 SQL 开发人员中使用任何命令吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T18:42:48.253

如果您可以在连接下的表格浏览器中浏览表格。打开它。您可以找到一个约束选项卡，您可以在其中找到有关表上的约束的信息。相反，您可以在命令窗口（工作表）中单击表名，按下`Shift +F4`将提供相同信息的快捷方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T14:26:17.877

这里问了一个类似的问题：

[http://p2p.wrox.com/oracle/30730-sp_help-equivalent-oracle.html](http://p2p.wrox.com/oracle/30730-sp_help-equivalent-oracle.html)

有人建议：

`select * from user_constraints where table_name=[yourtable]`

还有其他建议...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-10T14:00:55.427

以下 select 命令将显示 Oracle 中的表详细信息

```
Select * from user_tables 
where table_name='COUNTRIES' 
```

在 sql> 提示符下查看 Oracle 中表的描述的另一种解决方案

```
SQL>Description Countries 
```

或者

```
SQL>Desc Countries 
```

这将显示列名和数据类型以及约束。

# elisp - （基础）Elisp编程：Emacs中Cut函数的特殊钩子

> ID：11632662
> 
> 赞同：2
> 
> 时间：2012-07-24T14:06:58.590
> 
> 标签：elisp

我有一个文本文件，其中包含相关内容/段落。假设我从文本中剪切/杀死段落 A。我想编写一个在这种情况下调用的函数，因此相关的段落——比如说 B——也被删除了。一个很好的例子是其中包含引用/参考的文档。- 即，每当您删除该文本时，引用也会被删除 - 就像 MS Office 所做的那样。理论上我认为：

1) 我需要一个用于 Cut 的钩子 - 到目前为止我找不到合适的钩子 2) 可能带有正则表达式的搜索功能 - 查找相关文本 3) 删除该文本

你能建议我如何进行吗？每个步骤等的提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T15:06:35.323

为这种情况编写函数很容易：

```
(defun when-one-kill-one-and-three ()
  "If a buffer has a string \"one\", it deletes it.
If in this buffer exists also a string \"three\", it will be killed afterwards. "
  (interactive "*")
  (save-excursion
    (save-restriction
      (widen)
      (goto-char (point-min))
      (while (search-forward "one" nil t 1)
        (kill-region (match-beginning 0) (match-end 0))
        (when (search-forward "three")
          (kill-region (match-beginning 0) (match-end 0))))))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T14:16:51.190

1）我认为 Cut 没有钩子，但你可以建议 Cuting（defadvice ..）

2）您应该以某种方式标记您的文本并通过搜索找到它（输入一个数字以便您搜索）..

3）要删除文本，您可以使用 kill-region 我想

# vim - Vim命令仅在较长数字字符串中的光标位置增加数字数字？

> ID：11632666
> 
> 赞同：8
> 
> 时间：2012-07-24T14:07:07.340
> 
> 标签：vim

我有几个实例想要执行以下操作

在文件中：

```
1234 
```

将光标放在第一个数字上，我想使用 Ctrl-A 来增加数字，以便我得到

```
2234 
```

代替

```
1235 
```

是否有内在的 vim 命令来执行此操作？

否则，我应该设置一个快速脚本：

1.  带前导和尾随空格的环绕数字
2.  Ctrl-A 递增
3.  删除前导和尾随空格

像这样，然后映射到一个键？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T14:10:20.943

与大多数 vim 命令一样，增量函数采用前导数字。 `1000 ctrl+a`会`2234`如你所愿返回。如果您的所有号码都是 4 位数字，那么这将起作用。或者您可以使用`r2`which 将光标下的当前字符替换为 a `2`，但这可能过于具体。

如果你需要你的脚本，你可以录制一个宏。

`qaa[space][esc]h[ctrl+a]lx`

分解：

`qa`- 开始录制`q`宏并保存注册`a`

`a[space][esc]`- 在数字后添加一个空格

`h`- 移回号码

`ctrl+a`- 添加一个

`lx`向右移动并删除空间。

您不需要添加前导空格，因为正如您注意到的那样，该`ctrl+a`函数作用于整个数字，并且总是加 1。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T14:24:28.737

你可以这样做`s<C-r>=<C-r>"+1<Enter>`。

然后，您可以将其映射到其他东西，例如`nnoremap g<C-a> s<C-r>=<C-r>"+1<cr>`（您需要使用在此法线贴图`Ctrl-v``Ctrl-r`中插入s）。`<C-r>`

## 一步步：

`s` - 删除光标下的字符并开始插入

`<C-r>=`- 开始表达式评估。

`<C-r>"`- 将未命名寄存器的内容放入

> 有关这些的更多信息，请参见 :help i_CTRL-r。

`+1<Enter>`- 将值加 1 并完成命令。

# web-services - JAXB 类：REST 的重用

> ID：11632668
> 
> 赞同：2
> 
> 时间：2012-07-24T14:07:14.073
> 
> 标签：web-services, spring, rest, soap, jaxb

**技术栈：** Java 1.6、JPA (Hibernate 3)、Spring 3、Oracle 11g

你好，

我们目前正在重构我们的代码，以从基于 SOAP 的 Web 服务转移到 REST。我有很多 XSD，这些用于基于 SOAP 的 WS。并且使用这些模式文件生成了大量的 JAXB 类。

我的问题是我是否可以将相同的 JAXB 类用于 REST（输入和输出）。我没有使用 REST 的经验。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:16:28.383

它比你想象的要好。只需获取您之前用于 SOAP 端点的 JAXB 对象并从控制器返回它们：

```
public @ResponseBody JAXBElement<JaxbResponseType> 
controllerMethod(@RequestPayload JAXBElement<JaxbRequestType> request) {
    //...
} 
```

Spring 看到 JAXB 注释，会自动将它们编组为 XML 和 JSON。这应该是一个很好的起点，更不用说您的 REST 服务将具有与 SOAP 类似的结构。

# mysql - 巨大的回报集mysql连接多个表一对多关系

> ID：11632673
> 
> 赞同：0
> 
> 时间：2012-07-24T14:07:28.817
> 
> 标签：mysql, parsing, join

好的，这里的问题是，加入表是否值得为 mysql 设置超过两个表的巨大回报？（对于两个表是可能的，但更多？）情况如下：

```
table : main[
idmain (pk)
someotherid (key)
/*some other fields*/
]
table : main_sub[
idmainsub (pk)
idmain (key)
/*some other fields*/
]
table : main_sub2[
idmainsub2 (pk)
idmain (key)
/*some other fields*/
]
table : main_sub3[
idmainsub3 (pk)
idmain (key)
/*some other fields*/
] 
```

所以所有三个 main_sub 表都有一个（主）对多（subs_tables）的关系，这意味着 main 中的一行在其他表上具有多行。这是问题：

```
SELECT * FROM `main`
INNER JOIN `main_sub` ON `main`.`idmain`=`main_sub`.`idmain` 
INNER JOIN `main_sub2` ON `main`.`idmain`=`main_sub2`.`idmain`
INNER JOIN `main_sub3` ON `main`.`idmain`=`main_sub3`.`idmain`
WHERE `main`.`someotherid`=1
vs.
SELECT * FROM `main` WHERE `main`.`someotherid`=1;
and then 
SELECT * FROM `main_sub` WHERE `main_sub`.`idmain`=(idmainfromfirstquery);
SELECT * FROM `main_sub2` WHERE `main_sub2`.`idmain`=(idmainfromfirstquery);
SELECT * FROM `main_sub3` WHERE `main_sub3`.`idmain`=(idmainfromfirstquery); 
```

那么，与 4 个查询相比，连接是否值得巨大的结果集和解析？即使是微型表，所有子表都包含 5 个到主表的链接，结果集的大小已经失控。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:12:10.507

一个查询会更快，而不是循环：

```
SELECT * FROM `main`
INNER JOIN `main_sub` ON `main`.`idmain`=`main_sub`.`idmain` 
INNER JOIN `main_sub2` ON `main`.`idmain`=`main_sub2`.`idmain`
INNER JOIN `main_sub3` ON `main`.`idmain`=`main_sub3`.`idmain`
WHERE `main`.`someotherid`=1 
```

# ruby - 在 rake 任务调用中省略参数

> ID：11632675
> 
> 赞同：0
> 
> 时间：2012-07-24T14:07:36.110
> 
> 标签：ruby, rake

假设我有一个 rake 任务

```
task :aa, [:pp1, :pp2, :pp3] do |t, args|
  args.with_defaults(:pp2 => "fff")
  puts args.pp1
  puts args.pp2
  puts args.pp3
end 
```

我如何通过仅获取第一个和第三个参数，从默认值中获取第二个参数？“rake aa[1,2,3]”调用中方括号中的对象是什么类型的对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:36:52.987

`aa2`您可以使用所需的参数（和序列）定义一个附加任务（在我的示例中）。如果它们具有相同的名称，则参数将转发到先决条件。

```
require 'rake'

task :aa, [:pp1, :pp2, :pp3] do |t, args|
  args.with_defaults(:pp2 => "fff")
  puts args.pp1
  puts args.pp2
  puts args.pp3
end

task :aa2, [:pp1, :pp3] => :aa 
```

调用它：

```
rake aa2[1,3] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T22:02:30.167

所以我最终使用旧的 rake 语法来传递参数

```
rake aa pp1=1 pp3=vvv 
```

因此，pp1 和 pp3 可用于 ENV。然后我替换 args 中的默认值，如果我找到一个同名的参数，它是通过 CLI 传递的。

```
args.to_hash.each_key { |k| args.to_hash[k] = ENV[k.to_s] if ENV.has_key?(k.to_s) } 
```

之后，我可以获得任何具有良好 args.param 语法的参数。

# android - 检查所有 EditText 是否为空

> ID：11632678
> 
> 赞同：8
> 
> 时间：2012-07-24T14:07:43.900
> 
> 标签：android

我在 xml 中有 6 个 EditText 字段。单击按钮时，我需要验证所有 EditText 是否都有值或为空。目前我正在逐个检查每个 EditText .. 我怎样才能一次检查所有内容。

编码

```
private Button BtnSave;
 EditText ev_last_name,ev_first_name,ev_email,ev_password,ev_confirm_password,ev_phone;
 String last_name,first_name,email,password,confirm_password,phone;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.signup);
    BtnSave=(Button) findViewById(R.id.BtnSave);
    ev_last_name=(EditText)findViewById(R.id.edit_lname);
    ev_first_name=(EditText)findViewById(R.id.edit_fname);
    ev_email=(EditText)findViewById(R.id.edit_email);
    ev_password=(EditText)findViewById(R.id.edit_passwd);
    ev_confirm_password=(EditText)findViewById(R.id.edit_cpasswd);
    ev_phone=(EditText)findViewById(R.id.edit_phone);

    BtnSave.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
             last_name=ev_last_name.getText().toString();
             first_name=ev_first_name.getText().toString();
             email=ev_email.getText().toString();
             password=ev_password.getText().toString();
             confirm_password=ev_confirm_password.getText().toString();
             phone=ev_phone.getText().toString();

             if ((ev_last_name.getText().toString().length() <= 0))
             {
                 System.out.println(" The EditText is empty");
                 //I will use the toast later
             }

        }
    });

} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-24T14:16:04.400

使用“for”循环。

```
private boolean validate(EditText[] fields){
    for(int i = 0; i < fields.length; i++){
        EditText currentField = fields[i];
        if(currentField.getText().toString().length() <= 0){
            return false;
        }
    }
    return true;
} 
```

并使用这样的方法：

```
boolean fieldsOK = validate(new EditText[] { ev_last_name, ev_first_name, ev_email }) 
```

如果所有字段都不为空，将返回 true。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T14:17:39.297

```
private boolean isEmptyField (EditText editText){
    boolean result = editText.getText().toString().length() <= 0;
    if (result)
        Toast.makeText(context, "Fill all fielsd!", Toast.LENGTH_SHORT).show();
    return result;
}

 BtnSave.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            if (isEmptyField(ev_last_name)) return; 
            if (isEmptyField(ev_first_name)) return;

            // your logic here;
            ...

        }
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-10T10:19:32.603

```
EditText resultInput = (EditText)findViewById(R.id.result);

if(resultInput.getText().length() > 0)
// Edit Text is Empty
else
// Edit Text is Empty 
```

# c++ - 如何将带有数字的文本文件转换为二进制文件？

> ID：11632679
> 
> 赞同：0
> 
> 时间：2012-07-24T14:07:43.563
> 
> 标签：c++, windows, binary, iostream, fstream

所以我制作了一个使用 ifstream 打开文本文件的程序。现在我想做它，所以它以二进制输出这个文件。我尝试过 ofstream 并使用 .write() 但是当我这样做时程序崩溃了。正如我在网上看到的那样，我在使用 .write() 时正确设置了它，但我还没有看到有人用我正在使用的东西来做到这一点。有人对此有解决方案吗？另外，我不知道为什么“InputFile”和“OutputFile”都像这样突出显示为蓝色。

```
#include <iostream>
#include <fstream>
#include <string>
#include <bitset>
#include <stdio.h>
#include <stdlib.h>

using namespace std;

int main(int argc, char* argv[])
{
    if (argc < 2)
    {
        cout << "Error 1";
        return 0;
    }
    else
    {
        int WIDTH, HEIGHT;
        ifstream InputFile;
        InputFile.open(argv[1], ios::in);
        ofstream OutputFile;
        OutputFile.open("OUTPUT.raw", ios::binary | ios::app);
        cout << "Enter Width" << endl;
        WIDTH = cin.get();
        HEIGHT = WIDTH;
        for (int x = 0; x < WIDTH; x++)
        {
            for (int y = 0; y < HEIGHT; y++)
            {
                OutputFile.write((char*)InputFile.get(), sizeof(InputFile));
            }
        }
    }
    //cout << bitset<8>(txt[i]);
    return 0;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T14:39:31.487

```
OutputFile.write((char*)InputFile.get(), sizeof(InputFile)); 
```

首先，`istream::get()`从流中提取一个字符并返回其转换为整数的值。结果是一个临时的，您将其转换为指向 char 的指针！它可以编译，因为 C 风格的转换基本上告诉编译器“嘘，我知道我在做什么！”，但它肯定会在运行时做一些奇怪的事情。您需要获取存储要写入的值的某个对象的地址，然后转换该地址。

第二件事，`sizeof(InputFile)`返回`ifstream`管理文件流的类的大小。它与流缓冲区中有多少数据没有任何关系。

如果您以文本模式打开流，则从中提取数据的正确方法是使用提取运算符 ( `>>`)。然后很简单：

```
std::ifstream in_file("numbers.txt");
std::ofstream out_file("numbers.bin", std::ios::binary);

int i;

while (in_file >> i)
    out_file.write(reinterpret_cast<char*>(&i), sizeof(int)); 
```

上面的代码片段将与这样的输入文本文件一起使用：`-4 21 1990 5425342 -3432 0 100`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:14:29.740

您必须解析文本文件以获取文件中`int`的每个字符串，然后创建一个新文件并使用`fputc()`或`fwrite()`函数写入二进制数据。

# java - 使用 Hibernate 查找具有 100 万条记录的表

> ID：11632681
> 
> 赞同：0
> 
> 时间：2012-07-24T14:07:57.707
> 
> 标签：java, database, hibernate, lookup

我的数据库表（geo ip 查找）有 7 列，其中 2 列构成 <composite-id>。现在，当我使用前 2 个列查找值时，我需要**12-14 秒**才能获取记录..

我的 DAO 代码如下所示：

```
String queryString = "from Igeo igeo where igeo.ip_from <= " + ip
            + "and igeo.ip_to >= " + ip;

    Query q = session.createQuery(queryString);
    List<Igeo> igeoList = q.list();

    if(igeoList.size() > 0){
        Igeo igeo = igeoList.get(0);

        ISP = igeo.getIsp();
        ...
        ...         
    } 
```

*Igeo = java 代表表中的类

**当 ip 位于复合 ID 列的值之间时获取记录，例如。

ip_from = 1 ; ip_to = 3 ; ip = 2;

所以上面的行将被返回

该表仅用于读取记录，请给我一个比上面更有效的查询字符串

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:47:09.293

首先删除休眠并在查询浏览器中运行您的查询，看看需要多长时间才能返回。如果花费相同的时间，则不是休眠。这是数据库的性能。确保将索引添加到两列 ip_from 和 ip_to。您还可以对查询执行查询计划，以查看数据库在后台运行的内容并尝试优化查询计划。

我建议不要像你一样在查询中使用连接。这会产生一个安全漏洞，允许来自外部各方的潜在 SQL 注入。最好使用以下内容：

```
Query q = session.createQuery("from Igeo igeo where igeo.from_ip >= ? and igeo.to_ip <= ?");
q.setString( 0, ip );
q.setString( 1, ip ); 
```

您还可以使用命名参数，这可能会缩短一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:57:40.333

如果表 IGeo 不包含 ip_from 和 ip_to 的重叠范围，您可以试试这个

```
 String queryString = "FROM Igeo igeo"
        +  " WHERE igeo.ip_to >= " + ip
        +  " ORDER BY igeo.ip_to"; 
```

然后检查列表中的第一项（查看 ip_from <= ip）。

即使该表可能包含 ip_from、ip_to 的重叠范围，我敢打赌上述 HQL 会运行得更快。

`<`除了`>`你真的不应该将像“ip”这样的原始字符串连接到 HQL 或 SQL 中。它会导致 SQL 注入攻击漏洞。使用查询参数代替`<`/Aside`>`

此外，验证您的数据库在对应于 Igeo.ip_to 的列上有一个索引。

根据您的描述，我觉得数据库的主键是 Igeo.ip_from + IGeo.ip_to。如果 ip_from 和 ip_to 的值不重叠，那似乎没有被规范化。您应该只需要一列作为主键。如果您选择将两列都用作主键，则上述查询将受益于添加单个索引。

如果您添加一个包含表中所有列的索引（从 ip_to 和 ip_from 开始），某些数据库的性能会更好。（这使数据库能够通过仅访问索引来满足查询）。不确定 MySQL 是否可以优化到这种程度，但我知道 DB2 和 Oracle 会提供这一点。

# java - Android onStart 执行速度比广播快

> ID：11632689
> 
> 赞同：0
> 
> 时间：2012-07-24T14:08:31.507
> 
> 标签：java, android, bluetooth

所以我正在调用一个本机设备选择器`android.bluetooth.devicepicker.action.LAUNCH`，将广播`android.bluetooth.devicepicker.action.DEVICE_SELECTED`操作发送到扩展的广播接收器`DeviceReceiver.java`。接收方接收选定的设备详细信息并设置静态公共布尔值`isDeviceSelected = true`

随着设备选择器关闭，活动视图再次上线并触发`onStart();`

我在那里检查`if (DeviceReceiver.isDeviceSelected == true) { connectToDevice(); }`

所以问题是有时（5％）`onStart`在 DeviceReceiver 设置之前执行`isDeviceSelected=true`。

如何让 onStart 仅在 DeviceReceiver 执行完成后才执行？

# iphone - 内存问题iphone

> ID：11632697
> 
> 赞同：0
> 
> 时间：2012-07-24T14:08:57.557
> 
> 标签：iphone, objective-c, ios, memory-management, memory-leaks

我以前从来没有遇到过这样的问题。现在我不知道如何处理这个问题，希望能得到一些帮助。

我正在将视图控制器（比如说 exampleViewController）推送到导航控制器。在 viewdidload 上的 exampleViewController 中，我添加了一个带有图像的 imageview。在 dealloc 上，我从 superview 中删除了这个 imageview，然后释放任何保留的视图。仪器泄漏工具没有显示任何泄漏，但是当我打开仪器-“活动监视器”然后我看到当我推动我的 exampleViewController 时，实际内存增加了 5 MB，当我弹出我的 exampleViewController 时，内存只减少了 3 MB .. 因此，如果我多次推送并弹出此 exampleViewController，我会收到内存警告，然后该应用程序退出。

我肯定做错了什么，因为其他视图控制器的行为符合预期。所以问题是我不知道我做错了什么，希望你们提出一些方法来找出导致这种情况的原因。

我已经尝试了一些工具中的一些工具，比如 alloc 工具，然后标记堆，以及一些类似的东西，但这并没有显示出什么被泄露：/

提前致谢！！

**编辑：**

现在，当在仪器中标记堆时，executeFetchRequest：似乎正在泄漏，我做错了什么吗？

```
+ (Question *)getQuestionWithId:(NSString *)questionId 
```

{ 问题 *resultQuestion = nil;

```
AppDelegate *appDelegate = (AppDelegate*)[UIApplication sharedApplication].delegate;
//geting context from appdelegate
NSManagedObjectContext *context = appDelegate.managedObjectContext;

//form fetch request with predicate
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Question" 
                                          inManagedObjectContext:context];

NSPredicate *query = [NSPredicate predicateWithFormat:@"questionId=%@",questionId];
NSPredicate *query1 = [NSPredicate predicateWithFormat:@"type='ke'"];

NSPredicate *predicates = [NSCompoundPredicate andPredicateWithSubpredicates:[NSArray arrayWithObjects:query,query1, nil]];
[fetchRequest setPredicate:predicates];
[fetchRequest setEntity:entity];

NSError *error = nil;
NSArray *fetchedObjects = [context executeFetchRequest:fetchRequest error:&error];

[fetchRequest release];
resultQuestion = [fetchedObjects lastObject];

return resultQuestion; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:21:02.467

> ...在 dealloc 上，我从 superview 中删除了这个 imageview ...

永远不要在 中这样做`-(void)dealloc`，因为这种方法应该用于内存管理。

删除 imageview`-(void)viewWillDissappear`代替（如果你真的需要这个）。至于您的问题，[请阅读此](http://akosma.com/2009/01/28/10-iphone-memory-management-tips/)内容，我相信您的问题超出了您所谈论的 imageView 的范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:24:53.267

可能是，如果您的图像加载了 imageNamed，则缓存不会在 dealloc 上清空。您是否尝试过加载图像 `UIImage *image = [UIImage imageWithContentsOfFile:path];`

而不是使用

`myImageView.image = [UIImage imageNamed:@"someImage.png"]`

当然，这可能仅有助于“如果”您使用 imageNamed。

# c# - double的xml序列化

> ID：11632699
> 
> 赞同：2
> 
> 时间：2012-07-24T14:09:10.817
> 
> 标签：c#, xml-serialization

当我序列化我的对象时，我的双精度值被打印为 -9.9999999999988987E-05 我该如何解决这个问题，这样我才能得到一个小数点后 4 位的数字？

```
public class DecisionBar
    {
    public DateTime bartime 
         { get; set; }
    public string frequency
             { get; set; }
    public bool HH7
            {get;set;}
    public bool crossover
            {get;set;}
    public double mfe
            {get;set;}
        public double mae
            {get;set;}
                public double currentprofitability
            {get;set;}
    public double entryPointLong
            {get;set;}
    public double entryPointShort
            {get;set;}
    public double exitStopFull
            {get;set;}
    public double exitStopPartial 
                {get;set;}
     [XmlAttribute]         
    public string EntryOrExit
                {get;set;}
//    public DecisionBar()
//          {
//          crossover =false;
//          }

    } 
```

输出。

```
<DecisionBar>
    <bartime>2012-07-24T08:59:00</bartime>
    <frequency>1 MINUTES</frequency>
    <HH7>false</HH7>
    <crossover>false</crossover>
    <mfe>0.00019999999999997797</mfe>
    <mae>-9.9999999999988987E-05</mae>
    <currentprofitability>0</currentprofitability>
    <entryPointLong>0</entryPointLong>
    <entryPointShort>0</entryPointShort>
    <exitStopFull>0</exitStopFull>
    <exitStopPartial>0</exitStopPartial>
</DecisionBar> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T14:18:54.967

在获取中舍入值，因此在序列化期间序列化程序读取舍入值。

```
double _mfe;
double _mae;
        public double mfe
        {
             get
             {
                return Math.Round((decimal)_mfe, 4, MidpointRounding.AwayFromZero)
             }
             set
             {
                 _mfe = value;
             }
        }

        public double mae
        {
             get
             {
                return Math.Round((decimal)_mae, 4, MidpointRounding.AwayFromZero)
             }
             set
             {
                 _mae= value;
             }
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T14:16:03.233

您可以在使用序列化之前舍入双精度

```
mfe = Math.Round(mfe, 4, MidpointRounding.AwayFromZero) 
```

要自动执行此操作，您可以使用属性标记实际`[XmlIgnore]`属性并创建返回舍入值的新属性。

我建议不要使用私有字段和`get; set;`访问器，因为 getter 每次都会对属性进行舍入，而不仅仅是在序列化时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:18:13.030

您可以将双精度格式设置为小数点后 4

```
double number = 123.64612312313;
number = double.Parse(number.ToString("####0.0000")); 
```

# c# - StreamReader 异常不支持给定的路径

> ID：11632700
> 
> 赞同：1
> 
> 时间：2012-07-24T14:09:11.990
> 
> 标签：c#, streamreader

不久前，我写了一些读入 CSV 文件的代码。这工作得很好，从那以后我就再也没有碰过它。我已经回去再次测试它，突然在这条线上抛出了一个异常：

```
using (StreamReader readFile = new StreamReader(sFilename)) 
```

异常状态“不支持给定路径”

sFilename 是具有完整路径的有效文件。它与我之前用于测试的相同文件是有效的 CSV 文本文件。

为什么这会突然停止工作？这只是几天前的工作，我还没有改变它。

# .htaccess - https重写不起作用

> ID：11632701
> 
> 赞同：0
> 
> 时间：2012-07-24T14:09:16.770
> 
> 标签：.htaccess, mod-rewrite

我得到了以下 htaccess，尝试添加 https 重写/重定向 - 它不起作用，知道我做错了什么吗？

```
RewriteEngine on
RewriteRule \.svn/ - [F]

# rewrite traffic to HTTPS
RewriteEngine on
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}

# if a directory or a file exists, use it directly
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# otherwise forward it to index.php
RewriteRule . index.php 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:46:32.193

您的意思是在您的 https 重写后省略 [L] 吗？没有它，如果我请求“http://myserver.com/something”，它将首先重写为“https://myserver.com/something”，然后（我相信）继续在 .htaccess 文件中，随后使用内部重写以提供“index.php”而不实际重定向客户端。虽然如果请求的文件确实存在，我不确定 Apache 将如何处理它。

# uitableview - 滚动 UITableView 时更改单元格高度

> ID：11632709
> 
> 赞同：7
> 
> 时间：2012-07-24T14:10:06.783
> 
> 标签：uitableview

滚动 UITableView 时是否可以动态更改单元格的高度？

当用户将滚动位置向下拖过顶部时，我需要更改多个单元格的高度。我可以通过发出 reloadData 成功地做到这一点，但是它非常突然，因为单元格刚刚消失。

我还尝试重新加载单元格并在表格视图上运行开始/结束更新，但是在这两种情况下，动画都会将滚动视图发送回顶部。

我想为单元格高度变化设置动画，而不会弄乱正在进行的拖动的当前内容偏移量。

蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T11:05:02.023

使用 UITableViewDelegate 并实现方法

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

这解决了你的问题？如果它不能解决您的问题，请尝试通过示例/图像更好地解释您的目标。

# java - 在 Android 上反序列化的正确位置

> ID：11632710
> 
> 赞同：0
> 
> 时间：2012-07-24T14:10:14.587
> 
> 标签：java, android, serialization

我正在开发一个 Android 应用程序，它使用序列化在文件中存储 TreeSet 对象。我需要在我的应用程序关闭时序列化对象并在启动时反序列化，因为我需要在完整的运行时访问。不幸的是，用户将开始/结束哪个活动是非常不可预测的，所以我不清楚在哪里放置这个序列化和反序列化调用的正确位置，以便对象在整个运行时可用。

提前感谢您的任何想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:21:52.260

好吧，取决于您的应用程序对性能的依赖程度以及您的序列化过程的复杂程度，我会在您的主要活动启动时读取并在`onCreate()`每次设置值时写入。简单而低效，但安全。

# javascript - jQuery滑出菜单项

> ID：11632714
> 
> 赞同：1
> 
> 时间：2012-07-24T14:10:35.110
> 
> 标签：javascript, jquery, html, css, animation

就 Jquery 而言，我已经搜索并搜索了选项，但我似乎找不到任何可以满足我想要的东西，但它似乎是一个如此简单的效果。谁能告诉我如何让下图中的菜单项像第二项一样滑出，当有人将鼠标悬停在它上面时？

![示例效果](../Images/1aac4873f33d6dc45097dc08e2c8cd3c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T14:18:53.623

```
$('.menuClass').mouseover(function(){
    $(this).animate({'marginTop':'100px'});
});

$('.menuClass').mouseout(function(){
    $(this).animate({'marginTop':'0px'});
}); 
```

相应地更改 marginTop 的值。

这些也将有助于：

[http://api.jquery.com/mouseover/](http://api.jquery.com/mouseover/)

[http://api.jquery.com/mouseout/](http://api.jquery.com/mouseout/)

[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T14:22:16.243

您可以为此使用多个 css 动画方法。

[这是您的问题的 jQuery 答案。](http://jsfiddle.net/mjaA3/37/)

jQuery：

```
$('div').bind({
  mouseenter: function() {
    $(this).stop().animate({'background-position-y':'-20px','height':'68px'},600);
  },
  mouseleave: function() {
    $(this).stop().animate({'background-position-y':'-58px','height':'30px'},600);
  }
});​ 
```

CSS：

```
div {
   background: url(http://i.stack.imgur.com/g3aqx.jpg) -146px -58px;
   float:left; width:86px; height:30px;
}  ​ 
```

## ----------------------------------

或者

您只需使用 CSS3 就可以做到这一点：

[CSS3 动画 jsFiddle 示例在这里。](http://jsfiddle.net/mjaA3/40/)

```
div {
    float:left; background: url(http://i.stack.imgur.com/g3aqx.jpg) -146px -58px;
    width:86px; height:30px;

transition: .5s;
-moz-transition:  .5s; /* Firefox 4 */
-webkit-transition:  .5s; /* Safari and Chrome */
-o-transition: .5s; /* Opera */
}

div:hover { background-position-y:-20px; height:68px; } ​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T14:25:24.890

您可以使用动画 jquery 方法：

[http://jsfiddle.net/wWhG2/42/](http://jsfiddle.net/wWhG2/42/)

```
$("#img").hover(function() {
    $(this).stop();
    $(this).animate({top:"0"},500,null); 
}, function () {
    $(this).stop();
    $(this).animate({top:"-150"},500,null);  
}); 
```

# javascript - javascript事件模型

> ID：11632719
> 
> 赞同：1
> 
> 时间：2012-07-24T14:10:47.683
> 
> 标签：javascript, actionscript-3

我是一名动作脚本开发人员。在开发组件时，有一种方法可以监听父级的点击事件并在该组件内引用一个函数。

如果我将 100 个组件添加到我的主应用程序中，并且如果我单击父应用程序，那 100 个组件将调用它自己的功能。

```
Component.as

parentApplication.addEventListener('click', ClickHandler);

function ClickHandler(event:event)
{
  ....
} 
```

使用javascript实现这一目标的方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:21:49.270

您可以使用提供类似（但不相同）事件处理的 jQuery。在你的情况下，这就像

```
$(childComponent).click(function(eventObject){
    childComponent = $(this);
    ...
}); 
```

或者

```
$(childComponent).bind("click", function(eventObject){
     childComponent = $(this);
     ...
}); 
```

请注意，bind 与 Flex 中的 databind 非常不同，它与 addEventListener 非常相似。这里棘手的是对象范围。在 JavaScript（如 ActionScript 2 或更早版本）中，每当处理事件时，this 指的是引发事件的对象，而不是侦听事件的父对象，这可能非常违反直觉。

更多关于[jQuery](http://docs.jquery.com/How_jQuery_Works)的信息可以在这里找到，它的[click](http://api.jquery.com/click/)、[bind](http://api.jquery.com/unbind/)和 unbind 特性也是如此。

# iphone - iPhone 二维码阅读器

> ID：11632720
> 
> 赞同：0
> 
> 时间：2012-07-24T14:10:47.777
> 
> 标签：iphone, objective-c, ios, qr-code, zxing

所以我需要为 iphone 应用程序编写一个二维码阅读器。通常，ZXING 和 ZBAr 等框架允许您下载应用程序，然后读取条形码。我想将它集成到应用程序本身中。所以基本上我希望能够点击一个按钮并让它读取二维码。这可能吗？如果是这样，是否有任何适当的文件？我尝试使用 ZXing，但是当我链接二进制文件时，libZXingWidget.a 不可用。此外，文档不足以知道如何将其集成到应用程序中。所以让我知道。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:18:56.293

这是设置 ZBar 的代码，确保将 SDK 添加到您的项目并链接您的库。

-

```
(void)viewDidLoad
{
        [ZBarReaderView class];
        readerView.readerDelegate = self;
        readerView.tracksSymbols = NO;

            //CHOOSE CAMERA
            if (some setting isEqual to CameraRear) {
                readerView.device = [self backFacingCameraIfAvailable];
            }
            else {
                readerView.device = [self frontFacingCameraIfAvailable];
            }

        [self relocateReaderPopover:[self interfaceOrientation]];
        [readerView start];
    }

-(AVCaptureDevice *)frontFacingCameraIfAvailable
{
    NSArray *videoDevices = [AVCaptureDevice devicesWithMediaType:AVMediaTypeVideo];
    AVCaptureDevice *captureDevice = nil;
    for (AVCaptureDevice *device in videoDevices)
    {
        if (device.position == AVCaptureDevicePositionFront)
        {
            captureDevice = device;
            break;
        }
    }

    //  couldn't find one on the front, so just get the default video device.
    if ( ! captureDevice)
    {
        captureDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
    }

    return captureDevice;
}

-(AVCaptureDevice *)backFacingCameraIfAvailable
{
    NSArray *videoDevices = [AVCaptureDevice devicesWithMediaType:AVMediaTypeVideo];
    AVCaptureDevice *captureDevice = nil;
    for (AVCaptureDevice *device in videoDevices)
    {
        if (device.position == AVCaptureDevicePositionBack)
        {
            captureDevice = device;
            break;
        }
    }

    //  couldn't find one on the front, so just get the default video device.
    if ( ! captureDevice)
    {
        captureDevice = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];
    }

    return captureDevice;
}

-(void)relocateReaderPopover:(UIInterfaceOrientation)toInterfaceOrientation{
    if (toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft) {
        readerView.previewTransform = CGAffineTransformMakeRotation(M_PI_2);
    } else if (toInterfaceOrientation == UIInterfaceOrientationLandscapeRight) {
        readerView.previewTransform = CGAffineTransformMakeRotation(-M_PI_2);
    } else if (toInterfaceOrientation== UIInterfaceOrientationPortraitUpsideDown) {
        readerView.previewTransform = CGAffineTransformMakeRotation(M_PI);
    } else {
        readerView.previewTransform = CGAffineTransformIdentity;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T14:17:44.190

这是一个关于如何将集成的二维码阅读器添加到您的 iPhone 应用程序[的分步教程。](http://basheerad.blogspot.com/2012/04/integrating-zxing-qr-code-reader-in.html)如果您需要了解如何使用它，请查看此[示例 ZXing 项目。](http://zxing.googlecode.com/svn/trunk/iphone/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T14:33:26.347

我已经设法将 ZXING 集成到我的测试项目中。我不久前做过这个，所以我可能不记得我面临和解决的所有问题。在我的工作区文件夹中，我复制了 ZXing-2.0 文件夹。在里面我只剩下文件夹：cpp、docs 和 iphone。在我的工作区（包含测试项目）中，我从文件夹 ZXing-2.0 添加了 ZXingWidget 项目。这允许我添加到链接设置 libZXingWidget.a。当我构建我的测试项目时，XCode 会检测依赖关系并首先构建小部件，然后构建测试项目并将其链接到 libZXingWidget.a。

这是我实现的一个简单的视图控制器，用于在能够检测 QR 码的摄像头视图中显示。

```
//
//  MyVC.m
//
//

#import "MyVC.h"
#import "QRCodeReader.h"

@interface MyVC () {
    ZXingWidgetController *_widController;
}

@end

@implementation MyVC

@synthesize labelResultString;

- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    _widController = [[ZXingWidgetController alloc] initWithDelegate:(id<ZXingDelegate>)self showCancel:YES OneDMode:NO];
    QRCodeReader* qrcodeReader = [[QRCodeReader alloc] init];
    NSSet *readers = [[NSSet alloc ] initWithObjects:qrcodeReader,nil];
    //[qrcodeReader release];
    _widController.readers = readers;
    //[readers release];
    //NSBundle *mainBundle = [NSBundle mainBundle];
    //_widController.soundToPlay = [NSURL fileURLWithPath:[mainBundle pathForResource:@"beep-beep" ofType:@"aiff"] isDirectory:NO];
    _widController.overlayView.displayedMessage = @"";
    _widController.wantsFullScreenLayout = NO;

    //[self presentModalViewController:_widController animated:NO];
    _widController.view.frame = CGRectMake(10, 10, 300, 300);//self.view.frame;
    _widController.view.autoresizingMask = UIViewAutoresizingNone;
    _widController.overlayView.frame = CGRectMake(0, 0, 300, 300);
    _widController.overlayView.cropRect = CGRectMake(20, 20, 260, 260);

    [self.view addSubview:_widController.view];

    //[_widController release];
}

- (void)viewDidUnload {
    [super viewDidUnload];

    self.labelResultString = nil;
}

- (void)dealloc {
    self.labelResultString = nil;
}

- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];

    [_widController viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];

    [_widController viewDidAppear:animated];
    [[UIApplication sharedApplication] setStatusBarHidden:NO];
}

- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];

    [_widController viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated {
    [super viewDidDisappear:animated];

    [_widController viewDidDisappear:animated];
}

#pragma mark - ZXingDelegateMethods

- (void)zxingController:(ZXingWidgetController*)controller didScanResult:(NSString *)result {
    self.labelResultString.text = result;
}

- (void)zxingControllerDidCancel:(ZXingWidgetController *)controller {
    [self dismissModalViewControllerAnimated:YES];
}

@end 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-24T14:38:26.097

正确设置 ZXing 后，获取 QR 阅读器的代码实际上就是这么简单：

确保为 QR 导入这两个家伙：

```
#import "ZXingWidgetController.h"
#import "QRCodeReader.h" 
```

然后在您的控制器中，您将按如下方式设置代码阅读器：

```
ZXingWidgetController *widController = [[ZXingWidgetController alloc] initWithDelegate:self showCancel:YES OneDMode:NO];

QRCodeReader *qrcodeReader = [[QRCodeReader alloc] init];

NSSet *readers = [[NSSet alloc] initWithObjects:qrcodeReader,nil];

widController.readers = readers;

[self presentModalViewController:widController animated:YES]; 
```

您基本上设置了处理代码读取的控制器`ZXingWidgetController`（`QRCodeReader`

然后，您将需要实现`<ZXingDelegate>`以下`delegate`功能：

```
- (void)zxingController:(ZXingWidgetController*)controller didScanResult:(NSString *)result
{  
    [self dismissModalViewControllerAnimated:YES];
    NSLog(@"%@",result);  //Simple NSString result.
}

- (void)zxingControllerDidCancel:(ZXingWidgetController*)controller
{
    [self dismissModalViewControllerAnimated:YES];
    NSLog(@"Cancelled");
} 
```

最困难的部分只是设置它。我发现这个教程是最有帮助的（对不起，我使用了一个链接）：[如何在 Xcode 4 中安装 ZXing](http://yannickloriot.com/2011/04/how-to-install-zxing-in-xcode-4/) 如果您有任何问题，这些评论也很有帮助。

# cakephp - CakePHP 多级模型

> ID：11632722
> 
> 赞同：2
> 
> 时间：2012-07-24T14:10:49.887
> 
> 标签：cakephp, model, associations, multi-level

一段时间以来，我一直试图弄清楚如何在 CakePHP 中保存多级模型，但似乎找不到解决方案。

我有三个模型。**调查**、**问题**和**选​​择**。

*   **调查**有很多**问题**-*所以**问题**属于**调查***

*   **问题**有很多**选择**-*所以**选择**属于**问题***

    *   **问题**通过其survey_id**键**链接到**调查。**

    ***   另一方面，**Choice**是通过其**question_id**键链接到**Question的。**（虽然没有直接链接到**调查**）** 

 ******表单是通过创建的`$this->Form->create('Survey')`。

我希望应用程序保存带有相应问题的调查，**并且**每个问题都有相应的选择。

问题是，只保存了**调查**和**问题**模型。**选择**被丢弃。

我正在使用`$this->saveAssociated($this->request->data, array( 'deep' => true) )`

我将更新我的帖子以显示`$_POST`数据。

谢谢，

XTN

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T05:19:18.890

您的模型应如下所示：

`Survey Model: Survey.php`

```
class Survey extends AppModel {   
    public  $name = 'Survey';   
    public $hasMany = array('Questions' => array(
                                          'className' => 'Question',
                                          'foreignKey' => 'survey_id'
                                                )
                           );
} 
```

`Question Model: Question.php`

```
class Question extends AppModel{   
public $name = 'Question';   
public $belongsTo = array(
                        'Survey' => array('className' => 'Survey', 'foreignKey' => 'survey_id'),
                        'Answer' => array('className' => 'Choice', 'foreignKey' => 'answer_id'));
public $hasMany = array('Choices' => array('className' =>  'Choice', 
                                           'foreignKey' => 'question_id'));
} 
```

`Choice Model: Choice.php`

```
class Choice extends AppModel
{
public $name = 'Choice';   
public $belongsTo = array('Question' => array('className' => 'Question', 
                                              'foreignKey' => 'question_id'));   
} 
```

请询问它是否不适合您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T06:38:45.643

在保存数据之前，您必须确保数据应该是这种格式

在您的控制器中：

```
$data = array('Survey' => array('id' => 1,'name' => 'test'),
                  'Question' => array(
                                    array('id' => 1,'question' => 'test1','survey_id' => 1,
                                        'Choice' => array(
                                            array('id' => 1,'question_id' => 1,'choice' => 1),
                                            array('id' => 2,'question_id' => 1,'choice' => 2)
                                            )

                                    ),
                                    array('id' => 2,'question' => 'question2','survey_id' => 1,
                                    'Choice' => array(
                                        array('id' => 3,'question_id' => 2,'choice' => 'sd'),
                                        array('id' => 4,'question_id' => 2,'choice' => 'we')
                                        )
                                    )
                                )
                 );
        $this->Survey->create();
        $this->Survey->saveAssociated($data,array('deep'=>true)); 
```

测量模型：

```
public $hasMany = array(
    'Question' => array(
        'className' => 'Question',
        'foreignKey' => 'survey_id',
        'dependent' => false,
    )
         ); 
```

问题模型：

```
public $belongsTo = array(
    'Survey' => array(
        'className' => 'Survey',
        'foreignKey' => 'survey_id',
    )
);
public $hasMany = array(
    'Choice' => array(
        'className' => 'Choice',
        'foreignKey' => 'question_id',
        'dependent' => false,
    )
); 
```

选择型号：

```
public $belongsTo = array(
    'Question' => array(
        'className' => 'Question',
        'foreignKey' => 'question_id',
    )
); 
```

如果发现任何问题，我认为它会起作用，请通知******

# jquery - 使用嵌套 div 将类添加到 tr

> ID：11632724
> 
> 赞同：-1
> 
> 时间：2012-07-24T14:10:53.737
> 
> 标签：jquery

我正在尝试使用 jquery 将类添加到 tr .inside 类名称为 .flexme1 的表中

我尝试了下面的各种选项，但似乎没有用..

```
 //jQuery("div.flexigrid > table.flexme1 > tr").addClass("cal");

or

        jQuery("div.flexigrid > table.flexme1 > tr").addClass("sev1");
  or 
        jQuery(".erow").addClass("sev2");
   or
        jQuery(".flexigrid > tr").addClass("sev3");
   or
        jQuery(".flexigrid >tr").addClass("sev4");
   or
        jQuery(".flexigrid >tr").addClass("sev5"); 
```

我希望 tr 添加 class="somename" 。

```
<div class="flexigrid">
  ..< some other divs>...<<table> ..</table></div>
... <some other divs>...<table>..</table></div>
---
<div class="bDiv" >
   <table cellspacing="0" cellpadding="0" border="0" class="flexme1" >
      <tbody>
         <tr  class="sev1">
            <td align="left" abbr="InstanceDisplayName8">
               <div style="text-align: left; width: 190px;">undefined</div>
            </td>
            <td align="right" abbr="severity" class="sorted">
               <div style="text-align: right; width: 40px;">&nbsp;</div>
            </td>
            <td align="right" abbr="Impact">
               <div style="text-align: right; width: 40px;">0</div>
            </td>
            <td align="right" abbr="occurrencecount">
               <div style="text-align: right; width: 40px;">undefined</div>
            </td>
            <td align="left" abbr="NotificationID">
               <div style="text-align: left; width: 100px;">Host</div>
            </td>
            <td align="left" abbr="Name">
               <div style="text-align: left; width: 120px;">Down</div>
            </td>
            <td align="right">
               <div style="text-align: right; width: 130px;">undefined</div>
            </td>
         </tr>
         <tr class="erow"  class="sev1">
            <td align="left" abbr="InstanceDisplayName8">
               <div style="text-align: left; width: 190px;">undefined</div>
            </td>
            <td align="right" abbr="severity" class="sorted">
               <div style="text-align: right; width: 40px;">&nbsp;</div>
            </td>
            <td align="right" abbr="Impact">
               <div style="text-align: right; width: 40px;">1</div>
            </td>
            <td align="right" abbr="occurrencecount">
               <div style="text-align: right; width: 40px;">undefined</div>
            </td>
            <td align="left" abbr="NotificationID">
               <div style="text-align: left; width: 100px;">Host</div>
            </td>
            <td align="left" abbr="Name">
               <div style="text-align: left; width: 120px;">Down</div>
            </td>
            <td align="right">
               <div style="text-align: right; width: 130px;">undefined</div>
            </td>
         </tr>
         <tr   class="sev3">
            <td align="left" abbr="InstanceDisplayName8">
               <div style="text-align: left; width: 190px;">undefined</div>
            </td>
            <td align="right" abbr="severity" class="sorted">
               <div style="text-align: right; width: 40px;">&nbsp;</div>
            </td>
            <td align="right" abbr="Impact">
               <div style="text-align: right; width: 40px;">0</div>
            </td>
            <td align="right" abbr="occurrencecount">
               <div style="text-align: right; width: 40px;">undefined</div>
            </td>
            <td align="left" abbr="NotificationID">
               <div style="text-align: left; width: 100px;">Host</div>
            </td>
            <td align="left" abbr="Name">
               <div style="text-align: left; width: 120px;">Down</div>
            </td>
            <td align="right">
               <div style="text-align: right; width: 130px;">undefined</div>
            </td>
         </tr>
         <tr class="erow" >
            <td align="left" abbr="InstanceDisplayName8">
               <div style="text-align: left; width: 190px;">undefined</div>
            </td>
            <td align="right" abbr="severity" class="sorted">
               <div style="text-align: right; width: 40px;">&nbsp;</div>
            </td>
            <td align="right" abbr="Impact">
               <div style="text-align: right; width: 40px;">1</div>
            </td>
            <td align="right" abbr="occurrencecount">
               <div style="text-align: right; width: 40px;">undefined</div>
            </td>
            <td align="left" abbr="NotificationID">
               <div style="text-align: left; width: 100px;">Host</div>
            </td>
            <td align="left" abbr="Name">
               <div style="text-align: left; width: 120px;">BM1M</div>
            </td>
            <td align="right">
               <div style="text-align: right; width: 130px;">undefined</div>
            </td>
         </tr>
         <tr >
            <td align="left" abbr="InstanceDisplayName8">
               <div style="text-align: left; width: 190px;">undefined</div>
            </td>
            <td align="right" abbr="severity" class="sorted">
               <div style="text-align: right; width: 40px;">&nbsp;</div>
            </td>
            <td align="right" abbr="Impact">
               <div style="text-align: right; width: 40px;">0</div>
            </td>
            <td align="right" abbr="occurrencecount">
               <div style="text-align: right; width: 40px;">undefined</div>
            </td>
            <td align="left" abbr="NotificationID">
               <div style="text-align: left; width: 100px;">Host</div>
            </td>
            <td align="left" abbr="Name">
               <div style="text-align: left; width: 120px;">Down</div>
            </td>
            <td align="right">
               <div style="text-align: right; width: 130px;">undefined</div>
            </td>
         </tr>
         <tr class="erow" >
            <td align="left" abbr="InstanceDisplayName8">
               <div style="text-align: left; width: 190px;">undefined</div>
            </td>
            <td align="right" abbr="severity" class="sorted">
               <div style="text-align: right; width: 40px;">&nbsp;</div>
            </td>
            <td align="right" abbr="Impact">
               <div style="text-align: right; width: 40px;">4</div>
            </td>
            <td align="right" abbr="occurrencecount">
               <div style="text-align: right; width: 40px;">undefined</div>
            </td>
            <td align="left" abbr="NotificationID">
               <div style="text-align: left; width: 100px;">Host</div>
            </td>
            <td align="left" abbr="Name">
               <div style="text-align: left; width: 120px;">BM1N</div>
            </td>
            <td align="right">
               <div style="text-align: right; width: 130px;">undefined</div>
            </td>
         </tr>
         <tr >
            <td align="left" abbr="InstanceDisplayName8">
               <div style="text-align: left; width: 190px;">undefined</div>
            </td>
            <td align="right" abbr="severity" class="sorted">
               <div style="text-align: right; width: 40px;">&nbsp;</div>
            </td>
            <td align="right" abbr="Impact">
               <div style="text-align: right; width: 40px;">0</div>
            </td>
            <td align="right" abbr="occurrencecount">
               <div style="text-align: right; width: 40px;">undefined</div>
            </td>
            <td align="left" abbr="NotificationID">
               <div style="text-align: left; width: 100px;">Host</div>
            </td>
            <td align="left" abbr="Name">
               <div style="text-align: left; width: 120px;">Down</div>
            </td>
            <td align="right">
               <div style="text-align: right; width: 130px;">undefined</div>
            </td>
         </tr>
         <tr class="erow" >
            <td align="left" abbr="InstanceDisplayName8">
               <div style="text-align: left; width: 190px;">undefined</div>
            </td>
            <td align="right" abbr="severity" class="sorted">
               <div style="text-align: right; width: 40px;">&nbsp;</div>
            </td>
            <td align="right" abbr="Impact">
               <div style="text-align: right; width: 40px;">0</div>
            </td>
            <td align="right" abbr="occurrencecount">
               <div style="text-align: right; width: 40px;">undefined</div>
            </td>
            <td align="left" abbr="NotificationID">
               <div style="text-align: left; width: 100px;">Host</div>
            </td>
            <td align="left" abbr="Name">
               <div style="text-align: left; width: 120px;">Down</div>
            </td>
            <td align="right">
               <div style="text-align: right; width: 130px;">undefined</div>
            </td>
         </tr>
         <tr >
            <td align="left" abbr="InstanceDisplayName8">
               <div style="text-align: left; width: 190px;">undefined</div>
            </td>
            <td align="right" abbr="severity" class="sorted">
               <div style="text-align: right; width: 40px;">&nbsp;</div>
            </td>
            <td align="right" abbr="Impact">
               <div style="text-align: right; width: 40px;">0</div>
            </td>
            <td align="right" abbr="occurrencecount">
               <div style="text-align: right; width: 40px;">undefined</div>
            </td>
            <td align="left" abbr="NotificationID">
               <div style="text-align: left; width: 100px;">Host</div>
            </td>
            <td align="left" abbr="Name">
               <div style="text-align: left; width: 120px;">Down</div>
            </td>
            <td align="right">
               <div style="text-align: right; width: 130px;">undefined</div>
            </td>
         </tr>
         <tr class="erow" >
            <td align="left" abbr="InstanceDisplayName8">
               <div style="text-align: left; width: 190px;">undefined</div>
            </td>
            <td align="right" abbr="severity" class="sorted">
               <div style="text-align: right; width: 40px;">&nbsp;</div>
            </td>
            <td align="right" abbr="Impact">
               <div style="text-align: right; width: 40px;">0</div>
            </td>
            <td align="right" abbr="occurrencecount">
               <div style="text-align: right; width: 40px;">undefined</div>
            </td>
            <td align="left" abbr="NotificationID">
               <div style="text-align: left; width: 100px;">Host</div>
            </td>
            <td align="left" abbr="Name">
               <div style="text-align: left; width: 120px;">Down</div>
            </td>
            <td align="right">
               <div style="text-align: right; width: 130px;">undefined</div>
            </td>
         </tr>
      </tbody>
   </table>
   <div class="iDiv" style="display: none;"></div>
</div>

</div><!-- end of div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:19:26.663

这样做： -

```
jQuery(".bDiv table.flexme1 tr").addClass("inside"); 
```

参考**[现场演示](http://jsfiddle.net/SivaCharan/4DdUW/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T14:14:52.130

你几乎是对的，只需[删除`>`](http://api.jquery.com/descendant-selector/)- 这`table`不是他们之间的[直接孩子](http://api.jquery.com/child-selector/)：`.flexigrid``div.bDiv`

```
jQuery("div.flexigrid table.flexme1 tr").addClass("somename"); 
```

# security - 使用 Javascript 保护 swf 对象

> ID：11632725
> 
> 赞同：0
> 
> 时间：2012-07-24T14:11:00.720
> 
> 标签：security, flash, decompiler

我正在开发一个加载 swf 对象的 Web 应用程序；我在问如何保护这个 SWF 对象免受 Decompiler 的影响？我怎样才能保护它！非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:21:06.823

你不能。

您的 SWF 与从 Adob​​e Flash 导出时一样安全。

# c# - 调用 ErrorProvider.Dispose 不会每次都清除错误文本

> ID：11632726
> 
> 赞同：0
> 
> 时间：2012-07-24T14:11:04.013
> 
> 标签：c#, winforms

我有一个 Windows 窗体应用程序并正在调用`ErrorProvider.Dispose`以清除错误文本。但是，当我第二次调用它时它不起作用（即，如果文本框为空，`ErrorProvider`则会显示，但在我填充文本框并再次按下提交按钮后，它不会显示错误）。

我有一个包含许多文本框的表单，我只是在单击提交按钮后检查字段是否为空：

```
foreach (Control c in this.college.Controls)
{
    if (c is TextBox)
    {
        TextBox textBox = c as TextBox;
        if (textBox.Text.Equals(string.Empty))
        {
            if (string.IsNullOrWhiteSpace(textBox.Text))
            {
                errorProvider1.SetError(textBox, "Field Empty");
            }
            else
            {
                errorProvider1.Dispose();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:15:36.723

如果您的意图只是清除先前的错误消息，则只需再次调用 SetError 方法，但传入一个空字符串。

```
if (string.IsNullOrWhiteSpace(textBox.Text)) 
{ 
    errorProvider1.SetError(textBox, "Field Empty"); 
} 
else 
{ 
    errorProvider1.SetError(textBox, string.Empty); 
} 
```

无需调用 Dispose()。相反，调用 Dispose 将破坏 errorprovider，并且在表单的剩余生命周期中将无法使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:18:35.170

我认为您的代码永远不会达到

```
errorProvider1.Dispose() 
```

由于 if 语句

```
if (textBox.Text.Equals(string.Empty)) 
```

做第二个 if 语句

```
if (string.IsNullOrWhiteSpace(textBox.Text)) 
```

无用。

如果 textBox.Text 为空，则它也是 null-or-whitespace。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:19:30.410

您不想在错误提供程序上调用 .Dispose() - 这将由垃圾收集器自动收集。您的代码应该如下所示：

```
 foreach (Control c in this.college.Controls)
    {

        if (c is TextBox)
        {

            TextBox textBox = c as TextBox;

             if (string.IsNullOrWhiteSpace(textBox.Text))
             {
                errorProvider1.SetError(textBox, "Field Empty");
             }
             else
             {
                errorProvider1.SetError(textBox, "");
             }
        }
    } 
```

# javascript - 在 ECMAScript 中，一些原生对象是如何内置的？

> ID：11632731
> 
> 赞同：2
> 
> 时间：2012-07-24T14:11:16.117
> 
> 标签：javascript, ecmascript-5

我想回答这个问题需要对本机和内置对象进行定义。以下是 ECMAScript 规范将这些定义为：

> 4.3.6 原生对象
> 
> ECMAScript 实现中的对象，独立于宿主环境，在 ECMAScript 程序执行开始时出现。
> 
> 注意 本规范中定义了标准的原生内置对象。**一些原生对象是内置的**；其他的可以在 ECMAScript 程序的执行过程中构建
> 
> 4.3.7 内置对象
> 
> 由 ECMAScript 实现提供的对象，独立于宿主环境，在 ECMAScript 程序执行开始时存在
> 
> 注意 本规范中定义了标准内置对象，ECMAScript 实现可以指定和定义其他对象。每个内置对象都是原生对象。*内置构造函数*是一个内置对象，它也是一个构造函数。

我期待着对此的解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:28:11.123

这是[ES5 显示](http://es5.github.com/#x4.3.6)的内容：

> 4.3.6 native object # Ⓣ 在 ECMAScript 实现中的对象，其语义完全由本规范定义，而不是由宿主环境定义。
> 
> 注意 标准原生对象在本规范中定义。一些原生对象是内置的；其他的可以在 ECMAScript 程序的执行过程中构建。
> 
> 4.3.7 built-in object # Ⓣ 由 ECMAScript 实现提供的对象，独立于宿主环境，在 ECMAScript 程序执行开始时出现。
> 
> 注意 本规范中定义了标准内置对象，ECMAScript 实现可以指定和定义其他对象。每个内置对象都是原生对象。内置构造函数是一个内置对象，它也是一个构造函数。

如您所见，它与您所展示的不同。

内置对象是兼容 ECMAScript 的引擎提供的本机对象。例如：

*   细绳
*   目的
*   大批
*   不明确的
*   布尔值
*   等等

例如，本机对象是：

```
var obj = {}; 
```

或之前显示的列表。内置对象是原生的。

另外，您没有显示它，但是主机对象是依赖于环境的对象。例如，在浏览器中，*宿主*对象是`window`. 还有其他主机对象，例如`document`或`XMLHttpRequest`尽管。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-07-24T14:14:55.703

本机对象 - 表示不在 ECMAScript 本身中实现。内置对象 - 引擎提供的对象。想想数学，字符串等。

# javascript - ASP.NET MVC - 修改记录时自动通知？

> ID：11632732
> 
> 赞同：0
> 
> 时间：2012-07-24T14:11:17.303
> 
> 标签：javascript, jquery, asp.net-mvc, model-view-controller

我刚刚在 Windows 应用程序中使用了 NotifyIcon 类，我认为它非常方便。我主要是一名网络开发人员，所以我只是想了解网站是否有类似的东西。

我想将其合并到的网站有一个工单管理模块，用户可以在其中捕获工单/问题，然后从处理工单的客户员工那里获得对这些工单的响应。

显然我意识到通知或弹出窗口将需要显示在页面中，但是有没有办法在特定页面甚至主页面（可能是 javascript 或 JQuery）上放置一个计时器，每隔几个轮询一次数据库分钟并检查最近修改的票证并让登录的用户知道票证已更新？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T14:16:28.990

如果您需要客户端保持与服务器的开放连接并对其进行轮询，我认为 Signal R 将是您集成到 .NET 项目中的最佳选择。它在 Nuget 上，但来源在[https://github.com/SignalR/SignalR](https://github.com/SignalR/SignalR)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:25:47.740

我建议您熟悉[Node.js。](http://nodejs.org)

Node.js 是一个强大的工具，有助于将 javascript 作为实时服务器管理工​​具。

在您熟悉了 Node.js 设置之后，您会想要[掌握 Socket.io](http://socket.io)。Socket.io 通过利用 Node.js 创建的 websocket 为长轮询技术提供支持。在这里，我们可以管理我们提供数据的条件。这是开发人员对抗`2 HTTPD ports`.

# mysql - mySQL：编辑/保存 my.cnf 文件

> ID：11632733
> 
> 赞同：0
> 
> 时间：2012-07-24T14:11:17.900
> 
> 标签：mysql, my.cnf

我找到了随 提供的示例配置文件`mysql 5.0`，但是当我编辑它们时无法保存它们。我也尝试使用不同的文件名进行保存，但我收到一条错误消息，`windows`说我无权将文件保存在该位置 ( `I am an administrator`)。

我需要编辑配置文件，以便能够保存更多数据。我真的不知道该怎么做，并且从几个小时以来一直被这个问题所困扰。谁能弄清楚发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T07:10:10.983

`my.cnf`在 linux opensuse 11.3中编辑文件
首先以 su 模式打开终端窗口，
然后转到目录 /etc然后在任何文本编辑器（kwrite）中
打开文件； 现在只需在 [mysqld] 行之后插入以下两个参数`my.cnf`

```
wait_timeout=50
interactive_timeout=50 
```

保存并退出;
重启mysql；
现在您可以使用以下命令设置会话超时：

```
set wait_timeout=5000;<br> 
```

它是持久的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:14:23.937

您需要对 my.cnf 文件具有 root 权限才能对其进行编辑。

因此，使用 root 用户登录，然后您将能够编辑 my.cnf，然后您需要重新启动 MySQL 服务器以反映更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T20:38:12.177

我看到指导某人编辑my.cnf中包含了基本信息；但是，没有适合初学者的步骤。我有一篇很棒的文章，其中包含分步说明和图形，解释了如何获取 MySQL 设置以及如何通过 shell 以 root 身份更改 my.cnf。希望文章有所帮助。

[如何编辑 MySQL my.cnf 文件](http://www.inmotionhosting.com/support/website/general-server-setup/edit-mysql-my-cnf)

问候，詹姆斯 R

# c# - 在登录时检测来自服务的远程桌面连接 (W7/32)

> ID：11632734
> 
> 赞同：2
> 
> 时间：2012-07-24T14:11:29.707
> 
> 标签：c#, windows, service, rdp

我知道（并且有效）在 C# 中，此属性告诉我当前会话是否是 RDP 会话：

```
System.Windows.Forms.SystemInformation.TerminalServerSession 
```

现在，我有一个接收登录/注销和锁定/解锁事件的服务，我需要一种方法来告诉该服务正在启动的会话是 rdp 还是本地的。

问题：服务以SYSTEM用户运行，上面的属性总是返回false（我认为是因为SYSTEM总是被认为是本地连接用户）

我尝试在寄存器中搜索 Volatile Environment 子项，以检查是否存在标识 RDP 会话名称的子项：这在锁定/解锁处理程序中有效，但在登录处理程序中，子项尚不存在（子项登录完成后创建）。

关于如何解决这个问题的任何想法？

虽然在有限的时间内等待密钥创建是可行的，但我想要一种不那么“笨拙”的方式来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T15:37:00.037

[您可以通过调用WTSQuerySessionInformation](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383838%28v=vs.85%29.aspx)并将`WTSInfoClass`参数设置为来检测会话是本地会话还是远程会话`WTSClientProtocolType`。如果您想避免 P/Invokes，可以使用[Cassia 库](https://code.google.com/p/cassia/)：`new TerminalServicesManager().GetLocalServer().GetSession(sessionId).ClientProtocolType`.

注意事项：这在处理会话注销消息时对您没有帮助，因为您将无法（可靠地）获取有关会话的信息，因为它正在被销毁（但这似乎相对容易解决）。此外，`ClientProtocolType`上面提到的 Cassia 属性尚未发布，但您可以通过以访客身份登录并使用 artifacts 链接从[构建服务器获取主干构建。](http://teamcity.codebetter.com/project.html?projectId=project51)

# c# - 需要 .NET 正则表达式的建议以从 SIM900 GSM 调制解调器获取 SMS 信息

> ID：11632736
> 
> 赞同：-1
> 
> 时间：2012-07-24T14:11:29.987
> 
> 标签：c#, .net, regex, at-command

我尝试从 AT+CMGR=X 返回的字符串中获取信息（其中 x 是 SIM 卡上的消息索引）

字符串是

```
\r\n+CMGR: \"REC UNREAD\",\"TrueID/TMN\",\"\",\"12/07/24,14:48:11+07\"
\r\n
003400310036003000300037003800350035003A0E170E230E390E210E310E190E190E35
0E4800200041002F00430020003000380030003900350037003200360036003800200E220E2D
0E140E400E070E340E190E040E070E400E2B0E250E370E2D002000340030002E0030003000200E1A0E320E17
\r\n\r\n
OK\r\n 
```

此字符串中有有用的信息。

REC READ 用于消息状态 SMS 的日期 SMS OK 消息的内容

并且知道我们可以使用 .NET Regular 组提取此信息。

我找到了有用的线程，但我无法将该线程中的模式调整为适合我的字符串的正确模式。

```
String pattern = @"(?<a>\+CMGL):[ ](\d*),\""
                         (?<b>[^\""]*)"",
                         (?<c>\d*),(?<d>\d*),\""
                         (?<e>\+\d*)"",(?<f>\d*),\""
                         (?<g>\d*\/\d*\/\d*,\d{2}:\d{2}:\d{2}\-\d{2})\"",\""
                         (?<h>\d{2}\/\d{2}\/\d{2}),?\r\n,?
                         (?<i>\d{2}:\d{2}:\d{2}\-\d{2})\"",
                         (?<j>\d*)";

    Regex rx = new Regex(pattern, RegexOptions.IgnorePatternWhitespace);
    Match m = rx.Match(testWord);
    while (m.Success)
    {
        Console.WriteLine(m.Groups["a"].Value);
        Console.WriteLine(m.Groups["b"].Value);
        Console.WriteLine(m.Groups["c"].Value);
        Console.WriteLine(m.Groups["d"].Value);
        Console.WriteLine(m.Groups["e"].Value);
        Console.WriteLine(m.Groups["f"].Value);
        Console.WriteLine(m.Groups["g"].Value);
        Console.WriteLine(m.Groups["h"].Value);
        Console.WriteLine(m.Groups["i"].Value);
        Console.WriteLine(m.Groups["j"].Value);
        Console.WriteLine("");
        m = m.NextMatch();
    }
    Console.ReadLine();
} 
```

来自[http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/d652b20d-471c-4640-967c-b5fe71e3a42c/](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/d652b20d-471c-4640-967c-b5fe71e3a42c/)

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:19:29.770

为什么不只是找到所有出现的模式`"([^"]+)"`和状态（*OK*）`(\S+)\s+$`

# php - 确定对象的类别

> ID：11632738
> 
> 赞同：0
> 
> 时间：2012-07-24T14:11:32.513
> 
> 标签：php, class, expression

它知道可以用`get_class($variable)`. 问题是 my`$object`实际上是一个包含变量名的字符串。

所以：

```
$object = new MyClass();

$var = '$object';

$class = get_class($var); // obviously fails 
```

我不能使用`get_class($object)`，因为我无法直接访问该变量（我正在使用 token_get_all()[解析 PHP 表达式](https://stackoverflow.com/questions/11632001/determine-elements-of-a-php-expression)`$var`来生成字符串）

我尝试使用`eval(sprintf('return get_class(%s);', $var))`，但它不起作用，因为变量在 eval 的范围内似乎未定义:(

有没有办法做到这一点？

我需要知道该类才能将其传递给 ReflectionMethod，这样我才能获取有关方法的信息（PHP 表达式中的下一个元素）。

* * *

NVM：我很确定这是不可能的。不好意思问了：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:15:26.093

你可以做

`$var = new $object();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T14:15:32.230

尝试使用变量变量： http: [//php.net/manual/en/language.variables.variable.php](http://php.net/manual/en/language.variables.variable.php)

就像是：

```
$var = 'object';
$class = get_class( $$var ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T14:15:41.707

您可以执行以下操作

```
$ref = ltrim($var, '$');
get_class($ref); 
```

# ssis - SSIS如何查找已删除的记录

> ID：11632739
> 
> 赞同：1
> 
> 时间：2012-07-24T14:11:31.987
> 
> 标签：ssis, dataflow

我有从源表到目标表的数据流。为了简化问题，我会说有两个合并连接的源表和一个目标表。此外，还有一些主键可以帮助我识别每条记录

该程序包每天都在运行，如果从源表中删除一条记录，我怎么知道删除了哪一条，以便我可以在目标表中删除它？

（仅供参考~~我已经检查目标表中是否存在记录，如果存在则更新其他插入，但不知道如何查找已删除的数据）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:45:31.330

将源与目标进行比较的问题在于，您必须在每次加载时将每个源行与目标行进行比较，并且随着行数的增加，这会占用越来越多的时间。

因此，处理此问题的最佳方法可能是在源端。两种[常见的方法](https://stackoverflow.com/questions/5402141/database-design-for-incremental-export-to-data-warehouse)是“软删除”，您可以在其中设置标志列以将行标记为已删除；或在日志表中记录已删除行的 PK 的触发器（或将整行移动到存档日志表）。然后，您的 ETL 过程查看标志或日志/归档表以确定自上次加载以来删除了哪些行。

另一种可能性是源平台提供了一些可用于跟踪已删除行的内置功能，例如SQL Server 中的[CDC](http://msdn.microsoft.com/en-us/library/bb522489%28v=sql.105%29.aspx)。但是，如果您完全无法控制源数据库（如果它甚至是数据库），那么除了比较完整的数据集之外可能别无选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T13:34:40.793

一种可能的方法：

1.  在运行包之前，删除目标表记录（使用存储过程）
2.  只需将所有记录导入目标表

优点：

您的目标表将始终镜像传入的数据，无需检查删除

缺点：

您将没有任何历史信息（如果需要）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T13:38:23.833

另一种可能的方法：

假设您从源接收所有记录，而不仅仅是导入和更新：

1.  修改包以标记已使用唯一 id 或运行日期时间插入或更新的记录

2.  在包运行之后，处理在上次包运行中未插入或更新记录的目标表。通过消除过程，应删除源文件中未提供的任何记录。

同样，假设发送了所有记录，而不仅仅是导入和更新。但是话又说回来，如果您没有收到所有记录，则实际上无法检测到记录是否已被删除。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-10-23T03:45:14.937

我遇到了同样的问题，例如如何将我的旧/存档记录标记为“已删除”，因为它们不再存在于原始数据源中。

基本上，我构建了两个表，其中一个是包含来自原始数据源的所有记录的主表，另一个是我每次运行脚本时保存的用于存储原始数据源的临时表。

**主表**

```
ID, NAME, SURNAME, DATE_MODIFIED, ORDERS_COUNT, etc
plus a STATUS column (1 for Active, 0 for Deleted) 
```

**TEMP TABLE**与原始相同，但没有 STATUS 列

```
ID, NAME, SURNAME, DATE_MODIFIED, ORDERS_COUNT, etc 
```

关键是如果 MAIN 表的 ID 不再在 Temp 表中，则使用**STATUS = 0**更新 MAIN TABLE 。即：源记录已被删除。

我是这样做的：

```
UPDATE m
SET m.Status = 0
FROM tblMAIN AS m
    LEFT JOIN tblTEMP AS t
        ON t.ID = m.ID
WHERE t.ID IS NULL 
```

# objective-c - 使用情节提要时重用 UIViewController 实例

> ID：11632740
> 
> 赞同：9
> 
> 时间：2012-07-24T14:11:37.617
> 
> 标签：objective-c, ios, uiviewcontroller

我决定在我当前的 iPhone 应用程序中使用故事板。我面临一个问题。我真的需要重用我的 UIViewController 实例。

我的意思是什么？好吧，例如我有一个表格视图控制器。当我点击一个单元格时，另一个视图控制器会从情节提要中加载并推送到导航控制器堆栈上。这一切都运作良好，但每次加载此视图控制器时大约需要半秒到一秒。在我使用故事板之前，我只是通过缓存创建的实例来解决这个问题，这样当你第二次点击一个单元格时，可以立即显示视图控制器。

通过缓存创建的实例，我的意思是这样的：

```
if (!cachedInstance) {
    cachedInstance = [MyViewController new];
}
[self.navigationController pushViewController:cachedInstance]; 
```

有谁知道如何使用情节提要完成此任务？提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T19:59:36.787

如果您正在使用转场，则需要创建自定义转场才能像以前一样使用缓存的视图控制器。否则，典型的“推送”segue 将为`segue.destinationViewController`. 如果您编写自定义`UIStoryboardSegue`类并使用`custom` `segue`s 您可以覆盖`initWithIdentifier:source:destination:`并将缓存的视图控制器放入`destinationViewController`, 然后覆盖`perform`以使用经典`pushViewController`调用。

如果您真的打算使用它们，这就是您处理 segue 的方式。不过我会跳过它，除非你真的想要花哨的箭头把所有东西都放在你的故事板上。如果你跳过它，你可以将视图控制器实例化到缓存中，然后像以前一样推送它们。

如果您的问题更多关于在情节提要中定位视图控制器，那么您可以使用：

```
UIViewController *vc = [[UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil] instantiateViewControllerWithIdentifier:@"Some View Controller"]; 
```

然后，您可以将其保存到缓存中并像在示例代码中那样推送它。

希望有帮助。

# java - 不太明白 InputStream.read( byte[], int, int ) 的工作原理

> ID：11632741
> 
> 赞同：1
> 
> 时间：2012-07-24T14:11:37.313
> 
> 标签：java, android, inputstream

我知道这是微不足道的，但对我来说没有意义。Java 不能将指针/引用作为参数传递，但 read() 函数传递的是 a `buffer into which the data is read`，并且只返回一个 int as `the total number of bytes read into the buffer`。

我期望从此设备读取五个单独的字节，但是当我将函数传递给缓冲区并在之后尝试访问它时，它仍然是`null`. 如果我从函数中打印出返回值，它会给我`int 5`，这是预期的。但是我怎样才能访问实际放入缓冲区的数据呢？

这是[JavaDocs](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/InputStream.html)的链接....

编辑：

这是对 read 函数的原始调用。

```
public boolean onOptionsItemSelected( MenuItem item ) {
    switch( item.getItemId() ) {
    case R.id.connect:
        startActivityForResult( new Intent( this, DeviceList.class ), 1 );
        return true;
    case R.id.readTest:
        Log.i(TAG,  "Before write." );
        byte[] b = {'$'};
        for( int i = 0 ; i < 3 ; i++ ) {
            mService.write( b );
        }
        Log.i(TAG, "After write." );
        return true;

    case R.id.readData:
        byte[] c = mService.read( 5 );

        Toast.makeText(this, Integer.toString( mService.bytes ), Toast.LENGTH_LONG).show();
    default:
        return super.onContextItemSelected( item );
    }
} 
```

注意，这个读取函数是在我的类中声明的一个函数，叫做 BluetoothService。该类包含另一个名为 ConnectedThread 的类，它调用 InputStream 读取...

这是我的阅读功能....

```
public byte[] read( int length ) {
    Log.i( TAG, "Inside read." );
    ConnectedThread r;
    buffer = null;
    synchronized( this ) {
        if( mState != STATE_CONNECTED ) return null;
        r = mConnectedThread;
    }
    Log.i(TAG,  "Before run." );
    r.run( length );
    Log.i( TAG, "After run." );
    Log.i( TAG, Integer.toString( bytes ) );
    return buffer;

} 
```

这是 ConnectedThread 类，它自己调用 read....

```
/**
 * This thread runs during a connection with a remote device.
 * It handles all incoming and outgoing transmissions.
 */
private class ConnectedThread extends Thread {
    private final BluetoothSocket mmSocket;
    private final InputStream mmInStream;
    private final OutputStream mmOutStream;

    public ConnectedThread(BluetoothSocket socket, String socketType) {
        Log.d(TAG, "create ConnectedThread: " + socketType);
        mmSocket = socket;
        InputStream tmpIn = null;
        OutputStream tmpOut = null;

        // Get the BluetoothSocket input and output streams
        try {
            tmpIn = socket.getInputStream();
            tmpOut = socket.getOutputStream();
        } catch (IOException e) {
            Log.e(TAG, "temp sockets not created", e);
        }

        mmInStream = tmpIn;
        mmOutStream = tmpOut;
    }

    public void run(int length) {
        Log.i(TAG, "BEGIN mConnectedThread");
        byte[] buffer = new byte[1024];

        // Keep listening to the InputStream while connected
        //while (true) {
            try {
                // Read from the InputStream
                bytes = mmInStream.read(buffer, 0, length);

                // Send the obtained bytes to the UI Activity
                mHandler.obtainMessage(MainMenu.MESSAGE_READ, bytes, -1, buffer)
                        .sendToTarget();
            } catch (IOException e) {
                Log.e(TAG, "disconnected", e);
                connectionLost();
                // Start the service over to restart listening mode
                BluetoothService.this.start();
                //break;
            }
       // }
            Log.i(TAG, "MADE IT HERE" );
    }

    /**
     * Write to the connected OutStream.
     * @param buffer  The bytes to write
     */
    public void write(byte[] buffer) {
        try {
            mmOutStream.write(buffer);

            // Share the sent message back to the UI Activity
            mHandler.obtainMessage(MainMenu.MESSAGE_WRITE, -1, -1, buffer)
                    .sendToTarget();
        } catch (IOException e) {
            Log.e(TAG, "Exception during write", e);
        }
    }

    public void cancel() {
        try {
            mmSocket.close();
        } catch (IOException e) {
            Log.e(TAG, "close() of connect socket failed", e);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T14:28:26.387

> Java 不能将指针/引用作为参数传递

是的，它可以。

像这样的基本误解*会让*你非常困惑......

`read(...)`应该使用的方式是这样的：

```
byte[] buffer = new byte[42];
int nosRead = is.read(buffer, 0, buffer.length); 
```

您分配一个缓冲区对象并将其作为参数传递给该`read`方法。从（在这种情况下）偏移量零开始读取字节并将其复制到缓冲区中。当方法调用返回时，它返回实际读取的字节数......并且字节在缓冲区中可供调用者处理。

如您所见，这*依赖*于将字节数组引用作为参数传递给`read`方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T14:20:31.723

您必须初始化数组，否则它将继续保持为空。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T14:24:52.620

也许您的 C 背景使您在正确调用 read() 时感到困惑。read(byte[]) 和 read(byte[] b, int offset, int len) 不是返回一个数组或使用指向指针的指针创建一个数组，而是期望一个实际的字节数组（在后一种形式中，大小更大或等于参数列表中的 offset+len)。假设从方法返回值 x，则从**offset**到**offset+x-1**的数组元素将在数组中定义（除非返回 -1，表示 EOF）。

# java - Java：合并两个排序的链表

> ID：11632742
> 
> 赞同：-1
> 
> 时间：2012-07-24T14:11:39.677
> 
> 标签：java, algorithm, merge, linked-list

我开发了一个代码来合并 java 中两个已经排序的链表。

我需要以下帮助：

1.  如何在不使用 tempNode 的情况下保留合并列表的头节点的值？
2.  这段代码可以更好地优化吗？

    ```
    public static ListNode mergeSortedListIteration(ListNode nodeA, ListNode nodeB) {
       ListNode mergedNode ;
       ListNode tempNode ;      

    if (nodeA == null) {
        return nodeB;
      } 
      if (nodeB == null) {
        return nodeA;
      }     

    if ( nodeA.getValue() < nodeB.getValue())
    {
        mergedNode = nodeA;
        nodeA = nodeA.getNext();
    }
    else
    {
        mergedNode = nodeB;
        nodeB = nodeB.getNext();
    }

    tempNode = mergedNode; 

    while (nodeA != null && nodeB != null)
    {           

        if ( nodeA.getValue() < nodeB.getValue())
        {               
            mergedNode.setNext(nodeA);
            nodeA = nodeA.getNext();
        }
        else
        {
            mergedNode.setNext(nodeB);
            nodeB = nodeB.getNext();                
        }       
        mergedNode = mergedNode.getNext();
    }

    if (nodeA != null)
    {
        mergedNode.setNext(nodeA);
    }

    if (nodeB != null)
    {
        mergedNode.setNext(nodeB);
    }       
    return tempNode;
    } 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T14:30:11.803

有几种可能：

1) 不要使用`mergedNode`来跟踪前一个节点，而是使用`nodeA.getNext().getValue()`and `nodeB.getNext().getValue()`。您的算法将变得更加复杂，您将不得不处理一些边缘情况，但可以消除您的变量之一。

2) 使用双向链表，然后使用`nodeA.getPrev().getValue()`and`nodeB.getPrev().getValue()`代替`mergedNode`. 您还必须在这里处理边缘情况。

为了处理边缘情况，您必须保证您的引用不可能`null`在调用`getPrev()`, `getNext()`or之前出现`getValue()`，否则您将抛出异常。

请注意，上述修改略微牺牲了执行时间和（更重要的是）简单性以消除变量。任何收益都是微不足道的，开发人员的时间远比减少一两微秒的操作时间重要得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T14:28:16.613

1：您必须保留第一个节点的记录，这意味着您必须将其存储在变量中，例如`tempNode`.

2：没有。这里没有太多需要优化的地方。这个过程很简单。

# ruby - 使用 tiny_TDS 在 Rails 中连接到 SQL-Azure：[BUG] 分段错误

> ID：11632743
> 
> 赞同：1
> 
> 时间：2012-07-24T14:11:40.117
> 
> 标签：ruby, ruby-on-rails-3, azure-sql-database, tiny-tds

我们正在尝试让 rails 与 Azure 上的 sqlserver 数据库通信，我们使用 openssl 和 libiconv 安装 freeTDS：

```
./configure --prefix=/usr/local --with-libiconv-prefix=DIR --with-openssl=DIR
make
make install 
```

然后我们将 tiny_TDS 和 activerecord-sqlserver-adapter 添加到 gemfile 中：

```
gem 'tiny_tds'
gem 'activerecord-sqlserver-adapter'

$ bundle install 
```

配置数据库：

```
development:  
  adapter: sqlserver
  host: xxxxxxx.database.windows.net
  mode: DBLIB
  port: 1433
  database: xxxxx
  username: xxxxxxxx
  password: x
  azure: true 
```

运行服务器：

```
$ rails s 
```

到目前为止，一切都很好，但是一旦您访问该站点，ruby 就会崩溃。

```
steven@jenny:~/irr$ rails server -p 3001
=> Booting WEBrick
=> Rails 3.0.4 application starting in development on http://0.0.0.0:3001
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2012-07-24 15:37:00] INFO  WEBrick 1.3.1
[2012-07-24 15:37:00] INFO  ruby 1.9.2 (2012-02-14) [x86_64-linux]
[2012-07-24 15:37:00] INFO  WEBrick::HTTPServer#start: pid=7586 port=3001
/home/steven/.rvm/gems/ruby-1.9.2-p318/gems/tiny_tds-0.5.1/lib/tiny_tds/client.rb:68: [BUG] Segmentation fault
ruby 1.9.2p318 (2012-02-14 revision 34678) [x86_64-linux]

-- control frame ----------
c:0048 p:---- s:0232 b:0232 l:000231 d:000231 CFUNC  :connect
c:0047 p:0429 s:0228 b:0228 l:000227 d:000227 METHOD /home/steven/.rvm/gems/ruby-1.9.2-p318/gems/tiny_tds-0.5.1/lib/tiny_tds/client.rb:68 
```

我们尝试了几个版本的 ruby​​：1.9.2-p318、1.9.2-p320、1.9.3-p125。他们都犯了同样的错误。

这是在 ubuntu 11.10 上使用 rvm 和 FreeTDS-0.9.1。

关于解决方法的任何想法？

我在途中的某个地方犯了错误吗？

### 编辑

IRB 的输出：

```
require 'tiny_tds'
client = TinyTds::Client.new(:username =>'XXXXX@XXXXXXX.database.windows.net', :password => 'XXXXXXX', :host => 'XXXXXX.database.windows.net',  :mode => 'DBLIB', :azure => 'true')
SystemStackError: stack level too deep from /home/martinr/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/irb/workspace.rb:80
Maybe IRB bug!! 
```

这似乎是红宝石本身的一个错误：

```
/home/martinr/.rvm/gems/ruby-1.9.2-p320/gems/tiny_tds-0.5.1/lib/tiny_tds/client.rb:68: [BUG] Segmentation fault (core dumped) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T11:49:05.547

你应该只做一个简单的 IRB 提示，然后做类似 TinyTDS 中提到的事情。

`require 'tiny_tds' client = TinyTds::Client.new(...)`

填写您的连接参数。简单的东西，如用户名、密码和主机。让我知道事情的进展。

*   [https://github.com/rails-sqlserver/activerecord-sqlserver-adapter/wiki/Using-Azure](https://github.com/rails-sqlserver/activerecord-sqlserver-adapter/wiki/Using-Azure)
*   [https://github.com/rails-sqlserver/tiny_tds#using-tinytds-with-azure](https://github.com/rails-sqlserver/tiny_tds#using-tinytds-with-azure)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-30T11:49:05.147

该错误似乎是由拥有用户名引起的`username@servername`

移除`@severname`零件后，ruby 不再崩溃

# proxy - 在 control4 我如何使用池代理

> ID：11632745
> 
> 赞同：0
> 
> 时间：2012-07-24T14:11:47.260
> 
> 标签：proxy, pool, home-automation

任何人都可以就池代理开发过程提供指导。由于提供的文档（代理和协议指南）仅解释了代理类，但需要更多帮助和开发池代理的方向。是否有任何路线图来说明如何为驱动程序或简单的场景开发我们自己的代理。

请指导上述查询，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T12:49:47.263

您需要成为 Control4 开发人员才能访问他们的 SDK，其中包括一个池模板。

# c - char [] 的初始化并使用它。我不想使用“字符串”

> ID：11632747
> 
> 赞同：-6
> 
> 时间：2012-07-24T14:11:48.910
> 
> 标签：c, c-strings

> **可能重复：**
> [char [length] 初始化和处理它](https://stackoverflow.com/questions/11632295/char-length-initialization-and-dealing-with-it)

我有：

```
char d[7]; 
```

以下内容有什么问题：

此时没有为变量分配内存`d`。现在我要初始化它：

```
d="bbbbbb"; 
```

在这种类型初始化之后，就不需要释放内存了；它会自动完成。

怎么知道被`char[]`初始化了？我需要一个像

```
if (filled(d)){..} 
```

如何填充`char[]`一种字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:15:30.050

好的，如果你想用'b'字符填充你的字符，你可以这样做

```
 char d[7];
  int i;
  for (i = 0; i < 7; i++) {
      d[i] = 'b';
  } 
```

# node.js - SVG 到 PNG 服务器端 - 使用 node.js

> ID：11632748
> 
> 赞同：25
> 
> 时间：2012-07-24T14:11:52.783
> 
> 标签：node.js, d3.js

我正在尝试按照本教程将 d3.js SVG Vis 转换为 PNG 服务器端（使用 Node.js）[http://eng.wealthfront.com/2011/12/converting-dynamic-svg-to- png-with.html](http://eng.wealthfront.com/2011/12/converting-dynamic-svg-to-png-with.html)

**完整代码链接：** [https ://gist.github.com/1509145](https://gist.github.com/1509145)

但是，每当我尝试请求加载我的页面时，我都会收到此**错误**

```
 /Users/me/Node/node_modules/jsdom/lib/jsdom.js:171
        features   = JSON.parse(JSON.stringify(window.document.implementation._fea
                                                              ^
    TypeError: Cannot read property 'implementation' of undefined
        at exports.env.exports.jsdom.env.processHTML (/Users/dereklo/Node/node_modules/jsdom/lib/jsdom.js:171:59)
        at Object.exports.env.exports.jsdom.env (/Users/dereklo/Node/node_modules/jsdom/lib/jsdom.js:262:5)
        at Server.<anonymous> (/Users/dereklo/Node/Pie/pie_serv.js:26:9)
        at Server.EventEmitter.emit (events.js:91:17)
        at HTTPParser.parser.onIncoming (http.js:1785:12)
        at HTTPParser.parserOnHeadersComplete [as onHeadersComplete] (http.js:111:23)
        at Socket.socket.ondata (http. 
```

有人知道为什么会这样吗？我已经很好地安装了 jsdom 模块，所以我真的不知道是什么导致了这些问题……在此先感谢。

**编辑**

这是我用来实现 node.js 服务器的代码。我的最新一期在此来源下方...

```
var http = require('http'),
    url = require('url'),
    jsdom = require('jsdom'),
    child_proc = require('child_process'),
    w = 400,
    h = 400,
    __dirname = "Users/dereklo/Node/pie/"

   scripts = ["/Users/dereklo/Node/pie/d3.min.js",
               "/Users/dereklo/Node/pie/d3.layout.min.js",
               "/Users/dereklo/Node/pie/pie.js"],
      //scripts = ["./d3.v2.js",
        //         "./d3.layout.min.js",
          //       "./pie.js"]

    htmlStub = '<!DOCTYPE html><div id="pie" style="width:'+w+'px;height:'+h+'px;"></div>';

http.createServer(function (req, res) {

  res.writeHead(200, {'Content-Type': 'image/png'});
  var convert = child_proc.spawn("convert", ["svg:", "png:-"]),
      values = (url.parse(req.url, true).query['values'] || ".5,.5")
        .split(",")
        .map(function(v){return parseFloat(v)});

  convert.stdout.on('data', function (data) {
    res.write(data);
  });
  convert.on('exit', function(code) {
    res.end();
  });

  jsdom.env({features:{QuerySelector:true}, html:htmlStub, scripts:scripts, done:function(errors, window) {
    var svgsrc = window.insertPie("#pie", w, h, values).innerHTML;

  console.log("svgsrc",svgsrc);

    //jsdom's domToHTML will lowercase element names
    svgsrc = svgsrc.replace(/radialgradient/g,'radialGradient');
    convert.stdin.write(svgsrc);
    convert.stdin.end();
  }});
}).listen(8888, "127.0.0.1");

console.log('Pie SVG server running at http://127.0.0.1:8888/');
console.log('ex. http://127.0.0.1:8888/?values=.4,.3,.2,.1'); 
```

**最新一期**

```
 events.js:66
        throw arguments[1]; // Unhandled 'error' event
                       ^
Error: This socket is closed.
    at Socket._write (net.js:519:19)
    at Socket.write (net.js:511:15)
    at http.createServer.jsdom.env.done (/Users/dereklo/Node/Pie/pie_serv.js:38:19)
    at exports.env.exports.jsdom.env.scriptComplete (/Users/dereklo/Node/node_modules/jsdom/lib/jsdom.js:199:39) 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-07-25T15:02:44.157

如果您取消“使用 node.js”的规定，这可能会成为您问题的有用答案。如果它对您没有帮助，也许以后的访问者会觉得它很有趣。

我一直在努力解决同样的问题（服务器端 d3 光栅化），我发现[PhantomJS](http://phantomjs.org/)是最好的解决方案。

server.js：

```
var page = require('webpage').create(),
    renderElement = require('./renderElement.js'),
    Routes = require('./Routes.js'),
    app = new Routes();

page.viewportSize = {width: 1000, height: 1000};
page.open('./d3shell.html');

app.post('/', function(req, res) {
    page.evaluate(new Function(req.post.d3));
    var pic = renderElement(page, '#Viewport');
    res.send(pic);
});

app.listen(8000);

console.log('Listening on port 8000.'); 
```

Routes.js：[https](https://gist.github.com/3061477)
://gist.github.com/3061477 renderElement.js：[https ://gist.github.com/3176500](https://gist.github.com/3176500)

d3shell.html 应该类似于：

```
<!DOCTYPE HTML>
<html>
<head>
    <title>Shell</title>
</head>
<body>
    <div id="Viewport" style="display: inline-block"></div>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/d3/2.8.1/d3.v2.min.js" type="text/javascript"></script>
</body>
</html> 
```

然后，您可以使用`phantomjs server.js`POST d3=[渲染到#Viewport 的 d3 代码] 启动服务器，服务器将以 base64 编码的 png 进行响应。

（需要 PhantomJS 1.7 或更高版本。）

# concrete5 - 使用concrete5在插件contact_directory中提交表单后找不到页面错误？

> ID：11632757
> 
> 赞同：0
> 
> 时间：2012-07-24T14:12:18.293
> 
> 标签：concrete5, concrete

我已经使用concrete5购买了附加模块contact_directory，现在我需要根据我的要求进行定制。

所以我需要更改文件包\contact_directory\blocks\contact_directory\view.php，我在 view.php 文件所在的同一目录中创建了 test.php 文件，所以我的表单标签是 url('contact_directory/test')？ >">

所以请告诉我哪里错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:03:44.517

Concrete5 对块使用松散的 MVC 架构。这意味着，与“普通的旧”php 站点不同，在这些站点中，您有一个在访问某个 URL 时运行的文件，您的块的控制器总是被调用。但是你可以在控制器中拥有不同的函数来响应不同的 url，在 C5 世界中这些被称为动作。

因此，在您的块的 view.php 文件中，将您的表单标签更改为：

```
<form method="post" action="<?php echo $this->action('test'); ?>"> 
```

然后在controller.php 文件中，创建一个名为“action_”的新公共函数，后跟您传递给表单标签的内容。在您的示例中，这将是：

```
public function action_test() {
    //do stuff here
} 
```

现在你会遇到一个问题，因为 Concrete5 块*总是*呈现“view.php”模板（例如，没有简单的方法告诉它使用“test.php”文件）。这里最简单的解决方案是使用“if”语句将两个模板组合到您的 view.php 文件中。例如：

```
<?php defined('C5_EXECUTE') or die(_("Access Denied.")); ?>

<?php if ($controller->getTask() == 'test'): ?>

    <!-- Put all of the code from your test.php file here -->

<?php else: ?>

    <!-- Put all the code from your view.php file here -->

<?php endif; ?> 
```

需要注意的一件事 - 如果您的块被放置在页面默认值或全局区域（或堆栈）中，那么表单操作可能不会提交到正确的位置。不过我不确定——这是我在版本 5.4.2 中遇到的问题，但从那时起它可能已经修复。

PS - 如果您想查看一些在 C5 块中使用此表单处理内容的示例代码，请下载我的免费电子邮件列表注册插件（[http://www.concrete5.org/marketplace/addons/email-list-signup](http://www.concrete5.org/marketplace/addons/email-list-signup)）。

# xml - 休眠 XML 数组列表

> ID：11632758
> 
> 赞同：0
> 
> 时间：2012-07-24T14:12:26.337
> 
> 标签：xml, hibernate, arraylist

我的应用程序中有这种关系：

```
Entry 1:n Guest 
```

`Entry.class`包含以下属性：

```
Entry {
  ...
  List<Guest> guestList = new ArrayList<Guest>();
  ...
} 
```

我想将此`guestList`属性配置为在 Hibernate 中进行延迟加载，但它不起作用。这是我所拥有的：

```
<class name="...." table="entry">
  <id name="id" column="entry_id" type='long'>
    <generator class="native" />
  </id>

  ...other properties...

  <list name="guestList" table="guest" cascade="all">
    <key column="entry_fk"/>
    <index column="guest_id"/>
    <one-to-many class="Guest"/>
  </list>

  ...other properties...

</class> 
```

下面是 Guest 表模式的描述：

```
table : guest[guest_id,entry_fk,guestName,...] 
```

顺便一提...

*   我不能在这个项目中使用注释。
*   最好，我想使用延迟加载（只要它工作）
*   我的表中没有索引，但 Hibernate 一直要求这个定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T05:54:41.087

我对 XML 映射没有任何经验，但我看到至少两个错误：

1.  您的字段应声明为`List<Guest>`，以允许 Hibernate 注入其自己的延迟加载列表实现（始终使用接口而不是创建类型是最佳实践，但 Hibernate 必须这样做）
2.  如果是列表，则需要索引。否则，它是一个袋子。该索引应该保存列表中来宾的索引。ID 不是索引。

[否则，文档](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#assoc-unidirectional-12m)中描述了一对多映射。`set`将示例中的替换为`bag`，应该没问题。

# mysql - MySql 中数字范围的最佳索引类型

> ID：11632759
> 
> 赞同：0
> 
> 时间：2012-07-24T14:12:26.700
> 
> 标签：mysql, indexing

什么存储类型（BTREE、RTREE、HASH）对于“from”和“to”来说是最好的（以及**为什么**）从这样的查询中获得最快的结果：

```
SELECT `title`, `from`, `to` FROM `table_name`
WHERE @year >= `from` AND @year <= `to` 
```

@year 是要替换为数字的参数

和

所有数字（@year、from、to）都是浮点数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:18:01.673

PRIMARY KEY 或 UNIQUE 和覆盖索引将使用 BTREE 将最适合这种类型的查询。

```
ALTER TABLE ADD PRIMARY KEY ix1(from, to, title); 
```

或者

```
ALTER TABLE ADD UNIQUE KEY ix1(from, to, title) USING BTREE; 
```

对于覆盖索引，您首先添加在 where 子句中使用的列，然后是在 group 中使用的列，然后是在 order by 中使用的列，然后是在 select 中使用的列。

`HASH index`最适合`EQUAL`搜索，`BTREE index`最适合`range search`.

# sql - SQL 查询（使用连接）/递归

> ID：11632762
> 
> 赞同：0
> 
> 时间：2012-07-24T14:12:51.233
> 
> 标签：sql, sql-server, tsql, join

我有 3 个表：AuditCheckCriteria 作为 T1，Learners 作为 T2 和 LearnerAuditRegistrations 作为 T3，结构如下：

```
 T1: CheckID     CheckName                      
          1       'Stage One'
          2       'Stage Two'
          3       'Stage Three'

  T2   LearnerID   LearnerName
          10         'John'
          11         'Peter'
          12         'Paul'

  T3: LearnerAuditID  LearnerID  CheckID
          1             10         1
          2             10         2
          3             11         1
          4             11         2
          5             11         3 
```

我想要以下输出：

```
T2.LearnerID, T1.CheckID, T3.CheckID
      10           1           1
      10           2           2
      10           3          NULL
      11           1           1
      11           2           2
      11           3           3
      12           1          NULL
      12           2          NULL
      12           3          NULL 
```

（T2 和 T3 各包含超过 20000 行）

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:20:06.340

看起来您想要 T1 和 T2 中的所有值组合，并从 T3 中查找。如果是这样，则执行以下操作：

```
with t1vals as (select distinct checkID from t1),
     t2vals as (select distinct LearnerId from t2)
select t2vals.LearnerId, t1vals.CheckId, t3.CheckId
from t1vals cross join
     t2vals left outer join
     t3
     on t3.LearnerId = t2vals.LearnerId and
        t3.CheckId = t1vals.CheckId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:18:49.803

使用（T2 交叉连接 T1）左连接 T3..

# javascript - Javascript数组过滤器：正确获取上下文

> ID：11632764
> 
> 赞同：2
> 
> 时间：2012-07-24T14:12:53.460
> 
> 标签：javascript, functional-programming

在尝试编写一些很棒的 JS 时，我遇到了一些奇怪的 JS 行为。我创建了一段代码来演示我的问题：

[http://jsfiddle.net/CeyCy/](http://jsfiddle.net/CeyCy/)

```
<html>
  <head>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
      var images = $('.images').children();
      var filtered = images.filter(function(i, image) {
        console.log(this);
      }, "abc");
    });
    </script>
  </head>
  <body>
    <div class="options">
      <div class="filters">
      </div>
      <ol class="pagination">
      </ol>
    </div>
    <div class="results">
      <ul class="images">
        <li data-category="Zakelijk">Result 1</li>
        <li data-category="Speels">Result 2</li>
        <li data-category="Blogging">Result 3</li>
        <li data-category="Zakelijk">Result 4</li>
        <li data-category="Speels">Result 5</li>
        <li data-category="Blogging">Result 6</li>
        <li data-category="Zakelijk">Result 7</li>
        <li data-category="Speels">Result 8</li>
        <li data-category="Blogging">Result 9</li>
        <li data-category="Zakelijk">Result 10</li>
        <li data-category="Speels">Result 11</li>
        <li data-category="Blogging">Result 12</li>
        <li data-category="Zakelijk">Result 13</li>
        <li data-category="Speels">Result 14</li>
        <li data-category="Blogging">Result 15</li>
      </ul>
    </div>
  </body>
</html> 
```

好的，现在我的问题。使用 Array.filter 方法时，您传入一个回调函数作为第一个参数，并将一个可选上下文作为第二个参数。如您所见，我将“abc”作为上下文传递（当然这很荒谬）。我希望我的控制台会抛出很多“abc”，但它会打印 jQuery 元素！

有人可以对此有所了解吗？

谢谢，

马汀

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T14:15:19.073

> 如您所见，我将“abc”作为上下文传递（当然这很荒谬）。我希望我的控制台会抛出很多“abc”，但它会打印 jQuery 元素！

您正在使用[jQuery's`filter`](http://api.jquery.com/filter/)，它没有上下文参数，而不是 ES5's [`Array#filter`](http://ecma-international.org/ecma-262/5.1/#sec-15.4.4.20)，因为您正在调用`filter`jQuery 对象，并且 jQuery 对象不是数组（尽管它们提供了很多类似数组的功能，并且有几个“方法”具有相似的名称 — 包括`filter`)。

三个选项供您选择：

### `makeArray`

您可以使用 jQuery[`makeArray`](http://api.jquery.com/jQuery.makeArray/)将 jQuery 对象转换为数组，例如：

```
$(function() {
  var images = $.makeArray($('.images').children());
  var filtered = images.filter(function(i, image) {
    console.log(this);
  }, "abc");
}); 
```

[更新的小提琴](http://jsfiddle.net/CeyCy/1/)

### `proxy`/`bind`

或者，您可以使用 jQuery 的[`proxy`](http://api.jquery.com/jQuery.proxy/)函数（或 ES5 的[`Function#bind`](http://ecma-international.org/ecma-262/5.1/#sec-15.3.4.5)）绑定您传递给 jQuery 的迭代器函数，`filter`这样它就会忽略`this`jQuery 提供的：

```
$(function() {
  var images = $('.images').children();
  var filtered = images.filter($.proxy(function(i, image) {
    console.log(this);
  }, "abc"));
}); 
```

### 应用于`Array#filter`jQuery 对象

**或者**你可以`Array#filter`直接应用到 jQuery 对象：

```
$(function() {
  var images = $('.images').children();
  var filtered = Array.prototype.filter.call(images, function(i, image) {
    console.log(this);
  }, "abc");
}); 
```

...因为`Array#filter`被*明确定义*为适用于任何类似数组的东西，而不仅仅是`Array`s。最后一个实际上可能是最有效的方法。[小提琴](http://jsfiddle.net/CeyCy/3/)

# c# - 即使重新启动机器后，如何将值永久存储在变量中？

> ID：11632768
> 
> 赞同：1
> 
> 时间：2012-07-24T14:13:08.620
> 
> 标签：c#

我想将值永久存储在变量中。同一个变量应该能够被用户编辑和保存，无论它是什么，我都需要上次修改它时的变量值，比如数据库。请用一些例子来解释我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T14:15:16.540

你不能。您需要持久存储（数据库、文件、注册表等）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T14:15:33.603

您需要在重新启动计算机时将其序列化的地方持续存在，然后在程序再次启动时读取它。这可能是一个数据库，（对于更简单的数据库，请查看[SQLite](http://www.sqlite.org/)之类的东西）一个 XML 文件等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T14:15:10.120

根据您的应用程序，您可以将变量保存在配置文件或数据库中。

在您的应用程序再次启动后，您将加载设置。

*   [MSDN - 应用程序设置概述](http://msdn.microsoft.com/en-us/library/k4s6c3a0.aspx)
*   [c# 将用户设置存储在数据库中](https://stackoverflow.com/questions/171352/c-sharp-store-user-settings-in-database)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-24T14:15:28.017

将数据写入文件。当您重新启动应用程序时，您可以从此文件中读取参数并设置一些变量。

文件可能意味着 - sql、db、ini 或您正在使用的任何内容。

祝一切顺利

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-24T14:16:30.127

您可以使用[Properties.Settings](http://msdn.microsoft.com/en-us/library/aa730869%28v=vs.80%29.aspx)的优点是您可以为每个用户范围保存一个变量或同时具有应用程序范围

```
internal class Program
    {
        private static void Main(string[] args)
        {
            Properties.Settings1.Default.Test = "StackOverFlow";
            Properties.Settings1.Default.Save();
            Console.ReadKey();
        }
    } 
```

# php - PHP Pack/unpack - 它可以处理可变长度的字符串吗

> ID：11632773
> 
> 赞同：3
> 
> 时间：2012-07-24T14:13:40.440
> 
> 标签：php, pack, unpack

我一直试图弄清楚 Pack/Unpack 的 PHP 实现是否可以做一些 Perl 版本可以做的事情。我希望能够在 PHP 中执行的示例是：

[http://perldoc.perl.org/perlpacktut.html#String-Lengths](http://perldoc.perl.org/perlpacktut.html#String-Lengths)

```
# pack a message: ASCIIZ, ASCIIZ, length/string, byte
my $msg = pack( 'Z* Z* C/A* C', $src, $dst, $sm, $prio );
# unpack
( $src, $dst, $sm, $prio ) = unpack( 'Z* Z* C/A* C', $msg ); 
```

这个 Perl 代码的作用被描述为：

> 将两个包代码与斜杠 (/) 组合在一起，将它们与参数列表中的单个值相关联。在pack中，参数的长度是按照第一个代码来打包的，而参数本身是在斜杠后面用模板代码转换后添加的。

即，您可以打包可变长度的字符串，然后在一个步骤中解压缩它们，而不必先计算字符串的长度，然后将其作为单独的步骤提取。

PHP 手册没有提到此功能，任何尝试将“C/A*”之类的模式插入 unpack 都会给我带来错误。这是手册中的疏忽还是只是 PHP 版本不支持的内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T14:36:11.993

不幸的是，PHP 打包和解包函数不提供像 Perl 这样的变量（以空结尾）字符串的自动打包和解包。

为了适应此功能，请考虑将 unpack 函数包装到一个辅助类中，如下所示：

```
class Packer {
    static function unpack($mask, $data, &$pos) {
        try {
            $result = array();
            $pos = 0;
            foreach($mask as $field) {
                $subject = substr($data, $pos);
                $type = $field[0];
                $name = $field[1];
                switch($type) {
                    case 'N':
                    case 'n':
                    case 'C':
                    case 'c':
                        $temp = unpack("{$type}temp", $subject);
                        $result[$name] = $temp['temp'];
                        if($type=='N') {
                            $result[$name] = (int)$result[$name];
                        }

                        $pos += ($type=='N' ? 4 : ($type=='n' ? 2 : 1));
                        break;
                    case 'a':
                        $nullPos = strpos($subject, "\0") + 1;
                        $temp = unpack("a{$nullPos}temp", $subject);
                        $result[$name] = $temp['temp'];
                        $pos += $nullPos;
                        break;
                }
            }
            return $result;
        } catch(Exception $e) {
            $message = $e->getMessage();
            throw new Exception("unpack failed with error '{$message}'");
        }
    }
} 
```

请注意，此函数并未实现所有解包类型，仅作为示例。

# c# - 在代码中访问 .webtestResult 文件中包含的信息

> ID：11632777
> 
> 赞同：0
> 
> 时间：2012-07-24T14:14:04.550
> 
> 标签：c#, visual-studio-2010, .net-4.0, webtest

我想以编程方式检索与测试结果相关的信息。测试运行后，我想查看测试结果，对于每个失败的测试，获取失败测试的名称、失败的原因（验证规则消息或提取规则消息）以及包含的一个键的值在测试环境中。

我找不到任何可以用来挖掘 trx 和 webtestResult 文件的东西。有人对我有任何提示吗？

谢谢，保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T15:23:10.070

在搜索了更多之后，我发现了这个： [https ://blogs.msdn.microsoft.com/slumley/2009/11/11/vsts-2010-feature-api-for-processing-web-test-results/](https://blogs.msdn.microsoft.com/slumley/2009/11/11/vsts-2010-feature-api-for-processing-web-test-results/)

RequestResult 属性返回一个 WebTestRequestResult 对象，该对象公开 2 个属性，ValidationRuleResults 和 ExtractionRuleResults，通过它们可以检索所需的信息。

# mysql - MySQL - 在哪些列上使用索引

> ID：11632778
> 
> 赞同：0
> 
> 时间：2012-07-24T14:14:08.140
> 
> 标签：mysql, indexing

我有一个这样的查询：

```
SELECT 
  `Games`.`id`, `Games`.`name`, `Games`.`url` 
FROM 
  `Games`
LEFT JOIN 
  `GamesRuns` 
ON 
  Games.id = GamesRuns.game_id 
WHERE 
  (GamesRuns.date >= '2012-07-17 13:14:08') AND (Games.score = 0) AND (Games.active = 1) AND (Games.display = 1) 
GROUP BY 
  `Games`.`id` 
ORDER BY 
  SUM(GamesRuns.count) DESC 
LIMIT 5; 
```

我想问我应该在哪些列上放置索引。我认为它应该在 GamesRuns.date 和 Games.score + Games.active + Games.display 上作为多索引。而且我认为在 GamesRuns.count 上放置索引是没有意义的，因为它在 SUM 函数中，但除此之外（没有 SUM 函数）也应该有一个索引。这样对吗？因为当我使用 EXPLAIN 时，它告诉我 possible_key 和 key 是 PRIMARY，但 PRIMARY 只是 Games.id。谢谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:19:32.923

一般来说，如果可能的话，你会想要一个用于连接的任何东西的索引，以及在哪里使用的任何东西。

据我所知，MySql 不支持函数索引（我实际上并没有使用它），所以你不能在 SUM 函数上放置索引。如果我错了，有人会纠正我，我敢肯定

因此，对于您的示例，我会在 Games.id、GamesRuns.game_id、GamesRuns.date、Games.score、Games.active、Games.display 上放置一个索引

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:19:38.560

因为您在 where 和 group by 中使用了字段 games.id，所以该字段应该是好的。

还有字段gamesruns.game_id。

date、score 和 active 和 display 也是候选。但在这种情况下，你应该注意你有多少记录。因此，其余的取决于您，并取决于对数据的更深入研究。

一切顺利

# android - NPE 使用线程将内容视图设置为任何新活动

> ID：11632779
> 
> 赞同：0
> 
> 时间：2012-07-24T14:14:10.897
> 
> 标签：android, multithreading, android-asynctask

我使用线程和支架来下载一些数据，然后显示一个带有按钮的新视图，这些按钮允许您进一步浏览应用程序。但我认为我做错了什么，因为我使用的任何下一个活动都会在 setContentView 行上因空指针异常而崩溃。当我评论这一行时，没有任何问题（所以我猜这意味着该活动在清单中被声明为良好并正常启动）。看起来由于线程的原因，新活动没有地方可以设置内容或其他东西..

```
import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Collections;
import java.util.List;
import java.util.Locale;

import org.codehaus.jackson.JsonParseException;
import org.codehaus.jackson.map.ObjectMapper;
import org.codehaus.jackson.type.TypeReference;

import com.hera.ontdekdelft.model.JJsonResponse;
import com.hera.ontdekdelft.listclasses.ListData;

import android.app.Activity;
import android.content.Intent;
import android.content.res.AssetManager;
import android.graphics.drawable.Drawable;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.ProgressBar;
import android.widget.RelativeLayout;
import android.widget.TextView;

public class StartUp extends Activity
  {
    private static final String tag = StartUp.class.getName();
     public static final String SERIALIZEDDATA = "SerializedData";
     ProgressBar pbar;
     TextView tv1;
     Drawable background;
     Button btCategory, btMakeMyDay;
     RelativeLayout loadedBackground, loadingBackground;

    @Override
    public void onCreate(Bundle savedInstanceState)
      {
        super.onCreate(savedInstanceState);
        LoadData task = new LoadData();
        task.execute();

        String language =  Locale.getDefault().getISO3Language();
        background = getBackgroundImage();

            setContentView(R.layout.startup_loading);
            tv1=(TextView)findViewById(R.id.tvloading);
            if(language.equals("nld")){
                tv1.setText("bijwerken");
            }else{
                tv1.setText("loading");
            }
            pbar=(ProgressBar)findViewById(R.id.progressBar1);
            pbar.setVisibility(1);
            loadingBackground=(RelativeLayout)findViewById(R.id.startup_background_loading);
            loadingBackground.setBackgroundDrawable(background);

        }

    public Drawable getBackgroundImage(){
        Drawable d;
        Calendar c = Calendar.getInstance(); 
        int month = c.get(Calendar.MONTH);
        Log.i("month",String.valueOf(month));
        switch (month){
        default: d = getResources().getDrawable(R.drawable.homescreen_summer);break;
        case 0:d = getResources().getDrawable(R.drawable.homescreen_winter);break;
        case 1:d = getResources().getDrawable(R.drawable.homescreen_winter); break;
        case 2:d = getResources().getDrawable(R.drawable.homescreen_spring);break;
        case 3:d = getResources().getDrawable(R.drawable.homescreen_spring);break;
        case 4:d = getResources().getDrawable(R.drawable.homescreen_spring);break;
        case 5:d = getResources().getDrawable(R.drawable.homescreen_summer); break;
        case 6:d = getResources().getDrawable(R.drawable.homescreen_summer); break;
        case 7:d = getResources().getDrawable(R.drawable.homescreen_summer); break;
        case 8:d = getResources().getDrawable(R.drawable.homescreen_autumn); break;
        case 9:d = getResources().getDrawable(R.drawable.homescreen_autumn); break;
        case 10:d = getResources().getDrawable(R.drawable.homescreen_autumn); break;
        case 11:d = getResources().getDrawable(R.drawable.homescreen_winter); break;
        }
        return d;

    }

    private class LoadData extends AsyncTask<Void, Void, String> {

        @Override
        protected void onPreExecute() {

            super.onPreExecute();
        }

        protected void onPostExecute(String language) {
            super.onPostExecute(language);
            setContentView(R.layout.startup_loaded); 
            btCategory=(Button)findViewById(R.id.btn_category);
            loadedBackground=(RelativeLayout)findViewById(R.id.startup_background_loaded);
            loadedBackground.setBackgroundDrawable(background);
            if(language.equals("nld")){
                btCategory.setText("Ontdek Delft");
            }else{
                btCategory.setText("Discover Delft");
            }

              //newactivitybutton

            btCategory.setOnClickListener(new View.OnClickListener() {

                @Override
                public void onClick(View v) {
                    // TODO Auto-generated method stub
                    startActivity(new Intent(StartUp.this, Overview.class));
                    finish();   
                }
            });

        }

        @Override
        protected String doInBackground(Void... params) {
            String language =  Locale.getDefault().getISO3Language();
             AssetManager assetManager = getAssets();
                InputStream inputStream = null;
                try {
                    inputStream = assetManager.open("originalDelftJson.json");
                } catch (IOException e) {
                    Log.e("tag", e.getMessage());
                }
                ObjectMapper objectMapper = new ObjectMapper();
                Log.i("tijdlog","start parsing" );
                try {

                     List<JJsonResponse> jsonResponse = objectMapper.readValue(inputStream, new TypeReference<List<JJsonResponse>>() { });
                        Log.i("tijdlog","einde parsing" );
                        // 
                          final  List<JJsonResponse> myGlobalVariable = jsonResponse;

                          ((ApplicationController)getApplication()).setGlobalData(myGlobalVariable);

                          List<ListData> ld = new ArrayList<ListData>();
                         int selectedPic;
                         JJsonResponse e;
                         int k =0;
                         for(int i=0;i < jsonResponse.size() ;i++){
                             e = jsonResponse.get(i);
                             for(int j=0; j<e.venue.themes.size();j++){
                                 if (e.venue.themes.get(j).mobile == true){
                                     selectedPic = 0;
                                     String tip;
                                     String theme;
                                     if (language.equalsIgnoreCase("nld")){
                                         tip=e.venue.tip; 
                                         theme=e.venue.themes.get(j).name;
                                     }else{
                                         tip=e.venue.tip_en;
                                         theme=e.venue.themes.get(j).name_en;
                                     }
                                     // pic selected pic
                                     String photoUrl = null;
                                     if (e.venue.venue_photos.isEmpty() == false){
                                        for(int l=0; l < e.venue.venue_photos.size() ;l++){
                                             if(e.venue.venue_photos.get(l).selected == true){ 
                                                 selectedPic = l;
                                             }
                                             photoUrl=e.venue.venue_photos.get(selectedPic).medium;
                                         }
                                     }else
                                         {
                                         photoUrl=null; // null no pic--> add link later
                                       }
                                     ld.add(new ListData(e.venue.id, e.venue.name, photoUrl, tip, theme));//nieuwe maken
                                     k++;
                                 }  
                             } 
                         }

                         Collections.sort(ld, ListData.ListDataThemeAndNameComparator); // vergelijken op thema
                         for(int z=0;z < ld.size() ;z++){
                             Log.i("ld nr " + String.valueOf(z), ld.get(z).name + " theme: " + ld.get(z).theme + " & venue id= "+ ld.get(z).venueID);
                         }

                // save
                         ((ApplicationController)getApplication()).setListData(ld);  

                } catch (JsonParseException e) {
                    // XXX Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // XXX Auto-generated catch block
                    e.printStackTrace();
                }
            return language;
        }

    } 
```

}

发生我的错误的新活动：

> 导入android.app.Activity；导入android.os.Bundle；
> 
> 公共类概述扩展了活动{
> 
> @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(findViewById(R.layout.splash)); }
> 
> }

xml 飞溅；

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:background="@drawable/splash"
    >

</LinearLayout> 
```

**编辑：** 我编辑了我的代码。现在使用 AsyncTask，它似乎是下面建议的 LuxuryMode 之类的解决方案，但它也不起作用。setContentView 时仍然相同的 nullpointerexception... 错误日志：

```
07-24 19:53:50.411: E/AndroidRuntime(29618): FATAL EXCEPTION: main
07-24 19:53:50.411: E/AndroidRuntime(29618): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.hera.ontdekdelft/com.hera.ontdekdelft.Overview}: java.lang.NullPointerException
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2787)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2803)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.app.ActivityThread.access$2300(ActivityThread.java:135)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2136)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.os.Handler.dispatchMessage(Handler.java:99)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.os.Looper.loop(Looper.java:144)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.app.ActivityThread.main(ActivityThread.java:4937)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at java.lang.reflect.Method.invokeNative(Native Method)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at java.lang.reflect.Method.invoke(Method.java:521)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at dalvik.system.NativeStart.main(Native Method)
07-24 19:53:50.411: E/AndroidRuntime(29618): Caused by: java.lang.NullPointerException
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.view.ViewGroup.addViewInner(ViewGroup.java:1977)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.view.ViewGroup.addView(ViewGroup.java:1873)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.view.ViewGroup.addView(ViewGroup.java:1853)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:226)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:216)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.app.Activity.setContentView(Activity.java:1665)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at com.hera.ontdekdelft.Overview.onCreate(Overview.java:12)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1069)
07-24 19:53:50.411: E/AndroidRuntime(29618):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2751)
07-24 19:53:50.411: E/AndroidRuntime(29618):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:20:54.380

Android 线程模型中有两条规则：**1) 不要阻塞主 (UI) 线程 2) 不要从主 (UI) 线程之外操作 UI。**您似乎对第二条规则有疑问。您可以尝试使用 Activity#runOnUiThread(Runnable) 而不是使用该处理程序，但总的来说，您正在做的事情真的很混乱，而且通常是一个糟糕的主意:) 此外，除非我遗漏了什么，否则您的处理程序到底如何如果您在启动线程后对其进行初始化，是否可以在启动线程中使用它？您似乎依赖于某种方式的线程调度，这也是一个坏主意。

很可能，您需要使用的是`AsyncTask`. 立即在 onCreate 中设置您的内容视图，然后执行您`AsyncTask`下载数据的内容。然后在您的任务的 onPostExecute 中，执行任何必要的相关 UI 更改。

更新 -

在 onPostExecute 中，立即调用 super。另外，不要通过调用来启动您的活动 `startActivity(new Intent ("com.hera.ontdekdelft.OVERVIEW"));`，而应该是`startActivity(new Intent(Startup.this, Overview.class));`

此外，从堆栈跟踪的外观来看，当您尝试启动新 Activity 时会发生崩溃。所以我会在第 12 行查看问题所在。

更新 -

正如我在下面的讨论中指出的那样：

您不能将 Activity 的 contentView 设置为 findViewById(whatever)。findViewById 查看当前的 contentView 并尝试找到与您传入的 id 匹配的视图。但是您还没有设置任何 contentview，所以没有什么可找到的。因此，当您尝试将 contentview 设置为调用 findViewById 返回的空视图时，您会因空指针而崩溃！您需要将视图设置为该 Activity 的任何视图。setContentView(R.layout.overview_layout) 或 setContentView(new OverviewView(this))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:21:35.903

setContentView(..) 是[Activity](http://developer.android.com/reference/android/app/Activity.html)的一种方法。你不能在你`Runnable`的 中调用它，它超出了范围。结果是一个空指针。

您在 Runnable 中设置 contentView 的方法相当奇怪。也许会稍微改变您的设计？也许您可以创建多个 Activity 而不是切换 1 个 Activity 的布局..

# objective-c - 方法 BOOL 从内部块返回

> ID：11632780
> 
> 赞同：1
> 
> 时间：2012-07-24T14:14:14.280
> 
> 标签：objective-c, ios, xcode, cocoa-touch, objective-c-blocks

我正在尝试将 Beeblex 的新应用内购买验证添加到我的应用中，但是我正在努力从块内传递返回值。

这是我现在拥有的代码，如您所见，我设置了一个 BOOL 值，然后在验证块中设置了 BOOL 并在最后返回它。但是在块完成之前调用最后的返回，所以我需要从块内返回 BOOL？

```
- (BOOL)verifyTransaction:(SKPaymentTransaction *)transaction
{
    if (![BBXIAPTransaction canValidateTransactions]) {
        return YES; // There is no connectivity to reach the server
    }

    BOOL __block toReturn = YES;
    BBXIAPTransaction *bbxTransaction = [[BBXIAPTransaction alloc] initWithTransaction:transaction];
    bbxTransaction.useSandbox = YES;
    [bbxTransaction validateWithCompletionBlock:^(NSError *error) {
        if (bbxTransaction.transactionVerified) {
            if (bbxTransaction.transactionIsDuplicate) {
                // The transaction is valid, but duplicate - it has already been sent to Beeblex in the past.
                NSLog(@"Transaction is a duplicate!");
                [FlurryAnalytics logEvent:@"Transaction duplicate!"];
                toReturn = NO;
            } else {
                // The transaction has been successfully validated and is unique
                NSLog(@"Transaction valid data:%@",bbxTransaction.validatedTransactionData);
                [FlurryAnalytics logEvent:@"Transaction verified"];
                toReturn = YES;
            }
        } else {
            // Check whether this is a validation error, or if something went wrong with Beeblex
            if (bbxTransaction.hasConfigurationError || bbxTransaction.hasServerError || bbxTransaction.hasClientError) {
                // The error was not caused by a problem with the data, but is most likely due to some transient networking issues
                NSLog(@"Transaction error caused by network, not data");
                [FlurryAnalytics logEvent:@"Transaction network error"];
                toReturn = YES;
            } else {
                // The transaction supplied to the validation service was not valid according to Apple
                NSLog(@"Transaction not valid according to Apple");
                [FlurryAnalytics logEvent:@"Transaction invalid!!"];
                toReturn = NO;
            }
        }
    }];

    NSLog(@"toReturn: %@",toReturn ? @"Yes" : @"No");
    return toReturn;
} 
```

如果我只是放在`return = NO;`块内，我会收到不兼容的块指针类型的编译器警告，并且控制可能会到达非空块的末尾。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T18:42:46.347

Beeblex 开发人员在这里。-validateWithCompletionBlock 中的代码：异步执行（在后台，它需要与我们的服务器通信，因此在我们等待互联网执行它的操作时完全阻止您的应用程序是没有意义的）。

因此，您需要重新考虑验证收据的方法。现在你，一般的工作流程是：

1.  完成购买
2.  呼叫 Beeblex
3.  等待回复
4.  检查布尔值

但是#3 会立即返回，所以这永远不会奏效。你应该考虑做这样的事情：

1.  完成购买
2.  显示“请稍候……”视图或类似的内容，告知用户您正在解锁他们购买的任何商品。
3.  呼叫 Beeblex
4.  在块内，确定验证是否成功，*然后*从那里解锁内容。
5.  闲置直到被块调用

这是一个快速而肮脏的例子。我没有编译它，所以它可能有一些错误，但它应该为您提供预期使用模式背后的想法。

```
- (void) showWaitView {
    // Display a wait view
}

- (void) hideWaitView {
    // Hide the wait view
}

- (void) completeValidationWithValidateReceiptData:(NSDictionary *) receipt isRecoverableError(BOOL) isRecoverableError {
    [self hideWaitView];

    if (receipt) {
        // Unlock the content, tell the user
    } else {
        if (isRecoverableError) {
            // Probably a network error of some kind. Tell user they need to be connected,
            // and ask them to do it again.
        } else {
            // Keep the content locked, tell the user something went wrong
        }
    }
}

- (void) validateReceipt:(SKPaymentTransaction *) transaction {
    if (![BBXIAPTransaction canValidateTransactions]) {
        [self completeValidationWithValidateReceiptData:Nil isRecoverableError:YES];
        return;
    }

    BBXIAPTransaction *bbxTransaction = [[BBXIAPTransaction alloc] initWithTransaction:transaction];
    bbxTransaction.useSandbox = YES;

    [bbxTransaction validateWithCompletionBlock:^(NSError *error) {
        if (bbxTransaction.transactionVerified) {
            if (bbxTransaction.transactionIsDuplicate) {
                // The transaction is valid, but duplicate - it has already been sent to Beeblex in the past.
                [FlurryAnalytics logEvent:@"Transaction duplicate!"];
                [self completeValidationWithValidateReceiptData:Nil isRecoverableError:NO];
            } else {
                // The transaction has been successfully validated and is unique
                [FlurryAnalytics logEvent:@"Transaction verified"];
                [self completeValidationWithValidateReceiptData:bbxTransaction.validatedTransactionData isRecoverableError:NO];
            }
        } else {
            // Check whether this is a validation error, or if something went wrong with Beeblex
            if (bbxTransaction.hasConfigurationError || bbxTransaction.hasServerError || bbxTransaction.hasClientError) {
                // The error was not caused by a problem with the data, but is most likely due to some transient networking issues
                [FlurryAnalytics logEvent:@"Transaction network error"];
                [self completeValidationWithValidateReceiptData:Nil isRecoverableError:YES];
            } else {
                // The transaction supplied to the validation service was not valid according to Apple
                [FlurryAnalytics logEvent:@"Transaction invalid!!"];
                [self completeValidationWithValidateReceiptData:Nil isRecoverableError:NO];
            }
        }
    }];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-22T14:39:01.603

<3 块

```
- (void)verifyTransaction:(SKPaymentTransaction *)transaction completionHandler:(void (^)(BOOL flag))completionHandler
{
    if (![BBXIAPTransaction canValidateTransactions]) {
        completionHandler(YES); // There is no connectivity to reach the server
    }

    BBXIAPTransaction *bbxTransaction = [[BBXIAPTransaction alloc] initWithTransaction:transaction];
    bbxTransaction.useSandbox = YES;
    [bbxTransaction validateWithCompletionBlock:^(NSError *error) {
        if (bbxTransaction.transactionVerified) {
            if (bbxTransaction.transactionIsDuplicate) {
                // The transaction is valid, but duplicate - it has already been sent to Beeblex in the past.
                NSLog(@"Transaction is a duplicate!");
                [FlurryAnalytics logEvent:@"Transaction duplicate!"];
                completionHandler(NO);
            } else {
                // The transaction has been successfully validated and is unique
                NSLog(@"Transaction valid data:%@",bbxTransaction.validatedTransactionData);
                [FlurryAnalytics logEvent:@"Transaction verified"];
                completionHandler(YES);
            }
        } else {
            // Check whether this is a validation error, or if something went wrong with Beeblex
            if (bbxTransaction.hasConfigurationError || bbxTransaction.hasServerError || bbxTransaction.hasClientError) {
                // The error was not caused by a problem with the data, but is most likely due to some transient networking issues
                NSLog(@"Transaction error caused by network, not data");
                [FlurryAnalytics logEvent:@"Transaction network error"];
                completionHandler(YES);
            } else {
                // The transaction supplied to the validation service was not valid according to Apple
                NSLog(@"Transaction not valid according to Apple");
                [FlurryAnalytics logEvent:@"Transaction invalid!!"];
                completionHandler(NO);
            }
        }
    }];
} 
```

然后使用

```
[instance verifyTransaction:transaction completionHandler:^(BOOL flag) {
    if (flag) {
        // YOUR CODE HERE
    }
}]; 
```

代替

```
if ([instance verifyTransaction:transaction]) {
    // YOUR CODE HERE
} 
```

# javascript - 在同步调用之前调用函数

> ID：11632792
> 
> 赞同：5
> 
> 时间：2012-07-24T14:14:53.053
> 
> 标签：javascript, jquery, ajax, jquery-plugins, blockui

我有一个简单的问题（但答案似乎并不简单）。

我的代码中有一个同步 AJAX 调用，我想在这个同步调用之前调用一个函数。

我要调用的函数很简单

```
$.blockUI(); 
```

来自 jQuery BlockUI 插件。

我只是试图把那行放在我的 $.ajax 调用之前，但是 blockUI 似乎是在同步调用之后调用的。

然后我尝试使用 $.ajax 的 beforeSend 选项，问题与上述相同。

提前感谢您提供的任何答案（除了使用异步调用，这在我的情况下是不可能的......）

代码在这里可用：http: [//jsfiddle.net/vWsus/2/](http://jsfiddle.net/vWsus/2/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:46:11.363

同步调用很糟糕，它们会锁定浏览器，如果调用没有返回，这不是一个好的用户体验。您遇到的问题是同步调用锁定了浏览器，因此 DOM 永远没有时间重绘。您需要给 DOM 更新时间，因此在进行 Ajax 调用之前设置一个超时。

```
$.blockUI({ message: '<p>foo</p>' });
window.setTimeout( ajxCallFnc, 100); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T14:54:27.210

在您的情况下，并不是在同步调用之后调用 blockUI，而只是同步请求阻止了显示回流（这通常比您的实际 DOM 操作“有时晚”发生）。正如您所说，当您在调用 ajax 之前尝试并调用 blockUI 而不是从 beforeSend 回调内部时，您最终会得到几乎相同的结果。

在 jQuery 中没有什么可以阻止这种行为，因为它不是 jQuery 错误（也不是浏览器本身，因为同步 xhr 请求应该无论如何都会冻结浏览器，并且没有任何东西说浏览器必须继续在那种情况下进行回流）。

我只能建议永远不要使用同步请求。异步的很容易处理。

你可以看看[Why You Should Use XMLHttpRequest Asynchronously](http://blogs.msdn.com/b/wer/archive/2011/08/03/why-you-should-use-xmlhttprequest-asynchronously.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-12T18:20:37.320

```
this.notifyFixed=function(type,msg,callback){
        this.showNotification(type, msg);
            window.setTimeout(function(){
                if(typeof callback ==="function"){
                    callback();
                }
            },100);
    }; 
```

在进行 ajax 调用之前，我有一个想要执行的 notifyFixed 函数，但遇到了同样的问题，所以我添加了超时和一个类似于 epascarello 的回调函数，这对我来说似乎工作正常。

所以希望类似的解决方案可以帮助其他人

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-24T20:58:27.143

$.blockUI 有一个 onBlock 函数。尝试这样的事情：

```
$.blockUI({ 
    message: '<img id="processing" src="images/loading.gif" />', 
    onBlock: function() {
        // make your sync call here
        $.ajax({
            type: 'POST',
            cache: false,
            async: false,               
            url: blahblah,
            dataType: 'json'                
        }).done(function(data){
            //process response

        });
    }
}); 
```

# c# - 静态关键字正确使用？

> ID：11632806
> 
> 赞同：8
> 
> 时间：2012-07-24T14:15:33.560
> 
> 标签：c#, vb.net, static

关于`static`关键字。

到目前为止，通过我自己的研究，我对`static`关键词是什么有了一个大致的了解，但我觉得所有这些不同的描述和细节只会让我更加困惑。此刻，我真的不觉得我知道如何正确使用“ `static`”；它似乎在 C# 和 VB.NET 之间的使用方式不同，并且在语言中的应用方式也不同，具体取决于您使用它的目的......</p>

在阅读 MSDN 文章*[Static (Visual Basic)](http://msdn.microsoft.com/en-us/library/z2cty7t8%28v=vs.80%29.aspx)*时，出现了很多问题，特别是当我阅读这句话时：

> 通常，一旦过程终止，过程中的局部变量就会不复存在。变量仍然存在`static`并保留其最新值。

1.  VB.NET 版本是否`static`与 C# 或 Java 相同，大多数语言的概念是否相同？

2.  如果`static`在类中保留一个值，并且我们能够在不实例化类的情况下访问该特定成员、函数，那么松散使用是否安全？换句话说，`static`在类中使用 's 时我们应该密切注意吗？出于某种原因，它们让我想起了全局变量。也许我只是在这里一无所知，只是需要更多的练习来理解他们的目的。

3.  `static`什么是使用好处和促进代码可重用性的好场景？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T14:24:28.613

在 C# 中，关键字与[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)中的关键字`static`相同。即，来自*[静态类和静态类成员（C# 编程指南）](http://msdn.microsoft.com/en-us/library/z2cty7t8%28v=vs.80%29.aspx)*：`shared`

> 静态类和类成员用于创建无需创建类实例即可访问的数据和函数。

在 VB.NET`static`中的工作方式非常不同，因为它**适用于变量，而不是类型。**

我不知道这种行为是否有 C# 等价物。

**1)** VB.NET 版本的 static 是否与 C# 或 Java 相同，大多数语言的概念是否相同？

这是不同的。`shared`不过是一样的。

**2）**如果静态在类中保留值，并且我们能够访问该特定成员，则无需实例化该类即可使用该函数-松散使用是否安全？换句话说，在类中使用静态时我们应该密切关注吗？它们出于某种原因让我想起了全局变量，也许我只是在这里一无所知，只是需要更多的练习来理解它们的目的。

要非常小心，它们对于应用程序域是全局的。

**3)**使用静态有利于和促进代码可重用性的好的场景是什么？

我使用静态列表来缓存用于填充下拉列表的数据集，这样我就不必一直以[SQL Server](http://en.wikipedia.org/wiki/Microsoft_SQL_Server)为例。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-24T16:19:47.517

其他答案涉及静态的 C# 用法，因此我将`Static`在 VB.NET 中讨论，因为您参考了一篇关于它的 MSDN 文章。当您在 VB.NET 中创建静态局部变量时，编译器会将其转换为*类级*变量，该变量只能由在代码中声明变量的函数中的代码引用。所述变量是实例还是共享取决于包含函数。例如，这段代码：

```
Public Class StaticTest

    Public Function Process(value As Integer) As Integer
        Static lastValue As Integer
        Dim result As Integer
        If value > 0 Then
            result = value
            lastValue = value
        Else
            result = lastValue
        End If
        Return result
    End Function

End Class 
```

反编译成这样的：

```
Public Class StaticTest
    ' Methods
    <DebuggerNonUserCode> _
    Public Sub New()
    End Sub

    Public Function Process(ByVal value As Integer) As Integer
        If (value > 0) Then
            Dim result As Integer = value
            Me.$STATIC$Process$20188$lastValue = value
            Return result
        End If
       Return Me.$STATIC$Process$20188$lastValue
    End Function

    ' Fields
    Private $STATIC$Process$20188$lastValue As Integer
End Class 
```

我注意到，如果我在函数入口处设置`lastValue`为`value`，编译器还会创建某种初始化代码和额外的字段，因此在某些情况下`Static`本地人确实会生成一些额外的代码。

我建议避免使用`Static`本地变量，因为与替代方法相比，我发现它们更令人困惑然后很有帮助，实际上声明了一个类级别的实例变量。静态的权衡是：

为了：

*   无法在其他功能中访问

反对：

*   无法在构造函数中初始化（但可以在其声明中内联初始化，这提供了我上面提到的额外初始化字段/代码）
*   无法根据您在代码中类本地人的典型位置定位
*   看起来像当地人，但不是

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-24T14:36:17.377

1.  [VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)与`shared`C# 相同`static`。C#`static`与 Java 和大多数其他语言中的 static 几乎相同。概念延续。
2.  这是一个是与否的问题。您不想`static`在不知道自己在做什么的情况下随意乱扔 s。然而，它们在很多情况下都很有用（更多关于#3）。它们并不像全局变量，因为它们仍然是“命名空间”并由它们所属的类组织。
3.  静态成员通常用于实用方法和类。例如，C# 将 Math 库的大部分实现为静态方法，因为它们只是进行计算并且没有其他副作用。作为一般规则，如果您的方法没有副作用，并且完成其工作所需的所有数据都作为参数出现。如果你想在类的实例之间共享一些数据（例如，跟踪给定方法被调用的次数，或类似的东西），你也可以使用静态属性。静态也有一些内存使用的好处，因为它允许您只创建一个类或方法的实例以在整个应用程序中共享，而不是为每次使用创建新副本。您还可以将静态类用于扩展方法，但这是另一回事了。
4.  你没有特别问，但值得一提的缺点。避免静态的最大原因是可维护性。您不能轻易继承或扩展静态类，这是需要考虑的主要问题。只要您坚持组合优于继承的规则，这不一定会破坏交易，但静态类缺乏继承和多态性是一个主要缺点。这个问题本身就导致很多人建议在所有情况下都避免使用静态。

# sql - PL/SQL 复制/插入多行到另一表的一行

> ID：11632809
> 
> 赞同：1
> 
> 时间：2012-07-24T14:15:41.117
> 
> 标签：sql, oracle, plsql, insert

我对 SQL 比较陌生，所以请原谅我的无知...

我有三个表，SRS_CAP、SRS_IPF 和 SRS_URA。

我想将数据从 SRS_IPF 复制到 SRS_URA，其中（某些）SRS_IPF 的主键等于 SRS_CAP 的主键。

具体来说，这就是我的问题出现的地方，我想将多行从 SRS_IPF 复制到 SRS_URA 中的一行。下面的脚本说明了我想要实现的目标，但并不打算工作 - 必须有一种更有效的方法（并且确实有效！）：

```
INSERT INTO srs_ura
        (ura_stuc, ura_seqn, ura_stat, ura_name, ura_orgn, ura_add1)
SELECT ipf_ipuc, mySEQ, 'GP',
      (SELECT ipf_valu
                  FROM srs_ipf
                 WHERE ipf_code = 'IPQ_REF1TIT'
                   AND ipf_ippc = CAP_MCRC
                   AND ipf_ipuc = CAP_STUC),
      (SELECT ipf_valu
                  FROM srs_ipf
                 WHERE ipf_code = 'IPQ_REF1ORG'
                   AND ipf_ippc = CAP_MCRC
                   AND ipf_ipuc = CAP_STUC,
      (SELECT ipf_valu
                  FROM srs_ipf
                 WHERE ipf_code = 'IPQ_REF1AL1'
                   AND ipf_ippc = CAP_MCRC
                   AND ipf_ipuc = CAP_STUC)
 FROM srs_ipf, srs_cap
 WHERE ipf_ippc = CAP_MCRC AND ipf_ipuc = CAP_STUC; 
```

如您所见 - 我想将 ipf_valu 字段重复插入 srs_ura 中的多个列，但是 srs_ipf 中同一行的 ipf_code 不同。

所以我的问题是，为了实现上述目标，我应该研究 SQL 编程的哪个领域？

我还有关于自动排序和 NCLOB 的更多问题，但我稍后会解决这些问题。我在 Oracle 服务器上。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:23:33.640

此选择是否返回您要插入的行？

```
SELECT ipf_ipuc, /*mySEQ,*/ 'GP',
       MAX(CASE WHEN ipf_code = 'IPQ_REF1TIT' THEN ipf_valu END),
       MAX(CASE WHEN ipf_code = 'IPQ_REF1ORG' THEN ipf_valu END),
       MAX(CASE WHEN ipf_code = 'IPQ_REF1AL1' THEN ipf_valu END)
 FROM srs_ipf, srs_cap
 WHERE ipf_ippc = CAP_MCRC AND ipf_ipuc = CAP_STUC
   AND ipf_code IN ('IPQ_REF1TIT', 'IPQ_REF1ORG', 'IPQ_REF1AL1')
 GROUP BY ipf_ipuc 
```

# php - 将内爆数组从mysql拆分为php中的变量

> ID：11632811
> 
> 赞同：3
> 
> 时间：2012-07-24T14:15:44.013
> 
> 标签：php, mysql, arrays, explode, implode

好的，基本上我不知道如何将 mysql 的内爆结果返回到 php 中的可用变量。阵列让我陷入循环，让我发疯。

从数据库动态创建的复选框：

```
<input name="tournament_id[]" value="'.$row['tournament_id'].'" type="checkbox">'.$row['tournament_name'].' 
```

发布的值内爆（尚未实施 sql 注入预防）：

```
$got_tournament_id = implode(",",$_POST['tournament_id']); 
```

这会像这样插入到 mysql 中：

```
id   user_id   tournament_id
1    16942627  1,10 
```

这是我获取内爆数据的 mysql 查询：

```
$query = ("SELECT tournament_id FROM tournament WHERE user_id=16942627");
$result = mysql_query($query);
while ($row = mysql_fetch_array($result)) {
$got_it = $row['tournament_id'];    
}
$bust_him = var_dump(explode(",", $got_it));
echo $bust_him; 
```

以上使用 var_dump 将返回以下内容：

```
array(2) { [0]=> string(1) "1" [1]=> string(2) "10" } 
```

现在这是我完全迷失的地方，无法弄清楚如何将值 1 和 10 从数组中获取到单个变量中。我已经尝试了几种方法来做到这一点，但我一直以错误告终，或者只是单词数组。如果有人可以提供一些帮助，我需要一些帮助。提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T14:18:18.947

不要`var_dump()`，其目的是调试，而不是代码或显示逻辑。只需将输出存储`explode()`到`$bust_him`（*多么奇怪的变量名*）：

```
// Store the output of explode() directly
$bust_him = explode(",", $got_it);
// No need for individual variables, just access via array keys.
echo $bust_him[0];
echo $bust_him[1];
// etc... 
```

如果你有*固定*数量的元素，你可以[`list()`](http://us3.php.net/manual/en/function.list.php)用来放入变量中：

```
// You know you only have two, so you can use list()
// to store directly into variables
list($first, $second) = explode(",", $got_it);
echo $first;
echo $second; 
```

从长远来看，比在表中存储逗号分隔值更好的解决方案是创建一个单独的、正确规范化的表，该表链接`tournament_id`到`user_id`. 然后，每个 有多行`user_id`，每行包含*一个* `tournament_id`. 这使得在许多实例中进行更简单和更有效的查询，例如可以使用`COUNT()`聚合，以及许多其他好处。

# c# - 我可以在创建对象之前计算属性吗？在构造函数中？

> ID：11632816
> 
> 赞同：9
> 
> 时间：2012-07-24T14:15:55.377
> 
> 标签：c#, .net, properties, constructor

我可以在创建对象之前计算类中的属性数量吗？我可以在构造函数中这样做吗？

```
class MyClass
{  
    public string A { get; set; }
    public string B { get; set; }
    public string C { get; set; }

    public MyClass()
    {
        int count = //somehow count properties? => 3
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-24T14:17:54.240

是的你可以：

```
class MyClass
{  
    public string A { get; set; }
    public string B { get; set; }
    public string C { get; set; }

    public MyClass()
    {
        int count = this.GetType().GetProperties().Count();
        // or
        count = typeof(MyClass).GetProperties().Count();
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-24T14:21:47.993

正如 BigYellowCactus 所展示的那样，使用反射是可能的。但是没有必要每次都在构造函数中这样做，因为属性的数量永远不会改变。

我建议在静态构造函数中执行此操作（每种类型仅调用一次）：

```
class MyClass
{  
    public string A{ get; set; }
    public string B{ get; set; }
    public string C{ get; set; }

    private static readonly int _propertyCount;

    static MyClass()
    {
        _propertyCount = typeof(MyClass).GetProperties().Count();
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-24T14:19:41.487

```
public MyClass()
{
    int count = GetType().GetProperties().Count();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-30T10:13:34.743

**使用它来计算你的类包含的属性的数量**

```
Type type = typeof(YourClassName);
int NumberOfRecords = type.GetProperties().Length; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-25T09:38:15.697

通过反射，您可以检查类的属性：

```
typeof(ClassName).GetProperties().Length; 
```

# android - “运行命令”文件编辑（即“*.rc”文件）：像 Linux 一样回显到终端？

> ID：11632817
> 
> 赞同：0
> 
> 时间：2012-07-24T14:16:02.453
> 
> 标签：android, linux, shell, rc

我正在编辑 Android 手机文件“init.tuna.rc”，以便它向我打印一些基本的调试检查点消息，以便我可以分析手机在启动过程中的进度。

有谁知道您是否可以简单地将用于控制台打印的 shell 脚本语法插入“运行命令”文件 (.rc) 中？

（在我为 Android 树重建所有代码以测试此调试代码之前，如果有人可以帮助我，我需要知道这一点，因为该过程可能需要一段时间）

下面的工作吗？我想将以下代码片段插入“init.tuna.rc”文件：

```
# Boot debugging Checkpoint #2
echo "Check #2:  Successfully wrote the file system data, including the wifi directories!" 
```

如果这不起作用，我该怎么做才能让“rc”文件在执行时将消息打印到实际终端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T15:09:18.497

**Android 引导语言**记录在`readme.txt`源代码树中的`<android>/system/core/init`. 没有`echo`提到，但你可以试试。另请记住，您应该写入文件，因为 stderr 和 stdout 被重定向到`/dev/null`.

请参阅[https://github.com/aosp-mirror/platform_system_core/blob/master/init/README.md](https://github.com/aosp-mirror/platform_system_core/blob/master/init/README.md)

# jquery - Jquery .find.animate 打破并重复

> ID：11632823
> 
> 赞同：0
> 
> 时间：2012-07-24T14:16:15.407
> 
> 标签：jquery

我有以下 jquery 函数，可以为我的文本设置动画。基本上，它会找到我要求的所有元素并为它们设置动画。如您所见，问题在于它一次找到所有元素并同时为它们设置动画。我希望每个元素（h2、h3 和 span）彼此分开动画。

有什么建议么？也许 .find 命令之间存在某种中断？谢谢！

```
 $nextSlide.find('div.ei-title > h2')
                      .css( 'margin-right', 50 + 'px' )
                      .stop()
                      .delay( this.options.speed * this.options.titlesFactor )
                      .animate({ marginRight : 0 + 'px', opacity : 1 }, this.options.titlespeed, this.options.titleeasing )
                      .end()
                      .find('div.ei-title > h3')
                      .css( 'margin-right', -50 + 'px' )
                      .stop()
                      .delay( this.options.speed * this.options.titlesFactor )
                      .animate({ marginRight : 0 + 'px', opacity : 1 }, this.options.titlespeed, this.options.titleeasing )
                      .end()
                      .find('div.ei-title > span.custom1')
                      .css( 'margin-right', -50 + 'px' )
                      .stop()
                      .delay( this.options.speed * this.options.titlesFactor )
                      .animate({ marginRight : 0 + 'px', opacity : 1 }, this.options.titlespeed, this.options.titleeasing )
                      .end
                      .find('div.ei-title > span.custom2')
                      .css( 'margin-right', -50 + 'px' )
                      .stop()
                      .delay( this.options.speed * this.options.titlesFactor )
                      .animate({ marginRight : 0 + 'px', opacity : 1 }, this.options.titlespeed, this.options.titleeasing )
                      .end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:40:43.263

```
$nextSlide.find('div.ei-title > h2')
  .css( 'margin-right', 50 + 'px' )
  .stop()
  .delay( this.options.speed * this.options.titlesFactor )
  .animate({ marginRight : 0 + 'px', opacity : 1 }, this.options.titlespeed, this.options.titleeasing, function(){
    $nextSlide.find('div.ei-title > h3')
      .css( 'margin-right', -50 + 'px' )
      .stop()
      .delay( this.options.speed * this.options.titlesFactor )
      .animate({ marginRight : 0 + 'px', opacity : 1 }, this.options.titlespeed, this.options.titleeasing, function(){
        $nextSlide.find('div.ei-title > span.custom1')
          .css( 'margin-right', -50 + 'px' )
          .stop()
          .delay( this.options.speed * this.options.titlesFactor )
          .animate({ marginRight : 0 + 'px', opacity : 1 }, this.options.titlespeed, this.options.titleeasing, function(){
            $nextSlide.find('div.ei-title > span.custom2')
              .css( 'margin-right', -50 + 'px' )
              .stop()
              .delay( this.options.speed * this.options.titlesFactor )
              .animate({ marginRight : 0 + 'px', opacity : 1 }, this.options.titlespeed, this.options.titleeasing )
          });
      });
  }); 
```

出于此代码的目的，我们必须使用我们希望对其应用过滤器的对象的标识符。我们不能简单地使用 $(this) 作为回调中的引用。根据您的代码，它看起来好像`$nextSlide`引用了我们正在过滤的对象。为此，我们在动画中使用`$nextSlide`了参考对象。`callback function`我们也将回调称为 的`onComplete`事件`animate function`。

# php - 从数据库返回散列密码字符

> ID：11632828
> 
> 赞同：0
> 
> 时间：2012-07-24T14:16:30.143
> 
> 标签：php, mysql, ajax, database

我最近建立了自己的专用服务器并安装了编写*PHP*脚本等所需的一切。但是当我从*MySQL*数据库返回加密密码时，我似乎遇到了问题，我不知道它是否是与我的*PHP*配置有关，或者与我的*MySQL*配置有关。基本上发生的事情是，当我使用*PDO*从数据库返回加密密码时，它会丢失某些字符，因此当*PHP*将用户在登录时输入的加密密码与数据库中保存的密码进行比较时，它会引发错误。

这是一个例子：

> 加密后用户输入的密码：“#7��”�����8wŖQE��4YW�6�'��u�</p>
> 
> 从数据库返回的密码：?#7??"?????8w?QE??4YW?6?'??u?
> 
> ''' 字符似乎正在更改为 '?' 字符：S

我检查了*PHPMyAdmin*中的密码，看它是否缺少任何字符，但密码匹配，所以介于两者之间的某处是黑麦，我不确定它是否与*PHP*设置或*MySQL*有关。

**这是我的脚本：**

哈希和盐脚本（modules.php）：

```
<?php

        /* Initialises the username variable. */
        $username = $_SESSION['username'];

        /* If the user has changed their details then this block of code will make the changes to the database. 
        if(isset($_POST['detailsChanged']) == 1)
        {

            $statement = $conn -> prepare("UPDATE people SET Firstname = :firstname, Surname = :surname, Email = :email WHERE Username = :username ");

            $statement->bindParam(':firstname', $_POST['Firstname'], PDO::PARAM_INT);
            $statement->bindParam(':surname', $_POST['Surname'], PDO::PARAM_INT);
            $statement->bindParam(':email', $_POST['Email'], PDO::PARAM_INT);
            $statement->bindParam(':username', $username, PDO::PARAM_INT);
            $statement->execute();

        }*/

        if(isset($_SESSION["passed"]) == 1)
        {

            $statement = $conn->prepare("SELECT * FROM people WHERE username = '".$username."'");

            $statement->execute();  

            $result = $statement->fetch();

            $firstname = $result['Firstname'];
            $surname = $result['Surname'];
            $username2 = $result['Username'];

        }
        function pbkdf2( $p, $s, $c, $kl, $a = 'sha256' ) {

            $hl = strlen(hash($a, null, true)); # Hash length
            $kb = ceil($kl / $hl);              # Key blocks to compute
            $dk = '';                           # Derived key

            # Create key
            for ( $block = 1; $block <= $kb; $block ++ ) {

                # Initial hash for this block
                $ib = $b = hash_hmac($a, $s . pack('N', $block), $p, true);

                # Perform block iterations
                for ( $i = 1; $i < $c; $i ++ )

                    # XOR each iterate
                    $ib ^= ($b = hash_hmac($a, $b, $p, true));

                $dk .= $ib; # Append iterated block
            }

            # Return derived key of correct length
            return substr($dk, 0, $kl);
        }
?> 
```

***PDO*****初始化（出于安全原因删除了登录名和密码）（*connection.php*）：**

```
<?php 

$login = "*******";
    $password = "********";

    $dsn = "mysql:host=localhost;dbname=wishpiggy";
$opt = array(
    // any occurring errors wil be thrown as PDOException
    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
    // an SQL command to execute when connecting
    PDO::MYSQL_ATTR_INIT_COMMAND => "SET NAMES 'UTF8'"
);

    $conn = new PDO($dsn, $login, $password);
    $conn->setAttribute(PDO::MYSQL_ATTR_INIT_COMMAND, "SET NAMES 'utf8'");
?> 
```

**登录页面：**

```
<?php ob_start(); session_start(); include ('sql_connect/connection.php'); include('sql_connect/modules.php');

    //This section of code checks to see if the client is using SSL, if not 
    // if($_SERVER["HTTPS"] != "on")
    // {
    //        header("HTTP/1.1 301 Moved Permanently");   
    //        header("Location: https://" . $_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"]);
    //        exit();
    // }

    //This if statement checks to see if the session variable 'username' is set, and if so it will redirect the user to their profile page.

    if(isset($_SESSION["username"]))
    {
        header("Location: /home/");
    }

?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Wish Piggy</title>
    <link href="css/styles.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript" src="js/loginjs.js"></script>
</head>

<body>

    <div class="index_div">
        <div class="logo"><img src="img/wish_piggy.jpg" alt="" />
        </div>
        <div class="text"><span>89% Fulfilled</span>
        </div>
        <div class="bar"><img src="img/wish_piggy_bar.jpg" alt="" />
        </div>
        <div class="text">
            <div class="text_l"><p>1,000,000 People</p>
            </div>
            <div class="text_r"><p>9,000,838 Wishes</p>
            </div>
        </div>
        <div class="sign_in"><a id="show-panel" href="#"></a>
        </div>
    </div>

    <div id="lightbox-panel">
        <form id="loginForm" name="form" action="index.php" method="post" >
            <input name="submitted" type="hidden" value="1" /> 
            <div class="login_label"><img src="img/wish_piggy_login.jpg" alt="" /><a id="open_signin" href="#">SIGN UP HERE</a><p>Login</p><a id="close-panel" href="#"></a>
            </div>
            <div class="login_input"><input name="email" type="text" value="<?php if(isset($_COOKIE['username']) && $_COOKIE['username'] != ""){echo $_COOKIE['username']; $_SESSION["username"] = $_COOKIE['username']; $_SESSION["passed"] = 1; header("Location: /home/");}else{echo "Email";} ?>" onclick="this.value=''" />
            </div>
            <div class="input_label"><span>(e.g. johndoe@email.com)</span>
            </div>
            <div class="login_input"><input name="password" type="password" value="Password" onclick="this.value=''" />
            </div>
            <div class="input_label"><a href="#">Forgot Password</a>
            </div>
            <div class="login_submit">
                <div class="login_checkbox"><input name="remember" type="checkbox" value="" /> <span>Remember me</span>
                </div>
                <div class="login_submit_input"><input name="submit" type="submit" value=""/>
                </div>
            </div>
        </form>
    </div>
    <div id="lightbox"></div>

    <div id="lightbox-panel2">
        <div class="inner_lightbox2"><img src="img/wish_piggy_login.jpg" alt="" /><a id="close-panel2" href="#"></a>
        </div>
        <div class="signup_form">
            <form action="index.php" method="post">   
                <input name="submitted" type="hidden" value="1" /> 
                <div class="signup_form_label"><span>Firstname:</span>
                </div>
                <div class="signup_form_input"><input name="firstname" type="text" />
                </div>
                <div class="signup_form_label"><span>Surname:</span>
                </div>
                <div class="signup_form_input"><input name="surname" type="text" />
                </div>
                <div class="signup_form_label"><span>Email:</span>
                </div>
                <div class="signup_form_input"><input name="email" type="text" />
                </div>
                <div class="signup_form_label"><span>Confirm Email:</span>
                </div>
                <div class="signup_form_input"><input name="emailConfirm" type="text" />
                </div>
                <div class="signup_form_label"><span>Password:</span>
                </div>
                <div class="signup_form_input"><input name="password" type="text" />
                </div>
                <div class="signup_form_label"><span>Confirm Password:</span>
                </div>
                <div class="signup_form_input"><input name="passwordConfirm" type="text" />
                </div>
                <div class="signup_form_label2"><img src="img/wish_piggy_captcha.jpg" alt="" />
                </div>
                <div class="signup_form_input2"><input name="" type="text" />
                </div>
                <div class="signup_form_submit"><input name="" type="button" value="register" />
                </div>
            </form>
        </div>
    </div>
    <?php
        if(isset($_POST["submitted"]) == 1)
        {
            echo "caught data!";
            $email = $_POST["email"];
            $password = $_POST["password"];
            if($password == "")
            {
                die ("Your username or password is incorrect.");
            }

            $usernameValidated = 0;

            $statement = $conn->prepare("SELECT password FROM users WHERE email = :name");
            $statement->bindParam(":name", $email);
            $statement->execute();

            $passCompare = $statement->fetch();
            $passSubmitHashed = pbkdf2($password, "butterScotch", 1000, 32);
            echo $passSubmitHashed;
            echo " || ";
            echo $password;
            if($passSubmitHashed == $passCompare['password'])
            {
                $usernameValidated++;
            }
            echo "hurrdurr || " . $passCompare['password'];
            if($usernameValidated == 0)
            {

                die("Your username or password is incorrect..");

            }

        }
        if(isset($_POST["submitted"]) == NULL || isset($usernameValidated) > 0)
        {
            echo "<style> #text_contents{display: none;}</style>";
        }   

        if(isset($usernameValidated) >= 1)
        {
            $_SESSION["username"] = $username;
            $expiry = 60 * 60 * 6 + time();
            setcookie('username', $username, $expiry);
            $_SESSION["passed"] = $_POST["submitted"];

            header("Location: /profile/");
        }
        ob_end_flush();
    ?>
    <div id="lightbox2"></div>
    <?php ob_end_flush(); ?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:18:51.160

只需使用`base64_encode`（在保存之前和比较时）对密码进行编码:)

# design-patterns - 如何避免创建大量方法，同时使用最少知识原则？

> ID：11632829
> 
> 赞同：1
> 
> 时间：2012-07-24T14:16:31.127
> 
> 标签：design-patterns

我正在尝试使用“外观模式”设计一个界面。然而，正如这里指出的：

[http://www.scribd.com/doc/6599003/7/Principle-of-Least-Knowledge-PLK](http://www.scribd.com/doc/6599003/7/Principle-of-Least-Knowledge-PLK)

这迫使我在类中创建许多访问器方法。根据上面的链接，作为 PLK 的一种变体，我们可以返回接口引用而不是对具体对象的引用。

我的问题是这如何解决问题？一旦我们返回一个接口引用，我们无论如何都需要用适当的类进行实例化。最终我们会从那个对象调用一个方法，对吧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:34:34.990

说您正在*使用某种模式设计界面*听起来就像您正在使用该模式而不知道为什么。您是否正在尝试解决设计问题？如果是，返回接口是否解决问题应该很清楚。

顾名思义，外观模式用于隐藏您不希望调用者看到的内容。隐藏某些东西的一个很好的理由是复杂性——如果你有一些复杂的代码，你可以隐藏一个外观背后的复杂性，这将为调用者提供一个简化的接口。这很好，因为调用者和被调用代码之间的耦合是松散的：如果实现细节发生变化，您可以将更改隐藏在外观后面，调用者不必关心。

隐藏某些内容的方法之一是隐藏精确类型。假设您有一个`Foo`实现`Bar`and的类`Baz`，以及一个只需要使用在 中声明的方法的调用者`Baz`。那么隐藏复杂性的一种方法是只返回接口：“实现的东西`Baz`”。那么调用者就不必关心`Foo`or `Bar`，甚至更好的是，调用者根本不能*使用*`Foo`or 。你可以自由改变，如你所愿，这是一件好事。`Bar` *`Foo``Bar`*

# sql - 将表达式传递给存储过程时，“分钟”附近的语法不正确

> ID：11632831
> 
> 赞同：2
> 
> 时间：2012-07-24T14:16:36.477
> 
> 标签：sql, sql-server, stored-procedures, syntax-error

我有以下代码：

```
insert into @Precalculo (descripcion, Valor) 
  exec dbo.GetRankingTotalizador 
    @Fecha, 
    DateAdd(minute, (-1), DateAdd(day, 1, @Fecha)), 
    @cadenas, 
    @familias

insert into PrecalculoComparativaSemanal 
  select @Fecha, @cadenas, @familias, [1], [2], [3], [4] FROM
  (select Descripcion, Valor from @Precalculo) p 
  PIVOT (min(Valor) FOR Valor in ([1], [2], [3], [4])) as pvt 
```

它给了我一个错误：

> 消息 102，级别 15，状态 1
> “分钟”附近的语法不正确。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T14:19:17.290

一方面，您不能将表达式用作存储过程的参数。尝试：

```
DECLARE @d DATETIME;
SET @d =  DateAdd(minute, (-1), DateAdd(day, 1, @Fecha));

insert into @Precalculo (descripcion, Valor) 
  exec dbo.GetRankingTotalizador @Fecha, @d, @cadenas, @familias; 
```

接下来，根据您的 SQL Server 版本，@table 变量并不总是`INSERT/EXEC`. 我忘记了它何时生效，但您可能需要改用 #temp 表。

最后，我强烈推荐：

```
insert into PrecalculoComparativaSemanal (missing, column, list) 
```

# php - 适配 PHP Pear 脚本发送 HTML 邮件

> ID：11632832
> 
> 赞同：0
> 
> 时间：2012-07-24T14:16:44.890
> 
> 标签：php, pear, html-email

我将如何调整[此答案](https://stackoverflow.com/a/2748837/962144)并将其与允许我发送 HTML 邮件相结合？我有`pear mail_mime`，而且我听说这与它有关。这是我到目前为止得到的代码，但它不起作用：

```
require 'Mail.php';
require 'Mail/mime.php';

    $userID = 13;

    $realname = getRealName($userID); //This function works

    require_once "mail_register.php"; // Includes $register_body_txt and $register_body_html

    $subject = "DERP YAY SENT EMAIL!";
    $to = '<myemail@me.com>';

    $from = "Derp <noreply@derp.com>";
    $host = "ssl://smtp.gmail.com";
    $port = "465";
    $username = "noreply@derp.com";
    $password = "password";

    $crlf = '\n';

    $headers = array (
            'From'          => $from,
            'Subject'       => $subject,
            'Return-Path'   => $from);

    $mime = new Mail_mime(array('eol' => $crlf));

    $mime->setTXTBody($register_body_txt);
    $mime->setHTMLBody($register_body_html);

    $body = $mime->get();
    $headers = $mime->headers($headers);

    $mail =& Mail::factory('mail');
    $mail->send($to, $headers, $body);

    if (PEAR::isError($mail)) { //This is no longer working. Before I adapted the previous script, it would show me actual errors instead of printing out successful all the time.
      echo("<p>" . $mail->getMessage() . "</p>");
    } else {
      echo("<p>Message successfully sent!</p>");
    } 
```

# visual-studio-2010 - 共享点日历 解决方案

> ID：11632839
> 
> 赞同：0
> 
> 时间：2012-07-24T14:17:43.873
> 
> 标签：visual-studio-2010, sharepoint, c#-4.0, calendar

我需要一些在 Sharepoint 中开发某些东西的方向。我知道 c#，asp.net，但以前从未在 sharepoint 上工作过，我想做的是有一个可视组件（日历），我想在其中放置我从数据库中提取的事件，或者不放置事件在其中日历，我希望用户单击日历上的一天并获取详细信息。

我的问题是有没有人知道一个教程，一步一步地在 sharepoint 2007 中开发一个解决方案？我在我的机器上安装了 Visual Studio 2010，并且我们在远程服务器上安装了一个共享点。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T09:39:37.480

我不建议您在 SharePoint 中开发日历解决方案。

相反，我建议您开发一个 Web 服务，将日历数据从数据源提供给 Outlook 客户端。大多数 Outlook 用户在一天中的大部分时间都打开它来处理电子邮件和日历，因此您可以通过订阅将此事件数据提供给他们的 Outlook 日历，他们可以直接覆盖和查看数据。您不必编写任何 Outlook 插件，只需用 C# 和 asp.net 编写一个 Web 服务就可以了。

有一个协议，称为 stssync - 就是为此而开发的。以下博客文章是一个很好的介绍，一步一步，并有示例源代码来帮助您入门。

[http://msdn.microsoft.com/en-us/library/Aa168130(office.11​​).aspx](http://msdn.microsoft.com/en-us/library/Aa168130(office.11).aspx)

他的设计允许您轻松添加自己的数据源类型以将事件数据导入 Outlook。

这篇文章相当陈旧，但相信我，它适用于新客户（2007 年和 2010 年）。大多数用户都意识到他们想要查看的数据位于 Outlook 客户端中，并且他们不必去 SharePoint 来获取数据。

希望这可以帮助。

# c# - 如果跨步而不是在运行时由外部 DLL 填充的数组

> ID：11632840
> 
> 赞同：1
> 
> 时间：2012-07-24T14:17:43.410
> 
> 标签：c#, .net-3.5, kernel32

我正在`kernel32.dll`通过以下方法导入第 3 方 DLL 的函数。

```
private delegate bool MyDelegate(float[] floatArray, UInt16[] intArray);

private static MyDelegate MyDelegateCaller = null;

public static bool MyMethod(ref float[] floatArray, out UInt16[] intArray)
{
    if(MyDelegateCaller == null)
    {
        IntPtr address = GetProcAddress(_dllHandle, "ExternalMethod");

        MyDelegateCaller = 
            (MyDelegate)Marshal.GetDelegateForFunctionPointer(
                address, 
                typeof(MyDelegate)
            );
    }

    return MyDelegateCaller(floatArray, intArray); //*
} 
```

如果我调试并跳过`MyDelegateCaller`(at `//*`)，那么数组会按预期填充。但是，如果我只运行代码，则不会填充数组。

关于发生了什么的任何想法？

更多信息：我使用此方法而不是 PInvoke 来调用 DLL，因为我需要能够在运行时卸载和重新加载 DLL。我尝试添加延迟，在不同的线程中运行作为测试，以尝试模拟跨步的效果。这些方法没有任何跨线程调用，除非 DLL 创建自己的线程，但是，我无权访问 DLL 的代码来验证。

* * *

## 更新

所以我尝试了以下方法（灵感[来自这里](http://msdn.microsoft.com/en-us/library/h80ttd5f%28v=vs.90%29)）

```
 ...
            );
    }

    IAsyncResult result = MyDelegateCaller.BeginInvoke(floatArray, intArray, null, null);

    while (!result.IsCompleted)
        result.AsyncWaitHandle.WaitOne(1000, false); //**

    result.AsyncWaitHandle.Close();

    return MyDelegateCaller.EndInvoke(result);    
} 
```

但是，当我进入`//**`程序时会抛出一个`System.ExecutionEngineException`.

* * *

## 哈克

让我的代码正常工作。

我从以前的更新中删除了工作并放入`MyMethod`了`BackgroundWorker`'`DoWork`事件。循环过来`BackgroundWorker.IsBusy`。

不优雅，但暂时可以。

任何更好的解决方案都非常受欢迎！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:20:16.793

> 我尝试添加延迟，在不同的线程中运行。

添加任意延迟不是线程之间同步的正确方法。您需要等待其他任务完成。

# android - 获取 ListView 中的绝对视图位置

> ID：11632842
> 
> 赞同：6
> 
> 时间：2012-07-24T14:17:44.247
> 
> 标签：android, android-layout, android-listview, android-view

我正在尝试在 ListView 内单击的项目上方/下方显示一个弹出窗口。但是，问题是来自 OnItemClick 方法的 View 只给了我相对于 ListView 本身的 X 和 Y 值。我还检查了 ListView，这也给了我 x=0 y=0 尽管上面还有其他视图。

我浏览了hierarchyviewer 中的所有值，但没有看到我正在寻找的值。（并不是我在让它再次工作时遇到重大问题）。

有什么建议吗？

```
@Override
public void onListItemClick(ListView listView, View view, int position, long id) {
    LayoutInflater inflater = getLayoutInflater(null);
    PopupWindow quickRail = new PopupWindow(
            inflater.inflate(R.layout.quanitity_controls, null), view.getMeasuredWidth(),
            view.getMeasuredHeight());

    int[] location = {
            0, 0
    };

    // This doesn't place this window right on top of the view
    quickRail.showAtLocation(view, Gravity.CENTER, 0, location[1]);
} 
```

列表中的两个项目都使弹出窗口出现在同一个地方。 ![弹出窗口未出现在所需位置](../Images/8280d705b35b81070d1785ef1060a91b.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T14:53:15.120

这应该工作

```
//Activity windows height
int totalHeight = getWindowManager().getDefaultDisplay().getHeight();
int[] location = new int[2];
v.getLocationOnScreen(location); 
```

位置数组应该具有视图的 x 和 y 值。'v' 是在 onItemClickListener 上传递的视图对象。

我添加了一些我用于我的项目的部分。这可能会有所帮助。我在列表视图的顶部有一个操作栏，这段代码似乎工作正常。

要求是在列表项的顶部或下方放置一个小菜单。So when an item is selected, I check if the selected list item is in the upper half of the screen, if so put the menu below the list item otherwise put it on top of the list item. 这是代码

ListItem 点击代码

```
listView.setOnItemClickListener(new OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View view, int position
           , long id) {
        showQuickActionMenu(position,view);
    }   
});

private void showQuickActionMenu(int pos, View v){
    LayoutInflater inflater = 
            (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    //This is just a view with buttons that act as a menu.  
    View popupView = inflater.inflate(R.layout.ticket_list_menu, null);
    popupView.findViewById(R.id.menu_view).setTag(pos);
    popupView.findViewById(R.id.menu_change_status).setTag(pos);
    popupView.findViewById(R.id.menu_add_note).setTag(pos);
    popupView.findViewById(R.id.menu_add_attachment).setTag(pos);

    window = PopupHelper.newBasicPopupWindow(TicketList.this);
    window.setContentView(popupView);
    int totalHeight = getWindowManager().getDefaultDisplay().getHeight();
    int[] location = new int[2];
    v.getLocationOnScreen(location);

    if (location[1] < (totalHeight / 2.0)) {
        PopupHelper.showLikeQuickAction(window, popupView, v
                , getWindowManager(),0,0,PopupHelper.UPPER_HALF);
    } else {
        PopupHelper.showLikeQuickAction(window, popupView, v
                , getWindowManager(),0, 0,PopupHelper.LOWER_HALF);
    }   
} 
```

这是我使用的 PopupHelper 类

```
public class PopupHelper {
    public static final int UPPER_HALF = 0;
    public static final int LOWER_HALF = 1;

    public static PopupWindow newBasicPopupWindow(Context context) {
        final PopupWindow window = new PopupWindow(context);

        // when a touch even happens outside of the window
        // make the window go away
        window.setTouchInterceptor(new OnTouchListener() {
            public boolean onTouch(View v, MotionEvent event) {
                if(event.getAction() == MotionEvent.ACTION_OUTSIDE) {
                    window.dismiss();
                    return true;
                }
                return false;
            }
        });

        window.setWidth(WindowManager.LayoutParams.WRAP_CONTENT);
        window.setHeight(WindowManager.LayoutParams.WRAP_CONTENT);
        window.setTouchable(true);
        window.setFocusable(true);
        window.setOutsideTouchable(true);

        window.setBackgroundDrawable(
                new ColorDrawable(android.R.color.darker_gray));        
        return window;
    }

    /**
     * Displays like a QuickAction from the anchor view.
     * 
     * @param xOffset
     *            offset in the X direction
     * @param yOffset
     *            offset in the Y direction
     */
     public static void showLikeQuickAction(PopupWindow window, View root, 
             View anchor, WindowManager windowManager, int xOffset
             ,int yOffset,int section) {

         //window.setAnimationStyle(R.style.Animations_GrowFromBottomRight);

         int[] location = new int[2];
         anchor.getLocationOnScreen(location);

         Rect anchorRect = new Rect(location[0], location[1], location[0] + 
                 anchor.getWidth(), location[1] + anchor.getHeight());

         root.measure(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);

         int rootWidth = root.getMeasuredWidth();
         int rootHeight = root.getMeasuredHeight();

         int screenWidth = windowManager.getDefaultDisplay().getWidth();
         int screenHeight = windowManager.getDefaultDisplay().getHeight();

         int xPos = ((screenWidth - rootWidth) / 2) + xOffset;
         int yPos = anchorRect.top - rootHeight + yOffset;

         xPos = (screenWidth - rootWidth);
         if(section == UPPER_HALF){
             yPos = anchorRect.top + anchor.getMeasuredHeight();    
         } else {
             yPos = anchorRect.top - rootHeight;
         }
         window.showAtLocation(anchor, Gravity.NO_GRAVITY, xPos, yPos);
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-14T11:41:50.463

对于那些坚持这个问题的人，请尝试使用此代码片段

```
popWindow.showAsDropDown(v);//v is your listview or recyclerview item Element that clicked. 
```

希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:31:17.857

试试这个，看看它是否有效..

```
private  void setListViewHeightBasedOnChildren(ListView listView) {
    ListAdapter listAdapter = listView.getAdapter();
    if (listAdapter == null) {
        // pre-condition
        return;
    }
    int totalHeight = 0;
    int desiredWidth = MeasureSpec.makeMeasureSpec(listView.getWidth(), MeasureSpec.AT_MOST);
    for (int i = 0; i < listAdapter.getCount(); i++) {
        View listItem = listAdapter.getView(i, null, listView);
        listItem.measure(desiredWidth, MeasureSpec.UNSPECIFIED);
        totalHeight += listItem.getMeasuredHeight();
    } 
```

}

//这里listItem.getMeasuredHeight()会得到你每个列表项的高度...你可以通过height*clickedPosition得到你的位置

# php - 以密件抄送方式向多个用户发送电子邮件，无需“收件人”用户

> ID：11632843
> 
> 赞同：0
> 
> 时间：2012-07-24T14:17:47.573
> 
> 标签：php, email, send, bcc

我正在尝试通过 PHP 邮件脚本代码向 Bcc 中的 multiplw 用户发送电子邮件，如下所示 -

```
$recipients =array('recpient1@gmail.com','recpient2go@gmail.com');

$headers  = 'MIME-Version: 1.0' . "\r\n";
        $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

        $to = '';
        $subject = "E-mail subject";
        $body = "E-mail body";
        $headers = 'From: info@mydomain.com' . "\r\n" ;
        $headers .= 'Reply-To: info@mydomain.com' . "\r\n";
        $headers .= 'BCC: ' . implode(', ', $recipients) . "\r\n";

        $email =mail($to, $subject, $body, $headers); 
```

如果我们留下`$to` 黑色，则 gmail 详细信息中的用户显示“给未公开的收件人”，而密件抄送不显示如何显示“密件抄送我（收到邮件的用户）”我搜索了很多，但没有得到任何正确的答案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:23:04.617

BCC 代表[Blind Carbon Copy](http://en.wikipedia.org/wiki/Blind_Carbon_Copy)，其主要目的是让您看不到该邮件的其他收件人。

如果您想显示所有电子邮件地址，请改用抄送（[抄送](http://en.wikipedia.org/wiki/Carbon_copy)）。

但请注意，所有收件人现在都可以看到所有其他收件人的电子邮件地址，这增加了这些电子邮件地址最终进入垃圾邮件目录的可能性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:34:10.913

您无法控制 Gmail 人员在阅读电子邮件时如何决定显示收件人列表。每个网络邮件系统决定他们希望如何显示收件人列表。

也许你可以找到另一个网络邮件系统，它决定显示“发送给我@my-email”而不是“未公开的收件人”……但为什么这对你很重要？
你为什么关心这个？我会说这是一个错误的问题。既然你收到了邮件，那当然是发给你的了。

# asp.net - 如何检查 SQL Server 代理是否正在运行

> ID：11632849
> 
> 赞同：17
> 
> 时间：2012-07-24T14:18:16.653
> 
> 标签：asp.net, sql-server, sql-server-2008, session, session-state

我正在使用 SQL Server 2008 r2。我想找到一种方法来验证 SQL Server 代理是否正在运行。我怀疑代理没有运行，但我不知道如何检查。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-24T14:29:59.710

在 Management Studio 中，您可以通过查看对象资源管理器中的 SQL Server 代理节点来检查 SQL Server 代理是否正在运行。在以下屏幕截图中，我的 SQL Server 2012 实例上的 SQL Server 代理正在运行（绿色箭头覆盖在 SQL Server 代理图标上），但 SQL Server 2000 的代理已停止（红色 x）。

![在此处输入图像描述](../Images/c522c11eedbbaed8deeee829012ea7a7.png)

您还可以检查控制面板 > 管理工具 > 服务：

![在此处输入图像描述](../Images/3f482685b5017d4a4b9e4f0f0fde0661.png)

或在程序文件 > Microsoft SQL Server > 配置工具 > 配置管理器中：

![在此处输入图像描述](../Images/4b1ee35c165d8523590feacfde1a9122.png)

最后，您可以使用 T-SQL 检查状态：

```
DECLARE @agent NVARCHAR(512);

SELECT @agent = COALESCE(N'SQLAgent$' + CONVERT(SYSNAME, SERVERPROPERTY('InstanceName')), 
  N'SQLServerAgent');

EXEC master.dbo.xp_servicecontrol 'QueryState', @agent; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-24T14:31:55.453

如果 SQL Server 代理正在运行，则在 SQL Server Management Studio 中的 SQL Server 代理图标的右下角将显示一个绿色的播放按钮。

要使用 T-SQL 验证给定实例的 SQL Server 代理的状态，请执行以下代码片段：

```
IF EXISTS (  SELECT 1 
             FROM master.dbo.sysprocesses 
             WHERE program_name = N'SQLAgent - Generic Refresher')
BEGIN
    SELECT @@SERVERNAME AS 'InstanceName', 1 AS 'SQLServerAgentRunning'
END
ELSE 
BEGIN
    SELECT @@SERVERNAME AS 'InstanceName', 0 AS 'SQLServerAgentRunning'
END 
```

资料来源 =[科林·斯塔修克](http://benchmarkitconsulting.com/colin-stasiuk/2009/07/20/check-sql-server-agent-status-on-all-sql-servers/)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-06-04T02:18:54.300

确定 SQL 代理是否正在运行并且可以在 SSMS 中轻松完成的最快、最简单、最直接的方法是查询（因此可以自动化），*而*不是查询已弃用的系统表（即`sysprocesses`）或执行`xp_servicecontrol`, 是在 SQL Server 2008 R2 的 SP1 中引入的 DMV：

[sys.dm_server_services](https://docs.microsoft.com/en-us/sql/relational-databases/system-dynamic-management-views/sys-dm-server-services-transact-sql)

```
SELECT dss.[status], dss.[status_desc]
FROM   sys.dm_server_services dss
WHERE  dss.[servicename] LIKE N'SQL Server Agent (%'; 
```

回报：

```
status  status_desc
4       Running 
```

它只需要`VIEW SERVER STATE`服务器权限，但您已经需要它才能在对象资源管理器（在 SSMS 中）中查看它的状态。

并且，如果您不想授予`VIEW SERVER STATE`特定登录，因为它允许获取太多其他信息，那么您在技术上根本不需要授予任何东西，至少不需要授予实际用户。有关完整详细信息（包括工作示例），请参阅以下两个资源：

*   [我需要向用户提供哪些最低权限才能检查 SQL Server 代理服务的状态？](https://dba.stackexchange.com/a/103275/30859)（DBA.StackExchange 上的类似问题）
*   [无需将高级权限授予任何人即可安全轻松地使用高级权限：服务器级](https://sqlquantumleap.com/2018/02/15/safely-and-easily-use-high-level-permissions-without-granting-them-to-anyone-server-level/)（博客文章）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-24T14:39:23.053

```
IF EXISTS (SELECT 1 FROM sysprocesses WHERE LEFT(program_name, 8) = 'SQLAgent')
  PRINT 'Agent is running!'
ELSE
  PRINT 'Agent is not connected!'; 
```

让我知道这是否可行，否则试试这个

```
IF EXISTS (  SELECT 1 

           FROM master.dbo.sysprocesses 

           WHERE program_name = N'SQLAgent - Generic Refresher')

BEGIN

   SELECT @@SERVERNAME AS 'InstanceName', 1 AS 'SQLServerAgentRunning'

END

ELSE 

BEGIN

   SELECT @@SERVERNAME AS 'InstanceName', 0 AS 'SQLServerAgentRunning'

END 
```

参考：[http ://benchmarkitconsulting.com/colin-stasiuk/2009/07/20/check-sql-server-agent-status-on-all-sql-servers/](http://benchmarkitconsulting.com/colin-stasiuk/2009/07/20/check-sql-server-agent-status-on-all-sql-servers/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-14T17:00:32.023

自动检查 SQL Server 代理是否正在使用此批处理文件运行。

如果该服务尚未运行，它将启动该服务。

您需要为某些版本的 MSSQL 调整服务名称 (SQLServerAgent)。

```
echo off
echo Test SQL Server Agent Service

for /F "tokens=3 delims=: " %%H in ('sc query "SQLServerAgent" ^| findstr "STATE"') do (
  if /I "%%H" NEQ "RUNNING" (
   echo service was stopped, starting service
     rem put your optional errorlog or warning message here
     net start "SQLServerAgent"
  )
) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-30T15:12:27.610

这是我在powershell中使用的

`Get-Service | Where-Object -like -value '*sql*agent*' -Property 'name'`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-12T13:01:08.180

2020 年针对 Sql Server Developer Addition 2019 更新

查看 --> 注册服务器 --> 本地服务器组

这应该列出所有本地服务器。如果服务器有一个红色 X，它就会停止。或者您可以右键单击它并转到服务控制。从那里您可以开始/停止重新启动等。

# google-bigquery - 导入数据时遇到错误字符 (ASCII 0)

> ID：11632859
> 
> 赞同：2
> 
> 时间：2012-07-24T14:18:50.287
> 
> 标签：google-bigquery

我正在尝试导入一些数据并收到错误“遇到错误字符（ASCII 0）”

我要导入的文件位于 [http://commondatastorage.googleapis.com/snksales/dimdistributor.csv](http://commondatastorage.googleapis.com/snksales/dimdistributor.csv)

无法理解如何解决这个问题。

谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T18:21:38.297

该文件似乎被编码为 UTF-16。BigQuery 仅支持 UTF-8 和 latin1 文本编码。您可以将其重新格式化为 UTF-8 或 ascii 吗？如果您使用的是 Windows，您应该能够通过在记事本中另存为来设置编码。如果您使用的是 linux 或 mac，您应该能够：`iconv -f utf-16 -t utf-8 dimdistributor.csv -o dimdistributor_utf8.csv`. 我运行了后者并且能够导入您的数据。

$xxd dimdistributor.csv | 头 0000000: fffe 3100 2c00 3000 3000 3000 3000 3100 ..1.,.0.0.0.0.1。0000010：3000 3000 3000 3200 2C00 4D00 2E00 0.0.0.0.2。，。0000020：4D00 5000 M ... Enterp 0000030 2 ... 0000040：0a00 3200 2c00 3000 3000 3000 3000 3100 ..2.,.0.0.0.0.1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-10T20:22:43.777

尝试使用以下 PowerShell 脚本清理文件：

```
 $configFiles = Get-ChildItem -Path C:\InputPath\* 
   foreach ($file in $configFiles)
   {
         (Get-Content $file.PSPath) |
         Foreach-Object { $_ -replace "`0", "" } |
         Set-Content $file.PSPath
   } 
```

要使用它，只需将文件复制到 C:\InputPath 中，将脚本另存为 Script.ps1 并使用 PowerShell 运行它

# android - Android 视图生命周期

> ID：11632862
> 
> 赞同：7
> 
> 时间：2012-07-24T14:18:50.550
> 
> 标签：android, view, lifecycle, android-inflate

我在我的应用程序中使用[SemiClosedSlidingDrawer](http://pastebin.com/FtVyrcEb)。

**快速解释：**

1.  滑动抽屉有**把手**和**内容**部分
2.  内容部分在视图创建时部分打开

**问题：**

当我创建视图时，内容部分被膨胀和缓存，然后部分显示。如果我对主要内容进行任何操作。它反映到滑动抽屉的**内容**部分。即使它是部分可见的。

我设法找到了**内容**未设置为 GONE 的答案，因此只有它正在接收触摸事件。

在所有通货膨胀缓存完成后，我必须将内容设置为 GONE。所以我需要知道

**最后调用了哪个视图创建生命周期方法？**或 **在哪里设置 ChildView 的可见性属性？**

**我可以在活动**中引用我的slidingDrawer 的内容并将其设置为**GONE**它工作正常。但是应该有一个适当的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T09:07:52.400

我不明白为什么您不能将内容部分设置为活动的 onCreate() ？

或者，制作您自己的 SemiClosedSlidingDrawer 实现，并使用您自己的实现覆盖所有构造函数。像这样的东西：

```
SemiClosedSlidingDrawer() {
    super.SemiClosedSlidingDrawer();
    mContent.setVisibility(View.GONE);
} 
```

# .net - 强制禁用用户控件中的标签正常显示（未禁用）？

> ID：11632867
> 
> 赞同：0
> 
> 时间：2012-07-24T14:18:59.460
> 
> 标签：.net, winforms, user-controls

我创建了一个用户控件，我试图将其用作自定义 UI 上的“选项卡”，该 UI 应该像 TabControl 一样运行。（“选项卡”是指您单击的位，而不是单击后显示的页面内容）。选项卡在左侧（与许多应用程序中的属性窗口一样），每个选项卡（应该）由两个标签组成，一个在另一个之上（标题和描述）。

到目前为止，这是一段漫长而艰难的旅程，我的方法可能完全错误，但我目前在我的用户控件中拥有的是两个标签和一个按钮，所有这些都布置在 TableLayoutPanel 中。我有一个按钮的原因是我希望控件成为制表位，因此（我认为）我需要包含一个制表位控件。另外，我想捕获某些击键（见下文）。从视觉上看，拥有按钮并没有太大问题，因为我可以使用图像使按钮看起来更漂亮。

无论如何，我希望用户能够使用向上/向下箭头键上下移动选项卡。我通过在按钮上捕获 KeyDown (& PreviewKeyDown) 事件来实现这一点。那挺好的。

但是，如果用户在焦点位于选项卡用户控件上时按下 Tab 键，我希望焦点移动到当前页面中的第一个控件，而*不是*移动到下一个选项卡用户控件，这实际上是这样做的。

为此，我尝试禁用除活动选项卡之外的所有选项卡用户控件中的按钮，但焦点仍移动到用户控件本身 - 由于没有活动选项卡，它只会丢失（你看不到它）。

然后我尝试禁用所有非活动用户控件而不仅仅是按钮，这很有效 - 除了现在我的用户控件中的标签显示为禁用，我不希望那样。

如何阻止我的用户控件的子控件看起来像被禁用？（或者，我怎样才能让 tab 键忽略我的用户控件而不禁用它们）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T15:04:02.560

事实证明，我可以在不禁用用户控件的情况下实现我想要做的事情。我可以简单地将 TabStop 属性设置为 false。

# deployment - 使用 cmake 部署 QtCreator

> ID：11632868
> 
> 赞同：0
> 
> 时间：2012-07-24T14:19:01.517
> 
> 标签：deployment, ssh, cmake, executable, qt-creator

目前我正在将我的项目从 qmake 转移到 cmake，并且知道如果在 qmake 中使用的构建系统（当然部署变量需要在 qmake 中定义），QtCreator 会通过 ssh 支持进行部署？问题是部署是否也可以使用 cmake 项目来实现？

第二个查询是 Qt-Creator 与基于 cmake 的部署集成的效果如何？可以在基于 cmake 的 QtCreator 项目中实现相同级别的集成吗？

欢迎任何提示，提前感谢您的支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T18:47:43.133

不，部署很大程度上取决于构建系统。目前基本没有对cmake项目的额外支持。虽然你可以使用脚本一起破解一些东西，但这并不是很舒服。

好消息是，我们目前正在考虑使部署更加通用。所以也许在 2.7 或 2.8 中这将是可能的（两者都应该在 2013 年发布）。

# wolfram-mathematica - 从 Mathematica 中的 .raw 文件中读取数据

> ID：11632870
> 
> 赞同：1
> 
> 时间：2012-07-24T14:19:10.077
> 
> 标签：wolfram-mathematica, plot

我正在尝试使用包含 Mathematica 中的 y 坐标集的 .raw 文件绘制图形。我不确定要键入什么内容才能直接直接引用文件中的数据——我目前正在使用“数据”，但不确定这是否正确。

这是我的代码：

```
 SetDirectory[$HomeDirectory <> "/Documents/Project/Work/Output"]
    alldirs = FileNames["deBB-*"]
    alllocdata = {};
    Do[
       SetDirectory["./" <> alldirs[[idir]]];
       Print["--- working on " <> (dirname = alldirs[[idir]])];
       allfiles = FileNames["T-*.raw"];
       Do[
          Print["   --- working on " <> (filename = allfiles[[ifile]])];
          ReadList[filename, Number];
          AppendTo[alllocdata, data];
          Print[ListPlot[data, Frame -> True, PlotRange -> {0, 2000}, 
          DataRange -> {0, 10000},
          AxesOrigin -> {0, 0}]], {ifile, Length[allfiles]}
       ];
       SetDirectory[ParentDirectory[]],
       {idir, Length[alldirs]}
    ] 
```

我一直收到这个错误：

```
 ListPlot::lpn: data is not a list of numbers or pairs of numbers. >> 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T23:39:54.673

您的代码中的一个问题是您从未分配过变量“数据”。你的意思可能是

```
data = ReadList[filename, Number]; 
```

第二个问题是`ReadList`。这是相当老派的，虽然它可以工作，并且（大约 10 倍）比 Import 快。因为您将数字读取为`Number`(...)，所以您不需要将它们转换为字符串。

第三个问题是`AppendTo`。这个命令是出了名的慢。我建议采用索引方法。就像是

```
basdir = "~/parentdir";
SetDirectory[basdir];
alldir = FileNames["deBB-*"];
alldir = Select[alldir, DirectoryQ[#] &] (* directories only *);
alldat = Range[Length@alldir];
(
    SetDirectory[cdir = StringJoin[basdir, "/", alldir[[#]]]];
    Print["Working in ", cdir];
    allfil = FileNames["T-*.raw"];
    alldat[[#]] = Range[Length@allfil];
    tmpdat = Import[allfil[[#]], "Table"] & /@ Range[Length@allfil];
    alldat[[#]] = tmpdat;
    Print@ListPlot[tmpdat[[#]], PlotLabel -> allfil[[#]]] & /@ 
     Range[Length@allfil];
    ) & /@ Range[Length@alldir]; 
```

应该足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T15:29:45.300

根据您的评论， the`data`实际上是一个`String`，而不是一个数字量。

```
data = "702.00000 704.00000 706.00000 708.00000" 
```

这可以通过查看`Head[data]`which 输出来看出`String`。

要解析它，只需使用

```
ToExpression@StringSplit@data 
```

而不是`data`在你的`ListPlot`：

```
ListPlot[ToExpression@StringSplit@data, Frame -> True, PlotRange -> {0, 2000}, 
 DataRange -> {0, 10000}, AxesOrigin -> {0, 0}] 
```

![数学图形](../Images/cc8defdbe5a7065c1366678348b49011.png)

# android - 如何通过 USB 将 Android 设备连接到数码相机？

> ID：11632871
> 
> 赞同：0
> 
> 时间：2012-07-24T14:19:10.973
> 
> 标签：android, usb

我正在制作一个演示应用程序，在其中我想通过 USB 通过下面的 Android 开发者网站将佳能数码相机与 Android 设备通信我如何将数码相机与 Android 设备通信？ [http://developer.android.com/guide/topics/connectivity/usb/host.html](http://developer.android.com/guide/topics/connectivity/usb/host.html) `

```
import java.util.HashMap;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.hardware.usb.UsbDevice;
import android.hardware.usb.UsbManager;
import android.os.Bundle;

public class USBMainclass  extends Activity
{

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        Intent intent =new Intent();
        UsbDevice device = (UsbDevice) intent.getParcelableExtra(UsbManager.EXTRA_DEVICE);
        UsbManager manager = (UsbManager)this.getSystemService(Context.USB_SERVICE);
        HashMap<String, UsbDevice> deviceList = manager.getDeviceList();
    }
} 
```

在 Android 清单文件中是

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.USBCommunication"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="12" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >

        <activity android:name=".USBMainclass">
  <intent-filter>
  <action android:name="android.hardware.usb.action.USB_DEVICE_ATTACHED" /> 
  </intent-filter>
  <meta-data android:name="android.hardware.usb.action.USB_DEVICE_ATTACHED" /> 
  </activity>

    </application>

</manifest> 
```

我只想通过此代码应用程序检测数码相机请帮助..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:22:11.800

这样，当您开始活动时，必须连接设备。如果您在启动应用程序后连接相机，它不会做任何事情。

# jquery - jQuery masonry 在后续调用中初始化失败

> ID：11632873
> 
> 赞同：2
> 
> 时间：2012-07-24T14:19:17.483
> 
> 标签：jquery, jquery-masonry

我正在经历一些我认为不应该发生的事情（基于互联网上的其他评论）。

基本上我第一次调用 masonry() 时布局很好。

但是，如果我重新发出新的 html 内容（用于砌体容器），然后再次通过 masonry() 对其进行初始化，那么布局就会被破坏（只是网格布局，但不会填充项目之间的所有空格）。

在 IE8 上，我实际上通过调试器得到了 jquery.masonry 错误。

*   我在做一些根本错误的事情吗？
*   有一个更好的方法吗？

    ```
    var $container = $('#container');

    // emit photos.
    $container.html(content.join(''));

    // initiate masonry.
    $container.imagesLoaded(function() {
        $container.masonry({ // <<------------ this is where is crashed on subsequent attempts.
                itemSelector: '.item',
                isAnimated: true,
                isFitWidth: true
            });            
    }); 
    ```

*** 更新 ***

我现在可以让后续的砌体初始化工作（砌体布局正在工作）。为此，我只需调用 .masonry('destroy') 即可，然后将新的 html 内容发送到 masonry 容器。不知道为什么这使它起作用，因为似乎没有其他人这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T15:01:45.880

如果您只是替换容器的内容，而不是容器本身，则必须`.masonry('destroy')`在再次初始化之前调用。

# android - 如何在 android 中使用电子邮件观察器从手机中获取电子邮件信息？

> ID：11632878
> 
> 赞同：0
> 
> 时间：2012-07-24T14:19:32.390
> 
> 标签：android

这是我的代码，我正在尝试获取电子邮件信息，但它不起作用。

在这里，我使用了内容观察器及其工作，但无法获取电子邮件数据。

是否有可能通过越狱来启用电子邮件联系

```
 public class EmailObserver extends ContentObserver {
       Context mContext;
       private static final String CONTENT_EMAIL = "content://com.android.email.provider";
       public static final String RECORD_ID = "_id";
       public static final String[] ID_PROJECTION = new String[] {
       RECORD_ID
    };
        public EmailObserver(Handler handler, Context context) {
            super(handler);
            // TODO Auto-generated constructor stub
        }

         public boolean deliverSelfNotifications() {
                return true;
            }
         public void onChange(boolean selfChange){
              Email email = readFrom(mContext);

         }

         private Email readFrom(Context context) {
             Cursor cursor = context.getContentResolver().query(
                             Uri.parse(CONTENT_EMAIL),ID_PROJECTION, null, null, null);
             Email email = null;
             if (cursor.moveToNext()) {
                     int dateColumn = cursor.getColumnIndex("date");
                     int bodyColumn = cursor.getColumnIndex("body");
                     int addressColumn = cursor.getColumnIndex("address");

                     String from = "0";
                     String to = cursor.getString(addressColumn);
                     Date now = new Date(cursor.getLong(dateColumn));
                     String body = cursor.getString(bodyColumn);
                     String subject = "Email...";
                           }
             cursor.close();
             return email;
     }
    } 
```

# linq - Linq To Entities 获取列表中的倒数第二个条目

> ID：11632883
> 
> 赞同：4
> 
> 时间：2012-07-24T14:19:54.310
> 
> 标签：linq, entity-framework, linq-to-entities

我有以下代码返回对象列表。

```
var listOfLogins = _logService.GetLogEventsByItemID(137).ToList(); 
```

我想获得此列表中的倒数第二个对象。

有谁知道如何使用 Linq to Entities 做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T14:20:59.833

```
var secondlast = _logService.GetLogEventsByItemID(137)
    .Reverse()
    .Skip(1)
    .Take(1)
    .FirstOrDefault(); 
```

**更新**
@Dherik 在他的评论中提出了一个很好的观点，`.Reverse`LINQ to Entities 中实际上并不支持，这将导致在调用 reverse 时对查询进行评估，而不是在调用时`.FirstOrDefault`。有关所有（不）支持的方法，[请参见此处。](https://msdn.microsoft.com/en-us/library/vstudio/bb738550(v=vs.100).aspx)

替代（LINQ to Entities 友好）解决方案要求您有一个合适的字段来订购（无论如何必须是这种情况，否则“倒数第二个”没有相关性）：

```
var secondlast = _logService.GetLogEventsByItemID(137)
    .OrderByDescending(e => e.EventDate /* could be any db field */)
    .Skip(1)
    .Take(1)
    .FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:30:51.973

```
 int[] items = new int[] { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };
    int item = items.Skip(items.Count() - 2).Take(1).Single();
    //will return 9 
```

像这样？

# jsf - 用于动态多组条目的组件

> ID：11632885
> 
> 赞同：-1
> 
> 时间：2012-07-24T14:19:58.240
> 
> 标签：jsf, dynamic, input, components, development-environment

我遇到过一种情况，客户需要以表格形式输入地址。客户可以拥有多个地址，并且地址字段包含多个文本字段、组合框等。客户可以动态添加更多地址并删除任何地址条目。例如：表单上有一个添加按钮，单击该按钮时会将所有地址字段显示为一组。如果用户想添加更多地址，他/她可以再次单击添加按钮，这样地址字段的新条目就会显示出来。此外，每个对应的新条目都会有一个删除按钮，这样如果用户想要删除该条目，他/她就可以。最后，所有地址条目都应该映射到一个支持 bean。

例如：在支持 bean 中，一个有“私有列表地址”，地址类进一步有街道、密码、州、城市等。

是否有任何 jsf ui 组件可以在上述情况下提供帮助。简而言之，用户可以动态输入多个地址，然后将地址列表映射到支持 bean 中的相应条目。

请各位，为此做出贡献，我相信这种组件将使开发方式更简单。

该组件应该能够描述我们自己的子组项目。在上述情况下，它是地址，但在不同的情况下，可能需要它是其他东西，如手机号码、网站、电子邮件地址等。组件应该是完全可定制的，即。从组条目到映射它。

请开发人员开发这种组件，并告诉我从哪里以及如何开始成为其中的一部分。如果我们大家齐心协力，我们可以开发这个很棒的组件，这将使开发变得更加容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T18:46:20.633

好的，根据您的叙述，这里有一些想法供您参考：

1.  制作一种`<h:inputText>`绑定到 Backing Bean 上的属性 ( `Strings`?) 的组件形式。
2.  组成一个描述用户地址的类 - `UserAddress()`？
3.  创建一个`<h:commandButton>`其`actionListener`调用同一个支持 bean 上的方法的对象，该方法从支持 bean`UserAddress()`上的字符串的值创建一个对象，然后将其添加到支持 Bean 上`List`的类型`List<UserAddress>`中。

大多数 JSF 组件都准备好接受对象列表，因此您可以很好地使用这样的组件来循环您`List<UserAddress>`将所有用户地址放在屏幕上。

有很多[组件库](https://blogs.oracle.com/rlubke/entry/jsf_component_libraries)可供选择。从当前流行的 PrimeFaces 库中立即想到的一个是可编辑的[DataTable](http://www.primefaces.org/showcase/ui/datatableEditing.jsf)。

祝你好运。

# javascript - 使用 Raphael.js 是否可以相对定位一个元素，然后将其偏移一个绝对单位？

> ID：11632888
> 
> 赞同：1
> 
> 时间：2012-07-24T14:20:02.033
> 
> 标签：javascript, svg, raphael

我有一个问题，我必须制作流畅的可视化，但同时保持设计的某些方面使用固定单位。例如，我有一个水平条，里面有一个标签并向右对齐。我想将标签定位在距离 38% 宽度矩形右侧 10px 的位置。这可能吗？我已经尝试了各种方法，但似乎无法找到一种好的方法......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T14:20:02.033

弄清楚了！所以我仍然用相对单位定位标签，然后我使用拉斐尔变换用绝对单位偏移它。例如

```
todayLabel = paper.text(
     (i * filters.timelineDayWidth) + '%', // x
     24, // y
     'Today ' + today.getUTCDate() + ' ' +today.getMonthNameShort()
);

todayLabel.attr({
    'text-anchor': 'end'
});

todayLabel.transform('t-10,0'); 
```

# mongodb - MongoTemplate.find() 返回整数列表导致 NoSuchMethodException（无默认构造函数）

> ID：11632893
> 
> 赞同：0
> 
> 时间：2012-07-24T14:20:09.507
> 
> 标签：mongodb, spring-data

我正在尝试使用 spring-data-mongo 从 mongo 集合中查询整数列表，但是在生成结果时会引发异常，因为 Integer 没有默认构造函数：

```
Query query = Query.query(Criteria.where("acceptsEmails").is(true));
query.fields().include("userId");
return mongoTemplate.find(query, Integer.class); 
```

问题是生成了以下异常，因为它似乎尝试使用默认构造函数（显然不存在）实例化 Integer。

```
 org.springframework.data.mapping.model.MappingInstantiationException: Could not instantiate bean class [java.lang.Integer]: No default constructor found; nested exception is java.lang.NoSuchMethodException: java.lang.Integer.<init>()
        at org.springframework.data.mapping.model.BeanWrapper.<init>(BeanWrapper.java:105) ~[spring-data-commons-core-1.2.0.RELEASE.jar:na]
        at org.springframework.data.mapping.model.BeanWrapper.create(BeanWrapper.java:73) ~[spring-data-commons-core-1.2.0.RELEASE.jar:na]
        at org.springframework.data.mongodb.core.convert.MappingMongoConverter.read(MappingMongoConverter.java:239) ~[spring-data-mongodb-1.0.0.RELEASE.jar:na]
        at org.springframework.data.mongodb.core.convert.MappingMongoConverter.read(MappingMongoConverter.java:187) ~[spring-data-mongodb-1.0.0.RELEASE.jar:na]
        at org.springframework.data.mongodb.core.convert.MappingMongoConverter.read(MappingMongoConverter.java:151) ~[spring-data-mongodb-1.0.0.RELEASE.jar:na]
        at org.springframework.data.mongodb.core.convert.MappingMongoConverter.read(MappingMongoConverter.java:73) ~[spring-data-mongodb-1.0.0.RELEASE.jar:na]
        at org.springframework.data.mongodb.core.MongoTemplate$ReadDbObjectCallback.doWith(MongoTemplate.java:1693) ~[spring-data-mongodb-1.0.0.RELEASE.jar:na]
        at org.springframework.data.mongodb.core.MongoTemplate.executeFindMultiInternal(MongoTemplate.java:1444) ~[spring-data-mongodb-1.0.0.RELEASE.jar:na]
        at org.springframework.data.mongodb.core.MongoTemplate.doFind(MongoTemplate.java:1259) ~[spring-data-mongodb-1.0.0.RELEASE.jar:na]
        at org.springframework.data.mongodb.core.MongoTemplate.doFind(MongoTemplate.java:1248) ~[spring-data-mongodb-1.0.0.RELEASE.jar:na]
        at org.springframework.data.mongodb.core.MongoTemplate.find(MongoTemplate.java:471) ~[spring-data-mongodb-1.0.0.RELEASE.jar:na]
        at ...
Caused by: org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [java.lang.Integer]: No default constructor found; nested exception is java.lang.NoSuchMethodException: java.lang.Integer.<init>()
        at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:107) ~[spring-beans-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        at org.springframework.data.mapping.model.BeanWrapper.<init>(BeanWrapper.java:102) ~[spring-data-commons-core-1.2.0.RELEASE.jar:na]
        ... 74 common frames omitted
Caused by: java.lang.NoSuchMethodException: java.lang.Integer.<init>()
        at java.lang.Class.getConstructor0(Class.java:2706) ~[na:1.6.0_24]
        at java.lang.Class.getDeclaredConstructor(Class.java:1985) ~[na:1.6.0_24]
        at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:104) ~[spring-beans-3.1.1.RELEASE.jar:3.1.1.RELEASE]
        ... 75 common frames omitted 
```

关于获取返回整数列表的解决方法的任何想法？这是一个非常大的整数列表，所以我不想使用中间格式，例如字符串，然后我必须对其进行迭代并转换为整数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:50:18.000

可能您可以将自定义转换器从`DbObject`（您实际从驱动程序获得的数据类型）注册到`Integer`.

可能这样的事情会起作用：

```
public class UserIdReadConverter implements Converter<DBObject, Integer> {
    public Integer convert(DBObject source) {
        return Integer.parseInt((String) source.get("userId"));
    }
} 
```

不幸的是，您仍然需要将结果值转换为整数。如果此解决方案可能是有用的解决方法，您可以在文档中查看。

[http://static.springsource.org/spring-data/data-mongodb/docs/1.0.3.RELEASE/reference/html/#mongo.custom-converters](http://static.springsource.org/spring-data/data-mongodb/docs/1.0.3.RELEASE/reference/html/#mongo.custom-converters)

再见卡洛

# java - 将方法提交到 ExecutorService Java

> ID：11632896
> 
> 赞同：3
> 
> 时间：2012-07-24T14:20:14.420
> 
> 标签：java, methods, executorservice

所以我在这里有这段代码，它将我的“NamePrinter”可运行类添加为 ExecutorService 任务。一切正常，但我想摆脱那个额外的课程。所以我问有没有办法向 ExexutorService 提交方法？

这是我目前拥有的代码：

```
public void start(){
        Collection<Future<?>> futures = new LinkedList<>();
        final ExecutorService es = Executors.newFixedThreadPool(poolSize);

        for (int i = 0; i < 10; i++) {
        futures.add(es.submit(new NamePrinter(name)));
        }

        es.shutdown();
} 
```

但我希望它是这样的：

```
public void start(){
            Collection<Future<?>> futures = new LinkedList<>();
            final ExecutorService es = Executors.newFixedThreadPool(poolSize);

            for (int i = 0; i < 10; i++) {
            futures.add(es.submit(namePrint(i+"name"))); // This code doesn't work, I just made it so you could understand what I mean.
            }

            es.shutdown();
    }

public void namePrint(String name){  // I'd like this to be the task that ExecutorService runs.

System.out.println(name);

} 
```

这是可以实现的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T14:22:40.257

您可以作为匿名内部类最接近：

```
for (int i = 0; i < 10; i++) {
    final int x = i;
    futures.add(es.submit(new Runnable() {
        @Override public void run() {
            namePrint(x + "name");
        }
    }));
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T14:22:28.127

您本质上是在问：*Java 是否支持作为一等公民的函数*（有时它被称为*闭包*或*lambdas*）-不，**您不能在 Java 中这样做**。您可以在 Groovy、Scala、JavaScript、C#... 中使用，但在 Java 中则不行。

您的`NamePrinter`类（可能实现`Runnable`or `Callable`）是您可以在 Java 中获得的最接近的类，这是 Java 方式（或者您可以使用匿名内部类）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-13T05:34:50.057

在这种特定情况下，我认为您将无法*完全按照*您的意愿行事，因为 interface 的`run`方法`Runnable`不接受任何参数。但是，您可以从**Java 8开始使用****lambda 表达式**。所以你现在有几个选择：

 **1 - 动态定义方法

```
final String name = "whatever";

exServ.execute(() -> {            
    System.out.println(name);
}); 
```

2 - 定义一个静态方法，然后使用静态方法引用

```
public static void printName()
{
    System.out.println(ClassNameX.name);
}

exServ.execute(ClassTest::printName); 
```

3 - 创建你的 NamePrinter 类的实例 - 它不需要实现`Runnable`接口 - 来存储参数，然后使用实例方法引用。

```
NamePrinter np = new NamePrinter("testName");

exServ.execute(np::namePrint); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T15:00:44.523

有一些选项：

1.  使用匿名类

    ```
    es.submit { new Runnable() {
     public void run() {
      //do your stuff here
     }
    }); 
    ```

2.  使用支持闭包的语言，如[Scala](http://www.scala-lang.org/)。但是 API 必须支持这一点，而 ExecutorService 不支持。

3.  等待将引入闭包的[Java 8 。](http://www.drdobbs.com/jvm/jdk-8-closure-syntax-decision/231601075)**

# php - mysqli：它可以在一个语句中准备多个查询吗？

> ID：11632902
> 
> 赞同：22
> 
> 时间：2012-07-24T14:20:37.587
> 
> 标签：php, mysql, mysqli, prepared-statement

我想知道我是否可以准备一个执行多个查询的 mysqli 语句：

```
mysqli->prepare(query1 ...1,2,3 param...; query2...4,5 param...);
or 
mysqli->prepare(insert into ...1,2,3 param...; insert into...4,5 param...);
and after all
mysqli->bind_param("sssss", 1, 2, 3, 4, 5); 
```

这样会出错：在...中的非对象上调用成员函数 bind_param()

```
$stmt = $sql->getQueryPrepare("INSERT INTO user (id_user, username, pw, email) VALUES (?,?,?,?); INSERT INTO process (id_user, idp) VALUES (?,?);");

$stmt->bind_param("ssssss",$id, $username, $pw, $email, $id, $idp);

$stmt->execute();
$stmt->close(); 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-24T16:55:22.833

一条预处理语句只能执行一个 MySQL 查询。您可以在不同的变量中准备任意数量的语句：

```
$stmtUser = $sql->prepare("INSERT INTO user (id_user, username, pw, email) VALUES (?,?,?,?)");
$stmtProc = $sql->prepare("INSERT INTO process (id_user, idp) VALUES (?,?);"); 
```

然后稍后执行它们。如果您想确保除非两者都能够运行，否则两者都不会运行，那么您需要研究事务，就像 Thomas 说的那样。

此外，一般提示：“在非对象上调用成员函数”是`prepare()`失败时出现的标准错误，因此`$stmt`实际上不是准备好的语句对象。这通常意味着您需要在语句中查找错误，`prepare()`而不是稍后查找任何错误。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-07-24T16:15:04.843

不，对 mysqli`prepare()`函数的一次调用不能一次准备多个查询。但是，您可以使用不同的变量为执行准备多个查询。[此功能的文档可在此处获得。](http://us3.php.net/manual/en/mysqli.prepare.php)

看起来您正在尝试设置交易，这与您提出的问题不同。如果这是您真正想知道的，那么您需要提供有关数据库设置的更多信息，并且可能需要提供有关您尝试解决的用例的更多细节。

# zend-framework - Zend PHPUnit 测试模型，断言 Zend_Exception 确实按预期发生

> ID：11632904
> 
> 赞同：0
> 
> 时间：2012-07-24T14:20:51.267
> 
> 标签：zend-framework, exception, phpunit, assert

考虑模型中的以下代码。函数 deleteUser(NULL) 将触发异常。

```
class Model_UserModel extends Zend_Db_Table_Abstract{
    protected $_name = 'users';
    protected $_primary = 'id';
    public function deleteUser($id){
    $row=$this->find($id)->current();
        if($row){
            $row->delete();
            return true;
        }else{
            throw new Zend_Exception("Delete function failed; could not find row!");
        }
    }   
} 
```

我使用 PHPUnit 来测试这段代码，我想检查当 NULL 传递给函数 deleteUser 时是否确实触发了异常。测试类中的代码如下：

```
class Application_Model_UserModelTest extends PHPUnit_Framework_TestCase{
    ...
    //deleting a user with ID=NULL should fail
    public function testDeleteNull(){
        $e = null;
        try{
            $this->_users->deleteUser(NULL);
        }catch (Exception $e) {}
        if($e) {
            $this->assertTrue(TRUE);
        }else{
            $this->assertTrue(FALSE);;
        }
    } 
```

虽然这似乎可行，但我想知道是否有更好的方法来做到这一点。我审查了以下问题：

[PHPUnit 断言抛出异常？](https://stackoverflow.com/questions/5683592/phpunit-assert-that-an-exception-was-thrown)

[使用 PHPUnit 和 Zend Framework 测试异常的问题](https://stackoverflow.com/questions/6545656/problem-testing-exceptions-with-phpunit-and-zend-framework)

但我没有完全理解它们/看看在这种情况下如何应用（测试模型，而不是控制器）。

是否有更好的测试异常的方法被抛出？任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T08:40:52.117

你这样做的一个问题是它接受任何异常，因为所有异常都继承自 Exception。因此，您可能会错过一个错误，因为抛出的异常不是您预期的异常。

使用注释。

```
/**
 * @expectedException Zend_Exception
 */
public function testDeleteNull(){
$this->_users->deleteUser(NULL);
} 
```

不过，您可能希望创建更准确的自定义异常类。有些人会争辩说，使用 exceptedException 你不能断言异常消息，他们是对的。根本就没有通用和“正确”的解决方案。

# python - Python：获取字典中索引的键

> ID：11632905
> 
> 赞同：24
> 
> 时间：2012-07-24T14:20:53.450
> 
> 标签：python, dictionary

> **可能重复：**
> [逆字典查找 -使用 Python](https://stackoverflow.com/questions/2568673/inverse-dictionary-lookup-python)
> [的字典的 Python 反向映射](https://stackoverflow.com/questions/3221475/reverse-mapping-of-dictionary-with-python)

如何获取字典中的索引键？

例如像：

```
i = {'a': 0, 'b': 1, 'c': 2} 
```

所以如果我想获取 i[0] 的密钥，它将返回 'a'

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-24T14:23:12.267

你*可以*这样做：

```
i={'foo':'bar', 'baz':'huh?'}
keys=i.keys()  #in python 3, you'll need `list(i.keys())`
values=i.values()
print keys[values.index("bar")]  #'foo' 
```

但是，每当您更改字典时，都需要更新键、值，因为**字典在 3.7 之前的 Python 版本中没有排序**。在这些版本中，每当您插入新的键/值对时，您认为的顺序就会消失，并被新的（或多或少随机的）顺序所取代。因此，在字典中查询索引是没有意义的。

**从 Python 3.6 开始，对于 Python 的 CPython 实现，字典会记住插入项目的顺序。从 Python 3.7+ 开始，字典按插入顺序排序。**

另请注意，您所问的可能不是您真正想要的。不能保证字典中的逆映射是唯一的。换句话说，您可以拥有以下字典：

```
d={'i':1, 'j':1} 
```

在这种情况下，不可能知道您是否想要`i`，或者`j`实际上这里没有答案能够告诉您将选择哪个 (`'i'`或`'j'`)（同样，因为字典是无序的）。你想在那种情况下发生什么？你可以得到一个可接受的键列表......但我猜你对字典的基本理解不太正确。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-07-24T14:23:02.190

Python 字典有一个键和一个值，你要的是什么键指向一个给定的值。

您只能在循环中执行此操作：

```
[k for (k, v) in i.iteritems() if v == 0] 
```

请注意，字典中的每个值可以有多个键；`{'a': 0, 'b': 0}`是完全合法的。

如果要订购，则需要使用列表或[OrderedDict 实例](http://docs.python.org/library/collections.html#collections.OrderedDict)：

```
items = ['a', 'b', 'c']
items.index('a') # gives 0
items[0]         # gives 'a' 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-24T14:22:56.730

根据定义，字典是无序的，因此不能被索引。对于这种功能，请使用有序字典。[Python 有序字典](http://docs.python.org/library/collections.html)

# wordpress - 为什么一些资源建议从 Git 存储库中排除 WordPress 安装？

> ID：11632916
> 
> 赞同：1
> 
> 时间：2012-07-24T14:21:17.253
> 
> 标签：wordpress, git, gitignore

在将 WordPress 站点切换到 Git 时，我寻找了一个 .gitignore 模板。但我偶然发现了一个反复出现的主题。

> 事实：您不希望项目存储库中存在 WordPress 核心文件或特定于服务器的配置文件等。你只是不这样做。——[乔·巴特利特](https://github.com/jdbartlett)

并且为 WordPress 推荐的 GitHub .gitignore 不包括所有 wp-*.php 文件。[WordPress.gitignore](https://github.com/github/gitignore/blob/master/Wordpress.gitignore)。

为什么推荐这个？当然，我希望包含尽可能多的核心文件，否则我必须在我部署到的每台服务器上安装 WordPress。

*如果上下文有帮助，我会将其部署到具有两个应用程序服务器和两个数据库服务器的负载平衡网络。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:27:40.333

建议这样做，以便仅将**您**的文件保留在您的存储库中。然后使用脚本（或其他东西）您可以检索 WP 源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:27:51.123

我保存在存储库中的唯一内容是主题，而不是任何核心 WordPress 文件。在自述文件中，我会跟踪它使用的版本。

可能不建议帮助阻止修改核心文件。

另一个想法是将 WordPress 保留为一个干净的 git 存储库，并将您的主题作为子模块，这样您就可以将 WordPress 与您的主题分开升级/回滚。这也是我维护使用框架的网站的方式。

# xcode - CUDA 编程和 xCode

> ID：11632919
> 
> 赞同：2
> 
> 时间：2012-07-24T14:21:35.447
> 
> 标签：xcode, cuda

我对 Mac OS X 完全陌生，我购买新 MacBook Pro R15 Retina 版的主要原因是开始学习 CUDA API。

但我无法构建我的项目。

例如，当我创建一个新的 CUDA 项目时，我进入项目属性并进行以下更改：

C/C++/Objective-C 编译器：LLVM GCC 4.2

其他链接器标志：-lcuda、-lcudart

标头搜索路径：/usr/local/cuda/include

库搜索路径：/usr/local/cuda/lib

当我开始在我的代码中添加必要的库时，一切都运行良好。我的代码没有输入错误。

当我构建项目时，我得到链接错误（路径缩短并且消息被分解以提高可读性）：

> ld /my_test_project/Build/Products/Debug/test normal x86_64 cd /Users/Admin/Documents/test setenv MACOSX_DEPLOYMENT_TARGET 10.7 /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang++
> 
> -arch x86_64
> 
> -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk
> 
> -L/my_test_project/构建/产品/调试
> 
> -L/usr/local/cuda/lib -F/my_test_project/Build/Products/Debug
> 
> -filelist /my_test_project/Build/Intermediates/test.build/Debug/test.build/Objects-normal/x86_64/test.LinkFileList
> 
> -mmacosx-version-min=10.7
> 
> -lcudart
> 
> -lcuda
> 
> -o /my_test_project/Build/Products/Debug/test
> 
> ld：找不到文件：@rpath/CUDA.framework/Versions/A/CUDA for architecture x86_64 clang：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）

奇怪的是，当我转到所描述的路径时，我看到了 CUDA 可执行文件。文件在那里！

当我使用使用该库的 cuComplex.h 时，每一个数学表达式（例如 log、cos、sin 等）都是一个“未定义的变量”。但是，cuComplex.h 库中包含库。

驱动程序、SDK 和工具包都安装得很好，一切都像一个魅力。我可以让 SDK 示例正常工作。但我想我错过了一个让整个事情正常工作的细节。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-11T10:23:34.990

我对安装在 Mountain Lion 上的 CUDA 5.0 和 Xcode 4.4.1 有同样的问题。原因是 libcuda.dylib 将 CUDA.framework 与 rpath 链接在一起，您可以使用 otool 进行检查。

```
otool -L /usr/local/cuda/lib/libcuda.dylib
/usr/local/cuda/lib/libcuda.dylib:
/usr/local/cuda/lib/libcuda.dylib (compatibility version 1.1.0, current version 5.0.17)
@rpath/CUDA.framework/Versions/A/CUDA (compatibility version 1.1.0, current version 5.0.17)
/usr/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.9.0)
/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 125.2.0) 
```

但是，Xcode 似乎无法识别 /Library/Frameworks 下的 CUDA.framework。原因不明。您必须自己将其添加到您的项目中。

在您的项目属性页面中，单击 Build Phases -> Link with Libraries。选择 CUDA.framework。如果它没有出现在列表中，请使用“添加其他”添加它。这样你就可以把它联系起来。

如果您正在编写 Makefile，您希望添加它以完全自动化链接阶段：

```
-F/Library/Frameworks -framework CUDA 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-16T22:14:26.120

我在使用 Xcode 6.1 的 OS X 10.10 上编译 CUDA 6.5 示例时遇到了同样的问题。问题发生在 Makefiles 包含以下行的示例中：

```
ALL_LDFLAGS += -Xlinker -framework -Xlinker CUDA 
```

解决方法是告诉链接器有关 /Library/Frameworks 的信息，以便将上面的内容替换为 2 行：

```
ALL_LDFLAGS += -Xlinker -F/Library/Frameworks
ALL_LDFLAGS += -Xlinker -framework -Xlinker CUDA 
```

大概你的问题在这一点上得到了回答，但是这个页面几乎是“ld: framework not found CUDA”的唯一谷歌结果，希望这可以节省其他人一些时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-16T17:59:33.010

作为对我的设置更有效的替代方法是像这样更改 libcuda 的路径：

```
sudo install_name_tool -change @rpath/CUDA.framework/Versions/A/CUDA \
    /Library/Frameworks/CUDA.framework/CUDA \
    /usr/local/cuda/lib/libcuda.dylib 
```

像往常一样，如果您不明白它的作用，请不要将 sudo 命令粘贴到您的终端中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-12T11:15:58.673

在编译示例文件时，我遇到了与 CUDA 8.0 和 OSX 10.12 类似的 CUDA 链接问题。将以下内容添加到 make 文件中解决了该问题。

```
LDFLAGS += -Xlinker -F/Library/Frameworks 
```

# delphi - 使用大 if 子句或堆叠它们？

> ID：11632921
> 
> 赞同：3
> 
> 时间：2012-07-24T14:21:36.930
> 
> 标签：delphi, if-statement

有什么更好的做事方式？

```
if f1() and f2() then... 
```

或者

```
if f1() then
  if f2() then 
```

或者：

```
fBoolean1 := f1()
fBoolean2 := f2()

if fboolean1 and fboolean2 then... 
```

在第一个示例中，我不确定这两个函数中的哪一个被评估。在第二个示例中，仅当 f1 评估为 true 时才评估 f2，而在第三个示例中，f1 和 f2 都得到评估。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T14:26:27.490

编译器很聪明。在您的第一个示例中，如果`f1`返回`false`，则`f2`甚至不会被调用（除非您通过禁用*延迟评估*或*布尔短路*评估来更改默认编译器设置）。因此，第一个选项等同于第二个选项（同样，除非您更改了默认设置）。

因此，就性能而言，前两个选项更好。否则，这是一个品味问题。第二个选项将产生两个代码块，具有两个级别的代码缩进（如果您遵循标准的缩进规则，就像您所做的那样）。出于这个原因，也许您更喜欢第一个选项。

当然，如果你需要使用`f1`和`f2`以后返回的值，可能要多次使用，第三种选择更胜一筹。

# liquibase - 数据库更改管理 - 如何处理分支和主干上的更改

> ID：11632922
> 
> 赞同：4
> 
> 时间：2012-07-24T14:21:38.957
> 
> 标签：liquibase, flyway

像 liquibase 和 flyway 这样的工具当然可以轻松升级您的数据库。我没有弄清楚的是如何最好地处理发布分支和主干上发生的更改。

一个例子：

我在产品中的代码是 2.5 版，并且位于发布分支上。与此同时，开发人员已经开始开发基于主干的 3.0 版本。

在生产中发现了一个错误。制作了一个数据库更改脚本（2.5.1）并提交到发布分支。必须将相同的更改脚本合并回主干（3.0.1？）。

版本 3.x 已发布到野外生产数据库中，与 2.5.1 相比已经有了变化。升级可能会失败。

相反，如果我从头开始创建一个数据库，如果我使用的是仅向前策略，我会发生两次相同的更改（2.5.1 和 3.0.1）。

其他人如何处理这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T18:56:01.713

您正确地认识到**生产数据库更改将始终是线性**的。

要解决这个问题，您应该将 DB 迁移 2.5.1 放在分支和主干上。并且不创建具有相同更改的 3.0.1！

这样，它将与分支一起部署，但也与主干一起部署。

然后将生产升级到主干

*   找到迁移 2.5.1 并跳过它，因为它已经应用了
*   找到迁移 3.0 并将其应用于 2.5.1 db

当然，还有更好的解决方案。那就是完全摆脱分支并始终从主干中释放使用功能切换来代替。

# multithreading - OpenBLAS 中的多线程线性系统解决方案

> ID：11632926
> 
> 赞同：1
> 
> 时间：2012-07-24T14:21:55.447
> 
> 标签：multithreading, fortran, openmp, lapack, openblas

我有一个使用 Fortran 95 和 gfortran 编译器的代码。我也在使用 OpenMP，我必须处理非常大的数组。在我的代码中，我还必须使用 OpenBLAS 的求解器 DGTSV 求解线性方程组。我想并行化这个求解器以及使用应该能够做到的openblas。但我在语法上有问题。使用附加的伪代码，所有 4 个 CPU 几乎 100% 使用，但我不确定每个内核是否单独求解线性方程，或者是否将其拆分为多个部分并并行计算。整个东西是使用编译的`gfortran -fopenmp -lblas a.f95 -o a.out`

所以我的伪代码看起来像

```
program a
implicit none
integer, parameter  ::  N   =       200
real*8, dimension(numx) ::  D   =       0.0
real*8, dimension(numx-1):: DL  =       0.0
real*8, dimension(numx-1):: DU  =       0.0
real*8, dimension(numx) ::  b   =       0.0
integer         ::  info    =       0
integer :: numthread=4
...
!$OMP PARALLEL NUM_THREADS(numthread)
...
!$OMP DO
...
!$OMP END DO
CALL DGTSV(N,1,DL,D,DU,b,N,info)
!$OMP DO
...
!$OMP END DO
...
!$OMP END PARALLEL
end program a 
```

我必须做什么才能使求解器并行化，以便每个内核计算求解器的各个部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-10-06T15:29:57.523

在 OpenMP 并行区域内，所有线程都执行相同的代码（如在 MPI 中），并且仅当线程到达循环/部分/任务时才拆分工作。

在您的示例中，循环 ( `OMP DO`) 内的工作分布在可用线程之间。循环完成后，隐式屏障同步所有线程，然后它们并行执行 function `DGTSV`。在子程序返回后，循环再次被拆分。

@HristoIliev 建议使用一个`OMP SINGLE`子句。这限制了内部的一段代码只能由一个线程执行，并强制所有其他线程等待它（除非您指定`nowait`）。

另一方面，嵌套并行被称为在另一个并行区域内声明一个并行区域的情况。当您在并行区域内执行对 OpenMP 并行化库的调用时，这也适用。

默认情况下，OpenMP 不会增加嵌套并行区域的并行度，而是只有进入并行区域的线程才能执行它。可以使用环境变量将这种行为更改`OMP_NESTED`为`true`.

该`OMP SINGLE`解决方案比将并行区域一分为二要好得多，因为资源被重用于下一个循环：

```
$!OMP PARALLEL
  $!OMP DO
  DO ...
  END DO

  $!OMP SINGLE
  CALL DGTSV(...)

  $!OMP DO
  DO ...
  END DO
$!OMP END PARALLEL 
```

为了说明的用法，`OMP_NESTED`我将向您展示我从一个使用 FFTW（一种快速傅里叶变换实现）配置为使用 OpenMP 的应用程序中获得的一些结果。执行在 16 核双插槽 Intel Xeon E5 @2.46GHz 节点中执行。

下图显示了在整个应用程序中花费的时间，其中并行区域在 CPU > 1 时出现，在 CPU = 1 时出现序列化区域，在 CPU = 0 时出现同步区域。

该应用程序是令人尴尬的并行，因此在这种特殊情况下使用嵌套是不值得的（FFTW 不能很好地扩展）。

这就是`OMP_NESTED=false`执行。观察并行量如何受到外部并行区域 (ftdock) 中所用线程数量的限制。

[![未嵌套的 OpenMP 版本](../Images/259596951214f691d2892b0b53deba49.png)](https://i.stack.imgur.com/eyZWq.png)

这就是`OMP_NESTED=true`执行。在这种情况下，可以进一步增加并行度，而不是在外部并行区域上花费的线程数量。在这种情况下，最大可能的并行度为 16，当 8 个外部线程创建一个对等体来执行内部并行区域时，或者它们是 4 个，每个线程创建 3 个附加线程（8x2 = 4x4 = 16）。

[![嵌套 OpenMP 版本](../Images/e236c0ac0a95b72583e950203b6a3d5c.png)](https://i.stack.imgur.com/nebMd.png)

# html - 对区域形状图的影响

> ID：11632929
> 
> 赞同：1
> 
> 时间：2012-07-24T14:22:01.450
> 
> 标签：html, css, map

我有一个用区域形状映射的图像，当我悬停一个区域时我想要一个效果（比如创建边框或应用一些不透明度）。这是我的代码：我该怎么做？我已经尝试过一些课程并应用带有边框或不透明度的悬停但没有

```
<img src="img/mappa/mappa.jpg" alt="mappa del parco" usemap="#Map" />
            <map name="Map" id="Map">
              <area  shape="rect" data-fancybox-group="fancy"  coords="307,293,399,351"  id="fancybox" href="#inline1" alt="" class="area"/>
            </map> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:28:44.153

不幸的是，这不能仅使用 css 完成，因为浏览器不允许您设置地图区域的样式。您必须在 javascript 或 flash 中寻找解决方案 - 如果您已经在您的网站中使用[jQuery](http://jquery.com/)，我建议您使用[此插件](http://davidlynch.org/blog/2008/03/maphilight-image-map-mouseover-highlighting/)（例如，[请参阅演示](http://davidlynch.org/projects/maphilight/docs/demo_world.html)）。

# php - MySQL 查询中的多个连接给出不正确的结果

> ID：11632937
> 
> 赞同：0
> 
> 时间：2012-07-24T14:22:34.433
> 
> 标签：php, mysql, left-join

我有一个带有 5 个连接的大型 mysql 查询，这可能看起来效率不高，但我正在努力寻找一个可行的不同解决方案。

views 表是这里的主表，因为 clicks 和 conversions 表都通过 token 列（在所有表中被索引并设置为外键）依赖它。

查询：

```
SELECT 
var.id,
var.disabled,
var.name,
var.updated,
var.cid,
var.outdated,
IF(var.type <> 0,'DL','LP') AS `type`,
COUNT(DISTINCT v.id) AS `views`, 
COUNT(DISTINCT c.id) AS `clicks`,
COUNT(DISTINCT co.id) AS `conversions`,
SUM(tc.cost) AS `cost`,
SUM(cp.value) AS `revenue`

FROM variants AS var

LEFT JOIN views AS v ON v.vid = var.id
LEFT JOIN traffic_cost AS tc ON tc.id = v.source
LEFT JOIN clicks AS c ON c.token = v.token
LEFT JOIN conversions AS co ON co.token = v.token
LEFT JOIN c_profiles AS cp ON cp.id = co.profile

WHERE var.cid = 28
GROUP BY var.id 
```

我得到的结果是： ![在此处输入图像描述](../Images/f919301bfa9313e6a871c26cacec9307.png)

问题是收入和成本结果太高了，因为对于视图、点击和印象，只计算不同的行，但是出于某种原因（我真的很感谢这里的解释），所有表中的所有行都被计算在内进入结果集。

我知道这是一个很大的查询，但点击和转换表都依赖于用于过滤结果的视图表，例如 views.country = 'uk'。我试过做 3 个查询并合并它们，但这没有用（它给了我错误的结果）。

我觉得奇怪的另一件事是，如果我删除了点击、转化、c_profiles 的连接，成本列会显示正确的结果。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T10:32:15.210

最后，我不得不使用 3 个不同的查询并对它们进行合并。似乎是开销，但对我有用。

# ruby-on-rails - 将 WEBrick 作为 Windows 服务运行

> ID：11632939
> 
> 赞同：1
> 
> 时间：2012-07-24T14:22:43.653
> 
> 标签：ruby-on-rails, ruby-on-rails-3, webrick

如何在后台将 WEBrick 服务器作为 Windows 服务运行？我尝试按照[这篇](https://stackoverflow.com/questions/877943/how-to-configure-a-rails-app-redmine-to-run-as-a-service-on-windows)文章中的建议进行操作，但我使用的是 Rails 3，但无法找到与 的等效项`C:\RUBYAPP\script\server -e production`，因为`server`Rails 3 中不再存在该目录。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T20:25:38.557

我从未见过在 Windows 服务中使用 WEBrick，但一种解决方法可能是将 Web 服务器作为后台作业运行。你会这样做：

您需要一个包含 2 条指令的 bat 文件来启动 Web 服务器：

*   cd to_your_absolute_app_path
*   导轨

然后，您需要将该 bat 文件转换为 exe 文件。检查[这个](http://www.f2ko.de/programs.php?lang=en&pid=b2e)免费工具。我知道该工具适用于 32 位和 64 位，您可能需要四处寻找合适的。

创建 exe 时，请确保选择它作为不可见的应用程序运行。

然后你把exe放在启动文件夹中。那应该这样做。

# c# - XNA 柏林噪音星球

> ID：11632942
> 
> 赞同：4
> 
> 时间：2012-07-24T14:22:55.223
> 
> 标签：c#, xna-4.0, terrain, perlin-noise

我想用 XNA 制作一个程序星球。我可以使用 Perlin Noise 创建高度图并在运行时加载它，但是如何创建额外的无缝块并创建球形行星？

在此先感谢，朱利奥。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T15:29:48.013

看看我是怎么做[的](https://stackoverflow.com/questions/9697079/generating-terrain-in-c-sharp-using-perlin-noise/9796235#9796235)

那是假设您正在制作平台游戏，还是自上而下？

但是，因为您需要块，使用我的做法可能效果不太好，因此您可以使用perlin 噪声的[这种](https://lotsacode.wordpress.com/2010/02/24/perlin-noise-in-c/)实现，并使用它，如下面的链接所示。你可能想看看[这里](https://stackoverflow.com/questions/9697079/generating-terrain-in-c-sharp-using-perlin-noise/9796235#9796235)的块

# c# - 主键冲突：使用 EF Code First 的继承

> ID：11632951
> 
> 赞同：2
> 
> 时间：2012-07-24T14:23:10.690
> 
> 标签：c#, .net, entity-framework, ef-code-first

我有以下 EF 代码第一个代码。我收到以下异常：

> “GiftCouponPayment”不包含身份列。

表在数据库中成功创建。但是，我怎样才能摆脱这个异常？另外，这个异常的原因是什么？

注意：只要保留域模型（首先使用代码描述）（并且可以查询数据），我对任何表模式都可以。

![在此处输入图像描述](../Images/97830022fbd7423019835797a8b116ec.png)

继续这个异常后，还有一个异常如下：

> 保存不为其关系公开外键属性的实体时发生错误。EntityEntries 属性将返回 null，因为无法将单个实体标识为异常源。通过在实体类型中公开外键属性，可以更轻松地在保存时处理异常。有关详细信息，请参阅 InnerException。
> 
> {“违反 PRIMARY KEY 约束 'PK_dbo.PaymentComponent'。无法在对象 'dbo.PaymentComponent' 中插入重复键。\r\n语句已终止。”}

**参考**：

1.  [实体框架：将表拆分为多个表](https://stackoverflow.com/questions/11628071/entity-framework-split-table-into-multiple-tables)

**注意**：生成的数据库架构如下所示。

![在此处输入图像描述](../Images/9832e937a6613265fe7d855ded9dfc8d.png)

代码：

```
public class MyInitializer : CreateDatabaseIfNotExists<NerdDinners>
{
    //Only one identity column can be created per table.
    protected override void Seed(NerdDinners context)
    {
        //context.Database.ExecuteSqlCommand("CREATE UNIQUE INDEX IX_Payment_PayedTime ON Payment (PayedTime)");
        context.Database.ExecuteSqlCommand("DBCC CHECKIDENT ('Payment', RESEED, 1)");
        context.Database.ExecuteSqlCommand("DBCC CHECKIDENT ('GiftCouponPayment', RESEED, 2)");
        context.Database.ExecuteSqlCommand("DBCC CHECKIDENT ('ClubCardPayment', RESEED, 3)");
    }
}

//System.Data.Entity.DbContext is from EntityFramework.dll
public class NerdDinners : System.Data.Entity.DbContext
{
    public NerdDinners(string connString): base(connString)
    { 
    }

    protected override void OnModelCreating(DbModelBuilder modelbuilder)
    {
        //Fluent API - Plural Removal
        modelbuilder.Conventions.Remove<PluralizingTableNameConvention>();

        //Fluent API - Table per Concrete Type (TPC)
        modelbuilder.Entity<GiftCouponPayment>()
            .Map(m =>
            {
                m.MapInheritedProperties();
                m.ToTable("GiftCouponPayment");
            });

        modelbuilder.Entity<ClubCardPayment>()
            .Map(m =>
            {
                m.MapInheritedProperties();
                m.ToTable("ClubCardPayment");
            });
    }

    public DbSet<GiftCouponPayment> GiftCouponPayments { get; set; }
    public DbSet<ClubCardPayment> ClubCardPayments { get; set; }
    public DbSet<Payment> Payments { get; set; }
}

public abstract class PaymentComponent
{
    public int PaymentComponentID { get; set; }
    public int MyValue { get; set; }
    public abstract int GetEffectiveValue();
}

public partial class GiftCouponPayment : PaymentComponent
{
    public override int GetEffectiveValue()
    {
        if (MyValue < 2000)
        {
            return 0;
        }
        return MyValue;
    }
}

public partial class ClubCardPayment : PaymentComponent
{
    public override int GetEffectiveValue()
    {
        return MyValue;
    }
}

public partial class Payment
{
    public int PaymentID { get; set; }
    public List<PaymentComponent> PaymentComponents { get; set; }
    public DateTime PayedTime { get; set; }
} 
```

客户：

```
 static void Main(string[] args)
    {
        Database.SetInitializer<NerdDinners>(new MyInitializer());
        string connectionstring = "Data Source=.;Initial Catalog=NerdDinners;Integrated Security=True;Connect Timeout=30";

        using (var db = new NerdDinners(connectionstring))
        {
            GiftCouponPayment giftCouponPayment = new GiftCouponPayment();
            giftCouponPayment.MyValue=250;

            ClubCardPayment clubCardPayment = new ClubCardPayment();
            clubCardPayment.MyValue = 5000;

            List<PaymentComponent> comps = new List<PaymentComponent>();
            comps.Add(giftCouponPayment);
            comps.Add(clubCardPayment);

            var payment = new Payment { PaymentComponents = comps, PayedTime=DateTime.Now };
            db.Payments.Add(payment);

            int recordsAffected = db.SaveChanges();
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T12:09:41.987

您没有为 TPC / TPT 映射指定 ID 字段。即使使用继承，您也需要在不运行 TPH 映射时执行此操作。（要注意，我也不确定`MapInheritedProperties()`通话...这通常用于TPH...不是TPT）

```
 //Fluent API - Table per Concrete Type (TPC)
 modelbuilder.Entity<GiftCouponPayment>()
      .HasKey(x => x.PaymentComponentID)
      .Map(m =>
      {
          m.MapInheritedProperties();
          m.ToTable("GiftCouponPayment");
      })
      .Property(x => x.PaymentComponentID)
      .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity); 
```

这需要在具体类型的每个类映射上。如果是我，我会使用 TPH 映射，其中 GiftCoupon 以及其他继承映射，因此您最终得到 1 个表来使用鉴别器列表示整个对象树。

无论如何......您在基类中缺少的另一件事是：

```
public byte[] Version { get; set; } 
```

以及相关的映射：

```
Property(x => x.Version).IsConcurrencyToken() 
```

这允许乐观并发。

希望这会有所帮助，如果您需要进一步的帮助或澄清，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T14:34:58.323

我看到我最初关于 TPC 的建议是不正确的，因为您还在基类中使用了 FK - 您看到`PaymentComponent`表格了吗？在 TPC 继承的情况下，它不应该存在。尝试使用 TPT 继承（`MapInheritedProperties`从您的映射中删除）。这将以相同的正确数据库结束。不要使用补种。Id 将仅由表中的标识列控制`PaymentComponent`（就像目前一样）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T15:13:18.663

在您的 PaymentComponent 类上用 KeyAttribute 装饰 ID

```
[Key]
public int PaymentComponentID { get; set; } 
```

# python - 使用 pyparsing 对结构化文本配置文件进行上下文解析

> ID：11632955
> 
> 赞同：0
> 
> 时间：2012-07-24T14:23:28.790
> 
> 标签：python, parsing, pyparsing

我正在尝试使用 pyparsing 构建一个简单的解析器。

我的示例文件如下所示：

```
# comment
# comment

name1 = value1
name2 = value2

example_list a
  foo
  bar

grp1 (

example_list2 aa
  foo
  bar

example_list3 bb
  foo
  bar

)

grp2 (

example_list4 x
  foo
  bar

example_list5 x
  foo
  bar

example_list6 x
  foo
  bar
) 
```

到目前为止，我提出的解析器如下所示：

```
#!/usr/bin/python
import sys
from pyparsing import *

blank_line = lineStart + restOfLine
comment = Suppress("#") + restOfLine

alias = Word(alphas, alphanums)
name = Word(alphas, alphanums + "_")
value = Word(printables)

parameter = name + Suppress("=") + value
flag = Literal("*") | Literal("#") | Literal("!")
list_item = Optional(flag) + value
list = name + alias + lineEnd + OneOrMore(list_item) + blank_line
group = alias + Suppress("(") + lineEnd + OneOrMore(list) + lineStart + Suppress(")")
script = ZeroOrMore(Suppress(blank_line) | Suppress(comment) | parameter ^ list ^ group)

if __name__ == "__main__":
    print script.parseFile(sys.argv[1]) 
```

但当然它不起作用。

我认为我需要某种方式让解析器知道，如果我们有一个字符串后跟一个等号，那么只有这样我们才能期望再有一个字符串。

如果我们有一个字符串后跟一个括号，那么我们已经开始了一个组。

如果我们有两个字符串，那么我们就开始了一个列表。

我该怎么做呢？

此外，可以想象，注释也可能出现在行尾......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T15:42:08.000

我不确定您是否确定了文件格式，但您的文件可以很容易地表示为 RSON 文件（请参阅[http://code.google.com/p/rson/](http://code.google.com/p/rson/)）。RSON 格式（和相关的解析器）被开发为 JSON 的“可读”版本。我在我的一些项目中使用了 python RSON 解析器。

如果您这样做是为了学习如何解析这样的文件，您仍然可以从 RSON 解析器中收集一些信息。

# objective-c - 菜单栏应用程序的自定义视图上的 mouseDown 问题

> ID：11632956
> 
> 赞同：0
> 
> 时间：2012-07-24T14:23:32.310
> 
> 标签：objective-c, click, menubar

我正在尝试编写拖放菜单栏应用程序。我使用自定义视图来访问删除的文件，这很好用。现在我想在单击此视图时打开默认菜单。我正在使用这个：

```
- (void)mouseDown:(NSEvent *)event {
   [statusItem popUpStatusItemMenu:statusMenu];
} 
```

现在，**mouseDown**工作正常（尝试使用 NSLog），但我仍然无法访问*statusItem*和*statusMenu*。

这是在*dropView.m*，在*dropView.h*我得到：

```
@interface dropView : NSView{
    IBOutlet NSMenu *statusMenu;
    NSStatusItem *statusItem;
} 
```

没有崩溃，没有日志……有什么想法吗？泰！

这比 .m 多一点

```
- (void)awakeFromNib{
    statusItem = [[NSStatusBar systemStatusBar] statusItemWithLength:NSVariableStatusItemLength];
    [statusItem setMenu:statusMenu];
    dropView *drop = [[dropView alloc] initWithFrame:NSMakeRect(0, 0, 24, 24)];
    [statusItem setView:drop];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:55:00.363

将此添加到您的 .h 文件中：

```
@property (strong, nonatomic) IBOutlet NSMenu *statusMenu;
@property (strong, nonatomic) NSStatusItem *statusItem; 
```

将此添加到您的 .m 文件中：

```
@synthesize statusMenu, statusItem; 
```

然后，您将使用`self.statusMenu`和访问属性`self.statusItem`。

# c# - 来自 catch 块的递归调用

> ID：11632958
> 
> 赞同：1
> 
> 时间：2012-07-24T14:23:41.240
> 
> 标签：c#, try-catch

我正在编写一种方法，将上传文档的尝试包装在 Try/Catch 块中。

如果尝试失败，我将增加 Retry 计数器并递归调用相同的方法。

在“Catch”块被命中的情况下，我不清楚执行路径。初始测试表明，在执行第一个递归调用之后执行了“return null”语句。也许'return null'语句需要在 Catch 块内但在 retries<3 循环之外？

```
public RssUploadDocOutput UploadInvoice(string filename, int retries)
        {
            var returnsOutput = new RssUploadDocOutput();

            GoogleSheetsCommand sscmd = new GoogleSheetsCommand("UploadDocument", ConnSheets);
            sscmd.CommandType = System.Data.CommandType.StoredProcedure;
            sscmd.Parameters.Add(new GoogleSheetsParameter("LocalFile", filename));

            //int retries = 0; removed 

            try
            {
             GoogleSheetsDataReader rdr = sscmd.ExecuteReader();
               rdr.Read();

                returnsOutput.ID = rdr[0].ToString();
                [...]
                returnsOutput.Weblink = rdr[6].ToString();

                return returnsOutput;
            }
            catch (Exception ex)
            {
                //retries++;
                Logger.Instance.LogException(ex);
                if (retries < 3)
                {
                    Thread.Sleep(1000 * retries);
                    UploadInvoice(filename, retries+1);
                }
            }
            return null;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:29:55.770

您需要将变量保留在方法之外。否则每次，它都会重置为 0，你将永远不会结束......

```
int retries = 0;
public RssUploadDocOutput UploadInvoice(string filename)
{
  //no need of int retries = 0; inside the method 

  //do stuff
} 
```

`null`只有当它全部失败 3 次时，你的 catch 块才会返回。

*编辑*：您正在**默默地杀死**异常。你确定要这样做吗？您可能希望将其记录或通知回呼叫者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:34:51.167

需要两处改动：

1.  在函数外声明变量重试
2.  返回 UploadInvoice 方法返回的值（在 catch 块中）

    ```
    if (retries < 3)
    {
        Thread.Sleep(1000 * retries);
        return UploadInvoice(filename);
    } 
    ```

# c# - 使用任何数据列对数据行进行排序

> ID：11632960
> 
> 赞同：2
> 
> 时间：2012-07-24T14:23:48.767
> 
> 标签：c#, sorting, datatable

我有一个包含 3 列的以下数据表。

![在此处输入图像描述](../Images/85d1dc1bb99e55b8cea1243f4a77f9bb.png)

我想根据第 2 列对数据表行进行排序。（带有标题 E）是否有任何内置函数可以做到这一点？

我试过..

```
 dt.DefaultView.Sort = dt.Columns[1].ColumnName;
    dt.AcceptChanges(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T14:27:04.127

可能最简单（也是最强大）的方法是使用`Linq-To-DataSet`and [`Enumerable.OrderBy`](http://msdn.microsoft.com/en-us/library/bb534966.aspx)：

```
var tblOrdered = tbl.AsEnumerable()
                    .OrderBy(row => row.Field<int>("E"))
                    .CopyToDataTable(); 
```

如果你不能使用 Linq，你可以使用[`DataView.Sort`](http://msdn.microsoft.com/en-us/library/system.data.dataview.sort.aspx)：

```
DataView view = tbl.DefaultView;
view.Sort = "E ASC"; 
```

但是使用 a `DataView`，原件`DataTable`是未排序的。

所以如果你需要这张桌子，你可以使用[`DataView.ToTable`](http://msdn.microsoft.com/en-us/library/a8ycds2f.aspx)：

```
tbl = view.ToTable(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T14:35:23.570

您可以按列对数据表进行排序

```
 dt.DefaultView.Sort = "E Asc"; 
```

**否则这样**

```
string[] names = new string[dt.Rows.Count];
for (int i = 0; i < dt.Rows.Count; i++)
{
    names[i] = dt.Rows[i]["E"].ToString();
}
Array.Sort(names);

for (int i = 0; i < dt.Rows.Count; i++)
{
    dt.Rows[i]["E"] = names[i];
} 
```

`dt.AcceptChanges`还将提交对表所做的所有更改。aah msdn 还说必须在尝试更新后调用它

> **来自 MSDN 的备注**
> 
> [调用 AcceptChanges](http://msdn.microsoft.com/en-us/library/system.data.datatable.acceptchanges.aspx)时，任何仍处于编辑模式的 DataRow 对象都会成功结束其编辑。DataRowState 也发生了变化：所有已添加和已修改的行都变为未更改，而已删除的行将被删除。
> 
> 在您尝试使用 DbDataAdapter.Update 方法更新 DataSet 之后，通常会在 DataTable 上调用 AcceptChanges 方法。

# ms-access - MS Access 标记按出现顺序重复

> ID：11632961
> 
> 赞同：0
> 
> 时间：2012-07-24T14:23:51.657
> 
> 标签：ms-access, duplicates

我对 MS Access 相当陌生，我需要找出以升序将值的重复实例标记为新列的最佳方法。我在 python 中编写了一个脚本，可以在 ArcGIS 中完成此操作，但我需要弄清楚它才能访问。我有一个`FIELDS`列，其中包含我想要检查重复项的名称，以及一个`DUP_COUNT`我想要填充值出现次数的列。因此，第一个实例将指定为 1，第二个实例将指定为 2，依此类推。我尝试在 MS Excel 中做类似的事情，我想出了如何标记一个值的第一次出现而不是继续出现的值。

```
=IF(COUNTIF(A:A,A2)>1,IF(COUNTIF(A$2:A2,A2)=1,"1","2"),"") 
```

例子：

```
FIELDS DUP_COUNT
Smith          1
Smith          2
Smith          3
Smith          4
Brown          1
Brown          2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:43:14.583

假设您有一个唯一的 ID，您可能会说：

```
SELECT dups.FIELDS, dups.ID, (
    SELECT Count(*) 
    FROM dups a 
    WHERE a.Fields=dups.Fields And a.ID <= dups.ID) AS RankOfDup
FROM dups
ORDER BY dups.FIELDS, dups.ID; 
```

要简单地计算重复次数，您可以说：

```
SELECT ID, Count(ID) FROM dups 
GROUP BY dups.ID 
HAVING Count(dups.ID)>0 
```

# html - 我可以一次在 CSS 中设置所有偏移边吗？

> ID：11632966
> 
> 赞同：9
> 
> 时间：2012-07-24T14:24:10.987
> 
> 标签：html, css

而不是：

```
right:0px;
left:0px;
top:0px;
bottom:0px; 
```

我可以有这样的东西吗？

```
sides:0px; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-24T14:28:06.980

不，不存在`sides`用于设置偏移量的速记属性。您必须单独设置它们。

其他种类的涉及盒子侧面的属性有简写形式，例如[和](http://www.w3.org/TR/CSS21/visuren.html#position-props)，[`margin`](http://www.w3.org/TR/CSS21/box.html#margin-properties)但位置[偏移量](http://www.w3.org/TR/CSS21/visuren.html#position-props)[、](http://www.w3.org/TR/CSS21/visuren.html#position-props)[和](http://www.w3.org/TR/CSS21/visuren.html#position-props)没有。[`padding`](http://www.w3.org/TR/CSS21/box.html#padding-properties)[`border`](http://www.w3.org/TR/CSS21/box.html#border-properties)[`top``right``bottom``left`](http://www.w3.org/TR/CSS21/visuren.html#position-props)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T14:37:46.253

如果您使用的是[LESS](http://lesscss.org/)或[Sass](http://sass-lang.com/)等预处理器，那么可以。如果您使用的是香草 CSS，那么不，*还没有*。

## LESS 中的示例

```
.sides (@length) {
  top: @length;
  bottom: @length;
  left: @length;
  right: @length;
}
div {
  .sides(0px);
} 
```

## Sass 中的示例

```
@mixin sides($length) {
  top: $length;
  bottom: $length;
  left: $length;
  right: $length;
}
div {
 @include sides(0px);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T14:30:56.217

不，无论如何它不会很有用，因为您几乎不会一次将所有这些值都设置为相同的值。您通常将其中两个，即`left`or`right`和`top`or `bottom`再一次很少达到相同的值，因此没有真正的方法可以缩短它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-24T14:28:24.927

不是您尝试使用的 CSS 属性，而是边框、边距、填充等。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-24T14:29:44.740

你是不是想定位一些东西？用左：10px 和右：10px 定位东西似乎有点奇怪。

但是不，它们不是捷径……通常你不会使用所有它们来定位。

参考：[http ://www.w3schools.com/Css/css_positioning.asp](http://www.w3schools.com/Css/css_positioning.asp)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-07-24T14:32:30.777

如果因为要覆盖其他默认值而将偏移量更改为 0px，则可能要使用：

> 位置：静态

所有元素的默认定位是 position:static，这意味着元素没有定位，而是出现在文档中通常会出现的位置。

# .net - 如何通过 NetDataContractSerializer 测试 Serializable？

> ID：11632967
> 
> 赞同：1
> 
> 时间：2012-07-24T14:24:14.220
> 
> 标签：.net, generics, serialization, netdatacontractserializer

有什么方法可以测试代码中的 NetDataContractSerializer 是否可以序列化类型？我正在编写一个在内部使用 NetDataContractSerializer 的泛型类，如果试图将它与无法处理的类型一起使用，我希望在构造函数中引发异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T20:33:21.233

这是我到目前为止发现的。有没有更简单的方法？

```
Private Sub ConfirmTypeIsNetDataContractSerializable(type As Type)
    Dim specialAllowedTypes As Type() = {GetType(Decimal), GetType(String), _
   GetType(DateTime), GetType(DateTimeOffset), GetType(TimeSpan), _
   GetType(Guid), GetType(Uri), GetType(XmlQualifiedName), GetType(XmlElement), GetType(XmlNode)}
    If type.IsPrimitive() OrElse specialAllowedTypes.Contains(type) Then Return

    If type.IsDefined(GetType(DataContractAttribute), inherit:=False) Then Return
    If type.IsDefined(GetType(SerializableAttribute), inherit:=False) Then Return
    If type.IsEnum Then Return
    If type.GetInterfaces().Contains(GetType(IXmlSerializable)) Then Return

    Dim serializer As New NetDataContractSerializer
    Using dummyStream As New System.IO.MemoryStream()
        serializer.Serialize(dummyStream, Activator.CreateInstance(type)) ' throws exception if not serializable
    End Using
End Sub 
```

# c++ - 即使设置了搜索路径，CodeBlocks 也无法找到共享库

> ID：11632968
> 
> 赞同：3
> 
> 时间：2012-07-24T14:24:16.447
> 
> 标签：c++, linux, codeblocks, ld, archlinux

我在代码块中有一个非常基本的 C++ 项目，它使用了`glfw.so`另外两个库，这些库从另一个项目编译为 .so 文件，`libHorde3D.so`以及`libHorde3DUtils.so`. 后者放在项目根文件夹中，而 glfw 在我的某个地方`/usr/lib`（我认为）。

我已将项目文件夹添加到代码块中的链接器和编译器搜索路径。我已经在链接器设置选项卡中添加了`libHorde3D.so`和`libHorde3DUtils.so`以及`glfw.so`链接库。根据stackoverflow上之前的类似问题，我认为这已经足够了。

但是，当我按下构建时：

```
ld cannot find -lHorde3D.so
ld cannot find -lHorde3DUtils.so
ld cannot find -lglfw.so 
```

我的系统是 Arch Linux 64，我使用的是 GCC。我也尝试过bopying `libHorde3D.so`，但没有成功。`libHorde3DUtils.so``/usr/lib``/usr/lib64`

PS 所有搜索路径都在 Debug 和 Release 目标中复制。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T14:30:02.137

比如说，如果库名称是`libmylibrary.so`，那么链接到该库的链接器选项看起来像`-lmylibrary`. 请注意，`lib`前缀和`.so`后缀不存在——它们是由链接器自动添加的。在您的情况下，您似乎指定了错误的名称。尝试`.so`从中删除，这应该可以解决问题。

以下是如何通过犯类似错误来触发失败的简单演示：

```
$ echo 'int main() { return 0; }' > test.c
$ gcc -o test ./test.c -lc
$ gcc -o test ./test.c -lc.so
/usr/bin/ld: cannot find -lc.so
collect2: ld returned 1 exit status
$ 
```

第一个命令成功，第二个命令（库名称不正确）失败。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T14:29:52.533

你不能通过“.so”。链接器选项是

```
-lHorde3D -lHorde3DUtils -lglfw 
```

这样，链接器将在库路径中搜索“libHorde3D.so”等。

# javascript - 如何在 socket.io 中配置重新连接？

> ID：11632969
> 
> 赞同：32
> 
> 时间：2012-07-24T14:24:17.953
> 
> 标签：javascript, node.js, websocket, socket.io

我用下一个代码创建 socket.io 连接

```
var socket = new io.connect('http://localhost:8181', {
    'reconnect': true,
    'reconnection delay': 500,
    'max reconnection attempts': 50
}); 
```

但是当我杀死服务器`CTRL+C`并重新启动它时，重新连接没有发生。但是在客户端引发了断开连接事件。这可能是什么原因？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2014-10-12T23:30:48.337

这是一个老问题，但对于像我这样正在寻找如何在**socket.io (1.x)**中配置重新连接的其他人来说，这是一个正确的语法：

```
var socket = new io.connect('http://localhost:8181', {
    'reconnection': true,
    'reconnectionDelay': 1000,
    'reconnectionDelayMax' : 5000,
    'reconnectionAttempts': 5
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-18T03:50:02.710

我意识到这是一个老问题，但是我在重新连接套接字 io 时遇到了一些问题，并且在搜索结果中发现这篇文章很高，所以我想我会做出贡献。尝试使用以下代码准确调试正在触发的事件：

```
# coffeescript. compile if you're writing javascript, obviously.

socket.on 'connect',-> console.log 'connected'
socket.on 'reconnect',-> console.log 'reconnect'
socket.on 'connecting',-> console.log 'connecting'
socket.on 'reconnecting',-> console.log 'reconnecting'
socket.on 'connect_failed',-> console.log 'connect failed'
socket.on 'reconnect_failed',-> console.log 'reconnect failed'
socket.on 'close',-> console.log 'close'
socket.on 'disconnect',-> console.log 'disconnect' 
```

这应该让您更深入地了解客户端套接字的状态。

另外，请尝试查看您的网络检查器的网络选项卡，看看它是否正在触发 XHR 请求作为后备。最后，在您的 Web 控制台中，尝试输入 io.sockets 并将其展开以查看它是否真的在尝试重新连接。

我遇到了 reconnect_failed 未触发的问题，并且重新连接计数未重置。以下是在 github 上讨论这些问题的链接。

[重新连接延迟 - 指数回退未正确重置](https://github.com/LearnBoost/socket.io-client/issues/326)

[reconnect_failed 永远不会被解雇](https://github.com/LearnBoost/socket.io/issues/652)

[一些潜在的修复/解决方法](https://github.com/LearnBoost/socket.io-client/issues/226)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-06-14T19:00:30.773

这是一个老问题，但我在使用 v1.4.5 时遇到了同样的问题（出于不同的原因）。我的聊天室应用程序运行良好，但是当我点击`Ctrl+C`终端时，我的浏览器继续循环并每隔几秒报告一次 ERR_CONNECTION_REFUSED，直到我将其关闭。

稍微改变以前的答案给了我解决方案。

对于 v1.4.5，这是我的客户端 js 文件中“var socket”的原始代码：

```
 var socket = io(); 
```

这是解决方案：

```
 var socket = io({
        'reconnection': true,
        'reconnectionDelay': 1000,
        'reconnectionDelayMax' : 5000,
        'reconnectionAttempts': 5
    }); 
```

显然，如果我愿意，我可以更改这些值，但重要的是这会杀死永无止境的重新连接请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T17:09:19.947

重新连接延迟太小 500 毫秒增加，在 50 次重试之上意味着 500 * 50 = 25000 毫秒，即 25 秒。如果这无助于在客户端设置错误事件超时以重新创建套接字对象（在错误和一些延迟后重试创建连接）。

# sql - MS Access：“不在”无法正常工作

> ID：11632976
> 
> 赞同：1
> 
> 时间：2012-07-24T14:24:47.697
> 
> 标签：sql, ms-access, subquery

**微软访问 SQL**

```
DELETE * 
FROM Lane_Details
WHERE Lane_Details.Week not in(SELECT DISTINCT TOP 3 Lane_Details.Week
           FROM Lane_Details
WHERE Lane_Details.Week IS NOT NULL
ORDER BY Week DESC; ) 
```

**期望的结果**

我需要做的是从表中删除 4 周或更早的任何内容。

我一直在使用 not in 时遇到问题。它导致 Access 完全锁定。我不确定正确的语法应该是什么，我知道我可以用左外连接来编写它，但我不知道该怎么做。

**数据**

```
ID            Lane  Time                        Week
6213214 83198524    4/6/2012 12:31:00 AM    201315
6213183 61780698    4/6/2012 12:31:00 AM    201311
6213201 11145552    4/6/2012 12:31:00 AM    201315
6213202 82391025    4/6/2012 12:31:00 AM    201314
6213203 11149012    4/6/2012 12:31:00 AM    201311
6213204 11140048    4/6/2012 12:31:00 AM    201311
6213205 83198524    4/6/2012 12:31:00 AM    201316
6213207 61625652    4/6/2012 12:31:00 AM    201316
6213210 61625652    4/6/2012 12:31:00 AM    201311
6637195 36166433    5/1/2012 8:25:00 AM           201314
6637206 77222091    5/1/2012 10:50:00 AM    201314 
```

有了这些数据，我想删除第 201311 周的任何行。我想保留 201314、201315 和 201316。

子查询将在此表上运行，并在本例中获取前 3 个日期（14、15、16）。然后我说“不在”以删除所有 11。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T18:06:01.110

感谢所有的帮助。我终于意识到这不是我的查询，它只是运行得很慢。我认为这是一个性能问题。我决定将查询分解为几个不同的查询。它现在工作得更好。我最终找到[了这个](http://allenbrowne.com/subquery-02.html)网站并得出了这个结论。

VBA 不是进行子查询的最佳场所。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:29:43.843

我不确定 Access 在删除时 WHERE 子句中处理自引用的能力如何。但是你可以做这样的事情来避免子查询：

```
DELETE FROM Lane_Details
WHERE Week <= (THIS WEEK - 4 WEEKS) 
```

其中“THIS WEEK - 4 WEEKS”是一个相关表达式，表示您要删除行之前的结束日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T15:05:38.507

> 我需要做的是从表中删除 4 周或更早的任何内容。

你能不能做类似的事情： -

```
DELETE * FROM Lane_Details where Week<=datepart("yyyy",dateadd("w",-4,now())) & datepart("ww",dateadd("w",-4,now())) 
```

您可能需要将 Week 转换为字符串，但这可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T15:33:43.353

请删除子查询中的分号并在星期字段上创建索引。查询应该可以正常工作。

# mysql - mysql不允许外键

> ID：11632978
> 
> 赞同：2
> 
> 时间：2012-07-24T14:24:50.537
> 
> 标签：mysql, foreign-keys

很多人已经有这个问题了，但是在其他帖子中没有合适的解决方案。

我有两张表，一张名为“sales”，另一张名为“host_flags”。我想有一个host_flags.sales_id到sales.id的外键，但是mysql不让我！我在每个表中都定义了主索引，所以我想知道为什么......

host_flags 表在 host_id 列上已经有一个外键，但即使我首先尝试为销售 id 创建外键，它也不会让我这样做。

表格如下所示：

```
CREATE TABLE `sales` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `email` varchar(255) DEFAULT NULL,
  `password` varchar(255) DEFAULT NULL,
  `creation` datetime DEFAULT NULL,
  `lastupdate` timestamp NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=latin1;

CREATE TABLE `host_flags` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `host_id` int(11) DEFAULT NULL,
  `sales_id` int(11) DEFAULT NULL,
  `creation` datetime DEFAULT NULL,
  `lastupdate` timestamp NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `host_id6` (`host_id`),
  CONSTRAINT `host_id6` FOREIGN KEY (`host_id`) REFERENCES `hosts` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE `hosts` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `creation` datetime NOT NULL,
  `lastupdate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=32225 DEFAULT CHARSET=utf8 COLLATE=utf8_bin; 
```

我收到此错误消息：

```
MySQL said: Can't create table 'primarydata.#sql-191_1' (errno: 150) 
```

谢谢！

查尔斯

## 找到解决方案

主索引的所有整数都必须是有符号或无符号的 - 不能混合。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T14:40:59.103

## 通常：

我喜欢在构建完所有表之后在表定义之外声明 FK 约束。

```
ALTER TABLE `tbl`
    ADD CONSTRAINT `constr`
        FOREIGN KEY `fk_id` REFERENCES `ftbl`(`id`)
            ON UPDATE CASCADE
            ON DELETE CASCADE; 
```

这样我可以确保问题不是像`tbl`. `fk_id`与 中的一个不一样`ftbl`。`id`（包括`UNSIGNED`@Devart所说的）。或者没有声明`ftbl`。`id`作为独一无二的。无论表的声明顺序如何。

在我这样做之后，我可以将约束重新集成到表定义中，并考虑需要创建表以允许添加约束的顺序。

## 你的问题：

```
-- creating the sales table
`id` int(11) unsigned NOT NULL AUTO_INCREMENT,

-- creating the host_flags table
`sales_id` int(11) DEFAULT NULL,

-- the sales.id is declared as unsigned
-- the host_flags.sales_id is declared signed 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T14:35:16.100

除了递归的答案：

要求外键约束的*名称*在数据库范围内必须是唯一的。也许改名字会起作用？

[MySQL 社区论坛上](http://forums.mysql.com/read.php?22,19755,19755#msg-19755)也有一个关于该问题的大量帖子，其中包含针对某些特定情况的几种解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:37:21.900

可能的两个错误：

1.  引用和被引用的列必须具有相同的类型 -`int(11) unsigned`
2.  未知的引用表`hosts`。

# jquery - jQuery 中有没有像 PHP 中的 Simple DOM Parser 这样的 HTML 刮板？

> ID：11632984
> 
> 赞同：0
> 
> 时间：2012-07-24T14:24:52.683
> 
> 标签：jquery, html, parsing

我在 PHP 中使用了 Simple DOM Parser，但由于我在我的网站中使用 jQuery，我正在考虑使用 jQuery 中的插件之类的东西来解析 HTML 页面。有没有？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T14:27:35.117

只需使用`$('your html')`并应用您想要的任何 jquery 函数。[John Resig 的Pure JavaScript HTML Parser](http://ejohn.org/blog/pure-javascript-html-parser/)也对您有用。

# ios - 这次崩溃的原因是什么？

> ID：11632987
> 
> 赞同：0
> 
> 时间：2012-07-24T14:25:05.920
> 
> 标签：ios, memory-management, crash

我收到了崩溃。这次崩溃的原因是什么？

![在此处输入图像描述](../Images/0dedbe37518c3d8a0733f53f02a67fd2.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T14:28:45.323

很可能您的`delegate`对象已被释放，并且您正在尝试将消息发送到已释放的实例。在启用僵尸的情况下运行您的应用程序可能有助于诊断该问题。

要启用僵尸，请转到菜单中的产品/编辑方案并选中“启用僵尸对象”复选框：

![在此处输入图像描述](../Images/ffc7393179ebd96c92498d9ddcdc15ab.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T22:18:21.203

我遇到了这个问题。也许您的控制器已被销毁，其中包含委托。当您的控制器释放时，您将设置 delegate=nil。例如：写这个：self.delegate=nil; int 控制器的 -(void)delloc 方法

# wpf - 如何在我的用户控件中显示 xamlcode

> ID：11632990
> 
> 赞同：0
> 
> 时间：2012-07-24T14:25:16.760
> 
> 标签：wpf, user-controls, contentpresenter

我已经创建了用户控件。我想在我的用户控件中显示 XAML。像那样：

```
<UserControls:UserControl1 Header="Heading">
        <TextBlock Text="My Content" />
</UserControls:UserControl1> 
```

那是用户控件：

```
<UserControl x:Class="UserControls.UserControl1"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" MinHeight="200"
             d:DesignHeight="300" d:DesignWidth="300">
    <UserControl.Resources>
        <Style TargetType="ToggleButton">
            <!-- ... -->
        </Style>        
    </UserControl.Resources>
    <StackPanel>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="{Binding Path=Header}" Grid.Column="0" />
            <ToggleButton Name="ToggleButton" IsChecked="True" Grid.Column="2" />
        </Grid>
        <Rectangle Stroke="#c3c3c3" StrokeThickness="1" Height="1" StrokeDashArray="4 4" SnapsToDevicePixels="True" Focusable="False" />
        <!-- Content -->
    </StackPanel>
</UserControl> 
```

现在如何`<TextBlock Text="My Content" />`在我的控件中设置 xaml 代码（例如）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:41:32.257

您只需要根据演示者添加到的项目添加 ContentPresenter 或 ItemsPresenter。

在您的情况下，如果您希望堆栈面板中的内容位于其他项目下方，您可以放置​​一个内容控件并在其中添加一个 ContentPresenter ，如下所示。

```
<StackPanel...>
    <Grid ...>
        ...
    </Grid>
    <Rectangle .../>
    <!---Content here-->
    <ContentControl>
        <ContentPresenter/>
    </ContentControl>
</StackPanel> 
```

如果您只想支持多个内容项，请使用一些支持多个内容的控件，然后`<ItemsPresenter/>`改用。

# javascript - 在 IE8 上按 Tab 后禁用 dojo onkeyup

> ID：11632993
> 
> 赞同：2
> 
> 时间：2012-07-24T14:25:28.167
> 
> 标签：javascript, internet-explorer, browser, dojo, dom-events

我在 IE8 上的事件有问题（可怕！），在 Websphere Portal Server 上运行的 Spring 应用程序上使用 dojo 工具包 1.4.3（不能使用任何其他版本）。

现在，我不相信后端与此有任何关系，因为 IE8 选项卡的问题是已知的：

> 按下网页的任何字段并一直按 Tab，焦点会返回到 url 输入和按钮，并且在重复之后不会返回到文档，如果您单击网站中的元素，它会重新添加焦点在该元素上，但是当您再次按 Tab 时，它会返回到浏览器的顶部。

现在，我的问题发生在一路制表符并将焦点从文档中移开之后。似乎浏览器正在从 DOM 中删除事件，我已经在 IE8 上调试了代码，它似乎没有触发回调函数，而在不执行整个选项卡时它的行为正常。

我尝试通过随后调用无济于事来使用`dojo.disconnect()`和重新添加事件，这是一个小片段：`dojo.connect()`

```
var connectedObjects = {};
dojo.query(".someClass").forEach(function(inputField){
   connectedObjects[inputField.id] = {}; 
   connectedObjects[inputField.id].onfocus = dojo.connect(inputField, "onfocus", function(event){
       if(connectedObjects[inputField.id]){
           dojo.disconnect(connectedObjects[inputField.id].onkeyup);
           connectedObjects[inputField.id].onkeyup = dojo.connect(inputField, "onkeyup", someCallbackFunction);
       }
   })
}); 
```

有没有人对如何解决这个问题有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T09:51:31.910

所以，这是一个奇怪的问题，但是有一种简单的方法可以解决这个问题，这似乎也可以解决其他浏览器循环通过具有 css 属性的隐藏输入字段的问题`display:none`，等等代码：

```
dojo.query("*").forEach(function(fieldID){
    dojo.attr(fieldID, "tabIndex", "-1");
}); 
```

# jquery-mobile - jQuery Mobile - changePage 和选择菜单不起作用

> ID：11632996
> 
> 赞同：0
> 
> 时间：2012-07-24T14:25:38.260
> 
> 标签：jquery-mobile, refresh, select-menu

这是我第一次使用 jQuery Mobile，我实际上是从我得到的 WP 主题中使用它。我知道这可能与主题有关，但我只是想确定一下。

所以，它是一个 Wordpress jQuery Mobile 主题，你插入它，它就可以工作了。问题是，我已经将 Wordpress 菜单从 UL 转换为 SELECT。

然后，我添加了一些 jQuery，通过获取所选选项的值来触发更改时的选择。那行得通，我得到加载的东西，然后页面以我想要的效果改变。

但我无法让选择菜单显示当前选定的项目。它总是恢复到第一个。

我用过：

```
$('#main_menu').selectmenu("refresh");
$('#main_menu').selectmenu("refresh", true); 
```

但没什么...

您可以在这里查看该站点：http: [//avatarblog.fl1hosting.com/](http://avatarblog.fl1hosting.com/)并查看源代码。

你会看到我的移动事件都在 jQuery Mobile 包含之前，这对我来说没有多大意义，但如果我把它们放在之后，就没有任何效果。

任何帮助将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:36:10.473

您需要设置要在选择菜单中显示的选项。试试这个，

```
$("#main_menu")[0].selectedIndex = 2; // this will select the 3rd in the menu list
$("#main_menu").selectmenu("refresh"); 
```

您可以在 header.php 中添加以下脚本：

```
$(document)
.unbind("pageshow.initMenuBtn")
.bind("pageshow.initMenuBtn", 
    function() {
        $.mobile.activePage = $("div.ui-page-active");
        $("#main_menu", $.mobile.activePage)
          .unbind("change")
          .bind("change", function() {
                var page = $(this).val();
                $.mobile.changePage(page);
            });

        var selectedIndex = 0;
        $("#main_menu>option", $.mobile.activePage).each(function(index) {
            if ($(this).hasClass("current-menu-item")) {
                selectedIndex = index;
            }
        });
        $("#main_menu", $.mobile.activePage)[0].selectedIndex = selectedIndex;
        $("#main_menu", $.mobile.activePage).selectmenu("refresh");
    }); 
```