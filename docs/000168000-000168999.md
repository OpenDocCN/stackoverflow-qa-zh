# StackOverflow 问答 000168000-000168999

# project-management - 你如何保护你的申请免受公司政治的影响？

> ID：168014
> 
> 赞同：3
> 
> 时间：2008-10-03T17:35:14.283
> 
> 标签：project-management

我无法告诉你我有多少次遇到上级说“看，就去做”的情况。这显然是以牺牲计划过程中的刚性为代价的，并且会（可能）影响产品质量。

到现在为止，我在这方面有更多的经验，因此，我有信心支持我们在这里生产的应用程序的质量。

**你会如何处理这个问题？**

有没有人在程序员身上使用过*just do it命令的经理？*为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-06T10:49:24.223

**被上级告知“看看就行”**的最可能原因是信息不对称：你们中的任何一个或两个都知道对方不知道的事情。**经理可能不会告诉你，在问题的宏大计划中，这个特定问题相当不重要，或者他们只是在寻找快速解决方案，因为其他人有很大的压力要快速完成事情，或者他们可能根本不打算这样做坚持足够长的时间来承担后果。**

 **以类似的方式，他们可能无法完全理解与不利选择相关的风险，可能故意做出“错误”选择，因为这有助于他们实现个人目标等。信息不对称[http://en.wikipedia.org /wiki/Information_asymmetry](http://en.wikipedia.org/wiki/Information_asymmetry)是经济学领域的一个众所周知的概念，您可能想阅读该主题。

然而，最可能的原因是迫在眉睫的最后期限，缺乏计划，因此完全没有时间进行任何操作。

**解决方案**很多。有两个最适合我：

**a)**改善沟通；更频繁、更有效地沟通。这意味着更多地倾听，试图了解问题是否在于缺乏对质量低劣相关风险的理解、缺乏对软件质量的认识以及走捷径对未来可维护性的不利影响（这让我吃惊的是，这通常是同样的人只会购买质量最好的非常昂贵的汽车，并坚持在构建软件时走捷径，突出了如何对待个人和非个人选择的区别）。

或者问题可能是，虽然实际上完全欣赏软件质量的价值并了解未来系统可维护性的影响（以我个人的经验，这不太常见），但他们有意识地决定走一条更便宜的路线。

从本质上讲，这里的沟通并不意味着试图积极推销你的想法，而是试图从环境和经理那里吸收尽可能多的信息。然后，弄清楚下一步会容易得多。

**b)**联盟和伙伴关系。联盟的价值怎么强调都不为过。即使您的经理或项目发起人没有为质量提供足够的支持（这是他们工作的一部分），正确的联盟也可以帮助显着改善事情。找到那些关心和团结的人。当项目经理不关心时，它可以是关心的项目发起人，或者当团队成员不关心时，它可以是项目经理。它可以是质量经理、主管、开发人员同事或业务分析师或测试人员。坏人会退出或让你独自做正确的事情，然后肯定会跳上船来收集学分。看看政客，当他们试图实现某些目标时，他们首先要做的就是组建联盟。很遗憾，

找一个对项目的成功或失败、项目质量有重大利害关系的人，并让他们成为盟友。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T17:38:26.303

我发现能够估计任务的完成时间非常重要。如果一个经理给你一个疯狂的任务，能够在相对较短的时间内告诉他一个现实的期望，即完成他们梦想的任务所需的时间。至少通过这种方式，经理可以决定完成任务对他/她有多重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T17:47:54.943

通常，我与经理有良好的工作关系。我通常尝试做的是给他们权衡：“我可以这样做，但是……如果我这样做了……”，然后我让他们做出决定。我曾经设计了一个去规范化的数据库——针对每种查询类型完全扁平化的表结构——因为老板的老板要求我这样做。我工作了 1 个月，我知道，因为我的老板事先与我分享了该项目的历史，否则我可能无法说服他这样做。他只是讨厌各种加入。现在老板走了，我的积压工作中有一个项目来重做原始数据库以添加一些扩展，我会在重构时对其进行规范化。现在我在这里待的时间更长了，我更有可能接受我提供的替代方案，部分原因是我

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T18:10:31.513

无论你向老板提出什么建议，都要确保它在 Powerpoint 中看起来不错。如果它在 Powerpoint 中看起来不错，那么他（或她）很可能会选择它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T18:15:52.203

我确保记录该老板的要求，完成代码并记录它，并就如何改进流程提出书面“建议”。我将这些建议放在代码注释、文档和我通常编写的一页规范中。

我的大部分“只管去做”的工作都是因为老板想让 X 发生并且懒得做任何计划。所以我通过写下我对所有文书工作的反对来掩盖我的屁股，但通过“只是做它”来保住我的工作（和我的薪水）

我不再在那里工作，那家公司永远不会像我现在所在的地方那样大或在项目上取得成功。缺乏流程和“只管去做”的心态是小公司的标志。我通过换上一套新衣服来推进我的职业生涯来处理它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T18:29:15.593

参加“如何销售”课程，或认真阅读《卖给傻瓜》，这完全是关于你如何提出解决方案并出售你希望他们购买的想法。在成为全职软件工程师之前，我做过一段时间的销售工作，我真的可以看到我在那里学到的东西的价值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T17:49:47.840

其中一些问题是由错误的规范引起的。

但是您还需要考虑经理是否真的最了解？（是的，有时会发生！）他们可能知道您没有的一些信息。

最后，如果您必须一直处理这个问题，您可能需要寻找另一个职位。

看看这本书，它详细讨论了政治： [http ://www.amazon.co.uk/Career-Programmer-Guerilla-Tactics-Imperfect/dp/1590596242/ref=sr_1_2?ie=UTF8&s=books&qid=1223055601&sr =8-2](http://www.amazon.co.uk/Career-Programmer-Guerilla-Tactics-Imperfect/dp/1590596242/ref=sr_1_2?ie=UTF8&s=books&qid=1223055601&sr=8-2)

# c++ - 将 BSTR 转换为 int

> ID：168017
> 
> 赞同：4
> 
> 时间：2008-10-03T17:36:37.167
> 
> 标签：c++, winapi

有谁知道如何在 VC++ 2008 中将 BSTR 转换为 int

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-03T17:39:58.190

您可以[将 BSTR 安全地传递](https://stackoverflow.com/questions/71980/how-do-you-efficiently-copy-bstr-to-wchart)给任何期望`wchar_t *`. 所以可以使用[_wtoi](http://msdn.microsoft.com/en-us/library/yd5xkb5c(VS.80).aspx) ()。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-03T17:37:43.450

谷歌建议[`VarI4FromStr`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221194%28v=vs.85%29.aspx)：

```
HRESULT VarI4FromStr(
  _In_   LPCOLESTR strIn,
  _In_   LCID lcid,
  _In_   ULONG dwFlags,
  _Out_  LONG *plOut
); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-03T17:38:48.550

试试[_wtoi](http://msdn.microsoft.com/en-us/library/yd5xkb5c(VS.80).aspx)函数：

```
int i = _wtoi( mybstr ); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T17:41:02.070

您应该使用 ::VarI4FromStr(...)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T17:38:40.563

```
BSTR s = SysAllocString(L"42");
int i = _wtoi(s); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T17:41:16.877

你应该可以使用 boost::lexical_cast<>

```
#include <boost/lexical_cast.hpp>
#include <iostream>

int main()
{
    wchar_t     plop[]  = L"123";
    int value   = boost::lexical_cast<int>(plop);

    std::cout << value << std::endl;
} 
```

很酷的是 lexical_cast<>
它将适用于任何可以通过流传递的类型并且它的**类型是安全**的！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T18:26:19.703

这是我用来从字符串中解析值的方法。它类似于[Boost 的 lexical cast](http://www.boost.org/doc/libs/1_36_0/libs/conversion/lexical_cast.htm)。

```
std::wistringstream iss(mybstr);   // Should convert from bstr to wchar_t* for the constructor
iss >> myint;                      // Puts the converted string value in to myint
if(iss.bad() || iss.fail())
{
   // conversion failed
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-03T22:31:21.407

您应该像其他人指出的那样使用[VarI4FromStr 。](http://msdn.microsoft.com/en-us/library/ms221194.aspx)`BSTR`不是`wchar_t*`因为它们的[NULL 语义](http://blogs.msdn.com/ericlippert/archive/2003/09/12/52976.aspx)不同（`SysStringLen(NULL)`可以，但`wcslen(NULL)`不是）。

# python - Python 库中的命名约定

> ID：168022
> 
> 赞同：1
> 
> 时间：2008-10-03T17:37:47.770
> 
> 标签：python, naming-conventions

我在 python 包中实现了一个搜索算法（我们称之为 MyAlg）。由于算法超级复杂，包必须包含算法选项的辅助类。目前我正在自己开发整个包（我不是程序员），但是我希望以后有 1-2 个程序员加入这个项目。这将是我第一个涉及外部程序员的项目。因此，为了让他们的生活更轻松，我应该如何命名这个类：Options、OptionsMyAlg、MyAlgOptions 或其他任何东西？

[除了http://www.joelonsoftware.com/articles/Wrong.html](http://www.joelonsoftware.com/articles/Wrong.html)之外，你会建议我在这个主题中阅读什么？

谢谢尤里 [从这里发帖：[http](http://discuss.joelonsoftware.com/default.asp?design.4.684669.0) ://discuss.joelonsoftware.com/default.asp?design.4.684669.0将在这两个地方更新答案]

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-03T17:48:02.667

我建议您阅读[PEP8](http://www.python.org/dev/peps/pep-0008/)（Python 代码样式指南）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T17:50:55.593

只是命名它`Options`应该没问题。Python 标准库通常采用命名空间使不同包具有相同名称的事物变得容易和可管理的理念。例如，模块`open`中既是内置函数又是函数`os`，几个不同的模块定义了一个`Error`异常类，等等。

这就是为什么它通常被认为是不好的说法`from some_module import *`，因为它使您不清楚`open`您的代码指的是哪个等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T17:56:15.410

如果它们都适合一个文件，则将类命名为 Options。然后您的用户可以编写：

```
import myalg

searchOpts = myalg.Options()
searchOpts.whatever()

mySearcher = myalg.SearchAlg(searchOpts)
mySearcher.search("where's waldo?") 
```

请注意，另一个答案中引用的 Python 样式指南建议包的名称应全部小写。

# algorithm - 从有序列表创建随机有序列表

> ID：168037
> 
> 赞同：6
> 
> 时间：2008-10-03T17:40:47.610
> 
> 标签：algorithm

我有一个应用程序，它获取制造过程的质量结果并创建图表以显示不良的帕累托图，并显示生产吞吐量。

为了自动化测试这些统计程序的任务，我希望能够确定地将记录添加到数据库中，并让质量技术人员查看某些图表并与已知的良好图表进行比较。但是，我还想模拟结果，以便它们进入数据库，就好像用户正在运行测试过程一样。

我的一个想法是用 i 编号好的、j 编号的 bad1、k 编号的 bad 2 等填充一个列表。然后在插入数据库之前以某种方式随机对列表进行排序。

那么，我的问题是，是否有一种标准算法来获取排序的值列表并创建一个随机排序的列表？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-03T17:51:44.093

你会想要使用[洗牌算法。](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)确保使用正确的洗牌算法而不是自制的算法，因为它可能会给数据引入某种形式的微妙模式。请参阅[Jeff Atwood 的这篇文章，了解使用“足够随机”的随机播放的问题。](http://www.codinghorror.com/blog/archives/001015.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T17:46:20.283

楼主有一篇非常好的洗牌文章，相信一些好的想法可以采纳
[http://www.codinghorror.com/blog/archives/001008.html](http://www.codinghorror.com/blog/archives/001008.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T17:48:11.230

取决于你需要什么“随机性”。最简单的方法可能只是将所有元素放入一个哈希集中并迭代结果。您获得的顺序将是确定性的，但对于大多数意图和目的而言，可以认为是随机的。或者，您可以在列表的 [0..length] 之间生成随机数，挑选出元素并将它们推送到新列表中。假设列表删除是恒定的时间，结果将是一个以 O(n) 效率生成的随机列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T17:48:17.953

```
Random rnd = new Random();
List<int> orderedList = new List<int>();
List<int> randomList = new List<int>();
while (orderedList.Count != 0)
{
    int index = rnd.Next(0, orderedList.Count);
    randomList.Add(orderedList[index]);
    orderedList.RemoveAt(index);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T17:53:08.770

一个简单的答案是有一个数组或向量，循环一次，对于访问的每个位置，从列表的其余部分中随机选择一个元素并将其与当前元素交换。
为此，您需要一个合理的随机数生成器。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-03T17:46:46.850

我以前这样做的方法是让一个循环运行多次，生成介于 0 和列表长度之间的两个随机数，然后交换这两个元素。

# linux - 什么是设置库以支持多平台预编译软件链接的最佳方式，编译选项

> ID：168046
> 
> 赞同：0
> 
> 时间：2008-10-03T17:42:10.650
> 
> 标签：linux, unix, verilog

我正在维护一个库，其中包含需要链接到第 3 方可执行文件的编译对象。有时可执行文件已针对 Solaris 编译，有时作为 32 位 Linux 应用程序，有时是 64 位 Linux 应用程序。我想做的是将一个“路径”传递给库，然后让应用程序自动选择库的正确风格。如果它只在 linux 上工作就可以了，这样我就可以根据操作系统来定义路径。

这种特殊情况适用于我想链接到 Verilog 模拟器的 PLI/VPI 函数库。

我现在拥有的是

```
root/path/${MYPLILIB_VER}/rootname/${MYPLIFLAVOR}/plilib.so 
```

味道是其中之一

```
solaris linux linux64 
```

风味取决于操作系统，如果是 Linux，如果在 64 位平台上运行，它还取决于我正在运行的程序的 32/64 位版本。我正在寻找更好的方法..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T18:29:09.260

使用“uname”给出的系统信息自动设置路径？
'uname -s' 为您提供内核名称（例如 Linux / SunOS）
'uname -i' 将为您提供体系结构（例如 x86 / x86_64）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T18:42:57.110

嗯..它看起来像 ELF 可能会做我想要的.. 现在一些好的应用笔记..

在这篇[关于制作 DSO 的](http://people.redhat.com/drepper/dsohowto.pdf)论文的最后一页上，有一些关于 $PLATFORM 和 $LIB 期望的信息。似乎在 linux 上我应该能够使用 lib lib64 目录结构来保存这两个对象。

关闭以了解更多信息。

[迷失方向的共享对象](http://www.ibm.com/developerworks/library/l-shobj/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T06:54:42.010

我不知道您使用的是哪个模拟器，但您可以尝试将路径放入`LD_LIBRARY_PATH`环境变量中。我相信 Cadence 和 Mentor 模拟器都会出现在那里。我不确定是否支持 VCS。您的模拟器的用户手册将包含详细信息。

# sql-server-2000 - 我的 SQL Server 2000 事务日志大小似乎很小

> ID：168062
> 
> 赞同：1
> 
> 时间：2008-10-03T17:46:19.017
> 
> 标签：sql-server-2000

我想知道为什么当我在事务日志上将恢复模式设置为完全和无限文件增长时，我的 40 GB 数据库上的事务日志只有 2 MB。有任何想法吗？

编辑：我想说每天可能插入几百 MB，并且正在进行大量更新。这是一个驱动一个相当活跃的网站的数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T17:53:27.473

因为你备份了日志，这就是它应该做的？

旁注（鉴于我无法评论）：完整备份不会*截断*日志。只有日志备份或 TRUNCATE_ONLY 命令会截断日志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T17:58:17.933

在 40 GB 中，每天更改多少数据？事务日志只跟踪记录的操作（插入、删除、更新），从不跟踪使用 BCP 或其他批量命令的读取操作或批量复制插入（实际上我不记得用于批量加载数据的 T-SQL 命令是否在 SQL2000 上可用）。
如果您觉得您的日志操作每天需要超过 2 Mb，请检查计划的作业，看看是否有人定期转储日志

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T17:49:41.883

如果您正在执行定期完整备份，则会截断事务日志。

# grails - 如何使用 Grails 重定向文件下载？

> ID：168073
> 
> 赞同：2
> 
> 时间：2008-10-03T17:48:09.747
> 
> 标签：grails, download

我目前正在编写一个允许人们下载 Excel 和文本文件的网站。有没有办法在他们点击时重定向到不同的页面，以便我们运行 javascript 并进行分析（即保持下载计数）？目前，没有什么能阻止用户简单地右键单击并保存。

编辑：

更具体地说，单击或双击文件链接以重定向到临时下载页面进行分析，然后下载文件会很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-05T06:24:30.343

我开始描述您如何在 Grails 中执行此操作，但后来记住了大多数分析服务（Google、Omniture 等）将允许您使用 onclick 事件跟踪下载的文件。如果您正在做一些基于 javascript 的自定义跟踪，您可以做同样的事情。onclick 将在文档开始下载之前被调用。例如：

```
<a href="/path-to-download-file" onclick="record_download('filename')">myfile.txt</a> 
```

更具体地说，对于 Google Analytics，这里有一些 javascript 可以自动执行此操作： [http ://www.goodwebpractices.com/downloads/gatag.js](http://www.goodwebpractices.com/downloads/gatag.js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T18:01:28.240

我不确定你在这里问什么，你是想弄清楚如何在控制器中重定向，还是试图覆盖浏览器中的右键单击行为？

要在控制器中重定向，您可以执行[此处](http://grails.org/doc/1.0.x/)记录的类似操作。

```
redirect(controller:"book",action:"list") 
```

如果您正在尝试更改客户端的按钮或链接行为，并且很可能需要一些 Javascript。

如果您澄清，我可能会提供更多帮助。

# java - JPA 和继承

> ID：168080
> 
> 赞同：1
> 
> 时间：2008-10-03T17:49:21.710
> 
> 标签：java, jpa

我有一些 JPA 实体，它们相互继承并使用鉴别器来确定要创建的类（尚未测试）。

```
@Entity(name="switches")
@DiscriminatorColumn(name="type")
@DiscriminatorValue(value="500")
public class DmsSwitch extends Switch implements Serializable {}

@MappedSuperclass
public abstract class Switch implements ISwitch {}

@Entity(name="switch_accounts")
public class SwitchAccounts implements Serializable {
    @ManyToOne()
    @JoinColumn(name="switch_id")
    DmsSwitch _switch;
} 
```

因此，在 SwitchAccounts 类中，我想使用基类 Switch，因为直到运行时我才知道将创建哪个对象。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T20:23:17.797

作为之前的评论者，我同意类模型应该不同。我认为以下内容就足够了：

```
@Entity(name="switches")
@DiscriminatorColumn(name="type")
@DiscriminatorValue(value="400")
public class Switch implements ISwitch {
  // Implementation details
}

@Entity(name="switches")
@DiscriminatorValue(value="500")
public class DmsSwitch extends Switch implements Serializable {
  // implementation
}

@Entity(name="switches")
@DiscriminatorValue(value="600")
public class SomeOtherSwitch extends Switch implements Serializable {
  // implementation
} 
```

您可以通过使构造函数受保护来直接阻止 Switch 的实例化。我相信 Hibernate 接受了这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T19:17:29.990

由于您的开关类不是实体，因此不能在实体关系中使用它......不幸的是，您必须将映射超类转换为实体以使其参与关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T19:16:12.660

我认为您无法使用当前的对象模型。Switch 类不是实体，因此不能在关系中使用。@MappedSuperclass 注解是为了方便而不是为了编写多态实体。没有与 Switch 类关联的数据库表。

您要么必须使 Switch 成为实体，要么以其他方式更改事物，以便拥有一个作为实体的公共超*类*。

# java - 在 Hibernate 中进行分页是否有比执行选择和计数查询更有效的方法？

> ID：168084
> 
> 赞同：39
> 
> 时间：2008-10-03T17:50:31.100
> 
> 标签：java, mysql, hibernate, pagination, hql

通常分页查询看起来像这样。有没有更好的方法，而不是制作两个几乎相等的方法，一个执行“select *...”，另一个执行“count *...”？

```
public List<Cat> findCats(String name, int offset, int limit) {

    Query q = session.createQuery("from Cat where name=:name");

    q.setString("name", name);

    if (offset > 0) {
        q.setFirstResult(offset);
    }
    if (limit > 0) {
        q.setMaxResults(limit);
    }

    return q.list();

}

public Long countCats(String name) {
    Query q = session.createQuery("select count(*) from Cat where name=:name");
    q.setString("name", name);
    return (Long) q.uniqueResult();
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-08T17:30:18.407

MySQLPerformanceBlog.com 的 Baron Schwartz 撰写了一篇[关于](http://www.mysqlperformanceblog.com/2008/09/24/four-ways-to-optimize-paginated-displays/)此的文章。我希望这个问题有灵丹妙药，但没有。他提出的选项摘要：

1.  在第一个查询中，获取并缓存所有结果。
2.  不要显示所有结果。
3.  不要显示总数或到其他页面的中间链接。仅显示“下一个”链接。
4.  估计有多少结果。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-10-22T01:34:06.240

我的解决方案适用于 Hibernate+Spring+MySQL 的非常常见的用例

与上述答案类似，我的解决方案基于[Richard Kennar 博士的](http://blog.kennardconsulting.com/2011/03/mysql-performance-leveraging.html). 然而，由于 Hibernate 经常与 Spring 一起使用，我希望我的解决方案能够很好地与 Spring 以及使用 Hibernate 的标准方法一起工作。因此，我的解决方案使用线程本地和单例 bean 的组合来实现结果。从技术上讲，拦截器在为 SessionFactory 准备的每个 SQL 语句上调用，但它会跳过所有逻辑并且不初始化任何 ThreadLocal(s)，除非它是专门设置为计算总行数的查询。

使用下面的类，您的 Spring 配置如下所示：

```
<bean id="foundRowCalculator" class="my.hibernate.classes.MySQLCalcFoundRowsInterceptor" />
    <!-- p:sessionFactoryBeanName="mySessionFactory"/ -->

<bean id="mySessionFactory"
    class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean"
    p:dataSource-ref="dataSource"
    p:packagesToScan="my.hibernate.classes"
    p:entityInterceptor-ref="foundRowCalculator"/> 
```

基本上，您必须声明拦截器 bean，然后在 SessionFactoryBean 的“entityInterceptor”属性中引用它。如果您的 Spring 上下文中存在多个 SessionFactory 并且您要引用的会话工厂不称为“sessionFactory”，则必须仅设置“sessionFactoryBeanName”。无法设置引用的原因是这会导致无法解析的 bean 之间的相互依赖关系。

使用包装器 bean 的结果：

```
package my.hibernate.classes;

public class PagedResponse<T> {
    public final List<T> items;
    public final int total;
    public PagedResponse(List<T> items, int total) {
        this.items = items;
        this.total = total;
    }
} 
```

然后使用抽象的基础 DAO 类，您必须在进行查询之前调用“setCalcFoundRows(true)”，然后在 [在 finally 块中以确保它被调用]之后调用“reset()”：

```
package my.hibernate.classes;

import org.hibernate.Criteria;
import org.hibernate.Query;
import org.springframework.beans.factory.annotation.Autowired;

public abstract class BaseDAO {

    @Autowired
    private MySQLCalcFoundRowsInterceptor rowCounter;

    public <T> PagedResponse<T> getPagedResponse(Criteria crit, int firstResult, int maxResults) {
        rowCounter.setCalcFoundRows(true);
        try {
            @SuppressWarnings("unchecked")
            return new PagedResponse<T>(
                crit.
                setFirstResult(firstResult).
                setMaxResults(maxResults).
                list(),
                rowCounter.getFoundRows());
        } finally {
            rowCounter.reset();
        }
    }

    public <T> PagedResponse<T> getPagedResponse(Query query, int firstResult, int maxResults) {
        rowCounter.setCalcFoundRows(true);
        try {
            @SuppressWarnings("unchecked")
            return new PagedResponse<T>(
                query.
                setFirstResult(firstResult).
                setMaxResults(maxResults).
                list(),
                rowCounter.getFoundRows());
        } finally {
            rowCounter.reset();
        }
    }
} 
```

然后是一个名为 MyEntity 的 @Entity 的具体 DAO 类示例，它具有字符串属性“prop”：

```
package my.hibernate.classes;

import org.hibernate.SessionFactory;
import org.hibernate.criterion.Restrictions
import org.springframework.beans.factory.annotation.Autowired;

public class MyEntityDAO extends BaseDAO {

    @Autowired
    private SessionFactory sessionFactory;

    public PagedResponse<MyEntity> getPagedEntitiesWithPropertyValue(String propVal, int firstResult, int maxResults) {
        return getPagedResponse(
            sessionFactory.
            getCurrentSession().
            createCriteria(MyEntity.class).
            add(Restrictions.eq("prop", propVal)),
            firstResult, 
            maxResults);
    }
} 
```

最后是完成所有工作的拦截器类：

```
package my.hibernate.classes;

import java.io.IOException;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import org.hibernate.EmptyInterceptor;
import org.hibernate.HibernateException;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.hibernate.jdbc.Work;
import org.springframework.beans.BeansException;
import org.springframework.beans.factory.BeanFactory;
import org.springframework.beans.factory.BeanFactoryAware;

public class MySQLCalcFoundRowsInterceptor extends EmptyInterceptor implements BeanFactoryAware {

    /**
     * 
     */
    private static final long serialVersionUID = 2745492452467374139L;

    //
    // Private statics
    //

    private final static String SELECT_PREFIX = "select ";

    private final static String CALC_FOUND_ROWS_HINT = "SQL_CALC_FOUND_ROWS ";

    private final static String SELECT_FOUND_ROWS = "select FOUND_ROWS()";

    //
    // Private members
    //
    private SessionFactory sessionFactory;

    private BeanFactory beanFactory;

    private String sessionFactoryBeanName;

    private ThreadLocal<Boolean> mCalcFoundRows = new ThreadLocal<Boolean>();

    private ThreadLocal<Integer> mSQLStatementsPrepared = new ThreadLocal<Integer>() {
        @Override
        protected Integer initialValue() {
            return Integer.valueOf(0);
        }
    };

    private ThreadLocal<Integer> mFoundRows = new ThreadLocal<Integer>();

    private void init() {
        if (sessionFactory == null) {
            if (sessionFactoryBeanName != null) {
                sessionFactory = beanFactory.getBean(sessionFactoryBeanName, SessionFactory.class);
            } else {
                try {
                    sessionFactory = beanFactory.getBean("sessionFactory", SessionFactory.class);
                } catch (RuntimeException exp) {

                }
                if (sessionFactory == null) {
                    sessionFactory = beanFactory.getBean(SessionFactory.class); 
                }
            }
        }
    }

    @Override
    public String onPrepareStatement(String sql) {
        if (mCalcFoundRows.get() == null || !mCalcFoundRows.get().booleanValue()) {
            return sql;
        }
        switch (mSQLStatementsPrepared.get()) {

        case 0: {
            mSQLStatementsPrepared.set(mSQLStatementsPrepared.get() + 1);

            // First time, prefix CALC_FOUND_ROWS_HINT

            StringBuilder builder = new StringBuilder(sql);
            int indexOf = builder.indexOf(SELECT_PREFIX);

            if (indexOf == -1) {
                throw new HibernateException("First SQL statement did not contain '" + SELECT_PREFIX + "'");
            }

            builder.insert(indexOf + SELECT_PREFIX.length(), CALC_FOUND_ROWS_HINT);
            return builder.toString();
        }

        case 1: {
            mSQLStatementsPrepared.set(mSQLStatementsPrepared.get() + 1);

            // Before any secondary selects, capture FOUND_ROWS. If no secondary
            // selects are
            // ever executed, getFoundRows() will capture FOUND_ROWS
            // just-in-time when called
            // directly

            captureFoundRows();
            return sql;
        }

        default:
            // Pass-through untouched
            return sql;
        }
    }

    public void reset() {
        if (mCalcFoundRows.get() != null && mCalcFoundRows.get().booleanValue()) {
            mSQLStatementsPrepared.remove();
            mFoundRows.remove();
            mCalcFoundRows.remove();
        }
    }

    @Override
    public void afterTransactionCompletion(Transaction tx) {
        reset();
    }

    public void setCalcFoundRows(boolean calc) {
        if (calc) {
            mCalcFoundRows.set(Boolean.TRUE);
        } else {
            reset();
        }
    }

    public int getFoundRows() {
        if (mCalcFoundRows.get() == null || !mCalcFoundRows.get().booleanValue()) {
            throw new IllegalStateException("Attempted to getFoundRows without first calling 'setCalcFoundRows'");
        }
        if (mFoundRows.get() == null) {
            captureFoundRows();
        }

        return mFoundRows.get();
    }

    //
    // Private methods
    //

    private void captureFoundRows() {
        init();

        // Sanity checks

        if (mFoundRows.get() != null) {
            throw new HibernateException("'" + SELECT_FOUND_ROWS + "' called more than once");
        }

        if (mSQLStatementsPrepared.get() < 1) {
            throw new HibernateException("'" + SELECT_FOUND_ROWS + "' called before '" + SELECT_PREFIX + CALC_FOUND_ROWS_HINT + "'");
        }

        // Fetch the total number of rows

        sessionFactory.getCurrentSession().doWork(new Work() {
            @Override
            public void execute(Connection connection) throws SQLException {
                final Statement stmt = connection.createStatement();
                ResultSet rs = null;
                try {
                    rs = stmt.executeQuery(SELECT_FOUND_ROWS);
                    if (rs.next()) {
                        mFoundRows.set(rs.getInt(1));
                    } else {
                        mFoundRows.set(0);
                    }
                } finally {
                    if (rs != null) {
                        rs.close();
                    }
                    try {
                        stmt.close();
                    } catch (RuntimeException exp) {

                    }
                }
            }
        });
    }

    public void setSessionFactoryBeanName(String sessionFactoryBeanName) {
        this.sessionFactoryBeanName = sessionFactoryBeanName;
    }

    @Override
    public void setBeanFactory(BeanFactory arg0) throws BeansException {
        this.beanFactory = arg0;
    }

} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-03T18:56:33.337

如果您不需要显示总页数，那么我不确定您是否需要计数查询。包括谷歌在内的许多网站都不会在分页结果中显示总数。相反，他们只是说“下一个>”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-27T14:10:47.237

您可以使用[MultiQuery](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html_single/#performance-multi-query)在单个数据库调用中执行两个查询，这样效率更高。也可以生成count查询，不用每次都写。这是一般的想法......

```
var hql = "from Item where i.Age > :age"
var countHql = "select count(*) " + hql;

IMultiQuery multiQuery = _session.CreateMultiQuery()
    .Add(s.CreateQuery(hql)
            .SetInt32("age", 50).SetFirstResult(10))
    .Add(s.CreateQuery(countHql)
            .SetInt32("age", 50));

var results = multiQuery.List();
var items = (IList<Item>) results[0];
var count = (long)((IList<Item>) results[1])[0]; 
```

我想将它包装成一些易于使用的方法会很容易，这样您就可以在一行代码中进行可分页、可计数的查询。

作为**替代方案，如果您愿意在**[nhcontrib](https://nhcontrib.svn.sourceforge.net/svnroot/nhcontrib/trunk/src/NHibernate.Linq/src/)中为 NHibernate 测试正在进行的 Linq ，您可能会发现可以执行以下操作：

```
var itemSpec = (from i in Item where i.Age > age);
var count = itemSpec.Count();
var list = itemSpec.Skip(10).Take(10).AsList(); 
```

显然没有批处理，所以效率不高，但它仍然可以满足您的需求？

希望这可以帮助！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T13:56:59.697

我知道这个问题并且以前也遇到过。对于初学者来说，执行相同 SELECT 条件的双重查询机制确实不是最佳的。但是，它是有效的，在你开始做一些巨大的改变之前，请意识到这可能不值得。

但是，无论如何：

1）如果您在客户端处理小数据，请使用结果集实现，让您将游标设置为集合的末尾，获取其行偏移量，然后将游标重置为第一个之前。

2) 重新设计查询，以便将 COUNT(*) 作为普通行中的额外列。是的，它对每一行都包含相同的值，但它只涉及 1 个额外的整数列。这是用非聚合值表示聚合值的不合适的 SQL，但它可能有效。

3) 重新设计查询以使用估计的限制，类似于所提到的。使用每页的行数和一些上限。例如，只需说“显示 500 个或更多的 1 到 10 个”之类的话。当他们浏览到“显示 X 的 25o 到 260”时，这是一个稍后的查询，因此您可以通过设置相对于页面 * 行/页面的上限来更新 X 估计值。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-03T23:30:26.500

有一种方法

```
mysql> SELECT SQL_CALC_FOUND_ROWS * FROM tbl_name
    -> WHERE id > 100 LIMIT 10;
mysql> SELECT FOUND_ROWS(); 
```

第二个 SELECT 返回一个数字，表示如果没有 LIMIT 子句，第一个 SELECT 将返回多少行。

参考：[FOUND_ROWS()](http://dev.mysql.com/doc/refman/5.1/en/information-functions.html#function_found-rows)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-20T09:47:20.070

我认为解决方案取决于您使用的数据库。例如，我们使用 MS SQL 并使用下一个查询

```
select 
  COUNT(Table.Column) OVER() as TotalRowsCount,
  Table.Column,
  Table.Column2
from Table ... 
```

查询的那部分可以使用数据库指定的 SQL 进行更改。

我们还设置了我们期望看到的查询最大结果，例如

```
query.setMaxResults(pageNumber * itemsPerPage) 
```

并获取 ScrollableResults 实例作为查询执行的结果：

```
ScrollableResults result = null;
try {
    result = query.scroll();
    int totalRowsNumber = result.getInteger(0);
    int from = // calculate the index of row to get for the expected page if any

    /*
     * Reading data form page and using Transformers.ALIAS_TO_ENTITY_MAP
     * to make life easier.
     */ 
}
finally {
    if (result != null) 
        result.close()
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-07T20:17:11.243

在这个 Hibernate wiki 页面上：

[https://www.hibernate.org/314.html](https://www.hibernate.org/314.html)

我提出了一个完整的分页解决方案；特别是，元素的总数是通过滚动到结果集的末尾来计算的，现在有几个 JDBC 驱动程序支持这一点。这避免了第二个“计数”查询。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-17T13:39:30.563

[这是](http://blog.kennardconsulting.com/2011/03/mysql-performance-leveraging.html)Richard Kennard 博士的解决方案（请注意博客评论中的错误修复！），使用[Hibernate 拦截器](http://www.oreillynet.com/onjava/blog/2007/05/interceptors_in_hibernate.html)

总而言之，您将 sessionFactory 绑定到您的拦截器类，以便您的拦截器稍后可以为您提供找到的行数。

您可以在解决方案链接上找到代码。下面是一个示例用法。

```
SessionFactory sessionFactory = ((org.hibernate.Session) mEntityManager.getDelegate()).getSessionFactory();
MySQLCalcFoundRowsInterceptor foundRowsInterceptor = new MySQLCalcFoundRowsInterceptor( sessionFactory );
Session session = sessionFactory.openSession( foundRowsInterceptor );

try {
   org.hibernate.Query query = session.createQuery( ... )   // Note: JPA-QL, not createNativeQuery!
   query.setFirstResult( ... );
   query.setMaxResults( ... );

   List entities = query.list();
   long foundRows = foundRowsInterceptor.getFoundRows();

   ...

} finally {

   // Disconnect() is good practice, but close() causes problems. Note, however, that
   // disconnect could lead to lazy-loading problems if the returned list of entities has
   // lazy relations

   session.disconnect();
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-09-13T16:44:52.180

我找到了一种在休眠状态下进行分页的方法，而无需对大型数据集进行选择计数（*）。看看我为我的答案发布的解决方案。

> [使用分页处理大量数据库条目会随着时间的推移而变慢](https://stackoverflow.com/questions/7395681/processing-a-large-number-of-database-entries-with-paging-slows-down-with-time)

您可以一次执行分页，而无需知道您最初需要多少页

* * *

## 回答 #11

> 赞同：-5
> 
> 时间：2008-10-03T20:54:16.097

这是在休眠中完成分页的方式

```
Query q = sess.createQuery("from DomesticCat cat");
q.setFirstResult(20);
q.setMaxResults(10);
List cats = q.list(); 
```

你可以从休眠文档获得更多信息：[http:](http://www.hibernate.org/hib_docs/v3/reference/en-US/html_single/#objectstate-querying-executing-pagination) //www.hibernate.org/hib_docs/v3/reference/en-US/html_single/#objectstate-querying-executing-pagination 10.4.1.5 和 10.4.1.6 部分给你更灵活的选择。

BR，
~A

# .net - SQL Server 服务代理问题和教程

> ID：168104
> 
> 赞同：1
> 
> 时间：2008-10-03T17:54:55.600
> 
> 标签：.net, sql-server-2005, tsql, sql-server-express, service-broker

我一直在研究在 SQL Server Express 2005 中实现一个外部激活器，并将队列、服务、合同和事件通知添加到数据库中。我还添加了一个触发器来向目标队列发送消息。一切都解析，运行，触发器正在触发。但是，当我从目标队列中选择，或使用快速 T-SQL 脚本从队列中接收时，什么都没有。

我在想：

1.  这怎么可能呢？消息是自动接收的吗？
2.  有什么方法可以在发送消息时检查它是否正确到达？
3.  触发触发器后，是否有更好的方法在服务器上异步运行进程？

顺便说一句，很难找到适用于 Service Broker 的好的教程材料。如果有人有任何资源，请告诉我。现在，我正在从我们公司的在线资源中阅读一本书，但即使这样也很难过滤。

谢谢，

*威廉*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T21:38:30.510

希望在回答您的第一个问题时，您会在 sys.transmission_queue 系统视图中看到一些内容。有关这方面的文档，请参阅 [http://msdn.microsoft.com/en-us/library/ms190336.aspx](http://msdn.microsoft.com/en-us/library/ms190336.aspx)。

如果您使用 Google 搜索，您可能还会发现一些有用的故障排除资源。

戴夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T11:21:53.647

约翰，

我最近才开始研究服务代理，以便在数据库实例之间实现异步消息传递。我发现以下内容对于了解它非常有用。

[http://msdn.microsoft.com/en-us/library/bb839489(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/bb839489(SQL.90).aspx)

# python - Django：如何创建到视图的通用 url 路由？

> ID：168113
> 
> 赞同：8
> 
> 时间：2008-10-03T17:58:05.470
> 
> 标签：python, django, pylons

我有一个非常标准的 django 应用程序，我想知道如何设置 url 路由，这样我就不必将每个 url 显式映射到视图。

例如，假设我有以下观点：`Project, Links, Profile, Contact`. 我宁愿不要`urlpatterns`这样：

```
(r'^Project/$', 'mysite.app.views.project'),
(r'^Links/$', 'mysite.app.views.links'),
(r'^Profile/$', 'mysite.app.views.profile'),
(r'^Contact/$', 'mysite.app.views.contact'), 
```

等等。在[Pylons](http://www.pylonshq.com)中，它很简单：

```
map.connect(':controller/:action/:id') 
```

它会自动获取正确的控制器和功能。Django中有类似的东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T18:49:41.760

```
mods = ('Project','Links','Profile','Contact')

urlpatterns = patterns('',
   *(('^%s/$'%n, 'mysite.app.views.%s'%n.lower()) for n in mods)
) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T19:51:36.410

除非你有*大量*的视图，否则从风格的角度来看，明确地写下来并不算太糟糕。

但是，您可以通过使用`patterns`函数的前缀参数来缩短示例：

```
urlpatterns = patterns('mysite.app.views',
    (r'^Project/$', 'project'),
    (r'^Links/$', 'links'),
    (r'^Profile/$', 'profile'),
    (r'^Contact/$', 'contact'),
) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-03T20:06:35.817

您可能可以按照以下方式使用特殊的视图功能：

```
def router(request, function, module):
    m =__import__(module, globals(), locals(), [function.lower()])
    try:
        return m.__dict__[function.lower()](request)
    except KeyError:
        raise Http404() 
```

然后是这样的urlconf：

```
(r'^(?P<function>.+)/$', router, {"module": 'mysite.app.views'}), 
```

此代码未经测试，但总体思路应该有效，即使您应该记住：

**显式优于隐式。**

# flash - 最佳 Flash 音频/视频 + 交互服务器？

> ID：168114
> 
> 赞同：13
> 
> 时间：2008-10-03T17:58:15.517
> 
> 标签：flash, actionscript-3, sockets, rtmp

我正在寻找有关 Flash 实时服务器的建议。目前，我们使用 Moock 的[Unity](http://www.moock.org/unity/)和[Red5](http://osflash.org/red5)的组合，但存在一些问题。首先，我们正在迁移到 AS3，而 Unity 仅支持 AS2。其次，Red5 对我们来说非常不稳定，我们更喜欢更稳定的东西。我们不能使用官方的 Flash Media Server，它有点超出我们的价格范围（单个许可证的起价[为 4,500 美元）。](http://www.adobe.com/products/flashmediaserver/compare/)

到目前为止，我已经找到了两台看起来可以满足我需求的服务器，[ElectroServer](http://www.electro-server.com/overview.aspx)和[Wowza Media Server](http://www.wowzamedia.com/products.html)。有没有人有这方面的经验，或者有其他服务器可以推荐吗？我正在寻找的主要功能：

1.  稳定的
2.  客户端库中的 AS3 支持
3.  可以扩展服务器端（使用 Java 或其他语言）
4.  支持来自 Flash 客户端（例如网络摄像头）的实时音频/视频
5.  （不是必需的，但非常有帮助）当除 HTTP 或 HTTPS 之外的所有流量都被阻止时的某种通信方法。例如RTMPT（通过HTTP 的隧道RTMP）支持或类似的。
6.  合理的性能，我想在不杀死服务器的情况下连接至少几百个用户。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T19:16:43.763

[试试Wowza](http://www.wowzamedia.com/)吧！我只将它用于网络摄像头录制，但体验非常无缝，与 Red5 相差甚远。另外，作为开发人员，您可以免费使用完整的 Wowza AFAIK，因此您不必相信我的话。它易于安装，他们有很好的代码示例，这真的给了我很好的印象。

另一个有趣的事实是，Wowza 是由曾经从事 FMS 工作的前 Adob​​e/Macromedia 工程师制作的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-24T08:58:13.273

我投票给 ElectroServer - 它非常稳定，价格合理，而且我遇到了经营公司的人，他是个大人物！

1.  稳定 - 是
2.  客户端库中的 AS3 支持 - 是
3.  可以扩展服务器端（使用 Java 或其他语言） - 是
4.  支持来自 Flash 客户端（例如网络摄像头）的实时音频/视频 - 是
5.  （不是必需的，但非常有帮助）当除 HTTP 或 HTTPS 之外的所有流量都被阻止时的某种通信方法。例如RTMPT（通过HTTP 的隧道RTMP）支持或类似的。否 - 但将在下一个版本中支持
6.  合理的性能，我想在不杀死服务器的情况下连接至少几百个用户。是的 - 经过数千名用户的广泛负载测试

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T21:40:56.687

为了将来参考，我们最终选择了 Wowza。Wowza 和 ElectroServer 在大多数方面看起来都非常接近，所以我们尝试在每个方面都做一个小演示来比较。我们在开始使用 ES 时遇到了一些麻烦，所以我们选择了 Wowza。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-24T00:16:21.033

我更喜欢 red5 ，这几个月来它已经开发了很多，我发现它非常稳定。一旦你得到一个应用程序，剩下的就很容易了，你提到的所有要求都是可用的。如果对于“更稳定”，您的意思是 red5 源代码更改太多，是的，如果您使用 svn，但您可以选择其中一个旧版本并在一段时间内拥有一个相当不错的服务器，直到您需要迁移到新版本版本。

也没有像开源这样的东西，您可以更改任何内容并分享它，以便其他人可以帮助改进它，接受并给予，商业解决方案的问题是，即使您获得专业支持或相当稳定的产品，您也会得到当您有非常具体的要求时，回答“我们不支持定制服务器”之类的，所以忘记试验：P

# linux - 什么是 Linux 等效的 GetProcessIoCounters？

> ID：168116
> 
> 赞同：2
> 
> 时间：2008-10-03T17:58:22.537
> 
> 标签：linux, statistics, operating-system

这是 Windows[文档](http://msdn.microsoft.com/en-us/library/ms683218(VS.85).aspx)的链接。

基本上我想获得类似的数据，但在 Linux 上。如果不是所有的都是可能的，那么至少有一些部分是可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T20:17:00.727

看一下`/proc/`*PID*`/io` - 它是带有 PID 的进程的当前 I/O 记帐信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-04T18:57:02.027

如果启用`CONFIG\_TASK\_IO\_ACCOUNTING`，您将在 /proc/<pid>/io 中获得可用信息。这从内核 2.6.20 开始可用，但默认情况下通常不启用（但是，在 Ubuntu 8.04 中似乎已启用）。

您可以在内核源代码树的[Documentation/filesystems/proc.txt](http://lxr.linux.no/linux+v2.6.26.5/Documentation/filesystems/proc.txt)中阅读各种数据项。特别是第[2.14](http://lxr.linux.no/linux+v2.6.26.5/Documentation/filesystems/proc.txt#L2226)节应该很有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T18:01:57.583

查看下的伪文件`/proc/<PID>/`。也许你可以在那里找到你需要的东西。

* * *

看看`man 5 proc`，或失败的内核文档。但是，我看不出有多大希望。对不起。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-05T00:08:57.310

也许你想要 getrusage()？然而，并非所有字段都在 linux 下维护。也许启用`CONFIG_TASK_IO_ACCOUNTING`遗嘱会导致它们得到维护？

# delphi - Delphi中的时间数学

> ID：168119
> 
> 赞同：7
> 
> 时间：2008-10-03T18:00:15.107
> 
> 标签：delphi, date, time

我有一个非常不寻常的问题（对我来说）。我正在编写一个应用程序，它允许用户通过明确的日期（将我的日期更改为 1955 年 6 月 3 日）或使用按钮递增（前进 1 个月）来向前或向后更改他们的系统时间。

我写这篇文章是为了帮助我的一些用户测试一些需要像这样跳转的软件，以模拟计费系统的真实使用情况。

在 Delphi 中更改时间当然非常简单：

```
SetDateTime(2008,05,21,16,07,21,00); 
```

但我不确定 Delphi (2006) 是否有任何内置的日期数学助手，这是我最不喜欢的东西之一:)

对于处理这个问题的最佳方法有什么建议吗？我宁愿保持原生，因为 winapi 日期时间调用很糟糕。

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-05T19:02:24.980

正如 gabr 和 mliesen 所提到的，看看 DateUtils 和 SysUtils[单元](http://docwiki.embarcadero.com/VCL/en/DateUtils)，[有用](http://docwiki.embarcadero.com/VCL/en/SysUtils)的功能包括。

*   [IncDay](http://docwiki.embarcadero.com/VCL/en/DateUtils.IncDay) - 添加或减去天数。
*   [IncMonth](http://docwiki.embarcadero.com/VCL/en/SysUtils.IncMonth) - 加或减月数。
*   [IncWeek](http://docwiki.embarcadero.com/VCL/en/DateUtils.IncWeek) - 增加或减少周数。
*   [IncYear](http://docwiki.embarcadero.com/VCL/en/DateUtils.IncYear) - 添加或减去若干年。
*   [EncodeDate](http://docwiki.embarcadero.com/VCL/en/SysUtils.EncodeDate) - 从年、月和日参数返回 TDateTime 值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-03T18:12:15.050

[DateUtils](http://docwiki.embarcadero.com/CodeExamples/Seattle/en/DateUtils_(Delphi))单元中有很多助手。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T07:40:14.027

如果当前月份的某天在您未来的月份中不存在，您希望发生什么？比如说，1 月 31 日 + 1 个月？如果您增加年份并且开始日期是闰年的 2 月 29 日，您会遇到同样的问题。所以不可能有一个通用的 IncMonth 或 IncYear 函数在所有日期都一致地工作。

对于任何有兴趣的人，我衷心推荐[Julian Bucknall](http://www.boyet.com/Articles/PublishedArticles/Calculatingthenumberofmon.html)关于如何计算两个日期之间的月数和天数的此类计算所固有的复杂性的文章。

以下是唯一可能不会将异常引入通用日期数学的通用日期增量函数。但它只能通过将责任转回给可能具有他/她正在编程的特定应用程序的确切要求的程序员来实现这一点。

[IncDay](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/DateUtils_IncDay.html) - 添加或减去天数。
[IncWeek](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/DateUtils_IncWeek.html) - 增加或减少周数。

但是，如果您必须使用内置函数，那么至少要确保它们执行您希望它们执行的操作。查看 DateUtils 和 SysUtils 单位。拥有这些函数的源代码是 Delphi 最酷的方面之一。话虽如此，这里是内置函数的完整列表：

[IncDay](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/DateUtils_IncDay.html) - 添加或减去天数。
[IncWeek](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/DateUtils_IncWeek.html) - 增加或减少周数。
[IncMonth](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate4/EN/html/delphivclwin32/SysUtils_IncMonth.html) - 加或减月数。
[IncYear](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/DateUtils_IncYear.html) - 添加或减去若干年。

至于您问题的第二部分，如何使用 TDatetime 设置系统日期和时间，以下从另一篇帖子中无耻窃取的代码将完成这项工作：

```
procedure SetSystemDateTime(aDateTime: TDateTime);
var
  lSystemTime: TSystemTime;
  lTimeZone: TTimeZoneInformation;
 begin
  GetTimeZoneInformation(lTimeZone);
  aDateTime := aDateTime + (lTimeZone.Bias / 1440);
  DateTimeToSystemTime(aDateTime, lSystemTime);
  setSystemTime(lSystemTime);
end; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-03T18:05:51.647

VCL 具有双精度类型（TDate 和 TDateTime），您可以在算术运算中使用。

另请参阅 EncodeDate 和 DecodeDate

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T21:38:04.573

SysUtils 单元中有很多助手（正如 gabr 所指出的，在 DateUtils 中也是如此）。

# hardware - 如何与自定义 USB 设备进行双向通信？

> ID：168120
> 
> 赞同：2
> 
> 时间：2008-10-03T18:01:13.917
> 
> 标签：hardware, usb

我计划构建一个 USB 设备，该设备具有一些软件需要响应的按钮，以及软件需要控制的指示器。我是 USB 新手，所以我正在寻找任何可以帮助我入门的指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T18:05:22.897

前阵子做USB开发的时候，发现[USB Central](http://www.lvr.com/usb.htm)上的资料非常有价值。

对于低带宽要求，您可以使用[FT232R](http://www.ftdichip.com/Products/FT232R.htm)之类的东西，它是一种单芯片 USB 串行实现。FTDI 驱动程序很容易获得，并使设备在主机上显示为常规串行端口。这比滚动您自己的 USB 实现（对于任何一端！）要容易几个数量级。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T18:15:42.937

有点模糊，但过去我做过*一点*USB 开发。最简单的东西往往是与 HID 相关的设备，因为用于通信的 USB 子集在双方都非常容易实现。有一些硬件设备本质上是与 HID 一起工作的，你只需定制一些迂回的东西就可以了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T19:32:11.003

[USB 标准](http://www.usb.org/developers/docs/)实际上是非常易读的。虽然如果你只是想创建一个简单的设备可能有点矫枉过正。你可能会得到这样的东西[，](http://www.braintechnology.de/braintechnology/en/usb_fastinterface27.html)它基本上是一个带有 USB 连接器的 8051 控制器以及固件和 DLL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T13:41:17.810

Checkout [WinDriver](http://www.jungo.com/st/windriver_usb_pci_driver_development_software.html)，这是一个商业多平台工具，可让您轻松地在用户模式下实现 USB 驱动程序，源代码在 Linux 和 Windows 之间兼容。

# php - 如何建立自己的 PEAR 频道？

> ID：168136
> 
> 赞同：12
> 
> 时间：2008-10-03T18:06:19.400
> 
> 标签：php, deployment, pear

我正在寻找有关如何为我们的项目设置 PEAR 通道的说明，以便我们可以使用 pear 安装程序部署它。我在网上搜索了一段时间，找不到任何直接的信息。我跟着[这个教程](http://greg.chiaraquartet.net/archives/123-Setting-up-your-own-PEAR-channel-with-Chiara_PEAR_Server-the-official-way.html)有一段时间了，但我花了很长时间才能让它工作。有谁知道如何做到这一点？有没有更简单的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T12:42:11.343

看起来你是少数想要这样做的人之一。您链接到的该教程似乎是最新的（！），但该软件包仍在[开发中](http://pear.chiaraquartet.net/index.php?package=Chiara_PEAR_Server)。该软件包中的文档也不存在。看起来由您来编写文档。或者联系[Greg Beaver](http://greg.chiaraquartet.net/)；您链接到的包和博客文章的作者。他还[写了一本关于 PEAR 的书](https://rads.stackoverflow.com/amzn/click/com/1904811191)（尽管是在 2006 年）。亚马逊的文章提到了这一点：

> 接下来，您将学习如何设置您自己的 PEAR 通道来分发 PHP 应用程序，包括开源和专有的闭源 PHP 应用程序，这些应用程序可以使用 PEAR 安装程序中已经内置的技术进行保护

.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-20T12:22:42.297

您在遵循链接到的教程时遇到什么问题？

[您可以使用 pirum 或 chiara 服务器 ( http://pear.chiaraquartet.net/](http://pear.chiaraquartet.net/) )建立自己的频道，但您也可以考虑在[http://pearfarm.org](http://pearfarm.org)上获得一个帐户并在那里（或在[http://pearhub.org](http://pearhub.org)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-25T14:09:17.480

PEAR[网站现在列出了一些频道服务器](http://pear.php.net/channels/)软件（页面底部）。他们是：

*   [Chiara_PEAR_Server](http://pear.chiaraquartet.net/)
*   [简单通道服务器](http://pear.chiaraquartet.net/)
*   [皮鲁姆](http://www.pirum-project.org/)
*   [梨园](http://pearfarm.org/)

我不会再使用 chiara pear 服务器了；它死了。

# c# - 除了 LINQ 查询，如何在 C# 中使用匿名类型？

> ID：168150
> 
> 赞同：5
> 
> 时间：2008-10-03T18:10:40.247
> 
> 标签：c#, anonymous-types

我一直在努力了解 C# 中的一些新特性，其中一个我没有机会使用的特性是匿名类型。

我了解与 LINQ 查询有关的用法，并且我查看了[这个 SO 帖子](https://stackoverflow.com/questions/48668/how-should-anonymous-types-be-used-in-c)，它提出了类似的问题。我在网上看到的大多数示例都与 LINQ 查询有关，这很酷。我也看到了一些有些人为的例子，但我没有看到任何有价值的东西。

您认为匿名类型确实为您提供了一些实用程序，您是否有一个新颖的用途？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-05T20:46:17.360

稍加思考，您可以将匿名类型转换为 Dictionary<string, object>; Roy Osherove 在这里博客了他的技术：[http ://weblogs.asp.net/rosherove/archive/2008/03/11/turn-anonymous-types-into-idictionary-of-values.aspx](http://weblogs.asp.net/rosherove/archive/2008/03/11/turn-anonymous-types-into-idictionary-of-values.aspx)

Jacob Carpenter 使用匿名类型作为初始化不可变对象的一种方式，其语法类似于对象初始化：http: [//jacobcarpenter.wordpress.com/2007/11/19/named-parameters-part-2/](http://jacobcarpenter.wordpress.com/2007/11/19/named-parameters-part-2/)

匿名类型可以用作一种方法，可以为使用`foreach`语句迭代的集合中的对象的属性提供更易于阅读的别名。（不过，老实说，这实际上只不过是匿名类型与[LINQ to Objects](http://msdn.microsoft.com/en-us/library/bb397919.aspx)的标准用法。）例如：

```
Dictionary<int, string> employees = new Dictionary<int, string>
{
    { 1, "Bob" },
    { 2, "Alice" },
    { 3, "Fred" },
};

// standard iteration
foreach (var pair in employees)
    Console.WriteLine("ID: {0}, Name: {1}", pair.Key, pair.Value);

// alias Key/Value as ID/Name
foreach (var emp in employees.Select(p => new { ID = p.Key, Name = p.Value }))
    Console.WriteLine("ID: {0}, Name: {1}", emp.ID, emp.Name); 
```

虽然这个简短的示例没有太大的改进，但如果`foreach`循环更长，参考`ID`并`Name`可能会提高可读性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T18:24:18.973

ASP.NET MVC 路由在所有地方都使用这些对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T19:37:05.410

*有时我怀疑执行类似于*LINQ 查询的操作可能很有用，但碰巧没有使用 LINQ - 但您仍然需要某种投影。我不认为我会使用当前形式的匿名类型来处理与 LINQ 投影完全不同的任何事情。

*我想*看到的一件事是能够使用简单的声明创建“命名”类型，这将以与匿名类型相同的方式生成属性和构造函数，并以相同的方式覆盖 Equals/GetHashCode/ToString（有用） 方式。然后，当需要添加更多行为时，这些类型可以转换为“正常”类型。

再说一次，我不认为我会经常使用它——但每隔一段时间这种能力就会很方便，尤其是在一个类的一些方法中。这可能是在 C# 5 中为不可变类型提供更多支持的更大努力的一部分。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-05T21:11:31.880

补充一下 Justice 所说的，ASP.Net MVC 是我第一次看到这些以有趣和有用的方式使用的地方。这是一个例子：

```
 Html.ActionLink("A Link", "Resolve", new { onclick = "someJavascriptFn();" }) 
```

ASP.Net MVC 使用像这样的匿名类型向 HTML 元素添加任意属性。我想有很多不同的方法可以完成同样的事情，但我喜欢匿名类型的简洁风格，它给事情更多的动态语言感觉。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T18:14:04.453

匿名类型的最大用途是 LINQ，事实上这就是它被创建的原因。

我猜想在 linq 之外使用匿名类型的一个原因是创建一个类似结构的临时对象，例如：

```
var x = new { a = 1, b = 2 }; 
```

在某些情况下，这可能会让你的生活更轻松。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-05T21:39:32.540

我用它们来做模板化的电子邮件，因为如果你使用反射和泛型，它们就很棒。

一些信息可以在这里找到：[http ://www.aaron-powell.com/blog.aspx?id=1247](http://www.aaron-powell.com/blog.aspx?id=1247)

# python - 尽早初始化cherrypy.session

> ID：168167
> 
> 赞同：3
> 
> 时间：2008-10-03T18:16:08.803
> 
> 标签：python, cherrypy

我喜欢 CherryPy 的会话 API，除了一个细节。而不是说`cherrypy.session["spam"]`我想能够说`session["spam"]`。

不幸的是，我不能简单地`from cherrypy import session`在我的一个模块中使用全局变量，因为`cherrypy.session`直到第一次发出页面请求时才会创建该对象。有没有办法让 CherryPy 立即初始化其会话对象，而不是在第一页请求上？

如果答案是否定的，我有两个丑陋的选择：

首先，我可以做这样的事情

```
def import_session():
    global session
    while not hasattr(cherrypy, "session"):
        sleep(0.1)
    session = cherrypy.session

Thread(target=import_session).start() 
```

这感觉就像一个大杂烩，但我真的很讨厌`cherrypy.session["spam"]`每次都写，所以对我来说这是值得的。

我的第二个解决方案是做类似的事情

```
class SessionKludge:
    def __getitem__(self, name):
        return cherrypy.session[name]
    def __setitem__(self, name, val):
        cherrypy.session[name] = val

session = SessionKludge() 
```

但这感觉就像一个更大的kludge，我需要做更多的工作来实现其他字典功能，例如`.get`

所以我肯定更喜欢一种简单的方法来自己初始化对象。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-04T05:12:53.407

对于 CherryPy 3.1，您需要找到 Session 的正确子类，运行它的“setup”类方法，然后将cherrypy.session 设置为 ThreadLocalProxy。这一切都发生在cherrypy.lib.sessions.init中，在以下块中：

```
# Find the storage class and call setup (first time only).
storage_class = storage_type.title() + 'Session'
storage_class = globals()[storage_class]
if not hasattr(cherrypy, "session"):
    if hasattr(storage_class, "setup"):
        storage_class.setup(**kwargs)

# Create cherrypy.session which will proxy to cherrypy.serving.session
if not hasattr(cherrypy, "session"):
    cherrypy.session = cherrypy._ThreadLocalProxy('session') 
```

减少（用你想要的子类替换 FileSession）：

```
FileSession.setup(**kwargs)
cherrypy.session = cherrypy._ThreadLocalProxy('session') 
```

“kwargs”由“timeout”、“clean_freq”和来自 tools.sessions.* 配置的任何子类特定条目组成。

# c# - 公共变量与带有访问器的私有变量

> ID：168169
> 
> 赞同：24
> 
> 时间：2008-10-03T18:16:26.477
> 
> 标签：c#, oop, accessor

有没有其他人见过人们这样做：

```
private string _name;
public string Name{ get{ return _name; } set{ _name = value;}}
```

如果您要对它的设置方式进行某种控制或在有获取时对其执行某种功能，我理解使用访问器。但是，如果您只是要这样做，为什么不一开始就将变量设为 public 呢？我错过了什么吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-03T18:27:47.313

如果您使成员成为公共字段，那么您以后不能在不更改类接口的情况下将其重构为属性。如果从一开始就将其作为属性公开，则可以对属性访问器函数进行所需的任何更改，并且类的接口保持不变。

请注意，从 C# 3.0 开始，您可以在不创建支持字段的情况下实现属性，例如：

```
public string Name { get; set; } 
```

这消除了首先不将公共字段实现为属性的唯一理由。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-03T18:26:02.260

如果您在程序集 A 中定义具有属性的公共接口，则可以在程序集 B 中使用此接口。

现在，您可以更改属性的实现（也许从数据库中获取值而不是将其存储在字段中）。然后您可以重新编译程序集 A，并替换旧的程序集。程序集 B 可以正常运行，因为界面不会改变。

但是，如果您最初是使用公共字段开始的，并且认为这不合适并想要更改实现并且需要将其转换为属性，那么这意味着您必须更改程序集 A 的公共接口。该接口的任何客户端（包括程序集 B）也必须重新编译和替换才能使用这个新接口。

所以，你最好从一个属性开始。这封装了属性的实现，让您可以在未来自由更改它，而不必担心使用程序集 A 已经存在哪些客户端（包括程序集 B）。因为，如果世界上已经存在任何客户端使用程序集 A，更改接口会破坏所有客户端。如果它们被您公司的另一个团队或其他公司使用，那么如果您通过更改您的界面来破坏他们的程序集，他们将不高兴！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-03T18:23:38.100

这个想法是，如果您使用访问器，则可以在不更改 API 的情况下更改底层实现。例如，如果您决定在设置名称时还需要更新文本框或其他变量，则无需更改任何客户端代码。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-06T13:46:04.790

可能值得注意的是，.NET 中的 DataBinding 也拒绝处理公共字段并要求属性。所以这可能是另一个原因。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-03T18:27:34.007

良好的编程习惯。这是一种非常常见的模式，适合 OO 设计方法。通过公开一个公共字段，您可以公开该数据如何存储的内部结构。相反，使用公共属性可以让您更灵活地更改数据在内部存储的方式，而不会破坏公共接口。它还允许您更好地控制访问数据时发生的情况（延迟初始化、空检查等）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-03T19:05:11.260

变量是类实现的一部分。属性更合乎逻辑地表示它的接口。在 C# 3.0 中，自动实现的属性让这一切从一开始就变得轻而易举。

[在一篇关于该主题的文章中，](http://csharpindepth.com/Articles/Chapter8/PropertiesMatter.aspx)我已经写了更多关于此的想法，包括从变量更改为属性的各种方式不仅会破坏二进制兼容性，还会破坏源代码兼容性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T18:19:22.947

准备。您永远不知道什么时候需要删除 set 访问器，在 setter 中执行其他操作，或更改 get 的数据源。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-03T18:20:35.877

可公开访问的成员通常应该是方法而不是字段。这只是一种很好的做法，这种做法可以帮助您确保对象的封装状态始终在您的控制之下。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-03T19:18:20.550

对于封装，不建议使用公共字段。

[http://my.safaribooksonline.com/9780321578815/ch05lev1sec5?displaygrbooks=0](http://my.safaribooksonline.com/9780321578815/ch05lev1sec5?displaygrbooks=0)

正如克里斯安德森在本书后面所说的那样，如果调用者对字段与属性的区别视而不见，那将是理想的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-03T19:33:39.440

为了保持高度的可扩展性而无需重新编译所有程序集，您希望使用公共属性作为访问器。通过遵循描述您的对象将如何交换数据的“合同”或定义的机制，一组规则将到位。该契约由一个接口强制执行，并由继承此接口的类的 getter 和 setter 实现。

稍后，如果您从该接口创建其他类，您可以灵活地使用属性来遵守合同，但是由于您通过 getter 和 setter 提供数据，因此组装数据的实现或过程可以是任何您想要，以及它返回“合同”期望的类型。

# .net - .net 应用程序可以在 Linux 上运行吗？

> ID：168170
> 
> 赞同：8
> 
> 时间：2008-10-03T18:17:01.437
> 
> 标签：.net, linux

.net 应用程序可以在 linux 上运行吗？

是否有可用的免费/付费互操作库？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-03T18:18:09.967

[Mono](http://www.mono-project.com/)是一个与 .NET 兼容的平台，包括编译器和运行时。[Mono Migration Analyzer](http://www.mono-project.com/Moma)有助于找出兼容性问题。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-03T18:17:51.827

是的，有一些警告。它被称为[Mono](http://en.wikipedia.org/wiki/Mono_(software))。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T18:21:11.927

Mono 项目提供.Net 的 CLR 虚拟机组件的标准兼容实现。他们还对 .Net 的大量框架部分进行了逆向工程。尝试开发 WinForms 应用程序时会遇到重大问题。Mono 提供了一个您可以使用的几个图形工具包的列表：[http](http://www.mono-project.com/Gui_Toolkits) ://www.mono-project.com/Gui_Toolkits （看起来它们现在实际上支持 WinForms；虽然我不确定这种支持的程度）。

请注意，Silverlight 的 Mono 端口 Moonlight 得到了 Microsoft 的正式认可。因此，如果您可以侥幸使用它，那么它可能是您实现跨平台兼容性的最佳选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T20:39:22.850

请注意，您有[dotGNU 项目](http://www.dotgnu.org)。它是 .NET for linux 的实现。

它们不像 Mono 那样功能完整。但值得一提。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-03T19:59:49.133

问题首次在这里发布 10 年后！现在您可以在 Linux 和 iOS 上运行 .Net。新一代 .Net 被称为 dotnet core，是框架的未来。 [https://docs.microsoft.com/en-us/dotnet/core/](https://docs.microsoft.com/en-us/dotnet/core/)

# regex - 用于解析名称值对的正则表达式

> ID：168171
> 
> 赞同：18
> 
> 时间：2008-10-03T18:17:11.093
> 
> 标签：regex

有人可以提供一个正则表达式来解析字符串中的名称/值对吗？这些对由逗号分隔，并且可以选择将值括在引号中。例如：

```
AssemblyName=foo.dll,ClassName="SomeClass",Parameters="Some,Parameters" 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-03T18:22:50.660

*   **无处可逃：**

    ```
    /([^=,]*)=("[^"]*"|[^,"]*)/ 
    ```

*   **键和值的双引号转义：**

    ```
    /((?:"[^"]*"|[^=,])*)=((?:"[^"]*"|[^=,])*)/

    key=value,"key with "" in it"="value with "" in it",key=value" "with" "spaces 
    ```

*   **反斜杠字符串转义：**

    ```
    /([^=,]*)=("(?:\\.|[^"\\]+)*"|[^,"]*)/

    key=value,key="value",key="val\"ue" 
    ```

*   **完整的反斜杠转义：**

    ```
    /((?:\\.|[^=,]+)*)=("(?:\\.|[^"\\]+)*"|(?:\\.|[^,"\\]+)*)/

    key=value,key="value",key="val\"ue",ke\,y=val\,ue 
    ```

**编辑：**添加了转义选项。

**Edit2：**添加了另一个转义选项。

您必须通过删除任何转义字符和周围的引号来清理键/值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T18:57:27.207

MizardX 的回答很好。小问题 - 它不允许名称等周围有空格（这可能无关紧要），它收集引号以及引用的值（这也可能无关紧要），并且它没有用于嵌入的转义机制引用值中的双引号字符（再一次，这可能无关紧要）。

正如所写，该模式适用于大多数扩展的正则表达式系统。解决这些问题可能需要使用 Perl。这个版本使用双引号来转义——因此 a="a""b" 生成一个字段值 'a""b' （这并不完美，但可以很容易地在之后修复）：

```
/\s*([^=,\s]+)\s*=\s*(?:"((?:[^"]|"")*)"|([^,"]*))\s*,?/ 
```

此外，您必须使用 2 美元或 3 美元来收集价值，而使用 MizardX 的答案，您只需使用 2 美元。所以，它并不容易或好，但它涵盖了一些边缘情况。如果更简单的答案就足够了，请使用它。

测试脚本：

```
#!/bin/perl -w

use strict;
my $qr = qr/\s*([^=,\s]+)\s*=\s*(?:"((?:[^"]|"")*)"|([^,"]*))\s*,?/;

while (<>)
{
    while (m/$qr/)
    {
        print "1= $1, 2 = $2, 3 = $3\n";
        $_ =~ s/$qr//;
    }
} 
```

这意味着 2 美元或 3 美元是未定义的 - 准确地说。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T16:26:59.347

如果你可以使用，我会这样做`Perl 5.10`。

```
qr/
  (?<键>
    （？：
      [^=,\\]
    |
      （？＆逃脱）
    )++ # 防止空键
  )

  \s**
  =
  \s**

  (?<值>
    （？）
  |
    （？：
      [^=,\s\\]
    |
      （？＆逃脱）
    )++ # 防止空值（为此使用引号）
  )

  （？（定义）
    (?<转义>\\.)
    (?<引用>
      "
        （？：
          (?&转义)
        |
          [^"\\]
        )*+
      "
    )
  )
/X

```

这些元素将通过`%+`.

*[`perlretut`](http://perldoc.perl.org/perlretut.html)对创建这个答案非常有帮助。*

# c# - 更改发送给客户端的文件名？

> ID：168173
> 
> 赞同：8
> 
> 时间：2008-10-03T18:17:32.777
> 
> 标签：c#, asp.net, http

我有一个网页，它从数据库中提取信息，将其转换为 .csv 格式，并将文件写入 HTTPResponse。

```
string csv = GetCSV();
Response.Clear();
Response.ContentType = "text/csv";
Response.Write(csv); 
```

这可以正常工作，并且文件可以毫无问题地发送到客户端。但是，当文件发送到客户端时，会使用当前页面的名称，而不是更友好的名称（如“data.csv”）。

![替代文字](https://ktrauberman.files.wordpress.com/2008/10/exportcsv.gif)

我的问题是，如何在不将文件写入磁盘并将客户端重定向到文件的 url 的情况下更改写入输出流的文件的名称？

**编辑：感谢大家的回复。我得到了 4 个相同的响应，所以我只选择了第一个作为答案。**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-03T18:20:01.320

我相信这对你有用。

```
Response.AddHeader("content-disposition", "attachment; filename=NewFileName.csv"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T18:20:32.630

您只需要设置**Content-Disposition**标头

```
Content-Disposition:  attachment; filename=data.csv 
```

* * *

这篇 Microsoft 支持文章有一些很好的信息

[如何为已知 MIME 类型打开“文件下载”对话框](http://support.microsoft.com/kb/260519)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T18:20:03.880

添加一个值为“附件；文件名=文件名.csv”的“内容处置”标题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T18:20:22.430

```
Response.AddHeader("content-disposition", "attachment; filename=File.doc") 
```

# insert - 双击双插入分辨率？

> ID：168181
> 
> 赞同：1
> 
> 时间：2008-10-03T18:19:27.767
> 
> 标签：insert, primary-key, double-click

一名团队成员在使用旧的内部系统时遇到了问题，其中用户双击网页上的链接可能会导致从浏览器发送两个请求，从而导致在比赛中同一记录的两个数据库插入健康）状况; 最后一个运行失败，主键违规。已经提出并讨论了几种解决方案和技巧：

1.  在网页上使用 Javascript 通过禁用第一次点击时的链接来减少第二次点击。这是减少问题发生的一种快速简便的方法，但不能完全消除它。

2.  将服务器端的请求执行包装在事务中。由于相关表上的服务器负载和锁定级别，这被认为过于昂贵的操作。

3.  捕获失败的插入引发的主键异常，将其识别为这样，然后吃掉它。这具有以下缺点：(a) 供应商锁定，必须知道特定于数据库的异常的细微差别，以及 (b) 可能不记录/处理合法的数据库故障。

4.  #3 的扩展，通过在插入失败时尝试更新记录并检查更新结果以确保它返回 1 条受影响的记录。

是否还有其他未考虑的选项？被忽视的选项是否有优缺点？万恶之中，孰轻孰重？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T18:22:57.057

将唯一标识符放在页面上的隐藏字段中。仅接受具有给定唯一标识符的一个响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T18:23:17.603

听起来您可能会滥用 GET 请求来修改服务器状态（尽管不一定是这种情况）。虽然它可能不适合您的情况，但应该说明您应该考虑将链接转换为表单 POST。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T10:37:17.600

您需要实现同步器令牌模式。

它的工作原理是：在服务器上为每个请求生成一个值（令牌）。然后必须在您的表单提交中包含相同的令牌。收到请求后，将比较服务器令牌和客户端令牌，如果它们相同，您可以继续添加您的记录。然后重新生成服务器端令牌，因此包含旧令牌的后续请求将失败。

[在本页](http://www.corej2eepatterns.com/Design/PresoDesign.htm)的中途有更详尽的解释。

我不确定您使用的是什么技术，但是 Struts 为这种模式提供了框架级别的支持。[在此处](http://saloon.javaranch.com/cgi-bin/ubb/ultimatebb.cgi?ubb=get_topic&f=58&t=006245)查看示例

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T18:23:12.390

您似乎已经在那里回答了您自己的问题；#1 似乎是唯一可行的选择。

否则，您真的应该完成所有三个步骤——数据完整性应该在数据库级别处理，但代码中的额外检查（例如显式事务）以避免往返数据库可能对性能有好处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T10:42:49.353

REF 您需要实现同步器令牌模式。

这是针对 Javascript/HTML 而不是 JAVA

# ruby - 如何在 Windows 上使用 MinGW 制作和编译 Ruby Gems？

> ID：168186
> 
> 赞同：5
> 
> 时间：2008-10-03T18:20:14.487
> 
> 标签：ruby, windows, makefile, rubygems, extconf.rb

尝试在 Windows 机器上更新一些 gem，但对于没有预编译二进制文件的 gem，我不断收到此错误输出：

提供的配置选项：

> ```
>  --with-opt-dir
>     --without-opt-dir
>     --with-opt-include
>     --without-opt-include=${opt-dir}/include
>     --with-opt-lib
>     --without-opt-lib=${opt-dir}/lib
>     --with-make-prog
>     --srcdir=.
>     --curdir
>     --ruby=c:/server/ruby/bin/ruby 
> ```

这些是在安装 gem 期间提供给*extconf.rb* ruby​​ 文件的配置选项。

我已经安装了*MinGW*，所以我应该拥有安装、制作和编译这些 gem 所需的一切。
However, I do not know how to change the configuration for *RubyGems* so that when *extconf.rb* is called it includes the appropriate options pointing to the *MinGW* include directory.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-04T18:12:54.940

有一个[DevKit](http://wiki.github.com/oneclick/rubyinstaller/development-kit)很可能就是您所追求的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T08:19:01.847

我不知道这是否适用于本机 Windows Ruby，但如果您使用 Cygwin 版本并安装了完整的 Cygwin（编译器等），那么您应该没有任何问题 - 我们已经能够使用很多需要编译的东西的宝石。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T12:18:03.230

园丁，

太糟糕了，你没有提到你要更新哪个 gem，你只把选项输出放在那里。

此外，其中一些 gem 需要开发头文件和库，而不仅仅是编译器 (MinGW)。

另外，只要您拥有的 Ruby 构建是使用 MinGW 创建的，MinGW 就可以**工作**。

正在做一些工作来缓解这个问题，但是*所有*平台都需要编译器、头文件和库要求，而不仅仅是 Windows。

[您可以在我的博客](http://blog.mmediasys.com)上找到更多信息和资源

干杯。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T19:33:56.583

我也有同样的问题。

我发现让没有预编译二进制文件（例如 parsetree）的 gem 在 Windows 上运行的唯一方法是使用 Mingw 重新编译 Ruby 源代码，并从我已经拥有的 Visual c++ 安装中复制几个库和应用程序。我复制的内容包括 zlib 库以及 iconv 库和应用程序。

注意：我将此设置用作测试配置。我不会将这样的设置用于生产（因为谁知道当您将库从一个发行版转移到另一个发行版时会发生什么）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-08T18:48:07.800

一般来说，根据我的经验，为 unix 系统设计的代码很难在 MinGW 上运行。对于快速移植，请使用 CygWin。或者将软件的完整端口移植到 Windows 主机，包括使用本机 Windows shell 和 OS API——这在时间上非常昂贵，但如果您计划长期支持 Windows，这是值得的。

不熟悉这个特定的软件包，这只是对尝试将其他一些卑鄙的代码移植到 Windows 的一般观察。

# php - 将 PHP 字符串传递给 JavaScript 变量（并转义换行符）

> ID：168214
> 
> 赞同：393
> 
> 时间：2008-10-03T18:27:03.507
> 
> 标签：php, javascript, escaping, newline

对 PHP 字符串进行编码以输出到 JavaScript 变量的最简单方法是什么？

我有一个包含引号和换行符的 PHP 字符串。我需要将此字符串的内容放入 JavaScript 变量中。

通常，我只会在 PHP 文件中构建我的 JavaScript，比如：

```
<script>
  var myvar = "<?php echo $myVarValue;?>";
</script> 
```

`$myVarValue`但是，当包含引号或换行符时，这不起作用。

* * *

## 回答 #1

> 赞同：545
> 
> 时间：2008-10-03T21:49:08.637

扩展别人的答案：

```
<script>
  var myvar = <?php echo json_encode($myVarValue); ?>;
</script> 
```

使用[json_encode()](http://php.net/json_encode)需要：

*   PHP 5.2.0 或更高版本
*   `$myVarValue`编码为 UTF-8（当然也可以是 US-ASCII）

由于 UTF-8 支持完整的 Unicode，因此可以安全地进行动态转换。

请注意，由于`json_encode`转义正斜杠，即使是包含的字符串也`</script>`将被安全转义以使用脚本块进行打印。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-10-03T18:33:50.967

用 JSON 编码

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-10-03T18:38:29.303

```
function escapeJavaScriptText($string)
{
    return str_replace("\n", '\n', str_replace('"', '\"', addcslashes(str_replace("\r", '', (string)$string), "\0..\37'\\")));
} 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-01-14T13:33:39.663

我遇到了类似的问题，并且了解以下是最佳解决方案：

```
<script>
    var myvar = decodeURIComponent("<?php echo rawurlencode($myVarValue); ?>");
</script> 
```

但是，micahwittman 发布的[链接](http://www.the-art-of-web.com/javascript/escape/)表明存在一些细微的编码差异。PHP 的`rawurlencode()`功能应该符合[RFC 1738](http://www.faqs.org/rfcs/rfc1738)，而 Javascript 的`decodeURIComponent()`.

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-04-23T09:32:45.943

偏执的版本：[逃避每一个字符](http://sixohthree.com/241/escaping)。

```
function javascript_escape($str) {
  $new_str = '';

  $str_len = strlen($str);
  for($i = 0; $i < $str_len; $i++) {
    $new_str .= '\\x' . sprintf('%02x', ord(substr($str, $i, 1)));
  }

  return $new_str;
} 
```

**编辑：**`json_encode()`可能不合适的原因是，有时，您需要防止`"`生成，例如

```
<div onclick="alert(???)" /> 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-11-29T14:16:14.730

```
<script>
var myVar = <?php echo json_encode($myVarValue); ?>;
</script> 
```

或者

```
<script>
var myVar = <?= json_encode($myVarValue) ?>;
</script> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-03-11T16:50:29.197

Micah 下面的解决方案对我有用，因为我必须自定义的网站不是 UTF-8，所以我不能使用 json；我会投票，但我的代表还不够高。

```
function escapeJavaScriptText($string) 
{ 
    return str_replace("\n", '\n', str_replace('"', '\"', addcslashes(str_replace("\r", '', (string)$string), "\0..\37'\\"))); 
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-10-19T09:50:12.717

不过不要运行它`addslashes()`；如果您在 HTML 页面的上下文中，HTML 解析器仍然可以看到`</script>`标记，甚至是中间字符串，并假设它是 JavaScript 的结尾：

```
<?php
    $value = 'XXX</script><script>alert(document.cookie);</script>';
?>

<script type="text/javascript">
    var foo = <?= json_encode($value) ?>; // Use this
    var foo = '<?= addslashes($value) ?>'; // Avoid, allows XSS!
</script> 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-03T18:39:14.887

您可以将其插入隐藏的 DIV，然后将 DIV 的 innerHTML 分配给您的 JavaScript 变量。你不必担心逃避任何事情。请确保不要将损坏的 HTML 放在那里。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-03T18:50:19.730

你可以试试

```
<script type="text/javascript">
    myvar = unescape('<?=rawurlencode($myvar)?>');
</script> 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-01-08T18:19:06.007

1.  不。使用 Ajax，将它放在`data-*`HTML 中的属性中，或者其他有意义的东西中。使用内联脚本会使您的页面更大，并且[可能不安全或仍然允许用户破坏布局](http://codepad.org/jQopjG0k)，除非……</p>

2.  ......你做了一个更安全的功能：

    ```
    function inline_json_encode($obj) {
        return str_replace('<!--', '<\!--', json_encode($obj));
    } 
    ```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-03T18:37:46.230

htmlspecialchars

描述

```
string htmlspecialchars ( string $string [, int $quote_style [, string $charset [, bool $double_encode ]]] ) 
```

某些字符在 HTML 中具有特殊意义，如果要保留其含义，则应由 HTML 实体表示。该函数返回一个字符串，其中包含一些转换；所做的翻译是那些对日常网络编程最有用的。如果您需要翻译所有 HTML 字符实体，请改用 htmlentities()。

此功能可用于防止用户提供的文本包含 HTML 标记，例如在留言板或留言簿应用程序中。

执行的翻译是：

```
* '&' (ampersand) becomes '&amp;'
* '"' (double quote) becomes '&quot;' when ENT_NOQUOTES is not set.
* ''' (single quote) becomes '&#039;' only when ENT_QUOTES is set.
* '<' (less than) becomes '&lt;'
* '>' (greater than) becomes '&gt;' 
```

[http://ca.php.net/htmlspecialchars](http://ca.php.net/htmlspecialchars)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2010-08-27T00:28:00.340

我不确定这是否是不好的做法，但我和我的团队一直在使用混合的 html、JS 和 php 解决方案。我们从想要拉入 JS 变量的 PHP 字符串开始，我们将其命名为：

```
$someString 
```

接下来我们使用页面内隐藏的表单元素，并将它们的值设置为字符串：

```
<form id="pagePhpVars" method="post">
<input type="hidden" name="phpString1" id="phpString1" value="'.$someString.'" />
</form> 
```

然后通过 document.getElementById 定义一个 JS var 就很简单了：

```
<script type="text/javascript" charset="UTF-8">
    var moonUnitAlpha = document.getElementById('phpString1').value;
</script> 
```

现在，您可以在任何想要获取 PHP 字符串值的地方使用 JS 变量“moonUnitAlpha”。这对我们来说似乎非常有效。我们将看看它是否能够承受大量使用。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-10-03T18:35:45.690

如果你使用模板引擎来构建你的 HTML，那么你可以用你想要的任何东西来填充它！

查看[XTemplates](http://www.phpxtemplate.org)。这是一个不错的、开源的、轻量级的模板引擎。

你的 HTML/JS 看起来像这样：

```
<script>
    var myvar = {$MyVarValue};
</script> 
```

# database - 是否可以在同一个 Django 项目中拥有单独的 SQLite 数据库？

> ID：168218
> 
> 赞同：5
> 
> 时间：2008-10-03T18:27:33.070
> 
> 标签：database, django, sqlite, orm

我正在考虑为 Django 项目中的某些应用程序创建一个单独的 SQLite 数据库。
但是，如果可能，我不想使用直接 SQLite 访问。对这些数据库的 Django 风格的 ORM 访问将是理想的。
这可能吗？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-04T12:19:48.333

是的 - 用于此的低级 API 已经到位，目前只是缺少一个方便的高级 API。这些引用来自[James Bennett（Django 的发布经理）在 reddit 编程中](http://www.reddit.com/r/programming/comments/6zinj/django_10_released/)：

> 它已经存在了几个月——对于那些查看代码库的人来说，它是一个非常低级的 API——现在（每个`QuerySet`都由 a 支持`Query`，它反过来接受一个数据库连接作为参数）。没有任何高级别的 API 文档，但我知道有人已经在做并且一直在做多数据库/分片场景之类的事情。
> 
> ...这不一定是需要大写的东西；的`__init__()`方法`QuerySet`接受一个关键字参数`query`，它应该是 的一个实例`django.db.models.sql.Query`。的`__init__()`方法`Query`，反过来，接受一个关键字参数`connection`，它应该是一个实例（一个后端特定的子类为您的数据库）`django.db.backends.BaseDatabaseWrapper`。
> 
> 从那里开始，这很容易；例如，您可以覆盖`get_query_set()`管理器以始终`QuerySet`使用您想要的连接返回 a，或者设置分片逻辑等内容，以根据传入的查询参数等确定要使用的数据库等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-07-21T15:25:03.353

已经支持[http://docs.djangoproject.com/en/dev/topics/db/multi-db/](http://docs.djangoproject.com/en/dev/topics/db/multi-db/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T18:35:56.330

目前没有——每个项目都使用一个数据库，并且每个应用程序都必须存在于其中。如果你想拥有一个特定于应用程序的数据库，你不能通过 Django ORM 来实现。请参阅有关[Multiple Database Support](http://code.djangoproject.com/wiki/MultipleDatabaseSupport)的 Django wiki 页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T18:46:05.357

这还不可能，但是在 wiki 上有一些关于它的讨论，[Multiple Database Support in Django](http://code.djangoproject.com/wiki/MultipleDatabaseSupport)。它也在[DjangoCon 2008 上关于 Django 未来的主题演讲中](http://www.youtube.com/watch?v=M1Qr9rSBGBE)被提出，并成为更高优先级的问题之一。

# c++ - 未解决的外部符号错误从构建库切换到 exe 或 dll

> ID：168232
> 
> 赞同：1
> 
> 时间：2008-10-03T18:30:44.997
> 
> 标签：c++, visual-studio-2005, linker

我正在将应用程序构建为库，但为了确保可以获得所需的输出，我将其切换为生成 exe。一旦我这样做了，我就收到了几个关于未解析的外部符号的错误。

起初我以为我没有为我引用的 3rd 方库设置路径，所以我将文件夹添加到我的路径变量中，甚至将它添加到我的包含、引用和源文件中，只是为了确保我有所有的路径。

我仍然收到错误：

> 错误 LNK2019：未解析的外部符号“__declspec(dllimport) public: static void __cdecl xercesc_2_8::XMLPlatformUtils::Initialize(char const * const,char const * const,class xercesc_2_8::PanicHandler * const,class xercesc_2_8::MemoryManager * const, bool)" (__imp_?Initialize@XMLPlatformUtils@xercesc_2_8@@SAXQBD0QAVPanicHandler@2@QAVMemoryManager@2@_N@Z) 在函数 "void __cdecl xsd::cxx::xml::initialize(void)" (?initialize@xml @cxx@xsd@@YAXXZ)

我在这里问它的原因是因为在 Visual Studio 中，当我将它构建为库时，我没有收到这些错误，但作为 dll 和 exe，我会。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T18:35:58.513

您还需要指定您希望特别链接到该库。链接路径仅告诉链接器您需要查找的数据在哪里，而不是要查找的内容。您还需要指定您要链接到有问题的库（xerces？）。

不幸的是，我不知道如何在 MSVC 中指定它，但它可能位于“链接器选项”下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T18:50:03.943

构建一个库，链接器不需要解析导入的符号。只有当它开始将目标文件和库链接在一起时才会发生这种情况。

这就是为什么您在构建可执行文件时才开始看到错误的原因。

确实，在 VC2008（和 2005，如果我没记错的话）中，使用项目属性 -> 链接器 -> 输入 -> 附加依赖项。您需要的库用空格分隔（奇怪，嘿？）

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T18:52:23.737

正如@coppro 所说，您需要指定要与该库链接。当你构建一个 EXE 或 DLL 时，链接器会运行，它需要找到你正在使用的所有函数，但是要构建一个库，运行库管理器，它不必解析所有函数引用（但是当您在 EXE 中使用该库，您将不得不再次）。

因此，转到项目的选项、链接器选项、输入，并在 Additional Library Paths 下列出定义缺失函数的库 (xerces.lib?)。您可能需要在 Additional Library Paths 下添加其位置。

# asp.net - 如何从 ASP.NET 中的代码隐藏文件访问 IFRAME？

> ID：168236
> 
> 赞同：30
> 
> 时间：2008-10-03T18:31:53.560
> 
> 标签：asp.net, iframe

我正在尝试从代码隐藏 aspx.cs 文件中为 IFRAME html 控件设置属性。

我看到一篇[文章](http://geekswithblogs.net/ranganh/archive/2005/04/25/37635.aspx)说您可以使用 FindControl 来查找非 asp 控件，方法是：

aspx 文件包含：

```
<iframe id="contentPanel1" runat="server" /> 
```

然后代码隐藏文件包含：

```
protected void Page_Load(object sender, EventArgs e)
{
    HtmlControl contentPanel1 = (HtmlControl)this.FindControl("contentPanel1");
    if (contentPanel1 != null)
        contentPanel1.Attributes["src"] = "http://www.stackoverflow.com";

} 
```

除了没有找到控件，contentPanel1 为空。

* * *

**更新 1**

查看呈现的 html：

```
<iframe id="ctl00_ContentPlaceHolder1_contentPanel1"></iframe> 
```

我尝试将代码隐藏更改为：

```
HtmlControl contentPanel1 = (HtmlControl)this.FindControl("ctl00_ContentPlaceHolder1_contentPanel1");

if (contentPanel1 != null)
    contentPanel1.Attributes["src"] = "http://www.clis.com"; 
```

但这没有帮助。

我正在使用 MasterPage。

* * *

**更新 2**

将 aspx 文件更改为：

```
<iframe id="contentPanel1" name="contentPanel1" runat="server" /> 
```

也没有帮助

* * *

**回答**

答案是显而易见的，甚至不值得问最初的问题。如果您有 aspx 代码：

```
<iframe id="contentPanel1" runat="server" /> 
```

并想从代码隐藏文件中访问 iframe，您只需访问它：

```
this.contentPanel1.Attributes["src"] = "http://www.stackoverflow.com"; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-02-07T02:08:32.443

这对我有用。

**ASPX：**

```
<iframe id="ContentIframe" runat="server"></iframe> 
```

我可以通过 id 直接访问 iframe。

**代码背后：**

```
ContentIframe.Attributes["src"] = "stackoverflow.com"; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-03T18:48:16.193

如果 iframe 直接在代码运行的页面上，应该可以直接引用：

```
 contentPanel1.Attribute = value; 
```

如果不是（它在子控件或 MasterPage 中），您将需要对页面的层次结构有一个很好的了解......或者使用编写 FindControl() 递归版本的暴力方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T18:41:34.117

尝试使用

```
this.Master.FindControl("ContentId").FindControl("controlId") 
```

反而。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-20T15:38:30.863

你的 iframe 嵌入在哪里？

有这个代码

```
<body>

<iframe id="iFrame1" runat="server"></iframe>

<form id="form1" runat="server">

<div>
      <iframe id="iFrame2" runat="server"></iframe>
</div>
</form> 
```

我只能访问`iFrame1.Attributes["src"]`iFrame1 而不是 iFrame2。

或者，您可以通过以下方式访问表单中的任何元素：

```
FindControl("iFrame2") as System.Web.UI.HtmlControls.HtmlGenericControl 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T18:34:15.723

尝试在 Load 事件之外实例化 contentPanel1；使其对班级保持全球性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T18:45:46.840

FindControl 方法在执行该方法的“控件”的子控件中查找。尝试以递归方式浏览控件集合。

```
 protected virtual Control FindControlRecursive(Control root, String id)
    {
        if (root.ID == id) { return root; }
        foreach (Control c in root.Controls)
        {
            Control t = FindControlRecursive(c, id);
            if (t != null)
            {
                return t;
            }
        }
        return null;
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-30T11:36:15.713

试试这个。

ContentPlaceHolder cplHolder = (ContentPlaceHolder)this.CurrentMaster.FindControl("contentMain");

HtmlControl cpanel= (HtmlControl)cplHolder.FindControl("contentPanel1");

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-02T11:43:48.900

```
<iframe id="yourIframe" clientIDMode="static" runat="server"></iframe> 
```

您应该能够使用 findcontrol 方法找到您的 iframe。

设置`clientIDMode`以`Static`防止您的对象在渲染时被重命名。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-07T05:52:00.957

您的任何建议都不适合我，这是我的解决方案：

```
add src="<%=_frame1%>" //to the iframe id="frame1" html control
public string _frame1 = "http://www.google.com"; 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-06-17T14:04:29.720

页面

```
<iframe id="fblikes" runat="server"></iframe> 
```

背后的代码

this.fblikes.Attributes["src"] = "/productdetails/fblike.ashx";

非常简单....

# php - 是否可以将 PHP 连接到 SQL Server Compact Edition？

> ID：168240
> 
> 赞同：5
> 
> 时间：2008-10-03T18:32:09.503
> 
> 标签：php, sql-server, sql-server-ce

是否可以将 PHP 连接到 SQL Server Compact Edition 数据库？什么是最好的司机？

* * *

我需要它用于 SQL Server Express 太重的桌面应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-04T01:28:39.287

简短的回答：**没有。**

长答案：据我所知，与 PostgreSQL / MySQL / MS-SQL 不同，没有将 PHP 连接到 SQL Server Compact Edition 的本机驱动程序。

如果要连接到它，最好的办法是使用 PHP ODBC 连接来与连接到 SQL Compact 服务器的 ODBC 驱动程序通信。但这几乎是一种 hack，如果你将这种东西用于任何远程重要的事情，你会发疯的。

如果您担心 SQL Server Express 过于繁重，请将 MySQL 与 MyISAM 表一起使用。它非常快速且轻巧。[Emergent 有一个很好的清单来配置/禁用](http://emergent.urbanpug.com/?p=61)以使 MySQL 更快并使用更少的资源。

相关链接：

[MSDN 帖子问同样的问题](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2775563&SiteID=1)

[Erik EJ 的博客 - 带有 OLE DB 的 SQL Compact](http://erikej.blogspot.com/2008/04/import-sql-compact-data-to-excel.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T03:41:26.133

你也可以考虑 SQLite：

[http://www.devshed.com/c/a/PHP/Introduction-to-Using-SQLite-with-PHP-5/](http://www.devshed.com/c/a/PHP/Introduction-to-Using-SQLite-with-PHP-5/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-04T04:27:33.747

我使用[php-odbtp](http://odbtp.sourceforge.net/install.html)将 PHP（使用[ADOdb](http://adodb.sourceforge.net/)）连接到 MS SQL 服务器，它运行良好，即使跨远程网络也是如此。

它提供从非 odbc 平台 (Linux) 到安装在 Win32 机器上的服务的隧道协议，以缓冲与 ODBC 连接之间的请求。第一次设置有点痛苦，至少 2-3 年前我第一次使用它时。也应该适用于 Win32<->Win32 应用程序。

不熟悉 SQL CE，但我想它支持某种 ODBC 连接和标准 T-SQL 命令。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-23T14:57:47.323

我编写了一个使用 PHP 的 COM 对象处理 SQL 精简版文件的 php 类。

这意味着它只能在安装了 SQL Compact Edition 运行时的基于 Windows 的机器上运行。

You can download here (article is in German, link is at the bottom) with an example database file and script

[http://www.klemmkeil.de/sql-compact-edition-sdf-mit-php-auslesen/](http://www.klemmkeil.de/sql-compact-edition-sdf-mit-php-auslesen/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-03T18:38:02.410

问题是为什么？为什么不直接使用 Express 版本？

我必须说我很好奇，但我不能说我已经将 CE 数据库用于在应用程序文件夹中包含程序集的 .Net 应用程序之外的任何内容。

# c++ - 如何在 C++ 中使用任意字符串作为锁？

> ID：168249
> 
> 赞同：9
> 
> 时间：2008-10-03T18:34:25.363
> 
> 标签：c++, multithreading, concurrency, locking

假设我有一个多线程 C++ 程序，它以函数调用的形式处理请求`handleRequest(string key)`。每次调用都`handleRequest`发生在一个单独的线程中，并且有任意大量的可能值`key`。

我想要以下行为：

*   当对 的同时调用`handleRequest(key)`具有相同的值时，它们将被序列化`key`。
*   全局序列化被最小化。

的主体`handleRequest`可能如下所示：

```
void handleRequest(string key) {
    KeyLock lock(key);
    // Handle the request.
} 
```

**问题：**我将如何实现`KeyLock`以获得所需的行为？

一个天真的实现可能会像这样开始：

```
KeyLock::KeyLock(string key) {
    global_lock->Lock();
    internal_lock_ = global_key_map[key];
    if (internal_lock_  == NULL) {
        internal_lock_  = new Lock();
        global_key_map[key] = internal_lock_;
    }
    global_lock->Unlock();
    internal_lock_->Lock();
}

KeyLock::~KeyLock() {
    internal_lock_->Unlock();
    // Remove internal_lock_ from global_key_map iff no other threads are waiting for it.
} 
```

...但这需要在每个请求的开始和结束时使用全局锁，并为每个请求创建一个单独的`Lock`对象。如果对 的调用之间的争用很高`handleRequest`，那可能不是问题，但如果争用很低，它可能会带来很多开销。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-03T18:38:17.573

你可以做一些类似于你在你的问题中所做的事情，但不是单个 global_key_map 有几个（可能在数组或向量中） - 使用哪个是由字符串上的一些简单哈希函数确定的。

这样，您可以将其分散到几个独立的锁上，而不是单个全局锁。

这是内存分配器中经常使用的一种模式（我不知道该模式是否有名字——应该有）。当一个请求进来时，一些东西决定了分配将来自哪个池（通常是请求的大小，但其他参数也可以考虑在内），然后只需要锁定那个池。如果分配请求来自另一个将使用不同池的线程，则不会出现锁争用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T18:39:14.467

这将取决于平台，但我尝试的两种技术是：

*   使用命名互斥/同步对象，其中对象名称 = 键
*   使用基于文件系统的锁定，尝试使用密钥名称创建不可共享的临时文件。如果它已经存在（=已经锁定），这将失败，您必须轮询重试

这两种技术都取决于您的操作系统的细节。试验一下，看看哪个有效。.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T18:39:45.573

也许 an`std::map<std::string, MutexType>`就是你想要的，你想要`MutexType`的互斥锁的类型在哪里。您可能必须将对映射的访问包装在另一个互斥锁中，以确保没有其他线程同时插入（并记住在互斥锁锁定后再次执行检查以确保另一个线程没有添加等待互斥锁时的键！）。

相同的原则可以适用于任何其他同步方法，例如临界区。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T22:18:07.410

**提高粒度并锁定整个键范围**

这是迈克 B 答案的一个变体，其中没有几个流体锁映射，而是有一个固定的锁阵列，适用于键范围而不是单个键。

简化示例：在启动时创建 256 个锁的数组，然后使用 key 的第一个字节来确定要获取的锁的索引（即所有以 'k' 开头的 key 将由 保护`locks[107]`）。

为了维持最佳吞吐量，您应该分析密钥的分布和争用率。这种方法的好处是零动态分配和简单的清理；您还可以避免两步锁定。不利的一面是，如果密钥分配随着时间的推移而出现偏差，则可能会出现争用高峰。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T22:47:16.133

想了想，另一种方法可能是这样的：

*   在`handleRequest`中，创建一个`Callback`执行实际工作的。
*   创建一个`multimap<string, Callback*> global_key_map`, 受互斥体保护。
*   如果一个线程看到它`key`已经被处理，它将把它添加`Callback*`到`global_key_map`并返回。
*   否则，它会立即调用其回调，然后调用同时出现的同一个键的回调。

实现了这样的事情：

```
LockAndCall(string key, Callback* callback) {
    global_lock.Lock();
    if (global_key_map.contains(key)) {
        iterator iter = global_key_map.insert(key, callback);
        while (true) {
            global_lock.Unlock();
            iter->second->Call();
            global_lock.Lock();
            global_key_map.erase(iter);
            iter = global_key_map.find(key);
            if (iter == global_key_map.end()) {
                global_lock.Unlock();
                return;
            }
        }
    } else {
        global_key_map.insert(key, callback);
        global_lock.Unlock();
    }
} 
```

这样做的好处是可以释放等待键锁的线程，但除此之外，它与我在问题中发布的幼稚解决方案几乎相同。

不过，它可以与 Mike B 和 Constantin 给出的答案结合起来。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T03:57:42.973

```
 /**
      * StringLock class for string based locking mechanism
      * e.g. usage
      *     StringLock strLock;
      *     strLock.Lock("row1");
      *     strLock.UnLock("row1");
      */
      class StringLock    {
      public:
          /**
           * Constructor
           * Initializes the mutexes
           */
          StringLock()    {
              pthread_mutex_init(&mtxGlobal, NULL);
          }
          /**
           * Lock Function
           * The thread will return immediately if the string is not locked
           * The thread will wait if the string is locked until it gets a turn
           * @param string the string to lock
           */
          void Lock(string lockString)    {
              pthread_mutex_lock(&mtxGlobal);
              TListIds *listId = NULL;
              TWaiter *wtr = new TWaiter;
              wtr->evPtr = NULL;
              wtr->threadId = pthread_self();
              if (lockMap.find(lockString) == lockMap.end())    {
                  listId = new TListIds();
                  listId->insert(listId->end(), wtr);
                  lockMap[lockString] = listId;
                  pthread_mutex_unlock(&mtxGlobal);
              } else    {
                  wtr->evPtr = new Event(false);
                  listId = lockMap[lockString];
                  listId->insert(listId->end(), wtr);
                  pthread_mutex_unlock(&mtxGlobal);
                  wtr->evPtr->Wait();
              }
          }
          /**
          * UnLock Function
          * @param string the string to unlock
          */
          void UnLock(string lockString)    {
              pthread_mutex_lock(&mtxGlobal);
              TListIds *listID = NULL;
              if (lockMap.find(lockString) != lockMap.end())    {
                  lockMap[lockString]->pop_front();
                  listID = lockMap[lockString];
                  if (!(listID->empty()))    {
                      TWaiter *wtr = listID->front();
                      Event *thdEvent = wtr->evPtr;
                      thdEvent->Signal();
                  } else    {
                      lockMap.erase(lockString);
                      delete listID;
                  }
              }
              pthread_mutex_unlock(&mtxGlobal);
          }
      protected:
          struct TWaiter    {
              Event *evPtr;
              long threadId;
          };
          StringLock(StringLock &);
          void operator=(StringLock&);
          typedef list TListIds;
          typedef map TMapLockHolders;
          typedef map TMapLockWaiters;
      private:
          pthread_mutex_t mtxGlobal;
          TMapLockWaiters lockMap;
      }; 
```

# python - 如何为 Mac OS X 构建和安装 P4Python？

> ID：168273
> 
> 赞同：2
> 
> 时间：2008-10-03T18:38:40.083
> 
> 标签：python, macos, perforce, p4python

我一直无法为 Intel Mac OS X 10.5.5构建[P4Python 。](http://www.perforce.com/perforce/loadsupp.html#api)

这些是我的步骤：

1.  我下载了 p4python.tgz（来自 [http://filehost.perforce.com/perforce/r07.3/tools/](http://filehost.perforce.com/perforce/r07.3/tools/)）并将其扩展为“P4Python-2007.3”。
2.  我下载了 p4api.tar（来自 [http://filehost.perforce.com/perforce/r07.3/bin.macosx104x86/](http://filehost.perforce.com/perforce/r07.3/bin.macosx104x86/)）并将其扩展为“p4api-2007.3.143793”。
3.  我将“p4api-2007.3.143793”放入“P4Python-2007.3”并编辑 setup.cfg 以设置“p4_api=./p4api-2007.3.143793”。
4.  我在 setup.py 之后添加了行 'extra_link_args = ["-framework", "Carbon"]' ：

    ```
    elif unameOut[0] == "Darwin":
        unix = "MACOSX"
        release = "104"
        platform = self.architecture(unameOut[4]) 
    ```

5.  我跑了`python setup.py build`，得到：

$ python setup.py 构建

```
API Release 2007.3
running build
running build_py
running build_ext
building 'P4API' extension
gcc -fno-strict-aliasing -Wno-long-double -no-cpp-precomp -mno-fused-madd -DNDEBUG -g -O3 -Wall -Wstrict-prototypes -DID_OS="MACOSX104X86" -DID_REL="2007.3" -DID_PATCH="151416" -DID_API="2007.3" -DID_Y="2008" -DID_M="04" -DID_D="09" -I./p4api-2007.3.143793 -I./p4api-2007.3.143793/include/p4 -I/build/toolchain/mac32/python-2.4.3/include/python2.4 -c P4API.cpp -o build/temp.darwin-9.5.0-i386-2.4/P4API.o -DOS_MACOSX -DOS_MACOSX104 -DOS_MACOSXX86 -DOS_MACOSX104X86
cc1plus: warning: command line option "-Wstrict-prototypes" is valid for C/ObjC but not for C++
P4API.cpp: In function âint P4Adapter_init(P4Adapter*, PyObject*, PyObject*)â:
P4API.cpp:105: error: âPy_ssize_tâ was not declared in this scope
P4API.cpp:105: error: expected `;' before âposâ
P4API.cpp:107: error: âposâ was not declared in this scope
P4API.cpp: In function âPyObject* P4Adapter_run(P4Adapter*, PyObject*)â:
P4API.cpp:177: error: âPy_ssize_tâ was not declared in this scope
P4API.cpp:177: error: expected `;' before âiâ
P4API.cpp:177: error: âiâ was not declared in this scope
error: command 'gcc' failed with exit status 1 
```

`which gcc`返回 /usr/bin/gcc 并`gcc -v`返回：

```
Using built-in specs.
Target: i686-apple-darwin9
Configured with: /var/tmp/gcc/gcc-5465~16/src/configure
--disable-checking -enable-werror --prefix=/usr --mandir=/share/man
--enable-languages=c,objc,c++,obj-c++
--program-transform-name=/^[cg][^.-]*$/s/$/-4.0/
--with-gxx-include-dir=/include/c++/4.0.0 --with-slibdir=/usr/lib
--build=i686-apple-darwin9 --with-arch=apple --with-tune=generic
--host=i686-apple-darwin9 --target=i686-apple-darwin9
Thread model: posix
gcc version 4.0.1 (Apple Inc. build 5465) 
```

`python -V`返回 Python 2.4.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-04T09:53:03.403

来自[http://bugs.mymediasystem.org/?do=details&task_id=676](http://bugs.mymediasystem.org/?do=details&task_id=676)表明 Py_ssize_t 是在 python 2.5 中添加的，因此它不适用于 python 2.4（没有一些修改）。

安装/编译您自己的 python 2.5/2.6 副本，或者研究如何更改 P4Python，或者寻找替代的 python-perforce 库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T00:18:32.783

较新的版本 2008.1 将使用 Python 2.4 构建。

我已经在我的 P4Python 页面上发布了执行此操作所需的细微更改，但它们已被纳入官方版本。

罗伯特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-06T16:40:48.320

非常过时，但也许你可以使用[http://public.perforce.com:8080/@md=d&cd=//guest/miki_tebeka/p4py/&c=5Fm@//guest/miki_tebeka/p4py/main/?ac=](http://public.perforce.com:8080/@md=d&cd=//guest/miki_tebeka/p4py/&c=5Fm@//guest/miki_tebeka/p4py/main/?ac=83)目前[83](http://public.perforce.com:8080/@md=d&cd=//guest/miki_tebeka/p4py/&c=5Fm@//guest/miki_tebeka/p4py/main/?ac=83)

# asp.net - 如何在网页中显示嵌入的 excel 文件？

> ID：168280
> 
> 赞同：6
> 
> 时间：2008-10-03T18:39:22.063
> 
> 标签：asp.net, html, excel, embed

我想允许查看嵌入在网页中的 Excel 报告...有没有办法？

*   我不想使用 ActiveX 或 OWC（Office Web 组件），我只想从 Internet Explorer 应用程序中打开现有文件。

*   我不希望用户下载然后打开它。

使用 iframe 不会有问题，但我的初步测试没有成功

有任何想法吗？有可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-03T19:59:11.933

这与本地人的浏览器设置有关，而不是您最终可以做的任何事情。如果他们单击带有 .xls(x) 扩展名的链接，浏览器会确定是要自己打开它还是在新窗口中打开它。

这里有 2 个关于如何更改这些设置的微软页面：

[http://support.microsoft.com/.../how-to-configure-internet-explorer-to-open-office-documents-in-the-app](https://support.microsoft.com/en-us/help/162059/how-to-configure-internet-explorer-to-open-office-documents-in-the-app)

[http://support.microsoft.com/.../embed-your-excel-workbook-on-your-web-page-or-blog-from-sharepoint-or-onedrive-for-business](https://support.microsoft.com/en-us/office/embed-your-excel-workbook-on-your-web-page-or-blog-from-sharepoint-or-onedrive-for-business-7af74ce6-e8a0-48ac-ba3b-a1dd627b7773)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-02-14T21:31:32.453

您应该尝试使用[Excel Web App 嵌入](http://office.microsoft.com/en-us/web-apps-help/embed-an-excel-workbook-on-a-web-page-HA102029502.aspx)功能，该功能可让您将 Excel 中的表格和图表直接嵌入到您的网页上。您甚至可以让用户与电子表格进行交互，以便他们可以对数据进行排序和过滤，并使用您的电子表格公式进行计算，在不更改源的情况下进行自己的计算。

Excel Web 应用程序和存储空间均由 Microsoft 免费提供。所有主要的 destkop 和移动浏览器都可以查看您嵌入网页的任何数据，并且当您更新电子表格时，网页上的数据也会自动更新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T18:43:27.110

我认为您最好的选择是从 Excel 文件中提取数据并将其显示在常规 HTML 表格中。从网页调用 Excel 并不完全安全，而且不是每个人都拥有它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T20:02:04.627

看看[scribd iPaper Viewer](http://www.scribd.com/tools/ipaper) - 这是一个基于 Flash 的 XLS（和其他）文档查看器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T12:04:21.307

MOSS 2007 有一个名为[Excel Services](http://blah.winsmarts.com/2007-3-SharePoint_2007__Excel_Services_-_A_Quick_Introduction.aspx)的漂亮功能，它可能符合要求...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-01-10T05:01:06.777

Excel Web App 允许在网页上嵌入“实时”交互式电子表格。例如，请参阅[http://datawiz.wordpress.com/2011/01/10/how-to-embed-excel-on-a-web-page/](http://datawiz.wordpress.com/2011/01/10/how-to-embed-excel-on-a-web-page/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T19:09:04.170

在您的评论中，您说 Excel 文件在客户端的文件系统上，而不是在网络服务器上。我认为理智浏览器的安全模型禁止这样做；但如果为您的页面设置高权限可以允许这样做，也不会感到惊讶。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-10-03T18:56:11.450

```
<iframe src="file:\\yourpath\yourfile.xls" width="100%" height="500"></iframe> 
```

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2010-05-28T08:06:03.387

嗯，这有点粗糙，但有点符合要求。

1.  选择要显示的电子表格区域。
2.  将此区域复制到 MS Paint 中。
3.  在 Paint 中选择区域并使用 Edit/Copy to/ 功能将其保存为位图。
4.  现在像加载任何其他图片一样加载位图。

# language-agnostic - 什么时候使用 IDE？

> ID：168283
> 
> 赞同：2
> 
> 时间：2008-10-03T18:40:28.130
> 
> 标签：language-agnostic, ide

我知道有些人发誓永远反对使用特定于语言的 IDE（vim/emacs 或死！类型的东西），有些人对在终端中编码/编译真的很不舒服，所以我的问题有以下几个部分。

*   你什么时候从一个切换到另一个
*   甚至有必要知道两者吗？如果没有，您应该知道哪些？
*   轻量级还是重量级 IDE？（只是代码突出显示或您可以想象的每个功能）
*   您一般推荐什么 IDE，为什么？

随意回答所有，一些，或没有。

* * *

到目前为止的简短摘要：

IDE

*   大项目
*   图形用户界面
*   易于版本控制集成？

文本编辑器

*   快速/小型项目
*   更容易适应其他语言
*   更少的开销

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T18:52:35.920

IDE 的使用对个人意见非常主观。有了这个免责声明，这是我的。

了解您的工具并了解您的平台。开发软件是你的领域，所以要擅长它。

你什么时候换？当您的知识告诉您的直觉时，使用其他工具会更容易。

你应该两者都知道吗？我认为您应该了解有关使用您的平台的所有信息。低层次的知识使更高层次的应用程序更容易理解。

轻量级或重量级取决于手头的任务。有时两者都是合适的。

我不能推荐任何一种 IDE，这取决于您的应用程序平台以及您（开发人员）对什么感到满意。如果您正在使用 .NET，Windows 上的 Visual Studio 可能是最好的，但这并不意味着您可以扔掉记事本。对于 Linux 上的 Java，Eclipse 很棒，但不要放弃 vim。

嘿，对于某些人来说，首页可能是适合这项工作的工具（哎呀，是的，我说过了。/me 鸭子）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T19:27:38.703

正如其他几个人所说，您使用哪种 IDE 或是否使用哪种 IDE 在很大程度上取决于您使用的开发语言、项目的规模以及您使用的平台。虽然我从来没有和 Vi 或 Emacs 的人一起驻扎过，但我确实使用了一些其他的编辑工具，大致如下：

C# 或任何其他 .Net：[Visual Studio](http://msdn.microsoft.com/en-us/vstudio/products/default.aspx)。没有激烈的竞争，CLR 语言要求语法高亮、重构和高级文件管理。值得庆幸的是，Microsoft 做到了这一点，并且[Express](http://www.microsoft.com/Express/)版本具有令人难以置信的价值。

C++：我有一段时间没有接触它了，但我通常会在 Visual Studio 中查看代码，但通过批处理文件进行编译，这与我正在开发的特定嵌入式平台的怪癖有很大关系。

Python：如果你需要一些花里胡哨的东西，我推荐[Stani 的 Python 编辑器，但是 Python 的结构非常直接，我通常最终只使用](http://pythonide.stani.be/)[Scite](http://www.scintilla.org/SciTE.html)。它可以在 Python 编辑器中完成您真正需要的一切。

SQL：[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)，或者，如果你做繁重的工作，任何支持的编辑器 + [SQL Prompt](http://www.red-gate.com/Products/SQL_Prompt/index.htm)。

Java：我听说过关于 Eclipse 的好消息，但 Java 是邪恶的，所以我不去碰它。

PHP、Perl、Javascript、BASH 或大多数其他语言：Windows 上的 Notepad++，Linux 上的 Scite。

尽管在所有这些 IDE 之间切换可能会很麻烦，尤其是当您喜欢的某个功能在另一个中丢失时，使用最佳平衡工具来完成您的工作会带来好处。由于我的需求不同，我一直在切换 IDE，我也会鼓励其他人也这样做。在特定平台上完成了数量有限、规模有限的项目后，我几乎不了解所有用例，而且我确信还有很多其他情况和代码编辑器以独特且功能强大的方式配对。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T19:06:01.773

就个人而言，我几乎从不使用 IDE。我几乎只使用 vim/make。这样做有很多好处：

*   完全与语言无关。一旦记住了一些命令和快捷方式，它们就可以用于我的所有项目
*   零件很容易进出。如果我想切换编译器，我会更改我的 makefile 中的变量。
*   “配置不可知论”。不管设置如何，我都可以开发。没有图形用户界面？没问题。不同的桌面环境？没问题。甚至还有 Windows 的 vim 端口。我在本地机器上开发，当我以同样的方式 ssh 进入服务器时。

还有一些缺点：

*   Vim 很难学。我什至不会在这件事上撒谎。获得一些力量需要时间。
*   主要限于 *NIX。是的，有像cygwin这样的东西。是的，有 Vim 到 Windows 的端口。它在某种程度上不完全相同。
*   如果我学习了一个专注于特定语言的 IDE，它可能会具有一些对该语言非常强大的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T18:42:33.973

我通常仅将 IDE 用于调试（哪个 IDE 取决于语言/平台），并使用我的个人编辑器进行代码的实际编辑。

我觉得对所有事情都使用一个编辑器比为我所做的每种语言/平台更改重新学习键绑定要好得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T18:43:45.843

根据我的经验，如果项目涉及构建 GUI，那么 IDE 是非常宝贵的工具。

如果它很小，“直觉”或网络服务，我会专门使用文本编辑器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T18:47:13.140

我的经验法则是，如果语言和 IDE 绑定在一起，则使用 IDE（使用 MS 项目文件查看任何内容）。否则任何编辑都会这样做。我个人喜欢视觉 Slickedit，或者如果公司不打算为 slickedit 掏腰包的话，我喜欢 notepad++。在 linux 方面，我使用 Emacs，您可以将其视为重量级编辑器或轻量级操作系统。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T18:55:37.397

虽然我使用 VIM 和非 IDE 类型的工具，但我不得不承认 Visual Studio（尤其是 2005/2008）可能是有史以来最好的程序之一。智能感知和调试工具非常物有所值。我发现自己能够非常快速地编写代码。在您使用框架（例如 .NET）并且需要一点额外的指南来告诉您对象可用的功能而无需参考帮助文档的情况下，它特别有用。自动代码格式化、书签、沉浸式调试、重构、源代码控制集成和插件支持是无可匹敌的。

对于其他一切，我使用 VIM。我不得不承认我还在学习如何很好地使用 VIM，但我已经知道它很强大。这确实是为工作选择正确工具的问题。

**编辑：**我要提到的一件事是你选择一两个工具并且学*得*很好。成为这方面的专家。了解细节并探索您的编辑器/IDE 可以做的细节。你做的越多，工具是什么就越不重要。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-03T19:50:35.383

我发现 C 和 Python 的 IDE 并没有给你买太多东西，至少是那些可用于 Linux 的 IDE。所以，当我写 C 和 Python 代码时，我通常会使用 GVIM + Ctags + 独立调试器 + make。

然而，在 Java 的情况下，Eclipse 为 Java 程序员提供了如此多的东西，以至于很难不使用它，并且在一段时间后变得被宠坏了，以至于回到用 VIM 编写 Java 代码太痛苦了。

奇怪的是，我在使用 Visual Studio for C 项目时没有相同的体验（尽管我确实发现它的调试器是必不可少的）。原因之一是我更喜欢自己管理构建脚本。即使使用 Eclipse，我仍然会使用 ant，以便确切地知道每次构建期间发生了什么。诚然，您当然可以查看 Visual Studio 和 Eclipse 中的构建配置，但这并不像查看所使用的确切命令那样直接。话虽如此，我仍然被迫使用 Visual Studio 进行构建，主要是因为约定，因为还有其他人在从事这些项目，但我仍然会在 GVIM 中编辑代码（在 ctags 的帮助下）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-03T19:00:12.863

对我来说，分解是由技术引起的。

我将 Notepad++ 或 vim 用于 LAMP 堆栈中的任何东西——我从未在这些技术的 IDE 中发现任何特别有用的东西（除非你可以将 MySQL 客户端工具用作 IDE，我可以使用它）。

另一方面，在 WISC（Windows、IIS、SQL Server、C#）堆栈中工作时，我使用 IDE - Visual Studio 产品之一，具体取决于我正在处理的项目。

其中很多可能与我从事的各种项目有关。我在 LAMP 堆栈中使用 PHP 工作，因此我不必像使用 perl 时那样处理一堆外部库，而且我在 LAMP 上开发的项目通常比我的 Windows 开发更简单。另一方面，在 .Net 中，如果没有 IDE，导航库可能会非常困难，而且调试可能（我发现）更复杂。另外，在使用 SOAP 开发 Web 服务时，如果没有 Microsoft 提供的工具，我什至不想考虑这样做。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-03T20:03:24.297

您必须使用命令行进行编译/链接的唯一时间是当您在没有安装 GUI 的纯 Linux 服务器上工作时 - 在这种情况下，您唯一真正的选择是 emacs。（使用其他任何东西都是纯粹的受虐狂）。

在所有其他时候，不使用成熟的 IDE将是完全**愚蠢的。**

你的问题：

**你什么时候从一个切换到另一个**

（上面已经回答）

**甚至有必要知道两者吗？如果没有，您应该知道哪些？**

这将取决于您对成为程序员以及系统管理员的热情程度。后者被要求支持前者并实施任何必要的措施以保持所有系统的平稳运行。了解两者永远不会有害，但如果您坚持只做一名程序员，那么了解您选择的平台的特定 IDE 的必要性是显而易见的。

**轻量级还是重量级 IDE？（只是代码突出显示或您可以想象的每个功能）**

我假设这里的选择仅指程序员：毫无疑问，您的编程工具/环境可以为您提供的帮助越多，您可以获得的支持越多，您可以专注于实现您的程序规范。更好。所以是的：HEAVYWEIGHT 是唯一明智的选择。

**您一般推荐什么 IDE，为什么？**

在 Windows 平台上，这个问题没有实际意义：无论微软推荐什么（如果你有 $$$）。在 Linux 上，你有几个选择：基于 GTK（Gnome 和公司），基于 QT（KDE 和公司），（如果你喜欢惩罚，你可以选择纯 X，然后你或多或少在一段有趣的时光）Gnome 和 KDE 都有可以使用的 IDE。第三方IDE，如eclipse，可用；它们都使您能够开发可以在用户选择的任何 GUI 环境中运行的 GUI 应用程序。其中一些 IDE 甚至允许多种编程语言（这就是 Linux 和 FOSS 的荣耀：您有选择；您不会被“地理”所束缚，不会被屠杀……）。

我个人选择的 IDE（仅限 C++）是[Ultimate++](http://www.ultimatepp.org/)。它与 Windows 和 Linux 源代码兼容。IDE 正在接近成熟，它提供了其他 C++-IDE 所渴望的“一切”。（我知道这是一个插件，但我有充分的理由：试一试。）

高温高压

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-03T19:26:05.820

回复：什么时候？我使用 Eclipse 进行 Java 和调试。我使用各种可用的 Groovy 脚本使 jEdit 保持打开状态。我还在 3 个 shell 窗口中使用 Cygwin 的 bash 来执行 Ant 任务、搜索等。我可以将 Bash 别名用于一些真正强大的东西，以运行我们的服务器和客户端。

回复：两个？是的，了解 IDE 和非 IDE 开发至关重要。*哪个*IDE无关紧要，但调试器是必不可少的。

回复：哪个？对于 Java，如果您付费（免费），则为 Eclipse；如果其他人付费，则为 Idea；-) 实际上，我更喜欢 Eclipse，但我认为 Idea 对 Groovy 有更好的支持，因此它对我很有吸引力。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-03T18:44:43.363

我都做过，但调试器确实是一个很棒的工具。

只需添加调试输出和重建，您就可以走得很远，这甚至会迫使您更多地使用面条和科学方法，但最终（imo）调试器不能被拒绝......它让您真正得到在那里并在运行时探索系统。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-03T18:46:26.323

专业化和通用性都有机会。在我自己的工作中，我发现灵活性和能够驾驭陡峭的学习曲线得到了很好的回报。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-03T18:46:41.360

每当我使用一种更适合由计算机编写而不是由人类编写的语言时，我都会使用 IDE，例如 Java。在没有自动完成负载的情况下手动编写太冗长了。Vim 的自动完成功能永远不如特定语言的 IDE。

但是，对于不那么罗嗦的语言，你无法击败一个好的 Vim 或 Emacs 类编辑器来快速生成纯文本。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-03T18:47:21.610

如果项目超过两个或三个源文件，我倾向于使用 IDE。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-03T18:47:26.210

一旦您使用了具有*良好*（vs6 不好，大多数通用文本编辑器对此的支持充其量是粗略的）intellisense 样式提示和自动完成的 IDE 几个星期，您就不会回去了。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-03T19:02:49.690

自从我上次创建本机 GUI 应用程序以来，我还没有使用过 IDE，那是多年前的事了。而且，即便如此，一旦我弄清楚如何将备用编辑器插入 IDE，我几乎只是使用 IDE 来创建 GUI 表单和我自己的实际代码编辑器。

我不是“给我vim，或者给我死亡！” 狂热，但是我使用 IDE 和使用一堆运行 vim 的 xterms 的经验给我留下了这样的印象，即 IDE 真正贡献的唯一东西，对我来说，就是拖放表单编辑，这是我不做的。不需要，考虑到我上次使用非基于 Web 的 GUI 做任何事情已经有多久了。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-03T18:58:11.963

除了我使用 xCode 的 Objective-C 的东西，我对*所有东西都*使用 vim 。Interface builder、错误检查、调试非常有价值。

但是，我使用 InputManager 让我在 xCode 中使用 vim 命令/键绑定，所以我从来没有*真正*离开 vim 做任何事情；）

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-03T19:01:18.023

我在 SciTE 中完成所有编码，这是我最喜欢的编辑器，轻量级，具有良好的语法突出显示，以及我熟悉的（或我编码的！）快捷方式。

现在，在工作中做了大量的 Java，我也使用 Eclipse，每个版本都有很大的改进。我很欣赏它非常可定制，并且在编码帮助方面非常灵活，但我仍然在 SciTE 中进行大部分编辑......幸运的是，在其他地方编辑的文件的自动检测/更新在 Eclipse 中运行良好（尽管有时有一个明智的延迟分析重新加载的类：我们有大项目，但内存不多（1GB）。

我欣赏 Eclipse 主要是因为两件事（我们用一个特殊的 ant 进程编译，我们并不真正进行重构）：在项目中快速导航，特别是找到一个类和调用层次结构，当然还有调试。

我不认为这些是截然不同的世界，它们只是工具，非常互补：我不会触发 Eclipse 来快速编辑一个小的 HTML 文件，我无法在 SciTE 中进行调试。所以我两个都用。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-04T01:30:18.427

我只使用一个像样的代码高亮编辑器。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2008-10-03T18:46:05.433

我使用 IDE 进行调试，或者用于需要处理许多不同文件的每个大型项目。许多 IDE 可以快速单击以从一个类移动到另一个类。IDE 更有效率。当我使用具有大量文件夹和文件的大型框架时，我也使用 IDE，更易于管理。

**更新，因为问题已更新**

**你什么时候从一个切换到另一个？**

我切换到 CSS 或其他小任务的小改动，

**甚至有必要知道两者吗？如果没有，您应该知道哪些？**

有时在构建表单（C# 中的示例）时，使用 IDE 非常有利可图。与断点调试相同。我认为两者都是必需的。

**轻量级还是重量级 IDE？（只是代码突出显示或您可以想象的每个功能）**

代码高亮适用于小工作，但当你有大事要做时，需要更大的 IDE 以及自动完成、实时错误检查和其他重构工具来提高生产力。

**您一般推荐什么 IDE，为什么？**

Visual Studio 非常适合 .net，Eclipse 适合 Java。

# c++ - 学习 C++ 是否有助于构建快速/无附加要求的桌面应用程序？

> ID：168298
> 
> 赞同：6
> 
> 时间：2008-10-03T18:44:43.503
> 
> 标签：c++, user-interface, native

学习 C++ 会帮助我快速构建本机应用程序吗？作为程序员，它会对我有帮助吗？还有什么其他好处？

我想学习 C++ 的原因是因为我对构建在 JVM 和 .NET 之上的应用程序的 UI 性能感到失望。他们感觉很慢，开始也很慢。当然，一个非常糟糕的程序员也可以使用 C++ 创建一个更慢、更迟钝的应用程序，但我不考虑这种情况。

我最喜欢的 Windows 实用程序之一是[Launchy](http://launchy.net/)。在 Readme.pdf 文件中，程序的作者这样写道：

> 0.6 这是第一个 C++ 版本。由于我对 C# 的大型 .NET 框架要求和用户缺乏安装它的愿望感到沮丧，我决定切换回更快的语言。

我完全同意 Launchy 的作者关于 .NET 框架要求甚至桌面应用程序的 JRE 要求的观点。更不用说它们的特定版本了。一些最好的和我最喜欢的桌面应用程序不需要 .NET 或 Java 即可运行。他们只是在安装后运行。它们主要是使用 C++ 构建的吗？C++ 是基于 GUI 的良好和快速应用程序的唯一选择吗？

而且，我也很想了解学习 C++ 的其他好处。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-03T18:58:05.363

是的，C++ 绝对很棒。检查[Qt](http://trolltech.com/products/qt)。它也具有出色的[Python 绑定](http://wiki.python.org/moin/PyQt4)，因此您可以轻松地在 Python 中进行原型制作，并且当/如果您需要额外的性能时，移植到 C++ 主要是 1:1 转换。

但事实上，当你有一个很棒的平台时，编写 C++ 也不是那么难，最糟糕的部分是编写所有的类声明 :-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T18:57:12.277

如果您想构建无需框架（如 .NET 或虚拟机/解释器）即可运行的 Windows 应用程序，那么您唯一真正可行的选择将是 Visual Basic 或 C/C++

我以前用 C++ 代码编写过一些小型 Windows 应用程序，在速度和易于部署方面肯定有好处，但代价是开发难度增加。C++ 可以非常快，本机编译，具有许多现代语言特性，并得到广泛的支持。权衡是在某些情况下您可能需要编写更多代码，或者寻找像[Boost](http://www.boost.org/)这样的库来提供您所追求的功能。

作为一名程序员，使用 C++，尤其是 C 语言工作是很好的经验，可以帮助您理解一些比 .NET、Java 或 VBScript、Python、Perl 等脚本语言更接近机器的东西。不一定使您成为更好的程序员，但是如果您愿意从中学习新的课程，您可能会发现它可以帮助您获得对软件的新视角。毕竟，您所依赖的大多数框架和系统都是用纯 C 编写的，因此理解基础永远不会伤害您。C++ 与纯 C 不同，但如果您使用 C++ for Windows 进行开发，您可能会发现自己在混合使用 C 和 C++ 来使用 Windows API，因此它会产生涓滴效应。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-03T19:16:43.250

我写了 10 年的 C++ windows 应用程序，大约 2 年前切换到 c# 来开发最新的产品。我对 C# 应用程序的可悲程度感到尴尬。启动需要 20 秒，您必须等待一秒左右才能在屏幕之间切换。我使用了一些第三方 GUI 控件库，它像筛子一样泄漏内存！我的应用程序以 150 兆的速度运行，它几乎什么都不做。

我期待回到 C++。

你可以使用 MFC，它会比 .Net 快得多。或者，如果您真的想刻录，请查看 WTL——尽管没有太多相关文档。我建议您使用 MFC 或 Qt，因为您会为它们找到大量有用的信息和教程。

我可以看到 C# 可以更快地开发，也许在未来的某个版本中它会更快更小。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-03T18:46:35.870

一如既往。这取决于。只要你远离微软的大型框架，如 MFC、.net 等，你的应用程序可以非常快，但很难编码。您的好处：您将真正了解 Windows 如何在其漂亮的（？）表面后面工作。只需查看 COM-Objects 的初始化代码，您就会明白我的意思。你永远不会在 VB 或 C# 中看到这样的东西

您必须自己编写每个按钮、每个窗口和每个控件，发送愚蠢的窗口消息，但是您的应用程序很小，非常小。这是一种被遗忘的艺术：

编写小而快的程序

祝你好运！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-03T18:53:16.620

你会讨厌我的回答：

GUI 开发的最大瓶颈**通常**不是因为语言。毕竟，在大多数应用程序中，UI 大部分时间都处于空闲状态，等待一些用户输入。我已经能听到你的尖叫声了，但我在大多数应用程序中都说过。

让我们这样说吧：我很确定可以在 .Net CLR 之上设计一个好的 UI。学习 C++ 是一件好事，但并不能解决开发好的 UI 的内在问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-03T19:04:59.810

如果您致力于学习 Win32 的原始、坚韧的细节，那么 C++ 将助您一臂之力。如果你不是，那么无论如何你最终都会使用一堆包装器。对于诸如小型实用程序之类的东西，或者*尤其*是诸如外壳扩展之类的东西（尝试使用 .NET 无论如何都会给您带来问题），C++ 将让您编写有效的代码，而外部依赖项绝对最少。对于一个更大的应用程序，YMMV - 很多 UI 迟缓来自糟糕的设计：天真的算法，不愿意将非平凡的操作分拆到单独的线程上，依赖于写得不好的 3rd 方组件而不是自定义控件... 任何语言都容易犯错误。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-03T19:10:52.857

这是我对此的诚实回答。

首先，我认为每个程序员都应该学习 C/C++，因为通过学习 C++ 可以了解编程。它是一种系统级语言。您必须考虑内存管理等更精细的细节。令我震惊的是，有多少程序员不了解编程语言或计算机系统的基本方面。通过学习 C/C++，你强迫自己更深入地理解编程。最重要的是，如果你学会了如何用 C/C++ 编程，你几乎可以用任何东西编程。

这并不是说 C/C++ 总是适合这项工作的工具。调试和编写更有意义的代码可能会非常痛苦。但是，它非常适合需要绝对控制程序执行方式的情况。

这就是说，我不喜欢 C/C++ 进行 UI 编程。您仍然必须使用特定于您运行的操作系统的窗口框架（MFC、Win32、Motif、GTK、QT 等）。这些框架不适合简单的学习曲线。至少对于 Windows 开发而言，.NET 确实是 UI 开发的未来（尽管令人惊讶的是，MFC 对 Vista 进行了重大改革，它完成了 .NET 甚至还没有做的事情）。如果您在 .NET 中编写您的 UI，那么它更易于维护，也更易于其他人维护。

我通常用 .NET 编写 UI，用 C++ 编写后端。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-03T18:57:27.113

是和不是。一切都与优化有关……而且由于 C++ 允许您在较低级别上工作，因此 C++ 是编写快速应用程序的最佳语言之一。但是，如果您习惯于更抽象的 OOP 方法，那么在 C++ 中实现的那些低级机制可能会非常烦人。用 C++ 测试你的软件通常是一个漫长的过程。如果您无论如何都在寻找速度，C++ 绝对是最佳选择之一。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-27T11:38:58.487

C++ 确实有可能为您提供更精简、更简洁和更快的应用程序（如果您做得对的话）。

但是，从开发人员的角度来看，.NET 框架是为了舒适而构建的。对 Win32 API 或 MFC 的巨大改进，相比之下这似乎是一项艰巨的工作，因此请考虑如何实现应用程序依赖于 .NET 的方面（还有其他可用的框架可能比 MFC 或 Win32 API 更容易） ，并考虑使用此类框架的成本和许可问题；例如，免费的 VC++ Express Edition 不包括 MFC 支持。

If you know where you application is sluggish, C++/CLI may be a solution; allowing you to mix managed and native code to accelerate the parts that need it. However if it is the GUI that is intrinsically slow rather than the application processing; this may not be a useful path.

# security - 离开时如何强制锁定工作站？这很重要吗？

> ID：168303
> 
> 赞同：5
> 
> 时间：2008-10-03T18:45:29.930
> 
> 标签：security, corporate-policy

在您的组织内，是否每个开发人员都需要在离开时锁定其工作站？

当工作站处于解锁状态时，您认为有哪些风险？与“over-wire”（网络黑客攻击）安全风险相比，您认为这些风险有多重要？

您认为哪些策略对强制锁定工作站最有效？（这些政策可能是“技术性的”，例如要锁定屏幕保护程序的域组安全设置，也可能是“社会性的”，例如对不锁定的人施加一些惩罚，或鼓励[Goating](http://www.codinghorror.com/blog/archives/000997.html)？）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-03T18:50:02.260

现实世界的主要风险是你的同事[“攻击”](http://www.codinghorror.com/blog/archives/000997.html)你。您可以通过设置组策略以在 X 分钟后运行屏幕保护程序来强制执行此操作，这也可以锁定计算机。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T18:53:28.493

对我来说，这已经成为习惯。在 Windows 机器上，按下`Windows-L`是锁定机器的快速方法。

解决方案可能是社会性的而不是技术性的。说服人们他们不希望其他人在他们离开时阅读他们的电子邮件或欺骗他们的帐户。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T18:49:18.127

在我的组织（政府）中，是的。我们处理敏感数据（医疗和 SSN）。这对我来说是本能的：每次我走开时 Windows+L。

该政策既是社会性的，也是技术性的。在社交方面，我们被提醒个人安全很重要，每个人都知道我们所掌握的数据。在技​​术方面，工作站使用组策略在 2 分钟后打开屏幕保护程序，并打开“恢复时，密码保护”（并且无法关闭）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T19:10:14.467

不，但我是 1 的组织 - 我上次在大型组织工作时，我们不是被要求的，但被鼓励这样做。如果我在与其他人在一起的环境中，我现在可能会在离开工作站时将其锁定。虽然具有物理访问权限的人当然可以添加硬件键盘记录器，但锁定它确实增加了额外的安全级别。根据您所在的组织类型，我认为风险更多来自内部组织窥探，而不是网络攻击。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T19:19:43.057

我曾经在一家非常大的公司工作，那里的工作站需要将您的徽章插入其中才能工作。如果没有徽章，您就不能在建筑物中移动（无论如何您都需要徽章才能开门）。从工作站的智能卡读卡器中取出徽章会自动将您注销。

离题但更简洁的是，工作站更像是“网络工作站”（请注意，使用我刚刚描述的系统不是必需的），并且徽章举行了您的会议。将它放到另一栋大楼的另一个工作站中，这就是您在另一台计算机上拉徽章时离开时的会话。

所以他们基本上通过强制人们注销他们的工作站来解决这个问题，我认为这是执行任何类型的安全关键策略的最佳方式。人们忘记了，这是人的本性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T18:49:15.647

我见过的唯一**真正**重要的是政府、国防和医疗设施。执行它的最佳方法是通过 Windows 上的用户策略和 Unix 系统上的“点文件”，其中在您登录时为您预先选择了屏幕保护程序和超时，并且不允许您更改它们。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T18:53:37.493

我从不锁定我的工作站。

当我的同事和朋友嘲笑我并试图从我的机器上发送令人尴尬的电子邮件时，我嘲笑他认为当我可以物理访问他的机器时锁定会做任何事情，我将他链接到这个网址：

[http://www.google.com/search?hl=en&q=USB+keylogger](http://www.google.com/search?hl=en&q=USB+keylogger)

我不使用我的同事尚未平等访问的任何敏感数据，但我怀疑工作站锁定对坚定的窥探同事的有效性。

编辑：我不锁定的原因是因为我曾经这样做过，但它一直在 Windows 中造成奇怪的不稳定性。我只在需要时重新启动，所以我希望我的机器可以运行几个月而不会变得不稳定并且锁定会妨碍我。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-03T19:17:53.700

Goating 可以让你被解雇，所以我不推荐它。但是，如果您工作的地方*不是*这种情况，它可能是有效的，即使它只是一封广泛的电子邮件，上面写着“从现在开始我将永远锁定我的工作站”。

至少，机器应该在 X 分钟不活动后锁定自己，这应该通过组策略设置。

安全是关于提高标准，为完成坏事付出更多的努力。完全不锁定您的工作站会降低该标准。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-03T20:26:01.363

我们结合社交和技术方法来鼓励 IT 人员锁定他们的 PC：默认屏幕保护程序/锁定设置以及山羊威胁。（我工作的最后一个地方实际上锁定了屏幕保护程序设置。）

要记住的一件事是，如果您有跟踪活动、更改或两者的应用程序（特别是如果它们是 SSO），那么如果您不能确定记录在数据中的用户是实际进行这些更改的用户。

即使在像我们这样的公司，大多数用户都无法获得很多与公司相关的敏感信息，但人们肯定有可能通过未锁定的工作站从其他员工那里获取 NBR 数据。有多少人在他们的计算机上保存网站的密码？亚马逊？梦幻足球？（一种危险的招人技巧：从其他人的名单中删除一名关键球员。只有当你和你在一起时，这真的很有趣，所以球员可以恢复......）

要考虑的另一件事是，您无法确定建筑物中的每个人都属于那里。如果你真的在大楼里，入侵网络要容易得多：当然，大楼里的绝大多数人都在那里，因为他们是被允许的，但你真的不想成为受害公司百万分之一的人确实进入了大楼。（甚至不必是故意的坏人：可能是某人的孩子、朋友、亲戚……）当然，让那个人进来的员工也可以让那个人使用他们的电脑，但那种攻击更难阻止。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-03T20:44:26.570

每次去喝咖啡时锁定工作站意味着您每天输入密码 10 次而不是一次。您周围的每个人都可以看到您输入的内容。一旦他们拥有该密码，他们就可以从远程计算机上冒充您，这比在办公室使用您的 PC 并且每个人都在观看要难得多。所以锁定你的工作站肯定会带来更多的安全风险吗？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-05T09:16:37.257

我正在运行 Pageant 并将我的 SSH 公钥分布在此处的所有服务器上。无论谁坐在我的工作站上，基本上都可以用我的密钥登录到任何地方的任何帐户。

因此，我*总是*锁定我的机器，即使是 30 秒的休息时间。（Windows-L 基本上是我所知道的唯一基于 Windows 键的快捷方式。）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-03T18:49:55.303

我个人认为风险很低，但根据我的经验，大多数时候这不是意见问题——这通常是大型企业或政府客户的要求，他们实际上会进来审核你的安全性。在这种情况下，某种技术（组策略）解决方案将是最好的，因为您实际上可以证明您符合要求。如果有法律隐私要求（如医疗数据和 HIPAA），我也会这样做。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-03T18:50:23.943

我在一个地方工作，那里为我们提供一些设备的人来自一家与我们直接竞争的公司。当设备需要维护时，他们就在大楼里。不时会发出一封电子邮件，说他们会在那里，请在您不在时锁定您的机器。如果竞争对手因为开发人员忘记锁定他们的机器而获得了我们的资源，那么开发人员就会寻找新工作。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-03T18:55:23.107

我们被要求在工作中，我们自己强制执行。开始群聊，表达对人的爱，发送电子邮件，改变背景等。一定要喜欢新员工的第一天，每个人都一定会留下一个很好的便条:)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-03T19:14:47.187

我以前工作的地方有一个总是锁定你的工作站的政策。他们通过设置公司范围的邮件列表来强制执行——如果您的工作站未锁定，您的同事会从您的帐户向该列表发送一封令人尴尬的邮件，然后锁定您的机器。这有点有趣，也有点烦人，但它通常是有效的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-03T20:29:38.453

您可以在他们离开后立即开始坐在人们的工作站并加载[在此处插入任何不好的东西]。我敢肯定，这会奏效。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-03T20:58:54.853

在我访问过的一些/大多数政府办公室中，有可能让公众四处走动，他们的智能卡可以插入 PC 上的 USB 读卡器。该卡位于用户脖子上的项链上，当它被移除时会锁定工作站。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-02-18T16:06:27.833

如果您的计算机未锁定，我公司的所有者（和开发人员）将对您的代码窗口进行微小的更改，这让您疯狂地想知道为什么您的代码在您找到它之前不起作用。

不得不说，在听到那个恶作剧后，我从来没有让我的电脑解锁，我对我的一些代码已经够疯狂了。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-02-18T16:42:01.067

您可以设置一个简单的万无一失的方法，将指纹读取器插入为您的密码编程的计算机，然后将这条项链与 USB 接收器一起佩戴，如果您离开工作站，屏幕保护程序会主动锁定它，然后当您出现在范围内，将手指从指纹读取器上滑开以解锁工作站 - 我认为这是一种非常便宜的方式，简单、无干扰、无杂乱，不要忘记通过“WinKey+L”锁定

希望这会有所帮助，最好的问候，汤姆。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-02-18T17:03:50.400

这是重要的还是一个好习惯？锁定您的计算机在您自己的房子里可能并不重要，但如果您在客户的办公室并走开，那么我会说这很重要。

至于如何执行...

[在阅读了 Jeff 关于不要忘记锁定您的计算机](http://www.codinghorror.com/blog/2007/11/dont-forget-to-lock-your-computer.html)的博客文章后；我喜欢将同事的桌面背景更改为...

[![](https://moretalk.files.wordpress.com/2009/11/pettitte-goat.jpg)](https://moretalk.files.wordpress.com/2009/11/pettitte-goat.jpg)
1,238 像素 × 929 像素

不用说，同事们开始锁定他们的电脑。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-06-20T17:44:53.437

GateKeeper 是一个简单的解决方案。它会在用户离开时自动锁定工作站，并在用户回到计算机范围内时自动解锁。它还可能需要双重身份验证和其他锁定/解锁方法。

# c# - C# .Net exe 不会在 PC 重新启动时关闭，导致机器无法重新启动

> ID：168317
> 
> 赞同：5
> 
> 时间：2008-10-03T18:47:28.957
> 
> 标签：c#, multithreading, events, smartclient, restart

我们有一个内置在 C# 中的 SmartClient，当它运行的 PC 重新启动时，它顽固地保持打开状态。这将停止重新启动过程，除非用户首先关闭 SmartClient 或有其他一些手动干预。

当基础架构团队远程安装需要重新启动机器的新软件时，这会导致问题。

让 SmartClient 应用程序识别来自 Windows 的关机/重启事件并优雅地杀死自己的任何想法？

**更新：** 这是一个具有多个 gui 线程的高度线程化的应用程序。是的，多个 gui 线程。它实际上是许多项目的整合，这些项目本身可能是独立的应用程序——所有这些项目都是从一个集中这些管理方法并跟踪这些线程的单个 exe 启动和管理的。我不相信使用后台线程是一种选择。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T18:55:19.270

它必须是一个继续运行的线程，以防止您的应用程序关闭。如果您使用线程，一个简单的解决方法是将其设置为背景。

> 线程要么是后台线程，要么是前台线程。后台线程与前台线程相同，只是后台线程不会阻止进程终止。一旦属于一个进程的所有前台线程都已终止，公共语言运行时就会结束该进程。任何剩余的后台线程都将停止并且不会完成。
> 
> [http://msdn.microsoft.com/en-us/library/system.threading.thread.isbackground.aspx](http://msdn.microsoft.com/en-us/library/system.threading.thread.isbackground.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T18:58:27.873

好的，如果您有权访问该应用程序，则可以处理 SessionEnded 事件。

```
...
Microsoft.Win32.SystemEvents.SessionEnded +=new
  Microsoft.Win32.SessionEndedEventHandler(shutdownHandler);

...

private void shutdownHandler(object sender, Microsoft.Win32.SessionEndedEventArgs e) {
  // Do stuff
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-03T19:27:11.593

当用户注销或 Windows 正在关闭时，`WM_QUERYENDSESSION`消息将发送到所有顶级窗口。请参阅[此处的 MSDN 文档。](http://msdn.microsoft.com/en-us/library/aa376890(VS.85).aspx)

WinForm 应用程序响应此消息的默认行为是触发`FormClosing`事件`CloseReason == WindowsShutDown`或其他事件。事件处理程序虽然可以选择固执地拒绝关闭应用程序，从而保持系统运行。

检查`FormClosing`您的应用程序的处理程序。也许里面有什么东西。这种东西我见过几次。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T18:52:41.520

或者，.Net 应用程序可能故意忽略关闭或退出消息？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T19:09:07.167

后台线程是一个快速而肮脏的解决方案，最好的解决方案是使用同步对象（`ManualResetEvent`或`Mutex`其他东西）来停止其他线程；

`WM_CLOSE`或者在主应用程序关闭时跟踪所有打开的窗口并发送消息。

您必须提供有关如何启动这些 GUI 应用程序的更多信息。也许您为每个应用程序启动一个线程并调用`Application.Run(new Form1());`？

您还可以考虑`AppDomain`为每个 GUI 应用程序创建一个

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T18:49:00.373

通常，.Net 应用程序会正确响应——至少，这是“开箱即用”的行为。如果不是，可能会发生很多事情。在不了解您的程序的情况下，我最好的猜测是，您在主 UI 线程中有一个长时间运行的进程，这会阻止应用程序响应窗口消息。

# algorithm - 如何识别描述数据集的最小参数集

> ID：168349
> 
> 赞同：6
> 
> 时间：2008-10-03T18:56:05.883
> 
> 标签：algorithm

我有一堆回归测试数据。每个测试只是一个消息列表（关联数组），将消息字段名称映射到值。这些数据中有很多重复。

例如

```
 test1 = [
      { sender => 'client',  msg => '123',  arg => '900', foo => 'bar', ... },
      { sender => 'server',  msg => '456',  arg => '800', foo => 'bar', ... },
      { sender => 'client',  msg => '789',  arg => '900', foo => 'bar', ... },
   ] 
```

我想表示字段数据（作为最小深度决策树？），以便可以使用最少数量的参数以编程方式重新生成每条消息。例如，在上面

*   foo 总是'bar'，所以我不需要提及它
*   发送者和客户端是相关的，所以我只需要提到一个或另一个
*   而且味精每次都不一样

因此，我希望能够使用类似于以下内容的程序重新生成这些消息

```
write_msg( 'client', '123' )
write_msg( 'server', '456' )
write_msg( 'client', '789' ) 
```

其中 write_msg 函数将由嵌套的 if 语句或使用参数的子函数调用组成。

根据我的原始数据，我如何确定“最重要”的参数集，即那些可以让我使用最少数量的参数重新创建数据集的参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T17:18:48.650

以下论文描述了发现函数依赖的算法：

> Y. Huhtala、J. Kärkkäinen、P. Porkka 和 H. Toivonen。TANE：一种用于发现函数和近似依赖关系的有效算法。*计算机杂志*, 42(2):100–111, 1999, [doi:10.1093/comjnl/42.2.100](http://dx.doi.org/10.1093/comjnl/42.2.100)。
> 
> I. Savnik 和 PA Flach。从关系中自下而上地归纳功能依赖。在过程中。*AAAI-93 研讨会：数据库中的知识发现*，第 174-185 页，华盛顿特区，美国，​​1993 年。
> 
> C. Wyss、C. Giannela 和 E. Robertson。FastFDs：一种启发式驱动的深度优先算法，用于从关系实例中挖掘功能依赖关系。在*过程中。数据仓库和知识发现*，第 101-110 页，德国慕尼黑，2001 年，[doi:10.1007/3-540-44801-2](http://dx.doi.org/10.1007/3-540-44801-2)。
> 
> 姚洪和霍华德·J·汉密尔顿。“从数据中挖掘功能依赖性。” *数据挖掘和知识发现*，2008，[doi:10.1007/s10618-007-0083-9](http://dx.doi.org/10.1007/s10618-007-0083-9)。

在发现多值依赖方面也有一些工作：

> I. Savnik 和 PA Flach。“从关系中发现多值依赖。” *智能数据分析杂志*，4(3):195–211，[IOS 出版社](http://iospress.metapress.com/content/18wpfh7nvxqjamnm/)，2000。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T10:24:31.407

[这看起来与Database Normalization](http://en.wikipedia.org/wiki/Database_normalization)非常相似。

您有一个关系（您的测试数据集）和一些已知的功能依赖关系（{sender} => arg, {} => foo 和可能 {msg} => sender。如果测试的顺序很重要，则添加 {testNr} => msg.) 并且您想消除冗余。

将您的测试集视为数据库表，应用规范化规则并为每个连接创建等效函数（getArgFromSender(sender) 等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-04T21:00:30.420

**如果字段和记录的数量很少：**

通过遍历字段的每个组合来强制它，并为每个组合检测列表中是否有多个项目映射到相同的值。

**如果您可以选择相当不错的字段：**

开始假设您需要所有字段。然后，随机选择一个字段，看看能不能消除；如果可以，请将其从字段集中划掉。否则，请随机选择另一个字段并重试。如果您发现没有可以消除的字段，那么您已经找到了一组合理的字段。如果您先选择其他领域，您可能会找到更好的解决方案。您可以重复整个过程几次，然后根据需要选择最佳解决方案。这种方法称为[爬山](http://en.wikipedia.org/wiki/Hill_climbing)。

（我怀疑这个问题是[NP 完备](http://en.wikipedia.org/wiki/NP-complete)的，也就是说，我们可能不知道一个有效而强大的解决方案，所以不值得为了想出一个完美的解决方案而失眠。）

# visual-studio - Eclipse 在 Visual Studio 中的 Ctrl+单击？

> ID：168369
> 
> 赞同：109
> 
> 时间：2008-10-03T18:59:41.490
> 
> 标签：visual-studio, eclipse, keyboard-shortcuts, usability

在使用 Eclipse Java 工作了几天后，我完全沉迷于按下`Ctrl`并单击标识符以转到其定义。从那时起，我也一直在寻找一种在 Visual Studio 中实现这一目标的方法。

我意识到 VS 有右键单击，转到定义，这`F12`也是一样的。我也意识到 Visual Assist 与`Alt`+做了类似的事情`G`。然而，这些都不像`Ctrl`+ click 那样完美。

实际上，我已经尝试了几个小时的运气，试图编写一个 VS 插件来做到这一点，但在我认为合理的时间范围内没有得到任何结果。

有谁知道如何做到这一点？一个现成的插件？某种宏？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2010-06-16T08:05:55.673

如果您使用 Visual Studio 2010，则可以使用 Microsoft 提供的免费 [Visual Studio 2010 Productivity Power Tools](http://visualstudiogallery.msdn.microsoft.com/en-us/d0d33361-18e2-46c0-8ff2-4adea1e34fef)来实现此目的。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2015-11-05T03:24:23.843

我使用 Visual Studio 2013 和 2015，我安装了`Go To Definition`. 要安装此扩展程序，请导航到`TOOLS`-> `Extensions and Updates`。

[![在此处输入图像描述](https://i.stack.imgur.com/smX6P.png)](https://i.stack.imgur.com/smX6P.png)

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-10-03T19:14:23.553

我会回答那些询问`Ctrl`-click 和`F12`.

**`Ctrl`-点击工作流程：**

*   将手移到鼠标
*   将鼠标悬停在变量名称上
*   单击时另一只手按住`Ctrl`键
*   移动鼠标以定位光标、突出显示、右键单击或其他
*   将手移回键盘以继续输入

**`F12`工作流程**

*   将手移到鼠标
*   鼠标悬停在变量名上
*   **将手移回键盘**
*   击键`F12`_
*   **将手移回鼠标**
*   移动鼠标以定位光标、突出显示、右键单击或其他
*   将手移回键盘以继续输入

如果您假设光标已经定位在所需的变量上，`F12`那就更好了。但是，这种情况很少见。此外，如果您在此特定操作后停止，假设您希望双手回到键盘上，则成本是相同的。但是，如果您记住您可能有理由想要转到定义，`Ctrl`-click 工作流程会为您节省在键盘和鼠标之间移动的实例。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-09-02T02:03:30.943

[自 2009 年 6 月（内部版本 1727）起， Visual Assist](http://www.wholetomato.com/support/history.asp)支持`Ctrl`+Click。在 VA 选项中激活`Ctrl`+LeftClick | 高级 | 一般的。（请参阅下面的评论。）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-09-14T16:39:35.843

如果您有 Visual Studio 2010，则可以使用 Noah Richards 的“Go To Definition”。

[http://visualstudiogallery.msdn.microsoft.com/en-us/4b286b9c-4dd5-416b-b143-e31d36dc622b](http://visualstudiogallery.msdn.microsoft.com/en-us/4b286b9c-4dd5-416b-b143-e31d36dc622b)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-04T21:19:20.337

我使用内置选项（`F12`，右键单击 -> 转到定义），但我知道我公司的很多人都使用 Resharper，它肯定有这个功能。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-02-23T19:11:19.687

Microsoft 发布了名为“ [Productivity Power Tools](http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef/) ”的 Visual Studio 2010 扩展，现在添加了`Ctrl`+Click 功能。因此，如果您像我一样讨厌安装第三方插件，那么您现在可以拥有相同的功能！

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-02-23T14:36:34.710

哦，伙计，只需安装 resharper ！（vs插件）安装了它，你只需去`Ctrl`+点击去定义。

这不是 resharper 做的唯一事情，免费试用！！！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-04T22:33:24.663

VS 的另一个选项（除了`F12`右键单击 > Go to Def）是添加代码定义窗格（View > Code Def Window）。这本质上是另一个显示当前符号代码的编辑窗格 - 无需`Ctrl`单击或任何操作。我把它固定在我的辅助显示器上。每当我需要查看符号的实现时，我只需单击它并查看。

另一个好处`F12`是您还可以通过它们`Shift``F12`查找对符号的引用`F8`。两人像爱情和幸福一样走到了一起。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-11-20T07:24:34.533

我更喜欢将 Go To Definition 绑定到`Ctrl``D`. 这使得双手放在键盘上（`Ctrl``D`去光标下符号的定义）或一只手放在键盘上，一只手放在鼠标上（然后单击符号`Ctrl``D`）非常容易使用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-06-30T08:37:19.843

总而言之，VS 和 Eclipse 都有奇怪的快捷键。我也不得不回应：`F12`在键盘上太右了，你必须把鼠标放在右手上，键盘才能使用它。作为一个长期的 V​​S 用户，直到我`Ctrl`在 Eclipse 中搜索 +Mouse 等效项时，我才找到它。它完全无聊。好的？不用争论。（`F3`Eclipse 中的定义也是如此。？？？

无论如何，正如之前所说的，微软已经明白这对于从 Eclipse 进来的新程序员来说可能是一个问题，所以他们提供了 Power Tools（我按照上面的链接进行操作）。

[http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef/](http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-03-16T11:16:28.647

如果您使用的是 Visual Studio 2017，则可以使用[Productivity Power Tools 2017](https://marketplace.visualstudio.com/items?itemName=VisualStudioProductTeam.ProductivityPowerPack2017)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-10-03T19:07:16.110

我在 VS 中工作不多，所以我没有使用它，但我从我认识的每个人那里听说过关于[Resharper的令人难以置信的好消息。](http://www.jetbrains.com/resharper/)每个人都告诉我它物有所值，并且显着提高了 Visual Studio 的效率。我认为它具有您正在寻找的功能以及大量其他功能。

# sql - 在 SQL Server 中对大型表进行分区的最佳方法是什么？

> ID：168374
> 
> 赞同：13
> 
> 时间：2008-10-03T19:00:41.083
> 
> 标签：sql, sql-server, partitioning

在最近的一个项目中，“主要”开发人员设计了一个数据库模式，其中“更大”的表将被拆分到两个单独的数据库中，主数据库上的视图将两个单独的数据库表结合在一起。主数据库是应用程序的驱动程序，因此这些表看起来和感觉都像普通表（除了一些关于更新的古怪事情）。这似乎是一个巨大的性能问题。我们确实看到了这些桌子周围的性能问题，但没有什么能让他改变对他的设计的想法。只是想知道最好的方法是什么，或者它是否值得做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-03T19:30:58.603

我认为通过在单个服务器中跨多个数据库对表进行分区，您不会真正获得任何收益。您所做的一切基本上都增加了使用“表”的开销，方法是在单个 SQL Server 实例下拥有多个实例（即在两个不同的数据库中打开）。

你有多大的数据集？我有一个客户端，在 SQL Server 中有一个 600 万行的表，其中包含 2 年的销售数据。他们将其用于交易和报告，没有任何明显的速度问题。

当然，调整索引和选择正确的聚集索引对性能至关重要。

如果您的数据集非常大并且您正在寻找分区，那么您将获得更多的收益，您可以在物理服务器上对表进行分区。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T19:39:11.800

分区不是一件轻而易举的事情，因为可能会产生许多微妙的性能影响。

我的第一个问题是您是指将较大的表对象简单地放在单独的文件组中（在单独的主轴上），还是指在表对象内部进行数据分区？

我怀疑所描述的情况是试图将某些大型表的物理存储在与其余表不同的主轴上。在这种情况下，增加单独数据库的额外开销、失去跨数据库强制执行参照完整性的任何能力以及启用跨数据库所有权链接的安全隐患与在单个数据库中使用多个文件组相比没有任何好处。如果很可能，您在问题中引用的单独数据库甚至没有存储在单独的主轴上，而是全部存储在同一个主轴上，那么您甚至可以否定通过物理分离磁盘活动可以获得的轻微性能优势和完全没有得到任何好处。

我建议不要使用其他数据库来保存大型表，而是查看 SQL Server 联机丛书中的文件组主题或快速查看这篇[文章：](http://www.mssqltips.com/tip.asp?tip=1112)

如果您对数据分区（包括分区到多个文件组）感兴趣，那么我建议您阅读 Kimberly Tripp 的文章，他在 SQL Server 2005 发布时就该处可用的改进进行了出色的演示。一个很好的起点是这份[白皮书](http://www.sqlskills.com/resources/Whitepapers/Partitioning%20in%20SQL%20Server%202005%20Beta%20II.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T19:23:09.167

您使用的是哪个版本的 SQL Server？SQL Server 2005 具有分区表，但在 2000（或 7.0）中，您需要使用分区视图。

另外，将表分区放在单独的数据库中的原因是什么？

过去（2005 年之前）我不得不对表进行分区时，通常是按日期列或类似的东西，以查看各个分区。Books Online 有一个部分讨论如何执行此操作以及围绕它的所有规则。您需要遵守规则，使其按应有的方式工作。

要记住的关键是您的分区列必须是主键的一部分，并且您希望在对表的任何访问中始终使用该列，以便优化器可以忽略不应受查询影响的分区。

在 MSDN 中查找“分区表”，您应该能够找到更完整的 SQL Server 2005 分区表教程以及如何设置它们以获得最佳性能的建议。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T19:37:13.413

您是在询问数据库设计方面的最佳实践，还是说服您的领导改变主意？:)

在设计方面... 回到过去，有时需要垂直分区来解决数据库引擎的限制，其中表中的列数是硬性限制，例如 255 列。如今，主要好处纯粹是为了提高性能：将很少使用的列或 blob 放在单独的磁盘阵列上。但是，如果您经常从两张桌子上取东西，那可能会是一种损失。听起来您的潜在客户正遭受过早优化的困扰。

在告诉你的领导是错误的方面......这需要外交。如果他意识到在性能方面的不满，那么基准可能是显示差异的最佳方式。

使用“create table t1 as select * from view1”在某处创建一个新的物理表，然后使用垂直分区表和新表运行一些冗长的批处理。如果它像你说的那么糟糕，那么差异应该是显而易见的。

但这也可能是过早的优化。了解最终用户对性能的看法。如果性能足够好，对于一些好的定义，那么不要修复没有破坏的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-05T17:22:46.320

表分区有一个明确的好处（无论它是在相同还是不同的文件组/磁盘上）。如果正确选择了分区列，您将意识到您的查询将只命中所需的分区。所以想象一下，如果你有 1 亿条记录（我已经对表进行了比这大得多的分区 - 大约 20 多亿行），并且如果在大多数情况下，超过 70% 的数据访问只是某个类别或时间线或类型数据，那么它有助于将访问最多的数据保存在单独的分区中。此外，您可以将分区与具有各种类型磁盘（SATA、光纤通道、SSD）的单独文件组对齐，以便访问最多/繁忙的数据位于最快的存储上，而访问最少/很少访问的数据实际上位于较慢的磁盘上。

尽管与 Oracle 不同，SQL Server 的分区能力有限。您只能选择一列进行分区（即使在 SQL 2008 中）。因此，您必须明智地选择一个列，该列也是您大多数频繁查询的一部分。在大多数情况下，人们发现选择按日期列进行分区很容易。但是，尽管以这种方式进行分区似乎是合乎逻辑的，但如果您的查询没有将该列作为条件的一部分，那么您将不会从分区中获得足够的好处（换句话说，您的查询无论如何都会命中所有分区）。

数据仓库/数据挖掘类型数据库的分区比 OLTP 容易得多，因为大多数 DW 数据库查询都受时间段的限制。

这就是为什么现在由于数据库处理的数据量很大，明智的做法是设计应用程序，使查询受到时间、地理位置等更广泛的组的限制，以便在选择此类列时分区您将获得最大的收益。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-01T14:47:41.777

我不同意分区不能获得任何东西的假设。

如果分区数据在物理和逻辑上是对齐的，那么查询的潜在 IO 应该会大大降低。

例如，我们有一个表，其中批处理字段作为 INT 表示一个 INT。

如果我们按此字段对数据进行分区，然后对特定批次重新运行查询，我们应该能够在分区前后运行 set statistics io ON 并看到 IO 减少，

如果我们每个分区有一百万行，并且每个分区都写入一个单独的设备。查询应该能够消除不必要的分区。

我没有在 SQL Server 上做过很多分区，但我确实有在 Sybase ASE 上进行分区的经验，这就是所谓的分区消除。当我有时间时，我将在 SQL Server 2005 机器上测试该场景。

# visual-studio - Visual Studio 2005 内存使用情况

> ID：168375
> 
> 赞同：24
> 
> 时间：2008-10-03T19:00:51.880
> 
> 标签：visual-studio, memory, visual-studio-2005, memory-management

我发现 Visual Studio 内存使用量通常平均约为 150-300 MB RAM。

作为一个经常需要打开多个 Visual Studio 实例运行的开发人员，是否有任何性能技巧来优化 VS 使用的内存量？

我正在使用一个加载项 (TFS) 运行 VS 2005

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-03T19:04:08.487

从[这篇博文](http://geekswithblogs.net/sdorman/archive/2008/08/28/visual-studio-optimizations.aspx)：

> [...]
> 这些更改都可从“选项”对话框（工具 -> 选项）中获得：
> 
> **环境**
> 
> *   *一般*：
>     *   禁用“动画环境工具”</li>
> *   *文件*：
>     *   禁用“在环境外更改文件时检测”</li>
> *   *键盘*：
>     *   从 Help.F1Help 命令中删除 F1 键
> *   *帮助\在线*：
>     *   将“加载帮助内容时”设置为“先尝试本地，然后在线”或“仅尝试本地，不在线”</li>
> *   *启动*：
>     *   将“启动时”选项更改为“显示空环境”</li>
> 
> **项目和解决方案**
> 
> *   *一般*：
>     *   禁用“在解决方案资源管理器中跟踪活动项目”</li>
> 
> **文本编辑器**
> 
> *   *一般*（对于您想要的每种语言）：
>     *   禁用“导航栏”（这是显示对象和过程下拉列表的工具栏，允许您在代码中选择特定对象。
>     *   禁用“跟踪更改”</li>
> 
> **Windows 窗体设计器**
> 
> *   *一般*：
>     *   将“AutotoolboxPopulate”设置为 false。
>     *   将“EnableRefactoringOnRename”设置为 false。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-04T03:26:29.470

升级到 64 位操作系统。我的 VS 实例每个都占用了大约 700MB（非常大的解决方案）.. 你很快就用完了。

我团队中切换到 64 位（和 8GB RAM）的每个人都想知道他们为什么不早点这样做。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T15:12:33.440

最小化并重新最大化主 vs 窗口以获取 vs 以释放内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-30T04:42:54.097

通过卸载（并重新安装）Visual Assist，我的问题得到了解决。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-31T17:54:15.520

您可以做的第一件事是切换到 Windows 8。

如果将相同的 DLL 或内存页面加载到多个进程中，它会使用内存共享/组合。显然，在运行两个 VS 实例时有很多重叠。

![在此处输入图像描述](https://i.stack.imgur.com/DmOAt.png)

如您所见，我运行了 4 个 Visual Studio，并且共享内存列（您需要启用此列才能使其可见）显示共享了多少内存。

所以在 Windows 7 中这将使用 2454MB，但我节省了 600+MB 与其他 devenv 进程共享。

Chrome 也有很多节省（因为每个浏览器选项卡都是一个新进程）。所以总的来说，我仍然有 2GB 的空闲空间，而我通常会用完。

# .net - 模板化代表

> ID：168384
> 
> 赞同：1
> 
> 时间：2008-10-03T19:02:10.783
> 
> 标签：.net, generics, delegates, template-method-pattern

我有以下代码模式：

```
void M1(string s, string v)
{
  try
  {
    // Do some work
  }
  catch(Exception ex)
  {
    // Encapsulate and rethrow exception
  }
} 
```

唯一的区别是方法的返回类型以及参数的数量和类型可能会有所不同。

我想创建一个通用/模板化方法来处理除“做一些工作”部分之外的所有代码，如何实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T19:09:38.070

我喜欢动作

```
public static void Method(Action func)
{
    try
    {
        func();
    }
    catch (Exception ex)
    {
        // Encapsulate and rethrow exception
        throw;
    }
}

public static void testCall()
{
    string hello = "Hello World";

    // Or any delgate
    Method(() => Console.WriteLine(hello));

    // Or 
    Method(() => AnotherTestMethod("Hello", "World"));

}

public static void AnotherTestMethod(string item1, string item2)
{
    Console.WriteLine("Item1 = " + item1);
    Console.WriteLine("Item2 = " + item2);
} 
```

# c# - typeof(myType).TypeHandle 是否使用反射？

> ID：168393
> 
> 赞同：5
> 
> 时间：2008-10-03T19:03:50.093
> 
> 标签：c#

如果我写了这段代码：

```
typeof(myType).TypeHandle 
```

它会使用反射吗？

与以下有多大不同：

```
Type.GetType(string).TypeHandle 
```

是吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-03T19:11:14.057

嗯，这真的取决于你所说的“反射”是什么意思——这并不是严格定义的。

`typeof`在编译的代码中有两个部分需要使用。首先是使用`ldtoken`which 是 CIL 规范中这样描述的 IL 指令：

> ldtoken 指令推送指定元数据令牌的 RuntimeHandle。令牌应为以下之一：
> 
> *   一个methoddef、methodref或methodspec：推送一个RuntimeMethodHandle
> *   typedef、typeref 或 typespec：推送 RuntimeTypeHandle
> *   fielddef 或 fieldref ：推送 RuntimeFieldHandle
> 
> 压入堆栈的值可用于调用系统类库中的反射方法

在此之后，调用到`Type.GetTypeFromHandle`。

`Type.GetType(string)`如果这就是您所关心的，那么这一切都比然而要快得多。

编辑：我刚刚注意到您问题的 TypeHandle 部分。据我所知，MS 编译器并没有优化对 GetTypeFromHandle 和 TypeHandle 的调用，即使我猜你真的只需要`ldtoken`调用。

所有这些是否算作“反思”取决于您...

# c# - 使用反射捕获方法状态

> ID：168396
> 
> 赞同：5
> 
> 时间：2008-10-03T19:04:46.397
> 
> 标签：c#, .net, reflection

有没有办法使用 .NET 反射来捕获所有参数/局部变量的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T19:12:18.643

[您可以使用CLR 调试 API](http://msdn.microsoft.com/en-us/library/bb384548.aspx)获取此信息，尽管提取它不是简单的几行代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T19:10:12.657

反射不用于从堆栈中捕获信息。它读取大会。

您可能想看看 StackTrace

[http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.aspx)

好文章在这里：

[http://www.codeproject.com/KB/trace/customtracelistener.aspx](http://www.codeproject.com/KB/trace/customtracelistener.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T19:12:22.683

反射会告诉您方法具有的参数类型，但它不会帮助您在任何特定调用期间发现它们的值。反射根本不会告诉您有关局部变量的任何信息。

您需要调试器用来访问此类信息的那种 API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T19:12:57.003

我认为这是不可能的，您可以通过查看 StackTrace 来获取方法及其参数。

```
System.Diagnostics.StackTrace sTrace = new System.Diagnostics.StackTrace(true);
for (Int32 frameCount = 0; frameCount < sTrace.FrameCount; frameCount++){ 
     System.Diagnostics.StackFrame sFrame = sTrace.GetFrame(frameCount);
     System.Reflection.MethodBase thisMethod = sFrame.GetMethod();
     if (thisMethod == currentMethod){
          if (frameCount + 1 <= sTrace.FrameCount){
               System.Diagnostics.StackFrame prevFrame = sTrace.GetFrame(frameCount + 1);
               System.Reflection.MethodBase prevMethod = prevFrame.GetMethod();
          }
     }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T19:30:56.920

我不知道如何使用反射，但看看使用编织。SpringFramework.Net 允许您定义可以拦截方法调用的切入点。其他人可能也会这样做。

这是“BeforeAdvice”拦截器的链接 [http://www.springframework.net/docs/1.2.0-M1/reference/html/aop.html#d0e8139](http://www.springframework.net/docs/1.2.0-M1/reference/html/aop.html#d0e8139)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-23T00:32:33.083

[secondlife](http://secondlife.com/)的人们暂停脚本并在服务器之间移动它们。这意味着他们必须捕获正在运行的脚本的状态，包括调用堆栈上的变量值。

他们的脚本语言在 mono 上运行，mono 是 .NET 运行时的开源实现。我怀疑他们的解决方案是否适用于常规的 .NET 运行时，但是[关于他们如何做到这一点的演示视频](http://download.microsoft.com/download/9/4/1/94138e2a-d9dc-435a-9240-bcd985bf5bd7/Jim-Cory-SecondLife.wmv)（跳到下半部分）可能仍然很有趣。

# xml - XML Schema XSD TotalDigits 与 MaxInclusive

> ID：168402
> 
> 赞同：8
> 
> 时间：2008-10-03T19:06:44.817
> 
> 标签：xml, xsd

我遇到了具有以下定义的 XML Schema：

```
<xs:simpleType name="ClassRankType">
    <xs:restriction base="xs:integer">
        <xs:totalDigits value="4"/>
        <xs:minInclusive value="1"/>
        <xs:maxInclusive value="9999"/>
    </xs:restriction>
</xs:simpleType> 
```

但是，在我看来，这`totalDigits`是多余的。我对 XML Schema 有点陌生，并且想确保我没有遗漏任何东西。

`totalDigits`vs.的实际行为是`maxInclusive`什么？

总是可以`totalDigits`用 和 的组合来`minInclusive`表示`MaxInclusive`？

如何`totalDigits`影响负数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-03T19:22:20.057

> totalDigits 总是可以用 minInclusive 和 MaxInclusive 的组合来表示吗？

在这种情况下，是的。当您处理整数时，该值必须是整数，因此您在`minInclusive`和之间有一组有限的值`maxInclusive`。如果您有十进制值，`totalDigits`会告诉您该值总共有多少个数字。

> totalDigits 如何影响负数？

它是数字中允许的总位数，不受小数点、减号等影响。来自[auxy.com](http://www.auxy.com/study/xml_notes/04.Adding_XSD_restrictions/)：

> 由分面的 value 属性指定的`<xsd:totalDigits>`数字将限制数字中允许的小数点两侧的总位数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T19:25:35.183

totalDigits 是数字可以有的总位数，包括十进制数。因此，totalDigits 为 4 将允许 4.345 或 65.43 或 932.1 或 4 位整数，如上例所示。负数也一样。之前的任何示例都可以设为负数，并且仍然验证为 4 的总数。

max 和 min 包含/排除限制数字的范围。在您的示例中，maxinclusive 可能看起来有点多余，但 mininclusive 确保该数字大于 0。

# c++ - void* 指针的 C++ 替代方案（不是模板）

> ID：168408
> 
> 赞同：7
> 
> 时间：2008-10-03T19:10:07.820
> 
> 标签：c++, templates, pointers, polymorphism

看来我对 C++ 有一个根本的误解：<

我喜欢多态容器解决方案。谢谢你，让我注意到这一点:)

* * *

所以，我们需要创建一个相对通用的容器类型对象。它也恰好封装了一些业务相关的逻辑。然而，我们需要在这个容器中存储基本上任意的数据——从原始数据类型到复杂类的所有内容。

因此，人们会立即跳到模板类的想法并完成它。但是，我注意到 C++ 多态性和模板不能很好地协同工作。由于有一些复杂的逻辑我们将不得不工作，我宁愿只使用模板或多态性，而不是试图通过使其两者兼而有之来对抗 C++。

最后，鉴于我想做一个或另一个，我更喜欢多态性。我发现表示“这个容器包含 Comparable 类型”之类的约束要容易得多 - 一个 la java.lang.

把我带到问题的话题：最抽象的，我想我可以有一个“容器”纯虚拟接口，类似于“push（void * data）和pop（void * data）”（记录在案） ，我实际上并没有尝试实现堆栈）。

但是，我真的不喜欢顶层的 void*，更不用说每次我想为具体容器可以使用的数据类型添加约束时签名都会发生变化。

总结：我们有相对复杂的容器，有各种方法来检索元素。我们希望能够改变对可以进入容器的元素的约束。元素应该与多种容器一起使用（只要它们满足特定容器的约束）。

编辑：我还应该提到容器本身需要是多态的。这是我不想使用模板化 C++ 的主要原因。

那么 - 我应该放弃对 Java 类型接口的热爱并使用模板吗？我应该使用 void* 并静态转换所有内容吗？或者我应该使用一个空的类定义“元素”，它什么都不声明，并将其用作“元素”层次结构中的顶级类？

我喜欢堆栈溢出的原因之一是，许多回复提供了一些我从未考虑过的其他方法的有趣见解。因此，提前感谢您的见解和评论。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-03T19:21:11.790

如果您将真正的任意数据存储到容器中，您可以考虑使用[boost::any的标准容器。](http://www.boost.org/doc/libs/1_36_0/doc/html/any.html)

听起来您更像是更喜欢[boost::ptr_container 之](http://www.boost.org/doc/libs/1_36_0/libs/ptr_container/doc/ptr_container.html)类的东西，其中*可以*存储在容器中的任何东西都必须从某些基本类型派生，而容器本身只能为您提供对基本类型的引用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T19:16:49.773

如果您正确使用它们，多态性和模板确实可以很好地结合使用。

无论如何，我知道您只想在每个容器实例中存储一种类型的对象。如果是这样，请使用模板。这将防止您错误地存储错误的对象类型。

至于容器接口：根据您的设计，也许您也可以将它们模板化，然后它们将具有类似`void push(T* new_element)`. 想一想当您想将对象添加到（未知类型的）容器时您会知道什么。对象首先来自哪里？一个返回的函数`void*`？你知道它会是可比的吗？至少，如果在您的代码中定义了所有存储的对象类，您可以使它们都继承自一个共同的祖先，例如`Storable`，并使用`Storable*`而不是`void*`.

现在，如果您看到对象总是会通过类似的方法添加到容器中`void push(Storable* new_element)`，那么将容器设置为模板确实没有任何附加值。但是你会知道它应该存储 Storables。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-03T19:18:36.010

简单的事情是定义一个名为 的抽象基类`Container`，并为您可能希望存储的每种项目对其进行子类化。然后，您可以使用任何标准集合类（`std::vector`、`std::list`等）来存储指向`Container`. 请记住，由于您将存储指针，因此您必须处理它们的分配/释放。

但是，您需要一个集合来存储如此不同类型的对象这一事实表明您的应用程序设计可能存在问题。在实现这个超通用容器之前重新审视业务逻辑可能会更好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-03T19:21:23.133

首先，模板和多态性是正交的概念，它们可以很好地协同工作。接下来，为什么要特定的数据结构？STL 或 boost 数据结构（特别是[指针容器](http://www.boost.org/doc/libs/1_35_0/libs/ptr_container/doc/reference.html)）对您不起作用。

鉴于您的问题，听起来您会在您的情况下滥用继承。可以对容器中的内容创建“[约束”，尤其是在使用模板时。](http://www.boost.org/doc/libs/1_36_0/libs/static_assert/static_assert.htm)这些约束可能超出编译器和链接器所能提供的范围。实际上，对于继承和错误更有可能留在运行时的那种事情更尴尬。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-03T19:31:25.093

你不能有一个包含元素的根容器类：

```
template <typename T>
class Container
{
public: 

   // You'll likely want to use shared_ptr<T> instead.
   virtual void push(T *element) = 0;
   virtual T *pop() = 0;
   virtual void InvokeSomeMethodOnAllItems() = 0;
};

template <typename T>
class List : public Container<T>
{
    iterator begin();
    iterator end();
public:
    virtual void push(T *element) {...}
    virtual T* pop() { ... }
    virtual void InvokeSomeMethodOnAllItems() 
    {
       for(iterator currItem = begin(); currItem != end(); ++currItem)
       {
           T* item = *currItem;
           item->SomeMethod();
       }
    }
}; 
```

然后可以多态地传递这些容器：

```
class Item
{
public:
   virtual void SomeMethod() = 0;
};

class ConcreteItem
{
public:
    virtual void SomeMethod() 
    {
        // Do something
    }
};  

void AddItemToContainer(Container<Item> &container, Item *item)
{
   container.push(item);
}

...

List<Item> listInstance;
AddItemToContainer(listInstance, new ConcreteItem());
listInstance.InvokeSomeMethodOnAllItems(); 
```

这以类型安全的通用方式为您提供了 Container 接口。

如果要对可以包含的元素类型添加约束，可以执行以下操作：

```
class Item
{
public:
  virtual void SomeMethod() = 0;
  typedef int CanBeContainedInList;
};

template <typename T>
class List : public Container<T>
{
   typedef typename T::CanBeContainedInList ListGuard;
   // ... as before
}; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T19:21:12.197

使用多态性，您基本上只剩下容器的基类和数据类型的派生类。基类/派生类可以在两个方向上拥有任意数量的虚函数。

当然，这意味着您还需要将原始数据类型包装在派生类中。如果您要重新考虑整体模板的使用，这就是我将使用模板的地方。从作为模板的基类创建一个派生类，并将其用于原始数据类型（以及其他不需要模板提供的功能的其他类）。

不要忘记，您可能会通过 typedef 为每个模板化类型简化您的生活——尤其是当您以后需要将其中一个转换为类时。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T19:43:25.257

您可能还想查看[Boost 概念检查库 (BCCL)](http://www.boost.org/doc/libs/1_36_0/libs/concept_check/concept_check.htm)，它旨在为模板化类的模板参数提供约束，在这种情况下是您的容器。

重申一下其他人所说的话，我从来没有遇到过混合多态性和模板的问题，而且我已经用它们做了一些相当复杂的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-03T19:47:14.233

您不必放弃类似 Java 的接口并同时使用模板。 [Josh](https://stackoverflow.com/questions/168408/c-alternatives-to-void-pointers-that-isnt-templates#168509 "乔希的建议")对通用基础模板 Container 的建议当然允许您以多态方式传递 Container 及其子项，但另外您当然可以将接口实现为抽象类作为包含的项目。您没有理由不能按照您的建议创建一个抽象的 IComparable 类，这样您就可以拥有如下的多态函数：

```
class Whatever
{
   void MyPolymorphicMethod(Container<IComparable*> &listOfComparables);
} 
```

此方法现在可以采用包含任何实现 IComparable 的类的 Container 的任何子级，因此它非常灵活。

# python - 如何在 python 中获得按创建日期排序的目录列表？

> ID：168409
> 
> 赞同：169
> 
> 时间：2008-10-03T19:10:08.130
> 
> 标签：python, windows, directory

获取目录中所有文件列表的最佳方法是什么，按日期排序 [创建 | 修改]，在Windows机器上使用python？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2008-10-03T19:12:48.453

我过去曾为 Python 脚本执行此操作，以确定目录中最后更新的文件：

```
import glob
import os

search_dir = "/mydir/"
# remove anything from the list that is not a file (directories, symlinks)
# thanks to J.F. Sebastion for pointing out that the requirement was a list 
# of files (presumably not including directories)  
files = list(filter(os.path.isfile, glob.glob(search_dir + "*")))
files.sort(key=lambda x: os.path.getmtime(x)) 
```

那应该根据文件 mtime.

**编辑**：请注意，如果需要，您还可以使用 os.listdir() 代替 glob.glob() - 我在原始代码中使用 glob 的原因是我想使用 glob 仅搜索具有特定集的文件文件扩展名， glob() 更适合。使用 listdir 如下所示：

```
import os

search_dir = "/mydir/"
os.chdir(search_dir)
files = filter(os.path.isfile, os.listdir(search_dir))
files = [os.path.join(search_dir, f) for f in files] # add path to each file
files.sort(key=lambda x: os.path.getmtime(x)) 
```

* * *

## 回答 #2

> 赞同：137
> 
> 时间：2009-02-11T21:58:21.737

*更新*`dirpath`：在 Python 3 中按修改日期对 的条目进行排序：

```
import os
from pathlib import Path

paths = sorted(Path(dirpath).iterdir(), key=os.path.getmtime) 
```

[（将[@Pygirl 的答案](https://stackoverflow.com/a/58772122/4279)放在这里以获得更大的知名度）]

如果您已经有一个文件名列表`files`，则在 Windows 上按创建时间对其进行就地排序（确保该列表包含绝对路径）：

```
files.sort(key=os.path.getctime) 
```

例如，您可以获得的文件列表，如[@Jay's answer](https://stackoverflow.com/a/168424/4279)`glob`中所示。

* * *

^(旧答案这是)[`@Greg Hewgill`'s answer](https://stackoverflow.com/questions/168409/how-do-you-get-a-directory-listing-sorted-by-creation-date-in-python/168435#168435) 的更详细版本。是最符合题目要求的。它区分了创建日期和修改日期（至少在 Windows 上）。

```
#!/usr/bin/env python
from stat import S_ISREG, ST_CTIME, ST_MODE
import os, sys, time

# path to the directory (relative or absolute)
dirpath = sys.argv[1] if len(sys.argv) == 2 else r'.'

# get all entries in the directory w/ stats
entries = (os.path.join(dirpath, fn) for fn in os.listdir(dirpath))
entries = ((os.stat(path), path) for path in entries)

# leave only regular files, insert creation date
entries = ((stat[ST_CTIME], path)
           for stat, path in entries if S_ISREG(stat[ST_MODE]))
#NOTE: on Windows `ST_CTIME` is a creation date 
#  but on Unix it could be something else
#NOTE: use `ST_MTIME` to sort by a modification date

for cdate, path in sorted(entries):
    print time.ctime(cdate), os.path.basename(path) 
```

例子：

```
$ python stat_creation_date.py
Thu Feb 11 13:31:07 2009 stat_creation_date.py 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2011-02-06T16:47:48.147

有一个`os.path.getmtime`函数给出自纪元以来的秒数，应该比`os.stat`.

```
import os 

os.chdir(directory)
sorted(filter(os.path.isfile, os.listdir('.')), key=os.path.getmtime) 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2008-10-03T19:46:53.813

这是我的版本：

```
def getfiles(dirpath):
    a = [s for s in os.listdir(dirpath)
         if os.path.isfile(os.path.join(dirpath, s))]
    a.sort(key=lambda s: os.path.getmtime(os.path.join(dirpath, s)))
    return a 
```

首先，我们建立一个文件名列表。isfile() 用于跳过目录；如果应该包含目录，则可以省略它。然后，我们使用修改日期作为键对列表进行就地排序。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2008-10-03T19:15:23.300

这是一个单行：

```
import os
import time
from pprint import pprint

pprint([(x[0], time.ctime(x[1].st_ctime)) for x in sorted([(fn, os.stat(fn)) for fn in os.listdir(".")], key = lambda x: x[1].st_ctime)]) 
```

这会调用 os.listdir() 来获取文件名列表，然后为每个文件调用 os.stat() 来获取创建时间，然后根据创建时间进行排序。

请注意，此方法仅对每个文件调用一次 os.stat()，这将比为排序中的每次比较调用它更有效。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2015-05-21T18:28:30.963

不改变目录：

```
import os    

path = '/path/to/files/'
name_list = os.listdir(path)
full_list = [os.path.join(path,i) for i in name_list]
time_sorted_list = sorted(full_list, key=os.path.getmtime)

print time_sorted_list

# if you want just the filenames sorted, simply remove the dir from each
sorted_filename_list = [ os.path.basename(i) for i in time_sorted_list]
print sorted_filename_list 
```

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2017-09-15T04:25:28.180

在 python 3.5+

```
from pathlib import Path
sorted(Path('.').iterdir(), key=lambda f: f.stat().st_mtime) 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2019-11-08T18:38:11.423

```
from pathlib import Path
import os

sorted(Path('./').iterdir(), key=lambda t: t.stat().st_mtime) 
```

或者

```
sorted(Path('./').iterdir(), key=os.path.getmtime) 
```

或者

```
sorted(os.scandir('./'), key=lambda t: t.stat().st_mtime) 
```

其中 m 时间是修改时间。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2013-09-13T09:59:29.113

如果您想按日期顺序读取具有特定扩展名的文件（Python 3），这是我使用不带过滤器的 glob 的答案。

```
dataset_path='/mydir/'   
files = glob.glob(dataset_path+"/morepath/*.extension")   
files.sort(key=os.path.getmtime) 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2019-09-07T06:30:46.933

```
# *** the shortest and best way ***
# getmtime --> sort by modified time
# getctime --> sort by created time

import glob,os

lst_files = glob.glob("*.txt")
lst_files.sort(key=os.path.getmtime)
print("\n".join(lst_files)) 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-03T20:07:15.753

```
sorted(filter(os.path.isfile, os.listdir('.')), 
    key=lambda p: os.stat(p).st_mtime) 
```

您可以使用`os.walk('.').next()[-1]`而不是使用过滤`os.path.isfile`，但这会在列表中留下无效的符号链接，并且`os.stat`会在它们上失败。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-06-03T09:26:16.423

这是我的版本：

```
import os

folder_path = r'D:\Movies\extra\new\dramas' # your path
os.chdir(folder_path) # make the path active
x = sorted(os.listdir(), key=os.path.getctime)  # sorted using creation time

folder = 0

for folder in range(len(x)):
    print(x[folder]) # print all the foldername inside the folder_path
    folder = +1 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-10-18T02:29:25.273

这是学习的基本步骤：

```
import os, stat, sys
import time

dirpath = sys.argv[1] if len(sys.argv) == 2 else r'.'

listdir = os.listdir(dirpath)

for i in listdir:
    os.chdir(dirpath)
    data_001 = os.path.realpath(i)
    listdir_stat1 = os.stat(data_001)
    listdir_stat2 = ((os.stat(data_001), data_001))
    print time.ctime(listdir_stat1.st_ctime), data_001 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-08-11T21:18:41.300

如果文件是指向不存在文件的符号链接，则亚历克斯考文垂的答案将产生异常，以下代码更正了该答案：

```
import time
import datetime
sorted(filter(os.path.isfile, os.listdir('.')), 
    key=lambda p: os.path.exists(p) and os.stat(p).st_mtime or time.mktime(datetime.now().timetuple()) 
```

当文件不存在时，使用 now() ，符号链接将位于列表的最后。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-09-20T15:39:32.157

为了完整性`os.scandir`（比 快 2 倍`pathlib`）：

```
import os
sorted(os.scandir('/tmp/test'), key=lambda d: d.stat().st_mtime) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-04-03T16:17:25.607

这是寻找扩展并提供排序选项的简单几行

```
def get_sorted_files(src_dir, regex_ext='*', sort_reverse=False): 
    files_to_evaluate = [os.path.join(src_dir, f) for f in os.listdir(src_dir) if re.search(r'.*\.({})$'.format(regex_ext), f)]
    files_to_evaluate.sort(key=os.path.getmtime, reverse=sort_reverse)
    return files_to_evaluate 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2021-02-02T15:39:09.470

结果`os.listdir`按上次修改排序，但相反，因此您可以执行以下操作：

```
import os
last_modified=os.listdir()[::-1] 
```

* * *

## 回答 #18

> 赞同：-5
> 
> 时间：2008-10-03T19:14:18.263

也许你应该使用 shell 命令。在 Unix/Linux 中， find piped with sort 可能会做你想做的事。

# asp.net - .NET 中的 Tcp/Ip 套接字连接

> ID：168415
> 
> 赞同：4
> 
> 时间：2008-10-03T19:11:18.660
> 
> 标签：asp.net, sockets, tcp

对于我当前的项目，我需要通过 tcp/ip 套接字连接请求 XML 数据。为此，我正在使用 TcpClient 类：

```
Dim client As New TcpClient()
client.Connect(server, port)

Dim stream As NetworkStream = client.GetStream()
stream.Write(request)
stream.Read(buffer, 0, buffer.length)

// Output buffer and return results... 
```

现在，对于小的响应，这工作得很好而且花花公子。但是，当我开始接收更大的数据块时，数据似乎会以突发方式通过套接字连接推送。发生这种情况时，stream.Read 调用仅读取第一个突发，因此我错过了其余的响应。

处理这个问题的最佳方法是什么？最初我试图循环直到我有一个有效的 XML 文档，但我发现在 stream.Read 调用之间，底层流有时会被关闭，我会错过数据的最后一部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T19:12:00.077

你创建了一个阅读循环。

Stream.Read 对于它到目前为止读取的字节返回 int，如果到达流的末尾，则返回 0。

所以，它就像：

```
int bytes_read = 0;
while (bytes_read < buffer.Length)
   bytes_read += stream.Read(buffer, bytes_read, buffer.length - bytes_read); 
```

编辑：现在，问题是如何确定缓冲区的大小。如果您的服务器首先发送大小，那没关系，您可以使用上面的代码段。但是，如果您必须在服务器关闭连接之前读取，那么您必须使用 try/catch（即使您知道大小，这也是个好主意），并使用 bytes_read 来确定您收到的内容。

```
int bytes_read = 0;
try
{
   int i = 0;
   while ( 0 < (i = stream.Read(buffer, bytes_read, buffer.Length - bytes_read) )
      bytes_read += i;
}
catch  (Exception e)
{
//recover
}
finally
{
if (stream != null)
   stream.Close();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T19:17:05.700

不保证读取完全读取流。它返回实际读取的字节数，如果没有更多字节要读取，则返回 0。您应该继续循环以从流中读取所有数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T22:05:38.443

这是一种可能的方法来“响应”响应字符串。如果您需要字节数组，只需保存 ms.ToArray()。

```
string response;

TcpClient client = new TcpClient();
client.Connect(server, port);
using (NetworkStream ns = c.GetStream())
using (MemoryStream ms = new MemoryStream())
{
    ns.Write(request);

    byte[] buffer = new byte[512];
    int bytes = 0;

    while(ns.DataAvailable)
    {
        bytes = ns.Read(buffer,0, buffer.Length);
        ms.Write(buffer, 0, bytes);
    }

    response = Encoding.ASCII.GetString(ms.ToArray());
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T10:33:17.413

我强烈建议您尝试使用 WCF 来完成此类任务。经过不那么陡峭的学习曲线后，它为您提供了比原始套接字通信更多的好处。对于手头的任务，我同意前面的答案，您应该使用循环并根据需要动态分配内存。

# svn - 为什么 subversion 在签入时会 chown/recreate 文件？

> ID：168423
> 
> 赞同：2
> 
> 时间：2008-10-03T19:12:45.740
> 
> 标签：svn, permissions

我有一个个人维基，我会在上面做笔记。wiki 的页面位于 subversion 工作副本目录“pages”中，我将它们的权限设置为 664，由 www-data:www-data 拥有。我的用户名在“www-data”组中，所以我可以手动签入和弄乱页面。

有一段时间，我遇到了一个问题，因为每次我运行签入时，文件都会归我所有：www-data 而不是 www-data:www-data，我将无法再通过以下方式更改 wiki 文件我的网页界面！我通过翻转“pages”目录上的 setgid 位解决了这个问题，但我仍然对为什么会首先发生这种情况感到困惑：

每次我将某些东西签入颠覆时，似乎 svn 删除它并重新创建它。为什么？此行为是否支持某些我不知道的功能？有没有办法改变它？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-07T13:45:00.047

设置“粘性”权限位。

```
find -type d -exec chgrp www-data {} + 
find -type d -exec chmod g+s {} + 
```

这将鼓励结帐的文件创建阶段继承目录权限，而不是切换到最后编辑它的人。

**编辑**：dow +s == setgid。留给后代和其他读者的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T11:34:09.983

我认为你用错了。您可以做的仍然是将所有内容都保留在 subversion 中，并将您的本地工作副本与您开发的 www 目录分开。

[然后只需通过某个脚本（可能作为提交后](http://svnbook.red-bean.com/en/1.5/svn.ref.reposhooks.post-commit.html)挂钩）为 www 用户自动更新 www 工作副本（或者如果您不希望 www 文件夹中的 .svn 目录导出），然后设置权限因此。

工作流程是：

1.  编辑 /home/youruser/yourwiki-working-copy/ 中的文件
2.  做svn提交
    *   post-commit 挂钩更新 /var/www/ 中的文件（或 wiki 所在的任何位置）
3.  转到 1。

这样，您就不必担心权限问题，甚至可以让多个人在网站上工作，同时享受版本控制的所有好处。

# java - 如何在 Eclipse 3.2 Java 插件中添加快捷键来构建当前项目？

> ID：168426
> 
> 赞同：19
> 
> 时间：2008-10-03T19:13:23.197
> 
> 标签：java, eclipse, eclipse-3.2

关于 Eclipse Java 插件的少数令人讨厌的事情之一是缺少用于构建与当前资源相关联的项目的键盘快捷方式。有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-03T19:37:34.130

在 Preferences 对话框中，General 部分下是一个名为“Keys”的对话框。这使您可以将键绑定附加到许多事件，包括构建项目。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-03T21:22:31.640

您可以将键盘绑定分配给*Build Project*执行以下操作

1.  打开 Keys 首选项，Window > Preferences > General > Keys
2.  按类型过滤构建项目
3.  突出显示绑定字段。

然后你可以选择你想要的绑定

即`Ctrl`+ `ALt`+ `B`, `P`,

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T19:25:35.590

我相信`Ctrl`+`B`默认情况下已经为此配置了。只需要有一个有焦点的编辑窗口。

# reporting-services - 将 SQL Server Reporting Services 与 Crystal Reports 进行比较

> ID：168427
> 
> 赞同：84
> 
> 时间：2008-10-03T19:13:26.440
> 
> 标签：reporting-services, crystal-reports, report

[Crystal Reports](http://en.wikipedia.org/wiki/Crystal_Reports)和[SSRS](http://en.wikipedia.org/wiki/SQL_Server_Reporting_Services) （SQL Server Reporting Services）哪个更好用？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2008-10-05T05:15:55.023

一方面，Crystal Reports 是一大堆昂贵且被夸大的驴屎，另一方面，SSRS 实际上实现了 CR 营销所做的所有承诺——而且它是免费的。

我对 CR 的蔑视源于多年被迫使用可怕的东西。当我可以为您提供参考资料时，详细说明 CR 的完全可憎是没有意义的，例如[Clubbing the Crystal Dodo](http://secretgeek.net/CrystalDodo.asp)或[Crystal Reports Sucks Donkey Dork](http://unbecominglevity.blogharbor.com/blog/_archives/2005/12/21/1474036.html)（不是那么有趣，而是更有文化，并且有技术细节证实）。

自由的？！是的。您甚至不必购买 MS SQL Server 即可获得它 - 您可以安装带有高级服务的 SQL Express。这可作为[包含 SQL Server Reporting Services 的下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=B5D1B8C3-FDA5-4508-B0D0-1311D670E336&displaylang=en)获得。虽然 SQL Express 可以支持的并发用户数量有限，但以下观察很明显：

*   作为 SQL Express 的一部分获得的 SSRS 许可证仅要求将其作为 SQL Express 的一部分进行部署。没有禁止连接到其他数据源或要求报表从 SQL Server 获取数据。

*   上述版本的 SSRS 对用户连接没有内在限制。所有限制都施加在 SQL Express 数据库引擎上。

*   SSRS 使用 ADO.NET，其中包括开箱即用的 Oracle、Jet (Access)、OLEDB 和 ODBC 驱动程序

因此，您可以将免费版本的 SSRS 连接到您可以连接 ADO.NET 的任何后端，其中包括（例如）MySQL。Rory 在下面的评论中告诉我，这是“不支持”的。这是真的，但我在许可证中找不到任何禁止它的内容，虽然驱动程序不是*由 SSExpress*提供的，但它们肯定*是*由大多数版本的 Visual Studio 提供的，您可以在安装工具包中提供它们。这可能不是明确支持的配置，但那又如何？即使您确实拥有完整的 MSSQL 许可证，期望 Microsoft 帮助您与某些第三方数据库进行对话也会要求很高（更不用说有点奇怪了）。

我在工作中广泛使用 SSRS 来生成面向内的报表和嵌入在 ASP.NET 应用程序中的面向外的报表，这些应用程序为大量付费客户提供办公室服务。在我们的案例中，后备存储恰好是 Microsoft SQL Server 2008 的许可副本，但这与我们的报告解决方案的技术优点无关。

Crystal Reports 声称支持一长串功能，但如果您想要超过五个用户，这些功能要么不起作用，要么需要非常昂贵的许可证。您甚至不能相信 CR 能够正确执行 SQL。`SELECT COUNT(*) FROM SOMETABLE WHERE 1=0`应该产生零的结果，但它会产生*一*。内置的查询引擎是有缺陷的，一个团队搞砸了一些业余爱好者可以免费做的事情（例如 MySQL），他们没有希望从他们的代码中得到任何你认为是性能的东西。

他们没有。邪恶的东西像没有底的水桶一样泄漏内存，如果你使用 SQL 分析工具你会发现它的[效率非常低。](http://unbecominglevity.blogharbor.com/blog/_archives/2005/12/21/1474036.html)

至于所谓的支持，我个人可以证明，对话框调整大小错误在首次公开记录后*几十年都没有得到纠正。*如果你拿出你的信用卡并支付勒索的赎金（我也想要丰厚的报酬来支持这样的恐怖），你会发现自己在和一个声称他的名字是大卫的人说话，但莫名其妙地发音为“Dah-feet”，谁甚至不理解你的问题，更不用说有答案了。

SSRS 支持情况非常相似，但它确实有效，因此您并不需要太多。

另一方面，SSRS 做了 CR 声称的所有事情。它并非没有错误，但它们非常少，而且它们很少能在一个以上的发布周期中存活下来。

SSRS 设计器 UI 托管在 Visual Studio IDE 中。它以典型的 Microsoft 风格呈现，极具吸引力，但不仅如此，它还经过深思熟虑，与传统报表设计器有几个简单但基本的不同之处。例如，要呈现表格数据，您需要定义一个表格，而不是摆弄单个文本框。因此，您不必费力地尝试将它们排列起来，并且在它们上设置边框是一项微不足道的样式表练习。

SSRS 实际上做了 CR 声称的所有事情，它价格低廉，有大量可靠的技术文档，它被设计为可扩展（也有文档），您可以将它连接到任何可以获得 ODBC 驱动程序的东西。这是没有道理的。

## SSRS的一些缺点

*   如何绑定页眉和页脚中的字段并不明显。
*   （据我所知）不可能相对于页面底部进行定位。对于某些类型的报告来说，这是一个真正的问题，而且我想不出任何解决方法。
*   交叉表中不支持 expando 水平汇总。
*   不直接支持报表页眉和页脚。在报表布局的顶部和底部使用 Rectangle 对象，并适当设置分页属性。或使用子报表。抱怨这件事的人显然没有很努力。
*   缺乏对重叠组间隔的支持（CR 分组系统可以做到这一点）**更新**SSRS 2008 R2 现在支持这一点。它隐藏在分组编辑对话框中。查找“组变量”并[阅读此内容](http://blogs.msdn.com/b/robertbruckner/archive/2008/07/20/using-group-variables-in-reporting-services-2008-for-custom-aggregation.aspx)。

实际上看起来重叠组也可以使用 SSRS2005 完成，尽管我从来不知道。我想知道有没有人破解过底部相对定位问题？

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-09-12T08:39:00.040

在版本 10 之前，我一直在使用 Crystal 报表，并且一直在使用 ASP.NET 应用程序成功地完成我想要的东西。它在网络上的输出非常好，就像 WYSIWYG 一样，导出到 Excel 和 PDF 也很准确。印刷也非常正确。

最近，我已经在 SSRS 2005 上工作了大约一年，并且亲眼目睹了许多必须开箱即用的缺陷。SSRS Web 输出因不同的浏览器和不同的分辨率而有很大差异，并且很容易让开发人员感到不适。此外，报表查看器的滚动问题会让最终用户很早就生气，因为它是基于使用 IFRAME 的 HTML。（*注意：Crystal 13 在 Web 查看器中使用 IFRAME，存在零星的文本换行和重叠问题*）。出口一点都不好。您无法在单元格中将图像左对齐或居中对齐，也无法为图像指定背景颜色。您不能居中对齐完整的报告正文。为了可能，我已经使用渲染的 HTML 玩了几个小时，并想出了确切的替代方法来使它工作，但我猜 SSRS 开发人员不知道这些简单的修复，因为可能他们自己从未使用过 SSRS。

此外，在 Web 应用程序中，您需要为参数开箱即用地承受糟糕的 UI。我只是将它完全删除，在 ASPX 页面中创建它的成本让我想到在 DataGrids 中设计表格报表，而不是使用 ObjectDataSource 和数据库分页技术。您无法根据需要布置参数。参数部分中的错误回发完整报告而无需任何更改。使用分组进行分页有一个技巧，但在完整数据集上排序失败。对于中高级 UI 要求的每一点，SSRS 都需要花费大量时间来弄清楚它根本不可能。由于 SSRS 用户较少，在线社区对于简单的问题没有好的解决方案。不要忘记 SSRS 的优点是它的部署、内置通知、缓存和配置方面，但没有 UI 可以取胜。

底线是，我看到 SSRS 让您感到沮丧，只是因为 Microsoft 支持团队在不得不说“对不起！一个月后不是现在。SSRS 2008 也没有立即修复这些问题。此外，迁移到 SSRS'08 也意味着后端平台的完全迁移。请记住，您使用软件的次数越多，随着时间的推移，它就越成熟，Crystal 无论如何都是一个更好的选择，因为 SSRS 很快就会积累您自己修复错误的成本。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-27T20:11:26.737

由于该线程已重新打开，因此我将添加两美分。在版本 7 和 8 天期间，我不得不使用 Crystal 大约三年。我讨厌它的每一分钟。我看过一些较新的版本，但仍然不喜欢它。

我非常不喜欢它，以至于这样说我很痛苦：根据我的经验，Crystal 比 SSRS 更适合复杂的报告。我和一位同事拼命尝试让一个中等复杂的报表布局在 SSRS 中工作并放弃了。我对产品的印象——只是我的看法，请注意——是它还没有准备好迎接黄金时段。

水晶会让你讨厌你的生活并寻找另一份工作，但它如此普遍是有原因的：它有效。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-03T19:33:48.363

您可以通过包含 3 个 DLL 文件来使用 Reporting Services 部署应用程序。这是一个巨大的好处。（注意——您必须从 GAC 获取 3 个 DLL 文件之一。）

使用 Crystal Reports，您必须在将运行应用程序的每台机器（网站或客户端应用程序）上安装运行时。

Reporting Services 具有大多数人需要的所有功能，而且部署更加容易。除非必须，否则我永远不会使用 Crystal Reports。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-10-03T19:24:56.090

根据我的经验，Reporting Services 要好得多。这是一个更好的环境，但最好的连接（数据源）与报表是分开的并且可以共享。这使得环境之间的部署更加简单。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-05-21T01:46:38.573

两者我都用过，我会在已经说过的基础上补充几点：

*   对于简单的东西，我默认推荐 SSRS。水晶有点臃肿和古怪。

*   Crystal 可以轻松导出为 MS Word 格式 (.doc)。根据我的经验，客户经常想要这个。

*   如果格式很重要，Crystal 可能会更好。例如，SSRS 报告在一个文本框中不能有超过一种类型的文本。这意味着您不能在报告顶部添加同时包含斜体和普通文本的评论。水晶可以做到这一点：

* * *

**注意：**此报告包含从开始日期到结束日期的数据，*包括*这些日期。

* * *

SRSS 不能（没有多个重叠的文本框）。我曾经有一个 20 页的 word 文档给我，要转换成一个报告，其中包含十几个图表和表格的数据。我从 SSRS 开始，但意识到在 Crystal 中我可以直接从 word 中复制和粘贴报告的硬编码位，带有彩色标题和所有内容，并节省了几天的工作时间。所以水晶在很多方面确实有一个更好的“设计师”。

**更新：
显然这两个问题都已在当前的 SRSS 中得到修复。有人愿意对此发表进一步评论吗？**

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-03T19:30:31.617

我同意[@Carlton](https://stackoverflow.com/questions/168427/compare-sql-server-reporting-services-to-crystal-reports#168475)的部分原因是他描述的原因。我还认为报告服务是一种更成熟的产品（尽管 Crystal Reports 的存在时间更长）。测试和部署模型非常实用，跟踪报告使用情况的内置功能非常有用。

我还发现在 Reporting Services 中设计报表要容易得多——微软已经学会了如何构建一个好的 IDE，而 Crystal IDE 似乎总是事后才想到的（尽管这比胎衣要好，这是过去的样子） .

编辑：其他想法我还认为，在 Windows 商店中，SSRS 提供了与操作系统和 SQL Server 的各种甜蜜集成。您可以依靠 SQL 程序集在 SSRS 中相当轻松地重用内置代码，并且与 Active Directory 安全模型的集成使保护您的报告变得非常容易。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-12-12T02:39:28.867

伙计……我的公司有很多水晶报告……而之前的公司也有很多。从版本 8.5 到 11.5。可以这么说，他们有点已经踏入了大门。我认为 CrystalReportViewer 是一个热气腾腾的废话，但它确实有效（在大多数情况下）。

在阅读了其中一些答案后，我正在为我的下一个报告项目切换到 SSRS！写在墙上...MS将从VS中删除Crystal并替换为SSRS。唯一会糟糕的是当 MS 开始为它收费时。

编辑：今天与 SSRS 混在一起，看起来很有希望。我必须说设计师正在慢慢适应……CR Designer 在易用性方面做得很好。你可以看出这是为程序员设计的，因为 CR 是面向报表设计者的。

EDIT2：SSRS 确实无法满足我的报告需求。当您想要预览并且没有可用于独立的参数提示时，设计报告很糟糕。有没有更好的方法来设计它们……最好不在 VS 中？

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-11T16:16:46.507

你有没有想过另一种选择？如果您想使用 Crystal Reports 的功能但又不想为此支付太多费用，您可以查看[Crystal-Clear](http://inetsoftware.de/products/crystalclear/)，它也是一个支持 Crystal Reports 模板的基于 Java 的报告工具。它带有一个 GUI 设计器，并且每个系统也可以配置数据源。（几乎类似于 ODBC，您只需为连接设置一个名称，然后在系统上配置连接。）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-01-24T16:47:46.670

我想知道为什么没有人提到 CR 的一个大问题——它只是在源代码控制或团队环境中失败了。如果我错了，请纠正我，但我真的很努力地寻找任何报告差异工具。有一个（大约一年前发布），但它做得不好 - 不是因为它很糟糕，而是（我猜）因为 CR 只是没有正确地公开报告结构或其他什么......我试图将 .rpt 导出到 XML 但是它笨拙且错误。我什至尝试编写自己的 .rpt 比较器。

这不仅仅是关于团队发展；即使只有一个开发人员，维护报告版本也是一场噩梦，如果您的客户决定添加少量内容或更改少量颜色，那么您现在就被诅咒要跟踪每个文本框，因为绝对无法找出更改。

RDL 格式更加干净和开放。这可能是一个非常重要的优势。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-10-01T17:26:57.767

我都使用了（Crystal Reports 2008 和 SSRS 2008），因为我没有及时注意到这个线程。

除了使用 CR 更容易设置之外，我没有注意到 CR 至少与 SSRS 相当的单一功能。是的，Crystal Reports 真的那么糟糕。

在我看来，CR 中最糟糕的部分是 IDE。但也有其他杀手级特性，比如糟糕的 SQL 性能和看起来很糟糕的图表（至少在 VS 2008 附带的 CR 版本中）也是值得注意的“杀手级”特性。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-06-10T20:05:55.003

我已经使用了多年。Crystal 报表收费太高，我尽可能尝试使用 SSRS。但是，SSRS 不支持 firefox 或任何其他浏览器，只支持 IE，这是一个问题。Crystal 中的报表看起来更好，导出功能更强大，用户希望很好地导出到 Word。如果您是 Java 程序员，我会使用 Jasper Reports，它是免费的，并且使用 Java 语言来编写函数。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-04-16T04:55:24.207

我曾与 CR 和 SSRS 合作过，这就是我发现的。

Crystal Reports 在其自己的内存中运行，而 SSRS 在有限的 SQL Server 内存中运行。

水晶报表太贵了。最近他们将价格下调至 250 美元，我认为这是对 SSRS 2008 发布的回应。

SSRS 是免费的。

水晶报表蓬勃发展的最大原因：

您可以使用 SSRS 设计项目中 80% 的报告。但是对于剩下的 20%，您必须使用其他一些报告工具。这些 20% 的报告供高层管理人员、董事和首席执行官使用。他们的要求永远不会被削弱，而 CR 在那里做得很好。

Crystal 报表仍然是基于 COM 的。这是一个痛苦的**。

水晶报表不缺少功能或特性。它是 SAP 的工作马。但是它的许多类都受到保护，并且不向程序员提供访问权限。这是故意的。SAP 的人非常贪婪，他们想要控制每一个功能，并收取额外的财富，以便在特殊许可安排下向开发人员公开这些类和对象。只需调试并快速查看 VS 中的 ReportDocument 对象，您就会知道，尽管对象中有所有可用的东西，但您几乎无法在代码中使用它们！

就 GUI 和 CSS 问题而言，期待一个专为精确打印而设计的 COM 对象，在每个浏览器中正确呈现是一个有争议的问题，因为即使是简单的 div 在不同的浏览器中呈现的方式也不同。

自 7 年以来，我一直在使用 Crystal 报表，并且一直在诅咒它，同时积极探索所有其他替代方案。但我还没有遇到像 Cystal Report 这样灵活的东西。对于大部分工作，SSRS 是好的。但是对于仪表板、带有子报表的复杂报表、资产负债表、试算表，我永远不会在 SSRS 上浪费时间。

只需尝试在 Crystal Report 上进行 Google 趋势搜索。自过去 6 年以来，它一直在稳步下降。当然，未来对于 CR 来说并不好。

但是嘿！MS、SAP 和 ORACLE 仍然支持 Crystal Report 作为其应用程序的核心！没有任何 BI 产品便宜。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-30T21:28:30.167

I feel like a martian having an extensive and positive (but sometimes complex) experience with Crystal Reports, which is now completely integrated in our user interface (VBA), where requested reports parameters and filters are transparently inherited from the user interface ...

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-19T13:06:04.120

如果您正在考虑 SSRS 并担心它是“免费”的，但您需要购买额外的 SQL Server 许可证或分发 SQL Express，那么您可能对[Data Dynamics Reports感兴趣](http://www.datadynamics.com/Products/DDRPT/Default.aspx)

它提供了 SSRS 中的所有内容，并添加了主报告、主题、日历数据区域、数据可视化（Databar、Sparkline、Iconset、ColorScale，...）、实现最大编程灵活性的完整对象模型、免版税最终用户报告设计器、条形码报表项、excel模板导出和数据合并等等。您可以从 Data Dynamics（现为 GrapeCity）下载试用版并使用少量报告进行试用，您不会失望的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-08-05T16:58:12.550

我现在和他们一起工作过，并看到他们并排。水晶一直很好，但多年来费用很高。它笨重，但我们已经习惯了它并熟悉界面。我不在 LAMP 环境中工作，这所房子与 MS Dynamics 和 MAS 以及一些相当大的客户一起工作。

我喜欢不必担心 SSRS 的客户端安装。分发要容易得多，并且共享数据源和报告模型效果很好。

就浏览器而言，我已经在 Firefox 中看到完美渲染的 SSRS 2008 仪表。我已经毫无问题地将这些仪表导出到 Excel。我已经将带有和不带 MOSS 的报告部署到手机上。使用 Windows 身份验证来部署报告以及隐藏报告的能力非常棒。VS 2005 及更高版本中的报表查看器对象很不错。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2010-06-16T21:35:11.950

各位，请以您所说的版本为准！

比如*VS2008内置的免费RDLC报表*（和SQL Server 2005 Reporting Services一样）**不支持header和footer绑定字段**，这是一个基本特性！

现在我正在将一个巨大的报表从这个 VS2008 Reporting / RDLC 2005 转换为 Crystal Report 2008 Basic（VS2008 附带），因为它没有这个基本功能。

我相信 Reporting Services 2.0 / RDLC 2008（Visual Studio 2010 附带）和更好**的最新 Reporting Services 3.0 / RDLC 2010**（*在 SQL Server 2008 R2 Express 中免费提供高级服务*）是更好的 SSRS 解决方案。

具有高级服务的 SQL Server R2 Express（免费） [http://www.microsoft.com/express/Database/InstallOptions.aspx](http://www.microsoft.com/express/Database/InstallOptions.aspx)

现在我正在为 Reporting Services 3.0 / RDLC 2010 进行概念验证，并将发布结果。

*Reporting Services (SSRS/RDLC) 总是更易于使用，但简单是有代价的。*对于简单报告，请始终选择 SSRS/RDLC。对于具有主从、页面控制等的复杂报表，请使用最新的SSRS/RDLC版本（2008、2010）以及水晶报表对这些场景进行PoC。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-06-16T21:41:19.017

对于那些正在比较旧的 Crystal Reports XI 和 Reporting Service 1.0 的人，请参阅 2005 年的这篇文章：

SQL Server Reporting Services 和 Crystal Reports：竞争分析 [http://www.crystalreportsbook.com/SSRSandCR_Conclusion.asp](http://www.crystalreportsbook.com/SSRSandCR_Conclusion.asp)

# delphi - Delphi中对象的RTTI

> ID：168438
> 
> 赞同：2
> 
> 时间：2008-10-03T19:16:07.900
> 
> 标签：delphi, rtti

我正在尝试在 Delphi 中将对象解析为 XML，因此我阅读了有关调用对象的 ClassInfo 方法以获取其 RTTI 信息的信息。

问题是，这显然只适用于 TPersistent 对象。否则，我必须在源代码中专门添加一个编译器指令 {$M+}，以便编译器生成 RTTI 信息。

所以我很高兴地添加了指令，结果发现，即使它确实从 ClassInfo 调用中返回了一些东西（它曾经返回 nil），现在我无法从中检索类的属性、字段或方法。就像它创建的对象是空的。

知道我在这里想念什么吗？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-03T19:25:03.453

您是否将这些属性和方法放入该`published`部分？

除此之外，“经典”RTTI ($TYPEINFO ON) 只会为您提供有关属性的信息，而不是有关方法的信息。你需要'extended' RTTI ($METHODINFO ON)。

扩展 RTTI 的良好起点：[David Glassborow 谈扩展 RTTI](http://hallvards.blogspot.com/2006/05/david-glassborow-on-extended-rtti.html)

（谁会相信，就在这一分钟，我完成了一些使用扩展 RTTI 的代码并决定浏览一下 Stack Overflow：）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T19:22:43.660

RTTI 只会向您显示**已发布**的属性等。- 不仅仅是公共的。

使用 TObject 尝试您的代码，看看会发生什么 - 如果这不起作用，*请发布您的代码*，因为不是每个人都是通灵者。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-04T05:27:48.540

您是否考虑过使用 TXMLDocument 组件？它将查看您的 XML，然后创建一个很好的 Delphi 类单元来表示您的 XML 文件——使读写 XML 文件变得非常非常容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-16T12:12:51.190

至于只返回 nil 的 RttiType 问题，这可能有一个原因：在您的测试中，您没有在任何时候实例化该类。编译器因为它从来没有对这个类的引用（因为它根本不是一个实例），所以作为一种优化形式，它只是从信息中删除它。请参阅下面的两个示例。当您在代码中的某个位置实例化类时，行为会有所不同。

假设以下类：

```
type
  TTest = class
  public
    procedure Test;
  end; 
```

以及下面的代码：

```
var
  LContext: TRttiContext;
  LType: TRttiType;
  LTest: TTest;
begin
  LContext := TRttiContext.Create;
  for LType in LContext.GetTypes do
  begin
    if LType.IsInstance then
    begin
      WriteLn(LType.Name);
    end;
  end;
end; 
```

到目前为止，RTTI 无法使用 TTest 类信息。但是，当我们在应用程序中创建某个点时，会在编译中为它创建一个引用，从而使这些信息可用：

```
var
  LContext: TRttiContext;
  LType: TRttiType;
  LTest: TTest;
begin
  LTest := TTest.Create; //Here i´m using TTest.
                         //Could be in another part of the program

  LContext := TRttiContext.Create;
  for LType in LContext.GetTypes do
  begin
    if LType.IsInstance then
    begin
      WriteLn(LType.Name);
    end;
  end;
end; 
```

此时，如果您使用**LContext.FindType ('TTest')**，则不会返回 nil，因为编译器保留了对该类的引用。这解释了您在测试中的行为。

# html - 你如何添加一个链接，将一个事件从 safari 添加到你的 iPhone 日历？

> ID：168440
> 
> 赞同：22
> 
> 时间：2008-10-03T19:16:21.253
> 
> 标签：html, iphone, hyperlink, mobile-safari

这似乎应该很简单，但经过几个小时的谷歌搜索，我还没有弄清楚。我知道我可以使用 ICS 文件添加 iCal 链接，但这在 iPhone 上不起作用。

顺便说一句，当我说 iPhone 时，我希望它也能在触控上工作。有人对此有任何运气吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-08-12T21:39:03.067

您可以使用 webcal 协议让 iPhone 下载 .ics 文件（在移动网页上使用 Safari）：

webcal://website.mobi/mymeeting.ics

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-10-14T13:52:13.613

从 iOS 5 开始，如果您创建一个指向 .ics 文件的简单 http 链接，Mobile Safari 将提供在日历中打开它的功能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-03T19:22:16.173

根据 iPhone 文档，日历应用程序没有 URL 方案。（有邮件、电话、地图、YouTube 和 iTunes 的 URL 方案。）

当然可能有一些未记录的东西，但我不确定即使你能找到它，使用它是否是一个好主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T05:18:37.287

当然可以，但前提是您的 JavaScript 应用程序已安装在设备上。查看[http://tetontech.wordpress.com](http://tetontech.wordpress.com)以了解如何从 JavaScript 调用 Objective-C。然后，您可以使用它和 Xcode 文档中的 Calendar Store Programming Guide 来做您想做的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-10T04:49:03.203

这不可能。Apple 不希望您这样做。

现在，您可以做一个 javascript 小书签，检查调用它的浏览器的用户代理，如果用户在其笔记本电脑或台式机 Mac 上使用 Safari，则使用标准方法（ICS 文件）调用 iCal。

iPhone 上的用户可以将您的页面添加到主屏幕书签中，该书签带有一个有用的（也许是自定义的）图标，上面写着“事件”和“在 8:15 与玛丽见面”的标题。然后，当他们同步他们的书签时，他们可以被提醒该事件并在他们的桌面浏览器上调用它。

在教育用户如何使用这个系统方面存在重大障碍，但我认为，如果你能说服人们这样做，它就会起作用。

# post - 你如何发布到 iframe？

> ID：168455
> 
> 赞同：294
> 
> 时间：2008-10-03T19:18:53.700
> 
> 标签：post, iframe

如何将数据发布到 iframe？

* * *

## 回答 #1

> 赞同：438
> 
> 时间：2008-10-03T19:28:18.953

取决于您所说的“发布数据”是什么意思。您可以在标签上使用 HTML`target=""`属性`<form />`，因此它可以很简单：

```
<form action="do_stuff.aspx" method="post" target="my_iframe">
  <input type="submit" value="Do Stuff!">
</form>

<!-- when the form is submitted, the server response will appear in this iframe -->
<iframe name="my_iframe" src="not_submitted_yet.aspx"></iframe> 
```

如果不是这样，或者您想要更复杂的东西，请编辑您的问题以包含更多细节。

Internet Explorer 存在一个已知错误，仅当您使用 Javascript 动态创建 iframe 等时才会出现（这里有一个[变通](https://stackoverflow.com/questions/2181385/ie-issue-submitting-form-to-an-iframe-using-javascript)方法），但如果您使用普通 HTML 标记，那就没问题了。目标属性和框架名称不是什么聪明的忍者技巧；尽管它在 HTML 4 Strict 或 XHTML 1 Strict 中已被弃用（因此不会验证），但它从 3.2 开始就成为 HTML 的一部分，它正式成为 HTML5 的一部分，并且它适用于自 Netscape 3 以来的几乎所有浏览器。

我已经验证了这种行为与 XHTML 1 Strict、XHTML 1 Transitional、HTML 4 Strict 以及在没有指定 DOCTYPE 的“怪癖模式”中一起使用，并且它适用于所有使用 Internet Explorer 7.0.5730.13 的情况。我的测试用例包含两个文件，在 IIS 6 上使用经典 ASP；它们在此处完整复制，因此您可以自己验证此行为。

**默认的.asp**

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC
  "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>Form Iframe Demo</title>
  </head>
  <body>
  <form action="do_stuff.asp" method="post" target="my_frame">
    <input type="text" name="someText" value="Some Text">
    <input type="submit">
  </form>
  <iframe name="my_frame" src="do_stuff.asp">
  </iframe>
  </body>
</html> 
```

**do_stuff.asp**

```
<%@Language="JScript"%><?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC
  "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>Form Iframe Demo</title>
  </head>
  <body>
  <% if (Request.Form.Count) { %>
  You typed: <%=Request.Form("someText").Item%>
  <% } else { %>
  (not submitted)
  <% } %>
  </body>
</html> 
```

我很想听到任何不能正确运行这些示例的浏览器。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-06-21T04:46:15.857

iframe 用于在 html 页面中嵌入另一个文档。

如果要将表单提交到表单页面中的 iframe，则可以使用标记的 target 属性轻松实现。

将表单的 target 属性设置为 iframe 标记的名称。

```
<form action="action" method="post" target="output_frame">
    <!-- input elements here --> 
</form>
<iframe name="output_frame" src="" id="output_frame" width="XX" height="YY">
</iframe> 
```

* * *

**高级 iframe 目标使用**
此属性还可用于产生类似 ajax 的体验，尤其是在文件上传等情况下，在这种情况下，必须提交表单才能上传文件

iframe 可以设置为 0 的宽度和高度，并且可以将目标设置为 iframe 来提交表单，并在提交表单之前打开加载对话框。因此，它模拟了一个 ajax 控件，因为该控件仍然保留在输入表单 jsp 上，同时打开了加载对话框。

示例

```
<script>
$( "#uploadDialog" ).dialog({ autoOpen: false, modal: true, closeOnEscape: false,                 
            open: function(event, ui) { jQuery('.ui-dialog-titlebar-close').hide(); } });

function startUpload()
{            
    $("#uploadDialog").dialog("open");
}

function stopUpload()
{            
    $("#uploadDialog").dialog("close");
}
</script>

<div id="uploadDialog" title="Please Wait!!!">
            <center>
            <img src="/imagePath/loading.gif" width="100" height="100"/>
            <br/>
            Loading Details...
            </center>
 </div>

<FORM  ENCTYPE="multipart/form-data" ACTION="Action" METHOD="POST" target="upload_target" onsubmit="startUpload()"> 
<!-- input file elements here--> 
</FORM>

<iframe id="upload_target" name="upload_target" src="#" style="width:0;height:0;border:0px solid #fff;" onload="stopUpload()">   
        </iframe> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-05-20T19:10:17.760

这个函数创建一个临时表单，然后使用 jQuery 发送数据：

```
function postToIframe(data,url,target){
    $('body').append('<form action="'+url+'" method="post" target="'+target+'" id="postToIframe"></form>');
    $.each(data,function(n,v){
        $('#postToIframe').append('<input type="hidden" name="'+n+'" value="'+v+'" />');
    });
    $('#postToIframe').submit().remove();
} 
```

target 是目标 iFrame 的“名称”属性，data 是一个 JS 对象：

```
data={last_name:'Smith',first_name:'John'} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-31T22:25:29.160

如果您想更改 iframe 中的输入，然后从该 iframe 提交表单，请执行此操作

```
...
var el = document.getElementById('targetFrame');

var doc, frame_win = getIframeWindow(el); // getIframeWindow is defined below

if (frame_win) {
  doc = (window.contentDocument || window.document);
}

if (doc) {
  doc.forms[0].someInputName.value = someValue;
  ...
  doc.forms[0].submit();
}
... 
```

通常，您只能在 iframe 中的页面来自同源时执行此操作，但您可以在调试模式下启动 Chrome 以忽略同源策略并在任何页面上进行测试。

```
function getIframeWindow(iframe_object) {
  var doc;

  if (iframe_object.contentWindow) {
    return iframe_object.contentWindow;
  }

  if (iframe_object.window) {
    return iframe_object.window;
  } 

  if (!doc && iframe_object.contentDocument) {
    doc = iframe_object.contentDocument;
  } 

  if (!doc && iframe_object.document) {
    doc = iframe_object.document;
  }

  if (doc && doc.defaultView) {
   return doc.defaultView;
  }

  if (doc && doc.parentWindow) {
    return doc.parentWindow;
  }

  return undefined;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-05T06:05:32.783

您可以使用此代码，必须添加要传递的正确参数以及获取数据的 api url。

```
var allParams = { xyz, abc }

    var parentElm = document.getElementBy... // your own element where you want to create the iframe

    // create an iframe 
    var addIframe = document.createElement('iframe');
    addIframe.setAttribute('name', 'sample-iframe');
    addIframe.style.height = height ? height : "360px";
    addIframe.style.width = width ? width : "360px";
    parentElm.appendChild(addIframe)

    // make an post request
    var form, input;
    form = document.createElement("form");
    form.action = 'example.com';
    form.method = "post";
    form.target = "sample-iframe";
    Object.keys(allParams).forEach(function (elm) {
        console.log('elm: ', elm, allParams[elm]);
        input = document.createElement("input");
        input.name = elm;
        input.value = allParams[elm];
        input.type = "hidden";
        form.appendChild(input);
    })
    parentElm.appendChild(form);
    form.submit(); 
```

# javascript - JavaScript 属性会在每次调用时计算吗？

> ID：168464
> 
> 赞同：9
> 
> 时间：2008-10-03T19:21:32.320
> 
> 标签：javascript, properties

由于*长度*是一个JavaScript属性，我是否使用它是否重要

```
for( var i = 0; i < myArray.length; i++ ) 
```

或者

```
var myArrayLength = myArray.length;
for( var i = 0; i < myArrayLength ; i++ ) 
```

­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­­

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-03T19:24:22.703

```
for(var i = 0, iLen = myArray.length; i < iLen; i++) 
```

有关各种 Javascript 循环结构的基准，请参阅[http://blogs.oracle.com/greimer/resource/loop-test.html 。](http://blogs.oracle.com/greimer/resource/loop-test.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T19:26:01.453

如果 myArray 是 javascript 数组，那么您不必担心它，它只是一个在对象上查找的属性，但变量使用也是如此。

如果 OTH 长度是由浏览器 DOM（尤其是 IE）提供的集合对象公开的属性，那么它可能会非常昂贵。因此，在枚举这样一个 DOM 提供的集合时，我倾向于使用：-

```
for (var i = 0, length = col.length; i < length; i++) 
```

但对于数组我不打扰。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-05T20:54:35.893

我认为你的问题意图的答案是，是的，如果你修改循环中的数组，array.length 属性会在每次迭代中重新计算。例如，下面的代码：

```
var arr = [1,2,3];
for(var i = 0; i < arr.length; i++){
  console.debug("i = " + i);
  console.debug("indexed value = " + arr[i])
  arr.pop();
} 
```

将输出：

```
i = 0
indexed value = 1
i = 1
indexed value = 2 
```

而这段代码：

```
var arr = [1,2,3];
var l = arr.length;
for(var i = 0; i < l; i++){
  console.debug("i = " + i);
  console.debug("indexed value = " + arr[i])
  arr.pop();
} 
```

将输出：

```
i = 0
indexed value = 1
i = 1
indexed value = 2
i = 2
indexed value = undefined 
```

-J

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T19:30:06.937

不，它不会在通话时重新计算。它在 Array 类中根据需要重新计算。

当您使用**push**、**pop**、**shift**、**unshift**、**concat**、**splice**等时，它会发生变化。否则，它只是一个 Number ——每次调用它的值时都是同一个实例。

但是，只要您不显式覆盖它（**array.length = 0**），每次调用都会准确。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T22:05:15.110

不会在每次调用时计算长度属性，但后一个版本会更快，因为您正在缓存属性查找。即使是最新的 JS 实现（V8、TraceMonkey、SquirrelFish Extreme），它们使用高级（例如 SmallTalk 时代；））属性缓存，属性查找仍然比您的第二个版本多出至少一个额外的条件分支。

Array.length 不是恒定的，但是因为 JS 数组是可变的，所以`push, pop, array[array.length]=0, etc`可能都会改变它。

还有其他一些概念，例如`NodeList`您从调用中获得的 DOM `document.getElementsBySelector`，它们预计将是实时的，在这种情况下，长度可能会在您迭代时重新计算。但是，如果确实重新计算了长度，那么它很有可能实际上也会发生变化，因此手动缓存输出可能无效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T19:32:00.693

虽然第二种形式可能更快：

```
function p(f) { var d1=new Date(); for(var i=0;i<20;i++) f(); print(new Date()-d1) }
p(function(){for(var i=0;i<1000000; i++) ;})
p(function(){var a = new Array(1000000); for(var i=0;i<a.length; i++) ;})
> 823
> 1283 
```

..在任何非边缘情况下都应该无关紧要。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T22:27:12.430

根据[ECMAScript 规范](https://stackoverflow.com/users/15031/jonathan-lonowski)，它只是说明应该**如何**计算“长度”属性，但没有说明**何时**。我认为这可能取决于实现。

如果我要实现它，我会按照[乔纳森](https://stackoverflow.com/questions/168464/do-javascript-properties-calculate-on-each-call#168497)指出的那样做，但如果是 Array 对象的“长度”属性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-05T20:35:07.040

如果您曾经想过它可能会在循环期间发生变化，那么当然应该检查每个循环...

-- 否则多次询问一个对象显然是疯了，如果你把它放在 if 语句的评估属性中......

```
if(i=0, iMax=object.length; iMax>i; i++) 
```

-- 只有在特殊情况下你才应该考虑不这样做！-)

# asp.net-mvc - ASP.Net MVC Routing 和新的 ASP.Net DynamicData Site 路由有什么区别？

> ID：168481
> 
> 赞同：0
> 
> 时间：2008-10-03T19:26:10.347
> 
> 标签：asp.net-mvc, visual-studio-2008, .net-3.5, asp.net-dynamic-data

我才开始使用 ASP.Net MVC 和新的 VS2008 动态数据网站模板。我注意到他们在处理 URL 时都使用了路由，我知道由于路由，ASP.Net MVC 在 IIS6 下无法工作。但是，我的 DynamicData 站点在 IIS6 上运行良好。

由于 IIS7 的要求，我不得不暂时放弃对 ASP.Net MVC 的探索，以进行即将到来的项目，我想知道两者之间的本质区别是什么，即是什么让 DynamicData 站点在 IIS6 上工作和MVC不行吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-04T09:44:48.850

只要您[启用到 ASP.NET 的通配符映射](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx?mfr=true)， ASP.NET MVC 确实可以在[IIS6](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx?mfr=true) （和 IIS5 下）工作。我已经使用 IIS6 将 MVC 应用程序部署到生产环境，所以我可以保证这是可能的。

关键区别在于 DynamicData 中的所有 URL 都以带有 ASPX 扩展名的文件结尾，因此，无论物理是否存在，都会调用 ASP.NET 运行时（因为 ASPX 与 ASP.NET 相关联），而大多数 ASP.NET MVC 请求没有扩展（或有 MVC 扩展，默认情况下未映射），因此需要 IIS 配置才能工作。

IIS7 自动工作，因为 IIS7 本身是受管理的，因此 IIS/ASP.NET 之间没有分离。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-06T08:20:47.880

它们都在 IIS6 上开箱即用，无需修改 IIS6。您只需要使用一些映射到 asp.net isapi 的扩展名，例如 .aspx、.ashx 或类似的。
此外，ASP.NET MVC 在 IIS6 上运行没有问题！我在 IIS6 上运行它，将 .html 扩展名映射到 asp.net isapi！
一些共享主机提供商愿意对 IIS6 进行更改以支持无扩展 url。如果他们不想这样做，您可以要求他们将 .html 映射到 asp.net，网址很好，并且对 seo 友好。顺便提一下；google 不会介意你有 .aspx 或 .html，就像没有扩展名一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T14:20:39.743

ASP.Net MVC 和 Dynamic Data 使用 System.Web.Routing 中包含的相同路由引擎，因此它们都在 IIS6 下工作。问题在于将请求映射到 ASP.Net（如@Richard Szalay 所述）。如果使用通配符映射，如果 .mvc 扩展名映射到 ASP.Net，或者如果另一个文件扩展名已经映射到 ASP.Net（.aspx、.ashx、.axd 等），则 MVC 将在 IIS6 下正常工作在您的 MVC 路由中使用。

# database - 小心使用实时数据库的#1 方法是什么？

> ID：168486
> 
> 赞同：80
> 
> 时间：2008-10-03T19:27:51.340
> 
> 标签：database

对于我的客户，我偶尔会在他们的实时数据库中工作，以解决他们为自己创建的问题，或者修复我的产品错误造成的不良数据。就像 Unix root 访问一样，这很危险。我应该提前学习哪些课程？

对实时数据进行操作时要小心操作的第一件事是什么？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2008-10-03T19:34:15.820

```
BEGIN TRANSACTION; 
```

这样你就可以在出错后回滚。

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2008-10-03T19:38:03.083

多年来，我通过艰难的方式学到了三件事……

首先，如果您要对实时数据进行更新或删除，请首先使用您将使用的 WHERE 子句编写一个 SELECT 查询。确保它有效。确保它是正确的。然后将 UPDATE/DELETE 语句添加到已知的工作 WHERE 子句。

你永远不想拥有

```
DELETE FROM Customers 
```

坐在您的查询分析器中等待您编写 WHERE 子句...不小心点击“执行”，您刚刚杀死了您的客户表。哎呀。

此外，根据您的平台，了解如何快速备份表。在 SQL Server 2005 中，

```
SELECT *
INTO CustomerBackup200810032034
FROM Customer 
```

会将整个 Customer 表中的每一行复制到一个名为 CustomerBackup200810032034 的新表中，然后您可以在完成更新并确保一切正常后将其删除。如果发生最坏的情况，从该表中恢复丢失的数据比尝试从磁盘或磁带恢复昨晚的备份要容易得多。

最后，小心级联删除删除您不打算删除的内容 - 在修改任何内容之前检查表的关系和键约束。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2008-10-03T19:31:27.853

首先做一个备份：无论如何它应该是系统管理的第一法则

**编辑**：结合其他人所说的，确保您的更新具有适当的 WHERE 子句。

理想情况下，永远不应该更改实时数据库（除了插入和基本维护）。更改实时数据库的结构尤其充满了潜在的不良业力。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-10-03T19:29:55.407

对副本进行更改，当您满意时，将修复应用到实时状态。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2008-10-03T19:35:18.313

通常在执行 UPDATE 或 DELETE 之前，我会编写等效的 SELECT。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2008-10-03T19:35:05.413

除非您在 BEGIN TRAN t1 中，否则切勿进行更新——不在开发数据库中，不在生产中，不在任何地方。永远不要在评论之外运行 COMMIT TRAN t1——总是输入

```
--COMMIT TRAN t1 
```

然后选择语句以运行它。（显然，这仅适用于 GUI 查询客户端。）如果您执行这些操作，那么执行这些操作将成为第二天性，您几乎不会浪费任何时间。

我实际上有一个“更新”宏来输入这个。我总是把它粘贴进去来设置我的更新。您可以为删除和插入制作类似的。

```
begin tran t1
update 
set 
where 
rollback tran t1
--commit tran t1 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-10-03T19:30:06.720

始终确保您的 UPDATE 和 DELETE 具有正确的 WHERE 子句。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2008-10-03T19:34:35.507

回答我自己的问题：

写更新语句时，乱写。

1.  写`UPDATE [table-name]`
2.  写`WHERE [conditions]`
3.  回去写`SET [columns-and-values]`

在说出要更改的值之前选择要更新的行比按其他顺序执行要安全得多。它使您不可能`update person set email = 'bob@bob.com'`坐在查询窗口中，准备好被错误的击键运行，准备好弄乱表中的每一行。

编辑：正如其他人所说，`WHERE`在你写之前为你的删除写子句`DELETE`。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2008-10-03T19:52:25.253

例如，我这样创建 SQL

```
--Update P Set
--Select ID, Name as OldName, 
    Name='Jones'
From Person P
Where ID = 1000 
```

我突出显示从末尾到 Select 的文本并运行该 SQL。一旦我确认它正在提取我想要更新的记录，我点击 shift-up 以突出显示 Update 语句并运行它。

请注意，我使用了别名。我从不明确更新表名。我总是使用别名。

如果我结合事务和回滚/提交来执行此操作，我真的非常安全。

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2008-10-03T20:37:34.023

我要小心使用实时数据库的#1 方法？不要碰它。:)

备份可以消除您对数据库造成的损害，但您仍然可能在这段时间内引入负面影响。

无论您认为您正在使用的脚本有多可靠，都要通过一个测试周期来运行它。即使“测试周期”意味着针对您自己的数据库实例运行脚本，请确保您这样做。在本地机器上引入缺陷比在生产环境中引入缺陷要好得多。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-10-03T19:35:31.280

1.  检查、重新检查并再次检查任何正在更新的语句。即使你认为你只是在做一个简单的单列更新，迟早你会没有足够的咖啡并忘记一个'where'子句，从而破坏整个表。

我发现其他几件事很有帮助：

*   如果使用 MySQL，请启用[安全更新](http://dev.mysql.com/doc/refman/5.0/en/mysql-tips.html#safe-updates)

*   如果您有 DBA，请让他们这样做。

我发现这 3 件事使我没有造成任何严重的伤害。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-10-03T19:39:37.277

*   **没有人想要备份，但每个人都在呼唤恢复**
*   使用外键引用创建数据库，因为您应该：
*   让自己尽可能难以更新/删除数据并破坏结构完整性/其他东西
*   如果可能，请在您必须在永久存储更改之前提交更改的系统上运行（即在修复数据库时停用自动提交）
*   尝试确定问题的类别，以便了解如何轻松解决问题
*   例行备份数据库
*   因为请记住：**如果某件事完全失败，您需要尽快重新启动并运行**

嗯，这就是我现在能想到的。采取大胆的段落，你会看到我的第一件事。;-)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-03T19:32:43.517

也许考虑根本不使用任何删除或删除。或者可能减少用户权限，以便只有特殊的数据库用户可以删除/删除东西。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-03T19:33:43.483

如果您使用的是 Oracle 或其他支持它的数据库，请在执行 COMMIT 之前验证您的更改。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-03T20:24:29.340

数据应始终通过脚本进行部署，以便在开发中正确执行所需的次数。当有依赖数据让脚本在 dev 上正确运行时，适当地暂存它——如果你真的想小心的话，你不能逃避这一步。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-10-03T21:07:39.907

检查两次，提交一次！

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-03T19:31:11.367

在开始之前备份或转储数据库。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-10-03T19:31:22.020

要补充[@Wayne](https://stackoverflow.com/questions/168486/whats-your-1-way-to-be-careful-with-a-live-database#168496)所说的内容，请在or语句`WHERE`中的表名之前写下您的内容。`DELETE``UPDATE`

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-10-03T19:31:41.443

备份您的数据。了解到这是定期与客户数据库打交道的艰难方法。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-10-03T19:32:55.153

始终添加 using 子句。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-10-03T20:38:59.200

我的规则（作为应用程序开发人员）：不要碰它！这就是训练有素的 DBA 的用途。哎呀，我什至不想允许触摸它。:)

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2008-10-04T15:58:21.870

每个环境有不同的颜色：我们已经设置了我们的 PL\SQL 开发人员（IDE for Oracle），这样当您登录到生产数据库时，所有的窗口都是鲜红色的。有些人甚至为开发和测试分配了不同的颜色。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-10-03T19:30:12.273

确保在删除记录时指定 where 子句。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-10-03T19:30:52.363

始终首先在开发数据上测试除 select 之外的任何查询，以确保它具有正确的影响。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-10-03T20:34:19.303

1.  如果可能，请与某人配对
2.  在按 Enter 之前总是数到 3（如果是单独的，因为这会激怒你的搭档！）

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-10-03T21:25:06.753

如果我使用脚本更新数据库，我总是确保在脚本的开头放置一个或两个断点，以防我意外运行/执行。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2008-10-03T23:15:30.447

我会在你的 UPDATE 之前添加 BEGIN TRAN 的建议，只是不要忘记实际执行 COMMIT；如果您将未提交的交易保持打开状态，您可能会造成同样多的损失。在更新过程中不要被电话、同事、午餐等分心，否则你会发现其他人都被锁定，直到你提交或回滚。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2008-10-04T01:28:58.773

在查询分析器中写出即席查询时，我总是注释掉任何破坏性查询（插入、更新、删除、删除、更改）。这样，运行它们的唯一方法是突出显示它们，而不选择注释部分，然后按 F5。

正如已经提到的，我也认为这是一个好主意，首先使用 select 编写 where 语句，并确保您正在更改正确的数据。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2008-10-04T08:08:56.937

1.  在更改之前始终备份。
2.  始终通过脚本制作模组（例如 ALTER TABLE）。
3.  始终通过存储过程修改数据（例如 DELETE）。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2008-10-04T15:42:42.543

创建一个只读用户（或让 DBA 来做）并只使用该用户查看数据库。为架构添加适当的权限，以便您可以查看存储过程/视图/触发器/等的内容。但没有能力改变它们。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2008-10-27T16:43:26.603

运行无意删除（或插入或更新）的危险始终在我脑海中。

我总是在它们后面加上“where 1=2”，直到我准备好扣动扳机。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2009-05-20T23:13:30.037

我在一次采访中了解到这一点，并认为这是一个好主意。

```
Begin Transaction
    Delete from foo where FooID = 100
IF @@RowCount <> 1 Begin
    Rollback Transaction
End 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2009-09-09T01:48:09.937

永远不要设计任何带有级联删除的数据库。他们是邪恶的。如果您确实在 FK 上进行了级联删除，那么当您使用 delete 语句删除一行时，您永远不知道将删除其他引用表中的多少行。

也就是说，你不能假设其他人的所作所为。我总是这样做： 1\. 将数据库复制到本地安装的数据库（使用转储）。如果您在本地计算机上无法拥有完整数据库的副本，只需告诉管理层您拒绝工作。2\. 让您的脚本在本地数据库上运行，一遍又一遍地导入转储，直到脚本在干净导入的转储上完美运行。然后将脚本保存到磁盘上的文件中。3\. 在生产服务器上运行脚本。4\. 将脚本导入单片机。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2008-10-03T19:35:13.417

**确保您的查询具有指定的`WHERE`参数**

我曾经在一次复杂的更新中途，分心，并提前完成了查询，忘记了“where”子句。然后我有种下沉的感觉，看着半秒的查询隆隆作响了 3.. 之后花几个小时清理客户数据真是上了一课！

结果是现在当我在实时数据库上工作时，我将查询构造为：

```
UPDATE my_table WHERE condition = true; 
```

然后返回并放入列等进行更新。需要更长的时间来写，但*大大*减少了我再次犯同样错误的机会！

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2008-10-03T19:36:39.543

首先在开发环境中进行完全相同的更新，以确保其正常工作。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-10-03T19:51:22.633

如果支持，请在数据库 IDE 中关闭 AutoCommit。我一直在 Oracle SQL Developer 中关闭它。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2008-10-03T19:57:58.817

我没有看到但我经常做的一个快速的额外操作是：备份您正在更新的表。我通过拥有一个数据库来保存这些备份来做到这一点。然后我可以写：

```
select *
  into MyBackupDb..PeterTableName2008_09_28BeforeABigUpdate 
```

这使得从错误中恢复的速度更快（当完全恢复不切实际时）。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2008-10-03T23:04:01.810

1 - 当您知道需要更新或插入记录时，请务必在打开连接之前创建备份。

2 - 编写更新语句时，始终先写入 WHERE 子句，然后将光标返回到行首并写入字段更新部分。

3 - 应使用 select 语句检查 #2 的 where 语句。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2008-10-04T00:33:28.260

去购买[Apex SQL 日志](http://www.apexsql.com/sql_tools_log.asp)。如果您意识到自己真的搞砸了，或者即使是其他人，您也可以使用日志来撤消更改。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2008-10-04T12:03:09.273

针对备份开发 - 确保您要应用的更改/修复来自脚本。处理实时数据时，胖而笨拙的手指无处可去。如果可以，请等待维护窗口应用，如果可以，请回滚。

如果您迫不及待地在快照、备份后立即应用，请确保每个人都了解在前一个快照和应用“修复”的时间之间的更改可能涉及多少工作，如果它不起作用。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2008-10-04T15:59:41.807

使用与任何类型的代码更改相同的过程来进行质量检查，甚至是简单的 SQL 数据修复。我们的包括致力于 CVS，拥有并执行了书面测试计划，进行代码审查和变更控制流程（管理的各个成员和高级运营工程师审查并签署变更）。

我们对所有正常的 SQL 数据修复执行此操作，甚至是简单的修复——唯一的例外是当需要立即修复生产中的主要问题时（例如阻止所有客户登录）——在这种情况下，我们确保有尽可能多地注视工作（通常 3-4 人围着一个工作站，所有人都可以否决任何行动）。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2008-10-04T16:56:02.393

除了在进行任何破坏性更改之前备份数据库之外，有时我发现另一个有用的技巧是，如果我知道我希望通过我所做的任何事情更改的确切记录数，然后添加一个限制子句：

从 id = 5 限制 1 的客户中删除；

“id”可能是一个唯一的索引，我知道只有一行会匹配我的 where 子句，但限制是额外的一层防止意外删除错误数据。我已经养成了先输入这部分的习惯，希望能进一步防止意外击键。我从“删除限制 1”开始，然后返回并添加其他内容。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2008-10-04T19:29:10.027

如果您使用 SQL Server 2005 及更高版本，您可以创建一个数据库快照，允许您及时回滚对快照点所做的任何更改。

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2008-10-06T18:25:11.997

当只更新/删除一条记录时，mysql 允许您将“LIMIT 1”放在最后，因此即使 WHEN 子句错误，也只有一条记录被损坏。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2008-10-06T19:10:43.213

我经常不得不在现场生产站点上插入、更新或删除数据（作为数据分析师，这可能是我工作的 40%）。大多数时候是通过自动化的 DTS 或 SSIS 包。但是，当发生重大客户驱动的变化（例如重组销售人员）时，我们也是必须修复问题记录或更新生产的人。有时问题是由于代码中的错误引起的，但通常是由于客户端对他们的文件做了奇怪的事情，或者用户为了节省我们修复问题的时间而设法搞砸的事情，或者因为他们想规避正常情况仅此一个快速简单更改的过程！（用户注意 - 请不要尝试手动修复通常通过自动化过程完成的事情，您不知道该过程可能还在做什么！！！！！！）所以有时我们不

我的规则：永远不要将数据直接从文件插入到生产表中。始终将其放入工作台，以便您首先查看。进行检查，以便如果文件中存在错误数据，则该过程将在您进入插入生产数据的最后一步之前失败。首先清理数据。

如果您必须删除大量记录，如果您先将这些记录选择到工作表中，它可以节省您的时间。然后进行删除。这样，如果出现问题，恢复起来会容易得多。如果您有审计表，请知道如何快速从中恢复数据。同样，如果出现问题，从审计表中恢复比从磁带备份中恢复要快得多。

我写了一个这样的删除语句：

开始翻译

删除一个

--select（列出要在此处查看的重要字段）

从表 1 a where field1 = 'x'

--rollback 传输

--commit 传输

请注意有关此的几件事。首先，通过使用别名，我不会通过仅突出显示一行并运行代码而意外删除整个表。通过在与表格相同的行上开始 where 子句，我不太可能错过突出显示它。如果我有连接，我会确保每一行都在代码无法工作的地方结束，除非它进入下一行。同样，这可以确保您得到错误而不是 oopsie。始终先运行 select 并注意受影响的记录数（并查看数据以确保它看起来像正确的记录！）然后不要提交，除非在运行实际删除时记录数是正确的。是的，在单独的行上开始 where 更漂亮，结束删除的每一行更安全，这样它就不会运行，除非整个查询被突出显示。

更新遵循类似的规则。

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2008-10-30T19:01:48.130

如果您使用的是 oracle 10/11g... 闪回

[http://www.oracle.com/technology/deploy/availability/htdocs/Flashback_Overview.htm](http://www.oracle.com/technology/deploy/availability/htdocs/Flashback_Overview.htm)

它基本上维护了一个可以通过时间或命名标记引用的撤消日志的滑动窗口。在几分钟内撤消几天的更改变得非常简单。无需关闭数据库。

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2008-12-10T19:17:21.413

让 DBA 完成工作。来自开发背景，我不希望/不需要/不应该访问任何人的实时数据库。对我来说，这相当于让 DBA 修复 DAL 中的编码问题，因为它的标题中有“数据库”。:-)

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2009-04-02T16:55:17.787

如果您使用的是 SQL Server 2005+ Management Studio，则可以打开隐式事务。

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2009-04-20T03:45:05.090

1.  每当我连接到实时数据库时，我总是喜欢有人看着我。

2.  将生产数据库的最新副本存储在某处。这通常会排除您查询生产数据库的需要。

3.  如果您必须对正在运行的数据库做任何事情。记录它，并将修复添加为管理员可用的编码功能。这样，您就少了一个借口来将查询工具指向您的数据库。

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2009-06-15T05:37:57.740

每当我打开与 PROD 的连接或切换到 PROD 数据上下文时，我总是做的第一件事是在我的活动工作代码块之前和之后添加此注释：

```
-- PROD -- PROD -- PROD -- PROD -- PROD -- PROD -- 
```

有时候，当我的拇指在 Alt 键上，而我的中指在“X”键的一半时，我注意到了这一点。哇！

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2009-07-23T20:15:00.747

如果您使用的是 Microsoft SQL Server Management Studio **2008**，您可以指定在执行查询时在信息窗口中使用哪种颜色（在 Sql 查询编辑器的底部）

在 Connection Promt 上，选择 Options > Use Custom Color 并选择 RED 进行生产。

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2009-12-28T20:58:39.947

在开始弄乱数据之前备份数据，就像其他任何事情一样。

# web-services - 来自 ColdFusion 8 的未经授权的 Sharepoint WSDL

> ID：168487
> 
> 赞同：3
> 
> 时间：2008-10-03T19:28:12.667
> 
> 标签：web-services, sharepoint, iis, authentication, coldfusion

如何解决错误：

> 无法从 URL 读取 WSDL：[https](https://workflowtest.site.edu/_vti_bin/Lists.asmx?WSDL) ://workflowtest.site.edu/_vti_bin/Lists.asmx?WSDL 。
> 错误：401 未经授权。

我可以使用相同的用户帐户从浏览器中成功查看 WSDL。我不确定正在使用哪种身份验证（基本或集成）。

我怎么会发现呢？

拨打电话的代码是：

```
<cfinvoke 
  username="username" 
  password="password"
  webservice="https://workflowtest.liberty.edu/_vti_bin/Lists.asmx?WSDL" 
  method="GetList" 
  listName="{CB02EB71-392E-4906-B512-8EC002F72436}"
> 
```

我得到的印象是 ColdFusion 不喜欢通过身份验证来获取 WSDL。

完整的堆栈跟踪：

```
coldfusion.xml.rpc.XmlRpcServiceImpl$CantFindWSDLException: Unable to read WSDL from URL: https://workflowtest.liberty.edu/_vti_bin/Lists.asmx?WSDL.
  at coldfusion.xml.rpc.XmlRpcServiceImpl.retrieveWSDL(XmlRpcServiceImpl.java:709)
  at coldfusion.xml.rpc.XmlRpcServiceImpl.access$000(XmlRpcServiceImpl.java:53)
  at coldfusion.xml.rpc.XmlRpcServiceImpl$1.run(XmlRpcServiceImpl.java:239)
  at java.security.AccessController.doPrivileged(Native Method)
  at coldfusion.xml.rpc.XmlRpcServiceImpl.registerWebService(XmlRpcServiceImpl.java:232)
  at coldfusion.xml.rpc.XmlRpcServiceImpl.getWebService(XmlRpcServiceImpl.java:496)
  at coldfusion.xml.rpc.XmlRpcServiceImpl.getWebServiceProxy(XmlRpcServiceImpl.java:450)
  at coldfusion.tagext.lang.InvokeTag.doEndTag(InvokeTag.java:413)
  at coldfusion.runtime.CfJspPage._emptyTcfTag(CfJspPage.java:2662)
  at cftonytest2ecfm1787185330.runPage(/var/www/webroot/tonytest.cfm:16)
  at coldfusion.runtime.CfJspPage.invoke(CfJspPage.java:196)
  at coldfusion.tagext.lang.IncludeTag.doStartTag(IncludeTag.java:370)
  at coldfusion.filter.CfincludeFilter.invoke(CfincludeFilter.java:65)
  at coldfusion.filter.ApplicationFilter.invoke(ApplicationFilter.java:279)
  at coldfusion.filter.RequestMonitorFilter.invoke(RequestMonitorFilter.java:48)
  at coldfusion.filter.MonitoringFilter.invoke(MonitoringFilter.java:40)
  at coldfusion.filter.PathFilter.invoke(PathFilter.java:86)
  at coldfusion.filter.ExceptionFilter.invoke(ExceptionFilter.java:70)
  at coldfusion.filter.BrowserDebugFilter.invoke(BrowserDebugFilter.java:74)
  at coldfusion.filter.ClientScopePersistenceFilter.invoke(ClientScopePersistenceFilter.java:28)
  at coldfusion.filter.BrowserFilter.invoke(BrowserFilter.java:38)
  at coldfusion.filter.NoCacheFilter.invoke(NoCacheFilter.java:46)
  at coldfusion.filter.GlobalsFilter.invoke(GlobalsFilter.java:38)
  at coldfusion.filter.DatasourceFilter.invoke(DatasourceFilter.java:22)
  at coldfusion.CfmServlet.service(CfmServlet.java:175)
  at coldfusion.bootstrap.BootstrapServlet.service(BootstrapServlet.java:89)
  at jrun.servlet.FilterChain.doFilter(FilterChain.java:86)
  at coldfusion.monitor.event.MonitoringServletFilter.doFilter(MonitoringServletFilter.java:42)
  at coldfusion.bootstrap.BootstrapFilter.doFilter(BootstrapFilter.java:46)
  at jrun.servlet.FilterChain.doFilter(FilterChain.java:94)
  at jrun.servlet.FilterChain.service(FilterChain.java:101)
  at jrun.servlet.ServletInvoker.invoke(ServletInvoker.java:106)
  at jrun.servlet.JRunInvokerChain.invokeNext(JRunInvokerChain.java:42)
  at jrun.servlet.JRunRequestDispatcher.invoke(JRunRequestDispatcher.java:286)
  at jrun.servlet.ServletEngineService.dispatch(ServletEngineService.java:543)
  at jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService.java:203)
  at jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320)
  at jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428)
  at jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266)
  at jrunx.scheduler.WorkerThread.run(WorkerThread.java:66) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T12:59:17.893

CFInvoke 只能通过基本认证，不能通过 windows 集成认证。

Sharepoint 将无法降级到基本身份验证，因为 sharepoint 需要知道谁在调用服务来检查所请求数据的身份验证和授权。

您最好的选择是创建一个您可以使用 CFInvoke 调用的 asp.net 代理服务，它将模拟您调用 sharepoint Web 服务所需的 Windows 身份验证。

另一种选择是创建一个 C# com 对象，当您从 CF 调用 C# com 对象时，它会进行经过身份验证的调用并将信息传递回 CF。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T16:46:05.443

cfsilence.com 上的这篇博文可能会有所帮助。[ColdFusion/Sharepoint 集成 - 第 1 部分 - 身份验证](http://cfsilence.com/blog/client/index.cfm/2008/3/17/ColdFusionSharepoint-Integration--Part-1--Authenticating)

它归结为：

*   ColdFusion 使用 Apache Axis Web 服务库
*   默认情况下，这个库只能做基本的 HTTP 身份验证
*   您可以将 Axis 配置为使用替代 HTTP 客户端库（Jakarta Commons）
*   这个可以做 NTLM 认证，不​​需要改变代码或 IIS 认证方案
*   重新启动 ColdFusion 后，您应该一切顺利

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T20:43:19.143

我对 ColdFusion 一无所知，但我的第一个怀疑是一个简单的权限问题，而不是任何特定于 CF 的问题。

该 CF 调用是使用基本身份验证还是集成身份验证？IIS 是否匹配？您可以使用 IE/Firefox 和相同的用户帐户浏览到 WSDL 吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-17T16:10:11.990

这是 darpy 和 Ryan 建议的权限错误，最简单的方法是授予 ColdFusion 正确的权限。在 Windows 上，ColdFusion 默认并作为本地系统帐户运行。您可以通过更新 ColdFusion 的 Windows 服务的登录属性来更改它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T14:04:25.060

我有同样的问题。

打开 IIS，然后将 LoginType 更改为 Basic。（在我的德语 Windows 中是：“Verzeichnissicherheit”->“Steuerung des Anonymen Zugriffs und der Authentifizierung”->“Bearbeiten”-> 设置“Standardauthentifizierung”复选框）

-凯文

# .net - 软盘 Win32_LogicalDisk 失败

> ID：168523
> 
> 赞同：0
> 
> 时间：2008-10-03T19:33:20.673
> 
> 标签：.net, wmi

使用 Bob King 的想法，我编写了以下方法。

它适用于 CD、可移动驱动器、常规驱动器。

但是对于软盘，它总是返回“不可用”。有任何想法吗？

```
public static void TestFloppy( char driveLetter ) {
    using( var searcher = new ManagementObjectSearcher(  @"SELECT * FROM Win32_LogicalDisk WHERE DeviceID = '" + driveLetter + ":'" ) )
    using( var logicalDisks = searcher.Get() ) {
        foreach( ManagementObject logicalDisk in logicalDisks ) {  
          var fs = logicalDisk[ "FreeSpace" ];
            Console.WriteLine( "FreeSpace = " + ( fs ?? "Not Available" ) );
            logicalDisk.Dispose();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T20:45:31.217

很抱歉我没有更好的答案，但我曾经做过同样的事情（使用 ManagementObjectSearcher），发现每次代码运行时软盘驱动器都会执行某种查找/初始化序列。

因此，我改为以下内容并进行交互：

```
ManagementClass comp = new ManagementClass(scope, new ManagementPath(obj), null);
comp.Get();
objs = comp.GetInstances(); 
```

我想说这是 WMI 中的一个已知错误，但不幸的是代码注释没有留下任何提示:(

# .net - 在非托管代码中处理托管委托

> ID：168528
> 
> 赞同：4
> 
> 时间：2008-10-03T19:33:49.287
> 
> 标签：.net, c++, callback, managed-c++

我知道我可以让它在技术上工作，但我想实施最干净的解决方案。情况如下：

我有一个托管库，它包装了一个非托管 C 风格的库。我目前包装的 C 风格库功能会进行一些涉及字符串列表的处理。库的客户端代码可以提供一个委托，这样在列表处理过程中，如果遇到“无效”的场景，库可以通过这个委托回调给客户端，让他们选择使用的策略（抛出异常，替换无效字符等）

理想情况下，我希望将所有托管 C++ 隔离在一个函数中，然后能够调用一个单独的函数，该函数只接受非托管参数，以便所有本机 C++ 和非托管代码在这一点上被隔离。为这个非托管代码提供回调机制被证明是我的症结所在。

```
 #pragma managed
public delegate string InvalidStringFilter(int lineNumber, string text);
...
public IList<Result> DoListProcessing(IList<string> listToProcess, InvalidStringFilter filter)
{
  // Managed code goes here, translate parameters etc.
}

#pragma unmanaged
// This should be the only function that actually touches the C-library directly
std::vector<NativeResult> ProcessList(std::vector<char*> list, ?? callback); 
```

在这个片段中，我想在 ProcessList 中保留所有 C 库访问，但是在处理过程中，它需要做回调，并且这个回调以 InvalidStringFilter 委托的形式提供，该委托是从一些客户端传入的我的托管图书馆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T19:50:49.627

如果声明正确，.NET 可以将委托自动转换为指向函数的指针。有两个警告

1.  C 函数必须建立 STDCALL
2.  指向函数的指针不计为对对象的引用，因此您必须安排保留引用，以免底层对象被垃圾收集

[http://www.codeproject.com/KB/mcpp/FuncPtrDelegate.aspx?display=Print](http://www.codeproject.com/KB/mcpp/FuncPtrDelegate.aspx?display=Print)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T19:52:15.707

如果我正确理解问题，您需要在 C++/CLI 程序集中声明一个非托管回调函数，作为 C 库和托管委托之间的桥梁。

```
 #pragma managed
public delegate string InvalidStringFilter(int lineNumber, string text);

...
static InvalidStringFilter sFilter;

public IList<Result> DoListProcessing(IList<string> listToProcess, InvalidStringFilter filter)
{
  // Managed code goes here, translate parameters etc.
  SFilter = filter;
}

#pragma unmanaged

void StringCallback(???)
{
  sFilter(????);
}

// This should be the only function that actually touches the C-library directly
std::vector<NativeResult> ProcessList(std::vector<char*> list, StringCallback); 
```

正如所写的，这段代码显然不是线程安全的。如果您需要线程安全，则需要一些其他机制来在回调中查找正确的托管委托，或者是 ThreadStatic，或者回调可能会传递给您可以使用的用户提供的变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T12:18:12.120

你想做这样的事情：

```
typedef void (__stdcall *w_InvalidStringFilter) (int lineNumber, string message);

GCHandle handle = GCHandle::Alloc(InvalidStringFilter);
w_InvalidStringFilter callback = 
  static_cast<w_InvalidStringFilter>(
    Marshal::GetFunctionPointerForDelegate(InvalidStringFilter).ToPointer()
  );

std::vector<NativeResult> res = ProcessList(list, callback); 
```

# perl - 哪里有一些学习 Perl 5.10 新特性的好资源？

> ID：168530
> 
> 赞同：14
> 
> 时间：2008-10-03T19:34:17.053
> 
> 标签：perl, perl5.10

直到最近我才意识到 Perl 5.10 有重要的新特性，我想知道是否有人可以给我一些很好的资源来学习这些特性。我在谷歌上搜索了它们，我发现的只是一些幻灯片和一个快速概述。如果有更多的解释，某些功能（至少对我而言）会很好。

任何链接将不胜感激。

-fREW

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-03T19:40:03.890

[perldelta](http://search.cpan.org/dist/perl-5.10.0/pod/perl5100delta.pod)联机帮助页包含所有细节。有一个简短（但内容丰富）的幻灯片演示，[Perl 5.10 适合那些不完全疯狂的人](http://www.slideshare.net/rjbs/perl-510-for-people-who-arent-totally-insane/)。以及关于这个问题的一个很好的[PerlMonks 讨论](http://www.perlmonks.org/?node_id=654042)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-03T19:52:18.750

我发现这篇[文章](http://use.perl.org/articles/07/12/26/1628211.shtml)很有用。

这个更侧重于 5.10 高级正则表达式[。](http://www.regex-engineer.org/slides/perl510_regex.html)

还有[A 初学者 Perl 5.10 简介](http://www.perl.com/pub/a/2008/04/23/a-beginners-introduction-to-perl-510.html)。

最后，这篇关于为什么应该开始使用 Perl 5.10 的精彩[总结，我从中提取了以下内容：](http://www.perlmonks.org/?node_id=654086)

*   状态变量 没有更多带有外部卷曲块的范围变量，或者顽皮的 my $f if 0 技巧（后者现在是语法错误）。
*   已定义或不再有 $x = 已定义 $y ？$y : $z，你可以改为 $x = $y // $z。
*   正则表达式改进 dave_the_m 做了很多工作来清理内部，这为 demerphq 添加各种新的酷东西铺平了道路。
*   较小的变量足迹 Nicholas Clark 致力于 SV、AV、HV 和其他数据结构的实现，以将它们的大小减小到恰好在 32 位架构上达到最佳状态的点
*   较小的常量子足迹 Nicholas Clark 减小了常量子的大小（如使用常量 FOO => 2）。加载像 POSIX 这样的模块时的结果很重要。
*   堆叠的文件测试你现在可以说 if (-e -f -x $file)。Perl 6 应该允许这样做，但他们朝不同的方向发展。那好吧。
*   词法 $_ 允许您嵌套 $_ （不使用本地）。
*   _原型你现在可以用原型声明一个子*。如果不带参数调用，则使用 $*（允许您更干净地替换内置函数）。
*   x 运算符在列表中，您现在可以说 my @arr = qw(xyz) x 4。（更新：此功能在 blead 中实现后被反向移植到 5.8 代码库，这就是 Somni 注意到它在 5.8 中可用的方式。 8）。
*   switch 一个真正的 switch/given 构造，灵感来自 Perl 6
*   智能匹配运算符 (~~) 与开关一起使用
*   闭包改进 dave_the_m 彻底修改了闭包处理代码，以修复许多错误行为和内存泄漏。
*   更快的 Unicode lc、uc 和 /i 在 Unicode 字符串上更快。对 UTF-8 缓存的改进。
*   改进的排序在可能的情况下执行就地排序，而不是使用临时排序。排序函数可以递归调用：可以对树进行排序
*   虚空上下文中的地图不再是邪恶的。只有道德上。
*   创建匿名列表和散列时使用的操作码更少。更快的猫！
*   污染改进 更多可能被污染的东西被标记为这样（例如 sprintf 格式）
*   $# 和 $* 已移除 远距离动作较少
*   perlcc 和 JPL 删除了这些东西只是 bug 磁铁，没有人足够关心它们。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-04T00:30:03.320

[Perl Tips](http://perltraining.com.au/tips/)中有一系列关于 Perl 5.10 的文章：

*   [Perl 5.10 中的正则表达式](http://perltraining.com.au/tips/2008-02-08.html)
*   [Perl 5.10：定义或和状态](http://perltraining.com.au/tips/2008-03-03.html)
*   [开关（给定和何时）](http://perltraining.com.au/tips/2008-03-12.html)
*   [Perl 5.10 和 Hash::Util::FieldHash](http://perltraining.com.au/tips/2008-03-25.html)
*   [Perl 5.10 中的智能匹配](http://perltraining.com.au/tips/2008-04-18.html)

还有我在[Perl Training Australia 的演示页面上](http://perltraining.com.au/tips/2008-04-18.html)*的 What's new in Perl 5.10*幻灯片，但由于它们是在 5.10 发布之前编写的，所以有些东西可能略有变化。我相信 rjbs 的[Perl 5.10 是为那些不完全疯狂的人准备](http://www.slideshare.net/rjbs/perl-510-for-people-who-arent-totally-insane/)的，现在涵盖了我的幻灯片所使用的所有内容。

祝一切顺利，

*保罗*

*强制性偏见披露：我写了这篇文章中提到的几乎所有资源，*

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-04T02:00:31.627

*[学习 Perl，第五版](http://oreilly.com/catalog/9780596520106/)*及更高版本涵盖 5.10。除此之外，其他人提到的资源，包括perldelta，都相当不错。我已经写了几篇关于[The Effective Perler](http://www.effectiveperlprogramming.com/category/perl/5-10/)的一些特性的文章。

最好的入门方法是选择一个有趣的功能并尝试使用它。这就是您会发现的指南作者的想法。这就是你真正应该开始学习任何语言的方式。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-03T22:22:30.553

正则表达式改进包括命名捕获：[看这里](http://www.szabgab.com/blog/2007/12/1198488988.html)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-04T01:21:30.113

请参阅 Ricardo Signes 的幻灯片，了解他出色的“Perl 5.10 For People Who Not All Insane”。

[http://www.slideshare.net/rjbs/perl-510-for-people-who-arent-totally-insane](http://www.slideshare.net/rjbs/perl-510-for-people-who-arent-totally-insane)

# regex - 正则表达式中的贪婪与否定字符类的问题

> ID：168531
> 
> 赞同：1
> 
> 时间：2008-10-03T19:34:33.480
> 
> 标签：regex, regex-greedy

我有一个非常大的文件，看起来像这样（见下文）。我有两种基本的正则表达式可供选择（我知道可能还有其他选择，但我真的想比较贪婪和否定字符类）方法。

```
ftp: [^\D]{1,}
ftp: (\d)+
ftp: \d+ 
```

***注意：如果我去掉 \d 周围的括号怎么办？***

现在 + 是贪婪的，它强制回溯，但 Negated Char 类需要逐个字符比较。哪个更有效率？假设文件非常非常大，因此由于文件的长度，处理器使用的微小差异将变得夸大。

既然您已经回答了这个问题，如果我的 Negated Char Class 非常大，比如说 18 个不同的字符怎么办？这会改变你的答案吗？

谢谢。

> ftp：1117 字节
> ftp：5696 字节
> ftp：3207 字节
> ftp：5696 字节
> ftp：7200 字节

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T19:42:14.090

[^\D]{1,} 和 \d+ 完全相同。正则表达式解析器会将 [^\D] 和 \d 编译成内容相同的字符类，而 + 只是 {1,} 的缩写。

如果你想要懒惰的重复，你可以添加一个？在末尾。

```
\d+? 
```

字符类通常被编译成 ASCII 字符的位图。对于 Unicode (>=256)，它取决于实现。一种方法是创建一个范围列表，并对其使用二进制搜索。

对于 ASCII，查找时间在大小上是恒定的。对于 Unicode，它是对数或线性的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T19:57:05.150

你的两个表情都有同样的贪婪。正如其他人在这里所说，除了捕获组之外，它们将以相同的方式执行。

同样在这种情况下，贪婪对执行速度的影响并不大，因为在 \d* 之后没有任何内容。在这种情况下，表达式将简单地处理它可以找到的所有数字，并在遇到空格时停止。这些表达式不应发生回溯。

为了使其更明确，如果您有这样的表达式，则应该进行回溯：

```
\d*123 
```

在这种情况下，解析器将吞没所有数字，然后回溯以匹配后面的三个数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T19:44:22.057

我最初的测试表明 [^\D{1,} 比 \d+ 慢一点，在 184M 文件上，前者需要 9.6 秒，而后者需要 8.2

没有捕获（（）的）两者都快了大约 1 秒，但两者之间的差异大致相同。

我还做了一个更广泛的测试，将捕获的值打印到 /dev/null，第三个版本在空间上拆分，结果：

```
([^\D]{1,}): ~18s
(\d+): ~17s
(split / /)[1]: ~17s 
```

编辑：拆分版本改进和时间减少到相同或低于 (\d+)

迄今为止最快的版本（有人可以改进吗？）：

```
while (<>)
{
    if ($foo = (split / /)[1])
    {
        print $foo . "\n";
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T19:44:25.503

这是一个书面的技巧问题，因为`(\d)+`由于捕获括号的开销而需要稍长的时间。如果您将其更改为`\d+`它们在我的 Perl / 系统中花费的时间相同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T19:46:50.023

是的，我同意 MizardX……这两个表达式在语义上是等价的。尽管分组可能需要额外的资源。你问的不是这个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T19:39:11.007

不是对问题的直接回答，但既然您已经知道行的格式，为什么不采用完全不同的方法呢？例如，您可以在字段之间的空白处使用正则表达式，或者完全避免使用正则表达式并在空白处使用 split()，这通常比任何正则表达式都快，具体取决于您使用的语言。

# .net - 使用 Windows 窗体在按钮上显示工具提示

> ID：168550
> 
> 赞同：233
> 
> 时间：2008-10-03T19:39:09.180
> 
> 标签：.net, winforms, button, tooltip

如何使用[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)在按钮上显示工具提示？

* * *

## 回答 #1

> 赞同：243
> 
> 时间：2008-10-03T19:50:53.430

ToolTip 是一个**单独**的 WinForms 控件，用于处理在单个表单上显示**多个**元素的工具提示。

假设您的按钮名为 MyButton。

1.  将 ToolTip 控件（在 Windows 窗体工具箱中的 Common Controls 下）添加到您的窗体。
2.  给它一个名字 - 说 MyToolTip
3.  将 MyButton 的“Tooltip on MyToolTip”属性（在按钮属性网格中的 Misc 下）设置为当您将鼠标悬停在它上面时应该出现的文本。

当光标悬停在按钮上时，工具提示将自动出现，但如果您需要以编程方式显示它，请调用

```
MyToolTip.Show("Tooltip text goes here", MyButton); 
```

在您的代码中显示工具提示，以及

```
MyToolTip.Hide(MyButton); 
```

让它再次消失。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2008-10-03T19:55:53.437

使用表单设计器：

*   将 ToolTip 控件从工具箱拖到窗体上。
*   选择您希望工具提示出现的控件的属性。
*   找到属性“toolTip on toolTip1”（如果您更改了它的默认名称，则名称可能不是 toolTip1）。
*   将属性的文本设置为您要显示的工具提示文本。

您还可以使用以下调用以编程方式设置工具提示：

```
this.toolTip1.SetToolTip(this.targetControl, "My Tool Tip"); 
```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2008-10-03T19:47:26.153

您可以使用 ToolTip 类：

[为控件创建工具提示](http://msdn.microsoft.com/en-us/library/aa288412(VS.71).aspx)

例子：

```
private void Form1_Load(object sender, System.EventArgs e)
{
    System.Windows.Forms.ToolTip ToolTip1 = new System.Windows.Forms.ToolTip();
    ToolTip1.SetToolTip(this.Button1, "Hello");
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-03T19:48:17.023

.NET 框架提供了一个 ToolTip 类。将其中一个添加到您的表单中，然后在您想要工具提示的每个项目的 MouseHover 事件上，执行以下操作：

```
private void checkBox1_MouseHover(object sender, EventArgs e)
{
    toolTip1.Show("text", checkBox1);
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-08-04T09:18:58.540

对于默认工具提示，可以使用 -

```
System.Windows.Forms.ToolTip ToolTip1 = new System.Windows.Forms.ToolTip();
ToolTip1.SetToolTip(this.textBox1, "Hello world"); 
```

如果工具提示消息需要格式化，也可以使用自定义工具提示。这可以通过自定义格式化表单来创建，并将其用作控件的鼠标悬停事件的工具提示对话框。请查看以下链接了解更多详情 -

[http://newapputil.blogspot.in/2015/08/create-custom-tooltip-dialog-from-form.html](http://newapputil.blogspot.in/2015/08/create-custom-tooltip-dialog-from-form.html)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-06-13T11:39:38.983

***在Tag*属性中懒惰和紧凑地存储文本**

如果您有点懒惰并且不将控件的*Tag*属性用于其他任何内容，您可以使用它来存储工具提示文本并将*MouseHover*事件处理程序一次性分配给所有此类控件，如下所示：

```
private System.Windows.Forms.ToolTip ToolTip1;
private void PrepareTooltips()
{
    ToolTip1 = new System.Windows.Forms.ToolTip();
    foreach(Control ctrl in this.Controls)
    {
        if (ctrl is Button && ctrl.Tag is string)
        {
            ctrl.MouseHover += new EventHandler(delegate(Object o, EventArgs a)
            {
                var btn = (Control)o;
                ToolTip1.SetToolTip(btn, btn.Tag.ToString());
            });
        }
    }
} 
```

*在这种情况下，所有在Tag*属性中具有字符串的按钮都被分配了一个*MouseHover*事件。为了保持简洁，*MouseHover*事件是使用 lambda 表达式内联定义的。如果任何悬停的按钮都将其*标记*文本分配给工具提示并显示。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-03-01T16:09:10.833

```
private void Form1_Load(object sender, System.EventArgs e)
{
    ToolTip toolTip1 = new ToolTip();
    toolTip1.AutoPopDelay = 5000;
    toolTip1.InitialDelay = 1000;
    toolTip1.ReshowDelay = 500;
    toolTip1.ShowAlways = true;
    toolTip1.SetToolTip(this.button1, "My button1");
    toolTip1.SetToolTip(this.checkBox1, "My checkBox1");
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-06-23T14:56:33.737

根据[DaveK 的回答](https://stackoverflow.com/a/168585/315493)，我创建了一个控件扩展：

```
public static void SetToolTip(this Control control, string txt)
{
    new ToolTip().SetToolTip(control, txt);
} 
```

然后，您可以使用单行为任何控件设置工具提示：

```
this.MyButton.SetToolTip("Hello world"); 
```

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2008-10-03T19:39:43.267

当然，只需处理 mousehover 事件并告诉它显示工具提示。t 是在全局变量或构造函数中定义的工具提示，使用：

```
ToolTip t = new ToolTip(); 
```

然后是事件处理程序：

```
private void control_MouseHover(object sender, EventArgs e)
{
  t.Show("Text", (Control)sender);
} 
```

# http - RESTifying URL

> ID：168557
> 
> 赞同：7
> 
> 时间：2008-10-03T19:40:55.777
> 
> 标签：http, rest, query-string

在这里工作时，我们有一个为业务合作伙伴提供 XML 提要的盒子。通过指定查询字符串参数和值来自定义我们的提要请求。其中一些参数是必需的，但许多不是。

例如，我们要求所有请求都指定一个 GUID 来识别合作伙伴，并且请求可以是“获取最新”或“搜索”操作：

对于搜索：*[http://services.null.ext/?id=[GUID]&q=[搜索](http://services.null.ext/?id=[GUID]&q=[Search)关键字]*
类别中的最新数据：*[http://services.null.ext/?id=[GUID]&category=[ ID]](http://services.null.ext/?id=[GUID]&category=[ID])*

为这些参数构建 RESTful URL 方案很容易：

搜索：*[http://services.null.ext/[GUID]/search/[Keywords]](http://services.null.ext/[GUID]/search/[Keywords])*
最新：*[http://services.null.ext/[GUID]/latest/category/[ID]](http://services.null.ext/[GUID]/latest/category/[ID])*

但是我们应该如何处理我们拥有的十几个可选参数呢？其中许多是相互排斥的，并且许多是组合的。很快，可能路径的数量变得极其复杂。

对于如何将具有复杂查询字符串的 URL 映射到更友好的 /REST/ful/paths，有哪些推荐做法？

（我对约定、方案、模式等感兴趣。不是在 Web 服务器或框架中实现 URL 重写的特定技术。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T20:15:06.597

您应该在查询字符串中保留可选的查询参数。REST 中没有“规则”表示不能有查询字符串。事实上，情况恰恰相反。查询字符串应用于更改您正在传输回客户端的表示的视图。

对于您的 URL 路径组件，请坚持使用“具有可表示状态的实体”。类别看起来不错，但是您通过 XML 提供的究竟是什么？帖子？目录项目？部分？

我认为更好的 REST 分类法看起来像这样（假设您的 XML 提要的内容是“文章”）：

*   [http://myhost.com/PARTNERGUID/articles/latest?criteria1=value1&criteria2=value2](http://myhost.com/PARTNERGUID/articles/latest?criteria1=value1&criteria2=value2)
*   [http://myhost.com/PARTNERGUID/articles/search?criteria1=value1&criteria2=value2](http://myhost.com/PARTNERGUID/articles/search?criteria1=value1&criteria2=value2)

If you're not thinking about the entities you are representing while building your REST structure, you're not doing REST. You're doing something else.

Take a look at [this article on REST best practices](http://www.xml.com/pub/a/2004/08/11/rest.html). It's old, but it may help.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T20:11:38.553

带值的参数？一种选择是查询字符串。使用它并不是天生就让人不安。另一种选择是使用分号，[Tim Berners-Lee 谈到了它们](http://www.w3.org/DesignIssues/MatrixURIs.html)，它们可能正好符合要求，允许 URL 有意义，而无需大量长路径。

# python - Python - 如何将“操作系统级句柄到打开的文件”转换为文件对象？

> ID：168559
> 
> 赞同：57
> 
> 时间：2008-10-03T19:41:04.963
> 
> 标签：python, temporary-files, mkstemp, fdopen

[tempfile.mkstemp()](http://www.python.org/doc/2.5.2/lib/module-tempfile.html)返回：

> 一个元组，包含一个打开文件的操作系统级句柄（将由 os.open() 返回）和该文件的绝对路径名，按此顺序。

如何将该操作系统级句柄转换为文件对象？

[os.open()](http://www.python.org/doc/2.5.2/lib/os-fd-ops.html)的文档指出：

> 要将文件描述符包装在“文件对象”中，请使用 fdopen()。

所以我尝试了：

```
>>> import tempfile
>>> tup = tempfile.mkstemp()
>>> import os
>>> f = os.fdopen(tup[0])
>>> f.write('foo\n')
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
IOError: [Errno 9] Bad file descriptor 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-10-03T19:47:17.260

您可以使用

```
os.write(tup[0], "foo\n") 
```

写入句柄。

如果你想打开句柄写你需要添加**“w”**模式

```
f = os.fdopen(tup[0], "w")
f.write("foo") 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-08-18T19:44:31.530

以下是使用 with 语句的方法：

```
from __future__ import with_statement
from contextlib import closing
fd, filepath = tempfile.mkstemp()
with closing(os.fdopen(fd, 'w')) as tf:
    tf.write('foo\n') 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-03T20:00:14.613

您忘记在 fdopen() 中指定打开模式 ('w')。默认值为 'r'，导致 write() 调用失败。

我认为 mkstemp() 创建只读文件。使用 'w' 调用 fdopen 可能会重新打开它以进行写入（您*可以*重新打开由 mkstemp 创建的文件）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-03-10T03:33:07.397

```
temp = tempfile.NamedTemporaryFile(delete=False)
temp.file.write('foo\n')
temp.close() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T20:19:54.730

你的目标是什么，在这里？不`tempfile.TemporaryFile`适合您的目的吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-05T14:15:44.287

我无法对答案发表评论，所以我将在这里发表我的评论：

要为写访问创建临时文件，您可以使用 tempfile.mkstemp 并将“w”指定为最后一个参数，例如：

```
f = tempfile.mkstemp("", "", "", "w") # first three params are 'suffix, 'prefix', 'dir'...
os.write(f[0], "write something") 
```

# transactions - 执行顺序操作的最佳实践

> ID：168560
> 
> 赞同：3
> 
> 时间：2008-10-03T19:41:13.170
> 
> 标签：transactions

一起执行几项任务的最佳方法是什么，如果一项任务失败，则不应完成下一项任务？我知道如果它是数据库操作，那么我应该使用 Transactions 但我正在谈论不同类型的操作，如下所示：

所有任务必须通过：

SendEmail ArchiveReportsInDatabase CreateAFile

在上述场景中，所有任务都必须通过，否则整个批处理操作必须回滚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T20:53:36.817

回滚很困难-AFAIK，实际上只有两种方法可以解决。两[阶段提交协议](http://en.wikipedia.org/wiki/Two-phase-commit_protocol)或[补偿事务](http://en.wikipedia.org/wiki/Compensating_transaction)。您确实必须找到一种以其中一种方式组织任务的方法。

通常，更好的想法是利用其他人的辛勤工作并使用已经内置 2PC 或补偿的技术。这就是 RDBMS 如此受欢迎的原因之一。

因此，具体细节取决于任务......但模式相当简单：

```
class Compensator {
   Action Action { get; set; }
   Action Compensate { get; set; }
}

Queue<Compensator> actions = new Queue<Compensator>(new Compensator[] { 
   new Compensator(SendEmail, UndoSendEmail),
   new Compensator(ArchiveReportsInDatabase, UndoArchiveReportsInDatabase),
   new Compensator(CreateAFile, UndoCreateAFile)
});

Queue<Compensator> doneActions = new Queue<Compensator>();
while (var c = actions.Dequeue() != null) {
   try {
      c.Action();
      doneActions.Add(c);
   } catch {
      try {
        doneActions.Each(d => d.Compensate());
      } catch (EXception ex) {
        throw new OhCrapException("Couldn't rollback", doneActions, ex);
      }
      throw;
   }
} 
```

当然，对于您的特定任务 - 您可能很幸运。

*   显然，RDBMS 工作已经可以包装在事务中。
*   如果您使用的是 Vista 或 Server 2008，那么您可以使用[Transactional NTFS](http://en.wikipedia.org/wiki/Transactional_NTFS)来覆盖您的 CreateFile 方案。
*   电子邮件有点棘手 - 我不知道它周围有任何 2PC 或补偿器（如果有人指出 Exchange 有一个，我只会有点惊讶）所以我可能会使用[MSMQ](http://en.wikipedia.org/wiki/Microsoft_Message_Queuing)编写通知并让订阅者拿起它并最终通过电子邮件发送它。那时，您的事务实际上只涉及将消息发送到队列，但这可能已经足够了。

所有这些都可以参与到[System.Transactions](http://msdn.microsoft.com/en-us/library/ms973865.aspx)事务中，所以你的状态应该很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T19:43:37.423

在 C# 中

返回 SendEmail() && ArchiveResportsInDatabase() && CreateAFile();

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T19:52:17.767

另一个想法：

```
try {
    task1();
    task2();
    task3();
    ...
    taskN();
}
catch (TaskFailureException e) {
    dealWith(e);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T19:53:56.903

几个建议：

在分布式场景中，可能需要某种两阶段提交协议。本质上，您向所有参与者发送一条消息，说“准备做 X”。然后每个参与者必须发送一个回复说“好的，我保证我可以做 X”或“不，不能做”。如果所有参与者都保证他们可以完成，则发送消息告诉他们完成。“保证”可以根据需要严格。

另一种方法是为每个操作提供某种撤消机制，然后有这样的逻辑：

```
try:
    SendEmail()
    try:
        ArchiveReportsInDatabase()
        try:
             CreateAFile()
        except:
            UndoArchiveReportsInDatabase()
            raise
    except:
        UndoSendEmail()
        raise
except:
    // handle failure 
```

（您不希望您的代码看起来像那样；这只是逻辑应该如何流动的说明。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T19:46:31.427

如果您的语言允许，这是非常整洁的：

1.  将您的任务放在一组代码块或函数指针中。
2.  遍历数组。
3.  如果任何块返回失败，则中断。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T19:52:26.563

您没有提到您正在使用什么编程语言/环境。如果是 .NET Framework，您可能想看看[这篇文章](http://msdn.microsoft.com/en-us/magazine/cc163556.aspx)。它描述了来自 Microsoft 的 Robotics Studio 的并发和控制运行时，它允许您对一组（异步）事件应用各种规则：例如，您可以等待任意数量的事件完成，如果一个事件失败则取消，等等。它也可以在多个线程中运行，所以你得到了一个非常强大的做事的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T19:52:43.817

你没有指定你的环境。在 Unix shell 脚本中，&& 运算符就是这样做的。

```
SendEmail () {
  # ...
}
ArchiveReportsInDatabase () {
  # ...
}
CreateAFile () {
  # ...
}

SendEmail && ArchiveReportsInDatabase && CreateAFile 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-03T19:57:49.580

如果您使用的语言使用[排序电路评估](http://en.wikipedia.org/wiki/Short-circuit_evaluation)（Java 和 C#），您可以简单地执行以下操作：

```
return SendEmail() && ArchiveResportsInDatabase() && CreateAFile(); 
```

如果所有函数都返回 true，这将返回 true，并在第一个返回 false 时立即停止。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-03T20:00:31.180

例外通常对这类事情有好处。伪 Java/JavaScript/C++ 代码：

```
try {
    if (!SendEmail()) {
        throw "Could not send e-mail";
    }

    if (!ArchiveReportsInDatabase()) {
        throw "Could not archive reports in database";
    }

    if (!CreateAFile()) {
        throw "Could not create file";
    }

    ...

} catch (Exception) {
    LogError(Exception);
    ...
} 
```

如果您的方法自己抛出异常，那就更好了：

```
try {
    SendEmail();
    ArchiveReportsInDatabase();
    CreateAFile();
    ...

} catch (Exception) {
    LogError(Exception);
    ...
} 
```

这种风格的一个非常好的结果是，当您沿着任务链向下移动时，您的代码不会越来越缩进；您所有的方法调用都保持在相同的缩进级别。缩进过多会使代码更难阅读。

此外，您在代码中有一个点用于错误处理、日志记录、回滚等。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-03T20:14:20.467

要真正做到正确，您应该使用异步消息传递模式。我刚刚完成了一个使用[nServiceBus](http://www.nservicebus.com/)和 MSMQ 完成的项目。

基本上，每个步骤都是通过向队列发送消息来发生的。当 nServiceBus 发现队列中等待的消息时，它会调用与该消息类型对应的 Handle 方法。这样，每个单独的步骤都可以独立地失败和重试。如果一个步骤失败，则消息最终会进入错误队列，因此您可以稍后轻松重试。

建议的这些纯代码解决方案并不那么健壮，因为如果某个步骤失败，您将无法在将来仅重试该步骤，并且您必须实现在某些情况下甚至不可能的回滚代码。

# javascript - 使用 Ajax 或 Silverlight 调用 Web 服务？哪个表现最好？

> ID：168575
> 
> 赞同：2
> 
> 时间：2008-10-03T19:46:20.990
> 
> 标签：javascript, ajax, silverlight, web-services, asp.net-ajax

我正在构建一个 ASP.NET AJAX 应用程序，该应用程序使用 JavaScript 调用 Web 服务以获取其数据，并且还使用 Silverlights 隔离存储在客户端计算机上缓存数据。最终，一旦数据被下载，它就会被传递给 JavaScript，该 JavaScript 使用 HTML DOM 显示在页面上。

我想弄清楚的是，我在 Silverlight 中进行这些 Web 服务调用然后在加载数据后将数据传递给 JavaScript 是否有意义？此外，无论我使用 JavaScript 还是 Silverlight 调用 Web 服务，Silverlight 都将使用独立存储将数据保存到磁盘。如果我用 JavaScript 调用 Web 服务，数据将被传递给 Silverlight 进行缓存。

我已经做了一些原型设计两种方式，我发现两种方式的性能几乎相同。此外，让我将 Silverlight 用于整个客户端数据访问层的原因之一是，我需要让计时器定期检查更新的数据并将其下载到缓存中，以便 JavaScript 可以在需要时加载。

有没有人做过类似的事情？如果是这样，您在使用所描述的 JavaScript 或 Silverlight 方法的性能方面有哪些经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T22:06:40.553

由于 Silverlight 可以处理基于 JSON 和 XML 的服务，因此响应的格式完全无关紧要。但是，您必须考虑以下几点：

1) Silverlight 比 JavaScript 快大约 1000 倍 2) 如果您的 Web 服务本身是基于 SOAP 的，Visual Studio 可以为您生成一个代理，这样您就不需要解析 SOAP 消息。3) Silverlight 具有 LINQ to XML 和 LINQ to JSON，这使得解析 POX 和 JSON 变得轻而易举。

在一个完美的世界中，我会使用 Silverlight 作为“引擎”，并在 Silverlight 不可用的情况下回退到 JavaScript。

问候，劳伦特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T19:57:34.743

另一件需要考虑的事情 - 以 JSON 格式获取数据将比 XML 和 Web 服务更快。JSON 很快就变成了一个 JavaScript 对象，并且不必像 XML 那样进行解析。就个人而言，我会使用 JavaScript。

文章：[使用 JSON 加速 AJAX](http://www.developer.com/lang/jscript/article.php/10939_3596836_2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T20:32:54.593

由于 JavaScript 不是多线程的，我发现使用 Silverlight 访问/缓存数据然后将其传递给 JavaScript 进行显示会产生更好的性能，同时避免锁定/冻结浏览器，这样用户就可以在数据的同时继续做事负载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T21:14:02.860

传递 JSON 格式的数据在一定程度上更快，因为与 XML SOAP 消息不同，它不需要 SOAP 标头或任何其他杂项信息 - 它只是纯数据。因此，使消息的总大小更小。

# unix - 如何使用 Unix find execute 和 cat 将子目录中的文件连接到一个文件中？

> ID：168589
> 
> 赞同：9
> 
> 时间：2008-10-03T19:47:46.230
> 
> 标签：unix, command-line

我可以做这个：

```
$ find .
.
./b
./b/foo
./c
./c/foo 
```

还有这个：

```
$ find . -type f -exec cat {} \;
This is in b.
This is in c. 
```

但不是这个：

```
$ find . -type f -exec cat > out.txt {} \; 
```

为什么不？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-03T19:50:08.627

find 的 -exec 参数为它找到的每个文件运行一次您指定的命令。尝试：

```
$ find . -type f -exec cat {} \; > out.txt 
```

或者：

```
$ find . -type f | xargs cat > out.txt 
```

xargs 将其标准输入转换为您指定的命令的命令行参数。如果您担心文件名中的嵌入空格，请尝试：

```
$ find . -type f -print0 | xargs -0 cat > out.txt 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T20:12:53.683

嗯......当您将 out.txt 输出到当前目录时，find 似乎正在递归

尝试类似的东西

```
find . -type f -exec cat {} \; > ../out.txt 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T19:53:39.870

你可以做这样的事情：

```
$ cat `find . -type f` > out.txt 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T19:52:02.617

将 find 的输出重定向到一个文件怎么样，因为您要做的就是将所有文件放入一个大文件中：

```
find . -type f -exec cat {} \; > /tmp/out.txt 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T20:28:16.430

也许您已经从其他响应中推断出`>`符号在 find 将其作为参数之前由 shell 解释。但是要回答您的“为什么不”，让我们看看您的命令，即：

```
$ find . -type f -exec cat > out.txt {} \; 
```

所以你给出了`find`这些论点：`"." "-type" "f" "-exec" "cat"`你给出了重定向这些论点：`"out.txt" "{}"`和`";"`. 这会混淆不以分号`find`结尾的参数并且不使用文件名作为参数（“{}”），它也可能会混淆重定向。`-exec`

查看其他建议，您应该真正避免在您找到的同一目录中创建输出。但他们会考虑到这一点。这种`-print0 | xargs -0`组合非常有用。你想输入的可能更像是：

```
$ find . -type f -exec cat \{} \; > /tmp/out.txt 
```

现在如果你真的只有一级子目录和普通文件，你可以做一些愚蠢而简单的事情：

```
cat `ls -p|sed 's/\/$/\/*/'` > /tmp/out.txt 
```

它将`ls`列出所有附加到目录的文件和目录`'/'`，同时`sed`将 a 附加`'*'`到目录。然后 shell 将解释这个列表并展开 glob。假设这不会导致 shell 处理太多文件，这些都将作为参数传递给 cat，并且输出将写入 out.txt。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T19:58:50.437

或者，如果您使用非常棒的 Z shell ( `zsh`)，则忽略无用的 find ，您可以这样做：

```
setopt extendedglob 
```

（这应该在你的`.zshrc`）然后：

```
cat **/*(.) > outfile 
```

只是工作:-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T20:35:38.210

试试这个：

```
(find . -type f -exec cat {} \;) > out.txt 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-03T21:29:49.520

在 bash 你可以做

```
cat $(find . -type f) > out.txt 
```

使用 $( ) 您可以从命令获取输出并将其传递给另一个

# mysql - 在基本托管 Web 服务器上托管 Web 服务的框架

> ID：168592
> 
> 赞同：1
> 
> 时间：2008-10-03T19:48:48.257
> 
> 标签：mysql, service, hosting

任何人都可以推荐一个框架或基本技术用于在基本托管 Web 服务器上托管 Web 服务吗？

我在 mySQL 数据库中有数据，Web 服务将访问这些数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T19:54:35.997

您可以在 C# 中非常轻松地创建它们

# agile - Scrum Master 的坏习惯

> ID：168593
> 
> 赞同：18
> 
> 时间：2008-10-03T19:49:47.270
> 
> 标签：agile, scrum

如今，Scrum 是相当流行的 dev.process 并且经常项目经理突然获得新头衔（Scrum Master）。然而，它不应该只是一个新的标题，而是新的习惯和新的范式。你的 Scrum master 有哪些坏习惯？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-03T19:55:39.133

不让 Scrums 保持正轨——让他们陷入技术讨论和更长的会议。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-03T20:02:07.027

分配工作并要求提供每日状态报告，而不是让团队学习如何管理自己的工作。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-03T20:16:59.573

我们的 Scrum Master 最初的一个大坏习惯是认为我们会解决自己的障碍。这是 Scrum Master 应该做的事情之一，但她把它留给了我们，直到它变得无法管理。

我们处理的另一件事是 Scrum Master 认为他们负责骑在开发人员的背上，直到任务得到处理。这在团队中造成了一种糟糕的气氛，因为他们应该是自我管理的。

对我和我们的团队来说，Scrum Master 的工作是成为团队的盾牌和助手，阻止障碍并尽其所能帮助加快进度。Ken Schwaber 的《使用 Scrum 进行**敏捷软件开发》是对 Scrum**的极好介绍，这是我们团队使用的，而且我们在这方面取得了相当大的成功。还有**带有 Scrum 的敏捷项目管理**，它更适合 Scrum Master 和 Product Owner 角色。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-07T15:50:44.147

1.  微观管理
2.  行使旧式指挥和控制，而不是促进自我指导的团队
3.  更多地关注数字/燃尽/积压，而不是组成团队的***人***
4.  没有保护团队免受外界干扰

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-09-05T13:36:23.970

1.  以高度活跃的方式对团队进行微观管理
2.  在技​​术决策上压倒高级开发人员，因为“Scrum 说”和“团队必须投票”。完全剥夺了高级技术人员的权力。
3.  试图在实际上不是问题的回顾会上从石头上挤出血液。
4.  告诉我要点并不重要，但在每次审查时，都会对要点进行剖析，每 2 周在审查时分析一次。此外，我们的年度奖金基于我们的积分表现。

Scrum 很好，但它可以无视多年来像魅力一样发挥作用的良好工程实践和技术流程。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-03T19:58:50.013

不断地在 Sprint 内外交换新的错误。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-03T16:36:33.863

有两种 Scrum Master：

1.  因采用敏捷而改变头衔的项目经理。
2.  一个专属的 Scrum master，他只为 Scrum 提供便利，并向项目经理 (shusa) 汇报。

第二点是在“真正的”敏捷组织中宣扬和实践的。它很贵，但它有一些优点。

还，

1.  预计 Scrum Master 将始终与 sprint 团队在一起（不是字面意思）。如果项目经理这样做，他/她将是微观管理。
2.  Scrum master 的角色不是管理预算，而是在团队可以做的工作量方面为 sprint 团队提供可预测性。
3.  Scrum master 应该了解团队成员的优势和劣势，并促进 Scrum 间的最佳实践分享。

所以，我的观点是，如果这些角色混淆了，团队可能不会做得很好。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-03T19:54:42.533

对流程的推回部分没有帮助，例如“这些都是客户在这个迭代中想要的所有商店，所以这就是我们必须做的”。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-03T23:30:35.703

不断尝试将实际工作时间与故事点估计值联系起来。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-03T19:53:36.437

当我参与 Scrum 时，Scrum 主管很快养成了让我们做自己的事情的习惯，而 Scrum 又回到了我们正常的开发程序中。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-03T22:23:34.277

1.  无法在周期内适当地分配任务（通常太多）
2.  与外部客户打交道不好（如果某项任务对于单个周期来说太大了，向团队抱怨而不是推回客户）
3.  让每日 Scrums 成为一个过大的过程——不遵守一定的时间限制（我们更喜欢最多 15 分钟）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-09-08T12:56:52.350

我真的不喜欢当前 PM 成为 Scrum Master 时认为 Scrum 是一种减少他们最初（个人）义务的方法，而不是将时间投入到团队合作和积极减压（计划挫折）上。他们只是躺下并开始称赞自己取得的出色成绩，而每个人都可以看到，如果没有他们的存在，团队会表现得更好。

在我看来，我们最好的 Scrum master 是具有强烈责任感的开发人员，或者是非 PM。

话又说回来，我（在全世界都知道 Scrum 之前）为那些严重震撼的 PM 工作过。我敢肯定，他们今天会成为伟大的 Scrum 大师。

# command-line - 在 Perforce 中删除文件的命令行语法是什么？

> ID：168594
> 
> 赞同：3
> 
> 时间：2008-10-03T19:49:48.083
> 
> 标签：command-line, syntax, file, perforce

我正在创建一些与 Perforce 交互的构建脚本，我想标记删除一些文件。使用命令行的 P4 语法到底是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-03T19:53:52.100

```
p4 delete filename 
```

（p4帮助删除的输出）

delete -- 打开现有文件以将其从 depot 中删除

p4 删除 [ -c changelist# ] [ -n ] 文件...

```
Opens a file that currently exists in the depot for deletion.
If the file is present on the client it is removed.  If a pending
changelist number is given with the -c flag the opened file is
associated with that changelist, otherwise it is associated with
the 'default' pending changelist.

Files that are deleted generally do not appear on the have list.

The -n flag displays what would be opened for delete without actually
changing any files or metadata. 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-03T19:57:20.580

教人钓鱼：

*   `p4 help` - 为您提供一般命令语法
*   `p4 help commands` - 列出命令
*   `p4 help <command name>`- 提供特定命令的详细帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T19:54:15.920

[http://www.perforce.com/perforce/doc.062/manuals/boilerplates/quickstart.html](http://www.perforce.com/perforce/doc.062/manuals/boilerplates/quickstart.html)

**删除文件**

要从 Perforce 服务器和您的工作区中删除文件，请发出 p4 delete 命令。例如：

```
p4 delete demo.txt readme.txt 
```

指定的文件将从您的工作区中删除并标记为从服务器中删除。如果您决定根本不想删除这些文件，请发出 p4 revert 命令。当您恢复为删除而打开的文件时，Perforce 会将它们恢复到您的工作区。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-22T22:16:13.110

承认 - 需要（少量）步骤才能在与您的安装相匹配的版本中在线找到（优秀的！）Perforce 用户指南，并获取包含您需要的信息的章节。

每当我发现自己需要有关 p4 命令行客户端的任何信息时，我都会依赖 Perforce 内置的帮助。访问它再简单不过了：

1.  在命令行上，输入`p4`

这可以让您了解 Michael Burr 在他的回答中显示的信息（以及更多信息）。如果您没有立即获得帮助屏幕，则说明我们的客户端配置有问题，例如 P4PORT 设置不正确。你显然需要先解决这个问题。

# asp.net - 使用 jQuery 在 IE 的 Javascript 中以编程方式触发事件

> ID：168596
> 
> 赞同：9
> 
> 时间：2008-10-03T19:50:17.817
> 
> 标签：asp.net, javascript, jquery, internet-explorer

当用户在 IE 中触发事件时，它被设置为`window.event`对象。查看触发事件的唯一方法是访问`window.event`对象（据我所知）

如果以编程方式触发事件（例如通过 jQuery 触发事件时），这会导致 ASP.NET 验证器出现问题。在这种情况下，`window.event`对象存储最后一个用户触发的事件。

当以`onchange`编程方式为附加了 ASP.NET 验证器的文本框触发事件时，验证会中断，因为它正在查看触发最后一个事件的元素，而不是验证器所针对的元素。

有谁知道解决这个问题的方法？这似乎是一个可以解决的问题，但从网上看，大多数人只是想方设法忽略问题而不是解决它。

* * *

**为了解释我具体在做什么：**
我在一个文本框上使用了一个 jQuery 时间选择器插件，该文本框也有 2 个与之关联的 ASP.NET 验证器。当时间改变时，我使用更新面板回发到服务器以动态地做一些事情，所以我需要触发 onchange 事件以触发该文本框的回发。

jQuery 时间选择器通过创建一个隐藏的无序列表进行操作，当单击文本框时该列表可见。`change()`当单击列表项之一时，通过 jQuery 的方法以编程方式为文本框触发“更改”事件。

因为事件的触发器是一个列表项，所以 IE 将*列表项*视为事件的源，而不是文本框，就像它应该的那样。

我不太关心这个 ASP.NET 验证器在文本框更改后立即工作，我只需要处理“ `change`”事件，以便为文本框调用我的回发事件。问题是验证器在 IE 中抛出异常，阻止任何事件被触发。

Firefox（我假设其他浏览器）没有这个问题。由于事件模型不同，只有 IE。有没有人遇到过这个并看到如何解决它？

* * *

我发现这个问题报告了其他几个地方，但他们没有提供解决方案：

*   [jQuery 的论坛，带有 jQ​​uery UI Datepicker 和 ASP.NET Validator](http://groups.google.com/group/jquery-en/browse_thread/thread/a8902f2774edc05a/d119026f561ca528?lnk=raot)
*   [ASP.NET 论坛，ValidatorOnChange() 函数的错误](http://forums.asp.net/t/1326208.aspx)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-16T14:09:34.060

我有同样的问题。使用此函数解决：

```
jQuery.fn.extend({
    fire: function(evttype){ 
        el = this.get(0);
        if (document.createEvent) {
            var evt = document.createEvent('HTMLEvents'); 
            evt.initEvent(evttype, false, false); 
            el.dispatchEvent(evt); 
        } else if (document.createEventObject) { 
            el.fireEvent('on' + evttype); 
        }
        return this;
    }
}); 
```

所以我对 datepicker 的“onSelect”事件处理程序看起来像：

```
if ($.browser.msie) {
    datepickerOptions = $.extend(datepickerOptions, { 
        onSelect: function(){
            $(this).fire("change").blur();
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-01-24T20:48:04.120

我用补丁解决了这个问题：

```
 window.ValidatorHookupEvent = function(control, eventType, body) {
        $(control).bind(eventType.slice(2), new Function("event", body));
    }; 
```

**更新：**我已将问题提交给 MS（[链接](https://connect.microsoft.com/VisualStudio/feedback/details/720704/asp-net-web-forms-programmatically-triggering-events-in-ie-leads-to-js-error-in-the-code-related-to-client-side-validators)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T23:57:04.840

根据您的描述，此问题可能是 IE 用于 JS 的独特事件冒泡模型的结果。

我唯一真正的答案是放弃 ASP.NET 验证器并改用 jQuery 表单验证插件。然后你的文本框可以只是一个普通的 ASP Webforms 控件，当内容发生变化和回发时一切都很好。此外，您将更多的客户端问题与服务器代码分开。

将 Webform Client 控件（如 Form Validation 控件）与外部 JS 库（如 jQuery）混合使用时，我从来没有运气好过。我发现更好的方法是选择其中一种，而不是混合搭配。

不是您可能正在寻找的答案。

如果你想使用 jQuery 表单验证插件，请考虑这个[jQuery Form Validation](http://randomactsofcoding.blogspot.com/2008/09/starting-with-jquery-dynamically.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-05T12:54:37.110

考虑在使用 javascript 启动事件之前设置隐藏字段 _EVENTTARGET 值。您需要将其设置为服务器端 ID（在客户端 ID 中将下划线替换为 $），以便服务器理解它。我在我模拟的按钮单击上执行此操作，以便服务器端可以确定在返回结果时触发哪个 OnClick 方法——Ajax 与否，并不重要。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-05-25T13:46:26.917

这是 jQuery datepickers 和 ASP 验证控件的地方性问题。正如您所说，错误的元素会交叉触发 ASP NET javascript 验证例程，然后 M$ 代码会抛出错误，因为该例程中的触发元素未定义。

我以与我见过的其他任何人不同的方式解决了这个问题 - 通过决定 M$ 应该更健壮地编写他们的代码，因此重新声明了一些 M$ 验证器代码以处理未定义的元素。我所看到的其他一切本质上都是 jQuery 方面的一种解决方法，并削减了可能的功能（例如，使用单击事件而不是更改）。

失败的一点是

```
 for (i = 0; i < vals.length; i++) {
        ValidatorValidate(vals[i], null, event);
    } 
```

当它尝试获取未定义的“vals”的长度时会引发错误。

我刚刚添加

```
if (vals) {
    for (i = 0; i < vals.length; i++) {
        ValidatorValidate(vals[i], null, event);
    }
} 
```

她很高兴。下面是重新声明整个违规函数的最终代码。我把它作为一个脚本包含在我的母版页或页面的底部。

是的，如果 M$ 决定在未来更改他们的验证器代码，这确实会破坏向上的兼容性。但是人们希望他们能修复它，然后我们可以完全摆脱这个补丁。

```
//  Fix issue with datepicker and ASPNET validators: redeclare MS validator code with fix
 function ValidatorOnChange(event) {
    if (!event) {
        event = window.event;
    }
    Page_InvalidControlToBeFocused = null;
    var targetedControl;
    if ((typeof (event.srcElement) != "undefined") && (event.srcElement != null)) {
        targetedControl = event.srcElement;
    }
    else {
        targetedControl = event.target;
    }
    var vals;
    if (typeof (targetedControl.Validators) != "undefined") {
        vals = targetedControl.Validators;
    }
    else {
        if (targetedControl.tagName.toLowerCase() == "label") {
            targetedControl = document.getElementById(targetedControl.htmlFor);
            vals = targetedControl.Validators;
        }
    }
    var i;
    if (vals) {
        for (i = 0; i < vals.length; i++) {
            ValidatorValidate(vals[i], null, event);
        }
    }
    ValidatorUpdateIsValid();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-29T12:11:33.900

这就是我解决类似问题的方法。为日期选择器编写了一个 onSelect() 处理程序。 [链接文本](http://docs.jquery.com/UI/Datepicker/datepicker#options) 在该函数中，称为 __doPostBack('textboxcontrolid','')。这触发了将文本框部分回发到服务器，服务器依次调用验证器。

# php - 你能在 PHP 中获得一个 Windows (AD) 用户名 吗？

> ID：168610
> 
> 赞同：49
> 
> 时间：2008-10-03T19:53:12.723
> 
> 标签：php, windows, authentication

我在 Intranet 上有一个 PHP Web 应用程序，可以提取该页面上当前用户的 IP 和主机名，但我想知道是否还有一种方法可以获取/提取他们的 Active Directory/Windows 用户名。这可能吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-03T19:57:20.110

检查`AUTH_USER`请求变量。如果您的 Web 应用程序允许匿名访问，这将为空，但如果您的服务器使用基本或 Windows 集成身份验证，它将包含经过身份验证的用户的用户名。

在 Active Directory 域中，如果您的客户端正在运行 Internet Explorer，并且您的 Web 服务器/文件系统权限配置正确，则 IE 将静默地将其域凭据提交到您的服务器，并且`AUTH_USER`用户`MYDOMAIN\user.name`无需显式登录到您的 Web 应用程序。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-07-29T06:51:04.607

我在 IIS 上运行了 php mysql -`$_SERVER["AUTH_USER"]` *如果*我在 IIS 中打开 Windows 身份验证 -> 身份验证并关闭匿名身份验证，我可以使用（重要）

我用它来获取我的用户和域：

```
$user = $_SERVER['AUTH_USER']; 
```

`$user`将返回一个值，如：`DOMAIN\username`在我们的网络上，然后只是`DOMAIN\`从字符串中删除的情况。

到目前为止，这在 IE、FF、Chrome、Safari（已测试）中有效。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-03T19:57:39.893

查看 PHP LDAP 库函数：[http](http://us.php.net/ldap) ://us.php.net/ldap 。

Active Directory [大部分] 符合 LDAP 标准。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-01-28T22:06:29.500

我们的环境中有多个域，所以我使用 preg_replace 和正则表达式来获取没有 DOMAIN\ 的用户名。

```
preg_replace("/^.+\\\\/", "", $_SERVER["AUTH_USER"]); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-12-24T12:02:58.947

如果您在 Windows 上使用 Apache，则可以从以下位置安装 mod_auth_sspi

[https://sourceforge.net/projects/mod-auth-sspi/](https://sourceforge.net/projects/mod-auth-sspi/)

说明在 INSTALL 文件中，并且有一个 whoami.php 示例。（这只是将 mod_auth_sspi.so 文件复制到文件夹中并在 httpd.conf 中添加一行的情况。）

一旦安装并在 httpd.conf 中进行必要的设置以保护您希望的目录，PHP 将`$_SERVER['REMOTE_USER']`在 IE 中使用经过身份验证的用户的用户和域 ('USER\DOMAIN') 填充 - 或在 Firefox 中提示并进行身份验证在传递它之前。

信息是基于会话的，因此即使在 Firefox 中也可以进行单（ish）登录......

-克雷格

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-03T20:13:08.440

您可能可以通过要求对某些文件进行身份验证的访问来使用[mod_auth_kerb](http://modauthkerb.sourceforge.net/)[在 Apache 中对用户](http://sammoffatt.com.au/knowledge-base-mainmenu/9-joomla/7-kerberos-single-signon-with-joomla-or-other-php-apps)[进行](http://blog.scottlowe.org/2006/08/10/kerberos-based-sso-with-apache/) 身份验证……我认为这样，用户名也应该在 PHP 环境变量中的某个地方可用……可能最好在运行后进行检查。`<?php phpinfo(); ?>`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-12-21T08:29:50.833

如果您正在寻找检索远程用户 IDSID/用户名，请使用：

```
echo gethostbyaddr($_SERVER['REMOTE_ADDR']); 
```

你会得到类似 iamuser1-mys.corp.company.com 的东西

过滤后面的其余域，您只能获得 idsid。

欲了解更多信息，请访问[http://lostwithin.net/how-to-get-users-ip-and-computer-name-using-php/](http://lostwithin.net/how-to-get-users-ip-and-computer-name-using-php/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-07-23T21:44:12.893

使用此代码：

```
shell_exec("wmic computersystem get username") 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-05-28T21:58:43.830

你可以说`getenv('USERNAME')`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-10-26T06:49:35.587

查看 Apache [https://github.com/rsim/mod_ntlm的修补 NTLM 身份验证模块](https://github.com/rsim/mod_ntlm)

基于 Apache/Unix 的 NTLM 身份验证模块 [http://modntlm.sourceforge.net/](http://modntlm.sourceforge.net/)

[在http://blog.rayapps.com/](http://blog.rayapps.com/)阅读更多信息

来源：http: [//imthi.com/blog/programming/leopard-apache2-ntlm-php-integrated-windows-authentication.php](http://imthi.com/blog/programming/leopard-apache2-ntlm-php-integrated-windows-authentication.php)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-03T19:56:55.230

不可以。但是您可以做的是让您的 Active Directory 管理员启用 LDAP，以便用户可以维护一组凭据

[http://us2.php.net/ldap](http://us2.php.net/ldap)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-04-24T07:58:04.473

get_user_name 的工作方式与 getenv('USERNAME'); 相同。

我在使用 getenv('USERNAME') 时遇到了编码（西里尔文）问题

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-12-16T12:52:03.637

引用还试图弄清楚 AUTH_USER 是否是特定域组的一部分；一个聪明的方法是不要创建一个带有文本文件的锁定文件夹（可以是空白的）。将安全设置为仅具有您要验证的安全/发行版组。一旦你运行 @file_get_contents （<---会抛出一个警告）......如果用户没有组访问权限，他们将无法获取文件内容，因此将没有特定的 AD 组访问权限。这很简单，而且效果很好。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-07-28T11:50:32.153

这是一个简单的 NTLM AD 集成示例，允许使用 Internet Explorer 进行单点登录，需要在其他浏览器中登录/配置。

PHP 示例

```
<?php 
$user = $_SERVER['REMOTE_USER'];
$domain = getenv('USERDOMAIN');

?> 
```

在您的 apache httpd.conf 文件中

```
LoadModule authnz_sspi_module modules/mod_authnz_sspi.so

<Directory "/path/to/folder">
    AllowOverride     All
    Options           ExecCGI
    AuthName          "SSPI Authentication"
    AuthType          SSPI
    SSPIAuth          On
    SSPIAuthoritative On
    SSPIOmitDomain    On
    Require           valid-user
    Require           user "NT AUTHORITY\ANONYMOUS LOGON" denied
</Directory> 
```

如果您需要该模块，此链接很有用：

[https://www.apachehaus.net/modules/mod_authnz_sspi/](https://www.apachehaus.net/modules/mod_authnz_sspi/)

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2017-03-07T16:21:20.177

试试这个代码：

```
$user= shell_exec("echo %username%"); 
    echo "user : $user"; 
```

你在 php 中得到你的 windows(AD) 用户名

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2017-03-15T20:14:41.650

我尝试了几乎所有这些建议，但它们都返回空值。如果其他人有这个问题，我在 php.net ( [http://php.net/manual/en/function.get-current-user.php](http://php.net/manual/en/function.get-current-user.php) ) 上找到了这个方便的功能：

```
get_current_user();
$username = get_current_user();
echo $username; 
```

这是我最终能够获得用户的活动目录用户名的唯一方法。如果以上答案均无效，请尝试一下。

# php - Emacs 的 PHP 模式

> ID：168621
> 
> 赞同：5
> 
> 时间：2008-10-03T19:55:52.297
> 
> 标签：php, emacs

我的 php 代码无法正确缩进时遇到问题...

我希望我的代码看起来像这样

```
if (foo)
{
    print "i am indented";
} 
```

但它总是看起来像这样：

```
if (foo)
  {
    print "i am not indented correctly";
  } 
```

我厌倦了在谷歌上搜索类似的东西，并尝试将以下内容添加到我的 .emacs 中，但它根本不起作用。

有什么想法吗？

```
 (add-hook 'php-mode-hook
          (function (lambda ()
                      ;; GNU style
                      (setq php-indent-level 4
                            php-continued-statement-offset 4
                            php-continued-brace-offset 0
                            php-brace-offset 0
                            php-brace-imaginary-offset 0
                            php-label-offset -4)))) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-27T22:12:42.957

自定义 c-default-style 变量。将此添加到您的 .emacs 文件中：

```
(setq c-default-style "bsd"
      c-basic-offset 4) 
```

[bsd 风格说明](http://en.wikipedia.org/wiki/Indent_style#Allman_style)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T20:17:51.193

自定义变量 c-default-style。您要么希望您的“其他”模式（或“php”，如果可用）设置为“bsd”，或者您可以将所有模式中的 hte 样式设置为 bsd。

据我了解，PHP 模式是建立在 c 模式之上的，所以它继承了它的自定义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-05T10:29:29.163

试试这个：

```
(defun my-build-tab-stop-list (width)
  (let ((num-tab-stops (/ 80 width))
        (counter 1)
        (ls nil))
    (while (<= counter num-tab-stops)
      (setq ls (cons (* width counter) ls))
      (setq counter (1+ counter)))
    (nreverse ls)))

(add-hook 'c-mode-common-hook
      #'(lambda ()
          ;; You an remove this, if you don't want fixed tab-stop-widths
          (set (make-local-variable 'tab-stop-list)
               (my-build-tab-stop-list tab-width))
          (setq c-basic-offset tab-width)
          (c-set-offset 'defun-block-intro tab-width)
          (c-set-offset 'arglist-intro tab-width)
          (c-set-offset 'arglist-close 0)
          (c-set-offset 'defun-close 0)
          (setq abbrev-mode nil))) 
```

# java - 转义字符串以防止在 Java 中解析正则表达式

> ID：168639
> 
> 赞同：13
> 
> 时间：2008-10-03T19:59:43.227
> 
> 标签：java, regex, string, escaping

在 Java 中，假设我有一个字符串变量 S，我想在另一个字符串 T 中搜索它，如下所示：

```
 if (T.matches(S)) ... 
```

（注意：上面的行是 T.contains() 直到一些帖子指出该方法不使用正则表达式。我的错。）

但是现在假设 S 中可能有令人讨厌的字符。例如，让 S = "[hi"。左方括号将导致正则表达式失败。有没有我可以调用的函数来转义 S 以免发生这种情况？在这种特殊情况下，我希望将其转换为“\[hi”。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-03T20:04:49.910

String.contains 不使用正则表达式，因此在这种情况下没有问题。

如果需要正则表达式，而不是拒绝带有正则表达式特殊字符的字符串，请使用 java.util.regex.Pattern.quote 转义它们。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-03T20:59:24.213

正如[Tom Hawtin](https://stackoverflow.com/questions/168639/escaping-a-string-from-getting-regex-parsed-in-java#168652)所说，您需要引用该模式。[您可以通过两种方式做到这一点（编辑：实际上是三种方式，正如@diastrophism](https://stackoverflow.com/questions/168639/escaping-a-string-from-getting-regex-parsed-in-java#169133)所指出的那样）：

1.  用“\Q”和“\E”包围字符串，如：

    ```
    if (T.matches("\\Q" + S + "\\E")) 
    ```

2.  改用[图案](http://java.sun.com/javase/6/docs/api/java/util/regex/Pattern.html)。代码将是这样的：

    ```
    Pattern sPattern = Pattern.compile(S, Pattern.LITERAL);
    if (sPattern.matcher(T).matches()) { /* do something */ } 
    ```

    这样，您可以缓存已编译的 Pattern 并重用它。如果您多次使用相同的正则表达式，您几乎肯定希望这样做。

请注意，如果您使用正则表达式来测试一个字符串是否在一个较大的字符串中，您应该将 .* 放在表达式的开头和结尾。但是，如果您引用该模式，这将不起作用，因为它将寻找实际的点。那么，您确定要使用正则表达式吗？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-03T22:24:07.490

试试[Pattern.quote(String)](http://java.sun.com/javase/6/docs/api/java/util/regex/Pattern.html#quote(java.lang.String))。它将修复字符串中具有特殊含义的任何内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T20:01:29.057

有什么特别的理由不使用 String.indexOf() 代替吗？这样，它将始终被解释为常规字符串而不是正则表达式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T20:08:29.137

正则表达式使用反斜杠字符“\”来转义文字。鉴于 java 还使用反斜杠字符，您需要使用双 bashslash，例如：

```
 String S = "\\[hi" 
```

这将成为字符串：

```
 \[hi 
```

这将传递给正则表达式。

或者，如果您只关心文字字符串并且不需要正则表达式，您可以执行以下操作：

```
if (T.indexOf("[hi") != -1)  { 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T20:16:20.963

T.contains() （根据 javadoc ： http: [//java.sun.com/javase/6/docs/api/java/lang/String.html](http://java.sun.com/javase/6/docs/api/java/lang/String.html)）不使用正则表达式。contains() 仅代表 indexOf()。

所以，这里没有使用正则表达式。您是否在考虑其他一些 String 方法？

# c# - 开始使用 C# 进行 TDD 编程的最佳步骤是什么？

> ID：168646
> 
> 赞同：6
> 
> 时间：2008-10-03T20:02:48.417
> 
> 标签：c#, .net, tdd

我想开始使用 TDD，但我真的不知道从哪里开始。我们使用 .NET (C#/ASP.NET) 进行编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T20:06:23.400

请参阅问题[为什么我应该练习测试驱动开发以及我应该如何开始？](https://stackoverflow.com/questions/4303/why-should-i-practice-test-driven-development-and-how-should-i-start),[将现有代码转移到测试驱动开发](https://stackoverflow.com/questions/167079/moving-existing-code-to-test-driven-development),[什么是单元测试？](https://stackoverflow.com/questions/1383/what-is-unit-testing)什么[是 TDD？](https://stackoverflow.com/questions/2260/what-is-tdd)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T20:06:56.113

我将首先阅读 TDD 以及为什么它是一个好的做法。当您阅读时，请尝试考虑这些概念如何应用于您自己的项目。

当我学习 TDD 时，起初它看起来很简单，但它是一种范式转变，它迫使我改变我对程序如何工作的看法。我想这就是重点。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T20:20:10.113

[Google 测试博客](http://googletesting.blogspot.com/)上也有很多很好的信息

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T21:24:45.287

有一本好书叫做[Microsoft .NET](http://www.microsoft.com/MSPress/books/6778.aspx)中的测试驱动开发，你可以看看。它本质上与经典的[Test Driven Development by Example](https://rads.stackoverflow.com/amzn/click/com/0321146530)相同，但考虑的是 Microsoft 平台。

# vba - 获取当前登录的windows用户

> ID：168659
> 
> 赞同：10
> 
> 时间：2008-10-03T20:07:36.487
> 
> 标签：vba, ms-access, winapi

我通过谷歌找到了这个：[http ://www.mvps.org/access/api/api0008.htm](http://www.mvps.org/access/api/api0008.htm)

```
'******************** Code Start **************************
' This code was originally written by Dev Ashish.
' It is not to be altered or distributed,
' except as part of an application.
' You are free to use it in any application,
' provided the copyright notice is left unchanged.
'
' Code Courtesy of
' Dev Ashish
'
Private Declare Function apiGetUserName Lib "advapi32.dll" Alias _
    "GetUserNameA" (ByVal lpBuffer As String, nSize As Long) As Long

Function fOSUserName() As String
' Returns the network login name
Dim lngLen As Long, lngX As Long
Dim strUserName As String
    strUserName = String$(254, 0)
    lngLen = 255
    lngX = apiGetUserName(strUserName, lngLen)
    If ( lngX > 0 ) Then
        fOSUserName = Left$(strUserName, lngLen - 1)
    Else
        fOSUserName = vbNullString
    End If
End Function
'******************** Code End ************************** 
```

这是最好的方法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-03T20:15:26.347

你也可以这样做：

```
Set WshNetwork = CreateObject("WScript.Network")
Print WshNetwork.UserName 
```

它还有一个 UserDomain 属性和一堆其他的东西：

[http://msdn.microsoft.com/en-us/library/907chf30(VS.85).aspx](http://msdn.microsoft.com/en-us/library/907chf30(VS.85).aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-03T20:10:24.953

您也可以使用 Environ$ 但问题指定的方法更好。用户/应用程序可以更改环境变量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T21:31:18.020

我通常使用 VBA 中的环境，如下所示。我没有遇到肯提到的可能性问题。

```
Function UserNameWindows() As String
    UserNameWindows = VBA.Environ("USERNAME") & "@" & VBA.Environ("USERDOMAIN")
End Function 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T20:14:43.680

[另一种方法](http://www.tek-tips.com/viewthread.cfm?qid=1259771&page=1)- 您提到的 API 可能是获取用户名的更好方法。

```
For Each strComputer In arrComputers
    Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
    Set colItems = objWMIService.ExecQuery("Select * from Win32_ComputerSystem",,48)
        For Each objItem in colItems
        Wscript.Echo "UserName: " & objItem.UserName & " is logged in at computer " & strComputer
Next 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-04T07:02:12.173

其他帖子中有很多替代方法，但要回答这个问题：是的，这是最好的方法。如果您只需要用户名，则比创建 COM 对象或 WMI 更快，并且在 Win95 以上的所有 Windows 版本中都可用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-01T02:35:34.033

有很多方法可以在 WMI 中获取当前登录的用户名。我的方法是通过'explorer.exe'进程中的用户名获取它，因为当用户登录到窗口时，根据当前用户访问该文件。

WMI 脚本如下所示：

```
Set objWMIService = GetObject("winmgmts:" & "{impersonationLevel=impersonate}!\\" & strIP & "\root\cimv2")
Set colProcessList = objWMIService.ExecQuery("Select * from Win32_Process")
For Each objprocess In colProcessList
   colProperties = objprocess.GetOwner(strNameOfUser, strUserDomain)
   If objprocess.Name = "explorer.exe" Then
      UsrName = strNameOfUser
      DmnName = strUserDomain
   End If
Next 
```

有关更多详细信息，请查看以下链接：http:
[//msdn.microsoft.com/en-us/library/aa394599%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa394599%28v=vs.85%29.aspx)

# javascript - JavaScript 表格操作

> ID：168661
> 
> 赞同：5
> 
> 时间：2008-10-03T20:08:21.273
> 
> 标签：javascript, dom

我有一张一列大约十行的表。第一列具有文本作为行标题的行，“标题 1”，“标题 2”。第二列包含供用户输入数据的字段（*文本框*和*复选框*）。

我想在顶部有一个标记为“*添加新...* ”的按钮，并让它创建第三列，与第一列具有相同的字段。如果用户再次单击它，它将创建另一个带有字段的空白列（如第二列）。

有谁知道操纵 DOM 以实现这一目标的有效方法？

我正在尝试`div`'s，`TABLES`但我正在第三天这样做，感觉比应该做的要难。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T21:01:39.217

有趣的运动。感谢 AviewAnew 的提示，我可以做到。

```
function AddColumn(tableId)
{
  var table = document.getElementById(tableId);
  if (table == undefined) return;
  var rowNb = table.rows.length;
  // Take care of header
  var bAddNames = (table.tHead.rows[0].cells.length % 2 == 1);
  var newcell = table.rows[0].cells[bAddNames ? 1 : 0].cloneNode(true);
  table.rows[0].appendChild(newcell);
  // Add the remainder of the column
  for(var i = 1; i < rowNb; i++)
  {
    newcell = table.rows[i].cells[0].cloneNode(bAddNames);
    table.rows[i].appendChild(newcell);
  }
} 
```

使用以下 HTML：

```
<input type="button" id="BSO" value="Add" onclick="javascript:AddColumn('TSO')"/>
<table border="1" id="TSO">
<thead>
<tr><th>Fields</th><th>Data</th></tr>
</thead>
<tbody>
<tr><td>Doh</td><td>10</td></tr>
<tr><td>Toh</td><td>20</td></tr>
<tr><td>Foo</td><td>30</td></tr>
<tr><td>Bar</td><td>42</td></tr>
<tr><td>Ga</td><td>50</td></tr>
<tr><td>Bu</td><td>666</td></tr>
<tr><td>Zo</td><td>70</td></tr>
<tr><td>Meu</td><td>80</td></tr>
</tbody>
</table> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T20:12:16.633

类似的东西

> ```
> function(table)
> {
>   for(var i=0;i<table.rows.length;i++)
>   {
>     newcell = table.rows[i].cells[0].cloneNode(true);
>     table.rows[i].appendChild(newcell);
>   }
> } 
> ```

# sql-server - 有没有办法在 MS SQL 2000 中编写表数据（也是临时表）的脚本？

> ID：168664
> 
> 赞同：1
> 
> 时间：2008-10-03T20:09:46.343
> 
> 标签：sql-server

给定一个表或一个临时表，我想运行一个过程，该过程将输出一个 SQL 脚本（即一堆 INSERT 语句）来填充该表。这在 MS SQL Server 2000 中可行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T20:15:01.260

您可以使用光标创建一个脚本来执行此操作。我昨天刚做了一个。你可以从中得到这个想法。

```
DECLARE MY_CURSOR Cursor 

FOR
Select Year, HolidayId, Date, EffBegDate, isnull(EffEndDate,'') AS EffEndDate, ChangedUser From HolidayDate

Open My_Cursor 

DECLARE @Year varchar(50), @HolidayId varchar(50), @Date varchar(50), @EffBegDate varchar(50), @EffEndDate varchar(50), @ChangedUser varchar(50)

Fetch NEXT FROM MY_Cursor INTO @Year, @HolidayId, @Date, @EffBegDate, @EffEndDate, @ChangedUser
While (@@FETCH_STATUS <> -1)
BEGIN
IF (@@FETCH_STATUS <> -2)

print 'INSERT INTO [Employee3].[dbo].[HolidayDate]([Year],[HolidayId],[Date],[EffBegDate],[EffEndDate],[ChangedUser])'
print 'VALUES ('''+@Year+''','''+@HolidayId+''','''+@Date+''','''+@EffBegDate+''','''+@EffEndDate+''','''+@ChangedUser+''')'

FETCH NEXT FROM MY_Cursor INTO @Year, @HolidayId, @Date, @EffBegDate, @EffEndDate, @ChangedUser
END
CLOSE MY_CURSOR
DEALLOCATE MY_CURSOR
GO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T20:18:22.317

一个简单的方法：

```
SELECT 'INSERT INTO table (col1, col2, col3) VALUES ('
    '''' + col1 + ''', '
    '''' + col2 + ''', '
    '''' + col3 + ''')'
FROM table 
```

一种更精细的方法是编写一个通过检查表的模式来构建 INSERT 语句的过程，但在实践中我从未发现真正需要这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T20:21:19.017

**[其他人在这里](http://vyaskn.tripod.com/code/generate_inserts.txt)**尝试过。请看一看。

# .net - 如何编写验收测试

> ID：168667
> 
> 赞同：3
> 
> 时间：2008-10-03T20:10:48.710
> 
> 标签：.net, testing, acceptance-testing

您将如何将验收测试引入使用 .NET 框架的团队？有哪些工具可用于此目的？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T20:12:55.447

您可能想看看 FitNesse，它旨在让验收测试看起来像 wiki 文档（以便 QA 或项目经理可以阅读和编写它们）

[http://fitnesse.org/](http://fitnesse.org/)

这是一个很好的介绍

[http://ablog.apress.com/?p=735](http://ablog.apress.com/?p=735)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-12T10:51:04.250

看到这篇文章，我认为首先了解什么是验收测试是个好主意。你的问题不是如何引入单元测试，它是验收测试的姐妹。对于 .Framework，他们应该使用 NMock 和 NUnit。

也值得检查 BDD

[客户验收测试应该有多详细？](https://stackoverflow.com/questions/832403/how-detailed-should-a-customer-acceptance-test-be)

# sql-server - 如何在 SQL 2000 中取回数字的 2 位表示

> ID：168672
> 
> 赞同：1
> 
> 时间：2008-10-03T20:12:37.740
> 
> 标签：sql-server

我在 SQL2000 上有一个带有数字列的表，我需要选择返回 01、02、03...

它目前返回 1,2,3,...10,11...

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-03T20:16:08.623

这行得通吗？

```
SELECT REPLACE(STR(mycolumn, 2), ' ', '0') 
```

来自[http://foxtricks.blogspot.com/2007/07/zero-padding-numeric-value-in-transact.html](http://foxtricks.blogspot.com/2007/07/zero-padding-numeric-value-in-transact.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T18:03:29.090

这类问题是关于数据库接口的。实际上，数据库应该返回数据，如果您的应用程序需要特定格式的数据，它可以重新格式化它。您不应该在数据库中执行此操作，而应在表示层中执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T20:24:54.580

约翰的答案有效并且可以推广到任意数量的数字，但我会更舒服

```
select case when mycolumn between -9 and 9 then '0' + str(mycolumn) else str(mycolumn) end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T20:40:18.870

其中 n 是 0 到 99 之间的正整数：

```
select right('0'+ltrim(str(n)),2) 
```

或者

```
select right(str(100+n),2) 
```

但我最喜欢约翰的回答。目标宽度的单点规范，但我发布这些是因为它们也是常见的习语，可能在其他情况或语言中效果更好。

# java - 使用 MVC 进行桌面应用程序开发的推荐书籍

> ID：168676
> 
> 赞同：9
> 
> 时间：2008-10-03T20:13:13.620
> 
> 标签：java, model-view-controller, desktop

我正在寻找有关桌面 MVC 书籍的建议。如果他们使用 Java，那将是一个好处。

一些背景知识：我正在用 Java 编写一个桌面应用程序。它是一个音频应用程序，具有多个视图和一个称为库的中央模型，其中包含播放列表、效果列表和用于组织它们的文件夹结构。在这个应用程序中，我希望为各种用户操作提供菜单、上下文菜单和拖放支持。我一直在努力解决如何使用 MVC 来实现这一点。

我从主类中的所有逻辑/控制器开始，但已经开始将它们分成自己的类。现在我需要开始使用监听器和观察器来处理视图和控制器之间的消息。这导致我创建了许多接口并在多个地方循环通过我的听众来触发各种消息。但是那个循环代码不断重复（不是 DRY），所以我假设现在我应该创建不同类型的事件类，在我的视图中创建这些事件并在视图中使用单个方法将其触发给各种侦听器.

**更新：**可以说，这无关紧要，但我使用的是 SWT，而不是 Swing。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-05T23:16:00.240

我遇到了同样的问题：编写一个（非平凡的）摇摆应用程序确实需要大量的纪律，因为所有的侦听器和事件以及异步处理很快就构成了一大堆不可维护的代码。

我发现经典的 MVC 是不够的，你必须研究更具体的模式，比如[Presentation Model](http://martinfowler.com/eaaDev/PresentationModel.html)等。我发现在应用于桌面应用程序时涵盖这种模式的唯一一本书是Scott Delap 的[Desktop Java Live](http://www.sourcebeat.com/books/desktopjavalive.html)。虽然大多数 Swing 书籍都涉及解决特定问题的技术（如何制作无网格 jtable、如何实现圆形按钮……），但 Delap 的书将帮助您构建中型 Swing 应用程序、最佳实践等.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T21:02:00.073

几乎任何 java、eclipse、netbeans 的摇摆书都应该能成功。

1) 免费 --- Thinking in Java ( [http://mindview.net/Books/TIJ/DownloadSites](http://mindview.net/Books/TIJ/DownloadSites) )
2) CORE java , vol 1 and 2
3) Swing hacks : [http://www.amazon.com/Swing- Hacks-Tips-Tools-Killer/dp/0596009070](https://rads.stackoverflow.com/amzn/click/com/0596009070)
4) netbeans RCP : [http://www.amazon.com/Rich-Client-Programming-Plugging-NetBeans/dp/B00132S6UU/ref=dp_kinw_strp_1](https://rads.stackoverflow.com/amzn/click/com/B00132S6UU) 5) eclipse 富客户端编程 - - [http://www.amazon.com/Eclipse-Rich-Client-Platform-Applications/dp/0321334612](https://rads.stackoverflow.com/amzn/click/com/0321334612)

希望这可以帮助。

BR，
~A

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T21:24:48.517

使用 C# 而不是 Java，但 Jeremy Miller 有很多关于桌面应用程序和 MVP/MVC[的帖子](http://codebetter.com/blogs/jeremy.miller/archive/tags/Build+your+own+CAB/default.aspx)（以及一大堆其他相关内容）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-07T07:55:31.453

只是为了投入我的 2 美分，我推荐这本书[Head First Design Patterns](http://www.headfirstlabs.com/books/hfdp/)。它对 MVC 模式（在 Java 中）有很好的解释。它建立在书中也讨论过的其他设计模式之上，例如 MVC 中使用的观察者、策略和组合。

我读过的最好的 MVC 教程。强烈推荐。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T21:21:14.730

不要忘记 Swing 教程；例如[摇摆事件教程](http://java.sun.com/docs/books/tutorial/uiswing/events/index.html)。

请记住 SwingWorker，或在单独的工作线程中处理事件。无论如何，我都不是 Swing 方面的专家，但我知道 Java 桌面应用程序的许多感知缓慢是由于在事件线程中完成的工作。如果这样的工作需要一些时间，则整个 GUI 将无响应。事后很难修复，如果你牢记这一点，就不是那么难做对了。

至于书籍，我发现 Cay Horstmann 和 Gary Cornell 的 Core Java 系列非常适合阅读。然而，它是关于 Java（包括 Swing）而不是关于 MVC。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T22:16:58.533

我需要在上面的条目中添加免费的 BOOK——THINKING IN JAVA 讨论 OOP、MVC 以及 Swing。不过，不确定它是否讨论了 MVC 的各种实现。

# windows - 添加/删除显示在漫游用户帐户中的应用程序

> ID：168679
> 
> 赞同：3
> 
> 时间：2008-10-03T20:14:18.203
> 
> 标签：windows, windows-installer

我已经为我的应用程序手动构建了一个安装程序（不要问为什么）。我在`HKCU\Software\Microsoft\Windows\CurrentVersion\Uninstall`. 它工作正常。我需要它在 HKCU 下，这样我的安装程序就可以在 Vista 上运行而无需提升。

我遇到的问题是，如果用户使用具有漫游配置文件的域帐户进行安装，然后转到另一台机器，则添加/删除控制面板中有一个我的软件条目，其中没有任何信息。我不希望它出现在漫游用户那里，我的应用程序没有以这样的方式安装，无论如何它都可以在这种情况下工作。无论如何我可以设置该条目，以便我的应用程序不会出现在添加/删除中？还是我在 HKCU 下的条目注定了自己的失败？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T18:52:49.087

fwiw：Google Chrome 以您的方式安装，但也遇到了同样的问题，因为它安装在配置文件“本地设置\应用程序数据”目录中，不会漫游 [1]。

与其解决安装\卸载问题，不如让您的应用程序与用户一起漫游是否合理？它是否小巧且可安装 xcopy，以便您可以将其安装在 Doc & settings\Application Data 某个地方，它会漫游吗？

[1] [http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/distrib/dseb_ovr_wpeu.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/distrib/dseb_ovr_wpeu.mspx?mfr=true)

# postgresql - postgresql 中的时间旅行函数

> ID：168681
> 
> 赞同：11
> 
> 时间：2008-10-03T20:14:40.093
> 
> 标签：postgresql, time-travel

任何人都可以推荐/反对 postgresql 的 contrib/spi 模块中的时间旅行功能吗？是否有任何地方可用的示例？

肿瘤坏死因子

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T21:15:27.283

时间旅行的论点是能够查看在较早的插入/删除点经常更新的表。假设公司投资组合的股票价格表。
反对的理由是它占用了额外的存储空间。

这是一个使用[示例](http://www.pgcluster.org/browser/postgresql-8.2.3/contrib/spi/timetravel.example?rev=3)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-07T14:01:52.697

有关历史报告的替代方法，请参阅[此讨论。](https://stackoverflow.com/questions/125877/versioning-database-persisted-objects-how-would-you#126029)

# php - 填充 PHP 数组：首先检查索引？

> ID：168691
> 
> 赞同：5
> 
> 时间：2008-10-03T20:16:49.853
> 
> 标签：php, optimization, readability

如果我深陷于循环嵌套中，我想知道其中哪一个更有效：

```
if (!isset($array[$key])) $array[$key] = $val; 
```

或者

```
$array[$key] = $val; 
```

就可读代码而言，第二种形式更可取。实际上，名称更长，数组是多维的。所以第一种形式最终在我的程序中看起来很粗糙。

但我想知道第二种形式是否会更慢。由于代码是程序中最常执行的函数之一，我想使用更快的形式。

一般来说，这段代码会以相同的“$key”值执行多次。所以在大多数情况下 $array[$key] 已经被设置，并且 isset() 将返回 FALSE。

为了澄清那些担心我将不同代码视为相同的人：就程序的这一部分而言，$val 是一个常量。直到运行时才知道，但它是在程序的早期设置的，在这里不会更改。所以这两种形式产生相同的结果。这是获取 $val 最方便的地方。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-03T20:49:58.540

对于您真正想要的数组：`array_key_exists($key, $array)`而不是`isset($array[$key])`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T20:40:52.347

isset() 对普通变量非常快，但是这里有一个数组。数组的哈希映射算法很快，但仍然比什么都不做要花费更多的时间。

现在，如果您设置了更多的值，那么第一种形式可能会比没有设置的值更快，这仅仅是因为它只是在不获取或设置值的情况下查找哈希。因此，这可能是一个不同点：如果您在设置的键上有更多“命中”，则选择第一种形式，如果您有更多“未命中”，则选择第二种形式。

请注意，这两段代码**并不**相同。第一种形式在已经设置时不会设置某个键的值 - 它可以防止“覆盖”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T20:45:21.810

`$array[$key]`在尝试设置之前，您是否测量过您遇到设置的情况的频率？我认为对此无法给出一般性建议，因为如果实际上有很多这样的情况，则 isset 检查可能会通过避免数组上不必要的集合来节省一些时间。但是，如果这种情况很少发生，那么开销可能会减慢您的速度……。最好的办法是对您的实际代码进行基准测试。

但是，请注意，这两个代码*可能会导致不同的结果*！如果组合的 $val 并不总是相同`$array[$key]`，则前一个代码将始终将值设置为第一个`$val`，`$array[$key]`而后一个代码将始终将其设置为该组合的最后一个值。

（我想你知道这一点并且`$val`对于 总是相同的`$array[$key]`，但有些读者可能不会。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-28T12:31:08.420

您应该检查数组，但不包括您要设置的级别。

如果你要设置

```
$anArray[ 'level1' ][ 'level2' ][ 'level3' ] = ... 
```

在设置 level3 之前，您应该确保到 level2 的路径确实存在。

```
$anArray[ 'level1' ][ 'level2' ] 
```

如果您不这样做，实际上不会杀死小狗，但根据您的特定环境，它们可能会生气。

您不必检查您实际设置的索引，因为自动设置它意味着它已被声明，但为了良好的实践，您应该确保没有任何东西被神奇地创建。

有一种简单的方法可以做到这一点：

```
<?php

function create_array_path( $path, & $inArray )
{
    if ( ! is_array( $inArray ) )
    {
        throw new Exception( 'The second argument is not an array!' );
    }
    $traversed = array();
    $current = &$inArray;

    foreach( $path as $subpath )
    {
        $traversed[] = $subpath;
        if ( ! is_array( $current ) )
        {
            $current = array();
        }
        if ( ! array_key_exists( $subpath, $current ) )
        {
            $current[ $subpath ] = '';
        }
        $current = &$current[ $subpath ];
    }
}

$myArray = array();

create_array_path( array( 'level1', 'level2', 'level3' ), $myArray );

print_r( $myArray );

?> 
```

这将输出：

```
 Array
    (
        [level1] => Array
            (
                [level2] => Array
                    (
                        [level3] => 
                    )

            )

    ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T20:18:13.393

可能是或可能不是真的比较的开销似乎需要更长的时间。

在两种配置中运行脚本对性能时间有何影响？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T20:53:45.693

我是 PHP 的新手，但两者的结合可能是三元运算符

```
$array[$key] = !isset($array[$key]) ? $val : $array[$key]; 
```

这是一种方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T20:22:30.153

对 isset() 的额外函数调用几乎可以保证比任何赋值都具有更多的开销。如果第二种形式不是更快，我会感到非常惊讶。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-03T20:46:49.730

您是否需要实际检查以查看密钥是否存在？分配给空白数组`isset()`只会减慢循环速度。除非您对数据操作进行第二次通过，否则我强烈建议您不要进行 isset 检查。这是人口，而不是操纵。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-06T17:53:21.123

您可以查看 PHP 源代码以了解不同之处。没有检查这在 PHP 的更高版本中是否会有所不同，但在 PHP3 中，关联数组功能似乎在[php3/php3_hash.c](http://cvs.php.net/viewvc.cgi/php3/php3_hash.c?view=markup)中。

在函数_php3_hash_exists中，做了以下事情：

*   密钥被散列
*   找到正确的存储桶
*   桶走，直到找到正确的项目

函数_php3_hash_add_or_update：

*   散列
*   找到存储桶
*   行走，如果存在则覆盖现有
    *   如果不存在，则添加新的

因此看起来只是设置它更快，因为只有一个函数调用，而这个散列和桶查找业务只会完成一次。

# database - 您如何衡量流经您的软件的所有查询？

> ID：168704
> 
> 赞同：1
> 
> 时间：2008-10-03T20:19:32.860
> 
> 标签：database, performance, metrics

在他的[一篇博客文章](http://www.codinghorror.com/blog/archives/001152.html)中，该网站的所有者向读者提出了这个问题，“您正在自动测量流经您的软件的所有查询，对吗？”

你怎么做到这一点？对数据库进行查询的每一行代码后面都有一行代码递增一个计数器？或者，是否有位于您的应用程序和数据库之间并为您执行此操作的工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T20:22:50.327

[SQL Server Profiler](http://msdn.microsoft.com/en-us/library/ms181091.aspx)是我选择的工具，但显然只用于 DB 端。

需要注意的是，这是为了优化查询和性能，以及调试。这不是一个一直运行的工具，因为它可能是资源密集型的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T14:33:45.663

我们刚刚购买了一款名为 dynaTrace 的软件产品来执行此操作。它使用字节码检测（在我们的例子中是 MSIL，因为我们使用 .Net，但它也使用 Java）来做到这一点。它基本上围绕我们选择的方法和各种框架方法进行检测，以捕获每个方法执行所需的时间。

关于数据库调用，它跟踪每个调用（通过 ADO.Net）和调用中的参数，以及执行时间。然后，您可以从 DB 调用中走出来，并通过程序到达那里的执行路径。它将显示路径中的每个方法调用（您已检测）。这是非常糟糕的。

您可能会以多种不同的方式使用它，但通常这将用于某种负载测试场景，而其他一些产品通过系统的各种路径提供负载。然后你会得到一个负载下的数据库调用列表，并可以查看它们。

您不仅可以评估一个调用的执行情况，还可以评估它们的数量，以防止一千次削减的死亡。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T20:26:44.390

我不知道 Jeff 到底想说什么，但我猜他希望您使用您为数据库提供的任何查询性能监控工具。

另一种方法是在代码中为数据库连接使用包装器。例如，在 Java 中，假设您有一个所有类都使用的 DataSource，您可以编写自己的 DataSource 实现，该实现使用底层 DataSource 创建 Connection 对象。您的 DataSource 应该将这些连接包装在您自己的 Connection 对象中，该对象可以跟踪流经它们的数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T20:29:02.433

我有一个用于所有数据库工作的 C++ 包装器。该包装器（在调试模式下）基本上对它运行的每条语句都执行 EXPLAIN QUERY PLAN。如果它得到一个索引没有被使用的响应，它就会断言。确保使用索引的好方法（但仅适用于调试模式）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-05T00:10:11.957

如果您的架构设计良好，那么拦截所有数据访问调用并测量查询执行时间应该相当容易。一个相当简单的方法是使用围绕 DB 调用的方面（如果您的语言/框架支持方面编程）。另一种方法是使用拦截所有调用的特殊驱动程序，重定向到真正的驱动程序并测量查询执行时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T20:26:10.833

对于 Perl，[DBI::Profile](http://search.cpan.org/perldoc?DBI::Profile)。

# applet - 如何为浏览器小程序指定特定的 JRE？

> ID：168706
> 
> 赞同：11
> 
> 时间：2008-10-03T20:20:08.303
> 
> 标签：applet, java

我有一个需要 JRE v1.5_12 才能正常工作的第三方小程序。用户正在安装 JRE v1.6.07 或更高版本。它曾经在 1.5 及以下版本中，我可以在机器上拥有多个 JRE，并指定要使用哪一个 - 但在 1.6 中，这似乎会被破坏。如何告诉浏览器我想使用 v1.5_12 而不是安装的最新版本？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-03T20:25:02.130

出于安全原因，您不能再强制它使用较旧的 JRE。假设第 12 版有一个巨大的安全漏洞，每个人都安装第 13 版来修补它。邪恶的 Java 小程序可以只说“请使用 12 版运行”，然后执行它们的漏洞利用，使补丁变得无用。

您很可能有一些带有安全漏洞的代码，较新的 JRE 会阻止这些代码，因为它会导致安全风险。修复你的代码，应该是很小的改动，然后你就不用担心了。

有关更改的更多信息，请参阅[此页面](http://java.sun.com/javase/6/webnotes/family-clsid.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T02:23:36.617

新的小程序引擎（当 Sun 正式发布时将与 1.6u10 一起发布）为您提供了该领域的大量控制权。在 6u10 上获得足够的系统到您可以真正依赖功能的地方需要一段时间（除非您是公司） - 但它即将到来（似乎为时已晚 5 年左右）。

这是一篇 JavaWorld 文章，它在非常高的层次上描述了这一点： [文章文本](http://www.javaworld.com/javaworld/jw-09-2008/jw-09-6u10.html)

6u10 也有一个部署工具包，它提供了超级易用的 javascript 片段，您可以将这些片段包含在您的小程序部署页面中。这些片段处理 JRE 版本检查、用户通知、按需下载 JRE 以及其他一些麻烦（并非不可能，只是痛苦）的其他事情。部署工具包被设计为优雅地失败，因此如果安装了 6u10 或更高版本，它会产生惊人的效果，并且对于较旧的 JRE 会恢复到正常的行为。

新的小程序引擎的一个非常非常好的事情是它运行在与浏览器不同的进程空间中。这有几个非常大的优势，包括能够在不同版本的 JRE 中运行多个小程序（是的，您可以指定不同的所需 JRE，包括对您支持的 JRE 的新旧程度的限制 - 小程序引擎将如果可以的话，可以重复使用 JRE，但如果需要，它可以启动另一个 JRE）。

# unit-testing - 从 MbUnit 迁移到 MsTest 时的问题

> ID：168720
> 
> 赞同：5
> 
> 时间：2008-10-03T20:22:40.373
> 
> 标签：unit-testing, mstest, factory, mbunit

我们的团队正在寻求从使用 mbunit 切换到 mstest，但两者之间似乎存在一些脱节。

有谁知道在使用 mstest 时如何从 mbunit 模拟 CombinatorialTest 和 Factory 属性？

我认为这是我们在进行转换之前唯一的绊脚石。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T20:35:35.447

据我所知，您基本上需要编写一个测试方法来生成所有组合（或调用工厂并遍历项目），这些组合会多次调用您的原始测试（现在不再是测试方法） .

不幸的是，这些不会在结果中显示为单独的测试——它们只显示为一个测试——所以你必须在错误输出中非常明确。这意味着与这种方法一样，一旦一个失败它就会停止其​​余的（你可以通过保留一个大的结果列表来解决这个问题，但这会带来更多的开销）

除非您必须这样做，否则我现在在去 mstest 之前会三思而后行 - 在干净的机器上缺少测试运行程序是致命的，而且它既不可扩展也不经常更新。

# sql-server - 从现有架构生成表关系图 (SQL Server)

> ID：168724
> 
> 赞同：202
> 
> 时间：2008-10-03T20:23:06.330
> 
> 标签：sql-server, database, diagram

有没有办法在连接到数据库的情况下生成显示现有表及其关系的图表？

这适用于 SQL Server 2008 速成版。

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2008-10-03T20:43:32.513

是的，您可以使用 SQL Server 2008 本身，但您需要安装 SQL Server Management Studio Express（如果未安装）。只需右键单击数据库图表并创建新图表。选择现有表，如果您已正确指定表中的引用。您将能够看到所选表格的完整图表。如需进一步参考，请参阅[SQL Server 数据库图表入门](http://www.mssqltips.com/sqlservertip/1816/getting-started-with-sql-server-database-diagrams/)

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-10-03T20:30:23.413

尝试 DBVis - 在[https://www.dbvis.com/download](https://www.dbvis.com/download)下载- 有一个专业版（不需要）和一个开放版本就足够了。

您所要做的就是获得正确的 JDBC - SQL Server 的数据库驱动程序，该工具只需按一个按钮即可显示表和引用正交、分层、圆形；-) 等。我多年来一直使用免费版本。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-05T01:53:34.823

SQLDeveloper 可以做到这一点。

[http://sqldeveloper.solyp.com/](http://sqldeveloper.solyp.com/)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-05-07T21:10:19.640

对于 SQL 语句，您可以尝试反向雪花。您可以在[sourceforge或](http://sourceforge.net/)[http://snowflakejoins.com/](http://snowflakejoins.com/)上的演示站点加入。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-03T20:24:29.447

为什么不直接使用 SQL Server 中内置的数据库图表功能？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-03T20:36:36.507

如果 yiu 创建数据库图表，Visio Professional 具有数据库逆向工程功能。它不是免费的，但在大多数公司中相当普遍，应该很容易获得。

请注意，Visio 2003 不能很好地与 SQL2005 或 SQL2008 进行逆向工程 - 您需要获得 2007。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-01-11T11:48:31.117

[DeZign for Databases](http://www.datanamic.com/dezign/)应该能够很好地做到这一点。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-05-11T02:43:23.110

[SchemaCrawler for SQL Server](http://schemacrawler.sourceforge.net/)可以在 GraphViz 的帮助下生成数据库图表。显示外键关系（甚至可以使用命名约定推断），并且可以使用正则表达式排除表和列。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-23T12:55:22.527

MySQL WorkBench 是免费软件，由 Oracle 开发，您可以导入 SQL 文件或指定数据库，它会生成一个 SQL 图表，您可以移动它以使其更具视觉吸引力。它在 GNU/Linux 和 Windows 上运行，它是免费的并且具有专业的外观..

# python - 既然 Python 2.6 已经发布，那么每个程序员都应该了解该语言中当前的哪些模块？

> ID：168727
> 
> 赞同：9
> 
> 时间：2008-10-03T20:23:12.273
> 
> 标签：python, module, language-features

Python 中的许多有用的特性都有些“隐藏”在模块中。例如，命名元组（[Python 2.6](http://docs.python.org/whatsnew/2.6.html)中的新功能）可以在[collections](http://docs.python.org/library/collections.html)模块中找到。

图书馆[文档页面](http://docs.python.org/library/)将为您提供该语言的所有模块，但 Python 新手可能会发现自己说“哦，我不知道我可以使用 Python 以*这种方式*完成它！” 除非有经验的开发人员指出语言中的重要特性。

我**并不是**专门寻找 Python 2.6 中的新模块，而是在这个最新版本中可以找到的模块。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-03T20:31:13.133

最令人印象深刻的新模块可能是`multiprocessing`模块。首先是因为它允许您在新进程中执行函数，并且使用与`threading`模块大致相同的 API。但更重要的是，因为它引入了许多用于进程之间通信的优秀类，例如一个`Queue`类和一个`Lock`类，它们的使用就像这些对象在多线程代码中一样，以及其他一些用于在进程之间共享内存的类。

[您可以在http://docs.python.org/library/multiprocessing.html](http://docs.python.org/library/multiprocessing.html)找到文档

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-03T20:39:54.363

新[模块](http://docs.python.org/library/json.html)对网络程序员来说是一个真正的福音[！！`json`](http://docs.python.org/library/json.html)（它[`simplejson`](http://undefined.org/python/#simplejson)在被合并到标准库之前就是众所周知的。）

它非常易于使用：`json.dumps(obj)`将内置类型的 Python 对象编码为 JSON 字符串，同时`json.loads(string)`将 JSON 字符串解码为 Python 对象。

真的很方便。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-03T20:30:29.390

可能是[PEP 0631](http://www.python.org/dev/peps/pep-0361/)和[2.6 中的新增](http://docs.python.org/whatsnew/2.6.html)功能可以提供答案元素。最后一篇文章解释了 2008 年 10 月 1 日发布的 Python 2.6 中的新功能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-02T20:24:27.007

**基本库**

对于从另一种语言到 Python 的经验丰富的程序员来说，主要挑战是弄清楚一种语言如何映射到另一种语言。以下是一些基本库以及它们与 Java 等价物的关系。

```
os, os.path 
```

具有 java.io.File、java.lang.Process 等功能。但更干净、更复杂，带有 Unix 风格。使用 os.path 而不是 os 以获得更高级别的功能。

```
sys 
```

操作 sys.path（类似于类路径），注册退出处理程序（如在 java Runtime 对象中），并访问标准 I/O 流，如在 java.lang.System 中。

```
unittest 
```

非常相似（并且基于）jUnit，带有测试装置和可运行的线束。

```
logging 
```

功能几乎与带有日志级别和记录器的 log4j 相同。（日志也在标准 java.util.Logging 库中）

```
datetime 
```

允许解析和格式化日期和时间，如 java.text.DateFormat、java.util.Date 和相关。

```
ConfigParser 
```

允许在 java 属性文件中进行持久配置（但也允许嵌套）。当您不希望 XML 或数据库后端的复杂性时使用它。

```
socket, urllib 
```

与 java.net 中的功能类似，用于处理套接字或通过 URL/URI 检索内容。

另外，请记住，许多基本功能，例如读取文件和使用集合，都在核心 python 语言中，而在 Java 中它存在于包中。

# .net - 有哪些字符串封装类可以同时指定其内容的含义和行为？

> ID：168732
> 
> 赞同：4
> 
> 时间：2008-10-03T20:23:54.427
> 
> 标签：.net

.NET 具有用于 Uris 的 System.Uri 和用于文件路径的 System.IO.FileInfo。我正在寻找传统上面向对象的类，因为它们指定了对象构造中使用的字符串的含义和行为。还存在哪些其他有用的字符串封装类？

诸如正则表达式和 StringBuilders 之类的东西对于字符串的粗略操作很有用，但它们不是我想要的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T20:34:42.517

也许 System.Security.SecureString 用于您不希望在公共内存中可用的字符串。

```
using (System.Security.SecureString password = new System.Security.SecureString())
{
    password.AppendChar('s');
    password.AppendChar('e');
    password.AppendChar('c');
    password.AppendChar('r');
    password.AppendChar('e');
    password.AppendChar('t');
    password.MakeReadOnly();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-08T22:49:18.967

```
System.Net.Mail.MailAddress someMailAddress = new System.Net.Mail.MailAddress("me@example.org", "John Doe");
System.Console.WriteLine(someMailAddress.Address); // me@example.org
System.Console.WriteLine(someMailAddress.User); // me
System.Console.WriteLine(someMailAddress.Host); // example.org
System.Console.WriteLine(someMailAddress.DisplayName); // John Doe
System.Console.WriteLine(someMailAddress); // "John Doe" <me@example.org> 
```

不会对字符串的行为进行太多更改，但提供了一种以类型安全的方式保存邮件地址的非常好的方法。此外，可以将此对象添加到邮件消息对象中。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T03:48:45.243

我见过几个项目将 Guid 存储为字符串表示或 byte[] 而不是使用本机 Guid 类。

```
Guid id = Guid.NewGuid()
Console.WriteLine(id); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T20:27:57.740

可能微不足道，但也有 System.IO.DirectoryInfo 和 System.Info.Path

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T20:33:03.283

System.Text.StringBuilder 和 System.Text.RegularExpressions.Regex

# mysql - 如何为 MySQL 日期时间列设置默认值？

> ID：168736
> 
> 赞同：986
> 
> 时间：2008-10-03T20:24:30.523
> 
> 标签：mysql, datetime

如何为 MySQL 日期时间列设置默认值？

在 SQL Server 中，它是`getdate()`. MySQL 的等价物是什么？如果这是一个因素，我正在使用 MySQL 5.x。

* * *

## 回答 #1

> 赞同：937
> 
> 时间：2008-10-03T20:48:00.650

**重要编辑：** 现在可以使用**MySQL 5.6.5**以来的 DATETIME 字段来实现这一点，看看下面的[另](https://stackoverflow.com/a/10603198/24820)一篇文章......

以前的版本不能用 DATETIME 做到这一点......

但是你可以用 TIMESTAMP 来做到这一点：

```
mysql> create table test (str varchar(32), ts TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
Query OK, 0 rows affected (0.00 sec)

mysql> desc test;
+-------+-------------+------+-----+-------------------+-------+
| Field | Type        | Null | Key | Default           | Extra |
+-------+-------------+------+-----+-------------------+-------+
| str   | varchar(32) | YES  |     | NULL              |       | 
| ts    | timestamp   | NO   |     | CURRENT_TIMESTAMP |       | 
+-------+-------------+------+-----+-------------------+-------+
2 rows in set (0.00 sec)

mysql> insert into test (str) values ("demo");
Query OK, 1 row affected (0.00 sec)

mysql> select * from test;
+------+---------------------+
| str  | ts                  |
+------+---------------------+
| demo | 2008-10-03 22:59:52 | 
+------+---------------------+
1 row in set (0.00 sec)

mysql> 
```

**警告：** *如果您定义一个默认为 CURRENT_TIMESTAMP ON 的列，您将需要始终为该列指定一个值，否则该值将在更新时自动重置为“now()”。这意味着如果您不想更改值，您的 UPDATE 语句必须包含“[您的列名] = [您的列名]”（或其他值），否则该值将变为“now()”。很奇怪，但确实如此。我正在使用 5.5.56-MariaDB*

* * *

## 回答 #2

> 赞同：670
> 
> 时间：2012-05-15T14:44:32.073

在 5.6.5 版本中，可以在 datetime 列上设置默认值，甚至可以创建在行更新时将更新的列。类型定义：

```
CREATE TABLE foo (
    `creation_time`     DATETIME DEFAULT CURRENT_TIMESTAMP,
    `modification_time` DATETIME ON UPDATE CURRENT_TIMESTAMP
) 
```

参考： http: [//optimize-this.blogspot.com/2012/04/datetime-default-now-finally-available.html](http://optimize-this.blogspot.com/2012/04/datetime-default-now-finally-available.html)

* * *

## 回答 #3

> 赞同：156
> 
> 时间：2009-09-27T17:04:09.673

MySQL（[5.6.5 之前的版本](http://dev.mysql.com/doc/refman/5.6/en/timestamp-initialization.html)）不允许将函数用于默认 DateTime 值。TIMESTAMP 由于其奇怪的行为而不适合，因此不建议将其用作输入数据。（请参阅[MySQL 数据类型默认值](http://dev.mysql.com/doc/refman/5.0/en/data-type-defaults.html)。）

也就是说，您可以[通过创建 Trigger](http://dev.mysql.com/doc/refman/5.0/en/trigger-syntax.html)来完成此操作。

我有一个带有 DateTime 类型的 DateCreated 字段的表。我在“插入前”和“”表上创建了一个触发器，`SET NEW.DateCreated=NOW()`效果很好。

我希望这对某人有所帮助。

* * *

## 回答 #4

> 赞同：134
> 
> 时间：2011-04-20T14:12:21.427

对我来说，触发方法效果最好，但我发现这种方法存在问题。考虑将日期字段设置为插入时的当前时间的基本触发器：

```
CREATE TRIGGER myTable_OnInsert BEFORE INSERT ON `tblMyTable`
    FOR EACH ROW SET NEW.dateAdded = NOW(); 
```

这通常很好，但是假设您想通过 INSERT 语句手动设置字段，如下所示：

```
INSERT INTO tblMyTable(name, dateAdded) VALUES('Alice', '2010-01-03 04:30:43'); 
```

发生的情况是触发器立即覆盖您为该字段提供的值，因此设置非当前时间的唯一方法是跟进 UPDATE 语句 - 哎呀！要在提供值时覆盖此行为，请尝试使用 IFNULL 运算符稍作修改的触发器：

```
CREATE TRIGGER myTable_OnInsert BEFORE INSERT ON `tblMyTable`
    FOR EACH ROW SET NEW.dateAdded = IFNULL(NEW.dateAdded, NOW()); 
```

这提供了两全其美：您可以为您的日期列提供一个值，它将采用，否则它将默认为当前时间。相对于表定义中的 DEFAULT GETDATE() 之类的干净的东西，它仍然是贫民区，但我们越来越近了！

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2009-10-12T05:02:12.120

我能够在有两个日期时间字段的表上使用这个 alter 语句来解决这个问题。

```
ALTER TABLE `test_table`
  CHANGE COLUMN `created_dt` `created_dt` TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00',
  CHANGE COLUMN `updated_dt` `updated_dt` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP; 
```

这就像您期望 now() 函数一样工作。插入空值或忽略 created_dt 和 updated_dt 字段会在两个字段中产生完美的时间戳值。对行的任何更新都会更改 updated_dt。如果您通过 MySQL 查询浏览器插入记录，您还需要一个步骤，即使用新时间戳处理 created_dt 的触发器。

```
CREATE TRIGGER trig_test_table_insert BEFORE INSERT ON `test_table`
    FOR EACH ROW SET NEW.created_dt = NOW(); 
```

触发器可以是任何你想要的我就像命名约定 [trig]_[my_table_name]_[insert]

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2011-02-12T17:44:31.917

您可以使用触发器来执行此类操作。

```
CREATE TABLE `MyTable` (
`MyTable_ID`  int UNSIGNED NOT NULL AUTO_INCREMENT ,
`MyData`  varchar(10) NOT NULL ,
`CreationDate`  datetime NULL ,
`UpdateDate`  datetime NULL ,
PRIMARY KEY (`MyTable_ID`)
)
;

CREATE TRIGGER `MyTable_INSERT` BEFORE INSERT ON `MyTable`
FOR EACH ROW BEGIN
        -- Set the creation date
    SET new.CreationDate = now();

        -- Set the udpate date
    Set new.UpdateDate = now();
END;

CREATE TRIGGER `MyTable_UPDATE` BEFORE UPDATE ON `MyTable`
FOR EACH ROW BEGIN
        -- Set the udpate date
    Set new.UpdateDate = now();
END; 
```

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2011-06-22T17:32:40.957

对于那些试图在**MySQL中设置默认****DATETIME**值的人来说，我确切地知道你的感受/感受。所以这里是：

 **```
ALTER TABLE  `table_name` CHANGE `column_name` DATETIME NOT NULL DEFAULT 0 
```

仔细观察**我没有在****0**周围添加单引号/双引号

 **解决这个问题后，我真的要跳起来了：D

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2016-12-07T14:31:20.560

如果您已经创建了表，那么您可以使用

**将默认值更改为当前日期时间**

```
ALTER TABLE <TABLE_NAME> 
CHANGE COLUMN <COLUMN_NAME> <COLUMN_NAME> DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP; 
```

**将默认值更改为“2015-05-11 13:01:01”**

```
ALTER TABLE <TABLE_NAME> 
CHANGE COLUMN <COLUMN_NAME> <COLUMN_NAME> DATETIME NOT NULL DEFAULT '2015-05-11 13:01:01'; 
```

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2013-02-21T21:28:57.937

[MySQL 5.6 已经修复了这个问题](http://dev.mysql.com/doc/refman/5.6/en/timestamp-initialization.html)。

```
ALTER TABLE mytable CHANGE mydate datetime NOT NULL DEFAULT 'CURRENT_TIMESTAMP' 
```

* * *

## 回答 #10

> 赞同：14
> 
> 时间：2009-03-10T18:38:48.220

这确实是一个可怕的消息。[这是一个长期未决的错误/功能请求](http://bugs.mysql.com/bug.php?id=27645)。该讨论还谈到了时间戳数据类型的限制。

我很想知道实现这个东西有什么问题。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2016-04-02T14:03:49.723

我正在运行 MySql Server 5.7.11 和这句话：

```
ALTER TABLE table_name CHANGE date_column datetime NOT NULL DEFAULT '0000-00-00 00:00:00' 
```

不**工作**。但以下内容：

```
ALTER TABLE table_name CHANGE date_column datetime NOT NULL DEFAULT '1000-01-01 00:00:00' 
```

**只是工作**。

作为*旁注*，它在[mysql 文档](http://dev.mysql.com/doc/refman/5.7/en/datetime.html)中提到：

> DATE 类型用于具有日期部分但没有时间部分的值。MySQL 以 'YYYY-MM-DD' 格式检索和显示 DATE 值。支持的范围是“1000-01-01”到“9999-12-31”。

即使他们也说：

> 无效的 DATE、DATETIME 或 TIMESTAMP 值将转换为相应类型的“零”值（'0000-00-00' 或 '0000-00-00 00:00:00'）。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2008-10-03T20:30:13.587

您可以使用 now() 设置日期时间列的值，但请记住，您不能将其用作默认值。

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2010-08-06T10:13:48.920

对于所有使用 TIMESTAMP 列作为解决方案的人，我想从手册中获得以下限制：

[http://dev.mysql.com/doc/refman/5.0/en/datetime.html](http://dev.mysql.com/doc/refman/5.0/en/datetime.html)

“TIMESTAMP 数据类型的范围为 '1970-01-01 00:00:01' UTC 到 ' **2038-01-19 03:14:07** ' UTC。它具有不同的属性，具体取决于 MySQL 版本和 SQL服务器运行的模式。这些属性将在本节后面介绍。"

所以这显然会在大约 28 年内破坏你的软件。

我相信数据库方面的唯一解决方案是使用其他答案中提到的触发器。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2011-03-25T08:28:09.283

在定义多行触发器时，必须更改分隔符，因为分号将被 MySQL 编译器作为触发器的结尾并产生错误。例如

```
DELIMITER //
CREATE TRIGGER `MyTable_UPDATE` BEFORE UPDATE ON `MyTable`
FOR EACH ROW BEGIN
        -- Set the udpate date
    Set new.UpdateDate = now();
END//
DELIMITER ; 
```

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2020-02-16T10:21:14.257

与 MySQL 8.x 一起工作正常

```
CREATE TABLE `users` (
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `dateCreated` datetime DEFAULT CURRENT_TIMESTAMP,
      `dateUpdated` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
      PRIMARY KEY (`id`),
      UNIQUE KEY `mobile_UNIQUE` (`mobile`)
    ) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci; 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2011-11-26T03:05:31.167

虽然您不能`DATETIME`在默认定义中执行此操作，但您可以简单地将 select 语句合并到您的插入语句中，如下所示：

```
INSERT INTO Yourtable (Field1, YourDateField) VALUES('val1', (select now())) 
```

请注意表格周围没有引号。

对于 MySQL 5.5

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2008-10-03T20:31:25.033

如果您尝试将默认值设置为 NOW()，我认为 MySQL 不支持。在 MySQL 中，您不能使用函数或表达式作为任何类型列的默认值，但 TIMESTAMP 数据类型列除外，您可以为其指定 CURRENT_TIMESTAMP 作为默认值。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2012-01-14T07:29:49.833

这是在 MySQL 5.1 上执行此操作的方法：

```
ALTER TABLE `table_name` CHANGE `column_name` `column_name` 
TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP; 
```

我不知道为什么你必须输入两次列名。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2018-07-26T08:07:18.697

我认为它在 mysql 中很简单，因为 mysql 的内置函数 now() 给出了当前时间（插入的时间）。

所以你的查询应该看起来类似

```
CREATE TABLE defaultforTime(
    `creation_time`     DATETIME DEFAULT CURRENT_TIMESTAMP,
    `modification_time` DATETIME default now()
); 
```

谢谢你。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2020-10-05T15:55:33.290

如果您设置`ON UPDATE CURRENT_TIMESTAMP`，它将在表中更新行数据时花费当前时间。

```
 CREATE TABLE bar(
        `create_time` TIMESTAMP CURRENT_TIMESTAMP,
        `update_time` TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
    ) 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2012-12-12T12:39:46.590

```
CREATE TABLE `testtable` (
    `id` INT(10) NULL DEFAULT NULL,
    `colname` DATETIME NULL DEFAULT '1999-12-12 12:12:12'
) 
```

在上面创建“testtable”的查询中，我使用“1999-12-12 12:12:12”作为 DATETIME 列的默认值`colname`

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2016-09-19T10:46:32.263

使用以下代码

```
DELIMITER $$

    CREATE TRIGGER bu_table1_each BEFORE UPDATE ON table1 FOR EACH ROW
    BEGIN
      SET new.datefield = NOW();
    END $$

    DELIMITER ; 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2012-11-16T06:10:46.480

如果您尝试将默认值设置为 NOW()，MySQL 支持您必须更改该列 TIMESTAMP 而不是 DATETIME 的类型。TIMESTAMP 将当前日期和时间作为默认值..我认为它会解决您的问题..

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-10-09T00:13:13.360

举个例子，如果我有一个名为“site”的表，其中包含一个 created_at 和一个 update_at 列，它们都是 DATETIME 并且需要现在的默认值，我可以执行以下 sql 来实现这一点。

```
ALTER TABLE `site` CHANGE `created_at` `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP;

ALTER TABLE `site` CHANGE `created_at` `created_at` DATETIME NULL DEFAULT NULL;

ALTER TABLE `site` CHANGE `updated_at` `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP;

ALTER TABLE `site` CHANGE `updated_at` `updated_at` DATETIME NULL DEFAULT NULL;

```

语句的顺序很重要，因为一个表不能有两个 TIMESTAMP 类型的列，默认值为 CUREENT TIMESTAMP

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2015-02-19T13:29:11.640

这是我的触发器示例：

```
/************ ROLE ************/
drop table if exists `role`;
create table `role` (
    `id_role` bigint(20) unsigned not null auto_increment,
    `date_created` datetime,
    `date_deleted` datetime,
    `name` varchar(35) not null,
    `description` text,
    primary key (`id_role`)
) comment='';

drop trigger if exists `role_date_created`;
create trigger `role_date_created` before insert
    on `role`
    for each row 
    set new.`date_created` = now();
```

* * *

## 回答 #26

> 赞同：-3
> 
> 时间：2010-10-21T11:34:03.000

您可以解析默认时间戳。首先考虑您使用的是哪个字符集，例如，如果您采用 utf8，则此字符集支持所有语言，如果您采用 laten1，则此字符集仅支持英语。Next setp 如果您在任何项目下工作，您应该知道客户时区并选择您是客户区。此步骤是强制性的。

# javascript - Firefox 中的渲染顺序

> ID：168738
> 
> 赞同：2
> 
> 时间：2008-10-03T20:24:42.973
> 
> 标签：javascript, firefox

我正在用 JavaScript 构建图表组件。它有两层分别渲染：前景和背景。

要确定所需的背景大小：

1.  渲染前景
2.  测量结果的高度
3.  一起渲染前景和背景

在代码中它看起来像这样：

```
var foreground = renderForegroundIntoString();
parentDiv.innerHTML = foreground;
var height = parentDiv.children[0].clientHeight;
var background = renderBackgroundIntoString(height);
parentDiv.innerHTML = foreground + background; 
```

使用IE7，这是小菜一碟。但是，Firefox2 并不太愿意立即渲染`parentDiv.innerHTML`，因此我无法读出前景高度。

Firefox 何时执行渲染以及如何延迟我的背景生成直到前景渲染完成，或者有没有其他方法来确定我的前景元素的高度？

[在测试丹的答案后附加（谢谢丹）]

在回调方法的主体内（`setTimeout(...))`我可以看到回调方法的渲染`innerHTML`还没有完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T20:31:10.167

你永远不应该依赖你刚刚插入到由下一行代码呈现的 DOM 中的东西。所有浏览器都会在一定程度上将这些更改组合在一起，要弄清楚何时以及为什么会变得很棘手。

处理它的最好方法是执行第二部分以响应某种事件。虽然在那种情况下看起来没有一个好的可以使用，所以如果失败了，你可以触发第二部分：

```
setTimeout(renderBackground, 0) 
```

这将确保当前线程在代码的第二部分执行之前完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-04T15:45:28.420

我认为您不需要 parentDiv.children[0]（无论如何，children 在 FF3 中都不是有效属性），而是您需要 parentDiv.childNodes[0]，但请注意，这包括可能没有高度的文本节点。您可以尝试循环等待 parentDiv 的后代呈现如下：

```
函数 getRenderedHeight(parentDiv) {
如果（parentDiv.childNodes）{
  变量 i = 0;
  while (parentDiv.childNodes[i].nodeType == 3) { i++; }
  //现在 parentDiv.childNodes[i] 是你的第一个非文本子节点
  返回 parentDiv.childNodes[i].clientHeight;
  //你的其他代码在这里...
} 别的 {
  setTimeout("isRendered("+parentDiv+")",200);
}
}

```

然后通过设置innerHTML后调用：getRenderedHeight(parentDiv)。

无论如何，希望能给一些想法。

# web-services - 如何创建使用 WS-Security 的 ColdFusion Web 服务客户端？

> ID：168798
> 
> 赞同：3
> 
> 时间：2008-10-03T20:40:49.807
> 
> 标签：web-services, coldfusion, ws-security

我已经使用 Java 和 WS-Security 在我们的产品中公开了几个 Web 服务。我们的一位客户想要使用 ColdFusion 使用 Web 服务。ColdFusion 是否支持 WS-Security？我可以通过编写 Java 客户端并在 ColdFusion 中使用它来解决它吗？

（我对 ColdFusion 了解不多）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-07T12:01:55.577

我假设您的意思是您需要将安全性作为 SOAP 标头的一部分传递。这是有关如何连接到 .Net 服务的示例。同样的方法应该适用于 Java，只是 url 会有所不同。

```
<cfset local.soapHeader = xmlNew()>
<cfset local.soapHeader.TheSoapHeader = xmlElemNew(local.soapHeader, "http://someurl.com/", "TheSoapHeader")>
<cfset local.soapHeader.TheSoapHeader.UserName.XmlText = "foo">
<cfset local.soapHeader.TheSoapHeader.UserName.XmlAttributes["xsi:type"] = "xsd:string">

<cfset local.soapHeader.TheSoapHeader = xmlElemNew(local.soapHeader, "http://webserviceUrl.com/", "TheSoapHeader")>
<cfset local.soapHeader.TheSoapHeader.Password.XmlText = "bar">
<cfset local.soapHeader.TheSoapHeader.Password.XmlAttributes["xsi:type"] = "xsd:string">

<cfset theWebService = createObject("webservice","http://webserviceUrl.com/Webservice.asmx?WSDL")>
<cfset addSOAPRequestHeader(theWebService, "ignoredNameSpace", "ignoredName", local.soapHeader, false)>

<cfset aResponse = theWebService.SomeMethod(arg1)> 
```

希望这是你需要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T18:51:43.050

这可能更准确地生成“简单”xml 肥皂标头。上面的示例缺少几行。

```
Local['soapHeader'] = xmlNew();
Local['soapHeader']['UsernameToken'] =  xmlElemNew(local.soapHeader, "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd", "UsernameToken");
Local['soapHeader']['UsernameToken']['username'] =  xmlElemNew(local.soapHeader, "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd", "username");
Local['soapHeader']['UsernameToken']['username'].XmlText = Arguments.szUserName;
Local['soapHeader']['UsernameToken']['username'].XmlAttributes["xsi:type"] = "xsd:string";
Local['soapHeader']['UsernameToken']['password'] =  xmlElemNew(local.soapHeader, "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd", "password");
Local['soapHeader']['UsernameToken']['password'].XmlText = Arguments.szPassword;
Local['soapHeader']['UsernameToken']['password'].XmlAttributes["xsi:type"] = "xsd:string";
addSOAPRequestHeader(ws, "ignoredNameSpace", "ignoredName", Local.soapHeader, false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T21:28:57.290

我从来没有做过任何 ws-security，也不知道 ColdFusion 是否可以使用它，但要回答你的第二个问题：

> > 我可以通过编写一个java客户端并在coldfusion中使用它来解决它吗？

是的，一点没错。ColdFusion 可以轻松地使用 Java 对象和方法。

# jquery - Where can I find a tutorial to get started learning jQuery?

> ID：168802
> 
> 赞同：22
> 
> 时间：2008-10-03T20:42:01.347
> 
> 标签：jquery

Where is a good place to get started learning how to use jQuery? It seems to be all the rage nowadays. I know some basics of JavaScript but I'm by no means an expert.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-03T20:44:14.073

Officially from jQuery [http://docs.jquery.com/Tutorials](http://docs.jquery.com/Tutorials)

Or try anything on this site that compiles a bunch of jQuery learning material:

[http://www.noupe.com/tutorial/51-best-of-jquery-tutorials-and-examples.html](http://www.noupe.com/tutorial/51-best-of-jquery-tutorials-and-examples.html)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-03T20:45:12.603

I can whole-heartedly recommend Manning's ['JQuery In Action'](http://www.manning.com/bibeault/). VERY readable, and does a great job of explaining the framework-specific abstractions.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-03T20:43:40.440

Here's a 4 part (so far) series on [Jquery Basics](http://dotnetslackers.com/Community/blogs/xun/archive/2008/09/13/jquery-the-very-very-basics-lesson-1.aspx).

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-03T20:44:44.540

[JQuery](http://docs.jquery.com/Tutorials) web site has some nice tutorials itself.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-03T20:52:01.890

As well as the jQuery in Action book that's already been mentioned, there's [Learning jQuery](http://www.packtpub.com/jQuery/book) and [jQuery Reference Guide](http://www.packtpub.com/jquery-reference-guide-Open-Source/book) from Packt. They work well as a pair: the Learning book has plenty of examples that they walk through in some detail - once you know what's possible, the Reference Guide helps you find the right method from the fairly comprehensive options available.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-26T01:05:42.760

If you're into video tutorials, check out the [jQuery for Absolute Beginners Series](http://blog.themeforest.net/tutorials/jquery-for-absolute-beginners-video-series/). It really helped to make jQuery click with me, more than traditional tutorials.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-03T20:43:59.127

Have you looked through [jQuery.com](http://docs.jquery.com/)? Their documentation is really excellent.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-04T17:34:34.220

There are a lot of them out there, google it, and the jQuery official site itself has a huge list of tutorials and excellent documentation with working examples. If that's not enough, try [http://jqueryfordesigner.com](http://jqueryfordesigner.com), [http://bassistance.de](http://bassistance.de). I have also written some at my blog, [http://www.chazzuka.com/blog](http://www.chazzuka.com/blog).

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-04T17:42:18.387

I ran across a [site with JQuery videos](http://www.mefeedia.com/tags/jquery/) recently.

There was also a [Hanselminutes podcast on the subject of jQuery](http://www.hanselman.com/blog/HanselminutesPodcast126ChatWithJohnResigCreatorOfJQuery.aspx).

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-30T03:11:34.883

I've found the links from "[The Complete jQuery Resource List for You to Become an Almighty Developer](http://effectize.com/jquery-developer-guide)" to be very helpful.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-26T00:27:56.360

There are lots of articles on JQuery on the web. Here's one for a beginner:

[http://www.dotnetcube.com/post/Getting-started-with-JQuery-in-ASPNET.aspx](http://www.dotnetcube.com/post/Getting-started-with-JQuery-in-ASPNET.aspx)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-10-12T16:43:19.703

I started with [15 days of jquery](http://15daysofjquery.com/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-04-01T10:00:32.573

I've just run into this one. I recommend it because it explains the basics and gives a solid foundation that you can build on.

[http://blog.mikecouturier.com/2010/02/beginning-with-jquery-solid-foundation_22.html](http://blog.mikecouturier.com/2010/02/beginning-with-jquery-solid-foundation_22.html)

# asp.net - 如何在跨页回发时从 PreviousPage 访问 ViewState 集合？

> ID：168826
> 
> 赞同：3
> 
> 时间：2008-10-03T20:47:07.560
> 
> 标签：asp.net

在 ASP.net 2.0 中，网页的 PreviousPage 属性没有 ViewState 集合。我想使用这个集合在页面之间传输信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T20:47:46.467

请改用 HttpContext.Current.Items ... ViewState 仅适用于它所在的页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T20:54:54.097

视图状态是页面独有的。

如果你想转移物品，

*   您可以将数据保存在数据库、文件、表单身份验证票或其他 cookie 中（如果您能提供帮助，请不要使用 Session 或 HttpContext.Current.Cache）
*   做一个跨页的帖子——从你的第一页，发回第二页（并从 HttpContext.Current.Request.Form[] 集合中获取详细信息）
*   将值放在查询字符串中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-07T11:06:01.530

您可以避免使用 PreviousPageType 指令，方法是使用一些可以容纳您的对象的基页类。例如你有课

```
public class BaseCrossPage:System.Web.UI.Page
{
     public List<Guid> Invitees = new List<Guid>();

} 
```

所以如果第一页从这个类派生

```
public partial class Default : BaseCrossPage
{

    protected void Page_Load(object sender, EventArgs e)
    {

       this.Invitees = LoadInvitees();
    }

} 
```

然后，您发布到的页面可以访问该对象，假设前一个页面派生自 BaseCrossPage ...

```
public partial class secondPage : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

        BaseCrossPage p = (BaseCrossPage)PreviousPage;
        List<Guid> Invitees = p.InvitedTeams
    }
} 
```

页面之间的一种“视图状态”......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T21:01:10.763

你不能直接。（参见[http://msdn2.microsoft.com/en-us/library/ms178139(vs.80).aspx](http://msdn2.microsoft.com/en-us/library/ms178139(vs.80).aspx)

这是你可以做的 -

在第一页上创建公共属性，公开您要共享的信息。在第二页上，将 PreviousPageType 设置为 aspx 文件标题中的第一页：

```
<%@ previouspagetype virtualpath="~/firstpage.aspx" %> 
```

然后，在第二页的Load事件中获取这些属性的值：

```
If (Not MyBase.IsPostBack) Then

    _someValue = Me.PreviousPage.SomeValue

End If 
```

# asp.net - 什么用于 ASP.NET 中的成员资格

> ID：168827
> 
> 赞同：5
> 
> 时间：2008-10-03T20:47:12.740
> 
> 标签：asp.net, architecture, asp.net-membership

我在使用 ASP.NET 方面不是很有经验，但是我已经为简单的 WebForms 应用程序使用了内置的成员资格提供程序，并且在尝试扩展它们的工作方式时发现了它们 PITA（添加/删除一些字段并相应地重做控件） . 现在我正在为 MVC（基于 ASP.NET MVC 或 Monorail）项目做准备，我在想——有没有更好的方法来处理用户？让他们登录/注销，让某些用户可以访问网站的某些部分（例如登录的用户，或类似于许多社交网站的“与朋友分享”功能，您可以在其中指定有权访问的用户某些事情。如何以可以很好地扩展的方式最好地实现这一点？

* * *

我想，我不是很清楚。重新表述我的问题：您会为面向 Web 的应用程序使用标准的 ASP.NET 成员资格提供程序，还是其他（什么）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-05T17:49:41.333

ASP.NET 中的 Membership Provider 非常方便且可扩展。使用 Active Directory、SQL Server 和 OpenLDAP 等“现成”功能非常简单。主要优点是能够不重新发明轮子。如果您的需求比这更细微，您可以通过扩展覆盖 ASP.NET 控件使用的方法来构建您自己的提供程序。

我正在为电子商务网站构建自己的自定义会员资格提供商。以下是有关会员提供者的更多信息的一些资源。当我开始那个项目时，我问过自己同样的问题。

这些资源对我的决定很有用：

*   [编写自定义成员资格提供程序](http://www.devx.com/asp/Article/29256)- DevX
*   [如何创建客户成员资格提供程序](http://www.asp.net/learn/videos/video-189.aspx)- ASP.NET、Microsoft
*   [实现成员资格提供程序](http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx)- MSDN
*   [检查 ASP.NET 2.0 的成员资格、角色和配置文件](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)- 4GuysFromRolla
*   [为 ASP.NET 网站安全创建自定义成员资格提供程序](http://davidhayden.com/blog/dave/archive/2007/10/11/CreateCustomMembershipProviderASPNETWebsiteSecurity.aspx)- David Hayden
*   [设置自定义会员提供者](http://channel9.msdn.com/posts/trobbins/Setting-up-a-Custom-Membership-Provider/)- 频道 9

我个人认为没有必要使用内置功能以外的东西，除非您想滥用自己或内置功能无法满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T20:55:05.067

您是否考虑过为此使用 ActiveDirectory？或者，也许是[OpenLDAP](http://www.voxgratia.org/docs/windows_openldap.html)？您可以管理每个用户的组、权限、“权限”等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T20:57:44.140

这取决于。

如果它是一个内部应用程序，Active Directory 或 OpenLDAP 可能是要走的路。

如果它是一个公共应用程序，我建议查看[aspnet_regsql](https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-2.0/ms229862(v=vs.80))。您将能够立即使用身份验证设置数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-09T22:48:27.120

> 保持网站的某些部分对某些用户可用（例如登录用户，或类似于许多社交网站的“与朋友分享”功能的东西

我猜你必须自定义代码你的东西。

我也不喜欢我的会员资格需要的 asp.net 会员资格和自定义代码......

一个好的会员提供者在 asp.net 方面是一个真正缺失的东西......

# sql - 使用数据库条目动态创建 visio 图表

> ID：168831
> 
> 赞同：5
> 
> 时间：2008-10-03T20:47:46.953
> 
> 标签：sql, database, diagram, visio, flowchart

这可能吗？

我们有一个配置管理数据库，它存储诸如我们的服务器、它们存储在哪个数据中心、驻留在它们上的应用程序以及将数据从一个应用程序发送到另一个应用程序的接口等信息。

我们想使用 Visio 连接到我们的 SQL 2005 数据库，并自动生成详细说明这些依赖关系和关系的流程图。

再说一遍 - 这可能吗？如果是这样，是否有人知道一些详细说明如何执行此操作的文档？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T20:52:14.557

这是**[你](http://msdn.microsoft.com/en-us/library/bb267248.aspx)**要找的吗？

# database-design - 数据库设计：适合大量列值的表设计

> ID：168833
> 
> 赞同：1
> 
> 时间：2008-10-03T20:48:01.693
> 
> 标签：database-design

我希望进行多次不同的实验。每次试验后，我都会留下一组“大”的输出统计数据——比如说，1000。我想将我的实验输出存储在一个表中，但是最好的方法是什么......？

### 选项1

有一个包含 1000 列的表。似乎是个坏主意。如果一天的统计数量超过了最大列数怎么办？

### 选项 2

有一个三列的表。比方说，ID、StatisticType 和 StatisticValue。这样，您可以拥有任意数量的统计信息。但是，读取单个实验统计数据变得更加复杂。此外，如果不同的统计数据是不同的数据类型怎么办？

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-03T20:51:20.253

选项 2，带有 ID、TrialID、StatisticID、StatisticValue

使用适当的索引，它会执行得相当好（您可以使用 PIVOT 在 SQL Server 2005 中相当容易地从列中获取值）。

当统计数据是不同的数据类型时，问题会变得更有趣，但在许多情况下，我只是扩大数据类型的大小（有时 int 最终会出现在 money 字段中）。对于其他不兼容的类型，我认为最好的设计实际上是为每种类型单独的表，但我也看到了多个列或自由格式的文本列。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T21:07:07.880

我支持 Cody 的回答（[这里](https://stackoverflow.com/questions/168833/database-design-a-proper-table-design-for-large-number-of-column-values#168844)），还有一些额外的想法和解释。

表的键是 trialID、statisticType。每个试验的每个统计量将有一行，每个试验有 1000 行。要获取单个实验的值，请选择特定 trialID 的行（如[matli](https://stackoverflow.com/questions/168833/database-design-a-proper-table-design-for-large-number-of-column-values#168850)所示。

您可以添加一个“Trial Master”表，其中包含每个试验的单行（trialID 作为键）以及有关该特定试验的相关信息（日期、时间、评论、人员 ...）。这将允许基于试验属性进行分组和分析..例如，上午试验的表现是否与下午试验不同，或者 Tarzan 的试验与 Jane 的试验表现不同？

您还可以添加一个“Stat Master”表，其中每个 statisticType 都有一行，并且包含有关统计信息的属性。如果各种统计数据具有不同的属性，或者您想对某些统计数据进行分组，这可能很有价值。

玩得开心！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T20:55:35.127

关系数据库中的列是存储在搜索、排序和其他信息处理中引用的数据的好地方。如果您只是要存储大量值，您可以使用其他格式，例如 XML，并将它们全部存储在一个列中。在这种情况下，XML 将为您提供可读性、可维护性、灵活性甚至一些可搜索性（SQL Server 2005+）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T20:52:00.313

您可以为统计类型创建一个表，包括它们的数据类型，然后为每个数据类型创建一个单独的表，例如 NumericStats、TextStats、DateTimeStats，它们都有一个指向 StatisticTypes 表的外键。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T20:55:24.800

如果您的 DBMS 提供 XML 数据类型，您可能需要考虑它。

优点：

*   从一行中获取试验的所有输出统计信息
*   使用正确的模式，统计数据的数量可能会因试验而异
*   大多数带有 XML 的 DBMS 可以很好地压缩您的数据

缺点：

*   将您的实现与特定的 DBMS 联系起来
*   查询结果并不容易

干杯。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T22:50:37.453

没关系。由于您没有提到您打算*将*数据用于什么目的，因此您如何存储它几乎没有意义。您可以将其存储在 CSV 中，并满足您的要求（基本上，我如何存储 1000 个值）。

您希望针对这些数据运行的查询以及您正在建模的领域*使世界变得与众不同*。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T20:52:05.523

三列：ID、实验和值。从一个实验中得到结果并不复杂，例如：`SELECT * FROM table WHERE Experiment = 5;`

# c# - 我应该如何将 Java 代码转换为 C# 代码？

> ID：168837
> 
> 赞同：6
> 
> 时间：2008-10-03T20:48:55.857
> 
> 标签：c#, java

我正在将 Java 库移植到 C#。我使用的是 Visual Studio 2008，因此我没有已停产的 Microsoft Java 语言转换助手程序 (JLCA)。

我的方法是创建一个与 Java 库具有类似项目结构的新解决方案，然后将 java 代码复制到 ac# 文件中，并逐行将其转换为有效的 c#。考虑到我发现 Java 易于阅读，这两种语言的细微差别让我感到惊讶。

有些东西很容易移植（命名空间、继承等），但有些东西却出乎意料地不同，例如嵌套类中私有成员的可见性、覆盖虚拟方法和内置类型的行为。我不完全理解这些东西，我敢肯定还有很多我还没有看到的其他差异。

我在这个项目上还有很长的路要走。在此转换过程中我可以应用哪些经验法则来正确管理语言差异？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T20:51:21.017

您以唯一理智的方式进行操作……最大的帮助将是 Dare Obasanjo 提供的这份文档，其中列出了两种语言之间的差异：

[http://www.25hoursaday.com/CsharpVsJava.html](http://www.25hoursaday.com/CsharpVsJava.html)

顺便说一句，将所有 getter 和 setter 方法更改为属性...除非您要获得完美的接口兼容性，否则无需将 C# 库函数与 java 库相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T21:12:36.247

几个值得注意的其他选项：

*   [J#](http://en.wikipedia.org/wiki/J_Sharp)是 Microsoft 在 .NET 上的 Java 语言实现。您可以访问 Java 库（无论如何，最高版本 1.4*）。*实际上 Java 1.1.4 用于 java.io/lang，1.2 用于 java.util + 请记住，J# 2.0 redist 的生命周期约为 2015-2017

*   [Mono 的 IKVM](http://www.mono-project.com/Java)还在 CLR 上运行 Java，可以访问其他 .NET 程序。

*   Microsoft Visual Studio 2005 带有一个“Java 语言转换助手”，它可以自动为您将 Java 程序转换为 C# 程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T22:48:33.247

还有一个简单粗暴的想法：您可以使用[IKVM](http://www.ikvm.net/)将 Java jar 转换为 .NET 程序集，然后使用[Reflector](http://www.red-gate.com/products/reflector/index.htm)（结合[FileDisassembler 插件](http://www.codeplex.com/reflectoraddins)）将其反汇编为 Visual C# 项目。

（顺便说一句，我实际上并没有使用过 IKVM——有人愿意保证这个过程会起作用吗？）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T21:06:16.633

如果您有少量代码，那么逐行转换可能是最有效的。

如果您有大量代码，我会考虑：

1.  寻找可以为您进行对话的产品。
2.  编写一个脚本（Ruby 或 Perl 可能是一个不错的选择）为您进行转换 - 至少是单调的东西！它可以是关键字差异和文件重命名的简单搜索/替换。让您有更多时间/手指专注于更难的事情。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-03T20:56:47.073

我不确定这是否真的是逐行转换代码的最佳方式，尤其是在障碍变得势不可挡的情况下。当然，Java 代码为您提供了指导和基本结构，但我认为最后最重要的是该库确实提供了与 Java 中相同的功能。

# colors - 颜色缩放功能

> ID：168838
> 
> 赞同：15
> 
> 时间：2008-10-03T20:49:06.263
> 
> 标签：colors, interpolation

我正在尝试在表单上可视化一些值。它们的范围从 0 到 200，我希望 0 附近的那些是绿色的，当它们达到 200 时变成鲜红色。

基本上，该函数应根据输入的值返回颜色。有任何想法吗 ？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-03T21:26:19.713

基本上，两个值之间平滑过渡的一般方法是以下函数：

```
function transition(value, maximum, start_point, end_point):
    return start_point + (end_point - start_point)*value/maximum 
```

鉴于此，您定义了一个对三元组（RGB、HSV 等）进行转换的函数。

```
function transition3(value, maximum, (s1, s2, s3), (e1, e2, e3)):
    r1= transition(value, maximum, s1, e1)
    r2= transition(value, maximum, s2, e2)
    r3= transition(value, maximum, s3, e3)
    return (r1, r2, r3) 
```

假设您有*s*和*e*三元组的 RGB 颜色，您可以按原样使用 transition3 函数。然而，通过 HSV 颜色空间会产生更“自然”的过渡。因此，给定转换函数（从 Python colorsys 模块中无耻地窃取并转换为伪代码 :)：

```
function rgb_to_hsv(r, g, b):
    maxc= max(r, g, b)
    minc= min(r, g, b)
    v= maxc
    if minc == maxc then return (0, 0, v)
    diff= maxc - minc
    s= diff / maxc
    rc= (maxc - r) / diff
    gc= (maxc - g) / diff
    bc= (maxc - b) / diff
    if r == maxc then
        h= bc - gc
    else if g == maxc then
        h= 2.0 + rc - bc
    else
        h = 4.0 + gc - rc
    h = (h / 6.0) % 1.0 //comment: this calculates only the fractional part of h/6
    return (h, s, v)

function hsv_to_rgb(h, s, v):
    if s == 0.0 then return (v, v, v)
    i= int(floor(h*6.0)) //comment: floor() should drop the fractional part
    f= (h*6.0) - i
    p= v*(1.0 - s)
    q= v*(1.0 - s*f)
    t= v*(1.0 - s*(1.0 - f))
    if i mod 6 == 0 then return v, t, p
    if i == 1 then return q, v, p
    if i == 2 then return p, v, t
    if i == 3 then return p, q, v
    if i == 4 then return t, p, v
    if i == 5 then return v, p, q
    //comment: 0 <= i <= 6, so we never come here 
```

，你可以有如下代码：

```
start_triplet= rgb_to_hsv(0, 255, 0) //comment: green converted to HSV
end_triplet= rgb_to_hsv(255, 0, 0) //comment: accordingly for red

maximum= 200

… //comment: value is defined somewhere here

rgb_triplet_to_display= hsv_to_rgb(transition3(value, maximum, start_triplet, end_triplet)) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-03T20:51:46.210

```
red = (float)val / 200 * 255;

green = (float)(200 - val) / 200 * 255;

blue = 0;

return red << 16 + green << 8 + blue; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-03T20:57:50.193

你没有说你在什么环境下做这个。如果您可以使用[HSV 颜色](http://en.wikipedia.org/wiki/HSL_and_HSV)，这将很容易通过设置 S = 100 和 V = 100 并通过以下方式确定 H：

```
H = 0.4 * value + 120 
```

[从 HSV 转换为 RGB](http://en.wikipedia.org/wiki/HSL_and_HSV#Conversion_from_HSV_to_RGB)也相当容易。

[编辑] 注意：与其他一些提议的解决方案相比，这将改变颜色绿色 -> 黄色 -> 橙色 -> 红色。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-03T20:55:11.570

选择一个你喜欢的绿色（RGB1 = #00FF00，例如）和一个你喜欢的红色（RGB2 = #FF0000，例如），然后像这样计算颜色

```
R = R1 * (200-i)/200 + R2 * i/200
G = G1 * (200-i)/200 + G2 * i/200
B = B1 * (200-i)/200 + B2 * i/200 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T20:57:34.077

为了获得最佳可控和准确的效果，您应该使用 HSV 颜色空间。使用 HSV，您可以轻松地将色相、饱和度和/或亮度彼此分开。然后，您对 RGB 进行转换。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-02-18T03:31:33.040

扩展@tzot 的代码......您还可以在起点和终点之间设置一个中点，如果您想要“过渡颜色”，这可能很有用！

```
//comment: s = start_triplet, m = mid_triplet, e = end_triplet
function transition3midpoint = (value, maximum, s, m, e):
    mid = maximum / 2
    if value < mid
      return transition3(value, mid, s, m)
    else
      return transition3(value - mid, mid, m, e) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T20:53:06.753

浏览[这篇维基百科文章](http://en.wikipedia.org/wiki/Color_space)，我个人会选择一条穿过色彩空间的路径，并将值映射到该路径上。

但这是一个直接的功能。我认为您可能更适合javascript颜色选择器，您可以找到一种快速颜色，可以为您提供十六进制，并且您可以存储十六进制。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-03T21:27:57.697

如果您按照 Peter Parker 的建议对红色和绿色值使用线性渐变，则值 100 的颜色基本上是[绿色](http://www.colourlovers.com/patterns/search?hex=7f7f00)（127、127、0）。理想情况下，您希望它在该中点呈亮橙色或黄色。为此，您可以使用：

```
Red = max(value / 100, 1) * 255
Green = (1 - max(value / 100, 1)) * 255
Blue = 0 
```

# default - 是否有一个普遍接受的无价值价值？

> ID：168859
> 
> 赞同：5
> 
> 时间：2008-10-03T20:54:49.700
> 
> 标签：default

我见过最常使用的 N/A（总是大写），但我不知道是否有标准。我的数据将在谷歌上看到，所以我想使用最受认可的价值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T21:08:20.157

这完全取决于您在没有价值时试图告诉用户什么。

例如，没有值是否意味着数据尚不可用，但稍后会提供？还是数据点不适用于当前记录？

我会选择一个传递最多信息的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T20:59:18.160

N/A 表示“不可用”或“不适用”。我想这是最普遍接受的术语。但如果这是最好的术语，这真的取决于上下文。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T20:56:00.477

“null”是我经常看到的一个常用术语，尤其是在涉及编程时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T20:56:12.207

N/A 表示不可用。“无”也可以。

此外，除非您知道自己在说什么，否则您真的不应该对某人进行评价。

[http://en.wikipedia.org/wiki/N/A](http://en.wikipedia.org/wiki/N/A)

（或者只是谷歌不适用 100 其他参考）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T21:04:51.240

实际上，我认为 N/A 表示[不适用](http://en.wikipedia.org/wiki/N/A)，并且经常在填写表格时使用。

我认为没有一个普遍接受的没有价值的标准。这取决于问题域。

例如，null 在数据库和编程语言领域很常见。

在其他情况下，您可能会使用“No value”、“Empty”或“Blank”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T20:57:34.717

N/A 用于当不能有值时，因为字段/属性不适用于数据项的上下文。

通常，当字段/属性应用于数据项的上下文时，但它没有值，人们要么将其留空。（或者放（空），虽然这肯定不那么常见）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T21:14:43.420

N/A 也意味着不可用或不适用，所以这不是一个好主意。NULL 只用在数据库中，所以普通用户不会理解。最好的办法是将字段留空或使用破折号：-

用不同的颜色标记应该显示值的空间也是一个好主意。如果您决定将其留空，则使用不同的背景颜色。如果您使用 - （或 ---），那么您可以为该字符使用不同的颜色并具有相同的背景。这完全取决于您的用例：您需要在哪里显示它。

# ruby - 如何使用 Scrubyt 获取“下一页”链接

> ID：168868
> 
> 赞同：0
> 
> 时间：2008-10-03T20:56:10.633
> 
> 标签：ruby, scrubyt

我正在尝试使用 Scrubyt 从该页面[http://www.nuffieldtheatre.co.uk/cn/events/event_listings.php?section=events](http://www.nuffieldtheatre.co.uk/cn/events/event_listings.php?section=events)获取详细信息。我已经设法从列表中获取标题和详细 URL，但我无法使用 next_page 让刮刀转到下一页。我认为这是因为我没有为下一页链接使用正确的模式。我尝试了字符串“Next Page”，也尝试了 XPath。还有其他想法吗？

代码如下：

```
require 'rubygems'
require 'scrubyt'

nuffield_data = Scrubyt::Extractor.define do
  fetch 'http://www.nuffieldtheatre.co.uk/cn/events/event_listings.php?section=events'

  event do
    title 'The Coast of Mayo'
    #url "href", :type => :attribute
    link_url
  end

  next_page "Next Page", :limit => 2

end

  nuffield_data.to_xml.write($stdout,1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T10:34:51.870

尝试使用稍微不同的 URL：

```
fetch 'http://www.nuffieldtheatre.co.uk/cn/events/event_listings.php' 
```

Scrubyt 似乎在 URL 末尾的“?section=events”查询存在问题。

当它寻找下一页时，它试图返回这个 URL：

[http://www.nuffieldtheatre.co.uk/cn/events/?pageNum_rsSearch=1&totalRows_rsSearch=39§ion=events](http://www.nuffieldtheatre.co.uk/cn/events/?pageNum_rsSearch=1&totalRows_rsSearch=39&section=events)

代替：

[http://www.nuffieldtheatre.co.uk/cn/events/event_listings.php?pageNum_rsSearch=1&totalRows_rsSearch=39§ion=events](http://www.nuffieldtheatre.co.uk/cn/events/event_listings.php?pageNum_rsSearch=1&totalRows_rsSearch=39&section=events)

删除 URL 末尾的查询字符串似乎可以解决此问题 - 您可能希望将此作为错误归档。

# sql - 混淆/屏蔽/加扰个人信息

> ID：168886
> 
> 赞同：14
> 
> 时间：2008-10-03T21:00:30.547
> 
> 标签：sql, sql-server, tsql, privacy, scramble

我正在寻找一种本土方法来打乱生产数据以用于开发和测试。我已经构建了几个脚本来生成随机社会安全号码、改变出生日期、打乱电子邮件等。但我在试图打乱客户姓名时遇到了困难。我想保留真实姓名，以便我们仍然可以使用或搜索，因此随机字母生成已结束。到目前为止，我尝试的是构建表中所有姓氏的临时表，然后使用临时表中的随机选择来更新客户表。像这样：

```
DECLARE @Names TABLE (Id int IDENTITY(1,1),[Name] varchar(100))

/* Scramble the last names (randomly pick another last name) */
INSERT @Names SELECT LastName FROM Customer ORDER BY NEWID();
WITH [Customer ORDERED BY ROWID] AS
(SELECT ROW_NUMBER() OVER (ORDER BY NEWID()) AS ROWID, LastName FROM Customer)
UPDATE [Customer ORDERED BY ROWID] SET LastName=(SELECT [Name] FROM @Names WHERE ROWID=Id) 
```

这在测试中运行良好，但在处理大量数据时完全陷入困境（40K 行超过 20 分钟）

所有这一切都在问，您将如何在保持真实姓名和生产数据权重的同时打乱客户姓名？

**更新：**永远不会失败，您尝试将所有信息都放在帖子中，但您忘记了一些重要的事情。这些数据也将用于我们公开的销售和演示环境。一些答案是我试图做的，“切换”名称，但我的问题是字面意思，如何在 T-SQL 中编码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-03T21:04:41.253

我使用[生成数据](http://www.generatedata.com/)。它是一个开源的 php 脚本，可以生成各种虚拟数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T21:04:10.943

一个非常简单的解决方案是 ROT13 文本。

一个更好的问题可能是为什么你觉得需要打乱数据？如果您有加密密钥，您还可以考虑通过 DES 或 AES 或类似方式运行文本。然而，这些可能存在潜在的性能问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T21:08:35.520

当做这样的事情时，我通常会编写一个小程序，首先在两个数组中加载很多名字和姓氏，然后使用数组中的随机名字/姓氏来更新数据库。即使对于非常大的数据集（200.000+ 条记录），它也能运行得非常快

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-02-25T23:39:42.683

我使用一种方法，将名称中的字符更改为与英文名称使用频率相同“范围”内的其他字符。显然，姓名中字符的分布与普通会话英语不同。例如，“x”和“z”出现 0.245% 的时间，因此它们被交换。另一个极端，“w”的使用率为 5.5%，“s”为 6.86%，“t”为 15.978%。我将“s”更改为“w”，将“t”更改为“s”，将“w”更改为“t”。我将元音“aeio”放在一个单独的组中，以便一个元音只被另一个元音替换。类似地，“q”、“u”和“y”根本不会被替换。我的分组和决定完全是主观的。

我最终得到了 7 个不同的 2-5 个字符的“组”，主要基于频率。每个组中的字符与同一组中的其他字符交换。

最终结果是名称有点像可能是名称，但来自“不在此处”。

```
Original name     Morphed name
Loren             Nimag
Juanita           Kuogewso
Tennyson          Saggywig
David             Mijsm
Julie             Kunewa 
```

这是我使用的 SQL，其中包括一个“TitleCase”函数。根据我在网上找到的不同字母频率，有 2 个不同版本的“变形”名称。

```
--    from     https://stackoverflow.com/a/28712621

-- Convert and return param as Title Case

CREATE FUNCTION [dbo].[fnConvert_TitleCase] (@InputString VARCHAR(4000) )
RETURNS VARCHAR(4000)AS
BEGIN
DECLARE @Index INT
DECLARE @Char CHAR(1)
DECLARE @OutputString VARCHAR(255)

SET @OutputString = LOWER(@InputString)
SET @Index = 2
SET @OutputString = STUFF(@OutputString, 1, 1,UPPER(SUBSTRING(@InputString,1,1)))

WHILE @Index <= LEN(@InputString)
BEGIN
   SET @Char = SUBSTRING(@InputString, @Index, 1)
   IF @Char IN (' ', ';', ':', '!', '?', ',', '.', '_', '-', '/', '&','''','(','{','[','@')
      IF @Index + 1 <= LEN(@InputString)
      BEGIN
         IF @Char != ''''  OR  UPPER(SUBSTRING(@InputString, @Index + 1, 1)) != 'S'
            SET @OutputString = STUFF(@OutputString, @Index + 1, 1,UPPER(SUBSTRING(@InputString, @Index + 1, 1)))
      END
         SET @Index = @Index + 1
      END

   RETURN ISNULL(@OutputString,'')

END
Go

--    00.045 x 0.045%
--    00.045 z 0.045%
--
--    Replace(Replace(Replace(TS_NAME,'x','#'),'z','x'),'#','z')
--
--    00.456 k 0.456%
--    00.511 j 0.511%
--    00.824 v 0.824%
--    kjv
--    Replace(Replace(Replace(Replace(TS_NAME,'k','#'),'j','k'),'v','j'),'#','v')
--
--    01.642 g 1.642%
--    02.284 n 2.284%
--    02.415 l 2.415%
--    gnl
--    Replace(Replace(Replace(Replace(TS_NAME,'g','#'),'n','g'),'l','n'),'#','l')
--
--    02.826 r 2.826%
--    03.174 d 3.174%
--    03.826 m 3.826%
--    rdm
--    Replace(Replace(Replace(Replace(TS_NAME,'r','#'),'d','r'),'m','d'),'#','m')
--
--    04.027 f 4.027%
--    04.200 h 4.200%
--    04.319 p 4.319%
--    04.434 b 4.434%
--    05.238 c 5.238%
--    fhpbc
--    Replace(Replace(Replace(Replace(Replace(Replace(TS_NAME,'f','#'),'h','f'),'p','h'),'b','p'),'c','b'),'#','c')
--
--    05.497 w 5.497%
--    06.686 s 6.686%
--    15.978 t 15.978%
--    wst
--    Replace(Replace(Replace(Replace(TS_NAME,'w','#'),'s','w'),'t','s'),'#','t')
--
--
--    02.799 e 2.799%
--    07.294 i 7.294%
--    07.631 o 7.631%
--    11.682 a 11.682%
--    eioa
--    Replace(Replace(Replace(Replace(Replace(TS_NAME,'e','#'),'i','ew'),'o','i'),'a','o'),'#','a')
--
--    -- dont replace
--    00.222 q 0.222%
--    00.763 y 0.763%
--    01.183 u 1.183%

-- Obfuscate a name
Select
   ts_id,
   Cast(ts_name as varchar(42)) as [Original Name]

   Cast(dbo.fnConvert_TitleCase(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(TS_NAME,'x','#'),'z','x'),'#','z'),'k','#'),'j','k'),'v','j'),'#','v'),'g','#'),'n','g'),'l','n'),'#','l'),'r','#'),'d','r'),'m','d'),'#','m'),'f','#'),'h','f'),'p','h'),'b','p'),'c','b'),'#','c'),'w','#'),'s','w'),'t','s'),'#','t'),'e','#'),'i','ew'),'o','i'),'a','o'),'#','a')) as VarChar(42)) As [morphed name] ,
   Cast(dbo.fnConvert_TitleCase(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(TS_NAME,'e','t'),'~','e'),'t','~'),'a','o'),'~','a'),'o','~'),'i','n'),'~','i'),'n','~'),'s','h'),'~','s'),'h','r'),'r','~'),'d','l'),'~','d'),'l','~'),'m','w'),'~','m'),'w','f'),'f','~'),'g','y'),'~','g'),'y','p'),'p','~'),'b','v'),'~','b'),'v','k'),'k','~'),'x','~'),'j','x'),'~','j')) as VarChar(42)) As [morphed name2]

From
   ts_users
; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-30T15:12:16.263

改为使用临时表，查询速度非常快。我只是在 4 秒内运行了 60K 行。我将继续使用这个。

```
DECLARE TABLE #Names 
(Id int IDENTITY(1,1),[Name] varchar(100)) 
```

/* 打乱姓氏（随机选择另一个姓氏）*/

```
INSERT #Names
  SELECT LastName 
  FROM Customer 
  ORDER BY NEWID();
WITH [Customer ORDERED BY ROWID] AS
(SELECT ROW_NUMBER() OVER (ORDER BY NEWID()) AS ROWID, LastName FROM Customer)

UPDATE [Customer ORDERED BY ROWID] 

SET LastName=(SELECT [Name] FROM #Names WHERE ROWID=Id)

DROP TABLE #Names 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T21:05:40.147

为什么不直接使用某种[随机名称生成器？](http://www.kleimo.com/random/name.cfm)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-05-08T21:13:57.007

我自己遇到了同样的问题，并想出了一个可能对其他人有用的替代解决方案。

这个想法是在名称上使用 MD5，然后将其最后 3 个十六进制数字映射到名称表中。您可以对名字和姓氏分别执行此操作。

3 个十六进制数字表示从 0 到 4095 的小数，因此我们需要一个包含 4096 个名字和 4096 个姓氏的列表。

所以`conv(substr(md5(first_name), 3),16,10)`（在`MySQL`语法上）将是一个从 0 到 4095 的索引，它可以与一个包含 4096 个名字的表连接。相同的概念可以应用于姓氏。

使用 MD5（而不是随机数）保证原始数据中的名称将始终映射到测试数据中的相同名称。

您可以在此处获取名称列表：

[https://gist.github.com/elfiner/cc90fdd387449158829515782936a9a4](https://gist.github.com/elifiner/cc90fdd387449158829515782936a9a4)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-08-16T10:55:39.593

以下方法对我们有用，假设我们有 2 个表客户和产品：

```
CREATE FUNCTION [dbo].[GenerateDummyValues]
(
    @dataType varchar(100),
    @currentValue varchar(4000)=NULL
)
RETURNS varchar(4000)
AS
BEGIN
IF @dataType = 'int'
    BEGIN
        Return '0'
    END
ELSE IF @dataType = 'varchar' OR @dataType = 'nvarchar' OR @dataType = 'char' OR @dataType = 'nchar'
    BEGIN
        Return 'AAAA'
    END
ELSE IF @dataType = 'datetime'
    BEGIN
        Return Convert(varchar(2000),GetDate())
    END
-- you can add more checks, add complicated logic etc
Return 'XXX'
END 
```

上述函数将有助于根据传入的数据类型生成不同的数据。

现在，对于每个表中没有单词“id”的每一列，使用以下查询生成进一步的查询来操作数据：

```
select 'select ''update '' + TABLE_NAME + '' set '' + COLUMN_NAME + '' = '' +  '''''''' + dbo.GenerateDummyValues( Data_type,'''') + '''''' where id = '' + Convert(varchar(10),Id) from INFORMATION_SCHEMA.COLUMNS, ' + table_name + ' where RIGHT(LOWER(COLUMN_NAME),2) <> ''id'' and TABLE_NAME = '''+ table_name + '''' + ';' from  INFORMATION_SCHEMA.TABLES; 
```

当您执行上述查询时，它将为每个表和该表的每一列生成更新查询，例如：

```
select 'update ' + TABLE_NAME + ' set ' + COLUMN_NAME + ' = ' +  '''' + dbo.GenerateDummyValues( Data_type,'') + ''' where id = ' + Convert(varchar(10),Id) from INFORMATION_SCHEMA.COLUMNS, Customers where RIGHT(LOWER(COLUMN_NAME),2) <> 'id' and TABLE_NAME = 'Customers';
select 'update ' + TABLE_NAME + ' set ' + COLUMN_NAME + ' = ' +  '''' + dbo.GenerateDummyValues( Data_type,'') + ''' where id = ' + Convert(varchar(10),Id) from INFORMATION_SCHEMA.COLUMNS, Products where RIGHT(LOWER(COLUMN_NAME),2) <> 'id' and TABLE_NAME = 'Products'; 
```

现在，当您执行上述查询时，您将获得最终更新查询，这将更新您的表的数据。

您可以在任何 SQL Server 数据库上执行此操作，无论您有多少表，它都会为您生成可以进一步执行的查询。

希望这可以帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-06-30T19:20:13.850

这是一种使用 ROT47 的方法，它是可逆的，另一种是随机的。您可以添加一个 PK 以链接回“未加扰”版本

```
declare @table table (ID int, PLAIN_TEXT nvarchar(4000))
insert into @table
values
(1,N'Some Dudes name'),
(2,N'Another Person Name'),
(3,N'Yet Another Name')

--split your string into a column, and compute the decimal value (N) 
if object_id('tempdb..#staging') is not null drop table #staging
select 
    substring(a.b, v.number+1, 1) as Val
    ,ascii(substring(a.b, v.number+1, 1)) as N
    --,dense_rank() over (order by b) as RN
    ,a.ID
into #staging
from (select PLAIN_TEXT b, ID FROM @table) a
    inner join
         master..spt_values v on v.number < len(a.b)
where v.type = 'P' 

--select * from #staging

--create a fast tally table of numbers to be used to build the ROT-47 table.

;WITH
    E1(N) AS (select 1 from (values (1),(1),(1),(1),(1),(1),(1),(1),(1),(1))dt(n)),
    E2(N) AS (SELECT 1 FROM E1 a, E1 b), --10E+2 or 100 rows
    E4(N) AS (SELECT 1 FROM E2 a, E2 b), --10E+4 or 10,000 rows max
    cteTally(N) AS 
    (
        SELECT  ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) FROM E4
    )

--Here we put it all together with stuff and FOR XML
select 
    PLAIN_TEXT
    ,ENCRYPTED_TEXT =
        stuff((
        select
            --s.Val
            --,s.N
            e.ENCRYPTED_TEXT
        from #staging s
        left join(
        select 
            N as DECIMAL_VALUE
            ,char(N) as ASCII_VALUE
            ,case 
                when 47 + N <= 126 then char(47 + N)
                when 47 + N > 126 then char(N-47)
            end as ENCRYPTED_TEXT
        from cteTally
        where N between 33 and 126) e on e.DECIMAL_VALUE = s.N
        where s.ID = t.ID
        FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'), 1, 0, '')
from @table t

--or if you want really random
select 
    PLAIN_TEXT
    ,ENCRYPTED_TEXT =
        stuff((
        select
            --s.Val
            --,s.N
            e.ENCRYPTED_TEXT
         from #staging s
        left join(
        select 
            N as DECIMAL_VALUE
            ,char(N) as ASCII_VALUE
            ,char((select ROUND(((122 - N -1) * RAND() + N), 0))) as ENCRYPTED_TEXT
        from cteTally
        where (N between 65 and 122) and N not in (91,92,93,94,95,96)) e on e.DECIMAL_VALUE = s.N
        where s.ID = t.ID
        FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'), 1, 0, '')
from @table t 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-05-13T02:34:12.677

另一个生成成形假数据集的站点，带有 T-SQL 输出选项： [https ://mockaroo.com/](https://mockaroo.com/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-03T21:08:12.120

坦率地说，我不确定为什么需要这样做。您的开发/测试环境应该是私有的，位于防火墙后面，并且不能从 Web 访问。

您的开发人员应该受到信任，如果他们不辜负您的信任，您可以对他们进行法律追索。

我认为真正的问题应该是“我应该打乱数据吗？”，答案是（在我看来）“不”。

如果您出于某种原因将其发送到异地，或者您必须让您的环境可以通过网络访问，或者如果您偏执，我会实施随机切换。与其构建临时表，不如在每个位置和表中的随机行之间运行切换，一次交换一条数据。

最终结果将是一个包含所有相同数据的表，但它是随机重组的。我相信它也应该比你的临时表快。

[在 SQL 中实现Fisher-Yates Shuffle](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)应该足够简单......或者至少在读取数据库并写入目标的控制台应用程序中。

编辑 (2)：T-SQL 中的即兴回答：

声明 @name varchar(50) set @name = (SELECT lastName from person where personID = (random id number) Update person set lastname = @name WHERE personID = (person id of current row)

将其包装在一个循环中，并按照 Fisher-Yates 的指导方针修改随机值约束，您将被设置。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-10-28T20:21:20.363

我现在正在我的公司从事这项工作——结果证明这是一件非常棘手的事情。您希望拥有真实的名称，但不得透露任何真实的个人信息。

我的方法是首先创建姓氏到其他姓氏的随机“映射”，然后使用该映射来更改所有姓氏。如果您有重复的姓名记录，这很好。假设您有 2 条“John Smith”记录，它们都代表同一个真实的人。如果您将一条记录更改为“John Adams”，另一条更改为“John Best”，那么您的一个“人”现在有 2 个不同的名称！通过映射，所有出现的“Smith”都会更改为“Jones”，因此重复项（甚至家庭成员）仍以相同的姓氏结束，从而使数据更加“真实”。

我还必须打乱地址、电话号码、银行帐号等……我不确定我将如何处理这些。在加扰时保持数据“真实”无疑是一个深刻的话题。这一定是很多公司做过很多次了——谁以前做过？你学到了什么？

# algorithm - 插入项目或将它们添加到排序列表后排序列表是否更快

> ID：168891
> 
> 赞同：86
> 
> 时间：2008-10-03T21:02:19.963
> 
> 标签：algorithm, sorting, list

如果我有一个排序列表（比如要排序的快速排序），如果我要添加很多值，最好暂停排序，并将它们添加到末尾，然后排序，或者使用二进制印章正确放置项目，同时添加它们。如果这些项目是随机的，或者已经或多或少按顺序排列，这会有所不同吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-10-03T21:29:12.627

如果您添加了足够多的项目以有效地从头开始构建列表，那么您应该能够通过事后对列表进行排序来获得更好的性能。

如果项目大部分是有序的，您可以调整增量更新和定期排序以利用这一点，但坦率地说，这通常不值得麻烦。（你还需要小心一些事情，比如确保一些意外的排序不会让你的算法花费*更长*的时间，qv naive quicksort）

增量更新和常规列表排序都是 O(N log N) 但是你可以得到一个更好的常数因子排序之后的所有内容（我在这里假设你有一些辅助数据结构，所以你的增量更新可以比 O 更快地访问列表项（N）...）。一般来说，一次性排序比保持增量排序具有更多的设计自由度，因为增量更新必须始终保持完整的顺序，而一次性批量排序则不需要。

如果不出意外，请记住有许多高度优化的批量排序可用。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-03T21:05:53.920

[通常使用堆](http://en.wikipedia.org/wiki/Heap_(data_structure))要好得多。简而言之，它将维持订单的成本分摊在推送者和拣选者之间。与大多数其他解决方案一样，这两个操作都是 O(log n)，而不是 O(n log n)。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-04T15:23:32.737

如果要添加成束，则可以使用合并排序。对要添加的项目列表进行排序，然后从两个列表中复制，比较项目以确定接下来要复制的项目。如果调整目标数组的大小并从头向后工作，您甚至可以就地复制。

此解决方案的效率为 O(n+m) + O(m log m)，其中 n 是原始列表的大小，m 是要插入的项目数。

**编辑：**由于这个答案没有得到任何爱，我想我会用一些 C++ 示例代码来充实它。我假设排序列表保存在链表而不是数组中。这将算法更改为看起来更像是插入而不是合并，但原理是相同的。

```
// Note that itemstoadd is modified as a side effect of this function
template<typename T>
void AddToSortedList(std::list<T> & sortedlist, std::vector<T> & itemstoadd)
{
    std::sort(itemstoadd.begin(), itemstoadd.end());
    std::list<T>::iterator listposition = sortedlist.begin();
    std::vector<T>::iterator nextnewitem = itemstoadd.begin();
    while ((listposition != sortedlist.end()) || (nextnewitem != itemstoadd.end()))
    {
        if ((listposition == sortedlist.end()) || (*nextnewitem < *listposition))
            sortedlist.insert(listposition, *nextnewitem++);
        else
            ++listposition;
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-03T21:07:32.480

原则上，创建树比排序列表更快。每个插入的树插入为 O(log(n))，导致总体 O(n *log(n))。在 O(n* log(n)) 中排序。

这就是 Java 具有 TreeMap 的原因（除了 List 的 TreeSet、TreeList、ArrayList 和 LinkedList 实现之外。）

*   TreeSet 将事物保持在对象比较顺序中。键由 Comparable 接口定义。

*   LinkedList 将事物保持在插入顺序中。

*   ArrayList 使用更多内存，对于某些操作来说更快。

*   类似地，TreeMap 消除了按键排序的需要。该映射在插入期间按键顺序构建，并始终按排序顺序维护。

但是，出于某种原因，TreeSet 的 Java 实现比使用 ArrayList 和排序要慢很多。

[很难推测为什么它会显着变慢，但确实如此。一次通过数据应该会稍微快一些。这种事情往往是内存管理的成本胜过算法分析。]

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-08T12:51:44.197

我会说，让我们测试一下！:)

我尝试使用快速排序，但使用快速排序对几乎排序的数组进行排序是……好吧，这不是一个好主意。我尝试了一个修改过的，截断了 7 个元素并为此使用了插入排序。仍然，可怕的表现。我切换到合并排序。它可能需要相当多的内存进行排序（它不是就地的），但排序数组的性能要好得多，随机数组的性能几乎相同（两者的初始排序几乎相同，快速排序只是稍微快一点）。

这已经表明了一件事：您的问题的答案很大程度上取决于您使用的排序算法。如果它在几乎排序的列表上表现不佳，在正确的位置插入会比在末尾添加然后重新排序要快得多；并且合并排序可能不是您的选择，因为如果列表很大，它可能需要太多的外部内存。顺便说一句，我使用了一个自定义合并排序实现，它只使用 1/2 的外部存储来实现天真的实现（它需要与数组大小本身一样多的外部存储）。

如果合并排序不是选项并且快速排序肯定不是选项，那么最好的选择可能是堆排序。

我的结果是：在末尾简单地添加新元素，然后重新排序数组比将它们插入到正确的位置要快几个数量级。但是，我的初始数组有 10 个 mio 元素（已排序），而我正在添加另一个 mio（未排序）。因此，如果您将 10 个元素添加到 10 个 mio 的数组中，正确插入它们比重新排序所有内容要快得多。因此，您的问题的答案还取决于初始（已排序）数组有多大以及您要添加多少新元素。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T21:06:17.633

差不多。将一个项目插入排序列表是 O(log N)，并且对列表中的每个元素 N 执行此操作（从而构建列表）将是 O(N log N)，这是快速排序（或合并排序）的速度更接近这种方法）。

如果您将它们插入到前面，它将是 O(1)，但之后进行快速排序，它仍然是 O(N log N)。

我会采用第一种方法，因为它有可能会稍微快一些。如果列表的初始大小 N 远大于要插入的元素数 X，则插入方法为 O(X log N)。插入到列表头部后的排序是 O(N log N)。如果 N=0（即：你的列表最初是空的），则按排序顺序插入或之后排序的速度是相同的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T21:07:13.013

如果列表 a) 已经排序，并且 b) 本质上是动态的，那么插入排序列表应该总是更快（找到正确的位置 (O(n)) 并插入 (O(1))）。

但是，如果列表是静态的，则必须对列表的其余部分进行洗牌（O(n) 找到正确的位置，O(n) 向下滑动）。

无论哪种方式，插入排序列表（或类似二叉搜索树）应该更快。

O(n) + O(n) 应该总是比 O(N log n) 快。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-04T00:29:07.567

将项目插入排序列表需要`O(n)`时间，而不是`O(log n)`时间。您必须花时间找到放置它的地方`O(log n)`。但是你必须转换所有的元素——花`O(n)`时间。因此，在保持排序的同时插入是`O(n ^ 2)`，而将它们全部插入然后排序是`O(n log n)`。

根据您的排序实现，您可以获得比`O(n log n)`插入数量远小于列表大小的情况更好的结果。但如果是这样的话，无论哪种方式都无关紧要。

如果插入的数量很大，请执行全部插入和排序解决方案，否则可能无关紧要。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-25T21:04:34.603

在较高的层次上，这是一个非常简单的问题，因为您可以将排序视为迭代搜索。当您想将一个元素插入到有序数组、列表或树中时，您必须搜索插入它的点。然后你把它放进去，希望成本低。所以你可以把排序算法想象成只是把一堆东西一个一个地寻找合适的位置并插入它们。因此，插入排序（O（n * n））是迭代线性搜索（O（n））。树、堆、合并、基数和快速排序 (O(n*log(n))) 可以被认为是迭代二进制搜索 (O(log(n)))。如果底层搜索是 O(1)，就像在有序哈希表中一样，则可以进行 O(n) 排序。（这方面的一个例子是通过将 52 张卡片扔到 52 个垃圾箱中来对它们进行分类。）

所以你的问题的答案是，一次插入一个东西，而不是保存它们然后对它们进行排序，在大 O 意义上应该没有太大区别。当然，您可能需要处理恒定的因素，而这些因素可能很重要。

当然，如果 n 很小，比如 10，那么整个讨论都是愚蠢的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-03T21:07:39.767

您应该先添加它们，然后使用基数排序，这应该是最佳的

[http://en.wikipedia.org/wiki/Radix_sort#Efficiency](http://en.wikipedia.org/wiki/Radix_sort#Efficiency)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-03T21:11:32.723

（如果您正在谈论的列表类似于 C# `List<T>`。）将一些值添加到具有许多值的排序列表中的正确位置将需要更少的操作。但是，如果要添加的值的数量变大，则需要更多。

我建议您不要使用列表，而是使用一些更合适的数据结构。比如二叉树。插入时间最短的排序数据结构。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-10-03T21:09:47.390

如果这是 .NET 并且项目是整数，则将它们添加到 Dictionary 会更快（或者如果您使用 .Net 3.0 或更高版本，如果您不介意丢失重复项，请使用 HashSet）这为您提供了自动排序。

我认为字符串也会以同样的方式工作。美妙之处在于您以这种方式获得 O(1) 插入和排序。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2008-10-03T21:05:57.163

将一个项目插入排序列表是 O(log n)，而对列表进行排序是 O(n log N) 这表明最好先排序然后插入

但是请记住，大“O”只涉及速度与项目数量的比例关系，对于您的应用程序来说，中间的插入可能是昂贵的（例如，如果它是一个向量），因此之后的附加和排序可能会更好。

# c# - 如何在不知道名称/类型的情况下添加 SqlParameters？

> ID：168892
> 
> 赞同：1
> 
> 时间：2008-10-03T21:02:22.913
> 
> 标签：c#, .net, ado.net

我正在创建一个 DB 包装器，并且需要将 SQL 参数添加到我的 stament 中，但是我不知道参数名称或类型，如何做到这一点？我见过许多其他图书馆这样做......

我只想将值的顺序映射到存储过程......我认为下面的代码可以工作：

```
public DataTable ExecuteDataTable(string storedProcName, params object[] args)
{
    SqlCommand cmd = new SqlCommand(storedProcName, conn);
    cmd.CommandType = CommandType.StoredProcedure;

    // inserting params like this does not work...
    for (int i = 0; i < args.Length; i++)
    {
        cmd.Parameters.Insert(i, args[0]);
    }

    DataTable dt = new DataTable();
    dt.Load(cmd.ExecuteReader());

    return dt;
} 
```

关于如何做到这一点的任何想法？注意：我知道还有其他库（例如 Enterprise Library）已经这样做了，但我处于这种情况无济于事......

谢谢。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2008-10-03T21:07:13.887

[在这里试试](https://stackoverflow.com/questions/33761/how-can-i-retrieve-a-list-of-parameters-from-a-stored-procedure-in-sql-server)

# c# - 在性能方面有什么更好的？类型[,] 还是类型[][]？

> ID：168897
> 
> 赞同：5
> 
> 时间：2008-10-03T21:04:23.797
> 
> 标签：c#, performance, arrays

在 C# 中使用二维数组 ( `type[,]`) 还是数组数组 ( ) 性能更高？`type[][]`

特别是对于初始分配和项目访问

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-04T08:10:32.363

当然，如果一切都失败了......测试它！以下给出（在控制台的“发布”中）：

```
Size 1000, Repeat 1000
    int[,] set: 3460
    int[,] get: 4036 (chk=1304808064)
    int[][] set: 2441
    int[][] get: 1283 (chk=1304808064) 
```

所以锯齿状数组更快，至少在这个测试中。有趣的！然而，这是一个*相对*较小的因素，所以我仍然会坚持更好地描述我的要求。除了一些特定的（高 CPU/处理）场景，可读性/可维护性应该胜过小的性能提升。不过，由你决定。

请注意，此测试假设您访问数组的次数比创建数组的次数要多得多，因此我没有包括创建时间，我*希望*矩形会稍微快一些，除非内存高度碎片化。

```
using System;
using System.Diagnostics;
static class Program
{
    static void Main()
    {
        Console.WriteLine("First is just for JIT...");
        Test(10,10);
        Console.WriteLine("Real numbers...");
        Test(1000,1000);

        Console.ReadLine();
    }

    static void Test(int size, int repeat)
    {
        Console.WriteLine("Size {0}, Repeat {1}", size, repeat);
        int[,] rect = new int[size, size];
        int[][] jagged = new int[size][];
        for (int i = 0; i < size; i++)
        { // don't count this in the metrics...
            jagged[i] = new int[size];
        }
        Stopwatch watch = Stopwatch.StartNew();
        for (int cycle = 0; cycle < repeat; cycle++)
        {
            for (int i = 0; i < size; i++)
            {
                for (int j = 0; j < size; j++)
                {
                    rect[i, j] = i * j;
                }
            }
        }
        watch.Stop();
        Console.WriteLine("\tint[,] set: " + watch.ElapsedMilliseconds);

        int sum = 0;
        watch = Stopwatch.StartNew();
        for (int cycle = 0; cycle < repeat; cycle++)
        {
            for (int i = 0; i < size; i++)
            {
                for (int j = 0; j < size; j++)
                {
                    sum += rect[i, j];
                }
            }
        }
        watch.Stop();
        Console.WriteLine("\tint[,] get: {0} (chk={1})", watch.ElapsedMilliseconds, sum);

        watch = Stopwatch.StartNew();
        for (int cycle = 0; cycle < repeat; cycle++)
        {
            for (int i = 0; i < size; i++)
            {
                for (int j = 0; j < size; j++)
                {
                    jagged[i][j] = i * j;
                }
            }
        }
        watch.Stop();
        Console.WriteLine("\tint[][] set: " + watch.ElapsedMilliseconds);

        sum = 0;
        watch = Stopwatch.StartNew();
        for (int cycle = 0; cycle < repeat; cycle++)
        {
            for (int i = 0; i < size; i++)
            {
                for (int j = 0; j < size; j++)
                {
                    sum += jagged[i][j];
                }
            }
        }
        watch.Stop();
        Console.WriteLine("\tint[][] get: {0} (chk={1})", watch.ElapsedMilliseconds, sum);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T21:25:09.107

我相信 [,] 可以分配一个连续的内存块，而 [][] 是 N+1 个块分配，其中 N 是第一个维度的大小。所以我猜想 [,] 在初始分配时更快。

访问可能大致相同，除了 [][] 将涉及一个额外的取消引用。除非你处于一个非常紧的循环中，否则它可能是一个洗涤。现在，如果您正在执行诸如图像处理之类的事情，您在行*之间*引用而不是逐行遍历，则引用的局部性将发挥重要作用，并且 [,] 可能会根据您的缓存大小而超出 [][] 。

正如 Marc Gravell 提到的，使用是评估性能的关键......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-04T08:25:06.013

这真的取决于。MSDN 杂志的文章*[Harness the Features of C# to Power Your Scientific Computing Projects](http://msdn.microsoft.com/en-ca/magazine/cc163995.aspx)*说：

> 尽管矩形阵列在结构和性能方面通常优于锯齿状阵列，但在某些情况下锯齿状阵列可能会提供最佳解决方案。如果您的应用程序不需要对数组进行排序、重新排列、分区、稀疏或较大，那么您可能会发现锯齿状数组的性能非常好。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-03T21:25:26.970

type[,] 会工作得更快。不仅因为偏移量计算更少。主要是因为更少的约束检查、更少的内存分配和更大的内存本地化。type[][] 不是单个对象——它是必须分配的 1 + N 个对象，并且可以彼此远离。

# c# - 计算 IEnumerable 中的项目 没有迭代？

> ID：168901
> 
> 赞同：347
> 
> 时间：2008-10-03T21:05:03.580
> 
> 标签：c#, .net, ienumerable

```
private IEnumerable<string> Tables
{
    get
    {
        yield return "Foo";
        yield return "Bar";
    }
} 
```

假设我想对这些进行迭代并编写诸如处理#n of #m 之类的东西。

有没有办法在我的主迭代之前不迭代就可以找出 m 的值？

我希望我说清楚了。

* * *

## 回答 #1

> 赞同：373
> 
> 时间：2008-10-03T21:08:33.977

`IEnumerable`不支持这个。这是设计使然。`IEnumerable`使用惰性求值在您需要之前获取您要求的元素。

如果您想知道项目的数量而不对其进行迭代，您可以使用`ICollection<T>`，它有一个`Count`属性。

* * *

## 回答 #2

> 赞同：248
> 
> 时间：2009-05-12T15:48:20.857

`System.Linq.Enumerable.Count`扩展方法 on具有以下`IEnumerable<T>`实现：

```
ICollection<T> c = source as ICollection<TSource>;
if (c != null)
    return c.Count;

int result = 0;
using (IEnumerator<T> enumerator = source.GetEnumerator())
{
    while (enumerator.MoveNext())
        result++;
}
return result; 
```

因此，它尝试强制转换为`ICollection<T>`具有`Count`属性的 ，并在可能的情况下使用该属性。否则它会迭代。

所以你最好的办法是`Count()`在你的对象上使用扩展方法`IEnumerable<T>`，因为这样你会得到最好的性能。

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2008-10-04T03:49:04.277

只需添加一些额外的信息：

`Count()`扩展并不总是迭代。考虑 Linq to Sql，其中计数进入数据库，但不是带回所有行，而是发出 Sql`Count()`命令并返回该结果。

此外，编译器（或运行时）足够聪明，`Count()`如果它有一个对象方法，它就会调用它。所以它*不像*其他响应者所说的那样，完全无知并且总是为了计算元素而迭代。

在程序员只是`if( enumerable.Count != 0 )`使用`Any()`扩展方法检查的许多情况下，使用`if( enumerable.Any() )` linq 的惰性求值效率要高得多，因为一旦确定存在任何元素，它就会短路。它也更具可读性

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-10-03T21:18:39.120

我的一个朋友有一系列博客文章，说明了为什么你不能这样做。他创建了一个返回 IEnumerable 的函数，其中每次迭代都返回下一个素数，一直到`ulong.MaxValue`，并且在您要求之前不会计算下一个项目。快速，流行的问题：返回了多少项目？

这是帖子，但它们有点长：

1.  [Beyond Loops](http://www.fallingcanbedeadly.com/posts/beyond-loops)（提供其他帖子中使用的初始 EnumerableUtility 类）
2.  [Iterate的应用](http://www.fallingcanbedeadly.com/posts/applications-of-iterate)（初步实现）
3.  [疯狂的扩展方法：ToLazyList](http://www.fallingcanbedeadly.com/posts/crazy-extention-methods-tolazylist)（性能优化）

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-05-12T15:35:35.417

或者，您可以执行以下操作：

```
Tables.ToList<string>().Count; 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-10-03T21:40:29.683

IEnumerable 不迭代就无法计数。

在“正常”情况下，实现 IEnumerable 或 IEnumerable<T> 的类（例如 List<T>）可以通过返回 List<T>.Count 属性来实现 Count 方法。但是，Count 方法实际上并不是在 IEnumerable<T> 或 IEnumerable 接口上定义的方法。（事实上​​，唯一的一个是 GetEnumerator。）这意味着不能为其提供特定于类的实现。

相反，Count 它是一个扩展方法，定义在静态类 Enumerable 上。这意味着它可以在 IEnumerable<T> 派生类的任何实例上调用，无论该类的实现如何。但这也意味着它是在任何这些类之外的一个地方实现的。这当然意味着它必须以完全独立于这些类的内部结构的方式实现。进行计数的唯一方法是通过迭代。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-10-03T21:07:40.233

不，一般不会。使用枚举的一点是枚举中的实际对象集是未知的（事先，甚至根本不知道）。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2012-01-26T19:02:13.763

您可以使用 System.Linq。

```
using System;
using System.Collections.Generic;
using System.Linq;

public class Test
{
    private IEnumerable<string> Tables
    {
        get {
             yield return "Foo";
             yield return "Bar";
         }
    }

    static void Main()
    {
        var x = new Test();
        Console.WriteLine(x.Tables.Count());
    }
} 
```

你会得到结果'2'。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2020-04-18T02:56:51.223

我认为最简单的方法是做到这一点

```
Enumerable.Count<TSource>(IEnumerable<TSource> source) 
```

参考：[system.linq.enumerable](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.count?view=netframework-4.8)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-05-12T15:56:18.550

除了您的直接问题（已彻底否定回答）之外，如果您希望在处理可枚举时报告进度，您可能需要查看我的博客文章[在 Linq 查询期间报告进度](http://blog.functionalfun.net/2008/07/reporting-progress-during-linq-queries.html)。

它可以让你这样做：

```
BackgroundWorker worker = new BackgroundWorker();
worker.WorkerReportsProgress = true;
worker.DoWork += (sender, e) =>
      {
          // pretend we have a collection of 
          // items to process
          var items = 1.To(1000);
          items
              .WithProgressReporting(progress => worker.ReportProgress(progress))
              .ForEach(item => Thread.Sleep(10)); // simulate some real work
      }; 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-11-02T07:58:29.873

我在方法中使用了这种方式来检查传入的`IEnumberable`内容

```
if( iEnum.Cast<Object>().Count() > 0) 
{

} 
```

在这样的方法中：

```
GetDataTable(IEnumberable iEnum)
{  
    if (iEnum != null && iEnum.Cast<Object>().Count() > 0) //--- proceed further

} 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2011-04-25T05:18:23.793

这取决于 .Net 的版本和 IEnumerable 对象的实现。Microsoft 已修复 IEnumerable.Count 方法来检查实现，并使用 ICollection.Count 或 ICollection<TSource>.Count，请参阅此处的详细信息[https://connect.microsoft.com/VisualStudio/feedback/details/454130](https://connect.microsoft.com/VisualStudio/feedback/details/454130)

下面是来自 Ildasm 的 System.Core 的 MSIL，System.Linq 位于其中。

```
.method public hidebysig static int32  Count<TSource>(class 

[mscorlib]System.Collections.Generic.IEnumerable`1<!!TSource> source) cil managed
{
  .custom instance void System.Runtime.CompilerServices.ExtensionAttribute::.ctor() = ( 01 00 00 00 ) 
  // Code size       85 (0x55)
  .maxstack  2
  .locals init (class [mscorlib]System.Collections.Generic.ICollection`1<!!TSource> V_0,
           class [mscorlib]System.Collections.ICollection V_1,
           int32 V_2,
           class [mscorlib]System.Collections.Generic.IEnumerator`1<!!TSource> V_3)
  IL_0000:  ldarg.0
  IL_0001:  brtrue.s   IL_000e
  IL_0003:  ldstr      "source"
  IL_0008:  call       class [mscorlib]System.Exception System.Linq.Error::ArgumentNull(string)
  IL_000d:  throw
  IL_000e:  ldarg.0
  IL_000f:  isinst     class [mscorlib]System.Collections.Generic.ICollection`1<!!TSource>
  IL_0014:  stloc.0
  IL_0015:  ldloc.0
  IL_0016:  brfalse.s  IL_001f
  IL_0018:  ldloc.0
  IL_0019:  callvirt   instance int32 class [mscorlib]System.Collections.Generic.ICollection`1<!!TSource>::get_Count()
  IL_001e:  ret
  IL_001f:  ldarg.0
  IL_0020:  isinst     [mscorlib]System.Collections.ICollection
  IL_0025:  stloc.1
  IL_0026:  ldloc.1
  IL_0027:  brfalse.s  IL_0030
  IL_0029:  ldloc.1
  IL_002a:  callvirt   instance int32 [mscorlib]System.Collections.ICollection::get_Count()
  IL_002f:  ret
  IL_0030:  ldc.i4.0
  IL_0031:  stloc.2
  IL_0032:  ldarg.0
  IL_0033:  callvirt   instance class [mscorlib]System.Collections.Generic.IEnumerator`1<!0> class [mscorlib]System.Collections.Generic.IEnumerable`1<!!TSource>::GetEnumerator()
  IL_0038:  stloc.3
  .try
  {
    IL_0039:  br.s       IL_003f
    IL_003b:  ldloc.2
    IL_003c:  ldc.i4.1
    IL_003d:  add.ovf
    IL_003e:  stloc.2
    IL_003f:  ldloc.3
    IL_0040:  callvirt   instance bool [mscorlib]System.Collections.IEnumerator::MoveNext()
    IL_0045:  brtrue.s   IL_003b
    IL_0047:  leave.s    IL_0053
  }  // end .try
  finally
  {
    IL_0049:  ldloc.3
    IL_004a:  brfalse.s  IL_0052
    IL_004c:  ldloc.3
    IL_004d:  callvirt   instance void [mscorlib]System.IDisposable::Dispose()
    IL_0052:  endfinally
  }  // end handler
  IL_0053:  ldloc.2
  IL_0054:  ret
} // end of method Enumerable::Count 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-08-12T16:41:30.623

IEnumerable.Count() 函数的结果可能是错误的。这是一个非常简单的测试示例：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Collections;

namespace Test
{
  class Program
  {
    static void Main(string[] args)
    {
      var test = new[] { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17 };
      var result = test.Split(7);
      int cnt = 0;

      foreach (IEnumerable<int> chunk in result)
      {
        cnt = chunk.Count();
        Console.WriteLine(cnt);
      }
      cnt = result.Count();
      Console.WriteLine(cnt);
      Console.ReadLine();
    }
  }

  static class LinqExt
  {
    public static IEnumerable<IEnumerable<T>> Split<T>(this IEnumerable<T> source, int chunkLength)
    {
      if (chunkLength <= 0)
        throw new ArgumentOutOfRangeException("chunkLength", "chunkLength must be greater than 0");

      IEnumerable<T> result = null;
      using (IEnumerator<T> enumerator = source.GetEnumerator())
      {
        while (enumerator.MoveNext())
        {
          result = GetChunk(enumerator, chunkLength);
          yield return result;
        }
      }
    }

    static IEnumerable<T> GetChunk<T>(IEnumerator<T> source, int chunkLength)
    {
      int x = chunkLength;
      do
        yield return source.Current;
      while (--x > 0 && source.MoveNext());
    }
  }
} 
```

结果必须是 (7,7,3,3) 但实际结果是 (7,7,3,17)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2021-11-03T15:59:27.920

LINQ 中有一种新方法用于 .NET 6 Watch [https://www.youtube.com/watch?v=sIXKpyhxHR8](https://www.youtube.com/watch?v=sIXKpyhxHR8)

```
Tables.TryGetNonEnumeratedCount(out var count) 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-05-12T15:41:50.040

[这是关于惰性评估](http://blogs.msdn.com/ericwhite/pages/Lazy-Evaluation-_2800_and-in-contrast_2C00_-Eager-Evaluation_2900_.aspx)和[延迟执行](http://blogs.msdn.com/ericwhite/pages/deferred-execution.aspx)的精彩讨论。基本上，您必须具体化列表才能获得该值。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2020-01-06T12:14:51.837

我发现的最好方法是通过将其转换为列表来计数。

```
IEnumerable<T> enumList = ReturnFromSomeFunction();

int count = new List<T>(enumList).Count; 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-01-18T10:42:28.450

简化所有答案。

IEnumerable 没有 Count 函数或属性。为此，您可以存储*计数变量*（例如使用 foreach）或使用*Linq*求解以获取计数。

**如果你有：**

IEnumerable<> 产品

**然后：**

声明：“使用 System.Linq；”

**计数：**

products.ToList().Count

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2008-10-04T05:00:20.780

我建议打电话给 ToList。是的，您正在尽早进行枚举，但您仍然可以访问您的项目列表。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2013-06-26T08:39:09.027

它可能不会产生最佳性能，但您可以使用 LINQ 计算 IEnumerable 中的元素：

```
public int GetEnumerableCount(IEnumerable Enumerable)
{
    return (from object Item in Enumerable
            select Item).Count();
} 
```

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2012-01-18T09:51:48.170

我使用`IEnum<string>.ToArray<string>().Length`它，它工作正常。

* * *

## 回答 #21

> 赞同：-6
> 
> 时间：2018-05-07T08:28:36.097

如果我有字符串列表，我会使用这样的代码：

```
((IList<string>)Table).Count 
```

# javascript - 使用 JQuery 只显示一个元素

> ID：168912
> 
> 赞同：2
> 
> 时间：2008-10-03T21:07:20.390
> 
> 标签：javascript, jquery

单击链接时，我一次只需要显示一个元素。现在我通过再次隐藏所有内容然后切换单击的元素来作弊。这行得通，除非我希望一切都再次消失。如果没有添加“全部隐藏”按钮/链接，我该怎么办？我希望能够再次单击该链接，并隐藏它的内容。

编辑：伪代码本来可以工作，但这里的 html 错误地让您相信所有链接都在一个 div 中。与其追踪他们都在哪里，更容易通过他们的 ID 呼叫他们。

这是我到目前为止所拥有的：

```
$(document).ready(function(){
    //hides everything
    $("#infocontent *").hide();

    //now we show them by which they click on
    $("#linkjoedhit").click(function(event){
      $("#infocontent *").hide();
      $("#infojoedhit").toggle();
      return false;
    });

    $("#linkgarykhit").click(function(event){
      $("#infocontent *").hide();
      $("#infogarykhit").toggle();
      return false;
    });

}); 
```

html看起来像：

```
<div id="theircrappycode">
    <a id="linkjoedhit" href="">Joe D</a><br/>
    <a id="linkgarykhit" href="">Gary K</a>
</div>

<div id="infocontent">
    <p id="infojoedhit">Information about Joe D Hitting.</p>
    <p id="infogarykhit">Information about Gary K Hitting.</p>
</div 
```

大约有20个这样的链接。因为我没有对实际的 html 进行编码，所以我无法控制实际的布局，这太可怕了。可以说，这是组织链接/信息的唯一方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T21:50:39.493

```
$("#linkgarykhit").click(function(){
   if($("#infogarykhit").css('display') != 'none'){
      $("#infogarykhit").hide();
   }else{
      $("#infocontent *").hide();
      $("#infogarykhit").show();
   }
   return false;
}); 
```

* * *

我们也可以稍微[干燥](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)一下：

```
function toggleInfoContent(id){
   if($('#' + id).css('display') != 'none'){
      $('#' + id).hide();
   }else{
      $("#infocontent *").hide();
      $('#' + id).show();
   }
}

$("#linkgarykhit").click(function(){
    toggleInfoContent('infogarykhit');
    return false;
});

$("#linkbobkhit").click(function(){
    toggleInfoContent('infobobkhit');
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T22:34:32.027

如果你的标记“命名方案”是准确的，你可以通过为你的选择器使用正则表达式来避免大量重复的代码，并明智地使用 jQuery 的“不”。

您可以将一个单击事件附加到一个 jQuery 集合，该集合应该执行您想要的操作，因此您不需要添加任何 JavaScript，因为您添加了更多 Jim 或 John 的，如下所示：

```
$(document).ready( function () {
  $("#infocontent *").hide();

  $("div#theircrappycode > a").click(function(event){
    var toggleId = "#" + this.id.replace(/^link/,"info");
    $("#infocontent *").not(toggleId).hide();
    $(toggleId).toggle();
    return false;
  });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-04T07:52:39.683

这是一种略有不同的方法，与 Pseudo Masochist 的代码有一些相似之处。

```
$(document).ready(function(){
  $("#infocontent *").hide();
  $("#theircrappycode > a").click(statlink.togvis);
});
var statlink = {
  visId: "",
  togvis: function(){
    $("#" + statlink.visId).toggle();
    statlink.visId = $(this).attr("id").replace(/link/, "info");
    $("#" + statlink.visId).toggle();
  }
}; 
```

希望你也觉得这很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T21:59:19.773

我刚开始`jQuery`，所以我不知道这是否愚蠢。

```
function DoToggleMagic(strParagraphID) {
  strDisplayed = $(strParagraphID).css("display");
  $("#infocontent *").hide();
  if (strDisplayed == "none") 
    $(strParagraphID).toggle();
}
$(document).ready(function(){
  //hides everything
  $("#infocontent *").hide();

  //now we show them by which they click on
  $("#linkjoedhit").click(function(event){
    DoToggleMagic("#infojoedhit");
    return false;
  });

  $("#linkgarykhit").click(function(event){
    DoToggleMagic("#infogarykhit");
    return false;
  });        
}); 
```

# javascript - 如何在 JavaScript 中呈现两个时间戳之间的上下文差异？

> ID：168924
> 
> 赞同：5
> 
> 时间：2008-10-03T21:08:55.660
> 
> 标签：javascript, jquery, datetime, time

假设我在 JavaScript 中有两个字符串：

```
var date1 = '2008-10-03T20:24Z'
var date2 = '2008-10-04T12:24Z' 
```

我怎么会得出这样的结果：

```
'4 weeks ago' 
```

或者

```
'in about 15 minutes' 
```

（应该支持过去和未来）。

过去的差异有解决方案，但我还没有找到一个支持未来时间差异的解决方案。

这些是我尝试过的解决方案：

[John Resig 的 Pretty Date](http://ejohn.org/blog/javascript-pretty-date/#postcomment)和[Zach Leatherman 的修改](http://www.zachleat.com/web/2008/03/23/yet-another-pretty-date-javascript/)

jQuery 解决方案的奖励积分。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-03T21:41:17.203

查看您链接的解决方案...实际上就像我的轻浮评论一样简单！

这是 Zach Leatherman 代码的一个版本，它为您的未来日期添加了“In”。如您所见，更改非常小。

```
 function humane_date(date_str){
      var time_formats = [
          [60, 'Just Now'],
          [90, '1 Minute'], // 60*1.5
          [3600, 'Minutes', 60], // 60*60, 60
          [5400, '1 Hour'], // 60*60*1.5
          [86400, 'Hours', 3600], // 60*60*24, 60*60
          [129600, '1 Day'], // 60*60*24*1.5
          [604800, 'Days', 86400], // 60*60*24*7, 60*60*24
          [907200, '1 Week'], // 60*60*24*7*1.5
          [2628000, 'Weeks', 604800], // 60*60*24*(365/12), 60*60*24*7
          [3942000, '1 Month'], // 60*60*24*(365/12)*1.5
          [31536000, 'Months', 2628000], // 60*60*24*365, 60*60*24*(365/12)
          [47304000, '1 Year'], // 60*60*24*365*1.5
          [3153600000, 'Years', 31536000], // 60*60*24*365*100, 60*60*24*365
          [4730400000, '1 Century'], // 60*60*24*365*100*1.5
      ];

      var time = ('' + date_str).replace(/-/g,"/").replace(/[TZ]/g," "),
          dt = new Date,
          seconds = ((dt - new Date(time) + (dt.getTimezoneOffset() * 60000)) / 1000),
          token = ' Ago',
          prepend = '',
          i = 0,
          format;

      if (seconds < 0) {
          seconds = Math.abs(seconds);
          token = '';
          prepend = 'In ';
      }

      while (format = time_formats[i++]) {
          if (seconds < format[0]) {
              if (format.length == 2) {
                  return (i>1?prepend:'') + format[1] + (i > 1 ? token : ''); // Conditional so we don't return Just Now Ago
              } else {
                  return prepend + Math.round(seconds / format[2]) + ' ' + format[1] + (i > 1 ? token : '');
              }
          }
      }

      // overflow for centuries
      if(seconds > 4730400000)
          return Math.round(seconds / 4730400000) + ' Centuries' + token;

      return date_str;
  }; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T06:54:15.120

嘿-实际上我昨天写了一个函数来做这件事（它不在这台电脑上，所以我只需要试着记住它）

我扩展了 Date 原型类，但这可以很容易地放入常规函数中。

```
Date.prototype.toRelativeTime = function(otherTime) {
    // if no parameter is passed, use the current date.
    if (otherTime == undefined) otherTime = new Date();

    var diff = Math.abs(this.getTime() - otherTime.getTime()) / 1000;

    var MIN = 60,        // some "constants" just 
        HOUR = 3600,     // for legibility
        DAY = 86400
    ;
    var out, temp;
    if (diff < MIN) {
        out = "Less than a minute";

    } else if (diff < 15 * MIN) {
        // less than fifteen minutes, show how many minutes
        temp = Math.round(diff / MIN);
        out = temp + " minute" + (temp == 1 ? "" : "s");
        // eg: 12 minutes
    } else if (diff < HOUR) {
        // less than an hour, round down to the nearest 5 minutes
        out = (Math.floor(diff / (5 * MIN)) * 5) + " minutes";
    } else if (diff < DAY) {
        // less than a day, just show hours
        temp = Math.round(diff / HOUR);
        out = temp + " hour" + (temp == 1 ? "" : "s");
    } else if (diff < 30 * DAY) {
        // show how many days ago
        temp = Math.round(diff / DAY);
        out = temp + " day" + (temp == 1 ? "" : "s");
    } else if (diff < 90 * DAY) {
        // more than 30 days, but less than 3 months, show the day and month
        return this.getDate() + " " + this.getShortMonth();  // see below
    } else {
        // more than three months difference, better show the year too
        return this.getDate() + " " + this.getShortMonth() + " " + this.getFullYear();
    }
    return out + (this.getTime() > otherTime.getTime() ? " from now" : " ago");

};

Date.prototype.getShortMonth = function() {
    return ["Jan", "Feb", "Mar",
            "Apr", "May", "Jun",
            "Jul", "Aug", "Sep",
            "Oct", "Nov", "Dec"][this.getMonth()];
};

// sample usage:
var x = new Date(2008, 9, 4, 17, 0, 0);
alert(x.toRelativeTime());    // 9 minutes from now

x = new Date(2008, 9, 4, 16, 45, 0, 0);
alert(x.toRelativeTime());    // 6 minutes ago

x = new Date(2008, 11, 1);    // 1 Dec

x = new Date(2009, 11, 1);    // 1 Dec 2009 
```

# php - 有谁知道可以处理 Flash/Flex 内容的渐进增强的 php 框架？

> ID：168926
> 
> 赞同：0
> 
> 时间：2008-10-03T21:09:14.863
> 
> 标签：php, apache-flex, flash, actionscript-3, progressive-enhancement

好的，我在这里松散地使用术语“渐进增强”，但基本上我有一个基于 Flash 的网站，它支持深度链接并动态加载内容 - 我想做的是为那些提供替代内容（文本）要么没有 Flash，要么用于搜索引擎机器人。因此，对于使用 flash 的用户，他们将导航到：

```
http://www.samplesite.com/#specific_page 
```

他们会看到一个可以导航到“ `specific_page`.”的Flash站点。那些没有 flash 的人会`specific_page`在替代内容部分看到以文本形式呈现的“”。

基本上，我会使用 php/mysql 创建一个后端来处理所有这些，因为 swf 也使用动态数据。问题是，是否存在已经存在的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T22:08:34.980

好吧，根据[OSFlash](http://osflash.org/open_source_flash_projects)（开源 Flash 人）的说法， [CakePHP](http://cakephp.org/)和[PHPWCMS](http://www.phpwcms.de/)都可以满足您的需求，尽管乍一看他们网站的功能列表，这并不完全明显。

让我们知道他们***是否***有效！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T22:13:48.340

您要实现的目标存在固有问题。

URL 哈希（或锚点）仅在客户端 - 该令牌不会发送到服务器。这意味着（据我所知）加载 example.com/#some_page 所需内容的唯一方法是使用 AJAX，它可以读取哈希，然后从服务器请求特定于页面的数据。

完毕？不，因为这会杀死搜索引擎机器人。一种可能的解决方案是让 example.com/some_page 提供相同的内容（事实上，这很容易成为您已经创建的用于返回 AJAX 或 Flash 请求的内容的 REST 服务），并提供一个[sitemap.xml](http://www.sitemaps.org/)索引这些 URI 以帮助搜索引擎。

我知道没有专门执行这些任务的现有框架，尽管看起来确实可以让一个框架没有太多麻烦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-06T21:48:59.553

如果您将 SWFAddress 与 Flash/Flex 一起使用，那么您可以读取 URL，然后将其拆分为一个数组并按照您的意愿进行操作：

```
SWFAddress.addEventListener ( SWFAddressEvent.CHANGE, onChange );
private function onChange ( e : SWFAddressEvent ) : void 
{
     var ar : Array = SWFAddress.getValue ().split ( '/' );
     trace ( 'Array : ', ar );
} 
```

对于您的非闪存内容，如果您使用代码点火器，您也可以提取 url 并将其转换为数组。

另一种选择是使用 FAUST。您可以使用 FAUST 做的是让 PHP 将 HMTL 作为有效标记呈现，然后 FAUST 将提取 HTML 并通过 Flash Vars 作为 XML 将其传递给 Flash。这种方法让搜索引擎真的很开心（参见[http://www.bartoncreek.com](http://www.bartoncreek.com)）。

因此，要回答您的问题，有一些工具可以帮助您实现目标。

# .net - 使用 NUnit 对 app.config 文件进行单元测试

> ID：168931
> 
> 赞同：61
> 
> 时间：2008-10-03T21:10:50.713
> 
> 标签：.net, unit-testing, nunit

当你们对依赖于 app.config 文件中的值的应用程序进行单元测试时？您如何测试这些值是否被正确读取，以及您的程序如何对输入到配置文件中的错误值做出反应？

不得不修改 NUnit 应用程序的配置文件是荒谬的，但我无法从我想测试的 app.config 中读取值。

编辑：我想我应该澄清一下。我不担心 ConfigurationManager 无法读取值，但我关心的是测试我的程序如何对读取的值做出反应。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-10-03T21:16:03.573

我通常隔离外部依赖项，例如在他们自己的外观类中读取配置文件，功能很少。在测试中，我可以创建这个类的模拟版本，它实现并使用它而不是真正的配置文件。您可以为此创建自己的模型或使用 moq 或 rhino 模型之类的框架。

这样，您可以轻松地尝试使用不同配置值的代码，而无需编写首先编写 xml 配置文件的复杂测试。读取配置的代码通常非常简单，几乎不需要测试。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-11-01T16:03:10.390

您可以在运行时在测试设置中修改配置部分。例如：

```
// setup
System.Configuration.Configuration config = 
     ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
config.Sections.Add("sectionname", new ConfigSectionType());
ConfigSectionType section = (ConfigSectionType)config.GetSection("sectionname");
section.SomeProperty = "value_you_want_to_test_with";
config.Save(ConfigurationSaveMode.Modified);
ConfigurationManager.RefreshSection("sectionname");

// carry out test ... 
```

您当然可以设置自己的辅助方法来更优雅地执行此操作。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2010-12-22T16:02:13.690

您可以调用 ConfigurationManager.AppSettings 的 set 方法来设置该特定单元测试所需的值。

```
[SetUp]
public void SetUp()
{
  ConfigurationManager.AppSettings.Set("SettingKey" , "SettingValue");
  // rest of unit test code follows
} 
```

当单元测试运行时，它将使用这些值来运行代码

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-10-03T21:12:14.797

您可以使用该类读取和写入`app.config`文件`ConfigurationManager`

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-05-19T15:06:38.560

我在使用 web.config 时遇到了类似的问题......我找到了一个有趣的解决方案。您可以封装配置读取功能，例如：

```
public class MyClass {

public static Func<string, string> 
     GetConfigValue = s => ConfigurationManager.AppSettings[s];

//...

} 
```

然后正常使用

```
string connectionString = MyClass.GetConfigValue("myConfigValue"); 
```

但在单元测试中初始化“覆盖”这样的函数：

```
MyClass.GetConfigValue = s =>  s == "myConfigValue" ? "Hi", "string.Empty"; 
```

更多关于它：

[http://rogeralsing.com/2009/05/07/the-simplest-form-of-configurable-dependency-injection/](http://rogeralsing.com/2009/05/07/the-simplest-form-of-configurable-dependency-injection/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-09-22T22:29:57.127

一个更优雅的解决方案是在配置设置本身上使用普通的旧依赖注入。恕我直言，这比必须模拟配置读取类/包装器等更干净。

例如，假设“天气”类需要“ServiceUrl”才能运行（例如，它调用 Web 服务来获取天气）。与其让某些代码行主动转到配置文件以获取该设置（无论该代码是在 Weather 类中还是可以根据其他一些响应模拟的单独配置读取器中），Weather 类可以允许要注入的设置，要么通过构造函数的参数，要么可能通过属性设置器。这样，单元测试就非常简单直接，甚至不需要模拟。

然后可以使用控制反转（或依赖注入）容器注入设置的值，因此 Weather 类的使用者不需要从某个地方显式提供值，因为它是由容器处理的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-03-27T06:48:43.697

这对我有用：

```
 public static void BasicSetup()
  {
     ConnectionStringSettings connectionStringSettings = 
          new ConnectionStringSettings();
     connectionStringSettings.Name = "testmasterconnection";
     connectionStringSettings.ConnectionString = 
          "server=localhost;user=some;database=some;port=3306;";
     ConfigurationManager.ConnectionStrings.Clear();
     ConfigurationManager.ConnectionStrings.Add(connectionStringSettings);
  } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-03T21:13:48.740

您始终可以将读入位包装在接口中，并从配置文件中读取特定的实现。然后，您将使用 Mock Objects 编写测试以查看程序如何处理错误值。就个人而言，我不会测试这个特定的实现，因为这是 .NET Framework 代码（我假设 - 希望 - MS 已经对其进行了测试）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-05-11T13:19:30.783

在测试这类东西时，System.Configuration.Abstractions 是一件美妙的事情。

这是 GitHub 项目站点，其中包含一些很好的示例：[在此处输入链接描述](https://github.com/davidwhitney/System.Configuration.Abstractions)

这是 NuGet 站点：[https ://www.nuget.org/packages/System.Configuration.Abstractions/](https://www.nuget.org/packages/System.Configuration.Abstractions/)

我在几乎所有的 .NET 项目中都使用它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-03T21:12:02.317

实际上，进一步考虑，我想我应该做的是创建一个 ConfigFileReader 类以在我的项目中使用，然后在单元测试工具中伪造它？

这是通常的做法吗？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-03T21:43:51.737

最简单的选项是包装读取配置的方法，以便您可以在测试期间替换值。创建一个用于读取配置的接口，并让该接口的实现作为构造函数参数传入或在对象上设置为属性（就像使用依赖注入/控制反转一样）。在生产环境中，传入一个真正从配置中读取的实现；在测试环境中，传入一个返回已知值的测试实现。

如果您没有为可测试性重构代码的选项，但仍需要对其进行测试，Typemock Isolator 提供了实际模拟 .NET 框架配置类的能力，因此您可以说“下次我要求这样和-这样的 appSettings 值，返回这个已知值。”

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-30T07:36:26.907

我遇到过同样的问题，

你可以使用 Nunit-console.exe c:\path1\testdll1.dll c:\path2\testdll2.dll

即使两个 dll 都指向不同的 app.config，例如 testdll1.dll.config 和 testdll2.dll.config，这也能正常工作

如果您想使用 Nunit 项目配置并包装这两个 dll，那么您将无法拥有两个配置

如果您的 Nunit 项目是 project1.nunit 与 Project1.nunit 所在的位置相同，则您必须拥有 project1.config。

希望这可以帮助

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-04-13T08:20:42.340

好吧，我只是遇到了同样的问题......我想测试一个从网站引用的 BL 项目。但我只想测试 BL。因此，在测试项目的预构建事件中，我将 app.Config 文件复制到 bin\debug 文件夹中，并从 app.config 中引用它们...

# c++ - 如何在 make 依赖文件中包含 IBM XLC 模板 *.c 文件？

> ID：168938
> 
> 赞同：0
> 
> 时间：2008-10-03T21:13:02.703
> 
> 标签：c++, makefile, xlc

对于 XLC 编译器，模板化代码位于 *.c 文件中。然后，当编译使用模板函数的程序时，编译器会在 .c 文件中找到模板定义并实例化它们。

问题是在执行 xlC -qmakedepend 生成构建依赖项时，默认情况下不包含这些 .c 文件。因此，如果您更改其中一个 .c 文件，您将不会自动构建依赖它的所有内容。

有没有人找到解决这个问题的好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T17:42:12.753

简而言之，答案是使用 XLC 的 tempinc 实用程序进行迁移。

tempinc 实用程序要求您使用头文件（.h 或 .hpp）中的模板声明和 .c 文件中的实现来设置文件（此扩展名是强制性的）。当编译器找到模板实例化时，它将显式实例化放在您的 tempinc 目录中的另一个源文件中，强制为它们生成代码。编译器知道在 foo.c 中找到在 foo.h 中声明的模板定义。

我指定的问题是依赖项构建器不知道这一点，因此无法将您的 .c 文件包含在依赖项中。

对于版本 6.0 [，IBM 建议使用 -qtemplateregistry 设置](http://www.redbooks.ibm.com/redbooks/SG245674/wwhelp/wwhimpl/js/html/wwhelp.htm)而不是 -qtempinc。然后，您可以使用一个典型的模板设置，将模板定义包含在您的头文件中，然后依赖项查找器可以看到该模板定义，或者将它们放在您从头文件中#include 的单独文件中，并且也将是使用依赖查找器找到。

如果您从使用 -qtempinc 进行迁移，则可以有条件地从声明文件中 #include 模板实现文件，代码如下：

```
// end of foo.h
#ifndef __TEMPINC__          
#include "foo.c"       
#endif 
```

因此，如果您决定重新使用 -qtempic 设置，您的代码将构建和链接。

# asp.net - IIS 将旧用户名返回到我的应用程序

> ID：168946
> 
> 赞同：32
> 
> 时间：2008-10-03T21:15:20.517
> 
> 标签：asp.net, security, iis, authentication, kerberos

这是我的场景。我创建了一个使用集成 Windows 身份验证的应用程序才能工作。在`Application_AuthenticateRequest()`中，我`HttpContext.Current.User.Identity`用来获取`WindowsPrincipal`我网站用户的当前信息。

现在这是有趣的部分。我们的一些用户最近结婚了，他们的名字发生了变化。（即用户的 NT 登录从 更改`jsmith`为`jjones`），当我的应用程序对其进行身份验证时，IIS 将他们的 OLD LOGIN 传递给我。我继续看到`jsmith`传递给我的应用程序，直到我重新启动我的服务器！注销客户端不起作用。重新启动应用程序池不起作用。只有完全重启。

有谁知道这里发生了什么？是否有某种命令我可以用来刷新任何给我这个问题的缓存？我的服务器配置错误吗？

注意：我绝对不想重新启动 IIS、我的应用程序池或机器。由于这是一个生产盒，这些都不是真正可行的选择。

* * *

狂热 -

是的，他们的 UPN 连同他们的登录名一起改变了。还有马克/尼克……这是一个生产企业服务器……它不能只是重新启动或重新启动 IIS。

* * *

**跟进（为后代）：**

Grhm 的回答很到位。这个问题出现在低容量服务器中，您没有很多人使用您的应用程序，但会发出足够多的请求以将用户的身份保存在缓存中。[KB](http://support.microsoft.com/kb/946358)中似乎描述了为什么默认 10 分钟后不刷新缓存项的关键部分是：

> 缓存条目确实会超时，但是应用程序的重复查询可能会在缓存条目的最大生命周期内保持现有缓存条目处于活动状态。

我不确定我们的代码中是什么导致了这种情况（重复查询），但对我们有用的解决方案是将`LsaLookupCacheExpireTime`值从看似淫秽的默认值 1 周减少到仅几个小时。对我们来说，这将用户在现实世界中受到影响的可能性降低到基本上为零，但同时不会导致对我们的目录服务器进行极端数量的 SID-Name 查找。如果应用程序通过 SID 查找用户信息，而不是将用户数据映射到文本登录名，则 IMO 更好的解决方案是。（注意，供应商！如果您在应用程序中依赖 AD 身份验证，则需要将 SID 放入身份验证数据库中！）

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2011-10-07T09:49:53.523

我最近遇到了类似的问题，正如 Robert MacLean 的[回答](https://stackoverflow.com/questions/168946/iis-returning-old-user-names-to-my-application/581346#581346)中所述，如果您没有以用户身份登录，AviD 的组策略更改将不起作用。

我发现按照 MS [KB946358](http://support.microsoft.com/kb/946358)的描述更改**LSA 查找缓存**大小无需重新启动或回收任何应用程序池或服务即可工作。

我发现这是对类似问题的答案：[更改用户登录名后的错误身份验证](https://stackoverflow.com/questions/5551489/wrong-authentication-after-changing-users-logon-name)。

您可能需要查看以下系统调用，例如以下系统调用：

```
LookupAccountName()

LookupAccountSid()

LsaOpenPolicy() 
```

您可以使用它们编写 C++/CLI (/Managed-C++) 应用程序来询问 LSA 缓存。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T11:01:04.257

[AviD](https://stackoverflow.com/users/10080/avid)发现的问题是您可以通过[注册表](http://technet.microsoft.com/en-us/library/cc747586.aspx)控制的 Active Directory 缓存。根据您的解决方案，Avid 的组策略选项将失败或起作用，具体取决于您是否实际登录用户。

它的缓存方式取决于您在 IIS 上进行身份验证的方式。我怀疑它可能是 Kerberos，所以如果它是由 Kerberos 引起的，你可能想尝试使用清除 kerberos 票证的清除选项的[klist](http://technet.microsoft.com/en-us/library/cc738673.aspx)，这将在下一次尝试时强制对 AD 重新授权并更新详细信息。

我还建议考虑实现[这一点](http://www.aspcode.net/Getting-the-authenticated-username.aspx)，它稍微复杂一些，但更不容易出错。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-27T19:09:35.353

我知道我们过去在 IIS 中也遇到过缓存凭据问题，在谷歌搜索几天后，我们遇到了一个晦涩的（至少对我们而言）命令，您可以使用它来查看和清除缓存的凭据。

开始 -> 运行（或 WinKey+R）并输入**control keymgr.dll**

这解决了我们在客户端机器上的问题。尚未在服务器上尝试过，但如果它的服务器缓存凭据可能值得一试。我们的问题是我们获得了旧凭据，但仅在客户端计算机上。如果用户在单独的客户端计算机上登录，一切都很好，但如果他们在办公桌上使用自己的计算机，他们通常在该计算机上工作，则缓存旧凭据。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-23T13:13:14.790

如果仅更改 NT 用户名不是问题，那么似乎身份验证服务正在缓存旧用户名。
您可以将其定义为禁用，转到本地安全设置（在管理工具中），根据版本/版本/配置，可能相关的设置（来自内存）是“要缓存的先前登录次数”和“执行不允许存储凭据..."。

需要考虑的其他因素：

*   域成员身份可能会影响这一点，因为成员服务器可能会继承域设置
*   您可能仍需要重新启动整个服务器一次才能使其生效（但您以后不必担心更新）。
*   登录性能可能会受到影响。

因此，我建议您在部署到生产环境之前先进行测试（当然）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T21:38:47.957

重新启动 IIS，而不是整个机器，应该可以解决问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-05T01:08:50.730

更改这些用户的名称时，您是只更改了他们的 NT 登录名，还是也更改了他们的 UPN 名称？UPN 名称是专有名称，由 Kerberos 使用 - 这是 IWA 的默认协议；但是，如果您只是在 ActiveDirectory 中单击更改他们的名称，则只有 NT 登录名称会更改 - 即使那是他们用来登录的名称（使用默认的 windows GINA）。在幕后，Windows 会将（新的）NT 登录名转换为（旧的）Kerberos 名。这种情况一直存在，直到 AD 被迫根据 NT 登录名更新 Kerberos 名称...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-20T18:05:43.113

使用相关的新登录名登录到运行 IIS 的服务器。这将在不重新启动 IIS 或重新启动服务器的情况下刷新凭据。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-02T12:36:58.457

仅供参考，我们遇到了完全相同的问题。似乎对我们有用的是进入 Active Directory 并进行“刷新”。在此之后，我们必须立即回收存在此问题的 Intranet 站点上的应用程序池。

# php - PHP 中使用 PECL HTTP 类的并行 HTTP 请求 [答案：HttpRequestPool 类]

> ID：168951
> 
> 赞同：11
> 
> 时间：2008-10-03T21:18:08.450
> 
> 标签：php, http, parallel-processing, pecl, simultaneous

* * *

**[HttpRequestPool](http://docs.php.net/manual/en/class.httprequestpool.php)类提供了一个解决方案 。非常感谢那些指出这一点的人。**

**可以在以下位置找到一个简短的教程：[http ://www.phptutorial.info/?HttpRequestPool-construct](http://www.phptutorial.info/?HttpRequestPool-construct)**

* * *

**问题**

我想在 PHP 中发出并发/并行/同时的 HTTP 请求。我想避免连续的请求：

*   一组请求需要很长时间才能完成；请求越多时间越长
*   一个请求在一组中途超时可能会导致以后的请求无法发出（如果脚本有执行时间限制）

我设法找到了[使用 cURL 在 PHP 中同时发出 [原文如此] HTTP 请求的](http://www.phpied.com/simultaneuos-http-requests-in-php-with-curl/)详细信息，但是如果可能的话，我想明确地使用 PHP 的[HTTP 函数](http://php.net/manual/en/book.http.php)。

具体来说，我需要将数据同时发布到一组 URL。发布数据的 URL 不在我的控制范围内；它们是用户设置的。

我不介意是否需要等待所有请求完成才能处理响应。如果我将每个请求的超时时间设置为 30 秒并且同时发出请求，我知道我必须等待最多 30 秒（可能更多）才能完成所有请求。

我找不到有关如何实现这一点的详细信息。但是，我最近确实注意到 PHP 手册中提到了 PHP5+ 能够处理并发 HTTP 请求 - 我当时打算记下它，忘记了，再也找不到了。

**单个请求示例（工作正常）**

```
<?php
$request_1 = new HttpRequest($url_1, HTTP_METH_POST);
$request_1->setRawPostData($dataSet_1);
$request_1->send();
?> 
```

**并发请求示例（不完整，清楚）**

```
<?php
$request_1 = new HttpRequest($url_1, HTTP_METH_POST);
$request_1->setRawPostData($dataSet_1);

$request_2 = new HttpRequest($url_2, HTTP_METH_POST);
$request_2->setRawPostData($dataSet_2);

// ...

$request_N = new HttpRequest($url_N, HTTP_METH_POST);
$request_N->setRawPostData($dataSet_N);

// Do something to send() all requests at the same time
?> 
```

任何想法将不胜感激！

**澄清1**：我想坚持PECL HTTP功能：

*   他们提供了一个不错的 OOP 界面
*   它们在有问题的应用程序中被广泛使用，并且从维护的角度来看，坚持已经使用的应该是有益的
*   与使用 cURL 相比，我通常必须编写更少的代码行来使用 PECL HTTP 函数发出 HTTP 请求 - 从维护的角度来看，更少的代码行也应该是有益的

**澄清 2**：我意识到 PHP 的 HTTP 函数不是内置的，也许我在那里用词错误，我会更正。我不担心人们必须安装额外的东西——这不是一个要分发的应用程序，它是一个带有服务器的网络应用程序。

**澄清 3**：如果有人权威地声明 PECL HTTP 不能做到这一点，我会非常高兴。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-12T22:53:38.477

我很确定[HttpRequestPool](http://docs.php.net/manual/en/class.httprequestpool.php)是您正在寻找的。

稍微详细一点，您可以使用分叉来实现您正在寻找的东西，但这似乎不必要地复杂并且在 HTML 上下文中不是很有用。虽然我还没有测试，这段代码应该是它：

```
// 让 $requests 是要发送的请求数组
$pool = 新的 HttpRequestPool();
foreach ($requests as $request) {
  $pool->attach($request);
}
$池->发送（）；
foreach ($pool as $request) {
  // 做东西
}

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T10:37:42.687

您是否尝试过[HttpRequestPool](http://www.php.net/manual/en/class.httprequestpool.php)（它是 Http 的一部分）？看起来它会汇集请求对象并处理它们。我知道我在某处读到 Http 会支持同时请求，除了*池*之外我也找不到任何东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-12T18:16:02.903

我曾经不得不解决类似的问题：在不累积响应时间的情况下执行多个请求。

该解决方案最终成为使用非阻塞[套接字](http://www.php.net/sockets)的自定义构建功能。它的工作原理是这样的：

```
$request_list = array(
  # address => http request string
  #
   '127.0.0.1' => "HTTP/1.1  GET /index.html\nServer: website.com\n\n",
   '192.169.2.3' => "HTTP/1.1 POST /form.dat\nForm-data: ...",
  );

foreach($request_list as $addr => $http_request) {
    # first, create a socket and fire request to every host
    $socklist[$addr] = socket_create();
    socket_set_nonblock($socklist[$addr]); # Make operation asynchronious

    if (! socket_connect($socklist[$addr], $addr, 80))
        trigger_error("Cannot connect to remote address");

    # the http header is send to this host
    socket_send($socklist[$addr], $http_request, strlen($http_request), MSG_EOF);
}

$results = array();

foreach(array_keys($socklist) as $host_ip) {
    # Now loop and read every socket until it is exhausted
    $str = socket_read($socklist[$host_ip], 512, PHP_NORMAL_READ);
    if ($str != "") 
        # add to previous string
        $result[$host_ip] .= $str;
    else
        # Done reading this socket, close it
        socket_close($socklist[$host_ip]);
}
# $results now contains an array with the full response (including http-headers)
# of every connected host. 
```

由于 socket_read 不等待响应，而是在套接字缓冲区尚未满时返回，因此它以半并行方式获取 thunked 响应，因此速度要快得多。

您可以将其包装在适当的 OOP 接口中。您*需要*自己创建 HTTP 请求字符串，当然还要处理服务器响应。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T21:20:34.263

最近，一位朋友向我指出了 CurlObjects ( [http://trac.curlobjects.com/trac](http://trac.curlobjects.com/trac) )，我发现它对使用 curl_multi 非常有用。

`$curlbase = new CurlBase; $curlbase->defaultOptions[ CURLOPT_TIMEOUT ] = 30; $curlbase->add( new HttpPost($url, array('name'=> 'value', 'a' => 'b'))); $curlbase->add( new HttpPost($url2, array('name'=> 'value', 'a' => 'b'))); $curlbase->add( new HttpPost($url3, array('name'=> 'value', 'a' => 'b'))); $curlbase->perform();`

`foreach($curlbase->requests as $request) { ... }`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T21:54:12.123

PHP 的 HTTP 函数[也不是内置的](http://www.php.net/manual/en/http.install.php)- 它们是 PECL 扩展。如果您担心人们必须安装额外的东西，那么两种解决方案都会遇到同样的问题 - 我想 cURL 更有可能被安装，因为它是我曾经使用过的每个网络主机的默认设置。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-03T21:39:14.617

您可以使用 pcntl_fork() 为每个请求创建一个单独的进程，然后等待它们结束：

[http://www.php.net/manual/en/function.pcntl-fork.php](http://www.php.net/manual/en/function.pcntl-fork.php)

你有什么不想使用 cURL 的理由吗？curl_multi_* 函数将允许同时处理多个请求。

# php - 雅虎用户名正则表达式

> ID：168956
> 
> 赞同：9
> 
> 时间：2008-10-03T21:19:21.320
> 
> 标签：php, regex, validation, yahoo

我需要一个（php）正则表达式来匹配雅虎的用户名规则：

> 使用 4 到 32 个字符并以字母开头。您可以使用字母、数字、下划线和一个点 (.)。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-03T22:25:52.153

```
/^[A-Za-z](?=[A-Za-z0-9_.]{3,31}$)[a-zA-Z0-9_]*\.?[a-zA-Z0-9_]*$/ 
```

或者更短一点：

```
/^[a-z](?=[\w.]{3,31}$)\w*\.?\w*$/i 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-03T21:25:27.407

```
/[a-zA-Z][a-zA-Z0-9_]*\.?[a-zA-Z0-9_]*/ 
```

并检查 strlen($username) >= 4 和 <= 32。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T21:24:22.183

一个点的限制？这很棘手。

我不是正则表达式专家，但我认为这会得到它，除了：

```
[A-Za-z][A-Za-z0-9_.]{3,31} 
```

也许你可以检查一下。分别要求？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T22:25:21.607

使用前瞻，您可以执行以下操作：

```
^(?=[A-Za-z](?:\w*(?:\.\w*)?$))(\S{4,32})$ 
```

因为你没有指定你需要什么类型的正则表达式，所以我添加了很多 Perl 5 兼容的东西。就像`(?: ... )`非捕获括号一样。

**注意：**我添加了缺少的关闭括号。

# lucene - pom.xml.template 是否告诉我将项目用作依赖项所需知道的一切

> ID：168961
> 
> 赞同：0
> 
> 时间：2008-10-03T21:23:07.660
> 
> 标签：lucene, maven-2, lucene-highlighter

我正在尝试将名为[term-highlighter](http://lucene.apache.org/java/docs/lucene-sandbox/index.html#Term%20Highlighter)的 lucene 沙箱贡献添加到我的 pom.xml 中。我对 Maven 不是很熟悉，但是代码有一个[pom.xml.template](http://svn.apache.org/repos/asf/lucene/java/trunk/contrib/highlighter/pom.xml.template)，这似乎暗示我是否添加了一个如下所示的依赖项：

```
<dependency>
  <groupId>org.apache.lucene</groupId>
  <artifactId>lucene-highlighter</artifactId>
</dependency> 
```

它可能会起作用。有人可以帮我在我的 pom.xml 文件中添加一个 lucene-community 项目吗？

感谢您的评论，事实证明添加版本是我所需要的，我只是猜测它应该与我使用的 lucene-core 版本匹配。：

```
<dependency>
    <groupId>org.apache.lucene</groupId>
    <artifactId>lucene-highlighter</artifactId>
    <version>2.3.1</version>
</dependency> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T21:41:30.510

您必须添加版本号，但您只需在项目结构中添加一次。也就是说，如果在父 pom 中定义了版本号，则不必再次提供版本号。（但在这种情况下，您甚至不必提供依赖项，因为无论如何都会继承依赖项。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T21:32:55.020

你说得对，但你可能还想添加版本：

[来自 Maven 5 分钟教程](http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html)

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.mycompany.app</groupId>
  <artifactId>my-app</artifactId>
  <packaging>jar</packaging>
  <version>1.0-SNAPSHOT</version>
  <name>Maven Quick Start Archetype</name>
  <url>http://maven.apache.org</url>

  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>3.8.1</version>
      <scope>test</scope>
    </dependency>
  </dependencies>

</project> 
```

# jquery - 停止缓存 jQuery .load 响应

> ID：168963
> 
> 赞同：247
> 
> 时间：2008-10-03T21:23:59.593
> 
> 标签：jquery, ajax, caching

我有以下代码在 URL 上发出 GET 请求：

```
$('#searchButton').click(function() {
    $('#inquiry').load('/portal/?f=searchBilling&pid=' + $('#query').val());            
}); 
```

但返回的结果并不总是反映。例如，我在响应中进行了更改，吐出堆栈跟踪，但是当我单击搜索按钮时堆栈跟踪没有出现。我查看了控制 ajax 响应的底层 PHP 代码，它具有正确的代码，直接访问页面显示了正确的结果，但 .load 返回的输出是旧的。

如果我关闭浏览器并重新打开它，它会运行一次，然后开始返回过时的信息。我可以通过 jQuery 控制它还是需要我的 PHP 脚本输出标头来控制缓存？

* * *

## 回答 #1

> 赞同：424
> 
> 时间：2008-10-03T21:26:45.140

您必须使用更复杂的功能，例如`$.ajax()`如果您想根据每个请求控制缓存。或者，如果您只想将其关闭，请将其放在脚本的顶部：

```
$.ajaxSetup ({
    // Disable caching of AJAX responses
    cache: false
}); 
```

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2010-01-28T22:36:59.593

这是一个如何根据每个请求控制缓存的示例

```
$.ajax({
    url: "/YourController",
    cache: false,
    dataType: "html",
    success: function(data) {
        $("#content").html(data);
    }
}); 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-10-03T21:26:09.200

一种方法是在 url 末尾添加一个唯一编号：

```
$('#inquiry').load('/portal/?f=searchBilling&pid=' + $('#query').val()+'&uid='+uniqueId()); 
```

您在哪里编写 uniqueId() 以在每次调用时返回不同的内容。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-12-19T10:07:48.900

另一种仅在需要从服务器获取数据时放置下一行的方法，将下一行与您的 ajax url 一起附加。

'?_='+Math.round(Math.random()*10000)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-06-30T13:07:19.690

```
/**
 * Use this function as jQuery "load" to disable request caching in IE
 * Example: $('selector').loadWithoutCache('url', function(){ //success function callback... });
 **/
$.fn.loadWithoutCache = function (){
 var elem = $(this);
 var func = arguments[1];
 $.ajax({
     url: arguments[0],
     cache: false,
     dataType: "html",
     success: function(data, textStatus, XMLHttpRequest) {
   elem.html(data);
   if(func != undefined){
    func(data, textStatus, XMLHttpRequest);
   }
     }
 });
 return elem;
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-07-07T19:45:40.880

Sasha 是个好主意，我用的是混合的。

我创建一个函数

```
LoadWithoutCache: function (url, source) {
    $.ajax({
        url: url,
        cache: false,
        dataType: "html",
        success: function (data) {
            $("#" + source).html(data);
            return false;
        }
    });
} 
```

并调用我页面的不同部分，例如在 init 上：

初始化：函数（actionUrl1，actionUrl2，actionUrl3）{

var ExampleJS= {

```
Init: function (actionUrl1, actionUrl2, actionUrl3)           ExampleJS.LoadWithoutCache(actionUrl1, "div1"); 
```

ExampleJS.LoadWithoutCache(actionUrl2, "div2"); ExampleJS.LoadWithoutCache(actionUrl3, "div3"); } },

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-03T21:26:15.690

这在 IE 中尤其令人烦恼。基本上，您必须将“无缓存”HTTP 标头与来自服务器的响应一起发回。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-04T01:32:11.840

对于 PHP，将此行添加到提供所需信息的脚本中：

```
header("cache-control: no-cache"); 
```

或者，向查询字符串添加一个唯一变量：

```
"/portal/?f=searchBilling&x=" + (new Date()).getTime() 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-07-23T08:37:00.900

不要使用时间戳来创建唯一的 URL，因为您访问的每个页面都由 jquery mobile 缓存在 DOM 中，您很快就会遇到手机内存不足的问题。

```
$jqm(document).bind('pagebeforeload', function(event, data) {
    var url = data.url;
    var savePageInDOM = true;

    if (url.toLowerCase().indexOf("vacancies") >= 0) {
        savePageInDOM = false;
    }

    $jqm.mobile.cache =  savePageInDOM;
}) 
```

此代码在页面加载之前激活，您可以使用 url.indexOf() 来确定 URL 是否是您要缓存的 URL，并相应地设置缓存参数。

不要使用 window.location = ""; 更改 URL，否则您将导航到该地址并且 pagebeforeload 不会触发。为了解决这个问题，只需使用 window.location.hash = "";

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-07-09T13:51:25.297

如果您想坚持使用 Jquery 的 .load() 方法，请在 URL 中添加一些独特的内容，例如 JavaScript 时间戳。“+新日期（）。getTime（）”。请注意，我必须添加一个“&time=”，这样它就不会改变您的 pid 变量。

```
$('#searchButton').click(function() {
$('#inquiry').load('/portal/?f=searchBilling&pid=' + $('#query').val()+'&time='+new Date().getTime());            
}); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-11-25T17:31:59.160

您可以将 jquery load 函数替换为缓存设置为 false 的版本。

```
(function($) {
  var _load = jQuery.fn.load;
  $.fn.load = function(url, params, callback) {
  if ( typeof url !== "string" && _load ) {
        return _load.apply( this, arguments );
  }
    var selector, type, response,
      self = this,
      off = url.indexOf(" ");

    if (off > -1) {
      selector = stripAndCollapse(url.slice(off));
      url = url.slice(0, off);
    }

    // If it's a function
    if (jQuery.isFunction(params)) {

      // We assume that it's the callback
      callback = params;
      params = undefined;

      // Otherwise, build a param string
    } else if (params && typeof params === "object") {
      type = "POST";
    }

    // If we have elements to modify, make the request
    if (self.length > 0) {
      jQuery.ajax({
        url: url,

        // If "type" variable is undefined, then "GET" method will be used.
        // Make value of this field explicit since
        // user can override it through ajaxSetup method
        type: type || "GET",
        dataType: "html",
        cache: false,
        data: params
      }).done(function(responseText) {

        // Save response for use in complete callback
        response = arguments;

        self.html(selector ?

          // If a selector was specified, locate the right elements in a dummy div
          // Exclude scripts to avoid IE 'Permission Denied' errors
          jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector) :

          // Otherwise use the full result
          responseText);

        // If the request succeeds, this function gets "data", "status", "jqXHR"
        // but they are ignored because response was set above.
        // If it fails, this function gets "jqXHR", "status", "error"
      }).always(callback && function(jqXHR, status) {
        self.each(function() {
          callback.apply(this, response || [jqXHR.responseText, status, jqXHR]);
        });
      });
    }

    return this;
  }
})(jQuery); 
```

将它放在全局的某个地方，它将在 jquery 加载后运行，你应该已经准备好了。您现有的加载代码将不再被缓存。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-11-11T06:30:32.287

试试这个：

```
$("#Search_Result").load("AJAX-Search.aspx?q=" + $("#q").val() + "&rnd=" + String((new Date()).getTime()).replace(/\D/gi, '')); 
```

当我使用它时它工作正常。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-08-15T04:07:29.300

我注意到，如果某些服务器（如 Apache2）未配置为明确允许或拒绝任何“缓存”，那么服务器可能默认发送“缓存”响应，即使您将 HTTP 标头设置为“无缓存”。因此，请确保您的服务器在发送响应之前没有“缓存”任何内容：

在 Apache2 的情况下，您必须

1) 编辑“disk_cache.conf”文件 - 禁用缓存添加“CacheDisable /local_files”指令

2) 加载 mod_cache 模块（在 Ubuntu 上“sudo a2enmod cache”和“sudo a2enmod disk_cache”）

3）重启Apache2（Ubuntu“sudo service apache2 restart”）；

这应该可以在服务器端禁用缓存。干杯! :)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-05-29T09:54:30.400

此代码可以帮助您

```
var sr = $("#Search Result");
sr.load("AJAX-Search.aspx?q=" + $("#q")
.val() + "&rnd=" + String((new Date).getTime())
.replace(/\D/gi, "")); 
```

# c++ - 静态和动态库链接

> ID：168979
> 
> 赞同：2
> 
> 时间：2008-10-03T21:27:09.337
> 
> 标签：c++, linker, aix

在 C++ 中，静态库 A 链接到动态库 B 和 C。如果在 B 中定义的 A 中使用了一个类 Foo，如果它不使用 Foo，C 会链接吗？

我认为答案是肯定的，但是我现在遇到了 xlc_r7 的问题，其中库 C 说 Foo 是一个未定义的符号，就 C 而言，它是一个未定义的符号。我的问题是库 C 没有使用引用它的类。这链接在 Win32 (VC6) 和 OpenVMS 中。

这是链接器差异还是 PBCAK？

**新信息：**

1.  B 取决于 C，但反之亦然。

2.  我没有使用 /OPT:REF 在 Windows 上进行链接，它可以毫无问题地链接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-04T00:53:39.607

静态链接时，两个模块合二为一。所以当你编译C并将A链接到其中时，就好像你已经将A的所有源代码复制到了C的源代码中，然后编译了合并的源代码。所以 C.dll 包含 A，它通过 Foo 依赖于 B。您需要将 C 链接到 B 的链接库以满足该依赖关系。

请注意，根据您的信息，这将在 B 和 C 之间创建循环依赖关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T21:40:49.670

听起来它可能是链接器（ld/unix），因为（我使用过的大多数版本）ld 将库从左到右链接到 - 如果第一个引用中有稍后需要的引用通常的技巧是将第一个库（或任何必需的库）附加到命令的末尾。

这是一个尝试，看看......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T22:04:35.237

您的 C 链接行是否包括 B 的导出库？如果是这样，那么正如理查德所说，这听起来像是一个订购的东西。

另一个建议是看看是否有一个链接器选项来忽略未引用的符号，如果 C 不需要来自 A 的功能。对于 Microsoft 链接器，这是通过 /OPT:REF 开关实现的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T11:21:16.517

C 不链接的唯一原因是编译器认为它*确实*需要 Foo 符号。

由于 C 不引用 Foo 符号，因此链接器需要该符号肯定还有另一个原因。

我知道的唯一其他原因是某种出口。我只知道 Visual C++，所以我建议你在预处理文件中搜索一些等价物`__declspec( dllexport )`，看看是什么生成了它。

这就是我要做的：将预处理器输出存储在一个单独的文件中，并在其中搜索 Foo 的出现。它要么作为导出出现，要么被编译器以某种方式引用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-10T10:39:27.513

如果不需要特定函数的定义，则在链接阶段不会链接该库。在您的情况下，因为 foo 的定义存在于库 B 而不是库 C 中。因此，在加载可执行文件时，库 C 不会被加载到内存中。

但似乎您也在使用库 C 中的 foo() 函数，因此您会收到相应的错误。

# c# - 在 C# WinForms 中恢复 UI 设置 - 响应哪个事件？

> ID：168985
> 
> 赞同：1
> 
> 时间：2008-10-03T21:30:56.630
> 
> 标签：c#, winforms, user-interface, layout

何时是恢复 System.Windows.Forms.Control 的 UI 布局设置的合适时间？

我试过这个：

```
FooBarGadget control = new FooBarGadget();
parent.Controls.Add(control);
control.FobnicatorWidth = lastLayoutSettings.FobWidth; 
```

没有雪茄。原因？控制还没有完成其内部的布局；构建后它的默认大小为 100x100 像素。一旦完成加载并实际显示在 UI 中，它将是 500x500 像素。因此，将 FobnicatorWidth 设置为 200 像素失败；它比控件大。

是否有一个 control.Loaded 事件 - 我可以在哪里恢复我保存的 UI 设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T21:51:19.350

如果您在加载新控件时创建此控件，`Form`则重新加载已保存设置的好地方是在[Form.OnLoad](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.onload.aspx)中（或响应[Form.Load](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.load.aspx)事件）。另一个可能有用的事件是[Control.HandleCreated](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.handlecreated.aspx)，它在创建控件的基础窗口时发生。

如果这些都没有帮助，也许有关您的特定场景的更多信息将帮助我们获得更好的答案。

# database - 如何获得排序数据库视图的效果？

> ID：168991
> 
> 赞同：3
> 
> 时间：2008-10-03T21:33:26.860
> 
> 标签：database, legacy

我希望能够（有效地）对数据库视图进行排序-我知道从概念上讲，数据库视图中的顺序是无效的，但是我有以下情况要处理：

*   第三方遗留应用程序，它使用 select(*) from tablename 语句从数据库表中读取数据
*   遗留应用程序对记录的顺序非常敏感
*   我编写的一个应用程序允许用户更轻松地管理表中的数据，但是从表中插入和删除自然会打乱记录的顺序。

将遗留应用程序中的语句更改为 select (*) from tablename order by field 将解决我的问题，但不是一个选项。

所以 - 我已经设置了一个临时表，数据可以以正确的顺序导出到其中，但这是一个资源匮乏的选项，意味着数据在遗留应用程序中不是“活的”，并且是额外的工作用户。

我希望能够获得具有这些约束的表格的有序版本。有什么想法吗？

* * *

更新 - 我正在使用 Sybase 12.5，但我想避免与特定 RDBMS 紧密耦合的解决方案 - 它可能会改变。

[由于此 Wikipedia 条目](http://en.wikipedia.org/wiki/View_(database))中提到的 SQL 标准，我无法向视图添加“order by”子句

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T21:42:49.757

首先，我以前必须从事过这种类型的项目，这真是个婊子。节哀顺变。

这有点小，但是如果您的 DBMS 支持它，也许您可​​以创建一个用户定义的表函数，该函数从您的旧表中进行有序选择，然后设置您的视图以从 UDTF 中进行选择。不过，这不是我以前做过的任何事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T21:38:13.853

这不是很好，但它的工作原理

```
CREATE VIEW OrderedTable
AS SELECT TOP (Select Count(*) from UnorderedTable) *
FROM UnorderedTable Order By field 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T21:46:07.397

您可以尝试使用表值函数。您没有指定您的数据库供应商，但以下是您在 TSQL (Sql Server) 中的操作方式：

```
CREATE FUNCTION orderedTable() 
RETURNS @returnTable TABLE 
    (val varchar(100)) AS
BEGIN
    insert @returnTable (val)
    select val from MyTable
    order by val desc
    RETURN 
END

GO

SELECT * FROM orderedTable 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T19:29:38.590

Following up on the info you guys have provided, looks like I can't do what I want to on Sybase ASE 12.5.

MSSQL Server and Sybase ASE 15.x should do what's needed - hopefully I'll be able to arrange something. Not really sure which one to accept til I've got something working, but I'll come back and accept an answer then.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T21:42:45.327

如果我理解正确，您可以通过以下方式解决此问题：
1) 重命名原始表
2) 使用旧应用程序查询的表的名称创建视图。
3) 将视图定义为以旧版应用程序期望的方式对记录进行排序的查询。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T22:36:55.780

在 MS Sql Server 中，我们可以将标准混为一谈并创建如下视图：

```
SELECT TOP 100 PERCENT * FROM TABLE ORDER BY 1 
```

这让我们可以解决这样的问题。由于 Sybase 和 Sql Server 共享 T-SQL，我认为您很有可能也可以这样做。

或者，您可以在应该排序的字段上设置聚集索引。这将强制存储顺序，它将*以“自然顺序”返回。

*   诚然，这是一个实现细节。SQL 标准（也不是任何特定的供应商，AFAIK）不保证没有 order by 子句的排序......但是，嘿，如果你可以使用它，那么你就不会问了。

# html - 制作

> ID：168992
> 
> 赞同：4
> 
> 时间：2008-10-03T21:33:47.297
> 
> 标签：html, css, fonts

我正在尝试显示从 60 个字符到 160 个左右的一系列标题，并且大小写各不相同，其中一些全部大写，一些半大写。当它大部分是小写时，整个 160 个字符的文本都适合我想要的宽度，但是当它开始获得更多的大写字母（它们必须更宽）时，它开始过度流动。

有没有办法使用有吸引力的固定字体（大小写宽度也一样），或者动态缩小文本以适应，或者以其他方式识别文本将在服务器端占用多少空间，并切断动态结束？或者你们有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-03T21:56:30.900

**控制溢出**

真正的技巧只是设置文本框大小的限制，并确保没有溢出问题。您可以使用溢出：隐藏来处理这个问题，并显示：阻止元素，以便为其提供所需的确切尺寸。

**等宽是可选的**

是的，您可以使用等宽字体。如果您想要跨浏览器解决方案，则只有少数可供选择。您也可以使用可变宽度字体。等宽字体只会帮助您与所描述的大写问题保持一致。使用等宽字体将帮助您选择适用于不同文本长度的合适宽度。在下面的示例中，我任意选择了 250 像素的宽度，并键入了字符串，直到它们远远超过限制，仅用于说明目的。

**行高和边距**

您希望文本的行高与框的高度相匹配。在这种情况下，我使用了 20 像素。如果需要创建行高，可以添加下边距。

**旁注：**我在这里使用了 h3，因为文本在页面上重复了很多次。一般来说，对更常见的文本使用较低级别的标题是更好的选择（只是语义选择）。使用 h1 将以相同的方式工作..

```
<html>
<head>
<title>h1 stackoverflow question</title>
<style type="text/css">

* { margin:0; padding:0 }

h3 { 
    display: block;
    width: 250px;
    height: 20px;
    margin-bottom: 5px;
    overflow: hidden;
    font-family: Courier, Lucidatypewriter, monospace;
    font: normal 20px/20px Courier;
    border: 1px solid red;
}

</style>
</head>
<body>

<h3>Hello, World</h3>
<h3>Lorem Ipsum dolor sit Amet</h3>
<h3>Adipiscing Lorem dolor sit lorem ipsum</h3>
<h3>&quot;C&quot; is for Cookie, that's good enough for lorem ipsum</h3>
<h3>Oh, it's a lorem ipsum dolor sit amet.  Adipiscing elit.</h3>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T21:39:01.420

当您说“动态切断结尾”时，假设 CSS 规则如下：

```
h1 {
    width: 400px; /* or whatever width */
    overflow: hidden;
} 
```

会根据需要“切断”吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T22:17:40.967

您也可以尝试省略号解决方案。以最大宽度截断文本并应用省略号。就像是：

**我的标题太长了...**

CSS3 有 text-overflow: ellipsis 你可以使用，但它在 Firefox 中不受支持。

Hedger Wang 找到了一个我用过几次的[解决方法。](http://www.hedgerwow.com/360/dhtml/text_overflow/demo3.php)很方便。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T21:38:44.867

您可以修复宽度并隐藏溢出，`style="width: Xpx; overflow: hidden;"`

如果它太宽，那将限制宽度并切断末端。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T21:43:16.497

MrZebra 在如何隐藏溢出方面是正确的，但如果您想使用一种有吸引力的固定宽度字体，您可以使用 CSS font-family 进行设置，但请确保为没有该字体的人提供后备。

如果你愿意，你也可以使用 CSS 来强制使用“text-transform”进行大写（尽管从你的阅读来看，这不是你的愿望）。

[font-variant:small-caps](http://www.w3schools.com/css/pr_font_font-variant.asp)也可能有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T22:08:23.747

您可以尝试使用 javascript 以编程方式测试以查看字体的宽度，如果它太大，请降低一步并重试。不要测试宽度，而是查看元素的高度是否超过一行（以 em 为单位，因为您将更改字体大小）。

```
var fontSize = "200%";  // your regular heading font size
var h1 = document.getElementById("myHeading");
while (h1.offsetHeight > oneLine) {
    fontSize *= (parseInt(fontSize) - 5) + "%";
    h1.style.fontSize = fontSize;
} 
```

*抱歉，您必须自己弄清楚“oneLine”位。*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-07T12:32:19.960

而不是试图限制你的 <h1> 的高度，我会调整你的 CSS 以使你的网站更加流畅 - 毕竟，如果用户增加他们的文本大小，你不希望你的网站出现损坏。

尝试以 em 而不是像素设置 h1 的高度。如果将其添加到 CSS 中：

```
body {
    font:62.5%/140% Courier, Lucidatypewriter, monospace;
} 
```

它将使 1em = 10px，因此您可以将标题的高度设置为：

```
h1, h3 {
    ....
    height:2em;
    ....
} 
```

希望这可以帮助。******