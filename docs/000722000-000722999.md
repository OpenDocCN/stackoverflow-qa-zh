# StackOverflow 问答 000722000-000722999

# eclipse - Eclipse 中的 System.getProperty("user.dir") 异常

> ID：722003
> 
> 赞同：3
> 
> 时间：2009-04-06T15:34:17.667
> 
> 标签：eclipse

在我当前的项目设置中，我已将 Eclipse 配置为将编译后的 .class 文件放在 /bin 目录中。

我的困惑是，当我通过 IDE 运行应用程序并让它打印当前工作目录 (System.out.println(System.getProperty("user.dir")) 时，我希望控制台输出为 /bin -相反，打印的值是 projectRoot 文件夹（没有 /bin 后缀）。

如果我要直接导航到 /bin 文件夹并执行我的 java 类，则当前工作目录会按照我的预期打印。我想要的是 Eclipse IDE 的行为相似。

关于我为什么要观察这种差异的任何想法？我经历了许多项目构建设置，但似乎找不到任何会导致这种异常的东西。

亲切的问候， 迪努克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-06T15:40:12.647

在 Eclipse 中，**工作目录**默认为项目目录。
您可以[在运行属性](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.jdt.doc.user/tasks/tasks-executionArgs.htm)
（`Project->Properties->Run/DebugSettings->Edit->Arguments`页面底部的选项卡）中更改此设置。

**编辑：**实际上，最简单的方法是`Run->Open Run Dialog->Arguments`制表符。
自从我使用 Eclipse 以来已经有一段时间了。

**[来自Eclipse Setup New Project](http://apps.sourceforge.net/mediawiki/sprite2d/index.php?title=Eclipse_Setup_New_Project)**的示例

[替代文字 http://apps.sourceforge.net/mediawiki/sprite2d/nfs/project/s/sp/sprite2d/a/ae/EclipseNewProjectDebugArguments.jpg](http://apps.sourceforge.net/mediawiki/sprite2d/nfs/project/s/sp/sprite2d/a/ae/EclipseNewProjectDebugArguments.jpg)

# java - 为什么我的 J2ME DateField 不能显示正确的日期？

> ID：722004
> 
> 赞同：1
> 
> 时间：2009-04-06T15:34:23.330
> 
> 标签：java, java-me, midp, lcdui

我将值和日期值存储在记录存储中。我的日期字段设置如下：

```
StartDate = new DateField("Start Date ", DateField.DATE);
                cal1 = Calendar.getInstance();
                cal1.set(Calendar.YEAR, 2009);
                cal1.set(Calendar.MONTH, 0);
                cal1.set(Calendar.DAY_OF_MONTH, 1);
                StartDate.setDate(cal1.getTime()); 
```

我将日期保存为字符串，如下所示：

```
 strStartDate = cal1.get(cal1.DAY_OF_MONTH) + "/" +
                (cal1.get(cal1.MONTH) + 1) + "/" +
                cal1.get(cal1.YEAR);
 String detailsToAdd = strStartDate 
```

（我已经缩短了代码。）现在，我希望能够在未来阶段编辑日期。但是，我需要代码才能做到这一点。到目前为止，我有：

```
EStartDate = new DateField("Start Date ", DateField.DATE); 
```

我不得不更改`DateField`盒子的名称，因为这与其他内容冲突。

我基本上需要能够显示所选记录的日期属性。我目前显示了其他信息。我只需要能够显示正确的日期。当我运行程序时，日期字段显示`<date>`。

任何帮助都会很好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-09-07T19:27:18.107

您的第一个代码如下是正确的：

```
 StartDate = new DateField("Start Date ", DateField.DATE);
            cal1 = Calendar.getInstance();
            cal1.set(Calendar.YEAR, 2009);
            cal1.set(Calendar.MONTH, 0);
            cal1.set(Calendar.DAY_OF_MONTH, 1);
            StartDate.setDate(cal1.getTime()); 
```

但是对于第二个，您不能直接将日期保存到字符串。您必须像这样将其转换为字符串：

```
 String detailsToAdd =strStartDate.toString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-08T12:21:27.853

您提供的代码片段不使用[setDate(Date)](http://download.oracle.com/javame/config/cldc/ref-impl/midp2.0/jsr118/javax/microedition/lcdui/DateField.html#setDate%28java.util.Date%29)。如果您的实际代码也没有使用它，那么`<date>`在该字段中是正确的行为 - 它告诉您日期“未初始化”。

在这种情况下，首先使用一些简单的代码对其进行烟雾测试，例如

```
 eStartDate = new DateField("Start Date ", DateField.DATE);
    eStartDate.setDate(new Date()); 
```

然后，如果显示日期，请了解如何从 重新创建所需的 Date 参数`strStartDate`。也就是说，如果您希望用户能够修改它，请重新创建 - 因为如果您只需要显示日期，那么使用`StringItem`显示所需的字符串会更简单

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T22:35:22.597

可能是您正在运行的语言环境不接受以**/**作为分隔符的日期吗？我确信有一种独立于语言环境的方式来编写日期，而无需像您的示例中那样使用字符串连接。

# xml - 如何通过 XSLT 提供相同的表格 1) 空白和 2) 填写？

> ID：722006
> 
> 赞同：1
> 
> 时间：2009-04-06T15:35:12.067
> 
> 标签：xml, xslt, printing

我使用 XML 和 XSLT 打印了 20 个表单。现在我需要一个可以将这些表格打印为空白的功能。例如，我的 XML 中有一个“名称”字段和一个相应的

```
<span>Name:</span>
<strong class="data">
    <xsl:value-of disable-output-escaping="yes" select="Name" />
</strong> 
```

我需要 2 个功能：

1.  我想打印名称，例如：`Name: John Doe`
2.  我不想打印名称并让用户填写，例如：`Name:________`

根据它是文本框、文本区域还是复选框，我想添加相对空格。所以，如果它是一个文本区域字段，我想添加一个等于字段大小的空间，以便用户可以添加信息。

有人知道如何实施吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T16:25:18.047

要创建适当长度的空白，您可以：

```
<!-- make sure you put in more blanks than you'll need -->
<xsl:variable name="blanks" select="'___[...100 blanks...]___'" />

<!-- and later -->

<xsl:value-of select="substring($blanks, 1, @fieldlength)" /> 
```

或者

```
<xsl:template name="create-blanks">
  <xsl:param name="todo" select="0" />

  <xsl:if test="$todo &gt; 0">
    <xsl:text>_</xsl:text>
    <xsl:call-template name="create-blanks">
      <xsl:with-param name="todo" select="$todo - 1" />
    </xsl:call-template>
  </xsl:choose>
</xsl:template>

<!-- and later -->

<xsl:variable name="blanks">
  <xsl:call-template name="create-blanks">
    <xsl:with-param name="todo" select="@fieldlength" />
  </xsl:call-template>
</xsl:variable>

<xsl:value-of select="$blanks" /> 
```

在性能方面，第一种方法显然受到青睐。后者可以通过每次创建一个以上的空白（例如 10 个）并在结果上使用而不是调用它`@fieldlength`，而是调用它来有所改进。这种计算当然可以在模板本身中发生。`ceiling(@fieldlength div 10)``substring()`

如果无法预先确定合理的最大空白数（我猜对您的情况来说这不太可能），则后一种方法可确保您永远不会“用完”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T16:16:53.090

您可以使用 string-length 函数来确定名称字符串的长度，如果它为空，则打印下划线字符串。这是一个示例：

```
<span>Name:</span>
<strong class="data">
    <xsl:choose>
        <xsl:when test="string-length(Name) > 0">
            <xsl:value-of disable-output-escaping="yes" select="Name" />
        </xsl:when>
        <xsl:otherwise>
            _____________________________
        </xsl:otherwise>
    </xsl:choose>
</strong> 
```

这样，您只需传入一个空白 XML 文档，样式表就会照此打印。

# wcf - 我可以为 WCF 服务设置 IP 过滤器吗？

> ID：722008
> 
> 赞同：4
> 
> 时间：2009-04-06T15:35:42.033
> 
> 标签：wcf, security, wcf-security

我正在修改我的 WCF API 以包含一项仅应向内部 IP 地址公开的新服务。我的 API 中的所有服务都以 SOAP、POX 和 JSON 的形式提供。我正在寻找的是一种行为或某种东西，它允许我实现一个简单的 IP 地址过滤器，处理来自内部 IP 的请求并拒绝其他一切。我希望它在配置中工作，因为 API 中的所有其他服务都应该对 Internet 可用。我做了一些谷歌搜索，但在 WCF 中找不到类似的东西。我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T19:09:32.130

好的，我想通了，在我看来，它有点光滑。我将 IP 过滤器系统实现为服务行为，然后在 web.config 中将其添加到我的服务中。这是我的新 Web 配置行为部分：

```
<serviceBehaviors>
    <behavior name="ServiceBehaviour">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
    </behavior>
    <behavior name="RestrictedServiceBehaviour">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
      <IPFilter filter="172.*.*.* 127.0.0.1" />          
    </behavior>
  </serviceBehaviors> 
```

IPFilter 类实现 IDispatchMessageInspector 以尽快捕获请求，检查客户端 IP，如果与过滤器不匹配则抛出异常。如果有人感兴趣，我可以发布我的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T15:50:57.347

如果您的服务托管在 IIS 中，那么您可以使用 IIS 在每个网站的基础上执行此操作（可能是每个应用程序，但我不知道）。

# c# - asp.net 中的预渲染事件

> ID：722013
> 
> 赞同：0
> 
> 时间：2009-04-06T15:36:43.043
> 
> 标签：c#, asp.net

```
protected void rgStateTax_PreRender( object sender, EventArgs e )
{
    if( rgStateTax.MasterTableView.IsItemInserted )
    {
        foreach( GridItem item in rgStateTax.Items )
        {
            item.Visible = false;
        }
    }

    if( rgStateTax.EditItems.Count > 0 )
    {
        foreach( GridDataItem item in rgStateTax.Items )
        {
            if( item != rgStateTax.EditItems[0] )
            {
                item.Visible = false;
            }
        }
    }
} 
```

在这里，rgStateTax 是一个 Rad 网格控件。是否有任何理由将项目标记为不可见？PreRender 是页面实际显示在屏幕上之前的事件，对吧？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-06T15:44:13.587

PreRender 是在生成给定控件/页面的 HTML 之前发生的事件（稍后将发送到浏览器）。因此，通过在此处设置 item.Visible = false ，它不会被呈现为 HTML（但它的 ViewState 会）。

在这种情况下，当用户编辑/插入项目时，代码似乎隐藏了 RadGrid 中的所有行，我认为这样可以减少对最终用户的干扰。

# visual-studio - log4net 仅在 Visual Studio 调试器中运行时记录

> ID：722020
> 
> 赞同：4
> 
> 时间：2009-04-06T15:39:13.287
> 
> 标签：visual-studio, log4net

我正在运行 Visual Studio 2008 - log4net 日志记录 (v1.2.10) 有问题。我有一个带有单个日志语句的小型控制台测试程序。我为 RollingLogFileAppender 和 ConsoleAppender 配置了 log4net。

当我从命令行运行已编译的 exe 时，我看到在我的运行时目录中正确创建了日志文件。日志文件被创建（或附加到，当它存在时），但唯一的输出是配置的 [Header] 和 [Footer]。控制台没有输出。

但是，**当我在调试器下运行时，日志消息会同时出现在日志文件和控制台上**。以下是我的 log4net 配置：

```
<log4net>
  <appender name="ConsoleAppender" type="log4net.Appender.ConsoleAppender">
    <layout type="log4net.Layout.PatternLayout" value="%date [%thread] %-5level %logger - %message%newline" />
  </appender>
  <appender name="RollingLogFileAppender" type="log4net.Appender.RollingFileAppender">
    <file value="quicktest-log-" />
    <appendToFile value="true" />
    <immediateFlush value="true" />
    <datepattern value="yyyy-MM-dd" />
    <maxSizeRollBackups value="100" />
    <maximumFileSize value="1048576" />
    <rollingStyle value="Composite" />
    <staticLogFileName value="false" />
    <layout type="log4net.Layout.PatternLayout">
      <header value="[Begin Quicktest program log]&#13;&#10;" />
      <footer value="[End Quicktest program log]&#13;&#10;" />
      <conversionPattern value="%date{HH:mm:ss} [%thread] %-5level %logger: %message%newline" />
    </layout>
  </appender>
  <root>
    <level value="ALL" />
    <appender-ref ref="ConsoleAppender" />
    <appender-ref ref="RollingLogFileAppender" />
  </root>
</log4net> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T15:44:49.297

这个理论可能有点牵强，但是您是否确保已将 app.config 复制到可执行文件所在的文件夹中？App.config 必须复制到输出可执行文件所在的位置，并且您还必须将其重命名为 <executablename>.config，因此如果您的可执行文件是 MyProgram.exe，则 config 必须在 MyProgram.exe.config 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T17:35:12.837

它现在正在工作，但谜团仍然存在。显然，一大口中式自助餐是解决此类问题的唯一方法，因为一旦我吃了一个，问题就消失了。

我的测试程序是一个文件

```
class Test 
{
    static void Main (string[] args)
    {
       .
       . // some logging attempted here.
       .
    }
} 
```

当我最初遇到问题时，我正在`Main()`. 之后，我在 Test 类上创建了一个方法，在 Main 中实例化了 Test 类，并将日志记录移至该方法。这消除了问题：

```
class Test
{
    static void Main (string[] args)
    {
      var p = new Test();
      p.Go ();
    }
    public void Go ()
    {
       . // some logging here.
    }
} 
```

这仍然没有定论。我把它移回原来的样子，它开始工作了。所以，我必须得出结论，这个难题的答案是：**不要在没有吃过中国菜的情况下尝试第一次 log4net 测试程序。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-28T07:25:17.910

我有同样的问题，我正在做 clickonce 部署。

我发现我需要在 Project properties > Publish > ApplicationFiles 中添加 log4net.xml 并将这个 log4net.xml 作为数据文件。

# javascript - 在隐藏的 div 中显示和隐藏带有单选按钮的 div

> ID：722029
> 
> 赞同：0
> 
> 时间：2009-04-06T15:42:04.640
> 
> 标签：javascript, html, css

基本上我有三个图像（称它们为 img1、img2、img3），每个图像都有三个菜单。（菜单 1、菜单 2、菜单 3）

当用户单击 img1 时，menu1 应弹出三个单选按钮选择（rad1、rad2、rad3）。假设用户单击 rad2，menu1 应隐藏并出现 img2（但仍应选择 rad2）。单击 img2 时，menu2 应显示为选中 rad2。然后，如果单击 rad3，menu2 将隐藏并显示 img3（但 rad3 仍处于选中状态）。等等等等。

如何在javascript中编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T15:53:36.170

Here is an example of how to show a hidden div by clicking on an image.

```
<script language="javascript">
function showDiv() {
  mydiv = document.getElementById('div1');
  mydiv.style.display = 'block';
}
</script>

<div id='div1' style="display:none;"> 
  <!-- content -->
</div>

<img src='img.gif' onclick='showDiv();'/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T15:53:47.950

It should be as easy as:

```
function img1clk() {
    menu1div.style.display = "block";
}
function menu1radclk() {
    menu1div.style.display = "none";
    img1div.style.display = "block";
    menu2div.style.display = "block";
} 
```

and so on. You will have to initialize the elements so their onClick property is pointing to the correct function, but thats simply

```
img1div.onclick = ing1clk(); 
```

or in html

```
<div onclick="img1clk()"><img src="..."></div> 
```

Hope this helps ya!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T15:48:39.130

This becomes pretty easy if you use jQuery's built-in methods, such as [show()](http://docs.jquery.com/Effects/show) or [hide()](http://docs.jquery.com/Effects/hide). Don't re-invent the wheel and all that :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T19:55:59.833

如果所有 3 个菜单本质上是相同的，但只是看起来不同，为什么不每次都调出相同的菜单而是改变它的 css 类呢？

此外，我完全同意 jQuery 是要走的路。jQuery 站点自己的文档我觉得有点蹩脚，但是一旦你掌握了基础知识，它就真的很直观了。

# asp.net - 将 ID 应用于 GridView

> ID：722030
> 
> 赞同：0
> 
> 时间：2009-04-06T15:42:42.623
> 
> 标签：asp.net, jquery, gridview

在你说之前，我完全知道数据中继器可以做到这一点，但我正在寻找使用 GridView 的解决方案。

我正在实现一个 jQuery 功能，并要求将唯一 ID 应用于各个行，以便以正确的方式响应单击事件。我看不出您应该如何将值应用于 ID 或行。

基本上我正在考虑做一些事情

```
$('tr').click(function() {
    // get the ID of the tr and redirect the page based on that
}); 
```

**编辑：**哦，如果这是我想作为查询字符串传递的值，我可以为行单元格执行此操作，但是，我不想这样做，因为这意味着显示用户的唯一标识符应该看不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T15:47:25.843

好吧，我没想到会真正解决我自己的问题。仅供参考，这里是：

```
If e.Row.RowType = DataControlRowType.DataRow Then
  e.Row.ID = e.Row.DataItem("Issue_Key")
End If 
```

它被放置在 RowDataBound 事件中。

# c# - 强制打开文件

> ID：722031
> 
> 赞同：3
> 
> 时间：2009-04-06T15:42:50.830
> 
> 标签：c#, file, permissions

一个 C++ 程序正在填充一个日志文件，它保存了一个日志文件的句柄。我想用 C# 程序打开这个日志文件并解析它以查看是否已将某一行添加到日志文件中。

但是，如果我使用 C# 打开日志文件，我会收到“此文件正在被另一个进程使用”IOException。使用的代码：

```
using(StreamReader reader = File.OpenRead(myFile))//IOException 
```

C++ 程序使用以下命令打开文件（我无法更改 C++ 程序）：

```
m_hFile = tsopen(m_csFilePath, 
_O_WRONLY|_O_APPEND|_O_TRUNC|_O_CREAT|_O_BINARY,
_SH_DENYWR,
_S_IREAD | _S_IWRITE); 
```

用记事本打开文件工作正常，所以应该可以打开它。我可以强制我的 C# 程序以只读模式打开文件吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-06T15:46:07.173

也许尝试用`ReadWrite` `FileShare`?

```
File.Open(myFile, FileMode.Open, FileAccess.Read, FileShare.ReadWrite) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T15:48:28.803

您可以使用获取日志文件的快照副本`File.Copy`并尝试打开它。

# security - 为什么默认情况下 Bluehost 中有一个符号链接 frow www/ 到 public_html/ ？

> ID：722032
> 
> 赞同：2
> 
> 时间：2009-04-06T15:42:55.010
> 
> 标签：security, webserver

我的网站在文件夹中

> public_html

我注意到 www/ 似乎有一个指向 public_html 的符号链接。

当我们有 public_html 时，我不知道为什么我们需要 www/ 文件夹。也许，这是一个安全原因。也许，应该隐藏网站所在文件夹的名称。

**为什么 www/ -folder 默认指向文件夹 public_html？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T15:45:35.410

`$HOME/public_html`是[用户 dirs](http://httpd.apache.org/docs/2.2/howto/public_html.html)的约定，`$HOME/www/domain`而是共享主机中用户域的典型约定。有了符号链接，您不必担心使用哪个符号链接。

# opengl - 为什么我的半透明顶点会使 OpenGL 中的背景对象更亮？

> ID：722033
> 
> 赞同：0
> 
> 时间：2009-04-06T15:43:34.247
> 
> 标签：opengl, opacity

我在彩色立方体前面渲染 4 个顶点（一个正方形）。顶点颜色为白色，但在 0.5f 处混合。

> 相关：[为什么我的彩色立方体不能与 GL_BLEND 一起使用？](https://stackoverflow.com/questions/721998/why-does-my-colored-cube-not-work-with-glblend)

请有人告诉我为什么彩色立方体在被半透明正方形遮挡时显得更亮？

立方体渲染的前面没有正方形：

[普通立方体 http://img408.imageshack.us/img408/2853/normalcube.png](http://img408.imageshack.us/img408/2853/normalcube.png)

并且，用正方形渲染：

[立方体 http://img142.imageshack.us/img142/6255/brightsquare.png](http://img142.imageshack.us/img142/6255/brightsquare.png)

请参阅用于[创建彩色立方体](http://pastebin.com/f5393f089)的代码、用于实际[绘制立方体](http://pastebin.com/f4aa216b6)的[代码以及呈现立方体和正方形](http://pastebin.com/f2966e1fe)的代码。

这是我的 init 函数中的代码：

```
glEnable(GL_CULL_FACE);
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T15:59:26.080

我会说这是因为您的半透明正方形被添加到现有像素中，从而增加了它们的强度。

[文档`glBlendFunc()`](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/blendfunc.html)建议将第二个参数设置为`GL_ONE_MINUS_SRC_ALPHA`，即实现透明度的样板。尝试一下。

# sql-server - 将日志文件配置为位于 RAID 阵列的特定磁盘上

> ID：722035
> 
> 赞同：2
> 
> 时间：2009-04-06T15:43:49.050
> 
> 标签：sql-server

我正在查看具有 RAID1+0 阵列和 RAID 5 阵列的服务器。RAID 1+0 用于系统文件，RAID 5 阵列用于 SQL 服务器数据库和日志文件。

RAID 5 阵列由 6 个 72GB SAS 驱动器组成。在 HP 阵列配置实用程序中，它们每个都被视为类似于“72GB SAS Dtive at Port 1l:Box 1: Bay 3”。在 Windows 中，它们被视为一个名为 D 的分区。

所以[我听说](https://stackoverflow.com/questions/719869/how-to-spread-tempdb-over-multiple-files)将 tempdb 拆分为每个 CPU 和物理磁盘的多个文件是一个好主意。我在 RAID 5 阵列中有 16 个 CPU 和 6 个磁盘。所以我想为 tempdb 创建 6 个数据文件。

现在，当我去更改 tempdb 以添加新数据文件时，我可以选择 D 驱动器...但是如何配置它，以便将六个文件中的每一个都放置在 RAID 阵列上的单独物理磁盘上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T15:53:50.257

When talking about separation of data files, the word disk can be interchanged with LUN's. It sounds though as if you are only using a single LUN i.e. presenting your entire RAID 5 array as a single partition.

Do you have 16 CPU's or 16 cores, for example 4 quad core CPU's? You should only really look to create a separate data file for each 'true' CPU in my opinion.

I suggest you read the following articles regarding the tempdb database before going ahead with any changes. Paying particular attention "Should I create multiple tempdb database files?".

[All about the tempdb database](http://johnsansom.com/index.php/sql-server-resources/sql-server-performance/the-tempdb-database/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T15:55:32.033

I think you might need to do a bit of reading on RAID. [http://en.wikipedia.org/wiki/RAID](http://en.wikipedia.org/wiki/RAID)

Using 5, your data is automatically striped over the disks in your array. You cannot choose on which disk it goes.

[http://msdn.microsoft.com/en-us/library/ms190764.aspx](http://msdn.microsoft.com/en-us/library/ms190764.aspx)

I don't remember reading any recommendations that you should put each of these files on a separate disk either.

# java - 在 Swing 中选择等宽字体的正确方法

> ID：722045
> 
> 赞同：9
> 
> 时间：2009-04-06T15:45:36.783
> 
> 标签：java, swing, fonts

我正在搞乱 DefaultStyledDocument 并试图找出将样式设置为正确等宽字体的正确方法。“正确”是指选择的字体是：

1.  存在于用户机器上的等宽字体
2.  由用户偏好指定的字体（在 Java 中有标准的方法吗？）
3.  如果没有指定字体，它将回退到标准等宽字体（“Monospaced”）。

这有效：

```
StyleConstants.setFontFamily(mainStyle, "Monospaced"); 
```

这也有效：

```
StyleConstants.setFontFamily(mainStyle, "Lucida Console"); 
```

但我似乎无法弄清楚如何判断所讨论的字体系列是否既存在于用户的机器上（setFontFamily 没有返回值）并且是等宽字体。如果我使用“Lucida Consoleq”，它似乎使用默认字体。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T03:25:57.113

请参阅[.java 文档](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Font.html)。`java.awt.Font`看来您可以使用该`public static Font decode(String str)`方法来完成您想要的。此方法的 javadoc 的最后一段说：

> 默认大小为 12，默认样式为 PLAIN。如果 str 未指定有效大小，则返回的 Font 的大小为 12。如果 str 未指定有效样式，则返回的 Font 具有 PLAIN 样式。如果您没有在 str 参数中指定有效的字体名称，则此方法将返回具有系列名称“Dialog”的字体。要确定系统上可用的字体系列名称，请使用 GraphicsEnvironment.getAvailableFontFamilyNames() 方法。如果 str 为 null，则返回一个新的 Font，其家族名称为“Dialog”，大小为 12，样式为 PLAIN。

如果您要查找的字体系列不存在，您将返回“Dialog”。只要您没有将其作为返回值，字体系列就存在。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-19T15:20:20.523

`Monospaced`是一个虚拟名称（如`Dialog`），Java 将映射到系统的默认固定宽度字体。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T19:56:47.537

我想你想要这个

```
GraphicsEnvironment.getLocalGraphicsEnvironment().getAvailableFontFamilyNames(); 
```

参见[javadoc](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/GraphicsEnvironment.html#getAvailableFontFamilyNames())

# python - 监控互联网活动

> ID：722046
> 
> 赞同：2
> 
> 时间：2009-04-06T15:45:44.677
> 
> 标签：python, monitoring, bandwidth

我正在考虑编写一个监视互联网活动的小应用程序（在 Python 中）。[与NetMeter](http://www.metal-machine.de/readerror/index.php?page=10)相同的想法，只是多了一点自定义（我需要能够设置非高峰时间范围）。

无论如何，我在研究这些问题时遇到了一些麻烦：

*   Python 有 API 来监控吗？
*   就数据收集而言，我可能会用时间戳记录以字节/分钟为单位的值——我在这里遗漏了什么更明智的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T15:52:28.060

The [pylibpcap](http://sourceforge.net/projects/pylibpcap/) project may actually give you what you want out of the box, or at least a leg up on implementing one yourself. It's a set of python bindings, as the name suggests, to the libpcap packet capture library.

# css - 如何访问文件上传按钮的属性？

> ID：722050
> 
> 赞同：0
> 
> 时间：2009-04-06T15:47:16.030
> 
> 标签：css, button, input

你能告诉我如何将 css 属性分配给 type=file 的按钮，比如：

```
<input type="file"  name="coolFile"> 
```

我知道在 CSS 中你需要这样做：

```
 input[type=file]{
     background:#ccf;
//and so on
} 
```

如何为按钮分配值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T15:50:59.437

假设您想更改按钮的文本，这里有一个关于如何做到这一点的教程：

[http://www.quirksmode.org/dom/inputfile.html](http://www.quirksmode.org/dom/inputfile.html)

如果它只是简单的 CSS 属性，如颜色/边框/等，你已经有了答案，你只需要检查一些东西来找出它为什么不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T16:08:05.653

不幸的是，主流浏览器不允许设计人员直接设置文件输入字段的样式。您可以将其视为“安全功能”，因为如果文件输入字段的样式以一种棘手的方式设置，用户可能会被诱骗上传文件。

有一个解决方案涉及创建第二个输入字段，并将实际的文件输入隐藏在它后面。以下内容来自[http://www.quirksmode.org/dom/inputfile.html](http://www.quirksmode.org/dom/inputfile.html)：

```
div.fileinputs {
    position: relative;
}

div.fakefile {
    position: absolute;
    top: 0px;
    left: 0px;
    z-index: 1;
}

input.file {
    position: relative;
    text-align: right;
    -moz-opacity:0 ;
    filter:alpha(opacity: 0);
    opacity: 0;
    z-index: 2;
}

<div class="fileinputs">
    <input type="file" class="file" />
    <div class="fakefile">
        <input />
        <img src="search.gif" />
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T15:55:52.077

您使用[DOM/JavaScript](http://www.w3schools.com/HTMLDOM/dom_obj_style.asp)，例如：

```
document.getElementById("id").style.property="value" 
```

# c# - 尝试添加行时，此行已属于另一个表错误？

> ID：722052
> 
> 赞同：214
> 
> 时间：2009-04-06T15:47:55.670
> 
> 标签：c#

我有一个包含一些行的 DataTable，我正在使用 select 过滤行以获取 DataRows 的集合，然后我使用 foreach 循环并将其添加到另一个 DataTable，但它给了我错误“此行已经属于到另一张桌子”。这是代码：

```
DataTable dt = (DataTable)Session["dtAllOrders"];
DataTable dtSpecificOrders = new DataTable();

DataRow[] orderRows = dt.Select("CustomerID = 2");

foreach (DataRow dr in orderRows)
{
    dtSpecificOrders.Rows.Add(dr); //Error thrown here.
} 
```

* * *

## 回答 #1

> 赞同：358
> 
> 时间：2009-04-06T15:50:00.487

您需要`Row`使用第一个值创建一个新值`dr`。A`DataRow`只能属于单个`DataTable`。

您还可以使用`Add`which 接受一组值：

```
myTable.Rows.Add(dr.ItemArray) 
```

或者可能更好：

```
// This works because the row was added to the original table.
myTable.ImportRow(dr);

// The following won't work. No data will be added or exception thrown.
var drFail = dt.NewRow()
drFail["CustomerID"] = "[Your data here]";
// dt.Rows.Add(row); // Uncomment for import to succeed.
myTable.ImportRow(drFail); 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-02-27T13:25:45.497

试试这个：

```
DataTable dt = (DataTable)Session["dtAllOrders"];
DataTable dtSpecificOrders = dt.Clone();

DataRow[] orderRows = dt.Select("CustomerID = 2");

foreach (DataRow dr in orderRows)
{
    dtSpecificOrders.ImportRow(dr);
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-20T08:53:01.690

```
yourTable.ImportRow(dataRow); 
```

这是因为您要复制的行不一样`TableName`：

例如，尝试：

```
Table1.TableName = "Table1";
Table2.TableName = "Table2"; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-06-29T10:16:06.267

```
foreach (DataRow dr in dtSpecificOrders.rows)
{
   dtSpecificOrders.Rows.Add(dr.ItemArray); 
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-06-13T19:58:14.363

这不是最干净/最快/最简单/最优雅的解决方案，但它是我为在类似情况下完成工作而创建的蛮力解决方案：

```
DataTable dt = (DataTable)Session["dtAllOrders"];
DataTable dtSpecificOrders = new DataTable();

// Create new DataColumns for dtSpecificOrders that are the same as in "dt"
DataColumn dcID = new DataColumn("ID", typeof(int));
DataColumn dcName = new DataColumn("Name", typeof(string));
dtSpecificOrders.Columns.Add(dtID);
dtSpecificOrders.Columns.Add(dcName);

DataRow[] orderRows = dt.Select("CustomerID = 2");

foreach (DataRow dr in orderRows)
{
    DataRow myRow = dtSpecificOrders.NewRow();  // <-- create a brand-new row
    myRow[dcID] = int.Parse(dr["ID"]);
    myRow[dcName] = dr["Name"].ToString();
    dtSpecificOrders.Rows.Add(myRow);   // <-- this will add the new row
} 
```

DataColumns 中的名称必须与原始表中的名称匹配才能正常工作。我只是以“ID”和“Name”为例。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-21T16:30:29.393

你为什么不直接使用`CopyToDataTable`

```
DataTable dt = (DataTable)Session["dtAllOrders"];
DataTable dtSpecificOrders = new DataTable();

DataTable orderRows = dt.Select("CustomerID = 2").CopyToDataTable(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-28T04:26:24.930

您可以为列提供一些 id 并将其命名为唯一。

# asp.net - Which metrics are most useful in an ASP .Net build server?

> ID：722061
> 
> 赞同：2
> 
> 时间：2009-04-06T15:50:19.750
> 
> 标签：asp.net, continuous-integration

I'm just wondering what metrics people measure on a build server.

I'm setting up a build server for a series of asp .net 2.0 projects.

On the server I'm currently measuring:

1.  Unit test code coverage.
2.  Build and test run time.
3.  LOC (just out of idle curiosity).
4.  Cyclomatic complexity.
5.  Some FxCop rules.

What do you measure and how do you measure it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T15:58:46.987

Not sure what the benefit of (2) is, do you find it useful?

I certainly look at FxCop and StyleCop violation counts. In an ideal world these are 0, but on some projects this isn't realistic (e.g. inheriting legacy code), so we set a threshold and try not to exceed it.

Test coverage is good.

Sometimes it may be interesting to measure number of checkins and / or changed files since the last build. I never found an actual use for it but it was interesting to see how the rate of checkins increased towards the release date.

# visual-studio-2008 - 在 Visual Studio 中卸载自定义项模板

> ID：722062
> 
> 赞同：4
> 
> 时间：2009-04-06T15:50:38.253
> 
> 标签：visual-studio-2008

我遵循了一些在线教程，并设法使用 Visual Studio 2008 安装了自定义项模板。

是否可以卸载我的自定义模板。我在尝试理解这一点时创建了几个模板，我不再需要这些模板中的一些。

我检查了注册表、压缩文件的 Common 7\IDE... 文件夹，但我不确定如何卸载模板。

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-06T16:06:47.433

这些模板通常安装在 Windows XP 机器上的“我的文档”文件夹中。

```
C:\Documents and Settings\Username\My Documents\Visual Studio 2008\Templates 
```

在 Vista 上

```
C:\Users\Username\My Documents\Visual Studio 2008\Templates 
```

在这里，它们按模板类型细分。（项目与项目）然后从那里语言。只需找到并删除您要删除的文件的 .zip。

# language-agnostic - 你如何归一化零向量

> ID：722073
> 
> 赞同：27
> 
> 时间：2009-04-06T15:52:31.667
> 
> 标签：language-agnostic, math, vector

假设您有一个函数“normalize”，它将一个数字列表（代表一个向量）作为输入并返回归一化的向量。当向量全为零或其分量之和为零时，结果应该是什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-06T15:56:53.840

从数学上讲，零向量不能归一化。它的长度将永远保持`0`。

对于给定的向量`v = (v1, v2, ..., vn)`，我们有：`||v|| = sqrt(v1^2 + v2^2 + ... + vn^2)`。让我们记住，归一化向量是具有 的向量`||v||=1`。

所以对于`v = 0`我们有：`||0|| = sqrt(0^2 + 0^2 + ... + 0^2) = 0`。你永远无法正常化它。

同样重要的是要注意，为确保一致性，您不应返回`NaN`或任何其他空值。的归一化形式`v=0`确实是`v=0`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-06T16:40:55.217

这甚至比尤瓦尔建议的还要糟糕。

在数学上，给定一个向量 x 你正在寻找一个新的向量 x/||x||

在哪里||。|| 是规范，您可能认为它是欧几里得规范

||。|| = sqrt(点(v,v)) = sqrt(sum_i x_i**2)

这些是浮点数，所以仅仅防止除以零是不够的，如果 x_i 都很小（它们可能下溢并且你失去幅度），你也会遇到浮点问题。

基本上这一切都归结为，如果你真的需要能够正确处理小向量，你将不得不做更多的工作。

如果小向量和零向量在您的应用程序中没有意义，您可以测试向量的大小并做一些适当的事情。

（请注意，一旦您开始处理浮点数，而不是实数，在可表示范围的大端和小端都进行诸如平方然后平方根数字（或它们的总和）之类的操作是有问题的）

底线：在所有情况下正确进行数值工作比最初看起来更棘手。

例如，这种（标准化）操作以天真的方式完成的潜在问题

*   所有组件（x_i）太小
*   任何太大的单个分量（大于最大可表示的平方根）将返回无穷大。这会通过 sqrt 逐个削减可用幅度。
*   如果大组件与小组件的比例过大，一不小心就会有效地失去小组件的方向
*   等等

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-25T23:32:46.893

从数学上讲，零向量不能归一化。这是我们在计算几何中所说的“退化情况”的一个例子，这是一个巨大的话题，让几何算法设计者非常头疼。我可以想象以下解决问题的方法。

1.  您对零向量情况没有任何特别之处。如果您的向量类型具有浮点类型坐标，那么您将在结果中获得零坐标或无限坐标（由于除以零）。
2.  你扔一个`degenerate_case_exception`.
3.  您将布尔`is_degenerate_case`输出参数引入您的过程。

我个人在我的代码中到处使用 3 方法。它的优点之一是它不会让程序员忘记处理退化的情况。

请注意，由于浮点数的范围有限，即使输入向量不等于零向量，您仍然可能在输出向量中得到无限坐标。因此，我不认为 1\. 方法是一个糟糕的设计决策。

我可以向您推荐的是避免抛出异常的解决方案。如果退化情况在其他情况中很少见，那么抛出异常不会减慢程序的速度。但问题是，在大多数情况下，您无法知道退化的情况会很少见。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-06T17:21:52.840

正如已经多次提到的，您不能标准化零向量。因此，您的选择是：

1.  返回零向量
2.  返回 NaN
3.  返回一个位，指示向量是否成功归一化，如果成功则返回结果
4.  抛出异常

选项 4 不是很好，因为某些语言（例如 C）没有异常，并且通常在非常低级的代码中发现向量的规范化。抛出异常是相当昂贵的，并且任何可能想要处理零/小向量情况的代码都会在发生这种情况时受到不必要的性能影响。

选项 1 的问题是返回值没有单位长度，因此它可能会在假定结果向量具有单位长度的调用代码中静默引入错误。

选项 2 与选项 1 有类似的问题，但由于 NaN 通常比零更明显，因此它可能更容易显现。

我认为选项 3 是最好的解决方案，尽管它确实使界面更加复杂。而不是说

```
vec3 = myVec.normalize(); 
```

你现在必须说类似

```
vec3 result;
bool success = myVec.normalize(&result);
if(success)
    // vector was normalized
else
    // vector was zero (or small) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-06T16:01:04.920

很像 0/0。应该抛出异常或返回 NaN。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T15:56:49.953

(0,0,0) 应该是 (0,0,0) 标准化加上警告（或异常）可能。
我猜在数学上它没有定义。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T15:57:55.770

好吧，你必须除以零，这是你做不到的，所以我认为大多数语言都会有某种 NaN 值。

参考：

*   [XNA](http://forums.xna.com/forums/t/5707.aspx)
*   [Apple](http://lists.apple.com/archives/mac-games-dev/2008/Apr/msg00017.html)（您还必须为矢量选择任意方向）
*   [搅拌机](http://www.blender.org/documentation/243PythonDoc/Mathutils.Vector-class.html)（使用 Python）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-06T16:02:26.587

在我遇到过的向量范数的任何定义下，零向量已经被归一化，所以这是处理的一种情况。

至于具有总和为零的分量的向量 - 这取决于您使用的规范的定义。使用普通的旧 L2 范数（原点和向量之间的欧几里德距离），用于计算归一化向量的标准公式应该可以正常工作，因为它首先对各个分量进行平方。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-06T17:30:40.243

给定一个向量 v，对其进行归一化意味着保持其方向并通过将其乘以一个精心选择的因子使其成为单位长度。

这对于零向量显然是不可能的，因为它实际上没有方向，或者因为它的长度不能通过将它乘以某个因子来改变（它总是等于零）。

我建议无论您想将向量用于什么过程，并且需要对该向量进行归一化，对于零向量都没有明确定义。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2016-12-27T22:31:57.407

这完全取决于您如何定义“标准化”。该术语的一种可能的扩展是说此操作的结果是任何单位长度的向量（我在这里主要使用 (1, 0, 0) ）。例如，当您需要归一化以将方向从给定点返回到圆边界时，这很有用。

# sql-server - 如何将 TFS 作为源代码控制插件添加到 SQL Server Management Studio Express 2008？

> ID：722079
> 
> 赞同：13
> 
> 时间：2009-04-06T15:54:46.403
> 
> 标签：sql-server, tfs, ssms

在 SQL Server Management Studio Express 2008 选项中，在源代码控制下，“开箱即用”的唯一可用选项是 Microsoft Visual SourceSafe，以及...（等待它）...Microsoft Visual SourceSafe（互联网）。

由于我确实安装了 VSTS 2008，当然还有 TFS 客户端，我觉得奇怪的是 SSMS Express 不包括对它的支持，尤其是 2008 版本。

是的，我知道我可以在 VSTS 中完成我（通常）在 SSMS Express 中所做的所有事情，并且收工。然而，它比这更复杂一些，并且在我正在考虑的一些场景中选择的工具是 SSMS 2008 Express。

这是 Express 与完整版的对比吗？还是完全不支持？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-06T15:59:02.663

您需要安装此[提供程序](http://www.microsoft.com/downloads/details.aspx?familyid=FAEB7636-644E-451A-90D4-7947217DA0E7&displaylang=en)。

> Visual Studio Team System 2008 Team Foundation Server MSSCCI Provider 支持将 Team Foundation 版本控制与不支持 Team Explorer 集成的产品集成使用。

这确实包括 SSMS

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-05-20T12:20:09.487

对于 Visual Studio 2010，这里有一个链接：http: [//visualstudiogallery.msdn.microsoft.com/bce06506-be38-47a1-9f29-d3937d3d88d6](http://visualstudiogallery.msdn.microsoft.com/bce06506-be38-47a1-9f29-d3937d3d88d6)

对于 Visual Studio 2012，链接是 [http://visualstudiogallery.msdn.microsoft.com/3c7b6813-2617-4d5f-9a1d-5ad980cab5d2](http://visualstudiogallery.msdn.microsoft.com/3c7b6813-2617-4d5f-9a1d-5ad980cab5d2)

# c# - 从设计页面调用 C#

> ID：722082
> 
> 赞同：0
> 
> 时间：2009-04-06T15:55:35.200
> 
> 标签：c#, html

嗨，可以执行以下操作吗？

```
 <a href="/Reports/report.aspx?StartDate=<% Request.Params.Get("StartDate"); 
  %>&EndDate=<% Request.Params.Get("EndDate"); %>">View analysis</a> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T16:03:57.130

您可以这样做，但是，这可能允许恶意用户向参数提供意外数据。

我强烈建议在将数据放入页面之前清理数据并确保它是您所期望的。

还要相信代码块开头所需的语法是 <%= （注意 = 符号）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T16:12:24.597

当然，这是可能的！您首先需要解析引号，其次，您应该使用 ASP.NET Response.Write 语法 ( `<%=Expression%>`)：

```
<a href='/Reports/report.aspx?StartDate=<%= Request.Params.Get("StartDate"); %>&EndDate=<%= Request.Params.Get("EndDate"); %>'>View analysis</a> 
```

但是推荐吗？我认为不会。原因可能从打开潜在的安全漏洞（允许使用未经检查的查询字符串数据）到简单的可读性问题到代码分离。请记住，这是在 ASP.NET 出现之前编写经典 ASP 代码的方式。

在检查查询字符串的有效值并分配`asp:HyperLink`控件的 NavigateUrl 之后，在代码隐藏中执行此逻辑会更好。

# sql - 如何使用 Perl 检索临时表的 SQL 字段名称？

> ID：722088
> 
> 赞同：3
> 
> 时间：2009-04-06T15:57:30.077
> 
> 标签：sql, perl, field

下面是我用来运行查询、解析结果集和解析行的代码（分别）

```
$exec_ret = $DBS->SQLExecSQL($STMT);

while ($DBS->SQLFetch() == *PLibdata::RET_OK)
{
      $rowfetch = $DBS->{Row}->GetCharValue($colname[$i]);
} 
```

我可以使用类似的语法获取临时表的列/字段名称吗？ `$colname[$i]`在顶部预定义以保存列/字段名称。这现在是硬编码的，但我宁愿通过将值推送到`$colname`在解析行之前运行的循环内部来自动化它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-06T17:02:15.147

您使用什么模块进行数据库访问？我不认识方法名称。

如果您使用的是[DBI](http://search.cpan.org/perldoc?DBI)，则可以在执行后从语句句柄中获取列名：

```
my $sth = $dbh->prepare($STMT);
$sth->execute;
my $columns = $sth->{NAME_uc};

while (my $row = $sth->fetch) {
  for my $i (0 .. $#$row) {
    print "$columns->[$i]: $row->[$i]\n";
  }
  print "\n";
} 
```

列名有 3 个版本：`NAME`在数据库返回时给出列名，`NAME_lc`将它们转换为全部小写，`NAME_uc`并将它们全部转换为大写。如果您关心数据库独立性，我建议您避免`NAME`使用其他两种中的一种。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T16:06:04.097

尝试运行**SHOW TABLE yourtable**并将其视为 SELECT。

# windows-services - Windows Vista 是否会阻止 Windows 服务访问 Internet 或 USB 硬件？

> ID：722091
> 
> 赞同：0
> 
> 时间：2009-04-06T15:57:50.263
> 
> 标签：windows-services, vista-security

我创建了一个 Windows 服务，它将定期运行一个 exe 文件以检查 FTP 站点上的文件，处理找到的任何文件，将数据输入 SQL 数据库并将标签打印到本地打印机。

目前我们正在运行 Windows XP Professional，但如果我们迁移到 Vista（或 Windows 7），增加的安全性会阻止我的服务运行吗？我们没有任何可用的 Vista 机器，所以测试是个问题。

该服务使用本地系统帐户并从注册表中读取触发周期和 exe 来调用。我了解 exe 与服务在同一级别运行，因此不会在屏幕上生成用户交互。我们使用连接到 USB 端口的标签打印机，我知道即使在用户登录之前，它也可以在 XP 上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T17:03:25.737

简短的回答可能是“不”（它没有），但我认为在 SO 上发布问题不会消除测试您的应用程序的需要（特别是因为长答案当然是“这取决于” - 取决于安全配置和其他软件、硬件防火墙等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T17:04:54.363

你可能想看看这个线程：

[Windows XP 和 Vista 编程的主要区别是什么？](https://stackoverflow.com/questions/22674/what-are-the-main-differences-between-programming-for-windows-xp-and-for-vista/22684)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T21:45:35.247

看起来您可以在 Vista 下更大程度地指定服务的权限，因此无需使用本地系统帐户提供的完全访问权限。

[Microsoft提供的 Windows Vista](http://go.microsoft.com/fwlink/?LinkId=71280)中的文档服务介绍了在 Vista 下引入的更改。

从积极的方面来看，如果您不指定任何降低的权限，那么使用的帐户（在本例中为本地系统）的默认权限将适用，因此在等待实际测试时应该不会有问题。

# c# - 多态性问题 - 虚拟字段？（C＃）

> ID：722092
> 
> 赞同：1
> 
> 时间：2009-04-06T15:57:54.587
> 
> 标签：c#, xna, polymorphism

我的班级设计有问题。

我的游戏对象有核心类。在绘图时，我需要从对象中检索位置。不幸的是，对象被视为它的基类型，因此该位置不是从派生类中检索的，而是从其父类中检索的。将字段定义为虚拟可以解决我的问题，但这是不可能的:(。如何设计类模式来避免这个问题？

正在发生的事情的简单示例：

```
class BaseClass { public Vector2 position = new Vector2(){X=0,Y=0}; }
class Class:BaseClass { public new Vector2 position = new Vector2(){X=10,Y=10}; }

BaseClass c = new Class();
// c.position.X is now 0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T16:01:17.993

您可以对其进行修改以使用虚拟属性而不是字段。这将正确处理事情。

如果由于某种原因无法使用属性，您还可以按如下方式修改构造函数：

```
class BaseClass
{
    public Vector2 position = new Vector2(){X=0,Y=0};
}

class Class:BaseClass 
{ 
    public Class()
    {
        this.position = new Vector2(){X=10,Y=10};
    }
} 
```

这并不完全相同，因为您没有用自己的基类字段隐藏基类字段，但它会正确初始化它，以便您可以按照示例建议使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T16:04:09.280

*   关键字表示隐藏基类中定义的`new`同名符号。
*   `public`字段在 C# 中被视为“气味”

`override`解决方法：在派生类中使用properties和property：

```
class BaseClass {
    public virtual Vector2 Position {
        get { return new Vector2(){X=0,Y=0}; }
    }
}

class Class : BaseClass {
    public override Vector2 Position {
        get { return new Vector2(){X=10,Y=10}; }
    }
} 
```

您可以使用支持字段来存储`Vector2`.

或者，您可以让基类处理位置并传递一个初始值：

```
class BaseClass {
    private Vector2 _position;
    public BaseClass() {
        _position = new Vector2(){X=0,Y=0};
    }
    protected BaseClass(Vector2 initialPosition) {
        _position = initialPosition;
    }
    public Vector2 Position {
        get { return _position; }
        set { _position = value; }
    }
}

class Class : BaseClass {
    public Class() : base(new Vector2(){X=10,Y=10}) {
    }
} 
```

# linq - Lambda 分组上的 LINQ 操作

> ID：722094
> 
> 赞同：1
> 
> 时间：2009-04-06T15:58:03.197
> 
> 标签：linq, lambda, group-by

我被一个LINQ组困住了，试图在不使用`foreach`语句的情况下解决它，这里是escenary：

我有两个通用集合`List<OrderHeader>`和`List<OrderDetail>`，它们都有一个`TOTRGVS`包含订单总额的相同字段，并且订单数是名为 的键`NDORGV`。

然后我想找到“与和不同`TOTRGVS`的订单”，所以我尝试了以下查询：`OrderHeader``OrderDetail`

```
 List<RGVCAFAC_ERRORES> diff = (from d in lstOrderDetail 
                               join c in lstOrderHeader on d.NDORGV equals c.NDORGV                                                     
                               group d by d.NDORGV into g
                               let difTOTOrderDetail = g.Select(p => p.TOTRGVS).Sum()
                               let difTOTOrderHeader = g.Key.????
                               let diffTOT = difTOTOrderHeader - difTOTOrderDetail
                               where diffTOT != 0
                               select new _ERRORS
                               {
                                   NDORGV = g.Key,
                                   IMPORT = diffTOT
                               }
  ).ToList(); 
```

在`difTOTOrderHeader`我不知道如何`TOTRGVS`从`OrderHeader`. 我尝试使用 Key 但无法获取任何字段，只是格式化方法的扩展。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T17:02:26.317

这可能会奏效：

```
var dictDetails = lstOrderDetail
  .GroupBy(d => d.NDORGV)
  .ToDictionary(g => g.Key, g => g.Sum(d => d.TOTRGVS));

var result = lstOrderHeader
  .Where(h => dictDetails[h.NDORGV] != h.TOTRGVS)
  .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T16:03:45.897

该`Except`函数通常用于确定列表中的差异。

# c# - C# DataSet Index

> ID：722095
> 
> 赞同：1
> 
> 时间：2009-04-06T15:58:08.203
> 
> 标签：c#, .net, indexing, dataset

I need to find records in a dataset that have certain values from more than 1 column. I cannot use the Find or Contains method since they require a primary key and my search values can be non-unique. Do DataSets have indexes (Much like a SQL table) that I can use to speed up my search? Right now I'm looping through the dataSet doing compares for each column but this method is very very slow (my data set has 600k rows).

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T16:00:38.197

You can use the DataTable Select method which lets you search according to a search criteria

```
DataRow[] myRows = ds.Tables[0].Select("intCol=0 OR stringCol='yourSearch'"); 
```

# asp.net-mvc - ASP.NET MVC 通用 Html 和 Url 助手

> ID：722097
> 
> 赞同：1
> 
> 时间：2009-04-06T15:58:34.707
> 
> 标签：asp.net-mvc

通用 html 控件和 url 助手去哪里了？

你知道那些看起来像这样的：

```
this.TextBox<MyInputModel>(model=>model.Name)

this.ActionLink<MyController>(controller=>controller.Index) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T16:03:11.937

这些是（并且一直是，我认为）在 MvcFutures 程序集中。升级到已发布版本时，您需要更新到最新的 MvcFutures。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T16:06:09.010

它们是位于程序集 Micosoft.Web.MVC 中的扩展。您必须将此程序集添加到您的项目中，并在 web.config 文件中添加对它的引用。您应该查阅以下答案以获取更多详细信息：[在哪里获取 Microsoft.Web.Mvc.dll](https://stackoverflow.com/questions/334408/where-to-get-microsoftwebmvcdll)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T16:01:12.720

它们应该出现在通用视图上。IE

```
ViewPage<MyInputModel> 
```

或通用用户控件

```
ViewUserControl<MyInputModel> 
```

但这应该是

```
html.TextBox(model=>model.Name) 
```

请注意这是未经测试的代码。

# c++ - CAsyncSocket and threading

> ID：722098
> 
> 赞同：0
> 
> 时间：2009-04-06T15:58:40.497
> 
> 标签：c++, sockets, mfc, mfc-networking

I'm using a MFC CAsyncSocket to do some network communication in a multi-threaded environment. After several hours of trying to get the accepted sockets to accept incoming data I came across a page that states that for a CAsyncSocket's OnReceive function to be called the socket has to be in the context of the main GUI thread. Moving it to the main GUI thread has allowed the socket to start receiving data.

My question is this: does anyone know of a workaround for this? The socket was on a GUI thread before and the OnAccept was being called fine. The accepted socket could be used to send data no problem, just couldn't receive anything. I'd rather not have to re-architect this part of the software if I can avoid it.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T16:58:22.023

简单地为您的套接字创建一个具有自己的消息队列的单独线程会更简单吗？我认为不需要在主消息队列上创建 CAsyncSocket，只需在一些消息队列上创建即可。请参阅 CWinThread 的文档以了解如何使用自己的 MFC 兼容消息队列创建单独的线程。

不幸的是，从新线程的上下文中调用所有套接字操作至关重要。MFC 在隐藏类中使用全局状态，这些隐藏类使用线程本地存储来保存每个线程的信息，并且该信息用于 CAsynchSocket 的许多方法中。这意味着 CAsynchSocket 具有线程亲和性，您必须始终在任何线程中使用和创建它作为它的消息泵。

一种方法是创建一个 CWinThread，在该线程上创建您自己的自定义 MFC 隐藏窗口（通过在该线程的上下文中创建窗口），并在该窗口上为所有套接字操作创建消息和消息处理程序（创建、连接等）你做的。确保线程正在发送消息（“Run()”方法执行此操作），然后将消息发布/发送到您的窗口以控制您的套接字。

另外，请记住，来自套接字的回调将在与 UI 或工作线程不同的线程中进入。如果您正在更新 GUI 对象，您将需要担心竞争条件和可能的 GUI 线程关联问题。

如果您担心设计影响，只需创建自己的 CThreadSafeAsynchSocket 代理对象并通过消息传递到隐藏窗口委托给实际实现。您可以使用 SendMessage 进行阻塞操作，使用 PostMessage 进行异步操作。如果将构造函数包装在工厂对象中，则可以延迟创建套接字线程，直到需要它为止。

我能想到的最后一个问题是，您需要检测所有代理何时消失并关闭线程。您可以使用由 CThreadSafeAsynchSocket 的构造函数/析构函数管理的全局引用计数来检测何时关闭线程。即使在您关闭主应用程序窗口后，未能关闭线程也会让您的应用程序在隐藏窗口中徘徊。

# php - PHP 对象序列化和会话

> ID：722103
> 
> 赞同：4
> 
> 时间：2009-04-06T15:59:56.437
> 
> 标签：php, session

如何将子对象序列化为 $_SESSION？这是我正在尝试的示例：

## 数组测试.php：

```
<?php

class ArrayTest {
    private $array1 = array();
    public function __construct(){
        $this->array1[] = 'poodle';
    }
    public function getarray(){
        return $this->array1;
    }
}

class DoDoDo {
   public $poop;
   public function __construct(){
        $poop = new ArrayTest();
    }
    public function foo()
    {echo 'bar';}
}

?> 
```

## 第 1 页：

```
<?php
require_once('arraytest.php');
session_start();
$bob = new DoDoDo();
$_SESSION['bob'] = serialize($bob);
?> 
```

## 第2页：

```
<?php
require_once('arraytest.php');
session_start();
$bob = unserialize($_SESSION['bob']);
$bob->foo();
print_r($bob->poop->getarray()); // This generates an error.
?> 
```

不知何故，当我反序列化对象时，第 1 页中`ArrayTest`分配给对象`$poop`属性的实例不再存在，这可以从第 2 页在标记行上生成致命错误的事实证明：

> 致命错误：在第 6 行调用非对象上的成员函数 getarray()

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-06T16:22:24.230

你的问题不是序列化。类 dododo 的构造函数有一个错误。您不是在引用类对象，而是在构造函数的命名空间内引用一个新变量“poop”。你缺少一个 $this->.

```
`class dododo{
   public $poop;
   public function __construct(){
        $this->poop = new arraytest();
    }
    public function foo()
    {echo 'bar';}
}` 
```

`它适用于此更改。`

 `* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T16:25:27.063

It has got nothing to do with serialization. It doesn't exist in the first place. You've got it wrong in the constructor, should be:

```
 public function __construct(){
        $this->poop = new arraytest();
    } 
```

# asp.net - 在 ASP.NET 应用程序上记录 Visual Basic 异常的最佳方法是什么？

> ID：722104
> 
> 赞同：2
> 
> 时间：2009-04-06T15:59:59.480
> 
> 标签：asp.net, vb.net, logging

我正在开发一个使用 Visual Basic 编写的 ASP.NET Web 应用程序，并且我正在尝试追踪我收到的错误消息。

我想让它将异常记录到文件（或事件日志）中，以便我可以看到它，因为错误仅发生在生产服务器上，而不是在开发环境中（因此未安装 VS那里...）。

有没有人对如何做到这一点的最佳实践有任何想法？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T16:02:36.180

不确定这是否是“最佳实践”，但最常见的方法是使用[log4net](http://logging.apache.org/log4net/index.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T16:03:48.580

使用[log4net](http://logging.apache.org/log4net/index.html)或[Enterprise Library Logging](http://msdn.microsoft.com/en-us/library/dd139916.aspx)。我还要添加一个记录所有未处理错误的 http 模块（过滤掉 404 错误）。

在执行全局错误处理程序时，您可能想要开发一些方法来知道您已经记录了一个错误。如果您想在更接近错误源的地方记录错误，从而允许您将更多上下文包含到错误中，则会发生这种情况。

就我而言，当我记录任何错误时，我会在异常的数据收集中添加一个项目。然后，我的全局错误处理程序检查所有异常对象，以验证我们没有记录任何异常对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-04-20T12:45:21.527

很惊讶还没有人提到[Elmah](http://code.google.com/p/elmah/)

[Elmah](http://code.google.com/p/elmah/)是专门为使用 ASP.NET 进行错误记录而构建的，它的优点之一是您可以将其添加到 ASP.NET 应用程序中，只需将 DLL 放到 Bin 目录中，并对 Web 进行一些编辑.config 文件。无需更改代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T00:33:41.960

如果您运行的是 ASP.NET 2.0 或更高版本，最好什么都不做。默认情况下，ASP.NET Health Monitoring 会将异常记录到应用程序事件日志中。只需使用 eventvwr.exe 并查找来自“ASP.NET”的警告。它记录的信息非常完整。

当我说“什么都不做”时，我的意思是如果你只想记录它们，就不要捕获异常。如果愿意，您可以设置自定义错误页面，但请确保异常不会在顶层捕获。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T16:07:44.810

凌乱：当它出现时，抓住它（假设你可以？）并尽可能多地将数据放到 PAGE 中。将其放在 HTML 注释中，以便用户看不到它。就像是：

> lblError.Text = (把格式化的异常信息放在这里);
> 
> < ! -- <asp:label id=lblError /> -->

几乎一样乱：查找 Trace.WriteLine 有点东西。您可以在 ASP.NET 中启用跟踪，它允许您转到特定页面 (_trace.axd?) ​​并获取该页面加载的所有消息的转储。我没有真正使用过它，但它确实有效。

少一点混乱（因为这似乎是暂时的事情）：使用 Trace.WriteLine 输出内容，并在服务器上运行 debugview （来自微软），如果您有物理访问权限。然后您可以捕获此调试输出（此处的核心 win32 api 是 OutputDebugString - 我认为 .net 调用是 Debug.WriteLine）

更好：Log4Net。设置它，以便您可以在任何地方使用它。大多数时候将其置于“ERROR”，但在这种情况下，请使用“DEBUG”，直到找到解决方案。

我会选择 3，然后选择 4。或者现在选择 3，下次稍微清理代码库时选择 4。

:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T16:07:58.273

如果您可以获取站点的 global.asax - 然后在 Global.asax 的“Application_Error”部分执行类似的操作

Dim ex As New Exception() ex = Server.GetLastError().GetBaseException() Dim g As New 通用函数 ASendEmailFunction(ex.Message.ToString() & ex.Source.ToString() & ex.StackTrace.ToString())

这将获取应用程序的每个错误并向您发送所有详细信息 - 您需要创建仅向您发送包含内容的电子邮件的 ASendEmailFunction()

（你可以做得比这更好，但我直接在这个框中输入）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T16:12:26.437

最常用的日志记录库是企业库日志记录块或 log4Net：-企业库日志记录块文章： http: [//www.codeproject.com/KB/architecture/GetLoggingWithEntLib.aspx](http://www.codeproject.com/KB/architecture/GetLoggingWithEntLib.aspx) -Log4Net： [http://www.ondotnet .com/pub/a/dotnet/2003/06/16/log4net.html](http://www.ondotnet.com/pub/a/dotnet/2003/06/16/log4net.html)

干杯

# visual-studio - 实现类可以从其实现的接口“继承” XML 注释吗？

> ID：722106
> 
> 赞同：13
> 
> 时间：2009-04-06T16:00:59.163
> 
> 标签：visual-studio, sandcastle, xml-documentation

好奇的问题。我正在使用 Microsoft 的 Sandcastle 从我的 C# 代码中的 XML 注释生成文档。我的几个类正在实现已经有注释方法的接口。我宁愿不要在接口方法和公共实现方法中复制文档。我可以使用某种标签从界面“继承”此文档吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-01-23T12:52:49.367

您可以`<inheritdoc/>`在实现中添加。

您应该查看以下线程： [在 C# 中同步接口和实现注释的方法](https://stackoverflow.com/questions/824007/ways-to-synchronize-interface-and-implementation-comments-in-c-sharp)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T16:31:49.073

Visual Studio 中当前不存在此功能。

您可以获得第三方工具，例如帮助创建 XML 文档的 GhostDoc。GhostDoc 还可以选择生成“继承”的文档，就像您尝试做的那样。

链接：[GhostDoc](http://www.roland-weigelt.de/ghostdoc/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-20T23:55:08.113

如果其他人正在寻找解决方案，我构建了一个库来对 XML 文档文件进行后处理，以添加对 <inheritdoc/> 标记的支持。

更多信息请访问[www.inheritdoc.io](https://www.inheritdoc.io/)（提供免费版本）。

# oracle - select * returns CLOB

> ID：722113
> 
> 赞同：2
> 
> 时间：2009-04-06T16:01:45.277
> 
> 标签：oracle, clob

I have not used oracle before and I was to modify the clob data as it has my home phone number. But when I do `select * from` table shows `CLOB` and I cannot see the data. How can I see the data and how to I Update?

I need the query.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T16:11:48.983

在`PL/SQL Developer`中，选择`ROWID`表格列：

```
SELECT  t.*, t.rowid
FROM    mytable t 
```

这将允许您编辑表格的数据。

然后只需检查`...`该字段附近的按钮`CLOB`并进行编辑。

您可以从文件中加载它，也可以只在编辑字段中输入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T19:37:35.307

您使用什么工具来执行查询？sqlplus 会将 clob 列中的选择截断为参数 long 的值。如果您使用的是 sqlplus，则将 long 设置为足够大的值以容纳 clob，然后执行简单的选择应该返回数据。Clob 只是文本，因此可以像表中的任何其他列一样查询它。如果您使用的是 sqlplus 并且它不返回任何内容而不是部分返回，请确保已填充表中的列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T16:27:34.437

在代码中？

Java（更新作为 dbo 对象中的字段保存的 CLOB 字段）：

```
String sql = "SELECT clobby_wobby FROM table WHERE uuid = ? FOR UPDATE";
PreparedStatement ps = conn.prepareStatement(sql);
ps.setLong(1, dbo.getUID());
ResultSet rs = ps.executeQuery();
if (rs.next()) {
    oracle.sql.CLOB clob = (oracle.sql.CLOB) ((OracleResultSet) rs).getClob(1);
    failed = writeClob(clob, dbo.getClobbyWobby());
}
rs.close();
ps.close(); 
```

其中 writeClob() 是：

```
protected boolean writeClob(oracle.sql.CLOB clob, String data) throws SQLException {

    if (data == null) { return false; }
    return writeClob(clob, data.toCharArray());
}

protected boolean writeClob(oracle.sql.CLOB clob, char[] data) throws SQLException {

    if (data == null || clob == null) { return false; }
    char[] buffer = new char[clob.getBufferSize()];
    Writer os = clob.getCharacterOutputStream();
    int len = -1;
    CharArrayReader car = new CharArrayReader(data);
    try {
        while ((len = car.read(buffer)) != -1) {
            os.write(buffer, 0, len);
            os.flush();
        }
    } catch (IOException ioe) {
        logger.error("IOException copying clob data into DB", ioe);
        return false;
    } finally {
        try {
            car.close();
            os.close();
        } catch (IOException ioe) {}
    }
    return true;
} 
```

有时我想知道为什么该死的 Oracle 驱动程序本身无法检测到一个字段是一个 CLOB 并且只是透明地处理 ps.setString("very long value"); 本身......这就是有人回答说“为什么不使用 Oracle LOB Java 实用程序方法？！”的地方 我从来不知道...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-29T19:27:39.497

在 SQL 开发人员中，“打开”表。选择“数据”选项卡（这将检索所有数据）。然后在过滤器栏（顶部）中，提供您的条件以获取要更新的单行。更新所需的列，然后提交更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T17:49:16.587

我正在使用 dbVisualizer 并且我进行了定期更新并且它有效。感谢 MichaelN 告知 Clob 只是文本，因此可以像表中的任何其他列一样查询它。这帮助我在几分钟内解决了我的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T17:32:33.483

您使用的是旧版本的 sqlplus 吗？

如果您使用的是 sql developer，只需使网格的列更宽。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-01T18:50:46.850

我为您介绍我的方法：这是 pl/sql 中的一个示例。您可以创建一个从 clob 读取的过程。

```
 Declare 
  Variableclob Clob;
  Temp_Save Varchar2(32767);
  index_pass number;
  Begin

  For I In (select id_reporte from reporte where id_reporte between 201 and 218)
  Loop
  Index_Pass:=To_Number(I.Id_Reporte);
  Select Consulta Into Temp_Save From Reporte Where Id_Reporte=Index_Pass;
  Variableclob:=To_Clob(Temp_Save);

  Dbms_Output.Put_Line(Variableclob);

  End Loop ;
  End;

  Remember to use:
  set serveroutput on;
  begin DBMS_OUTPUT.ENABLE(9999999999999); end; 
```

# hibernate - What should I learn first, Spring or Hibernate?

> ID：722121
> 
> 赞同：38
> 
> 时间：2009-04-06T16:03:25.493
> 
> 标签：hibernate, spring, jakarta-ee

I've just started learning Struts and I'm trying to be marketable for a good job as a Java programmer. My next decision would be choosing which to learn next, Spring or Hibernate?

Also do you guys have any suggestions or tips for me to be good? Thanks in advance!

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-04-06T16:05:21.027

I'd suggest learning Spring. Learn just the basics, and then when you *do* come to learn Hibernate you'll be able to take advantage of all the Spring helpers which make Hibernate easier to use.

There's also the point that Spring is useful in many layers instead of just at the data access part :)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-06T16:31:04.223

Spring 和 Hibernate 是 2 种非常互补的技术，根据需要，您可以同时使用或不使用两者。但是这两个框架所依赖的基础都是 100% 适销对路的，更重要的是，任何经验丰富的专业人士都需要。

如果不首先获得关系数据建模、关系数据库设计和事务处理的基础知识，学习 Hibernate 几乎没有价值。因此，这些应该是您使用 Hibernate 的先决条件。

如果不首先获得有关设计模式、依赖注入和应用程序设计的基础知识（听起来很笼统，您需要了解诸如应用程序层、类和包依赖项、MVC 之类的东西（听起来您熟悉这一个通过 Struts）、安全和 Web 标准，当然还有 OOD 的基础知识）。

通过学习这两者，您将成为即使没有市场但至少非常扎实的专业人士，他们对大多数 Java（而不仅仅是 Java）应用程序工作充满信心和舒适。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-06T16:06:20.447

I think Hibernate is fairly easy and straighforward to get basic usage skills in, and perhaps more importantly, the EJB3 is becoming a standard.

Spring is an external technology, not part of J2EE officially, so it might make sense to do it second, it also has a lot more facets and you really want a good book for it.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-07T23:14:28.367

Spring 比 Hibernate 更大，更普遍适用。您的决定是学习曲线的长度和完成后您将拥有的效用之间的权衡。

我推荐 Spring，因为它既可以与 Struts 和 Hibernate 共存，也可以为其中任何一个（Spring web MVC 和 Spring JDBC）提供替代方案。

Spring 将对您的 Java EE 设计产生有益的影响。从那开始。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-07-30T21:33:46.353

如果它的目标是学习 MVC 框架以及如何在该框架中使用 ORM，那么学习的逻辑方法是 Spring，然后是 Hibernate。在我看来，这样你就可以很容易地掌握这些概念

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T10:15:36.867

这些天我不会去 Struts。如果你已经在考虑 Spring，你也应该看看 Spring MVC，尤其是新的基于注解的控制器非常好用。

我建议在 Hibernate 之前学习 Spring，因为如果你坚持核心，也许 WebMVC 会更容易学习，这是我推荐的。Spring 在上一个版本中增长了很多，但核心仍然简单易懂。

休眠要复杂得多。我建议了解像 Hibernate 这样的 ORM 的一般用途，学习配置 hibernate 的 hibernate 注释方式，然后直接进行 Spring/Hibernate 集成，因为它使许多事情变得更加容易。如果您的域有多个基本类型，您还可以查看[GenericDAO 模式](http://www.ibm.com/developerworks/java/library/j-genericdao.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-08T01:49:34.107

我会先去春天。Spring 有很多有用的部分：依赖注入、面向方面的编程、JDBC 帮助器类、整个 MVC 框架和加载更多。您可以在您的第一个应用程序中尽可能少地或尽可能多地使用 Spring，并且参考文档确实非常出色。您可以轻松学习 Spring，甚至无需购买任何一本书。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-06T23:32:21.233

我先是自学了 Hibernate，然后才知道 Spring 如何使它变得更容易。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-25T14:22:44.050

同样在这里，我首先学习了hibernate，而不是Spring，我认为这是正确的顺序，从youtube上做一些小例子，看看你如何配置hibernate，创建一个会话并用你的数据库做一些技巧，至少是基本的东西。然后去看看如何用hibernate配置spring。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-04-18T18:02:09.797

如果你需要这两种技术，Spring Live 就是你所需要的。我已经开始从零开始学习这些技术了 :)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-06T22:54:55.800

首先我学习了休眠。使用 groovy 尝试不同的 Hibernate 示例。然后学习了 Spring 及其对 Hibernate 的支持。我想我有一个非常有趣的旅程。

这是一个 Struts+Spring+Hibernate 应用程序的示例。前端是 Struts，中间层是 Spring，持久层是 JPA/Hibernate。

[http://struts.apache.org/2.0.11/docs/struts-2-spring-2-jpa-ajax.html](http://struts.apache.org/2.0.11/docs/struts-2-spring-2-jpa-ajax.html)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-12T22:46:26.117

I would consider to learn them both at the same time. Spring and NHibernate are both large frameworks with a high learning curve. It will take you some studying and experimenting time to become familiar with and good at it. When you are busy with both the frameworks, you will automatically focus on the most useful parts of them first. Learning the important parts first will make the learning curve steeper.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-14T16:33:34.297

我认为您应该简短地分享您的个人资料以获得更好的答案

但是... hibernate 和 spring 都很热门，您会在为企业应用程序发布的所有工作要求中找到它们 - 因此，就您的选择而言，您处于正确的轨道上。

恕我直言 - hibernate 比 Spring 更棘手 原因是 - Spring 凭借其架构对代码的侵入性最小 几乎没有 API 需要掌握。因此，要在 Spring 中编写代码——您不必真正编写除 Java 之外的任何代码。但是要编写 hibernate 代码——您需要了解 Hibernate API 和 hibernate 编程的陷阱。hibernate 的基础知识很容易掌握——但学习技巧和琐事——需要时间

如果我是招聘经理并且正在使用 hibnernate 和 Spring，我宁愿选择在 Hibernate 上更强大的人，而不是在 Spring 上更强大的人 就 spring 而言——作为一名贡献的程序员——你几乎不用担心 大多数很可能该应用程序已经有一个适当的框架 - 你将不得不插入你的贡献。

但是在休眠中编码——就像我之前说的——如果你有这方面的经验会更好

PS：我知道每个人对此都有不同的看法 - 所以你可能会变得更加困惑。我认为 - 一旦你分享了一些你的个人资料 - 它会帮助人们给你一个更好的建议。祝你好运 ！！！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-10-10T11:21:06.127

我认为你学习了 Spring，RDBMS 的基础知识，然后去学习 Hibernate，这对你来说很容易学习..

# algorithm - 如何保证插入节点后 DAG 保持非循环状态？

> ID：722126
> 
> 赞同：15
> 
> 时间：2009-04-06T16:04:01.717
> 
> 标签：algorithm, graph-theory

我有一个 DAG，用于存储我的应用程序中某些对象之间的关系。*当通过在现有*顶点下方添加新顶点来更新此结构时（即，在新顶点中隐式创建新边），然后（在以后的任何时间）从那里到其他顶点的新边，我想确保图保持 DAG，即我的代码不会创建循环。

我是否必须为每个插入和连接操作添加[循环检测](http://en.wikipedia.org/wiki/Cycle_detection)，或者是否有可以在插入时遵循的规则来保证我不会产生循环？

我能想到的一种方法是存储每个节点的[拓扑级别](http://en.wikipedia.org/wiki/Directed_acyclic_graph#Partial_orders_and_topological_ordering)，并且只允许指向更高级别（离源节点更远）的新边。但是，这似乎实际上会剥夺我通过使用 DAG 而不是一组普通树来实现的许多灵活性。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-06T16:16:09.393

您还可以存储反向链接，并检查所添加边的终点节点是否未出现在源节点的任何父节点中。这将比进行全周期检测更快。本质上，这将是反向链路上的最短路径算法，对于 DAG 应该是线性操作。

但是，正如@Markus 所说，如果您没有创建新节点到现有节点的链接**，****那么**您不应该通过向图中引入新节点来创建循环。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-06T16:26:54.343

> 当通过添加新顶点和从那里到其他顶点的新边来更新此结构时

如果所有新边都*来自*新顶点，您将永远不会创建循环。

如果您还打算*从旧节点**向*新顶点添加边，您的选项取决于图形的预期形状。它们都归结为偏序的变化，但是有一些技巧可以为树木、森林、菱形网格等提供更好的性能。您对预期的整体图形形状了解多少？

 ** * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-06T16:11:25.940

您可以做的是保持节点按拓扑排序（搜索“拓扑排序”）。当您添加从低阶节点到高阶节点的弧时，您知道没有创建循环。在相反的情况下，您需要增量更新拓扑排序并同时运行循环检测。

# ruby-on-rails - Time Zone Weirdness in Rails

> ID：722144
> 
> 赞同：2
> 
> 时间：2009-04-06T16:09:05.197
> 
> 标签：ruby-on-rails, timezone

This is a really weird Rails problem - I have googled to see if this is related to a known bug, but haven't found anything - would be gratfeul for useful links as well as solutions.

I can boil the problem down to this:

If I start up my Rails App, and execute the following Rails code via an HTTP request.

```
Time.zone = 'Europe/London'
logger.info Time.zone.inspect 
```

The log show this as the timezone

```
#<ActiveSupport::TimeZone:0x3d7438c @tzinfo=nil, @name="UTC", @utc_offset=0> 
```

On the very next request (and most subsequent requests), the log for the same lines of code shows this

```
#<ActiveSupport::TimeZone:0x46cc100 @tzinfo=#<TZInfo::DataTimezone: Europe/London>, @name="Europe/London", @utc_offset=nil> 
```

Anyone know what the hell is going on?

(I'm running Rails 2.3.2 if it helps)

Edit: It appears that Rails 2.2.2 doesn't have this problem, so I will revert to that for now.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T16:18:08.313

[ActiveSupport::TimeZone](http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html#M001494)正在拦截 Time.zone 以便它可以被腌制和恢复。出于某种原因，这是懒惰地完成的（这就是为什么您的更改不会立即显示的原因）。这里有跨会话和多线程的问题，不知道对不对。我只能说：

*   你所看到的真的正在发生
*   它正在发生，因为它是这样编码的
*   有关于解决此问题的开放 TODO 项目
*   目前尚不清楚（至少对我而言）全球“正确”的行为应该是什么。

这种特性的基本问题是没有明确的方法可以从 setter 内部辨别应用程序程序员的意图范围。这是一个站点范围的设置吗？会话范围的设置？过时的幻想？

在约定优于配置的范式中，这样的事情需要约定来解决它们，而这个领域还没有。

# java - BlackBerry Data Usage

> ID：722146
> 
> 赞同：2
> 
> 时间：2009-04-06T16:10:25.897
> 
> 标签：java, blackberry, java-me, networking, network-monitoring

Using the RIM APIs. is there an accurate way of collecting the amount of data coming in and out of a service provider (Not including WiFi/Bluetooth data).

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T13:59:00.313

不幸的是，我尝试了 RadioInfo.getNumberOfPacketsReceived() 和 RadioInfo.getNumberOfPacketsSent() 并且它们还包括 Wi-Fi 使用，至少在通过 BlackBerry Infrastructure 路由时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T15:20:50.057

您是否尝试过使用`RadioInfo.getNumberOfPacketsSent()`并`RadioInfo.getNumberOfPacketsReceived()`监控数据使用情况？

# php - sprintf结果问题

> ID：722150
> 
> 赞同：1
> 
> 时间：2009-04-06T16:12:07.890
> 
> 标签：php, formatting, printf

这是我的代码：

```
<?php
$variable1 = 00001;
$variable2 = (sprintf('%04d', $variable1 + 1));
echo $variable2;
?> 
```

为什么这段代码的结果是“0002”而不是“00002”？换句话说，它缺少一个 0。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-06T16:13:58.167

%04d 中的 4 设置打印值的总宽度

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-06T16:14:57.353

第一个参数中的数字是“字符总数”而不是填充中使用的零数。您正在寻找的是 %05d 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T16:33:21.350

一个更有趣的问题是为什么下面打印的是 '0009' 而不是 '0011'？

```
<?php
$var = 0010;
$str = sprintf('%04d', $var+1);
echo $str;
?> 
```

那么你为什么要使用八进制表示呢？我只是好奇。

# eclipse-3.4 - 在 Eclipse 3.4 中使用 Spring IDE

> ID：722165
> 
> 赞同：1
> 
> 时间：2009-04-06T16:16:54.133
> 
> 标签：eclipse-3.4, spring-webflow-2

我正在使用带有 Eclipse 3.4 的 Spring IDE 插件（最终决定升级），并且我有几个项目使用 Spring IDE 插件附带的 Webflow 集成。出于某种原因，我在 Eclipse 3.4 中看不到任何与 Spring Webflow 相关的内容。它在 3.3 中工作得很好，但不是 3.4。以前有人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T21:33:35.577

您是否尝试在这些项目中删除/添加 Spring 特性？有时它在升级时会有所帮助。顺便说一句，我的3.4没有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T15:07:04.167

我建议下载 SpringSource 自己的 Eclipse 发行版。它预先捆绑了 Spring IDE 和其他一些与 Spring 相关的功能。

一直觉得Spring IDE安装升级有问题；无论是Eclipse的错还是插件本身我不能说。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-22T14:10:06.110

我最后只是重新安装了 Eclipse 及其所有插件，它就可以工作了。我不知道问题出在哪里，但我猜这可能与我没有安装一个或多个 Spring IDE 依赖项的正确版本有关。

# c# - 通过 DocumentText 与 Url 在 Forms.WebBrowser 控件中设置内容的差异

> ID：722166
> 
> 赞同：0
> 
> 时间：2009-04-06T16:17:04.600
> 
> 标签：c#, winforms, webbrowser-control

如果我生成一些 HTML 并将其放在一个字符串中，然后说：

```
myWebBrowser.DocumentText = string; 
```

它似乎工作得很好，除了没有图像加载（我得到损坏的图像图形）。

但是，如果我将字符串写入文件，然后说：

```
myWebBrowser.Url = new Uri("file://myfile.html"); 
```

一切正常。

我的问题是，这里的幕后发生了什么不同的事情？我在这两种情况下都验证了图像的路径（通过 RClick->查看源）是相同的，并且所有图像确实存在。

在这两种情况下，HTML 完全相同。

任何可以对此有所了解的信息都将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-06T16:27:33.157

文档文本中的 url 很可能与您所在的页面相关。话虽如此，当您保存到文件时，网址是绝对的。您可能希望在标记中添加 `<base href="Your.html" />`标签，以使图像在 Web 浏览器中可见。

WebBrowser 控件将这些相对图像解析为它们的位置并相应地显示它们。

# asp.net - ASP.NET：单个应用程序中的多个 Session 对象

> ID：722171
> 
> 赞同：2
> 
> 时间：2009-04-06T16:20:11.303
> 
> 标签：asp.net, session

我有一个在 Web 服务器根目录运行的 ASP.NET Web 应用程序，它通过使用 URL 重定向提供多个（相似的）网站。举一个真实世界的例子：

```
http://webshopserver/company1/ProductList.aspx -> http://webshopserver/ProductList.aspx?showProductsFrom=company1
http://webshopserver/company2/ProductList.aspx -> http://webshopserver/ProductList.aspx?showProductsFrom=company2
... 
```

这很好用；唯一的问题是，显然，所有这些不同的商店共享相同的会话对象（因为 InProc 会话管理器将会话对象存储在 AppDomain 中）。我希望 company1 和 company2 的商店具有不同的会话对象，例如，如果用户在同一浏览器窗口的不同选项卡中打开 company1 和 company2 的商店，则放入 company1 购物车的商品会赢没有出现在 company2 的购物车中。

有一些我不喜欢的明显方法可以解决这个问题：

*   *创建我自己的 Session 对象，它将所有内容封装到 HashMap<CompanyName, whatever> 中，然后将其存储在“真实”会话中*：这会破坏所有使用会话对象的现有代码。
*   *使用诸如[http://company1.webshopserver/ 之](http://company1.webshopserver/)类的 URL 和通配符 DNS 记录，因为会话 ID cookie 与域相关联*：这很难看（因为现实世界中相当于“webshopserver”的时间已经足够长了）。
*   *编写我自己的自定义会话提供程序*：这有点像重新发明轮子。
*   *为每个公司创建一个单独的 IIS 应用程序*：不会起作用，因为应该可以通过[http://webshopserver/CreateYourOwnWebshop.aspx 之](http://webshopserver/CreateYourOwnWebshop.aspx)类的东西创建新公司，而无需任何人工（服务器管理员）干预。

我正在考虑更多的解决方案：

*   将会话cookie 的路径限制为[http://webshopserver/<companyName>/](http://webshopserver/<companyName>/)或
*   告诉 ASP.NET 根据 URL 使用不同的 AppDomain。

因此，任何有关如何实现其中一个点（或者可能是完全不同的解决方案）的信息都会有所帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-06T16:47:02.423

最简单的解决方案不是使用基于 Company 的动态键更新对依赖于公司的 Session 对象的引用吗？

例如...

```
Session["IsTest"] 
```

变成

```
Session[createSessionKey(CompanyID, "IsTest")] 
```

其中 createSessionKey 可能通过 Company 和 Key 的简单连接生成相应的密钥

然后，这将通过生成的密钥访问会话来区分两家或更多公司。

按照上面的示例，company1 将通过键“company1_IsTest”访问“IsTest”会话变量，company2 将通过键“company2_IsTest”访问“same”“IsTest”会话变量。

希望您没有像 Session("IsTest") 之类的东西在您的代码库中乱扔垃圾，因为这会使重构您的代码变得非常痛苦。

通常我将我的 Session 变量抽象为一个强类型的类。然后我的会话管理包含在一个地方。

如果所有 Session 变量都是公司特定的，那么使用具有基 Page 类并覆盖 Session 属性的想法是一个不错的方法。尽管如果您可以确定特定的 Session 密钥是通用 Session 变量还是公司特定的，那么它仍然可以使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T17:15:11.857

我建议编写自己的会话包装器。[这是Martin](https://stackoverflow.com/users/19635/martin)在另一个问题中的一个很好的例子：

[如何从 ASP.NET 中的任何类访问会话变量？](https://stackoverflow.com/questions/621549/how-to-access-session-variables-from-any-class-in-asp-net/621620#621620)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T16:34:55.837

根据您在 Session 中添加和检索项目的方式（并且可能取决于您是否从公共基础页面派生页面），您可能能够执行一个自定义对象来包装会话而不会破坏所有您的代码（如您的第一个选项中所述，您将会话包装器实现为由站点键入的哈希映射）。如果您创建一个自定义对象并将其公开为基本页面级别的“会话”，它将优先于您从 Page 类继承的会话对象。然后，您的自定义对象可以覆盖索引器并根据当前 http 上下文的请求 url 确定在 hashmap 中存储该对象的位置。

如果您不是从一个通用的基本页面派生，那么这有点出乎意料，因为您必须为所有页面实现一个基本页面来派生，或者向每个页面添加代码以获取对您的对象的引用。只是和想法...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T16:51:58.793

创建自己的 Session 包装器或自定义 Session Provider 将是*正确*的答案。但是，您可以通过移动现有会话数据来破解它，因为用户去另一家公司，HttpModule 与 PostAcquireRequestState 挂钩。

基本上，将此 ProductsFromCompany 与之前的 ProductsFromCompany 进行比较。如果它们不同，请将所有现有的 Session 值移动到一个`Dictionary<string, object>`（或在它们前面加上公司 ID）并将`Dictionary<string, object>`为此 ProductsFromCompany 保存的值恢复到 Session。

就像是：

```
void PostAcquireRequestState(object sender, EventArgs e) {
   if (Session["ProductsFromCompany"] != Request["ProductsFromCompany"]) {
      var lastCompanySession = new Dictionary<string, object>(Session.Count);
      var sessionKeys = Session.Keys;
      foreach (string key in sessionKeys) {
         if (key == "CompanyState" || key == "ProductsFromCompany") {
            continue;
         }
         lastCompanySession[key] = Session[key];
         Session.Remove(key);
      }
      Session["CompanyState"].Add(Session["ProductsFromCompany"], lastCompanySession);

      var thisCompanySession = Session["CompanyState"][Request["ProductsFromCompany"]];
      foreach (string key in thisCompanySession.Keys) {
         Session[key] = thisCompanySession[key];
      }
      Session["CompanyState"].Remove(Request["ProductsFromCompany"]);

      Session["ProductsFromCompany"] = Request["ProductsFromCompany"];
   }
} 
```

# php - 如何让 PHP 脚本以 root 身份运行 shell 脚本？

> ID：722172
> 
> 赞同：2
> 
> 时间：2009-04-06T16:21:40.987
> 
> 标签：php, scripting, permissions, shell, sudo

运行 Fedora 9/10、Apache 2、PHP 5...

我可以使用 exec() 从 PHP 脚本以 root 身份运行 shell 脚本吗？

我是否只是给 Apache root 权限，然后在它们前面添加“sudo”命令？

具体来说，我正在尝试启动和停止后台脚本。

目前我有一个 shell 脚本，它只运行应用程序 start.sh：

```
#!/bin/bash 
/path/to/my/app/appname 
```

还有一个杀死应用程序的脚本，stop.sh：

```
#!/bin/bash 
killall appname 
```

我会这样做：

```
<?php
exec("sudo start.sh");
?> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-06T16:38:08.950

你不能只是 sudo 那样，你需要先在 /etc/sudoers 文件中设置无密码 sudo。例如，这可以使用 visudo 命令来完成。确保您在 sudoers 文件中设置权限以将 apache 用户限制为您希望运行的单个命令（即您的 shell 脚本）。

即使这样，它也会带来安全风险，因为任何人都可以创建 PHP 脚本并依次运行您的 shell 脚本。因此，请确保 shell 脚本本身不会被 Apache 用户更改。

第二部分*killall*问题更大。您不应该只允许 Apache 以 root 权限运行 killall。您应该将 killall 包装在另一个 shell 脚本中，并在 sudoers 中授予对它的访问权限。

最后：不要用root帐户运行Apache，不要使用setuid。两者都会打开一罐蠕虫，并且由于您是新手（鉴于您提出的问题），您很可能会错过一些会造成潜在问题的小细节。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-06T16:39:21.303

1.  不要将 Apache 作为`root`. Apache 的设计初衷就是很好地应对从 as 开始`root`，然后尽快放弃它的权限

2.  也不要`sudo`在您的脚本中使用 - 很容易导致`sudo`配置错误，以至于在您的服务器上运行的任何脚本都可以使用`root`特权运行它喜欢的任何程序

3.  看看让你自己的程序运行“setuid”，这样它就获得了 root 权限，但是当它不再需要它们时就放弃它们（就像 Apache 一样）

4.  确保您的“setuid”可执行文件不能由不应该运行它的任何人运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-06T16:29:39.797

我不是这个领域的专业人士，但看起来你需要 SUID 标志。

在此处阅读[示例](http://www.howtoforge.com/linux_setting_suid_sgid_bits)或谷歌

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-06T17:38:50.847

您至少需要一个抽象层来提供一点安全性！...

我这样做的方法是在 Python 中使用 root privs 编写一个简单的 UDP 服务器*，它： 监视给定端口上的传入 UDP 数据包 如果它们匹配，则将它们与白名单进行比较 执行操作

然后你有一点 PHP 用预定义的消息向 Python 服务器发送消息......

```
<?php
  $handle = fsockopen("udp://localhost",12345);
  fwrite($handle,"Start Script");
  fclose($handle);
?> 
```

python 服务器监视端口 12345 上的数据包，但忽略任何不是“启动脚本”或“停止脚本”的数据包，因为它以 root 身份运行，它可以愉快地启动您的 bash 脚本。但是，您绝对必须使用白名单，将任何输入从 UDP 套接字直接发送到命令行是非常不安全的！

请注意，UDP 可以被欺骗，因此如果您的防火墙允许欺骗的入站流量（它真的不应该！）有人可能会向您的 Python 服务器发送伪造的数据包并停止/启动您的服务。这不太可能成为问题，但是如果您无法修复防火墙并且想要防范它，您可以使用无法被欺骗的 TCP/IP 来修改上述内容。

罗杰·希思科特。

*这是一个非常简单的服务器（约 20 行），但如果您不知道如何发送，请给我发消息，我会将其发送给您或在此处发布。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-30T03:25:14.353

你不想给 Apache root。

您的问题还有另一种解决方案。问题是 Apache 无法终止该进程，因为它由 root 拥有。您可以做的是将所有者更改为“www-data”，这是 Apache 的标识。

如果该进程是一项服务并在启动时启动，您可以添加

```
sudo -u www-data <start-up script> 
```

这样 www-data 将成为该进程的所有者，因此运行关闭脚本将起作用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-07T06:59:59.487

根据要求，这是python服务器......

```
#!/usr/bin/python
import os 
import socket
print "  Loading Bindings..."
settings = {}
line = 0 
for each in open('/path/to/actions.txt', 'r'):
 line = line + 1
  each = each.rstrip()
  if each <> "":
    if each[0] <> '#':
      a = each.partition(':')
      if a[2]:
        settings[a[0]] = a[2]
      else:
        print "    Err @ line",line,":",each
print "  Starting Server...",
port = 12345
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.bind(("", port))
print "OK."
print "  Listening on port:", port
while True:
    datagram = s.recv(1024)
    if not datagram:
        break
    print "Rx Cmd:", datagram
    if settings.has_key(datagram):
      print "Launch:", settings[datagram]
      os.system(settings[datagram]+" &")
s.close() 
```

配置文件“actions.txt”使用格式“action-name:corresponding-shell-command”，即

```
# Hash denotes a comment
webroot:nautilus /var/www
ftp:filezilla
edit_homepage:gedit /var/www/homepage/htdocs/index.php 
```

此代码不会检查传入 UDP 数据包的原始 IP，因为我在 localhost 上运行它，我受到其他任何人的防火墙保护，并且无论如何检查都不会提供针对欺骗的保护。

我没有时间重写它以使用 TCP/IP，但 Python 是一种值得了解的语言，所以如果你真的想要那个功能，我会留给你一个 google 来搜索“Python”和“SOCK_STREAM” . 不过，这可能不值得您费心，配置防火墙更容易，这样就不会受到欺骗的本地主机数据包可以通过并修改代码以确保它只侦听来自环回的数据包。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-08-22T10:57:12.013

您可以考虑使用与具有 root 权限的帐户的 keepair 身份验证的 ssh 连接到 localhost。在这样的设置中，您的网络服务器不需要 root 访问权限。

# ruby-on-rails - ActiveRecord 条件错误

> ID：722187
> 
> 赞同：2
> 
> 时间：2009-04-06T16:27:39.537
> 
> 标签：ruby-on-rails, ruby, activerecord

我有这个：

```
SectionHistory.find(:all, :conditions => ["id=? and (name!=? or code!=?)", sec.id, sec.name, sec.code]) 
```

我收到错误*“字符“！”跟随“和（名称！=？或代码”无效“*

如果我的条件字符串只是*"id=? and (name!=?)"*没关系

我们正在使用 DB2。

对此有何建议？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T16:29:25.977

这是 SQL；尝试：

```
"id=? and not (name=? and code=?)" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T16:31:04.177

我不完全确定 rails 如何处理这些条件，但如果它们直接传递给数据库引擎，那么 != DB2 的有效语法。

你可以试试 <> 看看是否有效

# .net - 除了 .NET 中的 AutoMapper 之外，还有其他对象到对象的映射解决方案吗？

> ID：722189
> 
> 赞同：1
> 
> 时间：2009-04-06T16:27:59.317
> 
> 标签：.net, datamapper

我想知道 .NET 世界中是否有其他类似的开源解决方案，尤其是对于 2.0 框架

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T02:25:49.027

我刚刚偶然发现[ObjectCastor](http://www.codeproject.com/KB/dotnet/ObjectToInterfaceCaster.aspx?fid=1539820&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=3017849#xx3017849xx)的目标是：

> 基本上，它使用 System.CodeDom 机制生成一个新的代理类，它包装了 sourceType 并实现了 interfaceType 接口。在 .NET Reflection 的帮助下，它遍历 interfaceType 类型的成员，并在代理类中生成相应的成员。之后，它使用 CodeDomProvider 类并调用 CompileAssemblyFromDom 方法编译生成的类。至此，生成的类就编译好了，最后要做的就是创建代理类的新实例，并提供源对象作为构造函数。实用程序类和演示应用程序的完整源代码可在上面的下载部分中找到。

这种技术现在被用于[CS Script](http://www.csscript.net)中。从 CSScript 帮助文件：

> 在 2.3.3 版本中，CS-Script 引入了新的脚本托管模型接口对齐，这是在通过接口加载/访问脚本时接口继承的一个有吸引力的替代方案。
> 
> 该模型允许通过将脚本“对齐”到适当的界面（DuckTyping）来操作脚本。这种方法的重要方面是脚本执行是完全类型安全的（与通过接口访问的任何脚本一样），但更重要的是脚本不必实现主机应用程序使用的接口。在某种程度上，接口对齐是一种强制类型转换：只要对象具有接口中定义的所有方法，就可以将类型转换为接口。这种有前途的技术允许在主机和脚本业务逻辑之间进行高级别的解耦，而不会损害任何类型安全性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-25T10:27:45.850

我在这个[答案](https://stackoverflow.com/questions/286294/object-to-object-mapper/1081480#1081480)中发现了[奥](http://code.google.com/p/otis-lib/)的斯。它在类上使用字符串属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T20:06:16.677

哟可以使用 CSLA.NET。它提供了地图功能。

# ruby - 全屏鞋款应用？

> ID：722193
> 
> 赞同：3
> 
> 时间：2009-04-06T16:28:48.583
> 
> 标签：ruby, fullscreen, shoes

我查看了文档，但一无所获 - 有没有办法让[鞋子](http://shoooes.net/)应用程序全屏显示？

可能像..

```
Shoes.app :fullscreen => true do
  para "test"
end 
```

查看源代码，以下几行提到“全屏”（以及其他）：

```
shoes/app.c:58:  app->fullscreen = FALSE;
shoes/native/cocoa.m:851:  if (app->fullscreen) {
shoes/native/gtk.c:557:  if (app->fullscreen)
shoes/native/cocoa.m:872:shoes_native_app_fullscreen(shoes_app *app, char yn)
shoes/native/windows.c:934:  if (app->fullscreen)
shoes/native/windows.c:935:    style = WINDOW_STYLE_FULLSCREEN; 
```

..所以这一切似乎都在那里，只是做`:fullscreen => true`似乎没有效果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T13:01:47.690

哎呀，`app->fullscreen`问题中引用的代码来自最新的开发代码，而不是当前`2/Raisins`版本。

```
$ git co 2/Raisins 
HEAD is now at 42dda8a...  * bugs: closing some bugs, moving others to the next release.
$ grep -r -i fullscreen *
[nothing]
$ git co master 
Switched to branch "master"
$ grep -r -i fullscreen *
shoes/app.c:  app->fullscreen = FALSE;
[...] 
```

`:fullscreen`将在下一个版本中工作！

# c# - C# 多态再一次 - 虚拟属性

> ID：722197
> 
> 赞同：0
> 
> 时间：2009-04-06T16:29:32.043
> 
> 标签：c#, polymorphism

这次我遇到了虚拟字段的问题。

我的游戏对象有核心类。此类包含带有模型类对象的字段。模型的对象包含位置等值。

现在 - 在绘图时我需要从它的模型中读取每个对象的位置。当我使用派生而不是默认模型类时，问题就开始了。例子：

```
abstract class GenericGameObject { public DefaultGameObjectModel Model = new DefaultGameObjectModel(); }
class Plane : GenericGameObject { public void shoot(Missile m){ m.Model.Position.X = 10; } }
class Missile : GenericGameObject { public new MissileModel Model = new MissileModel(); }

class DefaultGameObjectModel { public Vector2 Position = new Vector2(){X=0}; }
class MissileModel : DefaultGameObjectModel { }

Plane p = new Plane();
Missile m = new Missile();
p.shoot(m);
// NOT OK! ((GenericGameObject)m).Model.Position.X == 0 
```

我试图将模型定义为虚拟属性而不是字段，但这失败了，因为派生属性必须与它们的基础类型相同。铸造是徒劳的，因为会有许多其他模型类型。如果我想从派生类而不是基类中读取值，我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T16:33:07.607

听起来您`GenericGameObject`需要成为泛型类型，其中类型参数派生自`DefaultGameObjectModel`：

```
abstract class GenericGameObject<TModel>
    where TModel : DefaultGameObjectModel
{
     private TModel model;

     // Or whatever
     public TModel Model
     {
         get { return model; }
         protected set { model = value; }
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T16:43:03.697

You could also create an IGameObjectModel interface and then implement it in each of your Object Model classes. Your GameObject would then have an instance of IGameObjectModel.

# programming-languages - 哪些编程语言（除了 Smalltalk）是基于图像的？

> ID：722204
> 
> 赞同：31
> 
> 时间：2009-04-06T16:30:57.190
> 
> 标签：programming-languages, smalltalk

如果有人知道使用像 Smalltalk 这样的图像的编程语言，我真的很感兴趣......

我认为这是计算机科学史上最伟大的想法之一。除了基于图像的 Smalltalk 之外，我找不到其他语言。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-06T16:36:38.253

**图片**

图像基本上是内存转储。通常，Lisp 开发系统会启动一个运行时加上一个图像。然后用户进行更改，然后可以编写新图像。有时这是开发人员使用的一个特性，有时它也在 Lisp 系统本身的开发过程中使用。

许多 Lisp 系统都在使用“图像”。Smalltalk 可能就是从那里得到它的——因为 Lisp 早在 Smalltalk 存在之前就有图像了。60 年代初的 McCarthy 的 Lisp 1.5 使用了图像。关于 Lisp 实现技术的知识被转移到 Xerox。[例如， L Peter Deutsch](http://www.codersatwork.com/l-peter-deutsch.html)在 60 年代从事 Lisp 实现方面的工作——在 60 年代初，他还是个孩子的时候写了他的第一个 Lisp。在 70 年代，他在 Xerox 工作，尤其是在 Smalltalk 的虚拟机实现方面。

在 70 年代/80 年代后期，Lisp 机器上的操作系统基本上是 Lisp 映像（通常称为*worlds*）（甚至是带有增量增量映像的分层映像）。Lisp Machines 还会在图像中存储开发环境状态（例如：从哪里加载哪个代码由谁编写的哪个版本），但是 Lisp Machine 的 MIT 变体通常将源代码本身存储在文件中。

**托管源代码**

如果您问哪种语言使用类似的方式来组织和管理源代码（即不在项目目录中的文件中），那么 Xerox Interlisp 就是这样做的。苹果的迪伦做到了。一些数据库开发工具可能会这样做。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-06T17:07:58.770

[Factor](http://factorcode.org/)是一个具有许多高级特征和图像的 Forth。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-06T22:57:31.613

您实际上可以将 SQL 数据库视为基于图像的 - 数据和代码（存储过程）都存储在一个大的不透明 blob 中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-06T16:34:30.223

从我记得 80 年代坐在我父亲身边的记忆开始，[MUMPS](http://en.wikipedia.org/wiki/MUMPS)是基于图像的。我肯定是错的，快速浏览一下维基百科文章没有显示任何内容，但有可能......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-06T16:36:29.110

我很好奇 Smalltalk Image 系统是否可以扩展。

如果你有 20 位程序员在同一个代码库上工作，那是如何工作的？他们每个人都有自己的形象，还是共享一个？

如果您进行了需要修改环境的代码修改，并且有人进行了具有相似要求的不同修改，是否可以合并图像（与版本控制一样）？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-06T16:36:31.293

Common Lisp 的大多数实现。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-06T17:10:29.450

是的，大多数 Forths 都是基于图像的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-06T22:54:05.833

我偶然看到了[这个评论](http://www.newartisans.com/2009/03/the-jvm-and-costs-vs-benefits.html)，我认为它给人一种基于图像的开发的味道。

'因此，虽然我可以并且确实使用 JVM 进行服务器端计算，但对于小型和简单的任务来说它有点重。Common Lisp 对这个问题的回答很巧妙。它不是构建您一遍又一遍地运行的程序，它提供了一个“环境”，在该环境中迭代地评估代码，以便您实际上在长期运行的 VM 中发展和培育一组新兴的功能。我喜欢这个模型*，*并且喜欢它，例如在 Emacs 中，我可以让它连续运行几天，同时通过编写新函数和自定义变量来扩展它的功能。”

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-06T19:48:58.663

回答 Bill K 的问题：显然它工作得很好（尽管我个人没有在团队中尝试过版本控制）。

不过，所有 Smalltalk 系统的做法都有些不同。[The Stack Trace](http://thestacktrace.libsyn.com/index.php?post_id=224053 "堆栈跟踪")上有一个非常有趣的播客。其中大部分适用于所有基于图像的开发环境。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-01-14T05:19:48.653

早期的 BASIC 解释器可以被认为是基于图像的，因为它们包含一个基本的编辑器，并在用户处理程序时将程序的源代码形式保留在内存中，并提供诸如“SAVE”和“LOAD”之类的命令（或者是“READ”？）将整个程序保存到源文件并稍后再次加载。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-01-27T12:12:15.780

单页应用程序可以被认为是 JavaScript+HTML 的一种图像。单页应用程序是指一个 [web] 应用程序，其中所有数据、代码和状态都包含在单个 HTML 文档中。

以 TiddleWiki 为例：[http ://www.tiddlywiki.com/](http://www.tiddlywiki.com/)

# tfs - 围绕 devdiv 在 TFS 上的工作项的流程模板

> ID：722207
> 
> 赞同：0
> 
> 时间：2009-04-06T16:31:07.297
> 
> 标签：tfs

任何熟悉 w/MS devDiv 团队在 TFS 周围使用的人。 [http://blogs.msdn.com/jeffbe/archive/2008/04/20/how-devdiv-uses-tfs.aspx](http://blogs.msdn.com/jeffbe/archive/2008/04/20/how-devdiv-uses-tfs.aspx)

我正在寻找他们在 valuepoposition/experiences/features 中围绕工作项模板使用的流程模板。

如果您知道我可以下载他们的工作项模板的任何位置，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T18:24:37.993

干得好：

[http://mpt.codeplex.com/](http://mpt.codeplex.com/)

这与内部使用的流程模板非常相似，但由 Team System MVP 之一 ( [Ed Blankenship](http://www.edsquared.com/) ) 打包和清理。

它目前需要使用 SQL Server Enterprise Edition，TFS 数据存储才能使所有报告正常工作。显然，这对 Microsoft 来说不是问题，因为 SQL 不会花费太多，但这不是 TFS 成本中包含的 SQL 版本，因此您在公司中使用它时可能会遇到问题。

如果没有，那就发疯吧。

祝你好运，

马丁。

# implementation - 根据问题设置身份验证用户的建议

> ID：722209
> 
> 赞同：0
> 
> 时间：2009-04-06T16:31:29.730
> 
> 标签：implementation

我正在设置一个小模块，如果用户在某个日期最后一次登录，那么他必须在通过身份验证之前回答 10 个选项问题。10个问题将是选项和多项选择。

想知道我是否可以在设置时获得一些建议。我想将每个问题的 10 个问题和答案存储到数据库中，因此如果更改了问题或答案，则不需要更改代码。

我正在考虑有两个表问题，答案（一列将有问题的正确答案），它们将由 pkey 连接（这是最好的表结构吗？）

我的代码（Java）将获取每个问题和答案并将它们存储到每个问题的哈希中（这是最好的数据结构吗？）

然后视图层将有一个循环遍历问题的外部循环和一个循环遍历每个问题的答案的内部循环。我应该将真实答案存储为隐藏的 html 变量吗？或者当用户单击提交时再次转到数据库以便我可以匹配答案？

任何建议都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T16:36:58.657

> 我应该将真实答案存储为隐藏的 html 变量吗？

别傻了。如果你这样做，你只是让任何人都很容易破解。

至于更广泛的问题，如果您需要有用的建议，则需要大量澄清。选择是（由您）预先确定还是由用户给出？它们对所有用户都一样吗？你为什么选择这样做而不是（说）只是一个密码？您是否还需要在某处存储对哪些用户正确的答案？当问题改变时会发生什么？等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T16:38:41.803

> 我的代码将获取每个问题和答案并将它们存储到每个问题的哈希中（这是最好的数据结构吗？）

是的，散列是一个很好的方法。简单的散列并不是那么强大，所以你应该阅读这个，你可能应该添加一个[salt](http://en.wikipedia.org/wiki/Salt_(cryptography))。

> 我应该将真实答案存储为隐藏的 html 变量吗？或者当用户单击提交时再次转到数据库以便我可以匹配答案？

不会。如果您查看源代码，隐藏的 HTML 仍然可见，因此您将给出答案。唯一的方法是在服务器端进行所有检查。

# asp.net - 以编程方式设置 asp:Content

> ID：722213
> 
> 赞同：2
> 
> 时间：2009-04-06T16:32:18.620
> 
> 标签：asp.net

我正在使用一个 asp.net Web 应用程序项目，我无法以编程方式访问任何 asp:content 控件。我正在尝试在后面的代码中更新其 contentplaceholderID。这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T16:56:53.680

虽然您可能无法更改您的 asp:Contents 的 ContentPlaceHolderId，但您可以直接控制 ContentPlaceHolders 的内容：通过其 Master 属性从页面访问母版页，然后使用 FindControl 函数在母版页上找到 ContentPlaceHolder。之后，通过 Controls 属性编辑其内容。

```
var masterContent = Master.FindControl("largeContent") as ContentPlaceHolder;
masterContent.Controls.Add(new Literal { Text = "Hello, world!" }); 
```

您可能可以使用此“hack”将 asp:Panel 控件添加到您想要的任何 ContentPlaceHolder，这样就可以模拟您想要的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T16:40:37.277

**不**，您不能更改内容页面中的 contentPlaceHolderId。原因是在母版页中设置了 contentplaceholder，然后您在其中引用它们来说明您的内容将放在哪个 contentplaceholder 中。

> 内容控件被遗忘并且不存在于控件层次结构中。这个[ASP.net 线程](http://forums.asp.net/p/1140496/1833451.aspx)在这里提供了一种方法，您可以通过另一种方式对其进行更新

# sql-server-2008-express - SQL Server 2008 Management Studio Express 是否与 Standard 相同？

> ID：722217
> 
> 赞同：0
> 
> 时间：2009-04-06T16:33:15.310
> 
> 标签：sql-server-2008-express, sql-server-2008

不久前，我安装了带有高级服务的 SQL Server 2008 Express，它也安装了 SQL Server 2008 Management Studio (SSMS) Express。现在几个月后我们在网络上安装了 SQL 2008 Standard，我想确认我不必在我的桌面上重新安装 SSMS 2008。我发现的这篇博文似乎表明我对 SQL Express 附带的 SSMS 版本很好：

[http://weblogs.asp.net/markwisecarver/archive/2008/09/02/sql-server-2008-management-tools-basic-vs-complete.aspx](http://weblogs.asp.net/markwisecarver/archive/2008/09/02/sql-server-2008-management-tools-basic-vs-complete.aspx)

...但我想确认。不幸的是，关于对话框没有提供有关 Express 与“完整”版本的工具的详细信息。有人知道吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T16:42:43.807

不，它们是不同的。SSMS 的 Express 版本可以与任何更高版本的 SQL Server 一起正常工作，但它缺少高端版本的一些更高级的功能（如复制设计器等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T16:44:27.813

它们是不同的。SSMS Express 似乎是几个标准 SQL 2008 应用程序的混合体，每个应用程序都在一定程度上配对并打包在一起。[在这里](http://coolthingoftheday.blogspot.com/2009/02/sql-server-2008-management-studio.html)阅读更多。[您可以在此处](http://msdn.microsoft.com/en-us/library/ms365247.aspx)获取有关 SSMSE 的更多详细信息。如果我是你，我会从标准添加中安装全套工具。

# postgresql - 如何记录 PostgreSQL 查询？

> ID：722221
> 
> 赞同：423
> 
> 时间：2009-04-06T16:34:32.157
> 
> 标签：postgresql, logging

如何启用 PostgreSQL 8.3 执行的所有 SQL 的日志记录？

*编辑（更多信息）* 我改变了这些行：

```
log_directory = 'pg_log'                    
log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'
log_statement = 'all' 
```

并重新启动 PostgreSQL 服务...但没有创建日志...我使用的是 Windows Server 2003。

有任何想法吗？

* * *

## 回答 #1

> 赞同：511
> 
> 时间：2009-04-06T16:37:48.700

在您的`data/postgresql.conf`文件中，将`log_statement`设置更改为`'all'`.

* * *

**编辑**

查看您的新信息，我想说可能还有其他一些设置需要验证：

*   确保您已打开`log_destination`变量
*   确保打开`logging_collector`
*   还要确保该`log_directory`目录已经存在于`data`目录中，并且 postgres 用户可以写入它。

* * *

## 回答 #2

> 赞同：129
> 
> 时间：2016-01-07T20:15:05.200

编辑您的`/etc/postgresql/9.3/main/postgresql.conf`, 并按如下方式更改行。

**注意**：如果您没有找到该`postgresql.conf`文件，则只需`$locate postgresql.conf`在终端中输入

1.  `#log_directory = 'pg_log'` **到** `log_directory = 'pg_log'`

2.  `#log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'` **到** `log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'`

3.  `#log_statement = 'none'` **到** `log_statement = 'all'`

4.  `#logging_collector = off` **到** `logging_collector = on`

5.  **可选**：`SELECT set_config('log_statement', 'all', true);`

6.  `sudo /etc/init.d/postgresql restart` **或者** `sudo service postgresql restart`

7.  postgresql 中的触发查询`select 2+2`

8.  查找当前登录`/var/lib/pgsql/9.2/data/pg_log/`

随着时间的推移，日志文件往往会增长很多，并且可能会杀死您的机器。为了您的安全，请编写一个 bash 脚本来删除日志并重新启动 postgresql 服务器。

谢谢@paul，@Jarret Hardie，@Zoltán，@Rix Beck，@Latif Premani

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2017-08-08T08:45:54.133

仅供参考：其他解决方案只会记录默认数据库中的语句——通常`postgres`——以记录其他人；从他们的解决方案开始；然后：

```
ALTER DATABASE your_database_name
SET log_statement = 'all'; 
```

参考：[https](https://serverfault.com/a/376888) : //serverfault.com/a/376888/[`log_statement`](https://www.postgresql.org/docs/current/static/runtime-config-logging.html#GUC-LOG-STATEMENT)

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2013-05-16T14:18:59.443

```
SELECT set_config('log_statement', 'all', true); 
```

有相应的用户权限可以在连接后使用上面的查询。这将影响日志记录，直到会话结束。

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2014-07-11T19:37:04.823

您还需要在 PostgreSQL 中添加这些行并重新启动服务器：

```
log_directory = 'pg_log'                    
log_filename = 'postgresql-dateformat.log'
log_statement = 'all'
logging_collector = on 
```

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2009-04-06T16:37:33.773

设置`log_statement`为`all`：

[错误报告和日志记录 - log_statement](http://www.postgresql.org/docs/8.3/static/runtime-config-logging.html#GUC-LOG-STATEMENT)

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2010-04-08T09:53:12.880

+1 以上答案。我使用以下配置

```
log_line_prefix = '%t %c %u ' # time sessionid user
log_statement = 'all' 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2013-09-17T08:40:26.320

[根据此网页](http://www.microhowto.info/howto/log_all_queries_to_a_postgresql_server.html)上的说明，了解运行 PostgreSQL 9.2 的 CentOS 6.4（Red Hat 4.4.7-3）的更多详细信息：

1.  设置（取消注释）`log_statement = 'all'`并`log_min_error_statement = error`在`/var/lib/pgsql/9.2/data/postgresql.conf`.
2.  重新加载 PostgreSQL 配置。对我来说，这是通过运行`/usr/pgsql-9.2/bin/pg_ctl reload -D /var/lib/pgsql/9.2/data/`.
3.  找到今天的登录`/var/lib/pgsql/9.2/data/pg_log/`

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-10-08T11:05:24.387

postgresql 中有一个扩展名。它的名字是“pg_stat_statements”。[https://www.postgresql.org/docs/9.4/pgstatstatements.html](https://www.postgresql.org/docs/9.4/pgstatstatements.html)

基本上你必须稍微改变一下 postgresql.conf 文件：

```
shared_preload_libraries= 'pg_stat_statements'
pg_stat_statements.track = 'all' 
```

然后您必须登录数据库并运行以下命令：

```
create extension pg_stat_statements; 
```

它将创建名为“pg_stat_statements”的新视图。在此视图中，您可以看到所有已执行的查询。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-09-29T18:36:09.773

您还应该设置此参数以记录每条语句：

```
log_min_duration_statement = 0 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-02-27T10:45:51.147

我试图`log_statement`在一些 postgres 配置文件中设置，但实际上我们的 postgres 没有读取该文件。

我确认使用请求：

```
select *
from pg_settings

[...]
log_statement   none # That was not the value i was expected for !!! 
```

我用这种方式[https://stackoverflow.com/a/41912295/2294168](https://stackoverflow.com/a/41912295/2294168)

```
command: postgres -c config_file=/etc/postgresql.conf 
```

# .net - 立即检测客户端与服务器套接字的断开连接

> ID：722240
> 
> 赞同：87
> 
> 时间：2009-04-06T16:38:39.853
> 
> 标签：.net, c#, sockets, tcp, connection

如何检测客户端已与我的服务器断开连接？

我的`AcceptCallBack`方法中有以下代码

```
static Socket handler = null;
public static void AcceptCallback(IAsyncResult ar)
{
  //Accept incoming connection
  Socket listener = (Socket)ar.AsyncState;
  handler = listener.EndAccept(ar);
} 
```

我需要找到一种方法来尽快发现客户端已与`handler`Socket 断开连接。

我试过了：

1.  `handler.Available;`
2.  `handler.Send(new byte[1], 0, SocketFlags.None);`
3.  `handler.Receive(new byte[1], 0, SocketFlags.None);`

当您连接到服务器并想要检测服务器何时断开连接时，上述方法有效，但当您是服务器并想要检测客户端断开连接时它们不起作用*。*

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-04-06T16:46:22.707

由于在套接字断开连接时没有可用于发出信号的事件，因此您必须以您可以接受的频率对其进行轮询。

使用此扩展方法，您可以有一个可靠的方法来检测套接字是否断开。

```
static class SocketExtensions
{
  public static bool IsConnected(this Socket socket)
  {
    try
    {
      return !(socket.Poll(1, SelectMode.SelectRead) && socket.Available == 0);
    }
    catch (SocketException) { return false; }
  }
} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2015-08-27T08:42:46.530

有人提到 TCP Socket 的 keepAlive 能力。这里很好地描述了：

[http://tldp.org/HOWTO/TCP-Keepalive-HOWTO/overview.html](http://tldp.org/HOWTO/TCP-Keepalive-HOWTO/overview.html)

我以这种方式使用它：连接套接字后，我正在调用此函数，它将 keepAlive 设置为打开。该`keepAliveTime`参数指定超时，以毫秒为单位，在发送第一个保持活动数据包之前没有活动。该`keepAliveInterval`参数指定在没有收到确认的情况下发送连续保持活动数据包之间的时间间隔，以毫秒为单位。

```
 void SetKeepAlive(bool on, uint keepAliveTime, uint keepAliveInterval)
    {
        int size = Marshal.SizeOf(new uint());

        var inOptionValues = new byte[size * 3];

        BitConverter.GetBytes((uint)(on ? 1 : 0)).CopyTo(inOptionValues, 0);
        BitConverter.GetBytes((uint)keepAliveTime).CopyTo(inOptionValues, size);
        BitConverter.GetBytes((uint)keepAliveInterval).CopyTo(inOptionValues, size * 2);

        socket.IOControl(IOControlCode.KeepAliveValues, inOptionValues, null);
    } 
```

我也在使用异步阅读：

```
socket.BeginReceive(packet.dataBuffer, 0, 128,
                    SocketFlags.None, new AsyncCallback(OnDataReceived), packet); 
```

在回调中，这里被捕获 timeout `SocketException`，当套接字在保持活动数据包后没有收到 ACK 信号时引发。

```
public void OnDataReceived(IAsyncResult asyn)
{
    try
    {
        SocketPacket theSockId = (SocketPacket)asyn.AsyncState;

        int iRx = socket.EndReceive(asyn);
    }
    catch (SocketException ex)
    {
        SocketExceptionCaught(ex);
    }
} 
```

这样，我就能够安全地检测到 TCP 客户端和服务器之间的断开连接。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-06T16:45:53.597

这根本不可能。您和服务器之间没有物理连接（除了极少数情况下，您使用环回电缆在两台计算机之间进行连接）。

当连接正常关闭时，会通知对方。但是如果连接以其他方式断开连接（例如用户连接被丢弃），那么服务器将不知道直到它超时（或尝试写入连接并且 ack 超时）。这就是 TCP 的工作方式，你必须接受它。

因此，“立即”是不现实的。您可以做的最好的事情是在超时期限内，这取决于代码运行的平台。

编辑：如果您只是在寻找优雅的连接，那么为什么不从您的客户端向服务器发送“DISCONNECT”命令呢？

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-11-07T10:57:24.900

“这就是 TCP 的工作方式，你必须接受它。”

是的，你是对的。这是我已经意识到的生活事实。即使在使用此协议（甚至其他协议）的专业应用程序中，您也会看到相同的行为。我什至看到它出现在网络游戏中；你是好友说“再见”，他似乎又在线了 1-2 分钟，直到服务器“清理房子”。

您可以在此处使用建议的方法，也可以按照建议实施“心跳”。我选择前者。但如果我确实选择了后者，我只需让服务器每隔一段时间用一个字节“ping”每个客户端，看看我们是否有超时或没有响应。您甚至可以使用后台线程以精确的时间来实现这一点。如果您真的担心的话，甚至可以在某种选项列表（枚举标志或其他东西）中实现组合。但是，只要您更新服务器，在更新服务器时有一点延迟并不是什么大不了的事。这是互联网，没有人会想到它是魔法！:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-06T17:06:30.007

在您的系统中实施心跳可能是一个解决方案。这只有在客户端和服务器都在您的控制之下时才有可能。您可以让 DateTime 对象跟踪从套接字接收到最后一个字节的时间。并假设在一定时间间隔内未响应的套接字丢失。这仅在您实施了心跳/自定义保持活动时才有效。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-01-06T19:18:49.913

我发现非常有用，另一种解决方法！

如果您使用异步方法从网络套接字读取数据（我的意思是，使用`BeginReceive`-`EndReceive` 方法），每当连接终止时；出现以下情况之一：发送的消息没有数据（您可以看到它`Socket.Available`- 即使`BeginReceive`被触发，它的值也将为零），或者`Socket.Connected`在此调用中值变为 false（然后不要尝试使用`EndReceive`）。

我发布了我使用的功能，我想你可以更好地理解我的意思：

* * *

```
private void OnRecieve(IAsyncResult parameter) 
{
    Socket sock = (Socket)parameter.AsyncState;
    if(!sock.Connected || sock.Available == 0)
    {
        // Connection is terminated, either by force or willingly
        return;
    }

    sock.EndReceive(parameter);
    sock.BeginReceive(..., ... , ... , ..., new AsyncCallback(OnRecieve), sock);

    // To handle further commands sent by client.
    // "..." zones might change in your code.
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-07-28T03:08:33.077

这对我有用，关键是您需要一个单独的线程来通过轮询分析套接字状态。在与套接字失败检测相同的线程中执行此操作。

```
//open or receive a server socket - TODO your code here
socket = new Socket(....);

//enable the keep alive so we can detect closure
socket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.KeepAlive, true);

//create a thread that checks every 5 seconds if the socket is still connected. TODO add your thread starting code
void MonitorSocketsForClosureWorker() {
    DateTime nextCheckTime = DateTime.Now.AddSeconds(5);

    while (!exitSystem) {
        if (nextCheckTime < DateTime.Now) {
            try {
                if (socket!=null) {
                    if(socket.Poll(5000, SelectMode.SelectRead) && socket.Available == 0) {
                        //socket not connected, close it if it's still running
                        socket.Close();
                        socket = null;    
                    } else {
                        //socket still connected
                    }    
               }
           } catch {
               socket.Close();
            } finally {
                nextCheckTime = DateTime.Now.AddSeconds(5);
            }
        }
        Thread.Sleep(1000);
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-01-02T03:36:28.287

此处的示例代码 [http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.connected.aspx](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.connected.aspx) 展示了如何在不发送任何数据的情况下确定 Socket 是否仍处于连接状态。

如果您在服务器程序上调用了 Socket.BeginReceive()，然后客户端“优雅地”关闭了连接，则会调用您的接收回调并且 EndReceive() 将返回 0 个字节。这些 0 字节意味着客户端“可能”已断开连接。然后，您可以使用 MSDN 示例代码中显示的技术来确定连接是否已关闭。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-11-15T09:09:25.910

扩展[mbargiel](https://stackoverflow.com/questions/722240/instantly-detect-client-disconnection-from-server-socket#comment46406629_722265)和[mycelo](https://stackoverflow.com/questions/722240/instantly-detect-client-disconnection-from-server-socket#comment81033459_722265)对已接受答案的评论，以下内容可与服务器端的非阻塞套接字一起使用，以通知客户端是否已关闭。

这种方法不会受到影响接受答案中 Poll 方法的竞争条件的影响。

```
// Determines whether the remote end has called Shutdown
public bool HasRemoteEndShutDown
{
    get
    {
        try
        {
            int bytesRead = socket.Receive(new byte[1], SocketFlags.Peek);

            if (bytesRead == 0)
                return true;
        }
        catch
        {
            // For a non-blocking socket, a SocketException with 
            // code 10035 (WSAEWOULDBLOCK) indicates no data available.
        }

        return false;
    }
} 
```

该方法基于这样一个事实，即该`Socket.Receive`方法在远程端关闭其套接字后立即返回零，并且我们已经从中读取了所有数据。来自[Socket.Receive 文档](https://docs.microsoft.com/en-us/dotnet/api/system.net.sockets.socket.receive?view=netframework-4.7.2#System_Net_Sockets_Socket_Receive_System_Byte___System_Net_Sockets_SocketFlags_)：

> 如果远程主机使用 Shutdown 方法关闭了 Socket 连接，并且已经接收到所有可用数据，则 Receive 方法将立即完成并返回零字节。
> 
> 如果您处于非阻塞模式，并且协议栈缓冲区中没有可用数据，则 Receive 方法将立即完成并抛出 SocketException。

第二点解释了 try-catch 的必要性。

使用该`SocketFlags.Peek`标志会使任何接收到的数据保持不变，以供单独的接收机制读取。

上述内容也适用于*阻塞*套接字，但请注意代码将在 Receive 调用上阻塞（直到接收到数据或接收超时，再次导致 a `SocketException`）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-30T13:50:29.793

你不能只使用选择吗？

在连接的套接字上使用 select。如果选择返回您的套接字为就绪，但随后的接收返回 0 字节，这意味着客户端断开连接。AFAIK，这是确定客户端是否断开连接的最快方法。

我不知道 C#，所以如果我的解决方案不适合 C#（C# 确实提供[选择](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.select(VS.71).aspx)）或者我误解了上下文，请忽略。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-01-05T13:24:38.627

使用 SetSocketOption 方法，您将能够设置 KeepAlive，它会在 Socket 断开连接时通知您

```
Socket _connectedSocket = this._sSocketEscucha.EndAccept(asyn);
                _connectedSocket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.KeepAlive, 1); 
```

[http://msdn.microsoft.com/en-us/library/1011kecd(v=VS.90).aspx](http://msdn.microsoft.com/en-us/library/1011kecd(v=VS.90).aspx)

希望能帮助到你！拉米罗·里纳尔迪

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-11-26T20:46:46.497

我有同样的问题，试试这个：

```
void client_handler(Socket client) // set 'KeepAlive' true
{
    while (true)
    {
        try
        {
            if (client.Connected)
            {

            }
            else
            { // client disconnected
                break;
            }
        }
        catch (Exception)
        {
            client.Poll(4000, SelectMode.SelectRead);// try to get state
        }
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-02-19T20:40:25.247

这是在 VB 中，但它似乎对我很有效。它像上一篇文章一样寻找 0 字节返回。

```
Private Sub RecData(ByVal AR As IAsyncResult)
    Dim Socket As Socket = AR.AsyncState

    If Socket.Connected = False And Socket.Available = False Then
        Debug.Print("Detected Disconnected Socket - " + Socket.RemoteEndPoint.ToString)
        Exit Sub
    End If
    Dim BytesRead As Int32 = Socket.EndReceive(AR)
    If BytesRead = 0 Then
        Debug.Print("Detected Disconnected Socket - Bytes Read = 0 - " + Socket.RemoteEndPoint.ToString)
        UpdateText("Client " + Socket.RemoteEndPoint.ToString + " has disconnected from Server.")
        Socket.Close()
        Exit Sub
    End If
    Dim msg As String = System.Text.ASCIIEncoding.ASCII.GetString(ByteData)
    Erase ByteData
    ReDim ByteData(1024)
    ClientSocket.BeginReceive(ByteData, 0, ByteData.Length, SocketFlags.None, New AsyncCallback(AddressOf RecData), ClientSocket)
    UpdateText(msg)
End Sub 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-08-30T19:20:42.620

以上答案可归纳如下：

Socket.Connected 属性确定套接字状态取决于上次读取或接收状态，因此它无法检测当前断开状态，直到您手动关闭连接或远程结束优雅地关闭套接字（关闭）。

所以我们可以使用下面的函数来检查连接状态：

```
 bool IsConnected(Socket socket)
    {
        try
        {
            if (socket == null) return false;
            return !((socket.Poll(5000, SelectMode.SelectRead) && socket.Available == 0) || !socket.Connected);
        }
        catch (SocketException)
        {
            return false;
        }

        //the above code is short exp to :
        /* try
         {
             bool state1 = socket.Poll(5000, SelectMode.SelectRead);
             bool state2 = (socket.Available == 0);
             if ((state1 && state2) || !socket.Connected)
                 return false;
             else
                 return true;
         }
         catch (SocketException)
         {
             return false;
         }
        */
    } 
```

此外，上述检查需要关心轮询响应时间（阻塞时间） 也正如 Microsoft Documents 所说：这种轮询方法“无法检测到诸如网络电缆损坏或远程主机不正常关闭之类的问题”。同样如上所述，socket.poll 和 socket.avaiable 之间存在竞争条件，这可能会导致错误断开连接。

正如微软文档所说，最好的方法是尝试发送或接收数据以检测 MS 文档所说的这些类型的错误。以下代码来自 Microsoft 文档：

```
 // This is how you can determine whether a socket is still connected.
 bool IsConnected(Socket client)
 {
    bool blockingState = client.Blocking; //save socket blocking state.
    bool isConnected = true;
    try
    {
       byte [] tmp = new byte[1]; 
       client.Blocking = false;
       client.Send(tmp, 0, 0); //make a nonblocking, zero-byte Send call (dummy)
       //Console.WriteLine("Connected!");
    }
    catch (SocketException e)
    {
       // 10035 == WSAEWOULDBLOCK
       if (e.NativeErrorCode.Equals(10035))
       {
           //Console.WriteLine("Still Connected, but the Send would block");
       }
       else
       {
           //Console.WriteLine("Disconnected: error code {0}!", e.NativeErrorCode);
           isConnected  = false;
       }
   }
   finally
   {
       client.Blocking = blockingState;
   }
   //Console.WriteLine("Connected: {0}", client.Connected);
   return isConnected  ;
 } 
```

//*****以及来自微软文档的评论******

*   socket.Connected 属性获取 Socket 在最后一次 I/O 操作时的连接状态。当它返回 false 时，Socket 要么从未连接，要么不再连接。 
*   Connected 不是线程安全的；当 Socket 与另一个线程断开连接时，它可能会在操作中止后返回 true。
*   Connected 属性的值反映了最近一次操作时的连接状态。
*   如果您需要确定连接的当前状态，请进行非阻塞、零字节的发送调用。如果调用成功返回或抛出 WAEWOULDBLOCK 错误代码（10035），则套接字仍处于连接状态；//否则，套接字不再连接。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2009-04-06T16:51:09.230

如果要轮询，还可以检查套接字的 .IsConnected 属性。

# iphone - iPhone 开发者是否有资格获得 ADC 硬件折扣

> ID：722245
> 
> 赞同：1
> 
> 时间：2009-04-06T16:40:04.280
> 
> 标签：iphone

如果是这样，您需要在网上和真正的苹果商店提供什么。我会自己检查，但要求提醒。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-10-02T19:48:09.760

从 2010 年 3 月起，新的 Mac 开发人员计划取代了旧的 ADC Premier 和 ADC Select 计划。新的 Mac 开发者计划（99 美元/年）不包括任何硬件折扣。现有的 ADC Premier 和 ADC Select 会员可以继续使用他们现有的折扣，直到他们的会员资格到期。

从[常见问题解答](http://developer.apple.com/programs/adcbenefits/faq.html)：

> **什么是 ADC 硬件购买计划，谁有资格通过 ADC 硬件购买计划获得硬件折扣？**
> 
> ADC 硬件购买计划仅适用于现有的付费 ADC 会员，它允许他们以折扣价购买有限数量的硬件系统，用于开发和测试。ADC Premier 会员每个会员年度可获得十 (10) 次 ADC 硬件折扣，ADC Select 会员每个会员年度可获得一 (1) 次 ADC 硬件折扣。Apple 可自行决定更改价格、产品和计划条款。特定产品采购的价格是装运时有效的价格。所有产品均附有 Apple 对这些产品的标准有限硬件保修。在 ADC 硬件购买计划之外进行的购买将不会以开发商定价重新预订或记入贷方。通过 ADC 硬件购买计划购买的物品不予退款。**新的 Mac 开发者计划没有硬件折扣。**

（强调我的）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T16:48:50.080

我相信您需要 ADC Select（或 Premier）会员资格（或一次性学生开发人员会员资格）才有资格获得 ADC 折扣。

但是，至少在美国，[Select Membership](http://developer.apple.com/products/membership.html)一年只需 499 美元，这比我加入并购买笔记本电脑时的折扣要低。

详细信息在[这里。](http://developer.apple.com/membership/hardware.html)

* * *

更多信息：还有一个[iPhone 开发者计划](http://developer.apple.com/iphone/program/)，但这不提供硬件折扣。99 美元/299 美元的订阅提供了对 iPhone SDK 和 iPhone 3.0 操作系统预发行版的访问权限，以及在音乐商店中分发在 iTunes 上开发的程序的能力。不幸的是，硬件折扣仅适用于 Apple Developer Connection 会员，并且（至少在以前）仅适用于 Mac 硬件，而不适用于 iPhone + 配件。

* * *

在回应有关硬件折扣的评论......苹果并没有隐瞒这一点：

相比之下：MacBook Pro 的[标准美国在线商店价格](http://store.apple.com/us/browse/home/shop_mac/family/macbook_pro?mco=MTE3MDE)为 2799 美元。（现在）

[ADC](http://store.apple.com/us_adc_38839/browse/home/shop_mac/family/macbook_pro?mco=MTE3MDE)的价格仅为 2239 美元，比 499 美元的会员价格还高。

但是，存在一些差异 - 硬件的 ADC 版本没有与零售版本相同的保修，应该用于开发等。有关详细信息，请参阅细则。我错了——iPod Touch 在 ADC 商店打折（359 美元对 399 美元）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-08T03:44:26.933

看来这家店已经不在了:(。

# javascript - Javascript 无法正确呈现此数字：3494793310847464221

> ID：722252
> 
> 赞同：2
> 
> 时间：2009-04-06T16:42:01.733
> 
> 标签：javascript

我有一个有趣的问题，我一直在使用 javascript 进行一些工作，并且数据库 ID 显示为“3494793310847464221”，现在这是作为数字输入到 javascript 中，但它使用该数字作为不同的值，两者都输出到警报并在传递给另一个 javascript 函数时。

这是一些示例代码，可以充分显示错误。

```
<html><head><script language="javascript">alert( 3494793310847464221);
var rar =  3494793310847464221;
alert(rar);
</script></head></html> 
```

这完全让我感到困惑，谷歌曾经不是我的朋友......

顺便说一句，这个数字比那里的数字多 179...

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-06T16:49:46.223

您的数字大于 javascript (2^53) 中允许的最大整数值。之前已经涵盖了[JavaScript 的最高整数值是多少，一个 Number 可以达到而不会丢失精度？](https://stackoverflow.com/questions/307179/what-is-javascripts-max-int-whats-the-highest-integer-value-a-number-can-go-to)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-06T16:50:53.413

在 JavaScript 中，所有数字（甚至整数）都存储为 IEEE-754 浮点数。但是，FP 的“精度”有限（有关更多信息，请参阅[Wikipedia 文章](http://en.wikipedia.org/wiki/Floating_point)），因此您的数字无法准确表示。

您将需要将您的号码存储为字符串或使用其他一些“bignum”方法（不幸的是，我不知道有任何 JS bignum 库在我脑海中浮现）。

**编辑：**在做了一点挖掘之后，似乎并没有以 JavaScript bignum 库的方式完成很多工作。事实上，我能找到的唯一一种 bignum 实现是 Edward Martin 的[JavaScript 高精度计算器](http://www.petting-zoo.org/Calculator.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-06T16:42:45.507

请改用字符串。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-06T16:49:46.567

179 更多是一种看待它的方式。另一种方法是，在前 16 位数字之后，任何其他数字都是 0。我不知道详细信息，但看起来您的变量最多只能存储 16 位数字。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-06T16:54:47.507

一种可能的解决方案是使用 BigInt 库，例如： http: [//www.leemon.com/crypto/BigInt.html](http://www.leemon.com/crypto/BigInt.html)

这将允许您存储任意精度的整数，但它不会像标准算术那样快。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-06T16:51:04.910

这个数字超过 (2^31)-1，这就是问题所在；javascript 使用 32 位有符号整数（意思是，范围从 –2,147,483,648 到 2,147,483,647）。您最好的选择是使用字符串，并创建函数将字符串作为数字进行操作。

如果已经有一个库可以满足您的需求，我不会感到太惊讶。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-04T04:08:12.203

“不能轻易地增加和减少一个字符串......”

真的吗？

```
函数 incr_num(x) {
   var lastdigit=Number(x.charAt(x.length-1));
   if (lastdigit!=9) return (x.substring(0,x.length-1))+""+(lastdigit+1);
   如果 (x=="9") 返回 "10";
   返回 incr_num(x.substring(0,x.length-1))+"0";
}

函数 decr_num(x) {
   if(x=="0") return "(error: cannot decrement zero)";
   var lastdigit=Number(x.charAt(x.length-1));
   if (lastdigit!=0) return (x.substring(0,x.length-1))+""+(lastdigit-1);
   如果 (x=="10") 返回 "9"; // 如果您喜欢前导零，请删除此行
   return decr_num(x.substring(0,x.length-1))+"9";
}

```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-06T16:49:29.953

由于存储为 int 太大，因此将其转换为 float。在 JavaScript 中没有明确的整数和浮点类型，只有通用的数字类型。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-06T16:47:57.913

只是猜测，但也许数字存储为浮点类型，差异可能是因为一些舍入误差。如果是这种情况，如果您使用另一个解释器（浏览器，或者您正在运行它的任何工具），它可能会正常工作

# c++ - 我应该通过引用或值将参数传递给内联函数吗？

> ID：722257
> 
> 赞同：28
> 
> 时间：2009-04-06T16:44:20.260
> 
> 标签：c++, inline

其中之一更快吗？

```
inline int ProcessByValue(int i)
{
    // process i somehow
}

inline int ProcessByReference(const int& i)
{
    // process i somehow
} 
```

我知道整数类型应该按值传递。但是，我担心编译器可能会内联 ProcessByValue 以包含副本。有这方面的规则吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-06T17:06:19.053

这没什么区别。在这两种情况下，代码都将被内联。编译器将消除不必要地复制 int（按值传递），并且不必要地创建对 int 的引用，并在访问 int 时遵循该间接层，也将被消除。

您的问题似乎是基于一些错误的假设：

*   inline 关键字实际上会使您的函数内联。（可能，但这当然不能保证）
*   参考与值的选择取决于内联的函数。（完全相同的性能考虑将适用于非内联函数）
*   它有所作为，并且您可以通过像这样的微不足道的更改来超越编译器（编译器将在任何一种情况下应用相同的优化）
*   并且优化实际上会在性能上产生可衡量的差异。（即使没有，差异也会很小，可以忽略不计。）

> 我知道整数类型应该按值传递。但是，我担心编译器可能会内联 ProcessByValue 以包含副本。有这方面的规则吗？

是的，它会创建一个副本。就像通过引用传递会创建一个引用一样。然后，至少对于像 int 这样的简单类型，编译器会再次消除两者。内联函数不允许改变函数的行为。如果你创建函数来接受一个值参数，它的行为就好像它被赋予了一个值参数，无论它是否被内联。如果您将函数定义为获取引用，则无论它是否内联，它都会表现得好像传递了一个引用。所以做导致正确行为的事情。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-06T17:00:04.123

应根据对函数有意义的内容键入参数。

如果函数采用原始类型，则按值传递是有意义的。我认识的一些人会抱怨如果它被 const ref 通过（因为它是“不必要的”），但我认为我不会抱怨。如果函数采用用户定义的类型并且不修改参数，那么通过 const ref 传递将是有意义的。

如果它是用户定义的类型并且参数被修改，那么函数的语义将决定它应该如何传递。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-06T17:05:27.857

编译器应该能够优化内联函数，以便任一方法生成相同的代码。做一个最清楚的。

如果有疑问，请尝试一下。打开编译器的汇编列表输出，看看是否有区别。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-06T19:40:29.393

如果类型小于或可比指针，则按值传递；例如，int、char、double、小型结构、...

通过引用传递较大的对象；例如，STL 容器。我已经阅读了很多关于编译器能够对其进行优化的信息，但在我接下来的简单基准测试中它们并没有。除非您想浪费时间测试用例，否则请使用`const T& obj`.

奖励：从 c99 使用更快的速度`restrict`（这样你就可以赶上 fortran，它限制指针别名；用例：`f(const T&__restrict__ obj)`。C++ 标准不允许`restrict`关键字，但编译器使用内部关键字 - g++ 使用`__restrict__`。如果在代码，没有速度增益。

g++ 4.9.2 的基准测试：

通过引用传递向量：

```
> cat inpoint.cpp
#include <vector>
#include <iostream>

using namespace std;

inline int show_size(const vector<int> &v) {
  return v.size();
}

int main(){
  vector<int> v(100000000);
  cout << show_size(v) << endl;
  return 0;
}
> g++ -std=c++14 -O2 inpoint.cpp; time ./a.out
100000000

real    0m0.330s
user    0m0.072s
sys     0m0.256s 
```

按值传递向量需要两倍的时间：

```
> cat invalue.cpp
#include <vector>
#include <iostream>

using namespace std;

inline int show_size(vector<int> v) {
  return v.size();
}

int main(){
  vector<int> v(100000000);
  cout << show_size(v) << endl;
  return 0;
}
> g++ -std=c++14 -O2 invalue.cpp; time ./a.out
100000000

real    0m0.985s
user    0m0.204s
sys     0m0.776s 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T17:06:39.723

解决这个问题的最好方法是创建一个测试平台，它可以同时执行这两种操作，构建代码的优化版本，然后检查它的程序集。您将立即看到您的特定编译器和特定用例发生了什么。

当它真正开始时，做你认为你的类的用户对接口的期望。当你把它全部建成并工作时，测量并找出你的瓶颈在哪里。很有可能，这可能产生的任何差异（而且不太可能产生任何差异）将被代码中其他地方更大的性能问题所淹没。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T17:19:11.270

如果您的编译器不够聪明，无法优化掉未修改的本地副本，那么它可能不够聪明，无法优化掉本地引用。在这种情况下，它将为传递引用的情况生成更糟糕的代码（导致每次访问都是间接的）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T18:43:09.960

一个非常简短的回答：在决定是按引用传递还是按值传递时，将内联和非内联函数视为相同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-07T05:34:40.207

在原语的情况下，这并不重要，因为您只传递了 4 个字节。

传递引用的原因是因为它的大小为 4 个字节，并且在自定义类型和大字符串的情况下，这会大大减少大小。

争论是为了速度……通常。

对于内联函数，您希望所有不是原语的类型都通过引用传递，因为您首先告诉编译器内联它。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-09-28T14:31:59.413

一般来说，

仅将输出原语声明为引用。

如果您需要禁止表达式，则仅将输入原语声明为引用或 const ref：

```
int two = plus1( 1 );  //  compile error if plus1 is declared as "int plus1( int& )"

double y = sqrt( 1.1 * 2 );  // compile error if sqrt is declared as "double sqrt( const double& )" 
```

# c++ - 使用包含集合作为值的地图

> ID：722268
> 
> 赞同：1
> 
> 时间：2009-04-06T16:46:53.750
> 
> 标签：c++, stl

基本上我有，

```
typedef  map<std::string, set<double> > MAP_STRING_TO_SET; 
```

用新值更新（添加或删除值）集合而不导致集合被复制的最佳方法是什么？

我看到的唯一可行的解​​决方案是使用`map<std::string, set<double>* >`——我不想做的事情。

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-06T16:52:40.710

该集合仅在初始化时复制。你可以做类似的事情

```
myMap[myString].insert(myDouble); 
```

因为 map::operator[] 返回一个引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T16:54:23.687

你也可以这样做：

```
map<std::string, set<double> >::iterator iter = myMap.find(myString);
if(iter != myMap.end())
{
 iter->second.insert(myDouble);
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-06T16:50:43.040

我认为你可以只使用交换 - 例如。

```
my_map["123"].swap(my_set) 
```

提供的破坏`my_set`对你来说并不重要。这将交换以前的内容`my_map["123"]`with `my_set`，而且速度很快。

索引运算符 [] 返回对包含的引用`set`- 因此，您可以像操作任何其他变量一样操作它。如果您想添加/删除单个值，您可以使用`insert()`or`erase()`方法 - 例如。`my_map["123"].insert(123)`.

当您将新集合分配给地图时，实际上会发生复制 - 例如。

```
my_map["123"]=my_set 
```

将创建`my_set`. 如果你不需要使用`my_set`后面的值，你可以使用`swap()`方法，它只会打乱两个集合的指针。`my_set`但是，将具有上一个的内容`my_map["123"]`。

# c# - 是否有与 C# 中的 Scanner 类等效的字符串？

> ID：722270
> 
> 赞同：35
> 
> 时间：2009-04-06T16:47:15.607
> 
> 标签：c#, java, string, java.util.scanner

在 Java 中，我可以向 Scanner 传递一个字符串，然后我可以做一些方便的事情，比如`scanner.hasNext()`or`scanner.nextInt()`等`scanner.nextDouble()`​​。

这允许一些非常干净的代码来解析包含数字行的字符串。

这是如何在 C# 领域完成的？

如果你有一个字符串说有：

```
"0 0 1 22 39 0 0 1 2 33 33" 
```

在 Java 中，我会将其传递给扫描仪并执行

```
while(scanner.hasNext()) 
    myArray[i++] = scanner.nextInt(); 
```

或者非常相似的东西。这样做的 C# 方法是什么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-06T17:56:02.897

我将把它作为一个单独的答案添加，因为它与我已经给出的答案完全不同。以下是您可以开始创建自己的 Scanner 类的方法：

```
class Scanner : System.IO.StringReader
{
  string currentWord;

  public Scanner(string source) : base(source)
  {
     readNextWord();
  }

  private void readNextWord()
  {
     System.Text.StringBuilder sb = new StringBuilder();
     char nextChar;
     int next;
     do
     {
        next = this.Read();
        if (next < 0)
           break;
        nextChar = (char)next;
        if (char.IsWhiteSpace(nextChar))
           break;
        sb.Append(nextChar);
     } while (true);
     while((this.Peek() >= 0) && (char.IsWhiteSpace((char)this.Peek())))
        this.Read();
     if (sb.Length > 0)
        currentWord = sb.ToString();
     else
        currentWord = null;
  }

  public bool hasNextInt()
  {
     if (currentWord == null)
        return false;
     int dummy;
     return int.TryParse(currentWord, out dummy);
  }

  public int nextInt()
  {
     try
     {
        return int.Parse(currentWord);
     }
     finally
     {
        readNextWord();
     }
  }

  public bool hasNextDouble()
  {
     if (currentWord == null)
        return false;
     double dummy;
     return double.TryParse(currentWord, out dummy);
  }

  public double nextDouble()
  {
     try
     {
        return double.Parse(currentWord);
     }
     finally
     {
        readNextWord();
     }
  }

  public bool hasNext()
  {
     return currentWord != null;
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-31T08:04:04.643

Using part of the answers already given, I've created a `StringReader` that can extract `Enum` and any data type that implements `IConvertible`.

**Usage**

```
using(var reader = new PacketReader("1 23 ErrorOk StringValue 15.22")
{
     var index = reader.ReadNext<int>();
     var count = reader.ReadNext<int>();
     var result = reader.ReadNext<ErrorEnum>();
     var data = reader.ReadNext<string>();
     var responseTime = reader.ReadNext<double>();
} 
```

**Implementation**

```
public class PacketReader : StringReader
{
    public PacketReader(string s)
        : base(s)
    {
    }

    public T ReadNext<T>() where T : IConvertible
    {
        var sb = new StringBuilder();

        do
        {
            var current = Read();
            if (current < 0)
                break;

            sb.Append((char)current);

            var next = (char)Peek();
            if (char.IsWhiteSpace(next))
                break;

        } while (true);

        var value = sb.ToString();

        var type = typeof(T);
        if (type.IsEnum)
            return (T)Enum.Parse(type, value);

        return (T)((IConvertible)value).ToType(typeof(T), System.Globalization.CultureInfo.CurrentCulture);
    }

} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-06T16:51:58.433

虽然这不是完全相同的基本概念，但您可以使用以下 lambda 表达式来完成您要查找的内容：

```
string foo = "0 0 1 22 39 0 0 1 2 33 33";

int[] data = foo.Split(' ').Select(p => int.Parse(p)).ToArray(); 
```

这首先`Split`是`string`, 使用空格作为分隔符。然后，该`Select`函数允许您为数组中的给定成员指定别名（在此示例中我将其称为 ' `p`'），然后对该成员执行操作以给出最终结果。然后`ToArray()`调用将这个抽象的可枚举类转换为一个具体的数组。

因此，为此，这会拆分`string`，然后将每个元素转换为 an并用结果值`int`填充 an 。`int[]`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-06T16:52:05.437

据我所知，框架中没有用于执行此操作的内置类。你必须自己动手。

那不会太难。一个不错的 C# 版本可能会实现 IEnumerable，因此您可以说：

```
var scanner = new Scanner<int>(yourString);
foreach(int n in scanner)
    ; // your code 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-06T17:50:27.013

为了尽可能接近您的语法，如果您只对一种类型（示例中的“int”）感兴趣，这将起作用：

```
static void Main(string[] args)
{
   if (args.Length == 0) { args = new string[] { "3", "43", "6" }; }
   IEnumerator<int> scanner = (from arg in args select int.Parse(arg)).GetEnumerator();
   while (scanner.MoveNext())
   {
      Console.Write("{0} ", scanner.Current);
   }            
} 
```

这是一个更棒的版本，它允许您访问 string 的 IConvertible 实现支持的任何类型：

```
static void Main(string[] args)
{
    if (args.Length == 0) { args = new string[] { "3", "43", "6" }; }
    var scanner = args.Select<string, Func<Type, Object>>((string s) => {
            return (Type t) =>
            ((IConvertible)s).ToType(t, System.Globalization.CultureInfo.InvariantCulture); 
        }).GetEnumerator();
    while (scanner.MoveNext())
    {
        Console.Write("{0} ", scanner.Current(typeof(int)));
    }            
} 
```

只需将不同的类型传递给 while 循环中的“typeof”运算符即可选择类型。

这些都需要最新版本的 C# 和 .NET 框架。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-06T17:07:28.240

您可以像这样使用 linq 来完成此操作：

```
string text = "0 0 1 22 39 0 0 1 2 33 33";
text.Where(i => char.IsNumber(i)).Write(); // do somthing usefull here... 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T17:07:23.670

我将通过以下几种方式之一执行此操作，具体取决于 1) 您是否使用具有 LINQ 支持的最新 .NET 框架，以及 2) 您是否知道这些值是有效整数。这是一个演示两者的函数：

```
 int[] ParseIntArray(string input, bool validateRequired)
  {
     if (validateRequired)
     {
        string[] split = input.Split();
        List<int> result = new List<int>(split.Length);
        int parsed;
        for (int inputIdx = 0; inputIdx < split.Length; inputIdx++)
        {
           if (int.TryParse(split[inputIdx], out parsed))
              result.Add(parsed);
        }
        return result.ToArray();
     }
     else
        return (from i in input.Split()
                select int.Parse(i)).ToArray();
  } 
```

根据其他答案中的评论，我认为您需要验证。在阅读了这些评论之后，我认为你会得到最接近的东西是 int.TryParse 和 double.TryParse，它是 hasNextInt 和 nextInt 的组合（或 hasNextDouble 和 nextDouble 的组合）。

# php - PHP包含文件名中带有句点的文件

> ID：722274
> 
> 赞同：0
> 
> 时间：2009-04-06T16:49:10.030
> 
> 标签：php

某些版本的 PHP 和文件名是否存在问题，如下所示：

```
report.class.php 
```

我尝试使用一个，它失败了一次并且工作了一次，但我无法复制失败。所以我不确定到底是什么原因，更喜欢使用以句点分隔的文件名，但强烈不想在我的网站上使用“脆弱”文件名。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-06T16:51:27.017

包含多个句点的文件名在 PHP 包含中可以正常工作。我希望我能提供更多帮助，但由于您无法复制失败，我只能向您保证它不是文件名。

不过，请考虑在模式 class.xxx.php 中命名您的类。它们将按字母顺序排列在一起。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-06T16:59:27.230

你记得引用你的文件名吗？

例如，它应该是：

```
include 'report.class.php'; 
```

不是

```
include report.class.php; 
```

在后一种情况下，缺少引用会导致 PHP 将字符串解释为常量，然后失败并返回 E_NOTICE，并假设您打算使用字符串文字。句点将被解释为字符串连接运算符，PHP 最终会将您的命令解释为等同于以下内容：

```
include 'reportclassphp'; 
```

如果这是，事实上，发生了什么，那么一定要打开 PHP NOTICE 级别的错误，并注意它们。虽然 NOTICE 级别的错误可能看起来令人讨厌，但大多数情况下它们可能暗示代码中的实际逻辑问题。

# silverlight - 如何使用用户控件属性？

> ID：722290
> 
> 赞同：0
> 
> 时间：2009-04-06T16:52:43.953
> 
> 标签：silverlight, user-controls

如果我制作一个 UserControl，它具有数字属性。我如何使用它们？我的 UserControl 包含多个 Shapes，我需要将 Foreground 属性绑定到所有 Shape.Fill。但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T17:05:32.643

如果您将您的属性设置为 Public，您将能够从它自己的类之外访问您的 UserControl 的属性。

我不确定这是否是你的问题。请详细说明您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T01:16:56.110

1.  使用现有画笔依赖属性在用户控件中使用元素名称绑定

> ```
> <UserControl x:Name="myUC" ...>
>      <Rectangle Fill="{Binding ElementName=myUC, Path=Background}" />
>      <Rectangle Fill="{Binding ElementName=myUC, Path=Background}" />
>      <Rectangle Fill="{Binding ElementName=myUC, Path=Background}" />
> </UserControl> 
> ```

2.  使用*新*的画笔依赖属性在用户控件中使用元素名称绑定。

> ```
> <UserControl x:Name="myUC" ...>
>      <Rectangle Fill="{Binding ElementName=myUC,Path=ShapeBackground}" />
>      <Rectangle Fill="{Binding ElementName=myUC, Path=ShapeBackground}" />
>      <Rectangle Fill="{Binding ElementName=myUC, Path=ShapeBackground}" />
> </UserControl> 
> ```

# asp.net - 在回发中重新创建控件后，在命令事件中获取命令事件参数时出现问题

> ID：722291
> 
> 赞同：3
> 
> 时间：2009-04-06T16:53:30.753
> 
> 标签：asp.net, viewstate

在使用下面的代码第二次单击后，我在获取命令事件 args 时遇到问题。

所以 - 当我处理一个按钮单击并生成一个新按钮来替换那个按钮时，我在下一个按钮单击时丢失了视图状态。

关于我需要做什么才能使其正常工作的任何建议？我不能显着改变结构，因为我必须在命令处理程序中生成可变数量的完全不相关的按钮。

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (IsPostBack)
        {
            LinkButton btn = new LinkButton();
            btn.ID = "btn1";
            this.Panel1.Controls.Add(btn);
            btn.Command += new CommandEventHandler(myLinkButton_Command);          
        }
        else
        {
            LinkButton btn = new LinkButton();
            btn.ID = "btn1";
            this.Panel1.Controls.Add(btn);
            btn.Text = "My Button 1";
            btn.CommandArgument = "1";
            btn.Command += new CommandEventHandler(myLinkButton_Command);
        }
    }

    void myLinkButton_Command(object sender, CommandEventArgs e)
    {
        int newArg = Convert.ToInt32(e.CommandArgument) + 1;// empty string on second mouse click
        this.Panel1.Controls.Clear();
        LinkButton myLinkButton = new LinkButton();          
        myLinkButton.ID = "btn1";
        this.Panel1.Controls.Add(myLinkButton);
        myLinkButton.Text = "My Button " + newArg.ToString();
        myLinkButton.CommandArgument = newArg.ToString();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-06T17:15:51.467

发生这种情况是因为您的面板中有文字控件。当您第一次添加按钮时，它（按钮）是第二个控件。当您稍后清除面板的控件集合时，它会成为第一个控件，并为第一个控件保存视图状态，在随后的回发中将成为文字。

只需转换

```
<asp:Panel ID="Panel1" runat="server">
</asp:Panel> 
```

到

```
<asp:Panel ID="Panel1" runat="server" /> 
```

它会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T17:15:04.557

`CommandArgument`在 Page_Load 中重新创建按钮时忘记设置属性。

# html - 如何创建两个框架之间没有空间？

> ID：722294
> 
> 赞同：7
> 
> 时间：2009-04-06T16:54:21.610
> 
> 标签：html, css

我想要两个框架，它们之间没有空间。这是我的测试用例：

```
<html>
  <frameset framespacing="0" rows="50%, 50%">
    <frame frameborder="0" src="red.html" scrolling="no" noresize="1" />
    <frame frameborder="0" src="red.html"                             />
  </frameset>
</html> 
```

red.html 只是：

```
<html><body bgcolor="red"></body></html> 
```

但是，当我渲染它时，我在两帧之间看到一条白线。我怎样才能让它消失？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-06T17:02:10.717

您需要在 Frameset 标签中指定 FrameBorder 属性。因此，您的主页将如下所示：

```
<html>
  <frameset framespacing="0" rows="50%, 50%" frameborder="0">
    <frame frameborder="0" src="red.html" scrolling="no" noresize="1" />
    <frame frameborder="0" src="red.html"                             />
  </frameset>
</html> 
```

这将解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-25T03:01:21.860

```
<html>
  <frameset framespacing="0" rows="50%, 50%" framespacing="0" frameborder=no>
    <frame frameborder="0" src="red.html" scrolling="no" noresize="1" />
    <frame frameborder="0" src="red.html"                             />
  </frameset>
</html> 
```

frameborder=no 非常重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T13:39:01.183

始终首选使用 css 样式而不是 frameborder 属性。

```
<frameset cols="50%,50%">
<frame src="frame_1.htm" style="border:none">
<frame src="frame_2.htm">
</frameset> 
```

最好尽可能使用 iframe 和 div。

**HTML5 不支持进一步的框架集。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T17:03:44.800

将border=0 添加到您的框架集标签。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-06T17:02:16.317

这是我过去使用的没有白线的工作代码示例。

```
 <frameset rows="10%,*" noresize framespacing=0 frameborder=no border=0 >
       <frameset cols="140,*" noresize framespacing=0 frameborder=no border=0 >
          <frame name="globe" scrolling="no" src="./GIF/globe.jpg" marginwidth="0 marginheight="0">
      <frame name="logo" src="logo.htm" scrolling="no" >
</frameset>
      <frameset cols="160,*" noresize framespacing=0 frameborder=no border=0 >
      <frame name="userselections" src="userselections.php" scrolling="auto">
      <frame name="results" src="nothing.htm" scrolling="auto">
   </frameset>
   <noframes>
      <body>
         <p>This page uses frames, but your browser doesn't support them.</p>
      </body>
   </noframes>
</frameset> 
```

# .net - 您可以使用 DataContractSerializer 对序列化进行条件控制吗？

> ID：722296
> 
> 赞同：2
> 
> 时间：2009-04-06T16:54:43.293
> 
> 标签：.net, serialization, datacontractserializer

我正在将我的一些类转换为使用 DataContractSerialization，以便可以在输出中包含 Linq 实体。在这个过程中，一个理论问题突然出现在我的脑海中，当我打赌答案是“不”时，我想我还是会提出这个问题。

有没有办法有条件地序列化一个对象？例如，如果我为了向客户发送信息而序列化一个 Employee 对象，我可能不想包含地址。另一方面，如果我将其序列化以在管理该员工的网站的 Web 服务中使用，我可能需要该信息。

另一种可能性是根据它们是否是被序列化的基础对象来序列化某些成员。因此，如果我有一个包含 Location 的 Ticket 类，并且 Location 包含一个联系人列表，如果我正在序列化 Ticket，我可能不想要那个联系人列表。但是，如果我尝试使用 Location 本身，那么拥有它可能会很好。

那么对此有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T17:36:07.237

我还没有使用过 WCF，但我知道使用 .Net 中的标准序列化（基于属性），我可以在一个类上有一个 OnSerializing 和一个 OnDeserialized 方法；也许 WCF 提供了类似的东西？在这些方法中，您可以有条件地删除数据（尽管请记住，这意味着您的对象已更改，这是序列化的一个非常讨厌的副作用）。

例子：

```
public class Employee
{
    public Address HomeAddress { get; set; }

    [OnSerializing]
    private void RemoveAddress(StreamingContext context)
    {
        if (1 == 1) // replace with your condition
            HomeAddress = null;
    }

    [OnDeserialized]
    private void PutAddressBack(StreamingContext context)
    {
        if (1 == 1)
            HomeAddress = LoadHomeAddressFromBackingStore();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T00:29:53.543

I recommend against directly returning LINQ to SQL or ADO.NET Entity Framework objects from a web service. Unfortunately, this serializes implementation-specifics. For instance, base class fields are also serialized, as are back links.

# python - 如何获取 wx.ListCtrl 的宽度及其列名？

> ID：722298
> 
> 赞同：1
> 
> 时间：2009-04-06T16:54:59.957
> 
> 标签：python, wxpython, wxwidgets, width, listctrl

我在 wx.Python 中工作，我想让我的 wx.ListCtrl 的列自动调整大小，即至少为列名的宽度，否则与最宽的元素或其列名一样宽。起初我认为 ListCtrlAutoWidthMixin 可能会这样做，但事实并非如此，所以看起来我可能必须自己做（如果有内置的方法，请纠正我！！！）

我怎样才能知道我的列表的标题和元素将呈现多宽？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-04-18T15:34:10.213

除了 jakepars 答案：这应该检查标题是否更大，或者在列中占用最多空间的项目。不是优雅，而是工作......

```
import wx

class Frame(wx.Frame):
    def __init__(self, *args, **kw):
        wx.Frame.__init__(self, *args, **kw)

        self.list = wx.ListCtrl(self, style=wx.LC_REPORT)
        items = ['A', 'b', 'something really REALLY long']
        self.list.InsertColumn(0, "AAAAAAAAAAAAAAAAAAAAAAAA")
        for item in items:
            self.list.InsertStringItem(0, item)
        self.list.SetColumnWidth(0, wx.LIST_AUTOSIZE)
        a = self.list.GetColumnWidth(0)
        print "a " + str(a)
        self.list.SetColumnWidth(0,wx.LIST_AUTOSIZE_USEHEADER)
        b = self.list.GetColumnWidth(0)
        print "b " + str(b)
        if a>b:
            print "a is bigger"
            self.list.SetColumnWidth(0, wx.LIST_AUTOSIZE)
app = wx.App(False)
frm = Frame(None, title="ListCtrl test")
frm.Show()
app.MainLoop() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T23:03:42.673

如果您想省去很多与 wx.ListCtrl 相关的麻烦，您应该改用[ObjectListView](http://objectlistview.sourceforge.net/python/)（有一本不错的食谱和代码示例论坛）。它非常好，我倾向于将它用于除非常基本的 ListCtrl 之外的任何东西，因为它非常强大、灵活且易于编码。这是与之相关[的 wxPyWiki 页面](http://wiki.wxpython.org/ObjectListView)（包括示例代码）。开发人员也在 wxPython 邮件列表中，因此您可以通过电子邮件发送问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T19:43:54.027

是的，你必须自己为 wx.ListCtrl 做这个，我不确定做对是否容易（或优雅）。

考虑使用 wx.Grid，这里有一个小例子可以帮助你：

```
import wx, wx.grid

class GridData(wx.grid.PyGridTableBase):
    _cols = "This is a long column name,b,c".split(",")
    _data = [
        "1 2 3".split(),
        "4,5,And here is a long cell value".split(","),
        "7 8 9".split()
    ]

    def GetColLabelValue(self, col):
        return self._cols[col]

    def GetNumberRows(self):
        return len(self._data)

    def GetNumberCols(self):
        return len(self._cols)

    def GetValue(self, row, col):
        return self._data[row][col]

class Test(wx.Frame):
    def __init__(self):
        wx.Frame.__init__(self, None)
        grid = wx.grid.Grid(self)
        grid.SetTable(GridData())
        grid.EnableEditing(False)
        grid.SetSelectionMode(wx.grid.Grid.SelectRows)
        grid.SetRowLabelSize(0)
        grid.AutoSizeColumns()

app = wx.PySimpleApp()
app.TopWindow = Test()
app.TopWindow.Show()
app.MainLoop() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-31T21:43:01.693

这对我有用

```
import wx

class Frame(wx.Frame):
    def __init__(self, *args, **kw):
        wx.Frame.__init__(self, *args, **kw)

        self.list = wx.ListCtrl(self, style=wx.LC_REPORT)
        items = ['A', 'b', 'something really REALLY long']
        self.list.InsertColumn(0, "AA")
        for item in items:
            self.list.InsertStringItem(0, item)
        self.list.SetColumnWidth(0, wx.LIST_AUTOSIZE)

app = wx.App(False)
frm = Frame(None, title="ListCtrl test")
frm.Show()
app.MainLoop() 
```

# deployment - 如何使用 rpm 更新/替换现有文件？

> ID：722305
> 
> 赞同：23
> 
> 时间：2009-04-06T16:58:49.727
> 
> 标签：deployment, configuration, lamp, rpm

我有几个希望使用 rpm 部署的应用程序。我的应用程序部署中的某些文件会覆盖其他已部署包中的文件。简单地在部署包中包含新文件会导致 rpm 冲突。

我正在寻找使用 rpm 更新/替换已安装文件的正确方法。

我已经提出了一些解决方案，但似乎没有什么是完全正确的。

*   维护包含原始文件的自定义版本的 rpm。

尽管与其他一些可能的解决方案相比，这看起来不像是黑客攻击，但这似乎是一项相对较小回报的大量工作。

*   将 rpm 中的文件包含在另一个名称中，然后将它们复制到帖子部分。

这会起作用，但意味着会在系统中乱扔文件的多个副本。这也意味着每个文件的 rpm 构建规范中的额外维护。

*   在 post 部分使用 wget 替换来自某些已知服务器的原始文件。

这类似于复制技术，但文件甚至不会存在于 rpm 中。不过，这可能就像一个很好的中央配置机构。

*   将文件部署为新文件，然后使用符号链接覆盖原始文件。

这也类似于复制技术，但更简洁。这里的问题是某些文件不像符号链接那样表现得很好。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-06T17:32:53.857

据我所知，RPM 并非旨在允许更新/替换现有文件，因此您所做的任何事情都将成为黑客攻击。

在您列出的选项中，如果目标系统是我管理的系统（正如您所说，它的工作量更大，但它是最干净的解决方案）以及＃2 和＃4 的组合（如果我正在为其他人的系统创建 RPM（以避免分发一堆 RPM，但我会在文档中**非常**清楚地说明我在做什么）。

您还没有描述需要更新或替换哪些文件以及如何更新它们。根据这些问题的答案，您可能还有其他几种选择：

*   许多程序设计为使用单个默认配置文件并从`.d`子目录中获取配置文件。例如，Apache 使用`/etc/httpd/conf/httpd.conf`and `/etc/httpd/conf.d/*.conf`，因此您的 RPM 可以将文件放在下面`/etc/httpd/conf.d`而不是修改`/etc/httpd/conf/httpd.conf`. 如果您需要修改的文件是不遵循此模式但可以修改的配置文件，您可以建议包维护者添加此功能；这不会立即帮助您，但会使将来的版本更容易。
*   对于可以由多个软件包提供的命令行实用程序`sendmail`，系统（请参阅参考资料）允许并排安装提供这些实用程序的 1 个以上的 RPM。同样，如果您需要修改的文件是不遵循此模式但可以修改的命令行实用程序，您可以建议包维护人员添加此功能。`lpr``alternatives``man alternatives`
*   您管理的系统上的配置文件更改最好通过[Cfengine](http://www.cfengine.org/)或[Puppet](http://reductivelabs.com/products/puppet/)等工具进行管理，而不是通过自定义 RPM。我认为 Red Hat 偏爱 Puppet。
*   如果我为我不管理的系统创建 RPM，我会考虑使用像 Bitrock 这样的第三方工具并将我所有的东西都倾倒在下面`/opt`，这样我就不必踩其他管理员的 RPM 安装的文件.
*   *编辑（2019）*：如今，[Software Collections](https://www.softwarecollections.org/en/)提供了一个有用的选择。您可以创建`/opt`安装在`/usr`. Red Hat 使用它来分发更新版本的工具，用于其他稳定和长期（即较旧）的 Red Hat Enterprise Linux 发行版。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-21T18:39:03.007

你也可以执行`rpm -U --replacefiles --replacepkgs ...`，这会给你你想要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-11T17:05:04.160

有关 RPM %files 指令的更多信息，请参见此处：

[http://www.rpm.org/max-rpm/s1-rpm-inside-files-list-directives.html](http://www.rpm.org/max-rpm/s1-rpm-inside-files-list-directives.html)

您可以使用 RPM 脚本中的 %post 和 %pre 部分的参数来确定您是否正在安装、升级或删除软件包。

如果 $1 是 0 - 那么我们正在删除旧的东西。针对已安装的 0 个软件包。如果 $1 是 1 - 那么我们正在安装新的东西。定位总共要安装的 1 个软件包。如果 $1 是 2 或更多 - 那么我们正在升级这个包并且 $1 代表已经安装的包的数量。

这些部分有助于管理版本之间的文件。跟踪您在不同版本之间所做的事情，并考虑如果他们跳过一两个版本可能会做什么。

考虑这些事情，你应该很高兴！

# php - PHP 和 OpenID = 500 错误

> ID：722310
> 
> 赞同：0
> 
> 时间：2009-04-06T17:00:09.303
> 
> 标签：php, iis, iis-7, openid

有一个非常奇怪的问题。

场景：PHP5.2.9、IIS7、PHP 作为 FastCGI 运行。我在 test.concentratedtech.com 上有一个站点。单击登录，输入 OpenID 凭据，点击“验证”，然后立即出现 500 错误。

单击返回，重新提交页面，工作正常。

IIS 失败的请求跟踪显示以下两条消息。这些消息似乎通常表明一切正常，这显然足以触发错误。哇。

有什么想法吗？正如我所说，如果您回击并重新提交，它会完美运行 - 您可以始终重复这种体验：每次偶数尝试都可以正常工作，奇数尝试失败并返回 500。

一：

```
ModuleName FastCgiModule 
Data1 FASTCGI_RESPONSE_ERROR 
Data2 Successfully fetched 'http://concentrateddon.myopenid.com/': GET response code 200

ErrorCode 5 
ErrorCode Access is denied. (0x5) 
```

二：

```
ModuleName FastCgiModule 
Notification 128 
HttpStatus 500 
HttpReason Internal Server Error 
HttpSubStatus 0 
ErrorCode 0 
ConfigExceptionInfo  
Notification EXECUTE_REQUEST_HANDLER 
ErrorCode The operation completed successfully. (0x0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T17:48:18.487

嗯......我有点怀疑，但我一直在随机进行更改并在每次更改后进行测试。

我关闭了 PHP 的错误显示（正常的生产设置，但是这台机器仍在测试中，因此正在显示错误）。问题消失了。

我推测 Yadis OpenID 库以某种方式将 200（“OK”）响应记录为“错误”。显示错误时，PHP 抛出 500。关闭错误显示后，PHP 只是将其吸收并继续运行。我猜。

更新：实际上，诀窍是错误必须在某个地方出现。我禁用了错误显示并启用了错误日志记录（例如，到 Windows 应用程序事件日志，但也可以到文件），一切都很好。

# c# - 检查数据是否符合规则列表

> ID：722314
> 
> 赞同：1
> 
> 时间：2009-04-06T17:01:57.940
> 
> 标签：c#, sql, sql-server, design-patterns, validation

我有兴趣了解是否有一种通用的技术/模式来检查数据库中的数据是否符合一组规则。我可能对每晚运行一项服务/作业感兴趣，该服务/作业会搅动数据并引发规则异常。我非常希望系统是动态的，即很容易定义新规则。

一个非常简单的例子可能是：

```
 Customer Cash% 
 A        50 
 B        25 
 C        30 
```

> 规则：告诉我所有现金少于 50% 的客户。

我并没有真正与特定的工具或想法耦合，但我们的专长是 C#、XML 和 Sql Server。我们所有的数据都在 SQL SERVER 数据库中。

如果没有任何内容，我将返回查看自定义规则定义系统，目前我的想法是基于 XML 中定义的规则（用于动态方面）和针对规则的 Windows 服务处理数据。

干杯。

编辑：我应该说这可能会变得复杂，因此我想根据“模型”检查一堆表及其数据，以查看特定对象是否遵循规则。例如，可能有一个“模型”客户，您想检查有多少客户不遵守模型规则，例如现金、上次付款、国籍等。

编辑：根据几条评论，我完全理解应该首先防止输入“无效”数据。我的场景涉及数据可能完全有效的事实，但是它可能不遵循“内部规则”，不遵循规则的事情可能需要被证明是合理的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T17:38:18.667

由于尚未提及，我建议您看一下**SQLServer 的数据挖掘功能**。其中之一是能够突出显示数据中的异常。

观看此[突出显示异常视频教程](http://msdn.microsoft.com/en-us/library/dd299409.aspx)以帮助您入门。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T17:15:53.260

创建一个 SQL 语句脚本，一条语句等于一条规则。在您的示例中，您的陈述可能是：

```
INSERT INTO EXCEPTION 
   (RULE_NAME, DETAIL) 
VALUES 
("CASH_LEVEL_LOW", SELECT CUSTOMER_ID FROM CUSTOMER WHERE CUSTOMER.CASH < 50); 
```

我不是最新的语法，但你应该能够从这里得到这个想法的要点。它会在每次违规时将一条记录插入另一个表，并提供足够的数据，以便您可以轻松找到该记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T17:04:32.507

您最好的选择可能是在 SQL Server 中创建一个维护计划，在计划中为每个规则设置一个步骤。如果发现任何不符合规则的规则，每个规则都会检查数据并插入异常表。这将允许您利用 SQL Server 提供的工具并对规则本身进行相当容易的维护（添加、删除和重新排序）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T17:23:30.213

> 我非常希望系统是动态的，即很容易定义新规则。

你已经有了这样的系统；它是您的数据库。特别是，检查约束用于防止输入无效数据。

对于像您的示例这样的情况-您希望允许该值但对其进行标记-编写一个视图，如果视图有任何行，则让客户端应用程序发出错误。

这是一个示例： create view low_on_cash as select * from table where "Cash%" < 50 ;

在客户端中，如果“select count(*) from low_on_cash”没有返回 0，则会引发错误；

如果您建立了一个约定，所有此类视图都以前缀命名，例如“error_report”，您的客户端可以在一个查询中从数据库的系统表中选择所有此类视图名称，然后通过调用`"select count(*) from " + viewname;`记录任何错误来迭代该列表返回超过零行。

由于这将是数据驱动的，因此添加一个新的错误报告只不过是创建一个带有正确名称前缀的视图；您不必重新编译客户端。

另一个优势是，添加任何规则引擎都需要学习其领域特定语言来编写规则，培训新员工，即使这样也不可避免地会出现规则不容易涵盖的极端情况。您的编码人员已经了解 SQL，并且它基于 17 年前的 ANSI 标准，该标准基于 20 年前的使用，因此大多数极端情况已从该语言中消除。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T17:32:27.820

就我个人而言，我不允许在我的数据库中输入不符合业务规则的数据。这就是检查约束、唯一索引和触发器的用途。

# python - 什么是适用于 MS Windows 的 QuickTime API 的好教程？

> ID：722315
> 
> 赞同：3
> 
> 时间：2009-04-06T17:02:03.837
> 
> 标签：python, windows, quicktime, rebol

我正在开发一个必须在 Windows 上读取和操作 QuickTimes 的项目。不幸的是，Apple 网站上的所有教程和示例代码似乎都是针对 Mac 的。网络上是否有专门针对 Windows 的 QuickTime 编程的好资源？是的，我知道我可以（最终）通过 Mac 的东西猛烈抨击并最终得到一些工作，但我真的很想看到在 Windows 上处理它的最干净和最好的方法以及要注意的问题.

对于额外的点，很高兴看到有人如何通过 REBOL 或 Python 等动态语言使用 QuickTime API（不，Mac Python QuickTime 绑定不算数！）。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T17:09:30.437

[QuickTime For Windows](http://developer.apple.com/documentation/QuickTime/Rm/QTforWindows/QTforWindows/B-Chapter/2QuickTimeForWindows.html)从 Mac OS 和 Windows 编程之间的差异和将[QuickTime 功能构建到 Windows 应用程序](http://developer.apple.com/documentation/QuickTime/Rm/QTforWindows/QTforWindows/C-Chapter/3BuildingQuickTimeCa.html)中开始，然后讨论如何将功能整合到 Windows 平台中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T08:09:40.413

有一个针对[QT 开发人员](http://lists.apple.com/mailman/listinfo/quicktime-api)的官方邮件列表。它有一个存档。*如果您正在认真尝试将*QT 用于某些事情，那么订阅它当然是值得的，特别是如果它有点偏离常规。

恕我直言，官方文档有点过于以苹果为中心。请注意，Windows 书籍假定您已经有在 Mac 上使用 QT 的经验。在我寻找的时候（大约一年前），我的任务是处理来自 .NET 的 QT，无论是来自 C# 还是托管 C++。那时，这不是一个有据可查的做事方式。

在 Apple 开发人员网站的某个地方有一段适用于 Windows 的示例代码，如果您能找到它可能会有所帮助。我似乎失去了曾经拥有的链接。仅仅知道它确实存在（或一年前确实存在）可能足以将您推向正确的方向。

几乎所有可用的示例代码都是普通的 C 或 C++。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T17:29:59.060

我已经在[code.google.com/p/qtip](http://code.google.com/p/qtip)上使用我的 QuickTime for Windows 代码启动了一个 Google 代码项目。这个想法是以半教程的方式构建事物（因为我自己学习这些东西！），以便其他人可以从我的痛苦中学习......

# python - Django GROUP BY strftime 日期格式

> ID：722325
> 
> 赞同：15
> 
> 时间：2009-04-06T17:04:07.343
> 
> 标签：python, django, orm, django-models, django-aggregation

我想对数据库中的行进行 SUM 并按日期分组。

我正在尝试使用 Django 聚合和注释运行此 SQL 查询：

```
select strftime('%m/%d/%Y', time_stamp) as the_date, sum(numbers_data)
    from my_model
    group by the_date; 
```

我尝试了以下方法：

```
data = My_Model.objects.values("strftime('%m/%d/%Y',
           time_stamp)").annotate(Sum("numbers_data")).order_by() 
```

但似乎您只能在 values() 函数中使用列名；它不喜欢使用 strftime()。

我该怎么办？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-06T19:45:11.013

这对我有用：

```
select_data = {"d": """strftime('%%m/%%d/%%Y', time_stamp)"""}

data = My_Model.objects.extra(select=select_data).values('d').annotate(Sum("numbers_data")).order_by() 
```

花了一点时间才发现我必须避开 % 符号。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-07-09T19:57:13.843

从 v1.8 开始，您可以使用[Func() 表达式](https://docs.djangoproject.com/en/1.8/ref/models/expressions/#func-expressions)。

例如，如果您恰好针对 AWS Redshift 的日期和时间函数：

```
from django.db.models import F, Func, Value

def TimezoneConvertedDateF(field_name, tz_name):
    tz_fn = Func(Value(tz_name), F(field_name), function='CONVERT_TIMEZONE')
    dt_fn = Func(tz_fn, function='TRUNC')
    return dt_fn 
```

然后你可以像这样使用它：

```
SomeDbModel.objects \
 .annotate(the_date=TimezoneConvertedDateF('some_timestamp_col_name',
                                           'America/New_York')) \
 .filter(the_date=...) 
```

或像这样：

```
SomeDbModel.objects \
 .annotate(the_date=TimezoneConvertedDateF('some_timestamp_col_name',
                                           'America/New_York')) \
 .values('the_date') \
 .annotate(...) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T17:12:10.727

通过对数据库运行以下查询，任何不只是在数据库中执行此操作的理由：

```
select date, sum(numbers_data) 
from my_model 
group by date; 
```

如果您的答案是，日期是具有非零小时、分钟、秒或毫秒的日期时间，我的答案是使用日期函数来截断日期时间，但我无法确切告诉您那是什么而不知道是什么您正在使用的 RBDMS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-17T14:13:30.303

我不确定strftime，我下面的解决方案是使用sql postgres trunc ...

```
select_data = {"date": "date_trunc('day', creationtime)"}       
ttl = ReportWebclick.objects.using('cms')\
                    .extra(select=select_data)\
                    .filter(**filters)\
                    .values('date', 'tone_name', 'singer', 'parthner', 'price', 'period')\
                    .annotate(loadcount=Sum('loadcount'), buycount=Sum('buycount'), cancelcount=Sum('cancelcount'))\
                    .order_by('date', 'parthner') 
```

-- 等于sql查询执行：

```
选择 date_trunc('month', creationtime) 作为日期，tone_name，sum(loadcount)，sum(buycount)，sum(cancelcount)
来自 webclickstat
按tone_name、日期分组；

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-10T03:52:22.040

当我的数据库是 mysql 时，我的解决方案是这样的：

```
select_data = {"date":"""FROM_UNIXTIME( action_time,'%%Y-%%m-%%d')"""} 
qs = ViewLogs.objects.filter().extra(select=select_data).values('mall_id', 'date').annotate(pv=Count('id'), uv=Count('visitor_id', distinct=True)) 
```

要使用哪个函数，您可以阅读 mysql 日期时间处理器文档，例如 DATE_FORMAT,FROM_UNIXTIME...

# sql - 引用 Sql Server 2008 数据库的 Sql Server 2000 触发器失败

> ID：722341
> 
> 赞同：0
> 
> 时间：2009-04-06T17:09:18.423
> 
> 标签：sql, sql-server, windows-server-2008

我们有一个 Sql Server 2000 数据库应用程序，当某些表发生更改时，它需要更新我们的应用程序 Sql Server 2008 数据库。为此，我们在 Sql 2000 服务器上使用触发器来触发 Sql 2008 服务器上的存储过程。从 SMSS 尝试时，我收到以下消息：

```
The operation could not be performed because the OLE DB provider 'SQLOLEDB' was unable to begin a distributed transaction. 
```

我们的应用程序曾经使用 Sql Server 2005 数据库，但本周末我们升级了服务器。链接服务器对象具有与旧服务器相同的配置。这是我的 DTC 配置。还有什么可能出错的吗？

[dtc 配置 http://yourcls.com/dtc-configuration.png](http://yourcls.com/dtc-configuration.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T17:27:10.487

谷歌为我想出了[这篇知识库文章](http://support.microsoft.com/kb/839279)。从您的屏幕截图中，您似乎已经正确配置了 DTC（虽然我只是略读，但一定要仔细检查一下）。你检查你的防火墙设置了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T18:28:05.457

事实证明，我们的 Sql 2000 服务器上的相同 DTC 安全配置窗口没有启用任何网络 DTC 访问。这显然适用于我们的旧服务器，但是当我们升级到 Server 2008 和 Sql Server 2008 时，需要在两台服务器上都启用它。这是一个谜。

# java - 一般来说，学习 Spring AOP 或 AOP 的最佳方法是什么？

> ID：722342
> 
> 赞同：11
> 
> 时间：2009-04-06T17:09:20.950
> 
> 标签：java, spring, aop

我有在 Spring 框架中工作的经验，但我发现很难理解 Spring AOP 或 AOP 的基础知识。你们能否向我推荐一些你遇到的好的在线教程/书籍来学习它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T17:13:03.313

我通过阅读[AspectJ 文档](http://www.eclipse.org/aspectj/docs.php)了解到。

*   [入门](http://www.eclipse.org/aspectj/doc/released/progguide/starting.html)
*   [AspectJ 编程指南](http://www.eclipse.org/aspectj/doc/released/progguide/index.html)

我发现这些文档让我做好了充分的准备，可以毫不费力地深入研究 Spring AOP。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T02:40:06.833

[Ramnivas Laddad 的书](https://rads.stackoverflow.com/amzn/click/com/1930110936)确实非常好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-26T05:54:53.927

有一些视频可以帮助您快速学习 AOP。（总共只需 1 小时）

转到 ->[春季教程](https://www.youtube.com/watch?v=QdyLsX0nG30&list=PLE37064DE302862F8)（视频 24、25、26 和 27）

他们给你一个快速的开始。观看视频后，你可以更容易地了解细节，你可以从 -> [spring 文档](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T03:24:49.707

这是刚刚出现在 DZone 上的教程：

[http://java.dzone.com/articles/introduction-spring-aop](http://java.dzone.com/articles/introduction-spring-aop)

另外，我绝对不会声称这是学习 Spring AOP 的*最佳*方式，但我写了一篇简短的文章，展示了如何使用 Spring AOP（带有 AspectJ 注释）使方法调用在单独的线程上执行：

[http://wheelersoftware.com/articles/spring-javamail-aop.html](http://wheelersoftware.com/articles/spring-javamail-aop.html)

正如 duffymo 所说，Ramnivas Laddad 的书是一个很好的起点。

# c# - .Net 包含页面 - 类似于 php 要求

> ID：722347
> 
> 赞同：1
> 
> 时间：2009-04-06T17:09:57.750
> 
> 标签：c#, .net

是否有 ac# 命令包含另一个网页 - php 要求的等价物？我知道如何做服务器端包含，但正在寻找基于代码的东西。谢谢

> * * *

谢谢大家的回答。我想我可能需要进一步解释。我有几个子页面，我将在使用站点期间使用 xmlhttp 请求加载它们。但是，最初，我需要在用户与站点交互之前加载起始子页面。我可以用 js 来做到这一点，但这需要更多的来自客户端的服务器调用开销来进行初始加载。我已经使用了母版页，但这有点不同。由于这最初是在服务器端完成的，但必须保持能够在客户端刷新，我认为我不能将这些页面变成控件，可以吗？我对 .Net 还很陌生，所以我可能会让我的生活变得比我需要的更难。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-06T17:13:46.977

我认为您可能正在寻找的是[MasterPages](http://msdn.microsoft.com/en-us/library/wtxbf3hh.aspx)和[UserControls](http://msdn.microsoft.com/en-us/library/ms745025.aspx)。MasterPage 允许您定义一个由实现页面“填充”的基本模板，方法是让实现页面将其自己的内容添加到 MasterPage 上定义的 ContentPlaceHolders。UserControl 是一段可重用的标记和相关代码，您可以从标记中引用或动态添加到代码隐藏中呈现的页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T17:18:28.977

ASP.NET 的结构方式，你不应该真的需要这样做。代码已编译，因此您的所有类和函数都应该可以通过引用相关程序集或命名空间来访问，而不必包含单独的代码文件。

您可能正在寻找用户控件，它允许您创建带有相应代码的标记片段，然后在您的页面中引用这些片段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T17:18:29.463

使用 ASP.NET MVC，它看起来像这样：

```
<% Html.RenderPartial("LogOnUserControl"); %> 
```

这样您就可以在您的页面上放置另一个 UserControl。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-13T09:48:49.713

您可以在 asp.net 中使用包含，例如下面提到的代码中的 php include

**`<!--#include file="include/leftmenuscript.inc"-->`**

您还可以使用母版页，如下所述，它会刷新您的基本布局并允许您定义内容占位符，其他页面可以实现和填充内容。母版页是一种流行的方法，用于定义所有页面一致的页面元素，例如您的导航（还有页眉、页脚、通用脚本、CSS 等）。

# asp.net - LINQ to SQL 部分类 OnValidate Changeaction.Delete

> ID：722349
> 
> 赞同：0
> 
> 时间：2009-04-06T17:10:33.567
> 
> 标签：asp.net, .net, validation, linq-to-sql

我有一个 LINQ 部分类：

```
public partial class resp
{
    public IEnumerable<RuleViolation> GetRuleViolations()
    {
        if (String.IsNullOrEmpty(respName))
            yield return new RuleViolation("Responsibility name required", "respName");
        yield break;
    }

    public bool IsValid
    {
        // Quick method for checking to see whether an object contains any RuleViolations
        get { return (GetRuleViolations().Count() == 0); }
    }

    partial void OnValidate(ChangeAction action)
    {
        // Hook to LINQ to be notified before db is actually persisted .. and check to make sure resp is not used by respApprover or approvals
        if (action == ChangeAction.Delete && ((respApprovers.Count() != 0 || approvals.Count() != 0)))
            throw new ApplicationException("You cannot delete a responsibility that is in use");
        if (!IsValid)
            throw new ApplicationException("Rule violations prevent saving");
    }
} 
```

在我的代码中，我希望能够在删除之前检查责任（dbo.resp）是否存在。

我正在使用上述挂钩完成此检查，`OnValidate`如果`... if (action == ChangeAction.Delete) ...`失败则返回应用程序异常。

另外，在正常验证期间，我想检查以确保没有违反规则（在这种情况下是 resp.respName ...）

所以，通常我可以做一个`try { } catch { var errors = resps.GetRuleViolations() }`并检查我是否有验证错误。当然，这不知道正在采取什么行动（Changeaction.Delete）

我想我的主要问题是，我怎样才能`OnValidate`返回一个原因，而不是在`Changeaction`删除时让我的整个应用程序崩溃。通常我会抓住`GetRuleViolations`，但如果我把'if语句'放在`GetRuleViolations`......即使在检查数据是否正确的过程中它也总是正确的（换句话说，`respApprovers.Count()`即使对于我不检查的新插入也很重要'不想。我只希望在删除时进行这些计数检查）

或者可能更简单地说：我想`GetRuleViolations`告诉我何时有人尝试删除已删除的相应，`respApprovers.Count() > 0`或者`approvals.Count() > 0`但仅在`OnValidate` `Changeaction`删除时才告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T17:19:13.657

更改 GetRuleViolations 以接受 ChangeAction 参数，并添加一个使用 ChangeAction.None（或 Update 或 Insert，视情况而定）调用它的无参数版本。然后根据需要将您的支票移到那里。

```
public IEnumerable<RuleViolation> GetRuleViolations( ChangeAction action )
{
    if (action == ChangeAction.Delete) {
       ...
    }
    else {
       ...
    }
}

public IEnumerable<RuleViolation> GetRuleViolations()
{
    return GetRuleViolations( ChangeAction.None );
} 
```

# java-me - N95 上的 J2ME 位置 API - 需要打开诺基亚地图来预热 GPS？

> ID：722354
> 
> 赞同：0
> 
> 时间：2009-04-06T17:12:22.237
> 
> 标签：java-me, geolocation, gps, n95

只有当我通过打开诺基亚地图或谷歌地图来预热 GPS 时，位置 API 似乎才对我有用。

Google Maps 应用程序有一个状态气球，显示卫星数量并让用户知道连接何时处于活动状态，但是我在 J2ME Location API 文档中没有找到任何指定如何执行此操作的内容。

似乎这些应用程序正在调用一些启动 GPS 的功能。如果不打开它们，Location API 将在我的应用程序中超时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-06T23:27:37.887

使用 LocationListener ... :)

# java - 使用 nsis 从复选框中检索选项

> ID：722366
> 
> 赞同：0
> 
> 时间：2009-04-06T17:15:32.900
> 
> 标签：java, nsis

我正在将 nsis 用于 Web 应用程序的安装程序。在向导的一页中，我希望用户选择三个复选框之一：每个复选框都必须以不同的方式设置两个变量。

这是我要运行的代码：

!define DATA_ONE data_one.zip !define DATA_TWO data_two.zip !define DATA_THREE data_three.zip

函数 myfunc ... ${NSD_GetState} $RadioOne $1 ${NSD_GetState} $RadioTwo $2 ${NSD_GetState} $RadioThree $3

```
 ; The two variables i want to set
  Var /GLOBAL CUSTOMER_DATA    ; this should be a File (?)
  Var /GLOBAL LENGTH_POS       ; this is a string

  StrCpy $CUSTOMER_DATA ${DATA_ONE} ; default value
  StrCpy $LENGTH_POS ""

  ${If} $1 == ${BST_CHECKED}         
     StrCpy $CUSTOMER_DATA ${DATA_ONE}
 StrCpy $LENGTH_POS "3"
  ${endif}

  ${If} $2 == ${BST_CHECKED}     
     StrCpy $CUSTOMER_DATA ${DATA_TWO}
     StrCpy $LENGTH_POS ""
  ${endif}

  ${If} $3 == ${BST_CHECKED}     
     StrCpy $CUSTOMER_DATA ${DATA_THREE}
     StrCpy $LENGTH_POS ""
  ${endif}      

; here the line i've got the error
  File ${BUILD_DIR}/$CUSTOMER_DATA 
```

...

功能结束

当我尝试运行它时，我得到了：

```
File: "./$CUSTOMER_DATA" -> no files found.
Usage: File [/nonfatal] [/a] ([/r] [/x filespec [...]] filespec [...] |
  /oname=outfile one_file_only) 
```

我认为错误是因为我正在构建的文件不是在编译时定义的，而是在运行时定义的。这是对的吗 ？我应该使用宏吗？解决这个问题的更优雅的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T16:58:33.033

如果您在编译时知道该安装程序中只会使用其中一个文件，那么您需要使用 !defines 和 !ifdef 以及可能的 !system 做一些编译时魔法（您不能在文件中使用变量命令）

如果用户/最终用户的机器正在做出选择，那么您需要包含所有 3 个文件：

```
SetOutPath $instdir
${If} $somevar == 1
 File "file1"
${EndIf}
${If} $someothervar == 1
 File "file2"
${EndIf}
... 
```

# apache-flex - Flex 当文本对于文本框来说太大时...变小

> ID：722369
> 
> 赞同：2
> 
> 时间：2009-04-06T17:17:15.113
> 
> 标签：apache-flex

我有一个 < mx:Label > 标签，它有一个固定的宽度，通常足够大以显示它需要显示的文本。每隔一段时间，虽然文本有点太长并且被截断并且“......”被附加。而不是发生这种情况，我想将字体大小减小到足以显示整个文本的程度。

有谁知道这样做的好方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T18:21:06.237

字体是一个复杂的野兽。对于给定的文本，您可以使用以下近似公式非常简单地找到字符串长度并计算最大允许字体大小：

```
var max_allowable_size:int = yourLabel.width / yourLabel.text.length; 
```

这可能会导致某些字体出现严重问题，即：

*   请记住，并非所有字体都是相同的，即它们不能都被优雅地调整大小。
*   抗锯齿可能会中断
*   字体可能看起来不太好/文本可能难以辨认
*   当应用于非罗马字符时，上面的幼稚公式可能会中断
*   而且，这是一种低效的方式。

我宁愿建议您定义两种不同的样式，一种是常规样式，另一种是后备样式，字体大小设置为最小，当您遇到较长的标签文本时切换到该样式。您可以使用上述公式中的默认字体大小来计算切换的阈值限制。当然，如果您必须支持本地化/多语言，则需要进行一些实验。

最后，如果您要使用最常用字体以外的任何字体，请始终嵌入字体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T21:08:10.440

有一个 measureText 函数。查看：

[http://frankieloscavio.blogspot.com/2008/01/flex-use-measuretexttxt-to-calculate.html](http://frankieloscavio.blogspot.com/2008/01/flex-use-measuretexttxt-to-calculate.html) [http://livedocs.adobe.com/flex/3/langref/mx/core/UITextFormat.html#measureText ()](http://livedocs.adobe.com/flex/3/langref/mx/core/UITextFormat.html#measureText())

您可能可以使用 measureText 并减小字体大小直到合适为止。

# c# - 如何防止在WinForms TextBox中按下alt键引起的哔声？

> ID：722372
> 
> 赞同：2
> 
> 时间：2009-04-06T17:17:43.520
> 
> 标签：c#, winforms

我正在创建一个例程，允许用户将键盘快捷键复制到文本框中以进行“自定义键盘快捷键”自定义，但是每次按下另一个字母的 alt 键时，它都会产生另一种声音。

我正在捕获 textbox_keydown 事件中的键，以将修饰符 + 其他键解析为可读的 Shift + A 或 Ctrl + Shift + B 方式进入同一个文本框。我应该在 textbox_previewkey 而不是 textbox_keydown 之类的不同事件中执行此操作吗？如何防止 alt 修饰键 + 字母或数字导致哔声？

文本框只是一个普通的 .net 3.5 文本框，它的唯一编辑属性是 ReadOnly 属性为 false。有没有更好的方法可以重新执行此操作？

我目前只是检查是否按下了任何修饰键，然后按下 + az 或 0-9，然后继续将适当按下的键输入到同一个文本框中，如 Shift + A 或 Ctrl + Shift + Y。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-06-18T10:22:51.213

处理 TextBox 的 KeyDown 事件，例如使用 void HandleKeyDown(object source, KeyEventArgs e) 并在内部输入：`if (e.Alt) e.SuppressKeyPress = true;`。

（也适用于 Return 键）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T17:20:06.743

您需要设置`e.Handled = true;`以防止击键冒泡。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T17:21:15.993

忽略，我能够通过从一开始就抑制键码来解决问题，而不会影响其正常功能。这是我使用的：

```
e.SuppressKeyPress = (e.KeyCode == e.KeyCode); 
```

# java - Java的反射器？

> ID：722378
> 
> 赞同：33
> 
> 时间：2009-04-06T17:19:37.930
> 
> 标签：java, .net, decompiling

是否有与[.NET Reflector](http://www.red-gate.com/products/reflector/)等效的 Java ？

编辑：更具体地说，反编译是我所追求的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-06T17:27:33.217

请参阅[如何反编译 Java 类文件？](https://stackoverflow.com/questions/272535/how-do-i-decompile-java-class-files)那里有一个指向[JD-GUI](http://jd.benow.ca/)的链接，这似乎与您要查找的内容有关。

**编辑：**另见[Open Java *.Class Files](https://stackoverflow.com/questions/76314/open-java-class-files)。

**编辑 2：**最好[的免费 Java .class 查看器？](https://stackoverflow.com/questions/202586/best-free-java-class-viewer)，其中特别提到了 .NET Reflector。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-06T17:27:16.570

据我所知，.NET Reflector 的功能在几乎所有 Java IDE 中都可用，包括 Eclipse。只需将`jar`文件添加到项目中，您就可以像浏览自己的类一样浏览其类。

对于反编译器方面（与纯类浏览器相反），也有一些替代方案。JDK 工具`javap`仅反编译为字节码，因此获取源代码并不是很有用（但可能有助于理解代码）。

[JAD](http://en.wikipedia.org/wiki/JAD_%28JAva_Decompiler%29)是 Java 世界中非常流行的反编译器，它在大多数情况下都会生成可编译的 Java 代码（尽管有些字节码序列不容易翻译成有效的 Java，因此存在一些极端情况）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-06T19:57:03.293

您可以获得用于将 .class 反编译为 .java 的**JAD 。**它很擅长。

如果您使用**Eclipse** ，请获取[jadclipse](http://jadclipse.sourceforge.net/)插件。您需要配置 jad.exe 的路径。下次打开 .class 时，您将看到反编译的源代码，而不是 .class 声明。你也可以用 F3 浏览。它非常有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T17:23:24.940

我对 Java 不是很熟悉，但是[JBrowser](http://www.mmsindia.com/JBrowser.html)对你有用吗？

# php - 可以将 HTML 嵌入到 PHP 的“if”语句中吗？

> ID：722379
> 
> 赞同：137
> 
> 时间：2009-04-06T17:19:52.687
> 
> 标签：php, html

如果可能的话，我想将 HTML 嵌入到 PHP if 语句中，因为我认为 HTML 会出现在 PHP if 语句执行之前。

我正在尝试访问数据库中的表。我在 HTML 中创建了一个下拉菜单，其中列出了数据库中的所有表，一旦我从下拉菜单中选择了表，我点击了提交按钮。

我使用 isset 函数查看是否已按下提交按钮，并在 PHP 中运行一个循环以显示数据库中表的内容。所以此时我有完整的表，但我想在这个表上运行更多查询。因此，我试图在 if 语句中执行更多 HTML 的原因。最终，我尝试更新（一行或多行中的 1 个或多个内容）或删除表中的（1 个或多个行）内容。我要做的是创建另一个与表中的列相对应的下拉菜单，以使表搜索更容易，并创建与我是否要更新或删除表中的内容相对应的单选按钮。

* * *

## 回答 #1

> 赞同：407
> 
> 时间：2009-04-06T17:23:10.590

```
<?php if($condition) : ?>
    <a href="http://yahoo.com">This will only display if $condition is true</a>
<?php endif; ?> 
```

根据要求，这里是 elseif 和 else（您也可以在[docs](http://php.net/manual/en/control-structures.alternative-syntax.php)中找到）

```
<?php if($condition) : ?>
    <a href="http://yahoo.com">This will only display if $condition is true</a>
<?php elseif($anotherCondition) : ?>
    more html
<?php else : ?>
    even more html
<?php endif; ?> 
```

就是这么简单。

只有满足条件时才会显示 HTML。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-04-06T17:22:51.447

是的，

```
<?php if ( $my_name == "someguy" ) { ?> 
    HTML GOES HERE 
<?php } ?> 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-04-06T17:43:06.267

是的。

```
<?  if($my_name == 'someguy') { ?>
        HTML_GOES_HERE
<?  } ?> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-07-15T08:56:59.577

使用 PHP 关闭/打开标签不是很好的解决方案，原因有两个：您无法以纯 HTML 格式打印 PHP 变量，并且它使您的代码非常难以阅读（下一个代码块以结束括号开头`}`，但读者有不知道以前是什么）。

更好的是使用[**heredoc**](https://secure.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)语法。它与其他语言（如 bash）中的概念相同。

```
 <?php
 if ($condition) {
   echo <<< END_OF_TEXT
     <b>lots of html</b> <i>$variable</i>
     lots of text...
 many lines possible, with any indentation, until the closing delimiter...
 END_OF_TEXT;
 }
 ?> 
```

`END_OF_TEXT`是你的分隔符（它基本上可以是任何文本，如 EOF、EOT）。之间的所有内容都被PHP视为字符串，就好像它在双引号中一样，因此您可以打印变量，但您不必转义任何引号，因此非常方便打印html属性。

请注意，结束分隔符必须从行首开始，分号必须紧跟其后，不能有其他字符 ( `END_OF_TEXT;`)。

具有单引号 () 中字符串行为的 Heredoc`'`称为**nowdoc**。nowdoc 内部不进行任何解析。使用方式与 heredoc 相同，只是将开始分隔符放在单引号中 - `echo <<< 'END_OF_TEXT'`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-09-04T04:54:43.037

因此，如果条件等于您想要的值，则 php 文档将运行“包含”，并且包含将该文档添加到当前窗口，例如：

`

```
<?php
$isARequest = true;
if ($isARequest){include('request.html');}/*So because $isARequest is true then it will include request.html but if its not a request then it will insert isNotARequest;*/
else if (!$isARequest) {include('isNotARequest.html')}
?> 
```

`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-18T08:00:33.230

```
<?php if ($my_name == 'aboutme') { ?>
    HTML_GOES_HERE
<?php } ?> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-13T05:28:15.687

我知道这是一篇旧帖子，但我真的很讨厌这里只有一个答案建议不要混合 html 和 php。与其混合内容，不如使用模板系统，或者自己创建一个基本的模板系统。

在 php

```
<?php 
  $var1 = 'Alice'; $var2 = 'apples'; $var3 = 'lunch'; $var4 = 'Bob';

  if ($var1 == 'Alice') {
    $html = file_get_contents('/path/to/file.html'); //get the html template
    $template_placeholders = array('##variable1##', '##variable2##', '##variable3##', '##variable4##'); // variable placeholders inside the template
    $template_replace_variables = array($var1, $var2, $var3, $var4); // the variables to pass to the template
    $html_output = str_replace($template_placeholders, $template_replace_variables, $html); // replace the placeholders with the actual variable values.
  }

  echo $html_output;
?> 
```

在 html (/path/to/file.html)

```
<p>##variable1## ate ##variable2## for ##variable3## with ##variable4##.</p> 
```

其输出将是：

```
Alice ate apples for lunch with Bob. 
```

# java - Spring mvc 中的所有 portlet 类是什么？

> ID：722383
> 
> 赞同：3
> 
> 时间：2009-04-06T17:21:06.617
> 
> 标签：java, spring, web-applications, spring-mvc, portlet

在 Spring MVC 中似乎有两个并行的类层次结构，一个带有 portlet，一个没有。

那是什么？为什么会这样，我应该使用什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-06T17:32:36.993

那是因为

> 除了支持传统的（基于 servlet 的）Web 开发之外，Spring 还支持 JSR-168 Portlet 开发。Portlet MVC 框架尽可能地是 Web MVC 框架的镜像，并且也使用了相同的底层视图抽象和集成技术。

Spring 文档（第[16 章。Portlet MVC 框架）](http://static.springframework.org/spring/docs/2.0.x/reference/portlet.html)提供了有关差异的更多信息。

要回答您的最后一个问题：如果您正在开发 portlet（要在门户中部署的 Web 应用程序），您应该使用[Portlet MVC 框架。](http://static.springframework.org/spring/docs/2.0.x/reference/portlet.html)如果您正在开发传统的 Web 应用程序，您应该使用[Web MVC 框架](http://static.springframework.org/spring/docs/2.0.x/reference/mvc.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T17:30:46.157

你的意思是相对于servlet？portlet MVC 框架专门用于开发 JSR-168（也可能是 JSR-286？不确定）portlet。因为 portlet MVC 工作流不同于 servlet MVC 工作流，所以有一个单独的 portlet 层次结构。

如果您正在开发一个 portlet，那么您需要 portlet MVC 框架。否则，Servlet MVC 框架就是您所需要的，您无需担心 portlet 的东西。

# c++ - 如何摆脱 g++ hash_map 弃用警告？

> ID：722386
> 
> 赞同：9
> 
> 时间：2009-04-06T17:21:39.533
> 
> 标签：c++, g++, hashmap, deprecated

当我编译我正在编写的使用 hash_map 的 c++ 应用程序时，我在 g++ 4.3.2 上收到此警告：

您正在使用已弃用的标头。要消除此警告，请使用 ANSI 标准头文件或使用 hte -Wno-deprecated 编译器标志。

```
9> #include <ext/hash_map> 
```

什么包括取代这个？我在谷歌上搜索了一段时间，除了有类似问题的人之外找不到任何东西，但没有解决方案。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-06T17:28:44.693

我的第一个 Google 搜索“ [g++ hash_map deprecated](http://www.google.com/search?q=g%2B%2B+hash_map+deprecated) ”将我带到[一个页面](https://blueprints.launchpad.net/ember/+spec/ember-deprecated-cleanup)，其中包含要使用的内容列表，而不是已弃用的标头和类。

对于`hash_map`, 该列表建议[`unordered_map`](http://en.cppreference.com/w/cpp/container/unordered_map)在`unordered_map`标题中使用 ,。该课程是[TR1](http://en.wikipedia.org/wiki/Technical_Report_1)的新课程。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-06T17:28:49.360

我相信新的数据结构被称为`unordered_map`

```
<tr1/unordered_map> 
```

在`std::tr1`命名空间中找到。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-09T10:02:22.770

包含时，不要忘记添加以下编译器选项；“-std=c++0x”，否则编译会报错

# asp.net - 如何在提交时不上传文件

> ID：722399
> 
> 赞同：2
> 
> 时间：2009-04-06T17:24:13.770
> 
> 标签：asp.net, html

我在 asp.net 中有一个表单，里面有一个 FileUpload 控件。在此控件旁边，我有“上传”按钮，用于将文件上传到文件列表。问题是我还有用于提交整个表单的“提交”按钮。

现在，当有人通过浏览按钮选择文件并按下“提交”而不是“上传”时，正在上传文件，我不希望这样。

我希望 asp.net 或一般的 HTML 答案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T17:28:07.457

听起来 FileUpload 控件和 Upload 按钮应该在它自己的表单中。使用 ASP.NET 和 1 服务器端表单限制，您可能不得不求助于常规 HTML 控件来执行此操作。

或者，如果未单击“上传”，您可以使用 JavaScript 清除“文件上传”。浏览器对文件输入的访问可能很挑剔，但（出于安全原因）因此可能无法访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T17:28:24.587

对于一般的 HTML 答案，让您的文件上传按钮成为与其他表单不同的表单的一部分，这意味着它们被封装在单独的表单标签中。

对于 ASP.NET，您会感到更痛苦，因为 ASP.NET 默认情况下每页只有一个表单。

然而，最终，我认为你最好重新考虑你的设计。尝试将该文件上传放在单独的页面上；如果你的页面做不止一件事，你就会引起用户的困惑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T03:09:34.190

我会把这两种形式分开。使用 JavaScript 或类似的东西可能会很痛苦。分离表格的问题是您必须以一种不会丢失原始表格的方式进行操作，这意味着如果您在文件上传周围有其他表格信息，您可能会遇到一些噩梦，但如果您可以将文件上传放在提交控件的表单上方或下方，这很容易。

```
<form id="A">
  <button name="submit>
</form>
<form id="B">
  <fileupload>
</form> 
```

我在我的一个网站上使用了这种方法，效果很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T17:29:05.363

提交按钮将发送所有表单的信息。

尝试将 FileUpload 控件放在不同的窗体上。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-06T17:29:08.173

如果您想单独提交，您的 FileUpload 控件需要采用自己的形式。当您单击“上传”按钮时，表单的其他部分也将被提交。这就是它的工作原理。

# java - 在Java Plug-In小程序选项中，jar“预加载”是做什么的？

> ID：722402
> 
> 赞同：2
> 
> 时间：2009-04-06T17:26:02.157
> 
> 标签：java, applet

我正在研究加快小程序初始加载时间的选项。查看[Java Plugin Developer Guide](http://java.sun.com/j2se/1.5.0/docs/guide/plugin/developer_guide/applet_caching.html)，我看到一个名为的小程序参数选项`cache_archive_ex`，它引用了预加载。

那是什么？我在任何地方都找不到任何关于这意味着什么的文档。

还有一个更深层次的问题，没有人需要回答——为什么 sun 的文档不解释它的含义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T17:33:33.060

预加载的意思是以下过程：将库加载到 JVM 中，然后在验证一切正常后将其二进制内存表示，包含它的内存区域转储。这允许更快地加载库。JVM 可以简单地将文件内容直接映射到内存中，而无需从库中加载类。

编辑：

这个链接也可能很有趣：http: [//java.sun.com/products/plugin/1.3/docs/appletcaching.html](http://java.sun.com/products/plugin/1.3/docs/appletcaching.html)

这是一种与我描述的机制不同的机制，但也许它回答了你的问题。

# vba - 如何在 Excel VBA 中捕获通过复制/粘贴添加的工作表

> ID：722409
> 
> 赞同：3
> 
> 时间：2009-04-06T17:28:11.467
> 
> 标签：vba, excel, excel-2003

我正在尝试捕获从另一个工作簿复制到工作簿中的工作表。
`Workbook_NewSheet`从另一个工作簿复制工作表时不会触发事件。只有当用户通过（插入->工作表菜单选项）手动插入它们，或者当您通过 VBA 添加新工作表时，才会触发它`ThisWorkbook.Worksheets.Add`。

我试图捕捉的基本上是一个粘贴操作，它会产生一个新的工作表。

这可能来自以下任何用户操作：

1.  用户通过按住 Control 键拖动现有工作表（添加新工作表）来复制现有工作表
2.  用户从另一个工作簿复制工作表
3.  用户从另一个工作簿中移动了工作表

或以下任何 VBA 代码：

```
SourceWorkbook.Sheets(“SourceSheet”).Copy Before:=TargetWorkbook.worksheets(“SheetNameIn Target”) 'copy across workbook'  
SourceWorkbook.Sheets(“SourceSheet”).Move Before:=TargetWorkbook.worksheets(“SheetNameIn Target”) 'move across workbook'  
ThisWorkbook. Sheets(“SheetName”).Copy 'copy within workbook' 
```

如果您知道在 VBA 中捕获此动作/宏结果的任何方法，那将非常有帮助。

请注意，我不想避免这样的用户操作（所以我不想保护工作簿），但我想以编程方式处理粘贴的工作表以验证数据，如果类似的工作表已经存在，则更新现有工作表而不是在两张纸上拥有相同的数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-02-15T09:58:29.587

复制工作表时，其名称将始终以“(2)”结尾，或者至少以“)”结尾。你可以像这样检查

```
Private Sub Workbook_SheetActivate(ByVal Sh As Object)
    If Sh.Name Like "*(2)" Then
        Application.DisplayAlerts = False
        Sh.Delete
        Application.DisplayAlerts = True
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T19:14:35.283

SheetActivate 事件将在所有这些情况下触发。显然它也会在很多其他情况下触发。这听起来很痛苦，但您可以维护自己的工作表集合并将您的集合与 ThisWorkbook.Sheets 集合进行比较，以查看是否添加/删除了某些内容。

如果您试图阻止它，您可能会考虑保护工作簿结构而不是在代码中进行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-28T20:32:15.533

我暗示它的方式是

```
Private Sub Workbook_WindowActivate(ByVal Wn As Window)
ToggleMenuOptions False, 848, 889
End Sub

Private Sub Workbook_WindowDeactivate(ByVal Wn As Window)
ToggleMenuOptions True, 847, 848, 889
End Sub

Public Function ToggleMenuOptions(bToggle As Boolean, ParamArray ControlID() As Variant) As Boolean
'848 Move or Copy Sheet...
'889 Rename Sheet
'847 Delete Sheet
On Error GoTo lblError
Dim oControl As CommandBarControl, oControls As CommandBarControls, iControl As Integer
If IsMissing(ControlID) Then
    ToggleMenuOptions = False
    Exit Function
End If

For iControl = LBound(ControlID) To UBound(ControlID)
    For Each oControl In Application.CommandBars.FindControls(ID:=ControlID(iControl))
        oControl.Enabled = bToggle
    Next
Next
ToggleMenuOptions = True
Exit Function
lblError:
    If Err.Number Then
        ToggleMenuOptions = False
        Exit Function
    End If
End Function

Private Sub Workbook_NewSheet(ByVal Sh As Object)
MsgBox "Please use Add New Project option in custom Toolbar to add new sheets!!", vbExclamation, "Not Supported"
Application.DisplayAlerts = False
Sh.Delete
Application.DisplayAlerts = True
End Sub 
```

所以我的用户将无法重命名、添加或删除工作表。这目前工作得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T16:59:46.027

在不维护单独的工作表集合的情况下，我能想到的唯一方法是维护工作表名称（或工作表代号）的静态数组，并在每次触发 SheetActivate 事件以检测任何添加时将其与工作簿中的实际工作表进行比较。如果您不想/不能将列表保存在数组中，您始终可以使用隐藏表来存储列表。这是否比维护单独的集合更痛苦还是有争议的:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-05T07:09:21.077

我正在做类似的事情，但不能阻止任何用户菜单操作。我有类型很重要的工作表——每张工作表要么是主工作表，要么是从工作表 - 每个主工作表总和在它下面的从工作表上，我需要保持这些公式的清洁。

我不是在额外的隐藏工作表中维护工作表列表，而是在每张工作表上定义 2 个隐藏名称，记录工作表索引与其链接的主工作表的偏移量，以及对链接的主工作表的引用。因此，如果我的工作表是（比如说）其主工作表中的 +2 个选项卡，那么在工作表上激活/停用（不确定在此阶段哪个更好跟踪）如果有任何内容被插入、删除或移动，这个偏移量将会改变。这涵盖了移动或复制工作表可能引起的大部分或所有事件。

如果工作表已被移动，我会循环浏览工作簿并为每张工作表计算新的主/从索引引用。

当我得到这个相当稳定的时候会发布代码，但它似乎是一个可以在各种情况下工作的方案。

# language-agnostic - 旅游承包

> ID：722411
> 
> 赞同：4
> 
> 时间：2009-04-06T17:28:22.183
> 
> 标签：language-agnostic

我刚从大学毕业（12 月毕业，获得 Comp Sci 学士学位）。我在一家非常大的（40,000 多名员工）公司工作了两年多。我的工作和任何人所希望的一样稳定。但是，我总是很无聊，他们不能让我们（开发人员）忙碌。我正在考虑申请一些当地的承包公司并尝试承包。有人告诉我，作为承包商，我可以赚更多的钱，如果我愿意去旅行，甚至可以赚更多。有人告诉我，作为一名承包商，我基本上会一直在编码，没有关于项目章程和阶段闸门的 BS 会议，而且我在一年内学到的东西比我现在工作的 10 年要多（我相信这是因为我们'正在使用 java 1.4，而我们全新的笔记本电脑上装有 windows 2000...大声笑）。我只想知道如果我决定走承包路线会发生什么，以及旅行是否值得。因为我没有孩子，这似乎是做这种事情的最佳时机。

你在承包方面有哪些经历？作为承包商的旅行机制如何工作（支付什么，你每天工作 4 10 小时......等等）？我真的*大部分*时间都在编码吗？我真的会获得对 IT 世界的宝贵见解和知识吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-06T17:39:49.817

我不能特别代表你的情况，但我的公司最近终止了我们所有的承包商作为我们裁员的一部分，许多其他公司也这样做了。大多数公司都冻结了招聘，他们根本不会雇用新员工，无论是否是承包商。我作为承包商工作的朋友都失去了工作，并且通常很难找到新的职位。

如果你已经有一份稳定的工作，我会说现在不是放弃它并尝试转向承包商生活的最佳时机。

你表达了学习新技术的兴趣，所以如果你的公司不让你忙，而你“总是很无聊”，你为什么不利用这段时间阅读你感兴趣的东西呢？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-06T18:07:50.827

我从事 IT 流动劳动力已经 30 多年了。

**“有人告诉我，作为承包商，我基本上会不断编码”**

错误的。您最终可能会进行大量新开发或大量维护。取决于合同公司的关系。

**“没有关于项目章程和阶段门的 BS 会议”**

错误的。合同公司必须上岗。作为一名承包商，你写了很多提案，但最终都被付之一炬。内部计划悄悄地演变成别的东西。外部举措变得丑陋 - 合同被解雇 - 有诉讼。

**“而且我在一年内学到的东西比我现在工作 10 年学到的更多”**

真的。如果你密切注意并仔细记录。更重要的是，如果您在工作场所之外完成了作业。我参加过大量培训，但我认为我经常使用的 75% 的技能（Java、Python、DB 设计、架构、Apache 配置、HTML）必须自学。

**“如果我决定走承包路线会发生什么”**

它的一部分是坏的。零件很好。这是一份工作——这就是为什么他们必须付钱给你。

**“如果旅行值得。”**

让我列出好处——在安克雷奇滑雪，在犹他州滑雪，在佛罗里达群岛潜水，全家乘坐头等舱飞往圣地亚哥，使用希尔顿荣誉客会积分留在 Waldorf=Astoria。

让我列出问题——在学校遇到严重麻烦的孩子。因为旅行错过了亲子时光。航空旅行的无休止压力，包括随处可见的 TSA 安全剧院设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T17:33:35.260

篱笆另一边的草总是更绿。

你被困在一家大公司，拥有所有大公司的管理官僚机构和与之相伴的严格工作角色。如果你与一家大公司签约，猜猜你会得到什么？但是，您可以选择与谁签约（如果他们愿意与有两年经验的人签约）。对我来说，听起来你实际上想为一家以更敏捷的方式开发软件的小公司工作，这是一个更冒险的举动！

请注意，通过签订合同，您将从一个项目转到另一个项目，并且每次都必须从新的客户系统（代码、模型、数据库、工作流等）中获取，通常只需要很少的帮助。如果系统在任何方面都成熟了，那么就会有很多东西需要筛选——如果你幸运的话，它会被记录在案！因此，每次遇到问题时，您都必须给他们打电话或找到他们（这本身就是一项艰巨的任务）以获得所需的知识。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-06T17:36:35.067

几乎在我去过的所有地方，我们都聘请了承包商来处理我们的员工已经忘记或不想工作的旧的、遗留的东西。没有人会为了教你东西而雇佣你——你不会存在足够长的时间，所以他们只会根据你目前的技能雇佣你。相当多的承包商抱怨必须自费使他们的技能保持最新。

您还将减少在会议上花费的时间（嗯......也许不会，您会在那里被告知他们对您的期望），但您还必须管理自己的帐户，并向客户开具发票，然后追上付款。

所以，不要认为承包是使用最新技术进行有趣编码的神奇途径。它可能与此相反。你想要的是一份不同的工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-03T14:38:47.060

我已经签约/咨询了一年多，我真的很享受。一些好处：

*   钱是好的。
*   改变项目经常会降低无聊程度。
*   按家庭规则工作。
*   因为相对于其他员工而言，你是一种昂贵的资源，所以行政上的虚张声势和毫无意义的会议的数量很少。客户希望您花尽可能多的时间来完成与您签订合同的任何工作。
*   与我还是一名普通员工时相比，我学习新知识的速度要快得多。我想这与经常改变项目和与一系列人一起工作有关。

我强烈不同意承包商陷入困境并且必须在自己的时间自学新技能的观点。也许这对于某些领域是正确的，但我的经验却完全相反。我注意到的一件事是，如果你在一个项目上做得很好，即使你对相关技术没有经验，你也会被要求查看其他项目。对于大多数雇主而言，被信任为称职和诚实的人远比简历上的“5 年 J2EE 经验”更重要。

也就是说，它不全是彩虹和蝴蝶。一些缺点：

*   由于缺乏长期就业，获得抵押贷款将非常困难。
*   每当经济低迷时，你都会是第一个碰壁的人。
*   如果您以固定成本为基础工作，则您必须非常擅长项目估算，否则将面临大量无偿加班的风险。
*   除非您具有出色的时间管理技能，否则同时接待多个客户可能会一团糟。

总的来说，我真的很喜欢它，对我来说利远大于弊。如果我有家庭并且不能保证长时间失业的风险，我想我只会回去做一名普通员工。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-06T17:33:42.000

根据我的经验，作为承包商，您确实倾向于较少参与会议。但是您花费大量时间从客户那里挑逗需求并等待对事物的响应。由于您不在组织的日常流程中，因此您必须更加努力地了解正在发生的事情。

# sql - SQL Server 子字符串在单词而不是字符上中断

> ID：722418
> 
> 赞同：4
> 
> 时间：2009-04-06T17:29:43.023
> 
> 标签：sql, word, substring, break

我想在搜索结果中显示不超过 n 个文本字段的字符，以便让用户了解内容。但是，我找不到轻松断词的方法，所以我在断词时用了一个部分词。

当我想显示：“这个学生还没有提交他的最后几个作业”时，系统可能会显示：“这个学生没有提交他的最后几个作业”

我希望系统显示到保留单词的 n 个字符限制，所以我想看看：

“这个学生还没有提交他的最后几个”

是否有可以用 T-SQL 编写的最接近的词函数，或者当我将结果返回 ASP 或 .NET 时应该这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T17:43:35.237

如果您必须在 T-SQL 中执行此操作：

```
DECLARE @t VARCHAR(100)
SET @t = 'This student has not submitted his last few assignments'

SELECT LEFT(LEFT(@t, 50), LEN(LEFT(@t, 50)) - CHARINDEX(' ', REVERSE(LEFT(@t, 50)))) 
```

它不会是*灾难性的慢*，但肯定会比在表示层中慢。

除此之外 - 只是切断单词并为更长的字符串附加省略号也不是坏的选择。这样，至少所有截断的字符串都具有相同的长度，如果您正在格式化为固定宽度的输出，这可能会派上用场。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T17:46:50.953

我同意在数据库之外这样做，这样具有不同长度限制的其他应用程序可以自己决定显示/隐藏什么。也许这可以作为数据库调用的参数。

这是解决方案的快速尝试：

```
DECLARE @OriginalData NVARCHAR(MAX)
    ,@ReversedData NVARCHAR(MAX)
    ,@MaxLength INT 
    ,@DelimiterPosition INT ;

SELECT @OriginalData = 'This student has not submitted his last few assignments'
    ,@MaxLength = 45;

SET @ReversedData = REVERSE(
                        LEFT(@OriginalData, @MaxLength)
                    );

SET @DelimiterPosition = CHARINDEX(' ', @ReversedData);

PRINT LEFT(@OriginalData, @MaxLength - @DelimiterPosition);

/*
This student has not submitted his last few assignments
1234567890123456789012345678901234567890123456789012345
*/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T17:56:10.277

我想补充一下已经提供的解决方案，断字逻辑比表面上看起来要复杂得多。要做到这一点，您将需要为单词的构成定义许多规则。考虑以下：

*   空间 - 没有脑子。
*   连字符 - 这取决于。在**过度曝光**中可能，在**重新制作动画**时可能不会。那么像**01-02-1985**这样的日期呢？
*   时期 - 没有脑子。哦，等等，**myemail@myisp.com**或**$79.95**中的那个呢？
*   逗号 - 在数字中，例如**1,239**否，但在句子中是。
*   撇号 - 在**O'Reily**中不，在**SQL 中是“企业”数据库工具**是的。
*   特殊字符是否单独构成单词？：在**第1项：购买TP**中，冒号算作单词吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T17:32:04.373

我建议在数据库之外执行这种逻辑。使用 C#，它可能看起来类似于：

```
static string Cut(string s, int length)
{
    if (s.Length <= length)
    {
        return s;
    }

    while (s[length] != ' ')
    {
        length--;
    }

    return s.Substring(0, length).Trim();
} 
```

当然，您可以使用 T-SQL 执行此操作，但这是个坏主意（性能不佳等）。如果你真的需要把它放在数据库中，我会使用基于 CLR 的存储过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T17:42:26.550

[我在此站点](http://www.sqlteam.com/article/returning-complete-words-from-a-substring)上找到了答案并对其进行了修改：

*   演员表 (150) 必须大于您要返回的字符数 (100)

    LEFT (Cast(myTextField As varchar(150)), CHARINDEX(' ', CAST(fl​​ag_myTextField AS VARCHAR(150)), 100) ) 作为 myTextField_short

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T17:43:13.973

我不确定这会运行多快，但它会起作用....

```
DECLARE @Max  int

SET @Max=??

SELECT
   REVERSE(RIGHT(REVERSE(LEFT(YourColumnHere,@Max)),@Max- CHARINDEX(' ',REVERSE(LEFT(YourColumnHere,@Max)))))
    FROM YourTable
    WHERE X=Y 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-06T17:48:03.230

我也不建议这样做，但如果你必须这样做，你可以这样做：

```
DECLARE @text nvarchar(max);
DECLARE @end_char int;
SELECT @text  = 'This student has not submitted his last few assignments', @end_char = 50 ;

WHILE @end_char > 0 AND SUBSTRING( @text, @end_char+1, 1 ) <> ' '
    SET @end_char = @end_char - 1

SELECT @text = SUBSTRING( @text, 1, @end_char ) ;

SELECT @text 
```

# jquery - 关于数据馈送的jQuery自动完成问题

> ID：722424
> 
> 赞同：0
> 
> 时间：2009-04-06T17:31:12.363
> 
> 标签：jquery, autocomplete

我正在寻找一种简单的方法来用字典提供自动完成功能并让它显示如下：

“value_to_display”：value_that_gets_inserted，例如

当一个人写 Pink 时，会出现“Pink Floyd (England)”，如果他选择它，Pink Floyd 就会被插入到输入字段中。

我在本地有我的数据，不需要ajax，所以这应该很容易！

```
var data = "One Two Three Etc".split(" ");
$("#example").autocomplete(data); 
```

我尝试过使用结果方法，但没有运气。

你能给我举一个关于如何创建它的例子吗？

感谢您的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T17:39:59.613

我曾经在一次求职面试中使用过自动完成功能。看起来你所做的应该有效。

我现在正在看它：http: [//dogself.com/homework/](http://dogself.com/homework/) (homework.js:152) 看起来和你的代码一样，然后我传入了一些配置

# delphi - 关闭模式对话框时未发送Delphi CMExit消息？

> ID：722438
> 
> 赞同：2
> 
> 时间：2009-04-06T17:34:13.340
> 
> 标签：delphi, validation, focus, delphi-5

在我正在处理的应用程序的一部分中，有一个表单控件在接收到 CMExit 消息时进行验证，这正是 Delphi 文档所说的这样做（此代码示例来自 Delphi 帮助文件）：

```
procedure TDBCalendar.CMExit(var Message: TWMNoParams);
begin
 try
  FDataLink.UpdateRecord;                          { tell data link to update database }
 except
  on Exception do SetFocus;                      { if it failed, don't let focus leave }
 end;
 inherited;
end; 
```

这样做的目的是在控件失去焦点时立即执行验证。因此，例如，如果我单击“确定”按钮，表单控件将失去焦点，该方法将运行，并且在异常时会将焦点设置回该表单控件。（因此，确定按钮上的“单击”事件永远不会通过，对话框也永远不会关闭）。

我遇到的问题是此表单控件位于模式对话框窗口内。单击确定确实会发送 CMExit 消息并导致记录更新（并进行验证）。但是，在表单控件中按 Enter 会导致模式对话框关闭**而不发送 CMExit 消息**。就好像表单控件永远不会“失去焦点”。这意味着不仅对话框在没有表单实际验证数据的情况下关闭，而且数据集也没有更新。

鉴于这个问题，我放置数据集更新/验证代码的最佳位置在哪里？我可以将它移到对话框表单本身并在 OnCloseQuery 处理程序中实现它，但这意味着逻辑在表单控件*和*表单本身中都是重复的。（表单控件用在其他地方，我想避免改变它的行为）。

（我推测 CMExit 没有被触发，因为控件实际上从未*失去*焦点。表单已关闭，但表单控件仍然在关闭的表单上“具有焦点”。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-06T17:39:37.803

关闭窗体不一定会触发 TControl 的退出事件。例如，用户可以按 Alt-F4。

我建议将验证移动到一个单独的过程中，并从退出*和*关闭事件中调用该单独的过程。

以下代码无需太多修改即可工作：

```
function TDBCalendar.UpdateSuccessful: boolean;
begin
  { tell data link to update database }
  { if successful, return True, else return False }
  { this function must be Public if a form is gonna check this value }
  Result := True;
  try
    FDataLink.UpdateRecord;
  except on Exception do
    Result := False;
  end;
  inherited;
end;

procedure TDBCalendar.CMExit(var Message: TWMNoParams);
begin
  //if not valid, then don't let them leave
  if not(UpdateSuccessful) then begin
    SetFocus;
  end;
end;

///////////////////////////////////////////
//on the form that contains your control...
///////////////////////////////////////////

procedure TMyForm.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  //if not valid, then don't let them close the form
  if not(dbcal.ControlIsValid) then begin
    Action := caNone;
  end
  else begin
    inherited;
  end;
end; 
```

# java - 当 WAR 的大小为 41M 时，如何避免在 WAR 中复制 40M 的 java lib？

> ID：722448
> 
> 赞同：6
> 
> 时间：2009-04-06T17:37:52.380
> 
> 标签：java, tomcat, ant, build-process

目前，我的构建过程包括使用 WEB-INF/lib 下的所有必需的 java 库重新打包 war 文件，然后将 war 文件复制到开发/演示/生产服务器以由 tomcat 重新部署。

打包的war文件大小约为41M，目前有40M的外部java库。一定有更好的方法。你是如何解决这个问题的？

我的开发机器是一个 Windows 盒子，Eclipse 作为我的 IDE，Ant 作为我的构建工具。这些服务器都是 Tomcat 5.5 的 linux 机器。

我是否应该将 jar 文件添加到服务器端的 war 包中？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-06T18:03:27.340

我可以看到你在说什么，并且对我们的一些 web 应用程序也有同样的挫败感，但为了保持一致，我建议你保持原样。如果将库复制到 tomcat/lib 目录，您可能会遇到系统类路径与 webapp 类路径的问题。

通过保持原样，您可以确保在开发/演示中部署与生产中相同的东西。当您在生产中手动调整东西时，生活很糟糕，或者您遇到一些疯狂的错误，因为您忘记在生产中将 XYZ.jar 从版本 1.6 更新到 1.6.1_b33，现在它的行为与您认为演示中完全相同的代码不同.

当使用足够重要的东西来拥有开发/演示/生产系统时，我认为一致性比 .war 文件大小更重要。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-09T14:33:08.417

为此，我们使用 rsync 工具（在我们的例子中，使用 windows 下的 cygwin）将部署复制到服务器（运行 linux）。我们使用分解的 WAR/EAR 文件（即一个名为 MyApp.war 的目录结构而不是一个名为 MyApp.war 的 zip 文件），rsync 只会传输已更改的文件。

在一般使用中，rsync 将在大约 5 秒内传输我们 30-40 兆字节的爆炸 EAR。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T10:45:53.360

Tomcat 有一个*[shared/lib](http://tomcat.apache.org/tomcat-6.0-doc/class-loader-howto.html)*目录，它是全局应用程序依赖项的合适位置。但是，这些对所有应用程序都是可见的，这将影响依赖管理，并可能对静态变量等事物产生影响。我不确定您是否可以在 Tomcat 中配置更好的东西。

另一种方法是切换到更复杂的 Web 容器。例如，WebSphere Application Server *Community Edition*（[Geronimo](http://geronimo.apache.org/)的蓝色版本）支持[per-asset 库](http://publib.boulder.ibm.com/wasce/V2.1.0/en/adding-java-libraries.html)。其他免费和商业服务器也支持这一点。我知道[WebSphere Application Server](http://publib.boulder.ibm.com/infocenter/wasinfo/v6r1/topic/com.ibm.websphere.base.doc/info/aes/ae/tcws_sharedlib.html)可以做到，而且我很确定您可以在[Glassfish](http://docs.sun.com/app/docs/doc/820-4336/gatej?l=en&a=view)中做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-04T02:10:18.140

@McDowell，在提到那些 J2EE 服务器时，您应该准确地说它们是 J2EE 服务器（servlet 容器 + 其余部分）。

像@digitaljoel 一样，我建议保持原样。看起来您还没有完成太多的 Web 应用程序部署。您将遇到的问题不值得付出代价（版本冲突、部署错误等）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T17:40:24.387

您能否将不变的 Jars 添加到服务器端的 Java 库路径中，并且只在您的 WAR 中包含定期更改的 Jars？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T17:45:47.197

您可以在 Tomcat/lib 目录中包含外部 java 库。这样他们就留在服务器上。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T20:59:36.280

您可以只部署为 JAR 文件，在本地复制部署环境，然后复制已更改的文件和 jar 本身。路径是唯一真正的问题。

或者你可以考虑设置一个 EAR。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-04T00:58:07.757

我在开发服务器中使用“exploded web application”，偶尔也会在生产中使用。部署过程（基于 ANT）使用我们的包更新 WEB-INF/lib 中的 JAR。仅在开发服务器中，我们激活 Tomcat 重新加载，它负责在发生更改时重新启动应用程序。您应该为这些 Tomcat 分配一些额外的永久内存，并有办法重新启动服务器，因为重新加载可能会不时使 Tomcat 崩溃。

我知道这是一个奇怪的配置，但我无法理解如何不断地重新打包我们的典型应用程序的 30MB（并且不断增长）可以做得更好。可能有一天，开发描述符允许对容器可以下载和缓存的库的外部引用。??

原谅我糟糕的英语。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-09T14:27:29.987

你需要的是一个版本控制工具和一个构建过程。

使用 CSV、SVN、GIT 或任何适合您的方式来控制源代码。使用构建工具来构建您的应用程序：Maven、ant、...

现在，当您想在服务器上部署应用程序时，您只需在计算机上提交更新，在服务器上更新源代码，构建应用程序并从服务器部署它。

这样，服务器只需加载您的修改，它应该会更快。

# java - 在 Java 中构建 Web 应用程序需要学习什么？

> ID：722452
> 
> 赞同：3
> 
> 时间：2009-04-06T17:39:34.730
> 
> 标签：java, jsp, tomcat, servlets

我从事 PHP/MySQL Web 开发已经有一段时间了，我在这方面相当称职。但是最近，我学习了 Java 并爱上了它，现在我真的很想做更多的 Java 工作。

我第一次有机会与一位需要构建 web 2.0ish web 应用程序的客户合作，他同意让我使用任何我想使用的东西，包括 Java。但是，我还没有做过任何网络开发。在 Java 之前，我只看过[官方的 Java 教程](http://java.sun.com/docs/books/tutorial/)，学习了一些小程序和构建 2D pacman 游戏，并在[Google Web Toolkit](http://code.google.com/webtoolkit/)中做过一些简单的工作。

我需要在接下来的最多 2-3 天内开始这个项目，所以我没有太多时间阅读有关该主题的长篇书籍。这是我到目前为止所学到的：

*   在我的开发机器上设置一个 Tomcat 以使用 Eclipse
*   学习了 servlet、the`doPost()`和`doGet()`方法`init()`等的基础知识
*   构建了一个显示 HTML 页面的迷你 MVC 应用程序，让您从下拉列表中选择一些内容，当您点击提交时，它通过函数检索您提交`request.getParameter()`的值，`doPost()`然后转发到显示您选择的值的 JSP 页面。

我认为这些是接下来我需要学习的几件事：

*   如何访问/使用数据库
*   会话和 Cookie
*   可能更多关于 JSP 页面的语法。

似乎有数百个关于 Java Web 开发的主题我一无所知，但我没有时间学习所有内容。我需要有人指出我需要学习的任何其他重要内容，以便使用 Java 和 Google Web Toolkit 构建这个 Web 应用程序（可能有 20 个屏幕）。

另外，我来自[CodeIgniter](http://codeigniter.com)背景，它是 PHP 中的 MVC 框架，它使表单验证、会话管理（它使用数据库会话）、分页和诸如此类的常见任务变得非常容易。如果 Java 中有类似的轻量级框架可以处理此类事情，请同时提及。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T17:44:17.373

您应该跳过基本的 servlet 并使用 Web 框架，从 Struts + Tiles（很容易掌握 - 最多几个小时）到 Spring 等。在你的情况下，我也会使用 Hibernate 进行数据库抽象 - 你不需要在如此短的时间内掌握 JDBC 的速度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T17:47:49.047

首先，我建议您选择[Head First Servlets & JSP](http://www.headfirstlabs.com/books/hfsvlt/)。它将为您提供 Java Web 开发的一个很好的概述。从他们那里，您将能够更好地选择要使用的 Web 框架。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-06T17:58:19.867

我推荐[Matt Raible 的 app fuse](http://raibledesigns.com/rd/tags/appfuse)。

它将为您提供使用 mvc 框架以及一些 java 构建工具将您的应用程序连接到数据库的速成课程。这个[App fuse 演示](http://demo.appfuse.org/)将展示他让事情滚动的速度。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-06T20:47:22.533

有许多不同的 Java Enterprise 技术，很难知道从哪里开始。如前所述，head first JSP & Servlets 这本书非常棒。我目前正在开发一个多年前仅使用 Servlet 制作的企业应用程序。随着时间的推移，我们已经迁移到 JSP，但我们没有使用任何较新的框架。因此，尽管已经过时，但它肯定是一种有效的方法。

关于 java 的事情是，大多数企业开发是一堆不同技术的结合。例如，您可以使用 JSP 为带有 Servlet 后端的视图创建一个应用程序，为您的 DB 连接使用 Hibernate，为您的 XML 使用 JDOM，为您的测试框架使用 JUnit，为您的日志记录框架使用 Log4j 或 AspectJ，使用 Lucene 进行搜索，用于部署的 JBoss（并且部署可能非常重要）等等等等。在接下来的 3 天内，您不会出去学习所有这些技术。

我建议（如前所述）选择一个框架，有很多可供选择的框架，例如 Tapestry、JSF、Wicket、Struts 等，它们将抽象出许多底层技术。您选择的任何 Java 技术背后都有一个愿意提供帮助的优秀社区。

要考虑的另一件事是，因为您似乎急于让事情正常进行，所以（至少在我看来）Java 不是一种用于构建事物的快速语言。它非常冗长，除非您掌握好的细微差别Java 网页设计很容易让自己陷入困境。也许您应该查看 JVM 上可用的其他一些技术（以便您拥有所有可用的 Java 库），例如 Groovy。

如果您愿意，Groovy 允许您使用 Java 语法或类似 Ruby 的动态语法进行编程。此外，Grails 几乎是 Groovy 的 Rails 克隆，可以让您立即编写 Web 应用程序。

无论您选择做什么，祝您好运，欢迎来到 Java Web Apps 的精彩世界。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-04T06:55:37.053

对于基本的简单的基于 java 的网络应用程序，请遵循以下内容

1.  安装 IDE（例如 eclipse、netbeans）
2.  安装 Web/应用服务器（例如 Tomcat/Jboss）
3.  在 IDE 中配置服务器
4.  使用 JSP/Servlet 创建新的动态 Web 项目
5.  学习/开发和运行示例应用程序，其中包括 Spring、Struts、Hibernate、EJB 等先进技术。

我相信设计比技术更重要，所以要不断学习设计模式。所有主要框架都基于不同的设计模式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T20:59:11.117

我建议您先尝试 JSP。JSP 更简单，因为您不必处理底层服务器技术，至少对于简单的应用程序来说不是。它会让你加快速度。之后，随着经验的积累，您可以直接使用 servlet。

它也很适合您的 PHP 直觉。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T22:47:06.817

确实，从 Java Web 开发开始并不像 PHP 那样容易，尤其是 CodeIgniter，一个我已经爱上的框架。

我会推荐 Grails，但首先要选择一本关于该主题的书。我发现为了快速提高工作效率，您需要一个适当的参考资料。我个人使用了 Grails 的权威指南。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-08T09:18:21.267

我建议获取一份[Servlet 2.5 规范](http://jcp.org/en/jsr/detail?id=154)以供参考。这是一本相当不错的读物，对于规范来说并不太枯燥。

它解释了会话、过滤器、侦听器、线程模型等......

另外，看看[JSP Model 2 架构（更好的链接）](http://java.sun.com/developer/technicalArticles/javaserverpages/servlets_jsp/)，它解释了 servlet 和 JSP 的最佳使用。

如果您只有几天的时间从头开始学习，我不建议您查看 Struts 或 Spring。一旦您熟悉了 servlet 和 JSP，那么您可以查看 Spring MVC 以获取一种支持更轻松的控制器单元测试的方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-02T06:05:22.643

在接触任何框架之前，您应该更好地学习基本的 servlet 和 JSP 生命周期。这会更好，因为您将很好地掌握内部工作原理。Head First Servlets and JSP 是您应该阅读的书。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-06T21:03:11.263

我会考虑[在 Grails 上使用 Groovy](http://www.grails.org/)。它上手容易得多，而且它有很多你需要内置的东西。GWT 和 JQuery 一样可以通过插件获得。

Groovy 的优点在于它基本上是 Java 的超集，具有 Rails 的快速启动速度。

它将作为 .war 部署到您的 Java EE 应用服务器。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2009-04-06T17:44:27.713

我喜欢 Sam 的书，“在 21 天内自学 J2EE”。很棒的概念参考和基本语法。现在应该也很便宜了。

# visual-studio-2008 - 如何让 Visual Studio 2008 支持 Windows 9x？

> ID：722454
> 
> 赞同：2
> 
> 时间：2009-04-06T17:39:38.460
> 
> 标签：visual-studio-2008, windows-98

我的问题与此有关：“ [Visual Studio 2008 是否支持 windows 98？](https://stackoverflow.com/questions/213711/does-visual-studio-2008-support-windows-98) ”

对该问题的公认答案是“否”，并且要支持 Windows 9x，您需要继续使用 Visual Studio 2005。我更愿意相信一切皆有可能（有偿），我正在尝试找到一个解决方案让我们吃蛋糕也吃吧。

我们找到了两种可能的解决方案：

1.  旧版扩展器 ( [http://www.legacyextender.com/](http://www.legacyextender.com/) )

2.  ExeVersion ( [http://www.steelbytes.com/?mid=47](https://web.archive.org/web/20131118084130/http://www.steelbytes.com/?mid=47) )

有人走过这条路吗？任何建议，警告，陷阱等？？？目前我只是在做研究，但我们可能会在下个月尝试实现一些东西。

谢谢！

编辑：
是的，它是 C/C++ 和 Win32 API。我们希望能够升级我们的开发环境，而不必为了支持旧客户端而分叉源，不幸的是，在 VS 2008 中编译的程序与 Win9x 二进制不兼容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T09:26:36.480

如果您可以让 .NET 框架在 Windows 98 上运行（我认为 .NET 1.0 可能），那么您始终可以在其上运行应用程序！

# c# - 使用 SQL Command 对象，如何检查结果集是否为空？

> ID：722462
> 
> 赞同：7
> 
> 时间：2009-04-06T17:40:48.143
> 
> 标签：c#, asp.net, sql, ado.net

使用 SQL Command 对象中的 ExecuteScalar 方法，如何检查结果集是否为空？我正在使用 ASP.net、C# 和 MS SQL 2008。现在，当我运行以下代码时，Response.Write在结果集为空时返回**0 。**但我想区分**0**和空结果集，因为我的数据库中有实际的**0**值。

这是后面的当前代码：

```
cmd = new SqlCommand("usp_test", cn);
cmd.CommandType = CommandType.StoredProcedure;

cn.Open();
TestOuput = Convert.ToInt32(cmd.ExecuteScalar());
cn.Close();

Response.Write(TestOutput); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-06T17:47:01.907

查看[ExecuteScalar](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)的定义。它返回一个对象，如果结果集为空，它将有一个空引用。

您看到零的原因是[`Convert.ToInt32`](http://msdn.microsoft.com/en-us/library/23511zys.aspx)在给定时返回零`null`。您需要在将返回值`ExecuteScalar`转换为`int`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T17:45:44.013

DbCommand.ExecuteScalar() 返回第一行的第一列，如果结果为空，则返回 null。您的问题是由 Convert.ToInt32() 引起的，因为它为 null 返回 0。

您必须检查 ExecuteScalar() 返回的值是否为 null，如果它不为 null，则仅调用 Convert.ToInt32()。

```
Object result = command.ExecuteScalar();

if (result != null)
{
   Int32 value = Convert.ToInt32(result);
}
else
{
   // Handle the empty result set case
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T17:48:27.173

正如您[在此处](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)看到的，您可以检查结果是否为 null ：

> 返回值 类型：System.Object 结果集中第一行的第一列，如果结果集为空，则为空引用（在 Visual Basic 中为 Nothing）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T17:48:40.200

执行标量将返回结果集中第一行的第一列。如果没有结果，它应该返回 null。

我的猜测是您的存储过程返回的是计数而不是数据集，这就是您看到 0 的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T17:51:18.230

[`ExecuteScalar`](http://msdn.microsoft.com/en-us/library/system.data.idbcommand.executescalar.aspx)如果结果集为空，则返回`null`（如[@fallen888](https://stackoverflow.com/questions/722462/using-the-sql-command-object-how-can-you-check-to-see-if-the-result-set-is-empty/722489#722489)等人所说）。您看到零的原因是[`Convert.ToInt32`](http://msdn.microsoft.com/en-us/library/23511zys.aspx)在给定时返回零`null`。您需要在将返回值`ExecuteScalar`转换为`int`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-03T12:22:29.027

```
cmd = new SqlCommand("usp_test", cn);
cmd.CommandType = CommandType.StoredProcedure;
cn.Open();
Object outPut=cmd.ExecuteScalar();
if(outPut!=null)
TestOuput = Convert.ToInt32(outPut);
else
//Return Empty Set
cn.Close();

Response.Write(TestOutput); 
```

# django - 对于 Django 开发的初学者来说，Google App Engine 是否比 Webfaction 更好？

> ID：722463
> 
> 赞同：12
> 
> 时间：2009-04-06T17:41:33.883
> 
> 标签：django, google-app-engine, hosting

我是 Django 开发网站的初学者。我运行类似于 SO 的小型讨论网站。

我在 Bluehost 有一个帐户，这一直是 Django 开发的噩梦。我发现 Webfaction 和 Google App Engine 似乎是 Django 的最佳选择。

但是，我不确定哪一个最适合我。

**Google App Engine 在运行小型网站方面是否比 Webfaction 更好？**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-11-14T01:02:46.130

**网络派系**：

加：

1.  伟大的外壳访问。能够安装 python 模块或您可能需要的任何其他模块。你会喜欢从 shell 中检查源代码来更新你的产品（不再需要 FTP 任何东西了！）
2.  非常好的性能和可靠性
3.  强大的支持 + 帮助知识库和论坛中的大量信息。（忘记 bluehost 或您曾经尝试过的任何其他东西）。我对我认为很难回答的问题的答案数量感到惊讶。
4.  您可以使用常规数据库，也可以进行连接（请参阅应用引擎减去 #2）

减：

1.  最初几次设置初始部署可能有点棘手（正如 shell 所预期的那样）。
2.  不断扩大规模可能会很昂贵，而且您可能无法在“slashdotted”中生存

**应用引擎**

加：

1.  免费开始
2.  初始数据库更容易设置。
3.  部署轻而易举
4.  从一开始就执行“好的”设计原则，这可以帮助您实现#5。（如硬限制、数据库非规范化等）
5.  可扩展性（但这不是免费的——你需要提前考虑）。
6.  无需维护：自动备份、免费安全、日志记录 + 集中式仪表板、软件更新是自动的。

减：

1.  在 App Engine 上设置 Django 并不那么简单，而且要习惯这种设置。谷歌的 webapp 框架很弱。
2.  数据库模型需要一点时间来理解。这不是你妈妈的 SQL 服务器。例如，您必须从一开始就对您的数据库进行非规范化，并且您不能进行联接（除非它们是自联接）
3.  你习惯的通常的东西并不总是在那里。测试和数据导入等一些事情不再那么容易了。
4.  您被绑定到 App Engine 并将您的数据迁移到另一个数据库或服务器，虽然并非不可能，但并不容易。（并不是说您经常进行数据迁移！可能永远不会）
5.  请求、响应和文件大小的硬限制（我上次听说大约 1MB）。
6.  App Engine 目前仅支持 Python 2.5。

暂时想不出别的了。我目前在 Webfaction 工作，也在测试 App Engine。从 Django-Webfaction 到 App-Engine 的思维方式，我没有任何困难。但是，我不确定 AppEngine -> Standalone servers 路由是否同样简单。

**参考**

会谈：

*   Google App Engine 上的 Guido [http://www.youtube.com/watch?v=CmyFcChTc4M](http://www.youtube.com/watch?v=CmyFcChTc4M)
*   App Engine 中的任务队列：[http ://www.youtube.com/watch?v=o3TuRs9ANhs](http://www.youtube.com/watch?v=o3TuRs9ANhs)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T17:43:51.477

我不能代表 Google App Engine，但作为最近的 Django 用户，我最近将我的开发站点转移到了 WebFaction 服务器，我必须说我印象非常深刻。他们对 Django 设置（以及其他）非常友好，支持人员及时回答了我遇到的任何小问题。我肯定会推荐他们。

对于其他 Django 友好的主机，请查看[Djangofriendly.com](http://djangofriendly.com/hosts/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-07T07:43:13.797

如果您已经编写了 django 应用程序，那么在 Google App Engine 上安装它可能真的很困难，因为您必须调整您的数据模型。GAE 使用大表、（键、数据）存储，而不是传统的关系模型。它对性能很有好处，但会使您的编程更加困难（例如，没有内置的多对多关系处理程序）。

此外，大多数可用于 django 的应用程序都无法在 GAE 上运行，因为这些应用程序使用关系数据模型。最明显的问题是 django 的出色管理应用程序无法运行。此外，GAE 倾向于让您使用谷歌帐户进行身份验证。这可以避免，但同样，不要使用现成的 django 应用程序。这对您来说可能很好，但可能会很麻烦（例如，谷歌已经使用了很多用户名）。

所以，我最后的建议是，如果你是初学者，你应该避免 GAE。

如果你在欧洲，djangohosting.ch 也是一个不错的选择，而不是 webfaction。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-13T05:38:07.183

我的回答有点晚了，但是……我是 Django 初学者，我的[第一个 Django 应用程序](http://www.aikido.nsk.su)在 GAE 启动并运行。正是[App Engine Patch](http://code.google.com/p/app-engine-patch/)实现了这一目标。使用它你有 django admin 和其他几个开箱即用的应用程序。如果您想尝试一下，请选择后备箱版本。该项目有合理的文档记录，并拥有响应迅速的社区。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-06T17:57:53.657

我是一名谷歌应用引擎开发人员，所以我不能对 webfaction 说太多，但就我使用它而言，使用 app-engine 设置 web 应用程序非常简单¹。然而，支持人员不是很好。

1- [http://code.google.com/appengine/articles/django.html](http://code.google.com/appengine/articles/django.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-07T05:50:11.747

关于 GAE 要记住的是，它的工作方式与标准的 python 安装不同，并且您拥有的应用程序在该环境中可能无法正常运行（或根本无法运行）。最大的区别是数据库。虽然 GAE 提供的非关系型数据库有很多优点，但您需要区别对待，并且您的代码可能期望数据库能够执行许多它不能执行的操作。

如果您是从头开始使用应用程序，则任何一个平台都可以正常工作。如果你有一个现有的 python 应用程序，让它在 GAE 上运行将需要大量的工作。

# c# - C#：在项目中添加启动画面的理想方法是什么？

> ID：722471
> 
> 赞同：4
> 
> 时间：2009-04-06T17:44:13.580
> 
> 标签：c#, .net, winforms, splash-screen

我将在我目前正在处理的应用程序中输入一个启动画面，该应用程序只包含一个我们现在称为 frmMain 的表单。我想实现一个启动画面（frmSplash），但需要关于什么是实现它的最佳方式的建议。启动画面的目的是根据程序上次关闭时的最后设置将必要的设置加载到文本框、复选框等中。这是我的问题。

我应该让主窗体加载，但让它对用户不可见，然后调用将运行的启动屏幕，然后将所有设置加载到主窗体中吗？

如果是这样，我将如何执行上述操作？在 frmMain_Load 事件中加载 frmSplash？我计划让启动画面保持可见至少 3 秒。我将如何给它暂停效果，以便它在从设置文件恢复设置时保持 3 秒？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T17:46:37.227

是的，使用闪屏隐藏表单初始化是一个很好的做法。这是一个很好的教程，应该可以帮助您启动并运行：

[在 C# 中创建启动画面](http://www.codersource.net/csharp_splash_screen.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T17:47:28.270

不加载初始表单中的设置可能更干净，但保留它只是为了显示。显示启动表单并在主表单中加载设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T17:47:16.133

我建议走另一条路。已经`frmSplash`启动，解析设置并将它们传递给一个新的 hidden `frmMain`。一旦`frmMain`完成加载（或 3 秒后）显示它。

或者只是让启动屏幕创建一个隐藏`frmMain`并在完成加载并处于有效状态后显示它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T17:47:57.177

[这里](http://www.codeproject.com/KB/cs/prettygoodsplashscreen.aspx)有一个例子，[这里](http://www.codersource.net/csharp_splash_screen.aspx)有一个更好的解释。

请注意，这些示例都没有执行任何类型的“预加载”，但是您可以在启动线程执行其令人眼花缭乱的工作时在主线程中执行所有这些操作。

希望这是您正在寻找的那种东西。祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-06T17:48:30.683

这是您可以尝试的罐装版本：[Autorun Action Splash](http://www.pollensoftware.com/autorun/autosplash.html)

# asp.net-mvc - 寻找 EF 存储库的代码示例或“模板”

> ID：722482
> 
> 赞同：0
> 
> 时间：2009-04-06T17:46:05.370
> 
> 标签：asp.net-mvc, entity-framework, linq-to-entities, repository-pattern

我正在寻找一个好的实体框架存储库代码示例或模板。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T18:39:49.657

[干得好。](http://stephenwalther.com/blog/archive/2009/02/27/chapter-5-understanding-models.aspx "第 5 章——理解模型")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T22:44:30.380

[Codeplex 上的NCommon](http://www.codeplex.com/ncommon)开源项目中有一个很好的通用存储库、规范和工作单元模式的实现。您可以使用 subversion[将源代码下载](https://ncommon.svn.codeplex.com/svn)到本地计算机并构建它。

作者的博客： http: [//www.codeinsanity.com/](http://www.codeinsanity.com/)

# api - 将 Google MAP API 与 Iphone 应用程序一起使用需要哪些合规性和法律许可？

> ID：722483
> 
> 赞同：0
> 
> 时间：2009-04-06T17:46:16.523
> 
> 标签：api, google-maps

我们正在使用以下 2 个谷歌服务，如果我们需要做一些额外的事情来满足条件，我们需要与谷歌人员交谈：

1.  反向地理编码 API：用于从 iphone 的地理编码（纬度和经度）中获取城市和州
2.  进行本地商户搜索：基于城市和州

在使用这些 Google Maps APS 时，是否必须在 iphone 应用程序中嵌入 Google 地图？：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T17:49:16.267

我认为您只需要提供您自己的地图许可，如果您提供转弯说明。事实上，在 iPhone 3.0 中，Google Map 是一个供开发人员使用的成熟 UI 组件。

# visual-studio-2008 - Visual Studio：使用系统引用以外的方法进行删除和排序

> ID：722487
> 
> 赞同：8
> 
> 时间：2009-04-06T17:46:52.060
> 
> 标签：visual-studio-2008, refactoring

当我使用选项时：Organize Usings -> Remove and sort from Visual Studio 2008 我想清除所有未使用的引用，但保留一些类似 System; 有没有我可以设置的选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T17:50:51.240

不，不幸的是没有。

如果你真的需要它，也许你可以为 Visual Studio 构建自己的插件来完成它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T17:51:04.267

不幸的是，我认为保留未使用引用的唯一方法是在代码中引用它们。

# html - 为什么我的边框没有一直到屏幕顶部？

> ID：722488
> 
> 赞同：0
> 
> 时间：2009-04-06T17:46:52.920
> 
> 标签：html, css

我有一个布局如下的网站：

```
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <body style="margin:0px">
    <div style="border-left: 5px solid black;">
      <div><!-- x -->
        <div>
          <div>
            <div style="margin-top: 100px">
              fish
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html> 
```

我希望整个页面在左侧有一个边框。但是，似乎深度嵌套的 div 的 100px 上边距导致其祖先的左边框被推下。

出于某种原因，如果我取消注释“x”，一切看起来都很棒。

到底是怎么回事？！？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T17:51:48.010

边距折叠，即使包含元素，所以你的内部`div`边距正在推动外部`div`向下。幸运的是，解决方案很简单：将“ `overflow: auto`”添加到您的外部`div`样式（带有边框的样式）。

```
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <body style="margin:0px">
    <div style="border-left: 5px solid black; overflow: auto;">
      <div><div><div>
        <div style="margin-top: 100px">fish</div>
      </div></div></div>
    </div>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T19:26:27.080

> 出于某种原因，如果我取消注释“x”，一切看起来都很棒。

是的，有了'x'，在子margin-top和父margin-top之间会有一些内容。边距不能通过内容、内边距或边框折叠，因此另一个解决方法是在有边距的 div 和有边框的 div 之间的任何元素上放置任意数量的顶部内边距或边框。例如，如果有边框的元素也有一个上边框，那么左边框会向上跳到顶部加入它。

[由于CSS2.1](http://www.w3.org/TR/CSS21/box.html#collapsing-margins)的第 8.3.1 节中的这一行，本的回答是使用副作用来防止边距折叠的常用方法：

> 具有“溢出”而不是“可见”的元素的垂直边距不会与其流入的子元素一起折叠。

But for clarity it might be better to avoid margin collapsing if you can. Using padding in preference to top and bottom margins where possible is generally a good tactic, as the margin-collapsing rules in CSS are unintuitive and unhelpful, and will bite you again and again — even ignoring the bugs in IE6's implementation.

# jquery - 控制器的 Json() 方法不返回数组

> ID：722499
> 
> 赞同：2
> 
> 时间：2009-04-06T17:49:00.870
> 
> 标签：jquery, asp.net-mvc, json

我正在构建我的第一个 MVC 应用程序并在尝试使用 AJAX/JSON 执行搜索时遇到问题。问题似乎是我的控制器返回的 JSON 不是数组，这意味着我不能使用 jQuery 的 $.each 方法来迭代我的项目。我正在尝试通过电子邮件地址搜索用户。

我有一个 SearchController 类，方法如下：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult SearchByEmail(string searchString)
{
  var users = new List<jsonUser>();
  foreach (I_User u in _rep.SearchByEmail(searchString))
  {
    users.Add(new jsonUser()
    {
      EmailAddress = u.EmailAddress,
      FirstName = u.Firstname,
      LastName = u.Surname,
      UserName = u.Username
    });
  }
  return Json(users);
} 
```

哪个会正确触发并返回对我来说看起来像 JSON 数组的东西：

```
[{"EmailAddress":"foo@bar.com","UserName":"foo@bar.com","FirstName":"Foo","LastName":"Bar"}] 
```

然后在我的页面中，我得到了以下代码：

```
$("#search").click(function(evt) {
    var emailsearch = jQuery.trim($("#email").val());
    $.post("/Search/SearchByEmail", { searchString: emailsearch },
        function(Users) {
            $("#jsonlist").text(Users); //Added to check what JSON returns.
            alert($.isArray(Users)); //Added to work out if jQuery thinks this is an array!
            $.each(Users, function() {
                //Do stuff on each user item
            });
        });
    });
}); 
```

通过添加上面的注释行，我已经确定该函数正在获得合理的结果（上面发布的 JSON），但它认为这不是一个数组。因此，$.each 循环中的 $(this) 是未定义的。

我从 NerdDinner 应用程序中借用了其中的大部分内容，但真的看不出有什么区别。任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T18:43:54.640

如果您返回 JSON，您是否尝试将相关数据类型参数添加到 $.post 调用的参数中？

```
$.post("/Search/SearchByEmail", 
       { searchString: emailsearch }, callback, "json"); 
```

帖子通常默认为 Html 或文本，因此它不会执行“反序列化”帖子正文所需的 eval。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T18:12:24.513

我认为您需要 eval() 响应才能使其正确。尝试类似：

```
$("#search").click(function(evt) {
    var emailsearch = jQuery.trim($("#email").val());
    $.post("/Search/SearchByEmail", { searchString: emailsearch },
        function(data) {
            $("#jsonlist").text(data); //Added to check what JSON returns.
            Users = eval( '(' + data + ')' );
            alert($.isArray(Users)); //Added to work out if jQuery thinks this is an array!
            $.each(Users, function() {
                //Do stuff on each user item
            });
        });
    });
}); 
```

# asp.net-mvc - ASP.NET MVC 适合复杂的 Web 应用程序吗？

> ID：722501
> 
> 赞同：7
> 
> 时间：2009-04-06T17:49:11.993
> 
> 标签：asp.net-mvc, webforms

上周，我的老板要求我的团队为下一个项目评估 ASP.NET MVC。我们所有人从 .NET 1.1 开始使用 webform，我们之前没有 MVC 经验，但是我所有的同事都对 ASP.NET MVC 感兴趣，但是没有运气，我们最终的答案是否定的。

因为：

1.  我们相信，尽管您是 ASP.NET 大师，但您可以在短时间内构建复杂的应用程序。但是如果你改用 ASP.NET MVC，开发时间会更长，每件事都需要使用 html helper，没有 web 控件，还有很多问题，不断打开 Firefox Tab with ASP.NET forum 问 How-To 问题。

2.  我们已经看到很多人说MVC提供了更好的项目管理，但是如果是一个复杂的网站，我可以想象一个页面有数百个<%=%>标签，并且保持打开控制器查看返回什么，并保持打开模型看逻辑。

我可以说，MVC 还不错，但 Webform 足以胜任这项工作。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-06T18:18:34.747

转变为新技术或“思维方式”需要数周时间。

使用 MVC，您必须摆脱旧的 ASP.NET Forms 思维方式“复杂的 Web 应用程序”，即“我们有多少页面，超过 300 个页面！那将是巨大的！”。您更改整个应用程序的视图。您从“接下来需要创建什么页面”的旧思维转变为“我们接下来需要实现什么功能”的 MVC 思维方式。

例如，我自己控制了一个项目，该项目仅在“web”项目中就有 3300 多个文件（加上 11 个支持程序集）。我正在构建的一件事是 MVC 如何将物理文件的数量大幅减少到大约 310 个左右。如何？因为我正在远离“这是一页。这是另一页”。以“这是我要实现的功能”的思维方式。

通过将页面视为您尝试完成的功能，您开始将该页面的各个部分抽象为通用功能。

MVC 可以通过这种思维方式极大地扩展，因为现在您有了一个您想要的外观模板，您只需要实现另一个“功能”来更改您想要呈现的视图 (html) 的外观。没有第 2 页，没有其他控件等。

现在，至于你提到的“没有网络控制”：再次，这需要一种不同的思维方式。有用于基本渲染和编码的 HtmlHelper。我对一个名为 MyProjectHelper 的抽象类使用相同的概念，它将我的“函数”呈现到页面上（函数 = 代码）。

例如，我过去总是为我的 DisplayNames 创建一个服务器控件。这让我可以控制 DisplayName 的显示方式，尤其是在切换到 Facebook Connect 和其他东西时。使用 MVC，我不再使用“服务器控件”，而是使用 ViewModel 上的“函数”来呈现该文本：CollegeProjectViewModel.RenderDisplayName()。由于这只是 UI 层的一部分，因此它将根据需要使用我希望的任何选项来渲染 Anchor（当然，摘要由接受“基本”文本渲染的 CollegeProjectViewModel 继承）。

MVC 的强大之处在于不再需要“网页”，而是需要“功能”或您想要对站点执行的操作的方法。通过改变这种思维方式，您真的可以使用在控制器上创建的尽可能多的方法进行扩展。它确实在大规模 IMO 上加快了速度。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T16:27:20.597

我在我上一家公司的一个 MVC 项目上工作了 6 个月（我们使用的是 CTP 构建，最终是 beta 构建）。最初，它既有趣又令人兴奋，感觉就像我们真的在做某事。像许多 .NET 开发人员一样，我们厌倦了 Web 窗体的泄漏抽象。

然而，随着时间的推移，我们开始质疑我们的决定。UI 开发占用了我们 80% 以上的时间。我们必须从头开始构建我们所有的 UI。有一半的时间感觉就像我们在重新发明轮子。我们的大部分 Rich UI 都来自 JQuery 和 Custom HTML Helpers 的结合，设计起来很有趣，但也很耗时。

我们还遇到了其他问题，例如需要将类似 DTO 的对象从我们的业务对象（从 NHibernate 支持的存储库中获取）映射到视图。我们的控制器，显然应该是轻量级且易于维护的，现在变得越来越混乱，我们一直在争论实现控制器继承的正确方法。

回想起来，我觉得我们所面临的所有问题都是由于我们缺乏对 MVC 的经验和理解。我们都喜欢 MVC 的想法，但只是没有实践经验和专业知识，无法在我认为非常复杂的应用程序中有效地使用它（想象一下类似于销售团队的东西，但有更好的报告） .

- 更新 -

上个月一直在使用它来处理一个非常小的项目，到目前为止一切进展顺利。它比我一年前使用的 CTP 版本更容易使用。我目前正在为复杂的“网格视图”寻找自己的个人解决方案，然后我可能会完全切换到大多数项目。但是，动态数据一直在正确对待我，我在两者之间有点纠结。

-- 2011 年更新 --

在过去一年左右的几个不同规模的 MVC 项目之后，我已经成为了一个皈依者。我遇到的所有实际问题大多已在最新版本（2 和 3）中得到解决，特别是那些处理模型验证和视图绑定的问题。

不过有一件事：创建高度交互的数据网格仍然有点乏味，这在 WebForm 中仍然稍微容易一些。但是，有 3rd 方产品提供有用的 MVC 扩展，这使得这不再是一个问题。就个人而言，我使用 Telerik 的产品达到了很好的目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T17:53:51.547

使用 MVC 的许多好处之一是删除了视图状态。

如果您的 Webform 应用程序真的很大，并且使用了许多服务器端项，这些项会使您的视图状态变得臃肿，那么 MVC 实际上可能会帮助您，即使它可能需要更长的开发时间。

另一方面，请注意 .NET v4.0，它允许您在控件级别控制视图状态，而不仅仅是在页面级别。这将使 MVC 整体上更不受欢迎。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T18:10:28.587

我认为你是对的，你的团队需要时间来适应新技术，而这在短期内需要额外的时间。

我不会开始在生产中使用 MVC，直到一些不错的书出版并且团队有机会阅读这些书并使用该技术。否则，您的开发团队似乎会花费大量时间观看截屏视频和寻找文档。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T15:20:24.867

我来自 webform 开发（就像你一样），从 1.0 到 3.5。当我发现 MVC (CTP) 时，我花了大约 6 个月的时间让我的同行（和我的老板）相信这是正确的选择。

我的论点的一些亮点：

1.  完全控制 HTML
2.  TRUE AJAX（而不是更新面板）
3.  使用 jQuery 的可能性成倍增加
4.  没有视图状态
5.  关注点分离
6.  .. and .. (drum roll) ... 更快的发展

虽然#6 有点主观，但我确实尝试通过构建原型来证明这一点。对于我的原型，我使用 webform 和 asp.net mvc 构建了一个简单的仪表板 Web 应用程序。我向我的同事和我的老板展示了结果，以及构建和维护每一个的复杂性。最后，我们将主要方法论从 webform 迁移到 MVC。

确实需要一段时间才能“忘记”一些网络表单范式。但是一旦你掌握了它，MVC 就更容易上手，并且你可以使用它来运行。

在 webform 中，是的，它很强大，但通常在大型项目中，我们花费大量时间尝试“自定义”或“强制”服务器控件以按照我们想要的方式运行和执行 - 以及系统的复杂性上升，这种定制的复杂性也呈指数级上升。

TRUE AJAX 在 webform 中也相当困难。UpdatePanel 有其作用，但嵌套更新面板也有其自身的问题。

对于我和我的同龄人来说，这归结为控制我们的 HTML/代码/AJAX 的能力——而不是由框架自动生成 90%，但我们必须花费大量时间和精力来获得剩下的 10%。

ASP.NET MVC 与 jQuery 以及您喜欢的 biz 层框架或 ORM 相结合，非常强大。到目前为止，我们已经发布了 3 个使用 ASP.NET MVC 的生产版本，它们都表现良好 - 看看 stackoverflow.com（它使用 MVC 顺便说一句）。

# .net - 生成 .NET 后台工作程序

> ID：722518
> 
> 赞同：3
> 
> 时间：2009-04-06T17:53:49.580
> 
> 标签：.net, winforms, multithreading, reflection, backgroundworker

我们正在开发一个 Windows 应用程序，该应用程序必须定期启动可能需要一些时间的操作。我们已经进入了让这些操作在 BackgroundWorker 上运行的模式，并为每个操作编写一个快速 WinForm，在其中您将必要的参数传递给表单，表单连接 BackgroundWorker 并进行函数调用，并且表单显示输出（进度条移动，文本填充更新等）。

现在很明显，这种形式非常千篇一律。表单副本之间真正不同的唯一部分是在哪个对象上调用哪个方法。所以我们想做的是让它成为通用的，这样我们就可以采用形式，传入一个对象（或 null 用于静态调用？），一个函数名和一个参数数组，然后让它“运行”从那里。我们已经能够通过反射做到这一点。在这种情况下，我们不喜欢反射的地方是缺乏强类型；诸如拼写错误的方法调用之类的事情在运行时被捕获，而不是编译时。现在有什么可用的东西可以使它更加优雅和健壮吗？我听说有人在谈论诸如代表和表达式树之类的东西；但我不确定前者是否适用，但我对后者仍然有些不知所措。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-06T17:55:36.410

制作一个通用表单并将其传递给指向它应该在 BackgroundWorker 上运行的方法的委托，这将是一个明智的解决方案。

您可以让 Form 构造函数将通用委托（Action 可能是一个好主意）作为参数，并在构造函数中传递与 Action 的签名匹配的 lambda 表达式）。然后，对于每个动作，您只需要指定适当的 lambda 表达式。

请记住，lambda 表达式可以捕获局部变量，因此您将能够调用您之前执行的任何逻辑并传递相同的参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T18:01:29.360

您可能还想查看 Lambda 函数。我在使用泛型时专门使用它们。否则，代表可能会正常工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T18:22:16.047

您可以做的一件事是创建几种不同的方法（一种用于没有参数的方法，一种用于具有一个参数的方法等），如下所示：

```
public static void DisplayForm(Action action) {
    DisplayFormUsingInvoke(action);
}

public static void DisplayForm<T>(Action<T> action, T param) {
    DisplayFormUsingInvoke(action, param);
}

public static void DisplayForm<T,U>(Action<T,U> action, T param1, U param2) {
    DisplayFormUsingInvoke(action, param1, param2);
}

... 
```

然后，您可以拥有一个实际完成工作的私有方法，类似于您当前的方法，但不暴露给客户端代码：

```
private static void DisplayFormUsingInvoke(Delegate d, params object[] parms) {
    // Edit this code to run it on the background thread, report progress, etc.
    d.DynamicInvoke(parms);
} 
```

然后客户端代码将调用公共方法之一，该方法将强制要求提供正确数量和类型的参数。

# sql-server-2008 - TransactionScope 和隔离级别

> ID：722528
> 
> 赞同：14
> 
> 时间：2009-04-06T17:58:18.587
> 
> 标签：sql-server-2008, ado.net, transactions, transactionscope

我们在使用 TransactionScope 时遇到问题。TransactionScope 为我们提供了很好的灵活性，可以在我们的数据访问层中使用事务。通过这种方式，我们可以使用隐式或显式事务。再次 ADO.NET 事务有一些性能提升，但此时这并不是真正的问题。但是我们有锁定问题。在下面的示例代码中，虽然隔离级别设置为 ReadCommitted，但无法从其他客户端对表 testTable 进行 Select SQL 语句，直到主事务（在 Main 方法中）将被提交，因为整个表都有锁。我们还尝试在所有方法中仅使用一个连接，但行为相同。我们的 DBMS 是 SQL Server 2008。有什么我们不明白的地方吗？

问候安东卡尔奇克

请参阅此示例代码：

```
class Program
{
    public class DAL
    {
        private const string _connectionString = @"Data Source=localhost\fsdf;Initial Catalog=fasdfsa;Integrated Security=SSPI;";

        private const string inserttStr = @"INSERT INTO dbo.testTable (test) VALUES(@test);";

        /// <summary>
        /// Execute command on DBMS.
        /// </summary>
        /// <param name="command">Command to execute.</param>
        private void ExecuteNonQuery(IDbCommand command)
        {
            if (command == null)
                throw new ArgumentNullException("Parameter 'command' can't be null!");

            using (IDbConnection connection = new SqlConnection(_connectionString))
            {
                command.Connection = connection;
                connection.Open();
                command.ExecuteNonQuery();
            }
        }

        public void FirstMethod()
        {
            IDbCommand command = new SqlCommand(inserttStr);
            command.Parameters.Add(new SqlParameter("@test", "Hello1"));

            using (TransactionScope sc = new TransactionScope(TransactionScopeOption.Required))
            {
                ExecuteNonQuery(command);
                sc.Complete();
            }
        }

        public void SecondMethod()
        {
            IDbCommand command = new SqlCommand(inserttStr);
            command.Parameters.Add(new SqlParameter("@test", "Hello2"));

            using (TransactionScope sc = new TransactionScope(TransactionScopeOption.Required))
            {
                ExecuteNonQuery(command);
                sc.Complete();
            }
        }
    }

    static void Main(string[] args)
    {

        DAL dal = new DAL();
        TransactionOptions tso = new TransactionOptions();
        tso.IsolationLevel = System.Transactions.IsolationLevel.ReadCommitted;

        using (TransactionScope sc = new TransactionScope(TransactionScopeOption.Required,tso))
        {
            dal.FirstMethod();
            dal.SecondMethod();
            sc.Complete();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-06T19:32:11.777

我认为您的问题与 .NET TransactionScope 概念没有任何关系。相反，听起来您在描述 SQL Server 事务的预期行为。此外，更改隔离级别只会影响“数据读取”而不是“数据写入”。从 SQL Server BOL：

> “选择事务隔离级别不会影响为保护数据修改而获取的锁。事务总是在它修改的任何数据上获得排他锁，并持有该锁直到事务完成，无论为该事务设置的隔离级别如何。对于读操作，事务隔离级别主要定义了免受其他事务修改影响的保护级别。”

这意味着您可以通过更改发出语句*的客户端的隔离级别来防止阻塞行为。*`SELECT`隔离级别（`READ COMMITED`默认）不会阻止阻塞。为防止阻塞客户端，您将使用`READ UNCOMMITTED`隔离级别，但您必须考虑可能会检索到已由打开的事务更新/插入的记录（即，如果事务回滚，它们可能会消失）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-18T15:12:57.630

谈论交易的好问题。

您的主要方法是保持事务提交。即使您在其他方法中提交，您仍然会在该行上锁定。在您提交锁定事务之前，您将无法使用 READ COMMITTED 读取该表，这是预期的。

这是第一个方法返回后：

![第一个方法返回](https://i.stack.imgur.com/GPfAz.png)

第二种方法返回后，您将为表添加一个锁。

![第二个方法返回](https://i.stack.imgur.com/9ikdP.png)

如果我们从带有 SPID(55) 的查询窗口执行 select 语句，您将看到等待状态。

![选择正在等待](https://i.stack.imgur.com/L4NzT.png)

在您的 main 方法 trans 提交后，您将获得 select 语句结果，它只会显示我们的 select 语句查询页面中的**共享**锁。

![范围提交和选择返回](https://i.stack.imgur.com/voZma.png)

**X**表示排他锁，**IX**意向锁。[您可以从我的博客文章中了解更多关于交易的信息](http://omerc.blogspot.com/2010/04/transaction-and-locks-in-ms-sql-2008.html)。

如果您想立即阅读，可以使用 nolock 提示。如果您想在第一个方法提交后阅读，您可以删除该外部范围。

# silverlight - 如何从 silverlight 文本框控件中删除焦点矩形

> ID：722530
> 
> 赞同：4
> 
> 时间：2009-04-06T17:58:23.283
> 
> 标签：silverlight, templates, styles

有人对如何从 silverlight 文本框中删除焦点矩形有任何想法吗？（我说的是当您单击 texblock 开始输入时出现的蓝色矩形）

我正在查看文本框的默认样式和模板，但似乎无法确定要调整哪个元素。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T20:30:51.543

在模板中，您会发现一个名为`FocusVisualElement`. 在基础和未聚焦视觉状态下，它的不透明度为 0%。在聚焦视觉状态下，它具有 100% 的不透明度。如果您不想要任何指示焦点的边框，您可以简单地删除 FocusVisualElement。

当 MouseOverBorder 仍然出现时，这可能看起来很奇怪，因此您可能也想从模板中删除它，但是首先将它持有的 ContentElement 移动到父 Grid。

或者，您可以将所有州的这些边界的不透明度设置为 0%。

# jquery - 慢速计算机上的 jQuery

> ID：722532
> 
> 赞同：1
> 
> 时间：2009-04-06T17:59:51.407
> 
> 标签：jquery

我正在使用 jQuery 创建一个在线游戏。由于速度较慢的计算机有很多淡入淡出效果，我做了一个设置`jQuery.fx.off = true;`这导致此代码出现问题的选项：

```
$('<div>'+msg+'</div>').fadeOut(5000,function({$(this).remove()}).appendTo('#msg'); 
```

此代码在#msg div 中显示消息，然后在 5 秒后消息消失。可以有很多消息，并且可以随时添加。当`jQuery.fx.off = true;`由于fadeOut 立即完成而不会出现消息时:(我需要的是`$('#id').delay(5000).remove()`当fx.off 为真时。

我在 jQuery 的帮助中寻找它，但没有找到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T18:07:49.093

对于您的问题，这可能是也可能不是一个可接受的解决方案，但您可以创建一个名为 MaybeFadeOut 的新 JQuery 函数或其他东西。

```
jQuery.fn.maybeFadeOut = function (time, fun) {
  if (slowComputer) {
    setTimeout(function () {
      $(this).remove();
      if (fun) fun(); // Optionally run the callback function.
    }, time);
    return $(this);
  } else {
    return $(this).fadeOut(5000, function () { $(this).remove; });
  } 
}; 
```

# java - 如何修复 OC4J 中的 Resource not Found 错误？

> ID：722534
> 
> 赞同：1
> 
> 时间：2009-04-06T18:01:17.877
> 
> 标签：java, jakarta-ee, oc4j

我正在尝试在 OC4J 上部署一个 Web 应用程序，尽管我已按照信中的说明进行操作，并且部署过程顺利进行，但我一直收到 500 错误（如下）。我是 OC4J 的新手，所以我会很感激一些关于查看和修改（XML/settings/etc）的提示来解决这个问题。这是实际的错误，以防万一：

```
500 Internal Server Error

java.lang.IllegalArgumentException: Resource /login.do not found
    at com.evermind[Oracle Containers for J2EE 10g (10.1.3.1.0) ].server.http.EvermindPageContext.forward(EvermindPageContext.java:316)
    at _index._jspService(_index.java:46)
    [SRC:/index.jsp:14]
    at com.orionserver[Oracle Containers for J2EE 10g (10.1.3.1.0) ].http.OrionHttpJspPage.service(OrionHttpJspPage.java:59)
    at oracle.jsp.runtimev2.JspPageTable.service(JspPageTable.java:453)
    at oracle.jsp.runtimev2.JspServlet.internalService(JspServlet.java:591)
    at oracle.jsp.runtimev2.JspServlet.service(JspServlet.java:515)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:856)
    at com.evermind[Oracle Containers for J2EE 10g (10.1.3.1.0) ].server.http.ServletRequestDispatcher.invoke(ServletRequestDispatcher.java:711)
    at com.evermind[Oracle Containers for J2EE 10g (10.1.3.1.0) ].server.http.ServletRequestDispatcher.forwardInternal(ServletRequestDispatcher.java:368)
    at com.evermind[Oracle Containers for J2EE 10g (10.1.3.1.0) ].server.http.HttpRequestHandler.doProcessRequest(HttpRequestHandler.java:866)
    at com.evermind[Oracle Containers for J2EE 10g (10.1.3.1.0) ].server.http.HttpRequestHandler.processRequest(HttpRequestHandler.java:448)
    at com.evermind[Oracle Containers for J2EE 10g (10.1.3.1.0) ].server.http.HttpRequestHandler.serveOneRequest(HttpRequestHandler.java:216)
    at com.evermind[Oracle Containers for J2EE 10g (10.1.3.1.0) ].server.http.HttpRequestHandler.run(HttpRequestHandler.java:117)
    at com.evermind[Oracle Containers for J2EE 10g (10.1.3.1.0) ].server.http.HttpRequestHandler.run(HttpRequestHandler.java:110)
    at oracle.oc4j.network.ServerSocketReadHandler$SafeRunnable.run(ServerSocketReadHandler.java:260)
    at com.evermind[Oracle Containers for J2EE 10g (10.1.3.1.0) ].util.ReleasableResourcePooledExecutor$MyWorker.run(ReleasableResourcePooledExecutor.java:303)
    at java.lang.Thread.run(Thread.java:595) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-07T11:42:40.943

看起来您的 index.jsp 会重定向到您的 login.do Struts Action；但是您的应用程序未配置为将 .do url 重定向到 Struts。Struts Action Servlet 是否配置为负责所有 *.do url 映射？请在 web.xml 配置文件 (WEB-INF\web.xml) 中查找与此类似的条目：

```
<servlet>
    <servlet-name>action</servlet-name>
    <servlet-class>
        org.apache.struts.action.ActionServlet
    </servlet-class>
    <init-param>
        <param-name>config</param-name>
        <param-value>
         /WEB-INF/struts-config.xml
        </param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet> 
```

以及到 servlet 的映射，如下所示：

```
<servlet-mapping>
    <servlet-name>action</servlet-name>
    <url-pattern>/*.do</url-pattern>
</servlet-mapping> 
```

# factor-lang - 使用 Factor 构建 Web 应用程序

> ID：722543
> 
> 赞同：4
> 
> 时间：2009-04-06T18:04:47.713
> 
> 标签：factor-lang, stack-based

有人用[Factor](http://factorcode.org/)构建了一个 Web 应用程序吗？在此过程中，您遇到了哪些绊脚石或问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T09:16:04.770

试试[这个](http://factorlang-fornovices.blogspot.com/2007/03/creating-simple-web-application-in.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-11T05:18:49.120

我写了一个[教程](http://re-factor.blogspot.com/2010/08/hello-web.html)，展示了 Factor 的 web 开发库的一些特性。

还有一个[博客文章](https://github.com/malu/factor-blog-gitutorial)，它迭代地构建了一个博客 Web 应用程序。

Factor[源代码](http://github.com/slavapestov/factor)在`extra/webapps`.

concatenative.org wiki 有一个[页面](http://concatenative.org/wiki/view/Factor/Furnace)，其中包含有关 Furnace 的更多信息。

# php - 按 f5 时避免在 php 中重新提交表单

> ID：722547
> 
> 赞同：14
> 
> 时间：2009-04-06T18:06:54.667
> 
> 标签：php, form-submit

我的网站上有以下代码（使用 php 和 smarty）来尝试避免在按 f5 时重新提交表单：

```
if ($this->bln_added == false) {
    if (isset($_POST['submit'])) {
        $this->obj_site->obj_smarty->assign('title', $_POST['tas_heading']);
        $this->obj_site->obj_smarty->assign('desc', $_POST['tas_description']);
    }
} else {
    $this->obj_site->obj_smarty->assign('title', '');
    $this->obj_site->obj_smarty->assign('desc', '');
    unset($_POST);
} 
```

bln_added 默认为 false，但一旦表单提交成功后变为 true。smarty 变量 title 和 desc 在模板中用于保留表单内容，以防出现用户错误并且他们需要更改输入的内容。

如果表单提交成功，它设置bln_added = true，所以第二段代码不仅要清除表单字段，还要清空$_POST。但是，如果我按 f5，帖子数据仍然存在。

有任何想法吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-04-06T18:12:49.190

你的方法理论上可行，但有一种更简单的方法。

成功提交表单后，执行重定向。去哪里并不重要，但它会清除 $_POST。

```
header('Location: http://www.example.com/form.php'); 
```

在您的情况下，听起来您想重定向到您已经在的页面。如果要显示确认消息，请将 $_GET 参数附加到 URL。

希望这可以帮助，

汤姆

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-06T18:45:33.933

解决方案是一种通常称为[Post/Redirect/Get的模式](http://en.wikipedia.org/wiki/Post/Redirect/Get)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-06T18:12:25.277

处理表单的最佳方式是使用自我提交和重定向。像这样的东西：

```
if (isset($_POST)) {
  // Perform your validation and whatever it is you wanted to do
  // Perform your redirect
}

// If we get here they didn't submit the form - display it to them. 
```

使用[CodeIgniter 框架](http://www.codeigniter.com/ "代码点火器")：

```
function index() {
  $this->load->library('validation');
  // Your validation rules

  if ($this->form_validation->run()) {
    // Perform your database changes via your model
    redirect('');
    return;
  }
  // The form didn't validate (or the user hasn't submitted)
  $this->load->view('yourview');
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-17T05:32:32.530

您可以将表单提交重写为 AJAX 方式。如果您需要显示 HTML 内容，请以 JSON 格式返回并使用 JavaScript（例如 jQuery）插入。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-19T10:24:25.417

我通过以下方式解决了这个问题（在 php 中）：

1.  在表单中添加一个不基于 time() 的唯一标识符 (id+counter) (!!!)

2.  发布到一个单独的文件 (postform.php)，该文件检查具有该唯一标识符的会话

3.  a) 如果未找到具有唯一标识符的会话：发布到数据库并使用唯一标识符填充会话

    b) 如果找到具有唯一标识符的会话：什么都不做

4.  在 3a/3b 重定向到带有标题的结果页面之后（'位置： http: [//mydomain.com/mypage](http://mydomain.com/mypage) '）

结果是：
刷新/后退按钮没有重新提交操作，只有双击后退按钮重新提交警告（但没有重新提交操作）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-05-23T13:28:43.723

成功发布操作后使用标题位置

```
header('Location: '.$_SERVER['HTTP_REFERER']); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-09-13T03:09:28.130

如果我在代码末尾使用 header() 或 exit() 对我有用，例如，在我保存一些数据之后。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-06-23T12:30:11.153

我发现最好的方法是使用 javascript 和 css。常见的php重定向方法 header('Location: [http://www.yourdomain.com/url](http://www.yourdomain.com/url) ); 会起作用，但它会在不同的框架和 cms（如 wordpress、drupal 等）中导致警告“警告：无法修改标头信息 - 标头已发送”。所以我的建议是遵循以下代码

```
echo '<style>body{display:none;}</style>'; 
echo '<script>window.location.href = "http://www.siteurl.com/mysuccesspage";</script>'; 
exit; 
```

样式标签很重要，否则用户可能会觉得页面加载了两次。如果我们使用 style 标签 body display none 然后刷新页面，那么用户体验将和 php header('Location: ....); 一样。

我希望这个能帮上忙 ：）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-06-13T11:30:46.497

您正在寻找的答案是这个神奇的一班轮： `header('Location: '.$_SERVER['HTTP_REFERER']);`

例如

```
if(isset['submit']){
    //insert database
    header('Location: '.$_SERVER['HTTP_REFERER']);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-11-27T16:44:19.750

发布后的标题重定向是必要的，但不够。

在PHP端成功提交表单后，执行重定向。例如。header('位置：[http](http://www.example.com/form.php) ://www.example.com/form.php ');

但这还不够。一些用户按两次链接（双击）。需要在第一次单击后禁用提交按钮的 JavaScript。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-02-02T21:48:39.107

尝试我自己的，也许它不是最好的解决方案（快速完成），但我已经测试过它并且它有效。在 Chrome 上测试。[点击查看外观](http://rybka.net.pl/praca/testowe/refresh.php)BR

```
 <?php 
session_start(); // Start session
?>
<html>
 <head>
  <title>
    Test
  </title>
 </head>
 <body>
   <form name="test" action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">
   <input type="text" name="name"><br>
   <input type="submit" name="submit" value="Submit Form"><br>
  </form>

  <?php

  if(isset($_POST['submit']))
    {
     $_SESSION['name'] = $_POST['name']; //  Assign $_POST value to $_SESSION variable
      header('Location: refresh.php'); // Address of this - reloaded page - in this case similar to PHP_SELF
    } else session_destroy(); // kill session, depends on what you want to do / maybe unset() function will be enough

  if(isset($_SESSION['name']))
    {
     $name = $_SESSION['name'];

     echo "User Has submitted the form and entered this name : <b> $name </b>";
     echo "<br>You can use the following form again to enter a new name."; 
    }
  ?>
 </body>
</html> 
```

# c# - NHibernate：如何将多个父母的共同类型的孩子映射到一个表中？

> ID：722550
> 
> 赞同：2
> 
> 时间：2009-04-06T18:07:38.533
> 
> 标签：c#, nhibernate

有什么方法可以让 NHibernate 让我将多个 ChildObjects 存储在 ChildObjectTable 中，但将它们引用回不同的 ParentObjects？还是我必须为每个 ParentObject 类型创建一个单独的 ChildObject 类/表？

我将其归结为以下内容，我正在尝试映射这些对象：

```
public class ParentObjectA
{
    public virtual Int64 Id { get; private set; }

    public virtual IDictionary<int, ChildObject> Children { get; private set; }
}

public class ParentObjectB
{
    public virtual Int64 Id { get; private set; }

    public virtual IDictionary<int, ChildObject> Children { get; private set; }
}

public class ChildObject
{
    public virtual Int64 Id { get; private set; }   
} 
```

成如下表结构：

```
ParentObjectTableA
  Id bigint

ParentObjectTableB
  Id bigint

ChildObjectTable
  Id bigint
  ParentId bigint
  ParentQualifier varchar(50) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T18:13:46.303

也许您可以为您的父类创建一个抽象基类？这样，给定的子对象可以引用其父对象的抽象类型。

例如，您可以有一个名为 ParentBase 的类，它是 ParentClassA 和 ParentClassB 的扩展。您的子对象将引用回 ParentBase。

这一切都可以通过 NHibernate 的各种[继承模型](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html_single/#persistent-classes-inheritance)来实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T19:23:03.203

以下地图似乎从对象的角度工作。我并不太热衷于使用交叉表的想法，但我认为这可能比尝试处理继承更干净。我也将看一下该选项，并在此处发布我的发现以完成。欢迎评论。

ParentObjectA的映射

```
<map name="Children" table="ParentAxChildObject">
    <key column="ParentId" />
    <index column="ChildObjectNumber" type="Int32" />
    <many-to-many class="ChildObject" />
</map> 
```

ParentObjectB的映射

```
<map name="Children" table="ParentBxChildObject">
    <key column="ParentId" />
    <index column="ChildObjectNumber" type="Int32" />
    <many-to-many class="ChildObject" />
</map> 
```

这些生成以下交叉表：

```
ParentAxChildObject
    [ParentId] [bigint] NOT NULL,
    [elt] [bigint] NOT NULL,
    [ChildObjectNumber] [int] NOT NULL,

ParentBxChildObject
    [ParentId] [bigint] NOT NULL,
    [elt] [bigint] NOT NULL,
    [ChildObjectNumber] [int] NOT NULL, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T19:36:07.023

我已经让继承版本与作为基础的接口一起工作，并希望将其发布在这里以完成。

```
public interface IParent
{
    IList<Child> children { get; set; }
    void AddChild(Child child);
    Int64 Id { get; set; }
    Child GetChild();
}

public class Parent : IParent
{
    public virtual IList<Child> children { get; set; }

    public Parent()
    {
        children = new List<Child>();
    }

    public virtual void AddChild(Child child)
    {
        children.Add( new Child() );
    }

    public virtual Int64 Id { get; set; }

    public virtual Child GetChild()
    {
        return children.First();
    }
}

public class Parent2 : IParent
{
    public virtual IList<Child> children { get; set; }

    public Parent2()
    {
        children = new List<Child>();
    }

    public virtual void AddChild(Child child)
    {
        children.Add(new Child());
    }

    public virtual Int64 Id { get; set; }

    public virtual Child GetChild()
    {
        return children.First();
    }
}

public class Child
{
    public virtual Int64 Id { get; private set; }
} 
```

这些映射与以下内容：

```
<class name="IParent" table="IParents">
    <id name="Id" unsaved-value="0">
        <column name="Id" sql-type="bigint" />
        <generator class="hilo" />
    </id>

    <bag name="children" cascade="all">
        <key column="ParentId" />
        <one-to-many class="Child" />
    </bag>

    <joined-subclass name="Parent" table="Parents" >
        <key column="ParentId" />
    </joined-subclass>

    <joined-subclass name="Parent2" table="Parents2" >
        <key column="ParentId" />
    </joined-subclass>
</class>

<class name="Child" table="Children">
    <id name="Id" unsaved-value="0">
        <column name="Id" sql-type="bigint" />
        <generator class="hilo" />
    </id>
</class> 
```

这又会创建以下表格：

```
IParents
    Id bigint

Parents
    ParentId bigint

Parents2
    ParentId bigint

Children
    Id bigint
    ParentId bigint 
```

这里要注意的大“问题”是 Child 对象仅直接引用 IParents 表中的 Id。根据您实际使用的派生对象类型，Parent 或 Parent2 对象的每个实例都绑定到 IParent 与 Parent 或 Parents2 之间的联合调用。

我还没有使用具有多个接口的类对此进行测试，但我也需要对其进行测试。

我不喜欢继承模型的一点是我需要一个通用的接口/基类。我不知道为什么我反对这种临时性的做法，它看起来很笨拙。

我想我现在要使用交叉表方法，如果需要的话，稍后再重新讨论。

# c++ - 在 XP 中取消曝光快照（卷影复制）

> ID：722555
> 
> 赞同：7
> 
> 时间：2009-04-06T18:08:43.663
> 
> 标签：c++, windows, volume-shadow-service

Microsoft 提供了一种使用其 vshadow 程序将只读快照挂载为卷的方法。但是，它没有提供卸载快照的方法（我想知道如果我删除了快照会发生什么？）。通过 MSDN 上的文档，我找到了[UnexposeSnapshot Method](http://msdn.microsoft.com/en-us/library/aa382233(VS.85).aspx)，并添加了在 vshadow 中使用它的能力。但是，它说它只支持 Vista 和 Server 2008 机器。有没有办法解决？vshadow 的 XP 配置无法编译。如果微软在 XP 和 server 2003 中编写了一种挂载卷影副本的方法，但没有提供卸载它们的方法，那将是非常奇怪的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T15:05:51.897

使用 Windows 的内置安装管理实用程序[mountvol.exe](http://technet.microsoft.com/en-us/library/cc976820.aspx)。

在 API 级别，您应该能够使用[DeleteVolumeMountPoint](http://msdn.microsoft.com/en-us/library/aa363927(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T23:26:41.190

Windows Vista 平台 sdk 中有一个命令行工具，可用于创建对快照进行操作的批处理文件。我不知道你是不是指那个，但它确实是这样工作的：你调用它，它会创建快照。然后它将启动您指定的另一个进程。然后该进程（例如另一个批处理文件或相同的批处理文件）将运行。结束时，命令行工具将删除并删除快照。

# asp.net-mvc - 如何识别关于 asp.net-mvc 的文章或演示已过时？

> ID：722559
> 
> 赞同：2
> 
> 时间：2009-04-06T18:09:54.363
> 
> 标签：asp.net-mvc

我花了很多时间研究 asp.net-mvc，这让我很沮丧。似乎很多文章的信息不再适用于当前版本的 asp.net-mvc，有时需要一段时间才能认识到我正在阅读的内容不再相关。有谁知道任何可以帮助我识别我可能正在阅读的特定文章不再有用的资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T18:16:04.393

我自己也遇到过这个问题。我通常会查看发布日期，如果它是在候选发布版本开始出现之前发布的（2009 年 1 月下旬），我会谨慎对待它。我有时甚至会使用高级 Google 搜索来搜索 2009 年 1 月之后发表的文章。

另一个不错的选择是查看要在书中发布的信息，因为它将（或应该）基于 RTM 版本。[您可以在此处](http://stephenwalther.com/blog/category/11.aspx)查看 Stephen Walther 的部分章节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T00:24:18.767

这是以搜索为导向的研究策略的更严重的问题之一——您没有获得必要的上下文来确定您发现的内容是否相关。

你很幸运，你正在研究的是 MVC。想象一下寻找一个已经存在多年的主题的信息。过去在 MSDN 上搜索“Web 服务安全”（无引号）会在第一页找到大部分文章 - 关于 WSE（Web 服务扩展，被 Windows 通信框架取代的过时代码）。我与几个使用 WSE 作为他们的第一个安全 Web 服务的人进行了通信，因为他们通过搜索 MSDN 找到了它。

# hibernate - 使用 Hibernate Criteria API 查询多对多关系

> ID：722560
> 
> 赞同：2
> 
> 时间：2009-04-06T18:09:58.153
> 
> 标签：hibernate, activerecord, nhibernate

我有以下多对多关系：`File 1 --- * File_Insurer * --- 1 Insurer`. 我正在尝试使用 Criteria API（Active Record）查询此关系，以获取满足所有指定 Insurers 的文件（获取`Insurer.Id == 2`AND的所有文件`Insurer.Id == 3`）。

***映射文件（部分）***：

## 文件

```
[HasAndBelongsToMany(typeof(Insurer),
Table = "Insurer_File", ColumnKey = "IdFile", ColumnRef = "IdInsurer")]
public virtual IList<Insurer> Insurers
{
get { return insurers; }
set { insurers = value; }
} 
```

## 保险公司

```
[HasAndBelongsToMany(typeof(File),
Table = "Insurer_File", ColumnKey = "IdInsurer", ColumnRef = "IdFile")]
public virtual IList<File> Files
{
get { return files; }
set { files = value; }
} 
```

**我尝试了很多选择**：

```
DetachedCriteria dc = DetachedCriteria.For<File>();
dc.SetResultTransformer(new DistinctRootEntityResultTransformer());
dc.CreateCriteria("Insurers").Add(Expression.Eq("Id", long.Parse("2")));
dc.CreateCriteria("Insurers").Add(Expression.Eq("Id", long.Parse("3")));
List<File> searchResults = File.FindAll(dc).ToList<File>(); 
```

这给了我一个错误：`duplicate association path: Insurers`。

**下一个选项**：

```
DetachedCriteria dc = DetachedCriteria.For<File>();
dc.SetResultTransformer(new DistinctRootEntityResultTransformer());
dc.CreateCriteria("Insurers").Add(Expression.And(Expression.Eq("Id", long.Parse("3")), Expression.Eq("Id", long.Parse("2"))));
List<File> searchResults = File.FindAll(dc).ToList<File>(); 
```

结果列表为空（但不应为空）。

**下一个带有别名的选项**：

```
DetachedCriteria dc = DetachedCriteria.For<File>();
dc.SetResultTransformer(new DistinctRootEntityResultTransformer());
dc.CreateAlias("Insurers", "i").Add(Expression.Eq("i.Id", long.Parse("2"))).Add(Expression.Eq("i.Id", long.Parse("3")));
List<File> searchResults = File.FindAll(dc).ToList<File>(); 
```

结果列表又是空的——奇怪。

**下次尝试**：

```
DetachedCriteria dc = DetachedCriteria.For<File>();
dc.SetResultTransformer(new DistinctRootEntityResultTransformer());
List<long> insurerIds = new List<long>();
insurerIds.Add(2);
insurerIds.Add(3);
dc.CreateCriteria("Insurers").Add(Expression.In("Id", insurerIds));
List<File> searchResults = File.FindAll(dc).ToList<File>(); 
```

这以某种方式起作用，但结果集包含所有可能的选项（OR） - 它不是完全匹配的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-18T10:07:51.270

这已经得到了[回答](https://stackoverflow.com/questions/264339/querying-manytomany-relationship-with-hibernate-criteria)- 请参阅下面的我的看法。hibernate 站点似乎已关闭，但请查看Hibernate 用户指南的第 11 章[HQL的副本。](http://www.kkaok.pe.kr/doc/hibernate/reference/html/queryhql.html)

```
public List<Files> findFilesForInsurers(Insurer... insurers) {
    StringBuilder hql = new StringBuilder();
    hql.append("select f from Files ff where 1=1 ");
    for (int i = 0; i < insurers.length; i++) {
        hql.append(String.format(" and :i%d in elements(ff.insurers)", i));
    }
    Query query = getSession().createQuery(hql.toString());
    for (int i = 0; i < insurers.length; i++) {
        query.setParameter("i" + i, insurers[i]);
    }
    return query.list();
} 
```

像这样给出 HQL：

```
select f from Files ff where 1=1
    and :i1 in elements(ff.insurers)
    and :i2 in elements(ff.insurers) 
```

我怀疑你试图实现的 SQL 是这样的，虽然我不能*准确地*告诉你上面的 HQL 翻译成什么......

```
select f.* from files f
    left outer join files_insurers fi1 on fi1.files_id = f.id
    left outer join files_insurers fi2 on fi2.files_id = f.id
where 1 = 1
    and fi1.insurers_id = :i1
    and fi2.insurers_id = :i2; 
```

# template-toolkit - 如何在模板工具包中获取随机数？

> ID：722562
> 
> 赞同：6
> 
> 时间：2009-04-06T18:11:15.840
> 
> 标签：template-toolkit

我想使用模板工具包获得一个随机数。它不必特别随机。我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-04-29T07:39:53.253

嗯，如果您没有（或无法导入）Slash::Test，您可能会遇到问题。从 TT 的“vanilla”安装中，您可以简单地使用 Math 插件：

```
USE Math;
GET Math.rand; # outputs a random number from 0 to 1 
```

有关数学插件和各种方法的更多信息，请参阅[模板工具包手册中的此链接。](http://template-toolkit.org/docs/modules/Template/Plugin/Math.html)

更新： Math.rand 需要一个参数。因此，要获得一个从 0 到 1 的随机数，请使用：

```
GET Math.rand(1); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-06T18:16:21.587

来自[Slashcode 的这篇文章](http://ask.slashcode.com/article.pl?sid=02/06/17/0431216&tid=4)：

```
[slash@yaz slash]$ perl -MSlash::Test -leDisplay
[%
digits = [ 0 .. 9 ];
anumber = digits.rand _ digits.rand _ digits.rand;
anumber;
%]
^D
769 
```

# c# - 如何将 PostBack 数据拉入动态添加的 UserControl (.NET)？

> ID：722570
> 
> 赞同：0
> 
> 时间：2009-04-06T18:13:51.030
> 
> 标签：c#, .net, viewstate, dynamic-controls

我的页面上有一个面板：

```
<asp:Panel ID="pnlTest" runat="server" /> 
```

然后我在 Page_Load 上动态添加一个 TextBox：

```
 TextBox simpleTextBox = new TextBox();
    pnlTest.Controls.Add(simpleTextBox);
    simpleTextBox.ID = "SimpleTextBox-1"; 
```

有没有办法在不直接从 Request.Form 中提取的情况下提取在此 TextBox 中键入的信息？我想在我再次添加后我可以做这样的事情：

```
lblPresentResults.Text = myTextBox.Text; 
```

我知道这个例子似乎是做作的，但我想我会尝试消除我的特定应用程序中的所有其他变量，尤其是在这里提出问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T18:16:57.903

您需要在加载视图状态之前添加文本框，例如在 Page_Init 中，您应该能够做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T18:16:59.057

只需在`Init`或`PreInit`而不是 Load 上创建文本框，以便在ViewState 恢复*之前它存在于页面中。*然后 ASP.Net 将自动为您更新它。

# php - 使用 Zend Framework 从 DB 中获取 Integer 以字符串形式返回值

> ID：722573
> 
> 赞同：11
> 
> 时间：2009-04-06T18:16:13.130
> 
> 标签：php, mysql, zend-framework

当我使用 ZF 包装器运行 sql 查询时，所有数值都以字符串形式返回。我需要更改什么，以便这些值以与 DB 中相同的数据类型返回？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-06T19:25:59.110

`Zend_Db`我在 Zend Framework 中实现了很多代码。

正如其他人所说，`Zend_Db`返回字符串而不是原生 PHP 整数或浮点数的原因是 PHP 的数据库扩展返回字符串。其原因是可能没有原生 PHP 类型来表示某些数据库类型。

例如，MySQL`BIGINT`是一个 64 位有符号整数。默认情况下，PHP`int`类型限制为 32 位值，因此如果您从数据库中获取数据并将其隐式转换为`int`，则某些值可能会被截断。还有其他几个类似的情况，for`float`和date等。

对所有数据类型使用字符串表示是保持简单和一致、避免数据丢失以及避免编写大量供应商特定的特殊情况代码来进行数据类型映射的最佳方法。额外的代码也会导致性能损失。

因此，如果您有需要将数据库结果映射到原生 PHP 数据类型的特定情况，您应该在应用程序代码中自己实现它（例如，在自定义`Zend_Db_Table_Row`类中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T18:22:25.050

数据库通常以文本形式返回结果集。除非您的 db 适配器为您转换内容（并且听起来像您的没有），否则所有值都将以字符串形式返回——日期、枚举等以及整数。

如果您正在处理只有几个整数字段的少量表，只需手动转换它们。如果您正在处理稍微复杂一点的情况，您可以使用数据库定义遍历列（请参阅`sqlite_fetch_column_types()`等）。如果您的情况比这些解决方案看起来合理的复杂，请考虑切换到功能更强大的框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T18:24:30.630

似乎过去曾提出过要求，但尚未实施。[#ZF-300](http://framework.zend.com/issues/browse/ZF-300 "Zend 框架错误 #300")最后一次评论是在 2009 年 1 月 9 日。

也许您可以分享您为什么要执行类型转换，我们可以以另一种方式帮助您？PHP 在可变数据类型方面非常宽松......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T13:59:09.407

有关使用自定义`Zend_Db_Table_Row`获取正确数据类型的示例，如 Bill Karwin 建议的那样，请查看此处的课程：[http ://www.zfsnippets.com/snippets/view/id/70](http://www.zfsnippets.com/snippets/view/id/70)

它可以在您的模型中实现为：

```
class YourTableName extends Zend_Db_Table_Abstract
{
    protected $_name = 'your_table_name';
    protected $_rowClass = 'Model_Row_Abstract';
} 
```

如果您严格使用它来保存布尔值，您可能需要更改`Model_Row_Abstract`的数据类型。`tinyint``bool`

# javascript - 使用 Javascript scrollLeft 强制滚动定位

> ID：722582
> 
> 赞同：1
> 
> 时间：2009-04-06T18:18:17.337
> 
> 标签：javascript, firefox, scrollbar

我有一组 Javascript 函数，我使用输入元素表来启用导航。比如跟踪当前关注的元素，从一行的末尾溢出到下一行的开头。我通过创建一个只有一列宽的表作为我的固定列并为另一个表提供滚动条，从而对固定的第一列提供滚动条支持。

但是，我最近注意到，滚动条的默认行为有点不足。当我导航到最后一列时，Firefox 使该列部分被滚动条遮挡，而不是滚动到足以看到它。同样，一旦我滚动到最后一列的另一部分，当我移动到下一行并且导航代码将焦点设置到第一列（冻结表）中的单元格时，Firefox 不会改变滚动条，这样我就可以看到第一列的所有内容。

因此，我一直在研究如何使用 javascript 修改滚动条定位。我的表格不使用垂直滚动条，只使用水平滚动条。所以我偶然发现了scrollLeft。

```
document.getElementById("meastable").scrollLeft = 1; // reset scroll to leftmost 
```

不幸的是，这似乎只在一段时间内起作用。当我启用 Firebug 并通过我的导航代码跟踪此行所在的位置时，它似乎偶尔工作一次，但大多数时候，此行会运行，但表向左滚动属性未更改，我看不到更改视觉上也是。

我还将 scrollLeft 设置为一个高数字，因此它将被设置为文档中描述的最大值，这也不起作用（偶尔除外）。

我使用以下代码在我的表格中设置滚动条。

```
<div style="overflow:auto">
<table id="meastable" border="1"> 
```

根据 Mozilla 的文档，这似乎起源于 IE，但现在可以在 Firefox 中使用。这实际上在 Firefox 中不起作用吗，因为内部项目仅适用于 Firefox。

所以我试图找出问题所在。是否已知 scrollLeft 不能正常工作，或者我应该回去看看我是否在滚动条的定义中搞砸了一些东西或类似的东西？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-06T20:25:49.357

包含的 div 是溢出的元素。您需要设置 div 的 scrollLeft，而不是表格。

# c# - 在我的 ContentPlaceHolder 中使用链接 href 时出错

> ID：722588
> 
> 赞同：2
> 
> 时间：2009-04-06T18:20:17.723
> 
> 标签：c#, asp.net, vb.net, stylesheet, contentplaceholder

我在我的项目中使用 MasterPage ...

这是我需要放置在我的 Dedault.aspx 页面的 ContentPlaceHolder 中的链接

```
<link href="jquery/imagebox/imagebox.css" rel="stylesheet" /> 
```

但我收到一个错误“元素链接不能嵌套在元素 td 中”

知道该怎么做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T18:23:26.933

您只能将样式表链接放在文档的标题中。这是如何从 ContentPlaceholder 执行此操作的链接：

[http://www.odetocode.com/articles/450.aspx](http://www.odetocode.com/articles/450.aspx)

引用：

```
Protected Sub Page_Load(ByVal sender As Object, _
                         ByVal e As System.EventArgs)

   Dim cssLink As New HtmlLink()
   cssLink.Href = "~/styles.css"
   cssLink.Attributes.Add("rel", "stylesheet")
   cssLink.Attributes.Add("type", "text/css")
   Header.Controls.Add(cssLink)

End Sub 
```

# naming-conventions - 业务级对象应该如何命名？

> ID：722594
> 
> 赞同：3
> 
> 时间：2009-04-06T18:23:08.760
> 
> 标签：naming-conventions, business-logic

我们正在构建一个面向服务的系统，我们将应用程序分为几个层：

1.  SOAP Web 服务（例如 BuildingService.asmx）
2.  业务逻辑层（例如 BuildingXXX）
3.  数据访问层（例如 BuildingProvider）
4.  类型（例如，建筑）

SOAP Web 服务只是从业务逻辑层实例化一个 BuildingXXX 类型的对象，以便将实现排除在 SOAP Web 服务之外。BuildingXXX 然后使用来自数据访问层的 BuildingProvider 返回在数据传输对象层中定义的类型。

我们一直无法确定我们应该在业务逻辑层中调用什么对象。

命名这些业务级实体的“标准”命名约定是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T18:34:23.460

就个人而言，我会将您的业务逻辑层服务称为“BuildingService”，然后将 Web 服务称为“BuildingWebService”。

或者你总是可以使用通用的“BuildingManager”以及服务层..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-07T00:21:14.827

命名空间是你的朋友。BusinessLayer.Building、BusinessLayer.Facility 怎么样？使用 DataLayer.Building、DataLayer.Facility 等。您可以将事物称为它们的本来面目，但它们会成为不同的事物。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T18:30:29.553

我会天真地使用 BuildingRules（因为它们就是这样，对吗？）但是我实际上并不*知道*约定是什么......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T18:36:16.670

我更喜欢前缀而不是后缀，以便相关层排序在一起，例如

```
BizRuleBuilding,
BizRuleFacility,
... 
```

# .htaccess - 我应该在使用域掩码的站点上拥有除 .htaccess 之外的哪些文件？

> ID：722597
> 
> 赞同：0
> 
> 时间：2009-04-06T18:23:38.010
> 
> 标签：.htaccess, domain-mask

我有一个站点 A 和站点 B。站点 B 具有站点 A 的域掩码，以便站点 A 的内容在站点 B 上可见。

站点 B 仅包含一个 .htaccess 文件。

**除了站点 B 的 .htaccess 之外，我还需要其他文件吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T18:28:27.717

如果对站点 B 的所有请求都映射到站点 A 的等效请求，那么不，您没有。

# iphone - iPhone加速器的范围是多少？

> ID：722600
> 
> 赞同：5
> 
> 时间：2009-04-06T18:24:14.733
> 
> 标签：iphone, accelerometer, accelerator

我似乎无法在网上找到任何关于此的文档，而我在谷歌上搜索的内容却给了我很多相互矛盾的信息......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-06T18:26:44.367

来自[iphonedevsdk.com](http://www.iphonedevsdk.com/forum/iphone-sdk-development/4822-maximum-accelerometer-reading.html)：

> 第一代和第二代 iPhone（我假设也是 iPod touch）中使用的加速度计以两种模式运行：+/- 2 g 和 +/- 8 g。（实际上，正如您所观察到的，它们报告的加速度有点超出标称范围。不过，精度并未超出该范围。）
> 
> Apple 在 +/- 2 g 模式下运行它们。有一个折衷：根据数据表，当前分辨率名义上为 0.018 g（尽管根据 AccelerometerGraph 的修改版本，我的第一代 iPhone 使用 0.018168604）。在 +/- 8 g 模式下，分辨率会粗糙四倍。
> 
> 我认为苹果认为更精细的分辨率会比更宽的范围更有用。（我宁愿看到比 0.018 g 更精细的分辨率。所以我们俩都不完全满意。）
> 
> 您无法使用 API 的任何已发布功能更改模式。由于它们将加速度作为双倍传递，因此理论上它们可以允许改变模式，并在重新调整 A/D 值时简单地查看模式，然后再报告加速度。（设置模式的明显位置是在设置应用程序以接收加速度计信息的调用中。）但是，为了向后兼容，操作系统必须在开始时将加速度计模式设置为 +/- 2 g应用。并且不允许任何后台进程设置加速度计模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-28T05:09:43.920

当您移动设备时，aGauge 应用程序会显示来自加速度计的原始数据。它还可以帮助您找到设备的“翻转”阈值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T18:30:24.327

我创建了以下应用程序来尝试测试范围...

```
UIAccelerometer *objAccelerometer;
UILabel *lblxmin, *lblxmax, *lblymin, *lblymax, *lblzmin, *lblzmax;
UILabel *lblxnow, *lblynow, *lblznow;

float xmin = 0.0, xmax = 0.0, ymin = 0.0, ymax = 0.0, zmin = 0.0, zmax = 0.0, xnow = 0.0, ynow = 0.0, znow = 0.0;

- (void)accelerometer:(UIAccelerometer *)accelerometer didAccelerate:(UIAcceleration *)acceleration {   
    //NSLog (@"%f, %f, %f", acceleration.x, acceleration.y, acceleration.z);
    xnow = acceleration.x;
    ynow = acceleration.y;
    znow = acceleration.z;
    if (xnow < xmin) { xmin = xnow; }
    if (ynow < ymin) { ymin = ynow; }
    if (znow < zmin) { zmin = znow; }

    if (xnow > xmax) { xmax = xnow; }
    if (ynow > ymax) { ymax = ynow; }
    if (znow > zmax) { zmax = znow; }

    lblxmin.text = [NSString stringWithFormat:@"%f", xmin];
    lblymin.text = [NSString stringWithFormat:@"%f", ymin];
    lblzmin.text = [NSString stringWithFormat:@"%f", zmin];

    lblxmax.text = [NSString stringWithFormat:@"%f", xmax];
    lblymax.text = [NSString stringWithFormat:@"%f", ymax];
    lblzmax.text = [NSString stringWithFormat:@"%f", zmax];

    lblxnow.text = [NSString stringWithFormat:@"%f", xnow];
    lblynow.text = [NSString stringWithFormat:@"%f", ynow];
    lblznow.text = [NSString stringWithFormat:@"%f", znow];

}

-(void) invokeAccelerometer {   
    objAccelerometer = [UIAccelerometer sharedAccelerometer];
    objAccelerometer.delegate = self;
    objAccelerometer.updateInterval = (1.0 / 10.0);
}

// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad {
    lblxmin = [[UILabel alloc] initWithFrame:CGRectMake(10, 10, 100, 40)];
    lblxnow = [[UILabel alloc] initWithFrame:CGRectMake(100, 10, 100, 40)];
    lblxmax = [[UILabel alloc] initWithFrame:CGRectMake(200, 10, 100, 40)];

    lblymin = [[UILabel alloc] initWithFrame:CGRectMake(10, 60, 100, 40)];
    lblynow = [[UILabel alloc] initWithFrame:CGRectMake(100, 60, 100, 40)];
    lblymax = [[UILabel alloc] initWithFrame:CGRectMake(200, 60, 100, 40)];

    lblzmin = [[UILabel alloc] initWithFrame:CGRectMake(10, 110, 100, 40)];
    lblznow = [[UILabel alloc] initWithFrame:CGRectMake(100, 110, 100, 40)];
    lblzmax = [[UILabel alloc] initWithFrame:CGRectMake(200, 110, 100, 40)];

    [self.view addSubview:lblxmin];
    [self.view addSubview:lblxnow];
    [self.view addSubview:lblxmax];

    [self.view addSubview:lblymin];
    [self.view addSubview:lblynow];
    [self.view addSubview:lblymax];

    [self.view addSubview:lblzmin];
    [self.view addSubview:lblznow];
    [self.view addSubview:lblzmax];

    [self invokeAccelerometer];

    [super viewDidLoad];
} 
```

问题是，当我沿水平/垂直轴旋转 iPod 然后将其翻转时，我得到如下值：

xmin -1.271802

xmax 1.180959

ymin -1.344477

ymax 1.108285

zmin -2.30713

zmax 2.325581

如果我拿起 iPod 并摆脱它，我会...

x -2.325581 到 2.307413

y -2.325581 到 2.307413

z -2.307413 至 2.325581

任何想法它正在测量什么？

我想出的最好的是：

纵轴

x = -1 如果向左倾斜 ( <| )

x = +1 如果一直向右倾斜 ( |> )

*   其中 < 是屏幕朝向的方式，| 是 iPod 的底部

y ~ -1 如果屏幕面向您，垂直于地板（“站立”）

y ~ 1 如果背对你（并且倒置）

# python - 为什么不使用 asyncore 调用 handle_read 方法？

> ID：722605
> 
> 赞同：1
> 
> 时间：2009-04-06T18:25:01.017
> 
> 标签：python, sockets, packet

我正在尝试使用异步调度程序（下面的代码）通过数据包套接字对发送/接收进行原型类型。尽管我的 handle_write 方法被迅速调用，但 handle_read 方法似乎没有被调用。loop() 确实经常调用可读方法，但我无法接收任何内容。我知道在 eth0 上收到了数据包，因为一个简单的 tcpdump 会显示传入的数据包。我错过了什么吗？

```
 #!/usr/bin/python

import asyncore, socket, IN, struct

class packet_socket(asyncore.dispatcher):

    def __init__(self):
        asyncore.dispatcher.__init__(self)
        self.create_socket(socket.AF_PACKET, socket.SOCK_RAW)
        self.buffer = '0180C20034350012545900040060078910'
        self.socket.setsockopt(socket.SOL_SOCKET,IN.SO_BINDTODEVICE,struct.pack("%ds" % (len("eth0")+1,), "eth0"))

    def handle_close(self):
        self.close()

    def handle_connect(self):
        pass

    def handle_read(self):
        print "handle_read() called"
        data,addr=self.recvfrom(1024)
        print data
        print addr

    def readable(self):
        print "Checking read flag"
        return True

    def writable(self):
        return (len(self.buffer) > 0)

    def handle_write(self):
        print "Writing buffer data to the socket"
        sent = self.sendto(self.buffer,("eth0",0xFFFF))
        self.buffer = self.buffer[sent:]

c = packet_socket()

asyncore.loop() 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T20:22:06.743

我终于在同事的帮助下完成了这项工作。这与将协议参数传递给`create_socket()`方法有关。不幸`create_socket()` 的是，调度程序没有采用第三个参数 - 所以我不得不修改我的`packet_socket()`构造函数以采用预先创建的带有协议的套接字`ETH_P_ALL`（或您希望接收的任何协议类型）作为参数。编辑代码如下：

```
 #!/usr/bin/python

import asyncore, socket, IN, struct

proto=3
s = socket.socket(socket.AF_PACKET, socket.SOCK_RAW, socket.htons(3))
s.bind(("eth0",proto))

class packet_socket(asyncore.dispatcher):

    def __init__(self,sock):
        asyncore.dispatcher.__init__(self,sock)
        #self.create_socket(socket.AF_PACKET, socket.SOCK_RAW,socket.htons(3))
        self.buffer = '0180C20034350012545900040060078910'
        self.socket.setsockopt(socket.SOL_SOCKET,IN.SO_BINDTODEVICE,struct.pack("%ds" % (len("eth0")+1,), "eth0"))

    def handle_close(self):
        self.close()

    def handle_connect(self):
        pass

    def handle_read(self):
        print "handle_read() called" 
    data,addr=self.recvfrom(1024)
        print data
        print addr

    def readable(self):
        print "Checking read flag" 
    return True

    def writable(self):
        return (len(self.buffer) > 0)

    def handle_write(self):
        print "Writing buffer data to the socket" 
    sent = self.sendto(self.buffer,("eth0",0xFFFF))
        self.buffer = self.buffer[sent:]

c = packet_socket(s)

asyncore.loop() 
```

谢谢，

# c# - 在 .NET 中按需下载和安装 dll 的最佳方式是什么？

> ID：722612
> 
> 赞同：3
> 
> 时间：2009-04-06T18:26:52.230
> 
> 标签：c#

我们有一个应用程序，我们希望为其安装一个基本的 shell。当用户使用它时，它将下载并安装必要的 dll 以执行需要执行的操作（想象一个具有多个可能路径的向导应用程序场景）。目前，所有可能的路径都通过 shell 应用程序安装。

在一年中的大约 3 个月中，用于可能路径的 dll 经历了很高的更新流失率，因此我们希望开始确保用户拥有这些 dll 的最新版本。这个想法是，在他们做出所有选择之后，我们会进行网络检查以查看他们的选择需要哪些 dll，并检查以确保他们拥有这些文件的最新版本。

所有这些我们都有一个如何去做的计划。我要解决的问题是“安装”这些文件的最合适方法是什么。ClickOnce 不是一个选项......这里有太多遗留的东西。我们的应用程序安装在“程序文件”中，这显然限制了在 Vista 及更高版本下将随机文件写入程序的安装文件夹。

现在我看到的选项如下：

1.  在安装时，将安装目录标记为“每个人”组的可写目录。我还没有实际测试过这是否可行，或者 Vista 在这种情况下是否会有所不同。
2.  将下载部分拆分为第二个应用程序，我们可以提示提升权限，以便它可以下载和安装这些文件。

我倾向于第二个选项，因为它维护了 Program Files 文件夹的安全性。小组中的其他人倾向于第一个选项，因为他们只是不想担心事情。还是我缺少其他选择？

该应用程序是一个 .NET 应用程序，尽管它对不是托管程序集的第三方 dll 有一些要求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T18:36:09.527

只要您要加载的 dll 是受管理的，就有几种方法可以做到这一点。

一种方法是指定一个 Environment.SpecialFolder 路径，例如 AppData 并从那里动态地将程序集加载到您的 appdomain 中。[RssBandit](http://rssbandit.org/)对插件执行此操作，有一个特殊的目录可以加载 dll 并搜索特定的接口实现，将它们加载到临时 appdomain 中，然后从应用程序中调用它们。您可以通过使用[ninject](http://ninject.org/)或[structuremap](http://structuremap.sourceforge.net/Default.htm)之类的 IoC 库来更进一步。

您还可以尝试[MEF](http://www.codeplex.com/MEF)，这是 C# 4 中出现的新的可扩展性框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T18:41:41.680

就个人而言，我喜欢 Firefox/xul 应用程序所做的事情。我想这是您提出的两种解决方案的混合体。他们有一个 updater.exe，它位于安装目录中。我假设这意味着安装目录在安装期间可写，以便他们可以运行更新应用程序。但是，由于从未以这种方式部署过应用程序，我无法告诉您它有多么令人头疼（或没有）。

您没有提到并且可能不知道的替代方法是使用 .Net 下载缓存。当您尝试加载程序集时，您可以为其提供代码库以从中加载。如果您将代码库设置为 Web url（即[http://mywebhost/mycoolapp/](http://mywebhost/mycoolapp/)），如果在下载缓存中找不到该程序集，.Net 将从该 url 下载程序集。如果有，它还将从 Web url 中获取最新版本的程序集。

这种方法可能会很痛苦，因为如果您的应用需要提升权限，您可能不得不处理 CAS 安全问题。但是，不必编写代码来为您下载最新版本的程序集，这很好。如果您想了解更多信息，我可以找到一些资源并提供更详细的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T19:16:52.813

我处理它的方法是将 update.exe 安装到主 .exe 文件旁边的程序文件中。

然后，在应用启动时，我让应用从网上下载一个 xml 文件并将其保存在 App Data 文件夹中。该文件包含最新版本的 dll，并具有简单的文件名、版本结构。

遍历文件名列表，如果您在本地没有 dll 或者您有旧版本，则将所需的 dll 添加到更新列表中。

生成更新列表后。使用要更新的文件的命令行列表启动 Updater.exe。您不必将它们写入程序文件，但我会这样做。在 Vista 上，我的更新程序会正确弹出 UAC 提示符（因为它应该维护程序文件的安全性）。

然后更新程序将文件下载到 Program Files 并重新启动主应用程序。

启动第二个应用程序的一个问题是你必须给它一个清单，其中设置了“AsAdministrator”。

这并不难做到，但是一旦更新程序完成并重新触发主应用程序，它就无法以正常权限启动主应用程序。以管理员身份运行的 exe 也只能以管理员身份启动其他 exe，即使清单中设置了“AsInvoker”。我不知道您为什么不能将其限制为正常权限...您只能出于某种原因提升权限...

# latex - 将比文本列宽的表格居中

> ID：722613
> 
> 赞同：49
> 
> 时间：2009-04-06T18:27:09.827
> 
> 标签：latex, center

我在我的 LaTeX 文档中包含了一个表格，如果表格不比其上方的文本列宽，则居中工作正常，但是当表格更宽时，表格的左侧粘在文本的左侧列，并且表格的附加宽度在页面的右侧，我怎样才能使表格居中？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-06T20:01:09.913

我建议尝试这个[`chngpage`](http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=chngpage)包。

```
\documentclass{article}

% allows for temporary adjustment of side margins
\usepackage{chngpage}

% provides filler text
\usepackage{lipsum}

% just makes the table prettier (see \toprule, \bottomrule, etc. commands below)
\usepackage{booktabs}

\begin{document}

\lipsum[1]% just a paragraph of filler text

\medskip% adds some space before the table
\begin{adjustwidth}{-1in}{-1in}% adjust the L and R margins by 1 inch
  \begin{tabular}{ll}
    \toprule
    Sequence & Wide column \\
    \midrule
    First & Vestibulum porta ultricies felis. In nec mi. \\
    Second & Nam vestibulum auctor nibh. In eleifend, 
    lacus id tristique ullamcorper, mauris urna convallis elit. \\
    Third & Ut luctus nisi quam lobortis magna. Aenean sit amet odio 
   et sapien rutrum lobortis. \\ 
    Fourth & Integer dictum accumsan purus. Nullam erat ligula,
    dictum sed, feugiat nec, faucibus id, ipsum. \\
    \bottomrule
  \end{tabular}
\end{adjustwidth}
\medskip% adds some space after the table

\noindent\lipsum[2]% just a paragraph of filler text

\end{document} 
```

包的文档`chngpage`位于`chngpage.sty`文件的底部。我已经提取了`adjustwidth`环境文档：

> 在 adjustwidth 环境中，可以调整左右边距。环境采用一个可选参数和两个必需的长度参数：
> 
> `\begin{adjustwidth}[]{leftmargin}{rightmargin}`
> 
> ```
> A positive length value will increase the relevant margin 
> ```
> 
> （缩短文本行），而负长度值将减少边距（延长文本行）。一个空的长度参数意味着边距没有变化。在环境结束时，边距恢复为原始值。
> 
> 例如，要将文本扩展到右边距：
> 
> `\begin{adjustwidth}{}{-8em}`
> 
> 可选参数的任何出现（甚至只是`[]`）都会导致边距值在奇数页和偶数页之间切换。
> 
> 如果文档被设置为双面，则将任何更宽的文本延伸到外边距可能是有利的。这可以通过可选参数来完成，如：
> 
> `\begin{adjustwidth}[]{}{-8em}`
> 
> 要使调整后的文本相对于任何周围的文本水平居中，应同样调整边距：
> 
> `\begin{adjustwidth}{-4em}{-4em}`

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2011-07-08T15:09:23.240

**Latex：居中表格大于文本宽度**

通常，您可以使用 \center 使表格居中。但是当表格长于 \textwidth 时，它将与左侧边距对齐。您可以临时调整文本宽度。

```
% allows for temporary adjustment of side margins
\usepackage{chngpage}

\begin{table}
    \begin{adjustwidth}{-.5in}{-.5in}  
        \begin{center}
        \begin{tabular}{|c|}
            \hline
And here comes a very long line. And here comes a very long line. And here comes a very long line.  \\
            \hline
        \end{tabular} 

        \caption{This Table is longer than the text width. And its caption is really long, too. This Table is longer than the text width. And its caption is really long, too. This Table is longer than the text width. And its caption is really long, too. This Table is longer than the text width. }
        \label{myTable}
        \end{center}
    \end{adjustwidth}
\end{table} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-11-04T12:58:11.227

如果您使用的是 \table 浮点数，则 \begin{adjustwidth} ... \end{adjustwidth} 必须包含在其中。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-02-15T17:41:41.603

在图形中，图形环境必须包含`adjustwidth`env.. 此外，`caption`应将其留在此环境之外以与整个图形的宽度对齐：

```
\begin{figure}[h]
  \begin{adjustwidth}{-1in}{-1in}% adjust the L and R margins by 1 inch
    \centering
    \includegraphics[scale=0.44]{res/sth.png}
  \end{adjustwidth}
  \caption{sth}
  \label{fig:sth}
\end{figure} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-06T20:00:33.830

您是否使用多列文档？我是这样，考虑`table*`变体环境。

在单列环境中，您的选项运行到：

*   增加`textwidth`. 但是出于良好的人体工程学原因选择了默认边距，因此除了最小的调整之外，不鼓励这样做。
*   减小表格中的文本大小（即`\small`甚至`\footnotesize`在`tabular`环境中）。同样，这不是最佳的。
*   使用[Stephan202 给出的链接](https://stackoverflow.com/questions/722613/latex-centering-a-table-wider-than-the-text-column/722631#722631)中建议的[`rotating`包](http://www.ctan.org/tex-archive/help/Catalogue/entries/rotating.html)。我在我的论文中将它用于几个非常大的表格（只有定位选项），结果非常好。`p`

# asp.net - ASP.NET 中的 Jabber 集成

> ID：722628
> 
> 赞同：3
> 
> 时间：2009-04-06T18:34:15.100
> 
> 标签：asp.net, chat, xmpp

我正在为 Jabber 寻找支持 AJAX 的 Web 客户端。我找到了一些，但它们看起来很难与 ASP.NET 集成。

其中一些甚至没有在 IE 中进行测试。

我正在尝试制作一个类似 Facebook 的聊天客户端，欢迎任何建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T18:37:06.370

看看这个 .NET 的 jabbar 库：

[http://code.google.com/p/jabber-net/](http://code.google.com/p/jabber-net/)

或者，如果您需要为您的网站提供现成的解决方案，请点击此处：

[http://www.hotscripts.com/](http://www.hotscripts.com/)

# asp.net - ASP.NET MVC > ASP.NET WebForms，为什么？

> ID：722637
> 
> 赞同：13
> 
> 时间：2009-04-06T18:37:13.110
> 
> 标签：asp.net, asp.net-mvc

我现在已经使用 ASP.NET MVC 完成了我的第一个 Web 应用程序，总的来说，我仍然不明白为什么它会获得所有的赞誉和荣耀。可能是我太固执了。我知道 MVC 的伟大之处在于它强制表示层和业务对象或数据层之间的分离以及它的无状态操作。我也知道，当您使用视图时，代码似乎不太可读（请参见下面的示例）。

所以我想我的问题是......如果分离是关注点，为什么不只是分离。

**Web 表单查看代码：**

```
//UI
<h2><asp:Label ID="lblPageHeader" runat="server" /></h2> 
```

**Web 表单代码背后：**

```
//CODE BEHIND
this.lblPageHeader.Text = myObject.Header; 
```

**MVC 代码视图：**

```
//UI
<h2><%= Html.Encode(Model.PageTitle) %></h2> 
```

**MVC 控制器代码：**

```
index = new Index
{
    PageText = sb.ToString(),
    PageTitle = "WELCOME"
};
return View(index); 
```

同样，我可能很固执，但我真正喜欢 WebForms 的一件事是可以轻松设置对象属性，如 DataSources 和 Text 值。似乎这在 MVC 中完全不同并且可读性较差，这让我对长期维护感到疑惑。

**编辑** 查看类型化模型后，我认为代码的可读性得到了显着提高。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-06T18:40:26.910

[ASP.NET MVC 最佳实践、提示和技巧](https://stackoverflow.com/questions/709429/asp-net-mvc-best-practices-tips-and-tricks)

我会写：

```
<h2><%= Html.Encode(Model.Title) %></h2> 
```

（可以借助类型化视图）

代替

```
<h2><%= Html.Encode((MyApp.MyObject)ViewData["PageObject"].Header) %></h2> 
```

我认为这完全取决于你如何使用它。如果您对经典的 ASP.NET 更满意，那么坚持使用它可能是一个更好的主意。此外，您还可以从 ASP.NET MVC 世界（如 UI 和逻辑分离）中获取好东西并将其带到经典的 ASP.NET 中。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-06T19:19:45.597

ASP.NET MVC 的优点在于它不会试图隐藏 HTTP 的工作方式。要完全理解 ASP.NET MVC，您需要了解 Web 技术。

虽然只要您发挥其优势，网络表单就足够了，但当您不这样做时，它们最终是一个非常容易泄漏的抽象。虽然在这一点上已经很好地讨论了 viewstate 的缺点，但我认为模仿 Winforms 的行为是非常不明智的尝试，这是潜在的缺陷 - viewstate 只是其中的产物。

与 ASP.NET 一起提供的 Web 控件也留下了很多不足之处，任何尝试构建可访问网站的人都可以证明这一点。Web 控件显示出对前端开发是如何完成的完全缺乏了解，坦率地说是一种耻辱。

使用 ASP.NET MVC，所有这些废话都被消除了。你不会受到 HTTP、HTML、CSS 或 JavaScript 的保护——如果你带着这些技术来参加聚会，那么框架就会让你摆脱困境并让你利用它们。如果不是，那么谢天谢地，它不会试图帮助您假装它们不存在。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-06T19:14:22.630

不是一个完整的答案，但一个大问题是 ASP.NET 表单的可测试性，或者缺乏它。测试显示内容和方式的 UI 逻辑。使用 ASP.NET Forms，您只剩下代码隐藏了。

现在，MVC 并不适合所有人。您可能需要查看 ASP.NET 表单的 MVP（模型视图演示器），因为它使用非常相似的 MVC 概念，除了演示器控制更改视图的内部结构。

但是，可测试性确实是测试代码的一大优势。比如当有人点击 ChangePassword 方法/动作时会发生什么：

```
[TestClass]
public class AccountControllerTest
{

    [TestMethod]
    public void ChangePasswordPostRedirectsOnSuccess()
    {
        // Arrange
        AccountController controller = GetAccountController();

        // Act
        RedirectToRouteResult result = 
            (RedirectToRouteResult)controller.ChangePassword(
                "oldPass", "newPass", "newPass");

        // Assert
        Assert.AreEqual("ChangePasswordSuccess"
            , result.RouteValues["action"]);
    }
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-06T22:04:14.610

我喜欢 MVC 的一件事（其中一件）是它摆脱了 Web 服务器控件。虽然许多人认为它们是 WebForms 的一大优点，但我发现一旦您通过了基本操作，它们就会变成一场噩梦。试图将网格上的数据绑定事件与回发和其他所有事情结合起来成为意大利面条代码的 OO 版本。

MVC 将要求您更好地了解 Web 开发的基本租户（GET、POST、REQUEST、HTML、CSS、JAVASCRIPT），结果会更好。查看我认为 MVC 是如何工作的图表 :-)

[替代文字 http://www.baseestate.com/webformsmvc.gif](http://www.baseestate.com/webformsmvc.gif)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-06T18:42:31.927

当然，不管你怎么做，一个简单的例子都会非常清晰易读。据说，当您扩大复杂性时，MVC 的优势会变得更加明显。

此外，事实证明，Webforms 模型对于大容量的公共互联网站点来说并不是那么好。ViewState 加上普通 Web 表单站点中昂贵的页面生命周期会使可伸缩性成为一项挑战（并非不可能，但具有挑战性）。相比之下，在内部网站上，用户通常具有更大的上行带宽（ViewState 工作得更好），并且音量控制得更好**。**所以网络表单在那里真的很好用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-06T18:46:05.367

确实，您需要在 MVC 中做更多事情才能获得一些您在 WebForms 中已经习惯的基本非常自动化的功能。

但是，从长远来看，您最终会获得更多控制权。

关于 WebForms的**主要问题是整个 PostBack 场景**，以及您必须跳过多少圈才能实现一些简单的 WebForms 没有想到的东西。一个很好的例子是我的与 WebForms 相关的问题： [ASP.NET 中是否有任何本地方式来执行“成功消息”？](https://stackoverflow.com/questions/361910/is-there-any-native-way-in-asp-net-to-do-a-success-message)

我想在 WebForms 应用程序中制作“已保存记录”或“已添加新记录”消息。事实证明，你必须做一些非常可怕的事情才能让这个简单的功能发挥作用，因为**他们在 WebForms 中没有正常的方法来执行此操作，并且要执行自定义方法，你正在与隐藏的功能作斗争回发**。

在 MVC 中，这不会有问题。您仍然需要手动编写功能，但您可以更好地控制页面状态。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-06T19:11:07.320

我相信只有在您参与过一个大型项目并看到 WebForms 方法可能造成的混乱程度之后，您才能感受到不同。

当您看到一个页面包含多个组件、用户控件时，其中一些组件过着独立的生活，例如隐藏/显示或启用/禁用自身，所有这些规则都通过多个控件层传递，直到您进入项目才能跟踪多年来（或者至少在使用调试器之前已经抽了一些非常好的东西:)），当您看到您的数据如何定义具有哪些属性的组件被渲染时，您开始欣赏明确定义的控制流的可能性在一个页面上。

我也喜欢 WebForms 很长时间了。出于与您提出的完全相同的原因，我也不喜欢最初几周/几个月的 MVC。在我完成了一些编码并可以比较体验之后，我开始享受 MVC。

尽管如此，在某些领域，MVC 方法会比 WebForms 更复杂，并且会造成更多混乱。

它会随着时间而来。真的不是很久。:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-06T18:43:26.090

我也对 ASP.NET MVC 持观望态度（以及 Entity 框架和 WPF 出于不同的原因）。总的来说，我是 MVC 的忠实粉丝，但我有点担心将像 Web 开发框架这样通用的东西包装到一个模式的约束中。一个非常有用的模式，但仍然只是众多模式中的一种。

熟练的开发人员几乎可以用任何语言实现 MVC。因此，MVC 可能是防止技能较低的开发人员（我们在某些时候都是这样，比如刚学习框架时）犯下严重错误的好方法。由于该模式在可以使其成为净收益的广泛场景中运行良好。

另一方面，对于专业的开发人员来说，这可能就像奥运自行车运动员的训练轮一样......多余的，更多的是痛苦而不是好处。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-06T20:45:10.417

我认为这很大程度上取决于你的背景。如果您已经熟悉 Ruby-rails 和/或 Django，asp.net mvc 更有意义。

此外，如果您长期使用 Html 和 css 制作网站，Mvc 会更好，因为您可以完全控制 html 输出。

如果您对 asp.net 感到满意，请继续使用它，它不会消失 :)。

# python - Python 类包含错误行为

> ID：722640
> 
> 赞同：0
> 
> 时间：2009-04-06T18:37:35.217
> 
> 标签：python

我进入了我的 main.py

```
from modules import controller
ctrl = controller
help(ctrl)
print(ctrl.div(5,2)) 
```

controller.py 是：

```
class controller:
    def div(self, x, y): 
        return x // y 
```

当我运行我的主程序时，我得到了错误：

```
Traceback (most recent call last):
  File "...\main.py", line 8, in ?
    print(ctrl.div(5,2))
AttributeError: 'module' object has no attribute 'div' 
```

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T18:55:02.273

如图所示，这非常令人困惑。

当你说

```
from modules import controller 
```

您声称您有一个文件名为`modules.py`.

或者

您声称您有一个名为`modules`. 这个目录有一个`__init__.py`文件和一个文件名为的模块`controller.py`

你应该澄清这一点。看起来您在此处发布的示例代码中错误地命名了您的文件和模块。

当你说

```
from modules import controller 
```

这会创建一个*名为*`controller`.

当你说

```
ctrl = controller 
```

`controller` *这为模块*创建了另一个名称，`ctrl`.

任何时候都不要引用类 ( `controller.controller`)。您从未创建过类 ( `controller.controller()`) 的实例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T18:41:45.377

> ctrl = 控制器

'controller' 是一个模块，代表你的整个 'controller.py' 文件。在 Python 中，与 Java 不同，模块中可以定义任意数量的符号，因此导入的模块和其中定义的类之间没有 1:1 的关系。

所以脚本抱怨是因为“控制器”模块没有“div”功能；'div' 被定义为'controller' 模块*内的 'controller' 类的方法。*如果你想要一个 controller() 类的实例，你需要说：

```
ctrl= controller.controller() 
```

（还要注意 () 来实例化对象，否则您将获得类本身而不是实例。如果您确实想在类中定义一个静态方法以便可以在没有实例的情况下调用它，您可以这样做这使用'staticmethod'装饰器并省略'self'。）

通常最好用首字母大写来命名你的类以避免混淆：

```
class Controller(object):
    ...

ctrl= controller.Controller() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T18:40:47.533

您应该创建一个控制器实例，如下所示：

```
ctrl = controller() 
```

注意控制器后面的括号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T08:36:36.633

当您执行以下代码时

```
from modules import controller
ctrl = controller 
```

**ctrl**变量成为指向**控制器**类的指针。要创建**控制器**类的实例，您需要添加括号：

```
from modules import controller
ctrl = controller() 
```

# .net - XSL 样式表不会解析由 DataContractSerializer 生成的 XML

> ID：722641
> 
> 赞同：1
> 
> 时间：2009-04-06T18:37:49.630
> 
> 标签：.net, xslt, datacontractserializer

我使用 XMLSerializer 序列化了一些类，然后使用 XSLT 将其转换为各种格式的电子邮件或 Web 服务调用。一切都好。

我们开始在数据层的某些部分使用 Linq，我需要序列化一些 Linq 对象以供 XSL 样式表使用。我认为最好转向使用 DataContractSerializer 而不是 XMLSerializer。

我得到了 DataContracts 并设置了所有内容，并且通过对实体名称进行了一些小的更改来很好地序列化......但是现在样式表根本不会处理 XML。我真的不知道为什么我至少没有得到一些东西......基本上所有出来的都是从 xsl 标签中剥离的数据。

有什么想法会导致这种情况吗？

编辑：

```
<?xml version="1.0" encoding="UTF-8" ?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="CallTicket"> 
```

这是在我修改 DataContract 声明之前从 DataContractSerializer 生成的 XML：

```
<CallTicket xmlns="http://schemas.datacontract.org/2004/07/CRMInterface.CRMData" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T19:08:15.143

您很可能有命名空间问题。例如：

如果 XML 看起来像这样

`<Root xmls="http://www.example.org/1" ....`

`<test>one</test>`

然后你必须在 XSLT 中做两件事之一

专门引用命名空间并相应地使用前缀

```
<xsl:stylesheet xmlns:ex="http://www.example.org/1" ....>`
   ...

    <myTag><xsl:select value-of="//ex:test"/></myTag>` 
```

或者

如果只有一个命名空间，请将其设为 XSLT 文件的默认命名空间：

```
<xsl:stylesheet xmlns="http://www.example.com/1" ...`

...
   <myTag><xsl:select value-of="//test"/></myTag>` 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T18:50:55.683

会不会是您的新 XML 在其中包含 XML 名称空间，而您的 XSLT 没有正确处理？

您能否向我们展示您的 XML 和 XSLT 文件的相关部分？

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T18:58:35.710

我想我明白了，命名空间比我意识到的更重要。如果我为每个被序列化的类设置 DataContractAttribute(Namespace="") ，它就可以工作。我还有一些与 linq 实体有关的工作......但在正确的轨道上。

唯一让我感动的是 xslt 文件中没有对命名空间的引用......

# iphone - CGAffineTransformMakeRotation(RADIAN) 到底在做什么？

> ID：722643
> 
> 赞同：0
> 
> 时间：2009-04-06T18:38:57.163
> 
> 标签：iphone, core-animation

我真的不明白这个功能有什么用。有人可以解释一下（也许有一些例子）？

我可以用这个旋转 UIImageView 对象吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T19:19:06.053

CGAffineTransformMakeRotation 是一个构造函数，可以为您创建一个旋转矩阵，如 CGPointMake 或 NSMakePoint。有些函数需要你传入一个转换矩阵，比如：

```

无效 CGPathAddArc (
   CGMutablePathRef 路径，
   常量 CGAffineTransform *m,
   CGFloat x,
   CGF浮动 y,
   CGF浮动半径，
   CGFloat startAngle,
   CGFloat endAngle,
   顺时针布尔
);

```

您可以使用[UIGraphicsGetCurrentContext](https://developer.apple.com/documentation/uikit/1623918-uigraphicsgetcurrentcontext)获取[CGContextRef](https://developer.apple.com/documentation/coregraphics/cgcontextref)并根据需要转换/旋转上下文。

**更新**：您可以直接更改 UIView 的转换。它是一个属性：
@property(nonatomic) CGAffineTransform 变换。
感谢布拉德指出这一点。

# msbuild - 尝试使用 MSBuild 任务 来自 Microsoft.Sdc.Common.tasks

> ID：722646
> 
> 赞同：0
> 
> 时间：2009-04-06T18:40:08.767
> 
> 标签：msbuild, microsoft.sdc.tasks

我对 Xml.ModifyFile 任务有疑问，我不明白。你们能帮忙吗？

我的目标只是操作 xml 文档中的属性。

我对 xml 尤其是 msbuild 的世界相当陌生，因此我很难解释我收到的错误消息。在我看来，我的构建文件是有效的，所以我猜 sdc.tasks dll 文件有问题。

从构建文件中可以看出，为了测试，我添加了一个名为“ping”的目标。该目标与 sdc.task Ping 一起使用没有任何问题

你们能建议一个修复或替代解决方案来解决使用 msbuild 修改 xml 文件的挑战吗？

另一个问题 - 如何将多个命名空间声明为 Xml.ModifyFile sdc.task 的参数？namespace 属性的解释如下： *TaskItems 数组，指定“Prefix”和“Uri”属性，用于指定的 xPath*。我试图找到 taskitems 用法的解释或示例，但不幸的是没有任何运气。

谢谢/derdres

我将在下面列出以下内容：

1.  构建文件
2.  我尝试修改的 xml 文件
3.  错误信息

**1) 构建文件**

```
<Target Name="Go">
    <CallTarget Targets="modify"></CallTarget>
    <!--<CallTarget Targets="ping"></CallTarget>-->
</Target>

<Target Name="modify">
    <Xml.ModifyFile
        Path="C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\bookstore_adv.xml"
        AttributeName="age"
        Force="true"
        XPath="/bookstore/book[@id=2]/@age"
        NewValue="200"
        ShowMatches="Yes"
    >
    </Xml.ModifyFile>

    <Message Text="After modification"></Message>
</Target>

<!--<Target Name="ping">
    <Ping
           Machine="localhost"
           Count="2"
           Interval="1000"
           Timeout="3000"
           BufferSize="1024"
           AllowFragmentation="false"
           TimeToLive="128"
           StopOnSuccess="true"
           LogSuccess="true">
        <Output TaskParameter="FailureCount" PropertyName="FailedPingCount" />
        <Output TaskParameter="RoundTripTime" PropertyName="RoundTripDuration" />
    </Ping>
    <Message Text="FailedPingcount: $(FailedPingCount)"></Message>
    <Message Text="RoundTripDuration: $(RoundTripDuration)"></Message>
</Target>--> 
```

**2）xml文件**

```
<?xml version="1.0" encoding="utf-8"?>
<!--<bookstore xmlns:hat="www.google.dk/hat" xmlns:briller="www.google.dk/briller">-->
<!--<bookstore xmlns:hat="www.google.dk/hat">-->
<bookstore>
   <book id="1">
        <title>Harry Potter</title>
        <author>Rowling</author>
   </book>
   <book id="2" age="100">
       <title>Lykke Per</title>
       <author>Pontoppidan</author>
   </book> 
```

**3) 构建错误信息**

```
Build FAILED.

"C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj" (default target) (1) ->
(modify target) ->
  C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : A task error has occured.\r 
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : Message            = Object reference not set to
 an instance of an object.\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : Action             = Replace\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : Path               = C:\Users\Andreas\Desktop\MS
Build\Test_05_april\Test01\bookstore_advanced.xml\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : Namespace          = <null>\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : XPath              = /bookstore/book[@id=2]/@age
\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : RegularExpression  = <String.Empty>\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : NewValue           = 200\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : AttributeName      = age\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : Force              = True\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : TreatNewValueAsXml = False\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : ShowMatches        = Yes\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error : \r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error :    at Microsoft.Sdc.Tasks.Xml.ModifyFile.Interna
lExecute() in c:\projects\codeplex\sdctasks\Solutions\Main\Tasks\Xml\ModifyFile.cs:line 346\r
C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\Deploy.proj(11,9): error :    at Microsoft.Sdc.Tasks.TaskBase.Execute() in
c:\projects\codeplex\sdctasks\Solutions\Main\Tasks\TaskBase.cs:line 66

    0 Warning(s)
    1 Error(s)

Time Elapsed 00:00:00.20 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T06:21:06.350

在您的 XPath 中，您正在搜索属性年龄`/bookstore/book[@id=2]/@age`，但在您的任务中，您将 AttributeName 设置为“年龄”。所以这就像你想要属性年龄的属性年龄。

您只需要更改您的 XPath 以`/bookstore/book[@id=2]`使其工作。

```
<Target Name="modify">
  <Xml.ModifyFile
    Path="C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\bookstore_adv.xml"
    AttributeName="age"
    Force="true"
    XPath="/bookstore/book[@id=2]"
    NewValue="200"
    ShowMatches="Yes">
  </Xml.ModifyFile>

  <Message Text="After modification"/>
</Target> 
```

如何将多个命名空间声明为 Xml.ModifyFile sdc.task 的参数？

```
<ItemGroup>
  <Namespace Include="www.google.dk/briller">
    <Prefix>briller</Prefix>
    <Uri>www.google.dk/briller</Uri>
  </Namespace>
  <Namespace Include="www.google.dk/hat">
    <Prefix>hat</Prefix>
    <Uri>www.google.dk/hat</Uri>
  </Namespace>
</ItemGroup>

<Target Name="modify">
  <Xml.ModifyFile
    Path="C:\Users\Andreas\Desktop\MSBuild\Test_05_april\Test01\bookstore_adv.xml"
    AttributeName="age"
    Force="true"
    XPath="/bookstore/book[@id=2]"
    NewValue="200"
    ShowMatches="Yes"
    Namespace="@(Namespace)">
  </Xml.ModifyFile>

  <Message Text="After modification"/>
</Target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-27T11:26:30.960

您的 XML 文件无效。我在我的机器上试过了，效果很好。

只需关闭**书店**标签。

# vbscript - 显示操作系统的时间和显示恢复选项的时间

> ID：722647
> 
> 赞同：0
> 
> 时间：2009-04-06T18:40:09.047
> 
> 标签：vbscript, batch-file, operating-system

我真的很喜欢自动化事情，让我自己的生活更轻松。我试过在这个网站上四处看看，也只是在谷歌上搜索我的问题，但没有任何东西能指出我正确的方向。所以这是我的问题。我想：

1.  禁用（又名取消选中）显示操作系统列表的时间。
2.  将需要时显示恢复选项的时间设置为 3 秒。

如果可以在 vbscript 或批处理文件中实现这一点，那就太好了。我将继续我自己的搜索，但如果有人能提供帮助，那就太好了。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T19:03:28.117

bcdedit 是 Vista 上修改启动项的工具。

[http://technet.microsoft.com/en-us/library/cc721886.aspx](http://technet.microsoft.com/en-us/library/cc721886.aspx)是一个 bcdedit 常见问题解答。

```
bcdedit /timeout 0 
```

应该有效地禁用操作系统选择屏幕。

我不知道如何将恢复选项设置为 3 秒，您可以通过启动和恢复 UI 执行此操作，但通过 bcdedit 没有明确的方法。

# css - CSS 适当的方式来居中内容

> ID：722648
> 
> 赞同：5
> 
> 时间：2009-04-06T18:40:23.820
> 
> 标签：css, css-float, html-table

我更喜欢使用基于 CSS 的设计，但作为后端编码人员，我的 CSS 技能有点弱。当我参与布局时，我倾向于使用基于表格的格式，因为多年来基于表格的滥用已经扭曲了我的思想。我总是遇到一个特殊的问题。什么是最好的 CSS 替代品：

```
<table width="100%">
    <tr>
        <td align="center">
            content goes here
        </td>
    </tr>
</table> 
```

我有时会使用：

```
<div style="width:100%; text-align:center">content</div> 
```

但这似乎不太正确。我不是要对齐文本，而是要对齐内容。此外，这似乎对封闭元素的文本对齐有影响，需要调整才能修复。我不明白的一件事是：为什么没有 float:center 样式？似乎这将是最好的解决方案。希望我遗漏了一些东西，并且有一种完美的 CSS 方法可以做到这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-06T19:07:08.047

你是对的，`text-align`用于对齐文本。实际上，只有 Internet Explorer 可以让您将文本以外的任何内容居中。任何其他浏览器都可以正确处理这个问题，并且不会让块元素受到`text-align`.

要使用 css 居中块元素，您可以`margin: 0 auto;`按照 Joe Philllips 的建议使用。尽管您根本不需要保留桌子。

没有的原因`float: center;`是浮动旨在将元素（通常是图像）放置在左侧或右侧，并让文本在它们周围流动。在这种情况下，在中心浮动一些东西没有意义，因为这意味着文本必须在元素的两侧流动。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-06T18:43:22.597

我建议将 a`<div>`放入您的`<td>`并将样式属性设置为`style="width: 200px; margin: 0 auto;"`

问题是你必须设置一个固定的宽度。

**编辑：** 再次查看问题后，我建议完全废弃该表。只需`<div style="width: 200px; margin: 0 auto;>`按照我的建议使用 a 即可，不需要表格。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-06T19:11:32.247

这是使用 CSS 居中的一个很好的资源。
[http://www.w3.org/Style/Examples/007/center](http://www.w3.org/Style/Examples/007/center)
这演示了如何将文本、块、图像居中以及如何将它们垂直居中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T18:58:17.663

你在哪里发现自己经常这样做？对我来说 - 我经常尝试将网站的整个设计置于中心位置，所以我通常这样做：

```
<html>
  <body>
  <div id="wrapper">
    <div id="header">
    </div>
    <div id="content">
    </div>
    <div id="footer">
    </div>
  </div>
  </body>
</html>

body {text-align:center;}
#wrapper {margin:0 auto; text-align:left; width:980px;} 
```

这将使整个设计在页面上以 980px 宽度居中，同时仍然使所有文本左对齐（只要该文本在`#wrapper`元素内）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-20T22:04:34.413

用于`display:inline-block`启用`text-align:center`和居中没有固定宽度的内容：

```
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Centering</title>

  <style type="text/css">
  .container { text-align:center; }

  /* Percentage width */
  .wrapper { width: 99%; }

  /* Use inline-block for wrapper */
  .wrapper { display: inline-block; }

  /* Use inline for content */
  .content { display:inline; }
  </style> 

</head>
<body>
  <div class="container">
    <div class="content">
        <div class="wrapper">
            <div>abc</div>
            <div>xyz</div>
        </div>
    </div>
  </div>
</body>
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T18:50:33.500

d03boy 的答案是正确的以正确的方式将事物居中。

要回答您的其他评论，“此外，这似乎对封闭元素的文本对齐有影响，这需要调整才能修复。” 这就是 CSS 工作方式的本质，在元素上设置属性会影响其所有子元素，除非该属性被其中一个覆盖（当然，假设该属性是被[继承](http://www.w3.org/TR/CSS21/cascade.html#inheritance)的）。

# objective-c - 如何在 Objective-C 中传递多个参数？

> ID：722651
> 
> 赞同：189
> 
> 时间：2009-04-06T18:41:36.877
> 
> 标签：objective-c, syntax, parameters, methods

我已经阅读了几篇关于 Objective-C 方法语法的文章，但我想我不理解一个方法的多个名称。

我正在尝试创建一个`getBusStops`使用`NSString`和`NSTimeInterval`参数调用的方法，返回类型为`NSMutableArray`. 这就是我构造该方法的方式，但它显然在运行时会出错：

```
- (NSMutableArray *)getBusStops:(NSString *)busStop
                                (NSTimeInterval *)timeInterval; 
```

我看到了另一个带有方法的示例：

```
-(NSInteger)pickerView:(UIPickerView *)pickerView
            numberOfRowsInComponent:(NSInteger)component 
```

我不明白为什么这个方法对每个参数都有一个方法名称。我应该对类似的东西做同样的事情：

```
- (NSMutableArray *)getBusStops:(NSString *)busStop
                        forTime:(NSTimeInterval *)timeInterval 
```

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2009-04-06T18:50:46.557

您至少需要用“：”分隔每个参数名称。从技术上讲，该名称是可选的，但为了便于阅读，建议使用该名称。所以你可以写：

```
- (NSMutableArray*)getBusStops:(NSString*)busStop :(NSTimeInterval*)timeInterval; 
```

或您的建议：

```
- (NSMutableArray*)getBusStops:(NSString*)busStop forTime:(NSTimeInterval*)timeInterval; 
```

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2009-04-06T19:00:02.463

Objective-C 没有命名参数，因此冒号左侧的所有内容都是方法名称的一部分。例如，

```
getBusStops: forTime: 
```

是方法的名称。该名称已分解，因此可以更具描述性。你可以简单地命名你的方法

```
getBusStops: : 
```

但这并没有告诉你太多关于第二个参数的信息。

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2009-04-06T19:08:42.910

是的; 出于几个原因，Objective-C 方法语法是这样的；其中之一是为了清楚您指定的参数是什么。例如，如果您要`NSMutableArray`在某个索引处添加一个对象，您可以使用以下方法：

```
- (void)insertObject:(id)anObject atIndex:(NSUInteger)index; 
```

调用此方法`insertObject:atIndex:`，很明显正在将对象插入到指定的索引处。

在实践中，添加一个字符串“Hello, World!” `NSMutableArray`在被调用的索引 5 处，`array`将按如下方式调用：

```
NSString *obj = @"Hello, World!";
int index = 5;

[array insertObject:obj atIndex:index]; 
```

这也减少了方法参数顺序之间的歧义，确保您首先传递对象参数，*然后*是索引参数。这在使用带有大量参数的函数时变得更加有用，并减少了传递参数时的错误。

此外，方法命名约定是因为 Objective-C 不支持重载；但是，如果您想编写一个执行相同工作但采用不同数据类型的方法，则可以做到这一点；以`NSNumber`班级为例；this 有几种对象创建方法，包括：

*   `+ (id)numberWithBool:(BOOL)value;`
*   `+ (id)numberWithFloat:(float)value;`
*   `+ (id)numberWithDouble:(double)value;`

在诸如 C++ 之类的语言中，您只需重载 number 方法以允许将不同的数据类型作为参数传递；但是，在 Objective-C 中，这种语法允许通过更改函数的每个变体的方法名称来实现同一函数的多个不同变体。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-04-06T19:34:28.200

每个参数之前的文本是方法名称的**一部分**。从您的示例中，该方法的名称实际上是

```
-getBusStops:forTime: 
```

每个 : 代表一个参数。在方法调用中，方法名称在 :s 处拆分，参数出现在 :seg 之后

```
[getBusStops: arg1 forTime: arg2] 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2015-10-14T08:14:36.040

对于创建方法：

```
-(void)mymethods:(NSString *)aCont withsecond:(NSString *)a-second {
//method definition...
} 
```

调用方法：

```
[mymethods:self.contoCorrente withsecond:self.asecond]; 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2016-05-28T19:51:25.530

```
(int) add: (int) numberOne plus: (int) numberTwo ;
(returnType) functionPrimaryName : (returnTypeOfArgumentOne) argumentName functionSecondaryNa 
```

我：

```
(returnTypeOfSecontArgument) secondArgumentName ; 
```

与其他语言一样，我们使用以下语法 void`add(int one, int second)` 但分配参数的方式与`OBJ_c`上述不同

# asp.net-mvc - ASP.NET MVC Html.RadioButton 异常

> ID：722655
> 
> 赞同：16
> 
> 时间：2009-04-06T18:42:04.330
> 
> 标签：asp.net-mvc

我的页面上有一个简单的单选按钮列表，在我的视图中呈现以下内容：

```
<label for="gender">Gender</label>
<%= Html.RadioButton("gender", 1) %> Male
<%= Html.RadioButton("gender", 2) %> Female
<%= Html.ValidationMessage("gender") %> 
```

请注意，当用户最初看到此输入时，没有选择任何按钮。验证是为了迫使他们选择而不接受默认值。因此，这两个单选按钮绑定到我的模型中的一个可为空的 int 属性，声明为：

```
public int? gender { get; set; } 
```

因此，如果他们没有选择按钮并提交页面，则性别属性将为空，表示他们没有选择。控制器在发布期间调用以下验证：

```
if (!gender.HasValue)
    ModelState.AddModelError("gender", "gender required"); 
```

但是，如果验证失败（他们没有选择），那么在渲染阶段，MVC 框架会抛出以下异常：

```
System.NullReferenceException was unhandled by user code
  Message="Object reference not set to an instance of an object." 
```

在寻找解决这个问题的方法时，我注意到有几个有这个问题。我正在使用 ASP.NET MVC 1.0。我在代码中找到了使用 .NET Reflector 引发此错误的位置。

问题是如何使这项工作正常工作？

编辑：添加堆栈跟踪：

```
System.NullReferenceException was unhandled by user code
  Message="Object reference not set to an instance of an object."
  Source="System.Web.Mvc"
  StackTrace:
       at System.Web.Mvc.HtmlHelper.GetModelStateValue(String key, Type destinationType)
       at System.Web.Mvc.Html.InputExtensions.InputHelper(HtmlHelper htmlHelper, InputType inputType, String name, Object value, Boolean useViewData, Boolean isChecked, Boolean setId, Boolean isExplicitValue, IDictionary`2 htmlAttributes)
       at System.Web.Mvc.Html.InputExtensions.RadioButton(HtmlHelper htmlHelper, String name, Object value, Boolean isChecked, IDictionary`2 htmlAttributes)
       at System.Web.Mvc.Html.InputExtensions.RadioButton(HtmlHelper htmlHelper, String name, Object value, IDictionary`2 htmlAttributes)
       at System.Web.Mvc.Html.InputExtensions.RadioButton(HtmlHelper htmlHelper, String name, Object value)
       at ASP.views_vbs_register_aspx.__RenderregisterContent(HtmlTextWriter __w, Control parameterContainer) in c:\Users\David\Documents\BellevueProject\Bellevue\BellevueTeachers\Forms\Views\VBS\Register.aspx:line 42 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-06T18:43:02.067

我只是尝试了一些使这项工作有效的方法。如果我不执行验证步骤，则不会出现问题，但我当然需要验证。这给了我解决方案的线索。

ValidationMessage HtmlHelper 方法采用字符串参数，该参数是要验证的属性或模型对象的名称。我刚刚将该名称更改为“gender2”，如下所示：

```
<label for="gender">Gender</label>
<%= Html.RadioButton("gender", 1) %> Male
<%= Html.RadioButton("gender", 2) %> Female
<%= Html.ValidationMessage("gender2") %> 
```

我更改了验证代码以引用这个新名称（即使该属性不存在，它仍然有效）：

```
if (!gender.HasValue)
    ModelState.AddModelError("gender2", "gender required"); 
```

这可以按需要工作。

我原以为另一个应该可以工作，但这是一个简单的解决方法，我在这里记录。

编辑：顺便说一句，我尝试将性别属性更改为字符串而不是可为空的 int，并且发生了同样的问题。

解决方法似乎仍然是为验证消息使用不同的键名。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-05T09:09:55.357

这非常相似，如果不等于复选框问题： Html.Checkbox() 辅助方法会生成一个带有 false 值的隐藏字段。如果缺少此字段，浏览器将不会为未选中的框发送任何数据。

然而，单选按钮应该有一个值，并且可能的值可以不止一个。在这种情况下，处理非选择情况并不容易，我想这就是它不是这样的原因。

我的解决方法是添加一个隐藏字段，如下所示：

```
<%= Html.RadioButton("gender", 1) %> Male
<%= Html.RadioButton("gender", 2) %> Female
<%= Html.Hidden("gender", null) %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T19:21:11.150

您可能想尝试将性别更改为字符串 (M/F) 而不是 int，看看是否可行。

如果你绝对必须将它作为一个 int，你总是可以在后端进行翻译。

```
private int? gender { get; set; }
public string displayGender
{
    get
    {
        return this.gender.HasValue
                 ? (this.gender.Value == 1 ? "M" : "F" )
                 : null;
    }
    set
    {
        this.gender = null;
        if (value == "M")
           this.gender = 1;
        else if (value == "F")
           this.gender = 2;
    }
}

<label for="gender">Gender</label>
<%= Html.RadioButton("displayGender", "M") %> Male
<%= Html.RadioButton("displayGender", "F") %> Female
<%= Html.ValidationMessage("displayGender") %> 
```

根据您的评论，您可能需要添加：

```
<%= Html.RadioButton("displayGender",
                     string.Empty,
                     true, // this is the default
                     new { @style = "display: none;" } ) %> 
```

这将确保 displayGender 被回发（总会有一个选择的收音机），我认为该值将是 string.Empty 而不是空引用。如果这可行，您可能想尝试切换回可为空的 int。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T01:02:21.890

尝试在 之后添加以下代码行`ModelState.AddModelError()`：

```
ModelState.SetModelValue("gender", ValueProvider["gender"]); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-01T16:39:20.027

如果您想连接客户端验证。跳过 html 帮助程序并手写您的收音机，为它们提供 data-val 和 data-val-required 的属性。像这样。

```
 <input type="radio" name="displayGender" id="displayGender" value="1" data-val="true" data-val-required ="The gender field is required."/>
    <input type="radio" name="displayGender" id="displayGender" value="2" data-val="true" data-val-required ="The gender field is required."/> 
```

# c# - 当滚动条动态增长时，如何设置滚动条的值？

> ID：722661
> 
> 赞同：1
> 
> 时间：2009-04-06T18:43:02.457
> 
> 标签：c#, winforms

我将从我想要发生的事情开始：

我在一个范围内加载了数据，比如说，一直向左滚动让我在 4 月 1 日，而一直向右滚动让我在 6 月 1 日。

用户将滚动条定位在 4 月 1 日，然后单击滚动条上的左箭头。现在滚动条定位在 3 月 31 日，数据范围现在跨度从 3 月 1 日到 6 月 1 日。

这是我的问题：

我一直在处理 Scroll 事件处理程序中的左箭头单击（大致如下）：

```
private void horizontalScroll_Scroll(object sender, ScrollEventArgs e)
{
    if (LeftArrowClicked())
    {
        horizontalScroll.Maximum = calculateNewMaximum(earliestDate, latestDate);
        horizontalScroll.Value = calculateNewPosition(currentDate.AddDays(-1), earliestDate);
    }
} 
```

调试器单步执行，离开此事件处理程序的那一刻，horizo​​ntalScroll.Value 下降到 0，而 Horizo​​ntalScroll.Maximum 保持在正确的值。

我稍后会回复任何澄清和问题的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T19:08:18.263

尝试设置`e.NewValue`而不是`horizontalScroll.Value`. 然后，控件在执行其自己的逻辑时将尊重该值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T18:55:39.947

这显然是由在事件触发`ScrollableControl`后设置值引起的。`Scroll`您可以尝试扩展您正在使用的控件并覆盖`OnScroll`虚拟方法。

```
protected override void OnScroll(ScrollEventArgs se)
{
  base.OnScroll(se);

  // Do stuff now
} 
```

* * *

### 编辑

您可能应该知道单击滚动条的按钮不会引发`Scroll`事件，它只会引发`ValueChanged`事件。（虽然使用鼠标会生成两者。）

* * *

### 再次编辑

啊哈！我知道有办法做到这一点。你想做什么而不是改变`horizontalScroll.Value`，你想设置`NewValue`on`ScrollEventArgs`参数。这应该有效：

```
private void horizontalScroll_Scroll(object sender, ScrollEventArgs e)
{
    if (LeftArrowClicked())
    {
        horizontalScroll.Maximum = calculateNewMaximum(earliestDate, latestDate);
        e.NewValue = calculateNewPosition(currentDate.AddDays(-1), earliestDate);
    }
} 
```

# erlang - 在 mnesia 集群中，查询哪个节点？

> ID：722665
> 
> 赞同：13
> 
> 时间：2009-04-06T18:43:26.560
> 
> 标签：erlang, mnesia

假设您在节点 A 和 B 上复制了一个 mnesia 表。如果在节点 C 上不包含表的副本，我会这样做`mnesia:change_config(extra_db_nodes, [NodeA, NodeB])`，然后在节点 CI 上执行`mnesia:dirty_read(user, bob)`节点 C 如何选择要复制到哪个节点的表副本执行查询？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-07T15:23:55.017

根据我自己对这个问题的研究答案是 - 它将选择**最近连接的节点**。如果发现错误，我将不胜感激 - mnesia 是一个非常复杂的系统！

正如[Dan Gudmundsson 指出](http://www.nabble.com/In-a-mnesia-cluster,-which-node-is-queried--td22920996.html)的，选择要查询的远程节点的邮件列表算法在`mnesia_lib:set_remote_where_to_read/2`. 如下

```
set_remote_where_to_read(Tab, Ignore) ->
    Active = val({Tab, active_replicas}),
    Valid =
       case mnesia_recover:get_master_nodes(Tab) of
           [] ->  Active;
           Masters -> mnesia_lib:intersect(Masters, Active)
       end,
    Available = mnesia_lib:intersect(val({current, db_nodes}), Valid -- Ignore),
    DiscOnlyC = val({Tab, disc_only_copies}),
    Prefered  = Available -- DiscOnlyC,
    if
       Prefered /= [] ->
           set({Tab, where_to_read}, hd(Prefered));
       Available /= [] ->
           set({Tab, where_to_read}, hd(Available));
       true ->
           set({Tab, where_to_read}, nowhere)
    end. 
```

因此它获取 active_replicas 列表（即候选列表），可选择将列表缩小到表的主节点，删除要忽略的表（出于任何原因），将列表缩小到当前连接的节点，然后按以下顺序选择：

1.  第一个非`disc_only_copies`
2.  任何可用节点

最重要的部分实际上是 的列表`active_replicas`，因为它决定了候选列表中节点的顺序。

List of`active_replicas`是通过`mnesia_controller:add_active_replica/*`从新连接的节点到旧节点（即以前在集群中的节点）的远程调用形成的，这归结为`add/1`将项目添加为列表头部的函数。

因此**问题的答案是**- 它将选择**最近连接的节点**。

注意：要查看给定节点上的活动副本列表，您可以使用此（脏黑客）代码：

```
[ {T,X} || {{T,active_replicas}, X} <- ets:tab2list(mnesia_gvar) ]. 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-07T13:26:46.657

那么，节点 C 需要联系节点 A 或节点 B 才能进行查询。因此节点 C 必须自己决定在哪个表副本上执行查询。

如果你需要更多的东西，你要么需要一些算法来决定在哪个节点上查询，或者甚至在节点 C 上复制表（这通常取决于你想要/需要什么样的特征）。

如果节点 A 和节点 B 形成数据库集群或它们是数据库集群的一部分，那么一个好的开始可能是循环算法（或随机算法，如您所建议的）。

# ruby-on-rails - 为数据库中的多个客户端创建“围墙花园”的最佳方法是什么？

> ID：722667
> 
> 赞同：10
> 
> 时间：2009-04-06T18:44:26.243
> 
> 标签：ruby-on-rails, ruby, activerecord

我正在建立一个 SaaS 风格的网站，其中我将有多个客户在同一个站点上管理他们的工作流和数据——因此是同一个数据库。

我什至不确定这个概念是否有一个词，但是是否有任何已建立的自动隔离数据的方法，以便对数据库的任何 ActiveRecord 调用都被登录用户的正确 client_id 过滤/限制?

最直接的方法当然是`where client_id = ?`在每个 ActiveRecord 请求的末尾添加一个“”并将用户的客户端 ID...

模型是否有任何前置过滤器的想法，以便任何查找方法（包括动态方法）都会`client_id`自动附加到它们？所以我可以这样做`Model.find_by_what_I_want(foo)`，它会自动知道将其限制为仅由正确的客户端 ID 拥有的记录，即使我没有明确指定它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-06T18:54:43.850

如果您使用的是 Rails 2.3+，则可以使用默认范围：

```
class Model < ActiveRecord::Base
  default_scope :conditions => ['client_id = ?', client_id]
end 
```

您必须确保 client_id 在初始化过程中的某个位置设置。

这将确保该模型中的所有数据库查询都使用 client_id 条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-04T17:57:16.877

为每个客户添加一个新数据库怎么样？通过这种方式，客户的分离更加具体，并且客户可能与其他客户的数据发生错误的可能性较小。

# javascript - 使用 JavaScript 遍历 JSON 对象树的所有节点

> ID：722668
> 
> 赞同：168
> 
> 时间：2009-04-06T18:45:16.150
> 
> 标签：javascript, json

我想遍历 JSON 对象树，但找不到任何库。这似乎并不困难，但感觉就像重新发明轮子。

在 XML 中，有很多教程展示了如何使用 DOM 遍历 XML 树 :(

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2009-04-06T19:05:55.677

如果你认为 jQuery 对于这样一个原始任务来说有点**矫枉过正**，你可以这样做：

```
//your object
var o = { 
    foo:"bar",
    arr:[1,2,3],
    subo: {
        foo2:"bar2"
    }
};

//called with every property and its value
function process(key,value) {
    console.log(key + " : "+value);
}

function traverse(o,func) {
    for (var i in o) {
        func.apply(this,[i,o[i]]);  
        if (o[i] !== null && typeof(o[i])=="object") {
            //going one step down in the object tree!!
            traverse(o[i],func);
        }
    }
}

//that's all... no magic, no bloated framework
traverse(o,process); 
```

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-04-06T18:47:07.940

JSON 对象只是一个 Javascript 对象。这实际上就是 JSON 的含义：JavaScript Object Notation。因此，您将遍历一个 JSON 对象，但是您通常会选择“遍历”一个 Javascript 对象。

在 ES2017 中，你会这样做：

```
Object.entries(jsonObj).forEach(([key, value]) => {
    // do something with key and val
}); 
```

您始终可以编写一个函数以递归方式下降到对象中：

```
function traverse(jsonObj) {
    if( jsonObj !== null && typeof jsonObj == "object" ) {
        Object.entries(jsonObj).forEach(([key, value]) => {
            // key is either an array index or object key
            traverse(value);
        });
    }
    else {
        // jsonObj is a number or string
    }
} 
```

这应该是一个很好的起点。我强烈建议对此类事情使用现代 javascript 方法，因为它们使编写此类代码变得更加容易。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2012-01-24T12:34:35.287

```
function traverse(o) {
    for (var i in o) {
        if (!!o[i] && typeof(o[i])=="object") {
            console.log(i, o[i]);
            traverse(o[i]);
        } else {
            console.log(i, o[i]);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2011-06-17T20:41:55.543

有一个用于使用支持许多不同用例的 JavaScript 遍历 JSON 数据的新库。

[https://npmjs.org/package/traverse](https://npmjs.org/package/traverse)

[https://github.com/substack/js-traverse](https://github.com/substack/js-traverse)

它适用于各种 JavaScript 对象。它甚至可以检测周期。

它也提供了每个节点的路径。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2017-08-11T06:33:11.360

# 原始简化答案

如果您不介意放弃 IE 并主要支持更多当前的浏览器（请查看[kangax 的 es6 表](http://kangax.github.io/compat-table/es6/)以了解兼容性），请使用更新的方法。您可以为此使用 es2015[生成器](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators)。我已经相应地更新了@TheHippo 的答案。当然，如果你真的想要 IE 支持，你可以使用[babel](https://babeljs.io/) JavaScript 转译器。

```
// Implementation of Traverse
function* traverse(o, path=[]) {
    for (var i in o) {
        const itemPath = path.concat(i);
        yield [i,o[i],itemPath,o];
        if (o[i] !== null && typeof(o[i])=="object") {
            //going one step down in the object tree!!
            yield* traverse(o[i], itemPath);
        }
    }
}

// Traverse usage:
//that's all... no magic, no bloated framework
for(var [key, value, path, parent] of traverse({ 
    foo:"bar",
    arr:[1,2,3],
    subo: {
        foo2:"bar2"
    }
})) {
  // do something here with each key and value
  console.log(key, value, path, parent);
}
```

如果您只想要自己的可枚举属性（基本上是非原型链属性），您可以将其更改为使用[`Object.keys`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)和[`for...of`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of)循环进行迭代：

```
function* traverse(o,path=[]) {
    for (var i of Object.keys(o)) {
        const itemPath = path.concat(i);
        yield [i,o[i],itemPath,o];
        if (o[i] !== null && typeof(o[i])=="object") {
            //going one step down in the object tree!!
            yield* traverse(o[i],itemPath);
        }
    }
}

//that's all... no magic, no bloated framework
for(var [key, value, path, parent] of traverse({ 
    foo:"bar",
    arr:[1,2,3],
    subo: {
        foo2:"bar2"
    }
})) {
  // do something here with each key and value
  console.log(key, value, path, parent);
}
```

**编辑**：这个编辑的答案解决了无限循环遍历。

# 停止讨厌的无限对象遍历

这个编辑后的答案仍然提供了我原来的答案的额外好处之一，它允许您使用提供的[生成器函数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators)来使用更清洁和简单的[可迭代接口](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols)（考虑使用`for of`循环，因为`for(var a of b)`where`b`是可迭代的并且`a`是可迭代的元素）。通过使用生成器函数以及作为一个更简单的 api，它还有助于代码重用，因此您不必在任何想要深入迭代对象属性的地方重复迭代逻辑，并且还`break`可以如果您想提前停止迭代，请使用循环。

我注意到尚未解决且不在我的原始答案中的一件事是，您应该小心遍历任意（即任何“随机”组）对象，因为 JavaScript 对象可以是自引用的。这创造了无限循环遍历的机会。然而，未修改的 JSON 数据不能自引用，所以如果您使用这个特定的 JS 对象子集，您不必担心无限循环遍历，您可以参考我的原始答案或其他答案。这是一个非结束遍历的示例（注意它不是一段可运行的代码，否则它会导致您的浏览器选项卡崩溃）。

同样在我编辑的示例中的生成器对象中，我选择使用它`Object.keys`而不是`for in`仅迭代对象上的非原型键。如果您想要包含原型键，您可以自己换掉它。请参阅下面我的原始答案部分，了解 和 的`Object.keys`实现`for in`。

## 更糟糕的是 - 这将在自引用对象上无限循环：

```
function* traverse(o, path=[]) {
    for (var i of Object.keys(o)) {
        const itemPath = path.concat(i);
        yield [i,o[i],itemPath, o]; 
        if (o[i] !== null && typeof(o[i])=="object") {
            //going one step down in the object tree!!
            yield* traverse(o[i], itemPath);
        }
    }
}

//your object
var o = { 
    foo:"bar",
    arr:[1,2,3],
    subo: {
        foo2:"bar2"
    }
};

// this self-referential property assignment is the only real logical difference 
// from the above original example which ends up making this naive traversal 
// non-terminating (i.e. it makes it infinite loop)
o.o = o;

//that's all... no magic, no bloated framework
for(var [key, value, path, parent] of traverse(o)) {
  // do something here with each key and value
  console.log(key, value, path, parent);
} 
```

为了避免这种情况，您可以在闭包中添加一个集合，以便在第一次调用该函数时，它开始构建它所看到的对象的内存，并且一旦遇到已经看到的对象就不会继续迭代。下面的代码片段可以做到这一点，从而处理无限循环的情况。

## 更好 - 这不会在自引用对象上无限循环：

```
function* traverse(o) {
  const memory = new Set();
  function * innerTraversal (o, path=[]) {
    if(memory.has(o)) {
      // we've seen this object before don't iterate it
      return;
    }
    // add the new object to our memory.
    memory.add(o);
    for (var i of Object.keys(o)) {
      const itemPath = path.concat(i);
      yield [i,o[i],itemPath, o]; 
      if (o[i] !== null && typeof(o[i])=="object") {
        //going one step down in the object tree!!
        yield* innerTraversal(o[i], itemPath);
      }
    }
  }
  yield* innerTraversal(o);
}

//your object
var o = { 
  foo:"bar",
  arr:[1,2,3],
  subo: {
    foo2:"bar2"
  }
};

/// this self-referential property assignment is the only real logical difference 
// from the above original example which makes more naive traversals 
// non-terminating (i.e. it makes it infinite loop)
o.o = o;

console.log(o);
//that's all... no magic, no bloated framework
for(var [key, value, path, parent] of traverse(o)) {
  // do something here with each key and value
  console.log(key, value, path, parent);
}
```

* * *

**编辑**：此答案中的所有上述示例都已被编辑，以包括根据[@supersan 的请求](https://stackoverflow.com/questions/722668/traverse-all-the-nodes-of-a-json-object-tree-with-javascript/45628445?noredirect=1#comment99213157_45628445)从迭代器产生的新路径变量。path 变量是一个字符串数组，其中数组中的每个字符串代表每个键，这些键被访问以从原始源对象获取结果迭代值。路径变量可以输入[lodash 的 get function/method](https://lodash.com/docs#get)。或者你可以编写你自己的 lodash 的 get 版本，它只处理这样的数组：

```
function get (object, path) {
  return path.reduce((obj, pathItem) => obj ? obj[pathItem] : undefined, object);
}

const example = {a: [1,2,3], b: 4, c: { d: ["foo"] }};
// these paths exist on the object
console.log(get(example, ["a", "0"]));
console.log(get(example, ["c", "d", "0"]));
console.log(get(example, ["b"]));
// these paths do not exist on the object
console.log(get(example, ["e", "f", "g"]));
console.log(get(example, ["b", "f", "g"]));
```

你也可以像这样设置一个函数：

```
function set (object, path, value) {
    const obj = path.slice(0,-1).reduce((obj, pathItem) => obj ? obj[pathItem] : undefined, object)
    if(obj && obj[path[path.length - 1]]) {
        obj[path[path.length - 1]] = value;
    }
    return object;
}

const example = {a: [1,2,3], b: 4, c: { d: ["foo"] }};
// these paths exist on the object
console.log(set(example, ["a", "0"], 2));
console.log(set(example, ["c", "d", "0"], "qux"));
console.log(set(example, ["b"], 12));
// these paths do not exist on the object
console.log(set(example, ["e", "f", "g"], false));
console.log(set(example, ["b", "f", "g"], null));
```

**编辑 2020 年 9 月**：我添加了一个父对象，以便更快地访问上一个对象。这可以让您更快地构建反向遍历器。您也可以随时修改遍历算法以进行广度优先搜索而不是深度优先搜索，这实际上可能更可预测，事实上这是[一个带有广度优先搜索的 TypeScript 版本](https://codesandbox.io/s/object-traversal-jes83)。由于这是一个 JavaScript 问题，我将把 JS 版本放在这里：

```
var TraverseFilter;
(function (TraverseFilter) {
    /** prevents the children from being iterated. */
    TraverseFilter["reject"] = "reject";
})(TraverseFilter || (TraverseFilter = {}));
function* traverse(o) {
    const memory = new Set();
    function* innerTraversal(root) {
        const queue = [];
        queue.push([root, []]);
        while (queue.length > 0) {
            const [o, path] = queue.shift();
            if (memory.has(o)) {
                // we've seen this object before don't iterate it
                continue;
            }
            // add the new object to our memory.
            memory.add(o);
            for (var i of Object.keys(o)) {
                const item = o[i];
                const itemPath = path.concat([i]);
                const filter = yield [i, item, itemPath, o];
                if (filter === TraverseFilter.reject)
                    continue;
                if (item !== null && typeof item === "object") {
                    //going one step down in the object tree!!
                    queue.push([item, itemPath]);
                }
            }
        }
    }
    yield* innerTraversal(o);
}
//your object
var o = {
    foo: "bar",
    arr: [1, 2, 3],
    subo: {
        foo2: "bar2"
    }
};
/// this self-referential property assignment is the only real logical difference
// from the above original example which makes more naive traversals
// non-terminating (i.e. it makes it infinite loop)
o.o = o;
//that's all... no magic, no bloated framework
for (const [key, value, path, parent] of traverse(o)) {
    // do something here with each key and value
    console.log(key, value, path, parent);
}
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2009-04-06T19:06:59.717

取决于你想做什么。这是一个遍历 JavaScript 对象树、打印键和值的示例：

```
function js_traverse(o) {
    var type = typeof o 
    if (type == "object") {
        for (var key in o) {
            print("key: ", key)
            js_traverse(o[key])
        }
    } else {
        print(o)
    }
}

js> foobar = {foo: "bar", baz: "quux", zot: [1, 2, 3, {some: "hash"}]}
[object Object]
js> js_traverse(foobar)                 
key:  foo
bar
key:  baz
quux
key:  zot
key:  0
1
key:  1
2
key:  2
3
key:  3
key:  some
hash 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2015-10-08T17:17:31.170

如果您正在遍历一个实际的 JSON*字符串*，那么您可以使用 reviver 函数。

```
function traverse (json, callback) {
  JSON.parse(json, function (key, value) {
    if (key !== '') {
      callback.call(this, key, value)
    }
    return value
  })
}

traverse('{"a":{"b":{"c":{"d":1}},"e":{"f":2}}}', function (key, value) {
  console.log(arguments)
}) 
```

遍历对象时：

```
function traverse (obj, callback, trail) {
  trail = trail || []

  Object.keys(obj).forEach(function (key) {
    var value = obj[key]

    if (Object.getPrototypeOf(value) === Object.prototype) {
      traverse(value, callback, trail.concat(key))
    } else {
      callback.call(obj, key, value, trail)
    }
  })
}

traverse({a: {b: {c: {d: 1}}, e: {f: 2}}}, function (key, value, trail) {
  console.log(arguments)
}) 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-08-11T15:28:45.127

我想在匿名函数中使用@TheHippo 的完美解决方案，而不使用进程和触发器函数。以下对我有用，为像我这样的新手程序员分享。

```
(function traverse(o) {
    for (var i in o) {
        console.log('key : ' + i + ', value: ' + o[i]);

        if (o[i] !== null && typeof(o[i])=="object") {
            //going on step down in the object tree!!
            traverse(o[i]);
        }
    }
  })
  (json); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-10-14T22:44:43.267

大多数 Javascript 引擎不会优化尾递归（如果您的 JSON 没有深度嵌套，这可能不是问题），但我通常会谨慎行事，而是进行迭代，例如

```
function traverse(o, fn) {
    const stack = [o]

    while (stack.length) {
        const obj = stack.shift()

        Object.keys(obj).forEach((key) => {
            fn(key, obj[key], obj)
            if (obj[key] instanceof Object) {
                stack.unshift(obj[key])
                return
            }
        })
    }
}

const o = {
    name: 'Max',
    legal: false,
    other: {
        name: 'Maxwell',
        nested: {
            legal: true
        }
    }
}

const fx = (key, value, obj) => console.log(key, value)
traverse(o, fx) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-02-28T13:32:38.990

我的脚本：

```
op_needed = [];
callback_func = function(val) {
  var i, j, len;
  results = [];
  for (j = 0, len = val.length; j < len; j++) {
    i = val[j];
    if (i['children'].length !== 0) {
      call_func(i['children']);
    } else {
      op_needed.push(i['rel_path']);
    }
  }
  return op_needed;
}; 
```

输入 JSON：

```
[
    {
        "id": null, 
        "name": "output",   
        "asset_type_assoc": [], 
        "rel_path": "output",
        "children": [
            {
                "id": null, 
                "name": "output",   
                "asset_type_assoc": [], 
                "rel_path": "output/f1",
                "children": [
                    {
                        "id": null, 
                        "name": "v#",
                        "asset_type_assoc": [], 
                        "rel_path": "output/f1/ver",
                        "children": []
                    }
                ]
            }
       ]
   }
] 
```

函数调用：

```
callback_func(inp_json); 
```

根据我的需要输出：

```
["output/f1/ver"] 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-11-24T12:34:54.430

```
var test = {
    depth00: {
        depth10: 'string'
        , depth11: 11
        , depth12: {
            depth20:'string'
            , depth21:21
        }
        , depth13: [
            {
                depth22:'2201'
                , depth23:'2301'
            }
            , {
                depth22:'2202'
                , depth23:'2302'
            }
        ]
    }
    ,depth01: {
        depth10: 'string'
        , depth11: 11
        , depth12: {
            depth20:'string'
            , depth21:21
        }
        , depth13: [
            {
                depth22:'2201'
                , depth23:'2301'
            }
            , {
                depth22:'2202'
                , depth23:'2302'
            }
        ]
    }
    , depth02: 'string'
    , dpeth03: 3
};

function traverse(result, obj, preKey) {
    if(!obj) return [];
    if (typeof obj == 'object') {
        for(var key in obj) {
            traverse(result, obj[key], (preKey || '') + (preKey ? '[' +  key + ']' : key))
        }
    } else {
        result.push({
            key: (preKey || '')
            , val: obj
        });
    }
    return result;
}

document.getElementById('textarea').value = JSON.stringify(traverse([], test), null, 2);
```

```
<textarea style="width:100%;height:600px;" id="textarea"></textarea>
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-10-24T22:09:40.210

我们将[对象扫描](https://github.com/blackflux/object-scan)用于许多数据处理任务。一旦你把头绕在它周围，它就会很强大。这是您如何进行基本遍历的方法

```
// const objectScan = require('object-scan');

const obj = { foo: 'bar', arr: [1, 2, 3], subo: { foo2: 'bar2' } };

objectScan(['**'], {
  reverse: false,
  filterFn: ({ key, value }) => {
    console.log(key, value);
  }
})(obj);
// => [ 'foo' ] bar
// => [ 'arr', 0 ] 1
// => [ 'arr', 1 ] 2
// => [ 'arr', 2 ] 3
// => [ 'arr' ] [ 1, 2, 3 ]
// => [ 'subo', 'foo2' ] bar2
// => [ 'subo' ] { foo2: 'bar2' }
```

```
.as-console-wrapper {max-height: 100% !important; top: 0}
```

```
<script src="https://bundle.run/object-scan@13.8.0"></script>
```

*免责声明*：我是[对象扫描的作者](https://www.npmjs.com/package/object-scan)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-19T12:03:06.717

这会将所有节点读取到地图。

```
function readJsonFile() {
    let jsonString = getValueById("testDataContent");
    let jsonObj = JSON.parse(jsonString);
    let jsonElements = [];
    jsonElements = traverse(jsonObj, jsonElements);
    console.log(jsonElements)
}

function traverse(jsonObj, jsonElements) {
    if (jsonObj !== null && typeof jsonObj == "object") {
        Object.entries(jsonObj).forEach(([key, value]) => {

            if (typeof value == "object") {
                var obj = [];
                let map = new Map();
                map.set(key, traverse(value, obj))
                jsonElements.push(map);
            } else {
                var obj = [];
                obj.key = key;
                obj.value = value;
                jsonElements.push(obj);
            }
        });
    } else {

    }
    return jsonElements;
}
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-02-14T13:15:27.873

我创建了库来遍历和编辑深层嵌套的 JS 对象。在此处查看 API：[https ://github.com/dominik791](https://github.com/dominik791)

您还可以使用演示应用程序交互地使用库： [https ://dominik791.github.io/obj-traverse-demo/](https://dominik791.github.io/obj-traverse-demo/)

用法示例：您应该始终拥有作为每个方法的第一个参数的根对象：

```
var rootObj = {
  name: 'rootObject',
  children: [
    {
      'name': 'child1',
       children: [ ... ]
    },
    {
       'name': 'child2',
       children: [ ... ]
    }
  ]
}; 
```

第二个参数始终是包含嵌套对象的属性的名称。在上述情况下，它将是`'children'`。

第三个参数是一个对象，用于查找要查找/修改/删除的对象。例如，如果您正在寻找 id 等于 1 的对象，那么您将`{ id: 1}`作为第三个参数传递。

你可以：

1.  `findFirst(rootObj, 'children', { id: 1 })`找到第一个对象`id === 1`
2.  `findAll(rootObj, 'children', { id: 1 })`找到所有对象`id === 1`
3.  `findAndDeleteFirst(rootObj, 'children', { id: 1 })`删除第一个匹配的对象
4.  `findAndDeleteAll(rootObj, 'children', { id: 1 })`删除所有匹配的对象

`replacementObj`用作最后两个方法中的最后一个参数：

1.  `findAndModifyFirst(rootObj, 'children', { id: 1 }, { id: 2, name: 'newObj'})`将第一个找到的对象更改`id === 1`为`{ id: 2, name: 'newObj'}`
2.  `findAndModifyAll(rootObj, 'children', { id: 1 }, { id: 2, name: 'newObj'})`将所有对象更改`id === 1`为`{ id: 2, name: 'newObj'}`

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2016-06-21T12:27:47.777

```
 var localdata = [{''}]// Your json array
              for (var j = 0; j < localdata.length; j++) 
               {$(localdata).each(function(index,item)
                {
                 $('#tbl').append('<tr><td>' + item.FirstName +'</td></tr>);
                 } 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2015-08-06T17:44:42.827

您可以使用此获取所有键/值并保留层次结构

```
// get keys of an object or array
function getkeys(z){
  var out=[]; 
  for(var i in z){out.push(i)};
  return out;
}

// print all inside an object
function allInternalObjs(data, name) {
  name = name || 'data';
  return getkeys(data).reduce(function(olist, k){
    var v = data[k];
    if(typeof v === 'object') { olist.push.apply(olist, allInternalObjs(v, name + '.' + k)); }
    else { olist.push(name + '.' + k + ' = ' + v); }
    return olist;
  }, []);
}

// run with this
allInternalObjs({'a':[{'b':'c'},{'d':{'e':5}}],'f':{'g':'h'}}, 'ob') 
```

这是对（[https://stackoverflow.com/a/25063574/1484447](https://stackoverflow.com/a/25063574/1484447)）的修改

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2015-07-31T08:06:57.800

对我来说最好的解决方案如下：

*简单且不使用任何框架*

```
 var doSomethingForAll = function (arg) {
       if (arg != undefined && arg.length > 0) {
            arg.map(function (item) {
                  // do something for item
                  doSomethingForAll (item.subitem)
             });
        }
     } 
```

# apache-flex - Flex Datagrid 排序停止事件

> ID：722673
> 
> 赞同：1
> 
> 时间：2009-04-06T18:46:06.973
> 
> 标签：apache-flex, datagrid, sorting

在 Adob​​e Flex 中，当用户在 Datagrid 的列标题上按下并释放鼠标时，会调用该列的相应排序函数。有没有办法弄清楚分拣什么时候停止？基本上，当特定列的排序发生并停止时，数据网格中有一个“序列号”列，我想重新标记它。

我需要它，因为：我的数据网格中有一个年份列。当我对其进行排序时，假设有 6 个条目：

```
2008
2008
2008
2009
2009
2009 
```

我希望标签为 1,2,3,1,2,3，即年份更改后标签重新开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T20:19:17.750

排序完成后，DataGrid 的 dataProvider 调度 CollectionEvent.COLLECTION_CHANGE 事件，并将其“种类”属性设置为 CollectionEvent.REFRESH。只需获取 dataProvider 并向其添加事件处理程序，就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T18:55:57.950

排序不是异步过程，因此不会生成任何事件。您可以让 `headerRelease`事件知道排序何时开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T19:01:05.177

如果您想重新标记列，为什么不使用标签功能？为什么需要它等到排序完成？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T20:09:44.730

您可以关闭对列的排序并将 headerRelease 事件处理程序添加到 DataGrid 中，该处理程序在 ActionScript 中“手动”对 dataProvider 的基础集合进行排序，并在刷新集合后调用一个函数来重置列标题文本。查看此链接以获取有关覆盖排序功能的更多详细信息：

[http://livedocs.adobe.com/flex/3/html/help.html?content=dpcontrols_7.html](http://livedocs.adobe.com/flex/3/html/help.html?content=dpcontrols_7.html)

# apache-flex - Adobe AIR 和 HNAP (SOAP)

> ID：722674
> 
> 赞同：0
> 
> 时间：2009-04-06T18:46:36.630
> 
> 标签：apache-flex, soap, air

一段时间以来，我一直在为此苦苦挣扎，现在正在网上扫描示例或参考，以使用 Adob​​e Flex Builder 通过 Adob​​e AIR 应用程序执行 HNAP 调用。我知道进行 HNAP 调用实现了 SOAP 技术，并且 AIR 可以执行 SOAP 调用。我什至能够使用 AIR 和 Flex 成功编译和执行示例 SOAP 项目。

我使用的示例都引用了一个 WSDL 文件来定义通过 SOAP 接口可用的功能。一个大问题是我一直无法找到定义 HNAP 功能的 WSDL 文件。

除了尝试创建我自己的 WSDL 文件（这变得非常痛苦）之外，是否有人有任何经验或链接到有关如何在不使用 WSDL 文件的情况下使用 AIR 和 Flex 的 SOAP 服务的参考资料？或者有关从 AIR 和 Flex 调用 HNAP 命令的信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T15:51:39.393

为了进行调用，我最终创建了自己的 WSDL 文件。

# .net - 实现消息总线架构

> ID：722675
> 
> 赞同：20
> 
> 时间：2009-04-06T18:46:51.417
> 
> 标签：.net, architecture, msmq, messaging

我目前正在为我公司的新消息总线架构进行分析和设计。我过去曾尝试过 MSMQ 做类似的事情，它运行良好，并且正在考虑为这个项目再次做同样的事情，但使用 WCF 作为 API 而不是使用 System.Messaging API。有人在 WCF 中使用过 MSMQ 吗？比 System.Messaging API 更容易使用吗？在 System.Messaging 上使用 WCF 有什么好处，反之亦然？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-06T19:50:48.253

恕我直言，有这么多好的、灵活和经过验证的总线架构可供选择（[NServiceBus](http://www.nservicebus.com/)、[Mass Transit](http://code.google.com/p/masstransit/)、[Rhino Service Bus](http://ayende.com/blog/tags/rhino-service-bus)），实现你自己的将是一个很大的[NIH](http://en.wikipedia.org/wiki/Not_Invented_Here)。这不是一项微不足道的任务。

[Udi 在此消息](http://tech.groups.yahoo.com/group/nservicebus/message/712)中对其进行了很好的描述。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-10-07T09:23:16.093

抱歉，来晚了，但希望我的回答对 MSMQ 4.0 用户有用（但对更高版本的用户不一定有用）。

[WCF 队列](http://msdn.microsoft.com/en-us/library/ms789048.aspx)和 System.Messaging都是MSMQ API 的包装器。WCF 更加复杂和复杂，但确实具有以下好处：

*   应用程序业务流程的 OO 视图，而不是其通信管道。
*   免费的端到端消息加密和身份验证。System.Messaging 仅支持在线加密，不支持存储。
*   如果您愿意，您可以在 IIS 中托管，而不是构建您自己的自定义主机。
*   免费消息关联。这使您可以自动将消息分组到会话中。
*   免费的事务批处理。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T15:19:26.737

Apache ActiveMQ（开源）消息代理也有一个 .NET 客户端：

[http://activemq.apache.org](http://activemq.apache.org)

与 Apache Camel 和 Apache ServiceMix 一起，企业集成模式和企业服务总线系统很容易设置。

# windows-services - 用于调度代码重复运行的 Windows 任务调度程序有多可靠？

> ID：722678
> 
> 赞同：6
> 
> 时间：2009-04-06T18:47:54.457
> 
> 标签：windows-services, scheduled-tasks, task

我有一些代码需要放在 Windows Server 2003 机器上并每分钟运行一次。

推荐的处理方法是什么？是否可以将其设计为控制台服务并让任务调度程序每分钟都命中它？（这甚至可能吗？）我应该把它吸起来，然后把它写成一个 Windows 服务吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-06T18:51:01.690

由于它需要每分钟运行一次，我建议编写一个 Windows 服务。它不是很复杂，如果您以前从未这样做过，那么您最好了解它是如何完成的。

我不建议每分钟调用一次计划任务。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-06T18:50:13.110

我会说把它吸起来，把它写成一个 Windows 服务。我还没有发现计划任务非常可靠，当它不运行时，我还没有找到一种简单的方法来找出它为什么不运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-14T06:29:17.420

Windows 计划任务对于我们的目的来说相当可靠，由于它们易于安装和高级恢复功能，我们几乎在所有情况下都喜欢它们而不是 Windows 服务。如果编写的代码的一部分最终被锁定或循环在一段不应包含的代码中，则 Windows 服务的始终在线性质最终可能会成为问题。我们通常将代码编写在类似这样的时尚

```
Init();
Run();
CleanUp(); 
```

然后，作为计划任务的一部分，我们对进程可以运行多长时间设置了时间限制，如果进程运行时间更长，则让它终止进程。如果我们确实有一段代码有问题，计划任务将杀死它，该进程将在下一分钟启动。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-06T18:51:29.893

如果您需要让它每分钟运行一次，我会将其构建为 Windows 服务。我不会将调度程序用于日常任务之外的任何事情。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-06T18:53:12.837

我会说这取决于它在做什么，但总的来说，我总是赞成使用最少的层。如果您将其编写为控制台服务并使用任务调度程序，那么您有两个地方需要维护。

如果您将其编写为 Windows 服务，那么您只有少一个地方可以检查以防出现问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-09T07:42:24.427

在寻找定期服务帮助时，我看到了[Jon Galloway 的一篇非常好的文章](http://weblogs.asp.net/jgalloway/archive/2005/10/24/428303.aspx?CommentPosted=true#commentmessage)。

如果将 Windows 服务用于计划任务，则会有各种缺点。我同意了。我建议使用任务计划，实现简单。请参考[实现任务调度器的详细信息](http://www.codeproject.com/KB/cs/tsnewlib.aspx)。希望此信息有助于最终确定实施方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-06T19:01:25.737

唯一要考虑的另一点是，如果您的工作涉及某种数据库交互，请考虑查看数据库提供的集成/调度服务。

例如，为您的 SQL Server 相关服务创建一个 SSIS 包可能看起来有点矫枉过正，但它可以很好地与环境集成，并且已经有了自己的日志记录/错误检查机制。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-06T18:56:57.477

我同意，即使是创建控制台可执行文件并将其安排为每分钟运行一次，也是一种浪费。我建议探索类似[Quartz.Net](http://quartznet.sourceforge.net/)的东西。这样，您可以创建一个简单的作业并安排它每分钟运行一次。

# javascript - 如何强制浏览器窗口始终位于顶部并处于焦点位置

> ID：722681
> 
> 赞同：2
> 
> 时间：2009-04-06T18:48:34.317
> 
> 标签：javascript, windows, web-applications, browser

有没有办法强制浏览器窗口始终位于顶部并处于焦点？我正在做一个项目，我需要将浏览器窗口放在顶部并始终保持焦点，除非关闭浏览器窗口。我已经通过 javascript 尝试了一些事情，但没有成功让窗口保持焦点。

我不想这样做是为了对用户强硬。我正在开展一个实施在线测试的项目，我不希望用户能够切换到网络上查找答案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-06T18:50:41.923

您需要在客户端机器上安装一个 Windows 应用程序，这将强制浏览器位于顶部。这是唯一的方法。

如果您使用的是 IE，您可以打开一个模态对话框，该对话框将始终位于顶部并处于焦点位置，但仅在该浏览器会话中，用户可以自由切换应用程序。

编辑：如果您正在编写测试应用程序，老实说，您最好对每个问题设置合理的时间限制。试图阻止他们查找答案是毫无价值的。如果他们并排有两台机器怎么办？如果他们有他们的伙伴在他们旁边帮助答案怎么办。你将不得不在这个上使用荣誉系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T18:52:37.770

这是不可能的，因为应用程序级别的焦点由 Windows 操作系统处理。

您需要更改操作系统才能实现此功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-07T07:16:43.737

我对这个问题发表了评论，但意识到这是值得发布的答案......

寻找另一个解决方案。想一想。如果用户不在另一个窗口/选项卡/浏览器中查看答案，那会有什么副作用？检测那些副作用，并在这些情况下惩罚/阻止。

例如，您可以在 上检测`blur`事件`window`，然后轮询活动（`focus`、`click`、`mousemove`等`keypress`）以确定用户的“空闲”时间。如果用户“空闲”的时间足够长，以至于到别处寻找答案，那么他们很可能是“作弊”。否则，您可以简单地对问题施加时间限制，如果分配的时间用完，则跳过这些问题。

您不能保证您的用户没有“作弊”。要么构建测试的“物理”规则，以使“作弊”的机会最小化，要么构建测试本身，以减少“作弊”的后果。不要试图绕过浏览器中的内置用户保护措施，这些保护措施不允许用户像操作任何其他应用程序一样操作他们的浏览器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T00:11:04.743

浏览器窗口属于浏览器，不属于你。不要乱来。

不要这样做，也就是说，除非你写了浏览器。

曾经我用了 15 分钟来使用 Windows 窗体 WebBrowser 控件创建一个合理的 Web 浏览器。我建议您要求学生通过此自定义浏览器程序查看您的网站。因为这个程序真的是*你*的，你可以强迫它保持领先，或者任何你喜欢的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-07T00:26:20.120

`JavaScript`具有执行此操作的功能，但在大多数现代网络浏览器中默认禁用它（而且，您肯定会同意，这是有充分理由的！）

# python - 将单词列表转换为频率字典的最佳方法

> ID：722697
> 
> 赞同：22
> 
> 时间：2009-04-06T18:55:11.803
> 
> 标签：python

将列表/元组转换为 dict 的最佳方法是什么，其中键是列表的不同值，值是这些不同值的频率？

换句话说：

```
['a', 'b', 'b', 'a', 'b', 'c']
--> 
{'a': 2, 'b': 3, 'c': 1} 
```

（我不得不多次执行上述操作，标准库中有什么可以为您做的吗？）

编辑：

Jacob Gabrielson 指出2.7/3.1 分支[的标准库中有一些东西](http://svn.python.org/view/python/trunk/Lib/collections.py?view=markup&pathrev=68559#Counter)

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-06T19:28:51.550

我发现最容易理解（虽然可能不是最有效）的方法是：

```
{i:words.count(i) for i in set(words)} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-06T18:56:16.340

有点儿

```
from collections import defaultdict
fq= defaultdict( int )
for w in words:
    fq[w] += 1 
```

这通常效果很好。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-07T20:42:20.447

请注意，从 Python 2.7/3.1 开始，此功能将内置到`collections`模块中，请参阅[此错误](http://bugs.python.org/issue1696199)了解更多信息。这是[发行说明](http://docs.python.org/dev/whatsnew/2.7.html)中的​​示例：

```
>>> from collections import Counter
>>> c=Counter()
>>> for letter in 'here is a sample of english text':
...   c[letter] += 1
...
>>> c
Counter({' ': 6, 'e': 5, 's': 3, 'a': 2, 'i': 2, 'h': 2,
'l': 2, 't': 2, 'g': 1, 'f': 1, 'm': 1, 'o': 1, 'n': 1,
'p': 1, 'r': 1, 'x': 1})
>>> c['e']
5
>>> c['z']
0 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-07-02T12:29:41.593

其实 Counter 的答案已经提到过，但我们甚至可以做得更好（更简单）！

```
from collections import Counter
my_list = ['a', 'b', 'b', 'a', 'b', 'c']
Counter(my_list)  # returns a Counter, dict-like object
>> Counter({'b': 3, 'a': 2, 'c': 1}) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-06T19:15:59.273

这是可憎的，但是：

```
from itertools import groupby
dict((k, len(list(xs))) for k, xs in groupby(sorted(items))) 
```

我想不出有人会选择这种方法而不是 S.Lott 的原因，但如果有人要指出这一点，那还不如我。:)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-02-10T14:30:38.950

我决定继续测试建议的版本，我发现`collections.Counter`Jacob Gabrielson 建议的版本最快，其次是`defaultdict`SLott 的版本。

这是我的代码：

```
from collections import defaultdict
from collections import Counter

import random

# using default dict
def counter_default_dict(list):
    count=defaultdict(int)
    for i in list:
        count[i]+=1
    return count

# using normal dict
def counter_dict(list):
    count={}
    for i in list:
        count.update({i:count.get(i,0)+1})
    return count

# using count and dict
def counter_count(list):
    count={i:list.count(i) for i in set(list)}
    return count

# using count and dict
def counter_counter(list):
    count = Counter(list)
    return count

list=sorted([random.randint(0,250) for i in range(300)])

if __name__=='__main__':
    from timeit import timeit
    print("collections.Defaultdict ",timeit("counter_default_dict(list)", setup="from __main__ import counter_default_dict,list", number=1000))
    print("Dict",timeit("counter_dict(list)",setup="from __main__ import counter_dict,list",number=1000))
    print("list.count ",timeit("counter_count(list)", setup="from __main__ import counter_count,list", number=1000))
    print("collections.Counter.count ",timeit("counter_counter(list)", setup="from __main__ import counter_counter,list", number=1000)) 
```

我的结果：

```
collections.Defaultdict 
0.06787874956330614
Dict
 0.15979115872995675
list.count 
 1.199258431219126
collections.Counter.count
 0.025896202538920665 
```

请让我知道如何改进分析。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-06T19:11:35.447

我必须分享我刚刚想出的一种有趣但有点荒谬的做法：

```
>>> class myfreq(dict):
...     def __init__(self, arr):
...         for k in arr:
...             self[k] = 1
...     def __setitem__(self, k, v):
...         dict.__setitem__(self, k, self.get(k, 0) + v)
... 
>>> myfreq(['a', 'b', 'b', 'a', 'b', 'c'])
{'a': 2, 'c': 1, 'b': 3} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-11-17T18:00:09.910

我认为使用集合库是获取它的最简单方法。但是，如果您想在不使用频率字典的情况下获取它，那么这是另一种方式，

```
l = [1,4,2,1,2,6,8,2,2]
d ={}
for i in l:
    if i in d.keys():
        d[i] = 1 + d[i]
    else:
        d[i] = 1
print (d) 
```

操作：

```
{1: 2, 4: 1, 2: 4, 6: 1, 8: 1} 
```

# sed - 无法使用 SED 快速编辑文件

> ID：722699
> 
> 赞同：3
> 
> 时间：2009-04-06T18:55:44.783
> 
> 标签：sed

该文件最初是

```
$cat so/app.yaml 
application: SO
... 
```

我运行以下命令。我得到一个空文件。

```
$sed s/SO/so/ so/app.yaml > so/app.yaml 
$cat so/app.yaml 
$ 
```

**如何使用 SED 编辑文件而不给我一个空文件？**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-06T18:59:54.350

```
$ sed -i -e's/SO/so/' so/app.yaml 
```

`-i`手段到位。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-06T19:07:30.293

管道中使用的`>`将在管道全部设置好时打开输出文件，即在命令执行之前。因此，输入文件在执行之前被截断`sed`。这是所有 shell 重定向的问题，而不仅仅是`sed`.

Sheldon Young 的回答展示了如何使用就地编辑。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-06T19:58:27.377

您为这项工作使用了错误的工具。[`sed`](http://OpenGroup.Org/onlinepubs/009695399/utilities/sed.html)是一个*流*编辑器（这就是它被称为**s**`ed`的原因），所以它用于对管道中的流进行动态编辑。[`ed`](http://OpenGroup.Org/onlinepubs/009695399/utilities/ed.html)OTOH 是一个*文件*编辑器，它可以做所有`sed`可以做的事情，除了它适用于文件而不是流。（实际上，它是相反的：`ed`是原始实用程序，并且`sed`是避免为流创建临时文件的克隆。）

`ed`工作方式非常相似`sed`（因为`sed`只是一个克隆），但有一个重要区别：您可以在文件中移动，但不能在流中移动。因此，所有命令都`ed`带有一个地址参数，该参数告诉在文件中`ed`的*何处*应用命令。在您的情况下，您希望在文件中的任何位置应用命令*，*因此 address 参数只是`,`因为`a,b`表示“从行`a`到行`b`”，默认为`a`( `1`beginning-of-file)，默认为`b`( `$`end-of -file），因此将它们都排除在外意味着“从文件开头到文件结尾”。然后是`s`（替代品），其余的看起来很像`sed`。

因此，您的`sed`命令`s/SO/so/`变成了 ed 命令`,s/SO/so/`。

而且，由于`ed`是文件编辑器，更准确地说，是交互式文件编辑器，我们还需要编写 ( `w`) 文件并退出 ( `q`) 编辑器。

这是它的整体外观：

```
ed -- so/app.yaml <<-HERE
    ,s/SO/so/
    w
    q
HERE 
```

另请参阅[我](https://stackoverflow.com/questions/703459/#703535)对类似问题的回答。

在您的情况下，执行管道是一个两阶段的过程：首先构建管道，然后运行它。`>`意思是“打开文件，*截断*它，并将它连接到文件描述符 1 ( `stdout`)”。*只有这样*管道才真正运行，即执行了 sed，但此时文件已经被截断。

的某些版本`sed`还具有`-i`用于就地编辑文件的参数，这使得`sed`行为更像`ed`，但不建议使用它：首先，它不支持 的所有功能`ed`，但更重要的是，它是GNU 的非标准化专有扩展`sed`，不适用于许多非 GNU 系统。自从我使用非 GNU 系统已经有一段时间了，但最后一次我使用了一个，Solaris、OpenBSD、HP-UX 和 IBM AIX 都不`sed`支持该`-i`参数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-06T19:03:34.000

我相信将输出重定向到您正在编辑的同一个文件会导致您的问题。

您需要将标准输出重定向到某个临时文件，并在 sed 完成后用临时文件覆盖原始文件。

# wpf - WPF：组合框中的 TreeView

> ID：722700
> 
> 赞同：17
> 
> 时间：2009-04-06T18:55:52.817
> 
> 标签：wpf, combobox, treeview

我试图将 TreeView 放在 WPF 中的 ComboBox 中，以便当组合框被删除时，用户将获得一个分层列表，而不是一个平面列表，并且他们选择的任何节点都成为 ComboBox 的选定值。

我已经搜索了相当多的方法来实现这一点，但我能找到的最好的只是一些潜在的解决方案，因为我对 WPF 非常陌生，所以我无法工作。

我对 WPF 和数据绑定有足够的了解，可以将数据放入树视图中，甚至可以在组合框中获得树视图，但是我能够完成的操作根本无法正常运行。我附上了一个截图来说明我的意思。在屏幕截图中，组合框是“打开的”，所以底部的树视图是我可以选择一个节点的地方，而“顶部”的树视图被绘制在组合框的顶部，我想要所选节点的文本/值在要显示的树中。

基本上我不知道该怎么做是如何让树视图的当前选定节点将其值返回给组合框，然后将其用作其选定值？

这是我目前正在使用的 xaml 代码：

```
 <ComboBox Grid.Row="0" Grid.Column="1"  VerticalAlignment="Top">
        <ComboBoxItem>
            <TreeView ItemsSource="{Binding Children}" x:Name="TheTree">
                <TreeView.Resources>
                    <HierarchicalDataTemplate DataType="{x:Type Core:LookupGroupItem}" ItemsSource="{Binding Children}">
                        <TextBlock Text="{Binding Path=Display}"/>                            
                    </HierarchicalDataTemplate>
                </TreeView.Resources>
            </TreeView>
        </ComboBoxItem>
    </ComboBox> 
```

截屏：![树视图](https://i.stack.imgur.com/oi95R.jpg)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-12-03T13:32:59.667

对于那些仍然需要这个控件的人，我已经实现了我的[Silverlight 控件](http://vortexwolf.wordpress.com/2011/04/29/silverlight-combobox-with-treeview-inside/)的 WPF 版本。它只适用于视图模型，并且需要这些视图模型实现一个特殊的接口，但除此之外它并不难使用。

在 WPF 中，它看起来像这样：

![带有 TreeView 的 WPF 组合框](https://i.stack.imgur.com/08Ubm.png)

您可以从这里下载源代码和示例应用程序：[WpfComboboxTreeview.zip](https://www.dropbox.com/s/hpo84ywb1lu8fw4/WpfComboboxTreeview.zip?dl=0)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-06-08T19:18:02.080

我遇到过同样的问题。

在组合框中实现树视图行为的最简单方法是创建一个 TextBox 并将其样式化，使其看起来像一个组合框。在它旁边添加一个图像。诀窍是将树视图放在弹出控件中。然后，当用户单击您选择的文本框或下拉图像时，弹出窗口将直接显示在文本框下方。

Then, when the treeview item is selected, close the popup and place the text of the selected now in the textbox.

这是一个非程式化的例子：

XAML：

```
<Window x:Class="ComboBoxTreeView.MainWindow"
   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
   Title="MainWindow" Height="350" Width="525" MouseEnter="Window_MouseEnter">
   <Grid Margin="15">
      <Grid.RowDefinitions>
         <RowDefinition Height="30" />
         <RowDefinition Height="*" />
      </Grid.RowDefinitions>
      <TextBox Grid.Row="0" x:Name="header" Width="300" Height="30" PreviewMouseDown="header_PreviewMouseDown" HorizontalAlignment="Left" />
      <Popup Grid.Row="1" x:Name="PopupTest" AllowsTransparency="True" IsOpen="False">
         <TreeView x:Name="Tree1" Initialized="Tree1_Initialized" SelectedItemChanged="Tree1_SelectedItemChanged">
            <TreeViewItem Header="Test1" x:Name="Tree1Item1">
               <TreeViewItem Header="1test1" />
               <TreeViewItem Header="2test2" />
            </TreeViewItem>
            <TreeViewItem Header="Test2" />
         </TreeView>
      </Popup>
   </Grid>
</Window> 
```

这是背后的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace ComboBoxTreeView
{
   /// <summary>
   /// Interaction logic for MainWindow.xaml
   /// </summary>
   public partial class MainWindow : Window
   {
      public MainWindow()
      {
         InitializeComponent();
      }

      private void Window_MouseEnter(object sender, MouseEventArgs e)
      {

      }

      private void Tree1_SelectedItemChanged(object sender, RoutedPropertyChangedEventArgs<object> e)
      {
         var trv = sender as TreeView;
         var trvItem = trv.SelectedItem as TreeViewItem;
         if (trvItem.Items.Count != 0) return;
         header.Text = trvItem.Header.ToString();
         PopupTest.IsOpen = false;
      }

      private void Tree1_Initialized(object sender, EventArgs e)
      {
         var trv = sender as TreeView;
         var trvItem = new TreeViewItem() { Header="Initialized item"};
         var trvItemSel = trv.Items[1] as TreeViewItem;
         trvItemSel.Items.Add(trvItem);
      }

      private void header_PreviewMouseDown(object sender, MouseButtonEventArgs e)
      {
         PopupTest.Placement = System.Windows.Controls.Primitives.PlacementMode.RelativePoint;
         PopupTest.VerticalOffset = header.Height;
         PopupTest.StaysOpen = true;
         PopupTest.Height = Tree1.Height;
         PopupTest.Width = header.Width;
         PopupTest.IsOpen = true;
      }
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T20:32:46.920

您也许可以在树视图上使用事件处理程序来设置组合框上的 SelectedItem。

为此，您需要像这样设置树视图的标签属性：

```
<TreeView Tag="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ComboBox}}"  MouseDoubleClick="treeview_MouseDoubleClick" ItemsSource="{Binding Children}" x:Name="TheTree"> 
```

现在在 DoubleClick 事件中，您可以在 ComboBox 中获得：

```
 private void treeview_MouseDoubleClick(object sender, RoutedEventArgs e)
    {
        try
        {
            TreeView tv = sender as TreeView;
            if(tv == null)
                return;
            var cB = tv.Tag as ComboBox;
            cB.SelectedItem = tv.SelectedItem;
        }
        catch (Exception e)
        {

        }
    } 
```

您还需要覆盖选择组合框项目的方式，否则一旦单击它就会选择整个 TreeView。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-21T19:07:18.180

这个问题实际上与[那个问题密切相关](https://stackoverflow.com/questions/859227/looking-for-a-wpf-combobox-with-checkboxes)

所以你可能会发现[这个实现](http://blogs.microsoft.co.il/blogs/justguy/archive/2009/01/19/wpf-combobox-with-checkboxes-as-items-it-will-even-update-on-the-fly.aspx)很有帮助。这是一个内部带有复选框的组合框，但您可以了解如何将框中的文本与弹出内容与树分离。

它还演示了`IsSelected`属性应该在模型实体上，然后`Text`通过模型绑定回复选框属性的想法。换句话说，您在折叠的组合框中显示的内容可能与内容完全无关......好吧，也许不完全，但在我的应用程序中，当用户在该组合中选择多个复选框时，我可以在顶部文本框中显示逗号分隔，或者我可以显示“选择了几个选项”，或者其他什么。

高温 =)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-04T09:30:06.960

这是一个古老的话题，但它可能对某人有用。

尝试使用组合框做类似的事情，我尝试使用 popup 代替它并且它正在工作。要将其变成一个不错的功能，需要进行大量调整。

```
<Expander Header="TestCS">
    <Popup IsOpen="{Binding IsExpanded, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Expander}}}">
        <TreeView ItemsSource="{Binding CSTree.CSChildren}">
            <TreeView.Resources>
                <HierarchicalDataTemplate ItemsSource="{Binding CSChildren}" DataType="{x:Type ViewModel:ObservableCS}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock FontSize="16" Text="{Binding CSName}"></TextBlock>
                    </StackPanel>
                </HierarchicalDataTemplate>
            </TreeView.Resources>
        </TreeView>
    </Popup>
</Expander> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-15T14:21:10.770

我认为你可以 foreach treeViewItems 然后添加到组合 1by1 中。

并在每个 treeviewitem 展开事件中，将其子项附加到组合框中。

但是，将可展开项的高度设置为一行，例如 Height = 18d。

```
// == Append Item into combobox =================
TreeViewItem root = new TreeViewItem();
root.Header = "item 1";
TreeViewItem t1 = new TreeViewItem();
t1.Header = "Expanding...";
root.Items.Add(t1);
// ==============================================

// == root expandind event ==============================
root.Height = 18.00d;
TreeViewItem[] items = GetRootChildren(root.Tag);
foreach(TreeViewItem item in items)
{
    combox1.Items.Add(item);
}
// ====================================================== 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-17T04:25:52.710

你有两个问题。第一个是当您选择唯一的 ComboBoxItem（整个 TreeView）时，这就是返回到 ComboBox 的基本 ToggleButton 的 ContentPresenter 的内容。简单地使您的 ComboBox IsEditable 将阻止整个 TreeView 放入 ComboBox 的内容中，但它仍然没有选择您在 TreeView 中选择的项目。您必须使用 TreeView 中的 SelectedItemChanged 事件来捕获所选项目，然后将其转换为您的“SelectedItem”。选择项目并将其传递给 ComboBox 后，将 IsDropDownOpen 设置为 false。

# asp.net - 允许用户在网页上搜索大型列表的最佳方式是什么？

> ID：722704
> 
> 赞同：2
> 
> 时间：2009-04-06T18:56:53.377
> 
> 标签：asp.net, html, web-applications, user-interface

我正在编写一个 ASP.NET MVC 应用程序，并且我有一个表单，用户可以在其中输入一个或多个用于解决问题的部件号。大多数情况下，他们知道零件编号，只需输入即可。然而，有时他们需要一些额外的帮助。

零件编号表中有超过 50,000 个项目，对于下拉列表来说太大了。此外，选择需要一些时间，所以我不知道自动完成在这里也很棒。

关于我可以做些什么来使这个用户友好，还有哪些其他建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T19:00:59.917

我会在部件号上使用自动完成框 + 添加服务器端缓存（因此您不需要每次都从 Db 中获取它们，只有在更新记录时）。这样它应该工作得很快。

[使用 SqlCacheDependency 类在 ASP.NET 中进行缓存](http://msdn.microsoft.com/en-us/library/ms178604.aspx)

使用这个 jQuery 代码和平，您可以过滤用户输入到“自动完成”框中的字母：

```
$(function() {
    $.isShiftDown = false;
    $('input#partName').keydown(function(e) {
        if (e.keyCode == 16) $.isShiftDown = true;
        if ($(this).val().length == 0 && (e.keyCode == 188 ||
            e.keyCode == 189)) return false;
        return ($.inArray(e.keyCode, [8, 13, 35, 36, 37, 39, 46, 48, 49, 50,
            51, 52, 53, 54, 55, 56, 57, 188, 189]) > -1 && !$.isShiftDown)
            || (e.keyCode > 64 && e.keyCode < 91);
    }).keyup(function(e) { if (e.keyCode == 16) $.isShiftDown = false; });
}); 
```

（将这些数字替换为您的，对应于允许的字符。例如 e.keyCode == 16 是 SHIFT 键，64 - 91 代码是从 A 到 Z 的字母）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T19:09:40.380

一些想法：

*   在下拉列表中提供您的零件编号范围。
*   使用零件编号以外的类别来帮助缩小搜索范围。
*   使用带有过滤器的自动完成功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T18:59:30.170

您可以在按键后对结果集应用过滤器。这样，您就不会每次都调用数据库，结果集将过滤掉用户输入的内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T19:09:02.207

其他人所说的话，此外，在处理大型列表时，您不需要启动自动完成，直到过滤器至少有 2 或 3 个字符长。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-06T19:37:18.363

您真正需要的是一个弹出窗口，让用户输入有关零件的标准并对数据库进行查询。类别，或零件名称，部分零件编号等。单个组合框字段可能不够“丰富”，无法让用户表达有关零件的“他们所知道的”，因此与具有几个领域。

基本上，弹出一个带有用户指定过滤条件的模式选择器。在场地旁边放一个小放大镜或任何东西来弹出它。首先让表单出现空白，没有结果，然后用户可以缩小范围。

# sql - SQL按“日期”分组问题

> ID：722708
> 
> 赞同：3
> 
> 时间：2009-04-06T18:58:33.667
> 
> 标签：sql, oracle, plsql, group-by, truncate

我正在尝试制作报告，但我的宿敌 SQL 出现问题。

我有一张表，其中存储了交易的结束日期。

我想知道每月有多少笔交易，所以我做了：

```
SELECT trunct( closedate, 'MONTH' ) FROM  MY_TRANSACTIONS 
```

我正在使用甲骨文。

我得到一个这样的列表：

```
2002-09-01 00:00:00.0
2002-09-01 00:00:00.0
...
2002-10-01 00:00:00.0
2002-10-01 00:00:00.0
...
2002-11-01 00:00:00.0
2002-11-01 00:00:00.0 
```

等等

所以我想“如果我在应该做的语句末尾的 select 和 GROUP BY 中添加一个 COUNT( )”，但事实并非如此。我的猜测是因为每条记录都被视为不同的值：-S

请问有什么提示吗？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-06T19:00:08.140

您想按所有非聚合字段进行分组。而且你不想截断日期，你想要日期的月份部分。

所以像

select to_char(datefield, 'Month'), count(*) from ... group by to_char(datefield, 'Month');

# windows - MSI 安装程序中的 TerminalServer 属性

> ID：722713
> 
> 赞同：0
> 
> 时间：2009-04-06T18:59:35.600
> 
> 标签：windows, installation, windows-installer, terminal-services

我们正在尝试为 Windows Server 2003 下的应用程序创建 MSI 安装程序。该应用程序需要用户能够通过远程桌面登录。使用“TerminalServer”属性看起来像是正确的测试，以确保是这种情况，但这在运行终端服务的正确操作系统并允许用户远程连接的机器上返回“false”。

我们在这里缺少什么？

谢谢！阿明

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T22:42:59.837

IIUC，您实际上确实需要安装并“开启”终端服务；远程桌面可能还不够。也试试 RemoteAdminTS。MSI 文档表明它们是互斥的。

使用 /l*v 运行 MSI 文件以找出哪些属性设置为哪些值。

# asp.net-mvc - ASP.NET MVC 报告

> ID：722717
> 
> 赞同：14
> 
> 时间：2009-04-06T19:00:02.510
> 
> 标签：asp.net-mvc, reporting

我正在寻找 ASP.NET MVC 的报告解决方案。

我需要：

*   参数支持渲染到 HTML
*   导出到 Excel
*   免费/价格合理

有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T05:22:55.397

有一个关于人们[在 ASP.NET MVC 中使用 ActiveReports 的堆栈溢出](https://stackoverflow.com/questions/668328/how-to-render-active-reports-webviewer-in-asp-net-mvc)的持续讨论。它具有excel导出支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-09T09:20:36.183

看看 Stimulsoft Reports.Web for MVC - 完全适用于 MVC 的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-25T16:33:20.063

Telerik Reporting 支持 MVC，开发许可证起价 399 美元（含源代码和一年免费升级的价格为 599 美元）。他们还提供了一个关于如何在 MVC 中使用他们的工具的[工作项目。](http://www.telerik.com/community/code-library/reporting/general/using-telerik-web-reportviewer-in-asp-net-mvc-application.aspx)我希望这有帮助...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-19T11:17:32.287

我们发现最容易与 MVC 一起使用的是 devexpress XtraReports。但它不是免费的，而且价格合理，仅适用于大型项目。

[这是一个使用 MVC 的示例。](http://documentation.devexpress.com/#XtraReports/CustomDocument9974)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-06T19:06:19.750

我打算推荐[微软图表控件，你可以](http://www.microsoft.com/downloads/details.aspx?FamilyID=130f7986-bf49-4fe5-9ca8-910ae6ea442c&DisplayLang=en)[在这里](http://weblogs.asp.net/scottgu/archive/2008/11/24/new-asp-net-charting-control-lt-asp-chart-runat-quot-server-quot-gt.aspx)阅读它们；但是，我不记得看到任何有关导出到 Excel 的信息。为了让数据导出到 Excel，我只是让它成为页面请求的一部分。您可能想看看这些，因为导出到 Excel 可能不需要在图表控件本身中进行。

# python - Google AppEngine：日期范围未返回正确结果

> ID：722728
> 
> 赞同：0
> 
> 时间：2009-04-06T19:03:21.957
> 
> 标签：python, google-app-engine, gql

我试图在特定类型的日期范围内搜索某些值，但查询未返回数据库中存在的日期的内容。

这是python代码的摘录：

```
deltaDays = timedelta(days= 20)
endDate = datetime.date.today()
startDate = endDate - deltaDays

result = db.GqlQuery(
   "SELECT * FROM myData WHERE mytype = :1 AND pubdate >= :2 and pubdate <= :3", type, startDate, endDate
  )

class myData(db.Model):
   mytype = db.StringProperty(required=True)
   value =  db.FloatProperty(required=True)
   pubdate = db.DateTimeProperty(required=True) 
```

GQL 返回数据，但我期望的一些行丢失了：

```
 2009-03-18 00:00:00
(missing date in results: 2009-03-20 data exists in database)
 2009-03-23 00:00:00
 2009-03-24 00:00:00
 2009-03-25 00:00:00
 2009-03-26 00:00:00
(missing date in results: 2009-03-27 data exists in database)
 2009-03-30 00:00:00
(missing date in results: 2009-03-31\. data exists in database)
 2009-04-01 00:00:00
 2009-04-02 00:00:00
 2009-04-03 00:00:00
 2009-04-06 00:00:00 
```

我通过 de bulkload 脚本上传了数据。我只能想到索引被损坏或类似的东西。这个相同的查询曾经适用于我拥有的另一个表。但是我不得不用其他来源的新内容替换它，而这个新内容并没有以同样的方式响应查询。如果这有什么不同的话，该表大约有 700.000 行。

我做了更多的研究，它似乎是 appEngine DataStore 中的一个错误。有关该错误的更多信息，请查看此链接： [http ://code.google.com/p/googleappengine/issues/detail?id=901](http://code.google.com/p/googleappengine/issues/detail?id=901)

我试过删除索引并重新创建它，但没有成功。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T21:46:37.570

在我看来没有什么不对。您确定缺少的日期也有 mytype == 类型吗？

过去我观察到一些有趣的索引行为。我建议编写一个处理程序来遍历所有记录，然后将它们放回数据库中。也许批量上传器的某些东西无法正常工作。

这是我用来遍历模型类中所有实体的处理程序类型：

```
 class PPIterator(BaseRequestHandler):
  def get(self):
    query = Model.gql('ORDER BY __key__')
    last_key_str = self.request.get('last')
    if last_key_str:
      last_key = db.Key(last_key_str)
      query = Model.gql('WHERE __key__ > :1 ORDER BY __key__', last_key)
    entities = query.fetch(11)
    new_last_key_str = None
    if len(entities) == 11:
      new_last_key_str = str(entities[9].key())
    for e in entities:
      e.put()
    if new_last_key_str:
      self.response.out.write(json.write(new_last_key_str))
    else:
      self.response.out.write(json.write('done')) 
```

你可以使用任何你想遍历实体的东西。我曾经在浏览器窗口中使用 Javascript，但在发出数十万个请求时发现那是一头猪。这些天来，我发现使用这样的 ruby​​ 脚本更方便：

```
require 'net/http'
require 'json'
last=nil
while last != 'done'
  url = 'your_url'
  path = '/your_path'
  path += "?/last=#{last}" if last
  last = Net::HTTP.get(url,path)
  puts last
end 
```

本

更新：现在远程 api 工作可靠，我很少再写这种类型的处理程序了。相同的想法适用于您在那里用来遍历远程 api 控制台中的实体的代码。

# django - 无法将 Django 项目上传到 Google App Engine

> ID：722735
> 
> 赞同：0
> 
> 时间：2009-04-06T19:06:50.450
> 
> 标签：django, google-app-engine

我正在尝试测试[项目](http://code.google.com/p/cnprog/)的代码。

我运行以下代码

```
$appcfg.py update masicode/ 
```

我收到以下错误

```
Scanning files on local disk.
Initiating update.
2009-04-06 21:58:42,401 ERROR appcfg.py:1235 An unexpected error occurred. Aborting. 
Traceback (most recent call last):
  File "/Applications/Coding/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/tools/appcfg.py", line 1213, in DoUpload
    missing_files = self.Begin()
  File "/Applications/Coding/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/tools/appcfg.py", line 1009, in Begin
    version=self.version, payload=self.config.ToYAML())
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/tools/appengine_rpc.py", line 303, in Send
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/urllib2.py", line 380, in open
    response = meth(req, response)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/urllib2.py", line 491, in http_response
    'http', request, response, code, msg, hdrs)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/urllib2.py", line 418, in error
    return self._call_chain(*args)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/urllib2.py", line 353, in _call_chain
    result = func(*args)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/urllib2.py", line 499, in http_error_default
    raise HTTPError(req.get_full_url(), code, msg, hdrs, fp)
HTTPError: HTTP Error 403: Forbidden
Error 403: --- begin server output ---
You do not have permission to modify this app (app_id=u'so').
--- end server output --- 
```

masicode的内容

```
$ls masicode/
app.yaml   index.yaml main.py 
```

**如何将 Django 项目成功上传到 Google App Engine？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T19:55:36.353

看起来像登录/权限问题。

> HTTP 错误 403：禁止
> 您无权修改此应用 (app_id=u'so')。

您的 appID 应与您在 Google App Engine 中注册的 appID 相同。您的邮件和密码与您注册时使用的凭据相同。[http://so.appspot.com/](http://so.appspot.com/)
是你的吗？

进一步阅读在 App Engine 上部署 Django：

*   谷歌官方文章[Django on App Engine](http://code.google.com/appengine/articles/django.html)
*   Thomas Brox Røst [“通过 13 个简单步骤在 Google App Engine 上使用 Django”](http://thomas.broxrost.com/2008/04/08/django-on-google-app-engine/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T05:46:43.580

您是否使用修改后的 Django 库（例如[http://code.google.com/p/google-app-engine-django/](http://code.google.com/p/google-app-engine-django/) ）专门为 App Engine 开发它？App Engine 与您的标准 Python 安装环境不同，并且不是为它开发的应用程序将无法正常工作（并且可能部署）。

应用程序是否在 App Engine 开发环境中正确运行？

# python - Windows 上 Python (v3.0) 中的环境变量

> ID：722739
> 
> 赞同：3
> 
> 时间：2009-04-06T19:07:17.283
> 
> 标签：python, windows, scripting, shell

我正在使用 Python 3.0。

如何在给定 %var_name% 语法的情况下扩展环境变量？

任何帮助深表感谢！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T19:41:20.477

它位于一个稍微出乎意料的地方：[os.path.expandvars()](http://docs.python.org/3.0/library/os.path.html#os.path.expanduser)。诚然，它经常用于处理路径：

```
>>> import os.path
>>> os.path.expandvars('%APPDATA%\\MyApp')
'C:\\Documents and Settings\\Administrator\\Application Data\\MyApp' 
```

但它真的是一个shell函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T19:13:37.407

我猜你的意思是“我如何获取环境变量？”：

```
import os
username = os.environ['UserName'] 
```

或者，您可以使用：

```
username = os.getenv('UserName') 
```

要添加/更改您自己的变量，您可以使用：

```
os.putenv('MyVar', 'something I want to store') 
```

# python - 比较复合类的pythonic方法？

> ID：722741
> 
> 赞同：2
> 
> 时间：2009-04-06T19:07:55.503
> 
> 标签：python

我有一个类作为树中的一个项目：

```
class CItem( list ):
  pass 
```

我有两棵树，每棵树都以 CItem 为根，每个树项都有一些 dict 成员（如 item._test = 1）。现在我需要比较这棵树。我可以建议重载 CItem 的比较运算符：

```
class CItem( list ):
  def __eq__( self, other ):
    # first compare items as lists
    if not list.__eq__( self, other ): return False
    # now compare dict members
    if self.__dict__ != other.__dict__: return False
    # seems equal
    return True 
```

现在我可以使用 '==' 或 '!=' 比较两棵树。这是一种“pythonic”方式还是可以轻松完成这种比较？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T19:22:44.217

我的感觉是

```
class CItem(list):
    def __eq__(self, other):
        return list.__eq__(self, other) and self.__dict__ == other.__dict__ 
```

但它基本上与您拥有的代码相同，只是用更短的符号表示。我想不出任何更实质性的改变来临时做。

# c# - 生成一个类的所有可能排列

> ID：722749
> 
> 赞同：2
> 
> 时间：2009-04-06T19:10:11.830
> 
> 标签：c#, algorithm

我有以下课程。出于测试目的，我想获得类 Client 的所有可能排列。我知道这个数字可能非常大，但这不是我现在的问题。

客户：否（int），名称（字符串），地址（地址对象）
地址：街道（字符串），国家（字符串）等。

对于 int 类型的属性，我总是对字符串（null、string.Empty、“Hello World”等）尝试相同的三个值（-1、0、1）。对于基本类型，它运行良好。但是，对于地址类，这是不同的。

简而言之，我正在尝试编写一个足够通用的方法来获取任何类型（类等）并获取所有可能的排列（换句话说：public IEnumerable GetPermutations(Type myType)）。在 .NET Reflection 的帮助下，此方法将循环所有可设置的属性。

有人知道怎么做吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T19:14:05.923

[PEX](http://research.microsoft.com/en-us/projects/Pex/)测试框架做了一些类似的事情。它试图提供几种方法参数的排列，以便涵盖潜在有用的测试用例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T19:53:16.890

这是一个可以帮助您入门的课程，尽管我没有对其进行太多测试。请注意，这仅适用于具有无参数构造函数的类，并且不适用于某些类型的递归类（例如，具有自身类型属性的类，例如树）。您可能还希望在静态构造函数中预填充更多类。

```
public static class PermutationGenerator
{
    private static class Permutation<T>
    {
        public static IEnumerable<T> Choices { get; set; }
    }

    static PermutationGenerator()
    {
        Permutation<int>.Choices = new List<int> { -1, 0, 1 }.AsReadOnly();
        Permutation<string>.Choices = new List<string> { null, "", "Hello World" }.AsReadOnly();
    }

    public static IEnumerable<T> GetPermutations<T>()
    {
        if (Permutation<T>.Choices == null) {
            var props = typeof(T).GetProperties().Where(p => p.CanWrite);
            Permutation<T>.Choices = new List<T>(GeneratePermutations<T>(() => Activator.CreateInstance<T>(), props)).AsReadOnly();
        }
        return Permutation<T>.Choices;
    }

    private static IEnumerable GetPermutations(Type t) {
        var method = typeof(PermutationGenerator).GetMethod("GetPermutations", new Type[] {}).MakeGenericMethod(t);
        return (IEnumerable)(method.Invoke(null,new object[] {}));
    }

    private delegate T Generator<T>();

    private static IEnumerable<T> GeneratePermutations<T>(Generator<T> generator, IEnumerable<PropertyInfo> props)
    {
        if (!props.Any())
        {
            yield return generator();
        }
        else
        {
            var prop = props.First();
            var rest = props.Skip(1);

            foreach (var propVal in GetPermutations(prop.PropertyType))
            {
                Generator<T> gen = () =>
                {
                    var obj = generator();
                    prop.SetValue(obj, propVal, null);
                    return (T)obj;
                };
                foreach (var result in GeneratePermutations(gen, rest))
                {
                    yield return result;
                }
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T19:14:01.930

大多数重要的动态分配的对象——比如字符串——没有有限数量的不同“排列”它们可以存在。在你的RAM用完之前，该字符串可以任意长。

因此，这确实是一项完全西西弗斯式的任务，除非您对要寻找的排列类型施加更多严格的限制，否则按照所述进行它是没有意义的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T19:15:11.210

你可以看看 PEX

[http://research.microsoft.com/en-us/projects/pex/default.aspx](http://research.microsoft.com/en-us/projects/pex/default.aspx)

它是一个集成在 Visual Studio 中的白盒测试生成工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T19:36:34.357

正如许多人所说，对于非平凡的类，生成所有排列在计算上是不可行的。我必须做并取得巨大成功的是，为特定范围的输入生成一个类的所有排列；即，给定一个具有属性 A、B 和 C 的类，我想生成 A=1、A=2、B=1、C=3 和 C=4 的所有排列，结果是：

A=1, B=1, C=3

A=2, B=1, C=3

A=1, B=1, C=4

A=2, B=1, C=4

这种事情可以通过递归算法或一些非常优雅的 LINQ 查询来完成。[这里](http://dotnet.dzone.com/news/selectmany-probably-the-most-p)有一篇相当详尽的文章，但它的编程量很大，如果你对你的集合论有足够的了解，它真的很有帮助。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-06T19:12:50.763

这就像要求在 1 小时内将中国的长城移入太空。这是不可能的。

您需要知道是什么定义了每种类型的每种排列，甚至是您没有创建的类型，这是不可能的。

# git - 我可以在本地托管的 Git 存储库服务器

> ID：722765
> 
> 赞同：20
> 
> 时间：2009-04-06T19:15:03.910
> 
> 标签：git

有谁知道我可以在类似于 GitHub 的自己的服务器上托管的 Git 存储库浏览器？我真的很喜欢 GitHub 浏览和历史界面，但我最喜欢的部分是网络图。我想运行这样的东西来查看我自己的存储库中的分支和合并。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-06T19:20:40.103

您可以下载并设置[Gitorious](http://gitorious.org)。它是免费的开源 git 托管软件。我不确定它具有的所有功能，因此请仔细查看，它可能适合您。

2016 年 1 月更新：

[Gitlab](https://gitlab.com)正在成为自托管 Github 克隆的事实标准。

[Gogs](https://github.com/gogits/gogs)是一个更简单的克隆，可以很好地适用于较小的项目。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-06T19:35:01.740

支付 github 私人托管似乎是最快的方式。网络查看器是完全专有的。

[repo.or.cz](http://repo.or.cz/)上有一些补丁，它们[将与 gitk 类似的界面添加到 vanilla gitweb](http://repo.or.cz/w/git/gitweb.git)前端。它是，或者至少在我尝试它的时候，是一个完全痛苦的设置，但对于你自己的项目是可行的。

输出真的很像 gitk，喜欢或厌恶它，所以如果你习惯了它至少是熟悉的。这是[git 本身的图形日志](http://repo.or.cz/git-browser/by-commit.html?r=git.git)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-07T10:30:28.530

如果您使用 MacOS，请尝试[GitX](http://gitx.frim.nl/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-30T13:36:24.347

你现在的另一个选择是[http://gitlab.org/](http://gitlab.org/)

它是开源的并且可以免费使用。虽然它是基于 ruby​​ on rails 的，所以它可能不适用于您的普通 php 托管服务。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-13T16:52:11.830

Git 带有一个内置的 web 视图：[gitweb](https://git.wiki.kernel.org/index.php/Gitweb)。您可能已经将它安装为 /usr/share/gitweb 或类似的位置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-27T08:31:30.123

**[codeBeamer](http://www.intland.com/products/codebeamer/overview/)可以安装在您自己的服务器上，作为“内部网 GitHub”。**

它完成了 GitHub 所做的一切：Git 存储库托管、工作流和拉取请求、问题跟踪、wiki、二进制下载等等等。它实际上没有网络图，因为这个功能被认为是“很高兴拥有”，而不是我们用户中的“必须拥有”的功能。

（免责声明：我们开发此商业产品。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-07-06T12:34:10.280

[Gitblit](http://gitblit.com)是用于小型工作组的开源、集成、纯 Java Git 服务器、查看器和存储库管理器。当前版本（0.5.1）不支持网络图之类的东西，但它是一个快速且易于使用的工具，用于托管和浏览 git 存储库。

# wpf - WPF 数据绑定和类型转换

> ID：722770
> 
> 赞同：4
> 
> 时间：2009-04-06T19:17:18.693
> 
> 标签：wpf, data-binding, mvvm

我有一个关于 WPF 绑定和转换 XAML 中 UI 对象看到的数据类型的问题。

我有一个用户控件，我想在不同的应用程序中重用它。用户控件显示一个缩略图和几个 TextBlocks 来显示人员的人口统计信息，例如姓名和地址。用户控件用于 MVVM 设计，因此它绑定到特定于用户控件的 ViewModel。

遵循典型的 MVVM 设计原则，用户控件的 ViewModel 通常嵌入到其他 ViewModel 中以构成更大的 UI。

用户控件视图模型期望某个类型（类）作为其绑定对象。然而，嵌入UC的VM的ViewModel具有完全不同的对象模型，因此它们不能简单地将数据传递给UC的VM。需要将父 VM 的数据模型转换为 UC VM 的数据模型。

我的问题是：是否有一种认可的方式来执行这种转换？

我查看了 IValueConverter 和 IMultiValueConverter ，这些看起来不像是要走的路。

我想我需要的是父 VM 和嵌入式 UC VM 之间的一种 shim，其中父 VM 的数据被转换为 UC VM 所需的格式。

或者，它基本上归结为我必须编写一个自定义 UC VM 来处理父 VM 提供的任何类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-20T03:09:19.717

我同意肯，我认为他有答案。如果您有 n 个要传递到通用用户控件的数据配置，那么您希望该数据配置的所有者将其转换为通用表单以绑定到用户控件。

使用该控件的每个视图都将具有相应的视图模型，该模型以通用格式公开属性：

```
public class SampleViewModel {
   ...

    IUserControlData ControlData 
    { 
       get 
       {
          // Do conversion here or do it early and cache it.
       }
    }

   ...
} 
```

然后您将该属性绑定到视图中的用户控件

```
<common:CommonUserControl DataContext={Binding Path=ControlData} ... > 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T20:17:08.487

如果父虚拟机是子虚拟机的超集，通常父虚拟机只会持有对子虚拟机的引用。它会将该引用作为属性公开，并且您会将 a `ContentControl`（或其他）绑定到该属性。

这不能解决你的问题吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T17:55:03.153

如果您真的想要并且需要进行类型转换，那么值转换器正是您想要使用的。也就是说，通常由 IValueConverter 之类的东西处理的转换类型相对简单直接。

但是，如果您的顶级/父/管理用户控件需要将一些较大类型的点点滴滴解析给承载其实际内容的用户控件，那么这就是该顶级控件的工作。不要全神贯注于在 XAML 中执行所有这些操作。解析出您需要的内容并直接设置这些子控件属性是非常好的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-07T23:27:53.530

可能不是您正在寻找的，但这是 DataGrid 动态列的解决方案。使用数据网格，您可以传递参数。 [http://www.codeproject.com/Articles/36496/Binding-a-Silverlight-DataGrid-to-dynamic-data-Part-2-editable-data-and-INotifyPropertyChanged.aspx](http://www.codeproject.com/Articles/36496/Binding-a-Silverlight-DataGrid-to-dynamic-data-Part-2-editable-data-and-INotifyPropertyChanged.aspx)

# vba - Access 中的 VB：组合框值在表单视图中不可见，但通过 Debug.Print 可见

> ID：722771
> 
> 赞同：0
> 
> 时间：2009-04-06T19:17:36.680
> 
> 标签：vba, ms-access-2007

表单 onLoad 中的代码：

```
 country_combo.RowSourceType = "Value List" 
```

重置函数中的代码：

```
 Dim lListIndex As Long

  With Me.country_combo
    For lListIndex = .ListCount - 1 To 0 Step -1
      .RemoveItem (lListIndex)
    Next lListIndex<br/>
  End With 
```

填充国家组合的代码：

```
 *For n = 1 To numCountries*
    *countryCombo.AddItem (countryRS.Fields("countryName"))*
    *countryRS.MoveNext*
  *Next n* 
```

在填充国家/地区组合框的代码运行后，我遇到了一个问题。这些值在那里，因为我可以运行 Debug.Print(countryCombo.Value) 并打印出所选国家/地区的名称，但我根本看不到组合框中的值。它们是不可见的，据我所知，特定项目没有可见性属性，除非我完全弄错了。

[comboBoxError.png http://img110.imageshack.us/my.php?image=comboboxerror.png](http://img110.imageshack.us/my.php?image=comboboxerror.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T18:51:56.220

I think you should probably use Access's GUI tools to do what you're looking for. In design mode, click on the field you are trying to populate, then click the "lookup" tab. You can then specify a table to populate the field with and your forms should automaticly update as well.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-12T13:45:54.627

我在使用 Access 2003 时遇到了类似的问题。基于对一个组合框的选择，列表框的行源设置为 SQL 字符串基本上是 SELECT DISTINCT [MyField_Selected] FROM MyTable。对于某些字段，值在列表框中可见，而其他字段则不可见。但是，这些值在那里，因为我可以通过代码访问它们。为了使它更有趣，它在 Access 2007 中运行良好。刚刚在另一个论坛上找到了解决方案。检查表格上相关字段的格式属性。就我而言，当 Access 2007 创建表时，它在其中放置了 @ 格式。我删除了它，一切都很好！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T04:20:27.233

我还看到了您在此处描述的内容-据我所知，这是 Access 中的一个错误（我使用的是 2007 年），仅当您以编程方式弄乱组合框的内容时才会发生这种错误。它不会每次都发生。如果您突出显示组合框中的文本，该问题会自行纠正。

# asp.net - ASP.NET 2.0 安全成员资格提供程序模式

> ID：722772
> 
> 赞同：1
> 
> 时间：2009-04-06T19:18:02.733
> 
> 标签：asp.net, asp.net-mvc, asp.net-2.0

我在 ASP MVC 中创建一个网站。任何人都可以通过以下方式给我一些关于使用内置会员提供程序的建议。

我希望我的用户为自己创建一个管理帐户，然后为其组织中的人员或他们想要授予访问权限的人员创建帐户。

我猜在数据库中它看起来像这样：

公司有管理员。管理员可以授予用户访问权限。

我确信这种模式到处都在使用，我只是不知道如何实现它。特别是使用会员提供者。

谢谢，

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T20:06:24.427

实现这一点并没有什么特别之处。它可以通过 ASP.NET 2.0 的内置功能轻松实现：

1.  配置网站以使用成员资格（通过`web.config`）
2.  启用角色管理（通过`web.config <roles enabled="true"> tag`）
3.  将管理员帐户添加到`Administrators`角色。
4.  通过在控制器操作中使用`[Authorize(Roles="Administrators")]`属性来控制对管理页面的访问。
5.  要求对其他非管理员操作进行身份验证 ( `[Authorize]`)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T20:21:56.027

当我这样做时，我使用 Membership Provider 进行身份验证，但是，我从 Provider 外部创建了组织概念。您可以使用配置文件提供程序。

至于角色，我仍然会使用 ASP.Net 成员模型中的角色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T20:24:04.757

您可以为这些人创建一个角色并将其命名为组织管理员之类的名称，尽管这有点长，但您明白我的意思:)。并赋予这些人创建具有常规用户角色的用户的权力。至少我在我的一个应用程序中就是这样做的。

当然，您将把管理员留给自己或负责这个特定站点的人。

[Gu 的博客](http://weblogs.asp.net/scottgu/archive/2008/07/14/asp-net-mvc-preview-4-release-part-1.aspx)有一个关于如何在动作过滤器中实现角色的小示例。

# java - 获取蚂蚁 识别类路径

> ID：722774
> 
> 赞同：43
> 
> 时间：2009-04-06T19:18:18.347
> 
> 标签：java, ant, classpath

我有一个 Apache Ant 构建文件，其中包含一个`<javac>`命令，该命令需要四个特定的 JAR 才能在构建`classpath`中。我试过这样做：

```
<project basedir=".." default="build_to_jar" name="Transnet Spectrum Analyzer">
    <property environment="env"/>
    <property name="src" value="src"/>
    <property name="libsrc" value="library_sources" />
    <property name="build" value="build"/>
    <property name="dist" value="dist"/>
    <property name="target" value="1.5"/>
    <property name="libraries" value="./libraries"/>

    <fileset dir="." id="TSA.classpath">
        <include name="${libraries}/rxtx/RXTXcomm.jar" />
        <include name="${libraries}/commons-logging-1.1.1.jar" />
        <include name="${libsrc}/JCommon/jcommon-1.0.15.jar" />
        <include name="${libsrc}/JFreeChart/jfreechart-1.0.12.jar" />
    </fileset>

    <target name="compile" depends="clean,init" description="compile the source " >

        <echo>Compile from ${src} to ${build}</echo>

        <javac destdir="${build}" source="${target}" target="${target}">
            <compilerarg value="-Xlint:unchecked"/>
            <src path="${src}"/>
            <classpath path="TSA.classpath" />
        </javac>
    </target>

    <!-- blah blah blah -->
</project> 
```

…但没有`TSA.classpath`出现中指定的文件。如何在我的类路径中包含这些文件？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-04-06T19:22:46.730

这是我目前正在从事的一个项目的一个例子。我怀疑你可以修改它以适应你的情况。

```
<path id="master-classpath">
  <fileset dir="${web.dir}/WEB-INF/lib">
    <include name="*.jar"/>
  </fileset>

  <fileset dir="${appserver.lib}">
    <include name="servlet*.jar"/>
  </fileset>

  <pathelement path="${build.dir}"/>
</path>

...

<javac destdir="${build.dir}">
  <src path="${src.dir}"/>
  <classpath refid="master-classpath"/>
</javac> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-06T19:21:11.257

尝试

```
<javac ... classpathref="TSA.classpath"> 
```

或者

```
<javac ...>
    ...
    <classpath refid="TSA.classpath" />
</javac> 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-06T19:21:09.230

试试这个：

```
 <classpath refid="TSA.classpath"/> 
```

# sql-server - 如何彻底清除 SQL Server 2005 数据库？

> ID：722778
> 
> 赞同：4
> 
> 时间：2009-04-06T19:20:32.820
> 
> 标签：sql-server

我制作了一个用于 Web 应用程序的数据库的副本，以创建该 Web 应用程序的新实例。我想知道如何删除所有数据和事务以及什么不是这样，它只是一个干净的空表壳，准备好用新数据写入？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-06T19:27:58.340

[Sql Server 数据库发布向导。](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A) 创建仅包含架构的脚本，指定删除现有对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T19:29:58.320

运行这个脚本：

```
select 'TRUNCATE TABLE ' + name from sysobjects where xtype='U' 
```

然后将结果粘贴到一个新脚本中并运行它

（看在上帝的份上，小心点！）:)

编辑

从评论看来，TRUNCATE 无法从具有外键的表中删除行。

你可以使用

```
select 'DELETE FROM ' + name from sysobjects where xtype='U' 
```

并且您还必须重新排列输出以首先从子表中删除。其他人建议编写一个干净的数据库脚本，这可能是一个更好的主意 TBH。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T19:28:34.220

取消注释 -- 实际运行...小心！

```
声明@t varchar (1024)
为 tbl_cur 游标声明  
从 INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' 中选择 TABLE_NAME

打开 tbl_cur

FETCH NEXT 从 tbl_cur INTO @t

而@@FETCH_STATUS = 0
开始
--EXEC ('截断表'+ @t)
FETCH NEXT 从 tbl_cur INTO @t
结尾

关闭 tbl_cur
DEALLOCATE tbl_Cur

```

**编辑：** 回答评论问题......该死的好问题。我想你可以找到所有的外键并将它们保存下来

```
SELECT 'ALTER TABLE' + b.TABLE_NAME + ' WITH CHECK ADD CONSTRAINT [' + a.CONSTRAINT_NAME + '] FOREIGN KEY '
    + c.COLUMN_NAME + ' REFERENCES [' + d.TABLE_NAME +'] ([' + e.COLUMN_NAME + '])'
FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS 一个
INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS b
    ON a.CONSTRAINT_NAME = b.CONSTRAINT_NAME
INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS d
    ON a.UNIQUE_CONSTRAINT_NAME = d.CONSTRAINT_NAME
INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
ON a.CONSTRAINT_NAME = c.CONSTRAINT_NAME
内部联接 （
    选择
    f.TABLE_NAME，
    g.COLUMN_NAME
FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS f
内部连接 ​​INFORMATION_SCHEMA.KEY_COLUMN_USAGE g
    开启 f.CONSTRAINT_NAME = g.CONSTRAINT_NAME
其中 f.CONSTRAINT_TYPE = '主键'
) e
ON e.TABLE_NAME = d.TABLE_NAME
由 a.CONSTRAINT_NAME 订购

```

然后你可以放弃所有这些（我认为你放弃约束的顺序并不重要）

```
SELECT 'ALTER TABLE' + col.TABLE_NAME + ' DROP CONSTRAINT ' + u.CONSTRAINT_NAME
FROM INFORMATION_SCHEMA.COLUMNS 列
INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE u
    ON col.TABLE_NAME = u.TABLE_NAME
    AND col.COLUMN_NAME = u.COLUMN_NAME
INNER JOIN INFORMATION_SCHEMA.table_constraints t
    ON u.CONSTRAINT_NAME = t.CONSTRAINT_NAME
WHERE t.CONSTRAINT_TYPE = '外键'

```

然后使用第一个游标截断所有表。然后，您可以使用您保存的脚本的结果来重新创建所有 FK 关系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T19:30:02.157

我不知道任何一步神奇的银弹命令可以做到这一点，但如果你想保留你的表/模式，你可能需要为每个脚本编写一个截断表。

或者，您可以编写整个数据库的脚本，并在删除“已使用”的数据库后使用该脚本重新生成一个新数据库。有道理？

右键单击您要处理的数据库，选择 Script Database As（从顶部开始的第三个选项），然后选择 DROP and CREATE to ... 此时您可能想要对文件或剪贴板执行此操作并粘贴它在某处。

然后，将此文件用作您的脚本，运行它以创建一个干净漂亮的数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T19:40:56.670

您可以创建一个空数据库，然后使用[SQL Compare](http://www.red-gate.com/sqlcompare/)之类的工具将现有数据库与空数据库进行比较，以生成脚本以完全从头重新创建数据库。

您还可以使用以下 SQL：

```
--// Switch to the database to be modified
USE DatabaseName;

--// The following commands need to be run for each table
--// You could perhaps automate this by using a cursor
--// First truncate the table and remove all data
TRUNCATE TABLE MyTable;

--// Also reset the identity seed
DBCC CHECKIDENT (MyTable, reseed, 1) 
```

我建议从头开始重新创建数据库结构，而不是进行备份和恢复到新数据库，因为这将为您提供一个完全干净的数据库，没有任何“残留物”（如事务日志中的内容） ）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T19:52:06.067

如果您没有定义外键，则截断将起作用（如果您不这样做，请添加它们）。

如果您使用 SQL Server 2005（08 可能相同），您可以从 Sql Server Management Studio 中为整个数据库生成一个脚本。右键单击要编写脚本的数据库。

然后转到任务，并生成脚本。编写所有对象的脚本，然后您可以使用此脚本仅基于模式构建数据库的新副本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-23T18:37:11.307

您可能需要考虑只生成一个仅包含现有数据库结构的 t-sql 脚本。SQL Server 管理控制台使这变得非常容易，因为您只需右键单击原始数据库，选择“任务->生成脚本”。从那里，只需单击默认值并选择要复制的对象（表格等）。

这会生成一个不错的 T-SQL 脚本，您可以将其应用于任何空白数据库，从而在没有数据的情况下为您提供您正在寻找的结构。对我来说，与截断相比，这似乎是一个更合适的选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-23T18:50:45.313

This [article](http://smallworkarounds.blogspot.com/2009/02/script-to-delete-all-data-from-sql.html) presents store-procedure without any of the mentioned problems.

The key is to disable referential integrity :)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-06T19:27:02.197

您只需截断每个表，如

```
use [dbname]
truncate table [table] 
```

其中 [dbname] 是复制的数据库的名称，您将为数据库中的每个表复制第二行。

我敢肯定，大约需要 5-10 分钟，您可以创建一个脚本来读取 systables 中列出的所有可用表，并使用该信息进行 while 循环，这样您就不必编写“截断表 [表]" 为每个表，但这是一般的想法。

--

行，

对于所有在我之后回答的人，我正在发生这种心理“内疚”的事情，因为我没有写到他应该创建一个 TSQL 脚本并以此重新创建一个数据库。

我没有走那条路有几个原因。

1.  你不知道他在数据库中拥有什么样的“静态”数据。
2.  他专门询问了如何清除数据库。
3.  我目前不知道@OP 在系统的其余部分中内置了什么。可能存在依赖关系，即他需要原始副本才能满足条件。

如果这位先生以不同的方式问这个问题，我可能确实像很多人一样回答了，只是说要编写数据库脚本。

# c# - 将环境变量传递给数据访问层

> ID：722780
> 
> 赞同：0
> 
> 时间：2009-04-06T19:20:43.333
> 
> 标签：c#, data-access-layer

我们编写的每个存储过程都必须将 clientip、serverip、windows 用户名等传递给它。

问题是我如何有效地将这些传递给 DAL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T19:32:35.317

我假设这是 ASP.NET 中的 Web 应用程序。如果是这种情况，您可以通过以下静态实例在 Web 应用程序之外的 Web 请求上下文中访问所有这些内容：

```
System.Web.HttpContext.Current 
```

如果您需要的一切都是您通常在页面级别默认可用的请求、响应和用户对象中拥有的标准东西，那么这应该就是您所需要的。如果您需要为您的网络应用程序定制的信息，那么 Ben 的答案（上图）应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T19:26:38.920

您应该可以在 System.Environment 类或您自己的某种线程主体中访问所有上述数据。您的 DAL 可以轻松地从这两个或任何一个来源中获取信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T19:27:27.297

创建一个类来保存这些数据，一个工厂来构建它和辅助方法来使用它。

```
IUserContext
{
int param1 {get;set;}
int param2 {get;set;}

SqlParameter[] GetSqlParameters();
}

UserContext : IUserContext{}

UserContextFactory
{
    internal IUserContext IUserContextFromRequest(){}
} 
```

祝你好运

# iphone - 基于 indexPath.row 启动 UITableViewCells 的问题

> ID：722785
> 
> 赞同：0
> 
> 时间：2009-04-06T19:21:51.227
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我有以下方法应该用数组中的数据填充我的 UITableView 的单元格。我想使用正在加载数据的行作为索引从数组中获取数据。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    cellComments=(FullCommentCell *)[tableView dequeueReusableCellWithIdentifier:FullCommentCell_ID];
    if(cellComments==nil)
    {
        [[NSBundle mainBundle]loadNibNamed:@"FullCommentCell" owner:self options:nil];
        NSLog([NSString stringWithFormat:@"%i",indexPath.row]);
        [cellComments loadFullComments:[latestFMLComments objectAtIndex:indexPath.row]];
    }
    //cellComments.userInteractionEnabled=NO;
    return cellComments; 
```

}

这没有按预期工作。该表最终只填充了我的数组的前三个元素，然后这些数据被重复使用，直到我的表结束。该表应该使用我数组中的所有数据。知道为什么这不能按预期工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T20:07:37.823

每次返回单元格时，您都需要设置正确的单元格数据，无论它是新的还是重复使用的。向下滚动时，表格顶部的单元格将被移除并重新用于表格底部。这就是为什么您会看到前几个数据项重复的原因。

```
- (UITableViewCell *)tableView:(UITableView *)tableView 
         cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    cellComments = (FullCommentCell *)[tableView dequeueReusableCellWithIdentifier:FullCommentCell_ID];
    if (cellComments == nil) {
        [[NSBundle mainBundle]loadNibNamed:@"FullCommentCell" owner:self options:nil];

        // Do any one-time setup here, like adding subviews
    }

    // Set cell data for both new and reused cells here

    [cellComments loadFullComments:[latestFMLComments objectAtIndex:indexPath.row]];
    //cellComments.userInteractionEnabled=NO;

    return cellComments;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T19:43:25.650

当您从 dequeueReusableCellWithIdentifier 调用中取回 cellComments 时，您需要再次调用 loadFullCommnents - 单元格被重用，因此您只会创建与屏幕上显示的一样多的单元格。

# c# - 如何从 C++ 下标运算符所在的类中访问它？

> ID：722788
> 
> 赞同：4
> 
> 时间：2009-04-06T19:23:02.843
> 
> 标签：c#, c++, subscript-operator

其中，ClassA 有一个这样的运算符，它返回 ClassB：

```
class ClassA
{
public:
    ClassA();
    ClassB &operator[](int index);
} 
```

如果我想从 ClassA 的构造函数中访问所述运算符，如下所示：

```
ClassA::ClassA()
{
    // How do I access the [] operator?
} 
```

目前，作为一种变通方法，我只使用 [] 运算符调用的名为 GetAtIndex(int index) 的方法，构造函数也是如此。

如果我可以像 C# 一样访问它，那就太好了：

```
// Note: This is C#
class ClassA
{
   ClassB this[int index]
   {
       get { /* ... */ }
       set { /* ... */ }
   }

   void ClassA()
   {
       this[0] = new ClassB();
   }
} 
```

**注意：**我正在使用 g++

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-06T19:28:03.457

您可以使用：

```
this->operator[](0) = ... 
```

或者：

```
(*this)[0] = ... 
```

但是语法有点尴尬。我通常会调用另一种方法`get`并使用它，例如：

```
ClassB& get(size_t index) {
    return this->operator[](0); // or something more direct
} 
```

然后当你想使用它时，你可以说：

```
this->get(0) = ... 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-06T19:26:17.767

尝试以下

```
(*this)[0] = ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T19:25:58.220

```
 ClassA::ClassA()
 {
     this->operator[]( someindex ) = whatever;
 } 
```

但是请确保在使用之前完全构造了操作员可能依赖的任何成员数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T19:32:33.260

还有一种方法，不知道有没有用...

```
ClassA::ClassA()
{
    ClassA &_this = *this;
    _this[0] = someValue;
    _this[1] = someValue;
    _this[2] = someValue;
    _this[3] = someValue;
    _this[4] = someValue;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T15:02:32.577

两种不同的方式：

```
( *this ) [ index ] or this -> operator [ ] ( index ) 
```

# .net - 我可以从 .NET CF 应用程序读取 Windows Mobile 手机上存储的 SMS 条目吗？

> ID：722796
> 
> 赞同：0
> 
> 时间：2009-04-06T19:26:33.243
> 
> 标签：.net, compact-framework, sms

查看使用 .NET Compact 框架编写应用程序以在我的 Windows Mobile 手机上提取 SMS 消息。我基本上希望能够导出收件箱中存储的消息，以便可以将它们导入 Excel 或其他程序进行格式化和存储。

就我个人而言，我有一台 Treo 700w。我之前在 Compact Framework 下编写了一些小应用程序，但我找不到任何引用文本消息存储位置的内容。我的手机中存储了大约 7000 条消息，我想提取它们以释放内存。出于法律原因，我可能不得不保留这些消息，因此就我的手机而言，我想将它们“离线”保存。

有没有人不得不这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T19:36:33.233

我不相信 .NET Framework（紧凑型或其他）包含通过[CE MAPI](http://msdn.microsoft.com/en-us/library/bb415647.aspx)完成的用于处理 SMS 的 API 。换句话说，您必须使用互操作，或者用 C++ 编写应用程序。或者，如果您很懒惰，则可以使用[wrapper](http://www.codeproject.com/KB/mobile/PocketPCandSmartphone.aspx)。=)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T00:18:43.547

如果您的目标是 WM6，则可以使用 Microsoft.WindowsMo​​bile.PocketOutlook 命名空间来访问 SMS 消息，尤其是[SmsAccount](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.pocketoutlook.smsaccount.aspx)类。

# clipboard - 最喜欢的剪贴板扩展

> ID：722799
> 
> 赞同：-2
> 
> 时间：2009-04-06T19:27:14.770
> 
> 标签：clipboard

我在编写代码时使用[同上剪贴板扩展，它非常适合复制变量名称、数据等。](http://ditto-cp.sourceforge.net/)人们还使用哪些其他剪贴板扩展？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T19:45:32.043

我使用自己用 Tcl/tk 编写的工具。它只保存文本，但它允许我以可滚动堆栈的形式访问剪贴板。此外，我可以在粘贴之前编辑剪辑的内容，当我右键单击一个项目时，它会解析文本并尝试给我一个有用的菜单。例如，如果内容以“http”开头，则菜单包括“在浏览器中访问”）。

另外，它适用于我个人使用的所有平台（win、*nix、mac）。早在 1999 年左右就写好了，今天仍然运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T12:31:28.973

[适用于 Windows 的ClipX](http://www.bluemars.org/clipx/)。
我正在为 Linux 寻找另一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-30T00:24:10.570

看起来同上对我来说仍然是最好的。

# c++ - 解析配置的快速方法

> ID：722801
> 
> 赞同：1
> 
> 时间：2009-04-06T19:27:56.670
> 
> 标签：c++, stl

说你有

```
char *=  "name:454"; 
```

解析名称和数字的最佳方法是什么，因此

std:string id 将等于“名称”；

双 d 等于 454；

请STL，没有提升。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T19:30:25.167

您想查看用作令牌的[`strtok`](http://www.cplusplus.com/reference/clibrary/cstring/strtok.html)函数。`':'`这是一个例子：

```
#include <stdio.h>
#include <string.h>

int main ()
{
    char str[] = "name:454";
    char* c = strtok(str, ":");

    while (c != NULL)
    {
        printf("%s\n", c);
        c = strtok(NULL, ":");
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T19:34:41.647

我会使用getline。

示例：http: [//github.com/lennartkoopmann/scopeport-server/blob/23e3d2e2fede7ced0810deee0aa501a70a4eba40/src/core.cc#L1353](http://github.com/lennartkoopmann/scopeport-server/blob/23e3d2e2fede7ced0810deee0aa501a70a4eba40/src/core.cc#L1353)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T19:38:15.600

不是您要求的 stl 解决方案；但是，迟早您需要解析更复杂的表达式（提示 - 比您预期的要早），此时您将需要正则表达式 - 所以为什么不现在开始。你的表达被捕捉到：

```
^(\w+):(\d+)$ 
```

我不是boost狂热者，但他们的正则表达式库很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T19:41:17.090

```
#include <iostream>
#include <sstream>
#include <string>

int main() {
  /* output storage */
  std::string id; 
  double d;
  /* convert input to a STL string */
  std::string s("name:454");
  size_t off = std::string::npos;
  /* smart replace: parsing is easier with a space */    
  if ((off = s.find(':')) != std::string::npos) { // error check: all or none 
    s = s.replace(off, 1, 1, ' ');
    std::istringstream iss(s);
    iss >> id >> d;
    std::cout << "id = " << id << " ; d = " << d << '\n';
  }
  return 0;
} 
```

不过，我只是编写自己的解析器或使用 C 扫描仪功能来提高速度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T20:01:49.663

我会写我自己的。基本思想是一次从流中读取一个字符。如果不是冒号，则将其附加到 id 字符串。如果是，请跳过它，然后使用 istream >> 运算符加载整数、双浮点数或任何需要的值。然后您可能将结果放入 std::map 中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T20:03:34.637

另一种可能性是使用已经编写好的解析器来处理像 INI 这样的简单格式。

这是一个：[http ://code.jellycan.com/SimpleIni/](http://code.jellycan.com/SimpleIni/)

我查看了 SimpleIni 的代码，它不是很 C++ 和 STL'ish，但你真的在乎吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-06T20:05:51.557

```
template < typename T >
T valueFromString( const std::string &src )
{
    std::stringstream s( src );
    T result = T();
    s >> result;
    return result;
}

std::string wordByNumber( const std::string &src, size_t n, const std::string &delims )
{
    std::string::size_type word_begin = 0;
    for ( size_t i = 0; i < n; ++i )
    {
        word_begin = src.find_first_of( delims, word_begin );
    }
    std::string::size_type word_end = src.find_first_of( delims, word_begin );

    word_begin = std::string::npos == word_begin || word_begin == src.length() ? 0 : word_begin + 1;
    word_end = std::string::npos == word_end ? src.length() : word_end;
    return src.substr( word_begin, word_end - word_begin);
}

char *a = "asdfsd:5.2";
std::cout << wordByNumber( a, 0, ":" ) << ", " << valueFromString< double > ( wordByNumber( a, 1, ":" ) ); 
```

PS：在之前的版本中，我发布了 wordByNumber - 它跳过了相邻的分隔符（例如:::），在当前版本中它们被视为空字。

# c# - 如何使用 C#/.NET 在 Windows 中处理拨号 (RAS) 连接？

> ID：722805
> 
> 赞同：5
> 
> 时间：2009-04-06T19:28:46.247
> 
> 标签：c#, .net, dial-up, ras

我需要能够在 C# .NET Framework 应用程序中连接、断开和重新连接拨号网络连接。在电话簿中创建连接也可能有用/必要。

是否有任何为 C# 或 .NET 编写的类或库可以很好地为我包装所有这些功能？有人愿意分享一些代码吗？

**注意**：应用程序是*无人值守*的，就像 Kiosk 一样，因此要求用户操作是不可接受的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-09T05:22:18.770

查看 CodePlex.com 上的 DotRas 项目，它已经完成了整个 API。

[http://www.codeplex.com/DotRas](http://www.codeplex.com/DotRas)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T19:50:49.097

一种方法是通过围绕 RAS 的互操作。RasDialDlg() 可用于打开拨号网络连接而不显示对话框。使用 RasHangUp() 断开连接。

RasEnumConnections() 可用于列出可用的连接。

dll 是 Rasapi32.dll - 标头位于 ras.h 和 raserror.h

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T19:47:39.790

这是从几个不同的类中删除的（由于可能的隐私问题而省略了一些代码），因此它可能无法使用直接副本进行编译。希望能帮助到你！

```
using System.Runtime.InteropServices;

[DllImport("wininet.dll")]
[return: MarshalAs(UnmanagedType.Bool)]
public extern static bool InternetGetConnectedState(
    out int connectionDescription,
    int reservedValue);

[DllImport("wininet.dll", SetLastError = true)]
[return: MarshalAs(UnmanagedType.I4)]
public static extern int InternetAttemptConnect(int dwReserved);

public sealed class InternetConnection
{
    private InternetConnection()
    { }

    public static bool IsConnected()
    {
        int connectionDescription = 0;

        return InternetGetConnectedState(out connectionDescription, 0);
    }

    public static int Connect()
    {
        return InternetAttemptConnect(0);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-25T21:53:09.377

```
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;

namespace MenelGameAuto.Internet
{
    class RAS
    {
        #region <Fields>

        private int rasConnectionsAmount; // ilość struktur typu RASCONN
        #endregion

        [DllImport("wininet.dll", CharSet = CharSet.Auto)]
        static extern bool InternetGetConnectedState(
            ref int lpdwFlags,
            int dwReserved);

        const int MAX_PATH = 260;
        const int RAS_MaxDeviceType = 16;
        const int RAS_MaxPhoneNumber = 128;
        const int RAS_MaxEntryName = 256;
        const int RAS_MaxDeviceName = 128;

        const int RAS_Connected = 0x2000;

        /// <summary>
        /// Wykazuje wszystkie połączenia RAS.
        /// </summary>
        [DllImport("rasapi32.dll", SetLastError = true, CharSet = CharSet.Auto)]
        private static extern int RasEnumConnections([In, Out] RASCONN[] lprasconn, ref int lpcb,ref int lpcConnections);

        [DllImport("rasapi32.dll", SetLastError = true, CharSet = CharSet.Auto)]
        static extern uint RasHangUp(IntPtr hRasConn);

        [DllImport("RASAPI32", SetLastError = true, CharSet = CharSet.Auto)]
        static extern int RasGetConnectStatus(IntPtr hrasconn, ref RASCONNSTATUS lprasconnstatus);

        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
        struct RASCONN
        {
            public int dwSize;
            public IntPtr hrasconn;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = RAS_MaxEntryName + 1)]
            public string szEntryName;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = RAS_MaxDeviceType + 1)]
            public string szDeviceType;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = RAS_MaxDeviceName + 1)]
            public string szDeviceName;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = MAX_PATH)]
            public string szPhonebook;
            public int dwSubEntry;
        }

        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
        struct RASCONNSTATUS
        {
            public int dwSize;
            public int rasconnstate;
            public int dwError;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = RAS_MaxDeviceType + 1)]
            public string szDeviceType;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = RAS_MaxDeviceName + 1)]
            public string szDeviceName;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = RAS_MaxPhoneNumber + 1)]
            public string szPhoneNumber;
        }

        /// <summary>
        /// Pobranie wszystkich połączeń RAS.
        /// </summary>
        /// <returns>Struktury połączeń RAS</returns>
        private RASCONN[] GetRasConnections()
        {
            // Stworzenie tablicy, którą później należy przekazać funkcjom
            int rasEnumReturn;
            RASCONN[] rasconnStructs = new RASCONN[256];
            rasconnStructs.Initialize(); // inicjalizacja wszystkich pól struktury
            rasconnStructs[0].dwSize = Marshal.SizeOf(typeof(RASCONN)); // inicjalizacja pierwszego pola pierwszej struktury na wartość wielkości tej struktury
            int sizeOfRasconnStruct = rasconnStructs[0].dwSize * rasconnStructs.Length; // wielkość pojedynczej struktury * ilosc

            // Wywołanie RasEnumConnections do zdobycia wszystkich aktywnych połączeń RAS
            rasEnumReturn = RasEnumConnections(rasconnStructs, ref sizeOfRasconnStruct, ref rasConnectionsAmount);

            // jeżeli RasEnumConnections nie zwróciło ERROR_SUCCESS
            if (rasEnumReturn != 0) throw new Win32Exception(rasEnumReturn);
            return rasconnStructs;
        }

        /// <summary>
        /// Rozłącza internet.
        /// </summary>
        public void Disconnect()
        {
            RASCONN[] rasStructs = GetRasConnections();

            // Przejście przez każdą strukturę RASCONN
            for (int i = 0; i < rasConnectionsAmount; i++)
            {
                // Pobranie pojedynczej struktury
                RASCONN rStruct = rasStructs[i];

                // Jeżeli uchwyt do połączenia wynosi 0, to brak połączenia
                if (rStruct.hrasconn == IntPtr.Zero) continue; // i następna struktura...

                // Rozłączenie...
                RasHangUp(rStruct.hrasconn);
            }
        }

        public void Connect()
        {
            // TODO
        }

        public bool IsConnected()
        {
            RASCONN[] rasStructs = GetRasConnections();

            RASCONNSTATUS rasConnStatus = new RASCONNSTATUS();
            rasConnStatus.dwSize = Marshal.SizeOf(typeof(RASCONNSTATUS));

            for (int i = 0; i < rasConnectionsAmount; ++i)
            {
                // Pobranie pojedynczej struktury
                RASCONN rStruct = rasStructs[i];

                int statusResult = RasGetConnectStatus(rStruct.hrasconn, ref rasConnStatus);
                if (statusResult != 0) throw new Win32Exception(statusResult);
                if(rasConnStatus.rasconnstate == RAS_Connected) return true;
            }
            return false;
        }
    }
} 
```

# php - 返回mysql查询的php函数

> ID：722808
> 
> 赞同：2
> 
> 时间：2009-04-06T19:29:50.253
> 
> 标签：php, mysql

我有一个非常简单的功能：

```
function experience_query($id) {
$sql = @mysql_query(
"
SELECT * FROM table WHERE id = $id
");
return("$sql");
} 
```

当我调用这个函数时：

```
$q = categories_query("1001"); 
while( $list = mysql_fetch_assoc($q) )
{
extract($list);
echo $name;
} 
```

我收到一个错误”“mysql_fetch_assoc()：提供的参数不是有效的 MySQL 结果资源...”

我可以从函数返回 mysql 查询吗？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-06T19:31:25.507

替换这个：

```
return("$sql"); 
```

有了这个：

```
return $sql; 
```

通过`$sql`用引号括起来，您将返回 MySQL 资源的字符串表示形式。

# c++ - 什么是 C/C++ 的优秀多平台矢量图形库？

> ID：722814
> 
> 赞同：10
> 
> 时间：2009-04-06T19:31:03.277
> 
> 标签：c++, c, vector-graphics

我正在为 C/C++ 中的矢量图形寻找一个好的多平台库。有什么建议或想法吗？

谢谢

编辑：感谢您的所有回答！！例如，谁能告诉我 qt vs cairo 的优缺点？开罗获得了更多的选票，但根据一些基准，它似乎慢了 5 到 7 倍......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-06T19:36:01.160

你可以试试[Cairo](http://cairographics.org/) - 它是开源的，不太重，并且有灵活的许可证。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-06T19:33:16.657

我喜欢诺基亚的[QT](http://qt.nokia.com/)。不仅是矢量图形，还有高级小部件。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-06T19:47:20.587

有[反晶粒几何](http://www.antigrain.com/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-07T09:05:49.217

不过，ImageMagick 或 OpenCV（计算机视觉）怎么样！它们都适用于基本图形，OpenCV 可以在计算机视觉方面发挥作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-07T09:43:26.770

如果要显示 DXF/DWG 等，请使用 www.CadSoftTools.com 的 CadImage.DLL。它的商业版，仅限 Windows，用 Delphi 编写（具有 C 接口）。我们尝试了几个具有巨大 (>100MB) DXF 文件的库。这是唯一没有崩溃的，也是最快的。大神也支持。公司在俄罗斯。

# jquery - jQuery .each() - 实际用途？

> ID：722815
> 
> 赞同：38
> 
> 时间：2009-04-06T19:31:14.930
> 
> 标签：jquery

我正在努力更好地理解[jQuery.each()](http://docs.jquery.com/Core/each)方法。这是我想出的一个例子，不是很实用，但它对返回的选定元素集中的每个选定项目执行一个操作：

```
// Loop over each link.
$( "#links a.number" ).each(

// For each number, run this code. The "intIndex" is the 
// loop iteration index on the current element.
function( intIndex ){

// Bind the onclick event to simply alert the iteration index value.
    $( this ).bind ("click", function(){
        alert( "Numbered index: " + intIndex );
    });
}); 
```

您在代码中使用的 .each 方法的实际用途有哪些示例？$(this) 究竟代表什么？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-04-06T19:37:17.273

请注意，jQuery 有两种类型*，*一种是迭代并返回 jQuery 对象，另一种是更通用的版本。

**核心/每个**
示例：创建页面上所有 href 的 csv。（迭代匹配的 DOM 元素，'this' 指向当前元素）

```
 var hrefs = "";

 $("a").each(function() { 
     var href = $(this).attr('href');
     if (href != undefined && href != "") {
         hrefs = hrefs + (hrefs.length > 0 ? "," + href : href);
     }
 });

 alert(hrefs); 
```

**Utilities/jQuery.each**
遍历数组或对象的元素：（通过： [jQuery 文档](http://docs.jquery.com/Utilities/jQuery.each#objectcallback)）

```
$.each( { name: "John", lang: "JS" }, function(i, n){
  alert( "Name: " + i + ", Value: " + n );
});

$.each( [0,1,2], function(i, n){
  alert( "Item #" + i + ": " + n );
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-06T19:40:03.350

我有时用它来遍历 XML 数据结果集中的大量子元素

```
 my parsedData = [];  
   $('result', data).each(function() {
      parsedData.push(  
         { name: $('name', this).text(),
           addr: $('addr', this).text(),
           city: $('city', this).text(),
           state: $('state', this).text(),
           zip: $('zip', this).text()
      }); 
```

这很好用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-06T19:32:49.700

一个简单的用法，但它对于遍历表和分割交替行非常方便：

```
// Adds CSS styling to alternate rows of tables marked with a .data class attribute.
$("table.data").each(function() {
    if (!$(this).hasClass("noStriping")) {
        $(this).find("tbody tr:nth-child(odd)").addClass("odd");
        $(this).find("tbody tr:nth-child(even)").addClass("even");
    }
}); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-06T19:54:07.200

我将该`.each()`方法用于`WebMethod`返回 JSON 字符串的 ASP.NET 调用。在此示例中，它使用从 Ajax 调用返回的值填充列表框：

```
async: true,
type: "POST",
url: "Example.aspx/GetValues",
data: "{}",
contentType: "application/json; charset=utf-8",
dataType: "json",
success: function(data) {
  var list = $('<select />');

  $.each(data.d, function(){
       var val = this.Value;
       var text = this.Text;
       list.append($('<option />').val(val).text(text));
  });

  $('#listbox').empty().append(list.find('option'));
}, 
```

ASP.NET 有一个内置的 JSON 序列化程序，它可以自动将一个类转换为您在本文底部看到的 JSON 字符串。下面是一个示例类，它可以由`WebMethod`:

```
public class Tuple
{
    public string Text;
    public int Value;

    public Tuple(string text, int val)
    {
        Text = text;
        Value = val;
    }
} 
```

而它`WebMethod`本身：

```
[WebMethod]
public static List<Tuple> GetValues()
{
    List<Tuple> options = new List<Tuple>();
    options.Add(new Tuple("First option", 1));
    options.Add(new Tuple("Second option", 2));
    return options;
} 
```

当您 `dataType: "json"`在 jQuery Ajax 选项中指定时，字符串会自动转换为 Javascript 对象，因此您可以简单地键入`this.Text`或`this.Value`获取数据。

这是从`WebMethod`上面返回的结果 JSON：

```
{"d":[{"Value":1,"Text":"First option"},{"Value":2,"Text":"Second option"}]} 
```

**注意：**[这里](http://encosia.com/2009/02/10/a-breaking-change-between-versions-of-aspnet-ajax/)解释了`data.d`参数（以及 JSON 字符串中看到的第一个值）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-01-08T16:35:19.807

`each()`是一个迭代器函数，用于循环对象、数组和类数组对象。普通对象通过其命名属性进行迭代，而数组和类数组对象通过其索引进行迭代。

例如：

**使用 .each() 方法进行数组迭代**

```
$.each( arr, function( index, value ){
  //code here
}); 
```

**使用 .each 方法的普通对象迭代**

```
$.each( { firstName: "Amit", lastName: "Gupta" }, function(firstName, lastName){
    console.log( " First Name: " + firstName + " Last Name: " + lastName);
}); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-08-10T07:07:10.193

`$.each()`用作 for 循环，并`$(this)`引用循环的当前对象。在下面的示例中，我们循环遍历表行`$(this)`表示它迭代的当前行。

**循环遍历数组**

```
// here's the array variable
 var myArray = ["apple", "mango", "orange", "grapes", "banana"];

 $.each(myArray, function (index, value) {
      console.log(index+' : '+value);
 }); 
```

* * *

**循环遍历表格行（HTML 元素）**

```
 $("#myTable tr").each(function () {
        var self = $(this);
        var col_1_value = self.find("td:eq(0)").text().trim();
        var col_2_value = self.find("td:eq(1)").text().trim();
        var col_3_value = self.find("td:eq(2)").text().trim();
        var col_4_value = self.find("td:eq(3)").text().trim();
        var result = col_1_value + " - " + col_2_value + " - " + col_3_value + " - " + col_4_value;
        console.log(result);
 }); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-06T19:37:41.607

您可以使用 each 函数来访问/修改任何未被 jquery 包装的 dom 属性。

我经常有一个网格/表格，其中有一列包含复选框。

我编写了一个选择器来获取复选框列表，然后将选中的属性设置为真/假。（全部选中，取消选中全部）。

您必须为此使用每个功能。

$(".mycheckbox").each(function() { this.checked = true; });

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-06-30T13:02:43.127

以下是教程链接：

```
$(function(){
            var ArrList=["Jaipur","Udaipur","Kota","Ahmedabad","Surat"];
                $(ArrList).each(function(index,item){
                    $("ul").append("<li>"+item+"</li>");
                });
        }); 
```

[https://www.youtube.com/watch?v=qiYdTv_sZyU](https://www.youtube.com/watch?v=qiYdTv_sZyU)

# c++ - 初始化类变量的正确位置？

> ID：722822
> 
> 赞同：24
> 
> 时间：2009-04-06T19:32:41.357
> 
> 标签：c++

初始化类数据成员的正确位置在哪里？我在这样的头文件中有类声明：

富.h：

```
class Foo {
private:
    int myInt;
}; 
```

然后我尝试在相应的 .cpp 文件中为 myInt 设置一个值：

Foo.cpp：

```
int Foo::myInt = 1; 
```

重新定义 myInt 时出现编译器错误。我究竟做错了什么？？？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-04-06T19:44:17.847

你有一个实例变量。类的每个实例都有自己的 myInt 副本。初始化它们的地方是在构造函数中：

```
class Foo {
private:
    int myInt;
public:
    Foo() : myInt(1) {}
}; 
```

类变量是类的每个实例仅共享一个副本的变量。这些可以在您尝试时进行初始化。（有关语法，请参阅 JaredPar 的答案）

对于整数值，您还可以选择在类定义中初始化静态常量：

```
class Foo {
private:
    static const int myInt = 1;
}; 
```

这是类的所有实例共享的单个值，无法更改。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-06T19:46:05.067

为了扩展 Jared 的答案，如果您想以现在的方式对其进行初始化，则需要将其放入构造函数中。

```
class Foo
{
public:
    Foo(void) :
    myInt(1) // directly construct myInt with 1.
    {
    }

    // works but not preferred:
    /*
    Foo(void)
    {
        myInt = 1; // not preferred because myInt is default constructed then assigned
                   // but with POD types this makes little difference. for consistency
                   // however, it's best to put it in the initializer list, as above
                   // Edit, from comment: Also, for const variables and references,
                   // they must be directly constructed with a valid value, so they
                   // must be put in the initializer list.
    }
    */

private:
    int myInt;
}; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-01-29T16:01:03.267

可以直接在头文件中初始化，在c++11或者gnu++11中：

```
int myInt = 1; 
```

请参阅这篇文章“ [C++11 花絮：非静态数据成员初始化器](https://web.archive.org/web/20160316174223/https://blogs.oracle.com/pcarlini/entry/c_11_tidbits_non_static)”

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-06T19:34:59.040

您正在尝试通过静态初始化构造初始化实例成员。如果您希望这是一个类级别的变量（静态），那么在变量之前加上 static 关键字。

```
class Foo {
private:
  static int myInt;
}; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-06T19:34:28.013

类变量必须标记为“静态”。如果您的变量是实例变量而不是类变量，则必须在构造函数或其他方法中对其进行初始化。

# scripting - 可编写脚本的 FTP 客户端

> ID：722825
> 
> 赞同：2
> 
> 时间：2009-04-06T19:33:02.073
> 
> 标签：scripting, ftp

我需要一个脚本下载给定目录中的所有文件。我只有 ftp 访问权限。

快速测试表明我无法让我的 ftp 客户端从命令行登录。即使在尝试了 Arnshea 的回答后，它也拒绝从文件*或*标准输入中读取密码。

即使登录后我也无法下载通配符。（已*修复`mget`，感谢 Arnshea*）

尝试`wget`也失败了。

只要简单，我就可以使用 Windows 或 Linux。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-06T19:34:54.003

如果你在 Windows 上，你可以将一个文本文件传递给它，其中包含要执行的命令......

例如，

```
ftp -s:ftptest.txt ftp.download.com 
```

其中 ftptest.txt 包含

```
anonymous
nowhere@noone.net
bin
hash
prompt
mget *.*
quit 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-06T19:35:15.263

**WinSCP**是[可编写脚本的](http://winscp.net/eng/docs/scripting)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-02T22:01:54.753

Robo-FTP 也是[可编写脚本的](http://www.robo-ftp.com/help/3.7/script_commands_grouped_by_function.htm)

这是一个 Robo-FTP 脚本，用于下载远程文件夹中的所有文件：

```
WORKINGDIR "c:\destination\folder"
IFERROR GOTO done
FTPLOGON "ftp.mydomain.com" /user="UserID" /pw="secret!"
IFERROR GOTO done
RCVFILE "*" /subdirs /emptydirs
:done
FTPLOGOFF
EXIT 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T19:36:53.950

`wget`应该管用。尝试：

`wget ftp://domain.com/full/path --ftp-user=username --ftp-password=password`

# java - 如何创建覆盖 Windows 标题栏的 Java Swing 应用程序？

> ID：722827
> 
> 赞同：5
> 
> 时间：2009-04-06T19:34:06.250
> 
> 标签：java, user-interface, swing

我正在开发一个将在心理学实验中使用的 java swing 应用程序，研究人员要求我制作程序“黑屏”，以便用户不会受到外部刺激。他们希望 Swing 应用程序真正实现全屏显示，并且顶部没有任何类型的标题栏或最小化/最大化/关闭按钮。

该软件将在使用 JavaSE 6 的 Windows XP 环境中运行。

我该怎么做，如果适用，请提供代码片段。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-06T19:37:48.940

使用全屏 Java API？

[http://java.sun.com/docs/books/tutorial/extra/fullscreen/exclusivemode.html](http://java.sun.com/docs/books/tutorial/extra/fullscreen/exclusivemode.html)

[http://www.artificis.hu/2006/03/16/java-awtswing-fullscreen](http://www.artificis.hu/2006/03/16/java-awtswing-fullscreen)

```
JFrame fr = new JFrame();
fr.setResizable(false);
if (!fr.isDisplayable()) {
    // Can only do this when the frame is not visible
    fr.setUndecorated(true);
}
GraphicsDevice gd = GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
try {
  if (gd.isFullScreenSupported()) {
    gd.setFullScreenWindow(fr);
  } else {
    // Can't run fullscreen, need to bodge around it (setSize to screen size, etc)
  }
  fr.setVisible(true);
  // Your business logic here
} finally {
  gd.setFullScreenWindow(null);
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-06T19:37:10.347

使用该[`setUndecorated(true)`](http://java.sun.com/javase/6/docs/api/java/awt/Frame.html#setUndecorated(boolean))物业。请注意，这必须在使框架可见之前完成。

```
JFrame frame = new JFrame();
Toolkit tk = Toolkit.getDefaultToolkit();
frame.setBounds(new Rectangle(new Point(0, 0), tk.getScreenSize()));
frame.setUndecorated(true);
frame.setVisible(true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T19:47:34.907

我知道这个线程很旧，但我在搜索自己如何做同样的事情时发现了它。我找不到任何我想使用的解决方案，所以我想出了这个。我发现下面的解决方案不仅有效，而且比上面的答案简单得多。

```
JFrame frame = new JFrame();
frame.setResizable(false);
frame.setUndecorated(true);
Dimension dim = Toolkit.getDefaultToolkit().getScreenSize();
frame.setSize(dim);
frame.setVisible(true); 
```

# php - 变量到标题位置

> ID：722836
> 
> 赞同：0
> 
> 时间：2009-04-06T19:35:22.223
> 
> 标签：php, string

我怎样才能包含一个变量并使它成为字符串的一部分。

```
header("Location: http://www." . "$_SESSION['domainname']"); 
```

上面的代码不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T19:51:54.133

您的代码不起作用的原因是 PHP 如何处理字符串中的索引数组。你有过：

```
"$_SESSION['domainname']" 
```

但是 PHP 想要看到的是：

```
"$_SESSION[domainname]" 
```

这次没有单引号。如果您直接在字符串中引用变量，则仅省略这些单引号。

请注意，字符串插值，例如这样，可以使用简单的`"$a[x]"`数组`"$a[x][y]"`（字符串插值，但更像是在 PHP 的其他地方引用变量）。`{$x}``{$a['x']['y']}`

# c++ - 初学者 C++：基类中的虚函数

> ID：722838
> 
> 赞同：3
> 
> 时间：2009-04-06T19:35:45.263
> 
> 标签：c++, visual-studio-2008, virtual, unresolved-external

我正在编写一些代码，其中定义了以下基类。

```
class Chorus{
  public:

    //Destructor
    virtual ~Chorus();

    //callback function
    virtual int callback( void *outputBuffer, void *notUsed, unsigned int 
       nBufferFrames, double streamTime, RtAudioStreamStatus status, void *userData );

    virtual void initializeDelayBuffer(void);

    virtual void destroyDelayBuffer(void);
}; 
```

我想用它作为一个基类，而不是用它自己做任何事情。所以我有两个独立的类，它们是从这个类 Chorus 派生的。我想这样做是为了简单地提供一些基本约束，以说明任何派生的 Chorus 类*必须*被认为在我的程序中可用。

当我构建我的项目 (Visual Studio 2008) 时，我在这个 Chorus 类的所有虚函数上得到了未解决的外部符号错误。我猜这是我没有对这些函数进行前向声明的典型错误。但是，由于它们是虚拟的，并且在派生类中定义它们之前，我不希望它们实际上被定义为做任何事情，我该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-06T19:37:19.877

如果您的意图是让它们成为子类实现的简单占位符，那么通过以 = 0 结尾使它们成为纯虚函数。例如

```
virtual void destroyDelayBuffer(void) = 0; 
```

这使得该方法可以说是“抽象的”。C++ 编译器不会寻找方法的实际定义，而是会强制所有派生类在创建实例之前实现这些方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T19:38:22.137

您需要将这些函数声明为纯虚拟函数。

虚拟无效初始化延迟缓冲区（无效）= 0；

这将创建一个各种各样的界面，这就是你想要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T19:39:34.770

这称为纯虚函数。在 C++ 中，您在函数名称后写一个“=0”，但您可能想阅读有关这些的常见问题解答。

[http://www.parashift.com/c++-faq-lite/abcs.html#faq-22.4](http://www.parashift.com/c++-faq-lite/abcs.html#faq-22.4)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-06T19:39:49.730

您需要将函数定义为纯虚函数。为此，请在每个声明后添加一个“= 0”。例如：

```
virtual void destroyDelayBuffer(void) = 0; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-06T19:37:53.853

使用纯虚函数：

```
 virtual int callback( void *outputBuffer, void *notUsed, unsigned int 
       nBufferFrames, double streamTime, RtAudioStreamStatus status, void *userData ) = 0; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-07T05:26:16.670

只是为了补充上述答案，您不能实例化包含纯虚函数的类的对象，因此将来如果您打算拥有基类的对象，请记住使函数为非纯虚函数。

# unit-testing - HTTP 一致性测试套件

> ID：722849
> 
> 赞同：7
> 
> 时间：2009-04-06T19:37:32.247
> 
> 标签：unit-testing, http, standards-compliance

有没有好的**HTTP**一致性测试套件？

我需要测试一些*现有*代码以符合标准，并且不想重新发明轮子并遇到各种极端情况。

我没有指定我使用的语言。我希望套件足够通用以适应我的需求——尽管我会满足于任何理智的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T04:05:37.237

不知道它有多准确或完整，但[HTTP Lint](http://zamez.org/httplint)看起来可能与您正在寻找的相似？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T20:06:56.053

看看[http://www.web-polygraph.org/](http://www.web-polygraph.org/)。这可能是您正在寻找的东西。

干杯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T19:50:11.140

[RFuzz](http://rfuzz.rubyforge.org/)是 Ruby 的 HTTP 模糊测试库，但我不确定它是否专门测试*合规*性。

# c# - 使用 Lambda/Linq 对列表进行排序到对象

> ID：722868
> 
> 赞同：289
> 
> 时间：2009-04-06T19:40:41.727
> 
> 标签：c#, linq, lambda, linq-to-objects

我在字符串中有“按属性排序”的名称。我将需要使用 Lambda/Linq 对对象列表进行排序。

前任：

```
public class Employee
{
  public string FirstName {set; get;}
  public string LastName {set; get;}
  public DateTime DOB {set; get;}
}

public void Sort(ref List<Employee> list, string sortBy, string sortDirection)
{
  //Example data:
  //sortBy = "FirstName"
  //sortDirection = "ASC" or "DESC"

  if (sortBy == "FirstName")
  {
    list = list.OrderBy(x => x.FirstName).toList();    
  }

} 
```

1.  不是使用一堆 if 来检查字段名（sortBy），而是有一种更简洁的排序方式
2.  排序是否知道数据类型？

* * *

## 回答 #1

> 赞同：390
> 
> 时间：2013-01-02T16:32:28.370

这可以作为

```
list.Sort( (emp1,emp2)=>emp1.FirstName.CompareTo(emp2.FirstName) ); 
```

.NET 框架将 lambda 转换`(emp1,emp2)=>int`为`Comparer<Employee>.`

这具有强类型的优点。

如果您需要降序/倒序，请反转参数。

```
list.Sort( (emp1,emp2)=>emp2.FirstName.CompareTo(emp1.FirstName) ); 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2009-04-06T19:47:01.210

您可以做的一件事是进行更改`Sort`，以便更好地利用 lambda。

```
public enum SortDirection { Ascending, Descending }
public void Sort<TKey>(ref List<Employee> list,
                       Func<Employee, TKey> sorter, SortDirection direction)
{
  if (direction == SortDirection.Ascending)
    list = list.OrderBy(sorter);
  else
    list = list.OrderByDescending(sorter);
} 
```

现在您可以在调用该`Sort`方法时指定要排序的字段。

```
Sort(ref employees, e => e.DOB, SortDirection.Descending); 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2009-04-06T19:46:04.787

您可以使用反射来获取属性的值。

```
list = list.OrderBy( x => TypeHelper.GetPropertyValue( x, sortBy ) )
           .ToList(); 
```

其中 TypeHelper 有一个静态方法，如：

```
public static class TypeHelper
{
    public static object GetPropertyValue( object obj, string name )
    {
        return obj == null ? null : obj.GetType()
                                       .GetProperty( name )
                                       .GetValue( obj, null );
    }
} 
```

您可能还想查看[VS2008 Samples library](http://msdn.microsoft.com/en-us/bb330936.aspx)中的 Dynamic LINQ 。您可以使用 IEnumerable 扩展将 List 转换为 IQueryable，然后使用动态链接 OrderBy 扩展。

```
 list = list.AsQueryable().OrderBy( sortBy + " " + sortDirection ); 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-02-20T13:13:52.227

这就是我解决问题的方法：

```
List<User> list = GetAllUsers();  //Private Method

if (!sortAscending)
{
    list = list
           .OrderBy(r => r.GetType().GetProperty(sortBy).GetValue(r,null))
           .ToList();
}
else
{
    list = list
           .OrderByDescending(r => r.GetType().GetProperty(sortBy).GetValue(r,null))
           .ToList();
} 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-04-06T19:56:56.460

可以在[此处阅读按表达式构建顺序](http://www.singingeels.com/Blogs/Nullable/2008/03/26/Dynamic_LINQ_OrderBy_using_String_Names.aspx)

无耻地从链接中的页面窃取：

```
// First we define the parameter that we are going to use
// in our OrderBy clause. This is the same as "(person =>"
// in the example above.
var param = Expression.Parameter(typeof(Person), "person");

// Now we'll make our lambda function that returns the
// "DateOfBirth" property by it's name.
var mySortExpression = Expression.Lambda<Func<Person, object>>(Expression.Property(param, "DateOfBirth"), param);

// Now I can sort my people list.
Person[] sortedPeople = people.OrderBy(mySortExpression).ToArray(); 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-04-06T19:49:04.747

您可以使用反射来访问该属性。

```
public List<Employee> Sort(List<Employee> list, String sortBy, String sortDirection)
{
   PropertyInfo property = list.GetType().GetGenericArguments()[0].
                                GetType().GetProperty(sortBy);

   if (sortDirection == "ASC")
   {
      return list.OrderBy(e => property.GetValue(e, null));
   }
   if (sortDirection == "DESC")
   {
      return list.OrderByDescending(e => property.GetValue(e, null));
   }
   else
   {
      throw new ArgumentOutOfRangeException();
   }
} 
```

**笔记**

1.  为什么要通过引用传递列表？
2.  您应该使用枚举作为排序方向。
3.  如果您传递一个指定要排序的属性而不是将属性名称作为字符串传递的 lambda 表达式，您可以获得更简洁的解决方案。
4.  在我的示例中 list == null 将导致 NullReferenceException，您应该抓住这种情况。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-06T19:48:13.750

Sort 使用 IComparable 接口，如果该类型实现它。您可以通过实现自定义 IComparer 来避免 ifs：

```
class EmpComp : IComparer<Employee>
{
    string fieldName;
    public EmpComp(string fieldName)
    {
        this.fieldName = fieldName;
    }

    public int Compare(Employee x, Employee y)
    {
        // compare x.fieldName and y.fieldName
    }
} 
```

接着

```
list.Sort(new EmpComp(sortBy)); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-04-06T19:45:41.900

**回答 1.:**

您应该能够手动构建一个表达式树，该树可以使用名称作为字符串传递给 OrderBy。*或者*您可以按照另一个答案中的建议使用反射，这可能会减少工作量。

*编辑*：这是手动构建表达式树的工作示例。（当只知道属性的名称“Value”时，按 X.Value 排序）。你可以（应该）建立一个通用的方法来做到这一点。

```
using System;
using System.Linq;
using System.Linq.Expressions;

class Program
{
    private static readonly Random rand = new Random();
    static void Main(string[] args)
    {
        var randX = from n in Enumerable.Range(0, 100)
                    select new X { Value = rand.Next(1000) };

        ParameterExpression pe = Expression.Parameter(typeof(X), "value");
        var expression = Expression.Property(pe, "Value");
        var exp = Expression.Lambda<Func<X, int>>(expression, pe).Compile();

        foreach (var n in randX.OrderBy(exp))
            Console.WriteLine(n.Value);
    }

    public class X
    {
        public int Value { get; set; }
    }
} 
```

但是，构建表达式树需要您知道参与的类型。在您的使用场景中，这可能是也可能不是问题。如果您不知道应该对哪种类型进行排序，那么使用反射可能会更容易。

**回答 2.:**

是的，因为 Comparer<T>.Default 将用于比较，如果您没有明确定义比较器。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-02-18T12:58:23.980

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;
using System.Linq.Expressions;

public static class EnumerableHelper
{

    static MethodInfo orderBy = typeof(Enumerable).GetMethods(BindingFlags.Static | BindingFlags.Public).Where(x => x.Name == "OrderBy" && x.GetParameters().Length == 2).First();

    public static IEnumerable<TSource> OrderBy<TSource>(this IEnumerable<TSource> source, string propertyName)
    {
        var pi = typeof(TSource).GetProperty(propertyName, BindingFlags.Public | BindingFlags.FlattenHierarchy | BindingFlags.Instance);
        var selectorParam = Expression.Parameter(typeof(TSource), "keySelector");
        var sourceParam = Expression.Parameter(typeof(IEnumerable<TSource>), "source");
        return 
            Expression.Lambda<Func<IEnumerable<TSource>, IOrderedEnumerable<TSource>>>
            (
                Expression.Call
                (
                    orderBy.MakeGenericMethod(typeof(TSource), pi.PropertyType), 
                    sourceParam, 
                    Expression.Lambda
                    (
                        typeof(Func<,>).MakeGenericType(typeof(TSource), pi.PropertyType), 
                        Expression.Property(selectorParam, pi), 
                        selectorParam
                    )
                ), 
                sourceParam
            )
            .Compile()(source);
    }

    public static IEnumerable<TSource> OrderBy<TSource>(this IEnumerable<TSource> source, string propertyName, bool ascending)
    {
        return ascending ? source.OrderBy(propertyName) : source.OrderBy(propertyName).Reverse();
    }

} 
```

另一个，这次是针对任何 IQueryable：

```
using System;
using System.Linq;
using System.Linq.Expressions;
using System.Reflection;

public static class IQueryableHelper
{

    static MethodInfo orderBy = typeof(Queryable).GetMethods(BindingFlags.Static | BindingFlags.Public).Where(x => x.Name == "OrderBy" && x.GetParameters().Length == 2).First();
    static MethodInfo orderByDescending = typeof(Queryable).GetMethods(BindingFlags.Static | BindingFlags.Public).Where(x => x.Name == "OrderByDescending" && x.GetParameters().Length == 2).First();

    public static IQueryable<TSource> OrderBy<TSource>(this IQueryable<TSource> source, params string[] sortDescriptors)
    {
        return sortDescriptors.Length > 0 ? source.OrderBy(sortDescriptors, 0) : source;
    }

    static IQueryable<TSource> OrderBy<TSource>(this IQueryable<TSource> source, string[] sortDescriptors, int index)
    {
        if (index < sortDescriptors.Length - 1) source = source.OrderBy(sortDescriptors, index + 1);
        string[] splitted = sortDescriptors[index].Split(' ');
        var pi = typeof(TSource).GetProperty(splitted[0], BindingFlags.Public | BindingFlags.FlattenHierarchy | BindingFlags.Instance | BindingFlags.IgnoreCase);
        var selectorParam = Expression.Parameter(typeof(TSource), "keySelector");
        return source.Provider.CreateQuery<TSource>(Expression.Call((splitted.Length > 1 && string.Compare(splitted[1], "desc", StringComparison.Ordinal) == 0 ? orderByDescending : orderBy).MakeGenericMethod(typeof(TSource), pi.PropertyType), source.Expression, Expression.Lambda(typeof(Func<,>).MakeGenericType(typeof(TSource), pi.PropertyType), Expression.Property(selectorParam, pi), selectorParam)));
    }

} 
```

您可以传递多个排序条件，如下所示：

```
var q = dc.Felhasznalos.OrderBy(new string[] { "Email", "FelhasznaloID desc" }); 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2011-03-07T11:52:01.790

不幸的是，Rashack 提供的解决方案不适用于值类型（int、枚举等）。

为了使它适用于任何类型的属性，这是我找到的解决方案：

```
public static Expression<Func<T, object>> GetLambdaExpressionFor<T>(this string sortColumn)
    {
        var type = typeof(T);
        var parameterExpression = Expression.Parameter(type, "x");
        var body = Expression.PropertyOrField(parameterExpression, sortColumn);
        var convertedBody = Expression.MakeUnary(ExpressionType.Convert, body, typeof(object));

        var expression = Expression.Lambda<Func<T, object>>(convertedBody, new[] { parameterExpression });

        return expression;
    } 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-09-11T19:34:37.543

添加到 @Samuel 和 @bluish 所做的事情。这要短得多，因为在这种情况下 Enum 是不必要的。另外，当 Ascending 是所需结果时，作为额外的好处，您只能传递 2 个参数而不是 3 个，因为 true 是第三个参数的默认答案。

```
public void Sort<TKey>(ref List<Person> list, Func<Person, TKey> sorter, bool isAscending = true)
{
    list = isAscending ? list.OrderBy(sorter) : list.OrderByDescending(sorter);
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-10-03T07:51:20.357

如果您将排序列名称和排序方向作为字符串获取，并且不想使用 switch 或 if\else 语法来确定列，那么这个示例可能对您来说很有趣：

```
private readonly Dictionary<string, Expression<Func<IuInternetUsers, object>>> _sortColumns = 
        new Dictionary<string, Expression<Func<IuInternetUsers, object>>>()
    {
        { nameof(ContactSearchItem.Id),             c => c.Id },
        { nameof(ContactSearchItem.FirstName),      c => c.FirstName },
        { nameof(ContactSearchItem.LastName),       c => c.LastName },
        { nameof(ContactSearchItem.Organization),   c => c.Company.Company },
        { nameof(ContactSearchItem.CustomerCode),   c => c.Company.Code },
        { nameof(ContactSearchItem.Country),        c => c.CountryNavigation.Code },
        { nameof(ContactSearchItem.City),           c => c.City },
        { nameof(ContactSearchItem.ModifiedDate),   c => c.ModifiedDate },
    };

    private IQueryable<IuInternetUsers> SetUpSort(IQueryable<IuInternetUsers> contacts, string sort, string sortDir)
    {
        if (string.IsNullOrEmpty(sort))
        {
            sort = nameof(ContactSearchItem.Id);
        }

        _sortColumns.TryGetValue(sort, out var sortColumn);
        if (sortColumn == null)
        {
            sortColumn = c => c.Id;
        }

        if (string.IsNullOrEmpty(sortDir) || sortDir == SortDirections.AscendingSort)
        {
            contacts = contacts.OrderBy(sortColumn);
        }
        else
        {
            contacts = contacts.OrderByDescending(sortColumn);
        }

        return contacts;
    } 
```

基于使用字典的解决方案，该字典通过 Expression> 及其键字符串连接所需的排序列。

# .net - 母版页模块覆盖

> ID：722899
> 
> 赞同：0
> 
> 时间：2009-04-06T19:49:40.550
> 
> 标签：.net, asp.net, master-pages, httpmodule

我有一个通过 PreInit() 上的 HTTPModule 设置的母版页。欢乐时光！问题是由于布局问题，我需要覆盖几页上的 masterpagefile 值。有人知道最好的方法吗？

我尝试在我的页面上添加一个 Page_Preinit ，但它在我的模块中的 PreInit() 之前执行，所以它最终在那里被重置。我在想也许我应该在我的页面中更新一个上下文变量（类似于我可能在我的模块中分支出来的 masterSetAtPage）.. 对此有什么想法吗？

我在 VB.Net 中工作，但 C# 示例也可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T20:07:34.533

大概您当前的代码看起来有点像这里描述的代码......

[http://www.odetocode.com/articles/450.aspx](http://www.odetocode.com/articles/450.aspx)

如果是这样，那么您可以更改连接 PreInit 的代码，使其看起来像这样......

```
if (page != null && String.IsNullOrEmpty(page.MasterPageFile))
{
    page.MasterPageFile = "~/Master1.master";
} 
```

然后任何使用它自己的页面指令来设置母版页文件的页面都将避免被连接到“默认”母版页。

如果您需要以编程方式执行此操作，那么此代码...

```
protected override void OnPreInit(EventArgs e)
{
    base.OnPreInit(e);
    this.MasterPageFile = "cheese.master";
} 
```

...在你的页面代码后面会做的伎俩。显然，此代码只会添加到需要特殊行为的页面中。

# powershell - Windows XP 脚本、WSH 与 PowerShell 的建议

> ID：722901
> 
> 赞同：10
> 
> 时间：2009-04-06T19:49:55.917
> 
> 标签：powershell, scripting, vbscript, windows-xp, wsh

在 Unix/Linux 开源世界中使用诸如 Bourne Shell、Perl、Python 和 Ruby 等语言编写脚本后，我现在发现自己需要编写一些 Windows XP 管理脚本。旧环境似乎是 Windows Script Host (WSH)，它可以使用各种脚本语言，但主要语言是 VBScript，并且基于 COM 对象。但是，未来似乎是基于 .NET 的 Windows PowerShell。

自 1970 年代 Applesoft 以来，我还没有学习过 Basic，所以我并不热衷于学习 VBScript，尽管我确实学到了足够的知识来编写一个小脚本来安装网络驱动器。如果我要花时间真正了解这一点，我倾向于将时间投入到 .NET PowerShell 环境中，如果它真的是未来的话。几年前我做过一些 C# Windows Forms 编程，所以我对 .NET 有一定的了解，这也让 PowerShell 很有吸引力。

了解没有人有预测微软未来的水晶球，我想听听任何 PowerShell 用户并认为值得的人，或者是否有人知道 PowerShell 的严重缺陷，并建议我远离从中。

**更新：**我最终将 WSH/VBScript 用于我作为启动脚本安装在用户的 Windows XP 工作站上的特定脚本。我所要做的就是将它复制到他们的启动文件夹中，我就完成了。但是，我只学到了足够的 WSH 来完成这项工作。我很高兴看到 PowerShell 是未来，当我有更复杂的脚本任务时，我会转向 PowerShell。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-06T20:27:47.307

> 是否“值得”？

绝对地。这里有很多原因。

1.  越来越多的微软产品基于 PowerShell - 例如 Exchange Server 2007、SQL Server 2008 等。

2.  PowerShell 可以访问 Microsoft .NET。
3.  易于学习 - 您只需几个命令即可探索 PowerShell 的功能 - 例如）Get-Command、Get-Help、Get-Member 等。
4.  大多数命令的别名和映射方式类似于 DOS 或 *NIX shell 命令 - 例如）“ls”和“dir”是“Get-ChildItem”的别名，“cd”是“Set-Location”的别名
5.  这是一个很棒的开发人员工具 - 由于 PowerShell 可以访问 .NET 库，您可以在 PowerShell 中对一些 .NET 功能进行原型设计
6.  您可以在注册表、证书、环境变量等中导航，就像它们是文件系统一样 - 您使用在 FileSystem 中使用的相同命令来导航 - 例如）cd HKLM:\

**缺点：**

1.  PowerShell 1.0 版不支持远程处理（2.0 中支持）和创建新线程（使用 System.Threading.Thread，但将支持 2.0 中的后台作业）

2.  如果您不习惯基于 C#/Java 的语言，学习曲线可能会很长

3.  很难创建通用的 .NET 对象
    *   例如）创建一个通用`List<int>`集合就像下面

> $l = 新对象 System.Collections.Generic.List``1[[System.Int32]]

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-06T19:55:10.023

如果您倾向于向前看，Powershell 绝对是要走的路，但它必须在 7 之前的 Windows 上单独安装，如果您只想部署无需进一步依赖即可运行的脚本，这可能会使 WSH 成为更有吸引力的目标。此外，.NET 还没有包含在 XP 等古老的 Windows 版本中，这进一步提高了标准。

但是，如果您接触过 .NET，您应该会发现 Powershell 非常直观。尤其是在 Windows Server 环境中，它似乎很快成为命令行管理的默认设置，因为几乎所有新发布的服务器组件都附带自定义 Powershell cmdlet。因此，Powershell 似乎是他们想要遵循一段时间的微软之路。哎呀，到目前为止，他们甚至没有埋葬 COM，所以我预计 Powershell 至少还能再活十年，因为他们将其定位为管理任务*的*自动化和脚本环境。

我还发现了一个基于对象的管道，虽然我花了一段时间才习惯它，最终非常强大且易于使用。当然简化了许多在 *nixes 上需要 sed/awk 的事情。

话虽如此，我仍然使用 Windows 批处理文件来处理许多应该在 Windows 上运行而没有任何依赖关系的东西，但这只是我的一个肮脏习惯 :)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-06T20:27:22.970

WSH 的主要优点是它从 Windows 98 开始默认安装，甚至可能是 Windows 95，但由于 PowerShell 现在随 Server 2008 一起提供，并且可以安装在 XP 之后的任何设备上，因此它不再是一个问题。

如果您可以完全控制脚本将在其上运行的服务器，我建议您使用 PowerShell。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-12T08:33:20.020

很长一段时间以来，我一直在寻找一种最好的 Windows 脚本语言（现在仍在寻找）。但是，在查看了所有变体之后，我最终选择了 JScript for WSH。虽然 Powershell 显然具有优势，但第一篇文章的优势似乎并不显着（内置 IDE 除外）。但是，缺点并没有完整列出：

1.  在运行脚本之前，您必须手动启用运行它们的可能性，这使得在分布式网络上进行部署比使用 WSH 更难。
2.  cmdlet 的命名约定。它不是 camelCase，也不是 python_tail。它真的灼伤了我的眼睛。
3.  变量名以 $ 开头（我认为是 Perl 风格？不知道确切） - 这里也一样。
4.  您不能使用真实路径来运行脚本。

相反，JScript 更像 C，不需要显式启用脚本运行，接受相对路径，区分大小写和松散类型（恕我直言，与 VBScript 相比，两者都是脚本语言的优势）。我对 PowerShell 的了解不多，只是我在 MS Technet 和网络上发现的。

所以对我来说，我拒绝 powershell 的两个主要原因（即使知道它可能更强大并且 MS 积极支持它）是：1）你必须在每台机器上手动启用脚本运行的可能性 2）一般的非 C 类视图，我曾经（而且不仅仅是我，我猜）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-01T17:00:33.227

如果可能，使用 Posershell 并内联 C#，如果不是 - WSH，不是吗？- msdos 批处理。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-18T08:10:26.687

我们现在是 2017 年，事后看来，Powershell 似乎是一个不错的选择，恕我直言。

# zend-framework - 我应该将我的开源应用程序与 Zend Framework 捆绑在一起，还是让用户来做？

> ID：722903
> 
> 赞同：0
> 
> 时间：2009-04-06T19:50:21.547
> 
> 标签：zend-framework, open-source, bundle

我有一个开源项目，它使用了几个免费的库，其中 FAR 最大的是 Zend Framework。我应该：
1\. 使用 Zend 框架发布我的应用程序
2\. 仅发布我的应用程序并编写一个简短的教程，介绍如何安装 ZF 以使用我的应用程序
3\. 我是否应该同时提供两个选项（这是更多的工作，并且是一个开源不要把面包带到我的桌子上......所以我确实需要一些时间来完成我的日常工作）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T22:10:06.063

取决于“项目”是什么。

如果是应用程序，请捆绑它。

如果是图书馆，不要。

EDIT: To elaborate a bit more:

When making an application, you usually don't want to burden (or rely on) the user with installing and upgrading to the correct library versions. Additionally, if users use different versions of libraries, it'll make it more difficult to solve bugs for your software (e.g. "MyApp 1.0.6 doesn't work with SomeLib 2.3.5 if it was installed via PEAR"). You probably want your environment to be as constant as possible; even different PHP versions are often annoying.

When making a library, otoh, you don't want to cause more side effects than absolutely necessary and want to give all the power to it's user (which in this case is a developer). If your library needs SomeLib 2.3.5, but the app that uses your library needs SomeLib 2.3.7, then your bundling it could cause problems.

Basic point: Users of libraries will test after including them, users of apps won't after installing them.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T20:00:29.823

让潜在用户去做。

包括一个指向 ZF 的链接就足够了。对用户可能遇到的下载问题负责是完全没有意义的，此外您还要为在其他地方可用的东西支付带宽。与 ZF 保持同步也是一件令人头疼的事情，并且必须每隔几周左右检查一次版本。

根据您的描述，您的应用程序很可能严重依赖 Zend Framework，因此，我建议您向您的用户说明您的软件需要 Zend Framework V XXX 以及其他任何内容，可以从[http://下载无论在哪里](http://wherever)。

为什么要让自己头疼？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T20:09:23.263

我认为你应该捆绑它，因为你可能让其他人为带宽付费，codeplex 和 sourceforge 很好:) 这也让用户的生活更轻松。您也可以只删除不需要的模块，这会使文件更小。

或者，在我们的应用程序第一次运行时，它会检查所有文件是否存在并从 Zends 站点下载 zend 框架。在第一次运行时，您可以从[http://framework.zend.com/releases/ZendFramework-1.7.8/ZendFramework-1.7.8-minimal.zip](http://framework.zend.com/releases/ZendFramework-1.7.8/ZendFramework-1.7.8-minimal.zip)下载它并使用 PHP 函数将其解压缩并放置在适当的位置文件夹。这将是一个需要一点时间的替代方案，但会大大减少文件大小

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-07T09:19:29.260

Why not do both?

Then users that don't know what ZF is or don't have it can download the full package.

# actionscript-3 - 为无证 AS3 成员生成警告？(ASDoc)

> ID：722905
> 
> 赞同：1
> 
> 时间：2009-04-06T19:50:24.823
> 
> 标签：actionscript-3, documentation-generation, asdoc

我有一个要分发的 Flash (AS3) 组件库，我想确保每个版本都有完整的文档记录。我真正喜欢 Microsoft 为 C# 自动生成文档的一件事是，我可以让我的编译器为任何未以文档标记格式记录的公共成员生成警告（在每次编译时）。

我发现这对我确保我已经完全记录了我的所有代码非常有帮助。

有没有办法为 ASDoc 打开类似的东西？

感谢您提供的任何建议和技巧——我希望在 Eclipse / Flex Builder 中使用它，但我可以使用 Ant。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-06T20:14:21.893

我认为您正在寻找以下开关：

```
-exclude-dependencies false 
```

从[文档](http://livedocs.adobe.com/flex/3/html/help.html?content=asdoc_1.html)：

> 是否记录了编译器找到的所有依赖项。如果为真，则不记录输入类的依赖关系。
> 
> 默认值为假。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T20:26:11.113

看起来它还没有在那里，但它现在已[作为功能请求记录在 Adob​​e 的 tracker](https://bugs.adobe.com/jira/browse/ASC-3709)中。

# ruby-on-rails - 在 Rails 下测试 Ruby Gems

> ID：722918
> 
> 赞同：10
> 
> 时间：2009-04-06T19:54:05.297
> 
> 标签：ruby-on-rails, testing, rubygems

我正在创建一些可以在 Rails 控制器和视图中使用的 gem。我希望能够独立测试宝石。但是我无法弄清楚如何在 gem 中创建 Rails 实例来测试 gem 是否可以在 Rails 应用程序中工作。

我非常喜欢使用 RSpec，但可能会采用 Test::Unit 解决方案，或者只使用 Test::Unit。

我也对 Rails 插件的类似解决方案感兴趣。

（我试过谷歌搜索，但“rails gem testing”向我展示了用于测试的 gem，而不是如何测试 gem。我很确定我已经看过关于这个主题的一两篇文章。）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-07T08:04:36.977

看看其他插件（插件和 gem，同样的东西）测试套件。

测试增强 Active Record 的插件非常简单。您可以[在任何地方使用 Active Record](http://stuff.lilleaas.net/active_record_anywhere)，因此在这种情况下您所要做的就是将 Active Record 连接到数据库（例如内存中的 sqlite 数据库）并测试您的 codez。

```
# test/test_helper.rb
$LOAD_PATH << File.join(File.dirname(__FILE__), '..', 'lib')
require 'your_thing'

ActiveRecord::Base.establish_connection(:adapter => "sqlite3", :database => ":memory:")

ActiveRecord::Schema.define(:version => 1) do
  create_table :posts do |t|
    t.string :title
    t.text :excerpt, :body
  end
end

class Post < ActiveRecord::Base
  validates_presence_of :title
end

# test/my_test.rb
require 'test_helper'

class MyTest < Test::Unit::TestCase
  def test_thing
    # use Post here
  end
end 
```

当您想要测试控制器操作等时会变得更加困难。[我的实时验证插件](http://github.com/augustl/live-validations)有一个相当广泛的测试套件，它可以模拟很多东西并让我将 ERb 视图作为字符串传递，你可以看看。

将这些 Test::Unit 示例改编为 RSpec 应该是微不足道的，因为它们不会搭载 Test::Unit 中的任何内容。

# antlr - 假人的 ANTLR 和 DSL 解析：空白处理

> ID：722921
> 
> 赞同：2
> 
> 时间：2009-04-06T19:54:27.667
> 
> 标签：antlr

我正在尝试开发一个用于软件配置的迷你 DSL，使用 antlworks 进行原型设计。典型的来源如下所示：

```
name: myname;
value: myvalue;
flag debug {
   value = debugvalue;
}
if flag(debug) {
   libname = foo_d;
} else {
   libname = foo;
} 
```

现在，我从来没有上过关于解析的正式课程，所以我通过 antlworks 的试错和一些 BNF 语法的基础知识来完成所有这些工作。我经常遇到的一个问题是空格和换行符处理。我定义了类似的东西

```
program:    statement* EOF;

statement: compound_statement | selection_statement | field_statement;
selection_statement:    'if' expr statement;
statement_list: (WS* statement)+;
compound_statement: '{' statement_list? '}';
field_statement: name_statement | value_statement;
name_statement: 'name' WS* ':' WS* WORD WS* ';';
value_statement: 'value' WS* ':' WS* WORD WS* ';';

// Tokens
WS  :   (' ' | '\t' | '\n');
WORD:   ('a'..'z'|'A'..'Z')('a'..'z'|'A'..'Z'|'0'..'9'|'_')*; 
```

但是空格处理非常有问题，它在各种情况下都会中断。这样做的标准方法是什么？是否有任何资源可以快速学习这种东西（比如在 antlr 中构建一个带有条件和变量的计算器——我发现的 antlr 语法要么是简单的语言，要么是成熟的语言）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T20:09:16.930

通常，您可以通过添加

```
{ $channel=HIDDEN; } 
```

对`WS`规则采取行动；有关详细信息，请参阅[此页面的 Lexer 规则部分](http://www.antlr.org/wiki/display/ANTLR3/Grammars)。

# c - 在 C 中处理内存分配的最佳方法？

> ID：722922
> 
> 赞同：14
> 
> 时间：2009-04-06T19:54:30.443
> 
> 标签：c, memory-management

我想我已经很好地掌握了如何在 C++ 中处理内存，但是在 C 中处理内存是不同的，我有点偏离。

在 C++ 中，我有构造函数和析构函数，我有非常简单的 new 和 delete，并且我知道如何使用 RAII、使用智能指针和在类中封装它。

但是在 CI 中不能以同样的方式处理 malloc 和 free 。我不知道如何隐藏它们以及如何使事情自动化。我所能想到的就是使用函数来启动和销毁我的指针。但是我应该如何构建我的内存处理？

在写这篇文章时，我意识到这更像是一个关于我理解 C 流程的问题，而不是其他任何问题，而是一次一个问题。

**编辑**：感谢您的回答，但我需要改写自己。

当我说我对 C++ 使用 RAII 和智能指针时，我不希望 C 使用相同的指针，我知道它不一样。但是我在 C++ 中处理内存分配的方式与这些技术有关。

例如，在我的类中，我动态添加和销毁我的类使用的内存。这样我就可以实现一种封装，我不需要知道类何时/如何/为什么处理它的内存，它就是这样做的。这意味着我可以“隐藏”较低的内存处理，只关注一些“​​更大”的类。

我想知道在 C 中处理内存的最佳实践是什么？没有带有构造函数/析构函数的类可以为我处理这个问题。在函数的开头分配内存或使用为我创建它的函数是好的吗？我应该如何再次释放它们？

这些是广泛的问题，并且因情况而异，但是您更喜欢如何处理呢？你能给出什么建议和教训？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-06T20:08:08.307

部分混淆在于它在 C 中本质上更难。`malloc`并且`free`类似于`new`and `delete`:`malloc`分配新内存，并返回指向该内存的指针。 `free`使该内存再次可用，**只要它是使用 malloc 分配的内存**。否则，它只会对一些内存块进行哈希处理。它不在乎。

malloc/free 的重要之处在于决定并始终保持严格的使用。这里有一些提示：

总是检查从 malloc 返回的指针是否为 NULL

```
if((p = (char *) malloc(BUFSIZ)) == NULL {
   /* then malloc failed do some error processing. */
} 
```

为了安全带和吊带的安全，释放后将指针设置为 NULL。

```
free(p);
p = NULL ; 
```

如果可能，尝试 malloc 并释放同一范围内的一块内存：

```
 {  char * p ;
   if((p = malloc(BUFSIZ)) == NULL {
       /* then malloc failed do some error processing. */
   }

 /* do your work. */

   /* now you're done, free the memory */

   free(p);
   p = NULL ;  /* belt-and suspenders */
 } 
```

如果不能，请明确说明您返回的是`malloc`'ed 内存，以便调用者可以释放它。

```
 /* foo: do something good, returning ptr to malloc memory */
 char * foo(int bar) {
     return (char *) malloc(bar);
 } 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-06T19:58:32.260

> 在写这篇文章时，我意识到这更像是一个关于我理解 C 流程的问题，而不是其他任何问题，而是一次一个问题。

老实说，如果您还没有阅读[K&R](http://en.wikipedia.org/wiki/The_C_Programming_Language_(book))，我真的认为您应该阅读。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-06T20:46:24.797

不幸的是，在 C 中自动分配和释放内存的策略有限。C++ 编译器会在幕后为您生成大量代码——它跟踪堆栈上的每个变量，并确保在堆栈时调用适当的析构函数被清理。这实际上是一种相当复杂的代码生成类型，尤其是当您将异常抛出时。

另一方面，C 语言要简单得多，这就是它有时被称为“高级汇编语言”的原因。C 没有任何机制来保证在函数退出或变量从堆栈中弹出时调用特定的代码位，因此您需要跟踪分配的每一位内存以及每个文件或网络您打开的插座并在适当的位置清理它们。没有实用的方法可以在 C 中构建自动智能指针。

您应该查看的一个概念是“内存池”。基本上，与其尝试跟踪您分配的每个单独的内存块，不如创建一个池，做一些工作，将您分配的每个内存块放入池中，然后在完成后释放整个池。为了减轻程序员的认知负担，你在这里权衡了一点性能和控制，但大多数时候这是值得的。

您应该看一下 Apache Portable Runtime 项目。他们有一个内存池库（[http://apr.apache.org/docs/apr/1.3/group__apr__pools.html](http://apr.apache.org/docs/apr/1.3/group__apr__pools.html)上的文档）。如果 APR 对你来说太深入了，你可以使用三个函数和一个链表数据结构来实现一个非常简单的内存池。伪代码类似于：

```
struct Pool {
  void* memoryBlock;
  struct Pool *next;
}

struct Pool *createPool(void) {
  /* allocate a Pool and return it */
}

void addToPool(struct Pool *pool, void *memoryBlock) {
  /* create a new Pool node and push it onto the list */
}

void destroyPool(struct Pool *pool) {
  /* walk the list, free each memory block then free its node */
} 
```

使用池是这样的：

```
int main(void) {
  struct Pool *pool = createPool();
  /* pool is empty */

  doSomething(pool);

  /* pool full of crap, clean it up and make a new one */
  destroyPool(pool);
  pool = createPool();
  /* new pool is empty */

  doMoreStuff(pool);
  destroyPool(pool);

  return 0;
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-06T20:01:59.583

可悲的事实是，C 并不是真正旨在封装所有这些内存管理问题。

如果您查看 POSIX 等相当高质量的 API，您会发现常见的模式是您将指针传递给指向函数的指针，然后分配内存，然后再将其再次传递给销毁的函数它。

它不一定是优雅的，但我认为没有在 C 中模拟 OOP 的情况下，没有很多方法可以让它真正优雅。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-06T20:01:28.853

好吧，在 C 中，您必须手动完成所有内存管理，正如您已经发现的那样。这应该不足为奇。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-07T06:14:45.757

您可以做很多事情来让您的生活更轻松。您似乎已经想到了为您的 C 对象创建工厂/构造函数的想法。这是一个很好的开始跟进它。

需要考虑的其他一些想法。

1.  不要满足于标准的 malloc/free。去寻找一个更好的开源的，或者写一个适合你正在创建的对象的内存使用的。另外，我们在这里谈论 C，您将一次又一次地覆盖您的对象而忘记释放一些对象，因此在您的 malloc 中构建一些调试支持。如果您找不到满足您需求的内容，编写自己的内容并不难。

2.  使用多个堆。为您创建的每一类对象使用一个，如果您知道您将拥有大量相关的临时对象，请使用临时堆，这可以减少内存碎片并允许您根据使用情况管理内存。

3.  看看 Objective-C 的 pools 之类的策略

4.  如果您认为您了解 C++ 的工作原理，那么在对象工厂中将构造函数行为添加到内存分配并不难，并且使用自定义构建的 free 可以为您提供在被释放的对象上调用析构函数的能力你支持一些你喜欢的 C++ 行为

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-01-28T00:48:50.690

*我知道这是一篇旧文章，但在风格*方面并没有真正全面的最佳实践答案，我认为这是操作真正想要的，所以这是我对 C 中内存分配的看法。注意 I我更像是一个 C++ 人，所以我的很多想法都来自这种态度。

知道指针是否已分配通常很方便，因此在声明指针时始终将 NULL 分配给指针。您还可以为自己创建一个安全的释放函数，该函数释放内存，然后将 NULL 分配给它，这样您就不必担心了。

如果你在一个 C 文件中分配内存，那么你应该在同一个文件中释放它。这可能比需要的限制更多，但是如果您正在编写一个库，那么您绝对应该释放您的库中的任何内存，这些内存在您的库中是 malloc 的。这是因为在 Windows 上，dll 与 exe 具有不同的堆，因此在 dll 中分配内存并在 exe 中释放它会破坏您的堆。

通过扩展并且为了对称，这意味着如果您有一个返回指向已分配内存的指针的函数，那么您应该有一个释放该内存的函数。这就是为什么许多库都有一个初始化函数，它返回一个指向某些数据的指针（通常转换为 void *），然后是一个清理函数，它将释放库的资源。如果您可以在同一个函数中进行 malloc 和 free ，那很好，因为它使您可以轻松地跟踪事物。

不要试图在函数开始时分配所有内存，然后在结束时释放它。这只是意味着，如果您想通过函数返回部分内容，则必须释放所有内存，而如果您执行 malloc 并随时释放内存，则指向释放的指针将更少。

如果你经常有分配许多指针的函数，那么考虑在函数的开头创建一个包含指向所有指针的指针的数组，然后有一个函数将它们全部释放。如果您想返回 mid 函数，这将为您避免不可避免的“我稍后会回来整理我的内存泄漏”综合症。

工厂的概念很有用。工厂将是一个函数，它为结构分配内存，将函数指针分配给结构，初始化其变量，然后返回指向它的指针。如果其中第一个是析构函数或特定函数的数组，那么您可以拥有一个可以调用任何结构的析构函数的通用销毁函数，然后释放该结构的内存。您还可以通过对结构进行不同的向内和向外定义来隐藏类的一些内部细节。COM 建立在这些原则之上。

所以这些只是我在 C 中看待内存的方式。它不像 C++ 那样优雅，但是由于你依赖于人类来处理它，所以有类似上面的策略可以使事情尽可能简单他们。

另请注意，每条规则总是有例外 - 这些只是我在使用 C 时所考虑的事情。我相信其他人有其他想法。

菲尔

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-06T20:02:48.303

> 我不知道如何隐藏它们以及如何使事情自动化。

C 和 C++ 是不同的语言。现在，对自己说一百遍。大声点。

你说的隐藏是什么意思？你说的自动化是什么意思？你能发布一些例子吗？为什么需要隐藏和/或自动化。

在线开始使用 C 内存分配的好地方是：

*   [C 常见问题解答](http://c-faq.com/)（特别是第 7 章）
*   [C 程序员的十诫](http://www.lysator.liu.se/c/ten-commandments.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-06T20:39:21.587

我“隐藏”内存分配和取消分配的一种方法是将其传递给自定义容器。向容器传递一个未分配的对象。让它担心 malloc，当我删除对象时让它担心空闲。当然，这仅在您仅将对象存储在一个容器中时才有效。如果我到处都有对象引用，我将使用 c 语法创建等效的构造函数和析构函数方法：

```
 glob* newGlob(); 
 void freeGlob(glob* g); 
```

（我所说的对象是指你会指向的任何东西——不是 c++ 对象）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-06T20:04:11.030

通常的方法是

```
MyType *ptr = malloc(array_size * sizeof *ptr); 
```

但是，如果您想与 c++ 兼容，请执行

```
MyType *ptr = (MyType*) malloc(array_size * sizeof *ptr); 
```

你也可以做一个宏

```
#define MALLOC( NUMBER, TYPE ) ( TYPE * ) malloc( NUMBER * sizeof( TYPE ) )
MyType *ptr = MALLOC(10, MyType); 
```

当然，如果没有 RAII，请确保稍后您有

```
free(ptr); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-07T04:04:22.170

我不太确定你在问什么，但 C 非常简单：

```
struct Foo *f0 = malloc(sizeof(*f));   // alloc uninitialized Foo struct
struct Foo *f1 = calloc(1,sizeof(*f)); // alloc Foo struct cleared to all zeroes

//You usually either want to clear your structs using calloc on allocation, or memset. If 
// you need a constructor, just write a function:
Foo *Foo_Create(int a, char *b)
{
   Foo *r = calloc(1,sizeof(*r));
   r->a = a;
   r->b = strdup(b);
   return r;
}

Here is a simple C workflow with arrays:
struct Foo **foos = NULL;
int n_foos = 0;
...
for(i = 0; i < n_foos; ++i)
{
   struct Foo *f = calloc(1,sizeof(*f));
   foos = realloc(foos,sizeof(*foos)*++n_foos); // foos before and after may be different
   foos[n_foos-1] = f;
} 
```

如果你喜欢，你可以编写宏来帮助：

```
#define MALLOCP(P) calloc(1,sizeof(*P)) // calloc inits alloc'd mem to zero 
```

几点：

*   malloc、calloc、realloc等都使用free()，所以管理这些东西很容易。只要保持一致。
*   malloc 的性能*可能*很慢。有人在上面发布了一个链接。如今，快速多线程分配是关键，请参阅 tcmalloc 等人。您可能不必担心这一点。
*   在现代虚拟内存架构上，除非您的虚拟地址空间不足，否则malloc 几乎*永远不会失败。*如果发生这种情况，请切换到 64 位；）
*   确保您使用的系统具有边界检查、擦除自由值、泄漏跟踪和所有好东西（请参阅 valgrind、win32 调试堆等）

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-04-06T20:13:20.587

你可能会觉得我说的很奇怪，但是C++和C并没有太大的区别。C也有RAII。RAII 不仅仅属于 C++。

只有你应该有足够的纪律来做管理。

C++类：

```
class foo {
public:
   ofstream ff;
   int x,y;
   foo(int _x) : x(_x),y(_x){ ff.open("log.txt"); }
   void bar() { ff<<x+y<<endl; }
};

int main()
{
   auto_ptr<foo> f(new foo);
   f->bar();
} 
```

C 对象

```
typedef struct FOO {
    FILE *ff;
    int x,y;
} *foo_t;

foo_t foo_init(int x)
{
   foo_t p=NULL;
   p=malloc(sizeof(struct FOO)); // RAII
   if(!p) goto error_exit;
   p->x=x; p->y=x;
   p->ff=fopen("log.txt","w");   // RAII
   if(!p->ff) goto error_exit;
   return p;
error_exit:   // ON THROW
   if(p) free(p);
   return NULL;
}

void foo_close(foo_t p)
{
   if(p) fclose(p->ff);
   free(p);
}

void foo_bar(foo_t p)
{
   fprintf(p->ff,"%d\n",p->x+p->y);
}

int main()
{
  foo_t f=foo_init(1);
  if(!f) return 1;
  foo_bar(f);
  foo_close(f);
  return 0;
} 
```

# php - 可以在没有美元符号 $ 变量的情况下使用 PHP 吗？

> ID：722926
> 
> 赞同：11
> 
> 时间：2009-04-06T19:55:15.920
> 
> 标签：php, syntax, variables, sigils

是否可以在 PHP 中以类似 Java 的方式命名变量，例如`$`每次都不需要符号？如果是这样，我该如何启用执行此操作的设置？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-06T19:58:21.480

抱歉，这是不可能的。你会得到最接近的是常量：

```
define('CONS', 5);
echo CONS; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-18T16:54:05.873

我相信其他答案，因为这一定是不可能的。

虽然我个人讨厌 PHP，但每个人都有一些好的特点。PHP $ 非常好的原因之一与变量插值有关：

```
$bob = "rabbit"
$joe = "dragon-$bob"  // ==> dragon-rabbit 
```

这很好很短。在 Ruby 中，由于变量不必有任何特定的起始字符，因此您必须输入更多内容：

```
bob = "rabbit"
joe = "dragon-#{bob}" 
```

在 Java 中也会发生同样的事情（好吧，当你仍然不得不使用 StringBuffer 或与...连接时，我离开了 Java `" + bob + "`……我确信现在已经不存在了）。

所以美元符号既烦人又丑陋，但这里至少有一个优势（肯定还有更多）。

同时，如果你尝试编写非常好的 PHP 代码（不管你看到什么），你会开始觉得你的代码很优雅，而那些美元符号将象征着……金钱！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-06T19:58:03.243

没有。PHP 中的变量必须以`$`.

另一种方法是使用常量。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-06T20:03:38.083

这就像要求 Java 是非强类型的：

```
str = "some string";
System.out.print(str.contains("some")); 
```

没有任何意义。

# java - SSL socket php代码需要转换成Java

> ID：722931
> 
> 赞同：6
> 
> 时间：2009-04-06T19:56:33.560
> 
> 标签：java, php, ssl, sockets

我有一个 Pem 文件，我用这个 php 代码连接到 c++ SSL 服务器，但现在我需要这个用 Java 编写的 php 代码

```
$ctx = stream_context_create();

stream_context_set_option($ctx, 'ssl', 'local_cert', 'cert.pem');

stream_context_set_option($ctx, 'ssl', 'passphrase', $pass);

$fp = stream_socket_client('ssl://serverURL', $err, $errstr, 60, STREAM_CLIENT_CONNECT, $ctx);

if (!$fp) {

    print "Failed to connect $err $errstr\n";
    return;
} 
```

任何想法如何在 Java 中读取 cert.pem 文件然后建立 SSL 套接字？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-07T09:32:07.453

您将需要在类路径中使用[Bouncy Castle](http://www.bouncycastle.org)。

```
PEMReader pr = new PEMReader(new FileReader("cert.pem"));
X509Certificate cert = (X509Certificate) pr.readObject();
PEMReader kr = new PEMReader(new FileReader("privkey.pem"),
        new PasswordFinder() {
    public char[] getPassword() {
        return "passphase".toCharArray();
    }
});
KeyPair key = (KeyPair) kr.readObject();
KeyStore ksKeys = KeyStore.getInstance("JKS");
ksKeys.load(null, "passphase".toCharArray());
ksKeys.setCertificateEntry("MyCert", cert);
ksKeys.setKeyEntry("Mykey", key.getPrivate(),
        "passphase".toCharArray(), new Certificate[]{cert});
KeyManagerFactory kmf = KeyManagerFactory.getInstance(
        KeyManagerFactory.getDefaultAlgorithm());
kmf.init(ksKeys, "passphase".toCharArray());
TrustManagerFactory tmf = TrustManagerFactory.getInstance(
        TrustManagerFactory.getDefaultAlgorithm());
tmf.init(ksKeys);

SSLContext sslContext = SSLContext.getInstance("TLS");
sslContext.init(kmf.getKeyManagers(), tmf.getTrustManagers(), null);

Socket socket = sslContext.getSocketFactory().createSocket(
        "localhost", 4433);
BufferedReader in = new BufferedReader(new InputStreamReader(
        socket.getInputStream()));
PrintWriter out = new PrintWriter(new OutputStreamWriter(
        socket.getOutputStream()));
out.println("Hello World");
System.out.println(in.readLine());
out.close();
in.close(); 
```

如果你运行`openssl s_server -Verify cert.pem -cert cert.pem -key privkey.pem`，它应该显示：

```
depth=0 /C=AU/ST=Some-State/O=Internet Widgits Pty Ltd
verify error:num=18:self signed certificate
verify return:1
depth=0 /C=AU/ST=Some-State/O=Internet Widgits Pty Ltd
verify return:1
Hello World
DONE
shutting down SSL
CONNECTION CLOSED
ACCEPT 
```

# c++ - 复杂的错误 LNK2005：已定义 C++

> ID：722932
> 
> 赞同：1
> 
> 时间：2009-04-06T19:56:45.120
> 
> 标签：c++, visual-studio-2008, linker

在 Visual Studio 2008 中构建我的项目时，我得到了 LNK2005: already defined in (...) 错误。我已经引用了其他相关问题，但我的似乎有点复杂，因为如果没有其他问题的话我正在使用的文件。

首先，我认为以 [current_file] ->includes_this_file 格式映射我在项目文件中的#include 语句对我很有帮助

我所有的头文件都使用标准的#ifndef [Header] #define [Header] ... #endif 进行保护。

[调制器.h]

Modulator 类的原型

[合唱单元.h]->调制器.h

具有 Modulator 类型成员对象的 Chorus 类的原型

[AudioHandler.h] -> ChorusUnit.h

AudioHandler 类的原型，它具有 Chorus 类的成员对象

[合唱.cpp]->AudioHandler.h

Modulator 和 Chorus 类成员的定义

[AudioHandler.cpp] -> Chorus.cpp

AudioHandler 类成员的定义

[ChorusUnit.cpp] ->AudioHandler.cpp

包含实际运行我的项目代码的 main() 函数的文件。

包含的顺序是因为在 Modulator.h、ChorusUnit.h 和 AudioHandler.h 中找到的类的所有函数定义都需要引用其他类的成员，所以我需要首先定义原型供所有类查看彼此。

该错误特别指出，在 Chorus.obj 文件中的 Chorus.cpp 和 AudioHandler.cpp 中找到的每个定义都已在 AudioHandler.obj 中定义。还有另一组相同的错误类型，表示在 ChorusUnit.obj 文件中的 Chorus.cpp 和 AudioHandler.cpp 中找到的每个定义都已在 AudioHandler.obj 中定义。

可能有一个非常简单的解决方案，但我在一般链接方面并不是特别有经验（主要是 Java 程序员）。就我对该主题的有限知识而言，我只定义了一次所有内容，并且所有内容都只包含一次，所以我个人对为什么已经定义这些内容感到茫然。有的请赐教！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-06T20:01:50.117

The error is probably that you say you #include Chorus.cpp in AudioHandle.cpp - this is not what you probably want.

The reason is, that all .cpp files (unless you've done something special in your IDE) are compiled separately, then linked. When you #include another .cpp file, the file's text is literally included; therefore, all objects defined in the included file appear in the including file as well. When you link the two files, the common objects cause a conflict.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T20:00:12.973

> [AudioHandler.cpp] -> Chorus.cpp
> 
> AudioHandler 类成员的定义

这是错误的。包括`ChorusUnit.hpp`原型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-06T20:02:50.720

AudioHandler.cpp and ChorusUnit.cpp should only #include header files, not other C++ source files.

The preprocessor inserts the contents of any #included file into the #including file, so you get two copies of the symbols from Chorus.cpp once you start linking: one from compiling Chorus.cpp and the second from compiling AudioHandler.cpp (since it #includes Chorus.cpp).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T20:04:11.967

I'm not sure how to do this on Windows machines, but these problems can generally be solved by running the code through the C Preprocessor ONLY. This will result in a combined source file essentially replacing all "#include" statements with the files they refer to. If you view this combined file, it can become obvious where things are being redefined. In Linux/Unix, you would do this using the 'cpp' command.

# java - 如何使用 Java ResultSet 和 PreparedStatement 访问 mySQL 枚举字段

> ID：722946
> 
> 赞同：3
> 
> 时间：2009-04-06T19:59:18.453
> 
> 标签：java, mysql, jdbc, enums

快速提问使用 ResultSet 和 PreparedStatement 访问 MySQL 中的 ENUM 字段的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-07T09:44:24.070

从来没有，但我会使用字符串，请参阅文档：
[21.4.4.3。Java、JDBC 和 MySQL 类型](http://dev.mysql.com/doc/refman/5.1/en/connector-j-reference-type-conversions.html)

# php - Simple_XML 跨域文件访问已禁用

> ID：722947
> 
> 赞同：0
> 
> 时间：2009-04-06T19:59:39.170
> 
> 标签：php, cross-domain, simplexml

我需要从我拥有的 PHP 的另一个域中检索 XML 文件。

我正在使用 simple_XML 来执行此操作，但显然禁用了跨域：

> 警告：simplexml_load_file() [function.simplexml-load-file]：在服务器配置中禁用 URL 文件访问

我无权访问服务器的配置（共享主机）。

关于如何执行此操作的任何线索？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-06T20:04:02.497

您的主机通过将 php.ini 中的 allow_url_fopen 设置为关闭来禁用它。

您可能需要与他们讨论启用此功能。

您可以尝试使用 cURL 下载远程文件，然后将字符串加载到 SimpleXML 而不是远程文件路径。

# c# - 关于数组的问题

> ID：722948
> 
> 赞同：1
> 
> 时间：2009-04-06T20:00:02.193
> 
> 标签：c#, random, numbers

我对此代码有疑问。我是初学者，喜欢学习 C#。但后来我谈到了现在称为 Array 的主题，这非常困难，我需要你的帮助。我想了解代码。我在这里不明白的是这里的第1、2、3、4和5部分是什么意思？
我不明白这里的“const”和“byte”的作用是什么？我会很感激你的解释？感谢和问候;-）

1)

```
const byte numbers = 5;
byte[] myNumbers = new byte[numbers];
byte additionalNumbers;
Random coincidenceNumbers = new Random(); 
```

2)

```
string yourPassword;
Console.WriteLine("Please enter your password:");
yourPassword = Console.ReadLine();

if (yourPassword != "helloWorld")
{ 
    Console.WriteLine("\nWrong password\n");
    return;
}
else 
{
    Console.WriteLine();
    Console.WriteLine("Welcome to my world!");

    for (int i=0; i < myNumbers.Length; ++i)
    { 
        myNumbers[i]=(byte)(coincidenceNumbers.Next(1,50));
    }
} 
```

3)

```
additionalNumbers=(byte) (coincidenceNumbers.Next(1,50));
```

4)

```
Array.Sort(myNumbers);
Console.WriteLine("\nThe Number is:\n");
```

5)

```
foreach (byte elem in myNumbers)
{
    Console.WriteLine("\t" + elem);
    Console.WriteLine();
    Console.WriteLine("Additional Number is: " + additionalNumbers);
}
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T20:09:32.687

const 是一个保留词，意思是“变量”不会改变，相反，它的值不会改变，如果你试图改变

```
const byte numbers = 5;
numbers = 6; // will fail 
```

byte 是一种用于存储小数字的类型

然后，

```
byte[] myNumbers = new byte[numbers]; 
```

创建一个数字 (5) 个位置的数组。例如，您可以将值分配给数组中的任何位置，如下所示：

```
myNumbers[0] = 4;  // position 1
myNumbers[1] = 45;  // position 2
myNumbers[2] = 25;  // position 3
myNumbers[3] = 0;  // position 4
myNumbers[4] = 12;  // position 5
myNumbers[5] = 3;  // will fail, array just have 5 positions 
```

**[编辑]**

```
additionalNumbers=(byte) (coincidenceNumbers.Next(1,50)); 
```

在这里，cognitiveNumbers 是一个 Random 对象，所以它会生成随机数。它的“Next”函数将生成一个整数。它接收 2 个参数：最小值和最大值。所以，这里它会生成一个介于 1 到 50 之间的随机数。

整数与字节相比很大，所以有一个“强制转换”......整数将转换为字节。如果整数小于 255，没问题，否则会丢失精度

如果你尝试这样做

```
int x = 500;
byte y = (byte) x;
Console.WriteLine(y); // 244, precision lost 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T20:07:59.180

您需要阅读一些有关数组的基础教育材料，例如尝试[MSDN Arrays Tutorial](http://msdn.microsoft.com/en-us/library/aa288453(VS.71).aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T20:08:17.243

byte 是一个整数类型，存储值 0..255

const 表示变量“numbers”的值永远不会改变（所以它是常数）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T20:09:46.647

1.  创建一个包含一个字节的常量变量，值为 5。
2.  为文本字符串腾出位置并调用变量 yourPassword。
3.  循环遍历 myNumbers 中的每个字节。
4.  对 myNumbers 进行排序。
5.  再次循环遍历 myNumbers 中的每个字节（这次是排序的），调用每个字节“elem”。

你真的应该阅读一些关于编程的初学者教程（一般来说）。这与实际的 Array 类关系不大。

编辑：Aaaand 你改变了你的问题......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-06T20:10:41.467

我猜 1*、2*、3*、4* 和 5* 是在您正在查看的示例中向您指出某些东西的符号。

*const*是一个修饰符，将变量标记为常量（即它永远不会改变）

*byte*是一种数据类型，将存储 1 个字节（8 位）的数据。

**编辑**好吧，现在我觉得很愚蠢......当我最初阅读它时，这个问题的格式并不完全相同。随意忽略我的回答...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T20:11:13.400

来自[MSDN](http://msdn.microsoft.com/en-us/library/e6w8fe1b(VS.80).aspx)：

**常量：**

const 关键字用于修改字段或局部变量的声明。它指定字段或局部变量的值是常数，这意味着它不能被修改。

例如：

```
const byte numbers = 5; 
```

您正在声明一个名为*“字节”类型的**常量*变量，其*值为*5。

 **稍后，您将无法更改变量编号，例如：

```
numbers = 6; // this is not allowed because it was declared as const 
```

我希望这能澄清你问题的第一部分。

我建议去[MSDN](http://www.msdn.com)并查找问题其他部分的条款。尝试养成使用此资源以供将来参考的习惯。

# objective-c - Objective-C/Cocoa：我这里有内存泄漏吗？

> ID：722957
> 
> 赞同：1
> 
> 时间：2009-04-06T20:01:49.647
> 
> 标签：objective-c, cocoa

我有一个如下所示的调用方法：

```
-(void)callingMethod
{
     NSMutableString *myStr = [[[NSMutableString alloc] initWithCapacity:0] autorelease];
     myStr = [self calledMethod];
} 
```

而我的调用方法：

```
-(NSMutableString*)calledMethod
{
    NSMutableString *newStr = [[NSMutableString alloc] initWithCapacity:0];
    // do some stuff with newStr
    return [newStr autorelease];
} 
```

我在这里的任何地方泄漏内存吗？我觉得我在这里分配了不必要的金额。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-06T20:06:00.557

不，您没有泄漏内存，但是您在此处分配了不必要的数量的直觉是正确的。

至少，您应该考虑将以下内容重写`callingMethod`为：

```
- (void)callingMethod
{
    NSMutableString *myStr = [self calledMethod];
} 
```

你也可以整理一下`calledMethod`：

```
- (NSMutableString*)calledMethod
{
    return [NSMutableString stringWithCapacity:0]; // why 0 capacity?
} 
```

# msn-messenger - 您如何**以编程方式**在 live Messenger 中部署自定义表情？

> ID：722964
> 
> 赞同：2
> 
> 时间：2009-04-06T20:03:02.217
> 
> 标签：msn-messenger, windows-live-messenger

我已经问过这个问题了，它在 30 分钟内就被删除了……所以又来了，希望这次问题会更清楚（不，我不是苦涩的 ;-)）

您如何打包一堆图像并以**编程**方式将它们部署为实时信使的自定义表情包？我知道用户可以创建任意数量的自定义表情符号，因为他/她喜欢摆弄一些选项对话框。我正在寻找的是不同的：一些图形专家递给我一包图像，并要求我创建一个可分发的包，人们可以下载并添加到他们的 MSN 客户端。我怎么做？

MediaPlayer 皮肤只是带有有趣文件名和一些 JScript + XML 魔法的 zip 档案。表情包是这样的吗？我真的应该去写一些 .msi 代码吗？那里有任何文件吗？MSDN 有[Windows Live Messenger Web Toolkit](http://msdn.microsoft.com/en-us/library/dd570035.aspx)和[Windows Live Client Extensibiliy APIs](http://msdn.microsoft.com/en-us/library/dd179336.aspx)，但据我所知，其中没有表情符号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-06T21:48:39.250

我前段时间尝试过这样做，但失败了：P

这是我发现的：

*   每个表情符号存储在 2 个文件中：
    *   一个图像文件，扩展名为`.dt2`. 它基本上包含表情图像（gif/png）
    *   一个元数据文件，扩展名为`.id2`. 它包含一些额外的信息，如表情名称、键盘快捷键等。
*   这些文件存储在文件夹中：
    *   视窗XP：`%USERPROFILE%\Local Settings\Application Data\Microsoft\Messenger\[EmailAddress]\ObjectStore\CustomEmoticons\`
    *   视窗：`%LOCALAPPDATA%\Microsoft\Messenger\[EmailAddress]\ObjectStore\CustomEmoticons\`
*   元数据文件 (.id2) 使用称为 PUID（Passport Unique Identifier）的东西加密，可以通过使用电子邮件和密码连接到 Windows Live 服务来获得。它们可以使用 Win32 API [CryptUnprotectData()解密](http://msdn.microsoft.com/en-us/library/ms938379.aspx)

*   ~~（不确定）您可以通过将扩展名更改为`.dt2`并将它们放在上述文件夹中来添加表情符号。它们会出现，但没有键盘快捷键和其他元数据。我不知道文件名是否会影响任何事情。~~ *刚试了一下，不行。*

`id2`以下是有关解密文件的一些相关讨论。您可能会发现它们很有用：

*   [解密 Messenger Id2 文件](http://forums.fanatic.net.nz/index.php?showtopic=18187)
*   [Messenger 内容存储系统的说明](http://forums.fanatic.net.nz/index.php?showtopic=14837)

# security - 不使用 .htaccess 文件是否存在安全风险？

> ID：722973
> 
> 赞同：3
> 
> 时间：2009-04-06T20:04:50.420
> 
> 标签：security, .htaccess, joomla

我有一个 Joomla 站点 www.siteA.com 和另一个 Joomla 站点 www.siteA.com/siteB。

我在站点 A 有一个 .htaccess -文件，但在站点 B 没有。

**在 siteB 没有 .htaccess 文件是否存在安全风险？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-06T20:07:41.847

`.htaccess`文件用于**覆盖**在 apache 配置中设置的其他设置。如果您没有想要更改的内容，那么您不需要（也不应该拥有） .htaccess 文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-07T00:03:19.130

为 Joomla! 编写的 .htaccess 文件！主要用于 mod_rewrite 目的，因此您可以获得 SEF URL 而不会 /index.php/ 卡在中间。那里有一些额外的规则来阻止因错误配置的服务器或编码不当的第 3 方扩展而发生的攻击。不必使用此文件来保护核心 Joomla！系统。这是你的最后一道防线，而不是你的第一道防线。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T20:19:05.720

您有权访问主服务器配置文件吗？如果是这样，您根本不应该使用 .htaccess 文件。不正确配置服务器会带来安全风险，但所有配置都应在主配置文件中完成（`/etc/apache2/httpd.conf`例如）。

如果您无权访问主服务器配置文件，那么没有 .htaccess 文件*可能*不会带来安全风险。通常，编写主服务器配置文件的人不会留下任何重大的安全漏洞（好吧，至少我们希望如此）。但这取决于您网站的具体情况。例如，可以将主服务器配置为在目录中没有索引文件时允许目录列表。如果您有不希望任何人意外找到的文件，这可能会带来安全风险，但否则不会有任何危害。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T15:24:42.020

.htaccess 文件是用于**覆盖**每个目录级别的选项的配置文件。可以从主 apache 配置（通常在 /usr/local/etc/apache* 中）设置这些相同的选项（以及更多）。如果您拥有自己的服务器并正确设置了 Apache 配置，那么出于性能原因**禁用**.htaccess实际上可能会有所收获。

未正确配置权限通常会带来安全风险。如何设置它们取决于您。有些人更喜欢启用 .htaccess，以便他们可以将应用程序特定的设置保持在一起。

要回答您关于 Joomla 的具体问题：默认提供的 .htaccess 文件只不过是 URL 重写而已。这提供了近乎零的安全优势，因此没有 .htaccess 文件应该不是问题。它还为一些旧的第三方模块增加了一些基本的保护。但是，您应该更新或删除它们，而不是依赖 .htaccess

最后，这取决于您所说的安全（几乎所有与安全有关的问题）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-26T00:23:21.633

**使用**htaccess 文件是否存在安全风险？我在工作中将一个 htaccess 文件上传到了一个公共网络文件夹，以将页面仅限于员工，但被告知我不应该使用 htaccess 文件或编程，否则我会填满整个网站并冒着安全风险。我使用了以前在其他领域工作时使用过的标准 htaccess 文件，没有任何问题。当网站管理员说“使用 htaccess 存在安全风险”时，他们是什么意思？

# php - 使用 PHP 更新时，PostgreSQL 时间戳字段的格式不同

> ID：722975
> 
> 赞同：1
> 
> 时间：2009-04-06T20:05:14.943
> 
> 标签：php, postgresql, date, timestamp

我在 PostgreSQL 中有一个*带时区字段的时间戳。*当我更新这个字段时，我使用这样的东西：

```
$date = date('Y-m-d H:i:s'); 
```

*尽管 SQL 工作正常，但保存的日期似乎与带有时区日期的经典时间戳*有点不同。

```
Example:

Default value set to "now()":
date 2009-04-06 14:39:53.662522+02

Update with a date set in php:
$date = date('Y-m-d H:i:s');
date 2009-04-06 14:39:53+02 
```

更新时删除的数字可能是毫秒，但我不确定。我想知道是否有办法获得与 PHP 相同格式的日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T08:13:20.933

If you only need one second resolution of timestamp you have to design your database accordingly, as by default resolution is better than a second.

Use for example the following column definition:

```
last_access_time timestamp with time zone not null
    default date_trunc('second',now())
    constraint last_access_time_full_second check (
        date_trunc('second',last_access_time)=last_access_time
    ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T20:48:32.343

您可以使用[microtime() PHP 函数](http://us2.php.net/microtime)来获取微秒。

# orm - 哪些 .NET ORM 支持智能客户端（即对象映射和数据同步）

> ID：722979
> 
> 赞同：1
> 
> 时间：2009-04-06T20:06:02.133
> 
> 标签：orm, synchronization, smartclient

我最近参与了一个需要智能客户端的项目。我们为 ADO.NET 使用了 SQL Server Compact Edition 和 Microsoft Sync Services。我们的在线服务器是 SQL Server 2005。一个准 ORM/DAL（非常符合我们的需求）是由我们团队的成员手工编码的。在这种情况下创建自定义 ORM 花费了我们很多本可以在其他地方使用的开发时间。任何人都可以推荐一个专为智能客户设计的第三方 ORM 吗？

我想我正在寻找一个集成以下内容的 ORM：

*   标准的前向和后向对象映射功能
*   一个灵活且细粒度的同步框架（即，我希望能够逐个对象指定验证和冲突解决策略）
*   对 XBAP 或 Silverlight 客户端的支持会很好，但不是必需的。

我还应该注意，我并没有明确地将 MSSQL 或 MSSQL CE 用于数据。

我只发现了一款​​名为 Telerik OpenAccess 的产品似乎可以满足这些需求。有没有人有这方面的经验？[http://www.telerik.com/products/orm.aspx](http://www.telerik.com/products/orm.aspx)

还有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T23:51:50.343

是的，我们正在使用**OpenAccess**。在像您一样手动编码 ORM 之后，开始寻找更快/更便宜/不那么痛苦的解决方案，而 OA 是赢家。

我认为 NHibernate 也是一个很棒的工具，但我经常读到关于中/大型数据库的性能和建模问题。我试过了，这对我来说是一个不同的世界。

Telerik 说 CE 支持将在 2009 Q1 增加，我希望这是真的:) 所以我认为你应该给 OA 一个机会，因为

*   它有很好的**前向和后向映射**
*   **巫师**
*   **可配置**的过程
*   类和属性或/和基于 xml 的映射
*   我有**很好的表演**经验
*   智能客户端环境中的优点：**缓存、延迟加载**、静态编译技巧
*   **LINQ、SQL**、OQL
*   断开连接的模型，n 层支持（好吧，只是一个类，但有效：）
*   **Silverlight 样品**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T20:12:08.123

NHibernate 或 Linq-2-SQL 将是您的标准答案:)

我个人非常喜欢 NHibernate，但我不确定它有多少开箱即用的 SQL 方言。但它非常受欢迎，所以我认为除了 MYSQL / MSSQL 之外，找到其他方言不会太难

# windows - 有更好的 Windows 命令行 shell 吗？

> ID：722980
> 
> 赞同：33
> 
> 时间：2009-04-06T20:06:11.977
> 
> 标签：windows, shell, cmd

CMD.EXE 给我带来了很多问题。我安装了 Cygwin 并定期使用 bash，我也有 mSysGit 附带的 mingwin bash shell，但有时我确实需要从 Windows shell 运行东西。

是否有 Windows shell 的替代品：

*   有一个持久的命令行历史，在我关闭会话后在我的下一个会话中可用？（如在 bash HISTFILE 中）
*   记得我刚才在哪个目录，以便我可以在两个目录之间切换？（如 bash cd - ）

（或者有没有办法在 CMD.EXE 中启用这些功能？）

我看到有些人之前曾询问[过更好的 windows shell](https://stackoverflow.com/questions/5724/better-windows-command-line-shells)，但他们询问的是剪切和粘贴，这对我来说优先级较低。杀死我的不是控制台，而是命令行解释器。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-06T20:10:47.830

微软刚刚发布的[Powershell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)。（大约 2 年前）

我已经下载了；没有尝试太多，但似乎是一个不错的工具。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-06T20:54:47.070

我一直很喜欢 4NT（有一段时间没用了）。

它是 Windows 的增强型命令解释器，并且大部分是向后兼容的（意味着您可以运行普通的 Windows 批处理文件）。不使用它的唯一原因是它不像默认的 command.exe 那样随 Windows 一起提供。

与默认的 windows 命令行解释器相比，它具有更好的流控制机制。所有标准的 Windows 命令行工具都可用，但带有额外的选项和参数。

基本上这就是 CMD.exe 应该是的。

**更新**：看起来它不再被称为 4NT，而是 TakeCommand：http: [//jpsoft.com/products.htm](http://jpsoft.com/products.htm)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-06T20:17:51.230

我也在使用 Powershell。这是一个很棒的、类似 linux shell 的但面向对象的可扩展框架。不仅对系统管理员很酷，对开发人员也很酷（构建过程等）。Powershell 摇滚 bash 或其他 linux 竞争对手:)

主要冒险：

*   **可使用 .NET 语言进行**扩展****
***   使用**.NET 对象**（日期时间、文件等）*   简单明了的语法*   远程处理*   **调试***   可步进的管道*   ...**

 **更多来自这里：

[http://blogs.msdn.com/powershell/default.aspx](http://blogs.msdn.com/powershell/default.aspx)

[http://windowsteamblog.com/blogs/windowsvista/archive/2006/11/14/it-forum-day-one-windows-vista-and-windows-powershell.aspx](http://windowsteamblog.com/blogs/windowsvista/archive/2006/11/14/it-forum-day-one-windows-vista-and-windows-powershell.aspx)

[http://blogs.msdn.com/powershell/archive/2007/11/06/what-s-new-in-ctp-of-powershell-2-0.aspx](http://blogs.msdn.com/powershell/archive/2007/11/06/what-s-new-in-ctp-of-powershell-2-0.aspx)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-09-08T20:17:55.640

另一个出色的解决方案是“Clink”，它通过持久的历史和更多类似 BASH 的功能来增强 CMD.exe。只需安装它，然后正常打开 CMD。请参阅：[http ://code.google.com/p/clink/](http://code.google.com/p/clink/)

或者，如果您真的希望 'cd -' 能够将您带到上一个目录，请从[http://jpsoft.com](http://jpsoft.com)安装Wouter 和 Peter 提到的“TCC/LE”免费版本。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-06T20:08:13.343

尝试控制台2：http: [//sourceforge.net/projects/console/](http://sourceforge.net/projects/console/)

我喜欢

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-10-18T15:42:32.867

[PyCmd](http://sourceforge.net/projects/pycmd/)符合您的两个要求！它建立在 cmd.exe 之上...

1.  命令历史记录在 PyCmd 会话中是持久的
2.  最近访问过的目录的历史记录（Alt-Left/Right/D 在空行上）

这里有功能列表[http://sourceforge.net/projects/pycmd/files/pycmd/0.8/](http://sourceforge.net/projects/pycmd/files/pycmd/0.8/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-06T20:12:08.017

[PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)，我会说。它是 Microsoft 用于命令行管理的新官方 shell。

我自己将它用于开发任务，并且喜欢它。它使您可以灵活地直接在命令行上与 .NET 框架类进行交互，这非常强大。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-05-23T04:17:20.937

其他人已经提到过 Powershell 和 4NT，两者都是比`CMD`其所有晦涩的语法更好的解决方案，缺乏文档并且通常令人惊讶地无法完成几乎任何您可能想要使用它的任务:)

*   4NT 现在是`Take Command`GUI 文件管理套件的一部分，但所有者只提供了自己的外壳部分，它现在称为 TCC/LE，现在也是免费的！对于大多数人来说，我会说要使用它——这是最简单的学习曲线，因为它具有`CMD`与 .

    [TCC/LE 下载](http://jpsoft.com/tccle-cmd-replacement.html)

*   对于需求比较模糊、进行大量管理或想要更多灵活性的人，请尝试 Powershell - 这是一个陡峭的初始学习曲线，但它在内部非常一致，一旦您了解了基础知识，您就可以访问和操作 99.9% Windows 使用相同的工具和方法处理的所有事情，甚至在其他机器上通过网络执行它。即使学习基础知识（排序、选择、% 和？）也比`CMD`已经学习的要好...

    [PowerShell 用户手册](http://technet.microsoft.com/en-us/library/ee221100.aspx)

    [PowerShell 示例](http://www.robvanderwoude.com/powershellexamples.php)

*   如果你更倾向于技术，那么我会考虑 IPython——它的核心是一个用于编写和执行 Python 代码的控制台，但它也可以非常方便地充当一个 shell（和任务管理系统）——它有书签、别名、选项卡代码/文件的完成，可以混合代码和shell命令，例如`files=!dir *.txt`保存输出`dir *.txt`，输入和/或输出的可配置日志记录，可以重复过去的命令块，导出它们或创建宏，并具有可以对其进行更多自定义的扩展。

    [IPython 作为外壳](http://ipython.org/ipython-doc/dev/interactive/shell.html)

    绝对不适合胆小的人，但如果您了解 Python，这是一个非常强大的环境！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-06T20:11:48.157

pushd 和 popd 可用于导航到目录和从目录导航。

c:>推送窗口 c:\Windows>popd c:\

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-06T20:36:36.723

当您以 PowerShell 方式做事时，PowerShell 工作得很好。例如，当您想要处理 .NET 应用程序和 Windows 文件时。它非常适合编写脚本，因为语法比 Bash 中的要好得多......

但是，当您想使用一些典型的 UNIX 应用程序时，当 PowerShell 将所有 LF 行结尾转换为 CRLF 时（甚至不考虑管道二进制文件），您很容易遇到麻烦。

只是我的经验。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-06T20:11:50.823

然后是 PowerShell！没有尝试过，但我听说过很多关于它的好消息。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2010-01-05T18:56:09.370

我使用cygwin。这是 Windows 的 posix 实现。因此，您可以在 Windows 上运行类似 unix 的程序。默认终端是 bash，比 windows cmd 高级得多。

# .net - 公开 WCF 服务可能不直接使用的对象 (DataContracts)？

> ID：722982
> 
> 赞同：1
> 
> 时间：2009-04-06T20:06:28.387
> 
> 标签：.net, wcf, .net-3.5, datacontractserializer

我有一些使用继承的对象类。似乎我只能访问服务直接使用的对象。让我向您展示我要完成的工作：

```
[DataContract]
public class Object1
{
   [DataMember]
   int Id {get; set;}
}

[DataContract]
public class object2: Object1
{
   [DataMember]
   string Name {get; set;}
}

[DataContract]
public class object3 
{
    [DataMember]
    int SomeNumber {get; set;}
} 
```

服务：

```
public int GetId(object2 obj)
{
    return GetTheId(object2.Name);
} 
```

现在因为我在服务中使用 object2，所以 object1 也被序列化了。但是，出于某种原因，我可能希望公开 object3。它可能是我必须传递的派生类，以便稍后可以为另一个进程确定其类型。我没有看到这个对象被序列化。我假设每当您设置 DataContract / DataMember 时，这些对象都会被序列化。不暴露未开始使用的东西确实有意义，因为我可以看到暴露您可能不需要的项目的问题。公开服务不直接使用的对象的最佳方法是什么？谢谢

丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T20:14:17.450

[您应该使用KnownType 属性](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.knowntypeattribute.aspx)装饰 object2（类的特殊名称:)）：

```
[DataContract]
[KnownType(typeof(object3))]
public class object2 
{
} 
```

假设您的意思是 object3 是 object2 的子类：

```
public class object3: object2
{
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-06T20:11:33.617

我相信你回答了你自己的问题。如果服务未使用成员，则不应公开它们。公开服务所需的最小数据集总是更好，因为它通常会增加服务的可维护性。

# python - 将摊铺机和鼻子与非典型目录结构一起使用

> ID：722992
> 
> 赞同：3
> 
> 时间：2009-04-06T20:08:06.387
> 
> 标签：python, nose, paver

我正在尝试编写一个将在我的文件上`Paver`运行的任务。`nosetests`

我的目录结构如下所示：

```
project/
   file1.py
   file2.py
   file3.py
   build/
      pavement.py
   subproject/
      file4.py
   test/
      file5.py
      file6.py 
```

Doctests（使用该`--with_doctest`选项）应该在所有 *.py 文件上运行，而只有`project/test`（在这个例子中，`file5.py`和`file6.py`）下的文件应该被搜索测试例程。

我似乎无法弄清楚如何做到这一点——我可以编写一个包含正确文件的自定义插件，但在调用任务之前`nose`我似乎无法`paver`构建和安装它。`nosetests`我也找不到在命令行上`paver`传递要测试的文件列表的方法。`nosetests`

让它发挥作用的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-21T22:15:04.587

这完全接近你想要达到的目标吗？

```
from paver.easy import sh, path
__path__ = path(__file__).abspath().dirname()

@task
def setup_nose_plugin():
    # ... do your plugin setup here.

@task
@needs('setup_nose_plugin')
def nosetests():
    nose_options = '--with-doctest' # Put your command-line options in there
    sh('nosetests %s' % nose_options, 
       # Your pavement.py is in a weird place, so you need to specify the working dir:
       cwd=__path__.parent) 
```

我实际上不确定如何告诉鼻子查看特定文件，但这是命令行选项的问题。

`--where`让您指定一个目录，但我看不到“仅在此处运行 doctests，在此处运行其他测试”的方法。您可能需要两次调用`sh('nosetests')`来完成所有这些操作。*****`