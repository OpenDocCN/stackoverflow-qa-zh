# StackOverflow 问答 000583000-000583999

# sql - 提高集群索引 GUID 主键的性能

> ID：583001
> 
> 赞同：10
> 
> 时间：2009-02-24T18:39:25.403
> 
> 标签：sql, primary-key, performance, guid, clustered-index

我有一个包含大量行（10K+）的表，它的主键是 GUID。主键是集群的。此表的查询性能相当低。请提供建议以使其高效。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-02-24T18:46:58.490

GUID 上的聚集索引不是一个好的设计。GUID 的本质是它是随机的，而聚集索引通过键对记录进行物理排序。这两件事完全不一致。对于每个插入 SQL 都必须重新排序磁盘上的记录！从此索引中删除集群！

使用聚类的时间是当您对数据具有“自然”顺序时：插入时间、帐号等。对于时间字段，聚类几乎是免费的。对于帐号，它可能是免费的或便宜的（当帐号按顺序分配时）。

虽然可能有解决 GUID 问题的技术方法，但最好的办法是了解何时使用集群。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-04-22T11:08:10.363

使用 GUID 作为主键没有问题。只需确保当您实际将 GUID 设置为主键时，然后将它自动创建的索引设置为非聚集类型。很多人忘记（或不知道）在 SQL Server 中执行此操作。

切勿在 GUID 上使用聚集索引。这将导致围绕磁盘上的 GUID 进行物理排序，这显然是没有意义的（正如其他人已经指出的那样）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-24T18:48:15.663

您需要使用 newsequentialid() 代替在这里查看[一些简单的代码来显示 Newid 和 Newsequentialid 之间的区别](http://sqlblog.com/blogs/denis_gobo/archive/2009/02/05/11743.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T18:43:34.877

您可以尝试顺序 GUIDS，这将使索引更有效。信息[在这里](http://msdn.microsoft.com/en-us/library/ms189786.aspx)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-10T16:01:31.347

您需要分析您的查询。我们只能在不查看执行计划的情况下猜测为什么您的查询执行不佳（您可以从 SQL Server 或 Oracle 轻松获得安静）。

考虑到 GUID 是 128 位值（如果存储为原始值），GUID 将数据和索引块的密度降低了 50%（在主键索引的情况下），因此请确保 GUID 是合适的。

但这可能不是问题，因此请查看查询计划。可能是其他几个问题。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2009-12-02T10:35:46.803

请避免为长字符串列创建聚集索引。GUID 将有 36 个字符。即使您创建为聚集索引，它也会降低查询性能。为了更好地实践，请使用整数标识列。

# c++ - 重载新/删除

> ID：583003
> 
> 赞同：28
> 
> 时间：2009-02-24T18:39:30.830
> 
> 标签：c++, operator-overloading, new-operator, delete-operator

我在我的程序中做了一个小内存泄漏查找器，但是我重载 new 和 delete（以及 new[] 和 delete[]）的方式似乎没有做任何事情。

```
void* operator new (unsigned int size, const char* filename, int line)
{
    void* ptr = new void[size];
    memleakfinder.AddTrack(ptr,size,filename,line);
    return ptr;
} 
```

我重载的方式`new`如上面的代码片段所示。我想这是运营商返回 void* 的问题，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-02-24T18:56:23.320

也许你可以用一点预处理魔法来做你想做的事：

```
#include <iostream>

using namespace std;

void* operator new (size_t size, const char* filename, int line) {
    void* ptr = new char[size];
    cout << "size = " << size << " filename = " << filename << " line = " << line << endl;
    return ptr;
}

#define new new(__FILE__, __LINE__)

int main() {
    int* x = new int;
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-24T18:48:26.473

我认为这里的问题是您的 new 参数配置文件与标准 operator new 的参数配置文件不匹配，因此不会隐藏（因此仍在使用）。

您的新建和删除参数配置文件需要如下所示：

```
void* operator new(size_t);
void operator delete(void*, size_t); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-24T18:44:24.517

```
void* ptr = new void[size]; 
```

不能那样做。修理它。

永远不要尝试在全局范围内重载 new/delete。要么将它们放在基类中并从此类派生所有对象，要么使用命名空间或模板分配器参数。为什么，你可能会问。因为如果您的程序不仅仅是一个文件并且使用 STL 或其他库，您将会搞砸。

`new`这是来自 VS2005的运算符的提炼版本`new.cpp`：

```
void * operator new(size_t size) _THROW1(_STD bad_alloc)
{       // try to allocate size bytes
   void *p;
   while ((p = malloc(size)) == 0)
    if (_callnewh(size) == 0)
     {       // report no memory
        static const std::bad_alloc nomem;
        _RAISE(nomem);
     }

     return (p);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T18:43:52.070

您是否正确调用重载运算符，即传递附加参数？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-24T18:45:07.043

问题取决于您添加到重载的 new 运算符的两个参数。尝试以某种方式使文件名和行全局化（或者如果您为单个类重载 new 和 delete 则为成员变量）。那应该会更好。

# c# - 在 Asp.NET MVC 中对控制器进行分组？

> ID：583004
> 
> 赞同：0
> 
> 时间：2009-02-24T18:39:38.680
> 
> 标签：c#, asp.net, asp.net-mvc

我想在 Asp.Net MVC 应用程序的控制器文件夹中创建一个子文件夹。但是，当我这样做并尝试导航到无法找到控制器的页面时。

这是一个具体的例子。目前我有：

```
Controlers/UserAdminControler.cs
Controlers/PageAdminControler.cs
Controlers/MenuAdminControler.cs
Controlers/SomeOtherControler.cs
... 
```

我想这样组织它：

```
Controlers/Admin/UserAdminControler.cs
Controlers/Admin/PageAdminControler.cs
Controlers/Admin/MenuAdminControler.cs
Controlers/SomeOtherControler.cs
... 
```

我找到了一种创建“区域”的方法。这是一个非常好的想法和文章，但这并不是我正在寻找我的网站的内容：http: [//haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)

我还发现您可以在 Views 目录中创建子文件夹（当您返回 View() 时，您只需提供路径作为参数）。我现在只需要弄清楚如何在控制器目录中添加子文件夹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T18:58:14.187

我刚试过，没有问题。我在我的 Controllers 目录中添加了一个子文件夹，并将其命名为“SubFolder”。在那里我添加了一个名为“SubController”的控制器。然后我在我的视图中添加了一个名为 Sub 的文件夹，并添加了一个名为 Index 的视图。然后我运行应用程序并导航到：

[http://localhost:2922/Sub/Index](http://localhost:2922/Sub/Index)

没有问题。也许我误解了您的问题，但在控制器文件夹中添加子文件夹似乎没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T00:57:07.990

看看 S#arp 架构。比利已经融入了区域的概念。您可以在此处找到信息：[http](http://code.google.com/p/sharp-architecture/) ://code.google.com/p/sharp-architecture/ 。您也可以在那里找到 google 组的信息。它非常活跃，非常支持。

# ruby-on-rails - 关于 ActiveRecord 关联的简单问题

> ID：583006
> 
> 赞同：1
> 
> 时间：2009-02-24T18:40:41.360
> 
> 标签：ruby-on-rails, activerecord

我的应用程序具有“贷款”的概念。每笔贷款都有债权人、债务人和金额。

从数据库的角度来看，我知道我希望贷款表看起来像这样：

```
|id|Amount|creditor_id|debtor_id|
| 1|   100|          5|        7| 
```

债权人/债务人 ID 引用用户 ID（即，我的用户表中的行的主键）。

我的问题是我应该如何在 ActiveRecord 中进行设置。我不能做这样的事情：

```
class Loan < ActiveRecord::Base
    has_one :creditor 
```

因为这将导致 Rails 查找“债权人”表（债权人都存储在用户表中）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T18:54:25.337

选项（自然地，在 Rdoc 中有详细记录）是 :class_name。我相信语法是：

```
has_one :creditor, :class_name => 'User' 
```

此外，您可能需要为此添加书签：

[http://api.rubyonrails.org/](http://api.rubyonrails.org/)

下次可以节省几分钟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T20:20:37.233

这并不像看起来那么容易。用户能否既是债权人又是债务人？他们可以拥有多于一笔贷款吗？

基本上，看起来你想要一个自引用的多对多关系。您需要一个称为贷款的连接模型，因为您的连接表中有额外的数据，因此您应该使用 has-many :through。这是一篇很好的[博客文章](http://blog.hasmanythrough.com/2006/4/20/many-to-many-dance-off)，介绍了 habtm 和 has-many :through 之间的区别。

有很多关于如何用模型关系做复杂事情的例子。请注意，尽管所有花哨的模型设置都与如何设置控制器和视图的示例不匹配。似乎教程作者都避开了与控制器和视图的多对多关系的完整示例，因为这非常困难。

祝你好运

# nhibernate - 使用 NHibernate 在 Unity 拦截下从代理获取真实实例

> ID：583011
> 
> 赞同：4
> 
> 时间：2009-02-24T18:42:01.747
> 
> 标签：nhibernate, unity-container, aop, unity-interception

我正在使用 Unity 为可插拔架构动态解析类型。我还使用拦截通过 AOP 应用业务规则验证（使用[ValidationAspects](http://www.codeplex.com/validationaspects)）。最后，我使用 NHibernate 作为 ORM 来持久化域对象。

为了让 AOP 工作，我们使用`VirtualMethodInterceptor`, 因为接口拦截不适用于 NHibernate。我有一个外观`ISession`来处理存储库操作的接口和真实类型之间的转换。

为了确保通过 NHibernate 获取的图中的所有对象都为 AOP 正确代理，我做了一个 NH`IInterceptor`实现并覆盖了该`Instantiate()`方法，因此我可以为 NH 提供创建的对象而不是让它调用`new()`. 然后，我使用`Container.Resolve()`注入验证来取回代理对象，并将其返回给 NH 以填充。这工作正常。

当会话刷新发生时，问题就出现了。NHibernate 感到不安，因为它在图中看到的对象是代理类型而不是真实类型。如果我可以覆盖类型检查，我们映射的方式（所有通过属性，所有虚拟）NH 应该能够通过代理获取它需要的所有值。

我需要知道的是：给定由 Unity 创建并启用拦截的透明代理对象，是否有任何方法可以直接引用它正在代理的“真实”实例，或者 b) 覆盖 NH 并告诉它处理代理类型的对象，就好像它是已知的映射类型一样，在运行时动态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-13T14:32:33.353

我们使用拦截进行缓存。所以在我们的类中，`ICallHandler`我们有这样的代码：

```
 public IMethodReturn Invoke(IMethodInvocation input, GetNextHandlerDelegate getNext)
    {
        //...
        var nextHandler = getNext();

        var realReturn = nextHandler(input, getNext);

        var cacheRefreshingItemParameters = new CacheRefreshingItemParameters
        {
            InterfaceMethod = input.MethodBase,
            InterfaceType = input.MethodBase.DeclaringType,
            TargetType = input.Target.GetType() //remember original type
        };
        _cacheProvider.Add(cacheKey, realReturn.ReturnValue, cacheRefreshingItemParameters);

        //...
        return (cachedReturn);
    } 
```

我们将 cacheRefreshingItemParameters 放入缓存 UpdateCallback 中，然后解析原始服务：

```
var service = _unityContainer.Resolve(parameters.TargetType); 
```

# php - 用下划线替换 URL 中的空格

> ID：583025
> 
> 赞同：2
> 
> 时间：2009-02-24T18:46:12.860
> 
> 标签：php, sql

如何用下划线（_）替换 URL 中的空格？

```
$query = mysql_query("SELECT * FROM users WHERE username = '$_GET[user]'"); 
```

但是，如果用户在她/他的用户名中有空格，我想用下划线替换空格。因此 profile.php?user=John Johnson 的 URL 将是 profile.php?user=John_Johnson。

我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-24T18:50:34.487

正如其他地方所提到的， str_replace 会做你特别想要的，但是......

我会更担心`profile.php?user=John' DROP DATABASE--`

不要构建这样的查询。曾经。原因之一请参见[SQL 注入。](http://en.wikipedia.org/wiki/SQL_injection)看看[这篇文章](http://dev.mysql.com/tech-resources/articles/4.1/prepared-statements.html)，了解正确的做法。

哦，还有一本用作记忆辅助[的漫画，以强调你永远不应该这样做。](http://xkcd.com/327/)

编辑：响应您的回复（您最好编辑原始问题，以便很明显您正在澄清您的问题）。如果您将用户“John Johnson”存储在数据库中，但您想使用 URL 访问他，则`profile.php?user=John_Johnson`需要反转您正在执行的替换：

```
 $user  = str_replace('_', ' ', $_GET['user']);
 $user  = mysql_escape_string($user);
 $query = mysql_query("SELECT * FROM users WHERE username = '$user'");

 // finns inte användaren så skriver vi ut ett felmeddelande
 if (!mysql_num_rows($query)) exit('<p>The user you are looking for appears to be          missing.</p>'); 
```

这将获取`profile.php?user=John_Johnson`并生成 sql 查询：`SELECT * FROM users WHERE username = 'John Johnson'`

您回复的示例代码将采用`profile.php?user=John Johnson`并生成 sql 查询：`SELECT * FROM users WHERE username = 'John_Johnson'`我怀疑这与您想要的相反。

但同样，我强烈建议您查看准备好的陈述。 `mysql_escape_string`确实是权宜之计。所需要的只是忘记使用它一次，然后您就打开了您的网站以进行黑客攻击。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T19:28:32.850

由于您不需要正则表达式来执行此替换，因此您应该避免使用它们，因为它们有很大的开销。

此外，由于您只关注字符而不是字符串，因此您应该使用为字符到字符映射编写的函数：strtr()

```
$result = strtr($original, " ", "_"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T18:51:53.203

不要从未经检查的用户输入创建 SQL 字符串。

至少使用`mysql_escape_string()` [以避免被黑客攻击](https://stackoverflow.com/questions/84556/whats-your-favorite-programmer-cartoon/84629#84629)：

```
$user  = str_replace(' ', '_', $_GET[user]);
$user  = mysql_escape_string($user);
$query = mysql_query("SELECT * FROM users WHERE username = '$user'"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T18:48:37.563

[str_replace](http://us2.php.net/str_replace)？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T18:50:13.007

像这样使用[str_replace()](http://se.php.net/str_replace)：

```
$query = mysql_query("SELECT * FROM users WHERE username = 'str_replace(' ', '_',$_GET[user])'"); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T20:28:41.257

比夫，

尝试这个：

```
$user = urldecode($_GET['user']); 
```

`$user`现在包含“John Smith”而不是“John%20Smith”，我认为这就是查询失败的原因。

```
$user = mysql_escape_string($user);
$query = mysql_query("SELECT * FROM users WHERE username = $user"); 
```

您的问题似乎与阻止匹配的 URL 编码字符有关。希望有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T18:49:10.420

您可以使用 str_replace 或 strtr 在实际变量中替换它。通常显示 Strtr 更快。

```
$newUsername = strtr($_GET['user'], ' ', '_'); 
```

应该这样做，你的新查询：

```
$query = mysql_query("SELECT * FROM users WHERE username = '$newUsername'"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T18:51:35.047

[str_replace](http://sk.php.net/str_replace)函数是您正在寻找的。（还有其他一些选择，但 str_replace 对于这种情况就足够了）

```
$query = mysql_query("SELECT * FROM users WHERE username = '" . str_replace(' ', '_', $_GET[user] . "'"); 
```

**警告：**您应该认真阅读有关 SQL 注入的内容。这里有一些介绍：

[http://sk.php.net/security.database.sql-injection](http://sk.php.net/security.database.sql-injection)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T18:51:44.593

您可能想查看[preg_replace()](http://us3.php.net/manual/en/function.preg-replace.php)并将所有“”替换为“_”，如下所示：

```
$result = preg_replace("\s", "_", $_GET['user']); 
```

但是您不应该将用户输入直接放入这样的查询中。查看 PHP 输入敏感化。

**编辑：**抱歉忘记了正则表达式需要 \s 来表示空格。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-24T19:00:49.533

奇怪的是，您的代码似乎都不起作用...我在数据库中有一个名为 John Johnson 的用户。它适用于那些没有空间的人。

编码：

```
 $user  = str_replace(' ', '_', $_GET['user']);
     $user  = mysql_escape_string($user);
     $query = mysql_query("SELECT * FROM users WHERE username = '$user'");

     // finns inte användaren så skriver vi ut ett felmeddelande
     if (!mysql_num_rows($query)) exit('<p>The user you are looking for appears to be          missing.</p>'); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-04-20T23:05:16.980

```
$path = "your website and the path here"; // like http://stackoverflow.com/index.php?id=1
$page = $_SERVER["QUERY_STRING"];
if(stristr($page, ' ')) {
    $page = str_replace(" ","_" , $page);
    $page = str_replace("%20%","_" , $page);
    $page = str_replace("%20","_" , $page);
    $page = str_replace("q=","" , $page);
    echo "<meta http-equiv=\"refresh\" content=\"0; url=$path/$page\" />";
    die();
} 
```

如果你有类似 website.com/index.phphdsdhdh 的页面，你应该删除这一行

```
$page = str_replace("q=","" , $page); 
```

如果你想停止 sql 注入，你可以使用

```
addslashes(); 
```

或使用此功能

```
$page = strtolower($_SERVER["QUERY_STRING"]); if(stristr($page, 'union' or stristr($page, 'and' or stristr($page, 'or' or stristr($page, 'select'){ die("sql injection attack");} 
```

把它放在配置中

# visual-studio - 从项目（VSS 问题）中排除其他项目的输出引用（DLL）

> ID：583037
> 
> 赞同：1
> 
> 时间：2009-02-24T18:47:58.317
> 
> 标签：visual-studio, visual-studio-2008, visual-studio-2005, visual-sourcesafe

这与源代码管理有关，我使用的是 VSS 和 Visual Studio 2008 插件。当引用项目的 DLL 包含在项目中（并检入 VSS）时，在下一次构建时它将失败，因为这些文件没有作为构建过程的一部分检出并且是只读的。

我可以排除整个 bin 文件夹和所有 dll，但这就是我放置我的静态 dll（即未作为解决方案的一部分重新构建的那些）的地方，**有趣的是，Visual Studio 将其他产品的输出以外的 dll 视为排除文件就好了。**

在 VS2005 中，VSS 插件不会自动将引用项目的输出添加为待签入的文件，但在 VS2008 中，它会自动添加。

有人遇到这个问题或找到解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T19:44:06.277

最好根本不检查 bin 文件夹。将依赖项移动到一个公共 lib 文件夹，并从那里引用它们。这将确保它们被复制到 bin 文件夹中。然后，您可以显式检入此 lib 文件夹。

其他要避免检查的文件/文件夹是 obj 目录和 ncb 文件。在这种情况下，我不确定 VSS 集成有多“智能”。

# python - 你是否很难用 Python 保持 80 列？

> ID：583048
> 
> 赞同：15
> 
> 时间：2009-02-24T18:49:46.673
> 
> 标签：python

我发现自己不断地断线只是为了让它们进入下一行。当然，当我去更改那些字符串（想想日志消息）时，我必须重新格式化中断以将它们保持在 80 列内。

大多数人是如何处理这个问题的？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-24T19:01:02.840

我建议尽量忠于 80 列，但不要不惜*一切代价*。有时，就像记录消息一样，让他们保持长久比分手更有意义。但对于大多数情况，比如复杂的条件或列表推导，分解是一个好主意，因为它可以帮助您将复杂的逻辑划分为更易于理解的部分。更容易理解：

```
print sum(n for n in xrange(1000000) 
             if palindromic(n, bits_of_n) and palindromic(n, digits)) 
```

比：

```
print sum(n for n in xrange(1000000) if palindromic(n, bits_of_n) and palindromic(n, digits)) 
```

如果你刚刚写过它，它可能看起来和你一样，但是几天后那些长行变得难以理解。

* * *

最后，虽然 PEP 8 规定了列限制，但它还说：

> 风格指南是关于一致性的。与本风格指南保持一致很重要。项目内部的一致性更为重要。一个模块或功能内的一致性是最重要的。
> 
> 但最重要的是：知道何时不一致——有时风格指南并不适用。如有疑问，请使用您的最佳判断。查看其他示例并决定什么看起来最好。不要犹豫，问！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-24T19:09:17.937

“愚蠢的一致性是小头脑的妖精，受到小政治家、哲学家和神学家的崇拜。”

重要的部分是“愚蠢”。

与 PEP 8 的其他部分一样，80 列的限制是一个非常强烈的建议。但是，有一个限制，超过这个限制就可以被视为愚蠢的一致性。

我在 Komodo 中打开了压痕指南和边缘线。这样，我知道我什么时候跑过去了。问题是“为什么？” “值得修理吗？”

以下是我们常见的情况。

**记录消息**。我们试图使这些易于包装。他们看起来像这样

```
logger.info( "unique thing %s %s %s",
   arg1, arg2, arg3 ) 
```

**Django 过滤表达式**。这些可以继续运行，但这是一件好事。我们经常将几个过滤器连续编织在一起。但它不一定是一行代码，多行可以更清楚地说明发生了什么。

这是函数式编程的一个示例，其中长表达式是明智的。然而，我们避免它。

**单元测试预期结果字符串**。这些发生是因为我们剪切和粘贴来创建单元测试代码并且没有花费大量时间重构它。当它困扰我们时，我们将字符串拉出到单独的字符串变量中并清理`self.assertXXX()`行。

我们通常没有很长的代码行，因为我们不使用 lambdas。我们不追求流畅的课堂设计。我们不会传递很多很多参数（除了少数情况）。

我们很少有很多函数式冗长的表达式。当我们这样做时，我们不会因为将它们分解并留下中间结果而感到尴尬。如果我们是功能纯粹主义者，我们可能会有带有中间结果变量的气体，但我们不是纯粹主义者。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-24T20:00:17.330

它是哪一年或您使用什么输出设备（在某种程度上）都没有关系。如果可能的话，您的代码应该是*人类*可读的。人类很难阅读长行。

这取决于行的内容应该多长。如果它是一条日志消息，那么它的长度就不那么重要了。如果它是一个复杂的代码，那么它的大长度将无助于理解它。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-24T23:42:15.533

临时变量。他们几乎解决了我排长队时遇到的所有问题。偶尔，我需要使用一些额外的括号（比如在较长的 if 语句中）。我不会提出任何支持或反对 80 个字符限制的论据，因为这似乎无关紧要。

具体来说，对于日志消息；代替：

```
self._log.info('Insert long message here') 
```

采用：

```
msg = 'Insert long message here'
self._log.info(msg) 
```

很酷的一点是，无论如何它都将是两行，但是通过使用好的变量名，您还可以使其自我记录。例如，而不是：

```
obj.some_long_method_name(subtotal * (1 + tax_rate)) 
```

采用：

```
grand_total = subtotal * (1 + tax_rate)
obj.some_long_method_name(grand_total) 
```

我见过的大多数长行都在尝试做不止一件事，将其中一件事拉到临时变量中是微不足道的。主要的例外是非常长的字符串，但通常你也可以在那里做一些事情，因为代码中的字符串通常是结构化的。这是一个例子：

```
br = mechanize.Browser()
ua = '; '.join(('Mozilla/5.0 (Macintosh', 'U', 'Intel Mac OS X 10.4',
                'en-US', 'rv:1.9.0.6) Gecko/2009011912 Firefox/3.0.6'))
br.addheaders = [('User-agent', ua)] 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-24T19:12:20.190

这是一个很好的规则，可以在大部分时间里保持，但不要把头发拉到上面。最重要的是，从风格上看，您的代码看起来可读且干净，并且将行保持在合理的长度是其中的一部分。

有时让事情运行超过 80 列会更好，但大多数时候我可以编写我的代码，使其简短而简洁，适合 80 或更少。正如一些响应者指出的那样，80 的限制已经过时了，但有这样的限制也不错，而且很多人都有终端

以下是我在尝试限制行长时要记住的一些事项：

*   我希望其他人使用此代码吗？如果是这样，那些其他人用于此类代码的标准是什么？
*   这些人是否有笔记本电脑、使用大字体或有其他原因导致他们的屏幕空间受限？
*   代码拆分成多行还是一长行对我来说更好看？

这是一个风格问题，但风格非常重要，因为您希望人们阅读和理解您的代码。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-24T18:52:07.167

我建议愿意超过 80 列。80 列是基于各种输出设备的硬限制时的保留。

现在，我不会疯狂...设置一个合理的限制，但 80 列的任意限制似乎有点过分热心。

编辑：其他答案也澄清了这一点：重要的是你打破了什么。为了清楚起见，字符串通常是“特殊情况”，您可能想稍微改变一下规则。另一方面，如果您的*代码变得越来越长，那么现在是查看在何处进行拆分的好时机。*

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-24T21:37:07.207

80 列是我不同意 Python 风格指南的少数几个地方之一。我建议你看看你的代码的受众。如果与您一起工作的每个人都在具有合理分辨率的显示器上使用现代 IDE，那么这可能不值得您花时间。我的显示器很便宜，而且分辨率相对较弱，但我仍然可以容纳 140 列加上滚动条、线标记、中断标记和左侧的单独树视图框架。

但是，您可能最终会遵循某种限制，即使它不是一个固定的数字。除了消息和日志之外，长行很难阅读。被打断的行也更难阅读。自行判断每种情况，并做你认为会让追随你的人生活更轻松的事情。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-24T18:56:35.113

字符串很特别，因为它们往往很长，所以当你需要的时候把它们折断，不要担心。

当您的实际*代码*开始碰到 80 列标记时，这表明您可能希望将深度嵌套的代码分解为更小的逻辑块。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-24T19:03:41.180

我通过不担心我的线路长度来处理它。我知道我写的一些行超过 80 个字符，但大多数不是。

我知道我的立场不被许多人认为是“pythonic”，我理解他们的观点。作为工程师的一部分是了解每个决定的权衡，然后做出你认为最好的决定。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-24T19:38:19.910

80个字符限制？现在是哪一年？

让你的代码可读。如果长行可读，那很好。如果难以阅读，请将其拆分。

例如，当有一个带有很多参数的方法调用时，我倾向于排长队，而这些参数是您所期望的正常参数。所以，假设我将 10 个变量传递给一堆方法。如果每个方法都采用交易 id、订单 id、用户 id、信用卡号等，并且这些都存储在适当命名的变量中，那么方法调用可以与所有变量一起出现在一行后面另一个，因为没有惊喜。

但是，如果您在一种方法中处理多个事务，则需要确保下一个程序员可以看到这次您使用的是 transId1，而那次是 transId2。在这种情况下，请确保它很清楚。（注意：有时使用长线也有帮助）。

仅仅因为“风格指南”说你应该做某事并不意味着你必须这样做。 [有些风格指南是完全错误](http://www.google.ca/search?q=strunk+%26+white+site%3Aitre.cis.upenn.edu)的。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-04-30T16:25:12.090

坚持 80 列不仅对可读性很重要，而且因为我们中的许多人喜欢有狭窄的终端窗口，所以在我们编码的同时，我们还可以看到诸如模块文档加载到我们的 Web 浏览器中和错误坐在 xterm 中的消息。将整个屏幕提供给 IDE 是一种相当原始（如果不是单调的话）使用屏幕空间的方式。

一般来说，如果一行超过 80 列，则意味着无论如何都出了问题：要么你试图在一行上做太多，要么让你的代码部分缩进得太深。我很少发现自己点击屏幕的右边缘，除非我也未能重构应该是单独的功能；命名临时结果；并做其他类似的事情最终会使测试和调试变得更加容易。阅读 Linus 的 Kernel Coding Style guide 以获得关于这个主题的要点，尽管是从 C 的角度来看：

[http://www.kernel.org/doc/Documentation/CodingStyle](http://www.kernel.org/doc/Documentation/CodingStyle)

并且永远记住，长字符串可以分成更小的部分：

```
print ("When Python reads in source code"
       " with string constants written"
       " directly adjacent to one another"
       " without any operators between"
       " them, it considers them one"
       " single string constant.") 
```

或者，如果它们真的很长，通常最好将它们定义为常量，然后在您的代码中以该缩写名称使用：

```
STRING_MESSAGE = (
        "When Python reads in source code"
        " with string constants written directly adjacent to one"
        " another without any operators between them, it considers"
        " them one single string constant.")

...
print STRING_MESSAGE
... 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-24T20:21:35.750

选择你喜欢的风格，应用一层常识，并始终如一地使用它。

PEP 8 是 Python 标准库中包含的库的样式指南。从来没有打算将它作为所有 Python 代码的样式规则。也就是说，人们没有理由不使用它，但它绝对不是一套硬性规则。像任何风格一样，没有单一的正确方式，最重要的是一致性。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-06-17T17:27:52.453

我确实遇到了不时溢出超过 79 列的代码。我要么用 '\' 将它们分开（尽管最近，我读到使用括号代替作为首选替代方案，所以我会试一试），或者如果它不超过 15 或就让它这么过去。这来自一个只缩进 2 个而不是 4 个空格的人（我知道，真丢脸：\）！这不完全是科学。这也是部分风格，有时，将内容放在一条线上更容易管理或阅读。其他时候，过度的左右滚动可能会更糟。

大部分时间都与较长的变量名有关。对于临时值和迭代器之外的变量，我不想将它们减少到 1 到 5 个字母。这些 7 到 15 个字符长实际上确实提供了关于它们的用途和它们所指的类的上下文。

当我需要打印出部分输出是动态的东西时，我将用函数调用替换这些部分，从而减少条件语句和代码体中的纯粹内容。

# c++ - 非平凡对象的 ATL 集合

> ID：583056
> 
> 赞同：1
> 
> 时间：2009-02-24T18:51:02.740
> 
> 标签：c++, atl, collections

我想公开 CMainClass 对象的 ATL COM 集合，以便 C#、VB 或 C++ 客户端可以访问它。

我设置集合本身没有问题，但我不知道如何允许 COM 客户端访问 A、B 和 C 类。我是否应该使用包含的对象制作 A、B 和 C COM 对象一个 std::list<> 每个 ATL 集合本身对吗？

有没有更简单的方法来做到这一点？！？！

谢谢，保罗

```
class C
{
public:
    // get/set functions...

protected:
    std::string str1_;
    std::list< std::string > list1_;
};

class A
{
public:
    // get/set functions...

protected:
    std::list< C > list1_;
};

class B
{
public:
    // get/set functions...

protected:
    std::string str1_;
    std::string str2_;
};

class CMainClass
{
public:
    void GetA( A* a ) const;
    void SetA( const A& a );
    void GetB( B* b ) const;
    void SetB( const B& b );

protected:
    A a_;
    B b_;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T18:57:45.077

Google 在 ATL 中实现 IEnumVARIANT。

这里有一些有希望的链接。

[http://msdn.microsoft.com/en-us/library/3stwxh95.aspx](http://msdn.microsoft.com/en-us/library/3stwxh95.aspx)

[http://www.codeguru.com/cpp/com-tech/atl/misc/article.php/c29](http://www.codeguru.com/cpp/com-tech/atl/misc/article.php/c29)

希望这可以帮助。

Responding to your comment: Yes. If you want to expose Automation Compatible interfaces, i.e. those that can be consumed by VB, C# and script languages, each object must be exposed as a COM interface. Also if you are going to store CComPtr<> in a stl list, make sure you use the CAdapt<> wrapper on them.

# c++ - memcmp 排序

> ID：583063
> 
> 赞同：0
> 
> 时间：2009-02-24T18:52:01.770
> 
> 标签：c++, c, performance, sorting, stl

我有一个缓冲区和几个指向它的指针。我想根据指针指向的缓冲区中的字节对指针进行排序。

qsort() 和 stl::sort() 可以被赋予自定义比较函数。例如，如果缓冲区是零终止的，我可以使用 strcmp：

```
int my_strcmp(const void* a,const void* b) {
  const char* const one = *(const char**)a,
  const two = *(const char**)b;
  return ::strcmp(one,two);
} 
```

但是，如果缓冲区不是以零结尾的，我必须使用 memcmp() ，它需要一个长度参数。

有没有一种整洁、有效的方法可以在没有全局变量的情况下将缓冲区的长度放入我的比较函数中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T19:01:01.217

使用 std::sort，您可以像这样使用 Functor：

```
struct CompString {
    CompString(int len) : m_Len(len) {}
    bool operator<(const char *a, const char *b) const {
        return std::memcmp(a, b, m_Len);
    }
private:
    int m_Len;
}; 
```

然后你可以这样做：

```
std::sort(begin(), end(), CompString(4)); // all strings are 4 chars long 
```

**编辑：**来自评论建议（我猜这两个字符串都在一个公共缓冲区中？）：

```
struct CompString {
    CompString (const unsigned char* e) : end(e) {}
    bool operator()(const unsigned char *a, const unsigned char *b) const {
        return std::memcmp(a, b, std::min(end - a, end - b)) < 0;
    }
private:
    const unsigned char* const end;
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T19:08:35.863

使用 C 函数`qsort()`，不，不使用全局变量就无法将长度传递给比较函数，这意味着它不能以线程安全的方式完成。一些系统有一个[`qsort_r()`](http://www.ipnom.com/FreeBSD-Man-Pages/qsort_r.3.html)函数（*r*代表可重入），它允许您传递一个额外的*上下文*参数，然后将其传递给您的比较函数：

```
int my_comparison_func(void *context, const void *a, const void *b)
{
    return memcmp(*(const void **)a, *(const void **)b, (size_t)context);
}

qsort_r(data, n, sizeof(void*), (void*)number_of_bytes_to_compare, &my_comparison_func); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T19:00:30.983

您是否有理由不能对缓冲区进行空终止？

如果没有，由于您使用的是 C++，您可以编写自己的函数对象：

```
 struct MyStrCmp {
    MyStrCmp (int n): length(n) { }
    inline bool operator< (char *lhs, char *rhs) {
       return ::strcmp (lhs, rhs, length);
    }
    int length;
 };
 // ...
 std::sort (myList.begin (), myList.end (), MyStrCmp (STR_LENGTH)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T18:57:04.987

您可以将缓冲区指针 + 长度打包成一个结构并将该结构的指针作为 传递`void *`吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-07T18:42:05.327

您可以使用以下技巧：

```
int buffcmp(const void *b1, const void *b2)
{
    static int bsize=-1;
    if(b2==NULL) {bsize=*(int*)(b1); return 0;}
    return memcmp(b1, b2, idsize);
} 
```

您将首先调用 as`buffcmp(&bsize, NULL)`然后将其作为比较函数传递给`qsort`.

您当然可以通过添加更多语句使比较在`buffcmp(NULL, NULL)`etc的情况下表现得更自然。`if`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T19:01:14.383

您可以使用仿函数（将长度指定给仿函数的构造函数）或 Boost.Lambda（就地使用长度）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T19:05:56.133

我不清楚你在问什么。但我会尝试，假设

*   你有一个缓冲区
*   你有一个某种指针数组，它已经以某种方式处理，因此它的部分或全部内容指向缓冲区

那是等效于的代码：

```
char *buf = (char*)malloc(sizeof(char)*bufsize);
for (int i=0; i<bufsize; ++i){
    buf[i] = some_cleverly_chosen_value(i);
}

char *ary[arraysize] = {0};
for(int i=0; i<arraysize; ++i){
   ary[i] = buf + some_clever_function(i);
}

/* ...do the sort here */ 
```

现在，如果您控制缓冲区的分配，则可以替换

```
char *buf = (char*)malloc(sizeof(char)*(bufsize+1));
buf[bufsize]='\0'; 
```

并继续使用 strcmp。即使您不控制缓冲区的填充，这也是可能的。

如果你不得不忍受别人递给你的缓冲区，你可以

1.  使用一些全局存储（您要求避免和良好的想法）。
2.  将排序函数交给比原始指针（支持额外数据的结构或类的地址）更复杂的东西。为此，您需要控制`ary`上述代码中的定义。
3.  使用支持额外输入的排序功能。[正如Adam](https://stackoverflow.com/questions/583063/memcmp-sort/583125#583125)`sort_r`所建议的那样，或者是家庭推出的解决方案（我确实建议将其作为学生的练习，而不是在现实生活中推荐）。在任何一种情况下，额外的数据都可能是指向缓冲区末尾的指针。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-02-24T19:08:27.907

`memcmp`应该在不相等的第一个字节上停止，因此长度应该很大，即到缓冲区的末尾。那么它可以返回零的唯一方法是它确实到达缓冲区的末尾。

（顺便说一句，我自己倾向于合并排序。它稳定且表现良好。）

# debugging - 调用本机 C DLL 时尝试读取或写入受保护的内存

> ID：583068
> 
> 赞同：0
> 
> 时间：2009-02-24T18:53:08.897
> 
> 标签：debugging, winapi, dll, reverse-engineering

我有一个本机 C dll，它导出除 DllEntryPoint、FuncX 之外的一个函数。我试图找出 FuncX 如何与它的调用者通信，因为它有一个 void 返回类型并且没有参数。当我从 C# 工具调用它时，我得到一个 AccessViolationException - 试图读取或写入受保护的内存。

我有一种预感，它的客户端应用程序可能会分配一个缓冲区来发送或接收来自 dll 的值。这是一个有效的预感吗？

我无法调试客户端应用程序，因为由于某种原因它没有运行，所以我无法启动它并附加到进程。但是，我可以在 IDA Pro 中对其进行反汇编，但如果可以的话，我不知道如何尝试在其中调试它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T19:09:48.030

如果有问题的 DLL 有任何静态或全局符号，则所有通信都可能通过这些符号完成。您是否有任何看起来可能正在执行此操作的 API 代码？

DLL 不太可能使用客户端提供的缓冲区，因为客户端和服务器都需要知道该缓冲区的基地址，并且您不能在调用时向 calloc 或 malloc 询问“首选”地址。

您也可以尝试运行`link /dump /symbols`并将其指向您的 DLL。这将向您显示 DLL 中导出的符号列表。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T20:52:45.003

我会尝试将 DLL 本身加载到 IDA Pro 中。希望 C# 保留本机调用堆栈，您可以查看 DLL 崩溃的代码。

旁注：[反编译器插件](http://www.hex-rays.com/decompiler.shtml)非常棒。

# sql - SQL选择重复的地方，但在另一列上不同

> ID：583072
> 
> 赞同：0
> 
> 时间：2009-02-24T18:54:20.470
> 
> 标签：sql, tsql

我有下表：

```
uid | key | email
-----------------
1   |  1  | test@test.com
2   |  2  | test@test.com
3   |  3  | test@test.com
4   |  4  | test@test.com
5   |  4  | test@test.com
6   |  4  | test@test.com
7   |  6  | abce@test.com
8   |  7  | defg@test.com 
```

我想抓取所有具有不同键但重复电子邮件值的行

结果应如下所示：

```
uid | key | email
-----------------
1   |  1  | test@test.com
2   |  2  | test@test.com
3   |  3  | test@test.com 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T19:03:53.940

```
SELECT MIN(uid) as uid, key, email
FROM Keys k INNER JOIN 
    (SELECT email FROM KEYS GROUP by email HAVING COUNT(email) > 1 ) k2
    ON k.email = k2.email
GROUP BY key, email
HAVING COUNT(key) = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:16:18.077

```
SELECT * FROM table
WHERE email NOT IN
(
SELECT email 
FROM table GROUP BY email
HAVING COUNT(email) <= 1)
AND key IN
(
SELECT key
FROM table
GROUP BY key
HAVING COUNT(key) = 1 
) 
```

# macos - 启动时如何在 iTerm 中运行命令？

> ID：583075
> 
> 赞同：2
> 
> 时间：2009-02-24T18:55:20.670
> 
> 标签：macos, bash, shell, terminal, iterm

我正在为 Mac 配置 iTerm 终端仿真器来做我想做的事情。显然，一切都是通过他们所谓的“书签”完成的。好的。我正在尝试创建一个书签，它将打开一个选项卡，cd 到某个 Rails 项目，然后运行 ​​command `script/server`。应该发生的是，这将启动服务器守护程序（“Mongrel”），每次查看该选项卡时，我都会看到输出滚动。

在配置对话框中，在“命令”`script/server`下放置项目目录，在“工作目录”下放置项目目录。

发生的情况是选项卡出现 1/10 秒然后消失。

回想一下我在使用 Unix screen 命令时遇到的类似问题，我尝试输入一个“命令”，`bash -c 'script/server'`但结果是相同的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T20:08:51.380

您遇到了这个问题，因为您的脚本运行然后终止。您需要做的就是`read`在脚本末尾添加一个或同样复杂的内容，说“按任意键完成脚本并关闭窗口......”。

### 更新

我写了这个测试脚本：

```
$ cat echoscript 
#!/bin/bash
echo "Hello world"
read text
$ 
```

我创建了一个书签，所以：

```
name: test
command: /Users/chasrmartin/echoscript
Working directory: /Users/chasrmartin 
```

当我打开书签`test`时，我看到了我的“Hello world”，它一直等到我输入 return。当我输入 return 时，它就消失了。

# c++ - C/C++ 更改 const 的值

> ID：583076
> 
> 赞同：21
> 
> 时间：2009-02-24T18:55:20.763
> 
> 标签：c++, constants

我有一篇文章，但我把它弄丢了。它展示并描述了一些人们应该小心的 C/C++ 技巧。其中一个让我感兴趣，但现在我正在尝试复制它，我无法将它编译。

这个概念是可以偶然改变`const`C/C++中 a 的值

是这样的：

```
const int a = 3;          // I promise I won't change a
const int *ptr_to_a = &a; // I still promise I won't change a
int *ptr;
ptr = ptr_to_a;

(*ptr) = 5;               // I'm a liar; a is now 5 
```

我想把这个给朋友看，但现在我错过了一步。有谁知道开始编译和工作缺少什么？

ATM 我**从 'const int*' 到 'int*' 的转换无效，**但是当我阅读文章时，我尝试过，效果很好。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-02-24T19:02:12.900

你需要抛弃常量：

```
linux ~ $ cat constTest.c
#include <stdio.h>

void modA( int *x )
{
        *x = 7;
}

int main( void )
{

        const int a = 3; // I promisse i won't change a
        int *ptr;
        ptr = (int*)( &a );

        printf( "A=%d\n", a );
        *ptr = 5; // I'm a liar, a is now 5
        printf( "A=%d\n", a );

        *((int*)(&a)) = 6;
        printf( "A=%d\n", a );

        modA( (int*)( &a ));
        printf( "A=%d\n", a );

        return 0;
}
linux ~ $ gcc constTest.c -o constTest
linux ~ $ ./constTest
A=3
A=5
A=6
A=7
linux ~ $ g++ constTest.c -o constTest
linux ~ $ ./constTest
A=3
A=3
A=3
A=3 
```

通用答案在 g++ 4.1.2 中也不起作用

```
linux ~ $ cat constTest2.cpp
#include <iostream>
using namespace std;
int main( void )
{
        const int a = 3; // I promisse i won't change a
        int *ptr;
        ptr = const_cast<int*>( &a );

        cout << "A=" << a << endl;
        *ptr = 5; // I'm a liar, a is now 5
        cout << "A=" << a << endl;

        return 0;
}
linux ~ $ g++ constTest2.cpp -o constTest2
linux ~ $ ./constTest2
A=3
A=3
linux ~ $ 
```

顺便说一句..这绝不是推荐的...我发现g ++不允许这种情况发生..所以这可能是您遇到的问题。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-24T19:17:05.233

请注意，标准未定义任何抛弃 constness 的尝试。从标准的 7.1.5.1 开始：

> 除了可以修改任何声明为 mutable 的类成员外，任何在 const 对象的生命周期内修改其的尝试都会导致未定义的行为。

在使用此示例之后：

```
const int* ciq = new const int (3);     //  initialized as required
int* iq = const_cast<int*>(ciq);        //  cast required
*iq = 4;                                //  undefined: modifies a  const  object 
```

因此，简而言之，使用标准 C++ 无法实现您想要做的事情。

此外，当编译器遇到类似的声明时

```
const int a = 3; // I promisse i won't change a 
```

用 3 替换任何出现的 'a' 是免费的（有效地做与 相同的事情`#define a 3`）

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-24T19:19:03.873

只是一个猜测，但一个常见的问题是为什么不能将 an 转换`int**`为 a `const int**`，这起初似乎是合理的（毕竟，您只是添加 a `const`，这通常是可以的）。原因是如果你可以这样做，你可能会不小心修改一个`const`对象：

```
const int x = 3;
int *px;
const int **ppx = &px;  // ERROR: conversion from 'int**' to 'const int**'
*ppx = &x;  // ok, assigning 'const int*' to 'const int*'
*px = 4;    // oops, just modified a const object 
```

这是一个非常不直观的结果，但确保`const`在这种情况下不能修改对象的唯一方法（注意没有类型转换）是使第 3 行出错。

您只能`const`在 FIRST 间接级别添加而不进行强制转换：

```
int * const *ppx = &px;  // this is ok
*ppx = &x;               // but now this is an error because *ppx is 'const' 
```

`const`在 C++ 中，如果不使用某种类型转换，就不可能修改对象。您必须使用 C 样式转换或 C++ 样式`const_cast`来删除`const`-ness。任何其他这样做的尝试都会在某处导致编译器错误。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-24T19:13:18.583

回到时间的迷雾中，我们古程序员使用 FORTRAN。FORTRAN 通过引用传递它的所有参数，并且没有进行任何类型检查。这意味着即使是字面常量也很容易意外更改值。您可以将“3”传递给 SUBROUTINE，它会返回更改，因此从那时起，每次您的代码有“3”时，它实际上都会像不同的值一样。让我告诉你，这些是很难找到和修复的错误。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-24T18:58:18.383

你试过这个吗？

```
ptr = const_cast<int *>(ptr_to_a); 
```

这应该有助于它编译，但由于演员阵容，这并不是偶然的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-19T06:43:30.513

在 C++ 中，使用 Microsoft Visual Studio-2008

```
const int a = 3;    /* I promisse i won't change a */
int * ptr1  = const_cast<int*> (&a);
*ptr1 = 5;  /* I'm a liar, a is now 5 . It's not okay. */
cout << "a = " << a << "\n"; /* prints 3 */
int arr1[a]; /* arr1 is an array of 3 ints */

int temp = 2;
/* or, const volatile int temp = 2; */
const int b = temp + 1; /* I promisse i won't change b */
int * ptr2  = const_cast<int*> (&b);
*ptr2 = 5; /* I'm a liar, b is now 5 . It's okay. */
cout << "b = " << b << "\n"; /* prints 5 */
//int arr2[b]; /* Compilation error */ 
```

在 C 中，一个 const 变量可以通过它的指针来修改；然而，这是未定义的行为。const 变量永远不能用作数组声明中的长度。

在 C++ 中，如果一个 const 变量用纯常量表达式初始化，那么即使尝试修改，也不能通过其指针修改其值，否则可以通过其指针修改 const 变量。

如果其值大于 0，则纯整数 const 变量可用作数组声明中的长度。

纯常量表达式由以下操作数组成。

1.  数字文字（常量），例如 2, 10.53

2.  #define 指令定义的符号常量

3.  枚举常量

4.  纯 const 变量，即本身使用纯常量表达式初始化的 const 变量。

5.  不允许使用非常量变量或易失变量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T18:58:58.787

您可能想使用 const_cast：

```
int *ptr = const_cast<int*>(ptr_to_a); 
```

我不是 100% 确定这会起作用，但我对 C/C++ 有点生疏 :-)

一些关于 const_cast 的阅读：http: [//msdn.microsoft.com/en-us/library/bz6at95h (VS.80).aspx](http://msdn.microsoft.com/en-us/library/bz6at95h(VS.80).aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T19:10:33.440

```
const int foo = 42;
const int *pfoo = &foo;
const void *t = pfoo;
void *s = &t; // pointer to pointer to int
int **z = (int **)s; // pointer to int
**z = 0; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T19:24:06.543

您正在查看的文章可能一直在谈论两者之间的区别

```
const int *pciCantChangeTarget;
const int ci = 37;
pciCantChangeTarget = &ci; // works fine
*pciCantChangeTarget = 3; // compile error 
```

和

```
int nFirst = 1;
int const *cpiCantChangePointerValue = &nFirst;
int nSecond = 968;

*pciCantChangePointerValue = 402; // works
cpiCantChangePointerValue = &ci; // compile error 
```

或者我记得——我这里除了 Java 工具之外什么都没有，所以无法测试:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-24T20:35:30.647

其中一些答案指出，编译器可以优化变量 'a'，因为它是声明的`const`。如果您真的希望能够更改 的值，`a`则需要将其标记为`volatile`

```
 const volatile int a = 3; // I promise i won't change a
  int *ptr = (int *)&a;
  (*ptr) = 5; // I'm a liar, a is now 5 
```

当然，声明某事`const volatile`应该真正说明这是多么愚蠢。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-11-27T05:58:58.680

```
#include<iostream>
int main( void )
{
   int i = 3;    
   const int *pi = &i;
   int *pj = (int*)&i;
    *pj = 4;

   getchar(); 
   return 0;  
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-01-02T10:10:17.530

我正在研究如何在 const 之间进行转换，我发现这个[http://www.possibility.com/Cpp/const.html](http://www.possibility.com/Cpp/const.html)也许它对某人有用。:)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-11-18T09:07:36.320

我已经测试了下面的代码，它成功地更改了常量成员变量。

```
#include <iostream>

class A
{
    private:
        int * pc1;  // These must stay on the top of the constant member variables.
        int * pc2;  // Because, they must be initialized first
        int * pc3;  // in the constructor initialization list.
    public:
        A() : c1(0), c2(0), c3(0), v1(0), v2(0), v3(0) {}
        A(const A & other)
            :   pc1 (const_cast<int*>(&other.c1)),
                pc2 (const_cast<int*>(&other.c2)),
                pc3 (const_cast<int*>(&other.c3)),
                c1  (*pc1),
                c2  (*pc2),
                c3  (*pc3),
                v1  (other.v1),
                v2  (other.v2),
                v3  (other.v3)
        {
        }
        A(int c11, int c22, int c33, int v11, int v22, int v33) : c1(c11), c2(c22), c3(c33), v1(v11), v2(v22), v3(v33)
        {
        }
        const A & operator=(const A & Rhs)
        {
            pc1     =  const_cast<int*>(&c1);
            pc2     =  const_cast<int*>(&c2),
            pc3     =  const_cast<int*>(&c3),
            *pc1    = *const_cast<int*>(&Rhs.c1);
            *pc2    = *const_cast<int*>(&Rhs.c2);
            *pc3    = *const_cast<int*>(&Rhs.c3);
            v1      = Rhs.v1;
            v2      = Rhs.v2;
            v3      = Rhs.v3;
            return *this;
        }
        const int c1;
        const int c2;
        const int c3;
        int v1;
        int v2;
        int v3;
};

std::wostream & operator<<(std::wostream & os, const A & a)
{
    os << a.c1 << '\t' << a.c2 << '\t' << a.c3 << '\t' << a.v1 << '\t' << a.v2 << '\t' << a.v3 << std::endl;
    return os;
}

int wmain(int argc, wchar_t *argv[], wchar_t *envp[])
{
    A ObjA(10, 20, 30, 11, 22, 33);
    A ObjB(40, 50, 60, 44, 55, 66);
    A ObjC(70, 80, 90, 77, 88, 99);
    A ObjD(ObjA);
    ObjB = ObjC;
    std::wcout << ObjA << ObjB << ObjC << ObjD;

    system("pause");
    return 0;
} 
```

控制台输出为：

```
10      20      30      11      22      33
70      80      90      77      88      99
70      80      90      77      88      99
10      20      30      11      22      33
Press any key to continue . . . 
```

在这里，障碍是，您必须定义与您拥有的常量成员变量一样多的指针。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-04-12T20:18:28.053

这将产生运行时错误。因为**int**是**静态**的。未处理的异常。访问冲突写入位置 0x00035834。

```
void main(void)
{
    static const int x = 5;
    int *p = (int *)x;
    *p = 99;                //here it will trigger the fault at run time
} 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2013-03-11T10:43:53.080

我们可以通过以下代码更改 const 变量值：

```
const int x=5; 

printf("\nValue of x=%d",x);

*(int *)&x=7;

printf("\nNew value of x=%d",x); 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2018-09-15T07:25:07.667

```
#include<stdio.h>
#include<stdlib.h>

int main(void) {
    const int a = 1; //a is constant
    fprintf(stdout,"%d\n",a);//prints 1
    int* a_ptr = &a;
    *a_ptr = 4;//memory leak in c(value of a changed)
    fprintf(stdout,"%d",a);//prints 4
return 0;
} 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2019-07-26T11:27:25.303

最终解决方案：它会改变`const`变量的值；

```
cont int a = 10;
*(int*)&a= 5; // now a prints 5
// works fine. 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2009-02-24T19:12:16.027

您缺少的步骤是您不需要 int* 指针。该行：

```
const int *ptr_to_a = &a; // I still promiss i won't change a; 
```

实际上说你不会改变ptr_to_a，而不是a。因此，如果您将代码更改为如下所示：

```
const int a = 3; // I promise I won't change a
const int *ptr_to_a = &a; // I promise I won't change ptr_to_a, not a.

(*ptr_to_a) = 5; // a is now 5 
```

a 现在是 5。您可以通过 ptr_to_a 更改 a 而不会发出任何警告。

编辑：

以上是不正确的。事实证明，我将类似的技巧与 shared_ptr 混淆了，您可以在其中访问原始指针并修改内部数据值而不会触发任何警告。那是：

```
#include <iostream>
#include <boost/shared_ptr.hpp>

int main()
{
    const boost::shared_ptr<int>* a = new boost::shared_ptr<int>(new int(3));
    *(a->get()) = 5;
    std::cout << "A is: " << *(a->get()) << std::endl;

    return 0;
} 
```

将产生5。

# java - 从 Struts 到 Tapestry 5 的零碎转换

> ID：583078
> 
> 赞同：3
> 
> 时间：2009-02-24T18:55:27.487
> 
> 标签：java, jsp, frameworks, struts, tapestry

我有一个 Struts (1.3.8) 应用程序，我想将它转换为 Tapestry 5。可能没有时间一口气完成整个转换。我想在 Tapestry 中提供新功能，并在时间允许的情况下转换现有的 Struts / JSP。有没有人尝试过这样的事情？Struts 和 Tapestry 可以共存吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T05:21:21.273

如果您像大多数人那样使用 Struts，那么您可能拥有所有以 /action 开头或以 .do 结尾的 Struts url。正如 Shiny 和 New 先生所指出的，这意味着您可以使用 Tapestry 过滤器和 Struts 过滤器或 servlet 过滤不同的 URL。我都使用过，我强烈建议您尽量让 Tapestry 不必处理 Struts URL。使用 Struts，您几乎可以对 URL 进行手动编码，因此链接到 Tapestry 页面应该不是问题，但是如果您希望 Tapestry 链接回 Struts URL，您可能无法以标准方式使用它。理想情况下，您可以拆分应用程序的一部分（如内部管理功能）并让它们完全独立。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:13:44.463

在没有使用 Tapestry 的情况下，我会说任何两个框架都应该能够共存，因为在`web.xml`您定义 url 如何映射到 servlet/filters 时。例如，在 Wicket 中有一个过滤器，用于检查实现请求处理程序的 Wicket 类。如果没有匹配项，则请求将向上传递。这将允许您继续将 Struts 用于某些操作。

如果您想保留一些 URL，您可以更改 Struts 操作以转发到新的内部 URL；最终，你所有的 struts 动作本质上都是 url 重写动作，你可以去掉 struts 并用一个 url 重写过滤器替换它。

如果您的新 URL 都不会与旧 URL 冲突，那么没有什么难做的。只需设置新框架及其请求处理程序。当遇到一个 struts 动作 ( `/doSomething.do`) 时，Struts`ActionServlet`会将请求分派给该动作。您可以在其中`struts-config.xml`转发到正确的位置，无论是 JSP 还是 tile 或 Tapestry URL。我想在 Tapestry 中有一种方法可以在您处理完请求后转发到任意 url；如果需要，只需转发到 Struts 操作。

我可以预见的一个棘手问题是 Struts 和 Tapestry 是否对第三方库有冲突的要求。如果这不起作用，那么对于任何类型的简单迁移，您都可能会非常不走运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-22T09:57:41.050

我做过一次。我必须在两个框架的会话之间架起一座桥梁，因为它们为此使用了自己的常量/前缀。我们逐步从旧版应用程序切换到 T5 应用程序。我们只是使用 web.xml 将 struts 请求指向 struts，T5 请求将被 T5 过滤器拾取。我认为您甚至可以将 T5 过滤器配置为忽略某些 url。

我们还使用了 tukey URLRewrite 过滤器来控制单个请求是否通过，这样一来页面可能一天是 struts，下一天是 T5，并且 url 将保持不变（如果您的 struts 应用程序处于活动状态并且人们可能已经为它添加了书签，这很有用）

如果我发现任何问题，我将通读代码（我已将其存档）并回发更多信息。

祝你好运。

# linux - Gnome 桌面环境中的服务菜单

> ID：583093
> 
> 赞同：1
> 
> 时间：2009-02-24T19:00:30.237
> 
> 标签：linux, gnome, kde

有没有办法在 Gnome 上创建服务菜单？

在 kde 中，它只是一个放在 $HOME/.kde/share/kde4/services/ServiceMenus/ 中的 .desktop 文件

它在 Gnome 中是否存在类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T20:02:03.973

我不确定术语“服务菜单”在 KDE 领域是什么意思，但如果你想添加到 Gnome 的文件管理器 Nautilus 的上下文菜单中，那么这个链接可能是你正在寻找的：[http://www.linux .com/feature/119603](http://www.linux.com/feature/119603)

# jquery - 使用 jQuery 的可滚动表

> ID：583102
> 
> 赞同：3
> 
> 时间：2009-02-24T19:01:40.107
> 
> 标签：jquery, css, jquery-ui, jquery-plugins

有没有什么好的和轻量级的 jQuery 插件可以制作 Scrollable Tables。

我在[http://www.webtoolkit.info/scrollable-html-table-plugin-for-jquery.html](http://www.webtoolkit.info/scrollable-html-table-plugin-for-jquery.html)得到了一个，但这不适用于非 IE 和非 FF 浏览器。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T19:10:05.923

如果您正在寻找轻量级代码，请完全跳过 jQuery 并使用纯 HTML/CSS：

```
<table>
    <thead>
        <tr><th>Header Item 1</th><th>Header Item 2</th></tr>
    </thead>
    <tfoot>
        <tr><th>Footer Item 1</th><th>Footer Item 2</th></tr>
    </tfoot>
    <tbody style="overflow-y: scroll; overflow-x: hidden; height: 100px;">
        <tr><td>Item 1-1</td><td>Item 2-1</td></tr>
        ...
        <tr><td>Item 1-N</td><td>Item 2-N</td></tr>
    </tbody>
</table> 
```

关键是在 tbody 中设置溢出 CSS，以使该部分可滚动（但不是整个表格）。您还需要设置高度，以便定义可滚动部分的高度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-12T19:05:40.980

这是一个效果很好的方法：http: [//www.farinspace.com/jquery-scrollable-table-plugin/](http://www.farinspace.com/jquery-scrollable-table-plugin/)

既然上面提到了，这里有一个纯 HTML/CSS 跨浏览器解决方案： [http ://www.imaputz.com/cssStuff/bigFourVersion.html](http://www.imaputz.com/cssStuff/bigFourVersion.html)

# datetime - Struts2 时间 (HH:mm) 映射到动作字段

> ID：583107
> 
> 赞同：1
> 
> 时间：2009-02-24T19:03:09.730
> 
> 标签：datetime, struts2

我有一个简单的struts2：

```
<s:form ...>
<s:textfield name="initialTime" maxlength="5" size="5" />
</s:form> 
```

用户必须以 HH:mm 格式输入时间。在相应的动作中，我有一个属性：

```
private Date initialTime; 
```

连同它的getter/setter。

我遇到了一个验证问题，因为收到的初始时间（即 10:20）不被理解为有效日期。

检索时间的好方法是什么？我应该使用`private String initialTime`字段而不是 a`Date`吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T19:17:04.157

我认为您必须将属性更改为 String 并以编程方式将其转换为您想要的任何最终格式。虽然我可能会看到从 HH:mm 转换为 Date 可能有意义的情况，但我认为我们可以同意这不是一般情况。

./亚历克斯

# macros - 如何在低级别拦截和纠正按键？

> ID：583113
> 
> 赞同：3
> 
> 时间：2009-02-24T19:05:32.937
> 
> 标签：macros, autocorrect

我一直在输入“t eh”而不是“the”，这在我纠正自己所花费的时间上当然很烦人。

显而易见的答案是“学打字，菜鸟！” 或至少打字更慢和/或更正确。这个错误惊人地一致，所以看来我已经针对这种模式训练了我的肌肉记忆。

*但*我想知道是否有可能编写一个小型的 Windows 可移植脚本或应用程序，当它检测到不正确的序列时，退格并在适用于任何键盘输入的层自动更正它。

*   C# 是否可以访问在系统范围内拦截按键的操作系统层？
*   我会在 Vista 中遇到 UAC 问题吗？
*   我是否在重新发明轮子（即，是否有我可以修改或开箱即用的开源工具）？

在 DOS 中，这类事情非常简单，可以制作 TSR（终止和驻留）程序，例如，在屏幕上为您提供一个带有特殊按键的计算器。更不用说基于这个概念的许多恶作剧程序（拨“M”代表怪物！）......

当然，我*绝不*会建议这样的实用程序可以以这种方式用于同事......

-亚当

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T19:18:07.557

在 Windows 上，您可以使用 AutoHotKey。这使您可以创建小脚本或宏来自动化和纠正诸如错误输入之类的事情。

在 lifehacker 上发布了一种用途，该用途采用了常见的错误输入单词并进行了更正。它位于[http://lifehacker.com/192506/download-of-the-day-universal-autocorrect](http://lifehacker.com/192506/download-of-the-day-universal-autocorrect)

* * *

更新每条评论：据我所知，这是免费软件和 Windows。

上面的脚本只是它可以做什么的一个例子。[AutoHotkeys](http://www.autohotkey.com/wiki/index.php?title=Script_Listing)网站上有大量可用的脚本

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T19:23:42.707

我建议使用 AutoHotKey。如果您以前从未使用过它，请快速阅读本教程：[http ://www.autohotkey.com/docs/Tutorial.htm](http://www.autohotkey.com/docs/Tutorial.htm)

您正在寻找的功能称为“热字串”。[http://www.autohotkey.com/docs/Hotstrings.htm](http://www.autohotkey.com/docs/Hotstrings.htm)

在您的情况下，您的脚本将类似于：

```
::teh::the 
```

就是这样！在其他行上添加您想要更正的其他内容。可以编译 AutoHotkey 脚本，因此您不必在所有机器上都安装 AutoHotKey。

这是一个非常酷的程序。它的主要用途（用于制作自定义热键）岩石！这些脚本是系统范围的，因此您可能还需要创建一个热键来关闭它们！

编辑：在评论中，有人提到他实际上输入了“t eh”（其中有一个空格），我想知道是否需要额外的东西才能让它工作。我刚刚测试了它，它工作正常。只需安装 autohotkey，然后创建一个扩展名为 .AHK 的文件。在该文件中放入以下行

```
::t eh::the 
```

并保存文件。然后双击 AHK 文件以使用您的脚本加载 AutoHotKey（您将在系统托盘中看到一个绿色方块，让您知道它正在运行）。它应该工作正常！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T19:41:17.423

是的，您可以使用 C# 中的 pinvoke 命令来拦截低级 os 命令。我建议你看看[http://www.pinvoke.net](http://www.pinvoke.net)。编码并不容易，但它确实有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T01:08:08.307

我建议学习更慢地打字。我还患有“teh”和“ahve”，部分原因是自动更正给了我宽大处理。如果你强迫自己重新训练，那么在使用别人的机器时你不会处于劣势。

更不用说当你需要写“t eh”并且被过分热心的“纠正者”阻止时发生的不幸事件。

# asp.net - 使用 jQuery 调用 ASP.NET PageMethod/WebMethod - 返回整个页面

> ID：583116
> 
> 赞同：37
> 
> 时间：2009-02-24T19:06:09.643
> 
> 标签：asp.net, jquery, web-services, asmx, pagemethods

jQuery 1.3.2，ASP.NET 2.0。对 PageMethod (WebMethod) 进行 AJAX 调用会返回完整/整个页面，而不仅仅是响应。page 方法上的断点表明它永远不会被命中。我的方法上有 [WebMethod] 属性，它*是*公共静态的，返回字符串并且不接受任何参数。我什至尝试在我的班级顶部添加 [ScriptService] 以查看它是否有帮助，但它没有。

我已经看到这篇文章[Jquery AJAX with ASP.NET WebMethod Returning Entire Page](https://stackoverflow.com/questions/348689/jquery-ajax-with-asp-net-webmethod-returning-entire-page)有我相同的症状，但我仍然遇到问题。我读了[http://encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/](http://encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/)，我觉得我正在关注 T，但仍然没有运气。

我正在进行的 jQuery 调用是：

```
jQuery.ajax({
    type: 'POST',
    contentType: 'application/json; charset=utf-8',
    data: '{}',
    dataType: 'json',
    url: 'MyPage.aspx/SomePageMethod',
    success: function(result){
        alert(result);
    }
}); 
```

根据 FF3 中的 Firebug，请求/响应标头如下

```
Response Headers
Server  ASP.NET Development Server/8.0.0.0
Date    Tue, 24 Feb 2009 18:58:27 GMT
X-AspNet-Version    2.0.50727
Cache-Control   private
Content-Type    text/html; charset=utf-8
Content-Length  108558
Connection  Close

Request Headers 
Host    localhost:2624
User-Agent  Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.6) Gecko/2009011913 Firefox/3.0.6
Accept  application/json, text/javascript, */*
Accept-Language en-us,en;q=0.5
Accept-Encoding gzip,deflate
Accept-Charset  ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive  300
Connection  keep-alive
Content-Type    application/json; charset=utf-8
X-Requested-With XMLHttpRequest
Referer http://localhost:2624/MyApp/MyPage.aspx
Content-Length  2
Cookie  ASP.NET_SessionId=g1idhx55b5awyi55fvorj055; 
```

我在我的页面中添加了一个 ScriptManager 只是为了看看它是否有帮助，但那里没有运气。

有什么建议么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-24T19:22:18.060

你知道页面方法工作正常吗？如果您使用 ScriptManager，它们会起作用吗？

听起来您可能缺少[web.config 条目](http://www.asp.net/AJAX/Documentation/Live/ConfiguringASPNETAJAX.aspx)。特别是 HttpModules 部分。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-15T17:25:11.747

我的 web.config 中缺少一行：

```
<system.web>
  <httpModules>
    <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
  </httpModules>
</system.web> 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-06-16T14:26:37.363

我今天又遇到了这个问题，原因不同：我把“应用程序”拼错了

```
contentType: 'application/json' 
```

并且获得了整页响应，而不是对 WebMethod 的调用。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-08-08T18:28:00.457

如果您已经尝试了所有这些并且仍然从您的页面方法返回整个页面，您可能需要确保您没有使用友好的 url。如果你正在使用它们，这个技巧可能会帮助你

在调用之前在你的 js 脚本中添加这一行：

```
PageMethods.set_path(PageMethods.get_path() + '.aspx'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-15T05:58:00.233

把它扔在这里作为旁注。由于我的 HTML 字符串中的字符串变量的长度以及我用来调用我的 ajax 的网站看起来像这样，我收到了这个错误。

```
loc = (loc.substr(loc.length - 1, 1) == "/") ? loc + "Default.aspx" : loc;
        $.ajax({
            type: "POST",
            url: loc + "/" + methodName,
            data: "{" + args + "}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: onSuccess,
            error: onFail
        }); 
```

它无法正确提取 .aspx 链接，所以我只是硬编码了我的网页，而不是使用 loc var。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-04-10T15:27:11.993

在 RouteConfig.cs 中评论以下行对我有用

```
 settings.AutoRedirectMode = RedirectMode.Permanent; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T07:16:25.020

我见过的大多数 ajax 场景确实应该调用 Web 服务或单独的脚本处理程序，而不是页面。这在 .net 3-5 中非常容易做到，而在 2-0 中则不那么容易。即使在您弄清楚（如果）如何不加载整个页面之后，以下是不调用页面方法的原因：

1) page 方法加载的内容可能比整个页面加载少，但仍然远远超过简单的 ajax 调用所需的内容。2) 糟糕的职责分离。该页面可能负责很好地布置内容，而不是您在 ajax 方法中使用的逻辑。
3）也许您需要一些会话状态，但这应该仍然可用。

我目前正在更新我对这个主题的知识......我会在这个帖子中寻找这个问题的一个很好的答案，或者我会在下周发布一个。这是我前进的方向

1）从服务器发送 JSON 到客户端，并使用 javascript 更新您的页面。- 多种框架使从 Web 服务器生成 JSON 变得容易。
2) JQuery 使 ajax 调用、json 处理和客户端格式化变得有趣，而不是痛苦。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-29T17:47:41.223

经过近两个小时的尝试，我终于解决了所有问题。@Marvin Zumbado 的评论帮助了我。我的网址中缺少 .aspx。我知道这不是我作为程序员的最佳时刻！

# java - 设置 JFreeChart / Cewolf X 轴间隔

> ID：583118
> 
> 赞同：0
> 
> 时间：2009-02-24T19:06:47.817
> 
> 标签：java, charts, jfreechart, cewolf

我正在尝试在每分钟都有数据的网络应用程序上显示一些图表。问题是当我尝试查看一个小时的数据（默认）时，您只会看到一堆哈希标记。有没有办法设置间隔，以便它自动发送 5 个显示日期时间的标记（YYYY-MM-DD HH:MM:SS）。

当前的：

[http://img255.imageshack.us/my.php?image=minutes.jpg](http://img255.imageshack.us/my.php?image=minutes.jpg)

示例 X 轴间隔：（有 60 分钟或更长时间，但间隔只有 5 个日期时间标签）

[http://img22.imageshack.us/my.php?image=newminutes.jpg](http://img22.imageshack.us/my.php?image=newminutes.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T20:48:30.430

我不确定，但您可以尝试从绘图中获取 DomainAxis 并将其转换为 DateAxis（假设这对于您的应用程序是正确的）。然后将 tickUnit 属性设置为适当的值。也许这至少会为您指明正确的方向。祝你好运！

# web-applications - 发布一个只支持三种浏览器的网络应用程序是不明智的吗？

> ID：583121
> 
> 赞同：1
> 
> 时间：2009-02-24T19:08:01.013
> 
> 标签：web-applications, cross-browser

*一些背景资料*

我们针对两种最流行的符合标准的浏览器（Firefox 3 和 Safari 3）开发了该应用程序，然后对 IE 7 进行了必要的修复

我们使用了 HTML 4.01 Strict DOCTYPE

Firefox 3、Safari 3 和 IE 7 将覆盖我们 85% 的目标受众 - 根据 Urchin 在一次简短的 AdWords 活动中的统计数据

展望未来，我们显然会计划支持 Chrome 和 IE 8

财务限制排除了进一步的测试，我们唯一的其他选择是根本不发布。

那么释放和被诅咒更好吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-24T19:11:00.537

> 那么释放和被诅咒更好吗？

比……什么好？根本不发布？当然是。如果财务限制阻止您在其他平台上进行测试，听起来您可以选择将其发布到那里和完全废弃它——我每次都会选择前者。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T19:19:34.980

就发货吧。

您使用 3 种不同的渲染引擎进行了测试。其他浏览器没有任何问题的可能性很高。

可以添加[ie7-js](http://code.google.com/p/ie7-js/)来满足IE6。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T19:16:28.433

如果您已经针对最新版本的 Firefox 和 Safari 进行了开发和测试，我会说您将免费获得许多其他浏览器。Web 标准的奇迹意味着 Opera、Camino 和其他符合标准的渲染引擎都应该在几乎没有工作的情况下就位。

唯一明显的缺失部分是 IE6。你可以很聪明地知道你给它的支持水平。事情不必在该浏览器上运行与在其他浏览器上完全相同。甚至可能给它发送一个更简单的样式表，或者根本没有样式表。当然不要将该浏览器的用户锁定在您的网站之外。

[http://en.wikipedia.org/wiki/Progressive_enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement)是一件好事。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T19:12:05.543

我会说这在很大程度上取决于您的目标人群。由于 85% 的目标受众应该取得成功，因此听起来您的处境还不错。

我不清楚你的其他选择是什么。由于财务限制，您无法再进行测试...所以大概出于同样的原因您不能再编码...所以除了“继续努力”之外，您真的还有其他选择吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T19:21:15.317

**释放它！**

然后使用**谷歌分析**查看您的访问者真正使用的浏览器

如果您当前不支持的浏览器实际上被您的用户普遍使用，**那么您应该尝试适应它**，否则人们可能会由于导航等**问题而离开网站。**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T19:11:57.133

您可以随时添加旧的“此页面旨在在 -> 在此处下载浏览器 <- 下正确查看”

好吧，如果它涵盖了 85% 的观众，我认为将来发布和更新兼容性应该是可以的

敏捷开发

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T19:39:32.980

释放释放！！！

我的一个非常好的朋友让我想起了拿破仑的一句话“如果你要去维也纳，就去维也纳”

缺少基于新的或不/兼容的浏览器的边缘组是采取维也纳的糟糕方式！

正如我的同一个朋友不断提醒我一些我自己的项目......你只需要人们使用它......他们会帮助找到并解决它的任何问题......我保证！

[;o)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T19:15:14.117

你怎么知道你会错过 15% 的观众？我确信这是基于市场研究的估计，可能并不代表全部真相。事实上，您可能会启动并发现您只丢失了 5%。

我会启动它，然后跟踪试图访问该站点的浏览器。而是根据该信息调整您的努力。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T19:23:49.087

这取决于谁在使用您的应用程序。如果它是针对老年人的草坪保龄球模拟器，您可能会遇到问题，但无论如何都要启动。（有什么可能的原因根本不启动？）如果您的受众也使用 Lifehacker 和 Digg 之类的网站（他们不是程序员，但对技术有一定了解），您可能会发现其中一小部分使用 IE

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-12T15:00:18.790

释放！

[花 10 分钟时间通过像browsershots](http://browsershots.org/)这样的免费检查器运行您的页面有多难？这样，如果有什么严重错误，至少您对分析报告中出现的那些“边缘”15% 浏览器类型会看到什么有所了解，并且可以更好地估计“修复”问题需要哪些资源。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-01-12T15:04:13.103

释放！

您可以添加 IE8 兼容性元标记以使其呈现为 IE7。

`<meta http-equiv="X-UA-Compatible" content="IE=7" />`

Chrome 像 Safari 一样基于 WebKit（尽管版本不同），所以它应该不会有太多问题。

# c++ - VCRedist - 我如何判断它是否已运行？

> ID：583122
> 
> 赞同：2
> 
> 时间：2009-02-24T19:08:05.443
> 
> 标签：c++

我有一个旧的，旧的 VC++ 应用程序，我们已经移植到 VS2005。我们现有的用户需要获取 VC++2005 DLL，所以我的应用程序将 vcredist_x86.exe 放在他们的机器上并运行它。我检查了 HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\SideBySide\Installations\ 下的注册表项，它是 x86_Microsoft.VC80.MFC blah blah 8.0.50727.762 blah blah... 但是... 似乎这在远景。检查以确保 vcredist 运行完成的正确条目是什么，这样我就不必再次运行它？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T19:15:45.423

尽管您可以在`winsxs`用户的​​文件夹中查找`windir`正确的文件夹和文件，但我从未找到任何明确的信息。

我已经让我们的应用程序的安装程序在安装时安静地运行它，如果它已经存在就不会造成任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T20:18:52.013

保持简单：只需将 redist 设置作为批处理文件的一部分运行，该批处理文件在完成时会写入一些注册表值（这样您就可以检查而不是运行两次）或将一些文件写入已知位置。

确实，如果您的用户在过去某个时候自己运行 vcredist，那么您的第一次安装将是多余的，但我想它不会真正受到伤害，也没什么大不了的。

除此之外（我意识到它并不漂亮）我怀疑你必须检查 2005 redist 包中的每个文件是否都在那里（没有被任何机会删除或损坏），这几乎是什么无论如何，redist 设置都应该这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T19:24:48.740

> 所以我的应用程序将 vcredist_x86.exe 放在他们的机器上并运行它。

这是一种非常不规则的做法。
通常并行包会自动添加到“检测到的依赖项”下的安装程序对象的依赖项中

# multithreading - 这是双重检查锁定的安全版本吗？

> ID：583123
> 
> 赞同：1
> 
> 时间：2009-02-24T19:08:18.797
> 
> 标签：multithreading, language-agnostic, locking, atomic

来自维基百科的规范破坏双重检查锁定的略微修改版本：

```
class Foo {
    private Helper helper = null;
    public Helper getHelper() {
        if (helper == null) {
            synchronized(this) {
                if (helper == null) {

                    // Create new Helper instance and store reference on
                    // stack so other threads can't see it.
                    Helper myHelper = new Helper();

                    // Atomically publish this instance.
                    atomicSet(helper, myHelper);
                }
            }
        }
        return helper;
    }
} 
```

假设底层原子操作库正常工作，是否简单地使新创建的 Helper 实例原子的发布使这个双重检查锁定习语安全？我意识到在 Java 中，可以只使用`volatile`，但即使该示例是伪 Java 中的，这也应该是一个与语言无关的问题。

**也可以看看：**

[双重检查锁定文章](https://stackoverflow.com/questions/157198/double-checked-locking-article)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-24T19:21:51.387

这完全取决于您的平台/语言的*确切*内存模型。

我的经验法则：*不要这样做*。无锁（或减少锁，在这种情况下）编程很*困难*，除非您是线程忍者，否则不应尝试。您甚至应该仅在获得性能分析证明您确实需要它时才*考虑它，在这种情况下，您可以获得关于**该特定平台*的线程的绝对最佳和最新的书籍，看看它是否可以帮助您。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T19:14:26.207

我不认为你可以在不完全脱离代码的情况下以与语言无关的方式回答这个问题。这完全取决于您的伪代码的方式`synchronized`和`atomicSet`工作方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T19:23:08.153

答案取决于语言 - 它归结为`atomicSet()`.

如果 myHelper 的构造可以在之后展开，`atomicSet()`那么如何将变量分配给共享状态并不重要。

IE

```
// Create new Helper instance and store reference on
// stack so other threads can't see it.
Helper myHelper = new Helper(); // ALLOCATE MEMORY HERE BUT DON'T INITIALISE

// Atomically publish this instance.
atomicSet(helper, myHelper); // ATOMICALLY POINT UNINITIALISED MEMORY from helper

// other thread gets run at this time and tries to use helper object 

// AT THE PROGRAMS LEISURE INITIALISE Helper object. 
```

如果语言允许这样做，那么双重检查将不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T19:22:29.027

使用 volatile 不会阻止多个实例化 - 但是使用 synchronize 会阻止创建多个实例。但是，对于您的代码，可能会在设置之前返回助手（线程'A'实例化它，但在设置线程'B'出现之前，助手是非空的，因此立即返回它。修复那个问题，去掉第一个 if (helper == null)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T19:25:27.150

很可能它被破坏了，因为部分构造的对象的问题没有得到解决。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T22:12:34.697

**对于所有担心部分构造对象的人：**

据我了解，部分构造对象的问题*只是*构造函数内部的问题。换句话说，在构造函数中，如果一个对象引用了自己（包括它的子类）或其成员，那么部分构造可能会出现问题。否则，当构造函数返回时，该类已完全构造。

我认为您将部分构造与编译器如何优化写入的不同问题混淆了。编译器可以选择 A) 为新的 Helper 对象分配内存，B) 将地址写入 myHelper（本地堆栈变量），然后 C) 调用任何构造函数初始化。在 B 点之后和 C 点之前的任何时候，访问 myHelper 都是一个问题。

引用的论文关注的是这种编译器的写入优化，而不是部分构造。在原来的单检查锁方案中，优化写入可以让多个线程看到B点和C点之间的成员变量。这种实现通过使用局部堆栈变量来避免写入优化问题。

引用论文的主要范围是描述双重检查锁解决方案的各种问题。但是，除非 atomicSet 方法也与 Foo 类同步，否则此解决方案不是双重检查锁定解决方案。它正在使用多个锁。

我想说这一切都归结为原子分配函数的实现。该函数需要是真正原子的，它需要保证处理器本地内存缓存是同步的，并且它需要以比简单地始终同步 getHelper 方法更低的成本来完成所有这些工作。

根据引用的论文，Java 不太可能满足所有这些要求。此外，论文中应该非常清楚的一点是 Java 的内存模型经常变化。它随着对缓存、垃圾收集等的更好理解的发展而适应，并适应虚拟机运行的底层真实处理器架构的变化。

根据经验，如果您以依赖于底层实现而不是 API 的方式优化 Java 代码，那么您将面临在 JVM 的下一个版本中出现代码损坏的风险。（虽然，有时你别无选择。）

* * *

**dsimcha：**

如果您的 atomicSet 方法是真实的，那么我会尝试将您的问题发送给 Doug Lea（连同您的 atomicSet 实现）。我感觉他是那种会回答的人。我猜想对于 Java，他会告诉您始终同步并在其他地方进行优化会更便宜。

# c# - 我的 SQLParameter 没有正确传递 NULL

> ID：583138
> 
> 赞同：1
> 
> 时间：2009-02-24T19:13:02.297
> 
> 标签：c#, .net, sql, .net-2.0, query-parameters

我有这个 C# 网络表单，它有一个日期选择器框。如果日期设置为空（默认值），我希望它将 NULL 传递给数据库。这发生在我的参数化查询中。

```
SqlParameter CMActionDate = new SqlParameter();
CMActionDate.ParameterName = "@ActionDate";
if (ActionDate.Equals(""))
  {
      CMActionDate.Value = System.Data.SqlTypes.SqlDateTime.Null;
  }
  else
  {
      CMActionDate.Value = ActionDate;
  } 
```

当我打开调试时，我看到日期确实是“”，所以它进入 IF 语句并将 actiondate.value 设置为 {Null}，就像我认为的那样。

然而。

然后当它执行非查询时，我单击放大镜并看到：

```
UPDATE table SET [action_date] = '' WHERE [id] = 2488 
```

我想看到的是：

```
UPDATE table SET [action_date] = 'Null' WHERE [id] = 2488 
```

由于 action_date 从未真正设置为 NULL，因此 datetime 字段中的值将恢复为“01/01/1900 12:00:00AM”，这本身就是一种痛苦。

我尝试将 CMActionDate.Value 设置为以下值无济于事（我得到与上面相同的结果。）：

*   DBNull.值；
*   “空值”;
*   SqlDateTime.Null;
*   空值;

帮助。

**编辑**

可能我没说清楚？是的，参数化查询当然是这样的：

```
"UPDATE CM_Codebase SET [action_date] = '" + @ActionDate + "' WHERE [id] = " + @CM_id + ""; 
```

但是当我在 VS 中调试这个东西时，我在 ExecuteNonQuery(); 之前放了一个断点。所以我可以看到它试图运行的 SQL。在那里我看到了实际的 SQL，并看到了 action_date='' 的位置。

这有帮助吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-24T19:22:53.567

您不应该看到“”或“空”。如果您正确使用参数化查询，它应该如下所示：

> 更新表 SET [action_date] = @ActionDate WHERE [id] = @ID

参数化查询的*重点*是实际参数值*永远不会*直接替换到查询字符串中。

您的查询代码应如下所示：

```
string sql = "UPDATE table SET [action_date]= @ActionDate WHERE [id]= @CM_id";

using (var cn = new SqlConnection("your connection string here."))
using (var cmd = new SqlCommand(sql, cn))
{
    cmd.Parameters.Add("@ActionDate", SqlDbTypes.DateTime).Value = 
         ActionDate.Equals("")? DBNull.Value : DateTime.Parse(ActionDate);
    cmd.Parameters.Add("@CM_id", SqlDbTypes.Int).Value = 2488;

    cn.Open();
    cmd.ExecuteNonQuery();
} 
```

此代码的结果是您的查询参数作为数据发送到服务器。在您的 C# 代码中，您永远无法查看替换数据的查询字符串：它是单独发送到服务器的。

这可以防止服务器由于清理参数值时出错而将参数值作为代码执行的任何可能性。数据是完全独立的，不需要首先针对该上下文进行清理。它还允许服务器缓存和重用查询的执行计划，从而带来（小的）性能提升。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:24:40.927

您的参数化查询应显示

```
UPDATE table SET [action_date] = @ActionDate WHERE [id] = @id 
```

并且参数值应该有一个空等效值。

你的 sql 是

```
"UPDATE CM_Codebase SET [action_date] = '" + @ActionDate + "' 
 WHERE [id] = " + @CM_id + ""; 
```

这真的没有意义。您应该让 sql 替换 @ActionDate 和 @CM_ID，而不是构建动态 sql 查询。

你的 sql 应该是：

```
String sql = "UPDATE table SET [action_date] = @ActionDate WHERE [id] = @CM_id" 
```

变量周围不应该有字符串连接，也不应该用引号引起来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T19:51:40.767

您的查询肯定与发布的查询不同。

您的 @parameter 需要在您的字符串中，以便正确读取。您看到 ActionDate = '' 因为 @ActionDate 很可能不存在。

你需要类似的东西

```
string sql = "UPDATE CM_Codebase SET [action_date] = @ActionDate WHERE [id] = @CM_id"; 
```

请注意，没有发生字符串连接。

# java - 如何在 Windows（非 Java）应用程序中使用 Java 时区 ID？

> ID：583141
> 
> 赞同：4
> 
> 时间：2009-02-24T19:14:06.410
> 
> 标签：java, windows, oracle, timezone

我需要将时区信息添加到具有用户维护位置的数据库表中。数据将主要从 Java 代码访问，但也有一些 PL/SQL 和 Win32 (Delphi) 代码需要了解时区信息。

使用 java.util.TimeZone 中的 id 似乎很简单。Java 可以很容易地转换它（显然），Hibernate 内置了对它的支持，而且显然 Oracle 也理解这些时区 ID：

```
select TZ_OFFSET('Pacific/Marquesas') from dual. 
```

问题是：时区 ID 似乎与 Windows 时区数据库不兼容。例如，java.util.timezone id "Pacific/Marquesas" (-09:30) 不在 Windows 的时区选项列表中。注册表根本不包含它；看

```
\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones
```

在这里，我只能选择 -09:00 或 -10:00。那么，如果我要像这样存储时区，我怎样才能获得 Windows 中的实际偏移/DST 信息（没有 Java）？希望这不需要一个映射表，每当它发生变化时我都必须保持最新。是否有比 java 时区 id 更好的全球公认标准？

**更新**

时区信息与数据库上的 DATE 列结合使用。这些列包含本地日期/时间值。如果某个位置可以与这些值相关联，则该位置的时区使我能够在需要时将日期/时间值转换为 UTC 或任何其他时区。

我意识到代替 DATE TIMESTAMP_TZ 数据类型或类似的东西会更合适。但是，这将需要数据迁移（为此再次需要 TZ），并且也适用于数据的遗留应用程序不支持（除非更改了大量代码）。如果我必须将值转换为 UTC，问题几乎相同。

底线是我需要将 DATE 值保留在本地时间，但我需要知道其中一些 TZ 意味着什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T19:22:33.053

如果不是真正的答案，我可以提供一点背景。

许多系统使用时区数据的[Olson](http://en.wikipedia.org/wiki/Zoneinfo)实现。所以这些名字适用于许多系统（我认为大多数 Unix、Java、Oracle）。微软做自己的事情。

我在该 Wikipedia 链接的底部看到了对 Windows 世界的一些映射的引用。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T20:09:38.743

我意识到这不是最好的方法，但在你的情况下可能就足够了。在不知道所有要求的情况下，我无法分辨。

您需要使用时区信息做什么？只是用正确的偏移量显示时间，也许还有时区的名称？

您可以继续使用 Java 来确定用户的偏移量，方法是使用 Java 查找用户选择的时区。每次用户登录时，都会在您的数据库中记录当前的偏移量。然后其他应用程序可以查看此信息以确定如何格式化时间。

这假设定期登录的用户是需要这样做的用户。如果不是这种情况，您可以运行每日作业以在 Java 中查找每个用户的时区并记录当前有效的偏移量。

Hackish，同意，但我看到的唯一其他方法是维护映射。当有人选择您没有映射的时区时会发生什么？

# visual-studio-2008 - 在单元测试时如何让#if 条件起作用？

> ID：583151
> 
> 赞同：0
> 
> 时间：2009-02-24T19:17:15.220
> 
> 标签：visual-studio-2008, unit-testing, nunit, conditional, if-statement

这就是我希望能够做到的。

```
/// <summary>
        /// Gets the session factory.
        /// </summary>
        /// <value>The session factory.</value>
        public ISessionFactory SessionFactory
        {
            get
            {
                if (_sessionFactory == null)
                {
#if(NUNIT)
                     _sessionFactory = Fluently.Configure()
                        .Database(SQLiteConfiguration.Standard
                                      .UsingFile(DbFile)
                                      .ShowSql())
                        .Mappings(m =>
                                  m.FluentMappings.AddFromAssemblyOf<ForeignFormat>())
                        .ExposeConfiguration(BuildSchema)
                        .BuildSessionFactory();

#else
                    _sessionFactory = Fluently.Configure()
                .Database(MsSqlConfiguration.MsSql2005
                              .ConnectionString(c => c
                                                         .Server(".\\sqlexpress")
                                                         .Database("mPort")
                                                         .TrustedConnection())
                                                         .ShowSql()
                                               )

                .Mappings(m => m
                                   .FluentMappings.AddFromAssemblyOf<ForeignFormat>())
                .BuildSessionFactory();
#endif
                }
                return _sessionFactory;

            }
        } 
```

如果您正在运行单元测试，是否可以 #if 条件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T19:43:17.323

[#if](http://msdn.microsoft.com/en-us/library/4y6tbswk.aspx)是一个编译器指令，因此当您要运行测试与要“真正”运行它时，您需要以不同的方式编译代码。您可以在项目的构建设置中定义编译器标志来执行此操作。

***但是***，我同意其他所有建议这不是一个好方法的人的观点。除了人们提到的其他问题之外，当您想要在运行单元测试和运行真实应用程序之间切换时，不断地重新编译会很痛苦。

依赖注入或模拟会更好地为您服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:34:48.797

我建议模拟数据库连接，而不是在你的代码中乱扔#if/#else（即使它只在这个地方）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T19:34:00.310

我不会推荐这种方法进行单元测试。您永远不应该将“测试”代码放入生产文件中。

您应该研究模拟对象以从您的`BuildSessionFactory`方法中获得所需的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T19:35:45.283

您不应使用 #if 部分将测试代码与生产代码分开。您想要（并且需要）测试生产代码。

使数据库的类型/配置可配置可能更有意义。依赖注入是执行此操作的一种方法，您似乎正在使用的城堡框架旨在轻松执行此操作。

依赖注入是一种将您发布的代码与数据库的实际实现分离的技术。这意味着您可以在测试期间注入文件或完全伪造的数据库类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T19:53:07.223

除了 SessionFactory 之外，为什么不在单元测试中创建 FakeSessionFactory ？

在单元测试中，您向您的客户端类传递一个 FakeSessionFactory 实例，并在您的应用程序中，为他提供一个 SessionFactory 以便它真正访问数据库。

```
 public ISessionFactory SessionFactory
        {
            get
            {
                if (_sessionFactory == null)
                {
                    _sessionFactory = Fluently.Configure()
                .Database(MsSqlConfiguration.MsSql2005
                              .ConnectionString(c => c
                                                         .Server(".\\sqlexpress")
                                                         .Database("mPort")
                                                         .TrustedConnection())
                                                         .ShowSql()
                                               )

                .Mappings(m => m
                                   .FluentMappings.AddFromAssemblyOf<ForeignFormat>())
                .BuildSessionFactory();
                }
                return _sessionFactory;
            }
        }

        public ISessionFactory FakeSessionFactory
        {
            get
            {
                if (_sessionFactory == null)
                {
                     _sessionFactory = Fluently.Configure()
                        .Database(SQLiteConfiguration.Standard
                                      .UsingFile(DbFile)
                                      .ShowSql())
                        .Mappings(m =>
                                  m.FluentMappings.AddFromAssemblyOf<ForeignFormat>())
                        .ExposeConfiguration(BuildSchema)
                        .BuildSessionFactory();

                }
                return _sessionFactory;
            }
        } 
```

# php - 网站查询，php

> ID：583154
> 
> 赞同：-1
> 
> 时间：2009-02-24T19:18:27.837
> 
> 标签：php

如何使用 php 查询具有某些字段的特定网站并在我的网页中获取结果？

如果你给他们邮政编码，假设网站 xyz.com 会给你城市的名称。我怎样才能在 php 中轻松实现这一点？任何代码快照都会很棒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T19:24:34.047

如果我理解您的意思（您想向站点提交查询并获取结果以进行处理等？），您可以使用[cURL](http://php.net/curl)。

这是一个[例子](http://php.net/manual/en/curl.examples-basic.php)：

```
<?php 
    // create curl resource 
    $ch = curl_init(); 

    // set url 
    curl_setopt($ch, CURLOPT_URL, "example.com"); 

    //return the transfer as a string 
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 

    // $output contains the output string 
    $output = curl_exec($ch); 

    // close curl resource to free up system resources 
    curl_close($ch);
?> 
```

您可以使用如下的正则表达式从[该站点](http://www.ip-adress.com/ip_tracer/)获取纬度/经度：

```
if ( preg_match_all( "#<td>\s+-?(\d+\.\d+)\s+</td>#", $output, $coords ) ) {
    list( $lat, $long ) = $coords[1];
    echo "Latitude: $lat\nLongitude: $long\n";
} 
```

把它放在 curl_close() 函数之后。这将返回如下内容（数字已更改）：

```
Latitude: 53.5100
Longitude: 60.2200 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T19:30:40.443

您可以使用 file_get_contents （和其他类似的 fopen 类函数）来执行此操作：

```
$result = file_get_contents("http://other-site.com/query?variable=value"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T19:20:12.963

你的意思是这样的：

包括“ [http://www.google.com?q=myquery](http://www.google.com?q=myquery) ”；? 或者你想得到哪些字段？

你能更具体一点吗:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T19:25:23.793

如果您想将 html 导入您的页面并对其进行分析，您可能需要使用 cURL。您必须将扩展加载到您的页面（它通常是 PHP 的一部分 _ 我认为它必须被编译？手册可以回答这个问题）

这是一个卷曲功能。设置您的网址，例如

$param='弗里比';

$param2='snips';

$url="www.example.com?data=$param&data2=$param2";

函数 curl_page($url) { $response =false; $ch = curl_init($url); curl_setopt($ch,CURLOPT_RETURNTRANSFER,true); curl_setopt($ch,CURLOPT_FAILONERROR,true); curl_setopt($ch,CURLOPT_FOLLOWLOCATION,1); curl_setopt($ch,CURLOPT_TIMEOUT,30); $response = curl_exec($ch); curl_close($ch); 返回$响应；}

$page_data=curl_page($url);

然后，您可以使用 DOM 解析或 grep/sed/awk 类型的东西从页面中获取数据。

# php - 在 PHP 中将对象转换为整数

> ID：583157
> 
> 赞同：4
> 
> 时间：2009-02-24T19:19:40.517
> 
> 标签：php, types

*   $total_results 的值 = 10
*   $total_results 在一个对象中，根据 gettype()
*   我不能在 $total_results 上使用数学运算符，因为它不是数字
*   尝试 $total_results = intval($total_results) 转换为整数，但没有运气
*   我得到的通知是： Zend_Gdata_Extension_OpenSearchTotalResults 类的对象无法转换为 int

如何转换为整数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T19:22:37.843

这行得通吗？

```
$val = intval($total_results->getText()); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T19:21:58.483

```
$results_numeric = (int) $total_results; 
```

或者这个：

```
$results_numeric = $total_results->count(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T19:23:08.760

也许该对象有一个内置方法可以将其作为整数获取？

否则尝试这种非常hacky的方法（依靠 __toString() 返回那个 10）

```
$total_results = $total_results->__toString();
$total_results = intval($total_results); 
```

但是，如果对象有内置的非魔法方法，你应该使用它！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T19:29:20.477

[您可以在此处](http://framework.zend.com/apidoc/core/Zend_Gdata/Gdata/Zend_Gdata_Extension_OpenSearchTotalResults.html)查看该类的方法。然后你可以自己尝试不同的方法。例如，有一个 getText() 方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-17T15:01:30.060

尝试

```
class toValue {
    function __toString()
    {
        return '3'; // you must return a string
    }
}

$a = new toValue;

var_dump("$a" + 2); 
```

结果：int(5)

# asp.net - ASP.Net：为什么我在控件事件中对 Viewstate 所做的更改不能用于后续回发？

> ID：583159
> 
> 赞同：1
> 
> 时间：2009-02-24T19:19:48.583
> 
> 标签：asp.net, asp.net-ajax, viewstate

我正在使用 ASP.Net AJAX 在 ASP.Net 3.5 WebForms 中编写自定义控件。我正在为控件构建一个状态切换（展开和折叠模式）。我一直在尝试将控件的当前状态保留在 ViewState 中，并在服务器端事件处理程序中手动更改它：

```
object oExpanded = ViewState[ "Expandedness" ];
if(oExpanded == null)
{
    oExpanded = ListState.Collapsed;
}
ListState lsCurrentState = (ListState) oExpanded;
if(lsCurrentState == ListState.Collapsed)
{
    //code snipped - move to expanded mode here
    ViewState[ "Expandedness" ] = ListState.Expanded;
}
else
{
    //code snipped - move to collapsed mode here
    ViewState[ "Expandedness" ] = ListState.Collapsed;
} 
```

我认为这无关紧要，但实际渲染发生在更新面板中，并且上面的代码位于异步触发的事件处理程序中。我遇到的问题是，在下一次回发时，`ViewState["Expandedness"]`返回 null。我尝试使用 Fritz Onion 的 Viewstate Decoder 工具来查看回发之间 viewstate 的实际内容，但它告诉我序列化数据无效。

我在这里采取了错误的方法吗？解决这个问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T23:01:13.260

你是对的，它可以在 UpdatePanel 中 - 这应该没有任何区别。

我怀疑 ViewState 已为您的控件或其父级之一禁用：如果它为任何父级禁用（一直到页面），它将为您的控件禁用。

为了解决这个问题，您可以使用页面的 ViewState 字典而不是控件上的字典。

即而不是说：

```
this.ViewState[ "Expandedness" ] = ListState.Expanded; 
```

说：

```
this.Page.ViewState[ "Expandedness" ] = ListState.Expanded; 
```

如果页面上可能有多个控件实例，则需要确保 ViewState 键是唯一的，可能像这样：

```
this.Page.ViewState[ this.ClientID + "Expandedness" ] = ListState.Expanded; 
```

作为替代方案（即使 ViewState 对页面禁用也可以），您可以考虑将 Expandedness 存储在 ControlState 中。这有点棘手，但谷歌它，你会很快找到一个代码示例。建议您在 ControlState 中仅存储绝对最少的信息，但是像这样的单个标志很好（实际上它的设计目的是什么）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T22:41:39.173

你什么时候调用这个代码？如果在 Page_Init 中调用它为时过早，您对视图状态所做的任何更改都将被忽略。

只是一个想法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T23:01:07.100

进一步调查：我在子控件事件处理程序中对 Viewstate 所做的更改会持续与 Page_Prerender 一样长（即在页面的事件生命周期的后期），所以问题不在于 Viewstate 没有被写入。但是对页面的任何后续回发（同步或异步）都不会在视图状态中显示该值。

# actionscript-3 - 如何停止 Flex / AIR XOR-ing 填充？

> ID：583160
> 
> 赞同：2
> 
> 时间：2009-02-24T19:20:10.330
> 
> 标签：actionscript-3, graphics, air, flex3

如果您尝试以下代码：

```
g.beginFill(0xFF0000);
g.drawRect(0, 0, 50, 50);
g.drawRect(25, 25, 50, 50);
g.endFill(); 
```

你会认为它会绘制 2 个重叠的红色方块。但是，它没有 - 它绘制了两个红色方块，除了现在完全透明的重叠区域。

知道如何解决这个问题吗？

**接受后的答案：**

谢谢克里斯托夫[·赫勒曼](https://stackoverflow.com/questions/583160/how-to-stop-flex-air-xor-ing-a-fill/583242#583242)！将代码更改为：

```
g.beginFill(0xFF0000);
g.drawRect(0, 0, 50, 50);
g.endFill();
g.beginFill(0xFF0000);
g.drawRect(25, 25, 50, 50);
g.endFill(); 
```

按预期工作！我很想知道这是“预期行为”还是实际错误！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T19:40:05.413

endFill() 之前的所有调用将只存储您要绘制的多边形的点，并在调用 endFill() 后将它们连接起来。由于您示例中的代码有重叠部分，因此在绘制多边形的实际线时将被过滤掉。我实际上不知道这是 Flash 播放器的预期行为还是错误。

要解决这个问题，只需在绘制新矩形之前添加对 beginFill() 的新调用。

```
g.beginFill(0xFF0000);
g.drawRect(0, 0, 50, 50);
g.beginFill(0xFF0000);
g.drawRect(25, 25, 50, 50);
g.endFill(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T19:24:15.280

您不需要创建第二个图形对象来应用第二个填充吗？我敢打赌，您确实有一个形状奇特的图形对象，而不是两个相交的矩形。

# .net - 使用嵌套项构建复合控件

> ID：583164
> 
> 赞同：1
> 
> 时间：2009-02-24T19:20:24.417
> 
> 标签：.net, asp.net, custom-server-controls, composite-controls

我的目标是创建一个看起来、行为和行为都像 RadioButtonList 的复合控件。在幕后做了一些额外的事情，这些事情没有问题。我无法完成的是使用控件所需的标记。我理想的标记如下所示：

```
<cc1:RadioButtonField ID="rfCardType" runat="server" Title="Card Type:">
    <asp:ListItem Enabled="true" Text="MasterCard" />
    <asp:ListItem Enabled="true" Text="Visa" />
    <asp:ListItem Enabled="true" Text="Amex" />
</cc1:RadioButtonField> 
```

我想做的是将`<asp:ListItems`> 传递给复合控件中的 RadioButtonList 并让它处理生成/运行控件所需的一切。

**RadioButtonField 的控制标记**：

```
<div class="Title"> 
    <asp:Label ID="lblTitle" runat="server" AssociatedControlID="rblField" />
</div>
<div class="Text">
    <asp:RadioButtonList ID="rblField" runat="server" Visible="true">
    </asp:RadioButtonList>
</div> 
```

**RadioButtonField**背后的代码：****

 **```
??? 
```

为了收集`<asp:ListItems`> 并将它们传递给 RadioButtonList，后面的 RadioButtonField 代码需要做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T20:18:17.240

如果您想要`<ListItem>`样式标记，请执行以下操作：

1.  `items`将类型的私有字段添加`ListItemCollection`到复合控件
2.  `Items`将类型的公共属性添加`ListItemCollection`到复合控件。getter 应该引用`items`私有字段。
3.  将[`ParseChildren`](http://msdn.microsoft.com/en-us/library/system.web.ui.parsechildrenattribute.aspx)类属性添加到您的复合控件，以便它可以读取列表。

您的复合控件现在可以`ListItem`从其标记中读取节点。当控件呈现时，所有`<ListItem>`节点都将被添加到私有`items`集合中。

`Items`如果您现在可以只设置RadioButtonList 的成员，那就太好了，但不幸的是它是私有的。您将必须`foreach`通过该`items`字段并调用`Add()`您的子 RadioButtonList 上的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-28T15:01:45.560

```
[PersistenceMode(PersistenceMode.innerProperty)]
[DesignerSerializationVisibility(DesignerSerilizationVisibility.Content)]
ListCollection Items
{
} 
```

也许试试这两个属性。唯一为您的`PersistChildrenAttribute`Visual Studio 控件提供设计器支持。`DesignerSerializationVisibility.Content`序列化集合数据类型的内容

# vb.net - VB.NET 无限循环

> ID：583177
> 
> 赞同：-1
> 
> 时间：2009-02-24T19:22:56.797
> 
> 标签：vb.net, for-loop, infinite-loop

是否可以在 VB.NET 中编写无限 for 循环？

如果是这样，语法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-24T19:26:36.380

```
Do
    Something
Loop 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-24T19:25:12.937

```
For i as Integer = 0 To 1 Step 0 
```

如果这还不够hacky，还可以写：

```
For i As Integer = 0 To 2
  i -= 1
Next 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-24T19:26:55.210

或者

```
while (true)

end while 
```

* * *

好的，正确的答案：

```
Dim InfiniteLoop as Boolean = true;
For i = 1 to 45687894

    If i = 45687893 And InfiniteLoop = true Then i = 1
End For 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-09-27T07:04:42.547

除了为使循环永远运行而给出的所有答案之外，这可能只是第一个实际使用正无穷大的值来限制循环的方法。不过为了安全起见，我添加了一个额外的选项，可以在给定的秒数后退出，这样它就可以测量循环的速度。

```
Sub RunInfinateForLoop(maxSeconds As Integer)
    ' Attempts to run a For loop to infinity but also exits if maxSeconds seconds have elapsed.
    Dim t As Date = Now
    Dim exitTime As Date = t.AddSeconds(maxSeconds)
    Dim dCounter As Double
    Dim strMessage As String
    For dCounter = 1 To Double.PositiveInfinity
        If Now >= exitTime Then Exit For
    Next
    strMessage = "Loop ended after " & dCounter.ToString & " loops in " & maxSeconds & " seconds." & vbCrLf &
        "Average speed is " & CStr(dCounter / maxSeconds) & " loops per second."
    MsgBox(strMessage, MsgBoxStyle.OkOnly, "Infinity Timer")

End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-02T01:24:28.967

我所做的是添加一个计时器，然后将间隔更改为 1，然后启用它，然后如果我希望它通过循环不断检查某些内容，我只需双击 timer_tick 事件的计时器，然后输入我想要的内容。如果我希望它保存所有内容，我通常使用它来更新设置。

# eclipse - 在eclipse或命令行中创建可执行jar时如何排除外部jar？

> ID：583180
> 
> 赞同：5
> 
> 时间：2009-02-24T19:23:13.130
> 
> 标签：eclipse, jar

我在 Eclipse IDE 中编写了一个程序，它使用 BouncyCastle.jar 的 BouncyProvider 类。所以为了编译我的类，我在我的项目类路径中添加了 BouncyCastle.jar，它编译得很好。

现在我想将我的项目导出为 Runnable JAR，所以当我从 Eclipse 执行此操作时，默认情况下它也会在该可运行 jar 中添加 BouncyCastle.jar 的类。

但我想让我的应用程序 jar 和 BouncyCastle.jar 彼此不同。

我怎样才能做到这一点？有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T22:12:31.553

听起来您想使用“导出 JAR 文件”向导而不是“导出可运行 JAR 文件”向导。导出*可运行*的jar 文件时，Eclipse 会尝试将运行应用程序所需的所有内容打包到单个存档中。另一方面，“导出 JAR 文件”向导使您可以更好地控制归档中打包的内容。您仍然可以创建一个可运行的 jar 文件，但您必须确保在执行 jar 时在类路径中包含 BouncyCastle.jar。以下是分步说明：

1.  单击“文件|导出”。导出对话框弹出。
2.  展开“Java”文件夹并选择“JAR 文件”（不是“可运行的 JAR 文件”）。点击下一步。在 JAR 文件规范页面上，选择要包含在 jar 文件中的类，并指定要创建的 JAR 文件的名称。点击下一步。
3.  在 JAR Packaging Options 页面上，选择适合您的选项。默认值可能没问题。点击下一步。
4.  在 JAR Manifest Specification 中， **确保为您的 jar 文件选择“主类”**。这是执行 jar 文件时将执行的类。**如果将此留空，则 jar 文件将不可运行**。单击完成以创建 jar 文件。

您应该能够通过从命令行执行“ *java -jar myjarfile.jar -classpath BouncyCastle.jar* ”来执行 jar 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:47:44.007

**不幸的是，看起来你实际上不能这样做。**JAR 不能使用存储在自身内部的另一个 JAR。

我会说，除非你有一个非常充分的理由不能解压你的 BouncyCastle.jar（比如可能是许可问题？）

让它解压（您可以通过在 Eclipse 中将 BouncyCastle.jar 添加为外部存档来完成：）

```
Right-click on your project
Build Path...
Add External Archives...
Add your archive
Export as runnable JAR) 
```

并注意您的包名称是否存在冲突。

[这是我发现的描述您的情况的开放 Java 错误 ID](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6349851)

[One-JAR 可能会有所帮助 - 针对您的情况的开源解决方案](http://one-jar.sourceforge.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T22:19:24.063

看起来这已添加到 Eclipse 3.5 Milestone 5 中。有关最新版本和[错误 219530 ，请参阅](https://bugs.eclipse.org/bugs/show_bug.cgi?id=219530)[新闻](http://download.eclipse.org/eclipse/downloads/drops/S-3.5M5-200902021535/eclipse-news-M5.html#JDT)

# c# - 协议缓冲区反序列化和动态加载的 DLL

> ID：583182
> 
> 赞同：2
> 
> 时间：2009-02-24T19:23:32.207
> 
> 标签：c#, reflection, protobuf-net

我正在使用 protobuf-net 进行协议缓冲。我有一个动态加载的 dll。我可以创建包含在 dll 中的数据类的实例，并且可以使用和修改创建的数据对象。但是，当我尝试序列化/反序列化数据对象时，会出现以下崩溃：

{“无法识别 ProtoIncludeAttribute 的已知类型：MyDataDLL.MyDataClass, MyDataDLL, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null”}

有时崩溃说 MyDataClass 不是 MyBaseClass 的子类，或者类似的东西。MyDataClass 肯定继承自 MyBaseClass，并且 MyBaseClass 具有 MyDataClass 的 ProtoInclude 标记。

```
Assembly theAssembly = Assembly.LoadFrom("MyDataDLL.dll");

Type theType = theAssembly.GetType("MyDataDLL.MyDataClass");

object theData = Activator.CreateInstance(theType);

using (FileStream theStream = File.Open(fileName, FileMode.OpenOrCreate))
{
    MethodInfo method = typeof(ProtoBuf.Serializer).GetMethod("Deserialize").MakeGenericMethod(theType);
    theData = method.Invoke(null, new object[] { theStream });                      
} 
```

崩溃发生在“method.invoke”上

如果我在项目中引用 dll 并以这种方式使用它，我不会崩溃。所以我知道这是一个工作的dll。

* * *

更新：是的，MyDataClass 和 MyBaseClass 在同一个程序集中。

以下是我的代码与您的测试类所做的不同之处的列表，尽管它可能并不广泛：MyDataClass 是 7 个 ProtoIncludes 列表中的第 4 个。

MyBaseClass 包含所有数据字段，MyDataClass 包含操作这些数据字段的函数的逻辑。所以在 MyDataClass 中没有 ProtoMember 调用。

MyBaseClass 实现了 IExtensible 接口，并具有以下函数来处理附加数据：

```
private ProtoBuf.IExtension extensionObject;
ProtoBuf.IExtension ProtoBuf.IExtensible.GetExtensionObject(bool createIfMissing)            {
    return ProtoBuf.Extensible.GetExtensionObject(ref extensionObject, createIfMissing);
} 
```

它可能不会影响任何东西，但我的 ProtoContracts 使用 Name 参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T20:38:58.330

好的，我会调查的。我在[这里](http://code.google.com/p/protobuf-net/issues/detail?id=45)记录了这个。应该很有趣；-p 出于兴趣，是否`MyDataClass`和`MyBaseClass`在同一个程序集中？

顺便一提; 在下一个 drop 中，我打算包括`Serialize`接受 a `Type`（而不是泛型）的 etc - 这将使“正在进行的”RPC 堆栈更加简单，并且也将有助于您的使用。

* * *

更新; 我添加了一个[单元测试](http://code.google.com/p/protobuf-net/source/browse/trunk/Examples/Issues/Issue45.cs)和（在一个单独的 dll 中，通过`Assembly.LoadFrom` [测试类](http://code.google.com/p/protobuf-net/source/browse/trunk/LateLoaded/FooBar.cs)加载）。单元测试通过。请你澄清一下你的代码有什么不同（我需要一些我可以重现的东西来修复它）。

# asp.net - ASP.Net 控件出现在页面上，但不在该页面上的用户控件中

> ID：583184
> 
> 赞同：2
> 
> 时间：2009-02-24T19:23:47.760
> 
> 标签：asp.net

我正在使用 ASP.Net Web 应用程序项目。我有一个用户控件，其中有一个 asp.net 按钮。当我在页面上使用该用户控件时，按钮不会出现，但如果我将按钮直接放在页面上，则会显示按钮。知道问题是什么吗？

此外，在该用户控件中，我可以覆盖渲染方法并且传递给渲染方法的测试有效，但我仍然没有得到按钮

该程序集在 web.config 中注册

编辑：在戴夫的帖子之后，我发现 .ascx 文件中的任何内容都不起作用，而覆盖该用户控件的渲染方法有效

这页纸

```
<%@ Page Title="Home" Language="C#" MasterPageFile="~/Master.Master" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="Site.Default" %>
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <div>
        <uc:SomeCustomControl ID="myControl" runat="server" />
        <asp:Button runat="server" Text="outControl" />
    </div>
</asp:Content> 
```

控制 .ascx 文件

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="TestControl.ascx.cs" Inherits="Site.Controls.TestControl" %>
    <asp:Button runat="server" Text="InControl" /><!--cant see this button-->
    <p>I can't see this</p><!--cant see this text--> 
```

.ascx 文件背后的代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace Site.Controls
{
    public partial class TestControl : System.Web.UI.UserControl
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }
        protected override void Render(HtmlTextWriter writer)
        {
            writer.Write("I can see this");
            base.Render(writer);
        }

    }
} 
```

和页面源

```
 I can see this
        <input type="submit" name="ctl00$ContentPlaceHolder1$Button1" value="outControl" id="ctl00_ContentPlaceHolder1_Button1" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T22:34:50.657

如果您像这样在页面顶部注册控件

```
<%@ Register TagPrefix="uc" TagName="SomeCustomControl" Src="~/PathTo/TestControl.ascx" %> 
```

（这里的重点是 Src="..." 部分）

然后 TestControl.ascx 中的标记和控件将可见且可用。如果您仅在 web.config <pages> 指令（或页面顶部）中指定控件的命名空间，则仅使用代码隐藏，并且忽略代码前 (.ascx) 中的任何标记

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T19:33:38.940

用户控件中是否有任何代码影响按钮的可见性？

用户控件的其余部分是否出现，还是仅包含按钮？如果它只是一个按钮，那么整个用户控件可能无法正确呈现。向用户控件添加一些文本作为测试，以确保它只是不起作用的按钮，而不是整个用户控件。

您也可以尝试为页面启用跟踪。用户控件和按钮应显示在控件层次结构列表中。如果他们不这样做，那么一个或两个都没有正确渲染。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T19:59:10.920

此页面和控件是否在标准默认应用程序中？web.config 或 machine.config 是否有可能对您的 UserControl 产生一些影响？也许是一个 HttpModule？

除了从“默认”网站设置进行检查之外，您可能还需要进行一些调试并检查对象的属性。您可以在您的渲染方法中进行写入。也许看看渲染时用户控件中有多少控件。（可能是某些东西正在删除或清除控件容器）。

# c++ - C++ stdext hashmap 效率 - 重组（？）

> ID：583191
> 
> 赞同：3
> 
> 时间：2009-02-24T19:24:53.047
> 
> 标签：c++, hashmap

我遇到了一个与 stdext hashmap 相关的非常奇怪的事情。我必须处理很多对象，并且优先考虑快速访问元素。我的程序从文件中读取对象值，如果它是新元素，则将此值插入哈希图中，如果它是已处理的对象，则更改哈希图中的存储值。

我的问题与`hashmap(stdext)`. 我还没有找到这个容器的任何初始化选项。

键元素是一个无符号整数 ( `uint64`)，该对象与该键一起存储在哈希图中，大小为 160 KB。
该程序正在运行，但是当 hashmap 中的对象数量达到限制时，我不得不等待太多。

在此之后，哈希图再次运行良好，正如我所期望的那样。我想也许这是一个重组步骤。

但这些步骤很关键，因为在处理一定数量的物体后，这一步需要 5 个小时才能完成，而正常的处理步骤大约需要 2-3 分钟。此后，处理变为“正常”。

有没有人遇到过这样的问题？有人对这个哈希图有更深入的了解吗？我没有找到与该主题相关的任何内容。

* * *

我正在尝试使用具有非默认值的 hashmap 参数：`bucket_size`and `min_buckets`。其默认值为`bucket_size=4`和`min_buckets=8`。我已将 xhash 文件中的它们更改为更大的值，因为我没有设法从代码中更改这些值。我认为这`min_buckets`在我的应用程序中至关重要，我尝试“微调”以获得更好的性能，避免重组步骤。

但是所以我遇到了另一个问题，在我尝试清除哈希图之前一切正常。这需要很多时间。当我将它与默认值一起使用时，运行速度非常快。

更改 xhash 文件是不是一个糟糕的步骤？以前有人用过非默认值吗？这种缓慢清除的原因是什么？

我的第二个问题与在哈希图中存储指针有关。这个想法很清楚，但我怎么能设法释放指向的内存。我应该创建指向我的对象的指针；这些指针存储在 hashmap 中，当我需要该值时，我可以让它解除对这个指针的引用。但是保存地图后如何清除内存呢？也许这是一个微不足道的问题，但现在我没有看到解决方案。

感谢您已经发布的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T19:36:57.167

复制您的对象可能非常昂贵（考虑到它的大小）。尝试存储指向对象而不是整个事物的指针，或者如果您想让删除变得简单，请尝试存储 boost::shared_ptr。

这样，当数据结构自我重组时，复制非常快，因为它只是一个指针分配，而不是复制巨大对象所需的任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T20:18:43.323

您的问题是重新分配（和复制）或哈希冲突。

向量受此影响太大（并且分配大小呈指数增长）。然而，maps、sets 和 hashmaps 通常受到的影响较小。在大多数情况下，后面的这些类没有 resize() 成员。所以，

*   您可以传递自定义分配器（大多数容器允许 AFAIK）
*   选择更好的哈希算法

如果你愿意，你可以检查你的 hashmap 实现，看看它们是否遵循 move-idiom。如果他们不试一试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T19:42:04.113

当容器决定为更多对象分配空间时，听起来您会受到复制对象的成本的打击。两个最简单的选择是：

1.  如果您知道将使用该`void resize(size_type n)`函数插入的对象数量。

2.  您可以将指针存储在容器中，而不是对象本身。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-03T18:56:07.020

使用 Java。当涉及到高效的哈希映射插入（更好的分配器，无复制）并在查找时匹配它时，你会被它击败 C++ 的顺序震惊。

# macos - Mac OS X：一个进程可以渲染到另一个进程的窗口吗？

> ID：583202
> 
> 赞同：22
> 
> 时间：2009-02-24T19:26:53.213
> 
> 标签：macos, process, quartz-graphics, window-handles

问候！

我目前正在将 Web 浏览器插件从 Win32 移植到 MacOSX。该插件的一个特点是，当插件被加载时，它会产生一个单独的进程，作为插件的“引擎”，并在插件的窗口中执行绘图操作（具体来说，通过将 OpenGL 上下文附加到父进程的窗口并在该上下文中执行 OpenGL 渲染命令）。我们这样做是因为插件通常作为浏览器进程中的线程加载，因此插件中的崩溃会导致整个浏览器崩溃。通过将“繁重的工作”划分为一个单独的进程并保持插件代码非常精简，我们可以保护用户免受此类崩溃的影响。

我想在 MacOSX 上保留这种子进程渲染器架构，但我听说过一个令人讨厌的谣言（与 Google Chrome 网络浏览器有关），即 MacOSX 不允许进程将对其窗口的访问权交给另一个进程. 我自己在这个领域的搜索一直没有结果。如果有人对这个问题有任何了解，并且可以就如何实现这一目标提供一些建议，或者提供更明确的“无法完成”，那将非常有帮助。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-16T10:07:06.933

大约一年前，我正在研究一个解决方案。我在苹果邮件列表上开了几个线程：

http://www.mail-archive.com/cocoa-dev@lists.apple.com/msg08056.html

http://www.mail-archive.com/quartzcomposer-dev@lists.apple.com/msg01878.html

http://lists.apple.com/archives/mac-opengl/2008/May/msg00099.html

我不得不恢复到使用 CGWindowListCreateImage 的解决方案，该解决方案获取了 opengl 进程窗口的屏幕抓取并将其转换为位图以在主进程窗口中显示。这远非有效，因为像素数据是从视频内存传输到系统内存的。

我还尝试了浮动窗口解决方案。opengl 进程窗口浮动在主进程窗口上方，并响应主窗口中的鼠标移动。但是我在拖动滞后和窗口 z 顺序时遇到了问题。

您会认为 NSWindowSharingReadWrite 会满足您的要求，但当时的记录/示例几乎不存在。

但也许事情在去年发生了变化。如果您发现任何新内容，请随时通知我！

祝你好运

JC

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-12T21:11:49.083

这是从 Apple 开发团队收到的总体答复。

在 MacOSX 10.5 和更早版本中，基本上没有办法做到这一点，就像将 OpenGL 渲染上下文附加到另一个进程的窗口一样干净。在这些情况下，人们开发的黑客可能是最好的解决方案。

我们在 MacOS 10.6 中最接近的是[IOSurface 系统](http://cocoadhoc.blogspot.com/2009/09/hidden-gems-of-snow-leopard-iosurface.html)；在 10.6 中使用它似乎是最干净的解决方案。如果您希望渲染进程拦截渲染进程中的点击，您必须自己捆绑事件并使用您认为最合适的任何方法将它们传递给渲染进程。

有关 IOSurface 的更多信息可以在[这个 StackOverflow 条目中找到](https://stackoverflow.com/questions/1522151/need-help-with-iosurface-opengl-for-max-os-x-snow-leopard-application)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-28T08:09:24.213

一个进程中的窗口可以被另一个进程写入，看起来如果`NSWindowSharingType`设置为`NSWindowSharingReadWrite`。这是在 Leopard 中添加的。请注意，我自己没有使用过它，但我想说它至少为您消除了“无法完成”的障碍；-)

# php - PHP：在运行前检测“未定义函数”类型的错误？

> ID：583205
> 
> 赞同：4
> 
> 时间：2009-02-24T19:26:58.127
> 
> 标签：php, undefined

是否有任何工具可以帮助在运行*前*检测 PHP 脚本中的“未定义函数”等潜在错误？

例如，考虑：

```
<?php
zarfnutz ( 'blah' );
?> 
```

如果您要求 PHP 命令行界面检查语法错误，它会响应没有。但是，如果您尝试运行该脚本当然会失败，因为没有名为“zarfnutz”的函数。

我知道如果语言足够自引用，那么实际上不可能创建这样一个保证准确的工具（我不知道 PHP 是否实际上足够自引用）。但无论如何，肯定有一个工具至少可以*警告*你“zarfnutz”*可能*是未定义的，这样的工具对我很有帮助。

有人知道吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T19:28:43.833

我相信这是[PHPLint](http://www.icosaedro.it/phplint/)的功能之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T19:39:11.657

好吧，我不知道有什么*工具*可以做到这一点，但它是 PHP 核心[`function_exists`](http://www.php.net/function_exists)的[`get_defined_functions`](http://www.php.net/get_defined_functions)一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T19:40:46.817

在带有 lint 标志的文件上运行 php（仅限语法检查）：

```
php -l FILE 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T19:48:54.423

一种检查方法是使用[`function_exists()`](http://us2.php.net/manual/en/function.function-exists.php). 它不像通过 php -l 检查那样灵活，但它会完成工作。

# visual-studio-2008 - VSTS DB GDR - 为什么在同一个数据库中无法解析引用？

> ID：583206
> 
> 赞同：0
> 
> 时间：2009-02-24T19:27:36.880
> 
> 标签：visual-studio-2008, reference, gdr

我正在使用 Visual Studio Team Suite Database Edition GDR，并且我已经导入了我们的几个数据库。

我确实有成千上万的警告，其中大部分是未解决的参考。

我理解当我们没有外部引用的*SchemaName.dbo.TableName*时，但是当表存在于本地上下文中（包含所有引用的列）并且它是完全限定的时，为什么会有警告（甚至错误）？

我错过了什么？其中有很多，它必须很简单——就像我一样，显然;-)

非常感谢任何指导 - 乔纳森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T03:03:54.767

我自己对东德很陌生。这两个链接看起来可能会有所帮助，抱歉，我自己无法完全解释。旧版本中有一个已知问题。如果引用临时表或 TVP，也会出现错误。 [http://geekswithblogs.net/dtotzke/archive/2009/03/31/130556.aspx](http://geekswithblogs.net/dtotzke/archive/2009/03/31/130556.aspx) 潜在解决方案 - [http://blogs.msdn.com/gertd/archive/2009/01/11/file-level-build- gdr.aspx 中的警告抑制](http://blogs.msdn.com/gertd/archive/2009/01/11/file-level-build-warning-suppression-in-the-gdr.aspx)

# c# - 不是那个懒惰的正则表达式匹配吗？

> ID：583215
> 
> 赞同：2
> 
> 时间：2009-02-24T19:32:05.213
> 
> 标签：c#, .net, regex

我有一个匹配多个子组的 C# Regex 类，例如

```
(?<g1>abc)|(?<g2>def)|(?<g3>ghi) 
```

但有更复杂的子模式。除了现有组之外，我基本上想匹配不属于任何这些组的任何内容。

我试过

```
(?<g1>abc)|(?<g2>def)|(?<g3>ghi)|(.+?) 
```

但结果太慢了。我不能做否定，因为我不想冗余地复制那些复杂的子模式。仅使用 (.+) 会按预期覆盖所有其他组。

还有其他方法吗？如果这不起作用，我将不得不编写一个临时解析器。

其他详细信息：所有这些组都根据 MatchEvaluator 进行评估。因此，将“不匹配的字符串”发送到 MatchEvaluator 的 Regex 类行为也将起作用。

示例文本是

```
.......abc........ghi.....def.....abc....def...ghi......abc....... 
```

我想抓住中间的部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T19:34:53.367

> 但结果太慢了。我不能做否定，因为我不想冗余地复制那些复杂的子模式。

为什么不这样：

`const string COMPLEX_REGEX_PATTERN = "\Gobbel[dy]go0\k"`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T20:08:43.003

您的正则表达式为 g1、g2、g3 之外的每个字符生成单独的匹配项。因此，当您将它与 MatchEvaluator 一起使用时，它会生成大量评估器调用。这就是为什么它很慢。

如果您尝试以下正则表达式：

```
(?<rest>.*?)((?<g1>abc)|(?<g2>def)|(?<g3>ghi)|$) 
```

对于不包含“g”组的整个文本片段，您将获得单个“rest”组匹配。

正则表达式 C# 代码：

```
Regex regex = new Regex(
    @"(?<rest>.*?)((?<g1>abc)|(?<g2>def)|(?<g3>ghi)|$)",
    RegexOptions.Singleline
    | RegexOptions.Compiled
    ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T19:38:22.780

您是否尝试过设置要编译的正则表达式选项？我发现使用静态编译的正则表达式可以大大加快速度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T19:33:40.577

如果您的正则表达式有四页长，那么自己编写状态机可能是一个更好的主意......

# python - 使用 python 脚本以超级用户身份运行 linux 系统命令

> ID：583216
> 
> 赞同：18
> 
> 时间：2009-02-24T19:32:21.453
> 
> 标签：python, linux, sysadmin, sudo, root

我已经在我的机器上安装了 postfix，并且我正在以编程方式（使用 python）（在某些操作上）即时更新 virtual_alias。更新 /etc/postfix/virtual_alias 中的条目后，我将运行以下命令：

```
sudo /usr/sbin/postmap /etc/postfix/virtual_alias 2>>/work/postfix_valias_errorfile
```

但我收到错误：

```
sudo: sorry, you must have a tty to run sudo
```

我想以非人类的方式运行提到的 sudo 命令（意思是，我正在从 python 脚本运行这个系统命令。）。那么如何让这个命令以编程方式运行呢？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-24T19:39:15.337

您可以以 root 身份运行您的 python 脚本 - 然后您不需要添加权限来重新加载后缀。

或者您可以将 sudo 配置为不需要`/etc/init.d/postfix`.

sudo 配置（通过 visudo）允许 NOPASSWD: 允许没有密码的命令。见[http://www.sudo.ws/sudo/man/sudoers.html#nopasswd_and_passwd](http://www.sudo.ws/sudo/man/sudoers.html#nopasswd_and_passwd)

```
<username>  ALL = NOPASSWD: /etc/init.d/postfix 
```

或类似的东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T19:43:44.810

```
#include <unistd.h>
#include <stdlib.h>

// gcc -o reload_postfix reload_postfix.c
// chown root reload_postfix
// chmod +s reload_postfix

int main( int argc, char **argv ) {
    setuid( geteuid() );
    system("/etc/init.d/postifx reload");
} 
```

将您的命令包装在 setuid-ed 程序中。这将让任何用户重新启动 postfix。您当然可以进一步限制某些组的执行权限。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-06T13:20:55.133

要回答错误：“sudo：抱歉，您必须有一个 tty 才能运行 sudo”，我们在 sudoers 文件中有一个名为“Defaults requiretty”的设置。我试着把它评论出来，它奏效了：D。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T19:38:21.300

```
import os
os.popen("sudo -S /etc/init.d/postifx reload", 'w').write("yourpassword") 
```

这当然几乎总是不是一个好主意，因为密码是纯文本的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-17T20:46:23.590

如果您要在 python 中执行此操作，您应该执行以下操作：

在调用 shell 命令的那一行之前写下这个命令

```
os.setuid(os.geteuid()) 
```

然后，您调用不带“sudo”前缀的 shell 命令

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-11T07:59:42.263

见[StackLick](https://stackoverflow.com/questions/583216/run-a-linux-system-command-as-a-superuser-using-a-python-script)

您需要授予用户在没有密码的情况下运行*sudo 命令。*

# c# - Codesmith 是一个可行的 ORM 工具吗（或者我应该坚持使用真正的 ORM）

> ID：583232
> 
> 赞同：4
> 
> 时间：2009-02-24T19:37:00.710
> 
> 标签：c#, orm, codesmith

我正在购买 ORM 工具。我正在为购买 CodeSmith（目前可以以相当大的折扣购买）和 ORM 工具而苦恼。

LINQ to SQL 不在我的列表中；SubSonic 2.x 不在列表中（我不想在知道 SubSonic 3.0 即将到来的情况下投资那个死胡同。NHibernate 和 LLBLGEN 一样似乎有点矫枉过正。我只是简要评估了 EF，但没有很快得到一个温暖和模糊的感觉。

我是否疯狂地认为 CodeSmith 是现成 ORM 的合理替代品？CodeSmith 会以其他方式为自己买单吗？

请注意，我与任何供应商都没有任何关系，这不是一个便宜的问题，只是为了产生产品噪音！我正在寻找关于 CodeSmith 作为 ORM 工具（及其提供的或社区可用的）模板的诚实建议和意见。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T02:54:14.400

其实hibernate是一个很好的ORM工具。但它停在那里！

Code smith 的能力可以不仅仅是一个关系映射人员！我使用 Code smith 来生成一些 UI 表单、业务层（模板）、数据访问层、模式等。但是要与 Code smith 合作，您可能需要良好的系统设计经验或使用我不喜欢使用但我喜欢作为示例的模板。

Code smith 方法有一个特殊的缺点。您必须首先考虑数据库实现来设计您的系统。如今，在对象分析方法中，人们在任何数据库实现之前就成功地实现了业务逻辑和实体——他们忘记了这一点。

决定很难；我经常阅读重要的名字，例如 Scott W. Ambler、Kent beck、Robert C. Martin 和实用程序员系列中推荐使用 ORM 工具来加速开发的人。他们说 ORM 工具开发人员关心所有数据库问题（池、连接、数据库供应商细节等）。因此，当我们必须设计数据访问层时，我们也必须考虑所有这些方面。

我相信这些 ORM 工具带来了负担。我还不知道这些工具在低预算项目中的表现如何（我的意思是不是好的托管服务器或任何类型的共享资源）。我见过没有经验的开发人员在尝试宣传他们钟爱的工具时没有考虑到这一点。但是在java项目中，hibernate已经是一个广为人知的工具了。我毫不怀疑已经使用这项技术交付了伟大的项目，但我已经看到任何人一次又一次地 Java 开发人员可能需要教我们（.net 开发人员）如何构建出色的解决方案。（对不起，我们不得不承认。）

我唯一建议的是考虑你的背景。你在做一个新系统吗？你需要有规律的工作吗？你有没有尝试过完全考虑这样的代码生成器和 ORM 工具？

我确实更喜欢 Code smith，因为我一次生成整个解决方案，而不仅仅是数据访问层。代码生成非常重要，微软在visual studio.net 2008 等中模仿了code smith 的方法也很重要。

祝你好运

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T19:43:19.523

Code Smith 不是 ORM，它只是一个代码生成器 IDE。

您可以使用基于您的数据库的代码 smith 生成 DAL，但这会破坏使用 ORM 的（其中一个）目的，这基本上是它动态生成 DAL，因此您不必编写代码。

如果您真的想比较两者，那么也许您可能会使用 code smith 获得一些好处，因为您可以绝对控制生成的代码，但我不确定这种好处是否会超过可能转变的缺点花费数月时间编写代码 smith 模板以根据您的数据库生成 DAL。

然后您必须考虑对数据库进行更改时会发生什么，您很可能每次都必须运行 code smith 并构建。一个好的 ORM 将允许您在模式中配置数据库更改，然后它将动态生成，因此您不必（尽可能多地）担心对数据库进行更改。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-24T20:02:38.010

[NHibernate](http://nhforge.org)是要走的路。它是一个企业级的 ORM。[并且使用FluentNHibernate](http://fluentnhibernate.org/)库中基于约定的自动配置，如果您坚持单一约定（您可以指定约定，或者有默认值），配置将非常简单。

使用 NHibernate，您的域对象是纯 C# 对象。没有奇怪的基类。每次您决定进行更改时，都不需要刷新代码生成的文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-15T02:58:49.540

我每天都使用 netTiers 并且喜欢它。它的文档很烂，但它在办公室为我节省了很多时间。很多人抱怨它产生的代码量，但据我所见，它创建的代码比手工编码要快得多。它还生成基本 CRUD 内容所需的所有 sproc。它产生的访问方法也非常棒，可以通过你所有的唯一键、外键和主键获取。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T19:48:14.287

我认为 Codesmith 的使用是可行的。但是您应该研究使用它的框架。 [Net Tiers](http://nettiers.com/)是一个应用程序框架，可以在此基础上构建一个好的 DAL。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T20:34:36.873

为什么像 LLblgen 这样的东西会矫枉过正？我们在工作中使用它，经过一段陡峭的学习曲线后，它非常好:)。您至少应该尝试一下并进行休眠。

不知道这与 codesmith 有什么关系，那是一个代码生成器，你可以推出自己的 ORM，但由于那里已经有好的 ORM，我认为除非你想为了学习目的而花费时间和精力.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-24T17:27:00.783

使用 netTiers 和 .netMVP。NetTiers 是一个非常好的 DAL，而 .netMVP 是我刚刚发布的一个框架，用于支持 UI 级别的抽象。:)

[http://community.codesmithtools.com/CodeSmith/m/templates/42499.aspx](http://community.codesmithtools.com/CodeSmith/m/templates/42499.aspx)

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-09-17T19:20:33.937

几年前我用过 LLblgen。我希望我所看到的已得到修复。我们查看了生成并看到的内联 SQL，用于选择传入主键的一行数据：

```
SELECT DISTINCT * FROM TABLE WHERE primark_key_id = @primarykey. 
```

真的，与众不同？我总是乞求做存储过程，但是项目负责人击落了。我不确定编写低效代码节省了多少时间。

# unix - 使用 Unix find(1)，我如何在一棵树中找到比另一棵树中的文件更新的文件？

> ID：583249
> 
> 赞同：2
> 
> 时间：2009-02-24T19:41:59.043
> 
> 标签：unix, find

假设我有两个目录结构：

```
/var/www/site1.prod
/var/www/site1.test 
```

我想使用[find(1)](http://unixhelp.ed.ac.uk/CGI/man-cgi?find)查看`/var/www/site1.test`比`/var/www/site1.prod`.

我可以用[find(1)](http://unixhelp.ed.ac.uk/CGI/man-cgi?find)做到这一点，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T20:07:14.957

你也可以使用 rsync -n

rsync -av -n /var/www/site1.test /var/www/site1.prod

应该这样做。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T20:11:47.880

**使用查找**，

```
cd /var/www/site1.test
find . -type f -print | while read file ; do
  [ "$file" -nt /var/www/site1.prod/"$file" ] && echo "File '$file' changed"
done 
```

**这适用于包含空格的文件名，也适用于大量文件。**

根据 Eddie 的评论，为了区分修改后的文件和丢失的文件，

```
cd /var/www/site1.test
find . -type f -print | while read file ; do
  [ "$file" -nt /var/www/site1.prod/"$file" ] && reason=changed
  [ \! -e /var/www/site1.prod/"$file" ] && reason=created
  [ -n "$reason" ] && echo "$file $reason"
done 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T20:00:58.577

我认为你不能单独找到它，但你可以做类似的事情

```
$ cd /var/www/site1.test
$ files=`find .`
$ for $f in $files; do
     if [ $f -nt /var/www/site1.prod/$f ]; then echo "$f changed!"; fi;
  done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T20:02:27.230

如果您查看 -fprintf 选项，您应该能够创建两个输出到两个文件中，其中列出了文件名和修改时间。然后，您应该能够比较这两个文件以查看发生了什么变化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T20:17:03.670

我了解您特别要求更新，但我认为了解您的所有选择总是好的。

我会使用 diff -ur dir1 dir2。

也许时间戳改变了，也许它没有改变，但这并不一定告诉你内容是否相同。Diff 会告诉你内容是否发生了变化。如果您真的不想查看内容，请使用 diff -rq 来查看已更改的文件。

# c++ - 将 C++ 定义放在头文件中是一种好习惯吗？

> ID：583255
> 
> 赞同：241
> 
> 时间：2009-02-24T19:43:24.343
> 
> 标签：c++, coding-style, code-separation

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2009-02-24T19:47:16.190

你的同事错了，常见的方法是并且一直都是将代码放在 .cpp 文件（或任何你喜欢的扩展名）中，并在标题中声明。

有时将代码放在头文件中会有一些好处，这可以让编译器更聪明地进行内联。但与此同时，它会破坏您的编译时间，因为每次编译器包含所有代码时都必须对其进行处理。

最后，当所有代码都是标题时，循环对象关系（有时是需要的）通常很烦人。

归根结底，你是对的，他是错的。

**编辑：**我一直在考虑你的问题。有**一种**情况，他说的是真的。模板。许多较新的“现代”库（例如 boost）大量使用模板，并且通常是“仅标题”。但是，这只能在处理模板时进行，因为这是处理模板时的唯一方法。

**编辑：**有些人想要更清楚一点，这里有一些关于编写“仅标题”代码的缺点的想法：

如果你四处搜索，你会看到很多人在处理 boost 时试图找到一种减少编译时间的方法。例如：[如何使用 Boost Asio 减少编译时间](https://stackoverflow.com/questions/2258967/how-to-reduce-compilation-times-with-boost-asio)，它可以看到单个 1K 文件的 14 秒编译，其中包含 boost。14 秒似乎没有“爆炸式增长”，但它肯定比典型的要长得多，并且在处理大型项目时可以很快加起来。仅标头库确实以可衡量的方式影响编译时间。我们只是容忍它，因为 boost 非常有用。

此外，还有很多事情不能仅在标头中完成（即使 boost 具有您需要链接到某些部分的库，例如线程、文件系统等）。一个主要的示例是，您不能在仅标头库中拥有简单的全局对象（除非您求助于单例的可恶），因为您将遇到多个定义错误。**注意：** C++17 的内联变量将使这个特定示例在未来变得可行。

最后一点，当使用 boost 作为仅标头代码的示例时，经常会遗漏一个巨大的细节。

Boost 是库，而不是用户级代码。所以它不会经常改变。在用户代码中，如果你把所有东西都放在头文件中，每一个小改动都会导致你不得不重新编译整个项目。这是对时间的巨大浪费（对于不会从编译到编译的库来说，情况并非如此）。当您在标头/源代码和更好的情况下拆分内容时，使用前向声明来减少包含，您可以在一天内加起来节省数小时的重新编译时间。

* * *

## 回答 #2

> 赞同：183
> 
> 时间：2009-02-24T19:48:26.267

在 C++ 程序员同意**The Way**的那一天，羔羊将与狮子一起躺下，巴勒斯坦人将拥抱以色列人，猫和狗将被允许结婚。

在这一点上，.h 和 .cpp 文件之间的分离主要是任意的，这是很久以前编译器优化的痕迹。在我看来，声明属于头文件，定义属于实现文件。但是，这只是习惯，不是宗教。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-02-24T19:49:34.843

标头中的代码通常不是一个好主意，因为当您更改实际代码而不是声明时，它会强制重新编译包含标头的所有文件。它还会减慢编译速度，因为您需要解析每个包含标头的文件中的代码。

在头文件中包含代码的一个原因是关键字 inline 通常需要它才能正常工作以及使用在其他 cpp 文件中实例化的模板时。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-02-24T20:08:25.953

可能会告诉您同事的是，大多数 C++ 代码都应该模板化以实现最大可用性。如果它是模板化的，那么所有内容都需要在头文件中，以便客户端代码可以看到它并实例化它。如果它对 Boost 和 STL 来说足够好，那对我们来说也足够好了。

我不同意这种观点，但这可能是它的来源。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2015-08-11T05:16:02.603

我认为你的同事很聪明，你也很正确。

我发现将所有内容放入标题中的有用之处在于：

1.  无需编写和同步标头和源。

2.  结构很简单，没有循环依赖迫使编码器制作“更好”的结构。

3.  便携，易于嵌入到新项目中。

我同意编译时间问题，但我认为我们应该注意到：

1.  源文件的更改很可能会更改头文件，从而导致整个项目重新编译。

2.  编译速度比以前快很多。而如果你有一个项目要建设的时间长、频率高，这可能表明你的项目设计存在缺陷。将任务分成不同的项目和模块可以避免这个问题。

最后，我只是想支持你的同事，就我个人而言。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-02-24T21:21:54.873

通常我会将琐碎的成员函数放入头文件中，以允许它们被内联。但是要将整个代码体放在那里，只是为了与模板保持一致？这简直是​​疯了。

记住：[愚蠢的一致性是小头脑的妖精](http://www.dictionary.com/browse/a-foolish-consistency-is-the-hobgoblin-of-little-minds)。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-03-26T15:17:38.047

正如 Tuomas 所说，您的标题应该是最小的。为了完整，我将扩展一点。

我个人在我的`C++`项目中使用了 4 种类型的文件：

*   **上市：**
*   转发标头：在模板等情况下，此文件获取将出现在标头中的转发声明。
*   标头：此文件包括转发标头（如果有），并声明我希望公开的所有内容（并定义类...）
*   **私人的：**
*   私有头文件：这个文件是为实现而保留的头文件，它包括头文件并声明了辅助函数/结构（例如用于 Pimpl 或谓词）。如果不需要，请跳过。
*   源文件：它包括私有标头（或标头，如果没有私有标头）并定义所有内容（非模板...）

此外，我将此与另一条规则相结合：不要定义您可以转发声明的内容。虽然我在那里当然是合理的（在任何地方使用 Pimpl 都很麻烦）。

这意味着`#include`只要我可以摆脱它们，我更喜欢前向声明而不是标题中的指令。

最后，我还使用了可见性规则：我尽可能地限制符号的范围，以免它们污染外部范围。

总而言之：

```
// example_fwd.hpp
// Here necessary to forward declare the template class,
// you don't want people to declare them in case you wish to add
// another template symbol (with a default) later on
class MyClass;
template <class T> class MyClassT;

// example.hpp
#include "project/example_fwd.hpp"

// Those can't really be skipped
#include <string>
#include <vector>

#include "project/pimpl.hpp"

// Those can be forward declared easily
#include "project/foo_fwd.hpp"

namespace project { class Bar; }

namespace project
{
  class MyClass
  {
  public:
    struct Color // Limiting scope of enum
    {
      enum type { Red, Orange, Green };
    };
    typedef Color::type Color_t;

  public:
    MyClass(); // because of pimpl, I need to define the constructor

  private:
    struct Impl;
    pimpl<Impl> mImpl; // I won't describe pimpl here :p
  };

  template <class T> class MyClassT: public MyClass {};
} // namespace project

// example_impl.hpp (not visible to clients)
#include "project/example.hpp"
#include "project/bar.hpp"

template <class T> void check(MyClass<T> const& c) { }

// example.cpp
#include "example_impl.hpp"

// MyClass definition 
```

这里的救星是大多数时候前向标头是无用的：只有在`typedef`or的情况下才需要`template`实现标头；）

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-02-24T20:52:55.190

为了增加乐趣，您可以添加`.ipp`包含模板实现（包含在 中`.hpp`）的文件，同时`.hpp`包含接口。

除了模板化代码（取决于项目，这可能是大多数或少数文件）之外，还有*普通代码*，在这里最好将声明和定义分开。在需要的地方还提供前向声明——这可能会影响编译时间。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-02-24T21:50:30.077

一般来说，写一个新类的时候，我会把所有的代码都放在这个类里，这样我就不用再找另一个文件了。一切正常后，我把方法体分解成cpp文件，将原型留在 hpp 文件中。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-02-24T19:48:15.143

我个人在我的头文件中这样做：

```
// class-declaration

// inline-method-declarations 
```

我不喜欢将方法的代码与类混合，因为我发现快速查找内容很痛苦。

我不会将所有方法都放在头文件中。编译器（通常）不能内联虚方法，并且（可能）只能内联没有循环的小方法（完全取决于编译器）。

在课堂上做这些方法是有效的......但从可读性的角度来看，我不喜欢它。将方法放在标题中确实意味着，如果可能，它们将被内联。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-02-24T20:01:04.427

如果这种新方式真的是**The Way**，我们的项目可能会遇到不同的方向。

因为我们试图避免标题中所有不必要的东西。这包括避免标头级联。标头中的代码可能需要包含其他标头，这将需要另一个标头，依此类推。如果我们被迫使用模板，我们会尽量避免在标题中过多地使用模板。

此外，我们在适用时使用[“不透明指针”模式](http://en.wikipedia.org/wiki/Opaque_pointer)。

通过这些实践，我们可以比大多数同行进行更快的构建。是的......更改代码或类成员不会导致大规模重建。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-12-01T23:07:25.360

我认为将所有函数定义都放入头文件中绝对是荒谬的。为什么？因为头文件用作类的 PUBLIC 接口。这是“黑匣子”的外面。

当你需要查看一个类来参考如何使用它时，你应该查看头文件。头文件应该给出一个它可以做什么的列表（注释来描述如何使用每个函数的细节），它应该包括一个成员变量的列表。它不应该包括每个单独的功能是如何实现的，因为这是一堆不必要的信息，只会使头文件混乱。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-24T20:57:40.843

我把所有的实现都放在了类定义之外。我想从类定义中删除 doxygen 注释。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-25T12:54:09.560

恕我直言，他只有在做模板和/或元编程时才有价值。已经提到了很多将头文件限制为声明的原因。他们只是……标题。如果要包含代码，请将其编译为库并将其链接起来。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-25T15:15:21.767

这真的不取决于系统的复杂性和内部约定吗？

目前，我正在研究一个非常复杂的神经网络模拟器，我期望使用的公认风格是：

classname.h 中的类定义 classnameCode.h中的
类代码 classname.cpp 中的
可执行代码

这将用户构建的模拟与开发人员构建的基类分开，并且在这种情况下效果最好。

但是，如果看到人们在图形应用程序或任何其他目的不是为用户提供代码库的应用程序中这样做，我会感到惊讶。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-07-03T19:48:51.617

模板代码应该只在标题中。除此之外，除内联之外的所有定义都应在 .cpp 中。对此最好的论据是遵循相同规则的标准库实现。您不会不同意 std lib 开发人员对此是正确的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-12-19T12:15:46.223

我认为您的同事是对的，只要他不进入在标头中编写可执行代码的过程即可。我认为，正确的平衡是遵循 GNAT Ada 指示的路径，其中 .ads 文件为其用户及其子项提供了包的完全充分的接口定义。

顺便说一句，Ted，你有没有在这个论坛上看过最近关于 Ada 绑定到你几年前写的 CLIPS 库的问题，现在不再可用（相关网页现已关闭）。即使针对旧的 Clips 版本，此绑定对于愿意在 Ada 2012 程序中使用 CLIPS 推理引擎的人来说也是一个很好的开始示例。

# svn - SVN 将一个 Repo 的分支合并到另一个 Repo 的主干

> ID：583260
> 
> 赞同：5
> 
> 时间：2009-02-24T19:44:19.677
> 
> 标签：svn, tortoisesvn, merge

我有两个位于不同服务器上的存储库，分别称为 repo-1 和 repo-2。

启动两个“树干”是相等的：

回购 1/主干 == 回购 2/主干

同时，对 repo-1/trunk 的更改正在提交，而我正在着手对 repo-2/trunk 进行更改。

现在我需要将 repo-1/trunk 中的更改合并到 repo-2/trunk 中。

我想我会将 repo-1/trunk 复制到 repo-2/tags/r1_20090224，然后将该标签合并到我的本地 repo-2/trunk 工作副本中（即 c:\dev\repo2-trunk）。

关于如何做到这一点的任何建议？我正在尝试使用 TortoiseSVN 并执行“合并两个不同的树”，我使用了以下设置：

从：repo-2/trunk 到：repo-2/tags/r1_20090224 工作副本：c:\dev\repo2-trunk

我也尝试交换“从”和“到”......但没有运气。通过尝试这两个合并选项中的任何一个，我最终都会得到以下结果：

1.  如果我从主干合并到标签（进入我的本地 repo-2/主干副本），我会丢失我的主干更改并获得标签更改。

2.  如果我从标签合并到主干（到我的 repo-2/trunk 的本地副本），我会丢失我的标签更改并保留我的主干更改。

关于这样做的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T20:22:45.077

**如果** `svn merge`在两个站点/服务器上失败了：

```
svn: Unusable URI: it does not refer to this repository 
```

然后使用以下方法：

1.  *`repo-2`确定开始偏离的修订级别`repo-1`，例如 123*，然后：
2.  `svn co http://server1/repo-1/trunk`
3.  `svn diff -r123:HEAD http://server2/repo-2/trunk >repo2.patches`
4.  `patch -p0 -i repo2.patches`
5.  *筛选任何冲突并解决它们*
6.  `svn ci --message "merged from repo-2"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:54:29.280

首先找出树木相同的版本。然后将该版本从 repo-1 存储库的 HEAD 合并到您的 repo-2 工作副本。

如果要合并 r123 和 r456 之间的更改，则使用命令行客户端与此类似

```
svn merge http://domain.tld/repos1@123 http://domain.tld/repos1@456 repos2-workingcopy 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T19:59:45.833

这并不完全清楚，但您需要从两棵树的*底部*合并，即两棵树干相同的点。

Sander 打败了我，所以感谢他，但这里还有一些提示：

1.  尽快将这两个存储库合并为一个；Subversion 并不是真正设计成这样工作的。或者转移到 DVCS，如 git 或 bazaar 或 ...
2.  如果你坚持使用 Subversion，通常这种东西是用*分支*完成的，而不是*标签*。标签通常用作标记点，并且不承诺。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T19:56:45.467

[如果您发现自己随着时间的推移不断地管理多个需要不时同步的存储库，那么SVK](http://svk.bestpractical.com/view/HomePage)可能会提供帮助。

# c# - 在 C# 中动态减小图像尺寸和图像大小

> ID：583263
> 
> 赞同：1
> 
> 时间：2009-02-24T19:45:54.680
> 
> 标签：c#, asp.net, image-scaling

我有一个使用中继器控件创建的图片库。中继器在我的代码隐藏文件中绑定到包含各种图像路径的表。

我的中继器中的图像是这样填充的

```
<img src='<%# Eval("PicturePath")' %>' height='200px' width='150px'/> 
```

（或类似的东西，我不记得确切的语法）

问题是有时图像本身很大，所以加载时间有点荒谬。填充 150x200px 的图像绝对不需要 3MB 的文件。

有没有办法不仅可以更改图像尺寸，还可以缩小文件大小？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T19:49:04.673

我建议创建一个处理程序，它可以即时为您调整图像大小并以您喜欢的任何格式对其进行编码……有点像缩略图生成器。这将消耗服务器上的 CPU，但您可以缓存图像并大大降低带宽成本 ETC。让我看看我是否能找到我读过的一篇关于类似内容的好文章的链接。

你可以看看[这篇文章](http://dotnetslackers.com/articles/aspnet/Generating-Image-Thumbnails-in-ASP-NET.aspx)，它不是我读过的文章，但它有一些关于如何去实现它的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:56:59.210

您正在寻找 Image 类的[GetThumbnailImage 方法](http://msdn.microsoft.com/en-us/library/system.drawing.image.getthumbnailimage.aspx)。您将需要提前生成缩略图图像，或者在第一次访问时创建图像并将其保存到磁盘以供以后使用（因此第一次访问会很慢，但后续请求会很快）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T19:59:53.697

[您可以在CodePlex.com](http://www.codeplex.com)上尝试这两个项目中的任何一个，它们都提供带有缓存的动态图像生成。

*   [动态图像处理](http://www.codeplex.com/dynamicimageprocess)
*   [ASP.NET 图像生成](http://www.codeplex.com/aspnet/Wiki/View.aspx?title=Image%20Generation&referringTitle=WebForms)

后者直接来自微软。

# email - 在我以编程方式发送电子邮件后获取电子邮件中的用户活动数据

> ID：583267
> 
> 赞同：1
> 
> 时间：2009-02-24T19:46:20.000
> 
> 标签：email, newsletter

如果我要构建一个时事通讯电子邮件系统，我将需要能够生成关于有多少电子邮件被退回、标记为垃圾邮件、取消订阅、已读与未读、点击率​​等的报告。

那么在发送电子邮件后如何跟踪用户活动呢？我是否正确地假设您不能将 javascript 代码嵌入到电子邮件中以监控用户活动？我还如何为我的报告收集数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T19:55:08.280

一旦您发送电子邮件，它就像一只被踢出巢穴的小鸟一样免费。电子邮件客户端的作者竭尽全力确保他们阻止任何能够为您提供所需反馈的功能。虽然此类信息有合法用途，但垃圾邮件发送者使用此类信息来验证和清理他们的电子邮件列表。

许多 ISP 还阻止退回邮件，因为它们向垃圾邮件发送者提供信息。

您能做的最好的事情就是尝试激励您的读者点击返回您的网站。然后，您可以收集电子邮件发件人无法获得的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T19:55:09.700

您可以通过在 URL 中包含跟踪查询字符串位并通过您的站点路由它们来轻松跟踪点击率。

所以一个链接可能是：[http ://mysite.com/?LinkID=foobar](http://mysite.com/?LinkID=foobar)

至于已读与未读，您可以通过在您的网站中包含一个包含跟踪 URL [http://mysite.com/track.gif?EmailID=email](http://mysite.com/track.gif?EmailID=email)的小型透明图片来了解这一点。然而，这并不是万无一失的，因为电子邮件可以离线阅读，并且大多数现代电子邮件客户端在没有用户操作以在电子邮件中显示图像的情况下不会显示图像。

对于退回邮件，您必须通过从邮箱中读取“发件人”电子邮件来跟踪这些邮件。

想不出办法来跟踪标记为垃圾邮件的电子邮件，只能将其发送到使用一些常见垃圾邮件过滤产品的多个邮箱并检查结果。但是，这不太可能是准确的，因为大多数都可以并且是由个人用户定制/培训的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-20T15:16:49.353

如果您想进行点击跟踪，您必须将邮件中的所有链接替换为指向您的跟踪脚本的链接。要进行有效的跟踪，以便稍后实际用于细分列表和更好地定位，您必须跟踪订阅者的 ID 和消息和/或活动 ID。一些电子邮件营销系统甚至会跟踪邮件中的链接位置，因此您可以准确地知道收件人是否点击了邮件顶部或中间以及我构建的系统中的同一个链接，我什至会跟踪他们是否点击了消息的 html 部分或文本部分中的链接。

跟踪器脚本将记录所有这些信息，然后重定向到实际链接。

Bounce tracking is done by processing the bounce messages that your server will receive or generate when a message cannot be delivered. I recommend using VERP: [http://en.wikipedia.org/wiki/Variable_envelope_return_path](http://en.wikipedia.org/wiki/Variable_envelope_return_path)

Open tracking is done by including the image with tracking code in the url. This would normally point to a script on your site that would record the subscriber id and message and/or campaign id then output the binary date for a transparent 1x1 px wide gif.

You can also track messages that are flagged as spam by some users of some ISPs like hotmail, yahoo, aol, and a few others. they offer feedback loops so every time someone clicks that "Spam" button in their webmail application they will send you a message that you can parse and determine the subscriber that actually flagged the message as spam. VERP also helps with this because the feedback loop messages don't always include the actual email address of the subscriber so you need another way to identify them. This page on wikipedia has a list of feedback ISPS that offer feedback loops : [http://en.wikipedia.org/wiki/Feedback_Loop_%28email%29](http://en.wikipedia.org/wiki/Feedback_Loop_%28email%29)

# asp.net-mvc - 什么时候应该避免使用强类型视图数据？

> ID：583273
> 
> 赞同：3
> 
> 时间：2009-02-24T19:48:03.913
> 
> 标签：asp.net-mvc, model-view-controller

我很享受视图和控制器中缺少“魔术字符串”，但这种方法有什么缺点吗？

好像没有。我已经在这里和那里阅读了博客条目，但暗示并非如此。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T19:53:04.773

模型的扩散，在极端情况下为每个动作的模型，以支持可能与数据模型不直接相关的其他视图属性。例如，如果您的视图因角色而异，则需要创建一个新模型来封装数据模型和与角色相关的设置。通过将数据模型用作视图模型并通过“魔术字符串”向 ViewData 添加一些设置，可以实现相同的效果。

**编辑**这不是“避免”强类型视图的理由，而是在选择何时创建新的、特定于视图的模型而不是使用现有模型并使用 ViewData 属性扩展它时给予一些平衡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:53:56.237

我不建议避免使用强类型视图数据，但我敢肯定有些人会不同意。我可以理解您是否在进行快速原型设计，而您仍然在搞乱要显示的数据。强类型将为您提供更好的调试和编码体验。此外，花时间考虑您的视图数据将使您更好地理解您的设计，并最终导致更好的代码质量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T20:56:40.113

据我所知，强类型视图数据没有单一的缺点。我不明白为什么魔术字符串和匿名对象无论如何都是 MVC 框架的一部分。我尽量避免它们。您不想在其余代码中传递类型对象的参数，那么为什么要在 UI 中这样做呢？

# security - SharePoint WebPart 权限

> ID：583280
> 
> 赞同：0
> 
> 时间：2009-02-24T19:48:51.227
> 
> 标签：security, sharepoint, permissions

您好，我正在为 webpart 使用 SharePoint 命名空间，当我尝试使用系统帐户时遇到一些权限错误。有没有办法可以使用定义的用户而不是系统帐户？

现在我有：

```
SPUserToken sysToken = SPContext.Current.Site.SystemAccount.UserToken;
using (SPSite site = new SPSite(_SPSite, sysToken)) 
```

我希望能够使用域上的帐户而不是系统帐户，感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T00:19:13.293

根据以下博客文章，您可能需要使用 RunWithElevatedPermissions 来访问系统帐户才能工作：

[http://solutionizing.net/2009/01/06/elegant-spsite-elevation/](http://solutionizing.net/2009/01/06/elegant-spsite-elevation/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T20:07:26.347

您可以使用`SPUserCollection`

```
SPContext.Current.Site.RootWeb.AllUsers 
```

获取站点上的所有用户，并`SPUser`从那里获取。拥有后，`SPUser`您可以获得 UserToken。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T04:26:26.567

你想做什么？如果不使用令牌，将以与当前用户相同的权限打开网页

```
/* runs as user requesting the web part */
SPSite site = SPContext.Current.Web.site 
```

或者您可以将其包装在**RunWithElevatedPrivileges**委托中

```
/* runs with admin privileges */         
SPSecurity.RunWithElevatedPrivileges(
   delegate()
   {
      using (SPSite site = new SPSite(SPContext.Current.Web.Site.Url))
      {
        //do stuff
      }
   }
); 
```

# silverlight - Silverlight DataGrid - 在显示行详细信息时隐藏行

> ID：583284
> 
> 赞同：1
> 
> 时间：2009-02-24T19:49:00.120
> 
> 标签：silverlight

我有一个 Silverlight DataGrid 并希望显示所选行的 RowDetails (RowDetailsVisibilityMode="VisibleWhenSelected")。
那没问题。但同时我想隐藏选定的行本身。有点用它的细节交换一行。

将行 Visibility 设置为 Collapsed 或 Height 设置为 0 对我不起作用，因为这样细节也将被隐藏。有没有办法处理这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T08:39:13.620

我找到了一个解决方案：

行的高度是行本身的高度加上其细节的高度。尽管您无法在运行时检索此高度（它是“NaN”），但可以设置它。正如我在问题中指出的那样，我尝试将其设置为 0，这使其完全消失，包括细节。但是，如果我只是根据我的风格将行的高度设置为细节将具有的高度，那么带有细节的行的显示将被裁剪在顶部，并使行滑动到上面的行或标题的“后面”。这正是我想要的。

# shell - 递归搜索目录，将指定文件类型从一个位置移动到另一个保留目录结构

> ID：583291
> 
> 赞同：1
> 
> 时间：2009-02-24T19:50:13.907
> 
> 标签：shell, file, automation, dos

有没有办法指定一个目录（比如“C:\images”）并将每个 .jpg 文件从那里移动到另一个目录（比如“D:\media”）但保留目录结构（所以如果文件是“ C:\images\paintball\july\07\headshot.jpg” 移动后会是“D:\media\paintball\july\07\headshot.jpg”）？

我正在使用 cygwin（但如果也可以使用 DOS，我会很乐意使用）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T20:01:36.580

是的。

在保留目录结构（有一个开关）的同时对 *.jpg 文件进行 tar 归档，然后将其解压缩到目标目录。应该是单线。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T20:25:48.720

```
( cd /cygdrive/c/images
tar --create --file - . ) | ( cd /cygdrive/d/media
tar --extract --file - ) 
```

在某些版本的 tar 中还有一个 --directory 选项，您可以使用它避免子外壳之间管道的复杂性，但我自己从不使用它，所以我可能会遗漏一些东西：

```
tar --create --file - -C /cygdrive/c/images . | tar --extract --file - -C /cygdrive/d/media 
```

如果您需要更多功能/灵活性，请花时间研究 rsync。

由于您在 Windows 上，因此您还可以查看[`xxcopy`](http://www.xxcopy.com/index.htm). 它非常适合这种东西和其他许多东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T10:22:04.293

你也可以使用**xcopy**命令，就像在这个例子中一样（old 是一个目录）：

```
xcopy cvs_src\*.jpg old /e/i/h/y/d/exclude:files_to_exclude 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-19T17:11:07.517

感谢 XCOPY 解决方案，它解决了我的类似问题，所以我想我会为其他需要它的人分享详细信息。

我想要一个目录（和子目录）中不属于特定类型的所有文件的列表（不是副本），例如 *.jpg。但是 DIR 命令没有排除功能。所以我：

1.  创建了一个名为 exclist.txt 的文件，其中包含一行“.jpg”
2.  运行命令“xcopy c:\files c:\test /exclude:exclist.txt /l /d /e /h /i /y > found.txt”
3.  在记事本中打开 found.txt 以查看非 jpg 文件的列表

注意 XCOPY /l 参数，它列出了要复制的文件而不复制它们。由于 XCOPY 在“列表模式”下执行，因此不会创建目标文件夹 c:\test，也不会复制任何文件。"> found.txt" 将 XCOPY 命令的输出保存到文件 found.txt，而不是在屏幕上显示结果。

# math - 如何仅使用斜边找到直角三角形的反正切？

> ID：583296
> 
> 赞同：2
> 
> 时间：2009-02-24T19:52:05.697
> 
> 标签：math, trigonometry, hypotenuse

好的，所以我需要让 C 走从 A 到 B 的最短路径。A 到 B 是我的直角三角形的斜边，我需要给 C 所述三角形的反正切值。我该怎么做，公式有名字吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T20:00:44.100

目前尚不清楚您在问什么，但我认为您正在尝试找到 AB 线的角度。我将假设您知道，或者可以计算出 A 和 B 的 (x,y) 坐标，否则您将无法解决问题。

听起来您已经概述了解决方案的大部分内容……角度将等于（y/x）距离的反正切值。因此，如果我们将 A(y) 视为 A 的 y 坐标，那么您将看到类似以下内容：

```
arctan ((A(y) - B(y)) / (A(x) - B(x))) 
```

这有帮助吗？或者你在寻找一些稍微不同的东西？

编辑：要注意的一件事是您考虑条款的顺序（无论您是从 A 到 B 还是反之亦然）等。您必须对此深思熟虑，否则您可能会得到一些迹象问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T20:15:44.797

大多数系统都有`Arctan2(dy, dx)`它给你一个完整的圆的角度（并照顾垂直），所以你会说`Arctan2((By - Ay), (Bx - Ax))`以弧度（从东逆时针）获得方向。对于度数乘以`360/(2*PI)`。

只要确保 A != B。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T19:58:02.827

Arctan 会导致度数或弧度，因此您的 A 和 B 很可能具有像 (x, y) 这样的坐标。然后你做 arctan((By - Ay) / (Bx - Ax)) 如果我没记错的话，这里 Bx 是 B 等的 x 坐标。

如果 A 和 B 没有坐标，则无法有意义地获取度数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T20:06:00.157

如果你只有一个*长度*并且这里没有隐藏的假设（比如说，三角形的一侧已经标准化）：**你不能**。

一个有趣的隐藏假设可能是：

*   所有距离都是整数
*   三角形至少和它一样长。

那么问题就很难了。

* * *

如果`A`和`B`是点，那么你想要的角度可能是 x 轴的角度，你可以通过（使用 fortranish 名称）得到它：

```
atan((B.y - A.y)/(B.x - A.x)) 
```

或者如果你的图书馆里有它

```
atan2((B.y - A.y),(B.x - A.x)) 
```

它巧妙地处理除以零的情况......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T20:03:59.647

如果 A 到 B 是直角三角形的斜边，那么 A 到 B 也将是从 A 到 B 的最短路径，因为它是两点之间的直线。

您可以通过将相邻边的长度除以对边的长度来计算任一非直角的反正切，因为它是切线的倒数。但是，根据您所描述的信息，您将缺少分子或分母。

有无限数量的直角三角形具有给定长度的斜边。

# apache-flex - 使用 MP4 编码在 Flash 中流式传输网络摄像头视频

> ID：583306
> 
> 赞同：3
> 
> 时间：2009-02-24T19:54:56.580
> 
> 标签：apache-flex, actionscript-3, video, mp4

我正在开发的 Flash 应用程序的功能之一是能够将网络摄像头传输给其他人。我们只是在 Flash 中使用内置的网络摄像头支持并通过 FMS 发送它。

我们已经有人要求更高质量的视频，但我们已经在 Flash 中使用了最高质量设置（将质量设置为 100%）。

我的理解是，在较新的 Flash 播放器中，他们为视频添加了对 MPEG-4 编码的支持。我创建了一个简单的测试 Flex 应用程序来尝试比较 MP4 与 FLV 编码的视频质量。但是，我似乎根本无法让 MP4 工作。

根据[Flex 文档](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/net/NetStream.html#publish())，要使用 MP4 而不是 FLV，我唯一需要做的就是在调用发布时将“mp4:”添加到流的名称中：

> 将流名称指定为前缀为 mp4: 的字符串，带或不带文件扩展名。前缀向服务器表明该文件包含 MPEG-4 Part 14 容器格式中的 H.264 编码视频和 AAC 编码音频。

当我尝试这个时，没有任何反应。我没有在客户端引发任何事件，没有抛出异常，并且我在服务器端的日志记录没有显示任何流开始。

以下是相关代码：

```
// These are all defined and created within the class.
private var nc:NetConnection;
private var sharing:Boolean;
private var pubStream:NetStream;
private var format:String;
private var streamName:String;
private var camera:Camera;

// called when the user clicks the start button
private function startSharing():void {
  if (!nc.connected) {
    return;
  }

  if (sharing) { return; }

  if(pubStream == null) {
    pubStream = new NetStream(nc);
    pubStream.attachCamera(camera);
  }
  startPublish();

  sharing = true;
}

private function startPublish():void {
  var name:String;

  if (this.format == "mp4") {
    name = "mp4:" + streamName;
  } else {
    name = streamName;
  }

  //pubStream.publish(name, "live");
  pubStream.publish(name, "record");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T00:29:04.423

了解您正在运行的 FMS 版本会有所帮助吗？看来您至少需要 FMS 3.0.2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T22:18:56.000

您确定这适用于实时流，而不仅适用于录制吗？这[1](http://forums.adobe.com/message/612438#612438) [2 个](http://forums.adobe.com/message/494055#494055)链接表明，虽然播放器可以**解码**sorenson、vp6 和 h264，但它只能在**sorenson**中编码。

我也有类似的情况，所以我想澄清一下。

编辑：实际上让我怀疑的是文档说flv和mp4，它们不是编解码器而是容器，实时流不使用容器，编码帧直接在rtmp数据包中传播

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-25T10:59:44.550

Flash Player 不使用 H.264 进行编码，但 Flash Media Server 可以在 F4V 容器中录制任何编解码器。Flash Media Live Encoder 可以使用 H.264 进行编码。

所以基本上你不能从网络 Flash 播放器发送 h264（但是？）......

# asp.net - ASP.NET 错误处理

> ID：583307
> 
> 赞同：10
> 
> 时间：2009-02-24T19:54:57.187
> 
> 标签：asp.net, error-handling

在我的 asp.net 应用程序中，我通常使用 Application_Error 全局事件处理程序来记录错误并将用户重定向到用户友好的错误页面。

然而，我读过关于[ELMAH](http://code.google.com/p/elmah/)的文章，虽然这看起来很有趣，但 Application_Error 似乎是更简单的方法。

我读过其他问题，包括我自己在内的人们提出了一种或另一种方法。我想知道的是，使用一个比另一个有什么显着的好处，为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T19:59:29.220

Elmah 是一个很棒的项目，我们将它用于我们所有的 ASP.NET 应用程序。它不仅为您记录未处理的错误，它还抓取用户看到的整个*原始*页面，其中包含很多细节。

它具有电子邮件支持、RSS 提要（逐项和摘要）并具有有吸引力的控制台。

对于配置中的 3 行和一个 dll 参考，我会说这是一个灌篮高手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T21:00:40.773

我猜 ELMAH 的主要缺点是它可能对你需要的东西来说太过分了。如果它记录和存储的信息比您在自己的实现中更多，那么在存储和处理中这是不必要的开销。您还需要考虑如何保护对 ELMAH 控制台的访问，因为这些异常详细信息可能包含您的应用程序的大量详细信息（这并不难，但这是您以前没有的担忧）。

另一方面，一旦您确定某些顽固的错误需要它，您自己的实现可能会增长以记录所有额外信息，并且您真的关心将错误页面所需的时间缩短几分之一秒显示？很有可能您最终会构建自己的 ELMAH 版本，所以为什么不直接使用 ELMAH 并节省自己的时间。

我建议如果您确实想编写自己的错误日志记录而不是使用 ELMAH，那么您至少将它放在一个模块中，而不是直接放入 global.asax 中的 Application_Error 中。只需在模块的 Init 方法中订阅应用程序的错误事件，您就可以通过 web.config 中的一行轻松地在另一个应用程序中重用您的错误处理代码。

我还发现通过 ASP.NET 的运行状况监视处理任何异常日志记录很有用。这使得在 web.config 中控制日志记录的类型和级别变得容易，并且还允许记录在 try...catch 中处理的异常，而不会到达 Application_Error。创建一个扩展 WebRequestErrorEvent 的自定义 HandledExceptionEvent 类，您可以在任何您想知道是否已发生异常的 catch 块中创建和引发这些事件，即使它已被处理。

# django - 具有来自同一个表的 2 个外键的 Django 模型

> ID：583327
> 
> 赞同：60
> 
> 时间：2009-02-24T20:00:11.560
> 
> 标签：django, foreign-keys, ambiguity

我想要一个 Django 模型，它具有来自同一个表的 2 个外键。这是一个事件表，有 2 列供员工使用：“演员”和“接收者”。但我得到这个错误：

> 错误：一个或多个模型未验证：tasks.task：中间模型 TaskEvent 对 Employee 有多个外键，这是不明确且不允许的。

有没有更好的方法来建模这个？

我想我要添加一个`TaskEvent_to_Employee`表。其中将有两条记录，一条用于与每个 相关的两名员工中的每一个`TaskEvent`。有谁知道更简单的解决方法？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-02-24T20:03:41.957

我还没有这样做，但是我使用**了 inspectdb**从一个现有的数据库生成 models.py 文件，这正是这个数据库 - 这是 inspectdb 退回的，所以它应该可以工作：

```
creator = models.ForeignKey(Users, null=True, related_name='creator')
assignee = models.ForeignKey(Users, null=True, related_name='assignee') 
```

希望这对你有用——如果不是，我也会有问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-25T08:02:29.810

我认为您正在寻找的是 ForeignKeyFields 上的 related_name 属性。这将允许您引用同一个表，但为关系赋予 django 特殊名称。

更多信息：

*   [https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey.related_name](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey.related_name)
*   [https://docs.djangoproject.com/en/dev/topics/db/queries/#backwards-related-objects](https://docs.djangoproject.com/en/dev/topics/db/queries/#backwards-related-objects)
*   [https://docs.djangoproject.com/en/dev/topics/db/examples/many_to_one/](https://docs.djangoproject.com/en/dev/topics/db/examples/many_to_one/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-25T11:17:11.697

从错误消息中，听起来您正试图将两个外键放在通过`through`参数 to使用的中间表上的同一个对象上`ManyToManyField`，其中的[文档指出](http://docs.djangoproject.com/en/dev/topics/db/models/#extra-fields-on-many-to-many-relationships)：

> 设置中间模型时，您明确指定多对多关系中涉及的模型的外键。这个明确的声明定义了这两个模型是如何相关的。
> 
> 中间模型有一些限制：
> 
> *   您的中间模型必须包含一个 - 并且只有一个 - 目标模型的外键（在我们的示例中是 Person）。如果您有多个外键，则会引发验证错误。
> *   您的中间模型必须包含一个 - 并且只有一个 - 源模型的外键（在我们的示例中为 Group）。如果您有多个外键，则会引发验证错误。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-11-20T04:37:35.160

使用[related_name](https://docs.djangoproject.com/en/2.1/ref/models/fields/#django.db.models.ForeignKey.related_name)是我的解决方案：

```
class Sample(models.model):
    ...

class Mymodel(models.model):
    example1 = models.ForeignKey(Sample, related_name='sample1')
    example2 = models.ForeignKey(Sample, related_name='sample2') 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-02-24T20:19:46.893

两列是一个表的一部分这一事实意味着这两个字段是相关的，因此单独引用它们并不理想。您的模型的 ForeignKey 应该是您引用的表的主键：

```
event = models.ForeignKey('event') 
```

然后，您将像这样引用这些列：

```
foo.event.actor
foo.event.receiver 
```

如果您希望您还可以更改您的类/模型引用具有属性的外部属性的方式。在您的课堂上，您将执行以下操作：

```
@property
def actor(self):
  return self.event.actor
@property
def receiver(self):
  return self.event.receiver 
```

这将允许您然后调用 foo.actor 和 foo.receiver 但我相信更长的 foo.event.actor 会更pythonic

# tfs - 如何从 SourceGear Vault 迁移到 TFS？

> ID：583331
> 
> 赞同：7
> 
> 时间：2009-02-24T20:00:25.210
> 
> 标签：tfs, sourcegear-vault, tfs-migration

是否有任何简单的方法可以将文件版本从 SourceGear Vault 迁移到 TFS？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T20:26:58.063

并不真地。TFS 在导入历史方面不太好。

从好的方面来说，这是您重新排列源代码树的机会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T15:10:19.303

MS have created a [toolkit](http://migrationsynctoolkit.codeplex.com/) for creating import and export tools.

But a [quick search](http://www.google.com/search?q=tfs+vault+import&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-GB:official&client=firefox-a) doesn't show (in the first few hits) anyone who has done the hard work.

Another option is to import current state (just perform a TF add into an Import branch ad then branch into your working project), and keep Vault around for when you need to look at history.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-24T12:17:58.520

以我的经验，只有一条“艰难的道路”。我通过 Git 将公司中的所有源代码从 Vault 7 迁移到 Team Foundation Version Control 2015。所以简短的回答是“不”。

[如果有人对不简单的方法感兴趣，我们使用https://github.com/tomaskovarik/chalk](https://github.com/tomaskovarik/chalk) 和 [https://github.com/git-tfs/git-tfs](https://github.com/git-tfs/git-tfs)从 Vault 迁移到 Git 到 TFVC

# php - 如何使用 LIKE 语句创建 PDO 参数化查询？

> ID：583336
> 
> 赞同：120
> 
> 时间：2009-02-24T20:01:59.213
> 
> 标签：php, pdo

这是我的尝试：

```
$query = $database->prepare('SELECT * FROM table WHERE column LIKE "?%"');

$query->execute(array('value'));

while ($results = $query->fetch()) 
{
    echo $results['column'];
} 
```

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-02-24T20:04:19.240

发帖后马上想通了：

```
$query = $database->prepare('SELECT * FROM table WHERE column LIKE ?');
$query->execute(array('value%'));

while ($results = $query->fetch())
{
    echo $results['column'];
} 
```

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2011-09-09T04:54:27.243

对于那些使用命名参数的人，这里是如何使用**MySQL 数据库**`LIKE`的`%`部分匹配：

```
WHERE column_name LIKE CONCAT('%', :dangerousstring, '%')
```

**其中命名参数是`:dangerousstring`.**

 **换句话说，`%`在您自己的查询中使用明确的非转义符号，这些符号是分开的，绝对不是用户输入。

**编辑：****Oracle 数据库**的连接语法使用连接运算符：`||`，所以它会简单地变成：

```
WHERE column_name LIKE '%' || :危险字符串 || '%'
```

但是，@bobince[在这里](https://stackoverflow.com/questions/4015198/how-to-do-like-search-with-pdo)提到了一些警告：

> 当 您想在搜索字符串中允许文字或字符而不将其用作通配符时，[困难就来了。](https://stackoverflow.com/questions/2106207/escape-sql-like-value-for-postgres-with-psycopg2/2106443#2106443)`%``_`

因此，在组合 like 和参数化时，这是需要注意的其他事情。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-09-14T16:54:02.757

```
$query = $database->prepare('SELECT * FROM table WHERE column LIKE ?');
$query->bindValue(1, "%$value%", PDO::PARAM_STR);
$query->execute();

if (!$query->rowCount() == 0) 
{
    while ($results = $query->fetch()) 
    {
        echo $results['column'] . "<br />\n";
    }       
} 
else 
{
    echo 'Nothing found';
} 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2015-08-05T11:10:53.000

你也可以试试这个。我面临类似的问题，但经过研究得到了结果。

```
$query = $pdo_connection->prepare('SELECT * FROM table WHERE column LIKE :search');

$stmt= $pdo_connection->prepare($query);

$stmt->execute(array(':search' => '%'.$search_term.'%'));

$result = $stmt->fetchAll(PDO::FETCH_ASSOC);

print_r($result); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-01-30T14:59:44.513

这有效：

```
search `table` where `column` like concat('%', :column, '%') 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-07-15T13:16:24.807

我从[php 妄想中得到了这个](https://phpdelusions.net/pdo#like)

```
$search = "%$search%";
$stmt  = $pdo->prepare("SELECT * FROM table WHERE name LIKE ?");
$stmt->execute([$search]);
$data = $stmt->fetchAll(); 
```

它对我有用，非常简单。就像他说的那样，在将其发送到查询之前，您必须“首先准备我们的完整文字”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-27T00:39:12.647

**PDO 转义“%”（可能导致 sql 注入）**：使用前面的代码会在查找匹配部分字符串时给出期望的结果，**但是**如果访问者键入字符“%”，即使你不这样做，你仍然会得到结果'没有任何东西存储在数据库中（它可能导致 sql 注入）

我已经尝试了很多变体，所有结果都相同 PDO 正在转义“%”导致不需要/不兴奋的搜索结果。

我认为如果有人在它周围找到了一个词，它是值得分享的，请分享它

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-02-02T17:58:48.007

我有类似的需求，但正在使用从表单中获取的变量。我这样做是为了使用 PHP 从我的 PostgreSQL 数据库中获取结果：

```
<?php
     $player = $_POST['search'];  //variable from my search form
     $find = $sqlPDO->prepare("SELECT player FROM salaries WHERE player ILIKE ?;");
     $find->execute(['%'.$player.'%']);

     while ($row = $find->fetch()) {
         echo $row['player']."</br>";
     }
?> 
```

“ILIKE”使搜索不区分大小写，因此搜索购物车或购物车或购物车都将返回相同的结果。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2022-01-17T01:26:24.663

我可以让它工作的唯一方法是将 %$search% 放入另一个变量中。

```
 if(isset($_POST['submit-search'])){
         $search = $_POST['search'];
   }

        $query = 'SELECT * FROM posts WHERE post_title LIKE :search';
        $value ="%$search%";
        $stmt= $pdo->prepare($query);

        $stmt->execute(array(':search' => $value)); 
```

我不知道这是否是最好的方法，在我使用的 while 循环中：

```
while ($r = $stmt->fetch(PDO::FETCH_ASSOC)){ 
```

# design-patterns - 对对象进行版本控制有哪些设计模式？

> ID：583342
> 
> 赞同：8
> 
> 时间：2009-02-24T20:03:31.910
> 
> 标签：design-patterns, version-control, event-sourcing, memento

有哪些设计模式可以在对象更改时保留其历史记录。我不需要像[事件溯源](http://martinfowler.com/eaaDev/EventSourcing.html)那样繁重的任务，只需要在特定事件发生时保存过去版本的能力（在这种情况下，当按下打印表单按钮时）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T20:05:55.460

你可以寻找 [纪念品图案](http://en.wikipedia.org/wiki/Memento_Pattern)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T20:06:21.793

这听起来与跟踪撤消信息是同构的。通常的模式是命令模式的一种变体：您按照先前状态的时间顺序保留一个队列，并执行恢复到先前状态的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-02T14:54:26.897

我建议你看看 Martin Fowler 的时间模式： http: [//www.martinfowler.com/eaaDev/timeNarrative.html](http://www.martinfowler.com/eaaDev/timeNarrative.html)

# asp.net - 通过 IIS 6.0 映射所有请求的通配符对性能有何影响？

> ID：583347
> 
> 赞同：0
> 
> 时间：2009-02-24T20:04:00.880
> 
> 标签：asp.net, iis, iis-6, url-rewriting

我对使用[UrlRewriter.NET很感兴趣，并在 Win2k3 上的 IIS 6.0 的](http://urlrewriter.net/)[配置页面](http://urlrewriter.net/index.php/support/installation/windows-server-2003)中注意到，他们说通过 ASP.NET ISAPI 映射所有请求。

没关系，但我想知道是否有人对这种表现有好的或坏的评价？我的网络服务器是否会因为这样做而被拖垮，还是会增加服务器负载的一小步？

我的服务器现在有喘息的空间，所以一些性能下降是可以接受的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T21:28:55.043

通配符映射确实对性能有很大的影响，主要是因为它使用应用程序线程池不是用于页面请求处理，而是用于所有内容。假设您有一个通常的页面，其中至少包含 10 个附加资源，例如图像、css 和 javascript - 然后您通过直接从池中提供静态内容来阻止其他潜在请求。更多关于 asp.net IIS 6 线程的信息可以在[这里](http://msdn.microsoft.com/en-us/library/ms998549.aspx#scalenetchapt06_topic8)找到。

解决它的一种方法（我是如何做到的）是无法将通配符映射到保存静态内容的文件夹 - 之后您将只收到有效的应用程序请求，就像在普通情况下所做的那样。

取消映射静态目录的方法是为每个静态目录创建一个应用程序，然后进行取消映射，然后撤消创建应用程序的事情。[您可以在Steve Sanderson 的博客](http://blog.codeville.net/2008/07/07/overriding-iis6-wildcard-maps-on-individual-directories/)上找到更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T20:12:05.977

据此： http: [//mvolo.com/blogs/serverside/archive/2006/11/10/Stopping-hot_2D00_linking-with-IIS-and-ASP.NET.aspx](http://mvolo.com/blogs/serverside/archive/2006/11/10/Stopping-hot_2D00_linking-with-IIS-and-ASP.NET.aspx) ...我们正在谈论30％的影响用于提供图像的资源。

**更新 1：**这将取决于您拥有的动态与静态内容的数量。如果您有足够的备用容量，您可以打开它并密切关注性能影响。如果它开始退化太多，你可以把它关掉。之后，您可以放心地进行无扩展更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-07T00:28:38.877

也许看看[IIS 6.0 通配符映射基准？](https://stackoverflow.com/questions/323325/iis-6-0-wildcard-mapping-benchmarks)

它似乎显示了我多年来在野外所经历的 - 使用 ASPNet dll 时的开销可以忽略不计。如果你有足够的流量让它成为一个问题，那么在它成为 ASPNet dll 之前，将会有一百个导致更大瓶颈的东西

# xcode - OS X 上没有 Xcode 的 GCC

> ID：583360
> 
> 赞同：10
> 
> 时间：2009-02-24T20:08:37.170
> 
> 标签：xcode, macos, gcc

我刚刚打开了我的新 MacBook Pro（*耶*！），现在正在正确设置它以进行开发。由于我想避免混乱，我想知道我是否真的需要安装 Xcode 工具（我从不使用 IDE 或 Mac 特定工具），因为无论如何我都会使用[MacPorts](http://www.macports.org/)安装更新版本的 GCC 。

那么，安装 Xcode 有什么好处吗？有必要吗？它在幕后做了什么样的设置？基本上：**我可以跳过这个还是因为一些 Unix 开发工具只是假设 OS X 总是以这种方式设置，所以它会回来困扰我吗？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-24T20:20:41.960

为了执行简单且成功的 MacPorts 安装，已经有来自 xCode 安装程序的工具是必要的。您只需要将 unix/header 文件的副本放置在 xcode 之外的安装选项；其他一切都可以保持卸载。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-08-17T15:32:48.683

我的一个朋友最近发布了这个：

[https://github.com/kennethreitz/osx-gcc-installer](https://github.com/kennethreitz/osx-gcc-installer)

玩得开心 ：）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-24T20:13:44.053

我尝试了这个技巧，我一直在寻找丢失的头文件等。只需安装 XCode。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T20:13:43.163

我们主要使用 Xcode IDE 来构建 Cocoa/Carbon 应用程序。Xcode 通常有不同的项目模板（并且项目设置相应地固定）。只要您不打算生成通用二进制文件或框架，我认为您应该没问题。就我而言，当我对 Xcode 太生气时，我会回到命令行，自己设置路径并开始使用 GDB。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T20:14:30.730

首先，祝贺新的 MBP。我最近自己买了一个 15" 一体成型的。=)

您可以安全地跳过 Xcode 安装，并且您可以通过 MacPorts 安装 Xcode 安装的几乎所有东西，当然，除了 Xcode 本身。

不过，我相信总有一天你会发现自己安装了 Xcode，而且安装 Xcode 比通过 MacPorts 安装所有工具（尤其是 GCC）要容易得多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T02:17:53.123

您可以大量减少 Xcode 安装 - 当您安装 Xcode 时，有一个“自定义”按钮，您可以在其中删除很多东西（价值千兆字节）。

您也可以从中删除内容`/Developer/`，例如 10.3 SDK 大约 150MB（我认为），如果您不是为此编写软件，删除它是非常安全的。显然删除时要小心，但如果你破坏了东西，你总是可以重新安装开发者工具！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-14T00:41:32.940

Apple 现在提供命令行工具作为 Xcode 的单独下载。他们与 Lion 和 Mountain Lion 合作。您可以[从 Apple Developer Center 下载它们](https://developer.apple.com/downloads/index.action)。

（这[在 osx-gcc-installer GitHub 页面上](https://github.com/kennethreitz/osx-gcc-installer)有说明。）

# c# - C# 事件订阅

> ID：583366
> 
> 赞同：1
> 
> 时间：2009-02-24T20:10:12.610
> 
> 标签：c#, events, language-features

在C#中有什么优势

```
public class blah
{

       public event EventHandler Blahevent;

} 
```

相对

```
public class blah
{

      private event EventHandler blahevent;

      public event EventHandler Blahevent
      {
          add
              {
                  blahevent+=value;
              } 
              remove
              {
                  blahevent-=value
              }
      }

} 
```

或相反亦然。

第一个是否打开了 blahinstance.Blahevent = null 或 blahinstance.Blahevent(obj,even)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T20:14:02.337

除非您想做不同的事情，否则显式实现 add/remove 方法没有任何好处。可能的原因：

*   也许自己控制事件支持代码（例如直接链接到其他事件而不是通过毫无意义的级联）
*   在添加或删除时做其他事情
*   更改添加或删除的安全要求
*   暴露底层委托

默认实现所做的是维护一个私有隐藏委托字段，每次添加或删除委托时都会替换该字段。在大多数情况下，不需要执行上述任何操作，但灵活性是存在的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T20:12:58.767

如果除了添加或删除指针之外还需要运行特定逻辑，则第二个选项可以精确控制订阅或取消订阅指定事件时发生的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T20:25:10.000

您可以使用私有字段上的 [field: NonSerialized()] 属性从序列化中排除委托。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T21:50:00.763

您可以在后者上放置断点以进行调试。有时这可能*非常*有用（尽管在调试后我将其切换回前者）。

# c# - 使用 Linq 还是不使用 Linq - 哪个版本更漂亮？

> ID：583369
> 
> 赞同：2
> 
> 时间：2009-02-24T20:11:32.640
> 
> 标签：c#, linq

我刚刚写了以下函数：

```
public string Ebnf {
    get {
        var props = GetType().GetProperties(BindingFlags.Public | BindingFlags.Instance);
        var ruleProps = from p in props where p.PropertyType.IsSubclassOf(typeof(ARule)) select p;
        var rules = from p in ruleProps select (ARule)p.GetValue(this, null);
        var ebnfs = from r in rules select r.Name + " = " + r.Ebnf + ".";
        return string.Join("\n", ebnfs.ToArray());
    }
} 
```

我开始怀疑 Linq 是否真的为我节省了空间，或者我是否只是为了它而使用 Linq：

```
public string EbnfNonLinq {
    get {
        var ebnfs = new List<string>();
        var props = GetType().GetProperties(BindingFlags.Public | BindingFlags.Instance);
        foreach (var p in props) {
            if (p.PropertyType.IsSubclassOf(typeof(ARule))) {
                var r = (ARule)p.GetValue(this, null);
                ebnfs.Add(r.Name + " = " + r.Ebnf + ".");
            }
        }
        return string.Join("\n", ebnfs.ToArray());
    }
} 
```

7 行代码与 5 行代码：这是一种节省。但是不知道第一个函数的密度是不是太大了。（这不是性能关键代码，所以我不担心。）

您认为哪个更漂亮、更易于维护、更易于理解、更好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T20:20:01.153

蓬松的语法是蓬松的。简洁的语法很简洁。

```
public string Ebnf
{
get {
    var props = GetType().GetProperties(BindingFlags.Public | BindingFlags.Instance);
    string[] ebnfs = props
      .Where(prop => prop.PropertyType.IsSubclassOf(typeof(ARule)))
      .Select(prop => (ARule)prop.GetValue(this, null))
      .Select(rule => rule.Name + " = " + rule.Ebnf + ".")
      .ToArray();
    return string.Join("\n", ebnfs);
}
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T20:20:18.937

我比较喜欢第一个。我认为 linq 更漂亮，但可能会通过一次获得整个名称使其成为最漂亮的。如果可能的话，这样的事情：

```
var ebnfs = from p in props 
            where p.PropertyType.IsSubclassOf(typeof(ARule)) 
            let rule = (ARule)p.GetValue(this, null)
            select rule.Name + " = " + rule.Ebnf + ".";

 return String.Join(",", ebnfs.ToArray()); 
```

^^ 警告，未经测试:)

我不喜欢使用 .Where 或 .Select 太多，所以我坚持使用裸 linq 并且真的只是在它是我对集合做的唯一事情时使用它们。

正如评论者指出的那样，在某些情况下，这确实使调试变得更加困难。但是，如果 rule.Name/Ebnf 中不太可能发生奇怪的事情，那么这可能不会是一个大问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T20:19:50.233

我发现非 linq 版本更具可读性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T20:20:51.040

我喜欢 LINQ 版本，因为它清楚地表明了您要完成的工作。每行仅依赖于它之前的行，而不依赖于其他行。

但是有一条评论，您可能希望逐行执行它们。现在，您的每个变量都是一个查询，直到最后一行才会执行。这意味着追踪错误可能比必要的更难。

我提出的改变是在每个查询之后简单地添加 ToList。这会立即执行。

```
 var props = GetType().GetProperties(BindingFlags.Public | BindingFlags.Instance);
    var ruleProps = (from p in props where p.PropertyType.IsSubclassOf(typeof(ARule)) select p).ToList();
    var rules = (from p in ruleProps select (ARule)p.GetValue(this, null)).ToList();
    var ebnfs = (from r in rules select r.Name + " = " + r.Ebnf + ".").ToList();
    return string.Join("\n", ebnfs.ToArray()); 
```

优点：更容易调试。您可以重复使用结果而无需重新运行查询。缺点：如果您使用 where 子句，坚持原始查询有时会更快。

# tsql - 将 LineString 添加到 MultiLineString

> ID：583383
> 
> 赞同：1
> 
> 时间：2009-02-24T20:15:39.040
> 
> 标签：tsql, sql-server-2008, spatial

使用 SQLServer 2008，我试图将两个 LineStrings 转换为多个 LineStrings（最好是 MultiLineStrings），方法是根据彼此部分拆分它们。

```
L1 |---------------|
L2 |----|

= |----|----|-----|

```

笼统地思考，我可以通过使用 L1.STIntersection(L2) 来获得中心部分。我可以使用 L1.STSymDifference(Intersection) 获得的另外两个部分。最后两个部分作为 MultiLineString 返回。

如何将第一个中心部分添加到此 MultiLineString？

使用 STUnion 将产生一个合并的 LineString，如 L1。也许这就是问题所在，可以合并的 MultiLineStrings 应该总是被合并？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-16T16:54:29.370

我在 SQL Server 2008 中找不到任何可以完成此任务的函数，但我对 SQL Server 2008 sql 函数也比较陌生。

在处理 SQL Server 2008 时，我通常会查看 PostGIS 论坛和电子邮件列表，看看它是如何完成的（PostgreSQL-PostGIS 已经在这方面的时间更长了）。有人似乎有与此[相反的问题](http://www.nabble.com/Merging-2-Linestring-to-get-another-Linestring-td14715406.html)，这似乎是您所追求的结果。

不幸的是，没有 ST_LineMerge（或 STLineMerge），所以你可能需要自己动手。

我不确定这些示例是否适用于所有情况（并且线串本身不是按顺序排列的）：

```
select geometry::STGeomFromText(Replace(@g2.STSymDifference(@g1).ToString(),'))','),' + Replace(@g1.STIntersection(@g2).ToString(),'LINESTRING','') + ')'), @g1.STSrid).STAsText() 
```

这是与实际线串数据相同的逻辑：

```
DECLARE @g1 geometry;
DECLARE @g2 geometry;
DECLARE @g3 geometry;

SET @g1 = geometry::STGeomFromText('LINESTRING(0 0, 0 20)', 0);
SET @g2 = geometry::STGeomFromText('LINESTRING(0 5, 0 10)', 0);

SELECT @g1.STIntersection(@g2).ToString();

SELECT @g1.STIntersection(@g2).STAsText();

SELECT @g2.STSymDifference(@g1).ToString();

select @g1.STIntersection(@g2).ToString();

SET @g3 = geometry::STGeomFromText(Replace(@g2.STSymDifference(@g1).ToString(),'))','),' + Replace(@g1.STIntersection(@g2).ToString(),'LINESTRING','') + ')'), @g1.STSrid);

select @g3.STAsText(); 
```

# c# - 如何检查C#中是否存在数组？

> ID：583384
> 
> 赞同：1
> 
> 时间：2009-02-24T20:15:39.150
> 
> 标签：c#, arrays

有什么方法可以检查数组是否存在或在特定元素中是否有值？

我有这行代码

```
if (rummen[positionX, positionY].Levandesaker[0].alive == true) 
```

只要它存在，它就可以正常工作。但我想做的是

```
if (rummen[positionX, positionY].Levandesaker != null)
{
    if (rummen[positionX, positionY].Levandesaker[0].alive == true)
    {
    }
} 
```

有谁知道我在寻找什么或者可以帮助我寻找什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T20:18:48.223

```
if (rummen[positionX, positionY].Levandesaker != null &&
    rummen[positionX, positionY].Levandesaker.Count > 0)
{
    if (rummen[positionX, positionY].Levandesaker[0].alive == true)
    {
    }
} 
```

我现在不完全确定您在谈论哪个阵列。你指的是 Levandesaker 还是 rummen？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T20:19:25.083

我希望我正确地解释了这个问题！

数组的大小是恒定的，并且包含从 0 到数组上限的每个索引的值。

因此，要检查数组中的某个位置是否存在，您只需确保它小于上限即可。像这样的东西应该绝对涵盖所有条件（假设 rummen 本身不为空！）：

```
// make sure rummen contains the [positionX, positionY] element
if(rummen.GetUpperBound(0) > positionX && rummen.GetUpperBound(1) > positionY)
{
    if(rummen[positionX, positionY].Levandesaker != null)
    {
        // make sure Levandsaker contains at least one element
        if(rummen[positionX, positionY].Levandsaker.Length > 0)
        {
            if(rummen[positionX, positionY].Levandesaker[0].alive == true)
            {
            }
        }
    }
} 
```

编辑：抱歉，修复了 C# 特定的语法。出于演示目的，还添加了对 Levandsaker 的检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T20:29:51.440

如果要检查某物是否为数组，请检查 Array 类型：

```
if (rummen[positionX, positionY].Levandesaker is Array) { ... } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T20:23:22.003

数组方面无关紧要（您的代码已经假定该条目不为空）

我假设如下：

```
public class Rummen
{
    public property Levandesaker { get; }
}

public class Levandesaker
{
    public bool alive
} 
```

它可以让你做：

```
public static bool LevandesakerExistsAndAlive(this Rummen r)
{
    return (r.Levandesaker != null && r.Levandesaker.alive);     
}

if (rummen[positionX, positionY].LevandesakerExistsAndAlive())
{
} 
```

请注意，这假设您不控制 Rummen 类（否则您可以简单地将其设为实例方法或属性并完成）

# user-interface - 是否可以在代码中生成 Crystal 报表的小预览或缩略图？

> ID：583389
> 
> 赞同：1
> 
> 时间：2009-02-24T20:17:02.033
> 
> 标签：user-interface, crystal-reports, thumbnails, preview

我正在使用 Crystal 在我的项目中显示报告，并且我希望能够在用户从我的 UI 中选择要显示的报告时向用户显示报告的小预览或缩略图图像。有没有办法从代码中动态生成这些缩略图？

用户可以选择通过在报告文件夹中添加或删除报告来添加或删除报告，因此仅手动制作所有缩略图并不是一个真正的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-27T19:30:13.600

我使用 DSOFile 对象获取报告中的缩略图，然后使用 AxHost 将返回的对象转换为我可以显示的图像。这不是我想要的解决方案，但 DSOFile 是可自由分发的，所以我想这将有效，直到我找到更好的东西。

1.  [从 Microsoft下载](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=9ba6fac6-520b-4a0a-878a-53ec8300c4c2)并安装 DSOFile DLL。
2.  添加对 **DSO OLE Document Properties Reader 2.1 的引用
3.  代码

这是我的代码，归结为最低限度：

```
 namespace Ibs.Ui.OrderPrint
  {
    public partial class OrderPrintEdit
    {
       public OrderPrintEdit()
       {
        InitializeComponent();
       }

       #region -- reports_SelectedIndexChanged(sender, e) Event Handler --
       private void reports_SelectedIndexChanged(object sender, EventArgs e)
       {
           try
           {
               DSOFile.OleDocumentPropertiesClass oleDocumentPropertiesClass = new DSOFile.OleDocumentPropertiesClass();
               DirectoryInfo reportDirectory = new DirectoryInfo(Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location) + "\\Reports");
               oleDocumentPropertiesClass.Open(reportDirectory + "\\" + reports.Text,true,DSOFile.dsoFileOpenOptions.dsoOptionDontAutoCreate);
               Object thumbnail = oleDocumentPropertiesClass.SummaryProperties.Thumbnail;
               if (thumbnail != null)
               {
                   reportThumbnail.BackgroundImage = IPictureDispHost.GetPictureFromIPicture(thumbnail);
               }
               else
               {
                   reportThumbnail.BackgroundImage = null;
               }
               oleDocumentPropertiesClass.Close(false);
           }
           catch (Exception ex)
           {
           }
       }
       #endregion
   }

   internal sealed class IPictureDispHost : AxHost
   {
       private IPictureDispHost() : base("{63109182-966B-4e3c-A8B2-8BC4A88D221C}")
       {
       }
       /// <summary>
       /// Convert the dispatch interface into an image object.
       /// </summary>
       /// <param name="picture">The picture interface</param>
       /// <returns>An image instance.</returns>
       public new static Image GetPictureFromIPicture(object picture)
       {
           return AxHost.GetPictureFromIPicture(picture);
       }
   } 
```

}

我在表单加载时填充了一个带有报告名称的组合框。在 SelectedIndexChanged 事件中，我从报表中获取 Thumbnail 对象并将其传递给转换方法。这也适用于 Office 文档。

# iphone - 使用 drawRect: 进行自定义渲染时，我是否负责剪辑？

> ID：583391
> 
> 赞同：3
> 
> 时间：2009-02-24T20:17:19.613
> 
> 标签：iphone, cocoa-touch

当我调用`setNeedsDisplayInRect`a`UIView`并且该`drawRect:`方法触发时，我是否有责任确保我不会渲染我调用的 CGRect 之外的内容，或者框架会为我处理这些内容吗？

例子：

```
-(void)drawRect:(CGRect)rect
{
    //assume this is called through someMethod below
    CGContextRef ctx = UIGraphicsGetCurrentContext();      
    [[UIColor redColor] setFill];
    CGContextFillRect(ctx, rect);
    [[UIColor blueColor] setFill];
    // is this following line a no-op? or should I check to make sure the rect
    // I am making is contained within the rect that is passed in?
    CGContextFillRect(ctx, CGRectMake(100.0f, 100.0f, 25.0f, 25.0f));      
}

-(void)someMethod
{
    [self setNeedsDisplayInRect:CGRectMake(50.0f, 50.0f, 25.0f, 25.0f)];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T06:10:08.657

为了简化 Barry 所说的：是的，框架会为您处理它。

您可以放心地忽略矩形，在它之外绘制的任何内容都将被忽略。

另一方面，如果你在矩形之外绘制，你会浪费 CPU 时间，所以如果你可以根据矩形来限制你的绘制，你应该这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T23:54:16.333

该框架将剪辑您的绘图。在 OS X (AppKit) 上，绘图被剪切到 NSView 的脏区域（从 10.3 开始）。我不确定 UIKit 中确切的裁剪算法是什么。当然，您可以通过检查需要绘制的内容并仅在视图的脏区进行绘制来加快绘制速度，而不是依靠框架来裁剪不必要的绘制。

# linux - 如何在 Linux 中添加汇编代码

> ID：583394
> 
> 赞同：2
> 
> 时间：2009-02-24T20:18:20.877
> 
> 标签：linux, assembly, kernel

我正在 Fedora core 6 上编写一个 Linux 内核模块，我想知道是否有人可以告诉我如何将下面显示的汇编代码添加到我的程序中。汇编代码是为 Windows 编写的，我不知道如何转换为 Linux 内核程序。

```
#ifdef _MSC_VER

unsigned char lookKbits(char k)
{
    _asm {
        mov dl, k
        mov cl, 16
        sub cl, dl
        mov eax, [wordval]
        shr eax, cl
    }
}

unsigned char WORD_hi_lo(char byte_high, char byte_low)
{
    _asm {
        mov ah,byte_high
        mov al,byte_low
    }
}

#endif 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T20:28:41.897

[GCC 内联汇编方法](http://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html)

如果您只是在寻找语法：

> 基本内联汇编的格式非常简单。它的基本形式是
> 
> asm("汇编代码");
> 
> 示例：asm("movl %ecx %eax"); /* 将 ecx 的内容移动到 eax */

具体来说，请看[第 3 节](http://www.ibiblio.org/gferg/ldp/GCC-Inline-Assembly-HOWTO.html#s3)，它将 Intel 语法与 AT&T 语法进行了比较。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T20:58:08.923

你试过用C写吗？在我天真的眼中，它看起来不需要在汇编程序中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T20:37:33.590

在内核中，您也可以使用`__asm__`宏，例如参见`include/asm/atomic.h`. [LXR](http://lxr.linux.no)是一个非常好的浏览和搜索 Linux 源代码的站点，你会在那里找到很多示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T20:36:47.010

您要问的是如何在 gcc 中编写内联汇编。gcc 手册的第 5.35 节对此有广泛的信息。然而，对于这个特定的例子，你几乎可以肯定重写这些函数是 C 更好，因为你可能会从编译器中得到比 asm 语句产生的更好的代码......

# .net - 是否存在用于 W3C 标记验证器 API 的 .NET 库？

> ID：583409
> 
> 赞同：3
> 
> 时间：2009-02-24T20:20:18.967
> 
> 标签：.net, api, soap, w3c, w3c-validation

我想验证我的 WPF 应用程序的用户是否将正确的 XHTML 放入其 TextBox 控件中。

我发现有一个用于[W3C Markup Validator的](http://validator.w3.org/)[API](http://validator.w3.org/docs/api.html)。

它的网页说：

> 鼓励构建用于与验证器 API 交互的库。…

它列出了已知的 Perl、PHP/PEAR 和 ColdFusion 库。

有人知道 W3C 标记验证器 API 的 .NET 库吗？是否已经存在？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T20:26:48.373

此 API 基于 SOAP。如果您想在 .net 应用程序中使用它，您只需添加 Web 引用和针对它的代码。看起来很简单，因为它基本上是一个单一方法的 API ......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-25T14:42:45.960

是的，我刚刚写了一篇：[.NET Wrapper for W3C Validator API](https://github.com/trullock/MuonKit.W3cValidationClient)

# c# - 在运行时将 byte[] 加载到 System.Windows.Controls.Image

> ID：583414
> 
> 赞同：2
> 
> 时间：2009-02-24T20:20:55.627
> 
> 标签：c#, wpf, image

我有一个 byte[] 代表一个 .png 文件。我正在通过 WebClient 下载此 .png。当 WebClient 下载了我通过 URL 引用的 .png 时，我得到一个字节 []。我的问题是，如何将 byte[] 加载到 WPF 中的 System.Windows.Controls.Image 元素中？谢谢你。

注意：这是对我在这里提出的问题的补充：[Load a byte[] into an Image at Runtime](https://stackoverflow.com/questions/582805/load-a-byte-into-an-image-at-runtime)。我的原始问题不够具体，但答案仍然相关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T20:28:10.383

使用[PngBitmapDecoder](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.pngbitmapdecoder.aspx)。文档显示了示例用法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T20:26:04.210

除了您在另一个问题上得到的答案之外......应该可以正常工作，您还应该能够创建一个 BitmapImage 对象并将 UriSource 设置为 Web URI，而不是使用 Web 客户端，然后将 Image.Source 设置为位图图像..[看这个](http://msdn.microsoft.com/en-us/library/system.windows.controls.image.aspx)

# asp.net - memcached 是否具有重新分配其缓存的机制？

> ID：583417
> 
> 赞同：2
> 
> 时间：2009-02-24T20:21:40.570
> 
> 标签：asp.net, memcached

问题：我有一个服务器场，它使用非粘性 IP 和一个会话服务器来维护所有服务器的会话。所以客户端返回到哪个服务器并不重要，因为服务器总是会去会话服务器获取客户端的会话数据。当我关闭会话服务器时，所有服务器都会丢失它们的会话数据。

此问题的解决方案之一是使用 SQL Server 作为会话服务器。不幸的是，这是不可能的。

所以我在考虑 Memcached。如果我使用 memcached 管理我的会话，我仍然会遇到如果我关闭其中一个 memcached 服务器会丢失会话的问题。但是，如果我可以对该服务器发出调用“将您的缓存重新分配到其他服务器”的调用，那么这应该可以解决问题。

您将如何将 memcached 的缓存从正在关闭的服务器重新分配到其他服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T20:52:09.657

我不确定 memcached 中是否有这样的功能。但是，关键是，它是缓存。如果服务器出现故障或重新启动，最糟糕的情况是您会遇到一些缓存未命中（直到它被重建）。Memcached 不应该是一个可靠的数据库（尽管有一个基于 memcached 的数据库）——您的数据也应该保存在某个较低的持久级别，并且当缓存服务器每次宕机时您也不应该担心只要它不会使您的整个缓存无效并且不会经常发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T21:21:48.633

您是否考虑过使用 SQL Server 来维护会话状态？

[将 SQL Server 用于 ASP.Net 会话状态](http://idunno.org/articles/277.aspx)

[ASP.NET 会话状态 (MSDN)](http://msdn.microsoft.com/en-us/library/ms972429.aspx)

# spring - Spring-modules 缓存不起作用...静默

> ID：583420
> 
> 赞同：2
> 
> 时间：2009-02-24T20:22:49.210
> 
> 标签：spring, caching, ehcache, spring-modules

我正在尝试使用 Spring Modules 项目中的声明性缓存。

它不起作用，即。似乎没有任何东西被缓存。

这是我的配置：

```
<bean id="cacheManager"
  class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean">
</bean>

<bean id="cacheProviderFacade"
  class="org.springmodules.cache.provider.ehcache.EhCacheFacade">
  <property name="cacheManager" ref="cacheManager" />
</bean>

<bean id="cacheableService"
    class="org.springmodules.cache.interceptor.proxy.CacheProxyFactoryBean">
    <property name="cacheProviderFacade" ref="cacheProviderFacade" />
    <property name="cachingModels">
        <props>
            <prop key="get*">cacheName=default</prop>
        </props>
    </property>
    <property name="flushingModels">
        <props>
            <prop key="update*">cacheNames=default</prop>
        </props>
    </property>
    <property name="target" ref="myServiceBean" />
</bean> 
```

然后，这是 Spring 加载应用程序上下文时的日志记录......

```
24 Feb 2009 14:26:20,785 INFO    org.springframework.cache.ehcache.EhCacheManagerFactoryBean - Initializing EHCache CacheManager
24 Feb 2009 14:26:20,801 DEBUG net.sf.ehcache.CacheManager - Configuring ehcache from classpath.
24 Feb 2009 14:26:20,801 WARN  net.sf.ehcache.config.ConfigurationFactory - No configuration found. Configuring ehcache from ehcache-failsafe.xml  found in the classpath: zip:C:/bea/weblogic81/server/bin/myserver/.wlnotdelete/extract/myserver_threeoneoneonline_threeoneoneonline/jarfiles/WEB-INF/lib/ehcache-1.3.0.jar!/ehcache-failsafe.xml
24 Feb 2009 14:26:20,801 DEBUG net.sf.ehcache.config.ConfigurationFactory - Configuring ehcache from URL: zip:C:/bea/weblogic81/server/bin/myserver/.wlnotdelete/extract/myserver_threeoneoneonline_threeoneoneonline/jarfiles/WEB-INF/lib/ehcache-1.3.0.jar!/ehcache-failsafe.xml
24 Feb 2009 14:26:20,801 DEBUG net.sf.ehcache.config.ConfigurationFactory - Configuring ehcache from InputStream
24 Feb 2009 14:26:20,816 DEBUG net.sf.ehcache.config.DiskStoreConfiguration - Disk Store Path: C:\DOCUME~1\bpapa\LOCALS~1\Temp\
24 Feb 2009 14:26:20,832 DEBUG net.sf.ehcache.config.ConfigurationHelper - No CacheManagerEventListenerFactory class specified. Skipping...
24 Feb 2009 14:26:20,832 DEBUG net.sf.ehcache.config.ConfigurationHelper - No CachePeerListenerFactoryConfiguration specified. Not configuring a CacheManagerPeerListener.
24 Feb 2009 14:26:20,847 DEBUG net.sf.ehcache.config.ConfigurationHelper - No CachePeerProviderFactoryConfiguration specified. Not configuring a CacheManagerPeerProvider.
24 Feb 2009 14:26:20,863 DEBUG net.sf.ehcache.config.ConfigurationHelper - No BootstrapCacheLoaderFactory class specified. Skipping... 
```

在此之后，我点击了一个页面，该页面从“myServiceBean”bean 中调用了一个以“get”为前缀的方法。但是，没有记录任何缓存正在进行。我已经将日志记录一路调高到调试 springmodules、spring 的缓存包和 DEBUG ......因为 Spring Modules 示例在网络上很少而且相距甚远，我想知道是否有人以前看过这个......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T20:46:49.467

您应该为您的配置创建一个 ehcache.xml 文件，因为我不相信故障安全缓存适用于声明性缓存。我们使用 ehcache Spring 模块 XML 模式和注释来设置缓存。如果使用显式 ehcache.xml 不能解决您的问题，那么我可以挖掘一些代码（接近）您的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-01T13:36:19.743

我是一个新项目的作者之一，该项目旨在通过注释为 Spring 3 项目提供 Ehcache 集成：

[http://code.google.com/p/ehcache-spring-annotations/](http://code.google.com/p/ehcache-spring-annotations/)

该库本着 Spring 的 @Transactional 精神提供了两个方法级别的注释：

@Cacheable @TriggersRemove

在您的 Spring 应用程序中进行适当配置后，该项目将在运行时围绕您的 @Cacheable 注释方法创建缓存方面。

使用文档可以在项目 wiki 上找到

# ruby - 创建一个接受参数散列的 ruby 方法

> ID：583423
> 
> 赞同：61
> 
> 时间：2009-02-24T20:23:23.000
> 
> 标签：ruby

我知道这可能是一个愚蠢的问题，但我不知道如何创建一个接受参数散列的 ruby​​ 方法。我的意思是，在 Rails 中我想使用这样的方法：

```
login_success :msg => "Success!", :gotourl => user_url 
```

接受这种参数的方法的原型是什么？我如何阅读它们？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-02-24T20:25:09.580

如果您以哈希语法将参数传递给 Ruby 函数，Ruby 将假定这是您的目标。因此：

```
def login_success(hsh = {})
  puts hsh[:msg]
end 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-02-24T20:54:12.193

要记住的关键一点是，如果散列参数是函数的最后一个参数，则只能执行省略散列字符 {} 的语法。因此，您可以做 Allyn 所做的事情，并且会奏效。还

```
def login_success(name, hsh)
  puts "User #{name} logged in with #{hsh[:some_hash_key]}"
end 
```

你可以用它来调用它

```
login_success "username", :time => Time.now, :some_hash_key => "some text" 
```

但如果散列不是最后一个参数，则必须用 {} 将散列元素括起来。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-04-30T13:36:17.930

随着[Ruby 2.0](http://blog.marc-andre.ca/2013/02/23/ruby-2-by-example/)中关键字参数的出现，您现在可以做到

```
def login_success(msg:"Default", gotourl:"http://example.com")
  puts msg
  redirect_to gotourl
end 
```

在 Ruby 2.1 中，您可以省略默认值，

```
def login_success(msg:, gotourl:)
  puts msg
  redirect_to gotourl
end 
```

调用时，省略没有默认值的参数将引发`ArgumentError`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-26T14:56:44.463

使用一个参数。Ruby 会将命名值转换为哈希：

```
def login_success arg
 # Your code here
end

login_success :msg => 'Success!', :gotourl => user_url
# => login_success({:msg => 'Success!', :gotourl => user_url}) 
```

如果你真的想确保你得到一个哈希，而不是默认的 ruby​​ duck 类型，那么你需要控制它。例如：

```
def login_success arg
  raise Exception.new('Argument not a Hash...') unless arg.is_a? Hash
  # Your code here
end 
```

# .net - net reactor 和 clickonce 部署

> ID：583427
> 
> 赞同：1
> 
> 时间：2009-02-24T20:24:50.110
> 
> 标签：.net, clickonce, obfuscation, protection

在构建我们的 VB.NET .exe 之后，然后使用第 3 方 .NET Reactor 实用程序对其进行混淆，然后将其输出包含在 VS2005 部署项目中。有没有办法在使用 click-once 发布之前将 .exe 替换为加扰版本？

有没有人设法通过单击一次来部署受网络反应堆保护的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T21:12:14.567

您可以但不能使用标准 ClickOnce 部署方案。一种方法是创建一个 MSBuild 任务，该任务获取您的文件并使用经过混淆的文件创建 ClickOnce 清单。基本问题是，一旦在创建清单后更改文件，它就会使文件无效，从而导致 ClickOnce 部署无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-06T05:42:50.337

您将受保护的文件嵌入到提取并执行的单击一次项目中。然后发布那个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-09T19:03:21.330

[混淆 ClickOnce 发布](http://www.nathanpjones.com/wp/2013/01/obfuscating-a-clickonce-publish-in-vs-2010/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-12T14:40:27.897

为了保护 ClickOnce 项目，建议通过以下方式使用 .NET Reactor Visual Studio 插件：

*   打开 .NET Reactor 并安装 Visual Studio Add-in（.NET Reactor 主菜单项 Help/Visual Studio -> Install Visual Studio 20xx Add-In）。
*   打开您的 Visual Studio 项目并打开加载项（Visual Studio 主菜单项工具 -> .NET Reactor）。
*   勾选“启用”
*   选中“项目输出是部署项目的一部分（设置、ClickOnce）”
*   您可以通过定义 .NET Reactor 项目文件或通过命令行开关来定义保护设置
*   添加“-invalid_metadata 0”作为命令行参数（以防止部署问题）
*   单击确定并允许 .NET Reactor 修改您的 Visual Studio 项目文件

[![在此处输入图像描述](https://i.stack.imgur.com/RK4rw.png)](https://i.stack.imgur.com/RK4rw.png)

通过这种方式，Visual Studio 项目文件被修改为在正确的时间访问 .NET Reactor（在您的程序集被编译之后但仍然在它被添加到 ClickOnce 包之前）。

# ruby-on-rails - 如何让 Haml 正确呈现 pre 标签的内容？

> ID：583436
> 
> 赞同：8
> 
> 时间：2009-02-24T20:27:19.013
> 
> 标签：ruby-on-rails, ruby, haml

我阅读了 Haml[文档](http://haml.hamptoncatlin.com/docs/rdoc/classes/Haml.html)，他们在其中谈论`pre`标签和“保留空白”。根据文档，`pre`默认情况下“保留空白”，您需要使用`~`运算符输出标签的内容以使其正确呈现。按照推荐的做法，我有这个：

```
%pre
  ~ @calendar.main_template 
```

浏览器中的输出：

（这可能有点令人困惑——应用程序让用户操作 Haml 代码，所以我实际上是在 UI 中显示 Haml 代码。）

```
%div
                = events 
```

想要什么输出：

```
%div
  = events 
```

我也尝试使用`=`而不是`~`. 还尝试了`%pre>`, `%pre<`, 并且`%pre><`都得到了相同的结果。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T20:59:47.623

你想要`preserve`。

```
%pre
  = preserve "I like\n  Cheese" 
```

# .net - .NET 已知服务对象的 POS

> ID：583437
> 
> 赞同：1
> 
> 时间：2009-02-24T20:27:32.023
> 
> 标签：.net, point-of-sale, pos-for-.net

我想知道是否有人知道我在哪里可以找到 LineDisplay、CashDrawers、打印机的列表，它们与 .NET 的 POS 配合得很好。我想为可能不受支持的潜在设备创建自己的服务对象。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-16T14:58:16.243

如果您下载 Epson OPOS ADK for Pos .Net，您会发现它包含一个 readme.txt 文件，其中专门列出了它们支持的 Epson 硬件。要下载它，您需要在 www.epsonexpert.com 创建一个帐户，登录，进入应用程序开发 -> opos，然后滚动到页面底部以找到 .net 下载。

此外，Sean Limings 网站可能会有所帮助；[http://www.seanliming.com/WEPOS.html](http://www.seanliming.com/WEPOS.html)

他发布了一些有关提供 SO 的供应商的信息。

此外，TPG（有时更名为 HP）具有适用于钱箱和打印机的兼容 OPOS 对象，但它们没有本机服务对象，并且当您以非管理员用户身份登录 Windows 时，它们的 OPOS 服务对象不起作用.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T01:40:48.637

包括 Epson 在内的许多供应商都提供本机 .NET 服务对象。此外，请记住，.NET 的 POS 支持上面列出的所有设备类别的旧版 OPOS。

# asp.net - 自定义 ASP.NET 控件如何在不使用 ViewState 的情况下缓存数据？

> ID：583447
> 
> 赞同：2
> 
> 时间：2009-02-24T20:29:35.763
> 
> 标签：asp.net, optimization, viewstate, web-controls

我不确定这在 ASP.NET 中是否可行，但这是我遇到的问题：我的 Web 应用程序上的一些数据列表是使用[GridView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview(VS.80).aspx)显示的；[但是，由于其中一些列表可能包含大量数据，因此有时会由于ViewState](http://msdn.microsoft.com/en-us/library/ms972976.aspx)将页面权重推高到几兆字节的范围内。由于我们不想每次在页面上有回发时都重新查询数据库以获取此信息，所以我想知道是否有一种方法可以缓存提供给服务器上控件的数据，然后下次访问它有回发。

那么这甚至可能吗？如果是这样，有人可以向我指出有关如何执行此操作的更多信息的方向吗？如果不可能，是否有人对我如何解决这个问题有任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T20:39:44.490

除了页面之外，您还可以为视图状态使用不同的商店。 [本文](http://www.eggheadcafe.com/articles/20040613.asp)描述了一些方法来做到这一点。

这样做的要点是覆盖 SavePageStateToPersistenceMedium 和 LoadPageStateFromPersistenceMedium。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T20:43:13.733

您可以尝试关闭 GridView 上的 ViewState。这可以经常在不影响功能的情况下完成。如果您的 GridView 仅显示数据并且不允许编辑、更新、删除等，则效果很好。

[http://www.pluralsight.com/main/screencasts/screencast.aspx?id=understanding-viewstate](http://www.pluralsight.com/main/screencasts/screencast.aspx?id=understanding-viewstate)

```
EnableViewState="false" 
```

通常，您必须在客户端上的 ViewState 和服务器上的某种类型的缓存之间建立平衡。不要害怕重新查询数据库。它可以很好地缓存数据。可能会考虑启用页面缓存。我会避免将所有这些数据塞进 Session 中，这会带来一系列问题。

[http://msdn.microsoft.com/en-us/library/hdxfb6cy.aspx](http://msdn.microsoft.com/en-us/library/hdxfb6cy.aspx)

```
<%@ Page Language="C#" AutoEventWireup="true" ... %>
<%@ OutputCache ... %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T20:54:27.153

以下是如何将 Viewstate 存储在本地临时文件中的示例： [http ://www.marklio.com/marklio/PermaLink.aspx?guid=af76f1a0-2d44-44c3-bfb5-029740b8e683](http://www.marklio.com/marklio/PermaLink.aspx?guid=af76f1a0-2d44-44c3-bfb5-029740b8e683)

您仍然通过这种方法使用 Viewstate，但不是填充 HTML，而是在服务器端创建临时文件。因此用户不会注意到 Viewstate 是巨大的。您还可以重写上面的示例以将 Viewstate 数据存储在其他地方，例如数据库甚至内存中。

这种方法的优点是您不必重写太多代码。缺点是这些临时文件将填满服务器上的空间，需要不时清理一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T21:39:18.543

Rob，在您的情况下，我会尝试在会话中缓存从数据库中检索到的数据 - 网格第一次请求它。

如果您尝试此操作并将其与禁用网格的视图状态相结合，您可以提出非常巧妙的解决方案。

If you cannot count on Session for the caching, there are always some alternative persistence mechanisms that might do the job.

But from the design aspect of the given situation, i would definitely go with the data caching approach.

# asp.net - 我将如何搜索 DataSet 并在绑定之前更改其中的数据？

> ID：583450
> 
> 赞同：1
> 
> 时间：2009-02-24T20:30:38.130
> 
> 标签：asp.net, binding, dataset

```
Try
    Dim ds As DataSet = SqlHelper.ExecuteDataset(ConfigurationManager.ConnectionStrings("connstr").ConnectionString, CommandType.StoredProcedure, "Get_All", New SqlParameter("@userid", Session("userid")))

    rptBundles.DataSource = ds.Tables(0)

Catch ex As Exception
    showerror(ex, Me)
End Try 
```

这就是代码，我希望能够解析它并找到某些将某个布尔值设置为 1 的行，然后相应地编辑该行中的其他变量，我将如何做到这一点，我尝试制作一个 For Each 行嵌套在 For Each 表中，但是当我对其进行测试时，转发器永远不会填充数据...

```
 For Each ds_table As DataTable In ds.Tables
        For Each ds_row As DataRow In ds_table.Rows
            If ds_row("isScorm") = 1 Then
                ds_row("totalLessons") = 100
                ds_row("TotalQuestions") = 100
                ds_row("lessonscompleted") = 50
                ds_row("TotalCorrect") = 50
            End If
        Next
    Next 
```

只有当我删除该代码时，中继器才会按预期填充，但我没有收到任何错误！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T20:49:10.333

如果您使用的是中继器或任何数据源绑定控件，我将使用 ItemDataBound 事件并将这些值设置为您的控件。

如果这是您的基本 HTML

```
<html>
  <asp:Repeater id="repeater" runat="server" OnItemDataBound="repeater_ItemDatabound">
     <ItemTemplate>
         <span><%# DataBinder.Eval(Container.DataItem, "isScorm") %></span>
         <span id="totalLessonsSpan" runat="server"><%# DataBinder.Eval(Container.DataItem, "totalLessons") %></span>
     </ItemTemplate>
  </asp:Repeater>
</html> 
```

我会在后面的代码中有这个

```
protected void repeater_ItemDatabound(object sender, RepeaterItemEventArgs e)
{
    DataRow row = e.Item.DataItem as DataRow;

    if (row == null) { }
    else
    {
        int isScorm = 0;
        int.TryParse(Convert.ToString(row["isScorm"]), out isScorm);
        if (isScorm > 0)
        {
            HtmlGenericControl totalLessonsSpan = e.Item.FindControl("totalLessonsSpan") as HtmlGenericControl;
            totalLessonsSpan.Text = "100";
        }
    }
} 
```

您可能不想循环遍历数据并将其交换到那里，然后在绑定期间执行绑定。

或者，由于我需要数据完整性，我讨厌 DB 所做的事情是在 SQL 选择中使用 case 语句更改它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T21:09:55.150

设置 DataSource 后添加 rptBundles.DataBind() 是否可以解决问题？

此外，您可能希望查看[DataTable.Select](http://msdn.microsoft.com/en-us/library/det4aw50.aspx)方法以仅选择（然后修改）isScorm = 1 的行。

# java - 在分配给null之前检 查变量是否为null？

> ID：583454
> 
> 赞同：6
> 
> 时间：2009-02-24T20:32:18.703
> 
> 标签：java, compiler-construction, performance, clarity

与空检查相比，变量赋值是否昂贵？例如，是否值得在将 foo 分配为 null 之前检查它是否不为 null？

```
if (foo != null) {
     foo = null;
} 
```

还是这没什么好担心的？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-24T20:34:16.750

这是一个微优化（无论如何可能由编译器处理）。别担心。通过专注于您的程序实际算法，您将获得更大的回报。

> 我们应该忘记小的效率，比如大约 97% 的时间：过早优化是万恶之源。——唐纳德·克努斯

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T20:35:13.127

这实际上（非常非常轻微）效率*较低*。变量赋值大致相当于空检查，另外还有一个额外的分支可能。并不是说它有很大的不同。

> 还是这没什么好担心的？

你说对了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T20:35:13.893

我不会担心 - 这只是需要维护的额外代码行。这是你永远不应该做的那种微优化，除非你有*大量*的文件证明这是你的瓶颈。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T20:53:25.440

首先是微优化。所以不用太担心。

但是要回答您的问题，您需要将其减少到一行。（正如您的所有代码所做的那样，将其设置为 NULL）。

```
foo = NULL; 
```

原因是，

比较是一个比赋值更昂贵的操作。（因为比较比较吃掉了许多汇编指令。通常是减法和与零的比较或异或和与零的比较）。赋值占用更少的指令。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T03:44:33.273

如果您有一个不错的编译器，它们将生成相同的代码。如果您有一个糟糕的编译器，那么带有 的编译器`if`会更糟。在 2009 年，对变量的硬件分配非常便宜，而条件分支有时可能很昂贵。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T20:36:37.120

```
 foo = null; 
```

```
 if (foo != null)
   foo = null; 
```

如果我查看第二个块代码，我会认为您只想将 foo 变量设置为 null 如果它之前不为 null，如果我查看第一个代码，我会认为您想将变量 foo 设置为 null反正。

我知道这是因为您编写的示例，但最终这种微优化只会增加混乱（不值得）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T20:37:06.900

这将使您的代码更难阅读，即使它是一种优化，也不值得麻烦。

这不是优化。在大多数现代 cpu 的 if 语句上非常昂贵。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T20:44:23.277

这将几乎没有影响。我认为您甚至无法创建一个基准来证明差异。

事实上，有些人会争辩说，分配给 null 是一种代码味道（请参阅[PMD 检测器的 NullAssignment](http://pmd.sourceforge.net/rules/controversial.html)）：

> 将“null”分配给变量（在其声明之外）通常是不好的形式。有时，赋值表明程序员没有完全理解代码中发生了什么。注意：这种分配在极少数情况下可能有助于鼓励垃圾收集。如果这就是您使用它的目的，请务必忽略此规则:-)

一般来说，我个人对任何试图鼓励垃圾收集的事情持怀疑态度（你几乎总是会得到你没想到的效果）。

# c# - 将多个 DataRow 加入单个 DataRow

> ID：583463
> 
> 赞同：0
> 
> 时间：2009-02-24T20:34:10.790
> 
> 标签：c#, .net, datagridview, dataset

我正在使用 .NET 3.5 用 C# 编写此代码。我有一个 System.Data.DataSet 对象，它有一个使用以下模式的 DataTable：

```
Id      :  uint
AddressA:  string
AddressB:  string
Bytes   :  uint 
```

当我运行我的应用程序时，假设 DataTable 填充了以下内容：

```
1   192.168.0.1   192.168.0.10   300
2   192.168.0.1   192.168.0.20   400
3   192.168.0.1   192.168.0.30   300
4   10.152.0.13   167.10.2.187    80 
```

我希望能够查询这个 DataTable，其中 AddressA 是唯一的，并且 Bytes 列被加在一起（我不确定我说的是否正确）。本质上，我想得到以下结果：

```
1   192.168.0.1   1000
2   10.152.0.13     80 
```

我最终希望这个结果在一个可以绑定到 DataGrid 的 DataTable 中，并且我需要每 5 秒左右更新/重新生成这个结果。

我该怎么做呢？DataTable.Select() 方法？如果是这样，查询是什么样的？是否有替代/更好的方法来实现我的目标？

编辑：我没有数据库。我只是使用内存中的 DataSet 来存储数据，因此纯 SQL 解决方案在这里不起作用。我试图弄清楚如何在 DataSet 本身中做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T20:40:18.640

最有效的解决方案是直接在 SQL 中求和

select AddressA, SUM(bytes) from ... group by AddressA

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T23:20:09.597

为了可读性（并且因为我喜欢它），我会尝试使用 LINQ：

```
var aggregatedAddresses = from DataRow row in dt.Rows
group row by row["AddressA"] into g
select new {
    Address = g.Key,
    Byte = g.Sum(row => (uint)row["Bytes"])
};

int i = 1;
foreach(var row in aggregatedAddresses)
{
    result.Rows.Add(i++, row.Address, row.Byte);
} 
```

如果使用 LINQ 解决方案发现性能问题，我将使用手动解决方案在原始表的循环中汇总行并将它们插入结果表。

您还可以将聚合地址直接绑定到网格，而不是将其放入 DataTable。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T21:25:03.680

我也同意 Steven 的观点，即在服务器端执行此操作是最佳选择。但是，如果您使用的是 .NET 3.5，则不必按照 Rune 的建议进行操作。相反，使用数据集的扩展方法来帮助查询和求和值。

然后，您可以轻松地将其映射到一个匿名类型，您可以将其设置为网格的数据源（假设您不允许对此进行编辑，因为您正在聚合数据，所以我不知道您可以如何编辑） .

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T21:10:47.113

我同意 Steven 的观点，最好的方法是在数据库中进行。但如果这不是一个选项，您可以尝试以下方法：

*   创建一个新的数据表并使用 DataTable.Columns.Add(name, datatype) 手动添加您需要的列
*   逐步完成第一个数据表行集合，并为每一行使用 DataTable.NewRow() 在新数据表中创建一个新行
*   将在第一个表中找到的列的值复制到新行中
*   使用 Select() 在另一个数据表中找到匹配的行，并将最终值复制到新的数据行中
*   使用 DataTable.Rows.Add(newRow) 将行添加到新数据表

这将为您提供一个新的数据表，其中包含来自两个表的组合数据。它不会很快，但除非你有大量数据，否则它可能会足够快。但尽量避免在 Select 中执行 LIKE 查询，因为那很慢。

如果两个表都包含具有相同主键的行，则一种可能的优化是可能的。然后，您可以对两个表进行排序并逐步通过它们，使用它们的数组索引来获取两个数据行。这将使您摆脱 Select 呼叫。

# xml - 如何在没有循环的情况下将简单的 XMLList 转换为字符串数组？

> ID：583473
> 
> 赞同：12
> 
> 时间：2009-02-24T20:35:29.663
> 
> 标签：xml, apache-flex, arrays, actionscript, xmllist

如何在不使用循环的情况下将以下 XMLList 转换为字符串数组？

```
<labels>
    <label>All</label>
    <label>your</label>
    <label>base</label>
    <label>are</label>
    <label>belong</label>
    <label>to</label>
    <label>us.</label>
</labels> 
```

我想要这个结果：

```
["All","your","base","are","belong","to","us."] 
```

现在，我正在执行以下操作：

```
var labelsArray:Array /* of String */ = [];

for each (var labelText:String in labels.label)
{
    labelsArray.push(labelText);
} 
```

我想知道在 ActionScript 3.0 中是否有更简单的方法来执行此操作

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-08-24T15:34:01.523

这很好用，但使用了一些奇怪的 XMLList 语法。如果需要，最后一条语句可以放在一行。

```
 var labels:XML = <labels>
                    <label>All</label>
                    <label>your</label>
                    <label>base</label>
                    <label>are</label>
                    <label>belong</label>
                    <label>to</label>
                    <label>us.</label>
                </labels>;

var labelsArray:Array /* of String */ = [];

labels.label.
(
              labelsArray.push(toString())
); 
```

toString() 调用可以替换为attribute() 调用以提取属性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-12-06T00:04:56.937

这个效果很好：

```
public static function xmlListToArray($x:XMLList):Array {           
    var a:Array=[], i:String;
    for (i in $x) a[i] = $x[i];
    return a;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T10:32:02.710

您当前的实现绰绰有余。您可以进行的唯一优化（尽管除非您使用 Vector.<>，否则我不会打扰）是将初始容量传递给 Array 构造函数：

```
var xmlLabels : XMLList = labels.label;
var labelsArray:Array /* of String */ = new Array(xmlLabels.length);

var index : int = 0;

for each (var labelText:String in xmlLabels)
{
    labelsArray[index++] = labelText;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-20T03:08:01.227

尽管认真使用`for`循环并`XML`按照给定的逻辑处理对象，但这是`XMLList`.
最好看起来像这样：

```
var xml:XML = 
<labels>
    <label>All</label>
    <label>your</label>
    <label>base</label>
    <label>are</label>
    <label>belong</label>
    <label>to</label>
    <label>us.</label>
</labels>
;
var list:XMLList = xml.label;
var labels:XMLList = list.text(); //Optional
trace(list[0]);
trace(list[3]);
trace(list[6]); 
```

这将输出：

```
All
are
us. 
```

我自己在闪存中确认了这一点。就我个人而言，使用可选行和引用等对我来说是有意义的，`labels[0]`但这里不需要。

我知道您要求一个字符串数组作为输出，但基本上我是在问您为什么不能只使用 XMLList 对象的数组访问器。

这是一个很好的演练：[E4X上的Senocular](http://www.senocular.com/flash/tutorials/as3withflashcs3/?page=4#e4x)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T20:41:11.053

`for`循环在 AS 中非常快。你为什么需要那个？但是你可以试试这个：

```
private function toArray():void {
    var xml:XML = <labels>
               <label>all</label>
               <label>your</label>
              </labels>;

    var array:* = xml.label.text().toXMLString().split("\n") ;
    trace(array as Array);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-05T23:32:00.060

我觉得在某个地方有一个单线……哦，好吧。

问题：为什么 .length 在这里失败？（总是 0）

```
 public static function xmlListToArray($x:XMLList):Array {
        var t:int = $x.length;
        var a:Array=new Array(t), i:int;
        for (i = 0; i < t; ++i) a[i] = $x[i];
        return a;
    } 
```

# sql - 有没有办法使用 ms sql 的 windows 身份验证显式指定 au/p？

> ID：583504
> 
> 赞同：4
> 
> 时间：2009-02-24T20:43:36.320
> 
> 标签：sql, sql-server

对 MS SQL 使用 Windows 身份验证时，有没有办法明确指定用户/域/密码？

我的意思是在连接字符串中。

编辑：我想在另一台计算机上使用特定用户名和密码连接到另一台 SQL 服务器，因此我认为不可能进行模拟。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T20:55:30.100

不，没有 - 您在连接字符串中的两个选择是集成身份验证（当前 Windows 用户）和 SQL 身份验证。

如果我对您的理解正确，那么您尝试以不同的 Windows 用户身份登录 SQL Server。您可以查看模拟用户（尽管这必须是一个单独的进程，而不是您的主应用程序），或者您可以查看类似数据库角色的内容：

[MSDN 文章](http://msdn.microsoft.com/en-us/library/aa905188(SQL.80).aspx)

**更新**：既然你已经声明你在一个工作组中（我假设客户端和服务器都是），那么[这篇博客文章](http://blog.tylerholmes.com/2008/03/work-around-when-impersonating.html)似乎说只要你使用的用户名和密码与服务器，你应该没事的。不确定这是否有可能，但值得考虑。此外，如果任一计算机在域中，则赌注无效 - 在这种情况下，您必须冒充才能实现这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T20:51:48.003

不，那是不可能的。使用 Windows 身份验证时，您发送当前用户的身份，而您无法明确指定。不过，您可以更改当前的线程主体。

# wpf - 在一个 UI 线程上跨多个 AppDomain 运行 WPF 有什么问题？

> ID：583505
> 
> 赞同：4
> 
> 时间：2009-02-24T20:43:37.257
> 
> 标签：wpf, .net-3.5, appdomain, maf, system.addin

我们正在考虑创建一个跨多个 AppDomain 运行的 WPF UI。其中一个应用程序域将运行应用程序，而其余的 AppDomains 将托管一系列用户控件和逻辑。当然，这个想法是将这些用户控件和逻辑从主应用程序中分离出来。

[这](http://www.codeplex.com/clraddins/Release/ProjectReleases.aspx?ReleaseId=9454)是使用 MAF/System.AddIn 执行此操作的示例。其他人在这方面有什么经验？此解决方案如何处理可能发生在一个用户控件内的 RoutedEvents/Commands，以及这些是否在 AppDomains 中正确序列化？WPF 资源呢？可以跨 AppDomain 无缝访问它们吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T11:59:33.180

老问题，但尽管如此：您将需要有多个 UI 线程 - 每个 AppDomain 一个。像这样创建它们：

```
 var thread = new Thread(() =>
        {
            var app = new Application();
            app.Run();
        });
        thread.Name = AppDomain.CurrentDomain.FriendlyName;
        thread.SetApartmentState(ApartmentState.STA);
        thread.Start(); 
```

最大的挑战是您无法在 AppDomain 之间发送 FrameworkElements（它们不是 MarshalByRefObject），但您可以使用 FrameworkElementAdapters.ViewToContractAdapter() 和 ContractAdapterToView() 方法来解决此限制。有关更多详细信息，请参阅[FrameworkElementAdapters](http://msdn.microsoft.com/en-us/library/system.addin.pipeline.frameworkelementadapters.aspx) MSDN 页面。

然后，一旦你有了这个，最大的问题恕我直言，你不能在“远程”域的 FrameworkElement 上放置任何东西（经典的“空域问题”）。有关这方面的更多信息，请参阅[此线程。](https://stackoverflow.com/questions/5978917/render-wpf-control-on-top-of-windowsformshost)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T07:08:20.020

[我在这里](https://stackoverflow.com/questions/439173/message-pumps-and-appdomains/924653#924653)回答了一个类似的问题，并为 WPF 编辑了它，您可以使用一个有趣的属性来了解 Compisition 引擎如何操作，将调度程序 Pump 拖尾到一个渲染上下文中。这是一个非常轻量级的选择。

另外，我猜你知道[企业图书馆](http://entlib.codeplex.com/)和[统一](http://codeplex.com/unity)？

有一个[WPF 应用程序块](http://www.bennedik.de/2007/04/wpf-integration-for-validation.html)，所以使用该模式并*不太*痛苦；）但他们不是说，没有痛苦就没有收获吗？

还有 CAB（复合 UI 应用程序块），与统一联系在一起。[WPF SDK](http://blogs.msdn.com/wpfsdk/archive/2008/10/22/composite-wpf-and-silverlight-v2-is-posted.aspx)人员制作了 Silverlight 和 WPF 平台。（又名棱镜）。

哦，对了，你还问资源？我更喜欢在 Application 类中手动加载资源。我已经意识到一件事，假设您在子文件夹中有一个 ResourceDictionary，并且您正在该 ResourceDictionary 中加载 MergedDictionaries。因此，如果在您的 Application 类中，您加载“my-res-dir/MergedDictionaryLoader.xaml”（通过代码或 xaml），**则所有未来的 MERGEDDICTIONARIES 加载都从**“my-res-dir”加载。

如果你问我有点疯狂，我认为由于进程当前目录没有改变，你应该为所有其他目录指定“my-res-dir/foo.xaml”。然而，事实并非如此（我不相信这至少在任何地方都有很好的记录，应该被认为是一个错误恕我直言）。

所以请记住，WPF 资源字典加载将基于当前*XAML*所在的目录。因此，您从“my-res-dir/MergedDictionaryLoader.xaml”中指定 Source="foo.xaml"。我什至玩过 URI 包/绝对语法，但我从未发现它更直观。

# dynamic - 从静态语言到动态语言

> ID：583507
> 
> 赞同：6
> 
> 时间：2009-02-24T20:44:03.137
> 
> 标签：dynamic, static

互联网上和 SO 上都有很多讨论，即[这里](https://stackoverflow.com/questions/125367/dynamic-langauges-vs-static-type-languages)和[这里](https://stackoverflow.com/questions/42934/whats-with-the-love-of-dynamic-languages)，关于静态与动态语言。

我不会再问关于一对一的问题。相反，我的问题是针对那些从静态类型语言迁移（或至少尝试迁移）到动态语言的人。

我不是在谈论在您的网页上适度使用 JS 或嵌入到静态类型软件或小型个人脚本中的其他脚本语言。我的意思是转向动态语言作为您在团队中开发生产质量软件的主要通用语言。

那容易吗？最大的优势和最大的挑战是什么？它有趣吗？:)

UPD：您是否发现 IDE 支持足够好？您是否发现需要较少的 IDE 支持？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T20:54:15.873

**那容易吗？**

适度。一些 Java 主义是很难改掉的习惯。在前六个月，我用 ;'s 编写了 Python。恶心。然而，一旦我结束了它，我就没有回头。

**最大的优势是什么？**

从“写入 -> 编译 -> 构建 -> 运行 -> 中断 -> 调试 -> 写入”循环转变为“写入 -> 运行 -> 中断 -> 写入”循环。需要时间来适应 Python 命令行解释器的即时满足。在尝试编写（更不用说编译）任何代码之前，我已经习惯了无休止的设计和规划。

起初我认为 python 命令行是一种“仅限教育”的界面。然后阅读在 >>> 提示符下键入应用程序的文档字符串、文档测试和用户指南，我开始意识到真正出色的 Python 软件将复杂性和细微差别归结为您可以交互键入的内容。

[我*希望*我能设计出干净利落的东西。]

**最大的挑战是什么？**

多重继承。我很少使用它。

**它有趣吗？**

至今。

它的生产力也非常惊人。更多时间处理用户需求和真实数据。更少的时间来规划具有适当接口的继承层次结构，以捕获含义**并**正确编译，**并且**足够可扩展以至少持续到下一个版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T21:19:58.247

如果我是你，我会尝试[Scala](http://www.scala-lang.org/)！！！

Scala 有一些非常有趣的方面，让您在做静态的同时感觉喜欢做动态。

*   Scala 是一种具有动态类型气味的静态类型语言，因为编译器可以减少重复推断分配的次数。

*   一种具有温暖而美妙的脚本风味的编译语言。因为您可以使用 scala 控制台，甚至可以像 ruby​​ 或 python 一样编写脚本。因此，您可以像 S.Lott 所说的那样在“写入 -> 编译 -> 构建 -> 运行 -> 中断 -> 调试 -> 写入”或“写入 -> 运行 -> 中断 -> 写入”之间进行选择。

*   Scala 是一个完整的函数式语言，完全支持 OO。因此，您不会丢失许多重要的 OO 方面，例如继承、封装、多态等。

为什么要回答你关于 Scala 的问题？因为我之前尝试过脚本语言，主要是Ruby。就像 S.Lott 所说的那样。但对我和我的团队来说并不容易。大多数时候静态是安全的，更不容易出错，如果你有正确的语言，甚至更快。

回答您将 Scala 放入其中的三个问题：

**那容易吗？**

是的。有时您需要集中精力将旧概念搁置一旁，深入研究。

**最大的优势是什么？**

您有宾至如归的感觉，因为您无需更改环境或重写现有应用程序即可迁移到 Scala（谈论 Java）。如果你来自 Java，那么在阅读一些文章之后，你就可以开始玩 Scala。没有太多的努力。另一个重要的优势是使用函数式语言及其嵌入式功能。

**它有趣吗？**

当然！改变主意，改变解决问题的最佳方式肯定很有趣。

这是我的愿景。您并不完全需要放弃静态来获取动态的优势。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T22:17:19.013

好问题。

我现在使用 Ruby、PHP 和 ActionScript（三者中动态性最低的）而不是我喜欢的语言，如 Java 和 C#。但是乞丐，我的意思是，这个经济中的工人，不能选择。或者更确切地说，你必须选择你的战斗和你的主人。

很难比较 Ruby 和 Java，因为它们的区别不止一个，而且您只询问了动态/静态的事情（甚至没有询问强类型和弱类型的事情！）。但在这方面，对我影响最大的**始终**是 IDE。当其他 Java 程序员使用 Notepad 或 Textpad 编写代码时，我总是感到震惊，而如今，一个好的 IDE 有太多的优势来应对这种疯狂。**Ruby 不是这样！**我使用 Netbeans，它做得很好，但主要区别之一是**我必须实际输入代码。**对我来说，自动完成曾经是/现在是一种生活方式（例如，我使用预测字典用完整的英语/西班牙语编写 SMS 消息，并且从不使用缩写）并且编写 Ruby 代码确实需要更多的工作。

所以一开始很痛苦，我一直在查看，例如，我编写的类的函数名（或者是 Ruby 的一部分），只是为了拼写正确！所以这很糟糕，我想，我继续这样想，直到......

前几天我搬回了 ActionScript，为了让我的 IDE 自动完成（FlashDevelop 或 FlexBuilder），我用类型声明了所有变量（如果你愿意的话，可以选择强类型）......突然间我觉得**这太麻烦了！**

然后今天我不得不在一个 Ruby 项目上添加一些功能，感觉**自由而酷。**代码很干净，为什么我要通知 IDE 我正在尝试编写的内容？

所以我想说 1) 最大的挑战是学习你正在使用的语言和框架，就像往常一样 2) 它非常有趣并且令人大开眼界。新语言总是带有新的东西，但动态语言只是感觉不同。这就是让你在周日早上 7 点起床并在再次入睡之前做一些编码的事情。

我喜欢编程，并且和你们大多数人一样，我花了一些时间研究存储过程、XSL、静态、动态等等……这一切都很有趣，而且它们都**感觉**完全不同。**最后，我认为，你正在使用的框架将说服你是否留下（如果你有选择的话），但语言是要学习、学习和体验的，而不是比较的。**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T20:49:11.207

我不能完全符合这个要求，但在花了很多年编写 Java 之后，我确实花了一些时间编写了一些有趣的 Python 小游戏。所以，我可能会混合一些从编译到解释的转变。

我发现自己使用符号来模仿静态类型。:)

但是，我确实发现自己以更好的剪辑方式编写代码。就学习新语言/编写新代码而言，拥有解释器是天赐之物。完成一行代码和看到它工作之间的时间越短，你编写的速度就越快，我认为这可能是最动态和解释性语言最好的事情。

考虑到所有因素，我的代码看起来并没有太大的不同。不过，Python 有很多有趣的数据结构。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T21:49:02.217

我也对这个话题很感兴趣。不久前尝试深入研究 Ruby 和 Rails，它确实帮助我掌握了 ASP.Net MVC 的东西，我认为起初对于普通的 .net 开发人员来说有点太具有挑战性了。

如果您对朝这个方向发展更感兴趣，或者对一些开发人员如何从静态语言转向动态语言作为他们的全职工作感到好奇，我强烈推荐 [这个 Alt.Net 播客](http://altnetpodcast.com/episodes/13-ruby-on-rails)。

# php - 网站查询，php

> ID：583513
> 
> 赞同：-5
> 
> 时间：2009-02-24T20:45:01.717
> 
> 标签：php

这是网站[http://www.ip-adress.com/ip_tracer/](http://www.ip-adress.com/ip_tracer/) 我想使用 php 从那里获取纬度和登录度并将其传递给 mySQL DBase，我该如何实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T20:50:08.927

一种方法是使用 googles API。

[http://code.google.com/intl/de/apis/ajax/documentation/google.loader.ClientLocation](http://code.google.com/intl/de/apis/ajax/documentation/) _

另一种使用它的方法：http: [//www.maxmind.com/app/ip-location](http://www.maxmind.com/app/ip-location)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T20:52:56.643

您是否只使用[hostip.info](http://www.hostip.info/use.html)提供的免费 API ？这对你来说是一个预制的解决方案，你不必费力地进行屏幕抓取。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T20:46:54.770

你想做屏幕抓取。在 PHP 中，您可以使用[cURL](http://php.net/curl)。它将允许您与网站进行交互，类似于浏览器的方式。然后您需要解析页面以过滤掉您正在寻找的部分。您可以使用[正则表达式](http://php.net/manual/en/function.preg-grep.php)和/或[strpos()](http://php.net/strpos)来做到这一点。

但是，请注意，如果网站发现来自一个 IP 地址的请求过多，他们可能会开始阻止您。

您可以购买数据库和可以使用的服务来执行相同的过程。

# c# - C# CodeDom 自动属性

> ID：583516
> 
> 赞同：11
> 
> 时间：2009-02-24T20:46:12.307
> 
> 标签：c#, code-generation, codedom

我有一个使用 CodeDom 创建的属性。如何将其设置为自动属性，而不是针对私有成员添加 CodeFieldReferenceExpressions？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-24T20:52:30.403

IIRC，CodeDom 根本无法表达这一点。自动实现的属性只是编译器的糖，但由于它没有（干净地）映射到所有语言，它不能完全适合 CodeDom（此外，CodeDom 需要更新）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-05-26T20:04:25.117

是的你可以。

您可以为此目的使用 CodeSnippetTypeMember 类。

例如：

```
 CodeTypeDeclaration newType = new CodeTypeDeclaration("TestType");
        CodeSnippetTypeMember snippet = new CodeSnippetTypeMember();

        snippet.Comments.Add(new CodeCommentStatement("this is integer property", true));
        snippet.Text="public int IntergerProperty { get; set; }";

        newType.Members.Add(snippet); 
```

# linux - Linux - 识别拥有物理内存中特定地址的进程

> ID：583517
> 
> 赞同：5
> 
> 时间：2009-02-24T20:46:25.770
> 
> 标签：linux, module, linux-kernel, kernel

在 Linux 下，我如何知道哪个特定进程拥有/正在使用物理内存中的给定地址？

我知道这可能需要编写一个内核模块来访问一些内核数据结构并将结果返回给用户——我需要知道它是如何完成的，不管它有多复杂。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T21:04:41.263

进程使用的页面及其在物理内存中的位置不是静态信息。但是，您寻求的信息应该在[页表](http://lwn.net/Articles/106177/)中。内核中的[更改](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=926e5392ba8a388ae32ca0d2714cc2c73945c609)可能几乎正是您正在寻找的内容：

```
author  Arjan van de Ven <arjan@linux.intel.com>    2008-04-17 15:40:45 (GMT) 
committer   Ingo Molnar <mingo@elte.hu>                 2008-04-17 15:40:45 (GMT)
commit  926e5392ba8a388ae32ca0d2714cc2c73945c609 (patch)
tree    2718b50b8b66a3614f47d3246b080ee8511b299e
parent  2596e0fae094be9354b29ddb17e6326a18012e8c (diff) 

x86: add code to dump the (kernel) page tables for visual inspection by kernel developers 

This patch adds code to the kernel to have an (optional)
/proc/kernel_page_tables debug file that basically dumps the kernel
pagetables; this allows us kernel developers to verify that nothing
fishy is going on and that the various mappings are set up correctly.
This was quite useful in finding various change_page_attr() bugs, and
is very likely to be useful in the future as well. 

Signed-off-by:Arjan van de Ven <arjan@linux.intel.com> 
Cc: mingo@elte.hu 
Cc: tglx@tglx.de 
Cc: hpa@zytor.com 
Signed-off-by: Ingo Molnar <mingo@elte.hu> 
Signed-off-by: Thomas Gleixner <tglx@linutronix.de> 
```

添加的功能由新的配置选项 (X86_PTDUMP) 启用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T20:59:23.693

可能想[从这里开始](http://linux-mm.org/VirtualMemory)讨论进程虚拟内存如何映射到物理内存。这将为您提供一个很好的起点，以找出您需要在哪里连接到内核以访问存储该信息的页表等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T21:00:42.630

好吧，由于在 Linux 下完成事情的方式，一个进程可能在一个实例中拥有内存，然后由于分页而不再拥有内存。

[http://en.wikipedia.org/wiki/Paging](http://en.wikipedia.org/wiki/Paging)

从本质上讲，这意味着计算机会在某一时刻切换出它不需要的数据，以便将内存用于其他用途。

我不确定这是否有帮助，但我建议您查看页表和目录，因为您可以使用它们来转换为物理地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T21:01:26.090

您也许可以使用`pmap -d [pid]`它...不幸的是，您必须在所有进程上运行它才能查看哪个进程返回了给定内存地址的结果。当然不如内核模块那么有效（如果在寻找内存时内存被调出，您甚至可能得不到结果）。

# c# - StructureMap 创建实例

> ID：583522
> 
> 赞同：2
> 
> 时间：2009-02-24T20:47:26.063
> 
> 标签：c#, .net, inversion-of-control, structuremap

我在启动时配置了接口的具体类型，但我想在运行时通过设置属性或在构造函数中设置不同的值来创建具体类型的实例。我看到的所有实例的创建都知道具体类型是什么，在运行时我不知道具体类型。有没有办法在不知道具体类型的情况下创建接口/类的具体实例？这是我所看到的：

```
[Test]
public void DeepInstanceTest_with_SmartInstance()
{
    assertThingMatches(registry =>
    {
        registry.ForRequestedType<Thing>().TheDefault.Is.OfConcreteType<Thing>()
                .WithCtorArg("name").EqualTo("Jeremy")
                .WithCtorArg("count").EqualTo(4)
                .WithCtorArg("average").EqualTo(.333);
        });
} 
```

或者：

```
var container = new  Container(x =>
{
    x.ForConcreteType<SimplePropertyTarget>().Configure
     .SetProperty(target =>
     {
         target.Name = "Max";
         target.Age = 4;
     });
}); 
```

我想做类似的事情......但不知道具体类型......只有抽象类或接口（在这种情况下会有属性）。虽然配置了具体类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T14:02:44.343

在 Jeremy Miller（StructureMap 的作者）的指导下找到了答案。这是他指给我看的地方：

[http://structuremap.sourceforge.net/RetrievingServices.htm#section5](http://structuremap.sourceforge.net/RetrievingServices.htm#section5)

这是我使用的示例：

```
IDatabaseRepository repo =
                ObjectFactory.With("server").EqualTo("servername").
                With("database").EqualTo("dbName").
                With("user").EqualTo("userName").
                With("password").EqualTo("password").
                GetInstance<IDatabaseRepository>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T23:28:05.723

您需要某种[工厂模式](https://stackoverflow.com/questions/515269/factory-pattern-in-c-how-to-ensure-an-object-instance-can-only-be-created-by-a)来创建具体实例。创建的瞬间*必然*需要知道具体的实现是什么。

# windows - 推荐的 .NET 应用安装程序？

> ID：583523
> 
> 赞同：1
> 
> 时间：2009-02-24T20:47:26.967
> 
> 标签：windows, deployment, .net-2.0, installation

我需要为我的应用程序创建一个执行以下操作的安装：

1.  复制文件
2.  写入注册表设置
3.  注册一个 Windows 服务
4.  写入一个 XML app.config 文件（基于用户在安装过程中提供的信息——一个连接字符串）
5.  针对远程数据库执行 SQL 脚本（在 #4 中获得连接信息）
6.  安装和注册 COM dll
7.  将条目添加到控制面板>添加/删除程序以进行卸载

我不需要任何花哨的逻辑来允许用户自定义这些步骤——我可以在适当的地方注入用户提供的信息来对它们进行硬编码。

我查看了[Wix](http://wix.sourceforge.net/)，但发现文档和示例与最近的版本不一致。

我还查看了[NSIS](http://nsis.sourceforge.net/Main_Page)，但发现对编写 XML 的支持过于有限（此[插件](http://nsis.sourceforge.net/NsisXML_plug-in_(by_Joel))只能处理最多 64 个字节的字符串）。

我最初认为 VS2005 内置的 Setup 项目无法处理这些任务，但在遇到了我认为更好的选择后，我准备重新考虑。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T01:06:43.990

我仍然建议多研究一下 WiX。我们用它来做除了该列表中的#6 之外的所有事情，而且学习曲线很小。我们使用 WiX v3 已经快 3 年了，我还没有发现太多文档/教程离题太远的地方。通常它在哪里，因为他们清理了语法并使它变得更好。

此外，从 Visual Studio (2010/Rosario) 的下一版本开始，WiX 将直接构建到 Visual Studio 中，我不确定是否与当前的安装项目并行或完全替换它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T21:00:05.720

Visual Studio 安装程序项目可以执行您想要的任何自定义代码；不明白为什么您的任何要求都会成为问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T21:53:23.690

我使用过 Visual Studio (2005) 和[Wise](http://www.codework.com/wise/product.html)，可以推荐两者。你没有提到该工具是否必须是免费的，如果是这样，就排除了 Wise。尽管如此，Wise 的学习曲线非常简单，并且非常强大且有据可查。我在使用 Visual Studio 时发生了一些奇怪的事情。有一次我不得不删除我的项目并重新开始（可能是由于我的愚蠢 - 从来没有弄清楚），但总的来说，我在目前的工作中已经使用它几年了，它对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-28T22:48:30.473

你可以只使用 Visual Studio 和 Windows 来实现你所需要的，而不需要商业工具。

首先，查看创建单个安装程序文件的[答案。](https://stackoverflow.com/a/44813392/8228677)

Then, you can research how to create a Custom Action class that can perform registry, read/write files and register COM dll's separately.

# html - 将边框设置为表格 tr，适用于除 IE 6 和 7 之外的所有内容

> ID：583539
> 
> 赞同：22
> 
> 时间：2009-02-24T20:51:15.523
> 
> 标签：html, css, html-table

我将表 event_calendar tr 的边框设置为红色，它适用于除 IE 6 和 7 之外的所有内容。我的 CSS 有什么问题？

```
table#event_calendar tr {
    border:1px solid red;
}

<div class="content-body">
<table id="event_calendar">
    <tr class="calendarHeader">
        <th><div class="calendarMonthLinks"><a href="http://webdev.herkimer.edu/calendar/2009/03/">&lt;&lt;</a></div></th>
        <th colspan="5"><h1>April 2009</h1></th>
        <th><div class="calendarMonthLinks"><a class="calendarMonthLinks" href="http://webdev.herkimer.edu/calendar/2009/05/">&gt;&gt;</a></div></th>
    </tr>
    <tr>
        <td class="calendarDayHeading">Sunday</td>
        <td class="calendarDayHeading">Monday</td>
        <td class="calendarDayHeading">Tuesday</td>
        <td class="calendarDayHeading">Wednesday</td>
        <td class="calendarDayHeading">Thursday</td>
        <td class="calendarDayHeading">Friday</td>
        <td class="calendarDayHeading">Saturday</td>
    </tr>
</table>
</div> 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-02-24T21:04:49.360

IE 不支持 <tr> 标记的边框属性。但是，可以通过在每个单元格周围放置一个顶部和底部边框并使用“border-collapse:collapse;”来解决问题。所以单元格之间没有空间。我将在此处参考[此资源](http://csarven.ca/tr-border-trick-for-ie "这个资源在这里")的确切方法，但它对您来说基本上看起来像这样（我自己没有测试过，所以我不确定这是否完全正确，但我认为您可以重复一下.)

```
table#event_calendar {
    border-collapse: collapse;
    border-right: 1px solid red;
    border-left: 1px solid red;
}

table#event_calendar td, table#event_calendar th {
    border-top: 1px solid red;
    border-bottom: 1px solid red;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T21:08:10.070

您的 CSS 足够明智，但 IE 只是没有在 tr 元素上设置边框。如果你使用这种风格，你应该得到预期的结果：

```
table#event_calendar {
    border-top:1px solid red;
    border-right:1px solid red;
    border-left:1px solid red;
    border-collapse:collapse;
}

table#event_calendar td, table#event_calendar th {
    border-bottom:1px solid red;

} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-12T12:52:06.843

在 td 上设置边框是最简单的解决方案。但是如果你真的想在 上设置边框`<tr>`，你可以随时设置：

```
tr { display:block; border-bottom:1px dotted #F00; } 
```

通过这样做，您会失去`<td>`. 如果要使它们的宽度相等，请将显示设置为`<td>`to`inline-block`并设置一些宽度：

```
td { display:inline-block; width:20%; } 
```

当您想在`<td>`和 上绘制一些边框时，它会有所帮助`<tr>`。

CSS 生成的内容喜欢`tr:before{}`或`tr:after{}`总是可以提供帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T21:00:45.797

将您的 CSS 选择器更改为“table#event_calendar tr **td** ”，它应该可以工作。

# asp.net - 具有可编辑所有记录的 ASP.NET Gridview

> ID：583540
> 
> 赞同：2
> 
> 时间：2009-02-24T20:51:21.543
> 
> 标签：asp.net, session, gridview, listview, datatable

我认为这很简单，但我确实在这样做时遇到了很多麻烦：

这个问题的标题可能有点误导。我不必使用网格视图。事实上，我知道 GridView 可能不是这样做的方法。我只是不知道如何命名它。但是，现在只考虑：

我有一个非常简单的类，叫做 Student。它有 4 个属性： int ID string FirstName string LastName string Email

我想在内存中保留这些的通用集合（会话状态）：列出学生；

好的，现在的问题是：我希望用户根据需要创建尽可能多的学生对象。为了显示这些，我只想要一个简单的表格，每行有 3 个文本框。我希望每一行都有标签的文本框，以便可以随时编辑任何记录。

当用户完成创建他们的学生对象后，他们会继续做其他事情。但是，我只是很难找到一种以这种方式显示记录的方法。我是否使用 ListView(3.5)、html 表格、gridview、repeater 等？

你会怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T21:14:16.153

我个人倾向于使用 ListView，因为你可以用它插入 Rows。您的 LayoutTemplate 将是一个带有 <tr runat="server" ID="itemPlaceHolder" /> 的表。您的 ItemTemplate 将有您的 TextBox（并且每行可选一个保存按钮。如果您还需要插入，则可以有一个 InsertItemTemplate。

您可以在页面上的任何位置添加一个按钮以通过循环 ListView.Item 集合并调用 ListView.Update(itemIndex, validate) 来保存所有项目。

```
<asp:ListView runat="server" ID="lv" InsertItemPosition="LastItem" DataKeyNames="id">
<LayoutTemplate>
    <asp:LinkButton runat="server" OnClick="SaveAll" Text="Save All" />
    <table>
    <tr>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Email</th>
    </tr>
    <tr runat="server" id="itemPlaceHolder" />
    </table>
    <asp:LinkButton runat="server" OnClick="SaveAll" Text="Save All" />
</LayoutTemplate>
<ItemTemplate>
    <tr>
        <td><asp:TextBox runat="server" ID="firstName" Text='<%#Bind("firstName") %>' /></td>
        <td><asp:TextBox runat="server" ID="firstName" Text='<%#Bind("lastName") %>' /></td>
        <td><asp:TextBox runat="server" ID="firstName" Text='<%#Bind("email") %>' /></td>
        <td><asp:LinkButton runat="server" CommandName="update" Text="Save" /></td>
    </tr>
</ItemTemplate>
<InsertItemTemplate>
    <tr>
        <td><asp:TextBox runat="server" ID="firstName" Text='<%#Bind("firstName") %>' /></td>
        <td><asp:TextBox runat="server" ID="firstName" Text='<%#Bind("lastName") %>' /></td>
        <td><asp:TextBox runat="server" ID="firstName" Text='<%#Bind("email") %>' /></td>
        <td><asp:LinkButton runat="server" CommandName="insert" Text="Save" /></td>
    </tr>
</InsertItemTemplate>
</asp:ListView>

protected void SaveAll(object sender, EventArgs e)
{
    lv.Items.ToList().ForEach(li => lv.UpdateItem(li.DataItemIndex, true)_;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T21:01:40.007

是的，您可以使用网格视图来执行此操作。您可以为列创建自定义模板，以便它们显示在文本框中而不是标签中。然后，您可以通过行捕获“保存”事件并更新数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T21:06:10.713

是的，这是可能的。这只是 Victor 发布的代码示例。

```
 <asp:GridView ID="gvDetails" runat="server" AutoGenerateColumns="False" DataKeyNames="PartNumber" GridLines="Horizontal"
                ForeColor="#333333" CellPadding="4" Width="800" PageSize="20" OnDataBound="gvPartDetails_DataBound" OnSelectedIndexChanged="gvPartDetails_SelectedIndexChanged" OnSorting="gvPartDetails_Sorting">
                <Columns>
                    <asp:TemplateField HeaderText="#">
                        <ItemTemplate>
                            <asp:Label ID="lblNumber" runat="server" Text='<%# Bind("Number") %>' ToolTip='<%# Bind("Description") %>'></asp:Label>
                        </ItemTemplate>
                        <HeaderStyle Wrap="False" />
                    </asp:TemplateField>
                    <asp:TemplateField HeaderText="LOC 1">
                        <ItemTemplate>
                            <asp:TextBox ID="txt_Qty1" AutoPostBack="false" runat="server" MaxLength="5" Width="50" Text='<%# Bind("Qty1") %>'></asp:TextBox>
                        </ItemTemplate>
                        <HeaderStyle Wrap="False" />
                    </asp:TemplateField>
                    <asp:TemplateField HeaderText="LOC 2">
                        <ItemTemplate>
                            <asp:TextBox ID="txt_Qty2" AutoPostBack="false" runat="server" MaxLength="5" Width="50" Text='<%# Bind("Qty2") %>'></asp:TextBox>
                        </ItemTemplate>
                        <HeaderStyle Wrap="False" />
                    </asp:TemplateField>
                </Columns>

                <EmptyDataTemplate>
                    <span id="Empty">No Details For This Such and Such.</span>
                    <a href="javascript:showNewPartMPE();"><img src="Images/icons/table_add.png" style="border:0px" alt="Add New Part" /></a>
                </EmptyDataTemplate>

                <FooterStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
                <RowStyle BackColor="#F7F6F3" ForeColor="#333333" />
                <EditRowStyle BackColor="#999999" />
                <SelectedRowStyle BackColor="#E2DED6" Font-Bold="True" ForeColor="#333333" />
                <PagerStyle BackColor="#284775" ForeColor="White" HorizontalAlign="Center" />
                <HeaderStyle BackColor="#284775" Font-Bold="True" ForeColor="White" HorizontalAlign="Left" />
                <AlternatingRowStyle BackColor="Gainsboro" ForeColor="#284775" />
            </asp:GridView> 
```

然后后面的代码......这很粗糙......

```
 private void ApplyChanges()
    {
        foreach (GridViewRow row in this.gvDetails.Rows)
        {
           //do something with cells and data objects
           //and then save add to list, save, etc.
        }
    } 
```

**编辑**
上面是您编辑数据的地方。您可以使用 DataTables、DataViews、DataSets，并且正如其他解决方案所示，您可以将网格绑定到对象列表。这应该根据系统中的数据对象模型以及如何生成行来确定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T21:08:56.433

Gridview 将是实现这一点的最简单方法。您*可以*使用 html 表格，但是当用户想要添加更多用户时，您将不得不做更多的事情。使用您的四个属性（Id、FirstName、LastName、Email）为 gridview 创建一个模板，然后从会话对象中绑定它，例如：

```
public void BindGrid()
{
  // assume students is the name of your GridView control
  students.DataSource = (List<Student>)Session["StudentList"];
  students.DataBind();
} 
```

# python - 在 Python 中打印带分隔符的表格的最佳方法是什么

> ID：583557
> 
> 赞同：4
> 
> 时间：2009-02-24T20:56:53.107
> 
> 标签：python, coding-style

我想打印一个混合了字符串和浮点值的表格，作为制表符分隔的输出打印输出。当然我可以完成工作：

```
>>> tab = [['a', 1], ['b', 2]]
>>> for row in tab:
...     out = ""
...     for col in row:
...             out = out + str(col) + "\t"
...     print out.rstrip()
... 
a   1
b   2 
```

但我有一种感觉，在 Python 中有更好的方法可以做到这一点，至少要打印带有指定分隔符的每一行，如果不是整个表的话。谷歌搜索（从[这里](http://skymind.com/~ocrow/python_string/)），它已经更短了：

```
>>> for row in tab:
...     print "\t".join([str(col) for col in row])
... 
a   1
b   2 
```

还有更好的，或者更 Python 的方式来做到这一点吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-24T21:47:41.160

您较短的解决方案可以作为快速而肮脏的解决方案。但是如果你需要处理大量数据，最好使用`csv`模块：

```
import sys, csv
writer = csv.writer(sys.stdout, delimiter="\t")
writer.writerows(data) 
```

此解决方案的好处是您可以轻松自定义输出格式的各个方面：分隔符、引号、列标题、转义序列......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T21:05:20.030

我认为它不会比你的第二个代码片段好得多......也许，如果你真的想要，

```
print "\n".join("\t".join(str(col) for col in row) for row in tab) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T21:49:38.737

```
import sys
import csv

writer = csv.writer(sys.stdout, dialect=csv.excel_tab)
tab = [['a', 1], ['b', 2]]
writer.writerows(tab) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T22:20:30.847

请不要使用串联，因为它每次都会创建一个新字符串。cStringIO.StringIO 将更有效地完成此类工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-25T03:30:35.687

这取决于您*为什么*要这样输出，但如果您只想直观地引用数据，您可能想尝试[pprint](http://docs.python.org/library/pprint.html)模块。

```
>>> import pprint
>>> for item in tab:
...     pprint.pprint(item, indent=4, depth=2)
...
['a', 1]
['b', 2]
>>>
>>> pprint.pprint(tab, indent=4, width=1, depth=2)
[   [   'a',
        1],
    [   'b',
        2]]
>>> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-07T06:42:48.000

Prettytable库可能很有用[。](https://code.google.com/archive/p/prettytable/)它还有助于保持列对齐并允许额外的样式自定义。

**例子：**

```
# Ref: https://code.google.com/archive/p/prettytable/

import prettytable

# Read the input csv file
with open("input.csv", "r") as input_file:
    table = prettytable.from_csv(input_file)

# Optionally, change the default style
table.set_style(prettytable.PLAIN_COLUMNS)
table.align = "l"
table.valign = "t"

# Write the output ASCII text file
with open("output.txt", "w") as output_file:
    print("{}".format(table.get_string()), file=output_file)

# Optionally, write the output html file
with open("output.html", "w") as output_file:
    print("{}".format(table.get_html_string()), file=output_file) 
```

# web-services - JSON 字符编码 - 浏览器是否很好地支持 UTF-8 或者我应该使用数字转义序列？

> ID：583562
> 
> 赞同：100
> 
> 时间：2009-02-24T20:57:57.457
> 
> 标签：web-services, json, unicode, utf-8

我正在编写一个使用 json 来表示其资源的 web 服务，但我对编码 json 的最佳方式感到有点困惑。阅读 json rfc ( [http://www.ietf.org/rfc/rfc4627.txt](http://www.ietf.org/rfc/rfc4627.txt) ) 很明显首选编码是 utf-8。但是 rfc 还描述了一种用于指定字符的字符串转义机制。我认为这通常用于转义非 ascii 字符，从而使生成的 utf-8 有效 ascii。

因此，假设我有一个 json 字符串，其中包含非 ascii 的 unicode 字符（代码点）。我的网络服务应该只是 utf-8 编码并返回它，还是应该转义所有那些非 ascii 字符并返回纯 ascii？

我希望浏览器能够使用 jsonp 或 eval 执行结果。这会影响决定吗？我缺乏对各种浏览器对 utf-8 的 javascript 支持的了解。

编辑：我想澄清一下，我对如何编码结果的主要关注实际上是浏览器对结果的处理。我读到的内容表明，特别是在使用 JSONP 时，浏览器可能对编码很敏感。我还没有找到关于这个主题的任何真正好的信息，所以我必须开始做一些测试来看看会发生什么。理想情况下，我只想转义那些需要的几个字符，只对结果进行 utf-8 编码。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-02-27T14:03:54.510

JSON 规范*要求*解码器支持 UTF-8。因此，所有 JSON 解码器都可以像处理数字转义序列一样处理 UTF-8。Javascript 解释器也是如此，这意味着 JSONP 也将处理 UTF-8 编码的 JSON。

JSON 编码器使用数字转义序列的能力只是为您提供了更多选择。您可以选择数字转义序列的一个原因是，如果您的编码器和预期解码器*之间*的传输机制不是二进制安全的。

您可能希望使用数字转义序列的另一个原因是为了防止某些字符出现在流中，例如和`<`，如果 JSON 代码放置时未转义为 HTML 或浏览器错误地将其解释为 HTML，这些字符可能会被解释为 HTML 序列. 这可以防御 HTML 注入或跨站点脚本（注意：某些字符必须在 JSON 中转义，包括and ）。`&``"``"``\`

一些框架，包括 PHP `json_encode()`（默认），*总是*在编码器端为 ASCII 之外的任何字符执行数字转义序列。这是一个主要是不必要的额外步骤，旨在最大限度地与有限的传输机制等兼容。但是，这不应被解释为任何 JSON 解码器都存在 UTF-8 问题的迹象。

所以，我想你可以像这样决定使用哪个：

*   只需使用 UTF-8，除非您用于在编码器和解码器之间进行存储或传输的任何软件都不是二进制安全的。

*   否则，使用数字转义序列。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-08-11T23:30:17.793

我在那里遇到了问题。当我使用像“é”这样的字符对字符串进行 JSON 编码时，每个浏览器都会返回相同的“é”，除了 IE 会返回“\u00e9”。

然后使用 PHP json_decode()，如果找到“é”，它将失败，所以对于 Firefox、Opera、Safari 和 Chrome，我必须在 json_decode() 之前调用 utf8_encode()。

注意：在我的测试中，IE 和 Firefox 使用它们的原生 JSON 对象，其他浏览器使用 json2.js。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-24T21:03:57.927

ASCII 不在其中了。使用 UTF-8 编码意味着您没有使用 ASCII 编码。你应该使用转义机制是 RFC 所说的：

> 除必须转义的字符外，所有 Unicode 字符都可以放在引号内：引号、反斜线和控制字符（U+0000 到 U+001F）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-01-29T10:53:25.920

我面临着同样的问题。这个对我有用。请检查这个。

```
json_encode($array,JSON_UNESCAPED_UNICODE); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-04-24T01:51:12.717

> 阅读 json rfc ( [http://www.ietf.org/rfc/rfc4627.txt](http://www.ietf.org/rfc/rfc4627.txt) ) 很明显首选编码是 utf-8。

仅供参考，RFC 4627 不再是官方 JSON 规范。它在 2014 年被[RFC 7159](https://www.rfc-editor.org/rfc/rfc7159.html)淘汰，然后在 2017 年被当前规范[RFC 8259淘汰。](https://www.rfc-editor.org/rfc/rfc8259)

RFC 8259 指出：

> 8.1。字符编码
> 
> **在不属于封闭生态系统的系统之间交换的 JSON 文本必须使用 UTF-8 [RFC3629] 进行编码**。
> 
> 以前的 JSON 规范没有要求在传输 JSON 文本时使用 UTF-8。然而，绝大多数基于 JSON 的软件实现都选择使用 UTF-8 编码，以至于它是唯一实现互操作性的编码。
> 
> 实现不得在网络传输的 JSON 文本的开头添加字节顺序标记 (U+FEFF)。为了互操作性，解析 JSON 文本的实现可能会忽略字节顺序标记的存在，而不是将其视为错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-15T09:31:25.783

我对 é char 也有类似的问题...我认为“您输入的文本可能不是 UTF-8”的评论可能接近此处的标记。我有一种感觉，在我意识到并更改为 utf8 之前，我的实例中的默认排序规则是别的东西......问题是数据已经存在，所以不确定它是否在我更改数据时转换了数据，在 mysql 中显示正常工作台。最终结果是php不会对数据进行json编码，只是返回false。无论您使用什么浏览器作为导致我的问题的服务器，如果存在此字符，php 将不会将数据解析为 utf8。就像我说的不确定是由于在数据出现后将架构转换为 utf8 还是只是一个 php 错误。在这种情况下使用`json_encode(utf8_encode($string));`

# bouncycastle - 无法从应用程序 jar 访问 BouncyCastle jar

> ID：583565
> 
> 赞同：0
> 
> 时间：2009-02-24T20:58:45.537
> 
> 标签：bouncycastle

我为我的应用程序制作了 jar 文件。我的应用程序类之一使用 BC jar 的 BouncyCastleProvider 类。

我在我的应用程序 jar 所在的同一个父文件夹中创建了一个文件夹“lib”。

我已将我的机器 CLASSPATH 更改为指向这个新的 lib 文件夹。但是当我运行我的应用程序时，它给了我 classnotfound 异常。

但是，如果我将此 BC jar 文件复制到我的 jre/lib/ext 中，那么一切正常。

谁能告诉我从我的 lib 目录访问 BC jar 文件需要做什么？

提前致谢， 杰尼什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T21:05:05.117

您的 JAR 文件必须设置其 MANIFEST.MF 文件以声明 JAR 的类路径。#

[从下面的Sun 教程](http://java.sun.com/docs/books/tutorial/deployment/jar/downman.html)中提取，在您的情况下，您只需要使 Class-Path 指令指向您的 lib 目录，大概

```
Class-Path: lib/BouncyCastle.jar 
```

> 我们希望将 MyUtils.jar 中的类加载到类路径中，以便在 MyJar.jar 中使用。这两个 JAR 文件位于同一目录中。
> 
> 我们首先创建一个名为 Manifest.txt 的文本文件，其内容如下：
> 
> ```
> Class-Path: MyUtils.jar
> 
> Warning : The text file must end with a new line or carriage return. 
> ```
> 
> 如果最后一行没有以新行或回车结束，则不会正确解析。
> 
> 然后我们通过输入以下命令创建一个名为 MyJar.jar 的 JAR 文件：
> 
> ```
> jar cfm MyJar.jar Manifest.txt MyPackage/*.class 
> ```
> 
> 这将创建带有清单的 JAR 文件，其中包含以下内容：
> 
> ```
> Manifest-Version: 1.0
> Class-Path: MyUtils.jar
> Created-By: 1.6.0 (Sun Microsystems Inc.) 
> ```
> 
> 当您运行 MyJar.jar 时，MyUtils.jar 中的类现在被加载到类路径中。

# c# - C# - 为什么需要实例化每个数组元素？

> ID：583574
> 
> 赞同：4
> 
> 时间：2009-02-24T20:59:58.437
> 
> 标签：c#, arrays

我经常使用这种类型的构造。

```
response = new LocationResponse ();
response.LocationDetails = new LocationDetail[4];
response.LocationDetails[0] = new LocationDetail();
response.LocationDetails[0].site = "ABCDE";
... 
```

我不完全理解的部分是这个部分：

**response.LocationDetails[0] = new LocationDetail();**

为什么必须实例化数组的每个单独元素？

如果你忽略它，你会得到未定义的异常。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-24T21:02:10.990

好吧，如果数组元素被自动实例化，您将被锁定在您定义数组的类中。您将无法使用抽象类或接口的数组或任何没有默认构造函数的对象。这只是列举了在数组中自动实例化对象的一些问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T21:04:10.640

如果 LocationDetail 是值类型（结构），则不需要实例化它。如果它是一个类，则必须实例化它，因为引用类型的默认值为 null。

此代码有效：

```
public struct LocationDetail 
{
    private string site;

    public string Site
    {
        get { return site; }
        set { site = value; }
    }
}

static void Main(string[] args)
{
    LocationResponse response = new LocationResponse();
    response.LocationDetails = new LocationDetail[4];
    response.LocationDetails[0].Site = "ABCDE";
    Console.Write(response.LocationDetails[0].Site);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T21:02:52.423

将其视为一个引用指针，如果您不初始化，则每个 LocationDetail 项都有一个空值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T21:04:58.907

它将每个元素设置为 null，这是一个类的默认值，除非您另有说明。

C# 如何为您自动实例化元素？也许你的数组中的那个类型甚至没有默认构造函数。也许您不想在实际拥有它们之前消耗整个元素数组所需的内存。

我没有看到让运行时尝试提前填充该数组的优势。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T21:40:12.597

我认为数组是鸡蛋盒。您可以申报一个鸡蛋盒，但这不会将鸡蛋放入您的纸盒中——您仍然需要决定将哪种鸡蛋放入纸盒的每个插槽中。您可能想要一些复活节彩蛋，但其他人可能想要 AA 级自由漫游棕色鸡蛋。

数组本身无法提前知道您想要什么，因此默认情况下不会在您的插槽中放置任何内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T21:06:41.133

这将是一项昂贵的操作，具体取决于创建对象需要做什么。此外，如果不能简单地实例化对象怎么办？或者，如果您需要一个给定类型的数组，其中只有一些字段最终会包含一个对象，而其他字段应该为空？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T21:07:20.103

正如其他人指出的那样，声明后数组将充满`null`s 。您可以通过以下方式简化初始化逻辑：

```
response.LocationDetails = new LocationDetails [] {
    new LocationDetails(),
    new LocationDetails(),
    new LocationDetails(),
    new LocationDetails()
}; 
```

如果 LocationDetails 构造函数有一个采用 siteid 的重载，那就更好了：

```
response.LocationDetails = new LocationDetails [] {
    new LocationDetails("ABCDE"),
    new LocationDetails("FGHIJ"),
    new LocationDetails("KLMNO"),
    new LocationDetails("PQRST")
}; 
```

或者Justice指出的超级花哨的C# 3.0 :)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T21:08:42.843

```
response = new LocationResponse() {
    LocationDetails = new LocationDetail[] {
        new LocationDetail { site = "ABCDE" }
    }
} 
```

# math - 三角测量 GPS 坐标

> ID：583576
> 
> 赞同：5
> 
> 时间：2009-02-24T21:00:25.050
> 
> 标签：math, gps, geometry

假设您有`n`GPS 坐标，您如何计算出它们之间的中央 GPS 点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T21:26:17.467

如果它现在或将来对任何人都有帮助，这里有一个算法，即使对于极点附近的点也有效（如果它完全有效，即如果我没有犯愚蠢的数学错误;-)：

1.  将纬度/经度坐标转换为 3D 笛卡尔坐标：

    ```
    x = cos(lat) * cos(lon)
    y = cos(lat) * sin(lon)
    z = sin(lat) 
    ```

2.  计算 x 的平均值、y 的平均值和 z 的平均值：

    ```
    x_avg = sum(x) / count(x)
    y_avg = sum(y) / count(y)
    z_avg = sum(z) / count(z) 
    ```

3.  将该方向转换回纬度和经度：

    ```
    lat_avg = arctan(z_avg / sqrt(x_avg ** 2 + y_avg ** 2))
    lon_avg = arctan(y_avg / x_avg) 
    ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T21:08:32.627

取决于您所说的中央 GPS 点是什么意思。正如斯蒂芬所建议的那样，您可以简单地取所有点的平均值 - 但请记住，GPS 坐标不是连续的 - 这将在极点等不连续性周围发生惊人的失败。

在大多数情况下，您需要转换为不存在此问题的坐标系。

您还可以查看它所包围的所有点，计算到每个 GPS 点的所有距离，并最小化到所有 GPS 点的距离总和。为此，您需要研究大圆计算。

此外，每个 GPS 可能具有更高或更低程度的不确定性，您应该考虑到这一点并相应地加权它们。

你到底想知道什么？

-亚当

# vb.net - LenB 实际上对无字符串参数做了什么

> ID：583580
> 
> 赞同：1
> 
> 时间：2009-02-24T21:00:52.520
> 
> 标签：vb.net, vb6

我有这段代码正在从 vb6 转换为 vb.net。我需要知道 LenB 在这段代码中做了什么。

```
Dim singleValue As Single 'var for conversion use(4byte -> 1single)'
Dim bytes() As Byte
Dim valueB() As Byte 'this gets set elsewhere and is redim-d to its size'

For n = 0 To CDbl(ItemNumberCombo.Text) - 1
    'bytes() -> single'
    'UPGRADE_ISSUE: LenB function is not supported.'
    ReDim bytes(LenB(singleValue) - 1)
    bytes(3) = valueB(n * 4)
    bytes(2) = valueB(n * 4 + 1)
    bytes(1) = valueB(n * 4 + 2)
    bytes(0) = valueB(n * 4 + 3)
    'UPGRADE_ISSUE: LenB function is not supported.'
    'UPGRADE_ISSUE: VarPtr function is not supported. '
    Call memcpy(VarPtr(singleValue), VarPtr(bytes(0)), LenB(singleValue))
    'display the result'
    DText(n).Text = VB6.Format(singleValue, "0.000000E+00") 'CStr(singleValue)'
    If DataSaveCheckBox.CheckState = 1 And FileNameText.Text <> "" Then
        csvOutput = csvOutput & DText(n).Text & ","
    End If
Next n 
```

我认为字节总是重新调整为相同的大小是否正确？从外观上看，它有 4 个元素。

如果只能使用数字，为什么还要使用 LenB 到 ReDim？为什么要在循环中使用 ReDim？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T21:40:56.637

LenB() 返回变量的字节长度。最常见的示例是字符串，它以字节为单位返回字符串的大小，而不是字符数，而不管字符编码如何。对于其他类型，它返回对象的大小——单个对象的大小为 4。他们这样做的原因是，如果未来版本的 Visual Basic 更改了单个对象的大小（没关系），他们希望代码能够继续存在。分配给字节数组时对数字 4 进行硬编码）。

将 LenB() 升级到 .Net 时，对于字符串，用于`System.Text.Encoding.Unicode.GetBytes()`获取已经填充了字符串文本字节的数组。请记住，.Net 在内部始终使用 Unicode 表示字符串。如果您确实需要不同的编码，则 Encoding 命名空间中有许多替代方案。对于其他类型，请使用`BitConverter`该类。无论哪种方式，不要逐行进行，因为较新的方法会带走很多繁忙的工作。

在这里-我将帮助您进行一些转换：

（较早）

```
Dim csvOutput As New StringBuilder() 
```

（之后）

```
Dim valueB() As Byte 'this gets set elsewhere and is redim-d to its size'
Dim singleValue As Single 'var for conversion

' Included because the original developer was concerned the size of a single could change
Dim singleSize As Integer = BitConverter.GetBytes(singleValue).Length 

Dim NumberItems As Double
If Double.TryParse(ItemNumberCombo.Text, NumberItems) Then
    For n As Integer = 0 To NumberItems - 1
        singleValue = BitConverter.ToSingle(valueB, n * singleSize)

        'display the result
        DText(n).Text = singleValue.ToString("E6") 'CStr(singleValue)
        If DataSaveCheckBox.CheckState = 1 AndAlso Not String.IsNullOrEmpty(FileNameText.Text) Then
            csvOutput.Append(DText(n).Text & ",")
        End If
    Next n
Else
    ' Handle Invalid ComboBox value here- may not be an issue for you
End If 
```

请注意，此代码还演示了构建 csv 数据、运算符、方法和标准格式字符串`StringBuilder`的*更好*方法，所有这些都旨在替换 vb6 中的构造或技术。`AndAlso``.TryParse()``String.IsNullOrEmpty()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T21:24:30.153

试图解释糟糕的代码......只是徒劳的努力。通过加载字节数组来填充 Single 的有趣方式。

LenB 函数为您提供变量的字节长度。是的，当传递一个单一变量类型时，它总是返回 4。

我对 redim 的猜测是数组被初始化而不是被保留。但是由于它随后分配了所有 4 个字节，因此在技术上不需要它，并且可能只是防御性编程。防御性编程也可以解释 LenB。万一以后 Single 改变大小。

# algorithm - 计算线段末端到圆边缘的距离的公式是什么？

> ID：583591
> 
> 赞同：2
> 
> 时间：2009-02-24T21:03:03.030
> 
> 标签：algorithm, geometry, distance

我有一个圆圈，里面有两个点组成一条线段。如何计算从一个端点到直线相交的圆边缘的距离？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T21:11:04.977

我认为最简单的方法是找出线和圆的交点在哪里，然后计算线段点到交点的距离。

所以，假设你的圈子由等式描述

```
x^2 + y^2 = 5 
```

你的线段是点

```
(1,3), (2,4) 
```

首先，您计算出直接位于线段上方的线的方程式，在这种情况下，它将是

```
y = x + 2 
```

然后你把这个方程代入第一个方程，你得到

```
x^2 + (x+2)^2 = 5 
```

将其简化为

```
2x^2 + 4x - 1 = 0 
```

并通过二次公式求解。

您现在有了两个交点的 x 坐标。从那里，插入直线方程以获得 y 坐标。然后你可以做正常的点距离计算ala Pythagoras。

```
sqrt ( (x1 - x2)^2 + (y1 - y2)^2 ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T21:13:20.150

使用圆心作为参考点。获取从中心点到两个点的距离，然后是圆的半径。您现在可以在其中任意三个点（中心、线段点和圆边）之间绘制一个三角形。毕达哥拉斯可以处理其余部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T21:08:10.757

两点定义一条线 L。求解方程 Cx + L = 0，其中 C 是圆的方程。如果我没记错的话 :P[这里](http://www.mathsnet.net/dynamic/cindy/exploration_2.html)有更多信息。

# php - 如何在 PHP 中为动态查询构建参数化 PDO 语句？

> ID：583592
> 
> 赞同：1
> 
> 时间：2009-02-24T21:03:10.113
> 
> 标签：php, mysql, pdo, sql-injection

抱歉，如果这已经被问过了。我已经看到有关静态 SQL 的答案，但在这种情况下，我想使用 PDO->prepare() 作为在运行时动态构建的查询字符串。

分解成一个简单的例子：

```
$TempSQL = "SELECT field1, field2, field3 FROM table WHERE ";

if ($numberParams == 1) {
    $TempSQL = $TempSQL . " field1 = '$val1' ";
} else {
    $TempSQL = $TempSQL . " field2 = '$val2' ";
    $TempSQL = $TempSQL . " AND field3 = '$val3' ";
}

db->query($TempSQL); 
```

如何将其重写为 db->prepare()？

我也应该即时构建 statement->execute(array(':param' => $var))) 吗？

有没有更好/更整洁的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T06:23:33.027

也许是这样的。（未经测试）

```
$TempSQL = "SELECT field1, field2, field3 FROM table WHERE ";
$args=array();

if ($numberParams == 1) {
    $TempSQL = $TempSQL . " field1 = :val1"
    $args[':val1']=$val1;
} else {
    $TempSQL = $TempSQL . " field2 = :val2 and field3 = :val3";
    $args[':val2']=$val2;
    $args[':val3']=$val3;
}

$stmt=$db->prepare($TempSQL);
$stmt->execute($args); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T21:44:34.817

根据您的示例，更简洁的方法是循环而不是切换。

[db->prepare() 允许您使用 bindParam() 或PDOStatement->exec()](http://us3.php.net/manual/en/pdostatement.execute.php)上的数组替换模式（在 php.net 上，示例是在字段名称前放置一个冒号） 。你可以使用[? 来自示例 3 和 4](http://us3.php.net/manual/en/pdostatement.execute.php)，而不是命名字段值。

它仍然要求 SQL 语句的所有字段都是已知的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-03T06:34:03.863

```
$TempSQL = 'SELECT field1, field2, field3 FROM table';
$cond = array();
$params = array();
if (!empty($val1)) {
    $cond[] = "field1 = ?";
    $params[] = $val1;
}
if (!empty($val2)) {
    $cond[] = "field2 = ?";
    $params[] = $val2;
}
if (!empty($val3)) {
    $cond[] = "field3 = ?";
    $params[] = $val3;
}
if (count($cond)) {
    $TempSQL .= ' WHERE ' . implode(' AND ', $cond);
}
$stmt = $pdo->prepare($TempSQL);
$stmt->execute($params); 
```

# .net - 如何检测 SD 卡何时插入？

> ID：583593
> 
> 赞同：6
> 
> 时间：2009-02-24T21:03:11.627
> 
> 标签：.net, c++, windows, windows-xp

我正在用 C++ 编写一个 PC 应用程序，它需要检测用户何时将 SD 卡连接到他/她的计算机。我知道如何检测读卡器何时连接，但我不知道如何检测单个卡何时连接/移除。

Windows 是否有 IO 接口来检测 SD 卡的到达/移除？

[更新] 建议的 WM_DEVICECHANGE 技术仅适用于检测何时插入 SD 卡读卡器。它不检测何时将单个卡插入读卡器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T21:22:39.253

认为这是您需要的：

[http://www.codeproject.com/KB/dotnet/devicevolumemonitor.aspx](http://www.codeproject.com/KB/dotnet/devicevolumemonitor.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T21:25:21.010

WM_DEVICECHANGE 可能是您的答案。 [这](http://support.microsoft.com/default.aspx?scid=kb;en-us;163503)是一个使用 CDROM 的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T21:31:27.737

检查来自[WM_DEVICECHANGE](http://msdn.microsoft.com/en-us/library/aa363480(VS.85).aspx)的消息这里是一个[例子](http://bytes.com/groups/net-c/227073-usb-wm_devicechange-how-create-wndproc-inside-component)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T08:57:22.820

查看 Windows Portable Devices API，它具有允许您将其连接到 SD 读卡器（称为存储设备）并在插入或移除卡时获取事件的功能。

它只有两个（可能是主要的）缺点：

*   它需要 Windows Vista 或更高版本
*   它只有一个 COM API，所以如果你想从 .NET 程序中使用它，你要么有很多互操作，要么你必须用 C++ 或 C++/CLI 编写一个包装器

# .net - 我可以在 WPF 文本框中为文本的不同部分着色吗？

> ID：583597
> 
> 赞同：33
> 
> 时间：2009-02-24T21:04:15.803
> 
> 标签：.net, wpf, xml, textcolor

我有一个 WPF 文本框，我的用户可以在其中输入 XHTML。

XAML...

```
<TextBox Name="TextBoxContentBody"
         TextWrapping="Wrap"
         AcceptsReturn="True"
         VerticalScrollBarVisibility="Visible"
         FontFamily="Consolas"
         ... /> 
```

它看起来像这样：

![在此处输入图像描述](https://i.stack.imgur.com/uc4Wv.gif)

我宁愿它看起来像这样（Photoshopped 模型）：

![在此处输入图像描述](https://i.stack.imgur.com/ftHIC.gif)

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-24T21:07:08.060

您需要为此使用[RichTextBox](http://msdn.microsoft.com/en-us/library/system.windows.controls.richtextbox.aspx)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-24T21:17:29.407

就像 Kent 说的那样，你只能使用一种颜色。

这是一篇关于简单 RTB 语法突出显示的小文章，它应该可以满足您的大部分需求。

[http://blogs.microsoft.co.il/blogs/tamir/archive/2006/12/14/RichTextBox-syntax-highlighting.aspx](http://blogs.microsoft.co.il/blogs/tamir/archive/2006/12/14/RichTextBox-syntax-highlighting.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-08T06:23:10.623

您必须创建一个继承 TextBox 控件的自定义控件并按照以下示例进行操作：

[绘制格式化文本](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/drawing-formatted-text?view=netframeworkdesktop-4.8)

# web-services - SharePoint Web 服务：测试文件是否存在

> ID：583606
> 
> 赞同：2
> 
> 时间：2009-02-24T21:05:08.563
> 
> 标签：web-services, sharepoint

我在 C# 中使用 SharePoint Web 服务。我的代码正在检查文件并使用 Lists Web 服务将它们签出。我需要测试一下文件是否存在；我可以找到很多使用对象模型 API 执行此操作的示例，但我似乎找不到使用 Web 服务执行此操作的直接方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T21:18:18.703

使用合适的 CAML 查询尝试[Lists.GetListItems 。](http://msdn.microsoft.com/en-us/library/lists.lists.getlistitems.aspx)

一个 CAML 查询，如

```
<Query><Where><Eq><FieldRef Name="FileLeafRef" /><Value Type="Text">Filename.rtf</Value></Eq></Where></Query> 
```

应该管用; “FileLeafRef”字段是存储文件名的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T22:11:55.517

这段代码可能会，它有点粗糙，但演示了如何根据标题获取文件列表。

```
 public static bool PageExists(string listName, string webPath, string pageTitle)
        {
            string pageId = "";
            IntranetLists.Lists lists = new IntranetLists.Lists();
            lists.UseDefaultCredentials = true;
            lists.Url = webPath + "/_vti_bin/lists.asmx";
            XmlDocument doc = new XmlDocument();
            doc.LoadXml("<Document><Query><Where><Contains><FieldRef Name=\"Title\" /><Value Type=\"Text\">" + pageTitle + "</Value></Contains></Where></Query><ViewFields /><QueryOptions /></Document>");
            XmlNode listQuery = doc.SelectSingleNode("//Query");
            XmlNode listViewFields = doc.SelectSingleNode("//ViewFields");
            XmlNode listQueryOptions = doc.SelectSingleNode("//QueryOptions");

            Guid g = GetWebID(webPath);

            XmlNode items = lists.GetListItems(listName, string.Empty, listQuery, listViewFields, string.Empty, listQueryOptions, g.ToString());

            }
            return items.Count > 0;            
        }

        public static XmlNodeList XpathQuery(XmlNode xmlToQuery, string xPathQuery)
        {
            XmlDocument doc = new XmlDocument();
            doc.LoadXml(xmlToQuery.OuterXml);
            XmlNamespaceManager mg = new XmlNamespaceManager(doc.NameTable);
            mg.AddNamespace("sp", "http://schemas.microsoft.com/sharepoint/soap/");
            mg.AddNamespace("z", "#RowsetSchema");                                   
            mg.AddNamespace("rs", "urn:schemas-microsoft-com:rowset");
            mg.AddNamespace("y", "http://schemas.microsoft.com/sharepoint/soap/ois");
            mg.AddNamespace("w", "http://schemas.microsoft.com/WebPart/v2");
            mg.AddNamespace("d", "http://schemas.microsoft.com/sharepoint/soap/directory");
            return doc.SelectNodes(xPathQuery, mg);
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-28T13:47:44.227

我也有类似的问题。我尝试了以下 FieldRefs 但没有成功：“Name”、“FileLeafRef”和“LinkFilenameNoMenu”。

位于[http://www.johanolivier.blogspot.com](http://www.johanolivier.blogspot.com)的帖子详细说明了我必须做些什么才能使其正常工作。

# asp.net - 有没有办法将过滤器转换添加到图像控件

> ID：583609
> 
> 赞同：0
> 
> 时间：2009-02-24T21:05:54.723
> 
> 标签：asp.net, javascript

我正在尝试使用 Javascript 和 asp.net 图像控件创建幻灯片。我无法将过滤器属性添加到图像控件。有什么建议么 ？或者是否可以在javascript中设置过滤器？

例如：我希望能够将 style="filter:revealTrans(duration=2,transition=23)" 添加到 "" 控件中的图像。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T21:38:53.380

AFAIK，过滤器仅适用于 IE。我们使用[JavaScript 框架](https://stackoverflow.com/questions/913/what-javascript-library-would-you-choose-for-a-new-project-and-why)来实现这些效果的结果..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T22:09:00.173

考虑为此任务使用 JQuery UI

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T21:10:43.737

正如 Diodeus 所提到的，过滤器仅在 IE 中有效。因此我在 javascript 中使用 setTimeout 属性来旋转图像。

# sql-server - SQL 查询的仅使用书签查找选项的索引查找？

> ID：583611
> 
> 赞同：1
> 
> 时间：2009-02-24T21:06:13.007
> 
> 标签：sql-server, indexing, query-optimization

我正在优化针对遗留系统中非常宽的表的 SQL 查询。由于各种原因，我目前无法缩小表格范围。

我的查询运行缓慢，因为它对我创建的索引执行索引查找，然后使用书签查找来查找它需要的索引中不存在的其他列。书签查找占用了 42% 的查询时间（根据查询优化器）。

该表有 38 列，其中一些是 nvarchars，因此我无法创建包含所有列的覆盖索引。我试图通过创建覆盖所有列的索引来利用索引交集，但是那些“覆盖”索引没有被执行计划拾取并且没有被使用。

此外，由于通过此查询提取了 38 列中的 28 列，因此我将表中的 28/38 列存储在这些覆盖索引中，所以我不确定这有多大帮助。

您是否认为书签查找与它所获得的一样好，或者另一种选择是什么？

（我应该指定这是 SQL Server 2000）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T21:17:54.117

您可以创建包含列的索引作为另一种选择

来自 BOL 的示例，这是 2005 年及以后的

```
CREATE NONCLUSTERED INDEX IX_Address_PostalCode
    ON Person.Address (PostalCode)
    INCLUDE (AddressLine1, AddressLine2, City, StateProvinceID); 
```

回答这部分“我试图通过创建覆盖所有列的索引来利用索引交集，但是那些“覆盖”索引没有被执行计划拾取并且没有被使用。仅当以可搜索的方式创建查询时才能使用索引，换句话说，如果您在运算符左侧使用函数或在 WHERE 子句中省略索引的第一列，则索引获胜不被使用。如果索引的选择性低，那么也不会使用索引

查看[SQL Server 覆盖索引](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/sql-server-covering-indexes) 以获取更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T21:27:01.427

哦，

包含的覆盖索引应该可以工作。另一种选择可能是创建一个仅包含您需要的列 的**聚集索引视图。**

问候，
利文

# java - PDF 转文本工具或 Java 库？

> ID：583615
> 
> 赞同：3
> 
> 时间：2009-02-24T21:07:35.780
> 
> 标签：java, pdf

我需要将 PDF 转换为普通文本（这是我们县登记员的“投票声明”）。这些文件很大（2000 页左右）并且大部分包含表格。一旦我把它变成文本，然后我将使用我正在编写的程序来解析它并将数据放入数据库中。我已经在 Adob​​e Reader 中尝试了“另存为文本”功能，但它并不像我想要的那样精确，尤其是在将表格数据分隔为 CSV 时。那么，有什么工具或 Java 库可以解决问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T21:11:14.727

两种选择：

1.  **[iText](https://itextpdf.com/)** - 似乎[PdfTextExtractor 类](https://api.itextpdf.com/iText7/java/7.1.11/com/itextpdf/kernel/pdf/canvas/parser/PdfTextExtractor.html)可以做你想做的事。

2.  **[Apache PDFBox](http://pdfbox.apache.org/)**声称“PDF 到文本提取”是它的主要功能。有一个[ExtractText 命令行工具](https://pdfbox.apache.org/2.0/commandline#extracttext)专门用于此（[源代码](https://github.com/apache/pdfbox/blob/trunk/tools/src/main/java/org/apache/pdfbox/tools/ExtractText.java)），基于其[PDFTextStripper 类](https://pdfbox.apache.org/docs/2.0.0/javadocs/org/apache/pdfbox/text/PDFTextStripper.html)。还有 PDFBox[文本提取指南](http://www.pdfbox.org/pdfbox-user-guide/text-extraction/)！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T17:26:09.300

鉴于问题的标题：[Apache Tika](http://tika.apache.org/)非常适合我从 PDF 中提取纯文本。我还没有用它来从表格中获取文本。

对于 PDF，它实际上是使用[PDFBox](http://pdfbox.apache.org/)。但除了 PDF，它对 Microsoft Word（doc 和 docx）、Excel 和 PowerPoint、OpenOffice.org/LibreOffice ODT、HTML、XML 等其他格式也是[如此](http://tika.apache.org/1.2/formats.html)。它的 AutoDetectParser 使从任何输入中获取文本变得容易。

如果需要处理生成的文本（例如将其传递给[Mahout](http://mahout.apache.org/)进行分类），则可以使用[ParsingReader](http://tika.apache.org/1.2/api/org/apache/tika/parser/ParsingReader.html)将结果输入 Reader，同时后台进程将其提取出来。最后，在提取内容的同时，它还填充了它找到的元数据：

```
public Reader getPlainTextReader(final InputStream is) {
    try {
        Detector detector = new DefaultDetector();
        Parser parser = new AutoDetectParser(detector);
        ParseContext context = new ParseContext();
        context.set(Parser.class, parser);
        Metadata metadata = new Metadata();

        Reader reader = new ParsingReader(parser, is, metadata, context);

        for (String name : metadata.names()) {
            for (String value : metadata.getValues(name)) {
                logger.debug("Document {}: {}", name, value);
            }
        }

        return reader;

    } catch (IOException e) {
        ...
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T21:14:40.897

我一直发现[xpdf](http://www.foolabs.com/xpdf/)工具非常有用。

我们成功地使用 pdf 到文本的转换来转换 PDF 业务文档以用于 EDI。保留布局的选项可以很好地保持在程序中解析的良好位置。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-07T13:47:56.923

[PDFTextStream](http://snowtide.com)是我们的 Java + .NET 库，用于从 PDF 文档中提取内容；你可以试一试。此外，它确实提供了一些基本的[表格数据提取实用程序](http://downloads.snowtide.com/javadoc/PDFTextStream/latest/com/snowtide/pdf/util/TableUtils.html)，这些实用程序位于 PDFTextStream 的表格检测功能之上。这绝不是一个通用的解决方案（尽管我们也在研究其中一个！），但如果明确定义了表格数据（例如，行和列以线为界等），那么您可能会发现现在有什么适当的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T21:11:55.503

使用文本（行）打印机打印到文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T23:58:12.640

如果不知道 PDF 中页面的布局，就很难说。

我建议下载并尝试 iText 和 PDBox。您将在他们的网站上找到这两个文本提取示例 - 假设您熟悉 Java，您应该在 < 30 分钟内运行提取器。

从 PDFBox 开始，因为它的文本提取能力比 iText 的要好。

其他人提到了 xpdf，这可能对您有用。它是一个 C 库，带有一些围绕它构建的命令行工具。它有许多文本提取器，您可以很容易地格式化输出。同样，这实际上取决于您的页面布局。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T23:25:37.727

我使用 iText，我对它非常满意。我以前使用过 xmlpdf，我认为 iText 远胜过它。

# mfc - 如何在 VS 2003 中调试 Word 加载项 (.wll)

> ID：583627
> 
> 赞同：0
> 
> 时间：2009-02-24T21:10:36.477
> 
> 标签：mfc, ms-word, add-in, visual-studio-2003

我正在尝试附加到 Word 并在我刚刚访问的 C++ (MFC) 源代码中设置断点。我以前从未这样做过，希望我省略了一些简单的步骤。到目前为止，我已经能够：

*   在 VS 中编译源代码（这会生成 .obj 文件和 .pdb 文件，但没有 .wll 文件，这会造成混淆）
*   在 VS 中附加到 Word，当我在 Word 中运行加载项时，我可以全部破解并查看反汇编代码
*   找到在 VS 的模块窗口中运行的 myAddin.wll（VS 说没有加载符号）

我无法：

*   加载调试符号。当我在模块窗口中右键单击 myAddin.wll 并尝试加载 myAddin.pdb 时，VS 会忽略我
*   在 myAddin.cpp 中设置一个断点并点击它

有什么明显的我失踪了吗？您知道这方面的任何好的参考资料吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T08:35:28.340

您可以尝试将 Word 设置为按 F5 时要运行的应用程序，而不是附加到 Word。属性、调试、命令。至少这对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T12:01:28.167

我的第一个猜测是 Word 正在加载的 .wll 文件不是您刚刚构建的文件，因此 Word 正在加载没有任何调试信息的版本。

第一步是找出您在 Visual Stdio 中构建的 .wdll 文件实际输出的位置。打开项目的“属性”窗口并检查“常规/输出目录”和“链接器/常规/输出文件”以查看项目输出的内容。这应该足以让您找到它，并与 Explorer 确认它正在实际构建中。

附加到 Word 并加载加载项时，您应该会在 Visual Studio 输出中看到一条消息，指示您的 .wll 文件已加载。该消息应该给出它被加载的完整路径 - 如果这不是你的项目的输出，那是第一个问题。我建议您将新的 .wll 文件复制到 Word 从中加载 .wll 的任何位置。

# image - 如何在现有 PDF 中插入带有 iTextSharp 的图像？

> ID：583629
> 
> 赞同：46
> 
> 时间：2009-02-24T21:10:51.653
> 
> 标签：image, itextsharp

我有一个现有的 PDF，我可以使用 FdFWriter 输入文本框。它运作良好。现在我有一个图像。我已阅读文档并查看了许多示例，但它们都创建了新文档并插入了图像。我想获取现有的 PDF 并将图像插入图像字段或作为按钮的图标图像。我已经尝试过，但它损坏了文档。

我需要能够获取现有文档并在其上放置图像。我不想打开、阅读、替换和删除原件。此原始更改并且名称“原始”仅表示此上下文中的源文件。有许多这样的 PDF 文件需要图像。

感谢您的任何帮助。

编辑 - 我非常感谢下面的代码。它很好用，但对我来说问题是现有的 PDF 上有数字签名。当像这样复制文档（到 result.pdf 中）时，这些签名虽然仍然存在，但具有不同的字节数或其他已损坏的项目。这意味着签名虽然显示在 result.pdf 上，但旁边有一个图标，表明“签名无效”。

万一这很重要，我正在使用 Topaz 签名板来创建我的签名，它有自己的安全性。仅复制 PDF 不会损坏它，但下面的过程会损坏它。

我试图将图像放在现有文档上，而不是它的副本，这在这种情况下很重要。

另外，通过签名，我的意思是手写的，而不是密码。

再次感谢你。

编辑 - PdfSignatureAppearance 可以用于此吗？

编辑 - 我似乎能够做到这一点：

var stamper = new PdfStamper(reader, outputPdfStream,'1',true);

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-02-24T22:09:43.540

如果您想更改现有 PDF 文件的内容并添加额外的内容，例如水印、页码、额外的标题，PdfStamper 是您需要的对象。我已成功使用以下代码将图像插入现有 pdf 文件到给定的绝对位置：

```
using System.IO;
using iTextSharp.text;
using iTextSharp.text.pdf;

class Program
{
    static void Main(string[] args)
    {
        using (Stream inputPdfStream = new FileStream("input.pdf", FileMode.Open, FileAccess.Read, FileShare.Read))
        using (Stream inputImageStream = new FileStream("some_image.jpg", FileMode.Open, FileAccess.Read, FileShare.Read))
        using (Stream outputPdfStream = new FileStream("result.pdf", FileMode.Create, FileAccess.Write, FileShare.None))
        {
            var reader = new PdfReader(inputPdfStream);
            var stamper = new PdfStamper(reader, outputPdfStream);
            var pdfContentByte = stamper.GetOverContent(1);

            Image image = Image.GetInstance(inputImageStream);
            image.SetAbsolutePosition(100, 100);
            pdfContentByte.AddImage(image);
            stamper.Close();
        }
    }
} 
```

当您插入图像时，您可以调整它的大小。您可以查看iTextSharp 文档中的[转换矩阵](http://itextsharp.sourceforge.net/tutorial/ch10.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-05T14:30:04.697

这是一个类似的示例，它使用压模在页面上插入图像：

[Gmane iTex 邮件列表帖子](http://article.gmane.org/gmane.comp.java.lib.itext.general/20873)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-26T14:20:43.737

我可以通过简单地在我的签名代码中添加以下行来添加图像来解决我的问题

```
 var image = iTextSharp.text.Image.GetInstance(@"C:\Users\sushil\Documents\sansign.jpg");
appearance.Acro6Layers = true;
appearance.SignatureGraphic = image;
appearance.SignatureRenderingMode = PdfSignatureAppearance.RenderingMode.GRAPHIC_AND_DESCRIPTION; 
```

当我用可见的数字签名签署文档时，现在我可以同时拥有图像和数字签名属性

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-25T11:38:06.500

pdftk 可以做到这一点。它不是库，但您可以轻松地从代码中将其作为 .exe 调用。

请参阅`stamp`和`background`命令： [http ://www.pdflabs.com/docs/pdftk-man-page/](http://www.pdflabs.com/docs/pdftk-man-page/)

参考：[如何在 PDF 上进行邮件合并？](https://stackoverflow.com/questions/356502/how-to-do-mail-merge-on-top-of-a-pdf/1485027#1485027)

# actionscript-2 - 阴影框覆盖隐藏闪光灯

> ID：583632
> 
> 赞同：1
> 
> 时间：2009-02-24T21:11:24.227
> 
> 标签：actionscript-2, shadowbox

我有一个网站，主要是用 Flash 制作的。闪光灯触发暗箱。但是当 shadowbox 启动时，该站点在盒子后面是不可见的。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-15T17:23:56.087

这是 TroubleElements 选项 [http://www.shadowbox-js.com/options.html](http://www.shadowbox-js.com/options.html)

您还可以在 K.onOpen() 上禁用 toggleTroubleElements()；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T22:04:43.817

也许浏览器的渲染引擎不允许 Flash 成为透明度的一部分？或者，也许覆盖不是真的透明？只是覆盖层周围的区域没有显示，还是您无法透过覆盖层看到应该部分透明的闪光灯？

在我看来，如果您有一个不透明的（gif 或 jpeg），那么即使您将元素设置为透明，那么它也可能无法与 flash 配合使用。也许尝试制作一个已经透明且没有任何 html/css 样式的 .png 图像？

虽然想到了一个想法，但如果你已经有了大部分 Flash，为什么不在 Flash 中也做覆盖呢？那些可能会更有特色并且有更多的定制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-17T06:10:14.773

搜索“r.style.visibility”并确保将其设置为“可见”

# php - 具有 zend 框架、操作堆栈的模块化网站

> ID：583636
> 
> 赞同：3
> 
> 时间：2009-02-24T21:12:30.527
> 
> 标签：php, zend-framework

如何使用 Zend 框架构建模块化网站。我在数据库中有页面，每个页面都表示为 url。每个页面都有 1toN 的内容。每个内容都有控制器、动作和位置（+其他现在不重要的列）。因此，一个请求是一个页面和多个内容（多个操作）。如何在输出之前构建所有操作？我想要像下面的示例这样的布局设计，其中内容放在容器中（操作在布局打印输出之前运行）。

```
<div id="left">
   <?= $this->layout()->left_container ?>
</div>
<div id="center">
   <?= $this->layout()->center_container ?>
</div>
<div id="right">
   <?= $this->layout()->right_container ?>
</div> 
```

到目前为止，我从布局视图中调用了操作，但我不喜欢这种方法：

```
foreach ($contents as $item) {
    echo $this->action($item['action'], $item['controller'], null, array('content' => $item));
} 
```

谢谢。

**ps**

adepretis 的代码与我的类似，我的操作视图在布局内运行，这意味着当发生错误时，它会打印在调用操作的布局中。在布局输出之前构建操作是否没有乳清？另一件坏事是，在我必须运行的每个操作中...->setResponseSegment，我希望它是自动化的。

**附言 #2**

我找到了答案，它列在下面作为答案。如果有乳清我可以更容易地做到这一点，请写下来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T01:44:05.693

您可以使用[ActionStack 助手](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html#zend.controller.actionhelpers.actionstack)。例如：

```
class MyController_Action extends Zend_Controller_Action {
    function init() {
        /** you might not want to add to the stack if it's a XmlHttpRequest */
        if(!$this->getRequest()->isXmlHttpRequest()) {
            $this->_helper->actionStack('left', 'somecontroller', 'somemodule');
            $this->_helper->actionStack('center', 'somecontroller', 'somemodule');
            $this->_helper->actionStack('right', 'somecontroller', 'somemodule');
        }
}

class MyController extends MyController_Action {
    function indexAction() {
        // do something
    }
}

class SomecontrollerController extends MyController_Action {
    function leftAction() {
        // do something

        $this->_helper->viewRenderer->setResponseSegment('left_container');
    }

    function centerAction() {
        // do something

        $this->_helper->viewRenderer->setResponseSegment('center_container');
    }

    function rightAction() {
        // do something

        $this->_helper->viewRenderer->setResponseSegment('right_container');
    }
} 
```

*对/somemodule/my/index*的请求会导致执行*/somemodule/somecontroller/left*。*/somemodule/somecontroller/right* , */somemodule/somecontroller/center*最终出现在对应的布局段中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T14:34:17.390

我在其他论坛上找到了我的答案。这是答案：

**我的插件**

```
class MyPlugin extends Zend_Controller_Plugin_Abstract
{

    public function routeStartup(Zend_Controller_Request_Abstract $request)
    {
        $action_stack = new Zend_Controller_Action_Helper_ActionStack();
        // here I will read actions from db and run it in loop, but for example few are staticly added bellow
        $action_stack->actionToStack('index', 'content', 'default', array('position' => 'left'));
        $action_stack->actionToStack('index', 'content', 'default', array('position' => 'center'));
        $action_stack->actionToStack('index', 'edo', 'default', array('position' => 'center'));
        $action_stack->actionToStack('left', 'edo', 'default', array('position' => 'left'));
        $action_stack->actionToStack('right', 'edo', 'default', array('position' => 'right'));
    }

} 
```

**BaseController**，每个控制器都扩展

```
class BaseController extends Zend_Controller_Action
{

    public function preDispatch()
    {
        $position = $this->_request->getParam('position', false);
        if ($position) {
            $this->_helper->viewRenderer->setResponseSegment($position);
        }
    }

} 
```

**布局**.phtml

```
<div>
    <h2><u>LEFT:</u></h2>
    <?=$this->layout()->left?>
</div>
<div>
    <h2><u>CENTER:</u></h2>
    <?=$this->layout()->center?>
</div>
<div>
    <h2><u>RIGHT:</u></h2>
    <?=$this->layout()->right?>
</div> 
```

这就是我想要的，如果有人有更好的解决方案，请回答这个问题，我会接受他的回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-24T11:12:31.330

你好我也遇到同样的问题。您建议的解决方案工作正常。但是我的 baseController 在模块 base 中。代码与 baseController 一起工作顺利，但是当我在另一个模块中使用控制器进行扩展时，由于基本控制器无法在其他控制器中识别，因此发生错误例如：modules/base/Controller/baseController modules/user/Controller/userController

任何解决方案？

# c# - c#/.Net Socket.Shutdown

> ID：583637
> 
> 赞同：5
> 
> 时间：2009-02-24T21:13:17.747
> 
> 标签：c#, .net, sockets

我承认这类问题有很长的历史，但我使用它的方式必须是正确的“.net 方式”，但它似乎不起作用。

我有一个简单的同步 IP 服务器守护程序，它执行简单的 AcceptSocket，做一些事情，socket.send，socket.shutdown，socket.close。我的客户端是另一个执行 URLDownloadToFile 的简单 C# 应用程序。

发生的情况是 URLDownloadToFilefails 失败并显示 (0x800C0008) .. 认为其下载资源失败的部分时间。

我的服务器端结束顺序是：

```
socket.Shutdown(Both);
socket.Close(); 
```

如果我将其更改为

```
socket.Disconnect();
socket.Close(); 
```

（我用 sockopt Linger true 打开上面的，超时 5 秒）

这很好用。

我是否在 Shutdown 方法上遗漏了一些东西.. 这听起来像是“魔术子弹”MS 希望您用来优雅地执行退出，最终将发送任何剩余的发送数据。

粗略地说，（这不可能是正确的）它看起来像是关闭..杀死了可能从shutdown（）进行的任何异步处理。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T22:04:22.213

基于[Socket.Disconnect](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.disconnect.aspx)

> 如果您需要在不先调用 Shutdown 的情况下调用 Disconnect，则可以将 DontLinger Socket 选项设置为 false 并指定非零超时间隔，以确保发送排队等待传出传输的数据。断开连接然后阻塞，直到发送数据或直到指定的超时到期。如果将 DontLinger 设置为 false 并指定零超时间隔，则 Close 会释放连接并自动丢弃传出的排队数据。

建议关机充其量是不必要的...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-04T08:10:43.730

要重用套接字，请使用：

```
socket.Shutdown(SocketShutdown.Both);
socket.Disconnect(true); 
```

对于强制关闭使用：

```
socket.Shutdown(SocketShutdown.Both);
socket.Close(); 
```

# asp.net - Session_Start() 如何在服务器场中工作？

> ID：583643
> 
> 赞同：3
> 
> 时间：2009-02-24T21:16:15.027
> 
> 标签：asp.net, session, web-farm, load-balancing

OnSessionStart / Session_Start 事件是否仍然仅在服务器场环境中触发一次（总共），或者由于请求由多个服务器处理，它是否可以在每个服务器上触发一次？

ASP.NET / IIS6 或 7

不应假定服务器正在使用粘性会话**。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T21:49:46.910

对于 IIS 的默认安装，答案是“否”—— Session_Start 通常会触发多次。客户端将在它命中的每个不同服务器上创建一个新会话。如果您在 IIS 中使用 Web Garden 选项，也会出现同样的情况。

如果你不依赖 Session 并且你有一个服务器场，你通常最好完全禁用 Session 状态。这是您的操作方法：http: [//support.microsoft.com/kb/306996](http://support.microsoft.com/kb/306996)

如果您确实依赖 Session，那么您最好的选择可能是 ASP.NET State Server Service。您场中的所有服务器都将使用单个服务器作为 Session 状态，这将确保 Session_Start 只触发一次。有关设置的大量背景和详细信息，请阅读以下内容（查找“状态服务器模式”以获取具体说明）： [http ://aspdotnetdevs.blogspot.com/2008/12/aspnet-session-state-and-modes.html](http://aspdotnetdevs.blogspot.com/2008/12/aspnet-session-state-and-modes.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T22:29:35.223

除了 Thomas：这取决于您的会话状态设置。

在 web.config 中，`<sessionState mode="" >`

如果您使用`mode="InProc"`，您将获得多个 Session 和 SessionStart 事件，每个访问的服务器 1 个。

在其他模式（StateServer 或 SqlServer）中，您将获得 1 个会话和 1 个 SessionStart。您根本**不会**收到 SessionEnd 事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T21:24:58.093

在场中，您将使用 Sql Server 或状态服务器来管理场中所有服务器的会话状态。它让这台服务器负责您的状态，而不是确保每个会话只应调用一次 OnSessionStart，并且无需总是让所有请求返回到同一台服务器。

使用单个服务器来维护会话状态的主要缺点是您不再有 OnSessionEnd 事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T21:21:36.683

我的理解是，一旦请求到达场中的服务器，同一客户端的所有即将到来的请求都应重定向到场中的同一服务器。

# performance - 邻接矩阵的速度提升

> ID：583646
> 
> 赞同：3
> 
> 时间：2009-02-24T21:18:17.690
> 
> 标签：performance, algorithm, refactoring

我目前有一个算法，它在大小为 n x m 的邻接矩阵上运行。在我的算法中，我需要一次将整行或整列清零。我的实现目前是 O(m) 或 O(n)，具体取决于它是列还是行。

有没有办法在 O(1) 时间内将一列或一行归零？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T21:26:46.950

本质上，这取决于您正在处理的芯片架构。对于大多数 CPU，不可能在运行时将整个内存条归零，因此无论您的编程语言提供什么功能，每个单词都需要单独的内存操作。

如果您的内存在内存访问时间上是连续的，这将有很大帮助，因为与刚刚访问的内存相邻的内存将被缓存，随后的访问将命中缓存，从而提高性能。

这样做的结果是，如果您的矩阵很大，一次清零一行或一次清零一列可能会更快，而不是反之亦然，具体取决于您的数据是按列写入还是按行写入。

编辑：我假设您的矩阵不是稀疏的、三角形的或其他特殊的，因为您谈论的是“将整行归零”。如果您知道您的矩阵大部分是空的，或者以其他方式适合特殊模式，您将能够以不同的方式（不是简单的 nxm 数组）表示您的矩阵，并且故事会有所不同。但是如果你现在有一个 nxm 矩阵，那么就是这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T21:39:02.180

距离度量和图形是无向的吗？（在这种情况下，矩阵是对称的）。在这种情况下，您可以在整个程序中对下三角矩阵或上三角矩阵进行操作。这样，您只需将一行（或列，如果您正在处理上三角形）清零。即使那样，它也不会是一整行，平均一半。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-28T15:33:37.483

这取决于您的矩阵是如何实现的。

如果您有诸如数组数组之类的表示形式，则可以指向共享的零元素数组，只要您检查以后没有写入它即可。这意味着行或列中的一个可以在 O(N) 中归零，而所有其他写入操作的成本都是恒定的。

您还可以有几个数组——一个用于行，一个用于列——它们缩放矩阵中的值。在其中一个中置零将是一个 O(1) 操作来屏蔽一行或一列，代价是每次读取都需要额外的处理；但如果这是一个常见的用例，作为一种从图中临时删除节点的方法可能是值得的。它还保持原始版本的矩阵不变，因此您可以并行化您的算法（假设它需要的唯一操作是将所有边修剪到节点中或从节点中修剪出来）。

# asp.net - 有没有一种为 ASP.NET 站点创建循环导入的好方法？

> ID：583648
> 
> 赞同：0
> 
> 时间：2009-02-24T21:19:05.627
> 
> 标签：asp.net, sql-server, iis, scheduled-tasks, recurring

我正在处理的站点正在运行 Windows Server 2003 和 SQL Server 8（2000？）以及 ASP.NET 3.5。

我需要运行某种脚本或应用程序来将 FTP 文本文件中的数据导入数据库。机器上已经有一个站点正在运行，该站点使用当前数据库。我可以使用计划任务可靠地启动某种将导入数据的 .aspx 页面吗？还是有更好的方法？

如何确保没有其他人可以访问运行导入的页面？我不希望随机用户运行导入！

提前致谢！

PS 在插入之前需要对数据进行一些处理。即查找、条件等，所以数据库工具不够健壮（我认为）。我讨厌 DTS，而且我认为我的 SSIS 在这个版本中不可用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T21:29:43.620

如果您想让 C# 应用程序处理您的导入，我建议您使用带有 oa 表单的 Windows 应用程序 (exe)（比控制台应用程序更好，因为它在运行时不会弹出任何 UI）。让它按计划任务每​​隔一段时间（每分钟）运行一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T21:21:28.820

为什么要使用 ASP.NET？根据作业的复杂性，如果需要更复杂的处理，您可以将其直接加载到数据库 (BULK LOAD) 或使用 DTS (SQL Server 2000) 或 SSIS (SQL Server 2005/2008)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T21:22:54.357

运行 BULK INSERT 或 bcp 来导入数据，请参阅此处 [http://msdn.microsoft.com/en-us/library/aa173839(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa173839(SQL.80).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T21:37:22.790

我会在这里回应其他人 - 你不想让计划任务点击网页。SQL Server 提供了一些不错的数据导入选项，或者您可以编写一个简单的 windows 程序并将其作为计划任务运行。

另一种选择是编写一个 Windows 服务来监视您的 FTP 目录并进行导入。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T23:39:03.297

DTS 和存储过程中的一个作业。

作业中的 BCP 和存储过程。

你说你需要做很多查找和转换？SQL 擅长于此 - 并且擅长快速完成。起初它看起来有点吓人，但并不难。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T22:01:42.280

正如其他人所说，可能一个单独的控制台应用程序（由计划任务触发）或 Windows 服务将是这种情况下的最佳选择。

另一方面，如果您已经在服务器上运行的 Web 应用程序中提供了所有必需的功能，那么您可能会设置一个计划任务，它启动一个脚本（VBscript、JScript），然后调用一个页面网络应用程序。

为了获得某种安全性（例如，防止任何用户可以调用该页面），您可以向页面添加一些代码，以检查该页面是否使用[http://localhost](http://localhost)调用。这至少可以防止从远程客户端调用该页面。

# jquery - 没有子网格的 jqGrid 分组？

> ID：583662
> 
> 赞同：2
> 
> 时间：2009-02-24T21:22:27.227
> 
> 标签：jquery, jqgrid, grouping

是否可以在不使用 subgrids 的情况下在 jqgrid 中进行分组？我只想要一个包含组标题的所有列的标题，而不是具有不同标题的子网格。我能找到的唯一分组示例似乎使用了完整的子网格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-26T22:29:41.240

jqGrid 3.8 现在支持没有子网格的分组。

见：[http ://www.trirand.com/blog/?p=690](http://www.trirand.com/blog/?p=690)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-01T17:55:33.640

正如 Sonny 所指出的，分组现在是 jqGrid 的一部分 - 您可以在[此页面上](http://trirand.com/blog/jqgrid/jqgrid.html)的 Grouping 下查看演示。

最初我以为你的意思是对列标题进行分组，jqGrid 仍然不支持：[jqGrid 论坛 - about-grouping-column-header](http://www.trirand.com/blog/?page_id=393/feature-request/about-grouping-column-header/&value=header&type=1&include=1&search=1)。不过，这将是一个不错的功能。

# c# - 处理与自定义布尔类型的比较？

> ID：583687
> 
> 赞同：3
> 
> 时间：2009-02-24T21:28:11.660
> 
> 标签：c#, comparison

我有一个自定义对象，它将布尔值从旧数据库映射到 C# bool（然后再返回）。

我的自定义 bool 对象如下所示：

```
public class S2kBool : IUserDefinedType {
    public bool Value { get; set; }

    public Type SupportedType { get { return typeof(string); } }

    // These are the values used to represent booleans in the database
    public const string TrueValue = "Y";
    public const string FalseValue = "N";

    public static S2kBool True {
        get { return new S2kBool(true); }
    }

    public static S2kBool False {
        get { return new S2kBool(false); }
    }

    public S2kBool() : this(false) { }

    public S2kBool(bool value) {
        this.Value = value;
    }

    // Called when a property of this type is populated from the database
    public void FromSimpleDataType(object value) {
        this.Value = value.ToString() == TrueValue;
    }

    // Called when a property of this type is inserted into the database
    public object ToSimpleDataType() {
        return this.Value ? TrueValue : FalseValue;
    }
} 
```

我希望能够做这样的事情：

```
public class TestObject {
    public S2kBool IsActive = S2kBool.True;
}

TestObject tObj = new TestObject();
if (tObj.IsActive == S2kBool.True) {
    // the above would evaluate to true
} 
```

我见过几种不同的方法来进行对象之间的比较，但我不确定该使用哪一种。

编辑：更好的是，是否可以执行以下操作并让 C# 在比较期间将 S2kBool 对象视为实际的布尔值？它还应该允许与其他 S2kBool 对象进行比较。

```
if (tObj.IsActive == true) { ... } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T21:34:26.323

有两件事要看；隐式转换运算符（in `S2kBool`）到`bool`，或`true`/`false`运算符本身...

* * *

真/假运算符（注意我自己更喜欢隐式布尔转换）：

```
public static bool operator true(S2kBool x) {
    return x.Value;
}
public static bool operator false(S2kBool x) {
    return !x.Value;
} 
```

那么你可以使用`if(tObj.IsActive)`

* * *

转换运算符：

```
public static implicit operator bool(S2kBool x) {
    return x.Value;
} 
```

同样有效

* * *

您还可以在另一个方向添加转换：

```
public static implicit operator S2kBool(bool x)
{
    return new S2kBool(x);
} 
```

然后你可以分配`IsActive = false;`等

* * *

最后，我想知道这是否应该是一个不可变的结构？如果您期望它表现得像一个值，那可能会令人困惑。例如，看这里的最后一行：

```
TestObject obj1 = new TestObject(),
           obj2 = new TestObject();
obj1.IsActive = obj2.IsActive = S2kBool.True;

Console.WriteLine(obj1.IsActive);
Console.WriteLine(obj2.IsActive);

obj1.IsActive.Value = false;

Console.WriteLine(obj1.IsActive);
Console.WriteLine(obj2.IsActive); // what does this print? 
```

这打印错误，因为两个*字段*都`IsActive`指向. 如果这是本意，那很好。但如果是我，我会让它不可变（无论是类还是结构）。但由于它除了布尔值之外没有任何状态，我认为这很适合作为结构体。*`S2kBool`*

 *老实说，当所有功能都可以通过静态方法/等完成时，我并不*完全*确定*为什么*需要它。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T21:37:02.357

是的，你可以这么做。您需要定义相等运算符并覆盖 Equals 方法。

这是一篇关于运算符重载的文章： [http ://www.csharphelp.com/archives/archive135.html](http://www.csharphelp.com/archives/archive135.html)

下面是一个具有重写相等运算符的类型示例。您可以对赋值和转换运算符执行相同的操作，使您的类型与内置的 bool 类型无缝协作。（我以您的示例为例，将其缩短了一点以保持示例简短，并添加了相等运算符）。

```
public struct S2kBool : IEquatable<bool>
{
    public bool Value { get; set; }

    public bool Equals(bool other)
    {
        return Value == other;
    }

    public override int GetHashCode()
    {
        return Value.GetHashCode();
    }

    public static bool operator ==(bool left, S2kBool right)
    {
        return right.Equals(left);
    }

    public static bool operator !=(bool left, S2kBool right)
    {
        return !(left == right);
    }

    public static bool operator ==(S2kBool left, bool right)
    {
        return left.Equals(right);
    }

    public static bool operator !=(S2kBool left, bool right)
    {
        return !(left == right);
    }

} 
```

# c# - 字典 列表的 和 ASP.NET 中的 ListViews

> ID：583689
> 
> 赞同：19
> 
> 时间：2009-02-24T21:28:20.053
> 
> 标签：c#, .net, asp.net, data-binding, listview

### 前言

我问这个问题是因为即使我已经阅读了很多 ListView 资源，我仍然没有“得到”它。

### 背景

我有一堆`Foo`'s 有一个与之关联的项目列表（*称为* `Bar`），我将它们从数据访问/业务逻辑层中提取为包含 a`Foo`及其关联的`Bars`. 我想将网页上的这些项目吐出到一个下拉列表中，`ListView`其中包含`Foo.Name`左侧和`List<Bar>`右侧的 。（下面是我美丽的 ASCII 艺术作品）：

### 列表显示

```
-------------------------------------------------- ----------------
| 物品名称 | DropDownList (List<T>) |
|----------------------------------| _____________________ |
| foo1 | | 酒吧1 | v | |
| | |_______________|___| |  
-------------------------------------------------- ----------------
| | DropDownList (List<T>) |
| | _____________________ |
| foo2 | | 酒吧2 | v | |
| | |_______________|___| |
-------------------------------------------------- ----------------

```

好吧，这就是发生的事情。这是一个列表视图；这些项目从数据库中提取到`Dictionary<Foo, List<Bar>>`. 我试图从字典中获取键值以显示在“项目名称”下，并试图让“List<T> Bar”显示为 ListView 右侧的 DropDownList。

### 类图

```
----------------- -----------------
| 福 | | 酒吧 |
----------------- -----------------
| 身份证 | | 物品名称 |
| 姓名 | | 项目价值 |
| 条码 | | |
----------------- -----------------

```

回顾一下，我想将 Dictionary.Key“名称”放入 ListView 的左侧，将 Dictionary.Value（恰好是一个列表）放入右侧的 DropdownList 中。

因此，对于每个键/值对，都会有一个名称和一个下拉列表，其中包含每个键的值。

但我遇到了问题（显然），希望有人能告诉我我做错了什么。

### 代码背后：

```
 protected Dictionary<Foo, List<Bar>> FooDictionary
        {
            get; 
            set; 
        }

protected void DataBindFooList(List<int> SelectedFoos)
        {
            System.Web.UI.WebControls.ListView lv = lvFooList;

try
            {
                Dictionary<Foo, List<Bar>> fooDictionary =
                    new Dictionary<Foo, List<Bar>>();

                foreach (int Foo in SelectedFoos)
                {
                 // Build List of Foos to add as Dictionary.Keys
                 fooDictionary.Add(fooScalar, Bar)                     
                }
                FooDictionary = fooDictionary;
                lv.DataSource = FooDictionary;
                lv.DataBind();
                ddlListOfBars.DataSource = FooDictionary;
                ddlListOfBars.DataValueField = "ItemValue";
                ddlListOfBars.DataTextField = "ItemName";
                ddlListOfBars.DataBind();
            }
            catch (Exception ex)
            {
                SetMessage(divFooMsg, "Unable to retrieve Foos: " + 
                ex.Message, true, true);
            } 
```

### 列表视图代码：

```
<asp:ListView ID="lvFooList" runat="server">
   <LayoutTemplate>
      <asp:PlaceHolder runat="server" ID="itemPlaceholder"></asp:PlaceHolder>
   </LayoutTemplate>
      <ItemSeparatorTemplate>
         <hr />
      </ItemSeparatorTemplate>
   <ItemTemplate>
      <%#Eval("Name") %>
      <asp:DropDownList ID="ddlListOfBars" runat="server"></asp:DropDownList>
    </ItemTemplate>
   </asp:ListView> 
```

* * *

### 问题：

1.  是否可以以这种方式使用字典？
2.  关于我哪里出错的任何指示？（资源、提示等会有所帮助）
3.  有一个更好的方法吗？
4.  如果这个问题很清楚，请发表评论，以便我弄清楚如何改进它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T22:10:27.517

出现您的问题是因为在 DataBindFooList() 中对 ddlListOfBars 进行数据绑定没有意义，因为数据绑定不只有一个 DropDownList。当你调用 lv.DataBind() 时，ListView 会为每个 Foo 创建一个 ItemTemplate 的副本，每个都包含一个 ddlListOfBars。您需要告诉它将每个 DropDownList 绑定到正确的 List<Bar> 。您可以通过使用数据绑定表达式而不是在后面的代码中设置 ddlListOfBars 的数据源来做到这一点：

```
<ItemTemplate>
  <%#Eval("Key.Name") %>
  <asp:DropDownList
        ID="ddlListOfBars"
        runat="server"
        DataSource='<%#Eval("Value")%>'
        DataValueField="ItemValue"
        DataTextField="ItemName" />
</ItemTemplate> 
```

请注意，您还需要使用“Key.Name”来获取 Foo 的 name 属性。您绑定到的各个字典项是 KeyValuePair<Foo,List<Bar>>，它具有分别用于访问 Foo 和 List<Bar> 的 Key 属性和 Value 属性。

**编辑**
如果您在 ItemTemplate 中有很多事情发生，那么将内容移出到用户控件中会很有用。用户控件可以具有访问 DataItem 的强类型属性，并且具有对其子控件的强类型访问。这为您提供了 ItemDataBound 事件的灵活性，而没有所有的强制转换和 FindControl() 噪音。我怀疑我会在这种情况下打扰，但它会像

```
<asp:ListView ID="lvFooList" runat="server">
<LayoutTemplate>
  <asp:PlaceHolder runat="server" ID="itemPlaceholder"></asp:PlaceHolder>
</LayoutTemplate>
  <ItemSeparatorTemplate>
     <hr />
  </ItemSeparatorTemplate>
<ItemTemplate>
  <uc:ListViewContents DataItem='<%# Container.DataItem %>' />
</ItemTemplate> 
```

ListViewContents.ascx...

```
<asp:Label ID="lbName" runat="server"/>
<asp:DropDownList ID="ddlListOfBars" runat="server"></asp:DropDownList> 
```

ListViewContents.ascx.cs...

```
public KeyValuePair<Foo,List<Bar>> DataItem
{
    get; set;
}

protected override void OnDataBinding(EventArgs e)
{
    base.OnDataBinding(e);

    lbName.Text = DataItem.Key.Name;

    ddlListOfBars.DataTextField = "ItemName";
    ddlListOfBars.DataValueField = "ItemValue";
    ddlListOfBars.DataSource = DataItem.Value;
    ddlListOfBars.DataBind();   
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T22:05:51.380

是这样的你想要什么：

```
 <asp:ListView ID="lvFooList" runat="server">
    <LayoutTemplate>
      <asp:PlaceHolder runat="server" ID="itemPlaceholder"></asp:PlaceHolder>
    </LayoutTemplate>
      <ItemSeparatorTemplate>
         <hr />
      </ItemSeparatorTemplate>
    <ItemTemplate>
      <asp:Label ID="lbName" runat="server"/>
      <asp:DropDownList ID="ddlListOfBars" runat="server"></asp:DropDownList>
    </ItemTemplate>
   </asp:ListView> 
```

然后我写了一个非常快速的讨厌的测试

```
 public class Foo
    {
        public string Name;
    }

    public class Bar
    {
        public string ItemName { get; set; }
        public string ItemValue { get; set; }
    }

    protected void Page_Load(object sender, EventArgs e)
    {

        var fooKey1 = new Foo() {Name = "foo1"};
        var barList1 = new List<Bar>()
               {
                   new Bar() {ItemName = "bar1", ItemValue = "barV1"},
                   new Bar() {ItemName = "bar2", ItemValue = "barV2"}
               };
        var fooKey2 = new Foo() {Name = "foo2"};
        var barList2 = new List<Bar>()
               {
                   new Bar() {ItemName = "bar3", ItemValue = "barV3"},
                   new Bar() {ItemName = "bar4", ItemValue = "barV4"}
               };

        var dicFooBar = new Dictionary<Foo, List<Bar>>() {{fooKey1, barList1}, {fooKey2, barList2}};

        lvFooList.ItemDataBound += lvFooList_ItemDataBound;
        lvFooList.DataSource = dicFooBar;
        lvFooList.DataBind();
    }

    void lvFooList_ItemDataBound(object sender, ListViewItemEventArgs e)
    {
        var dataItem = (ListViewDataItem)e.Item;
        var fooBarList = (KeyValuePair<Foo, List<Bar>>)dataItem.DataItem;

        ((Label) dataItem.FindControl("lbName")).Text = fooBarList.Key.Name;

        var ddlListOfBars = (DropDownList) dataItem.FindControl("ddlListOfBars");
        ddlListOfBars.DataTextField = "ItemName";
        ddlListOfBars.DataValueField = "ItemValue";
        ddlListOfBars.DataSource = fooBarList.Value;
        ddlListOfBars.DataBind();
    } 
```

似乎做你想做的事，但我的代码只是快速测试代码，所以要注意。它确实按预期呈现。

# iphone - 如何检查一周中的哪一天（即周二、周五？）并比较两个 NSDate？

> ID：583692
> 
> 赞同：11
> 
> 时间：2009-02-24T21:28:58.647
> 
> 标签：iphone, objective-c

我正在寻找两个做两件事：

1.  检查一周是否过去（基于星期几）
2.  检查一天是否已经过去（基于日期）

我不确定解决这个问题的最佳方法是什么，因为在比较两个 NSDate 时（一个在 2009 年 1 月 1 日 21:30，另一个在 09 年 1 月 2 日 00:30）我不能只看到如果 24 小时过去了，在这种情况下它还没有。我可以通过从 NSDate 获取日期 1/1/09 来解决这个问题，但我不确定如何根据我看到的文档和谷歌链接来解决这个问题。

对于另一个问题，我不知道如何知道给定日期是一周中的哪一天。我想如果 09 年 1 月 1 日是星期二、星期一等......有没有图书馆可以让你计算这个？这显然需要考虑闰年和大量其他东西......也许有一个objective-c库来解决这个问题？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-24T21:54:31.800

您可以使用该类的[`components:fromData:`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSCalendar_Class/Reference/NSCalendar.html#//apple_ref/occ/instm/NSCalendar/components:fromDate:)消息`NSCalendar`来获取各个日期组件：

```
// Sunday = 1, Saturday = 7
int weekday = [[[NSCalendar currentCalendar] components:NSWeekdayCalendarUnit fromDate:theDate] weekday]; 
```

要比较两个日期，只需使用以下[`compare:`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDate/compare:)消息：

```
switch([date1 compare:date2])
{
case NSOrderedSame:       /* they are the same date */ break;
case NSOrderedAscending:  /* date1 precedes date2 */ break;
case NSOrderedDescending: /* date2 precedes date1 */ break;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-24T21:39:32.647

您可以`NSDateComponents`为此使用：

```
unsigned units = NSYearCalendarUnit | NSMonthCalendarUnit |  NSDayCalendarUnit;
NSCalendar *gregorian = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
NSDateComponents *components = [gregorian components:units fromDate:date]; 
```

然后您可以像这样访问日期的各个部分：

```
[components year];
[components month];
[components day]; 
```

`NSCalendar`或者，您可以使用's方法构造一个新的 NSDate 对象`dateFromComponents`，并比较这两个`NSDate`对象。

# debugging - Solaris pstack 输出：“SYS#0”是什么意思？

> ID：583694
> 
> 赞同：2
> 
> 时间：2009-02-24T21:29:23.683
> 
> 标签：debugging, gcc, solaris

我在堆栈顶部遇到了“SYS#0”，找不到任何关于这意味着什么的文档。

*   编译器：g++
*   操作系统：Solaris 9
*   拱门：SPARC
*   [来自Hoard 3.5.1](http://hoard.org/)的内存管理器 libhoard_32.so

我们使用“gcore”来生成核心文件。查看针对核心文件运行“pstack”命令的输出，唯一正在做任何有趣事情的线程在其调用堆栈的最顶部有以下内容：

```
ff309858 SYS#0    ()
ff309848 void MyHashMap<const void*,unsigned,AlignedMmapInstance<65536U>::SourceHeap>::set(const void*,unsigned) (ff31eed4, 9bf20000, 10000, 40, 9bf1fff0, ff31e738) + 134
... 
```

该 LWP 的 pflags 显示：

```
/8:   flags = PR_STOPPED|PR_ISTOP|PR_ASLEEP
why = PR_REQUESTED
sigmask = 0xfffffeff,0x00003fff 
```

我在 Sun 文档中找不到任何提及此语法的内容。

**编辑：**在执行 gcore 之前，该过程似乎已经挂起。“SYS#0”是否与进程挂起有某种关联？

**编辑：**添加了下一个堆栈帧并链接到 Hoard、pflags 输出

**编辑：**接受的答案是正确的。此外，至少在 SPARC 上，`g1`寄存器[应该](http://forums.sun.com/thread.jspa?threadID=5184453&tstart=570) [包含](http://blogs.oracle.com/gavinm/entry/sparc_system_calls)系统调用号，但在我们的核心文件中似乎不是这种情况。

主题“什么是间接系统调用？” 可能是另一个问题的好材料。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-28T12:21:20.770

试试这个：

```
$ cat foo.c
#include <stdio.h>

int main(int argc, char *argv[]) {

    char buf[1024];
    proc_sysname(0, buf, 1024);
    printf("%s\n", buf);

}
$ gcc -ofoo -lproc foo.c
$ ./foo
SYS#0
$ 
```

`SYS#0`因此是表示系统调用零的字符串。如果您查看`<sys/syscall.h>`（系统调用表），您会发现以下内容：

```
/* syscall enumeration MUST begin with 1 */

/*
 * SunOS/SPARC uses 0 for the indirect system call SYS_syscall
 * but this doesn't count because it is just another way
 * to specify the real system call number.
 */

#define SYS_syscall 0 
```

间接系统调用`syscall(SYS_syscall, foo, bar, ...)`等价于直接调用`syscall(foo, bar, ...)`。

# jquery - 为什么这个 jQuery.post 不能与 Perl CGI 一起工作？

> ID：583701
> 
> 赞同：3
> 
> 时间：2009-02-24T21:32:09.200
> 
> 标签：jquery, perl, cgi

我试图弄清楚为什么我没有看到带有 $.post("/url/", {wtf: 2}) 的参数。

我正在使用这个 perl：

```
use strict;
use CGI;

my $cgi = new CGI;
print $cgi->header("text/javascript");
print "'no'";

use Data::Dumper;
warn Dumper({ (map {$_=>$cgi->param($_ )} $cgi->param), postdata=>$cgi->param("POSTDATA") }); 
```

当我发出 $.get("/url", {wtf: 2}) 时，我得到了我期望的结果，并在日志中发现 wtf 为 2。当我使用 $.post("/url/", {wtf: 2}) 时，我似乎根本没有得到任何参数（日志中只有一个 $VAR1 = { postdata=>undef }）。

我错过了什么？

Firebug 显示：Transfer-Encoding 是“分块”，Content-Type 是“application/x-www-form-urlencoded; charset=UTF-8”。此外，Post 选项卡似乎显示了请求中的参数，但 CGI 没有任何乐趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T22:40:29.910

可能是您的结果既没有返回 application/x-www-form-urlencoded 也没有返回 multipart/form-data。[CGI doc](http://search.cpan.org/perldoc?CGI#HANDLING_NON-URLENCODED_ARGUMENTS)对此有这样的说法：

> 如果 POST 数据的类型不是 application/x-www-form-urlencoded 或 multipart/form-data，则不会处理 POST 数据，而是在名为 POSTDATA 的参数中按原样返回。要检索它，请使用如下代码：

```
 my $data = $query->param('POSTDATA'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T21:32:36.243

如果您可以访问 linux 机器，您可以设置 'nc' (netcat) 以侦听端口 80 并查看您收到的原始请求。

我怀疑这是一个服务器端的问题。也许某些 Apache 配置有干扰？抱歉，我无法提供更多帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-07T10:04:55.000

我遇到了同样的问题，尽管我使用的是 CGI::Lite。

原来 jquery 中的 .post 函数似乎覆盖了表单的内容类型，即使它已被明确设置。一个简单的“ngrep”显示它总是通过：

```
application/x-www-form-urlencoded; charset=UTF-8 
```

问题是，CGI::Lite 模块只期望*完全*匹配 'application/x-www-form-urlencoded'（即没有字符集位）。

在 CGI/Lite.pm 中将这行代码从完全匹配更改为正则表达式匹配，这对我有用：

```
#($content_type eq 'application/x-www-form-urlencoded')) {
($content_type =~  /application\/x-www-form-urlencoded/)) { 
```

# apache - 重定向 URL（使用特定的 GET 参数）

> ID：583705
> 
> 赞同：4
> 
> 时间：2009-02-24T21:34:05.420
> 
> 标签：apache, http, redirect

我有这个旧的调查链接已被另一个链接取代，所以基本上我希望任何人都可以尝试访问该 URL：

[http://mywebsite.com/survey/view_survey.php?surveyID=1](http://mywebsite.com/survey/view_survey.php?surveyID=1)

被重定向到：

[http://mywebsite.com/survey/view_survey.php?surveyID=2](http://mywebsite.com/survey/view_survey.php?surveyID=2)

我可以在 Apache 配置或 htaccess 文件中执行此操作吗？

我在 httpd.conf 文件的 Redirect 部分尝试了以下规则：

```
Redirect 301 /survey/view_survey.php?surveyID=1 http://mywebsite.com/survey/view_survey.php?surveyID=2 
```

但它不起作用。我怀疑在处理规则时没有使用 GET 参数。

我唯一的选择是破解我的代码以重定向特定的surveyID吗？

* * *

按照使用重写规则的建议，我在 .htaccess 文件中尝试了以下内容：

```
RewriteRule ^survey/view_survey\.php\?surveyID=1525$ /survey/view_survey.php?sur
veyID=1607 
```

但这不起作用。我确实启动并运行了重写引擎，因为我当前正在运行另一个重写规则。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T22:01:56.507

在 .htaccess 文件中试试这个：

```
RewriteEngine on
RewriteCond %{QUERY_STRING} (^|.*&)surveyID=1525(&.*|$)
RewriteRule ^survey/view_survey\.php$ /survey/view_survey.php?%1surveyID=1607%2 [L,R=301] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T22:01:12.313

```
RewriteEngine On
RewriteCond %{QUERY_STRING} ^surveyID=1525$
RewriteRule ^/survey/view_survey\.php /survey/view_survey.php?surveyID=1607 [R=301] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T21:39:58.167

查看 mod_rewrite 的 QSA 部分。

它执行 GET 字符串操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-22T11:07:04.193

此问题可能存在重复，如果此解决方案不适合您，则可以解决：

[Apache Redirect 301 在使用 GET 参数时失败，例如 ?blah=](https://stackoverflow.com/questions/1260632/apache-redirect-301-fails-when-using-get-parameters-such-as-blah)

# language-agnostic - 你如何重构一个不断被编辑的类？

> ID：583708
> 
> 赞同：10
> 
> 时间：2009-02-24T21:35:55.057
> 
> 标签：language-agnostic, version-control, refactoring

随着时间的推移，我的团队创建了一个中心类，它处理职责的集合并运行超过 8,000 行，所有这些都是手写的，而不是自动生成的。

任务已经下来了。我们需要重构怪物类。该计划的最大部分是将功能类别定义到它们自己的类中，并与怪物类有关系。

这意味着目前有很多参考文献是这样写的：

```
var monster = new orMonster();
var timeToOpen = monster.OpeningTime.Subtract(DateTime.Now); 
```

很快就会变成这样：

```
var monster = new Monster();
var timeToOpen = monster.TimeKeeper.OpeningTime.Subtract(DateTime.Now); 
```

问题是：我们究竟如何协调这种变化？每个商务舱都提到“orMonster”。在代码中的数千个地方调用了一些方法。可以保证，只要我们有这样的机会，团队中的其他人（可能是多个其他人）都会检查调用 .OpeningTime 属性的代码

您如何协调如此大规模的变化而不会停止生产力？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-24T21:41:24.107

您应该让旧方法调用新方法。然后随着时间的推移更改对旧方法的引用以调用新方法。更改所有客户端引用后，您可以删除旧方法。

有关详细信息，请参阅Martin Fowler 的经典著作《[重构》中的](https://rads.stackoverflow.com/amzn/click/com/0201485672)[移动方法](http://www.refactoring.com/catalog/moveMethod.html)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-24T21:40:51.037

您可以做的一件事是将代理方法暂时留在将委托给新方法的怪物类中。大约一周后，一旦您确定所有代码都在使用新方法，那么您就可以安全地删除代理了。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-24T21:43:00.827

我之前已经通过继续重构代码来处理这个问题，然后添加与旧签名匹配的方法，将调用转发到新方法。如果您将“过时”属性添加到这些临时方法，您的代码仍将使用旧方法调用和新方法调用构建。然后随着时间的推移，您可以返回并升级调用旧方法的代码。这里的不同之处在于，您将在构建期间收到“警告”，以帮助您找到所有需要升级的代码。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-24T21:43:45.490

我不确定您使用的是什么语言，但在 .Net 中，您可以创建编译器警告，这将允许您暂时保留旧引用，以便它们按预期运行，但会向您的其他开发人员发出警告。

[http://dotnettipoftheday.org/tips/ObsoleteAttribute.aspx](http://dotnettipoftheday.org/tips/ObsoleteAttribute.aspx)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-24T21:48:48.613

在分支中开发您的更改。将代码子集分解为新类，在客户端基础上进行更改，彻底测试，然后合并回来。

这将破坏集中在你合并的时候——而不是整个开发周期。

将此与帕特里克的建议结合起来，[让怪物叫小怪物](https://stackoverflow.com/questions/583708/how-do-you-refactor-a-class-that-is-constantly-being-edited/583727#583727)。如果您合并的客户端代码破坏了对该客户端的更改，这将让您轻松恢复。正如帕特里克所说，一旦你证明没有人使用它，你就可以删除怪物的方法（现在是存根）。

我还回应了几位发帖人的建议，即直接暴露被破坏的课程——而不是通过怪物。为什么只使用一半的治疗？以同样的努力，您可以完全治愈。

最后：编写单元测试。编写大量单元测试。哦，男孩，你需要单元测试来安全地完成这个。我有没有提到你需要单元测试？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-24T21:45:15.707

保留旧方法并转发到新方法（正如其他人所说），但还要在转发方法中发送日志消息以提醒自己将其删除。

您可以添加评论，但这太容易错过了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-24T21:41:54.637

建议使用诸如 nDepend 之类的工具来识别对类方法的所有引用。nDepend 的输出可用于让您更好地了解如何对方法进行分组。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-24T21:46:54.627

```
var monster = new Monster();
var timeToOpen = monster.TimeKeeper.OpeningTime.Subtract(DateTime.Now); 
```

我不确定将其拆分并仅将其部分公开是否会更好。这违反了 demeter 法则，并可能导致 NullReference 痛苦。

我建议在不涉及怪物的情况下将计时器暴露给人们。

如果有的话，您最好分析 API 并查看可以在怪物中剪切和封装的内容。当然，让怪物玩具来玩而不是让怪物自己做所有的工作是一个很好的选择。主要工作是定义玩具怪物需要简化他的工作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-24T21:41:43.750

不要重构它。

重新开始并遵循得墨忒耳定律。创建第二个怪物类并从头开始。当第二个怪物类完成并开始工作时，替换第一个怪物的出现。换掉吧 希望他们共享一个界面，或者您可以做到这一点。

而不是这个：“monster.TimeKeeper.OpeningTime.Subtract(DateTime.Now)”

这样做：monster.SubtractOpeningTime(DateTime.Now)。不要用点符号杀死自己（因此是分米）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-24T21:46:42.893

有几个人就重构本身的编排提供了很好的答案。这是关键。但是您还询问了协调多人之间的更改（我认为这是您问题的症结所在）。你用的是什么源代码控制？像 CVS、SVN 等任何东西都可以同时处理来自多个开发人员的传入更改。让它顺利进行的关键是每个人都必须使他们的提交变得细化和原子化，并且每个开发人员都应该经常拉取其他人的提交。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-17T17:16:17.467

我将首先看一下使用部分类将单个怪物类拆分为许多文件，将方法分组到类别中。

当您拆分文件时，您需要阻止任何人编辑怪物类。

从那时起，您可能会减少合并冲突，因为每个文件的编辑都会减少。然后，您可以更改怪物类中的每个方法（每次签入一个方法）以调用您的新类。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-02-24T21:49:33.947

如此庞大的班级真的是个问题。既然这么大，没人觉得不舒服，那项目政策肯定有问题。我会说你应该分成几对并进行结对编程。为每一对程序员创建一个分支。为重构工作 1-2 天。比较你的结果。这将帮助您避免重构从一开始就走错方向并最终导致需要从头开始重写 Monster 类的情况。

# c++ - Geany 中的链接类

> ID：583710
> 
> 赞同：0
> 
> 时间：2009-02-24T21:36:07.193
> 
> 标签：c++, class, linker

我正在 Geany（一个 C++ IDE）中为 Linux 编写一个 CLI 应用程序。我想链接一个简单的配置文件阅读器类，以便它可以在我的程序中使用。仅仅包括它不起作用，我得到未定义的参考错误。我知道如何在 Windows 上的 Dev-C++ 中做到这一点，但不知道 Geany。感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T21:41:35.607

您没有在适当的库中链接。必须有一个叫做链接器选项的东西。检查文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-01T20:10:24.780

对于 Geanie，您必须 #include 标头和 .cpp 否则它将不断给您未定义的参考错误。它对我有用；希望它对你有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-24T13:03:28.453

您将需要像在命令行上那样添加路径。配置菜单可以在 Build->Set build commands 找到。

对于较大的项目，建议使用例如 Makefiles。

# c# - 中继器中的更新面板

> ID：583731
> 
> 赞同：1
> 
> 时间：2009-02-24T21:42:19.830
> 
> 标签：c#, asp.net, updatepanel, user-controls, repeater

我有一个 UserControl，它在 UpdatePanel 内部和 Repeater 外部包含投票按钮，它工作得很好。在中继器中，单击按钮会触发相应的事件。该事件应该更新用户控件中的控件文本，并且应该在 UpdatePanel 刷新时反映该更新。

如果在 UpdateMode Always 和 Conditional 中尝试 UpdatePanel（在 _Click 方法中对属性进行更改后触发 Update 事件，则两种方式都会发生相同的问题。

UpdatePanels 在我缺少的中继器中的行为方式有什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T21:49:39.330

原因可能与更新面板无关，而是与您的 UserControl 的回发丢失轨道有关。可能为您的用户控件分配唯一 ID 可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T21:46:05.440

你的中继器正在建立一个正确的表吗？问题很可能是更新面板生成了一个 div 标签，并且它可能在任何 TR 和 TD 标签之外，因此浏览器不知道如何处理它。

[http://www.netortech.com/blog/?articleid=8](http://www.netortech.com/blog/?articleid=8)

# macos - 在 OSX 上以编程方式确定物理内存大小

> ID：583736
> 
> 赞同：7
> 
> 时间：2009-02-24T21:43:45.880
> 
> 标签：macos, memory

我们试图找出运行 Mac OS X 的机器上安装了多少物理内存。我们找到了 BSD 函数 sysctl()。问题是这个函数想要返回一个 32 位的值，但是一些 Mac 能够处理高达 32 GB 的地址，这不适合 32 位的值。（实际上，即使 4 GB 也不适合 32 位值。）OS X（10.4 或更高版本）上是否有另一个 API 可以为我们提供此信息？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-12-15T20:00:52.037

答案是使用 sysctl 来获取 hw.memsize ，如上一个答案中所建议的那样。这是执行此操作的实际代码。

```
#include <sys/types.h>
#include <sys/sysctl.h>

...

    int mib[2];
    int64_t physical_memory;
    size_t length;

    // Get the Physical memory size
    mib[0] = CTL_HW;
    mib[1] = HW_MEMSIZE;
    length = sizeof(int64_t);
    sysctl(mib, 2, &physical_memory, &length, NULL, 0); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-25T00:16:22.363

你试过谷歌搜索吗？

这似乎是答案： http: [//lists.apple.com/archives/scitech/2005/Aug/msg00004.html](http://lists.apple.com/archives/scitech/2005/Aug/msg00004.html)

sysctl() 确实有效，您只需要获取 hw.memsize 而不是 hw.physmem。hw.memsize 会给你一个 uint64_t，所以没有 32 位问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-04T04:02:16.870

从[从 shell 获取 Mac 的 System Profiler 数据](https://stackoverflow.com/questions/426801/obtaining-a-macs-system-profiler-data-from-shell)：

使用[`system_profiler`](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man8/system_profiler.8.html).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-30T20:00:51.803

或者，您可以添加来自 vm_statistics_data_t 的数据以获取总内存

```
vm_statistics_data_t vm_stat;
int count = HOST_VM_INFO_COUNT;
kern_return_t kernReturn = host_statistics(mach_host_self(), HOST_VM_INFO, (integer_t*)&vm_stat, (mach_msg_type_number_t*)&count); 
```

# wpf - WPF - 为以编程方式添加的 GridViewColumns 设置 DataTemplate

> ID：583737
> 
> 赞同：5
> 
> 时间：2009-02-24T21:43:48.720
> 
> 标签：wpf, listview, datatemplate

找不到这个问题的答案。

我有一个 WPF ListView 控件，它可以包含不同数量的列。例如，它可以显示客户数据，显示 Id、Name、Email 等列，或者它可以包含产品，显示 ID、名称、价格、NumberInStock、制造商，好吧，你明白了：不同数量的列，不同的名称。

我想要做的是让某些列以不同的方式显示数据。例如，我不想打印“是”或“否”作为列 NumberInStock 的值，而是想显示一个整洁的图像。

如果我有固定数量的列，并绑定固定名称，我会看到这很容易。只需为该特定列定义一个 DataTemplate，我将使用它来定义我的列的视图。但是，在我的情况下，我看不到该怎么做。

我对 WPF 很陌生，如果我的方法不好，请原谅 :-) 在我的 XAML 中，我定义了一个 ListView 控件，它几乎是空的。在我后面的代码中，我使用：

```
 // get all columns from my objects (which can be either a Customer of Product)
    foreach (string columnName in MyObject.Columns)
        {
          GridViewColumn column = new GridViewColumn();
          // Bind to a property of my object
          column.DisplayMemberBinding = new Binding("MyObject." + columnName);
          column.Header = columnName;
          column.Width = 50;
          // If the columnname is number of stock, set the template to a specific datatemplate defined in XAML
          if (columnName == "NumberInStock")
            column.CellTemplate = (DataTemplate)FindResource("numberInStockImageTemplate");
          explorerGrid.Columns.Add(column);
        } 
```

好的，我相信这可以做得更漂亮（如果你有任何建议，请！）但最大的问题是我看不出列中有任何区别。它只显示“NumberInStock”列的文本值。我的 DataTemplate 在 XAML 中定义：

```
<Window.Resources>
<DataTemplate x:Name="NumberInStock" x:Key="NumberInStock">
      <Border BorderBrush="Red" BorderThickness="2.0">
        <DockPanel>
          <Image Width="24" Height="24" Margin="3,0" Source="..\Images\instock.png" />
        </DockPanel>
      </Border>
</DataTemplate>
</Window.Resources> 
```

当然，我仍然需要添加根据 NumberInStock 的值显示“是”或“否”图像的功能，但这实际上是第 2 步。我很高兴在我的 ListView 中看到图像和红色边框！

在此先感谢，拉齐

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-26T04:47:30.660

这让我绊倒了一段时间。

`DisplayMemberBinding`并且`CellTemplate`是互斥的。指定 a`DisplayMemberBinding`会导致`CellTemplate`被忽略。

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.gridviewcolumn.displaymemberbinding.aspx)：

> 以下属性都用于定义列单元格的内容和样式，并在此处按优先级顺序列出，从高到低：
> 
> ```
> * DisplayMemberBinding
> * CellTemplate
> * CellTemplateSelector 
> ```

另请参阅有关此的[C# Disciples 帖子](http://marlongrech.wordpress.com/2008/02/28/gridviewcolumn-displaymemberbinding-vs-celltemplate/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T15:27:08.347

这是插入图片的最简单方法

```
GridViewColumn column = new GridViewColumn { Header = "IM" };            
DataTemplate template = new DataTemplate();

FrameworkElementFactory factory  =  new FrameworkElementFactory(typeof(Grid));
template.VisualTree = factory;
FrameworkElementFactory imgFactory  =  new FrameworkElementFactory(typeof(Image));

Binding newBinding  =  new Binding("IMG");
imgFactory.SetBinding(Image.SourceProperty,newBinding);
imgFactory.SetValue(Image.WidthProperty,15.0);
imgFactory.SetValue(Image.HeightProperty, 15.0);

factory.AppendChild(imgFactory);
column.CellTemplate = template;
view.Columns.Add(column);

ListViewMain.View = view; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T04:02:53.137

我认为问题在于您传递给的字符串与您`FindResource()`在 XAML 中定义的资源的键不匹配。尝试通过`"NumberInStock"`，看看是否有效。

# c# - .NET 开发人员在使用 MYSQL 后端时需要知道的事情

> ID：583739
> 
> 赞同：2
> 
> 时间：2009-02-24T21:44:12.400
> 
> 标签：c#, .net, mysql, vb.net

随着经济的发展，我的团队和我一直在研究使用 MYSQL 来降低我们的许可成本。我想知道是否有任何可能出现的问题或问题。

为了让.NET 与 mysql 而不是 MsSQL 对话，我们需要做些什么特别的事情吗？

在为它开发时，LINQ to SQL 会有问题吗？

我们应该注意的任何警告？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T21:48:11.847

不是直接的答案，但如果您熟悉 SQL Server，请考虑 SQL Server Express（2005 或 2008）。它也是免费的，你会熟悉它，因此不需要研究 mySQL ;)

也就是说，看看这个：[http ://dev.mysql.com/tech-resources/articles/dotnet/index.html](http://dev.mysql.com/tech-resources/articles/dotnet/index.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T21:58:41.897

如果您还没有[MySQL Connector for .NET](http://dev.mysql.com/downloads/connector/net/) ，您将需要它，以便让您的 .NET 应用程序与 MySQL 通信。

然后您将可以访问[MySqlConnection](http://dev.mysql.com/doc/refman/5.1/en/connector-net-examples-mysqlconnection.html)、[MySqlCommand](http://dev.mysql.com/doc/refman/5.1/en/connector-net-examples-mysqlcommand.html)、[MySqlDataReader](http://dev.mysql.com/doc/refman/5.1/en/connector-net-examples-mysqldatareader.html)对象等。

LINQ to SQL 仅适用于 SQL Server，但有用于 MySQL 的第三方 LINQ 提供程序 -[这是一个看起来很有希望的](http://code.google.com/p/dblinq2007/)提供程序，尽管我自己没有使用它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T21:50:06.850

如果您不支付许可证，则在使用 MYSQL 时可以获得的一大支持。

微软还没有开发 LINQ to MYSQL 支持，可能有一些项目在那里，但他们没有得到保证

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T21:51:41.587

这是一篇显示比较矩阵的帖子。数据库功能部分值得一看。

[http://swik.net/MySQL/MySQL+vs+MS+SQL+Server](http://swik.net/MySQL/MySQL+vs+MS+SQL+Server)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-03T18:10:57.083

好吧，我说你正在做正确的事情转移到 MySQL。SQL Server 的许可成本高得令人望而却步，因为 MySQL 可以免费完成这项工作，并且没有像 Express 版本这样的限制，我认为将其用作后端是一个可靠的想法。

我已经使用 SQL Server express 一年多了，最让我*恼火的是它没有充分利用服务器的资源*，所以你在 express 版本中没有得到足够的收益。如果您的网站包含大量数据或有大量访问者，那么您将很快超越 SQL Server express，然后您会发现您要么必须以某种方式赢得彩票才能获得完整版的钱，要么重新编写所有查询以获得更便宜的数据库。

所以最好提前计划，在后端使用便宜的数据库。MySQL 是一个非常好的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-03T18:20:17.377

您可以忽略正在使用的数据库并选择使用[ORM](https://stackoverflow.com/questions/tagged/c%23+orm)。这样您就不必关心您使用的是什么数据库，并且可以毫不费力地在它们之间移动（至少在理论上）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-03T18:24:16.323

**尝试 SQLite**。我已经使用它并且非常喜欢它。甚至还有一个具有自动完成功能的免费管理工具（哇）。它适用于每天页面浏览量少于 100k 的任何网站。肯定有一些缺点，但是轻量级的占用空间和与 LINQ 的兼容性（通过 DBLinq，它仍处于 Alpha 阶段，但我已经很好地使用它）使它成为我书中的一个胜利。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-03T18:25:01.970

请注意，MyISAM 引擎不支持事务，而 InnoDB 支持。

# python - Django开发服务器关闭错误

> ID：583740
> 
> 赞同：3
> 
> 时间：2009-02-24T21:44:19.203
> 
> 标签：python, django

每当我使用 CTRL+ci 关闭我的开发服务器（./manage.py runserver）时，都会收到以下消息：

```
[24/Feb/2009 22:05:23] "GET /home/ HTTP/1.1" 200 1571
[24/Feb/2009 22:05:24] "GET /contact HTTP/1.1" 301 0
[24/Feb/2009 22:05:24] "GET /contact/ HTTP/1.1" 200 2377
^C
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/atexit.py", line 24, in _run_exitfuncs
    func(*targs, **kargs)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/logging/__init__.py", line 1354, in shutdown
    h.flush()
TypeError: flush() takes exactly 2 arguments (1 given)
Error in sys.exitfunc:
Traceback (most recent call last):
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/atexit.py", line 24, in _run_exitfuncs
    func(*targs, **kargs)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/logging/__init__.py", line 1354, in shutdown
    h.flush()
TypeError: flush() takes exactly 2 arguments (1 given) 
```

我最近将项目移动到另一个目录，但其他一切正常，所以我不知道这是否与它有关......

如果我只是启动开发服务器然后立即将其关闭，我看不到错误。只有当我在浏览器中单击一些然后关闭服务器时...

谁能指出我正确的方向来解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T13:59:20.637

看来您正在使用 Mac 的默认 python 安装。我知道这被认为不时会出现奇怪的问题。我建议安装 MacPython 并将 Django 安装到该 python 实例中。

# css - 使用 CSS 影响 iframe 中的 div 样式

> ID：583753
> 
> 赞同：306
> 
> 时间：2009-02-24T21:46:45.500
> 
> 标签：css, iframe

是否可以仅使用 CSS 更改位于页面上 iframe 内的 div 的样式？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2009-02-24T21:51:59.510

你需要 JavaScript。这与在父页面中执行此操作相同，只是您必须在 JavaScript 命令前加上 iframe 的名称。

请记住，相同的来源策略适用，因此您只能对来自您自己的服务器的 iframe 元素执行此操作。

我使用[Prototype](http://prototypejs.org/)框架使其更容易：

```
frame1.$('mydiv').style.border = '1px solid #000000' 
```

或者

```
frame1.$('mydiv').addClassName('withborder') 
```

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2009-02-24T21:49:57.893

简而言之，没有。

您不能将 CSS 应用于在 iframe 中加载的 HTML，除非由于跨域资源限制，您可以控制在 iframe 中加载的页面。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2011-09-27T14:48:39.823

是的。看看这个其他线程的详细信息： [如何将 CSS 应用到 iframe？](https://stackoverflow.com/questions/217776/how-to-apply-css-to-iframe)

```
var cssLink = document.createElement("link");
cssLink.href = "style.css";  
cssLink.rel = "stylesheet";  
cssLink.type = "text/css";  
frames['frame1'].document.body.appendChild(cssLink); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-03-11T20:34:36.687

您可以`iframe`先检索 a 的内容，然后`jQuery`像往常一样对它们使用选择器。

```
$("#iframe-id").contents().find("img").attr("style","width:100%;height:100%")

$("#iframe-id").contents().find("img").addClass("fancy-zoom")

$("#iframe-id").contents().find("img").onclick(function(){ zoomit($(this)); }); 
```

祝你好运！

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-24T21:56:15.960

快速的回答是：不，对不起。

仅使用 CSS 是不可能的。您基本上需要控制 iframe 内容才能对其进行样式设置。有一些方法使用 javascript 或您选择的网络语言（我已经读过一点，但我自己不熟悉）来动态插入一些需要的样式，但是您需要直接控制 iframe 内容，这听起来像你没有。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-07-24T08:23:07.387

使用 Jquery 并等待源加载，这就是我实现的方式（使用角度间隔，您可以使用 javascript setInterval 方法）：

```
var addCssToIframe = function() {
    if ($('#myIframe').contents().find("head") != undefined) {
        $('#myIframe')
                .contents()
                .find("head")
                .append(
                        '<link rel="stylesheet" href="app/css/iframe.css" type="text/css" />');
        $interval.cancel(addCssInterval);
    }
};
var addCssInterval = $interval(addCssToIframe, 500, 0, false); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-09-28T23:24:28.627

结合不同的解决方案，这对我有用。

```
$(document).ready(function () {
    $('iframe').on('load', function() {
        $("iframe").contents().find("#back-link").css("display", "none");
    }); 
}); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-10-13T01:36:58.990

显然它可以通过 jQuery 来完成：

```
$('iframe').load( function() {
    $('iframe').contents().find("head")
      .append($("<style type='text/css'>  .my-class{display:none;}  </style>"));
}); 
```

[https://stackoverflow.com/a/13959836/1625795](https://stackoverflow.com/a/13959836/1625795)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-24T21:50:34.210

可能不是你想的那样。iframe 也必须`<link>`在 css 文件中。如果它在不同的域上，即使使用 javascript 也无法做到这一点。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-12-15T15:03:38.063

一种 hack-ish 的做事方式就像 Eugene 所说的那样。我最终遵循他的代码并链接到我的页面的自定义 Css。对我来说，问题是，有了 twitter 时间线，你必须避开 twitter 来稍微覆盖他们的代码。现在我们有了一个滚动的时间轴，其中包含我们的 css，IE 更大的字体，适当的行高，并且在高度超过其限制时隐藏滚动条。

```
var c = document.createElement('link');
setTimeout(frames[0].document.body.appendChild(c),500); // Mileage varies by connection. Bump 500 a bit higher if necessary 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-09-26T14:42:47.607

只需添加这个，一切正常：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-05-30T10:41:14.417

从客户端不可能。由于 iframe 不是您的域的一部分，因此将引发 javascript 错误“错误：访问属性“文档”的权限被拒绝”。唯一的解决方案是从服务器端代码获取页面并更改所需的 CSS。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-09-05T17:59:06.820

是的，虽然很麻烦，但这是可能的。您需要将页面的 HTML 打印/回显到页面的正文中，然后应用 CSS 规则更改功能。使用上面给出的相同示例，您实际上将使用一种解析方法来查找页面中的 div，然后对其应用 CSS，然后将其重新打印/回显给最终用户。我不需要这个，所以我不想将该函数编码到另一个网页的 CSS 中的每个项目中，只是为了 aphtply。

参考：

*   [IFRAME的打印内容](https://stackoverflow.com/questions/5725851/printing-content-of-iframe)
*   [使用 PHP 或 JavaScript 访问和打印 HTML 源代码](https://stackoverflow.com/questions/14062158/accessing-and-printing-html-source-code-using-php-or-javascript)
*   [http://www.w3schools.com/js/js_htmldom_html.asp](http://www.w3schools.com/js/js_htmldom_html.asp)
*   [http://www.w3schools.com/js/js_htmldom_css.asp](http://www.w3schools.com/js/js_htmldom_css.asp)

# .net - 使用清单打开新控制台窗口提升 UAC 的权限

> ID：583755
> 
> 赞同：0
> 
> 时间：2009-02-24T21:47:08.867
> 
> 标签：.net, console, uac, manifest

我正在编写一个控制台工具。如果没有提升 UAC 支持（清单文件）的权限，从命令提示符 ( **cmd.exe** ) 或控制台文件管理器（如**far.exe**）调用此工具会在同一窗口中打开它，将其输出写入同一窗口等。

但是现在，当[添加清单文件时](https://stackoverflow.com/questions/562350/requested-registry-access-is-not-allowed-under-windows-7)，在 UAC 请求对话框之后为工具创建了一个新的控制台窗口，因此工具的输出被写入那里，并且窗口关闭。这种工具没有目的是控制台。

如何解决？有哪些解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T21:55:13.170

据我所知，没有办法“解决”这个问题。此行为是设计使然，旨在确保您提升的任何命令行工具不受非提升命令行中的任何路径修改的影响。

这个想法是，在正常的一天工作中，人们在他们的机器上运行任何程序。这些程序可能会修改用户的路径，例如将包含名为 reg.exe 的恶意程序的文件夹放在 c:\windows\system32 之前。然后用户运行一个需要提升的管理工具，该工具调用 reg.exe 而不指定路径，瞧——你拥有了。

您真的应该考虑将工具的输出保存到日志文件中。或者，您可以分两部分开发该工具 - 不需要提升的控制台工具和需要提升的 COM 进程外服务器。

# java - 测试 EJB 3.0 组件

> ID：583756
> 
> 赞同：1
> 
> 时间：2009-02-24T21:47:31.177
> 
> 标签：java, testing, ejb, integration-testing

我有几个关于使用 JUnit 集成测试 EJB 3.0 组件的问题。

在您的 JUnit 测试中，您可以向会话 bean 注入资源本地实体管理器，从而“模拟”ejb-container。但如果...

1.  如果您需要测试您的 ejb 方法上的事务属性是否被正确处理，该怎么办？这可以在容器外完成吗？如果没有，在容器内测试它的最简单方法是什么？

2.  如果您需要在每次测试之前确保 db 中有一些测试记录怎么办？您如何确保在测试执行后（即使它失败）db 已清除测试数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T12:02:55.770

您还可以使用可嵌入的 JBoss 对 EJB 进行单元测试，如[#553031中所述](https://stackoverflow.com/questions/553031)

它不是一个很好的解决方案，但它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T01:22:38.477

如果您碰巧在使用 Maven，或者即使您不是，[这可能会有所帮助](http://escx.blogspot.com/2007/03/testing-ejb3-jpa-with-maven2.html)。测试事务语义的典型方法是使用内存数据库，如 H2 或 HSQLDB (Hypersonic)。因此，实际上，您是在一个非常轻量级的容器中进行测试。Hibernate 可以配置为您的 JPA 实现。它将数据持久化到完全在 RAM 中运行的功能齐全的关系数据库中。

至于固定装置，有很多选择，其中一个比较流行的是[DbUnit](http://www.dbunit.org)，但根据我的经验，它们比它们的价值要复杂得多。我更喜欢创建自己的“构建器”类，用必要的模型对象设置我的测试。我喜欢配置“setters”返回构建器的一个实例，这样我就可以像这样将调用链接在一起：

```
 this.emf = Persistence.createEntityManagerFactory ("hibernate-hsqldb");
  Widget widget = new WidgetBuilder(this.emf).setAnOption(4).setAnother("test").build(); 
```

通常，`emf`将在 setUp 方法中创建并在 tearDown 中关闭。这会在测试运行之间完全初始化数据库。

# c - 从基于 Linux 的 C 程序打开和读取 Excel？

> ID：583776
> 
> 赞同：6
> 
> 时间：2009-02-24T21:52:08.387
> 
> 标签：c, linux, excel

我试图找到一组源代码，使我能够从 C 程序中打开和读取 Linux 上的 Excel 文件的内容。

如果我能找到只做这两件事的东西，我真的不想将它链接到 OpenOffice SDK。

卡尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T05:03:16.120

如果以下套件适合您，那么您可以从

[源锻造](http://chicago.sourceforge.net/devel/docs/excel/)

并从

[什么是用于处理 Excel 文件的简单可靠的 C 库？](https://stackoverflow.com/questions/493111/what-is-the-best-c-library-that-can-access-excel-files)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T05:40:57.670

您可以使用[xlhtml](http://chicago.sourceforge.net/xlhtml/)将 Excel 文件转换为 HTML，然后使用您喜欢的 HTML 解析器来提取单元格数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T22:09:06.040

据我所知，没有图书馆可以做到这一点。常用的方法是始终将文件另存为 Excel 中的 CVS，尽管这样会丢失标记等。

您可以尝试使用 Gnumeric 的 Excel 插件：

[http://svn.gnome.org/viewvc/gnumeric/trunk/plugins/excel/](http://svn.gnome.org/viewvc/gnumeric/trunk/plugins/excel/)

它工作得很好（在数字内）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T06:00:36.343

从 Open Office 获取 xls 阅读代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T21:58:00.480

查看[可以访问 Excel 文件的最佳 C 库是什么？](https://stackoverflow.com/questions/493111/what-is-the-best-c-library-that-can-access-excel-files)

您可能需要查看的内容：

*   C：[xls库](http://xlslib.sourceforge.net/)
*   C++：[LibExcel](http://www.libexcel.com/)

尽管我认为两者都是只写的，但这可能不是您所需要的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T17:16:53.610

为什么不直接使用 Google Docs？借助 Gears，它具有离线支持，您也可以编辑文件，只是一个想法 - [http://docs.google.com](http://docs.google.com)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-09T13:05:03.060

Check out XLSX I/O at [https://sourceforge.net/projects/xlsxio/](https://sourceforge.net/projects/xlsxio/) It is a cross platform C library to read from and write to Excel .xslx files. Works on Windows, OS X, Linux and does not require Excel or Office to be installed. It is intended for sequential access to data in .xlsx files, so if it's only the values you are interested in this is what you need.

# safari - Safari3 和 Safari4 并排

> ID：583777
> 
> 赞同：1
> 
> 时间：2009-02-24T21:52:10.277
> 
> 标签：safari

我刚刚阅读了有关[Safari4（测试版）](http://www.apple.com/safari/download/)的发布及其大大改进的 Javascript 引擎。我打算开始玩它，但我想知道是否有人知道 Safari 3 和 Safari 4 是否可以并排运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T21:57:35.583

您可以运行 Safari 3 并使用[每晚构建的 Webkit](http://nightly.webkit.org/)来测试新引擎。不过，您仍然会错过 Cover Flow 和 Top Sites 等新功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T00:55:08.720

[Beatnik Pad has a quick tutorial that shows how running Safari 4 Beta and Safari 3 side by side](http://www.beatnikpad.com/archives/2009/02/24/safari4-safari3) can be accomplished.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T21:56:01.310

试试[这个](http://michelf.com/projects/multi-safari/)

> Safari 通常使用 Mac OS X 中的 Web Kit 框架来呈现网页并执行 javascript。这意味着如果您保留旧版本的 Safari 以在较新版本的 Mac OS 上运行它，它将使用系统中的较新 Web Kit，您将获得与较新版本相同的结果。

但是，该链接有一些可以安装的独立版本。

还有[这个](http://michelf.com/weblog/2005/multi-safari/)展示了如何创建自己的独立版本。

# linux - 如何确定 Linux 中进程的最大内存使用量？

> ID：583779
> 
> 赞同：22
> 
> 时间：2009-02-24T21:52:51.850
> 
> 标签：linux, memory-management

我有一个以两种不同模式运行的程序。我想比较两种模式的运行时间和内存要求。使用 . 确定运行时很容易`time`。事实上，在这种情况下，它*真的很*容易，因为程序会在测试结束时报告 CPU 时间和挂钟时间。但是，确定内存使用情况有点困难。

如何获取进程在其整个生命周期内的内存使用情况的详细信息？我想知道最大使用量和平均值。事实上，理想情况下，我想要一些运行期间内存使用情况的图表。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-12-02T14:47:05.570

### `time`具有详细模式，可为您提供最大和平均驻留集大小。

（驻留集大小是进程内存中保存在 RAM 中的部分）。

```
$ /usr/bin/time -v command_that_needs_to_measured |& grep resident
    Maximum resident set size (kbytes): 6596
    Average resident set size (kbytes): 0 
```

记得使用 binary `/usr/bin/time`，它有一个`-v`选项。您可以通过运行查看其文档`man time`。如果你没有指定它的路径，bash的内置`time`将运行，它*没有*`-v`选项。您可以在 bash 手册页或运行`help time`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-24T22:02:15.773

Valgrind 的 massif 工具可以为您提供一段时间内的内存使用图表。见[http://valgrind.org/docs/manual/ms-manual.html](http://valgrind.org/docs/manual/ms-manual.html)

# c++ - 当我从命令行编译而不是从 IDE 编译时，为什么会出现歧义错误？

> ID：583786
> 
> 赞同：0
> 
> 时间：2009-02-24T21:55:13.857
> 
> 标签：c++, command-line, makefile, c++builder

我正在尝试使用 Borland C++ Builder 5.5 编译一个相当大的项目。该项目在 IDE 中编译，但速度太慢。但是，当我使用命令行编译时，会出现 IDE 中不存在的歧义错误：

错误 E2015 Project.h 536：“TTreeNode”和“Comctrls::TTreeNode”之间的歧义

我的命令行参数如下：

d:\PROGRA~1\Borland\CBUILD~1\bin..\BIN\bcc32 -Od -Vx -Ve -X- -r- -a8 -5 -b- -d -k -vi -c -tW - tWM -w-par -I[非常大的包含文件列表] -nQ:\output [非常大的要编译的文件列表]

该命令由 make.exe 生成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T13:19:31.277

我认为问题在于命令行编译器和 IDE 编译器不同。命令行似乎对歧义更加严格，而 IDE 仅将其标记为警告。鉴于此，我猜有些项目即使在 IDE 中构建，也无法使用命令行工具构建。

# python - 是否可以使用 App Engine 生成并返回 ZIP 文件？

> ID：583791
> 
> 赞同：20
> 
> 时间：2009-02-24T21:56:09.690
> 
> 标签：python, google-app-engine, zip, in-memory

我有一个非常适合 Google App Engine 的小项目。实现它取决于生成 ZIP 文件并将其返回的能力。

由于 App Engine 的分布式特性，据我所知，ZIP 文件无法在传统意义上的“内存中”创建。它基本上必须在单个请求/响应周期中生成和发送。

Python zip 模块甚至存在于 App Engine 环境中吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-24T22:06:10.397

[zipfile](http://docs.python.org/library/zipfile.html)可在 appengine 中获得，修改后的[示例](http://www.tareandshare.com/2008/09/28/Zip-Google-App-Engine-GAE/)如下：

```
from contextlib import closing
from zipfile import ZipFile, ZIP_DEFLATED

from google.appengine.ext import webapp
from google.appengine.api import urlfetch

def addResource(zfile, url, fname):
    # get the contents      
    contents = urlfetch.fetch(url).content
    # write the contents to the zip file
    zfile.writestr(fname, contents)

class OutZipfile(webapp.RequestHandler):
    def get(self):
        # Set up headers for browser to correctly recognize ZIP file
        self.response.headers['Content-Type'] ='application/zip'
        self.response.headers['Content-Disposition'] = \
            'attachment; filename="outfile.zip"'    

        # compress files and emit them directly to HTTP response stream
        with closing(ZipFile(self.response.out, "w", ZIP_DEFLATED)) as outfile:
            # repeat this for every URL that should be added to the zipfile
            addResource(outfile, 
                'https://www.google.com/intl/en/policies/privacy/', 
                'privacy.html')
            addResource(outfile, 
                'https://www.google.com/intl/en/policies/terms/', 
                'terms.html') 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-03-05T12:54:24.687

```
import zipfile
import StringIO

text = u"ABCDEFGHIJKLMNOPQRSTUVWXYVabcdefghijklmnopqqstuvweyxáéöüï东 廣 広 广 國 国 国 界"

zipstream=StringIO.StringIO()
file = zipfile.ZipFile(file=zipstream,compression=zipfile.ZIP_DEFLATED,mode="w")
file.writestr("data.txt.zip",text.encode("utf-8"))
file.close()
zipstream.seek(0)
self.response.headers['Content-Type'] ='application/zip'
self.response.headers['Content-Disposition'] = 'attachment; filename="data.txt.zip"'
self.response.out.write(zipstream.getvalue()) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T22:02:14.307

来自[什么是 Google App Engine](http://code.google.com/appengine/docs/whatisgoogleappengine.html)：

> 您可以将其他第三方库与您的应用程序一起上传，只要它们是用纯 Python 实现的，并且不需要任何不受支持的标准库模块。

因此，即使默认情况下它不存在，您也可以（可能）自己包含它。（我说*可能*是因为我不知道 Python zip 库是否需要任何“不受支持的标准库模块”。

# sql - SQL Select 语法解决方法

> ID：583793
> 
> 赞同：2
> 
> 时间：2009-02-24T21:57:04.600
> 
> 标签：sql, select

假设我有两个现有的表，“狗”和“猫”：

```
狗名 | 所有者
 ---------+------
 火花 | 鲍勃
 罗孚 | 鲍勃
 史努比 | 查克
 欧迪 | 乔恩

 猫名 | 所有者
 ---------+------
 加菲猫 | 乔恩
 玛菲 | 山姆
 愚蠢 | 鲍勃

```

如何使用此输出编写查询？

```
所有者 | num_dogs | num_cats
 ------+----------+----------
 鲍勃 | 2 | 1
 查克 | 1 | 0
 山姆 | 0 | 1
 乔恩 | 1 | 1

```

**我得到的答案是下一个查询**

```
select owner, sum(num_dogs), sum(num_cats) from
  (select owner, 1 as num_dogs, 0 as num_cats from dogs
   union
   select owner, 0 as num_dogs, 1 as num_cats from cats)
group by owner 
```

**但问题是sql不支持“select * from (select...)”类型的查询**

相反，“from”之后必须有一个表名。

不幸的是，我买不起临时表或使用“select into”子句创建的表。对于以这种方式形成嵌套选择子句的建议解决方案，我需要一些解决方法。

你怎么看？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T22:05:01.243

我的 SQL 确实如此，只需要命名表...您使用的是什么数据库？

```
 select owner, sum(num_dogs), sum(num_cats) from
  (select owner, 1 as num_dogs, 0 as num_cats from dogs
   union all
   select owner, 0 as num_dogs, 1 as num_cats from cats) as g
 group by owner 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T22:16:20.110

```
create table cats (cat_name varchar(8), owner varchar(8))
create table dogs (dog_name varchar(8), owner varchar(8))
create table owners (owner varchar(8))

insert into owners values ('Jon')
insert into owners values ('Bob')
insert into owners values ('Chuck')
insert into owners values ('Sam')

insert into dogs values ('Sparky', 'Bob')
insert into dogs values ('Rover', 'Bob')
insert into dogs values ('Snoopy', 'Chuck')
insert into dogs values ('Odie', 'Jon')

insert into cats values ('Garfield', 'Jon')
insert into cats values ('Muffy', 'Sam')
insert into cats values ('Stupid', 'Bob')

select 
    owners.owner,
    count(distinct dog_name) as num_dogs,
    count(distinct cat_name) as num_cats
from 
    owners
        left outer join dogs on dogs.owner = owners.owner
        left outer join cats on cats.owner = owners.owner
group by owners.owner 
```

请注意，count(dog_name) 可能应该是 count(dog_id)... 多只狗可以有相同的名字不同的所有者（哎呀......可能允许同名相同的所有者）。

请注意将 DISTINCT 添加到 count(..) 以纠正问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T22:03:58.953

1.  我想说你需要添加 UNION **ALL** io just UNION 才能使这个查询工作。
2.  您需要命名您的内部选择。

    SELECT * FROM (SELECT * FROM Table) **MyInnerSelect**

更好的解决方案是创建一个表 Owner 并加入 dog & cat 表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T22:08:09.957

“但问题是sql不支持“select * from (select...)”类型的查询”

当然可以。你只需要给它一个名字，比如“select * from (select...)a”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T22:09:07.223

您需要为子查询设置别名。

```
select owner, sum(num_dogs), sum(num_cats)
from (
    select owner, 1 as num_dogs, 0 as num_cats from dogs
    union all
    select owner, 0 as num_dogs, 1 as num_cats from cats
) a
group by owner 
```

请注意`a`紧跟在子查询之后的内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T22:47:09.113

这是另一种方法，只是为了好玩。

```
select o.owner, nd.numdogs, nc.numcats
from owners o
left join (select owner, count(dog_name) as numdogs
           from dogs
           group by owner) nd on nd.owner=o.owner
left join (select owner, count(cat_name) as numcats
           from cats
           group by owner) nc on nc.owner=o.owner 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T22:07:10.740

您需要给子查询起别名：

```
select sq.owner, sum(sq.num_dogs), sum(sq.num_cats) from
    (select owner, 1 as num_dogs, 0 as num_cats from dogs
     union
     select owner, 0 as num_dogs, 1 as num_cats from cats
    ) as sq
group by sq.owner 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T22:25:02.223

```
select
coalesce (d.owner, c.owner),
count(distinct d.dog_name) as num_dogs,
count(distinct c.cat_name) as num_cats
from dogs d
full join cats c on d.owner = c.owner
group by coalesce (d.owner, c.owner) 
```

只是因为出于某种原因我不喜欢联合和子选择... :)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T22:25:48.167

对此的另一种看法，更多地是为了突出不同的方式而不是必然的表现。

在 SQL Server 中 -

```
SELECT 
ISNULL(c.owner, d.owner) AS owner, 
COUNT(d.dog_name) num_dogs, 
COUNT(c.cat_name) num_cats
FROM
dogs d
FULL OUTER JOIN 
cats c
ON 
d.owner = c.owner
GROUP BY
c.owner, d.owner
ORDER BY
ISNULL(c.owner, d.owner) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-24T22:54:16.833

您可以创建一个包含所有所有者名称的所有者表吗？如果是这样，以下查询将为您提供您所追求的输出：

```
SELECT
     owners.owner,
     count(distinct dog_name),
     count(distinct cat_name)
FROM
     (
     Owners
     LEFT JOIN cats ON
          owners.owner = cats.owner
     )
LEFT JOIN dogs ON
     Owners.owner = dogs.owner
GROUP BY
     Owners.owner; 
```

# asp.net - ASP.NET - Gridview RowDeleting 事件上没有数据键！

> ID：583796
> 
> 赞同：4
> 
> 时间：2009-02-24T21:57:47.937
> 
> 标签：asp.net, data-binding, gridview, ado.net, datatable

我有一个像这样的 GridView：

```
<asp:GridView ID="gvwStudents" runat="server" 
    AutoGenerateColumns="False" DataKeyNames="ID"
    ShowHeader="False" onrowdeleting="gvwStudents_RowDeleting">
    <Columns>
        <asp:BoundField DataField="FirstName" />
        <asp:BoundField DataField="LastName" />
        <asp:BoundField DataField="Email" />
        <asp:CommandField ShowDeleteButton="True" DeleteText="Remove" />
    </Columns>
</asp:GridView> 
```

以下是我创建 GridView 绑定到的 DataTable 的方法，以便您知道我正在处理的数据：

```
private DataTable MakeStudentsTable()
{
    DataTable students = new DataTable();

    DataColumn ID = students.Columns.Add("ID", typeof(int));
    ID.AutoIncrement = true;

    DataColumn firstName = students.Columns.Add("FirstName", typeof(string));
    DataColumn lastName = students.Columns.Add("LastName", typeof(string));
    DataColumn email = students.Columns.Add("Email", typeof(string));

    return students;
} 
```

为什么，哦，为什么 RowDeleting 事件的 EventArgs 中没有传入任何键？我需要从触发此事件时保持会话状态的 ADO.NET 数据表中删除记录。

为什么这不起作用？DataKeys 是否仅在使用 DataSource 控件时才有效？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-25T06:31:42.540

这有效：

```
private DataTable MakeStudentsTable()
{
    DataTable students = new DataTable();

    DataColumn ID = students.Columns.Add("ID", typeof(int));
    ID.AutoIncrement = true;

    DataColumn firstName = students.Columns.Add("FirstName", typeof(string));
    DataColumn lastName = students.Columns.Add("LastName", typeof(string));
    DataColumn email = students.Columns.Add("Email", typeof(string));

    DataRow student = students.NewRow();
    student["FirstName"] = "foo";
    student["LastName"] = "bar";
    student["Email"] = "foo@bar.com";
    students.Rows.Add(student);

    return students;
}

protected void gvwStudents_RowDeleting(object sender, GridViewDeleteEventArgs e)
{
    string id = this.gvwStudents.DataKeys[e.RowIndex].Value.ToString();   
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-02T15:18:11.130

将 GridView 控件的 DataKeyNames 属性设置为数据主键的名称。

[https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.datakeynames.aspx](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.datakeynames.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T22:23:33.850

添加

```
<asp:BoundField DataField="ID" /> 
```

并查看该字段是否有值。

# java - 如果 Quartz Scheduler 死了，我如何停止它启动的子 Java 进程？

> ID：583800
> 
> 赞同：3
> 
> 时间：2009-02-24T21:59:26.857
> 
> 标签：java, multithreading, process

我目前在我们的 Windows 2003 Server Box 上使用 Quartz Scheduler 作为 Cron 的替代品。我有两个需要在新 VM 中启动的特定作业，因此我使用 Java 5 中的 ProcessBuilder 对象来获取我的“Process”对象。我遇到的问题是当我们的 Quartz Scheduler JVM 停止时，单独的 JVM 中的 2 个作业继续运行。

```
 Process process = Runtime.getRuntime().exec(command);
        try
        {
            while (true)
            {

                Thread thread1 = new Thread(new ReaderThread(process.getInputStream()));
                Thread thread2 = new Thread(new ReaderThread(process.getErrorStream()));

                thread1.start();
                thread2.start();

                thread1.join();
                thread2.join(); 
```

当与我的 Quartz Scheduler 关联的父 JVM 死掉时，有没有办法杀死这些线程？即使我知道一种从不同进程手动杀死它们的方法，我也可以通过 Quartz 弄清楚如何做到这一点。

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T22:41:41.623

如果 Quartz JVM 正常退出，你可以在 finally 块中销毁进程。这可以消除对关闭挂钩的需要。JVM 异常终止时可能不会执行关闭挂钩。运行时 javadocs 状态，

> 如果虚拟机中止，则无法保证是否会运行任何关闭挂钩。

这是修改后的代码（我添加了超时和方法调用以等待进程退出）

```
 private static final long TIMEOUT_MS = 60000;
    Process process = Runtime.getRuntime().exec(command);
    try
    {
        while (true)
        {

            Thread thread1 = new Thread(new ReaderThread(process.getInputStream()));
            Thread thread2 = new Thread(new ReaderThread(process.getErrorStream()));

            thread1.start();
            thread2.start();

            process.waitFor();
            thread1.join(TIMEOUT_MS);
            thread2.join(TIMEOUT_MS);
            ...
        }
    } finally {
        process.destroy();
    } 
```

总的来说，我发现从 Java 生成的进程很笨重而且没有弹性，因为您可能已经发现需要两个 ReaderThreads。特别是，冻结的子进程很难从 Java 中终止。作为最后的手段，您可以使用 Windows“ [taskkill](http://technet.microsoft.com/en-us/library/bb491009.aspx) ”命令从命令行或计划任务中删除进程：

> taskkill /IM MySpawnedProcess.exe

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T22:10:13.960

您可以使用关闭挂钩。

```
class ProcessKiller extends Thread {
  private Process process = null;
  public ProcessKiller(Process p) {
    this.process = p;
  }

  public void run() {
    try {
      p.destroy();
    } catch ( Throwable e ) {}
  }
}

Runtime.getRuntime().addShutdownHook( new ProcessKiller( process )); 
```

# c# - 装饰器内的动画（调用 OnRender）

> ID：583808
> 
> 赞同：7
> 
> 时间：2009-02-24T22:02:23.170
> 
> 标签：c#, .net, wpf, adorner

我在 .NET 3.5 中使用装饰器，并且可以通过覆盖 OnRender 进行绘制，但我需要能够重绘装饰器以更改其外观。

本质上，我正在寻找一种清除绘图上下文并再次调用 OnRender 的方法。最好的方法是什么，或者有更好的方法吗？

```
public class MyAdorner : Adorner
{
    private Brush brush = Brushes.Red;

    public DragArrowAdorner(UIElement adornedElement) : base(adornedElement)
    {}

    public void RedrawWithBrush(Brush newBrush)
    {
        brush = newBrush;

        // redraw..?
    }

    protected override void OnRender(System.Windows.Media.DrawingContext drawingContext)
    {
        // some drawing code...
        drawingContext.DrawRectangle(
            brush, 
            null, 
            new Rect(AdornedElement.DesiredSize));
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T22:34:22.577

您的问题的答案是用于[`InvalidateVisual`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.invalidatevisual.aspx)导致 OnRender 再次被调用

但是，我建议不要自己在 OnRender 上进行自定义绘图，而是使用标准样式和视觉树模板来构建装饰器的实际视觉效果。这也意味着您可以使用情节提要在其中运行标准 XAML 动画。

如果您想采用这种方法，在您的装饰类中，您需要：

*   在构造函数中调用`base.AddVisualChild()`或创建您自己的视觉效果集合，其中包含要在装饰器中显示的视觉效果
*   覆盖`ArrangeOverride(Size size)`以便妥善安排孩子；
*   覆盖`VisualChildrenCount`以返回装饰器视觉树中的子节点数；
*   覆盖`GetCisualChild(int index)`以返回特定的孩子。

您可以查看[ResizingAdorner](http://msdn.microsoft.com/en-us/library/ms771714.aspx) MSDN 示例以获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-06-10T07:41:10.413

了解 WPF 与 Windows.Forms 不同，这一点非常重要。`OnRender()`真的应该被称为`AccumulateDrawingObjects()`，因为这就是它正在做的事情。WPF 积累了一堆绘图对象，它保留这些对象以便能够在需要时绘制 UI。高效更新 UI 的神奇之处在于，您*可以**在* `OnRender()`.

例如，您可以创建一个`DrawingGroup`“backingStore”，并将其放入`DrawingContext`during 中`OnRender`。然后，只要您想更改视觉效果，就可以`DrawingGroup.Open()`将新的绘图命令放入其中，WPF 将有效地重新渲染该部分 UI。

它看起来像这样：

```
DrawingGroup backingStore = new DrawingGroup();

protected override void OnRender(DrawingContext drawingContext) {      
    base.OnRender(drawingContext);            

    Render(); // put content into our backingStore
    drawingContext.DrawDrawing(backingStore);
}

// I can call this anytime, and it'll update my visual drawing
// without ever triggering layout or OnRender()
private void Render() {            
    var drawingContext = backingStore.Open();
    Render(drawingContext);
    drawingContext.Close();            
} 
```

# java - 在另一台服务器上调用 ColdFusion 函数？

> ID：583809
> 
> 赞同：6
> 
> 时间：2009-02-24T22:03:12.590
> 
> 标签：java, coldfusion

我有一个必须运行的 Java 类，我当前的网络主机（共享）不允许 Java。我需要将它托管在另一台服务器上。有人告诉我我不能在单独的服务器上从 ColdFusion 调用 Java，但是如果我在第二台服务器上调用 CF 函数然后让该函数调用 Java 类，将数据返回给 CF 然后该函数返回到原始? 抱歉，如果这听起来很笨拙，但我想不出任何其他解决方案。

任何人？想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-24T23:08:28.953

如果您可以访问可以运行 Java 的服务器，那么您就不能在那里运行整个东西吗？

否则，如您所想，您可以创建一个具有远程功能的组件并让它完成工作，如下所示：

```
<cfcomponent output="false">

    <cffunction name="runMyJava" returntype="String" output="false" access="remote">
        <cfargument name="MyArg" type="String" />

        <cfset var MyObj = createObject('java','whatever') />

        <cfreturn MyObj.doJavaMagic( Arguments.MyArg ) />
    </cffunction>

</cfcomponent> 
```

然后在您的另一台服务器上，您将拥有类似...

```
<cfset MyWebService = createObject('webservice','https://myotherserver/mycomponent.cfc?wsdl')/>

<cfset MyString = MyWebService.runMyJava( MyString ) /> 
```

请注意，此示例使用 https - 因为您可能希望保护数据不以纯文本形式在 Internet 上传播。

对服务器进行 IP 限制也很明智，这样只有您可以连接到它，或者使用其他适当的方法来保护它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T22:17:31.870

我会在您的第二台服务器上使用 Coldfusion 设置一个 Web 服务来调用 Java 类，然后让您的 Web 主机上的站点使用该 Web 服务。

# data-structures - 我需要一个等效于 __int64 的 eVC++ 数据类型

> ID：583813
> 
> 赞同：0
> 
> 时间：2009-02-24T22:04:23.320
> 
> 标签：data-structures, types, long-integer, evc

[eVC++](http://www.google.com/search?q=embedded+visual+c%2B%2B)中是否存在与 等价的数据类型[`__int64`](http://msdn.microsoft.com/en-us/library/s3f49ktz(VS.80).aspx)？没有别名编译。而且我在`Math.h`.

第三方库也是可以接受的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-09T14:35:12.280

假设您使用的是 EVC++ 4.0 ...

您首先需要确保已安装 Pocket PC 2003 SDK。如果您使用的是 win mobile 5.0 及更高版本并且仍在尝试使用 EVC++4.0，我将与您抗衡（Ron Burgundy）。PPC 2003 SDK 可以在[这里](http://www.microsoft.com/downloadS/details.aspx?familyid=9996B314-0364-4623-9EDE-0B5FBB133652&displaylang=en)找到。

安装完成后，更新链接器，找到新安装的带有LONGLONG宏定义的SDK头文件。去做这个：

1.  工具 -> 选项
2.  目录选项卡 -> 确保第三个下拉菜单显示“包含文件”
3.  添加路径 -> "C:\Program Files\Windows CE Tools\wce420\POCKET PC 2003\Include\Armv4"
4.  确保在你的课堂上#include winnt.h。在该标题中，您将找到 LONGLONG 的定义，它是一个 _int64

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T00:32:11.403

您可以访问 eVC++ 中的[LargeInt](http://doc.ddart.net/msdn/header/include/largeint.h.html)库吗？IIRC 这是一个与 VC 6.0 捆绑在一起的标准库。VC 6.0 本身不支持`__int64`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T08:31:08.697

“long long”是 VC++ 中“__int64”的同义词......也许这有效？

# c# - 如何在 C# 中获取图像按钮 ID？

> ID：583817
> 
> 赞同：1
> 
> 时间：2009-02-24T22:05:05.627
> 
> 标签：c#, imagebutton

我知道我可以得到一个 imagebutton 的 X&Y，但是我如何得到它的 ID？

我想先把它打印到标签上。稍后我想在 switch 案例中使用它 - 任何不同的案例都会将 imagebutton.imageurl 更改为不同的图像，但特别是为我刚刚单击的 imagebutton 执行此操作。

我试过

```
Label1.Text = Convert.ToString((ImageButton)sender); 
```

但这就是结果

```
 System.Web.UI.WebControls.ImageButton 
```

结果这没什么帮助，因为我需要特定控件的 ID。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T22:07:26.947

你是这个意思吗？

```
 Label1.Text = ((ImageButton)sender).ID 
```

**更新**（根据您的评论）：

要更改 ImageURL，您可以使用：

```
((ImageButton)sender).ImageUrl ="correct_quiz.gif"; 
```

或者，如果您想将这两件事结合起来，我建议您这样做：

```
ImageButton button = ((ImageButton)sender);
Label1.Text = button.ID;
button.ImageUrl = "correct_quiz.gif"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T22:07:44.433

```
ImageButton b = sender as ImageButton;
if (b != null) {
    string theId = b.ClientID;

    // Change the URL
    b.ImageUrl = "/whatever/you/like.png";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T22:07:04.500

```
((ImageButton)sender).ClientID 
```

或者如果你只想要 ID

```
((ImageButton)sender).ID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T22:08:53.170

尝试使用 ImageButton 的 ID 属性

# linux - 需要监控目录变化，并执行操作

> ID：583820
> 
> 赞同：1
> 
> 时间：2009-02-24T22:06:46.170
> 
> 标签：linux, file, scripting, monitoring

首先：我不是程序员，也不是 Linux 大师，我只需要使用 Linux、Oracle、shell 脚本。

我当前的任务是监视Oracle 中的一个表（工具：sqlplus），如果它包含某一行，则`ls -l`每隔5 秒观察一个linux 目录中是否有增长的tmp 文件，并记录其属性（例如）。

最重要的部分是：如果从oracle表中删除上述记录，这​​个tmp文件将被删除，我需要这个tmp文件的最后内容。

我无法控制 Oracle 数据，只是获得了查询权限。

可用的工具有：bash、awk、sed、一些旧版本的 perl、ruby（不是 1.9*）和 python（2.5）。我没有安装权限，所以大部分外部库都无法访问。我知道我可以从我的 $HOME 运行一些库，但我在那台机器上没有互联网连接：所以无法下载任何库。

Inotify 不可用（旧内核）。

知道从哪里开始/如何做吗？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T22:23:58.343

在另一个目录中创建一个硬链接怎么样，然后，当文件在原始位置“消失”时，硬链接仍然可以访问内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T22:26:18.180

这既丑陋又幼稚……但是……

```
#!/bin/bash

WASTHERE=0
MONITORING=/tmp/whatever.dat
LASTBACKUP=/tmp/mybackup.dat
LOGFILE=/tmp/mylog.log

# Just create an empty file to start with
touch "$LASTBACKUP"

while [ 1 ];
do
        if [[ ! -e "$MONITORING" ]]; then
                if [[ $WASTHERE -ne 0 ]]; then
                        echo "File is gone!  Do something with $LASTBACKUP";
                        WASTHERE=0
                fi
        else
                WASTHERE=1
                ls -l "$MONITORING" >> $LOGFILE
                cp "$MONITORING" "$LASTBACKUP"
        fi

        sleep 5
done 
```

不幸的是，如果在脚本休眠时被“监视”的文件发生任何事情（例如，将内容写入其中），然后在脚本唤醒之前删除该文件，新写入的内容将不会在“备份”中。

# c++ - 如何从 C++ 函数返回数百个值？

> ID：583821
> 
> 赞同：4
> 
> 时间：2009-02-24T22:07:01.253
> 
> 标签：c++, stl, vector, iterator, return-value

在 C++ 中，每当一个函数创建许多（数百或数千个）值时，我曾经让调用者传递一个数组，然后我的函数用输出值填充该数组：

```
void computeValues(int input, std::vector<int>& output); 
```

`output`因此，该函数将用它计算的值填充向量。但这并不是真正好的 C++ 风格，正如我现在所意识到的那样。

以下函数签名更好，因为它不承诺使用 a `std::vector`，但可以使用任何容器：

```
void computeValues(int input, std::insert_iterator<int> outputInserter); 
```

现在，调用者可以调用 some `inserter`：

```
std::vector<int> values; // or could use deque, list, map, ...
computeValues(input, std::back_inserter(values)); 
```

同样，我们不承诺`std::vector`专门使用，这很好，因为用户可能只需要 a`std::set`等中的值。（我应该`iterator`通过值还是通过引用？）

我的问题是：`insert_iterator`这样做是正确的还是标准的方法？还是有更好的东西？

**编辑：**我编辑了这个问题，以明确我不是在谈论返回两个或三个值，而是返回数百或数千个值。（假设您已返回在某个目录中找到的所有文件，或图中的所有边等）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T22:26:16.497

**对编辑的回应：**好吧，如果您需要返回成百上千的 if 值，那么元组当然不是要走的路。最好选择带有迭代器的解决方案，但最好不要使用任何特定的迭代器类型。

* * *

如果你使用迭代器，你应该尽可能地使用它们。在您的函数中，您使用了插入迭代器，例如`insert_iterator< vector<int> >`. 你失去了任何通用性。像这样做：

```
template<typename OutputIterator>
void computeValues(int input, OutputIterator output) {
    ...
} 
```

无论你给它什么，它现在都会起作用。但是，如果您在返回集中有不同的类型，它将不起作用。然后你可以使用一个元组。也可`std::tuple`在下一个 C++ 标准中使用：

```
boost::tuple<int, bool, char> computeValues(int input) { 
    ....
} 
```

如果值的数量是可变的并且值的类型来自一个固定的集合，比如 (int, bool, char)，你可以查看一个`boost::variant`. 然而，这意味着仅在调用方进行更改。您可以保持上面的迭代器样式：

```
std::vector< boost::variant<int, bool, char> > data;
computeValues(42, std::back_inserter(data)); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T22:42:37.597

您可以将智能指针返回到向量。那应该可以工作，并且不会复制向量。

如果您不想为程序的其余部分保留智能指针，您可以在调用函数之前简单地创建一个向量，然后交换两个向量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-25T02:41:25.027

实际上，您传递向量的旧方法有很多值得推荐的地方——它高效、可靠且易于理解。缺点是真实存在的，但并非在所有情况下都适用。人们真的想要 std::set 或列表中的数据吗？他们是否真的想要使用一长串数字而不必先将其分配给变量（通过“返回”而不是参数返回某些内容的原因之一）？通用性很好，但是您的编程时间成本可能无法兑现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T22:18:09.107

如果您曾经拥有一组对象，那么您可能至少有一些方法可以处理该组对象（否则，您将如何处理它们？）

如果是这种情况，那么将这些方法放在一个同时包含所述对象和方法的类中是有意义的。

如果这是有道理的并且您有这样的课程，请返回它。

我几乎从来没有发现自己认为我希望我可以返回一个以上的值。事实上，一个方法应该只做一件小事，你的参数和返回值往往有关系，所以往往不值得一个包含它们的类，所以返回多个值很少有趣（也许我希望在 20 年内实现 5 次——每次我都进行了重构，都得到了更好的结果，并意识到我的第一次尝试是不合格的。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T22:09:57.363

另一种选择是 boost::tuple： http: [//www.boost.org/doc/libs/1_38_0/libs/tuple/doc/tuple_users_guide.html](http://www.boost.org/doc/libs/1_38_0/libs/tuple/doc/tuple_users_guide.html)

```
int x, y;
boost::tie(x,y) = bar(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T22:11:10.480

*   一个标准容器适用于同质对象 9 您可以返回）。
*   标准库的方式是从容器中抽象出一个算法，并使用迭代器来弥补两者之间的差距。
*   如果您需要传递多个类型，请考虑结构/类。

> 我的问题是： insert_iterator 是正确的还是标准的方法？

是的。否则，如果您的容器中的元素数量不会与计算值一样多。这并不总是可能的，特别是如果您想写入流。所以，你很好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T22:30:31.557

您使用 insert_iterator 的示例将不起作用，因为[insert_iterator](http://www.sgi.com/tech/stl/insert_iterator.html)是一个模板，需要一个容器作为参数。你可以声明它

```
void computeValues(int input, std::insert_iterator<vector<int> > outputInserter); 
```

或者

```
template<class Container>
void computeValues(int input, std::insert_iterator<Container> outputInserter); 
```

第一个将使您回到 vector<int> 实现，与您的初始代码相比没有任何明显优势。第二个限制较少，但作为模板实现会给您带来其他限制，这可能使其成为不太理想的选择。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T22:54:30.313

我会使用类似的东西

```
std::auto_ptr<std::vector<int> > computeValues(int input);
{
   std::auto_ptr<std::vector<int> > r(new std::vector<int>);
   r->push_back(...) // Hundreds of these
   return r;
} 
```

返回时没有复制开销或泄漏风险（如果您在调用者中正确使用 auto_ptr）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T13:53:06.520

我想说你的新解决方案更通用，风格更好。我不确定我是否会*过多*地担心C++ 中的风格，更多地担心可用性和效率。

如果您要返回很多项目，并且知道大小，那么使用向量可以让您在一次分配中保留内存，这可能值得也可能不值得。

# language-agnostic - 源代码文件应该如何组织？按功能还是按类型？

> ID：583826
> 
> 赞同：4
> 
> 时间：2009-02-24T22:07:46.103
> 
> 标签：language-agnostic

在我早期的编码时代，我倾向于将功能相似的类分组。例如：

*   数据传输对象
    *   对象 A
    *   对象 B
*   对话框
    *   对话 A
    *   对话 B

过了一段时间，我开始感到沮丧，因为当我在处理应用程序的特定部分时，我必须四处跳来把它拼凑起来。

在过去的几年里，我倾向于按功能组织事物。通常共享的类，例如数据库对象，我仍然保留在一起。我认为这对于网站之类的东西甚至是有意义的：

*   页面 A
    *   图片
    *   资源 1
    *   对话 1
*   B页
    *   图片
    *   资源 2
    *   对话 2

这是最好的方法吗？有没有人有一个好的经验法则可以遵循？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T22:11:47.467

对于 Java，包是重用的单位。

对于 Python，模块（以及包）是重用的单元。

包应该是一个独立的东西。

如果您将所有数据传输对象放在一个大包中，那么您就没有非常可重用的东西。您可能不*想要*所有这些数据传输对象定义。

如果您通过“实体”（模型、视图、控件、数据访问等）将事物组合在一起，那么您就有了一个可在其他应用程序中共享的可重用模块。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T22:10:56.190

'Package-by-Feature' 方法对我来说似乎是明智的，对 Java 来说当然是有效的……你想要多久打包一次数据访问层，而不是那个漂亮的新特性？

我认为 javapractices.com 上的[“按功能打包，而不是按层”](http://www.javapractices.com/topic/TopicAction.do?Id=205)分析很容易阅读，并且涵盖了我没有考虑过的几个角度，例如按功能打包在编程以外的其他领域是如何工作的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T22:17:26.423

您应该按照使用您的语言/工具的其他代码的方式进行操作。这不是一个与语言无关的问题。某些语言/工具期望“文件组织”和“这些文件中的内容”之间存在关系，您应该尊重这一点。

# javascript - 有没有办法在 IE 的输入框中获取所选文本的偏移量？

> ID：583828
> 
> 赞同：3
> 
> 时间：2009-02-24T22:08:20.360
> 
> 标签：javascript, html, internet-explorer, web-applications

在 Firefox 中，您可以简单地调用：

myInputTextField.selectionStart 或 myInputTextField.selectionEnd

获取输入框中所选文本的第一个和最后一个索引。

在 IE 中，我知道您可以调用 document.selection.createRange() 来稍微调整一下选择。然而，在我的一生中，我还没有找到任何代表选择中字符偏移的值。

我错过了什么吗？有没有办法在 IE 中获得相同的值？

谢谢！

亚历克斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T22:36:18.017

直接引用[之前对](https://stackoverflow.com/questions/235411/is-there-an-internet-explorer-approved-substitute-for-selectionstart-and-selectio/235419#235419)一个[非常相似的问题的回答](https://stackoverflow.com/questions/235411/is-there-an-internet-explorer-approved-substitute-for-selectionstart-and-selectio)，它将为您提供选择范围：

```
function getSelection(inputBox) {
        if ("selectionStart" in inputBox) {
                return {
                        start: inputBox.selectionStart,
                        end: inputBox.selectionEnd
                }
        }

        //and now, the blinkered IE way
        var bookmark = document.selection.createRange().getBookmark()
        var selection = inputBox.createTextRange()
        selection.moveToBookmark(bookmark)

        var before = inputBox.createTextRange()
        before.collapse(true)
        before.setEndPoint("EndToStart", selection)

        var beforeLength = before.text.length
        var selLength = selection.text.length

        return {
                start: beforeLength,
                end: beforeLength + selLength
        }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-22T20:11:45.707

```
 getSelectionOffset : function(argObject) {
   if (typeof(argObject.contentWindow.getSelection) != 'undefined') { //Moz
    return {
     start: argObject.contentWindow.getSelection().getRangeAt(0).selectionStart,
     end: argObject.contentWindow.getSelection().getRangeAt(0).selectionEnd
    }
   }
   if (document.selection && document.selection.createRange) { //IE
    var allText = argObject.contentWindow.document.selection.createRange().parentElement().innerText;
    var selText = argObject.contentWindow.document.selection.createRange().text;
    return {
     start: allText.indexOf(selText),
     end: allText.indexOf(selText) + selText.length 
    }
   }
  } 
```

# javascript - 支持差异的所见即所得富文本编辑器？

> ID：583845
> 
> 赞同：5
> 
> 时间：2009-02-24T22:11:26.547
> 
> 标签：javascript, diff, richtextbox

我的 Web 应用程序类似于 StackOverflow，因为不同的用户经常编辑相同的文本块。

目前我们只支持纯文本，因此很容易向用户展示文本在编辑之间是如何变化的。

我想在这些领域支持富文本，但我的用户不是技术人员，因此任何类型的标记都不是一种选择。

**是否有任何支持差异的基于 javascript 的富文本编辑器？**理想情况下，差异也可以是富文本，但如有必要，它们可以以降价或类似形式呈现（我想不惜一切代价避免使用原始 HTML）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-30T14:26:04.963

Xopus 4 支持[文本更改的实时跟踪](https://xopus.com/xopus-4-released.html)。与差异更改跟踪相反，您可以跟踪和接受/拒绝多个用户的更改。

Xopus 是一个基于 Web 的 WYSIWYG XML 编辑器，因此您可以让它编辑您自己的 XML 风格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T02:29:42.947

我认为没有人可以权威地回答这个问题，但我从未听说过有差异的 Javascript 所见即所得编辑器。

Stack Overflow 在服务器端确实存在差异。如果您寻找服务器端组件来完成这项工作，您可能会有更好的运气。如果您需要在用户键入时显示差异，或者类似的东西，您可以使用 AJAX 将差异工作移交给服务器。

# vb.net - 一次在多台服务器上重置 IIS，而不是循环访问

> ID：583848
> 
> 赞同：1
> 
> 时间：2009-02-24T22:11:53.863
> 
> 标签：vb.net, multithreading, iis, process

我试图一次在一组服务器上重置 IIS，而不是循环遍历并单独重置每个服务器，但我似乎不知道该怎么做。有人可以给我一个例子吗？谢谢

我正在使用 System.Diagnostics

```
 With m_Process.StartInfo
                .FileName = strFileName
                .Arguments = String.Format("{0}{1}", server, strArguements)
                .UseShellExecute = False
                .CreateNoWindow = True
                .RedirectStandardError = True
                .RedirectStandardOutput = True
            End With 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T22:37:43.880

我今天看到了一些类似条件的问题（*“而不是循环”*），我一直在试图弄清楚循环有什么大不了的。由于 iisreset （我猜`strFileName`在您的示例中分配给它）采用单个机器名称，因此您在该部门不走运。

我假设 iisreset 连接到目标服务器上的 SCM 并重新启动 IIS Admin 和相关服务。

我想你可以滚动你自己的 iisreset.exe，它在命令行上占用了多个服务器，但在内部你必须使用某种迭代。

你能解释一下为什么你不能或不想循环吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T23:08:23.010

在某种程度上，您必须遍历服务器列表并向每个服务器发送一些消息以指示它们重置。无论您是通过对每个服务器名称运行 iisreset 还是通过其他方式来做到这一点，您都无法真正使循环消失。

但是，如果您只是说要尽快开始重置所有服务器，而不是在开始重置第二个之前等待第一个完成重置，那么看起来您已经拥有了。当您调用 m_Process.Start() 时，它应该会在新的 iisreset 进程启动后立即返回。据我所知，它不会阻塞并等到 iisreset 退出。因此，您的 iisreset 进程应该已经并行运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-01T05:12:31.180

如果我理解您的要求，那么您可以遍历服务器，但您只是不想等待每个服务器完成后再继续下一个服务器。由于 ProcessStartInfo 不允许以任何方式从您正在启动的进程中分离（如果这样做就好了），您可以这样做（显然，缺少您的参数等）：

```
Imports System.Threading

Class Restarter

    Sub Main()

        Dim ServerList As New List(Of String)

        For Each server As String In ServerList
            ThreadPool.QueueUserWorkItem(AddressOf RestartServer, server)
        Next
    End Sub

    Sub RestartServer(ByVal Server As String)

        Dim m_Process As System.Diagnostics.Process

        With m_Process.StartInfo
            .FileName = strFileName
            .Arguments = String.Format("{0}{1}", Server, strArguements)
            .UseShellExecute = False
            .CreateNoWindow = True
            .RedirectStandardError = True
            .RedirectStandardOutput = True
        End With

        m_Process.Start()

    End Sub

End Class 
```

# objective-c - Objective-C 博客

> ID：583849
> 
> 赞同：2
> 
> 时间：2009-02-24T22:11:58.840
> 
> 标签：objective-c, blogs

在过去的几年里，我主要使用 c# 进行开发，并且发现与一些最好的 c# 博客（Ayende、Jeremy Miller、Greg Young、Phil Haack 等）保持同步是非常宝贵的。所以，我刚刚进入 Objective-c 和 iPhone 开发，我想知道我应该跟上的顶级博主是谁。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T22:16:17.503

我喜欢这些：

*   [可可是我的女朋友](http://www.cimgf.com/feed/)
*   [有爱的可可](http://cocoawithlove.com/feeds/posts/default?alt=rss)
*   [爱码博客](http://icodeblog.com/feed/)
*   [iphone开发技巧](http://iphonedevelopertips.com/feed)
*   [iphone开发](http://iphonedevelopment.blogspot.com/feeds/posts/default?alt=rss)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-25T01:55:56.757

Twitter上有大量的Objective-C / Cocoa / iPhone编码器......所以如果你还没有，我会考虑建立一个Twitter帐户。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T22:15:43.153

您可以查看[此问题](https://stackoverflow.com/questions/232567/best-cocoa-mac-os-x-programming-blogs)的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T22:14:24.497

[CocoaCast](http://cocoacast.com/?q=blog/1)是一个很好的资源。您还可以在[此处找到 Cocoa 博客列表](http://cocoablogs.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T22:17:34.520

可悲的是，另一个没有像应有的那样经常更新的好消息是[Call Me Fishmeal](http://www.wilshipley.com/blog/)。它混合了个人资料以及名为“Pimp My Code”的部分，其中他详细介绍了如何编写出色的 Objective C 代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T06:41:08.740

我支持 twitter 推荐，但 Planet Cocoa (planetcocoa.org) 是必须的，它整理了各种 Macintosh/iPhone 开发者博客

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T13:58:05.587

我在[这篇博](http://www.shauber.net/2008/07/podcasts-blogs/)文中有一个很好的 Cocoa 相关博客和播客列表。

# entity-framework - 从 EDM 构建 SSRS 2008

> ID：583851
> 
> 赞同：2
> 
> 时间：2009-02-24T22:12:59.680
> 
> 标签：entity-framework, sql-server-2008, reporting-services, reporting, ado.net-entity-data-model

有人可以概述基于 ADO.Net 实体框架实体数据模型构建 SQL Server Reporting Services 2008 报告的过程吗？如果您知道任何示例，请指出我。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T21:12:43.077

基于您的 EDM 创建 ADO.NET 数据服务：

[http://geekswithblogs.net/frankw/archive/2008/03/08/ado.net-entity-framework-and-data-services-in-action-part-1.aspx](http://geekswithblogs.net/frankw/archive/2008/03/08/ado.net-entity-framework-and-data-services-in-action-part-1.aspx) [http://geekswithblogs.net/frankw /archive/2008/03/08/ado.net-entity-framework-and-data-services-in-action-part-2.aspx](http://geekswithblogs.net/frankw/archive/2008/03/08/ado.net-entity-framework-and-data-services-in-action-part-2.aspx)

在 SSRS 2008 中使用 Web 服务作为数据源：

[http://nishantrana.wordpress.com/2008/11/05/using-web-service-as-a-data-source-in-sql-server-reporting-services/](http://nishantrana.wordpress.com/2008/11/05/using-web-service-as-a-data-source-in-sql-server-reporting-services/)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T04:53:11.533

没有理由通过 Web 服务。只需将您的对象映射到您的数据库，创建报表时选择“对象数据源”。

对象数据源的唯一技巧是，如果您需要访问相关对象的成员，您可以这样做（例如，如果您想打印一个人父母的名字。）

```
=Fields!Parent.Value.FirstName 
```

# java - 如何实现最近使用的缓存

> ID：583852
> 
> 赞同：14
> 
> 时间：2009-02-24T22:13:25.263
> 
> 标签：java, algorithm, caching, java-me, mru

实现最近使用的对象缓存的最佳方法是什么？

以下是要求和限制...

*   对象存储为键/值对象/对象对，因此接口有点像 Hashtable get/put
*   调用“get”会将该对象标记为最近使用的对象。
*   在任何时候，最近最少使用的对象都可以从缓存中清除。
*   查找和清除必须快速（如在 Hashtable 中快速）
*   对象的数量可能很大，因此列表查找不够好。
*   **必须使用 JavaME 进行实现，因此使用第三方代码或标准 Java 库中整洁的库类的余地很小。**出于这个原因，我更多地寻找算法答案，而不是现成的解决方案的建议。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-24T22:31:10.167

Java 集合提供开箱即用的[LinkedHashMap ，非常适合构建缓存。](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html)您可能在 Java ME 中没有此功能，但您可以在此处获取源代码：

[`http://kickjava.com/src/java/util/LinkedHashMap.java.htm`](http://kickjava.com/src/java/util/LinkedHashMap.java.htm)

如果您不能只是复制粘贴它，那么查看它应该可以让您开始实施一个以包含在您的移动应用程序中。基本思想只是通过地图元素包含一个链表。如果您在有人放置或获取时保持更新，您可以有效地跟踪访问顺序和使用顺序。

[`removeEldestEntry(Map.Entry)`](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html#removeEldestEntry(java.util.Map.Entry))文档包含通过覆盖该方法来构建 MRU 缓存的说明。您真正需要做的就是创建一个扩展`LinkedHashMap`并覆盖该方法的类，如下所示：

```
private static final int MAX_ENTRIES = 100;

protected boolean removeEldestEntry(Map.Entry eldest) {
   return size() > MAX_ENTRIES;
} 
```

还有一个[构造函数](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html#LinkedHashMap(int,%20float,%20boolean))，可让您指定是否希望类通过插入或使用按顺序存储事物，因此您的驱逐策略也有一点灵活性：

```
public LinkedHashMap(int initialCapacity,
                     float loadFactor,
                     boolean accessOrder) 
```

为使用顺序传递**true** ，为插入顺序传递**false 。**

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-25T01:10:15.433

由于锁定要求，ConcurrentLinkedHashMap 很难构造。带锁的 LinkedHashMap 很简单，但并不总是高效的。并发版本将尝试通过锁拆分或理想情况下进行 CAS 操作来减少锁定量，从而使锁定非常便宜。如果 CAS 操作确实变得昂贵，那么类似的桶拆分可能会有所帮助。由于 LRU 需要对每个访问操作进行写入，并且使用双向链表，因此使用纯 CAS 操作实现这一点非常棘手。我已经尝试过了，但我需要继续完善我的算法。如果您搜索 ConcurrentLinkedHashMap，您将看到我的项目页面...

如果 Java ME 不支持 CAS 操作（我希望这是真的），那么您可以做的就是基本同步。这对于 LHM 来说可能已经足够好了，因为我只在服务器端看到了高线程数的性能问题。所以对上面的答案+1。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T22:19:05.890

为什么要实施已经实施的东西？使用[**Ehcache**](http://ehcache.sourceforge.net/)。

**但是**，如果第三方库完全不可能，我猜您正在寻求实现一个看起来像这样的数据结构：

*   基本上是一个 HashMap（`HashMap<Object, Object>`如果你愿意，可以扩展）
*   Map 中的每个值都指向排序列表中的一个对象，基于哪个对象最常用。
*   最近使用的对象被添加到列表的头部 -`O(1)`
*   清除最近最少使用的意味着截断列表的末尾 -`O(1)`
*   仍然为您提供地图查找，但仍然首先保留最近使用的项目......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T22:58:22.830

另一种方法可能是查看Brian Goetz 的*Java Concurrency in Practice*中的第 5.6 节：“构建高效、可扩展的结果缓存”。看看 Memoizer，尽管您可能必须根据自己的目的对其进行自定义。

顺便说一句，我无法弄清楚为什么 Java 没有开箱即用的 ConcurrentLinkedHashMap。这种数据结构对于构建缓存非常有帮助。

# windows - Windows cygwin 等效于 Mac OS X 打开命令

> ID：583855
> 
> 赞同：4
> 
> 时间：2009-02-24T22:13:33.673
> 
> 标签：windows, command-line, cygwin, command-line-interface

我意识到这几乎与[Mac OS X“open”命令的 Windows 等价物和 Mac OS X“open”命令](https://stackoverflow.com/questions/501290/windows-equivalent-of-the-mac-os-x-open-command)的[Linux 等价物](https://stackoverflow.com/questions/264395/linux-equivalent-of-the-mac-os-x-open-command)几乎相同，但我特别询问我可以在 Cygwin shell 中运行以使用当前 Windows UI 应用程序绑定到参数的扩展名，如在 OS X 上，必要时打开该应用程序，并打开该应用程序中的指定文件。

cmd.exe start 命令不是 Cygwin shell 中的一个选项，xdg-open 或 gnome-open 也不能通过 Cygwin 获得。

有没有等价物？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T22:20:00.270

你似乎错过了这个：

[从 Cygwin 打开文件](https://stackoverflow.com/questions/577595/open-a-file-from-cygwin)

# python - 如何跨 Django 站点启用身份验证，并透明地保留任何 POST 或 GET 数据？

> ID：583857
> 
> 赞同：4
> 
> 时间：2009-02-24T22:14:28.273
> 
> 标签：python, django, authentication, wsgi, middleware

假设某人正在编辑一个 HTML 表单，并且他们的会话超时，那么如何让 Django 重新验证该人而不丢失用户输入表单的内容？

片段[Django Snippets: Require login across entire site](http://www.djangosnippets.org/snippets/136/)建议如何进行站点范围的身份验证，但我希望它会丢失字符串的 GET 组件（即因为 request.path 不包含它），并且肯定会丢失 POST 数据。

如何在那些不方便的超时中保留 POST 和 GET。我发现精巧的网站倾向于智能地处理这个问题，我希望能够在 Django 中做到这一点（我想其他人也会这样做！）。

想法将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T02:23:22.947

我有两个建议。

## 重定向/中间件

由于您已经在使用中间件来处理登录要求，因此您可以修改此中间件。或者可能，创建另一个在登录中间件之后调用的中间件类。这些想法相互交织，因此修改现有想法可能更有意义。

1.  如果未登录，则在中间件中捕获GET和POST数据，并将其存储在会话中
2.  如果用户已通过身份验证，请检查 #1 中设置的值。如果存在，则修改 request.GET 和 request.POST 以反映它，并删除会话数据。

我认为这应该干净利落，很多人会发现它很有用。[这将是djangosnippets.org](http://djangosnippets.org)上的一个很棒的帖子。

## 阿贾克斯技术

如果您已经准备好表单处理，这不太实用，但可以创造更好的用户体验。如果您以异步方式发布，您的 Javascript 处理程序可以识别“需要登录”响应代码，然后显示一个弹出对话框请求登录。完成后，用户可以重新提交表单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T22:33:18.430

将`onsubmit`处理程序添加到所有将通过 JS 检查会话并在继续之前提示使用登录的表单。这种方式在用户再次登录之前不会真正发生表单提交。

并确保您验证登录用户在会话中保持不变。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T23:35:57.390

它不完全是 Django 特定的，而是 HTTP（无状态）特定的......如果系统在处理 POST（从原始 POST 切换到 GET）时发出 Redirect 并冒丢失数据的风险，应该将数据存储在某个地方（db，memcached等）并通过身份验证（或其他）过程进行存储它们的密钥。

最简单的是 Cookie，因为它需要对密钥零关心。更困难但更防弹（针对只读 Cookie jars）是 URL 用户被重定向到以及从请求到请求的连续中继的关键（就像近十年前解决方案中的 SESSION）。

完成身份验证（或其他进程）后，可以通过传递的密钥（从 Cookie 或从 GET 请求变量）从数据存储中获取数据（和中断的进程）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T10:41:24.200

我一般不喜欢会话，尽管我认为您已经在使用经过身份验证的站点，因此上述答案可能适合您的方法。

如果没有会话，我会做类似于 Daniels 回答的事情，即在中间件中捕获原始 POST/GET，但我会更改重定向以包含发布的信息。

这在 GET 上更容易，通常只是在登录 url 的重定向组件中编码的完整 GET 字符串。

对于 POST，您可以转换为 get 方法，该方法适用于较小的表单，但对于会使 url 太长的较大表单，我会重新发布，将数据发布到可能编码的登录表单并将其存储在单个表单中隐藏（实际上几乎就像一个 .net 视图状态）

在 django 中执行此操作很棘手，因为您无法进行重定向，因此我将使用中间件手动调用登录视图，并从那里写入 HttpResponse。编辑在对此进行了更多研究之后，显然 django 的魔术管理端已经实现了类似的东西，正如[Jerry Stratton发现的那样](http://www.hoboes.com/Mimsy/?ART=625)

看起来是个不错的选择。我会尝试并反馈。

# c# - 为什么我会收到此 NullReferenceException？

> ID：583859
> 
> 赞同：0
> 
> 时间：2009-02-24T22:15:14.043
> 
> 标签：c#, serialization, nullreferenceexception

我正在从事一个涉及一些自制（反）序列化代码的项目，并且在反序列化列表时遇到了一些问题。以下代码在第二行抛出 NullReferenceException，即使 var`list`不为空，并且`Count = 0`当我将鼠标悬停在它上面时会愉快地报告。

```
System.Collections.IList list = ((System.Collections.IList)obj);
list.Add(val); 
```

我的变量被实例化有点奇怪，所以也许这与它有关？这是涉及的代码。

```
System.Runtime.Serialization.FormatterServices.GetUninitializedObject(type); 
```

`type`在哪里

```
System.Type.GetType("System.Collections.Generic.List`1[[Networking.Client, Networking, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"); 
```

任何帮助将非常感激 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T22:20:00.240

呸，我讨厌在我提出一个问题后才找到答案。事实证明，`List<T>`不喜欢使用 来实例化`GetUninitializedObject`，所以我必须为 Lists 添加一个特殊情况以使用 Activator.CreateInstance （这不是大多数类的选项）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T22:18:30.320

您的`val`实例化是否正确？这是我唯一能看到的问题，但很难说。

# asp.net - WebForm_SaveScrollPositionSubmit 未定义 - ASP.NET

> ID：583860
> 
> 赞同：2
> 
> 时间：2009-02-24T22:15:19.127
> 
> 标签：asp.net, javascript, .net-2.0, maintainscrollpositionon

我正在升级一个 ASP.NET 1.1 应用程序并且一切正常，但我看到标题中引用的 Javascript 错误。从研究看来，ASP.NET 并没有吐出用于在回发之间保持滚动位置的 javascript。

我做了一些谷歌搜索并检查了提到的各种问题，但似乎找不到可能发生的事情。

环境细节：

*   Win Server 2003 上的 IIS 6
*   虚拟目录正在运行 ASP.NET 2.0.50727
*   我已经在 web.config 部分设置了 maintainScrollPositionOnPostBack="True"

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T03:27:23.793

您是否有任何 httphandlers 或 httpmodules 可以进行任何类型的请求过滤或重写？或 global.asax 中的任何特殊内容会阻止 javascript 下降？我猜想某些东西阻止了内置的 axd 请求以获取处理 WebForm_SaveScrollPositionSubmit 的 javascript。

要确定确定启动[Fiddler](http://www.fiddlertool.com/fiddler/)并观察 HTTP 请求并确保它们都正确发生。

还要确保页面上至少有 1 个且只有 1 个表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T05:02:43.737

我发现问题是时间问题。如果服务器对构建的 DLL 有较旧的日期/时间，我遇到了这个问题。

# constraints - 解决时间限制的调度软件

> ID：583871
> 
> 赞同：3
> 
> 时间：2009-02-24T22:17:56.907
> 
> 标签：constraints, scheduling

是否有用于协调日程和组织会议的好软件或好的工具包？

我必须解决的具体问题：

我有来自*A组的**a*人和来自*B*组的*b*人。现在安排*A*中的人和*B*中的人之间的单独会议。

 ***这是一个现实生活中的问题。一家公司有一个开放日，有几个面试官。那天，一群准员工来访。对于每个潜在员工，我们必须安排与不同面试官的不同会议，所有这些会议都有不同的时间限制。

所以，这是一个约束满足问题。有没有好用的软件之类的？有任何想法吗？

**更新：**如果我们只使用一个简单的日历，那么安排所有会议将需要做很多工作。这几乎就像通过检查来找到图中的最短路径，而不是运行一个好的算法来计算答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T22:30:02.353

您应该能够使用[Integer Linear Programming](http://en.wikipedia.org/wiki/Linear_programming)解决这个问题。

Excel 有一个附加的求解器。您创建一个矩阵，定义约束并让 Solver 使用 IP 为您提供最佳解决方案。

看看[这里](http://www.sonoma.edu/users/w/wilsonst/Courses/Math_131/lp/default.html)IP 解决了什么样的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T22:31:18.170

Prolog 或衍生语言，例如 ECLiPSe。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T23:32:34.277

[涂鸦](http://www.doodle.com/main.html)网站可能有用吗？（不幸的名字，我知道……）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T23:42:47.797

我认为解决问题的最佳方法是使用约束编程工具包。您描述的问题很容易建模，因为没有那么多约束。至于要使用哪个约束工具包，那么这可能有点命中注定。如果您使用 Java，有一些免费的，我使用的是[Choco](http://www.emn.fr/x-info/choco-solver/doku.php)，它最近进行了重写，对于某些限制它可能会很慢 - 您最终只需要重新考虑您的模型。倾向于认为[ILOG](http://www.ilog.com/products/cp/)拥有最好的求解器之一——尽管我没有使用他们求解器的最新版本。此外，ILOG 不会在他们的网站上标明价格，而且我知道即使是学术许可证也非常昂贵。我认为 ILOG Solver 也适用于所有 .NET 语言和 Java。[微软凭借其Solver Foundation](http://code.msdn.microsoft.com/solverfoundation)进入了市场。我才刚刚开始看这个，但它看起来非常好，而且许可协议相当有利，即您可以在某些限制下免费使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T22:23:18.283

每个带有日历的群件解决方案都应该这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-31T16:36:12.667

我会说 Fendza 可以提供帮助，但这是[员工安排](http://www.employee-scheduling.com)而不是会议安排。我确信有一些免费的应用程序可以很好地开会。这个市场空间有大量的竞争对手和软件公司。

# algorithm - 如何检查有向图是否是无环的？

> ID：583876
> 
> 赞同：89
> 
> 时间：2009-02-24T22:19:46.840
> 
> 标签：algorithm, theory, directed-graph, directed-acyclic-graphs

如何检查有向图是否是无环的？算法是如何命名的？我会很感激参考。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-02-25T02:16:44.540

我会尝试[对图形进行拓扑排序](https://stackoverflow.com/questions/4168/graph-serialization/4577#4577)，如果你不能，那么它就有循环。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-02-25T02:08:37.350

做一个简单的深度优先搜索*不足以*找到一个循环。在一个 DFS 中可以多次访问一个节点而不存在循环。根据您从哪里开始，您也可能不会访问整个图表。

您可以按如下方式检查图形的连通分量中的循环。找到一个只有出边的节点。如果没有这样的节点，那么就有一个循环。在该节点上启动 DFS。遍历每条边时，检查边是否指向堆栈中已经存在的节点。这表明存在一个循环。如果您没有找到这样的边，则该连接组件中没有循环。

正如 Rutger Prins 指出的那样，如果您的图表未连接，您需要在每个连接的组件上重复搜索。

作为参考，[Tarjan 的强连通分量算法](http://en.wikipedia.org/wiki/Tarjan%E2%80%99s_strongly_connected_components_algorithm)是密切相关的。它还将帮助您找到周期，而不仅仅是报告它们是否存在。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-30T10:45:21.917

本书（第二版）上的引理 22.11`Introduction to Algorithms`指出：

> 有向图 G 是非循环的当且仅当 G 的深度优先搜索不产生后边

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-09-19T19:49:45.400

**解决方案**1 ：**卡恩算法检查循环**。主要思想：维护一个队列，将零度数的节点添加到队列中。然后一个一个地剥离节点，直到队列为空。检查是否存在任何节点的入边。

**解决方案**2 ：**Tarjan 算法**检查强连通分量。

**解决方案**3 ：**DFS**。使用整数数组来标记节点的当前状态：即 0 -- 表示该节点之前没有被访问过。-1 - 表示该节点已被访问，并且其子节点正在被访问。1 - 表示该节点已被访问，并且已完成。所以如果一个节点在做DFS的时候状态为-1，就说明一定存在一个循环。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-08-15T19:13:02.480

刚刚在谷歌采访中提出了这个问题。

# 拓扑排序

您可以尝试按拓扑排序，即 O(V + E)，其中 V 是顶点数，E 是边数。当且仅当可以做到这一点时，有向图是无环的。

# 递归叶子去除

递归删除叶节点，直到没有剩余，如果剩下的节点不止一个，你就有了一个循环。除非我弄错了，否则这是 O(V^2 + VE)。

# DFS 风格 ~ O(n + m)

然而，一个有效的 DFS 式算法，最坏情况 O(V + E)，是：

```
function isAcyclic (root) {
    const previous = new Set();

    function DFS (node) {
        previous.add(node);

        let isAcyclic = true;
        for (let child of children) {
            if (previous.has(node) || DFS(child)) {
                isAcyclic = false;
                break;
            }
        }

        previous.delete(node);

        return isAcyclic;
    }

    return DFS(root);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-25T01:29:06.680

ShuggyCoUk 给出的解决方案是不完整的，因为它可能不会检查所有节点。

```
 def isDAG(nodes V):
    while there is an unvisited node v in V:
        bool cycleFound = dfs(v)
        if cyclefound:
            return false
    return true 
```

这具有时间复杂度 O(n+m) 或 O(n^2)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-24T17:47:26.703

我知道这是一个老话题，但对于未来的搜索者来说，这里是我创建的 C# 实现（没有声称它是最有效的！）。这旨在使用一个简单的整数来标识每个节点。您可以根据自己的喜好进行装饰，只要您的节点对象正确地散列和等于。

对于非常深的图，这可能会产生很高的开销，因为它会在每个深度节点处创建一个哈希集（它们在广度上被破坏）。

您输入要从中搜索的节点以及到达该节点的路径。

*   对于具有单个根节点的图，您发送该节点和一个空哈希集
*   对于具有多个根节点的图，您可以将其包装在这些节点上的 foreach 中，并为每次迭代传递一个新的空哈希集
*   检查任何给定节点下方的循环时，只需将该节点与一个空哈希集一起传递

    ```
    private bool FindCycle(int node, HashSet<int> path)
    {

        if (path.Contains(node))
            return true;

        var extendedPath = new HashSet<int>(path) {node};

        foreach (var child in GetChildren(node))
        {
            if (FindCycle(child, extendedPath))
                return true;
        }

        return false;
    } 
    ```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-10-28T05:14:07.023

做DFS时不应该有任何后边。在做DFS时跟踪已经访问过的节点，如果在当前节点和现有节点之间遇到一条边，则图有循环。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-01-10T14:59:15.397

这是一个快速代码，用于查找图形是否有循环：

```
func isCyclic(G : Dictionary<Int,Array<Int>>,root : Int , var visited : Array<Bool>,var breadCrumb : Array<Bool>)-> Bool
{

    if(breadCrumb[root] == true)
    {
        return true;
    }

    if(visited[root] == true)
    {
        return false;
    }

    visited[root] = true;

    breadCrumb[root] = true;

    if(G[root] != nil)
    {
        for child : Int in G[root]!
        {
            if(isCyclic(G,root : child,visited : visited,breadCrumb : breadCrumb))
            {
                return true;
            }
        }
    }

    breadCrumb[root] = false;
    return false;
}

let G = [0:[1,2,3],1:[4,5,6],2:[3,7,6],3:[5,7,8],5:[2]];

var visited = [false,false,false,false,false,false,false,false,false];
var breadCrumb = [false,false,false,false,false,false,false,false,false];

var isthereCycles = isCyclic(G,root : 0, visited : visited, breadCrumb : breadCrumb) 
```

这个想法是这样的：一个普通的 dfs 算法，它有一个数组来跟踪访问的节点，还有一个额外的数组作为指向当前节点的节点的标记，这样当我们为节点执行 dfs 时我们将其在标记数组中的对应项设置为真，这样当遇到一个已经访问过的节点时，我们检查其在标记数组中的对应项是否为真，如果它为真，那么它就是让给自己的节点之一（因此cycle) ，诀窍是每当节点的 dfs 返回时，我们将其相应的标记设置回 false ，这样如果我们从另一条路线再次访问它，我们就不会被愚弄。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-06-21T10:17:01.053

这是我在伪代码中的实现：

```
bool Acyclacity_Test
   InitColor() //Sets to WHITE every vertex
   while there is a node v in V:
      if (v.color == WHITE) then
         tmp = Aux_Acy(v);
         if ( not tmp ) return false
   return true
END

bool Aux_Acy(u)
   u.color = GREY
   for each node v in Adj(u)
       if(v.color == GREY) return false
       else if(v.color == WHITE) tmp = Aux_Acy(v)
       if(!tmp) return false;
   u.color = BLACK
   return true
END 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-06-27T19:45:52.223

这是我的[剥离叶节点算法](http://www.cs.hmc.edu/~keller/courses/cs60/s98/examples/acyclic/)的 ruby​​ 实现。

```
def detect_cycles(initial_graph, number_of_iterations=-1)
    # If we keep peeling off leaf nodes, one of two things will happen
    # A) We will eventually peel off all nodes: The graph is acyclic.
    # B) We will get to a point where there is no leaf, yet the graph is not empty: The graph is cyclic.
    graph = initial_graph
    iteration = 0
    loop do
        iteration += 1
        if number_of_iterations > 0 && iteration > number_of_iterations
            raise "prevented infinite loop"
        end

        if graph.nodes.empty?
            #puts "the graph is without cycles"
            return false
        end

        leaf_nodes = graph.nodes.select { |node| node.leaving_edges.empty? }

        if leaf_nodes.empty?
            #puts "the graph contain cycles"
            return true
        end

        nodes2 = graph.nodes.reject { |node| leaf_nodes.member?(node) }
        edges2 = graph.edges.reject { |edge| leaf_nodes.member?(edge.destination) }
        graph = Graph.new(nodes2, edges2)
    end
    raise "should not happen"
end 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-02-12T21:34:38.673

您可以在这里使用我的答案中的查找周期反转[https://stackoverflow.com/a/60196714/1763149](https://stackoverflow.com/a/60196714/1763149)

```
def is_acyclic(graph):
    return not has_cycle(graph) 
```

# firefox - 为什么 Firefox 对输入元素使用 IE 框模型？

> ID：583882
> 
> 赞同：3
> 
> 时间：2009-02-24T22:21:10.423
> 
> 标签：firefox, html, input, css

试试下面的简单例子：

```
<html>
<head>
<style>
  div,
  input {
    border: 1px solid #000;
    margin: 2px;
    padding: 3px;
    width: 100px;
  }
</style>
</head>
<body>
  <div>div</div>
  <input value="input" />
</body>
</html> 
```

注意 div 和输入的宽度不同。实际上输入的宽度是92px。对于输入，Firefox 计算边框和填充之外的宽度，就像 IE 对所有内容所做的一样。它不应该像对待其他所有元素一样对待输入元素，并将填充和边框添加到宽度吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T23:18:38.507

正如 phihag 所说，它是块与内联。

但是，您的示例存在一个缺陷：您没有使用 DOCTYPE。

这意味着浏览器可以自由呈现它认为合适的内容。

坚持`<!DOCTYPE html>`在顶部使用漂亮而紧凑的 HTML5 DOCTYPE，这将防止浏览器进入 Quirks 模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T23:14:07.817

宽度问题是脑死亡 IE 兼容怪癖模式的结果。有关补救措施，请参阅 Peter Boughton 的答案（doctype）。

此外，`div`是块级元素，但`input`不是。添加`display:block;`到您的规则以在两种情况下实现 div 渲染，或`display:inline;`将两个元素格式化为内联。但是，Firefox 会原谅顶级内联元素并适当地呈现它们。

# unix - 如何一次解压多个文件？

> ID：583889
> 
> 赞同：77
> 
> 时间：2009-02-24T22:23:46.830
> 
> 标签：unix, shell, tar

我在一个目录中有一堆`tar`文件，我想一次从中提取所有文件。但这似乎没有任何作用：

```
$ tar xf *.tar 
```

这里发生了什么？如何一次解压一堆文件？

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2009-02-24T22:23:58.483

# 这里发生了什么？

最初，该`tar`命令旨在用于磁带设备。由于一次只`tar`在一台设备上执行才有意义，因此语法设计为假定只有一台设备。假定传递的第一个文件或目录是保存有问题的存档的设备以及要包含在操作中的存档内容的任何其他文件或目录。因此，对于`tar`提取（`x`选项），传递的第一个文件将是存档，所有其他文件将是要提取的文件。因此，如果有两个`*.tar`文件（例如`a.tar`和`b.tar`），您的命令将扩展为：

```
$ tar xf a.tar b.tar 
```

除非`a.tar`包含一个名为 的文件`b.tar`，否则该`tar`命令无关紧要并安静地退出。令人讨厌的是，Solaris 版本`tar`的返回代码或详细选项 ( ) 都没有报告任何问题`v`。同时，即使关闭了详细选项，也会`GNU tar`返回`2`和垃圾邮件：`STDERR`

```
tar: b.tar: Not found in archive
tar: Exiting with failure status due to previous errors 
```

# 如何一次解压一堆文件？

现在重写接受多个存档文件作为输入为时已晚`tar`，但解决这个限制并不难。

对于大多数人来说，`tar`多次运行多个档案是最方便的选择。只传递一个文件`tar xf`名将按预期提取所有存档文件。一种方法是使用 shell`for`循环：

```
$ for f in *.tar; do tar xf "$f"; done 
```

另一种方法是使用`xargs`：

```
$ ls *.tar | xargs -i tar xf {} 
```

或者，您可以使用多种[替代`tar`文件阅读器](https://stackoverflow.com/questions/484133/whats-a-good-tar-utility-for-windows)中的一种。最后，真正敬业的程序员可以很容易地编写出`tar`完全符合要求的替代品。[格式](http://www.mkssoftware.com/docs/man4/tar.4.asp)很简单，许多编程语言都有可用于读取`tar`文件的库。例如，如果您是 Perl 程序员，请查看该[`Archive::Tar`](http://perldoc.perl.org/Archive/Tar.html)模块。

## 一个警告

盲目地解压一堆文件可能会导致意想不到的问题。最明显的是，一个特定的文件名可能包含在多个`tar`文件中。由于`tar`默认情况下会覆盖文件，因此您最终得到的文件的确切版本将取决于档案的处理顺序。更麻烦的是，如果你尝试这个“聪明”的优化，你最终可能会得到一个损坏的文件副本：

```
for f in *.tar; do
  tar xf "$f" &
done
wait 
```

如果两者都`a.tar`包含`b.tar`相同的文件并尝试同时提取它，则结果是不可预测的。

一个相关的问题，尤其是从不受信任的来源获取档案时，是[tarbomb](http://www.linfo.org/tarbomb.html)的可能性。

一种部分解决方案是自动创建一个新目录以提取到：

```
for f in *.tar; do 
  d=`basename "$f" .tar`
  mkdir "$d"
  (cd "$d" && tar xf "../$f")
done 
```

如果在存档中使用绝对路径指定文件（这通常是恶意意图的标志），这将无济于事。添加这种检查留给读者作为练习。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-12-31T21:37:09.013

如果所有 tar 文件都在同一个文件夹中，那么我在 tcsh shell 中执行此操作。一直在工作。

```
find -iname \*.tar -exec tar -xvf {} \; 
```

这与上面的答案相同，我认为更简洁一些。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-06-12T15:08:10.153

```
find . -maxdepth 1 -name '*.tar' -exec tar -xf '{}' \; 
```

# javascript - 健壮、成熟、可扩展的（JavaScript）数据网格？

> ID：583894
> 
> 赞同：0
> 
> 时间：2009-02-24T22:25:20.400
> 
> 标签：javascript, datagrid, grid, components

我正在寻找一种很好的客户端方式来呈现主要由数据网格组成的 Web 应用程序的数据。它不一定是 JavaScript，但它似乎是最合乎逻辑的选择，因为我喜欢 JavaScript。另外，我不考虑使用 Flex。

到目前为止，我想出了以下（`<acronym title="JavaScript">JS</acronym>`仅）：

*   [英格丽德](http://www.reconstrukt.com/ingrid/)
*   [jqGrid](http://www.trirand.com/blog/)
*   [ExtJS 网格组件](http://extjs.com/deploy/dev/examples/samples.html#sample-1)

ExtJS 网格看起来最有前途，因为它成熟、易于扩展且功能丰富（在线编辑、分组、分页等）。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T22:33:54.810

您应该尝试 YUI 库的网格部分。[http://developer.yahoo.com/yui/datatable/](http://developer.yahoo.com/yui/datatable/) YUI 是一个非常高质量的库，雅虎在其最苛刻的页面上使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T22:37:00.793

这里有一些非常漂亮的 JQuery 插件：[JQuery 插件](http://www.noupe.com/ajax/37-more-shocking-jquery-plugins.html)（#22 和 #23），绝对值得一看！

# multithreading - 多核机器上更快的基础数据结构？

> ID：583896
> 
> 赞同：12
> 
> 时间：2009-02-24T22:25:52.877
> 
> 标签：multithreading, data-structures, parallel-processing

这个问题我想了很久：

您能否利用拥有多个 CPU 的事实在多核机器上构建更快的基础数据结构（即链表、哈希表、集合、跳过列表、布隆过滤器、红黑树等）？

我对 pthreads 做了一些初步试验，发现 pthread_create() 大约需要 30us，但是一个简单的 hash_map 插入比在单核上花费的时间要少得多。因此，我很难想象创建一个更快的 hash_map<>，因为同步原语和线程创建是如此缓慢。我也可以想象树遍历和并行平衡，但同样，同步原语似乎使运行时间更长，而不是更短。

我仍然觉得“我有更多的 CPU，因此，我应该能够更快地做到这一点”对我来说仍然很直观，但我不能完全围绕该陈述的证明或反证明。我在 C++ 中进行了相当多的实验，但现在我怀疑其他语言可能会为此任务提供更好的解决方案（erlang？）。想法？

编辑细节：我认为有几种经常使用的编程/数据结构范例可能会加快速度。例如，我发现自己经常编写基本上看起来像这样的代码（其中真实数据已替换为“rand()”）

```
static const int N = 1000000; 
static const int M = 10000000; // 10x more lookups 
hash_map<int, int> m; 
// batch insert a bunch of interesting data 
for (int i = 0; i < N; i++) m[rand()] = rand(); 

// Do some random access lookups. 
for (int i = 0; i < M; i++) m[rand()]++; 
```

这种范式经常用于名称-值设置和配置数据、批处理等。10 倍（或更多）的查找/插入比率使传统的 hash_map<> 成为此类操作的理想选择。

这可以很容易地分成两半，一个插入阶段和一个查找阶段，在并行世界中，两半之间可能会有一些“刷新队列”操作。更困难的是交错插入 + 查找版本：

```
hash_map<int, int> m; 

for (int i = 0; i < N; i++) { 
   if (rand() % LOOKUP_RATIO == 0) 
     hash_map[rand()]++;  // "lookup" 
   else 
     hash_map[rand()] = rand();  // "insert" 
} 
```

在这种情况下，只要在每次查找之前刷新插入队列，插入就可以是异步的，并且如果 LOOKUP_RATIO 足够大（例如，>1000），那么它就变得与上面的批处理示例非常相似，但有一些排队。虽然，排队意味着同步原语。

想象一下，下面的代码片段：

```
hash_map<int,int> a;
hash_map<int,int> b; 
for (int i = 0; i < N; i++) { 
  // the following 2 lines could be executed in parallel 
  a[rand()] = rand(); 
  b[rand()] = rand(); 
} 
```

因此，可以通过以下方式“并行”进行查找：

```
int lookup(int value) { 
  // The following 2 lines could be executed in parallel: 
  v1 = a[value]; 
  v2 = b[value]; 
  if (v1)  // pseudo code for "value existed in a" 
    return v1; 
  else 
    return v2; 
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T22:31:28.887

问题是共享数据本身就是并行计算的祸根。理想情况下，您希望每个核心都处理单独的数据，否则会产生与同步相关的开销。（如何在没有共享状态的情况下进行通信？通过消息传递。）

此外，谈论加速数据结构有点奇怪。我发现谈论正在加速的数据结构上的操作更自然，因为不同数据结构上的不同操作具有不同的特征。是否有您想要加速的特定类型的访问？

编辑，以回应额外的细节：我假设目标是有一个可以并行访问的哈希映射，它的基础可以是多个哈希表，但它会透明地呈现给这个数据结构的用户作为单个哈希表。自然，我们会担心花太多时间在锁上旋转。同样在这个级别，我们必须注意缓存一致性问题。也就是说，如果内核或处理器具有指向相同数据的单独高速缓存，并且其中一个修改了数据，则另一个上的高速缓存数据将失效。如果这种情况反复发生，可能会带来巨大的成本，并且并行性可能比在单核上运行更糟糕。所以我对共享数据非常警惕。

我的直觉是拥有一个线程池，每个线程都拥有哈希表的不同部分。哈希首先从键映射到哈希表部分，然后映射到该部分中的偏移量。更新将作为消息传递给拥有哈希表该部分的线程。这样一来，没有人会试图一次修改相同的东西。自然，这在具有异步消息传递并发特性的语言（Erlang）中比在其他语言中更容易。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T23:00:18.460

首先，我认为将`pthread_create()`时间与 hashmap 操作进行比较是不合适的。在有争议和无争议的情况下，更好地与（解锁）锁定时间进行比较。

仍然，你是对的，同步时间是瓶颈并且变得更糟，因为它们必须进入 CPU 间总线/桥/通道，无论如何，而大多数其他数据结构试图留在缓存中（甚至在影子寄存器中） .

解决这个问题有两个主要方向：

1.  更好的共享结构：检查无锁结构和/或事务内存。两者都试图通过用“try-check-commit/rollback”替换“lock-modify-release”循环来最大化可访问性。在大多数情况下，检查应该成功，因此回滚不应影响平均性能。通常检查/提交是原子完成的，因此在 CPU 带宽方面很昂贵，但比传统锁要少得多。

2.  减少共享：这就是 erlang/haskell 语言所强调的。使传输小消息变得容易且成本低廉，线程间通信看起来更像是带参数的函数调用，而不是共享内存。这更具可扩展性，因为只有两个进程必须同步，并且（理论上）可以使用具有较低延迟的非 RAM 通道。

编辑：我很惊讶没有人对无锁结构有任何意见。检查[这个](http://www.azulsystems.com/events/javaone_2007/2007_LockFreeHash.pdf)（pdf）和[这个](http://video.google.com/videoplay?docid=2139967204534450862)（视频）关于 Java 中的无锁哈希表实现，它（几乎）线性扩展至 300 CPU

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T23:14:15.553

我每天都在处理这个问题。我发现链表之类的东西非常有用，因为您可以让并行算法的每个线程构建自己的链表，然后在完成后将它们缝合到主节点上。几乎没有开销，只要你的线程是真正独立的

如果您每个人都有要使用的数据数组，我发现为每个线程分配一个较小的数组来处理几乎总是更好，然后在完成后将小数组合并回主数组 - 事实上，如果您在集群中环境，甚至不可能使用“相同”的数组！

如果你正在实现一个使用关联数组的算法（想想 .NET 字典），你几乎总是会在线程之间的某个地方重复一些工作。尽可能避免这些。

如果您正在为 CUDA (GPU) 环境进行编码，您将很快了解到整个世界可以（不，应该！）在操作之前被重铸为一个数组:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T22:31:17.827

我认为您需要查看数据结构并询问“可以异步完成什么？”

对于很多数据结构，我看到的并不多。

但是对于一些更深奥或使用较少的结构，我敢打赌。我敢打赌，重新平衡某些类型的树可以并行化。我敢打赌，遍历图可能是（尽管这可能是算法而不是数据结构）。我敢打赌，可以遍历一个双向链表（从每一端）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T02:02:52.217

我不相信在单个查找中会有很多并行性。但是，如果您有一个完整的项目列表要查找，情况就不同了。

获取一个哈希表并获取一个大的键列表以在哈希表或树中查找。在 2 个 CPU 之间拆分键列表会使性能翻倍。

或者获取要插入的大量项目列表。将哈希表划分为每个 CPU 区域并划分密钥列表。然后每个 CPU 可以将项目填充到自己的哈希表中。

这也适用于向量、B+树和二叉树，尽管我相信哈希表可以构建为需要稍微少一些的更新锁定。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-23T16:27:32.917

请看这篇 CACM 文章 -**多核时代的数据结构**（不幸的是，它是高级内容）：[http ://cacm.acm.org/magazines/2011/3/105308-data-structures-in-the-multicore-年龄/全文](http://cacm.acm.org/magazines/2011/3/105308-data-structures-in-the-multicore-age/fulltext)

本文的早期版本在这里：[http ://www.cs.tau.ac.il/~shanir/concurrent-data-structures.pdf](http://www.cs.tau.ac.il/~shanir/concurrent-data-structures.pdf)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-25T02:04:41.323

Javier 有一个很好的观点：如果您正在并行执行操作，那么您已经拥有了线程，您只需要让它们有事可做。

我认为这在很大程度上归结为标准的读者和作家问题。如果他们所做的只是读取或其他非破坏性操作，您应该能够使用哈希表拥有几乎无限数量的线程。但是，一旦他们中的一个需要进行写入，那么他们必须在整个哈希表上获取一个排他锁（除非您首先在外部对您的密钥进行哈希处理，那么理论上他们可以在他们哈希到的存储桶上获得一个锁，取决于您的冲突解决机制）。

要考虑的一件事是每个数据结构有一个（或一个小池）线程，并将访问视为“服务”。也就是说，它不是线程在哈希映射中查找内容，而是向为该数据结构提供服务的线程发出同步请求。这会本地化锁定操作（只有为请求提供服务的线程必须知道锁定技术），但可能会使请求队列成为瓶颈。

我认为，正如其他人所说，利用并行性的最佳方法是通过您的算法，而不是数据结构。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-25T02:08:13.263

将所有内容放入工作队列中。这是关键——让您更接近跨多台机器的扩展。同步很昂贵，而且以后只会变得更昂贵（想象一下有 128 个 CPU 的内存屏障）。

# c# - C#如何在继续之前等待网页完成加载

> ID：583897
> 
> 赞同：35
> 
> 时间：2009-02-24T22:25:58.773
> 
> 标签：c#, webbrowser-control

我正在尝试创建一个程序，通过我们的缺陷跟踪系统的 Web 界面一次克隆多个错误。在继续之前如何等待页面完全加载？

```
//This is pseudo code, but this should give you an idea of what I'm trying to do.  The
//actual code uses multi-threading and all that good stuff :).
foreach (string bug in bugs)
{
    webBrowser.Navigate(new Uri(url));
    webBrowser.Document.GetElementById("product").SetAttribute("value", product);
    webBrowser.Document.GetElementById("version").SetAttribute("value", version);
    webBrowser.Document.GetElementById("commit").InvokeMember("click");

    //Need code to wait for page to load before continuing.
} 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-24T22:30:23.007

尝试`DocumentCompleted`事件：

```
webBrowser.DocumentCompleted +=
    new WebBrowserDocumentCompletedEventHandler(webBrowser_DocumentCompleted);

void webBrowser_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
{
    webBrowser.Document.GetElementById("product").SetAttribute("value", product);
    webBrowser.Document.GetElementById("version").SetAttribute("value", version);
    webBrowser.Document.GetElementById("commit").InvokeMember("click");
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-06-05T14:04:00.763

这段代码对我很有帮助。也许它也适合你

```
wb.Navigate(url);
while(wb.ReadyState != WebBrowserReadyState.Complete)
{
     Application.DoEvents();
}
MessageBox.Show("Loaded"); 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-02-23T06:39:10.620

在不阻塞 UI 线程的情况下执行此操作的最佳方法是使用 .net 4.5 中引入的 Async 和 Await。
您可以将其粘贴到您的代码中，只需将浏览器更改为您的网络浏览器名称。这样，您的线程*等待*页面加载，如果它没有按时加载，它将停止等待并且您的代码继续运行：

```
private async Task PageLoad(int TimeOut)
    {
        TaskCompletionSource<bool> PageLoaded = null;
        PageLoaded = new TaskCompletionSource<bool>();
        int TimeElapsed = 0;
        Browser.DocumentCompleted += (s, e) =>
        {
            if (Browser.ReadyState != WebBrowserReadyState.Complete) return;
            if (PageLoaded.Task.IsCompleted) return; PageLoaded.SetResult(true);
        };
        //
        while (PageLoaded.Task.Status != TaskStatus.RanToCompletion)
        {
            await Task.Delay(10);//interval of 10 ms worked good for me
            TimeElapsed++;
            if (TimeElapsed >= TimeOut * 100) PageLoaded.TrySetResult(true);
        }
    } 
```

您可以像这样使用它，在异步方法或按钮单击事件中，只需使其异步：

```
private async void Button1_Click(object sender, EventArgs e)
{
   Browser.Navigate("www.example.com");
   await PageLoad(10);//await for page to load, timeout 10 seconds.
   //your code will run after the page loaded or timeout.
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-24T22:29:30.887

查看[WatiN 项目](http://watin.sourceforge.net/)：

> 受[Watir](http://watir.com/)的启发，WatiN 的开发始于 2005 年 12 月，旨在为 .Net 语言提供类似的 Web 应用程序测试。从那时起，WatiN 已经成长为一个易于使用、功能丰富且稳定的框架。WatiN 是用 C# 开发的，旨在为您提供一种使用 .Net 使用 Internet Explorer 和 FireFox 自动化测试的简单方法...

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-05-02T15:34:51.143

任务方法对我有用，除了 Browser.Task.IsCompleted 必须更改为 PageLoaded.Task.IsCompleted。

对不起，我没有添加评论，那是因为我需要更高的声誉才能添加评论。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-01-05T12:43:01.283

yuna 和 bnl 代码在以下情况下失败；

**失败的例子：**

第一个等待完成。但是，第二个带有 invokemember("submit") didt 。调用作品。但是 ReadyState.Complete 在它真正完成之前就像它的 Completed 一样：

```
wb.Navigate(url);
while(wb.ReadyState != WebBrowserReadyState.Complete)
{
   Application.DoEvents();
}
MessageBox.Show("ok this waits Complete");

//navigates to new page
wb.Document.GetElementById("formId").InvokeMember("submit");
while(wb.ReadyState != WebBrowserReadyState.Complete)
{
   Application.DoEvents();
}
MessageBox.Show("webBrowser havent navigated  yet. it gave me previous page's html.");  
var html = wb.Document.GetElementsByTagName("HTML")[0].OuterHtml; 
```

* * *

**如何解决这种不需要的情况：**

用法

```
 public myForm1 {

        myForm1_load() { }

        // func to make browser wait is inside the Extended class More tidy.
        WebBrowserEX wbEX = new WebBrowserEX();

        button1_click(){
            wbEX.Navigate("site1.com");
            wbEX.waitWebBrowserToComplete(wb);

            wbEX.Document.GetElementById("input1").SetAttribute("Value", "hello");
            //submit does navigation
            wbEX.Document.GetElementById("formid").InvokeMember("submit");
            wbEX.waitWebBrowserToComplete(wb);
            // this actually waits for document Compelete. worked for me.

            var processedHtml = wbEX.Document.GetElementsByTagName("HTML")[0].OuterHtml;
            var rawHtml = wbEX.DocumentText;
         }
     }

//put this  extended class in your code.
//(ie right below form class, or seperate cs file doesnt matter)
public class WebBrowserEX : WebBrowser
{
   //ctor
   WebBrowserEX()
   {
     //wired aumatically here. we dont need to worry our sweet brain.
     this.DocumentCompleted += (o, e) => { webbrowserDocumentCompleted = true;};
   }
     //instead of checking  readState, get state from DocumentCompleted Event 
     // via bool value
     bool webbrowserDocumentCompleted = false;
     public void waitWebBrowserToComplete()
     {
       while (!webbrowserDocumentCompleted )
       { Application.DoEvents();  }
       webbrowserDocumentCompleted = false;
     }

 } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-24T22:45:54.967

试试 Selenium ( [http://seleniumhq.org](http://seleniumhq.org) ) 或 WatiN ( [http://watin.sourceforge.net](http://watin.sourceforge.net) ) 以节省一些工作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-24T22:28:56.287

如果您使用 InternetExplorer.Application COM 对象，请检查 ReadyState 属性的值 4。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-24T22:29:45.240

我认为 WebBrowser 控件的[DocumentCompleted](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.documentcompleted.aspx)事件应该让您到达您需要去的地方。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-24T22:31:47.763

假设“commit”元素代表一个标准的表单提交按钮，那么您可以将事件处理程序附加到 WebBrowsers Navigated 事件。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-01-24T08:36:58.473

```
while (true)
        {//ie is the WebBrowser object
            if (ie.ReadyState == tagREADYSTATE.READYSTATE_COMPLETE)
            {
                break;
            }
            Thread.Sleep(500);
        } 
```

我用这种方式等到页面加载。

# python - PyGTK 小部件不透明度

> ID：583906
> 
> 赞同：0
> 
> 时间：2009-02-24T22:29:50.013
> 
> 标签：python, user-interface, gtk, pygtk

有没有办法在 PyGTK 中设置小部件的不透明度？
我知道windows有一个功能：

```
gtk.Window.set_opacity(0.85) 
```

但似乎没有任意小部件的等价物。
有人有想法么？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T22:44:52.083

[从 pygtk 参考](http://www.pygtk.org/docs/pygtk/class-gdkwindow.html#method-gdkwindow--set-opacity)：

> 要设置每像素 Alpha，请参阅`gtk.gdk.Screen.get_rgba_colormap()`。要使非顶层窗口半透明，请参阅`gtk.gdk.Window.set_composited()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T22:52:24.030

也可能值得研究[pygtkglext](http://www.k-3d.org/gtkglext/Main_Page)以获得更高级的小部件。

# iis - IIS 7 和故障转移伙伴

> ID：583921
> 
> 赞同：1
> 
> 时间：2009-02-24T22:32:29.197
> 
> 标签：iis, iis-7, connection-string, mirroring

我正在尝试将一些 asp.net 应用程序从 iis 6 迁移到 iis 7，但我遇到了一些障碍。我找不到任何关于我所看到的问题的文档，并想看看其他人是否遇到了同样的问题。

我在我的数据库上使用 SQL Server 2005 db 镜像。在我的应用程序的连接字符串中，我指定了故障转移伙伴，这在 iis 6 中没有引起任何问题。现在在移动到 iis 7 后，连接字符串中的故障转移伙伴关键字导致我的应用程序在尝试访问数据库时超时。当我从连接字符串中删除故障转移合作伙伴关键字时，应用程序工作正常。

有没有人遇到过这个问题？这是预期的行为还是某种错误？

任何人都可以提供给我的任何信息将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T23:25:25.527

ado.net 2.0 应用程序也存在类似问题，但很久以前就已修复。您是否安装了 .net 3.5？如果没有，请安装它，因为它包含 2.0 和 3.0 的服务包。

[http://support.microsoft.com/kb/912151](http://support.microsoft.com/kb/912151)当您尝试使用基于 ADO.NET 2.0 的 SQL Server 2005 镜像数据库时，连接可能会在第一次尝试连接到故障转移伙伴服务器之前超时应用

# apache - 如何告诉 Apache 忽略/阻止 404 错误并重定向到处理程序页面？

> ID：583922
> 
> 赞同：2
> 
> 时间：2009-02-24T22:32:48.417
> 
> 标签：apache, seo, http-status-code-404

### 这个概念

所以，我已经用每个人都喜欢的自己的内容管理系统（CMS）制作（实际上升级了）这个网站。与大多数 CMS 一样，默认行为是带有丑陋且完全无用的 url 的访问页面，如下所示：

```
www.mysite.edu/index.php?pageid=xxxx 
```

所以我们的想法是改变它，这样我们就可以拥有“真实”的 URL，这些 URL 不仅看起来更好，而且有望与 Google 搜索引擎更好地协作。改变真的没有那么难：

1.  通过 Apache 看到没有具有相应 URL 的页面，并使用 ErrorDocument 404 /redirect.php 重定向到 /redirect.php
2.  redirect.php 剥离 URL 并在数据库中找到它的条目。
3.  redirect.php 从页面条目中回显 HTML 数据。

因为所有页面都是在分层结构中创建的（根据 CMS），所以查找页面只需逐个子项搜索数据库，直到找到最后一个。这样一来，诸如 URL 之类的 URL`www.mysite.edu/me/something/useful`会调出一个条目，该条目`useful`是. 所有页面 HTML 都存储在数据库中，因此一旦找到条目，通过 PHP 将其回显到页面是一件简单的事情。`something``me`

**旁注：**我实际上创建了一个新表，它存储每个页面的完整 URL 并将其链接到它`pageid`，因此搜索过程得到了很大改进，而总体思路保持不变。

### 问题

在客户端，一切都运行得非常好。然而，我注意到谷歌还没有索引我们网站的很多（任何）。基本上，在我重新设计它之前，它已经在某种程度上被索引了，现在索引剩下的就是那些 URL 保持不变的文件。

我终于（今天）从 Google Webmaster Tools 获得了一些数据，显示它在我们的 sitemap.xml 中列出的页面上不断出现 404 错误，但是，当我点击链接时，页面就正常了。这让我相信，虽然重定向运行良好，但 Apache 仍在发送一条`Status: 404`消息，可能会提示 Google 的机器人停止处理和/或不索引页面。

### 问题

所以考虑到这一切，问题是这样的：

1.  有没有办法首先确认 Apache 仍在发送`Status: 404`消息？
    *   回答：是的！
2.  有没有办法让它在仍然重定向到 /redirect.php 的同时停止

提前致谢！

**编辑 1：** 感谢 alex 向我介绍了 firebug 中的 Net 选项卡。由于我非常喜欢和使用 firebug，我相信这个新功能在以后会派上用场（阅读：目前正在研究它可以做的其他事情）。感谢您的帖子，我已经能够***确认***这`Status: 404`确实是需要解决的正确问题。现在的问题具体是**如何**禁用 Apache 发送此错误并在需要时简单地重定向页面。

根据要求，这是我文件中的一些代码示例。关于配置文件需要注意的一件事是，我在 Debian Etch 上运行并通过“ `apt-get install apache2 mysql-server php5`”安装，因此它们分散了一点，而列出的文件的片段是我认为唯一对此有影响的文件问题。由于它是一个大文件（669 行），如果您想查看更多内容，请告诉我哪些部分有用，我将包含它。

`/etc/apache2/apache2.conf`

```
...
ErrorDocument 404 /redirector.php
... 
```

`/etc/apache2/apache2.conf`- 空白文件

`/www-root/redirector.php`

```
<?php
//get the URL string after server id.
//    e.g. www.mysite.edu/page returns "/page"
$pageReq = preg_replace("/\/$|\.php$|\.html?$/","",$_SERVER['REQUEST_URI']);

if(substr($pageReq,0,5)=='/wiki') {    //am I redirecting to the wiki app
    include "mewiki/wiki.php";
} else {                                //rest of site - what google will see
    if($pageReq=='')                    //most site looks like /ME/something
        $pageReq = '/ME';               //this fixes index to be appear as /ME
    include "config.php";

    //query the database for pageid
    mysql_connect($meweb['host'],$meweb['user'],$meweb['pass']);
    mysql_select_db($meweb['database2']);
    $qPageReq = mysql_query("SELECT pageid FROM url_redirects WHERE ".
                                "url='".$pageReq."'".
                                "ORDER BY updated DESC LIMIT 1");
    if($qPageReq) {
        //query database for actual page
        $pageid = mysql_fetch_assoc($qPageReq);
        $qPage = mysql_query("SELECT * FROM pages WHERE pageid=".
                                                $pageid['pageid']);
            if($qPage) {
                //createPage() is in page_loader.php.  It actually does a lot
                include "page_loader.php";
                createPage(mysql_fetch_assoc($qPage));
            }
    }
    mysql_close();
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T09:29:31.287

您需要发送 OK 标头，添加`header('HTTP/1.1 200 OK')`到您的代码中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T23:16:29.777

您可以使用 Firebug 来查看它是否正在发送 404 标头。使用*网络*选项卡。如果是 404ing，则页面的 GET 将显示为红色。或者，您可以使用 Live HTTP 标头。这些仅适用于 Firefox。

您可以发布一些重定向到redirect.php 的.htaccess 吗？

# iis - 试图在 System.Web.Hosting.UnsafeIISMethods.MgdGetSiteNameFromId 读取或写入受保护的内存

> ID：583932
> 
> 赞同：1
> 
> 时间：2009-02-24T22:35:55.757
> 
> 标签：iis, iis-7, interop

当我点击 COM 互操作 ASP 页面（调用托管 .NET 代码）时，我得到了一个 AV。感觉这与 IIS 7 / Windows 2008 有关。

谷歌无法弄清楚这一点。有任何想法吗？

尝试读取或写入受保护的内存。这通常表明其他内存已损坏。

```
 at System.Web.Hosting.UnsafeIISMethods.MgdGetSiteNameFromId(UInt32 siteId, IntPtr& bstrSiteName, Int32& cchSiteName)
   at System.Web.Configuration.ProcessHostConfigUtils.GetSiteNameFromId(UInt32 siteId)
   at System.Web.Configuration.ProcessHostServerConfig..ctor()
   at System.Web.Configuration.ProcessHostServerConfig.GetInstance()
   at System.Web.Configuration.ServerConfig.GetInstance()
   at System.Web.Caching.CacheMemoryPrivateBytesPressure.ReadConfig(CacheSection cacheSection)
   at System.Web.Caching.CacheMemoryStats.ReadConfig(CacheSection cacheSection)
   at System.Web.Caching.CacheCommon.ReadCacheInternalConfig(CacheSection cacheSection)
   at System.Web.HttpRuntime.get_Cache() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-26T12:27:22.513

升级到 Windows 7（和 IIS7）后，我遇到了同样的问题。以前工作的 WCF 服务开始出现此错误。

为了解决这个问题，我进入了我的项目的构建属性（项目/属性/构建选项卡）并将平台目标更改为“x86”。然后问题就消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-03T19:32:25.377

这不是一个答案，只是说我的商店在 Windows Vista (x64) 和 Windows Server 2008 (x64) 上看到了同样的事情。当应用程序池配置为在 64 位模式下运行时，来自 ASP 的第一个 COM 调用会产生类似的堆栈跟踪。

对我们来说真正奇怪的部分是它在第二次和以后的电话中消失了。所以它只在应用程序池回收后发生一次，然后似乎工作正常。

我们也无法解决这个问题。

# sql-server - 您对 SQL Server 对象的命名约定是什么？

> ID：583941
> 
> 赞同：3
> 
> 时间：2009-02-24T22:38:43.020
> 
> 标签：sql-server, tsql

对于 sql server 对象，似乎有很多非常多样化的命名约定建议。我想知道除了不使用 sp_ 为存储过程添加前缀之外，是否还有一些正式的准则？

* * *

正如马特所指出的，已经有一个类似的问题：[Database, Table and Column Naming Conventions?](https://stackoverflow.com/questions/7662/database-table-and-column-naming-conventions) ，所以请投票关闭这个（我不明白为什么我不能关闭我自己的问题？！​​？）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T23:00:38.083

我使用 usp 作为存储过程，使用 udf 作为函数，使用 vw 作为视图，使用 trig 作为触发器。我不使用任何桌子。

这不是必需的，有些人不推荐它，但是如果我正在查询 sysobjects 或类似内容，我可以保持对相同对象的分组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T22:43:21.713

我通常只使用我正在处理的所有项目（即empID）的表的前三个字母使用前缀。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T23:08:38.250

虽然这可能不是必需的，但我在一些对象类型前面加上了前缀：

```
tr_  for triggers
fn_  for user defined functions 
```

以上内容并不多，前缀使它们更容易在源代码中找到。

对于表和存储过程以及大多数视图，我使用一个前缀来指示对象的业务区域。例如在我当前的项目中

```
dal_  for CRUD select, insert, delete
ac_  accounting functions
rep_ for reports
se_   security 
```

...

等等。使查找存储过程或了解表的用途变得更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T01:22:58.413

好吧，我曾经使用过 tblTableName、vwViewName、spStoredProcedure fldFieldName。现在在使用数据库一段时间后，我发现 tbl、vw 和 fld 不需要输入额外的字符。

我确实坚持使用 spStoredProcedure，但不知道为什么，但输入 spSomething 很容易。

对于表格，我现在用描述性的名称来命名它们，并且对于字段也是如此。我通常对第一个单词使用小写，然后在第二个单词的第一个字母上使用大写。

即：employeeRecords、spGetEmployees 等。

# c# - C# 相当于 Java 中的通配符导入

> ID：583944
> 
> 赞同：2
> 
> 时间：2009-02-24T22:39:59.240
> 
> 标签：c#, namespaces

在 C# 中有没有办法像在 Java 中那样使用通配符导入命名空间中的所有内容？

```
import java.awt.*; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-24T22:43:07.703

这就是正常的 using 指令所做的。例如：

```
using System; 
```

意味着您可以在没有资格的情况下使用 Console、Guid、Int32 等。*与 Java 中的单一*导入最接近的是：

```
using Console = System.Console; 
```

（ETC）

但这并不经常使用。

# java - MulticastSocket 失败后没有响应

> ID：583950
> 
> 赞同：3
> 
> 时间：2009-02-24T22:40:39.927
> 
> 标签：java, windows, multicastsocket

尝试在 MulticastSocket 上调用 joinGroup(addr) 时出现 SocketException。这只发生在我们设置为在机器启动时自动启动我们的应用程序的 Windows 机器上。

似乎抛出异常是因为 Windows 尚未完全完成其启动过程，这里是异常。

```
java.net.SocketException: error setting options

    at java.net.PlainDatagramSocketImpl.join(Native Method)

    at java.net.PlainDatagramSocketImpl.join(Unknown Source)

    at java.net.MulticastSocket.joinGroup(Unknown Source) 
```

在我们的应用程序启动时，如果我们在尝试加入群组之前等待一分钟，一切正常。

所以我们决定放入一个重试循环，以便它在网络可用时立即连接，这似乎工作。两次失败后，第三次尝试加入该组成功。

问题是，现在 MulticastSocket 没有收到来自组的任何消息，即使它加入得很好。

每次失败后我都会创建一个新的 MulticastSocket 并丢弃旧的。

为什么在一个 MulticastSocket 上加入组失败会影响没有任何错误加入的组，我怎么可能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T21:50:02.993

我从来没有发现为什么套接字在成功加入组后不会收到消息。然而，我确实想出了一个解决方法。

我遍历所有网络接口并确保列表中有一个有效的接口并且它已启动并正在运行。我要做的下一件事是尝试在 MulticastSocket 上设置该网络接口。如果这些测试通过，那么我让套接字尝试加入组。它似乎有效，但我仍然想了解更多关于幕后发生的事情。

```
private void validateNetworkInterfaces() throws IOException {

    Enumeration nis = NetworkInterface.getNetworkInterfaces();
    List<NetworkInterface> nics = new ArrayList<NetworkInterface>();
    while (nis.hasMoreElements()) {
        NetworkInterface ni = (NetworkInterface) nis.nextElement();

        logger.debug("nic name: " + ni.getDisplayName());
        logger.debug("nic isLoopback(): " + ni.isLoopback());
        logger.debug("nic isPointToPoint(): " + ni.isPointToPoint());
        logger.debug("nic isVirtual(): " + ni.isVirtual());
        logger.debug("nic isUp(): " + ni.isUp());
        logger.debug("nic supportsMulticast(): " + ni.supportsMulticast());

        if (!ni.isLoopback() && !ni.isPointToPoint() && !ni.isVirtual() && ni.isUp() && ni.supportsMulticast()) {
            logger.debug("adding nic: " + ni.getDisplayName());
            nics.add(ni);               
        }               

    }

    //check to make sure at least one network interface was found that supports multicast.
    if (nics.size() == 0) throw new SocketException("No network interfaces were found that support multicast.");

    //make sure the network interface can be set on a multicast socket
    for (NetworkInterface nic : nics) {
        logger.debug("attempting to set network interface on nic: " + nic.getDisplayName());
        MulticastSocket ms1 = new MulticastSocket(45599);
        ms1.setNetworkInterface(nic);
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-19T14:01:39.227

我知道这是旧的，但可靠的多播答案似乎很少见。

我认为你会更好：

```
final InetAddress localHost = InetAddress.getLocalHost();
final NetworkInterface networkInterface = NetworkInterface.getByInetAddress(localHost); 
```

因为这更简洁，并且还可以确保获得一个将实际接收多播消息的 NIC。

# sql - 如何从子查询（在 SQL Server 中）中选择多个列，主查询中的每条记录都应该有一条记录（选择前 1 条）？

> ID：583954
> 
> 赞同：135
> 
> 时间：2009-02-24T22:42:12.497
> 
> 标签：sql

我知道我可以使用以下语法从子查询中选择一列：

```
SELECT A.SalesOrderID, A.OrderDate,
       (
       SELECT TOP 1 B.Foo
       FROM B
       WHERE A.SalesOrderID = B.SalesOrderID
       ) AS FooFromB
FROM A
WHERE A.Date BETWEEN '2000-1-4' AND '2010-1-4' 
```

但是使用子查询中的多个列的正确语法是什么（在我的例子中是选择前 1 个子查询）？非常感谢。

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2009-02-25T01:49:50.097

以下是从子查询中选择多列的一般方法：

```
SELECT
     A.SalesOrderID,
     A.OrderDate,
     SQ.Max_Foo,
     SQ.Max_Foo2
FROM
     A
LEFT OUTER JOIN
     (
     SELECT
          B.SalesOrderID,
          MAX(B.Foo) AS Max_Foo,
          MAX(B.Foo2) AS Max_Foo2
     FROM
          B
     GROUP BY
          B.SalesOrderID
     ) AS SQ ON SQ.SalesOrderID = A.SalesOrderID 
```

如果您最终想要做的是从 Foo 值最高的行中获取值（而不是 Foo 的最大值和 Foo2 的最大值 - 这不是同一件事），那么以下通常会比子查询：

```
SELECT
     A.SalesOrderID,
     A.OrderDate,
     B1.Foo,
     B1.Foo2
FROM
     A
LEFT OUTER JOIN B AS B1 ON
     B1.SalesOrderID = A.SalesOrderID
LEFT OUTER JOIN B AS B2 ON
     B2.SalesOrderID = A.SalesOrderID AND
     B2.Foo > B1.Foo
WHERE
     B2.SalesOrderID IS NULL 
```

您基本上是在说，给我 B 中的行，在那里我找不到 B 中具有相同 SalesOrderID 和更大 Foo 的任何其他行。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2016-04-21T09:40:41.717

```
SELECT a.salesorderid, a.orderdate, s.orderdate, s.salesorderid
FROM A a
OUTER APPLY (SELECT top(1) *
             FROM B b WHERE a.salesorderid = b.salesorderid) as s
WHERE A.Date BETWEEN '2000-1-4' AND '2010-1-4' 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-25T00:18:36.180

您必须加入：

```
SELECT A.SalesOrderID, B.Foo
FROM A
JOIN B bo ON bo.id = (
     SELECT TOP 1 id
     FROM B bi
     WHERE bi.SalesOrderID = a.SalesOrderID
     ORDER BY bi.whatever
     )
WHERE A.Date BETWEEN '2000-1-4' AND '2010-1-4' 
```

, 假设这是`b.id`一个`PRIMARY KEY``B`

在`MS SQL 2005`及更高版本中，您可以使用以下语法：

```
SELECT SalesOrderID, Foo
FROM (
  SELECT A.SalesOrderId, B.Foo,
         ROW_NUMBER() OVER (PARTITION BY B.SalesOrderId ORDER BY B.whatever) AS rn
  FROM A
  JOIN B ON B.SalesOrderID = A.SalesOrderID
  WHERE A.Date BETWEEN '2000-1-4' AND '2010-1-4'
) i
WHERE rn 
```

这将为`B`每个`SalesOrderId`.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-24T22:47:31.860

```
select t1.*, sq.*
from table1 t1,
   (select a,b,c from table2 ...) sq
where ... 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-07-08T10:28:28.007

我认为这就是你想要的。

```
SELECT 
      A.SalesOrderID, 
      A.OrderDate, 
      FooFromB.*

FROM A,
     (SELECT TOP 1 B.Foo
      FROM B
      WHERE A.SalesOrderID = B.SalesOrderID
      ) AS FooFromB

WHERE A.Date BETWEEN '2000-1-4' AND '2010-1-4' 
```

# c++ - 从远程计算机连接到 mssql 服务器导致用户“登录失败”

> ID：583955
> 
> 赞同：5
> 
> 时间：2009-02-24T22:42:14.570
> 
> 标签：c++, sql, sql-server

当我尝试使用此连接字符串连接到远程 SQL 服务器时出现此错误。

错误：

> ODBC 错误：28000118452[Microsoft][ODBC SQL Server Driver][SQL Server]用户“”登录失败。用户未与受信任的 SQL Server 连接关联。

连接字符串：

> “DRIVER={SQL Server};SERVER=testserver,1433;Trusted_Connection={Yes};”

请注意，如果我指定本地计算机，则相同的连接字符串可以正常工作。

**我的问题：为什么远程 SQL 服务器认为我的用户名是空白 ''？**

我首先使用 WNetAddConnection Win32 API 对远程机器进行了有效登录。

编辑：从 Management Studio 连接时出现同样的错误。但是我认为我的程序将有更高的工作机会，因为我首先建立了与远程机器的连接。

Edit2：注意我真的需要一个使用 Windows 身份验证的解决方案。我已经让它与 SQL 身份验证一起使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T23:01:06.757

想法：

1.) 两台机器都在同一个域中吗？我之所以这么想，可能是因为您提到与 WNet* 建立联系...

如果没有，Integrated Security 会给您带来麻烦。

**编辑：我看到两台机器不在同一个域中。要使用集成安全性，SQL Server 所在的域必须信任您的本地计算机所在的域。**

**另一个编辑：[证实上述陈述。](http://blogs.msdn.com/sql_protocols/archive/2008/05/03/understanding-the-error-message-login-failed-for-user-the-user-is-not-associated-with-a-trusted-sql-server-connection.aspx)**

来自链接：如果登录的用户是来自与 SQL Server 域不同的不受信任域的域帐户，则可能会出现此错误消息。下一步是将客户端计算机移动到与 SQL Server 相同的域并将其设置为使用域帐户，或者在域之间建立相互信任。建立互信是一个复杂的过程，应该非常小心并考虑到安全问题。

2.) 检查以确保在服务器上正确设置了 SPN。

[在这里](http://technet.microsoft.com/en-us/library/cc773257.aspx)查看更多指导，但基本上你会这样做：

setspn -L 服务器名

其中一个 SPN 需要如下所示：

MSSQLSvc/服务器名称：1433

3.) **One more Edit:** If neither machine is in a domain, all you need to do is have a local userid/password that matches on both machines.

For example, a user named brian on both machines, and both users passwords are 'letmein'.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T22:53:17.837

您可能需要通过在连接字符串中提供用户名和密码来进行 SQL 身份验证。

编辑。我很想知道，我刚刚找到了一个很好的文档[如何：使用 Windows 集成安全访问 SQL Server](http://msdn.microsoft.com/en-us/library/bsz5788z.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-24T22:54:30.250

我认为该错误可能是因为未填写 UserId 部分（这对于 Windows Auth 是正确的）。

尝试连接字符串，如：

> 服务器=myServerAddress;数据库=myDataBase;Trusted_Connection=True;

另一种应该是相同的替代方案：

> 数据源=myServerAddress；初始目录=myDataBase；集成安全=SSPI；

# compact-framework - 紧凑型框架电话键盘输入

> ID：583968
> 
> 赞同：2
> 
> 时间：2009-02-24T22:45:57.027
> 
> 标签：compact-framework, alphanumeric

我正在为具有类似于电话的键盘的设备开发应用程序，其中 2 键也用于 ABC，3 键也用于 DEF 等。预期的行为类似于手机 - 如果用户按下重复 2 键，它将在 2、A、B、C 之间循环。是否有一些标准的方法来做到这一点或在.NET（紧凑框架）中实现它的模式？我相信我不是第一个有这个要求的人。

编辑：仍然没有找到标准解决方案......我的一个想法是有一个 KeypadMgr 类来捕获 keydown 事件，启动一个计时器并用 A/B/C 替换 2 字符，如果在一定数量的时间内再次按下它时间......还有其他建议吗？

# c++ - 在 Mac 上使用 FFMPEG 而不是 Quicktime 编译 OpenCV

> ID：583969
> 
> 赞同：2
> 
> 时间：2009-02-24T22:46:52.500
> 
> 标签：c++, macos, opencv, ffmpeg, g++

我正在开发一些将在带有 OpenCV 和 FFMPEG 的 Linux 上运行的代码。我想使用我的 Mac 开发此代码，并且我需要 Mac 上的 FFMPEG 功能。

我已经能够像这样运行配置：

```
./configure --without-quicktime --with-ffmpeg --without-python --disable-apps CPPFLAGS=-I/opt/local/include LDFLAGS="-L/opt/local/lib -L/usr/local/share -L/usr/local/lib" 
```

但是当我运行 make 我得到这个错误：

```
提取 /Users/adamb/opencv/trunk/opencv/src/./.libs/lib_cxcore.a
(cd .libs/libcxcore.lax/lib_cxcore.a && ar x /Users/adamb/opencv/trunk/opencv/src/./.libs/lib_cxcore.a)
g++ -dynamiclib -single_module -o .libs/libcxcore.2.dylib .libs/dummy.o .libs/libcxcore.lax/lib_cxcore.a/cxalloc.o .libs/libcxcore.lax/lib_cxcore.a/cxarithm.o 。 libs/libcxcore.lax/lib_cxcore.a/cxarray.o .libs/libcxcore.lax/lib_cxcore.a/cxcmp.o .libs/libcxcore.lax/lib_cxcore.a/cxconvert.o .libs/libcxcore.lax/lib_cxcore。 a/cxcopy.o .libs/libcxcore.lax/lib_cxcore.a/cxdatastructs.o .libs/libcxcore.lax/lib_cxcore.a/cxdrawing.o .libs/libcxcore.lax/lib_cxcore.a/cxdxt.o .libs/ libcxcore.lax/lib_cxcore.a/cxerror.o .libs/libcxcore.lax/lib_cxcore.a/cximage.o .libs/libcxcore.lax/lib_cxcore.a/cxlapack.o .libs/libcxcore.lax/lib_cxcore.a/ cxlogic.o.libs/libcxcore.lax/lib_cxcore.a/cxlut.o.libs/libcxcore.lax/lib_cxcore.a/cxmathfuncs.o.libs/libcxcore.lax/lib_cxcore.a/cxmatmul.o.libs/libcxcore。松懈/lib_cxcore.a/cxmatrix.o.libs/libcxcore.lax/lib_cxcore.a/cxmean。o .libs/libcxcore.lax/lib_cxcore.a/cxmeansdv.o .libs/libcxcore.lax/lib_cxcore.a/cxminmaxloc.o .libs/libcxcore.lax/lib_cxcore.a/cxnorm.o .libs/libcxcore.lax/ lib_cxcore.a/cxouttext.o .libs/libcxcore.lax/lib_cxcore.a/cxpersistence.o .libs/libcxcore.lax/lib_cxcore.a/cxrand.o .libs/libcxcore.lax/lib_cxcore.a/cxsumpixels.o。 libs/libcxcore.lax/lib_cxcore.a/cxsvd.o .libs/libcxcore.lax/lib_cxcore.a/cxswitcher.o .libs/libcxcore.lax/lib_cxcore.a/cxtables.o .libs/libcxcore.lax/lib_cxcore。 a/cxutils.o -L/opt/local/lib -L/usr/local/share -L/usr/local/lib -lavformat -lavcodec -lpthread -ldl -lm -march=prescott -msse -install_name /usr/ local/lib/libcxcore.2.dylib -Wl,-compatibility_version -Wl,3 -Wl,-current_version -Wl,3.0libs/libcxcore.lax/lib_cxcore.a/cxouttext.o .libs/libcxcore.lax/lib_cxcore.a/cxpersistence.o .libs/libcxcore.lax/lib_cxcore.a/cxrand.o .libs/libcxcore.lax/lib_cxcore。 a/cxsumpixels.o .libs/libcxcore.lax/lib_cxcore.a/cxsvd.o .libs/libcxcore.lax/lib_cxcore.a/cxswitcher.o .libs/libcxcore.lax/lib_cxcore.a/cxtables.o .libs/ libcxcore.lax/lib_cxcore.a/cxutils.o -L/opt/local/lib -L/usr/local/share -L/usr/local/lib -lavformat -lavcodec -lpthread -ldl -lm -march=prescott - msse -install_name /usr/local/lib/libcxcore.2.dylib -Wl,-compatibility_version -Wl,3 -Wl,-current_version -Wl,3.0libs/libcxcore.lax/lib_cxcore.a/cxouttext.o .libs/libcxcore.lax/lib_cxcore.a/cxpersistence.o .libs/libcxcore.lax/lib_cxcore.a/cxrand.o .libs/libcxcore.lax/lib_cxcore。 a/cxsumpixels.o .libs/libcxcore.lax/lib_cxcore.a/cxsvd.o .libs/libcxcore.lax/lib_cxcore.a/cxswitcher.o .libs/libcxcore.lax/lib_cxcore.a/cxtables.o .libs/ libcxcore.lax/lib_cxcore.a/cxutils.o -L/opt/local/lib -L/usr/local/share -L/usr/local/lib -lavformat -lavcodec -lpthread -ldl -lm -march=prescott - msse -install_name /usr/local/lib/libcxcore.2.dylib -Wl,-compatibility_version -Wl,3 -Wl,-current_version -Wl,3.0libs/libcxcore.lax/lib_cxcore.a/cxtables.o .libs/libcxcore.lax/lib_cxcore.a/cxutils.o -L/opt/local/lib -L/usr/local/share -L/usr/local/ lib -lavformat -lavcodec -lpthread -ldl -lm -march=prescott -msse -install_name /usr/local/lib/libcxcore.2.dylib -Wl,-compatibility_version -Wl,3 -Wl,-current_version -Wl,3.0libs/libcxcore.lax/lib_cxcore.a/cxtables.o .libs/libcxcore.lax/lib_cxcore.a/cxutils.o -L/opt/local/lib -L/usr/local/share -L/usr/local/ lib -lavformat -lavcodec -lpthread -ldl -lm -march=prescott -msse -install_name /usr/local/lib/libcxcore.2.dylib -Wl,-compatibility_version -Wl,3 -Wl,-current_version -Wl,3.0
    未定义的符号：
      “_dgesdd_”，引用自：
      cxsvd.o 中的 _cvSVD
      cxsvd.o 中的 _cvSVD
  “_sgelsd_”，引用自：
      cxlapack.o 中的 _cvSolve
      cxlapack.o 中的 _cvSolve
  “_ssyevr_”，引用自：
      cxlapack.o 中的 _cvEigenVV
      cxlapack.o 中的 _cvEigenVV
  “_dgetrf_”，引用自：
      cxlapack.o 中的 _cvDet
      cxlapack.o 中的 _cvInvert
  “_dgetri_”，引用自：
      cxlapack.o 中的 _cvInvert
      cxlapack.o 中的 _cvInvert
  “_sgesdd_”，引用自：
      cxsvd.o 中的 _cvSVD
      cxsvd.o 中的 _cvSVD
  “_dgels_”，引用自：
      cxlapack.o 中的 _cvSolve
      cxlapack.o 中的 _cvSolve
  “_dgesv_”，引用自：
      cxlapack.o 中的 _cvSolve
  “_sgetrf_”，引用自：
      cxlapack.o 中的 _cvDet
      cxlapack.o 中的 _cvInvert
  “_sgetri_”，引用自：
      cxlapack.o 中的 _cvInvert
      cxlapack.o 中的 _cvInvert
  “_dpotrf_”，引用自：
      cxlapack.o 中的 _cvInvert
      cxlapack.o 中的 _cvSolve
  “_dpotri_”，引用自：
      cxlapack.o 中的 _cvInvert
  “_dpotrs_”，引用自：
      cxlapack.o 中的 _cvSolve
  “_sgels_”，引用自：
      cxlapack.o 中的 _cvSolve
      cxlapack.o 中的 _cvSolve
  “_spotrf_”，引用自：
      cxlapack.o 中的 _cvInvert
      cxlapack.o 中的 _cvSolve
  “_spotri_”，引用自：
      cxlapack.o 中的 _cvInvert
  “_sgesv_”，引用自：
      cxlapack.o 中的 _cvSolve
  “_spotrs_”，引用自：
      cxlapack.o 中的 _cvSolve
  “_dgelsd_”，引用自：
      cxlapack.o 中的 _cvSolve
      cxlapack.o 中的 _cvSolve
  “_dsyevr_”，引用自：
      cxlapack.o 中的 _cvEigenVV
      cxlapack.o 中的 _cvEigenVV
ld：未找到符号
collect2: ld 返回 1 个退出状态
make[2]: *** [libcxcore.la] 错误 1
make[1]: *** [all-recursive] 错误 1
make: *** [全部] 错误 2

```

我尝试使用较新版本的 OpenCV 1.1pre1，但我得到了类似的错误，但符号不同。我使用与上面相同的 ./configure 。

```
提取 /Users/adamb/Downloads/opencv-1.1.0/otherlibs/highgui/./.libs/lib_highgui.a
(cd .libs/libhighgui.lax/lib_highgui.a && ar x /Users/adamb/Downloads/opencv-1.1.0/otherlibs/highgui/./.libs/lib_highgui.a)
g++ -dynamiclib -o .libs/libhighgui.2.0.0.dylib .libs/dummy.o .libs/libhighgui.lax/lib_highgui.a/bitstrm.o .libs/libhighgui.lax/lib_highgui.a/cvcap.o 。 libs/libhighgui.lax/lib_highgui.a/cvcap_ffmpeg.o .libs/libhighgui.lax/lib_highgui.a/cvcap_images.o .libs/libhighgui.lax/lib_highgui.a/grfmt_base.o .libs/libhighgui.lax/lib_highgui。 a/grfmt_bmp.o .libs/libhighgui.lax/lib_highgui.a/grfmt_exr.o .libs/libhighgui.lax/lib_highgui.a/grfmt_imageio.o .libs/libhighgui.lax/lib_highgui.a/grfmt_jpeg.o .libs/ libhighgui.lax/lib_highgui.a/grfmt_jpeg2000.o .libs/libhighgui.lax/lib_highgui.a/grfmt_png.o .libs/libhighgui.lax/lib_highgui.a/grfmt_pxm.o .libs/libhighgui.lax/lib_highgui.a/ grfmt_sunras.o .libs/libhighgui.lax/lib_highgui.a/grfmt_tiff.o .libs/libhighgui.lax/lib_highgui.a/image.o .libs/libhighgui.lax/lib_highgui.a/loadsave.o .libs/libhighgui。lax/lib_highgui.a/precomp.o .libs/libhighgui.lax/lib_highgui.a/utils.o .libs/libhighgui.lax/lib_highgui.a/window.o .libs/libhighgui.lax/lib_highgui.a/window_carbon。 o -L/opt/local/lib -L/usr/local/share -L/usr/local/lib ../../cxcore/src/.libs/libcxcore.dylib /opt/local/lib/libavformat。 dylib /opt/local/lib/libavcodec.dylib ../../cv/src/.libs/libcv.dylib /Users/adamb/Downloads/opencv-1.1.0/cxcore/src/.libs/libcxcore.dylib /opt/local/lib/libjasper.dylib /opt/local/lib/libjpeg.dylib -lavformat -lavcodec -lpthread -ldl -lm -march=prescott -msse2 -framework ApplicationServices -Wl,-framework -Wl,Carbon -install_name /usr/local/lib/libhighgui.2.dylib -compatibility_version 3 -current_version 3.0 -Wl,-single_modulea/window_carbon.o -L/opt/local/lib -L/usr/local/share -L/usr/local/lib ../../cxcore/src/.libs/libcxcore.dylib /opt/local/ lib/libavformat.dylib /opt/local/lib/libavcodec.dylib ../../cv/src/.libs/libcv.dylib /Users/adamb/Downloads/opencv-1.1.0/cxcore/src/.libs /libcxcore.dylib /opt/local/lib/libjasper.dylib /opt/local/lib/libjpeg.dylib -lavformat -lavcodec -lpthread -ldl -lm -march=prescott -msse2 -framework ApplicationServices -Wl,-framework -Wl ,Carbon -install_name /usr/local/lib/libhighgui.2.dylib -compatibility_version 3 -current_version 3.0 -Wl,-single_modulea/window_carbon.o -L/opt/local/lib -L/usr/local/share -L/usr/local/lib ../../cxcore/src/.libs/libcxcore.dylib /opt/local/ lib/libavformat.dylib /opt/local/lib/libavcodec.dylib ../../cv/src/.libs/libcv.dylib /Users/adamb/Downloads/opencv-1.1.0/cxcore/src/.libs /libcxcore.dylib /opt/local/lib/libjasper.dylib /opt/local/lib/libjpeg.dylib -lavformat -lavcodec -lpthread -ldl -lm -march=prescott -msse2 -framework ApplicationServices -Wl,-framework -Wl ,Carbon -install_name /usr/local/lib/libhighgui.2.dylib -compatibility_version 3 -current_version 3.0 -Wl,-single_moduledylib /opt/local/lib/libjasper.dylib /opt/local/lib/libjpeg.dylib -lavformat -lavcodec -lpthread -ldl -lm -march=prescott -msse2 -framework ApplicationServices -Wl,-framework -Wl,Carbon - install_name /usr/local/lib/libhighgui.2.dylib -compatibility_version 3 -current_version 3.0 -Wl,-single_moduledylib /opt/local/lib/libjasper.dylib /opt/local/lib/libjpeg.dylib -lavformat -lavcodec -lpthread -ldl -lm -march=prescott -msse2 -framework ApplicationServices -Wl,-framework -Wl,Carbon - install_name /usr/local/lib/libhighgui.2.dylib -compatibility_version 3 -current_version 3.0 -Wl,-single_module
未定义的符号：
  “_av_rescale_q”，引用自：
      cvcap_ffmpeg.o 中的 icv_av_write_frame_FFMPEG(AVFormatContext*, AVStream*, unsigned char*, unsigned int, AVFrame*)
  “_img_convert”，引用自：
      cvcap_ffmpeg.o 中的 CvCapture_FFMPEG::retrieveFrame()
      cvcap_ffmpeg.o 中的 CvVideoWriter_FFMPEG::writeFrame(_IplImage const*)
  “_av_free”，引用自：
      cvcap_ffmpeg.o 中的 icv_alloc_picture_FFMPEG(int, int, int, bool)
      cvcap_ffmpeg.o 中的 CvVideoWriter_FFMPEG::close()
      cvcap_ffmpeg.o 中的 CvVideoWriter_FFMPEG::close()
      cvcap_ffmpeg.o 中的 CvVideoWriter_FFMPEG::close()
      cvcap_ffmpeg.o 中的 CvVideoWriter_FFMPEG::close()
      cvcap_ffmpeg.o 中的 CvCapture_FFMPEG::close()
  “_av_freep”，引用自：
      cvcap_ffmpeg.o 中的 CvVideoWriter_FFMPEG::close()
      cvcap_ffmpeg.o 中的 CvVideoWriter_FFMPEG::close()
  “_av_malloc”，引用自：
      cvcap_ffmpeg.o 中的 CvVideoWriter_FFMPEG::open(char const*, int, double, CvSize, bool)
  “_av_sub_q”，引用自：
      cvcap_ffmpeg.o 中的 CvVideoWriter_FFMPEG::open(char const*, int, double, CvSize, bool)
ld：未找到符号

```

如果我添加 --enable-shared=no 并且 OpenCV 将编译，但我的程序将无法运行......

关于如何使用默认的 --enable-shared 编译其中任何一个的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T06:09:02.670

您的链接行缺少 -lavutil -lavcodec。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-24T19:02:58.323

[我使用自制软件](http://abhinay.wordpress.com/2010/01/02/macports-to-homebrew-new-packaging-system-for-mac-os-x/)安装了 OpenCV 和 FFmpeg ，并且都可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T18:35:07.207

我对此没有太多经验，但是您的系统上是否安装了 ffmpeg 库？我不相信它们包含在 OpenCV 中。

# c# - 需要循环从字节数组复制块

> ID：583970
> 
> 赞同：10
> 
> 时间：2009-02-24T22:47:07.367
> 
> 标签：c#, bytearray

我必须处理一个传递给我的函数的大字节数组。我需要将这个传入字节数组中的内容以较小的“块”复制到出站字节数组中。

对于在出站数组中创建的每个“块”数据，我需要调用一个 Web 服务。

返回后，我需要继续循环遍历传入的字节数组，继续传递全部或部分数据块，直到处理完完整的传入数组（即以块的形式发送到 Web 服务）。

我对 C# 很陌生，我正在努力解决一个有效的循环。我知道如何调用 Web 服务来处理“块”，但我无法正确循环。这是我目前拥有的可悲混乱的草图：

```
int chunkSize = 10000;
byte[] outboundBuffer = new byte[chunkSize];     
while (BytesRead > 0)
{
long i = 0;
foreach (byte x in incomingArray)
{
    BytesRead += 1;
    outboundBuffer[i] = incomingArray[i]
    i++;
}
uploadObject.Size = BytesRead;
uploadObject.MTOMPayload = outboundBuffer;

// call web service here and pass the uploadObject 

// get next "chunk" until incomingArray is fully processed 
 } 
```

我知道这是一团糟，而且行不通；有人可以绘制一个适当的循环来完成这项工作吗？非常感谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-24T22:51:36.873

您可能想查看[Array.Copy](http://msdn.microsoft.com/en-us/library/system.array.copy.aspx)或[Buffer.BlockCopy](http://msdn.microsoft.com/en-us/library/system.buffer.blockcopy.aspx)；这会清理一些东西，因为您不必单独复制所有字节：

```
int incomingOffset = 0;

while(incomingOffset < incomingArray.Length)
{
   int length = 
      Math.Min(outboundBuffer.Length, incomingArray.Length - incomingOffset);

   // Changed from Array.Copy as per Marc's suggestion
   Buffer.BlockCopy(incomingArray, incomingOffset, 
                    outboundBuffer, 0, 
                    length);

   incomingOffset += length;

   // Transmit outbound buffer
 } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T22:58:22.287

您可能想要`Buffer.BlockCopy`（最原始的副本；非常适合`byte[]`）。

当然，另一种选择是使用 a`MemoryStream`代替出站数组，`Write`每次只使用它，然后调用`ToArray()`or `GetBuffer()`（`MemoryStream`使用`GetBuffer()`，您需要注意长度；`ToArray()`它会自动为您修剪）：

```
MemoryStream ms = new MemoryStream();
byte[] buffer = new byte[BUFFER_SIZE];
int bytesReceived;
while((bytesReceived = GetNextChunk(buffer, 0, BUFFER_SIZE)) > 0) {
    ms.Write(incomingArray, 0, bytesReceived);
}
byte[] final = ms.ToArray(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T23:13:05.760

为什么不直接使用 Array.Copy？ [http://msdn.microsoft.com/en-us/library/system.array.copy.aspx](http://msdn.microsoft.com/en-us/library/system.array.copy.aspx)

例如。

```
Array.Copy(srcBuffer, destBuffer, 1024); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T22:58:47.730

小心在循环中同步调用 Web 服务。由于 HTTP 的性质，同步 Web 服务调用需要无限时间，并且您的循环可能会运行很长时间。最好使用异步方法。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-02-24T22:55:51.200

你似乎已经逻辑地分解了你的任务，毕竟你已经用文字连贯地描述了它。现在只需让您的代码执行此操作。

伪代码可能类似于：

```
while (there are chunks in incoming array)
    copy 1 chunk to outbound array
    create uploadObject
    call webservice
endwhile 
```

# java - JAX-RS/Jersey 如何自定义错误处理？

> ID：583973
> 
> 赞同：222
> 
> 时间：2009-02-24T22:48:41.810
> 
> 标签：java, rest, error-handling, jersey, jax-rs

我正在使用 Jersey 学习 JAX-RS（又名 JSR-311）。我已经成功创建了一个根资源并正在使用参数：

```
@Path("/hello")
public class HelloWorldResource {

    @GET
    @Produces("text/html")
    public String get(
        @QueryParam("name") String name,
        @QueryParam("birthDate") Date birthDate) {

         // Return a greeting with the name and age
    }
} 
```

这很好用，并且可以处理 Date(String) 构造函数理解的当前语言环境中的任何格式（如 YYYY/mm/dd 和 mm/dd/YYYY）。但是，如果我提供的值无效或无法理解，我会收到 404 响应。

例如：

```
GET /hello?name=Mark&birthDate=X

404 Not Found 
```

如何自定义此行为？也许是不同的响应代码（可能是“400 Bad Request”）？记录错误怎么办？也许在自定义标题中添加问题描述（“错误的日期格式”）以帮助故障排除？还是返回带有详细信息的完整错误响应以及 5xx 状态代码？

* * *

## 回答 #1

> 赞同：277
> 
> 时间：2009-03-01T02:40:38.847

有几种方法可以使用 JAX-RS 自定义错误处理行为。以下是三种更简单的方法。

第一种方法是创建一个扩展 WebApplicationException 的 Exception 类。

例子：

```
public class NotAuthorizedException extends WebApplicationException {
     public NotAuthorizedException(String message) {
         super(Response.status(Response.Status.UNAUTHORIZED)
             .entity(message).type(MediaType.TEXT_PLAIN).build());
     }
} 
```

要抛出这个新创建的异常，您只需：

```
@Path("accounts/{accountId}/")
    public Item getItem(@PathParam("accountId") String accountId) {
       // An unauthorized user tries to enter
       throw new NotAuthorizedException("You Don't Have Permission");
} 
```

请注意，您不需要在 throws 子句中声明异常，因为 WebApplicationException 是运行时异常。这将向客户端返回 401 响应。

第二种更简单的方法是 `WebApplicationException`直接在代码中简单地构造一个实例。只要您不必实现自己的应用程序异常，这种方法就可以工作。

例子：

```
@Path("accounts/{accountId}/")
public Item getItem(@PathParam("accountId") String accountId) {
   // An unauthorized user tries to enter
   throw new WebApplicationException(Response.Status.UNAUTHORIZED);
} 
```

此代码也向客户端返回 401。

当然，这只是一个简单的例子。如有必要，您可以使异常更加复杂，并且您可以生成所需的任何 http 响应代码。

另一种方法是包装现有的异常，可能是`ObjectNotFoundException`一个小的包装类，该类实现`ExceptionMapper`带有`@Provider`注释的接口。这告诉 JAX-RS 运行时，如果引发了包装的异常，则返回在`ExceptionMapper`.

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2011-05-11T07:24:06.850

```
@Provider
public class BadURIExceptionMapper implements ExceptionMapper<NotFoundException> {

public Response toResponse(NotFoundException exception){

    return Response.status(Response.Status.NOT_FOUND).
    entity(new ErrorResponse(exception.getClass().toString(),
                exception.getMessage()) ).
    build();
}
} 
```

创建上面的类。这将处理 404 (NotFoundException)，在 toResponse 方法中，您可以提供自定义响应。同样，您需要映射 ParamException 等以提供自定义响应。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2011-11-28T12:25:57.563

当 Jersey 无法解组参数时，它会抛出 com.sun.jersey.api.ParamException，因此一种解决方案是创建一个 ExceptionMapper 来处理这些类型的异常：

```
@Provider
public class ParamExceptionMapper implements ExceptionMapper<ParamException> {
    @Override
    public Response toResponse(ParamException exception) {
        return Response.status(Status.BAD_REQUEST).entity(exception.getParameterName() + " incorrect type").build();
    }
} 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-08-26T05:26:58.777

您还可以为带有 QueryParam 注释的变量编写一个可重用的类

```
public class DateParam {
  private SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");

  private Calendar date;

  public DateParam(String in) throws WebApplicationException {
    try {
      date = Calendar.getInstance();
      date.setTime(format.parse(in));
    }
    catch (ParseException exception) {
      throw new WebApplicationException(400);
    }
  }
  public Calendar getDate() {
    return date;
  }
  public String format() {
    return format.format(value.getTime());
  }
} 
```

然后像这样使用它：

```
private @QueryParam("from") DateParam startDateParam;
private @QueryParam("to") DateParam endDateParam;
// ...
startDateParam.getDate(); 
```

尽管在这种情况下错误处理是微不足道的（抛出 400 响应），但使用此类允许您排除一般的参数处理，其中可能包括日志记录等。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-28T01:01:49.297

一个明显的解决方案：接受一个字符串，自己转换为日期。这样您就可以定义您想要的格式、捕获异常并重新抛出或自定义正在发送的错误。对于解析， SimpleDateFormat 应该可以正常工作。

我相信也有一些方法可以为数据类型挂钩处理程序，但在这种情况下，您可能只需要一点简单的代码。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-26T17:11:00.777

我也喜欢[StaxMan](https://stackoverflow.com/questions/583973/jax-rs-jersey-how-to-customize-error-handling/597252#597252)可能会将该 QueryParam 实现为字符串，然后处理转换，并根据需要重新抛出。

如果特定于语言环境的行为是期望的和预期的行为，您将使用以下命令返回 400 BAD REQUEST 错误：

`throw new WebApplicationException(Response.Status.BAD_REQUEST);`

有关更多选项，请参阅[javax.ws.rs.core.Response.Status的 JavaDoc。](http://www.jboss.org/file-access/default/members/resteasy/freezone/docs/1.0.0.GA/javadocs/javax/ws/rs/core/Response.Status.html)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-04-29T18:36:48.583

@QueryParam 文档说

> " 带注释的参数、字段或属性的类型 T 必须：
> 
> 1) 是原始类型
> 2) 有一个接受单个 String 参数的构造函数
> 3) 有一个名为 valueOf 或 fromString 的静态方法，它接受单个 String 参数（例如，参见 Integer.valueOf(String)）
> 4) 有一个javax.ws.rs.ext.ParamConverterProvider JAX-RS 扩展 SPI 的注册实现，它返回一个 javax.ws.rs.ext.ParamConverter 实例，该实例能够对该类型进行“来自字符串”的转换。
> 5) 是 List、Set 或 SortedSet，其中 T 满足上述 2、3 或 4。生成的集合是只读的。"

如果您想控制当字符串形式的查询参数无法转换为您的类型 T 时对用户的响应，您可以抛出 WebApplicationException。Dropwizard 附带以下 *Param 类，您可以根据需要使用它们。

BooleanParam、DateTimeParam、IntParam、LongParam、LocalDateParam、NonEmptyStringParam、UUIDParam。见[https://github.com/dropwizard/dropwizard/tree/master/dropwizard-jersey/src/main/java/io/dropwizard/jersey/params](https://github.com/dropwizard/dropwizard/tree/master/dropwizard-jersey/src/main/java/io/dropwizard/jersey/params)

如果您需要 Joda DateTime，只需使用 Dropwizard [DateTimeParam](https://github.com/dropwizard/dropwizard/blob/master/dropwizard-jersey/src/main/java/io/dropwizard/jersey/params/DateTimeParam.java)。

如果上面的列表不适合您的需求，请通过扩展 AbstractParam 定义您自己的列表。覆盖解析方法。如果您需要控制错误响应正文，请覆盖错误方法。

Coda Hale 的好文章位于[http://codahale.com/what-makes-jersey-interesting-parameter-classes/](http://codahale.com/what-makes-jersey-interesting-parameter-classes/)

```
import io.dropwizard.jersey.params.AbstractParam;

import java.util.Date;

import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;

public class DateParam extends AbstractParam<Date> {

    public DateParam(String input) {
        super(input);
    }

    @Override
    protected Date parse(String input) throws Exception {
        return new Date(input);
    }

    @Override
    protected Response error(String input, Exception e) {
        // customize response body if you like here by specifying entity
        return Response.status(Status.BAD_REQUEST).build();
    }
} 
```

Date(String arg) 构造函数已弃用。如果您使用的是 Java 8，我会使用 Java 8 日期类。否则建议使用 joda 日期时间。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-10-20T20:08:27.040

这实际上是正确的行为。Jersey 将尝试为您的输入找到处理程序，并尝试从提供的输入构造一个对象。在这种情况下，它将尝试使用提供给构造函数的值 X 创建一个新的 Date 对象。由于这是一个无效的日期，按照惯例 Jersey 将返回 404。

你可以做的是重写并将出生日期作为一个字符串，然后尝试解析，如果你没有得到你想要的，你可以自由地通过任何异常映射机制抛出你想要的任何异常（有几个）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-10-08T12:06:33.490

我面临着同样的问题。

我想在一个中心位置捕获所有错误并对其进行转换。

以下是我如何处理它的代码。

创建以下类，该类实现并在此类上`ExceptionMapper`添加注释。`@Provider`这将处理所有异常。

覆盖`toResponse`方法并返回填充了自定义数据的 Response 对象。

```
//ExceptionMapperProvider.java
/**
 * exception thrown by restful endpoints will be caught and transformed here
 * so that client gets a proper error message
 */
@Provider
public class ExceptionMapperProvider implements ExceptionMapper<Throwable> {
    private final ErrorTransformer errorTransformer = new ErrorTransformer();

    public ExceptionMapperProvider() {

    }

    @Override
    public Response toResponse(Throwable throwable) {
        //transforming the error using the custom logic of ErrorTransformer 
        final ServiceError errorResponse = errorTransformer.getErrorResponse(throwable);
        final ResponseBuilder responseBuilder = Response.status(errorResponse.getStatus());

        if (errorResponse.getBody().isPresent()) {
            responseBuilder.type(MediaType.APPLICATION_JSON_TYPE);
            responseBuilder.entity(errorResponse.getBody().get());
        }

        for (Map.Entry<String, String> header : errorResponse.getHeaders().entrySet()) {
            responseBuilder.header(header.getKey(), header.getValue());
        }

        return responseBuilder.build();
    }
}

// ErrorTransformer.java
/**
 * Error transformation logic
 */
public class ErrorTransformer {
    public ServiceError getErrorResponse(Throwable throwable) {
        ServiceError serviceError = new ServiceError();
        //add you logic here
        serviceError.setStatus(getStatus(throwable));
        serviceError.setBody(getBody(throwable));
        serviceError.setHeaders(getHeaders(throwable));

    }
    private String getStatus(Throwable throwable) {
        //your logic
    }
    private Optional<String> getBody(Throwable throwable) {
        //your logic
    }
    private Map<String, String> getHeaders(Throwable throwable) {
        //your logic
    }
}

//ServiceError.java
/**
 * error data holder
 */
public class ServiceError {
    private int status;
    private Map<String, String> headers;
    private Optional<String> body;
    //setters and getters
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-01-10T10:25:31.457

**方法一：通过扩展 WebApplicationException 类**

通过扩展 WebApplicationException 创建新异常

```
public class RestException extends WebApplicationException {

         private static final long serialVersionUID = 1L;

         public RestException(String message, Status status) {
         super(Response.status(status).entity(message).type(MediaType.TEXT_PLAIN).build());
         }
} 
```

现在在需要时抛出“RestException”。

```
public static Employee getEmployee(int id) {

         Employee emp = employees.get(id);

         if (emp == null) {
                 throw new RestException("Employee with id " + id + " not exist", Status.NOT_FOUND);
         }
         return emp;
} 
```

[您可以在此链接](https://self-learning-java-tutorial.blogspot.com/2017/08/return-http-status-code-for-exceptions.html)查看完整的应用程序。

**方法二：实现 ExceptionMapper**

以下映射器处理“DataNotFoundException”类型的异常

```
@Provider
public class DataNotFoundExceptionMapper implements
        ExceptionMapper<DataNotFoundException> {

    @Override
    public Response toResponse(DataNotFoundException ex) {
        ErrorMessage model = new ErrorMessage(ex.getErrorCode(),
                ex.getMessage());
        return Response.status(Status.NOT_FOUND).entity(model).build();
    }

} 
```

[您可以在此链接](https://self-learning-java-tutorial.blogspot.com/2015/08/jersey-exception-handling.html)查看完整的应用程序。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-04-25T13:10:20.870

如果您想打开浏览器登录窗口，就像@Steven Lavine 回答的扩展一样。如果用户尚未通过身份验证，我发现很难从过滤器中正确返回响应（[MDN HTTP 身份验证）](https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication)

这帮助我构建了响应以强制浏览器登录，请注意对标头的额外修改。这会将状态代码设置为 401 并设置导致浏览器打开用户名/密码对话框的标题。

```
// The extended Exception class
public class NotLoggedInException extends WebApplicationException {
  public NotLoggedInException(String message) {
    super(Response.status(Response.Status.UNAUTHORIZED)
      .entity(message)
      .type(MediaType.TEXT_PLAIN)
      .header("WWW-Authenticate", "Basic realm=SecuredApp").build()); 
  }
}

// Usage in the Filter
if(headers.get("Authorization") == null) { throw new NotLoggedInException("Not logged in"); } 
```

# sql-server - sql server 模式是否应该用于逻辑或管理分组？

> ID：583977
> 
> 赞同：4
> 
> 时间：2009-02-24T22:49:38.360
> 
> 标签：sql-server, schema

将我的 SQL Server 对象划分为基于其逻辑分组（一种命名空间 sa sales、user、common）的架构是一个好主意，还是应该主要用于创建不同的安全边界？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T05:49:57.833

我可能只会根据用户对象与应用程序/系统对象进行区分。也就是说，订单、产品等都是用户对象。安全表是系统对象。

在某些时候，如果您授予架构权限（如建议的那样），您可能会发现权限重叠。或者你可能无法对一个对象进行分类，或者它被用于不同的领域。

如果您早在 SQL 2005 之前就一直在遵循最佳实践并进行了升级，那么您可能拥有数百个数据库，其中每个对象引用都是用“dbo”限定的架构。您是否会偏离新数据库的命名约定，并可能破坏所有依赖“dbo.”的有用脚本？

编辑：如果您决定这样做，请注意[所有权链接](http://msdn.microsoft.com/en-us/library/ms188676(SQL.90).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T22:58:01.227

我会进行逻辑分组并通过角色设置安全性。但通常逻辑组和安全组是相同的。通常 ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T23:34:12.497

您可以根据安全级别将存储过程放入架构中。然后将架构上的执行权限授予角色。不再授予。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T23:47:22.340

名为“Oslo”的新 Microsoft 项目使用模式将对象分组到命名空间中。

# c++ - 是否可以从远程计算机获取有效令牌？

> ID：583978
> 
> 赞同：1
> 
> 时间：2009-02-24T22:50:09.717
> 
> 标签：c++, impersonation, wnet

是否可以在远程计算机上模拟 au/p？

理想情况下，我想使用从登录远程计算机获得的令牌来调用[ImpersonateLoggedOnUser 。](http://msdn.microsoft.com/en-us/library/aa378612(VS.85).aspx)

我知道我可以使用 wnet 函数建立有效的连接，但只是不知道模拟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T23:25:45.840

布赖恩：

我不确定你是否可以。至少，您可能需要某种方式来指示哪个登录用户（快速用户切换和终端服务意味着可能有多个登录用户）。Raymond Chen 曾经在博客上写过一次，但没有提供解决方案（我不确定是否有一个，除非你可以假设只有一个，但鉴于 Vista 允许用户快速切换域，我'我不确定你是否可以做出这样的假设）。

对于它的价值，博客条目在这里：http: [//blogs.msdn.com/oldnewthing/archive/2006/08/22/712677.aspx](http://blogs.msdn.com/oldnewthing/archive/2006/08/22/712677.aspx)

# linq-to-sql - 如何在 LINQ 中完成组连接和多表参数

> ID：583979
> 
> 赞同：1
> 
> 时间：2009-02-24T22:50:19.200
> 
> 标签：linq-to-sql

我一定在我的 LINQ 培训中遗漏了一些东西。在使用 c# 的 Linq to SQL 中，我想查询两张表，一张带有外键，并传递两个参数，每个表一个。

在 SQL 中，它很简单，例如

```
Select Value from Table1 T1 
INNER JOIN Table2 T2
On T1.DefID = T2.ID
Where T1.PollID = 1 
AND T2.Name = 'Question' 
```

在 LINQ 中，我卡住了！

```
var q = from t1 in dc.Table1
        join t2 in dc.Table2
        on t1.DefID equals t2.ID
        into newGroup
        where t1.PollID == 1   // here's where I get stuck!
        // how do I query t2?
        select newGroup; 
```

我的方法错了吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T23:05:46.557

```
var q = from t1 in dc.Table1
    join t2 in dc.Table2
    on t1.DefID equals t2.ID
    where t1.PollID == 1 &&
    t2.Name == "Question"
    select new {
        Alias1 = t1.FieldName,
        Alias2 = t2.FieldName
    }; 
```

# python - 我如何将这个 for 循环的输出变成一个字符串，变成一个变量？

> ID：583986
> 
> 赞同：0
> 
> 时间：2009-02-24T22:52:33.330
> 
> 标签：python

在这个循环中，我试图接受用户输入并不断地将其放入列表中，直到他们写下“停止”。当循环中断时，for 循环会打印出所有的 li。

我将如何获取 for 循环的输出并将其设为字符串，以便将其加载到变量中？

```
x = ([])
while True:
    item = raw_input('Enter List Text (e.g. <li><a href="#">LIST TEXT</a></li>) (Enter "stop" to end loop):\n')
    if item == 'stop':
        print 'Loop Stopped.'
        break           
    else:
        item = make_link(item)
        x.append(item)
        print 'List Item Added\n'

    for i in range(len(x)):
        print '<li>' + x[i] + '</li>\n' 
```

我希望它以这样的方式结束：

代码：

```
print list_output 
```

输出：

```
<li>Blah</li>
<li>Blah</li>
<li>etc.</li> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T22:57:15.470

在 python 中，字符串支持一种`join`方法（概念上与 相反`split`），该方法允许您使用字符串将列表（技术上是可迭代的）的元素连接在一起。一个非常常见的用例是`', '.join(<list>)`将列表的元素复制到逗号分隔的字符串中。

在你的情况下，你可能想要这样的东西：

```
list_output = ''.join('<li>' + item + '</li>\n' for item in x) 
```

如果您希望列表的元素由换行符分隔，但*字符串末尾没有换行符*，您可以这样做：

```
list_output = '\n'.join('<li>' + item + '</li>' for item in x) 
```

如果你想变得非常疯狂，这可能是最有效的（虽然我不推荐它）：

```
list_output = '<li>' + '</li>\n<li>'.join(item for item in x) + '</li>\n' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T22:58:37.887

```
s = "\n".join(['<li>' + i + '</li>' for i in x]) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T23:12:51.673

我讨厌成为回答不同问题的人，但是手工编码的 HTML 生成让我感到不适。即使你只是在做这个超级简单的列表生成，我强烈建议你看看像[Genshi](http://genshi.edgewall.org/)这样的模板语言。

您的程序的 Genshi 版本（更长一点，但是更好）：

```
from genshi.template import MarkupTemplate

TMPL = '''<html xmlns="http://www.w3.org/1999/xhtml"
          xmlns:py="http://genshi.edgewall.org/">
          <li py:for="item in items">$item</li>
          </html>'''

make_link = lambda x: x

item, x = None, []
while True:
    item = raw_input('Enter List Text (Enter "stop" to end loop):\n')
    if item == 'stop':
        break
    x.append(make_link(item))
    print 'List Item Added\n'

template = MarkupTemplate(TMPL)
stream = template.generate(items = x)
print stream.render() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T23:04:17.293

```
list_output = "<li>%s</li>\n" * len(x) % tuple(x) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T22:59:51.860

用以下内容替换底部的 for 循环：

```
list_output=""
for aLine in x:
    list_output += '<li>'+aLine+'</li>\n' 
```

另请注意，由于 x 是一个列表，Python 允许您遍历列表中的元素，而不必遍历索引变量，然后用于查找列表中的元素。

# asp.net - 启用分页后，Gridview 在回发时消失

> ID：583995
> 
> 赞同：5
> 
> 时间：2009-02-24T22:54:55.397
> 
> 标签：asp.net, gridview, postback, paging, objectdatasource

我有一个 gridview，它的 DataSourceID 属性设置为自定义 ObjectDataSource 对象。当 AllowPaging 设置为 True 时，GridView 在回发后消失。如果我将 AllowPaging 设置为 False 就可以了。有人可以为我解释一下吗？:)

**编辑：**我感到困惑的另一件事是，我认为如果您设置**DataSourceID**，网格将在需要时从数据源获取数据。如果网格因为没有保存数据而消失，为什么 gridview 没有从数据源获取它需要的数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T22:58:58.087

回发发生后，可能没有维护或重新填充数据源，并且没有项目可以填充网格。启用分页时，您是否正确处理数据源对象的状态（重新绑定/保持源活动）？

这听起来可能是一个模糊的答案，但如果没有说明来源如何获取数据的示例，就很难诊断为什么这些项目会消失。

编辑：
我想的方法是回调分页/排序。但是我确实找到了一些关于 ODS 和分页的信息。确保您已设置以下内容：

1.  GridView：AllowPaging，当然你需要设置PageSize。
2.  ObjectDataSource：EnablePaging，还需要设置：
    *   MaximumRowsParameterName="maxRows"
    *   StartRowIndexParameterName="startRowIndex"
    *   SelectCountMethod="记录计数"

如果您想手动处理分页大小等，我认为您只需要设置第 2 项的 3 个子项。

然后你可以在[这里](http://bhaidar.net/cs/archive/2006/04/18/274.aspx)阅读更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-26T04:38:43.173

为了回答@adam0101 的更多回复，**我认为**他的意思是“......事实证明我的自定义数据源**为记录计数返回零**。”，是您可能需要将数据源“*重新附加*”到 gridview . ASP.net 自动知道您正在检索记录-'n'，其中'n' 是下一页的第一行。此解决方案更适用于您不想让 asp.net**自动处理数据的情况**在您的 gridview 中，可能是由于想要在另一个事件（例如 LOAD DATA 按钮）之后加载数据，而不是在第一次加载页面时。但正如亚当在下面提到的，真正的原因是他“......创建了一个继承 ObjectDataSource 的数据源子类，但它的实现不正确。”。对不起我的假设亚当。谢谢

但是，我认为我的其余解决方案适用于那些坚持使用手动派生数据源的人。

IE

按照上述设置您的 GridView，并注意 - 没有 DataSource 属性！这是我的例子：

```
 <asp:GridView ID="gvStudents" DataKeyNames="StudentID" runat="server" 
            ShowFooter="True" AutoGenerateColumns="False" Width="100%" AllowSorting="True" AllowPaging="true" PageSize="10" OnPageIndexChanging="gvStudents_PageIndexChanging"> 
```

接下来创建一个私有方法或例程，您可以在需要强制gridview 进入新页面时调用它们。

```
private void BindGridViewServer(GridView gv1)
{
    gv1.DataSource = sdsStudents;   //re-attach the datasource
    gv1.DataBind();                 //get a page of data AllowPaging must be true
} 
```

接下来，创建`OnPageIndexChanging`方法：

```
protected void gvStudents_PageIndexChanging(object sender, GridViewPageEventArgs e)
{
    GridView myGV = (GridView)sender;
    myGV.PageIndex = e.NewPageIndex;
    BindGridViewServer(myGV);
} 
```

为了完成这个答案，这是我的代码，我在需要时加载数据 - 而不是在触发 PostPack 时，这是默认设置......

```
 protected void btnSEARCH(object sender, EventArgs e)
        {
//some code
                    //bind the gridview to the datasource here and then bind!
                    gvStudents.DataSource = sdsStudents;
                    gvStudents.DataBind();
//more code etc
        } 
```

# css - 学习 CSS 的资源...当您了解堆栈的其余部分时

> ID：583998
> 
> 赞同：2
> 
> 时间：2009-02-24T22:55:40.840
> 
> 标签：css

### 复制

> [https://stackoverflow.com/questions/2084/can-you-recommend-a-good-css-online-resource-or-book](https://stackoverflow.com/questions/2084/can-you-recommend-a-good-css-online-resource-or-book)
> [https://stackoverflow.com/questions/132587/the-best-css-tutorial -site-blog-book](https://stackoverflow.com/questions/132587/the-best-css-tutorial-site-blog-book)
> [https://stackoverflow.com/questions/199486/what-is-the-best-book-on-css](https://stackoverflow.com/questions/199486/what-is-the-best-book-on-css)

我在追求成为一个更完整的网络程序员的过程中遇到了一个巨大的漏洞，那就是 CSS。我做了很多前端/中间层/后端 Java 工作，包括相当多的 Javascript，所以我不是构建网站的新手。不幸的是，我一直有大量的 CSS/JS 专家来润色我写的垃圾 HT​​ML ( `<pre>`FTW)，所以我从来没有真正学会如何使这些表格像素完美。

是的，我知道 Google 上有十亿零一个资源，但我希望可能有一些隐藏的宝石，无论是书籍、博客、网站，您可能会推荐以直接的方式学习 CSS 基础知识、最佳实践、浏览器怪癖有编程背景的人。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T22:57:29.150

我喜欢[sitepoint css 参考资料](http://reference.sitepoint.com/css)。我们在我的办公室使用这个[终极 CSS 参考的 PDF](http://www.sitepoint.com/books/cssref1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T22:58:04.203

查看[O'Reilly CSS：](http://www.amazon.co.uk/CSS-Definitive-Guide-Eric-Meyer/dp/0596527330/ref=sr_1_1?ie=UTF8&s=books&qid=1222340657&sr=1-1) Eric Meyer 的权威指南，可以说是 CSS 大师。

您可能会发现[这个问题的答案](https://stackoverflow.com/questions/132587/the-best-css-tutorial-site-blog-book/132621#132621)也很有用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T22:58:05.843

开始使用[w3schools.com](http://www.w3schools.com/css/default.asp)上的 CSS 教程不会出错。还包括一个自己尝试的设施，可以快速玩。

另外，找到了帮助我解决浮动问题的那个：[tiztag](http://www.tizag.com/cssT/float.php)。那里还有更多好东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T23:01:28.830

Sitepoint 的大师 Tommy Olsson 和 Paul O'Brien 所著的《终极 CSS 参考》一书回答了我所有的问题。我强烈推荐这个参考。一旦您了解了 Position 和 Float 的不同选项以及其他一些规则，它就会真正阐明一切。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T23:01:54.460

我一直觉得[Eric Meyer 的](http://meyerweb.com/eric/css/)作品既有趣又有用。他有指向 CSS 资源集合以及他自己的著作和思考的链接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T23:13:29.113

有关 CSS 的高级文章，您可能需要查看[http://www.alistapart.com/topics/code/css/](http://www.alistapart.com/topics/code/css/)*********