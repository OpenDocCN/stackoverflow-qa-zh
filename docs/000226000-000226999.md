# StackOverflow 问答 000226000-000226999

# c# - X = X++; 有什么区别？与 X++;?

> ID：226002
> 
> 赞同：56
> 
> 时间：2008-10-22T14:34:28.853
> 
> 标签：c#

你以前试过这个吗？

```
static void Main(string[] args)
{
    int x = 10;
    x = x++;
    Console.WriteLine(x);
} 
```

输出：10。

但对于

```
static void Main(string[] args)
{
    int x = 10;
    x++;
    Console.WriteLine(x);
} 
```

输出：11。

谁能解释这是为什么？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-10-22T14:35:35.870

X++ 将增加该值，但随后返回其旧值。

所以在这种情况下：

```
static void Main(string[] args)
{
    int x = 10;
    x = x++;
    Console.WriteLine(x);
} 
```

你在 11 处的 X 只是片刻，然后它又回到 10，因为 10 是 (x++) 的返回值。

您可以改为这样做以获得相同的结果：

```
static int plusplus(ref int x)
{
  int xOld = x;
  x++;
  return xOld;
}

static void Main(string[] args)
{
    int x = 10;
    x = plusplus(x);
    Console.WriteLine(x);
} 
```

还值得一提的是，如果您这样做，您将获得 11 的预期结果：

```
static void Main(string[] args)
{
    int x = 10;
    x = ++x;
    Console.WriteLine(x);
} 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-10-22T14:36:39.643

在赋值中`x = x++`，您*首先*提取旧值`x`以用于评估右侧表达式，在本例中为“x”；然后，加1。最后，通过赋值语句`x`将表达式求值 (10) 的结果赋值给。`x`

也许等效的代码可以使困境变得清晰：

```
var tmp = x;
x++;
x = tmp; 
```

这相当于您`x = x++`在 C# 中的代码。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-22T14:37:00.580

x++ 的行为是增加 x 但返回增加**之前**的值。出于这个原因，它被称为后期增量。

所以 x = x++; 简单地说意志

**1.返回值**，然后

**2\. 增加 x**，然后

**3\. 将 x 的原始值（在步骤 1 中返回）分配给 x**。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-22T14:37:14.260

```
x = 10
x = ++x 
```

`x`最终将等于 11。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-22T14:40:05.190

```
x++; 
```

执行以下操作：

```
int returnValue = x;
x = x+1;
return returnValue; 
```

可以看到，原始值被保存，x 递增，然后返回原始值。

最终所做的是将值 10 保存在某处，将 x 设置为 11，然后返回 10，这会导致 x 重新设置为 10。请注意，x 实际上在几个周期内变为 11（假设没有编译器优化） .

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-22T15:29:08.103

你可以这样想：

```
int x = 10; 
```

X 是一个容器，包含一个值 10。

```
x = x++; 
```

这可以分解为：

```
1) increment the value contained in x 
    now x contains 11

2) return the value that was contained in x before it was incremented
    that is 10

3) assign that value to x
    now, x contains 10 
```

现在，打印 x 中包含的值

```
Console.WriteLine(x); 
```

而且，不出所料，它打印出 10。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-02-04T10:32:20.770

你做的第一件事叫做“后增量”，意思是

```
 int x = 10;
    x++; //x still is 10
    Console.WriteLine(x); //x is now 11(post increment) 
```

所以当你分配 x = x++; x 仍然是 10 你可以做什么，如果你需要 x 是 11 在这一行写 ++x （如果我错了，认为它称为预增量纠正我）......或者正确 x++; 而比 x = x++;

问题，它是取决于行还是语句，这意味着它将在 ; 之后递增 ?

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-11-11T00:08:13.907

我知道有很多答案，并且一个被接受的答案，但我仍然会为另一种观点投入两分钱。

我知道这个问题是 C#，但我认为对于后缀运算符之类的东西，它的行为与 C 没有不同：

```
int main(){
    int x = 0;
    while (x<1)
        x = x++;
} 
```

编译器生成的程序集（是的，我对其进行了编辑以使其更具可读性）显示

```
...
    mov    -8(rbp), 0       ; x = 0
L1:
    cmp    -8(rbp), 1       ; if x >= 1,
    jge    L2               ;     leave the loop
    mov    eax, -8(rbp)     ; t1 = x
    mov    ecx, eax         ; t2 = t1
    add    ecx, 1           ; t2 = t2 + 1
    mov    -8(rbp), ecx     ; x  = t2 (so x = x + 1 !)
    mov    -8(rbp), eax     ; x  = t1 (kidding, it's the original value again)
    jmp    L1
L2:
... 
```

等效地，循环正在执行以下操作：

```
t = x
x = x + 1
x = t 
```

旁注：打开任何优化都会给你一些汇编结果，如下所示：

```
...
L1:
    jmp    L1
... 
```

它甚至不需要存储你告诉它给 x 的值！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-22T19:19:51.350

将增量运算符放在变量之后意味着在计算表达式*之后*发生增量和赋值......所以原始语句 x = x++; 转换为 1\. 评估 x 并将值存储在暴政内存中...现在执行由 ++ 运算符调用的代码 ....（步骤 2 和 3） 2\. 增加 x 的值（在瞬态内存中） 3\. 分配增量值到 x 的存储位置...现在，继续执行该行的其余部分，在左侧，有一个 = 符号... 5\. 因此，将步骤 1 中存储的值（未递增的值）分配给 = 符号左侧的表达式。 . 这是 x

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-08-21T08:05:32.300

也许我不正确，但我更容易理解类似示例的结果：

```
public static void main(String[] args) {
    int x = 10;
    int y = 0;
    y = x + x++;  //1, 2, 3, 4
    x += x;       //5
    System.out.println("x = " + x + "; y = " + y);  //6
} 
```

让我们一步一步看一下操作 y = x + x++：

1.  计算机获取 x 的值并将其与 x 的值相加 (10 + 10 = 20)
2.  计算机将结果放入临时变量（temp = 20）
3.  计算机递增 x (10 + 1 = 11)
4.  计算机将存储在 temp 中的右侧操作的结果分配给变量 y (20)
5.  计算机获取 x 的值并将其与 x 的值相加 (11 + 11 = 22)
6.  最终结果是：x = 22；y = 20

现在让我们回到我们的示例并执行相同的步骤：

```
public static void main(String[] args) {
    int x = 10;
    x = x++; //1, 2, 3, 4
    System.out.println(x);  //5
} 
```

1.  计算机取 x (10) 的值
2.  计算机将结果放入临时变量（temp = 10）
3.  计算机递增 x (10 + 1 = 11)
4.  计算机将存储在 temp 中的右侧操作的结果分配给变量 x (10)
5.  最终结果是：x = 10

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2008-10-22T14:40:36.373

分配的结果

```
x = x++; 
```

在 C 和 C++ 中未定义~~，我猜 C# 也一样。~~

~~因此，实际发生的操作顺序取决于编译器决定如何实现它，不能保证是赋值还是递增首先发生。~~ （正如 Jon Skeet 在评论中指出的那样，这在 C# 中得到了很好的定义。虽然我现在觉得这个答案的价值要小得多，但对于 OP 的问题及其在评论中的答案，我不会删除这篇文章。）

但是，在这种情况下，发生的操作顺序似乎是：

1.  x 的旧值 (10) 被保存
2.  x 为 ++ 部分递增
3.  旧值现在分配给 x 以进行分配

这样，虽然发生了增量，但它被旧值的赋值所取代，从而使 x 保持在 10。

高温高压

# labview - 为什么使用LabVIEW？

> ID：226010
> 
> 赞同：8
> 
> 时间：2008-10-22T14:35:51.750
> 
> 标签：labview

我正在学习使用 LabVIEW 作为我的荣誉项目的一部分，并且想知道图形编程语言比文本编程语言有什么好处？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-02T17:19:33.293

对我来说，LabVIEW 的好处不在于图形与文本。

这是数据流与命令。

[数据流编程](http://en.wikipedia.org/wiki/Dataflow_programming)有助于并发，因为您的执行被建模为黑盒，当它们的输入有效时执行，其输入/输出连接在一起。这与带有有关如何修改它的指令列表的隐式状态相反。（松散地解释'kipedia，上面链接的文章更好。）

每个黑匣子都可以在单独的核心/处理器/节点上运行，如果您以数据流方式组织程序，这可以有效地为您提供免费的并发性。

不幸的是（这通常是数据流编程的一个*严重*缺点）可视化和编辑数据流程序的最佳方法是图形，而不是文本。这使得使用诸如修订控制和代码生成器之类的工具变得非常困难。

问题是：对您和您的项目而言，数据流的利大于弊吗？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-02T17:31:40.290

使用 LabVIEW 进行图形化编程的主要优点之一是源代码与电路图非常相似，因此对于电气/电子工程师来说它是一种非常容易上手的语言。这是 LabVIEW 在数据采集和自动化领域如此流行的原因之一，在这些领域，EE 非常丰富。

我发现的另一个优势是原始开发速度。您从可用前面板控件的调色板中组装您的 GUI，这与您在 Visual Studio 中的操作非常相似。源代码以类似的方式编写，具有许多预定义的组件，您可以从菜单中放入这些组件并连接在一起。

第三个优点是与硬件的兼容性。National Instruments 的主要业务是数据采集硬件，他们竭尽全力确保他们的所有产品都可以直接与 LabVIEW 软件进行通信。数据采集​​和自动化控制行业的许多其他硬件供应商也在做同样的事情。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-22T14:40:17.747

我之前使用 labview 来计算参数以调整 nMRI 机器。它们的存在是因为理论上对于没有编程语言经验的人来说更容易创建程序。控制流和决策结构可以以图形方式排列，他们可以在他们想要的地方输入公式。

对于教授和实验室助理......很有帮助。对于真正的软件开发人员......用另一种语言编写会更容易。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-22T15:48:04.007

一切都与设备驱动程序和用户能力有关。NI (Labview) 拥有一套支持良好的实验室设备驱动程序，易于连接。测试操作员（不是开发人员）需要一个带有绿色/红色通过/失败大按钮的 gui。我在 cygwin 中通过 python 实现了复杂的自动化。Labview 开发人员能够调用 cygwin/python 系统并对日志文件进行数据挖掘。所以你可以两者都做。python 系统是可移植的、可维护的、可扩展的、可用的，最重要的是，它是免费的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-22T15:04:25.547

我过去使用过 LabView，用于数据采集、虚拟仪器等 - 没有比这更好的了。我最后一次使用它是在 10 年前，从那以后我所见过的一切都与 90 年代中期的情况相提并论。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-27T16:22:31.917

在我看来，LabVIEW的一些优点是：

*   内置的用户界面组件，如按钮、图形等，实际上不需要任何编程；您只需将它们放在前面板上，数据终端就会出现在程序框图上。

*   有一个用于数据采集硬件和测试仪器的大型驱动程序库。如果您的任务基本上是从这些数据中获取数据并在其上放置用户界面，那么您几乎无需编程即可实现它。

*   自动处理多个任务的并行执行 - 在图表上放置两个独立的循环，它们将同时执行。这通常是数据采集和控制应用中的要求。

许多人，包括“真正的软件开发人员”，认为图形范式比文本范式更适合他们思考和可视化软件的方式。毫无疑问，文本语言在某些方面比 LabVIEW 更好（在本网站的另一个讨论中有所介绍），但 LabVIEW 在适合的地方非常擅长完成工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-09T15:49:04.927

对我来说，这取决于您对什么感到满意，如果您对基于文本的语言感到满意，您可能会发现 Labview 只是引入了另一个学习曲线。除非您有学习和使用 Labview 的特定目标，否则我认为您的项目没有意义。

另一方面，如果你对基于文本的语言不是特别熟悉，我倾向于认为 Labview 更容易上手和学习，特别是对于非软件工程师。

我经常使用基于文本的语言进行测试工程以及 Labview 和 TestStand，对我来说，更多的是关于还有谁会使用我的软件，而不是关于我。一些公司有几个受过 Labview 培训的人员，而其他公司则更喜欢用基于文本的语言写作。在整个公司范围内，另一种语言的培训成本可能非常高，并且它改变了公司内职位的招聘要求，因此一些公司实际上“锁定”在一种范式或另一种范式上。如果你打算在这个行业工作，我会说你最好的选择是精通两者，这样你就很灵活。如果是这种情况并且您有时间学习，我会说在您最不喜欢的领域工作并扩展您的知识广度，这就是学校的目的，对吗？

# oracle - 将扩展 ASCII 导入 Oracle

> ID：226016
> 
> 赞同：0
> 
> 时间：2008-10-22T14:36:29.393
> 
> 标签：oracle, utf-8

我有一个导入包含一些字符串的二进制文件的过程。字符串可以包含扩展的 ASCII，例如 CHR(224)、'à'。该过程采用 RAW 并将 BCD 字节一一转换为字符串中的字符。

问题是扩展的 ASCII 字符正在丢失。我怀疑这是由于它们的值在 UTF8 中意味着其他东西。

我认为我需要的是一个接受 ASCII 字符索引并返回适当 UTF8 字符的函数。

更新：如果我碰巧知道传入文本的等效 Oracle 字符集，我可以将原始字节转换为 UTF8 吗？源文本将始终为单字节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T14:50:55.387

没有“扩展 ASCII”之类的东西。或者，更准确地说，很多编码是 ASCII 的超集，共享相同的前 127 个代码点，以至于这个术语太模糊而没有意义。您需要确定此文件中的字符串是否使用 UTF-8、ISO-8859-whatever、MacRoman 等进行编码。

你问题第二部分的答案是一样的。UTF-8 在设计上是 ASCII 的超集。任何 ASCII 字符（即 0 到 127）也是 UTF-8 字符。要将一些非 ASCII 字符（即 >= 128）转换为 UTF-8，首先需要找出它的编码方式。

# c# - 从 ACT 检索联系人和公司 GUID！

> ID：226034
> 
> 赞同：0
> 
> 时间：2008-10-22T14:40:15.657
> 
> 标签：c#, guid, act

我目前正在开发一个 C# 程序，该程序使用来自 ACT! 的数据。为了能够搜索和更新记录，您需要使用 GUID。我能够从框架中获取 GUID 的唯一方法是创建新记录时。

如何从 ACT! 中的现有记录中检索 GUID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-17T10:00:32.297

好吧，这取决于哪个版本的ACT！你有，但你几乎肯定需要ACT！开发工具包。

可以从这里下载： [ACT！SDK下载](http://www.act.com/partners/addonpartners/sdk/index.cfm)

[ACT](http://community.act.com/sage/?category.id=ActDevNet)上有一篇好文章！具有 .zip 文件附件的[开发者论坛。](http://community.act.com/sage/?category.id=ActDevNet)附件包含由 Sage 员工发布的一些开发人员培训材料，该材料中包含处理联系人数据的完整示例。

从随附的“自述文件”中：

> Insights2007ACTSDKTraining.zip 包含三个文件：
> 
> 行为！SDK Training.pdf 是用于会话的演示文稿。
> 
> Samples.zip 包含一个联系人绑定控件，演示实体数据绑定和设计时功能。
> 
> Act.DevNet.Extensibility.Plugin.zip 是插件模板。将其复制到 Visual Studio 2005\Templates\ProjectTemplates 目录。然后可以通过文件->新建项目，选择 Visual C#，在我的模板下访问它。

链接是：[ACT！SDK 培训课程资料](http://community.act.com/sage/board/message?board.id=ADN_Downloads&thread.id=10)

# sql-server-2005 - 如何查询数据库模式是否存在

> ID：226042
> 
> 赞同：118
> 
> 时间：2008-10-22T14:41:59.773
> 
> 标签：sql-server-2005, schema

作为构建过程的一部分，我们在将代码部署到 4 个不同的环境时运行数据库更新脚本。此外，由于将添加相同的查询，直到我们将发布版本投入生产，它*必须*能够在给定的数据库上运行多次。像这样：

```
IF NOT EXISTS (SELECT * FROM sys.tables WHERE object_id = OBJECT_ID(N'[Table]'))
BEGIN
  CREATE TABLE [Table]
  (...)
END 
```

目前我在部署/构建脚本中有一个创建模式语句。我在哪里查询架构的存在？

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2008-10-22T14:44:32.420

你在寻找[sys.schemas](http://msdn.microsoft.com/en-us/library/ms176011.aspx)吗？

```
IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'jim')
BEGIN
EXEC('CREATE SCHEMA jim')
END 
```

请注意，`CREATE SCHEMA`必须在自己的批次中运行（根据[下面的答案](https://stackoverflow.com/a/521271/2688)）

* * *

## 回答 #2

> 赞同：165
> 
> 时间：2009-02-06T17:32:02.917

@bdukes 在确定架构是否存在方面是正确的，但上面的语句在 SQL Server 2005 中不起作用。`CREATE SCHEMA <name>`需要在自己的批处理中运行。一种解决方法是`CREATE SCHEMA`在 exec 中执行语句。

这是我在构建脚本中使用的内容：

```
IF NOT EXISTS (SELECT 1 FROM sys.schemas WHERE name = '<name>')
BEGIN
    -- The schema must be run in its own batch!
    EXEC( 'CREATE SCHEMA <name>' );
END 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-03-15T20:20:56.827

这是旧的，所以我不得不添加：对于 SQL SERVER 2008+ 这些都有效（对于选择部分），然后用于`EXECUTE('CREATE SCHEMA <name>')`在负面结果上实际创建它。

```
DECLARE @schemaName sysname = 'myfunschema';
-- shortest
If EXISTS (SELECT 1 WHERE SCHEMA_ID(@schemaName) IS NOT NULL)
PRINT 'YEA'
ELSE
PRINT 'NOPE'

SELECT DB_NAME() AS dbname WHERE SCHEMA_ID(@schemaName) IS NOT NULL -- nothing returned if not there

IF NOT EXISTS ( SELECT  top 1 *
                FROM    sys.schemas
                WHERE   name = @schemaName )
PRINT 'WOOPS MISSING'
ELSE
PRINT 'Has Schema'

SELECT SCHEMA_NAME(SCHEMA_ID(@schemaName)) AS SchemaName1 -- null if not there otherwise schema name returned

SELECT SCHEMA_ID(@schemaName) AS SchemaID1-- null if not there otherwise schema id returned

IF EXISTS (
    SELECT sd.SchemaExists 
    FROM (
        SELECT 
            CASE 
                WHEN SCHEMA_ID(@schemaName) IS NULL THEN 0
                WHEN SCHEMA_ID(@schemaName) IS NOT NULL THEN 1
                ELSE 0 
            END AS SchemaExists
    ) AS sd
    WHERE sd.SchemaExists = 1
)
BEGIN
    SELECT 'Got it';
END
ELSE
BEGIN
    SELECT 'Schema Missing';
END 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-01-09T20:41:11.423

如果组件的布局允许，这也可以。

```
IF EXISTS (SELECT 1 FROM sys.schemas WHERE name = 'myschema') SET NOEXEC ON
去
CREATE SCHEMA myschema
去
SET NOEXEC OFF -- 如果需要进一步处理。
去

```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-22T19:36:02.903

只是为了*更加*“防御”，以下版本会生成一个类型转换错误，以解释 > 1 匹配的可能性（但不太可能），`Schema`类似于验证代码经常故意抛出异常的方式，因为我相信它是好的，我相信它是“'最佳实践'”来解释所有可能的返回结果，但不太可能，即使它只是产生一个致命的异常，因为停止处理的已知效果通常比未捕获错误的未知级联效果更好。因为这极不可能，所以我认为不值得单独`Count`检查 +`Throw`或`Try`-来生成更用户友好的致命错误`Catch`，`Throw`但仍然是致命错误。

SS 2005-:

```
declare @HasSchemaX bit
set @HasSchemaX = case (select count(1) from sys.schemas where lower(name) = lower('SchemaX')) when 1 then 1 when 0 then 0 else 'ERROR' end 
```

SS 2008+：

```
declare @HasSchemaX bit = case (select count(1) from sys.schemas where lower(name) = lower('SchemaX')) when 1 then 1 when 0 then 0 else 'ERROR' end 
```

然后：

```
if @HasSchemaX = 1
begin
   ...
end -- if @HasSchemaX = 1 
```

# java - 如何在属性文件中指定值，以便可以使用 ResourceBundle#getStringArray 检索它们？

> ID：226050
> 
> 赞同：32
> 
> 时间：2008-10-22T14:43:40.860
> 
> 标签：java, resourcebundle

我正在尝试使用从属性文件`ResourceBundle#getStringArray`中检索 a 。`String[]`文档中对此方法的描述如下：

> 从此资源包或其父资源包中获取给定键的字符串数组。

但是，我尝试将属性文件中的值存储为多个单独的键/值对：

```
key=value1
key=value2
key=value3 
```

并作为逗号分隔的列表：

```
key=value1,value2,value3 
```

但这些都不能使用`ResourceBundle#getStringArray`.

您如何在属性文件中表示一组键/值对，以便可以使用 检索它们`ResourceBundle#getStringArray`？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-22T15:03:43.147

一个`Properties`对象可以持有**`Object`s**，而不仅仅是`String`s。这往往会被遗忘，因为它们绝大多数用于加载 .properties 文件，因此通常只包含`String`s。[该文档](https://web.archive.org/web/20081217073139/http://java.sun.com/j2se/1.4.2/docs/api/java/util/ResourceBundle.html#getStringArray(java.lang.String))表明调用`bundle.getStringArray(key)`等效于调用`(String[]) bundle.getObject(key)`。这就是问题所在：值不是 a `String[]`，而是 a `String`。

我建议以逗号分隔的格式存储它并调用`split()`该值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-08-18T00:57:01.500

您可以使用[Commons Configuration](http://commons.apache.org/proper/commons-configuration/userguide/howto_properties.html)，它具有方法`getList`，`getStringArray`允许您检索逗号分隔的字符串列表。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-22T15:01:56.083

嗯，看起来这是一个常见问题，来自[这里](http://saloon.javaranch.com/cgi-bin/ubb/ultimatebb.cgi?ubb=get_topic&f=33&t=014772)和[这里](http://www.theserverside.com/discussions/thread.tss?thread_id=15426)的线程。

似乎您不使用该方法并自己解析数组的值，或者您编写自己的 ResourceBundle 实现并自己做:(。也许有一个 apache commons 项目用于此...

从 JDK 源代码来看，PropertyResourceBundle 似乎不支持它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-22T15:06:04.593

我不相信从属性文件加载的 ResourceBundles 是不可能的。PropertyResourceBundle 利用 Properties 类来加载属性文件。Properties 类将属性文件加载为一组 String->String 映射条目，并且不支持提取 String[] 值。

调用 ResourceBundle.getStringArray 只是调用 ResourceBundle.getObject，将结果转换为 String[]。由于 PropertyResourceBundle 只是将它交给它从文件中加载的 Properties 实例，因此您永远无法让它与当前的库存 PropertyResourceBundle 一起使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-04T16:49:39.283

例子：

```
mail.ccEmailAddresses=he@anyserver.at, she@anotherserver.at 
```

..

```
myBundle=PropertyResourceBundle.getBundle("mailTemplates/bundle-name", _locale); 
```

..

```
public List<String> getCcEmailAddresses() 
{
    List<String> ccEmailAddresses=new ArrayList<String>();
    if(this.myBundle.containsKey("mail.ccEmailAddresses"))
    {
        ccEmailAddresses.addAll(Arrays.asList(this.template.getString("mail.ccEmailAddresses").split("\\s*(,|\\s)\\s*")));// 1)Zero or more whitespaces (\\s*) 2) comma, or whitespace (,|\\s) 3) Zero or more whitespaces (\\s*)
    }       
    return ccEmailAddresses;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-12-27T13:56:32.387

我已经尝试过了，并且可以找到一种方法。一种方法是定义 ListresourceBundle 的子类，然后定义 String[] 类型的实例变量并将值分配给键.. 这是代码

```
@Override
protected Object[][] getContents() {
    // TODO Auto-generated method stub

    String[] str1 = {"L1","L2"};

    return new Object[][]{

            {"name",str1},
            {"country","UK"}                
    };
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-04-27T16:55:14.747

只需使用 spring - [Spring .properties 文件：将元素作为数组获取](https://stackoverflow.com/questions/6212898/spring-properties-file-get-element-as-an-array)

相关代码：

```
base.module.elementToSearch=1,2,3,4,5,6

@Value("${base.module.elementToSearch}")
  private String[] elementToSearch; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-23T11:08:59.360

```
public String[] getPropertyStringArray(PropertyResourceBundle bundle, String keyPrefix) {
    String[] result;
    Enumeration<String> keys = bundle.getKeys();
    ArrayList<String> temp = new ArrayList<String>();

    for (Enumeration<String> e = keys; keys.hasMoreElements();) {
        String key = e.nextElement();
        if (key.startsWith(keyPrefix)) {
            temp.add(key);
        }
    }
    result = new String[temp.size()];

    for (int i = 0; i < temp.size(); i++) {
        result[i] = bundle.getString(temp.get(i));
    }

    return result;
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-05-12T03:29:24.820

```
key=value1;value2;value3

String[] toArray = rs.getString("key").split(";"); 
```

# php - 我可以从 Linux 服务器上的 PHP 应用程序可靠地创建 Excel 文档吗？

> ID：226052
> 
> 赞同：4
> 
> 时间：2008-10-22T14:44:26.493
> 
> 标签：php, linux, export-to-excel

从 Linux 服务器上的 PHP 应用程序生成 Excel 文档的状态是什么？

我对创建 Office 97 (xls) Excel 文件很感兴趣。我对该主题的有限研究出现了这个[梨包](http://pear.php.net/package/Spreadsheet_Excel_Writer)。自 2006 年以来，它似乎处于测试状态。

你能分享你从 PHP 生成 Excel 文件的成功或失败吗？是否有可靠且成熟的工具可用？

更新：对于这个应用程序，我确实需要生成一个 Excel 文件，而不仅仅是一个 CSV 文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-07T09:06:39.480

那里有比 PEAR 包更好的东西！

[PHPExcel](http://phpexcel.codeplex.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T14:46:07.113

我使用了那个 PEAR 包，它对我来说非常适合 Office '97-2000 兼容文件。

如果是简单的电子表格，Office 也可以处理 CSV，PHP 可以[轻松地原生输出](http://us.php.net/fputcsv)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T14:47:27.827

如何使用表格（电子表格是表格，所以没关系）并将这些行放在生成表格的 PHP 脚本的顶部：

```
header("Content-Type: application/vnd.ms-excel");
header("Expires: 0");
header("Cache-Control: must-revalidate, post-check=0, pre-check=0"); 
```

或者您可以只生成一个 CSV 文件，因为 Excel 可以很好地打开这些文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T19:37:57.507

我已经成功使用了 PEAR 包，但是在实现复杂的公式时存在一些限制。它与 excel 存储公式的方式以及最后的计算结果有关。有时即使公式正确，当第一次打开工作表时，单元格也会显示为空。一旦单元格获得焦点然后失去焦点，就会执行计算并填充单元格。

该库实际上是 perl 库的一个端口，它稍微完整一些，但也有同样的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-22T20:43:26.300

我在几个项目中使用 PERL Spreadsheet::WriteExcel 没有问题。您可能需要进行一些修复和包装以增强功能并使其更容易，但我觉得没问题。

我喜欢它，因为它独立于平台，快速且易于设置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-22T15:39:31.933

最简单的方法确实是使用标题来“伪造”一个 Excel 文件。这是开始作为 Excel 文件下载的代码，客户端的 Excel 将解析找到的任何 HTML 代码（表格、csv、...）并以类似 Excel 的格式显示。

```
header("Content-type: application/vnd.ms-excel");
header("Content-Disposition: attachment; filename=excel.xls"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T14:47:29.620

现在一切都处于测试状态。你真的需要带有forumlas的excel文件以及所有这些，还是只需要在excel中打开一个记录列表来处理？

通常，我发现当客户想要一个 Excel 文件时，我真的可以只生成一个 CSV 文件，他们可以在 Excel 中处理它，并在事后添加他们想要的公式。

# user-interface - 你最喜欢的用户界面是什么？（Web应用程序）

> ID：226060
> 
> 赞同：3
> 
> 时间：2008-10-22T14:46:08.283
> 
> 标签：user-interface

我认为从程序员的角度了解 UI 设计会很有趣。

您在 Web 应用程序中遇到的最喜欢的用户界面是什么？

如果可能的话，谈谈你为什么喜欢它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-22T14:47:39.013

[http://www.google.com](http://www.google.com)是我的最爱。可以被认为是“缺乏用户界面”；）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-22T14:49:37.340

冒着听起来太狂热的风险......我认为 StackOverflow 有一个很棒的用户界面。它很干净，没有杂乱（除了蠕动的广告！），导航是直接的，但设法压缩了相当多的功能。

相当简单的功能，例如显示您投票的彩色投票按钮，以及实时预览确实增加了互动感觉。

（而且我不介意这些广告，只要它们远离闪烁的拳打猴子那种！）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-22T16:01:23.140

网络应用程序：**Wordpress**。它是如此强大，但干净且易于使用。

桌面应用程序：**Excel**（或等效）。说真的，电子表格是有史以来设计的最具创新性和最聪明的用户界面。它用于一切。我不知道问题是什么，但答案是 Excel。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-22T22:11:39.570

GMail 界面非常流畅和快速，以至于我质疑为什么以前没有人这样做过。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-22T15:34:43.287

[Mint.com](http://mint.com)，如果您信任其他人提供您的银行帐户信息。它跟踪您的所有交易，让您填写预算，通知您不寻常的支出趋势或交易，并让您深入了解您的支出趋势，以准确了解所有辛苦赚来的现金的去向。最重要的是，它是免费的。

![饼形图](https://www.mint.com/images/about/features/graphs.gif)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-22T20:26:09.720

我认为[Remember The Milk](http://www.rmilk.com)有一个非常干净和直观的界面

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-22T14:51:02.983

*   [http://bbc.co.uk](http://bbc.co.uk)主页
*   [http://mail.google.com/](http://mail.google.com/)
*   [http://stackoverlow.com](http://stackoverlow.com)（那是我在引入广告之前就喜欢它了 :)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-28T02:20:55.487

[FreshBooks](http://www.freshbooks.com)会计有一个非常漂亮的界面。

（尽管我赞成 StackOverflow 的答案）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-22T15:09:15.787

我认为 stackoverflow 在可用性方面在许多领域都做得很好，包括调色板、空白的使用、预测用户对信息的需求以及提供或隐藏适当的、非侵入性的 JS/AJAX。

不过，这些越来越突兀的广告要减分。:P

Gmail 也不错。对 github.com 的荣誉奖。

更新：我最近被介绍给[FriendFeed](http://friendfeed.com)。我认为他们的 Web UI 也做得非常出色，在干净而有吸引力的设计方面，加上对 Javascript 和 AJAX 的适当和有用的使用，以提供流畅、积极的用户体验。一探究竟。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-22T21:54:18.667

*   [http://fastladder.com](http://fastladder.com)为 feedholic 提供了很棒的 UI。我不能没有 fldr 的键盘快捷键（以及一些油脂猴来改变它们以适合我。）
*   [http://www.instapaper.com](http://www.instapaper.com)也很简单，很棒。这是标记为稍后阅读的网络资源的临时存储，因此不需要密码来制作帐户。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-22T14:54:09.000

当我第一次看到它时，新的 Yahoo Mail UI 让我大吃一惊。键盘快捷键、拖放、选项卡等确实使它看起来和感觉像一个桌面应用程序。诚然，这种质量的用户界面在过去几年在网络上变得越来越普遍，但至少对我来说，雅虎邮箱是我经验中第一个将这种可用性带入网络的网络应用程序。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-28T02:14:44.987

对于那里的 CLI 爱好者...

[http://cb.vu/](http://cb.vu/)

猫关于.txt

不是很实用，但很有趣。

# c++ - C++0X 什么时候？

> ID：226061
> 
> 赞同：11
> 
> 时间：2008-10-22T14:46:26.333
> 
> 标签：c++, c++11

> **可能重复：**
> [C++0x 何时完成？](https://stackoverflow.com/questions/5436139/when-will-c0x-be-finished)

关于 C++0X 的最新消息是什么？（或者我应该说 C++1X）任何发布日期已经确定了吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-23T09:20:40.887

## 更新：多年后...

上一个草案已在几周前于 2011 年火星正式定稿，并将于 2011 年 7 月左右正式发布。新标准的名称将是 C++2011：[http ://herbsutter.com/2011/03/25/我们有-fdis-trip-report-march-2011-c-standards-meeting/](http://herbsutter.com/2011/03/25/we-have-fdis-trip-report-march-2011-c-standards-meeting/)

Microsoft C++ 编译器 (VC10) 提供 C++0x 功能（lambda、decltype、auto、r 值引用和 nullptr）。GCC 提供了一个正在进行的版本，它已经实现了很多功能（参见[http://gcc.gnu.org/projects/cxx0x.html](http://gcc.gnu.org/projects/cxx0x.html)）。Comeau C++ 似乎更高级。CLang 开始提供一些功能，但目前不多（见[http://clang.llvm.org/cxx_status.html](http://clang.llvm.org/cxx_status.html)）

因此，在 ISO 管理部门正式验证草案时，大多数功能都可用于主要的 c++ 编译器。我猜一些高级功能在几年之前仍然不可用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-23T16:47:19.660

该委员会草案不太可能成为 FCD。我想说，在提交 FCD 之前，标准委员会至少还要召开 2 次会议。

I think there is something like a 1 year lag between the FCD and the actual standard, so it could be 2011 (or even later!!!)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-22T15:01:04.460

最近出了一个新的[草案，所以事情正在取得进展。](http://www.open-std.org/jtc1/sc22/wg21/)从这个草稿到定稿，应该不会超过一年的时间。我应该注意，这个草稿是功能完整的版本；从这里开始，它应该只是修改。然而，我刚刚意识到，从草稿到实际的、已发布的标准的道路是一条很长的路。我将把我对已发布、接受的标准的估计推迟到 2010 年。

多久才能完全符合编译器要求？那是一个不同的故事。GCC 在非库的语言特性上取得了良好的进展（参见[他们已经实现的特性列表](http://gcc.gnu.org/projects/cxx0x.html)），但没有提到并发特性方面的进展。当 MSVC/dinkumware/您可能使用的任何其他编译器将开始实现 lambda 之类的东西时，我无话可说。

Boost 已经实现了 TR1 的大部分内容，而 dinkumware 已经实现了这一切，因此您已经可以开始使用新的库了（但可能不是最终形式）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-22T15:02:25.537

许多免费和商业编译器已经包含对某些 C++0X 特性的支持。

*   [gcc](http://gcc.gnu.org/projects/cxx0x.html)：static_assert，强类型枚举，可变参数模板...
*   [Codegear C++Builder 2009](http://www.codegear.com/products/cppbuilder/whats-new/)：static_assert，强类型枚举...
*   [Visual C++ 2008](http://www.microsoft.com/downloads/details.aspx?FamilyId=D466226B-8DAB-445F-A7B4-448B326C48E7&displaylang=en)：主要支持 TR1

至于标准委员会何时真正发布，嗯……

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-22T14:49:14.423

[这里](https://stackoverflow.com/questions/200237/where-can-i-learn-more-about-c0x)有一些关于 C++0X 的链接的讨论。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T05:32:54.857

该委员会最近发布了一份委员会草案，该草案将成为最终委员会草案，该草案将成为国际标准最终草案，将成为 ISO 14882:20xx，预计发布日期为 2010 年底。

然而，GCC 4.3 及更高版本实现了越来越大的 C++0x 子集，并且其他编译器开发人员已经在着手实现（据我所知还没有可用的）。

# c++ - 真彩色 CImageList

> ID：226064
> 
> 赞同：4
> 
> 时间：2008-10-22T14:46:57.487
> 
> 标签：c++, mfc

如何将真彩色图像加载到 CImageList 中？

现在我有

```
mImageList.Create(IDB_IMGLIST_BGTASK, 16, 1, RGB(255,0,255)); 
```

`IDB_IMGLIST_BGTASK`64x16 真彩色图像在哪里。我使用的 ClistCtrl 显示 16 bpp 颜色。我没有看到允许我同时指定 bpp 和要从中加载的资源的 Create 重载。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T14:55:48.077

需要 4 行代码，但这有效：

```
CBitmap bm;
bm.LoadBitmap(IDB_IMGLIST_BGTASK);
mImageList.Create(16, 16, ILC_COLOR32 | ILC_MASK, 4, 4);
mImageList.Add(&bm, RGB(255,0,255)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T14:58:01.097

```
CImageList::Create(int cx, int cy, UINT nFlags, int nInitial, int nGrow) 
```

允许使用`nFlags`参数指定不同的标志。您可以尝试使用类似`ILC_COLOR32 | ILC_MASK`.

# database - 如何在数据库中创建和/或关系？

> ID：226065
> 
> 赞同：4
> 
> 时间：2008-10-22T14:47:00.510
> 
> 标签：database, database-design

我有一张优惠券表。优惠券可以仅适用于某些商品，也可以适用于整个商品类别。

例如：一张 12 英寸披萨**和**（1 升百事可乐**或**炸薯条）的 5 美元优惠券

我能想到的最好办法是制作一个 CouponMenuItems 表，其中包含一个 coupon_id 和位字段，例如 IsOr 和 IsAnd。它不起作用，因为在此示例中我有 2 组项目。第二个是两个项目之间的 OR 关系。

知道如何做到这一点，以便实现的逻辑尽可能简单吗？

任何帮助或提示表示赞赏！

谢谢，

发球台

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T19:39:13.510

[通常，您可以使用Disjunctive Normal Form](http://mathworld.wolfram.com/DisjunctiveNormalForm.html)来简化这种事情。

您将您的逻辑规范化为一系列析取 - “或子句”。每个析取词都是一组“和子句”。

所以你的规则变成了下面的长析取。

*   比萨**和**百事可乐

**或者**

*   比萨**和**炸薯条

（顺便说一句，你总是可以用任何逻辑来做到这一点。问题是有些事情可能真的很复杂。好消息是没有营销人员会对你尝试令人费解的逻辑。此外，任何旧形式的重写析取范式是一个简单的代数。）

你会注意到，这总是有两层深：总是一个顶级的析取列表（其中任何一个都可能是真的）和一个低级的合取列表（所有这些都必须是真的）。

因此，您有一个“条件”表，其中包含 id 和产品名称等列。这定义了行项目和产品之间的简单比较。

您有一个包含诸如 conjunct ID 和 condition ID 列的 Conjuncts（“中级和子句”）表。conjunct 和 condition 之间的连接将产生 conjunct 的所有条件。如果所有这些条件都为真，则合取为真。

有一个 Disjuncts（“顶级或子句”）表，其中包含 disjunct Id 和 conjunct ID 等列。如果这些析取之一为真，则该析取为真。

disjuncts、conjuncts 和 conditions 之间的连接会产生您需要测试的完整条件集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T15:50:27.577

一种可能的方法来考虑。假设您创建了以下类：

```
+----------+        1 +---------------+ *
| Coupon   |<#>------>| <<interface>> |<--------------+
+----------+          |   CouponItem  |               |
| +value   |          +---------------+               |
+----------+          | +cost()       |               |
                      +---------------+               |
                             /|\                      |
                              |                       |
           +--------------------------------+         |
           |                  |             |         |
      LeafCouponItem   AndCouponItem  OrCouponItem    |
                             <#>           <#>        |
                              |             |         |
                              +-------------+---------+ 
```

和：

```
class Coupon {
    Money value;
    CouponItem item;
}

interface CouponItem {
    Money cost();
}

class AndCouponItem implements CouponItem {
    List<CouponItem> items;
    Money cost() {
        Money cost = new Money(0);
        for (CouponItem item : items) {
           cost = cost.add(item.cost());
        }
        return cost;
    }
}

class OrCouponItem implements CouponItem {
    List<CouponItem> items;
    Money cost() {
        Money max = new Money(0);
        for (CouponItem item : items) {
            max = Money.max(max, item.cost);
        }
        return max;
    }
}

class LeafCouponItem implements CouponItem {
    Money cost;
    Money cost() {
        return cost;
    }
} 
```

并映射到 2 个表：

```
COUPON            COUPON_ITEM
------            -----------
ID                ID
VALUE             COUPON_ID       (FK to COUPON.ID)
                  DISCRIMINATOR   (AND, OR, or LEAF)
                  COUPON_ITEM_ID  (FK to COUPON_ITEM.ID)
                  DESCRIPTION
                  COST 
```

因此，对于您的示例，您将拥有：

```
> SELECT * FROM COUPON

ID              100
VALUE           5 
```

和

```
> SELECT * FROM COUPON_ITEM

ID      COUPON_ID   DISCRIMINATOR    COUPON_ITEM_ID    DESCRIPTION    COST
200     100         AND              NULL              NULL           NULL
201     100         LEAF             200               PIZZA          10
202     100         OR               200               NULL           NULL
203     100         LEAF             202               PEPSI          2
204     100         LEAF             202               FRIES          3 
```

这种单表方法是高度非规范化的，有些人更愿意为每个 CouponItem 实现使用单独的表。

大多数 ORM 框架将能够处理此类类域的持久性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T14:59:38.037

您需要将所有关系组合在一起，定义它们的分组方式，然后将优惠券分配给这些关系。本质上，您需要数据库实体来表示示例中的括号，尽管您还需要一个外括号：

（披萨 12 英寸和（1 升百事可乐或炸薯条））

```
Coupon
    CouponId
    Name
    ...

Item
    ItemId
    Name
    ...

Group
    GroupId

GroupMembership
    GroupMembershipId
    GroupId
    ItemId

ItemAssociation
    ItemAssociationId
    Item1Id
    Item2Id
    IsOr : bit -- (default 0 means and)

GroupAssociation
    GroupAssociationId
    Group1Id
    Group2Id
    IsOr : bit -- (default 0 means and) 
```

在对该结构进行头脑风暴后，它看起来可以通过节点父/子关系层次结构来解决。ItemAssociation/GroupAssociation 表对我来说很臭，我认为可以处理任何一个的通用关联表可能是可取的，因此您可以编写通用代码来处理所有关系（尽管您会失去参照完整性，除非您还将 Item 和 Group 概括为单一实体）。

注意：命名实体组也会产生问题。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T14:49:07.637

您可以将单个项目视为他们自己的组（1 个成员），只需实现纯逻辑将优惠券映射到组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T17:47:46.670

我的建议：

```
Table
  primary key
= = = = =
COUPONS
  coupon_id

PRODUCT_GROUPS
  group_id

ITEM_LIST
  item_id

ITEM_GROUP_ASSOC
  item_id, group_id

COUPON_GROUP_ASSOC
  coupon_id, group_id 

COUPON_ITEM_ASSOC
  coupon_id, item_id 
```

在`COUPON_ITEM_ASSOC`表格中，有一个字段表示优惠券一次可以应用多少个项目，一些特殊值表示“无限”。

# javascript - 将 SRC 属性替换为 LI 标记中的 TITLE

> ID：226071
> 
> 赞同：-2
> 
> 时间：2008-10-22T14:48:19.697
> 
> 标签：javascript, html

我有下面给出的HTML：

```
<ul id="thumbsPhotos">
     <li src="/images/1alvaston-hall-relaxing-lg.jpg"  onclick="updatePhoto (this.title)"><img src="/images/1alvaston-hall-relaxing-sl.jpg"  width="56" height="56"></li>
     <li onclick="updatePhoto(this.title)" src=""><img src="" width="56"  height="56"></li>
     <li onclick="updatePhoto(this.title)" src=""><img src="" width="56"  height="56"></li>
</ul> 
```

现在，我想用 .in 替换所有`src`不在标签`<li>`中的标签。有了这个，我的输出将是：`<img>``InnerHTML`

```
<ul id="thumbsPhotos">
     <li title="/images/1alvaston-hall-relaxing-lg.jpg"  onclick="updatePhoto(this.title)"><img src="/images/1alvaston-hall-relaxing-sl.jpg"  width="56" height="56"></li>
     <li onclick="updatePhoto(this.title)" title=""><img src="" width="56" height="56"></li>
     <li onclick="updatePhoto(this.title)" title=""><img src="" width="56" height="56"></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T14:55:01.713

未经测试，但这里有一个正则表达式可能会为你做......

```
// find:
<li ([^>]*)src="(.*?)"(.*?)>

// replace:
<li $1title="$2"$3> 
```

**更新**：经过测试，它适用于您的示例。

如果您想使用 Javascript 在客户端运行它（无论出于什么奇怪的原因），您可以这样做：

```
var ul = document.getElementById("thumbsPhotos");
ul.innerHTML = ul.innerHTML.replace(
    /<li ([^>]*)src="(.*?)"(.*?)>/g,
    '<li $1title="$2"$3>'
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T14:54:49.420

不是答案，但这不是一种非常语义化的做事方式。这是从哪里来的？为什么 li 元素上有一个 src ？

假设你想要一个 javascript 选项，你可以使用类似 jquery 的东西来做：

```
$(document).ready(function() {
    $("li[src], li[src='']").each(function() {
        var li = $(this);
        li.attr("title", li.attr("src"));
        li.removeAttr("src");
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T14:54:21.993

您很可能使用与 src 属性匹配的 RegEx 替换并进行转换。我看到即使没有匹配项，您也想添加 title 属性，这也应该是可能的。

我将尝试为此挖掘一些 RegEx 示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T15:02:17.767

如果您需要这样做一次会不会只是查找和替换工作？

否则我同意正则表达式是最好的选择。

# javascript - JavaScript 函数“按父类获取元素”并分配

> ID：226088
> 
> 赞同：0
> 
> 时间：2008-10-22T14:52:33.637
> 
> 标签：javascript, html, css

我的困境相当简单：这个`id`函数`<li>`根据`id`. `<ul>`它过去可以正常工作，但现在不行了，我要么需要`<ul>`使用`class`es 而不是`id`同时仍然能够将`id`“当前”分配给当前元素，要么更改我的 css。

```
function myFunction(element) {
  liArray = document.getElementById("leftlist").childNodes;
  i = 0;
  while (liArray[i]) {
    liArray[i].id = "";
    i++;
  }
  element.id = "current"; // or element.className  ?
}
```

```
ul#leftlist {
  background-color: rgb(205, 205, 205);
}

ul#leftlist li#current a {
  color: rgb(96, 176, 255);
  background-color: 218, 218, 218);
}

ul#leftlist li a {
  color: rgb(86, 86, 86);
}

#leftlist a:link {
  color: rgb(86, 86, 86);
  background-color: #ddd;
}

#leftlist a:active {
  color: rgb(96, 176, 255);
  background-color: rgb(218, 218, 218);
}
```

```
<ul id="leftlist">
  <li onClick='myFunction(this);'>
    <a href="123" bla bla </a></li>
  <li onClick='myFunction(this);'> .... etc.</li>
</ul>
```

也许我需要改变我的CSS。这以前有效，但现在即使我通过 JavaScript分配，电流`id`也没有优先权。`ul#leftlist li a``id="current"`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T15:06:56.447

您应该将类​​用于“当前”之类的东西，而不是 id。id 通常不应该改变，并且“current”不是一个很好的 id，因为你可以在一个页面上以某种方式拥有一堆“当前”的东西。如果您需要一些 css 样式来覆盖另一个，您可以使用 !important 强制它：

```
ul#leftlist li.current a {
  color: rgb(96,176,255) !important;
  background-color:218,218,218) !important;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T15:06:31.720

我建议你使用 jQuery 框架。它将为您的 DOM 提供一个很好的抽象，并使您更容易在 DOM 中查找对象并将事件分配给这些对象。

尝试在[jQuery.com上阅读](http://www.jquery.com)[本教程](http://docs.jquery.com/Tutorials:Getting_Started_with_jQuery)。我相信它会让你大吃一惊:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T15:10:15.520

看起来您确实需要在 css 中更改一行：

```
ul#leftlist li#current  a{color: rgb(96,176,255);  background-color:218,218,218);} 
```

它缺少`rgb(`之后`background-color`，应该看起来像：

```
ul#leftlist li#current  a{color: rgb(96,176,255);  background-color: rgb(218,218,218);} 
```

我也同意 Erlend，`current`会更适合上课。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T15:11:00.400

函数变为：

```
function myFunction(element){
  var liArray = document.getElementById("leftlist").childNodes;
  var i=0, item;
  while (item = liArray[i++]) {
    if (item.nodeType === 1) {
      item.className = item.className.replace(/(^| )current( |$)/g, '');
    }
  }
  element.className += " current";
} 
```

CSS 也需要更改类：

```
ul#leftlist li.current a { ... } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T15:13:15.293

您是否以某种方式进行更改，以便最终得到多个具有相同 id 的元素？-)

这显然与整个想法背道而驰，使用 id 在 html 文档的上下文中它们必须是完全唯一的......

-- 首先，你应该确保你只处理你的 li 元素：

```
liArray=element.parentNode.getElementsByTagName("li"); 
```

其次，这可能是一个想法，通过在选择器中设置更多内容来确保您的选择器具有更高的优先级：

如果您在标签上使用内联样式属性，则会获得最高优先级，但这在这里似乎没有任何用处。

ID 给予高优先级，类给予公平优先级，元素和伪选择器给予低优先级......

然而，每种类型的优先级都是累积的，通过这种方式，您可以通过在一个选择器前面加上另一个具有相同优先级类型的选择器来赋予它非常高的优先级：

`ul#leftlist`高优先级 1 分，低优先级 1 分

`#myParent ul#leftlist`高优先级 2 分，低优先级 1 分

`.myParent ul#leftlist`高优先级 1 分，一般优先级 1 分，低优先级 1 分

因此，您可以区分样式表中选择器的优先级！-)

# javascript - Internet Explorer 上的“第 0 行堆栈溢出”

> ID：226102
> 
> 赞同：38
> 
> 时间：2008-10-22T14:55:21.837
> 
> 标签：javascript, internet-explorer, error-handling

我意识到这不是在可搜索性方面询问这个问题的理想场所，但是当我在 Internet Explorer 中查看它时，我有一个页面的 JavaScript 代码会引发“第 0 行中的堆栈溢出”错误。

很明显，问题不在第 0 行，而是在我正在写入文档的内容列表中的某个位置。在 Firefox 中一切正常，所以我没有 Firebug 和朋友的乐趣来协助故障排除。

这有什么标准原因吗？我猜这可能是 Internet Explorer 7 的错误或相当模糊的东西，而我的[Google-fu](http://en.wiktionary.org/wiki/Google-fu)目前给我带来的乐趣很少。我可以找到很多以前遇到过这个问题的人，但我似乎无法找到他们是如何解决的。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2010-03-02T18:02:46.300

我最近遇到了这个问题，并写了一篇关于我们代码中导致这个问题的特殊情况的帖子。

[http://cappuccino.org/discuss/2010/03/01/internet-explorer-global-variables-and-stack-overflows/](http://cappuccino.org/discuss/2010/03/01/internet-explorer-global-variables-and-stack-overflows/)

快速总结是：通过宿主全局对象的递归限制为 13 的堆栈深度。换句话说，如果您的函数调用使用的引用（不一定是函数本身）是用某种形式定义的 window.foo =函数，然后通过 foo 递归被限制在 13 的深度。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-22T15:56:56.237

啊哈！

`OnError()`如果找不到，我在某些代码中有一个事件，它将图像源设置为默认图像路径。当然，如果没有找到默认的图像路径，它会触发错误处理程序......

对于有类似问题但不一样的人，我猜这很可能是一个未终止的循环，一个触发自身的事件处理程序或类似的东西，使 JavaScript 引擎陷入困境。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-22T14:57:46.480

您可以关闭*Internet*`"Disable Script Debugging"` Explorer中的选项并开始调试，`Visual Studio`如果您碰巧有它的话。

我发现这是诊断其中一些`IE`特定问题的少数方法之一。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-12-01T12:56:32.247

我遇到了这个问题，我解决了。`<%@ Page`标签中有一个名为的属性，`MaintainScrollPositionOnPostback`删除它后，错误消失了。我之前添加了它以防止每次回发后滚动。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-03-02T15:40:26.280

如果你来这里是因为你在硒测试中遇到了问题：IE 不喜欢`By.id("xyz")`. 使用 By.name、xpath 或其他替代方式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-05-13T17:33:22.353

也有 smartNavigation="true" 导致这个“

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-02-04T19:17:19.033

我设置了一个默认项目，发现以下内容：

问题是 smartNavigation 和 maintainScrollPositionOnPostBack 的**组合**。仅当两者都设置为 true 时才会发生错误。

就我而言，错误是由以下原因产生的：

```
<pages smartNavigation="true" maintainScrollPositionOnPostBack="true" /> 
```

任何其他组合都可以正常工作。

有人可以证实这一点吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-12-10T18:12:03.390

1.  互联网选项
2.  工具
3.  互联网选项
4.  先进的
5.  导航部分
6.  单击 > 禁用脚本调试

    > 显示有关每个脚本错误的通知

7.  登入
8.  你会微笑！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-01-22T00:39:57.153

我的是“在第 1 行”，但是...

我在使用 jQuery 的`.clone`方法时遇到了这个问题。我通过使用从 html 字符串制作 jQuery 对象来替换这些：`$($(selector).html())`.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-10-25T10:01:40.010

我在 IE8 上重现了同样的错误。其中一个文本框有一些事件处理程序来替换无效数据。

```
$('.numbersonly').on("keyup input propertychange", function () {
    //code
}); 
```

向此文本框输入数据时显示错误消息。我们从上面的代码中删除了事件“propertychange”，现在它可以正常工作了。

PS也许它会帮助某人

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-01-27T06:04:03.633

我不知道该告诉你什么，但是 jQuery 表排序和搜索也出现了同样的问题。当表中没有任何内容时，例如您正在搜索字符串时，您也会收到此错误。即使在 Google Analytics 中，这个错误也经常发生。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-12-20T19:48:46.323

就我而言，我有两个函数`a()`和`b()`. 第一个是调用第二个，第二个是调用第一个：

```
var i = 0;
function a() { b(); }
function b() {
  i++; 
  if (i < 30) {
    a();
  }
}

a(); 
```

我使用以下方法解决了这个问题`setTimeout`：

```
var i = 0;
function a() { b(); }
function b() {
  i++; 
  if (i < 30) {
    setTimeout( function() {
      a();
    }, 0);
  }
}

a(); 
```

* * *

## 回答 #13

> 赞同：-16
> 
> 时间：2010-08-10T14:09:39.257

这是 Java 和 Flash Player 的问题。安装最新的Java和Flash Player，问题就解决了。如果没有，请安装 Mozilla Firefox，它会自动安装所需的更新。

# windows - 如何打印 XPS 文件？

> ID：226103
> 
> 赞同：5
> 
> 时间：2008-10-22T14:55:35.033
> 
> 标签：windows, printing, xps

我的打印机用完了黑色碳粉，而且我没有备用碳粉，所以我认为现在最好将文档“打印”为 .XPS 文件，然后在新碳粉到货时打印它们。

所以，现在我有了碳粉，但我不知道如何打印文件。我[在 Tim Barcz 的博客上发现了这篇很棒的帖子，](http://www.timbarcz.com/blog/HowToPrintXPSDocumentsEasyAs11a1aI233a45.aspx)这似乎表明我并不孤单。

我可以打开它们并在 IE 中查看它们，但如果我尝试打印它们，它要么完全忽略命令，要么崩溃。

我从 Microsoft 网站下载了 XPS Essentials Pack 并尝试安装它，但它拒绝安装并不断崩溃并显示十页错误消息。具有讽刺意味的是，我通常会打印此消息来处理它。

我的“解决方案”是在 IE 中打开 .XPS 文件，然后将它们截屏并粘贴到 Paint Shop Pro 中，这样我就可以将它们打印为图形。

正如 Tim Barcz 在他的帖子中所说，我链接到：

> 就是这样……简单。我不明白为什么人们如此害怕接受新技术？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T19:44:07.490

打印 XPS 的简短答案是使用“Microsoft XPS Document Writer”。

当您在系统上安装 Essentials Pack/XPS Viewer 时，将安装此“打印机”。恕我直言，最好安装前者。请注意，MS 曾经将 EP 从 RC 升级到 1.0。因此，您遇到的问题可能是使用较旧的 EP 之一。现在，下载和安装较新的 EP（即 EP 1.0）并不总是有效。在这种情况下，最安全的选择是手动卸载 EP RC Pack，然后安装 EP 1.0。

另外，请记住，您可能必须卸载/升级已安装的 .NET 运行时（或重新安装）。哦，还有 MS XPSDW（我前面提到的打印机，还记得吗？）需要 MS Core XML Services 6.0 才能工作。但是，快速回顾一下 MS 的网站 ( [http://www.microsoft.com/downloads/details.aspx?familyid=993C0BCF-3BCF-4009-BE21-27E85E1857B1&displaylang=en#Requirements](http://www.microsoft.com/downloads/details.aspx?familyid=993C0BCF-3BCF-4009-BE21-27E85E1857B1&displaylang=en#Requirements) ) 告诉我们，最高支持 XP SP2。请与 MS 联系以了解是否也支持 SP3。

如果您设法以某种方式解决所有这些问题，您会想要查看您触发的打印的输出。我的浏览器上有 IE-tab 扩展，我使用它打开所有 XPS 文件。不过最近听说Pagemark出了个ff插件来查看XPS文件。您可能想检查一下 ( [http://www.pagemarktechnology.com/home/xps-test.html](http://www.pagemarktechnology.com/home/xps-test.html) )。

当然，请查看 Wikipedia ( [http://en.wikipedia.org/wiki/XML_Paper_Specification](http://en.wikipedia.org/wiki/XML_Paper_Specification) )！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T15:00:29.360

我从 IE 打印 XPS 文档没有问题。首先想到的是您正在运行什么操作系统、IE 的版本、是否安装了所有服务包等？

另一种选择是将 XPS 文件复制到拇指驱动器（或通过网络发送）并从另一台没有任何问题的计算机上打印。

编辑：

跟进问题...您可以打印非 XPS 文档吗？您是否重新启动了打印机？你的打印后台处理程序搞砸了吗？

我遇到过很多由于打印作业阻塞后台处理程序而无法打印的情况。重新启动后台处理程序或重新启动您的 PC 通常会解决此问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T03:49:31.100

IE 在将 XPS 文件打印到网络打印机时出现问题，这是网络打印机吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-14T04:27:43.100

网络上到处都有 XPS 到 JPG/JPEG 转换器，选择一个；/

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-03T13:14:43.323

如果您不想打印到 XPS，请选择另一台打印机作为默认打印机，如先前注释所示。此外，XPS 打印机似乎在页边距或页面大小方面存在问题（某些信息在 A4 之外或太靠近边框而无法打印）。

否则，在 IE9 中打开 XPS 文件时，“文件>打印”菜单选项将被禁用。但您可以使用键盘快捷键：Ctrl+P

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-16T15:04:40.190

XPS Essentials 包我也遇到了很大的问题。

经过大量的研究和调试，我发现XPS的安装不知何故损坏了，只是报废并重新安装了整台计算机。

之后 XPS 所做的一切都像魅力一样工作。

所以我的猜测是：你的 XPS 安装有问题。修复：重新安装。解决方法：从其他计算机打印。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-11T16:38:19.727

在充分尊重其他答案的情况下，我相信您忽略了最可能的原因和最简单的解决方案。最可能的原因是此人的默认浏览器不是 Internet Explorer。这种情况下的解决方案是打开 IE 并输入 xps 文件的地址（例如，C:\Users\Public\Documents\EVIDENCE\groupon.xps

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-22T15:09:17.517

Windows XP SP3，IE6，全部是最新的 AFAIK。

我主要使用 Firefox，所以很久没有更新 IE。也许IE7会更成功。

关键是 XPS 意味着某种 PDF 杀手，但不同之处在于 PDF 可以正常工作，而 XPS 是一场灾难。我不介意错误，但我希望它告诉我出了什么问题，而不仅仅是说它不起作用，因为我可以从打印机输出的页面不足中看出这一点。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-06-18T01:12:00.347

我的回答：任何时候你需要诉诸“步骤”来解决通常以任何其他格式“正常工作”的问题，根据定义，你已经超越了“正常工作”到你需要做某事的地方'只是工作'。

# java - 使用 dom4j 从流中读取单个 XML 文档

> ID：226105
> 
> 赞同：2
> 
> 时间：2008-10-22T14:56:00.680
> 
> 标签：java, xml, stream, sax, dom4j

我正在尝试使用 dom4j 一次从流中读取单个 XML 文档，对其进行处理，然后继续处理流中的下一个文档。不幸的是，dom4j 的 SAXReader（在幕后使用 JAXP）一直在读取并阻塞在下面的文档元素上。

有没有办法让 SAXReader 在找到文档元素的结尾后停止读取流？有没有更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T22:13:03.537

我能够使用一些内部 JAXP 类使其与一些体操一起工作：

*   创建自定义扫描仪，XMLNSDocumentScannerImpl 的子类
    *   在自定义扫描程序中创建自定义驱动程序，即 XMLNSDocumentScannerImpl.Driver 的实现，当它看到声明或元素时返回 END_DOCUMENT。从 fElementScanner.getCurrentEntity() 获取 ScannedEntity。如果实体有 PushbackReader，则将实体缓冲区中剩余的未读字符推回阅读器。
    *   在构造函数中，将 fTrailingMiscDriver 替换为此自定义驱动程序的实例。
*   创建一个自定义配置类，它是 XIncludeAwareParserConfiguration 的子类，它在其构造函数中用此自定义扫描器的实例替换库存 DOCUMENT_SCANNER。
*   将此自定义配置类的实例安装为“com.sun.org.apache.xerces.internal.xni.parser.XMLParserConfiguration”属性，以便在 dom4j 的 SAXReader 类尝试创建 JAXP XMLReader 时将其实例化。
*   将 Reader 传递给 dom4j 的 SAXReader.read() 方法时，提供一个 PushbackReader 的缓冲区大小远大于一个字符的默认值。至少 8192 应该足以支持 JAXP 的 Apache2 副本中 XMLEntityManager 的默认缓冲区大小。

这不是最干净的解决方案，因为它涉及子类化内部 JAXP 类，但它确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T19:28:14.297

最有可能的是，您不希望在同一流中同时拥有多个文档。我不认为 SAXReader 足够聪明，不会在它到达第一个文档的末尾时停止。为什么有必要像这样在同一个流中有多个文档？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T21:37:17.033

我认为您必须添加一个适配器，用于包装流并让该东西在看到下一个文档的开头时返回文件结尾。据我所知，所写的解析器会一直运行到文件末尾或出现错误……看到另一个`<?xml version="1.0"?>`肯定是错误的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-27T23:53:48.870

假设您首先负责将文档放入流中，应该很容易以某种方式分隔文档。例如：

```
// 任何对 XML 字符无效的值都可以。
静态最终字符 DOC_TERMINATOR=4;

BOOL addDocumentToStream(BufferedWriter streamOut, char xmlData[])
{
  streamOut.write(xmlData);
  streamOut.write(DOC_TERMINATOR);
}

```

然后在从流中读取时读入一个数组，直到遇到 DOC_TERMINATOR。

```
char *getNextDocuument(BufferedReader streamIn)
{
  StringBuffer 缓冲区 = new StringBuffer();
  整数字符；

  而（真）
  {
    字符 = streamIn.read();
    如果（字符 == DOC_TERMINATOR）
      休息;

    buffer.append(字符);
  }
  返回缓冲区.toString().toCharArray();
}

```

由于 4 是一个无效的字符值，除非您明确添加它，否则您不会遇到。从而允许您拆分文档。现在只需将生成的 char 数组包装为 SAX 的输入就可以了。

```
...
  XMLReader xmlReader = XMLReaderFactory.createXMLReader();
...
  而（真）
  {
    char xmlDoc = getNextDocument(streamIn);

    如果（xmlDoc.length == 0）
      休息;

    InputSource saxInputSource = new InputSource(new CharArrayReader(xmlDoc));
    xmlReader.parse(saxInputSource);
  }
...

```

请注意，循环在获得长度为 0 的文档时终止。这意味着您应该在最后一个文档之后添加第二个 DOC_TERMINATOR，您需要在 getNextDocument() 中添加一些内容以检测流的结尾。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-29T01:14:54.527

我之前通过将基本阅读器与我自己创建的具有非常简单的解析能力的另一个阅读器包装在一起来做到这一点。假设您知道文档的结束标记，包装器会简单地解析匹配项，例如“</MyDocument>”。当它检测到它返回 EOF 时。通过解析第一个开始标记并在匹配的结束标记上返回 EOF，可以使包装器具有自适应性。我发现实际上没有必要检测结束标签的级别，因为我没有在其自身中使用过文档标签，因此可以保证第一次出现的结束标签结束了文档。

我记得，其中一个技巧是让包装块 close()，因为 DOM 阅读器关闭了输入源。

因此，给定读者输入，您的代码*可能*如下所示：

```
SubdocReader sdr=new SubdocReader(input);
while(!sdr.eof()) {
    sdr.next();
    // read doc here using DOM
    // then process document
    }
input.close(); 
```

如果遇到 EOF，则 eof() 方法返回 true。next() 方法标记读取器停止为 read() 返回 -1。

希望这会为您指明一个有用的方向。

- 猕猴桃。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T02:28:56.817

我会将输入流读入内部缓冲区。根据预期的总流大小，我要么读取整个流，然后解析它，要么检测一个 xml 和下一个 xml 之间的边界（查找

处理具有一个 xml 的流和具有多个 xml 的流之间唯一真正的区别是缓冲区和拆分逻辑。

# web-services - 什么是简单英语的“网络服务”？

> ID：226108
> 
> 赞同：188
> 
> 时间：2008-10-22T14:56:40.803
> 
> 标签：web-services

我一直在 SO、Wikipedia、Google 等网站上阅读“网络服务”，但我不太明白它们是什么。什么是简单的英语定义/描述？

如果我使用 PHP 制作一个简单的网站，比如说，在页面上打印一个随机整数......这是一个“网络服务”吗？如果不是，为什么不呢？

* * *

## 回答 #1

> 赞同：289
> 
> 时间：2008-10-22T15:03:34.770

一个简单的定义：Web 服务是其他程序可以通过 Web (HTTP) 访问的功能。

例如，当您在 PHP 中创建一个输出 HTML 的网站时，它的目标是*浏览器*，并且通过扩展，人类在浏览器中阅读页面。Web 服务不是针对人类，而是针对其他程序。

因此，如果生成随机整数的 PHP 站点以其他程序可能使用的格式输出整数，则它可能是 Web 服务。它可能是 XML 格式或其他格式，只要其他程序可以理解输出即可。

完整的定义显然更复杂，但您要求的是简单的英语。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-10-22T15:03:31.790

简化的非技术性解释：网络服务允许程序与网页对话，而不是使用浏览器打开网页。

示例：我可以访问 maps.google.com，输入我的家庭地址，然后在浏览器中查看我居住地的地图。

但是，如果你正在编写一个计算机程序，你想获取一个地址并显示一张漂亮的地图，就像谷歌地图一样？

好吧，您可以从头开始编写一个全新的地图程序，或者您可以调用 Google 地图提供的 Web 服务，将地址发送给它，它会返回该位置的图形地图，您可以在程序中显示该地图。

它还有更多内容，正如其他一些帖子所涉及的那样，但结果是它允许您的应用程序从某个资源中检索信息或将信息提交到某个资源。其他一些例子：

1.  您可以使用网络服务在 Amazon.com 上检索有关书籍的信息
2.  您可以使用类似的网络服务向 Amazon.com 提交订单
3.  您可以创建一个 Web 服务以允许外部应用程序了解您公司内的产品信息
4.  您可以创建一个 Web 服务以允许外部应用程序向您的公司提交订单。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-10-22T15:00:36.070

是的，这是一个简单的 Web 服务。

Web 服务实际上只不过是一种允许客户端远程访问/修改数据的请求/响应机制。Web 服务（SOAP、SOA 等）有正式的标准，但您的简单页面也是一种服务。

将其打印到页面的主要缺点是您的服务将返回 HTML。首选的数据格式是 JSON 和 XML，因为大多数客户端框架（和服务器框架）都是围绕使用 JSON 和 XML 设计的。

因此，如果您修改了服务以返回：

```
<RANDOM>some random number</RANDOM> 
```

而不是：

```
<HEAD>...</HEAD>  
<BODY>some random number</BODY> 
```

那么它对大多数客户会更有用

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2008-10-22T15:00:42.823

简而言之，Web 服务是通过 http 协议将数据作为服务提供的东西。当然，情况并非总是如此......但它很接近。

标准 Web 服务使用 SOAP 协议，它定义了消息的通信和结构，而 XML 是数据格式。

Web 服务旨在允许使用不同技术构建的应用程序可以毫无问题地相互通信。

Web 服务的示例包括 Weather.com 提供可在您的网站上使用的天气信息，或 UPS 提供请求运输报价或跟踪包裹的方法。

**编辑**

更改了关于 SOAP 的措辞，因为它并不总是像我提到的那样是 SOAP，但想让它更清楚。关键是将数据作为服务提供，而不是 UI 元素。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-22T15:02:35.830

Web 服务与网站的不同之处在于，Web 服务提供可由软件而不是人类使用的信息。因此，我们通常谈论公开的[JSON](http://www.json.org)、XML 或 SOAP 服务。

Web 服务是“mashup”中的关键组件。混搭是将来自许多网站的信息自动聚合到新的有用服务中。例如，有些网站将 Google 地图与警方报告的相关信息汇总在一起，以便为您提供您所在地区犯罪的图形表示。另一种类型的混搭是获取另一个站点提供的真实股票数据，并将其与虚假交易应用程序结合起来，创建一个股票市场“游戏”。

Web 服务还用于提供新闻（参见 RSS）、添加到站点的最新项目、新产品信息、播客和其他使现代 Web 转向的重要功能。

希望这可以帮助！

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2008-10-24T10:19:35.060

最好的简单英语解释来自使用类比：

*   网页允许人们相互交流和协作。
*   Web 服务允许程序相互通信和协作。

根据该定义，您的 PHP 示例是一个 Web 服务，因为输出可能会被另一个程序使用。但实际上，HTML 屏幕抓取并不是一种可靠或可维护的生成 Web 服务的方式。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-10-22T15:16:28.877

对于大多数网站，您在使用浏览器时都会访问 HTML 页面。这些是人类可读的页面（一旦在您的浏览器中呈现），其中大量数据可能挤在一起，因为它对人类有意义。

现在想象一下其他人想要使用其中的一些数据。他们可以下载您的页面并开始过滤掉所有“噪音”以获取他们想要的数据，但是大多数网站的构建方式并不是100％确定所有元素的数据都放在同一个位置，所以另外变得麻烦它也变得不可靠。

输入网络服务。

网络服务是网站选择提供给那些希望从您的网站读取、更新和/或删除数据的人的服务。您可以将其称为数据的“后门”。它不是将数据呈现为网页的一部分，而是以预先确定的方式提供，其中一些更流行的是 XML 和 JSON。有几种方法可以与 Web 服务通信，一些使用 SOAP，另一些使用 REST'ful Web 服务等。

所有 Web 服务的共同点是，它们是网站提供的网页的机器可读等价物。这意味着希望使用数据的其他人可以发送请求以获取某些易于解析和使用的数据。有些网站可能会要求您在请求中提供用户名/密码以获取敏感数据，而其他网站则允许任何人提取他们可能需要的任何数据。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2015-01-18T18:52:05.573

Web 服务是用于在应用程序或系统之间交换数据的开放协议和标准的集合。以各种编程语言编写并在各种平台上运行的软件应用程序可以使用 Web 服务通过计算机网络（如 Internet）以类似于单台计算机上的进程间通信的方式交换数据。这种互操作性（例如，Java 和 Python，或 Windows 和 Linux 应用程序之间）是由于使用了开放标准（XML、SOAP、HTTP）。

所有标准 Web 服务都使用以下组件工作：

*   SOAP（简单对象访问协议）
*   UDDI（通用描述、发现和集成）
*   WSDL（网络服务描述语言）

它的工作原理有点像这样：

*   客户端程序将帐户注册信息捆绑到 SOAP 消息中。
*   此 SOAP 消息作为 HTTP POST 请求的主体发送到 Web 服务。
*   Web 服务解包 SOAP 请求并将其转换为应用程序可以理解的命令。
*   应用程序根据需要处理信息，并以该客户的新唯一帐号作为响应。
*   接下来，Web 服务将响应打包到另一个 SOAP 消息中，该消息发送回客户端程序以响应其 HTTP 请求。
*   客户端程序解包 SOAP 消息以获取帐户注册过程的结果。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2013-07-10T04:38:46.810

**`Simple way to explain web service is ::`**

*   *Web 服务是通过万维网在两个电子设备之间进行通信的一种方法。*
*   *它可以称为程序员用来与服务器通信的进程*
*   *要调用此过程，程序员可以使用 SOAP 等*
*   Web 服务建立在 TCP/IP、HTTP 等开放标准之上

* * *

> *Web 服务的优势在于，假设您在 .net 中开发了一段代码，并且您希望使用 JAVA 来使用此代码。您可以直接与抽象层进行交互，并且不知道使用什么技术来开发代码。*

* * *

![图片](https://i.stack.imgur.com/SkLag.gif)

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2015-08-27T06:09:29.123

Webservice 是一种技术，两个或多个远程 Web 应用程序通过该技术通过网络/互联网相互交互。它可以使用 Java、.net、PHP 等来实现。

**网络服务的特点：-**

1.  使用 Web 服务，两个或多个系统通过网络交换数据。使用 XML 或 JSON 交换数据。
2.  任何 Web 服务都有两个部分：部署服务的服务器端和客户端访问服务的客户端部分。任何 Web 服务都可以有多个客户端。当一个旅游门户网站正在销售航班机票时。门户是客户端，航空公司是服务器，因为它正在销售其服务。
3.  Web 服务可以是同步的，也可以是异步的。一个 Web 应用程序可以与许多[Web 服务](http://www.tutorialscorner.com/webservice/What-is-webservice.html)交互，但这些 Web 服务与其客户端 Web 应用程序是松散耦合的。这意味着父应用程序中的任何更改对 Web 服务几乎没有影响，反之亦然。
4.  Web 服务也可以通过其 XML 有效负载携带附件文档，如 PDF、Word 等。Java 为这种类型的 Web 服务提供了单独的 API。
5.  Web 服务总是向其客户隐藏服务的内部复杂性。例如，通过第三方门户网站销售机票的航空公司仅通过 Web 服务收集最终用户信息，作为回报，它提供机票。销售机票的门户网站不必担心航空公司机票预订系统的内部复杂性。
6.  Web 服务可以是fire and forget 类型，也可以返回一些东西。假设，一个 Web 应用程序只想向第三方应用程序发送一些信息。发送者不需要接收者的任何确认。在这种类型的场景中，我们需要一种“一劳永逸”的 Web 服务。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-10-22T15:01:22.107

软件开发人员使用的 Web 服务通常是指在远程服务器上执行并使用 XML/SOAP 规范调用的操作。与所有定义一样，它也有细微差别，但这是该术语最常见的用法。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-10-22T15:04:33.113

操作系统提供了可以与之交互的 GUI（和 CLI）。它还提供了一个 API，您可以通过编程方式与之交互。

类似地，网站提供您可以与之交互的 HTML 页面，也可能提供以编程方式提供相同信息和操作的 API。或者这些服务可能只能通过没有关联用户界面的 API 提供。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2016-01-09T20:08:38.597

好，

正如@Vincent Ramdhanie 所说，Web 服务不应该被最终用户看到/消费，而是另一个程序。因此，从技术上讲，您程序中的逻辑将是：

在作为正常程序的情况下

```
user on website -> HTML/JS/JQuery etc -> give me a random number ->ur program 
```

现在

`ur program -> generate random number -> generate HTML and encapsulate o/p -> go back to user`

但在 Web 服务的情况下，流程会发生一些变化：

`user -> my application -> XML/JSON/some other format -> give me a random number ->ur program` 现在

`ur program -> generate random number -> generate XML/JSON/some other format -> my application -> generate HTML and encapsulate o/p -> go back to user`

希望这可以帮助 ：）

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-22T15:00:41.763

一个简单的定义是一个 HTTP 请求，它就像一个普通的方法调用；即，它接受参数并返回可以反序列化为对象的结构化结果，通常是 XML。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-22T15:04:02.380

Web 服务几乎就像普通的网页一样。不同之处在于它们的格式使程序可以很容易地从页面中提取数据，甚至可能不使用任何 HTML。它们通常在格式的一致性方面也更可靠，可以使用不同的正式流程来定义内容，例如肥皂或原始 xml，并且通常还有一个描述符文档，正式定义数据的结构。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2010-08-05T02:53:28.737

一种发送消息以调用另一台计算机上的操作的方式。Web 服务与以前的方法之间的区别在于，通过网络发送的内容在更高级别上进行了标准化。

旧方式：描述字节序、编码、端口号等 Web 服务：URL、XML

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2015-07-07T15:39:22.497

Web Service 就像是两个不相关的程序之间的通信媒介。这些程序使用指定的协议（通常是**简单对象访问协议 (SOAP)**）作为媒介来了解它们要在各自的端处理/执行的请求/响应。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-10-22T15:02:21.917

Web 服务定义了服务器将为您执行的操作合同。格式和协议并不重要，但您应该对通信的发生方式有一些定义。

在您的示例中，这取决于是否正在另一个读取该数字的应用程序中使用它，是的，它是服务，否则，它只是一个带有数字的网页。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-06-07T10:23:50.237

简单来说，Web 服务可以是任何简单的程序，例如：添加两个数字，它们应该通过 UDDI 发布并且可以被另一个程序使用。WSDL 将具有定位 Web 服务的端点以及绑定和端口详细信息。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-02-22T07:25:40.290

“Web Service”由“Web”和“Service”两个词组成。
什么是“网络”？“网络”是指“万维网”。
“服务”是为了什么？不适用于人类，如果是这样，它是“网页”，例如文本、图像、视频等。
它是用于程序通过 Internet 使用与“Web”相同的技术进行通信，例如 TCP、HTTP 等。
“服务”也意味着它提供了一些功能，例如 CRUD 中的“服务层”。主要有两种：
1\. SOAP(Simple Object Access Protocol)
2\. RESTful(Representational state transfer)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-06-06T21:28:52.350

在不影响其他定义的情况下，我会说 Web 服务是允许通过网络进行可互操作的机器对机器/应用程序对应用程序交互的软件系统。这种通用定义还有助于将 REST 架构视为一种 Web 服务，因为它们提供了类似的功能，尽管它是一种不同于完全定义协议的 SOAP 的架构风格。

# c# - Linq to SQL DataContext 的多个/单个实例

> ID：226127
> 
> 赞同：32
> 
> 时间：2008-10-22T15:00:32.933
> 
> 标签：c#, linq-to-sql

我有一个项目，其中有许多不同的类查询和修改一组通用表中的数据。我已经建立了一个 .dbml 文件，它为我们提供了一个 DataContext 类。我的问题是 DataContext 的单个实例是否应该被所有对象使用，或者多个实例是否可以安全使用。我还想知道在单个 DataContext 的情况下的线程安全性，以及是否应该同步对其方法的访问。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-22T16:00:35.607

Rick Strahl 有一篇关于您的选择的好文章：[http](http://www.west-wind.com/weblog/posts/246222.aspx) ://www.west-wind.com/weblog/posts/246222.aspx 。

另请参阅：[LINQ to SQL - 您的 DataContext 位于何处？](https://stackoverflow.com/questions/196253/linq-to-sql-where-does-your-datacontext-live).

您可能希望为每种类型的部署采用稍微不同的策略 - Web、桌面、Windows 服务......

总而言之，您的选择是：

*   Global DataContext - 在多线程环境（包括 Web 应用程序）中很危险。请记住，不能保证实例成员是线程安全的（来自 Bradley Grainger 的上述[回答](https://stackoverflow.com/questions/196253/linq-to-sql-where-does-your-datacontext-live#196264)）。
*   每个线程的 DataContext - 复杂。如果您的 DataContext 正在跟踪更改，您必须确保在适当的时间刷新它们。实例化、存储和检索 DataContext 是一件很痛苦的事情。
*   每个原子操作的 DataContext - 您将失去跟踪更改的能力，因为一个 DataContext 创建一个对象，而另一个 DataContext 更新或删除它。将数据对象附加到新的 DataContext 可能不会像您期望的那样工作。
*   每个数据对象的 DataContext - 似乎不优雅，因为您必须在实例化（创建和附加）和更新/删除（将其从数据对象中拉出并使用它）时对 DataContext 大惊小怪。

我为每个数据对象选择了一个 DataContext。它可能不是最好的解决方案，但它适用于所有部署环境。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-23T11:16:40.513

我为每个事务使用一个新的 DataContext 实例。

重用旧实例可能很麻烦，并且会使 DataContext 的内容膨胀，因为必须跟踪在某个时间加载的任何项目 - 您的应用程序将变得越来越慢，从而导致内存膨胀。

如果您需要一个比事务更长的项目，您可以通过克隆该项目将其从 DataContext 中分离出来，然后可以使用 Attach() 将其重新附加到一个新的 DataContext 中。
我什至可以克隆一个项目，使用 WCF 通过网络发送它，在稍后的调用中将其取回，将其附加到新的 DataContext 并保存更改（当然我需要一个时间戳列）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-22T15:27:58.090

DataContext 类足够轻量级，您可以一遍又一遍地实例化它。当在单个方法中访问实体对象时，这使得事情变得更简单。如果您需要从不同的类和方法访问相同的 LINQ 对象，同时将它们附加到 DataContext 以进行跟踪，也可以保留单个实例。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-22T15:19:56.577

使用单个数据上下文对象的问题在于，如果您向其队列添加了一些更改，并且只想对*其中一些*排队的更改进行回滚，您可能会遇到麻烦。

这就是我为每个类使用数据上下文对象的原因——我的`User`类有它自己的数据上下文，我的`Application`类有它自己的，等等。

这种模式消除了在我的项目中进行回滚的大部分麻烦。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-10-22T15:09:06.550

我一直听说您应该使用 DataContext 的单个实例。我通常在我的业务逻辑类中创建我的 DC 的单例实例，并将它用于我的所有 linq 查询。

我敢肯定，这里的一些 linq 专家可能会给你确切的理由，说明为什么你应该只在数据上下文类的实例上使用......我不太确定。

# iphone - 如何在 Mobile Safari 中禁用电话号码链接？

> ID：226131
> 
> 赞同：389
> 
> 时间：2008-10-22T15:00:44.900
> 
> 标签：iphone, safari, mobile-safari

iPhone 上的 Safari 会自动为出现在电话号码中的数字字符串创建链接。我正在编写一个包含 IP 地址的网页，而 Safari 正在将其转换为电话号码链接。是否可以对整个页面或页面上的元素禁用此行为？

* * *

## 回答 #1

> 赞同：767
> 
> 时间：2008-10-22T19:36:47.573

[根据Safari HTML Reference](https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariHTMLRef/Introduction.html)，这似乎是正确的做法：

```
<meta name="format-detection" content="telephone=no"> 
```

如果您禁用此功能但仍需要电话链接，您仍然可以使用“tel”URI 方案。

这是 Apple 开发人员库中的[相关页面](https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html#//apple_ref/doc/uid/TP40008193-SW1)。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2016-04-20T03:15:16.573

我使用零宽度连接器`&zwj;`

只要把它放在电话号码的某个地方，它就对我有用。在 BrowserStack 中测试（以及用于电子邮件的 Litmus）。

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2013-03-12T10:29:25.543

要禁用特定元素的电话解析外观，这个 CSS 似乎可以解决问题：

```
.element { pointer-events: none; }
.element > a { text-decoration:none; color:inherit; } 
```

第一条规则禁用点击，第二条规则负责样式。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2008-10-22T15:18:03.443

添加这个，我认为这是你正在寻找的：

```
<meta name = "format-detection" content = "telephone=no"> 
```

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2011-04-05T20:18:21.147

我遇到了同样的问题。我在 UIWebView 上找到了一个允许您关闭数据检测器的属性。

```
self.webView.dataDetectorTypes = UIDataDetectorTypeNone; 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2011-10-15T13:45:12.203

### Webview 的解决方案！

对于 PhoneGap-iPhone / PhoneGap-iOS 应用程序，您可以通过将以下内容添加到项目的应用程序委托来禁用电话号码检测：

```
// ...

- (void)webViewDidStartLoad:(UIWebView *)theWebView 
{
    // disable telephone detection, basically <meta name="format-detection" content="telephone=no" />
    theWebView.dataDetectorTypes = UIDataDetectorTypeAll ^ UIDataDetectorTypePhoneNumber;

    return [ super webViewDidStartLoad:theWebView ];
}

// ... 
```

来源：[在 PhoneGap-iOS 中禁用电话检测](http://solutions.michaelbrooks.ca/2011/02/09/disable-telephone-detection-in-phonegap-ios/)。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2011-06-14T19:53:09.737

要在页面的一部分上禁用电话号码检测，请将​​受影响的文本包装在带有 href="#" 的锚标记中。如果你这样做，移动版 Safari 和 UIWebView 应该不管它。

```
<a href="#"> 1234567 </a> 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-06-25T15:04:16.193

您还可以将`<a>`标签与`javascript: void(0)`作为`href`值一起使用。

示例如下：
`<a href="javascript: void(0)">+44 456 77 89 87</a>`

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2010-08-09T06:48:37.233

认为我找到了解决方案：将数字放入`<label>`元素中。没有尝试任何其他标签，但`<div>`它在主屏幕上保持活动状态，即使具有`telephone=no`属性。

从早期的评论中可以明显看出，元标记确实有效，但由于某种原因，在后来的 iOS 版本中已经损坏，至少在某些情况下是这样。我正在运行 4.0.1。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2011-09-05T08:14:56.640

我的经历和其他人提到的一样。元标记...

```
<meta name = "format-detection" content = "telephone=no"> 
```

...当网站在 Mobile Safari 中运行（即，使用 chrome）时工作，但在作为 web 应用程序运行时停止工作（即，保存到主屏幕并在没有 chrome 的情况下运行）。

我不太理想的解决方案是将值插入输入字段......

```
<input type="text" readonly="readonly" style="border:none;" value="3105551212"> 
```

这不太理想，因为尽管边框设置为无，iOS 仍会在字段上方呈现多像素灰色条。但是，这比将数字视为链接要好。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-05-18T15:54:48.980

我有一个 ABN（澳大利亚商业号码），iPad Safari 坚持要把它变成电话号码链接。这些建议都没有帮助。我的解决方案是在数字之间放置 img 标签。

```
ABN 98<img class="PreventSafariFromTurningIntoLink" /> 009<img /> 675<img /> 709 
```

该类的存在只是为了记录 img 标签的用途。

适用于 iPad 1 (4.3.1) 和 iPad 2 (4.3.3)。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-02-14T07:56:46.833

我自己对此进行了测试，发现它确实有效，尽管它肯定不是一个优雅的解决方案。在电话号码中插入一个空跨度将阻止数据检测器将其转换为链接。

```
(604) 555<span></span> -4321 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-04-26T22:11:49.657

我有同样的问题，但在 iPad 网络应用程序上。

不幸的是，两者都不...

```
 <meta name = "format-detection" content = "telephone=no"> 
```

也不...

```
&#48; = 0
&#57; = 9 
```

...工作。

但是，这里有三个丑陋的黑客：

*   用字母“O”替换数字“0”
*   用字母“l”替换数字“1”
*   插入一个无意义的跨度：例如，`555.5<span>5</span>5.5555`

根据您使用的字体，前两个几乎不引人注意。后者显然涉及多余的代码，但对用户是不可见的。

Kludgy 肯定会破解，如果您从数据动态生成代码，或者如果您不能以这种方式污染数据，则可能不可行。

但是，在紧要关头就足够了。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-05-01T17:14:03.257

`<meta name = "format-detection" content = "telephone=no">`不适用于电子邮件：如果您准备的 HTML 用于电子邮件，则元标记将被忽略。

如果您的目标是电子邮件，那么这里还有另一个丑陋但可行的解决方案：

您希望避免链接或自动格式化的一些 HTML 示例：

```
will cease operations <span class='ios-avoid-format'>on June 1,
2012</span><span></span>. 
```

以及让奇迹发生的 CSS：

```
@media only screen and (device-width: 768px) and (orientation:portrait){
span.ios-date{display:none;}
span.ios-date + span:after{content:"on June 1, 2012";}
} 
```

缺点：您可能需要对每个 ipad/iphone 纵向/横向组合进行媒体查询

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-03-24T09:45:38.503

为什么要删除链接，它使用户非常友好地拥有该选项。

如果您只是想删除自动编辑，但保持链接正常工作，只需将其添加到您的 CSS...

```
a[href^=tel] {
 color: inherit;
 text-decoration:inherit;
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-22T15:14:28.507

您可以尝试将它们编码为 HTML 实体：

```
&#48; = 0
&#57; = 9 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-01-25T19:16:36.097

Sencha Touch 应用程序中的相同问题通过应用程序`<meta name="format-detection" content="telephone=no">`index.html 中的元标记 ( ) 解决。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-07-29T15:27:40.260

我使用的一个不仅仅适用于 Mobile Safari 的技巧是在电话号码中使用 HTML 转义码和一些标记。这使得浏览器更难“识别”一个电话号码，即

```
Phone: 1-8&#48;&#48;<span>-</span>62&#48;<span>-</span>38&#48;3 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-06-12T13:32:15.167

我也有这个问题：Safari 和其他移动浏览器将增值税 ID 转换为电话号码。所以我想要一个干净的方法来避免它在单个元素上，而不是整个页面（或站点）。
我正在分享我发现的一个可能的解决方案，它不是最理想的，但它仍然是相当可行的：我在我不想成为`tel:`链接的数字内放置了`&#8288;`HTML 实体，它是[Word-Joiner invisible character](https://stackoverflow.com/a/28405917/2477547)。我试图通过将这个字符放在某个有意义的地方来保持更多的语义（嗯，至少是一种），例如对于增值税 ID，我选择根据[其格式](https://en.wikipedia.org/wiki/VAT_identification_number)将它放在不同的数字组之间，所以对于意大利增值税我写道：`0613605&#8288;048&#8288;8`它呈现在 0613605⁠048⁠8 中，并且没有转换为电话号码。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-04-29T01:14:01.170

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2016-06-09T09:42:47.337

I was really confused by this for a while but finally figured it out. We made updates to our site and had some numbers converting to a link and some weren't. Turns out that numbers won't be converted to a link if they're in a <fieldset>. Obviously not the right solution for most circumstances, but in some it will be the right one.

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2012-06-13T18:38:42.780

截至 2012 年 6 月 13 日，这个答案胜过一切：

```
<a href="#" style="color: #666666; 
                   text-decoration: none;
                   pointer-events: none;">
  Boca Raton, FL 33487
</a> 
```

将颜色更改为与您的文本匹配的任何颜色，文本装饰删除下划线，指针事件阻止它像浏览器中的链接一样被查看（指针不会变成手）

这非常适合 ios 和浏览器上的 HTML 电子邮件。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-07-05T22:20:43.940

Break the number down into separate blocks of text

```
301 <div style="display:inline-block">441</div> 3909 
```

# content-management-system - wiki 和 CMS 有什么区别

> ID：226132
> 
> 赞同：13
> 
> 时间：2008-10-22T15:00:48.563
> 
> 标签：content-management-system, comparison, wiki

wiki 和 CMS 之间有什么区别？有没有？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-26T14:28:39.857

**内容管理系统：**

1.  CMS 专注于**内容**，然后通过标准化模板发布——将在线报纸想象成由庞大的 CMS 系统驱动。
2.  它是关于标准化**发布信息**的。
3.  CMS'es 通常有一个**有限**的编辑组。
4.  对于由非技术人员维护的**相对静态**的内容很有用。
5.  **非常强调样式**/演示：非常漂亮的模板，因此看起来很专业。

**维基：**

1.  另一方面，wiki 专注于每个页面代表一个主题的页面**。**
2.  它更多的是关于**协作改进每个主题**（添加到其他主题和网站的超链接算作改进主题）。
3.  Wiki 通常**对“公众”**（或公司中的每个人，而不是“内部沟通”部门）更加开放。
4.  Wiki 是*活***的、动态的东西，**由*每个人*维护。
5.  非常**强调内容：**不那么华丽的模板，但更容易查找和更新信息。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-22T15:10:20.793

不同之处在于字母“M”。内容管理系统*管理*内容。CMS 通常具有内置的工作流程和其他功能，可以更轻松地管理资产集合。例如，将文章从暂存阶段转移到生产阶段，便于校对等。

wiki 更像是一个公共公告板。任何人都可以随时以他们选择的任何方式添加任何内容。

可以将其视为 IDE 和文本编辑器之间的区别。两者都可以用于许多类似的任务，但一个比另一个更有条理。

当然，界限可能会变得模糊，因为一些 Wiki 具有管理内容的工具，而一些 CMS 只不过是“在此处键入并按下提交按钮”。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-22T15:01:59.700

通常，Wiki 是社区可编辑的，站点的访问者可以对其进行编辑，例如 Wikipedia。CMS 更典型地被设计为一组站点管理员来管理和显示内容。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-22T15:06:36.603

Wiki 是一种 CMS，CMS 有多种形式，但都以某种方式管理某些内容。在 wiki 的情况下，内容是用户可编辑和可创建的信息或文章。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-22T15:05:50.067

在某些情况下，wiki 是建立在 CMS 之上的。wiki 是人们使用的应用程序。CMS 只是一种数据库。CMS 通常有前端管理员应用程序。但是，CMS 的重点是管理某些专门构建的前端应用程序的内容。

CMS 之于 Wiki 就像数据库之于金融应用程序一样。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T01:41:59.737

在概念世界中，Wiki 是用于收藏内容的，任何人都可以创建、删除、修改任何内容。以知识为导向。

CMS 管理内容，以格式、形式和可维护性为导向。

一些 wiki 是使用 CMS 构建的

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-10T10:19:09.833

CMS 是一个**内容管理系统**。当对管理系统的需求扩大时，CMS 开发背后的想法就发生了变化。CMS 是 Web 开发的基石，借助它，开发人员可以用最少的时间和精力构建功能强大且功能丰富的网站。一个优秀而强大的 CMS 并不能解决编写重复和平凡代码的令人沮丧的需求，而且还消除了构建网站或 Web 应用程序所涉及的艰巨和繁重的任务。

另一方面，维基百科是一个**信息目录**。例如，Wikipedia 等网站可以建立在 CMS 上，`The New York Times`并且`TechCrunch`建立在`WordPress`. 在信息获取方面，维基百科是用户可以去的最好的地方——甚至比谷歌还要好。维基百科包含的文章数量惊人且高度可靠。每天依赖维基百科获取信息的用户数量本身就是对 Wiki 为我们用户提供的服务的证明。

# c++ - 根据返回值重载一个C++函数

> ID：226144
> 
> 赞同：40
> 
> 时间：2008-10-22T15:02:00.823
> 
> 标签：c++, function, puzzle, overloading

我们都知道可以根据参数重载一个函数：

```
int mul(int i, int j) { return i*j; }
std::string mul(char c, int n) { return std::string(n, c); } 
```

你能根据返回值重载一个函数吗？定义一个函数，根据返回值的使用方式返回不同的东西：

```
int n = mul(6, 3); // n = 18
std::string s = mul(6, 3); // s = "666"
// Note that both invocations take the exact same parameters (same types) 
```

您可以假设第一个参数在 0-9 之间，无需验证输入或进行任何错误处理。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-10-23T08:17:38.520

你必须告诉编译器使用哪个版本。在 C++ 中，您可以通过三种方式进行操作。

## 通过键入明确区分呼叫

您有点作弊，因为您向等待字符的函数发送了一个整数，并且当 '6' 的字符值不是 6 而是 54（ASCII 格式）时错误地发送了数字 6：

```
std::string mul(char c, int n) { return std::string(n, c); }

std::string s = mul(6, 3); // s = "666" 
```

正确的解决方案当然是

```
std::string s = mul(static_cast<char>(54), 3); // s = "666" 
```

我想这值得一提，即使您不想要解决方案。

## 通过虚拟指针显式区分调用

您可以为每个函数添加一个虚拟参数，从而强制编译器选择正确的函数。最简单的方法是发送返回所需类型的 NULL 虚拟指针：

```
int mul(int *, int i, int j) { return i*j; }
std::string mul(std::string *, char c, int n) { return std::string(n, c); } 
```

可以与代码一起使用：

```
int n = mul((int *) NULL, 6, 3); // n = 18
std::string s = mul((std::string *) NULL, 54, 3); // s = "666" 
```

## 通过模板化返回值明确区分调用

使用此解决方案，我们创建了一个“虚拟”函数，其中包含在实例化时不会编译的代码：

```
template<typename T>
T mul(int i, int j)
{
   // If you get a compile error, it's because you did not use
   // one of the authorized template specializations
   const int k = 25 ; k = 36 ;
} 
```

你会注意到这个函数不会编译，这是一件好事，因为我们只想通过模板特化使用一些有限的函数：

```
template<>
int mul<int>(int i, int j)
{
   return i * j ;
}

template<>
std::string mul<std::string>(int i, int j)
{
   return std::string(j, static_cast<char>(i)) ;
} 
```

因此，以下代码将编译：

```
int n = mul<int>(6, 3); // n = 18
std::string s = mul<std::string>(54, 3); // s = "666" 
```

但是这个不会：

```
short n2 = mul<short>(6, 3); // error: assignment of read-only variable ‘k’ 
```

## 通过模板化返回值来明确区分调用，2

> > 嘿，你也作弊了！

对，我确实为两个“重载”函数使用了相同的参数。但你确实开始作弊（见上文）......

^_^

更严重的是，如果您需要不同的参数，那么您将编写更多代码，然后在调用函数时必须显式使用正确的类型以避免歧义：

```
// For "int, int" calls
template<typename T>
T mul(int i, int j)
{
   // If you get a compile error, it's because you did not use
   // one of the authorized template specializations
   const int k = 25 ; k = 36 ;
}

template<>
int mul<int>(int i, int j)
{
   return i * j ;
}

// For "char, int" calls
template<typename T>
T mul(char i, int j)
{
   // If you get a compile error, it's because you did not use
   // one of the authorized template specializations
   const int k = 25 ; k = 36 ;
}

template<>
std::string mul<std::string>(char i, int j)
{
   return std::string(j, (char) i) ;
} 
```

这段代码将被这样使用：

```
int n = mul<int>(6, 3); // n = 18
std::string s = mul<std::string>('6', 3); // s = "666" 
```

以及以下行：

```
short n2 = mul<short>(6, 3); // n = 18 
```

仍然不会编译。

## 结论

我喜欢C++...

:-p

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-10-22T15:18:16.893

```
class mul
{
public:
    mul(int p1, int p2)
    {
        param1 = p1;
        param2 = p2;
    }
    operator int ()
    {
        return param1 * param2;
    }

    operator std::string ()
    {
        return std::string(param2, param1 + '0');
    }

private:
    int param1;
    int param2;
}; 
```

不是说我会用那个。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-01-09T21:02:03.143

如果你想`mul`成为一个真正的函数而不是一个类，你可以只使用一个中间类：

```
class StringOrInt
{
public:
    StringOrInt(int p1, int p2)
    {
        param1 = p1;
        param2 = p2;
    }
    operator int ()
    {
        return param1 * param2;
    }

    operator std::string ()
    {
        return std::string(param2, param1 + '0');
    }

private:
    int param1;
    int param2;
};

StringOrInt mul(int p1, int p2)
{
    return StringOrInt(p1, p2);
} 
```

这使您可以执行诸如将`mul`函数作为函数传递给 std 算法之类的事情：

```
int main(int argc, char* argv[])
{
    vector<int> x;
    x.push_back(3);
    x.push_back(4);
    x.push_back(5);
    x.push_back(6);

    vector<int> intDest(x.size());
    transform(x.begin(), x.end(), intDest.begin(), bind1st(ptr_fun(&mul), 5));
    // print 15 20 25 30
    for (vector<int>::const_iterator i = intDest.begin(); i != intDest.end(); ++i)
        cout << *i << " ";
    cout << endl;

    vector<string> stringDest(x.size());
    transform(x.begin(), x.end(), stringDest.begin(), bind1st(ptr_fun(&mul), 5));
    // print 555 5555 55555 555555
    for (vector<string>::const_iterator i = stringDest.begin(); i != stringDest.end(); ++i)
        cout << *i << " ";
    cout << endl;

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2008-10-22T15:05:46.543

不。

您不能通过返回值重载，因为调用者可以用它做任何事情（或什么都不做）。考虑：

`mul(1, 2);`

返回值只是被丢弃了，因此它无法仅根据返回值选择重载。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-22T15:13:31.253

在中间类中使用隐式转换。

```
class BadIdea
{
  public:
    operator string() { return "silly"; }
    operator int() { return 15; }
};

BadIdea mul(int, int) 
```

你明白了，但可怕的想法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-22T15:19:32.270

让 mul 是一个类， mul(x, y) 是它的构造函数，并重载一些强制转换运算符。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-22T15:06:17.947

您不能仅根据返回值重载函数。

但是，虽然严格来说这不是一个重载函数，但您可以从函数中返回一个重载转换运算符的类的实例。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-22T15:15:11.563

我想你可以让它返回一些奇怪的类型 Foo ，它只捕获参数，然后 Foo 有一个隐式运算符 int 和运算符 string，它会“工作”，尽管它不会真正重载，而是一个隐式转换技巧。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-07-19T22:06:34.370

简而言之，答案是否定的。在 C++ 中，要求是：

1：函数名称必须相同
2：参数集必须不同
*返回类型可以相同或不同

```
//This is not valid
    int foo();
    float foo();

    typedef int Int;

    int foo(int j);
    int foo(Int j);

//Valid:
   int foo(int j);
   char* foo(char * s);
   int foo(int j, int k);
   float foo(int j, float k);
   float foo(float j, float k); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-22T15:04:32.397

据我所知，你不能（可惜……）。作为一种解决方法，您可以改为定义一个“out”参数，然后重载该参数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-22T15:08:33.010

不在 C++ 中。你在上面的例子中得到的是返回值，它是一个 int 转换成`string`可以理解的东西，很可能是一个`char`. 这将是 ASCII 18 或“设备控制 2”。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-22T15:48:56.707

您可以使用上面的函子解决方案。C++ 不支持除 const 以外的函数。您可以基于 const 重载。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-10-22T15:05:59.193

您可以使用模板，但是您必须在调用时指定模板参数。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-10-22T15:06:09.757

把它放在不同的命名空间？我会这样做。严格来说不是重载，而是只有两个具有相同名称但范围不同的方法（因此是 :: 范围解析运算符）。

所以 stringnamespace::mul 和 intnamespace::mul。也许这不是你真正要问的，但它似乎是唯一的方法。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-10-22T15:11:05.190

你可以做类似的事情

```
template<typename T>
T mul(int i,int j){
    return i * j;
}

template<>
std::string mul(int i,int j){
    return std::string(j,i);
} 
```

然后这样称呼它：

```
int x = mul<int>(2,3);
std::string s = mul<std::string>(2,3); 
```

没有办法重载返回值。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2010-05-14T05:05:37.393

好的，天才们；）这就是您像专业人士一样做的事情。

```
 class mul
{
 int m_i,m_j;
public:
 mull(int i,int j):m_i(i),m_j(j){}
 template
 operator R() 
 {
  return (R)m_i * m_j;
 }
}; 

```

使用喜欢

```
 double d = mul(1,2);
long l = mul(1,2); 
```

不傻<>

# perl - 如何使用 Perl 解析证书签名请求？

> ID：226155
> 
> 赞同：3
> 
> 时间：2008-10-22T15:03:22.693
> 
> 标签：perl, parsing, openssl, csr

我想使用 Perl 从[Certificate Signing Request](http://en.wikipedia.org/wiki/Certificate_signing_request)中提取信息，最好不启动外部 openssl 进程。由于 CSR 以 base64 编码的 ASN.1 格式存储，因此我尝试了[Convert::PEM](http://search.cpan.org/~btrott/Convert-PEM-0.07/lib/Convert/PEM.pm)模块。但它需要内容的 ASN.1 描述，我无法将其组合在一起（ASN.1 就是它的野兽）。

是否有人对 CSR 或解析此类请求的模块有正确的 ASN.1 描述？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T16:37:20.210

也许[Convert::X509](http://search.cpan.org/dist/Convert-X509/)可以帮助你。另请参阅[Convert::X509::Parser](http://search.cpan.org/src/LEO/Convert-X509-0.1/X509/Parser.pm)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T15:40:44.583

您真正的问题是 CSR 使用什么格式？有两种格式可以做到这一点，PKCS #10 和 SPKAC。前者在[RFC 2986](https://www.rfc-editor.org/rfc/rfc2986)中有描述。我不知道后者在哪里描述。

# c# - 最佳实践：在多个 Web 方法调用中持久化数据

> ID：226157
> 
> 赞同：2
> 
> 时间：2008-10-22T15:03:30.977
> 
> 标签：c#, .net, web-services

我有一个包含 8 个 Web 方法的 Web 服务。这些方法被同步调用，第一个调用验证用户，其余的方法执行一个工作单元，这些方法被调用直到工作完成。

我需要存储工作的状态（例如下一步要执行什么操作，以及已经完成和当前正在执行的工作。）我目前有一个包含此信息的状态对象。

我的问题是在每个 Web 服务调用之间保留此对象的最佳方法是什么？请注意，可能有多个用户调用此 Web 服务，每个用户都有自己独特的状态。

以下是我正在考虑的一些场景：

**想法#1**

将对象存储在会话中。

**想法 #2** 创建一个实例变量，它是 userId 及其各自数据的 HashMap。就像是：

```
 [WebService(Namespace = "http://developer.intuit.com/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
public class QBWCService : QBWebConnectorSvc {

    // instance variable to hold current session data...
    private Dictionary<Guid,Session> Sessions;

    public QBWCService () {

        Sessions = new Dictionary<Guid,Session>();
    }
    [WebMethod]
    public override string[] authenticate(string strUserName, string strPassword)
    {
        ...
        Sessions.Add(UserId, new SessoionObject());
    }
 [WebMethod]
    public override string[] authenticate(Guid UserId)
    {
        SessionObject o = Sessions[UserId];
    }
} 

```

我认为想法 2 将是最干净的“自然方式”，但是我不知道实施这种方案的任何含义……您会推荐哪种方式或其他方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T15:12:23.410

您应该看看[Windows Workflow Foundation (WF)](http://msdn.microsoft.com/en-us/netframework/aa663328.aspx)。您可以设计您的工作流程，然后插入持久性模型等。

话虽这么说 - 你不能使用会话！一旦您创建了多个网络场/服务器，它就不会扩展。当然，QBW 开发人员 API 需要扩展和容错！

有关在 ASP.NET 中使用它的更多信息在[这里](http://www.devx.com/dotnet/Article/29992/1954)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T15:12:31.210

这可能是您已经太远而无法进行大型重构的情况之一，但是......

听起来与 Windows 工作流中的状态工作流相同。如果您的计划最终将这些方法中的每一个公开为它们自己的封装服务，那么它将免费为您提供所有状态管理，而且您还可以获得能够直观地定义这些服务调用之间的工作流的额外好处。

[http://msdn.microsoft.com/en-us/magazine/cc163538.aspx](http://msdn.microsoft.com/en-us/magazine/cc163538.aspx)

[编辑]：射击，绝地击败了我。他说的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T15:06:51.423

想法 2 是模仿 Session 状态管理。我没有看到执行您自己的会话语句管理的内在好处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T15:09:04.883

想法一的好处是 ASP.NET 为您管理会话。如果您的用户没有完成整个生命周期，我可能会看到第二个选项会出现问题，因为您在哈希表中有引用旧会话的条目。至少如果使用#2，我将构建一个清理过程以确保旧会话到期。

如果您只需要保留当前步骤信息，我几乎会投票支持会话，因为尝试重新发明它是没有意义的。

# mysql - 如何修复 InnoDB 表？

> ID：226172
> 
> 赞同：36
> 
> 时间：2008-10-22T15:05:42.580
> 
> 标签：mysql, innodb, repair

昨晚（显然）我们的 Solaris MySQL 数据库引擎执行不佳。至少有一些 InnoDB 表已损坏，事务日志中出现时间戳乱序错误，以及有关索引已损坏的特定错误。

我们知道可用于 MyISAM 表修复的工具，但找不到任何适用于 InnoDB 的工具。

旁注：尝试表优化（在我尝试重建损坏的索引时）会导致数据库服务器崩溃。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-22T17:55:26.887

首先*停止服务器并对光盘进行映像*。只用一枪是没有意义的。那就看看[这里吧](http://www.mysqlperformanceblog.com/2008/07/04/recovering-innodb-table-corruption/)。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-07-23T22:49:01.943

停止您的应用程序...或停止您的从站，因此不会添加新行

```
create table <new table> like <old table>;
insert <new table> select * from <old table>;
truncate table  <old table>;
insert <old table> select * from <new table>; 
```

重新启动您的服务器或从站

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-05-06T21:45:05.100

以下解决方案的灵感来自上面 Sandro 的提示。

**警告**：虽然它对我有用，但我不知道它是否对你有用。

我的问题如下：从表中读取一些特定的行（我们称之为表`broken`）会使 MySQL 崩溃。甚至`SELECT COUNT(*) FROM broken`会杀了它。我希望你`PRIMARY KEY`在这张桌子上有一个（在下面的示例中，它是`id`）。

1.  确保您有损坏的 MySQL 服务器的备份或快照（以防万一您想返回步骤 1 并尝试其他操作！）
2.  `CREATE TABLE broken_repair LIKE broken;`
3.  `INSERT broken_repair SELECT * FROM broken WHERE id NOT IN (SELECT id FROM broken_repair) LIMIT 1;`
4.  重复步骤 3，直到它使数据库崩溃（您可以使用`LIMIT 100000`然后使用较低的值，直到使用`LIMIT 1`使数据库崩溃）。
5.  看看你是否拥有一切（你可以`SELECT MAX(id) FROM broken`与 中的行数进行比较`broken_repair`）。
6.  在这一点上，我显然已经拥有了所有行（除了那些可能被 InnoDB 粗暴截断的行）。如果你错过了一些行，你可以尝试`OFFSET`在`LIMIT`.

祝你好运！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-12-20T08:51:32.247

这是 MySQL 提供的解决方案：http: [//dev.mysql.com/doc/refman/5.5/en/forcing-innodb-recovery.html](http://dev.mysql.com/doc/refman/5.5/en/forcing-innodb-recovery.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-18T01:11:19.560

见这篇文章：[http](http://www.unilogica.com/mysql-innodb-recovery/) ://www.unilogica.com/mysql-innodb-recovery/ （葡萄牙语）

解释了如何使用**innodb_force_recovery**和**innodb_file_per_table**。在需要使用单个**ibdata1**恢复崩溃的数据库后，我发现了这一点。

使用 innodb_file_per_table，InnoDB 中的所有表都将创建一个单独的表文件，如 MyISAM。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-29T12:54:01.980

注意：如果您的问题是，“innodb 索引被标记为损坏”！然后，简单的解决方案可以是，只需删除索引并再次添加它们。这可以很快解决，而不会丢失任何记录，也不会重新启动或将表内容移动到临时表中并返回。

* * *

## 回答 #7

> 赞同：-8
> 
> 时间：2015-09-27T08:56:19.257

第1步。

**停止 MySQL 服务器**

第2步。

将此行添加到 my.cnf （在 Windows 中称为 my.ini ）

```
set-variable=innodb_force_recovery=6 
```

步骤 3。

删除**ib_logfile0**和**ib_logfile1**

第4步。

**启动 MySQL 服务器**

步骤 5。

运行此命令：

```
mysqlcheck --database db_name table_name -uroot -p 
```

成功修复崩溃的 innodb 表后，不要忘记从 my.cnf 中删除 #set-variable=innodb_force_recovery=6 ，然后再次重新启动 MySQL 服务器。

# c# - ASP.NET：故障转储中显示错误代码

> ID：226187
> 
> 赞同：0
> 
> 时间：2008-10-22T15:07:21.047
> 
> 标签：c#, asp.net, xml, yellow-screen-of-death

所以我一直在开发的一个 web 应用程序坏了，我做了一些修复......它仍然崩溃，但在 YSOD 中它向我显示了旧代码。我从 VS 2005 IDE 运行它。它不会遇到任何断点，并且在第 249 行崩溃，这已被明确注释掉。我已经清除了我的调试/发布文件夹并重建了它；重新启动 IIS（以防万一）；什么会导致这个？

```
Could not find file 'c:\Program Files\Microsoft Visual Studio 8\Common7\IDE\map.xml'. 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.IO.FileNotFoundException: Could not find file 'c:\Program Files\Microsoft Visual Studio 8\Common7\IDE\map.xml'.

Source Error: 

Line 248:    //XmlDocument xMap = new XmlDocument();
Line 249:    //xMap.Load(MapPath("map.xml")); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T15:12:10.507

当前代码可能没有编译，因此 DLL 中的元数据是针对您的旧代码的。

# asp.net - 展开asp的下拉区域：DropDownList

> ID：226191
> 
> 赞同：0
> 
> 时间：2008-10-22T15:08:08.410
> 
> 标签：asp.net

VS 2008 - Visual Basic .NET（C# 示例很好，我也可以阅读）

我有一个 100px 宽的 asp:DropDownList，但是我的一些列表项比这宽得多。

如何扩展列表的下拉区域以显示列表项的所有文本？控件本身必须保持在 100px - 只有下拉区域可以扩展。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T15:11:09.167

人力资源管理系统。由于浏览器处理下拉菜单的方式，我不知道您可以使用 ASP 做到这一点。

但是，您可以使用以这种方式运行的 JavaScript 创建您自己的类似下拉列表的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T15:33:17.283

EndangeredMassa 是对的。

您无法控制浏览器如何从您的代码中呈现它的控件。很遗憾。

# asp.net - 交替项目样式

> ID：226206
> 
> 赞同：0
> 
> 时间：2008-10-22T15:10:57.547
> 
> 标签：asp.net

我实际上很想在 GridView 上有一个 AlternatingItemTemplate，但它提供的只是一个 AlternatingItemStyle。在我的网格中，每两列行（在表格布局中）在第一列中有一个图像，在第二列中有一个描述。我希望图像和描述的位置在交替行上交替出现。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T15:41:26.440

这是一种方法：

ASP.NET：

```
<asp:Repeater runat="server" ID="Repeater1" OnItemDataBound="Repeater1_ItemDataBound" /> 
```

ItemDataBound 事件：

```
public void Repeater1_ItemDataBound(Object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.AlternatingItem)
    {
        // e.Item is an alternating item
    }
    else
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T18:19:46.277

您可以考虑使用 AlternatingItemStyle 来管理它以获得乐趣。

使用 1 列或中继器：

物品模板：

```
<div class="MyImage"><img src="" /></div>
<div class="MyDescription">Blah...Blah...</div> 
```

CSS：

```
.MyItemStyle .MyImage {width:49%; float:left;}
.MyItemStyle .MyDescription {width:49%; float:right;}

.MyAltItemStyle .MyImage {width:49%; float:right;}
.MyAltItemStyle .MyDescription {width:49%; float:left;} 
```

适用于 Gridview/Repeater：

```
ItemStyle = "MyItemStyle"
AlternatingItemStyle = "MyAltItemStyle" 
```

这将使您改变主意，而无需重新编码事件处理程序等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T18:48:07.123

我认为这会起作用：

```
 <asp:GridView>
    <Columns>
        <asp:TemplateColumn>
            <%# Container.DataItemIndex % 2 == 0 ? Eval("Image") : Eval("Desc") %>
        </asp:TemplateColumn>
        <asp:TemplateColumn>
            <%# Container.DataItemIndex % 2 == 0 ? Eval("Desc") : Eval("Image") %>
        </asp:TemplateColumn>
    </Columns>
 </asp:GridView> 
```

显然，Eval 图像确实需要是一个 img 标记，或者您可以替换一些用户控件等。重要的是 Container.DataItemIndex % 2。您甚至可以将其用作可见的数据绑定。

```
 <asp:GridView>
    <Columns>
        <asp:TemplateColumn>
            <uc:Image Data='<%# Eval("Image") %>' 
              Visible='<%# Container.DataItemIndex % 2 == 0 %>' />
            <uc:Description Data='<%# Eval("Description") %>' 
              Visible='<%# Container.DataItemIndex % 2 != 0 %>' />
        </asp:TemplateColumn>
        <asp:TemplateColumn>
            <uc:Image Data='<%# Eval("Image") %>' 
              Visible='<%# Container.DataItemIndex % 2 != 0 %>' />
            <uc:Description Data='<%# Eval("Description") %>' 
              Visible='<%# Container.DataItemIndex % 2 == 0 %>' />
        </asp:TemplateColumn>
    </Columns>
 </asp:GridView> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T15:14:47.850

您将需要处理数据绑定事件以尝试确定它是项还是交替项，或者切换到使用支持 Item 和 AlternatingItem 模板的控件。

# sql-server - 消息的 Raiseerror 和 Concat

> ID：226221
> 
> 赞同：4
> 
> 时间：2008-10-22T15:13:36.667
> 
> 标签：sql-server, tsql, raiseerror

我想做这样的事情

> ```
> raiserror(concat('Error in case @isFishy =', @isFishy, ' @isSmarmy=', @isSmarmy, ' @isTasty = ', @isTasty), 10, 1)
> --or
> raiserror('Error in case @isFishy =' + @isFishy + ' @isSmarmy=' + @isSmarmy + ' @isTasty = ' + @isTasty, 10, 1) 
> ```

但它只是行不通。我该如何做到这一点？我在 SQL Server 2005 中。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-22T16:02:41.483

RAISERROR 中的错​​误消息实际上与 C 中的 printf 函数具有相似的语法，因此假设您的参数是您需要使用的整数类型：

```
raiserror(N'Error in case @isFishy = %d @isSmarmy = %d @isTasty = %d',10,1,@isFishy,@isSmarmy,@isTasty) 
```

查看[BOL](http://msdn.microsoft.com/en-us/library/ms178592(SQL.90).aspx)了解详细信息和其他选项

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T15:17:51.247

我经常使用raiseerror。我们有一些存储过程，每晚从 .Net 应用程序调用以进行批处理，而 .Net 应用程序希望以这种方式记录过程输出。我不知道为什么，但我通常必须在调用 raiserror 之前构建字符串。

# sql-server - 为性能分析 sqlserver 2005 数据库的最佳方法是什么？

> ID：226223
> 
> 赞同：6
> 
> 时间：2008-10-22T15:13:52.393
> 
> 标签：sql-server, optimization, profiling

你使用什么技术？您如何找出运行时间最长的作业？有没有办法找出有问题的应用程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T15:23:55.787

步骤 1：安装[SQL Server 性能仪表板](http://www.microsoft.com/downloads/details.aspx?FamilyId=1d3a4a0d-7e0c-4730-8204-e419218c1efc&displaylang=en)。

步骤2：利润。

说真的，你确实想先看看那个仪表板。可以在[此处](http://www.mssqltips.com/tip.asp?tip=1553)和/或[此处找到有关安装和使用它的更多信息](http://www.sql-server-performance.com/articles/per/bm_performance_dashboard_2005_p1.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T15:31:35.040

要识别有问题的查询启动 Profiler，请选择以下事件：

*   TSQL：批处理完成
*   TSQL:Stmt 已完成
*   SP：已完成
*   SP:Stmt 已完成

过滤输出，例如

*   持续时间 > x 毫秒（例如 100 毫秒，主要取决于您的需求和系统类型）
*   CPU > y 毫秒
*   读数 > r
*   写入 > w

取决于您要优化的内容。确保对输出进行足够的过滤，以免成千上万的数据行在您的窗口中滚动，因为这会影响您的服务器性能！

将输出记录到数据库表以在之后进行分析很有帮助。并行运行 Windows 系统监视器以查看 cpu 负载、磁盘 io 和一些 sql server 性能计数器也很有帮助。配置 sysmon 以将数据保存到文件中。

比您必须在数据库上获得生产典型查询负载和数据量才能使用探查器查看有意义的值。

从分析器获得一些输出后，您可以停止分析。

然后再次将分析表中存储的数据加载到分析器中，并使用 importmenu 从 systemmonitor 导入输出，分析器会将 sysmon 输出与您的 sql 分析器数据相关联。这是一个非常好的功能。

在该视图中，您可以立即识别与您的内存、磁盘或 cpu 系统有关的引导项。

当您确定了一些要省略的查询时，请转到查询分析器并查看执行计划并尝试省略索引使用和查询设计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T15:16:18.813

在使用 SQL Server 2000 时，我使用 SSMS 或 SQL Profiler 中提供的数据库调整工具取得了很好的成功。

关键是使用 GOOD 样本集，跟踪 analsys 的一部分 TRUE 生产工作负载，这将获得最佳的整体收益。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T15:25:25.973

我使用 SQL Server 附带的 SQL Profiler。我发现的大多数性能不佳的查询都没有使用大量 CPU，而是产生了大量的磁盘 IO。

我倾向于在磁盘读取上放置过滤器，并寻找倾向于进行超过 20,000 次左右读取的查询。然后我会查看那些查询的执行计划，它通常会为您提供优化查询或相关表上的索引所需的信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T15:19:53.830

我使用了几种不同的技术。

如果您尝试优化特定查询，请使用查询分析器。使用其中的工具，例如显示执行计划等。

对于您不确定哪个查询运行缓慢的情况，您可以使用的最强大的工具之一是 SQL Profiler。

只需选择您要分析的数据库，然后让它完成它的工作。

您需要让它运行相当长的时间（这取决于应用程序的流量），然后您可以将结果转储到表格中并开始分析它们。

您将要查看具有大量读取或占用大量 CPU 时间等的查询。

优化是一头熊，但要坚持下去，最重要的是，不要假设你知道瓶颈在哪里，找到它在哪里的证据并修复它。

# java - struts-config 1.1 版中的通配符

> ID：226234
> 
> 赞同：0
> 
> 时间：2008-10-22T15:15:31.280
> 
> 标签：java, struts, wildcard

我的应用程序使用的是 struts 1.1。我正在尝试使用通配符对 URL 转发进行分组。

例如，如果动作是这样的：

action path="/edit/product" type="classname"
forward
name="success"
path=".myapp.main"
action

将上面的第一行替换为
action path="/edit/*" type="classname"
不起作用。是否需要任何其他步骤，将任何以 /edit/ 开头的 URL 转发到 myapp.main？

编辑：删除括号，因为代码没有出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T18:58:29.613

据我所知，Struts 不支持这种类型的通配符配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T19:13:37.977

laz，确实支持。我不确定 1.1 版是否支持。

[http://www.oreillynet.com/onjava/blog/2004/12/struts_12_offers_cool_new_feat.html](http://www.oreillynet.com/onjava/blog/2004/12/struts_12_offers_cool_new_feat.html)

# grid - 将分布式系统开发为网格

> ID：226255
> 
> 赞同：1
> 
> 时间：2008-10-22T15:19:00.633
> 
> 标签：grid, distributed-computing

有没有人有将分布式系统开发为网格的经验？

我所说的网格是指一个分布式系统，其中所有节点都是相同的，没有中央管理、数据库等。

网格如何实现均匀分布：CPU、内存、磁盘、带宽等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T15:32:50.497

也许类似于[Plan9](http://plan9.bell-labs.com/plan9dist/)的东西？

[维基百科](http://en.wikipedia.org/wiki/Plan_9_from_Bell_Labs)条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-25T03:22:56.287

你实际上在谈论的是一个集群。有很多软件可用于负载平衡等，甚至是特定的 Linux 发行版，例如[Rocks](http://www.rocksclusters.org/wordpress/)，它内置了 MPI/PVM 和监控工具。

# visual-studio - 在 Visual Studio 的选项卡式文档界面中清理文件名？

> ID：226262
> 
> 赞同：5
> 
> 时间：2008-10-22T15:20:37.683
> 
> 标签：visual-studio, visual-studio-2008, editor

在 Visual Studio 项目中，我有以下文件夹（例如）

*   富/
*   酒吧/
*   长文件夹名/

当我在 LongFolderName/ 中打开一个文件时，该选项卡会`LongFolderName/L...me.ascx`在我喜欢的时候被标记`LongFileName.ascx`（省略文件夹的名称）。有什么方法可以将 Visual Studio 设置为在标记选项卡时忽略文件夹名称？

编辑：这是我的标签栏的样子：

[http://img355.imageshack.us/img355/7040/tabsmn7.png](http://img355.imageshack.us/img355/7040/tabsmn7.png)

请注意我的文件名称是如何被截断的。我有“EventCalendar”、“MonthlyEventCalendar”和“WeeklyEventCalendar”，而且很难区分。我知道这些文件在 UserControls/. 如何让 VS 停止告诉我？

编辑：**窗口中的文件名 | 如果我将 VS 切换到 MDI 界面， Windows**菜单`longfoldername/longfilename`与窗口的标题一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T07:21:17.853

longfoldername/longfilename 选项卡名称用于 Visual Studio 网站项目。如果您在同一个文件夹中创建一个具有不同名称的 ASP.NET Web 应用程序项目并在编辑文件时使用该项目，这可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-31T05:34:59.960

用于替换内置 Visual Studio 选项卡的 Visual Studio 的[Tabs Studio 加载项不会缩短选项卡名称，并且可以选择从选项卡名称中删除路径。](http://www.tabsstudio.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-25T23:28:44.117

如果您单击**窗口 | Windows...** menuitem，您打开的文档的名称和路径字段是什么样的？

在我的安装中，名称字段只是文件名，正是选项卡中显示的内容。

如果将窗口布局设置为“多个文档”，窗口标题中是否会显示完整路径？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-21T02:54:24.533

看来您不能按您的要求做...我已经搜索了一段时间。

我假设您已经尝试过多文档布局...

[http://forums.asp.net/t/1285843.aspx](http://forums.asp.net/t/1285843.aspx)

vs2010 的预发布版本可以解决这个问题： http: [//www.microsoft.com/downloads/details.aspx? FamilyId=922B4655-93D0-4476-BDA4-94CF5F8D4814&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=922B4655-93D0-4476-BDA4-94CF5F8D4814&displaylang=en)

或者去msdn看一些它在使用中的视频。

--

# .net - 使用 Office Communications Server 进行 .Net 开发有哪些好的参考资料？

> ID：226268
> 
> 赞同：1
> 
> 时间：2008-10-22T15:21:40.893
> 
> 标签：.net, asp.net, silverlight, communication, voip

是否可以将 VOIP 功能（尤其是电话拨号）与 Office Communications Server 2007 和 .Net 集成？如果是这样，是否有任何好的参考？如果它可以托管在 ASP.Net 或 Silverlight 应用程序中，我会特别感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T16:58:20.543

The [Thirsty Developer](http://www.thirstydeveloper.com)最近在一个与 MOC 挂钩的 Vista Gadget 上做了一个[播客。](http://thirstydeveloper.com/2008/09/22/TheThirstyDeveloper36WPFGadgetsAndUC.aspx)IIRC，他们使用 Silverlight 或 WPF XBAP 来托管小工具。

该[项目](http://www.codeplex.com/MOCVistaGadget)是在 Codeplex 上开源的，MS 还发布了一些WPF 的[存在控件](http://www.microsoft.com/downloads/details.aspx?FamilyID=5001d612-533a-4721-91ea-da990d94ff0f&DisplayLang=en)。

编辑：似乎有不同的 API，具体取决于您要连接的位置（您是想使用客户端 Communicator，还是直接集成到您的应用程序等）。这里有几个指向我所知道的资源的指针：

*   [http://blogs.msdn.com/jcalev/archive/2007/08/21/an-overview-of-the-apis-in-office-communications-server-2007.aspx](http://blogs.msdn.com/jcalev/archive/2007/08/21/an-overview-of-the-apis-in-office-communications-server-2007.aspx)
*   在线下载[Microsoft Unified Communications Managed API SDK](http://www.microsoft.com/downloads/details.aspx?familyid=B30306E4-7DC1-44D2-9A68-9B4A6FC5C2DF&displaylang=en)和[文档](http://msdn.microsoft.com/en-us/library/bb759538.aspx)
*   [统一通信客户端 API](http://msdn.microsoft.com/en-us/library/bb878516.aspx)
*   [Office Communicator SDK](http://www.microsoft.com/downloads/details.aspx?FamilyID=ed1cce45-cc22-46e1-bd50-660fe6d2c98c&DisplayLang=en)

# php - 使用包含在 PHP 中的抓取域名

> ID：226271
> 
> 赞同：-1
> 
> 时间：2008-10-22T15:22:30.457
> 
> 标签：php, include

我已经知道如何在 PHP 中找出当前域名，问题是当我将此代码放入文件中，然后从另一台服务器包含它时，它会显示文件所在位置的域名。有没有办法找出包含 include() 代码的域或站点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T15:36:29.243

你在做类似的事情：

```
include 'http://example.com/script.php'; 
```

?

注意：从安全的角度来看，这种方法通常被认为有点禁忌。

无论如何，包含的脚本实际上正在另一台服务器上执行，然后脚本的输出正在当前服务器上执行。您可以通过回显实际代码来解决此问题，如下所示：

目前：

```
<? 
//do something
echo '$v = '.$_SERVER['HTTP_HOST'].';'
?> 
```

另一种方式：

```
<?
//do something
?>
$v = $_SERVER['HTTP_HOST']; 
```

但也许我误解了你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T15:25:57.080

如果您包含来自另一台服务器的 PHP 页面，该页面将由原始服务器解析并将结果发送给您 - 您收到的页面只是文本，不包含任何 PHP 代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T15:34:26.703

这是一个粗略的 hack，但是在远程服务器上，您可以查找 $_ENV['REMOTE_HOST'] 的域名。

从远程服务器的角度来看，这将是执行“包含”的人的域名。

我假设你有一些理由想要实现这个奇怪的拓扑——虚拟主机环境中的限制，或者其他什么。如果可能的话，我建议研究替代基础设施。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T00:23:23.220

您可以使用“eval”在本地运行它，然后它应该使用正确的域将您的脚本存储为文本文件，然后下载它然后执行：

```
eval(file_get_contents("http://someDomain.com/somePhpscript.txt")); 
```

# java - 小程序 - 'java.lang.NullPointerException: null pData' 当浏览器关闭时

> ID：226272
> 
> 赞同：2
> 
> 时间：2008-10-22T15:23:19.317
> 
> 标签：java, applet, nullpointerexception

我有一位用户在关闭浏览器时收到错误消息。这只发生在他访问了包含我的小程序的页面时。它似乎已在 Sun 注册为错误，但那是多年前的事了。他正在使用 Java 1.6 和 IE7。

有没有人见过这个并且知道解决方案或解决方法？

```
java.lang.NullPointerException: null pData
    at sun.awt.windows.WComponentPeer.hide(Native Method)
    at java.awt.Component.removeNotify(Unknown Source)
    at java.awt.Container.removeNotify(Unknown Source)
    at java.awt.Container.removeNotify(Unknown Source)
    at java.awt.Container.removeAll(Unknown Source)
    at sun.plugin.viewer.frame.IExplorerEmbeddedFrame.windowClosed(Unknown Source)
    at java.awt.Window.processWindowEvent(Unknown Source)
    at java.awt.Window.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

**更新**用户删除了 Google 桌面，此后问题未出现。所以你去...谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T15:28:50.863

对于浏览器中加载的几乎每个小程序，我都经常遇到该错误。我从来不知道*如何*，但 Google 桌面在某种程度上破坏了 java。卸载谷歌桌面后，错误消失了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-22T09:12:21.997

我不知道解决方案，但我知道如何预防这个问题。如果在您的 Web 浏览器中启用了 javascript，则将此代码放在打开 applet 的 html 文件的 head 标记内的脚本标记中：

```
<SCRIPT language = "JavaScript">
    window.onunload = function() { document.body.innerHTML = ""; } 
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T15:56:50.450

你让他们尝试 1.6u10 吗？它于上周发布，据说修复了一些小程序问题。否则，他们使用的是 1.6 的什么版本？

# python - 解码来自 S60 设备的 WBXML SyncML 消息

> ID：226279
> 
> 赞同：3
> 
> 时间：2008-10-22T15:25:00.777
> 
> 标签：python, s60, syncml, wbxml

我正在尝试解码来自诺基亚 N95 的 WBXML 编码的 SyncML 消息。我的第一次尝试是使用 python pywbxml 模块来包装对 libwbxml 的调用。用这个解码消息会产生很多 <unknown> 标签和 <Collection> 标签内的一大块二进制文件。我尝试自行运行 <Collection> 的内容，但失败了。有什么我想念的吗？

另外，有人知道 wbxml 解析器的纯 python 实现吗？如果没有命令行或在线工具来解码这些消息会很有用——这会让我更容易编写自己的...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T16:59:13.020

有趣的是，我一直在解决同样的问题。我编写自己的纯 Python WBXML 解析器大约已经完成了一半，但它还不够完整，无法派上用场，而且我现在几乎没有时间来处理它。

那些 <Unknown> 标签可能是因为 pywbxml / libwbxml 没有加载正确的标签词汇。WBXML 用索引号表示标签以避免数百次传输相同的标签名称，并且将索引号映射到标签名称的表必须与 WBXML 文档本身分开提供。[从对 libwbxml 源](http://libwbxml.aymerick.com/browser/wbxml2/trunk/src/wbxml_tables.c)的模糊一瞥，似乎 libwbxml 有一堆硬编码的标记表。它有 SyncML 1.0-1.2 的表格；我认为我的诺基亚 E71 发送 SyncML 1.3（如果是这样，您的 N95 可能也会发送），看起来 libwbxml 还不支持。

让它工作可能就像将 SyncML 1.3 表添加到 libwbxml 一样简单。就是说，上次我尝试过，pywbxml 不能针对 vanilla libwbxml 源进行编译，所以你必须先应用一些补丁......所以“简单”可能是一个相对术语。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T13:53:06.780

我最终自己编写了一个 python 解析器。我设法按照这里的规范做到了：http: [//www.w3.org/TR/wbxml/](http://www.w3.org/TR/wbxml/)

然后从 horde.org cvs 中获取代码表。

开放移动联盟的网站和文档很糟糕，这是一个非常尝试的项目 :(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-01T13:35:16.113

我使用[pywbxml](https://github.com/diegows/pywbxml/)，只需要 pywbxml.pyx 中的一个补丁：

`params.lang`[在第 25 行](https://github.com/diegows/pywbxml/blob/254030c8413ceab710838ff544c83bc343ddbd8c/0.1/src/pywbxml.pyx#L25)`wbxml2xml`附近的函数中设置为：

```
params.lang = WBXML_LANG_UNKNOWN 
```

像魅力一样工作。将 WBXMLParseError 的基类更改为异常也有助于：

```
class WBXMLParseError(Exception): 
```

# java - Eclipse 类版本错误

> ID：226280
> 
> 赞同：0
> 
> 时间：2008-10-22T15:25:19.607
> 
> 标签：java, eclipse, class, classpath

在 Eclipse 3.4 中，我尝试对大型产品进行一些性能测试，其中包含的库之一是 Java3D 项目中的 vecmath.jar（javax.vecmath 包）。一切正常，然后在昨天尝试运行它时，我在启动后不久就收到了这个异常/错误：

```
java.lang.UnsupportedClassVersionError: javax/vecmath/Point2f (Unsupported major.minor version 49.0) 
```

我相信这意味着我正在尝试将 java 1.5 类文件加载到不受支持的 1.4 jvm 中。但是，当我去类文件检查这个时，我在 eclipse 类文件查看器中看到了这个：

```
Compiled from Point2f.java (version 1.2 : 46.0, super bit) 
```

所以类加载器说它是 49.0 版本，但类文件说它是 46.0。我已经尝试清理并完全重建项目，我已经确认项目的编译器版本是 1.4，JRE 是 1.4，并且对于运行配置，选择了 1.4 jvm。我完全被困在这个问题上，有没有人知道可能是什么原因造成的？

谢谢

===编辑===

原来与 java 1.4.2 不兼容的 java3d 版本已安装在 C:\Program Files\java\j2re1.4.2_18\lib\ext 中。我安装了一个较新版本的 Java3D 以在 java6 中使用，我猜它在我所有的 JRE 中安装了库，即使是那些不兼容的库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T16:00:40.113

你的类路径上可能还有另一个 javax.vecmath.Point2f 吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T15:48:01.090

我相信最新版本的 Java3D 需要 JRE 1.5。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T16:22:16.187

你检查过：

```
Window
    -> Preferences
        -> Java
            -> Compiler
                -> Compiler Compliance Level 
```

看看这个值是否有问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T01:42:51.647

您必须添加

1.  “java_home：C:\Program Files\Java\jdk1.6.0_16”
2.  “路径：C:\Program Files\Java\jdk1.6.0_16\bin;”

到您的环境变量！

# optimization - 你见过的最核心的优化是什么？

> ID：226282
> 
> 赞同：20
> 
> 时间：2008-10-22T15:25:55.753
> 
> 标签：optimization

我不是在谈论算法的东西（例如使用快速排序而不是冒泡排序），我不是在谈论像循环展开这样的简单事情。

我说的是*硬核*的东西。比如[Tiny Teensy ELF](http://www.muppetlabs.com/~breadbox/software/tiny/teensy.html)，[梅尔的故事](http://catb.org/jargon/html/story-of-mel.html)；演示场景中的几乎所有内容，等等。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-22T15:48:41.073

我曾经写过一个蛮力 RC5 密钥搜索，它一次处理两个密钥，第一个密钥使用整数管道，第二个密钥使用 SSE 管道，两者在指令级别交错。然后将其与在系统中的每个核心上运行代码实例的主管程序相结合。总的来说，该代码的运行速度比简单的 C 版本快约 25 倍。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-27T09:16:20.677

在我使用的一个（此处未命名）视频游戏引擎中，他们重写了模型导出工具（将[Maya](http://en.wikipedia.org/wiki/Autodesk_Maya)网格转换为游戏加载的东西的东西），因此它不仅仅是发出数据，它实际上会发出确切的流渲染该特定模型所需的微指令。它使用一种遗传算法来找到能以最少周期数运行的算法。也就是说，给定模型的数据格式实际上是一个完美优化的子程序，仅用于渲染该模型。因此，在屏幕上绘制网格意味着将其加载到内存中并分支到其中。

（这不是针对 PC，而是针对具有独立于 CPU 并与 CPU 并行的矢量单元的控制台。）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-27T09:41:38.477

在 DOS 的早期，当我们使用软盘进行所有数据传输时，也存在病毒。病毒感染不同计算机的一种常见方法是将病毒引导加载程序复制到插入的软盘的引导扇区中。当用户将软盘插入另一台计算机并在不记得取出软盘的情况下重新启动时，病毒就会运行并感染硬盘引导扇区，从而永久感染主机 PC。我感染的一种特别烦人的病毒叫做“Form”，为了解决这个问题，我编写了一个自定义软盘引导扇区，它具有以下功能：

*   验证主机硬盘的引导扇区并确保它没有被感染。
*   验证软盘引导扇区并确保它没有被感染。
*   如果病毒被感染，则从硬盘驱动器中删除病毒的代码。
*   如果按下特殊键，则将防病毒引导扇区复制到另一张软盘的代码。
*   如果一切正常，启动硬盘驱动器的代码，并且没有发现感染。

这是在引导扇区的程序空间中完成的，大约 440 字节 :)

对我的伙伴来说，最大的问题是显示的信息非常神秘，因为我需要所有的空间来写代码。就像“FFVD RM？”，意思是“检测到 FindForm 病毒，删除？”

我对那段代码很满意。优化是程序大小，而不是速度。组装中的两种完全不同的优化。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-28T02:55:44.403

我最喜欢的是通过整数运算的浮点逆平方根。这是关于如何存储浮点值并且可以更快地执行（即使执行 1/结果比标准平方根函数更快）或产生比标准方法更准确的结果的一个很酷的小技巧。

在 c/c++ 中，代码是：（来自维基百科）

```
float InvSqrt (float x)
{
    float xhalf = 0.5f*x;
    int i = *(int*)&x;
    i = 0x5f3759df - (i>>1);   // Now this is what you call a real magic number
    x = *(float*)&i;
    x = x*(1.5f - xhalf*x*x);
    return x;
} 

```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-08-18T03:41:22.543

几年前，我用 65816 汇编语言为 Apple IIgs 编写了一个基于 tile 的游戏引擎。这是一台相当慢的机器，“在金属上”编程是获得可接受性能的虚拟要求。

为了快速更新图形屏幕，必须将堆栈映射到屏幕，以便使用一些特殊指令，允许在 5 个机器周期内更新 4 个屏幕像素。这没什么特别奇妙的，在[IIgs 技术说明 #70](http://www.umich.edu/~archive/apple2/technotes/tn/iigs/TN.IIGS.070)中有详细描述。核心部分是我必须如何组织代码以使其足够灵活以成为通用库，同时仍保持最大速度。

我将图形屏幕分解为扫描线，并创建了一个 246 字节的代码缓冲区来插入专用的 65816 操作码。之所以需要 246 字节，是因为图形屏幕的每条扫描线是 80 个字宽，并且每端需要 1 个额外的字才能平滑滚动。推送有效地址 (PEA) 指令占用 3 个字节，因此 3 * (80 + 1 + 1) = 246 个字节。

图形屏幕是通过跳转到 246 字节代码缓冲区内对应于屏幕右边缘的地址并在紧跟最左边字的字处将 BRanch Always (BRA) 指令修补到代码中来呈现的。BRA 指令将带符号的 8 位偏移量作为其参数，因此它*几乎没有*跳出代码缓冲区的范围。

即使这不是太难，但真正的核心优化在这里。我的图形引擎实际上通过使用不同的 3 字节代码序列来支持两个独立的背景层和动画图块，具体取决于模式：

1.  背景 1 使用推送有效地址 (PEA) 指令
2.  背景 2 使用加载间接索引 (LDA ($00),y) 指令，后跟推送 (PHA)
3.  动画图块使用加载直接页面索引 (LDA $00,x) 指令，然后是推送 (PHA)

关键限制是 65816 寄存器（X 和 Y）都用于引用数据并且不能修改。进一步地，直接页寄存器(D)是根据第二背景的来源设置的，不能改变；数据库寄存器设置为保存第二背景像素数据的数据库，不能更改；堆栈指针（S）映射到图形屏幕，因此不可能跳转到子程序并返回。

鉴于这些限制，我需要*快速*处理即将被压入堆栈的单词混合在一起的情况，即一半来自背景 1，一半来自背景 2。我的解决方案是用内存换取速度。因为*所有*普通寄存器都在使用中，所以我只有程序计数器 (PC) 寄存器可以使用。我的解决方案如下：

1.  定义一个代码片段以在与代码缓冲区相同的 64K 程序库中进行混合
2.  为 82 个单词中的每一个创建此代码的副本
3.  有1-1的对应关系，所以从代码片段返回的可以是硬编码的地址
4.  完毕！我们有一个不影响 CPU 寄存器的硬编码子程序。

这是实际的代码片段

```
code_buff:   PEA $0000            ; rightmost word (16-bits = 4 pixels)
             PEA $0000            ; background 1
             PEA $0000            ; background 1
             PEA $0000            ; background 1
             LDA (72),y           ; background 2
             PHA
             LDA (70),y           ; background 2
             PHA
             JMP word_68          ; mix the data
word_68_rtn: PEA $0000            ; more background 1
             ...
             PEA $0000
             BRA *+40             ; patched exit code

             ...                  
word_68:     LDA (68),y           ; load data for background 2
             AND #$00FF           ; mask
             ORA #$AB00           ; blend with data from background 1
             PHA
             JMP word_68_rtn      ; jump back
word_66:     LDA (66),y
             ... 
```

最终结果是一个近乎最佳的 blitter，它具有最小的开销，并且在具有 1 MB/s 内存总线的 2.5 MHz CPU 上以 320x200 每秒输出超过 15 帧。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-08-24T10:19:24.183

## 非常生物学的优化

**快速背景：** DNA 核苷酸三联体（A、C、G 和 T）编码氨基酸，这些氨基酸被连接成蛋白质，这些蛋白质构成了大多数生物的组成部分。

通常，每种不同的蛋白质都需要一个单独的 DNA 三联体序列（它的“基因”）来编码其氨基酸——例如，长度为 30、40 和 50 的 3 个蛋白质总共需要 90 + 120 + 150 = 360 个核苷酸。然而，在病毒中，空间是非常宝贵的——所以**一些病毒重叠了不同基因的 DNA 序列**，利用有 6 个可能的“阅读框”用于 DNA 到蛋白质的翻译这一事实（即从一个位置开始）可被 3 整除；从 3 除以余数 1 的位置开始；或从以 3 除以余数 2 的位置开始；再次相同，但反向读取序列。）

为了比较：尝试编写一个 x86 汇编语言程序，其中 300 字节的函数`doFoo()`从偏移量 0x1000 开始......而另一个 200 字节的函数`doBar()`从偏移量 0x1001 开始！（我为这个比赛提议一个名字：*你比乙肝聪明吗？*）

这就是*硬核*空间优化！

**更新：**链接到更多信息：

*   [维基百科上的阅读框架](http://en.wikipedia.org/wiki/Reading_frame)表明乙型肝炎和“大麦黄矮病毒”病毒（一种植物病毒）都重叠阅读框架。
*   [维基百科上的乙型肝炎基因组信息](http://en.wikipedia.org/wiki/Hepatitis_B_virus#Genome)。似乎不同的阅读框亚基会产生不同的表面蛋白变异。
*   或者你可以[谷歌搜索“重叠阅读框”](http://www.google.co.nz/search?q=overlapping+reading+frames)
*   似乎这甚至可能发生在*哺乳动物身上*！ [第二种哺乳动物基因中广泛重叠的阅读框](http://www.nature.com/embor/journal/v2/n9/full/embor338.html)是 Marilyn Kozak 2001 年发表的一篇科学论文，其中谈到了大鼠中具有“广泛重叠阅读框”的“第二种”基因。（这非常令人惊讶，因为哺乳动物的基因组结构为单独的蛋白质提供了足够的空间来容纳单独的基因。）我自己还没有阅读过摘要。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-22T15:31:59.483

Michael Abrash 的“[汇编语言之禅](https://rads.stackoverflow.com/amzn/click/com/0673386023)”有一些漂亮的东西，尽管我承认我不记得我脑海中的细节。

实际上，似乎 Abrash 编写的所有内容都包含一些漂亮的优化内容。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-22T15:43:23.253

我曾经看到一个`switch`有很多空`case`s的声明，开关头部的评论说的是这样的：

> 添加了永远不会命中的 case 语句，因为编译器仅在超过 N 个 case 时才将 switch 转换为跳转表

我忘记了N是什么。这是[在 2004 年泄露](http://news.cnet.com/Windows-code-up-for-grabs/2100-7349_3-5158905.html?tag=mncol;txt)的 Windows 源代码中。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-22T15:28:49.803

斯大林方案编译器在这方面非常疯狂。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-22T15:39:36.287

我已经查看了 Intel（或 AMD）架构参考资料，看看有哪些指令。`movsx`- 带符号扩展的移动非常适合将小有符号值移动到大空间中，例如，在一条指令中。

同样，如果您知道您只使用 16 位值，但您可以访问所有 EAX、EBX、ECX、EDX 等 - 那么您有 8 个非常快的值位置 - 只需将寄存器旋转 16 位即可访问另一个价值观。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-22T16:08:03.810

[EFF DES 破解器](http://en.wikipedia.org/wiki/EFF_DES_cracker)，它使用定制的硬件来生成候选密钥（他们制造的硬件可以证明密钥不是解决方案，但不能证明密钥是解决方案），然后使用更传统的代码进行测试。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-12T03:29:14.777

波兰团队制作的 FSG 2.0 打包器，专门用于打包用汇编制作的可执行文件。如果包装组件不够令人印象深刻（应该尽可能低），它附带的加载程序是 158 字节并且功能齐全。如果您尝试使用诸如[UPX](http://en.wikipedia.org/wiki/UPX)之类的东西打包任何由 .exe 制成的程序集，它将向您抛出 NotCompressableException ;)

# tfs - 团队构建错误：路径 ... 已映射到工作区

> ID：226288
> 
> 赞同：172
> 
> 时间：2008-10-22T15:26:40.727
> 
> 标签：tfs, build-server

在 Team Foundation Server 中创建新版本时，尝试运行新版本时出现以下错误：

> 路径 C:\Build\ProductReleases\FullBuildv5.4.2x\Sources 已映射到工作区 BuildServer_23。

我无法在工作区对话框中看到该名称的工作区。

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2008-10-22T15:30:16.290

使用命令行实用程序*TF - Team Foundation 版本控制工具*( **tf** )。

*您可以通过调出Visual Studio 命令提示符*然后切换到您的工作区文件夹并发出以下命令来获取所有工作区的列表：

```
C:\YourWorkspaceFolder>tf workspaces /owner:* 
```

您应该在列表中看到您的问题工作区及其所有者。

您可以使用以下命令删除工作区：

```
C:\YourWorkspaceFolder>tf workspace /delete /server:BUILDSERVER WORKSPACENAME;OWNERNAME 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2014-11-05T13:36:42.623

只需删除以下文件夹的内容：

**C:\Users\UserName\AppData\Local\Microsoft\Team Foundation\3.0\Cache**

其中 UserName 是实际用户或当前用户，3.0 是版本号。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2015-06-24T16:31:59.443

我遇到了类似的问题，为了删除导致我出现问题的工作区，我登录到另一台安装了 TFS 客户端的机器并执行了以下操作：

*   在“**文件**”菜单上，指向“**源代码管理**”、“**高级**”，然后单击 **“工作区...”**。
*   在**Manage Workspaces**对话框中，勾选**Show remote packages**复选框。
*   在**名称**列下，选择要删除的工作区，然后单击**删除**。
*   在“**确认**”对话框中，单击“**确定**” 。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-02-02T16:30:36.057

我收到此错误，这是由于有两个指向同一来源的构建定义引起的。问题是我在构建代理中使用了静态构建目录。

此论坛帖子准确描述了我的问题和解决方案：http: [//social.msdn.microsoft.com/Forums/en-US/tfsbuild/thread/60a4138a-9b28-4c46-bdf4-f9775ce43c3e/](http://social.msdn.microsoft.com/Forums/en-US/tfsbuild/thread/60a4138a-9b28-4c46-bdf4-f9775ce43c3e/)

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2011-04-14T18:21:15.053

我们遇到了同样的问题，但从 TFS 服务器中删除工作区不起作用。（我应该提一下，我抓住了我的同事虚拟机，该虚拟机已经用他的凭据设置了。）

对我来说这有效：http: [//blogs.msdn.com/b/buckh/archive/2006/09/12/path-is-already-mapped-in-workspace.aspx](http://blogs.msdn.com/b/buckh/archive/2006/09/12/path-is-already-mapped-in-workspace.aspx)

我刚刚进入：...\Local Settings\Application Data\ 搜索了 VersionControl.config，打开了包含该文件的文件夹并删除了它的所有内容。

在此之前，我尝试手动编辑文件，但它继续显示相同的错误消息。

我希望这有帮助。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2011-10-23T03:25:56.350

出于某种原因，我无法从命令行实用程序中删除工作区。幸运的是，我找到[了 Team Foundation Sidekicks 2010](http://www.attrice.info/downloads/index.htm#tfssidekicks2010)（来自[这篇文章](http://social.msdn.microsoft.com/Forums/en-US/tfsgeneral/thread/dd2391e4-1941-4d64-bf70-90d60b045c9a/)），它是免费的，并提供了用于查看和删除 TFS 工作区的 GUI，以及更多有用的 TFS 功能。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-11-07T20:20:56.110

我在 Visual Studio 2010 中遇到了类似的问题，抱怨已经映射的工作区，但我没有删除整个工作区，而是使用了 Visual Studio 命令提示符中的以下内容：“tf workspace PROBLEM_WORKSPACE_NAME”。这带来了一个“编辑工作区”对话框。从那里我能够从“工作文件夹”列表中删除有问题的路径，从而消除了错误。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-08-13T12:16:41.697

其余的相当容易。

只需转到此文件夹：C:\Users{UserName}\AppData\Local\Microsoft\Team Foundation\4\Cache 并删除文件夹中的所有内容。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-07-06T19:26:49.810

我收到一个异常，告诉我该文件已映射到另一个工作区： **“路径 {File Path} 已映射到工作区 {Workspace Name}。”**

此工作区之前已被**删除**。在我朋友的帮助下，我发现 TFS 将工作区信息保存在用户本地设置目录下。我们找到了一个名为：

****{用户文档和设置目录}\Local Settings\Application Data\Microsoft\Team Foundation\1.0\Cache**下的**VersionControl.config 。** 此文件包含 TFS 的所有本地映射。可能当您使用 Map 方法而不使用时： public void DeleteMapping(WorkingFolder mapping); 在删除工作区之前，不会从该文件中删除映射信息，TFS 使用该文件来检查您是否已经映射了特定路径。**

 ****要解决此问题，请从配置文件中删除所有键。不要删除该文件，因为您将再次从服务器缓存中获取它。**

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-04-13T18:16:52.823

这是我所做的（以及我所做的）：

使用 TFS Sidekicks 清除用户和服务器过滤器，使它们为空。这将使您获得所有工作区。

检查工作区名称的构建错误。在 OP 的情况下，它是 BuildServer_23。它在我的环境中有所不同，但基本上只是将错误名称与 tfs sidekick 列表中的名称相匹配。

单击红色 x 删除工作区。

中提琴！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-07-08T05:37:55.130

如果您在服务器上无权删除其他人的工作区，则只需更改构建定义的名称即可。TFS 将创建一个新工作区并将其映射到“C:\Build\ProductReleases\new build name here\Sources”。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-10-30T16:49:31.993

如果适用，您还可以克隆构建定义并更改其名称。这对我有用。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-11-08T17:17:43.593

我尝试了以下所有解决方案，例如：

1.  使用 Sidekick 删除 WS。
2.  使用 tf 命令删除远程服务器工作区。
3.  删除 TFS 缓存文件夹。

以下对我有用：

```
tf workspaces /remove:* 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-08-29T09:19:13.573

删除工作区和缓存对我来说还不够。我还必须重新启动“Visual Studio Team Foundation Build Service Host”服务。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-12-10T23:45:14.077

1.  转到源代码管理资源管理器
2.  在工具栏中有一个工作区的下拉列表。
3.  单击下拉菜单并转到工作区。
4.  删除不需要的工作区。
5.  映射到您的本地。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-01-25T21:42:59.700

我变了

```
Build Definition -> Workspace -> Build Agent Folder 
```

从

```
c:\some\path 
```

到

```
$(SourceDir) 
```

它解决了这个问题。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-08-08T04:45:06.807

在尝试“获取我之前映射到本地目录然后删除的项目的最新版本”时，我看到了同样的错误消息。首先我尝试了 SideKick 工具，然后尝试了 Visual Studio 2010 命令提示符，两者都告诉我没有映射工作区。

接下来我在 中搜索“VersionControl.config” `c:/users/myuser/appdata`，并删除了它找到的 4 个引用。我重新打开了 Visual Studio，我能够重新映射项目，不再出现错误！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-09-04T15:48:30.410

最简单的方法是转到您的 AppData 并删除 TFS 缓存（取决于版本 3.0 或 4.0）

C:\Users{UserName}\AppData\Local\Microsoft\Team Foundation\3.0\Cache 或 C:\Users{UserName}\AppData\Local\Microsoft\Team Foundation\4.0\Cache

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-08-30T21:57:13.663

当我遇到同样的问题时，TDN 的解决方案对我有用。构建服务器在我的帐户下创建了工作区。选中此框允许我查看和删除它们。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-03-09T18:07:41.543

我在 Visual Studio 2017 和 TFS 2017 中遇到了同样的问题。 DefaultCollection 必须首先映射到您的本地路径。不知何故，这一步被跳过了，我只映射了 MyFirstProject。

[![在此处输入图像描述](https://i.stack.imgur.com/KoZMm.jpg)](https://i.stack.imgur.com/KoZMm.jpg)

您需要做的就是：
**- 1.**转到您的 TFS 网页并从服务器中删除该项目。

[![在此处输入图像描述](https://i.stack.imgur.com/6wNhr.jpg)](https://i.stack.imgur.com/6wNhr.jpg)

**- 2.**从您当地的“工作空间”中删除项目

[![在此处输入图像描述](https://i.stack.imgur.com/U6SQv.jpg)](https://i.stack.imgur.com/U6SQv.jpg)

**- 3.**转到“管理连接”，这将刷新您在 TeamExplorer 中的主页。

[![在此处输入图像描述](https://i.stack.imgur.com/SVrn8.jpg)](https://i.stack.imgur.com/SVrn8.jpg)

**- 4.**您将获得配置页面，该页面允许您设置默认集合的根路径。

[![在此处输入图像描述](https://i.stack.imgur.com/Txxes.jpg)](https://i.stack.imgur.com/Txxes.jpg)

**- 5.**您应该会收到成功完成的消息。现在您可以创建您的项目了。

[![在此处输入图像描述](https://i.stack.imgur.com/wpuFu.jpg)](https://i.stack.imgur.com/wpuFu.jpg)

**首先将集合的根映射到工作区，然后再映射一个新项目，这一点很重要。**

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-08-23T16:34:53.447

我的问题与使用多个帐户有关。这就是我能够切换帐户的方式。

打开**团队资源管理器**

从窗格顶部附近的大下拉菜单中...

导航至： **项目和我的团队**>**管理连接**

导航到： **管理连接**>**连接到团队项目**

使用“切换用户”链接切换帐户。

现在工作区名称将与所选帐户匹配。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-03-24T08:51:51.840

我无法获得任何其他解决方案。

我创建了一个新帐户，旧帐户不再具有权限（都在同一台机器上）。

我试过：1）删除工作区（在VS中看不到有或没有检查远程工作区）2）从命令行删除3）新所有者命令4）删除缓存

所以我只是以管理员身份打开 VS 并映射到不同的文件夹。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2018-11-28T20:01:25.227

我在本地 TFS 构建代理中使用 Azure DevOps 自动构建时遇到了这个问题。使用 TFS Sidekicks 删除工作区不起作用。tf.exe 甚至找不到工作区来删除它。

此解决方案应适用于 TFS 2017、TFS 2018、Azure DevOps 以及可能的其他版本：

1.  记下错误消息中的工作区 GUID。
2.  在进行构建的机器上，导航到：%USERPROFILE%\AppData\Local\Microsoft\Team Foundation\（其中 %USERPROFILE% 属于触发构建的用户）。
3.  在该目录下搜索并删除工作区 GUID 的所有实例。“缓存”目录中可能有一个文件夹，以及“LocationServerMap.xml”和“LocalItemExclusions.config”中的条目。将它们全部删除。

这在我的情况下有效。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2019-02-23T07:39:40.033

只需删除工作区：

```
workspace /delete "the-workspace-name" 
```

# vba - 消除启动时的安全警告

> ID：226291
> 
> 赞同：3
> 
> 时间：2008-10-22T15:27:15.297
> 
> 标签：vba, ms-access, ms-office

打开任何 MS Access 数据库时，会出现一条安全警告，指出该文件可能对计算机有害。但是，有没有办法删除此消息。或者它应该仍然是一种必要的邪恶

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T15:37:19.647

您可能可以签署您的程序。我不确定。阅读[这篇文章](http://www.howto-outlook.com/howto/selfcert.htm)，看看是否适用相同的原则。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T15:30:50.377

如果您降低访问选项中的安全设置，我相信它会消失。当然，这些设置是有原因的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-22T15:55:47.330

以下是有关认证和安全性的更多说明。

认证，包括自我认证： http: [//office.microsoft.com/en-us/access/HP010397921033.aspx](http://office.microsoft.com/en-us/access/HP010397921033.aspx)

有关 Office 代码和宏安全的安全主体的一般信息：http: [//office.microsoft.com/en-us/ork2003/CH011480831033.aspx](http://office.microsoft.com/en-us/ork2003/CH011480831033.aspx)

Office 2003 的受信任位置默认值 [http://office.microsoft.com/en-us/ork2003/HA011403181033.aspx?pid=CH011480851033](http://office.microsoft.com/en-us/ork2003/HA011403181033.aspx?pid=CH011480851033)

Office 2003 中的宏安全性 [http://office.microsoft.com/en-us/ork2003/HA011403071033.aspx?pid=CH011480831033](http://office.microsoft.com/en-us/ork2003/HA011403071033.aspx?pid=CH011480831033)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-24T04:58:52.807

您可以通过将访问项目放在**Trusted Location**中来消除 ms-access 项目启动时的安全警告。或者更好的是，创建您自己的可信位置。

我建议在系统 (C) 驱动器中使用您的项目名称创建一个文件夹。例如，我们可以调用文件夹 Database (Path: C:\Database)

然后输入此路径作为注册表项，如下所示：

> [HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\Access\Security\Trusted Locations\Location20] "Path"="C:\Database" "Description"="Access Project location"

现在让我们解释一下这个键的作用：

*   数字**“14.0”**是 MS Office 的版本。您可以简单地将其更改为代表您正在运行的版本的数字。
*   “ **Location20”**是我们分配的唯一名称。20 可以是任何尚未使用的数字。其他程序，包括默认的 MS Access 向导，可能已经使用了其他号码。或者，如果您想将多个路径作为受信任的位置，则每个位置必须以不同的数字结尾。
*   “ **C:\Database\”** 实际上是您要设置为受信任位置的物理路径。您可以在此处放置您选择的任何路径。我不确定它为什么使用双 \，但我只是复制了如何设置以前的键的示例，这似乎效果最好。
*   不需要描述，但显然可以使用任何描述。

有关如何使受信任位置适用于您的 MS Access 项目的更多详细信息，请在此处阅读我们的详细说明：http: [//blog.ideaz.net/2013/12/how-to-remove-microsoft-access-security.html](http://blog.ideaz.net/2013/12/how-to-remove-microsoft-access-security.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T16:48:32.280

这是我几年前关于 Access 2003 的类似内部问题的笔记：

> 好的，这是（显然）交易。
> 
> *   网络服务器不在可信区域中。从 IIRC 开始，使用 SP2，这会在打开文件时导致打开/保存/警告框。默认情况下，UNC 路径应该位于受信任区域中。我不知道为什么不是这样，但解决方法是：**将 server.dns 和服务器添加到 Internet 选项->安全区域->本地 Intranet。**
> *   不安全的表达式不会被阻止。这是一些极其复杂的访问安全模型（谷歌表示不安全的表达式，访问沙盒模式表示更多）。基本上，如果注册表项未设置为禁止“不安全表达式”，Access（我认为从 2003 和/或 Jet 4.0 SP8 开始）会警告您。解决方法：**将 HKLM\Software\Microsoft\Jet\4.0\Engines\SandBoxMode 设置为 3，这会阻止任何使用 Jet 的“不安全表达式”。这必须由管理员完成。或者，我认为以管理员身份对阻止不安全表达式提示回答“是”会为您设置该密钥。**
> *   此文件可能无法安全打开。这是一个简单的方法，并且遵循 Office 中的整个宏安全模型。**只需将工具->宏->安全（不要查看工具->安全菜单...这太明显了）设置为低。**
> 
> 顺便说一句，我仍然不知道“不安全表达式”是什么——也不知道为什么它已经升级到 Jet 4.0 SP8（我通过检查文件版本验证了它是否已更新）。但是随着这些变化，它在启动时不再询问任何内容。--MB

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-11-12T21:19:03.560

1.  在控制面板中，单击“Internet 选项”。
2.  在“Internet 属性”弹出窗口中，选择“安全”选项卡。
    *   选择“本地 Intranet”区域。
    *   单击“站点”按钮。
    *   在“本地 Intranet”弹出窗口中，清除“自动检测...”复选框并设置以下复选框：
        *   “包括未在其他区域中列出的所有本地（Intranet）站点”
        *   “包括所有网络路径 (UNC)”
    *   '好的'。
3.  '好的'。

现在，您 Intranet 上任何位置的所有 Access db 或 UNC 引用的任何数据库都将立即打开而不会发出警告。您评估便利性/安全性权衡。

# java - 在 java.util.List 中查找符合某些条件的对象的最简洁方法？

> ID：226292
> 
> 赞同：4
> 
> 时间：2008-10-22T15:27:28.213
> 
> 标签：java, list

我可以为自己编写一个辅助类，在给定函子时执行此操作，但我想知道是否有更好的方法，或者标准库中是否已经存在某些东西（似乎应该有）。

我在 StackOverflow 上找到的答案都是针对 C# 的，这对我没有帮助。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T15:34:32.350

不——没有。Apache`commons-collections`对这类事情有谓词，但生成的代码（使用匿名内部类）通常很难看，而且调试起来很痛苦。

只需使用基本**的 for 循环**，直到它们将[闭包](http://javac.info)带入语言

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-14T10:50:18.963

例如，通过使用[lambdaj](http://code.google.com/p/lambdaj/)库，您可以找到声誉最高的用户，如下所示：

```
List<User> topUsers = 
    select(users, having(on(User.class).getReputation(), greaterThan(20000))); 
```

它在 Quaere 库方面具有一些优势，因为它不使用任何魔术字符串，它是完全类型安全的，并且在我看来它提供了更易读的 DSL。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-05-15T17:11:46.317

[Querydsl](http://www.querydsl.com/)也通过其 Collections 模块提供此功能。因为我是模块的维护者，所以我有偏见，但我相信鉴于 Java 6 的限制，这是一个选项。

在 Java 7 中，会有闭包可以通过闭包进行过滤，从而减少使用外部库的必要性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T17:53:48.043

有[JXPath](http://commons.apache.org/jxpath/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T18:20:55.337

你可以试试[Quaere](http://quaere.codehaus.org/)。我没有使用它，但它看起来很有趣。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-23T00:01:27.443

[Google Collection Library](http://code.google.com/p/google-collections/)提供了这种帮助方法，比 commons-collections 更干净一些。

# c# - 在 VB.Net/C# Forms 应用程序中打印——布局设计器？

> ID：226294
> 
> 赞同：3
> 
> 时间：2008-10-22T15:27:50.320
> 
> 标签：c#, .net, vb.net, printing

我维护一个 vb.net 表单应用程序，该应用程序将各种标签打印到标签打印机。（标签打印机和任何打印机一样，只是打印区域更小/分辨率更低）

该系统使用打印机硬件支持的传统打印方法，但十多年来已不再普遍使用。我正在从 PrintDocument 类添加要打印的逻辑。我喜欢课程的灵活性，但布局有点乏味。（定义每个 DrawString 命令的大小/位置等）

是否有任何用于生成打印文档布局的软件产品或开源 UI 设计器？设计器输出必须是我可以集成到我的代码中的东西（dll 可以，只是不是单独的可执行文件）并且不能拥有每个用户的许可证。（我的系统上有很多用户）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T15:54:29.377

看看这个线程[Visual Print Design for .NET](https://stackoverflow.com/questions/182670/visual-print-design-for-net)。

此外，您可能会考虑使用可以注入值的 PDF 模板，然后打印 PDF，虽然并不完美，但它可以根据您的需要工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T16:28:01.947

当我寻找类似的需求时，我遇到了一些作为[名片](http://www.neodynamic.com/Products/ImageDraw-SDK-NET/ImageDraw_SDK_NET.aspx?tabid=95&prodid=8)设计师销售的解决方案，看起来很合算。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T15:23:57.620

因为我需要的东西相当简单，所以我继续使用我自己的简单设计器。在[一个很棒的小课堂](http://www.codeproject.com/KB/dotnet/Resize_Control_at_Runtime.aspx)上发现，它使控件可移动/可调整大小，从而节省了大量时间。谢谢大家的想法。

# crystal-reports - 有没有办法让 Crystal Reports 在连接条件中包含一个常量，而不使用 SQL 命令对象？

> ID：226300
> 
> 赞同：4
> 
> 时间：2008-10-22T15:29:00.537
> 
> 标签：crystal-reports

我想要做的是一个表的外部连接，我根据匹配一个常量从连接表中排除记录，但是保留主表中的记录。例如：

```
SELECT a.id, a.other, b.baz
FROM a
LEFT OUTER JOIN b
  ON a.id  = b.id
  AND b.bar = 'foo' 
```

预期成绩：

```
    id 其他 baz      
    -- ---------- --------  
    1 有 foo 包括  
    2 没有（空）   
    3 有 foobar (null)   

```

通过将其置于过滤条件中，我无法获得相同的结果。如果我使用以下内容：

```
SELECT a.id, a.other, b.baz
FROM a
LEFT OUTER JOIN b
  ON a.id  = b.id
WHERE (b.bar IS NULL OR b.bar = 'foo') 
```

我得到这些不正确的结果：

```
    id 其他 baz      
    -- -------- --------  
    1 有 foo 包括  
    2 没有（空）   

```

它排除了恰好与 bar = 'foobar' 的 B 记录匹配的 A 记录。我不希望那样，我希望 A 存在，但在这种情况下 B 为空。

表 B 将有多个需要排除的记录，所以我认为我不能在 Crystal 端过滤这个而不做很多混乱以避免表 A 中重复记录的问题。

我不能使用 SQL 命令对象，因为我们从中运行报告的第三方应用程序似乎阻塞了 SQL 命令对象。

我不能使用视图，因为我们的支持合同不允许修改数据库，而且我们的供应商认为添加视图是一种数据库修改。

我正在使用 Crystal Reports XI，特别是版本 11.0.0.895。万一它有所作为，我正在使用 SQL-92 ODBC 驱动程序针对 Progress 9.1E04 数据库运行。

示例中使用的示例表和数据可以通过以下方式创建：

```
CREATE TABLE a (id INTEGER, other VARCHAR(32));
CREATE TABLE b (id INTEGER, bar VARCHAR(32), baz VARCHAR(32));
insert into A (id, other) values ('1', 'Has foo');
insert into A (id, other) values ('2', 'Has none');
insert into A (id, other) values ('3', 'Has foobar');
insert into B (id, bar, baz) values ('1', 'foo', 'Include');
insert into B (id, bar, baz) values ('1', 'foobar', 'Exclude');
insert into B (id, bar, baz) values ('1', 'another', 'Exclude');
insert into B (id, bar, baz) values ('1', 'More', 'Exclude');
insert into B (id, bar, baz) values ('3', 'foobar', 'Exclude'); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-01-07T22:53:19.240

Crystal 报表无法根据其链接和报表选择标准生成常用的 SQL 语句。您必须使用“命令”或构建视图。

简而言之，水晶很烂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T12:36:23.227

存储过程适合您吗？如果是这样，您可以通过这种方式预先选择数据集，而无需使用命令选项，并且可以像导入表一样导入存储过程。

我会建议执行并加入该存储过程，`select * from b where bar= 'foo'`以便对 b 表进行预过滤，因此您所要做的就是加入另一个联接字段。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T22:19:15.560

您不能在数据库中创建适当的视图并将您的报告基于这些视图吗？我在 MSSQL 上使用 Crystal Reports，通常我只是创建视图以避免类似问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T20:53:15.797

我可以看到两种解决方案：

a) 接受 B 中存在多个（不需要的）行（以及 A 中的重复值），使用 runnign 总计字段和/或公式计算总计 - 这不是简单的方法，但几乎总是可能的；
b) 将 B 移动到子报表中（您可以在其中轻松设置过滤器）并使用共享变量在主报表和子报表之间传达所需的值。

子报表是解决此类问题的强大工具，除非您需要将它们嵌套（不可能）或将报表导出到 excel（添加空行，至少在 CR 9 中）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T20:22:41.940

不确定您是否可以在 Crystal 中执行此操作，但加入 Select 怎么样？

```
SELECT a.id, x.baz
FROM a
LEFT OUTER JOIN 
 (SELECT id, baz FROM b WHERE bar = 'foo') As x ON a.id  = x.id 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-05T09:51:51.997

在我看来，您不想接受任何人的建议，但无论如何，这是最后一搏。我最近使用的数据库必须保持不变的解决方案如下：

1.  设置 Tomcat 服务器，以便我可以运行一些 JSP 和 Hibernate。
2.  获取日食的水晶报告
3.  在水晶报表设计器中使用本地数据库上的伪造数据构建报表，符合我在理想世界中拥有数据的方式
4.  使用 java servlet 将 List 传递给每个表别名，以便报告直接从 POJO 替换数据。POJO 当然可以通过从各种数据库表中提取内容并按照您认为合适的方式将它们混合在一起，从而完全在 java 中组合，通常可以提供一个完全扁平化的数据集，Crystal 报表非常乐意使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-28T21:02:45.503

添加

```
(Isnull({b.bar}) OR {b.bar} = "foo") 
```

记录选择公式应该如您所愿。

** 编辑 **

其他几件事要尝试：

*   使用不同的数据库驱动程序——本机驱动程序（避免 ODBC）可能会有不同的行为。我首先使用 WITH 语法注意到了这一点——SQL Server ODBC 驱动程序不起作用，但 SQL Server 本机驱动程序起作用了。
*   虽然它牺牲了一些灵活性，但将查询嵌入到命令中，假设您可以让第 3 方的产品遵守。为完整性而添加。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-04-07T08:32:44.817

您不应为表 b 添加过滤条件`b.bar is null or b.bar = 'foo'`，但也不应直接访问表 b 中的属性。`if b.bar = 'foo'`您应该通过公式按条件获取所有属性。

# c++ - 在哪里可以查找 C++ STL 中向量的 size_type 定义？

> ID：226302
> 
> 赞同：6
> 
> 时间：2008-10-22T15:29:23.827
> 
> 标签：c++, stl, vector, size

将我的向量`size()`函数的结果转换为`unsigned int`. 不过，我怎么能确定呢？我的文档不清楚如何`size_type`定义。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-22T16:28:44.440

不要假设容器大小的类型（或里面输入的任何其他内容）。

### 今天？

目前最好的解决方案是使用：

```
std::vector<T>::size_type 
```

其中 T 是您的类型。例如：

```
std::vector<std::string>::size_type i ;
std::vector<int>::size_type j ;
std::vector<std::vector<double> >::size_type k ; 
```

（使用 typedef 可以帮助更好地阅读）

迭代器和“内部”STL 容器的所有其他类型也是如此。

### 在 C++0x 之后？

当编译器能够找到变量的类型时，您将能够使用 auto 关键字。例如：

```
void doSomething(const std::vector<double> & p_aData)
{
    std::vector<double>::size_type i = p_aData.size() ; // Old/Current way

    auto j = p_aData.size() ;    // New C++0x way, definition
    decltype(p_aData.size()) k;  // New C++0x way, declaration
} 
```

### 编辑：来自 JF 的问题

> > 如果他需要将容器的大小传递给一些使用无符号整数的现有代码怎么办？– JF

这是使用 STL 的一个常见问题：不做一些工作就无法做到。

第一个解决方案是将代码设计为始终使用 STL 类型。例如：

```
typedef std::vector<int>::size_type VIntSize ;

VIntSize getIndexOfSomeItem(const std::vector<int> p_aInt)
{
   return /* the found value, or some kind of std::npos */
} 
```

第二种是自己进行转换，使用 static_cast，使用一个函数，如果值超出目标类型的范围（有时，我看到代码使用“char”，因为“*你知道，索引会永远不要超过 256* " [我从记忆中引用])。

我相信这本身就是一个完整的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T15:31:38.910

根据标准，*你不能确定*。确切的类型取决于您的机器。不过，您可以查看编译器头文件实现中的定义。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-22T15:42:22.460

我无法想象它在 32 位系统上是不安全的，但 64 位可能是个问题（因为整数仍然是 32 位）。为了安全起见，为什么不将变量声明为 vector<MyType>::size_type 而不是 unsigned int？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T00:08:46.697

C++ 标准仅声明*size_t*在 <cstddef> 中，这将标识符放在 <stddef.h> 中。[我的Harbison & Steele](https://rads.stackoverflow.com/amzn/click/com/013089592X)副本将*size_t*的最小值和最大值放在 <stdint.h> 中。这应该让您了解您的平台需要多大的收件人变量。

您最好的选择是坚持使用足够大以在您的平台上保存指针的整数类型。在 C99 中，这将是*intptr_t*和*uintptr_t*，也正式位于 <stdint.h> 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T16:18:11.280

将其转换为 size_t 应该始终是安全的。unsigned int 在大多数 64 位系统上是不够的，甚至 unsigned long 在 Windows 上也不够（它使用 LLP64 模型而不是大多数类 Unix 系统使用的 LP64 模型）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T15:32:51.230

只要您确定系统上的 unsigned int 足够大以容纳向量中的项目数量，您就应该是安全的；-)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-22T15:53:17.960

我不确定这将如何运作，因为我只是在想我的头脑，但是编译时断言（例如`BOOST_STATIC_ASSERT()`或参见[在 C 中构建时断言表达式的方法](https://stackoverflow.com/questions/174356/ways-to-assert-expressions-at-build-time-in-c)）可能会有所帮助。就像是：

```
BOOST_STATIC_ASSERT( sizeof( unsigned int) >= sizeof( size_type)); 
```

# postgresql - PostgreSQL 大小差异

> ID：226303
> 
> 赞同：1
> 
> 时间：2008-10-22T15:30:13.403
> 
> 标签：postgresql

我有两个使用同一个 sql 文件创建的 PostgreSQL 数据库。其中之一大 2GB。有人可以帮我弄清楚为什么吗？我确定数据库具有相同的行数、表、索引等。数据库位于不同的服务器上，postgresql.conf 和 PostgreSQL 版本存在细微差异。那里的东西会改变磁盘上的大小吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T17:51:11.437

您提到它们位于两个不同的服务器和两个不同的版本上。您是否可能有 32 位操作系统和 64 位操作系统差异，或者主要版本更改（因为我们不知道 Postgresql 团队对磁盘上的底层数据结构所做的所有更改）。您可能会发现它与针对特定机器的 OS/CPU 功能等优化的索引的内部格式有关。

我的评论纯粹是猜测，我没有数据支持我的“主张”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T15:36:16.013

尝试在 PostgreSQL 上使用 VACUUM 命令释放以前使用的空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-04T18:00:44.050

在 PostgreSQL 中，任何单个表、索引或日志都存储为单独的文件。一个复杂的数据库可以有数千个文件。可能差异是由于服务器文件系统中的块大小或集群大小不同。

# matlab - 在 MATLAB 极坐标图上固定径向轴

> ID：226315
> 
> 赞同：15
> 
> 时间：2008-10-22T15:32:34.680
> 
> 标签：matlab, plot, histogram, polar-coordinates

我在 MATLAB 中使用极坐标图 (POLAR(THETA,RHO))。

有没有一种简单的方法可以将径向轴的范围固定为 1.5？

我正在寻找类似于笛卡尔轴的 xlim、ylim 命令的东西。尚未在文档中找到任何内容。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-08-31T18:40:17.967

这对我有用......我希望半径范围达到 30，所以我首先绘制了这个

```
polar(0,30,'-k')
hold on 
```

然后绘制我真正感兴趣的内容。第一个绘制点隐藏在网格标记后面。只要确保包括

```
hold off 
```

在您的最终绘图命令之后。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-22T16:06:52.207

这就是我能够做到的方式。

MATLAB 极坐标图（如果您查看可用的 Handle Graphics 选项）没有 xlim 或 ylim 之类的东西。但是，我意识到绘制的第一件事设置了范围，因此我能够在 [-1 1] 图上绘制半径范围为 [-.5 .5] 的函数，如下所示：

```
theta  = linspace(0,2*pi,100);
r      = sin(2*theta) .* cos(2*theta);
r_max  = 1;
h_fake = polar(theta,r_max*ones(size(theta)));
hold on;
h      = polar(theta, r);
set(h_fake, 'Visible', 'Off'); 
```

这看起来不太好，希望有更好的方法来做到这一点，但它确实有效。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-12T03:04:45.820

简单的解决方案是制作一个假图并将其颜色设置为白色。

```
fake=100;
polar(0,fake,'w');
hold on;

real=10;
polar(0,real,'w'); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-02T09:57:08.403

万一其他人遇到这种情况，这*是*解决方案：

正如***Scottie T***和***gnovice***所指出的，Matlab 基本上使用极坐标函数作为标准绘图的接口，但在幕后进行了大量格式化以使其看起来极坐标。查看极坐标图的 XLim 和 YLim 属性的值，您会注意到它们实际上是笛卡尔坐标中绘图的 x 和 y 限制。因此，要设置半径限制，请使用 xlim 和 ylim 或轴，并对您设置的值保持智能：

```
rlim = 10;
axis([-1 1 -1 1]*rlim); 
```

...这里的所有都是它的。快乐的 Matlabbing :)

# web-services - 在对 Web 服务的调用中欺骗 IP 地址需要多少努力？

> ID：226316
> 
> 赞同：1
> 
> 时间：2008-10-22T15:32:47.313
> 
> 标签：web-services, security, ip-address, spoof

我不想知道怎么... 到底有多复杂....

我正在考虑根据调用者的传入客户端 IP 地址保护一个或 2 个 Web 服务。这以任何方式安全吗？

当然，如果 IP 地址被欺骗，那么结果必须被发送回被欺骗的地址，因此不会到达欺骗者？

更新：好的，据我所知....我应该创建一个 Gettoken() 方法，该方法检查 IP 地址并将具有超时的密码重要令牌传递给任何有效的 IP 地址。在允许任何类型的副作用之前，任何其他方法都需要这样做。

由于攻击者无法（可能）在没有有效 IP 的情况下获得令牌，他将无法有效调用我的任何“危险”网络方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T15:37:37.897

如果您尝试做比 DDoSing 更复杂的事情或触发安全漏洞，那么欺骗不是解决方案。您需要的是一个系统，它将为您的请求提供前端，从而隐藏请求的真实来源。由于我们讨论的是 HTTP 流量，因此[匿名代理](http://en.wikipedia.org/wiki/Anonymous_proxy)可以解决问题。

出于您所指的安全目的，这取决于是否可以采取行动。如果该站点纯粹是信息性的，那么您是安全的。如果站点允许执行操作（例如更新这个、删除那个），那么考虑至少添加密码验证。

要记住的另一个问题是，任何控制您的服务器和您希望允许的 IP 地址之间的路由器的人都可以拦截数据包。这将允许他们在您的服务器没有意识到的情况下进行完整的双向欺骗通信。如果您希望信息真正安全，请使用 HTTPS 和身份验证方案来防止发生此类拦截。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T15:34:40.587

没那么难，就像在任何其他通信中欺骗您的 IP 地址一样简单 [http://en.wikipedia.org/wiki/IP_address_spoofing](http://en.wikipedia.org/wiki/IP_address_spoofing)

但他们不会得到回应。他们欺骗的实际IP地址会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T15:38:52.560

你是对的。如果您的服务器响应需要到达客户端以建立双向通信，那么欺骗性 IP 将永远不会收到您的响应。但是，您可能会遭受来自欺骗性 IP 的拒绝服务攻击，因为计算您的响应会消耗服务器上的一些 CPU。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T15:49:52.927

我们的 Web 服务安全性的一部分是要求客户端使用公钥/私钥加密（xml 数字签名）来确保不可否认性，以确保只有被允许的客户端才能访问服务。

# svn - 你会推荐什么 TFS 工具？

> ID：226330
> 
> 赞同：0
> 
> 时间：2008-10-22T15:35:14.347
> 
> 标签：svn, version-control, tfs

我主要习惯于使用 Subversion 进行源代码控制。但是，我目前的职位让我使用 TFS。TFS 资源管理器的 UI 及其与 Visual Studio 的集成让我有点迷失方向。我想念 SmartSVN 之类的工具，在那里我可以一目了然地看到我已修改的内容并正在等待签入。

一般来说，您推荐哪些工具集用于 TFS，以及您知道哪些工具可以实现这种可视化？我知道 TFS 资源管理器会向您显示待处理的签入，但我想念有一个单独的工具来监视文件系统更改并自动刷新文件列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T15:54:11.500

解决方案资源管理器中提供了签出/修改信息。签出的项目在其名称/图标旁边有一个复选标记。托运的物品有锁。签出给其他人的项目有一个人形图标。您还可以右键单击并查看待处理的更改。我发现这向我显示了我在团队资源管理器中加载的所有项目的所有未决更改，因此有点麻烦。我希望它知道我当前的项目并且只显示与之相关的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T16:03:40.187

总有[SVNBridge](http://codeplex.com/svnbridge)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T15:56:22.430

我发现使用 TFS 的唯一不涉及 Visual Studio 的第 3 方软件是[Attrice Sidekicks](http://www.attrice.info/cm/tfs/)。不幸的是，对于源代码控制和工作项管理的日常工作，它并没有真正的帮助。

还有微软的[TFS Powertoys](http://msdn.microsoft.com/en-us/vstudio/aa718351.aspx)，它添加了一个新的命令行应用程序，使一些事情变得更容易。我用它来做“恢复不变”，但它可以做其他事情。

不幸的是，似乎没有任何方法可以处理不涉及命令行工具或 Visual Studio 的源代码控制。这是一个巨大的痛苦，因为我不需要为我正在做的任何其他工作打开 VS，所以我坚持使用 VS 吃一堆 RAM。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T16:07:22.783

有时我的待定更改窗口对我来说是谎言，既声称我有我没有的更改，又（更糟糕的是）没有列出我所做的更改，这显然可能是一场灾难。

一种粗略的解决方法是转到源代码管理资源管理器，右键单击文件夹，然后选择比较。

当我做了很多更改以至于我不确定待处理更改中的列表是否正确时，我会这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-10T21:06:15.923

Teamprise ( [http://www.teamprise.com/](http://www.teamprise.com/) ) 是一个独立的工具，支持您所说的 TFS（以及与其他 IDE 的集成，包括 Eclipse）。我从来没有使用过它，所以我不能保证它，但它来自 Sourcegear 的人。过去我对他们的其他产品印象深刻。

# user-interface - GUI的自动化测试

> ID：226342
> 
> 赞同：8
> 
> 时间：2008-10-22T15:38:22.310
> 
> 标签：user-interface, testing, automation

**这个问题与单元测试无关。它适用于桌面产品。**

这是关于测试 gui 并测试在正确的时间在正确的文本框中输入正确的内容。

我曾经工作过的一家公司使用过 WinRunner（不同的部门，所以我不太了解），但现在它已被惠普关闭，但无论你是留在惠普还是去其他地方，他们似乎都不在乎。在您注册之前，您无法阅读有关该产品的信息，这很烦人。

该工具必须与 MFC（不可协商）一起使用，理想的工具也将...

*   自动化。
*   可编写脚本。
*   自动使用不同的屏幕分辨率。
*   能够“窥探”单个静​​态文本框等。
*   足够直观，因此非程序员也可以创建脚本。
*   拥有报告工具，包括个人用户的电子邮件。

其他 SO 用户为自动化 GUI 测试做了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-22T17:24:13.893

我们为 Rational Robot (RRAFS)使用[SAFS 框架。](http://safsdev.sourceforge.net/Default.htm)WinRunner (WRAFS) 也有 SAFS 实现，看起来他们有一个新的“基于图像的测试”实现，我不熟悉。

这个框架很好地将 UI 实现与测试脚本分开。我已经测试了由两个不同团队开发的 Web 应用程序的四个版本（一个团队使用经典 ASP，一个使用 ASP.NET），我只需要更改我的 UI 对象的应用程序映射，测试本身不需要改变。

也就是说，框架的语言很麻烦，需要习惯。就语言结构而言，它不是很健壮，但是通过一些努力，您可以做任何您需要做的事情。这有点像 Windows Batch 语言中的“编程”，但用于测试；）

为了满足您的上述个人要求：

1)**该工具必须与 MFC 一起使用（不可协商）。** SAFS 框架使用第 3 方“记录回放”工具来驱动测试，例如 Rational Robot 或 Mercury WinRunner。如果该工具可以与 MFC 应用程序交互，那么框架可以。我不知道“基于图像的测试”实现如何驱动测试，但我猜它也可以与 MFC 一起使用。

2）**自动化。** SAFS 框架与[STAF](http://staf.sourceforge.net/)框架集成，这将允许您自动执行测试。我有一个概念验证测试，它使用 STAF 从映像池中启动 VM 映像，安装被测应用程序，运行 RRAFS 测试，并将结果放在 Web 服务器上供其他人使用。

3)**可编写脚本。** 是的，但如前所述，它不是最强大的编程语言。我写了一个 Excel 加载项，我们的测试人员用它来编写他们的测试，这可以稍微简化一些事情。

4)**自动使用不同的屏幕分辨率。** 是的，因为它在 UI 对象而不是屏幕上“隐藏”。除了“基于图像的测试”选项之外......

5）**能够“窥探”单个静​​态文本框等。** 是的，您可以等待 UI 对象出现、消失、具有值、更改值等。

6)**足够直观，非程序员也可以创建脚本。** 经过一些训练。我们取得了有限的成功。一些 QA 人员可以编写测试，但有些人很挣扎。

7)**有报告工具，包括个人用户的电子邮件。** 是的，使用 STAF 框架，您可以将结果发布到 Web 服务器、发送电子邮件等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T22:18:55.187

这里有很多好的答案，但我想解决这个目标声明，特别是：

*   足够直观，因此非程序员也可以创建脚本

我能理解你为什么想要这个，但它比你想象的要困难得多。虽然您可以找到许多*声称*可以轻松编写脚本的工具，但在实践中，您的自动化团队中至少需要一些懂编程的人。编写相当健壮的脚本将涉及循环、if/then/else 和子例程调用中的一种或多种。不是非程序员会觉得直观的东西。

特别要警惕您可以使用工具“记录”一个人，然后回放以进行测试的想法。这种“自动化”通常非常脆弱，以至于您最终会为软件中的几乎每一次更改修改或重新录制脚本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-24T20:09:49.067

来自强大的 Mercury/HP 背景，我强烈建议您使用 QuickTest Professional 进行 GUI 测试。它有很多与 WinRunner 相同的功能，但没有很多代码。可以通过 QTP 界面使用最少的自定义 VB 代码（如果有的话）完成简单的 GUI 检查。可以使用 QTP 中的数据表通过简单的比较来检查框旁边的文本。

如果您习惯了 WinRunner，并且知道 VBScript（不太了解 TSL），那么我肯定会看 QTP。

至于您的其他要求，QTP 还具有 Spy 功能，如 WinRunner，它将列出您可以对对象执行的所有属性和操作。至于使用的简单性，在我以前的工作中，我们会让业务或系统测试人员创建简单的烟雾脚本，然后我会使用它们并对它们进行编码以进行更深入的测试（多个数据值、错误检查等）。至于报告，QTP 将对您输入的标签以及您可以输入的自定义数据进行简单的通过/失败/警告报告。因此，您可以使用 case 语句根据结果填充输出值。它不会直接发送电子邮件，但如果您与 TestDirector/QualityCenter 集成，您可以通过那里进行设置，以及自动启动脚本，

拍

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T15:43:01.927

请参阅[用户界面测试](https://stackoverflow.com/questions/41601/user-interface-testing)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-22T16:54:46.057

桌面或 Web 应用程序在这里具有相同的测试模式（我在这两个方面都工作过）。

在 UI 中放置尽可能少的逻辑并测试其下方的所有内容。所以你说，但是如果我想测试单击按钮时会发生这样那样的事情怎么办？单击该按钮时调用的方法应该调用另一个实际进行思考的类。

您可能会说，但我正在使用一些只能存在于我的 UI 中的静态类/方法，用适配器包装它们并利用该接口以使您的代码可测试。

您想要自动化的 GUI 测试部分应该在 UI 下方自动化。GUI 的某些部分无法自动化。检查以确保事情“看起来正确”，或测试您是否可以看到某些元素等。所有这些都是您的人类应该做的。确保事件正确触发，并且从您的业务对象中正确返回值，这就是所有单元测试。

从您的问题中我可以看出，您几乎已经决定需要一个自动化 GUI 测试器，但这不是这项工作的正确工具。如果您决定使用它，您就是在尝试找到做错事的最佳方法。

如果您认为这与单元测试无关，因为您正在测试 GUI 交互，那么我可以保证您的单元测试距离您的 UI 不够近。如果你是，你会觉得你要测试的大部分内容都是多余的。

如果您不同意我的观点，请发表一些理由，我们将对此进行讨论。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T20:45:02.987

如果您正在测试网络产品，还有更多（开源）替代方案。对于桌面产品，下面是一些流行的通用桌面 GUI 自动化工具（排名不分先后）。我亲自与所有这些人一起工作过，他们都完成了工作。如果您选择使用供应商工具，请为您正在考虑的工具获取 POC，并根据总体上最适合公司的工具做出决定。一种工具可能更适合特定应用程序，但可能还有其他项目/应用程序需要考虑。

*   QuickTest Pro（HP 的 WinRunner 继任者）
*   Rational Functional Tester（IBM 的 Robot 的继任者）
*   测试伙伴

# payment - 加拿大网站支付处理器推荐？

> ID：226353
> 
> 赞同：18
> 
> 时间：2008-10-22T15:40:36.987
> 
> 标签：payment

之前已经问过这个问题（[链接](https://stackoverflow.com/questions/2556/whats-the-best-online-payment-processing-solution)），但我的要求略有不同。首先，我在加拿大，因此排除了 Google Checkout 和其他一些可能。我只需要提供“立即购买”功能的基本服务，不需要购物车或类似的东西。该网站的流量不是很大，所以我想避免任何月费疯狂的网站。我还需要能够为特殊促销设置“折扣代码”（或任何您想称呼的代码）。该站点还必须具有某种付款通知服务 (IPN)。我目前正在使用 PayPal，但他们缺乏折扣代码确实开始限制我的能力。

您使用了什么，或者您建议我进一步调查什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-22T17:47:13.720

我在加拿大使用[过 Beanstream](https://www.beanstream.com)。它们提供托管服务，您可以在其中提供指向站点中自定义 Beanstream 页面的链接；他们完成所有付款处理并将资金存入您的银行帐户。您可以编辑结帐页面以使其与您的网站相匹配，并根据具体情况创建购物车或提供费用。我知道您说过您不需要购物车，但每月只需多付 10 美元。

如果您想自己接受信用卡，它们还提供网关 API，但我发现托管服务更加方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T15:44:18.227

我在[eMetrix](http://www.emetrix.com/)上运气不错。我也听说过关于[Plimus](http://www.plimus.com/)的好消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T17:23:41.460

[有人对eSellerate](http://www.esellerate.net)有任何经验吗？Plimus 看起来不错，尽管我从客户的角度听到了一些与电话验证相关的恐怖故事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T17:30:37.747

在[TeamMentor 上](http://teammentor.securityinnovation.com)，我们使用[Payflow Pro](https://www.paypal.com/us/cgi-bin/webscr?cmd=_payflow-pro-overview-outside)并获得了很好的体验。SDK 简单易用，特别是如果您只需要一个快速的“立即购买”选项。他们支持国际处理，尽管在美国以外没有贝宝处理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T17:59:18.500

我在一个客户站点看到了[Moneris的用法。](http://www.moneris.com/index.php?context=/products)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T02:39:57.937

我使用了 Payflow Pro 和 Paypal Payments Pro。从 API 的角度来看，我发现它们很容易使用，虽然 Payflow 的 php API 运行良好，但它需要重新编译 php，这意味着修补我们的服务器不太容易。在服务器设置之后，每个都同样可以。使用 Paypal 产品的最大缺点是客户支持和设置。设置是一场噩梦，我们处理的“推销员”/客户代表也没什么帮助。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-22T17:45:23.507

也许您应该添加一些有关您的要求的详细信息：

*   如果足够，请尝试银行转账。它们在所有国家/地区都不为人所知或免费，我也不了解加拿大，但它是欧洲最好的支付系统：您只需告诉您的银行将钱转入目的地账户即可。
    *   好处：
        *   无法撤消。
        *   客户有付款证明。
        *   免费（欧洲大多数银行）
    *   坏处：
        *   无法撤消；）
        *   客户必须命令他/她的银行转账。
        *   这笔钱最多需要三天时间才会出现在您的帐户中。
*   您需要“即时”付款吗？
*   国际支付？

# ios - 如何立即移动 CALayer（无动画）

> ID：226354
> 
> 赞同：81
> 
> 时间：2008-10-22T15:40:40.840
> 
> 标签：ios, objective-c, cocoa-touch, core-animation, calayer

我正在尝试`CALayer`在 iOS 应用程序中拖动 a 。

一旦我改变它的位置属性，它就会尝试动画到新的位置并在整个地方闪烁：

```
 layer.position = CGPointMake(x, y) 
```

我怎样才能`CALayers`立即移动？我似乎无法理解 Core Animation API。

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2008-10-22T17:22:12.883

您想将您的电话包装在以下内容中：

```
[CATransaction begin]; 
[CATransaction setValue: (id) kCFBooleanTrue forKey: kCATransactionDisableActions];
layer.position = CGPointMake(x, y);
[CATransaction commit]; 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2015-11-27T16:59:47.583

Swift 3 扩展：

```
extension CALayer {
    class func performWithoutAnimation(_ actionsWithoutAnimation: () -> Void){
        CATransaction.begin()
        CATransaction.setValue(true, forKey: kCATransactionDisableActions)
        actionsWithoutAnimation()
        CATransaction.commit()
    }
} 
```

用法 ：

```
CALayer.performWithoutAnimation(){
    someLayer.position = newPosition
} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2011-09-13T23:20:26.660

您还可以使用便利功能

```
[CATransaction setDisableActions:YES] 
```

也是。

注意：请务必阅读 Yogev Shelly 的评论，以了解可能出现的任何问题。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-05-05T04:04:42.863

正如其他人建议的那样，您可以使用`CATransaction`.
出现问题是因为 CALayer 的默认隐式动画持续时间为 0.25 秒。

因此，一个更简单（在我看来）的替代方法`setDisableActions`是`setAnimationDuration`使用`0.0`.

```
[CATransaction begin];
[CATransaction setAnimationDuration:0.0];
layer.position = CGPointMake(x, y);
[CATransaction commit]; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-11-22T11:34:47.697

在此处结合 Swift 4 的先前答案，以清楚地明确动画持续时间...

```
extension CALayer
{
    class func perform(withDuration duration: Double, actions: () -> Void) {
        CATransaction.begin()
        CATransaction.setAnimationDuration(duration)
        actions()
        CATransaction.commit()
    }
} 
```

用法...

```
CALayer.perform(withDuration: 0.0) {
            aLayer.frame = aFrame
        } 
```

# c# - 在 WPF/C# 中显示时区。发现夏令时偏移

> ID：226356
> 
> 赞同：3
> 
> 时间：2008-10-22T15:41:07.453
> 
> 标签：c#, wpf, datetime, timezone

我无法理解系统注册表如何帮助我将 DateTime 对象转换为相应的 TimeZone。我有一个示例，我一直在尝试进行逆向工程，但我无法遵循 UTCtime 根据夏令时偏移的关键步骤。

我正在使用 .NET 3.5（感谢上帝），但它仍然让我感到困惑。

谢谢

编辑：附加信息：此问题用于 WPF 应用程序环境。我在下面留下的代码片段使答案示例更进一步，以获得我正在寻找的内容。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-22T18:44:40.843

这是我在 WPF 应用程序中使用的 C# 代码片段。这将为您提供您提供的时区 ID 的当前时间（根据夏令时调整）。

```
// _timeZoneId is the String value found in the System Registry.
// You can look up the list of TimeZones on your system using this:
// ReadOnlyCollection<TimeZoneInfo> current = TimeZoneInfo.GetSystemTimeZones();
// As long as your _timeZoneId string is in the registry 
// the _now DateTime object will contain
// the current time (adjusted for Daylight Savings Time) for that Time Zone.
string _timeZoneId = "Pacific Standard Time";
DateTime startTime = DateTime.UtcNow;
TimeZoneInfo tst = TimeZoneInfo.FindSystemTimeZoneById(_timeZoneId);
_now = TimeZoneInfo.ConvertTime(startTime, TimeZoneInfo.Utc, tst); 
```

这是我最终得到的代码片段。谢谢您的帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T15:52:15.480

您可以使用 DateTimeOffset 来获取 UTC 偏移量，因此您不需要深入注册表以获取该信息。

TimeZone.CurrentTimeZone 返回额外的时区数据，TimeZoneInfo.Local 有关于时区的元数据（例如它是否支持夏令时，各种状态的名称等）。

更新：我认为这特别回答了你的问题：

```
var tzi = TimeZoneInfo.FindSystemTimeZoneById("Pacific Standard Time");
var dto = new DateTimeOffset(2008, 10, 22, 13, 6, 0, tzi.BaseUtcOffset);
Console.WriteLine(dto);
Console.ReadLine(); 
```

该代码在 -8 偏移处创建一个 DateTime。[MSDN 上列出了](http://msdn.microsoft.com/en-us/library/bb384272.aspx)默认安装的时区。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-10T23:21:27.890

```
//C#.NET
    public static bool IsDaylightSavingTime()
    {
        return IsDaylightSavingTime(DateTime.Now);
    }
    public static bool IsDaylightSavingTime(DateTime timeToCheck)
    {
        bool isDST = false;
        System.Globalization.DaylightTime changes 
            = TimeZone.CurrentTimeZone.GetDaylightChanges(timeToCheck.Year);
        if (timeToCheck >= changes.Start && timeToCheck <= changes.End)
        {
            isDST = true;
        }
        return isDST;
    }

'' VB.NET
Const noDate As Date = #1/1/1950#
Public Shared Function IsDaylightSavingTime( _ 
 Optional ByVal timeToCheck As Date = noDate) As Boolean
    Dim isDST As Boolean = False
    If timeToCheck = noDate Then timeToCheck = Date.Now
    Dim changes As DaylightTime = TimeZone.CurrentTimeZone _
         .GetDaylightChanges(timeToCheck.Year)
    If timeToCheck >= changes.Start And timeToCheck <= changes.End Then
        isDST = True
    End If
    Return isDST
End Function 
```

# iphone - 是否可以删除 UIImagePickerController 中的“取消”按钮？

> ID：226365
> 
> 赞同：1
> 
> 时间：2008-10-22T15:42:53.923
> 
> 标签：iphone, cocoa-touch

我有一个 UIImagePickerController 作为 TabBar 设置中的一个视图。浏览照片库时，是否可以告诉 UIImagePickerController 在顶部导航栏中不显示“取消”按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T18:26:19.697

不是以受支持的方式。UIImagePickerController 被设计为显示为模态控制器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-11T15:18:12.100

我刚刚写了一篇关于自定义 UIImagePickerController 创建的视图层次结构的简短博客文章。它针对的是相机拍摄模式而不是照片库，但原理应该是一样的。

请参阅：[Airsource - UIImagePickerController 的视图](http://blog.airsource.co.uk/index.php/2008/11/11/views-of-uiimagepickercontroller/)

# .net - LINQ to SQL 并发冲突 - 看起来像一个带有正确行版本控制的干净附加

> ID：226374
> 
> 赞同：3
> 
> 时间：2008-10-22T15:44:49.850
> 
> 标签：.net, asp.net, linq, linq-to-sql

我试图让 LINQ to SQL 持久化对附加对象的更改，其中后备表有一个 DateTime 列，我*认为*该列应该用于行版本控制，如此[处](http://geekswithblogs.net/michelotti/archive/2007/12/18/117823.aspx)所述。

该表如下所示：

```
CREATE TABLE [dbo].[client](
[client_id] [int] IDENTITY(1,1) NOT NULL,
[client_address1] varchar(100) NULL,
/* snip */
[modified_date] datetime NOT NULL,
CONSTRAINT [PK_CLIENT] PRIMARY KEY CLUSTERED ([client_id] ASC) ) 
```

modified_date 属性的相关属性在 DBML 设计器中设置如下：

```
自动生成值：真
自动同步：始终
可空：假
主键：假
只读：错误
服务器数据类型：日期时间
来源：修改日期
时间戳：真
更新检查：从不

```

据我所知，modified_date 属性声明的结果属性看起来是正确的：

```
[Column(Storage="_modified_date", AutoSync=AutoSync.Always, 
DbType="DateTime", IsDbGenerated=true, IsVersion=true, 
UpdateCheck=UpdateCheck.Never)] 
```

尝试将更改保存到客户端的过程如下所示：

```
var c = new client { client_id = idOfClientToSave };

c.client_address1 = uxAddress1.Text;

// The DataContext is initialized in the constructor
// of ClientDataAccess
using (var ClientData = new ClientDataAccess())
{
    ClientData.SaveClient(c);
} 
```

最后，尝试提交更改的方法如下所示：

```
public int SaveClient(client c)
{
    c.modified_date = DateTime.Now.ToUniversalTime();

    if (c.client_id == 0)
    {
        _db.GetTable<client>().InsertOnSubmit(c);
    }
    else
    {
        _db.GetTable<client>().Attach(c, true);
    }
    try
    {
        _db.SubmitChanges(ConflictMode.ContinueOnConflict);
    }
    catch (ChangeConflictException)
    {
        foreach (var con in _db.ChangeConflicts)
        {
            con.Resolve(RefreshMode.OverwriteCurrentValues);
        }
        throw;
    }
} 
```

但是 _db.SubmitChanges(ConflictMode.ContinueOnConflict) 仍然会引发 ChangeConflict 异常（与 _db.SubmitChanges() 一样）。我看不出附加的对象可能如何源自当前的 DataContext，因为它是自己实例化的，并且在附加之前没有从 DataContext 中检索。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T15:53:34.700

尝试在新版本后面加载原始对象。

```
else   
{
    _db.GetTable<client>().Attach(c, true);
    _db.Refresh(RefreshMode.KeepCurrentValues, c);
} 
```

我从[这篇文章](http://www.codeproject.com/KB/architecture/EnterpriseApplicationArch.aspx)中学到了这项技术，在以下部分：更新（和删除）操作的并发模式。

# c++ - 操作系统编译时间

> ID：226377
> 
> 赞同：31
> 
> 时间：2008-10-22T15:45:05.497
> 
> 标签：c++, c, operating-system, compilation, buildfarm

这只是一个一般性问题 - 我正坐着等待编译一些软件（我们在这里使用 Incredibuild，但仍然需要 10/15 分钟），这让我想知道，有谁知道编译 Windows XP 需要多长时间还是远景？

我做了一些谷歌搜索，但并没有真正找到任何有用的信息

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-10-22T16:27:26.847

OP 正在询问***Windows***：

> “没有像这样的其他软件项目，” [Lucovsky](http://en.wikipedia.org/wiki/Mark_Lucovsky)说，“但 [多年来] 保持不变的一件事是构建 [Windows] 需要多长时间。***无论是哪一代产品，都需要 12 个小时编译和链接系统。***“即使这些年来处理能力的提高，Windows 也已与之匹敌，开发过程也变得更加复杂，因此微软在日常构建中进行了更多的代码分析。”构建实验室中的 CPU 是12 个小时，”他说。“我们从 Windows 2000 开始调整了这个过程。现在，我们将源代码树分解为独立的源代码树，并使用新的构建环境。这是一个多机环境，可以让我们更快地转动曲柄。但由于所有新的代码分析，仍然需要 12 个小时。”

[来源](http://web.archive.org/web/20100712104930/http://www.winsupersite.com/reviews/winserver2k3_gold2.asp)

另请参阅 Mark Lucovsky关于开发 Windows NT/2000 的经典[演讲。](http://www.usenix.org/events/usenix-win2000/invitedtalks/lucovsky_html/sld001.htm)

我不在微软工作，所以我不确定...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-22T15:48:18.080

我掌握的第三手信息是，完成一个 Windows 构建大约需要一天时间。这或多或少符合尝试从头开始构建您最喜欢的 OSS 操作系统。

构建现代操作系统是一项复杂而艰巨的任务。不需要更长时间的唯一原因是因为像微软这样的公司已经设置了构建环境来帮助自动化集成测试。因此，与大多数 OSS 构建相比，他们可以用更少的人工来构建系统。

如果您想了解构建操作系统需要什么，我可以推荐免费的电子书：[Linux from Scratch](http://www.linuxfromscratch.org/)

如需更自动化的构建，请尝试使用[Gentoo](http://www.gentoo.org/)。这两个选项都应该让您更好地了解操作系统构建过程。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-12-11T23:05:14.443

Windows 团队开发副总裁[Ales Holecek](https://channel9.msdn.com/Events/Speakers/ale+holeek)[表示](https://twitter.com/DawidFerenczy/status/543171331328864257)，构建 Windows 10**大约需要 16 个小时**。而且它是每天晚上自动构建的。

当然，它不是使用单台机器构建的，而是使用一些构建农场。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-22T15:50:28.387

好吧，自己尝试一下：获取 Gentoo（或其他 Linux）发行版或尝试 Microsoft Research 的 Singularity 项目。另一个有趣的替代方案是 ReactOS 项目。单独编译内核大约需要（取决于机器）等待程序的 15 分钟。编译整个系统需要更长*的*时间！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-03-27T02:51:46.870

说 12-24 小时或过夜的答案几乎肯定是正确的。

很久以前，当我在微软时，每次我听到它，他们都会“每晚”构建。（我曾经相当定期地加载 NT 的每日构建。如果我记得正确的话，他们每周都会进行“检查构建”或类似的。）

版本末尾的那些数字是（或至少是）这些每日构建增量：

我的 Windows 8.1：
C:\WINDOWS\system32 > ver Microsoft Windows [版本 6.3\. **9600** ]

将 9600 除以 365 得出大约 26 年的每日构建时间，或者从 2013 年发布 8.1/2012-R2 开始，到 1987 年左右开始在 NT 上进行开发，Windows NT 3.1 于 1993 年发布。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-22T15:59:26.263

我记得听说 Vista 花了一天多的时间来构建（虽然现在找不到参考，唉）。它有大约[5000 万行代码](http://www.knowing.net/PermaLink,guid,c4bdc793-bbcf-4fff-8167-3eb1f4f4ef99.aspx)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-22T16:06:18.683

需要多长时间实际上取决于构建设置，我真的怀疑 Vista 工程师是否需要一天来构建代码，即使在一台机器上需要一天。

我从事类似规模的项目，直到最近，在共享的多处理器 sun 服务器上构建可能需要长达 12 个小时。由于我们已经切换到基于 Linux 的构建农场，因此可以在不到一小时的时间内完成干净的构建，并在几分钟内完成重建。

知道 Vista 的人正在使用什么设置会很有趣，基于 Linux 的构建农场似乎不太可能......那么也许是基于 Windows 的构建农场 :)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-22T17:11:43.607

我不知道编译 XP 需要多长时间，但 10/15 分钟一点也不大。我们的项目将 Linux 内核作为组件之一（不是最大的）编译大约需要一个小时。我们通过使用[ccache](http://ccache.samba.org/)改进了这一点，现在只需几分钟。

不完全是您问题的答案，但我虽然它可能是相关/有用的。

# .net - 如何从 .NET 中的 Active Directory 获取所需的最小密码长度值

> ID：226378
> 
> 赞同：0
> 
> 时间：2008-10-22T15:45:42.983
> 
> 标签：.net, active-directory, membership-provider

我正在实现一个插件架构来实现身份验证，这是一个网站的外部身份验证机制。我计划提供的插件之一是 ActiveDirectory 插件。我想实现 MembershipProvider 的一些功能，包括 MinRequiredPasswordLength，但不想完全实现或配置 ActiveDirectoryMembershipProvider。

有谁知道如何查询 AD 并获得所需的最小密码长度？我知道这可以由 GPO 设置，并根据策略因用户/计算机而异，但我想提供基于域默认值的默认值，而不是任意数字。

[编辑] ActiveDirectoryMembershipProvider 的配置[示例](http://msdn.microsoft.com/en-us/library/system.web.security.activedirectorymembershipprovider.minrequiredpasswordlength.aspx)将其显示为在配置中设置。有没有办法将它与域策略联系起来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T17:30:31.813

域的根有一个名为“minPwdLength”的属性还有其他几个与密码策略相关的属性（minPwdAge、maxPwdAge、lockoutDuration 等）

在具有细粒度密码策略的 Windows Server 2008 域中，这会变得更加复杂，因为您可以为不同的 OU 设置不同的密码策略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T16:00:34.403

只是一个提示：我使用 DirectorySearcher (System.DirectoryServices) 来查询 ActiveDirectory，如果有办法查询您要查找的内容，我不知道...

希望能帮助到你

# php - PHP 流上下文对文件操作有什么作用？

> ID：226380
> 
> 赞同：2
> 
> 时间：2008-10-22T15:46:19.067
> 
> 标签：php, file-io

在 PHP 手册中，文件操作引用了一个可选的上下文（例如[copy](http://us3.php.net/copy)）。这些上下文如何影响基本的文件操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T17:47:37.403

事实证明，流上下文可以包含[选项](http://us2.php.net/manual/en/context.php)和[参数](http://us2.php.net/manual/en/function.stream-context-set-params.php)。目前，参数只是简单的回调函数，以便您可以在文件操作的各个点得到通知。选项是特定于包装器的，文件系统操作没有任何选项。HTTP 包装器的一些选项示例包括方法、代理等。

# postgresql - 我应该如何修改 PostgreSQL 的 SQL 查询？

> ID：226382
> 
> 赞同：2
> 
> 时间：2008-10-22T15:46:35.150
> 
> 标签：postgresql

我有 SQL 查询，它在 Oracle 和 MSSQL 上运行良好。现在我在 PostgreSQL 上尝试这个，它给出了一个奇怪的异常：`org.postgresql.util.PSQLException: ERROR: missing FROM-clause entry for table "main"`

这是查询：

```
SELECT *
FROM "main" main
     INNER JOIN "something_link" something_link ON main."id" = something_link."mainid"
     INNER JOIN "something" somehting ON something_link."somethingid" = something."id"
     INNER JOIN "type" type ON something."typeid" = type."id" 
```

这是一个非常简单的查询，我不明白为什么它不能在 Windows XP SP2、PostgreSQL 8.3 上运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T16:07:45.043

某事=>某事

```
postgres=#创建数据库测试
postgres-#;
创建数据库

postgres=# \c 测试
您现在已连接到数据库“test”。

测试=#选择版本（）；
                                            版本                                            
-------------------------------------------------- ---------------------------------------------
 i486-pc-linux-gnu 上的 PostgreSQL 8.3.3，由 GCC cc (GCC) 4.2.3 (Ubuntu 4.2.3-2ubuntu7) 编译

test=# 创建表 main(id int);
创建表

test=# 创建表 something_link(mainid int);
创建表

测试=#创建表的东西（id int）；
创建表

test=# 创建表类型(id int);
创建表

test=# alter table something 添加列 typeid int;
更改表

测试=#选择*
测试-# FROM "main" main
测试-# INNER JOIN "something_link" something_link ON main."id" = something_link."mainid"
test-# INNER JOIN "something" somehting ON something_link."somethingid" = something."id"
test-# INNER JOIN "type" type ON something."typeid" = type."id"
测试-＃ ;
错误：something_link.somethingid 列不存在
LINE 4: INNER JOIN "something" somehting ON something_link."som...
                                                 ^
test=# alter table something_link add column somethingid int;
更改表

测试=#选择*                                              
从“主要”主要
     INNER JOIN "something_link" something_link ON main."id" = something_link."mainid"
     INNER JOIN "something" *somehting* ON something_link."somethingid" = something."id"
     INNER JOIN "type" type ON something."typeid" = type."id"
;

错误：对表“某物”的 FROM 子句条目的无效引用
LINE 4: ...hing" somehting ON something_link."somethingid" = something....
                                                             ^
提示：也许您的意思是引用表别名“somehting”。

测试=#选择*
从“主要”主要
     INNER JOIN "something_link" something_link ON main."id" = something_link."mainid"
     INNER JOIN "something" something ON something_link."somethingid" = something."id"
     INNER JOIN "type" type ON something."typeid" = type."id"
;

 编号 | 主ID | 什么东西| 编号 | 类型标识 | ID

----+--------+-------------+----+--------+----

(0 行)

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-23T07:12:55.887

真正的问题其实不是查询，而是 PostgreSQL 8.3 默认配置。更正拼写错误（10x Kendrick Wilson）后，问题仍然存在，直到我编辑了“postgresql.conf”文件。应该有一行：

```
add_missing_from = on 
```

此行确保与其他 SQL 方言的兼容性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T16:11:40.997

据此，您似乎输入了错误的别名或使用了表名来代替它[。](http://sql-info.de/en/postgresql/postgres-gotchas.html#1_5)

# asp.net - 来自 DMZ 中 Web 服务器的 ASP.Net 提供程序

> ID：226392
> 
> 赞同：3
> 
> 时间：2008-10-22T15:49:04.817
> 
> 标签：asp.net, architecture, deployment, asp.net-membership, dmz

我们有一个使用 OOTB ASP.net 成员资格和角色提供者的 Intranet asp.net Web 应用程序。

现在我们计划通过将 Web 服务器移动到 DMZ 来将应用程序公开到 Internet，如下面（蹩脚的）文本图所示

```
             外部内部     
互联网 --- 防火墙 --- Web 服务器 --- 防火墙 --- 应用服务器 --- 数据库

                             非军事区内联网

```

现在的问题是，由于内部防火墙，Web 服务器上的 asp.net 成员资格和角色提供程序无法连接到 sql 服务器。

你以前有没有遇到过这样的情况？您会建议在内部防火墙中打开端口，以便网络服务器可以直接连接到 SQL 服务器吗？我还有什么其他选择（除了自己拧一个自定义提供程序）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T18:40:26.890

更改 DMZ 策略和打开端口通常非常困难。像我所做的那样，您可能会取得更好的成功：在网络中公开 WCF 服务并通过端口 80 上的 HTTP 与其通信。

与 LAN 人员零摩擦，我只是模仿 .NET 提供给我们的完全相同（虽然很糟糕）的 API :)

编辑：澄清一下，这意味着我有一个配置如下的 RemoteRoleProvider：

```
<roleManager enabled="true" defaultProvider="RemoteRoleProvider">
   <providers>
      <add name="RemoteRoleProvider" type="MyCorp.RemoteRoleProvider, MyCorp" serviceUrl="http://some_internal_url/RoleProviderService.svc" />
   </providers>
</roleManager> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T15:54:14.247

我们在 DMZ 中有几个面向 Internet 的 Web 服务器，并且必须在防火墙中打开隧道返回到我们需要与之交互的专用网络中的 SQL 服务器。我认为我们为 SQL 连接使用了端口 1433 以外的其他东西。到目前为止，它运行良好，即没有安全漏洞。

# c++ - 让 Eclipse 将 .h 文件视为 C++？

> ID：226402
> 
> 赞同：5
> 
> 时间：2008-10-22T15:50:38.013
> 
> 标签：c++, eclipse, ganymede

我们所有的 C++ 头文件都使用 .h 扩展名。Eclipse 认为这些是 C 头文件，并在类和命名空间等内容上用大量语法错误标记它们。

我试图从以下位置更改文件类型关联：

```
Preferences > C/C++ > File types 
```

但它被“锁定”了。

有趣的是，“*.h”与 C 和 C++ 头文件相关联，但它似乎使用 C。如何让 Eclipse 将 .h 文件视为 C++？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T17:11:15.963

尝试创建一个新项目并将您的源区域指定为位置。但是，请务必选择 C++ 项目（我通常使用 makefile 选项）。为了使解析器能够识别 C++ 语法，这就是您应该做的所有事情。

# xpath - 使用 XPath 查找节点的位置

> ID：226405
> 
> 赞同：91
> 
> 时间：2008-10-22T15:51:20.943
> 
> 标签：xpath

有人知道如何使用 XPath 获取节点的位置吗？

假设我有以下 xml：

```
<a>
    <b>zyx</b>
    <b>wvu</b>
    <b>tsr</b>
    <b>qpo</b>
</a> 
```

我可以使用以下 xpath 查询来选择第三个 <b> 节点 (<b>tsr</b>)：

```
a/b[.='tsr'] 
```

这一切都很好，但我想**返回**该节点的序数位置，例如：

```
a/b[.='tsr']/position() 
```

（但更多的工作！）

甚至可能吗？

**编辑**：忘了提到我正在使用.net 2，所以它是 xpath 1.0！

* * *

**更新**：最终使用了[James Sulak](https://stackoverflow.com/users/207/james-sulak)的[出色答案](https://stackoverflow.com/questions/226405/find-position-of-a-node-using-xpath#227080)。对于那些感兴趣的人，这里是我在 C# 中的实现：

```
int position = doc.SelectNodes("a/b[.='tsr']/preceding-sibling::b").Count + 1;

// Check the node actually exists
if (position > 1 || doc.SelectSingleNode("a/b[.='tsr']") != null)
{
    Console.WriteLine("Found at position = {0}", position);
} 
```

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-10-22T18:46:02.790

尝试：

```
count(a/b[.='tsr']/preceding-sibling::*)+1. 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-22T16:39:01.627

您可以使用 XSLT 做到这一点，但我不确定直接的 XPath。

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" encoding="utf-8" indent="yes" 
              omit-xml-declaration="yes"/>
  <xsl:template match="a/*[text()='tsr']">
    <xsl:number value-of="position()"/>
  </xsl:template>
  <xsl:template match="text()"/>
</xsl:stylesheet> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-08-09T02:32:11.663

我意识到这篇文章很古老……但是……

用节点名替换星号会给你更好的结果

```
count(a/b[.='tsr']/preceding::a)+1. 
```

代替

```
count(a/b[.='tsr']/preceding::*)+1. 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-09-21T16:14:12.480

如果您曾经升级到 XPath 2.0，请注意它提供了函数[index-of](http://www.w3.org/TR/xpath-functions/#func-index-of)，它以这种方式解决问题：

```
index-of(//b, //b[.='tsr']) 
```

在哪里：

*   第一个参数是搜索顺序
*   第二是搜索什么

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-08-04T20:57:07.833

与前面所说的不同，“preceding-sibling”实际上是要使用的轴，而不是完全不同的“preceding”，它选择文档中当前节点开始标记之前的所有内容。（见[http://www.w3schools.com/xpath/xpath_axes.asp](http://www.w3schools.com/xpath/xpath_axes.asp)）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-11-27T14:35:02.060

只是对 James Sulak 所做答案的注释。

如果您想考虑节点可能不存在并希望将其保留为纯 XPATH，请尝试以下操作，如果节点不存在，则返回 0。

```
count(a/b[.='tsr']/preceding-sibling::*)+number(boolean(a/b[.='tsr'])) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T08:20:51.850

问题是节点的位置在没有上下文的情况下意义不大。

以下代码将为您提供节点在其父子节点中的位置

```
using System;
using System.Xml;

public class XpathFinder
{
    public static void Main(string[] args)
    {
        XmlDocument xmldoc = new XmlDocument();
        xmldoc.Load(args[0]);
        foreach ( XmlNode xn in xmldoc.SelectNodes(args[1]) )
        {
            for (int i = 0; i < xn.ParentNode.ChildNodes.Count; i++)
            {
                if ( xn.ParentNode.ChildNodes[i].Equals( xn ) )
                {
                    Console.Out.WriteLine( i );
                    break;
                }
            }
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-12T20:07:22.623

我做了很多 Novell Identity Manager 的工作，而 XPATH 在这种情况下看起来有点不同。

假设您要查找的值在一个名为 TARGET 的字符串变量中，那么 XPATH 将是：

```
count(attr/value[.='$TARGET']/preceding-sibling::*)+1 
```

另外有人指出，为了节省几个字符的空间，以下内容也可以使用：

```
count(attr/value[.='$TARGET']/preceding::*) + 1 
```

我还在 Novell 的酷解决方案上发布了一个更漂亮的版本：[使用 XPATH 获取位置节点](http://www.novell.com/communities/node/6276/using-xpath-get-position-node-node-set)

# mysql - mysql 复制 - 表锁定？

> ID：226407
> 
> 赞同：9
> 
> 时间：2008-10-22T15:52:00.240
> 
> 标签：mysql, replication, locking, myisam

我目前在一家拥有运行 mysql/php 的网站的公司工作（所有表也使用 MISAM 表类型）。

我们想实现复制，但我在 mysql 文档和 Internet 上的其他地方读到，这将在写入二进制日志（从属 dbs 最终从中读取）时锁定表。

这些锁是否会在写入量很大的实时站点上引起问题？另外，有没有一种方法可以在不必锁定表的情况下启用复制？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T06:45:23.370

如果将表类型更改为 innodb，则会使用行级锁定。此外，您的复制将更加稳定，因为更新将是事务性的。MyISAM 复制是一个长期的痛苦。

确保您的服务器版本匹配，并且始终确保在关闭从属服务器之前关闭主服务器。您可以在关闭从属服务器后立即重新启动主服务器，但您必须将其关闭。

此外，请确保为 InnoDB 使用适当的自动扩展选项。而且，当您使用它时，您可能希望从 float 和 double 迁移到“十进制”（这意味着 mysql 5.1）。这将为您节省一些复制方面的麻烦。

这可能比你要求的多一点。享受。

Ps，是的，myisam 锁可能会导致问题。此外，innodb 比 myisam 慢，除非 myisam 阻止大量选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-28T05:44:51.750

以我的经验 DBAing 一个写入繁重的站点，编写二进制日志不会增加*master 上的*锁定或性能问题。如果您想对其进行基准测试，只需打开二进制日志即可。我真的不认为表被锁定以将查询写入二进制日志。

*但是，从属*设备上的表锁定是另一回事。复制是串行的：每个查询在从属运行下一个查询之前运行完成。如此长的更新将导致复制暂时落后。如果您的应用程序打算使用复制进行横向扩展，它需要知道如何适应这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T02:34:17.447

myisam 表类型的解决方案并不是“更好”。但是，您可以忍受它。

您能做的最好的事情是确保您的从属服务器和主服务器在相同的硬件上运行（FPU 差异会导致复制错误），以及确保您在 MySQL 服务器上运行相同的版本号。

以下链接回答您的问题。具体来说，如果没有删除操作，MyISAM 表中的锁阻塞写入的机会较小。因此，其中没有删除孔的表将在复制设置中执行得更快。

[http://dev.mysql.com/doc/refman/5.1/en/internal-locking.html](http://dev.mysql.com/doc/refman/5.1/en/internal-locking.html)

您可以通过在计划的停机时间（尤其是在大量删除之后）定期进行 DBA 导出/导入来减轻“漏洞”的影响。此外，请确保您的从数据库不会在主数据库仍在运行的情况下关闭。这将为您节省很多很多问题。

# macos - 寻找可以使用网络摄像头进行图像处理的 OSX 应用程序

> ID：226410
> 
> 赞同：0
> 
> 时间：2008-10-22T15:52:47.837
> 
> 标签：macos, image-processing, scripting, webcam, object-detection

我正在寻找一个 OSX（或 Linux？）应用程序，它可以从网络摄像头/视频输入接收数据，并让您以类似于 c、python 或 perl 的方式对像素进行一些图像处理，而不是担心处理语言。

我正在考虑将一个放在一起，但我想在我开始重新发明轮子之前先尝试找到一个已经存在的。

想做一些关于物体检测和读取表盘和数字的实验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T03:15:58.767

如果你愿意做一点编码，你想看看 QTKit，Cocoa 的 QuickTime 框架。QTKit 将让您轻松设置来自网络摄像头的输入源（[此处](http://developer.apple.com/quicktime/qtkit.html)为介绍）。您还可以将 Core Image 过滤器应用于流（[此处](http://developer.apple.com/samplecode/MyMovieFilter/index.html)的演示代码）。如果您想使用 OpenGL 来渲染或对电影应用滤镜，请查看 Core Video（[此处](http://developer.apple.com/samplecode/QuickTime/idxCocoa-date.html)的示例）。

使用[MyMovieFilter](http://developer.apple.com/samplecode/MyMovieFilter/index.html)演示应该可以让您快速启动并运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T02:28:15.323

找到了一个名为“处理”的跨平台工具，实际上运行了 Windows 版本，以避免进一步复杂化让网络摄像头工作。

必须安装快速时间，以及一个叫做 gVid 的东西才能让它工作，但在最初的障碍编码之后，它看起来像 C；（我认为它会被“编译”成 Java），而且运行速度非常快；甚至实时扫描来自网络摄像头的像素。

仍然让它在 OSX 上运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T04:20:25.707

根据您想要进行的处理（即，如果它是 Apple 的 Core Image 滤镜库中可用的滤镜），内置的[Photo Booth](http://en.wikipedia.org/wiki/Photo_Booth)应用程序可能就是您所需要的。Apple 商店也提供了一组商业附加过滤器 ( [http://www.apple.com/downloads/macosx/imaging_3d/composerfxeffectsforphotobooth.html)](http://www.apple.com/downloads/macosx/imaging_3d/composerfxeffectsforphotobooth.html)。

# javascript - 在 Web 应用程序中选择非标准图像区域

> ID：226411
> 
> 赞同：0
> 
> 时间：2008-10-22T15:52:56.290
> 
> 标签：javascript, image-manipulation

此问题适用于 Web 应用程序。

也许这是一个愚蠢的问题，但我想知道是否有一种方法可以生成一个具有 4 个点的多边形，以便用户可以自己拖动每个点来创建它自己的（例如，假设我们要删除一个窗口从不是正常角度的图像）。有可能吗？经过几个小时的搜索，我似乎找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-22T15:58:18.433

查看 SVG 和 Canvas API。这些将允许您制作可以通过 Javascript 更新的矢量图。出于您声明的目的，更新 SVG 文档的 DOM 可能更容易。Canvas 更像是一个 2D 位图，因此您需要自己编写大量绘图代码。

SVG 规格：[http ://www.w3.org/Graphics/SVG/](http://www.w3.org/Graphics/SVG/)

帆布规格： http: [//www.whatwg.org/specs/web-apps/current-work/](http://www.whatwg.org/specs/web-apps/current-work/)

请注意，SVG 仅适用于带有插件的 IE。Canvas 只能在 IE 中使用 Google [exCanvas](http://excanvas.sourceforge.net/)支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T15:59:18.167

听起来像是`<canvas>`标签或 Flash 界面的工作。

# c# - C#：如何在调用时触发事件的方法上创建属性？

> ID：226420
> 
> 赞同：41
> 
> 时间：2008-10-22T15:54:57.003
> 
> 标签：c#, .net, events, methods, attributes

C# 或 .NET 通常有没有办法在方法上创建一个属性，该属性在调用该方法时触发一个事件？理想情况下，我将能够在调用方法之前和之后运行自定义操作。

我的意思是这样的：

```
[TriggersMyCustomAction()]
public void DoSomeStuff()
{
} 
```

我完全不知道如何做到这一点，或者是否可能，但[System.Diagnostic.ConditionalAttribute](http://msdn.microsoft.com/en-us/library/system.diagnostics.conditionalattribute.aspx)可能会在后台做类似的事情。不过我不确定。

**编辑**：我忘了提到，由于我的具体情况，性能并不是真正的问题。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-01-30T16:20:27.257

这个概念用于**[MVC](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework) Web 应用程序。**

**.NET Framework 4.x**提供了几个触发动作的属性，例如：（`ExceptionFilterAttribute`处理异常）、`AuthorizeAttribute`（处理授权）。两者都定义在`System.Web.Http.Filters`.

例如，您可以定义自己的授权属性，如下所示：

```
public class myAuthorizationAttribute : AuthorizeAttribute
{
    protected override bool IsAuthorized(HttpActionContext actionContext)
    {
        // do any stuff here
        // it will be invoked when the decorated method is called
        if (CheckAuthorization(actionContext)) 
           return true; // authorized
        else
           return false; // not authorized
    }

} 
```

然后，在您的**控制器**类中，您装饰应该使用您的授权的方法，如下所示：

```
[myAuthorization]
public HttpResponseMessage Post(string id)
{
    // ... your code goes here
    response = new HttpResponseMessage(HttpStatusCode.OK); // return OK status
    return response;
} 
```

每当`Post`调用方法时，都会在`IsAuthorized`方法内部的代码执行*之前*`myAuthorization`调用Attribute内部的方法。*`Post`*

 *如果您`false`在该`IsAuthorized`方法中返回，则表示未授予授权并且该方法的执行`Post`中止。

* * *

为了理解它是如何工作的，让我们看一个不同的例子： The **`ExceptionFilter`**，它允许通过使用属性过滤异常，用法与上面所示的类似（您可以[在此处](https://docs.microsoft.com/en-us/aspnet/web-api/overview/error-handling/exception-handling)`AuthorizeAttribute`找到有关其用法的更详细说明）。

要使用它，请`DivideByZeroExceptionFilter`从[此处](http://blog.karbyn.com/articles/handling-errors-in-web-api-using-exception-filters-and-exception-handlers/)`ExceptionFilterAttribute`所示的类派生类，并覆盖该方法：`OnException`

```
public class DivideByZeroExceptionFilter : ExceptionFilterAttribute
{
    public override void OnException(HttpActionExecutedContext actionExecutedContext)
    {
        if (actionExecutedContext.Exception is DivideByZeroException)
        {
            actionExecutedContext.Response = new HttpResponseMessage() { 
                Content = new StringContent("A DIV error occured within the application.",
                                System.Text.Encoding.UTF8, "text/plain"), 
                StatusCode = System.Net.HttpStatusCode.InternalServerError
                };
        }
    }
} 
```

然后使用下面的演示代码来触发它：

```
[DivideByZeroExceptionFilter]
public void Delete(int id)
{
    // Just for demonstration purpose, it
    // causes the DivideByZeroExceptionFilter attribute to be triggered:
    throw new DivideByZeroException(); 

    // (normally, you would have some code here that might throw 
    // this exception if something goes wrong, and you want to make
    // sure it aborts properly in this case)
} 
```

现在我们知道它是如何使用的，我们主要对实现感兴趣。以下代码来自 .NET Framework。它在内部使用接口`IExceptionFilter`作为合约：

```
namespace System.Web.Http.Filters
{
    public interface IExceptionFilter : IFilter
    {
        // Executes an asynchronous exception filter.
        // Returns: An asynchronous exception filter.
        Task ExecuteExceptionFilterAsync(
                    HttpActionExecutedContext actionExecutedContext, 
                    CancellationToken cancellationToken);
    }
} 
```

`ExceptionFilterAttribute`本身定义如下：

```
namespace System.Web.Http.Filters
{
    // Represents the attributes for the exception filter.
    [AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, 
            Inherited = true, AllowMultiple = true)]
    public abstract class ExceptionFilterAttribute : FilterAttribute, 
            IExceptionFilter, IFilter
    {
        // Raises the exception event.
        // actionExecutedContext: The context for the action.
        public virtual void OnException(
            HttpActionExecutedContext actionExecutedContext)
        {
        }
        // Asynchronously executes the exception filter.
        // Returns: The result of the execution.
        Task IExceptionFilter.ExecuteExceptionFilterAsync(
            HttpActionExecutedContext actionExecutedContext, 
            CancellationToken cancellationToken)
        {
            if (actionExecutedContext == null)
            {
                throw Error.ArgumentNull("actionExecutedContext");
            }
            this.OnException(actionExecutedContext);
            return TaskHelpers.Completed();
        }
    }
} 
```

在内部`ExecuteExceptionFilterAsync`，方法`OnException`被调用。因为您已经如前所示覆盖了它，所以现在可以由您自己的代码处理该错误。

* * *

如 OwenP 的回答中提到的，还有一个商业产品[PostSharp](http://www.postsharp.net/)，它可以让您轻松地做到这一点。[这](http://doc.postsharp.net/method-interception#intercepting-method)是一个如何使用 PostSharp 执行此操作的示例。请注意，有一个 Express 版本可供您免费使用，甚至可以用于商业项目。

**PostSharp 示例**（有关完整说明，请参见上面的链接）：

```
public class CustomerService
{
    [RetryOnException(MaxRetries = 5)]
    public void Save(Customer customer)
    {
        // Database or web-service call.
    }
} 
```

这里的属性指定`Save`如果发生异常，该方法最多被调用 5 次。以下代码定义了此自定义属性：

```
[PSerializable]
public class RetryOnExceptionAttribute : MethodInterceptionAspect
{
    public RetryOnExceptionAttribute()
    {
        this.MaxRetries = 3;
    }

    public int MaxRetries { get; set; }

    public override void OnInvoke(MethodInterceptionArgs args)
    {
        int retriesCounter = 0;

        while (true)
        {
            try
            {
                args.Proceed();
                return;
            }
            catch (Exception e)
            {
                retriesCounter++;
                if (retriesCounter > this.MaxRetries) throw;

                Console.WriteLine(
                  "Exception during attempt {0} of calling method {1}.{2}: {3}",
                  retriesCounter, args.Method.DeclaringType, args.Method.Name, e.Message);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-22T15:57:35.080

我知道如何做到这一点的唯一方法是使用[PostSharp](https://www.postsharp.net/)。它对您的 IL 进行后处理，并可以执行您要求的操作。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-22T16:02:36.320

您需要某种面向方面的框架。PostSharp 会这样做，[Windsor](http://castleproject.org/container)也会这样做。

基本上，它们是您的对象的子类并覆盖此方法...

然后它变成：

```
//proxy
public override void DoSomeStuff()
{
     if(MethodHasTriggerAttribute)
        Trigger();

     _innerClass.DoSomeStuff();
} 
```

当然，这一切对你来说都是隐藏的。您所要做的就是向 Windsor 询问类型，它会为您进行代理。我认为该属性成为温莎的（自定义）设施。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-22T16:06:00.460

您可以使用 ContextBoundObject 和 IMessageSink。请参阅[http://msdn.microsoft.com/nb-no/magazine/cc301356(en-us).aspx](http://msdn.microsoft.com/nb-no/magazine/cc301356(en-us).aspx)

请注意，与直接方法调用相比，此方法具有严重的性能影响。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T15:57:35.487

我认为没有办法只使用一个属性，但是使用[代理类](http://www.codeproject.com/KB/cs/dynamicproxy.aspx)和反射，您可以拥有一个知道拦截具有属性方法的类的实例化的类。

然后，代理类可以在调用属性方法时触发事件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T15:58:28.247

属性提供信息，它们是元数据。我不知道有什么方法可以临时做到这一点，有人可能会。

您可以查看 .NET 中的部分方法，这些方法允许您进行一些轻量级的事件处理。您提供挂钩并让其他人处理实现。如果该方法没有实现，编译器就会忽略它。

[http://msdn.microsoft.com/en-us/library/wa80x488.aspx](http://msdn.microsoft.com/en-us/library/wa80x488.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-07T20:34:13.560

你可以看看穷人的解决方案：看看装饰器模式。

# internet-explorer - 如何让 IE 使用其关联的应用程序打开文件？

> ID：226426
> 
> 赞同：2
> 
> 时间：2008-10-22T15:55:36.100
> 
> 标签：internet-explorer, mime-types

MSTest 生成一个扩展名为 .trx 的 XML 文件，其中包含测试结果。

如果我在未安装 Visual Studio 的计算机上有一个 .trx 文件，我会收到提示“使用 Web 服务...”或“从列表中选择...”，这是预期的。如果我的开发机器上有一个 .trx 文件并打开它，它会在 Visual Studio 中打开，这是预期的。如果我单击网页上的链接或从我的构建服务器获取 .trx 文件的电子邮件中的链接，它总是会在 IE 中打开 XML。

如何配置 IE（或构建服务器上的 IIS）以在 Visual Studio 中打开远程 .trx 文件（如果已安装，或提示未安装）？

更新：如果我重命名服务器上的 .trx 文件并为其提供各种扩展名（例如 .bmp、.msi、.txt、.zip），它仍会在 IE 中以 XML 格式打开，因此它显然是由文件而不是声明的 MIME 类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T16:45:37.603

应该是为文件定义一个 MIME 类型（即“application/x-test”）如果我没记错的话，如果服务器没有提供 MIME 类型，客户端必须猜测（如果它看起来像一个 XML 文件，它被视为一个 XML 文件）。我可能弄错了，但值得一试。您可以通过调出服务器的属性（不是任何已配置的站点）从 IIS 的 MMC 控制台管理单元访问 IIS 的 MIME 列表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-21T23:27:17.317

您是否尝试将 .xml 的文件关联更改为 Visual Studio 而不是 IE？我正在使用 Win7 和 IE8，我可以在此处设置关联：Internet 选项 > 程序 > 设置程序 > 默认程序\设置关联

# silverlight - 在 Silverlight DataGrid 中设置初始排序顺序？

> ID：226433
> 
> 赞同：12
> 
> 时间：2008-10-22T15:56:36.813
> 
> 标签：silverlight, sorting, datagrid

当我第一次将数据加载到 Silverlight DataGrid 控件时，如何使屏幕看起来就像用户刚刚单击了第一列的标题一样？换句话说，数据应根据该列的值按升序排序，并且小排序箭头应显示在第一列的标题中。

假设这是可能的，我是否也可以让它看起来好像用户单击了第一列然后按 shift 单击了第二列？换句话说，我可以以编程方式应用两部分排序并让屏幕看起来好像用户已经完成了吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-12-13T10:10:31.740

这是我的解决方案：

```
if (pcv.CanSort == true)
{
      pcv.SortDescriptions.Add(new SortDescription("ProductionStatus", ListSortDirection.Ascending));
      pcv.SortDescriptions.Add(new SortDescription("Date", ListSortDirection.Descending));
} 
```

，其中 pcv 是一个 PageCollectionView。这首先按 ProductionStatus 属性排序，然后按 Date 属性排序。它仅显示第二列的小排序箭头。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-23T14:59:52.407

我也需要这样做，并且深入研究 DataGrid 是否可以做到这一点。

实际上 DataGridColumnHeader 类上有一个适当的方法，即 InvokeProcessSort，但它是内部的，在 DataGrid 类的其他任何地方都没有出现。

我所能做的就是在绑定数据之前对数据进行预排序。我正在使用实现 ICollectionView 以及 ObservableCollection<> 的自定义数据集合，这可以正常工作 - 但它不是最佳的，并且不一定需要大量工作。

此外，提供预先排序的集合意味着网格不显示排序标记。

我将在 DataGrid 错误跟踪器上将此作为一个问题提出 - 这是一个相当大的遗漏，很容易修复 - MS 只需要在 DataGridColumn 和 DataGrid 类上公开适当的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-09-28T09:32:54.723

发现 Paul Sherrif 的一篇很好的小文章为我们解决了这个问题……

[http://weblogs.asp.net/psheriff/archive/2010/07/14/use-collectionviewsource-in-silverlight.aspx](http://weblogs.asp.net/psheriff/archive/2010/07/14/use-collectionviewsource-in-silverlight.aspx)

基本上，无论如何我们都将 DataGrid 绑定到 CollectionViewSource。原来这有一个 CollectionViewSource.SortDescriptions 配置集，可以让我们指定默认排序顺序。

谢谢保罗！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T13:36:57.723

只需将 SortDescriptor 添加到 DomainDataSource：

```
<riaControls:DomainDataSource.SortDescriptors>
    <riaControls:SortDescriptor PropertyPath="ColumnName" Direction="Descending" />
</riaControls:DomainDataSource.SortDescriptors> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-17T22:37:09.347

Silverlight 3+ 中存在 CollectionViewSource

[http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource(v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource(v=vs.95).aspx)

正如 Microsoft 所建议的那样，有一种简单的方法可以在 XAML 中定义默认排序顺序：

使用 CollectionViewSource 在标记中声明排序

```
 <Window.Resources>
   <app:MyData x:Key="MyData"/>
   <CollectionViewSource x:Key="cvs" Source={StaticResource MyData}>
     <CollectionViewSource.SortDescriptions>
        <SortDescription Property="Name"/>
     </CollectionViewSource.SortDescriptions>
   </CollectionViewSource>
 </Window.Resources>

 <DataGrid ItemsSource="{Binding Source={StaticResource cvs}}"/> 
```

在 [https://connect.microsoft.com/VisualStudio/feedback/details/678782/set-default-sort-order-of-datagrid的评论中找到](https://connect.microsoft.com/VisualStudio/feedback/details/678782/set-default-sort-order-of-datagrid)

**我对微软样本的更正：**

```
 <sort:SortDescription 
   PropertyName="Name"
   Direction="Ascending"
   xmlns:sort="clr-namespace:System.ComponentModel;assembly=System.Windows"
   /> 
```

# asp.net - 在执行 <%= %> 代码以填充属性之前呈现 ASP.NET 自定义控件

> ID：226436
> 
> 赞同：2
> 
> 时间：2008-10-22T15:56:54.473
> 
> 标签：asp.net, custom-server-controls

我有一个公开属性的自定义控件。当我使用固定值设置它时，一切正常。但是，如果我尝试使用 <%= %> 标签设置它的值，它会有点奇怪：

```
<cc:CustomControl ID="CustomControl" runat="server" Property1='<%= MyProperty %>' />
<%= MyProperty %> 
```

当它被渲染时，自定义控件下方的 <%= MyProperty %> 标记会按照我的预期渲染（使用 MyProperty 的值）。但是，当我进入 CustomControl 的 Render 函数时，Property1 的值实际上是字符串“<%= MyProperty %>”，而不是 MyProperty 的实际基础值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T16:04:38.420

您的控件在`OnInit`. 因此，如果该语法有效，它无论如何都不会产生您想要的效果，因为`MyProperty`它将`OnInit`在渲染时而不是在渲染时进行评估（就像第二次使用一样）。

您想改用数据绑定语法：

```
<cc:CustomControl ID="CustomControl" runat="server" Property1='<%# MyProperty %>' /> 
```

只需确保调用`DataBind()`容器（Page、UserControl 等）。

或者，您可以在后面的代码中设置属性：

```
CustomControl.Property1 = MyProperty; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T15:59:16.527

在 CustomControl 中尝试 <%# MyProperty %> 看看是否可行。

# php - 在 LAMP 集群中管理 php 会话的最佳方法是什么？

> ID：226442
> 
> 赞同：1
> 
> 时间：2008-10-22T15:58:11.913
> 
> 标签：php, session, distributed, cluster-computing

我一直在阅读这个主题一段时间。突然有一天，这个解决方案是必要的，而不仅仅是一个梦想。

通过阅读，我看到了流行的差异（基于文件、memcached、共享内存 (mm)、sql 表和自定义）。

我们最初的想法是使用安装在每个应用程序服务器（LAMP 盒）上的 ZFS 或 AFS，并将`session.save_path`php.ini 设置指向该安装路径中的目录。

我想听听成功的故事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T16:38:53.843

约翰坎贝尔在这里的回答应该会有所帮助

[为多个主机上的 PHP 站点处理会话的最佳方法是什么？](https://stackoverflow.com/questions/76712)

他关于不只使用 Memcached 的观点很重要。

此外，正如我在那个问题中提到的，您可能需要考虑 Zend 平台附带的会话集群 - 但该解决方案存在大量许可成本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T16:01:36.803

我认为将您的会话存储在数据库（如 MySQL 或 PostgreSQL）中将涉及最少的麻烦，特别是如果您已经拥有一个数据库，无论您的应用程序做什么。

Memcached 也可能有所帮助，因为它可以跨多台机器存储数据，但我没有任何经验。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T16:38:46.760

我已经使用基于共享服务器上的会话的文件超过 5 年了，没有任何问题。我们有一些会话可能会变得非常大（>10MB）并且基于文件的工作非常好。通常，我们的共享服务器将每个站点的会话文件存储在 chroot 目录中，因此只有 root 可以访问它们。我们发现这是非常可靠的并且没有任何问题。尽管您失去了数据库或 memcached 的一些功能，但它是 PHP 的默认设置是有原因的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T16:13:46.733

我有点偏见，但我推荐[HTTP_Session2](http://pear.php.net/package/HTTP_Session2)。（我正在研究这个包）虽然我们通过文件支持传统的会话处理，但我们还支持数据库（通过[PEAR::MDB2](http://pear.php.net/package/MDB2)支持数据库（MySQL、PostgreSQL、SQlite 等）和 memcached。

就个人而言，我们使用数据库处理程序，每天为多达 100,000 个用户提供服务，没有更大的问题。我认为在优化方面，我接下来会使用 memcached，但是数据库非常适合不需要您向后弯曲的中间修复。:-)

顺便说一句，有关 memcached 的更多信息，请查看我关于[如何在 Web 集群中管理会话变量的答案？](https://stackoverflow.com/questions/224009/how-to-manage-session-variables-in-a-web-cluster#224133).

**编辑**

既然你问了，这里有一个例子（[更多在 API 文档中](http://pear.php.net/package/HTTP_Session2/docs/0.7.2/HTTP_Session2/HTTP_Session2_Container_Memcache.html#method__construct)）：

```
$options = array('memcache' => $memcache); 
```

[PECL::Memcache](http://pecl.php.net/package/memcache)`$memcache`的实例在哪里，这是必需的。我知道我们缺少一个例子，我们会改进的。同时，我们的源代码有很好的内联文档，例如查看[API 文档](http://pear.php.net/package/HTTP_Session2/docs/0.7.2/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T18:40:20.400

如果您正在研究用于会话的 Memcached 解决方案 - 也许您应该查看[Repcached](http://repcached.lab.klab.org/)。如果服务器重新启动等，应该减少丢失会话的任何问题。

> **关于 repcached**
> “repcached”是一个补丁集，它为 memcached 1.2.x 添加了数据复制功能。

**注意：**我实际上还没有尝试过 repcached，但认为它值得研究。

# haxe - Neko 和 haxe.Timer.delayed()

> ID：226445
> 
> 赞同：3
> 
> 时间：2008-10-22T15:58:26.843
> 
> 标签：haxe, neko

每个 Haxe 开发人员都知道，您可以使用`haxe.Timer.delayed()`延迟函数调用一段时间。但是对于 Neko 来说，这个功能根本不存在。有没有办法达到相同的结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T16:06:19.853

必须先检查它，但是

```
function delayed(f, time) {
   neko.vm.Thread.create(function() {
       neko.Sys.sleep(time);
       f();
   });
} 
```

可能是最接近的事情。唯一的缺点是应用程序变成了多线程的，这可能会导致严重的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-18T21:05:11.903

我考虑了你的问题，我认为最好的方法是为 Neko 创建你自己的 Timer 类。我为你做了一个 Timer 类：

*NekoTimer.hx*

```
package;
import neko.Sys;

    class NekoTimer 
    {
    private static var threadActive:Bool = false;
    private static var timersList:Array<TimerInfo> = new Array<TimerInfo>();
    private static var timerInterval:Float = 0.1;

    public static function addTimer(interval:Int, callMethod:Void->Void):Int
    {
        //setup timer thread if not yet active
        if (!threadActive) setupTimerThread();

        //add the given timer
        return timersList.push(new TimerInfo(interval, callMethod, Sys.time() * 1000)) - 1;
    }

    public static function delTimer(id:Int):Void
    {
        timersList.splice(id, 1);
    }

    private static function setupTimerThread():Void
    {
        threadActive = true;
        neko.vm.Thread.create(function() {
            while (true) {
                Sys.sleep(timerInterval);
                for (timer in timersList) {
                    if (Sys.time() * 1000 - timer.lastCallTimestamp >= timer.interval) {
                        timer.callMethod();
                        timer.lastCallTimestamp = Sys.time() * 1000;
                    }
                }
            }
        });
    }
}

private class TimerInfo
{
    public var interval:Int;
    public var callMethod:Void->Void;
    public var lastCallTimestamp:Float;

    public function new(interval:Int, callMethod:Void->Void, lastCallTimestamp:Float) {
        this.interval = interval;
        this.callMethod = callMethod;
        this.lastCallTimestamp = lastCallTimestamp;
    }
} 
```

像这样称呼它：

```
package ;

import neko.Lib;

class Main 
{
    private var timerId:Int;

    public function new()
    {
        trace("setting up timer...");
        timerId = NekoTimer.addTimer(5000, timerCallback);
        trace(timerId);

        //idle main app
        while (true) { }
    }

    private function timerCallback():Void
    {
        trace("it's now 5 seconds later");
        NekoTimer.delTimer(timerId);
        trace("removed timer");
    }

    //neko constructor
    static function main() 
    {
        new Main();
    }
} 
```

希望有帮助。

注意：这个精度为 100ms。您可以通过减少 timerInterval 设置来增加它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-19T17:37:26.087

我也使用了这个类，我发现了一个问题。因为不是完全实时的，所以休眠间隔，调用函数，再次休眠间隔。因此，根据您运行的功能需要多长时间，它会变慢或变快。

我已经通过像这样替换第 39 行来解决它：

```
//timer.lastCallTimestamp = Sys.time() * 1000;
timer.lastCallTimestamp = timer.lastCallTimestamp + timer.interval; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T17:58:48.640

是的，除了您在第一个答案中提到的内容外，我什么都不知道。在 Linux 上，您可以使用 SIGALARM - 但这看起来并不简单，100% 纯 C 代码，需要非常小心地处理以避免 VM 崩溃。

# language-agnostic - 版本信息的最佳实践？

> ID：226448
> 
> 赞同：7
> 
> 时间：2008-10-22T15:58:45.110
> 
> 标签：language-agnostic, versioning

我目前正在自动化/改进包装我商店的整个产品的发布流程。目前该产品是以下产品的组合：

*   Java 服务器端代码库
*   XML 配置和应用程序文件
*   面向管理员的 Shell 和批处理脚本
*   静态提供的 HTML 页面
*   和其他一些东西，但这是大部分

所有或大部分都包含各种版本信息，用于不同的目的。发布打包过程的一部分涉及进行大量查找、grep'ing 和 sed'ing（在脚本中）以更新信息。这种包装产品的胶水似乎是以一种有机的、及时的方式拼凑在一起的，而且维护起来非常糟糕。例如，一些 Java 方法在发布时创建 Date 对象，其参数通过文本替换更新，无需编译器验证......只是，呃。

我试图避免给出实际使用的软件（即 CVS、SVN、ant 等）的示例，因为我想避免“使用 xyz 的功能来做到这一点”并更多地关注一般实践。我想将问题归咎于劣质设计，但如果我不得不重新开始，仍然使用不同的技术，我不确定如何最好地处理这个问题，而不是制定约定。

我的问题是，对于跨不同技术、文件类型、平台和版本控制系统维护和更新版本信息，是否有任何最佳实践或提示和技巧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T16:12:34.303

创建一个包含版本号的属性文件，并让所有不同的组件都引用该属性文件

*   Java 文件可以通过以下方式引用属性
*   XML可以使用包含吗？
*   HTML 可以使用 JavaScript 从 HTML 中的属性写入版本号
*   Shell 脚本可以在文件中读取

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T17:04:47.863

确实，要完成 Craig Angus 的回答，这里的经验法则应该是***在您的正常交付文件中不包含任何元信息***，而是将这些元数据（版本号、发布日期等）报告到*一个*特殊文件中-- 包含在版本中 --。

当您使用一个 VCS（版本控制系统）工具从开发到认证再到预生产时，这会有所帮助。
这意味着无论何时加载工作空间（用于开发、测试或准备发布到生产环境），它都是版本控制工具，它为您提供所有详细信息。

当您准备交付（一组打包文件）时，您应该向 VCS 工具询问您想要保留的每个元信息，并将它们写入包含在所述文件集中的特殊文件中。

该交付应打包在外部目录中（任何工作区之外），并且：

*   如果它是*非官方*版本，则复制到共享目录（或 maven 存储库）（但只是一个快速打包，用于帮助隔壁等待您交付的团队）。这样你一天可以送 10 或 20 次，没关系：它们很容易丢弃。

*   导入到 VCS 中以用作正式交付，并且为了易于部署，因为您只需要向版本控制工具询问正确交付的正确版本，然后您就可以开始部署它。

注意：我刚刚描述了一个主要用于许多相互依赖的项目的发布管理过程。对于一个小的单个项目，您可以跳过 VCS 工具中的导入并将您的交付存储在其他地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-10T21:52:23.050

除了 Craig Angus 之外，还包括所用工具的版本。

# java - 谁能解释线程监视器并等待？

> ID：226455
> 
> 赞同：41
> 
> 时间：2008-10-22T15:59:21.630
> 
> 标签：java, multithreading, monitor

工作中的某个人只是询问必须在同步中包含等待的原因。

老实说，我看不出其中的道理。我理解 javadocs 所说的——线程需要是对象监视器的所有者，但为什么呢？它防止了哪些问题？（如果确实有必要，为什么等待方法不能获取监视器本身？）

我正在寻找一个相当深入的原因，或者可能是对一篇文章的参考。我在快速谷歌中找不到一个。

哦，还有，thread.sleep 比较如何？

编辑：一组很棒的答案——我真的希望我能选择多个答案，因为它们都帮助我理解了发生了什么。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-22T18:58:45.637

这里已经有很多好的答案了。但是在这里只想提一下，使用 wait() 时必须做的另一个事情是根据您等待的条件在循环中执行它，以防您看到虚假唤醒，根据我的经验，这确实发生了。

等待其他线程将条件更改为 true 并通知：

```
synchronized(o) {
  while(! checkCondition()) {
    o.wait();
  }
} 
```

当然，这些天来，我建议只使用新的 Condition 对象，因为它更清晰并且具有更多功能（例如每个锁允许多个条件，能够检查等待队列长度，更灵活的调度/中断等）。

```
 Lock lock = new ReentrantLock();
 Condition condition = lock.newCondition();
 lock.lock();
 try {
   while (! checkCondition()) {
     condition.await();
   }
 } finally {
   lock.unlock();
 } 
```

}

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-22T16:03:09.530

如果对象在调用 Object.wait() 时不拥有对象监视器，则在释放监视器之前，它将无法访问该对象以设置通知侦听器。相反，它将被视为尝试访问同步对象上的方法的线程。

或者换句话说，两者之间没有区别：

```
public void doStuffOnThisObject() 
```

和以下方法：

```
public void wait() 
```

这两种方法都将被阻止，直到对象监视器被释放。这是 Java 中的一项功能，用于防止对象的状态被多个线程更新。它只是对 wait() 方法产生了意想不到的后果。

据推测，wait() 方法是不同步的，因为这可能会导致线程在对象上有多个锁的情况。（有关这方面的更多信息，请参阅[Java 语言规范/锁定](http://java.sun.com/docs/books/jls/third_edition/html/memory.html#61803)。）多个锁是一个问题，因为 wait() 方法只会撤消一个锁。如果方法是同步的，它将保证只有方法的锁会被撤消，而潜在的外部锁仍然会被撤消。这将在代码中创建死锁条件。

要回答您关于 Thread.sleep() 的问题，Thread.sleep() 不保证您等待的任何条件都已满足。使用 Object.wait() 和 Object.notify() 允许程序员手动实现阻塞。一旦发送满足条件的通知，线程将解除阻塞。例如，从磁盘读取已完成，线程可以处理数据。Thread.sleep() 将要求程序员轮询条件是否满足，如果没有满足则返回睡眠。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-22T16:40:47.130

它需要拥有监视器，因为 wait() 的目的是释放监视器，让其他线程获得监视器进行自己的处理。这些方法（等待/通知）的目的是协调对需要彼此执行某些功能的两个线程之间的同步代码块的访问。这不仅仅是确保对数据结构的访问是线程安全的，而是协调多个线程之间的事件。

一个典型的例子是生产者/消费者案例，其中一个线程将数据推送到队列，而另一个线程消费数据。消费线程总是需要监视器访问队列，但一旦队列为空就会释放监视器。只有当消费者不再进行处理时，生产者线程才能获得对该线程的写入权限。一旦将更多数据推送到队列中，它将通知消费者线程，因此它可以重新获得监视器并再次访问队列。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-22T16:46:07.400

等待放弃显示器，所以你必须拥有它才能放弃它。通知也必须有监视器。

您想要这样做的主要原因是确保当您从 wait() 回来时拥有监视器——通常，您使用等待/通知协议来保护某些共享资源，并且您希望它是安全的等待返回时触摸它。与 notify 相同——通常你正在更改某些内容然后调用 notify()——你想要监控、进行更改并调用 notify()。

如果你做了这样的功能：

```
public void synchWait() {
   syncronized { wait(); }
} 
```

当等待返回时，您将没有监视器——您可以得到它，但接下来您可能不会得到它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-22T16:53:17.463

这是我对为什么限制实际上是一项要求的理解。我将此基于我不久前通过组合互斥锁和条件变量所做的 C++ 监视器实现。

在*mutex+condition_variable=monitor*系统中，[等待](http://www.opengroup.org/onlinepubs/007908775/xsh/pthread_cond_wait.html)调用将条件变量设置为等待状态并释放互斥锁。条件变量是共享状态，因此需要锁定它以避免在想要等待的线程和想要通知的线程之间出现竞争条件。不是引入另一个互斥锁来锁定其状态，而是使用现有的互斥锁。在 Java 中，当即将等待的线程拥有监视器时，互斥锁被正确锁定。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-07-23T05:33:16.420

如果有条件说队列为空，则通常等待完成。

```
If(queue is empty)
     queue.wait(); 
```

让我们假设队列是空的。如果当前线程在检查队列后抢占，那么如果另一个线程向队列中添加了很少的元素，则当前线程将不知道并进入等待状态。那是错误的。所以我们应该有类似的东西

```
Synchornized(queue)
{
   if(queue is empty)
          queue.wait();
} 
```

现在让我们考虑一下如果他们让 wait 本身同步会怎样。正如其中一条评论中已经提到的，它只释放一个锁。这意味着如果 wait() 在上面的代码中同步，只有一个锁会被释放。暗示当前线程将等待队列的锁。

# sql - 半棘手的 SQL 查询

> ID：226460
> 
> 赞同：5
> 
> 时间：2008-10-22T16:00:21.627
> 
> 标签：sql, sql-server

我正在尝试为 SQL Server 2005 编写查询，但我不知道该怎么做。我有一个包含以下字段的表：

**MessageID int
CategoryID int
Priority tinyint
MessageText NVARCHAR(MAX)** 

我需要一个查询，它将为类别中具有最高优先级的每一行返回 *。例如，如果我有以下数据：

**MessageID, CategoryID, Priority, MessageText**
1, 100, 1, 发生错误 #1234
2, 100, 2, 发生错误 #243
3, 100, 3, 发生错误 #976
4, 200, 4, 发生错误 #194
5, 200 , 1, 发生错误 #736
6, 300, 3, 发生错误 #54
7, 300, 2, 发生错误 #888

那么结果将是：

**MessageID、CategoryID、优先级、MessageText 3、100、3**
，发生错误 #976 4、200、4
，发生错误 #194 6、300、3
，发生错误 #54

请注意，它为每个类别返回一行，并且它是对该类别具有最高优先级的行。

谁能告诉我如何编写此查询？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-22T16:14:36.637

已验证：

```
SELECT
    highest_priority_messages.*
FROM
(
    SELECT
    m.MessageID
    , m.CategoryID
    , m.Priority
    , m.MessageText
    , Rank() OVER 
        (PARTITION BY m.CategoryID ORDER BY m.Priority DESC) AS p_rank
    FROM [Message] m
    GROUP BY 
        m.CategoryID 
        , m.Priority
        , m.MessageID
        , m.MessageText
) highest_priority_messages
WHERE 
    p_rank = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T16:06:19.930

我相信这应该可行，表名假定为 Messages

```
SELECT
    M.MessageId,
    M.CategoryId,
    M.Priority,
    M.MessageText
FROM 
(
    SELECT 
        CategoryId,
        MAX(Priority) AS Priority
    FROM Messages
    GROUP BY CategoryId
) AS MaxValues
    INNER JOIN Messages M
        ON (MaxValues.CategoryId = M.CategoryId
                AND MaxValues.Priority = M.Priority) 
```

**笔记**

此方法中唯一的“陷阱”是，如果您有多个最大优先级...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T20:24:30.847

如果您想在没有所有子查询的情况下执行此操作：

```
SELECT
     MessageID,
     CategoryID,
     Priority,
     MessageText
FROM
     dbo.Messages M1
LEFT OUTER JOIN dbo.Messages M2 ON
     M2.CategoryID = M1.CategoryID AND
     M2.Priority > M1.Priority
WHERE
     M2.MessageID IS NULL 
```

您可能需要根据处理关系的方式调整查询。你没有任何这样的例子，所以我不确定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-23T02:51:04.250

```
select distinct query1.* from

(select categoryId,msgText,max(priorityId) as MAX_PRIORITY
 from message
  group by categoryId,msgText
 order by categoryId
) query1,

(select categoryId,max(priorityId) as MAX_PRIORITY
 from message
  group by categoryId
 order by categoryId
) query2

where query1.MAX_PRIORITY = query2.MAX_PRIORITY

order by query1.categoryId 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T16:12:42.820

```
SELECT
    Messages.MessageID
    , Messages.CategoryID
    , Messages.Priority
    , Messages. MessageText
FROM
    Messages
    INNER JOIN
    (
        SELECT 
            CategoryID
            , MAX(Priority) AS Priority
        FROM 
            Messages
        GROUP BY
            CategoryID
    ) AS MaxResults
    ON
        (
            Messages.CategoryID = MaxResults.CategoryID
            AND
            Messages.Priority = MaxResults.Priority
        ) 
```

看起来这与上面给出的答案基本相同......具有相同的警告。

虽然这个可以马上工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T16:39:09.490

这更短且更易于阅读（imo）。

```
select ms.*
from 
  messages ms
 ,(
  select ms1.categoryid, max(ms1.priority) as max_priority
  from messages ms1
  group by ms1.categoryid
  ) tmp
where ms.categoryid = tmp.categoryid
  and ms.priority = tmp.max_priority; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T22:20:54.073

我的排名还不够高，无法发表评论，所以我想添加到 cfeduke 的解决方案中：

```
SELECT
    highest_priority_messages.*
FROM
(
    SELECT
    m.MessageID
    , m.CategoryID
    , m.Priority
    , m.MessageText
    , Rank() OVER 
        (PARTITION BY m.CategoryID ORDER BY m.Priority DESC, m.MessageID DESC) AS p_rank
    FROM [Message] m
    GROUP BY 
        m.CategoryID 
        , m.Priority
        , m.MessageID
        , m.MessageText
) highest_priority_messages
WHERE 
    p_rank = 1 
```

如果您添加另一个具有优先级 3 的 CategoryID 100 消息，则原始解决方案将带回 2 行，通过添加另一个订单条件，我们消除了两个项目排名相同的机会。

这是我为了测试而插入的行的副本。

```
insert into [Message] (MessageID, CategoryID, Priority, MessageText)
select 8, 100, 3, 'Error #976-2 occurred' 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-15T06:29:53.677

```
SELECT DISTINCT CategoryId,PS.Priority,MessageID,MessageText
FROM Priority_Scene PS
JOIN (SELECT MAX(Priority) AS Priority FROM Priority_Scene GROUP BY CategoryId) A
ON A.Priority   = PS.Priority 
```

# html - HTML 中的软连字符（ vs. ）

> ID：226464
> 
> 赞同：171
> 
> 时间：2008-10-22T16:00:44.513
> 
> 标签：html, text, soft-hyphen, wbr

您如何解决网页上的软连字符问题？在文本中可能有很长的单词，您可能想用连字符换行。但是您不希望连字符显示整个单词是否在同一行。

根据[这个页面](http://www.thefutureoftheweb.com/blog/breaking-long-urls) `<wbr>`的评论是一个非标准的“网景发明的标签汤”。似乎`&shy;` [在标准合规性方面也存在问题](http://www.cs.tut.fi/~jkorpela/shy.html)。似乎[没有办法为所有浏览器找到可行的解决方案](http://www.quirksmode.org/oddsandends/wbr.html)。

你处理软连字符的方式是什么，你为什么选择它？是否有首选解决方案或最佳实践？

* * *

[在此处](https://stackoverflow.com/questions/904/in-html-how-to-word-break-on-a-dash) 查看相关的 SO 讨论。

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2008-10-22T19:49:30.353

~~不幸的是，`&shy`浏览器之间的支持是如此不一致，以至于无法真正使用它。~~

~~QuirksMode 是对的——目前还没有在 HTML 中使用软连字符的好方法。看看没有它们你能做些什么。~~

2013 年编辑：[根据 QuirksMode](http://www.quirksmode.org/oddsandends/wbr.html)，`&shy;`现在所有主流浏览器都支持/支持。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2015-02-23T11:15:22.557

## 2015 年 2 月摘要（2017 年 11 月部分更新）

它们都表现得很好，`&#173;`因为谷歌仍然可以索引包含它的单词。

*   **在浏览器中：** 在主流浏览器（甚至是旧的 IE！）中都按预期显示`&shy;`。在最新版本的 IE（10 或 11）中不受支持，并且在 Edge 中无法正常工作。`&#173;``<wbr>`
*   **从浏览器复制和粘贴时：（**测试于 2015 年）对于Mac 和 Windows (10) 上的 Chrome`&shy;`和`&#173;`Firefox，它会保留字符并将硬连字符粘贴到记事本中，将不可见的软连字符粘贴到支持它们的应用程序中。IE (win7) 总是粘贴连字符，即使在 IE10 中也是如此
*   **在页面上查找**适用于所有浏览器`&shy;`，`&#173;`除了 IE，它只匹配精确的复制和粘贴匹配项（甚至高达 IE11）
*   **搜索引擎：** Google 将包含`&#173;`的单词与正常输入的单词匹配。截至 2017 年，它似乎不再匹配包含`&shy;`. Yandex 似乎是一样的。必应和百度似乎也不匹配。

* * *

## 测试一下

对于最新的实时测试，以下是一些带有软连字符的独特单词的示例。

*   `&shy;`——`confumbabbl&shy;ication&shy;ism`混淆论
    *   ..................................................... ..................................................... ..........混淆论
    *   ..................................................... ..................................................... ............. 混淆论

`<wbr>`- `donfounbabbl<wbr>ication<wbr>ism`。`<wbr/>`此站点从输出中删除。这是[用于测试的 jsbin.com 片段](http://jsbin.com/geyageloci/1/edit)。

*   `&#173;`- `eonfulbabbl&#173;ication&#173;ism`- 完整的唠叨主义
    *   ..................................................... ..................................................... ......
    *   ..................................................... ..................................................... ......

在这里，它们没有害羞的连字符（这是为了复制和粘贴到页面上的查找测试中；以不会破坏搜索引擎测试的方式编写）：

`ZZZconfumbabblicationismZZZdonfounbabblicationismZZZeonfulbabblicationismZZZ`

## 跨浏览器显示

成功：显示为正常单词，除了应该中断的地方，当它在指定位置中断和连字符时。

失败：显示异常，或未能在预期的位置打破。

*   Chrome（40.0.2214.115，Mac）：`&shy;`成功，`<wbr>`成功，`&#173;`成功
*   Firefox（35.0.1，Mac）： `&shy;`成功，`<wbr>`成功，`&#173;`成功
*   Safari (6.1.2, Mac)： `&shy;`成功，`<wbr>` *尚未测试*，`&#173;`成功
*   Edge (Windows 10)：`&shy;`成功、`<wbr>` **失败**（中断但没有连字符）、`&#173;`成功
*   IE11（Windows 10）：`&shy;`成功、`<wbr>` **失败**（没有中断）、`&#173;`成功
*   IE10 (Windows 10)：`&shy;`成功、`<wbr>` **失败**（没有中断）、`&#173;`成功
*   IE8（Windows 7）：不稳定 - 有时，它们根本不起作用，它们都只是遵循 css `word-wrap`。有时，它们似乎都有效。还没有找到任何明确的模式来解释原因。
*   IE7（Windows 7）：`&shy;`成功，`<wbr>`成功，`&#173;`成功

## 跨浏览器复制粘贴

成功：复制和粘贴整个单词，不带连字符。（在 Mac 上测试，粘贴到浏览器搜索、MS Word 2011 和 Sublime Text）

失败：使用连字符、空格、换行符或垃圾字符粘贴。

*   Chrome（40.0.2214.115，Mac）：`&shy;`成功，`<wbr>`成功，`&#173;`成功
*   Firefox（35.0.1，Mac）： `&shy;`成功，`<wbr>`成功，`&#173;`成功
*   Safari (6.1.2, Mac): 在 MS Word 中`&shy;` **失败（全部粘贴为连字符），在其他应用程序中成功**`<wbr>` **失败**，在 MS Word 中`&#173;` **失败**（全部粘贴为连字符），在其他应用程序中成功
*   IE10（Win7）：`&shy;` **失败**全部粘贴为连字符，`<wbr>` **失败**，`&#173;` **失败**全部粘贴为连字符
*   IE8 (Win7): `&shy;` **fail**全部粘贴为连字符，`<wbr>` **fail** , `&#173;` **fail**全部粘贴为连字符
*   IE7 (Win7): `&shy;` **fail**全部粘贴为连字符，`<wbr>` **fail** , `&#173;` **fail**全部粘贴为连字符

## 搜索引擎匹配

2017 年 11 月更新。`<wbr>`未测试，因为 StackOverflow 的 CMS 将其剥离。

成功：搜索整个非连字符的单词找到此页面。

失败：搜索引擎仅在搜索单词的损坏片段或带有连字符的单词时才找到此页面。

*   谷歌：`&shy;`失败，`&#173;`成功
*   必应：`&shy;`失败，`&#173;`失败
*   百度：`&shy;`失败，`&#173;`失败（可以匹配较长字符串中的片段，但不能匹配包含`&#173;`or的单词`&shy;`）
*   Yandex：`&shy;`失败，`&#173;`成功（虽然它可能匹配百度之类的字符串片段，但不是 100% 肯定）

## 跨浏览器在页面上查找

成败作为搜索引擎匹配。

*   Chrome（40.0.2214.115，Mac）：`&shy;`成功，`<wbr>`成功，`&#173;`成功
*   Firefox（35.0.1，Mac）： `&shy;`成功，`<wbr>`成功，`&#173;`成功
*   Safari（6.1.2，Mac）： `&shy;`成功，`<wbr>`成功，`&#173;`成功
*   IE10 (Win7): `&shy;` **fail**只在两者都包含shy hyphens 时匹配，`<wbr>`success, `&#173;` **fail**只在两者都包含shy hyphens 时匹配
*   IE8 (Win7): `&shy;` **fail**只在两者都包含shy hyphens 时匹配，`<wbr>`success, `&#173;` **fail**只在两者都包含shy hyphens 时匹配
*   IE7 (Win7): `&shy;` **fail**只在两者都包含shy hyphens 时匹配，`<wbr>`success, `&#173;` **fail**只在两者都包含shy hyphens 时匹配

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2013-02-10T12:56:17.423

正在努力[标准化 CSS3 中的连字符](http://www.w3.org/TR/css3-text/#hyphenation)。

一些现代浏览器，尤其是 Safari 和 Firefox，已经支持这一点。这是有关浏览器支持的最新[参考资料](http://caniuse.com/css-hyphens)。

一旦 CSS 断字得到普遍实施，那将是最好的解决方案。同时，我可以推荐[Hyphenator](http://code.google.com/p/hyphenator/) - 一个 JS 脚本，它计算出如何以最适合特定浏览器的方式对文本进行连字符。

连字符：

*   依赖于[Franklin M. Liangs 的连字算法](http://www.tug.org/docs/liang/liang-thesis.pdf)，通常来自 LaTeX 和 OpenOffice。
*   在可用的情况下使用 CSS3 连字符，
*   `&shy;`在大多数其他浏览器上自动插入，
*   支持多种语言，
*   高度可配置，
*   在未启用 javascript 的情况下优雅地回退。

我用过，效果很好！

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2013-02-15T09:16:53.013

我`&shy;`在必要时使用 , 手动插入。

我总是觉得遗憾的是人们不使用技术，因为有一些（可能是旧的或奇怪的）浏览器并没有按照指定的方式处理它们。我发现它`&shy;`在最近的 Internet Explorer 和 Firefox 浏览器中都可以正常工作，这应该足够了。您可能会包括一个浏览器检查，告诉人们使用成熟的东西，或者如果他们使用一些奇怪的浏览器，则继续自担风险。

音节化不是那么容易，**我不建议将它留给一些 Javascript**。这是一个特定于语言的主题，如果您不希望它使您的文本烦人，可能需要由服务员仔细修改。某些语言，例如德语，会形成复合词，并可能导致分解问题。例如`Spargelder`（*germ.* saved money, pl.），根据音节规则，可以被包裹在两个地方（`Spar-gel-der`）。然而，将它包裹在第二个位置，将第一部分变成`Spargel-`（*细菌。*芦笋），在读者的脑海中激活一个完全误导性的概念，因此应该避免。

那字符串`Wachstube`呢？它可以表示“警卫室”（`Wach-stu-be`）或“蜡管”（`Wachs-tu-be`）。您可能还可以找到其他语言的其他示例。**您的目标应该是提供一个环境，在该环境中，可以支持服务员创建音节清晰的文本，校对每个关键词。**

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2015-04-18T17:28:43.627

值得注意的是，从 HTML5 开始，`<wbr>`不`&shy;` **应该做同样的事情**！

**软连字符**

`&shy;`是软连字符，即U+00AD：软连字符。例如，

```
innehålls&shy;förteckning 
```

可能呈现为

```
innehållsförteckning 
```

或作为

```
innehålls-
förteckning 
```

截至今天，软连字符可在 Firefox、Chrome 和 Internet Explorer 中使用。

**`wbr`元素_**

[该`wbr`元素](http://www.w3.org/TR/2014/REC-html5-20141028/single-page.html#the-wbr-element)是一个分词机会，如果发生换行，则不会显示连字符。例如，

```
ABCDEFG<wbr/>abcdefg 
```

可能呈现为

```
ABCDEFGabcdefg 
```

或作为

```
ABCDEFG
abcdefg 
```

到今天为止，这个元素可以在 Firefox 和 Chrome 中使用。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-10-06T14:52:57.777

几乎在每个平台上，[零宽度空间](https://en.wikipedia.org/wiki/Zero-width_space)实体都可以`<wbr>`可靠地代替标签。

```
&#8203; 
```

同样有用的是[单词joiner](https://en.wikipedia.org/wiki/Word_joiner) entity，它可以用来禁止中断。（在单词的每个字符之间插入，除了你想要中断的地方。）

```
&#8288; 
```

有了这两个，你可以做任何事情。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-01-19T05:28:04.603

这是我不久前正在查看的跨浏览器解决方案，它在客户端上运行并使用 jQuery：

```
(function($) { 
  $.fn.breakWords = function() { 
    this.each(function() { 
      if(this.nodeType !== 1) { return; } 

      if(this.currentStyle && typeof this.currentStyle.wordBreak === 'string') { 
        //Lazy Function Definition Pattern, Peter's Blog 
        //From http://peter.michaux.ca/article/3556 
        this.runtimeStyle.wordBreak = 'break-all'; 
      } 
      else if(document.createTreeWalker) { 

        //Faster Trim in Javascript, Flagrant Badassery 
        //http://blog.stevenlevithan.com/archives/faster-trim-javascript 

        var trim = function(str) { 
          str = str.replace(/^\s\s*/, ''); 
          var ws = /\s/, 
          i = str.length; 
          while (ws.test(str.charAt(--i))); 
          return str.slice(0, i + 1); 
        }; 

        //Lazy Function Definition Pattern, Peter's Blog 
        //From http://peter.michaux.ca/article/3556 

        //For Opera, Safari, and Firefox 
        var dWalker = document.createTreeWalker(this, NodeFilter.SHOW_TEXT, null, false); 
        var node,s,c = String.fromCharCode('8203'); 
        while (dWalker.nextNode()) { 
          node = dWalker.currentNode; 
          //we need to trim String otherwise Firefox will display 
          //incorect text-indent with space characters 
          s = trim( node.nodeValue ).split('').join(c); 
          node.nodeValue = s; 
        } 
      } 
    }); 

    return this; 
  }; 
})(jQuery); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-05-11T05:51:37.370

我在少数桌面和移动浏览器中成功地使用了[软连字符 unicode 字符](http://en.wikipedia.org/wiki/Soft_hyphen)来解决这个问题。

unicode 符号`\u00AD`很容易插入到 Python unicode 字符串中，例如`s = u'Языки и методы програм\u00ADми\u00ADро\u00ADва\u00ADния'`.

其他解决方案是插入 unicode char 本身，源字符串在 Sublime Text、Kate、Geany 等编辑器中看起来非常普通（但光标会感觉到不可见的符号）。

内部工具的十六进制编辑器可以轻松地自动执行此任务。

一个简单的组合是使用稀有且可见的字符，例如`¦`，易于复制和粘贴，并使用软连字符替换它，例如`$(document).ready(...)`. 源代码之类`s = u'Языки и методы про¦гра¦м¦ми¦ро¦ва¦ния'.replace('¦', u'\u00AD')`的比`s = u'Языки и методы про\u00ADг\u00ADра\u00ADм\u00ADми\u00ADро\u00ADва\u00ADния'`.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-01-15T22:56:32.690

我建议使用`wbr`，所以代码可以这样写：

```
<p>这里有一段很长，很长的&lt;wbr
></wbr>文字；这里有一段&lt;/p> 
```

它不会导致字符之间的空格，同时`&shy;`不会停止由换行符创建的空格。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-02-20T21:33:26.420

`&#173;`有时，如果您使用 Unicode 字符串而不是`&shy;`实体，Web 浏览器似乎更宽容。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-12-30T07:29:21.990

如果运气不好还得使用 JSF 1，那么唯一的解决办法就是使用 ­, ­ 不起作用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-07-01T13:51:48.957

# <wbr> 和 ­

今天你可以同时使用两者。

**<wbr>**使用break，不要放更多信息。

示例，用于显示链接：

```
 https://stackoverflow.com/questions/226464/soft-hyphen-in-html-wbr-vs-shy 
```

**＆害羞的;** 必要时，此时文本将中断并添加连字符。

例子：

“É im­pos­sí­vel pa­ra um ho­mem a­pren­der a­qui­lo que ele acha que já sa­be。”

```
div{
  max-width: 130px;
  border-width: 2px;
  border-style: dashed;
  border-color: #f00;
  padding: 10px;
}
```

```
<div>https://<wbr>stackoverflow.com<wbr>/questions/226464<wbr>/soft-hyphen-in-<wbr>html-wbr-vs-shy</div>

<div>É im&shy;pos&shy;sí&shy;vel pa&shy;ra um ho&shy;mem a&shy;pren&shy;der a&shy;qui&shy;lo que ele acha que já sa&shy;be.</div>
```

# performance - 我应该使用乘法还是除法？

> ID：226465
> 
> 赞同：125
> 
> 时间：2008-10-22T16:01:23.060
> 
> 标签：performance, programming-languages

这是一个愚蠢有趣的问题：

假设我们必须执行一个简单的操作，我们需要一半的变量值。*通常*有两种方法可以做到这一点：

```
y = x / 2.0;
// or...
y = x * 0.5; 
```

假设我们使用该语言提供的标准运算符，哪一个具有更好的性能？

我猜乘法通常会更好，所以我在编码时尝试坚持这一点，但我想确认这一点。

虽然我个人对**Python** 2.4-2.5 的答案很感兴趣，但也可以随意发布其他语言的答案！如果您愿意，也可以随意发布其他更有趣的方式（例如使用按位移位运算符）。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-10-22T16:27:03.260

Python：

```
time python -c 'for i in xrange(int(1e8)): t=12341234234.234 / 2.0'
real    0m26.676s
user    0m25.154s
sys     0m0.076s

time python -c 'for i in xrange(int(1e8)): t=12341234234.234 * 0.5'
real    0m17.932s
user    0m16.481s
sys     0m0.048s 
```

乘法速度快 33%

卢阿：

```
time lua -e 'for i=1,1e8 do t=12341234234.234 / 2.0 end'
real    0m7.956s
user    0m7.332s
sys     0m0.032s

time lua -e 'for i=1,1e8 do t=12341234234.234 * 0.5 end'
real    0m7.997s
user    0m7.516s
sys     0m0.036s 
```

=> 没有真正的区别

LuaJIT：

```
time luajit -O -e 'for i=1,1e8 do t=12341234234.234 / 2.0 end'
real    0m1.921s
user    0m1.668s
sys     0m0.004s

time luajit -O -e 'for i=1,1e8 do t=12341234234.234 * 0.5 end'
real    0m1.843s
user    0m1.676s
sys     0m0.000s 
```

=> 只快 5%

结论：在 Python 中，乘法比除法更快，但是当您使用更高级的 VM 或 JIT 更接近 CPU 时，优势就消失了。未来的 Python VM 很可能会让它变得无关紧要

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2008-10-22T16:37:56.810

始终使用最清晰的内容。您所做的任何其他事情都是试图超越编译器。如果编译器很聪明，它会尽最大努力优化结果，但没有什么能让下一个人不讨厌你糟糕的位移解决方案（顺便说一下，我喜欢位操作，这很有趣。但有趣！=可读)

过早的优化是万恶之源。永远记住优化的三个规则！

1.  不要优化。
2.  如果您是专家，请参阅规则 #1
3.  如果您是专家并且可以证明需要，请使用以下程序：

    *   编码未优化
    *   确定“足够快”有多快——注意哪个用户需求/故事需要该指标。
    *   编写速度测试
    *   测试现有代码——如果它足够快，你就完成了。
    *   重新编码优化
    *   测试优化代码。如果不符合标准，请将其丢弃并保留原件。
    *   如果符合测试，请保留原始代码作为注释

此外，在不需要时删除内部循环或在数组上选择链表进行插入排序等操作都不是优化，只是编程。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2008-10-22T16:09:46.210

我认为这变得如此挑剔，以至于您最好做任何使代码更具可读性的事情。除非您执行数千次甚至数百万次的操作，否则我怀疑有人会注意到其中的差异。

如果你真的必须做出选择，基准测试是唯一的出路。找出给你带来问题的函数，然后找出问题出现在函数中的哪个位置，并修复这些部分。但是，我仍然怀疑单个数学运算（即使是重复很多次）是否会成为任何瓶颈的原因。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2008-10-22T16:11:38.673

乘法更快，除法更准确。如果您的数字不是 2 的幂，您将失去一些精度：

```
y = x / 3.0;
y = x * 0.333333;  // how many 3's should there be, and how will the compiler round? 
```

即使您让编译器以完美的精度计算出反转常量，答案仍然可能不同。

```
x = 100.0;
x / 3.0 == x * (1.0/3.0)  // is false in the test I just performed 
```

速度问题可能只在 C/C++ 或 JIT 语言中很重要，即使这样，也只有当操作处于瓶颈处的循环中时。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2009-03-18T00:19:54.697

如果你想优化你的代码但仍然很清楚，试试这个：

```
y = x * (1.0 / 2.0); 
```

编译器应该能够在编译时进行除法，因此您在运行时得到乘法。我希望精度与`y = x / 2.0`案例相同。

在嵌入式处理器中，这可能很重要，其中需要浮点仿真来计算浮点运算。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2009-12-27T08:57:06.953

只是要为“其他语言”选项添加一些东西。
C：因为这只是一个没有什么区别的学术练习，我想我会贡献一些不同的东西*。*

我编译为没有优化的程序集并查看了结果。
编码：

```
int main() {

    volatile int a;
    volatile int b;

    asm("## 5/2\n");
    a = 5;
    a = a / 2;

    asm("## 5*0.5");
    b = 5;
    b = b * 0.5;

    asm("## done");

    return a + b;

} 
```

编译`gcc tdiv.c -O1 -o tdiv.s -S`

除以 2：

```
movl    $5, -4(%ebp)
movl    -4(%ebp), %eax
movl    %eax, %edx
shrl    $31, %edx
addl    %edx, %eax
sarl    %eax
movl    %eax, -4(%ebp) 
```

乘以 0.5：

```
movl    $5, -8(%ebp)
movl    -8(%ebp), %eax
pushl   %eax
fildl   (%esp)
leal    4(%esp), %esp
fmuls   LC0
fnstcw  -10(%ebp)
movzwl  -10(%ebp), %eax
orw $3072, %ax
movw    %ax, -12(%ebp)
fldcw   -12(%ebp)
fistpl  -16(%ebp)
fldcw   -10(%ebp)
movl    -16(%ebp), %eax
movl    %eax, -8(%ebp) 
```

但是，当我将那些`int`s 更改为`double`s （这可能是 python 会做的）时，我得到了这个：

分配：

```
flds    LC0
fstl    -8(%ebp)
fldl    -8(%ebp)
flds    LC1
fmul    %st, %st(1)
fxch    %st(1)
fstpl   -8(%ebp)
fxch    %st(1) 
```

乘法：

```
fstpl   -16(%ebp)
fldl    -16(%ebp)
fmulp   %st, %st(1)
fstpl   -16(%ebp) 
```

我没有对任何代码进行基准测试，但仅通过检查代码，您可以看到使用整数，除以 2 比乘以 2 短。使用双精度，乘法更短，因为编译器使用处理器的浮点操作码，可能比不使用它们进行相同的操作运行得更快（但实际上我不知道）。所以最终这个答案表明，乘以 0.5 与除以 2 的性能取决于语言的实现和它运行的平台。最终，差异可以忽略不计，除了可读性之外，您几乎永远都不应该担心这一点。

作为旁注，您可以在我的程序中看到`main()`返回`a + b`。当我去掉 volatile 关键字时，你永远猜不到程序集的样子（不包括程序设置）：

```
## 5/2

## 5*0.5
## done

movl    $5, %eax
leave
ret 
```

它在一条指令中完成了除法、乘法和加法！显然，如果优化器是可敬的，您不必担心这一点。

对不起，答案太长了。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2016-09-13T01:47:41.293

首先，除非您使用 C 或 ASSEMBLY 工作，否则您可能使用的是更高级别的语言，在这种语言中，内存停滞和通用调用开销绝对会使乘法和除法之间的差异相形见绌。因此，只需选择在这种情况下读起来更好的内容。

如果您从一个非常高的级别进行交谈，那么对于您可能使用它的任何事情来说，它都不会明显变慢。您会在其他答案中看到，人们需要进行一百万次乘法/除法只是为了测量两者之间的亚毫秒差异。

如果您仍然好奇，从低级优化的角度来看：

除法的管道往往比乘法长得多。这意味着获得结果需要更长的时间，但是如果您可以让处理器忙于不相关的任务，那么它最终不会花费您更多的成本。

管道差异的长度完全取决于硬件。我使用的最后一个硬件是 FPU 乘法需要 9 个周期，FPU 除法需要 50 个周期。听起来很多，但是你会因为内存丢失而失去 1000 个周期，这样就可以正确看待事情了。

一个类比是在看电视节目时将馅饼放入微波炉中。你离开电视节目的总时间是把它放在微波炉里和从微波炉里拿出来的时间。剩下的时间你还在看电视节目。因此，如果馅饼需要 10 分钟而不是 1 分钟来烹饪，它实际上并没有占用你更多看电视的时间。

在实践中，如果您要达到关心乘法和除法之间差异的程度，您需要了解管道、缓存、分支停顿、无序预测和管道依赖关系。如果这听起来不像您打算回答这个问题的地方，那么正确的答案是忽略两者之间的区别。

许多（许多）年前，避免除法并始终使用乘法是绝对关键的，但当时内存命中不太相关，除法更糟糕。这些天我认为可读性更高，但如果没有可读性差异，我认为选择乘法是一个好习惯。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-22T16:31:35.433

写下哪个更清楚地说明您的意图。

在你的程序运行之后，找出慢的地方，然后让它更快。

不要反其道而行之。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-10-22T16:12:01.510

做任何你需要的事情。首先考虑你的读者，在确定你有性能问题之前不要担心性能。

让编译器为您完成性能。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-22T16:08:44.200

如果您使用整数或非浮点类型，请不要忘记您的位移运算符：<< >>

```
 int y = 10;
    y = y >> 1;
    Console.WriteLine("value halved: " + y);
    y = y << 1;
    Console.WriteLine("now value doubled: " + y); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-06-30T04:20:49.817

实际上有一个很好的理由，作为一般的经验法则，乘法比除法更快。硬件中的浮点除法可以通过移位和条件减法算法（二进制数的“长除法”）或 - 现在更可能 - 使用[Goldschmidt](http://en.wikipedia.org/wiki/Division_%28digital%29#Goldschmidt_division)算法等迭代来完成。移位和减法每比特精度至少需要一个周期（迭代几乎不可能像乘法的移位和加法一样并行化），并且迭代算法*每次迭代至少进行一次乘法运算*. 无论哪种情况，该部门很可能需要更多的周期。当然，这并没有考虑编译器、数据移动或精度方面的怪癖。但是，总的来说，如果您在程序的时间敏感部分编写内部循环，那么编写`0.5 * x`或`1.0/2.0 * x`而不是`x / 2.0`做一个合理的事情。“最清楚的代码”的迂腐是绝对正确的，但是所有这三个在可读性上都非常接近，以至于在这种情况下迂腐只是迂腐。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-22T16:08:56.710

乘法通常更快——当然永远不会慢。但是，如果不是速度关键，请写下最清晰的那个。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-22T16:07:12.597

我一直都知道乘法更有效。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-22T16:44:30.307

当您使用汇编语言或 C 语言进行编程时，这将成为一个更大的问题。我认为，对于大多数现代语言，诸如此类的优化正在为我完成。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-22T16:12:02.557

浮点除法（通常）特别慢，因此虽然浮点乘法也相对较慢，但它可能比浮点除法更快。

但我更倾向于回答“这并不重要”，除非分析表明除法与乘法相比有点瓶颈。不过，我猜测乘法与除法的选择不会对您的应用程序产生很大的性能影响。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-10-23T00:38:54.373

警惕“猜测乘法通常更好，所以我在编码时尽量坚持这一点”

在这个特定问题的背景下，更好的意思是“更快”。这不是很有用。

考虑速度可能是一个严重的错误。计算的特定代数形式存在深刻的错误含义。

请参阅[带有误差分析的浮点运算](http://www.dcs.ed.ac.uk/home/mhe/plume/node10.html)。请参阅[浮点算术和错误分析中的基本问题](http://www.cs.berkeley.edu/~demmel/cs267/lecture21/lecture21.html)。

虽然一些浮点值是精确的，但大多数浮点值是近似值；它们是一些理想值加上一些错误。每个操作都适用于理想值和误差值。

最大的问题来自试图操纵两个几乎相等的数字。最右边的位（错误位）来支配结果。

```
>>> for i in range(7):
...     a=1/(10.0**i)
...     b=(1/10.0)**i
...     print i, a, b, a-b
... 
0 1.0 1.0 0.0
1 0.1 0.1 0.0
2 0.01 0.01 -1.73472347598e-18
3 0.001 0.001 -2.16840434497e-19
4 0.0001 0.0001 -1.35525271561e-20
5 1e-05 1e-05 -1.69406589451e-21
6 1e-06 1e-06 -4.23516473627e-22 
```

在此示例中，您可以看到随着值变小，几乎相等的数字之间的差异会产生非零结果，其中正确答案为零。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-10-11T17:53:18.350

Java android，配置在三星 GT-S5830 上

```
public void Mutiplication()
{
    float a = 1.0f;

    for(int i=0; i<1000000; i++)
    {
        a *= 0.5f;
    }
}
public void Division()
{
    float a = 1.0f;

    for(int i=0; i<1000000; i++)
    {
        a /= 2.0f;
    }
} 
```

结果？

```
Multiplications():   time/call: 1524.375 ms
Division():          time/call: 1220.003 ms 
```

除法比乘法快 20% (!)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-22T16:09:57.257

我在某处读到乘法在 C/C++ 中效率更高；不知道解释语言 - 由于所有其他开销，差异可能可以忽略不计。

除非它成为一个问题，否则坚持使用更易于维护/可读的东西 - 当人们告诉我这一点时，我讨厌它，但它是如此真实。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-22T16:21:18.527

我一般建议乘法，因为您不必花费周期来确保除数不为 0。当然，如果除数是常数，则这不适用。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2010-11-06T10:39:16.223

与帖子 #24（乘法更快）和 #30 一样 - 但有时它们都一样容易理解：

```
1*1e-6F;

1/1e6F; 
```

〜我发现它们都一样容易阅读，并且必须重复数十亿次。所以知道乘法通常更快是有用的。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-06-29T17:09:30.613

有区别，但它取决于编译器。起初在 vs2003 (c++) 上，我对双精度类型（64 位浮点）没有显着差异。但是在 vs2010 上再次运行测试，我发现了一个巨大的差异，乘法速度快了 4 倍。跟踪这一点，似乎 vs2003 和 vs2010 生成了不同的 fpu 代码。

在 Pentium 4、2.8 GHz、vs2003 上：

*   乘法：8.09
*   分部：7.97

在 Xeon W3530、vs2003 上：

*   乘法：4.68
*   师：4.64

在 Xeon W3530、vs2010 上：

*   乘法：5.33
*   师：21.05

似乎在 vs2003 上，循环中的除法（因此除数被多次使用）被转换为与逆的乘法。在 vs2010 上，不再应用此优化（我想是因为两种方法之间的结果略有不同）。另请注意，只要分子为 0.0，cpu 就会更快地执行除法。我不知道芯片中硬连线的精确算法，但也许它取决于数字。

编辑 18-03-2013：对 vs2010 的观察

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-03-05T05:36:53.670

经过如此漫长而有趣的讨论，我对此的看法是：这个问题没有最终答案。正如一些人指出的那样，这取决于硬件（cf [piotrk](https://stackoverflow.com/users/151150/piotrk)和[gast128](https://stackoverflow.com/users/1079347/gast128)）和编译器（cf [@Javier](https://stackoverflow.com/users/11649/javier)的测试）。如果速度不是关键，如果您的应用程序不需要实时处理大量数据，您可以选择使用除法来提高清晰度，而如果处理速度或处理器负载是一个问题，则乘法可能是最安全的。最后，除非您确切知道您的应用程序将部署在哪个平台上，否则基准测试毫无意义。为了代码清晰，一条评论就可以完成这项工作！

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-05-29T10:34:26.490

这是一个愚蠢有趣的答案：

**x / 2.0**不**等于**x *** 0.5**

假设您在 2008 年 10 月 22 日编写了此方法。

```
double half(double x) => x / 2.0; 
```

现在，10 年后你知道你可以优化这段代码。整个应用程序中的数百个公式都引用了该方法。所以你改变它，并体验到 5% 的显着性能提升。

```
double half(double x) => x * 0.5; 
```

更改代码是正确的决定吗？在数学上，这两个表达式确实是等价的。在计算机科学中，这并不总是正确的。请阅读[最小化准确性问题的影响以](https://en.wikipedia.org/wiki/Floating-point_arithmetic#Minimizing_the_effect_of_accuracy_problems)获取更多详细信息。如果您的计算值 - 在某些时候 - 与其他值进行比较，您将改变边缘情况的结果。例如：

```
double quantize(double x)
{
    if (half(x) > threshold))
        return 1;
    else
        return -1;
} 
```

**底线是；一旦你适应了两者中的任何一个，那就坚持下去！**

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2008-10-22T16:10:39.827

好吧，如果我们假设添加/子轨道操作的成本为 1，则乘以成本 5，然后除以约 20 的成本。

* * *

## 回答 #25

> 赞同：-3
> 
> 时间：2012-01-20T15:34:53.627

从技术上讲，没有除法之类的东西，只有逆元素的乘法。例如，您从不除以 2，实际上您乘以 0.5。

“除法”——让我们自欺欺人，它存在一秒钟——总是比乘法更难，因为要“除”`x`一`y`首先需要计算出`y^{-1}`这样的值，`y*y^{-1} = 1`然后再进行乘法运算`x*y^{-1}`。如果您已经知道`y^{-1}`，那么不计算它`y`必须是一种优化。

# sql - cron 脚本充当队列或 cron 队列？

> ID：226473
> 
> 赞同：8
> 
> 时间：2008-10-22T16:02:40.953
> 
> 标签：sql, queue, cron

我打赌有人已经解决了这个问题，也许我使用了错误的谷歌搜索词来告诉我答案，但这是我的情况。

我有一个要运行的脚本，但我希望它只在预定时运行，并且一次只运行一个。（不能同时运行脚本）

现在棘手的部分是说我有一个名为“myhappyschedule”的表，其中包含我需要的数据和预定的时间。这张表甚至可以同时有多个预定时间，每个都运行这个脚本。所以基本上我需要一个每次脚本触发的队列，他们都需要等待每个脚本完成。（有时这可能只需要一分钟，脚本有时会执行很多分钟）

我正在考虑做的是制作一个脚本，每 5 分钟检查一次 myhappyschedule 并收集那些安排好的，将它们放入队列中，另一个脚本可以按顺序执行队列中的每个“作业”或事件。这一切听起来很混乱。

为了让它更长 - 我应该说我允许用户在 myhappyschedule 中安排事情而不是编辑 crontab。

关于这个还能做什么？文件锁和脚本调用脚本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T16:49:31.607

添加一列`exec_status`（`myhappytable`也许也`time_started`和`time_finished`，见伪代码）

每 x 分钟运行一次以下 cron 脚本

cron脚本的伪代码：

```
[create/check pid lock (optional, but see "A potential pitfall" below)]
get number of rows from myhappytable where (exec_status == executing_now)
if it is > 0, exit
begin loop
  get one row from myhappytable
    where (exec_status == not_yet_run) and (scheduled_time <= now)
    order by scheduled_time asc
  if no such row, exit
  set row exec_status to executing_now (maybe set time_started to now)
  execute whatever command the row contains
  set row exec_status to completed
  (maybe also store the command output/return as well, set time_finished to now)
end loop
[delete pid lock file (complementary to the starting pid lock check)] 
```

这样，脚本首先检查是否没有命令正在运行，然后首先运行 not-yet run 命令，直到在给定时刻没有更多命令要运行。此外，您可以通过查询数据库来查看正在执行的命令。

**一个潜在的陷阱：**如果 cron 脚本被杀死，计划任务将保持在“executing_now”状态。这就是开头和结尾的 pid 锁的用途：查看 cron 脚本是否正确终止。创建/检查 pidlock 的伪代码：

```
if exists pidlockfile then
  check if process id given in file exists
  if not exists then
    update myhappytable set exec_status = error_cronscript_died_while_executing_this   
      where exec_status == executing_now
    delete pidlockfile
  else (previous instance still running)
    exit
  endif
endif
create pidlockfile containing cron script process id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T16:15:54.420

您可以在脚本中使用 at(1) 命令来安排其下一次运行。在它退出之前，它可以检查 myhappyschedule 的下一次运行时间。你根本不需要cron，真的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T20:49:38.980

我在研究排队问题的解决方案时遇到了这个问题。为了其他在这里搜索的人的利益，这是我的解决方案。

将此与按计划启动作业的 cron 相结合（即使它们计划同时运行），也可以解决您描述的问题。

# 问题

* * *

*   最多应该运行一个脚本实例。
*   我们希望提示请求以尽快处理它们。

IE。我们需要一个通往脚本的管道。

# 解决方案：

* * *

为任何脚本创建管道。使用一个小的 bash 脚本完成（进一步向下）。

该脚本可以称为
`./pipeline "<any command and arguments go here>"`

例子：

```
./pipeline sleep 10 &
./pipeline shabugabu &
./pipeline single_instance_script some arguments &
./pipeline single_instance_script some other_argumnts &
./pipeline "single_instance_script some yet_other_arguments > output.txt" &
..etc 
```

该脚本为每个命令创建一个新的[命名管道](http://www.linuxjournal.com/content/using-named-pipes-fifos-bash)。所以上面将创建命名管道：`sleep`、、`shabugabu`和`single_instance_script`

在这种情况下，初始调用将启动阅读器并`single_instance_script`作为`some arguments`参数运行。一旦调用完成，读者将从管道中获取下一个请求并执行`some other_arguments`，完成，获取下一个等......

此脚本将阻止请求进程，因此将其称为后台作业（最后是 & ）或带有[`at`](http://linux.die.net/man/1/at)( `at now <<< "./pipeline some_script"`)的分离进程

```
#!/bin/bash -Eue

# Using command name as the pipeline name
pipeline=$(basename $(expr "$1" : '\(^[^[:space:]]*\)')).pipe
is_reader=false

function _pipeline_cleanup {
        if $is_reader; then
                rm -f $pipeline
        fi
        rm -f $pipeline.lock

        exit
}
trap _pipeline_cleanup INT TERM EXIT

# Dispatch/initialization section, critical
lockfile $pipeline.lock
        if [[ -p $pipeline ]]
        then
                echo "$*" > $pipeline
                exit
        fi

        is_reader=true
        mkfifo $pipeline
        echo "$*" > $pipeline &
rm -f $pipeline.lock

# Reader section
while read command < $pipeline
do
        echo "$(date) - Executing $command"
        ($command) &> /dev/null
done 
```

# ruby-on-rails - 应该从战壕中测试工作流程

> ID：226478
> 
> 赞同：5
> 
> 时间：2008-10-22T16:03:07.673
> 
> 标签：ruby-on-rails, ruby, tdd, bdd, shoulda

如今，Rails（而不仅仅是 Rails）开发世界中的每个人都在谈论 TDD（BDD）。很容易找到很多关于它的一般信息，有很多工具可以用于此目的，并且有很多（好的）示例说明如何使用它们。

现在，我已经在火车上了。我喜欢这个想法（以前从未做过 TDD），我决定选择 Shoulda（因为在我看来它很容易理解）。我读了很多例子，并做了一些初步测试。我的问题是：我只是不确定我是否做得对。正如我所说，网上有很多小例子，但我还没有找到任何全面的指南，涵盖 TDD 与 Shoulda 的整体工作流程。

以下是我的问题：

*   你用 Shoulda 练习 TDD 的方式是什么？（在一次迭代中，您通常的工作流程是什么？）
*   您还使用哪些其他工具（除了 Shoulda 本身）？
*   还有其他提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T10:12:05.700

我使用的是 RSpec 而不是 shoulda，（尽管我相信 shoulda 可以与 RSpec 一起使用）并且我的工作流程的最大改进来自使用 Autotest，然后是 RSpactor。

如果更新测试或实现文件，这些工具会自动监视您的源代码树的更改并执行相关测试。测试实践的一个很小的变化，但立即的反馈增加了我为每个功能编写测试的纪律。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T11:44:09.867

+1 自动测试。

如果您有一个大型测试套件并且只想运行您正在处理的测试（而不是整个测试套件），请查看这个用于 Autotest 的[猴子补丁。](http://gist.github.com/12605)

至于其他工具，您应该查看[Factory Girl](http://thoughtbot.com/projects/factory_girl)作为固定装置的替代品。

我对使用 Shoulda 的了解大部分来自于阅读其他测试代码。[在github](http://github.com/thoughtbot)上查看 Thoughtbot 的一些项目，例如[Clearance](http://github.com/hardbap/clearance/tree/master)和[Pacecar](http://github.com/thoughtbot/pacecar/tree/master)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-23T13:08:15.250

我完全同意 rails BDD 文档中有很大的差距。很多小例子，但没有大的例子给出了如何做到这一点的总体情况。甚至那些有测试章节的书都对此感到内疚。我见过的唯一完整示例是 peepcode 在 rspec 上的三部分截屏视频和关于 flex mock 的 confreaks 视频。

我很想听听关于 BDD 的其他优秀资源，这些资源超越了语法的小例子，我真的很想看到一本关于这个主题的书。

# comparison - 什么是最好的“交钥匙”词干算法？

> ID：226485
> 
> 赞同：7
> 
> 时间：2008-10-22T16:05:59.463
> 
> 标签：comparison, stemming

对于我正在从事的项目，我需要一个好的词干算法。有人建议我看看 Porter Stemmer。当我查看 Porter 词干分析器的页面时，我发现它现在已被弃用，取而代之的是“Snowball”词干分析器。

我需要一个好的词干分析器，但我真的不能花大量时间来实现（或优化）我自己的词干分析器。什么是最好的“现成”、免费提供的词干分析器？是否有任何价格合理的非免费词干分析器？或者，Snowball 词干分析器是我最好的选择吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-28T23:10:17.763

Porter2词干[分析器](http://snowball.tartarus.org/algorithms/english/stemmer.html)是我决定使用的。似乎搬运工词干分析器是标准，但是当我找到作者的页面时，他推荐了“雪球（Porter2）”词干分析器。此页面上有一个 C 端口链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T17:17:41.783

这实际上取决于您打算如何应用它。自然语言工具包 ( [http://nltk.sourceforge.net](http://nltk.sourceforge.net) ) 中实现了许多词干分析器，应该能够处理大多数应用程序。我更喜欢 Morphy 词干分析器。

当然，它可以在 Python 中使用，因此如果您正在使用另一种语言，您可以随时查看代码以收集算法并将其转换为您选择的语言。Python 具有高度可读性。

# java - Using Apache commons FileUpload

> ID：226503
> 
> 赞同：0
> 
> 时间：2008-10-22T16:08:51.453
> 
> 标签：java, jsp, upload, apache-commons-fileupload

This just won't work. The problem is that I do not know enough to even know what is supposed to happen. I can't debug this code. I'd like to store upload to temporary folder "temp" and then to move them to "applets". Please help? The servlet is obviously being accessed, but I can't find the uploaded files... Thanks in advance.

Form (which is created using a scriptlet - I put this here if that could cause problems):

```
<%
out.write("<p>Upload a new game:</p>");
                    out.write("<form name=\"uploadForm\" action=\"game.jsp\" "
                    + "method=\"POST\" enctype=\"multipart/form-data\">"
                    + "<input type=\"file\" name=\"uploadSelect\" value=\"\" width=\"20\" />"
                    + "<br><input type=\"submit\" value=\"Submit\" name=\"uploadSubmitButton\" "
                    + "onclick = \"submitToServlet2('UploadGameServlet');\">"        
                    + "</form>");
 %> 
```

Which calls this javascript:

```
function submitToServlet2(newAction)
    {
       document.uploadForm.action = newAction;
    } 
```

Which in turn goes to the servlet (code included in full, since there may be some important element hiding)

```
package org.project;

import java.io.*;
import java.util.Iterator;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
// import servlet stuff
import org.apache.commons.fileupload.*;

public class UploadGameServlet extends HttpServlet {

/** 
* Processes requests for both HTTP <code>GET</code> and <code>POST</code> methods.
* @param request servlet request
* @param response servlet response
*/
protected void processRequest(HttpServletRequest request, HttpServletResponse response)
throws ServletException, IOException {
    response.setContentType("text/html;charset=UTF-8");

    if (ServletFileUpload.isMultipartContent(request))
    {
        try 
        {
            // Create a factory for disk-based file items
            FileItemFactory factory = new DiskFileItemFactory();

            // Create a new file upload handler
            ServletFileUpload upload = new ServletFileUpload(factory);

            // Parse the request
            List items = upload.parseRequest(request); /* FileItem */

            File repositoryPath = new File("\\temp");
            DiskFileItemFactory diskFileItemFactory = new DiskFileItemFactory();
            diskFileItemFactory.setRepository(repositoryPath);

            Iterator iter = items.iterator();
            while (iter.hasNext()) 
            {
                FileItem item = (FileItem) iter.next();
                File uploadedFile = new File("\\applets");
                item.write(uploadedFile);
            }            
        }
        catch (FileUploadException ex) 
        {
            Logger.getLogger(UploadGameServlet.class.getName()).log(Level.SEVERE, null, ex);
        }
        catch (Exception ex) 
        {
            Logger.getLogger(UploadGameServlet.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    PrintWriter out = response.getWriter();
    try {
        out.println("<html>");
        out.println("<head>");
        out.println("<title>Servlet UploadGameServlet</title>");  
        out.println("</head>");
        out.println("<body>");
        out.println("<h1>Servlet UploadGameServlet at " + request.getContextPath () + "</h1>");
        out.println("</body>");
        out.println("</html>");
    } finally { 
        out.close();
    }
} 
```

}

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-22T16:46:27.837

```
File repositoryPath = new File("\\temp");
File uploadedFile = new File("\\applets"); 
```

By trying to access these files without any sort of leading or absolute path, you are trying to write to files (not directories) named `temp` and `applets` under the current working directory. In an app server, the current working directory is usually the `bin` folder (depends on what app server you use, etc).

Some suggestions:

1.  Use an absolute path (preferably stored in web.xml or a properties file) to refer to the directory you want to save files to.
2.  You have to specify the name of the file you want to write to, you probably want to create some sort of random/unique name per request.
3.  Save yourself some keystrokes and use a member variable instead of all the `Logger.getLogger(UploadGameServlet.class.getName())` references!
4.  Add some debugging, especially to see where you are writing your data to - log the result of `repositoryPath.getAbsolutePath()`, for example.

# regex - 关于使用正则表达式进行 URL 验证的问题

> ID：226505
> 
> 赞同：3
> 
> 时间：2008-10-22T16:09:06.850
> 
> 标签：regex, url

我有以下正则表达式可以很好地匹配 url：

```
((https?|ftp|gopher|telnet|file|notes|ms-help):((//)|(\\\\))+[\w\d:#@%/;$()~_?\+-=\\\.&]*)` 
```

但是，它不处理没有前缀的 url，即。**stackoverflow.com**或**www.google.com**不匹配。任何人都知道我可以如何修改这个正则表达式而不关心是否有前缀？

* * *

编辑：我的问题是否太含糊？它需要更多细节吗？

* * *

```
(((https?|ftp|gopher|telnet|file|notes|ms-help):((//)|(\\\\)))?[\w\d:#@%/;$()~_?\+-=\\\.&]*) 
```

我加了一个（）？围绕**Vinko Vrsalovic**建议的协议，但现在正则表达式几乎可以匹配任何字符串，只要它具有有效的 URL 字符。

我的实现是我有一个管理内容的数据库，它有一个字段，可以是纯文本、电话号码、URL 或电子邮件地址。我正在寻找一种简单的方法来验证输入，以便我可以正确格式化它，即。为网址/电子邮件创建锚标记，并格式化电话号码我如何在整个站点中格式化其他号码。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T17:05:26.147

下面的正则表达式来自精彩的[Mastering Regular Expressions](http://www.amazon.co.uk/Mastering-Regular-Expressions-Jeffrey-Friedl/dp/0596528124/ref=sr_1_1/279-4458937-3540756?ie=UTF8&s=books&qid=1224694042&sr=8-1)书。如果您不熟悉[自由间距/注释模式](http://www.regular-expressions.info/freespacing.html)，我建议您熟悉它。

```
\b
# Match the leading part (proto://hostname, or just hostname)
(
    # ftp://, http://, or https:// leading part
    (ftp|https?)://[-\w]+(\.\w[-\w]*)+
  |
    # or, try to find a hostname with our more specific sub-expression
    (?i: [a-z0-9] (?:[-a-z0-9]*[a-z0-9])? \. )+ # sub domains
    # Now ending .com, etc. For these, require lowercase
    (?-i: com\b
        | edu\b
        | biz\b
        | gov\b
        | in(?:t|fo)\b # .int or .info
        | mil\b
        | net\b
        | org\b
        | name\b
        | coop\b
        | aero\b
        | museum\b
        | [a-z][a-z]\b # two-letter country codes
    )
)

# Allow an optional port number
( : \d+ )?

# The rest of the URL is optional, and begins with / . . . 
(
     /
     # The rest are heuristics for what seems to work well
     [^.!,?;"'<>()\[\]{}\s\x7F-\xFF]*
     (?:
        [.!,?]+  [^.!,?;"'<>()\[\]{}\s\x7F-\xFF]+
     )*
)? 
```

为了简要解释这个正则表达式（要获得完整的解释，请参阅本书） - URL 有一个或多个点分隔部分，以有限的最终位列表或两个字母的国家/地区代码 (.uk .fr ...) 结尾。此外，部件可以有任何字母数字字符或连字符“-”，但连字符不能是部件的第一个或最后一个字符。然后可能有一个端口号，然后是其余的。

要从网站中提取此内容，请访问[http://regex.info/listing.cgi?ed=3&p=207](http://regex.info/listing.cgi?ed=3&p=207) 它来自第 3 版的第 207 页。

页面上写着“版权所有 © 2008 Jeffrey Friedl”，所以我不确定使用条件到底是什么，但我希望如果你拥有这本书，你可以使用它......我希望我是不违反规则把它放在这里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T18:00:49.403

如果您阅读 URL 规范 ( [http://www.isi.edu/in-notes/rfc1738.txt](http://www.isi.edu/in-notes/rfc1738.txt) ) 的第 5 部分，您将看到 URL 的语法至少为：

```
scheme ':' schemepart 
```

其中 scheme 是 1 个或多个字符，schemepart 是 0 个或多个字符。因此，如果没有冒号，就没有 URL。

也就是说，/users/ 不在乎他们是否给了你一个 url，对他们来说它看起来像一个。所以这就是我所做的：

在验证之前，如果其中没有冒号，请在前面加上 http://，然后通过您想要的任何验证器运行它。这会将任何合法的主机名（可能不包括域信息，毕竟）变成看起来像 URL 的东西。

```
frob  ->  http://frob 
```

（几乎）主机部分的唯一规则是，如果它不包含点，则它不能以数字开头。现在，应该针对特定方案执行特定的验证，到目前为止给出的正则表达式都没有完成。但是，规范合规性可能不是您想要“验证”的内容。因此，对主机名部分的 dns 查询可能很有用，但除非您在与用户相同的上下文中使用相同的解析器，否则它不会在所有情况下都有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T16:28:26.143

您的正则表达式匹配从这些协议之一开始的所有内容，包括许多不可能存在的 URL，如果您放宽协议部分（使用 ? 使其成为可选），那么您将匹配几乎所有内容，包括空字符串.

换句话说，它在匹配 URL 方面做得很好，因为它几乎可以匹配以[http://、https://、ftp://](http://,https://,ftp://)等开头的任何内容。好吧，它也匹配 ftp:\\ 和 ms-help://，但让我们忽略它。

根据实际使用情况，这可能是有意义的，因为将有效域列入白名单的其他正则表达式方法很快变得不可维护，但是使协议部分可选是没有意义的。

一个例子（放宽协议部分就位）：

```
>>> r = re.compile('(((https?|ftp|gopher|telnet|file|notes|ms-help):((//)|(\\\\))+)?[\w\d:#@%/;$()~_?\+-=\\\.&]*)')
>>> r.search('oompaloompa_is_not_an_ur%&%%l').groups()[0]
'oompaloompa_is_not_an_ur%&%%l' #Matches!
>>> r.search('oompaloompa_isdfjakojfsdi.sdnioknfsdjknfsdjk.fsdnjkfnsdjknfsdjk').groups()[0]
'oompaloompa_isdfjakojfsdi.sdnioknfsdjknfsdjk.fsdnjkfnsdjknfsdjk' #Matches!
>>> 
```

鉴于您的编辑，我建议您要么让用户选择他添加的内容，添加一个枚举列，要么创建一个更简单的正则表达式，除了有效字符和一些公共域之外，它至少会检查一个点。

第三种选择将**非常缓慢**并且仅在 URL 验证非常**重要**时使用，实际上是访问 URL 并对其执行 HEAD 请求，如果您找不到主机或错误，您知道它是无效的。对于电子邮件，您可以尝试查看 MX 主机是否存在并且端口 25 是否打开。如果两者都失败，它将是纯文本。（我也不建议这样做）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T16:39:56.697

您可以将前缀部分括在括号中并匹配 0 或 1 次出现

`(((https?|ftp|gopher|telnet|file|notes|ms-help):((//)|(\\\\))+)?`

所以整个正则表达式将变为

`(((https?|ftp|gopher|telnet|file|notes|ms-help):((//)|(\\\\))+)?[\w\d:#@%/;$()~_?\+-=\\\.&]*)`

问题在于它或多或少会匹配任何单词。例如“测试”也将是一个匹配项。

你打算在哪里使用那个正则表达式？您是要验证主机名还是要在段落中查找主机名？

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-10-22T16:23:54.077

只需使用：

```
.* 
```

即匹配一切。

您要匹配的只是主机名，而不是 URL（技术上）。

没有可用于明确识别主机名的结构。也许您可以查找以“.com”结尾的内容，但您会错过任何 .co.uk、net、.org 等。

编辑：

换句话说：如果您删除类似 URL 的东西以协议开头的要求，您将没有任何东西可以匹配。取决于您使用正则表达式的内容：

1.  将所有内容视为 URL
2.  保留对协议的要求
3.  黑客检查主机名的共同结尾（例如 .com .net .org）并接受你会错过一些。

# python - Django Forms - 如何使用前缀参数

> ID：226510
> 
> 赞同：23
> 
> 时间：2008-10-22T16:10:03.853
> 
> 标签：python, html, django, forms

假设我有这样的表格：

```
class GeneralForm(forms.Form):
    field1 = forms.IntegerField(required=False)
    field2 = forms. IntegerField(required=False) 
```

我想在一个表单标签内的页面上显示两次，每次使用不同的前缀，例如：

```
rest of page ...
<form ..>
GeneralForm(data,prefix="form1").as_table()
GeneralForm(data,prefix="form2").as_table()
<input type="submit" />
</form>
rest of page ... 
```

当用户提交这个时，我如何将提交的表单重新放入两个单独的表单中进行验证，然后重新显示它？

[这是](http://docs.djangoproject.com/en/dev/ref/forms/api/#prefixes-for-forms)我能找到的唯一文档，而且很饿。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-22T16:27:38.780

您像往常一样处理每个表单，确保您创建的实例具有与最初用于生成表单的前缀相同的前缀。

这是使用您提供的表格的一个稍微尴尬的示例，因为我不知道确切的用例是什么：

```
def some_view(request):
    if request.method == 'POST':
        form1 = GeneralForm(request.POST, prefix='form1')
        form2 = GeneralForm(request.POST, prefix='form2')
        if all([form1.is_valid(), form2.is_valid()]):
            pass # Do stuff with the forms
    else:
        form1 = GeneralForm(prefix='form1')
        form2 = GeneralForm(prefix='form2')
    return render_to_response('some_template.html', {
        'form1': form1,
        'form2': form2,
    }) 
```

这是一些真实的示例代码，它演示了使用前缀处理表单：

[http://collingrady.wordpress.com/2008/02/18/editing-multiple-objects-in-django-with-newforms/](http://collingrady.wordpress.com/2008/02/18/editing-multiple-objects-in-django-with-newforms/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-09T23:53:01.327

更好的是，我认为[表单集](http://docs.djangoproject.com/en/dev/topics/forms/formsets/)正是您正在寻找的。

```
class GeneralForm(forms.Form):
    field1 = forms.IntegerField(required=False)
    field2 = forms. IntegerField(required=False)

from django.forms.formsets import formset_factory

# GeneralSet is a formset with 2 occurrences of GeneralForm 
# ( as a formset allows the user to add new items, this enforces
#   2 fixed items, no less, no more )
GeneralSet = formset_factory(GeneralForm, extra=2, max_num=2)

# example view

def someview(request):
    general_set = GeneralSet(request.POST)
    if general_set.is_valid():
        for form in general_set.forms:
            # do something with data
    return render_to_response("template.html", {'form': general_set}, RequestContext(request)) 
```

您甚至可以使用 modelformset_factory 从模型自动生成一个[表单集](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#id1)，供自动化 django 管理员使用。FormSet 比简单的表单处理更多的东西，比如添加、删除和排序项目。

# java - 在 web.xml 中声明 JSP taglib 指令

> ID：226514
> 
> 赞同：13
> 
> 时间：2008-10-22T16:11:20.467
> 
> 标签：java, jsp, jsp-tags

我似乎记得读过可以声明 taglib 指令，例如：

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %> 
```

在 web.xml 中。这消除了在每个使用 taglib 的 JSP 文件中复制该指令的需要。有人可以告诉我*如何*将这些指令添加到 web.xml 中吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-23T03:21:52.423

`taglib`web.xml 中的元素与`taglib`您上面的指令有不同的用途。

正如大卫所说，`taglib`每一页都需要该指令。

如果您有许多使用通用标签库的页面，您可以通过将标签库指令放入包含文件中来简化此操作，并在每个页面中包含该文件。但不管你怎么做，taglib 指令必须以某种方式出现在页面上。

您需要在每个页面上包含的标签如下所示：

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %> 
```

如果您在自定义位置有自定义 taglib，您还可以指定相对于 webapp 根目录的位置：

```
 <%@ taglib prefix="ex" uri="/taglib.tld" %> 
```

[进一步阅读 taglib 指令](http://java.sun.com/products/jsp/syntax/1.2/syntaxref1211.html)

web.xml 中的`taglib`指令将标记 uris 映射到标记库的物理位置。从 JSP 2.0 开始它是可选的，因为兼容的容器将在一组标准位置中查找以尝试自动发现标记库：/WEB-INF 及其子目录，/META-INF 以及 JAR 文件。

它看起来像这样，在 web.xml 中：

```
<taglib>
  <taglib-uri>
    http://www.example.com/taglib
  </taglib-uri>
  <taglib-location>
    /taglib.tld
  </taglib-location>
</taglib> 
```

并且在JSP页面中引用taglib是这样的（每个页面上的taglib指令是不可避免的！）：

```
<%@ taglib prefix="ex" uri="http://www.example.com/taglib" %> 
```

这相当于我为上面的 taglib 指令给出的第二个示例。最大的区别在于您指向 taglib 位置的方式。

[此页面](http://wiki.metawerx.net/wiki/Web.xml.TagLib)包含更多信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-22T16:31:44.543

对不起，你有点误会了。如果页面使用 taglib，则必须在页面上有一个 taglib 指令。您可以将常见的 taglib 指令放在一个包含文件中，您的所有页面都使用 include 指令包含该文件，但在编译时 taglib 指令必须在那里。

我更喜欢不在 web.xml 中包含 taglib 元素，而是让 taglib 指令指定在 WEB-INF/lib 中 taglib jar 文件内的 TLD 中的“uri”元素中使用的 URI 值.

# .net - Microsoft.VisualBasic 命名空间是“真正的 .NET”代码吗？

> ID：226517
> 
> 赞同：58
> 
> 时间：2008-10-22T16:11:42.260
> 
> 标签：.net, vb.net

我的开发团队正准备开始一个新项目。自 VB3 时代以来，该商店一直是“VB 商店”，但现在普遍认为我们是“.NET 商店”，因为 C# 是专门为 .NET 创建的，而 VB.NET 是一种改造，我们'已经决定继续编写 C#。争议围绕 Microsoft.VisualBasic 命名空间是否在新开发中具有合法地位，或者它是否只是为了向后兼容 VB6（和更旧）代码的问题展开。另一个更有趣的问题是，“在”Microsoft.VisualBasic 命名空间下的代码是否甚至是 .NET 代码，如果它真的是在 .NET 包装器中仔细打包的旧 VB 运行时，那么它实际上是一个 COM 互操作控件（类似于 WinForms 如何包装非 .NET Win32 窗口 API 但仅公开 .

更令人困惑的是，我们的开发团队有一位 Microsoft 咨询服务顾问告诉我们，Microsoft 不再支持 Visual Basic，**包括 Microsoft.VisualBasic 命名空间下的 VB 运行时**。

我正在寻找的是链接——最好是无可挑剔的微软资源——指向以一种或另一种方式明确回答这个问题的文档。我已经在 Google 上尝试了几种搜索排列，但还没有接近这个问题的根源。

编辑：显然我没有把我的问题说清楚。我不是在问*VB.NET*是否是真正的 .NET 代码。我正在尝试确定**Microsoft.VisualBasic 命名空间**“下”的内容是否是 .NET 代码，或者它是否是经过精心打包并公开为 .NET 代码的旧 VB6 运行时。有人已经说过，命名空间的 9/10 只是简单地包装了 .NET 中其他地方的代码；那另一个1/10呢？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-10-22T17:05:21.763

**Microsoft.VisualBasic.dll <> Microsoft.VisualBasic.Compatibility.dll** !!!

（或者，如果您愿意，*Microsoft.VisualBasic.dll != Microsoft.VisualBasic.Compatibility.dll;* ）

**Microsoft.VisualBasic.Compatibility**命名空间专供 VB6 升级向导使用，可能会在将来的版本中删除，并且永远不应用于新的开发。

**Microsoft.VisualBasic**命名空间绝对是 100% 真实的.Net，完全受支持，并且只要 .Net 存在，它就会存在。

一些相关链接：

*   讨论：[Microsoft.VisualBasic 是否已弃用？](http://osdir.com/ml/windows.devel.dotnet.winforms/2004-10/msg00185.html)

*   文章：[使用 VB.NET 实现纯 .NET 开发](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-1050037.html)
*   请参阅[对此 MSDN VBFAQ 博客文章的评论](http://blogs.msdn.com/vbfaq/archive/2004/05/30/144571.aspx)

[编辑：从这篇 MSDN 文章中](http://msdn.microsoft.com/en-us/library/aa289509.aspx)添加了官方词：

> Visual Basic 运行时为全局 Visual Basic 函数和语言特性（例如 Len、IsDate 和 CStr）提供底层实现。尽管新的 Visual Basic 运行时提供了与其前身类似的功能，**但它完全是在公共语言运行时上执行的托管代码（在 Visual Basic .NET 中开发）**。此外，Visual Basic 运行时是 .NET Framework 的一部分，因此您的应用程序永远不会单独携带或部署它。

和

> Visual Basic 6.0 兼容性库不同于 Visual Basic 运行时。Microsoft.VisualBasic.Compatibility 命名空间由将 Visual Basic 6.0 代码升级到 Visual Basic .NET 的工具使用。它是支持 Visual Basic 的 .NET 实现不直接支持的 Visual Basic 6 功能的桥梁。**与 Visual Basic 运行时不同，兼容性库并非由所有 Visual Basic .NET 应用程序隐式引用**。当您将 Visual Basic 6 项目升级到 Visual Basic .NET 时，升级向导会添加对 Microsoft.VisualBasic.Compatibility 的引用。
> 
> **兼容性类不应该用于新的开发**。Microsoft.VisualBasic.Compatibility 命名空间为您的 Visual Basic .NET 应用程序增加了一层复杂性，并引入了一些可以通过重新编码应用程序部分来消除的最小性能成本。此外，Compatibility 命名空间通常包含许多包装 COM 对象的类，并且如前所述，依赖于 COM 对象不如纯托管实现最佳。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-22T16:24:17.103

使用 .NET Reflector 并查看它。我经常这样做。Microsoft.VisualBasic 命名空间中的 10 个调用中有 9 个只是 .NET 方法的包装器。

您的顾问正在做顾问最擅长的事情：炫耀他的存在是为了让您的预算更大。MS 不再支持 VB6，但 VS 2008 具有 VB .NET 的事实应该表明它们将支持 VB .NET 至少几年。

就个人而言，我将 Microsoft.VisualBasic 视为其他 .NET 类的外观。当它是一个个人项目时，我会使用它，并且我可以比使用 BCL 类更快、更轻松地完成我的工作。与 String.Substring 相比，Microsoft.VisualBasic.Strings.Right 就是一个很好的例子。但是，对于 VB 命名空间中的许多函数（如 Val），在框架的语言特定程度较低的部分中有更健壮和强大的版本。如果我正在为工作编写代码，我不会使用 VB 库。这使得不熟悉 VB 的 C# 开发人员不会更难理解我的代码。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-22T16:30:08.307

与 FCL 中的某些功能一样，一些 Microsoft.VisualBasic 命名空间代码是用托管代码编写的，其中一些封装了对非托管代码的调用。

肯定没有对 vb6 运行时的依赖，它肯定不会在引擎盖下悄悄地安装 vb6 运行时。

您应该加载 .NET Reflector 并查看 Microsoft.VisualBasic 命名空间中的代码。

如果您想继续使用 C# 命名空间中的功能，请继续这样做，它不会消失。某些代码可能会被标记为已弃用/过时，但我预计在 15 年后，您仍然可以使用 Microsoft.VisualBasic 功能运行相同的应用程序而不会遇到任何问题。

更新：除了使用 .NET 反射器，您现在还可以查看/调试源 Microsoft.VisualBasic 命名空间/Microsoft.VisualBasic.DLL 代码：

[http://blogs.msdn.com/vbteam/archive/2008/01/19/source-code-of-visual-basic-runtime-has-been-released-to-public.aspx](http://blogs.msdn.com/vbteam/archive/2008/01/19/source-code-of-visual-basic-runtime-has-been-released-to-public.aspx)

去获取框架大量下载器并在闲暇时仔细阅读代码：

[http://www.codeplex.com/NetMassDownloader](http://www.codeplex.com/NetMassDownloader)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-22T16:20:04.770

我相信它们都编译成相同的字节码。

这是我的参考： http: [//www.codinghorror.com/blog/archives/000128.html](http://www.codinghorror.com/blog/archives/000128.html)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-22T16:21:12.507

声明“Microsoft 不再支持 Visual Basic”可能意味着几件事，因为有多个版本的 Visual Basic - VB 1 到 6、VBA 和 VB.NET。

“Microsoft 不再支持 Visual Basic.NET”的声明如果属实，那将是个大新闻，**但事实并非如此**。（我在谷歌上查过）。对 VB6 的支持已经结束，但 VB.Net 仍然非常活跃并获得了新功能。

VB.Net 编译为 MSIL 字节码，该字节码取决于某些 .Net 库，具体取决于您使用的 .net 框架类。其中一些库不是用纯 .Net 编写的，或者只是 Windows API 的包装器。这是必需的，因为那些未内置在 .net 中的功能（例如线程）必须以受控方式暴露给它。

C# 也是如此。运行时并不真正关心生成它执行的 MSIL 的语言。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-22T16:22:22.783

Microsoft 的目标是使 VB .NET 和 C# 成为具有不同语法的相同语言。这是真的。然而，变化总是像 VB9 对 XML 文字的新处理一样悄悄出现。他要问的是他们是否将所有旧 VB6 和以前的功能重新实现为 .NET 托管代码。我的猜测是否定的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-22T16:26:03.777

我对 VB.NET 做的不多（更多的是使用 C#），但据我所知，它们都编译为相同的字节码，因此由 .NET 运行时进行相同的解释，并且它们在功能上是等效的，只是语法不同。

不过，当我上次使用 VB.NET 时，它似乎与 VB6 大不相同。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-22T16:37:20.180

正如 OwenP 所说，Microsoft.VisualBasic 命名空间中的大多数调用只是对现有 .NET 功能的包装。那么为什么要创建包装器呢？

创建 VB.NET 时，Microsoft 希望开发人员能够将现有的 VB6 项目导入 .NET。这只有在 VB6 函数和方法调用在 VB.NET 中具有匹配的功能时才可行。因此，他们创建了 Microsoft.VisualBasic 命名空间来将该 VB6 功能映射到 .NET 功能。（纯属猜测，但有道理）

随着 .NET 进入新版本，他们无法删除 Microsoft.VisualBasic 命名空间——很多代码可能仍在使用它。所以它仍然存在。

此外，您甚至可以在不使用 Microsoft.VisualBasic 命名空间的情况下编写 VB.Net 代码。（正如 Kev 所暗示的，您可以使用 C# 中的 Microsoft.VisualBasic 命名空间。） VB.Net 只是一种语言，.NET 框架保持不变。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-22T16:16:09.053

有一堆 .NET 代码，微软实际上只是包装了 COM 功能。我不是许可专家，但您可以随时获取 Reflector 并查看该命名空间并亲自查看。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-22T16:20:37.173

我认为一个好的起点是微软提供的关于 VB.net 的 MSDN 文档

[http://msdn.microsoft.com/en-us/library/2x7h1hfk.aspx](http://msdn.microsoft.com/en-us/library/2x7h1hfk.aspx) 该链接将是有关该语言的最新 Visual Studio 2008 文章。

VB 在 CLR 下编译与 C# 相同，所以我不知道您的顾问从哪里来。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-22T16:26:34.273

VB.NET 代码不直接编译成二进制。它像 C# 一样被编译为[IL （中间语言）。](http://msdn.microsoft.com/en-us/library/496e4ekx.aspx)

这意味着无论您在 VB.NET 中构建什么，它都可以在 C# 项目中重用，而不会出现任何问题。

我无法找到与您所询问的内容直接相关的任何链接。主要原因是 VB.NET 是一个新的积极开发的框架的一部分。没有计划使该语言过时。无论其他顾问说什么。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-22T16:28:00.573

据我所知，正如您所说，VB.NET 是“真正的 .net”代码。有很多不同的语言（C#、VB.NET、F#、Cobol.NET 等）都“编译”成 IL 代码。该 IL 代码实际上由 .NET VM 运行并解释为机器代码。您在语言之间进行交互的对象仍然是相同的底层 .NET 对象。

例如，在 C# 中：

> 数据表 dt = 新数据表（）；

编译为与 VB.NET 中的等效代码完全相同的 IL 代码：

> 将 dt 调暗为 DataTable = new DataTable()

事实上，在 .NET Reflector 等直接查看 IL 代码的反编译器工具中，您可以让它以 C# 或 VB.NET 显示输出，无论您更喜欢哪种方式。

这也意味着我可以在 VB.NET 中编写一个类库“myVbCode.dll”，它直接与用 C#“myCSharpCode.dll”编写的类库兼容。事实上，这两个 DLL 都只包含编译后的 IL 代码。

所有这一切都可能有一些外围的例外，但从根本上说，这就是它的工作原理。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-22T16:29:21.180

对您的问题的直接回答是 VB.NET 与 C# 一样多是“真正的 .NET 代码”。

当然，两种语言中都有另一种语言无法直接使用的语法功能（例如，VB.NET 的语法中内置了一些 C# 所没有的 XML 功能），但是在 VB 中您无能为力。 NET 你不能在 C# 中做，反之亦然，至少据我所知。

我想说的是，如果您有 VB 经验，那么过渡到 VB.NET 当然会比过渡到 C# 更容易。

# c# - System.Data.OleDb.OleDbException：互联网地址无效。如何使用 OleDb 连接到位于网络服务器上的 excel 文件

> ID：226524
> 
> 赞同：6
> 
> 时间：2008-10-22T16:14:07.823
> 
> 标签：c#, excel, oledb, jet

我正在尝试创建与位于 SharePoint 服务器上的 Excel 文件的 OleDb 连接。我目前正在使用的示例代码引发 OleDb 异常“无效的 Internet 地址”：

```
public static void ConnectToRemoteExcelFile()
    {
        string connectionString = String.Format("Provider=Microsoft.ACE.OLEDB.12.0;Data Source={0};Extended Properties=\"Excel 8.0;HDR=Yes;\";", "http://horde.servername.co.uk/Docs/Documents/Sales.xlsx");

        using (OleDbConnection connection = new OleDbConnection(connectionString))
        {
            connection.Open();
        }

    } 
```

有人知道如何连接到网络服务器上的 Excel 电子表格吗？

**更新**

Microsoft 支持已回复我并同意无法连接到位于 Web 服务器上的 Excel 文件。Jet .40 和 news ACE（Access Connectivity Engine）都不支持这种操作模式。他们引用了知识库文章[“在 Access 2000、Access 2002、Access 2003 和 Access 2007 中，FTP 或 HTTP 服务器帮助主题上的导入/链接数据不正确”](http://support.microsoft.com/kb/237590/en-us)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T17:42:20.657

据我所知，这是不可能的，您必须先下载文件，然后再访问它。原因是由于文件的位置无法修改文件。

# python - 如何在 Django 中放置指向网站主页的链接/网址？

> ID：226528
> 
> 赞同：23
> 
> 时间：2008-10-22T16:14:40.943
> 
> 标签：python, django, django-urls

在 Django 模板中，上下文中是否有一个变量（例如`{{ BASE\_URL }}`, `{{ ROOT\_URL }}`，或者`{{ MEDIA\_URL }}`可以用来链接到`home`项目的 url？

即，如果 Django 在项目的根目录中运行，则模板中的变量（我们称之为 R）`{{ R }}`将是`/`. 如果根 url 是子文件夹`http://host/X/`，则变量`{{ R }}`将是`/X/`（或`http://host/X/`）。

这似乎很简单，但我找不到答案。：） 谢谢！

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-10-22T16:19:44.567

您可以为用于处理主页的 URL 配置命名并使用它：

网址.py：

```
from django.conf.urls.defaults import *

urlpatterns = patterns('myproject.views',
    url(r'^$', 'index', name='index'),
) 
```

模板：

```
<a href="{% url index %}">... 
```

**更新：**较新版本的 Django 需要在视图名称周围加上引号：

```
<a href="{% url 'index' %}">... 
```

Django Book 中的这个注释有一些关于将应用程序部署到子目录的提示：

[http://www.djangobook.com/en/1.0/chapter20/#cn43](http://www.djangobook.com/en/1.0/chapter20/#cn43)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-22T16:17:46.040

我总是使用类似的东西`<a href="/">`（当然，假设你的家在根部）。我似乎记得曾经查找过这个，但找不到该路径的 Django 变量；无论如何，无论如何，`/`似乎很容易。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-22T17:33:42.937

在您的管理员中，转到“站点”并设置域。

传递`context_instance=RequestContext(request)`给有问题的模板。

现在`{{ SITE_URL }}`在任何这些模板中使用，你就很成功了。

[Django Book 的第 10 章提供的](http://www.djangobook.com/en/1.0/chapter10/)信息比您需要重新了解上下文处理器位更多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-30T18:56:56.313

```
(r'^$', 'django.views.generic.simple.redirect_to', {'url': '/home/'}), 
```

工作正常 ：）

# .net - 单人软件商店构建自动化的最佳工具是什么？

> ID：226530
> 
> 赞同：7
> 
> 时间：2008-10-22T16:15:13.610
> 
> 标签：.net, build-automation

我正在为一些客户构建 Windows 应用程序。我阅读了 Joel on Software 并参加了 Joel 测试，并意识到我并没有完全符合要求。我缺少的一个地方是自动化构建。我应该使用什么来进行自动化构建？我有使用 .NET 1.1、2.0 和 3.5 的 Windows 应用程序。此外，我需要能够构建我的 .vdproj 来创建 MSI。我正在寻找免费的东西，并且适合单人团队。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-22T16:17:41.560

[CruiseControl.Net](http://www.cruisecontrolnet.org/)和[NAnt](http://nant.sourceforge.net/)是标准工具（也是开源的），因此会有很多可用的社区支持。[MSBuild](https://github.com/Microsoft/msbuild)现在也是开源的

设置这一切将是相当多的工作，但它会非常强大并且也有很大的增长空间。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-22T16:17:45.087

JetBrains 的 TeamCity 专业版。[http://www.jetbrains.com/teamcity/](http://www.jetbrains.com/teamcity/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T16:20:58.730

MSBuild 对我很有用

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T16:20:04.770

使用内置的[MSBuild 引擎](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)。如果您已经有一个解决方案或项目文件，这非常适合。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-05T23:37:41.240

我制作并销售了一个名为 Build Automator (http://www.buildautomator.com) 的工具，它是为构建和自动化的东西而编写的。它是为我使用的数据库语言（Clarion）设计的，但它适用于 MS-Build for VS 或 Delphi（RAD Studio）我最近没有太多时间想更新它，但是我几乎每天都使用它，它每周为我节省几个小时！我有客户在复杂的构建操作中使用它以及其他构建自动化工具。只是我的 0.02 美元 :)

最好的祝福，

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T16:33:38.907

我已经广泛使用 CruiseControl 和 TeamCity。对于一个人的商店，TeamCity 比 CruiseControl 更容易设置和配置。

对于您的构建脚本，MsBuild 或 NAnt 不会出错。我也一直在考虑使用 Powershell，但我还没有尝试过。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-28T03:29:17.117

自发布以来，我对 NUBuild 非常满意。根据您的要求，我认为 NUBuild 将是完美的匹配。您可以在 10 分钟内设置（仅一次）并准备好构建您的项目。看看这个 -

[http://nubuild.codeplex.com](http://nubuild.codeplex.com)

# java - 将 Java UNO 代码从 OpenOffice 2.4 迁移到 3.0

> ID：226550
> 
> 赞同：1
> 
> 时间：2008-10-22T16:21:50.180
> 
> 标签：java, openoffice.org, spreadsheet, uno

我编写了一个漂亮的小工具，用于将电子表格转换为纯文本。由于它是我的私人黑客工具，它依靠 OpenOffice 2.x 来读取文件。

但是当我安装**OpenOffice 3**并试图让它运行时，我失败了，因为我要么丢失了一些 JAR 文件，要么一半的类已被替换。

我包含了来自 URE/Java 的所有五个 JAR 文件（URE：[UNO](http://en.wikipedia.org/wiki/Universal_Network_Objects) 运行时环境，OpenOffice.org 托管和管理 UNO 组件的一个子集），但仍然缺少这些类：

```
com.sun.star.frame.XComponentLoader
com.sun.star.frame.XController
com.sun.star.frame.XDesktop
com.sun.star.frame.XModel
com.sun.star.frame.XStorable
com.sun.star.sheet.XSpreadsheet
com.sun.star.sheet.XSpreadsheetDocument
com.sun.star.sheet.XSpreadsheetView
com.sun.star.text.XTextDocument 
```

任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T13:46:18.637

我找到了我所缺少的。

我必须包括以下罐子

```
URE/java/juh.jar
URE/java/jurt.jar
URE/java/ridl.jar
Basis/program/classes/unoil.jar 
```

我之前错过的最后一个 -*请注意德语 OOo 版本*。

而且，我以前不需要做的事情，我必须包含 OOo 可执行文件的路径，例如

```
c:/program/OpenOffice.org 3/program/ 
```

之后，无需更改代码，它就像以前一样工作。

所以，Brian，UNO 的 API 即使在主要版本之间也是稳定的。这只是我必须修复的类路径。

# c# - C#：部分类和 Web 服务：分离形式和功能

> ID：226554
> 
> 赞同：2
> 
> 时间：2008-10-22T16:22:23.923
> 
> 标签：c#, web-services, encapsulation, partial-classes

我正在涉足 Web 服务领域，并且一直在制作一个简单的 Web 服务来模拟数学运算。首先它很简单，传入两个整数，然后根据调用的方法将二元运算符应用于这些（加号、减号等）。

然后我决定让事情变得更复杂一些，并开始传递对象，但后来我发现 Web 服务只公开了类的数据方面，而不是功能方面。

有人告诉我，解决这个问题的一个好方法是让服务端的类成为一个部分类（类封装形式的这一端），而在客户端有另一个部分类（类的这一端封装功能）。这似乎是一种优雅的做事方式..

所以，我已经如上所述设置了两个类，但它似乎并没有像我被告知的那样工作。

我正在尝试的可能吗？如果是这样，我哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T19:47:48.500

分部类实际上是一种将自动生成的代码与开发人员代码分开的工具。

一个很好的例子是 VS 中的 windows 窗体设计器，或者新的 DBML Linq DataContext 生成代码。

还有一个论点是将它们与 VSS 风格的源代码控制提供程序一起使用，其中任何时候只有一个用户可以编辑文件。

将它们用于功能的逻辑分离并不是一个好主意 - 该划分仅存在预编译。编译后，您只得到一个类，但没有一个易于调试或跟踪内部操作的类。

您所描述的听起来像是使用 WCF 合同的一个非常好的情况。在这种情况下，客户端和服务器都将共享一个接口（或多个接口）。

您的复杂代码会去那里，并且可以单独进行单元测试 - 即在您连接的应用程序之外。然后，当发现错误时，您可以快速消除代码问题并转而调查与连接相关的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-23T10:56:53.553

（这个线程可能已经死了，但是......）我正在考虑做类似的事情，但在（在我的情况下）Windows服务上具有功能。

客户端程序和 Windows 服务都需要访问数据，但只有服务需要对数据进行实际操作；它们都包含在一个 dll 中，该 dll 包含一个包含合同数据成员的部分类，但是我收到一个错误，说这个部分类与我的服务上的部分类冲突，即使它们都在同一个命名空间中，而且目前，服务器的部分类为空。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T16:34:41.933

不是部分课程。部分类是一种语法结构，它使您能够在不同的源文件中拥有类的不同部分。但是，部分类的所有部分最终都编译成同一个二进制文件。

您可以使用扩展方法向您的类添加表示数据协定的功能。

您还可以尝试在共享程序集中实现该类，并使用 svcutil.exe /reference 将其导入客户端代理，而不是在 Web 服务命名空间中使用全新的声明。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T19:28:31.537

正如弗朗西所说，它只是允许您将同一类的不同部分放入不同的文件中。

相反，您应该如何构建事物实际上取决于您在做什么。如果我是你，我可能会有一个相当简单的数据承载类和一个可用于处理该数据的消费者。

使用共享程序集也是一个好主意。但是，如果您真的希望能够将代码从服务器发送到客户端，CSharpCodeProvider 就可以了。

# iphone - 动画后，视图位置重置

> ID：226555
> 
> 赞同：27
> 
> 时间：2008-10-22T16:23:41.207
> 
> 标签：iphone, cocoa-touch, core-animation

我正在尝试从上到下制作视图幻灯片。这没什么大不了的，我用`CABasicAnimation`这个。问题是当我想删除视图时。我用这个动画。

```
CABasicAnimation *animation;
animation = [CABasicAnimation animationWithKeyPath:@"position"];
[animation setDelegate:self];
animation.toValue = [NSValue valueWithCGPoint:CGPointMake(self.view.layer.position.x, 0 - self.view.bounds.size.height / 2)];
animation.fromValue = [NSValue valueWithCGPoint:self.view.layer.position];
animation.autoreverses = NO;
animation.repeatCount = 0;
animation.duration = 0.25;
animation.timingFunction = [CAMediaTimingFunction functionWithName: kCAMediaTimingFunctionEaseInEaseOut];
[self.view.layer  addAnimation:animation forKey:@"moveX"]; 
```

完美地为视图设置动画。但是，动画结束后，我的视图又出现了。所以我添加了这一行：

```
[self.view removeFromSuperview]; 
```

这会删除视图，但没有动画。所以我决定将删除代码添加到这个委托：

```
-(void) animationDidStop:(CAAnimation *) animation finished:(bool) flag 
```

所以现在，动画起作用了，视图消失了，但有时，我可以看到视图出现和消失的速度更快，就像动画之后，视图出现，然后`animationDidStop`调用委托，视图消失，显然这很糟糕。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-10-30T16:05:38.563

可能要设置这些属性。它们导致演示文稿在动画结束时保留。

`animation.fillMode = kCAFillModeForwards;
animation.removedOnCompletion = NO;`

Then the "animationDidStop:" method can be used to remove the view at the end of the animation:

```
-(void) animationDidStop:(CAAnimation *) animation finished:(bool) flag {
    if (animation == [containerView.layer animationForKey:@"moveX"]) {
        // remove view here, add another view and/or start another transition
    }
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-22T22:41:15.470

好吧，根据 Apple 示例“MoveMe”，这个（**removedOnCompletion**）应该可以工作，但是，它似乎没有。

因此，在您的代码之后添加这些行：

```
`[self.view.layer  addAnimation:animation forKey:@"moveX"];
self.view.layer.position = [animation.toValue CGPointValue];` 
```

`这确保了动画运行后，图层被正确定位。`

 `* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-25T20:02:23.563

I had this issue when performing several animations in an animation group. I had to set a couple properties on the animation group itself, not the individual animations.

```
CAAnimationGroup *animGroup = [CAAnimationGroup animation];

// MAKE SURE YOU HAVE THESE TWO LINES.
animGroup.removedOnCompletion = NO;
animGroup.fillMode = kCAFillModeForwards;

animGroup.animations = [NSArray arrayWithObjects:moveAnim, scaleAnim, nil];
animGroup.duration = tAnimationDuration;
[tImageView.layer addAnimation:animGroup forKey:nil]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T17:04:48.440

按照 Rob 的建议将视图设置为隐藏应该这样做。

对于属性的属性，我会坚持使用 ObjC 2.0 样式，就像您在代码中已有的那样。

```
set.view.hidden = YES; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T17:31:43.877

这个也咬了我一口。您想将动画的 removedOnCompletion 标志设置为 NO。它默认为 YES，这意味着在动画完成后，它被移除，并且视图恢复到其初始状态。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-10-22T16:46:16.760

您可以将视图的隐藏属性设置为“是”吗？

我认为会是：

```
self.view.hidden = YES; 
```

但它可能是：

```
[self.view setHidden:YES]; 
```

事实证明，我在找出访问属性的正确方法方面相当蹩脚。

# vb.net - 在 Visual Studio 中关闭 VB.NET 的自动折叠？

> ID：226561
> 
> 赞同：3
> 
> 时间：2008-10-22T16:26:36.787
> 
> 标签：vb.net, visual-studio

*代码*属性的自动折叠功能在您完成所有属性之后很简洁，但是当您仍在编辑它们时，我发现该功能真的很烦人。

**你怎么能禁用它？**

（如果有区别，我在 VS2008 中）

编辑：我不是在谈论属性窗口......我在谈论代码中的属性。

```
Private _firstName As String
Public Property FirstName() As String Implements IPerson.FirstName
    Get
        Return _firstName
    End Get
    Set(ByVal value As String)
        _firstName = value
    End Set
End Property 
```

显示为

```
Public Property FirstName()... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T17:25:21.580

从“编辑”菜单中，选择“大纲”、“停止大纲”。您还可以使用键盘快捷键 CTRL+M、CTRL+P。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-12T10:54:56.667

这似乎是 DevX Refactor for VB 的一个“功能”，我也觉得这*很*烦人。我在他们的论坛上找到[了这个帖子，它提供了一些建议的解决方案：](http://community.devexpress.com/forums/t/75568.aspx)

*   向注册表添加一个键，使 DevExpress 菜单在 VS 中可见，然后转到选项页面以禁用自动折叠或
*   安装较新版本的插件（9.1.4 或更高版本）显然不再以这种方式运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T16:24:28.767

停止大纲选项对我来说永远不起作用。此外，Ctrl+M、Ctrl+M 选项似乎仅在我突出显示折叠区域时才有效。Ctrl+M，Ctrl+P 对我没有任何作用。我进入选项并取消选中进入大纲模式，但这也没有做任何事情。有一次，当我有 VS 2005（现在我有 2008）时，我设法通过 regedit hack 将其关闭。虽然有一次我不得不重新安装 VS 2005 并且忘记了破解，所以从那以后我就一直忍受着这个。当您在寻找代码模式而不是代码的特定单词时，这是非常烦人的。我不知道为什么会这样，但我经常这样做。任何帮助，将不胜感激。泰。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-22T16:53:37.353

窗口打开后，单击右上角的图钉（X 和向下箭头之间的中间图标）。完成后，再次单击它以再次启用自动隐藏。

# html - 如何使用正则表达式按其类删除整个 HTML 标记（及其内容）？

> ID：226562
> 
> 赞同：7
> 
> 时间：2008-10-22T16:26:51.653
> 
> 标签：html, regex, perl, filter

我不太擅长正则表达式，但我正在学习。

我想通过类名删除一些 html 标记。这是我到目前为止所拥有的：

```
<div class="footer".*?>(.*?)</div> 
```

首先 。*？是因为它可能包含其他属性，第二个是它可能包含其他 html 内容。

我究竟做错了什么？我已经尝试了很多设置但没有成功。

### 更新

在 DIV 内它可以包含多行，我正在使用 Perl 正则表达式。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-22T16:52:25.860

正如其他人所说，使用正则表达式处理 HTML 是出了名的棘手，而 DOM 方法可能会更好。例如：

```
use HTML::TreeBuilder::XPath;

my $tree = HTML::TreeBuilder::XPath->new;
$tree->parse_file( 'yourdocument.html' );

for my $node ( $tree->findnodes( '//*[@class="footer"]' ) ) {
    $node->replace_with_content;   # delete element, but not the children
}

print $tree->as_HTML; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-22T16:32:54.057

您还需要在 div 标签中允许在上课之前做其他事情

```
<div[^>]*class="footer"[^>]*>(.*?)</div> 
```

另外，不区分大小写。您可能需要转义引号或结束标记中的斜线等内容。你在什么背景下做这件事？

另请注意，使用正则表达式进行 HTML 解析可能非常讨厌，具体取决于输入。在下面的答案中提出了一个很好的观点 - 假设您的结构如下：

```
<div>
    <div class="footer">
        <div>Hi!</div>
    </div>
</div> 
```

试图为此构建一个正则表达式是灾难的根源。最好的办法是将文档加载到 DOM 中，然后对其进行操作。

应该紧密映射到 XML::DOM 的伪代码：

```
document = //load document
divs = document.getElementsByTagName("div");
for(div in divs) {
    if(div.getAttributes["class"] == "footer") {
        parent = div.getParent();
        for(child in div.getChildren()) {
            // filter attribute types?
            parent.insertBefore(div, child);
        }
        parent.removeChild(div);
    }
} 
```

* * *

这是一个 perl 库[HTML::DOM](http://search.cpan.org/dist/HTML-DOM/)和另一个[XML::DOM](http://search.cpan.org/src/ENNO/libxml-enno-1.02/html/XML/DOM/Node.html)
.NET 具有用于处理 dom 解析的内置库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T16:37:05.437

在 Perl 中，您需要`/s`修饰符，否则点将不匹配换行符。

也就是说，使用适当的 HTML 或 XML 解析器来删除 HTML 文件中不需要的部分更为合适。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T04:07:42.717

```
<div[^>]*class="footer"[^>]*>(.*?)</div> 
```

为我工作，但需要在特殊字符之前使用反斜杠

```
<div[^>]*class=\"footer\"[^>]*>(.*?)<\/div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T16:31:06.247

部分取决于您使用的确切正则表达式引擎 - 哪种语言等。但一种可能性是您需要转义引号和/或正斜杠。您可能还想让它不区分大小写。

```
<div class=\"footer\".*?>(.*?)<\/div> 
```

否则，请说出您使用的语言/平台 - .NET、java、perl ...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T16:34:19.750

试试这个：

```
<([^\s]+).*?class="footer".*?>([.\n]*?)</([^\s]+)> 
```

您最大的问题将是嵌套标签。例如：

```
<div class="footer"><b></b></div> 
```

给出的正则表达式将通过 匹配所有内容`</b>`，最后留下`</div>`悬空。您将不得不假设您要查找的标记没有嵌套元素，或者您将需要使用某种从 HTML 到 DOM 的解析器和 XPath 查询来删除整个子树。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T16:37:26.327

由于正则表达式的贪婪，这将很棘手，（请注意，我的示例*可能*特定于 perl，但我知道贪婪是 RE 的普遍问题。）第二个`.*?`将在 之前尽可能匹配`</div>`，所以如果你有以下几点：

`<div class="SomethingElse"><div class="footer"> stuff </div></div>`

表达式将匹配：

`<div class="footer"> stuff </div></div>`

这不太可能是您想要的。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-10-22T16:31:47.523

为什么`<div class="footer".*?</div>` 我也不是正则表达式大师，但我认为您不需要为打开的 div 标签指定最后一个括号

# .net - 是否可以将本地实例 IIS 指向共享的 Windows 文件服务器作为主目录？

> ID：226564
> 
> 赞同：1
> 
> 时间：2008-10-22T16:27:10.420
> 
> 标签：.net, iis, localhost, shared-directory

我刚刚开始使用 IIS、.NET 等，如果有任何不清楚的地方，我深表歉意。我最近安装了一个本地 IIS 实例，它运行良好。我想知道是否可以将 IIS 指向另一台服务器上存在的共享 windows 文件夹，并将该文件夹用作 IIS 的根目录。这是可能吗？如果是这样，谁能指出我解释如何做到这一点的资源？

需要注意的一件事是共享文件夹需要身份验证。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T16:32:16.947

是的，在 IIS 管理控制台中，转到网站属性并查看“主目录”选项卡。您可以指定“位于另一台计算机上的共享”。当您选择此选项时，您还将在“网络目录”字段旁边看到一个“连接为”按钮。

# vba - VB6 和 VBA 的替代 IDE

> ID：226565
> 
> 赞同：64
> 
> 时间：2008-10-22T16:27:13.353
> 
> 标签：vba, vb6, ide, vbe

我被 Visual Studio 2008 和 Eclipse 宠坏了，不得不对一个 VB6 应用程序做一些维护工作。

有谁知道 VB6 的替代/更新 IDE？

重写不是一种选择，我只是修复了几个错误，它是一个很大的代码库。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-10-22T22:05:38.397

我从未听说过 Vb6 的替代 IDE。但是，这两个（免费）VB6 插件是必不可少的，它们会让您的生活更轻松——尤其是在有大量代码的情况下。它们对于 Microsoft Office 中的 VBA 同样有效。

**MZ-Tools**：提供了极好的 IDE 工具集合 - 查找未使用的变量、未使用的方法、出色的“搜索全部”、代码片段。由 Carlos J. Quintero 撰写，我现在欠他几个小时的时间。

[http://www.mztools.com/v3/mztools3.aspx](http://www.mztools.com/v3/mztools3.aspx)

还有**SmartIndenter**，它负责所有的自动缩进。它只做一件事，而且做得很好。

[http://www.oaltd.co.uk/Indenter/Default.htm](http://www.oaltd.co.uk/Indenter/Default.htm)

![MZ-Tools 菜单截图](https://i.stack.imgur.com/7o6ug.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-22T16:38:30.787

前段时间我做了一些研究，但没有任何结果。我不相信你有任何真正的选择......

但是您可以考虑检查一下： [http](http://www.axtools.com/products/cs2k3vb_screenshots.htm) ://www.axtools.com/products/cs2k3vb_screenshots.htm 它看起来很有希望。

> Addin for Visual Basic 6.0 包含 50 多个专业工具和助手。代码视图助手丰富了标准 VB6 代码编辑器，其中包含用于条件语句、行尾详细信息和热点的分支行。此外，代码分析器可查明死代码和慢代码，SmartComplete 和自动图文集工具可帮助您以前所未有的熟练程度编写代码，而具有扩展代码和代码流视图的增强型项目资源管理器可以让您快速访问代码位置总是需要。其他工具：扩展查找、查找参考、设计器资源管理器、代码格式化程序、TabOrder 设计器（带自动排序）、热键设计器、错误处理程序插入器、异常保护、拼写检查器、字符串检查器、评论一致性检查器、任务列表管理器、代码片段经理，

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-24T04:23:03.267

由于 VB6 IDE***不***检测在 IDE 之外进行的***文件更改，因此在 VB6 IDE 之外开发代码可能非常困难，而不会冒丢失代码更改的风险。***

但是可以从命令行运行 VB6 项目构建，**因此**可以使用任何能够运行命令并捕获其输出的文本编辑器/IDE 进行简单的 VB 开发。

但是对于诸如 GUI 更改和调试之类的事情，除了恢复到 VB6 IDE 之外，真的别无选择。

以下是从 DOS 提示符运行构建所需的命令：

```
set PATH="d:\Program Files\Microsoft Visual Studio\VB98\";%PATH%
vb6.exe /out ErrorFile.txt /make MyProject.vbp 
```

**FWIW** [Zeus IDE](http://www.zeusedit.com)能够导入VB 项目文件**并将**项目详细信息显示到项目/工作区树中。它还将运行构建并捕获输出。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-05-23T02:27:56.373

[Visual Basic Tools For Visual Studio](http://visualstudiogallery.msdn.microsoft.com/6a06be60-1198-486e-9bce-6ace36b24316%20Visual%20Basic%20Tools%20For%20Visual%20Studio)允许您在 Visual Studio 2012/2013 中打开 vb6 项目，其中包含基本大纲、语法着色和更多内容。

这是一项正在进行的工作，但如果你像我一样有一些活死的 vb6 程序需要维护，这……很有趣。

除了没有 GUI 编辑器，没有调试。我担心这些点（尤其是调试）会破坏交易。（当然，我明白并非一切皆有可能）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-27T17:03:37.903

是的，没有替代 IDE 可以替代 VB6 afaik。但我使用的一个不可或缺的插件是 CodeHelp。它给你标签！对于 Windows，简单的标签排序，全屏切换器，也许还有鼠标滚轮加载项。从[Planet Source Code](http://www.planetsourcecode.com/vb/scripts/ShowCode.asp?txtCodeId=62468&lngWId=1)页面查看。并且一定要检查下载到安装文件的评论，因为我在源代码和作者的网站上有问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-04-11T21:14:36.980

CodeHelp Add-In 2.2 惊人的 VB6 插件，帮助组织和编码。

[http://www.planetsourcecode.com/vb/scripts/ShowCode.asp?txtCodeId=62468&lngWId=1](http://www.planetsourcecode.com/vb/scripts/ShowCode.asp?txtCodeId=62468&lngWId=1)

[![在此处输入图像描述](https://i.stack.imgur.com/cPMQz.gif)](https://i.stack.imgur.com/cPMQz.gif)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-24T16:06:25.877

我在 VB6 中编程时使用了[Visual Assist X。](http://www.wholetomato.com/)这是一个代码着色插件。
必须的，一旦你习惯了VS2005+
，我不知道当前版本是否还支持VB6，所以你应该自己看看看看（也许得到一个旧版本）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-09-17T22:50:24.560

DoyleSoft BASIC 替代视觉基础

jabaco 编译器也是——

# c# - WPF背后的C#代码中的XPath

> ID：226572
> 
> 赞同：3
> 
> 时间：2008-10-22T16:28:20.587
> 
> 标签：c#, wpf, xml, xaml, xpath

如果您在 XAML 中绑定 XML 文档，您可以使用 XPath，但是如果您在后面的代码中动态加载 XML 文档怎么办？后面的 C# 代码中是否有任何可用的 XPath 方法？

（使用 .NET 3.5 SP1）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T17:27:19.253

将 XML 加载到后面代码中的 XPathDocument 中，并使用 XPathNavigator 来保存查询。XPathNavigator.Select() 的结果是返回选定节点的迭代器。

示例（使用 System.XML 和 System.Xml.XPath）：

```
XPathDocument doc = new XPathDocument(@"c:\filepath\doc.xml");
XPathNavigator nav = doc.CreateNavigator();
XPathNodeIterator iter = nav.Select("/xpath/query/here");

while(iter->MoveNext)
{
  //Do something with node here.
} 
```

# c++ - 奇怪的程序挂起，debug中这是什么意思？

> ID：226577
> 
> 赞同：1
> 
> 时间：2008-10-22T16:29:46.327
> 
> 标签：c++, c, boost-asio, freeze

奇怪的程序挂起，debug中这是什么意思？

附加windbg后，我发现以下内容：

```
(1714.258)：访问冲突 - 代码 c0000005（第一次机会）
在任何异常处理之前报告第一次机会异常。
可以预期并处理此异常。
eax=015b5c74 ebx=178a13e0 ecx=dddddddd edx=009a8ca0 esi=09fbf698 edi=09fbf594
eip=005ae2f7 esp=09fbf4a4 ebp=09fbf594 iopl=0 nv up ei ng nz na pe nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00010286
TestApplication!std::_Container_base::_Orphan_all+0x57:
005ae2f7 c70100000000 mov dword ptr [ecx],0 ds:0023:dddddddd=????????

```

调用堆栈：

```
TestApplication!std::_Container_base::_Orphan_all+0x57
TestApplication!std::vector >::operator=+0x37
TestApplication!boost::asio::detail::win_iocp_io_service::do_one+0x189
TestApplication!boost::asio::detail::win_iocp_io_service::run+0xa2
TestApplication!boost::asio::io_service::run+0x3a

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-22T16:49:09.627

如果您使用 MSVC 和 Debug 构建配置，`0xdddddddd`通常意味着您正在尝试访问已释放的内存。调试 CRT 内存管理器用`0xdd`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T16:53:42.177

**问题**

1.  第一次机会异常意味着调试器正在给你，使用调试器的人，第一次调试异常的机会，然后它将异常抛出回程序来处理问题。

2.  在这种情况下，例外是“访问冲突”。这意味着您的程序正在尝试从非法内存位置读取/写入。

3.  访问冲突很严重，因为它可能会破坏一些对您的程序至关重要的内存，这可能是您的程序挂起的原因。

4.  从错误指令看来，您似乎正试图从非法指令中获取 4 字节值的内容。

**调试问题**

5.  如果这是您的代码，那么您可以通过将调试符号位置设置为编译器的输出文件夹来轻松调试此问题（这将包含相关的 pdb 文件）

6.  当您收到此异常时，请获取调用堆栈（其中一个视图窗口会拥有它）

7.  这将向您显示代码中错误堆栈的起源位置。

8.  现在打开包含此源的文件并在此处设置断点，程序将到达该点并在 Windebugger 内停止。从这一点开始调试，您将确切知道从哪一行代码中引发了此违规行为

提示：Boost 带有源代码，因此您可以轻松地在此代码中放置断点。当您进入 asio::detail::win_iocp_io_service::do_one 时，请务必在调试时按 F11。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T16:32:48.457

ecx 寄存器的地址无效 (dddddddd)。我建议这是一个内存损坏的情况。考虑为该进程打开 gflags。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T19:36:52.890

调用堆栈完全是 STL/Boost 代码。除非您所做的事情与众不同，否则我不会假设该错误位于您粘贴的调用堆栈的任何部分。

有几件事要检查：

1.  任何应该定义但不是 Boost 的特定 #defines？

2.  安全 SCL 和迭代器调试。尝试启用/禁用它。

3.  您是否正在混合调试和发布代码。（使用 STL/Boost 容器是个坏主意）

# .net - 在不停止服务的情况下更新 dll

> ID：226581
> 
> 赞同：11
> 
> 时间：2008-10-22T16:30:51.270
> 
> 标签：.net, windows, dll, windows-services

我想在不停止服务的情况下更新服务器进程的 dll。我怎么做？有点像 asp.net 如何自动拾取放在 bin 文件夹中的新 dll。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-22T16:32:41.907

Asp.Net 使用一种称为[影子复制的技术](http://www.odetocode.com/articles/305.aspx)

如果将更新的 dll 复制到应用程序的 bin 子目录中，ASP.NET 运行时会识别出有新代码要执行。由于 ASP.NET 无法将 dll 交换到现有的 AppDomain 中，因此它会启动一个新的 AppDomain。旧的应用程序域是“drain stop”的，即允许现有请求完成执行，一旦它们全部完成，AppDomain 就可以卸载。新的 AppDomain 以新代码开始并开始接受所有新请求。

通常，当 dll 加载到进程中时，进程会锁定 dll，您无法覆盖磁盘上的文件。但是，AppDomains 有一个称为 Shadow Copy 的功能，它允许程序集在磁盘上保持解锁和可替换状态。

运行时初始化 ASP.NET，并为 bin 目录启用卷影复制。AppDomain 会将它需要的任何 dll 从 bin 目录复制到一个临时位置，然后再将 dll 锁定并加载到内存中。Shadow Copy 允许我们在更新期间覆盖 bin 目录中的任何 dll，而无需使 Web 应用程序脱机。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T16:44:30.197

除了 Gulzar 的回答：

如果您的服务只是直接引用 DLL，您需要重新设计服务以利用 AppDomains 和 ShadowCopy 功能来利用此功能。

我们做这样的事情，服务只是一个外壳/主机进程。所有功能都在需要时加载到单独的应用程序域中。

[http://blogs.msdn.com/junfeng/archive/2004/02/09/69919.aspx](http://blogs.msdn.com/junfeng/archive/2004/02/09/69919.aspx)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-10-22T17:04:44.180

当进程加载了 dll 后，就无法更改它。

IIS 在不使用时不会将 DLL 加载到内存中（[受 Cache 属性影响](http://blogs.msdn.com/david.wang/archive/2006/01/29/HOWTO-Replace-an-ISAPI-DLL-on-a-Live-Server.aspx)），我假设 ASP.NET 也是如此。如果您遵循相同的策略，您也可以更新您的 dll。

但是，如果正在使用您的 dll，您应该有办法告诉您的服务器进程卸载所有 dll。

为此，服务器进程必须使用 LoadLibrary 调用加载所有 DLLS，以便在收到要求它这样做的通信时卸载它们。

与服务器进程的通信可以通过创建一个全局可用的命名事件来完成，新程序可以访问该事件并用于向正在运行的进程发出更新即将发生的信号。（您也可以考虑这样做的其他变体）。

# .net - .NET SOAP 扩展在 MethodInfo 中抛出 NullReferenceException？

> ID：226587
> 
> 赞同：2
> 
> 时间：2008-10-22T16:31:49.910
> 
> 标签：.net, web-services, exception, soap-extension

**注意：**使用 .NET 2.0 和 VS2005 作为 IDE

大家好，

我正在将 web 服务调用记录到我们的数据库中，最后使用从另一个项目移植过来的非常精简的实现来配置和运行 SoapExtension。我已经在配置文件中设置了它，因此它将适用于所有方法。当我调用我的 web 服务，soap 扩展触发时，当 SoapServerMessage 尝试调用其 MethodInfo 属性时会抛出 NullPointerException：

```
System.Web.Services.Protocols.SoapException: There was an exception running the extensions specified in the config file. 
---> System.NullReferenceException: Object reference not set to an instance of an object.
at System.Web.Services.Protocols.SoapServerProtocol.get_MethodInfo()
at System.Web.Services.Protocols.SoapServerMessage.get_MethodInfo()
at MyService.SOAPLoggingExtension.LogInput(SoapMessage message)
at MyService.SOAPLoggingExtension.ProcessMessage(SoapMessage message) 
at System.Web.Services.Protocols.SoapMessage.RunExtensions(SoapExtension[] extensions, Boolean throwOnException)
at System.Web.Services.Protocols.SoapServerProtocol.Initialize()
--- End of inner exception stack trace ---
at System.Web.Services.Protocols.SoapServerProtocol.Initialize()
at System.Web.Services.Protocols.ServerProtocolFactory.Create(Type type, HttpContext context, HttpRequest request, HttpResponse response, Boolean& abortProcessing) 
```

在 ProcessMessage(SoapMessage) 的 BeforeDeserialize 阶段调用 LogInput 方法：

```
SoapMessageStage.BeforeDeserialize:
   CopyStream(_oldStream, _newStream);
   _newStream.Position = 0;

   if(_enabled)
      LogInput(message);
   break; 
```

当尝试访问它尝试记录的消息对象的 MethodInfo 属性时，LogInput 方法失败。这是调用该属性的代码块：

```
entry = new MyServerLogEntry();
entry.ServerURL = message.Url;
entry.Method = (message.MethodInfo == null) ? null : message.MethodInfo.Name; 
```

当 message.MethodInfo 被调用时，它会冒泡到 SoapServerProtocol.get_MethodInfo()，并且在那里抛出空引用异常。我用谷歌搜索，并在 Stack Overflow 上进行了检查，但无法找出 MethodInfo 属性会引发异常的原因。

有谁知道如何确保在 Web 服务调用期间正确初始化此 MethodInfo 属性？

**附加详细信息：**如果我不尝试访问 MethodInfo 属性，则扩展程序可以正常工作并记录到我的数据库中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T17:36:07.177

经过一些试验和错误，我已经能够解决这个问题。虽然我不完全理解为什么，SoapMessage 对象在 BeforeDeserialize 阶段没有完全初始化。在此阶段，Action 和 MethodInfo 属性都会引发错误。

但是，在 AfterSerialize 阶段，这些对象似乎已正确初始化。通过将读取消息名称的行移到后面的阶段，可以正确填充日志条目对象而不会引发异常。

看来正确的顺序是：

1.  反序列化之前

    一种。读取服务器 URL

    湾。检索请求信息（证书、用户主机地址等）

    C。从流中读取请求内容

2.  序列化后

    一种。读取异常

    湾。读取 MethodInfo 信息（如有必要，还可以读取 Action 信息）

    C。从流中读取响应内容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T17:54:08.747

根据 MSDN，方法信息仅在 AfterDeserialization 和 BeforeSerialization 期间可用。所以这将是问题的一部分。

# arrays - PowerShell 数组初始化

> ID：226596
> 
> 赞同：80
> 
> 时间：2008-10-22T16:34:37.783
> 
> 标签：arrays, powershell

在 PowerShell 中初始化数组的最佳方法是什么？

例如，代码

```
$array = @()
for($i=0; $i -lt 5;$i++)
{
    $array[$i] = $FALSE
} 
```

产生错误

```
Array assignment failed because index '0' was out of range.
At H:\Software\PowerShell\TestArray.ps1:4 char:10
+         $array[$ <<<< i] = $FALSE 
```

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2008-10-24T15:40:20.080

这里还有两种方式，都非常简洁。

```
$arr1 = @(0) * 20
$arr2 = ,0 * 20 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2008-10-22T18:14:22.027

如果您希望创建类型化数组，还可以依赖**构造函数的默认值：**

```
> $a = new-object bool[] 5
> $a
False
False
False
False
False 
```

**bool**的默认值显然是**false**，因此这适用于您的情况。同样，如果您创建一个类型化的**int[]**数组，您将获得默认值 0。

我用来初始化数组的另一种很酷的方法是使用以下速记：

```
> $a = ($false, $false, $false, $false, $false)
> $a
False
False
False
False
False 
```

或者，如果您想初始化一个范围，我有时会发现这很有用：

```
> $a = (1..5)   
> $一个
1
2
3
4
5

```

希望这有点帮助！

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2008-10-22T16:46:49.240

还有另一种选择：

```
for ($i = 0; $i -lt 5; $i++) 
{ 
  $arr += @($false) 
} 
```

如果 $arr 尚未定义，则此方法有效。

**注意**- 有更好（和更高性能）的方法可以做到这一点......请参阅下面的[https://stackoverflow.com/a/234060/4570](https://stackoverflow.com/a/234060/4570)作为示例。

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2015-01-18T21:55:54.160

原始示例返回错误，因为数组创建为空，然后您尝试访问第 n 个元素为其分配值。

这里有很多创造性的答案，很多我在阅读这篇文章之前都不知道。对于小型阵列来说，一切都很好，但正如 n0rd 指出的那样，性能存在显着差异。

在这里，我使用 Measure-Command 来找出每次初始化需要多长时间。正如您可能猜到的那样，任何使用显式 PowerShell 循环的方法都比使用 .Net 构造函数或 PowerShell 运算符（将在 IL 或本机代码中编译）的方法慢。

## 概括

*   `New-Object`并且`@(somevalue)*n`速度很快（100k 个元素大约 20k 滴答声）。
*   使用范围运算符创建数组`n..m`要慢 10 倍（200k 滴答声）。
*   将 ArrayList 与该方法一起使用比基线（20M 滴答声）慢 1000 倍，就像使用or （又名, ）`Add()`循环通过已经大小的数组一样。 `for()``ForEach-Object``foreach``%`
*   附加`+=`是最糟糕的（仅 1000 个元素的 2M 滴答声）。

总的来说，我会说***array* * *n***是“最好的”，因为：

*   它很快。
*   您可以使用任何值，而不仅仅是类型的默认值。
*   您可以创建重复值（为了说明，请在 powershell 提示符下键入：`(1..10)*10 -join " "`或`('one',2,3)*3`）
*   简洁的语法。

唯一的缺点：

*   不明显。如果你以前没有见过这个结构，那么它的作用就不清楚了。

但请记住，对于许多您希望将数组元素初始化为某个值的情况，强类型数组正是您所需要的。如果您将所有内容初始化为`$false`，那么该数组是否会保存除`$false`or以外的任何内容`$true`？如果没有，那么`New-Object type[] n`就是“最好”的方法。

## 测试

创建一个默认数组并确定其大小，然后赋值：

```
PS> Measure-Command -Expression {$a = new-object object[] 100000} | Format-List -Property "Ticks"
Ticks : 20039

PS> Measure-Command -Expression {for($i=0; $i -lt $a.Length;$i++) {$a[$i] = $false}} | Format-List -Property "Ticks"
Ticks : 28866028 
```

创建布尔数组比对象数组慢一点：

```
PS> Measure-Command -Expression {$a = New-Object bool[] 100000} | Format-List -Property "Ticks"
Ticks : 130968 
```

这并不明显，New-Object 的文档只是说第二个参数是传递给 .Net 对象构造函数的参数列表。在数组的情况下，参数显然是所需的大小。

附加 +=

```
PS> $a=@()
PS> Measure-Command -Expression { for ($i=0; $i -lt 100000; $i++) {$a+=$false} } | Format-List -Property "Ticks" 
```

我厌倦了等待它完成，所以 ctrl+c 然后：

```
PS> $a=@()
PS> Measure-Command -Expression { for ($i=0; $i -lt    100; $i++) {$a+=$false} } | Format-List -Property "Ticks"
Ticks : 147663
PS> $a=@()
PS> Measure-Command -Expression { for ($i=0; $i -lt   1000; $i++) {$a+=$false} } | Format-List -Property "Ticks"
Ticks : 2194398 
```

正如 (6 * 3) 在概念上类似于 (6 + 6 + 6)，所以 ($somearray * 3) 应该给出与 ($somearray + $somearray + $somearray) 相同的结果。但是对于数组，+ 是连​​接而不是加法。

如果 $array+=$element 很慢，您可能会认为 $array*$n 也会很慢，但事实并非如此：

```
PS> Measure-Command -Expression { $a = @($false) * 100000 } | Format-List -Property "Ticks"
Ticks : 20131 
```

就像Java有一个StringBuilder类来避免在追加时创建多个对象一样，PowerShell似乎有一个ArrayList。

```
PS> $al = New-Object System.Collections.ArrayList
PS> Measure-Command -Expression { for($i=0; $i -lt 1000; $i++) {$al.Add($false)} } | Format-List -Property "Ticks"
Ticks : 447133
PS> $al = New-Object System.Collections.ArrayList
PS> Measure-Command -Expression { for($i=0; $i -lt 10000; $i++) {$al.Add($false)} } | Format-List -Property "Ticks"
Ticks : 2097498
PS> $al = New-Object System.Collections.ArrayList
PS> Measure-Command -Expression { for($i=0; $i -lt 100000; $i++) {$al.Add($false)} } | Format-List -Property "Ticks"
Ticks : 19866894 
```

范围运算符和`Where-Object`循环：

```
PS> Measure-Command -Expression { $a = 1..100000 } | Format-List -Property "Ticks"
Ticks : 239863
Measure-Command -Expression { $a | % {$false} } | Format-List -Property "Ticks"
Ticks : 102298091 
```

笔记：

*   我在每次运行 ( `$a=$null`) 之间清空了变量。
*   测试是在带有 Atom 处理器的平板电脑上进行的；您可能会在其他机器上看到更快的速度。[编辑：在台式机上大约快两倍。]
*   当我尝试多次运行时，会有相当多的变化。寻找数量级而不是确切的数字。
*   在 Windows 8 中使用 PowerShell 3.0 进行测试。

## 致谢

感谢@halr9000 for array*n，@Scott Saad 和 Lee Desmond for New-Object，以及 @EBGreen for ArrayList。

感谢@n0rd 让我思考性能。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-23T15:30:30.190

```
$array = 1..5 | foreach { $false } 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-10-22T16:48:28.473

```
$array = @()
for($i=0; $i -lt 5; $i++)
{
    $array += $i
} 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2016-01-25T14:43:16.990

这是另一个想法。您必须记住，它下面是 .NET：

```
$arr = [System.Array]::CreateInstance([System.Object], 5)
$arr.GetType()
$arr.Length

$arr = [Object[]]::new(5)
$arr.GetType()
$arr.Length 
```

结果：

```
IsPublic IsSerial Name                                     BaseType                                                                                               
-------- -------- ----                                     --------                                                                                               
True     True     Object[]                                 System.Array                                                                                           
5
True     True     Object[]                                 System.Array                                                                                           
5 
```

Using`new()`有一个明显的优势：当您在 ISE 中编程并想要创建一个对象时，ISE 会为您提供所有参数组合及其类型的提示。你没有那个`New-Object`，你必须记住参数的类型和顺序。

[![ISE IntelliSense 用于新对象](https://i.stack.imgur.com/QEUCF.jpg)](https://i.stack.imgur.com/QEUCF.jpg)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-22T16:36:53.910

我找到的解决方案是使用 New-Object cmdlet 来初始化适当大小的数组。

```
$array = new-object object[] 5 
for($i=0; $i -lt $array.Length;$i++)
{
    $array[$i] = $FALSE
} 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-10-22T16:43:52.053

如果我不知道前面的大小，我使用数组列表而不是数组。

```
$al = New-Object System.Collections.ArrayList
for($i=0; $i -lt 5; $i++)
{
    $al.Add($i)
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-10-11T14:27:54.497

这是另一种典型的方式：

```
$array = for($i = 0; $i -le 4; $i++) { $false } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-10-23T22:03:04.600

或者试试这个想法。适用于 powershell 5.0+。

```
[bool[]]$tf=((,$False)*5) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-09-14T13:55:33.443

```
$array = foreach($i in 1..5) { $false } 
```

# c# - 在 C# 中将 XML 反序列化为对象

> ID：226599
> 
> 赞同：54
> 
> 时间：2008-10-22T16:36:02.490
> 
> 标签：c#, .net, serialization

所以我有看起来像这样的xml：

```
<todo-list>
  <id type="integer">#{id}</id>
  <name>#{name}</name>
  <description>#{description}</description>
  <project-id type="integer">#{project_id}</project-id>
  <milestone-id type="integer">#{milestone_id}</milestone-id>
  <position type="integer">#{position}</position>

  <!-- if user can see private lists -->
  <private type="boolean">#{private}</private>

  <!-- if the account supports time tracking -->
  <tracked type="boolean">#{tracked}</tracked>

  <!-- if todo-items are included in the response -->
  <todo-items type="array">
    <todo-item>
      ...
    </todo-item>
    <todo-item>
      ...
    </todo-item>
    ...
  </todo-items>
</todo-list> 
```

我将如何使用 .NET 的序列化库将其反序列化为 C# 对象？

目前我正在使用反射，并使用命名约定在 xml 和我的对象之间进行映射。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-10-22T16:42:35.053

为每个元素创建一个类，为每个元素创建一个属性，为每个子元素创建一个对象列表或数组（使用创建的对象）。然后在字符串上调用 System.Xml.Serialization.XmlSerializer.Deserialize 并将结果转换为您的对象。使用 System.Xml.Serialization 属性进行调整，例如将元素映射到您的 ToDoList 类，使用 XmlElement("todo-list") 属性。

一个快捷方式是将您的 XML 加载到 Visual Studio 中，单击“推断架构”按钮并运行“xsd.exe /c schema.xsd”以生成类。xsd.exe 位于工具文件夹中。然后检查生成的代码并进行调整，例如在适当的情况下将 short 更改为 int。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-10-22T16:38:52.783

归结为使用 VS 中的工具中的 xsd.exe：

```
xsd.exe "%xsdFile%" /c /out:"%outDirectory%" /l:"%language%" 
```

然后用阅读器和反序列化器加载它：

```
public GeneratedClassFromXSD GetObjectFromXML()
{
    var settings = new XmlReaderSettings();
    var obj = new GeneratedClassFromXSD();
    var reader = XmlReader.Create(urlToService, settings);
    var serializer = new System.Xml.Serialization.XmlSerializer(typeof(GeneratedClassFromXSD));
    obj = (GeneratedClassFromXSD)serializer.Deserialize(reader);

    reader.Close();
    return obj;
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-09-23T21:19:07.500

反序列化任何对象，只要类型`T`被标记为 Serializable：

```
function T Deserialize<T>(string serializedResults)
{
    var serializer = new XmlSerializer(typeof(T));
    using (var stringReader = new StringReader(serializedResults))
        return (T)serializer.Deserialize(stringReader);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-22T16:42:18.000

好吧，您的程序集中必须有大致匹配 XML 的类（称为 Private 的属性，称为 ToDo 的集合属性等）。

问题是**XML 中的元素对类名无效**。因此，您必须在这些类中实现 IXmlSerializable 来控制它们如何与 XML 进行序列化。您可能也可以使用一些 xml 序列化特定属性，但这取决于您的 xml 架构。

这是使用反射的一个步骤，但它可能不是您所希望的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-04-15T23:35:26.327

结帐[http://xsd2code.codeplex.com/](http://xsd2code.codeplex.com/)

Xsd2Code 是来自 XSD 架构的 CSharp 或 Visual Basic 业务实体类生成器。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-22T16:39:55.103

有几个不同的选择。

*   Visual Studio 包含一个名为 xsd.exe 的命令行程序。您使用该程序来创建架构文档，并在架构文档上再次使用该程序来创建您可以使用的类`system.xml.serialization.xmlserializer`
*   您可能只能在其上调用 Dataset.ReadXml() 。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-09-24T10:49:46.560

几年前我有同样的问题，即如何将 xml 映射到 C# 类或创建映射到我们的 XML 的 C# 类，就像我们在实体框架中所做的一样（我们将表映射到 C# 类）。我最终创建了一个框架，它可以从您的 XML 中创建 C# 类，这些类可用于读取/写入您的 xml。[看看](http://www.stepupframeworks.com/Home/products/xml-object-mapping-xom/)_

# sql-server - 如何在 SSIS 包中执行自动化单元测试？

> ID：226605
> 
> 赞同：25
> 
> 时间：2008-10-22T16:37:29.773
> 
> 标签：sql-server, unit-testing, ssis

如何对 SSIS 包进行单元测试？我希望能够为各种组件创建和维护单元测试，例如工作流任务、数据流任务、事件处理程序等。

是否有任何现有的技术、框架和/或工具可以使用？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-22T17:15:46.157

> [单位](http://www.codeplex.com/ssisUnit)

SQL Server 集成服务的单元测试框架

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-09T14:43:59.780

如今，ssisUnit 不是最新的，并且存在用于 SQL Server 集成服务的现代单元测试框架，称为 SSISTester。

[MSDN 文章](http://msdn.microsoft.com/en-us/magazine/dn342874.aspx)

[努吉特](http://www.nuget.org/packages/SSISTester/2.1.0-b168)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-07T14:47:06.223

我在测试 SSIS 包时通常遵循的一些测试实践。

我总是在包级别进行测试（在比这更低的级别进行测试对我来说通常没有多大意义......）

我通常使用非常小的数据集来保持测试数据环境。

还有一个测试配置文件（配置文件）指向测试数据集和任何其他不同的测试参数。

根据项目的性质，有时我还会保留一些数据库备份，以便在我们想要重置环境初始状态（或 ETL 过程中的任何其他状态）时恢复。

所有这些都结合在一组很好的测试脚本（python，powershell ...）中，通过 dtexec 调用包，这对我来说是一个非常有用的秘诀;-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-05T09:00:49.187

[ssisUnitLearning](https://github.com/BartekR/ssisUnitLearning)是 SSIS 测试员

SSIS项目学习SSIS-单元测试

有关更多信息，请访问 bartekr 的“ssisUnit 测试”[系列](http://blog.bartekr.net/series/)

# sql-server-2005 - 您可以在 SSRS 报告中引用 appSettings 吗？

> ID：226607
> 
> 赞同：2
> 
> 时间：2008-10-22T16:37:42.723
> 
> 标签：sql-server-2005, reporting-services

使用 SSRS2005，您可以提取 SSRS Web.Config 文件中指定的值（想想 appSettings）吗？我需要在一系列报告中建立一个动态超链接，并希望它基于配置文件中设置的值。

目前，似乎我唯一的选择是：

1.  更新正在构建链接的每个报告中的硬编码变量*blech*
2.  将值存储在专用配置表中，然后查询

我可以接受上面的#2，但希望避免创建另一个表来存储这些信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T19:10:20.200

我不相信有一种*开箱即用的*方式可以从报告中访问文件。这里有一些其他选项可以添加到您的列表中：

1.  创建一个[自定义程序集]（[http://msdn.microsoft.com/en-us/library/ms153561(SQL.90).aspx）](http://msdn.microsoft.com/en-us/library/ms153561(SQL.90).aspx))，该程序集具有值或在某些配置文件（即xml文件）中查找它们. 沿着这条路走下去可能会打开您需要修改 [安全设置]( [http://msdn.microsoft.com/en-us/library/ms155108(SQL.90).aspx)](http://msdn.microsoft.com/en-us/library/ms155108(SQL.90).aspx))的区域。
2.  为了构建您的配置表想法......我们最终不得不做的一件事是创建一个相当通用的表，该表表示 .NET 配置文件的**appSettings**格式。**appSettings**只不过是一个名称/值对。作为一个表，这几乎可以转换为两个字段（名称、值）。然后，我们使用此表来保存各种基于配置的选项，否则这些选项将属于配置文件的**appSettings**部分。

我希望这能提供一些帮助。祝你好运！

# java - 如何在 Java 中将时间值转换为 YYYY-MM-DD 格式？

> ID：226618
> 
> 赞同：10
> 
> 时间：2008-10-22T16:39:11.783
> 
> 标签：java, time

如何在 Java 中将时间值转换为 YYYY-MM-DD 格式？

```
long lastmodified = file.lastModified();
String lasmod =  /*TODO: Transform it to this format YYYY-MM-DD*/ 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-22T16:45:28.947

就像是：

```
Date lm = new Date(lastmodified);
String lasmod = new SimpleDateFormat("yyyy-MM-dd").format(lm); 
```

请参阅[SimpleDateFormat](http://java.sun.com/javase/6/docs/api/java/text/SimpleDateFormat.html)的 javadoc 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T16:47:19.753

```
final Date modDate = new Date(lastmodified);
final SimpleDateFormat f = new SimpleDateFormat("yyyy-MM-dd");
final String lasmod = f.format(modDate); 
```

[简单日期格式](http://java.sun.com/javase/6/docs/api/java/text/SimpleDateFormat.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-22T16:46:55.217

```
String lasmod = new SimpleDateFormat("yyyy-MM-dd").format(new Date(lastmodified)); 
```

查找您想要的 SimpleDateFormat 的正确模式...我可能从记忆中包含了错误的模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T16:47:00.160

```
Date d = new Date(lastmodified);
DateFormat form = new SimpleDateFormat("yyyy-MM-dd");
String lasmod = form.format(d); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T16:49:46.973

尝试：

```
import java.text.SimpleDateFormat;
import java.util.Date;

long lastmodified = file.lastModified();
SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd");
String lastmod =  format.format(new Date(lastmodified)); 
```

# javascript - 可能来自暴露链接的 javascript 漏洞？

> ID：226637
> 
> 赞同：1
> 
> 时间：2008-10-22T16:45:05.780
> 
> 标签：javascript, exploit

在网站（我们的一个）的页面上，我可以在 url 中输入以下代码：

```
javascript:createNewWindow('Something', 100, 100, 'Text') 
```

有没有办法有人可以利用这个？

```
function createNewWindow(url, widthIn, heightIn, title) 
        {
            var strOptions='toolbar=0,location=0,directories=0,status=1,menubar=0,scrollbars=1,resizable=1,width=' + widthIn + ',height=' + heightIn;
            var newWin = open( url,title,strOptions ); 
            newWin.focus();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T17:59:38.063

函数 createNewWindow() 具有与 window.open() 完全相同的漏洞。您可能不需要担心这一点。

如果您对添加代码的评论意味着您能够提交

```
javascript:createNewWindow('Something', 100, 100, 'Text') 
```

在表单输入（或作为查询字符串参数）中并将其显示在呈现的 HTML 中，那么您的应用程序确实很容易受到多种类型的攻击，但不是由于 createNewWindow() 函数。在这种情况下，问题将是从浏览器呈现未经检查的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T17:58:42.357

鉴于该代码，createNewWindow() 脚本并不比原始 javascript 更容易受到攻击。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-01T04:25:18.830

这本身并不是不安全的，您需要注意应用程序的其他部分以防止漏洞利用。确保验证来自浏览器、您的数据库、外部服务以及您无法控制的任何其他信息的所有信息。

了解跨站点脚本（又名 XSS 或 CSS）将帮助您了解该代码的风险。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-29T17:23:55.513

一般来说，在您的网站上运行的 javascript 并不是漏洞的来源。您应该担心应用程序的服务器端。

然而！您可以使用 javascript 将漏洞引入您的站点。它称为[基于 DOM 的 XSS](http://www.owasp.org/index.php/DOM_Based_XSS)。您发布的代码不易受到基于 DOM 的 XSS 的攻击。

# tfs - 在 TFS 中共享标签？

> ID：226643
> 
> 赞同：2
> 
> 时间：2008-10-22T16:46:07.043
> 
> 标签：tfs, label

如果我在 TFS 中创建了一个标签，并将其分配给多个文件，我的同事将无法将文件的版本（也不能添加其他文件）更改为该标签。我们得到这个错误：

```
TF14077: The owner of a label cannot be changed. 
```

研究这个问题，我发现[了这篇文章](http://tinyurl.com/6zuw9e)，其中指出：

> 可能允许用户操作开发文件夹中的**共享标签** ，但只能操作他们在生产文件夹中拥有的标签。（强调我的）

尽我所能，我找不到任何对“共享标签”的引用。据我所知，标签必须有所有者。

FWIW，我正在尝试使用“浮动”标签，以便开发人员可以通过使用特定标签标记他们的代码已准备好成为构建的一部分。然后构建过程只需要获取具有该标签的所有内容，并自动获取实际准备好构建的最新内容，忽略过去的版本以及尚未准备好迎接黄金时段的新内容。

* * *

*更新：* 我想如果我不能制作一个真正共享的标签，我至少可以给用户编辑由他们的同事创建的标签的权利。这是非常明确的支持。普通*Contributor*用户没有此权限，但根据 MSDN（参见文章*Team Foundation Server Permissions*，在*Source Control Permissions*下），可以通过*LabelOther*权限授予：

> 源代码控制权限特定于源代码文件和文件夹。您可以通过右键单击源代码管理资源管理器中的文件夹或文件，单击属性，然后在安全选项卡上，选择要更改权限的用户或组，然后编辑权限中列出的权限来设置这些权限。您可以使用 tf 命令行实用程序进行源代码控制来设置这些权限。

...

> 管理标签 | tf:**标签其他**| 拥有此权限的用户可以编辑或删除其他用户创建的标签。

因此，如上所述，我已将该权限分配给包含所有开发人员的域组。**我可以使用tf 权限**命令验证它是否已设置：

```
tf permission /group:"CORP\Web Team" 
```

结果如预期（我还分配了标签，只是为了好玩）

```
===============================================================================
Server item: $/Test1/TeamBuildTypes (Inherit: Yes)
  Identity: CORP\Web Team
    Allow:
    Deny:
    Allow (Inherited): Label, LabelOther
    Deny (Inherited): 
```

然而，我的测试用户仍然不允许编辑我创建的标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T16:50:44.240

搁置套装会是您正在做的更好的解决方案吗？IIRC 有一个相当丰富的 API 用于处理搁置集，例如将它们作为构建（或其他）过程的一部分提交。

我在使用时发现 TFS 中的标签非常有限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-22T16:55:32.277

我从来没有能够用标签来完成这项工作。相反，我们使用分支设计了一个完全不同的过程，我现在强烈推荐给任何阅读本文的人。

我们建立了一个分支方案，以便有一个通用的开发分支；从那以后，每个开发人员都有他/她自己的分支，他们可以用它做他们想做的事，还有一个生产分支。

*   开发人员在他们的私有分支中做他们“肮脏”的工作，而不用担心意外发布东西，甚至干扰他们的同事。
*   当他们准备好要集成的东西时，他们会将更改合并到开发分支中。我们在那里进行持续构建，并测试结果。
*   当集成构建经过全面测试并准备好部署时，更改将合并到生产分支。这是构建和部署的。

我说过我想要

> 我正在尝试做的是使用“浮动”标签，以便开发人员可以通过使用特定标签对其代码进行标记来表明他们的代码已准备好成为构建的一部分。

我上面概述的方案完全实现了这一点，甚至更多。

# iis - 在 Windows Server 2008 上的 IIS 7 下设置 SMTP

> ID：226655
> 
> 赞同：16
> 
> 时间：2008-10-22T16:47:52.063
> 
> 标签：iis, iis-7, smtp

网站最初是在 IIS 6 下开始的，并且该网站在那里运行良好。现在，在重新定位到运行 W2K8S 的新服务器后，除了从网站发送邮件之外的所有内容现在都可以在 IIS 7 下正常运行。

在网上进行了简短的研究，看看是否有人有好的解决方案，但无济于事......甚至在微软自己的支持网站上没有一丝希望。

以下是迄今为止在新的 W2K8S 盒子上采取的步骤：

*   在服务器管理器下添加了 SMTP 功能
*   在 IIS 7 管理器中为站点本身启用 SMTP 电子邮件以将电子邮件传递到 SMTP 服务器本地主机，但不成功
*   为 IIS 7 管理器中的根站点启用 SMTP 电子邮件（不确定是否需要启用站点）以将电子邮件传递到 SMTP 服务器本地主机，不成功

在这些基本设置失败后，我想确保我实际上可以在端口 25 上与服务器通信。并且我可以成功地从/到有问题的服务器远程登录到端口 25 上的测试电子邮件获得 HELO 等。所以我不认为这是防火墙配置问题。

IIS 7 设置测试是通过匿名和 Windows 身份验证执行的——无论哪种方式都没有运气。

手动检查 Web Config 文件，它反映了服务器使用 localhost 的正确条目。

阅读手册，也没有运气...... :-/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-13T08:16:47.180

我遇到了同样的问题。

我遇到了这个链接[http://www.frontpagewebmaster.com/m-215289/tm.htm](https://web.archive.org/web/20120215194747/http://www.frontpagewebmaster.com/m-215289/tm.htm)

我能够解决这个问题。转到此链接的最后一篇文章。

就我而言，我通过授予“网络服务”用户对“皮卡”文件夹的权限来解决问题。

希望这可能会有所帮助....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T16:55:06.340

我遇到了与这个旧问题中描述的完全相同的问题。最后我找到了解决办法。就我而言，操作系统是带有 IIS 7.5 的 W2008 R2，但我认为这无关紧要。

根本问题是 W2008 R2 中的 SMTP 服务似乎是 IIS 的遗留部分。它与 IIS 6.0 管理工具一起安装，与 IIS 7.X 服务器并排安装。这会导致两个衍生问题：

IIS 7.X 对 SMTP 服务一无所知。如果在 ASP.NET 中将 SMTP 配置为使用 PickupDirectoryFromIis，则会导致异常。**因此，您不能使用此 SMTP 配置**：

```
<smtp deliveryMethod="PickupDirectoryFromIis" /> 
```

但是可以使用 SpecifiedPickupDirectory 配置 SMTP，**您可以使用此配置**：

```
<smtp deliveryMethod="SpecifiedPickupDirectory">
    <specifiedPickupDirectory pickupDirectoryLocation="C:\inetpub\mailroot\Pickup"  />
</smtp> 
```

如果以这种方式配置拾取目录，可能会遇到第二种问题：IIS6 和 IIS7.X 的安全系统不同。IIS 7.X 引入了具有应用程序池标识的集成安全性。IIS 6.0 及其 SMTP 服务不知道这一点。因此，您必须将 IIS_IUSRS 的写入权限授予拾取文件夹。在我的配置中，拾取文件夹是 C:\inetpub\mailroot\pickup。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-24T03:58:44.350

好的，对于说*“授予网络用户对拾取文件夹的写入权限”*的帖子，它终于起作用了。我所做的是：

1.  除非您正在运行 Exchange 服务器，否则您需要使用*“智能主机” 。*我使用的是 Gmail 帐户，Gmail 允许 SMTP 转发。

2.  您可以在 SMTP 服务器和 IIS7 配置设置上使用 Windows 身份验证来确保安全。

3.  第一步，在您的网页中设置传送方式= *“网络” ，并让您的智能主机独立于 SMTP 服务器进行配置。*

    ```
    SmtpClient client = new SmtpClient("smtp.gmail.com", 587);
    client.DeliveryMethod = SmtpDeliveryMethod.Network;
    client.UseDefaultCredentials = false; // use your smart host login client.Credentials = new NetworkCredential("xxxxx@gmail.com", "password");
    client.EnableSsl = true; 
    ```

    这将直接发送电子邮件并绕过您的 SMTP 服务器。

4.  第二步，一旦你有了这个工作，编写一个示例 Windows 应用程序来使用独立于你的网页的 SMTP 服务器，并让它工作。

    ```
    SmtpClient client = new SmtpClient("your server ip", 25);
    client.DeliveryMethod = SmtpDeliveryMethod.PickupDirectoryFromIis;
    client.EnableSsl = false; // you can't use ssl with a pickup folder
    client.UseDefaultCredentials = true; // use windows credentials 
    ```

    这将绕过您的网页并确保您的 SMTP 服务器配置正确。

5.  最后，通过在您的拾取文件夹上设置共享以允许对`NETWORK_SERVICE`. 将步骤 3 中的登录信息传输到您的 SMTP 设置中，将身份验证设置为集成安全，然后将步骤 4 中的代码用于您的网页。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T11:52:16.490

我注意到事件 ID 4006 是指域控制器 ip 而不是邮件服务器 ip。我使用 iis 6 管理工具配置了一个指向邮件服务器的智能主机，瞧！问题已解决。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-13T17:03:22.440

I came across this post when researching getting SMTP running on my ASP.Net app we're migrating from IIS6 to IIS7\. What I found was we didn't have to set up the SMTP SERVER at all - simply setting up SMTP Email was enough - with the additional benefit of NOT having the security concerns of SMTP relaying thru the web server!

so if you don't need your web server to actually do the SMTP routing, you don't have to set up the server at all in IIS7.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-14T04:19:42.797

这是一个偶然的依靠 CDONTS 发送邮件的旧“经典” ASP 应用程序吗？

如果是这样，也许[这些链接](http://www.google.com/search?hl=en&q=windows+2008+cdonts&sourceid=navclient-ff&rlz=1B3GGGL_enUS312US313&ie=UTF-8)之一会有所帮助？

*编辑：我在注意到原始帖子上的注释之前已经回复了。漠视...*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-26T02:49:07.910

我不确定这个诊断工具是否可以提供更多的见解，

[http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1308](http://www.iis.net/downloads/default.aspx?tabid=34&g=6&i=1308)

此工具适用于 x86。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-31T00:50:15.647

您是否检查过 SMTP 服务是否正在接受来自本地主机的中继邮件？为此，请从相关机器 telnet 到本地 SMTP 服务器，并使用 SMTP 命令发送测试消息。SMTP 服务对命令格式非常挑剔，因此您在输入命令时必须小心（即不要使用退格键来纠正印刷错误）。

# jquery - 使用 jQuery 解析 RSS

> ID：226663
> 
> 赞同：195
> 
> 时间：2008-10-22T16:49:58.017
> 
> 标签：jquery, jquery-plugins, rss, feedparser

我想使用 jQuery 来解析 RSS 提要。这可以通过开箱即用的基本 jQuery 库来完成，还是我需要使用插件？

* * *

## 回答 #1

> 赞同：208
> 
> 时间：2011-06-07T21:34:48.400

**警告**

> [Google Feed API](https://developers.google.com/feed/)已正式**弃用**，**不再有效**！

* * *

不需要整个插件。这会将您的 RSS 作为 JSON 对象返回给回调函数：

```
function parseRSS(url, callback) {
  $.ajax({
    url: document.location.protocol + '//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q=' + encodeURIComponent(url),
    dataType: 'json',
    success: function(data) {
      callback(data.responseData.feed);
    }
  });
} 
```

* * *

## 回答 #2

> 赞同：185
> 
> 时间：2008-10-22T16:56:27.037

[使用 jFeed](https://github.com/jfhovinne/jFeed) - 一个 jQuery RSS/Atom 插件。根据文档，它很简单：

```
jQuery.getFeed({
   url: 'rss.xml',
   success: function(feed) {
      alert(feed.title);
   }
}); 
```

* * *

## 回答 #3

> 赞同：160
> 
> 时间：2011-08-15T16:18:05.067

对于我们这些迟来的讨论者，从 1.5 开始，jQuery 具有内置的 xml 解析功能，这使得在没有插件或 3rd 方服务的情况下很容易做到这一点。它有一个 parseXml 函数，并且在使用 $.get 函数时也会自动解析 xml。例如：

```
$.get(rssurl, function(data) {
    var $xml = $(data);
    $xml.find("item").each(function() {
        var $this = $(this),
            item = {
                title: $this.find("title").text(),
                link: $this.find("link").text(),
                description: $this.find("description").text(),
                pubDate: $this.find("pubDate").text(),
                author: $this.find("author").text()
        }
        //Do something with item here...
    });
}); 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2010-06-12T20:21:47.643

jFeed 在 IE 中不起作用。

使用[zRSSFeed](http://www.zazar.net/developers/zrssfeed/)。让它在 5 分钟内工作

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2011-10-26T12:11:11.947

> **更新（2019 年 10 月 15 日）**

我将核心逻辑从 jquery-rss 提取到一个名为[Vanilla RSS](https://github.com/sdepold/vanilla-rss)的新库中，该库使用 fetch API 并且可以在没有任何额外依赖项的情况下工作：

```
const RSS = require('vanilla-rss');
const rss = new RSS(
    document.querySelector("#your-div"),
    "http://www.recruiter.com/feed/career.xml",
    { 
      // options go here
    }
);
rss.render().then(() => {
  console.log('Everything is loaded and rendered');
}); 
```

> 原来的

邮政：

您还可以使用[jquery-rss](https://github.com/sdepold/jquery-rss)，它带有漂亮的模板并且非常易于使用：

```
$("#your-div").rss("http://www.recruiter.com/feed/career.xml", {
    limit: 3,
    layoutTemplate: '<ul class="inline">{entries}</ul>',
    entryTemplate: '<li><a href="{url}">[{author}@{date}] {title}</a><br/>{shortBodyPlain}</li>'
}) 
```

收益率（截至 2013 年 9 月 18 日）：

```
<div id="your-div">
    <ul class="inline">
    <entries></entries>
    </ul>
    <ul class="inline">
        <li><a href="http://www.recruiter.com/i/when-to-go-over-a-recruiter%e2%80%99s-head/">[@Tue, 10 Sep 2013 22:23:51 -0700] When to Go Over a Recruiter's Head</a><br>Job seekers tend to have a certain "fear" of recruiters and hiring managers, and I mean fear in the reverence and respect ...</li>
        <li><a href="http://www.recruiter.com/i/the-perfect-job/">[@Tue, 10 Sep 2013 14:52:40 -0700] The Perfect Job</a><br>Having long ago dealt with the "perfect resume" namely God's, in a previous article of mine, it makes sense to consider the ...</li>
        <li><a href="http://www.recruiter.com/i/unemployment-benefits-applications-remain-near-5-year-low-decline-again/">[@Mon, 09 Sep 2013 12:49:17 -0700] Unemployment Benefits Applications Remain Near 5-Year Low, Decline Again</a><br>As reported by the U.S. Department of Labor, the number of workers seeking unemployment benefits continued to sit near ...</li>
    </ul>
</div> 
```

有关工作示例，请参阅[http://jsfiddle.net/sdepold/ozq2dn9e/1/ 。](http://jsfiddle.net/sdepold/ozq2dn9e/1/)

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2008-10-22T17:43:11.747

[使用 JFeed](http://plugins.jquery.com/project/jFeed)

```
function getFeed(sender, uri) {
    jQuery.getFeed({
        url: 'proxy.php?url=' + uri,
        success: function(feed) {
            jQuery(sender).append('<h2>'
            + '<a href="'
            + feed.link
            + '">'
            + feed.title
            + '</a>'
            + '</h2>');

            var html = '';

            for(var i = 0; i < feed.items.length && i < 5; i++) {

                var item = feed.items[i];

                html += '<h3>'
                + '<a href="'
                + item.link
                + '">'
                + item.title
                + '</a>'
                + '</h3>';

                html += '<div class="updated">'
                + item.updated
                + '</div>';

                html += '<div>'
                + item.description
                + '</div>';
            }

            jQuery(sender).append(html);
        }    
    });
}

<div id="getanewbrowser">
  <script type="text/javascript">
    getFeed($("#getanewbrowser"), 'http://feeds.feedburner.com/getanewbrowser')
  </script>
</div> 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-10-22T17:14:42.663

除非您的 RSS 数据是私有的，否则请使用 Google AJAX Feed API。当然，它很快。

[https://developers.google.com/feed/](https://developers.google.com/feed/)

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2012-12-07T22:18:13.490

> ***更新***[ *2016 年 4 月 25 日*] 现在更好的编写和完全支持的版本具有更多选项和功能，托管在[**GitHub.jQRSS**](https://github.com/JDMcKinstry/jQRSS)

我看到了Nathan [Strutz的](https://stackoverflow.com/users/5918/nathan-strutz)[*Selected* Answer](https://stackoverflow.com/questions/226663/parse-rss-with-jquery#answer-226679)，但是，jQuery 插件页面链接仍然关闭，并且该站点的主页似乎没有加载。我尝试了其他一些解决方案，发现其中大多数不仅过时，而且很**简单**！因此，我把帽子扔在那里并制作了自己的插件，并且这里有死链接，这似乎是提交答案的好地方。如果您在 2012 年（很快到 2013 年）寻找这个答案，您可能会像我一样注意到死链接和旧建议的挫败感。下面是我的*现代*插件示例的链接以及插件的代码！只需将代码复制到 JS 文件中并像任何其他插件一样将其链接到您的标题中。使用非常方便！

 ***# [jsFiddle](http://jsfiddle.net/SpYk3/Pp44S/)

> **插件代码2/9/2015 -**[在向其发送命令之前]
> [进行了早该更新的检查！`console`应该有助于解决较旧的 IE 问题。]

```
(function($) {
    if (!$.jQRSS) { 
        $.extend({  
            jQRSS: function(rss, options, func) {
                if (arguments.length <= 0) return false;

                var str, obj, fun;
                for (i=0;i<arguments.length;i++) {
                    switch(typeof arguments[i]) {
                        case "string":
                            str = arguments[i];
                            break;
                        case "object":
                            obj = arguments[i];
                            break;
                        case "function":
                            fun = arguments[i];
                            break;
                    }
                }

                if (str == null || str == "") {
                    if (!obj['rss']) return false;
                    if (obj.rss == null || obj.rss == "") return false;
                }

                var o = $.extend(true, {}, $.jQRSS.defaults);

                if (typeof obj == "object") {
                    if ($.jQRSS.methods.getObjLength(obj) > 0) {
                        o = $.extend(true, o, obj);
                    }
                }

                if (str != "" && !o.rss) o.rss = str;
                o.rss = escape(o.rss);

                var gURL = $.jQRSS.props.gURL 
                    + $.jQRSS.props.type 
                    + "?v=" + $.jQRSS.props.ver
                    + "&q=" + o.rss
                    + "&callback=" + $.jQRSS.props.callback;

                var ajaxData = {
                        num: o.count,
                        output: o.output,
                    };

                if (o.historical) ajaxData.scoring = $.jQRSS.props.scoring;
                if (o.userip != null) ajaxData.scoring = o.userip;

                $.ajax({
                    url: gURL,
                    beforeSend: function (jqXHR, settings) { if (window['console']) { console.log(new Array(30).join('-'), "REQUESTING RSS XML", new Array(30).join('-')); console.log({ ajaxData: ajaxData, ajaxRequest: settings.url, jqXHR: jqXHR, settings: settings, options: o }); console.log(new Array(80).join('-')); } },
                    dataType: o.output != "xml" ? "json" : "xml",
                    data: ajaxData,
                    type: "GET",
                    xhrFields: { withCredentials: true },
                    error: function (jqXHR, textStatus, errorThrown) { return new Array("ERROR", { jqXHR: jqXHR, textStatus: textStatus, errorThrown: errorThrown } ); },
                    success: function (data, textStatus, jqXHR) {  
                        var f = data['responseData'] ? data.responseData['feed'] ? data.responseData.feed : null : null,
                            e = data['responseData'] ? data.responseData['feed'] ? data.responseData.feed['entries'] ? data.responseData.feed.entries : null : null : null
                        if (window['console']) {
                            console.log(new Array(30).join('-'), "SUCCESS", new Array(30).join('-'));
                            console.log({ data: data, textStatus: textStatus, jqXHR: jqXHR, feed: f, entries: e });
                            console.log(new Array(70).join('-'));
                        }

                        if (fun) {
                            return fun.call(this, data['responseData'] ? data.responseData['feed'] ? data.responseData.feed : data.responseData : null);
                        }
                        else {
                            return { data: data, textStatus: textStatus, jqXHR: jqXHR, feed: f, entries: e };
                        }
                    }
                });
            }
        });
        $.jQRSS.props = {
            callback: "?",
            gURL: "http://ajax.googleapis.com/ajax/services/feed/",
            scoring: "h",
            type: "load",
            ver: "1.0"
        };
        $.jQRSS.methods = {
            getObjLength: function(obj) {
                if (typeof obj != "object") return -1;
                var objLength = 0;
                $.each(obj, function(k, v) { objLength++; })
                return objLength;
            }
        };
        $.jQRSS.defaults = {
            count: "10", // max 100, -1 defaults 100
            historical: false,
            output: "json", // json, json_xml, xml
            rss: null,  //  url OR search term like "Official Google Blog"
            userip: null
        };
    }
})(jQuery); 
```

> **采用**

```
//  Param ORDER does not matter, however, you must have a link and a callback function
//  link can be passed as "rss" in options
//  $.jQRSS(linkORsearchString, callbackFunction, { options })

$.jQRSS('someUrl.xml', function(feed) { /* do work */ })

$.jQRSS(function(feed) { /* do work */ }, 'someUrl.xml', { count: 20 })

$.jQRSS('someUrl.xml', function(feed) { /* do work */ }, { count: 20 })

$.jQRSS({ count: 20, rss: 'someLink.xml' }, function(feed) { /* do work */ }) 
```

~~$.jQRSS('Search Words Here instead of a Link', function(feed) { /* do work */ })~~ // TODO: Needs fix

> **选项**

```
{
    count: // default is 10; max is 100\. Setting to -1 defaults to 100
    historical: // default is false; a value of true instructs the system to return any additional historical entries that it might have in its cache. 
    output: // default is "json"; "json_xml" retuns json object with xmlString / "xml" returns the XML as String
    rss: // simply an alternate place to put news feed link or search terms
    userip: // as this uses Google API, I'll simply insert there comment on this:
        /*  Reference: https://developers.google.com/feed/v1/jsondevguide
            This argument supplies the IP address of the end-user on 
            whose behalf the request is being made. Google is less 
            likely to mistake requests for abuse when they include 
            userip. In choosing to utilize this parameter, please be 
            sure that you're in compliance with any local laws, 
            including any laws relating to disclosure of personal 
            information being sent.
        */
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-09-13T19:59:40.100

[我同意@Andrew 的观点](https://stackoverflow.com/a/6271906/30433)，使用 Google 是一种可靠、可重用的方法，它的巨大好处是您可以返回 JSON 而不是 XML。使用 Google 作为代理的另一个优势是，可能阻止您直接访问其数据的服务不太可能阻止 Google。这是一个使用滑雪报告和条件数据的示例。这具有所有常见的现实世界应用程序：1）第三方 RSS/XML 2）JSONP 3）当您无法完全按照您想要的方式获取数据时，将字符串和字符串清理为数组 4）在加载时将元素添加到DOM。希望这可以帮助一些人！

```
<!-- Load RSS Through Google as JSON using jQuery -->
<script type="text/javascript">

    function displaySkiReport (feedResponse) {

    // Get ski report content strings
    var itemString = feedResponse.entries[0].content;
    var publishedDate = feedResponse.entries[0].publishedDate;

    // Clean up strings manually as needed
    itemString = itemString.replace("Primary: N/A", "Early Season Conditions"); 
    publishedDate = publishedDate.substring(0,17);

    // Parse ski report data from string
    var itemsArray = itemString.split("/");

    //Build Unordered List
    var html = '<h2>' + feedResponse.entries[0].title + '</h2>';
    html += '<ul>';

    html += '<li>Skiing Status: ' + itemsArray[0] + '</li>';
    // Last 48 Hours
    html += '<li>' + itemsArray[1] + '</li>';
    // Snow condition
    html += '<li>' + itemsArray[2] + '</li>';
    // Base depth
    html += '<li>' + itemsArray[3] + '</li>';

    html += '<li>Ski Report Date: ' + publishedDate + '</li>';

    html += '</ul>';

    $('body').append(html);    

    }

    function parseRSS(url, callback) {
      $.ajax({
    url: document.location.protocol + '//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q=' + encodeURIComponent(url),
    dataType: 'json',
    success: function(data) {
      callback(data.responseData.feed);
    }
      });
    }

    $(document).ready(function() {              

        // Ski report
        parseRSS("http://www.onthesnow.com/michigan/boyne-highlands/snow.rss", displaySkiReport);

    });

</script> 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2012-02-17T12:26:02.170

```
(function(url, callback) {
    jQuery.ajax({
        url: document.location.protocol + '//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q=' + encodeURIComponent(url),
        dataType: 'json',
        success: function(data) {
            callback(data.responseData.feed);
        }
    });
})('http://news.hitb.org/rss.xml', function(feed){ // Change to desired URL
    var entries = feed.entries, feedList = '';
    for (var i = 0; i < entries.length; i++) {
        feedList +='<li><a href="' + entries[i].link + '">' + entries[i].title + '</a></li>';
    }
    jQuery('.feed > ul').append(feedList);
});

<div class="feed">
        <h4>Hacker News</h4>
        <ul></ul>
</div> 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2010-06-10T07:01:27.313

jFeed 有点过时了，只适用于旧版本的 jQuery。自更新以来已经两年了。

zRSSFeed 可能不太灵活，但它易于使用，并且可以与当前版本的 jQuery（当前为 1.4）一起使用。[http://www.zazar.net/developers/zrssfeed/](http://www.zazar.net/developers/zrssfeed/)

这是 zRSSFeed 文档中的一个简单示例：

```
<div id="test"><div>

<script type="text/javascript">
$(document).ready(function () {
  $('#test').rssfeed('http://feeds.reuters.com/reuters/oddlyEnoughNews', {
    limit: 5
  });
});
</script> 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-04-13T06:55:49.427

我正在使用带有 yql 的 jquery 作为提要。您可以使用 yql 检索 twitter、rss、buzz。我从[http://tutorialzine.com/2010/02/feed-widget-jquery-css-yql/](http://tutorialzine.com/2010/02/feed-widget-jquery-css-yql/)阅读。这对我来说非常有用。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-12-11T23:02:39.993

我建议您使用[FeedEk](http://jquery-plugins.net/FeedEk/FeedEk.html)。在 Google Feed API 正式弃用后，大多数插件都无法正常工作。但 FeedEk 仍在工作。它非常易于使用，并且有许多自定义选项。

```
$('#divRss').FeedEk({
   FeedUrl:'http://jquery-plugins.net/rss'
}); 
```

有选项

```
$('#divRss').FeedEk({
  FeedUrl:'http://jquery-plugins.net/rss',
  MaxCount : 5,
  ShowDesc : true,
  ShowPubDate:true,
  DescCharacterLimit:100,
  TitleLinkTarget:'_blank',
  DateFormat: 'MM/DD/YYYY',
  DateFormatLang:'en'
}); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-02-26T21:40:38.350

```
<script type="text/javascript" src="./js/jquery/jquery.js"></script>
<script type="text/javascript" src="./js/jFeed/build/dist/jquery.jfeed.pack.js"></script>
<script type="text/javascript">
    function loadFeed(){
        $.getFeed({
            url: 'url=http://sports.espn.go.com/espn/rss/news/',
            success: function(feed) {

                //Title
                $('#result').append('<h2><a href="' + feed.link + '">' + feed.title + '</a>' + '</h2>');

                //Unordered List
                var html = '<ul>';

                $(feed.items).each(function(){
                    var $item = $(this);

                    //trace( $item.attr("link") );
                    html += '<li>' +
                        '<h3><a href ="' + $item.attr("link") + '" target="_new">' +
                        $item.attr("title") + '</a></h3> ' +
                        '<p>' + $item.attr("description") + '</p>' +
                        // '<p>' + $item.attr("c:date") + '</p>' +
                        '</li>';
                });

                html += '</ul>';

                $('#result').append(html);
            }
        });
    }
</script> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-09-21T01:37:46.747

[zRSSfeed](http://www.zazar.net/developers/jquery/zrssfeed/)基于*jQuery*构建，简单的主题很棒。
试试看。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-10-08T20:27:19.167

使用由 google 缓存的[google ajax api](https://developers.google.com/feed/v1/jsondevguide)和您想要的任何输出格式。

代码示例； [http://code.google.com/apis/ajax/playground/#load_feed](http://code.google.com/apis/ajax/playground/#load_feed)

```
<script src="http://www.google.com/jsapi?key=AIzaSyA5m1Nc8ws2BbmPRwKu5gFradvD_hgq6G0" type="text/javascript"></script>
<script type="text/javascript">
/*
*  How to load a feed via the Feeds API.
*/

google.load("feeds", "1");

// Our callback function, for when a feed is loaded.
function feedLoaded(result) {
  if (!result.error) {
    // Grab the container we will put the results into
    var container = document.getElementById("content");
    container.innerHTML = '';

    // Loop through the feeds, putting the titles onto the page.
    // Check out the result object for a list of properties returned in each entry.
    // http://code.google.com/apis/ajaxfeeds/documentation/reference.html#JSON
    for (var i = 0; i < result.feed.entries.length; i++) {
      var entry = result.feed.entries[i];
      var div = document.createElement("div");
      div.appendChild(document.createTextNode(entry.title));
      container.appendChild(div);
    }
  }
}

function OnLoad() {
  // Create a feed instance that will grab Digg's feed.
  var feed = new google.feeds.Feed("http://www.digg.com/rss/index.xml");

  // Calling load sends the request off.  It requires a callback function.
  feed.load(feedLoaded);
}

google.setOnLoadCallback(OnLoad);
</script> 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-08-01T20:33:42.867

[jQuery-rss 项目](https://github.com/sdepold/jquery-rss)非常轻量级，并没有强加任何特定的样式。

语法可以很简单

```
$("#rss-feeds").rss("http://www.recruiter.com/feed/career.xml") 
```

请参阅[http://jsfiddle.net/jhfrench/AFHfn/ 上的工作示例](http://jsfiddle.net/jhfrench/AFHfn/)

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2012-07-13T02:33:06.497

[jQuery Feeds](https://github.com/camagu/jquery-feeds)是一个不错的选择，它具有内置的模板系统并使用 Google Feed API，因此它具有跨域支持。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2014-01-23T20:21:43.710

[Superfeedr](http://superfeedr.com)有一个[jquery 插件](http://plugins.jquery.com/superfeedr/)，它做得很好。您不会有任何跨域策略问题，并且更新会实时传播。

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2012-05-11T03:36:58.920

jFeed 很简单，并且有一个[示例](https://github.com/jfhovinne/jFeed/blob/master/example.html)供您测试。但是，如果您要解析来自另一台服务器的提要，则需要在提要的服务器上允许[跨域资源共享](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)(CORS)。您还需要[检查浏览器支持](http://caniuse.com/cors)。

我上传[了示例](https://raw.github.com/jfhovinne/jFeed/master/example.html)，但当我通过 http 协议将示例中的 url 更改为 example.com/feed.rss 之类的内容时，仍然没有得到任何版本的 IE 支持。IE 8 及更高版本应支持 CORS，但 jFeed 示例未呈现提要。

您最好的选择是使用 Google 的 API：
[https ://developers.google.com/feed/v1/devguide](https://developers.google.com/feed/v1/devguide)

参见：
[https ://github.com/jfhovinne/jFeed](https://github.com/jfhovinne/jFeed)
[http://en.wikipedia.org/wiki/Cross-origin_resource_sharing](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)
[http://en.wikipedia.org/wiki/Same_origin_policy](http://en.wikipedia.org/wiki/Same_origin_policy)
[http://caniuse.com/cors](http://caniuse.com/cors)

# c# - 嵌套类可以访问它所嵌套的类的哪些字段？

> ID：226664
> 
> 赞同：0
> 
> 时间：2008-10-22T16:50:15.990
> 
> 标签：c#, web-services

我在 C# 中有一个 Web 服务，并且希望有一个嵌套的内部类，它抽象出会话集合，如下所示：

```
 public class Service : System.Web.Services.WebService
{
    [WebMethod]
    public string Foo(string ticket)
    {
        SessionPool.getSession(ticket);
    }

    private class SessionPool 
    {
        public static Session getSession(string ticket)
        {
            // this is what i want to do, but I can't access Context
            return (Session)Context.Session[ticket];
        }
    }
} 

```

是否可以通过嵌套类访问 WebService 类的 HTTP 上下文？如果没有，有没有办法可以存储对它的引用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T16:58:21.980

C# 中的嵌套类与 Java 中的（非静态）内部类不同。没有对包含类的实例的隐式引用 - 因此如果没有显式引用，您就不能使用包含类的任何实例成员。

但是，您确实可以访问包含类的所有私有成员 - 以及实例成员的合适引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T16:53:00.273

```
System.Web.HttpContext.Current 
```

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T17:00:47.077

我能想到几件事。

首先，您可以尝试使用 getContext() 而不是仅仅访问 Context。如果这行得通，你就完成了。

如果没有，您可以将 Service 作为初始化程序传递给您的 SessionPool。在从 Foo() 调用 getSession() 之前，通过调用 setService() 向 SessionPool 添加一个 WebService 句柄。

虽然，在这一点上，为什么不直接将 Context 作为参数传递给 getSession() 呢？

# javascript - JQuery选项卡 - 嵌套选项卡的问题 - 在初始加载时激活子选项卡

> ID：226676
> 
> 赞同：0
> 
> 时间：2008-10-22T16:54:12.237
> 
> 标签：javascript, jquery, jquery-ui, tabs, jquery-ui-tabs

我对嵌套的 jquery 选项卡有疑问，需要一些帮助/指针。

目前我有 5 个父选项卡，每个父选项卡下都有几个子选项卡。

当页面被加载时，我想显示一个特定的父选项卡和它的一个子选项卡处于活动状态。

我能够激活特定的父选项卡，但同样不适用于子选项卡。

请让我知道是否有人遇到过类似的问题并有任何解决方案可以分享。

参考 - [http://docs.jquery.com/UI/Tabs](http://docs.jquery.com/UI/Tabs)

谢谢和问候， 阿杰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T08:17:35.697

您的标签是否正在加载 ajax 内容？如果是这样，您将必须在加载回调中设置子活动选项卡....[此线程中的示例。](http://www.nabble.com/Selecting-nested-tabs-with-text-link-td20109146s27240.html) 如果您不这样做，请提供您的脚本，我会为您提供帮助。

# java - 如何在 Java 中获取系统 HTTP 代理配置

> ID：226677
> 
> 赞同：3
> 
> 时间：2008-10-22T16:54:44.153
> 
> 标签：java, networking, proxy

是否可以在 Java 中获取系统代理配置？

在 Java 控制面板中，您可以设置代理配置。如何访问该代理配置以打开代理后面的 URL 连接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-06-08T18:57:44.593

哦，看看[这个](https://stackoverflow.com/questions/376101/setting-jvm-jre-to-use-windows-proxy-automatically)问题。有一个带有溶液的样品。

目前我看到的所有示例都使用 SUN 的未记录 API（com.sum 包），这会导致编译时出现警告......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T00:30:23.750

Java 插件从系统设置中获取它。如果应用程序必须作为 applet 或 webstart 启动，您可以为此使用 webstart/applet API。否则，您必须使用本机代码。查看各种 JniWrapper 的 WinPack 和 JDIC 库——它们可能已经为您完成了繁重的工作。

# c# - db4o 客户端/服务器似乎一次只能处理一个查询？

> ID：226681
> 
> 赞同：8
> 
> 时间：2008-10-22T16:56:59.877
> 
> 标签：c#, multithreading, concurrency, client-server, db4o

我们正在评估 db4o（来自[http://www.db4o.com](http://www.db4o.com)的 OO-DBMS ）。我们已经为客户端/服务器模式进行了性能测试，我们启动了一个服务器，然后同时使用多个客户端对其进行锤击。似乎服务器一次只能处理一个客户端的查询。

我们是否错过了允许这种情况的某个配置开关？服务器实现如下。客户端对每个操作进行连接、查询（只读）和断开连接，并且操作从客户端进程中的多个工作线程中一个接一个地运行。如果我们在同一台服务器上启动一个客户端进程和一个工作人员，我们会看到相同的行为。

有什么建议么？

编辑：我们现在已经发现并尝试了惰性和快照查询模式，尽管这缓解了阻塞服务器问题（部分），但当我们的客户端（我们运行 40 个并发测试客户端等待 1在服务器上发出随机操作请求之前-300ms）锤子。似乎有来自 LINQ 提供程序和 IO 内部的异常:-(

```
public class Db4oServer : ServerConfiguration, IMessageRecipient
{
    private bool stop;

    #region IMessageRecipient Members

    public void ProcessMessage(IMessageContext con, object message)
    {
        if (message is StopDb4oServer)
        {
            Close();
        }
    }

    #endregion

    public static void Main(string[] args)
    {
        //Ingestion.Do();
        new Db4oServer().Run(true, true);
    }

    public void Run(bool shouldIndex, bool shouldOptimizeNativeQueries)
    {
        lock (this)
        {
            var cfg = Db4oFactory.NewConfiguration();
            if (shouldIndex)
            {
                cfg.ObjectClass(typeof (Sequence))
                               .ObjectField("<ChannelID>k__BackingField")
                               .Indexed(true);
                cfg.ObjectClass(typeof (Vlip))
                               .ObjectField("<ChannelID>k__BackingField")
                               .Indexed(true);
            }
            if (shouldOptimizeNativeQueries)
            {
                cfg.OptimizeNativeQueries(true);
            }

            var server = Db4oFactory.OpenServer(cfg, FILE, PORT);
            server.GrantAccess("0", "kieran");
            server.GrantAccess("1", "kieran");
            server.GrantAccess("2", "kieran");
            server.GrantAccess("3", "kieran");
            //server.Ext().Configure().ClientServer().SingleThreadedClient(false);
            server.Ext().Configure().MessageLevel(3);
            server.Ext().Configure().Diagnostic().AddListener(new DiagnosticToConsole());
            server.Ext().Configure().ClientServer().SetMessageRecipient(this);
            try
            {
                if (!stop)
                {
                    Monitor.Wait(this);
                }
            }
            catch (Exception e)
            {
                Console.WriteLine(e.ToString());
            }
            server.Close();
        }
    }

    public void Close()
    {
        lock (this)
        {
            stop = true;
            Monitor.PulseAll(this);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T01:17:39.673

好吧，在 db40 服务器上有些东西不允许同时打开太多客户端，因为它对某些人来说太多了，无法处理。您还锁定了它，在这种情况下没有任何帮助。

# java - 蚂蚁过滤 - 如果未设置属性则失败

> ID：226683
> 
> 赞同：31
> 
> 时间：2008-10-22T16:57:03.683
> 
> 标签：java, ant

我有一个蚂蚁`build.xml`，它使用该`<copy>`任务来复制各种 xml 文件。它使用过滤来合并`build.properties`文件中的属性。每个环境（dev、stage、prod）都有不同`build.properties`的存储该环境的配置。

有时我们向 Spring XML 或其他需要更新`build.properties`文件的配置文件添加新属性。

如果缺少属性，我希望 ant 快速失败`build.properties`。也就是说，如果任何原始`@...@`令牌进入生成的文件，我希望构建终止，以便用户知道他们需要向其本地 build.properties 添加一个或多个属性。

内置任务可以做到这一点吗？我在文档中找不到任何内容。我即将编写一个自定义的蚂蚁任务，但也许我可以省去自己的努力。

谢谢

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-03-17T11:31:28.093

如果你正在寻找一个特定的属性，你可以使用带有 unless 属性的失败任务，例如：

```
<fail unless="my.property">Computer says no. You forgot to set 'my.property'!</fail> 
```

有关更多详细信息，请参阅[Ant 的失败任务的文档。](https://ant.apache.org/manual/Tasks/fail.html "Ant 失败文档")

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-14T21:33:03.410

您可以在 ant 1.7 中使用`LoadFile`任务和`match`条件的组合来执行此操作。

```
<loadfile property="all-build-properties" srcFile="build.properties"/>
<condition property="missing-properties">
    <matches pattern="@[^@]*@" string="${all-build-properties}"/>
</condition>
<fail message="Some properties not set!" if="missing-properties"/> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-22T17:10:39.083

我将建议您尝试使用`<property file="${filter.file}" prefix="filter">`将属性实际加载到 Ant 中，然后`fail`如果其中任何一个未设置，但我认为我错误地解释了您的问题（如果未设置指定的属性，您希望失败在属性文件中）。

我认为您最好的选择可能是使用`<exec>`（取决于您的开发平台）对“@”字符执行 grep，然后将属性设置为找到的出现次数。不确定确切的语法，但...

```
<exec command="grep \"@\" ${build.dir} | wc -l" outputproperty="token.count"/>
<condition property="token.found">
    <not>
        <equals arg1="${token.count}" arg2="0"/>
    </not>
</condition>
<fail if="token.found" message="Found token @ in files"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T20:53:47.000

如果 exec 命令在您的 ant 版本中被弃用，您可以使用重定向器，例如：

```
<exec executable="grep">
  <arg line="@ ${build.dir}"/>
  <redirector outputproperty="grep.out"/>
</exec>
<exec executable="wc" inputstring="${grep.out}">
  <arg line="-l"/>
  <redirector outputproperty="token.found"/>
</exec> 
```

创建 token.found 属性

```
<condition property="token.found">
    <not>
        <equals arg1="${token.count}" arg2="0"/>
    </not>
</condition>
<fail if="token.found" message="Found token @ in files"/> 
```

对于有条件的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-23T05:14:11.453

由于 Ant 1.6.2`condition`也可以嵌套在`fail`.

以下宏使有条件地检查多个属性变得容易。

```
<macrodef name="required-property">
    <attribute name="name"/>
    <attribute name="prop" default="@{name}"/>
    <attribute name="if" default="___"/>
    <attribute name="unless" default="___"/>
    <sequential>
        <fail message="You must set property '@{name}'">
            <condition>
                <and>
                    <not><isset property="@{prop}"/></not>
                    <or>
                        <equals arg1="@{if}" arg2="___"/>
                        <isset property="@{if}"/>
                    </or>
                    <or>
                        <equals arg1="@{unless}" arg2="___"/>
                        <not><isset property="@{unless}"/></not>
                    </or>
                </and>
            </condition>
        </fail>
    </sequential>
</macrodef>

<target name="required-property.test">
    <property name="prop" value=""/>
    <property name="cond" value="set"/>
    <required-property name="prop"/>
    <required-property name="prop" if="cond"/>
    <required-property name="prop" unless="cond"/>
    <required-property name="prop" if="cond2"/>
    <required-property name="prop" unless="cond2"/>
    <required-property name="prop" if="cond" unless="cond"/>
    <required-property name="prop" if="cond" unless="cond2"/>
    <required-property name="prop" if="cond2" unless="cond"/>
    <required-property name="prop" if="cond2" unless="cond2"/>
    <required-property name="prop2" unless="cond"/>
    <required-property name="prop2" if="cond2"/>
    <required-property name="prop2" if="cond2" unless="cond"/>
    <required-property name="prop2" if="cond" unless="cond"/>
    <required-property name="prop2" if="cond2" unless="cond2"/>
    <required-property name="success"/>
</target> 
```

# javascript - 唯一的元素 ID，即使元素没有

> ID：226689
> 
> 赞同：41
> 
> 时间：2008-10-22T16:58:56.097
> 
> 标签：javascript, firefox, dom, greasemonkey

我正在编写一个 GreaseMonkey 脚本，在其中迭代一堆元素。对于每个元素，我需要一个字符串 ID，以后可以使用它来引用该元素。元素本身没有`id`属性，我无法修改原始文档以赋予它属性（尽管我可以在脚本中进行 DOM 更改）。我无法将引用存储在我的脚本中，因为当我需要它们时，GreaseMonkey 脚本本身就会超出范围。例如，有什么方法可以获取浏览器使用的“内部”ID？仅 Firefox 的解决方案很好；可以应用于其他场景的跨浏览器解决方案会很棒。

编辑：

*   **如果 GreaseMonkey 脚本超出范围，您以后如何引用这些元素？**他们的 GreaseMonkey 脚本正在向 DOM 对象添加事件。我无法将引用存储在数组或其他类似机制中，因为当事件触发时，数组将消失，因为 GreaseMonkey 脚本将超出范围。因此，事件需要某种方式来了解附加事件时脚本所具有的元素引用。并且有问题的元素不是它所附加的元素。

*   **你不能只在元素上使用自定义属性吗？**是的，但问题在于查找。我不得不求助于遍历所有元素，以寻找将自定义属性设置为所需 id 的元素。这当然可以，但在大型文档中可能非常耗时。我正在寻找浏览器可以进行查找工作的东西。

*   **等等，你能不能修改文件？**我无法修改源文档，但我可以在脚本中进行 DOM 更改。我会在问题中澄清。

*   **你不能使用闭包吗？**Closuses 确实有效，尽管我最初认为它们不会。看我后面的帖子。

这听起来像是对以下问题的回答：“我可以使用一些内部浏览器 ID 吗？” 没有。”

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-22T17:40:45.200

答案是否定的，没有您可以访问的内部 ID。Opera 和 IE（也许是 Safari？）支持`.sourceIndex`（如果 DOM 支持，则会更改），但 Firefox 没有这种支持。

您可以通过生成给定节点的 Xpath 或查找节点的索引来模拟源索引，从该节点`document.getElementsByTagName('*')`总是按源顺序返回元素。

当然，所有这些都需要一个完全静态的文件。对 DOM 的更改将破坏查找。

我不明白的是你如何可以松散对节点的引用而不是（理论上的）内部ID？闭包和分配工作或不工作。还是我错过了什么？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-22T19:26:28.997

关闭是要走的路。通过这种方式，您将准确引用甚至可以在 DOM 的一些改组中幸存下来的元素。

不知道闭包的人的例子：

```
var saved_element = findThatDOMNode();

document.body.onclick = function() 
{
   alert(saved_element); // it's still there!
} 
```

*如果*您必须将它存储在 cookie 中，那么我建议为它计算 XPath（例如，遍历 DOM 计算以前的兄弟姐妹，直到找到具有 ID 的元素，您最终会得到类似的东西`[@id=foo]/div[4]/p[2]/a`）。

[XPointer](http://www.w3.org/TR/WD-xptr)是 W3C 对该问题的解决方案。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-22T17:52:45.317

对您的问题的措辞有点困惑-您说您“需要一个 [您] 以后可以用来引用该元素的字符串 ID”，但是您“不能将引用存储在 [您的] 脚本中，因为当 [你] 需要它们，GreaseMonkey 脚本本身就会超出范围。”

如果脚本超出范围，那么您以后如何引用它们？！

我将忽略我对您的理解感到困惑的事实，并告诉您我经常编写 Greasemonkey 脚本并且*可以*修改我访问的 DOM 元素以赋予它们一个 ID 属性。这是您可以用来获取伪唯一值以供临时使用的代码：

```
var PseudoGuid = new (function() {
    this.empty = "00000000-0000-0000-0000-000000000000";
    this.GetNew = function() {
        var fourChars = function() {
            return (((1 + Math.random()) * 0x10000)|0).toString(16).substring(1).toUpperCase();
        }
        return (fourChars() + fourChars() + "-" + fourChars() + "-" + fourChars() + "-" + fourChars() + "-" + fourChars() + fourChars() + fourChars());
    };
})();

// usage example:
var tempId = PseudoGuid.GetNew();
someDomElement.id = tempId; 
```

这对我有用，我自己只是在 Greasemonkey 脚本中对其进行了测试。

* * *

**更新：**闭包是要走的路——就个人而言，作为一个核心的 JavaScript 开发人员，我不知道你是怎么*没有*立即想到这些的。:)

```
myDomElement; // some DOM element we want later reference to

someOtherDomElement.addEventListener("click", function(e) {
   // because of the closure, here we have a reference to myDomElement
   doSomething(myDomElement);
}, false); 
```

现在，`myDomElement`根据您的描述，显然是您已经拥有的元素之一（因为您正在考虑为其添加 ID 或其他）。

也许如果你发布一个你正在尝试做的事情的例子，那么帮助你会更容易，假设这没有。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-23T15:12:45.967

**更新：**闭包确实是答案。因此，在又摆弄了一些之后，我弄清楚了为什么闭包最初是有问题的以及如何解决它。闭包的棘手之处在于，在遍历元素时必须小心，不要让所有闭包都引用同一个元素。例如，这不起作用：

```
for (var i = 0; i < elements.length; i++) {
    var element = elements[i];
    var button = document.createElement("button");
    button.addEventListener("click", function(ev) {
        // do something with element here
    }, false)
} 
```

但这确实：

```
var buildListener = function(element) {
    return function(ev) {
        // do something with event here
    };
};

for (var i = 0; i < elements.length; i++) {
    var element = elements[i];
    var button = document.createElement("button");
    button.addEventListener("click", buildListener(element), false)
} 
```

无论如何，我决定不选择一个答案，因为这个问题有两个答案：1）不，没有可以使用的内部 ID；2）你应该为此使用闭包。所以我只是简单地支持第一批说出是否有内部 ID 或建议生成 ID 的人，以及任何提到闭包的人。谢谢您的帮助！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-22T18:04:57.023

如果您*可以*写入 DOM（我相信您可以）。我会这样解决这个问题：

有一个函数返回或生成一个 ID：

```
//(function () {

  var idCounter = new Date().getTime();
  function getId( node ) {
    return (node.id) ? node.id : (node.id = 'tempIdPrefix_' + idCounter++ );
  }

//})(); 
```

根据需要使用它来获取 ID：

```
var n = document.getElementById('someid');
getId(n);  // returns "someid"

var n = document.getElementsByTagName('div')[1];
getId(n);  // returns "tempIdPrefix_1224697942198" 
```

这样，您就不必担心服务器将 HTML 交给您时的样子。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-22T17:38:43.597

如果您不修改 DOM，则可以通过索引顺序获取它们：

（[原型](http://prototypejs.org)示例）

```
myNodes = document.body.descendants()
alert(document.body.descendants()[1].innerHTML) 
```

您可以遍历所有节点并为它们提供一个唯一的类名，您以后可以轻松选择该类名。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-22T17:30:12.633

您可以将 id 属性设置为计算值。原型库中有一个函数可以为您执行此操作。

[http://www.prototypejs.org/api/element/identify](http://www.prototypejs.org/api/element/identify)

我最喜欢的 javascript 库是 jQuery。不幸的是，jQuery 没有识别功能。但是，您仍然可以将 id 属性设置为您自己生成的值。

[http://docs.jquery.com/Attributes/attr#keyfn](http://docs.jquery.com/Attributes/attr#keyfn)

这是来自 jQuery 文档的部分片段，它根据页面中的位置为 div 设置 id：

```
 $(document).ready(function(){

    $("div").attr("id", function (arr) {
          return "div-id" + arr;
        });
  }); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-05-19T11:44:18.090

您可以使用以下函数为 DOM 中的任何给定节点生成稳定的唯一标识符：

```
function getUniqueKeyForNode (targetNode) {
    const pieces = ['doc'];
    let node = targetNode;

    while (node && node.parentNode) {
        pieces.push(Array.prototype.indexOf.call(node.parentNode.childNodes, node));
        node = node.parentNode
    }

    return pieces.reverse().join('/');
} 
```

这将为这样的结构创建标识符，例如`doc/0`, `doc/0/0`, `doc/0/1`, `doc/0/1/0`, `doc/0/1/1`：

```
<div>
    <div />
    <div>
        <div />
        <div />
    </div>
</div> 
```

您还可以进行一些优化和更改，例如：

*   在`while`循环中，`break`当它`node`具有您知道是唯一的属性时，例如`@id`

*   不是`reverse()`，`pieces`目前它只是看起来更像是生成 ID 的 DOM 结构

*   `piece` `doc`如果您不需要文档节点的标识符，则不包括第一个

*   以某种方式将标识符保存在节点上，并将该值重新用于子节点，以避免不得不再次遍历树。

*   如果您将这些标识符写回 XML，如果您正在编写的属性受到限制，请使用另一个连接字符。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-03-26T18:10:42.157

使用元素的鼠标和/或位置属性生成唯一 ID。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-22T17:06:42.647

在 javascript 中，您可以将自定义 ID 字段附加到节点

```
if(node.id) {
  node.myId = node.id;
} else {
  node.myId = createId();
}

// store myId 
```

这有点小技巧，但它会给每个节点一个你可以使用的 id。当然，`document.getElementById()`不会关注它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-24T02:44:32.763

您还可以使用 pguid（页面唯一标识符）生成唯一标识符：

```
 pguid = b9j.pguid.next() // A unique id (suitable for a DOM element)
                          // is generated
                          // Something like "b9j-pguid-20a9ff-0"
 ...
 pguid = b9j.pguid.next() // Another unique one... "b9j-pguid-20a9ff-1"

 // Build a custom generator
 var sequence = new b9j.pguid.Sequence({ namespace: "frobozz" })
 pguid = sequence.next() "frobozz-c861e1-0" 
```

[http://appengine.bravo9.com/b9j/documentation/pguid.html](http://appengine.bravo9.com/b9j/documentation/pguid.html)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-03-30T16:18:57.830

我“认为”我刚刚解决了一个类似的问题。但是，我在浏览器 DOM 环境中使用 jQuery。

var objA = $("选择器到某个 dom 元素"); var objB = $("其他 dom 元素的选择器");

if(objA[0] === objB[0]) { //太棒了！这两个对象指向完全相同的 dom 节点 }

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-06-24T13:23:48.800

好的，没有自动关联到 DOM 元素的 ID。DOM 具有元素的层次结构，这是主要信息。从这个角度来看，您可以使用 jQuery 或 jQLite**将数据与 DOM 元素相关联。**当您必须将自定义数据绑定到元素时，它可以解决一些问题。

# c# - 在 x64 系统上创建 Excel 工作簿

> ID：226691
> 
> 赞同：1
> 
> 时间：2008-10-22T16:59:48.420
> 
> 标签：c#, excel-2007

我需要将 SQL 查询的结果导出到 Excel。我目前正在将其导出为 2007 格式，但我发现的所有内容都只能在 x86 环境中运行。进行导出的网站在 x64 版本的 IIS 上运行。

更改 IIS 以运行 x86 不是一种选择。我目前的解决方案是将导出请求保存到数据库，并编写一个可以在 x86 中运行的 Windows 服务并使用该服务来处理请求。

我已经开始将 Open XML Format SDK 2.0 视为可能的更好解决方案。

有没有人有任何经验可以借给本机.NET 解决方案。

仅供参考：我的预算是 0.00 美元，所以购买工具是不行的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T17:32:57.477

就个人而言，从 ASP.NET 应用程序的角度来看，我发现使用 XML 和 XSLT 转换为 Excel XML 格式是最有效且真正无故障的方法。不涉及任何成本，一旦你掌握了它，它真的很快！

除此之外，我个人强烈反对任何形式的自动化来完成这类任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T17:37:02.477

我同意米切尔卖家的观点。另一种方法是创建一个简单的带有表格的 html 文档，excel 将完全接受。

例子：

```
<html><body>
<table>
<tr><td>First column</td><td>Second column</td></tr>
<tr><td>Value of first row in first column</td><td>Value of first row in second column</td></tr>
<tr><td>Value of second row in first column</td><td>Value of secondrow in second column</td></tr>
</table>
</body></html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T17:43:45.163

迈克，你有什么我可以看的例子吗？导出到 Excel 并不是我非常需要的（真的没有），所以任何领先的开始都会很好。

TcKs，我尝试了 Html 路线，并不太关心 excel 抱怨 html 的文件格式不是预期的 .xls(x) 格式的方式。我正在为销售人员出口，因此必须处理的消息越少（因此我必须回答的问题）越好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T17:47:02.147

最适合我的最简单方法是使用一行数据以正确格式创建 Excel 文件。

然后将文件保存为 html 格式，并将其用作实际数据的模板。

包含一些元数据，当双击生成的 html 文件时会自动启动 Excel。

我不得不这样做，因为我们使用没有打开文件格式的 Excel 2002 和 2003。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T22:31:48.810

看看： http: [//www.codeproject.com/KB/office/excelxmlspreadsheet.aspx](http://www.codeproject.com/KB/office/excelxmlspreadsheet.aspx)

我认为我们以此为模型构建了一个内部解决方案。

# python - Python 基于磁盘的字典

> ID：226693
> 
> 赞同：41
> 
> 时间：2008-10-22T17:00:11.053
> 
> 标签：python, database, dictionary, disk-based

我正在运行一些动态编程代码（试图强力反驳 Collat​​z 猜想 =P），并且我正在使用 dict 来存储我已经计算过的链的长度。显然，它在某个时候耗尽了内存。有没有什么简单的方法可以使用 a 的某些变体，`dict`当它用完空间时，它会将自身的一部分分页到磁盘？显然它会比内存中的字典慢，并且最终可能会占用我的硬盘空间，但这可能适用于其他不是那么无用的问题。

我意识到基于磁盘的字典几乎是一个数据库，所以我使用 sqlite3 手动实现了一个，但我没有以任何聪明的方式做到这一点，而是让它一次查找数据库中的每个元素......它慢了大约 300 倍。

创建我自己的一组字典，一次只在内存中保留一个，并以某种有效的方式将它们分页是最聪明的方法吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-10-23T07:22:01.207

The 3rd party [shove](http://pypi.python.org/pypi/shove) module is also worth taking a look at. It's very similar to shelve in that it is a simple dict-like object, however it can store to various backends (such as file, SVN, and S3), provides optional compression, and is even threadsafe. It's a very handy module

```
from shove import Shove

mem_store = Shove()
file_store = Shove('file://mystore')

file_store['key'] = value 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-22T17:34:09.927

Hash-on-disk 通常使用 Berkeley DB 或类似的东西来解决 - [Python Data Persistence 文档](http://docs.python.org/library/persistence.html)中列出了几个选项。你可以在它前面加上一个内存缓存，但我会先测试本机性能；有了操作系统缓存，它可能会出现相同的结果。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-23T02:21:40.547

[搁置](http://docs.python.org/library/shelve.html)模块可以做到；无论如何，它应该很容易测试。代替：

```
self.lengths = {} 
```

做：

```
import shelve
self.lengths = shelve.open('lengths.shelf') 
```

唯一的问题是货架的钥匙必须是字符串，所以你必须更换

```
self.lengths[indx] 
```

和

```
self.lengths[str(indx)] 
```

（我假设您的键只是整数，根据您对 Charles Duffy 帖子的评论）

内存中没有内置缓存，但您的操作系统可能会为您执行此操作。

[actually, that's not quite true: you can pass the argument 'writeback=True' on creation. The intent of this is to make sure storing lists and other mutable things in the shelf works correctly. But a side-effect is that the whole dictionary is cached in memory. Since this caused problems for you, it's probably not a good idea :-) ]

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-22T17:37:24.880

上次我遇到这样的问题时，我重写了使用 SQLite 而不是 dict，并且性能有了很大的提升。这种性能提升至少部分是由于数据库的索引能力。取决于您的算法，YMMV。

一个瘦包装器，可以在其中执行 SQLite 查询，`__getitem__`并且`__setitem__`不需要编写太多代码。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-22T18:01:42.630

稍加思考，您似乎可以让[搁置模块](http://blog.doughellmann.com/2007/08/pymotw-shelve.html)做您想做的事。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-18T10:51:35.327

I've read you think shelve is too slow and you tried to hack your own dict using sqlite.

Another did this too :

[http://sebsauvage.net/python/snyppets/index.html#dbdict](http://sebsauvage.net/python/snyppets/index.html#dbdict)

It seems pretty efficient (and sebsauvage is a pretty good coder). Maybe you could give it a try ?

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-22T17:50:46.023

如果有一些启发式方法可以知道接下来最有可能检索哪些项目，那么您一次应该携带多个项目，并且不要忘记查尔斯提到的索引。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-11-14T06:17:35.783

For simple use cases [sqlitedict](https://github.com/RaRe-Technologies/sqlitedict) can help. However when you have much more complex databases you might one to try one of the more upvoted answers.

# design-patterns - 当布尔“if”具有三个结果代码路径时，您会怎么想？

> ID：226701
> 
> 赞同：2
> 
> 时间：2008-10-22T17:02:19.693
> 
> 标签：design-patterns, conditional

QA 测试员正在阅读 HTML/JS 代码以编写 Web 表单的功能测试，并看到：

```
if (form_field == empty)
{
...do stuff for empty field
}
else if (form_field != empty)
{
...do stuff for non-empty field
}
else
{
...do stuff that will never be done
} 
```

经过几次尴尬的尝试后，测试人员意识到他们无法触发隐藏在第三个区块中的警报字符串。

我想知道这个问题是否或多或少是特定于语言的（非 JS 人可以在这里学习课程吗？）并且代码以这种方式结束是否有正当的理由？

我怎样才能找到/解决问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-22T17:13:30.233

尽管第三个块不能在 Javascript 中触发，但并非所有语言都如此。在 T-SQL 中：

```
declare @test as int

set @test = null

if @test = 1 
  print 1
else if not @test = 1
  print 2
else 
  print 3 
```

这将打印 3，因为 NULL 既不等于也不等于任何其他值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T17:27:13.683

如果您使用设计不佳的布尔值（在没有真正布尔类型的早期 C 中很常见），就会发生这种情况。你仍然可以在 Windows 中找到这些东西。

```
BOOL result = SomeWindowsAPI();
if (result == TRUE)
{
    // success
}
else if (result == FALSE)
{
    // failure
}
else
{
    // wtf?
} 
```

这里的关键是对“TRUE”的显式测试，它假设布尔值只有一种方式可以具有真值。当使用整数作为布尔值时，这是不正确的。

在某些计算机上的某些语言（VMS 上的 Fortran）中，可能有许多不同的整数值解析为 true，许多不同的值解析为 false。在 Windows 上，HRESULT 被解释为 SUCCESS 或 FAILURE 时的方式相同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-22T17:10:27.117

我见过 else if 曾经在那里有其他东西（AND/OR）的情况，而修复它的人只是“修复它”并且没有深入探讨。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T17:11:49.690

静态分析会告诉你第三种情况是“死代码”

像这样的代码来自对布尔逻辑的误解，或者不同人随着时间的推移多次编辑 - 或两者兼而有之;-)

这不是 Javascript 特有的，这种错误可以在任何具有 if-else 结构（或其合理的复制品）的语言中发生

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-22T17:16:50.863

> 这个问题或多或少是特定于语言的（非 JS 的人可以在这里学习吗？）

这是一个与语言无关的问题。用 Java 编写以下代码非常容易，例如：

```
if(x)
{
  //do something
}
else if(!x)
{
  //do something else
}
else
{
  //never, ever, do anything
} 
```

要记住的关键是“if(!x)”不是必需的。把它变成一个简单的“else”会创建更简单的代码。

```
Are there legitimate reasons code ended up this way? 
```

有点。当需要失败时，总是存在 else 条件是标准做法。问题是程序员并没有很清楚地认为他的“（form_field！= empty）”与简单的“else”完全相同。把它指出给他，他应该踢自己。如果他不这样做，请质疑他在团队中的角色。

> 应该使用什么方法来查找/解决问题（代码覆盖率、代码审查、黑盒测试等）

静态代码分析工具可以捕捉到这类问题。但是，我不知道任何 Javascript。[JSLint](http://www.jslint.com/)可以捕捉到很多不好的东西，但不能捕捉到逻辑流问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-22T17:10:20.690

我不相信这个问题完全是特定于语言的。您可以用多种其他语言构造类似（有缺陷的）条件语句。

另外，我认为条件语句以这种方式构造没有正当理由。正如您在评论中所说，第三块中的语句永远不会完成。

通过代码审查，您可能最有效地发现这样的错误。但是，由于这需要至少一名开发人员花费相当多的时间，因此开发高质量的单元测试和检查代码覆盖率可能会更好地为您服务。在这种情况下，您可能会注意到条件语句的第三部分从未使用过。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-22T17:11:43.667

我知道我记得在我大学的第一年或第二年写过一些类似的东西，在我知道之前。但我现在找不到这样做的理由。

它甚至接近合法的唯一方法是如果“空”或“form_field”是一个不稳定的值，类似于 VB 的 Now() 函数。但在那种情况下，我不会这样写。相反，您在 if 块上方捕获该值并测试捕获的值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-22T17:34:53.480

也许不是在 JavaScript 中，但任何支持多线程编程的语言，*并*以这样的方式声明 form_field ，以便在多个线程之间共享，实际上可以看到这种情况发生。

例如，[彼得森的算法](http://en.wikipedia.org/wiki/Peterson%27s_algorithm)包含一个类似无用的双重检查：

```
 turn = 1;
     while( flag[1] && turn == 1 ); 
```

不过，这可以防止竞争条件。生成一个测试来引起它仍然是非常困难的。

如果没有可能的竞争条件，那么当我与 NASA 签约时，我们曾经开玩笑地称之为“宇宙射线检查”。:-)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-22T17:10:47.977

一般形式

```
if (a)
  //1
else if (!a)
  //2
else
  //3 
```

总是可以简化为

```
if (a)
  //1
else
  //2 
```

没有副作用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-22T17:15:00.447

*   这个问题或多或少是特定于语言的（非 JS 的人可以在这里学习吗？）

不，你可以在任何语言中遇到这种带有分支和比较的代码。

*   代码以这种方式结束是否有正当理由？
*   应该使用什么方法来查找/解决问题（代码覆盖率、代码审查、黑盒测试等）

不，不是。我猜该代码开始于布尔比较以外的其他东西。也许它是空的、数字的或非数字的，或者是空的，1-5 个字符，或者超过 5 个字符，诸如此类。当逻辑更改为空或非空时，应该删除第三个块 - 这通常会在同行评审或类似的事情中被发现。

根据语言的不同，一些编译器甚至可能会捕捉到这一点。审查会抓住它；黑盒测试不会，因为您不会检查代码，但白盒测试会（尽管在实际完成任何测试之前，您也应该在看到代码后立即注意到它）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-22T17:23:34.050

如果您正在测试单个条件 A，则此类问题很容易发现，因为您知道您可以有 A 和非 A。

如果您有条件 A 和 B，这也不难做到。您寻找 A、非 A 和 B、非 A 和非 B（例如）——您可以很容易地看出您已经涵盖了所有案例。

有时，无论出于何种原因，条件可能会被重构，然后（以上面人为的例子）同时留下三个块，以及由此产生的 WTF。

但是，如果您有条件 A、B、C 和 D 怎么办？堆叠 if-else 确实是一种粗糙的方法，但有时这就是它的完成方式。

通过创建完整的真值表很容易发现逻辑覆盖中的“漏洞”。一个很好的方法是使用卡诺图。[卡诺图](http://en.wikipedia.org/wiki/Karnaugh_map)上的维基百科条目是一个很好的起点（甚至还有图片！）。对于软件编码，您希望完全覆盖地图而没有重叠（至少，通常是这样）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-22T17:39:14.237

不同的气味会出现不同的测量结果。

我发现[圈复杂度](http://www.google.com/search?q=cyclomatic+complexity+tool)工具很有用。任何复杂度超过 5 的东西都值得仔细研究。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-10-20T09:59:55.063

这发生在我们公司，我认为第二个 else 中的“死代码”被执行是最有趣的事情。在我们的例子中，它是一个**无类型指针**（不要问为什么我们有这些），它被错误地设置并强制转换为具有布尔字段的类。

“ `if (A = TRUE) .. else if (A == FALSE) .. else ..`”应用于布尔字段。生成的 asm 代码如下：

```
cmp al,$01
jnz +$0c
...
test al,al
jnz +$0c
... 
```

清除**al**中的值 > 1 并且它下降到**else ..**

编码员写这个期望它发生的事实是另一回事......

# linux - 如何在 Linux shell 脚本中提示是/否/取消输入？

> ID：226703
> 
> 赞同：1699
> 
> 时间：2008-10-22T17:03:22.967
> 
> 标签：linux, bash, shell, scripting

我想暂停 shell 脚本中的输入，并提示用户选择。
标准`Yes`、、`No`或`Cancel`类型问题。
如何在典型的 bash 提示符中完成此操作？

* * *

## 回答 #1

> 赞同：1875
> 
> 时间：2008-10-22T17:08:50.943

在 shell 提示符下获取用户输入的最简单和最广泛可用的方法是[`read`](https://www.gnu.org/software/bash/manual/bashref.html#index-read)命令。说明其使用的最好方法是一个简单的演示：

```
while true; do
    read -p "Do you wish to install this program? " yn
    case $yn in
        [Yy]* ) make install; break;;
        [Nn]* ) exit;;
        * ) echo "Please answer yes or no.";;
    esac
done 
```

[Steven Huwig](https://stackoverflow.com/users/28604/steven-huwig)[指出](https://stackoverflow.com/a/226946/9084)的另一种方法是 Bash 的命令。这是使用相同的示例：[`select`](https://www.gnu.org/software/bash/manual/bashref.html#index-select)`select`

```
echo "Do you wish to install this program?"
select yn in "Yes" "No"; do
    case $yn in
        Yes ) make install; break;;
        No ) exit;;
    esac
done 
```

`select`您无需清理输入 - 它会显示可用的选项，然后您键入与您的选择相对应的数字。`while true`它还会自动循环，因此如果它们提供无效输入，则无需循环重试。

此外，[Léa Gris在](https://stackoverflow.com/users/7939871/l%c3%a9a-gris)[她的回答](https://stackoverflow.com/a/57739142/9084)中演示了一种使请求语言不可知的方法。调整我的第一个示例以更好地服务于多种语言可能如下所示：

```
set -- $(locale LC_MESSAGES)
yesptrn="$1"; noptrn="$2"; yesword="$3"; noword="$4"

while true; do
    read -p "Install (${yesword} / ${noword})? " yn
    if [[ "$yn" =~ $yesexpr ]]; then make install; exit; fi
    if [[ "$yn" =~ $noexpr ]]; then exit; fi
    echo "Answer ${yesword} / ${noword}."
done 
```

显然，其他通信字符串在此处仍未翻译（安装、回答），这需要在更完整的翻译中解决，但在许多情况下，即使是部分翻译也会有所帮助。

最后，请查看[F. Hauri](https://stackoverflow.com/users/1765658/f-hauri)的[出色回答](https://stackoverflow.com/a/27875395/9084)。

* * *

## 回答 #2

> 赞同：625
> 
> 时间：2015-01-10T10:53:39.517

# 一个通用问题至少有五个答案。

根据

*   [posix](/questions/tagged/posix "显示标记为“posix”的问题")兼容：可以在具有通用[shell](/questions/tagged/shell "显示标记为“外壳”的问题")环境的较差系统上工作
*   [特定于bash](/questions/tagged/bash "显示标记为“bash”的问题")：使用所谓的*bashisms*

如果你想

*   简单的“在线”问题/答案（通用解决方案）
*   漂亮的格式化界面，如[ncurses](/questions/tagged/ncurses "显示标记为“ncurses”的问题")或更多使用 libgtk 或 libqt 的图形...
*   使用强大的 readline 历史记录功能

## 1\. POSIX 通用解决方案

您可以使用该`read`命令，然后是`if ... then ... else`：

```
echo -n "Is this a good question (y/n)? "
read answer 
```

 ~~```
# if echo "$answer" | grep -iq "^y" ;then 
```~~ 

```
if [ "$answer" != "${answer#[Yy]}" ] ;then # this grammar (the #[] operator) means that the variable $answer where any Y or y in 1st position will be dropped if they exist.
    echo Yes
else
    echo No
fi 
```

（感谢[Adam Katz 的评论](https://stackoverflow.com/posts/comments/86532780?noredirect=1)：将上面的测试替换为更便携且避免使用分叉的测试：）

### POSIX，但单键功能

但是，如果您不希望用户必须点击`Return`，您可以编写：

（已**编辑：**正如[@JonathanLeffler](https://stackoverflow.com/users/15168/jonathan-leffler)正确建议的那样，*保存*stty 的配置可能比简单地强迫它们*理智*更好。）

```
echo -n "Is this a good question (y/n)? "
old_stty_cfg=$(stty -g)
stty raw -echo ; answer=$(head -c 1) ; stty $old_stty_cfg # Careful playing with stty
if echo "$answer" | grep -iq "^y" ;then
    echo Yes
else
    echo No
fi 
```

**注意：**这是在[sh](/questions/tagged/sh "显示标记为“sh”的问题")、[bash](/questions/tagged/bash "显示标记为“bash”的问题")、[ksh](/questions/tagged/ksh "显示标记为“ksh”的问题")、[dash](/questions/tagged/dash "显示标记为“破折号”的问题")和[busybox](/questions/tagged/busybox "显示标记为“busybox”的问题")下测试的！

相同，但明确等待`y`or `n`：

```
#/bin/sh
echo -n "Is this a good question (y/n)? "
old_stty_cfg=$(stty -g)
stty raw -echo
answer=$( while ! head -c 1 | grep -i '[ny]' ;do true ;done )
stty $old_stty_cfg
if echo "$answer" | grep -iq "^y" ;then
    echo Yes
else
    echo No
fi 
```

### 使用专用工具

有许多使用 、 或其他图形库构建`libncurses`的`libgtk`工具`libqt`。例如，使用`whiptail`：

```
if whiptail --yesno "Is this a good question" 20 60 ;then
    echo Yes
else
    echo No
fi 
```

根据您的系统，您可能需要`whiptail`用另一个类似的工具替换：

```
dialog --yesno "Is this a good question" 20 60 && echo Yes

gdialog --yesno "Is this a good question" 20 60 && echo Yes

kdialog --yesno "Is this a good question" 20 60 && echo Yes 
```

其中`20`是对话框的行数高度，是对话框的`60`宽度。这些工具都具有*几乎相同*的语法。

```
DIALOG=whiptail
if [ -x /usr/bin/gdialog ] ;then DIALOG=gdialog ; fi
if [ -x /usr/bin/xdialog ] ;then DIALOG=xdialog ; fi
...
$DIALOG --yesno ... 
```

## 2\. Bash具体解决方案

### 基本*在线*方法

```
read -p "Is this a good question (y/n)? " answer
case ${answer:0:1} in
    y|Y )
        echo Yes
    ;;
    * )
        echo No
    ;;
esac 
```

我更喜欢使用`case`，所以如果需要我什至可以测试`yes | ja | si | oui`......

### *符合**单键*功能_

在 bash 下，我们可以为命令指定预期输入的长度`read`：

```
read -n 1 -p "Is this a good question (y/n)? " answer 
```

在 bash 下，`read`command 接受一个*超时*参数，这可能很有用。

```
read -t 3 -n 1 -p "Is this a good question (y/n)? " answer
[ -z "$answer" ] && answer="Yes"  # if 'yes' have to be default choice 
```

## *3.专用工具*的一些技巧

 *更复杂的对话框，超越简单的*`yes - no`*目的：

```
dialog --menu "Is this a good question" 20 60 12 y Yes n No m Maybe 
```

进度条：

```
dialog --gauge "Filling the tank" 20 60 0 < <(
    for i in {1..100};do
        printf "XXX\n%d\n%(%a %b %T)T progress: %d\nXXX\n" $i -1 $i
        sleep .033
    done
) 
```

小演示：

```
#!/bin/sh
while true ;do
    [ -x "$(which ${DIALOG%% *})" ] || DIALOG=dialog
    DIALOG=$($DIALOG --menu "Which tool for next run?" 20 60 12 2>&1 \
            whiptail       "dialog boxes from shell scripts" >/dev/tty \
            dialog         "dialog boxes from shell with ncurses" \
            gdialog        "dialog boxes from shell with Gtk" \
            kdialog        "dialog boxes from shell with Kde" ) || exit
    clear;echo "Choosed: $DIALOG."
    for i in `seq 1 100`;do
        date +"`printf "XXX\n%d\n%%a %%b %%T progress: %d\nXXX\n" $i $i`"
        sleep .0125
      done | $DIALOG --gauge "Filling the tank" 20 60 0
    $DIALOG --infobox "This is a simple info box\n\nNo action required" 20 60
    sleep 3
    if $DIALOG --yesno  "Do you like this demo?" 20 60 ;then
        AnsYesNo=Yes; else AnsYesNo=No; fi
    AnsInput=$($DIALOG --inputbox "A text:" 20 60 "Text here..." 2>&1 >/dev/tty)
    AnsPass=$($DIALOG --passwordbox "A secret:" 20 60 "First..." 2>&1 >/dev/tty)
    $DIALOG --textbox /etc/motd 20 60
    AnsCkLst=$($DIALOG --checklist "Check some..." 20 60 12 \
        Correct "This demo is useful"        off \
        Fun        "This demo is nice"        off \
        Strong        "This demo is complex"        on 2>&1 >/dev/tty)
    AnsRadio=$($DIALOG --radiolist "I will:" 20 60 12 \
        " -1" "Downgrade this answer"        off \
        "  0" "Not do anything"                on \
        " +1" "Upgrade this anser"        off 2>&1 >/dev/tty)
    out="Your answers:\nLike: $AnsYesNo\nInput: $AnsInput\nSecret: $AnsPass"
    $DIALOG --msgbox "$out\nAttribs: $AnsCkLst\nNote: $AnsRadio" 20 60
  done 
```

更多样品？看看[使用whiptail选择USB设备](https://stackoverflow.com/questions/50560500/linux-shell-get-device-id-from-user-input/50577400#50577400)和[USB可移动存储选择器：USBKeyChooser](https://unix.stackexchange.com/questions/119759/removable-usb-stick-listed-as-non-removable-in-sys-block/119816#119816)

## 5.使用readline的历史

例子：

```
#!/bin/bash

set -i
HISTFILE=~/.myscript.history
history -c
history -r

myread() {
    read -e -p '> ' $1
    history -s ${!1}
}
trap 'history -a;exit' 0 1 2 3 6

while myread line;do
    case ${line%% *} in
        exit )  break ;;
        *    )  echo "Doing something with '$line'" ;;
      esac
  done 
```

`.myscript.history`这将在您的目录中创建一个文件`$HOME`，而不是您可以使用 readline 的历史命令，如`Up`、 `Down`、`Ctrl`+`r`等。

* * *

## 回答 #3

> 赞同：358
> 
> 时间：2008-10-22T17:08:14.783

```
echo "Please enter some input: "
read input_variable
echo "You entered: $input_variable" 
```

* * *

## 回答 #4

> 赞同：174
> 
> 时间：2011-05-13T04:44:34.807

您可以使用内置的[读取](http://ss64.com/bash/read.html)命令；使用该`-p`选项向用户提示问题。

从 BASH4 开始，您现在可以使用`-i`建议答案：

```
read -e -p "Enter the path to the file: " -i "/usr/local/etc/" FILEPATH
echo $FILEPATH 
```

（但请记住使用“readline”选项`-e`以允许使用箭头键进行行编辑）

如果你想要一个“是/否”的逻辑，你可以这样做：

```
read -e -p "
List the content of your home dir ? [Y/n] " YN

[[ $YN == "y" || $YN == "Y" || $YN == "" ]] && ls -la ~/ 
```

* * *

## 回答 #5

> 赞同：121
> 
> 时间：2008-10-22T18:14:01.280

Bash为此[选择了。](http://www.gnu.org/software/bash/manual/bashref.html#Conditional-Constructs)

```
select result in Yes No Cancel
do
    echo $result
done 
```

* * *

## 回答 #6

> 赞同：61
> 
> 时间：2011-02-03T13:23:04.210

```
read -p "Are you alright? (y/n) " RESP
if [ "$RESP" = "y" ]; then
  echo "Glad to hear it"
else
  echo "You need more bash programming"
fi 
```

* * *

## 回答 #7

> 赞同：43
> 
> 时间：2008-10-22T17:08:34.813

```
inquire ()  {
  echo  -n "$1 [y/n]? "
  read answer
  finish="-1"
  while [ "$finish" = '-1' ]
  do
    finish="1"
    if [ "$answer" = '' ];
    then
      answer=""
    else
      case $answer in
        y | Y | yes | YES ) answer="y";;
        n | N | no | NO ) answer="n";;
        *) finish="-1";
           echo -n 'Invalid response -- please reenter:';
           read answer;;
       esac
    fi
  done
}

... other stuff

inquire "Install now?"

... 
```

* * *

## 回答 #8

> 赞同：43
> 
> 时间：2012-08-30T17:59:18.717

这是我整理的一些东西：

```
#!/bin/sh

promptyn () {
    while true; do
        read -p "$1 " yn
        case $yn in
            [Yy]* ) return 0;;
            [Nn]* ) return 1;;
            * ) echo "Please answer yes or no.";;
        esac
    done
}

if promptyn "is the sky blue?"; then
    echo "yes"
else
    echo "no"
fi 
```

我是一个初学者，所以带着一粒盐，但它似乎工作。

* * *

## 回答 #9

> 赞同：32
> 
> 时间：2015-12-18T11:36:09.053

## 你要：

*   Bash 内置命令（即便携）
*   检查 TTY
*   默认答案
*   超时
*   有色问题

## 片段

```
do_xxxx=y                      # In batch mode => Default is Yes
[[ -t 0 ]] &&                  # If TTY => Prompt the question
read -n 1 -p $'\e[1;32m
Do xxxx? (Y/n)\e[0m ' do_xxxx  # Store the answer in $do_xxxx
if [[ $do_xxxx =~ ^(y|Y|)$ ]]  # Do if 'y' or 'Y' or empty
then
    xxxx
fi 
```

## 解释

*   `[[ -t 0 ]] && read ...`=>`read`如果是 TTY，则调用命令
*   `read -n 1`=> 等待一个字符
*   `$'\e[1;32m ... \e[0m '`=> 以绿色打印
    （绿色很好，因为在白色/黑色背景上都可读）
*   `[[ $do_xxxx =~ ^(y|Y|)$ ]]`=> bash 正则表达式

## 超时 => 默认答案为否

```
do_xxxx=y
[[ -t 0 ]] && {                   # Timeout 5 seconds (read -t 5)
read -t 5 -n 1 -p $'\e[1;32m
Do xxxx? (Y/n)\e[0m ' do_xxxx ||  # read 'fails' on timeout
do_xxxx=n ; }                     # Timeout => answer No
if [[ $do_xxxx =~ ^(y|Y|)$ ]]
then
    xxxx
fi 
```

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2016-03-03T21:22:12.060

以最少的行数实现此目的的最简单方法如下：

```
read -p "<Your Friendly Message here> : y/n/cancel" CONDITION;

if [ "$CONDITION" == "y" ]; then
   # do something here!
fi 
```

这`if`只是一个示例：如何处理此变量取决于您。

* * *

## 回答 #11

> 赞同：23
> 
> 时间：2012-05-09T00:00:10.137

使用`read`命令：

```
echo Would you like to install? "(Y or N)"

read x

# now check if $x is "y"
if [ "$x" = "y" ]; then
    # do something here!
fi 
```

然后是你需要的所有其他东西

* * *

## 回答 #12

> 赞同：21
> 
> 时间：2013-11-15T07:04:18.193

此解决方案读取单个字符并在是响应时调用函数。

```
read -p "Are you sure? (y/n) " -n 1
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    do_something      
fi 
```

* * *

## 回答 #13

> 赞同：18
> 
> 时间：2014-04-06T11:40:47.603

要获得类似 ncurses 的漂亮输入框，请使用如下命令***对话框***：

```
#!/bin/bash
if (dialog --title "Message" --yesno "Want to do something risky?" 6 25)
# message box will have the size 25x6 characters
then 
    echo "Let's do something risky"
    # do something risky
else 
    echo "Let's stay boring"
fi 
```

对话框包至少在 SUSE Linux 中默认安装。好像： [![这](https://i.stack.imgur.com/UExu9.png)](https://i.stack.imgur.com/UExu9.png)

* * *

## 回答 #14

> 赞同：18
> 
> 时间：2019-08-31T15:06:15.577

可以在 POSIX shell 中处理区域设置感知的“是/否选择”；通过使用`LC_MESSAGES`locale 类别的条目，witch 提供现成的 RegEx 模式来匹配输入，以及本地化 Yes No 的字符串。

```
#!/usr/bin/env sh

# Getting LC_MESSAGES values into variables
# shellcheck disable=SC2046 # Intended IFS splitting
IFS='
' set -- $(locale LC_MESSAGES)

yesexpr="$1"
noexpr="$2"
yesstr="$3"
nostr="$4"
messages_codeset="$5" # unused here, but kept as documentation

# Display Yes / No ? prompt into locale
echo "$yesstr / $nostr ?"

# Read answer
read -r yn

# Test answer
case "$yn" in
# match only work with the character class from the expression
  ${yesexpr##^}) echo "answer $yesstr" ;;
  ${noexpr##^}) echo "answer $nostr" ;;
esac 
```

编辑：正如[@Urhixidur](/users/1046421/urhixidur)在[他的评论](/questions/226703/how-do-i-prompt-for-yes-no-cancel-input-in-a-linux-shell-script/57739142?noredirect=1#comment105493248_57739142)中提到的：

> 不幸的是，POSIX 只指定了前两个（yesexpr 和 noexpr）。在 Ubuntu 16 上，yesstr 和 nostr 为空。

见：[https ://www.ee.ryerson.ca/~courses/ele709/susv4/xrat/V4_xbd_chap07.html#tag_21_07_03_06](https://www.ee.ryerson.ca/~courses/ele709/susv4/xrat/V4_xbd_chap07.html#tag_21_07_03_06)

> ### LC_MESSAGES
> 
> **`yesstr`**and **`nostr`**locale 关键字和`YESSTR`and `NOSTR`langinfo 项以前用于匹配用户的肯定和否定响应。在 POSIX.1-2008 中**`yesexpr`**，**`noexpr`**, `YESEXPR`, 和`NOEXPR`扩展的正则表达式已经取代了它们。应用程序应该使用通用的基于语言环境的消息传递工具来发出提示消息，其中包括示例所需的响应。

或者使用 Bash 方式的语言环境：

```
#!/usr/bin/env bash

IFS=$'\n' read -r -d '' yesexpr noexpr _ < <(locale LC_MESSAGES)

printf -v yes_or_no_regex "(%s)|(%s)" "$yesexpr" "$noexpr"

printf -v prompt $"Please answer Yes (%s) or No (%s): " "$yesexpr" "$noexpr"

declare -- answer=;

until [[ "$answer" =~ $yes_or_no_regex ]]; do
  read -rp "$prompt" answer
done

if [[ -n "${BASH_REMATCH[1]}" ]]; then
  echo $"You answered: Yes"
else
  echo $"No, was your answer."
fi 
```

答案是使用语言环境提供的正则表达式匹配的。

要翻译剩余的消息，请使用`bash --dump-po-strings scriptname`输出 po 字符串以进行本地化：

```
#: scriptname:8
msgid "Please answer Yes (%s) or No (%s): "
msgstr ""
#: scriptname:17
msgid "You answered: Yes"
msgstr ""
#: scriptname:19
msgid "No, was your answer."
msgstr "" 
```

* * *

## 回答 #15

> 赞同：15
> 
> 时间：2014-05-21T11:22:51.550

就我而言，我需要从下载的脚本中读取，即`curl -Ss https://example.com/installer.sh | sh`

这条线`read yesno < /dev/tty`成功了

```
echo -n "These files will be uploaded. Is this ok? (y/n) "
read yesno < /dev/tty

if [ "x$yesno" = "xy" ];then

   # Yes
else

   # No
fi 
```

* * *

## 回答 #16

> 赞同：13
> 
> 时间：2018-06-28T08:39:11.863

## 仅单次按键

这是一种更长但可重用且模块化的方法：

*   返回`0`=yes 和`1`=no
*   无需按 Enter - 只需一个字符
*   可以按`enter`接受默认选择
*   可以禁用默认选择以强制选择
*   适用于`zsh`和`bash`。

### 按回车时默认为“否”

请注意，`N`是大写的。这里输入被按下，接受默认值：

```
$ confirm "Show dangerous command" && echo "rm *"
Show dangerous command [y/N]? 
```

另请注意，这`[y/N]?`是自动附加的。接受默认的“否”，因此不会回显任何内容。

**重新提示直到给出有效响应：**

```
$ confirm "Show dangerous command" && echo "rm *"
Show dangerous command [y/N]? X
Show dangerous command [y/N]? y
rm * 
```

### 按回车时默认为“是”

请注意，`Y`大写：

```
$ confirm_yes "Show dangerous command" && echo "rm *"
Show dangerous command [Y/n]?
rm * 
```

上面，我只是按了回车，所以命令运行了。

### 没有默认值`enter`- 要求`y`或`n`

```
$ get_yes_keypress "Here you cannot press enter. Do you like this [y/n]? "
Here you cannot press enter. Do you like this [y/n]? k
Here you cannot press enter. Do you like this [y/n]?
Here you cannot press enter. Do you like this [y/n]? n
$ echo $?
1 
```

在这里，`1`或者 false 被返回。请注意，使用此较低级别的功能，您需要提供自己的`[y/n]?`提示。

### 代码

```
# Read a single char from /dev/tty, prompting with "$*"
# Note: pressing enter will return a null string. Perhaps a version terminated with X and then remove it in caller?
# See https://unix.stackexchange.com/a/367880/143394 for dealing with multi-byte, etc.
function get_keypress {
  local REPLY IFS=
  >/dev/tty printf '%s' "$*"
  [[ $ZSH_VERSION ]] && read -rk1  # Use -u0 to read from STDIN
  # See https://unix.stackexchange.com/q/383197/143394 regarding '\n' -> ''
  [[ $BASH_VERSION ]] && </dev/tty read -rn1
  printf '%s' "$REPLY"
}

# Get a y/n from the user, return yes=0, no=1 enter=$2
# Prompt using $1.
# If set, return $2 on pressing enter, useful for cancel or defualting
function get_yes_keypress {
  local prompt="${1:-Are you sure [y/n]? }"
  local enter_return=$2
  local REPLY
  # [[ ! $prompt ]] && prompt="[y/n]? "
  while REPLY=$(get_keypress "$prompt"); do
    [[ $REPLY ]] && printf '\n' # $REPLY blank if user presses enter
    case "$REPLY" in
      Y|y)  return 0;;
      N|n)  return 1;;
      '')   [[ $enter_return ]] && return "$enter_return"
    esac
  done
}

# Credit: http://unix.stackexchange.com/a/14444/143394
# Prompt to confirm, defaulting to NO on <enter>
# Usage: confirm "Dangerous. Are you sure?" && rm *
function confirm {
  local prompt="${*:-Are you sure} [y/N]? "
  get_yes_keypress "$prompt" 1
}    

# Prompt to confirm, defaulting to YES on <enter>
function confirm_yes {
  local prompt="${*:-Are you sure} [Y/n]? "
  get_yes_keypress "$prompt" 0
} 
```

* * *

## 回答 #17

> 赞同：13
> 
> 时间：2018-12-12T15:50:31.197

`REPLY`您可以在 a 上使用默认值`read`，将其转换为小写，并使用表达式与一组变量进行比较。
该脚本还支持`ja`//`si``oui`

```
read -rp "Do you want a demo? [y/n/c] "

[[ ${REPLY,,} =~ ^(c|cancel)$ ]] && { echo "Selected Cancel"; exit 1; }

if [[ ${REPLY,,} =~ ^(y|yes|j|ja|s|si|o|oui)$ ]]; then
   echo "Positive"
fi 
```

* * *

## 回答 #18

> 赞同：12
> 
> 时间：2015-04-19T00:37:02.253

```
read -e -p "Enter your choice: " choice 
```

该`-e`选项使用户能够使用箭头键编辑输入。

如果您想使用建议作为输入：

```
read -e -i "yes" -p "Enter your choice: " choice 
```

`-i`选项打印提示性输入。

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2016-12-08T07:42:38.420

我注意到没有人针对如此简单的用户输入发布显示多行回显菜单的答案，所以这是我的尝试：

```
#!/bin/bash

function ask_user() {    

echo -e "
#~~~~~~~~~~~~#
| 1.) Yes    |
| 2.) No     |
| 3.) Quit   |
#~~~~~~~~~~~~#\n"

read -e -p "Select 1: " choice

if [ "$choice" == "1" ]; then

    do_something

elif [ "$choice" == "2" ]; then

    do_something_else

elif [ "$choice" == "3" ]; then

    clear && exit 0

else

    echo "Please select 1, 2, or 3." && sleep 3
    clear && ask_user

fi
}

ask_user 
```

发布此方法是希望有人会发现它有用且节省时间。

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2021-03-01T10:47:25.467

检查这个

```
read -p "Continue? (y/n): " confirm && [[ $confirm == [yY] || $confirm == [yY][eE][sS] ]] || exit 1 
```

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2013-12-28T17:50:02.830

多选版本：

```
ask () {                        # $1=question $2=options
    # set REPLY
    # options: x=..|y=..
    while $(true); do
        printf '%s [%s] ' "$1" "$2"
        stty cbreak
        REPLY=$(dd if=/dev/tty bs=1 count=1 2> /dev/null)
        stty -cbreak
        test "$REPLY" != "$(printf '\n')" && printf '\n'
        (
            IFS='|'
            for o in $2; do
                if [ "$REPLY" = "${o%%=*}" ]; then
                    printf '\n'
                    break
                fi
            done
        ) | grep ^ > /dev/null && return
    done
} 
```

例子：

```
$ ask 'continue?' 'y=yes|n=no|m=maybe'
continue? [y=yes|n=no|m=maybe] g
continue? [y=yes|n=no|m=maybe] k
continue? [y=yes|n=no|m=maybe] y
$ 
```

它将设置`REPLY`为`y`（在脚本内）。

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2015-01-08T00:40:48.980

受@Mark 和@Myrddin 答案的启发，我为通用提示创建了这个函数

```
uniprompt(){
    while true; do
        echo -e "$1\c"
        read opt
        array=($2)
        case "${array[@]}" in  *"$opt"*) eval "$3=$opt";return 0;; esac
        echo -e "$opt is not a correct value\n"
    done
} 
```

像这样使用它：

```
unipromtp "Select an option: (a)-Do one (x)->Do two (f)->Do three : " "a x f" selection
echo "$selection" 
```

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2021-10-22T07:18:12.067

单线：

```
read -p "Continue? [Enter] → Yes, [Ctrl]+[C] → No." 
```

这假设“否”和“取消”具有相同的结果，因此没有理由区别对待它们。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2015-07-29T11:39:09.210

更通用的是：

```
function menu(){
    title="Question time"
    prompt="Select:"
    options=("Yes" "No" "Maybe")
    echo "$title"
    PS3="$prompt"
    select opt in "${options[@]}" "Quit/Cancel"; do
        case "$REPLY" in
            1 ) echo "You picked $opt which is option $REPLY";;
            2 ) echo "You picked $opt which is option $REPLY";;
            3 ) echo "You picked $opt which is option $REPLY";;
            $(( ${#options[@]}+1 )) ) clear; echo "Goodbye!"; exit;;
            *) echo "Invalid option. Try another one.";continue;;
         esac
     done
     return
} 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2008-10-22T17:14:15.613

我建议你[使用对话框](http://www.linuxjournal.com/article/2460)...

> ### [Linux 学徒：使用对话框改进 Bash Shell 脚本](http://www.linuxjournal.com/article/2460)
> 
> dialog 命令允许在 shell 脚本中使用窗口框，以使它们的使用更具交互性。

它简单易用，还有一个名为 gdialog 的 gnome 版本，它采用完全相同的参数，但在 X 上显示了 GUI 样式。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2013-09-23T20:59:34.500

```
yn() {
  if [[ 'y' == `read -s -n 1 -p "[y/n]: " Y; echo $Y` ]];
  then eval $1;
  else eval $2;
  fi }
yn 'echo yes' 'echo no'
yn 'echo absent no function works too!' 
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2015-04-08T19:30:25.977

一种简单的方法是使用`xargs -p`or gnu `parallel --interactive`。

我更喜欢 xargs 的行为，因为它像其他交互式 unix 命令一样在提示符后立即执行每个命令，而不是收集 yesses 以在最后运行。（你可以通过你想要的那些后按Ctrl-C。）

例如，

```
echo *.xml | xargs -p -n 1 -J {} mv {} backup/ 
```

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2015-06-04T19:03:07.030

作为单行命令的朋友，我使用了以下命令：

```
while [ -z $prompt ]; do read -p "Continue (y/n)?" choice;case "$choice" in y|Y ) prompt=true; break;; n|N ) exit 0;; esac; done; prompt=; 
```

书面长格式，它的工作原理是这样的：

```
while [ -z $prompt ];
  do read -p "Continue (y/n)?" choice;
  case "$choice" in
    y|Y ) prompt=true; break;;
    n|N ) exit 0;;
  esac;
done;
prompt=; 
```

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2016-11-08T09:38:01.127

在这种情况下，我已经`case`多次使用该语句，使用 case 语句是一个很好的方法。可以实现一个使用布尔条件封装块的`while`循环，`case`以便对程序进行更多控制，并满足许多其他要求。在满足所有条件后，`break`可以使用 a 将控制权交还给程序的主要部分。此外，为了满足其他条件，当然可以添加条件语句来伴随控制结构：`case`语句和可能的`while`循环。

使用`case`语句来满足您的请求的示例

```
#! /bin/sh 

# For potential users of BSD, or other systems who do not
# have a bash binary located in /bin the script will be directed to
# a bourne-shell, e.g. /bin/sh

# NOTE: It would seem best for handling user entry errors or
# exceptions, to put the decision required by the input 
# of the prompt in a case statement (case control structure), 

echo Would you like us to perform the option: "(Y|N)"

read inPut

case $inPut in
    # echoing a command encapsulated by 
    # backticks (``) executes the command
    "Y") echo `Do something crazy`
    ;;
    # depending on the scenario, execute the other option
    # or leave as default
    "N") echo `execute another option`
    ;;
esac

exit 
```

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2017-07-14T20:13:08.317

# 是/否/取消

### 功能

```
#!/usr/bin/env bash
@confirm() {
  local message="$*"
  local result=''

  echo -n "> $message (Yes/No/Cancel) " >&2

  while [ -z "$result" ] ; do
    read -s -n 1 choice
    case "$choice" in
      y|Y ) result='Y' ;;
      n|N ) result='N' ;;
      c|C ) result='C' ;;
    esac
  done

  echo $result
} 
```

### 用法

```
case $(@confirm 'Confirm?') in
  Y ) echo "Yes" ;;
  N ) echo "No" ;;
  C ) echo "Cancel" ;;
esac 
```

# 使用干净的用户输入进行确认

### 功能

```
#!/usr/bin/env bash
@confirm() {
  local message="$*"
  local result=3

  echo -n "> $message (y/n) " >&2

  while [[ $result -gt 1 ]] ; do
    read -s -n 1 choice
    case "$choice" in
      y|Y ) result=0 ;;
      n|N ) result=1 ;;
    esac
  done

  return $result
} 
```

### 用法

```
if @confirm 'Confirm?' ; then
  echo "Yes"
else
  echo "No"
fi 
```

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2020-04-07T00:27:58.523

这是我通常在脚本/函数中需要的：

*   默认答案是 Yes，如果你按 ENTER
*   也接受 z （如果你混淆了你在 QWERTZ 布局上）
*   接受其他语言（“ja”，“Oui”，...）
*   如果您在函数内，请处理正确的出口

```
while true; do
    read -p "Continue [Y/n]? " -n 1 -r -e yn
    case "${yn:-Y}" in
        [YyZzOoJj]* ) echo; break ;;
        [Nn]* ) [[ "$0" = "$BASH_SOURCE" ]] && exit 1 || return 1 ;; # handle exits from shell or function but don't exit interactive shell
        * ) echo "Please answer yes or no.";;
    esac
done
echo "and off we go!" 
```

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2020-12-03T00:33:37.587

绝对最简单的解决方案是这个没有巧妙技巧的单线：

```
read -p "press enter ..." y 
```

它让人想起经典的 DOS `Hit any key to continue`，除了它等待 Enter 键，而不仅仅是任何键。

诚然，这并没有为您提供 Yes No Cancel 的三个选项，但在您接受 control-C 作为 No resp 时它很有用。在简单的脚本中取消，例如：

```
#!/bin/sh
echo Backup this project
read -p "press enter ..." y
rsync -tavz . /media/hard_to_remember_path/backup/projects/yourproject/ 
```

因为您不喜欢记住丑陋的命令和路径，但既不记住运行速度过快的脚本，也不给您机会在您确定它不是您打算运行的脚本之前停下来。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2018-05-20T03:09:41.247

回应别人：

您不需要在 BASH4 中指定大小写，只需使用 ',,' 将 var 设为小写即可。此外，我非常不喜欢将代码放在读取块内，获取结果并在读取块 IMO 之外处理它。还包括退出 IMO 的“q”。最后，为什么键入“是”只需使用 -n1 并按 y。

示例：用户可以按 y/n 也可以按 q 退出。

```
ans=''
while true; do
    read -p "So is MikeQ the greatest or what (y/n/q) ?" -n1 ans
    case ${ans,,} in
        y|n|q) break;;
        *) echo "Answer y for yes / n for no  or q for quit.";;
    esac
done

echo -e "\nAnswer = $ans"

if [[ "${ans,,}" == "q" ]] ; then
        echo "OK Quitting, we will assume that he is"
        exit 0
fi

if [[ "${ans,,}" == "y" ]] ; then
        echo "MikeQ is the greatest!!"
else
        echo "No? MikeQ is not the greatest?"
fi 
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2021-10-08T12:13:13.640

我为是/否问题制作了这个小脚本：[https ://github.com/optimistiCli/getans](https://github.com/optimistiCli/getans)

例子：

```
#!/bin/bash

if ! getans.sh 'Shall we proceed?' y ; then
    echo "User said “NO”&quot;
    exit 1
fi

echo "User said “YES”&quot;
# do something usefull
exit 0 
```

直接链接： [https ://github.com/optimistiCli/getans/raw/main/getans.sh](https://github.com/optimistiCli/getans/raw/main/getans.sh)

# email - 电子邮件召回真的有效吗？

> ID：226704
> 
> 赞同：0
> 
> 时间：2008-10-22T17:04:42.840
> 
> 标签：email

我被要求回忆我发送的一条消息，以从中删除一些个人信息并用一个普通的虚构人物替换它作为示例。

消息召回真的有效吗？

这是我的观点，因为您被告知一条消息已被召回，这只会使您想找出原始消息中的内容。你要做的就是找到一个已经读过它的人。

可以调整交换服务器以在撤回或替换消息时不通知用户吗？

密件抄送怎么办，召回似乎不适用于这些，而全球电子邮件往往是您真正需要召回的电子邮件。

**编辑**此外，现在很常见的智能手机的人似乎也没有从他们的手机中检索到电子邮件

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-22T17:09:17.620

在大多数情况下，为时已晚，它只是让我知道有一封您不想让我阅读的电子邮件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-22T17:09:56.713

仅适用于未打开的邮件，适用于 MS Exchange/Outlook 用户。

阅读[此博客文章和评论](http://mamchenkov.net/wordpress/2006/10/11/you-cant-recall-an-email/)以获取更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T17:19:41.233

补充一点信息，如果消息显示在预览窗格中，则认为已阅读无法回忆。

昨天我们做了一些测试，发现召回功能非常糟糕。如上所述，只有在未读（或未预览）时才会调用它。在已经阅读的情况下，召回只会使信息更加*明显*。目前还没有达到预期的效果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T17:05:51.043

仅适用于未打开的邮件，位于您发送邮件的服务器本地。（据我所知，我想它也可以在服务器场/集群上工作？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-22T17:55:28.930

如果收件人处于脱机状态并且 Exchange 服务器未将邮件传递到他的 PST，则 RECALL 工作并且您相应地收到邮件。

谢谢和问候， 阿杰

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-20T18:02:22.143

是的，召回此邮件 Outlook 功能确实经常不起作用。

WinDeveloper 刚刚发布了 Excahnge 2007/2010 的服务器端解决方案。它同样适用于发送给本地收件人的电子邮件和发送给外国收件人的电子邮件。更多细节：

WinDeveloper vs Native Exchange 消息调用 [http://www.windeveloper.com/recall/recall_features.htm](http://www.windeveloper.com/recall/recall_features.htm)

消息召回有效！这是 [http://www.windeveloper.com/recall/recall_howitworks.htm](http://www.windeveloper.com/recall/recall_howitworks.htm)

# visual-studio - 我们如何在 Visual Studio 构建过程中显示“步骤”？

> ID：226717
> 
> 赞同：7
> 
> 时间：2008-10-22T17:07:25.063
> 
> 标签：visual-studio, tfs, build-process, build-automation

当您从 Visual Studio（2008 或 2005）监视 TFS 构建时，您可以看到它在哪里。

问题是我有一些构建后自定义步骤，我希望开发人员能够直接通过 UI 看到。这些步骤需要一些时间，我们还可以获得构建步骤的“时间”。

知道如何显示它吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-22T18:42:20.317

这是我通常用于在 TFS 2008 中向构建报告添加步骤的模式。（请参阅[http://code.msdn.microsoft.com/buildwallboard/](http://code.msdn.microsoft.com/buildwallboard/)了解我通常在 Team Build 会谈中使用的完整示例）

基本上，神奇的是在 TFS2008 中为您提供了一个名为“BuildStep”的自定义任务。这是我生成和 MSI 安装程序并在报告中构建适当构建步骤的部分：

```
 <Target Name="PackageBinaries">

    <!-- create the build step -->
    <BuildStep TeamFoundationServerUrl="$(TeamFoundationServerUrl)"
               BuildUri="$(BuildUri)"
               Message="Creating Installer"
               Condition=" '$(IsDesktopBuild)' != 'true' " >
      <Output TaskParameter="Id"
              PropertyName="InstallerStepId" />
    </BuildStep>

    <!-- Create the MSI file using WiX -->
    <MSBuild Projects="$(SolutionRoot)\SetupProject\wallboard.wixproj"
  Properties="BinariesSource=$(OutDir);PublishDir=$(BinariesRoot);Configuration=%(ConfigurationToBuild.FlavourToBuild)" >
    </MSBuild>

    <!-- If we sucessfully built the installer, tell TFS -->
    <BuildStep TeamFoundationServerUrl="$(TeamFoundationServerUrl)"
               BuildUri="$(BuildUri)"
               Id="$(InstallerStepId)"
               Status="Succeeded"
               Condition=" '$(IsDesktopBuild)' != 'true' " />

    <!-- Note that the condition above means that we do not talk to TFS when doing a Desktop Build -->

    <!-- If we error during this step, then tell TFS we failed-->
    <OnError   ExecuteTargets="MarkInstallerFailed" />
  </Target>

  <Target Name="MarkInstallerFailed">
    <!-- Called by the PackageBinaries method if creating the installer fails -->
    <BuildStep TeamFoundationServerUrl="$(TeamFoundationServerUrl)"
               BuildUri="$(BuildUri)"
               Id="$(InstallerStepId)"
               Status="Failed"
               Condition=" '$(IsDesktopBuild)' != 'true' " />
  </Target> 
```

因此，最初，我创建了构建步骤并将步骤的 ID 保存在名为 InstallerStepId 的属性中。完成任务后，我将该步骤的状态设置为成功。如果在该步骤期间发生任何错误，那么我将该步骤的状态设置为“失败”。

祝你好运，

马丁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-08T17:31:17.043

请注意，在@Martin Woodward 的出色示例中，PackageBinaries 是现有的[TFS 构建目标](http://msdn.microsoft.com/en-us/library/aa337604%28v=VS.90%29.aspx)之一。如果您想使用自己的目标，可以使用[CallTarget](http://msdn.microsoft.com/en-us/library/ms229474%28v=VS.90%29.aspx)任务从已知目标之一调用它们，例如，

```
<Target Name="AfterDropBuild">
    <CallTarget Targets="CreateDelivery"/>
    <CallTarget Targets="CreateInventory"/>
</Target> 
```

然后在您的目标（例如，CreateDelivery）中按照 Martin 的示例使用 BuildStep 任务。

# java - 在struts2中为动态资源创建友好的url

> ID：226721
> 
> 赞同：0
> 
> 时间：2008-10-22T17:08:33.813
> 
> 标签：java, struts2, friendly-url

我有一个带有单个页面的 struts2 应用程序，该页面可能显示存储在数据库中的多个值之一。该申请适用于拥有许多部门的学校，每个部门都有许多课程。使用这样的 url 访问部门页面

```
department.action?id=2 
```

DepartmentAction 将加载 id = 2 的部门进行显示。如果用户只是浏览网站，这一切都很好，但如果我想在报纸上提供一个链接来说明工程部门，就会感到不舒服。该链接必须是 www.myschooldomain.com/department.action?id=2。我看到这有很多问题。

首先，它对用户不友好。其次，容易被破坏，因为部门是动态维护的，一个部门的id可能会在没有警告的情况下更改，导致链接不稳定。

我更喜欢打印这样的网址：www.myschooldomain.com/department/engineering 并以某种方式转到 department.action?id=2。

到目前为止，我的想法是：创建一个动作，在末尾解析部门名称的 url，然后按名称查找。也许我可以为每个部门的数据库添加一个friendlyurl 字段。

但问题是：在struts2中有没有更好的方法来做到这一点？

谢谢。

**更新（2009 年 5 月）：**我碰巧偶然发现了这个问题，并认为我会说出我为解决它所做的工作。

我在 struts.xml 中创建了一个名为部门的新包。在这个包中，只有一个动作映射到 *. 因此它会捕获对 mydomain.com/departments/anything.html 的所有请求。

在操作类中，我只是解析 url 并查找部门/ 和 .html 之间的部分，这是部门的名称，因此我可以在数据库中查找它。这已经运行了将近 5 个月，我已经在网站的其他区域实施了它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T12:53:53.230

您可以使用[URL 重写过滤器](http://tuckey.org/urlrewrite/)

这避免了对任何其他 servlet 或 Java 代码的需要，但需要 XML 描述符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T17:47:55.717

这通常通过将 servlet 映射到（在您的情况下为“/department”），然后使用 servlet 中的[路径](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/http/HttpServletRequest.html#getPathInfo())信息（例如，“/engineering”）来确定 ID 来完成。

由于 Struts2 调度程序没有实现这种行为，因此编写自己的 servlet 可能是最简单的。此 servlet 将配置有有效“友好”名称到不友好数字标识符的映射。这可以是实际的`Map`，也可以使用数据库查找器方法来完成。

的结果`getPathInfo()`将用于查找 ID，并将请求[转发](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/RequestDispatcher.html#forward(javax.servlet.ServletRequest,%20javax.servlet.ServletResponse))到 department.action。也处理这种`null`情况，这意味着用户正在尝试浏览`/departments/`目录。

# c# - .net 网络浏览器控件

> ID：226743
> 
> 赞同：2
> 
> 时间：2008-10-22T17:14:16.893
> 
> 标签：c#, .net

我在 Visual Studio 中使用 webbrowser 控件。我认为它是 Internet Explorer 的包装器。无论如何一切都很顺利我在编辑模式下使用它但是我不能让他文档的 keydown 事件触发（为了捕捉 ctrl+v）有人有类似的问题吗？

有人有解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T17:34:00.237

事实上，webbrowser 控件只是 IE 浏览器控件的包装。您的问题是控件 PreviewKeyDown 不起作用吗？只要控件有焦点，似乎对我有用。

```
 webBrowser1.PreviewKeyDown += new PreviewKeyDownEventHandler(webBrowser1_PreviewKeyDown);       

....

 private void webBrowser1_PreviewKeyDown(object sender, PreviewKeyDownEventArgs e) {
     Console.WriteLine(e.KeyCode.ToString() + "  " + e.Modifiers.ToString());
     if (e.Modifiers == Keys.Control && e.KeyCode == Keys.V) {
         MessageBox.Show("ctrl-v pressed");
     }
 } 
```

但也许我不完全理解？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T17:32:30.507

您应该在 WebBrowser 控件的派生类或包含 webbrowser 的表单中覆盖“WndProc()”方法。或者您可以使用自定义消息过滤器 ( Application.AddMessageFilter ) 捕获键。通过这种方式，您还可以过滤鼠标操作。

几年前我也遇到过同样的问题，但我不记得我用的是哪种方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T17:59:52.057

您提到了“文档”的 KeyDown 事件。如果您指的是 WebBrowser 控件的 Document 属性（类型 HtmlDocument），它只有 MouseUp、MouseDown 等事件，但没有键盘事件。您希望使用 WebBrowser 控件的 PreviewKeyDown 委托注册您的事件处理程序。如果您不希望标准 Internet Explorer 快捷方式具有通常的效果，您可能还希望将 WebBrowser 控件的 WebBrowserShortcutsEnabled 属性的值设置为 false。您还应该通过手动调用其 Focus() 方法并将窗体上其他控件的 TabStop 属性设置为 false 来确保 WebBrowser 控件处于焦点。如果这是不可能的，因为您在表单上有其他需要接受焦点的控件，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T23:06:15.573

[如何使用 Visual C# 捕获控件中的击键](http://support.microsoft.com/kb/320584)

例如

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)  
{  
   const int WM_KEYDOWN = 0x100;  
   const int WM_SYSKEYDOWN = 0x104;  

   if ((msg.Msg == WM_KEYDOWN) || (msg.Msg == WM_SYSKEYDOWN))  
   {  
      switch(keyData)  
      {  
         case Keys.Down:  
            this.Parent.Text="Down Arrow Captured";  
            break;  

...

      }  
   }  

   return base.ProcessCmdKey(ref msg,keyData);  
} 
```

# .net - 为什么 Convert.ToDouble(string) 圆？

> ID：226750
> 
> 赞同：3
> 
> 时间：2008-10-22T17:16:43.330
> 
> 标签：.net, string

例如，Convert.ToDouble("0.1234567890123456789") = 0.123456789012346

有效数字的最大数量是多少？在文档中找不到它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-22T17:20:40.530

当然有一个最大的精度。这是您可以用用于存储双精度的位表示的最大值。对于该字符串，您可以尝试使用 Decimal。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T17:19:47.567

来自[MSDN](http://msdn.microsoft.com/en-us/library/678hzkk9(VS.71).aspx)：

精度：15-16 位。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T17:23:33.723

如果您真的想了解浮点数的二进制表示，请参阅Wikipedia 上的[IEEE 754-1985](http://en.wikipedia.org/wiki/IEEE_754-1985)。

基本上，它是

`sign * 1.mantissa * 2^(exponent - bias)`

分配给尾数和指数字段的位数决定了数字的精度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T17:24:36.793

[http://en.wikipedia.org/wiki/Double_precision](http://en.wikipedia.org/wiki/Double_precision)

双精度数只有 64 位存储，其中一些用于符号和指数，因此小数部分的位数有限（通常为 15 位）。浮点数只有 32 位，因此精度为 8-9 位。此外，某些数字无法使用浮点数精确表示，因此您可能会在转换中看到一些舍入错误。

# windows - 用户创建挂载点时如何收到通知？

> ID：226758
> 
> 赞同：4
> 
> 时间：2008-10-22T17:20:56.473
> 
> 标签：windows, winapi

首先，这是约束：

*   必须在 XP 上运行
*   必须通知驱动器号分配和将卷安装到文件夹
*   如果驱动器处于睡眠状态，则不得“唤醒”驱动器。
*   我真的不想轮询驱动器。

我试过的：

1.  谷歌
2.  我查看了 WMI 和 Win32_LogicalDisk 类。我可以确定哪些驱动器已安装到驱动器号，但不能确定哪些驱动器已安装到文件夹。Win32_Volume* 和 Win32_MountPoint 类将是完美的，但在 XP 上不可用。
3.  我尝试使用 FindFirstVolume 和 GetVolumePathNamesForVolumeName 轮询驱动器（即使我不想那样做），但似乎必须先启动驱动器才能给我信息。再次，呃，轮询。

我正在考虑使用 API 挂钩来挂钩对 SetVolumeMountPoint 和 DeleteVolumeMountPoint 的调用的可能性，但我认为这不会捕获所有内容，而且看起来这可能是一个丑陋的黑客攻击。

所以，是的，我正在寻找建议:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T06:36:56.383

SetVolumeMountPoint 上的 API 挂钩应该让您拦截卷安装。不过，我不确定网络共享。

但这不会是一个“丑陋的黑客”。您正在尝试做的是 Windows 中内置的挂钩。Codeproject.com 有很棒的 AP​​I 挂钩教程：http: [//www.codeproject.com/KB/system/hooksys.aspx](http://www.codeproject.com/KB/system/hooksys.aspx)

所以你实际上陈述了你自己的最佳解决方案。请记住，还有一个单独的驱动器号 API：http: [//nukz.net/reference/fileio/hh/winbase/fsys_6j8z.htm](http://nukz.net/reference/fileio/hh/winbase/fsys_6j8z.htm)

Your project sounds interesting. Usually, trojans and anti-virus try to do this (and they also catch network shares.) I'm only casually familiar with the topic, so I hope this helps.

# silverlight - Silverlight 2 UI 模式

> ID：226760
> 
> 赞同：0
> 
> 时间：2008-10-22T17:21:44.380
> 
> 标签：silverlight, silverlight-2.0, mvp, ria

我必须在 Silverlight2 中构建小型（目前）管理应用程序，并且想使用一些模式将 UI 与我的 BL/DAL 绑定。
我发现了 view-model-viewmodel 和 mvp/mvc 模式，其中第一个（V/M/VM）特别适合 WPF 应用程序，因为它使用 WPF 数据绑定选项的丰富功能。你有什么建议？你能为 SL2 写一个简单的 V/M/VM 例子吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T17:27:44.930

Nikhil Kothari 在 Silverlight 中的 MV-VM 上有一组很棒的示例（带有代码），以及一个使用一些非常好的额外功能构建的框架。您绝对应该检查一下。 [Silverlight 中的 MV-VM](http://nikhilk.net/Silverlight-ViewModel-Pattern.aspx "Silverlight 中的 MV-VM")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T06:44:51.250

Microsoft 的 Patterns & Practices 小组针对[WPF 和 Silverlight](http://www.codeplex.com/CompositeWPF)应用程序提供了一些指导。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T18:49:02.410

您可能想查看[用于 Silverlight 的 CSLA.NET](http://www.lhotka.net/cslalight/)。我听说过关于它的好消息，但还没有亲自尝试过。

> Silverlight 的 CSLA .NET 是针对 Silverlight 平台的 CSLA .NET 的子集。Silverlight 的 CSLA .NET 提供了 Silverlight 上 CSLA .NET 的几乎所有优势，包括数据绑定、验证、业务规则、授权、n 级撤消和持久性。
> 
> 结果是用于 Silverlight 的 CSLA .NET 支持创建在 Silverlight 客户端上运行的丰富的面向对象的业务层，该业务层可以透明地与运行在 Web 和应用程序服务器上的 CSLA .NET 对象进行通信。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-01T13:02:18.820

Silverlight 还具有非常强大的数据绑定功能，因此没有问题。

Silverlight 中对模型-视图-视图模型模式影响更大的缺失部分是它没有实现像 WPF 这样的命令。[这](http://blogs.infragistics.com/blogs/joshs/archive/2008/11/17/putting-silverlight-commands-to-use.aspx)是 Josh Smith 的一篇文章，它再现了 Silverlight 中 WPF 的命令模式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-17T23:23:17.703

Wildermuth.com 的 Shawn Wildermuth 写了一篇关于 MV-VM 模式的文章，查看一下，这里是文章[“Model-View-ViewModel In Silverlight 2 Apps”的链接](http://tinyurl.com/cpwbxc)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-22T17:35:15.070

挪威开发人员 Gjøran 在 MSDN Live 上做了一个关于在 WPF 中编写业务应用程序的非常好的演示/演示。真的是关于使用带有 Silverlight/WPF 的演示模型。在他的博客上查看[这篇文章的源代码](http://blog.goeran.no/PermaLink,guid,5e9eb4c4-163d-47aa-bbba-753700e848da.aspx)（抱歉，这些幻灯片只有挪威语）。[演示模型](http://martinfowler.com/eaaDev/PresentationModel.html)+ silverlight 2 岩石！！！

# testing - Symbian 自动化测试工具

> ID：226767
> 
> 赞同：4
> 
> 时间：2008-10-22T17:25:04.607
> 
> 标签：testing, mobile, automated-tests, symbian, qa

您能否推荐任何能够在手机（或至少模拟器）上运行并模拟预定义（通过脚本）操作序列（例如“按下”键、“输入”数据等）的测试工具？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T17:51:44.397

这两个可能会有所帮助。但我认为他们将投入大量的时间和现金：

[测试任务](http://www.testquest.com/)

[迪贾](http://www.digia.com/C2256FEF0043E9C1/0/405001346)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-25T19:35:52.697

您可以在此 Mercurial 存储库中找到提到的 UserEmulator 工具 @teknolog、源代码和一个 sis 文件：oss+FCL+sftools+ana+testfw.hg

来自：http: [//sourceforge.net/projects/symbiandump/files/source/](http://sourceforge.net/projects/symbiandump/files/source/)

这里的一些文档： [http ://www.symlab.org/wiki/index.php/UserEmulator](http://www.symlab.org/wiki/index.php/UserEmulator)

YouTube 上有一段视频。

适用于 S60 第 3 版和第 5 版。我在诺基亚 E7 和 N8 (Symbian^3) 上对其进行了快速测试，但在尝试记录新测试时手机重新启动。至少它是开源的，因此您可以查看发生了什么，并且那里也有一些联系电子邮件地址。从好的方面来说，随机测试有效，您可以在其中输入应用程序的 UID，它会向设备发送随机按键和屏幕点击。完美的“猴子测试”！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-02T03:12:11.460

可用的商业工具非常昂贵。我们在我以前的工作中以及在我现在的公司中推出了自己的测试平台——这并不难（如果在 A 公司编写测试平台的两个人是 B 公司的创始人，这会有所帮助！）

如果您只关心模拟器，那么肯定有 Windows 记录/播放工具可以驱动任何应用程序吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-13T09:55:33.690

Orange 刚刚为 Symbian[贡献](http://blog.symbian.org/2009/09/30/the-useremulator-a-major-contribution-from-orange/)了一个[用户模拟器工具。](http://developer.symbian.org/wiki/index.php/UserEmulator)它适用于 S60 第 3 版和第 5 版以及 Symbian^1 及更高版本。您必须自己编译它，但它存在于从 Wiki 链接的公共存储库中。

# c# - 如何在 C# 中创建一个简单的代理？

> ID：226784
> 
> 赞同：147
> 
> 时间：2008-10-22T17:31:20.507
> 
> 标签：c#, .net, .net-2.0, proxy

几周前我下载了 Privoxy，为了好玩，我很想知道它的简单版本是如何完成的。

我了解我需要配置浏览器（客户端）以向代理发送请求。代理将请求发送到网络（假设它是一个 http 代理）。代理将收到答案......但是代理如何将请求发送回浏览器（客户端）？

我在网上搜索了 C# 和 http 代理，但没有找到让我了解它如何在幕后正确工作的东西。（我相信我不想要反向代理，但我不确定）。

你们有没有一些解释或一些信息可以让我继续这个小项目？

## 更新

这是我的理解（见下图）。

**第 1 步**我将客户端（浏览器）配置为将所有请求发送到代理侦听端口的 127.0.0.1。这样，请求不会直接发送到 Internet，而是由代理处理。

**Step2**代理看到一个新连接，读取 HTTP 标头并查看他必须执行的请求。他执行请求。

**Step3**代理收到请求的答复。现在他必须将答案从网络发送给客户端，但是如何？？？

![替代文字](https://i.stack.imgur.com/zNWDc.png)

### 有用的链接

[Mentalis 代理](http://www.mentalis.org/soft/projects/proxy/)：我发现这个项目是一个代理（但我想要更多）。我可能会检查来源，但我真的想要一些基本的东西来理解更多的概念。

[ASP 代理](http://www.codeproject.com/KB/aspnet/asproxy.aspx)：我也可以在这里获得一些信息。

[请求反射器](http://bartdesmet.net/blogs/bart/archive/2007/02/22/httplistener-for-dummies-a-simple-http-request-reflector.aspx)：这是一个简单的例子。

这是一个[带有简单 Http 代理的 Git Hub 存储库](https://github.com/MrDesjardins/SimpleHttpProxy)。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-04-30T11:05:34.560

我不会使用 HttpListener 或类似的东西，那样你会遇到很多问题。

最重要的是，支持将是一个巨大的痛苦：

*   代理保活
*   SSL 不起作用（以正确的方式，你会得到弹出窗口）
*   .NET 库严格遵循 RFC，这会导致某些请求失败（即使 IE、FF 和世界上任何其他浏览器都可以使用。）

你需要做的是：

*   监听 TCP 端口
*   解析浏览器请求
*   提取主机以 TCP 级别连接到该主机
*   除非您想添加自定义标题等，否则来回转发所有内容。

我在 .NET 中编写了 2 个具有不同要求的不同 HTTP 代理，我可以告诉你这是最好的方法。

Mentalis 这样做，但他们的代码是“代表意大利面条”，比 GoTo 更糟糕 :)

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-10-22T17:34:06.587

您可以使用该类构建一个[`HttpListener`](http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx)以侦听传入请求，并使用[`HttpWebRequest`](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)该类来中继请求。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2015-01-06T02:10:40.367

[我最近使用TcpListener](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener%28v=vs.110%29.aspx)和[TcpClient](https://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient(v=vs.110).aspx)在 c# .net 中编写了一个轻量级代理。

[https://github.com/titanium007/Titanium-Web-Proxy](https://github.com/titanium007/Titanium-Web-Proxy)

它以正确的方式支持安全 HTTP，客户端机器需要信任代理使用的根证书。还支持 WebSockets 中继。除流水线外，支持 HTTP 1.1 的所有功能。无论如何，大多数现代浏览器都不使用流水线。还支持 Windows 身份验证（普通、摘要）。

您可以通过引用项目来连接您的应用程序，然后查看和修改所有流量。（请求和响应）。

就性能而言，我已经在我的机器上对其进行了测试，并且没有任何明显的延迟。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-04-30T10:55:59.203

代理可以通过以下方式工作。

Step1，配置客户端使用proxyHost:proxyPort。

代理是侦听 proxyHost:proxyPort 的 TCP 服务器。浏览器打开与 Proxy 的连接并发送 Http 请求。代理解析此请求并尝试检测“主机”标头。此标头将告诉代理在哪里打开连接。

第 2 步：代理打开到“主机”标头中指定的地址的连接。然后它将 HTTP 请求发送到该远程服务器。读取响应。

第 3 步：从远程 HTTP 服务器读取响应后，代理通过较早打开的与浏览器的 TCP 连接发送响应。

从示意图上看，它将如下所示：

```
Browser                            Proxy                     HTTP server
  Open TCP connection  
  Send HTTP request  ----------->                       
                                 Read HTTP header
                                 detect Host header
                                 Send request to HTTP ----------->
                                 Server
                                                      <-----------
                                 Read response and send
                   <-----------  it back to the browser
Render content 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2012-06-20T15:44:26.550

如果你只是想拦截流量，你可以使用提琴手核心来创建一个代理......

[http://fiddler.wikidot.com/fiddlercore](http://fiddler.wikidot.com/fiddlercore)

首先使用 UI 运行 fiddler 以查看它的作用，它是一个代理，允许您调试 http/https 流量。它是用 c# 编写的，并且有一个核心，您可以将其构建到您自己的应用程序中。

请记住，FiddlerCore 对商业应用程序不是免费的。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-09-08T17:32:24.967

同意 dr evil 如果你使用 HTTPListener 你会遇到很多问题，你必须解析请求并且会参与到标题和......

1.  使用 tcp listener 监听浏览器请求

2.  仅解析请求的第一行并获取要连接的主机域和端口
3.  在浏览器请求的第一行向找到的主机发送确切的原始请求
4.  从目标站点接收数据（我在这部分有问题）
5.  将从主机接收到的确切数据发送到浏览器

您会看到您甚至不需要知道浏览器请求中的内容并对其进行解析，只需从第一行获取目标站点地址，第一行通常喜欢这个 GET [http://google.com](http://google.com) HTTP1.1 或 CONNECT facebook.com： 443（这是用于 ssl 请求）

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-01-19T12:34:00.107

使用 OWIN 和 WebAPI，事情变得非常简单。在我搜索 C# 代理服务器时，我还看到了这篇文章[http://blog.kloud.com.au/2013/11/24/do-it-yourself-web-api-proxy/](http://blog.kloud.com.au/2013/11/24/do-it-yourself-web-api-proxy/)。这将是我要走的路。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-06-15T15:20:38.453

Socks4 是一个实现起来非常简单的协议。您侦听初始连接，连接到客户端请求的主机/端口，将成功代码发送到客户端，然后通过套接字转发传出和传入流。

如果您使用 HTTP，则必须阅读并可能设置/删除一些 HTTP 标头，这样就需要做更多的工作。

如果我没记错的话，SSL 可以跨 HTTP 和 Socks 代理工作。对于 HTTP 代理，您实现 CONNECT 动词，其工作方式与上述 socks4 非常相似，然后客户端通过代理的 tcp 流打开 SSL 连接。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-09-21T09:52:11.233

对于它的价值，这是一个基于[HttpListener](https://docs.microsoft.com/en-us/dotnet/api/system.net.httplistener?view=netframework-4.8)和[HttpClient](https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient?view=netframework-4.8)的 C# 示例异步实现（我使用它能够将 Android 设备中的 Chrome 连接到 IIS Express，这是我找到的唯一方法......）。

如果你需要 HTTPS 支持，它不应该需要更多的代码，只需要证书配置：[Httplistener with HTTPS support](https://stackoverflow.com/questions/11403333/httplistener-with-https-support)

```
// define http://localhost:5000 and http://127.0.0.1:5000/ to be proxies for http://localhost:53068
using (var server = new ProxyServer("http://localhost:53068", "http://localhost:5000/", "http://127.0.0.1:5000/"))
{
    server.Start();
    Console.WriteLine("Press ESC to stop server.");
    while (true)
    {
        var key = Console.ReadKey(true);
        if (key.Key == ConsoleKey.Escape)
            break;
    }
    server.Stop();
}

....

public class ProxyServer : IDisposable
{
    private readonly HttpListener _listener;
    private readonly int _targetPort;
    private readonly string _targetHost;
    private static readonly HttpClient _client = new HttpClient();

    public ProxyServer(string targetUrl, params string[] prefixes)
        : this(new Uri(targetUrl), prefixes)
    {
    }

    public ProxyServer(Uri targetUrl, params string[] prefixes)
    {
        if (targetUrl == null)
            throw new ArgumentNullException(nameof(targetUrl));

        if (prefixes == null)
            throw new ArgumentNullException(nameof(prefixes));

        if (prefixes.Length == 0)
            throw new ArgumentException(null, nameof(prefixes));

        RewriteTargetInText = true;
        RewriteHost = true;
        RewriteReferer = true;
        TargetUrl = targetUrl;
        _targetHost = targetUrl.Host;
        _targetPort = targetUrl.Port;
        Prefixes = prefixes;

        _listener = new HttpListener();
        foreach (var prefix in prefixes)
        {
            _listener.Prefixes.Add(prefix);
        }
    }

    public Uri TargetUrl { get; }
    public string[] Prefixes { get; }
    public bool RewriteTargetInText { get; set; }
    public bool RewriteHost { get; set; }
    public bool RewriteReferer { get; set; } // this can have performance impact...

    public void Start()
    {
        _listener.Start();
        _listener.BeginGetContext(ProcessRequest, null);
    }

    private async void ProcessRequest(IAsyncResult result)
    {
        if (!_listener.IsListening)
            return;

        var ctx = _listener.EndGetContext(result);
        _listener.BeginGetContext(ProcessRequest, null);
        await ProcessRequest(ctx).ConfigureAwait(false);
    }

    protected virtual async Task ProcessRequest(HttpListenerContext context)
    {
        if (context == null)
            throw new ArgumentNullException(nameof(context));

        var url = TargetUrl.GetComponents(UriComponents.SchemeAndServer, UriFormat.Unescaped);
        using (var msg = new HttpRequestMessage(new HttpMethod(context.Request.HttpMethod), url + context.Request.RawUrl))
        {
            msg.Version = context.Request.ProtocolVersion;

            if (context.Request.HasEntityBody)
            {
                msg.Content = new StreamContent(context.Request.InputStream); // disposed with msg
            }

            string host = null;
            foreach (string headerName in context.Request.Headers)
            {
                var headerValue = context.Request.Headers[headerName];
                if (headerName == "Content-Length" && headerValue == "0") // useless plus don't send if we have no entity body
                    continue;

                bool contentHeader = false;
                switch (headerName)
                {
                    // some headers go to content...
                    case "Allow":
                    case "Content-Disposition":
                    case "Content-Encoding":
                    case "Content-Language":
                    case "Content-Length":
                    case "Content-Location":
                    case "Content-MD5":
                    case "Content-Range":
                    case "Content-Type":
                    case "Expires":
                    case "Last-Modified":
                        contentHeader = true;
                        break;

                    case "Referer":
                        if (RewriteReferer && Uri.TryCreate(headerValue, UriKind.Absolute, out var referer)) // if relative, don't handle
                        {
                            var builder = new UriBuilder(referer);
                            builder.Host = TargetUrl.Host;
                            builder.Port = TargetUrl.Port;
                            headerValue = builder.ToString();
                        }
                        break;

                    case "Host":
                        host = headerValue;
                        if (RewriteHost)
                        {
                            headerValue = TargetUrl.Host + ":" + TargetUrl.Port;
                        }
                        break;
                }

                if (contentHeader)
                {
                    msg.Content.Headers.Add(headerName, headerValue);
                }
                else
                {
                    msg.Headers.Add(headerName, headerValue);
                }
            }

            using (var response = await _client.SendAsync(msg).ConfigureAwait(false))
            {
                using (var os = context.Response.OutputStream)
                {
                    context.Response.ProtocolVersion = response.Version;
                    context.Response.StatusCode = (int)response.StatusCode;
                    context.Response.StatusDescription = response.ReasonPhrase;

                    foreach (var header in response.Headers)
                    {
                        context.Response.Headers.Add(header.Key, string.Join(", ", header.Value));
                    }

                    foreach (var header in response.Content.Headers)
                    {
                        if (header.Key == "Content-Length") // this will be set automatically at dispose time
                            continue;

                        context.Response.Headers.Add(header.Key, string.Join(", ", header.Value));
                    }

                    var ct = context.Response.ContentType;
                    if (RewriteTargetInText && host != null && ct != null &&
                        (ct.IndexOf("text/html", StringComparison.OrdinalIgnoreCase) >= 0 ||
                        ct.IndexOf("application/json", StringComparison.OrdinalIgnoreCase) >= 0))
                    {
                        using (var ms = new MemoryStream())
                        {
                            using (var stream = await response.Content.ReadAsStreamAsync().ConfigureAwait(false))
                            {
                                await stream.CopyToAsync(ms).ConfigureAwait(false);
                                var enc = context.Response.ContentEncoding ?? Encoding.UTF8;
                                var html = enc.GetString(ms.ToArray());
                                if (TryReplace(html, "//" + _targetHost + ":" + _targetPort + "/", "//" + host + "/", out var replaced))
                                {
                                    var bytes = enc.GetBytes(replaced);
                                    using (var ms2 = new MemoryStream(bytes))
                                    {
                                        ms2.Position = 0;
                                        await ms2.CopyToAsync(context.Response.OutputStream).ConfigureAwait(false);
                                    }
                                }
                                else
                                {
                                    ms.Position = 0;
                                    await ms.CopyToAsync(context.Response.OutputStream).ConfigureAwait(false);
                                }
                            }
                        }
                    }
                    else
                    {
                        using (var stream = await response.Content.ReadAsStreamAsync().ConfigureAwait(false))
                        {
                            await stream.CopyToAsync(context.Response.OutputStream).ConfigureAwait(false);
                        }
                    }
                }
            }
        }
    }

    public void Stop() => _listener.Stop();
    public override string ToString() => string.Join(", ", Prefixes) + " => " + TargetUrl;
    public void Dispose() => ((IDisposable)_listener)?.Dispose();

    // out-of-the-box replace doesn't tell if something *was* replaced or not
    private static bool TryReplace(string input, string oldValue, string newValue, out string result)
    {
        if (string.IsNullOrEmpty(input) || string.IsNullOrEmpty(oldValue))
        {
            result = input;
            return false;
        }

        var oldLen = oldValue.Length;
        var sb = new StringBuilder(input.Length);
        bool changed = false;
        var offset = 0;
        for (int i = 0; i < input.Length; i++)
        {
            var c = input[i];

            if (offset > 0)
            {
                if (c == oldValue[offset])
                {
                    offset++;
                    if (oldLen == offset)
                    {
                        changed = true;
                        sb.Append(newValue);
                        offset = 0;
                    }
                    continue;
                }

                for (int j = 0; j < offset; j++)
                {
                    sb.Append(input[i - offset + j]);
                }

                sb.Append(c);
                offset = 0;
            }
            else
            {
                if (c == oldValue[0])
                {
                    if (oldLen == 1)
                    {
                        changed = true;
                        sb.Append(newValue);
                    }
                    else
                    {
                        offset = 1;
                    }
                    continue;
                }

                sb.Append(c);
            }
        }

        if (changed)
        {
            result = sb.ToString();
            return true;
        }

        result = input;
        return false;
    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-03T16:15:52.110

浏览器连接到代理，因此代理从 Web 服务器获取的数据只是通过浏览器向代理发起的相同连接发送。

# svn - Netbeans、生成的代码和 svn

> ID：226785
> 
> 赞同：1
> 
> 时间：2008-10-22T17:31:32.740
> 
> 标签：svn, netbeans

我们有一个 netbeans 项目，它有一个用于创建 wsdl 的 xsd，我们使用 wsdl 创建一个 web 服务。由于我们在 xsd 中使用了类型，因此使用了 jaxb，并且我们的其中一种 web 服务方法如下所示：

```
public void someMethod( org.netbeans.xml.schema.line.Line x )... 
```

这给我们留下了一个颠覆问题，因为 Line 对象是由 netbeans 生成的。所以我们要做的是要么告诉netbeans把文件放在项目里面吗？或者告诉 netbeans 我们将生成 jaxb 代码，并且在处理 web 服务调用时它们应该使用我们的类？我们如何才能完成其中之一，还有哪些其他选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T10:12:50.553

你有大约。两个选择

1.  将所有生成的文件都保存在 subversion 中或
2.  确保文件生成是完全自动化的

不确定 2\. 使用 netbeans 可以轻松完成，但这是我推荐的方式，因为在您更改了一个文件中的一行后，提交不会遍布整个地方。此外，您不必担心“我更新了 web 服务，还是只更新了 xsd？”。

OTOH，subversion 不在乎某个编辑器是否更新了很多文件——它只是确保数据进入 repo。

重要的部分是**没有**用于构建项目的手动过程。全自动==好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T19:01:16.507

由于 Netbeans 6.7 生成的文件会自动标记为此类，并且 Netbeans 不会在它们上使用版本控制工具（Subversion、Mercurial...）。

[**在此处搜索**](http://www.netbeans.org/community/releases/67/)“生成的源”。

现在甚至可以定义在生成的目录中执行某些操作的自定义 ant 任务，例如，每次执行**clean/build**时。

# windows - 使用 Windows DDK 编译时出错

> ID：226790
> 
> 赞同：1
> 
> 时间：2008-10-22T17:32:43.953
> 
> 标签：windows, wdk

请原谅我是一个完整的 Windows DDK 新手。

我创建了一个名为的简单文件`test.cpp`：

```
#include <windows.h>

#define BAD_ADDRESS 0xBAADF00D

int __cdecl main(int argc, char* args[])
{
    char* p =(char*)BAD_ADDRESS;
    *p='A';
    return 0;
} 
```

在同一个目录中，我创建了一个`sources`像这样的文件：

```
目标名称=测试
目标类型=程序
目标路径=obj

TARGETLIBS=$(SDK_LIB_PATH)\kernel32.lib

来源= test.cpp

```

像`makefile`这样：

```
#
# 不要编辑这个文件！！！编辑 .\sources. 如果你想添加一个新的来源
# 文件到这个组件。这个文件只是间接到真正的 make 文件
# 由 Windows 的所有组件共享
#
!包括 $(NTMAKEENV)\makefile.def

```

启动 Windows XP Free Build Environment 后，我​​浏览到包含三个文件（test.cpp、makefile 和源）的目录并运行以下命令：

```
F:\temp\debug\dir1>build -cZg
```

哪个输出：

```
构建：将 /Y 添加到 COPYCMD，这样 xcopy 操作就不会挂起。
BUILD：使用 2 个子进程
构建：对象根设置为：==> objfre_wxp_x86
构建：为 i386 编译和链接
BUILD：检查 f:\temp\debug\dir1 目录中要编译的文件。
构建：编译 (NoSync) f:\temp\debug\dir1 目录
1>编译-i386的test.cpp
构建：编译 f:\temp\debug\dir1 目录
构建：链接 f:\temp\debug\dir1 目录
1>链接可执行文件 - i386 的 objfre_wxp_x86\i386\test.exe
构建：完成

    2个文件编译
    构建了 1 个可执行文件

```

问题是当我运行创建的可执行文件`test.exe`时它说：

```
F:\temp\debug\dir1\objfre_wxp_x86\i386>test
F:\temp\debug\dir1\objfre_wxp_x86\i386\test.exe 应用程序无法在 Win32 模式下运行。

```

**我在这里想念什么？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T18:17:04.957

您已经编译了一个“本机应用程序”而不是一个 win32 应用程序。TARGET_TYPE 定义控制这一点。

有关使用 DDK 生成原生应用程序的讨论，请参阅“[内部原生应用程序”。](http://technet.microsoft.com/en-us/sysinternals/bb897447.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T19:15:56.537

[Rob Walker](https://stackoverflow.com/questions/226790/error-when-compiling-with-windows-ddk#226952)解释了原因，但[Kernel Mustard](http://blogs.msmvps.com/kernelmustard/2005/11/04/building-win32-apps-with-build-exe-and-the-ddk/)解释了方法。

# php - 为 CakePHP 应用程序创建 tableA HABTM tableA 关系的最佳方法是什么？

> ID：226805
> 
> 赞同：1
> 
> 时间：2008-10-22T17:39:01.553
> 
> 标签：php, database-design, cakephp

我需要创建功能以允许我的注册用户将自己与其他用途相关联并创建一个家庭。我的数据库表如下所示：

**db.persons** -（Bob、Jane、Timmy 等）

*   ID
*   姓名
*   电子邮件

**db.persons_persons**

*   ID
*   person__id_parent
*   person_id_child
*   关系类型 ID

**db.relationtypes** -（配偶、孩子、侄子等）

*   ID
*   姓名

使用这种结构，我应该能够在persons_persons 表中指定Bob 是Jane 的配偶。db.persons_persons 中的记录看起来像（伪）：

```
ID | person_parent | person_child | relationtype
1  | Bob           | Jane         | Spouse
2  | Bob           | Timmy        | Child 
```

我意识到这可能会导致一些数据碎片化，因为如果 Bob 和 Jane 结婚了，那么其中一个的孩子必须与另一个相关联。然而，这不是我的问题。我的问题是这个数据库设置对于 cakePHP 应用程序是否“最正确”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T19:04:19.900

首先，CakePHP 会自动将`people`表格变形为`people`控制器和`person`模型，因此您无需调用它`persons`。然后我会调用查找表`relationships`而不是`persons_persons`.

我将调用您的关系表中的字段`person_id`，`relation_id`然后`relation_type_id`在您的表名中添加一个下划线，`relationtypes`使其变为`relation_types`.

我认为这更具语义。

您仍然可以使用 hasAndBelongsToMany 关联，并利用 CakePHP（仅限 1.2）提供的自动魔术“ [with](http://www.cricava.com/blogs/index.php?blog=6&title=modelizing_habtm_join_tables_in_cakephp_&more=1&c=1&tb=1&pb=1) ”关联来访问 HABTM 表中关系类型的附加数据。

但是，我很想使用：

*   `Person`有很多`Relation`
*   `Relation`属于`Person`, `Relation`,`RelationType`

在您的应用程序中，他人与他们的关系是否暗示了人与人之间的关系？也就是说，如果你找到 Person.id = 1，你可能会得到他们所有的关系，例如 Person.id 2、3 和 4。但是如果你找到 Person.id 2，你不会自动得到 Person.id = 1，除非有另一个在表示该关系的关系表中记录。

为此，您可以设置另一个关联：

*   `Person`hasMany`Relation1`带有外键`person_id`
*   `Person`hasMany`Relation2`带有外键`relation_id`
*   `Relation`属于`Person`, `Relation`,`RelationType`

请注意，您也可以使用 HABTM 实现这种双重关系。

# visual-studio-2008 - 调试 Visual Studio 2008 Web 应用程序需要很长时间才能启动

> ID：226807
> 
> 赞同：0
> 
> 时间：2008-10-22T17:40:17.417
> 
> 标签：visual-studio-2008, performance, debugging

在 VS2008 IDE 中调试 asp.net Web 应用程序时，我觉得启动该应用程序需要“很长时间”，因为我的应用程序不大（大约六页）。

我没有使用内置的 VS 网络服务器，而是在我的开发机器上使用标准的 IIS 网络服务器。（也就是说，在“开始选项”对话框中，我已设置为“使用自定义服务器”并将“基本 URL”指向我在 IIS 中定义的那个）

我没有尝试微调任何选项，所以尽管有人可以快速指出需要更改的内容以优化此过程

我的机器是 P3 Duo-core，我觉得它有足够的内存来完成这项工作:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T17:53:24.347

对我来说有助于提高启动速度的一件事是设置一个单独的 AppPool 并将您尝试调试的应用程序分配给该 AppPool。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T18:24:47.887

您是否考虑过安装 Service Pack 1 (sp1)？它可能会导致麻烦，但仅限于比您听起来更复杂的设置。它有性能改进。sp1 ~ [http://msdn.microsoft.com/en-us/vstudio/products/cc533447.aspx](http://msdn.microsoft.com/en-us/vstudio/products/cc533447.aspx)

如果您不想这样做，那么这里有一个可用的修补程序 [https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=10826](https://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=10826)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T18:10:24.487

我会尝试关闭“临时 asp.net 文件”文件夹（位于您的 windows dir/microsoft.net/framework/%whatever version% 文件夹中）的索引。

# sql-server - SQL Server 2005 - 授予创建存储过程的权限（但没有其他对象）

> ID：226811
> 
> 赞同：4
> 
> 时间：2008-10-22T17:41:34.870
> 
> 标签：sql-server, sql-server-2005, stored-procedures, database-permissions

我想授予用户创建、更改和执行存储过程的权限，但不能创建其他数据库对象。我将它们排除在角色 db_ddladmin 之外，但明确授予了“创建过程”和“执行”权限。这些权限出现在有效权限列表中。但是，当我尝试使用此登录名创建存储过程时，出现以下错误：

“指定的架构名称“dbo”要么不存在，要么您没有使用它的权限。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T18:00:14.350

用户可以在他们拥有的模式中创建过程。所以你可以为用户设置一个模式来做开发工作。然后，如果需要 dbo，管理员可以在开发完成时将其放在那里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T17:44:50.747

如果您可以创建（或更改）并执行存储过程，那么您可以做任何事情。

对存储过程执行意味着该过程上下文中的所有其他权限。因此，如果您可以更改一个程序*并*运行它，那么限制其他任何内容都没有意义。您可以让该程序代表您充当代理。

# c - 如何在 Visual Studio 2005/2008 中编译 flex？

> ID：226820
> 
> 赞同：3
> 
> 时间：2008-10-22T17:45:43.850
> 
> 标签：c, visual-studio-2008, visual-studio-2005, flex-lexer

我想不通这个。我可以从 gnuwin32 下载 flex 2.5.4a 的 win32 二进制文件，但我想使用 Visual Studio 2005 构建最新版本（2.5.35）。我想我可以在 cygwin 中构建，但其中的乐趣在哪里?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T18:28:44.450

请注意，在生成 C++ 扫描器时，Flex 在 Windows 上严重过时。能够生成 ISO C++ 扫描器的最新 Flex 版本不支持 Win32（MinGW 或 VS），因此您最好尝试生成 C 扫描器并从 C++ 调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T01:01:37.757

由于没有人对我的问题提供令人满意的答案，我在这里发布我的最终解决方案。

我无法找到在 vs 2005 或 vs 2008 中构建 flex 的方法。相反，我使用的是与 cygwin 一起分发的 flex，它是最近才发布的。为了省去在每台需要使用 flex 的机器上安装 cygwin 的麻烦，我只保存了依赖项：cygwin1.dll 和 cygintl-8.dll。

只有一个警告——cygwin 的 flex 也依赖于 m4，尽管你不会在依赖 walker 上看到它。它需要在路径中，这使得它很痛苦。您可以使用 cygwin 的 m4.exe，但它也取决于 cygwin1.dll，它需要位于 m4 执行的路径中。

即便如此，我只是将所有这些文件检入到我的工具文件夹下的 svn 中，然后每当我需要在另一台机器上开发时，获取我的代码并使用 svn 进行调整，将 m4.exe 和 cygwin1.dll 复制到 windows\system32 文件夹，我在做生意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-08T00:03:45.050

您还可以在[sourceforge.net](http://sourceforge.net/projects/mingw/files/MSYS%20flex/)下载 flex 2.5.35 的 MINGW（Minimalist GNU for Windows）版本。这个构建可能不是完全独立的；发行说明表明需要[MSYS](http://www.mingw.org/wiki/MSYS) (Minimal SYSytem) 的某些组件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T09:57:00.330

为什么你不想尝试 Boost 的 Spirit 框架？

# internet-explorer-6 - IE6上的图标背景

> ID：226823
> 
> 赞同：3
> 
> 时间：2008-10-22T17:47:10.820
> 
> 标签：internet-explorer-6, png, transparency

我正在开发一个网站（顺便说一下使用 asp.net），但我遇到了 IE6 的问题。

当我在链接附近使用一些图标时，在链接上使用 background-image 和 padding-left 时，这些图标在 FF 和 Chrome 上显示得很好，但在 IE6 中它们采用一种“灰色”背景，有时会奇怪地闪烁。

有任何想法吗？有没有一些 CSS hack 来解决这个问题？谢谢大家！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-22T17:48:10.600

它们是 .png 文件吗？IE6 在 .png 中存在 alpha 透明度问题。虽然有一个[javascript 修复程序](http://homepage.ntlworld.com/bobosola/pnghowto.htm)。

编辑，澄清 - 如果 IE6 看到具有 alpha 透明度的 .png（与 .gifs 中的透明度不同），它会吓坏并将该部分呈现为浅灰色，我相信您正在看到。javascript 修复将过滤器应用于页面中的所有 .png。但是，这不适用于已通过 css 设置为背景的 .png。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T17:54:10.197

小心 IE6 中的 PNG 修复 - 它使用 DirectX 过滤器，而且速度相对较慢。如果您的页面上有很多图像（例如，表格中每行 25 个图标上都有一个图标），它可能会使页面变慢很多。

我们发现唯一有效的解决方案是将别名 GIF 提供给 IE6 并将 PNG 提供给其他所有人。

哼哼，这只是讨厌 IE6 和所有在她中航行的人的另一个原因。

# c++ - C++ 构造替换 C 构造

> ID：226828
> 
> 赞同：17
> 
> 时间：2008-10-22T17:48:05.280
> 
> 标签：c++, c, language-construct

在与我团队中一位新来的开发人员讨论后，我意识到在 C++ 中仍然存在使用 C 构造的习惯，因为它们应该更好（即更快、更精简、更漂亮，选择你的理由）。

**与类似的 C++ 构造相比，哪些示例值得分享，展示了 C 构造？**

对于每个示例，我都需要阅读 C++ 构造与原始 C 构造一样好甚至更好的原因。目的是为一些在 C++ 代码中被认为有些危险/不安全的 C 构造提供替代方案（只要明确标记为 C++0x，就接受仅 C++0x 有效的答案）。

我将在下面发布一个答案（结构内联初始化）作为示例。

*注1：请，每个案例一个答案。如果您有多个案例，请发布多个答案*

*注 2：~~这不是 C 题。不要在这个问题中添加“C”标签。~~* *这不应该成为 C++ 和 C 之间的斗争。仅研究 C++ 的 C 子集的一些构造，以及它们在其他 C++“工具包”中的替代方案*

*注 3：这不是一个 C-bashing 问题。我要理由。吹嘘、抨击和未经证实的比较将被降低。在没有 C 等价物的情况下提及 C++ 功能可能会被认为是题外话：我希望将 C 功能与 C++ 功能并排放置。*

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-22T19:04:22.723

## RAII 和所有随之而来的荣耀与手动资源获取/释放

在 C 中：

```
Resource r;
r = Acquire(...);

... Code that uses r ...

Release(r); 
```

例如，`Resource`可以是指向内存的指针，Acquire/Release 将分配/释放该内存，或者它可以是一个打开的文件描述符，Acquire/Release 将在其中打开/关闭该文件。

这带来了许多问题：

1.  你可能会忘记打电话`Release`
2.  代码没有传达有关数据流的信息`r`。如果`r`在同一范围内获取和发布，则代码不会对此进行自我记录。
3.  在 和 之间的时间里`Resource r`，`r.Acquire(...)`实际上`r`是可以访问的，尽管没有初始化。这是错误的来源。

应用 RAII（资源获取即初始化）方法，在 C++ 中我们获得

```
class ResourceRAII
{
  Resource rawResource;

  public:
  ResourceRAII(...) {rawResource = Acquire(...);}
  ~ResourceRAII() {Release(rawResource);}

  // Functions for manipulating the resource
};

...

{
  ResourceRAII r(...);

  ... Code that uses r ...
} 
```

C++ 版本将确保你不会忘记释放资源（如果你这样做了，你就会有内存泄漏，这更容易被调试工具检测到）。它迫使程序员明确资源的数据如何流动（即：如果它只存在于函数的范围内，这将通过堆栈上的 ResourceRAII 构造来明确）。在资源对象的创建和资源无效的销毁之间没有任何意义。

它也是异常安全的！

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-22T18:31:53.380

## 宏与内联模板

C风格：

```
#define max(x,y) (x) > (y) ? (x) : (y) 
```

C++ 风格

```
inline template<typename T>
const T& max(const T& x, const T& y)
{
   return x > y ? x : y;
} 
```

更喜欢 C++ 方法的原因：

*   类型安全——强制参数必须是相同的类型
*   max 定义中的语法错误将指向正确的位置，而不是您调用宏的位置
*   可以调试进函数

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-10-22T19:27:50.587

## 动态数组与 STL 容器

C风格：

```
int **foo = new int*[n];
for (int x = 0; x < n; ++x) foo[x] = new int[m];
// (...)
for (int x = 0; x < n; ++x) delete[] foo[x];
delete[] foo; 
```

C++ 风格：

```
std::vector< std::vector<int> > foo(n, std::vector<int>(m));
// (...) 
```

为什么 STL 容器更好：

*   它们是可调整大小的，数组具有固定大小
*   它们是异常安全的 - 如果在 (...) 部分发生未处理的异常，则数组内存可能会泄漏 - 容器是在堆栈上创建的，因此在展开期间它将被正确销毁
*   他们实现边界检查，例如[vector::at()](http://en.cppreference.com/w/cpp/container/vector/at)（超出数组范围很可能会产生访问冲突并终止程序）
*   它们更易于使用，例如[vector::clear()](http://en.cppreference.com/w/cpp/container/vector/clear)与手动清除数组
*   它们隐藏了内存管理细节，使代码更具可读性

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-10-22T19:32:16.037

#define 与 const

我不断从长期编写 C 代码的开发人员那里看到这样的代码：

```
#define MYBUFSIZE 256

.  .  . 

char somestring[MYBUFSIZE]; 
```

等等等等

在 C++ 中，这会更好：

```
const int MYBUFSIZE = 256;

char somestring[MYBUFSIZE]; 
```

*当然，更好的是让开发人员使用 std::string 而不是 char 数组，但这是一个单独的问题。*

C 宏的问题很多——在这种情况下，没有类型检查是主要问题。

从我所见，这似乎是 C 程序员转换为 C++ 以打破的一个极其困难的习惯。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-10-22T18:50:08.710

## 默认参数：

### C：

```
void AddUser(LPCSTR lpcstrName, int iAge, const char *lpcstrAddress);
void AddUserByNameOnly(LPCSTR lpcstrName)
  {
  AddUser(lpcstrName, -1,NULL);
  } 
```

### C++ 替换/等效：

```
void User::Add(LPCSTR lpcstrName, int iAge=-1, const char *lpcstrAddress=NULL); 
```

### 为什么是改进：

允许程序员以更少的源代码行和更紧凑的形式编写表达程序的功能。还允许将未使用参数的默认值表示为最接近它们实际使用的位置。对于调用者，简化了类/结构的接口。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-10-22T20:09:31.267

**C 的`qsort`函数与 C++ 的`sort`函数模板。**后者通过具有明显和不太明显后果的模板提供类型安全：

*   类型安全使代码不易出错。
*   的界面`sort`稍微简单一些（无需指定元素的大小）。
*   编译器知道比较器函数的类型。*如果用户传递函数对象*而不是函数指针，则`sort`执行*速度*会比`qsort`内联比较变得微不足道。对于 C 版本中必需的函数指针，情况并非如此。

以下示例演示了`qsort`vs`sort`在 C 样式数组中的用法`int`。

```
int pint_less_than(void const* pa, void const* pb) {
    return *static_cast<int const*>(pa) - *static_cast<int const*>(pb);
}

struct greater_than {
    bool operator ()(int a, int b) {
        return a > b;
    }
};

template <std::size_t Size>
void print(int (&arr)[Size]) {
    std::copy(arr, arr + Size, std::ostream_iterator<int>(std::cout, " "));
    std::cout << std::endl;
}

int main() {
    std::size_t const size = 5;
    int values[] = { 4, 3, 6, 8, 2 };

    { // qsort
        int arr[size];
        std::copy(values, values + size, arr);
        std::qsort(arr, size, sizeof(int), &pint_less_than);
        print(arr);
    }

    { // sort
        int arr[size];
        std::copy(values, values + size, arr);
        std::sort(arr, arr + size);
        print(arr);
    }

    { // sort with custom comparer
        int arr[size];
        std::copy(values, values + size, arr);
        std::sort(arr, arr + size, greater_than());
        print(arr);
    }
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-10-22T17:49:45.213

## 结构内联初始化与内联构造函数

有时，我们需要在 C++ 中进行简单的数据聚合。数据有些独立，通过封装来保护它是不值得的。

```
// C-like code in C++
struct CRect
{
   int x ;
   int y ;
} ;

void doSomething()
{
   CRect r0 ;               // uninitialized
   CRect r1 = { 25, 40 } ;  // vulnerable to some silent struct reordering,
                            // or adding a parameter
} 
```

; 我看到上面的代码存在三个问题：

*   如果对象没有被特别初始化，它就不会被初始化
*   如果我们改变 x 或 y（无论出于何种原因），doSomething() 中的默认 C 初始化现在将是错误的
*   如果我们添加 az 成员，并希望它默认为“零”，我们仍然需要更改每个内联初始化

下面的代码将内联构造函数（如果真的有用），因此成本为零（如上面的 C 代码）：

```
// C++
struct CRect
{
   CRect() : x(0), y(0) {} ;
   CRect(int X, int Y) : x(X), y(Y) {} ;
   int x ;
   int y ;
} ;

void doSomething()
{
   CRect r0 ;
   CRect r1(25, 40) ;
} 
```

（好处是我们可以添加一个 operator== 方法，但是这个好处超出了主题，因此值得一提但不值得作为答案。）

## 编辑：C99 已命名初始化

Adam Rosenfield 发表了一个有趣的评论，我觉得非常有趣：

*C99 允许命名初始化器：* CRect r = { .x = 25, .y = 40 }

这不会在 C++ 中编译。我想这应该被添加到 C++ 中，如果只是为了 C 兼容的话。无论如何，在 C 中，它缓解了这个答案中提到的问题。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-22T19:22:05.620

## iostream 与 stdio.h

在 C 中：

```
#include <stdio.h>

int main()
{
    int num = 42;

    printf("%s%d%c", "Hello World\n", num, '\n');

    return 0;
} 
```

格式字符串是在运行时解析的，这意味着它不是类型安全的。

在 C++ 中：

```
#include <iostream>

int main()
{
    int num = 42;

    std::cout << "Hello World\n" << num << '\n';
} 
```

数据类型在编译时是已知的，并且由于不需要格式字符串，因此需要输入的内容也更少。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-22T20:25:45.273

继 fizzer 在[C++ 构造替换 C 构造](https://stackoverflow.com/questions/226828/c-constructs-replacing-c-constructs#227310)的帖子之后，我将在这里写下我的答案：

**警告：下面提出的 C++ 解决方案不是标准 C++，而是 g++ 和 Visual C++ 的扩展，并被提议作为 C++0x 的标准**（感谢**Fizzer**对此的评论）

**请注意，[Johannes Schaub - litb 的回答](https://stackoverflow.com/questions/226828/c-constructs-replacing-c-constructs/411610#411610)提供了另一种符合 C++03 标准的方法。**

## 问题

如何提取C数组的大小？

## 建议的 C 解决方案

资料来源：[C++ 宏什么时候有用？](https://stackoverflow.com/questions/96196/when-are-c-macros-beneficial#97292)

* * *

```
#define ARRAY_SIZE(arr) (sizeof arr / sizeof arr[0]) 
```

与当前线程中讨论的“首选”模板解决方案不同，您可以将其用作常量表达式：

```
char src[23];
int dest[ARRAY_SIZE(src)]; 
```

* * *

我不同意 Fizzer，因为有一个模板化解决方案能够生成常量表达式（事实上，模板的一个非常有趣的部分是它们在编译时生成常量表达式的能力）

无论如何，ARRAY_SIZE 是一个能够提取 C 数组大小的宏。我不会详细说明 C++ 中的宏：目的是找到一个相同或更好的 C++ 解决方案。

## 更好的 C++ 解决方案？

以下 C++ 版本没有任何宏问题，并且可以以相同的方式执行任何操作：

```
template <typename T, size_t size>
inline size_t array_size(T (&p)[size])
{
   // return sizeof(p)/sizeof(p[0]) ;
   return size ; // corrected after Konrad Rudolph's comment.
} 
```

## 示范

如以下代码所示：

```
#include <iostream>

// C-like macro
#define ARRAY_SIZE(arr) (sizeof arr / sizeof arr[0])

// C++ replacement
template <typename T, size_t size>
inline size_t array_size(T (&p)[size])
{
   // return sizeof(p)/sizeof(p[0]) ;
   return size ; // corrected after Konrad Rudolph's comment.
}

int main(int argc, char **argv)
{
   char src[23];
   char * src2 = new char[23] ;
   int dest[ARRAY_SIZE(src)];
   int dest2[array_size(src)];

   std::cout << "ARRAY_SIZE(src)  : " << ARRAY_SIZE(src) << std::endl ;
   std::cout << "array_size(src)  : " << array_size(src) << std::endl ;
   std::cout << "ARRAY_SIZE(src2) : " << ARRAY_SIZE(src2) << std::endl ;
   // The next line won't compile
   //std::cout << "array_size(src2) : " << array_size(src2) << std::endl ;

   return 0;
} 
```

这将输出：

```
ARRAY_SIZE(src)  : 23
array_size(src)  : 23
ARRAY_SIZE(src2) : 4 
```

在上面的代码中，宏将指针误认为是数组，因此返回了错误的值（4，而不是 23）。相反，模板拒绝编译：

```
/main.cpp|539|error: no matching function for call to ‘array_size(char*&)’| 
```

从而证明模板解决方案是： * 能够在编译时生成常量表达式 * 如果以错误的方式使用，能够停止编译

## 结论

因此，总而言之，模板的参数是：

*   没有类似宏的代码污染
*   可以隐藏在命名空间内
*   可以防止错误的类型评估（指向内存的指针不是数组）

注意：感谢 Microsoft 为 C++ 实现 strcpy_s ...我知道这有一天会为我服务... ^_^

[http://msdn.microsoft.com/en-us/library/td1esda9.aspx](http://msdn.microsoft.com/en-us/library/td1esda9.aspx)

## 编辑：该解决方案是针对 C++0x 标准化的扩展

Fizzer 确实正确地评论了这在当前的 C++ 标准中是无效的，并且是完全正确的（因为我可以在 g++ 上通过 -pedantic 选项进行验证）。

尽管如此，这不仅在今天的两个主要编译器（即 Visual C++ 和 g++）上可用，而且在 C++0x 中也考虑过，正如以下草案中所提议的那样：

*   [http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2003/n1521.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2003/n1521.pdf)（参见“2.1 常量表达式函数”部分）
*   [http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2691.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2691.pdf)（参见“5.19 常量表达式”和“7.1.5 constexpr 说明符”部分）

C++0x 的唯一变化可能是这样的：

```
inline template <typename T, size_t size>
constexpr size_t array_size(T (&p)[size])
{
   //return sizeof(p)/sizeof(p[0]) ;
   return size ; // corrected after Konrad Rudolph's comment.
} 
```

（注意**constexpr**关键字）

## 编辑 2

[Johannes Schaub - litb 的答案](https://stackoverflow.com/questions/226828/c-constructs-replacing-c-constructs/411610#411610)提供了另一种符合 C++03 的方法。我将在此处复制粘贴源代码以供参考，但请访问他的答案以获取完整示例（**并对其进行升级！**）：

```
template<typename T, size_t N> char (& array_size(T(&)[N]) )[N]; 
```

用作：

```
int p[] = { 1, 2, 3, 4, 5, 6 };
int u[sizeof array_size(p)]; // we get the size (6) at compile time. 
```

我大脑中的许多神经元都被炸了，以使我了解它的本质`array_size`（提示：它是一个返回对 N 字符数组的引用的函数）。

:-)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-23T13:07:36.467

**局部（自动）变量声明**

（自 C99 以来不正确，正如 Jonathan Leffler 正确指出的那样）

在 C 中，您必须在定义它们的块的开头声明所有局部变量。

在 C++ 中，可以（并且更可取）在必须使用之前推迟变量定义。以后更可取，主要有两个原因：

1.  它提高了程序的清晰度（当您看到第一次使用它的变量类型时）。
2.  它使重构更容易（因为你有小块内聚的代码）。
3.  它提高了程序效率（因为变量是在实际需要时构建的）。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-22T20:25:45.337

铸造 C 方式`(type)`与`static_cast<type>()`. 在stackoverflow上看到[那里](https://stackoverflow.com/questions/103512/in-c-why-use-staticcastintx-instead-of-intx#103868)和[那里](https://stackoverflow.com/questions/28002/regular-cast-vs-staticcast-vs-dynamiccast#28037)的主题

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-04T20:12:52.800

遵循[paercebal](https://stackoverflow.com/questions/226828/c-constructs-replacing-c-constructs#227408)的构造，使用可变长度数组来解决函数不能返回常量表达式的限制，这里有一种方法可以做到这一点，以某种其他方式：

```
template<typename T, size_t N> char (& array_size(T(&)[N]) )[N]; 
```

我已经在我的其他一些答案中写了它，但它不适合任何地方比这个线程更好。现在，好吧，这是一个如何使用它的方法：

```
void pass(int *q) {
    int n1 = sizeof(q); // oops, size of the pointer!
    int n2 = sizeof array_size(q); // error! q is not an array!
}

int main() {
    int p[] = { 1, 2, 3, 4, 5, 6 };
    int u[sizeof array_size(p)]; // we get the size at compile time.

    pass(p);
} 
```

### 优于 sizeof

1.  非数组失败。不会*默默地*为指针工作
2.  将在代码中告知数组大小已被采用。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-31T02:50:29.033

我将提供一些可能非常明显的东西，命名空间。

## c 拥挤的全局作用域：

```
void PrintToScreen(const char *pBuffer);
void PrintToFile(const char *pBuffer);
void PrintToSocket(const char *pBuffer);
void PrintPrettyToScreen(const char *pBuffer); 
```

对比

## c++ 对全局范围、命名空间的可定义细分：

```
namespace Screen
{
   void Print(const char *pBuffer);
}

namespace File
{
   void Print(const char *pBuffer);
}

namespace Socket
{
   void Print(const char *pBuffer);
}

namespace PrettyScreen
{
   void Print(const char *pBuffer);
} 
```

这是一个人为的例子，但是将您定义的标记分类到有意义的范围内的能力可以防止函数的用途与调用它的上下文混淆。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-29T00:33:40.927

作为对[Alex Che](https://stackoverflow.com/questions/226828/c-constructs-replacing-c-constructs#229637)的回应，并且公平地对待 C：

在 C99（C 的当前 ISO 标准规范）中，变量可以在块中的任何位置声明，与 C++ 中相同。以下代码是有效的 C99：

```
int main(void)
{
   for(int i = 0; i < 10; i++)
      ...

   int r = 0;
   return r;
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-05-05T17:36:03.083

## `std::copy`对比`memcpy`

首先是可用性问题：

*   `memcpy`采用 void 指针。这抛出了类型安全。
*   `std::copy`在某些情况下允许重叠范围（`std::copy_backward`其他重叠情况存在），而`memcpy`永远不允许。
*   `memcpy`仅适用于指针，而`std::copy`适用于迭代器（其中指针是一种特殊情况，因此`std::copy`也适用于指针）。这意味着您可以，例如，`std::copy`在 a 中的元素`std::list`。

当然，所有这些额外的安全性和通用性都是有代价的，对吧？

当我测量时，我发现它[`std::copy`比`memcpy`](https://stackoverflow.com/questions/4707012/c-memcpy-vs-stdcopy/9980859#9980859).

**换句话说，似乎没有理由`memcpy`在真正的 C++ 代码中使用。**

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-04T20:39:59.003

C++ 中的新功能与 C 中的 malloc。（用于内存管理）

new 运算符允许调用类构造函数，而 malloc 不允许。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-24T16:12:46.487

## 重载函数：

### C：

```
AddUserName(int userid, NameInfo nameinfo);
AddUserAge(int userid, int iAge);
AddUserAddress(int userid, AddressInfo addressinfo); 
```

### C++ 等效/替换：

```
User::AddInfo(NameInfo nameinfo);
User::AddInfo(int iAge);
User::AddInfo(AddressInfo addressInfo); 
```

### 为什么是改进：

允许程序员表达接口，使得函数的概念在名称中表达，而参数类型仅在参数本身中表达。允许调用者以更接近概念表达的方式与类进行交互。通常也会产生更简洁、紧凑和可读的源代码。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-24T21:16:44.673

**iostreams**

Formatted I/O may be faster using the C runtime. But I don't believe that low-level I/O (read,write,etc.) is any slower with streams. The ability to read or write to a stream without caring if the other end is a file, string, socket or some user-defined object is incredibly useful.

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-12-31T03:23:20.107

在 c 中，您的大部分动态功能都是通过传递函数指针来实现的。C++ 允许您拥有函数对象，从而提供更大的灵活性和安全性。我将展示一个改编自 Stephen Dewhurst 出色的[C++ Common Knowledge的示例](https://rads.stackoverflow.com/amzn/click/com/0321321928 "亚马逊：Stephen Dewhurst 的 C++ 常识")

## C 函数指针：

```
int fibonacci() {
  static int a0 = 0, a1 =1; // problematic....
  int temp = a0;
  a0 = a1;
  a1 = temp + a0;
  return temp;
}

void Graph( (int)(*func)(void) );
void Graph2( (int)(*func1)(void), (int)(*func2)(void) ); 

Graph(fibonacci);
Graph2(fibonacci,fibonacci); 
```

您可以看到，给定函数中的静态变量，`fibonacci()`执行的顺序`Graph`和`Graph2()`将改变行为，尽管调用`Graph2()`可能会在每次调用时产生意想不到的结果，`func1`并且`func2`会产生系列中的下一个值，而不是系列的单个实例中与被调用函数相关的下一个值。（显然，您可以将函数的状态外部化，但这将失去重点，更不用说让用户感到困惑并使客户端函数复杂化）

## C++ 函数对象：

```
class Fib {
  public:
    Fib() : a0_(1), a1_(1) {}
    int operator();
  private:
    int a0_, a1_;
};
int Fib::operator() {
    int temp = a0_;
    a0_ = a1_;
    a1_ = temp + a0_;
    return temp;
}

template <class FuncT>
void Graph( FuncT &func );

template <class FuncT>
void Graph2( FuncT &func1, FuncT &func2); 

Fib a,b,c;
Graph(a);
Graph2(b,c); 
```

在这里，`Graph()`and`Graph2()`函数的执行顺序不会改变调用的结果。此外，在调用`Graph2()` `b`和`c`维护单独的状态时，它们被使用；每个都将单独生成完整的斐波那契数列。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-22T19:57:45.360

为了平衡起见，[这篇文章](https://stackoverflow.com/questions/96196/when-are-c-macros-beneficial#97292)有一个 C 风格构造的示例，它有时比 C++ 风格等效。

* * *

## 回答 #21

> 赞同：-4
> 
> 时间：2008-10-22T18:00:39.467

几乎所有使用`void*`.

# html - ASP.NET 中具有名称属性的 HTML 锚点

> ID：226831
> 
> 赞同：0
> 
> 时间：2008-10-22T17:48:32.377
> 
> 标签：html, asp.net, anchor

我想为我的 asp.net 论坛中的每个帖子制作锚点。每个论坛的帖子都使用转发器控件呈现。如何`<a name="anchor_name"></a>`在 asp.net 中渲染？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-22T17:50:58.177

```
<a name='<%# Eval("PostId") %>' /> 
```

其中 PostId 是您希望出现在锚点中的属性的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T17:53:47.857

这不是确切的代码，因为我不在 VS 中以确保语法，但这样的事情应该会让你想去。

```
<a name="<%# Bind('PostId') %>" runat="server" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T18:12:57.897

扩展 System.Web.UI.WebControls.HyperLink 类，并覆盖 UniqueID 属性以返回实际 ID：

```
override string UniqueID { get { return ID; }  } 
```

在转发器的项目模板中使用这个新的用户控件。

```
<MyPrefix:MyHyperLink ID="IDOfYourHyperLink" ... /> 
```

在 ItemDataBound 上做：

```
(e.Item.FindControl("IDOfYourHyperLink") as MyHyperlink).ID = NowIKnowWhatToUseHere; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T18:41:59.493

行。我已经这样解决了：

```
<a name='<%# DataBinder.Eval(Container.DataItem, "Id") %>' /> 
```

其中 Id 是绑定实体的属性。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-22T17:51:37.847

在适当的位置添加`<a name="anchor_name"></a>`中继器的 ItemTempate 应该可以解决问题。更多信息可能会有所帮助。

# c++ - 丑陋的 C++ 代码

> ID：226834
> 
> 赞同：5
> 
> 时间：2008-10-22T17:49:53.967
> 
> 标签：c++, pretty-print

我正在开发 C++ 漂亮打印机，并希望通过比较运行前后的代码来显示漂亮打印机的结果。有谁知道我在哪里可以找到一些丑陋的 C++ 代码来运行 Prettypretty？理想情况下，代码将来自一些开源软件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-22T19:14:45.603

任何按照[GNU 编码标准](http://www.gnu.org/prep/standards/html_node/Formatting.html#Formatting)编码的东西都会给你一种糟糕的缩进风格来练习。逐字示例：

```
 if (x < foo (y, z))
   haha = bar[4] + 5;
 else
   {
     while (z)
       {
         haha += foo (z, z);
         z--;
       }
     return ++x + bar ();
   } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-22T18:59:15.137

如果你找不到一个好的丑代码语料库，你总是可以编写一个“代码丑化器”，然后在一些普通代码上运行它。

例如：

*   删除所有无关紧要的空格
*   删除/插入随机空格
*   用不同数量的空格替换制表符。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-22T17:53:16.843

尝试搜索“C++ 混淆”，您应该能够找到难以阅读的 C++ 代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T18:01:19.370

不是 C++，但你看过国际混淆 C 代码竞赛吗？

查看一些获奖者[代码](http://www.ioccc.org/years.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-22T18:04:01.300

[这是](https://bugs.eclipse.org/bugs/buglist.cgi?query_format=advanced&short_desc_type=anywordssubstr&short_desc=formatter&product=CDT&long_desc_type=allwordssubstr&long_desc=&bug_file_loc_type=allwordssubstr&bug_file_loc=&status_whiteboard_type=allwordssubstr&status_whiteboard=&keywords_type=allwords&keywords=&emailtype1=substring&email1=&emailtype2=substring&email2=&bugidtype=include&bug_id=&votes=&chfieldfrom=&chfieldto=Now&chfieldvalue=&cmdtype=doit&order=Reuse+same+sort+as+last+time&field0-0-0=noop&type0-0-0=noop&value0-0-0=)针对 eclipse C/C++ 工具项目提交的错误列表。许多错误与格式不正确的代码有关，因此您可以看到它们是如何做的，甚至查看修复是否已解决。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-22T17:58:55.990

另一个很好的测试是获取普通的 C++ 代码，看看它可以如何将其重新格式化为不同的代码格式化标准。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-22T20:22:42.237

您的漂亮打印机大概是可配置的？然后它将能够为合适的输入生成丑陋的代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-01T23:20:28.220

查看[Code Golf Stack Exchange 站点上的“高尔夫”C++ 程序](https://codegolf.stackexchange.com/questions/tagged/c%2b%2b)。为了节省空间，它们被丑化了。

# asp.net - 用于 ASP.NET 的广告管理软件

> ID：226836
> 
> 赞同：3
> 
> 时间：2008-10-22T17:50:33.137
> 
> 标签：asp.net, ad-management

任何人都可以推荐任何适用于 .NET 的广告管理组件吗？我有一位客户想通过自己的网站出售自己的广告。这排除了使用打包广告提供商（例如 Google Ads）的可能性。

我用谷歌搜索了几个包，但我想看看是否有人对特定包有任何第一手经验。

还是我应该只推出自己的广告管理系统？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-23T04:33:12.387

如果广告系统有任何规模或复杂性，我不会推出你自己的。专注于你的核心竞争力并将其余的外包出去，因为广告人可能很疯狂，几乎不可能实现他们想要的所有功能。频次上限、地理定位、故障转移报告、库存管理等等。

查看提供托管广告服务解决方案的 Atlas Solutions，它的前身为 Accipiter（现已被 Microsoft 收购）。当然，这是有代价的，但什么不是呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-23T04:39:52.890

我同意大卫关于不滚动你自己的观点。我也有同样的需求，并查看了 BanManPro.com 的 .NET 版本和[Xigla.com](http://www.xigla.com/absolutebmnet/index.htm)[的](http://www.BanManPro.com)版本。Xigla's便宜得多，应该可以正常工作。

此外，谷歌刚刚发布了我一直在测试的[Ad Manager服务，它目前运行良好，足以满足我们的需求。](http://www.google.com/admanager)

# javascript - 创建 img 元素的最佳 JavaScript 代码是什么

> ID：226847
> 
> 赞同：118
> 
> 时间：2008-10-22T17:52:16.283
> 
> 标签：javascript, dhtml

我想创建一段简单的 JS 代码，在后台创建一个图像元素并且不显示任何内容。图像元素将调用一个跟踪 URL（例如 Omniture），并且需要简单而健壮，并且只能在 IE 6 =< 中工作。这是我的代码：

```
var oImg = document.createElement("img");
oImg.setAttribute('src', 'http://www.testtrackinglink.com');
oImg.setAttribute('alt', 'na');
oImg.setAttribute('height', '1px');
oImg.setAttribute('width', '1px');
document.body.appendChild(oImg); 
```

这是最简单但最强大（无错误）的方法吗？

我不能使用像 jQuery 这样的框架。它需要使用纯 JavaScript。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2008-10-22T18:49:56.230

```
oImg.setAttribute('width', '1px'); 
```

`px`仅适用于 CSS。使用任一：

```
oImg.width = '1'; 
```

通过 HTML 设置宽度，或者：

```
oImg.style.width = '1px'; 
```

通过CSS设置它。

请注意，旧版本的 IE 不会使用 来创建正确的图像`document.createElement()`，而旧版本的 KHTML 不会使用 来创建正确的 DOM 节点`new Image()`，因此如果您想完全向后兼容，请使用类似：

```
// IEWIN boolean previously sniffed through eg. conditional comments

function img_create(src, alt, title) {
    var img = IEWIN ? new Image() : document.createElement('img');
    img.src = src;
    if ( alt != null ) img.alt = alt;
    if ( title != null ) img.title = title;
    return img;
} 
```

还要稍微注意`document.body.appendChild`脚本是否可能在页面加载过程中执行。您最终可能会在意外的地方看到图像，或者 IE 上出现奇怪的 JavaScript 错误。如果您需要能够在加载时添加它（但在`<body>`元素启动之后），您可以尝试使用`body.insertBefore(body.firstChild)`.

要在不可见的情况下执行此操作，但仍要在所有浏览器中实际加载图像，您可以插入一个绝对定位的页面`<div>`作为 body 的第一个子项，并在其中放置您不希望显示的任何跟踪/预加载图像.

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2008-10-22T17:58:11.530

```
var img = new Image(1,1); // width, height values are optional params 
img.src = 'http://www.testtrackinglink.com'; 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-10-22T18:08:15.363

```
var img = document.createElement('img');
img.src = 'my_image.jpg';
document.getElementById('container').appendChild(img); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-22T18:12:30.863

jQuery：

```
$('#container').append('<img src="/path/to/image.jpg"
       width="16" height="16" alt="Test Image" title="Test Image" />'); 
```

我发现这效果更好，因为您不必担心 HTML 会转义任何内容（如果值没有硬编码，则应该在上面的代码中完成）。它也更容易阅读（从 JS 的角度来看）：

```
$('#container').append($('<img>', { 
    src : "/path/to/image.jpg", 
    width : 16, 
    height : 16, 
    alt : "Test Image", 
    title : "Test Image"
})); 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-23T15:08:37.473

只是为了完整起见，我建议也使用 InnerHTML 方式 - 即使我不会称之为最好的方式......

```
document.getElementById("image-holder").innerHTML = "<img src='image.png' alt='The Image' />"; 
```

顺便说一句，[innerHTML 还不错](http://www.quirksmode.org/blog/archives/2006/01/the_ajax_respon_1.html#link5)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-23T11:04:49.260

最短路径：

```
(new Image()).src = "http:/track.me/image.gif"; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-22T17:53:50.633

你可以使用框架吗？[jQuery](http://jquery.com/)和[Prototype](http://prototypejs.org)使这种事情变得非常容易。这是原型中的示例：

```
var elem = new Element('img', { 'class': 'foo', src: 'pic.jpg', alt: 'alternate text' });
$(document).insert(elem); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-10-15T08:16:58.287

你可以简单地做：

```
var newImage = new Image();
newImage.src = "someImg.jpg";

if(document.images)
{
  document.images.yourImageElementName.src = newImage.src;
} 
```

简单的 ：）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-10-22T12:17:37.430

只是为了添加完整的 html JS 示例

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>create image demo</title>
    <script>

        function createImage() {
            var x = document.createElement("IMG");
            x.setAttribute("src", "http://www.iseebug.com/wp-content/uploads/2016/09/c2.png");
            x.setAttribute("height", "200");
            x.setAttribute("width", "400");
            x.setAttribute("alt", "suppp");
            document.getElementById("res").appendChild(x);
        }

    </script>
</head>
<body>
<button onclick="createImage()">ok</button>
<div id="res"></div>

</body>
</html> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-04-26T12:18:08.813

这是我按照您的意愿创建 img 标签或单个标签循环的方法

```
method1 :
    let pics=document.getElementById("pics-thumbs");
            let divholder=document.createDocumentFragment();
            for(let i=1;i<73;i++)
            {
                let img=document.createElement("img");
                img.class="img-responsive";
                img.src=`images/fun${i}.jpg`;
                divholder.appendChild(img);
            }
            pics.appendChild(divholder); 
```

或者

```
method2: 
let pics = document.getElementById("pics-thumbs"),
  imgArr = [];
for (let i = 1; i < 73; i++) {

  imgArr.push(`<img class="img-responsive" src="images/fun${i}.jpg">`);
}
pics.innerHTML = imgArr.join('<br>')
<div id="pics-thumbs"></div> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-23T11:14:26.383

正如其他人指出的那样，如果您被允许使用像 jQuery 这样的框架，最好的办法就是使用它，因为它很可能会以最好的方式做到这一点。如果您不允许使用框架，那么我认为操作 DOM 是最好的方法（在我看来，这是正确的方法）。

# database - 存储过程的缺点

> ID：226859
> 
> 赞同：21
> 
> 时间：2008-10-22T17:54:15.830
> 
> 标签：database, sql-server-2005, database-design, stored-procedures

想获得使用存储过程的优点和缺点的列表。SP 的主要优势似乎是预编译和应用程序数据的抽象。给我你的想法......

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-27T18:22:39.250

**优点**：为数据库（另一个抽象层）提供“公共接口”。

还将所有查询分组在同一位置，使 DBA 更容易查看数据库的查询方式并相应地对其进行优化。

**缺点**：可能不是放置复杂逻辑的最佳位置。但是，按照复杂逻辑属于应用程序代码而不属于存储过程的想法，存储过程变成了简单的 CRUD 操作（每个表都有一个“创建”、“读取”、“更新”和“删除”过程）。在这种情况下，存储过程不会为应用程序增加任何价值，它们只会使维护复杂化并成为浪费。

查询全部组合在一起，因此很难看到正在使用它们的应用程序的上下文。分析变更的影响需要更长的时间，进行变更的时间也更长。

**因此**：使用存储过程来封装复杂的查询（复杂的连接、复杂的 where 子句……）。但是不要将存储过程用于复杂的应用程序/域/业务逻辑，也不要将存储过程用于 CRUD。所以存储过程应该在少数情况下使用，而不是作为应用程序中所有查询的标准工具。

对代码（包括查询）进行分组以实现“功能内聚”，而不是按工具/技术进行分组。要允许 DBA 根据查询方式优化数据库，请使用分析器。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-22T18:01:27.903

更正：它们是否被预编译取决于数据库。例如，在 SQL Server 中，它们不是。存储过程和参数化 SQL 都在运行之前进行编译。如果存在相应的执行计划，存储过程有时可以重用执行计划……但参数化 SQL 也可以。

**编辑：** [这是 MSDN 所说的](http://msdn.microsoft.com/en-us/library/aa174792.aspx)：

> SQL Server 2000 和 SQL Server 7.0 版对语句处理进行了许多更改，将存储过程的许多性能优势扩展到所有 SQL 语句。SQL Server 2000 和 SQL Server 7.0 在创建存储过程时不保存部分编译的计划。存储过程在执行时编译，就像任何其他 Transact-SQL 语句一样。SQL Server 2000 和 SQL Server 7.0 在过程缓存中保留所有 SQL 语句的执行计划，而不仅仅是存储过程执行计划。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-22T18:06:51.577

通过使用 SP，您还可以避免让用户直接访问表。所有访问都可以通过 SP 进行控制。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-22T18:00:25.193

### 缺点

*   重构更难。重命名或更改存储过程的位置可能会产生不良影响。

*   单元测试存储过程需要数据库外部的代码帮助

### 优势

*   您无需部署即可进行更改。
*   有时更快
*   更容易扩展系统

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-22T18:02:41.553

使用当前的 .Net 3.5 框架库，我将使用 Linq 来执行大多数数据库操作。可能有些地方 SP 更有意义。但是 Linq 也有运行 SP 的规定。

关于 SP 的缺点主题，请查看以下链接 - 一个有趣的分析。检查博客文章的评论。

[http://www.spoiledtechie.com/post/Whats-up-with-Stored-Procedures-these-days.aspx](http://www.spoiledtechie.com/post/Whats-up-with-Stored-Procedures-these-days.aspx)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-22T18:07:43.553

优点：存储过程可用于维护数据完整性并强制执行数据库策略，而无需依赖外部程序来执行此操作。

缺点：会使调试更加复杂。如果没有正确完成，也可能对在复制操作期间被丢弃很敏感。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-22T19:53:46.447

另一个缺点是版本控制，因为一些业务逻辑现在在数据库端。你能轻松地从 v2（现在）回滚到 v1（一年前）吗？

一个可行的解决方案是对存储过程名称进行版本控制。但是现在数据库里乱七八糟的新旧存储过程。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-19T09:33:55.270

缺点

*   源代码控制可能很痛苦。
*   调试很困难。
*   如果您在 procs 中有很多功能，它将使不同数据库系统之间的交换变得更加困难 - 如果您想支持不同的数据库系统，它也会创建更多工作。
*   开发存储过程可能是一项相当专业的任务，尤其是当它们变得更加复杂时。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-22T18:01:00.090

我在构建应用程序时专门使用存储过程的几个原因：

*   存储过程可以是您的应用程序和底层数据库之间的接口。这样，数据库所在的服务器（通常比台式机更强大）可用于执行更复杂的过程。
*   如果您需要更改数据库的结构，如果使用存储过程作为接口，您可以这样做而不会破坏您的应用程序。
*   在您编写时，存储过程包含预编译和预测试的 SQL。
*   使用存储过程执行复杂的操作比使用客户端或 GUI 生成的 SQL 更容易。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-22T17:59:47.533

优点：DBA 可以添加应用程序不关心的行为。例如，在每一行上存储一个修改日期。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-23T18:09:18.857

优势：您的数据库相关代码更有可能由对数据库工作感兴趣且熟练的人员编写。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-11-16T05:39:48.860

我看到使用存储过程优于在应用程序代码中编写相同逻辑的优势在于，它可以减少应用程序对数据库的调用次数。

存储过程可以接收其参数并根据这些参数做出不同的决策和操作，而不是将结果返回给应用程序，然后应用程序做出决策并决定它需要执行另一个操作并进行另一个数据库调用。

性能的瓶颈几乎总是进程间通信。我尝试对数据库进行最少的调用。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-04-01T22:50:54.340

**- 存储过程的优点**

*   可重用且对任何应用程序透明。
*   安全的。
*   减少应用程序和数据库服务器之间的数据流量。
*   提高应用程序的性能。

**- 存储过程的缺点。**

*   大量的逻辑操作会增加 CPU 使用率。
*   难以调试。
*   不容易开发和维护。
*   不是为开发复杂或灵活的业务逻辑而设计的。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-22T17:59:00.513

优势：运营团队可以监控或修复生产中的问题。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-19T09:20:20.337

优点：SP 用于执行一组 sql 语句。缺点：调试复杂

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-04-20T19:12:35.793

另一个优势可能是在大型企业环境中，您可以拥有多个使用数据库的客户端应用程序和环境（例如 Web、桌面、分布在不同操作系统上的报告工具）。对于某些业务规则更改，可以在数据库中进行更改，这在所有环境中都有效。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-22T18:00:42.133

好处 -

1.  组织在一个地方（没有撒满代码）
2.  比动态查询快得多

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-05-19T08:09:28.823

它增加了服务器的负载。如果其他应用程序或多个应用程序正在使用相同的数据库服务器，它们就会变慢。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-01-26T11:10:13.447

简单的答案如下： adv：它是封装 T-SQL 代码的最强大的结构。它不限于SELECT，它支持所有的DML代码。它提供接收输入和直接返回输出。

dis: 不能在 SELECT 中调用，所以不能对多条记录运行。

# asp.net-mvc - 删除或更改 Global.asax 后的默认路由

> ID：226887
> 
> 赞同：0
> 
> 时间：2008-10-22T18:00:17.673
> 
> 标签：asp.net-mvc, httpmodule, global-asax

我正在 ASP.NET MVC 中构建一个 CMS，并希望允许用户在用户第一次访问该站点时选择他们希望默认显示的页面。

我在 Global.asax 中设置了我的默认路由，如下所示（例如）：

```
routes.MapRoute(
                "Default",                                              // Route name
                "{controller}/{action}/{id}",                           // URL with parameters
                new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
                ); 
```

但后来我想根据我从数据源中检索到的内容更改 HttpModule 中的默认路由；如何更改最初在 Global.asax 中设置的默认路由？更改 HttpModule 中的路由表是否为时已晚，如果是，我该如何实现此功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T18:23:27.610

也许我不理解这个问题，但为什么不只存储用户选择的“主页”的 URL 并将任何主页链接设置为转到该 URL 而不必担心路由？

路由是全局的，会影响所有用户，如果你要更改它，那么所有用户都会受到影响，不是吗？

# php - 如何在 PHP 中复制文件而不覆盖现有文件？

> ID：226894
> 
> 赞同：7
> 
> 时间：2008-10-22T18:00:53.163
> 
> 标签：php, file, file-io

当您使用 PHP[复制](http://us2.php.net/manual/en/function.copy.php)功能时，该操作会盲目地复制目标文件，即使它已经存在。您如何安全地复制文件，仅在没有现有文件的情况下执行复制？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-22T18:03:09.897

显而易见的解决方案是调用[file_exists](http://us2.php.net/manual/en/function.file-exists.php)来检查文件是否存在，但这样做可能会导致竞争条件。[当您调用file_exists](http://us2.php.net/manual/en/function.file-exists.php)和调用[copy](http://us2.php.net/manual/en/function.copy.php)时，总是有可能在两者之间创建另一个文件。检查文件是否存在的唯一安全方法是使用[fopen](http://us2.php.net/manual/en/function.fopen.php)。

当您调用[fopen](http://us2.php.net/manual/en/function.fopen.php)时，将模式设置为“x”。这告诉[fopen](http://us2.php.net/manual/en/function.fopen.php)创建文件，但前提是它不存在。如果它存在，[fopen](http://us2.php.net/manual/en/function.fopen.php)将失败，并且您将知道您无法创建该文件。如果成功，您将在目的地创建一个可以安全复制的文件。示例代码如下：

```
// The PHP copy function blindly copies over existing files.  We don't wish
// this to happen, so we have to perform the copy a bit differently.  The
// only safe way to ensure we don't overwrite an existing file is to call
// fopen in create-only mode (mode 'x').  If it succeeds, the file did not
// exist before, and we've successfully created it, meaning we own the
// file.  After that, we can safely copy over our own file.

$filename = 'sourcefile.txt'
$copyname = 'sourcefile_copy.txt'
if ($file = @fopen($copyname, 'x')) {
    // We've successfully created a file, so it's ours.  We'll close
    // our handle.
    if (!@fclose($file)) {
        // There was some problem with our file handle.
        return false;
    }

    // Now we copy over the file we created.
    if (!@copy($filename, $copyname)) {
        // The copy failed, even though we own the file, so we'll clean
        // up by itrying to remove the file and report failure.
        unlink($copyname);
        return false;
    }

    return true;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T18:01:54.533

我想你回答了你自己的问题 - 在执行复制之前检查以确保目标文件存在。如果文件存在，则跳过副本。

更新：我看到你确实回答了你自己的问题。您提到了竞争条件，但是如果您确实发现该文件已经存在，您怎么知道：

*   已经存在的文件确实是您要复制的文件
*   复制文件的另一个进程已经完成了它的工作（文件数据都在那里）
*   复制文件的其他进程不会失败（并留下不完整的文件，或删除新文件）

我认为在设计问题的解决方案时应该考虑这些问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-26T06:38:17.163

一个蜜獾函数，它不关心竞争条件，但可以跨平台工作。

```
function safeCopy($src, $dest) {
    if (is_file($dest) === true) {
        // if the destination file already exists, it will NOT be overwritten.        
        return false;
    }

    if (copy($src, $dest) === false) {
        echo "Failed to copy $src... Permissions correct?\n";
        return false;
    }

    return true;   
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T21:14:51.060

尝试使用该[`link()`](http://us.php.net/manual/en/function.link.php)函数而不是`copy()`.

```
function safe_copy($src, $dest) {
    if (link($src, $dest)) {
        // Link succeeded, remove old name
        unlink($filename);
        return true;
    } else {
        // Link failed; filesystem has not been altered
        return false;
    }
} 
```

不幸的是，这**不适**用于 Windows。

# delphi - 在 Windows 中未调用 exceptProc

> ID：226896
> 
> 赞同：4
> 
> 时间：2008-10-22T18:01:06.673
> 
> 标签：delphi, exception, exception-handling

我目前正在尝试创建一个内置到我的 Windows 服务中的异常处理程序，当出现未处理的异常时，它会向另一个程序发送消息。我已经构建了该方法并使通信正常工作，但似乎每次我的程序抛出错误时，（我在代码中有一个 raise 调用来强制它。）windows 会捕获它而不调用 Handler。谁能解释我做错了什么？

简化代码解释：

```
procedure unhandled();
  begin
    raise Exception.Create('Unhandled');
  end;

procedure ExceptionHandler(ExceptObject: TObject; ExceptAddr: Pointer);
  begin
    WriteLn('Display: ' + Exception(ExceptObject).Message);
    //send Message Here
  end; 
```

我调用这段代码来运行它：

```
WriteLn('Starting');    

ExceptProc := @ExceptionHandler;    

unhandled(); 
```

我希望输出是：

> 起始
> 显示：未处理

但它所做的只是显示：

> 开始

然后 Windows 在大约 5 秒后返回命令提示符。

为什么没有正确调用处理程序？

PS 我一直在控制台应用程序中运行这些测试以进行测试。

编辑：

这里有一些更多信息：

显然，当您有一个分配的 exceptProc 时，您的程序不应该抛出正常的运行时 217 错误。我猜这就是windows正在捕获的东西，但是据我所见，我的程序正在抛出运行时错误，我也无法让ErrorProc来捕获它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-22T19:50:36.780

您错过了对[SetErrorMode()](http://msdn.microsoft.com/en-us/library/ms680621(VS.85).aspx)的调用：

```
SetErrorMode(SEM_NOGPFAULTERRORBOX); 
```

这是防止操作系统[未处理的异常过滤器](http://msdn.microsoft.com/en-us/library/ms681401(VS.85).aspx)显示对话框/显示调试器附加对话框所必需的。这是一个在我的机器上按预期运行的完整示例：

```
{$apptype console}

uses Windows, SysUtils;

procedure unhandled();
begin
  raise Exception.Create('Unhandled');
end;

procedure ExceptionHandler(ExceptObject: TObject; ExceptAddr: Pointer);
begin
  Writeln('here');
  WriteLn('Display: ' + Exception(ExceptObject).Message);
  Flush(Output);
  Halt(1);
end;

procedure Go;
begin
  unhandled;
end;

begin
  ExceptProc := @ExceptionHandler;
  SetErrorMode(SEM_NOGPFAULTERRORBOX);
  Go;
end. 
```

请注意，SetErrorMode() 的效果在正在运行的进程中的所有线程中都是全局的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T18:45:55.537

有趣的。

如果您在 Delphi IDE 中运行应用程序（在 2007 中尝试过），则会调用自定义异常处理程序，但如果您从命令提示符运行它则不会。

另一个有趣的事情 - 我将主程序代码更改为

```
begin
  WriteLn('Starting');
  try
    ExceptProc := @ExceptionHandler;
    Unhandled;
  finally Readln; end;
end. 
```

并注意到只有在我按下 Enter 键后才会显示异常消息（以获取 Readln 的一些输入）。因此，当异常发生时不会调用您的处理程序，而是在处理它时调用（在包含所有代码的隐式 try..except 中）。有道理。

必须是这个隐式尝试的东西..除了那个，但我在这台机器上缺少一个非 Delphi 调试器，无法进一步挖掘。也许其他人知道答案...

# sql-server - 如何运行非常大的查询（SQL Server 和 ColdFusion）

> ID：226899
> 
> 赞同：4
> 
> 时间：2008-10-22T18:01:42.617
> 
> 标签：sql-server, coldfusion

我有一个相当简单的查询（这次），我需要返回所有结果（我将它们存储在 Excel 电子表格中）。查询本身会使服务器超时，那么如何在不发生这种情况的情况下运行它呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-22T18:18:40.320

您可以增加页面的请求超时时间：

```
<cfsetting requestTimeout="3600" /> 
```

这将确保您有时间处理所有条目。

您可能还想将列表分成“块”。需要进行一些调整才能确定最佳块大小是多少，但您可以一次获取 100 或 1000 行结果，并在结果可用时使用 <cfflush> 将结果推送到屏幕上。这种方法还具有在冷融合服务器上使用更少内存的优点，因为从 SQL 服务器拉回的每一行都被加载到 CFML 内存中，并坐在那里直到查询对象变量被覆盖或超出范围（在这页纸）。这意味着您可以轻松地填满读取数十万行的coldFusion 内存，特别是如果这些行是“宽”的（即包含大的varchars 或文本）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-24T18:33:42.210

首先我会检查为什么这个查询需要这么长时间。

您可以在数据库级别做些什么来提高查询的性能。听起来你可能没有正确索引数据库。获取查询并将其放入可以分析执行计划的程序中。寻找滞后并解决它们。

为了获得更高的性能，如果您的数据库支持这种事情，请考虑创建索引视图。

接下来看看将查询的某些部分缓存出来。没有理由对每个请求的历史数据进行计算，因为它可以完成一次，然后缓存在某个地方的表中。

至于冷聚结束。确保您使用 java.io.BufferedWriter 创建电子表格。在 CF 中使用普通的字符串连接方法很慢，而 BufferedWriter 则无限快。附件是我创建的用于创建制表符分隔电子表格的 CFC，您可以对其进行修改以满足您的需要。

```
<!--- init --->
<cffunction name="init" access="public" returntype="Any" output="false">
    <cfargument name="name" type="string" required="true">
    <cfset var local = {}>

    <!--- name of file when downloading --->
    <cfset variables.name = arguments.name & ".xls">
    <!--- name of temp file --->
    <cfset variables.filename = CreateUUID() & ".csv">
    <!--- full path to temp file for downloading --->
    <cfset variables.fullfilename = expandpath("/_temp") & "\" & variables.filename>
    <!--- file write java object --->
    <cfset variables.filewriter = CreateObject("java","java.io.FileWriter").init(
            variables.fullfilename
            ,JavaCast("boolean","true")
        )>
    <!--- buffered writer java object --->
    <cfset variables.bufferedwriter = CreateObject("java","java.io.BufferedWriter").init(
                variables.filewriter
            )>
    <!--- row delimeter --->
    <cfset variables.row = chr(10)>
    <!--- col delimeter --->
    <cfset variables.col = chr(9)>
    <!--- header container --->
    <cfset variables.headers = []>
    <!--- data container --->
    <cfset variables.data = []>
    <cfset newrow()>
    <cfreturn this>
</cffunction>

<!--- addheader --->
<cffunction name="addheader" access="public" returntype="void" output="false">
    <cfargument name="str" type="string" required="true">
    <cfset arrayappend(variables.headers, arguments.str)>
</cffunction>

<!--- newrow --->
<cffunction name="newrow" access="public" returntype="void" output="false">
    <cfset arrayappend(variables.data, arraynew(1))>
    <cfset variables.data_counter = arraylen(variables.data)>
</cffunction>

<!--- adddata --->
<cffunction name="adddata" access="public" returntype="void" output="false">
    <cfargument name="str" type="string" required="true">
    <cfset arrayappend(variables.data[variables.data_counter], arguments.str)>
</cffunction>

<!--- flush --->
<cffunction name="flush" access="public" returntype="void" output="false">
    <cfset var local = {}>

    <!--- write headers --->
    <cfset local.counter = 0>
    <cfset local.headers_count = arraylen(variables.headers)>
    <cfloop array="#variables.headers#" index="local.header">
        <cfset local.counter++>
        <cfset variables.bufferedwriter.write(local.header & variables.col)>
    </cfloop>

    <cfif not arrayisempty(variables.headers)>
        <cfset variables.bufferedwriter.write(variables.row)>
    </cfif>

    <!--- write data --->
    <cfloop array="#variables.data#" index="local.data">
        <cfloop array="#local.data#" index="local.cell">
            <cfset variables.bufferedwriter.write(local.cell & variables.col)>
        </cfloop>
        <cfset variables.bufferedwriter.write(variables.row)>
    </cfloop>

    <cfset variables.bufferedwriter.close()>
    <cfsetting showdebugoutput="No">
    <cfheader name="Content-Description" value="File Transfer">
    <cfheader name="Content-Disposition" value="attachment;filename=#variables.name#">
    <cfcontent type="application/vnd.ms-excel" file="#variables.fullfilename#" deletefile="true" reset="true">
</cffunction> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-22T18:59:57.350

正如其他人指出的那样，您可以尝试增加页面的请求超时，但如果您的查询执行以*分钟*而不是秒或毫秒为单位，则不建议这样做。CF 一次只会处理一定数量的请求，因此您要小心锁定其中一个等待 5 分钟查询完成的请求。

如果您使用的是 SQL Server 或 Oracle，我认为 CFQUERY 公开了您可以设置的每个查询超时属性。同样，这对于真正长时间运行的查询是不可取的。

根据我的经验，如果您的查询非常复杂，或者返回的数据太多，以至于需要*几分钟*才能运行，那么是时候将查询的执行与启动它的请求分离了。有多种方法可以做到这一点，例如：

1.  创建某种排队系统来记录待处理的服务请求。这可能是一个数据库表、磁盘上的一个 XML 文件等。当您的用户请求他们的数据时，您在此队列中注册该请求。

2.  编写一个计划任务（例如 Java、DTS 或计划的 CF 页面），定期检查此队列的工作。根据您的需要，您可能会分拆一个后台线程来处理每个请求，或者计划任务直接处理它。如果您正在使用计划的 CF 页面，您需要将总工作量分解为可以迭代处理的更小的块，否则您将遇到与现在相同的问题。

3.  一旦计划任务确定请求已完成，它就会启动某种处理已准备就绪的通知。例如，您可能会通过电子邮件向用户发送电子邮件，告诉他们数据已准备就绪，并附上一个链接以下载在磁盘上创建的 .csv 文件。

显然，正确的选择很大程度上取决于要解决的具体问题。一般来说，我会按以下顺序尝试这些事情：

1.  积极攻击查询执行时间。您可以使用索引或编写更好的 T-SQL 吗？
2.  如果查询需要一两分钟，并且运行频率很低，增加页面或查询超时可能是可以接受的。
3.  如果查询经常运行，或者耗时超过 2-3 分钟，则硬着头皮构建一个批处理或排队系统来在后台处理查询。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T18:10:45.873

最简单的方法是将查询的域分成几个部分。例如，向 WHERE 子句添加一个仅选择键范围前半部分的表达式，然后运行第二个查询以选择下半部分。然后合并输出。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-22T18:18:38.853

尽管合并多个查询可能是更好的方法，但您可以根据每个请求设置超时。

```
<cfsetting 
enableCFoutputOnly = "yes|no" 
requestTimeOut = "value in seconds"
showDebugOutput = "yes|no" > 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-01T13:23:28.060

正确使用索引。尽可能创建外键。对于标准化的数据库，查询永远不会超时。

对连接和子句要非常小心，比如如果你`group by`的查询中有子句而不是 using`where`子句，`having`子句会运行得更快。从而减少查询执行时间。

使用成本估算来检查数据库中哪个表花费的时间最多或需要规范化。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-23T02:29:01.733

我会将查询放入单独的线程中，将其加载到持久范围（例如会话）中。转发到检查查询是否存在的页面。重复检查直到查询存在，然后转发到显示/处理/不管它的页面。

# html - Internet Explorer Web 开发人员工具栏是否适用于弹出窗口？

> ID：226905
> 
> 赞同：11
> 
> 时间：2008-10-22T18:02:53.550
> 
> 标签：html, internet-explorer, debugging, popup, web-developer-toolbar

我无法让 Internet Explorer Web 开发人员工具栏与弹出窗口一起使用，它不会在弹出窗口的底部呈现。有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-04T15:54:40.547

有一种*非常*具体的方法可以做到这一点：

1.  `F12`在主浏览器窗口中打开开发人员工具（通过或其他方式）。确保开发人员工具“固定”到此窗口。
2.  做任何你做的事情来打开弹出窗口
3.  `F12`打开弹出窗口的开发人员工具（通过或其他方式）
4.  `unpin`弹出窗口中的开发人员工具窗口 ( `CTRL`+ )`P`
5.  关闭弹出窗口（这也会自动关闭开发者工具窗口）
6.  保持开发者工具在主浏览器窗口中打开，再次打开弹出窗口。开发者工具窗口应该会自动打开。

您现在还应该能够通过切换主窗口中的开发人员工具来控制是否为弹出窗口打开开发人员工具。无论如何，这对我来说就是这样！顺便说一句，这一切都在 Windows 7 上的 IE9 上......

所有这一切的唯一问题是，如果您需要调试仅在第一次启动弹出窗口时发生的事情......

这正是我遇到的问题 - 我有一个符合 SCORM 的电子学习课程，它在一个弹出窗口中启动，并且它有一个错误，只有在第一次在 IE 中启动课程时才会发生！那好吧...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-10T03:05:55.493

我很确定它不适用于模态弹出窗口。如果您将弹出窗口作为模式打开，您可能必须将代码更改为无模式，仅出于调试目的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T18:38:28.110

我刚刚在我的机器上试过这个，它似乎工作正常。确保您使用的是[最新版本](http://www.microsoft.com/downloads/details.aspx?familyid=e59c3964-672d-4511-bb3e-2d5e1db91038&displaylang=en)

否则更新您的问题，我会再次尝试提供帮助。

更新：确保在弹出窗口触发之前工具栏停靠到您的父窗口。当我停靠工具栏时（使用窗口右上角的小停靠图标），它似乎跟随新的弹出窗口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-10T22:38:20.760

使用 IE8，与 IE7 中极其有限的一组开发工具相比，它有一套大大改进的开发工具。按 F12 在弹出窗口中打开开发人员工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-16T09:01:20.193

在页面的代码中添加 Javascript 错误，例如 blabla();。它将使 IE 显示 Javascript 错误对话框，您可以从中启动开发工具。我认为您需要有 Javascript 错误消息：

工具 - Internet 选项，高级选项卡 确保选中“显示有关每个脚本错误的通知”。

这不是一个理想的解决方案，但如果在无模式对话框产生的结果与模态对话框中的结果不同时，您确实需要在模态对话框模式下进行调试，则可以提供帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-19T04:11:50.783

几天前我[在 Twitter 上分享了一个解决方法。](https://twitter.com/johnleniel/status/445024889456828416)使用时很有用[`IE 11 Developer Tools`](http://msdn.microsoft.com/en-us/library/ie/bg182326%28v=vs.85%29.aspx)：

*   右键单击`popup`窗口内容
*   选择`Inspect Element`以附加调试器。
*   再次右键单击并点击`Refresh`以查看`Console`.

我仍然希望能够`debugger`预先获得附加的，也就是说，除了能够在刷新后调试弹出窗口之外，我还希望能够调试弹出窗口的第一次加载事件，即第一次它是开放 - 但我还没有找到实现这一目标的方法。

# java - 如何在 Java 中健全地检查日期

> ID：226910
> 
> 赞同：90
> 
> 时间：2008-10-22T18:04:08.710
> 
> 标签：java, validation, calendar, date

我觉得奇怪的是，`Date`在 Java 中创建对象的最明显方法已被弃用，并且似乎已被不那么明显的使用宽松日历“取代”。

您如何检查以日、月和年的组合形式给出的日期是否为有效日期？

例如，2008-02-31（如 yyyy-mm-dd）将是无效日期。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2010-12-24T19:46:19.473

关键是**df.setLenient(false);** . 这对于简单的情况来说绰绰有余。如果您正在寻找更强大（我怀疑）和/或替代库（如 joda-time），请查看[用户“tardate”的答案](https://stackoverflow.com/a/892204/1076848)

```
final static String DATE_FORMAT = "dd-MM-yyyy";

public static boolean isDateValid(String date) 
{
        try {
            DateFormat df = new SimpleDateFormat(DATE_FORMAT);
            df.setLenient(false);
            df.parse(date);
            return true;
        } catch (ParseException e) {
            return false;
        }
} 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-05-21T10:08:16.217

如@Maglob 所示，基本方法是使用[SimpleDateFormat.parse](http://java.sun.com/j2se/1.5.0/docs/api/java/text/SimpleDateFormat.html)测试从字符串到日期的转换。这将捕获无效的日/月组合，如 2008-02-31。

然而，在实践中这很少足够，因为 SimpleDateFormat.parse 非常自由。您可能会担心两种行为：

**日期字符串中的无效字符** 令人惊讶的是，2008-02-2x 将作为有效日期“通过”，例如区域设置格式 =“yyyy-MM-dd”。即使 isLenient==false。

**年份：2、3 或 4 位数字？** 您可能还希望强制执行 4 位数年份，而不是允许默认的 SimpleDateFormat 行为（这将根据您的格式是“yyyy-MM-dd”还是“yy-MM-dd”以不同方式解释“12-02-31” )

## 标准库的严格解决方案

因此，完整的字符串到日期测试可能如下所示：正则表达式匹配的组合，然后是强制日期转换。正则表达式的诀窍是使其对语言环境友好。

```
 Date parseDate(String maybeDate, String format, boolean lenient) {
    Date date = null;

    // test date string matches format structure using regex
    // - weed out illegal characters and enforce 4-digit year
    // - create the regex based on the local format string
    String reFormat = Pattern.compile("d+|M+").matcher(Matcher.quoteReplacement(format)).replaceAll("\\\\d{1,2}");
    reFormat = Pattern.compile("y+").matcher(reFormat).replaceAll("\\\\d{4}");
    if ( Pattern.compile(reFormat).matcher(maybeDate).matches() ) {

      // date string matches format structure, 
      // - now test it can be converted to a valid date
      SimpleDateFormat sdf = (SimpleDateFormat)DateFormat.getDateInstance();
      sdf.applyPattern(format);
      sdf.setLenient(lenient);
      try { date = sdf.parse(maybeDate); } catch (ParseException e) { }
    } 
    return date;
  } 

  // used like this:
  Date date = parseDate( "21/5/2009", "d/M/yyyy", false); 
```

请注意，正则表达式假定格式字符串仅包含日、月、年和分隔符。除此之外，格式可以是任何语言环境格式：“d/MM/yy”、“yyyy-MM-dd”等。当前语言环境的格式字符串可以这样获得：

```
Locale locale = Locale.getDefault();
SimpleDateFormat sdf = (SimpleDateFormat)DateFormat.getDateInstance(DateFormat.SHORT, locale );
String format = sdf.toPattern(); 
```

## Joda Time - 更好的选择？

我最近一直在听说[joda time](http://joda-time.sourceforge.net/)，我想我会比较一下。两点：

1.  与 SimpleDateFormat 不同，似乎更擅长严格处理日期字符串中的无效字符
2.  还看不到强制执行 4 位数年份的方法（但我想您可以为此创建自己的[DateTimeFormatter ）](http://joda-time.sourceforge.net/api-release/org/joda/time/format/DateTimeFormatter.html)

使用起来非常简单：

```
import org.joda.time.format.*;
import org.joda.time.DateTime;

org.joda.time.DateTime parseDate(String maybeDate, String format) {
  org.joda.time.DateTime date = null;
  try {
    DateTimeFormatter fmt = DateTimeFormat.forPattern(format);
    date =  fmt.parseDateTime(maybeDate);
  } catch (Exception e) { }
  return date;
} 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2008-10-22T19:35:44.750

您可以使用[SimpleDateFormat](http://java.sun.com/j2se/1.5.0/docs/api/java/text/SimpleDateFormat.html)

例如：

```
boolean isLegalDate(String s) {
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
    sdf.setLenient(false);
    return sdf.parse(s, new ParsePosition(0)) != null;
} 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2008-10-22T18:08:07.970

当前的方法是使用日历类。它具有[setLenient](http://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html#setLenient%28boolean%29)方法，该方法将验证日期并在超出范围时抛出异常，如您的示例所示。

忘了补充：如果您获得日历实例并使用您的日期设置时间，这就是您获得验证的方式。

```
Calendar cal = Calendar.getInstance();
cal.setLenient(false);
cal.setTime(yourDate);
try {
    cal.getTime();
}
catch (Exception e) {
  System.out.println("Invalid date");
} 
```

* * *

## 回答 #5

> 赞同：34
> 
> 时间：2016-09-22T22:25:09.833

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2014-05-02T22:55:28.550

# java.time

通过Java 8 及更高版本中内置的[日期和时间 API](https://docs.oracle.com/javase/tutorial/datetime/)（[java.time](https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)[`LocalDate`](https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html)类），您可以使用该类。

```
public static boolean isDateValid(int year, int month, int day) {
    try {
        LocalDate.of(year, month, day);
    } catch (DateTimeException e) {
        return false;
    }
    return true;
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-05-29T11:54:10.963

基于[Aravind解决](https://stackoverflow.com/questions/226910/how-to-sanity-check-a-date-in-java/4528094#4528094)[ceklock 在他的评论中](https://stackoverflow.com/questions/226910/how-to-sanity-check-a-date-in-java/30528952#comment35086192_4528094)指出的问题的答案，我添加了一种方法来验证`dateString`不包含任何无效字符。

这是我的做法：

```
private boolean isDateCorrect(String dateString) {
    try {
        Date date = mDateFormatter.parse(dateString);
        Calendar calendar = Calendar.getInstance();
        calendar.setTime(date);
        return matchesOurDatePattern(dateString);    //added my method
    }
    catch (ParseException e) {
        return false;
    }
}

/**
 * This will check if the provided string matches our date format
 * @param dateString
 * @return true if the passed string matches format 2014-1-15 (YYYY-MM-dd)
 */
private boolean matchesDatePattern(String dateString) {
    return dateString.matches("^\\d+\\-\\d+\\-\\d+");
} 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2010-04-12T14:00:28.113

使用标准库的另一种严格解决方案是执行以下操作：

1）使用您的模式创建一个严格的 SimpleDateFormat

2) 尝试使用格式对象解析用户输入的值

3）如果成功，使用相同的日期格式（来自（1））重新格式化（2）产生的日期

4) 将重新格式化的日期与用户输入的原始值进行比较。如果它们相等，则输入的值与您的模式严格匹配。

这样，您不需要创建复杂的正则表达式——在我的例子中，我需要支持所有 SimpleDateFormat 的模式语法，而不是仅限于某些类型，例如天、月和年。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-07-17T21:33:01.917

我建议你使用`org.apache.commons.validator.GenericValidator`apache 的类。

`GenericValidator.isDate(String value, String datePattern, boolean strict);`

注意：严格 - 是否与 datePattern 完全匹配。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-02-04T09:49:20.663

我认为最简单的就是将字符串转换为日期对象并将其转换回字符串。如果两个字符串仍然匹配，则给定的日期字符串很好。

```
public boolean isDateValid(String dateString, String pattern)
{   
    try
    {
        SimpleDateFormat sdf = new SimpleDateFormat(pattern);
        if (sdf.format(sdf.parse(dateString)).equals(dateString))
            return true;
    }
    catch (ParseException pe) {}

    return false;
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-12-24T19:45:01.603

假设这两个都是字符串（否则它们已经是有效的日期），这是一种方法：

```
package cruft;

import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;

public class DateValidator
{
    private static final DateFormat DEFAULT_FORMATTER;

    static
    {
        DEFAULT_FORMATTER = new SimpleDateFormat("dd-MM-yyyy");
        DEFAULT_FORMATTER.setLenient(false);
    }

    public static void main(String[] args)
    {
        for (String dateString : args)
        {
            try
            {
                System.out.println("arg: " + dateString + " date: " + convertDateString(dateString));
            }
            catch (ParseException e)
            {
                System.out.println("could not parse " + dateString);
            }
        }
    }

    public static Date convertDateString(String dateString) throws ParseException
    {
        return DEFAULT_FORMATTER.parse(dateString);
    }
} 
```

这是我得到的输出：

```
java cruft.DateValidator 32-11-2010 31-02-2010 04-01-2011
could not parse 32-11-2010
could not parse 31-02-2010
arg: 04-01-2011 date: Tue Jan 04 00:00:00 EST 2011

Process finished with exit code 0 
```

如您所见，它确实可以很好地处理您的两种情况。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-09-06T20:38:08.320

这对我很有用。本建议的方法。

```
private static boolean isDateValid(String s) {
    SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
    try {
        Date d = asDate(s);
        if (sdf.format(d).equals(s)) {
            return true;
        } else {
            return false;
        }
    } catch (ParseException e) {
        return false;
    }
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-07-30T09:04:15.807

看起来即使在*setLenient(false);之后****SimpleDateFormat也没有严格检查模式；***方法应用在它上面，所以我使用下面的方法来验证输入的日期是否是有效的日期，或者不是按照提供的模式。

 *```
import java.time.format.DateTimeFormatter;
import java.time.format.DateTimeParseException;
public boolean isValidFormat(String dateString, String pattern) {
    boolean valid = true;
    DateTimeFormatter formatter = DateTimeFormatter.ofPattern(pattern);
    try {
        formatter.parse(dateString);
    } catch (DateTimeParseException e) {
        valid = false;
    }
    return valid;
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-21T15:03:45.370

关于使用 SimpleDateFormat 的两条评论。

> 如果声明为静态访问，则应将其声明为静态实例，因为它不是线程安全的，因此应同步访问

比为每个日期解析实例化一个实例更好的 IME。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-03-13T10:11:44.423

上面的日期解析方法很好，我只是在现有方法中添加了新的检查，使用格式化程序仔细检查转换后的日期和原始日期，所以它几乎适用于我验证的每种情况。例如 02/29/2013 是无效日期。给定函数根据当前可接受的日期格式解析日期。如果日期未成功解析，则返回 true。

```
 public final boolean validateDateFormat(final String date) {
        String[] formatStrings = {"MM/dd/yyyy"};
        boolean isInvalidFormat = false;
        Date dateObj;
        for (String formatString : formatStrings) {
            try {
                SimpleDateFormat sdf = (SimpleDateFormat) DateFormat.getDateInstance();
                sdf.applyPattern(formatString);
                sdf.setLenient(false);
                dateObj = sdf.parse(date);
                System.out.println(dateObj);
                if (date.equals(sdf.format(dateObj))) {
                    isInvalidFormat = false;
                    break;
                }
            } catch (ParseException e) {
                isInvalidFormat = true;
            }
        }
        return isInvalidFormat;
    } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-09-01T16:51:24.840

这是我为 Node 环境所做的，没有使用外部库：

```
Date.prototype.yyyymmdd = function() {
   var yyyy = this.getFullYear().toString();
   var mm = (this.getMonth()+1).toString(); // getMonth() is zero-based
   var dd  = this.getDate().toString();
   return zeroPad([yyyy, mm, dd].join('-'));  
};

function zeroPad(date_string) {
   var dt = date_string.split('-');
   return dt[0] + '-' + (dt[1][1]?dt[1]:"0"+dt[1][0]) + '-' + (dt[2][1]?dt[2]:"0"+dt[2][0]);
}

function isDateCorrect(in_string) {
   if (!matchesDatePattern) return false;
   in_string = zeroPad(in_string);
   try {
      var idate = new Date(in_string);
      var out_string = idate.yyyymmdd();
      return in_string == out_string;
   } catch(err) {
      return false;
   }

   function matchesDatePattern(date_string) {
      var dateFormat = /[0-9]+-[0-9]+-[0-9]+/;
      return dateFormat.test(date_string); 
   }
} 
```

以下是如何使用它：

```
isDateCorrect('2014-02-23')
true 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-07-05T05:09:04.280

```
// to return valid days of month, according to month and year
int returnDaysofMonth(int month, int year) {
    int daysInMonth;
    boolean leapYear;
    leapYear = checkLeap(year);
    if (month == 4 || month == 6 || month == 9 || month == 11)
        daysInMonth = 30;
    else if (month == 2)
        daysInMonth = (leapYear) ? 29 : 28;
    else
        daysInMonth = 31;
    return daysInMonth;
}

// to check a year is leap or not
private boolean checkLeap(int year) {
    Calendar cal = Calendar.getInstance();
    cal.set(Calendar.YEAR, year);
    return cal.getActualMaximum(Calendar.DAY_OF_YEAR) > 365;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-10-31T21:07:13.677

这是我要检查的日期格式：

```
 public static boolean checkFormat(String dateTimeString) {
    return dateTimeString.matches("^\\d{4}-\\d{2}-\\d{2}") || dateTimeString.matches("^\\d{4}-\\d{2}-\\d{2}\\s\\d{2}:\\d{2}:\\d{2}")
            || dateTimeString.matches("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}") || dateTimeString
            .matches("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z") ||
            dateTimeString.matches("^\\d{4}-\\d{2}-\\d{2}\\s\\d{2}:\\d{2}:\\d{2}Z");
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-07-04T12:52:23.463

```
 public static String detectDateFormat(String inputDate, String requiredFormat) {
        String tempDate = inputDate.replace("/", "").replace("-", "").replace(" ", "");
        String dateFormat;

        if (tempDate.matches("([0-12]{2})([0-31]{2})([0-9]{4})")) {
            dateFormat = "MMddyyyy";
        } else if (tempDate.matches("([0-31]{2})([0-12]{2})([0-9]{4})")) {
            dateFormat = "ddMMyyyy";
        } else if (tempDate.matches("([0-9]{4})([0-12]{2})([0-31]{2})")) {
            dateFormat = "yyyyMMdd";
        } else if (tempDate.matches("([0-9]{4})([0-31]{2})([0-12]{2})")) {
            dateFormat = "yyyyddMM";
        } else if (tempDate.matches("([0-31]{2})([a-z]{3})([0-9]{4})")) {
            dateFormat = "ddMMMyyyy";
        } else if (tempDate.matches("([a-z]{3})([0-31]{2})([0-9]{4})")) {
            dateFormat = "MMMddyyyy";
        } else if (tempDate.matches("([0-9]{4})([a-z]{3})([0-31]{2})")) {
            dateFormat = "yyyyMMMdd";
        } else if (tempDate.matches("([0-9]{4})([0-31]{2})([a-z]{3})")) {
            dateFormat = "yyyyddMMM";
        } else {
            return "Pattern Not Added";
//add your required regex
        }
        try {
            String formattedDate = new SimpleDateFormat(requiredFormat, Locale.ENGLISH).format(new SimpleDateFormat(dateFormat).parse(tempDate));

            return formattedDate;
        } catch (Exception e) {
            //
            return "";
        }

    } 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-07-05T17:28:20.473

如果您喜欢严格验证，则将 setLenient 设置为 false

```
public boolean isThisDateValid(String dateToValidate, String dateFromat){

    if(dateToValidate == null){
        return false;
    }

    SimpleDateFormat sdf = new SimpleDateFormat(dateFromat);
    sdf.setLenient(false);

    try {

        //if not valid, it will throw ParseException
        Date date = sdf.parse(dateToValidate);
        System.out.println(date);

    } catch (ParseException e) {

        e.printStackTrace();
        return false;
    }

    return true;
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-10-02T21:32:38.420

使用“旧”日期格式，我们可以格式化结果并将其与源进行比较。

```
 public boolean isValidFormat(String source, String pattern) {
    SimpleDateFormat sd = new SimpleDateFormat(pattern);
    sd.setLenient(false);
    try {
        Date date = sd.parse(source);
        return date != null && sd.format(date).equals(source);
    } catch (Exception e) {
        return false;
    }
} 
```

这段摘录对 source=01.01.04 说“假”，模式为“01.01.2004”

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-06-21T13:40:24.473

我们可以`org.apache.commons.validator.GenericValidator`直接使用 's 方法而无需添加整个库：

```
public static boolean isValidDate(String value, String datePattern, boolean strict) {

    if (value == null
            || datePattern == null
            || datePattern.length() <= 0) {

        return false;
    }

    SimpleDateFormat formatter = new SimpleDateFormat(datePattern, Locale.ENGLISH);
    formatter.setLenient(false);

    try {
        formatter.parse(value);
    } catch(ParseException e) {
        return false;
    }

    if (strict && (datePattern.length() != value.length())) {
        return false;
    }

    return true;
} 
```

# winforms - 是否有生成 Winform 代码的应用程序？

> ID：226924
> 
> 赞同：2
> 
> 时间：2008-10-22T18:08:45.643
> 
> 标签：winforms, code-generation

我需要一个简单的应用程序来编辑数据库表。是否有任何代码生成器可以在 c# 中生成 winforms？我有 CodeSmith，是否有任何模板可以帮助执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-23T18:45:22.263

我认为[NConstruct](http://www.nconstruct.com/)可能适合您的需求 - 它生成 Winforms（也可以选择 Web 表单），您可以获得完整的 C# 源代码。您将获得基于[NHibernate](http://www.hibernate.org/) OR/M 框架的应用程序服务器和通过 .NET 远程处理与应用程序服务器通信的客户端应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T18:10:29.510

SQL 管理工作室。

严肃的回答，codesmith 的 .NetTiers 可能会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T18:09:57.340

我假设您在谈论.Net？你看过 Visual Studio 吗？SharpDevelop 也这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T13:34:35.390

查看[DevExpress eXpressApp 框架](http://www.devexpress.com/Products/NET/Application_Framework/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-01T11:03:43.837

使用 Rocket Framework，它是免费的，您可以在托管的 CodePlex 站点上找到详细信息。Rocket Framework 的链接如下

[http://rocketframework.codeplex.com/](http://rocketframework.codeplex.com/)

# java - 从 SWT 浏览器捕获 window.print()

> ID：226929
> 
> 赞同：0
> 
> 时间：2008-10-22T18:10:10.773
> 
> 标签：java, api, browser, swt

我正在探索具有以下功能的浏览器解决方案/API：

*   必须支持当今的默认 Web 技术
*   必须支持客户端 XSLT
*   必须支持在其加载的页面上执行任意 Javascript
*   必须能够从针对浏览器或操作系统的网页中捕获事件（我对 window.print() 特别感兴趣）

QtWebkit 似乎是要走的路，但它仍然不支持 XSLT，所以我不得不寻找替代方案。SWT 浏览器是底层系统的本机浏览器组件的包装器，在我感兴趣的 linux 中，这意味着支持我感兴趣的属性的 Firefox 引擎，除了我还没有找到如何捕获窗口.print() 并提供我自己的实现，而不是打开打印对话框的默认实现。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-24T19:07:52.890

如果您知道如何在 javascript 中捕获事件并阻止显示本机对话框，则可以使用此代码段中显示的方法[在](http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.swt.snippets/src/org/eclipse/swt/snippets/Snippet303.java?view=co)SWT 代码中捕获事件。

不过，另一种选择可能会更好：使用 mozilla 的类来注册您自己的打印处理程序。[下载处理程序的此代码段](http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.swt.snippets/src/org/eclipse/swt/snippets/Snippet277.java?view=co)中显示了类似的内容，但我尚未测试打印处理程序是否也可以。

第二个选项的问题在代码片段的 javadoc 中说明：

> 重要提示：要使此代码段正常工作，必须满足在独立应用程序中使用 JavaXPCOM 的所有要求（请参阅[http://www.eclipse.org/swt/faq.php#howusejavaxpcom](http://www.eclipse.org/swt/faq.php#howusejavaxpcom)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-27T13:37:31.340

FWIW 还有另一种方法可以在[http://www.eclipse.org/forums/index.php?t=msg&th=166869&start=0&](http://www.eclipse.org/forums/index.php?t=msg&th=166869&start=0&)使用基于 Mozilla 的 SWT 浏览器。

# c# - 如何使用角色或组合在 NHibernate 中映射类

> ID：226931
> 
> 赞同：6
> 
> 时间：2008-10-22T18:10:26.810
> 
> 标签：c#, nhibernate

我相信这是一个常见的问题/问题，但无法找到一个简洁明了的好答案。

**问题**

如何映射看似具有继承关系的实体：

```
Company
  Supplier
  Manufacturer
  Customer 
```

但是，供应商可以是制造商。

或者

```
Person
  Doctor
  Patient
  Employee 
```

患者可以是医生也可以是员工。

**建议：使用角色**

在 NHibernate 论坛上的讨论中，反应通常是这是多重继承。

[http://forum.hibernate.org/viewtopic.php?t=959076](http://forum.hibernate.org/viewtopic.php?t=959076)

他们建议的解决方案是使用组合或使用“角色”。但是，我找不到任何关于如何做到这一点的示例或解释。

> “有利于组合而不是继承。” 还记得课堂上的那个小礼物吗？在这种情况下，我必须同意您正在尝试多重继承——在 C# 或 Java 中（还）不可能。我个人会鼓励您考虑重新建模，以便您拥有一个 Person 对象，并且一个人拥有一对多的角色集合。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T23:41:07.173

您可能要考虑使用角色。所以一个角色将有一组人。或者一个人将有一组角色或两者兼而有之。这可能意味着有一个将人员映射到角色的关联类。

定义一个 Person 类，其中包含人们共有的所有属性。然后定义一个 Role 超类和 DoctorRole、PatientRole 和 EmployeeRole 子类（假设每个角色有不同的属性）。

Person 类可以定义一个角色集合，Role 类可以定义一个人集合。或者创建一个关联类可能更容易，我们称之为 PeopleRole。

[本页](http://www.hibernate.org/hib_docs/nhibernate/html/example-mappings.html)说明了如何进行映射，以使 PeopleRole 成为一个复合元素。查看 Order/Product/LineItem 示例。你的 Person 就像 Order，PeopleRole 就像 LineItem，Role 就像 Product。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T09:32:15.560

在我看来，这更像是一个关于如何很好地建模域的问题，而不是 NHibernate 映射问题。

一旦你整理了你的领域建模，我想你会发现 NHibernate 映射相对容易失败。

了解角色建模想法的一个地方是寻找“[颜色建模](http://en.wikipedia.org/wiki/UML_colors)” - [Jeff de Luca](http://www.nebulon.com/)有[一些资源](http://www.nebulon.com/articles/fdd/adsposters.html)，尽管这个想法起源于[Peter Coad](http://en.wikipedia.org/wiki/Peter_Coad)

基本思想是将参与者的身份与他们在活动中扮演的角色分开。

例如，您可能有一个 Person 对象来捕获特定人员的身份。

然后，一个完全独立的对象“学生”捕获附加信息以记录一个人作为学生的注册。每个 Student 实例都会引用注册的人。一个人可能与许多“学生”记录相关，每个不同的注册都有一个。

同时，您可以有一个独特的“Tutor”对象，当有人被聘请在一对一的情况下教授学生时，它会记录就业细节。Tutor 对象捕获有关某人如何被聘为导师的其他详细信息。

这种结构为您提供了极大的灵活性——一个人（Joe Bloggs）可能只是一名学生，另一个人（Jane Doe）可能只是一名导师，而第三个人（Chuck Norris）可能两者兼而有之。

此外，引入另一个角色（讲师、标记、管理员）变得更容易，因为添加不需要更改现有对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-16T12:38:52.000

我遇到了更多您可能会觉得相关的评论：

在[Naked Objects 博客上的一篇博文](http://blog.nakedobjects.net/?p=60)中，概述了几种不同的方法，讨论每种方法的优缺点。

*   使用“任何”关联映射
*   将角色建模为类

# java - Java 时间戳值

> ID：226935
> 
> 赞同：5
> 
> 时间：2008-10-22T18:11:06.373
> 
> 标签：java, timestamp

我遇到了这样的代码片段：

`Timestamp expiryDate = Timestamp.valueOf(dateStr + " " + "23:59:59.000");`

这里 dateStr 是用户在表单中输入的字符串，格式为 yyyy-mm-dd。现在 Timestamp.valueOf 的行为是将不存在的日期转换为适当的日期。假设从 2008 年 6 月 31 日到 2008 年 7 月 1 日。

如果 dateStr 字符串实际上是有效日期，我如何检查 Java？我知道我可以手动进行检查，但我想知道是否有任何方法可以做同样的事情。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-22T18:20:15.043

试试[SimpleDateFormat](http://java.sun.com/j2se/1.4.2/docs/api/java/text/SimpleDateFormat.html)。您只需设置一种格式，例如示例中的格式，然后在 dateStr 上调用 parse。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-11-08T19:44:02.883

# *java.time*

`java.util`日期时间 API 及其格式化 API已`SimpleDateFormat`过时且容易出错。由于`java.sql.Timestamp`extends `java.util.Date`，它遇到了同样的问题。建议完全停止使用它们并切换到[现代 Date-Time API](https://www.oracle.com/technical-resources/articles/java/jf14-Date-Time.html) ^*。

**使用`java.time`现代日期时间 API 的解决方案：**`DateTimeFormatter`您可以使用`ResolverStyle`as定义一个`ResolverStyle.STRICT`，`ResolverStyle.SMART`默认情况下。

**演示：**

```
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.time.format.DateTimeFormatterBuilder;
import java.time.format.DateTimeParseException;
import java.time.format.ResolverStyle;
import java.time.format.SignStyle;
import java.time.temporal.ChronoField;
import java.util.Locale;
import java.util.stream.Stream;

public class Main {
    public static void main(String[] args) {
        DateTimeFormatter dtf = 
                new DateTimeFormatterBuilder()
                .appendValue(ChronoField.YEAR, 1, 4, SignStyle.NORMAL)
                .appendLiteral('-')
                .appendValue(ChronoField.MONTH_OF_YEAR, 1, 2, SignStyle.NORMAL)
                .appendLiteral('-')
                .appendValue(ChronoField.DAY_OF_MONTH, 1, 2, SignStyle.NORMAL)
                .appendLiteral(' ')
                .appendValue(ChronoField.HOUR_OF_DAY, 1, 2, SignStyle.NORMAL)
                .appendLiteral(':')
                .appendValue(ChronoField.MINUTE_OF_HOUR, 1, 2, SignStyle.NORMAL)
                .appendLiteral(':')
                .appendValue(ChronoField.SECOND_OF_MINUTE, 1, 2, SignStyle.NORMAL)
                .optionalStart()
                .appendLiteral('.')
                .appendFraction(ChronoField.NANO_OF_SECOND, 0, 3, false)
                .optionalEnd()
                .toFormatter(Locale.ENGLISH)
                .withResolverStyle(ResolverStyle.STRICT);

        // Test
        Stream.of(
                "2008-06-31 23:59:59.000",
                "2008-06-30 23:59:59.000",
                "2008-6-30 23:59:59.000",
                "2008-6-8 23:59:59.000",
                "2008-6-8 2:59:59.000",
                "2008-6-8 23:5:59.000",
                "2008-6-8 23:59:9.000",
                "2008-06-30 23:59:59"

        ).forEach (s -> {
            try {
                LocalDateTime ldt = LocalDateTime.parse(s, dtf);
                System.out.println(ldt);
            }catch(DateTimeParseException e) {
                System.out.printf("%s is an invalid date-time string.%n", s);
                // ...
            }
        });     
    }
} 
```

**输出：**

```
2008-06-31 23:59:59.000 is an invalid date-time string.
2008-06-30T23:59:59
2008-06-30T23:59:59
2008-06-08T23:59:59
2008-06-08T02:59:59
2008-06-08T23:05:59
2008-06-08T23:59:09
2008-06-30T23:59:59 
```

[`ONLINE DEMO`](https://ideone.com/GvnQtt)

**[从Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关现代日期时间 API 的更多信息。检查[此答案](https://stackoverflow.com/a/67752047/10819573)和[此答案](https://stackoverflow.com/a/67505173/10819573)以了解如何将`java.time`API 与 JDBC 一起使用。

### 如果有的话，您需要一个实例`java.sql.Timestamp`：

您可以将 a 转换`LocalDateTime`为`java.sql.Timestamp`使用[`Timestamp#valueOf`](https://docs.oracle.com/javase/8/docs/api/java/sql/Timestamp.html#valueOf-java.lang.String-)例如

```
LocalDateTime now = LocalDateTime.now();
Timestamp ts = Timestamp.valueOf(now); 
```

* * *

^(* 如果您正在为一个 Android 项目工作，并且您的 Android API 级别仍然不符合 Java-8，请[通过 desugaring 检查可用的 Java 8+ API](https://developer.android.com/studio/write/java8-support-table)。请注意，Android 8.0 Oreo 已经提供[对`java.time`](https://developer.android.com/reference/java/time/package-summary).)

# c++ - 代码合成似乎没有生成“有效”的 xml 树

> ID：226939
> 
> 赞同：0
> 
> 时间：2008-10-22T18:12:05.963
> 
> 标签：c++, xsd, codesynthesis

我一直在使用代码合成 xsd 来生成 xml 树，以确保 xml 输出与原始 xsd 的一致性。

初始测试后，一切看起来都正常，但是当我尝试输入无效值（正确的类型，但超出定义的范围）时，这些值是允许的。

尽管 xml 格式正确并且符合 xsd 中设置的类型，但它不是架构中的有效 xml。

有没有其他人使用过这个工具和/或遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-29T12:03:24.170

您需要在此处提供一些示例以获得详细的回复，但现在我认为可以公平地说，如果您的文档未根据架构进行验证，那么所有的赌注都将失败。

请记住，执行模式验证的是解析器，而不是 Code Synthesis XSD（顺便说一下，这是一个糟糕的产品名称，因为它很难明确使用！）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T02:28:20.063

该工具可能无法在创建文档时进行您想要的检查。

如果您的文档很小，您可能只想生成 XML，然后使用 XSD 检查重新解析它并让您检查。

# asp.net - 母版页无法识别新控件

> ID：226944
> 
> 赞同：-2
> 
> 时间：2008-10-22T18:13:43.620
> 
> 标签：asp.net, visual-studio-2008, master-pages

因此，根据我的经验，当您进行更新时，母版页有时会滞后。这不是新事件，您进行更改、构建、测试，而 MasterPage 仍在寻找旧控件。

发生这种情况时，有人有任何提示/技巧吗？通常它会在一段时间后消失，但我没有一段时间。

我正在使用 VS 2008。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-22T18:22:11.030

强制 IIS 重新加载所有内容的三个主要选项是

*   如果从 Visual Studio 运行，请关闭 ASP.NET 开发服务器，这会强制它在下次运行时重新打开
*   更改 web.config 文件（强制 IISReset）
*   直接从命令行调用 IISRESET

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-22T18:18:49.773

听起来像一个缓存问题。构建后是否重新启动 IIS？您是在现场构建还是在发布？这是一个网络应用程序吗？

在构建时尝试对 web.config 文件进行一些小改动，看看是否有帮助。它将为您重置服务器并基本上使事情再次焕然一新。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T18:20:59.190

在 IE 中进行测试时，我发现我必须实际单击刷新图标，而不是简单地转到地址栏并再次按 Enter（就像在 Firefox 中一样）让 IIS 将更新的内容推送给我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T18:35:00.410

如果我在浏览器中看到“陈旧”的内容，我会点击 control-f5，这会强制返回服务器以检索所有内容。这总是让我获得最新版本的所有内容，而无需重新启动 iis、使用 web.config 等。

# wcf - WCF 和确认 - 我是否需要向客户发回“OK got it”？

> ID：226953
> 
> 赞同：10
> 
> 时间：2008-10-22T18:17:53.957
> 
> 标签：wcf, confirmation

如果我有成百上千的客户端计算机 WCP 连接到我的服务器，我是否应该回复“200 OK”类型的消息，说明我已收到数据并将其成功存储在数据库中？

这已经内置到 WCF 中了吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-23T00:57:41.247

这里提到了三种消息传递模式：

1.  同步请求-响应
2.  异步发送（使用单向服务触发并忘记）
3.  异步请求-响应（单向服务的双工服务调用）

这三个都显示不同的消息传递行为，应根据您的需要选择要使用的模式。

当数据已经持久化到数据库时，您需要向客户端返回成功，选项 1 或 3 是合适的。

### 选项1

这是默认配置。

服务完成所有任务后，这将在同一 http 连接上返回 200 响应。这意味着在等待响应时对服务的调用将被阻塞 - 您的客户端将挂起，直到服务写入数据库并完成它需要的任何其他操作。

### 选项 2

只要传输层和消息基础设施层成功，就会返回 202 响应。返回的 202 表示该消息已被接受。从[http rfc](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)：

> 请求已被接受处理，但处理尚未完成。(...) 202 的回应是故意不置可否的。

这意味着您的客户端将在服务基础架构成功启动服务后立即继续执行，并且您将不会收到有关数据库调用是否成功的信息。

### 选项 3

与选项 2 类似，响应是 http 202，而不是 200，但现在当您从客户端调用服务时，您会提供一个`InstanceContext`对象，该对象指定一个对象来处理回调。客户端重新获得控制权，一个新线程异步等待通知您成功或失败的服务响应。

* * *

以下是有关在 WCF 中实现这些模式的更多信息。写完之后，它很长，但是有一些有用的注释和代码。

正如 Whisk 所提到的，Juval Lowy 有一篇文章涵盖了很多这个细节（以及更多！）[here](http://msdn.microsoft.com/en-us/magazine/cc163537.aspx)

### 选项1

这是 WCF 中的默认行为，因此您不需要做任何事情 - 它适用于许多不同的绑定，包括 wsHttpBinding 和 basicHttpBinding。

需要注意的一件事是，即使您有这样的 void 操作，客户端挂起等待 200 响应时所描述的行为也会发生：

```
[ServiceContract]
interface IMyServiceContract
{
    [OperationContract]       
    void DoSomeThing(InputMessage Message);
} 
```

### 选项 2

要将操作设置为单向，您只需将其装饰为：

```
[ServiceContract]
interface IMyServiceContract
{
    [OperationContract(IsOneWay = true)]       
    void DoSomeThing(InputMessage Message);
} 
```

以这种方式装饰的方法必须只有返回类型 void。一个问题是该服务将愉快地构建，并且在您连接到它之前，您不会收到一个说明服务配置无效的异常。

### 选项 3

创建双工回调服务的接口代码为：

```
[ServiceContract(CallbackContract = typeof(IMyContractCallback))]
interface IMyContract
{
    [OperationContract(IsOneWay=true)]       
    void DoSomeThing(InputMessage Message);
}

public interface IMyContractCallback
{
    [OperationContract(IsOneWay = true)]
    void ServiceResponse(string result);      
} 
```

在客户端，您需要类似的东西来设置回调：

```
public class CallbackHandler : IMyContractCallback        
{
    #region IEchoContractCallback Members

    public void ServiceResponse(string result)
    {
        //Do something with the response
    }

    #endregion
}

// And in the client when you set up the service call:

InstanceContext instanceContext = new InstanceContext(new CallbackHandler());
MyContractClient client = new MyContractClient(instanceContext);

InputMessage msg = new InputMessage();

client.DoSomething(msg); 
```

在服务中，您可能会有一些代码，例如：

```
class MyContractImplementation : IMyContract
{
    public void DoSomeThing(MyMessage Message)
    {

        string responseMessage;

        try
        {
           //Write to the database
           responseMessage = "The database call was good!";
        }
        catch (Exception ex)
        {
            responseMessage = ex.Message;
        }

        Callback.ServiceResponse(responseMessage);
    }
} 
```

需要注意的一件重要的事情，一开始就让我感到困惑，那就是要小心异常。如果你：

*   消费异常，你不会得到错误警告（但会发生回调）

*   抛出未处理的异常，服务将终止，客户端甚至不会得到回调。

与选项 1 相比，这是该方法的一大缺点，选项 1 将在抛出未处理的异常时返回异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T18:33:48.667

默认情况下，除非抛出异常，否则您的服务将向客户端返回“OK”消息（即使您的服务方法指定了 void 返回类型）。客户端将等到它收到此消息，然后再继续它的生命。

因此，根据您的问题，默认情况下您将获得所需的行为。

如果您不希望这样，我会同意 Whisk 并将您的操作标记为 One Way（您的操作合同中的设置）。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T18:29:13.183

有两种方法可以做到这一点 - 从 wcf 调用返回一个值，指示成功或失败，或者假设成功并使用回调告诉客户端是否有问题。

我的偏好是将[单向](http://msdn.microsoft.com/en-us/library/ms730149.aspx)服务调用与[双工服务](http://msdn.microsoft.com/en-us/library/ms731064.aspx)一起使用，并使用服务的回调合同来通知客户端失败。[这里](http://msdn.microsoft.com/en-us/magazine/cc163537.aspx)和[这里](http://dotnetaddict.dotnetdevelopersjournal.com/wcf_alarmclock.htm)对回调合约有很好的描述。

我认为如果你遵循第二条路径，你会得到一个更好、更异步的架构，但对于简单的应用程序，只返回成功或失败可能更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T03:07:22.077

我认为这个问题可以使用更多的细节来正确回答。Primary，您当前使用的是哪种类型的绑定？

如果您正在使用支持可靠性的绑定，并且您只想从客户端确定该服务器确实收到了消息，那么只需打开可靠性就可以了。启用此功能后，WCF 将自动在后台自动让对话的每一方说：“你明白了吗？” “我明白了。你明白了吗？” “我知道了。”

# architecture - 客户定制

> ID：226962
> 
> 赞同：3
> 
> 时间：2008-10-22T18:20:28.130
> 
> 标签：architecture, customization

我们有一个安装基数约为 50 的产品，其中超过 50% 的安装在业务逻辑的代码中进行了自定义，目前是通过巨大的 IF 和 Switch 语句完成的。

我们目前正在将代码更新到 .NET 3.5，并希望以更易于管理的方式处理自定义。目前我们能想到的唯一方法是要么坚持使用大的 IF 和 Switch 语句，要么在源代码控制中为每个客户端设置单独的文件，这似乎也不理想。

是否有一种可接受的方式来处理代码库中的大量自定义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T18:24:54.783

这不叫[继承](http://en.wikipedia.org/wiki/Inheritance-oop)吗？通过添加自定义功能使类从基类扩展。每当我有大量的 If 或 case 时，我都会质疑是否应该重构为多个类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T18:27:07.807

我很想安排一些事情，以便定制是文本形式的（可能是 XML，但我想这不是唯一的选择），并且主应用程序是通用的，并通过解析这些配置文件来获取客户特定的功能。

然后，您可以为每个客户创建一个存储库，其中包含配置文件（可能还有资源，如徽标和/或自定义脚本），以及一个用于主应用程序的存储库。

对于给定的客户版本，您的构建系统随后会自动收集应用程序和客户的存储库，并构建自定义版本。

我有这样一个系统的经验，你可以通过这种方式获得相当广泛的定制。起初，它使应用程序端的事情变得更复杂一些，因为您需要添加解析功能，但它使各种客户版本的管理变得更加简单，并且不太容易出错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-06T17:53:13.433

与继承相结合的 DI 框架可以使您的系统符合 Open/Closed 原则，使其更加模块化，并解决生命周期和分发问题，例如当您需要分发为特定客户扩展的基础库时。

例如，您可以在 BaseLibrary 中有一个类 Transfer，然后您可以在 CustomerX 库中有一个类 LoggingTransfer 扩展 Transfer，该库仅包含自定义基本功能的代码。

# autocomplete - 自动完成算法、论文、策略等

> ID：226963
> 
> 赞同：15
> 
> 时间：2008-10-22T18:20:38.520
> 
> 标签：autocomplete

我想知道是否有人有很好的资源来阅读或编写代码来试验“自动完成”

我想知道自动完成背后的理论是什么，从哪里开始常见的错误是什么等。

我发现 Enso、Launchy、Google chrome 甚至 tcsh 等产品执行自动补全的方式令人着迷，我只是出于好奇而开始了自己的一些示例代码，我得出的结论是，这一定是一个之前被广泛探索的领域。

如果有人分享任何关于如何实现这一点的良好技术资源，我将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-22T18:48:58.057

*   [http://humanized.com/weblog/2007/03/30/what_makes_a_good_autocomplete/](http://humanized.com/weblog/2007/03/30/what_makes_a_good_autocomplete/) --
*   [http://social.msdn.microsoft.com/Forums/en-US/vblanguage/thread/2ccb37b9-c7e1-4113-86ac-ad3d33b4b4b1/——](http://social.msdn.microsoft.com/Forums/en-US/vblanguage/thread/2ccb37b9-c7e1-4113-86ac-ad3d33b4b4b1/)在.Net世界
*   关于自动完成方法的*令人讨厌的专利（**理论*仍然值得一读）[http://www.patentstorm.us/patents/5845300/description.html](http://www.patentstorm.us/patents/5845300/description.html)
*   [http://ask.metafilter.com/91068/Fuzzy-text-completion-algorithm](http://ask.metafilter.com/91068/Fuzzy-text-completion-algorithm)对要采取的策略进行高级讨论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T14:26:12.707

查看这篇关于使用 GWT 实现自动完成的博客：

[http://jroller.com/glongman/entry/gwt_autocompleter](http://jroller.com/glongman/entry/gwt_autocompleter)

但我建议你先从一些非常简单的东西开始，自己掌握实现是如何完成的。我会从 Trie 开始，甚至可能完全存储在客户端上，然后如果您认为有必要，可以使用服务器查询进行优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-19T19:59:59.747

自动完成通常使用以下方法之一实现：

*   **树木**。通过在树结构（前缀树、后缀树、dawg 等）中对可搜索文本进行索引，可以执行非常快速的搜索，但会占用内存存储空间。树遍历可以适应近似匹配。
*   **模式分区**。通过将文本划分为标记（ngram），可以使用简单的散列方案执行模式出现的搜索。
*   **过滤**。找到一组潜在的匹配，然后应用顺序算法来检查每个候选。

关于这个主题的几篇论文：

*   博日沃伊·梅利查尔。有限自动机的近似字符串匹配；
*   贡萨洛·纳瓦罗。近似字符串匹配的导览；
*   列昂尼德·博伊佐夫。近似字典搜索的索引方法：比较分析；
*   Marios Hadjieleftheriou 和 Divesh Srivastava。近似字符串处理；
*   Surajit Chaudhuri 和 Raghav Kaushik。扩展自动完成以容忍错误；

[完全](https://github.com/fmmfonseca/completely)看一下，一个 Java 自动完成库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-26T18:41:30.360

这是一个开放的问题，根据情况有十几种策略。根据我的知识，我列出了一些著名的自动完成策略及其相应的数据结构的简短亮点。我还试图总结他们与**自动完成**问题相关的主要***优点***和***缺点***。

 ****蛮力**：

*   ***优点***：可以通过检查所有宇宙（输入）作为下一步来实现
*   ***优点***：超级简单
*   ***优点***：它适用于状态有限的小型数据集
*   ***缺点***：没有存储连接，因此每次您必须执行搜索时
*   ***缺点***：具有最差的时间复杂度。

* * *

**[前缀树（ Trie ）](https://en.wikipedia.org/wiki/Trie)**：

## [![来自维基百科的尝试](https://i.stack.imgur.com/b8FIV.png)](https://i.stack.imgur.com/b8FIV.png)

*   ***优点***：它是为这类问题设计的最简单的数据结构。
*   ***优点***：所有可用下一个状态的列表存储在每个状态中。
*   ***缺点***：数据大小应该很小（最多应该是 RAM 大小的一小部分）。

* * *

**[有向无环图（DAG）](https://en.wikipedia.org/wiki/Directed_acyclic_graph)**：

Trie 存在空间问题，因此其他数据结构的主要目标是降低空间复杂度。[有向无环图（DAG）](https://en.wikipedia.org/wiki/Directed_acyclic_graph)是其中一种选择。通过使用 DAG，您可以将所有相似的子路径合并为一个。因此将保留大量空间。

[![有向无环图](https://i.stack.imgur.com/ymert.png)](https://i.stack.imgur.com/ymert.png)

[快速自动完成](https://github.com/seperman/fast-autocomplete)存储库位于此区域，它使用有向词图 (DWG) 和 Levenshtein 编辑距离。

* * *

**其他一些树选项**：

在每个状态（或节点）上都有一个搜索问题。线性搜索是最坏的情况选择，因此大多数策略通过使用排序（*O(nlog(n)*）然后使用[二进制搜索](https://en.wikipedia.org/wiki/Binary_search_algorithm)（*O(log(n)* ) ）或使用哈希表（*O(1) ）*来改进搜索时间，速度快，但空间复杂度更高）。遇到如此多的权衡困境，其他树数据结构变体，如[Radix Tree](https://en.wikipedia.org/wiki/Radix_tree)、[Suffix Tree](https://en.wikipedia.org/wiki/Suffix_tree)、[Suggest Tree](http://suggesttree.sourceforge.net/)和[Merkle Tree](https://en.wikipedia.org/wiki/Merkle_tree)可能会派上用场。

**Prioritizig Offers**： [马尔可夫链](https://en.wikipedia.org/wiki/Markov_chain)可用于优先考虑下一个状态。它存储连接概率，从而产生更准确的结果。

## [![马尔可夫链](https://i.stack.imgur.com/RiydO.png)](https://i.stack.imgur.com/RiydO.png)

**人工智能策略**：

*   ***优点***：好的模型体积小，运行速度快。
*   ***优点***：好的模型只存储判别特征。
*   ***优点***：巨大的数据集
*   ***优点***：自然语言处理 (NLP) 框架具有预定义算法（更高级别的 API）
*   ***优点***：长期学习能力大大提高。
*   ***缺点***：理解输入拓扑很重要。
*   ***缺点***：预处理是一个艰难的过程。
*   ***缺点***：训练时间长。
*   ***缺点***：收敛可能需要太多的重试和重新训练，这是一个艰难的过程。

* * *

**[长期短期记忆](https://en.wikipedia.org/wiki/Long_short-term_memory)（LSTM）**：

有很多有用的机器学习和深度学习策略。一个好的策略，您可以将自动完成视为时间序列问题，因此您可以使用一些模型，例如 LSTM。

[![长短期记忆体](https://i.stack.imgur.com/kpzmb.png)](https://i.stack.imgur.com/kpzmb.png)

* * *

**变形金刚**：

最后但并非最不重要的一点是，我推荐[Transformer](https://en.wikipedia.org/wiki/Transformer_(machine_learning_model))模型。目前他们正在改变游戏规则。一个很棒的基于 Transformer 的语言模型是[Google BERT](https://ai.googleblog.com/2018/11/open-sourcing-bert-state-of-art-pre.html)。它在预测未来序列方面非常有前途。 [![谷歌 BERT](https://i.stack.imgur.com/2pD5x.png)](https://i.stack.imgur.com/2pD5x.png)

我还建议，在使用转换器开始您的自动完成项目之前，请查看使用转换器和 LSTM 来学习 Python 源代码的[python_autocomplete存储库。](https://github.com/labmlai/python_autocomplete)

* * *

祝你好运！

# sharepoint - Sharepoint Web 部件创建的好文章？

> ID：226966
> 
> 赞同：4
> 
> 时间：2008-10-22T18:21:05.213
> 
> 标签：sharepoint, web-parts

有谁知道创建 Sharepoint Web 部件的任何好的基础文章。

我找到了一对，但他们中的大多数人都跳得很快。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-22T20:13:51.133

[MSDN：在 Windows SharePoint Services 中开发 Web 部件](http://msdn.microsoft.com/en-us/library/ms367238.aspx)

[为 SharePoint 2007 编写自定义 WebPart](http://www.codeguru.com/csharp/.net/net_asp/webforms/article.php/c12293/)

[为 SharePoint 2007 编写自定义 Web 部件](http://weblogs.asp.net/scottgu/archive/2006/09/02/Writing-Custom-Web-Parts-for-SharePoint-2007.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-23T01:35:58.220

这一次，我绝对可以说微软在这方面做得很好。就像他们从 CS 技术写作课上抓了一个学生，让他们一步一步地写，让我们普通人理解。演练：创建基本 SharePoint Web 部件：http: [//msdn.microsoft.com/en-us/library/ms452873.aspx](http://msdn.microsoft.com/en-us/library/ms452873.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T19:32:21.543

你可以试试：

*   [SharePoint 开发人员门户](http://www.microsoft.com/click/SharePointDeveloper/)
*   [SharePoint 论坛@MSDN](http://social.msdn.microsoft.com/forums/en-US/sharepointdevelopment/threads/)
*   [Codeplex](http://www.codeplex.com/Project/ProjectDirectory.aspx?TagName=Sharepoint)查看其他代码

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T20:02:08.893

它与 ASP.NET 2.0 Web 部件几乎相同。如果您在开始时遇到问题，可以查看[ASP.Net 2.0 教程](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/webparts/default.aspx)。

还有一种方法可以将 UserControls 加载到您的 webpart 中，因此您的 usercontrol 可以完成繁重的工作，而 webpart 只是一个包装器，可以很好地与 Sharepoint 配合使用。

[LoadControl 与 SmartPart](http://weblogs.asp.net/erobillard/archive/2008/03/04/what-to-know-about-smartpart-and-loadcontrol.aspx)

# c# - 从 .Net 应用程序编译 .cs

> ID：226967
> 
> 赞同：3
> 
> 时间：2008-10-22T18:21:06.117
> 
> 标签：c#

是否有用于编译 C# 应用程序（到内存或磁盘）的托管 API？我假设存在一个，因为 SharePoint 在内存中编译 ASP.NET 页面。我们希望使用它在运行时生成 Linq`DataContext`并针对各种项目编译它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T18:25:25.377

看看[Microsoft.CSharp.CSharpCodeProvider](http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx)类。该页面包含如何使用该类编译 C# 源代码的示例代码。

**注意**：此类不能用于部分信任。您需要以完全信任的方式运行才能运行 C# 编译器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T18:34:25.950

正如弗朗西所指出的， CSharpCodeProvider 就是您想要的。

在编写我的 C# 书籍时，我构建了“Snippy”，这是一种快速构建和运行 C# 片段的方法——它是一个足够简单的项目，可以很容易地了解如何使用 CSharpCodeProvider。[完整](http://csharpindepth.com/Downloads.aspx)的源代码可用 - 看看。

# open-source - 最好的开源游戏是什么？

> ID：226970
> 
> 赞同：70
> 
> 时间：2008-10-22T18:21:55.680
> 
> 标签：open-source

> 由于历史原因，这个问题被保留了下来，但它不被认为是主题，所以不要以此为借口发布类似的东西。
> 
> 更多信息请访问[https://stackoverflow.com/faq](https://stackoverflow.com/faq)。

* * *

让我阅读代码和学习，而不是玩......

...当然 ;-）

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-10-22T18:27:09.413

[Quake](ftp://ftp.idsoftware.com/idstuff/source/)（1,2 和 3）和[DukeNukem 3D](http://www.3drealms.com/downloads.html#duke3d)源代码在 GPL 下可用。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2008-10-22T18:29:04.557

如果开源代码的部分原因是代码在发展过程中被重用和回收，那么我认为影响力和遗产将是这个决定的两个重要因素。在此基础上，我可能会投票[Rogue](http://en.wikipedia.org/wiki/Rogue_(computer_game)) / [Hack](http://en.wikipedia.org/wiki/Hack_(video_game)) / [Nethack](http://en.wikipedia.org/wiki/Nethack)。它是 hack-and-slash 地牢爬行类型背后的开创性影响之一，今天生活在仍在玩这些旧 ASCII 游戏的繁荣社区中，并对一些最受欢迎的图形游戏产生了重大影响时间，例如暗黑破坏神和暗黑破坏神2。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2008-10-22T18:23:54.117

[韦诺之战](http://www.wesnoth.org/)

也就是说，您可以花一些时间阅读[http://en.wikipedia.org/wiki/List_of_open_source_games](http://en.wikipedia.org/wiki/List_of_open_source_games)

这也取决于你到底想学什么……例如，每年都会举办一场用[Pygame编写的游戏比赛](http://www.pygame.org)

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2008-11-14T10:23:45.853

OpenTransportTycoon 怎么样？:) 来一个人 - 那一定是最好的！

[http://www.openttd.org](http://www.openttd.org) FTW！;)

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2008-10-22T18:25:51.757

自由文明怎么[样](http://freeciv.wikia.com/wiki/Main_Page)？

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2008-10-22T21:23:17.093

查看[Kenta Cho](http://en.wikipedia.org/wiki/Kenta_Cho)的游戏：[http](http://www.asahi-net.or.jp/~cs8k-cyu/index_e.html) ://www.asahi-net.or.jp/~cs8k-cyu/index_e.html 。其中大部分是用 D 语言编写的，并使用[Simple DirectMedia Layer](http://www.libsdl.org/)。

它们非常有趣，而且源代码可读性极强——这是 D 语言的绝佳展示。

[圆环骑兵](http://en.wikipedia.org/wiki/Torus_Trooper)截图：

[替代文字 http://images.macworld.com/images/legacy/images/content/torus.jpg](http://images.macworld.com/images/legacy/images/content/torus.jpg)

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2008-10-22T21:44:22.383

有一个非常好的基于文本的角色扮演游戏，叫做“make”，你正在寻找由胡须圣人守护的隐藏的依赖关系，并从他们身上摔跤。

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2008-10-22T18:24:42.757

[Robocode](http://robocode.sourceforge.net/)非常棒。另请参阅其[在 Wikipedia 上的条目](http://en.wikipedia.org/wiki/Robocode)。

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2009-03-03T19:11:39.417

[替代文字 http://sc2.sourceforge.net/screenshots/melee2.png](http://sc2.sourceforge.net/screenshots/melee2.png)

[Ur Quan Masters - Star Control 2 更新](http://sc2.sourceforge.net/)。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2008-10-22T21:46:35.797

```
. . . . . . . . . .
. . . . S . . . . .
. . * . . . . * . .
. . . . . . . . . *
. * . . . * . . . .
. . . . . . . . . .
. . . E . . . . . .
. . . . . * . . . .
. . . . . . . . . . 
. . . * . . . . . . 
```

这个……最初的星际迷航。PDP11 规则！:)

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2008-10-22T19:42:30.867

我不得不选择[GNU Chess](http://www.gnu.org/software/chess/)。

如果您真的有兴趣查看代码。来自[wiki](http://en.wikipedia.org/wiki/GNU_Chess)：“第 5 版本质上是对 GNU Chess 的完全重写，以消除意大利面条式代码并用更先进的计算机国际象棋实现技术替换过时的数据结构。”

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2008-10-22T18:46:48.843

我不敢相信没有提到[Hunt the Wumpus 。](http://www.atariarchives.org/bcc1/showpage.php?page=247)

还是[星际迷航](http://www3.sympatico.ca/maury/games/space/star_trek.html)？

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2008-11-14T20:44:26.583

两个字：冰冻泡泡。

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2008-11-14T20:52:19.280

我个人最喜欢的是[不明飞行物外星人入侵](http://ufoai.sourceforge.net/)。我喜欢原始的 UFO，这是一个非常好的克隆。

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2008-10-22T18:47:41.727

什么？这里没有人喜欢[Tux Racer](http://en.wikipedia.org/wiki/Tux_Racer)吗？

我就是喜欢那个游戏！！！它节奏快，几乎可以在任何体面的现代计算机上运行（不需要昂贵的视频卡）。它也可以在 Windows 上运行！！此外，它证明了“企鹅会飞”（甚至超过音速：P）

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2008-10-22T19:20:02.660

毫无疑问，GL Tron。你怎么能不爱呢？

[http://en.wikipedia.org/wiki/GLtron](http://en.wikipedia.org/wiki/GLtron)

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2009-03-03T19:32:07.650

[铁血联盟 2](http://en.wikipedia.org/wiki/Jagged_Alliance_2)

它的源代码于 2004 年发布（我认为），从那时起，mod 社区对其进行了很大改进。该模组名为[JA2 v1.13](http://ja2v113.pbwiki.com/)，社区位于[Bear's Pit](http://www.ja-galaxy-forum.com/).

PS 对于阅读和学习代码，这可能不是最好的项目。它是旧的 C 代码，具有跨越数百行的许多功能。除非您想学习[如何使用遗留代码](https://rads.stackoverflow.com/amzn/click/com/0131177052)，否则玩它会更有趣。;)

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2008-10-22T18:28:24.950

出色地....

如果您喜欢飞行模拟器，那么绝对可以查看 Free Space

[http://scp.indiegames.us/](http://scp.indiegames.us/)

还有大量的模组......一个非常不错的模组是在太空堡垒gallactica宇宙中，您实际上可以驾驶毒蛇标记VII

[http://www.game-warden.com/bsg/](http://www.game-warden.com/bsg/)

玩得开心... errr，当然，我的头在哪里...

快乐的代码阅读;-)

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2008-10-22T18:36:41.360

如果您的目的是了解游戏的运作方式并愿意花少量的钱来观看，我强烈推荐[GarageGames](http://www.garagegames.com)的[Torque 游戏引擎](http://www.garagegames.com/products/111)。只需 150 美元，您就可以获得 AAA 游戏标题（部落 2）的完整引擎源代码。内容被撕掉了，所以你不会购买部落 2，但内容很容易替换。与其他同类发动机的成本相比，扭矩是一个惊人的交易。而且，如果您决定制作游戏，则可以在没有过分的许可限制的情况下这样做。

编辑：我知道它不是开源的，但为了您学习代码的目的，它应该符合条件。该引擎是用 C++ 编码的，并且有一个与 C#/Java 语法相似的脚本层。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2008-11-10T05:33:59.563

[替代文字 http://www.classicempire.com/emlogo.jpg](http://www.classicempire.com/emlogo.jpg)

帝国，世纪战争游戏，自然而然。您可以从[classicempire.com](http://www.classicempire.com)下载它。自 1970 年代以来，Empire 就一直在淘汰学生并破坏婚姻。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2008-11-14T10:19:16.813

[Sauerbraten](http://sauerbraten.org/) 非常不错的 FPS

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2008-11-14T10:44:31.457

它必须是[流氓](http://en.wikipedia.org/wiki/Rogue_(computer_game))

[流氓截图 http://upload.wikimedia.org/wikipedia/en/a/af/Rogue_Unix_Screenshot_CAR.PNG](http://upload.wikimedia.org/wikipedia/en/a/af/Rogue_Unix_Screenshot_CAR.PNG)

或者 我在这两个方面投入（失去）了这么多时间的[帝国。](http://empireclassic.com/)

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2008-11-14T20:27:18.007

我花了很多时间玩[FreeCol](http://www.freecol.org)（Sid Meier's Colonization 的克隆版）。

我的意思是“研究 FreeCol 的源代码”。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2008-10-22T20:01:23.247

[Wormux](http://wormux.org/wiki/en/index.php)确实具有出色的架构。我是一名专业的游戏开发者，我认为这些人可能也是。多年游戏开发经验的工作质量。

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2010-06-01T02:38:52.797

最近，Humble Indie Bundle 中的一些游戏开源了，可能对人们来说非常有趣。吉什、卢加鲁和半影都打开了。

[http://www.wolfire.com/humble](http://www.wolfire.com/humble)

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2008-10-24T17:44:47.567

Depending on what platform you're going for, the XNA guys have a few "starter kits" of ready to build projects, the code is available, but it's not explicitly open source:

[http://creators.xna.com/education/starterkits/](http://creators.xna.com/education/starterkits/)

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2008-10-22T18:54:51.540

[Dopewars](http://dopewars.sourceforge.net/)在互联网上或与朋友一起在局域网上玩很有趣。它可以在 Windows、OSX、Linux、iPhone 上运行，并且在 Facebook 上进行了改编。

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2009-01-06T18:31:22.677

这么多游戏，这么少时间。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2009-03-03T18:50:41.713

自由空间 2 源代码。它基于原始的 Volition Freespace 2（作为开源发布）。这是生产（因此是“经过实战测试”）代码，它将让您很好地了解运输标题的外观（带有所有缺点）。

您可以在此处通过 SVN 访问 FS2_open 源代码：

[http://scp.indiegames.us/links.php](http://scp.indiegames.us/links.php)

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2009-03-03T18:54:42.950

我花在[Glubulation 2](http://globulation2.org/wiki/Main_Page)上的时间比任何其他开源游戏都多。它是 RTS 类型的创新和新鲜变体。

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2008-10-24T17:58:41.780

A classic: [Crowther/Woods Adventure](http://www-cs-faculty.stanford.edu/~knuth/programs/advent.w.gz) ;-)

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2008-11-14T20:32:55.827

[还没有对Angband](http://rephial.org/)大喊大叫吗？它在今年 3 月获得了新的“所有权”，仍然是我见过的最令人上瘾的奇幻/地牢风格游戏。源代码很容易获得，并且很容易看到一个程序在 1993 年首次发布之后仍然可以保持高度活跃，或者甚至更晚，如果内存在其生命周期内起作用。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2008-11-14T20:50:57.880

还没有人提到[freedroidrpg](http://freedroid.sourceforge.net/)。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2009-04-15T10:48:13.900

[Tremulous](http://tremulous.net/)是一款不错的多人游戏。

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2008-10-22T19:28:59.710

[华沙](http://www.warsow.net/?page=home)，显然。

它是一个 FPS，技术上与 Quake 3 一样先进，开源，有很好的文档记录和一个很棒的社区。

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2008-10-22T19:58:56.077

我不敢相信，还没有人提到[Armagetron Advanced](http://www.armagetronad.net)！

对于电影[Tron](http://www.imdb.com/title/tt0084827/)的粉丝来说，这是与全球其他玩家在线消磨时间的好方法。

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2008-10-22T20:00:22.003

Duke3D 发布了他们的源代码。那是有史以来最好的游戏。 [源代码是duke3d下的15号](http://www.3drealms.com/downloads.html)

* * *

## 回答 #38

> 赞同：2
> 
> 时间：2010-01-25T01:12:40.787

[Hedgewars](http://hedgewars.org/)很有趣，运行流畅，有漂亮的图形，喜欢蠕虫世界派对的每个人都会喜欢它。

```
 To compile and install you need:

  Qt >= 4.4
  FreePascal >= 2.2.0
  SDL >= 1.2.5
  SDL_net >= 1.2.5
  SDL_mixer >= 1.2
  SDL_image >= 1.2
  SDL_ttf >= 2.0
  CMake >= 2.6.0 
```

![替代文字](https://hedgewars.org/images/screenshots/hedgewars-0.9.6-002.png)

![替代文字](https://hedgewars.org/images/screenshots/hedgewars-0.9.6-004.png)

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2009-03-03T19:03:10.793

Open Arena，最好的 Quake 3 引擎，完全开源。

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2008-11-14T21:05:47.367

Torcs, the Open Racing Simulator [http://torcs.sourceforge.net/](http://torcs.sourceforge.net/)

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2010-03-04T16:46:44.167

**[世界赛](http://www.teeworlds.com/)** ![替代文字](https://www.teeworlds.com/images/screens/screenshot0077.png)

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2008-11-14T20:57:10.097

我将添加一个控制台游戏：[Meteora Evolution](http://meteora.lo2k.net/)。它是 Nintendo DS 和开源的自制游戏。

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2008-11-14T20:57:41.860

Gnu-步步高。

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2008-12-17T13:36:01.583

我不认为它算作“开源”，但我喜欢 QBasic Gorilla。Bas *grin*我曾经编辑它以使所有建筑物在香蕉碰到太阳时消失；那么它就是香蕉免费！xD

我还冒昧地将游戏重命名为 QBrian Gorilla 来取笑我的一个朋友... 跛脚，我知道，但是嘿，我才 14 岁。哈哈..

QBasic 是我接触的第一个编程语言，后来转向 VB，然后是 ASP、PHP 和 VB.Net。啊，怀旧... =）

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2010-03-04T16:38:08.700

[由 Microsoft MechCommander 2](http://en.wikipedia.org/wiki/MechCommander_2)分发（优秀的机甲游戏）。

* * *

## 回答 #46

> 赞同：1
> 
> 时间：2010-01-25T01:22:00.827

完全惊讶于[FreeCiv 还](http://freeciv.wikia.com)没有被提及。它确实是目前最好的在线多人游戏。我已经玩了好**几个小时**了。

至于编译，您可以在 SDL 客户端和 GTK 客户端之间进行选择。

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2008-10-22T18:24:46.127

无意的源代码发布算数吗？如果是这样，Half-Life 2 和 EVE（尽管它只是客户端代码）

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2011-03-29T19:54:13.387

Atari ST 上的 Megaroids。是 Megamax C 编译器的演示应用程序。在 Midres (640x200x4colors) 中播放。具有这种“多一个”精神的简单游戏。

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2008-11-14T20:53:40.213

全球热核战争 ( [http://en.wikipedia.org/wiki/WOPR](http://en.wikipedia.org/wiki/WOPR) ) 或井字游戏

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2008-12-17T14:35:40.607

如果您正在寻找经典 Balderdash 的非常快速的 C#.NET 实现，请在此处查看 Digger 源代码：

[http://www.lutzroeder.com/silverlight/](http://www.lutzroeder.com/silverlight/)

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2009-01-06T18:09:16.217

这显然是[AssaultCube](http://assault.cubers.net) ;) 一个快速而有趣的第一人称射击游戏，以 40mb 包形式提供。

[替代文字 http://assault.cubers.net/pics/main_actioncube.jpg](http://assault.cubers.net/pics/main_actioncube.jpg)

使用 SDL、OpenGL 和 OpenAL 用凌乱的 C++ 编写：P

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2011-01-13T06:14:32.753

GNU 国际象棋是最好的。但玩游戏的人更喜欢华沙第一人称射击游戏。

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2011-03-29T19:49:03.810

Ubran 恐怖是一个伟大的反击游戏。[http://www.urbanterror.info/news/home/](http://www.urbanterror.info/news/home/)

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2010-05-09T01:27:57.993

MMORPG [Ryzom 几天前](http://en.wikipedia.org/wiki/Ryzom)开源（[博客文章](http://dev.ryzom.com/news/13)）。

虽然我不是很精通游戏编程，但 paroneayea 对 reddit 的[评论](http://www.reddit.com/r/programming/comments/c0ja2/breakthrough_for_free_software_gamingryzom/c0phtvr)让我觉得值得一看：

> 很难低估这是一个有多大的发行版。这里的资产量，代码库的大小.. 任何人都可以运行自己的 MMORPG 服务器，或者回馈有用的资产以使其成为主服务器这一事实！
> 
> 老实说，自从近十年前 Blender 作为免费和开源软件发布以来，我并不认为我对释放一个项目感到如此兴奋。

[源代码](http://dev.ryzom.com/)-[媒体资产](http://media.ryzom.com/)

* * *

## 回答 #55

> 赞同：0
> 
> 时间：2011-03-29T20:48:34.733

我自己在[Chromium](http://www.reptilelabour.com/software/chromium/)玩了很多。早在 2005 年，它就与 Mandrake 一起发布。我所有不-我-永远-永远不会使用-Linux-但只考虑-Windows 的朋友们都对它的**质量、美观和快节奏的风格**感到惊讶。

![铬屏幕截图。 在我看来是必须的。](https://i.stack.imgur.com/cArvf.jpg)

# .net - 如何在 .NET 中编辑 EXIF 数据

> ID：226973
> 
> 赞同：13
> 
> 时间：2008-10-22T18:22:14.337
> 
> 标签：.net, image, exif

我正在编写一个照片库/共享网站，并希望 (1) 将 EXIF 数据写入存储在服务器上的 JPEG，以及 (2) 在写入输出流以供显示之前剥离该 EXIF 数据。

是否有人知道 dotNet 库——最好是开源的——它允许编辑图像文件中的 EXIF 数据（这里的关键是我需要写入/擦除 EXIF 数据，而不仅仅是读取它）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-22T18:28:11.237

检查这个库：

*   [EXIF提取器](http://www.codeproject.com/KB/graphics/exifextractor.aspx)
*   [照片属性](http://www.codeproject.com/KB/graphics/photoproperties.aspx)
*   [简化对图像元数据的访问的库](http://www.codeproject.com/KB/GDI-plus/ImageInfo.aspx)
*   [ExifWorks](http://www.codeproject.com/KB/vb/exif_reader.aspx)
*   [EXIF 标签编辑器](http://www.codeproject.com/KB/graphics/EXIF_tag_Editor.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-02T08:35:11.870

如果您正在寻找与 .net 标准兼容的库，我强烈推荐[ImageSharp](https://github.com/SixLabors/ImageSharp)。

# git - 我怎么知道一个分支是否已经合并到 master 中？

> ID：226976
> 
> 赞同：1312
> 
> 时间：2008-10-22T18:23:03.493
> 
> 标签：git

我有一个带有多个分支的 git 存储库。

我如何知道哪些分支已经合并到主分支中？

* * *

## 回答 #1

> 赞同：2046
> 
> 时间：2008-10-22T18:33:09.183

`git branch --merged master`列出合并到*master的分支*

`git branch --merged`列出合并到*HEAD*中的分支（即当前分支的尖端）

`git branch --no-merged`列出尚未合并的分支

默认情况下，这仅适用于本地分支机构。该`-a`标志将显示本地和远程分支，并且该`-r`标志仅显示远程分支。

* * *

## 回答 #2

> 赞同：132
> 
> 时间：2008-10-22T18:25:24.423

您可以使用该[`git merge-base`](https://git-scm.com/docs/git-merge-base)命令查找两个分支之间的最新共同提交。如果该提交与您的分支头相同，则该分支已完全合并。

请注意，`git branch -d`它已经做了这种事情，因为它会拒绝删除尚未完全合并的*分支*。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2019-07-22T13:12:45.243

为了验证哪些分支合并到 master 中，您应该使用以下命令：

*   `git branch <flag[-r/-a/none]> --merged master`合并到 master 的所有分支的列表。
*   `git branch <flag[-r/-a/none]> --merged master | wc -l`count 合并到 master 的所有分支的数量。

标志是：

*   `-a`flag - **（全部）**显示远程和本地分支
*   `-r`flag - **(remote)**仅显示远程分支
*   `<emptyFlag>`- 仅显示**本地**分支机构

*例如：* `git branch -r --merged master`将向您显示合并到 master 中的所有远程存储库。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2013-10-23T10:19:22.200

还有一个图形界面解决方案。只需键入

`gitk --all`

一个新的应用程序窗口将提示您整个 repo 的图形表示，在这里很容易意识到一个分支是否已经合并

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2018-03-22T16:49:55.423

我正在使用以下 bash 函数，例如：`git-is-merged develop feature/new-feature`

```
git-is-merged () {
  merge_destination_branch=$1
  merge_source_branch=$2

  merge_base=$(git merge-base $merge_destination_branch $merge_source_branch)
  merge_source_current_commit=$(git rev-parse $merge_source_branch)
  if [[ $merge_base = $merge_source_current_commit ]]
  then
    echo $merge_source_branch is merged into $merge_destination_branch
    return 0
  else
    echo $merge_source_branch is not merged into $merge_destination_branch
    return 1
  fi
} 
```

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2016-10-13T02:05:01.047

使用`git merge-base <commit> <commit>`.

此命令在两个提交之间找到最佳共同祖先。如果共同祖先与“分支”的最后一次提交相同，那么我们可以安全地假设“分支”已经合并到主节点中。

**以下是步骤**

1.  在 master 分支上查找最后一个提交哈希
2.  在“分支”上查找最后一个提交哈希
3.  运行命令`git merge-base <commit-hash-step1> <commit-hash-step2>`。
4.  如果步骤 3 的输出与步骤 2 的输出相同，则“分支”已经合并到 master。

有关 git merge-base 的更多信息[https://git-scm.com/docs/git-merge-base](https://git-scm.com/docs/git-merge-base)。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2013-10-23T10:09:57.230

*关于清理远程分支的话题*

```
git branch -r | xargs -t -n 1 git branch -r --contains 
```

这会列出每个远程分支，然后列出其最新 SHA 所在的远程分支。

这有助于辨别哪些远程分支已合并但未删除，哪些尚未合并因此正在衰减。

如果您使用的是“tig”（它类似于 gitk，但基于终端），那么您可以

```
tig origin/feature/someones-decaying-feature 
```

无需 git checkout 即可查看分支的提交历史

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2020-11-17T16:53:53.423

我使用[git for-each-ref](https://git-scm.com/docs/git-for-each-ref)来获取合并或未合并到给定远程分支中的分支列表（例如`origin/integration`）

> 遍历所有匹配 <pattern> 的 refs 并根据给定的 <format> 显示它们，然后根据给定的 <key> 集对它们进行排序。

*注意：如果您倾向于使用而不是 ，请`origin/integration`替换为.`integration``git pull``git fetch`*

### 合并到远程`origin/integration`分支的本地分支列表

```
git for-each-ref --merged=origin/integration --format="%(refname:short)" refs/heads/
#                ^                           ^                           ^
#                A                           B                           C
branch1
branch2
branch3
branch4 
```

A：只取合并到远程`origin/integration`分支中的分支
B：打印分支名称
C：只看`heads`refs（即分支）

### 未合并到远程`origin/integration`分支的本地分支列表

```
git for-each-ref --no-merged=origin/integration --format="%(committerdate:short) %(refname:short)" --sort=committerdate refs/heads
#                ^                              ^                                                  ^                    ^
#                A                              B                                                  C                    D
2020-01-14 branch10
2020-01-16 branch11
2020-01-17 branch12
2020-01-30 branch13 
```

A：只取未合并到远程`origin/integration`分支中的分支
B：打印分支名称以及最后提交日期
C：按提交日期排序输出
D：只查看`heads`refs（即分支）

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-05-29T08:45:25.193

当我需要确定分支是否已合并时，这是我的技术，即使它可能已被重新定位以与我们的主分支保持同步，这是功能分支的常见场景。

这些方法都不是万无一失的，但我发现它们多次有用。

## 1 显示所有分支的日志

使用 gitk 或 TortoiseGit 之类的可视化工具，或者简单地使用 --all 进行 git log，查看历史记录以查看所有与主分支的合并。您应该能够发现此特定功能分支是否已合并。

## 2 在功能分支中合并时始终删除远程分支

如果你有一个好习惯，当你合并到一个特性分支时总是删除本地和远程分支，那么你可以简单地更新和修剪另一台计算机上的远程，特性分支就会消失。

为了帮助记住这样做，我已经在使用[git flow 扩展（AVH 版）](https://github.com/petervanderdoes/gitflow)在本地创建和合并我的功能分支，所以我添加了以下 git flow 挂钩来询问我是否还想自动删除远程分支。

**示例创建/完成功能分支**

```
554 Andreas:MyRepo(develop)$ git flow start tmp
Switched to a new branch 'feature/tmp'

Summary of actions:
- A new branch 'feature/tmp' was created, based on 'develop'
- You are now on branch 'feature/tmp'

Now, start committing on your feature. When done, use:

     git flow feature finish tmp

555 Andreas:MyRepo(feature/tmp)$ git flow finish
Switched to branch 'develop'
Your branch is up-to-date with 'if/develop'.
Already up-to-date.

[post-flow-feature-finish] Delete remote branch? (Y/n)
Deleting remote branch: origin/feature/tmp.

Deleted branch feature/tmp (was 02a3356).

Summary of actions:
- The feature branch 'feature/tmp' was merged into 'develop'
- Feature branch 'feature/tmp' has been locally deleted
- You are now on branch 'develop'

556 Andreas:ScDesktop (develop)$ 
```

**.git/hooks/post-flow-feature-finish**

```
NAME=$1
ORIGIN=$2
BRANCH=$3

# Delete remote branch
# Allows us to read user input below, assigns stdin to keyboard
exec < /dev/tty

while true; do
  read -p "[post-flow-feature-finish] Delete remote branch? (Y/n) " yn
  if [ "$yn" = "" ]; then
    yn='Y'    
  fi
  case $yn in
      [Yy] ) 
        echo -e "\e[31mDeleting remote branch: $2/$3.\e[0m" || exit "$?"
        git push $2 :$3; 
        break;;
      [Nn] ) 
        echo -e "\e[32mKeeping remote branch.\e[0m" || exit "$?"
        break;;
      * ) echo "Please answer y or n for yes or no.";;
  esac
done

# Stop reading user input (close STDIN)
exec <&-
exit 0 
```

## 3 按提交信息搜索

如果您并不总是删除远程分支，您仍然可以搜索类似的提交以确定该分支是否已合并。这里的陷阱是远程分支是否已重新定位到无法识别的位置，例如压缩提交或更改提交消息。

*   获取并修剪所有遥控器
*   在功能分支上查找上次提交的消息
*   查看是否可以在 master 分支上找到具有相同消息的提交

master 分支上的示例命令：

```
gru                   
gls origin/feature/foo
glf "my message" 
```

**在我的 bash .profile 配置中**

```
alias gru='git remote update -p'
alias glf=findCommitByMessage

findCommitByMessage() {
    git log -i --grep="$1"
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-11-15T18:22:15.253

这是一个小小的单线，可以让您知道您当前的分支是否包含来自远程源/主分支的数据：

```
$ git fetch && git branch -r --merged | grep -q origin/master && echo Incorporates origin/master || echo Out of date from origin/master 
```

我在处理功能分支时遇到了这个问题，并且经常想确保我将最新的工作合并到我自己的单独工作分支中。

为了概括这个测试，我在 ~/.gitconfig 中添加了以下别名：

```
[alias]
   current = !git branch -r --merged | grep -q $1 && echo Incorporates $1 || echo Out of date from $1 && : 
```

然后我可以打电话：

```
$ git current origin/master 
```

检查我是否是最新的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-12-17T06:43:33.693

要检查源分支是否已合并到 master 分支，可以使用以下 bash 命令：

```
git merge-base --is-ancestor <source branch name> master && echo "merged" || echo "not merged" 
```

# oop - 什么是“松散耦合”？请提供例子

> ID：226977
> 
> 赞同：183
> 
> 时间：2008-10-22T18:23:09.233
> 
> 标签：oop, language-agnostic, loose-coupling

我似乎无法理解“松散耦合”的概念。我想“松散”这个词通常带有负面含义并没有帮助，所以我总是忘记松散耦合是一件*好事*。

有人会展示一些说明这个概念的“之前”和“之后”代码（或伪代码）吗？

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2008-10-22T20:04:25.270

考虑一个简单的购物车应用程序，它使用一个`CartContents`类来跟踪购物车中的项目，并使用一个`Order`类来处理购买。需要确定购物车中内容的`Order`总价值，它可能会这样做：

**紧耦合示例：**

```
public class CartEntry
{
    public float Price;
    public int Quantity;
}

public class CartContents
{
    public CartEntry[] items;
}

public class Order
{
    private CartContents cart;
    private float salesTax;

    public Order(CartContents cart, float salesTax)
    {
        this.cart = cart;
        this.salesTax = salesTax;
    }

    public float OrderTotal()
    {
        float cartTotal = 0;
        for (int i = 0; i < cart.items.Length; i++)
        {
            cartTotal += cart.items[i].Price * cart.items[i].Quantity;
        }
        cartTotal += cartTotal*salesTax;
        return cartTotal;
    }
} 
```

请注意`OrderTotal`方法（以及 Order 类）如何依赖于`CartContents`和`CartEntry`类的实现细节。如果我们要尝试更改此逻辑以允许折扣，我们可能必须更改所有 3 个类。此外，如果我们更改为使用`List<CartEntry>`集合来跟踪项目，我们也必须更改`Order`类。

现在这里有一个更好的方法来做同样的事情：

**耦合较少的例子：**

```
public class CartEntry
{
    public float Price;
    public int Quantity;

    public float GetLineItemTotal()
    {
        return Price * Quantity;
    }
}

public class CartContents
{
    public CartEntry[] items;

    public float GetCartItemsTotal()
    {
        float cartTotal = 0;
        foreach (CartEntry item in items)
        {
            cartTotal += item.GetLineItemTotal();
        }
        return cartTotal;
    }
}

public class Order
{
    private CartContents cart;
    private float salesTax;

    public Order(CartContents cart, float salesTax)
    {
        this.cart = cart;
        this.salesTax = salesTax;
    }

    public float OrderTotal()
    {
        return cart.GetCartItemsTotal() * (1.0f + salesTax);
    }
} 
```

特定于购物车订单项或购物车集合或订单实现的逻辑仅限于该类。因此，我们可以更改任何这些类的实现，而无需更改其他类。我们可以通过改进设计、引入接口等来进一步解耦，但我认为你明白了这一点。

* * *

## 回答 #2

> 赞同：166
> 
> 时间：2008-12-31T13:41:20.903

许多集成产品（尤其是苹果公司的），如**iPod**、**iPad**是紧密耦合的一个很好的例子：一旦电池没电了，你还不如买一个新设备，因为电池是焊接固定的，不会松动，因此更换非常方便昂贵的。松散耦合的播放器将允许轻松更换电池。

*软件开发也是*如此：松散耦合的代码通常（很多）更好，以便于扩展和替换（并使各个部分更容易理解）。但是，在极少数情况下，在特殊情况下紧密耦合可能是有利的，因为几个模块的紧密集成可以实现更好的优化。

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2008-10-22T18:35:53.153

我将使用 Java 作为示例。假设我们有一个如下所示的类：

```
public class ABC
{
   public void doDiskAccess() {...}
} 
```

当我打电话给班级时，我需要做这样的事情：

```
ABC abc = new ABC();

abc. doDiskAccess(); 
```

到目前为止，一切都很好。现在假设我有另一个看起来像这样的类：

```
public class XYZ
{
   public void doNetworkAccess() {...}
} 
```

它看起来与 ABC 完全相同，但假设它通过网络而不是磁盘工作。所以现在让我们编写一个这样的程序：

```
if(config.isNetwork()) new XYZ().doNetworkAccess();
else new ABC().doDiskAccess(); 
```

这行得通，但它有点笨拙。我可以使用这样的界面来简化它：

```
public interface Runnable
{
    public void run();
}

public class ABC implements Runnable
{
   public void run() {...}
}

public class XYZ implements Runnable
{
   public void run() {...}
} 
```

现在我的代码看起来像这样：

```
Runnable obj = config.isNetwork() ? new XYZ() : new ABC();

obj.run(); 
```

看看这有多清晰和易于理解？我们刚刚理解了松耦合的第一个基本原则：抽象。这里的关键是确保 ABC 和 XYZ 不依赖于调用它们的类的任何方法或变量。这使得 ABC 和 XYZ 成为完全独立的 API。或者换句话说，它们与父类“解耦”或“松耦合”。

但是如果我们需要两者之间的通信呢？好吧，那么我们可以使用[事件模型](http://en.wikipedia.org/wiki/Event_model)等进一步的抽象来确保父代码永远不需要与您创建的 API 耦合。

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2008-10-22T18:30:12.887

抱歉，“松散耦合”不是编码问题，而是设计问题。术语“松散耦合”与“高内聚”的理想状态密切相关，相反但互补。

松散耦合仅仅意味着应该构建单独的设计元素，以便减少他们需要了解的关于其他设计元素的不必要信息量。

高内聚有点像“紧耦合”，但高内聚是一种状态，其中真正需要相互了解的设计元素被设计成能够干净优雅地协同工作。

关键是，一些设计元素应该知道其他设计元素的细节，所以它们应该这样设计，而不是偶然。其他设计元素不应该知道其他设计元素的细节，因此应该有目的地以这种方式设计它们，而不是随意设计。

实现这一点留给读者练习:)。

* * *

## 回答 #5

> 赞同：34
> 
> 时间：2008-10-22T18:32:21.697

紧密耦合的代码依赖于具体的实现。如果我需要代码中的字符串列表并像这样声明它（在 Java 中）

```
ArrayList<String> myList = new ArrayList<String>(); 
```

然后我依赖于 ArrayList 实现。

如果我想将其更改为松散耦合的代码，我将引用作为接口（或其他抽象）类型。

```
List<String> myList = new ArrayList<String>(); 
```

这使我无法调用特定于 ArrayList 实现的*任何*方法。`myList`我仅限于 List 接口中定义的那些方法。如果我稍后决定我真的需要一个 LinkedList，我只需要在我创建新 List 的一个地方更改我的代码，而不是在我调用 ArrayList 方法的 100 个地方更改我的代码。

当然，您*可以*使用第一个声明来实例化 ArrayList，并限制自己不使用任何不属于 List 接口的方法，但是使用第二个声明会使编译器保持诚实。

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2008-10-22T23:50:58.807

这里答案之间的差异程度说明了为什么它是一个难以掌握的概念，但要尽可能简单地描述它：

为了让我知道，如果我把球扔给你，你就能接住它，我真的不需要知道你多大了。我不需要知道你早餐吃了什么，我真的不在乎你的初恋是谁。我只需要知道你能抓到。如果我知道这一点，那么我不在乎是你，我是在向你或你的兄弟扔球。

对于像 c# 或 Java 等非动态语言，我们通过接口来实现这一点。所以假设我们有以下接口：

```
public ICatcher
{
   public void Catch();
} 
```

现在假设我们有以下类：

```
public CatcherA : ICatcher
{
   public void Catch()
   {
      console.writeline("You Caught it");
   }

}
public CatcherB : ICatcher
{
   public void Catch()
   {
      console.writeline("Your brother Caught it");
   }

} 
```

现在两者都`CatcherA`实现`CatcherB`该`Catch`方法，因此需要 Catcher 的服务可以使用其中任何一个，而不必真正在乎它是哪一个。所以一个紧密耦合的服务可能会直接实例化一个被捕获的 ie

```
public CatchService
{
   private CatcherA catcher = new CatcherA();

   public void CatchService()
   {
      catcher.Catch();
   }

} 
```

因此，`CatchService`可能会完全按照它的计划去做，但它会使用`CatcherA`并将始终使用 user `CatcherA`。它是硬编码的，所以它一直呆在那里，直到有人出现并重构它。

现在让我们采用另一个选项，称为依赖注入：

```
public CatchService
{
   private ICatcher catcher;

   public void CatchService(ICatcher catcher)
   {
      this.catcher = catcher;
      catcher.Catch();
   }
} 
```

因此，实例化的调用`CatchService`可能会执行以下操作：

```
CatchService catchService = new CatchService(new CatcherA()); 
```

或者

```
CatchService catchService = new CatchService(new CatcherB()); 
```

这意味着该`Catch`服务没有与`CatcherA`或紧密耦合`CatcherB`。

像这样的松散耦合服务还有其他几种策略，例如使用 IoC 框架等。

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2008-10-22T18:36:28.333

您可以将（紧密或松散）耦合视为字面上将特定类与其对另一个类的依赖分开所需的工作量。例如，如果你的类中的每个方法在底部都有一个 finally 块，你调用 Log4Net 来记录一些东西，那么你会说你的类与 Log4Net 紧密耦合。如果您的类包含一个名为 LogSomething 的私有方法，这是唯一调用 Log4Net 组件的地方（而其他方法都称为 LogSomething），那么您会说您的类与 Log4Net 松散耦合（因为它不需要太多努力将 Log4Net 拉出并用其他东西替换它）。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2008-10-22T18:25:31.460

## 定义

本质上，耦合是给定对象或一组对象依赖另一个对象或另一组对象以完成其任务的程度。

## 高耦合

想一辆车。为了使发动机启动，必须​​将钥匙插入点火装置，转动，必须存在汽油，必须产生火花，必须点火，并且必须启动发动机。您可以说汽车引擎与其他几个对象高度耦合。这是高耦合，但这并不是一件坏事。

## 松耦合

想象一个网页的用户控件，它负责允许用户发布、编辑和查看某种类型的信息。单个控件可用于让用户发布一条新信息或编辑一条新信息。该控件应该能够在两个不同的路径之间共享 - 新建和编辑。如果控件的编写方式需要从包含它的页面中获取某种类型的数据，那么您可以说它的耦合度太高。该控件不应该需要其容器页面中的任何内容。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-10-22T18:39:08.157

这是一个非常笼统的概念，因此代码示例并不能说明全部情况。

一位工作人员对我说，“模式就像分形，当你放大到非常接近时，你可以看到它们，当你缩小到架构级别时，你可以看到它们。”

阅读简短的维基百科页面可以让您了解这种普遍性：

[http://en.wikipedia.org/wiki/Loose_coupling](http://en.wikipedia.org/wiki/Loose_coupling)

至于具体的代码示例......

这是我最近使用的一种松散耦合，来自 Microsoft.Practices.CompositeUI 的东西。

```
 [ServiceDependency]
    public ICustomizableGridService CustomizableGridService
    {
        protected get { return _customizableGridService; }
        set { _customizableGridService = value; }
    } 
```

此代码声明此类依赖于 CustomizableGridService。它不仅仅是直接引用服务的确切实现，而是简单地声明它需要对该服务的一些实现。然后在运行时，系统会解决该依赖关系。

如果不清楚，您可以在此处阅读更详细的说明：

[http://en.wikipedia.org/wiki/Dependency_injection](http://en.wikipedia.org/wiki/Dependency_injection)

想象一下 ABCCustomizableGridService 是我打算在这里连接的实现。

如果我选择这样做，我可以将其拉出并用 XYZCustomizableGridService 或 StubCustomizableGridService 替换它，而对具有此依赖关系的类完全不做任何更改。

如果我直接引用了 ABCCustomizableGridService，那么我需要更改那个/那些引用/s 以便交换另一个服务实现。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-10-22T23:20:07.823

耦合与系统之间的依赖有关，可能是代码模块（函数、文件或类）、管道中的工具、服务器-客户端进程等。依赖关系越不一般，它们变得越“紧密耦合”，因为更改一个系统需要更改依赖它的其他系统。理想的情况是“松散耦合”，其中一个系统可以更改，而依赖于它的系统将继续工作而无需修改。

实现松耦合的一般方法是通过定义良好的接口。如果两个系统之间的交互得到很好的定义并且双方都遵守，那么在确保不违反约定的同时修改一个系统变得更容易。在实践中经常出现没有建立良好定义的接口，导致设计草率和紧密耦合。

一些例子：

*   应用程序依赖于库。在紧密耦合下，应用程序会在较新版本的库上中断。谷歌搜索“DLL 地狱”。

*   客户端应用程序从服务器读取数据。在紧密耦合下，对服务器的更改需要在客户端进行修复。

*   两个类在面向对象的层次结构中交互。在紧密耦合下，对一个类的更改需要更新另一个类以匹配。

*   多个命令行工具在管道中进行通信。如果它们紧密耦合，对一个命令行工具版本的更改将导致读取其输出的工具出错。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-10-03T11:59:17.357

耦合是指不同的类相互连接的紧密程度。紧密耦合的类包含大量的交互和依赖关系。

松散耦合类则相反，因为它们彼此之间的依赖保持在最低限度，而是依赖于彼此定义良好的公共接口。

*乐高积木，SNAP 在一起的玩具将被认为是松散耦合的，因为您可以将零件拼在一起并构建您想要的任何系统。然而，一个拼图游戏的部分是紧密耦合的。你不能从一个拼图（系统）中取出一块拼图，然后把它拼成不同的拼图，因为系统（拼图）非常依赖于为特定“设计”而构建的非常具体的拼图。乐高积木以更通用的方式构建，因此可以在您的乐高屋或我的乐高外星人中使用。*

参考：[https ://megocode3.wordpress.com/2008/02/14/coupling-and-cohesion/](https://megocode3.wordpress.com/2008/02/14/coupling-and-cohesion/)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-22T18:38:04.943

考虑一个带有 FormA 和 FormB 的 Windows 应用程序。FormA 是主窗体，它显示 FormB。想象一下 FormB 需要将数据传回其父级。

如果你这样做：

```
class FormA 
{
    FormB fb = new FormB( this );

    ...
    fb.Show();
}

class FormB 
{
    FormA parent;

    public FormB( FormA parent )
    {
        this.parent = parent;
    }     
} 
```

FormB 与 FormA 紧密耦合。除了 FormA 类型的父级之外，FormB 不能有其他父级。

另一方面，如果您让 FormB 发布一个事件并让 FormA 订阅该事件，那么 FormB 可以通过该事件将数据推送回该事件拥有的任何订阅者。那么在这种情况下，FormB 甚至不知道它与父级对话；通过松散耦合，事件提供了它只是与订阅者交谈。任何类型现在都可以成为 FormA 的父级。

rp

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-10-23T06:44:30.890

当两个组件依赖于彼此的具体实现时，它们是高度耦合的。

假设我在课堂上的某个方法中有此代码：

```
this.some_object = new SomeObject(); 
```

现在我的类依赖于 SomeObject，它们是高度耦合的。另一方面，假设我有一个 InjectSomeObject 方法：

```
void InjectSomeObject(ISomeObject so) { // note we require an interface, not concrete implementation
  this.some_object = so;
} 
```

那么第一个例子可以只使用注入的SomeObject。**这在测试期间很有用。**通过正常操作，您可以使用繁重的、使用数据库的、使用网络的类等，同时通过轻量级的模拟实现进行测试。**使用紧密耦合的代码，您无法做到这一点。**

您可以通过使用依赖注入容器来简化这项工作的某些部分。您可以在 Wikipedia 上阅读有关 DI 的更多信息：[http](http://en.wikipedia.org/wiki/Dependency_injection) ://en.wikipedia.org/wiki/Dependency_injection 。

**有时很容易走得太远。**在某些时候，您必须使事情具体化，否则您的程序的可读性和可理解性会降低。所以主要在组件边界使用这种技术，并且知道你在做什么。确保您正在利用松散耦合。如果没有，你可能在那个地方不需要它。DI 可能会使您的程序更复杂。确保你做出了很好的权衡。换句话说，保持良好的平衡。*与设计系统时一样。*祝你好运！

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2014-03-20T05:34:13.250

用简单的语言来说，松散耦合意味着它不依赖于其他事件的发生。它独立执行。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-23T17:56:41.843

在计算机科学中，“松散耦合”还有另一种含义，没有其他人在这里发布过，所以... 来吧 - 希望你能给我一些投票，这样它就不会在堆的底部丢失！当然，我回答的主题属于对该问题的任何全面回答......也就是说：

术语“松散耦合”最初作为一个术语进入计算领域，用作多 CPU 配置中 CPU 架构的形容词。它的对应术语是“紧耦合”。松耦合是指 CPU 不共享许多资源，而紧耦合是指 CPU 共享资源。

术语“系统”在这里可能会造成混淆，因此请仔细分析情况。

通常，但并非总是如此，硬件配置中的多个 CPU（它们存在于一个系统中）（如单独的“PC”盒中）将紧密耦合。除了一些具有跨“系统”实际共享主存储器的子系统的超高性能系统外，所有可分系统都是松散耦合的。

紧耦合和松耦合这两个术语是在多线程和多核 CPU 发明*之前引入的，因此这些术语可能需要一些同伴来充分阐明当今的情况。*而且，事实上，今天人们很可能拥有一个将两种类型都包含在一个整体系统中的系统。关于当前的软件系统，有两种常见的架构，每种架构中的一种，足够常见，这些应该是熟悉的。

首先，既然这是问题所在，一些松耦合系统的例子：

*   VaxClusters
*   Linux 集群

相比之下，一些紧耦合的例子：

*   Semetrical-Multi-Processing (SMP) 操作系统 - 例如 Fedora 9
*   多线程 CPU
*   多核 CPU

在当今的计算中，两者都在单个整体系统中运行的例子并不少见。例如，以运行 Fedora 9 的现代奔腾双核或四核 CPU 为例——这些是紧密耦合的计算系统。然后，将其中的几个组合到一个松散耦合的 Linux 集群中，您现在可以同时进行松散耦合和紧耦合计算！哦，现代硬件是不是很棒！

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-12-31T13:10:23.823

这里有一些长答案。不过原理很简单。[我从维基百科](http://en.wikipedia.org/wiki/Loose_coupling)提交了开幕词：

“松散耦合描述了具有某种交换关系的两个或多个系统或组织之间的弹性关系。

交易的每一端都明确提出了自己的要求，并且对另一端几乎没有假设。”

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2012-11-14T21:51:19.063

我提出了一个非常简单**的代码耦合测试**：

1.  如果对代码段 B 存在任何可能的修改，这将迫使代码段 A 进行更改以保持正确性，则代码段 A 与代码段 B 紧密耦合。

2.  如果没有可能对代码段 B 进行任何修改而需要对代码段 A 进行更改，则代码段 A 与代码段 B 不紧密耦合。

这将帮助您验证代码片段之间的耦合程度。有关推理，请参阅此博客文章： http: [//marekdec.wordpress.com/2012/11/14/loose-coupling-tight-coupling-decoupling-what-is-that-all-about/](http://marekdec.wordpress.com/2012/11/14/loose-coupling-tight-coupling-decoupling-what-is-that-all-about/)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-01-06T08:56:39.850

当您在其他类中使用关键字创建类的对象时`new`，您实际上是在进行紧密耦合（不好的做法），而应该使用松散耦合，这是一个很好的做法

---A.java---

```
package interface_package.loose_coupling;

public class A {

void display(InterfaceClass obji)
{
    obji.display();
    System.out.println(obji.getVar());
}
} 
```

---B.java---

```
package interface_package.loose_coupling;

public class B implements InterfaceClass{

private String var="variable Interface";

public String getVar() {
    return var;
}

public void setVar(String var) {
    this.var = var;
}

@Override
public void display() {
    // TODO Auto-generated method stub
    System.out.println("Display Method Called");
}
} 
```

---接口类---

```
package interface_package.loose_coupling;

public interface InterfaceClass {

void display();
String getVar();
} 
```

---主类---

```
package interface_package.loose_coupling;

public class MainClass {

public static void main(String[] args) {
    // TODO Auto-generated method stub

    A obja=new A();
    B objb=new B();
    obja.display(objb);     //Calling display of A class with object of B class 

}
} 
```

解释：

在上面的例子中，我们有两个类 A 和 B

B类实现接口即InterfaceClass。

InterfaceClass 为 B 类定义了一个 Contract，因为 InterfaceClass 具有 B 类的抽象方法，可以被任何其他类（例如 A）访问。

在 A 类中，我们有显示方法，它可以排除实现 InterfaceClass 的类的对象（在我们的例子中是 B 类）。并且在 A 类的那个对象方法上调用 B 类的 display() 和 getVar()

在 MainClass 中，我们创建了 A 类和 B 类的对象。通过传递 B 类的对象，即 objb，调用 A 的显示方法。A 的显示方法将与 B 类的对象一起调用。

现在谈论松散耦合。假设将来您必须将B类的名称更改为ABC，那么您不必在B类的显示方法中更改其名称，只需创建新的对象（ABC类）并将其传递给MailClass中的显示方法。您无需更改 A 类中的任何内容

参考： http: [//p3lang.com/2013/06/loose-coupling-example-using-interface/](http://p3lang.com/2013/06/loose-coupling-example-using-interface/)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-22T18:34:29.197

您可以阅读更多关于[“松散耦合”](http://en.wikipedia.org/wiki/Loose_coupling)的通用概念。

简而言之，它是对两个类之间关系的描述，其中每个类对另一个类的了解最少，并且每个类都可能继续正常工作，无论另一个类是否存在并且不依赖于另一个类的特定实现班级。

* * *

## 回答 #20

> 赞同：-7
> 
> 时间：2008-10-22T18:27:29.413

一般来说，松散耦合是两个参与者在相同的工作负载上相互独立工作。因此，如果您有 2 个 Web 服务器使用相同的后端数据库，那么您会说这些 Web 服务器是松散耦合的。紧密耦合可以通过在一台 Web 服务器上拥有 2 个处理器来举例说明……这些处理器是紧密耦合的。

希望这有点帮助。

# vba - 使用 VBA 同步两个列表

> ID：226978
> 
> 赞同：3
> 
> 时间：2008-10-22T18:23:09.233
> 
> 标签：vba, excel

同步两个列表的最佳方法是什么，每个列表可能包含另一个列表中不包含的项目？如图所示，列表没有排序 - 尽管如果有必要先排序它们不会是一个问题。

```
List 1 = a,b,c,e
List 2 = b,e,c,d 
```

使用上面的列表，我正在寻找一种解决方案，该解决方案将在两列中写入电子表格：

```
a
b  b
c  c
   d
e  e 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-22T19:51:59.803

以下是有关使用断开连接的记录集的一些注意事项。

```
Const adVarChar = 200  'the SQL datatype is varchar

'Create arrays fron the lists
asL1 = Split("a,b,c,", ",")
asL2 = Split("b,e,c,d", ",")

'Create a disconnected recordset
Set rs = CreateObject("ADODB.RECORDSET")
rs.Fields.append "Srt", adVarChar, 25
rs.Fields.append "L1", adVarChar, 25
rs.Fields.append "L2", adVarChar, 25

rs.CursorType = adOpenStatic
rs.Open

'Add list 1 to the recordset
For i = 0 To UBound(asL1)
    rs.AddNew Array("Srt", "L1"), Array(asL1(i), asL1(i))
    rs.Update
Next

'Add list 2
For i = 0 To UBound(asL2)
    rs.MoveFirst
    rs.Find "L1='" & asL2(i) & "'"

    If rs.EOF Then
        rs.AddNew Array("Srt", "L2"), Array(asL2(i), asL2(i))
    Else
        rs.Fields("L2") = asL2(i)
    End If

    rs.Update
Next

rs.Sort = "Srt"

'Add the data to the active sheet
Set wks = Application.ActiveWorkbook.ActiveSheet

rs.MoveFirst

intRow = 1
Do
    For intField = 1 To rs.Fields.Count - 1
        wks.Cells(intRow, intField + 1) = rs.Fields(intField).Value
    Next intField

    rs.MoveNext
    intRow = intRow + 1
Loop Until rs.EOF = True 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T20:41:13.027

这是另一个选项，这次使用字典（添加对 Microsoft Scripting Runtime 的引用，它还有其他几个非常有用的对象 - 没有它就不要开始 VBA 编码！）

如所写，输出未排序 - 这可能有点令人讨厌。无论如何，这里有几个不错的小技巧：

```
Option Explicit

Public Sub OutputLists()

Dim list1, list2
Dim dict1 As Dictionary, dict2 As Dictionary
Dim ky
Dim cel As Range

    Set dict1 = DictionaryFromArray(Array("a", "b", "c", "e"))
    Set dict2 = DictionaryFromArray(Array("b", "e", "c", "d"))

    Set cel = ActiveSheet.Range("A1")

    For Each ky In dict1.Keys
        PutRow cel, ky, True, dict2.Exists(ky)
        If dict2.Exists(ky) Then
            dict2.Remove ky
        End If
        Set cel = cel.Offset(1, 0)
    Next

    For Each ky In dict2
        PutRow cel, ky, False, True
        Set cel = cel.Offset(1, 0)
    Next

End Sub

Private Sub PutRow(cel As Range, val As Variant, in1 As Boolean, in2 As Boolean)

Dim arr(1 To 2)

    If in1 Then arr(1) = val
    If in2 Then arr(2) = val
    cel.Resize(1, 2) = arr

End Sub

Private Function DictionaryFromArray(arr) As Dictionary

Dim val

    Set DictionaryFromArray = New Dictionary
    For Each val In arr
        DictionaryFromArray.Add val, Nothing
    Next

End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T23:40:47.157

另一种选择是集合。这不会按字母顺序对输出进行排序，但如果需要，您可以先对列表进行排序。请注意，这还将为您提供一个唯一列表，删除重复项。该代码假定您的列表位于字符串数组 L1 和 L2 中。

```
Dim C As New Collection,i As Long, j As Long
ReDim LL(UBound(L1) + UBound(L2), 2) As String 'output array

For i = 1 To UBound(L1)
  On Error Resume Next  'try adding to collection
    C.Add C.Count + 1, L1(i) 'store sequence number,ie 1,2,3,4,...
  On Error GoTo 0
  j = C(L1(i)) 'look up sequence number
  LL(j, 1) = L1(i)
Next i

For i = 1 To UBound(L2) 'same for L2
  On Error Resume Next
    C.Add C.Count + 1, L2(i)
  On Error GoTo 0
  j = C(L2(i))
  LL(j, 2) = L2(i)
Next i

'Result is in LL, number of rows is C.Count
Range("Results").Resize(UBound(LL, 1), 2) = LL 
```

# javascript - Google Maps API - GMarker.openInfoWindowHtml() 停止工作

> ID：226980
> 
> 赞同：1
> 
> 时间：2008-10-22T18:23:34.177
> 
> 标签：javascript, google-maps, mapping, openinfowindowhtml

我有一个谷歌地图突然停止工作，没有明显的原因（我几个月没有接触过代码，但是我们的 CMS 的包装代码可能在没有公司告诉我的情况下发生了变化）。

[http://www.democratandchronicle.com/section/builder](http://www.democratandchronicle.com/section/builder)

（抱歉，地图外的 HTML 很糟糕，其中大部分来自我们的母公司……）

我已将其缩小到我的`drawMarker`功能的这一部分：

```
GEvent.addListener(marker, 'click', function() {
  marker.openInfoWindowHtml(html, { maxWidth: 500 });
}); 
```

注意：

*   `alert(html);`显示信息窗口的正确 HTML。
*   html 变量中的 HTML 确实有效。
*   点击事件正在触发（由`alert('test');`其中确认）
*   尽管代码相似，但我在同一站点上托管的另一张地图[工作正常](http://www.democratandchronicle.com/garagesales)。
*   我看不到 Firebug 或 IE 中的 JavaScript 错误。

一段时间以来，我一直在反对这一点。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-23T06:27:02.597

我有时会遇到 Google Maps API 的随机问题，并且不止一次通过返回一个 API 版本来修复它。即，如果您的 google maps API javascript 包含字符串是这样的，请将**2.x**`http://maps.google.com/maps?file=api&v=2.xd&key=XXXXX` 更改为几个版本（在它工作时返回），例如**2.132**或其他东西

 ***** * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T21:54:10.493

尝试：

```
GEvent.addListener(marker, 'click', function() {
  this.openInfoWindowHtml(html, { maxWidth: 500 });
}); 
```

请记住对象“标记”的范围超出了您的功能

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-28T11:08:18.463

我最近遇到了这个问题，事件处理程序肯定运行了，等等。结果页面上有两个 Google Maps <script> 标签实例。删除一个固定它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T20:22:29.943

尝试强制 JavaScript 从您的 HTML 中创建一个新变量：

```
GEvent.addListener(marker, 'click', function() {
marker.openInfoWindowHtml(html+'', { maxWidth: 500 });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T15:56:29.670

这自己解决了。我怀疑 API 的更新破坏了一两个版本。

# .net - 对 IList 进行排序的最佳方法是什么 在.Net 2.0 中？

> ID：226981
> 
> 赞同：5
> 
> 时间：2008-10-22T18:23:42.197
> 
> 标签：.net, .net-2.0

我有一个`IList<T>`需要排序的东西，如果可能的话，我宁愿不复制列表。我注意到`ArrayList`有一个`Adapter`静态方法可以包装传递的列表而不复制它，但这需要一个`IList`并且我有一个`IList<T>`. 从 a`System.Collections.Generic.IList<T>`转换为 a`System.Collections.IList`并仅使用该`Adapter`方法是否安全？

请注意，这是 .Net 2.0，因此不能选择 LINQ。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-22T18:25:21.973

从 Paul Fox 的博客中，我推荐帖子“如何对 IList 进行排序”： http: [//foxsys.blogspot.com/2007/06/how-to-sort-generic-ilist.html](http://foxsys.blogspot.com/2007/06/how-to-sort-generic-ilist.html)

以防万一该博客将来消失，我将在此处复制该帖子：

* * *

**如何对通用 IList 进行排序**

更新

您可以阅读和更新有关[对通用 IList 和 List 进行排序](http://foxsys.blogspot.com/2008/05/how-to-sort-generic-list-sorting-list.html)的帖子。许多人会更喜欢更新帖子中提到的方法。

对通用 IList 进行排序

我试图对通用 IList<> 进行排序，并找到了一种相当简单的方法。

第1步

您需要为 IList 中包含的类型实现 IComparable。对于这个例子，我将使用一个简单的 Language Dto 类。

```
public class LanguageDto : IComparable {
 private String name;
 public string Name { get { return name; } set { name = value; } }

 public LanguageDto(string name) {
     this.name = name;
 }

 #region IComparable Members
 public int CompareTo(object obj) {
     if (obj is LanguageDto) {
     LanguageDto language = (LanguageDto)obj;
     return this.name.CompareTo(language.name);
     }
     throw new ArgumentException(string.Format("Cannot compare a LanguageDto to an {0}", obj.GetType().ToString()));
 }
 #endregion
} 
```

第2步

对您的 IList 进行排序。为此，您将使用传入 IList 的 ArrayList.Adapter() 方法，然后调用 Sort 方法。像这样...

```
ArrayList.Adapter((IList)languages).Sort(); 
```

注意：语言的类型为“IList”

然后，语言应该是您类型的排序列表！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-22T18:29:31.687

您不能将 IList(T) 转换为 IList。

在使用 Reflector 进行一些嗅探之后，似乎 ArrayList.Adapter(IList).Sort() 将首先将列表复制到对象数组，对数组进行排序，然后将数组复制回列表：

```
object[] array = new object[count];
this.CopyTo(index, array, 0, count);
Array.Sort(array, 0, count, comparer);
for (int i = 0; i < count; i++)
{
    this._list[i + index] = array[i];
} 
```

如果 List(T) 中的 T 是值类型，则可能会产生装箱开销。

如果您需要更改您拥有的列表中对象的顺序，您可以类似地执行此操作：

```
IList<object> unsorted = ...
List<object> sorted = new List<object>(unsorted);
sorted.Sort(); 
for (int i = 0; i < unsorted.Countt; i++)
{
    unsorted[i] = sorted[i];
} 
```

如果列表太大（如数亿个项目）以至于您无法在内存中制作额外的副本，我建议首先使用 List(T) 或实现您最喜欢的就地排序算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T20:34:31.073

由于 Sort 方法不在 IList 接口上，您可以考虑创建自己的：

```
interface ISortableList<T> : IList<T>
{
    void Sort();
    void Sort(IComparer<T> comparer);
}

class SortableList<T> : List<T>, ISortableList<T> { }

/* usage */
void Example(ISortedList<T> list)
{
    list.Sort();
    list.Sort(new MyCustomerComparer());
} 
```

通常，您在方法中指定的参数类型应该是您实际需要调用的成员的最小公分母。如果您确实需要调用 Sort() 方法，那么您的参数应该定义该成员。否则，您可能应该将其加载到另一个可以执行您想要的操作的对象中，例如：

```
void Example(IList<T> list)
{
    list = new List<T>(list).Sort();
} 
```

这实际上应该非常快，几乎可以肯定比编写自己的自定义内联排序算法还要快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-22T18:42:52.720

我知道它不是 .NET 2.0，但我非常喜欢 LINQ，我会一有机会就支持它 :)

**简单排序：**

```
var sortedProducts =
    from p in products
    orderby p.ProductName
    select p;

ObjectDumper.Write(sortedProducts); 
```

**按多个条件排序：**

```
string[] digits = { "zero", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine" };

var sortedDigits =
    from d in digits 
    orderby d.Length, d
    select d; 
```

这两个例子都来自[101 Linq Samples](http://msdn.microsoft.com/en-us/vcsharp/aa336756.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-25T15:50:55.057

如果您需要对不同类的列表（而不是 IList）进行排序，而无需为所有类创建单独的比较器类，并且仍然保持实体类干净（您不想实现 IComparable），则可以使用以下（与 .NET 2.0 兼容）：

```
public class DynamicComparer<T> : IComparer<T>
{

    private Func<T, int> calculateFunc;
    private int calculateMultiplier;

    private Func<T, T, int> compareFunc;
    public DynamicComparer(Func<T, int> calculateFunc, bool reverse = false)
    {
        if (calculateFunc == null)
        {
            throw new Exception("Delegate function 'calculateFunc' cannot be null.");
        }

        this.calculateFunc = calculateFunc;
        this.calculateMultiplier = reverse ? -1 : 1;
        this.compareFunc = null;
    }

    public DynamicComparer(Func<T, T, int> compareFunc)
    {
        if (calculateFunc == null)
        {
            throw new Exception("Delegate function 'compareFunc' cannot be null.");
        }

        this.calculateFunc = null;
        this.compareFunc = compareFunc;
    }

    public int Compare(T x, T y)
    {
        if (calculateFunc != null)
        {
            return (calculateFunc(x) - calculateFunc(y)) * this.calculateMultiplier;
        }
        if (compareFunc != null)
        {
            return compareFunc(x, y);
        }

        throw new Exception("Compare not possible because neither a Compare or a Calculate function was specified.");
    }
} 
```

如果您使用的是 .NET 2.0（在[Replacing Func with delegates C#](https://stackoverflow.com/questions/16982220/replacing-func-with-delegates-c-sharp)中找到），您还需要 Func 委托：

```
public delegate TResult Func<T, TResult>(T t);
public delegate TResult Func<T, U, TResult>(T t, U u); 
```

用法：

```
myList.Sort(new DynamicComparer<MyClass>(x => x.MyIntProperty) // Ascending
myList.Sort(new DynamicComparer<MyClass>(x => x.MyIntProperty, true) // Descending 
```

一些简单的单元测试：

```
[TestClass()]
public class DynamicComparerTU
{
    [TestMethod()]
    public void SortIntList()
    {
        // Arrange
        dynamic myIntArray = new int[] {
            4,
            1,
            9,
            0,
            4,
            7
        };
        dynamic myIntList = new List<int>(myIntArray);

        // Act
        int temp = 0;
        for (int write = 0; write <= myIntArray.Length - 1; write++)
        {
            for (int sort = 0; sort <= myIntArray.Length - 2; sort++)
            {
                if (myIntArray(sort) > myIntArray(sort + 1))
                {
                    temp = myIntArray(sort + 1);
                    myIntArray(sort + 1) = myIntArray(sort);
                    myIntArray(sort) = temp;
                }
            }
        }

        myIntList.Sort(new DynamicComparer<int>(x => x));

        // Assert
        Assert.IsNotNull(myIntList);
        Assert.AreEqual(myIntArray.Length, myIntList.Count);
        for (int i = 0; i <= myIntArray.Length - 1; i++)
        {
            Assert.AreEqual(myIntArray(i), myIntList(i));
        }
    }

    [TestMethod()]
    public void SortStringListByLength()
    {
        // Arrange
        dynamic myStringArray = new string[] {
            "abcd",
            "ab",
            "abcde",
            "a",
            "abc"
        };
        dynamic myStringList = new List<string>(myStringArray);

        // Act
        myStringList.Sort(new DynamicComparer<string>(x => x.Length));

        // Assert
        Assert.IsNotNull(myStringList);
        Assert.AreEqual(5, myStringList.Count);
        Assert.AreEqual("a", myStringList(0));
        Assert.AreEqual("ab", myStringList(1));
        Assert.AreEqual("abc", myStringList(2));
        Assert.AreEqual("abcd", myStringList(3));
        Assert.AreEqual("abcde", myStringList(4));
    }

    [TestMethod()]
    public void SortStringListByLengthDescending()
    {
        // Arrange
        dynamic myStringArray = new string[] {
            "abcd",
            "ab",
            "abcde",
            "a",
            "abc"
        };
        dynamic myStringList = new List<string>(myStringArray);

        // Act
        myStringList.Sort(new DynamicComparer<string>(x => x.Length, true));

        // Assert
        Assert.IsNotNull(myStringList);
        Assert.AreEqual(5, myStringList.Count);
        Assert.AreEqual("abcde", myStringList(0));
        Assert.AreEqual("abcd", myStringList(1));
        Assert.AreEqual("abc", myStringList(2));
        Assert.AreEqual("ab", myStringList(3));
        Assert.AreEqual("a", myStringList(4));
    }
} 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2011-03-15T11:49:05.550

```
IList<object> unsorted = ...
IList<object> sortedList = unsorted.Orderby(x => x.Tostring()).Tolist(); 
```

这将给出对象特定字段的排序列表。

# iphone - 如何直接从我的应用程序启动 Appstore 应用程序

> ID：226986
> 
> 赞同：26
> 
> 时间：2008-10-22T18:24:41.930
> 
> 标签：iphone, app-store

我现在使用了几个直接从应用程序启动 iTunes 商店的应用程序。我什至在我的 2.1 iPod 2G 上使用了一些。

我知道 2.1 中有一个错误会阻止 appstore 链接在 safari 中工作，但不知何故人们直接启动了 appstore，甚至没有通过 safari。

你怎么做到这一点？它是一个未记录的 openURL 功能吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2010-11-08T09:02:42.487

非常简洁：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"itms://itunes.com/apps/appname"]]; 
```

如果您想为开发人员发送到所有应用程序，请使用

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"itms://itunes.com/apps/developername"]]; 
```

这些适用于 iOS 4.1

另请参阅 [如何链接到应用商店中的应用](https://stackoverflow.com/questions/433907/how-to-link-to-apps-on-the-app-store/4122371#4122371)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-22T18:37:39.640

从 iTunes 中，将应用程序的图标拖到桌面上，这将为您提供一个可以直接使用的链接（例如，[http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=284036524&mt=8](http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=284036524&mt=8)在桌面和 iPhone 上启动 AppStore 到填字游戏）。

将其弹出到 NSURL 并在其上调用 openURL。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-09-03T17:18:35.437

我想出了如何直接进入 AppStore 中应用程序的评论页面。

基本上它就像下面那样完成，请随时阅读我的​​博客[文章](http://www.memention.com/blog/2009/09/03/Open-Reviews.html)。

```
- (IBAction)gotoReviews:(id)sender
{
    NSString *str = @"itms-apps://ax.itunes.apple.com/WebObjects/MZStore.woa";
    str = [NSString stringWithFormat:@"%@/wa/viewContentsUserReviews?", str]; 
    str = [NSString stringWithFormat:@"%@type=Purple+Software&id=", str];

    // Here is the app id from itunesconnect
    str = [NSString stringWithFormat:@"%@289382458", str]; 

    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:str]];
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-04-17T08:15:17.797

如果您想显示应用程序的详细信息而不是评论，您可以使用这样的 url：

```
NSString *appId    = @"app id";
NSString *endPoint = [NSString stringWithFormat:@"phobos.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=%@&mt=8", appId];
NSString *link     = [NSString stringWithFormat:@"itms-apps://%@", endPoint];

[[UIApplication sharedApplication] openURL:[NSURL URLWithString:link]]; 
```

我已经在装有 iOS 6.1 的 iPhone 上对此进行了测试，并将立即将您重定向到 App Store 应用程序。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-22T20:07:17.150

Ben Gottlieb 是对的，但有一种更快的方法来获取 URL：您可以右键单击 iTunes 中的任何应用程序图标，然后选择“复制 iTunes Store URL”。

然后调用`UIApplication openURL`它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-13T01:56:05.267

确保它显示“phobos.apple.com”而不是“itunes.apple.com”

前者直接打开App Store，后者会先打开MobileSafari，再打开App Store。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-10-04T19:41:00.783

您可以从 itunesconnect.apple.com“管理您的应用程序”获取您的 AppID

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-05T21:07:15.640

如果您不想获得 iTunes 的链接，您可以这样做。

1.  在 AppStore 中选择您的应用
2.  点击右上角的告诉朋友按钮。
3.  通过电子邮件将链接发送给自己

我在 iTunes 链接没有的时候做过这项工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-06-01T13:22:34.210

如果你有一个附属链接，并且你想在没有 Safari 的情况下直接打开 App Store 应用程序，你可以使用隐藏的 UIWebView 或 NSURLConnection。对于后者，请参阅这篇文章[http://gamesfromwithin.com/handling-app-store-and-linkshare-links](http://gamesfromwithin.com/handling-app-store-and-linkshare-links)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-01-11T18:52:22.673

这是我使用的代码，并针对提到的各种 iOS 版本对其进行了测试。显然将客户 ID 更改为您的 ID：

```
- (void)showOurAppsInAppStore
{        
    NSString *searchUrl = nil;
    // iPad
    if ([DeviceController isDeviceAnIpad]) {
        searchUrl = @"itms-apps://itunes.apple.com/us/artist/seligman-ventures-ltd/id326161338";
    }
    // iPhone / iPod Touch
    else {
        // iOS 7+
        if ([DeviceController isDeviceOperatingSystemAtleast:@"7.0"]) {
            searchUrl = @"itms-apps://itunes.apple.com/artist/seligman-ventures-ltd/id326161338";
        }
        // iOS 6
        else if ([DeviceController isDeviceOperatingSystemAtleast:@"6.0"]) {
            searchUrl = @"itms-apps://ax.itunes.apple.com/artist/seligman-ventures-ltd/id326161338";
        }
        // Pre iOS 6
        else {
            NSString *companyName = @"Seligman Ventures";
            searchUrl = [NSString stringWithFormat:@"http://phobos.apple.com/WebObjects/MZSearch.woa/wa/search?WOURLEncoding=ISO8859_1&lang=1&output=lm&country=US&term=%@&media=software", [companyName stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
        }
    }

    [[UIApplication sharedApplication] openURL: [NSURL URLWithString:searchUrl]];
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2010-08-03T04:25:55.377

如果你只是发布你的应用程序......你还没有“应用程序 ID #”......所以这些方法都不起作用。

我不得不在我的 v1.0 中插入一个“非工作链接”……然后在我的 v1.1 更新中……添加了实际的链接和应用程序 ID #。***********`***