# StackOverflow 问答 10710000-10710999

# android - Android 2 光标 1 列表视图

> ID：10710006
> 
> 赞同：0
> 
> 时间：2012-05-22T20:52:14.707
> 
> 标签：android, cursor, android-listview

我有一个从光标填充列表视图的应用程序。其中一项是加仑水。最近我也有一个使用升的请求，所以我写了一个设置页面，让人们选择单位。我想让光标仍然在列表视图中显示水的单位数，但我还希望在数字旁边有一个 texview 来表示加仑或升，以第二个光标拉动为准。是否可以让一个光标在列表视图中放置 10 个项目，然后另一个光标在同一个列表视图中放置一个项目？

# asp.net - IsPostBack、IsAsync 和 IsCallback 有什么区别？

> ID：10710008
> 
> 赞同：5
> 
> 时间：2012-05-22T20:52:26.603
> 
> 标签：asp.net, httpwebrequest, postback, asp.net-4.0

我正在编写代码`Page_Load`并`IsPostBack`首先使用，但后来我遇到了`IsAsync`和`IsCallback`属性。我开始想，他们看起来有点像。从谷歌我找到了一些信息：

1.  `IsPostBack`当页面通过表单方法发布时是真的，*我同意 100%*。

2.  `IsCallBack`当页面从 AJAX 调用中回调时为真，*那么 IsAsync 的目的是什么？*
    *来自[MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.page.iscallback.aspx)* “ `IsCallBack`：获取一个值，该值指示页面请求是否是回调的结果。”
3.  `IsAsync`当进行 ASP.net AJAX 部分更新时，它是一个异步回发。

但是我仍然有一些问题：

1.  什么是回调以及它与回发有何不同。

2.  清楚地区分 IsPostBack、IsAsync 和 IsCallback。

3.  目前我正在开发一个 WebApp，它可以通过 jQuery Ajax 执行 postBack。因此，要识别 jQuery Ajax，我应该使用 IsPostBack。

## 有用的链接：

[IsCallback 和 IsPostback 的区别](https://stackoverflow.com/questions/760912/what-is-the-difference-between-page-ispostback-and-page-iscallback)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-22T21:16:31.147

独立于客户端发出的`IsAsync`请求类型，它用于标识异步处理的页面，如文档中所述：

> 获取一个值，该值指示页面是否被异步处理。

[您可以在此 MSDN 杂志文章ASP.NET 2.0 中的](http://msdn.microsoft.com/en-us/magazine/cc163725.aspx#S2)异步页面中阅读有关异步页面的更多信息。

`IsCallback`用于标识客户端回调，请参阅[在 ASP.NET 网页中以编程方式实现客户端回调而无需回](http://msdn.microsoft.com/en-us/library/ms178208.aspx)发，最后`IsPostback`标识由提交与页面关联的表单产生的请求。`IsPostback`本身不能用于识别将完全渲染页面的回发，而不是将执行部分渲染的回发，例如，如果您使用`UpdatePanel`.

为了识别一个只执行部分渲染的回发请求，您需要检查它`IsPostback`是真的`ScriptManager.GetCurrent(this.Page).IsInAsyncPostBack`还是真的。

本主题也感兴趣[如何：确定如何调用 ASP.NET 网页](http://msdn.microsoft.com/en-us/library/ms178141.aspx)。

# rest - MVC Web API/Rest：相关对象的请求

> ID：10710013
> 
> 赞同：0
> 
> 时间：2012-05-22T20:52:53.710
> 
> 标签：rest, asp.net-web-api

我有两个控制器；项目控制器和文档控制器。一个项目可以有多个文档。

如果我想通过 projectid 获取文档，应该如何以及在哪里使用 REST 来完成？（总的来说，我还没有了解 REST 如何处理相关数据）

**编辑：**找到MVC Web API，获取可能是我正在寻找的[子项目。](https://stackoverflow.com/questions/10555323/mvc-web-api-get-sub-items)

伊瓦尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:00:41.033

我相信这应该在 DocumentController 中完成。下面是一个例子

```
public class DocumentController : ApiController {

    public IQueryable<Document> GetDocs() 
    {

        //get db context 

            return db.documents;

    }

    public ICollection<Document> Get(int id)
    {
        return db.documents.where(d = d.ProjectId == id);

    }

} 
```

可以使用 odata 过滤器查询来查询 IQuerable 版本。如下所示：

```
http://server:port/api/Document/getdocs?$filter=ProjectId eq ‘1'
http://server:port/api/Document/getdocs?$filter=DocumentId eq ‘1001' 
```

（您必须修改 MapHttpRoute 才能注册此路由）

获取版本（第二个函数）将简单地返回基于项目 ID 的集合。

# spring - Spring MVC 配置数据源 Bean (Spring 3.0,Hibernate,Apache Tomcat, Netbeans)

> ID：10710020
> 
> 赞同：0
> 
> 时间：2012-05-22T20:53:29.713
> 
> 标签：spring, apache, hibernate, jakarta-ee

我正在尝试运行/设置一个简单的 Spring MVC 3 + Hibernate + Apache Tomcat 7.0，使用 NetBeans 7.1 作为开发环境。

Netbeans 带有预先打包的 Spring 和 Hibernate 文件/jars/依赖项，这些文件/jars/依赖项已经设置在正确的目录结构中。

为了在 applicationContext 中设置数据源 bean，我有 2 个选择

* * *

**变体 #1** （使用数据源类=“org.springframework.jdbc.datasource.DriverManagerDataSource”，它是用于 Spring 开发的 NetBeans 预打包数据源）

来自 applicationContext.xml 的片段

```
<!-- Declare a datasource that has pooling capabilities-->  
<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource"    
destroy-method="close"    p:driverClass="com.mysql.jdbc.Driver"    
p:jdbcUrl="jdbc:mysql://localhost:3306/yourmarketnet"   
p:user="root"    
p:password="arya6678"   
p:acquireIncrement="5"    
p:idleConnectionTestPeriod="60"    
p:maxPoolSize="100"    
p:maxStatements="50"    
p:minPoolSize="10" /> 
<!-- Declare the Hibernate SessionFactory for retrieving Hibernate sessions -->   
<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">    
<property name="dataSource" ref="dataSource"/>    
<property name="configLocation" ref="classpath:hibernate.cfg.xml"/>    
<property name="packagesToScan" value="com.yourmarketnet.*" />
</bean> 
```

**变体 2，错误结果：我的应用程序无法运行，Apache Tomcat 日志：**

org.springframework.beans.factory.BeanCreationException：创建 ServletContext 资源 [/WEB-INF/applicationContext.xml] 中定义的名称为“dataSource”的 bean 时出错：设置属性值时出错；嵌套异常是 org.springframework.beans.NotWritablePropertyException：bean 类 [org.springframework.jdbc.datasource.DriverManagerDataSource] 的无效属性“acquireIncrement”：Bean 属性“acquireIncrement”不可写或设置方法无效。setter 的参数类型是否与 getter 的返回类型匹配？在 org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1361) 在 org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java: 在 java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334) 在 java.util.concurrent.FutureTask.run(FutureTask.java:166) 在 java.util.concurrent 调用(StandardContext.java:5221) .ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) at java.lang.Thread.run(Thread.java:722) 由：org。 springframework.beans.NotWritablePropertyException：bean 类 [org.springframework.jdbc.datasource.DriverManagerDataSource] 的属性“acquireIncrement”无效：Bean 属性“acquireIncrement”不可写或设置方法无效。setter 的参数类型是否与 getter 的返回类型匹配？在 org.springframework.beans.BeanWrapperImpl.setPropertyValue(BeanWrapperImpl.java:1052) 在 org.

**Variation #2**
(using data source class="org.apache.commons.dbcp.BasicDataSource") 然后我决定下载 Apache Commons dbcp jar，并将“commons-dbcp-1.4.jar”添加到我的项目中。

来自 applicationContext.xml 的片段

```
<!-- Declare a datasource that has pooling capabilities-->  
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"    
destroy-method="close"    p:driverClass="com.mysql.jdbc.Driver"    
p:jdbcUrl="jdbc:mysql://localhost:3306/yourmarketnet"   
p:user="root"    
p:password="arya6678"   
p:acquireIncrement="5"    
p:idleConnectionTestPeriod="60"    
p:maxPoolSize="100"    
p:maxStatements="50"    
p:minPoolSize="10" /> 
<!-- Declare the Hibernate SessionFactory for retrieving Hibernate sessions -->   
<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">    
<property name="dataSource" ref="dataSource"/>    
<property name="configLocation" ref="classpath:hibernate.cfg.xml"/>    
<property name="packagesToScan" value="com.yourmarketnet.*" />
</bean> 
```

* * *

**变体 2，错误结果：我的应用程序无法运行，Apache Tomcat 日志：**

org.springframework.beans.factory.BeanCreationException：创建 ServletContext 资源 [/WEB-INF/applicationContext.xml] 中定义的名称为“dataSource”的 bean 时出错：设置属性值时出错；嵌套异常是 org.springframework.beans.NotWritablePropertyException：bean 类 [org.apache.commons.dbcp.BasicDataSource] 的无效属性“acquireIncrement”：Bean 属性“acquireIncrement”不可写或具有无效的 setter 方法。setter 的参数类型是否与 getter 的返回类型匹配？在 org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1361) 在 org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1086) 在 org. concurrent.FutureTask$Sync.innerRun(FutureTask.java:334) 在 java.util.concurrent.FutureTask.run(FutureTask.java:166) 在 java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) 在 java .util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) at java.lang.Thread.run(Thread.java:722) 原因：org.springframework.beans.NotWritablePropertyException：bean 的无效属性“acquireIncrement”类 [org.apache.commons.dbcp.BasicDataSource]：Bean 属性“acquireIncrement”不可写或设置方法无效。setter 的参数类型是否与 getter 的返回类型匹配？在 org.springframework.beans.BeanWrapperImpl.setPropertyValue(BeanWrapperImpl.java:1052) 在 org.springframework.beans.BeanWrapperImpl.setPropertyValue(BeanWrapperImpl.java:

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:20:02.930

您是否有特定的问题，或者您只是不理解错误？消息非常清楚：acquireIncrement 不是您尝试设置的类的属性。我相信该属性来自 C3P0 连接池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:25:34.037

p 命名空间 ( `p:user`, `p:password`, `p:acquireIncrement`) 用于设置 Java bean 的属性。看起来您正在尝试在和类上设置`acquireIncrement`属性。根据这些类的文档（[Apache Commons DBCP](http://commons.apache.org/dbcp/apidocs/org/apache/commons/dbcp/BasicDataSource.html)和[Spring 的数据源](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/jdbc/datasource/DriverManagerDataSource.html)），它们都没有这个属性的 setter 方法，这就是你在堆栈跟踪中看到 NotWritablePropertyException 的原因。`org.apache.commons.dbcp.BasicDataSource``org.springframework.jdbc.datasource.DriverManagerDataSource`

查看[Spring 的有关 p-namespace](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-p-namespace)配置的文档。

如果我选择的话，我会选择 Apache 的数据库连接池 (dbcp)。简单又好用。

# jquery - jquery 验证插件内联自定义规则

> ID：10710022
> 
> 赞同：2
> 
> 时间：2012-05-22T20:53:40.473
> 
> 标签：jquery, jquery-validate

我创建了一个自定义规则

```
$(document).ready(function(){
    $("#test-form").validate({
            rules: { 
                test1:{
                    required: true,
                    minlength: 2
                } 
            },
            messages:  {
                test1:{
                    required: "required",
                minlength: "min 2"                      
                }
            }
        });
    // don't really process form
    $("#test-form").submit(function() { return false; }); 
```

我有这个 HTML 代码

```
<input type="text" class="test1"/> 
```

但是它不起作用

如果我更改为预定义规则，它会起作用

```
<input type="text" class="number"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:01:05.653

The keys in `rules` should match the `name` parameter of the field. Try this:

```
<input type="text" name="test1" /> 
```

Also, you can use `debug: true` in the options of validate to prevent the form submission while you're testing, instead of returning false from the form submit.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T23:06:51.270

罗里是对的，规则和消息键应该与“名称”属性匹配，但它看起来虽然您正在尝试创建一个可以通过类名以声明方式添加的自定义规则？

因此，我认为您正在寻找[`.addMethod()`](http://docs.jquery.com/Plugins/Validation/Validator/addMethod#namemethodmessage)可以像这样使用的功能：

```
jQuery.validator.addMethod("alphanumeric", function(value, element) {
    return this.optional(element) || /^\w+$/i.test(value);
}, "Letters, numbers, and underscores only please"); 
```

这将通过这样的类名自动获取：

```
<input type="text" class="alphanumeric" /> 
```

# php - 计算按不同部分名称分组的项目

> ID：10710026
> 
> 赞同：0
> 
> 时间：2012-05-22T20:54:01.337
> 
> 标签：php, mysql

我有一个数据库：

```
---------------------
| section | name    |
---------------------
| food    | steak   |
---------------------
| food    | chicken |
---------------------
| drink   | water   | 
---------------------
| food    | pork    | 
---------------------
| drink   | soda    | 
---------------------
| drink   | steak   | 
--------------------- 
```

我正在尝试计算每个部分的行数。问题是，我没有静态部分名称。我试图用一个查询来做到这一点。

这是我正在寻找的结果：

```
-------------
| food  | 3 |
-------------
| drink | 3 |
------------- 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T20:57:17.357

```
SELECT section, COUNT(name) FROM table_name GROUP BY section 
```

# wpf - Crystal Reports：使用 Crystal Reports 的 log4net.dll 版本编译我的项目是个好主意吗？

> ID：10710027
> 
> 赞同：8
> 
> 时间：2012-05-22T20:54:02.347
> 
> 标签：wpf, crystal-reports

我正在使用 Apache 的 log4net 版本来记录东西

```
1.2.10.0 (with PublicTokenKey=1b44e1d426115821) 
```

但不幸的是，SAP Crystal Reports 使用它自己的这个库版本和另一个公共令牌密钥（用他们自己的 snk 文件编译）：

```
1.2.10.0 (with PublicTokenKey=692fbea5521e1304) 
```

相同的版本，不同的公共令牌密钥。当我编译我的解决方案时，我有一条消息告诉我以下内容：

*“无法解决“log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=1b44e1d426115821”和“log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=692fbea5521e1304”之间的冲突。选择“log4net, Version=1.2 .10.0, Culture=neutral, PublicKeyToken=1b44e1d426115821" 任意。"*

最糟糕的是，如果不安装 32 位版本的 Crystal Reports（在 GAC 上安装 log4net 程序集），我无法部署到 64 位机器

我从 GAC 获取了 Crystal 版本的 log4net，问题是：

**如果我开始使用 Crystal Reports 的版本（PublicTokenKey=692fbea5521e1304），我会解决任何问题吗？**

**如果我想使用 log4net 的下一个版本（比如 v1.2.11.0）怎么办**？

 **有没有办法以正确的方式解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-27T09:36:42.013

你把这段代码添加到App.config中：</p>

```
<runtime>
<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
<dependentAssembly>
<assemblyIdentity name="CrystalDecisions.CrystalReports.Engine" publicKeyToken="692fbea5521e1304"/>
<bindingRedirect oldVersion="14.0.2000.0" newVersion="12.0.2000.0"/>
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="CrystalDecisions.Shared" publicKeyToken="692fbea5521e1304"/>
<bindingRedirect oldVersion="14.0.2000.0" newVersion="12.0.2000.0"/>
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="CrystalDecisions.ReportSource" publicKeyToken="692fbea5521e1304"/>
<bindingRedirect oldVersion="14.0.2000.0" newVersion="12.0.2000.0"/>
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="CrystalDecisions.Windows.Forms" publicKeyToken="692fbea5521e1304"/>
<bindingRedirect oldVersion="14.0.2000.0" newVersion="12.0.2000.0"/>
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="CrystalDecisions.Enterprise.Framework" publicKeyToken="692fbea5521e1304"/>
<bindingRedirect oldVersion="14.0.2000.0" newVersion="12.0.1100.0"/>
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="CrystalDecisions.Enterprise.InfoStore" publicKeyToken="692fbea5521e1304"/>
<bindingRedirect oldVersion="14.0.2000.0" newVersion="12.0.1100.0"/>
</dependentAssembly>
</assemblyBinding>
</runtime> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T22:53:19.323

好吧，因为 log4net 是开源的，你可以用不同的名字编译它。

我不完全确定这是否可行，但我怀疑您也可以查看[aliases](http://msdn.microsoft.com/en-us/library/ms173212.aspx)。另请参见[此处](http://msdn.microsoft.com/en-us/library/c3ay4x3d%28v=VS.100%29.aspx)。**

# svn - svn 将主干中的选定文件夹合并到分支中

> ID：10710028
> 
> 赞同：0
> 
> 时间：2012-05-22T20:54:03.983
> 
> 标签：svn, merge, branch

伙计们，

在我们的 SVN 版本（例如 r100）项目开始几周后，我们意识到我们必须从版本（例如 r10）创建一个回顾分支。r10 的分支将作为产品的 V1.0 发布，而主干将继续成为 V2.0

项目目录结构现在如下所示：

```
/svn/trunk/ProjectX/
/svn/branches/ProjectX/v1 
```

创建分支后，我们意识到主干中的以下文件夹，HEAD 修订版需要迁移到分支中：

```
/svn/trunk/ProjectX/commonStuff 
```

我正在尝试按以下方式执行此操作：

```
$ cd /svn/branches/ProjectX/v1
$ cd mkdir commonStuff
$ svn add commonStuff
$ svn merge https://repo.address/svn/trunk/ProjectX/commonStuff ./commonStuff 
```

当我运行上述命令时，通常会导致树冲突。这让我感到困惑，因为我的分支中尚不存在 commonStuff。

难道我做错了什么？有没有更好的方法来创建这样一个分支？

感谢您的帮助和见解。

-拉吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T22:19:21.107

我遵循了[这篇文章的](https://stackoverflow.com/questions/2099042/svn-merge-just-a-directory-add-from-a-checkin-without-directory-contents)提示。由于分支中不存在目标目录，所以我使用了 svn copy 而不是 merge。我的步骤是：

```
$ svn copy https://repo.address/svn/trunk/ProjectX/commonStuff https://repo.address/svn/branches/ProjectX/v1/commonStuff
$ svn update 
```

# javascript - 使用 Ajax 在 Hover 上播放声音

> ID：10710032
> 
> 赞同：0
> 
> 时间：2012-05-22T20:54:34.753
> 
> 标签：javascript, jquery, audio, html5-audio

我正在尝试根据此处找到的“重叠”方法为通过 Ajax 加载的内容在悬停时播放声音： http: [//css-tricks.com/play-sound-on-hover/](http://css-tricks.com/play-sound-on-hover/)：

```
function audioController(){
$("a") // loop each menu item
  .each(function(i) {
    if (i != 0) { // only clone if more than one needed
      $("#hover")
        .clone()
        .attr("id", "hover-" + i)
        .appendTo($(this).parent());
    }
    $(this).data("beeper", i); // save reference
  })
  .mouseenter(function() {
    $("#hover-" + $(this).data("beeper"))[0].play();
  });
$("#hover").attr("id", "hover-0"); // get first one into naming convention
} 
```

这适用于所有非 ajax href。但是，对于 Ajax 内容，它仅适用于 ajax 内容中的第一个 href。我收到此错误消息：

`Uncaught TypeError: Cannot call method 'play' of undefined` 这将是这一行：

`$("#hover-" + $(this).data("beeper"))[0].play();`

以下是我尝试使用 Ajax 调用加载函数的方式：

```
 $("#site-nav .nav1").on("click", function(event) {
    $('ul.top-level').load('assets/includes/recent.php', function(){
        $(this).show();
        audioController();
    });
    event.preventDefault();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:42:34.743

我建议您尝试使用适用于 HTML5 的 SoundManager2。

你可以在[这里](http://www.schillmania.com/projects/soundmanager2/)找到它的样本。

# uitableview - 如何从 xib(UITableViewCell) 加载 xib 视图(UIViewController)

> ID：10710039
> 
> 赞同：0
> 
> 时间：2012-05-22T20:55:25.873
> 
> 标签：uitableview, uiviewcontroller, xib, navigationcontroller, awakefromnib

这是我已经拥有的；

*   我已经从 XIB 文件 (UITableViewCell) 加载了一个自定义单元格
*   此自定义单元格包含按钮 A 和 B
*   创建了一个 IBAction 来处理按钮 A
*   在 MyTableView 类（UIViewController）中加载上面的 XIB 文件

现在我想在按钮A点击事件上加载另一个视图（很可能是一个XIB文件），在IBAction函数中我已经尝试过这个；

```
 // Where MyTableView is a class which loads this custom cell
    // ModalView is a name of XIB File
    MyTableView *vc = [[MyTableView alloc] initWithNibName:@"ModalView" bundle:nil];
    [self.navigationController pushViewController:vc animated:YES]; 
```

但它在“self.navigationController”处出现错误，说在 MyTableViewCell 类类型的对象上找不到 Property navigationController，我知道这是由于 UITableViewCell 类而发生的，并且这一行中的 self 指的是 UIViewController 对象，我应该使用 awakeFromNib或类似的东西，但我找不到任何足够的例子来让我实现我所需要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T22:47:11.430

好的，我已经解决了我的问题；

在 cellForRowAtIndexPath 函数中，我正在获取 XIB 文件 (UITableViewCell) 以表示自定义设计的单元格，我创建了一个按钮并将 XIB 视图中的按钮分配给它，然后将 IBAction 附加到它；

```
 // SimpleTableCell is the XIB filename (UITableViewCell)
    NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"SimpleTableCell" owner:self options:nil];
        cell = [nib objectAtIndex:0];

    UIButton *btn = [[UIButton alloc] init];
    btn = cell.btn;
    [btn addTarget:self action:@selector(smsBtnClicked:) 
                            forControlEvents:UIControlEventTouchUpInside]; 
```

# java - 在 Phonegap/Android 上从哪里开始使用 OpenID

> ID：10710041
> 
> 赞同：2
> 
> 时间：2012-05-22T20:55:28.840
> 
> 标签：java, javascript, android, cordova, openid

我正在使用 PhoneGap 制作应用程序并希望使用 OpenID 对用户进行身份验证。我不太确定该怎么做。这是我正在使用的库： [OpenID](http://code.google.com/p/openid4java/)（如果有更好的建议，请告诉我）。我了解代码的大部分功能。这是他们的示例：[SampleConsumer](http://code.google.com/p/openid4java/wiki/SampleConsumer)。我应该把所有这些代码放在哪里，我需要在 PhoneGap/JavaScript 端做什么？

# mysql - MySQL 查询非常奇怪

> ID：10710042
> 
> 赞同：2
> 
> 时间：2012-05-22T20:55:31.723
> 
> 标签：mysql

发生了一些奇怪的 SQL。这是查询：

```
UPDATE sugarcrm.qb_salesorders_leads_c c
JOIN qb_salesorders orders ON c.qb_salesorders_leadsqb_salesorders_idb = orders.id
SET c.qb_salesorders_leadsleads_ida = orders.memo
AND c.qb_salesorders_leadsqb_salesorders_idb = orders.id 
```

所以当我运行这个时，我会受到 0 行的影响。现在，如果我将 AND 替换为 ，那么它会返回并显示 354 行受影响。

现在您会认为，当我使用 运行相同的确切查询时，它会给我相同的结果。错误的。它回来时有 0 行受到影响。

之后，我可以将 , 更改为 AND 并且它再次起作用。

我是否发现了 MySQL 错误或者我在这里遗漏了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T20:57:53.127

AND 不是您尝试执行的有效语法。使用逗号分隔您尝试更新的每一列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T20:59:15.653

第一次使用逗号运行语法正确的查询时，它正确影响了 354 行。它第二次返回 0 行受影响的原因是这些行在您第一次运行查询时*已经更新。*

如果查询不会更改列值`UPDATE`，则 MySQL 不会更新行，并且不会将它们计入受影响的行中。只有那些值实际发生变化的才会被计算在内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:02:59.790

您已经加入 c.qb_salesorders_leadsqb_salesorders_idb = orders.id。因此，如果您使用“AND c.qb_salesorders_leadsqb_salesorders_idb = orders.id”来过滤您的结果，这既是不正确的语法，也是不必要的，因为这在 JOIN 子句中得到了处理。

如果要设置 AND 子句中指定的字段，则联接将仅更新那些值已经相等的行（基于您的联接）。我在这里看到的唯一更正是您只需要删除“AND”子句，因为它除了导致查询本身出错之外没有任何作用：

```
 UPDATE sugarcrm.qb_salesorders_leads_c c 
 JOIN qb_salesorders orders ON c.qb_salesorders_leadsqb_salesorders_idb = orders.id 
 SET c.qb_salesorders_leadsleads_ida = orders.memo 
```

此外，要更新多个字段，它们应该用逗号分隔（而不是 AND）：

```
UPDATE sugarcrm.qb_salesorders_leads_c c 
JOIN qb_salesorders orders ON c.qb_salesorders_leadsqb_salesorders_idb = orders.id 
 SET c.qb_salesorders_leadsleads_ida = orders.memo, c.anotherfield = "new value" 
```

# c# - 将对象列表转换为表格结构

> ID：10710044
> 
> 赞同：2
> 
> 时间：2012-05-22T20:55:52.160
> 
> 标签：c#, .net, linq, data-structures

我有一个具有此实现的对象列表：

```
 class Locations
    {
        public string Origin { get; set; }
        public string Dest { get; set; }
        public int Total { get; set; }
    } 
```

我需要以 CSV 格式输出一个表，该表将 Origins 作为行，将 Destinations 作为列，以及指定 Origins 和 Destinations 相遇的 Total。我的列表中可能有任意数量的 Location 对象。

鉴于我的列表中的以下记录：

```
Origin=A
Dest=B
Total=10

Origin=B
Dest=A
Total=20 
```

我的输出看起来像这样（带有“-”字符意味着相同的起点/终点之间没有总计）：

```
Origins/Destinations,A,B
A,-,10
B,20,- 
```

到目前为止，我已经完成了以下工作：

1）遍历列表以输出目的地。

2）遍历List输出一个Origin。对于 Origin，遍历列表以查找与 Origin 相关的每个 Destination 的 Total。

3) 对下一个 Origin 重复 #2。

我的结果不太好，因为行/列数据并不总是匹配。有没有更简单的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:03:13.187

## 更新

阅读您的更新后，似乎没有必要求和，因为只有一个具有给定`Origin`and的对象`Destination`。在这种情况下，您可以保留收集的代码`places`，进行嵌套`foreach`并简单地获取总数

```
var item = locations.FirstOrDefault(l => l.Origin == origin && l.Dest == dest);
var total = item == null ? 0 : item.Total; 
```

## 原始答案

您可以通过以下方式获取所有位置的列表

```
var locations = new List<Locations>(); // assume it's populated
var places = locations.Select(l => l.Origin)
                      .Concat(locations.Select(l => l.Dest))
                      .Distinct()
                      .OrderBy(s => s); // why not sort it as well 
```

此时，您可以简单地迭代`places`行并对列进行另一个嵌套迭代：

```
foreach (var origin in places)
{
    foreach (var dest in places)
    {
        var total = locations.Where(l => l.Origin == origin && l.Dest == dest)
                             .Sum(l => l.Total);
    }
} 
```

您可以立即看到如何轻松构建具有这种结构的表。这种方法的主要缺点是它所做的工作比绝对必要的要多得多。从理论上讲，我们当然可以只迭代一次`locations`，边走边收集信息。可以总结`Total`每一对`Origin`和`Dest`

```
var totals = locations.GroupBy(l => new { l.Origin, l.Dest })
             .ToDictionary(g => Tuple.Create(g.Key.Origin, g.Key.Dest),
                           g => g.Sum(r => r.Total)); 
```

此时我们可以从第一个解决方案中获取一个页面：

```
foreach (var origin in places)
{
    foreach (var dest in places)
    {
        var total = totals[Tuple.Create(origin, dest)]; // almost too easy :)
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:02:59.150

我不确定我是否正确理解了您的要求，但这有帮助吗？

```
var destinationGroups = locations
    .GroupBy(l=> l.Dest)
    .Select(grp => new{
        SumTotal = grp.Sum(l => l.Total),
        Destination = grp.Key ,
        CountOrigins = grp.Count()
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T21:44:50.377

您的问题似乎与二维矩阵结构（称为**O/D 矩阵**）有关，但重要的是不要限制大小。所以，我想建议你使用集合来构建矩阵结构，以允许不限制大小。我将代码片段如下所示以显示如何做。但是，此代码可能不是最佳的，但您可以得到一些亮点。

```
public class Location
{
    public string Origin { get; set; }
    public string Dest { get; set; }

    public bool Equals(Location other)
    {
        //...
    }

    public override bool Equals(object obj)
    {
        //...
    }

    public override int GetHashCode()
    {
        //...
    }
}

public class ODMatrix
{
    private readonly HashSet<string> _origins = new HashSet<string>();
    private readonly HashSet<string> _dests = new HashSet<string>();
    private readonly Dictionary<Location, int> _values = new Dictionary<Location, int>();

    public int this[Location location]
    {
        get
        {
            if (!_values.ContainsKey(location))
            {
                SetValue(location, 0);
            }
            return _values[location];
        }
        set { SetValue(location, value); }
    }

    private void SetValue(Location location, int value)
    {
        if (!_origins.Contains(location.Origin))
            _origins.Add(location.Origin);
        if (!_dests.Contains(location.Dest))
            _dests.Add(location.Dest);
        _values[location] = value;
    }

    public int this[string origin, string dest]
    {
        get { return this[new Location {Origin = origin, Dest = dest}]; }
        set { this[new Location {Origin = origin, Dest = dest}] = value; }
    }

    public override string ToString()
    {
        var content = new StringBuilder();
        //print dest lables
        content.AppendLine(_dests.Aggregate((x, y) => x + ", " + y));
        foreach (string origin in _origins)
        {
            //print origin lable
            content.Append(origin + ", ");
            foreach (string dest in _dests)
            {
                content.Append(this[origin, dest] + ", ");
            }
            content.Remove(content.Length - 2, 2);
            content.AppendLine();
        }
        return content.ToString();
    }
} 
```

哦，从您更新的问题中，我检查出您要打印原产地和目的地的标签。我认为您可以修改 ToString 方法以显示内容。

**[更新]** 我更新了打印标签的代码。此代码未经测试，因此可能会或可能不会有问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T21:27:00.500

```
// Group locations by origin
var table = 
    from location in list
    group location by location.Origin into originGroups
    select new {
        Origin = originGroups.Key
        Destinations = originGroups.ToDictionary(x => x.Dest)
    };

// Get list of destinations
var destinations = list.Select(location => location.Dest).Distinct();

// Output everything
foreach(var location in table)
    foreach(var dest in destinations)
        // output location.Destinations[dest].Total; 
```

# twisted - 扭曲的http服务器错误

> ID：10710047
> 
> 赞同：2
> 
> 时间：2012-05-22T20:55:59.043
> 
> 标签：twisted, twisted.web

我正在使用 python twisted 模块来拦截标头。我有以下脚本：

```
from twisted.web import proxy, http
from twisted.internet import reactor

g_port = 8080 #port for listening
g_request = () # action, params, method

class akaProxy(proxy.Proxy):

    def dataReceived(self, data):

        action = None
        params = None
        method = None
        global g_request

        headers = data.split("\n")
        request = headers[0].split(" ")
        params = headers[len(headers)-1]

        method = request[0].lower()
        action = request[1].lower()

        print method, action

        return proxy.Proxy.dataReceived(self, data)

class ProxyFactory(http.HTTPFactory):
    protocol = akaProxy

factory = ProxyFactory()
reactor.listenTCP(g_port, factory)
reactor.run() 
```

当我使用 web 浏览器的 localproxy 运行它时（[这个 URL](http://sapar.mammedow.com/contact/)）给我这个错误：

```
Unhandled Error
Traceback (most recent call last):
  File "test2.py", line 33, in <module>
    reactor.run()
  File "/usr/lib/python2.7/dist-packages/twisted/internet/base.py", line 1169, in run
    self.mainLoop()
  File "/usr/lib/python2.7/dist-packages/twisted/internet/base.py", line 1181, in mainLoop
    self.doIteration(t)
  File "/usr/lib/python2.7/dist-packages/twisted/internet/pollreactor.py", line 167, in doPoll
    log.callWithLogger(selectable, _drdw, selectable, fd, event)
--- <exception caught here> ---
  File "/usr/lib/python2.7/dist-packages/twisted/python/log.py", line 84, in callWithLogger
    return callWithContext({"system": lp}, func, *args, **kw)
  File "/usr/lib/python2.7/dist-packages/twisted/python/log.py", line 69, in callWithContext
    return context.call({ILogContext: newCtx}, func, *args, **kw)
  File "/usr/lib/python2.7/dist-packages/twisted/python/context.py", line 118, in callWithContext
    return self.currentContext().callWithContext(ctx, func, *args, **kw)
  File "/usr/lib/python2.7/dist-packages/twisted/python/context.py", line 81, in callWithContext
    return func(*args,**kw)
  File "/usr/lib/python2.7/dist-packages/twisted/internet/posixbase.py", line 599, in _doReadOrWrite
    self._disconnectSelectable(selectable, why, inRead)
  File "/usr/lib/python2.7/dist-packages/twisted/internet/posixbase.py", line 260, in _disconnectSelectable
    selectable.readConnectionLost(f)
  File "/usr/lib/python2.7/dist-packages/twisted/internet/tcp.py", line 257, in readConnectionLost
    self.connectionLost(reason)
  File "/usr/lib/python2.7/dist-packages/twisted/internet/tcp.py", line 433, in connectionLost
    Connection.connectionLost(self, reason)
  File "/usr/lib/python2.7/dist-packages/twisted/internet/tcp.py", line 277, in connectionLost
    protocol.connectionLost(reason)
  File "/usr/lib/python2.7/dist-packages/twisted/web/http.py", line 455, in connectionLost
    self.handleResponseEnd()
  File "/usr/lib/python2.7/dist-packages/twisted/web/proxy.py", line 88, in handleResponseEnd
    self.father.finish()
  File "/usr/lib/python2.7/dist-packages/twisted/web/http.py", line 866, in finish
    "Request.finish called on a request after its connection was lost; "
exceptions.RuntimeError: Request.finish called on a request after its connection was lost; use Request.notifyFinish to keep track of this. 
```

但它继续工作，谁能解释这个错误，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T16:25:51.327

这条消息出现在它所描述的情况下：您有一些处理 http 请求的代码，并且请求的`finish`方法没有被调用（无论出于何种原因），直到 http 连接丢失之后（这意味着现在无法发送结果给请求者）。

你可能不关心这种情况的发生。如果你不这样做，那么你应该在你的代码中做一些事情来防止`Request.finish`当你的请求`_disconnected`属性为真时调用该方法。那，或者只是忽略错误。

# .htaccess - 如何设置主页以防文件丢失（404错误页面）

> ID：10710052
> 
> 赞同：-3
> 
> 时间：2012-05-22T20:56:34.050
> 
> 标签：.htaccess

我想显示主页以防文件丢失而不是找不到文件（404 错误页面）。请让我知道如何使用 htaccess 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:00:41.723

ErrorDocument 404 www.yourdomain.com

或 /index.html（或您网站的主页）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T20:59:47.467

在您的 htaccess 文件中插入

错误文档 404 /errors/badrequest.html

将 /errors/badrequest.html 指向您的主页。

# xml - optional use of xsl stylesheet

> ID：10710059
> 
> 赞同：4
> 
> 时间：2012-05-22T20:57:21.897
> 
> 标签：xml, xslt, xhtml

I have xml files which make use of an XSL stylesheet to format it when view in a web browser. I save the xml files in a central location, a shared drive which any of my colleagues can access. If they open an XML file directly from the shared location, it renders correctly, however sometimes they take a copy of the XML, and only the XML file that they need. when they view the file in a browser it fails to locate the XSL stylesheet and hence doesn't render. Is there a way to say if the xsl stylesheet is available, make use of it, if not then simply ignore using the stylesheet and display the xml file as if there were not stylesheet. Basically this would mean no error would be seen when a local copy is taken. Can this be done

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T07:14:27.943

您可能依赖于`<?xml-stylesheet?>`处理指令。如果找不到样式表，我不知道有什么方法可以参数化它的行为方式：我敢说它无论如何都取决于浏览器。

为什么不使用可以从网络上任何地方获取样式表的绝对 URI？您可能会遇到跨站点脚本问题，但值得一试。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-23T00:10:41.883

我怀疑没有简洁的方法可以做到这一点。您可以像这样在导入时使用 use-when 属性...

```
 <xsl:import
   xmlns:fn="http://www.w3.org/2005/xpath-functions"
   href="'general.xslt'"
   use-when="fn:unparsed-text-available( 'general.xslt') /> 
```

上述元素将导入样式表“general.xslt”（如果存在）。该解决方案的问题/限制在于，对于 @href 属性，XSLT 知道从您的 xslt 配置（OASIS 目录、命令行参数、环境变量 - 随便什么。它是特定于供应商的）中在哪里可以找到 general.xslt。但是，相同的位置查找逻辑不适用于 unparsed-text-available()，它采用 URI 参数。

所以你可能想像这样参数化上面的元素......

```
 <xsl:import
   xmlns:fn="http://www.w3.org/2005/xpath-functions"
   href="$stylesheet-to-import"
   use-when="fn:unparsed-text-available( $uri-of-stylesheet-to-import) /> 
```

假设如下：

1.  $stylesheet-to-import 是要导入的样式表的参数/变量。如果它可以被 XSLT 引擎定位，它可以是短格式，否则它应该与 $uri-of-stylesheet-to-import 相同
2.  $uri-of-stylesheet-to-import 是要导入的样式表的 uri（如果存在）。
3.  如果 $uri-of-stylesheet-to-import 指向的文件存在，那么它是一个有效的 xslt 文件。

我认为这个解决方案只适用于 XSLT 2.0。我不确定 XSLT 1.0。

另请阅读 Dimitre 对这个类似问题的回答：[如何使用 XSL 检查是否存在外部文件？](https://stackoverflow.com/questions/2917655/how-do-i-check-for-the-existence-of-an-external-file-with-xsl).

注意：作为 fn:unparsed-text-available() 的替代方法，您还可以使用 fn:doc-available()。它会更慢，因为它会检查文档是否是有效的 XML，这可能是也可能不是一件好事，具体取决于您的问题。

# c++ - std::make_pair error with boost::bind in VS2010

> ID：10710062
> 
> 赞同：0
> 
> 时间：2012-05-22T20:57:39.180
> 
> 标签：c++, visual-c++, boost, visual-c++-2010, boost-bind

I was wondering if someone could help me with this issue. I have been reading that the are some problems with the use of the std::make_pair in VS2010 because it is overloaded, and I have found some workarounds that would work, however, I just can not find a way to make it work here for me.

Here is a part of the code so you can take a look:

```
namespace tree {
    #define container std::vector
    typedef container<IConnType const*> node_data;

///tree node's brief
    struct tree_node
    {
        STD_STRING  name;
        node_data   types;
    };

    struct branch;
    typedef container<branch>           sub_tree;

///branch's brief
    struct branch
    {
        tree_node   node;
        sub_tree    tree;
    };
}

template<typename T>
///address of's brief
struct address_of
{
    T* operator()(T& x) const
    {
        return &x;
    }

    T const* operator()(T const& x) const
    {
        return &x;
    }
};

typedef std::pair<tree::branch*,HTREEITEM> step_info;
std::vector<step_info> steps;

/// after we fill steps ///

HTREEITEM new_item = m_conntree.InsertItem(&tvi); // m_conntree is a CTreeCtrl; tvi is a TVINSERTSTRUCT

std::transform(step.first->tree.begin()
    , step.first->tree.end()
    , std::back_inserter(steps)
    , boost::bind(&std::make_pair<tree::branch*,HTREEITEM>
        , boost::bind<tree::branch*>(address_of<tree::branch>()
            , _1
        )
    , new_item
    )
); 
```

The problem is here (the rest of the code is just to give an idea):

```
std::transform(step.first->tree.begin()
    , step.first->tree.end()
    , std::back_inserter(steps)
    , boost::bind(&std::make_pair<tree::branch*,HTREEITEM>
        , boost::bind<tree::branch*>(address_of<tree::branch>()
            , _1
        )
    , new_item
    )
); 
```

I tried to do a cast (as I had read in other thread) but it did not work... this is what I had tried:

```
typedef std::pair<tree::branch*,HTREEITEM> (*MakePairType)(tree::branch*,HTREEITEM);

std::transform(step.first->tree.begin()
    , step.first->tree.end()
    , std::back_inserter(steps)
    , boost::bind((MakePairType)&std::make_pair<tree::branch*,HTREEITEM>
        , boost::bind<tree::branch*>(address_of<tree::branch>()
            , _1
        )
    , new_item
    )
); 
```

I hope anyone can help me with this one... I have been stuck for a long time trying to compile this project...

By the way, it throws me a lot of error in the boost::bind (more than a hundred)... and taking out the boost::bind, it gives me errors about not knowing which overload of std::make_pair to use,

Regards, and thanks in advance!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T22:38:06.263

Dave S 是对的：这里使用 lambda 或仿函数会好得多。您遇到的问题`make_pair`可能是由于[C++11 的重大变化](https://stackoverflow.com/questions/9641960/c11-make-pair-with-specified-template-parameters-doesnt-compile)。 `make_pair`现在有 type`T&&`和的参数`U&&`，以实现对类型的完美转发。

你这样使用`make_pair`：

```
std::make_pair<tree::branch*,HTREEITEM> 
```

因为您已明确命名模板类型参数，所以参数类型选择为`tree::branch*&&`和`HTREEITEM&&`。此函数不能接受左值参数。

简而言之：不要尝试使用`make_pair`或其他带有显式模板参数列表的完美转发函数；它们并非设计为以这种方式使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T22:11:10.100

首先，我会注意常量，因为您正在获取引用的地址，但希望这对是指向非常量树::分支的指针。

如果您有 lambda，我会执行以下操作。

```
std::transform(step.first->tree.begin()
    , step.first->tree.end()
    , std::back_inserter(steps)
    [&](tree::branch& branch) { return std::make_pair(&branch, new_item); }
); 
```

如果您没有 lambda 支持，那么至少在短期内尝试自己编写仿函数可能会更清楚，以获得更清晰的错误。 `boost::bind`很强大，但是当它失败时，错误消息有时会隐藏一些基本的东西。

```
struct make_step_info
{ 
   HTREEITEM new_item;

   make_step_info(HTREEITEM new_item): new_item(new_item)  {};

   std::pair<tree::branch*,HTREEITEM> operator()(tree::branch& branch) const
   {
      return std::make_pair(&branch, new_item);
   }
}

/* And use it here */
std::transform(step.first->tree.begin()
     , step.first->tree.end()
     , std::ba_ck_inserter(steps)
     make_step_info(new_item)
); 
```

# graph - Neo4j：根据关系从下到上搜索节点

> ID：10710063
> 
> 赞同：1
> 
> 时间：2012-05-22T20:57:40.103
> 
> 标签：graph, neo4j, cypher

我正在尝试编写一个密码查询，允许我从下到上搜索节点。例如：我有一个小型联属网络，其中乔指的是玛丽、马克和鲍勃。玛丽、马克和鲍勃各有 10 个孩子。还有他们的孩子，每人10个。我想从最底层的 Joe 开始搜索这个网络，这意味着 Mary、Mark 或 Bob 的孩子的孩子。

关于如何实现这一目标的任何想法？获取所有底部节点然后重新启动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T08:44:23.277

Pablo Pareja 贡献了一个 LowestCommonAncestor Algo，参见[https://github.com/neo4j/community/commit/8919b28dfe523e843935a4bf70381498fd25875b](https://github.com/neo4j/community/commit/8919b28dfe523e843935a4bf70381498fd25875b)。那是你要的吗？

否则，如果您想查找网络中的所有离开节点，您可以使用 Cypher 执行此操作，例如[http://tinyurl.com/c6kmcew](http://tinyurl.com/c6kmcew)（示例）：

```
start joe=node(1) match p=joe-[:refers]-referredPerson-[:parent_of*1..]->kid return kid, p 
```

高温高压

/彼得

# java - OS-X 上的 VTK Java，可可异常

> ID：10710064
> 
> 赞同：1
> 
> 时间：2012-05-22T20:57:40.397
> 
> 标签：java, macos, cocoa, vtk

我安装了 VTK 工具包，并在 Eclipse 中使用了 VTK 的 Java 包装器。我将 vtk.jar 添加到我的 java 项目中，并将环境变量设置为指向我的 VTK 安装。基本上，它正在工作。找到 vtk 类等并启动程序，至少直到我到达显示窗口的地步。

例如以下示例程序： [http ://www.vtk.org/Wiki/VTK/Examples/Java/Imaging/ImageTest](http://www.vtk.org/Wiki/VTK/Examples/Java/Imaging/ImageTest)

如果我运行它，OS-X（或 Cocoa）会抛出以下异常，说明 UndoManager 存在一些问题：

我不知道我做错了什么或者是什么导致了这个问题，有人有什么想法吗？

```
2012-05-22 22:48:09.093 java[925:1a03] *** Assertion failure in +[NSUndoManager _endTopLevelGroupings], /SourceCache/Foundation/Foundation-833.25/Misc.subproj/NSUndoManager.m:324
2012-05-22 22:48:09.093 java[925:1a03] +[NSUndoManager(NSInternal) _endTopLevelGroupings] is only safe to invoke on the main thread.
2012-05-22 22:48:09.096 java[925:1a03] (
    0   CoreFoundation                      0x00007fff9363cf56 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff8aa9fd5e objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff9363cd8a +[NSException raise:format:arguments:] + 106
    3   Foundation                          0x00007fff910a371f -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 169
    4   Foundation                          0x00007fff9101295f +[NSUndoManager(NSPrivate) _endTopLevelGroupings] + 144
    5   AppKit                              0x00000001025680ef -[NSApplication run] + 596
    6   libvtkRendering.5.10.dylib          0x000000010ff8c2df -[vtkCocoaServer start] + 335
    7   libvtkRendering.5.10.dylib          0x000000010ff8cf87 _ZN30vtkCocoaRenderWindowInteractor5StartEv + 293
    8   libvtkRenderingJava.5.10.0.dylib    0x000000010f94f29e Java_vtk_vtkRenderWindowInteractor_Start_15 + 62
    9   ???                                 0x0000000103b70d6e 0x0 + 4357295470
    10  ???                                 0x0000000103b6585a 0x0 + 4357249114
)
2012-05-22 22:48:09.096 java[925:1a03] *** Assertion failure in +[NSUndoManager _endTopLevelGroupings], /SourceCache/Foundation/Foundation-833.25/Misc.subproj/NSUndoManager.m:324
2012-05-22 22:48:09.096 java[925:1a03] An uncaught exception was raised
2012-05-22 22:48:09.097 java[925:1a03] +[NSUndoManager(NSInternal) _endTopLevelGroupings] is only safe to invoke on the main thread.
2012-05-22 22:48:09.098 java[925:1a03] (
    0   CoreFoundation                      0x00007fff9363cf56 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff8aa9fd5e objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff9363cd8a +[NSException raise:format:arguments:] + 106
    3   Foundation                          0x00007fff910a371f -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 169
    4   Foundation                          0x00007fff9101295f +[NSUndoManager(NSPrivate) _endTopLevelGroupings] + 144
    5   AppKit                              0x000000010256819c -[NSApplication run] + 769
    6   libvtkRendering.5.10.dylib          0x000000010ff8c2df -[vtkCocoaServer start] + 335
    7   libvtkRendering.5.10.dylib          0x000000010ff8cf87 _ZN30vtkCocoaRenderWindowInteractor5StartEv + 293
    8   libvtkRenderingJava.5.10.0.dylib    0x000000010f94f29e Java_vtk_vtkRenderWindowInteractor_Start_15 + 62
    9   ???                                 0x0000000103b70d6e 0x0 + 4357295470
    10  ???                                 0x0000000103b6585a 0x0 + 4357249114
)
2012-05-22 22:48:09.098 java[925:1a03] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: '+[NSUndoManager(NSInternal) _endTopLevelGroupings] is only safe to invoke on the main thread.'
*** First throw call stack:
(
    0   CoreFoundation                      0x00007fff9363cf56 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff8aa9fd5e objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff9363cd8a +[NSException raise:format:arguments:] + 106
    3   Foundation                          0x00007fff910a371f -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 169
    4   Foundation                          0x00007fff9101295f +[NSUndoManager(NSPrivate) _endTopLevelGroupings] + 144
    5   AppKit                              0x000000010256819c -[NSApplication run] + 769
    6   libvtkRendering.5.10.dylib          0x000000010ff8c2df -[vtkCocoaServer start] + 335
    7   libvtkRendering.5.10.dylib          0x000000010ff8cf87 _ZN30vtkCocoaRenderWindowInteractor5StartEv + 293
    8   libvtkRenderingJava.5.10.0.dylib    0x000000010f94f29e Java_vtk_vtkRenderWindowInteractor_Start_15 + 62
    9   ???                                 0x0000000103b70d6e 0x0 + 4357295470
    10  ???                                 0x0000000103b6585a 0x0 + 4357249114
)
terminate called throwing an exception 
```

建议的 VM 参数导致此错误：

```
2012-05-23 09:10:18.635 java[747:307] [Java CocoaComponent compatibility mode]: Enabled
2012-05-23 09:10:18.635 java[747:307] [Java CocoaComponent compatibility mode]: Setting timeout for SWT to 0.100000
2012-05-23 09:10:18.985 java[747:d303] *** -[NSConditionLock unlock]: lock (<NSConditionLock: 0x7fa108c64600> '(null)') unlocked when not locked
2012-05-23 09:10:18.985 java[747:d303] *** Break on _NSLockError() to debug. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:04:10.710

This could be a problem related to the Cocoa restriction that some things can be run only on the first thread that the process runs. The same issue arises with the SWT event loop, for example. The problem is that `main` method is not executed on the first thread because it is reserved for AWT's event loop -- for the same reason. The workaround: use the JVM switch `-XstartOnFirstThread`.

# asp.net - Debugging a WCF service activation in an ASP.Net application

> ID：10710065
> 
> 赞同：2
> 
> 时间：2012-05-22T20:57:47.310
> 
> 标签：asp.net, wcf, debugging, svc

I have a WCF service running in an ASP.Net application. The svc file internals looks like this:

```
<%@ ServiceHost Language="C#" Debug="true" Service="my.api.Awesomeapi" Factory="my.api.AwesomeHostFactory" %> 
```

The factory code-behind also lives in the ASP.Net application and is as follows:

```
namespace my.api
{
    /// <summary>
    /// Custom Service Factory class for Awesome Web Service
    /// </summary>
    public class AwesomeHostFactory : ServiceHostFactory
    {
        private const string CONST_DEFAULT_ADDRESS = "http://localhost/api/Awesomeapi.svc";
        private static readonly string m_sBaseAddress = my.Utilities.GetAppConfigSetting("AwesomeAPIBaseAddress", CONST_DEFAULT_ADDRESS, true);

    protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
    {
        ServiceHost AwesomeAPIServiceHost = null;
        Uri oURI = new Uri(m_sBaseAddress);           
        AwesomeAPIServiceHost = new ServiceHost(serviceType, oURI);          
        return AwesomeAPIServiceHost;
    }

}
} 
```

The service works fine, however when I attach to the w3wp.exe process in Visual Studio 2010 and set a breakpoint in the CreateServiceHost method and go to the localhost URL listed above for the first time, my breakpoint circle turns hollow (indicating unreachable code) then the service runs and displays the generic "You have created a service" message, and then the breakpoint reverts to its normal red icon. Would anyone know what's happening here?

# ruby-on-rails - 在 Rails 中，如何在表单中检索嵌套对象标题

> ID：10710066
> 
> 赞同：0
> 
> 时间：2012-05-22T20:57:50.227
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

在 Rails 中，我使用`rails3-jquery-autocomplete`gem 自动完成`photos#edit`表单上的用户名所有者。我目前有这个代码

```
= f.autocomplete_field :user_id, autocomplete_user_username_photos_path 
```

哪个自动完成很好，但默认值是`2`（这是当前的 user_id），当我尝试保存对象时，它会尝试发送用户名而不是该用户名的 id。

是否有一种简单的方法可以在字段中显示用户名而不是 id，因为关系已经完成并在保存时转换为 id？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:02:48.460

据我所知，您无法显示某些内容并使用*rails3-jquery-autocomplete发送其他信息。*我最后一次尝试时，我最终做了自己的 ajax 自动完成。

但是，您可以保持原样，只需在保存照片之前通过用户名获取用户。这将花费您一个额外的数据库请求，但它可以解决问题。

在您的控制器中：

```
@photo.user = User.where(:username => params[:username]).first # not sure if you need .first here
@photo.save 
```

# javascript - 加载带有很长 url 参数的 iframe

> ID：10710070
> 
> 赞同：0
> 
> 时间：2012-05-22T20:57:59.573
> 
> 标签：javascript, jquery, post, iframe, get

我有 javascript 创建和加载 iframe。问题是 url - 包含用于构造 iframe 内容的动态参数列表 - 太长而无法包含在 iframe src 中（使用 GET 方法）。有没有办法用 POST 或其他可以处理大参数列表的方法加载 iframe 的内容？

我尝试使用 javascript 自动提交针对 iframe src 的表单，其中预加载了参数列表 - 但是这种方法似乎刷新了页面（我宁愿没有）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:00:00.647

您可以将此信息保存为表中的临时行，并通过单个 $_GET 简单地引用 id。

如果这看起来太复杂，只需拥有一个`<form target="iframe_id"`并拥有 jQuery`$.submit()`那个表单。请参阅有关此的[先前答案](https://stackoverflow.com/questions/168455/how-do-you-post-to-an-iframe?answertab=votes#tab-top)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T20:59:49.353

也许您可以进行 JQuery 修改，然后专门为该 iFrame 调用 doPostBack()？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:32:22.193

尝试将整个 URL 包装到一个变量中。然后只需将变量放在您设置请求的位置。我想它应该工作。

# java - Java irc 机器人乒乓球

> ID：10710071
> 
> 赞同：-1
> 
> 时间：2012-05-22T20:58:04.220
> 
> 标签：java, bots, irc

```
if (serverResponse.contains("PING ")) {
    writer.write("PONG " + serverResponse.substring(5) + "\r\n");
    writer.write("PRIVMSG " + c.getHomechannel() + " :I got pinged!\r\n");
    System.out.println("pinged");
    writer.flush( );
} 
```

和

```
if (cmd.equalsIgnoreCase("PING")) {
    TCPRequestManager.sendWrite("PONG " + param);
    TCPRequestManager.doMsg("c.getHomechannel()", ":I got pinged!");
    TCPConnectionManager.getWriter().flush( );
} 
```

两者似乎都在工作并向我发送消息说客户已被 ping，但我认为由于断开连接，它实际上并没有返回乒乓球，我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T23:42:30.183

PONG 消息不应该[包含目的地](https://www.rfc-editor.org/rfc/rfc2812#section-3.7.3)吗？我猜`serverResponse.substring(5)`第一个代码块中的服务器名称是*ping*您的服务器的服务器名称。它期待*从*您的服务器*到*irc 服务器的 PONG。

通常，事务看起来像这样，**a.com**是 irc 服务器的主机名，**b.com**是连接到它的机器人的主机名：

```
PING :a.com          (sent from a.com to b.com)
PONG b.com :a.com    (sent from b.com to a.com) 
```

看起来您要发送的内容（鉴于前面的示例）是：

```
PING :a.com          (sent from a.com to b.com)
PONG :a.com          (sent from b.com to a.com, except there's no origin) 
```

# git - Git 列出 Blob 提交

> ID：10710072
> 
> 赞同：5
> 
> 时间：2012-05-22T20:58:25.250
> 
> 标签：git

假设我有一个 blob 的 SHA。我可以去 git show 看看 blob 的内容。是否可以获得包含该 blob 的所有提交的列表？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-22T21:53:34.157

以下 scriptlet 应该可以解决问题：

```
#!/bin/sh

blob=deadbeefdeadbeefdeadbeefdeadbeef

git rev-list --all |
while read commit; do
    if git ls-tree -r $commit | grep -q $blob; then
        echo $commit
    fi
done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-17T13:57:49.287

也许有点晚了，但`git show <abbrev-sha1>`会显示该 blob 的内容等。同样`git cat-file blob <abbrev-sha1>`，使用`git cat-file -t <abbrev-sha1>`它来检查它是一个 blob。

获取包含它的第一个（或最后一个）提交似乎并不容易（例如从补丁的差异`index`行确定该补丁的来源）

# android-layout - Spinner item small text invisible on some devices

> ID：10710074
> 
> 赞同：1
> 
> 时间：2012-05-22T20:58:35.563
> 
> 标签：android-layout, android-listview, android-spinner, android

I want to change the spinner item layout. The layout will have two TextViews. One with small size text, and the other with medium size text. The layout below is what I am using:

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:minHeight="40dp"
    android:layout_height="wrap_content"
    android:orientation="horizontal">

    <TextView
        android:id="@+id/test1"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:textAppearance="?android:attr/textAppearanceSmall"
        android:paddingLeft="5dp"
        android:gravity="center_vertical"
        android:text="foo" />

    <TextView
        android:id="@+id/test2"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:paddingLeft="5dp"
        android:gravity="center_vertical"
        android:text="bar" />

</LinearLayout> 
```

This works great on my A500 tab with Ice Cream Sandwich installed. The spinner has a black background and the text has white text. However, if I use the exact same layout on a HTC Desire HD running 2.3.3, then the spinner background have changed to white. It is impossible to see the text, since this is also white.

Instead I could use `textAppearance{Small,Medium}Inverse` but then the situation will just be reversed. The text will be visible on HTC Desire but not on A500.

The question [changing spinner text color based on background color](https://stackoverflow.com/questions/8671413/changing-spinner-text-color-based-on-background-color) seems to have found a solution, but as far as I can tell, `textColorPrimary` is included in `textAppearance{Small,Medium}`.

I would like to use the same layout no matter what device or android version for maintainability reasons. What should I do?

Also, it would be great if I could use the exact same layout for ListView items, again for maintainability reasons.

# hive - Hive column as a subquery select

> ID：10710075
> 
> 赞同：1
> 
> 时间：2012-05-22T20:58:41.520
> 
> 标签：hive

I'm trying to do something like below with Hive. How can I have a column in Hive be defined as a subquery? Is this possible in Hive?

```
hive -e "           
select
distinct i.SearchListingID,
(select count(*) 
    from calls c 
    where c.ServiceID = i.SearchListingID
    ) as CallsCount
from Impressions i
where i.yyyymmdd = 20120401
limit 10" > ImpressionCalls.txt

Hive history file=/tmp/jd/hive_job_log_jd_201205222049_550931420.txt 
```

> FAILED: Parse Error: line 4:1 cannot recognize input near 'select' 'count' '(' in expression specification

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T03:37:46.900

Hive 不支持相关子查询。像这样的东西怎么样？（我自己没有机会在 Hive 上验证此查询）

```
select
    i.SearchListingID,
    count(*)
from
    (
    select
         distinct i.SearchListingID as SearchListingID 
    from 
        Impressions i
    where
        i.yyyymmdd = 20120401
    )i
    join
    calls c
    on(c.ServiceID = i.SearchListingID)
limit 10 
```

# asp.net - ASP.NET - Difficulty Modifying Http Headers

> ID：10710076
> 
> 赞同：1
> 
> 时间：2012-05-22T20:58:41.850
> 
> 标签：asp.net, asp.net-mvc, http-headers, httpresponse

I have been working in ASP.NET MVC for a while now, but one thing that has confused me about it is the difficulty involved in modifying HTTP Headers. It is simple enough to *add* headers (`Response.AppendHeader(...);`), and it is very (almost *too*) simple to *remove all* headers (`Response.ClearHeaders();`). But when it comes to modifying and deleting *individual* headers, there's trouble.

What is the technical reason behind the http headers collection being more than (essentially) a simple `Dictionary<string, string>` that gets written to the response stream? Why is it so easy to remove all, but impossible to remove an individual?

**Note** - I am not only concerned with running it on the server (using IIS 7, integrated pipeline mode), but also in development (using Cassini).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:16:10.063

对于 .Net Framwork 3.0、IIS 7.0/集成模式：

如您所见，

```
Response 
```

对象有

```
Headers 
```

键入为 NameValueCollection 的属性（我不确定为什么选择了这种类型） [http://msdn.microsoft.com/en-us/library/system.web.httpresponse.headers](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.headers)

因此，理论上，您可以使用它在问题中概述的响应中添加或删除标题。

正如我从 Response.AddHeader 源代码中看到的（我使用了 Reflector），几乎没有额外的检查。例如，如果您在调用“Flush”方法后尝试添加处理程序，该方法将引发异常（如果您考虑一下，这是一个正确的行为）。我不确定为什么微软人员公开了 Headers 属性，以及它背后的想法是什么。我认为它至少应该受到保护，因为幕后还有其他逻辑，并且在某些情况下，该过程不限于简单的数组项插入。

# c# - 当项目相等时从可枚举源中删除单个项目

> ID：10710081
> 
> 赞同：4
> 
> 时间：2012-05-22T20:59:07.370
> 
> 标签：c#, linq, ienumerable

假设我有一个可枚举的来源，如下所示：

```
IEnumerable<string> source = new [] { "first", "first", "first", "second" }; 
```

我希望能够构造一个 LINQ 语句来返回：

```
"first", "first", "second" 
```

注意只有一个第一个已经消失了。我不在乎哪一个，因为在我的情况下，所有 3 个“第一”都被认为是相等的。我已经尝试过`source.Except(new [] { "first" })`，但这会删除所有实例。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-22T21:09:41.627

```
source
  .GroupBy(s => s)
  .SelectMany(g => g.Skip(1).DefaultIfEmpty(g.First())) 
```

对于每个组，跳过该组的第一个元素并返回其余元素 - 除非这将返回无……在这种情况下，返回该组的第一个元素。

* * *

```
source
  .GroupBy(s => s)
  .SelectMany(g => g.Take(1).Concat(g.Skip(2))) 
```

对于每个组，取第一个元素，然后从第三个元素开始 - 总是跳过第二个元素。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-15T20:08:18.753

我认为 Amy B 的答案让你非常接近，但在只有一个值的情况下它不会删除该值，这就是我认为原始发帖人正在寻找的。

这是一个扩展方法，它将删除所请求项目的单个实例，即使那是最后一个实例。这反映了 LINQ except() 调用，但仅删除第一个实例，而不是所有实例。

```
 public static IEnumerable<T> ExceptSingle<T>(this IEnumerable<T> source, T valueToRemove)
    {
        return source
            .GroupBy(s => s)
            .SelectMany(g => g.Key.Equals(valueToRemove) ? g.Skip(1) : g);
    } 
```

给定：`{"one", "two", "three", "three", "three"}`
调用`source.ExceptSingle("three")`结果`{"one", "two", "three", "three"}`

给定：`{"one", "two", "three", "three"}`
调用`source.ExceptSingle("three")`结果`{"one", "two", "three"}`

给定：`{"one", "two", "three"}`
调用`source.ExceptSingle("three")`结果`{"one", "two"}`

给定：`{"one", "two", "three", "three"}`
调用`source.ExceptSingle("four")`结果`{"one", "two", "three", "three"}`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T12:05:11.843

我想出了一个单行 LINQ 语句来做到这一点。它需要一个单独的标志变量。我将其实现为扩展方法：

```
public static IEnumerable<T> ExceptOne<T>(this IEnumerable<T> enumerable, T element)
{
    var i = 0;

    return enumerable.Where(original => !EqualityComparer<T>.Default.Equals(original, element) || ++i > 1);
} 
```

我使用了一个 int，以防我稍后想添加一个“numberToRemove”参数（将 > 1 更改为 > numberToRemove）。YAGNI 和所有这些，但它的可读性与布尔值一样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T21:17:37.737

```
IEnumerable<string> source = new [] { "first", "first", "first", "second" };

List<string> newSource = new List<string>();

var foo = source.GroupBy (s => s).Select (s => new KeyValuePair<string,int>(s.Key, (s.Count()>1)?s.Count()-1:s.Count ()));

foreach (var element in foo)
{
    newSource.AddRange(Enumerable.Repeat(element.Key,element.Value));
} 
```

在这里非常快速的努力。基本上，这将使用每个不同的键和实例计数从原始列表创建第二个列表，如果有多个，则减去一个，然后重新渲染具有正确数量元素的列表。

不像大卫 B 的答案那么优雅，但我已经写过了，尽管我不妨将它作为另一个可能的答案发布。我确信 foreach 可以用于 Linq 语句，但是已经晚了，我的大脑无法正常工作！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T21:10:07.100

我对 LINQ 不是很熟悉，但这里是您可能想要使用的一般流程：

将所有唯一项目存储在新列表 B 中，即：

```
A: {1, 1, 1, 2, 4, 4, 6} 
```

变成

```
B: {1, 2, 4, 6} 
```

遍历 B，如果存在，则在 A 中删除它的实例，即：

```
A: {1, 1, 1, 2, 4, 4, 6} 
```

变成

```
F: {1, 1, 2, 4, 6} 
```

希望这可以帮助！

# iphone - iphone - expandible center button in tabbar

> ID：10710082
> 
> 赞同：0
> 
> 时间：2012-05-22T20:59:07.730
> 
> 标签：iphone, objective-c, ios, user-interface

How does one go about implementing this? i've figured out how to implement the custom center button but not the part where you click the button and it gets expanded with more options.

![First image, custom centered button](../Images/e47e848f871d05cbcfc96638a5d1a439.png)

* * *

![Custom centered button expanded](../Images/43e7f007ab6971518b6cd8fcda61acda.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:17:23.603

这里似乎有两种观点。

第**一个**是“标签栏”

第二**个**是居中的圆形按钮

第二个视图添加在第一个视图之上，实际上比屏幕大。

现在，当用户单击箭头时，可能会执行动画以显示整个视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:05:53.793

> 如何实现这一点？

这是一个自定义视图。底部栏可能没有标签栏，甚至可能没有工具栏——它也可能是自定义视图。当您点击中心视图时，它会展开以显示其他内容。

# c - 用 C 语言在 linux 上进行串行编程

> ID：10710083
> 
> 赞同：0
> 
> 时间：2012-05-22T20:59:12.673
> 
> 标签：c, linux, io, serial-port

我想在我的串口上发送某个字符串并将答案读入缓冲区以进行进一步分析。我想出了一些代码，但即使 shell 上的 screen **/dev/ttyUSB0 19200**对我来说也很好，我也无法阅读任何答案。decive 需要 8 个数据位、1 个起始位、1 个停止位，并且没有奇偶校验。19200 波特。现在我的代码看起来像这样，它一直在计时::(

```
/////////////////////////////////////////////////
// Serial port interface program               //
/////////////////////////////////////////////////
#include <stdio.h> // standard input / output functions
#include <string.h> // string function definitions
#include <unistd.h> // UNIX standard function definitions
#include <fcntl.h> // File control definitions
#include <errno.h> // Error number definitions
#include <termios.h> // POSIX terminal control definitionss
#include <time.h>   // time calls

int open_port(void)
{
int fd; // file description for the serial port

fd = open("/dev/ttyUSB0", O_RDWR | O_NOCTTY | O_NDELAY);

if(fd == -1) // if open is unsucessful
{
perror("open_port: Unable to open /dev/ttyUSB0");
}
else
{
fcntl(fd, F_SETFL, 0);
}

return(fd);
}

int configure_port(int fd)      // configure the port
{
struct termios port_settings;      // structure to store the port settings in

cfsetispeed(&port_settings, B19200);    // set baud rates
cfsetospeed(&port_settings, B19200);

port_settings.c_cflag &= ~PARENB;    // set no parity, stop bits, data bits
port_settings.c_cflag &= ~CSTOPB;
port_settings.c_cflag &= ~CSIZE;
port_settings.c_cflag |= CS8;

cfmakeraw(&port_settings);
tcsetattr(fd, TCSANOW, &port_settings);    // apply the settings to the port
return(fd);

}

int query_modem(int fd)   // query modem with an AT command
{
int n;
fd_set rdfs;
struct timeval timeout;
ssize_t retval;
char bufptr[100];
char chr;
int cnt = 0;
int i = 0;

// initialise the timeout structure
timeout.tv_sec = 2; // ten second timeout
timeout.tv_usec = 0;

if (FD_ISSET(fd, &rdfs)){
  FD_ZERO(&rdfs);
  FD_CLR(fd,&rdfs);
}

retval = write(fd, "TEST\r", 5);  // send an AT command followed by a CR
/*usleep(50);
while (read(fd, &chr, 1))
{
printf("0x%x\n",chr);
usleep(10);
}*/

// do the select
n = select(fd + 1, &rdfs, NULL, NULL, &timeout);

// check if an error has occured
if(n < 0)
{
perror("select failed\n");
}
else if (n == 0)
{
printf("Timeout\n");
}
else
{
printf("\nBytes detected on the port!\n");
}

}

int main(void)
{
int fd = open_port();
configure_port(fd);
query_modem(fd);
return(0);
} 
```

我期望返回的是一个字符串，上面写着“TEST”，与我按 Enter 键时屏幕中的相同。任何帮助，将不胜感激！非常感谢你！

罗恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:12:06.820

我的建议是您没有将 fd 添加到 rfds。检查 FD_* 宏以清除集合，添加 fd 并检查 fd 是否有输入。

**更新**

您确实需要将 fd 添加到 fdset：

```
write(...
FD_ZERO(&rdfs);
FD_SET(fd, &rfds);
n = select(...
if (n > 0) {
    if (FD_ISSET(fd, &rfds)) {
        // this fd has input waiting to be read 
```

当您选择多个 fd 时，n 可以变为 > 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T10:21:26.137

简单的c代码

```
char types[25];    
char buffu[256];   
int fd:

strcat(types,"speed 115200 -parenb cs8 cstopb -ixon -ixoff -crtscts clocal cread raw");   
fd=open("dev/ttyS0", O_RDWR | O_NOCTTY | O_NDELAY);   
ioctl(fd, F_SETFL, 0);   

.....

write (fd, buffu, 255);   
usleep(400);   
read (fd,buffu,255); 
```

# tomcat - 使用struts2的tomcat服务器根目录的HTML文件

> ID：10710086
> 
> 赞同：0
> 
> 时间：2012-05-22T20:59:28.760
> 
> 标签：tomcat, struts2, struts, tomcat6

我正在使用 struts 2。我想将 googleverfication.htm 文件永久放在我们网站的根目录下，以便通过 Google 网站管理员工具验证网站。

我正在使用tomcat 6服务器。

怎么能做到这一点？

我将文件保存在根目录并点击[https://myurl.com/googleverfication.htm](https://myurl.com/googleverfication.htm)但什么也没有出现。请求根本不进行。

我需要在 struts.xml 或 web.xml 中添加条目吗？

注意：我在 web.xml 中将 CAS 服务器过滤器用于 url 模式为 /*

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T21:56:35.680

如果您通过将 /* 映射到某个东西来覆盖默认 servlet，那么该 servlet 将响应对“/googleverfication.htm”的请求。如果您想允许 /real/ 默认 servlet 响应对该文件的请求，请在您的 web.xml 文件中尝试以下操作：

```
<servlet-mapping>
  <servlet-name>default</servlet-name>
  <url-pattern>/googleverfication.htm</url-pattern>
</servlet-mapping> 
```

如果您的“CAS 服务器过滤器”受到干扰，您可能希望对该 URL 模式进行例外处理（在 web.xml 中，通过不同的映射方式，或者通过将过滤器配置为忽略该特定 URL 模式并传递请求）到过滤器链的其余部分）。

# c - 如何使用 c 和 pic16f84a 优化此代码？

> ID：10710087
> 
> 赞同：2
> 
> 时间：2012-05-22T20:59:34.750
> 
> 标签：c, pic, mikroc

我正在使用 mikroC 对 pic16f84a 进行编程，并且我具有以下功能

```
volatile unsigned short d;  // global variable

void put_data(){
    RA3_bit = d & 1;
    d >>= 1;
    RA4_bit = d & 1;
    d >>= 1;
    PORTB.B0 = d & 1;
    d >>= 1;
    PORTB.B1 = d & 1;
    d >>= 1;
    PORTB.B2 = d & 1;
    d >>= 1;
    PORTB.B3 = d & 1;
    d >>= 1;
    PORTB.B4 = d & 1;
    d >>= 1;
    PORTB.B5 = d & 1;
} 
```

此函数从 d（8 位）中取出每一位并将其输出到端口引脚 RA3、RA4、RB0、...、RB5。

我该如何优化这段代码，而内存是我最关心的问题。

**更新：：**

来自 pic16f84a.h：

```
volatile unsigned char           PORTA               @ 0x005;
// bit and bitfield definitions
volatile bit RA0                 @ ((unsigned)&PORTA*8)+0;
volatile bit RA1                 @ ((unsigned)&PORTA*8)+1;
volatile bit RA2                 @ ((unsigned)&PORTA*8)+2;
volatile bit RA3                 @ ((unsigned)&PORTA*8)+3;
volatile bit RA4                 @ ((unsigned)&PORTA*8)+4;

volatile unsigned char           PORTB               @ 0x006;
// bit and bitfield definitions
volatile bit RB0                 @ ((unsigned)&PORTB*8)+0;
volatile bit RB1                 @ ((unsigned)&PORTB*8)+1;
volatile bit RB2                 @ ((unsigned)&PORTB*8)+2;
volatile bit RB3                 @ ((unsigned)&PORTB*8)+3;
volatile bit RB4                 @ ((unsigned)&PORTB*8)+4;
volatile bit RB5                 @ ((unsigned)&PORTB*8)+5;
volatile bit RB6                 @ ((unsigned)&PORTB*8)+6;
volatile bit RB7                 @ ((unsigned)&PORTB*8)+7; 
```

我可以使用头文件中的这些值来使函数在循环中包含几行代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:19:01.120

假设 PORTB.B0 到 PORTB.B5 是输出端口的位，这样做可能会更快：

```
 volatile unsigned short d;  // global variable

void put_data(){
    RA3_bit = d & 1;
    d >>= 1;
    RA4_bit = d & 1;
    d >>= 1;

    PORTB &= 0x3F; // Mask out the low 6 bits
    PORTB |= d & 0x3f;  // Or in the low 6 bits of d

    // Clean out the bits if needed in d
    d >>= 6;
} 
```

我希望汇编程序的输出速度大约是您现在正在执行的速度的两倍，甚至可能更多。对前 2 条指令的第 3 位和第 4 位进行或运算可能不值得对端口内的位位置进行操作。不过可以肯定的是，请务必仔细检查汇编程序的输出。汇编器的操作码非常简单，可以很快确认。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:23:10.590

读取 A 和 B 的 PORT 或 LAT 寄存器的当前值。如果该 PIC 同时具有 PORT 和 LAT，了解区别很重要，因此如果您不确定使用哪个，我建议您进行一些研究。

然后进行必要的移位和屏蔽，以确保只更改适当的引脚，并且只执行两次写入操作，一次写入端口 A，一次写入端口 B。

或者，如果端口 A 和 B 上的所有其他引脚都通过与每个端口关联的 TRIS 寄存器设置为输入，则跳过读取步骤。

例如：

```
tmp = PORTA;
tmp = (tmp & 0xFC) | (d & 0x3);
PORTA = tmp;

tmp = PORTB;
tmp = (tmp & 0xE0) | ((d >> 2) & 0x1F);
PORTB = tmp; 
```

我认为这实际上会给你与你的代码相反的位顺序，所以你可能需要“反转”位操作，或者`d`在使用该代码之前翻转位顺序。

此外，我不能保证这实际上会产生更快的 PIC 代码。如果您真的需要绝对最快的方法，您可能需要编写几行汇​​编。

# java - Absent Code attribute in method that is not native or abstract in class file javax/servlet/ServletException

> ID：10710090
> 
> 赞同：24
> 
> 时间：2012-05-22T20:59:41.287
> 
> 标签：java, servlets

I am planning to use Java servlets in my application. I included the following in my project's POM.xml file to load Java servlet 3.0 implementation jar.

```
<dependency>
    <groupId>org.glassfish</groupId>
    <artifactId>javax.servlet</artifactId>
    <version>3.2-b05</version>
</dependency> 
```

The project compiles fine. However, when I run it, I get the following error:

```
java.lang.ClassFormatError: Absent Code attribute in method that is not native or abstract in class file javax/servlet/ServletException 
```

I searched for it here and found some [good answers](https://stackoverflow.com/questions/2979968/cant-instantiate-javax-servlet-servletexception?answertab=votes#tab-top "good answers").

I figured out from them that this error happens when we include the JAR which contains only interfaces defined by servlet API and not the actual implementation. So, I checked that the glassfish jar I am using is just interfaces or it contains implementation too. I found that it is an implementation and not just interfaces.

So now, I am wondering why I am getting this error at runtime. Anyone?

UPDATE:

Just now, I found out that it was a blatant error from my side (I was adding the jar to one project, while, was running an altogether different project!). I am sorry for this. Adding the glassfish servlet implementation DOES solve the issue.

Thanks, Sandeep

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-23T04:43:23.437

过去 2 个小时左右，我一直在解决与用于 surefire 插件的 javaee-api 和 javaee-web-api 依赖项相关的问题。正如 JBoss 论坛上的人[不久前发布的](https://community.jboss.org/wiki/WhatsTheCauseOfThisExceptionJavalangClassFormatErrorAbsentCode)那样，似乎整个 JEE6 库被划分（根据 Sun/Oracle 的决定）为 API（仅限接口/存根）JAR 和提供程序。

这与这有什么关系？如果您对[FacesContext 类](http://docs.oracle.com/javaee/6/api/javax/faces/context/FacesContext.html)有疑问，您会收到如下错误：

```
java.lang.ClassFormatError: Absent Code attribute in method that is not native or abstract in class file javax/faces/context/FacesContext 
```

如果您查看依赖关系树，您会在编译类路径中找到一个默认的 API JAR，它也妨碍了运行时问题：

```
javax.faces:javax.faces-api:jar:2.1:provided 
```

为 surefire 插件配置添加显式排除将在测试时强制使用提供程序 JAR 依赖项：

```
<plugin>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>2.12</version>
    <configuration>
        <classpathDependencyExcludes>
            <!-- exclude code absent api -->
            <classpathDependencyExclude>javax.faces:javax.faces-api</classpathDependencyExclude>
        </classpathDependencyExcludes>
    </configuration>
</plugin> 
```

希望有帮助，它确实对我有用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-31T13:55:29.373

我交易到 glassfish-embedded-all 并解决了这个问题。

```
 <dependency>
        <groupId>org.glassfish.main.extras</groupId>
        <artifactId>glassfish-embedded-all</artifactId>
        <version>3.1.2.2</version>
        <scope>provided</scope>
    </dependency> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-03T06:16:22.523

```
<dependency>
<groupId>org.glassfish.main.extras</groupId>
<artifactId>glassfish-embedded-all</artifactId>
<version>3.1.2.2</version>
<scope>provided</scope> 
```

它对我有用。谢谢。但是 pom.xml 中的顺序对我来说也很重要

```
 <dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-api</artifactId>
        <version>6.0</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>org.glassfish.main.extras</groupId>
        <artifactId>glassfish-embedded-all</artifactId>
        <version>3.1.2.2</version>
        <scope>test</scope>
    </dependency> 
```

以上订单无效

```
<dependency>
        <groupId>org.glassfish.main.extras</groupId>
        <artifactId>glassfish-embedded-all</artifactId>
        <version>3.1.2.2</version>
        <scope>test</scope>
    </dependency>
 <dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-api</artifactId>
        <version>6.0</version>
        <scope>provided</scope>
    </dependency> 
```

以上订单作品

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-07-29T20:48:36.027

当我运行我的测试（JUnit + Mockito）时，我在使用 Jersey 时遇到了同样的错误。对我有用的是将下面的代码添加到我的 pom.xml 文件中。

```
<dependency>
   <groupId>com.sun.jersey</groupId>
   <artifactId>jersey-test-framework</artifactId>
   <version>1.1.5.1</version>
   <scope>test</scope>
</dependency> 
```

注意：我使用的是 Jersey 1.17

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-12-12T15:30:27.317

我最近遇到了同样的错误，多亏了这个问题和上面的答案——尤其是leadro.freitos——我能够使用解决它

```
 <dependency>
    <groupId>org.glassfish.main.extras</groupId>
    <artifactId>glassfish-embedded-all</artifactId>
    <version>3.1.2.2</version>
    <scope>provided</scope>
</dependency> 
```

原来我的与 javax.servlet 有关

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-01-08T15:39:06.030

我有一个与 josdem 类似的案例（同样的错误，在使用 Mockito 运行 JUnit 时也是如此），但没有 Jersey。所以这是一个对我有用的独立于泽西岛的解决方案：

```
 <dependency> 
        <groupId>org.apache.geronimo.specs</groupId>
        <artifactId>geronimo-servlet_3.0_spec</artifactId>
        <version>1.0</version>
        <scope>test</scope>
    </dependency> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-04T15:31:42.357

这里同样的问题。尽管事实证明我是声明依赖项的顺序。glassfish 嵌入式依赖项需要在提供的 javaee-web-api 依赖项之前声明。

```
 <dependency>
        <groupId>org.glassfish.extras</groupId>
        <artifactId>glassfish-embedded-all</artifactId>
        <version>3.0</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-web-api</artifactId>
        <version>6.0</version>
        <scope>provided</scope>
    </dependency> 
```

我不确定为什么在测试中将 glassfish 嵌入在 javaee-web-api 之后放置时，类路径会变得混乱。我想JVM首先尝试解析提供的javax类，然后在测试期间放弃。我认为声明测试范围将优先，但在我的情况下似乎并非如此。希望这可以帮助某人。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2013-06-07T00:00:48.540

使用 netbeans 7.2.1 编译时遇到了同样的问题。但是，输出将我自己的一个 java 源文件指定为具有“缺少代码属性.......等”

同时，我可以使用 JDeveloper 编译和运行相同的项目。经过几次“清理”并重新启动后，netbeans 仍然出现了同样的问题。

我最终通过在被报告为“缺少代码属性”的 java 中添加一个 main 方法并使用与调试目标相同的方法来修复它。一切恢复正常。

# android - How to start activity from FREFunction?

> ID：10710094
> 
> 赞同：3
> 
> 时间：2012-05-22T20:59:47.637
> 
> 标签：android, apache-flex, air-native-extension

I'm trying to start and activity from a FREFunction to use facebooks's SSO on my flex application.

I did in my FREFunction:

```
 @Override
    public FREObject call(FREContext context, FREObject[] args) {
         Intent myIntent = new Intent(context.getActivity(), FacebookSSO.class);
         context.getActivity().startActivity(myIntent);
         return null;
    } 
```

I get with logcat:

```
I/ActivityManager( 1322): Starting activity: 
Intent{ cmp=air.testapp/com.test.android.ane.activity.FacebookSSO } from pid... 
```

But my log calls in the onCreate method of are FacebookSSO.java are not displayed:

```
 @Override
 public void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
     //setContentView(R.layout.main);
     Log.d("FacebookSSO", "onCreate BEGIN.");
     Log.d("FacebookSSO", "onCreate END.");
 } 
```

I tried creating myIntent in different ways, like using setClass. What am I doing wrong?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T02:55:55.080

你解决了这个问题吗？

您是否尝试过将类添加到应用程序描述符中的清单添加中？

```
<android>
    <manifestAdditions><![CDATA[
        <manifest android:installLocation="auto">
            <uses-permission android:name="android.permission.INTERNET"/>
            <application>
                <activity android:name="com.test.android.ane.activity.FacebookSSO"></activity>
            </application>
        </manifest>
    ]]></manifestAdditions>
</android> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:10:21.593

您正在使用的[Intent 构造函数](http://developer.android.com/reference/android/content/Intent.html#Intent%28android.content.Context,%20java.lang.Class%3C?%3E%29)需要一个 Context 作为其参数（请记住[Activity](http://developer.android.com/reference/android/app/Activity.html) *也是一个*Context 。）

因为构造函数需要一个 Context 并且您从一个上下文开始，所以应该不需要调用`getActivity()`. 也是[Context](http://developer.android.com/reference/android/content/Context.html#startActivity%28android.content.Intent%29)`startActivity()`的一种方法，因此您也不需要第二行中的 。但是我不知道这是否会导致您看到的错误。`getActivity()`

以这种方式尝试您的代码：

```
Intent myIntent = new Intent(context, FacebookSSO.class);
context.startActivity(myIntent); 
```

# facebook - 为什么我的结果与使用 FB 网站和 FB API 不同？

> ID：10710096
> 
> 赞同：0
> 
> 时间：2012-05-22T20:59:52.380
> 
> 标签：facebook, facebook-graph-api

看似简单的问题，但到目前为止我没有找到明显的答案。

我使用浏览器登录 Facebook.com。我去搜索栏，输入“奥巴马”。然后选择左侧栏上的“Public Posts”，开始列出所有 PUBLIC 帖子。我选择了一个分享喜欢/照片的帖子，并且有一个这样的 URL：'www.facebook/com/story_fbid=&id=. 我发现 abc 是 user_id 而 xyz 是 object_id。这也意味着 post_id 是 abc_xyz。

然后我去 graph.facebook.com API explorer，生成一个用户访问令牌，然后输入这个查询：

> [https://graph.facebook.com/fql?q=select](https://graph.facebook.com/fql?q=select) post_id from stream where post_id="abc_xyz"

没有。

我什至尝试

> 从链接中选择链接ID，其中链接ID在（“xyz”，“abc_xyz”）

依然没有。

那么，这里发生了什么？StackOverflow 上的一些帖子谈到了 facebook 的公开帖子如何不是真正公开的——但是，官方 FB 文档中没有提及这一点。

然后，我尝试创建一个新帐户，在我的墙上创建帖子，公开我的墙上帖子，然后我尝试了与上述相同的查询，但又一次没有（只是一个空的数据集）。

各位大佬，这个行为有官方解释吗？当我以用户身份登录时，我不是一个应用程序！/机器人，而只是一个最终用户 - 我可以看到公开的帖子/链接/分享/照片，那么到底为什么 API 不能做同样的事情呢？我能做些什么，让一个 PUBLIC POST 更公开？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T03:52:54.763

我相信这个问题的答案回答了我的问题：[尝试使用 FQL 在 Facebook 中读取朋友链接：为什么有些朋友返回一个空集？](https://stackoverflow.com/questions/8222516/trying-to-read-friends-links-in-facebook-using-fql-why-do-some-friends-return-a)

Facebook的用户被允许为应用程序设置单独的权限，所以即使我使用graph api explorer（这是一个应用程序）或直接使用api（相当于一个应用程序），任何公共链接/照片都只对这些可用当这些链接/照片/状态的原始作者没有从隐私设置下的“**人们如何将您的信息带到他们使用的应用程序”设置中取消选中时，应用程序。**

我尝试了一个测试 fb 帐户，共享了一个链接（使用默认隐私设置），我能够使用链接表上的 FQL 查询它，然后，我在隐私设置下关闭了“我的链接”，这次是api explorer 中的相同查询返回空集。

因此，对于我的问题“我**能做些什么，以发布公共帖子，更加公开”的答案是，我对此无能为力**- 这是发布此公共帖子的用户控制的设置。当它默认时，我可以访问它，当它不是时，我不会。

希望，这可以帮助其他人寻找类似的答案。

# ios - RestKit weird result loading data without internet connection

> ID：10710099
> 
> 赞同：1
> 
> 时间：2012-05-22T21:00:09.667
> 
> 标签：ios, core-data, restkit

I'm using RestKit to load objects from a specific web url. Doing the mapping and showing in a tableView. Ok, it works. But when I don't have internet connection, it loads the content of the last object loaded. The weird is:

It doesn't really loads the last object loaded. When I load the object "1", close the application, run it again to load the object "2", then close again, turn off the connection and run, it shows the object 1 content. Even if I clean the context load the object "2", then "1", turn off the connection and run, it shows again the object "1"content! It seems like the object "1" has some kind of "priority".

What I'm doing:

```
- (void)dataDownload
{
    [self showLoading:YES];
    RKObjectManager* objectManager = [RKObjectManager sharedManager];
    [objectManager loadObjectsAtResourcePath:@"my-url" delegate:self block:^(RKObjectLoader* loader) {
        loader.objectMapping = [objectManager.mappingProvider objectMappingForClass:[Conteudo class]];
    }]; 
```

}

```
- (void) loadDatabase
{
    NSFetchRequest* request = [Conteudo fetchRequest];
    NSSortDescriptor* descriptor = [NSSortDescriptor sortDescriptorWithKey:@"createdAt" ascending:NO];
    [request setSortDescriptors:[NSArray arrayWithObject:descriptor]];
    self.conteudo = [Conteudo organizeData:[Conteudo objectsWithFetchRequest:request]]; 
```

}

`

```
- (void)objectLoader:(RKObjectLoader*)objectLoader didLoadObjects:(NSArray*)objects {
        [self showLoading:NO];
        [[NSUserDefaults standardUserDefaults] setObject:[NSDate date] forKey:@"LastUpdatedAt"];
        [[NSUserDefaults standardUserDefaults] synchronize];
        NSArray *result = objects;
        if(result != nil){
            self.conteudo = [Conteudo organizeData:result];
            [[NSManagedObject managedObjectContext] save:nil];
        }
        else 
            [self loadDatabase];
        [self.tableView reloadData];
    } 
```

`

Thanks for the help =]

# asp.net - 如何设置 IHttpAsyncHandler 超时？

> ID：10710104
> 
> 赞同：8
> 
> 时间：2012-05-22T21:00:40.723
> 
> 标签：asp.net, iis, ihttpasynchandler

我试图在 web.config 文件中设置 executionTimeout：

```
<compilation debug="false" targetFramework="4.5">
<httpRuntime executionTimeout="30"/> 
```

查看 IIS 管理器请求页面，我可以看到请求在 30 秒后没有被终止。
我应该在 IHttpAsyncHandler 中实现 Timer 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T21:16:44.967

由于明显缺乏对 IHttpAsyncHandler 超时的内置支持，您可能必须管理自己的超时。也许这是设计使然；毕竟你选择了一种异步模式——MSFT 认为谁在尝试为你的长时间运行的任务设置默认超时？

我要做的是使用[ThreadPool.RegisterWaitForSingleObject](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.registerwaitforsingleobject.aspx)以适当的超时来管理您的轮询。这是我用来避免等待永远不会返回的 Web 服务的代码示例：

```
private const int REQUEST_TIMEOUT = 30000;   // miliseconds (30 sec)
private void CallService()
        {
        try {
             string url = "somewebservice.com";
             WebRequest request = WebRequest.Create(url);

             // Asynchronously fire off the request
             IAsyncResult result = request.BeginGetResponse(new AsyncCallback(MyRoutineThatUsesTheResults), request);

             // Handle timed-out requests
             ThreadPool.RegisterWaitForSingleObject(result.AsyncWaitHandle, new WaitOrTimerCallback(RequestTimeout), request, REQUEST_TIMEOUT, true);
         }
         catch (Exception ex) {
              _logger.Error("Error during web service request.", ex);
         }

private void RequestTimeout(object state, bool timedOut)
        {
            if (timedOut) {
                WebRequest request = (WebRequest)state;
                _logger.WarnFormat("Request to {0} timed out (> {1} sec)", request.RequestUri.ToString(), REQUEST_TIMEOUT / 1000);
                request.Abort();
            }
        } 
```

您将需要一个 IAsyncResult 来使用这种方法，但这是一个既定的模式，您应该不会在运行样本时遇到问题。

此外，当 IIS 决定在轮询仍在运行时回收您的应用程序池/拆除您的应用程序域时，您将遇到问题。如果这是您想要处理的情况，您可以使用[HostingEnvironment.RegisterObject](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T02:48:12.180

您可以尝试将其添加到您的`web.config`文件中：

```
<system.web>
  <pages asyncTimeout="30" />
</system.web> 
```

它为`PageAsyncTask`，但也可能被授予荣誉`IHttpAsyncHandler`？

`HttpTaskAsyncHandler`如果没有，您可能对`ASP.Net`4.5 版本 中的新功能有更多的运气： [http ://www.asp.net/vnext/overview/whitepapers/whats-new#_Toc318097378](http://www.asp.net/vnext/overview/whitepapers/whats-new#_Toc318097378)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-29T11:42:17.030

您必须使用 RegisterAsyncTask 检查下面的链接

[http://msdn.microsoft.com/en-us/magazine/cc163725.aspx](http://msdn.microsoft.com/en-us/magazine/cc163725.aspx)

# java - 如何选择 JSF 表中的所有行并删除它们？

> ID：10710114
> 
> 赞同：0
> 
> 时间：2012-05-22T21:01:46.293
> 
> 标签：java, jsf, jsf-2

我有一个带有复选框和分页的 JSF 表。我有以下问题：我想将所有行选择到所有表格页面中并删除它们。简单的方法是创建一个 Java hashmap 并存储密钥。然后Java方法会使用键将它们删除到hashmap中，但是如果hashmap超过100万会发生什么？也许内存泄漏？也许解决方案是使用这个简单的 JavaScript 来选择所有复选框：

```
//Select all checkbox
function selectall(){     
    $('button').click(function() {
        $("[type=checkbox]").prop("checked", true);
    })​     
}

//Unselect all checkbox
function selectall(){     
    $('button').click(function() {
        $("[type=checkbox]").prop("checked", false);
    })​     
} 
```

我面临两个问题： 1\. 如果我使用 JavaScript 选中所有复选框，可能只会选中第一页上的复选框，如果我打开第二页，则不会选中复选框。JavaScript 仅适用于一页。2\. 如果我在单击删除按钮时使用 JavaScript 选择所有复选框，Java 方法如何知道每个复选框都被选中到表中并删除行？我该如何解决这些问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:12:55.940

> *如果我使用 JavaScript 选择所有复选框，可能只会选择第一页上的复选框，如果我打开第二页，则不会选择复选框。*

这是真的，因为数据表（甚至整个页面）被重新渲染并且会失去它们的检查状态。

> *我该如何解决这些问题？*

专注于你试图实现的目标。实际上，您不想选择分页数据表中的所有一百万个条目，而是想删除支持您的数据表的整个列表或集合。

为什么不添加一个简单地清空列表的“全部删除”按钮？那么你根本不需要关心选择框。

# android - AndEngine：多个 TimerHandlers

> ID：10710116
> 
> 赞同：0
> 
> 时间：2012-05-22T21:02:06.170
> 
> 标签：android, andengine

我已经建立了一个单独的类来扩展 AnimatedSprite，称为“Enemy”。我在场景中创建了几个 Enemy 实例。每个都应该有自己的 TimerHandler，它控制动画。然而，这些计时器似乎都是链接在一起的，每个精灵同时更改其 TileIndex。这是代码：

```
package com.tahakki.folkprequel;

import java.util.Random;

import org.anddev.andengine.engine.handler.timer.ITimerCallback;
import org.anddev.andengine.engine.handler.timer.TimerHandler;
import org.anddev.andengine.entity.sprite.AnimatedSprite;
import org.anddev.andengine.extension.physics.box2d.PhysicsConnector;
import org.anddev.andengine.extension.physics.box2d.PhysicsFactory;
import org.anddev.andengine.extension.physics.box2d.PhysicsWorld;
import org.anddev.andengine.opengl.texture.region.TiledTextureRegion;

import com.badlogic.gdx.math.Vector2;
import com.badlogic.gdx.physics.box2d.Body;
import com.badlogic.gdx.physics.box2d.Contact;
import com.badlogic.gdx.physics.box2d.ContactListener;
import com.badlogic.gdx.physics.box2d.BodyDef.BodyType;
import com.badlogic.gdx.physics.box2d.FixtureDef;

public class Enemy extends AnimatedSprite{

private Body physB;
private PhysicsWorld physW = MainActivity.mPhysicsWorld;
private static final FixtureDef FIXTURE_DEF = PhysicsFactory.createFixtureDef(1, 0, 0);
private TimerHandler timer;
private Random rand = new Random();

public Enemy(float pX, float pY, TiledTextureRegion pTiledTextureRegion) {
    super(pX, pY, pTiledTextureRegion);

    this.setCurrentTileIndex(rand.nextInt(3));
    this.setScale(0.6f);
    physB = PhysicsFactory.createBoxBody(physW, this, BodyType.DynamicBody, FIXTURE_DEF);
    physB.setFixedRotation(true);
    physW.registerPhysicsConnector(new PhysicsConnector(this, physB));

    timer = new TimerHandler(2 + (2*rand.nextFloat()), true, new ITimerCallback(){
        @Override
        public void onTimePassed(TimerHandler pTimerHandler) {
            int random = rand.nextInt(3);
            Enemy.this.setCurrentTileIndex(random);
        }
    });
    this.registerUpdateHandler(timer);
}

} 
```

有谁知道如何让每个对象都有自己独立的计时器？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T10:44:57.827

我猜你对每个敌人使用相同的 TextureRegion。如果您不复制它们，请尝试

```
Enemy e = new Enemy(x,y,yourTextureregion.deepCopy()); 
```

# c++ - C++ 不允许显示命令提示符

> ID：10710120
> 
> 赞同：1
> 
> 时间：2012-05-22T21:02:10.583
> 
> 标签：c++, shell, command-prompt

我可以做些什么来确保在我运行 C++ 程序时不显示 shell/命令提示符，它应该是一个后台程序？虽然它显示出来并不是什么大问题，因为它会很快关闭，但我宁愿它根本不显示。程序将在 windows xp/vista/7 操作系统上运行

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T21:19:04.897

配置您的编译器或链接器以将您的程序标记为 GUI 应用程序。

Windows 可识别两种主要类型的程序：GUI 和控制台。如果 EXE 标头被标记为控制台程序，则操作系统会在执行之前创建一个控制台窗口。否则，它不会。这不是您可以在运行时控制的。您需要在链接时设置它。（您可以调用`ShowWindow(GetConsoelWindow(), SW_HIDE)`以尝试在运行时对其进行控制，但这并不能阻止窗口闪烁然后再次关闭。另外，如果您的程序与另一个程序（如 cmd.exe）共享控制台，那么您将隐藏用户的命令提示符窗口！）即使您的程序没有任何实际的 GUI，这仍然是您需要避免为您创建控制台窗口的模式。

如果您在 Visual Studio 中启动一个新项目，请选择“Win32 控制台应用程序”选项。如果您已经有一个项目，那么在您的项目的配置属性中，找到“链接器/系统”部分的“子系统”设置并将其设置为“控制台”。这使得链接器使用该`/subsystem:console`选项。如果您使用的是 Mingw，请使用该`-Wl,--subsystem,windows`选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T21:07:10.383

听起来你想创建一个 Windows 服务，而不是一个命令行实用程序。这就是服务存在的原因。无需用户交互的长时间运行的后台任务。 [一个简单的例子在这里](http://www.codeproject.com/Articles/16488/A-Windows-Service-Application)。

# java - Java - 带有 2 条腿 Oauth 的 Google Calendar API v3 配额

> ID：10710122
> 
> 赞同：1
> 
> 时间：2012-05-22T21:02:15.157
> 
> 标签：java, maven, google-api, google-calendar-api, google-api-java-client

我正在为我的 Web 应用程序使用带有 Oauth 1.0 和 JAVA 的 Google Calendar API v3。

它在官方网站（[https://developers.google.com/google-apps/calendar/pricing](https://developers.google.com/google-apps/calendar/pricing)）上说配额是每天 10 000 个查询。我还在我的 Google API 控制台面板中设置了每位用户每秒 100 个请求的限制。

当我运行测试时，日历 API 工作正常（我在我的 java 应用程序中执行的所有操作都显示在我的日历上）。然后，当我进行大约 50 次操作时，我得到了 403 Forbidden, quotaExceeded 错误。

有没有人有同样的问题？

谢谢

编辑 ：

我从谷歌得到的确切 JSON 错误是：

```
com.google.api.client.googleapis.json.GoogleJsonResponseException: 403 Forbidden
{
 "code" : 403,
 "errors" : [ {
"domain" : "usageLimits",
"message" : "Quota Exceeded",
"reason" : "quotaExceeded"
 } ],
"message" : "Quota Exceeded"
} 
```

我项目中的谷歌日历 Maven 依赖项：

```
<dependency>
        <groupId>com.google.apis</groupId>
        <artifactId>google-api-services-calendar</artifactId>
        <version>v3-rev7-1.6.0-beta</version>
</dependency> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:54:28.860

是的，我去过那里，看到这个[讨论](https://groups.google.com/forum/?fromgroups#!topic/google-apps-marketplace-api/l1BaiNPpGw8)......

或者您确定您的 API 控制台与您的 Google Apps 项目和使用的 OAUTH 消费者密钥/秘密相关？用于普通 Google 帐户和 Google Apps 帐户的 API 控制台之间存在差异。您必须创建一个 Google Apps 市场列表，这将自动创建一个新的 API 控制台，该控制台与您从市场收到的 OAUTH 消费者密钥/秘密相关。

希望这可以帮助...

# asp.net - 重定向到 facebook 的 url，比如

> ID：10710130
> 
> 赞同：0
> 
> 时间：2012-05-22T21:02:54.890
> 
> 标签：asp.net, facebook, asp.net-mvc-3, redirect

我有一个类似 grap 元标记的页面。

```
<!DOCTYPE html>
<html> 
    <head>
        <title>@Model.Title</title>
        <meta property="og:title" content="@Model.Title"/> 
        <meta property="og:image" content="@Model.Image"/> 
        <meta property="og:url" content="@Model.Url"/>
        <meta property="og:description" content="@Model.Description"/>
        <meta property="fb:app_id" content="@Model.AppId"/>

    </head>
    <body>
    </body>
</html> 
```

我还有一个属性 RedirectUrl，当用户单击链接时应该重定向到该属性。我怎么能在这个页面上做？因为此页面仅针对元标记。单击喜欢的网址时，我想将用户带到另一个页面吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:14:04.007

```
<meta http-equiv="refresh" content='0; url=@Request.QueryString["ReturnUrl"]' /> 
```

或者使用js和document.location。

# c# - 找不到使用 C# 在 openGL 中将纹理应用于 3d 对象的方法

> ID：10710133
> 
> 赞同：0
> 
> 时间：2012-05-22T21:02:58.963
> 
> 标签：c#, opengl, 3d, textures

我有一些项目，其中包括来自 Glut 命名空间的许多 3d 对象，例如

```
Glut.glutSolidCone(0.75, 30, 4, 20); 
```

我无论如何都找不到在这些对象上应用纹理，只有 2d 纹理适用于 2d 对象。

我试过这段代码，虽然我认为它是错误的，但它没有用，

```
Gl.glPushMatrix();
        Gl.glEnable(Gl.GL_TEXTURE_2D);
        Try.Terrain.LoadGLTextures("Textures/Sitework.Paving - Surfacing.Riverstone.jpg");
        Gl.glTexCoord2d(0, 0);
        Gl.glTexCoord2d(0, 1);
        Gl.glTexCoord2d(1, 1);
        Gl.glTexCoord2d(1, 1);
        Gl.glRotated(90, 1, 0, 0);
        Glut.glutSolidCone(5, 10, 30, 30);
        Gl.glDisable(Gl.GL_TEXTURE_2D);
        Gl.glPopMatrix(); 
```

结果是这个 3d 对象出现时应用了纹理的基本颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:13:20.183

`glutSolidCone()`不包含纹理坐标。

您必须[自己生成它们](https://stackoverflow.com/a/327135/44729)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-30T20:12:30.727

旧函数[gluCylinder()](https://www.opengl.org/sdk/docs/man2/xhtml/gluCylinder.xml)支持纹理。

gluCylinder() 有两个半径参数：base 和 top，所以简单地设置 top=0 会生成一个圆锥而不是圆柱。

```
GLUquadricObj* quadobj = gluNewQuadric();
gluQuadricTexture(quadobj, GL_TRUE);
glBindTexture(GL_TEXTURE_2D, *your_texture );
gluCylinder(quadobj, 2.0, 0, 3.0, 10, 10); 
```

我不确定 C# 中是否有 gluCylinder() 。

# ios - UITableView 部分之间的空间是多少？

> ID：10710136
> 
> 赞同：0
> 
> 时间：2012-05-22T21:03:12.813
> 
> 标签：ios, xcode, cocoa-touch, xcode4.3, space

UITableView 部分之间的默认空间是多少？

这是一个例子。 ![在此处输入图像描述](../Images/f0cdb544055bdfd7070cf65a21c79664.png)

感谢所有的帮助！

碎纸机2794

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:47:08.953

[这个答案](https://stackoverflow.com/a/4812438/591586)表明它是页眉和页脚高度的组合，默认情况下两者都是 10。所以总共20个。

# c# - C# SendKeys 在发送前等待程序加载

> ID：10710141
> 
> 赞同：1
> 
> 时间：2012-05-22T21:03:26.187
> 
> 标签：c#, process, executable, sendkeys, loaded

长话短说，当我的电脑启动时，我正在尝试自动化一些事情。我想我会编写一个 C# 控制台应用程序来执行此操作，然后将其添加到 Windows 中的计划任务中，以便在启动时执行。我的问题是一个程序，它需要密码并且没有通过命令行打开的选项。因此必须手动输入。我的想法是从 KeePass 数据库中检索我的密码，然后使用 SendKeys 输入密码并登录到程序。我遇到的问题是加载时间；我无法检测到 GUI 界面何时已加载并为我的 SendKeys 做好准备。有没有办法检测到这一点？我假设我必须使用的只是“进程”类，因为那是我用来运行程序的。另请注意，当我使用 Process.Start() 运行可执行文件时，

好吧，那是长，我可以重新盖...

问题：从 C# 检测第三方程序何时加载（即启动画面消失且 GUI 已准备好进行用户交互 - 这意味着我不能仅仅依赖进程是否正在运行）。此外，第三方程序没有命令行选项，或者我只会使用密码作为参数运行它。

目标：使用 SendKeys 来自动输入密码，但我的程序必须等待第三方应用程序完成加载。

注意：使用 C# .NET 3.5 控制台应用程序不检测我自己的表单但第三方的负载，否则这很容易（即 form_loaded 事件......）

感谢您查看我的问题，如果您想了解更多详细信息或任何事情，请告诉我。

**更新**：

*问题解决了！* 我收到的两个答案相结合，为我提供了我想要的解决方案。因此，如果以后有人遇到此问题，这就是我为使其正常工作所做的工作。

因此，该程序会自动登录您必须登录的某些客户端软件。我的问题是该软件没有提供许多其他程序提供的命令行参数选项或文档，因此您可以使用密钥文件或其他东西登录。该程序还禁用了复制和粘贴功能，因此必须手动输入密码，如果您像我一样使用密码，这是一个很大的痛苦，长而复杂的密码没有模式。所以我写这个程序是为了我和工作中的其他人的利益；我只是安排它在登录到我的 Windows 机器时运行，它会打开客户端软件并自动执行登录。

```
//
// IMPORTANT Windows API imports....
//

[DllImport("user32.dll", SetLastError = true)]
private static extern uint GetWindowThreadProcessId(IntPtr hWnd, out uint procId);

[DllImport("user32.dll", SetLastError = true)]
private static extern IntPtr FindWindowEx(IntPtr hwndParent, IntPtr hwndChildAfter, string lpszClass, string lpszWindow); 

[DllImport("user32.dll", SetLastError = true)]
private static extern bool SetForegroundWindow(IntPtr hWnd);

// When I get to this point in my code, I already had the password and window title...
string password = "password";
string title = "window title";

// This gets a handle to the window I want where "title" is the text in the title
// bar of the window as a string.
// This is a Windows API function that must be imported by DLLImport
// I had to get the handle this way because all I knew about the third party
// window was the title, not the process name or anything...
IntPtr hWnd = FindWindowEx(IntPtr.Zero, IntPtr.Zero, null, title);

// Now that I have a handle to the login window I used another windows API
// call to get the process ID.

// This windows API call gives me the Process ID as an out parameter and returns
// the thread ID of the window. I don't use the thread it, but maybe you can...
uint loginWindowProcId;
uint loginWindowThreadId = GetWindowThreadProcessId(hWnd, out loginWindowProcId);

// now I can just use .NET to find the Process for me...
Process loginWindowProcess = null;

if (0 != loginWindowProcId)
{
  // get the process object
  loginWindowProcess = Process.GetProcessById((int)loginWindowProcId);

  // This right here is why I wanted the Process structure. It takes a
  // little while for the client software to load and be ready. So here
  // you wait for the window to be idle so you know it has loaded and can
  // receive user input, or in this case keys from "SendKeys".
  loginWindowProcess.WaitForInputIdle();

  // I use yet another windows API call to make sure that the login window
  // is currently in the foreground. This ensures that the keys are sent
  // to the right window. Use the handle that we started with.
  SetForegroundWindow(hWnd);

  // Now send the password to the window. In my case, the user name is 
  // always there from my windows credentials. So normally I would type in the
  // password and press ENTER to login. But here I'll use SendKeys to mimic my
  // behavior.
  SendKeys.SendWait(password);   // send password string
  SendKeys.SendWait("{ENTER}");  // send ENTER key

  // Now the client should be logging in for you! : )

  // IMPORTANT NOTE
  // If you are using a console application like I am, you must add a reference to
  // System.Windows.Forms to your project and put "using System.Windows.Forms;" in
  // your code. This is required to use the "SendKeys" function.
  //
  // Also this code is just for my testing (quick and dirty), you will want to write 
  // more checks and catch errors and such. You should probably give the 
  // WaitForInputIdle a timeout etc...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:53:40.357

试试看：[http ://www.acoolsip.com/a-cool-blog/science-and-technology/151-c-sending-commands-to-independent-windows.html](http://www.acoolsip.com/a-cool-blog/science-and-technology/151-c-sending-commands-to-independent-windows.html)

您可以检查窗口是否显示（使用链接）然后发送消息（也在链接上）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T22:18:34.993

您可以在启动进程后检查 Process.WaitForInputIdle，并等待完全启动，这是一个简单的示例：

[http://msdn.microsoft.com/en-us/library/xb73d10t%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/xb73d10t%28v=vs.71%29.aspx)

# log4j - 如何让 log4j 定期重新打开日志文件（logrotate）

> ID：10710142
> 
> 赞同：1
> 
> 时间：2012-05-22T21:03:40.913
> 
> 标签：log4j, logrotate

我的系统管理员一直在“鼓励”我修复我们的 Web 应用程序日志，以便与 logrotate 很好地配合使用。问题是在 logrotate 处理文件后，应用程序停止记录。发生这种情况后，有没有办法配置 log4j 以重新打开日志文件？

此评论解释了一般问题，但没有为 log4j 提供解决方案：[https ://stackoverflow.com/a/6514233/201748](https://stackoverflow.com/a/6514233/201748)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T15:00:49.253

我仍然要测试它，但是`copytruncate`logrotate 的选项应该可以。

# jsf-2 - JSF2 h:selectOneListBox 进行渲染 代替

> ID：10710143
> 
> 赞同：0
> 
> 时间：2012-05-22T21:03:44.607
> 
> 标签：jsf-2

我们使用的是 JSF2.0，我们的最终 HTML 需要`<li>`在列表框中而不是`<optionValues>`. 我们`<h:selectOneListBox>`在 jsf 中使用。我们正在尝试使用 Jquery 将其更改`<optionValues>`为`<li>`.

有没有其他更好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:07:26.137

不与[标准的 JSF HTML 组件集](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/)。它们都呈现标准的 HTML 元素，没有任何花哨。

您需要查看具有增强换肤支持的 JSF 组件库。[例如PrimeFaces](http://www.primefaces.org/)组件库，它在后台使用 jQuery UI，有一个[`<p:selectOneListbox>`](http://www.primefaces.org/showcase/ui/selectOneListbox.jsf)生成一个`<ul><li>`，完全符合您的需要。请参阅[展示页面](http://www.primefaces.org/showcase/ui/selectOneListbox.jsf)。`<p:selectOneListbox>`这是展示页面上第一个示例的生成 HTML 源代码：

```
<ul>
    <li class="ui-selectlistbox-item ui-corner-all">Option 1</li>
    <li class="ui-selectlistbox-item ui-corner-all ui-state-active">Option 2</li>
    <li class="ui-selectlistbox-item ui-corner-all">Option 3</li>
</ul> 
```

# java - RequestDispatcher 和路径

> ID：10710151
> 
> 赞同：0
> 
> 时间：2012-05-22T21:04:30.710
> 
> 标签：java, http, url, servlets

在处理`RequestDispatcher`和资源路径时，路径是否主要建立在`<url-pattern>`元素上？即使资源在不同的包中

例如：我在 servlet 下定义：

```
 <url-pattern>/handlers/FrontHandler</url-pattern> 
```

和另一个资源，`<url-pattern>/handlers/sub/SecondHandler</url-pattern>`所以这个资源相对于前一个资源，即使两个类在不同的包中？

我理解正确吗？我还必须`../`像普通的 paht 导航一样使用来提升一级吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:35:51.990

[javadoc](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getRequestDispatcher%28java.lang.String%29)说：

> 指定的路径名​​可以是相对的，尽管它不能扩展到当前 servlet 上下文之外。如果路径以“/”开头，则将其解释为相对于当前上下文根。

因此，路径与类名无关，而与位于给定路径中的资源（静态，如 html 文件，或动态，如映射到给定 url 模式的 servlet）有关。

我会避免使用相对路径：很难知道它们解析到哪个绝对路径，而且它们很脆弱，因为如果您将 servlet 映射到另一个 URL，它们就会中断。

# c# - 使用反射从类列表中的属性中获取值

> ID：10710156
> 
> 赞同：24
> 
> 时间：2012-05-22T21:04:57.680
> 
> 标签：c#, generics, reflection, collections

我正在尝试从作为主对象一部分的列表中的对象获取值。

我有一个主要对象，其中包含可以是集合的各种属性。

现在我正试图弄清楚如何访问对象中包含的通用列表。

```
///<summary>
///Code for the inner class
///</summary>
public class TheClass
{
    public TheClass();

    string TheValue { get; set; }
} //Note this class is used for serialization so it won't compile as-is

///<summary>
///Code for the main class
///</summary>
public class MainClass
{
    public MainClass();

    public List<TheClass> TheList { get; set; }
    public string SomeOtherProperty { get; set; }
    public Class SomeOtherClass { get; set }
}

public List<MainClass> CompareTheValue(List<object> MyObjects, string ValueToCompare)
{ 
    //I have the object deserialised as a list
    var ObjectsToReturn = new List<MainClass>();
    foreach(var mObject in MyObjects)
    {

        //Gets the properties
        PropertyInfo piTheList = mObject.GetType().GetProperty("TheList");

        object oTheList = piTheList.GetValue(MyObject, null);

        //Now that I have the list object I extract the inner class 
        //and get the value of the property I want
        PropertyInfo piTheValue = oTheList.PropertyType
                                          .GetGenericArguments()[0]
                                          .GetProperty("TheValue");

        //get the TheValue out of the TheList and compare it for equality with
        //ValueToCompare
        //if it matches then add to a list to be returned

        //Eventually I will write a Linq query to go through the list to do the comparison.
        ObjectsToReturn.Add(objectsToReturn);

    }
return ObjectsToReturn;
} 
```

我尝试`SetValue()`在此上使用 with MyObject ，但它出错（解释）：

> 对象不是类型

```
private bool isCollection(PropertyInfo p)
{
    try
    {
        var t = p.PropertyType.GetGenericTypeDefinition();
        return typeof(Collection<>).IsAssignableFrom(t) ||
               typeof(Collection).IsAssignableFrom(t);
    }
    catch
    {
        return false;
    }
    }
} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-22T21:23:17.703

要使用反射获取/设置，您需要一个实例。要遍历列表中的项目，请尝试以下操作：

```
PropertyInfo piTheList = MyObject.GetType().GetProperty("TheList"); //Gets the properties

IList oTheList = piTheList.GetValue(MyObject, null) as IList;

//Now that I have the list object I extract the inner class and get the value of the property I want

PropertyInfo piTheValue = piTheList.PropertyType.GetGenericArguments()[0].GetProperty("TheValue");

foreach (var listItem in oTheList)
{
    object theValue = piTheValue.GetValue(listItem, null);
    piTheValue.SetValue(listItem,"new",null);  // <-- set to an appropriate value
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-22T21:15:57.490

看看这样的事情是否可以帮助您朝着正确的方向前进：前段时间我遇到了同样的错误，这段代码被剪断了解决了我的问题。

```
PropertyInfo[] properties = MyClass.GetType().GetProperties();
foreach (PropertyInfo property in properties)
{
  if (property.Name == "MyProperty")
  {
   object value = results.GetType().GetProperty(property.Name).GetValue(MyClass, null);
   if (value != null)
   {
     //assign the value
   }
  }
} 
```

# ios - UINavigationBar 应该是不透明的，但透明的 PNG 图像应该允许背景可见

> ID：10710157
> 
> 赞同：0
> 
> 时间：2012-05-22T21:05:04.437
> 
> 标签：ios, transparency, uinavigationbar

我的输出是这样的：如您所见，内容区域中的灰色像素背景在我的导航栏的切割边缘之后开始。

[http://i.stack.imgur.com/eUqqX.png](http://i.stack.imgur.com/eUqqX.png)

但我的要求如下：

我希望导航栏不透明。但是如果导航栏图像中有任何透明部分，那么底部的灰色像素背景图像应该是可见的。

[http://i.stack.imgur.com/iHjVg.jpg](http://i.stack.imgur.com/iHjVg.jpg)

我假设的解决方案是，如果背景图像可以一直缩放到导航栏部分后面的顶部。在这种情况下，如果导航栏图像中有透明度，则像素背景将是可见的。

请建议是否有人有实现这一目标的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:35:45.913

如果有人遇到类似情况，答案是如下设置视图的边界，使其在 UINavigationBar 下移动一点

```
self.view.bounds = CGRectMake(0.0, 10.0, 320.0, 480.0); 
```

因此，这通过 UINavigationBar 显示背景

# c++ - 如何实现可选模板参数？

> ID：10710159
> 
> 赞同：2
> 
> 时间：2012-05-22T21:05:11.523
> 
> 标签：c++, templates, boost

如何实现可选模板参数？

我想要一个 class `MyStruct<T1,T2,T3>`，它只允许使用第一个或前两个参数。现在，处理的函数也`MyStruct<T1,T2,T3>`应该以某种方式正确处理未使用的模板参数。

例子：

```
#include <iostream>

template<class T1, class T2, class T3>
struct MyStruct {
  T1 t1; T2 t2; T3 t3;
  MyStruct() {}
  MyStruct(T1 const& t1_, T2 const& t2_, T3 const& t3_)
    : t1(t1_), t2(t2_), t3(t3_) {}
};

template<class T1, class T2, class T3>
MyStruct<T1, T2, T3> myplus(MyStruct<T1, T2, T3> const& x,
                MyStruct<T1, T2, T3> const& y) {
  return MyStruct<T1, T2, T3>(x.t1 + y.t1, x.t2 + y.t2, x.t3 + y.t3);
}

int main() {
  typedef MyStruct<int, double, std::string> Struct;
  Struct x(2, 5.6, "bar");
  Struct y(6, 4.1, "foo");
  Struct result = myplus(x, y);
  // (8, 9.7, "barfoo")
  std::cout << result.t1 << "," << result.t2 << "," << result.t3;
} 
```

现在我想更改代码以使上述`main()`功能仍然有效，但以下功能也可以：

```
typedef MyStruct<std::string, int> Struct;
// result: ("barfoo", 5)
Struct result = myplus(Struct("bar", 2), Struct("foo", 3)); 
```

或这个：

```
typedef MyStruct<int> Struct;
// result: (5)
Struct result = myplus(Struct(2), Struct(3)); 
```

我认为`boost::tuple`使用了类似的技巧，您可以在其中使用`boost::tuple<A>`, `boost::tuple<A,B>`, `boost::tuple<A,B,C>`，但我不确定他们是如何做到的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:11:42.563

您可以在 C++11 中使用可变参数模板来执行此操作（更难且更复杂的选项）；或者，您可以使用默认模板参数，如 Boost.Tuple：

```
// boost/tuple/tuple/detail/tuple_basic.hpp

// -- null_type --------------------------------------------------------
struct null_type {};

//...

// - tuple forward declaration -----------------------------------------------
template <
  class T0 = null_type, class T1 = null_type, class T2 = null_type,
  class T3 = null_type, class T4 = null_type, class T5 = null_type,
  class T6 = null_type, class T7 = null_type, class T8 = null_type,
  class T9 = null_type>
class tuple; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T21:11:52.650

如果我理解正确，您应该能够为您的模板传递默认参数：

```
template<class T1, class T2 = Default, class T3 = Default> 
```

您可以在其中替换任何类型的`Default`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T21:10:34.307

您可以制作一个故意的“未使用”类型：

```
namespace detail { struct unused { }; }

template <typename T1, typename T2 = detail::unused, typename T3 = detai::unused>
struct MyStruct
{
    typedef T1 type1;
    typedef T2 type2;
    typedef T3 type3;

    explicit MyStruct(type1 const & t1,
                      type2 const & t2 = type2(),
                      type3 const & t3 = type3())
    : x1(t1), x2(t2), x3(t3)
    {  }

private:
    type1 x1;
    type2 x2;
    type3 x3;
}; 
```

# c - 无法同时播放两种声音

> ID：10710161
> 
> 赞同：2
> 
> 时间：2012-05-22T21:05:16.573
> 
> 标签：c, fmod

有人能解释一下为什么我不能同时播放两种声音吗？

这是代码的一部分：

```
#include <fmod.h>

FMOD_SYSTEM *system;
FMOD_SOUND *dooropen;
FMOD_SOUND *keydoor;
FMOD_SOUND *slap;
FMOD_SOUND *bomb;
FMOD_SOUND *scratch;
FMOD_SOUND *secret;
FMOD_SOUND *pickey;
FMOD_SOUND *caisse;

FMOD_RESULT resultat1;
FMOD_RESULT resultat2;
FMOD_RESULT resultat3;
FMOD_RESULT resultat4;
FMOD_RESULT resultat5;
FMOD_RESULT resultat6;
FMOD_RESULT resultat7;
FMOD_RESULT resultat8;

FMOD_System_Create(&system);
FMOD_System_Init(system, 1, FMOD_INIT_NORMAL, NULL);

resultat1 = FMOD_System_CreateSound(system, "sound/door-open.mp3", FMOD_CREATESAMPLE, 0, &dooropen);

resultat2 = FMOD_System_CreateSound(system, "sound/key-door.wav", FMOD_CREATESAMPLE, 0, &keydoor);

resultat3 = FMOD_System_CreateSound(system, "sound/slap.wav", FMOD_CREATESAMPLE, 0, &slap);

resultat4 = FMOD_System_CreateSound(system, "sound/bomb.wav", FMOD_CREATESAMPLE, 0, &bomb);

resultat5 = FMOD_System_CreateSound(system, "sound/scratch.wav", FMOD_CREATESAMPLE, 0, &scratch);

resultat6 = FMOD_System_CreateSound(system, "sound/secret.wav", FMOD_CREATESAMPLE, 0, &secret);

resultat7 = FMOD_System_CreateSound(system, "sound/pickey.wav", FMOD_CREATESAMPLE, 0, &pickey);

resultat8 = FMOD_System_CreateSound(system, "sound/caisse.wav", FMOD_CREATESAMPLE, 0, &caisse); 
```

我这样称呼我的声音：

```
FMOD_System_PlaySound(system, FMOD_CHANNEL_FREE, scratch, 0, NULL);
FMOD_System_PlaySound(system, FMOD_CHANNEL_FREE, bomb, 0, NULL); 
```

我认为有一个频道问题，因为当我播放“炸弹”时，我能听到它（这个声音大约是 3 秒），但如果“刮擦”的声音发生，“炸弹”的声音就会停止......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T01:45:21.060

第二个参数`FMOD_System_Init()`是maxchannels。只需将其设置为 2 或更高。在官方教程中，他们使用 100。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:33:33.143

尝试为您想要同时播放的声音量创建新系统，或者您可以尝试使用 FSOUND_Play 而不是 FSOUND_Init。

或者您也可以查看 Hekkus 音响系统。我已经将它用于多种声音并且可以使用，但它不支持 mp3。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-15T21:04:13.003

如前所述，使用更多频道初始化系统
**并**在每个频道之后
更新。 `FMOD_SYSTEM``FMOD_System_PlaySound`

只需插入

```
FMOD_System_Update(system); 
```

然后就没事了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-09T20:20:50.893

每个声音创建一个通道，它可以正常工作或使用 FMOD_CHANNEL_FREE

# java - maven javadoc - overviewsummay.html 没有得到更新

> ID：10710173
> 
> 赞同：2
> 
> 时间：2012-05-22T21:07:20.103
> 
> 标签：java, maven-2

我有多模块项目

```
Proj
 +ModuleA
   src
     main
       java
     overview.html
   pom.xml
 +ModuleB
   pom.xml
pom.xml 
```

我正在尝试为这些模块生成 javadoc。我想在overviewsummary.html 中添加overview.html。我将 overview.html 放在 moduleA/src/main 下，但它没有更新概述摘要页面。

```
 <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-javadoc-plugin</artifactId>
         <version>2.8.1</version>
         <configuration>
        <stylesheetfile>javadoc.css</stylesheetfile>
        <overview>${basedir}\moduleA\src\main\overview.html</overview>
         </configuration>
        <executions>
           <execution>
            <id>attach-javadocs</id>
            <goals>
                   <goal>jar</goal>
            </goals>
            <configuration>
               <show>private</show>
            </configuration>
            </execution>
        </executions>
   </plugin> 
```

我查看了文档[http://docs.oracle.com/javase/6/docs/tooldocs/windows/javadoc.html#overview](http://docs.oracle.com/javase/6/docs/tooldocs/windows/javadoc.html#overview)，对我来说一切都很好。我的路有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T17:55:18.140

我可以通过使用以下配置来解决这个问题

```
 <overview>${project.build.sourceDirectory}/overview.html</overview> 
```

我们将不得不使用 ${project.build.sourceDirectory}，${basedir} 似乎不起作用。将overview.html 放在/src/main/java 目录下。如果还有多模块项目，请将overview.html 放在任何模块的源目录下（即src/main/java）。

# c++ - 围绕 z 轴旋转一个点

> ID：10710175
> 
> 赞同：3
> 
> 时间：2012-05-22T21:07:21.923
> 
> 标签：c++, algorithm, math, 3d, rotation

我在 3D 空间中有 3 个向量。我们称它们`xaxis`为 、`yaxis`和`zaxis`。`point`这些向量以3D 空间中的任意位置为中心。我有兴趣将`xaxis`和`yaxis`向量围绕`zaxis`向量旋转若干度`θ`。

对于以下代码，其值是任意且不重要的：

```
double xaxis[3], yaxis[3], zaxis[3], point[3], theta; 
```

我将如何进行旋转和`xaxis`按`yaxis`度？`zaxis``theta`

**未来注意：这些尝试不起作用。请参阅我在 BlueRaja-DannyPflughoeft 的帮助下找到的正确解决方案的答案**

我对基于矩阵的旋转的尝试：

```
double rx[3][3];
double ry[3][3];
double rz[3][3];
double r[3][3];

rx[0][0] = 1;
rx[0][1] = 0;
rx[0][2] = 0;

rx[1][0] = 0;
rx[1][1] = cos(theta);
rx[1][2] = sin(theta);

rx[2][0] = 0;
rx[2][1] = -1.0 * sin(theta);
rx[2][2] = cos(theta);

ry[0][0] = cos(theta);
ry[0][1] = 0;
ry[0][2] = -1.0 * sin(theta);

ry[1][0] = 0;
ry[1][1] = 1;
ry[1][2] = 0;

ry[2][0] = sin(theta);
ry[2][1] = 0;
ry[2][2] = cos(theta);
//No rotation wanted on the zaxis
rz[0][0] = cos(0);
rz[0][1] = sin(0);
rz[0][2] = 0;

rz[1][0] = -1.0 * sin(0);
rz[1][1] = cos(0);
rz[1][2] = 0;

rz[2][0] = 0;
rz[2][1] = 0;
rz[2][2] = 1;

vtkMath::Multiply3x3(rx, ry, r); //Multiplies rx by ry and stores into r
vtkMath::Multiply3x3(r, rz, r); //Multiplies r by rz and stores into r

vtkMath::Multiply3x3(r, xaxis, xaxis);//multiplies a 3x3 by a 3x1
vtkMath::Multiply3x3(r, yaxis, yaxis);//multiplies a 3x3 by a 3x1 
```

此尝试仅在飞机位于 xy 平面时才有效：

```
double x, y;
x = xaxis[0];
y = xaxis[1];
xaxis[0] = x * cos(theta) - y * sin(theta);
xaxis[1] = x * sin(theta) + y * cos(theta);

x = yaxis[0];
y = yaxis[1];
yaxis[0] = x * cos(theta) - y * sin(theta);
yaxis[1] = x * sin(theta) + y * cos(theta); 
```

使用 BlueRaja-DannyPflughoeft 给出的轴角方法：

```
double c = cos(theta);
double s = sin(theta);
double C = 1.0 - c;

double Q[3][3];
Q[0][0] = xaxis[0] * xaxis[0] * C + c;
Q[0][1] = xaxis[1] * xaxis[0] * C + xaxis[2] * s;
Q[0][2] = xaxis[2] * xaxis[0] * C - xaxis[1] * s;

Q[1][0] = xaxis[1] * xaxis[0] * C - xaxis[2] * s;
Q[1][1] = xaxis[1] * xaxis[1] * C + c;
Q[1][2] = xaxis[2] * xaxis[1] * C + xaxis[0] * s;

Q[2][0] = xaxis[1] * xaxis[2] * C + xaxis[1] * s;
Q[2][1] = xaxis[2] * xaxis[1] * C - xaxis[0] * s;
Q[2][2] = xaxis[2] * xaxis[2] * C + c;

double x = Q[2][1] - Q[1][2], y = Q[0][2] - Q[2][0], z = Q[1][0] - Q[0][1];
double r = sqrt(x * x + y * y + z * z);

//xaxis[0] /= r;
//xaxis[1] /= r;
//xaxis[2] /= r;

xaxis[0] = x;// ?
xaxis[1] = y;
xaxis[2] = z; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:28:27.030

感谢 BlueRaja - Danny Pflughoeft：

```
double c = cos(theta);
double s = sin(theta);
double C = 1.0 - c;

double Q[3][3];
Q[0][0] = zaxis[0] * zaxis[0] * C + c;
Q[0][1] = zaxis[1] * zaxis[0] * C + zaxis[2] * s;
Q[0][2] = zaxis[2] * zaxis[0] * C - zaxis[1] * s;

Q[1][0] = zaxis[1] * zaxis[0] * C - zaxis[2] * s;
Q[1][1] = zaxis[1] * zaxis[1] * C + c;
Q[1][2] = zaxis[2] * zaxis[1] * C + zaxis[0] * s;

Q[2][0] = zaxis[0] * zaxis[2] * C + zaxis[1] * s;
Q[2][1] = zaxis[2] * zaxis[1] * C - zaxis[0] * s;
Q[2][2] = zaxis[2] * zaxis[2] * C + c;

xaxis[0] = xaxis[0] * Q[0][0] + xaxis[0] * Q[0][1] + xaxis[0] * Q[0][2];
xaxis[1] = xaxis[1] * Q[1][0] + xaxis[1] * Q[1][1] + xaxis[1] * Q[1][2];
xaxis[2] = xaxis[2] * Q[2][0] + xaxis[2] * Q[2][1] + xaxis[2] * Q[2][2]; // Multiply a 3x3 by 3x1 and store it as the new rotated axis

yaxis[0] = yaxis[0] * Q[0][0] + yaxis[0] * Q[0][1] + yaxis[0] * Q[0][2];
yaxis[1] = yaxis[1] * Q[1][0] + yaxis[1] * Q[1][1] + yaxis[1] * Q[1][2];
yaxis[2] = yaxis[2] * Q[2][0] + yaxis[2] * Q[2][1] + yaxis[2] * Q[2][2]; // Multiply a 3x3 by 3x1 and store it as the new rotated axis 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-25T19:24:36.613

我看到下面的矩阵乘法是错误的！

如上所述，它可以与`xaxis[0]`

```
xaxis[0] = xaxis[0] * Q[0][0] + xaxis[0] * Q[0][1] + xaxis[0] * Q[0][2];

xaxis[0] = xaxis[0] * (Q[0][0] + Q[0][1] + Q[0][2]); 
```

这看起来不像矩阵乘法。它应该是：

```
xaxis1[0] = xaxis[0] * Q[0][0] + xaxis[1] * Q[0][1] + xaxis[2] * Q[0][2];
xaxis1[1] = xaxis[0] * Q[1][0] + xaxis[1] * Q[1][1] + xaxis[2] * Q[1][2];
xaxis1[2] = xaxis[0] * Q[2][0] + xaxis[1] * Q[2][1] + xaxis[2] * Q[2][2]; // Multiply a 3x3 by 3x1 and store it as the new rotated axis

yaxis1[0] = yaxis[0] * Q[0][0] + yaxis[1] * Q[0][1] + yaxis[2] * Q[0][2];
yaxis1[1] = yaxis[0] * Q[1][0] + yaxis[1] * Q[1][1] + yaxis[2] * Q[1][2];
yaxis1[2] = yaxis[0] * Q[2][0] + yaxis[1] * Q[2][1] + yaxis[2] * Q[2][2]; // Multiply a 3x3 by 3x1 and store it as the new rotated axis 
```

# design-patterns - 正确认识桥型

> ID：10710180
> 
> 赞同：5
> 
> 时间：2012-05-22T21:07:35.273
> 
> 标签：design-patterns, bridge

我是否正确理解桥接模式：

**前：**

```
 public class Main2 {
            @SuppressWarnings("unused")
            public static void main(String[] args) {
                Car car11 = new BadNativeCar();
                Car car12 = new GoodNativeCar();
                Car car21 = new BadForeignCar();
                Car car22 = new GoodForeignCar();
            }
        }

        interface Car{
            public void drive();
            public void stop();
        }

        class NativeCar implements Car{
            @Override
            public void drive() {
            }
            @Override
            public void stop() {
            }
        }

        class ForeignCar implements Car{
            @Override
            public void drive() {
            }
            @Override
            public void stop() {
            }
        }

        class GoodNativeCar extends NativeCar{
        }
        class BadNativeCar extends NativeCar{
        }
        class GoodForeignCar extends ForeignCar{
        }
        class BadForeignCar extends ForeignCar{
        } 
```

**后（桥）：**

```
 public class Main2 {
        public static void main(String[] args) {
            BadCar badCar = new BadCar();
            GoodCar goodCar = new GoodCar();
            CarAbstraction car11 = new NativeCar(badCar);
            CarAbstraction car12 = new NativeCar(goodCar);
            CarAbstraction car21 = new ForeignCar(badCar);
            CarAbstraction car22 = new ForeignCar(goodCar);
        }
    }

    interface CarAbstraction{
        public void drive();
        public void stop();
    }

    //Abstraction
    abstract class CarAbstractionImpl implements CarAbstraction{
        private CarImplementor carImplementor;

        public CarAbstractionImpl(CarImplementor carImplementor) {
            this.carImplementor = carImplementor;
        }

        @Override
        public void drive() {
            carImplementor.drive();
        }
        @Override
        public void stop() {
            carImplementor.stop();
        }
    }

    //RefinedAbstraction1
    class NativeCar extends CarAbstractionImpl{
        public NativeCar(CarImplementor carImplementor) {
            super(carImplementor);
        }
    }
    //RefinedAbstraction2
    class ForeignCar extends CarAbstractionImpl{
        public ForeignCar(CarImplementor carImplementor) {
            super(carImplementor);
        }
    }

    //Implementor
    interface CarImplementor extends CarAbstraction{
    }

    //ConcreteImplementor1
    class GoodCar implements CarImplementor{
        @Override
        public void drive() {
        }
        @Override
        public void stop() {
        }
    }

    //ConcreteImplementor2
    class BadCar implements CarImplementor{
        @Override
        public void drive() {
        }
        @Override
        public void stop() {
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T05:09:51.460

从您的问题中，我得到了以下类图：

**前：**

```
 ________Car_________
                    /                    \
               NativeCar              ForeignCar
               /       \              /        \
   GoodNativeCar   BadNativeCar GoodForeignCar  BadForeignCar 
```

**后：**

```
 CarAbstraction
                 |
         CarAbstractionImpl-------------HAS-A-------> CarImplementor
          /             \                              /          \
     NativeCar       ForeignCar                    GoodCar       BadCar 
```

如果我们在[http://www.oodesign.com/bridge-pattern.html](http://www.oodesign.com/bridge-pattern.html)查看桥接模式的类图，它看起来像桥接模式。但是，可以省略类层次结构 CarAbstraction--CarAbstractionImpl。意味着 CarAbstraction 有一个 CarImplementor 并且 NativeCar 和 ForeignCar 将被 CarAbstraction 继承。

所以，从类图中，它看起来像桥模式。

但是概念点呢？NativeCar 和 ForeignCar 是抽象还是它们也可以用作实现？它们可以与 GoodCar 和 BadCar 互换吗？这个事实也需要考虑。如果 NativeCar 和 ForeignCar 是抽象的，而 GoodCar 和 BadCar 作为实现，那么这种桥接模式适用于这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T08:24:43.003

As I understand you try to do something like:

```
 When:

        A
     /     \
    Aa      Ab
   / \     /  \
 Aa1 Aa2  Ab1 Ab2

Refactor to:

     A         N
  /     \     / \
Aa(N) Ab(N)  1   2 
```

(Got from here : [When do you use the Bridge Pattern? How is it different from Adapter pattern?](https://stackoverflow.com/questions/319728/when-do-you-use-the-bridge-pattern))

I am not very close familiar with Bridge Pattern but it looks right.

# django - Apache - 子域重定向

> ID：10710183
> 
> 赞同：1
> 
> 时间：2012-05-22T21:07:47.217
> 
> 标签：django, apache, .htaccess, mod-rewrite

当我使用一个应用程序执行此操作时，我正在使用 fcgi 运行 django 应用
程序，我的 .htaccess 文件看起来像

```
 Options +FollowSymLinks
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ app.fcgi/$1 [QSA, L] 
```

这很好用。

现在，我想在不同的子域上运行不同的应用程序。
所以我将为每个应用程序创建一个 *.fcgi 文件。
基本上，我想要做的是将请求重定向到 subdomain.mydomain.com 到 subdomain.fcgi 文件。

我试过这个，但没有用

```
 Options +FollowSymLinks
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{HTTP_HOST} ^(.*)\.mydomain\.com$
    RewriteRule ^(.*)$ %1.fcgi/$1 [QSA, L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:30:41.273

我已经解决了。

在 public_http 文件夹中，每个子域都有一个文件夹，在每个子域的文件夹中，我有一个 dispatch.fcgi 文件。.htaccess 文件现在是：

```
 Options +FollowSymLinks -Indexes 
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{HTTP_HOST} ^(.*)\.llulai\.com$
    RewriteRule ^(.*)$ %1/dispatch.fcgi/$1 [QSA,L] 
```

不利的一面是，在 url.py 文件中，url 模式应该以

```
 r'^subdomain/$' 
```

# objective-c - 引擎盖下的 __weak 限定变量是怎么回事？

> ID：10710188
> 
> 赞同：3
> 
> 时间：2012-05-22T21:08:07.560
> 
> 标签：objective-c, memory-management, automatic-ref-counting, weak-references

通常`weak`使用引用来避免应用程序对象图中的保留循环。我理解那部分。现在我想更进一步，了解它们是如何在幕后工作的。

搜索了一下，我读到当我使用`__weak`限定符时，与该限定符关联的变量注册在自动释放池中，但这意味着什么？为什么对象在池中注册？使用什么类型的池？是主池还是其他特别创建的池？

当我使用此代码时：

```
id _weak myWeakObj = [[NSObject alloc] init]; 
```

编译器给了我一个警告，我可以修复：

```
id _strong myStrongObj =  [[NSObject alloc] init];
id _weak myWeakObj = myStrongObj; 
```

那么，基于前面的问题，被引用的对象会发生什么`myStrongObj`？如果可能的话，我想知道编译器的代码是什么样的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T23:31:50.647

以下是你的朋友：

*   [http://clang.llvm.org/docs/AutomaticReferenceCounting.html](http://clang.llvm.org/docs/AutomaticReferenceCounting.html)

还有 Objective-C 运行时的源代码：

*   [http://www.opensource.apple.com/source/objc4/objc4-493.9/runtime/](http://www.opensource.apple.com/source/objc4/objc4-493.9/runtime/)

特别是，看看：

*   [http://www.opensource.apple.com/source/objc4/objc4-493.9/runtime/objc-arr.mm](http://www.opensource.apple.com/source/objc4/objc4-493.9/runtime/objc-arr.mm)
*   [http://www.opensource.apple.com/source/objc4/objc4-493.9/runtime/objc-weak.mm](http://www.opensource.apple.com/source/objc4/objc4-493.9/runtime/objc-weak.mm)

如果您查看`objc_initWeak`并`objc_destroyWeak`按照第一个链接的讨论，那么您将看到它是如何“在引擎盖下”工作的。胆量`weak_register_no_lock`用于注册弱引用和`weak_unregister_no_lock`取消注册弱引用。

我会留给你去看看它*实际上是*如何工作的所有错综复杂的:-)。

# eclipse - Eclipse PDT 工具提示在其中显示 html 标记和 css

> ID：10710190
> 
> 赞同：0
> 
> 时间：2012-05-22T21:08:10.817
> 
> 标签：eclipse, tooltip, ubuntu-12.04

Ubuntu 12.04 日食 3.7.2

它也有黑色背景的白色文本，但这已通过更改 gtkrc 文件中的 tooltip_*g_color 设置得到修复。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T04:39:52.970

```
$ sudo apt-get install libwebkitgtk-1.0-0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-01T08:06:41.643

```
sudo apt-get install libwebkitgtk-1.0-0 
```

将我的 Ubuntu 升级到 13.04 后，我在 Eclipse 上遇到了同样的问题。安装 libwebkitgtk 后它工作正常（我使用的是 Eclipse Kepler）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T13:43:35.717

这适用于从存储库运行 Eclipse 的 Lubuntu 12.10。显然 libwebkitgtk-1.0-0 不是依赖项，至少在 Lubuntu 中不是。

# java - 如何在 HashMap 中保留插入顺序？

> ID：10710193
> 
> 赞同：541
> 
> 时间：2012-05-22T21:08:23.260
> 
> 标签：java, hashmap

我正在使用一个`HashMap`. 当我遍历地图时，数据以（通常相同的）随机顺序返回。但是数据是按特定顺序插入的，我需要保留插入顺序。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1175
> 
> 时间：2012-05-22T21:09:18.240

[`LinkedHashMap`](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedHashMap.html)正是您正在寻找的。

它与 完全一样`HashMap`，只是当您对其进行迭代时，它会按插入顺序显示项目。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2012-05-22T21:11:56.880

[`HashMap`](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)根据文档的第二行是无序的：

> 此类不保证地图的顺序；特别是，它不保证订单会随着时间的推移保持不变。

也许您可以按照 aix 的建议进行操作并使用`LinkedHashMap`或其他有序集合。查看 javapractices.com 关于[选择正确集合](http://www.javapractices.com/topic/TopicAction.do?Id=65)的指南。

# android - android中的NumberFormatException，parseDouble GeoPoint

> ID：10710196
> 
> 赞同：0
> 
> 时间：2012-05-22T21:08:32.423
> 
> 标签：android

我的 android 应用程序有这个问题

我已经为此苦苦挣扎了一段时间，并且经历了很多类似的线程，但从未真正解决它。我还没有设法重新创建我自己的崩溃，但我从其他用户那里得到了崩溃报告

**这是一个崩溃报告：**

```
java.lang.NumberFormatException: -
at org.apache.harmony.luni.util.FloatingPointParser.initialParse(FloatingPointParser.java:149)
at org.apache.harmony.luni.util.FloatingPointParser.parseDouble(FloatingPointParser.java:281)
at java.lang.Double.parseDouble(Double.java:318)
at polis.koll.HelloMapView.loadallmarkers(HelloMapView.java:665)
at polis.koll.HelloMapView.access$10(HelloMapView.java:611)
at polis.koll.HelloMapView$6.run(HelloMapView.java:587)
at java.lang.Thread.run(Thread.java:1027) 
```

**这是我的代码，**最后一行似乎是生成错误的代码

```
 SAXParserFactory spf = SAXParserFactory.newInstance();
        SAXParser sp = spf.newSAXParser();
        XMLReader xr = sp.getXMLReader();

        /** Send URL to parse XML Tags */
        URL sourceUrl = new URL(
        "http://www.mysite.com/xml.php");

        /** Create handler to handle XML Tags ( extends DefaultHandler ) */
        MyXMLHandler myXMLHandler = new MyXMLHandler();
        xr.setContentHandler(myXMLHandler);
        xr.parse(new InputSource(sourceUrl.openStream()));
        } catch (Exception e) {
        //System.out.println("XML Pasing Excpetion = " + e);
        }

        sitesList = MyXMLHandler.sitesList;
        gotsnr = "";
        gotmarkers = 0;
        LocationOverlay locationOverlay = new LocationOverlay(mapView, getResources().getDrawable(R.drawable.polis), mContext);

        if (sitesList !=null){
        for (int i = 0; i < sitesList.getSnr().size(); i++) {
        gotsnr = sitesList.getSnr().get(i);
        gotmarkers = (i);
        //if (gotsnr !=""){ 
        if (sitesList.getLat().get(i).equalsIgnoreCase("")||sitesList.getLat().get(i).equalsIgnoreCase(null)){
            // Empty, do nothing

        } else{

        GeoPoint point = new GeoPoint( new Double(Double.parseDouble(sitesList.getLat().get(i)) * 1e6).intValue() , new Double(Double.parseDouble(sitesList.getLng().get(i)) * 1e6).intValue()); 
```

*****编辑下方回复@kcoppock

这可以解决问题吗？

```
double dlat = 0;
double dlng = 0;

            if (sitesList.getLat().get(i) !=null && !"".equals(sitesList.getLat().get(i)) ){
                    try {
                       dlat = Double.parseDouble(sitesList.getLat().get(i));
                    } catch (NumberFormatException e) {
                       //System.out.println(e.getMessage());
                    }
                }
            if (sitesList.getLng().get(i) !=null && !"".equals(sitesList.getLng().get(i)) ){
                try {
                    dlng = Double.parseDouble(sitesList.getLng().get(i));
                } catch (NumberFormatException e) {
                   //System.out.println(e.getMessage());
                }
            }

            if (dlat !=0  && dlng !=0){

            GeoPoint point = new GeoPoint( new Double(dlat * 1e6).intValue() , new Double(dlng * 1e6).intValue()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:14:01.743

你一开始就没有处理`NumberFormatException`，即使你没有崩溃，这也是不好的做法。拆分该行，首先解析双打，并确保捕获`NumberFormatException`并适当处理它（例如，抛出警报对话框，放置默认值等）以防由于某种原因该值`getLat()`或`getLon()`不可解析，即在这些情况下显然发生了什么。

```
double lat = 0, lng = 0;
String sLat = sitesList.getLat().get(i);
String sLng = sitesList.getLng().get(i);
GeoPoint point;

try {
    lat = Double.parseDouble(sLat);
    lng = Double.parseDouble(sLng);

    //If it gets here, they parsed successfully
    point = new GeoPoint((int)(lat * 1e6), (int)(lng * 1e6));
} catch (NumberFormatException e) {
    Log.e("TAG", "Couldn't parse latitude and/or longitude");
} 
```

# c# - 将新行插入访问

> ID：10710197
> 
> 赞同：1
> 
> 时间：2012-05-22T21:08:37.260
> 
> 标签：c#, ado.net, ms-access-2007

也许我做错了，但我正在尝试使用 ado.net 将新行插入表中。不过，它告诉我语法是错误的。

```
customers = new DataTable("Customers");
cmd = "SELECT * FROM Customers";
con = new OleDbDataAdapter(cmd, strconn);
con.FillSchema(customers, SchemaType.Source);
con.Fill(customers);
DataRow cur;
cur = customers.NewRow();
cur["Company"] = textBoxCompany.Text;
cur["First Name"] = textBoxFirstName.Text;
cur["Last Name"] = textBoxLastName.Text;
cur["E-mail Address"] = textBoxEmail.Text;
cur["Job Title"] = textBoxTitle.Text;
cur["Business Phone"] = textBoxPhone.Text;
customers.Rows.Add(cur);
OleDbCommandBuilder cb = new OleDbCommandBuilder(con);
con.InsertCommand = cb.GetInsertCommand();           
con.InsertCommand.Parameters.AddWithValue("Company",cur["Company"]);
con.InsertCommand.Parameters.AddWithValue("Last Name",cur["Last Name"]);
con.InsertCommand.Parameters.AddWithValue("First Name", cur["First Name"]);
con.InsertCommand.Parameters.AddWithValue("E-Mail Address",cur["E-mail Address"]);
con.InsertCommand.Parameters.AddWithValue("Job Title",cur["Job Title"]);
con.InsertCommand.Parameters.AddWithValue("Business Phone",cur["Business Phone"]);
con.Update(customers); 
```

“INSERT INTO 语句中的语法错误。”

堆栈跟踪：

```
at System.Data.Common.DbDataAdapter.UpdatedRowStatusErrors(RowUpdatedEventArgs rowUpdatedEvent, BatchCommandInfo[] batchCommands, Int32 commandCount)
at System.Data.Common.DbDataAdapter.UpdatedRowStatus(RowUpdatedEventArgs rowUpdatedEvent, BatchCommandInfo[] batchCommands, Int32 commandCount)
at System.Data.Common.DbDataAdapter.Update(DataRow[] dataRows, DataTableMapping tableMapping)
at System.Data.Common.DbDataAdapter.UpdateFromDataTable(DataTable dataTable, DataTableMapping tableMapping)
at System.Data.Common.DbDataAdapter.Update(DataTable dataTable)
at Project2.Form1.button1_Click(Object sender, EventArgs e) in Form1.cs:line 54 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:24:23.817

根据[this documentation](http://msdn.microsoft.com/en-us/library/tf579hcz.aspx) on command generation

> 如果列名或表名包含任何特殊字符，例如空格、句点、引号或其他非字母数字字符，即使由括号分隔，自动命令生成逻辑也会失败。支持catalog.schema.table 形式的完全限定表名。

由于您的列名有空格，因此查询将不起作用。您将不得不手动创建插入语句，这非常简单。只需在所有列名周围加上括号，并为没有空格或特殊字符的值使用参数。

```
INSERT INTO [TableName] ([Column1], [Column2], ...)
VALUES (@Column1, @Column2, ...) 
```

您也可以在创建参数时使用这些参数名称：

```
con.InsertCommand.Parameters.AddWithValue("@column1", cur["..."]); 
```

# com - 在 WiX 中使用 .reg 文件注册 DLL

> ID：10710198
> 
> 赞同：1
> 
> 时间：2012-05-22T21:08:48.520
> 
> 标签：com, wix, registry, regasm

### 问题的背景

我目前正在尝试整合一种分发我正在处理的新项目的方法，该项目需要在用户系统上注册一个 COM 公开的 .NET DLL，因为我是 WiX 的新手并正在迁移到它为此，我试图让事情尽可能简单。

### 问题

我的 DLL 注册的最大问题是 regasm 将 InProcServer32 键的默认值设置为“mscoree.dll”，但我的 DLL 似乎只能在使用它的完整路径时被实例化，例如“C:\Windows\ SysWow64\mscoree.dll"

目前我在我的安装项目中有一个自定义操作（我想放弃使用 WiX），它将调用 SearchPath API 来查找 mscoree.dll 的完整路径并用完整路径覆盖默认值，以便 DLL 可以实例化没有任何问题。

### 建议的解决方案/问题

由于我是 WiX 的新手，所以我有准备一个 .reg 文件的想法，该文件将包含进入 CLSID 树的所有必要信息，然后让 WiX 以某种方式执行该文件。

我的问题是：

1.  以这种方式注册 DLL 是否存在任何固有缺陷？
2.  由于我试图在这里找到解决方法的主要原因是 mscoree.dll 问题，在 WiX 中是否有任何本地方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T02:02:40.987

看看名为“Heat”的 WiX 程序。这可以“收获”您的 DLL，包括与 RegAsm / COMVisible 部分相关的注册表信息。然后，您可以剪切此代码并将其放入您的 wxs 文件中。

您还可以使用 Regasm /regfile，然后将该信息手动转换为 RegistryValue 元素。

关于您的路径问题，请使用[SystemFolder 属性](https://www.google.com/search?q=SystemFolder%20property&sourceid=ie7&rls=com.microsoft%3aen-us%3aIE-Address&ie=&oe=)。

```
[SystemFolder]mscoree.dll 
```

如果您将安装标记为 32 位 (x86)，这将在 64 位操作系统上运行时自动解析为 SysWow64 文件夹，在 32 位操作系统上运行时自动解析为 System32 文件夹。

# java - OpenGL“无效操作错误”在Android手机上的glDrawElements函数之后

> ID：10710199
> 
> 赞同：6
> 
> 时间：2012-05-22T21:08:53.977
> 
> 标签：java, android, opengl-es

我无法在手机上运行我的应用程序，并且我找到了错误，但缺乏编程和英语知识来修复它。该应用程序在模拟器上完美运行，在opengl中也没有任何代码错误。然而在手机上，一切运行良好，没有任何错误，但没有显示我想要绘制的 opengl 元素。`glGetError`我几乎在我的代码中添加了所有内容，发现之后生成的错误 1282`glDrawElements`是`GL_INVALID_OPERATION`.

`GL_INVALID_OPERATION`如果非零缓冲区对象名称绑定到启用的数组或元素数组并且缓冲区对象的数据存储当前已映射，则生成。

`GL_INVALID_OPERATION`如果 glDrawElements 在 glBegin 的执行和对应的 glEnd 之间执行，则生成。

我的代码中没有 glBegin 或 glEnd，所以我想问题出在我的索引缓冲区中。下面我将向您展示我对 indexbuffer 的所有内容。

```
private ShortBuffer _indexBuffer;

    public void onDrawFrame(GL10 gl) {
    FramesPerSecond.StartCounter();
    gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);
    gl.glVertexPointer(3, GL10.GL_FLOAT, 0, _vertexBuffer);
    gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[0]);
    gl.glEnableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
    gl.glTexCoordPointer(2, GL10.GL_FLOAT, 0, textureBuffer);

    for (int i = 1; i <= 10; i++) {
        gl.glLoadIdentity();
        gl.glTranslatef(0.0f, -1f, -1.0f + -1.5f * i);

        gl.glRotatef(-_xAngle, 1f, 0f, 0f);
        gl.glRotatef(-_yAngle, 0f, 1f, 0f);
        gl.glDrawElements(GL10.GL_TRIANGLES, _nrOfVertices, GL10.GL_UNSIGNED_SHORT, _indexBuffer);            
        Log.e("Warning", " error code " +gl.glGetError());
    } 
```

我的对象初始化函数中的缓冲区代码：

```
 short[] indeksai = new short[] {
            0, 1, 3, 
            0, 2, 1, 
            0, 3, 2, 
            1, 2, 3, 
    };

    ByteBuffer ibb = ByteBuffer.allocateDirect(indeksai.length * 2);
    ibb.order(ByteOrder.nativeOrder());
    _indexBuffer = ibb.asShortBuffer();
    _indexBuffer.put(indeksai); 
```

这基本上就是我用这个缓冲区所做的一切。

在surfaceCreated函数上>>

```
public void onSurfaceCreated(GL10 gl, EGLConfig config) {

    Log.i(LOG_TAG, "onSurfaceCreated()");
    gl.glMatrixMode(GL10.GL_PROJECTION);
    float ratio = _width / _height;
    gl.glOrthof(-1, 1, -1 / ratio, 1 / ratio, 0.01f, 100.0f);
    gl.glViewport(0, 0, (int) _width, (int) _height);
    gl.glMatrixMode(GL10.GL_MODELVIEW);
    gl.glEnable(GL10.GL_DEPTH_TEST);

gl.glClearColor(0f, 0f, 0f, 1.0f);
gl.glEnable(GL10.GL_CULL_FACE);
gl.glFrontFace(GL10.GL_CCW);
gl.glCullFace(GL10.GL_BACK);
gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
gl.glEnableClientState(GL10.GL_COLOR_ARRAY);
initTriangle(gl, context);
try {
loadGLTexture(gl);
    } catch (IOException e) {
   Log.w(LOG_TAG, "Texture fail");
    }
   gl.glEnable(GL10.GL_TEXTURE_2D);            
   gl.glShadeModel(GL10.GL_SMOOTH);            
   gl.glClearColor(0.0f, 0.0f, 0.0f, 0.5f);    
   gl.glClearDepthf(1.0f);                     
   gl.glEnable(GL10.GL_DEPTH_TEST);            
   gl.glDepthFunc(GL10.GL_LEQUAL);             
  gl.glHint(GL10.GL_PERSPECTIVE_CORRECTION_HINT, GL10.GL_NICEST);

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T21:52:34.943

这很可能是因为您启用`GL_COLOR_ARRAY`但从未实际设置`glColorPointer`. 尝试注释掉该`gl.glEnableClientState(GL10.GL_COLOR_ARRAY);`行。

# php - 避免在刷新时上传图片

> ID：10710204
> 
> 赞同：2
> 
> 时间：2012-05-22T21:09:06.570
> 
> 标签：php, forms, file-upload

我正在使用最简单的图像上传形式，我非常希望保持这种方式，只需要一些 php。

代码看起来像这样

```
<form action="index.php" method="POST" enctype="multipart/form-data">
<input type="file" name="image">
<input type="submit" value="Upload image">
</form>

<?php
$image = addslashes(file_get_contents($_FILES['image'][tmp_name]));
mysql_query("INSERT INTO store_images VALUES ('','$image')");
?> 
```

我选择一张图片，上传它并点击刷新一次/两次。当我查看表“store_images”时，图像已上传两次/三次/等。

在不破坏上传另一张图片的选项的情况下，如何避免这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:12:55.860

首先：

`mysql_*`请停止使用古老的功能编写新代码。它们不再被维护并且社区已经开始了[弃用过程](http://goo.gl/KJveJ)。相反，您应该了解[准备好的语句](http://goo.gl/vn8zQ)并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)。如果你不能决定，[这篇文章](http://goo.gl/3gqF9)将有助于选择。如果你想学习，[这里有一个相当不错的 PDO 相关教程](http://goo.gl/vFWnC)。

现在解决您的问题：

您应该在成功上传图像后进行重定向`header('Location: http://example.com/the/address')`。这甚至可以是同一页。因为您进行了重定向，所以数据不再在页面上，也不会再次插入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T21:12:49.003

使用表单生成随机数、散列或类似内容，并将其与您的图像一起插入到数据库中。在插入之前检查数据库中的现有哈希。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:11:15.057

检查`$image`db 中 first 的值，仅当它不存在时，上传/插入

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-22T21:16:01.527

如果您希望表中没有文件重复（建议这样做），则创建文件的[md5 哈希](http://php.net/manual/en/function.md5-file.php)并将其存储在文件的列中，并使 md5 列唯一。

如果您确实希望在表中重复文件，则执行与上述完全相同的操作，仅使 md5 列和文件名唯一。这应该允许不同的用户以不同的名称再次插入相同的图片。

如果您希望允许具有相同名称的文件重复，请执行@jimpic 建议的操作。这应该允许您或任何其他用户插入具有相同文件名的同一文件的副本，但前提是您是故意这样做的。

每次插入后不要重定向到另一个页面。如果可以的话，最好不要停止正常的浏览器后退/前进功能。对用户来说，感觉就像一页刷新，而实际上对浏览器来说，他们的行为就像 2 并惹恼了人们，因为后退按钮会询问“你想重新发送表单数据”。

# sql - 使用 WHERE 删除 - 日期、时间和字符串比较 - 非常慢

> ID：10710211
> 
> 赞同：4
> 
> 时间：2012-05-22T21:09:59.940
> 
> 标签：sql, sql-server, performance, sql-server-2008, tsql

我的查询执行速度很慢，希望对 sql 有更多了解的人可以帮助我提高性能：

我有 2 个表，一个 Source 和一个 Common，我加载了一些包含 Date、Time 和 String（其中是服务器名称）的数据，以及一些..

源表可以包含 40k+ 行（它有 30 个奇数列，整数、日期、时间和一些 varchars (255)/(Max)

我使用以下查询从 Common 中删除源中的所有数据：

`'Delete from Common where convert(varchar(max),Date,102)+convert(varchar(max),Time,108)+[ServerName] in (Select convert(varchar(max),[date],102)+convert(varchar(max),time,108)+ServerName from Source where sc_status < 300)'`

**源字段采用以下格式：**

*   服务器名称 varchar(255) ***IE*** *SN1234*
*   日期 varchar(255) ***IE*** *2012-05-22*
*   时间 varchar(255) ***IE*** *08:12:21*

**公共字段采用以下格式：**

*   服务器名称 varchar(255) ***IE*** *SN1234*
*   日期日期***IE*** *2011-08-10*
*   时间时间(7) ***IE*** *14:25:34.0000000*

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T21:30:36.850

将两边都转换为字符串，然后将它们连接成一个大字符串，然后比较这些结果不是很有效。只在必要的地方进行转换。试试这个例子，看看它是如何比较的：

```
DELETE c
  FROM dbo.Common AS c
  INNER JOIN dbo.Source AS s
  ON s.ServerName = c.ServerName
  AND CONVERT(DATE, s.[Date]) = c.[Date]
  AND CONVERT(TIME(7), s.[Time]) = c.[Time]
  WHERE s.sc_status < 300; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:21:44.943

所有这些转换`VARCHAR(MAX)`都是不必要的，并且可能会减慢您的速度。我会从这样的事情开始：

```
DELETE c
from [Common] c
WHERE EXISTS(
    SELECT 1
    FROM Source
    WHERE CAST([Date] AS DATE)=c.[Date]
    AND CAST([Time] AS TIME(7))=c.[Time]
    AND [ServerName]=c.[ServerName]
    AND sc_status < 300
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:57:44.520

删除不必要的转换将有很大帮助，如 Aaron 的回答中所述。您还可以考虑在日志表的顶部创建一个索引视图，因为您可能在该模式中没有太大的灵活性或从日志解析器插入 DML。

简单的例子：

```
create table dbo.[Source] (LogId int primary key, servername varchar(255), 
   [date] varchar(255), [time] varchar(255));
insert into dbo.[Source]
    values  (1, 'SN1234', '2012-05-22', '08:12:21'),
            (2, 'SN5678', '2012-05-23', '09:12:21')
go

create view dbo.vSource with schemabinding
as
    select  [LogId],
            [servername], 
            [date], 
            [time], 
            [actualDateTime] = convert(datetime, [date]+' '+[time], 120)
    from    dbo.[Source];
go

create unique clustered index UX_Source on vSource(LogId);
create nonclustered index IX_Source on vSource(actualDateTime); 
```

这将为您提供一个索引日期时间列，以牺牲一些插入性能为代价，在该列上寻找并极大地改进您的执行计划。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T21:36:31.127

就像是

```
Delete from Common inner join Source 
On Common.ServerName = Source.ServerName 
and Common.Date = Convert(Date,Source.Date)
and Common.Time = Convert(Time, Source.Time)
And Source.sc_Status < 300 
```

如果在那之后它太慢了，那么你需要一些索引，可能在两个表上。

# iphone - 如何将多个数据发布到 Web 服务器

> ID：10710212
> 
> 赞同：0
> 
> 时间：2012-05-22T21:10:06.070
> 
> 标签：iphone, ios

我有以下用于将数据发布到 Web 服务器的代码，但它给了我空响应，我有多个数据，它们是：-

```
date,
 rig,
 driller,
 offsider-1,
 offsider-2,
 shift
,
project,
supervisoremail,
geologistemail,

comments,

plants[0][name-id],
plants[0][start-usage],
plants[0][end-usage],

consumables[0][category],
consumables[0][name-id],
consumables[0][used],
consumables[0][code],
consumables[0][description], 
```

我必须发布这些数据，并且我使用此代码进行发布，但它对我不起作用。请帮帮我。

```
NSURL *url=[NSURL URLWithString:@"http://www.mydor.com.au/staff/dor/idorInsert"];
    NSString *post =[[NSString alloc]initWithFormat:@"date=15/08/2012&rig=53&driller=207&offsider-1=131&offsider- 2=236&shift=day&project=24&supervisoremail=24&geologistemail=24&comments=&plants[0][name- id]=286&plants[0][start-usage]=1.0&plants[0][end-usage]=0.0"];
    NSLog(post);
    NSData *postData = [post dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];

    NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];

    NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:url];
    [request setHTTPMethod:@"POST"];
    [request setValue:postLength forHTTPHeaderField:@"Content-Length"];
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
    [request setHTTPBody:postData];
    [NSURLRequest setAllowsAnyHTTPSCertificate:YES forHost:[url host]];

    NSError *error;
    NSURLResponse *response;
    NSData *urlData=[NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
    NSLog(@"here u re");
    NSString *data=[[NSString alloc]initWithData:urlData encoding:NSUTF8StringEncoding];
    NSLog(@"here also called");
    NSLog(@"%@",data) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:57:30.183

这是一篇演示如何使用 iOS 应用程序使用 .NET Web 服务的文章。您可以使用文章中讨论的技术：

[http://www.highoncoding.com/Articles/809_Consuming__NET_Web_Services_in_an_iOS_Application.aspx](http://www.highoncoding.com/Articles/809_Consuming__NET_Web_Services_in_an_iOS_Application.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T00:10:19.573

我所做的几乎所有工作都涉及 .NET 和 iOS。[在这里](https://stackoverflow.com/questions/10618056/how-to-post-more-parameters-with-image-upload-code-in-ios/10618557#10618557)查看我一直编写和使用的网络类（基于 AFNetworking）。我更喜欢使用常规的 aspx 表单而不是 asmx 网络服务。我这样做是因为我不想将任何网络方法暴露给窥探的访问者，并且在以 aspx 形式返回任何内容之前，我会使用 API 密钥检查。如果您需要，我可以向您发送一个示例 .NET 代码（用 VB.NET 编写）。

# asp.net - Web 服务器实例？

> ID：10710214
> 
> 赞同：1
> 
> 时间：2012-05-22T21:10:09.473
> 
> 标签：asp.net

非常新手的问题，请见谅：

我正在创建一个 asp.net 网站。我假设当多人请求该页面时，每个人都会获得一个新的站点实例。但是，如果站点在服务器上使用 .jpg 图像并操作该图像，那么每个人是否也会获得该图像的一个实例，或者他们是否以某种方式共享该图像？我想我知道，这可能是一个愚蠢的问题，但我想问。

例如：用户登录站点，并将时间添加到计划中。根据时间表，将在图像 (grid.jpg) 上绘制一条蓝线，描绘每日时间线。然后将图像保存为 newgrid.jpg 并显示给用户。有没有办法让每个用户获得只有他们才能看到的图像实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:42:02.500

在 ASP.NET 中生成动态图像的一种好方法是使用`Handler`. [此处](https://stackoverflow.com/questions/21877/dynamically-rendering-aspimage-from-blob-entry-in-asp-net)的答案提供了一个很好的简单示例。在这种情况下，生成的图像永远不会触及本地文件系统，它只是在内存中生成，然后返回给客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:14:14.107

好吧，通常该站点对于所有用户来说总是相同的，但是为每个用户创建了具有您可以设置的特定设置的会话。所以是的，默认情况下所有人都会看到相同的更改（和相同的内容）。

# wpf - 找不到与引用'ElementName = Field'的绑定的源

> ID：10710218
> 
> 赞同：2
> 
> 时间：2012-05-22T21:10:16.350
> 
> 标签：wpf, binding, mvvm, contextmenu, datacontext

我在文本框上有一个上下文菜单，我试图将 isChecked 属性绑定到该文本框的 datacontext 中的属性之一，并使用值转换器。

我遇到的问题与这篇文章非常相似，我相信... [WPF MenuItem.Command 绑定到 ElementName 结果到 System.Windows.Data 错误：4：找不到参考绑定的源](https://stackoverflow.com/questions/2617122/wpf-menuitem-command-binding-to-elementname-results-to-system-windows-data-error)

在那里，Aran Mulholland 提出了 3 种不同的解决方案。我一直在努力工作，但还没有看到实际工作示例的是#2。我认为这是对 MVVM 最友好的方法，为此最优雅的方法……再说一次，我对此很陌生。

这是我的xml

```
<DataTemplate x:Key="SFTemplateWithContextMenu">
        <TextBlock x:Name="Field" Text="{Binding Path=FieldName}" >
         <TextBlock.ContextMenu>
              <!--<ContextMenu PlacementTarget="{Binding ElementName=Field}" > -->
                    <ContextMenu DataContext="{Binding RelativeSource={RelativeSource Mode=Self}, Path=PlacementTarget.DataContext}">
                    <MenuItem  Header="Rename..." />
                    <MenuItem Header="Field Type">
                        <MenuItem.Resources>
                            <Configurator:EnumToBooleanConverter x:Key="EnumToBooleanConverter" />
                        </MenuItem.Resources>
                    <!--<MenuItem  Header="String" IsCheckable="True" IsChecked="{Binding Path=PlacementTarget.DataContext.FieldType, RelativeSource={RelativeSource AncestorType={x:Type ContextMenu}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static Configurator:TypeDesc.String}, PresentationTraceSources.TraceLevel=High}"/>-->
                        <MenuItem  Header="String" IsCheckable="True" IsChecked="{Binding Path=FieldType, RelativeSource={RelativeSource AncestorType={x:Type ContextMenu}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static Configurator:TypeDesc.String}, PresentationTraceSources.TraceLevel=High}"/>
                    </MenuItem>
                </ContextMenu>
            </TextBlock.ContextMenu>
        </TextBlock>
    </DataTemplate> 
```

我正在使用 DataTemplate 填充以下列表框...

```
<ListBox DnD:DragDropHelper.IsDragSource="True"   Name="sourceFieldsLB" Height="238" HorizontalAlignment="Left" Margin="20,286,0,0" VerticalAlignment="Top" Width="150" ItemTemplate="{StaticResource SFTemplateWithContextMenu}"  ItemsSource="{Binding Selection.SourceFields, Mode=TwoWay}" AllowDrop="True" > 
```

我下载了 Snoop 以查看内部情况，看看发生了什么。我尝试了几种不同程度的失败方法。

注释掉的部分是我之前试图实现目标的方式。那里的问题是我得到了错误......“找不到与引用'elementname = Field'绑定的源”但是TextBlock使用Snoop显示它的名字是字段。

以我目前的方式，我可以看到文本块有一个本地名称范围，它的名称是 Field - 这是我所期望和想要的。ContextMenu 值表明它有一个带有 2 个项目的 ContextMenu ......这是正确的。因此，我单击 ContextMenu 来查看事物的外观和低端，然后发现 ContextMenu 没有 DataContext。

对此的任何帮助和指导都会非常有用。我不确定我在这里缺少什么。我环顾四周，每当有人似乎接近完成这项工作时，他们都会提到他们找到了一些“解决方法”或其他方法来做到这一点，但永远不会让它发挥作用。这必须有能力工作......我对这个太陌生了，看不到缺失的部分。

我知道可以做一个真正的 MVVM 方式......对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T10:28:43.873

Bryce，主要问题是 ContextMenus 不是标准可视化树的一部分，它们唯一的真正联系是通过 PlacementTarget 属性。因此，通常最好尽快将其连接起来。所以...

给定一个 ViewModel

```
public class ViewModel
{
    public string Field { get; set; }
    public string FieldType { get; set; }
} 
```

和一个主窗口

```
<Window x:Class="ContextMenuSample.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <TextBlock Text="{Binding Field}">
            <TextBlock.ContextMenu>
                <ContextMenu DataContext="{Binding RelativeSource={RelativeSource Self}, Path=PlacementTarget.DataContext}">
                    <MenuItem Header="{Binding FieldType}" />
                </ContextMenu>
            </TextBlock.ContextMenu>
        </TextBlock>
    </Grid>
</Window> 
```

还有一个 app.xaml.cs

```
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Windows;

namespace ContextMenuSample
{
    /// <summary>
    /// Interaction logic for App.xaml
    /// </summary>
    public partial class App : Application
    {
        protected override void OnStartup(StartupEventArgs e)
        {
            base.OnStartup(e);

            var shell = new MainWindow();
            shell.DataContext = new ViewModel { Field = "FirstName", FieldType = "String" };
            shell.Show();
        }
    }
} 
```

您可以看到 ContextMenu 的 DataContext 已通过该行正确连接

```
<ContextMenu DataContext="{Binding RelativeSource={RelativeSource Self}, Path=PlacementTarget.DataContext}"> 
```

并且您应该得到一个与底层 ViewWModel 对话的行为良好的 ContextMenu。

# actionscript-3 - Flash 对象的大小与屏幕上的大小不匹配

> ID：10710220
> 
> 赞同：2
> 
> 时间：2012-05-22T21:10:33.473
> 
> 标签：actionscript-3, flash

我创建了一个 64x64 的小图块来测试我的图块引擎，它像这样在循环中添加

```
var grass:Grass = new Grass();
grass.x = (x * TILE_SIZE);
grass.y = (y * TILE_SIZE);
grass.width = TILE_SIZE;
grass.height = TILE_SIZE;
container.addChild(grass);

public class Grass extends MovieClip {

public function Grass() {
    // constructor code
    this.width = 64;
    this.height = 64;
}
} 
```

如果我追踪对象的 .width 和 .scale ，它们将代码匹配为 64x64 和 1 的比例。但是当我在调试器中打印屏幕并在 Photoshop 中测量时，它们是 94x84，我可以找出它在哪里出错了？

有什么我想念的吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:01:05.890

也许您的调试器会将您的 Flash 视频拉伸到全屏，这会将您的草对象拉伸。截图会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T03:14:15.547

确保舞台缩放模式不缩放：

```
import flash.display.StageAlign;
import flash.display.StageScaleMode;

stage.scaleMode = StageScaleMode.NO_SCALE;
stage.align = StageAlign.TOP_LEFT; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-22T21:27:03.690

这是actionscript3吗？草类的声明在哪里？它可能有一些错误

# php - 使用 Ajax 的自定义功能无法按预期工作

> ID：10710231
> 
> 赞同：2
> 
> 时间：2012-05-22T21:11:32.093
> 
> 标签：php, jquery, ajax

我整天都在用这个问题来抨击我的头。我对 JavaScript 缺乏很好的了解，对于 DOM 操作，我开始使用 jQuery。构建一些基本的东西很容易。我想要的是构建自定义函数，该函数将使用列表填充表单，该列表将根据我传递给该函数的输入参数从数据库中提取出来。

代码如下所示：

```
(function($) {
        $.fn.multiSelect = function(a,b,c) {
        var someVar1 = parseInt(a,10);
        var someVar2 = parseInt(b,10);
        var someVar3 = c;
        var dataString = "a=" + someVar1 + "&b=" + someVar2 + "&c=" + someVar3;
        $.ajax({
            type:       "POST",
            url:        "test_ajax.php",
            data:       dataString,
            dataType:   'json',
            success:    function(data) {
                var a1 = data['a'];
                var b1 = data['b'];
                var c1 = data['c'];
                return $(this).html('<p>' + a1 + b1 + c1 + '</p>');
            }
        });
        return $(this).html('<p>' + someVar1 + someVar2 + someVar3 + '</p>');
    }
    };
}) (jQuery); 
```

test_ajax.php 中的 PHP 代码是：

```
<?php
if(isset($_POST['a']) AND !empty($_POST['a'])) {
    $_something = array(
                    'a'=> $_POST['a'],
                    'b'=> $_POST['b'],
                    'c'=> $_POST['b']
                    );
    echo json_encode($_something);
}
?> 
```

现在，当我像这样使用我的 jQuery 函数时：

```
$('#someDiv').multiSelect(1,1,'user'); 
```

$.(ajax) 中的函数不返回任何内容，并且在它之外（我创建它只是为了查看传递给函数的内容）返回“11user”。

如果我像这样使用上面的代码：

```
$(function() {
    var dataString = 'a=' + 1 + '&b=' + 1 + '&c=user';
    $.ajax({
            type:       "POST",
            url:        "test_ajax.php",
            data:       dataString,
            dataType:   'json',
            success:    function(data) {
                var a1 = data['a'];
                var b1 = data['b'];
                var c1 = data['c'];
                $('#someDiv').html('<p>' + a1 + b1 + c1 + '</p>');
            }
        });
}); 
```

它从 test_ajax.php 脚本中获取数据。所有这一切都很简单，只是为了解决问题，然后我将构建复杂的 PHP 脚本来完成数据库的工作。

我猜我在变量（本地/全局）或不正确的 jQuery 函数链接上做错了什么。

编辑：因为我会在不同的菜单上多次重复这个操作，所以函数会产生更多的逻辑，然后一遍又一遍地重复整个代码。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:17:54.430

我认为您的意思是您`$.ajax`通话中的这条线不起作用：

```
return $(this).html('<p>' + a1 + b1 + c1 + '</p>'); 
```

这是因为`this`，在`success`调用中，不指向 DOM 对象。它指向一个包含 AJAX 调用设置的对象。

您需要`context`在 AJAX 调用中使用该属性来`this`表示您想要的含义：

```
 $.ajax({
        type:       "POST",
        url:        "test_ajax.php",
        data:       dataString,
        dataType:   'json',
        context:    this,
        success:    function(data) {
            var a1 = data['a'];
            var b1 = data['b'];
            var c1 = data['c'];
            return $(this).html('<p>' + a1 + b1 + c1 + '</p>');
        }
    }); 
```

# android - 在列表视图中选择 edittexts 文本。可以怎么做？我查不出来

> ID：10710233
> 
> 赞同：4
> 
> 时间：2012-05-22T21:11:39.767
> 
> 标签：android, listview, select, android-edittext

我有一个 ListView，每行都有一个 EditText 工作。

我需要在单击编辑文本时选择此文本以写入数字而不擦除或移动光标。

首先使用 selectAllonfocus 有效。但是，滚动列表视图后，EditText 变得疯狂，并且选择无法正常工作。

如果我在监听器 onFocus 中执行 selectAll，那么当进行触摸时，将显示上下文菜单（选择单词、全选等）而不是选择。

如果有人可以提供帮助。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:16:51.857

我不知道你想做什么。如果您可以发布一些相关的源代码，也许会有所帮助...

但是当你开始滚动时它变得疯狂的事实让我觉得你没有在你的适配器 getView() 方法中正确处理 convertView 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T04:00:34.940

如果您在滚动后遇到问题，那就是视图回收让您感到困惑。您基本上需要设置一个数组来保存 EditTexts 的内容，这样当您滚动它们时它们就不会被弄乱。你没有说是什么支持你的列表，但我有一个包含编辑文本的列表，这是我处理它的方式（来自光标，但你可以将它调整为 ArrayAdapter）：

```
public class CursorAdapter_EditText extends SimpleCursorAdapter {

    private static Cursor c;
    private Context context;
    public static String[] quantity;
    private int layout;

    public CursorAdapter_EditText(Context context, int layout, Cursor c,
                        String[] from, int[] to) {
        super(context, layout, c, from, to);
        CursorAdapter_EditText.c = c;
        this.context = context;
        this.layout = layout;
        initializeQuantity();    //  Call method to initialize array to hold edittext info
    }

    public static void initializeQuantity() {
        quantity = new String[c.getCount()];    //  Initialize array to proper # of items
        int i = 0;
        while (i < c.getCount()) {              
                        quantity[i] = "";       // set all EditTexts to empty
                        i++;
        }
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        if (convertView == null)
                        convertView = View.inflate(context, layout, null);
        final int pos = position;
        View row = convertView;
        c.moveToPosition(position);
        TextView name = (TextView) row.findViewById(R.id.ListItem1);
        EditText qty = (EditText) row.findViewById(R.id.qty);
        qty.setOnFocusChangeListener(new View.OnFocusChangeListener() {  //  Set so EditText will be saved to array when you leave it
            @Override
            public void onFocusChange(View v, boolean hasFocus) {
                if (!hasFocus) {
                    LinearLayout parent = (LinearLayout) v.getParent();            
                    EditText qtyTemp = (EditText) parent.findViewById(R.id.qty);   //  Get a reference to EditText (you could probaly use v here)
                    quantity[pos] = qtyTemp.getText().toString();              // Save contents of EditText to array
                }
            }
        });
        name.setText(c.getString(1));
        unit.setText(c.getString(3));
        qty.setText(quantity[position]);
        return (row);
    }
} 
```

然后我在数组外部有一个按钮，可以将它处理回我的数据库，如下所示：

```
commit.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
        int i = 0;
        itemCursor.moveToFirst();
        while (itemCursor.isAfterLast() == false) {
            if (CursorAdapter_EditText.quantity[i].equals("")) {
                CursorAdapter_EditText.quantity[i] = "0";
            }
            ;
            int tempQty = Integer
                    .parseInt(CursorAdapter_EditText.quantity[i]);
            if (tempQty != 0) {
                mDbHelper.createListItem(listId, itemCursor
                        .getInt(itemCursor
                                .getColumnIndex(GroceryDB.ITEM_ROWID)),
                        tempQty, 0);
            }
            i++;
            itemCursor.moveToNext();
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-26T17:18:19.920

我通过执行以下操作处理了完全相同的问题：

1.  使用 ListView 从 xml 中删除 android:descendantFocusability="beforeDescendants"，从 AndroidManifest 中删除 android:windowSoftInputMode="adjustPan" - 它们没有帮助。
2.  子类化 EditText

    ```
    public class TrickyEditText extends EditText {

        private boolean mFocused = false;
        private boolean mTouched = false;

        public TrickyEditText(Context context) {
            super(context);
        }

        public TrickyEditText(Context context, AttributeSet attrs) {
            super(context, attrs);
        }

        public TrickyEditText(Context context, AttributeSet attrs, int defStyleAttr) {
            super(context, attrs, defStyleAttr);
        }

        @TargetApi(Build.VERSION_CODES.LOLLIPOP)
        public TrickyEditText(Context context, AttributeSet attrs, int defStyleAttr, int style) {
            super(context, attrs, defStyleAttr, style);
        }

        @Override
        public boolean didTouchFocusSelect() {
            if (mTouched && mFocused) {
                return true;
            } else {
                return super.didTouchFocusSelect();
            }
        }

        @Override
        public boolean onTouchEvent(MotionEvent event) {
            mTouched = true;
            return super.onTouchEvent(event);           
        }

        @Override
        protected void onFocusChanged(boolean focused, int direction, Rect previouslyFocusedRect) {
            mFocused = focused;
            if (!focused) {
                mTouched = false;
            }
            super.onFocusChanged(focused, direction, previouslyFocusedRect);
        }
    } 
    ```

    3.  适配器代码

        ```
        public class TrickyAdapter extends ArrayAdapter {

            .............

            @Override
            public View getView(int childPosition, View convertView, final ViewGroup parent) {

                .........

                TrickyEditText et = ..... //initialize edittext

                et.setOnFocusChangeListener(new OnFocusChangeListener() {

                    @Override
                    public void onFocusChange(final View v, boolean hasFocus) {
                        if (hasFocus) {
                            v.post(new Runnable() {

                                @Override
                                public void run() {
                                    ((EditText)v).selectAll();
                                }
                            });                    
                        }
                    }
                });

                .........
            }
        } 
        ```

虽然它工作得很好，但这不是我引以为豪的代码......如果有人知道更漂亮的解决方案，请告诉我！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-27T22:20:09.830

在适配器的 getView 方法中，获取您的 EditView（在此代码中为 edittxt）并执行以下操作：

```
 edittxt.post(new Runnable() {
        public void run() {
            edittxt.requestFocusFromTouch();
            edittxt.selectAll();
            InputMethodManager lManager = (InputMethodManager)context.getSystemService(Context.INPUT_METHOD_SERVICE); 
            lManager.showSoftInput(edittxt, 0);
        }
    }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-17T09:55:38.240

关于我所问的问题，我可以说的是，尝试选择列表视图编辑文本的所有文本无法正常工作。因此，我没有选择文本，而是显示一个对话框，用户可以在其中选择数字或其他内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-05T05:11:30.687

不确定您是否仍在寻找解决方案，但我找到了一种方法。在适配器的 getView 方法中为 edittext 添加焦点更改侦听器，并在收到焦点时选择所有文本。

```
public View getView(int position, View convertView, ViewGroup parent) {
    View view = convertView;
    // blah blah blah

    EditText edit = (EditText) view.findViewById(R.id.editTextId);
    edit.setOnFocusChangeListener(new OnFocusChangeListener() {
        @Override
        public void onFocusChange(View view, boolean hasFocus) {
            if (hasFocus)
                ((EditText) view).selectAll();
        }
    });

    return view;
} 
```

我已将 windowSoftInputMode 设置为该活动的adjustPan，尽管我认为它与此事无关。

我已经在 Android 2.3 和 4 上对此进行了测试，并且可以正常工作。

# php - 如何解决 Chrome 中的“重定向循环”？

> ID：10710237
> 
> 赞同：0
> 
> 时间：2012-05-22T21:11:50.313
> 
> 标签：php, google-chrome, webkit

我已经为我的网站实现了一个简单的超时机制，它将上次用户活动的瞬间存储在`$_SESSION`数组中。

它检查何时将请求发送到服务器。如果自上次请求以来超过 20 分钟，我会注销用户并将用户发送到登录页面。

但是我收到了出现在 Chrome 上的“重定向循环”消息。我犯了一个常见的错误吗？

（我需要修改服务器端设置吗？）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:13:40.080

重定向循环的发生显然是因为登录页面本身将用户重定向到登录页面，无限循环。为什么会发生这种情况尚不清楚，因为您没有显示任何代码，但如果您更正此问题，问题就会消失。

例如，如果具有新创建会话的用户（即您在重定向之前刚刚注销的用户）的“最后请求”值是零时间戳（1970 年 1 月 1 日），那么这将被视为超过 20 分钟更早，这可能会触发另一个注销/重定向等。

# php - 在选取框中显示 mysql 数据

> ID：10710242
> 
> 赞同：0
> 
> 时间：2012-05-22T21:12:02.980
> 
> 标签：php, mysql, html, css, marquee

我想制作一个新闻栏，通过选择mysql数据并将其显示在和选框中，所有数据同时显示在不同行的问题，我需要逐行显示数据。代码：

```
$news = mysql_query("SELECT ann_title, ann_text FROM o_postnews_conference");
         while ($row = mysql_fetch_assoc($news)) {
             echo "<marquee style='float:bottom;'><font color='snow'>{$row['ann_title']}: {$row['ann_text']}</font></marquee>"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:15:16.577

这是因为您在 while 循环的每次迭代中都创建了一个新的选取框元素。请改用以下代码。

```
$news = mysql_query("SELECT ann_title, ann_text FROM o_postnews_conference");
   echo "<marquee style='float:bottom;'><font color='snow'>";      
   while ($row = mysql_fetch_assoc($news))
             echo "{$row['ann_title']}: {$row['ann_text']} ";
   echo "</font></marquee>"; 
```

尽管您应该知道它`marquee`已被弃用，但您应该改用 CSS3/javascript。

# lisp - Lisp 作为元环境

> ID：10710243
> 
> 赞同：2
> 
> 时间：2012-05-22T21:12:04.007
> 
> 标签：lisp, metaprogramming, environment

我正在攻读博士学位，通过集成不同类型的计算机语言来更好地重用软件。由于性能和安全问题，我不考虑将它们与外部函数调用和/或 Web 服务的使用集成。

Lisp 是我最喜欢的工具，因为交互式开发、宏、在运行时进行修改、代码作为数据（人们通常会想象听到 Lisp 这个词）等等。有一些方法可以将不同类型的 Lisp 移植到 JVM（clojure、kawa、SISC、ABCL 等）或 .NET（clojure .NET、DotLisp、IronLisp）等虚拟机上。这很有趣，但仅限于相应虚拟机的“宇宙”。

有谁知道相反的方法，即在 Lisp 系统上运行 Java 或 C#？我找到了斗篷的其余部分。这似乎或多或少是一个死项目。对我来说，将 Lisp 作为一种通用抽象来托管其他语言（如 Java 和 C#）会更明智。

您认为哪些障碍可以克服缺乏通用且可扩展的“语言环境”集成 Java 或 C# 等语言（没有外部函数调用或（Web）服务））？是因为没有 Lisp 系统在某种虚拟机上运行，​​例如 LLVM，还是其他原因？

最好的问候，英格玛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:16:16.023

Lisp 是这种语言托管的一个很好的平台，因为它具有宏功能。但是，您需要更多的语言特性来做好它：模块、阅读器宏、高级宏规范等等。[Racket](http://www.racket-lang.org)是一个朝着这个方向发展的 Lisp 变体。您已经可以使用[Algol 60 ，](http://docs.racket-lang.org/algol60) [Prolog](http://docs.racket-lang.org/racklog/index.html)的一种变体，一种[类型化的姊妹语言](http://docs.racket-lang.org/ts-guide)，等等。[Guile](http://www.gnu.org/software/guile/)也在朝着这个方向发展，实现了[ECMAScript](http://wingolog.org/archives/2009/02/22/ecmascript-for-guile)。

至于在 Lisp 上实现 Java 或 C#，理论上是可能的，但需要大量工作才能在实际水平上支持这些语言（Racket 用于实现一小部分 Java）。考虑到 CLR 和 JVM 现在都是多语言平台，您是否真的会有所收获也不清楚。更有趣的是利用 Lisp 宏来定义更好的自定义语言 (DSL)，定义有用的 Lisp 方言，或者专门实现另一种语言来引导一个有用的工具（例如，Guile 实现 Emacs Lisp）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T23:32:34.210

Lisp is a perfect host language for such a meta-platform, but it is not necessarily an ideal target language for compiling something low level and imperative. Fortunately, nothing stops you from generating, say, an assembly code within your Lisp environment.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T22:33:53.360

好吧，“这取决于”，一如既往，对吧？

如果有的话，你希望将多少 Lisp 暴露给 Java？例如，如果您将 JVM 移植到 Lisp，您是否以某种方式将垃圾收集器所需的 JVM 与 Lisp 实现的实际底层 GC 相匹配，或者您是否只需编写自己的 GC 来 GC JVM 堆中的 JVM 对象。

出于几个原因，将两者结合起来很可能是不切实际的。Lisp GC 在实际实现中几乎是隐藏的，就像 Javas GC 一样。这可能太隐藏而无法与 JVM 实现一起使用。

没有理由不能在 Lisp 中构建 JVM，它只是一堆字节码。Lisp 可以很好地处理字节。

已经有 JVM 在 JavaScript 中的实现，它与核心的 Lisp 没有太大区别。

但是除了有一个 lispy 命令行来与 JVM 交互之外，JVM 本身不会很“lispy”。怎么会这样？这是一个 JAVA 虚拟机。实现可以是“lisp”，但理想情况下，这种 lisp-ness 都不会冒泡到 JVM 本身。

除了 Lisp 在开发任何程序方面的任何优势之外，我认为 Lisp 并不特别适合“更好”地开发虚拟机。

Lisp 擅长开发其他语言，尤其是其他基于 S-Exp 的语言。但是虚拟机就是虚拟机。Monster case 语句或其他基于数值机制的调度。

# quickbooks - 以编程方式使用不同的 QuickBooks 版本开始会话

> ID：10710244
> 
> 赞同：0
> 
> 时间：2012-05-22T21:12:05.087
> 
> 标签：quickbooks

我正在使用此调用从代码中访问 QuickBooks 文件

```
win32com.client.Dispatch("QBXMLRP2.RequestProcessor") 
```

我计划在我的计算机上安装多个版本的 QuickBooks。有没有办法指定使用哪个版本的 QuickBooks 来打开会话？我想解决 QuickBooks 的特定版本，以便我的程序符合 SDK 应用程序一次只能打开一个 QB 文件的限制。（例如，我可能会开始使用 QuickBooks Pro 与 company1.qbw 的会话，然后使用 QuickBooks Premier 与 company2.qbw 进行另一个会话）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T04:47:38.163

SDK 一次只能在一台机器上打开一个 QuickBooks 文件。安装多个版本的 QuickBooks 不会改变这一点。如果您在 QuickBooks Pro 中打开了文件并且想要打开 Enterprise 文件，则必须先关闭 Pro。使用 SDK 同时打开多个 QuickBooks 文件的唯一方法是使用多台计算机。

旁注：可以在同一台机器上运行多个版本的 QuickBooks，并且 SDK 可以工作；但不要尝试在安装了美国版本的机器上安装加拿大或英国版本，或 Reckon（澳大利亚和新加坡）：这会搞砸 SDK。

# c# - 自定义控件 onPaint 事件不起作用

> ID：10710247
> 
> 赞同：3
> 
> 时间：2012-05-22T21:12:20.533
> 
> 标签：c#, custom-controls, onpaint

嘿人们我有一个问题，我正在编写一个自定义控件。我的控件继承自 Windows.Forms.Control 并且我试图覆盖 OnPaint 方法。这个问题有点奇怪，因为它只有在我在表单中包含一个控件时才有效，如果我添加另一个控件，那么第二个控件不会被绘制，但是 OnPaint 方法会为所有控件调用。所以我想要的是我所有的自定义控件都被绘制，这里不仅有一个是我的代码：

如果您运行代码，您将看到屏幕上只出现一个红色矩形。

```
public partial class Form1 : Form
{
    myControl one = new myControl(0, 0);
    myControl two = new myControl(100, 0);

    public Form1()
    {
        InitializeComponent();
        Controls.Add(one);
        Controls.Add(two);
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }
}

public class myControl:Control
{
    public myControl(int x, int y)
    {
        Location = new Point(x, y);
        Size = new Size(100, 20);
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);

        Pen myPen = new Pen(Color.Red);
        e.Graphics.DrawRectangle(myPen, new Rectangle(Location, new Size(Size.Width -         1, Size.Height - 1)));

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:18:08.250

我猜你正在寻找这样的东西：

```
e.Graphics.DrawRectangle(Pens.Red, new Rectangle(0, 0, 
                                                this.ClientSize.Width - 1,
                                                this.ClientSize.Height - 1)); 
```

您的 Graphic 对象用于控件的内部，因此`Location`在这里使用并不是很有效。坐标系从控件客户区左上角的 0,0 开始。

此外，您可以只使用内置的`Pens`颜色，否则，如果您正在创建自己的“新”笔，请务必处理掉它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:24:25.010

LarsTech 打败了我，但你应该明白为什么：

控件内部的所有绘图都是针对坐标是自相关的“画布”（在 Windows 中适当地称为设备上下文）进行的。左上角始终为 0, 0。

宽度和高度可在 ClientSize 或 ClientRectangle 中找到。这是因为一个窗口（一个控件就是Windows中的一个窗口），有两个区域：客户区和非客户区。对于您的无边框/无标题栏控件，这些区域是相同的，但为了面向未来，您总是希望在客户区域中进行绘制（除非您想要绘制操作系统通常绘制的非客户端位的罕见情况为你）。

# java - apache httpclient 并生成一个将使用 java 共享会话的浏览器

> ID：10710248
> 
> 赞同：0
> 
> 时间：2012-05-22T21:12:21.497
> 
> 标签：java, spring, spring-security, internet-explorer-9, apache-commons-httpclient

我需要能够在 apache httpclient 和 Web 浏览器之间共享会话。

当用户第一次使用该程序时，我的 SWT 程序通过 httpclient 对用户进行身份验证。稍后需要使用相同的会话启动默认 Web 浏览器。我可以使用以下方式启动用户的默认浏览器：http: [//johnbokma.com/mexit/2008/08/19/java-open-url-default-browser.html](http://johnbokma.com/mexit/2008/08/19/java-open-url-default-browser.html)

如果可能的话，我想要一个通用的解决方案。如果不可能，我会选择 IE、Chrome 或 FireFox 的解决方案。然后我会尝试弄清楚如何为其他两个浏览器做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:59:44.003

这可以通过在默认浏览器打开的 URL 中添加会话 cookie 的值来实现。URL 的确切语法取决于所使用的网络服务器。以下是 Tomcat 的示例：[在 Tomcat 中支持没有 Cookie 的会话](https://stackoverflow.com/questions/436752/supporting-sessions-without-cookies-in-tomcat)

# git - 将 Mercurial 文件夹转换为 Git 存储库

> ID：10710250
> 
> 赞同：142
> 
> 时间：2012-05-22T21:12:28.550
> 
> 标签：git, mercurial

我在 Mercurial 方面没有丰富的经验，我主要是一个 Git 人。

我很想在 git Repository 中镜像一个特定的 Mercurial 文件夹/文件。我实际上想要做的是将文件的历史从 Mercurial 存储库导出到 Git，并能够与未来的提交保持同步。

您对如何进行有什么建议吗？我相信要走的路应该是获取 Mercurial 补丁的历史记录，定期将每个提交导出为补丁并将 Mercurial 补丁应用到 Git 存储库。

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2012-05-22T21:16:01.013

在**Linux**或任何`bash/sh`类似或类似的东西上，或者`python`，尝试使用[快速导出](https://github.com/frej/fast-export)：

```
cd
git clone git://repo.or.cz/fast-export.git
git init git_repo
cd git_repo
~/fast-export/hg-fast-export.sh -r /path/to/old/mercurial_repo
git checkout HEAD 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2015-08-05T09:03:45.023

## Windows：TortoiseHG Hg-Git 扩展

[Hg-Git](https://hg-git.github.io/)可用于将 Mercurial 存储库转换为 Git。您可以使用本地存储库或通过 SSH、HTTP 或 HTTPS 访问的远程存储库。

### 本地存储库转换示例。

1.  安装 Hg-Git。

    *   在 Windows 上，[TortoiseHg](https://tortoisehg.bitbucket.io/)带有 Hg-Git，但您需要通过设置工具[启用它](https://tortoisehg.readthedocs.io/en/latest/nonhg.html#hg-git-git)（在扩展部分）

        [![TortoiseHg 设置](../Images/db638fe743d737402a559619ee40eb85.png)](https://i.stack.imgur.com/kxORZ.png)

        或手动输入`~/mercurial.ini`

        ```
        [extensions]
        hggit = 
        ```

2.  使用以下命令转换存储库：

    ```
    $ mkdir git-repo; cd git-repo; git init; cd ..
    $ cd hg-repo
    $ hg bookmarks hg
    $ hg push ../git-repo 
    ```

`hg`书签对于防止出现问题是必要的，否则 hg-git 会推送到当前签出的分支，从而混淆 Git 。`hg`这将在 Git 存储库中创建一个名为的分支。要获取 master 中的更改，请使用以下命令（仅在第一次运行时需要，以后只需使用`git merge`or `rebase`）：

```
$ cd git-repo
$ git checkout -b master hg 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-03-05T12:32:23.413

您可以（从 Mercurial 方面）：

*   使用带有选项的[Convert 扩展](https://www.mercurial-scm.org/wiki/ConvertExtension)`--filemap`名将原始 repo 的一部分转换为更小的仅需要的文件|目录
*   使用 hg-git 扩展将剥离的 repo 推送到 Git

或（而不是 hg-git），[在 Git 中使用 Mercurial bridge，](http://felipec.wordpress.com/2012/11/13/git-remote-hg-bzr-2/)从 Git 克隆|拉取存储库

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2015-03-25T18:21:51.660

# Gitify

似乎是一种更现代且易于使用的替代方法来执行转换 [https://github.com/buchuki/gitifyhg](https://github.com/buchuki/gitifyhg)

```
pip install gitifyhg
git clone gitifyhg::<hgrepoaddress>
# done, you have a git repo with the entire history of the hg one 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-10-04T17:19:55.717

# 在 Windows 10 上将 Mercurial 存储库转换为 Git

## 如果编码没有问题 - 使用 TortoiseHG Hg-Git 扩展

```
md new-repo && cd new-repo
git init --bare .git
cd ..\old-mercurial-repo
hg bookmark -r default master
hg push ..\new-repo
cd ..\new-repo
git config --bool core.bare false 
```

## 如果编码有问题 - 使用快速导出

### 安装 Bash

以管理员身份打开 PowerShell 并运行：

```
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux 
```

[从Microsoft Store](https://www.microsoft.com/en-us/p/ubuntu-1604-lts/9pjn388hp8c9?rtc=1&source=lp&activetab=pivot:overviewtab)安装 Ubuntu 16.04 LTS

### 打开 Bash 并运行

安装水银

```
sudo -s
apt-get update
apt install mercurial 
```

获取快速导出 v180317（目前 180317 之后的版本无法正常工作）

```
cd /mnt/c/path_to_work_folder
git clone https://github.com/frej/fast-export.git
cd fast-export
git checkout tags/v180317
cd .. 
```

转换存储库

```
git init new-repo && cd new-repo
git config core.ignoreCase false && git config core.quotepath off
../fast-export/hg-fast-export.sh -r ../path_to_mercurial_repo/ --fe cp1251
git checkout master 
```

编码选项：

*   `-f`编码，比如`-f cp1251`
*   `--fe`文件名编码如`--fe cp1251`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-06-23T18:36:23.617

# hg-git-fast-import

[https://github.com/kilork/hg-git-fast-import](https://github.com/kilork/hg-git-fast-import)

另一个具有以下功能的实用程序：

1.  将单个和多个 Mercurial 存储库导入到 Git 存储库。
2.  将以前导入的 Mercurial 存储库中的新修订版导入 Git 存储库。
3.  标签。
4.  封闭的分支机构。
5.  使用差异验证最终结果。

您可以为您的[平台](https://github.com/kilork/hg-git-fast-import/releases)下载二进制文件并将其放在路径中或安装`cargo`（需要`rust`安装[）](https://www.rust-lang.org/learn/get-started)：

```
cargo install hg-git-fast-import 
```

那么用法是这样的：

```
hg-git-fast-import single /path/to/source_hg /path/to/target_git 
```

它不需要`Python`并且`Mercurial`需要安装。高级配置允许替换作者或分支，使分支前缀等等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-12-23T19:18:35.497

如果您使用的是**github.com**，它们似乎有**一个导入功能**，让您只需输入 hg 项目的 URL。

首先**创建一个新存储库**，然后在新存储库的登录页面上滚动到底部并单击**“导入代码”按钮**。

[![导入代码按钮的上下文](../Images/ae1ed810a21dc65d3eb88a785bd69c6f.png)](https://i.stack.imgur.com/ffF7C.png)

然后输入**您以前的存储库的 URL**并点击“开始导入”。

[![上下文](../Images/1937aead631d1ba36b07e48b72c825b8.png)](https://i.stack.imgur.com/nV3kS.png)

然后 GitHub 负责其余的工作！

[![Github 为您处理业务](../Images/da09568797a14a83ad46f728917bf279.png)](https://i.stack.imgur.com/I4A6v.png)

请注意，如果需要，GitHub 会要求您提供旧存储库的凭据。

哦！我找到了[官方指南](https://help.github.com/en/github/importing-your-projects-to-github/importing-a-repository-with-github-importer)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-01-18T07:16:05.393

在 Windows 上可能有点棘手。在 mercurial( `hggit`) 中启用正确的插件后，也可以使用 TortoiseHG。

1.  克隆 mercurial 回购
2.  克隆 git 仓库
3.  启用控制台： [启用控制台](https://i.stack.imgur.com/WN8mg.png)
4.  使用控制台：

    `% hg bookmarks hg`

    `% hg push <relative path to>/<git-repo>`

# hibernate - Postgres 数据库表中的列未自动填充

> ID：10710253
> 
> 赞同：0
> 
> 时间：2012-05-22T21:12:53.210
> 
> 标签：hibernate, postgresql, insert

我正在使用休眠连接到 Postgres 数据库。在数据库中有一个表，其中一列设置为存储记录插入该表时的当前时间。当我从 Postgres 界面插入记录时，当前时间会自动填充。

但是当我尝试从 Hibernate 插入记录时，数据库不会自动将记录插入到当前时间列中。

```
Query dateQuery=session.createQuery("select b.boilerPlateContent from Boiler_Plates b join b.bt_contracts c where c.contractId=:val order by b.boilerPlateContent desc)").setEntity("val",ct);
Iterator dateIterator = dateQuery.list().iterator();
String latestBoilerPlate=(String)dateIterator.next();
System.out.println(latestBoilerPlate);
Pattern p=Pattern.compile("\\d+");
Matcher m=p.matcher(latestBoilerPlate);
while(m.find()){
 lastEntered=m.group();
 nextBoilerPlateNumber=Integer.parseInt(m.group());
}
nextBoilerPlateNumber++;
Boiler_Plates  bp=new Boiler_Plates();
bp.setBoiler_plate_id(boilerPlateId);
boilerPlateText="bp"+nextBoilerPlateNumber;
bp.setBoilerPlateContent(boilerPlateText);
bp.setBoilerPlateName("Test");
//bp.setInsertTime();
bp.setContract(ct);
session.save(bp);
tx.commit(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T01:46:46.500

您似乎正在尝试进行审核。为此，您应该使用非常完善的解决方案，而不是自己动手。请参阅PostgreSQL wiki 上的[envers](http://www.jboss.org/envers)和[触发器示例，以及使用](http://wiki.postgresql.org/wiki/Audit_trigger)[@PrePersist、@PreUpdate 和实体侦听器](https://stackoverflow.com/questions/1745890/last-update-timestamp-with-jpa)的 JPA 审计支持。更好的是，使用@Embeddable 实体和@EntityListener，这样您就可以重用您的审计代码。

您尚未指定如何自动设置列。

如果您设置了 DEFAULT，那么 Hibernate 会为 INSERT 上的所有列指定值，因此 DEFAULT 将不会被使用。您需要让 Hibernate 避免设置列或显式指定关键字`DEFAULT`作为列值 - 您可以通过将其映射为 insertable=false,updatable=false 来做到这一点。或者，您需要让 Hibernate 直接插入您想要的值。

另一种选择是使用`ON INSERT FOR EACH ROW`触发器来设置列的值。这使您可以从 PL/PgSQL 设置值，无论有人在 INSERT 时为列指定什么。

这是[另一个实体侦听器示例](http://struberg.wordpress.com/2010/07/31/howto-changelog-with-jpa/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T12:23:34.063

正如已经指出的那样，您最初问题中的信息非常缺乏。但是假设“插入记录时自动填充当前时间”意味着您在该列上定义了 DEFAULT，则 DEFAULT 值仅在插入语句中未引用该列时才生效。Hibernate 默认会引用插入语句中的所有列。但是，您可以更改该行为。在这里，您正在寻找类似这种映射的东西，我认为：

```
@Entity
public class Boiler_Plates {
    ...
    @Temporal(TemporalType.TIMESTAMP)
    @Generated(GenerationTime.INSERT) 
    @Column(insertable = false)
    Date insertTime
} 
```

@Column(insertable = false) 表示不在 INSERT 语句中包含该列。@Generated(GenerationTime.INSERT) 表示在执行 INSERT 后重新读取该列的状态以查找生成的值。

# iphone - iPhone iOS 基于 mapkit 的应用程序应该看起来像 iPhone 原生地图应用程序吗？

> ID：10710263
> 
> 赞同：0
> 
> 时间：2012-05-22T21:13:35.663
> 
> 标签：iphone, ios, app-store, mkmapview, appstore-approval

我正在构建一个基于地图工具包的应用程序，该应用程序具有地图视图以显示预定位置的列表。我“借用”了地图应用程序的外观和感觉——顶部带有书签列表的搜索栏，左下角的缩放到用户位置按钮，右下角显示地图类型控件的剥离角。

为了显示地图注释的路线，我打开本地地图应用程序来绘制路线。

**是否鼓励这种“地图应用程序”，例如地图应用程序的外观和感觉，还是我违反了某些条款？**我没有在应用商店审查指南中看到任何具体的地图，但我想确保我的地图应用不会有任何审查问题。

谢谢您的意见！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:25:40.697

你的应用*是做*什么的？如果它所做的只是让用户搜索地点并获取到他们的路线，那么是的，你公然扯掉了内置应用程序。但是，如果这是您应用程序的一小部分，并且它使用原始 UI 做了很多其他事情，那么可以肯定 - 为什么不向用户提供熟悉的 UI 范例呢？这一切都取决于您的应用程序做什么，您从其他应用程序复制了多少，以及用于什么场景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:41:00.113

来自[位置感知编程指南](https://developer.apple.com/library/ios/#documentation/userexperience/conceptual/LocationAwarenessPG/MapKit/MapKit.html)：

> **重要**Map Kit 框架使用 Google 服务来提供地图数据。使用该框架及其相关接口会将您绑定到 Google Maps/Google Earth API 服务条款。[您可以在http://code.google.com/apis/maps/iphone/terms.html](http://code.google.com/apis/maps/iphone/terms.html)找到这些服务条款。

根据我的经验，只要您不遮挡地图底部的 google 徽标，您所做的就很好。

# batch-file - 从所有用户配置文件复制的批处理文件

> ID：10710265
> 
> 赞同：3
> 
> 时间：2012-05-22T21:13:44.043
> 
> 标签：batch-file, xcopy

我想生成一个批处理文件，它将从用户的配置文件中复制所有 *.doc 和 *.xls 文件类型。然后，我会将批处理文件设置为在所有用户注销后通过计划任务自动运行。这是我所拥有的：

```
for %%x in (doc xls) do xcopy c:\Users\user1\*.%%x "\\server\i$\User Backups\user1\%computername%\" /c /i /y /s /d 
```

这很好用，但是，我需要在批处理文件中为我们组织中的每个用户（user1、user2 等）生成一个行项目，以便我点击所有配置文件。雇用新用户时，需要使用他们的个人资料信息更新文件。理想情况下，我想要一些更自动化的东西，类似于：

```
for %%x in (doc xls) do xcopy %userprofile%\*.%%x "\\server\i$\User Backups\%username%\%computername%" /c /i /y /s /d 
```

缺点是通过使用 %userprofile% 代替 'user1' 输入，它只针对当前登录的用户运行。有没有我可以合并的另一个选项，它不关心当前登录的用户，而只是针对机器上的所有用户配置文件运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T23:38:33.753

您可以使用`reg query`从注册表中获取用户配置文件列表，但您只关心在 下具有文件夹的用户`C:\Users`，因此只需遍历这些：

```
for /d %%u in (C:\Users\*) do for %%x in (doc xls) do xcopy C:\Users\%%~nu\*.%%x "\\server\i$\User Backups\%%~nu\%computername%\" /c /i /y /s /d 
```

# javascript - 一个脚本标签中的异常是否会中断其他脚本标签？

> ID：10710266
> 
> 赞同：2
> 
> 时间：2012-05-22T21:13:59.420
> 
> 标签：javascript, html, exception, portability

如果我制作这样的页面，

```
<script>
    b00m;
    alert("A");
</script>

<script>
    alert("B");
</script>

<script>
    alert("C");
</script> 
```

尽管第一个例外，但似乎所有脚本元素仍在执行。

情况不是这样吗（不同的浏览器、不同版本的 HTML、怪癖模式等）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:47:04.900

不，除非一个脚本标签依赖于未能在前一个脚本标签中设置的值。

# macos - 在特定文件夹中添加菜单项？

> ID：10710267
> 
> 赞同：1
> 
> 时间：2012-05-22T21:14:00.623
> 
> 标签：macos, cocoa, file-io, dropbox

如何将新文件夹/文件操作添加到特定（应用程序确定的文件夹）中的文件菜单中，就像 Dropbox 应用程序在此屏幕截图上所做的那样 - 添加新菜单组（Dropbox）和子项（获取链接、共享此文件夹等）。以及如何对应用程序中的用户操作选择做出反应？提前致谢。

![在此处输入图像描述](../Images/97465fcdb2e7d79ad3575494fc7473c1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T00:34:53.040

没有公共 API 可以做 Dropbox 正在做的事情。他们将代码注入经过逆向工程的 Finder 进程。

# html - 有人可以解释 iFrame 吗？

> ID：10710270
> 
> 赞同：0
> 
> 时间：2012-05-22T21:14:04.057
> 
> 标签：html, iframe

我对iFrame的理解是里面的内容就是src里面包含的内容。我见过许多使用 iFrame 的小部件，如 Facebook 等。

当我尝试使用 iFrame 时，我有一个 HTML 文件，其中只有一个 div 和一些内容，没有头部、正文等。只有 HTML 中的内容。但是 iFrame 总是加载整个页面并最终在 iFrame 中给我一个递归 iFrame。

我不明白这是怎么回事，因为我在 iFrame 中引用的 HTML 文件只是内容，没有别的。我不包括页眉、页脚，但无论如何都会显示所有内容。

我已经看到人们在谈论将 iFrame 滚动到某个部分，甚至在 src 中使用 div 的 id 并设置 scrolling=no。这可行，但我的 iFrame 内容将根据用户输入重新加载，一旦重新加载，它就会返回到 iFrame 内页面的左上角部分。

这没有任何意义。也许这应该是一个小部件或什么？

编辑 SD 以显示一些格式化的代码：@Surreal Dreams

这就是奇怪的事情。我正在使用 web2py，所以它可能是后端固有的东西导致了这种情况。html 文件实际上是一个 div 包装器，其中包含一些元素。但我认为 web2py 会在其中添加标题，即使我没有扩展任何类型的布局。我最终确实通过引用保存在另一个 url 的同一个 html 文件来使其正常工作。它在那里正确显示，而 web2py 不会干扰 html 结构。

之前发生了什么，我有这样的代码：

```
{{extend 'layout.html'}}
<div class="wrapper">
<page content>
<aside id="iFrame wrapper">
<iframe src="/rates.html"></iframe>
</aside>
</div> 
```

这就是 web2py 页面的基本结构，其中在布局内部你有所有的页眉、页脚等。发生的事情是它会生成整个页面，并且在你到达 iFrame 的地方，它会在里面再次生成页面iFrame，然后再次向下到 iFrame，它继续在每个 iFrame 的页面内无限渲染页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:31:20.557

iframe 将始终加载整个网页，在 iframe 的 src 属性中引用。即使你的文件只包含一个 div，我相信浏览器会认为它是一个完整的页面并自动添加一个头部和正文。

“我已经看到人们在谈论将 iFrame 滚动到某个部分” => 对，一旦 iframe 中的页面被加载，您就可以使用 JavaScript 访问和操作其 DOM：

```
var myIframe = parent.document.getElementById("myIframe");
var window = myIframe.contentWindow; 
```

# sql - 加入表两次 - 在同一个表的两个不同列上

> ID：10710271
> 
> 赞同：20
> 
> 时间：2012-05-22T21:14:04.197
> 
> 标签：sql, postgresql, join, foreign-keys, left-join

我有一个非常令人困惑的数据库，其中一个表在单独的表中保存了我需要的两个值。这是我的问题：

```
Table1
- id

Table2
- id
- table1_id
- table3_id_1
- table3_id_2

Table3
- id
- value 
```

我需要从 table1 开始并进行连接，这将使我从`table3`两个单独的列中返回值。所以我想要这样的东西：

```
table1.id | table2.id | table2.table3_id_1 | table2.table3_id_2 | X | Y 
```

其中`X`和分别是由和`Y`连接的行的值。`table3_id_1``table3_id_2`

可能使它们成为变量或其他东西，以便我也可以在`WHERE`子句中过滤它们？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-22T21:21:26.370

```
SELECT t2.table1_id
     , t2.id          AS table2_id
     , t2.table3_id_1
     , t2.table3_id_2
     , t31.value      AS x
     , t32.value      AS y
FROM   table2 t2
LEFT   JOIN table3 t31 ON t31.id = t2.table3_id_1
LEFT   JOIN table3 t32 ON t32.id = t2.table3_id_2; 
```

没有必要参与`table1`。`table2`拥有你所需要的一切——假设有一个[外键约束](https://www.postgresql.org/docs/current/tutorial-fk.html)保证参照完整性（所有`t2.table1_id`这些实际上都存在于 中`table1`）。否则，您可能想要加入`table1`，从而仅选择也存在于 中的行`table1`。

出于类似的原因，我使用[**`LEFT [OUTER] JOIN`**（而不是`[INNER] JOIN`）](https://www.postgresql.org/docs/current/sql-select.html#SQL-FROM)加入两个实例`table3`：目前尚不清楚是否保证了引用完整性 - 以及是否有任何关键列可以是`NULL`. An`[INNER] JOIN`将从未找到匹配项的结果中删除行。我假设您宁愿显示这样的行，其中包含`NULL`任何缺失`x`或的值`y`。

`table3.id`需要`UNIQUE`，或者我们可能将行与每个行的多个匹配项相乘`LEFT JOIN`：

*   [两个 SQL LEFT JOINS 产生不正确的结果](https://stackoverflow.com/questions/12464037/two-sql-left-joins-produce-incorrect-result/12464135#12464135)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-22T21:17:46.630

如果您多次加入一个表，请使用别名来区分它们：

```
SELECT table1.id,table2.id,table2.table3_id_1,table2.table3_id_2,t3_1.id,t3_2.id
FROM table1
JOIN table2 ON table1.id=table2.table1_id
JOIN table3 t3_1 ON table2.table3_id_1=t3_1.id
JOIN table3 t3_2 ON table2.table3_id_2=t3_2.id
WHERE ... t3_1.id=... AND ... t3_2.id=... 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-22T21:18:52.027

```
select t1.id as table1_id, 
    t2.id as table2_id, 
    t2.table3_id_1, 
    t2.table3_id_2,
    t3_1.value as X, 
    t3_2.value as Y
from Table1 t1
inner join Table2 t2 on t1.id = t2.table1_id
inner join Table3 t3_1 on t2.table3_id_1 = t3_1.id
inner join Table3 t3_2 on t2.table3_id_2 = t3_2.id
where t3_1.value = 'some_value'
    or t3_2.value = 'some_other_value' 
```

# java - JNI GetObjectClass 总是返回 java/lang/Class

> ID：10710273
> 
> 赞同：1
> 
> 时间：2012-05-22T21:14:13.663
> 
> 标签：java, android-ndk, java-native-interface

env->CallVoidMethod 在使用时返回 java/lang/Class

```
env->GetObjectClass(aobject); //aobject was the argument sent by JNI to C++ 
```

aobject 是实现接口的 Java 对象。

```
jobject obj = env->GetObjectClass(aobject) 
```

应该返回 Java 对象，而是返回 java/lang/Class

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-07-30T19:10:59.213

我遇到了这个错误，不得不在工作中四处打听，才能得到真正的答案。

问题是，当您将`native`方法指定为时`static`，它会提供 的实例，而`jclass`不是`jobject`该类的实例，因为它是从静态上下文中调用的。（如果您调用`getCanonicalName()`它`jclass`，它将返回您的班级名称。）

如果本机方法需要是静态的，那么您应该在需要时将实例作为参数传入。否则，只要让它不是静态的，你就应该是固定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T17:52:54.107

我的问题的答案在沈良的《Java Native Interface - Programmer's Guide and Specification》中有描述。

**“您也可以使用 Call<Type>Method 系列函数来调用接口方法。您必须从接口类型派生方法 ID”**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T22:30:18.527

自从您删除“静态”后，您还没有重新生成 .h/.c 文件，因此您的 JNI 方法签名与 Java 不匹配。您在参数列表中有一个额外的 jclass，它仅用于静态方法。所以你会得到一些非常奇怪的处决。

# python - Django 动态类无法更新

> ID：10710276
> 
> 赞同：0
> 
> 时间：2012-05-22T21:14:15.563
> 
> 标签：python, django, dynamic, django-models

我有一组数据库表，用于存储每天每分钟的客户订单数。一年中的每个月都是不同的表，以避免表过大。为了在我的 Django 网页中检索这些数据，我动态创建了一个模型类，其中 db_table 根据从 html 表单输入接收到的日期填充。问题是当我用新的日期值重新提交表单时，该类不会更新到应该是新模型，它仍然保持旧值。

我的 models.py 看起来像这样：

```
class baseModel(models.Model):
    id = models.CharField(max_length=40)
    date = models.IntegerField()
    minute = models.IntegerField()
    totalorders = models.IntegerField()
    class Meta:
        abstract = True
        managed = False

def getModel(type, yyyymm):
    if type == 'duration':
        class DurationClass(baseModel):
            medianduration = models.IntegerField()
            avgduration = models.IntegerField()
            class Meta:
                db_table='orderTable' + yyyymm
                #debug statement
                print db_table
        return DurationClass 
```

yyyymm 只是一个字符串，例如 2012 年 4 月的“201204”。因此，如果我在输入框中输入 2012 年 4 月，它可以正常工作，但如果我更改为 2012 年 3 月，它仍然会查询 4 ​​月的数据。我可以从调试语句中看到 db_table 正在正确更新，但由于某种原因它无法正常工作。在分配新的动态模型或其他东西之前，我是否需要解除分配旧的动态模型？在 view.py 中，我只是这样做（不是循环）：

```
myModel = getModel('duration', startyyyymm)
QS = myModel.objects.using( ...etc 
```

非常感谢您的任何想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T04:26:03.213

您对 python 如何管理动态类的创建有疑问。我不确切知道python是如何工作的，但似乎你这样做的方式并不完全正确。我认为这是因为 python 类附加到一个模块，所以第一次执行“getModel”时，它会按预期创建模型。但是，在那之后，每次你执行“getModel”，因为类总是同名，python不能在同一个模块中创建同一个类，所以它会以某种方式返回你第一次调用时创建的同一个类“获取模型”。（我希望你能理解我的英语，虽然我可能对 python 动态类创建的工作方式有误）

在给您答案之前，我进行了一些搜索并进行了一些测试。似乎创建动态类的最佳方法是使用“类型”（python 内置方法），因此您可以为每个表创建一个类（这些类必须具有不同的名称）。

这是您可以做什么的示例（对我有用）：

```
def getModel(type, yyyymm):
    if type == 'duration':
        newModelClass = type(
            'newModelName', #It could be the table name you are going to search in. It must be different for every different db table you want to use. For example: 'orderTable' + yyyymm
            (baseModel, ), #Base class for your new model
            {
                'medianduration' : models.IntegerField(), #New model's attribute
                'avgduration' : models.IntegerField(), #New model's attribute
                '__module__':__name__, #This is required. If not given, type raises a KeyError
                'Meta': type(
                                'Meta',
                                (object,),
                                {
                                    'db_table':'orderTable' + yyyymm, #Here you put the table name you want to use
                                    '__module__':__name__,
                                }
                        )
            }
       )
       return newModelClass 
```

如果我没有犯任何复制/粘贴错误，它现在应该适合你。

再次，对不起，如果我犯了任何英语错误。我对用英语和一般英语写作有点生疏：S

我希望它对你有帮助。虽然我同意您的数据库应该可以在不使用多个表的情况下正常工作......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T11:25:13.450

您需要的所有内容都在以下链接中：[https ://code.djangoproject.com/wiki/DynamicModels](https://code.djangoproject.com/wiki/DynamicModels)

# entity-framework - 首次使用 EF 代码时事务在锁定资源上死锁

> ID：10710277
> 
> 赞同：1
> 
> 时间：2012-05-22T21:14:34.710
> 
> 标签：entity-framework, tsql, ef-code-first

我首先使用 EF 代码。最近我不得不替换以下代码：

```
User user = userRepository.GetByEmail("some@email.com");

if (user == null)
{
    user = New User { Email = email, CreatedAt = DateTime.Now };

    userRepository.Add(user);
    unitOfWork.Commit();
} 
```

和

```
Context.ExecuteSqlCommand("IF NOT EXISTS(SELECT 1 FROM Users WHERE Email = '{0}')
                           INSERT INTO Users(Email, CreatedAt)
                           VALUES ('email', GETDATE())"); 
```

这背后的原因是 EF 在尝试添加数千行时运行第一段代码需要很长时间。通过将其更改为 ExecuteSqlCommand，处理这么多行的时间减少了很多。

我现在看到的问题（到目前为止只发生了两次）是来自数据库的以下消息：事务（进程 ID 52）在锁定资源上与另一个进程死锁，并已被选为死锁受害者。重新运行事务。

我将如何解决这个问题？我的大部分数据访问都是通过 EF 完成的，除了上面的一些例外。我以前从未在日志中看到过死锁，所以我认为这与查询有关。

我的问题是：

1.  有没有办法使用 No LOCK 编写查询？该查询的外观如何？
2.  有没有办法告诉 EF 对某些查询使用 NO LOCK？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T22:54:04.843

您真正想要的是更早地锁定表，而不是防止锁定。锁定是必要的，以确保在您的命令中的两个语句之间，没有出现其他进程并插入同一个用户。（插入数据时始终需要锁定，因为正在修改物理存储。）

假设这实际上是导致死锁的命令，下面应该解决它，因为它只要求一个独占锁：

Context.ExecuteSqlCommand("IF NOT EXISTS(SELECT 1 FROM Users WHERE Email = '{0}') INSERT INTO Users(Email, CreatedAt) VALUES ('email', GETDATE())");

# objective-c - 如果不存在则创建数据库文件

> ID：10710280
> 
> 赞同：1
> 
> 时间：2012-05-22T21:15:02.357
> 
> 标签：objective-c, ios, sqlite, fmdb

我正在尝试在第一个应用程序启动时创建数据库文件。使用 FMDB 库。为此，我正在检查数据库文件是否已经存在，如果不存在，我想从项目中复制数据库文件。我的代码：

```
-(void)checkAndCreateDatabase {
NSLog(@"check and create database doing");
NSString *docDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString *dbFileName = [docDir stringByAppendingPathComponent:@"FriendsDatabase.sqlite3"];
NSFileManager *fileManager = [NSFileManager defaultManager];
NSError *error;

if (![fileManager fileExistsAtPath:dbFileName]) {
    [fileManager copyItemAtPath:[[NSBundle mainBundle] pathForResource:@"FriendsDatabase" ofType:@"sqlite3"] toPath:dbFileName error:&error];
    NSLog(@"database created");
} else {
    NSLog(@"fail to create database");
}

FMDatabase  *_db = [[FMDatabase alloc] initWithPath: dbFileName];
if (![_db open]) {
    [_db release];
    NSLog(@"Could't open DB");
    }
_db.logsErrors = NO;

self.db = _db;
[_db release];
} 
```

但我有一个错误：`'NSInvalidArgumentException', reason: '*** -[NSFileManager copyItemAtPath:toPath:error:]: source path is nil'`。我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:20:21.587

看起来您的主包中没有名为“FriendsDatabase.sqlite3”的文件。（如果你有一个，你调用的源路径`-copyItemAtPath:toPath:error:`就不会是零。）

尝试将您的代码更改为如下所示：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"FriendsDatabase" ofType:@"sqlite3"];
[fileManager copyItemAtPath:path toPath:dbFileName error:&error]; 
```

然后使用调试器单步执行代码并检查`path`.

请注意，您已将“FriendsDatabase”（注意“s”）指定为代码中的文件名，但您的注释将文件称为“FriendDatabase”。也许您只是在代码中拼错了文件名——这是使用常量的好理由！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T03:39:48.353

Caleb 的回答是正确的，但我要补充一点，您必须确保 sqlite3 文件是您的目标的成员。在 XCode 中，选择您的 sqlite3 文件，然后打开“Target Membership”下的“File Inspector”面板（右侧面板）。确保您的目标应用程序已选中。

# undefined - jQuery tmpl：处理空/未定义元素

> ID：10710281
> 
> 赞同：1
> 
> 时间：2012-05-22T21:15:06.657
> 
> 标签：undefined, jquery-templates

我有一个 Web 服务返回的数据结构。它有几个层次，可能有 null 而不是预期的对象。这会导致检查一些丑陋的代码。

```
<td>{{if FulfilledBy}}${FulfilledBy.Name}{{/if}}</td> 
```

我无法更改服务的输出，但我不想`FulfilledBy`在访问`.Name`属性之前检查是否存在。

有没有更好的方法来写这个？我会更喜欢类似的东西

```
<td>${(FulfilledBy || {}).Name}</td> 
```

但它也不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T19:28:05.013

根据文档，您可以在`${}`. 你试过`${FulfilledBy? FulfilledBy.Name: 'no name'}`吗？

# permgen - 从 ant 调用 install4j 编译器会导致 PermGen OutOfMemory 错误

> ID：10710284
> 
> 赞同：1
> 
> 时间：2012-05-22T21:15:27.113
> 
> 标签：permgen, install4j

我遇到了这样一种情况：install4j v4.2.8 在使用 GUI 和从命令行调用 install4jc 时运行良好并生成安装程序，但在通过 install4j ant 任务调用时失败并显示以下消息：

```
install4j: compilation failed. Reason: java.lang.OutOfMemoryError: PermGen space 
```

使用 visualvm，我确定 ant 任务正在分叉一个单独的 JVM，当 PermGen 使用量达到大约 88MB 时，它似乎失败了。install4j ant 任务文档没有说明能够将 VM args（例如 -XX:MaxPermSize=256MB）传递到分叉的 JVM，但我想知道是否可以选择这种方法或类似的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T08:38:47.087

您可以在文件[install4j安装目录]/bin/install4j.vmoptions中调整命令行编译器的VM参数。只需在此处增加 -Xmx 值并添加 -XX:MaxPermSize VM 参数。

在 install4j 5.0.7 之前，存在与在 .vmoptions 文件中包含相关文件相关的错误。对于这些旧版本，请删除 install4jc.vmoptions 中对 install4j.vmoptions 的包含并直接在此处添加 VM 参数。

# maven-2 - 使用 Maven 的部署插件创建指向最新版本的链接

> ID：10710285
> 
> 赞同：0
> 
> 时间：2012-05-22T21:15:34.180
> 
> 标签：maven-2

我的 pom.xml 包含：

```
<distributionManagement>
  <repository>
    <id>ssh-myown-repository</id>
    <url>scpexe://user@host/path/to/repository</url>
  </repository>
</distributionManagement> 
```

所以每当我发出：

```
mvn deploy 
```

我的项目很好地部署在我的远程存储库上，名称如下：

```
http://host/repository/project/0.7.0-SNAPSHOT/project-0.7.0-20120518.212052-3.jar 
```

我知道文件“maven-metadata.xml”包含有关哪个文件是最新版本的信息，但我非常喜欢 mvn deploy 阶段来创建指向最新 jar 文件的链接，比如：

```
http://host/repository/project/0.7.0-SNAPSHOT/project-0.7.0-latest.jar 
```

我了解“scpexe”无法直接执行此操作，因为链接是运行 Web 服务器的文件系统的一部分（即：它们不表示为可上传的文件内容）。

我在这个远程服务器上有 shell 访问权限，那么有没有办法在部署完成后挂钩 maven 的部署操作以执行脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T18:58:55.870

您知道**-SNAPSHOT**类似于“最新”。此外，我建议使用存储库管理器。

# android - 当 seekBar 到达终点时如何捕获事件

> ID：10710287
> 
> 赞同：3
> 
> 时间：2012-05-22T21:15:47.097
> 
> 标签：android, android-widget

我在屏幕上有媒体播放器和一个显示 .mp3 文件（位置）进度的 seekBar。当 seekBar 到达末尾（最大值）而不使用 mediaPlayer 时如何捕获事件？有没有其他方法或者我需要检查每次进度更改并手动触发事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:28:47.313

为什么不想使用与 SeekBar 关联的 MediaPlayer？MediaPlayer 公开了一个 onCompletion 回调：

```
OnCompletionListener cListener = new OnCompletionListener(){

    public void onCompletion(MediaPlayer mp){
        //do something
    }
};

mediaPlayer.setOnCompletionListener(cListener); 
```

# javascript - 使用android中的javascript函数在webview中定位内容

> ID：10710288
> 
> 赞同：2
> 
> 时间：2012-05-22T21:15:50.937
> 
> 标签：javascript, android, webview, scroll

我有一些与 android 中的 javascript 和 webview 相关的问题。我需要在 webView 中设置一些文本。我用 epub 填充 webview。要设置在顶部的文本的每个部分都具有以下标记：

```
<input name="chapterNumber" type="hidden" value="chapter1" id="chapter1"> 
```

及以上 y 具有以下 javascript 函数：

```
<script type="text/javascript">
  //<![CDATA[

        $(document).ready(function() {
            function findPos(obj) {
              var curtop = 0;
              if (obj.offsetParent) {
                   do {
                   curtop += obj.offsetTop;
                      } while (obj = obj.offsetParent);
                        return [curtop];
              }
            }
    });
  //]]>
  </script> 
```

在活动中我有：

```
webView.setWebViewClient(new WebViewClient() {  
            @Override  
            public void onPageFinished(WebView view, String url)  
            {  
                    webView.loadUrl("javascript:window.scroll(0,findPos(document.getElementById('chapter1')))");

            }  
        }); 
```

但是滚动不起作用。第 1 章不在顶部。我怎么能改变这个？

提前致谢

# android - 横向模式视频活动正在重新启动

> ID：10710289
> 
> 赞同：0
> 
> 时间：2012-05-22T21:15:52.400
> 
> 标签：android, video, landscape

我在我的应用程序中播放视频，视频应该播放纵向和横向模式而不需要重新启动活动，请任何可以给出示例的链接。

*   使用视频视图播放视频。

    ```
    public class PlayVideoActivity extends Activity {

    private VideoView video;
    private ImageButton back;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.main);

        back = (ImageButton)findViewById(R.id.backbutton);
        back.setOnClickListener(new View.OnClickListener() {

            public void onClick(View arg0) {

                finish();
            }
        });

        video=(VideoView)findViewById(R.id.videoView);

        video.setDrawingCacheEnabled(true);
        video.setDrawingCacheQuality(VideoView.DRAWING_CACHE_QUALITY_HIGH);

        video.setVideoURI(Uri.parse("android.resource://"+ getPackageName() +"/" + R.raw.fillings_class_1));
        video.requestFocus();
        video.setMediaController(new MediaController(this));
        video.start();

    }

       @Override
       public void onRestoreInstanceState(Bundle savedInstanceState) {
           super.onRestoreInstanceState(savedInstanceState);
           //restore the relevant information

       }

    } 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:22:36.500

如果确实需要防止 Activity 在方向更改时重新启动，则需要将`configChanges`清单中 Activity 的属性设置为 include `orientation`。

# matlab - 将按钮颜色更改回原始值

> ID：10710296
> 
> 赞同：0
> 
> 时间：2012-05-22T21:16:13.587
> 
> 标签：matlab

我正在尝试在 matlab 中制作[Simon](http://en.wikipedia.org/wiki/Simon_%28game%29)游戏的一个版本，我想让按钮在按下它后恢复到原来的颜色，但是按钮保持新颜色。我正在使用的代码是：

```
clc, clf, clear
h1=figure(1);
button1=uicontrol(h1, 'Style','Pushbutton', 'Units','Normalized','Position',...
[0.1 0.1 0.2 0.2],'Backgroundcolor', [1 0 0],...
'Callback',['value1=get(button1,''Value''); if value1==1',...
'set(button1,''Backgroundcolor'',[0 1 0]); else ,',...
'set(button1, ''BackgroundColor'',''r''), end,value2=get(button1,''Value'')']); 
```

如果运行它，您会注意到颜色保持绿色，我该怎么做才能自动将其恢复为红色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:19:37.020

您的代码中的主要问题是按下按钮仅检查 的`Value`属性`button1`，但不会更改它以供将来按下。因此，`Value`of`button1`总是被评估为 0，因此按钮永远不会改变颜色。

以下工作代码似乎可以满足您的要求：

```
clc, clf, clear
h1 = figure(1);
button1_state = 1;
button1_callback = ...
   ['if (button1_state == 1), set(button1, ''Backgroundcolor'', ''g''),' ...
    'else set(button1, ''BackgroundColor'', ''r''), end, ' ...
    'button1_state = ~button1_state;'];
button1 = uicontrol(h1, 'Style', 'Pushbutton', 'Units', 'Normalized', ...
   'Position', [0.1 0.1 0.2 0.2], 'Backgroundcolor', 'r', ...
   'Callback', button1_callback); 
```

我在这里所做的是创建一个变量`button1_state`来保存当前的“状态” `button1`（1 代表红色，0 代表绿色）。在回调操作中，我根据当前状态更改按钮的背景颜色，然后翻转状态。

希望能帮助到你！

PS请注意，出于可读性原因
，我将回调操作单独放在字符串中。`button1_callback`它实际上会展开成这样：

```
if (button1_state == 1)
   set(button1, 'Backgroundcolor', 'g')
else
   set(button1, 'BackgroundColor', 'r')
end
button1_state = ~button1_state; 
```

# .net - 让 .NET 链接按钮在 iOS Web 应用程序中工作

> ID：10710304
> 
> 赞同：2
> 
> 时间：2012-05-22T21:16:32.243
> 
> 标签：.net, ios, mobile-safari, linkbutton

我有一个网站，可以作为图标添加到 iPhone/iPad 主屏幕（所有网站都可以）。点击图标时，网站会以全屏模式显示（耶）。为了防止该网站上的所有链接在 safari 中打开，从而脱离全屏模式，我将覆盖所有 html 锚点的点击事件。这很好用，但不适用于 .NET 链接按钮，可能是因为它们需要进行回发。

这是我的代码：

```
var iOS = (navigator.userAgent.match(/(iPad|iPhone|iPod)/i) ? true : false);
if (iOS) {
    $("a").click(function (event) {
        var href = $(this).attr("href");
        if (href.indexOf("doPostBack") == -1 && href.indexOf("javascript") == -1) {
            event.preventDefault();
            window.location = $(this).attr("href");
        }
    });
} 
```

正如您所看到的，如果href 包含“doPostBack”（Linkbuttons 会这样做），或者如果它们包含“javascript”（这是用于例如 onclick='xxx()' 的链接），我会尝试阻止这种特殊行为。但这不起作用。使用 Linkbutton 创建的链接没有响应，我不知道为什么。

非常感谢任何帮助。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T21:31:14.943

好的。经过长时间的专门讨论这个问题后，我终于解决了这个问题。如果您只是想要解决方案，请跳到最后。

首先，它不仅仅是链接按钮，而是使用 javascript 进行回发的所有内容。它可以是 autopostback = true 的下拉列表，与 ASP.NET 复选框相同，等等。= 一个大问题..

首先，我发现全屏时 iPhone/iPad 的用户代理有所不同。第一个是 Safari，第二个是全屏“应用程序”。

```
Mozilla/5.0 (iPad; CPU OS 5_0_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9A405 Safari/7534.48.3
Mozilla/5.0 (iPad; CPU OS 5_0_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9A405 
```

所以。这里发生了什么事？嗯，.NET 的浏览器定义文件不能识别第二个用户代理，它默认为“Mozilla”，一个非常标准化和低级的浏览器定义，功能非常低。我尝试创建一个自定义浏览器文件，在其中定义了一个“新”浏览器，将用户代理与正则表达式匹配：如果它包含 iPhone/iPad/iPod - 告诉 .NET 这是一个 Safari 浏览器，而不是 Mozilla。不幸的是，我没有设法让它工作。既不将文件添加到 App_Browsers 文件夹，也不通过框架全局注册文件。

反正。我继续寻找解决方案，并找到了一个我修改了一下的解决方法。在您页面的 PreInit 方法（或者更确切地说是您的基本页面的 PreInit 方法）中执行以下操作：

```
protected void Page_PreInit(object sender, EventArgs e)
{
    if (Request.UserAgent != null && (Request.UserAgent.Contains("iPhone") || Request.UserAgent.Contains("iPad") || Request.UserAgent.Contains("iPod")))
        this.ClientTarget = "uplevel";
} 
```

This will make the browser look like IE6 to .NET which will make everything works perfectly. A heads up: If you are detecting for old browsers (IE 6 for example) anywhere in your code. Make sure it still works after this workaround. I had to add an extra if statement to exclude iOS devices from beeing redirected to my "you-got-an-old-browser-page".

# ios - 以编程方式从 cocos2d 内部进行 Seguing

> ID：10710305
> 
> 赞同：0
> 
> 时间：2012-05-22T21:16:32.637
> 
> 标签：ios, uikit, cocos2d-iphone, segue

我是 cocos2d 的初学者，我正在尝试从 cocos2d 内部执行 segue。

目前我设置了以下功能：

```
-(void) return_mm {
    NSLog(@"returned to main menu");
    UIViewController * con = self.controller;
    [con performSegueWithIdentifier:@"Game2MenuSegue" sender:con];
} 
```

每当按下 CCMenuItem 时运行。这实际上确实有效一次。但是，当我重新回到游戏场景时，菜单按钮停止工作。

更具体地说，调用 segue 并运行 preparetosegue 函数，但没有发生转换。另一个视图的 viewWillAppear 函数永远不会运行。

我可能在做一些愚蠢的事情，所以如果有人对此有建议，将不胜感激。

这是我目前在游戏视图控制器的 willDidAppear 函数中拥有的。

```
- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];

    if ([[CCDirector sharedDirector] isPaused]) {

        [[CCDirector sharedDirector] resume];

        [mainView addSubview:[[CCDirector sharedDirector] openGLView]];

        return;
    }

    EAGLView *glview = [EAGLView viewWithFrame:self.view.bounds
                                   pixelFormat:kEAGLColorFormatRGB565   // kEAGLColorFormatRGBA8
                                   depthFormat:0                        // GL_DEPTH_COMPONENT16_OES
                        ];
    CCDirector *director = [CCDirector sharedDirector];

    //[director setDisplayStats:kCCDirectorStatsFPS];    
    // Enables High Res mode (Retina Display) on iPhone 4 and maintains low res on all other devices

    if( ! [director enableRetinaDisplay:YES] )
        CCLOG(@"Retina Display Not supported");

    [window makeKeyAndVisible];

    [mainView addSubview:glview];

    [director setOpenGLView:glview];

    CCScene *scene = [CCScene node];
    GameScene * gs =[GameScene sceneWithController:self]; 
    [gs returnFromMenu];
    [scene addChild:gs];

    if (director.runningScene) {
        [director replaceScene:scene];
    } else {
        [director runWithScene:scene];
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T23:01:27.297

我发现了问题。我在创建时保存了控制器，但是当它重新进入游戏视图时没有更新它。控制器已经过时，所以 segue 没有做任何事情。

我只需要添加

```
gs.controller = self 
```

在对 super 的调用下方

# php - 在 PHP 中的 foreach 循环中对项目进行分组

> ID：10710307
> 
> 赞同：3
> 
> 时间：2012-05-22T21:16:34.380
> 
> 标签：php, loops, grouping

所以，我正在尝试制作一种用户市场类型的东西。有一个数据库`item_names`，基本上描述了虚拟物品，然后有另一个表`market`，当用户列出他们的一个项目时，它就会在用户用户市场上出售。

我唯一的问题是我想按`item_name`表中引用的项目名称对其进行分组。我知道我可以做一堆 if/else 语句，但这是无关紧要的，不仅因为有很多项目，而且因为随着时间的推移我会添加更多项目。我希望最终结果类似于

```
--[Water for sale]---------------------+

[50 water for sale] [20 water for sale]

[10 water for sale] [10 water for sale]

--[Chips for sale]----------------------+

[50 chips for sale] [20 chips for sale]

[10 chips for sale] [10 chips for sale] 
```

依此类推，动态完成。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T21:22:28.257

获取数据：

```
$data = array();
while ($row = mysql_fetch_assoc($result)) {
  $itemName = $row["item_name"];
  if (!array_key_exists($itemName, $data)) {
    $data[$itemName] = array();
  }
  $data[$itemName][] = $row;
} 
```

显示数据

```
foreach ($data as $itemName => $rows) {
  echo '<h1>', $itemName, '</h1>';
  echo '<ul>';
  foreach ($rows as $row) {
    echo '<li>', $row["article_name"], '</li>';
  }
  echo '</ul>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:26:54.737

确保您对 SQL 查询的结果进行*排序*（而不是*group*），那么循环将非常简单（假设 PDO 和`item_name`table 上的列`item_names`）：

```
$sth = $dbh->query ("SELECT * FROM item_names ORDER BY item_name");
$lastname = '';
while ($row = $sth->fetch()) {
    if($lastname != $row['item_name']) {
        echo '<h1>' . $row['item_name'] . '</h1>';
    }
    // echo contents for each item here

    // remember name from last row
    $lastname = $row['item_name'];
} 
```

# python - Python：控制结构中的正则表达式

> ID：10710309
> 
> 赞同：0
> 
> 时间：2012-05-22T21:16:35.647
> 
> 标签：python, regex

> **可能重复：**
> [如何在 Python 中检查文本是否为“空”（空格、制表符、换行符）？](https://stackoverflow.com/questions/2405292/how-to-check-if-text-is-empty-spaces-tabs-newlines-in-python)

我正在尝试编写一个简短的函数来处理文件中的文本行。当它遇到具有重要内容的行（意味着不仅仅是空格）时，它就是对该行做一些事情。我想要的控制结构是

```
if '\S' in line: do something 
```

或者

```
if r'\S' in line: do something 
```

（我也用双引号尝试了相同的组合，是的，我已经导入了 re。）`if`上面的语句，在我尝试的所有形式中，总是返回 False。最后，我不得不求助于测试

```
if re.search('\S', line) is not None: do something 
```

`if`这行得通，但与简单的陈述相比，感觉有点笨拙。那么，我的问题是，为什么该`if`声明不起作用，有没有办法（看似）优雅而简单地做一些事情？

我还有一个与控制结构无关的问题，但由于我怀疑它也与可能非法使用正则表达式有关，所以我会在这里问它。如果我有一个字符串

s = " \t\t 一些文本 \t \n\n"

编码

```
s.strip('\s') 
```

返回包含空格、制表符和换行符的相同字符串（r'\s' 也不例外）。编码

```
s.strip() 
```

返回“一些文本”。这一点，即使在没有字符串的情况下调用 strip 应该默认剥离空白字符，在我看来，这正是表达式 '\s' 正在做的事情。为什么一个剥离空白而另一个不剥离？

感谢您的任何澄清。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:24:53.647

Python 字符串函数不知道正则表达式，所以如果你想使用它们，你必须使用`re`模块。

但是，如果您只想找出字符串是否完全是空格，则可以使用以下[`str.isspace()`](http://docs.python.org/library/stdtypes.html#str.isspace)函数：

```
>>> 'hello'.isspace()
False
>>> '  \n\t  '.isspace()
True 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:19:07.423

这就是你要找的

```
if not line.isspace(): do something 
```

此外，`str.strip`不使用正则表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T21:21:38.053

如果您真的只是想知道该行是否仅包含空格字符，则正则表达式有点矫枉过正。你应该得到以下代替：

```
if text.strip():
    #do stuff 
```

这基本上与以下内容相同：

```
if not text.strip() == "":
    #do stuff 
```

Python 将每个非空字符串计算为`True`. 因此 if`text`仅包含空格字符，`text.strip()`等于`""`并因此计算为`False`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T21:41:04.013

该表达式与任何其他测试`'\S' in line`执行相同的操作；`string in line`它测试左边的字符串是否出现在右边的字符串中。它不会**隐**式编译正则表达式并搜索匹配项。这是*一件好事*。如果您正在编写一个操作用户输入的正则表达式的程序，并且您*实际上*想测试`\S`输入表达式中是否有某些子表达式，该怎么办？

同样，请阅读`str.strip`. 它是否说会将其输入视为正则表达式并删除匹配的字符串？不。如果你想用正则表达式做一些事情，你必须实际告诉 Python，不要指望它会以某种方式猜测你这次指的是正则表达式，而其他时候它只是指普通字符串。虽然您可能认为搜索正则表达式与搜索字符串非常相似，但就语言实现而言，它们是*完全不同的操作。*大多数`str`方法在应用于正则表达式时甚至都没有意义。

因为`re.match`对象在布尔上下文中是“真实的”（就像大多数类实例一样），所以您至少可以通过删除测试来缩短您的`if`语句。`is not None`该行的其余部分对于实际告诉 Python 你想要什么是必要的。至于您的`str.strip`情况（或您想要执行类似于字符串操作但使用正则表达式的其他情况），请查看`re`模块中的函数；那里有许多有用的便利功能。否则`re_split`自己实现一个功能应该很容易。

# .net - 允许非开发人员定义 Workflow Foundation 4 流程的解决方案

> ID：10710311
> 
> 赞同：2
> 
> 时间：2012-05-22T21:16:42.527
> 
> 标签：.net, xaml, workflow-foundation-4, designer

我们将为我们的客户提供基于 SenseNet ECM 的定制解决方案。解决方案包括灵活的业务流程声明能力。SenseNet 在很多方面都适合我们，除了我们今天评估的所有演示都显示出一个很大的缺点 -`XAML`工作流基础文件用于创建逻辑工作流实现（抱歉术语混乱）。在 Visual Studio 中。我们不能向我们的客户提供需要 VS 才能完全发挥作用的东西，我们也不能说“嘿，我们会在您每次需要时为您做”。

是否有现成的解决方案允许`xaml`在更用户友好的环境中定义 .Net 4 WF？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T22:43:26.120

您可以在自己的 WPF 应用程序上重新托管 Visual Studio 使用的工作流设计器：

**[重新托管工作流设计器](http://msdn.microsoft.com/en-us/library/dd489451.aspx)**：

*   [任务 1：创建 WPF 应用程序项目](http://msdn.microsoft.com/en-us/library/dd489414.aspx)
*   [任务 2：托管 Workflow Designer](http://msdn.microsoft.com/en-us/library/dd489407.aspx)
*   [任务 3：创建工具箱和 PropertyGrid 窗格](http://msdn.microsoft.com/en-us/library/dd489433.aspx)

（另请查看[此博客文章](https://msmvps.com/blogs/theproblemsolver/archive/2009/12/23/rehosting-the-workflow-designer-in-wf4.aspx?ocid=aff-n-we-loc--DEV40909&WT.mc_id=aff-n-we-loc--DEV40909)，以获得更快的介绍，包括示例解决方案）

# asp.net - ASP.NET Web API 内存测试中的内部服务器错误

> ID：10710314
> 
> 赞同：8
> 
> 时间：2012-05-22T21:16:54.693
> 
> 标签：asp.net, asp.net-web-api

[在内存测试中](http://pfelix.wordpress.com/2012/03/05/asp-net-web-api-in-memory-hosting/)测试 ASP.NET Web API 控制器时，我收到“内部服务器错误”（状态代码 500）。

```
[TestFixture]
public class ValuesControllerTest
{
    private HttpResponseMessage response;

    [TestFixtureSetUp]
    public void Given()
    {
        var config = new HttpConfiguration
        {
            IncludeErrorDetailPolicy = IncludeErrorDetailPolicy.Always
        };

        config.Routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { controller = typeof(ValuesController).Name.Replace("Controller", string.Empty), id = RouteParameter.Optional }
        );

        //This method will cause internal server error but NOT throw any exceptions
        //Remove this call and the test will be green
        ScanAssemblies();

        var server = new HttpServer(config);
        var client = new HttpClient(server);
        response = client.GetAsync("http://something/api/values/5").Result;
        //Here response has status code 500

    }

    private void ScanAssemblies()
    {
        PluginScanner.Scan(".\\", IsApiController);
    }

    private bool IsApiController(Type type)
    {
        return typeof (ApiController).IsAssignableFrom(type);
    }

    [Test]
    public void Can_GET_api_values_5()
    {
        Assert.IsTrue(response.IsSuccessStatusCode);
    }
}

public static class PluginScanner
{
    public static IEnumerable<Type> Scan(string directoryToScan, Func<Type, bool> filter)
    {
        var result = new List<Type>();
        var dir = new DirectoryInfo(directoryToScan);

        if (!dir.Exists) return result;

        foreach (var file in dir.EnumerateFiles("*.dll"))
        {
            result.AddRange(from type in Assembly.LoadFile(file.FullName).GetTypes()
                            where filter(type)
                            select type);
        }
        return result;
    }
} 
```

我已将 Visual Studio 配置为在引发任何 .Net 异常时中断。代码不会因任何异常而停止，我也无法在响应中找到任何异常详细信息。

我应该怎么做才能查看导致“内部服务器错误”的原因？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-23T10:53:29.237

例外是在 Response.Content

```
if (Response != null && Response.IsSuccessStatusCode == false)
{
    var result = Response.Content.ReadAsStringAsync().Result;
    Console.Out.WriteLine("Http operation unsuccessful");
    Console.Out.WriteLine(string.Format("Status: '{0}'", Response.StatusCode));
    Console.Out.WriteLine(string.Format("Reason: '{0}'", Response.ReasonPhrase));
    Console.Out.WriteLine(result);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T21:36:44.967

您需要添加一条路线，使其看起来像这样：

```
 var config = new HttpConfiguration()
        {
            IncludeErrorDetailPolicy = IncludeErrorDetailPolicy.Always
        };

        config.Routes.MapHttpRoute(
            name: "default",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { controller = "Home", id = RouteParameter.Optional });

        var server = new HttpServer(config);
        var client = new HttpClient(server);

        HttpResponseMessage response = client.GetAsync("http://somedomain/api/product").Result; 
```

顺便说一句，在最新的位中，您会得到 404 Not Found，如您所料。

亨里克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T19:45:56.517

听起来您可能已经找到了答案，但这对我来说并不完全如此，所以我想为其他有我的问题的人添加这个。

首先，这似乎是新的 MVC 4 格式化程序的问题。设置任何错误策略标志都不起作用（IncludeErrorDetailPolicy、CustomErrors 等），这些格式化程序会忽略它们，只是返回并清空“内部服务器错误”500。

我最终通过重载格式化程序并检查它们的响应是否有错误发现了这一点：

```
public class XmlMediaTypeFormatterWrapper : XmlMediaTypeFormatter
{
    public override Task WriteToStreamAsync(Type type, object value, Stream stream, HttpContentHeaders contentHeaders, TransportContext transportContext)
    {
        var ret = base.WriteToStreamAsync(type, value, stream, contentHeaders, transportContext);
        if (null != ret.Exception)
            // This means there was an error and ret.Exception has all the error message data you would expect, but once you return below, all you get is a blank 500 error...

        return ret;
    } 
} 
```

现在我正在使用 Xml 和 Json 格式化程序包装器，它们只是查找 ret.Exception 并捕获它，因此如果发生 500，我至少有数据。我真的找不到一种优雅的方法来使错误实际显示在 html 响应中，因为 Task.Exception 已经设置，这应该是传递异常所需的全部。

# java - 是否可以将自定义元数据添加到 .class 文件？

> ID：10710325
> 
> 赞同：6
> 
> 时间：2012-05-22T21:18:16.957
> 
> 标签：java, debugging, bytecode

我们在公司使用 liquibase 已经有一段时间了，我们已经为数据库迁移设置了一个持续集成环境，当补丁出现错误时，它会破坏工作。

该 CI 环境的一个有趣“特征”是破坏有一个“可能的罪魁祸首”，因为所有补丁都需要有一个“作者”，并且错误消息显示作者姓名。

如果你不知道什么是 liquibase，没关系，这不是重点。

关键是：在错误后面加上**人名**对软件开发过程非常有好处：**问题得到解决的速度更快**。

所以我在想：Java 堆栈跟踪有可能吗？

我们是否可能有一个带有人名和行号的堆栈跟踪，如下所示？

```
java.lang.NullPointerException
 at org.hibernate.tuple.AbstractEntityTuplizer.createProxy(AbstractEntityTuplizer.java:372:john)
 at org.hibernate.persister.entity.AbstractEntityPersister.createProxy(AbstractEntityPersister.java:3121:mike)
 at org.hibernate.event.def.DefaultLoadEventListener.createProxyIfNecessary(DefaultLoadEventListener.java:232:bob)
 at org.hibernate.event.def.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:173:bob)
 at org.hibernate.event.def.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:87:bob)
 at org.hibernate.impl.SessionImpl.fireLoad(SessionImpl.java:862:john) 
```

这种信息必须从 SCM 系统中提取出来（比如对每个源文件执行“svn blame”）。

现在，暂时忘记浪费编译时间：这可能吗？像这样将元数据添加到类文件中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:28:28.547

原则上，您可以将自定义信息添加到 .class 文件（您可以在其中添加内容的属性部分）。为此，您必须编写自己的编译器/编译器扩展。无法在源代码中添加一些内容，然后这些内容将显示在类文件中。你在实践中也会遇到大问题：

1.  堆栈跟踪构建/打印的方式不知道您添加到类文件中的任何内容。所以如果你想像上面展示的那样打印这些东西，你必须破解一些核心 JDK 类。
2.  你想要多少细节？最后一个对给定文件进行任何更改的人？这在实践中不够精确，除非文件由单个开发人员拥有。
3.  以更精细的粒度添加“last-committed-by”信息，比如每个方法，或者更糟糕的是，每行会迅速膨胀你的类文件（并且类文件的大小限制为 64K）

作为旁注，将错误归咎于人们是否有助于更快地修复错误在很大程度上取决于开发组织的文化。在你花费大量时间开发类似的东西之前，请确保你在一个有帮助的地方工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:30:25.300

一种使用源代码中的[注释将自定义信息添加到类文件的方法。](http://docs.oracle.com/javase/1.5.0/docs/guide/language/annotations.html)我不知道如何将这些信息可靠地放在堆栈跟踪中，但您可以创建一个工具来检索它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T15:00:51.683

通常，此类功能可以在版本控制系统之上实现。您需要知道版本控制系统中文件的修订版本，然后您可以调用[blame/annotate](http://git.or.cz/course/svn.html#browse)命令来获取有关谁更改了每一行的信息。您不需要将此信息存储到类文件中，只要您可以识别您部署的每个类的修订版（例如，您只部署某些标签或标签）。

If you don't want to go into the version control when investigating stack trace, you could store line annotation info into the class file, e.g. using class post processor during your build that can add a custom annotation at the class level (this is relatively trivial to implement using [ASM](http://asm.ow2.org/)). Then logger that prints stack trace could read this annotation at runtime, similarly to [showing jar versions](http://macstrac.blogspot.com/2008/09/better-stack-traces-in-java-with-log4j.html).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T21:38:17.103

正如@theglauber 正确指出的那样，您可以使用注释来添加自定义元数据。尽管我不确定您是否无法从实现 bean 的数据库中检索该信息并装饰您的自定义异常管理器。

# css - 火花数据网格交替项目颜色

> ID：10710326
> 
> 赞同：0
> 
> 时间：2012-05-22T21:18:27.877
> 
> 标签：css, actionscript-3, apache-flex, mxml

我尝试使用 css 文件自定义火花数据网格。我对 alterItemColors 属性有疑问，因为所有线条都是白色的。相同的代码适用于 mx|DataGrid

```
 s|DataGrid
    {

        backgroundAlpha: 0.6;
        borderThickness: 1;
        borderColor: #0085Ac;
        /* Couleur de la zone de titre  */
        /*headerColors: #006699, #6ea4f8;*/
        headerColors : #6db8e0, #50a3ce;
        horizontalGridLines: false;
        verticalGridLines: true;
        verticalGridLineColor: #003366; 
        alternatingItemColors: #ffffff, #eeeeee;
        rollOverColor: #b3b7d9;
        textRollOverColor: #0c1e37;
        selection-color:#66B0C0;
        color :#0c1e37;

        headerStyleName: "mydataGridHeaderStyle";
    } 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:24:09.403

看起来 Spark DataGrid 中的样式名称已更改。它现在有一个名为[alternateRowColors的样式](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/DataGrid.html#style%3aalternatingRowColors)

# javascript - 在 d3.js 中重新绑定数据的最佳方法

> ID：10710327
> 
> 赞同：9
> 
> 时间：2012-05-22T21:18:44.460
> 
> 标签：javascript, d3.js

我正在使用 d3.js 库根据数据生成内容。

这是一个简化的例子。

```
data_arr = [0,1,2,3,4];
d3.select("#mylist").selectAll('li').data(data_arr).enter().append("li").html(
    function(d)
    {
        var element = document.createElement('div');
        element.innerHTML = '<div id="innerDiv">' + d + '</div>';
        return element.innerHTML;
   }); 
```

如果我更改我的数组，例如新数据是 [5,3]。重新绑定和显示新 html 的最佳方式是什么？我必须再次调用同一个句子还是更好的方法？

考虑更复杂的数据结构的情况。IE

```
data_arr = [obj1, obj2, obj3, obj4]; 
```

和

```
element.innerHTML = '<div id="innerDiv">' + d.field + '</div>'; 
```

如果我执行 obj1.field = 'newValue' 会发生什么。重新绑定是如何完成的？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-22T23:04:09.107

使用一个函数。例如，这是一个从字符串数组填充列表的函数：

```
function list(ul, data) {
  var li = ul.selectAll("li").data(data);
  li.exit().remove();
  li.enter().append("li");
  li.text(function(d) { return d; });
} 
```

现在如果你想初始化你的列表，你可以说：

```
d3.select("#list").call(list, [0, 1, 2, 3, 4]); 
```

然后以后如果你想更新，你可以说：

```
d3.select("#list").call(list, [5, 3]); 
```

如果您愿意（并且您不需要方法链接），您可以在没有[selection.call](https://github.com/mbostock/d3/wiki/Selections#wiki-call)的情况下编写：

```
list(d3.select("#list"), [5, 3]); 
```

# python - 比较包含 NaN 的 numpy 数组

> ID：10710328
> 
> 赞同：85
> 
> 时间：2012-05-22T21:18:46.673
> 
> 标签：python, numpy, nan, equality-operator

对于我的单元测试，我想检查两个数组是否相同。简化示例：

```
a = np.array([1, 2, np.NaN])
b = np.array([1, 2, np.NaN])

if np.all(a==b):
    print 'arrays are equal' 
```

这不起作用，因为`nan != nan`. 最好的方法是什么？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-05-22T21:24:50.127

对于 1.19 之前的 numpy 版本，这可能是不特别涉及单元测试的情况下的最佳方法：

```
>>> ((a == b) | (numpy.isnan(a) & numpy.isnan(b))).all()
True 
```

但是，现代版本为该`array_equal`函数提供了一个新的关键字参数 ，`equal_nan`它完全符合要求。

这是flyingdutchman首先指出的；有关详细信息，请参阅下面[的答案](https://stackoverflow.com/a/65219253/577088)。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-05-22T21:42:36.257

或者，您可以使用[`numpy.testing.assert_equal`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.testing.assert_equal.html#numpy.testing.assert_equal)或：[`numpy.testing.assert_array_equal`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.testing.assert_array_equal.html)`try/except`

```
In : import numpy as np

In : def nan_equal(a,b):
...:     try:
...:         np.testing.assert_equal(a,b)
...:     except AssertionError:
...:         return False
...:     return True

In : a=np.array([1, 2, np.NaN])

In : b=np.array([1, 2, np.NaN])

In : nan_equal(a,b)
Out: True

In : a=np.array([1, 2, np.NaN])

In : b=np.array([3, 2, np.NaN])

In : nan_equal(a,b)
Out: False 
```

**编辑**

由于您将其用于单元测试，因此 bare `assert`（而不是将其包装为 get `True/False`）可能更自然。

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2017-08-14T13:05:21.487

最简单的方法是使用`numpy.allclose()`方法，它允许指定具有 nan 值时的行为。然后您的示例将如下所示：

```
a = np.array([1, 2, np.nan])
b = np.array([1, 2, np.nan])

if np.allclose(a, b, equal_nan=True):
    print('arrays are equal') 
```

然后`arrays are equal`会被打印出来。

您可以在[此处](https://docs.scipy.org/doc/numpy/reference/generated/numpy.allclose.html)找到相关文档

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-05-22T21:23:25.867

您可以使用 numpy 屏蔽数组，屏蔽`NaN`值，然后使用`numpy.ma.all`or `numpy.ma.allclose`：

[http://docs.scipy.org/doc/numpy/reference/generated/numpy.ma.all.html](http://docs.scipy.org/doc/numpy/reference/generated/numpy.ma.all.html)

[http://docs.scipy.org/doc/numpy/reference/generated/numpy.ma.allclose.html](http://docs.scipy.org/doc/numpy/reference/generated/numpy.ma.allclose.html)

例如：

```
a=np.array([1, 2, np.NaN])
b=np.array([1, 2, np.NaN])
np.ma.all(np.ma.masked_invalid(a) == np.ma.masked_invalid(b)) #True 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2020-12-09T14:57:19.710

numpy 函数[array_equal](https://numpy.org/doc/stable/reference/generated/numpy.array_equal.html#numpy.array_equal)完全符合问题的要求。当被问到时，它很可能不存在。该示例如下所示：

```
a = np.array([1, 2, np.NaN])
b = np.array([1, 2, np.NaN])
assert np.array_equal(a, b, equal_nan=True) 
```

但是请注意，如果元素是 dtype ，这将不起作用`object`。不确定这是否是[错误](https://github.com/numpy/numpy/issues/19205)。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-11-05T10:13:57.273

只是为了完成[@Luis Albert Centeno 的回答](https://stackoverflow.com/a/45675197/8729073)，您可能宁愿使用：

```
np.allclose(a, b, rtol=0, atol=0, equal_nan=True) 
```

`rtol`并`atol`控制等式检验的容差。简而言之，[`allclose()`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.allclose.html)返回：

```
all(abs(a - b) <= atol + rtol * abs(b)) 
```

默认情况下，它们未设置为 0，因此`True`如果您的数字接近但不完全相等，该函数可能会返回。

* * *

PS：“我想检查两个数组是否*相同*”>>实际上，您正在寻找**equal**而不是*identity*。它们在 Python 中是不一样的，我认为每个人都最好了解它们的区别以便共享相同的词典。（[https://www.blog.pythonlibrary.org/2017/02/28/python-101-equality-vs-identity/](https://www.blog.pythonlibrary.org/2017/02/28/python-101-equality-vs-identity/)）

您将通过关键字测试身份`is`：

```
a is b 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-10-10T12:07:42.460

当我使用上述答案时：

```
 ((a == b) | (numpy.isnan(a) & numpy.isnan(b))).all() 
```

在评估字符串列表时，它给了我一些错误。

这是更通用的类型：

```
def EQUAL(a,b):
    return ((a == b) | ((a != a) & (b != b))) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-03-24T22:58:20.090

从[v1.9 开始](https://numpy.org/doc/stable/release/1.19.0-notes.html#equal-nan-parameter-for-numpy-array-equal)，numpy 的`array_equal`函数支持一个`equal_nan`参数：

```
assert np.array_equal(a, b, equal_nan=True) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-05-02T22:47:08.570

对我来说，这很好用：

```
a = numpy.array(float('nan'), 1, 2)
b = numpy.array(2, float('nan'), 2)
numpy.equal(a, b, where = 
    numpy.logical_not(numpy.logical_or(
        numpy.isnan(a), 
        numpy.isnan(b)
    ))
).all() 
```

PS。有 nan 时忽略比较

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-01-16T23:08:38.707

*如果您为单元测试*之类的事情执行此操作，那么您不太关心所有类型的性能和“正确”行为，您可以使用它**来获得适用于所有类型数组的东西，而不仅仅是数字**：

```
a = np.array(['a', 'b', None])
b = np.array(['a', 'b', None])
assert list(a) == list(b) 
```

**将`ndarray`s 强制转换为`list`s**有时对于在某些测试中获得您想要的行为很有用。（但不要在生产代码或更大的数组中使用它！）

# r - 返回嵌入在另一个函数中的函数的值

> ID：10710331
> 
> 赞同：1
> 
> 时间：2012-05-22T21:18:53.210
> 
> 标签：r

我想问我们如何获得嵌入在另一个函数中的函数的值，如下例所示：

```
message <- function() {
    inside.message <- function() {
        return("inside.message")
    }   
}

run.f <- function() {
    return.inside.mesage <- message()
    print(return.inside.mesage)
}           

run.f() # We do not get "inside.message" 
```

提前谢谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:35:41.863

在您的代码中 message() 返回一个函数。要调用它，您需要添加一对额外的括号：

```
> message()()
[1] "inside.message" 
```

如果您在代码中将 message() 替换为 message()() ，它将执行您想要的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:33:11.583

正如您编写的那样，`message`返回该函数`inside.message`，因为您没有显式返回任何内容，它是在`message`.

您似乎希望它从*评估* `inside.message`返回值，这需要另一行代码`message`：

```
message <- function() {
    inside.message <- function() {
        return("inside.message")
    }
    inside.message()
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T21:33:44.593

正如您编写的那样，该函数`message`返回一个函数，如果评估将返回“inside.message”。所以有几种方法可以让 R 打印“inside.message”。

第一种方式：

在`message`函数中，添加一行`return(inside.message())`以便`inside.message`计算函数并返回结果，而不是返回函数本身：

```
message <- function() {
  inside.message <- function() {
    return("inside.message")
  }
  return(inside.message())
}

message()
# "inside.message" 
```

然后评估`run.f()`也会打印“inside.message”。

第二种方式：

保持`message`原样并更改`run.f()`为以下内容

```
run.f <- function() {
  return.inside.mesage <- message()
  print(return.inside.mesage())
} 
```

上面，您将返回的函数分配给`message()`对象`return.inside.message`，然后评估该函数。

# jquery - FancyBox2 兼容 IE7？内联内容

> ID：10710332
> 
> 赞同：1
> 
> 时间：2012-05-22T21:18:58.627
> 
> 标签：jquery, internet-explorer-7, fancybox, inline, fancybox-2

FancyBox 在我正在处理的网站上无法在 IE7 中打开。这是我犯的编码错误还是在 IE7 中不起作用？

当前版本的网站：

[http://arbiter-design.com/wycliffe/transformation](http://arbiter-design.com/wycliffe/transformation)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:22:06.330

在您的花式框的设置中，您留下了尾随逗号，IE 对此非常挑剔。删除它们，它将起作用。

```
$(document).ready(function() {
    $('area.fancy').fancybox({
        maxWidth    : 508,
        fitToView   : false,
        closeClick  : false,
        wrapCSS     : 'fancybox-custom', // < remove comma here
    });

    $('a.fancy').fancybox({
        maxWidth    : 508,
        fitToView   : false,
        closeClick  : false,
        wrapCSS     : 'fancybox-custom', // < remove comma here
    });
}); 
```

此外，由于设置相同，您可以通过组合选择器将这两个块压缩为一个，试试这个：

```
$(document).ready(function() {
    $('area.fancy, a.fancy').fancybox({
        maxWidth    : 508,
        fitToView   : false,
        closeClick  : false,
        wrapCSS     : 'fancybox-custom'
    });
}); 
```

# php - 本例中的 PHP OOP 方法

> ID：10710333
> 
> 赞同：-1
> 
> 时间：2012-05-22T21:19:00.140
> 
> 标签：php, oop

我使用 php 大约 4 年了，但我仍然没有在我自己的任何脚本上真正使用 OOP 方法。不过，我真的很想使用它，因为就我所听到的和我所理解的而言，它使开发变得更加容易。例如下面的代码，它是一个简单的 mysql-select，获取类别，从结果中我正在构建一个表单元素，一个下拉菜单，其中涉及一些步骤，比如 fe 也使用 natcasesort() 对内容进行排序。Atm 我会为国家重做相同的程序，我会再次编写相同的代码，只是将类别替换为国家，如您所见：

```
$result1 = mysql_query("SELECT * from categories WHERE hidden = 0");

while ($row = mysql_fetch_array($result1)) { 
    $cat_names = explode(",",$row['title_mulilingual']);
    $categories[$row['uid']] = $cat_names[$lang_id];
}

natcasesort($categories);
foreach ($categories as $key => $value) {
    if ($key == $active_key) $selected = ' selected="selected"';
    else $item_selected = '';
    $select_fields['cat_id'] .= '<option'.$selected.' value="'.$key.'">'.$value.'</option>';
}   

$cat_select = '<select name="category" >'.$select_fields['cat_id'].'</select>';

// the following part is the same as the first one, it only handles countries instead of categories

$result2 = mysql_query("SELECT * from countries WHERE hidden = 0");

while ($row = mysql_fetch_array($result2)) { 
    $country_names = explode(",",$row['title_mulilingual']);
    $countries[$row['uid']] = $country_names[$lang_id];
}

natcasesort($countries);
foreach ($countries as $key => $value) {
    if ($key == $active_key) $item_selected = ' selected="selected"';
    else $selected = '';
    $select_fields['country_id'] .= '<option'.$selected.' value="'.$key.'">'.$value.'</option>';
}   

$country_select = '<select name="country" >'.$select_fields['country_id'].'</select>'; 
```

所以在代码中它显然不是 OOP。但我猜，我可以通过使用 OOP 更轻松地做到这一点，对吧？有人可以通过使这个示例成为 OOP 示例来帮助我更好地理解 OOP 吗？在此先感谢，杰登

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:42:57.040

> 有人可以通过使这个示例成为 OOP 示例来帮助我更好地理解 OOP 吗？

嘿，您可以使用 MVC 之类的框架轻松地将其移植到 OOP 中。

[![MVC结构](../Images/56640b9426458c9dcce664bb6ccd540d.png)](https://i.stack.imgur.com/NzPNa.png)
[（来源：[php-html.net](http://php-html.net/tutorials/wp-content/uploads/2009/08/mvc-collaboration.png)）]

> “模型-视图-控制器 (MVC) 是一种用于计算机用户界面的设计模式，它将应用程序划分为三个责任区域：
> 
> > *   模型：表示应用程序状态的域对象或数据结构。
> > *   视图，它观察状态并向用户生成输出。
> > *   控制器，它将用户输入转换为模型上的操作。”（维基百科，2012）

一些非常好的 OOP 框架已经可用。

*   [ash.MVC](https://web.archive.org/web/20151008015829/http://www.phpframeworks.com:80/php-frameworks/index.php?id=14)
*   [蛋糕 PHP](https://web.archive.org/web/20150910123915/http://phpframeworks.com:80/php-frameworks/index.php?id=2)
*   [Symfony](https://web.archive.org/web/20151006095719/http://www.phpframeworks.com:80/php-frameworks/index.php?id=3)

可以在[此处](https://php-html.net/tutorials/model-view-controller-in-php/)找到有关如何创建模型视图控件的好教程。

**控制器**

这会检索数据，然后将其发送到要处理的模型。

```
 include_once("model/Model.php");

 class Controller {
 public $model; 

 public function __construct()
 {
      $this->model = new Model();
 } 

 public function invoke()
 {
      if (!isset($_GET['book']))
      {
           // no special book is requested, we'll show a list of all available books
           $books = $this->model->getBookList();
           include 'view/booklist.php';
      }
      else
      {
           // show the requested book
           $book = $this->model->getBook($_GET['book']);
           include 'view/viewbook.php';
      }
 }
 } 
```

**模型**

它处理要呈现的数据

```
include_once("model/Book.php");

class Model {
public function getBookList()
{
    // here goes some hardcoded values to simulate the database
    return array(
        "Jungle Book" => new Book("Jungle Book", "R. Kipling", "A classic book."),
        "Moonwalker" => new Book("Moonwalker", "J. Walker", ""),
        "PHP for Dummies" => new Book("PHP for Dummies", "Some Smart Guy", "")
    );
}

public function getBook($title)
{
    // we use the previous function to get all the books and then we return the requested one.
    // in a real life scenario this will be done through a db select command
    $allBooks = $this->getBookList();
    return $allBooks[$title];
}

}

class Book {
public $title;
public $author;
public $description;

public function __construct($title, $author, $description)
{
    $this->title = $title;
    $this->author = $author;
    $this->description = $description;
}
} 
```

**看法**

呈现数据。

```
<?php 

    echo 'Title:' . $book->title . '<br/>';
    echo 'Author:' . $book->author . '<br/>';
    echo 'Description:' . $book->description . '<br/>';

?> 
```

根据我的经验，我发现使用框架进行 OOP 比在 Web 应用程序中从头开始学习它更容易。

还有一个关于在 nettuts 上创建自己的框架的很好的教程，可以在[这里](https://code.tutsplus.com/tutorials/create-a-php5-framework-part-1--net-520)找到，如果您不理解上述信息，本教程不会让人不知所措。

# wordpress - WordPress 将过滤器添加到 wp_get_attachment_link

> ID：10710339
> 
> 赞同：0
> 
> 时间：2012-05-22T21:19:15.693
> 
> 标签：wordpress, wordpress-theming

我需要自定义类来过滤 wp_get_attachment_link。所以我是这样的：

```
function modify_attachment_link( $markup ) {
global $post;
return str_replace( '<a href', '<a class="view" rel="galleryid-'. $post->ID .'" href', $markup );
}
add_filter( 'wp_get_attachment_link', 'modify_attachment_link' ); 
```

它工作正常。但是，如果将缩略图链接到：附件页面，我需要做的是我的意思是在这种情况下我不需要自定义类。请问有什么帮助吗？

wp_get_attachment_link 的核心功能是：

```
function wp_get_attachment_link( $id = 0, $size = 'thumbnail', $permalink = false, $icon = false, $text = false ) {
$id = intval( $id );
$_post = & get_post( $id );

if ( empty( $_post ) || ( 'attachment' != $_post->post_type ) || ! $url = wp_get_attachment_url( $_post->ID ) )
    return __( 'Missing Attachment' );

if ( $permalink )
    $url = get_attachment_link( $_post->ID );

$post_title = esc_attr( $_post->post_title );

if ( $text )
    $link_text = esc_attr( $text );
elseif ( $size && 'none' != $size )
    $link_text = wp_get_attachment_image( $id, $size, $icon );
else
    $link_text = '';

if ( trim( $link_text ) == '' )
    $link_text = $_post->post_title;

return apply_filters( 'wp_get_attachment_link', "<a href='$url' title='$post_title'>$link_text</a>", $id, $size, $permalink, $icon, $text );
} 
```

所以我的意思是如果（ $permalink ）我不需要为这个函数添加自定义类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T20:48:04.733

尝试

```
function modify_attachment_link( $markup, $id, $size, $permalink ) {
    global $post;
    if ( ! $permalink ) {
        $markup = str_replace( '<a href', '<a class="view" rel="galleryid-'. $post->ID .'" href', $markup );
    }
    return $markup;
}
add_filter( 'wp_get_attachment_link', 'modify_attachment_link', 10, 4 ); 
```

这可能有效

# java - java中的eclipse插件开发：如何从另一个正在运行的配置中运行一个运行配置？

> ID：10710342
> 
> 赞同：0
> 
> 时间：2012-05-22T21:19:34.257
> 
> 标签：java, eclipse-plugin, osgi, bundle, run-configuration

我为 Eclipse 创建了两个视图。每个视图都使用不同的运行配置启动（意味着每个视图都有不同的配置）。

我想做的事：

在第一个视图中，我有一个元素列表。当我双击一个元素时，我想启动另一个视图（可能从其运行配置），然后才启动所有捆绑包。

任何线索如何做到这一点？

此外，我想在启动时将一些参数从第一个视图发送到第二个视图。

我希望任何人都可以提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T02:14:27.830

Eclipse 运行配置是复杂设置的列表，包括主类、VM 参数、JRE 路径和类路径。用您的话说，Eclipse 视图是包含各种窗口窗格的透视图；我想这就是你的意思。运行配置和透视/视图的 2 个概念是 Eclipse 的单独实现，并且不相关。所以......你所要求的对于 Eclipse 来说似乎是不可能的，并且不适合它的设计。

我建议您将源文件夹包含在 Package Explorer 工作区中，该工作区基本上只是一个文件系统。之后，当您想更改视图时，使用您的话打开/关闭项目文件夹。我自己在纯 Java 和 Swing 之间的 2 个完全不同的项目之间切换，它们都包含自己的 Main 函数，用于在 StackOverflow 中测试代码。我认为这与您的目标相似。

我不确定 Eclipse 中的“元素列表”是什么意思。而且我可能不明白你的确切问题。

# joomla - 如何更改我想要在 joomla 中发表文章的位置？

> ID：10710344
> 
> 赞同：0
> 
> 时间：2012-05-22T21:19:44.927
> 
> 标签：joomla, joomla-article

我目前正在Joomla中开发一个网站，我想知道如何更改文章的位置，就像默认情况下所有文章都会在中心位置一样，我想让文章转到正确的位置，在我的搜索菜单下，所以我在那里建立链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T21:44:14.640

通过使用模块模块作为文章 joomla 模块，我找到了解决问题的方法：http: [//extensions.joomla.org/extensions/news-display/articles-display/content-embed/7528](http://extensions.joomla.org/extensions/news-display/articles-display/content-embed/7528)

# javascript - 查找字符串中指定字符的所有索引

> ID：10710345
> 
> 赞同：76
> 
> 时间：2012-05-22T21:19:49.903
> 
> 标签：javascript, string, indexing

例如，如果我有`"scissors"`一个变量并且想知道所有字母出现的位置`"s"`，它应该打印出来`1, 4, 5, 8`。

如何以最有效的方式在 JavaScript 中执行此操作？我不认为循环遍历整个过程非常有效

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-05-22T21:24:05.673

一个简单的循环效果很好：

```
var str = "scissors";
var indices = [];
for(var i=0; i<str.length;i++) {
    if (str[i] === "s") indices.push(i);
} 
```

现在，您表示需要 1、4、5、8。这将为您提供 0、3、4、7，因为索引是从零开始的。所以你可以添加一个：

```
if (str[i] === "s") indices.push(i+1); 
```

现在它会给你你预期的结果。

小提琴可以在[这里](http://jsfiddle.net/Mzg6c/)看到。

> 我不认为循环遍历整个过程非常有效

就性能而言，我认为在您开始遇到问题之前，您无需担心这一点。

这是一个比较各种答案的[jsPerf测试。](http://jsperf.com/10710345)在 Safari 5.1 中，IndexOf 表现最好。在 Chrome 19 中，for 循环是最快的。

![在此处输入图像描述](../Images/0a754df53d6bbed3e999c38afa475227.png)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-05-22T21:24:20.470

使用本机[`String.prototype.indexOf`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/indexOf)方法最有效地找到每个偏移量。

```
function locations(substring,string){
  var a=[],i=-1;
  while((i=string.indexOf(substring,i+1)) >= 0) a.push(i);
  return a;
}

console.log(locations("s","scissors"));
//-> [0, 3, 4, 7] 
```

然而，这是一个微优化。对于一个足够快的简单而简洁的循环：

```
// Produces the indices in reverse order; throw on a .reverse() if you want
for (var a=[],i=str.length;i--;) if (str[i]=="s") a.push(i); 
```

**事实上，原生循环在 chrome 上比使用`indexOf`!**

[![来自链接的性能结果图](../Images/b17f5874effa444b06f154fd2fa89a7e.png)](http://jsperf.com/indices-of-letter-in-string)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-08-01T16:30:51.707

[![基准](../Images/9e25be66cc5921e5b340a69ccad38a18.png)](http://jsperf.com/javascript-string-character-finder/7)

当我对所有东西进行基准测试时，似乎正则表达式表现最好，所以我想出了这个

```
function indexesOf(string, regex) {
    var match,
        indexes = {};

    regex = new RegExp(regex);

    while (match = regex.exec(string)) {
        if (!indexes[match[0]]) indexes[match[0]] = [];
        indexes[match[0]].push(match.index);
    }

    return indexes;
} 
```

你可以这样做

```
indexesOf('ssssss', /s/g); 
```

这将返回

```
{s: [0,1,2,3,4,5]} 
```

我需要一种非常快速的方法来匹配多个字符与大量文本，例如你可以这样做

```
indexesOf('dddddssssss', /s|d/g); 
```

你会得到这个

```
{d:[0,1,2,3,4], s:[5,6,7,8,9,10]} 
```

这样您就可以一次性获取所有匹配项的索引

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-05-22T21:26:43.323

```
function charPos(str, char) {
  return str
         .split("")
         .map(function (c, i) { if (c == char) return i; })
         .filter(function (v) { return v >= 0; });
}

charPos("scissors", "s");  // [0, 3, 4, 7] 
```

请注意，JavaScript 从 0 开始计数`i`。如果必须，请将 +1 添加到 。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-10-27T09:59:13.577

功能更有趣，也更通用：这会找到字符串中*任意*长度的子字符串的起始索引

```
const length = (x) => x.length
const sum = (a, b) => a+b

const indexesOf = (substr) => ({
  in: (str) => (
    str
    .split(substr)
    .slice(0, -1)
    .map(length)
    .map((_, i, lengths) => (
      lengths
      .slice(0, i+1)
      .reduce(sum, i*substr.length)
    ))
  )  
});

console.log(indexesOf('s').in('scissors')); // [0,3,4,7]

console.log(indexesOf('and').in('a and b and c')); // [2,8]
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-12-12T09:32:51.293

在现代浏览器[中 matchAll](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/matchAll)完成这项工作：

```
const string = "scissors";
const matches = [...string.matchAll(/s/g)]; 
```

您可以通过多种方式获取值。例如 ：

```
const indexes = matches.map(match => match.index); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-11-08T00:21:20.040

```
indices = (c, s) => s
          .split('')
          .reduce((a, e, i) => e === c ? a.concat(i) : a, []);

indices('?', 'a?g??'); // [1, 3, 4] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-08-07T17:26:08.387

**使用 while 循环**

```
let indices = [];
let array = "scissors".split('');
let element = 's';

let idx = array.indexOf(element);

while (idx !== -1) {
   indices.push(idx+1);
   idx = array.indexOf(element, idx + 1);
}
console.log(indices);
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-03-20T07:43:41.867

另一种选择可能是使用[`flatMap`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flatMap).

```
var getIndices = (s, t) => {
  return [...s].flatMap((char, i) => (char === t ? i + 1 : []));
};

console.log(getIndices('scissors', 's'));
console.log(getIndices('kaios', '0'));
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-04-28T01:50:01.233

这是使用函数表达式（使用 ES6 箭头函数）的简短解决方案。该函数接受一个字符串和要查找的字符作为参数。它将字符串拆分为一个字符数组，并使用一个`reduce`函数来累积并将匹配的索引作为数组返回。

```
const findIndices = (str, char) =>
  str.split('').reduce((indices, letter, index) => {
    letter === char && indices.push(index);
    return indices;
  }, []) 
```

测试：

```
findIndices("Hello There!", "e");
// → [1, 8, 10]

findIndices("Looking for new letters!", "o");
// → [1, 2, 9] 
```

这是一个紧凑的（单行）版本：

```
const findIndices = (str, char) => str.split('').reduce( (indices, letter, index) => { letter === char && indices.push(index); return indices }, [] ); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-01-15T14:48:46.207

我喜欢这个问题，并想用`reduce()`数组上定义的方法来写我的答案。

```
function getIndices(text, delimiter='.') {
    let indices = [];
    let combined;

    text.split(delimiter)
        .slice(0, -1)
        .reduce((a, b) => { 
            if(a == '') {
                combined = a + b;
            } else { 
                combined = a + delimiter + b;
            } 

            indices.push(combined.length);
            return combined; // Uncommenting this will lead to syntactical errors
        }, '');

    return indices;
}

let indices = getIndices(`Ab+Cd+Pk+Djb+Nice+One`, '+');
let indices2 = getIndices(`Program.can.be.done.in.2.ways`); // Here default delimiter will be taken as `.`

console.log(indices);  // [ 2, 5, 8, 12, 17 ]
console.log(indices2); // [ 7, 11, 14, 19, 22, 24 ]

// To get output as expected (comma separated)
console.log(`${indices}`);  // 2,5,8,12,17
console.log(`${indices2}`); // 7,11,14,19,22,24 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-04-12T18:27:01.080

只是为了进一步的解决方案，这是我的解决方案：您可以找到字符串中存在的字符索引：

```
findIndex(str, char) {
    const strLength = str.length;
    const indexes = [];
    let newStr = str;

    while (newStr && newStr.indexOf(char) > -1) {
      indexes.push(newStr.indexOf(char) + strLength- newStr.length);
      newStr = newStr.substring(newStr.indexOf(char) + 1);
    }

    return indexes;
  }

findIndex('scissors', 's'); // [0, 3, 4, 7]
findIndex('Find "s" in this sentence', 's'); // [6, 15, 17] 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2018-04-21T05:16:42.940

您也可以使用 javascript 的 match() 函数。您可以创建一个正则表达式，然后将其作为参数传递给 match()。

```
stringName.match(/s/g); 
```

这应该会返回一个包含所有出现的字母“s”的数组。

# php - 对于列中的每个站点，mySQL 仅回显一次行

> ID：10710352
> 
> 赞同：2
> 
> 时间：2012-05-22T21:20:25.427
> 
> 标签：php, mysql

这是我下面的代码：

```
$getSites = mysql_query("SELECT * FROM logs") or die(mysql_error());
while($row = mysql_fetch_assoc($getSites)) { 
if (!$row['site']==NULL){
echo $row["site"]."<a href='./php.php?site=".$row["site"]."'> (View logs)</a><br>";
}
} 
```

输出：

test.com（查看日志）

但我只希望它为每个站点名称回显一次。所以基本上我不想有重复。

对不起，我真的不知道如何正确地问这个问题，但我试过了:(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T21:21:47.093

改用：

```
SELECT DISTINCT site FROM logs 
```

# svn - 从另一台服务器拉 SVN 变更列表？

> ID：10710353
> 
> 赞同：0
> 
> 时间：2012-05-22T21:20:33.070
> 
> 标签：svn, changelist

只是对此感到好奇，我有一个服务器我们的开发人员已经进行了大量的更改，然后是另一个我需要推送这些更改的服务器，当然还有一个中间的存储库。

我已经设法从我们的 Dev 中提取出我想要的文件并将它们放入更改列表中，我只想在我们的其他服务器上提取这些文件，但是由于更改列表没有迁移，它有点像皮塔饼.

我想知道是否有解决方案，目前我正在考虑做类似的事情

```
$ svn merge --dry-run -r BASE:HEAD . > update.log
# edit out what I don't want by hand =(
$ svn up `cat update.log`
# cross fingers 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:50:24.370

我不太明白这个问题。

如果您只需要获取由一系列提交引入的更改，只需`svn diff -rN:M`在服务器上执行，将生成的补丁获取到本地机器，然后运行`svn patch`（或者只是`patch`——很难理解您真正想要做什么）来应用变化。

相反，如果您拥有同一个颠覆存储库的（过时的）本地副本并考虑如何使其与远程存储库同步，那么[`svnrdump`](http://svnbook.red-bean.com/en/1.7/svn.ref.svnrdump.c.dump.html)应该是要走的路，或者`rsync`如果您能保证远程同步时不会写入 repo。

# google-apps-script - 如何将“编辑回复”链接添加到 Google 表单电子邮件？

> ID：10710354
> 
> 赞同：25
> 
> 时间：2012-05-22T21:20:38.640
> 
> 标签：google-apps-script, google-forms

我有一个简单的 Google 表单，它收集数据，并使用 AppScript 向填写它的用户发送确认电子邮件。用户提交表单后，在确认后，她/他将看到一个链接来编辑他/她的回复。

我想将该链接包含在确认电子邮件中（目前，它只显示在页面上。）如何获取 URL 以编辑提交的回复？

我可以通过`SpreadsheetApp.getActiveSpreadsheet().getFormUrl()`. 它给了我以下格式：`https://docs.google.com/a/domain.com/spreadsheet/viewform?formkey=<formKey>`

但是，该链接不包含用户编辑他/她的响应所需的编辑键。预期的 URL 应如下所示：`https://docs.google.com/a/domain.com/spreadsheet/viewform?formkey=<formKey>&edit=<editKey>`

我在这里先向您的帮助表示感谢！

-K

编辑：

对此添加了功能请求：[http ://code.google.com/p/google-apps-script-issues/issues/detail?id=1345&thanks=1345&ts=1337773007](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1345&thanks=1345&ts=1337773007)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2014-02-16T23:36:47.133

直到最近，@Henrique Abreu 的答案是正确的。谷歌似乎已经添加[`getEditResponseUrl()`](https://developers.google.com/apps-script/reference/forms/form-response#getEditResponseUrl%28%29)到[FormResponse](https://developers.google.com/apps-script/reference/forms/form-response)类中，因此可以使用这样的代码来获取一堆现有表单的编辑 URL：

```
function responseURL() {
 // Open a form by ID and log the responses to each question.
 var form = FormApp.openById('1gJw1MbMKmOYE40Og1ek0cRgtdofguIrAB8KhmB0BYXY'); //this is the ID in the url of your live form
 var formResponses = form.getResponses();
 for (var i = 0; i < formResponses.length; i++) {
   var formResponse = formResponses[i];
   Logger.log(formResponse.getEditResponseUrl());
 }
} 
```

要使其在用户回复时自动向用户发送电子邮件，可以在表单提交时添加触发器。由于我正在使用的情况不需要人们使用应用程序帐户登录，因此我无法自动访问电子邮件地址，因此我有一个文本问题来捕获用户的电子邮件地址。

它确实询问有关编辑表单是否是您想要的问题。我一直在努力解决编辑现有回复或发送预填表单的相对优势，[`toPrefilledUrl()`](https://developers.google.com/apps-script/reference/forms/form-response#toPrefilledUrl%28%29)以便我可以看到事情随着时间的推移发生了怎样的变化。我想这归结为跟踪这将为您提供的价值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-24T23:01:42.273

这是一篇清晰的博客文章，它向您展示了如何一步一步地做到这一点，并解释了 AppsScripts 新手的幕后情况：

[http://securitasdato.blogspot.com/2014/11/sending-confirmation-emails-from-google.html](http://securitasdato.blogspot.com/2014/11/sending-confirmation-emails-from-google.html)

虽然您可以从此处提供的所有优秀答案中共同获得成功，但该帖子中的脚本对我来说效果最好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T02:14:54.460

**--edit 这现在是可能的。查看其他答案。**

> 用户提交表单后，在确认后，她/他将看到一个链接来编辑他/她的回复。我想将该链接包含在确认电子邮件中

这是不可能的，期间。

该链接在任何地方都无法访问，也无法猜测/构建它。但是，有一些可能适合您的解决方法（一些建议在这里我会重新措辞），例如

发送每个填充的表单链接并让用户重新发送它。你需要有某种控制字段（例如用户名），这样你就可以知道和删除/忽略他的旧提交。可能通过脚本自动执行。

您还可以开发和发布应用程序脚本 GUI 并发送指向此应用程序脚本的链接以及您生成的参数，您可以在其中确定应该编辑哪个条目。这种方法的缺点是在 Apps Script 上重新设计整个表单有点麻烦和过度。但同样，它有效。

[最后，您可以在 Apps 脚本问题跟踪器](http://code.google.com/p/google-apps-script-issues/issues/list)上打开一个“增强请求”，然后等到他们和 Google 电子表格/表单团队一起开发解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-23T01:36:53.370

如果您使用的是 Google Apps，您的回复者可以在那里编辑表单回复。

请参阅：[如何编辑表单回复](http://support.google.com/docs/bin/answer.py?hl=en&answer=183417&p=edit_responses)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-19T17:52:11.203

这有帮助吗 - 我没有尝试过，但我前一段时间一直在寻找同样的东西并注意到了这一点。

从这个页面 [https://developers.google.com/apps-script/reference/forms/](https://developers.google.com/apps-script/reference/forms/)

那里的代码包含以下内容：

```
Logger.log('Published URL: ' + form.getPublishedUrl());
Logger.log('Editor URL: ' + form.getEditUrl()); 
```

乔恩

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-03T03:05:28.030

试试这个：（学分不适合我，因为我合并了第三部分的两个解决方案）

来源：[使用 Google 表单发送确认电子邮件](http://www.labnol.org/internet/auto-confirmation-emails/28386/)

```
/* Send Confirmation Email with Google Forms */

function Initialize() {

    var triggers = ScriptApp.getScriptTriggers();

    for (var i in triggers) {
        ScriptApp.deleteTrigger(triggers[i]);
    }

    ScriptApp.newTrigger("SendConfirmationMail")
        .forSpreadsheet(SpreadsheetApp.getActiveSpreadsheet())
        .onFormSubmit()
        .create();

}

function SendConfirmationMail(e) {
  var form = FormApp.openById('***YOUR FORM CODE***');
    //enter form ID here

  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('***SHEET NAME***');

    //Change the sheet name as appropriate
  var data = sheet.getDataRange().getValues();
  var urlCol = ***************COLUMN SEQUENCE EX 14******; // column number where URL's should be populated; A = 1, B = 2 etc
  var responses = form.getResponses();
  var timestamps = [], urls = [], resultUrls = [], url;

  for (var i = 0; i < responses.length; i++) {
    timestamps.push(responses[i].getTimestamp().setMilliseconds(0));
    urls.push(responses[i].getEditResponseUrl());
  }
  for (var j = 1; j < data.length; j++) {

    resultUrls.push([data[j][0]?urls[timestamps.indexOf(data[j][0].setMilliseconds(0))]:'']);
    url = resultUrls[i-1]
  }
  sheet.getRange(2, urlCol, resultUrls.length).setValues(resultUrls);  

    try {

        var ss, cc, sendername, subject, headers;
        var message, value, textbody, sender;

        // This is your email address and you will be in the CC
        cc = Session.getActiveUser().getEmail();

        // This will show up as the sender's name
        sendername = "****YOUR NAME******";

        // Optional but change the following variable
        // to have a custom subject for Google Docs emails
        subject = "Registro de Oportunidade submetido com sucesso";

        // This is the body of the auto-reply
        message = "Nós recebemos seu registro de oportunidade.<br>Muito Obrigado!<br><br>";

        ss = SpreadsheetApp.getActiveSheet();
        headers = ss.getRange(1, 1, 1, ss.getLastColumn()).getValues()[0];

        // This is the submitter's email address
        sender = e.namedValues["********COLUMN NAME OF DESTINATION E-MAIL************"].toString();

        for (var i in headers) {

            value = e.namedValues[headers[i]].toString();

            // Do not send the timestamp and blank fields            
            if ((i !== "0") && (value !== "")) {
                message += headers[i] + ' :: ' + value + "<br>";
            }
        }

        message += "<br>Link to edit" + ' :: ' + url + "<br>";
        textbody = message.replace("<br>", "\n");

        GmailApp.sendEmail(sender, subject, textbody, 
                            {cc: cc, name: sendername, htmlBody: message});

    } catch (e) {
        Logger.log(e.toString());
    }

} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-03-16T08:03:55.783

太好了，脚本有效！谢谢。

对于像我这样的新手：只需将 andre 的函数代码粘贴`SendConfirmationMail(e)`到电子表格的代码编辑器中，然后设置“提交表单”触发器即可运行它。那是在电子表格脚本编辑器中，而不是表单脚本编辑器中。

你需要破解一些价值观。阅读代码。对我来说，令人困惑的是需要将 替换为`********COLUMN SEQUENCE EX 14******`您希望编辑 url 结束的工作表列号。我使用了 39，这比我的表格用完的多一列。

但是，我在这部分遇到了运行时问题：

```
for (var i in headers) {

            value = e.namedValues[headers[i]].toString();

            // Do not send the timestamp and blank fields            
            if ((i !== "0") && (value !== "")) {
                message += headers[i] + ' :: ' + value + "<br>";
            }
        } 
```

不知道为什么，但我用这个代替了它：

```
 for (var keys in columns) {
        var key = columns[keys];
        if ( e.namedValues[key]) {
        message += key + ' :: '+ e.namedValues[key] + "<br>"; 
        } 
    } 
```

为我工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-23T01:15:49.287

您可以尝试使用从该电子邮件地址提供的值填充表单，而不是删除以前的答案...

这不是一个美丽的方式，但它可以工作......

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-05-23T01:07:38.187

我认为我们无法通过电子表格 API 访问该值（这意味着 Apps Script 也没有）。我能想到的最接近的是[这个 feed](https://developers.google.com/google-apps/spreadsheets/#retrieving_a_list-based_feed "基于列表的提要")中的“关键”值。你必须测试才能发现。除了直接访问电子表格 API 之外，我没有其他选择。因此，首先，您必须通过 api 使用获取最后一行`?reverse=true&max-results=1`

# ruby-on-rails - Rails 应用程序中的 Twitter 引导主题

> ID：10710357
> 
> 赞同：-1
> 
> 时间：2012-05-22T21:21:00.557
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap, railscasts

[我使用rails的“bootstrap-sass”](https://github.com/thomas-mcdonald/bootstrap-sass)版本设置了一个rails应用程序。

跟随 railcast (http://railscasts.com/episodes/328-twitter-bootstrap-basics) 我试图运行：

```
rails g bootstrap:themed products -f 
```

但是找不到生成器错误..我想知道这些类型的生成器和引导程序“主题”是否仅与 gem 的主版本兼容`(gem 'twitter-bootstrap-rails')`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T22:25:06.750

不，它们不能使用。这是完全不同的宝石。打开它，bootstrap-sass gem 中似乎没有任何生成器。

# c# - WCF 将 int[] 从客户端发送到服务器

> ID：10710361
> 
> 赞同：2
> 
> 时间：2012-05-22T21:21:19.000
> 
> 标签：c#, .net, wcf, visual-studio-2010

我遇到这个问题：

我有一个 WCF 服务，它公开了这个操作合同：

```
[OperationContract]
void Index(int[] song, string fileName); 
```

在我的客户上，我有：

```
AudioDetectionServiceReference.AudioDetectionServiceClient client = new AudioDetectionServiceReference.AudioDetectionServiceClient();
client.Index(max.ToArray(), mp3Files[i]); 
```

其中 max 是一个包含 2000 个 int 值的数组，而 mp3Files[i] 是一个包含 200 个字符的字符串。

Web.config 有这个：

```
<configuration>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <system.webServer>
  <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

</configuration> 
```

app.config 有：

```
 <configuration>
        <system.serviceModel>

            <bindings>
                <basicHttpBinding>
                    <binding name="BasicHttpBinding_IAudioDetectionService" closeTimeout="00:01:00"
                        openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                        allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                        maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
                        messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
                        useDefaultWebProxy="true">
                        <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                        <security mode="None">
                            <transport clientCredentialType="None" proxyCredentialType="None"
                                realm="" />
                            <message clientCredentialType="UserName" algorithmSuite="Default" />
                        </security>
                    </binding>
                </basicHttpBinding>
            </bindings>
            <client>
                <endpoint address="http://localhost:15863/AudioDetectionService.svc"
                    binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IAudioDetectionService"
                    contract="AudioDetectionServiceReference.IAudioDetectionService"
                    name="BasicHttpBinding_IAudioDetectionService" />
            </client>
        </system.serviceModel>
    <startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/></startup></configuration> 
```

现在是棘手的部分：

当您右键单击服务引用时，转到配置服务引用，有一个称为集合类型的选项。如果我将集合类型设置为“Syste.Array”，我会收到错误消息

```
The remote server returned an unexpected response: (400) Bad Request. 
```

使用堆栈跟踪：

```
 Server stack trace: 
       at System.ServiceModel.Channels.HttpChannelUtilities.ValidateRequestReplyResponse(HttpWebRequest request, HttpWebResponse response, HttpChannelFactory factory, WebException responseException, ChannelBinding channelBinding)
       at System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)
       at System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
       at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)

    Exception rethrown at [0]: 
       at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
       at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
       at SqlTest.AudioDetectionServiceReference.IAudioDetectionService.Index(Int32[] song, String fileName)
       at SqlTest.AudioDetectionServiceReference.AudioDetectionServiceClient.Index(Int32[] song, String fileName) in blablabla\Service References\AudioDetectionServiceReference\Reference.cs:line 53
       at SqlTest.Program.Main(String[] args) in blablabla\Program.cs:line 46 
```

当我将其更改为“System.Collection.Generic.List”时，错误神奇地消失了。

我的问题是：**为什么？**

第二个问题：

**为什么**这行得通？

```
client.Index(max.Take(100).ToArray(), mp3Files[i]); 
```

使用相同的上下文（app.config、web.config 和与上面相同的代码，选择 System.Array）。

谢谢，安德烈·内古

PS：我发布这篇文章是因为我花了 2 天时间尝试更改绑定设置、更改消息大小、更改 readerQuotas 和其他内容的值，而我必须做这个愚蠢的选择。所以我很生气，我至少想从中学到一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:23:35.210

经过更多的挖掘，这就是我改变的：

应用程序配置

```
<bindings>
    <basicHttpBinding>
        <binding name="BasicHttpBinding_IAudioDetectionService" closeTimeout="00:01:00"
            openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
            allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
            maxBufferSize="655360" maxBufferPoolSize="5242880" maxReceivedMessageSize="655360"
            messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
            useDefaultWebProxy="true">
            <readerQuotas maxDepth="320" maxStringContentLength="81920" maxArrayLength="163840"
                maxBytesPerRead="40960" maxNameTableCharCount="163840" />
            <security mode="None">
                <transport clientCredentialType="None" proxyCredentialType="None"
                    realm="" />
                <message clientCredentialType="UserName" algorithmSuite="Default" />
            </security>
        </binding>
    </basicHttpBinding>
</bindings>
<client>
    <endpoint address="http://localhost:15863/AudioDetectionService.svc"
        binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IAudioDetectionService"
        contract="AudioDetectionServiceReference.IAudioDetectionService"
        name="BasicHttpBinding_IAudioDetectionService" />
</client> 
```

对于服务器，请查看 basicHttpBinding 部分没有名称的事实。我认为如果这部分有名称，WCF 生成的默认服务会忽略它。

```
<bindings>
  <basicHttpBinding>
    <binding closeTimeout="00:01:00"
        openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
        allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
        maxBufferSize="655360" maxBufferPoolSize="5242880" maxReceivedMessageSize="655360"
        messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
        useDefaultWebProxy="true">
      <readerQuotas maxDepth="320" maxStringContentLength="81920" maxArrayLength="163840"
          maxBytesPerRead="40960" maxNameTableCharCount="163840" />
      <security mode="None">
        <transport clientCredentialType="None" proxyCredentialType="None"
            realm="" />
        <message clientCredentialType="UserName" algorithmSuite="Default" />
      </security>
    </binding>
  </basicHttpBinding>
</bindings> 
```

对于其他值，我在末尾添加了一个 0（乘以 10）。我认为增加它们会让你更多地转移事件。但最重要的是，basicHttpBinding 没有名称。如果它有名字，我认为它被忽略了。

我不会将此设置为已回答，因为问题是为什么 System.Array 抛出异常而 System.Generic.List 没有。

# rounded-corners - 使用圆形背景图像而不是边框 半径有什么缺点？

> ID：10710363
> 
> 赞同：1
> 
> 时间：2012-05-22T21:21:28.250
> 
> 标签：rounded-corners, css

不幸的是，我的应用程序必须使用 IE 8 和 9。

我的人想要一个圆角盒子。

选项 1：使用边界半径和“边缘”。我们将四舍五入的人有 9 但不是 8....

选项2：就像我们多年来使用的圆形图像一样，这在两个浏览器中看起来都一样......

这是我的问题 - 除了图像的加载时间之外，使用选项 2 是否有任何缺点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T14:56:44.467

如果放大页面，圆形图像将看起来像素化。如果你愿意，你可以在 IE8 中使用[CSS3Pie](http://css3pie.com)作为圆角边框，但是[html5please](http://html5please.com/#border-radius)建议不要这样做。

# javascript - HTML5 历史 API 实现

> ID：10710365
> 
> 赞同：1
> 
> 时间：2012-05-22T21:21:35.897
> 
> 标签：javascript, html, history

这听起来像是重复的，但我已经搜索了论坛问题，但没有找到我要找的东西。

所以，我已经读了一段时间了，我仍然无法决定接下来的情况该怎么办。我正在构建一个需要流畅用户界面的单页网站（不是我的第一个网站），因此我决定使用 AJAX 加载页面以获得更好、更友好的导航。

我一直在使用：[SmartAjax](http://codecanyon.net/item/smartajax-smart-powerful-and-easy-to-setup-ajax/406189)；有一段时间，这对我来说已经足够了。它工作得很好，我对它没有任何问题，但它在处理大量 JavaScript 作为回调时遇到了问题。在通过整个网站实施它时，还有很多工作要做。

而且因为现在 HTML5 比一年前更加稳定，并且它的大部分功能都可以在大多数浏览器中运行（但有些仍然需要 polyfill），我决定开始使用 HTML5 History API。很多网站都使用它，而且很容易做到，但有些方面我不明白。

因此，这就是我想知道的：

*   现在是否所有浏览器都支持它，最重要的是，触摸设备和手机是否支持它？
*   是否有专门的库或框架？
*   用于小型网站（最多 6 页）但使用大量 JavaScript 是否安全？
*   将它与 jQuery 插件结合使用时会表现吗？
*   hashbang 和 hashes 呢？它们与使用 History API 不一样吗？有什么区别？

我将不胜感激有关上述要点的所有帮助和信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:42:08.817

**浏览器支持**

[算了](http://caniuse.com/#feat=history)。甚至 IE 9 都不支持`history.pushState`. 移动浏览器也不是很安全。但是有一个库（见下文）使这种不兼容性对开发人员完全透明。

**图书馆**

好吧，在纯 HTML 5 环境中，历史 API 非常简单。对于其他人来说，[history.js](https://github.com/balupton/History.js/)库已经引起了相当多的关注，而且它提供了对旧哈希写入的自动回退

**在小型网站上**

那么，你最好把你的 JavaScript 和你的潜在状态组织起来。但如果是这样，我认为没有问题。

**历史 & jQuery & 插件**

我现在已经在几个项目中同时使用了这两者。我还没有发现使用 jQuery 和 jQuery 插件的任何问题，除了 - 当然 - 与注入 HTML 相关的典型问题（即必须重新启动事件处理程序；`$(document).ready()`在某些环境中可能会或可能不会工作等）。

**哈希与 history.pushState**

Hash-Notation 已被用作一种解决方法（或如今，后备）。使用 history.pushState 时变得没有必要。

我发现主要区别在于，地址栏中的 URL 始终可以被服务器直接理解，特别是对于书签或链接共享目的。如果您有[http://example.org/#/my/fancy/site](http://example.org/#/my/fancy/site)，那么您的索引页面必须解析哈希（通过 javascript，因为您无法访问哈希服务器端），然后注入/重定向到`my/fancy/site`.

但是，如果使用 history.pushState，浏览器的地址栏会显示[http://example.org/my/fancy/site](http://example.org/my/fancy/site) - 这是可直接路由的。

（并且，想象一下通过电话向某人拼写一个哈希或哈希爆炸 URL！）

希望能澄清一些或你对历史的疑惑！我强烈推荐 History.js 作为首选库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T22:58:19.233

我更喜欢将 HTML5 History 用于支持它的浏览器（所有当前浏览器和即将推出的 IE10），而对旧版本仅使用静态（非 Ajax）链接。随着浏览器的更新，您的网站会自动变得更好。

由于散列的严重缺点，我不建议使用散列填充（例如，不包括 URL 的散列部分的无意义的引用，因此使统计信息相当无用）。

# sql - 2个表的SQL查询

> ID：10710367
> 
> 赞同：-3
> 
> 时间：2012-05-22T21:21:43.867
> 
> 标签：sql, select

有2个SQL表：

```
Table1
    ID | field1
    1  | a
    2  | b

Table2
        field1 | field2
        a      | 111
        a      | 222
        b      | 333
        b      | 444
        b      | 555 
```

我需要得到以下信息`Table3`：

```
ID | field1 | field2
1  | a      | 111
1  | a      | 222
2  | b      | 333
2  | b      | 444
2  | b      | 555 
```

我厌倦了运行这样的 SQL 查询：

```
SELECT t1.ID, t1.field1, t2.field2 FROM table1 t1, table2 t2 WHERE t1.field1=t2.field1; 
```

但结果我收到了重复的条目，像这样

```
ID | field1 | field2
1  | a      | 111
1  | a      | 111
2  | a      | 222
2  | a      | 222 
```

等等

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:23:03.397

（我假设您的示例数据不代表您的问题，因为它不会导致重复。）

您可以使用`DISTINCT`关键字来消除重复项，如下所示：

```
select distinct t1.ID,
    t1.field1,
    t2.field2
from table1 t1
inner join table2 t2 on t1.field1 = t2.field1; 
```

示例 SQL Fiddle 在此处说明问题：[http ://sqlfiddle.com/#!2/ed198/1](http://sqlfiddle.com/#!2/ed198/1)

此处说明的解决方案：[http ://sqlfiddle.com/#!2/ed198/2](http://sqlfiddle.com/#!2/ed198/2)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T21:24:41.773

您的方法（尽管您的 SQL 丑陋且难以阅读）应该可行。

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!2/76afc/1)

您的问题是您的一个输入表中有重复项。尝试`SELECT * FROM Table1`or `SELECT * FROM Table2`，您可能会看到如下内容：

```
ID | field1
1  | a
2  | b
1  | a
2  | b 
```

我建议：

*   从表中删除重复的行。
*   在您的字段上添加唯一索引`ID`以防止它再次发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:23:33.163

用于`GROUP BY`从结果中删除重复项。

```
SELECT t1.ID, t1.field1, t2.field2
FROM table1 t1, table2 t2
WHERE t1.field1=t2.field1
GROUP BY t1.ID, t1.field1, t2.field2; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T21:23:58.483

尝试使用`DISTINCT`来得到你的结果，我也建议你的表使用 JOIN 语法，而不是表名之间的逗号。

```
SELECT DISTINCT t1.ID, t1.field1, t2.field2 
FROM table1 t1
INNER JOIN table2 t2 
    ON t1.field1=t2.field1; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T21:25:15.517

您将不得不在该查询的前面抛出一个 SELECT DISTINCT。SELECT DISTINCT t1.ID, t1.field1, t2.field2 FROM table1 t1, table2 t2 WHERE t1.field1=t2.field1;

# java - Java程序的退出查询

> ID：10710371
> 
> 赞同：0
> 
> 时间：2012-05-22T21:21:54.177
> 
> 标签：java, exit

当按下 JFrame 上的退出按钮时，我想让我的脚本运行“查询”方法。我尝试了设置默认关闭操作，但这显然不起作用，我该怎么办？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:31:59.727

为什么说 setDefaultCloseOperation 不起作用？也许我误解了这个问题，但是[这个网站上有一个非常相似的问题。](https://stackoverflow.com/questions/3777146/how-can-a-swing-windowlistener-veto-jframe-closing)

看看接受的答案是否是您想要的。

# r - “cacheSweave 不缓存副作用”是什么意思？

> ID：10710373
> 
> 赞同：0
> 
> 时间：2012-05-22T21:22:03.103
> 
> 标签：r, caching, sweave, chunks

我正在使用 cachesweave，但我不认为我明白一切是如何工作的。我试图将代码分成模拟块和绘图块，但是有些代码很长并且是在我开始 sweave 文档之前编写的，所以我改用类似的东西

```
 <<foo,cache=TRUE>>
 source("mainScript.R")
 @
 <<plot,fig=TRUE>>
 a<- print(str(F1))
 plot(F1)
 @ 
```

事情是 mainScript.R 是有点复杂的模拟代码，包括绘图函数等。我在 cacheSweave 小插图中读过“cacheSweave 不缓存副作用”并且没有缓存绘图，所以我想知道 mainScript.R 中的绘图函数是否影响表达式的评估方式？

这可能是一个显而易见的问题。假设我在上述两个之后还有另一个块。“foo”和“plot”中表达式的所有结果都可以在这个新块中使用，对吧？例如，

```
 <<post-chunk>>
 print(a)
 print(str(F1))
 @ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T01:15:24.670

有关完整说明，请参阅[Wikipedia](http://en.wikipedia.org/wiki/Side_effect_%28computer_science%29)。R 中的一些常见副作用包括：`print()`对象、绘图、写入文件和加载包。

该`cacheSweave`软件包仅使您可以跳过计算，并且您必须失去所有副作用。正如 Dason 评论的那样，该[`knitr`](http://yihui.name/knitr/)包在缓存方面更加自然——您在未缓存的块中看到的内容将在缓存的块中看到。副作用的缓存`knitr`在[其手册](https://github.com/downloads/yihui/knitr/knitr-manual.pdf)和网站中的[缓存页面](http://yihui.name/knitr/demo/cache/)中进行了说明。

顺便说一句，`knitr`保持与 Sweave 和 cacheSweave 的兼容性，所以希望您不需要为过渡做任何事情；只是打电话`library(knitr); knit('file.Rnw')`。

# uiview - iOS presentModalViewController 不允许显示以前的视图

> ID：10710375
> 
> 赞同：0
> 
> 时间：2012-05-22T21:22:16.347
> 
> 标签：uiview, uiviewcontroller, presentmodalviewcontroller

我正在使用 presentModalViewController 尝试在其他一些视图之上显示 UIView。我从控制器 1 调用 presentModalViewController。我正在尝试显示来自 controller2 的视图。

从控制器 1 我调用控制器 2，如下所示：

```
- (void) someButtonPressed: (id)sender
{
    MyController* controller2 = [ [ MyController alloc ] initWithNibName:nil bundle:nil ];

    [self presentModalViewController:controller2 animated:YES];
    //[self presentViewController:controller2 animated:NO completion:nil ];
} 
```

然后在controller2中我这样做：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    if (YES){

        UIWindow* keyWindow = [[UIApplication sharedApplication] keyWindow];
        UIView* master = (UIView*)[keyWindow viewWithTag:100]; // Master is the entire app, but always oriented so top left corner is 0,0.

        UIView* newView = [ [ UIView alloc ] initWithFrame:CGRectMake(100, 100, 400, 400) ];

        [self setView:newView ];

        self.view.backgroundColor = [ UIColor clearColor ];
    }

} 
```

问题是第一个控制器中的任何内容都没有显示出来。我希望以前的视图保持可见。有没有办法让第二个控制器的视图不可见？我想这样做的原因是因为我希望第二个控制器/视图显示一个透明层，该层将捕获所有触摸事件，而无需它们通过控制器 1 管理的视图。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T07:14:41.877

将视图添加为子视图，这将起作用：

```
- (void) someButtonPressed: (id)sender
{
    MyController* controller2 = [ [ MyController alloc ] initWithNibName:nil bundle:nil ];

    [[self view] addSubview:[controller2 view]];
    // [controller2 release] if you aren't using ARC

    //[self presentModalViewController:controller2 animated:YES];
    //[self presentViewController:controller2 animated:NO completion:nil ];
} 
```

如果您在 controller2 中使用 viewDidAppear，请将此行放在 addSubView 行之后：

```
[controller2 viewDidAppear:NO] 
```

其他 viewDid 方法也是如此；）

# android - Android 布局编辑器标准 3.0

> ID：10710378
> 
> 赞同：0
> 
> 时间：2012-05-22T21:22:32.663
> 
> 标签：android, android-layout

我正在为 android 2.1 开发一个应用程序，我想为具有 Android 3.0 标准的平板电脑创建一个特殊的布局。是否可以在布局编辑器中自动更改样式，以便我可以拖放类似 3.0 的按钮等？否则，有没有其他聪明的方法来改变 Android 3.0 的布局样式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:57:12.970

看看这些帖子：

[在android中为不同版本编程不同的布局](https://stackoverflow.com/questions/8908508/program-different-layouts-for-different-versions-in-android)

[使布局适应 Android 平台或 API 级别](https://stackoverflow.com/questions/6536079/adapt-layout-to-android-platform-or-api-level)

否则，您可能会针对不同的平台版本编译不同的 APK：

[http://developer.android.com/guide/market/publishing/multiple-apks.html](http://developer.android.com/guide/market/publishing/multiple-apks.html)

# linux - 使用 RSYNC 处理错误

> ID：10710382
> 
> 赞同：1
> 
> 时间：2012-05-22T21:22:57.820
> 
> 标签：linux, bash, rsync

检查远程 SSH rsync 是否从主机失败的最简单方法是什么？

我不在乎是否找不到文件，是否无法建立连接，或者 RSYNC 的狗是否死亡并不得不参加其葬礼。我将如何指定：

如果 RSYNC 失败，做些什么？

编辑：RSYNC SSH 不是守护进程。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T21:55:14.363

您可以创建一个 bash 脚本，例如：

```
if ssh <server> rsync; then
    echo "SUCCESS"
else
    echo "FAIL"
fi 
```

# objective-c - 如何用 NSString 初始化 NSDate？

> ID：10710391
> 
> 赞同：0
> 
> 时间：2012-05-22T21:23:28.330
> 
> 标签：objective-c, nsdate

> **可能重复：**
> [将 NSString 转换为 NSDate（然后再返回）](https://stackoverflow.com/questions/3917250/converting-nsstring-to-nsdate-and-back-again)

我仍然是 obj-C/iOS 开发的初学者...我创建了一个包含 a 的类`NSDate *date`，并从 XML 文件中获取数据。所以我想做这样的事情：

```
[myItem setDate:[NSDate dateWithString:xmlDate]]; 
```

我得到错误：

> 选择器“dateWithString:”没有已知的类方法

最好的方法是什么？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T21:26:13.520

你需要一个[NSDateFormatter](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html#//apple_ref/occ/cl/NSDateFormatter)。有关更多详细信息，请参阅[上一个问题](https://stackoverflow.com/questions/2352487/nsdate-from-nsstring)或[上一个问题](https://stackoverflow.com/questions/4332319/convert-nsstring-of-a-date-to-an-nsdate)或[上一个问题](https://stackoverflow.com/questions/8420351/format-nsstring-to-nsdate)或只是[Apple Date Formatter 指南](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html)。

[并且请记住在发布之前搜索重复的问题。]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T21:27:10.517

我建议您为此使用一个`NSDateFormatter`实例：

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
// set the appropriate format in this string
[dateFormatter setDateFormat:@"EEE, d MMM yyyy HH:mm:ss Z"];
NSDate *date = [dateFormatter dateFromString:xmlDate];
[dateFormatter release]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T21:26:07.440

要从 a 制作`NSDate`对象，`NSString`您应该使用`NSDateFormatter`. 更多信息可以在 Apple 的网站上找到：

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html)

希望能帮助到你

# entity-framework - 实体字段的可空属性，通过代码优先的实体框架

> ID：10710393
> 
> 赞同：88
> 
> 时间：2012-05-22T21:23:38.483
> 
> 标签：entity-framework, asp.net-mvc-3, code-first, nullable

像这样使用数据注释`Required`：

```
[Required]
public int somefield {get; set;} 
```

将在数据库中设置**somefield**`Not Null`，如何设置**somefield**以 允许 NULL？，我尝试通过 SQL Server Management Studio 设置它，但 Entity Framework 将其设置回*`Not Null`*.

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-05-22T22:13:02.550

只需从属性中省略 [Required] 属性即可`string somefield`。这将使它`NULL`在数据库中创建一个有能力的列。

要使 int 类型在数据库中允许 NULL，它们必须在模型中声明为可为空的 int：

```
// an int can never be null, so it will be created as NOT NULL in db
public int someintfield { get; set; }

// to have a nullable int, you need to declare it as an int?
// or as a System.Nullable<int>
public int? somenullableintfield { get; set; }
public System.Nullable<int> someothernullableintfield { get; set; } 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-08-01T15:19:18.590

The other option is to tell EF to allow the column to be null:

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
        modelBuilder.Entity<SomeObject>().Property(m => m.somefield).IsOptional();            
        base.OnModelCreating(modelBuilder);
} 
```

This code should be in the object that inherits from `DbContext`.

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2018-12-18T10:44:42.103

在***Ef .net 核心***中，您可以执行两个选项；首先是数据注释：

```
public class Blog
{
    public int BlogId { get; set; } // optinal case

    [Required]
    public string Url { get; set; } // required case
} 
```

或者使用流利的 api：

```
class MyContext : DbContext
{
    public DbSet<Blog> Blogs { get; set; }

    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Blog>()
            .Property(b => b.Url)
            .IsRequired(false)//optinal case
            .IsRequired()//required case
            ;
    }
}

public class Blog
{
    public int BlogId { get; set; }
    public string Url { get; set; }
} 
```

[这里](https://docs.microsoft.com/en-us/ef/core/modeling/required-optional)有更多细节

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-07-14T17:16:01.603

Jon 的回答对我不起作用，因为我收到编译器错误*CS0453 C# The type must be an non-nullable value type in order to use it as parameter 'T' in the generic type or method*

不过，这对我有用：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<SomeObject>().HasOptional(m => m.somefield);
    base.OnModelCreating(modelBuilder);
} 
```

# cassandra - cassandra + pig 宽柱

> ID：10710397
> 
> 赞同：0
> 
> 时间：2012-05-22T21:24:02.977
> 
> 标签：cassandra, apache-pig

我目前正在开发一个推荐应用程序，我正在使用 cassandra 和 hadoop 和 pig 来执行 map/reduce 工作。为了利用列名属性，我们的团队决定使用无值列和聚合列名来存储数据，例如，特定内容的所有命中都存储在具有单行的列族中，并且每一列都是针对内容使用以下结构：

```
rowkey = 'single_row' {
    id_content:hit_date, -
    .
    .
    .
} 
```

使用这种模式，我们可以获得宽行而不是窄行；问题是，我需要如何操作 Pig 中的数据才能使用此模式将数据存储在 cassandra 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:56:24.467

如果您使用复合列，或者您是否只是连接 id_content 和 hit_date，我不确定您的评论。

对于普通（即非复合）列，架构是：

```
(key, {(col_name, col_value), ...}) 
```

在复合列的情况下，我相信架构如下：

```
(key, {((col_name_part_1, col_name_part_2), col_value), ...}) 
```

此评估（针对复合列）基于阅读在[https://issues.apache.org/jira/browse/CASSANDRA-3684上提交的补丁](https://issues.apache.org/jira/browse/CASSANDRA-3684)

# sql - 处理本身具有属性的属性的标准方法？

> ID：10710401
> 
> 赞同：0
> 
> 时间：2012-05-22T21:24:09.120
> 
> 标签：sql, database-design

我正在创建一个数据库并有一个结构如下的表

```
 Att1    Att2    Att3   ....
User1    
User2
User3
.... 
```

我希望每个属性（Att1，Att2，Att3，...）都附加一个布尔变量。类似于以下内容：

```
Att1    No
Att2    No
Att3    Yes
...     ... 
```

每个属性都是来自用户的数字分数（列表偏好），但我想用它是否真的重要来标记每个属性。是否有处理这种依赖的标准方法？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:00:48.783

哦，如果我们可以在表格中嵌入记录，那就太好了。但是，标准 SQL 和大多数数据库不支持这一点（尽管有例外）。

我会使用一致的命名约定，发明像“IsImportantAtt1”和“IsImportantAtt2”这样的字段。当我这样做时，我也有一个约定，即所有“Is”变量只取“Y”或“N”的值。如果我想在输出中看到“是”和“否”，那么我使用视图进行该转换或在应用程序层中进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T12:21:31.477

在我看来，这`Attribute`实际上是一个实体调用`ListingPreference`，它有一个`Id`键、2 个属性`Score`和一个被调用`IsImportant`的 FK 。`User``UserID`

`User`currentley 只有一把`Id`钥匙。

* * *

简而言之，属性没有属性，这意味着你的模型是错误的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-23T12:02:11.493

如果属性本身不重要，属性的分数是否重要？如果不是，您可以简单地约定一个 NULL 分数意味着该属性不重要。

否则，您可以为每个属性列添加另一个（布尔）列：

```
 Att1    Important1    Att2    Important2    Att3    Important3   ....
User1    
User2
User3
.... 
```

* * *

顺便说一句，属性是固定的吗？即你**总是**有完全相同的属性集吗？如果没有，[EAV 模型](http://en.wikipedia.org/wiki/Entity-attribute-value_model)可能会更好地为您服务（尽管 EAV 传统上具有某些缺点）：

![在此处输入图像描述](../Images/840de1ac210963c2a710f243f13b1828.png)

可以简单地从 USER_ATTRIBUTE 表中省略一个不重要的属性（假设“否”是我在顶部问题的答案）。

# c# - WatiN 有一个错误，需要打开窗口才能成功截屏

> ID：10710403
> 
> 赞同：1
> 
> 时间：2012-05-22T21:24:15.283
> 
> 标签：c#, .net, watin, automated-tests

我最近在一家公司开始了一份工作，该公司希望我使用 WatiN 制作一个 .NET 解决方案，该解决方案可以自动捕获他们网站上的不同屏幕，而我遇到的问题是当我捕获网页时出现黑屏浏览器最小化或不可见时的图像。有没有办法解决这个问题或源代码中的某个位置我可以“修复”最小化浏览器的非渲染图像，或者这只是我必须使用的限制？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:35:59.367

我假设您正在使用 Internet Explorer 运行 watin 测试？如果是这样，请尝试将测试站点添加到 IE 的受信任站点列表中。

我通常使用 Nunit 进行 Watin Integration 测试通过/失败检测。但是，除此之外，您是否`BringToFront`在捕获屏幕截图之前调用该方法？例如：

```
[TearDown]
public void TearDown()
{

    if (TestContext.CurrentContext.Result.State == TestState.Failure ||
        TestContext.CurrentContext.Result.State == TestState.Error)
    {
        Browser.BringToFront();
        Browser.CaptureWebPageToFile(DateTime.Now.ToString("ddmmyyyyHHmmss") + GetType().Name + ".png");
    }
    Browser.Close();
} 
```

# javascript - Javascript 返回语法

> ID：10710404
> 
> 赞同：0
> 
> 时间：2012-05-22T21:24:15.550
> 
> 标签：javascript, syntax

我正在编辑某人的代码，但我不明白他们试图用这个语句做什么。这是函数的末尾。

```
 return !(this.variable == "value") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T21:25:35.173

他们正在返回`true`或`false`基于与比较结果相反的结果。

写起来可能会更清楚：

```
return this.variable != "value"; 
```

有时你会看到：

```
return !!(some.expression); 
```

这会强制将表达式的结果“真实”转换为布尔值（`true`或`false`）。这 ”！！” 只是一对单独的逻辑补码（“非”）运算符。第一个（右侧）将表达式的结果转换为布尔值，但与“真实性”相反。第二个因此将其翻转回来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:25:45.143

它返回一个真或假......

感叹号是NOT...

所以 this.variable 不等于“值”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:27:32.117

```
this.variable == "value" 
```

这将比较两个值并计算为布尔值（如果它们比较相等，则为真）。

```
!(this.variable == "value") 
```

这否定了值（true <-> false）。

```
return !(this.variable == "value") 
```

这将返回函数的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T21:28:12.320

他们正在检查 this.variable 是否等于“值”（返回真或假），然后使用 ! （不）使值相反。

它达到了相同的结果

```
return (this.variable != "value") 
```

您不妨将其更改为那个，因为它更清晰。

# php - 使用php插入两个表

> ID：10710405
> 
> 赞同：0
> 
> 时间：2012-05-22T21:24:15.987
> 
> 标签：php, sql

我环顾四周，但我仍然不确定如何做到这一点。我已经干了几种不同的方法，很明显我仍然做错了。请问你能帮忙吗

我有一个包含帐户用户名和密码的帐户表和一个单独的联系人表，该表被用户名喜欢到帐户表中。我需要插入这两个。这是我到目前为止所拥有的。

谢谢

```
//signup.php  
include 'connect.php';  

echo '<h3>Sign up</h3>';  

if($_SERVER['REQUEST_METHOD'] != 'POST')  
{  
    /*the form hasn't been posted yet, display it 
      note that the action="" will cause the form to post to the same page it is on */  
    echo '<form action="" method="post">
  <br>
  <table width="0" border="0">
    <tr>
    <th align="left" scope="col">Name:</th>
    <th scope="col"><input type="text" name="name"></th>
  </tr>
  <tr>
    <th align="left" scope="row">Phone:</th>
    <td><input type="text" name="phone"></td>
  </tr>
  <tr>
    <th align="left" scope="row">Address</th>
    <td><textarea name="address" rows="4"></textarea></td>
  </tr>
  <tr>
    <th align="left" scope="row"><p>Postcode</p></th>
    <th align="left" scope="row"><input type="text" name="postcode" id="postcode"></th>
  </tr>
  <tr>
    <th align="left" scope="row">Email</th>
    <td><input type="text" name="email"></td>
  </tr>
  <tr>
    <th align="left" scope="row">Username</th>
    <td><input type="type" name="username"></td>
  </tr>
  <tr>
    <th align="left" scope="row">Password</th>
    <td align="left"><input type="password" name="password"></td>
  </tr>
  <tr align="left">
    <th colspan="2" scope="row"><input type="Submit"></th>
  </tr>
  </table>
</form>'; 
} 
else 
{ 
    /* so, the form has been posted, we'll process the data in three steps:  
        1\.  Check the data  
        2\.  Let the user refill the wrong fields (if necessary)  
        3\.  Save the data  
    */  
    $errors = array(); /* declare the array for later use */  

    if(isset($_POST['username']))  
    {  
        //the user name exists  
        if(!ctype_alnum($_POST['username']))  
        {  
            $errors[] = 'The username can only contain letters and digits.';  
        }  
        if(strlen($_POST['username']) > 30)  
        {  
            $errors[] = 'The username cannot be longer than 30 characters.';  
        }  
    }  
    else  
    {  
        $errors[] = 'The username field must not be empty.';  
    } 
    if(!empty($errors)) /*check for an empty array, if there are errors, they're in this array (note the ! operator)*/  
    {  
        echo 'Uh-oh.. a couple of fields are not filled in correctly..'; 
        echo '<ul>'; 
        foreach($errors as $key => $value) /* walk through the array so all the errors get displayed */ 
        { 
            echo '<li>' . $value . '</li>'; /* this generates a nice error list */ 
        } 
        echo '</ul>'; 
    } 
    else 
    { 
        //the form has been posted without, so save it 
        //notice the use of mysql_real_escape_string, keep everything safe! 
        //also notice the sha1 function which hashes the password 
        $sql = "INSERT INTO 
                    tbl_accounts(accounts_username, accounts_password, accounts_date) 
                VALUES('" . mysql_real_escape_string($_POST['username']) . "', 
                       '" . sha1($_POST['password']) . "', 
                        NOW())";  
        $sql2= "INSERT INTO 
                    tbl_contacts(contacts_username, contacts_name, contacts_email, contacts_phone, contacts_address, contacts_postcode, contacts_date) 
                VALUES('" . mysql_real_escape_string($_POST['username']) . "',
                '" . mysql_real_escape_string($_POST['name']) . "',
                '" . mysql_real_escape_string($_POST['email']) . "',
                '" . mysql_real_escape_string($_POST['phone']) . "',
                '" . mysql_real_escape_string($_POST['address']) . "',
                '" . mysql_real_escape_string($_POST['postcode']) . "',
                        NOW())";

        $result = mysql_query($sql);  
        if(!$result)  
        $result = mysql_query($sql2);  
        if(!$result)  
        {  
            //something went wrong, display the error  
            echo 'Something went wrong while registering. Please try again later.'; 
            //echo mysql_error(); //debugging purposes, uncomment when needed 
        } 
        else 
        { 
            echo 'Successfully registered. You can now <a href="signin.php">sign in</a> and start posting! :-)'; 
        } 

    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:29:50.063

改变：

```
 $result = mysql_query($sql);  
    if(!$result)  
    $result = mysql_query($sql2);  
    if(!$result)  
    { 
```

至：

```
 if(!mysql_query($sql) || !mysql_query($sql2))  
    { 
```

...我认为你的问题会消失。

值得您重新阅读[this](http://php.net/manual/en/control-structures.if.php)和[this](http://php.net/manual/en/language.expressions.php)。

另请注意，您应该使用[POST/Redirect/GET](http://en.wikipedia.org/wiki/Post/Redirect/Get)设计模式来处理这种性质的表单提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:42:41.160

搜索stackoverflow，您会找到如下链接：

[堆栈 1](https://stackoverflow.com/questions/6128680/update-two-tables-at-once)

[堆栈 2](https://stackoverflow.com/questions/8765490/mysql-update-two-tables-at-once)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:30:35.867

这个代码块没有做你认为它做的事情

这样做是发送查询 sql1，然后如果该查询失败，则发送 sql2。

```
 $result = mysql_query($sql);  
    if(!$result)  
    $result = mysql_query($sql2);  
    if(!$result) 
```

如果你想插入它们，那么你应该这样做

```
 $result = mysql_query($sql);  
    if(!$result)  {
       echo "first query failed"; 
    }
    else {  $result = mysql_query($sql2); }  

    if(!$result) {
       echo "second query failed";
     } 
```

# mysql - N-per-group with JOIN

> ID：10710412
> 
> 赞同：6
> 
> 时间：2012-05-22T21:24:43.023
> 
> 标签：mysql, sql, greatest-n-per-group

我正在尝试复制[这里](https://stackoverflow.com/questions/1442527/how-to-select-the-newest-four-items-per-category/1442867#1442867)显示的逻辑。但是，当有连接时，我没有任何运气。以下是我的查询的最小化版本：

```
SELECT resources.title, catRel.catRef
FROM resources 
LEFT JOIN placesRel ON placesRel.refId = resId 
LEFT JOIN catRel ON refId = resId
WHERE ... 
```

简而言之，我得到一个列表，其中包含类别 ID，我想将结果限制为不超过*n*个类别的结果，例如，每个 catRef 仅显示两个结果：

```
title             catRef
Swizz Gubbinz     1
Runcible Spoons   1
Peter Pan DVD     2
Button Moon       2
Monkey Alan       3
Bilge Pump        3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:11:46.913

如何在您的联接中使用子查询。我不确定 refID 和 resID 属于哪个表，但是.....

```
SELECT resources.title, catRel.catRef
FROM resources 
LEFT JOIN placesRel ON placesRel.refId = resId 
LEFT JOIN catRel as cr1 ON cr1.catRel.primaryKey in (select cr2.primaryKey from catRel as cr2 where cr2.refID = resId Limit 0,2)
WHERE ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T17:03:04.817

在 MySQL 缺少窗口函数的情况下，答案并非微不足道。这是一个使用 MySQL 的 GROUP_CONCAT 选择每组前 N 条记录的技巧： [MySQL: Selecting Top N Records Per Group](http://code.openark.org/blog/mysql/sql-selecting-top-n-records-per-group)。

作为一个聚合函数，可以操纵 GROUP_CONCAT 以提供所需顺序的串联字符串。使用文本操作，字符串被解析。可选地，将值转换为正确的类型。

# spring - 具有不同上下文配置的多个 Spring 集成测试文件阻止了成功的持久性

> ID：10710417
> 
> 赞同：0
> 
> 时间：2012-05-22T21:25:13.567
> 
> 标签：spring, hibernate, persistence, integration-testing

我有两个单独的集成测试文件，每个文件都有自己的上下文配置文件 (XML)。当我将它们都合并到构建周期中时，我遇到了问题，但如果我将`@Ignore`注释放在其中一个上，一切正常。

我遇到的具体问题是持久性；当两个集成测试都在构建周期中时，我的一个测试没有将对象正确地保存到数据库中。我没有收到错误，它说它正在持久化，并且 Hibernate 输出日志条目说它正在插入，但是当我检查数据库表时，什么都没有。然后，当我自己运行测试（`@Ignore`在另一个测试上）时，它会按应有的方式写入数据库表。

我在上下文配置文件中使用一些相同的变量名是否重要？例如，这两个文件都有一个名为“deviceTxManager”的事务管理器。我认为这没问题，因为它们是用于不同测试的完全独立的配置文件。

在运行下一个测试之前，我是否应该以某种方式“清除”上一个集成测试的上下文？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:01:16.220

罪魁祸首在我的`persistence.xml`档案里。我在用

```
<property name="hibernate.hbm2ddl.auto" value="create" /> 
```

这显然是由每个单独的集成测试类单独使用的。因此，第二个集成测试是重新创建数据库模式，从而清除前面集成测试所做的数据库更改。

我以为`persistence.xml`在所有集成测试运行之前只访问过一次，但显然我错了；它由每个单独的集成测试类单独访问，并且为每个测试类清除和重新创建数据库。

# sockets - Nginx + Thin socket 权限错误 == 网关错误

> ID：10710419
> 
> 赞同：2
> 
> 时间：2012-05-22T21:25:20.480
> 
> 标签：sockets, permissions, nginx, thin, ruby-1.9

我已经让 Nginx 和 Thin 在 Ubuntu 10.04 上运行了好几年。我在 /etc/init.d 中有一个启动 Thin 的脚本，它使用 /etc/thin 中的一些 .yml 文件。

由于任何原因突然重新启动 Thin 会导致 Nginx 中出现权限被拒绝错误。

Thin 在 /tmp 中的几个套接字上运行，由 root 拥有。我不知道是否总是这样......但如果我将套接字的所有者更改为 www-data （由 Nginx 使用），一切正常。所以我写了另一个脚本来处理它。

Thin 运行的是 v1.2.7，Nginx 是 0.7.65。两者都没有改变。我确实从 1.9.2p290 升级到 Ruby 1.9.3p194。

有没有其他人有这个问题，你有没有找到比“手动”更新权限更合理的解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T00:30:55.287

将 Thin 升级到 1.3.1 解决了它。我应该立即尝试，但我在登台服务器上遇到了问题。

反正。也许这会帮助别人。

# facebook - @在 Facebook 上提及，链接我的应用程序中的内容

> ID：10710428
> 
> 赞同：0
> 
> 时间：2012-05-22T21:25:45.550
> 
> 标签：facebook, facebook-graph-api, hyperlink, facebook-apps

我知道 Facebook 没有 API 可以在 Apps 的帖子中添加 @mentions 并且 message_tags 是只读的，但是 Facebook 上的其他应用程序如何链接帖子中消息的内容？

![在此处输入图像描述](../Images/b9315907616374416697032d37048f5c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:32:40.867

这是 OpenGraph[`actions`](https://developers.facebook.com/docs/opengraph/actions/)用户在应用程序上执行[`objects`](https://developers.facebook.com/docs/opengraph/objects/)和[发布](https://developers.facebook.com/docs/opengraph/tutorial/#publish)的表示。

有[教程](https://developers.facebook.com/docs/opengraph/tutorial/)和[示例](https://developers.facebook.com/docs/opengraph/samples/)。阅读[OpenGraph 的关键概念](https://developers.facebook.com/docs/opengraph/keyconcepts/)和/或[OpenGraph 文档](https://developers.facebook.com/docs/opengraph/)以获取更多详细信息。

# django - ExtJS 4.1.0 代理返回更新 api 而不是创建

> ID：10710435
> 
> 赞同：1
> 
> 时间：2012-05-22T21:26:28.360
> 
> 标签：django, extjs, proxy, crud

我正在编写一个关于集成 ExtJS 4 和 Django 的代码。链接是： [https ://github.com/diegocmsantos/extjs4-tdc2011-django](https://github.com/diegocmsantos/extjs4-tdc2011-django)

它在 ExtJS 4.0.0 上运行良好。但是当我升级到 4.1.0 时，它的代理返回更新 api 而不是创建。我已将“idProperty”参数添加到模型中，但仍然给我相同的结果。

型号类：

```
Ext.define('TDC2011.model.Contact', {
    extend: 'Ext.data.Model',
    idProperty: 'id',
    fields : [
            { name : "id", type : "int", mapping : "@id" },
            { name : "name", type : "string"},
            { name : "phone", type : "string"},
            { name : "email", type : "string"}]
}); 
```

店铺类别：

```
Ext.define('TDC2011.store.Contacts', {
    extend: 'Ext.data.Store',
    model: 'TDC2011.model.Contact',
    autoLoad: true,
    pageSize: 35,
    autoLoad: {start: 0, limit: 35},

    proxy: {
        type: 'ajax',
        api: {
            read : 'contact/view.action',
            create : 'contact/create.action/',
            update: 'contact/update.action/',
            destroy: 'contact/delete.action/'
        },
        reader: {
            type: 'json',
            root: 'data',
            successProperty: 'success'
        },
        writer: {
            type: 'json',
            writeAllFields: true,
            encode: false,
            root: 'data'
        },
        listeners: {
            exception: function(proxy, response, operation){
                Ext.MessageBox.show({
                    title: 'REMOTE EXCEPTION',
                    msg: operation.getError(),
                    icon: Ext.MessageBox.ERROR,
                    buttons: Ext.Msg.OK
                });
            }
        }
    }
}); 
```

有没有人知道问题的主要原因？

# android - 如何在 Android 设备上获取每个应用程序的类别？

> ID：10710442
> 
> 赞同：10
> 
> 时间：2012-05-22T21:26:56.327
> 
> 标签：android, google-play

我有一个 Android 应用程序，它扫描设备上安装的所有应用程序，然后将其报告给服务器（它是 MDM 代理）。有关如何获取应用程序类别的任何建议？每个人都有不同的类别列表，但基本上是游戏、娱乐、工具/实用程序等。

据我所知，与设备本身存储的类别无关。我正在考虑使用 android market API 在市场中搜索应用程序并使用搜索返回的 Category 值。不确定这将如何成功找到匹配项。关于如何最好地做到这一点的任何建议？

关于不同方法的任何建议？

提前致谢。麦克风

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2020-05-14T15:28:16.560

我知道这是一篇旧帖子，但对于仍在寻找此内容的任何人，API 级别 26 (O) 已将类别添加到`android.content.pm.ApplicationInfo`.

从文档[https://developer.android.com/reference/android/content/pm/ApplicationInfo#category](https://developer.android.com/reference/android/content/pm/ApplicationInfo#category)：

> `public int category`
> 
> 此应用程序的类别。类别用于将多个应用程序聚集到有意义的组中，例如在汇总电池、网络或磁盘使用情况时。应用程序应仅在它们完全适合特定类别之一时定义此值。
> 
> 从清单中的[R.attr.appCategory](https://developer.android.com/reference/android/R.attr#appCategory)属性设置。如果清单未定义类别，则此值可能已由安装程序通过[PackageManager#setApplicationCategoryHint(String, int)](https://developer.android.com/reference/android/content/pm/PackageManager#setApplicationCategoryHint(java.lang.String,%20int))提供。值为`CATEGORY_UNDEFINED`, `CATEGORY_GAME`, `CATEGORY_AUDIO`, `CATEGORY_VIDEO`, `CATEGORY_IMAGE`, `CATEGORY_SOCIAL`, `CATEGORY_NEWS`, `CATEGORY_MAPS`, 或`CATEGORY_PRODUCTIVITY`

现在可以执行以下操作：

```
PackageManager pm = context.getPackageManager();
ApplicationInfo applicationInfo = pm.getApplicationInfo(packageName, 0);
if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.O) {
    int appCategory = applicationInfo.category;
    String categoryTitle = (String) ApplicationInfo.getCategoryTitle(context, appCategory)
    // ...
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-03-09T21:39:13.773

如果您为每个应用程序获取其包名称，则可以直接询问播放商店应用程序所属的类别，并使用此库解析 html 响应页面：

[org.jsoup.jsoup1.8.3](http://mvnrepository.com/artifact/org.jsoup/jsoup/1.8.3)

这是解决您问题的代码段：

```
public class MainActivity extends AppCompatActivity {

public final static String GOOGLE_URL = "https://play.google.com/store/apps/details?id=";
public static final String ERROR = "error";

...

   private class FetchCategoryTask extends AsyncTask<Void, Void, Void> {

       private final String TAG = FetchCategoryTask.class.getSimpleName();
       private PackageManager pm;
       private ActivityUtil mActivityUtil;

       @Override
       protected Void doInBackground(Void... errors) {
          String category;
           pm = getPackageManager();
           List<ApplicationInfo> packages = pm.getInstalledApplications(PackageManager.GET_META_DATA);
           Iterator<ApplicationInfo> iterator = packages.iterator();
           while (iterator.hasNext()) {
               ApplicationInfo packageInfo = iterator.next();
               String query_url = GOOGLE_URL + packageInfo.packageName;
               Log.i(TAG, query_url);
               category = getCategory(query_url);
               // store category or do something else
           }
           return null;
        }

        private String getCategory(String query_url) {
           boolean network = mActivityUtil.isNetworkAvailable();
           if (!network) {
               //manage connectivity lost
               return ERROR;
           } else {
               try {
                   Document doc = Jsoup.connect(query_url).get();
                   Element link = doc.select("span[itemprop=genre]").first();
                   return link.text();
               } catch (Exception e) {
                   return ERROR;
               }
           }
        }
    }  
} 
```

您可以在 AsyncTask 或服务中进行这些查询。希望对您有所帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-23T00:16:22.223

> 有关如何获取应用程序类别的任何建议？

应用程序没有类别。一些市场有类别。

> 据我所知，与设备本身存储的类别无关。

正确的。

> 我正在考虑使用 android market API 在市场中搜索应用程序并使用搜索返回的 Category 值。

目前没有“android market API”，除非你有一个好的法律团队和大量的法律辩护基金。

此外，并非所有应用程序都通过“android 市场”分发，尤其是在 Kindle Fire 等设备上。此外，欢迎开发人员随时更改类别，至少在 Google Play 商店中是这样。

> 关于如何最好地做到这一点的任何建议？

放弃该功能并继续使用其他方式来增加价值。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-12-18T03:24:52.597

我也面临同样的问题。上述查询的解决方案如下所述。

首先，下载`Jsoup`库或下载jar文件。

或将此添加到您的`build.gradle`（模块：应用程序）`implementation 'org.jsoup:jsoup:1.11.3'`

```
private class FetchCategoryTask extends AsyncTask<Void, Void, Void> {

    private final String TAG = FetchCategoryTask.class.getSimpleName();
    private PackageManager pm;
    //private ActivityUtil mActivityUtil;

    @Override
    protected Void doInBackground(Void... errors) {
        String category;
        pm = getPackageManager();
        List<ApplicationInfo> packages = pm.getInstalledApplications(PackageManager.GET_META_DATA);
        Iterator<ApplicationInfo> iterator = packages.iterator();
        //  while (iterator.hasNext()) {
        // ApplicationInfo packageInfo = iterator.next();
        String query_url = "https://play.google.com/store/apps/details?id=com.imo.android.imoim";  //GOOGLE_URL + packageInfo.packageName;
        Log.i(TAG, query_url);
        category = getCategory(query_url);
        Log.e("CATEGORY", category);

        // store category or do something else
        //}
        return null;
    }

    private String getCategory(String query_url) {

        try {
             Document doc = Jsoup.connect(query_url).get();
            Elements link = doc.select("a[class=\"hrTbp R8zArc\"]");
               return link.text();
        } catch (Exception e) {
            Log.e("DOc", e.toString());
        }
    }

} 
```

作为回报，您将获得应用程序公司名称和应用程序类别

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-09-24T17:42:55.187

我根据@Ankit Kumar Singh 的回答制作了一个 Kotlin 解决方案。
此解决方案将类别映射到枚举，以防您想做其他事情而不仅仅是显示它。

```
import kotlinx.coroutines.*
import org.jsoup.Jsoup
import javax.inject.Inject
import javax.inject.Singleton

class AppCategoryService {
    companion object {
        private const val APP_URL = "https://play.google.com/store/apps/details?id="
        private const val CAT_SIZE = 9
        private const val CATEGORY_STRING = "category/"
    }

    suspend fun fetchCategory(packageName: String): AppCategory {
        val url = "$APP_URL$packageName&hl=en" //https://play.google.com/store/apps/details?id=com.example.app&hl=en
        val categoryRaw = parseAndExtractCategory(url) ?: return AppCategory.OTHER
        return AppCategory.fromCategoryName(categoryRaw)
    }

    @Suppress("BlockingMethodInNonBlockingContext")
    private suspend fun parseAndExtractCategory(url: String): String? = withContext(Dispatchers.IO) {
        return@withContext try {
            val text = Jsoup.connect(url).get()?.select("a[itemprop=genre]") ?: return@withContext null
            val href = text.attr("abs:href")

            if (href != null && href.length > 4 && href.contains(CATEGORY_STRING)) {
                getCategoryTypeByHref(href)
            } else {
                null
            }
        } catch (e: Throwable) {
            null
        }
    }

    private fun getCategoryTypeByHref(href: String) = href.substring(href.indexOf(CATEGORY_STRING) + CAT_SIZE, href.length)
} 
```

这是包含此时所有可能值的枚举：

```
// Note: Enum name matches API value and should not be changed
enum class AppCategory {
    OTHER,
    ART_AND_DESIGN,
    AUTO_AND_VEHICLES,
    BEAUTY,
    BOOKS_AND_REFERENCE,
    BUSINESS,
    COMICS,
    COMMUNICATION,
    DATING,
    EDUCATION,
    ENTERTAINMENT,
    EVENTS,
    FINANCE,
    FOOD_AND_DRINK,
    HEALTH_AND_FITNESS,
    HOUSE_AND_HOME,
    LIBRARIES_AND_DEMO,
    LIFESTYLE,
    MAPS_AND_NAVIGATION,
    MEDICAL,
    MUSIC_AND_AUDIO,
    NEWS_AND_MAGAZINES,
    PARENTING,
    PERSONALIZATION,
    PHOTOGRAPHY,
    PRODUCTIVITY,
    SHOPPING,
    SOCIAL,
    SPORTS,
    TOOLS,
    TRAVEL_AND_LOCAL,
    VIDEO_PLAYERS,
    WEATHER,
    GAMES;

    companion object {
        private val map = values().associateBy(AppCategory::name)
        private const val CATEGORY_GAME_STRING = "GAME_" // All games start with this prefix

        fun fromCategoryName(name: String): AppCategory {
            if (name.contains(CATEGORY_GAME_STRING)) return GAMES
            return map[name.toUpperCase(Locale.ROOT)] ?: OTHER
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-29T21:20:10.090

可能有点晚了，但问题仍然存在。OP 具有将这些结果发送到 API 的优势（这里我假设 API 至少由 OP 或他的 API 同事管理）。

因此，对于有类似问题的任何人，我建议以下内容：

1.  从设备中收集您感兴趣的所有包名称。
2.  将该数据发送到**您的**API
3.  API 应该提取包名并尝试从其缓存/数据库中读取结果...
4.  对于那些在 cache/db 中不存在的包，进行“market API”调用并提取类别 - 将其保存到 db/cache 以在此迭代中重用。
5.  当所有请求（缓存/数据库和市场 API）都完成后，对结果做任何你喜欢的事情。

需要考虑的事项：

当多个用户尝试查询您的 API 以获取相同的包名称并且您的缓存/数据库中没有该包的类别时...执行 1 次请求“市场 API”并在您的缓存/数据库中`packagex`更新为“`packagex`等待结果”状态 - 下一个请求应该获得“等待结果”或“市场 API”返回的结果。

人们还应该考虑为可能的“市场 API”失败（市场 API 不起作用，不是 google play 应用程序，或类似的东西）的后备。这个决定基本上与你的领域相关，你试图抓住的商业趋势将迫使你做出关于这个的决定。如果您真的想整理此类内容，则可以将此回退到人为决策的管道上，并`packagex`相应地更新您的 API 数据库/缓存。

建立一个很好的 API 可以优雅地处理这些和类似的场景，然后甚至可以将它商业化到一定程度和“市场 API 端点”——AKA 商店包详细信息页面。该页面将失去大部分虚假用户:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-29T12:07:10.990

您可以使用下面的 AsyncTask 使用应用程序包 ID 从 playStore 中提取 Android 应用程序类别。

```
import android.content.Context;
import android.content.pm.PackageManager;
import android.os.AsyncTask;
import android.util.Log;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;
import java.io.IOException;

public class GetAppCategory extends AsyncTask<String, Void, String> {

    //Main URL for each app on Play Store
    public static final String APP_URL = "https://play.google.com/store/apps/details?id=";

    //Use below String if extracting 'CATEGORY' from href tag.
    private final String CATEGORY_STRING = "category/";

    private final int cat_size = 9;

    /*Use below String for identified 'GAME' apps, which must start with this prefix.
    Here I only display 'Games' as category for all Games app instead of showing their subCategory also*/
    private final String CATEGORY_GAME_STRING = "GAME_";

    //Name of the app package for which you want to get category.
    private String packageName = null;

    private PackageManager pm = null;

    //Activity or Application context as per requirement.
    private Context appContext;

    /* You can add default system app OR non play store app package name here as comma seprated for ignore them
     and set their category directly 'Others' OR anythings you wish. */
    private final String extractionApps = "com.android.providers.downloads.ui, com.android.contacts," +
            " com.android.gallery3d, com.android.vending, com.android.calculator2, com.android.calculator," +
            " com.android.deskclock, com.android.messaging, com.android.settings, com.android.stk";

    //Class level TAG, use for Logging.
    private final String TAG = "GetAppCategory";

    /**
     * @param packageName: package name of the app, you want to extract category.
     * @param appContext:  Activity/Application level Context ap per requirement.
     */
    public GetAppCategory(String packageName, Context appContext) {
        this.packageName = packageName;
        this.appContext = appContext;
    }

    @Override
    protected String doInBackground(String... params) {
        try {

            pm = appContext.getPackageManager();

            if (packageName != null && packageName.length() > 1) {

                if (packageName.contains("package:")) {
                    packageName = packageName.replace("package:", "");
                }
                /**
                 * Mathod used for parse play store html page and extract category from their.
                 */
                String appCategoryType = parseAndExtractCategory(packageName);

                Log.i(TAG, "package :" + packageName);
                Log.i(TAG, "APP_CATEGORY: " + appCategoryType);
            }

        } catch (Exception e) {
            //TODO:: Handle Exception
            e.printStackTrace();
        } finally {
            //TODO::
        }
        return null;
    }

    @Override
    protected void onPostExecute(String result) {

    }

    /**
     * @param packageName
     * @return
     */

    private String parseAndExtractCategory(String packageName) {

        //You can pass hl={language_code} for get category in some other langauage also other than English.
        //String url = APP_URL + packageName + "&hl=" + appContext.getString(R.string.app_lang);

        String url = APP_URL + packageName + "&hl=en"; //{https://play.google.com/store/apps/details?id=com.example.app&hl=en}
        String appCategoryType = null;
        String appName = null;

        try {

            if (!extractionApps.contains(packageName)) {
                Document doc = null;
                try {
                    doc = Jsoup.connect(url).get();

                    if (doc != null) {

                        //TODO: START_METHOD_1
                        //Extract category String from a <anchor> tag value directly.
                        //NOTE: its return sub category text, for apps with multiple sub category.
                        //Comment this method {METHOD_1}, if you wish to extract category by href value.
                        Element CATEGORY_SUB_CATEGORY = doc.select("a[itemprop=genre]").first();
                        if (CATEGORY_SUB_CATEGORY != null) {
                            appCategoryType = CATEGORY_SUB_CATEGORY.text();
                        }
                        //TODO: END_METHOD_1

                        //TODO: START_METHOD_2
                        // Use below code only if you wist to extract category by href value.
                        //Its return parent or Main Category Text for all app.
                        //Comment this method {METHOD_2}, If you wihs to extract category from a<anchor> value.
                        if (appCategoryType == null || appCategoryType.length() < 1) {
                            Elements text = doc.select("a[itemprop=genre]");

                            if (text != null) {
                                if (appCategoryType == null || appCategoryType.length() < 2) {
                                    String href = text.attr("abs:href");
                                    if (href != null && href.length() > 4 && href.contains(CATEGORY_STRING)) {
                                        appCategoryType = getCategoryTypeByHref(href);
                                    }
                                }
                            }
                        }
                        //TODO: END_METHOD_2

                        if (appCategoryType != null && appCategoryType.length() > 1) {
                            /**
                             * Ger formatted category String by removing special character.
                             */
                            appCategoryType = replaceSpecialCharacter(appCategoryType);
                        }

                    }
                } catch (IOException e) {
                    //appCategoryType = appContext.getString(R.string.category_others);
                    appCategoryType = "OTHERS";
                    //TODO:: Handle Exception
                    e.printStackTrace();
                }
            } else {
                //appCategoryType = appContext.getString(R.string.category_others);
                appCategoryType = "OTHERS";
            }
        } catch (Exception e) {
            //TODO:: Handle Exception
            e.printStackTrace();
        }
        return appCategoryType;
    }

    /**
     * @param href
     * @return
     */
    private String getCategoryTypeByHref(String href) {
        String appCategoryType = null;
        try {
            appCategoryType = href.substring((href.indexOf(CATEGORY_STRING) + cat_size), href.length());
            if (appCategoryType != null && appCategoryType.length() > 1) {
                if (appCategoryType.contains(CATEGORY_GAME_STRING)) {
                    //appCategoryType = appContext.getString(R.string.games);
                    appCategoryType = "GAMES";
                }
            }
        } catch (Exception e) {
            //TODO:: Handle Exception
            e.printStackTrace();
        }
        return appCategoryType;
    }

    /**
     * @param appCategoryType
     * @return: formatted String
     */
    private String replaceSpecialCharacter(String appCategoryType) {
        try {
            //Find and Replace '&amp;' with '&' in category Text
            if (appCategoryType.contains("&amp;")) {
                appCategoryType = appCategoryType.replace("&amp;", " & ");
            }

            //Find and Replace '_AND_' with ' & ' in category Text
            if (appCategoryType.contains("_AND_")) {
                appCategoryType = appCategoryType.replace("_AND_", " & ");
            }

            //Find and Replace '_' with ' ' <space> in category Text
            if (appCategoryType.contains("_")) {
                appCategoryType = appCategoryType.replace("_", " ");
            }
        } catch (Exception e) {
            //TODO:: Handle Exception
            e.printStackTrace();
        }
        return appCategoryType;
    }
} 
```

它需要 jsoup 库来解析 html 页面。你可以在这里找到它[org.jsoup.jsoup1.11.1](http://mvnrepository.com/artifact/org.jsoup/jsoup/1.11.1)

# python - Python 中 UTF-8 CSV 输入的问题

> ID：10710446
> 
> 赞同：21
> 
> 时间：2012-05-22T21:27:12.307
> 
> 标签：python, encoding, utf-8

这似乎应该是一个简单的解决方案，但到目前为止，我还没有找到解决方案。我有一个单列 csv 文件，其中保存在 utf-8 中的非 ascii 字符，我想读入并存储在列表中。我正在尝试遵循[“Unicode Sandwich”](http://nedbatchelder.com/text/unipain.html)的原则并在读取文件时进行解码：

```
import codecs
import csv

with codecs.open('utf8file.csv', 'rU', encoding='utf-8') as file:
input_file = csv.reader(file, delimiter=",", quotechar='|')
list = []
for row in input_file:
    list.extend(row) 
```

这会产生可怕的“编解码器无法在位置编码字符，序数不在范围（128）内”错误。

我也尝试从[这个答案](https://stackoverflow.com/questions/904041/reading-a-utf8-csv-file-with-python)中调整一个解决方案，它返回一个类似的错误

```
def unicode_csv_reader(utf8_data, dialect=csv.excel, **kwargs):
    csv_reader = csv.reader(utf8_data, dialect=dialect, **kwargs)
    for row in csv_reader:
        yield [unicode(cell, 'utf-8') for cell in row]

filename = 'inputs\encode.csv'
reader = unicode_csv_reader(open(filename))
target_list = []
for field1 in reader:
    target_list.extend(field1) 
```

改编自[文档](http://docs.python.org/library/csv.html#examples)的非常相似的解决方案返回相同的错误。

```
def unicode_csv_reader(utf8_data, dialect=csv.excel):
    csv_reader = csv.reader(utf_8_encoder(utf8_data), dialect)
    for row in csv_reader:
        yield [unicode(cell, 'utf-8') for cell in row]

def utf_8_encoder(unicode_csv_data):
    for line in unicode_csv_data:
    yield line.encode('utf-8')

filename = 'inputs\encode.csv'
reader = unicode_csv_reader(open(filename))
target_list = []
for field1 in reader:
    target_list.extend(field1) 
```

显然我错过了一些东西。我看到的有关此问题的大多数问题似乎都早于 Python 2.7，因此此处的更新可能很有用。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-22T22:52:54.123

你的第一个片段不起作用。您正在将 unicode 数据提供给 csv 阅读器，该阅读器（如文档所述）无法处理它。

您的第二个和第三个片段混淆了。您只需要以下内容：

```
f = open('your_utf8_encoded_file.csv', 'rb')
reader = csv.reader(f)
for utf8_row in reader:
    unicode_row = [x.decode('utf8') for x in utf8_row]
    print unicode_row 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-22T22:07:39.193

从第一个字符读取失败时，您可能有一个 BOM。如果`codecs.open('utf8file.csv', 'rU', encoding='utf-8-sig')`您的文件是 UTF8 并且开头有 BOM，则使用此选项。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-22T21:40:34.420

我建议尝试：

```
input_file = csv.reader(open('utf8file.csv', 'r'), delimiter=",", quotechar='|') 
```

或者

```
input_file = csv.reader(open('utf8file.csv', 'rb'), delimiter=",", quotechar='|') 
```

csv 应该是 unicode 感知的，它应该可以工作。

# java - 如何检测 Java System 属性是否已更改？

> ID：10710450
> 
> 赞同：6
> 
> 时间：2012-05-22T21:27:41.960
> 
> 标签：java, properties, listener, jmx

我想知道系统属性何时更改。我在应用程序服务器中有一个应用程序，它以某种方式改变了系统属性（`System.setProperty()`我认为）。我正在看一看，我发现了不同的方法：

1.  [JPDA？](https://stackoverflow.com/questions/5410054/attach-to-another-jvm-and-listen-for-events-possible)
2.  [观察者和可观察者？](https://stackoverflow.com/questions/4130673/triggering-events-in-java-when-an-objects-state-changes)
3.  [属性更改监听器？](http://docs.oracle.com/javase/tutorial/uiswing/events/propertychangelistener.html)
4.  [JMX？](http://java.sun.com/developer/technicalArticles/J2SE/jmx.html)

有什么建议么？提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T21:56:54.970

您可以将系统属性替换为您自己的自定义子类。

```
MyProperties newProps = new MyProperties(System.getProperties());
System.setProperties(newProps); 
```

然后，只需编写一个挂钩相关方法的 Properties 子类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:57:58.153

如果您主要想找到问题，我会考虑使用[`SecurityManager`](http://docs.oracle.com/javase/6/docs/api/java/lang/SecurityManager.html)这个。它有几种可用的方法[`checkPropertiesAccess()`](http://docs.oracle.com/javase/6/docs/api/java/lang/SecurityManager.html#checkPropertiesAccess%28%29)，[`checkPropertyAccess()`](http://docs.oracle.com/javase/6/docs/api/java/lang/SecurityManager.html#checkPropertyAccess%28java.lang.String%29)看起来它们可以帮助您***找到***问题，但不一定能够“在系统属性发生更改时通知您”。

# linux - 即使是一个命令也能及时使用 tee 命令

> ID：10710454
> 
> 赞同：5
> 
> 时间：2012-05-22T21:28:05.330
> 
> 标签：linux, tee

我是使用`tee`命令的新手。

我正在尝试运行我的一个程序，该程序需要很长时间才能完成，但它会随着进度打印出信息。我正在使用 'tee' 将输出保存到文件以及在 shell ( `bash`) 中查看输出。

但问题是`tee`直到我的命令结束才将输出转发到 shell。有什么办法吗？

我正在使用 Debian 和`bash`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:33:22.597

这实际上取决于输出量和您正在运行的任何命令的实现。没有程序有义务直接打印东西`stdout`或一直`stderr`冲洗它。因此，即使大多数 C 运行时实现在使用运行时例程之一写入一定数量的数据后刷新，但`printf`根据实现，这可能不是真的。

它`tee`不会立即输出它，它可能只在命令运行的最后接收输入。提及它是哪个确切命令可能会有所帮助*。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:44:31.160

您遇到的问题很可能与缓冲有关。您可以查看 stdbuf 命令，它执行以下操作：

stdbuf - 运行 COMMAND，并为其标准流修改缓冲操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:33:07.980

如果您要发布您的用法，我可以给出更好的答案，但事实上

```
(for i in `seq 10`; do echo $i; sleep 1s; done) | tee ./tmp 
```

是正确使用 tee 命令并且似乎有效。用您的命令替换管道之前的部分，您应该一切顺利。

# ios - iOS上的OpenGL，触摸和segue（同时）问题

> ID：10710460
> 
> 赞同：0
> 
> 时间：2012-05-22T21:29:04.117
> 
> 标签：ios, opengl-es, touch, segue

### 介绍

我制作了一个 iOS OpenGL 应用程序，它有 3 个不同的视图。在第一个视图“完成”后（我触摸了一些东西），第二个视图有一个转场，等等。

每个视图都有自己的 OpenGL 渲染逻辑。到目前为止，一切都运行良好。

### 问题

如果我现在将手指放在屏幕上（或在模拟器中按住鼠标），我的 segue 仍在工作，但我的 OpenGL 视图没有显示。

任何想法为什么？这是个常见的问题吗？

### 已经试过了

*   我已经尝试在对 touchStart 的调用中调用 touchesEnded（手动），但这似乎并不能解决问题。

# r - 如何强制 x 轴刻度线出现在热图中条的末尾？

> ID：10710463
> 
> 赞同：3
> 
> 时间：2012-05-22T21:29:16.700
> 
> 标签：r, ggplot2

**我用ggplot2**创建了一个简单的热图，但我需要强制 x 轴刻度线出现在我的 x 变量的末尾，而不是在它的中心。例如，我希望 1 出现在 1.5 现在的位置。我相信在 Base R 中完成的热图会做到这一点。

```
library(car) #initialize libraries
library(ggplot2)  #initialize libraries
library(reshape)

df=read.table(text= "x  y  fill
1 1 B
2 1 A
3 1 B
1 2 A
2 2 C
3 2 A
",  header=TRUE, sep=""  )

#plot data
qplot(x=x, y=y, 
      fill=fill, 
      data=df, 
      geom="tile")+  
      scale_x_continuous(breaks=seq(1:3) ) 
```

![在此处输入图像描述](../Images/f2ee33758904307c8af97fb427be3616.png)

这个想法是创建一个简单的热图，如下所示： ![在此处输入图像描述](../Images/7966f934158f43fa0943ccdd94ccad5c.png)

此图中的刻度线放置在条形的末端而不是它们的中心

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T22:33:08.217

那这个呢？

```
object = qplot(x=x, y=y, 
      fill=fill, 
      data=df, 
      geom="tile")+  
      scale_x_continuous(breaks=seq(1:3))

object + scale_x_continuous(breaks=seq(.5,3.5,1), labels=0:3) 
```

![在此处输入图像描述](../Images/30576b84647c8205be4423503b307794.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T00:27:20.627

geom_tile 以给定的坐标居中每个图块。因此，您会期望它确实给出的输出。

因此，如果您给 ggplot 每个单元格的中心（而不是右上角的坐标），它将起作用。

```
ggplot(df, aes(x = x-0.5, y = y-0.5, fill = fill)) + 
  geom_tile() + 
  scale_x_continuous(expand = c(0,0), breaks = 0:3) + 
  scale_y_continuous(expand = c(0,0), breaks = 0:3) + 
  ylab('y') + 
  xlab('x') 
```

或使用 qplot

```
qplot(data = df, x= x-0.5, y = y-0.5, fill = fill, geom = 'tile')  + 
   scale_x_continuous(expand = c(0,0), breaks = 0:3) + 
   scale_y_continuous(expand = c(0,0), breaks = 0:3) + 
   ylab('y') + 
   xlab('x') 
```

# c# - 给定结尾索引，如何突出显示整个单词

> ID：10710465
> 
> 赞同：0
> 
> 时间：2012-05-22T21:29:25.467
> 
> 标签：c#, winforms, richtextbox, syntax-highlighting

我有一个 RichTextBox，并且想突出显示整个单词，只给出它的结尾索引。是否可以从结束索引突出显示，回到第一次出现的空格？

这是我到目前为止尝试过的，但我不知道是否还有其他有效的方法：

```
int length = richTextBox.Text.Reverse().Skip(richTextBox.Text.Length - offset)
      .TakeWhile(x => x != ' ')
      .Count();
richTextBox.Select(offset - length, length + 1);
richTextBox.SelectionBackColor = Color.Yellow; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:38:59.677

这是获取长度的一种非常低效的方法。

试试这个 - 可能会在某个地方被关闭，我现在无法测试它：

```
var prevSpace = richTextBox.Text.LastIndexOf(' ', offset);
var length = prevSpace = -1 ? offset + 1 : offset - prevspace; 
```

# emacs - 如何在 Emacs 中设置鼠标缓冲区菜单中的项目数？

> ID：10710467
> 
> 赞同：8
> 
> 时间：2012-05-22T21:29:37.520
> 
> 标签：emacs

当我在 Emacs 中按 ctrl+left-mouse-button 时，我得到了鼠标缓冲区菜单。这是我最喜欢的切换缓冲区的方式，但缓冲区列表不必太长，就可以将列表重新组织成子菜单（基本、LISP、其他等）。我真的很讨厌这个，因为我发现找到我正在寻找的缓冲区要困难得多。

我的问题是：如何设置 emacs 在将菜单分成子菜单之前将显示的鼠标缓冲区菜单中的项目数？（我想增加它，显然！）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T22:31:44.720

以下两个变量可让您对此进行一些控制：

*   `mouse-buffer-menu-maxlen`
*   `mouse-buffer-menu-mode-mult`

我的解释是，后者是给定主要模式在该模式获得自己的子菜单之前的最大缓冲区数，而前者是任何子/菜单在拆分为多个菜单之前允许的最大缓冲区数。

`setq`视情况而定，或
`M-x` `customize-group` `RET` `mouse` `RET`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-13T14:49:30.940

带有详细信息的完整代码添加到 .emacs 文件如下

另请注意，`mouse-buffer-menu-mode-mult`优先

要评估以下内容并立即查看效果，请突出显示并键入`M-x eval-region`或将光标放在每个 () 中并键入`M-C-x`

```
;; "ctrl - left click" buffer menu: increase number of items shown
;; set max length of this list. default 20\. see next.
(setq mouse-buffer-menu-maxlen 30)
;; set # buffer in a mode before grouping begins. takes precedence over previous
;; set to 1 to always group by mode. default 4
(setq mouse-buffer-menu-mode-mult 8) 
```

# c# - 在按钮单击时编辑动态创建的标签

> ID：10710477
> 
> 赞同：0
> 
> 时间：2012-05-22T21:30:27.277
> 
> 标签：c#, asp.net, dynamic, label, edit

我在 asp.net c# 中需要帮助.....我想在运行时编辑动态创建的标签，并希望在每次回发时都保留在那里....任何人都可以帮助 plzzz...

```
 protected void btnLabel_Click(object sender, EventArgs e)
    {
        int count = 1;
        if (ViewState["label"] != null)
        {
            count += Convert.ToInt32(ViewState["label"]);

        }
        Label lbl = new Label();
        lbl.ID = "ttl" + count.ToString();
        lbl.Text = "Editable label";
        Panel1.Controls.Add(lbl);
        ViewState["label"] = count;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:35:32.217

由于每次页面刷新都会创建标签，因此它永远没有机会保存其视图状态。您需要删除“Label lb = new Label();” 行并将控件添加到 .aspx 文件中的标记。

```
<Label id="lbl" runat="server" /> 
```

# qt - 自动关闭 QMenuBar 项

> ID：10710481
> 
> 赞同：0
> 
> 时间：2012-05-22T21:31:09.430
> 
> 标签：qt, qmenu, qmenubar

我需要知道是否有办法关闭`QMenuBarItem`Qt 中打开的文件。我的意思是，如果我打开一个菜单，我希望 a`QTimer`能够`QMenuBar`在一段时间后关闭。

当我单击一个菜单（如“文件”）时，我正在启动一个`QTimer`，并且在`QTimer`'s`timeout()`插槽中我正在使用下一个代码：

```
menubar->actions()[0]->menu()->close(); 
```

`menubar->actions()[0]`“文件”菜单在哪里。

我一直在搜索但没有成功，我真的需要自动关闭菜单。

我非常感谢您的帮助和您的时间。提前致谢。

*****编辑

您必须使用`menubar.setActiveAction(NULL)`;

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T21:35:44.157

尝试`QWidget::hide()`代替`QWidget::close()`.

# c# - 在继承链中重复代码合同要求？

> ID：10710483
> 
> 赞同：1
> 
> 时间：2012-05-22T21:31:20.127
> 
> 标签：c#, .net-4.0, code-contracts

假设您有一个现有的大型项目，并且想要在其中集成代码合同。现有代码使用 if-null-then-throw 逻辑。对于给定的条件，文档建议将组装模式设置为自定义参数验证。

我有以下课程：

```
class A
{
    protected virtual void Foo(int a, int b)
    {
        if (a == null)
            throw new ArgumentNullException(a);
        if (b == null)
            throw new ArgumentNullException(b);
        Contract.EndContractBlock();
    }
}
class B : A
{
    protected override void Foo (int a, int b)
    {
        // some stuff
        base.Foo(a, b);
    }
} 
```

当我编译时，我收到以下警告：

> 警告 CC1055：方法 'B.Foo(int, int)' 应该包含对 'Requires(a != null)' 的自定义参数验证，因为它会覆盖 'A.Foo(int,int)' 这表明它确实如此。如果您不想在此程序集中使用自定义参数验证，请将程序集模式更改为“标准合同要求”。

我不想在每个被覆盖的方法上重复前提条件！有办法解决吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T08:18:31.660

如果您使用`Contract.Requires()`而不是`Contract.EndContractBlock()`.

下面引用的手册中有一节建议向`[SuppressMessage]`方法覆盖添加一个属性。

来自[Code Contracts 用户手册](http://download.microsoft.com/download/C/2/7/C2715F76-F56C-4D37-9231-EF8076B7EC13/userdoc.pdf)第 22 页第 5.2.3 节。

> **将检查委托给其他方法**
> 
> 假设您有一个类似于以下代码的代码模式：
> 
> ```
> public class Base {
>     public virtual void Compute(string data) {
>     if (data == null) throw new ArgumentNullException(...);
>         Contract.EndContractBlock();
>         ...
>     }
> }
> 
> public class Derived : Base {
>     public override void Compute(string data) {
>         base.Compute(data);
>         ...
>     }
> } 
> ```
> 
> 然后工具将发出警告 CC1055 并带有以下形式的消息：
> 
> > 方法“Derived.Compute”应包含“Requires (ArgumentNullException)(data ! = null)”的自定义参数验证，因为它会覆盖“Base.Compute”，这表明它确实如此。
> 
> 在这种情况下，警告没有帮助，因为 Derived.Compute 的实现将参数验证委托给另一个方法（在本例中为基本方法）。为了避免这种情况下的警告而不重复验证，您可以在方法中添加一个 SuppressMessage 属性：
> 
> ```
> public class Derived : Base {
>     [SuppressMessage("Microsoft.Contracts", "CC1055", Justiﬁcation = "Validation performed in base method")]
>     public override void Compute(string data) {
>         base.Compute(data);
>         ...
>     }
> } 
> ```

# ruby-on-rails-3 - nginx + Unicorn + rails 的 IP 地址错误

> ID：10710486
> 
> 赞同：12
> 
> 时间：2012-05-22T21:31:25.763
> 
> 标签：ruby-on-rails-3, nginx, unicorn

我检查控制器中的IP地址

```
request.env['REMOTE_ADDR'] 
```

这在我的测试环境中运行良好。但是在使用 nginx + unicorn 的生产服务器上，我总是得到`127.0.0.1`.

这是我对该站点的 nginx 配置：

```
 upstream unicorn {
  server unix:/tmp/unicorn.urlshorter.sock fail_timeout=0;
}

server {
  listen 80 default deferred;
  # server_name example.com;
  root /home/deployer/apps/urlshorter/current/public;

  location ^~ /assets/ {
    gzip_static on;
    expires max;
    add_header Cache-Control public;
  }

  try_files $uri/index.html $uri @unicorn;
  location @unicorn {
    proxy_set_header   X-Real-IP        $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;
    proxy_redirect off;
    proxy_pass http://unicorn;
  }

  error_page 500 502 503 504 /500.html;
  client_max_body_size 4G;
  keepalive_timeout 10;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-14T22:35:57.920

我也遇到了麻烦；我发现了这个问题，但其他答案对我没有帮助。

我查看了 Rails 3.2.8 的 Rack::Request#ip 实现，看看它是如何决定要说什么的；为了让它使用通过环境传递的地址而不过滤掉我的本地网络中的地址（它试图过滤掉中间代理，但这不是我想要的），我还必须从我的 nginx 代理配置块中设置 HTTP_CLIENT_IP到你上面的内容（X-Forwarded-For 也必须在那里才能工作！）：

```
proxy_set_header CLIENT_IP $remote_addr; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-08T15:51:38.000

如果你使用`request.remote_addr`你会得到你的 Nginx 代理。

要获取用户的真实 IP 地址，您可以使用`request.remote_ip`.

根据 Rails 的源代码，它会检查各种 http 标头以提供最相关的标头：[在 Rails 3.2](https://github.com/rails/rails/blob/c9bd2022d42890f97f6f9f5896594f030c491add/actionpack/lib/action_dispatch/http/request.rb#L164)或[Rails 4.0.0.beta1](https://github.com/rails/rails/blob/436d91869b7febc0030d79adea136add2f526e49/actionpack/lib/action_dispatch/http/request.rb#L204)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-22T21:36:59.597

答案在您的配置文件中:) 以下应该可以满足您的要求：

```
real_ip = request.headers["X-Real-IP"] 
```

更多信息：http: [//api.rubyonrails.org/classes/ActionDispatch/Request.html#method-i-headers](http://api.rubyonrails.org/classes/ActionDispatch/Request.html#method-i-headers)

**更新**：**正确的**答案在另一个问题中：

[https://stackoverflow.com/a/4465588](https://stackoverflow.com/a/4465588)

或在此线程中：

[https://stackoverflow.com/a/15883610](https://stackoverflow.com/a/15883610)

剧透：

利用`request.remote_ip`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-11-14T22:43:26.857

对于 ELB - nginx - rails 您要遵循本指南：

[http://engineering.blopboard.com/resolving-real-client-ip-with-amazon-elb-nginx-and-php-fpm](http://engineering.blopboard.com/resolving-real-client-ip-with-amazon-elb-nginx-and-php-fpm)

看：

```
server {
   listen 443 ssl spdy proxy_protocol;

   set_real_ip_from 10.0.0.0/8;
   real_ip_header proxy_protocol;

  location /xxx {
    proxy_http_version 1.1;
    proxy_pass <api-endpoint>;
    proxy_set_header      Host              $http_host;
    proxy_set_header      X-Forwarded-By    $server_addr:$server_port;
    proxy_set_header      X-Forwarded-For   $remote_addr;
    proxy_set_header      X-Forwarded-Proto $scheme;
    proxy_set_header      X-Real-IP         $remote_addr;
    proxy_set_header      CLIENT_IP         $remote_addr;
    proxy_pass_request_headers on;
  }
  ... 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-06-19T16:15:35.463

对`proxy_set_header CLIENT_IP $remote_addr;`我不起作用。这是什么..

我在查看 actiondispatch 代码 remote_ip.rb 源后找到的解决方案。现在我在我的设计/看守进程以及我正在查看 request.remote_ip 的任何其他例程中获得了正确的 IP

我的配置... Ruby 2.2.1 - Rails 4.2.1 - NGINX v1.8.0 - Unicorn v4.9.0 - Devise v3.4.1

nginx.conf

HTTP_CLIENT_IP 与 CLIENT_IP

```
location @unicorn {
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_set_header Host $http_host;
  proxy_set_header X-Real-IP $remote_addr;
  proxy_set_header HTTP_CLIENT_IP $remote_addr;  <-----
  proxy_redirect off;
  proxy_pass http://unicorn;
} 
```

源码 actionpack-4.2.1/lib/action_dispatch/middleware/remote_ip.rb

第 114 行：

```
client_ips    = ips_from('HTTP_CLIENT_IP').reverse 
```

第 126 行：

```
"HTTP_CLIENT_IP=#{@env['HTTP_CLIENT_IP'].inspect} " + 
```

# ruby - 如何有条件地禁用 Ramaze 布局？

> ID：10710487
> 
> 赞同：1
> 
> 时间：2012-05-22T21:31:27.467
> 
> 标签：ruby, layout, ramaze

如果请求恰好是 ajax 请求（即 request.xhr? == true），我想要一个控制器方法通过禁用/拒绝布局来响应。

以下似乎不起作用 - 它仍然返回布局

```
class FooController < Ramaze::Controller
  layout :default

  def bar
    if request.xhr?
      layout nil
      "return something here"      #just return this string without the layout
    else
      ... #return with full layout
   end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:58:44.513

您可以通过如下调用绕过视图和布局渲染`respond!`：

```
respond!(body, status, 'Content-Type' => 'whatever/foo') 
```

body 是你的 (json ?) body，状态 HTTP 响应代码。然后，您可以提供带有返回标头的哈希。

但是，您可能会对以不同方式处理请求感兴趣`provides`，例如，以“.json”结尾。有关这方面的更多信息，请参阅[http://ramaze.net/documentation/file.views.html#View_Mapping](http://ramaze.net/documentation/file.views.html#View_Mapping)。

# spring-security - RemoteAuthenticationManager：如何配置？

> ID：10710489
> 
> 赞同：1
> 
> 时间：2012-05-22T21:31:43.777
> 
> 标签：spring-security

参考这个问题（[“服务器返回 HTTP 响应代码：400 使用 Spring-Security AuthenticationProvider”](https://stackoverflow.com/questions/10657720/server-returned-http-response-code-400-using-spring-security-authenticationprov)），我决定我做错了。当我应该使用 RemoteAuthenticationManager 时，我正在尝试使用 RESTful 服务来提供来回发送 UsernamePasswordAuthenticationTokens 的身份验证。（PS 我已经准备好切换到基本身份验证，因为这太麻烦了。不幸的是，这不是一个选择。）

所以，我重组了。

不幸的是，RemoteAuthenticationManagers 的例子很少。

我现在在服务器中有这些 bean：

```
<bean id="remoteAuthenticationManager" class="org.springframework.security.authentication.rcp.RemoteAuthenticationManagerImpl">
    <property name="authenticationManager">
        <ref bean="phsAuthenticationManager"/>
    </property>
</bean>

<bean id="phsAuthenticationManager" class="com.mystuff.phs.agent.service.AuthenticationManager">
    <property name="endpoint" value="${phs.authenticate.endpoint}" />
</bean> 
```

AuthenticationManager 代码在这里：

```
@Service("phsAuthenticationManager")
@Transactional
public class AuthenticationManager implements RemoteAuthenticationManager {
    private String endpoint;

    /** authenticate call to PHS authenticate service. */
    @Override
    public Collection<? extends GrantedAuthority> attemptAuthentication(String userName, String password) {
        ... // implementation details not important.
    }

    public String getEndpoint() {
        return this.endpoint;
    }

    public void setEndpoint(String endp) {
        this.endpoint = endp;
    }
} 
```

所以，我收到以下错误：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'remoteAuthenticationManager' defined in class path resource [phs-datasource.xml]: Initialization of bean failed; nested exception is org.springframework.beans.ConversionNotSupportedException: Failed to convert property value of type '$Proxy48 implementing org.springframework.security.authentication.rcp.RemoteAuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised' to required type 'org.springframework.security.authentication.AuthenticationManager' for property 'authenticationManager'; nested exception is java.lang.IllegalStateException: Cannot convert value of type [$Proxy48 implementing org.springframework.security.authentication.rcp.RemoteAuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised] to required type [org.springframework.security.authentication.AuthenticationManager] for property 'authenticationManager': no matching editors or conversion strategy found 
```

也许我的大脑因为试图配置一个看起来非常简单的界面而被烧毁了。请帮忙？

编辑对项目文件的细微更改：

一位同事对 app-security.xml 文件进行了一些更改，我已经集成了此处建议的更改。这是 app-security.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security" 
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
      http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
      http://www.springframework.org/schema/aop 
      http://www.springframework.org/schema/aop/spring-aop-3.1.xsd
      http://www.springframework.org/schema/security
      http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <http use-expressions="true" pattern="/rest/**" entry-point-ref="http403EntryPoint"
        authentication-manager-ref="remoteAuthenticationManager">
        <intercept-url pattern="/rest/**" access="isAuthenticated()" />
        <custom-filter ref="tenantHmacFilter" position="PRE_AUTH_FILTER" />
    </http>

    <beans:bean id="http403EntryPoint" class="org.springframework.security.web.authentication.Http403ForbiddenEntryPoint">
    </beans:bean>

    <beans:bean id="tenantHmacFilter" class="com.mckesson.phs.agent.filter.TenantHmacFilter">
        <beans:property name="authenticationManager" ref="tenantHmacAuthenticationManager" />
    </beans:bean>

    <beans:bean id="tenantHmacAuthenticationManager" class="com.mckesson.phs.agent.filter.TenantHmacAuthenticationManager">
        <beans:property name="tenantId" value="${tenant.id}" />
        <beans:property name="tenantKey" value="${tenant.key}" />
    </beans:bean>

    <beans:bean id="remoteAuthenticationManager" class="org.springframework.security.authentication.rcp.RemoteAuthenticationManagerImpl">
        <beans:property name="authenticationManager">
            <beans:ref local="authenticationManager" />
        </beans:property>
    </beans:bean>

    <beans:bean id="authenticationManager" class="com.mckesson.phs.agent.service.AuthenticationManagerImpl">
        <beans:property name="endpoint" value="${phs.authenticate.endpoint}" />
    </beans:bean>

</beans:beans> 
```

这是完整的跟踪堆栈：

```
Wed 12:43:04.171 ERROR org.springframework.test.context.TestContextManager: Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener@15c44d6] to prepare test instance [com.mckesson.phs.agent.dao.AppointmentDaoImplTest@ab436d]
java.lang.IllegalStateException: Failed to load ApplicationContext
    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:157)
    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:109)
    at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:75)
    at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:321)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:211)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:288)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:290)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:53)
    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
    at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:175)
    at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:107)
    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:68)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.filterChains': Cannot resolve reference to bean 'org.springframework.security.web.DefaultSecurityFilterChain#0' while setting bean property 'sourceList' with key [0]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.web.DefaultSecurityFilterChain#0': Cannot resolve reference to bean 'org.springframework.security.web.access.intercept.FilterSecurityInterceptor#0' while setting constructor argument with key [7]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.web.access.intercept.FilterSecurityInterceptor#0': Cannot resolve reference to bean 'org.springframework.security.authentication.ProviderManager#0' while setting bean property 'authenticationManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.authentication.ProviderManager#0': Cannot resolve reference to bean 'remoteAuthenticationManager' while setting constructor argument; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'remoteAuthenticationManager' defined in class path resource [app-security.xml]: Initialization of bean failed; nested exception is org.springframework.beans.ConversionNotSupportedException: Failed to convert property value of type '$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised' to required type 'org.springframework.security.authentication.AuthenticationManager' for property 'authenticationManager'; nested exception is java.lang.IllegalStateException: Cannot convert value of type [$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised] to required type [org.springframework.security.authentication.AuthenticationManager] for property 'authenticationManager': no matching editors or conversion strategy found
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveManagedList(BeanDefinitionValueResolver.java:353)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:153)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1360)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1118)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:567)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:103)
    at org.springframework.test.context.support.AbstractGenericContextLoader.loadContext(AbstractGenericContextLoader.java:1)
    at org.springframework.test.context.support.DelegatingSmartContextLoader.loadContext(DelegatingSmartContextLoader.java:228)
    at org.springframework.test.context.TestContext.loadApplicationContext(TestContext.java:124)
    at org.springframework.test.context.TestContext.getApplicationContext(TestContext.java:148)
    ... 30 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.web.DefaultSecurityFilterChain#0': Cannot resolve reference to bean 'org.springframework.security.web.access.intercept.FilterSecurityInterceptor#0' while setting constructor argument with key [7]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.web.access.intercept.FilterSecurityInterceptor#0': Cannot resolve reference to bean 'org.springframework.security.authentication.ProviderManager#0' while setting bean property 'authenticationManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.authentication.ProviderManager#0': Cannot resolve reference to bean 'remoteAuthenticationManager' while setting constructor argument; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'remoteAuthenticationManager' defined in class path resource [app-security.xml]: Initialization of bean failed; nested exception is org.springframework.beans.ConversionNotSupportedException: Failed to convert property value of type '$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised' to required type 'org.springframework.security.authentication.AuthenticationManager' for property 'authenticationManager'; nested exception is java.lang.IllegalStateException: Cannot convert value of type [$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised] to required type [org.springframework.security.authentication.AuthenticationManager] for property 'authenticationManager': no matching editors or conversion strategy found
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveManagedList(BeanDefinitionValueResolver.java:353)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:153)
    at org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:616)
    at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:148)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1035)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:939)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)
    ... 49 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.web.access.intercept.FilterSecurityInterceptor#0': Cannot resolve reference to bean 'org.springframework.security.authentication.ProviderManager#0' while setting bean property 'authenticationManager'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.authentication.ProviderManager#0': Cannot resolve reference to bean 'remoteAuthenticationManager' while setting constructor argument; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'remoteAuthenticationManager' defined in class path resource [app-security.xml]: Initialization of bean failed; nested exception is org.springframework.beans.ConversionNotSupportedException: Failed to convert property value of type '$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised' to required type 'org.springframework.security.authentication.AuthenticationManager' for property 'authenticationManager'; nested exception is java.lang.IllegalStateException: Cannot convert value of type [$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised] to required type [org.springframework.security.authentication.AuthenticationManager] for property 'authenticationManager': no matching editors or conversion strategy found
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1360)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1118)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)
    ... 63 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.authentication.ProviderManager#0': Cannot resolve reference to bean 'remoteAuthenticationManager' while setting constructor argument; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'remoteAuthenticationManager' defined in class path resource [app-security.xml]: Initialization of bean failed; nested exception is org.springframework.beans.ConversionNotSupportedException: Failed to convert property value of type '$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised' to required type 'org.springframework.security.authentication.AuthenticationManager' for property 'authenticationManager'; nested exception is java.lang.IllegalStateException: Cannot convert value of type [$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised] to required type [org.springframework.security.authentication.AuthenticationManager] for property 'authenticationManager': no matching editors or conversion strategy found
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106)
    at org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:616)
    at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:148)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1035)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:939)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)
    ... 73 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'remoteAuthenticationManager' defined in class path resource [app-security.xml]: Initialization of bean failed; nested exception is org.springframework.beans.ConversionNotSupportedException: Failed to convert property value of type '$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised' to required type 'org.springframework.security.authentication.AuthenticationManager' for property 'authenticationManager'; nested exception is java.lang.IllegalStateException: Cannot convert value of type [$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised] to required type [org.springframework.security.authentication.AuthenticationManager] for property 'authenticationManager': no matching editors or conversion strategy found
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:527)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)
    ... 85 more
Caused by: org.springframework.beans.ConversionNotSupportedException: Failed to convert property value of type '$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised' to required type 'org.springframework.security.authentication.AuthenticationManager' for property 'authenticationManager'; nested exception is java.lang.IllegalStateException: Cannot convert value of type [$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised] to required type [org.springframework.security.authentication.AuthenticationManager] for property 'authenticationManager': no matching editors or conversion strategy found
    at org.springframework.beans.BeanWrapperImpl.convertIfNecessary(BeanWrapperImpl.java:485)
    at org.springframework.beans.BeanWrapperImpl.convertForProperty(BeanWrapperImpl.java:516)
    at org.springframework.beans.BeanWrapperImpl.convertForProperty(BeanWrapperImpl.java:510)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.convertForProperty(AbstractAutowireCapableBeanFactory.java:1406)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1365)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1118)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    ... 91 more
Caused by: java.lang.IllegalStateException: Cannot convert value of type [$Proxy47 implementing com.mckesson.phs.agent.service.AuthenticationManager,org.springframework.aop.SpringProxy,org.springframework.aop.framework.Advised] to required type [org.springframework.security.authentication.AuthenticationManager] for property 'authenticationManager': no matching editors or conversion strategy found
    at org.springframework.beans.TypeConverterDelegate.convertIfNecessary(TypeConverterDelegate.java:241)
    at org.springframework.beans.BeanWrapperImpl.convertIfNecessary(BeanWrapperImpl.java:470)
    ... 97 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T03:58:02.927

您得到的错误是由于类型不匹配。Spring Security authenticationManager 配置如下：

```
<security:authentication-manager alias="authenticationManager" erase-credentials="true">
    ...
</security:authentication-manager> 
```

然后将其连接到`RemoteAuthenticationManagerImpl`：

```
<bean id="remoteAuthenticationManager" class="org.springframework.security.authentication.rcp.RemoteAuthenticationManagerImpl">
    <property name="authenticationManager"><ref local="authenticationManager" /></property>
</bean> 
```

如果您正在寻找 HttpInvoker 解决方案（都结束 Spring），那么上面的配置如下：

```
<bean name="/RemoteAuthenticationManager" class="org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter">
    <property name="service"><ref local="remoteAuthenticationManager"/></property>
    <property name="serviceInterface" value="org.springframework.security.authentication.rcp.RemoteAuthenticationManager" />
</bean> 
```

请添加有关您要执行的操作的更多详细信息。您是否在分布式应用程序中实现 Spring Security，例如分布式应用程序[中的 Spring Security](https://stackoverflow.com/questions/2342096/spring-security-in-a-distributed-application)或[Spring HTTP Invoker Authentication Questions](http://forum.springsource.org/showthread.php?123778-Spring-HTTP-Invoker-Authentication-Questions)？

# c++ - if 语句中运算符优先级的解释

> ID：10710490
> 
> 赞同：0
> 
> 时间：2012-05-22T21:31:51.160
> 
> 标签：c++, operator-precedence

示例代码：

```
#include <iostream>

int main()
{
    if(int a = std::cin.get() && a == 'a')
    {
        std::cout << "True" << std::endl;
    }
} 
```

**问题**：

当我编译这段代码时，Visual Studio 给了我一个很好的警告：`warning C4700: uninitialized local variable 'a' used`. 所以我知道那`a`是未初始化的。但是，我想完全理解表达式是如何计算的。上面的 if 语句是否等同于`if(int a && a == 'a') { a = std::cin.get(); }`？有人可以准确解释会发生什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T21:33:45.447

and 运算符`&&`的优先级高于赋值运算符`=`。所以换句话说，你的语句是这样执行的：

```
if (int a = (std::cin.get() && a == 'a')) 
```

你真的想使用显式括号：

```
int a;
if ((a = std::cin.get()) && a == 'a') 
```

更好的是，编写清晰的代码：

```
int a = std::cin.get();
if (a == 'a') 
```

:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:32:40.147

表达式被评估，就好像它是它自己的语句一样。像这样：

```
int a = std::cin.get() && a == 'a'; 
```

因此，它等效于使用***AND***`a`的结果初始化一个变量，并比较未初始化的变量和文字 char 。`std::cin.get()` *`'a'`*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:35:11.657

您正在使用该变量来初始化自身。首先分配内存，然后将该内存中的任何内容与“a”进行比较，并将结果用于初始化变量。*

# java - Eclipse侦察休眠

> ID：10710495
> 
> 赞同：3
> 
> 时间：2012-05-22T21:32:12.430
> 
> 标签：java, eclipse, hibernate, eclipse-scout

我使用了 Eclipse Scout，并按照教程中的说明创建了示例应用程序。它看起来很棒，用它构建应用程序非常容易。

我想问一下是否有人将它用于“真正的”应用程序以及它对他的工作方式。是否有关于如何将 Eclipse Scout 与 Hibernate 一起使用的教程/示例？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T20:41:04.297

很高兴到目前为止你喜欢 Scout！多年来，我们（BSI，一家瑞士软件公司）成功地将 Eclipse Scout 用于我们所有的产品，包括客户关系管理系统、联络中心解决方案和临床试验管理系统。其中一些应用程序被成千上万的用户使用，其他的只有几十个用户。

关于 Scout 和 Hibernate，我们中的一个人现在正在构建一个示例应用程序来演示 Scout、JPA 和 Hibernate。结果将在不久的将来发布在我们的[Scout wiki上，以便我们可以在我们的](http://wiki.eclipse.org/Scout)[论坛中正确回答您的问题](http://www.eclipse.org/forums/index.php/t/354498/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-05T14:49:45.397

现在 Eclipse Scout 已经从 OSGI 转变为面向 J2EE 和基于 maven 的框架，我想使用 Hibernate 和其他框架很容易。

编辑：有一个 scout + spring boot + spring 数据集成的例子： [https ://github.com/BSI-Business-Systems-Integration-AG/ScoutBoot-Tasks](https://github.com/BSI-Business-Systems-Integration-AG/ScoutBoot-Tasks)

# asp.net - Html Helper 在 mvc3 razor 视图中创建一个可重复的函数？

> ID：10710500
> 
> 赞同：0
> 
> 时间：2012-05-22T21:32:52.533
> 
> 标签：asp.net, asp.net-mvc-3, razor, lambda

我有以下代码块，在剃刀视图中复制并粘贴了大约 5 次不同的时间。它基本上显示了相同模型的表格，只是具有不同的数据。

如何将它重写为 html 帮助程序或 lambda func，以便我可以将它重用于传递到视图中的 n 个不同模型？

```
 // Example for Model.A and Model.B 

  var cCols = new[] { "val1", "val2"};

    // Display the data for A
   <div class="group-property">
    <div class="group-label">Title A</div>        
        <table class="collection-table">
        <thead>
        <tr class="collection-head">@foreach (var col in cCols) {<th scope="col">@col</th>}</tr>
         </thead>
         <tbody>
            @foreach (var item in Model.A)
            {
                <td>@item.val1</td>
                <td>@item.val2</td>
            }
         </tbody>
         </table>
    </div>

   // Display the data for B
   <div class="group-property">
    <div class="group-label">Title B</div>        
        <table class="collection-table">
        <thead>
        <tr class="collection-head">@foreach (var col in cCols) {<th scope="col">@col</th>}</tr>
         </thead>
         <tbody>
            @foreach (var item in Model.B)
            {
                <td>@item.val1</td>
                <td>@item.val2</td>
            }
         </tbody>
         </table>
    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:37:59.613

我不知道我是否做对了，但为什么不使用 @Html.Partial 呢？

安德烈·内古

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T03:26:19.807

我不确定您尝试了什么，但要使其成为辅助函数，您只需获取不同的部分并将它们作为函数的参数：

```
@helper MyHelperFunction(string title, IEnumerable<ItemClass> items)
{
var cCols = new[] { "val1", "val2"};

<div class="group-property">
<div class="group-label">@title</div>        
    <table class="collection-table">
    <thead>
    <tr class="collection-head">@foreach (var col in cCols) {<th scope="col">@col</th>}</tr>
     </thead>
     <tbody>
        @foreach (var item in items)
        {
            <td>@item.val1</td>
            <td>@item.val2</td>
        }
     </tbody>
     </table>
</div>
}

@MyHelperFunction("Title A", Model.A)
@MyHelperFunction("Title B", Model.B) 
```

# java - 最大合并单元格内容长度 - Java POI 3.7

> ID：10710507
> 
> 赞同：0
> 
> 时间：2012-05-22T21:33:21.723
> 
> 标签：java, merge, cell, apache-poi

我知道单个 HSSF 工作簿单元格内容的最大长度是`32,676`字符。如果我合并超过 3 行的单元格，我可以获得最大长度`3*32676`还是不能以这种方式工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T22:00:47.730

我不相信你能做到这一点。`HSSF`几乎实现了底层 Excel 1997-2003 格式支持的功能。也就是说，一般来说，尝试合并两个或多个包含数据的单元格会导致一些截断。截断取决于如何查看 excel。因此，要回答您的问题，您将无法保留单元格中的所有数据。您将保留左上角或右上角单元格中的数据。

# html - 我怎样才能让这个当前选定的选项卡显示得比其他选项卡略大？

> ID：10710509
> 
> 赞同：0
> 
> 时间：2012-05-22T21:33:25.993
> 
> 标签：html, css, tabs

我使用 css、html 和 jQuery 制作了一个选项卡式框。我希望能够显示选定的选项卡比其他选项卡稍大或稍高。当我增加高度并在所选选项卡上为父 ul 设置负边距时，边框的顶部完全消失。[这是我正在处理的标签框。](http://testingwebsite28.bugs3.com/)我几乎整天都坐在这里，chrome 元素检查器尝试了我能想到的每一种变化，以使选定的选项卡略高一些，但似乎无法使其工作。我已经非常接近弄乱了高度、边距等。但是父 div 上的边框一直延伸到右侧的顶部：![在此处输入图像描述](../Images/88fb4535b9fc05ced0caca471c4615a2.png)

这是我想要的外观；视频库（选定）选项卡比其他选项卡高一点。如果除了[链接](http://testingwebsite28.bugs3.com/)之外，您还希望我发布代码，请告诉我。我很乐意这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:52:35.280

我只是对 chrome 进行了更快的修补，这似乎可以解决问题。

如果将以下内容应用于活动选项卡： margin-top: 0px !important;

然后设置 margin-top: 5px; 对所有 li 元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:47:27.163

从您的 CSS 中删除这一行似乎对我有所帮助。尝试在 a 上调​​整样式

```
a:hover, a:active {outline: none;} 
```

# php - 通过 PHP 在嵌入式播放器中使用动态 mp3 数据不起作用

> ID：10710511
> 
> 赞同：0
> 
> 时间：2012-05-22T21:33:44.590
> 
> 标签：php, javascript, http-headers, mp3, binary-data

我有一个在网页中运行的嵌入式 mp3 播放器。当我将物理 mp3 的路径加载为文件 url 时，它工作得很好，但是当我尝试从 php 端点加载 mp3 二进制数据时，它会失败。

这是我通过 php 输出 mp3 数据的方法：

```
//Begin writing headers
header( 'Pragma: public' );
header( 'Expires: 0' );
header( 'Cache-Control: must-revalidate, post-check=0, pre-check=0' );
header( 'Cache-Control: public' );
header( 'Content-Description: File Transfer' );
header( 'Content-Type:audio/mpeg');
header( 'Content-Disposition: inline;');
header( 'filename=SoundFile.mp3' );
header( 'Content-Transfer-Encoding: binary' );

//supply the length
$len = strlen($res['ReturnValue']);
header( 'Content-Length: ' . $len );

echo $res['ReturnValue']; exit();
// $res['ReturnValue'] is the actual binary data of the mp3 
```

此外，当我在浏览器中运行该 php 代码时，它会导致下载正确名称和文件大小的文件，但文件本身不会在任何东西（itunes / winamp / 等）上播放，就好像它已损坏一样。

我在输出这些数据导致它无法在嵌入式 mp3 播放器中播放时做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T21:44:30.687

字节数据没有正确输出给我，因此，我的标题不是问题。

# jquery - jQuery $.get 返回空，而不是跨域

> ID：10710515
> 
> 赞同：0
> 
> 时间：2012-05-22T21:34:07.293
> 
> 标签：jquery

可能是 $.ajax 和 $.get 最简单的用法，但它失败了。

我从同一域上的 URL 中提取 HTML：

```
$.get("/url", function(data) {
    console.log(data);
}); 
```

这里的问题是该函数返回空，没有错误，没有“跨域”警报。但是，如果我检查网络日志，则请求已成功完成，并返回了完整的 HTML 字符串。

那么什么可能是垃圾 jQuery 呢？如果响应的格式不喜欢它会卡住吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:53:41.417

我不完全确定它为什么会有所不同，但使用这个：

```
$('#resource-html').load(url); 
```

得到它的工作。必须与 jQuery 如何处理数据有关。

## 更新

我可以确认问题的原因。响应中注入了一个流氓标头，因此内容类型像`application/json`常规文本一样返回。所以很可能 jQuery 试图解析实际上是 HTML 的 JSON，或者完全忽略它。

经验教训：检查您的响应标头。

# c# - 在窗体上注册 MouseDown 和 MouseMove

> ID：10710516
> 
> 赞同：3
> 
> 时间：2012-05-22T21:34:14.750
> 
> 标签：c#

如何以及在哪里可以在表单上注册鼠标事件。当我双击表单时，它会为我生成 Form_Load 事件，我可以在其中添加代码。但是，当我添加类似

```
private void Form1_MouseDown(object sender, MouseEventArgs e{

Console.WriteLine("mouse down")

} 
```

但是，当我在表单上执行 mousedown 事件时，控制台上什么也没有。我知道在将事件注册到表单或类似的东西的地方缺少一些东西。有任何想法吗？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T21:37:57.617

在设计器视图中，选择表单，然后在属性窗口中，单击小闪电（事件）。

在这里，您可以选择为哪个事件调用哪个委托方法。如果您还没有创建方法，只需双击事件旁边的空白区域，它就会为您生成代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:39:38.583

如果您使用的是 VS.net，那么您应该在属性面板中找到所有事件。只需选择您想要的。

如果您想以语法方式注册事件，则代码如下所示：

```
Form1.Click += new MouseEventHandler(Form1_MouseDown); 
```

为了注销它

```
Form1.Click -= new MouseEventHandler(Form1_MouseDown); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T21:40:56.150

事件需要从设计器或代码“连接”。您可以通过在属性窗口中双击事件来连接 Visual Studio 中的事件：

![在此处输入图像描述](../Images/698dc1640cd6bf33f38b65900323e64e.png)

在自动生成的文件中生成[如下代码](http://msdn.microsoft.com/en-us/library/system.windows.forms.mouseeventhandler.aspx)`.designer`：

```
theForm.MouseDown += new MouseEventHandler(Form1_MouseDown); 
```

您还可以使用上述代码在您的`Form_Load`方法中手动连接事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T21:40:05.153

使用 WinForms，您需要通过 Visual Studio 中的设计视图添加它。

在设计视图中，选择您的表单。然后，单击“属性”面板中的“事件”按钮（看起来像一个闪电）并在相应事件下输入函数名称。您还可以单击此处的事件以在代码隐藏中自动生成新函数。

如您所见，双击表单将自动在代码隐藏中生成某个函数。对于表单，它是 Load，但对于其他事情，它可能是 MouseDown 或其他一些事件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T21:39:19.350

根据您的解释，您似乎已经通过设计器正确注册了事件......如果您仍然没有在控制台上看到字符串，请尝试 System.Diagnostics.Debug.WriteLine （也许您正在查看错误的窗口）

# regex - 从字符串中去除汉字（vba）

> ID：10710518
> 
> 赞同：1
> 
> 时间：2012-05-22T21:34:18.680
> 
> 标签：regex, vba, ms-office

我正在使用 Microsoft Project VBA 将我的活动名称从英文翻译成中文。

我的问题是我在一些英文活动名称中嵌入了一些中文翻译。我想在将字符串传递给 Microsoft Translator 之前去掉汉字。

关于我如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T10:32:34.607

您可以使用 a`Regexp`来剥离中文 unicode 字符

[维基百科](http://en.wikipedia.org/wiki/CJK_Unified_Ideographs)列出了下面的相关字符

![在此处输入图像描述](../Images/06cf93a08fd2fb294d704c9aa890ee00.png)

```
Sub Test()
Dim myString as String
myString = "This is my string with a " & ChrW$(&H6C49) & " in it."
Dim objRegex As Object
Set objRegex = CreateObject("vbscript.regexp")
With objRegex
    .Global = True
    .Pattern = "[\u4E00-\u9FFF\u6300-\u77FF\u7800-\u8CFF\u8D00-\u9FFF]+"
    MsgBox .Replace(myString, vbNullString)
End With
End Sub 
```

所以这个正则表达式将去掉这些范围。我使用*了 aldo.roman.nurena 的*字符串示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T22:13:42.767

你必须这样使用`ChrW$()`：

```
MyString = "This is my string with a " & ChrW$(&H6C49) & " in it." 
```

Unicode上`H6C49`可以使用（感谢上帝）作为 CJK 代码（中文、日文和韩文）。看到[这个](http://en.wikipedia.org/wiki/CJK_Unified_Ideographs)来看看字符范围。

因此，您必须检查字符 Unicode 代码，然后比较它是否已经在 CJK 范围内，以便翻译它。

这里也有一个很好的解释，甚至还有一个翻译字符串的[程序](http://teaandbiscuits.org.uk/drupal/node/77)

# apache - CodeIgniter 包含来自应用程序的 js、css 文件返回 403 禁止

> ID：10710521
> 
> 赞同：4
> 
> 时间：2012-05-22T21:34:34.903
> 
> 标签：apache, codeigniter, mamp

我在从 application/modules 目录中加载 javascript 或 css 或任何其他文件时遇到问题。

我正在将 MAMP 和 CodeIgniter 与 HMVC 一起使用，并尝试在模块文件夹中包含 js 和 css 文件夹。然后，当我调用控制器方法时，我也在加载资产文件。

我还有其他以这种方式工作的网站。结构相同，CodeIgniter 版本相同。基本上我已经复制了以前的网站并从那里开始。

但它总是返回 403 禁止。

我做了什么但仍然没有改变：

1.  整个站点目录是可写和可读的。
2.  我可以创建新文件并将其从 PHP 读取到该目录
3.  我有我试图删除或更改的 htaccess 文件
4.  重新安装 MAMP
5.  试图打开一个简单的html文件
6.  MAMP 用户和组对目录具有完全访问权限
7.  我试图在另一台服务器上运行该网站

apache 日志显示“[Tue May 22 17:24:30 2012] [error] [client 127.0.0.1] client denied by server configuration”

这是 .htaccess 文件：

```
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ index.php/$1 [L] 
```

同时，其他站点的一切都很好。

到目前为止，我已经花了很多时间，但我被困住了。

任何想法或建议表示赞赏。

谢谢，

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-22T21:38:47.210

`/application`CodeIgniter 在包含的目录中带有一个 .htaccess

```
Deny from all 
```

您需要删除此文件或更改其规则集以从内部任何位置访问 js/css 文件等`application/*`

然而，允许完全访问应用程序在很大程度上是不可取的，最好修改这个 .htaccess 文件以允许访问`application/modules/*/css|js/`

# html - 即使使用 display: table-cell，div 内容也不会垂直居中

> ID：10710522
> 
> 赞同：1
> 
> 时间：2012-05-22T21:34:55.793
> 
> 标签：html, css

我正在尝试将 a 中的元素垂直居中`div`，因此根据[http://www.w3.org/Style/Examples/007/center.en.html](http://www.w3.org/Style/Examples/007/center.en.html)，我设置了 a和`min-height`，但我里面的文本仍然是顶部-对齐。`vertical-align: middle``display: table-cell``div`

```
<div id="fancybox-title-div" style="border: 1px solid black; min-height: 40px; display: table-cell; vertical-align: middle; width:50%; text-align: center; ">
    <div style="height: 50px; float: left; width: 25px; background-color: blue"></div>
    <div style="width: 70%">
    <span>text</span><br><a href="'+link+'" >view comments</a>
    </div>
</div> 
```

这是一个视觉效果的 jsFiddle：

[http://jsfiddle.net/ccross59/gARYk/15/](http://jsfiddle.net/ccross59/gARYk/15/)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T22:35:18.917

我的理解和它一直对我有用的方式是，`display: table-cell`它必须位于另一个元素（如 a `div`）中，带有`display: table`.

**例子：**

[http://jsfiddle.net/495Rm/](http://jsfiddle.net/495Rm/)

**示例代码：**

```
div#top{
    display:table;
    height:100px;
    border:1px solid red;
}

div#top{
    display:table-cell;
    vertical-align:middle;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T22:12:16.307

这是我评论中的解决方案：http: [//jsfiddle.net/thirtydot/gARYk/26/](http://jsfiddle.net/thirtydot/gARYk/26/)

**HTML：**

```
<div id="fancybox-title-div">
    <div class="left"></div>
    <div class="right">
        <span>text</span><br /><a href="'+link+'" >view comments</a>
    </div>
</div> 
```

**CSS：**

```
#fancybox-title-div {
    border: 1px solid black;
    min-height: 40px;
    width: 50%;
    margin-left: auto;
    margin-right: auto;
}
#fancybox-title-div .left {
    display: inline-block;
    vertical-align: middle;
    height: 50px;
    width: 25px;
    background-color: blue;
}
#fancybox-title-div .right {
    display: inline-block;
    vertical-align: middle;
    width: 70%;
    border: 1px solid red;
} 
```

如果它很重要，因为它在 IE7 中不起作用。这是一个固定版本：http: [//jsfiddle.net/gARYk/27/](http://jsfiddle.net/gARYk/27/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-22T21:38:00.800

[jsfiddle.net/gARYk/10](http://jsfiddle.net/gARYk/10) .... 这就是你要找的。

# jquery - 如何将 div 与绝对位置垂直对齐？

> ID：10710529
> 
> 赞同：4
> 
> 时间：2012-05-22T21:35:36.730
> 
> 标签：jquery, css, html, position, z-index

我有两个 div，我需要将它们放在另一个 div 中。很简单，我使用 z-index 并给它们位置：绝对值。但是每个 div 的内容都需要垂直对齐。当我将它们放在顶部时，它们不会垂直居中。

有没有办法混合这两种风格来做到这一点？

或者这可能以某种方式使用 jQuery 吗？

这基本上就是我所拥有的。

```
<div style="width:100%">
  <div style="height:400; width:400; display:table-cell; vertical-align:middle; z-index:0; position:absolute;"><img></div>
  <div style="height:400; width:400; display:table-cell; vertical-align:middle; z-index:1; position:absolute;"><img></div>
</div> 
```

我有高度和宽度，表格单元格和垂直对齐作为中间。这使内容居中，直到我添加了 z-index 工作所需的绝对位置。

有任何想法吗？谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T21:57:12.040

给你的内部 div`line-height:400px;`

[http://jsfiddle.net/2DXPg/1/](http://jsfiddle.net/2DXPg/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T22:03:56.533

您可以在第二个中添加一个额外的 div：http: [//jsfiddle.net/MDJDx/](http://jsfiddle.net/MDJDx/)

```
<div style="width:100%">
  <div style="height:400px; width:400px; display:table-cell; vertical-align:middle; z-index:0; position:relative;top:0;">img</div>
  <div style="height:400px; width:400px; z-index:1; position:absolute; top:0">
    <div style="height:400px; width:400px; display:table-cell; vertical-align:middle; position:relative;">img</div>
  </div>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T21:41:03.857

设置两个内部 div 的样式

```
position: relative; top: 0px; 
```

除了你已经拥有的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T21:39:12.437

添加

```
margin: auto; 
```

到包含您想要居中的内容的 div。为此，您还必须在此 div 上设置宽度。

也许

```
width: 100%; 
```

应该做的伎俩。

# ajax - 从 Firefox 和 Chrome 扩展对 https php 服务器的 AJAX 请求

> ID：10710538
> 
> 赞同：0
> 
> 时间：2012-05-22T21:36:30.347
> 
> 标签：ajax, https, google-chrome-extension, firefox-addon

我正在开发 Firefox 和 Chrome 的扩展。我的扩展使用的数据主要是从 ajax 请求生成的。返回的数据类型是私有的，因此它需要是安全的。我的服务器支持 https 并且 ajax 调用被发送到 https 域。信息正在来回发送，并且扩展程序正常工作。

我的问题是：

扩展是否真的与服务器建立了安全连接，或者这是否被认为与跨域发布相同，将请求从 http 页面发送到 https 页面？

与用户直接从浏览器中的 https 网页访问信息相比，我是否在传输过程中将用户信息置于更大的风险之中？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T04:10:54.093

当您使用 HTTPS 时，浏览器绝对会建立安全连接。当然，浏览器绝不会在不告诉您的情况下降低连接的安全性：它要么按照书面要求完成请求，要么在不可能的情况下抛出某种错误。

Chrome 和 Firefox 的扩展都允许发出跨域 AJAX 请求。在 Chrome 中，您只需提供主机的协议/名称作为您的`manifest.json`. 在 Firefox 中，我认为您可能需要使用`Components.classes`来获取跨域请求者，如[使用 XMLHttpRequest](https://developer.mozilla.org/En/Using_XMLHttpRequest#Using_XMLHttpRequest_from_JavaScript_modules_.2F_XPCOM.C2.A0components)的 MDN 页面中所述，但我对此不是 100% 确定。尝试做一个正常的请求，看看是否成功；如果没有，请使用`Components.classes`解决方案。

# simulation - FSX 和 ESD SDK，有什么区别？

> ID：10710543
> 
> 赞同：0
> 
> 时间：2012-05-22T21:36:58.290
> 
> 标签：simulation

我对 FSX 的 SimConnect 很感兴趣。我[在 ESP 下找到 SimConnect SDK 文档](http://msdn.microsoft.com/en-us/library/cc526983.aspx)- 这与 FSX SDK 下的 SimConnect 功能相同吗？

如果有区别，那是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T16:26:34.740

我在这里找到了答案：[http ://www.fsdeveloper.com/forum/showthread.php?t=175529](http://www.fsdeveloper.com/forum/showthread.php?t=175529)

基本上是一样的，在上面的答案中找到详细信息。

# performance - Selenium 相对定位器从 WebElement 搜索非常慢

> ID：10710549
> 
> 赞同：1
> 
> 时间：2012-05-22T21:37:20.350
> 
> 标签：performance, selenium, selenium-webdriver, web-scraping, webdriver

我正在使用 Selenium 2.0、Firefox 11.0 和 Java 来处理表。我有一个由 td 单元组成的 table 元素，其中一些包含 span 元素中包含的文本，另一些包含在其 value 属性中具有文本的 input 元素。我的目标是获取每个单元格的文本，以便输出表格内容并将它们与预期值进行比较。我以为我会做这样的事情：

```
Locate the table WebElement by id
List<WebElement> cells = tableElem.findElements(By.xpath(".//td")); 
```

然后我将遍历所有单元格并使用 xpath ".//input" 运行 findElements，如果列表为空，我将在 webElement 上运行 getText，如果列表不为空，我将在输入元素上运行 getAttribute .

但令我惊讶的是，这需要几分钟才能在 firefox 上运行（我害怕在 IE 上尝试它，这是它应该被测试的地方）。当我调试时，很明显瓶颈是来自 td 的 .//input 搜索，这正在杀死我。它超过十秒，因此即使只有几个细胞，我的测试也需要永远进行。我已经尝试了 xpath 的各种细微变化，尝试使用 css 选择器，并继续获得相同的结果。

我想要一些关于如何以不同方式解决这个问题或如何优化我当前方法的建议。我希望这只需要几秒钟。

我已经包含了一些示例代码，应该可以说明我正在经历的减速。这不是我正在抓取屏幕的网站，但速度是一样的：

```
 webDriver.navigate().to("https://accounts.google.com/NewAccount");
    List<WebElement> TDxpath = webDriver.findElements(By.xpath("//td"));
    List<WebElement> TDcss = webDriver.findElements(By.cssSelector("td"));
    for (WebElement td : TDcss) {
        List<WebElement> q = td.findElements(By.cssSelector("input"));
    }
    for (WebElement td : TDxpath) {
        List<WebElement> r = td.findElements(By.xpath(".//input"));
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:49:54.840

你真的需要浏览器吗？你可以试试`HtmlUnitDriver`，速度会非常快！

或者您可以将其作为 JS 来执行，这也只需要一小部分时间，[您可以`Lists`从脚本](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html#executeScript%28java.lang.String,%20java.lang.Object...%29)中获取：

```
(JavascriptExecutor)driver.executeScript(
    "var tds = document.getElementsByTagName('td');"
    "for (var i = 0; i < tds.length; i++) {" +
    "   var inputs = tds[i].getElementsByTagName('input');" +
    "}"
    ); 
```

# eclipse - 亚行、三星 Epic 4G、Windows 7、Eclipse

> ID：10710557
> 
> 赞同：0
> 
> 时间：2012-05-22T21:38:12.610
> 
> 标签：eclipse, adb, galaxy

我在论坛上搜索了很多，大多数类似的问题似乎主要是 Windows XP 问题。

我正在使用最新版本的 Eclipse、Jdk、Android Sdk 和 Adt。我正在尝试在我的手机三星 Galaxy 4G/SII 上进行调试。

我从三星下载了驱动程序，它们似乎安装正常，但是安装程序完成后我的电脑蓝屏。

Adb 没有看到手机，也没有看到我妻子的 HTC Evo shift。adb 无法从命令行识别这两种设备，也不会出现在 Android 设备选择器中。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T22:48:11.287

您使用的是什么类型的操作系统？如果您使用的是 32 位操作系统的 Windows XP，您几乎无能为力，因为它不包含运行当前或最近的 SDK 工具所需的所有必要库。您可能需要安装一些补丁才能使其正常工作，有关运行 SDK 工具的更多解决方案，请参阅 XP 文档手册。我在我的 Windows 7 上安装了它，它运行良好。我只需要将我的三星手机连接到我的电脑，就可以直接调试。我宁愿建议你升级你的操作系统。

# jqgrid - 如何调用与工具栏编辑按钮相同的功能

> ID：10710558
> 
> 赞同：0
> 
> 时间：2012-05-22T21:38:13.750
> 
> 标签：jqgrid, jqgrid-asp.net

所以我在右键单击时创建了一个具有添加/编辑/删除行的上下文框。在显示对话框之前，我还启动了一堆代码。我的问题是，当我使用上下文菜单时，它不会通过某些代码。我试图直接调用函数，但格式不正确。

我主要关心编辑按钮，这是我用来调出编辑对话框的代码

```
 function editRow() {
     var grid = jQuery("#<%= Jqgrid1.ClientID %>");
     var rowKey = grid.getGridParam("selrow");
     if (rowKey) {
         // I have tried calling functions here and it still doesn't work
         grid.editGridRow(rowKey, grid.editDialogOptions);
     }
     else {
         alert("No rows are selected");
     }
 } 
```

因此，如果我使用它来显示编辑表单，它的格式不正确，也没有正确地完成所有功能。

我正在使用 Jqgrid 的 ASP Webforms 版本，所以我通过这样做来调用该函数

```
<cc1:JQGrid1 ID="Jqgrid1
 //other attributes

ClientSideEvents-BeforeEditDialogShown="ChangeMonitor" 

 //Rest of code /> 
```

所以这工作得很好，我试图让上下文菜单上的编辑按钮正确显示。

我的想法是一旦有人使用上下文菜单，就使用 Jquery 触发对实际编辑按钮的点击。但是，我找不到可以使用的 ID。

有没有一种简单的方法可以将我的上下文菜单编辑按钮与工具栏中的实际编辑按钮连接起来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T19:34:07.177

好吧，我找到了解决问题的方法。

按钮的 id 字段是 edit_ct100_cpMainContent_Jqgrid1_top 所以我只是用这段代码触发了一次点击。

```
$("td[id^=edit][id$=top]").trigger("click") 
```

出于某种原因，当我使用 _ct100_cpMainContent_Jqgrid1 时它不起作用，但现在它起作用了。希望这可以帮助某人。

# perl - 将 SQL 查询结果导出到 CSV 文件

> ID：10710563
> 
> 赞同：0
> 
> 时间：2012-05-22T21:38:33.220
> 
> 标签：perl

如何将 Oracle SQL 查询结果重定向到驱动器上的外部 CSV 文件，同时在 perl 中将它们打印到屏幕上

这是我打算做的

```
my $dbh =  DBI->connect('dbi:ODBC:Test2', 'XXX', 'XXXX') || die ("Connection Failed      \n");
$sql="select a,b from xxx";
my $sth = $dbh->prepare($sql);
$sth->execute();
my $dat; 
```

while( $dat = $sth->fetchrow_hashref() ){ print ("$dat->{a}",print ("$dat->{b}" ***这里我在屏幕上看到结果 }

```
**My main challenge is to get the results into a csv file on my local disk -- Any   help    would be appreciated.....** 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:49:16.867

我会使用 CPAN 模块**Text::CSV**。该模块将处理所有 CSV 特定处理（例如引用）。

```
use Text::CSV;

my $csv = Text::CSV->new ( { binary => 1 } )  # should set binary attribute.
             or die "Cannot use CSV: ".Text::CSV->error_diag ();
open $fh, ">:encoding(utf8)", "my.csv"; 
```

. . .

```
while( $dat = $sth->fetchrow_hashref() ){ 
    print "$dat->{a} $dat->{b}\n";
    $csv->print ($fh, [ $dat->{a}, $dat->{b} ]);
} 
```

. . .

```
close $fh or die "Failed to write CSV: $!"; 
```

# perl - 匹配同一个词的不同实例

> ID：10710566
> 
> 赞同：1
> 
> 时间：2012-05-22T21:38:54.797
> 
> 标签：perl

如何匹配同一个单词的不同实例。

例如：如果字符串是协同的。如何将它与协同作用、协同作用、协同作用、协同作用相匹配。我可以写以下内容：

```
 while(<IN>)
 {
chomp $_;
my $line= $_;
$word="Synergy";
if($line=~m/$word(\w+)/i)
{
     $line=~s/$word/<Effect>$word<\/Effect>/ig;
}
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T07:41:15.800

您可能想要做的事情称为词干提取。但是，要使此功能起作用，您必须将文本中的所有单词加上您搜索的单词进行词干化。希望您列出的所有单词都产生相同的词干。我还没有测试过。

```
use Lingua::Stem;
my $stemmer = Lingua::Stem->new( -locale => 'EN-UK' );

# first convert text to list of words
my @words;
while(<IN>) {
    push @words, split(/\b/, $_); # you can do better here
}
# now stem all words.
my $stemmed_words = $stemmer->stem(@words);
# results in an array ref of stems in the same order as the words have been.

# now stem your search
my $stemmed_search = $stemmer->stem($word);

# and do the search from above inside stemmed array. 
```

现在这取决于你想要什么。如果您想用某些东西交换所有这些单词，您必须获取匹配（词干）单词的索引并在文本中的相同位置进行替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:53:03.050

您可能想查看 Text::Soundex。例如，

```
use Text::Soundex;

# The following all return S562
print soundex("synergizes"), "\n";
print soundex("synergism"), "\n";
print soundex("synergically"), "\n";
print soundex("synergistic"), "\n"; 
```

进一步阅读：[Perldoc Text::Soundex](http://perldoc.perl.org/Text/Soundex.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:45:40.440

您将要使用正则表达式。目前尚不清楚您想要匹配的确切标准，但在您的示例中，所有单词都以“synergi”开头，因此`if($string =~ \bsynergi\w*\b)`会在其中的任何位置找到包含“synergi”的所有行。

# java - 自定义按钮大小不正确？

> ID：10710573
> 
> 赞同：1
> 
> 时间：2012-05-22T21:39:13.967
> 
> 标签：java, jcomponent

首先，是的，我知道我是新手，这是我第一次尝试制作自定义组件。

好的，所以在我的项目中，我正在尝试制作一个执行三件事的自定义按钮：

1.  绘制背景
2.  获取所选应用的图标
3.  在按钮中绘制应用程序的名称。

它可以做到所有这三个，除了按钮*很小*：

![图片](../Images/747c7b5b65a3bfdc01c3625197272658.png)

图标是 Jar 应用程序，名称是“测试应用程序”。

这是我的班级 AppButton 中的 paintComponent(Graphics) 方法：

```
@Override
public void paintComponent(Graphics g) {
    super.paintComponent(g);

    Graphics2D antiAlias = (Graphics2D) g;
    antiAlias.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);

    g.setColor(Color.blue);
    //g.fillRoundRect(x, y, width, height, arcWidth, arcHeight);
    g.fillRoundRect(this.getX(), this.getY(), this.getWidth(), this.getHeight() - 25, 20, 20);
    g.setColor(Color.red);

    FontMetrics metrics = g.getFontMetrics();
    int widthOfAppName = metrics.stringWidth(this.appName);
    g.drawString(this.appName, this.getWidth() / 2 - (widthOfAppName / 2), this.getHeight() - 10);

    File refrenceFile = new File(this.appURL);
    try {
        if (refrenceFile.exists()) {
            ShellFolder sf = ShellFolder.getShellFolder(refrenceFile);
            this.appIcon = new ImageIcon(sf.getIcon(true));
            g.drawImage(this.appIcon.getImage(), this.getWidth() / 2 - (this.appIcon.getIconWidth() / 2),
                    this.getHeight() / 2 - (this.appIcon.getIconHeight() / 2), JLaunch.theFrame);
    //Draw the centered Image
        } else {
            ImageIcon noImageFound = getNoImageAvailable();
            //g.drawImage(img, x, y, observer)
            g.drawImage(noImageFound.getImage(), this.getWidth() / 2 - (noImageFound.getIconWidth() / 2),
                    this.getHeight() / 2 - (noImageFound.getIconHeight() / 2), JLaunch.theFrame);
    //Draw the centered Image
        }

    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

附带说明一下，如果有人对自定义 Swing 组件有很好的了解，您能否像您一样向我指出一个好的教程或学习它的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:55:08.167

好吧，一方面，JButton 可以绘制图像。但是您可能正在寻找的是`JComponent.setPreferedSize()`您可以在此处查看文档：[http://docs.oracle.com/javase/6/docs/api/javax/swing/JComponent.html#setPreferredSize(java.awt.Dimension)](http://docs.oracle.com/javase/6/docs/api/javax/swing/JComponent.html#setPreferredSize(java.awt.Dimension)) .

# c# - 如何使用 C# Facebook SDK 6.0.10.0 在用户墙上发布

> ID：10710576
> 
> 赞同：2
> 
> 时间：2012-05-22T21:39:22.437
> 
> 标签：c#, asp.net-mvc, facebook, facebook-graph-api, facebook-opengraph

很难找到最新 SDK 的文档。我有一个应用程序，用户登录后同意授予该应用程序在他们的墙上发布的权限。

现在我有了应用程序的访问令牌，我想在用户的墙上发布和条目。似乎是一个简单的操作，但我找不到任何示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T21:46:03.340

您可以使用[Facebook C# SDK](http://csharpsdk.org/)。这是[一篇文章](http://blog.yaplex.com/facebook/facebook-c-sdk-how-to-post-on-wall/)，说明了如何在用户的墙上发帖：

```
dynamic messagePost = new ExpandoObject();
messagePost.picture = "http://yaplex.com/uploads/yaplex-logo-with-text-small.png";
messagePost.link = "http://yaplex.com/";
messagePost.name = "[name] Facebook name...";

// "{*actor*} " + "posted news..."; //<---{*actor*} is the user (i.e.: Alex)
messagePost.caption = " Facebook caption";
messagePost.description = "[description] Facebook description...";
messagePost.message = "[message] Facebook message...";

string acccessToken = "xxxx5120330xxxx|4xxxxx0c0f95bd3f62dxxxxx.1-10000xx4x73xxxx|2xx5xxx0566xxxx|z2xxxx37dxxxxsdDS23s_Sah34a";
FacebookClient appp = new FacebookClient(acccessToken);
try
{
    var postId = appp.Post("24351740xxxxxx" + "/feed", messagePost);
}
catch (FacebookOAuthException ex)
{
    //handle oauth exception
}
catch (FacebookApiException ex)
{
    //handle facebook exception
} 
```

# java - 覆盖哈希码和等于的问题

> ID：10710577
> 
> 赞同：1
> 
> 时间：2012-05-22T21:39:34.277
> 
> 标签：java, overriding, hashcode

我想创建一个将字符串列表作为输入的类。我想覆盖此类的哈希码和等于，以便当发送的字符串列表相等时，无论它们的顺序如何，此类将始终返回 true。

这是代码：

```
public final class TableValues
{
    private final String[] tableValue;

    TableValues(final String[] values)
    {
        this.tableValue = values;
    }

    /**
     * @see java.lang.Object#hashCode()
     */
    @Override
    public int hashCode()
    {
        final int prime = 31;
        int result = 1;
        result = prime * result + Arrays.hashCode(tableValue);
        return result;
    }

    /**
     * @see java.lang.Object#equals(java.lang.Object)
     */
    @Override
    public boolean equals(final Object obj)
    {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (getClass() != obj.getClass())
            return false;
        final TableValues other = (TableValues) obj;
        if (!Arrays.equals(tableValue, other.tableValue))
            return false;
        return true;
    }
} 
```

但是当我这样做时：

```
final String[] str1 = {"A", "B", "C"};
final String[] str2 = {"B", "C", "A"};
final TableValues tab1 = new TableValues(str1);
final TableValues tab2 = new TableValues(str2);
if (tab1.equals(tab2))
{
    System.out.println("Equal");
}
else
{
    System.out.println("Not Equal");
} 
```

它总是打印不等于。这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:42:18.507

这两个`TableValues`实例不相等，因为数组不相等。这是因为数组中元素的顺序很重要。如果您想要对顺序不敏感的匹配，则必须将其添加到您的代码中，以便它将两个具有相同内容但顺序不同的数组视为相同*，或者*`Set`在顺序不重要的情况下使用字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:47:30.297

尝试改变：

```
if (!Arrays.equals(tableValue, other.tableValue))
        return false; 
```

至 ：

```
if (!Arrays.equals(Arrays.sort(tableValue), Arrays.sort(other.tableValue)))
        return false; 
```

从 Arrays.equals 的文档中：

> 如果两个数组以相同的顺序包含相同的元素，则它们相等。

由于无论顺序如何，您都需要它们相等，因此您必须先对它们进行排序`Arrays.equal`才能认为它们相等。

# javascript - 在画布中制作可点击区域以更改图像

> ID：10710579
> 
> 赞同：3
> 
> 时间：2012-05-22T21:39:36.137
> 
> 标签：javascript, html, canvas, html5-canvas

请帮我：

*   在下面的画布中创建可点击区域，我可以将 onmousedown= 事件分配给。我知道如何用不可见的 DIV 做到这一点，但我认为有一种更优雅的方式可以在我不知道的画布中做到这一点。

*   当我单击其中一个区域时，想要将图像名称传递给函数，以便它将显示的图像更改为另一个图像，然后将其更改回 onmouseup。

如果你只给我看一个区域和一个 mousedown/mouseup 示例，我可以做剩下的……谢谢。

```
<!DOCTYPE HTML>
<html>
<head>
</head>
<body>

        <canvas id="myCanvas" width="506" height="319" style="border:1px solid #c3c3c3;">
        Your browser does not support the canvas element.
        </canvas>

        <script type="text/javascript">
        var c=document.getElementById("myCanvas");
        var ctx=c.getContext("2d");
        var img=new Image();
        img.onload = function(){
        ctx.drawImage(img,0,0);
        };
        img.src="firstImage.gif";
        </script>

        /////////HERE NEED/////////
                    CREATE CLICKABLE REGION <region>
                    <region>
                    onmousedown=changeCanvasImage(secondImage.gif) //change image on click
                    onmouseup=changeCanvasImage(firstImage.gif)  /change it back when done
        </region>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T00:27:09.753

画布元素可以触发事件，但画布中的图形元素不能。为此，您需要自己实现它，方法是在单击鼠标时检测[鼠标在画布上的位置](https://stackoverflow.com/questions/55677/how-do-i-get-the-coordinates-of-a-mouse-click-on-a-canvas-element)并将值与画布中的某些内容相关联，或者使用许多可用的[画布库](https://stackoverflow.com/questions/3474608/what-is-the-current-state-of-the-art-in-html-canvas-javascript-libraries-and-fra)之一来处理检测为你。

# eventbrite - Eventbrite API 中参加者的 id、ticket_id 和条形码有什么区别？

> ID：10710581
> 
> 赞同：1
> 
> 时间：2012-05-22T21:39:44.980
> 
> 标签：eventbrite

我正在查看文档[http://developer.eventbrite.com/doc/attendees/](http://developer.eventbrite.com/doc/attendees/)。

首先，返回的 json 中的实际“id”字段似乎代表与会者记录 ID，因为存在实际的“event_id”字段。似乎是文档问题。

我需要一个可以用作标识符的字段，以将 Eventbrite 与会者与我的记录同步。'id' 字段是明显的候选者。我可以依靠 'id' 在整个 API 中是唯一的，还是可以在事件之间重用它？

'id' 和 'ticket_id' 有什么关系？具有不同 ID 的多个与会者可以具有相同的“ticket_id”吗？

“id”和“barcode”有什么关系？一位与会者可以有多个条形码？

希望得到澄清。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T20:02:01.817

好问题，我会用一些额外的信息更新文档。

简短的回答：

*   ticket_id 是特定门票类型（普通门票、VIP 等）的 ID。用户可以以给定的顺序购买多种类型的多张票。为每张购买的票创建一个“参加者”记录。
*   Attendee_id 旨在识别用户和事件上下文中的票证类型之间的映射。对于每张票，用户的参加者 ID 会有所不同。
*   每个参加者 ID 应该有一个barcode_id。条形码值可用于检查参加者进出活动。

希望有帮助！@RyanJ

# python - 在 django 中为不同用户从模板生成里程碑截止日期的最佳方法

> ID：10710582
> 
> 赞同：0
> 
> 时间：2012-05-22T21:39:45.963
> 
> 标签：python, django

我想生成完成某事的各种里程碑的列表，每个里程碑的截止日期都是根据用户给出的最终日期动态计算的。

我不确定处理这个问题的最佳方法。我想到的第一个想法是在服务器上编写一些~~模板~~（这里不是 django 模板）文件，其中包含生成所有步骤所需的信息，每个新用户都会获取一次，并用于创建一个列表里程碑类的里程碑对象（django 中的一些通用模型）。也许用 json 写的东西：

```
{"some_step":
  {
  "start_date" = "final_date-10",
  "end_date" = "final_date-7",
  }
} 
```

和对应的型号

```
class Milestone(models.Model):
    name = models.Charfield()
    start_date = models.DateField()
    end_date = models.DateField()

    def time_to_final(self,time):
        return self.final_date-time 
```

在为数据库中的新用户初始化数据时，诸如“finaldate-10”之类的字符串将被一些例程转换并在注册时传递给 time_to_final 方法。

但是我不确定这是最好的方法。虽然它不会被数百万人使用，但我担心可能会对服务器性能产生负面影响？有没有更好的，也许更蟒蛇的方式？

**编辑以获取更多说明：**

用户想要在日期 D0 完成某事。

我的应用程序生成如下步骤：

*   从日期 D1i 到日期 D1f 执行步骤 1
*   从日期 D2i 到日期 D2f 执行步骤 2 -...
*   直到到达日期 D0 并且所有任务都已完成

所有日期都是在提供 D0 时计算的。所有步骤都是为每个用户生成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:22:34.680

模板与此有什么关系？首先设计您的模型-也许您需要一个`Steps`具有外键`User`和外键的模型`Milestone`（或者可能没有-我从您的描述中不清楚）。

只有当您清楚地了解数据时，才开始考虑模板等。

django 的伟大之处在于，一旦您制作了模型，您就可以使用管理界面输入一些数据。很快就会清楚你是否正确地模拟了你的问题。

不要担心性能，让你的数据结构清晰，让它工作，如果你发现它运行得不够快（不太可能）优化它。

# c++ - 带有 if 语句的指针（地址）

> ID：10710586
> 
> 赞同：0
> 
> 时间：2012-05-22T21:40:05.447
> 
> 标签：c++, pointers, reference, pointer-address

我有一个工作代码，它给了我一个网格的地址（如果我是正确的）：

```
MyMesh &mesh = glWidget->mesh(); 
```

现在我想 if thingie 分配不同的网格地址。一个是mesh()第一个函数和另一个函数mesh(int)：这是怎么做的？

```
 MyMesh &mesh;  //error here: need to be initialized

 if(meshNum==0){
mesh = glWidget->mesh();
 }
 else if (meshNum==1){
mesh = glWidget->mesh(0);
 }
 else{
  return;
 }

 //mesh used in functions...
 function(mesh,...); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:43:21.203

引用*必须*在初始化时绑定到对象……您不能有默认初始化或零初始化的引用。所以代码如下：

```
MyMesh &mesh; 
```

其中`mesh`是对对象的非常量左值引用`Mesh`，本质上是格式错误的。在声明点，您必须将非常量引用绑定到有效的内存可寻址对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T21:44:12.340

如果您的案例足够简单`meshNum`且受到限制，则可以使用`?:`运算符：

```
MyMesh &mesh = (meshNum == 0) ? glWidget->mesh() : glWidget->mesh(0); 
```

否则，您需要一个指针，因为**必须**在定义点初始化引用，并且不能重新定位以引用其他任何内容。

```
MyMesh *mesh = 0;
if( meshNum == 0 ) {
    mesh = &glWidget->mesh();
} else if ( meshNum == 1 ){
    mesh = &glWidget->mesh(0);
}

function( *mesh, ... ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T21:44:28.960

引用在表现良好的程序中始终有效，所以不，你不能这样做。但是，为什么不只是：

```
if(meshNum != 0 && meshNum != 1)
    return;
function((meshNum == 0) ? glWidget->mesh() : glWidget->mesh(0)); 
```

或者你可以只使用一个指针并在以后尊重它：

```
MyMesh *mesh = 0;
if(meshNum==0) {
    mesh = &glWidget->mesh();
}
else if (meshNum==1) {
    mesh = &glWidget->mesh(0);
}
else {
  return;
}

function(*mesh); 
```

# perl - 缓存和避免 Cache Stampedes - 多个同时计算

> ID：10710587
> 
> 赞同：7
> 
> 时间：2012-05-22T21:40:07.133
> 
> 标签：perl, caching

我们想要缓存一个非常昂贵的计算。所以我们做类似的事情：

```
my $result = $cache->get( $key );

unless ($result) {
    $result = calculate( $key );
    $cache->set( $key, $result, '10 minutes' );
}

return $result; 
```

现在，在`calculate($key)`我们将结果存储到缓存中之前，其他几个请求进来了，它们也开始运行`calculate($key)`，并且系统性能受到影响，因为许多进程都在计算相同的东西。

想法：让我们在缓存中放置一个正在计算一个值的标志，所以其他请求只是等待那个计算完成，所以他们都使用它。就像是：

```
my $result = $cache->get( $key );

if ($result) {
    while ($result =~ /Wait, \d+ is running calculate../) {
        sleep 0.5;
        $result = $cache->get( $key );
    }
} else {
    $cache->set( $key, "Wait, $$ is running calculate()", '10 minutes' );
    $result = calculate( $key );
    $cache->set( $key, $result, '10 minutes' );
}

return $result; 
```

现在，这开辟了一个全新的蠕虫罐头。如果 $$ 在设置缓存之前死了怎么办。如果，如果...所有这些都是可以解决的，但是由于[CPAN](http://search.cpan.org/search?m=all&q=cache)中没有任何东西可以做到这一点（CPAN 中的*所有东西都有*），我开始想知道：

有更好的方法吗？是否有特殊原因，例如 Perl`Cache`和`Cache::Cache`类不提供这样的机制？有没有我可以使用的经过验证的真实模式？

理想的情况是一个 CPAN 模块，它的 debian 包已经处于挤压状态或 eureka 时刻，在那里我看到了我的方式的错误...... :-)

编辑：我已经知道这被称为[缓存踩踏](https://en.wikipedia.org/wiki/Cache_stampede)，并更新了问题的标题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:43:33.030

`flock()`它。

由于您的工作进程都在同一个系统上，您可能可以使用良好的老式文件锁定来序列化昂贵的`calculate()`离子。作为奖励，这种技术出现在几个核心文档中。

```
use Fcntl qw(:DEFAULT :flock);    # warning:  this code not tested

use constant LOCKFILE => 'you/customize/this/please';

my $result = $cache->get( $key );

unless ($result) {
    # Get an exclusive lock
    my $lock;
    sysopen($lock, LOCKFILE, O_WRONLY|O_CREAT) or die;
    flock($lock, LOCK_EX) or die;

    # Did someone update the cache while we were waiting?
    $result = $cache->get( $key );

    unless ($result) {
        $result = calculate( $key );
        $cache->set( $key, $result, '10 minutes' );
    }

    # Exclusive lock released here as $lock goes out of scope
}

return $result; 
```

好处：工人死亡会立即释放`$lock`。

风险：LOCK_EX 可以永远阻塞，而且是很长的时间。避免 SIGSTOPs，也许对`alarm()`.

扩展：如果您不想序列化所有`calculate()`调用，而只是对相同`$key`或某组键的所有调用，则您的工作人员可以`flock()` `/some/lockfile.$key_or_a_hash_of_the_key`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T23:53:36.080

使用锁？或者这可能是一个矫枉过正？或者如果可能的话，离线预先计算结果然后在线使用？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T13:40:27.957

尽管对于您的用例可能（或可能不会）过度杀伤，但您是否考虑过使用消息队列进行处理？ [RabbitMQ](http://www.rabbitmq.com/)目前似乎是 Perl 社区中的一个流行选择，并且通过[AnyEvent::RabbitMQ](https://metacpan.org/module/AnyEvent%3a%3aRabbitMQ)模块得到支持。

在这种情况下，基本策略是在需要`calculate`新密钥时向消息队列提交请求。如果这是您可以可靠处理的全部，则队列可以一次设置为`calculate`一个键（按请求的顺序）。或者，如果您可以安全地同时计算多个密钥，队列也可以用于合并对同一密钥的多个请求，计算一次并将结果返回给请求该密钥的所有客户端。

当然，这会增加一些复杂性，并且 AnyEvent 需要一种与您可能习惯的编程风格有些不同的编程风格（我会提供一个示例，但我自己从未真正掌握它），但它可能会提供在效率和可靠性方面获得足够的收益，以使这些成本物有所值。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-28T07:12:23.320

我普遍同意上述pilcrow的方法。我要添加一件事：调查`memoize()`函数的使用以潜在地加速`calculate()`代码中的操作。

有关详细信息，请参阅[http://perldoc.perl.org/Memoize.html](http://perldoc.perl.org/Memoize.html)

# python - 在 django 中记录格式化程序

> ID：10710591
> 
> 赞同：15
> 
> 时间：2012-05-22T21:40:52.890
> 
> 标签：python, django, logging

来自[Django 文档](https://docs.djangoproject.com/en/1.7/topics/logging/#examples)，这里是日志记录的示例格式：

```
'formatters': {
    'verbose': {
        'format': '%(levelname)s %(asctime)s %(module)s: %(message)s'
    }
} 
```

这会打印出类似的内容：

> 错误 2012-05-22 14:33:07,261 意见 42892 4398727168 你好

是否有可以包含在字符串格式中的项目列表？例如，我希望能够看到正在创建消息的函数和应用程序，例如：

> 错误时间 myproject.myapp.views.login_function 消息

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2014-10-09T10:58:11.737

从[Python 日志记录模块文档](http://docs.python.org/library/logging.html#logrecord-attributes)：

*   **asctime**：创建`%(asctime)s`
    时的人类可读时间[`LogRecord`](https://docs.python.org/2/library/logging.html#logging.LogRecord)。默认情况下，格式为“2003-07-08 16:49:45,896”（逗号后面的数字是时间的毫秒部分）。

*   **created**：创建`%(created)f`
    的时间[`LogRecord`](https://docs.python.org/2/library/logging.html#logging.LogRecord)（由 返回[`time.time()`](https://docs.python.org/2/library/time.html#time.time)）。

*   **文件名**：**路径名**`%(filename)s`
    的文件 名部分。

***   **funcName**：`%(funcName)s`
    包含日志调用的函数的名称。

    *   **levelname**：`%(levelname)s` 消息的文本记录级别（'DEBUG'、'INFO'、'WARNING'、'ERROR'、'CRITICAL'）。

    *   **levelno**：`%(levelno)s`
    消息的数字日志记录级别（DEBUG、INFO、WARNING、ERROR、CRITICAL）。

    *   **lineno**：`%(lineno)d`
    发出记录调用的源行号（如果可用）。

    *   **模块**：模块（**文件名**`%(module)s`
    的名称部分）。

    ***   **msecs**：创建`%(msecs)d`
    时间的毫秒部分。[`LogRecord`](https://docs.python.org/2/library/logging.html#logging.LogRecord)

    *   **message**：`%(message)s`
    记录的消息，计算为`msg % args`。这是在[`Formatter.format()`](https://docs.python.org/2/library/logging.html#logging.Formatter.format)调用时设置的。

    *   **name**：`%(name)s`
    用于记录呼叫的记录器的名称。

    *   **pathname**：`%(pathname)s`
    发出日志调用的源文件的完整路径名（如果可用）。

    *   **process**：`%(process)d`
    进程 ID（如果可用）。

    *   **processName**：`%(processName)s`
    进程名称（如果可用）。

    *   **relativeCreated**：创建`%(relativeCreated)d`
    时间（以毫秒为单位[`LogRecord`](https://docs.python.org/2/library/logging.html#logging.LogRecord)），相对于加载日志模块的时间。

    *   **thread** :`%(thread)d`
    线程 ID（如果可用）。

    *   **threadName**：`%(threadName)s`
    线程名称（如果可用）。**** 

 ****以下参数也可用于[`Formatter.format()`](https://docs.python.org/2/library/logging.html#logging.Formatter.format)，尽管它们不打算包含在格式字符串中：

*   **args**：
    参数元组合并到**msg**中以产生消息。

*   **exc_info** :
    异常元组 (à la [`sys.exc_info`](https://docs.python.org/2/library/sys.html#sys.exc_info)) 或者，如果没有发生异常，`None`.

*   **msg**：
    在原始日志记录调用中传递的格式字符串。**与args**合并以生成消息或任意对象（请参阅[将任意对象用作消息](https://docs.python.org/2/howto/logging.html#arbitrary-object-messages)）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-22T21:41:39.410

[http://docs.python.org/library/logging.html#logrecord-attributes](http://docs.python.org/library/logging.html#logrecord-attributes)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-15T07:06:54.637

第1步。编辑你的 settings.py 文件

```
$ cd mysite
$ vim mysite/settings.py
'formatters': {
    'simple': {
        'format': '%(levelname)s %(asctime)s %(name)s.%(funcName)s:%(lineno)s- %(message)s'
    },
}, 
```

第2步。您应该像这样在编码中使用记录器：

```
import logging
logger = logging.getLogger(__name__)

def fn1() {
    logger.info('great!')
    logger.info(__name__)
} 
```

希望对你有帮助！****

# jquery - MVC3中的jQuery结果缓存

> ID：10710594
> 
> 赞同：0
> 
> 时间：2012-05-22T21:40:58.553
> 
> 标签：jquery, ajax, caching, call

我正在开发一个 mvc3 应用程序，其中有 3 个控制器方法返回 3 个 json 结果。我使用 jquery ajax 调用来获取 3 个结果，然后将其附加到页眉部分视图中的 3 个 div。我的应用程序中有 50 个页面，所有页面都在内部调用标题部分视图。当每个页面调用部分视图时，jquery 从 3 个控制器获取数据并绑定到一个 div。它的操作非常繁重，我在这里寻找一些缓存机制。有人可以帮我吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T11:48:28.997

```
$(document).ready(function () {

        // Below code is for all $.get, $.ajax globally declared.
        $.ajaxSetup({ cache: false });

        //========= Or ================//

        //Below code is for particulat jquery ajax.
        $.ajax({
            url: 'your_URL', type: 'Get',
            cache: false,
            success: function (data) {

            }
        });
    }); 
```

# php - 借助 phpDocumentor，在 IDE 中自动完成的正确语法？

> ID：10710596
> 
> 赞同：0
> 
> 时间：2012-05-22T21:41:02.797
> 
> 标签：php, netbeans, autocomplete, symfony, phpdoc

我在 NetBeans 的自动完成功能中遇到了一些问题。我将 NetBeans 用于 Symfony2 PHP 项目，而 phpDocumentor 主要用于自动完成功能（不用于生成文档）。

这些（或基本相同）之间的正确语法是什么？

## 完全限定的类名：

```
class MyClass
{

    /**
     * @param \MyCompany\MyBundle\Entity\User $user
     * @return string
     */
    public function myFunction(\MyCompany\MyBundle\Entity\User $user) { }

} 
```

## 班级名称：

```
use \MyCompany\MyBundle\Entity\User;

class MyClass
{

    /**
     * @param User $user
     * @return string
     */
    public function myFunction(User $user) { }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:55:58.280

从技术上讲，它们都是正确的。

Zend Studio (Eclipse) 不会生成自动完成，除非目标类是当前项目的构建路径的一部分。也许 NetBeans 有类似的东西？

你到底有什么问题？

## 编辑

仅供参考，您*确实*需要使用 FQCN 作为返回值，即使正确的命名空间已经在使用中。例如，如果`MyClass::myFunction()`返回一个**User**，你会想要这样做

```
use \MyCompany\MyBundle\Entity\User;

class MyClass
{

    /**
     * @param User $user
     *
     * @return \MyCompany\MyBundle\Entity\User
     */
    public function myFunction(User $user) { }

} 
```

# c - 互斥（锁）的所有权是如何实现的？

> ID：10710599
> 
> 赞同：4
> 
> 时间：2012-05-22T21:41:08.740
> 
> 标签：c, multithreading, locking, mutex

尝试在 C 中实现一个非常简单的互斥体（锁）时我有点困惑。我知道互斥体类似于二进制信号量，除了互斥体还强制释放锁的线程必须是最近获得它的同一线程。我对如何跟踪所有权感到困惑？

这就是我到目前为止所拥有的。请记住，它还没有完成，并且应该非常简单（单处理器，互斥体上没有递归，禁用中断作为互斥方法等）。

```
struct mutex {
    char *mutexName;
    volatile int inUse;
}; 
```

我相信我应该添加另一个成员变量，即 whoIsOwner，但我对在那里存储的内容有点困惑。我认为它必须是可以唯一标识尝试调用锁的线程的东西？它是否正确？

我有一个线程结构，它有一个“char *threadName”成员变量（以及其他变量），但我不确定如何从互斥锁实现中访问它。

任何指针/提示/想法将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T21:46:26.973

您可以将互斥锁实现为一个原子整数，`0`当它被解锁时，它采用锁定线程 ID 的值来指示它已被锁定。当然，对变量的访问必须是原子的，并且需要适当地围起来以防止重新排序（获取-释放围栅对就足够了）。

归根结底，你当然永远不能阻止*自己*在脚上开枪。如果你真的想要，你可以从另一个线程强制覆盖互斥锁的内存，或者类似的东西。只有正确使用工具，才能获得正确的行为。考虑到这一点，您可能会对锁定变量的简单布尔值感到满意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T21:47:17.333

```
uint32_t  semOwner; 
```

如果上面的字段为 0，那么它是可用的。如果它是“拥有的”，那么让它设置为拥有任务的 ID，或线程，或进程 ID/线程 ID 组合（或其他可能适合您系统的组合）。

希望这可以帮助。

# haskell - 垃圾收集器如何找出堆栈中的对象引用？

> ID：10710603
> 
> 赞同：28
> 
> 时间：2012-05-22T21:41:59.237
> 
> 标签：haskell, garbage-collection, go

在像 Haskell 或 Go 这样具有自动垃圾收集的语言中，垃圾收集器如何找出存储在堆栈中的哪些值是指向内存的指针，哪些只是数字？如果垃圾收集器只是扫描堆栈并假定所有地址都是对对象的引用，那么很多对象可能会被错误地标记为可达。

显然，可以在每个堆栈帧的顶部添加一个值来描述有多少下一个值是指针，但这不会花费很多性能吗？

现实中是如何做到的？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-22T22:08:41.067

一些收集器假设堆栈上的所有内容都是潜在指针（如 Boehm GC）。事实证明，这并不像人们想象的那么糟糕，但显然不是最理想的。更常见的是，在托管语言中，一些额外的标记信息会留在堆栈中，以帮助收集器找出指针的位置。

请记住，在大多数编译语言中，每次输入函数时堆栈帧的布局都是相同的，因此确保以正确的方式标记数据并不难。

“位图”方法是这样做的一种方式。位图的每一位对应于堆栈上的一个字。如果该位是 1，则堆栈上的位置是一个指针，如果它是 0，那么从收集器的角度来看，该位置只是一个数字（或类似的东西）。编写得非常出色的 GHC 运行时和调用约定对大多数函数使用单字布局，这样一些位会传达堆栈帧的大小，其余位用作位图。较大的栈帧需要多字结构，但思路是一样的。

关键是开销很低，因为布局信息是在编译时计算的，然后在每次调用函数时都包含在堆栈中。

更简单的方法是“指针优先”，其中所有指针都位于堆栈的开头。您只需要在指针之前包含一个长度，或者在它们之后包含一个特殊的“结束”字，以告诉哪些字是给定此布局的指针。

有趣的是，试图将这些管理信息放到堆栈上会产生许多与与 C 互操作相关的问题。例如，将高级语言编译为 C 是次优的，因为即使 C 是可移植的，也很难携带这种信息。优化为类 C 语言（GCC、LLVM）设计的编译器可能会重组堆栈框架，从而产生问题，因此 GHC LLVM 后端使用自己的“堆栈”而不是 LLVM 堆栈，这会导致一些优化。同样，需要仔细构建 C 代码和“托管”代码之间的边界，以免混淆 GC。

出于这个原因，当您在 JVM 上创建一个新线程时，您实际上创建了两个堆栈（一个用于 Java，一个用于 C）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-22T22:04:09.353

Haskell 堆栈在每个堆栈帧中使用单个内存字来描述（使用位图）该堆栈帧中的哪些值是指针，哪些不是。有关详细信息，请参阅GHC 评论中的“[堆栈布局”](http://hackage.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/Stack)文章和[“位图布局”](http://hackage.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/HeapObjects?redirectedfrom=Commentary/Rts/HeapObjects#Bitmaplayout)文章。

说句公道话，一个单词的记忆真的没有太多成本，考虑到所有的事情。您可以将其视为只是为每个方法添加一个变量；这并不是那么糟糕。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-05-22T22:12:56.180

存在的 GC 假设作为 GC 管理的某物的地址的每个位模式*实际上*都是一个指针（因此不要释放该某物）。这实际上可以很好地工作，因为调用指针通常大于小的常见整数，并且通常必须对齐。但是，是的，这可能会导致某些对象的收集被延迟。C 的 Boehm 收集器以这种方式工作，因为它是基于库的，因此不会从编译器获得任何特定帮助。

还有一些 GC 与它们所使用的语言更紧密地耦合，并且实际上知道内存中对象的结构。我从未专门阅读过堆栈帧处理方面的内容，但如果编译器和 GC 旨在协同工作，您可以记录信息以帮助 GC。一个技巧是将所有指针引用放在一起，并使用每个堆栈帧一个字来记录有多少个，这并不是一个巨大的开销。如果您可以在不添加单词的情况下计算出每个堆栈帧对应的函数，那么您可以编译每个函数的“堆栈帧布局图”。另一种选择是使用标记词，您可以在其中设置低不是指向 1 的指针的单词的顺序位，指针永远不需要（由于地址对齐），因此您可以将它们区分开来。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-05-23T07:12:08.053

重要的是要认识到 GHC 维护自己的堆栈并且不使用 C 堆栈（FFI 调用除外）。没有可移植的方式来访问 C 堆栈的所有内容（例如，在 SPARC 中，其中一些内容隐藏在寄存器窗口中），因此 GHC 维护一个堆栈，它可以完全控制它。一旦您维护了自己的堆栈，您就可以选择任何方案来区分堆栈上的指针和非指针（例如使用位图）。

# php - PHP图像调整大小获取名称和路径

> ID：10710609
> 
> 赞同：0
> 
> 时间：2012-05-22T21:42:14.247
> 
> 标签：php, image, uploadify

我试图弄清楚将新调整大小的图像放在哪里。

```
function createFile($output_filename = null,$imageNewName) {
        if($this->ext == "JPG" OR $this->ext == "JPEG") {
            imageJPEG($this->dst_r, $this->uploaddir.$imageNewName.'.'.$this->ext, $this->quality);
        } elseif($this->ext == "PNG") {
            imagePNG($this->dst_r, $this->uploaddir.$imageNewName.'.'.$this->ext);
        } elseif($this->ext == "GIF") {
            imageGIF($this->dst_r, $this->uploaddir.$imageNewName.'.'.$this->ext);
        }
        $this->output = $this->uploaddir. $imageNewName;

        echo $this->uploaddir. $imageNewName .'.'.$this->ext;
}

function resize($newWidth, $newHeight) {
    $width = imagesx($this->img_r);
    $height = imagesy($this->img_r);

    $newWidth = $newWidth;
    $newHeight = $newHeight;

    $this->dst_r = ImageCreateTrueColor($newWidth, $newHeight);
    imagecopyresampled($this->dst_r, $this->img_r, 0, 0, 0, 0, $newWidth, $newHeight, $width, $height);
    $this->img_r = $this->dst_r;
    $this->img_h = $newHeight;
    $this->img_w = $newWidth;
}

    $tempFile = $_FILES['Filedata']['tmp_name'];
    $targetPath = $_SERVER['DOCUMENT_ROOT'] . $_REQUEST['folder'] . '/img/nonfb/';

$fileNameBase  = $_FILES['Filedata']['name'];
$extension = pathinfo($fileNameBase, PATHINFO_EXTENSION);   
$fileNameNEW = $imageNewName . '.' . $extension;

$targetFile =  str_replace('//','/',$targetPath) . $fileNameNEW;
echo 'TARGET=' . $targetFile;

move_uploaded_file ($tempFile, $targetFile);

$image = new Image();
$image->setFile($targetFile);
$image->setUploadDir($targetPath);
$image->resize(50,50);
$image->createFile(md5($tempFile,$fileNameNEW));
$image->flush() 
```

我可以告诉它以 dst_r 作为当前图像，将 img_r 作为资源图像，但我不确定如何在这些图像上使用**echo**来找出它们的值。我想要做的是找出它放置调整后的图像的位置，以便我可以重命名它。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:50:21.290

我假设这段代码驻留在一个类中。与`createFile`函数的第 9 行一样，该文件可能位于以下路径：

```
echo $this->uploaddir. $imageNewName .'.'.$this->ext; 
```

# python - 通过不使用通信的子进程捕获输出

> ID：10710611
> 
> 赞同：3
> 
> 时间：2012-05-22T21:42:23.327
> 
> 标签：python, subprocess, ipc

我正在使用子进程在 Python 脚本中调用外部程序。外部程序产生大量输出。我需要捕获这个程序的输出。当前的代码是这样的：

```
process = subprocess.Popen('cmd.exe', shell=False, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=None)
process.stdin.write('gams "indus89.gms"\r\n')
while process.poll() != None:
    line = process.stdout.readline()
    print line 
```

我收到此代码的错误是

> 该进程试图写入一个不存在的管道。

如果我使用以下代码：

```
process = subprocess.Popen('cmd.exe', shell=False, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=None)
process.stdin.write('gams "indus89.gms"\r\n')
o, e = process.communicate()
print o 
```

那么程序的输出不会被捕获。

我应该如何更改我的代码，以便在第三方程序运行时捕获它的输出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:58:55.353

波本是矫枉过正。

尝试：

```
output = subprocess.check_output('gams "indus89.gms"\r\n', shell=True) 
```

希望这将在您的环境中工作。

# c# - 如何在集成测试中使用 System.Net.Http.HttpClient 处理异步异常？

> ID：10710615
> 
> 赞同：9
> 
> 时间：2012-05-22T21:42:41.033
> 
> 标签：c#, unit-testing, asynchronous, dotnet-httpclient

我正在运行一套使用`System.Net.HttpClient`. 我们在这些测试中的大多数“行为”部分都使用这种通用格式：

```
// Arrange
// Do some stuff

// Act
var download = _client
    .GetStringAsync(testUrl)
    .Result;

// Assert
// Does "download" contain what I expected? 
```

但是，间歇性地运行这些测试会产生如下结果：

```
System.AggregateException : One or more errors occurred.
  ----> System.Threading.Tasks.TaskCanceledException : A task was canceled.
at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)
at System.Threading.Tasks.Task`1.get_Result() 
```

我意识到 using`HttpClient`是为了启动异步操作，并不适合我们总是告诉它等待的集成测试场景。所以这让我想到了两个有点相关的问题：

1.  使用`HttpWebRequest`/`HttpWebResponse`更适合这种情况吗？
2.  即使是这样，`HttpClient`处理异步启动的请求错误的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-21T19:09:22.013

正如之前的评论者所建议的那样，您的连接可能会超时。`_client.Timeout = timeoutInMilliseconds`您可以在进行 GetStringAsync 调用之前设置超时。但是，如果它当前是默认值（100 秒），那么我的猜测是，当这种情况发生时，您正在测试的远程服务器实际上已经关闭。

有关超时属性的更多信息，请访问：http: [//msdn.microsoft.com/en-us/library/system.net.http.httpclient.timeout.aspx](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient.timeout.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-14T21:24:04.157

`System.AggregateException`来自同步运行的任务中发生的异常。使用异步测试允许运行器（在我的例子中是 NUnit）分解任务并获取真正的异常。所以上面的代码应该是这样的：

```
[Test]
public async Task DownloadContainsWhatIExpected()
{
    // Arrange
    // Do some stuff

    // Act
    var download = await _client
        .GetStringAsync(testUrl);

    // Assert
    // Does "download" contain what I expected?
} 
```

在方法签名中使用`async Task`，然后`await`在异步调用中使用是执行这类测试的最佳方式。

# c++ - 选择后 OpenGL 选择不显示任何内容

> ID：10710619
> 
> 赞同：-1
> 
> 时间：2012-05-22T21:43:02.823
> 
> 标签：c++, qt, opengl, picking

所以我在一个显示列表中有 2 个立方体，我希望其中一个是可以选择的，这样我就可以改变他的颜色或类似的东西。

当我单击一个立方体时，屏幕变黑并且没有任何反应，控制台为我提供最近命中的输出，但屏幕变黑并且不显示任何内容。

这是我的 cpp 文件：

```
#include "glwidget.h"
#include <QDomDocument>
#include <QDebug>
#include <QFile>
#include <math.h>
#include <QString>
#include <stdlib.h>
GLWidget::GLWidget(QWidget *parent):QGLWidget(parent)
{

    camPosx = 0.0,  camPosy = 0.0,    camPosz = 1.0;
    camViewx = 0.0, camViewy = 0.0, camViewz = 0.0;
    camUpx = 0.0,   camUpy = 1.0,   camUpz = 0.0;
    camAngle = 0.0;
    camViewz = -cos(camAngle);
    camViewx = sin(camAngle);
    mode = 1;
    timer = new QTimer();
    connect( timer, SIGNAL(timeout()), this, SLOT(updateGL()) );
}

void GLWidget::initializeGL() {

    loadGLTextures();
    glEnable(GL_TEXTURE_2D);                            // Enable Texture Mapping
    glShadeModel(GL_SMOOTH);                            // Enable Smooth Shading
    glClearColor(0.0f, 0.0f, 0.0f, 0.5f);               // Black Background
    glClearDepth(1.0f);                                 // Depth Buffer Setup
    glEnable(GL_DEPTH_TEST);                            // Enables Depth Testing
    glDepthFunc(GL_LEQUAL);                             // The Type Of Depth Testing To Do
    glEnable(GL_LIGHT0);                                // Quick And Dirty Lighting (Assumes Light0 Is Set Up)
    glEnable(GL_LIGHTING);                              // Enable Lighting
    glEnable(GL_COLOR_MATERIAL);                        // Enable Material Coloring
    glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);  // Perspective Calculations
    buildLists(2);                                      // Creating displaylist #
    glLoadIdentity();

    timer->start(50);
}

void GLWidget::resizeGL(int width, int height) {

    //set viewport
    glViewport(0,0,width,height);

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();

    //set persepective
    //change the next line order to have a different perspective
    aspect_ratio=(GLdouble)width/(GLdouble)height;
    gluPerspective(45.0f, aspect_ratio, 0.1 , 100.0);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
}

void GLWidget::paintGL() {
    glEnable(GL_DEPTH_TEST);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glLoadIdentity();

    // store current matrix
    glMatrixMode( GL_MODELVIEW );
    glPushMatrix( );

    gluLookAt(camPosx ,camPosy ,camPosz,
              camPosx + camViewx,camViewy,camPosz + camViewz,
              camUpx, camUpy, camUpz );

    if (mode == 2) {
        startPicking();
    }

    glColor3f(1.0f,0.0f,0.0f);
    glCallList(displayList[0]);
    glTranslatef(5.0,0.0,0.0);
    glColor3f(0.0f,1.0f,1.0f);
    glCallList(displayList[0]);

    if (mode == 2)
        stopPicking();
    //    glEnable( GL_LIGHTING );
    //    glEnable( GL_LIGHT0 );
    //    glScalef(10.0,10.0,10.0);
    //    glBindTexture(GL_TEXTURE_2D, texture[0]);
    //    glBegin(GL_QUADS);
    //    // Front Face
    //    glTexCoord2f(0.0f, 0.0f); glVertex3f(-1.0f, -1.0f,  1.0f);  // Bottom Left Of The Texture and Quad
    //    glTexCoord2f(1.0f, 0.0f); glVertex3f( 1.0f, -1.0f,  1.0f);  // Bottom Right Of The Texture and Quad
    //    glTexCoord2f(1.0f, 1.0f); glVertex3f( 1.0f,  1.0f,  1.0f);  // Top Right Of The Texture and Quad
    //    glTexCoord2f(0.0f, 1.0f); glVertex3f(-1.0f,  1.0f,  1.0f);  // Top Left Of The Texture and Quad
    //    // Back Face
    //    glTexCoord2f(1.0f, 0.0f); glVertex3f(-1.0f, -1.0f, -1.0f);  // Bottom Right Of The Texture and Quad
    //    glTexCoord2f(1.0f, 1.0f); glVertex3f(-1.0f,  1.0f, -1.0f);  // Top Right Of The Texture and Quad
    //    glTexCoord2f(0.0f, 1.0f); glVertex3f( 1.0f,  1.0f, -1.0f);  // Top Left Of The Texture and Quad
    //    glTexCoord2f(0.0f, 0.0f); glVertex3f( 1.0f, -1.0f, -1.0f);  // Bottom Left Of The Texture and Quad
    //    // Top Face
    //    glTexCoord2f(0.0f, 1.0f); glVertex3f(-1.0f,  1.0f, -1.0f);  // Top Left Of The Texture and Quad
    //    glTexCoord2f(0.0f, 0.0f); glVertex3f(-1.0f,  1.0f,  1.0f);  // Bottom Left Of The Texture and Quad
    //    glTexCoord2f(1.0f, 0.0f); glVertex3f( 1.0f,  1.0f,  1.0f);  // Bottom Right Of The Texture and Quad
    //    glTexCoord2f(1.0f, 1.0f); glVertex3f( 1.0f,  1.0f, -1.0f);  // Top Right Of The Texture and Quad
    //    // Bottom Face
    //    glTexCoord2f(1.0f, 1.0f); glVertex3f(-1.0f, -1.0f, -1.0f);  // Top Right Of The Texture and Quad
    //    glTexCoord2f(0.0f, 1.0f); glVertex3f( 1.0f, -1.0f, -1.0f);  // Top Left Of The Texture and Quad
    //    glTexCoord2f(0.0f, 0.0f); glVertex3f( 1.0f, -1.0f,  1.0f);  // Bottom Left Of The Texture and Quad
    //    glTexCoord2f(1.0f, 0.0f); glVertex3f(-1.0f, -1.0f,  1.0f);  // Bottom Right Of The Texture and Quad
    //    // Right face
    //    glTexCoord2f(1.0f, 0.0f); glVertex3f( 1.0f, -1.0f, -1.0f);  // Bottom Right Of The Texture and Quad
    //    glTexCoord2f(1.0f, 1.0f); glVertex3f( 1.0f,  1.0f, -1.0f);  // Top Right Of The Texture and Quad
    //    glTexCoord2f(0.0f, 1.0f); glVertex3f( 1.0f,  1.0f,  1.0f);  // Top Left Of The Texture and Quad
    //    glTexCoord2f(0.0f, 0.0f); glVertex3f( 1.0f, -1.0f,  1.0f);  // Bottom Left Of The Texture and Quad
    //    // Left Face
    //    glTexCoord2f(0.0f, 0.0f); glVertex3f(-1.0f, -1.0f, -1.0f);  // Bottom Left Of The Texture and Quad
    //    glTexCoord2f(1.0f, 0.0f); glVertex3f(-1.0f, -1.0f,  1.0f);  // Bottom Right Of The Texture and Quad
    //    glTexCoord2f(1.0f, 1.0f); glVertex3f(-1.0f,  1.0f,  1.0f);  // Top Right Of The Texture and Quad
    //    glTexCoord2f(0.0f, 1.0f); glVertex3f(-1.0f,  1.0f, -1.0f);  // Top Left Of The Texture and Quad
    //    glEnd();

//    // XML
//    QDomDocument doc( "AdBookML" );
//    QDomNode n;
//    QDomElement e;
//    QFile file( "test2.xml" );
//    QString s;
//    QStringList sl;

////    if( !file.open(QIODevice::ReadOnly))
////        qDebug("probleem bij het openen");

//    if( !doc.setContent( &file ) )
//    {
//        file.close();
//    }
//    file.close();

//    QDomElement root = doc.documentElement();
//    if( root.tagName() != "playlist" )
//        // qDebug("root is different");

//        //qDebug( root.tagName() );

//        // doorheen u boom lopen
//        n = root;
//    float f1, f2, f3;

//    glDisable( GL_LIGHTING );
//    glBegin(GL_TRIANGLES);
//    for(int i = 0; i< n.childNodes().length(); i++) // voor alle triangles
//    {
//        if(n.childNodes().at(i).toElement().tagName() == "triangle")
//        {
//            for(int j =0; j < 4; j++) // voor alle punten
//            {
//                e = n.childNodes().at(i).childNodes().at(j).toElement(); // e is een punt
//                //qDebug(e.tagName());
//                s = e.text();
//                sl = s.split(" ");          // opsplitsen naar het x, y , z coordinaat;
//                f1 = sl.at(0).toFloat();
//                f2 = sl.at(1).toFloat();
//                f3 = sl.at(2).toFloat();
//                if( j > 0)
//                    glVertex3f(f1, f2, f3);     // de vertex tekenen
//                if(j == 0)
//                    glColor3f(f1,f2,f3);
//            }
//        }

//    }
//    glEnd();
//    glEnable(GL_LIGHTING);

    // restore current matrix
    glMatrixMode( GL_MODELVIEW );
    glPopMatrix( );

}

void GLWidget::loadGLTextures()
{
    QImage t;
    QImage b;

    if ( !b.load( "images/redbrick.png" ) )
    {
        qDebug("Didn't found the image.");
        b = QImage( 16, 16, QImage::Format_RGB32 );
        b.fill( 1 );
    }

    t = QGLWidget::convertToGLFormat( b );
    glGenTextures( 1, &texture[0] );
    glBindTexture( GL_TEXTURE_2D, texture[0] );
    glTexImage2D( GL_TEXTURE_2D, 0, 3, t.width(), t.height(), 0, GL_RGBA, GL_UNSIGNED_BYTE, t.bits() );
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );
    glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_MODULATE);
}

//Functie die display lists kan aanmaken, het aantal ( is het aantal displaylists )
GLvoid GLWidget::buildLists(int aantal)
{
    displayList = new GLuint[aantal];
    for(int i = 0; i < aantal; i++)
    {
        displayList[i]=glGenLists(aantal);                                  // Maak x Aantal displaylists
        glNewList(displayList[i],GL_COMPILE);                               //start met de eerste display list te compile
        //Hieronder moet er xml worden ingeladen
        glBegin(GL_QUADS);
        // Bottom Face
        glNormal3f( 0.0f,-1.0f, 0.0f);
        glTexCoord2f(1.0f, 1.0f); glVertex3f(-1.0f, -1.0f, -1.0f);
        glTexCoord2f(0.0f, 1.0f); glVertex3f( 1.0f, -1.0f, -1.0f);
        glTexCoord2f(0.0f, 0.0f); glVertex3f( 1.0f, -1.0f,  1.0f);
        glTexCoord2f(1.0f, 0.0f); glVertex3f(-1.0f, -1.0f,  1.0f);
        // Front Face
        glNormal3f( 0.0f, 0.0f, 1.0f);
        glTexCoord2f(0.0f, 0.0f); glVertex3f(-1.0f, -1.0f,  1.0f);
        glTexCoord2f(1.0f, 0.0f); glVertex3f( 1.0f, -1.0f,  1.0f);
        glTexCoord2f(1.0f, 1.0f); glVertex3f( 1.0f,  1.0f,  1.0f);
        glTexCoord2f(0.0f, 1.0f); glVertex3f(-1.0f,  1.0f,  1.0f);
        // Back Face
        glNormal3f( 0.0f, 0.0f,-1.0f);
        glTexCoord2f(1.0f, 0.0f); glVertex3f(-1.0f, -1.0f, -1.0f);
        glTexCoord2f(1.0f, 1.0f); glVertex3f(-1.0f,  1.0f, -1.0f);
        glTexCoord2f(0.0f, 1.0f); glVertex3f( 1.0f,  1.0f, -1.0f);
        glTexCoord2f(0.0f, 0.0f); glVertex3f( 1.0f, -1.0f, -1.0f);
        // Right face
        glNormal3f( 1.0f, 0.0f, 0.0f);
        glTexCoord2f(1.0f, 0.0f); glVertex3f( 1.0f, -1.0f, -1.0f);
        glTexCoord2f(1.0f, 1.0f); glVertex3f( 1.0f,  1.0f, -1.0f);
        glTexCoord2f(0.0f, 1.0f); glVertex3f( 1.0f,  1.0f,  1.0f);
        glTexCoord2f(0.0f, 0.0f); glVertex3f( 1.0f, -1.0f,  1.0f);
        // Left Face
        glNormal3f(-1.0f, 0.0f, 0.0f);
        glTexCoord2f(0.0f, 0.0f); glVertex3f(-1.0f, -1.0f, -1.0f);
        glTexCoord2f(1.0f, 0.0f); glVertex3f(-1.0f, -1.0f,  1.0f);
        glTexCoord2f(1.0f, 1.0f); glVertex3f(-1.0f,  1.0f,  1.0f);
        glTexCoord2f(0.0f, 1.0f); glVertex3f(-1.0f,  1.0f, -1.0f);
        glEnd();
        glEndList();
    }
}

//functie die zorgt dat we renderen in selectiemode
void GLWidget::renderInSelectionMode() {
    glInitNames(); //Creates empty stack

    glPushName(1); //Push a name on the stack
    //draw something
    glColor3f(1.0f,0.0f,0.0f);
    glCallList(displayList[0]);
    glPopName(); //pop a name from the stack

    glPushName(2); //Push a name on the stack
    //draw something
    glTranslatef(5.0,0.0,0.0);
    glColor3f(0.0f,1.0f,1.0f);
    glCallList(displayList[0]);
    glPopName(); //Pops a name from the stack
}

void GLWidget::startPicking() {

    GLint viewport[4];

    glSelectBuffer(BUFSIZE,selectBuf);
    glRenderMode(GL_SELECT);

    glMatrixMode(GL_PROJECTION);
    glPushMatrix();
    glLoadIdentity();

    glGetIntegerv(GL_VIEWPORT,viewport);
    gluPickMatrix(cursorX,viewport[3]-cursorY,5,5,viewport);
    gluPerspective(45,aspect_ratio,0.1,1000);
    glMatrixMode(GL_MODELVIEW);
    glInitNames();
}

void GLWidget::stopPicking() {

    int hits;

    // restoring the original projection matrix
    glMatrixMode(GL_PROJECTION);
    glPopMatrix();
    glMatrixMode(GL_MODELVIEW);
    glFlush();

    // returning to normal rendering mode
    hits = glRenderMode(GL_RENDER);

    // if there are hits process them
    if (hits != 0)
        processHits(hits,selectBuf);
}

void GLWidget::processHits (GLint hits, GLuint buffer[])
{
    unsigned int i, j;
    GLuint names, *ptr, minZ,*ptrNames, numberOfNames;

    printf ("hits = %d\n", hits);
    ptr = (GLuint *) buffer;
    minZ = 0xffffffff;
    for (i = 0; i < hits; i++) {
        names = *ptr;
        ptr++;
        if (*ptr < minZ) {
            numberOfNames = names;
            minZ = *ptr;
            ptrNames = ptr+2;
        }

        ptr += names+2;
    }
    printf ("The closest hit names are ");
    ptr = ptrNames;
    for (j = 0; j < numberOfNames; j++,ptr++) {
        printf ("%d ", *ptr);
    }
    printf ("\n");

}

void GLWidget::mousePressEvent(QMouseEvent * e)
{
    if(e->button() == Qt::LeftButton)
    {
        qDebug("mouse");
        qDebug("%d",QCursor::pos().x());
        this->cursorX = QCursor::pos().x();
        this->cursorY = QCursor::pos().y();
        this->mode = 2;
    }
}

void GLWidget::keyPressEvent( QKeyEvent * e ) {

    double fraction = 0.1f;
    if(e->key() == Qt::Key_Up)
    {
        camPosz += camViewz * fraction;
        camPosx += camViewx * fraction ;
    }
    if(e->key() == Qt::Key_Down)
    {
        camPosz -= camViewz * fraction;
        camPosx -= camViewx * fraction ;
    }
    if(e->key() == Qt::Key_Left)
    {
        camAngle -= 0.05f;
        camViewz = -cos(camAngle);
        camViewx = sin(camAngle);
    }

    if(e->key() == Qt::Key_Right)
    {
        qDebug("cam angle is %f", camAngle);
        camAngle +=0.05f;
        camViewz = -cos(camAngle);
        camViewx = sin(camAngle);
    }
}

#ifndef GLWIDGET_H
#define GLWIDGET_H

#include <QtOpenGL/QGLWidget>
#include <gl/GLU.h>
#include <QImage>
#include <QKeyEvent>
#include <QMouseEvent>
#include <QTimer>
#define BUFSIZE 512

class GLWidget: public QGLWidget
{
    Q_OBJECT

public:
    GLWidget(QWidget *parent = NULL);

private:
    double camPosx,camPosy,camPosz;
    double camUpx,camUpy,camUpz;
    double camViewx,camViewy,camViewz;
    double camAngle;

protected:
    void initializeGL();
    void resizeGL(int width, int height);
    void paintGL();
    void keyPressEvent(QKeyEvent * e);
    void mousePressEvent(QMouseEvent * e);
    QTimer* timer;
    void loadGLTextures();
    GLuint  texture[1];
    GLuint  * displayList;
    void renderInSelectionMode();
    GLvoid buildLists(int aantal);
    void startPicking();
    void stopPicking();
    void processHits (GLint hits, GLuint buffer[]);
    GLuint selectBuf[BUFSIZE];
    GLdouble aspect_ratio;
    int cursorY;
    int cursorX;
    int mode;
};

#endif // GLWIDGET_H 
```

这是没有点击一次的正常视图 [http://imageshack.us/photo/my-images/233/31536776.png/](http://imageshack.us/photo/my-images/233/31536776.png/)

然后当点击它时，它会不断进入开始拾取并停止拾取并给出黑屏 [http://imageshack.us/photo/my-images/13/14180995.png/](http://imageshack.us/photo/my-images/13/14180995.png/)

然后在关闭窗口后停止运行它给了我这个输出[http://imageshack.us/photo/my-images/861/13486229.png/](http://imageshack.us/photo/my-images/861/13486229.png/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T05:19:55.407

可能是错误的，但看起来你没有`mode`在任何地方第一次鼠标单击后将 -variable 重置回 1，因此从第一次单击开始在每一帧上调用`start`- & -方法。`stopPicking`如果不是这种情况，那么您可能对 gl-states/matrix 有一些问题，在挑选后没有全部正确重置。

# bitbucket - 由于多个解决方案文件，构建失败

> ID：10710622
> 
> 赞同：1
> 
> 时间：2012-05-22T21:43:24.263
> 
> 标签：bitbucket, appharbor

我的 Appharbor 构建失败并显示此错误消息：

无法选择要构建的单个解决方案文件。找到：\SolutionName.sln 和 \BitBucketUserName-BitBucketRepositoryName-ccbc51ee8378\SolutionName.sln

ccbc51ee8378 是存储库提交 ID。（我用标记替换了其他值）

我只有一个解决方案，当我查看我机器上的文件和 BitBucket 中的源时，我只看到一个解决方案文件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T22:25:29.187

有趣的是，您应该尝试下载源 tarball 并检查它的内容（这是 AppHarbor 得到的）。您可以通过点击来检索它`src -> get source`。

# c# - 代表的复杂使用

> ID：10710626
> 
> 赞同：2
> 
> 时间：2012-05-22T21:43:39.050
> 
> 标签：c#

C#新手在这里。

在我的一个类（准确地说是一个实体类）中，我有一个接受实体和另一个相关类的委托：

```
public delegate void FiringFunc(Entity e, BulletFactory fact) 
```

以及 Entity 类中的一个循环，它每帧调用此函数（如果已定义）：

```
FiringFunc firingFunc = null; //defined later
if(firingFunc)
    firingFunc(this, someBulletFactory); 
```

有人可能会说，这是一个用作子弹发射功能的委托（您可以编写类似子弹计时器、发射角度等的代码）。然而，我想到了一个想法：如果我想让子弹有*一点*不同，但仍然保持不变（有点慢，颜色略有不同，方向不同等）怎么办？我将不得不创建另一个函数来充当代表——这对我来说似乎是错误的。

以下是创建和设置委托的示例：

```
Entity e = new Entity( ... )
e.firingFunc = FiringFunctions.SomeFiringFunctionName; 
```

有没有办法可以为此添加参数？如果我能做类似于以下的事情，那就太好了：

```
e.firingFunc = FiringFunctions.SomeFiringFunctionName(someChange1, someChange2); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:47:23.370

尝试

```
e.firingFunc = 
    (Entity e, BulletFactory fact) => 
        FiringFunctions.SomeFiringFunctionName(e, fact, "foo", 5); 
```

这将创建一个新的匿名函数（lambda），该函数`FiringFunctions.SomeFiringFunctionName`使用包含的参数进行调用。

这假设 FiringFunctions.SomeFiringFunctionName 定义为：

```
public void SomeFiringFunctionName(Entity e, BulletFactory fact, String someString, Int32 someInt) { 
  //...  do whatever here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T21:50:59.123

您还可以使用自定义接口并利用多态性（是的，它需要一个更好的名称）。

```
public interface IFiringActionProvider
{
    public void Fire(Entity e, BulletFactory fact);
} 
```

然后在你的同一个`Entity`班级：

```
IFiringActionProvider firingFunc = null; //defined later
if (firingFunc != null)
    firingFunc.Fire(this, someBulletFactory); 
```

您可以以任何您喜欢的形式创建自定义实例，例如：

```
public class CustomColorFiringActionProvider : IFiringActionProvider
{
    private Color color;
    public CustomColorFiringActionProvider(Color c) { this.color = c; }
    public void Fire(Entity e, BulletFactory fact)
    {
        // do something, using color
    }
} 
```

只是添加另一种类似的方法（不一定更好）。

# javascript - 带有 iScroll 和 jQuery mobile 的橡皮筋

> ID：10710628
> 
> 赞同：1
> 
> 时间：2012-05-22T21:44:13.357
> 
> 标签：javascript, jquery, mobile, iscroll

标题说明了一切。在我的应用程序开始时，我从 php 文件（一些 div）中检索数据并将它们附加到 wrapper-div。在这个 wrapper-div（不称为 wrapper）周围是 iScroll 包装器。

iScroll 工作正常，但有橡皮筋效应。

这是（索引）HTML：

```
<div data-role="header" data-theme="c" data-position="fixed">
          <h1>Title</h1>
      </div><!-- /header -->

      <div id="wrapper">
          <div id="scroller">

      <div data-role="content" id="content">

         <div id="headlinesindex">

          <div class="span3" id="9999999999"></div>

        </div>
        </div>
       </div>

      </div>

      <script>
          $(document).ready(function() {
                            onBodyLoad();
                            });
          </script> 
```

这是javascript文件：

```
 function onBodyLoad()
{
    $.ajax({
    url: "headlines_getter.php?last="+ $(".span3:last").attr('id') ,
    success: function(html) {
           if(html){    
            $("#headlinesindex").append(html);

           setTimeout(function () {
                      myScroll.refresh();
                      }, 0);

        }
    }
    });
}

function onDeviceReady()
{        
    var myScroll = new iScroll('wrapper');
} 
```

我已经玩过`setTimeout`iscroll.com 上解释的 arround，但它没有任何改变......希望你知道出了什么问题。

提前致谢。最好的问候，约翰。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:57:09.383

我遇到过同样的问题。

它来自外部“包装器”在 iscroll 中的大小不正确。

如果它的大小与内部“滚动条”高度的大小相同，则 iscroll 将无处可去和橡皮筋。

我为我修复了它，并为其他有同样问题的人创建了一个分支：

[https://github.com/meckdahl/iscroll](https://github.com/meckdahl/iscroll)

=================================== 高级用法

以下是我用来在我们的 Spine.JS 移动应用程序中维护我的 20 多个滚动容器的一些插件功能：

对于每个页面，我都设置了一个特定的包装器，如下所示：

```
<div id="wrapper2"> 
```

然后我仅在加载该页面时动态创建 iScroll：

加载页面内容后，我这样调用：

```
window.resetScroll(2)
window.setScrolling(true) 
```

这将为此页面重新初始化 iScroll。

以下是我在根页面上定义的功能：

```
<script type="text/javascript">

   // maximum wrapper index = 23 currently (9/12/12)
    var myScrolls = [];
    myScrolls.length = 29; // Scrolls to look for wrapper1-30

    var refreshScrolling = function() {
        //console.log('refreshScrolling Active Scroll Items: ');
        myScrolls.forEach( function(scrollItem){
            scrollItem.refresh();
        });
    };

   var refreshScroll = function(wrapperNumber) {
       //console.log('refreshScroll wrapperNumber: wrapper' + wrapperNumber.toString());

       var i = wrapperNumber;
       setTimeout(function () {
        (myScrolls[i-1]).refresh();
       }, 100);
   };

   // This looks for and initializes and dynamic scrolls that Spine recently put in memory
   // and have not been initialized yet.
    var setScrolling = function() {

       for (var i=1; i < myScrolls.length+1; i++){

           if (($("#wrapper"+(i).toString()).length !== 0)  ){

               if((myScrolls[i-1] !== null) && (myScrolls[i-1] !== undefined)){
                   // Already setup
               }
               else{
                   myScrolls[i-1] = new iScroll('wrapper'+ (i).toString(),
                           { hScroll: false, hScrollbar: false, vScrollbar: false });
 created.");
               }
           }
       }
    }

    // This must be called on a view with dynamic content to re-create the view to fit the potentially
    // changing content size.  It will only rebuild the one scroll whose index is passed in.
    // The index should be the wrapper# for the view attached to the controller.
    // Call setScrolling after this to catch any uninitialized views.
    var resetScroll = function(wrapperNumber) {

       var i = wrapperNumber;
       //   if (!(i in myScrolls)) continue; // skip nonexistent elements && !(myScrolls[i-1] )
       if (($("#wrapper"+(i).toString()).length !== 0)  ){

           if( (myScrolls[i-1] !== null) && (myScrolls[i-1] !== undefined)){
               // Destroy Skipped right now
               myScrolls[i-1].destroy();
               myScrolls[i-1] = null;
           }

           myScrolls[i-1] = new iScroll('wrapper'+ (i).toString(),
                   { hScroll: false, hScrollbar: false, vScrollbar: false });
           created.");
       }
    }

    function loaded() {
        setTimeout(function () {
            setScrolling();
        }, 100);
    }
    window.addEventListener('load', loaded, false);

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T06:08:52.187

我的自定义脚本遇到了同样的问题，所以我更改了代码，现在它运行良好：

```
var myScroll;

function loaded() {
    setTimeout(function(){
        myScroll = new iScroll('wrapper');
        myScroll.refresh();       
    } , 100 );
} 
```

我称之为“onDeviceReady”：

```
function onDeviceReady()
{        
    loaded();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T06:48:31.247

[http://jsfiddle.net/Eccgy/](http://jsfiddle.net/Eccgy/)

检查这可能对你有帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-24T09:25:51.773

这是一个简单的 iscroller 会有所帮助。它很容易实现

include scripts 和 jsut 将属性 data-iscroll 添加到 div 中，您需要该效果。

[https://github.com/watusi/jquery-mobile-iscrollview](https://github.com/watusi/jquery-mobile-iscrollview)

# java - 如何测试 X509TrustManager 子类？

> ID：10710633
> 
> 赞同：1
> 
> 时间：2012-05-22T21:44:32.030
> 
> 标签：java, ssl, junit, cryptography, x509certificate

我进行了子类化`javax.net.ssl.X509TrustManager`，以便可以使用私有 SSL 证书。现在我正在尝试为我的类编写一个 JUnit 测试，但是测试用例不断给我一个空指针异常。

*例如*，我的实现`checkClientTrusted()`是一个空方法。`X509Certificate[]`但是，当我使用（假定的）有效实例（以及任何类型的 String ）调用该方法时，JUnit`NullException`会在该行测试代码中报告 a。关于我缺少什么的任何建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T22:06:06.667

子类化“X509TrustManager”只是为了使用自签名证书（我认为这就是你对“私有 SSL 证书”的意思？）有点矫枉过正。使用此类证书的更简单方法是：

使用带有证书（或您创建自签名证书的 CA 的证书）的密钥库文件（信任库）并将您的应用程序指向该证书。您所要做的就是确保“SSLContext”知道您的信任库。有关详细信息，请查看（写得非常好）文章 [为高级 JSSE 开发人员定制 SSL](http://www.ibm.com/developerworks/java/library/j-customssl/#8)。从技术上讲，这比使用全局 JRE 信任库更安全，因为只有您的证书才会被接受为有效。

使用“keytool”将证书（或用于创建自签名证书的 CA 的证书）添加到 JRE 的全局信任库。全局 JRE 信任库位于“$JAVA_HOME/lib/security/cacerts”中。JRE 信任库的密码始终为“changeit”。尽管这种方式显然会使部署变得更加困难，因为有时您无法控制 JRE 安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T13:11:14.670

问题是我将我的测试类从 子类化`junit.framework.TestCase`，这导致我的`@BeforeClass`设置方法没有被调用（因此我在那里实例化的变量仍然为空）。删除后，现在一切正常。

# cross-domain - Firebase 如何处理跨源问题？

> ID：10710635
> 
> 赞同：15
> 
> 时间：2012-05-22T21:44:37.367
> 
> 标签：cross-domain, real-time-updates, firebase

查看[Firebase](http://www.firebase.com)常见问题解答，我看不到如何处理跨域问题。显然，我们不想在 Firebase 域上提供服务，是[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)、隐藏 iFrame 还是其他？我们是否需要创建一个指向共享服务器 IP 的子域？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-22T22:55:22.090

让我分两部分回答这个问题，因为有多种方式可以与 Firebase 服务器通信。

*   **Firebase JavaScript 客户端**- Firebase Javascript 客户端维护与服务器的实时双向连接。在幕后，这将尽可能使用 WebSockets（它对跨域连接没有限制）并回退到旧浏览器上基于隐藏 iframe 的 jsonp 长轮询（通过仅执行请求来回避跨域问题） .
*   **Firebase REST API** - 您还可以使用 REST API 从 Firebase 获取/设置数据，该 API 使用 CORS 来允许跨域请求。

所以总而言之，它应该“正常工作”，你不需要做任何特别的事情。

# windows - 如何在 Windows 7 下找出应用程序需要的权限

> ID：10710638
> 
> 赞同：4
> 
> 时间：2012-05-22T21:44:51.597
> 
> 标签：windows, delphi, windows-7, privileges, bde

有没有办法找出我的应用程序需要哪些权限才能在 Windows 7 环境中运行？

我有一个使用 BDE 和 ODBC 进行数据库连接的 Delphi 应用程序。此应用程序适用于大多数使用普通用户帐户运行 Windows 7 的计算机。但是，在某些计算机上，它仅适用于具有管理权限的帐户，而不能在普通用户帐户上正常工作。我怀疑是权限问题。这些计算机也在 Active Directory 中运行。

我尝试使用 SysInternals 的 Process Monitor 查找一些信息，但是对我来说输出太高级了。我的应用程序的两次运行的进程监视器日志（1\. 管理权限成功，2\. 正常权限不成功）有超过 22k 行，我在进程监视器日志（干草堆）中找不到答案（针）。

我可以做些什么来确定我的应用程序在 Windows 7 中所需的权限？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T07:57:21.553

使用[Microsoft 应用程序兼容性工具包](http://www.microsoft.com/en-us/download/details.aspx?id=7352)中的[标准用户分析器](http://technet.microsoft.com/en-us/library/cc766021%28v=ws.10%29.aspx)。

> 标准用户分析器 (SUA) 工具和标准用户分析器向导 (SUA 向导) 都使您能够测试应用程序并监视 API 调用，以检测由于 Windows 中的用户帐户控制 (UAC) 功能而导致的潜在兼容性问题® 7 操作系统。
> 
> UAC，以前称为受限用户帐户 (LUA)，要求所有用户（包括管理员组的成员）作为标准用户运行，直到通过使用安全提示对话框故意提升应用程序。但是，并非所有应用程序都可以使用标准用户角色正常运行，因为应用程序需要对标准用户不可用的位置的访问和特权。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T02:52:07.757

[Aaron Margosis](http://blogs.msdn.com/b/aaron_margosis/)有一个名为 LUA Buglight 的工具，旨在帮助追踪与特权相关的问题。

您可以从这篇博文下载最新版本： [LUA Buglight 2.1.1 with support for Win7/2008R2 SP1](http://blogs.msdn.com/b/aaron_margosis/archive/2011/03/23/lua-buglight-2-1-1-with-support-for-win7-2008r2-sp1.aspx)

它在概念上类似于 MS 应用程序验证程序。然而，在实践中，我发现 LUA Buglight 更易于使用和理解。与 ProcessMonitor 相同。它将以类似的方式监控您的流程，但仅报告作为普通用户失败但作为管理员用户成功的操作。

没有文档，但使用起来很简单。从主 GUI 窗口中选择您的 Exe 并让 BugLight 程序启动它。您需要在启用了 UAC 的管理员帐户中运行。当您不是管理员时，通过失败的步骤运行您的程序。完成后，单击“停止记录”按钮以查看一份报告，其中列出了没有管理员权限的呼叫会失败。

# c# - 字典上的 linq 查询有问题 >

> ID：10710643
> 
> 赞同：2
> 
> 时间：2012-05-22T21:45:49.640
> 
> 标签：c#, .net, linq

考虑以下 。. .

```
Dictionary<string, Dictionary<string, int>> myData; 
```

我想只保留**内部** `int > 1`的外部条目。

```
myData= myData.Select(c => c.Value.Where(i => i.Value > 1)); 
```

. . . 引发转换错误。

谢谢。

**编辑**

@Saeed 给出的答案做得很好，但是我现在需要一些额外的东西。我需要外部字典只包含内部字典超过 1 个条目的条目。（每次我认为我得到了它，我没有。而且我确信这是我应该看到的东西！）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T21:48:38.377

没有大于 1*的外部字典，因为每个外部字典“包含”与其内部字典中一样多的整数。* `int`

如果要保留至少一个`int`大于 1 的外部字典：

```
myData.Select(d => d.Value.Any(p => p.Value > 1)); 
```

如果要保留所有`int`s 都大于 1 的外部字典：

```
myData.Select(d => d.Value.All(p => p.Value > 1)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T21:50:11.327

你应该把它转换成字典，你也可以简单地使用匿名类型而不是它的确切类型。

```
myData= myData
             .Select(c => new {Key = c.Key,
                           Value = c.Value
                           .Where(i => i.Value > 1)
                           .ToDictionary(y=>y.Key, y=>y.Value)})
             .ToDictionary(x=>x.Key, x=>x.Value); 
```

**更新：**这样做之后，对于您的额外要求，请执行以下操作：

```
myData = myData.Where(x=>x.Value.Count() > 1).ToDictionary(x=>x.Key,x=>x.Value); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T13:59:08.523

如果您在浏览字典时遇到问题，也许要做的就是摆脱它们！

```
var flattened = 
  from kvp1 in myData
  let s1 = kvp1.Key
  from kvp2 in kvp1.Value
  let s2 = kvp2.Key
  let i = kvp2.Value
  select new { s1, s2, i }; 
```

现在有一个不错的平面集合，您应该可以轻松过滤到您想要的内容。

# apache - 在 Ubuntu 12.04 上的 Apache 上配置 SVN 服务器

> ID：10710647
> 
> 赞同：3
> 
> 时间：2012-05-22T21:46:04.733
> 
> 标签：apache, http, svn, webdav

我正在尝试通过 HTTP 访问现有的 Subversion 服务器。我的`dav_svn.conf`文件看起来像：

```
<Location /svn>
    DAV svn
    SVNParentPath /home/svn/repos
    SVNListParentPath on
    AuthType Basic
    AuthName "Restricted Access"
    AuthUserFile /home/svn/passwdfile
    Require valid-user
    AuthzSVNAccessFile /home/svn/accessfile
</Location> 
```

但是当我尝试访问“some-site/svn”时，出现以下错误：

> 在此服务器上找不到请求的 URL /svn/。

Apache 错误日志显示“文件不存在：/var/www/svn”

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T22:00:31.927

运行这个：

```
a2enmod dav_svn
service apache2 restart 
```

作为超级用户 ( `root`)，例如`sudo a2enmod dav_svn && sudo service apache2 restart`。

这假设您正在使用正确的方法（Debian+Ubuntu）来编辑这两个文件： `/etc/apache2/mods-available/dav_svn.{conf,load}`，而不是一些自制方法。

# c# - 填充的 DataGridView 显示 GetCellCount 的 0 个单元格

> ID：10710649
> 
> 赞同：1
> 
> 时间：2012-05-22T21:46:14.077
> 
> 标签：c#, winforms, datagridview

我有一个来自显示项目的 OdbcAdapter 的填充 DataGridView。但是，我遇到了麻烦，`GetCellDisplayRectangle(column, row, overflowFlag)`因为根据`GetCellCount(DataGridViewElementStates.Visible)`DataGridView 上没有单元格。

有人知道是什么原因造成的吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:20:11.737

这个问题发生在一个继承自`DataGridView`. 问题出在处理程序中`GetCellDisplayRectangle()`，并且通过隐式引用调用了其他相关函数`this`。

# android - 我应该为活动中的小部件创建实例字段吗？

> ID：10710655
> 
> 赞同：0
> 
> 时间：2012-05-22T21:47:11.733
> 
> 标签：android, android-widget

作为从事继承的 Adnroid 项目的新手设备开发人员，我想知道它在实例字段中存储小部件的风格是否是一种好习惯。

这个程序的编写方式是`Activity.onCreate`，在调用之后`setContentView`，调用`findViewById`每个小部件并为其分配实例字段。在其他方法中，它调用`getText`,`setEnabled`等。

这被认为是 Android 世界的最佳实践吗？我的意思是在需要时倾向于打电话`findViewById`，但想了解它通常是如何完成的。

编写良好的 Android 应用程序的任何好的资源（相对于教程）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:50:38.657

打电话`findViewById`似乎更快（我认为这只是安慰剂）。我只调用一次，根据`onCreate`情况将其分配给字段或局部变量。我认为`findViewById`只调用一次的原因是因为它比每次需要时都执行该方法更简洁。

而且，这也是通常的做法。只需看看 iosched 应用程序（由 Google 的 Android 工程师编写）之类的应用程序，您就会看到最有经验的开发人员通常是如何完成工作的。

# jquery - event_calendar 中的重复事件

> ID：10710658
> 
> 赞同：0
> 
> 时间：2012-05-22T21:47:23.197
> 
> 标签：jquery, ruby-on-rails-3, calendar

我在我的应用程序中使用[event_calendar](https://github.com/elevation/event_calendar)，我需要为我的事件创建重复的能力。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T00:17:55.877

您是否查看过 ruby​​ 工具箱的[重复事件](https://www.ruby-toolbox.com/categories/recurring_events)类别？

没用过，不过工具箱我做的不错=]

# php - 使用 casperjs 和 PHP 保存数据

> ID：10710663
> 
> 赞同：0
> 
> 时间：2012-05-22T21:47:36.707
> 
> 标签：php, javascript, phantomjs, casperjs

我一直在寻找某种关于如何做到这一点的教程或示例，但要么我不明白解决方案就在我的眼皮底下，要么没有人真正把它放在那里。

我想做的是使用 casperjs 来自动化我在网站上创建帐户的过程。我将提供几个不同的用户名，然后我想在最后输出一个文件，其中包含用于注册的用户名和密码。

如果我不需要使用 PHP 来执行此操作，那也可以。我只是很困惑。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T12:44:16.393

不确定是否完全理解您的问题（请参阅我上面的评论），但基本上：

```
var casper = require('casper').create();
var username = 'foo';
var password = 'bar';

casper.start('http://service.domain.tld/register.html', function() {
    this.fill('form[action="/register"]', {
        'username': username,
        'password': password
    }, true);
});

casper.then(function() {
    if (/Your account was created/.test(this.fetchText('.success'))) {
        this.echo('Created account: ' + username + '/' + password);
    } else {
        this.echo('Failed creating account for ' + username);
    }
});

casper.run(); 
```

您还可以返回任何补充信息的一些 JSON 序列化，以减轻 PHP 脚本对它们的使用。

# c# - Monotouch如何在C#中从NSArray中检索objectAtIndex

> ID：10710665
> 
> 赞同：4
> 
> 时间：2012-05-22T21:47:43.603
> 
> 标签：c#, nsarray

在objectiveC中，给定一个包含字符串的NSArray fred，我可以说：

```
NSString *s = [fred ObjectAtIndex:5]; 
```

什么是 c# 等价物？罗塞塔石碑说使用该方法`ValueAt`，但返回一个`IntPtr`.

```
var i = fred.ValueAt(5); 
```

但是接下来你就剩下如何将指针转换`IntPtr`为`NSString`指针了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-09-23T11:47:03.937

通过 IntPtr 感觉是个坏主意。相反，只要您知道要获取的项目的类型，您就可以使用以下内容：

```
int index = 0;
NSString str = myNsArr.GetItem<NSString>(index); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-29T10:08:28.823

我也遇到了同样的情况。您可以使用 new NSString() 将该 IntPtr 转换为 NSString，例如：

```
string strValue = new NSString(nsArr.ValueAt(1)); 
```

对你来说可能为时已晚，但也许它会帮助其他人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-25T16:29:10.800

```
string strValue = NSString.FromHandle(nsArr.ValueAt(1)); 
```

# javascript - 从href调用JS函数中删除#？

> ID：10710666
> 
> 赞同：0
> 
> 时间：2012-05-22T21:47:43.933
> 
> 标签：javascript

嘿，我有一个从 html 链接调用的函数，如下所示：

```
 <a href='#' onclick='javascript:populate("m")'>My Messages</a><br/> 
```

调用函数：

```
 function populate(q){

    switch(q){
    case 'm':  messages_document(call_data(q+'.php','main')); break;
    }
    return (false);
  } 
```

我遇到的问题是浏览器中的 url 向它添加了一个 # - 这似乎阻止我再次单击链接，除非我删除哈希，有没有办法阻止它在浏览器 url 中加载？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:54:36.817

```
onclick='return populate("m");' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T22:04:54.360

将您的脚本加载到文档头部（即，将其填充在两个`<head>`和`<script type="text/javascript">`标签之间）。 [示例](http://jsfiddle.net/Daedalus/kZtnm/8/)：

```
<head>
    <script type="text/javascript">
        function test(id){
            alert(id);
        }
    </script>
</head>
<a href='#' onclick="test('Test');">My Messages</a>​ 
```

我已经测试过了，它工作正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T22:24:40.417

尝试

```
<a href="javascript:;" onclick="populate('m');">My Messages</a>
<script>
function populate(q) {
    switch(q) {
        case 'm':  messages_document(call_data(q + '.php', 'main')); break;
    }
  }
</script> 
```

# computer-vision - 具有 SIFT 类似特征的 CBIR，离散方法与连续方法

> ID：10710667
> 
> 赞同：0
> 
> 时间：2012-05-22T21:47:45.477
> 
> 标签：computer-vision, sift, kdtree, object-recognition, cbir

目前我正在处理实现一个用于对象识别的 CBIR 系统（详细的对象分类），现在因为我有一些工作的特征检测器和描述符，我试图找到处理这些特征的最佳方法，以完成基于内容的任务图像检索。

据我所知，这项任务有两个主要趋势，离散方法和连续方法。离散代表方法，如视觉词袋和码本，用于建立反向索引以应用引用文本检索的方法，而连续代表方法，如使用 kd 树和最近邻分类的 Best Bin First 搜索。

所以这两种方法之间的一个主要区别是，一种使用视觉词等特征的额外表示，另一种使用从描述符计算的 nD 特征。

我现在的问题是，这两种 CBIR 方法之间是否有任何比较可以帮助我找到适合我的任务的最佳方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T07:40:45.827

这个问题的完整答案将非常复杂且冗长。但通常，连续方法可以为您提供更准确的结果，但速度较慢，因为您可以有效地构建搜索索引，并且您需要使用大型描述符。

您应该考虑使用离散特征（视觉词）作为初始结果的组合，然后使用连续方法过滤结果集。

# java - setCharacterEncoding 问题

> ID：10710668
> 
> 赞同：2
> 
> 时间：2012-05-22T21:47:52.993
> 
> 标签：java, servlets

我有这行代码：

```
response.setCharacterEncoding("UTF-8"); 
```

我收到此错误：

> HttpServletResponse 类型的方法 setCharacterEncoding(String) 未定义

Eclipse 建议将其`response`转换`request`为我不想做的事情。谁能帮我解决这个问题，好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T21:56:12.843

请参阅[javadoc](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponse.html#setCharacterEncoding%28java.lang.String%29)。此方法从 servlet 2.4 开始存在。要么您的服务器支持此版本（或更高版本）的 servlet 规范，并且您的构建路径中的 jar 太旧，要么它不支持它，您不应该使用此方法。

在后一种情况下，请阅读 javadoc 以了解应该替换它的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T21:56:38.827

另一种方法是设置内容类型。

```
response.setContentType("text/html;charset=UTF-8"); 
```

您可以阅读有关方法的*文档*[`setContentType`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponse.html#setContentType%28java.lang.String%29)：

> 如果协议提供了这样做的方法，容器必须将用于 servlet 响应的编写器的内容类型和字符编码传达给客户端。在 HTTP 的情况下，使用 `Content-Type`标头。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T21:54:48.360

该方法`setCharacterEncoding(String charset)`在`HttpServletResponse`的父类中定义`ServletResponse`。如果 eclipse 抱怨它是未定义的类型，你可能有一个不正确的 import 语句。尝试删除所有导入语句，然后按 Ctrl + O。

# iphone - _original_ 在我的 setter 方法中来自哪里？

> ID：10710671
> 
> 赞同：1
> 
> 时间：2012-05-22T21:48:02.963
> 
> 标签：iphone, objective-c, ios, xcode

我正在查看我的 Objective-C 代码的崩溃日志。

它说 -[MyClass _original_setMyVariable:]: unrecognized selector sent to instance

我很好奇的是，`_original_`它是从哪里来的，它是什么意思？

# logic - 优化逻辑的工具？

> ID：10710673
> 
> 赞同：1
> 
> 时间：2012-05-22T21:48:24.353
> 
> 标签：logic, boolean-logic

我正在用java编写处理器模拟器，控制信号非常繁琐。是否有任何工具可以生成如下逻辑：

二进制逻辑：

```
input[0]: 00001
input[1]: 00000
input[2]: 00010
input[3]: 00011 
```

输出：

```
if(input.subString(0,3) == "000") 
    //do something; 
```

基本上输出找到输入的公共部分。在上面的例子中，它是说“任何以 000 开头的东西都会做某事”，不管它是否`00000, 00001, 00010, 00011`

优化类似于k-map，除了我有一百个输入，手动优化根本不实用。

这是k-map的示例，**与我上面的示例无关**

![示例 kmap](../Images/266158f53786dfe4d2f1500ecddd11be.png)

输出不必是 java 语法，任何简化的逻辑语句都可以

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T22:48:31.500

所以你有一大组长度`N`位的字符串（其中`N`大约是 100），你想要一个简单的逻辑表达式来匹配这些字符串而不是其他字符串？

您可以尝试编写一个程序来为您构建 Kernaugh 地图。这将是一个有趣的练习。我不太记得 Kernaugh 地图，但我认为行和列上的标签使用格雷码排列。

或者，您可以尝试让手工制作的 Kernaugh 地图更易于处理。对于每个字符串，找到所有字符串共有的位。然后打印剩余位位置的列表，供人类构建地图。

一点Python代码：

```
str_len = 5
strs = [
     [0,0,0,0,1],
     [0,0,0,0,0],
     [0,0,0,1,0],
     [0,0,0,1,1],
]
for i in range(str_len):
    if all([x[i] for x in strs]):
        print 'Bit %d is 1' % i
    elif not any([x[i] for x in strs]):
        print 'Bit %d is 0' % i
    else:
        print 'Bit %d is contingent' % i 
```

那时，您可以尝试想办法对`B`剩余的条件位进行编码。在此示例中，碰巧涵盖了所有情况（您可以将其检测为特殊情况 - 例如`N = 2^B`）。

用于寻找或然位​​的公式的蛮力算法将是：

1.  选择下一个可能的位`i`。
2.  将 S 分为 S0（bit `i`= 0 的子集）和 S1（bit `i`= 1 的子集）。
3.  递归地分别找到 S0 和 S1 的公式 f0 和 f1。
4.  S 的公式是`(~b[i] & f0) | (b[i] & f1)`。

有一些优化。最简单的方法是 S0 或 S1 为空 - 然后省略结果公式的那个分支。另一种是所有可能的组合都在一个集合中（类似于上面的示例）；在这种情况下，公式不需要引用位。最难的是找到一个好的顺序来迭代其中的位。天真地按顺序进行操作可能会导致公式不太理想。

实际上，您可以跳过上面的第一个建议并在所有位上运行它。始终为 1 或 0 的位只会产生 S0 或 S1 为空的琐碎情况。

这个相当混乱的 Python 代码通过一些优化来执行算法。 **注意**它没有经过太多测试，不一定能产生最佳输出！

```
def get_formula(S, i=0):
    # Special case where it's an empty set -- return a tautology
    if len(S) == 0:
        return '1'

    remaining_bits = len(S[0]) - i

    # Special case where no bits are left
    if remaining_bits <= 0:
        return '1'

    # Partition the set
    S0 = filter(lambda x: x[i] == 0, S)
    S1 = filter(lambda x: x[i] == 1, S)

    f0 = get_formula(S0, i+1)
    f1 = get_formula(S1, i+1)

    # Special cases where one subset is empty
    # Also special case for subformula being tautology
    if len(S1) == 0:
        if f0 == '1':
            return '~b[%d]' % i
        return '~b[%d] & (%s)' % (i, f0)
    if len(S0) == 0:
        if f1 == '1':
            return 'b[%d]' % i
        return 'b[%d] & (%s)' % (i, f1)

    # Special cases where one or both subformulas was a tautology
    if f0 == '1' and f1 == '1':
        return '1'
    if f0 == '1':
        return '~b[%d] | b[%d] & (%s)' % (i, i, f1)
    if f1 == '1':
        return '~b[%d] & (%s) | b[%d]' % (i, f0, 1)

    # General case
    return '~b[%d] & (%s) | b[%d] & (%s)' % (i, f0, i, f1)

strs = [
     [0,0,0,0,1],
     [0,0,0,0,0],
     [0,0,0,1,0],
     [0,0,0,1,1],
]

print get_formula(strs) 
```

最后，我认为使此代码找到更优化公式的一种方法是提前扫描`S`始终为 0 或始终为 1 的位，并尽早处理它们。每个子集中剩余的偶然位将被推入深度嵌套的子公式中，与过早处理时相比，它们将形成更少的冗余公式。我认为这实际上会模拟 Kernaugh-map 样式的构造：在每一步，始终为 0 或始终为 1 位的集合定义了地图上的一个矩形。找到那个集合，一次处理它们（例如作为一个紧凑的公式`~b[0] & ~b[1] & ~b[2]`），然后对剩余的位进行递归。您需要跟踪哪些位位置已被处理，而不是使用`i`.

（实际上，现在我想起来了，对于最佳公式，您还需要通过一次选择一堆相关位来巧妙地进行分区。一个有趣的问题......）

# javascript - 如何删除和清除所有 localStorage 数据

> ID：10710674
> 
> 赞同：191
> 
> 时间：2012-05-22T21:48:26.520
> 
> 标签：javascript, jquery, html, local-storage

我需要清除我设置的所有数据`localStorage`。我的意思是完全重置`localStorage`到`null`用户删除他们的帐户时。

我怎样才能用一个简单的功能做到这一点？

我试过这个：

```
function clearLocalStorage(){
    return localStorage= null;
} 
```

但它没有按预期工作。

* * *

## 回答 #1

> 赞同：495
> 
> 时间：2012-05-22T21:51:01.090

`localStorage.clear();`

应该管用。

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2012-05-23T11:05:49.887

如果您想从本地存储中删除/清除所有值而不是使用

```
localStorage.clear(); 
```

如果您想从本地存储中删除特定项目，请使用以下代码

```
localStorage.removeItem(key); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-10-09T11:17:40.923

`window`从对象访问它时，它仅在 Firefox 中对我有用。

例子...

```
window.onload = function()
{
 window.localStorage.clear();
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-12-05T07:47:09.327

使用`.one`可确保仅执行一次而不是重复执行此操作。

```
$(window).one("focus", function() {
    localStorage.clear();
}); 
```

为了可读性，放几个 document.ready 事件监听器（如果你需要其他事件多次执行）是可以的，只要不过度。

`.one`当您希望仅在第一次打开网页或第一次安装移动应用程序时清除本地存储时，此功能特别有用。

```
 // Fired once when document is ready
   $(document).one('ready', function () {
       localStorage.clear();
   }); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-22T21:49:59.233

这样的事情应该做：

```
function cleanLocalStorage() {
    for(key in localStorage) {
        delete localStorage[key];
    }
} 
```

但是，使用它时要小心，因为用户可能存储了其他数据，`localStorage`如果您删除它，可能会被打勾。我建议 a) 不将用户的数据存储在`localStorage`或 b) 将用户的帐户内容存储在单个变量中，然后清除它而不是删除`localStorage`.

* * *

**编辑**：正如 Lyn 指出的那样，你会很擅长`localStorage.clear()`. 然而，我之前的观点仍然成立。

# asp.net-mvc-3 - Html.ActionLink MVC3 ASPX / v. ?=

> ID：10710676
> 
> 赞同：0
> 
> 时间：2012-05-22T21:48:40.653
> 
> 标签：asp.net-mvc-3

当我使用以下操作链接时：

```
<%: Html.ActionLink("Study Cases", "Index", "CourseCases", new { id = Model.ID }, new { @class = "t-button", @style = "width:240px; color:white; text-align:center" })%> 
```

浏览器中的url地址为：

```
http://localhost:11111/CourseCases/Index/9 
```

我怎样才能改变它，所以 url 将是

```
 http://localhost:11111/CourseCases?courseId=9 
```

它在我使用时有效：

```
 return RedirectToAction("Index", "CourseCases", new { courseId = id }); 
```

在控制器中。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T21:50:05.350

像这样：

```
<%= Html.ActionLink(
    "Study Cases", 
    "Index", 
    "CourseCases", 
    new { courseId = Model.ID }, 
    new { 
        @class = "t-button", 
        @style = "width:240px; color:white; text-align:center" 
    }
) %> 
```

您的代码生成的原因`http://localhost:11111/CourseCases/Index/9`是因为`{id}`在您创建 ASP.NET MVC 3 应用程序时生成的默认路由使用它，因此当您指定`id = Model.ID`它时，它将与您的 Global.asax 中的路由模式定义匹配，`{controller}/{action}/{id}`因此您得到`CourseCases/Index/9`.

# java - 使用 Glassfish 3.1.2 和 JAAS 登录 JSF 2.0

> ID：10710677
> 
> 赞同：3
> 
> 时间：2012-05-22T21:48:43.277
> 
> 标签：java, jsf, glassfish, jaas

当我尝试使用 JSF 2 登录时遇到问题。我收到以下消息：

> WEB9102：Web 登录失败：com.sun.enterprise.security.auth.login.common.LoginException：登录失败：安全异常

这是我的登录页面：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./modeloLogin.xhtml"
                xmlns:p="http://primefaces.prime.com.tr/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html">

    <ui:define name="content">        
        <p:growl id="growl" showDetail="true" life="3000" />  

        <div id="formulario">
            <p:panel id="pnl" header="Login">
                <h:form>  
                    <h:panelGrid columns="2" cellpadding="5">  
                        <h:outputLabel for="username" value="Usuário:" />  
                        <p:inputText value="#{beanLogin.username}"   
                                     id="username" required="true" label="username" />  

                        <h:outputLabel for="password" value="Senha:" />  
                        <p:password value="#{beanLogin.password}" feedback="false" minLength="" id="password"  label="password" />

                        <p:commandButton id="loginButton" value="Efetuar Login" update=":growl"
                                         action="#{beanLogin.login()}" ajax="false"/> 
                        <p:commandLink value="Esqueceu a senha?" ></p:commandLink>

                    </h:panelGrid>  
                </h:form>              
            </p:panel>
        </div>
    </ui:define>
</ui:composition> 
```

这是我的 BeanLogin：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package sonic.action.login;

import java.security.Principal;
import javax.ejb.Stateless;
import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import javax.faces.context.FacesContext;
import javax.inject.Named;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;

/**
 *
 * @author 081315620876
 */
@ManagedBean
@SessionScoped
public class BeanLogin {

    private String username;
    private String password;

    public BeanLogin() {
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public String login() {
         FacesContext context = FacesContext.getCurrentInstance();  
         HttpServletRequest request = (HttpServletRequest) context.getExternalContext().getRequest(); 
         System.out.println(context == null);
         System.out.println(request == null);
        try {        
            request.login(this.username, this.password);         
           if(request.isUserInRole("admin")) {  
                return "/pages/protected/admin/index.xhtml?faces-redirect=true";  
           } else if(request.isUserInRole("professor")){  
                return "/pages/protected/professor/index.xhtml?faces-redirect=true";  
           }         
        } catch (ServletException e) {
            context.addMessage(null, new FacesMessage("Login failed."));
            return "error";
        }
        return "login.xhtml";
    }

    public void logout() {
        FacesContext context = FacesContext.getCurrentInstance();
        HttpServletRequest request = (HttpServletRequest) context.getExternalContext().getRequest();
        try {
            request.logout();
        } catch (ServletException e) {
            context.addMessage(null, new FacesMessage("Logout failed."));
        }
    }
} 
```

提前感谢您的帮助:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-27T12:27:39.177

登录失败：安全异常意味着您的用户名或密码错误。如果您使用的是数据库，请检查您是否已正确连接以及您的用户名和密码是否正确。

# c++ - 提升正则表达式、正则表达式、url和img

> ID：10710679
> 
> 赞同：2
> 
> 时间：2012-05-22T21:48:50.157
> 
> 标签：c++, regex, boost, expression

我需要在网页的 HTML 源代码中找到所有链接和图像。实际上我有以下表达：

```
boost::regex findurl("(?s)<\\s*a\\s+.*?href\\s*=\\s*['\"]([^http]{1}[^\\s>]*)['\"]", boost::regex::normal | boost::regbase::icase); 
```

还应该如何查找图像（标签）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T21:51:15.363

学习 Perl 和使用 HTML::Parser 所花费的时间比调试这个不适用于病态 HTML 的正则表达式要少。我已经可以在其中发现三个链接错误，即使您只询问图像。

这包括示例代码，即使您不了解 Perl，您也可能知道如何修改。 [http://perlmeme.org/tutorials/html_parser.html](http://perlmeme.org/tutorials/html_parser.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T22:14:50.363

在字符类 ( `[^http]`) 中重复出现字符似乎不正确。djechlin 的观点是，对于最简单的 HTML，RE 可能是不够的。

# windows - 识别和调整 unix-"isms" 以适应 Windows 命令提示符

> ID：10710681
> 
> 赞同：0
> 
> 时间：2012-05-22T21:48:57.223
> 
> 标签：windows, shell, unix, export, pyramid

在 Python Pyramid[教程](http://docs.pylonsproject.org/projects/pyramid_tutorials/en/latest/humans/setup.html)中，我遇到了这句话：

“Windows 用户需要调整下面的 Unix-isms 以匹配他们的环境。”

它似乎与“导出”命令有关，但我并不完全确定。因此，问题是其他人如何进行识别和适应“Unix-isms”的过程？到目前为止，我唯一的方法是查看无法识别的内容，显然这可能是由于不同的原因。

关于研究，我可能已经找到了专门针对导出的付费解释，但我确信有更好的资源来调整这些命令。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T01:20:57.167

*   该`$`符号是[**Unix 提示符**](https://superuser.com/questions/57575)

*   这`;`是一个命令分隔符

*   `export` [**sets**](http://ss64.com/bash/export.html)设置环境变量，类似于[**setx**](http://ss64.com/nt/setx.html)

*   `PATH=/path/to/tutorial_workspace/venv/bin:$PATH`正在修改`PATH`环境变量，类似于`PATH=/path/to/tutorial_workspace/venv/bin;%PATH%`

*   `which` [**搜索**](http://ss64.com/bash/which.html)`PATH`程序并返回其位置。

# c# - 如何确定我的应用程序的哪一部分正在泄漏内存？

> ID：10710682
> 
> 赞同：2
> 
> 时间：2012-05-22T21:48:59.117
> 
> 标签：c#, visual-studio-2010, memory-leaks, dispose

我已经实现`Dispose`了......支持它的所有地方。我正在删除所有事件处理程序。我不是在调用本机代码。

我什至遍历每个字典并将值设置为 null 并在所有项目上调用 .Clear()。

**问题：**

如何确定我的代码在哪里泄漏？

我首先通过在测试中运行它一夜之间发现了泄漏。它使用固定数量的内存，因此它应该增长然后变得有些静态。然后我让前台线程显示内存是这样的：

```
 if (key.KeyChar == 'g')
             {
                long pre = GC.GetTotalMemory(false);
                long post = GC.GetTotalMemory(true);
                Console.WriteLine("{2} Pre:{0}  \tPost:{1}", pre, post, System.DateTime.Now);
                 GC.Collect();
              } 
```

我跑了几次（几个小时，偶尔按一次“g”），看到一个不断增加的数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:54:39.993

追踪这一点的最好方法是使用内存分析器......有很多可供选择。

[.NET 内存分析工具](https://stackoverflow.com/questions/399847/net-memory-profiling-tools)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T22:00:58.653

确保你使用

```
try
{
}
finally 
{ 
   youDisposableObject.Dispose(); 
} 
```

或者

```
using (yourDisposableObject) {} 
```

对于您实施“处置”的每个对象

如果您无需任何需要就对某些对象实现了终结器，请删除它们

如果之后仍然无法修复它，则必须使用内存分析器

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T22:01:44.660

这里有一篇文章描述了如何使用 SOS.dll 来完成，[这里](http://dandesousa.com/2010/08/28/finding-memory-leaks-in-net-using-sos-dll-and-visual-studio/)有一篇更全面的[文章](http://www.codeproject.com/Articles/19490/Memory-Leak-Detection-in-NET)。

根据您使用的 Visual Studio 版本（Premium 或 Ultimate），您还可以使用常规代码分析工具来帮助查找代码中可能导致内存泄漏的问题。（[这里](http://geekswithblogs.net/terje/archive/2011/11/27/using-the-static-code-analysis-feature-of-visual-studio-premiumultimate.aspx)有详细信息）

当然，在托管代码中，内存泄漏与在非托管代码中有些不同。在非托管代码中，显式分配和解除分配内存，内存泄漏是由于未能解除分配内存造成的。

在 .NET 中，内存泄漏来自于挂在对象上的时间比预期的要长。只需遵循尽可能使用[using](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)语句的最佳实践，并仔细规划变量的范围，就可以在很大程度上避免这种情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T22:02:29.570

我刚刚在我的 c# 应用程序中遇到了同样的问题，并使用了（实际上是试用版） [dotTrace 内存分析器](http://www.jetbrains.com/profiler/)，这非常有帮助。

仍然需要一些时间来定位发生泄漏的实际代码行。因此，不要指望该工具会立即识别出罪魁祸首。

# python - 对象之间无缘无故共享字典？

> ID：10710689
> 
> 赞同：2
> 
> 时间：2012-05-22T21:50:00.607
> 
> 标签：python, class, data-structures, nltk

以下代码应该创建频率分布 (nltk.FreqDist) 的新（修改）版本。两个变量应该是相同的长度。

创建 WebText 的单个实例时，它可以正常工作。但是当创建多个 WebText 实例时，新变量似乎被所有对象共享。

例如：

```
import nltk
from operator import itemgetter

class WebText:

    freq_dist_weighted = {}

    def __init__(self, text):
        tokens = nltk.wordpunct_tokenize(text) #tokenize
        word_count = len(tokens)
        freq_dist = nltk.FreqDist(tokens)

        for word,frequency in freq_dist.iteritems():
            self.freq_dist_weighted[word] = frequency/word_count*frequency
        print len(freq_dist), len(self.freq_dist_weighted)

text1 = WebText("this is a test")
text2 = WebText("this is another test")
text3 = WebText("a final sentence") 
```

结果是

```
4 4
4 5
3 7 
```

这是不正确的。由于我只是转置和修改值，因此每列中应该有相同的数字。如果我在循环之前重置 freq_dist_weighted ，它可以正常工作：

```
import nltk
from operator import itemgetter

class WebText:

    freq_dist_weighted = {} 

    def __init__(self, text):
        tokens = nltk.wordpunct_tokenize(text) #tokenize
        word_count = len(tokens)
        freq_dist = nltk.FreqDist(tokens)
        self.freq_dist_weighted = {}

        for word,frequency in freq_dist.iteritems():
            self.freq_dist_weighted[word] = frequency/word_count*frequency
        print len(freq_dist), len(self.freq_dist_weighted)

text1 = WebText("this is a test")
text2 = WebText("this is another test")
text3 = WebText("a final sentence") 
```

结果（正确）：

```
4 4
4 4
3 3 
```

这对我来说没有意义。

我不明白为什么我必须重置它，因为它在对象中是孤立的。难道我做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-22T21:52:13.923

你的评论明显是错误的。类范围内的对象仅在创建类时初始化；如果您希望每个实例有一个不同的对象，那么您需要将其移动到初始化程序中。

```
class WebText:
    def __init__(self, text):
        self.freq_dist_weighted = {} #### RESET the dictionary HERE ####
         ... 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-22T21:55:06.923

您的`freq_dist_weighted`字典是类属性，而不是实例属性。因此，它在类的所有实例之间共享。（`self.freq_dist_weighted`仍然指的是类属性；由于没有该名称的特定于实例的属性，Python 回退到查看类。）

要使其成为实例属性，请将其设置在类的`__init__()`方法中。

```
def __init__(self, text):
    self.freq_dist_weighted = {}
    ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T22:01:13.137

```
class WebText:
    freq_dist_weighted = {} 
```

声明`freq_dist_weighted`它在所有类型的对象之间共享`WebText`；本质上，这就像`static`C++ 中的成员。

如果您希望每个`WebText`对象都有自己的`freq_dist_weighted`成员（即您可以为一个实例更改它而不为另一个实例更改它），您希望在以下位置定义它`__init__`：

```
class WebText:
    def __init__(self):
        self.freq_dist_weighted = {} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-22T23:19:53.927

> 创建 WebText 的单个实例时，它可以正常工作。但是当创建多个 WebText 实例时，新变量似乎被所有对象共享。

嗯，是; 当然，当所有实例都共享该值时，它可以与单个实例一起正常工作。;)

这个值是共享的，因为 Python 遵循一个非常简单的规则：你在`class`块中定义的东西属于类。即，它们不属于实例。要将某些内容附加到实例，您必须明确地执行此操作。这通常在 中完成`__init__`，但在正常情况下（即如果您没有使用过`__slots__`）可以随时完成。分配给对象的属性就像分配给列表的元素一样；没有真正的保护，因为我们在这里都是成熟的成年人并且被认为是负责任的。

```
def __init__(self, text):
    self.freq_dist_weighted = {}
    # and proceed to modify it 
```

交替：

```
def __init__(self, text):
    freq_dist_weighted = {}
    # prepare the dictionary contents first
    self.freq_dist_weighted = freq_dist_weighted 
```

# android - 无法在 Android 库文件中找到类

> ID：10710693
> 
> 赞同：1
> 
> 时间：2012-05-22T21:50:30.967
> 
> 标签：android, shared-libraries, classnotfoundexception

我创建了一个非常简单的 Android 应用程序，只是为了使用功能。在应用程序中，我想调用 Web 服务客户端来检索和显示一些数据。我*想*我已经成功导入并引用了 jar 文件（即库）。它似乎成功地实例化了该类，但是当该类引用 jar/库中的另一个类时，它会引发*类未找到*错误。有任何想法吗？？？还有什么我可以提供帮助回答的吗？？？

这是我的代码：

```
package mhcs.android.ehd;

import mhcs.services.client.EHD.EHDClient;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class GetTicketDescription extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        EHDClient client = new EHDClient();
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        String title = getString(R.string.title);
        setTitle(title); // done so that we can change the default title
        //get handles to editText and button widgets
        final EditText eText = (EditText) findViewById(R.id.editText1);
        final Button button = (Button) findViewById(R.id.button1);
        eText.setText(client.getTicketDescription("MMLZ-8LVRMK"));

        button.setOnClickListener(new Button.OnClickListener(){
            @Override
            public void onClick(View v) {
                //get the String entered into the editText widget
                CharSequence editText = eText.getText();
                //display the toast
                Toast.makeText(GetTicketDescription.this, editText, Toast.LENGTH_LONG).show();
            }
        });
    }
} 
```

这是错误：

```
D/dalvikvm(538): Not late-enabling CheckJNI (already on)
I/dalvikvm(538): threadid=3: reacting to signal 3
I/dalvikvm(538): Wrote stack traces to '/data/anr/traces.txt'
W/dalvikvm(538): Unable to resolve superclass of Lorg/tempuri/EHDLookupService; (73)
W/dalvikvm(538): Link of class 'Lorg/tempuri/EHDLookupService;' failed
E/dalvikvm(538): Could not find class 'org.tempuri.EHDLookupService', referenced from method mhcs.services.client.EHD.EHDClient.<init>
W/dalvikvm(538): VFY: unable to resolve new-instance 93 (Lorg/tempuri/EHDLookupService;) in Lmhcs/services/client/EHD/EHDClient;
D/dalvikvm(538): VFY: replacing opcode 0x22 at 0x0003
W/dalvikvm(538): Unable to resolve superclass of Lorg/tempuri/EHDLookupService; (73)
W/dalvikvm(538): Link of class 'Lorg/tempuri/EHDLookupService;' failed
W/dalvikvm(538): Unable to resolve superclass of Lorg/tempuri/EHDLookupService; (73)
W/dalvikvm(538): Link of class 'Lorg/tempuri/EHDLookupService;' failed
I/dalvikvm(538): Could not find method org.tempuri.EHDLookupService.getBasicHttpBindingIEHDLookupService, referenced from method mhcs.services.client.EHD.EHDClient.<init>
W/dalvikvm(538): VFY: unable to resolve virtual method 112: Lorg/tempuri/EHDLookupService;.getBasicHttpBindingIEHDLookupService ()Lorg/tempuri/IEHDLookupService;
D/dalvikvm(538): VFY: replacing opcode 0x6e at 0x001c
W/dalvikvm(538): VFY: unable to find class referenced in signature (Ljavax/xml/bind/JAXBElement;)
I/dalvikvm(538): Could not find method javax.xml.bind.JAXBElement.getValue, referenced from method mhcs.services.client.EHD.EHDClient.getAssigneeTickets
W/dalvikvm(538): VFY: unable to resolve virtual method 42: Ljavax/xml/bind/JAXBElement;.getValue ()Ljava/lang/Object;
D/dalvikvm(538): VFY: replacing opcode 0x6e at 0x0026
W/dalvikvm(538): VFY: unable to find class referenced in signature (Ljavax/xml/bind/JAXBElement;)
I/dalvikvm(538): Could not find method javax.xml.bind.JAXBElement.getValue, referenced from method mhcs.services.client.EHD.EHDClient.getTicketDescription
W/dalvikvm(538): VFY: unable to resolve virtual method 42: Ljavax/xml/bind/JAXBElement;.getValue ()Ljava/lang/Object;
D/dalvikvm(538): VFY: replacing opcode 0x6e at 0x000b
W/dalvikvm(538): Unable to resolve superclass of Lorg/tempuri/EHDLookupService; (73)
W/dalvikvm(538): Link of class 'Lorg/tempuri/EHDLookupService;' failed
D/dalvikvm(538): DexOpt: unable to opt direct call 0x006b at 0x15 in Lmhcs/services/client/EHD/EHDClient;.<init>
D/AndroidRuntime(538): Shutting down VM
W/dalvikvm(538): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)

E/AndroidRuntime(538): FATAL EXCEPTION: main
E/AndroidRuntime(538): java.lang.NoClassDefFoundError: org.tempuri.EHDLookupService
E/AndroidRuntime(538):      at mhcs.services.client.EHD.EHDClient.<init>(EHDClient.java:25)
E/AndroidRuntime(538):      at mhcs.android.ehd.GetTicketDescription.onCreate(GetTicketDescription.java:15)
E/AndroidRuntime(538):      at android.app.Activity.performCreate(Activity.java:4465)
E/AndroidRuntime(538):      at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
E/AndroidRuntime(538):      at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
E/AndroidRuntime(538):      at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
E/AndroidRuntime(538):      at android.app.ActivityThread.access$600(ActivityThread.java:123)
E/AndroidRuntime(538):      at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
E/AndroidRuntime(538):      at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(538):      at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime(538):      at android.app.ActivityThread.main(ActivityThread.java:4424)
E/AndroidRuntime(538):      at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(538):      at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime(538):      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
E/AndroidRuntime(538):      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
E/AndroidRuntime(538):      at dalvik.system.NativeStart.main(Native Method)
I/dalvikvm(538): threadid=3: reacting to signal 3
I/dalvikvm(538): Wrote stack traces to '/data/anr/traces.txt' 
```

注意：我了解 org/tempuri 的问题，并会更正。

（因为我是新用户，所以无法发布我的工作区的图像）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-24T02:10:39.247

1.  查找*属性*-> *Java 构建路径*->*排序和导出*
2.  更改*Android 依赖项*顺序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-27T21:50:51.207

我遇到了同样的问题，我尝试在 Order and Export 下标记 Android Private Libraries，但它对我不起作用。然后我注意到我的 libs 文件夹没有在 Java 构建路径下引用。所以我只是将它添加到库中并且它起作用了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-13T19:51:58.217

转到项目>构建路径>配置构建路径

检查您想要的库并点击确定

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T22:36:02.597

尝试`libs`在您的项目下创建一个名为的新文件夹并将 .jar 文件放在那里...

# java - 使用 Web 服务在 Java 中接收 json

> ID：10710694
> 
> 赞同：0
> 
> 时间：2012-05-22T21:50:31.467
> 
> 标签：java, json, service, web

我使用 Java 调用服务器以接收 json 信息，并且我想通过 Rest Web 服务检索该信息。现在我有这个代码：

```
public class consult {
  public static void consult1() the url that retrieves json);
    InputStream response = url.openStream();
    BufferedReader reader = new BufferedReader(new InputStreamReader(response));
        for (String line; (line = reader.readLine()) != null;) {
                System.out.println(line);

            }
    reader.close();
} 
```

这在控制台上完美地显示了 Json，但是如何将信息设置为某个变量，以便当我在浏览器（/resources/consult/）中调用此 WS 时根据此 WS 显示信息？

```
@Path("/consult")
public class ConsultJSON {

@GET
@Produces ("application/json")
public String getInfo() throws MalformedURLException, IOException {
   return consult.consult1();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:58:57.543

我建议您查看本教程，了解如何实现 RESTful JSON 服务：

[http://www.mkyong.com/webservices/jax-rs/integrate-jackson-with-resteasy/](http://www.mkyong.com/webservices/jax-rs/integrate-jackson-with-resteasy/)

正确设置背后的想法是您不需要从方法中返回序列化字符串。您只需返回一个域对象并指示框架通过注释对其进行序列化。

当然，您会在其中找到有关如何发布新对象或对其进行更新的示例（以 JSON 格式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:55:35.007

实际上，您确实应该将 InputStream 从响应直接传输到您的 OutputStream。在 IOUtils / DataFetcher 中的 TUS 中有自动执行此管道的工具：http: [//tus.svn.sourceforge.net/viewvc/tus/tjacobs/io/](http://tus.svn.sourceforge.net/viewvc/tus/tjacobs/io/)

# c - 重新分配失败

> ID：10710695
> 
> 赞同：2
> 
> 时间：2012-05-22T21:50:33.817
> 
> 标签：c, memory, memory-management, realloc

我正在编写一个程序，它扫描文本文件以查找每行开头的字节偏移量。字节偏移量存储在一个长整数数组中。

文本文件是这样的：

```
123456
123
123456789
12345
123
12
1
12345678
12345 
```

出于测试目的，数组的大小从 2 开始，以便我可以测试我的 Realloc 函数是否有效。

我逐行扫描，计算每行的长度，并将其存储为字节偏移量。假设在声明/初始化此循环之前的所有内容：

```
while(fgets(buffer, BUFSIZ, fptr) != NULL)
    {
        otPtr[line] = offset; 
        len = strlen(buffer)*sizeof(char);
        offset += len;
        printf("%03d %03d %03d %s", line, otPtr[line], len, buffer);
        line++;
        if(line == cursize) resize(table, &cursize);
    } 
```

如果行号==数组的大小，循环就要用到最后一个数组元素，所以我调用resize。在 resize() 中，我想将字节偏移值数组的当前大小加倍。

值得注意的是，我使用的是“Realloc()”而不是“realloc()”，因为我有一个包装库来检查 realloc 错误，然后在失败时存在。

```
int resize(long int* table, int* cursize)
{
    long int* ptr;
    *cursize *= 2;
    printf("Reallocating to %d elements...\n", *cursize);
    ptr = (long int*)Realloc(table, (*cursize)*sizeof(long int));
    if(ptr != NULL)
        table = ptr;
} 
```

（另外，将 realloc 包装在另一个函数中，然后将其包装在另一个函数中是多余的吗？或者这是否可以用于此目的？或者我应该将 if(ptr!=NULL) 编码到包装器中吗？）

我的输出看起来像这样，

```
Building offset table...
Sizeof(char) in bytes: 1
001 000 008 123456
002 008 005 123
003 013 011 123456789
Reallocating to 8 elements...
004 024 007 12345
005 031 005 123
006 036 004 12
007 040 003 1
Reallocating to 16 elements...
Realloc error
Process returned 0 (0x0)   execution time : 0.031 s
Press any key to continue. 
```

其中三列只是行号//字节偏移//该行的字节长度，最后一行只是该行文本的打印输出（此输出来自循环首先扫描文件的部分到计算偏移量，以防不清楚，我只是打印出缓冲区以确保它正常工作。）

为什么我会收到 Realloc 错误？

下面是 Realloc 的实现：

```
void *Realloc(void *ptr, size_t numMembers)
{
     void *newptr;

     if ((newptr = (void *) realloc(ptr, numMembers)) == NULL)
     {
         printf("Realloc error");
         exit(1);
     }
     return newptr;
} 
```

这是一个最小的测试用例。以前从未写过这些，但我认为这是“正确的”。

```
#include<stdio.h>
#include<stdlib.h>

void *Realloc(void *ptr, size_t numMembers);

int main(void)
{
    void resize(int** table, int* size);
    int size = 2;
    int j = 15;
    int i = 0;
    int* table;

    table = (int*)calloc(size, sizeof(int));

    while(i<j)
    {
        printf("Give number: ");
        scanf("%d", &table[i]);
        i++;
        if(i == size) resize(&table, &size);
    }
    i = 0;
    printf("Printing table...\n");
    while(i < j)
    {
        printf("%d ", table[i]);
        i++;
    }
}

void *Realloc(void *ptr, size_t numMembers)
{
     void *newptr;

     if ((newptr = (void *) realloc(ptr, numMembers)) == NULL)
     {
         printf("Realloc error");
         exit(1);
     }
     return newptr;
}

void resize(int** table, int* size)
{
        int* ptr;
        *size *= 2;
        printf("Reallocating to %d...\n", *size);
        ptr = (int*)Realloc(*table, *size*sizeof(int));
        if(ptr != NULL)
            table = ptr;
} 
```

我发现当我从 size = 2 开始时，我很早就崩溃了。但是，如果我从 3 开始更大，则很难复制错误。也许如果我尝试 j = 更高的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T23:32:03.323

From the `realloc` man page:

> ...returns a pointer to the newly allocated memory, which is suitably aligned for any kind of variable and **may be different from ptr**, or NULL if the request fails.

I believe the problem is that you're throwing away the return value of `realloc`, which could be an entirely different pointer from what you passed in.

I see that in your `resize` function you're trying to use the return value, but you have a bug in that function that ends up throwing the return value on the floor. Your `resize` needs to be:

```
int resize(long int** pTable, int* cursize)
{
    long int* ptr;
    *cursize *= 2;
    printf("Reallocating to %d elements...\n", *cursize);
    ptr = (long int*)Realloc(*pTable, (*cursize)*sizeof(long int));
    if(ptr != NULL)
        *pTable = ptr;
} 
```

and then call it this way:

```
if (line == cursize) resize(&table, &cursize); 
```

# extjs - 升级后的 ExtJS 4.1 布局问题

> ID：10710698
> 
> 赞同：1
> 
> 时间：2012-05-22T21:50:41.920
> 
> 标签：extjs, extjs4.1

从 ExtJS 4.0.7 升级到 4.1 后，我遇到了布局问题。面板中有五个字段（四个组合和一个日期选择器）。这是面板配置的相关部分：

```
defaults: {
    flex: 1,
    margin: '4',
    labelAlign: 'top'
},
layout: {
    type: 'hbox',
    align: 'top'
}, 
```

在 ExtJS 4.0.7 中，所有五个字段都以相同的宽度和每个字段的预期边距显示。在 ExtJS 4.1 中，布局计算似乎没有考虑文本字段右侧图标的宽度。

![在此处输入图像描述](../Images/78addb5494cf8f8087e607843266bff6.png)

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T00:35:05.203

嗯，也许还有其他可能导致问题的原因。实际上，这对我很有用：

```
Ext.create ('Ext.container.Container', {
    renderTo: Ext.getBody () ,
    layout: {
        type: 'hbox' ,
        align: 'top'
    } ,
    defaults: {
        flex: 1 ,
        labelAlign: 'top' ,
        margin: 4
    } ,
    items: [{
        xtype: 'combo'
    } , {
        xtype: 'combo'
    } , {
        xtype: 'combo'
    } , {
        xtype: 'combo'
    } , {
        xtype: 'datefield'
    }]
}); 
```

它适用于'margin：4'和'margin：“4”'。

# clojure - Clojure 惯用的 get-and-set 函数

> ID：10710704
> 
> 赞同：3
> 
> 时间：2012-05-22T21:51:16.000
> 
> 标签：clojure

在 Clojure 中编写 get-and-set 函数是否有比以下更惯用/可读的方式：

```
(def the-ref (ref {}))

(defn get-and-set [new-value]
  (dosync
    (let [old-value @the-ref]
     (do
       (ref-set the-ref new-value)
       old-value)))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:55:55.673

对于简单的情况，我倾向于直接使用此操作而不是包装在函数中：

```
hello.core> (dosync (some-work @the-ref) (ref-set the-ref 5))
5 
```

在这种情况下**`dosync`，通常用作**您正在寻找的包装器。这`dosync`很重要，因为 dosync 可以很好地与其他事务组合并使事务的边界可见。如果您处于包装函数可以完全封装对 ref 的所有引用的位置，那么 refs 可能不是最好的工具。

refs 的典型用法可能看起来更像是这样的：

```
(dosync (some-work @the-ref @the-other-ref) (ref-set the-ref @the-other-ref)) 
```

很少需要包装它，因为当使用 ref 时，它们通常以多个 ref 为一组使用，因为手头的问题需要协调更改。在它们只是一个值的情况下，原子更常见。

# php - 预匹配词

> ID：10710705
> 
> 赞同：1
> 
> 时间：2012-05-22T21:51:26.200
> 
> 标签：php, regex, preg-match

我有这个字符串。

```
$string = 'product_posting_list_name_1'; 
```

我正在使用它来查找匹配项，但没有找到匹配项。谁能向我解释为什么？我想匹配最后一个下划线和数字。

```
preg_match('/\bproduct_posting_list_name\b/', $string) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T21:53:35.393

`_`下划线[被认为是一个单词字符](http://www.regular-expressions.info/wordboundaries.html)，它位于您放置的边界*内*`\b`，而不是边界本身。您的正则表达式正在寻找边界之间的完整单词，但边界出现在`_1`.

要匹配它，您不能在右侧使用边界。

```
$string = "product_posting_list_name_1";
// Replace the right-side \b with a [\d]+ to indicate 1 or more digits, followed by the \b boundary.
preg_match('/\bproduct_posting_list_name_[\d]+\b/', $string); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:59:59.807

不是正则表达式，但有效：

```
$string = 'product_posting_list_name_1';
if (strpos($string, 'product_posting_list_name') === 0) { echo 'found'; } 
```

# javascript - 剔除参考错误 - 属性存在时未定义

> ID：10710707
> 
> 赞同：1
> 
> 时间：2012-05-22T21:51:41.020
> 
> 标签：javascript, knockout.js

我正在使用 JQuery 进行 AJAX 调用并从 MVC 控制器发送 JSON。当成功回调运行时，我将它传递给我的视图模型上的一个 observable。所以我在视图模型上有一个名为 list 的属性，我发送了这个 JSON：

```
{ Items: [ { .. }, { .. }] } 
```

模板和容器如下所示：

```
<div data-bind="template: {name:'Template', data:list}"></div>

<script type="text/html" id="Template">
    <section class="List">
            <ul id="MyList" data-bind="foreach:Items"> 
```

我尝试将此绑定到视图，但出现错误：

```
Microsoft JScript runtime error: Unable to parse bindings.
Message: ReferenceError: 'Items' is undefined;
Bindings value: foreach:Items 
```

Items 是正确的，它被正确地分配给了视图模型，并且我验证了 Items 属性确实不是未定义的。我在另一个视图中有相同的确切代码，但它在那里而不是在这里工作。知道为什么，这个错误是由什么引起的吗？

**编辑：**我有一个看起来像并且必然会这样的视图模型：

```
function viewModel() {
   var self = this;
   self.list = ko.observable(null);
}

$.ajax({
.
.
   context: model, //reference to view model, which is a valid reference
   success: function(d) {
     this.list(d);  //d is JSON laid out above
   }
}); 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T19:54:17.153

我不确定这意味着什么，但我认为你应该得到一个错误，因为 'd' 不是你上面的列表，它是你函数的参数。您不应该将视图模型存储在变量中并更改它：

```
 success: function(d) {
     d.list(d);  //d is JSON laid out above
 } 
```

对此：

```
 success: function(d) {
     viewModel.list(d);  // d is JSON laid out above
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T12:24:03.423

以下应该有效：

```
<div data-bind="template: {name:'Template', data:list}"></div>

<script type="text/html" id="Template">
    <section class="List">
            <ul id="MyList" data-bind="foreach:Items">
                <span data-bind="text: value"></span>
            </ul>
    </section>
</script> 
```

然后将其用作您的javascript：

```
function viewModel() {
   var self = this;
   self.list = ko.observable();

   self.init = function()
   {
       var data = { Items: [ { value: 1 }, { value: 2 }] }
       self.list(data);
   };

   self.init();
}

ko.applyBindings(new viewModel()); 
```

在`init`函数内部，您执行 ajax 调用并绑定数据。

# maven - Maven 对 MySQL 的依赖

> ID：10710709
> 
> 赞同：5
> 
> 时间：2012-05-22T21:52:05.677
> 
> 标签：maven, dependencies

我需要在 Maven 2 的帮助下指定 MySQL 数据库。在依赖项中，我应该使用什么样的 groupID 和 artifactID？

如何找到不同产品的 groupID 和 artifactID ？也就是说，我不知道那些对于 MySQL，或者它们不重要？它是如何工作的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-22T22:16:38.583

主 Maven 存储库位于 repo.maven.apache.org。[您可以在站点http://search.maven.org](http://search.maven.org)上搜索它（查找包）。搜索[mysql](http://search.maven.org/#search|ga|1|mysql)会出现 mysql-java-connector，这可能是您想要的。groupid 和 artifactid 列在搜索页面上。

# web-services - 仅使用 Web 服务连接到 CRM

> ID：10710713
> 
> 赞同：1
> 
> 时间：2012-05-22T21:52:34.343
> 
> 标签：web-services, dynamics-crm, sqlclr

有人可以指出我的方向，其中有一个示例，说明如何仅使用 Web 服务（例如发现和组织）而不使用 Microsoft 提供的任何 SDK 从 Microsoft Dynamic Online 2011 连接和检索数据。如果我不需要添加 System.ServiceModel 也很好。我查看了[Soap 示例](http://code.msdn.microsoft.com/windowsdesktop/CRM-Online-2011-WebServices-14913a16)，它仍然使用 Microsoft.Crm.Sdk.Samples。

我避免使用任何 SDK 或命名空间的原因是我正在尝试构建一个 SQL CLR，它可以在线连接到 CRM 并检索报告所需的数据。这些报告基于我的本地数据库和 CRM 数据。

谢谢大家的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T00:14:27.230

大多数数据都可以通过 oData/REST Web 服务获取（并且可以很好地表示关系）。您不需要任何特定的 SDK 或自定义代码，只要可以从 URI 读取 XML 或 JSON 格式的数据即可。

`[Your Organization Root URL]/XRMServices/2011/OrganizationData.svc`是您可以找到有趣的东西的地方。MSDN 上的文档位于[http://msdn.microsoft.com/en-us/library/gg334767.aspx](http://msdn.microsoft.com/en-us/library/gg334767.aspx)

# html - 如何将按钮向右移动？

> ID：10710716
> 
> 赞同：1
> 
> 时间：2012-05-22T21:52:51.637
> 
> 标签：html, css

我在[这里](http://helios.hud.ac.uk/u0867587/Mobile_app/QandATable2.php)有一个应用程序，当用户单击加号按钮时，它会显示一个模式窗口。

问题是我希望关闭按钮出现在窗口的右侧，与“以前的问题”标题在同一行。但它似乎根本没有向右移动。我究竟做错了什么？

下面是代码：

HTML：

```
<div class="previouslink">
<h1>PREVIOUS QUESTIONS</h1>

<button type="button" id="close" onclick="return closewindow();">Close</button>
</div> 
```

CSS：

```
#close{
    float:right;
    display:block;
    margin-right:0px;
    clear:left;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T21:56:51.663

由于 H1 是一个块元素，它占据了它所在行的所有宽度。这意味着 H1 元素后面的元素不能在同一行，即使`float`应用了 -property 也是如此。

您可以添加

```
position: absolute;
top: 0;
right: 0; 
```

到`#close`元素。或者为此元素添加负边距。除此之外，还可以将 a 添加`float: left;`到 H1 元素。请注意，这可能会导致某些浮动和换行问题。

也可以在 H1**之前**`#close`添加 -元素。这将防止 H1 占用其行中的所有空间，但会识别具有其空间的近距离元素。

 *** * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-22T21:57:08.170

`QandATableStyle2.css`您的文件中有错误。删除`;`后：

```
.previouslink{
display:none;   
}; 
```

它应该可以正常工作。`;`字符阻止`#close`加载定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T22:01:43.097

您可以应用`display: inline;`到`<h1>`元素，这将允许`<button>`（也内联）在同一行上呈现。

`clear: both;`请注意，如果您不希望以下内容渗入标题和按钮之间的空间，您可能需要设置以下元素的样式。

请参阅[此示例](http://jsfiddle.net/ZcyDz/5/)。**

# playframework - 自定义 CRUD 模块

> ID：10710719
> 
> 赞同：1
> 
> 时间：2012-05-22T21:53:23.650
> 
> 标签：playframework, crud

我正在为创建搜索引擎的应用程序使用 CRUD 模块。我想自定义模块，以便出现的搜索结果会将我重定向到另一个页面。我尝试了文档[http://www.playframework.org/documentation/1.1/crud](http://www.playframework.org/documentation/1.1/crud)但没有太大帮助。我正在关注这个视频来创建我的搜索引擎[http://geeks.aretotally.in/play-elastic-search-module-new-0-0-5-release-with-screencast](http://geeks.aretotally.in/play-elastic-search-module-new-0-0-5-release-with-screencast) ![![这是我搜索的屏幕截图，当我在这种情况下查看搜索结果时](../Images/4d23a05f85aa35bfdb6e63875939a916.png)

我的路线有问题，所以我想知道当我点击搜索结果将我重定向到另一个页面时我该怎么做

我已将此行添加到路线

GET /Tutorials/:id Tutorials.tutorialPage(tutId: Long)

我已经在控制器中有这个方法：

```
public static void tutorialPage(long tutId) {
        Tutorial t = Tutorial.findById(tutId);
        render(t);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T09:13:46.310

Play 的 CRUD 模块实际上是为了生成一个管理控制台。您存储在数据库中的内容可以直接编辑，可以添加新数据，也可以使用 CRUD 模块生成的页面删除您的数据。

如果要自定义由 CRUD 模块生成的页面，则需要更改 play/modules/crud 文件夹中的页面

![在此处输入图像描述](../Images/19cad9058d58c64f1c5cb21d74b2f616.png)

# ios - UISearchDisplayController 更改变暗的视图框架

> ID：10710728
> 
> 赞同：2
> 
> 时间：2012-05-22T21:54:11.310
> 
> 标签：ios, uitableview, uisearchdisplaycontroller

在我的 iPad 应用程序中，我有一个 UITableView。表格的框架尺寸小于屏幕尺寸，所以为了使搜索功能看起来不错，我必须调整 searchResultTableView 的框架以适合我的 TableView。我在我的 UISearchDisplayDelegate 的 -searchDisplayController:willShowSearchResultsTableView: 方法中执行此操作。

一切正常，除了调暗视图。当我开始搜索调光视图的宽度等于屏幕宽度：

![调光视图占据整个屏幕](../Images/c0ceee01cc52f5eb2ebd730de8b58424.png)

当我开始输入搜索字符串或清除文本字段时，我的 searchResultsTableView 会正确调整大小并且一切正常：

![搜索结果表格视图正确调整大小](../Images/fdd152b8e98afd6e5a6568a4901a2ba4.png)

![调光视图也被调整大小](../Images/c5b65415d846f9fb58902adf5d3ed2cd.png)

我尝试使用此行更改 -searchDisplayControllerWillBeginSearch: 方法内的 searchResultsTableView 框架

```
controller.searchResultsTableView.frame = myFrame; 
```

但它也不起作用。除了实现我自己的搜索显示控制器之外还有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T04:22:10.493

我还需要更改调光视图的框架，但出于不同的原因。在我的情况下，我以编程方式在常规 UIViewController 而不是 UITableViewController 中创建了 UISearchDisplayController 和 UISearchBar。我还使用了 MFSideMenu，这增加了问题的复杂性。最终发生的是调光视图最初处于正确位置，但下一次清除搜索时，调光视图向左和向上移动了其大小的一半。给定 UISearchDisplayController 你可以像这样找到调光视图。

```
for(UIView * v in controller.searchContentsController.view.subviews)
{
    if([v isMemberOfClass:[UIControl class]])
    {
        v.frame = newFrame; //This frame should account for the UISearchBar
    }
} 
```

要处理初始不正确的帧，您应该在此委托方法中更改它：

```
- (void) searchDisplayController:(UISearchDisplayController *)controller didShowSearchResultsTableView:(UITableView *)tableView; 
```

要在任何后续清除中处理不正确的帧，您应该在此委托方法中更改它：

```
- (void) searchDisplayController:(UISearchDisplayController *)controller didHideSearchResultsTableView:(UITableView *)tableView; 
```

注意：此解决方案贯穿 searchContentsController 的子视图，这是我使用 isMemberOfClass 而不是 isKindOfClass 的原因之一（UIButton 是 UIControl 的子类）。如果您将 UIControl 实例添加到您的视图中，则需要进一步区分（您可以使用标签来帮助确定哪些是您的）。

# javascript - DOM：判断anchorNode或focusNode是否在左侧

> ID：10710733
> 
> 赞同：3
> 
> 时间：2012-05-22T21:54:37.313
> 
> 标签：javascript, dom

这种方法...

```
window.getSelection().anchorNode 
```

...告诉我们文本的选择从哪里开始。

这种方法...

```
window.getSelection().focusNode 
```

...告诉我们文本选择在哪里结束。

由于文本可以选择从左到右或从右到左拖动，这并不能`anchorNode`推断`focusNode`.

可以使用什么 DOM/JavaScript 方法来确定哪个引用节点位于文本选择的左侧？

澄清：这是为了修复`startContainer()`方法（`window.getSelection().getRangeAt(0).startContainer`）的错误，因此这是一个无效的建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-22T22:00:30.097

您通常会在and上使用[Node.compareDocumentPosition()](https://developer.mozilla.org/en/DOM/Node.compareDocumentPosition)，“left”是道德上的等价物（当然，除非您有 RTL 文本）。我假设您实际上想知道文档中哪个排在第一位，而不是屏幕上的位置。像这样的东西会起作用：`anchorNode``focusNode``DOCUMENT_POSITION_PRECEDING`

```
let selection = window.getSelection();
let position = selection.anchorNode.compareDocumentPosition(selection.focusNode);
if (position & Node.DOCUMENT_POSITION_FOLLOWING)
  alert("Left-to-right selection");
else if (position & Node.DOCUMENT_POSITION_PRECEDING)
  alert("Right-to-left selection");
else
  alert("Only one node selected"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T23:09:12.460

我为此使用的一种方法是，将 DOM 范围的结尾设置为文档中比范围开头更早的点会折叠范围：

```
function isSelectionBackwards() {
    var backwards = false;
    if (window.getSelection) {
        var sel = window.getSelection();
        if (!sel.isCollapsed) {
            var range = document.createRange();
            range.setStart(sel.anchorNode, sel.anchorOffset);
            range.setEnd(sel.focusNode, sel.focusOffset);
            backwards = range.collapsed;
            range.detach();
        }
    }
    return backwards;
} 
```

# php - 需要在数据库列中追加数据

> ID：10710734
> 
> 赞同：0
> 
> 时间：2012-05-22T21:54:39.030
> 
> 标签：php, sql, legacy

我正在研究一个旧的遗留系统。它打破了从规范化到常识的各种规则，但可惜我坚持下去。话虽这么说，但它就可以了。

**问题：**

如何在不删除该字段中现有名称的情况下将名称附加到字段？另外，我该如何一遍又一遍地做到这一点？附加的名称相同，但我需要保持不变的不同名称对于数据库中的每一行都是唯一的。

**示例：名称列中的行：**

“唐尼/迈克/丹尼尔”

“唐尼/詹姆斯”

“史蒂夫”

**示例：名称列中脚本后的行：**

“唐尼/迈克/丹尼尔/迪”

“唐尼/詹姆斯/迪”

“史蒂夫/迪”

我认为 SQL 在这里还不够，我将不得不编写一个脚本。SO怎么想的？除了通常的令人作呕的感觉之外，您自然会从旧版应用程序中获得。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T21:58:11.690

下面是 SQL Server 中的语法：

```
update table
    set field = field+'/'+<newval>
where <i want the new val> 
```

在其他数据库中，连接操作可能是：set field = field || '/' || 设置字段 = concat（字段，'/'，）

# c++ - 使用 Eclipse 进行 C++ 解析

> ID：10710737
> 
> 赞同：1
> 
> 时间：2012-05-22T21:54:41.777
> 
> 标签：c++, eclipse, parsing

使用 Eclipse 可以完成什么级别的 C++ 解析以进行插件开发？我很想知道是否有一种方法可以访问 C++ 类类型、方法签名等，并使用我从原始类解析/读取/分析中收集的信息创建另一个类。

我看过许多 C++ 前端工具，例如 EDG、ROSE 和 CodeBoost，但它们看起来非常复杂（EDG 尽管很多人说它是最好的，但它有点超出我的价格范围），接下来我想of 是 Eclipse，因为我知道它可以为 Java 生成 AST，但我不知道它是否可以为 C++ 做同样的事情。我一直在寻找教程无济于事，所以我来这里寻求帮助/建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:01:58.470

编辑 5/23：

GIYF：提供给 Google 的短语“Eclipse C++ 解析器”在 CDT 文档中生成了这一行： [http ://wiki.eclipse.org/CDT/designs/Overview_of_Parsing](http://wiki.eclipse.org/CDT/designs/Overview_of_Parsing)

无论您选择哪种解析器，您都会发现涉及到处理它。它不是解析器机器；它的 C++ 本身。

CDT 确实解析 C++。我不知道它是否还支持 C++11。我知道有人尝试用它在 C++ 上构建重构工具，并且该过程产生了明显可用但不是很好的结果。问题之一是 CDT 显然无法修改其 AST。您必须发出某种文本补丁并重新处理源代码。

如果您检查过那组 C++ 解析器，您应该考虑我们的[C++11 前端](http://www.semanticdesigns.com/Products/FrontEnds/CppFrontEnd.html)。

它生成 AST 和符号表，以及控制流分析。它可以分析/转换代码，并重新生成可编译的源代码。它包括下面的通用转换机器，直接应用于树木。您不必发出补丁并重新解析。

PS：EDG和Rose真的是一样的；Rose 只使用 EDG。EDG 没有任何转型能力。罗斯确实有它，但它看起来很复杂，但后来我被自己的工具宠坏了。

# android - android上的网络不可知对等连接

> ID：10710742
> 
> 赞同：2
> 
> 时间：2012-05-22T21:55:12.850
> 
> 标签：android, ios

我需要在两部安卓手机之间建立一个实际的 TCP 连接，或者至少能够使用小负载（每条消息最多 20kb )

这需要工作

*   未启用 wifi、蓝牙或 nfc（即超过 2/3/4G）
*   在 Andriod 手机之间，最好在 Android 和 IO 之间以及 iphone 之间
*   不需要第三方服务器，最好不需要我运行服务器

我非常愿意让某人扫描二维码来“配对”手机或交换基本标识符。

除了设置自己的服务器并运行一些网络打孔解决方案以在两个设备之间打开 TCP 或 UDP 流之外，我还能做些什么更好的事情？

如果没有，最好的安卓网络打孔解决方案是什么？

什么似乎不起作用：

*   谷歌的[C2DM](https://developers.google.com/android/c2dm/sta)推送通知似乎是为了让服务器到设备的消息传递来触发拉取。

*   [Alljoyn](https://www.alljoyn.org/)在消息传递方面似乎完全符合我的要求，只是它似乎要求用户启用 wifi 或蓝牙。这个想法是避免使用蜂窝调制解调器。

*   [Android 通过这个](http://developer.android.com/reference/android/net/wifi/p2p/package-summary.html)api 原生支持 WiFI ，但这又是一个非首发。

*   最后，还有[Bump](http://bu.mp/api) api，它几乎可以满足我的所有需求，但需要第三方服务器。由于服务器会了解人们何时使用该应用程序，因此出于隐私原因，这是不可行的。

# java - 使用空格键触发 JButton，或者输入键，或者鼠标点击

> ID：10710748
> 
> 赞同：4
> 
> 时间：2012-05-22T21:55:41.260
> 
> 标签：java, swing, jbutton, key-events

我正在尝试获得一个带有单个按钮的简单 JFrame，以在发生任何这些事件时触发事件：

*   按下 Enter 键并且 JButton 具有焦点
*   按下空格键并且 JButton 具有焦点
*   单击 JButton。

似乎 Enter 和 Spacebar 是“免费”的，以及使用 JButton 上的 addActionListener 的默认鼠标点击；麻烦的是，我读过键绑定取决于使用的外观。

我试图通过在 JButton 的动作映射中添加 Enter 和空格键来获得跨 LaF 的通用行为，甚至添加了一个随机键（“m”）以确保 ActionMap 正在完成工作（它是），但现在鼠标点击丢失。我似乎能够获得所有键和鼠标点击的唯一方法是同时使用动作映射和 addActionListener。

有没有办法让这些键和鼠标绑定在所有 LaF 中一致地工作，而无需尝试检测可能出现的所有可能的 LaF？我可以注册一个会同时触发键和鼠标事件的动作监听器吗？

我最喜欢的解决方案是将鼠标单击添加到 JButton 动作映射并检测在动作内部发生的键或鼠标单击。

我仍然在这里学习绳索，所以这可能不是最好或最有效的做事方式；我敢肯定它是过度设计的。这是一种训练练习，我正在尝试所有我能得到的东西。欢迎任何和所有编码风格的评论！

```
import java.awt.EventQueue;
import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;

import javax.swing.AbstractAction;
import javax.swing.Action;
import javax.swing.InputMap;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.KeyStroke;
import javax.swing.UIManager;

public class Example extends JFrame {

// ============================
private class BtnListener extends AbstractAction {
    private static final long serialVersionUID = 1L;

    public void actionPerformed(ActionEvent ae) {
        System.out.println("\nclick button listener triggered");
        System.out.println(ae.getSource().getClass().toString());
    }
} // class BtnListener

private static final int NO_MODIFIER = 0;
private static final boolean ON_KEY_PRESS = false;
private static final KeyStroke ENTER_PRESSED = KeyStroke.getKeyStroke(
        KeyEvent.VK_ENTER, NO_MODIFIER, ON_KEY_PRESS);
private static final KeyStroke M_PRESSED = KeyStroke.getKeyStroke(
        KeyEvent.VK_M, NO_MODIFIER, ON_KEY_PRESS);
private static final KeyStroke SPACEBAR_PRESSED = KeyStroke.getKeyStroke(
        KeyEvent.VK_SPACE, NO_MODIFIER, ON_KEY_PRESS);
private JButton btnButton;
private final AbstractAction btnListener = new BtnListener();
private JPanel buttonPanel;
private JFrame frmMain;

public static void main(String[] args) {
    Example ex = new Example();
    ex.displayFrame();
}

Action btnActionListener = new AbstractAction() {
    private static final long serialVersionUID = 1L;

    public void actionPerformed(ActionEvent e) {
        System.out.println("\nkey button action triggerred");
        System.out.println(e.getSource().getClass().toString());
        if (e.getSource() instanceof JButton) {
            System.out.println("button");
        } else {
            System.out.println("Something else");
        }
    }
};

public Example() {
    initialize();
}

public void displayFrame() {
    try {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
    } catch (Throwable e) {
        e.printStackTrace();
    }
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            try {
                frmMain.setVisible(true);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    });
}

private void initialize() {

    frmMain = new JFrame();
    btnButton = new JButton("Abutton");

    // Comment this out, you lose the mouse click
    btnButton.addActionListener(btnListener);

    // Comment out ActionMaps, but keep addActionListner (above), and
            // only lose M_PRESSED
    InputMap buttonFocusedMap = btnButton
            .getInputMap(JComponent.WHEN_FOCUSED);

    buttonFocusedMap.put(ENTER_PRESSED, "blah");
    btnButton.getActionMap().put("blah", btnActionListener);

    buttonFocusedMap.put(SPACEBAR_PRESSED, "blort");
    btnButton.getActionMap().put("blort", btnActionListener);

    buttonFocusedMap.put(M_PRESSED, "gaaak");
    btnButton.getActionMap().put("gaaak", btnActionListener);

    // Is there a way to add a mouse click to the ActionMap?

    buttonPanel = new JPanel();
    buttonPanel.add(btnButton);

    frmMain.getContentPane().add(buttonPanel);
    frmMain.setBounds(100, 100, 500, 432);
    frmMain.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
}

} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T01:08:38.233

`BasicButtonListener`，由 使用`BasicButtonUI`，确保*所有*按钮（检查、单选、切换）`Space`在聚焦时都绑定到。这适用于跨平台，即使单个外观可能会唯一地呈现各种按钮模型状态。按压`Space`唤起被*按压* `UIAction`，释放`Space`唤起被*释放* `UIAction`。当在按钮范围内按下和释放鼠标时也会发生同样的情况；按住时在按钮外部拖动以查看武装状态变化。

在任何一种情况下，*按下*和*释放*的组合都会调用按钮的`actionPerformed()`方法。

`Enter`无论焦点如何，绑定到 的一种便捷方法`Action`是通过根窗格的[`setDefaultButton()`](http://docs.oracle.com/javase/6/docs/api/javax/swing/JRootPane.html#setDefaultButton%28javax.swing.JButton%29)方法。此[示例](https://stackoverflow.com/a/7457102/230513)说明了单击按钮的所有三种方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T22:00:35.970

您可以（并且可能应该）做的是创建一个 AbstractAction。您可以将 AbstractAction 用于您的 ActionMap 以及单击（执行 JButton.setAction(...)）

# objective-c - 弹出 Facebook 提要 iOS

> ID：10710749
> 
> 赞同：0
> 
> 时间：2012-05-22T21:55:43.460
> 
> 标签：objective-c, ios, xcode

我正在尝试将 Facebook sdk 实现到我的应用程序中，但在显示写入墙/提要弹出窗口时遇到问题。我可以从我的应用程序成功登录 Facebook。首先它把我带到本机 Facebook 应用程序，一旦我授权它，它就把我带回我的默认应用程序，没有任何反应。该对话框没有出现，我看到的只是我创建的空视图。这是我的代码，如果有人知道为什么这不起作用，我将不胜感激。

谢谢

**fbViewController.h**

```
#import <UIKit/UIKit.h>
#import "FBConnect.h"

@interface fbViewController : UIViewController <UIApplicationDelegate,FBSessionDelegate,FBDialogDelegate>
{
 Facebook *facebook;
}

@property (nonatomic, retain) Facebook *facebook;
@end 
```

**fbViewController.m**

```
#import "fbViewController.h"
#define kAppId @"xxxxxxx"

 - (void)viewDidLoad
{
[super viewDidLoad];

facebook = [[Facebook alloc] initWithAppId:@"xxxxxxxxxxx" andDelegate:self];

NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
if ([defaults objectForKey:@"FBAccessTokenKey"] 
    && [defaults objectForKey:@"FBExpirationDateKey"]) {
    facebook.accessToken = [defaults objectForKey:@"FBAccessTokenKey"];
    facebook.expirationDate = [defaults objectForKey:@"FBExpirationDateKey"];
}

if (![facebook isSessionValid]) {
    [facebook authorize:nil];
}

}

 - (void)fbDidLogin {
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
[defaults setObject:[facebook accessToken] forKey:@"FBAccessTokenKey"];
[defaults setObject:[facebook expirationDate] forKey:@"FBExpirationDateKey"];
[defaults synchronize];

NSMutableDictionary* params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                               kAppId, @"app_id",
                               @"http://developers.facebook.com/docs/reference/dialogs/", @"link",
                               @"http://fbrell.com/f8.jpg", @"picture",
                               @"Facebook Dialogs", @"name",
                               @"Reference Documentation", @"caption",
                               @"Using Dialogs to interact with users.", @"description",
                               nil];

[facebook dialog:@"feed" andParams:params andDelegate:self];

  } 
```

**myAppDelegate.m**

```
// Pre iOS 4.2 support
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url {
   return [facebook handleOpenUrl:url];
  }

// For iOS 4.2+ support
-(BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {
return [facebook handleOpenURL:url]; 
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T02:05:31.350

我为此挣扎了一段时间。[这是](https://stackoverflow.com/questions/10036624/facebook-sso-in-ios5)我在尝试解决问题时发布的 SO 问题。实施 dmirkitanov 在他的回答中建议的测试可能是值得的。它来自 Hackbook 应用程序（您使用 facebook-ios-sdk 获得的应用程序）。

长话短说，我要做的就是从 Facebook 开发者网站中删除我的应用程序，从 iTunes 商店中删除它，然后从第一方重新提交，然后在我的代码中使用新的应用程序 ID 信息等。我认为它在 Facebook 端的注册方式存在一些问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-22T23:20:53.263

看来，AppId 不正确。尝试使用另一个应用程序 ID 并检查

1) Info -> FacebookAppID 与您的代码中的此应用程序 ID 相同

# php - 外汇日历中的 RSS API

> ID：10710758
> 
> 赞同：0
> 
> 时间：2012-05-22T21:56:45.217
> 
> 标签：php, rss, calendar, forex

如何使用 PHP 将其集成到我的网站中？

[http://www.forex-tsd.com/fxcalendar.php?p=csv](http://www.forex-tsd.com/fxcalendar.php?p=csv)

并得到这个结果：

[http://www.forex-tsd.com/fxcalendar.php?p=calendar&objID=4](http://www.forex-tsd.com/fxcalendar.php?p=calendar&objID=4)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T00:36:18.813

所以我认为您已经知道如何获取所需信息的 csv。PHP Classes 有很多可以用来解析 csv 文件的类。它们有很多，所以选择你最喜欢的一个。

有用于解析和读取的类，以及将 csv 导入数据库的类。

[http://www.phpclasses.org/search.html?words=csv&go_search=1&x=0&y=0](http://www.phpclasses.org/search.html?words=csv&go_search=1&x=0&y=0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T15:47:10.077

我使用`explode();`php 函数解决了它来剪切接收到的数据。

# android - Android：有没有办法使用 Google 地图 API 来显示位置和指示方向？

> ID：10710760
> 
> 赞同：-2
> 
> 时间：2012-05-22T21:56:48.327
> 
> 标签：android

我的老板希望我制作一个应用程序，显示您所在位置和目的地的 GOOGLE 地图，并在其下显示路线。

我查看了 api，似乎它只是绘制地图并允许您在其上标记位置。我在想，如果我可以从经度和纬度中获取地址，也许我可以使用网络上的谷歌地图来指示方向？？？？？？和想法？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T22:09:30.457

Android 的 google API 只允许您标记位置、图像和点，它不能用作 GPS，尽管您可以使用 Geocoder API（也来自 google）从某个地方获取经度和纬度，反之亦然。如果您想知道如何从一个地方到达另一个地方，请使用 Google API（并非专门针对 Android），尽管您会收到 xml 或 json 格式的数据。祝你好运！

# ant - 如何使用 FDT 5.5 构建模块化 AIR 应用程序

> ID：10710765
> 
> 赞同：1
> 
> 时间：2012-05-22T21:57:09.277
> 
> 标签：ant, air, fdt

既然 FDT 不再支持来自 AIR 项目的 fdt.launch.Application，那么如何为 AIR 应用程序构建模块呢？您不能只创建多个 AIR 启动配置，因为几乎所有属性都是在项目属性中设置的，而不是在启动配置中设置的。我真的必须为每个模块创建一个新项目吗？当您曾经能够使用一个项目和一个 Ant 脚本时，一个应用程序拥有 20 个项目似乎非常混乱。

这是我可能使用的示例 build.xml 文件的链接： [build.xml](http://dl.dropbox.com/u/7773319/build.xml)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:06:36.633

使用 FDT 5.5，您不能通过仅使用 FDT 的 ANT 任务或启动器来使用您提到的工作流程。FDT 团队正在寻求进行调整，以便能够做到这一点。

在下一个（即将推出的）次要版本之前，您有三个选择：

1.  为每个模块创建一个新的 AIR 项目并使用 Launcher Chain。这方面的技术（以及为什么会这样）在其他两个 stackoverflow 问题中进行了描述，[here](https://stackoverflow.com/questions/10707457/how-can-i-have-multiple-descriptor-files-for-one-air-target-in-fdt-5-5)和[here](https://stackoverflow.com/questions/10695831/how-can-i-use-fdt-launch-application-for-air-projects-fdt-5-5)。
2.  创建另一个不是 AIR 项目的项目，并使用它来容纳您的模块。
3.  创建自定义项目类型

## 每个模块的 AIR 项目

为每个模块创建一个项目并不像看起来那么不寻常。这实际上是 Java 世界中建议的工作流程，许多大型团队都以这种方式工作。他们通常会有一个包含 10-50 个模块的项目，并且每个模块都有 1-2 名开发人员工作。对于小型团队单人商店，这可能没有意义。

## 创建另一个不是“AIR”项目的项目（例如 Web 项目）

您可能能够创建另一个不是 AIR 项目的项目并使用它来编译您的模块。如果您不使用 AIR API，这很容易；但是，如果您是，请尝试调整您的 SDK 设置

## 创建自定义项目类型

这有点小技巧，不推荐用于一般用途；但是，它将解决您的问题。您可以使用“被破解”的自定义项目类型来使用 AIR SDK 和 API，但可以像 Web 项目一样启动。要使用它，请将其放在您的 FDT 项目类型文件夹中：

对于 OSX，将其放置在：/Users/[您的用户名]/Library/Application\ Support/FDT/projectTypes

...然后重新启动 FDT。接下来创建一个简单的 Web 项目，然后右键单击 >Flash 项目>设置项目类型并选择这个新项目类型。我叫我的“空气模块”

这是要下载的[示例项目类型](https://docs.google.com/folder/d/0B3WnAIjk6Fw9T1lqVGFxNDN0LU0/edit#)：

# ruby-on-rails-3.2 - collection_select - 不明白如何编写语句

> ID：10710769
> 
> 赞同：0
> 
> 时间：2012-05-22T21:57:19.637
> 
> 标签：ruby-on-rails-3.2, drop-down-menu

我一直在 Stack Overflow、[http://api.rubyonrails.org/](http://api.rubyonrails.org/)和其他地方的 Rails 文档中查看很多帖子。我对应该传递多少个参数感到非常困惑。我看过4和5。这就是我想做的。

我有一个带有国家名称的表格，我想使用另一个带有国家列表的表格将其更改为下拉列表。

我表单上的当前代码是：

```
<%= f.text_field :country %> 
```

国家在另一个表用户上。而不是让人们输入国家，我希望他们从表中选择国家列表**名称**而不是表中的 id，然后使用表中的**名称**来更新表用户上的**国家**。

我仍在学习当前的数据库术语。我习惯于使用数据库、数据库中的表、表中的记录/行、记录上的 field.column 等。

我将如何编码 collection_select 语句以从另一个表中生成国家名称列表？

我几乎整天都花了几个小时试图弄清楚这一点。不知何故，我能够弄清楚如何使用 seed.rb 来加载我的 Country 表。

我正在使用 Rails 3.2.3 和 Ruby 1.9.3。我正在使用 PostgreSQL 数据库。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T22:55:21.700

根据是否设置了与另一个表的正确关系“例如 belongs_to 或 has_many”，您可以执行类似的操作。

```
<%= collection_select(:some_other_active_record, :country, Country.all, :id, :name)  %> 
```

应该呈现为

```
<select name="some_active_record[country_id]">
   <option value="1">USA</option>
   <option value="2">Canada</option>
   <option value="3">Mexico</option>
   [...]
</select> 
```

您应该阅读此页面[http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/collection_select](http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/collection_select)

第一个参数是类的实例（“Active Record / table”），用于表单的选择标签。

第二个是方法调用，以获取与选择标签对应的对象属性，例如国家如何属于_您的主要活动记录，即“country_id / contry_ids”

第三个参数是代表标签的对象数组。基本上你所有的国家，即..“Country.all”

第四个是方法的名称，当在集合的成员上调用该方法时，会返回代表标签的子对象数组。基本上是用 Country.all 找到的国家实例的 id，它被放入 html value="some country id"

下一个参数是如何显示国家名称。

接下来是一组选项，我不打算赘述。

# javascript - ！JavaScript 中的运算符

> ID：10710770
> 
> 赞同：16
> 
> 时间：2012-05-22T21:57:23.067
> 
> 标签：javascript, operators

我现在很困惑！JavaScript 中的运算符。我的理解是！运算符仅对布尔值进行操作。但是对我的一个[答案](https://stackoverflow.com/a/8876061/929701)的评论说它可以对任何东西进行操作并返回一个布尔值，这在我做了一些测试后恰好是真的。

```
alert(!undefined); //true
alert(!function(){}); //false
alert(!{}); //false
alert(!null); //true
alert(!()); //crash
alert(!"false"); //false
alert(!false)​;​​​​​​​​​​​​ //true​​​​​​​​​​​​​​​​​​ 
```

有人可以帮我概括一下！操作员。

**编辑**

更令人困惑的东西：

```
​alert( new String() == ""); //true
alert(!""); //true
alert(! new String()); //false 
```

如何？​</p>

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-22T21:58:35.500

`!`做你想的事：从真到假，反之亦然。奇怪的行为与 Javascript 如何将任何内容转换为`true`或`false`.

[http://11heavens.com/falsy-and-truthy-in-javascript](http://11heavens.com/falsy-and-truthy-in-javascript)

就像在 C 中一样（只有更糟），所有值都可以提升为 true 或 false。您想要的谷歌搜索术语是“真实”和“虚假”或“真实”和“虚假”。Truthy 表示某事转换为 true，falsy 表示某事转换为 false。`null`除了, `undefined`, `0`, `""`, `NaN`, 和...之外，所有值都是真实的`false`

这个链接有更多有趣的例子：

[http://www.sitepoint.com/javascript-truthy-falsy/](http://www.sitepoint.com/javascript-truthy-falsy/)

这个网站真的很喜欢用这里的有趣行为做病态的事情：

[http://wtfjs.com](http://wtfjs.com)

另请注意，`==`确实努力使事物具有可比性，而如果事物不可比，则`===`只会返回。`false`Crockford in *Javascript: The Good Parts*建议不要`==`完全使用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-22T22:11:04.833

这与其说是一个函数，`!`不如说是`true`javascript 中存在或不存在的函数。如果您熟悉强制转换，将变量强制转换为特定类型，那么您应该清楚以下内容。

`!`仅对布尔值进行操作。因此，您应用它的任何不是 boolean 的变量在应用之前首先被强制为 boolean `!`。将此与您的示例相关联：

```
Boolean(undefined) == false 
```

undefined 有点像 javascript 中的 null （有一些差异，但这是一个不同的主题）。布尔等效项应该是有意义的`false`。`undefined`不仅没有价值，它还声明您尝试使用的变量甚至不存在。

```
Boolean(function(){}) == true 
```

函数是javascript中的对象。即使它是空的，它仍然具有函数对象共有的一些基本属性，因此它的布尔等效项是`true`. 这不是什么，所以它是一些东西。

```
Boolean({}) == true 
```

像一个空函数，`{}`定义一个空对象。但是，它仍然具有 javascript 中对象共有的一些属性。它根本没有自定义属性。

```
Boolean(null) == false 
```

正如我提到的`undefined`，`null`是相似的，但并不完全相同。它表明没有价值。

```
Boolean(()) // error 
```

`()`对他们自己没有任何意义。您需要它们之间的一些东西来使语法正确，因此这与您的假/真问题无关。`()`单独只是一个语法错误。

```
Boolean("false") == true 
```

`"false"`是一个字符串。仅仅因为它包含字母 f,a,l,s,e 并不能使其与布尔值相同`false`。非空字符串是某种东西，因此会强制转换为 Boolean `true`。注意字符串是一种特殊的对象，因为空字符串`""`强制转换`false`为空对象，`{}`如前所述，强制转换为`true`。

布尔（假）==假

这个应该很清楚。 `false`已经是一个布尔值，所以转换它不会改变它的值。还是`false`。

从那里，您可以看到应用`!`到每个案例将如何给您带来您所看到的结果。

为了进一步阅读，这是一篇关于 javascript 中类型强制的[非常好的文章](http://webreflection.blogspot.com/2010/10/javascript-coercion-demystified.html)

**更新：**

关于你的`String`问题。`String`对象和字符串文字（用引号括起来的东西）之间存在差异。您可以从字符串文字创建`String`对象，但文字不会自动成为对象。javascript中的数字也是如此。JS 有一个`Number`对象，但您通常会定义数字文字。的行为`Number`与您所看到的一致`String`：

```
alert( new Number() == 0); //true
alert(!0); //true
alert(! new Number()); //false 
```

但是，正如您在评论中敏锐地提到的那样：

```
alert( new String() === ""); //false 
```

由于类型不一样；对象与文字。

通常，`Boolean(some_object)`将始终评估为`true`但取决于确切的值，`Boolean(some_literal)`可能评估为假。

**附录**

仅仅因为本周早些时候我在脚上开枪，我认为这将是一个有用的信息。在大多数语言中，一个空数组`[]`, 将被强制转换为`false`. 但是，在 Javascript 中，数组是对象，因此即使是空数组也会强制转换为`true`. 一个要提防的。在 js 和各种服务器端语言之间切换时，很容易出现错误，`if(!maybe_empty_array){...}`因为永远不会通过，因为`maybe_empty_array`总是会强制转换为`true`. 相反，您应该这样做`if(maybe_empty_array.length){...}`。如果数组为空，则其长度为 0，可以安全地强制转换为`false`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-22T22:03:24.250

*“有人可以帮我概括一下！操作员的行为。”*

当然。如果其单个操作数可以转换为 true，则返回 false；否则，返回真。

任何对象（包括“空”对象、`{}`或函数）、任何非空字符串和任何非零数都可以转换为真。另一方面，null、undefined、空字符串和零都将被转换为 false。然后`!`运算符返回相反的结果，因此您在问题中显示的结果。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-22T22:02:53.363

！如果其单个操作数可以转换为 true，或者它是非布尔值，则返回 false：

```
!(x == y)
!"something" 
```

如果其操作数可以转换为 false，则为 true：

```
!(x > y) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T22:51:57.597

很难写出比这更笼统的解释：

```
var arr = [0, "", false, null, undefined, NaN];

for(var i = 0; i < 6; i++){
    console.log(!(arr[i]));//always true
} 
```

任何其他值都会产生`false`

# java - 将 http servlet 与 Java 中的其他 TCP 服务器相结合

> ID：10710772
> 
> 赞同：0
> 
> 时间：2012-05-22T21:57:38.827
> 
> 标签：java, http, servlets, tcp, integration

是否可以让 Java 应用程序通过 servlet 侦听 HTTP 请求并同时侦听其他 TCP 端口？有没有标准的方法来做到这一点？

谢谢，
曼努埃尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T20:48:51.150

实现此目的的一种方法是将 Jetty 嵌入到您的主应用程序中。这是一个[教程](http://wiki.eclipse.org/Jetty/Tutorial/Embedding_Jetty)。

使用嵌入式 Jetty servlet 容器，您可以运行标准 Java Web 应用程序 (WAR)。同时在您的主应用程序中，您可以通过[ServerSocket](http://docs.oracle.com/javase/6/docs/api/java/net/ServerSocket.html)监听其他 TCP 端口。

# c# - 任何等效的绑定，如 wsDualHttpBinding，它适用于 WIF 以实现联合安全性？

> ID：10710773
> 
> 赞同：1
> 
> 时间：2012-05-22T21:57:43.223
> 
> 标签：c#, wcf, wcf-binding, wif

我正在寻找设置一个 wsDualHttpBinding wcf 端点来提供 WCF 事件。但是，我的应用程序的其余部分使用 WIF 通过 Claims 安全性提供 authN/authZ 支持。对于那些受 WIF 保护的端点，我使用的是 WS2007FederationHttpBinding

是否有任何预先存在的绑定，如 WS2007FederationHttpBinding，除了双工支持？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:53:52.407

似乎联合 wcf 没有双工绑定。

因此，我现在的计划 B. 使用现有的 WS2007FederationHttpBinding，并创建一个长轮询 WCF 操作来模拟双工行为。这种方法的一个好处是它的防火墙友好。

# ruby-on-rails - 在 Rails 中存储常量

> ID：10710777
> 
> 赞同：0
> 
> 时间：2012-05-22T21:58:06.423
> 
> 标签：ruby-on-rails, constants

我来自Java背景。我想知道是否有办法拥有一个存储常量值的类。

具体到我的问题，我想知道我是否可以有类似的东西：

```
@user.authentications.create(:uid => "12345", :provider => Provider::FACEBOOK) 
```

Provider 类存储了所有的静态常量。另外，这是在 Ruby on Rails 中执行此操作的正确方法吗？

**额外信息：** 我尝试了上述方法

```
class Provider
  FACEBOOK = "facebook"
  TWITTER = "twitter"
end 
```

但它给出了错误：

```
NameError:
       uninitialized constant Provider 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T22:05:25.283

选项 1（类变量）：

```
class Provider
  @@FACEBOOK = "facebook"
  @@TWITTER = "twitter"
end

@user.authentications.create(:uid => "12345", :provider => Provider.FACEBOOK) 
```

尽管在某些情况下，强烈建议不要使用类变量。更好的方法是使用元巫术：

```
class Provider
  @FACEBOOK = "facebook"
  @TWITTER = "twitter"

  class << self
    attr_reader :FACEBOOK, :TWITTER
  end
end

@user.authentications.create(:uid => "12345", :provider => Provider.FACEBOOK) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T22:32:39.840

## 如果您想保留上面的实现

尝试`Provider::FACEBOOK`用双冒号作为前缀

```
::Provider::FACEBOOK 
```

这设置了一个绝对路径，因此 Ruby 不会尝试在当前上下文/类/控制器中查找常量。（我的假设是现在它认为常量是在 中定义的`UserController::Provider::FACEBOOK`）

## 更多 Rails 风格

有许多其他帖子关于将常量放在哪里，所以请查看：

*   [声明 Rails 模型子类的静态属性](https://stackoverflow.com/questions/10438647/declaring-static-properties-of-rails-model-subclasses/)
*   [我将在哪里存储 Rails 应用程序中的静态/常量值？](https://stackoverflow.com/questions/10607063/where-would-i-store-static-constant-values-in-a-rails-application/)

基本上，把常量放在你真正需要的地方。无论是在控制器/模型中，还是在`environment.rb`您想在任何地方访问它们时都可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T18:36:48.710

如果您在模型文件中声明该类，那么它将是可访问的。如果您在 lib 文件中声明，那么您在 application.rb 文件中添加了一行

```
config.autoload_paths += %W(#{config.root}/lib) 
```

# java - Derby + Hibernate Embedded DB 问题与 Netbeans 反向工程

> ID：10710782
> 
> 赞同：0
> 
> 时间：2012-05-22T21:58:36.360
> 
> 标签：java, hibernate, netbeans

我有一个 JavaSE 项目，使用嵌入式 Derby/JavaDB 数据库。如何让它在可用表下显示 APP 架构中的表？

在服务下设置连接后，我可以创建/连接并手动使用 derby。效果很好。

现在我正在尝试将休眠添加到项目中，并且需要设置我的休眠配置。这是我的配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
  <session-factory>
    <property name="hibernate.connection.driver_class">org.apache.derby.jdbc.EmbeddedDriver</property>
    <property name="hibernate.connection.url">jdbc:derby:studydata</property>
    <property name="hibernate.connection.username">user</property>
    <property name="hibernate.connection.password">pass</property>
    <property name="hibernate.show_sql">true</property>
    <property name="hibernate.dialect">org.hibernate.dialect.DerbyDialect</property>
    <property name="hibernate.query.factory_class">org.hibernate.hql.classic.ClassicQueryTranslatorFactory</property>
  </session-factory>
</hibernate-configuration> 
```

reverse eng插件似乎不起作用，它运行，没有显示错误，但也显示没有可用的表。

日志文件：

```
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: Initializing Custom Classloader with classpath : 
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Users/nycynik/Documents/java/db-derby-10.8.2.2-bin/lib/derby.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/antlr-2.7.6.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/asm.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/asm-attrs.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/cglib-2.1.3.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/commons-collections-2.1.1.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/ide/modules/ext/commons-logging-1.1.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/dom4j-1.6.1.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/ehcache-1.2.3.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/jdbc2_0-stdext.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/jta.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate3.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-tools.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-annotations.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-commons-annotations.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-entitymanager.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/javassist.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/ejb3-persistence.jar!/
INFO [org.netbeans.modules.hibernate.service.spi.HibernateEnvironmentImpl]: Direct Database connection established.
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: Initializing Custom Classloader with classpath : 
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Users/nycynik/Documents/java/db-derby-10.8.2.2-bin/lib/derby.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/antlr-2.7.6.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/asm.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/asm-attrs.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/cglib-2.1.3.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/commons-collections-2.1.1.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/ide/modules/ext/commons-logging-1.1.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/dom4j-1.6.1.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/ehcache-1.2.3.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/jdbc2_0-stdext.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/jta.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate3.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-tools.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-annotations.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-commons-annotations.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-entitymanager.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/javassist.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/ejb3-persistence.jar!/
INFO [org.netbeans.modules.hibernate.service.spi.HibernateEnvironmentImpl]: dbDriver loaded.
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: Initializing Custom Classloader with classpath : 
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Users/nycynik/Documents/java/db-derby-10.8.2.2-bin/lib/derby.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/antlr-2.7.6.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/asm.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/asm-attrs.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/cglib-2.1.3.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/commons-collections-2.1.1.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/ide/modules/ext/commons-logging-1.1.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/dom4j-1.6.1.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/ehcache-1.2.3.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/jdbc2_0-stdext.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/jta.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate3.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-tools.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-annotations.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-commons-annotations.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/hibernate-entitymanager.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/javassist.jar!/
INFO [org.netbeans.modules.hibernate.util.CustomClassLoader]: jar:file:/Applications/NetBeans/NetBeans%207.0.1.app/Contents/Resources/NetBeans/java/modules/ext/hibernate/ejb3-persistence.jar!/
INFO [org.netbeans.modules.hibernate.service.spi.HibernateEnvironmentImpl]: Direct Database connection established. 
```

我唯一能想到的是模式？表格位于 APP 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:25:18.230

好的 - 我只是继续使用向导，它允许我在不选择表的情况下完成。

然后我像没事一样继续前进，并在数据库上使用了 POJO 创建向导，并且它起作用了。

我不知道为什么我不能像使用其他数据库那样选择表，但无论哪种方式都有效。

# android - Android：在 AsyncTask 中传递字符串参数？

> ID：10710785
> 
> 赞同：0
> 
> 时间：2012-05-22T21:58:47.960
> 
> 标签：android, rss, android-asynctask

我正在实现一个 Android 应用程序来加载 RSS 提要。在我决定添加一个新屏幕来显示两个按钮并尝试将字符串值传递给 AsyncTask 之前，它工作得非常好。想法是这样的：屏幕将显示两个按钮供用户选择。一旦用户单击其中一个按钮，它将调用 AsyncTask 以及字符串 value(url) 来读取RSS(url)，然后通过 displayRSS(url) 显示 rss 提要。readRSS(url) 将相应地加载 RSS 提要。

我的代码如下：

```
import java.util.List;
import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.widget.TextView;
import android.widget.Toast;

public class RSSProActivity extends Activity {

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.rss);
        startLoadRSS();

    }

    private void startLoadRSS(){
        new RSS_Load().execute();
    }

    //
    private void preReadRSS()
    {
        Toast.makeText(this, "Reading RSS, Please wait.", Toast.LENGTH_LONG).show();
    }

        private StringBuffer readRSS(String url)
        {
            //depends on the inputs, will set the String value accordingly. It should be "url" but using the default value at the moment.

            String urlStr = "http://www.bom.gov.au/fwo/IDZ00059.warnings_vic.xml";
            AndroidSAXFeedParser saxFeedParser = new AndroidSAXFeedParser(urlStr);
            List<RSSItem> parse = saxFeedParser.parse();
            StringBuffer sb = new StringBuffer();
            sb.append(parse.size()+" items found");
            for(RSSItem item:parse){
                sb.append(item.getTitle()+"posted at "+item.getDate());
                sb.append(item.getDescription());
            }
            return sb;
        }

        private void displayRSS()
        {
            StringBuffer sb = readRSS(url);
            TextView textView = new TextView(this);
            textView.setText(sb.toString());
            setContentView(textView);
            Toast.makeText(this, "SUCCESS", Toast.LENGTH_LONG).show();
        }

        //AsyncTask
        public class RSS_Load extends AsyncTask<Void, Void, Void>{
           @Override
           protected void onPreExecute() {
              super.onPreExecute();
              preReadRSS();
           }

           @Override
           protected Void doInBackground(Void... arg0) {
             readRSS();
                       // should be readRSS(url) here
               return null;
           }

           @Override
           protected void onProgressUpdate(Void... values) {
              //super.onProgressUpdate(values);
          //    updateProgressBar(values[0]);

           }

           @Override
           protected void onPostExecute(Void result) {
              super.onPostExecute(result);
           //   dismissProgressBar();
                // should be displayRSS(url) here
            displayRSS();

           }               

 }
} 
```

我正在尝试更改 RSS_Load extends AsyncTask 中的值，但它给了我编译错误。所以我更改了受保护的 Void doInBackground(String... url) 然后将 url 传递给 readRSS(url) 但它也不起作用。我应该如何实现这一目标？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T22:03:19.913

... 意味着它实际上正在传递该类型的数组。因此，如果您将其更改为：

```
protected Void doInBackground(String... arg0) 
```

你需要这样做：

```
@Override
protected Void doInBackground(String... arg0)
{
    readRSS(arg0[0]);
    // should be readRSS(url) here
    return null;
} 
```

# database - 使用 eclipselink jpa 从数据库加载列表

> ID：10710790
> 
> 赞同：3
> 
> 时间：2012-05-22T21:59:11.837
> 
> 标签：database, jpa, eclipselink, rcp

我在 derby 数据库中有三个表。日程安排、员工日程安排、员工日程安排信息。Schedule 有一个 EmployeeSchedule 列表，而 EmployeeSchedule 有一个 EmployeeScheduleInfo 列表。

我正在使用 eclipselink jpa，我从 netbeans 生成了我的实体和控制器。我的问题是当我从数据库加载一个 Schedule 对象时，所有 EmployeeSchedule 对象中的 EmployeeScheduleInfo 对象列表都没有加载，当我调试这个时我看到

```
{IndirectList: not instantiated} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T13:17:11.483

1:M 和 ManyToMany 关系在 JPA 中默认是惰性的。这意味着您需要访问要获取它们的关系 - 在集合上调用 size() 以在调试环境中查看它。您还可以使用 JPQL 中的“获取连接”或 EclipseLink eclipselink.join-fetch 查询提示在初始查询中预取集合： [http ://wiki.eclipse.org/Using_EclipseLink_JPA_Extensions_(ELUG)#Join_Fetch](http://wiki.eclipse.org/Using_EclipseLink_JPA_Extensions_(ELUG)#Join_Fetch)

# c - 如何更改VS的编译器？

> ID：10710791
> 
> 赞同：2
> 
> 时间：2012-05-22T21:59:16.203
> 
> 标签：c, visual-studio-2010, compiler-construction, c99

我正在使用 VS 2010。我更改了编译器 C 代码而不是 C++ 的设置。它工作正常，但问题是 MS 编译器不支持 C99 标准，因此我正在寻找可以与 VS 10 一起使用的 C 编译器。如何做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:18:09.440

MS Visual Studio 不支持 c99，但是他们实现了 c99 的[某些功能](https://stackoverflow.com/questions/9610747/which-c99-features-are-available-in-the-ms-visual-studio-compiler)。

从这个[Microsoft 页面](http://connect.microsoft.com/VisualStudio/feedback/details/526116/c99-support)，他们对 c99 支持的回复：

***用户提问：***

> “我希望在 Visual Studio 中看到 C99 支持。与 C++0x 相比，添加 C99 支持的工作量应该微不足道。
> 
> 作为主流 PC 平台的编译器，微软确实应该更加努力地实现一个已有 10 多年历史的标准——尤其是因为 C 社区可以说比 C# 或 C++ 社区更大。”

***微软的回复：***

> “不幸的是 1) 使用 Microsoft C++ 编译器的用户比使用 C 编译器的用户多得多；2) 每当我们进行客户讨论和/或征求反馈时，压倒性的反应是我们应该专注于 C++（尤其是在moment C++-0x); 3) 我们只是没有资源去做我们想做的所有事情。因此，虽然我们正在慢慢改进对 C-99 的支持（并且我们积极参与 C-1x 讨论），但我不能承诺我们将添加任何这些功能。”

# objective-c - UIView 的 frame origin 和 size 是只读的背后的逻辑是什么

> ID：10710793
> 
> 赞同：1
> 
> 时间：2012-05-22T21:59:30.570
> 
> 标签：objective-c, ios, uiview

我知道，如果你想调整 a 的大小，`UIView`你必须这样做：

```
CGRect frame = view.frame;
frame.size.height -= 100;
view.frame = frame; 
```

而不仅仅是：

```
view.frame.size.height -= 100; 
```

我的问题是这背后的逻辑是什么？setter 是不是`frame`做一些额外的事情，比如 call `setNeedsDisplay`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T22:07:57.560

基本上它背后的原因是以下行

```
view.frame.size.height -= 100; 
```

实际上做了以下两件事：

1.  调用`[view frame]`返回`CGRect`结构的方法 -视图中存储的内容的**副本**
2.  然后它会更改`height`副本的字段 - 因此它不会影响存储在视图中的结构的值

> 框架的设置器是否在做一些额外的事情，比如调用 setNeedsDisplay ？

实际上是的 - 视图的`frame`属性是根据它的原点、边界和变换计算的，因此设置框架也会影响它的原点和边界（并且取决于视图的 contentMode 可能会强制视图重绘）

# javascript - Coffeescript 变量声明放错了地方

> ID：10710794
> 
> 赞同：1
> 
> 时间：2012-05-22T21:59:39.753
> 
> 标签：javascript, jquery, ruby-on-rails, coffeescript

**Coffeescript 将 var 指令放置在错误的位置。我曾尝试在功能上放置大括号，但没有成功。这是咖啡脚本代码：**

```
jQuery (->

  $(".item-scaffold-edit").live("click", (=>
    element = $(this)
    cont = element.data("cont")
    url = element.data("url")
    $.ajax(url,
      dataType: "html"
      success: (data, textStatus, jqXHR) ->
        $("##{cont}").html(data)
        $("##{cont}").data("url", url))))

  $(".item-menu").live("click", (=>
    element = $(this)
    cont = element.data("cont")
    url = element.data("url")
    if url isnt $("##{cont}").data("url")
      $.ajax(url,
        dataType: "html"
        success: (data, textStatus, jqXHR) ->
          $("##{cont}").html(data)
          $("##{cont}").data("url", url)
          $("#navbar-left li").removeClass("active")
          element.parent().addClass("active"))))
) 
```

**它生成：**

```
(function () {
  jQuery((function () {
    var _this = this;
    $(".item-scaffold-edit").live("click", (function () {
      var cont, element, url;
      element = $(_this);
      cont = element.data("cont");
      url = element.data("url");
      return $.ajax(url, {
        dataType: "html",
        success: function (data, textStatus, jqXHR) {
          $("#" + cont).html(data);
          return $("#" + cont).data("url", url);
        }
      });
    }));
    return $(".item-menu").live("click", (function () {
      var cont, element, url;
      element = $(_this);
      cont = element.data("cont");
      url = element.data("url");
      if (url !== $("#" + cont).data("url")) {
        return $.ajax(url, {
          dataType: "html",
          success: function (data, textStatus, jqXHR) {
            $("#" + cont).html(data);
            $("#" + cont).data("url", url);
            $("#navbar-left li").removeClass("active");
            return element.parent().addClass("active");
          }
        });
      }
    }));
  }));
}).call(this); 
```

**但它应该生成这个：**

```
(function () {
  jQuery((function () {    
    $(".item-scaffold-edit").live("click", (function () {
      var cont, element, url;
      var _this = this;
      element = $(_this);
      cont = element.data("cont");
      url = element.data("url");
      return $.ajax(url, {
        dataType: "html",
        success: function (data, textStatus, jqXHR) {
          $("#" + cont).html(data);
          return $("#" + cont).data("url", url);
        }
      });
    }));
    return $(".item-menu").live("click", (function () {
      var cont, element, url;
      var _this = this;
      element = $(_this);
      cont = element.data("cont");
      url = element.data("url");
      if (url !== $("#" + cont).data("url")) {
        return $.ajax(url, {
          dataType: "html",
          success: function (data, textStatus, jqXHR) {
            $("#" + cont).html(data);
            $("#" + cont).data("url", url);
            $("#navbar-left li").removeClass("active");
            return element.parent().addClass("active");
          }
        });
      }
    }));
  }));
}).call(this); 
```

**任何人都知道我的咖啡脚本代码有什么问题？？？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T22:15:31.987

据我从您的示例中可以看出，您目前拥有：

```
foo -> bar => element = $(this) 
```

生成：

```
foo(function() {
  var _this = this;
  return bar(function() {
    var element;
    return element = $(_this);
  });
}); 
```

但您希望它生成：

```
foo(function() {
  return bar(function() {
    var _this = this;
    var element;
    return element = $(_this);
  });
}); 
```

那将与此相同：

```
foo(function() {
  return bar(function() {
    var element;
    return element = $(this);
  });
}); 
```

您可以使用以下方法生成：

```
foo -> bar -> element = $(this) 
```

例如，将 更改`=>`为`->`. “胖箭头”的文档在[这里](http://coffeescript.org/#fat_arrow)，解释了它与普通箭头的不同之处。

# java - android restlet 添加非标准头参数

> ID：10710796
> 
> 赞同：6
> 
> 时间：2012-05-22T21:59:45.720
> 
> 标签：java, android, parameters, header, restlet

如何在restlet android中添加标题参数？

我有以下代码：

```
ClientResource clientResource = null;
try {
    clientResource = new ClientResource(jsonRestHelper.getUrl());
    for (Parameter parameter : jsonRestHelper.getParameters()) {
        //here works perfectly, jsonRestHelper is a helper class
        clientResource.addQueryParameter(parameter);
    }
    //here I wanna add headers param example
    //addHeader("Key","Value");
} catch (Exception e) {} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T17:30:42.730

您想添加自定义（即非标准）标题吗？如果是这样，试试这个：

```
import java.util.concurrent.ConcurrentMap;
import org.restlet.data.Form;
import org.restlet.engine.header.Header;
import org.restlet.engine.header.HeaderConstants;
import org.restlet.resource.ClientResource;
import org.restlet.util.Series;

...

clientResource = new ClientResource("http://someurl.com");
ConcurrentMap<String, Object> attrs = clientResource.getRequest().getAttributes();
Series<Header> headers = (Series<Header>) attrs.get(HeaderConstants.ATTRIBUTE_HEADERS);
if (headers == null) {
    headers = new Series<Header>(Header.class);
    Series<Header> prev = (Series<Header>) 
        attrs.putIfAbsent(HeaderConstants.ATTRIBUTE_HEADERS, headers);
    if (prev != null) { headers = prev; }
}
headers.add("myHeaderName", "myHeaderValue"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-04T09:13:44.267

使用下面的代码

```
HttpClient client = new DefaultHttpClient();  
String getURL = "rest url";
HttpGet get = new HttpGet(getURL);
get.setParams(HttpParams parmams)
get.setHeader("Key","valye"); // Request Header
    try {
        HttpResponse responseGet = client.execute(get);
   } 
   catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
  } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
} 
```

# html - 带有水平子菜单的 CSS 下拉菜单

> ID：10710801
> 
> 赞同：2
> 
> 时间：2012-05-22T22:00:12.037
> 
> 标签：html, css, drop-down-menu

我有以下站点[http://jsfiddle.net/Me4fw/4/](http://jsfiddle.net/Me4fw/4/) 我正在尝试实现一个水平 css 下拉菜单，该菜单具有一个也是水平的子菜单。我已经尝试了一切，但似乎没有什么能让子菜单项彼此对齐。我能让他们做的就是把它们混在一起，变得丑陋/不可读。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T22:25:33.537

您的问题是您将子菜单绝对定位到父 li。但是父 li 的宽度很小。

解决方案是将子菜单绝对定位到菜单包装器。

请参阅此链接以及[工作演示文稿！](http://dl.dropbox.com/u/76169930/stackoverflow/question/10710801/serenity_wellness_center.html)

**更新你的 CSS：**

```
#menu {
  width: 820px;
  height: 60px;
  margin: 0 auto;
  padding: 0px 40px;
  position: relative;
}

#menu li {
  float: left;
}

#menu ul ul {
  list-style-type: none;
  position: absolute;
  z-index: 500;
  left: 0;
  right: 0;
} 
```

**并删除此 CSS：**

```
#menu ul li ul li #jackie_spencer{
  display: inline;
  position: absolute;
  top: 20px;
  left: 0;
  width: 100px;    
  color: #FFF;
} 
```

**笔记：**

您可以查看源代码并检查`CSS`：

*   在*“更新”*的地方，一些定义被改变了！
*   在它写着*“更新，删除”*的地方，声明被删除了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T22:27:09.143

我看了你的页面，你的子菜单是垂直的原因是子菜单`<ul>`太窄了：它的宽度和封闭的一样`<li>`。您应该在其上设置一个宽度以使其占用所有可用空间。

使其与父元素左对齐并与菜单栏的右端右对齐是很棘手的。您可能只想将其设置为足够宽以容纳您所知道的所有内容，并假设不会有任何回流。

您还可以使用一些 JavaScript 来计算它的正确位置。JQuery 对此有好处。您只需在页面首次加载时设置一次，作为 $(document).ready() 的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T08:56:33.007

提供二级子菜单的一些调整：

```
/* Menu */
#menu { /* UPDATED */
    width: 820px;
    height: 60px;
    margin: 0 auto;
    padding: 0px 40px;
    position: relative;
}

#menu ul {
 margin: 0;
 padding: 0px 0px 0px 0px;
 line-height: normal;
 line-style: none;
 list-style-type: none;
}

#menu a {
 display: block;
 height: 20px;
 margin-right: 1px;
 padding: 10px 20px 0px 20px;
/*  height: 40px;
 margin-right: 1px;
 padding: 20px 20px 0px 20px;*/
 text-decoration: none;
 text-transform: uppercase;
 font-family: 'Abel', sans-serif;
 font-size: 16px;
 font-weight: normal;
 color: #FFFFFF;
 border: none;
}

#menu a:hover {
 background: url(images/page-content-bg.png) repeat;
}

#menu ul ul a:hover {
 background: url(images/page-menu-bg.png) repeat;
}

#menu .current_page_item a {
 background: url(images/page-content-bg.png) repeat;
}

#menu li { /* UPDATED */
    float: left;
}

/* UPDATED, REMOVED
#menu ul li ul li #jackie_spencer{
 display: inline;
 position: absolute;
 top: 20px;
 left: 0;
 width: 100px;    
 color: #FFF;
}
*/
#menu ul ul { /* UPDATED */
    list-style-type: none;
    position: absolute;
    z-index: 500;
    left: 50px;
    right: 0;
}

#menu ul ul ul {
 position: absolute;
/* top: 0;
 left: 100%;*/
     z-index: 500;
    left: 50px;
    right: 0;

}

div#menu ul ul,
div#menu ul li:hover ul ul,
div#menu ul ul li:hover ul ul
{display: none;}

div#menu ul li:hover ul,
div#menu ul ul li:hover ul,
div#menu ul ul ul li:hover ul
{display: block;}
div#menu ul ul li:hover {   background:#c0c0c0;}
div#menu ul ul li { background:#cccccc;}
div#menu ul ul li a:hover { color:#000;} 
```

页面代码

```
<div id="menu">
                <ul>
                    <li class="current_page_item"><a id="home_menu" href="#Home">Home</a><ul>
  <li><a href="#">linkx</a></li>
  <li><a href="#">linkx</a></li>
  <li><a href="#">linkx</a></li>
  <li><a href="#">linkx</a></li>
  <li><a href="#">linkx</a></li>
  <li><a href="#">linkx</a>
    <ul>
  <li><a href="#">linky</a></li>
  <li><a href="#">linky</a></li>
  <li><a href="#">linky</a></li>
  <li><a href="#">linky</a></li>
  <li><a href="#">linky</a></li>
  <li><a href="#">linky</a></li>
</ul>
  </li>
</ul></li>
                    <li><a id="aboutus_menu" href="#About_Us">About Us</a><ul>
  <li><a href="#">link</a></li>
  <li><a href="#">link</a></li>
  <li><a href="#">link</a></li>
  <li><a href="#">link</a></li>
  <li><a href="#">link</a></li>
  <li><a href="#">link</a></li>
</ul></li>
                </ul>
                <ul>
                    <li><a id="what_we_do" href="#What_We_Do">What We Do</a>
                        <ul>
                            <li><a id="jackie_spencer" href="#Jackie_Spencer">Hypnotherapy</a></li>
                            <li><a id="diana_menz" href="#Diana_Menz">Massage</a></li>
                            <li><a id="afton_land" href="#Jackie_Spencer">Estitician</a></li>
                        </ul>
                    </li>
                </ul>
                <ul>
                    <li><a id="contactus_menu" href="#Contact_Us">Contact Us</a><ul>
  <li><a href="#">link</a></li>
  <li><a href="#">link</a></li>
  <li><a href="#">link</a></li>
  <li><a href="#">link</a></li>
  <li><a href="#">link</a></li>
  <li><a href="#">link</a></li>
</ul></li>
                </ul>
            </div> 
```

# eclipse - Eclipse RCP 产品 - 无论如何在启动期间更新 PATH

> ID：10710802
> 
> 赞同：1
> 
> 时间：2012-05-22T22:00:22.520
> 
> 标签：eclipse, path, rcp

我正在 Windows 上开发 Eclipse RCP 产品，该产品在内部使用位于名为“bin”的文件夹中的一些本机二进制文件 (dll)，该文件夹可作为产品的一部分使用。执行 product.exe 文件时，我需要确保 PATH 中存在文件夹“bin”。是否有一种干净的方法可以确保在启动 eclipse RCP 产品时将文件夹“bin”添加到 PATH 中？我不想编写任何脚本或批处理文件来更新 PATH，然后调用 product.exe。我也不想通过 Windows UI 或命令提示符更新环境变量。

我知道当我们尝试从 Eclipse IDE 环境运行我的产品时，运行配置中有一个选项，其中可以在 Environment 选项卡上配置环境变量。我可以通过创建一个名为“Path”的新环境变量将“bin”文件夹附加到 PATH，其值为 C:\EclipseRCPProduct\bin;${env_var:PATH}。

但是 - 当我直接从生成的 Product.exe 运行我的产品时，我想做同样的事情。有人对此有任何想法吗？

另外-如果有人对处理运行配置的环境选项卡上指定的信息的eclipse代码有任何想法，那就太好了。我可以尝试使用代码来查看是否可以在从 Eclipse IDE 外部启动产品时让它工作 - 通过生成的 RCP product.exe

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:34:58.557

我认为没有办法在启动器中定义**系统环境变量**。

以下错误似乎只要求 [https://bugs.eclipse.org/bugs/show_bug.cgi?id=286463](https://bugs.eclipse.org/bugs/show_bug.cgi?id=286463)

在上面提到的错误中，附加了一个 .bat 来实现您的目标。

也就是说，为什么本机二进制文件必须位于 bin 文件夹中？即为什么它们不包含在插件/片段中？

# javascript - jQuery返回所有页面禁用然后启用

> ID：10710803
> 
> 赞同：2
> 
> 时间：2012-05-22T22:00:26.733
> 
> 标签：javascript, jquery, html

我想要一个简单的方法来禁用整个页面（链接，按钮等......全部禁用）然后我需要能够重新启用页面中的所有内容。

有没有轻便的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:05:59.040

对我来说显而易见的一个选项是设置“覆盖”层：

```
<div id="cover"></div> 
```

搭配风格：

```
#cover {
    position: fixed;
    width: 100%;
    height: 100%;
    z-index: 100000;
} 
```

如果您需要禁用所有内容，只需使用方法使其可见`show`。

```
$("#cover").show(); 
```

它将像这样工作：http: [//jsfiddle.net/KEAh8/](http://jsfiddle.net/KEAh8/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T22:06:05.153

这不是一种轻量级的方法，因为它必须扫描 DOM 才能找到每个元素，但它会起作用：

```
$("input, select, button, textarea").attr("disabled", true); 
```

这取决于您的页面大小，以了解这是否是一个好方法，并且选择器可能会根据内容而改变。反转属性设置以再次启用所有内容。

编辑：

正如 Porco 指出的那样，要禁用锚标签，您必须阻止默认操作，因此添加如下内容：

```
$("a").click(function(e) {
   e.preventDefault();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T22:08:56.270

你可以做：

```
$('*').attr('disabled', 'disabled').addClass('disabled') 
```

所以现在我们已经禁用了所有输入并为所有内容添加了“禁用”类。现在我们只想禁用链接，我认为这应该可行：

```
$('body').on('click', '.disabled', function(e) { e.preventDefault(); }); 
```

要简单地重新启用所有内容：

```
$('*').attr('disabled', '').removeClass('disabled') 
```

# ruby-on-rails - Rails 文本字段中的自然排序

> ID：10710806
> 
> 赞同：1
> 
> 时间：2012-05-22T22:00:34.863
> 
> 标签：ruby-on-rails, natural-sort, active-record-query

我的相册列表如下：

```
"Day 10 - Kblah"
"Day 9 - Lblah"
"Day 8 - Sblah"
"Day 7 - Ublah"
"Day 6 - Sblah"
"Day 5 - Cblah"
"Day 4 - Gblah"
"Day 3 - Sblah"
"Day 2 - Dblah"
"Day 1 - Hblah"
"Another album"
"Some more albums" 
```

当我按标题对它们进行排序时，我最终得到：

```
"Another album"
"Day 1 - Hblah"
"Day 10 - Kblah"
"Day 2 - Dblah"
"Day 3 - Sblah"
"Day 4 - Gblah"
"Day 5 - Cblah"
"Day 6 - Sblah"
"Day 7 - Ublah"
"Day 8 - Sblah"
"Day 9 - Lblah"
"Some more albums" 
```

我希望他们在哪里：

```
"Another album"
"Day 1 - Hblah"
"Day 2 - Dblah"
"Day 3 - Sblah"
"Day 4 - Gblah"
"Day 5 - Cblah"
"Day 6 - Sblah"
"Day 7 - Ublah"
"Day 8 - Sblah"
"Day 9 - Lblah"
"Day 10 - Kblah"
"Some more albums" 
```

我基本上想对标题进行自然排序，但要按字母自然排序。是否有任何类型的宝石可以为我正确执行此操作？

亲切的问候，尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:31:56.530

我知道没有宝石会自动解决这个问题。我想一般地解决这个问题是相当困难的。

但是，如果问题不是通用的，那么它可能是可行的。

它首先将一个块传递给排序：

```
array.sort do |a, b|
  # return -1, 0 or 1 in this block, usually done via the <=> operator
end 
```

您可能想离开“日”部分：

```
DAY_REGEX = /^Day (\d+) -/

array.sort do |a, b|
  if is_day?(a) && is_day(b)
    value_of_day(a) <=> value_of_day(b)
  else
    a <=> b
  end
end

def is_day?(str)
  str =~ DAY_REGEX
end

def value_of_day(str)
  DAY_REGEX.match(str)[1].to_i
end 
```

我知道，它既丑陋又丑陋。但我希望它能启发你如何自己解决这个问题，如果你找不到合适的解决方案。

编辑：也许改变技术来阅读类似的东西：`contains_numbers`. 编写一些测试来执行以下操作：当字符串中直到名字的部分在两个字符串中相同时，然后删除它们，转换数字并对其进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T10:10:45.483

感谢您的回复。我设法找到了一个创造奇迹的宝石。它被称为 NaturalSorter，我只是在我的控制器中的 @albums 实例变量上调用它以按标题对它们进行排序，然后将其传递给视图。

亲切的问候，尼尔

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T06:15:10.207

您如何生成相册名称列表？你能回到那个步骤并在那里计算排序吗？（例如，它们是从用户相册的数据库表中提取的吗？）。或者用可以排序的东西索引的专辑名称的散列替换数组，然后对键进行排序并按该顺序从散列中检索值。

# objective-c - UIView commitAnimations - 沿中心缩放

> ID：10710813
> 
> 赞同：0
> 
> 时间：2012-05-22T22:01:19.497
> 
> 标签：objective-c, core-animation

我有一个我正在尝试制作动画的 UIView。

```
[UIView beginAnimations:@"scaleAnimation" context:nil];
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut]; 
[UIView setAnimationDuration:0.5];

CGRect f = self.frame;
f.size.width = f.size.width * 2;
f.size.height = f.size.height * 2;
self.frame = f;

[UIView commitAnimations]; 
```

动画效果很好，但无论如何我可以让动画沿着中心缩放吗？
现在，看起来该点位于左上角。

使用 CGAffineTransform 比例 = CGAffineTransformMakeScale(2.0, 2.0); 沿着中心做动画，但是做一个触摸事件，当我试图检测 UIView 的透明区域时，这些点似乎都搞砸了。

谢谢你，
三通

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:14:56.697

这很简单。`bounds`改为动画。正如[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html#//apple_ref/occ/instp/UIView/bounds)所说：

> 更改边界大小会相对于其中心点增大或缩小视图。

所以你的代码会是这样的

```
[UIView beginAnimations:@"scaleAnimation" context:nil];
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut]; 
[UIView setAnimationDuration:1.5];

CGRect f = myView.bounds;
f.size.width = f.size.width * 2;
f.size.height = f.size.height * 2;
myView.bounds = f;

[UIView commitAnimations]; 
```

# java - java.lang.IllegalAccessError 从 scala 调用 java - 解决方案/解决方法？

> ID：10710820
> 
> 赞同：4
> 
> 时间：2012-05-22T22:01:46.827
> 
> 标签：java, scala

我在scala项目中使用了一个java线性代数库（ojalgo 32.0），我遇到了一个奇怪的问题。我使用的每个 ojalgo 方法都可以正常工作（例如，矩阵和元素乘法、逆矩阵和随机矩阵生成），除了两个看似简单的用于获取矩阵维度的方法。我以前从来没有遇到过调用 java 库的问题，而且我很好奇发生了什么。这是java中的一些示例代码，可以正常工作：

```
public static void main(String[] arg) {
  MatrixFactory tmpFactory = PrimitiveMatrix.FACTORY;
  BasicMatrix wMat = tmpFactory.makeRandom(5,5,new Weibull(5.0, 2.0));
  System.out.println(wMat.getColDim());
} 
```

对 scala 的简单翻译（使用 2.9.2 版）：

```
object DataGen {
  def main(args:Array[String]):Unit = {
  val tmpFactory = PrimitiveMatrix.FACTORY
  val wMat = tmpFactory.makeRandom(5,5,new Weibull(5.0, 2.0))
  println(wMat.getColDim)
} 
```

scala 代码抛出这个：

```
Exception in thread "main" java.lang.IllegalAccessError: tried to
access class org.ojalgo.access.Structure2D from class DataGen$
   at DataGen$.main(DataGen.scala:11)
   at DataGen.main(DataGen.scala) 
```

第 11 行是

```
println(wMat.getColDim). 
```

搜索此错误的其他情况表明在 scala 中存在一些与访问错误有关的已知问题，但我仍然不确定问题的原因或最干净的解决方法可能是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T07:50:16.177

我不完全明白为什么它不起作用，但我玩了一下它，发现它`BasicMatrix`是不可访问的，因为我试图将 Matrix 明确地投射到它，因为这是`getColDim`实现的地方。但是，当我将 Matrix 投射到`PrimitiveMatrix`：

```
scala> res1.asInstanceOf[PrimitiveMatrix].getColDim
res9: Int = 5 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:30:46.520

我刚刚使用 Scala 2.10-M3 和 ojalgo 32.4 进行了测试，并且您的代码按预期工作，因此它看起来像早期版本的 scalac 中的错误（使用 2.9 编译会在 2.10 运行时出现错误，但使用 2.10 编译不会给出2.9 运行时出错）。

这提出了一个简单的解决方法 - 升级 Scala 版本！

# wxpython - 如何在 python 中更改 wx.Listbox 字符串

> ID：10710822
> 
> 赞同：1
> 
> 时间：2012-05-22T22:02:08.417
> 
> 标签：wxpython

```
self.list_box_1 = wx.ListBox(self, -1, choices = self.generateList("imagelist.txt"), style=wx.LB_SINGLE)

newlist=['6','7','8','9','10'] 
```

我有一个包含文件名的列表框，例如 1,2,3,4,5，当单击按钮时，我希望清除列表框并且 newlist 的值覆盖列表框中的当前值

我可以使用 self.list_box_1.SetString(5,1) 更改 self.list_box_1 中的每个字符串，但是如何用 newlist 中的值覆盖列表框中的值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T22:24:17.563

还要在派生层次结构中查找 ListBox 的方法，例如[`wx.ItemContainer`](http://wxpython.org/docs/api/wx.ItemContainer-class.html). [`wx.ItemContainer.SetItems`](http://wxpython.org/docs/api/wx.ItemContainer-class.html#SetItems)可能会有所帮助：

> 从列表中清除并设置控件中的字符串

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T08:59:20.273

谢谢飞哥，我用过

```
 self.list_box_1.Clear()
 self.list_box_1.InsertItems(newlist,0) 
```

# python - 字符串操作 - 在 args 列表之间串接 '&'

> ID：10710823
> 
> 赞同：2
> 
> 时间：2012-05-22T22:02:12.067
> 
> 标签：python, string

我有一个参数列表

```
args = ['abc', 'def', 'ghi'... ... ... (long list)] 
```

我想制作一个名为“剪贴板”的字符串，其中：

```
clipboard = 'abc&def&ghi&... ... ... (long list)' 
```

**指针将不胜感激。**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-22T22:03:25.457

`clipboard = '&'.join(args)`

# html - 下面的 div 到另一个具有 display:inline-block 属性

> ID：10710824
> 
> 赞同：2
> 
> 时间：2012-05-22T22:02:13.100
> 
> 标签：html, css

我有这个html：

```
<div id='calendarControlPane'>          
    <div id='calendarControl'>

        <div style="border-style:solid; display:inline-block;">
            <div style="width:14;height:15;">
            </div>
        </div>

        <div style="border-style:solid; display:inline-block;">
            <div style="width:14;height:15;">
            </div>
        </div>

        <div style="border-style:solid; display:inline-block;">
            <div style="width:14;height:15;">
            </div>
        </div>

    </div>      
</div> 
```

我在容器 div 上使用“display:inline-block”，因为我希望这些 div 适合其内容的大小。

我遇到的问题是它们彼此相邻绘制并且需要在彼此下方绘制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T22:21:00.500

好吧，根据您的实际最终应用程序，使用`float`可以工作（[请参阅小提琴](http://jsfiddle.net/g2zLF/)），尽管[旧版本的 IE 可能会窒息它](http://www.brunildo.org/test/IEWfc3.html)：

**HTML**

```
<div id="calendarControlPane">          
   <div id="calendarControl">
    <div>
        <div></div>
    </div>
    <div>
        <div></div>
    </div>
    <div>
        <div></div>
    </div>
   </div>
</div> 
```

**CSS**

```
#calendarControl > div {
    float: left;
    clear: left;
    border: 1px solid black;
}

#calendarControl > div > div {
    width: 14px;
    height: 15px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T22:25:41.247

老派修复：

```
<div id='calendarControlPane'">          
    <div id='calendarControl'">
        <div style="border-style:solid; display:inline-block;">
            <div style="width:14;height:15;"></div>
        </div><br />
        <div style="border-style:solid; display:inline-block;">
            <div style="width:14;height:15;"></div>
        </div><br />
        <div style="border-style:solid; display:inline-block;">
            <div style="width:14;height:15;"></div>
        </div>

    </div>

</div>​ 
```

只需添加一个

```
<br /> 
```

在每个包含 inline-block 类的 div 之后。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T22:08:09.140

你不是真的在这里问一个问题，你帖子的两条底线有点难以理解，但你确定你不想要`display: block`吗？

编辑：正如 drublic 所说，这是 div 的默认显示值，所以你根本不需要那种样式。

# java - 获取 NullPointerException 试图访问 JSP 中的“响应”

> ID：10710828
> 
> 赞同：1
> 
> 时间：2012-05-22T22:02:41.957
> 
> 标签：java, jsp, web

在 JSP 页面中，当用户注销时，我正在使用以下代码删除他们的登录 cookie：

```
Cookie killMyCookie = new Cookie("cookie1", null);
killMyCookie.setMaxAge(0);
killMyCookie.setPath("/JSPLearn");
response.addCookie(killMyCookie);
killMyCookie = new Cookie("cookie2", null);
killMyCookie.setMaxAge(0);
killMyCookie.setPath("/JSPLearn");
response.addCookie(killMyCookie); 
```

在这之后，我打电话

```
response.sendRedirect("index.jsp"); 
```

它抛出一个 NullPointerException。

为什么响应为空？

堆栈跟踪：

```
java.lang.NullPointerException
at java.net.URLEncoder.encode(URLEncoder.java:205)
at org.apache.jsp.index_jsp._jspService(index_jsp.java:175)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:111)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:403)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:473)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:377)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
at  com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T04:55:55.177

答案在于

```
org.apache.jsp.index_jsp._jspService(index_jsp.java:175) 
```

我认为你正在尝试类似的东西`URLEncoder.encode`，第一个参数是要编码的字符串是 Null 并且它正在抛出`java.lang.NullPointerException`

它应该是这样的

`URLEncoder.encode("Hello World", "UTF-8");`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T22:27:17.000

检查你的 index.jsp 文件我认为你有一个 requet.getParameter(""); 对于变量，当您使用重定向时，您应该为该变量发送一个值。

# c# - 带有缓存分页的gridview？

> ID：10710829
> 
> 赞同：3
> 
> 时间：2012-05-22T22:02:51.777
> 
> 标签：c#, asp.net, sql, odbc

是否可以使用缓存的 SqlDataSource 在 Gridview 中实现分页？我想运行一次查询，结果存储在缓存中，然后我可以通过 Gridview 页面并在更改页面时加载缓存的结果，而无需重新运行查询？我知道只获取当前页面所需的记录更有效，但由于我可以选择在页面上导出到 Excel，我希望一次获取所有内容。

```
<asp:GridView ID="Results" runat="server" AutoGenerateColumns="False"
            AllowSorting="true" DataSourceID="SqlDataSource1" OnSorting="Submit_Query" CellPadding="5" Class="highlightable"
            OnRowDataBound="Results_RowDataBound" 
            OnPageIndexChanging="GridView_PageIndexChanging" AllowPaging="true" PageSize="100" EmptyDataText="No Data Found">
</asp:GridView> 
```

SqlDataSource：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:ConnectionString %>"
    ProviderName="<%$ ConnectionStrings:ConnectionString.ProviderName %>" EnableCaching="true"  ></asp:SqlDataSource> 
```

在页面更改时运行的功能

```
protected void GridView_PageIndexChanging(object sender, GridViewPageEventArgs e)
         {
          Results.PageIndex = e.NewPageIndex;
          //Submit_Query();  //???
        } 
```

这可能吗？

# wpf-controls - 用于实时数据的良好 WPF TreeList 控件

> ID：10710833
> 
> 赞同：1
> 
> 时间：2012-05-22T22:03:04.447
> 
> 标签：wpf-controls, treelist

我正在寻找一个好的 WPF TreeList 控件（免费或其他），它在许多单元格实时变化时表现得相当好。你有什么建议？

ps：TreeList 是指具有可以展开/折叠的分层行的网格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T14:01:24.480

我已经广泛尝试了 Telerik 的 RadTreeList 控件和 Syncfusion 的 GridTree 控件。我的评估是 Telerik 的控件通常具有更好的文档记录和更好的架构，但是它们的网格在初始加载数据时非常慢，尤其是在有很多列的情况下。一旦绑定了 ItemsSource，实时更新就会快速运行。因此，如果您要经常切换 ItemsSource，我认为 Telerik（截至今天）不是您的网格（例如，具有两个网格的主详细信息屏幕，一个用于主记录，另一个用于详细信息......不好，因为每次用户单击主行时，详细信息网格都需要更改）

另一方面，Syncfusion 在加载数据和实时更新方面都非常快。他们的文档虽然不是很好，所以你依靠他们的客户支持来寻求答案。

Telerik 和 Syncfusion 都有很好的客户支持。

# c# - ASP.NET MVC 3 比较 2 个列表与模型对象的重复项

> ID：10710835
> 
> 赞同：1
> 
> 时间：2012-05-22T22:03:16.013
> 
> 标签：c#

我正在构建一个 ASP.NET MVC 3 应用程序，其中我有根据此模型的自定义对象列表：

```
public class AbnAmroTransaction
{
    public int TransactionId { get; set; }
    public int AccountNumber { get; set; }
    public string Currency { get; set; }
    public int TransactionDate { get; set; }
    public int InterestDate { get; set; }
    public decimal StartBalance { get; set; }
    public decimal EndBalance { get; set; }
    public decimal Amount { get; set; }
    public string Description { get; set; }
    public int CategoryId { get; set; }
} 
```

我还有第二个列表，其中包含稍微相似的自定义对象类型“事务”的对象（我使用 DBML 从我的 SQL Server 2008 数据库中获得）：

```
Transaction LinqToSql Object

int TransactionId
int ImportId
int CategoryId
DateTime DateTime
Nvarchar(MAX) Currency
Money Amount
Nvarchar(MAX) Description 
```

我正在尝试创建一个包含所有 AbnAmroTransactions 的第三个列表，其中 AbnAmroTransaction.TransactionId 不在 Transactions 列表 (TransactionId) 中。我如何做到这一点而不必遍历两个列表，这似乎是一种非常低效的方法？

我找到了这篇文章： http: [//msdn.microsoft.com/en-us/library/system.collections.iequalitycomparer.equals.aspx](http://msdn.microsoft.com/en-us/library/system.collections.iequalitycomparer.equals.aspx) 但这似乎只适用于相同类型的对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T22:08:35.747

如果您使用的是 linq，请查看[except](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except.aspx)。

```
var list1 = new List<int>() {1,2,3,4,5};
var list2 = new List<int>() {4,5,6,7};
var newList = list1.Except(list2); 
```

新列表将包含 {4,5}

但是您必须首先检查交易 ID。

# c++ - 在 C++ 中获得均匀分布的随机整数的标准方法是什么？

> ID：10710840
> 
> 赞同：10
> 
> 时间：2012-05-22T22:03:34.923
> 
> 标签：c++, random

是否有一个函数可以在某个指定范围内获得*均匀*分布的伪随机整数？我可以使用 编写我自己的函数`rand`，但这似乎是一种很常见的情况，在 STL 中可能有一些内容。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-22T22:07:59.950

[Boost](http://www.boost.org/)提供了许多用于随机数生成的工具。对于均匀分布，你有这个：

[http://www.boost.org/doc/libs/1_49_0/doc/html/boost/random/uniform_real_distribution.html](http://www.boost.org/doc/libs/1_49_0/doc/html/boost/random/uniform_real_distribution.html)

**编辑：**更新以包含新的 C++11 实现。对于整数的情况，这里有参考：

[http://en.cppreference.com/w/cpp/numeric/random/uniform_int_distribution](http://en.cppreference.com/w/cpp/numeric/random/uniform_int_distribution)

一个简单的例子是：

```
#include <random>
#include <iostream>
int main()
{
    std::random_device rd;
    std::mt19937 gen(rd());
    std::uniform_int_distribution<> dis(1, 6);
    for(int n=0; n<10; ++n)
        std::cout << dis(gen) << ' ';
    std::cout << '\n';
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-02-25T17:47:29.240

要在 C++ 中生成伪随机数，一个很好的选择是使用**[Mersenne twister](http://en.wikipedia.org/wiki/Mersenne_twister)伪随机数生成器引擎**：**`std::mt19937`**从头`<random>`文件。

我们可以把这个**引擎**想象成一个吐出*高质量随机位的**黑盒*。

 *然后，可以使用**分布将这些随机位***整形*为一些整数输出；特别是，要获得*均匀分布*的伪随机数，可以使用 a。*****`std::uniform_int_distribution`*****

 ***请注意，引擎对象必须使用*种子*进行初始化。
`std::random_device`可用于该目的。

因此，这个过程可以概括为三个逻辑步骤：

1.  创建 , 的实例`std::random_device`以获取 Mersenne twister 引擎的*非确定性种子*。
2.  创建一个`std::mt19937` *engine*实例，以获取高质量的伪随机位。
3.  使用 a`std::uniform_int_distribution`将这些随机位整形为*均匀**分布的整数*。

可编译的 C++ 代码如下：

```
#include <iostream>     // for console output
#include <random>       // for pseudo-random number generators and distributions

int main()
{
    // Use random_device to generate a seed for Mersenne twister engine.
    std::random_device rd;    

    // Use Mersenne twister engine to generate pseudo-random numbers.
    std::mt19937 engine(rd());

    // "Filter" MT engine's output to generate pseudo-random integer values,
    // **uniformly distributed** on the closed interval [0, 99].  
    // (Note that the range is [inclusive, inclusive].)
    std::uniform_int_distribution<int> dist(0, 99);

    // Generate and print 10 pseudo-random integers
    for (int i = 0; i < 10; ++i)
    {
        std::cout << dist(engine) << ' ';
    }
    std::cout << std::endl;
} 
```

* * *

有关在 C++ 中生成伪随机数的更多详细信息（包括不好的原因*）*`rand()`，请参阅*Stephan T. Lavavej*的此视频（来自[Going Native 2013](http://channel9.msdn.com/Events/GoingNative/2013)）：

 **> [`rand()`被认为是有害的](http://channel9.msdn.com/Events/GoingNative/2013/rand-Considered-Harmful)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-25T17:51:37.167

`std::generate_n`使用和生成一个或指定数量的在整数域上均匀分布的随机变量`boost`：

```
#include <iostream>
#include <algorithm>
#include <boost/random.hpp>

/*
 * 
 */
int main(int argc, char** argv) {
    boost::mt19937 rand_generator(std::time(NULL));
    boost::random::uniform_int_distribution<> int_distribution(0, 100);

    //Need to pass generator
    std::cout << int_distribution(rand_generator) << std::endl;

    //Associate generator with distribution
    boost::random::variate_generator<boost::mt19937&,
            boost::random::uniform_int_distribution<>
            > int_variate_generator(rand_generator, int_distribution);

    //No longer need to pass generator
    std::cout << int_variate_generator() << std::endl;
    std::generate_n( std::ostream_iterator<int>(std::cout, ","), 3, int_variate_generator);
    return 0;
} 
```******

# facebook - 有没有办法为您的 Facebook 应用程序删除用户？

> ID：10710844
> 
> 赞同：9
> 
> 时间：2012-05-22T22:03:58.480
> 
> 标签：facebook, facebook-graph-api

Facebook Developer 在线文档中有测试用户的文档，但是如何删除应用程序不再显示在其应用程序列表中的实际用户？这与 和 的知识`access_token`有关`facebook_user_id`。

用于删除测试用户：

```
https://graph.facebook.com/893450345999?method=delete&access_token=A2ADI1YMySweBABBGrWPNwKMlubZA5ZCrQbxwhtlEd9FIQUrOVjsGD3mnIWEbUhzDz7dkuBekMFdHvjvJ9CZAU7EMSSaZBsgN60FkMCi3AAZDZD 
```

运行测试用户链接会产生以下错误：

```
"error": {
      "message": "(#100) Can only call this method on valid test users for your app",
      "type": "OAuthException",
      "code": 100
   } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-22T22:17:20.390

您寻求申请取消授权：

> 您可以通过使用该应用的用户 access_token 向 PROFILE_ID/permissions 发出 HTTP DELETE 请求，代表用户取消对应用程序的授权或撤销特定的扩展权限。
> 
> *许可*- 您希望撤销的许可。如果您没有指定权限，那么这将**完全取消对应用程序的授权**。

要实现此问题，请执行以下操作：

```
https://graph.facebook.com/me/permissions?method=delete&access_token=... 
```

一旦应用程序被取消授权，它将不会出现在用户的应用程序列表中。

**2021 年 12 月更新**

按照[请求和撤销权限](https://developers.facebook.com/docs/facebook-login/permissions/requesting-and-revoking#revoking)的参考：

要删除单个权限，请发出`DELETE`请求以`/{user-id}/permissions/{permission-name}`传递**用户访问令牌**或**应用访问令牌**

要完全取消对应用程序的授权，请向`/{user-id}/permissions`端点发出类似的请求

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-22T22:10:56.440

当真实用户从他们的帐户中删除您的应用程序时，他们会从您的应用程序中“删除”自己，您无需执行任何操作。

如果您想知道用户何时像这样对您的应用取消授权，您可以在应用的设置中指定一个*取消授权回调 URL 。*如[https://developers.facebook.com/docs/authentication/](https://developers.facebook.com/docs/authentication/)文档中所述：

> 移除应用后，我们将发送一个包含单个参数 signed_request 的 HTTP POST 请求，该参数一旦解码，将生成一个 JSON 对象，其中包含刚刚取消对您的应用授权的用户的 user_id。您不会在此请求中收到用户访问令牌，并且之前代表该用户颁发的所有现有用户访问令牌都将失效。

**更新**：要从用户的授权应用程序中删除您自己的应用程序，请`https://graph.facebook.com/[userid]/permissions?access_token=...`按照[https://developers.facebook.com/docs/reference/api/user/](https://developers.facebook.com/docs/reference/api/user/)发出 HTTP DELETE 。

通常，Graph API 调用还支持使用额外参数执行 HTTP POST，`method=DELETE`以防 DELETE 调用不可行/不支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-23T21:52:07.863

去做吧：

1.  您必须拥有用户访问令牌。
2.  访问[https://developers.facebook.com/tools/debug/accesstoken/](https://developers.facebook.com/tools/debug/accesstoken/)并调试用户访问令牌。
3.  复制应用范围内的用户 ID
4.  通过 API 调用 HTTP DELETE 到[https://graph.facebook.com/[App-Scoped](https://graph.facebook.com/%5BApp-Scoped) User ID]/permissions?method=delete&access_token=[YOUR-APP-ACCESS-TOKEN]

# c# - 如何通过 SeismicLine2D 中的 Horizo nInterpretation2D 获得给定点的值（幅度）？

> ID：10710846
> 
> 赞同：1
> 
> 时间：2012-05-22T22:04:06.653
> 
> 标签：c#, ocean, petrel

输入参数是 Horizo​​nInterpretation2D 和 SeismicLine2D。通过选择地平线，海燕显示如图所示的值（红色）。要从代码中找到这个值，我需要获取样本的编号（蓝色）。怎样才能得到样本的数量？

![截屏。](../Images/f050c13424b91af9e3cce4db1eeb0735.png)

截图解决方案[[全尺寸](https://i.stack.imgur.com/TDudl.png)]：

![截图解决方案。](../Images/29a6561234bdd299c1e6c568a052491c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T08:56:31.383

地震轨迹上的样本索引可以使用 SeismicLine2D.FirstSampleAt 和 SeismicLine2D.SamplingRate 计算，即 (pickedValue-FirstSampleAt)/SamplingeRate。预计地震拾取位于样本之间并计划进行插值。

# json - 杰克逊最简单的自定义序列化？

> ID：10710850
> 
> 赞同：0
> 
> 时间：2012-05-22T22:04:36.297
> 
> 标签：json, jackson

我有一个`EntityId`作为数据库标识符的简单包装类服务器的类。该类已经具有转换为字符串表示和从字符串表示转换的方法。我想`EntityId`在我的 JSON Web 资源中使用这个字符串表示。

在 Jackson 中为这种简单类型实现自定义序列化最简单的是什么？我知道我可以编写自定义序列化器和反序列化器，但我想知道是否有更简单的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T05:17:52.320

如果有将类型序列化为 String 的方法，则可以`@JsonValue`像这样添加注释：

```
public class MyClass {
  @JsonValue public String toString() { return "xxx"; }
} 
```

相反，如果有一个单参数构造函数采用`String`, `int`or `long`（或杰克逊可以从 JSON 标量类型转换为的某种 Java 类型），您可以`@JsonCreator`在该构造函数旁边添加注释：

```
public class MyClass {
  @JsonCreator
  public MyClass(OtherPojo value) { // or use 'Map<String,Object>', extract data
      // ... 
  }
} 
```

# azure - 将我的 Azure 应用程序部署到我公司的本地 Windows Server

> ID：10710851
> 
> 赞同：7
> 
> 时间：2012-05-22T22:04:40.460
> 
> 标签：azure, azure-deployment

我是 Windows Azure 的新手，需要帮助我将已正确部署到 Azure 的 Azure 应用程序部署到本地服务器。

我的应用程序由一个 Web 角色组成，其中包含用于 Silverlight 应用程序的 Silverlight 客户端。

我在服务器上安装并配置了windows server appfabric，服务器实际上已经准备好了。但我不知道如何部署/发布应用程序。

为了部署到 Azure，我使用右键单击 Azure 应用程序中的发布选项创建了 .cspkg 文件。然后使用 Azure 管理门户将生成的文件部署到 Azure。我怎样才能为本地服务器做类似的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T22:40:30.053

Windows Azure 提供了一个在您的开发机器上运行的仿真器环境。您可以在该模拟器中运行 Windows Azure 应用程序，也可以发布到 Windows Azure。没有将 Windows Azure 应用程序部署到 Windows Server 的选项。

虽然提供的某些服务是相似的（例如缓存），但 Windows Server AppFabric 并不等同于 Windows Azure 提供的服务，并且没有在 Windows Server 上运行的等效结构控制器。

**编辑：根据@Asmaa 的评论添加说明。**

构建*私有云*与创建本地版本的 Windows Azure 不同。您引用的私有云本质上是一组运行由 Hyper-V 管理的虚拟机的 Windows Server，以及某种类型的本地存储。您将完全负责复制、灾难恢复、持久存储（即使磁盘崩溃，存储也能存活）、扩展等。

Windows Azure 提供上述功能，但仅限于其数据中心内。正如@Avkash 提到的，有*一个*Windows Azure 设备，但它只有少数存在，而且它们很大（就像为数据中心制造的一样）。

如果目标是在本地或在 Windows Azure 中运行您的代码，则可以这样做，但不能通过将 Windows Azure 包推送到您的 Windows 服务器来完成。您需要构建单独的解决方案以在两个环境中运行您的代码。如果您的核心代码打包正确，您可以重用它，但角色环境、诊断和其他 Windows Azure 功能的概念需要用其他东西替换。

最后一件事：如果你想构建一个*混合*应用程序，其中一些部署在本地，一些部署到 Windows Azure，那么肯定有办法将两者连接起来。有关更多信息，请参阅[本文](https://www.windowsazure.com/en-us/develop/net/fundamentals/hybrid-solutions/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T00:58:34.590

底线是您无法将 Azure 应用程序部署到您自己的数据中心中的 Windows Server 机器上，而 David 添加了在此上下文中所需的所有信息。但是，我只想补充一点，因为您是 Windows Azure 的新手。我能理解您为什么要尝试做这样的事情，并且因为我过去曾与其他合作伙伴进行过类似的对话，我相信这些信息很有用。

你不能这样做的主要原因是因为 Windows Azure 的主要组件，即基于主要组件的计算、存储、网络和其他增值服务在你的机器上不可用，但是，它还有很多。

Windows Azure 设备是可以部署到任何数据中心的产品，目前由戴尔、eBay、富士通和惠普使用，[如此链接](https://www.windowsazure.com/en-us/community/partners/windows-azure-appliance/)中所述。Windows Azure 和 Windows Azure Appliance 并不完全相同，但是，Windows Azure Appliance 确实具有相似的计算模型、包部署、存储、管理门户和功能。因此，当对公众开放时，这可能是数据中心在其前提下运行类似于 Azure 的一种选择，但目前仅对非常有限的合作伙伴可用。

# android - 使用 JSON 将数据从 servlet 发送到 android 应用程序

> ID：10710858
> 
> 赞同：0
> 
> 时间：2012-05-22T22:05:51.787
> 
> 标签：android, json, servlets, httpclient

晚安，

我正在尝试从用 JSON 中的 Java 数据名称编写的 servlet 发送到 Android 中的应用程序。

并不是说我做错了，但是当涉及到移动文本时，会出现一个奇怪的文本。

下面我描述代码：

小服务程序：

```
if (opcion.equals("4")){//Devolver nombre, apellidos y DNI de Usuario

        String usuario = request.getParameter("login");
        Usuario user = facade.getUsuarioByLogin(usuario);

        String nombre= user.getNombre();
        String apellidos = user.getApellidos();
        String dni = user.getDni();

        System.out.println("El valor de Nombre es"+nombre);

        response.setContentType("application/json");

        JSONObject json = (JSONObject) JSONSerializer.toJSON( nombre );

        //System.out.println("El valor de json"+json.toString());
        out.println(json);

        out.close();
    } 
```

一段获取 JSON 的 Android 应用程序代码（我忽略了 try catch 以使代码更具可读性）：

```
HttpClient cliente = new DefaultHttpClient();

    HttpPost post = new HttpPost (url.toString());

    ResponseHandler<String> handler = new BasicResponseHandler();

    List<NameValuePair> elementos = ele;

        post.setEntity(new UrlEncodedFormEntity(elementos));

    HttpResponse respuesta = null;

        respuesta = cliente.execute(post);

    Log.i("Prueba", "El valor de respuesta es "+respuesta.toString()); 
```

我认为 respuesta 应该有 servlet 发送给我的 JSON，但它返回一个不包含名称的文本

你看到你做错了什么吗？

问候和感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T00:10:32.510

您忘记将 in 传递`ResponseHandler`给`HttpClient#exeucte()`方法。

代替

```
HttpResponse respuesta = null;
respuesta = cliente.execute(post);
Log.i("Prueba", "El valor de respuesta es "+respuesta.toString()); 
```

经过

```
String respuesta = cliente.execute(post, handler);
Log.i("Prueba", "El valor de respuesta es " + respuesta); 
```

# android - Mono For Android-蓝牙连接没有结束

> ID：10710859
> 
> 赞同：1
> 
> 时间：2012-05-22T22:05:53.000
> 
> 标签：android, mono, bluetooth

我创建了蓝牙连接到 datamax 打印机（APEX 4）的解决方案。我不使用线程，它是简单的“即发即弃”任务。

```
mSocket=device.CreateRfcommSocketToServiceRecord(MY_UUID);                                                                                              
                    mAdapter.CancelDiscovery();                     
                    mSocket.Connect(); 
```

UUID 默认为 00001101-0000-1000-8000-00805f9b34fb。

问题是调用 Connect 没有结束 - 没有例外，它只是挂起 :( 仅在输出中出现：

D/BluetoothSocket(12234): 创建 BluetoothSocket: type = 1, fd = -1, uuid = [00001101-0000-1000-8000-00805f9b34fb], port = -1

我正在三星 Galaxy S Plus 上进行测试。有什么线索吗？

# java - 模型-视图-控制器中的后端，Java

> ID：10710864
> 
> 赞同：1
> 
> 时间：2012-05-22T22:06:20.427
> 
> 标签：java, model-view-controller, model, backend

在设计模式Model-View-Controller（MVC）中，后端数据库是Model层的一部分，还是与Model分离？

此外，是否可以说 MySQL 数据库不是 Model 的一部分，因为它与 Java 代码分开放置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T00:20:33.297

数据库是持久化的，而不是真正的 MVC 模式的一部分（尽管将模型状态持久化到数据库是很常见的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T23:36:49.233

[Wikipedia](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)将模型定义为“*表示应用程序状态的域对象或数据结构。* ”考虑到这一点，我们可以看到虽然数据库不是严格的代码库的一部分，但它仍然表示（保存）使用的数据，并且因此（至少在某种程度上）是模型的一部分。如果您尝试考虑为什么它不会成为控制器或视图的一部分（两者都应该与模型一起使用，而不是直接单独使用），则更容易看到这一点。

现在，就像@John Doe 发布的图片一样，您会看到为了保留 MVC 结构，您需要*通过模型提供**到*数据库的接口。

 *作为一个过度简化的示例，您可以考虑编写如下内容：

```
public ModelDatabaseWrapper implements ModelReadWriteInterface {
    public ModelDatabaseWrapper() {
        /* Prepares to use database... */
    }

    public Object getValue(Object someQuery) throws ModelReadException {
        /* Get something from it... */
    }

    public void putData() throws ModelWriteException {
        /* Insert something int to it... */
    }

    private DataBaseHandle db;
} 
```

这只是一个指导方针，但我会强调`interface`根据访问方式对模型组件进行分组的通用点。在实际应用程序中，除了数据库之外，还可以有多种表示数据和状态的形式，因此通过保持干净的 API 可以让 Controller 和 View 更加灵活。

我希望我有所帮助！:)*

# wordpress - 如何仅从事件日历 wordpress 插件显示当月的事件？

> ID：10710866
> 
> 赞同：0
> 
> 时间：2012-05-22T22:06:54.813
> 
> 标签：wordpress

我的网站上有一个包含事件列表的小部件。我想将上/下个月按钮添加到小部件，所以我需要一种方法来按月过滤来自 The Event Calendar 插件的结果。

有谁知道实现这一目标的方法？我没有看到可以传递给tribe_get_events 数组的参数列表。

这是我现在使用的代码：

```
global $post;
$all_events = tribe_get_events(array(
'eventDisplay'=>'all',
'posts_per_page'=>-1
)); 
```

所以我想做的是：

```
global $post;
$all_events = tribe_get_events(array(
'eventDisplay'=>'all',
'month'=>'may',
'posts_per_page'=>-1
)); 
```

只是不完全确定获取当前月份的参数的正确名称。

提前感谢您的帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T04:02:48.090

我想出了如何使用 The Event Calendar Wordpress 插件一次获得一个月。

我正在使用的代码如下所示：

```
global $post;

if (isset($_GET['setmonth'])) {
$current_month = $_GET['setmonth']; // this grabs the month from the url
} else {
$current_month = date('M'); // This gets the current month
}

$all_events = tribe_get_events(array(
'eventDisplay'=>'all',
'posts_per_page'=>-1,
'start_date'=>'01 '.$current_month.' 2012',
'end_date'=>'31 '.$current_month.' 2012'
 )); 
```

# c - 用于简单计算的 CUDA 加速

> ID：10710867
> 
> 赞同：0
> 
> 时间：2012-05-22T22:07:00.167
> 
> 标签：c, cuda

我有以下代码`cuda_computation.cu`

```
#include <iostream>
#include <stdio.h>
#include <cuda.h>
#include <assert.h>

void checkCUDAError(const char *msg);

__global__ void euclid_kernel(float *x, float* y, float* f)
{
  int idx = blockIdx.x*blockDim.x + threadIdx.x;
  int i = blockIdx.x;
  int j = threadIdx.x;
  f[idx] = sqrt((x[i]-x[j])*(x[i]-x[j]) + (y[i]-y[j])*(y[i]-y[j]));
}
int main()
{
  float *xh;
  float *yh;
  float *fh;
  float *xd;
  float *yd;
  float *fd;

  size_t n = 256;
  size_t numBlocks = n;
  size_t numThreadsPerBlock = n;

  size_t memSize = numBlocks * numThreadsPerBlock * sizeof(float);
  xh = (float *) malloc(n * sizeof(float));
  yh = (float *) malloc(n * sizeof(float));
  fh = (float *) malloc(memSize);

  for(int ii(0); ii!=n; ++ii)
    {
      xh[ii] = ii;
      yh[ii] = ii;
    }

  cudaMalloc( (void **) &xd, n * sizeof(float) );
  cudaMalloc( (void **) &yd, n * sizeof(float) );
  cudaMalloc( (void **) &fd, memSize );
  for(int run(0); run!=10000; ++run)
    {
      //change value to avoid optimizations
      xh[0] = ((float)run)/10000.0;
      cudaMemcpy( xd, xh, n * sizeof(float), cudaMemcpyHostToDevice );
      checkCUDAError("cudaMemcpy");
      cudaMemcpy( yd, yh, n * sizeof(float), cudaMemcpyHostToDevice );
      checkCUDAError("cudaMemcpy");
      dim3 dimGrid(numBlocks);
      dim3 dimBlock(numThreadsPerBlock);
      euclid_kernel<<< dimGrid, dimBlock >>>( xd, yd, fd );
      cudaThreadSynchronize();
      checkCUDAError("kernel execution");
      cudaMemcpy( fh, fd, memSize, cudaMemcpyDeviceToHost );
      checkCUDAError("cudaMemcpy");
    }
  cudaFree(xd);
  cudaFree(yd);
  cudaFree(fd);
  free(xh);
  free(yh);
  free(fh);
  return 0;
}

void checkCUDAError(const char *msg)
{
  cudaError_t err = cudaGetLastError();
  if( cudaSuccess != err) 
    {
      fprintf(stderr, "Cuda error: %s: %s.\n", msg, cudaGetErrorString( err) );
      exit(-1);
    }                         
} 
```

在 FX QUADRO 380 上运行大约需要 6 英寸，而仅使用一个 i7-870 内核的相应串行版本只需大约 3 英寸。我错过了什么吗？代码在某些方面是否优化？还是只是预期的行为，对于简单的计算（比如这个所有对欧几里得距离），移动内存所需的开销超过了计算增益？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T13:53:10.593

您正在拆分问题，以便每个块负责一个 i 与所有 256 个 j。这是一个糟糕的局部性，因为必须为每个块重新加载这 256 个 j，总共加载 2*256*(256 + 1) 个。相反，拆分您的网格，以便每个块负责一个范围，例如 16 个 i 和 16 个 j，这仍然是 256 个块 * 256 个线程。但是现在每个块只加载 2*(16+16) 个值，总共或 2*256*32 个总负载。这个想法是，尽可能多次重用每个加载的值。这可能不会对 256x256 产生巨大影响，但随着尺寸的扩大，它变得越来越重要。

这种优化用于有效的矩阵乘法，它具有类似的局部性问题。有关详细信息，请参阅[http://en.wikipedia.org/wiki/Loop_tiling](http://en.wikipedia.org/wiki/Loop_tiling)或谷歌“优化矩阵乘法”。或许NVIDIA SDK中的矩阵乘法内核给出了一些细节和想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T22:29:02.493

我认为您正在被移动数据的时间杀死。特别是由于您使用单个值调用 CUDA 内核，因此将大量值作为一维数组上传并对其进行操作可能会更快。

同样 sqrt 没有在 Cuda 上的硬件中完成（至少不是在我的 GPU 上），而 CPU 已经为此优化了 FPU 硬件，并且可能比 GPU 快 10 倍，对于这样的小工作可能会保留所有结果在 timign 运行之间缓存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T00:10:43.847

减少全局内存读取，因为它们很昂贵。每个线程有 4 次全局内存读取，使用共享内存可以减少到 2 次。

```
__global__ void euclid_kernel(const float * inX_g, const float* inY_g, float * outF_g)
{
    const unsigned int threadId = blockIdx.x * blockDim.x + threadIdx.x;

    __shared__ float xBlock_s;
    __shared__ float yBlock_s;

    if(threadIdx.x == 0)
    {
        xBlock_s = inX_g[blockIdx.x];
        yBlock_s = inY_g[blockIdx.x];
    }
    __syncthreads();

    float xSub = xBlock_s - inX_g[threadIdx.x];
    float ySub = yBlock_s - inY_g[threadIdx.x];

    outF_g[threadId] = sqrt(xSub * xSub + ySub * ySub);
} 
```

您还应该使用不同的块大小进行测试（只要您有 100% 的占用率）。

# c# - 类内委托的默认值

> ID：10710870
> 
> 赞同：2
> 
> 时间：2012-05-22T22:07:19.760
> 
> 标签：c#, delegates

```
using System;

public delegate void Printer(string s);

class Program
{
    public static void Main(string[] args)
    {
        Printer p = new Printer(delegate {});
        p+= myPrint;
        p("Hello");
        Console.ReadKey(true);
    }

    public static void myPrint(string s)
    {
        System.Console.WriteLine(s);
    }
} 
```

似乎我必须用一个空的匿名函数初始化一个委托，以便`+=`以后可以使用。当我省略`new`子句时，`p`gets to be `null`and `+=`doesn't work，这是有道理的。

现在，当我有一个带有委托实例的类时，我可以执行以下操作：

```
using System;

public delegate void Printer(string s);

class Program
{
    public static void Main(string[] args)
    {
        A a = new A();
        a.p += myPrint;
        a.p("Hello");
        Console.ReadKey(true);
    }

    public static void myPrint(string s)
    {
        System.Console.WriteLine(s);
    }
}

class A {
    public Printer p;
} 
```

为什么允许这样做？委托实例是否有默认值`p`？不可能，`null`因为那样我将无法使用`+=`. 我试图用关键字搜索这个问题，但`"default value for delegates"`一无所获。另外，如果问题太基本，对不起。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T22:11:20.410

委托是引用类型，因此默认值为`null`.

但是，变量（与字段不同）默认情况下不会初始化：

```
Printer p;
p += myPrint; // doesn't work: uninitialized variable 
```

您需要先初始化变量，然后才能使用它：

```
Printer p = null;
p += myPrint; 
```

或者

```
Printer p;
p = null;
p += myPrint; 
```

* * *

请注意，对于代表（但不是事件！）

```
p += myPrint; 
```

是简写

```
p = (Printer)Delegate.Combine(p, new Printer(myPrint)); 
```

# javascript - javascript 事件中未定义的参数

> ID：10710876
> 
> 赞同：1
> 
> 时间：2012-05-22T22:08:00.553
> 
> 标签：javascript

当我单击锚点时，我发现它`date`没有定义。我应该如何确保参数在我传递给的自调用函数的范围内`onclick`？

```
var date = today; // today is well-defined at this point.

html += '<a onclick="(function(obj, myDate) { \
        return function() { \
           obj.render(myDate.setMonth(myDate.getMonth() - 1));  \
        };  \
      })(this, date);">&lt;</a>' 
```

编辑：这个 HTML 有效吗？

`today`是明确的。这段代码位于此函数中：

```
Calendar.prototype.render = function(date) {

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T22:49:27.010

引发事件时，它拥有的唯一上下文是窗口上下文。

您必须设置一个全局变量，以便在使用`on<event>`属性时它在事件回调代码中可用。

# json - Scala 使用 Jerkson 将元组转换为 JSON

> ID：10710887
> 
> 赞同：4
> 
> 时间：2012-05-22T22:08:43.157
> 
> 标签：json, scala

代码片段在`REPL`

```
scala> import com.codahale.jerkson.Json._
scala> val t = (1, 3.14, "Fred")
scala> generate(t)
res5: String = {"_1":1,"_2":3.14,"_3":"Fred"} 
```

在输出中，我想将标签分配给属性而不是`_1`, `_2`, `_3`。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:13:10.170

使用 a`case class`而不是元组：

```
case class Named(myInt: Int, thisDouble: Double, desc: String)
generate(Named(1, 3.14, "Fred")) 
```

给出：

```
{"myInt": 1.0,"thisDouble":3.14,"desc":"Fred"} 
```

# android - 向对话框添加积极按钮

> ID：10710888
> 
> 赞同：9
> 
> 时间：2012-05-22T22:08:43.250
> 
> 标签：android, android-layout

我有一个非常简单的自定义对话框，我不想在不修改 XML 文件的情况下添加肯定按钮，就像您使用 AlertDialog 一样，但我不知道这是否可能。这是代码：

```
final Dialog dialog = new Dialog(MyActivity.this);
dialog.requestWindowFeature(Window.FEATURE_LEFT_ICON);
dialog.setContentView(R.layout.dialog);
dialog.setTitle("Settings");
dialog.show(); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-22T22:24:46.427

您应该使用构建器。

```
LayoutInflater inflater = LayoutInflater.from(this);
View dialog_layout = inflater.inflate(R.layout.dialog,(ViewGroup) findViewById(R.id.dialog_root_layout));
AlertDialog.Builder db = new AlertDialog.Builder(MyActivity.this);
db.setView(dialog_layout);
db.setTitle("settings");
db.setPositiveButton("OK", new DialogInterface.OnClickListener() {
    public void onClick(DialogInterface dialog, int which) {
    }
});
AlertDialog dialog = db.show(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T22:18:33.603

您可以使用 AlertDialog.Builder 类：

[http://developer.android.com/reference/android/app/AlertDialog.Builder.html](http://developer.android.com/reference/android/app/AlertDialog.Builder.html)

使用 .创建它的新实例`AlertDialog.Builder myAlertDialogBuilder = new AlertDialog.Builder(context)`。然后使用 和 等方法`setTitle()`对其`setView()`进行自定义。这个类也有设置按钮的方法。 `setPositiveButton(String, DialogInterface.OnClickListener)`设置您的按钮。最后，用于`AlertDialog myAlertDialog = myAlertDialogBuilder.create()`获取您的 AlertDialog 实例，然后您可以使用诸如`setCancelable()`.

编辑：另外，来自文档：http: [//developer.android.com/guide/topics/ui/dialogs.html](http://developer.android.com/guide/topics/ui/dialogs.html)

“Dialog 类是创建对话框的基类。但是，您通常不应该直接实例化 Dialog。相反，您应该使用...子类之一”

如果您真的不想使用 AlertDialog，最好自己扩展 Dialog 类，而不是按原样使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-18T03:26:48.433

您也可以使用此功能

```
public void showMessage(String title,String message)
{
    AlertDialog.Builder builder=new AlertDialog.Builder(this);
    builder.setCancelable(true);
    builder.setTitle(title);
    builder.setMessage(message);
    builder.setPositiveButton("OK", new
            DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                }
            });
    builder.show();
} 
```

# node.js - 预编译车把模板

> ID：10710891
> 
> 赞同：5
> 
> 时间：2012-05-22T22:08:59.617
> 
> 标签：node.js, handlebars.js

我想知道保存预编译的车把模板并将它们包含在 HTML 文件中的最佳方法是什么。

该网站：[http](http://handlebarsjs.com/precompilation.html) ://handlebarsjs.com/precompilation.html只是建议致电

> 车把输入文件 -f 输出文件

我将模板放在文件中并调用命令。我有一个包含函数*program1*的 JS 文件我现在如何编译第二个模板？[http://jsperf.com/jquery-template-vs-handlebars](http://jsperf.com/jquery-template-vs-handlebars)上的示例包含多个名为`program[1-9](...)`我假设它们必须以某种方式生成的函数。存储预编译的模板是个好建议吗？我看到示例在 HTML 文件中嵌入脚本或链接标签并遍历它们并通过 AJAX 加载模板并动态编译它们。

最好的，伯恩哈德

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-25T21:32:08.760

如果您想要多个文件，请在命令中列出它们，如下所示

```
handlebars file1 file2 file3 -f outfile 
```

您确实希望为您的生产站点存储预编译文件，因为它大大减少了加载时间。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-07T08:53:14.837

你应该使用

```
handlebars /path/to/templates/*.handlebars -f /path/to/output/templates.js 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-10T10:51:43.947

最简单的方法，前提是您要保留带有 html 扩展名的模板：handlebars html

即：车把./ -e html -f precompiled_templates.js

# jquery - 在外部托管的 css（特别是 Google CDN jquery-ui.css）中覆盖/删除某些属性的最佳方法是什么？

> ID：10710894
> 
> 赞同：10
> 
> 时间：2012-05-22T22:09:13.253
> 
> 标签：jquery, css, jquery-ui, google-cdn

我正在使用 Google CDN 托管[jQuery UI 主题的 CSS 之一](http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.17/themes/smoothness/jquery-ui.css)。

但是，我想覆盖一些 css 属性。

我知道可以使用 jQuery`.removeClass()`或来做到这一点`.css()`，但是我可以用我自己的 css 文件来做到这一点吗？

例如，在 jQuery UI 主题的 css 中，有

```
.ui-widget {
    font-family: Verdana, Arial, sans-serif;
    font-size: 1.1em;
} 
```

我将如何删除该`font-size`属性？我不需要覆盖它。我只想完全删除它，以便默认`font-size`返回`body`.`0.75em`

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-23T16:08:23.453

正如@thirtydot 在评论中所述， to的`font-size`属性。`.ui-widget``inherit`

# .net - 从 .Net 属性获取 VBScript 中的活动网络连接

> ID：10710903
> 
> 赞同：1
> 
> 时间：2012-05-22T22:10:05.403
> 
> 标签：.net, scripting, vbscript, wmi

有一种用于检索 TCP 和 UDP 连接信息的 .NET 方法，如下所示：

```
[Net.NetworkInformation.IPGlobalProperties]::GetIPGlobalProperties().GetActiveTcpConnections()
[Net.NetworkInformation.IPGlobalProperties]::GetIPGlobalProperties().GetActiveUdpConnections() 
```

我很好奇是否有办法通过 VBScript 来做同样的事情？我想要所有连接的输出，类似于*netstat -an*输出，在我用于网络文档的 VBscript 中返回。如果这可以通过 WMI 查询实现，我也会对此感兴趣。

以下是列出的 .Net 方法的一些参考链接：

*   [GetActiveTcpConnection](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ipglobalproperties.getactivetcplisteners)
*   [GetActiveUdpConnection](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ipglobalproperties.getactiveudplisteners)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T05:03:06.000

最好的办法是使用 PowerShell，它可以直接访问 .NET。

另一种选择是从 WScript.Shell 运行 Netstat.exe 并解析结果，根据 [带有 WMI 和 VBScript 的 Netstat](https://stackoverflow.com/questions/10706401/netstat-with-wmi-and-vbscript)。

# java - 在 Java 中调试生成文件

> ID：10710906
> 
> 赞同：0
> 
> 时间：2012-05-22T22:10:19.507
> 
> 标签：java, makefile

我不知道如何解决项目构建时出现的错误。有什么建议可以解决这个问题吗？语言是Java。

```
make[1]: *** No rule to make target `org/zeromq/ZMQ$Context.class', needed by `all'.  Stop. 
```

根据以下建议，此输出来自`make -d`：

```
Considering target file `org/zeromq/ZMQ$Context.class'.
File `org/zeromq/ZMQ$Context.class' does not exist.
Looking for an implicit rule for `org/zeromq/ZMQ$Context.class'.
Trying pattern rule with stem `ZMQ$Context.class'.
Trying implicit prerequisite `org/zeromq/ZMQ$Context.class.cpp'.
Trying pattern rule with stem `ZMQ$Context.class'.
Trying implicit prerequisite `org/zeromq/ZMQ$Context.class.o'.
Trying pattern rule with stem `ZMQ$Context.class'.
Trying implicit prerequisite `org/zeromq/ZMQ$Context.class,v'.
...
Must remake target `org/zeromq/ZMQ$Context.class'.
make[1]: *** No rule to make target `org/zeromq/ZMQ$Context.class', needed by `all'.  Stop. 
```

因此，看起来 make 不够聪明，无法查看`ZMQ.java`'`ZMQ$Context.class`的定义。这是我的版本`make`有问题还是图书馆所有者提供给我的makefile有问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:18:29.033

当然是一个简短的问题。答案可能是`man make`。

您将发现`-d`通用调试选项使冗长甚至`--debug=FLAG`将输出减少到不那么冗长的调试级别。

在您的特定情况下，Make 尝试查找生成所需的源文件，`org/zeromq/ZMQ$Context.class`并且 Makefile 规则可能不够聪明，无法猜测它必须从`org/zeromq/ZMQ.java`.

# couchdb - ektorp / CouchDB 更新 / 同步文件夹

> ID：10710907
> 
> 赞同：0
> 
> 时间：2012-05-22T22:10:33.733
> 
> 标签：couchdb, ektorp

在 jcouchdb 中有一个实用类 org.jcouchdb.util.CouchDBUpdater，它允许将文档从本地文件系统更新到 CouchDB（例如用于将设计文档复制到 CouchDB）。ektorp 有类似的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T07:00:26.173

你有两个选择：

1.  使用@View、@GenerateView、@Filter、@ShowFuction、@ListFuction 注释将您的设计文档嵌入到您的存储库类中。相应的设计文档将在应用程序启动时自动更新。请参阅[http://ektorp.org/reference_documentation.html#d100e753](http://ektorp.org/reference_documentation.html#d100e753)

2.  实现一个 org.ektorp.dataload.DataLoader，它允许您使用任何类型的文档引导您的数据库。请参阅[http://ektorp.org/reference_documentation.html#d100e1170](http://ektorp.org/reference_documentation.html#d100e1170)

# ios - 分享 iOS 自定义 url 链接

> ID：10710908
> 
> 赞同：0
> 
> 时间：2012-05-22T22:10:40.473
> 
> 标签：ios, url, sharing

我有一个注册了自定义 url 方案的移动应用程序。该应用程序还启用了社交共享功能，允许用户在 Facebook、Twitter 和电子邮件上共享应用程序内的深层链接。

我与此相关的问题是如何干净地处理在非 ios 设备（如 PC 或 Android 设备）上打开此自定义 iOS url 的情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:37:42.310

检测设备并根据该设备更改 URL 方案。如果您使用的是 HTML，则可以使用 jQuery 插件。请参阅此链接：[在 jQuery 中检测移动设备的最佳方法是什么？](https://stackoverflow.com/questions/3514784/best-way-to-detect-handheld-device-in-jquery)

# perl - Template::Toolkit 变量处理

> ID：10710909
> 
> 赞同：5
> 
> 时间：2012-05-22T22:10:55.153
> 
> 标签：perl, templates, toolkit

我正在使用 perl 中的 TT，并尝试插入模板并处理一个变量，该变量本身包含 TT 指令。

所以，在脚本中我写的是：

```
$var{descr} = "[% pid = 1; INSERT plink.par %]"; 
```

然后在 TT 模板（收到 \%var）中：

```
[% BLOCK parsedDescr %]
[% descr %]
[% END %]
<p>[% INCLUDE parsedDescr %] 
```

我期待 pid 变量设置为“1”，并插入 plink.par 文件。但相反，我在我的 html 页面上得到了变量 descr 的确切内容：

```
[% pid = 1; INSERT plink.par %] 
```

即，该变量未被TT处理。

如何让 TT 处理它的内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T22:43:55.247

您可以使用[eval 过滤器](http://template-toolkit.org/docs/manual/Filters.html#section_eval_evaltt)：

```
<p>[% descr | eval %] 
```

从链接的手册页：

> eval 过滤器将块评估为模板文本，处理嵌入其中的任何指令。这允许模板变量包含模板片段，或者提供一些方法来从外部源（例如数据库）返回模板片段，然后可以根据需要在模板中对其进行处理。

# windows - Windows 中的进程创建开销是多少？

> ID：10710912
> 
> 赞同：24
> 
> 时间：2012-05-22T22:11:04.903
> 
> 标签：windows, process

我一直听说在 Windows 中创建一个新进程非常昂贵。但我找不到确切的数字。是否有大致的循环次数？2GHz 双核处理器需要多少毫秒？

我用 Python 编写了一个测试程序，并测量了每个进程 5ms，但我不知道其中有多少是 Python 的额外开销。我估计不多。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2014-10-22T19:39:00.553

有趣的问题！

如前所述，开销很高。出于好奇，是否已经快速编写了一个小基准来获得一些经验，以了解创建线程和进程需要多长时间以及这些时间之间的关系。

```
#include <windows.h>
#include <stdio.h>
#include <conio.h>

#define MIN   0
#define AVG   1
#define MAX   2

DWORD WINAPI thread(LPVOID lpvData)
{
    return (0);
}

int main()
{
    BOOL result;
    int iteration;
    int i;
    STARTUPINFO si;
    PROCESS_INFORMATION pi;
    DWORD tStart;
    DWORD tEllapsed;
    double tCall;
    int spawnCount;
    HANDLE hThread;
    DWORD threadId;
    double ratio;
    double statCreateProcess[3];
    double statCreateThread[3];

    for (iteration = 0; iteration < 16; iteration++)
    {
        /*
        **  Measure creation time of process
        */
        tEllapsed = 0;
        spawnCount = 0;
        for (i = 0; i < 100; i++)
        {
            ZeroMemory(&si, sizeof(si));
            si.cb = sizeof(si);
            ZeroMemory(&pi, sizeof(pi));

            tStart = GetTickCount();
            result = CreateProcess(NULL,
                                   "cmd.exe",
                                   NULL,
                                   NULL,
                                   FALSE,
                                   NORMAL_PRIORITY_CLASS,
                                   NULL,
                                   NULL,
                                   &si,
                                   &pi);

            if (result != FALSE)
            {
                tEllapsed += GetTickCount() - tStart;
                spawnCount++;

                // clean up...
                TerminateProcess(pi.hProcess, 0);
                CloseHandle(pi.hThread);
                CloseHandle(pi.hProcess);
            }
        }
        tCall = tEllapsed / (double)spawnCount;
        printf("average creation time of process: %0.3fms\n", tCall);

        // track statistics...
        if (iteration > 0)
        {
            if (statCreateProcess[MIN] > tCall)
                statCreateProcess[MIN] = tCall;
            statCreateProcess[AVG] += tCall;
            if (statCreateProcess[MAX] < tCall)
                statCreateProcess[MAX] = tCall;
        }
        else
        {
            statCreateProcess[MIN] = tCall;
            statCreateProcess[AVG] = tCall;
            statCreateProcess[MAX] = tCall;
        }

        /* measure creation time of thread */
        spawnCount = 0;
        tStart = GetTickCount();
        for (i = 0; i < 5000; i++)
        {           
            hThread = CreateThread(NULL,
                                   0,
                                   thread,
                                   NULL,
                                   0,
                                   &threadId);
            if (hThread != NULL)
            {
                spawnCount++;

                // clean up...
                CloseHandle(hThread);
            }
        }
        tEllapsed = GetTickCount() - tStart;
        tCall = tEllapsed / (double)spawnCount;
        printf("average creation time of thread: %0.3fms\n", tCall);

        // track statistics...
        if (iteration > 0)
        {
            if (statCreateThread[MIN] > tCall)
                statCreateThread[MIN] = tCall;
            statCreateThread[AVG] += tCall;
            if (statCreateThread[MAX] < tCall)
                statCreateThread[MAX] = tCall;
        }
        else
        {
            statCreateThread[MIN] = tCall;
            statCreateThread[AVG] = tCall;
            statCreateThread[MAX] = tCall;
        }
    } /* for (iteration = ...) */

    statCreateProcess[AVG] /= iteration;
    statCreateThread[AVG] /= iteration;

    printf("\n\n--- CreateProcess(..) ---\n");
    printf("minimum execution time ...: %0.3fms\n", statCreateProcess[MIN]);
    printf("average execution time ...: %0.3fms\n", statCreateProcess[AVG]);
    printf("maximum execution time ...: %0.3fms\n", statCreateProcess[MAX]);
    printf("\n--- CreateThread(..) ---\n");
    printf("minimum execution time ...: %0.3fms\n", statCreateThread[MIN]);
    printf("average execution time ...: %0.3fms\n", statCreateThread[AVG]);
    printf("maximum execution time ...: %0.3fms\n", statCreateThread[MAX]);

    ratio = statCreateProcess[AVG] / statCreateThread[AVG];
    printf("\n\nratio: %0.3f\n\n", ratio);

    getch();
    return (0);
} 
```

我已经在我的计算机（i5 3.2GHz；Windows 7）上运行了几次，如果关闭防病毒应用程序并且从 Visual Studio 外部启动基准测试，这些值非常一致：

```
--- CreateProcess(..) ---
minimum execution time ...: 11.860ms
average execution time ...: 12.756ms
maximum execution time ...: 14.980ms

--- CreateThread(..) ---
minimum execution time ...: 0.034ms
average execution time ...: 0.037ms
maximum execution time ...: 0.044ms

ratio: 342.565 
```

正如预期的那样，CreateProcess(..) 的变化更大，因为涉及更多的系统调用并且被另一个线程中断的可能性更高。请记住，创建线程的时间甚至更短，因为时间测量包括整个控制循环（否则 GetTickCount(..) 将太不准确而无法测量时间）。

在运行 Windows XP 的虚拟 PC 上进行的另一项测试（在上述同一台机器上运行）产生以下值：

```
--- CreateProcess(..) ---
minimum execution time ...: 22.630ms
average execution time ...: 24.666ms
maximum execution time ...: 27.340ms

--- CreateThread(..) ---
minimum execution time ...: 0.076ms
average execution time ...: 0.086ms
maximum execution time ...: 0.100ms

ratio: 287.982 
```

有趣的是，CreateProcess(..) 和 CreateThread(..) 的平均执行时间的比率非常接近。

看到其他机器和 Windows 版本的价值会很有趣。如果大约 300 的比率在不同的机器和 Windows 版本上大致相同，我不会感到惊讶。

所以让我们得出结论： CreateProcess( ..) 在 Windows 上比 CreateThread(..) 慢得多**。**但实际上我很震惊它真的慢了多少......

# python - python, xmlrpc, tidy & unicode 问题

> ID：10710915
> 
> 赞同：-2
> 
> 时间：2012-05-22T22:11:28.723
> 
> 标签：python, unicode, xml-rpc, tidy

两天来，我一直在努力解决我面临的问题。

最终目标是将苹果 wiki 服务器的内容迁移到 foswiki/twiki 标记。

我找到了一个 xslt 样式表，它可以完成大部分工作，并且做得相当好，而且速度很快。要使用它，我需要做的就是为其提供格式良好的 (X)HTML，这就是 tidy 的用武之地——苹果 wiki 数据结构的“内容”字符串中有很多 HTML 标签，但不完整。

使用 xmlrpc 内省，未记录的苹果 API 几乎可以使用，并在苹果论坛上散布一些提示。

现在尝试使用 tidy 给了我：

```
UnicodeEncodeError: 'ascii' codec can't encode character u'\u2013' in position 121: ordinal not in range(128) 
```

显然，我搜索了这个错误消息，发现了几篇文章，包括 Stackoverflow 上的一些文章，但它们似乎表明这是我正在使用的终端的编码问题。但是， LANG=en_US.UTF-8 在这里，所以这不是我的问题的原因。

我找到了一篇建议摆脱 BOM 的文章，但这样做我创建了一个新的错误消息，对我来说毫无意义：

```
UnicodeDecodeError: 'ascii' codec can't decode byte 0xef in position 0: ordinal not in range(128) 
```

这是相关的代码片段：

```
pages = {}

paths = s.groupsForSession(session_id) # paths is a list of groups that user can read on that server
for aPath in paths:
  entries = s.wiki.getEntries(session_id, aPath)
  # entries = s.search.getEntries(session_id, aPath)
  pprint.pprint(entries)

  for uid in entries:
    try:
      entry = s.wiki.getEntryWithUID(session_id, uid['uid'])
    except Exception, e:
      print e.faultString
      raise Exception
    pages[uid['uid']] = entry
    pprint.pprint(  pages[uid['uid']]['content'])
    print(
      tidy.parseString(
        str(
          unicode(
              pages[uid['uid']]['content'].strip(codecs.BOM_UTF8), 'utf-8'
          )
        ),
        **options
        )
      ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T22:41:18.453

正如@oefe 所建议的：

再做几次实验后，我得到了我想要的；看起来关于编码问题的消息让我叫错了树。问题的解决方案非常简单。

```
tidy.parseString( str( pages[uid['uid']]['content'].encode('utf-8') ), **options ) 
```

# .htaccess - 从服务器到本地主机的重复 magento 存储 - > url 重写错误

> ID：10710918
> 
> 赞同：0
> 
> 时间：2012-05-22T22:11:37.883
> 
> 标签：.htaccess, magento, url-rewriting, relative-path, base-url

我将我的 magento 商店复制到我的本地 xampp 服务器。现在，没有显示使用相对 url 引用的图像（例如按钮）。

在 phtml 文件中，这些图像是通过

```
<img src=/skin/default/default/images/button.jpg> 
```

当我给他们一个绝对网址时

```
<img src=http://localhost/magento-test/skin/default/default/images/button.jpg> 
```

有用。我尝试修改我的本地 .htaccess

```
RewriteBase /magento-test/ 
```

和

```
RewriteBase / 
```

我还在后端更改了禁用和可结束的 URL 重写。我也有

```
 http://localhost/magento-test/ 
```

作为我在后端的基本网址。

但是这些图像仍然没有出现在我的本地前端。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T12:17:45.343

为了避免像这样的很多麻烦，您应该使用`getSkinUrl()`模板文件中的方法引用您的图像。例如，您将使用：

```
<img src="<?php echo $this->getSkinUrl('images/button.jpg') ?>" /> 
```

这会在您的管理区域中使用适当的 URL 构建对您的图像的绝对引用。

# android - Android 扩展文件库设置

> ID：10710922
> 
> 赞同：3
> 
> 时间：2012-05-22T22:11:53.540
> 
> 标签：android, expansion

我一直在尝试实现扩展文件，但没有成功。我已将用于许可、扩展和 zip 文件的库作为外部 jar 文件包含到示例项目中，一切似乎都很好，所有错误都消失了。但是，当我运行该程序时，我收到一条错误消息：

“05-22 17:49:05.377: E/AndroidRuntime(10197): java.lang.NoClassDefFoundError: com.android.vending.expansion.downloader.R$string”

程序崩溃。如何解决此错误，以便我可以使用测试然后使用扩展库？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T23:15:07.207

扩展文件必须作为 Android 库项目而不是 jar 文件包含在内。这允许将下载器库中使用的资源添加到主项目的资源中。

# mongodb - 在 python 中更新 mongo

> ID：10710923
> 
> 赞同：-1
> 
> 时间：2012-05-22T22:12:06.473
> 
> 标签：mongodb, pymongo

我有一个关于更新 mongo 集合的非常基本的问题。

假设我有一个这样的 mongo 文档：

```
{"Object_id:.....,"product_id":1234, "color":0}
{"Object_id:.....,"product_id":1234, "color":1} # note the same product_id
{"Object_id:.....,"product_id":12345, "color":0} 
```

现在我想要的是：

if product_id == 1234 and color == 1: # 将该文档修改为 color = 2

更新后

```
{"Object_id:.....,"product_id":1234, "color":0}
{"Object_id:.....,"product_id":1234, "color":2} # note the same product_id
{"Object_id:.....,"product_id":12345, "color":0} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:37:05.650

从字面上做你想做的事是：

```
db.foo.update({"product_id" : 1234, "color" : 1}, {$set : {"color" : 2}}) 
```

如果您多次出现 product_id == 1234 和 color == 1 并且您想在找到时更新它们，那么它是：

```
db.foo.update({"product_id" : 1234, "color" : 1}, {$set : {"color" : 2}}, false, true) 
```

# ruby-on-rails - 在 Rails 3.2 的模型关系中找不到源关联：followed_id

> ID：10710928
> 
> 赞同：8
> 
> 时间：2012-05-22T22:12:22.167
> 
> 标签：ruby-on-rails, associations, relationship, railstutorial.org

请求示例应用程序的主页时，我收到以下错误消息（遵循 Michael Hartl 的教程第 11 章）：

> "ActiveRecord::HasManyThroughSourceAssociationNotFoundError in Pages#home"
> "在模型关系中找不到源关联：followed_id。尝试 'has_many :followed_users, :through => :relationships, :source => '。它是以下之一：追随者或：已关注？”

这真的很奇怪，因为我完全按照教程的说明进行操作。我什至复制粘贴了每一个代码片段。

我的用户模型（摘录）：

```
 class User < ActiveRecord::Base 

    has_many :relationships, foreign_key: "follower_id", dependent: :destroy
    has_many :followed_users, through: :relationships, source: "followed_id"

    has_many :reverse_relationships, foreign_key: "followed_id", class_name: "Relationship", dependent: :destroy
    has_many :followers, through: :reverse_relationships, source: :follower 
```

我的关系模型：

```
 class Relationship < ActiveRecord::Base
    attr_accessible :followed_id

    belongs_to :follower, class_name: "User"
    belongs_to :followed, class_name: "User"

    validates :follower_id, presence: true
    validates :followed_id, presence: true
  end 
```

我的迁移文件：

```
 class CreateRelationships < ActiveRecord::Migration
    def change
      create_table :relationships do |t|
        t.integer :follower_id
        t.integer :followed_id

        t.timestamps
      end

      add_index :relationships, :follower_id
      add_index :relationships, :followed_id
      add_index :relationships, [:follower_id, :followed_id], unique: true
    end
  end 
```

我一直在尝试解决这个问题，但我根本不知道问题可能是什么（教程中的确切代码副本）。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-01T16:24:47.323

发现错误：在我的用户模型中，我必须更改

```
 has_many :followed_users, through: :relationships, source: "followed_id" 
```

到

```
 has_many :followed_users, through: :relationships, source: :followed 
```

似乎是 Hartl 的教程清单 11.10 [http://ruby.railstutorial.org/book/ruby-on-rails-tutorial#code:has_many_following_through_relationships](http://ruby.railstutorial.org/book/ruby-on-rails-tutorial#code:has_many_following_through_relationships)中的一个错字，因为我从那里获得了“来源：”followed_id“”代码。

我从 Hartl 的 github“示例应用程序”中获得了固定代码。

# c++ - 返回驱动器号列表的程序

> ID：10710936
> 
> 赞同：2
> 
> 时间：2012-05-22T22:13:13.487
> 
> 标签：c++, windows, winapi

在我的计算机示例中，所需的输出应该是： "C: E: F: H: N:" 。我知道这是可能的，但最简单的方法是什么？在 QueryDosDevice 输出中进行操作

```
#ifndef UNICODE
#define UNICODE
#endif

#include <Windows.h>
#include <fstream>
#include <iostream>

const int REPORT_LENGTH = 5000;

int main(void)
{
    TCHAR targetPath[REPORT_LENGTH];

    std::ofstream oFile;

    oFile.open("dos device query.txt");

    QueryDosDevice(NULL,targetPath,REPORT_LENGTH);

    for(int i=0; i<REPORT_LENGTH;i++)
    if (targetPath[i]=='\0')(targetPath[i]='\n');

    for(int i=0; i<REPORT_LENGTH; i++)
    oFile<<static_cast<char>(targetPath[i]);

    oFile.close();

    return 0;
} 
```

将是巨大的时间和资源浪费。[GetLogicalDriveStrings](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364975%28v=vs.85%29.aspx)函数也背叛了我很多。

```
#include <Windows.h>

int main()
{
    TCHAR buffer[50];

    GetLogicalDriveStrings(50,buffer);

    MessageBox(0,buffer,"Drives in the system",MB_OK); 

    return 0;
} 
```

它仅显示“C:\”音量。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T22:20:28.097

带有 的示例`GetLogicalDrives`，尽管不是连接到字符串（留给 OP 和读者作为练习；））：

```
#include <stdio.h>
#include <tchar.h>
#include <Windows.h>

int __cdecl _tmain(int argc, _TCHAR *argv[])
{
    // Get the bit mask of drive letters
    DWORD drives = ::GetLogicalDrives();
    // Go through all possible letters from a to z
    for(int i = 0; i < 26; i++)
    {
        // Check if the respective bit is set
        if(drives & (1 << i))
        {
            // ... and if so, print it
            _tprintf(TEXT("Drive %c: exists\n"), _T('A') + i);
        }
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T01:17:40.757

`GetLogicalDriveStrings()`是要走的路，你只需要正确使用即可。您假设它返回一个包含所有驱动器字符串的字符串，但事实并非如此。它返回一个字符串数组，每个驱动器一个，因此您必须循环遍历该数组：

```
#include <windows.h> 

int main() 
{ 
    TCHAR buffer[(4*26)+1] = {0}; 
    GetLogicalDriveStrings(sizeof(buffer) / sizeof(TCHAR), buffer); 

    for (LPTSTR lpDrive = buffer; *lpDrive != 0; lpDrive += 4)
        MessageBox(NULL, lpDrive, "Drive in the system", MB_OK);

    return 0; 
} 
```

# c# - 如何更改字符串或双精度的文化信息

> ID：10710937
> 
> 赞同：1
> 
> 时间：2012-05-22T22:13:25.257
> 
> 标签：c#, winforms, parsing, format, cultureinfo

我想更改双精度或字符串的 CultureInfo。

例如，我从 3015.0 格式的代码中获得双精度值

我不知道这是什么单位，但我需要以米为单位的值，而这些不是以米为单位，因为我在 cca.100m 的高度上

我试过了：`double.Parse(test, new System.Globalization.CultureInfo("hr-HR"));`

和`double.Parse(test, new System.Globalization.CultureInfo());`

但没有什么是我需要的正确格式。

知道我能做什么吗？如果这很重要，这是 Windows 窗体 C# 应用程序。框架 4.0

**编辑**：

正如您在此[链接](https://stackoverflow.com/questions/10556435/convert-from-british-coordinates-to-standard-wgs84-nmea)上看到的那样，我之前遇到过类似的问题，并且通过文化信息解决了。问题是图 1 上是我得到的值，而图 2 上是我需要得到的真实值（当我说真实时，我的意思是正确的格式）以前的问题我有十进制值的问题）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T22:30:54.513

这与文化信息无关。

看起来您正在以英尺为单位进行测量，而您期望它以米为单位。事实上，`100 meters = 328.08399 feet`您的测量值可能是 10 英尺，即`3015.0 = 301.5 feet`（一些 GPS 接收器不支持浮点数或双精度数，因此仅返回整数乘以 10 以获得一位小数精度）

如果您使用的是比预期便宜的 GPS 接收器，因为精度不是那么好（这可以解释为什么您得到 3015.0 而不是 3280）

我希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T22:22:40.920

您的问题与 CultureInfo 无关，而是与单位转换有关。可能您将不得不进行单位转换。你确定号码不是301.5吗？这可能意味着高度以英尺为单位。

```
double altitudeMeters = 0.3048 * altitudeFeet; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T22:17:53.697

当前文化的设置不会为您转换单位。它只影响数字的格式（例如，某些文化使用逗号而不是句点作为小数点）。您必须自己进行单位转换。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T22:18:13.247

`double.Parse`将简单地将字符串转换为数字。它不进行单位转换。不同的文化信息适用于有小数逗号（例如法语）等时。

您必须在应用程序中构建一些逻辑，以将数字从看起来像英尺的数字转换为米。如果您可以确定数据总是采用“错误”格式，那么简单的英尺到米（1 英尺 = 0.3048 米）的转换将起作用。鉴于这是一个 GPS 设备，您可能可以假设这一点。

如果数字可以是任何格式，那么您需要分析数字，如果它超出合理范围，请转换它。但是，如果有人输入“100”，这将失败。这是米还是英尺？

为确保获得正确的单位，您要么必须让用户在单独的控件上选择单位，要么将单位包含在输入字符串中。如果您执行后者，那么您将需要解析字符串以查看它是否包含单位字符串，将其剥离，解析数字和字符串，然后进行转换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T07:57:22.367

高度来自 $GPGGA 字符串，它指示正在使用的单位。$GPGGA 字符串是什么样的？

见[http://aprs.gids.nl/nmea/#gga](http://aprs.gids.nl/nmea/#gga)

如果您查看字符串中的原始数据，您将知道您是否收集了正确的数字及其单位

亚历克斯

# javascript - JS / Jquery 脚本帮助，它没有循环

> ID：10710939
> 
> 赞同：-1
> 
> 时间：2012-05-22T22:13:44.483
> 
> 标签：javascript, jquery, loops, if-statement

所以这里是脚本：

```
<script>
var div = $("#gridline1");
$(document.body).mousemove(function(e){ 
if(e.pageX<630){div.animate({right:'+=1'},1);}
else {div.animate({left:'+=2'},1);}
});
</script> 
```

它可以工作，但是当它在“else”之后停止执行“if”语句时。请帮忙。

[http://jsfiddle.net/nxaFG/](http://jsfiddle.net/nxaFG/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T23:40:21.583

我不确定您使用的是什么 HTML 或 CSS，效果也可能取决于这些。但是，我认为您可以替换`right:'+=1'`为`left:'-=1'`. 这是一个工作示例：http: [//jsfiddle.net/katylava/kagnr/](http://jsfiddle.net/katylava/kagnr/)

# javascript - model.set 之后的 Model.fetch：意外行为还是错误？

> ID：10710940
> 
> 赞同：1
> 
> 时间：2012-05-22T22:13:47.213
> 
> 标签：javascript, backbone.js

我有一个休息 API，它能够生成具有空值的对象键。
此空值未显示在 model.attributes 中。

这里有一个例子：

服务器可以产生`{id: 1, attr: "someValue"}`或`{id: 2, attr: null}`

现在，如果我运行以下代码，一切正常：

```
m = new MyModel({id: 1});
m.fetch();
m.get("attr"); // "bar";

m = new MyModel({id: 2});
m.fetch();
m.get("attr"); // undefined; 
```

* * *

如果我运行以下命令，我的视图中的渲染功能会出现问题。
要了解原因，请查看以下代码：

```
m = new MyModel({id: 1});
m.fetch({
    success: function () {
         m.get("attr"); // "bar";
    }
});

m = new MyModel({id: 2});
m.fetch({
    success: function () {
         m.get("attr"); // "bar"; // actually it should be undefined or null
    }
}); 
```

* * *

我的问题是：
1）为什么我会得到这种行为？
2）我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T23:11:29.750

好的...我知道发生了什么...在第一个示例中，您将 var m 设置为新的模型实例。在第二个示例中，您没有将 m 重置为新模型，只是设置 id 值 - 它仍然是第一个模型。这就是为什么您没有看到“null”的变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T23:17:31.487

当您写作`m.get("attr") = "bar";`时，您`m.get("attr") == "bar";`的意思是（注意双等号）？如果不是，那么该代码不会像您认为的那样做。

在任何情况下，问题很可能是当您检查该值时 fetch() 调用尚未完成。当我打字时，“mu太短”在评论中指出了这一点。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T23:25:57.587

我认为你有时间问题。Backbone[`fetch`](https://github.com/documentcloud/backbone/blob/master/backbone.js#L321)基本上是这样的：

1.  使用REST 路由设置`$.ajax`对服务器的调用。`m.id`
2.  AJAX 成功处理程序将返回的数据传递[`parse`](http://documentcloud.github.com/backbone/#Model-parse)给[`set`](http://documentcloud.github.com/backbone/#Model-set).

所以 a`fetch`几乎是延迟的`set`，并且[`set`](https://github.com/documentcloud/backbone/blob/master/backbone.js#L247)不会做任何会忽略`null`属性值的特殊操作。在您的情况下，`fetch`应该是`m.set({id: 2, attr: null})`有时间延迟的。

我想你会看到这个：

1.  调用`m.fetch()`并启动 AJAX 请求。
2.  你看着`m.get('attr')`却没有看到`null`你所期待的。
3.  AJAX 请求完成并更改`m.get('attr')`为`null`.

将`success`处理程序添加到您的 fetch 中：

```
m.fetch({ success: function(m) { ... }); 
```

并查看`m.get('attr')`其中有什么或绑定一个事件处理程序以等待`attr`更改：

```
m.on('change:attr', function(m, attr) { ... });
m.fetch(); 
```

看看会发生什么。

# jquery - jQuery 发布成功数据不在 DOM 中

> ID：10710942
> 
> 赞同：0
> 
> 时间：2012-05-22T22:14:03.220
> 
> 标签：jquery, dom, post, jquery-post

我的问题如下，jQuery Post 成功方法返回了一些数据，我要添加到 div 的数据，但看起来我要添加的数据不在 DOM 中。

jQuery 邮政编码：

```
$('#form').submit(function() {

  var text = $("#input").val();

  $.ajax({
     type: "POST",
     url: "file.php",
     data: "name=" + text,
     success: function(data) {
      $("#app").prepend("<span class='delete'>" + data + "</span>");
     }
  });

    return false;
}); 
```

这是删除跨度但不删除前置元素的代码。

```
$('.delete').on('click' , function() {

    $(this).hide();

}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T22:17:04.930

问题是绑定处理程序`span`时元素不存在`click`，因此没有触发事件处理程序。您需要使用事件委托来捕获尚不存在的元素上的事件：

```
$('#app').on('click', '.delete', function() {
    $(this).hide();
}); 
```

处理程序现在绑定到`#app`，它将始终存在。`#app`源自子元素的事件“冒泡”并在其父元素上触发，因此如果原始元素匹配，则绑定到后代元素的所有点击事件都会触发此处理程序`.delete`。

# google-chrome - 为什么第三方 cookie 的 Chrome 例外不起作用（导致无法使用 Disqus）？

> ID：10710944
> 
> 赞同：7
> 
> 时间：2012-05-22T22:14:12.593
> 
> 标签：google-chrome, cookies, disqus

所以 Disqus 已经有一段时间没有为我工作了，他们最后很方便地添加了一个小通知，说明这是由于第三方 cookie 被阻止了。太好了，我说，让我们照顾好它。

因此，我在 Chrome 的首选项中添加了 disqus.com 的例外，但它似乎不起作用。我通过首选项 -> 高级 -> 内容设置 -> 管理例外来执行此操作，我在其中为`disqus.com`. 我有第三方 cookie，否则会被阻止。

但是，Disqus 仍然无法工作，在每个站点上都给我同样的错误，它无法使用第三方 cookie。即使我去 disqus.com 并登录，然后重新访问一个站点，错误仍然存​​在。

为什么 disqus 会在这里失败？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-03T10:07:59.930

原因是您必须告诉 Chrome 也允许对 disqus.com的**子域使用 3rd 方 cookie。**所以只需将例外设置为此：`[*.]disqus.com`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-28T13:57:08.273

Disqus 要求您接受第三方 cookie。如果你想使用它，你必须打开它们，并与那些将它们用于邪恶目的的坏人一起冒险。

# javascript - Javascript [Prototype/Scriptaculous] - 创建无限单向幻灯片

> ID：10710945
> 
> 赞同：0
> 
> 时间：2012-05-22T22:14:28.163
> 
> 标签：javascript, slideshow, infinite

假设您有这样的幻灯片（我在这里省略了“上一个”和“下一个”按钮）：

```
<div id="slides">
   <article id="slide1" class="slide">[...]</article>
   <article id="slide2" class="slide">[...]</article>
   <article id="slide3" class="slide">[...]</article>
</div> 
```

这里有 3 张幻灯片，但那是完全动态的。我的大问题不是创建无限幻灯片，而是创建一个**始终以相同方式**从一张幻灯片过渡到另一张幻灯片的幻灯片。

如果我们考虑这个循环：

```
slide 1 -> slide 2 -> slide 3 -> slide 1 -> slide 2 -> slide 3 -> slide 1 -> ... 
```

我想要的是我们总是向左滑动的印象（**即使我们从幻灯片 3 回到幻灯片 1！！**）。

如果您有任何想法，请告诉我，我已经尝试了很多东西。

提前致谢， 罗尔夫

PS：我正在使用 Prototype v1.6 和 Scriptaculous v1.9.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:20:34.213

假设你知道如何使用幻灯片，你想利用模数函数来给你无限循环。

因此，如果您有一个变量 id ，该变量 id 应该是 1->2->3 然后返回，您需要更新它，使其从 3 回到 1，如下所示：

```
id=(id+2)%4-1 
```

这会给你 1->2->3->1->2->3... 效果

这个小公式可能看起来有点混乱，因为你是从 1 到 3 而不是从 0 到 2。如果你从 0 开始，简化的公式将是：

```
id=(id+1)%3 
```

您只需要将末尾的 3 调整为幻灯片的幻灯片数量，或者在上面的示例中，幻灯片数量 + 1。

# maven - Neo4j 1.8 M02：Maven 编译错误，“找不到符号”

> ID：10710948
> 
> 赞同：2
> 
> 时间：2012-05-22T22:15:16.697
> 
> 标签：maven, maven-3, neo4j

我刚刚从 2012 年 5 月 22 日下载了 neo4j-1.8-M02 源文件，发现 pom.xml 与 2 周前不同。现在，我收到以下错误。

任何建议将不胜感激。捷通

```
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler- plugin:2.3.2:compile (compile-neo4j-kernel) on project neo4j-kernel: Compilation failure: Compilation failure:
[ERROR] /home/pt/Downloads/neo4j-community-081282a/kernel/src/main/java/org/neo4j/helpers/Specifications.java:[54,15] cannot find symbol
[ERROR] symbol  : method and(java.lang.Iterable<java.lang.Object>)
[ERROR] location: class org.neo4j.helpers.Specifications
[ERROR] /home/pt/Downloads/neo4j-community-081282a/kernel/src/main/java/org/neo4j/helpers/Specifications.java:[64,15] cannot find symbol 
```

* * *

pom.xml

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <executions>
      <execution>
        <id>default-compile</id>
        <configuration>
          <compilerArgument>-proc:none</compilerArgument>
          <includes>
            <include>org/neo4j/kernel/impl/annotations/**</include>
          </includes>
        </configuration>
      </execution>
      <execution>
        <id>compile-neo4j-kernel</id>
        <phase>compile</phase>
        <goals>
          <goal>compile</goal>
        </goals>
      </execution>
    </executions>
  </plugin> 
```

……

```
import org.neo4j.helpers.Service;

              <group>
                <title>Helpers</title>
                <packages>org.neo4j.helpers:org.neo4j.helpers.*</packages>
              </group 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T08:32:17.200

你在用 OpenJDK 构建吗？我们有一个 OpenJDK 错误的问题，所以请尝试使用 OracleJDK 进行编译。这样效果更好吗？

# powershell - PowerShell：从字符串中提取时间戳

> ID：10710950
> 
> 赞同：5
> 
> 时间：2012-05-22T22:15:25.947
> 
> 标签：powershell

我是 PowerShell 的新手，并且已经弄清楚如何从日志文件中提取相关行：

```
C:\Documents and Settings\admin\Local Settings\Application Data\Microsoft\SyncToy\2.0\SyncToyLog.log:325:SYNC: 05/22/2012 14:54:55:857: SyncToy run of Profile Backup (C:\Documents and Settings\admin\, H:\Sync\) completed at 5:22/2012 2:54:55 PM. 
```

我想做的是将第一个时间戳无毫秒（使用 24 小时时间的时间戳）提取到变量中。结果：

```
05/22/2012 14:54:55 
```

任何援助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T23:02:43.177

一种方法是使用正则表达式解析日期/时间字符串，然后将其转换为日期/时间对象：

```
$line = 'C:\Documents and Settings\admin\Local Settings\Application Data\Microsoft\SyncToy\2.0\SyncToyLog.log:325:SYNC: 05/22/2012 14:54:55:857: SyncToy run of Profile Backup (C:\Documents and Settings\admin\, H:\Sync\) completed at 5:22/2012 2:54:55 PM.'

$dateTimeString = [regex]::Matches($line, '(\d\d/\d\d/\d\d\d\d.+): ')[0].Groups[1].Value 
```

然后将其转换为日期时间对象：

```
$provider = New-Object System.Globalization.CultureInfo "en-US"

$dateTime = [datetime]::ParseExact($dateTimeString, 'MM/dd/yyyy HH:mm:ss:fff', $provider) 
```

现在您可以根据需要显示它或将其存储在变量中：

```
$dateTime -f 'MM/dd/yyyy HH:mm:ss' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T05:15:44.963

或者简单地说：

```
($line -split ':\s+|:\d{3,}')[2] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-12T13:11:59.810

有了上述参考资料，我可以在我的情况下做以下事情

# 我有如下数据行的日志文件

DefaultSource;详细;8;9/5/2016 下午 1:05:19;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
DefaultSource;Verbose;8;9/5/2016 1:05:20 PM;yyyyyyyyyyyyyyyyyyyyyyyyyyyyyy 默认来源
;详细;8;9/5/2016 1 :05:20 PM;zzzzzzzzzzzzzzzzzzzzzzzzzzzzzz

PS C:\> $lines = Get-Content "~\Documents\FileName.log"

# 下面的行提取模式 'd/m/yyyy h:mm:ss [A/P]M' 并显示所有匹配的捕获

PS C:\> $ 行 | %{[正则表达式]::Matches($_,'(\d+/\d+/\d\d\d\d)\s(\d+:\d+:\d+)\s([AP]M)' )} | 选择捕获

# 获取日期时间格式的第一个值

PS C:\> [日期时间]$dd = ($lines | %{[regex]::Matches($_,'(\d+/\d+/\d\d\d\d)\s(\d+: \d+:\d+)\s([AP]M)')} | 选择 -First 1 Value).Value

PS C:\> $dd.GetType().FullName
System.DateTime

PS C:\> $dd
2016 年 9 月 5 日星期一 12:53:20 PM

# c++ - 浮点数的编辑框

> ID：10710951
> 
> 赞同：0
> 
> 时间：2012-05-22T22:15:26.040
> 
> 标签：c++, visual-studio-2010, resources

我正在尝试使用 Visual Studio 2010 的资源编辑器创建一个仅接受浮点数的编辑框。我知道编辑框有一个 Number 属性，当设置为 true 时，将只允许输入数字。这适用于整数，但它不允许我输入浮点数，例如 0.1。

Visual Studio 的资源编辑器中是否有任何内置机制？解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T22:22:44.917

为 EN_UPDATE 消息放入一个处理程序。在处理程序中，使用 GetWindowText 从控件中读取文本；如果它包含对浮点数无效的内容，则去掉有问题的字符并使用 SetWindowText 放回更新的字符串。

# scala - 如何删除 Scala 集合中的尾随元素？

> ID：10710954
> 
> 赞同：9
> 
> 时间：2012-05-22T22:15:52.543
> 
> 标签：scala

假设我有一个看起来像这样的列表：

```
List(0,5,34,0,9,0,0,0) 
```

我想结束的是：

```
List(0,5,34,0,9) 
```

我正在删除所有尾随零。有没有一种方法，例如：

```
list.trimRight(_ == 0) 
```

那会实现吗？我可以从头开始编写它，但在我看来它是标准集合附带的东西？

我想出了：

```
list.take(list.lastIndexWhere(_ != 0) + 1) 
```

有更好的方法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-23T00:11:03.097

如果你想知道哪个最*优雅*，那我会说

```
list.reverse.dropWhile(_ == 0).reverse 
```

因为它只需要引用一次输入，并且意图非常明确。

如果你想知道哪个是最*有效*的，你需要做一些基准测试。结果（对于您的简短测试列表）可能会让您大吃一惊！

```
// Slowest
191 ns     dhg's EnhancedSeq
173 ns     user unknown's custom dropRight
 91 ns     andyczerwonka's take/lastIndexWhere
 85 ns     Rex's :\ (foldRight) -- see below
 60 ns     dhg / Daniel's reverse/dropWhile/reverse
 52 ns     Rex's customDropTrailingZeros -- see below
// Fastest 
```

可能存在一些适度的机器与机器之间的差异，但基本上这是一个花哨的短列表对您没有帮助的情况。如果列表很长，情况可能会发生很大变化。

这是折叠版本（但在大列表中堆栈溢出）：

```
(list :\ list.take(0)){ (x,ys) => if (x==0 && ys.isEmpty) ys else x :: ys } 
```

这是自定义版本（完全非通用 - 仅适用于此特定任务！）：

```
@annotation.tailrec def customDropZeros(
  xs: List[Int],
  buffer: Array[Int] = new Array[Int](16),
  n: Int = 0
): List[Int] = {
  if (xs.isEmpty) {
    var ys = xs
    var m = n
    while (m>0 && buffer(m-1)==0) m -= 1
    var i = m-1
    while (i>=0) {
      ys = buffer(i) :: ys
      i -= 1
    }
    ys
  }
  else {
    val b2 = (
      if (n<buffer.length) buffer
      else java.util.Arrays.copyOf(buffer, buffer.length*2)
    )
    b2(n) = xs.head
    customDropZeros(xs.tail, b2, n+1)
  }
} 
```

### tl;博士

`reverse dropWhile reverse`除非你有充分的理由否则使用。它出奇的快，出奇的清晰。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-22T22:31:27.000

我想我的答案`list.take(list.lastIndexWhere(_ != 0)+1)`是这样做的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-22T22:17:04.820

```
scala> val xs = List(0,5,34,0,9,0,0,0)
xs: List[Int] = List(0, 5, 34, 0, 9, 0, 0, 0)

scala> xs.reverse.dropWhile(_ == 0).reverse
res1: List[Int] = List(0, 5, 34, 0, 9) 
```

**编辑：**

这是一种一次性 (O(n)) 方法，它添加了一个隐式`dropWhileRight`方法`Seq`

```
class EnhancedSeq[A, Repr <: Seq[A]](seq: SeqLike[A, Repr]) {
  def dropRightWhile[That](p: A => Boolean)(implicit bf: CanBuildFrom[Repr, A, That]): That = {
    val b = bf(seq.asInstanceOf[Repr])

    val buffer = collection.mutable.Buffer[A]()
    for (x <- seq) {
      buffer += x
      if (!p(x)) {
        b ++= buffer
        buffer.clear()
      }
    }

    b.result
  }
}
implicit def enhanceSeq[A, Repr <: Seq[A]](seq: SeqLike[A, Repr]) = new EnhancedSeq(seq) 
```

你就像这样使用它：

```
scala> List(0,5,34,0,9,0,0,0).dropRightWhile(_ == 0)
res2: List[Int] = List(0, 5, 34, 0, 9) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-22T22:32:53.677

Scala 中没有这样的方法，并且`List`在更改它的“结束”时效率非常低。更喜欢`Vector`.

这适用于`List`（我的其他建议充满了错误，我将其删除）：

```
list.reverse.dropWhile(_ == 0).reverse 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-22T23:12:32.330

您可以遍历列表，并缓冲 0，直到找到一些非 0。如果找到非 0，则将缓冲区附加到到目前为止的结果中，然后继续。但是如果你的 List 以 0 结尾，你就把最后一个缓冲区扔掉。

但是 - 最后，`reverse`仍然需要 a 。

```
val xs = List(0,5,34,0,9,0,0,0)

import annotation._
@tailrec    
def dropRight [T] (l: List[T], p: (T=>Boolean), carry: List[T]=List.empty, buf: List[T]=List.empty): List[T] = {
  if (l.isEmpty) carry.reverse else 
  if (p (l.head)) dropRight (l.tail, p, l.head :: buf ::: carry, List.empty) else 
  dropRight (l.tail, p, carry, l.head :: buf) }

dropRight (xs, (x: Int) => x != 0) 
res122: List[Int] = List(0, 5, 34, 0, 9) 
```

如果您对最后的顺序不感兴趣，并且可以省略“反向”调用，那可能会很有趣，但为什么您只删除最后一个 Ts 呢？

基准： ![基准图](../Images/cc3be4319cd8c61da3ba35487a6c0bee.png)

*   [基准的来源](https://gist.github.com/2773229)
*   [基准所需的父级](https://gist.github.com/1152783)

我进一步增加了尺寸，但图案重复了。

### 更新：包含 dhg 的算法，性能非常好。

# validation - 如何为 C sharp 控制台应用程序中的数字范围编写验证代码？

> ID：10710956
> 
> 赞同：0
> 
> 时间：2012-05-22T22:15:56.727
> 
> 标签：validation, console

我是一个崭露头角的 C 语言程序员，我正在尝试为控制台应用程序编写一些验证代码。我已经为用户编写了一些代码以输入 1 - 4 之间的数字。我想要做的是如何编写一些代码来提示用户仅输入 1 - 4 之间的数字，如果他们输入了超出此范围的任何数字?

问候，

安东尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:21:08.440

鉴于您没有提供任何代码...

```
var number = 0
while(number < 1 || number > 4) 
{
   // send a message, Please enter a number between 1 and 4
   number = // get your number
} 
```

# javascript - JQuery：遍历表行以获取 2 个特定单元格

> ID：10710957
> 
> 赞同：0
> 
> 时间：2012-05-22T22:16:07.930
> 
> 标签：javascript, jquery

我是一个完全的 JQuery 新手，过去 2 天我一直在研究这个，但我的大脑现在被炒了。

这是我所拥有的：

具有一定数量行的表（如在线商店的购物车）

我不想要最后一行（因为它包含购物车总数）并且我不想要第一行（这是列标题）

这是我想要的：

在文档加载时，我想遍历该表的每一行（第一行和最后一行除外）并抓取（例如）第一列和最后一列，将这些值传递给 Web 服务，并让 Web 服务返回一个值放入该行的另一列的文本框

表结构如下：

```
<table id="blahzayblahgrdItems">
<tbody>
<tr>
<td>product</td>
<td>req.ship date</td>
<td>est.ship date(input textbox)</td>
<td>price</td>
<td>qty</td>
<td>subtotal</td>
</td>
</tbody>
</table> 
```

我正在尝试从 Product 列和 QTY 列中获取值以传递给 webservice 并填充 EST。包含从 Web 服务返回的内容的发货日期列

在代码中，我尝试过类似的东西

```
$(function()
{
var partID;
var qty;

$("table[id*=grdItems] tbody tr").each(function() {})
) 
```

但是，我在将实际数量和产品传递给我的网络服务方面是空白的。我尝试了不同的代码变体并抛出警告框以查看返回的内容，但我看到的是标题、表格数据片段、完整表格数据等。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T22:23:20.640

为要解析的每一行设置一个类并执行以下操作：

```
var partID = $("tr.some_class td")[4].text();
var qty = $("tr.some_class td")[5].text(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T22:31:14.217

`info`我认为在第一行和最后一行（尤其是样式）上放置一个类（如）会更容易一些，然后执行以下操作。

使用 jsfiddle 的 json echo 使用工作示例更新了 jsfiddle：

[http://jsfiddle.net/lucuma/fNwvX/3/](http://jsfiddle.net/lucuma/fNwvX/3/)

```
// add a class to first and last tr to make formatting a little nicer as well
$('#blahzayblahgrdItems tr:first,#blahzayblahgrdItems tr:last').addClass('info');
// loop over each one except the ones with class
$('#blahzayblahgrdItems tr:not(.info)').each(function() {
    var $prod = $('td:eq(0)', this);
    var $sub = $('td:eq(5)', this);

    var result = $prod.text() + '-' + $sub.text();     // do your ajax with these values
    $.get('ajax/test.html', function(data) {
      $prod.text(data.val1);  // depends on your system
      $sub.text(data.val2);   // depends on your system
    });

});​ 
```

# ember.js - 在 Ember.js 中，启用 ENV.VIEW_PRESERVES_CONTEXT 时视图的上下文是什么？

> ID：10710963
> 
> 赞同：2
> 
> 时间：2012-05-22T22:16:33.230
> 
> 标签：ember.js

我在模板中有一种情况，我想在每个块内对父上下文中的值使用 if 块。

来自 Ember.js 视图层指南 ( [http://emberjs.com/guides/view_layer/](http://emberjs.com/guides/view_layer/) )：

> Ember 中的车把助手也可以指定变量。例如，{{#with controller.person as tom}} 表单指定后代范围可以访问的 tom 变量。即使子上下文具有 tom 属性，tom 变量也会取代它。
> 
> 这种形式有一个主要好处：它允许您缩短长路径而不会失去对父范围的访问。
> 
> 这在 {{#each}} 助手中尤为重要，它提供了一个 {{#each person in people}} 表单。在这种形式中，后代上下文可以访问 person 变量，但仍与模板调用 each 的范围相同。

我还启用了标志`ENV.CP_DEFAULT_CACHEABLE`和`ENV.VIEW_PRESERVES_CONTEXT`.

编码：

```
App = Ember.Application.create({});

App.view = Ember.View.extend({
    foo: [1, 2, 3],
    bar: true
}); 
```

模板：

```
<script type="text/x-handlebars" >
    {{#view App.view}}
        {{log foo}} {{! this will log "undefined"}}
        {{#each array in foo}}
            {{#each number in array}}
                {{#if bar}}
                    {{number}}
                {{/if}}
            {{/each}}
        {{/each}}
    {{/view}}
</script> 
```

这不起作用。我不确定为什么。记录`foo`将打印“未定义”。为什么是`foo`未定义的？根视图的上下文是什么？

演示：http: [//jsfiddle.net/hekevintran/sMeyC/10/](http://jsfiddle.net/hekevintran/sMeyC/10/)

我很确定这与此有关，因为当我禁用它时，我可以通过引用as`ENV.VIEW_PRESERVES_CONTEXT`来使其工作。`bar``parentView.bar`

`ENV.VIEW_PRESERVES_CONTEXT`禁用的工作演示：http: [//jsfiddle.net/hekevintran/sMeyC/11/](http://jsfiddle.net/hekevintran/sMeyC/11/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T23:15:08.973

现在在 Ember 中，当您有一个带有匿名模板的视图时，任何`{{property}}`调用都会转到父视图。换句话说，`{{#view}}`将不再改变视图的上下文。它的上下文将是父母的上下文。

请参阅此处的 tldr 示例：[https ://gist.github.com/2494968](https://gist.github.com/2494968)

因此，为了让您的代码正常工作，我们将不得不使用`view.foo`and访问 foo 和 bar，`view.bar`因为我们想在`{{#view App.view}}`.

这是您的代码的更新小提琴：http: [//jsfiddle.net/cRgag/](http://jsfiddle.net/cRgag/)

```
<script type="text/x-handlebars" >
    {{#view App.view}}
        {{log view.foo}} {{! this will log "undefined"}}
        {{#each view.foo}}
            {{#each this}}
                {{#if view.bar}}
                    {{this}}
                {{/if}}
            {{/each}}           
        {{/each}}
    {{/view}}
</script>​ 
```

PS：貌似`{{log view.foo}}`不行。您可能应该在 github 上提交错误报告。

# php - PHP从类返回mysql数组

> ID：10710964
> 
> 赞同：0
> 
> 时间：2012-05-22T22:16:36.243
> 
> 标签：php, mysql, database, while-loop, boolean

也许是一个愚蠢的问题，但它正在杀死我......

当我从一个类的函数中的数据库获取结果时，我在该函数中返回该结果。当我将该类包含到我的主页中并获取我正在调用的函数的返回值时，它不再是来自数据库的结果，而是一个布尔值。

我收到此错误消息：

```
Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in C:\xampp\htdocs\wezzel\Framework\php\database.php on line 24 
```

这是来自 database.php 的函数：

```
function getQuery($sql)
{
    $con = mysql_connect("localhost","root","");
    if (!$con)
    {
        die('Could not connect: ' . mysql_error());
    }
    $con = connectDatabase();
    mysql_select_db("joetsy", $con);
    $result = mysql_query($sql);
    disconnectDatabase($con);
    return mysql_fetch_array($result);
    mysql_close($con);
} 
```

这是我在主页 index.php 中尝试做的事情：

```
include_once('php\database.php');
$result = getQuery("SELECT * FROM binks.bink");
while($row = $result)
{
    echo("
          <li class='store'>
                <a href='bink.php?id=" . $row['binkid'] . "'>Bink</a>
          </li>
       ");
} 
```

# jms - 如果虚拟主题的消费者宕机了怎么办？

> ID：10710967
> 
> 赞同：1
> 
> 时间：2012-05-22T22:16:40.003
> 
> 标签：jms, activemq

我有一个 ActiveMQ JMS 到 JMS 桥，其中来自远程代理的消息被转发到本地 ActiveMQ 集群上的虚拟主题。虚拟主题的消费者通过故障转移协议与 ActiveMQ 集群通信。如果整个集群发生灾难性的崩溃会发生什么？当集群再次在线时，停机期间产生的消息是否会出现在虚拟主题上，例如持久订阅？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T17:04:57.977

看起来如果整个 ActiveMQ 集群宕机，那么在宕机期间产生的消息将会丢失，除非消费者被配置为持久的。换句话说，虚拟主题本身并没有持久性。

# cordova - Phonegap 联系人 API - 字段名称

> ID：10710972
> 
> 赞同：0
> 
> 时间：2012-05-22T22:17:15.367
> 
> 标签：cordova, contacts, field

为什么这这么难？我想要的只是 Phonegap 联系人 API 中的字段名称列表。您会认为这没什么大不了的，但实际上，这几乎是 Phonegap 文档的一个普遍问题：没有方法采用的参数的详细信息。这些示例并不详尽，这使用户不得不去别处寻找。

所以我去了[http://www.w3.org/TR/2010/WD-contacts-api-20100121/#widl-ContactProperties-name](http://www.w3.org/TR/2010/WD-contacts-api-20100121/#widl-ContactProperties-name)并看到标准字段是姓名、昵称、电话、电子邮件和地址。嗯！让我们看看这是否有效：

 ``var fieldArray = new Array('name','displayName','phoneNumbers','addresses','emails');

for (i=0;i

for(j = 0; j < fieldArray.length; j++){

```
alert("Field Name: "+fieldArray[j]+"\n Data: "+contacts[i].name[0]+"\n Data: "+contacts[i].displayName);

alert("\n Name:  "+contacts[i].name[0]); 
```

}` 

`}`

不是机会。特别是，第二个警报 - contacts[i].name[0] - 是我最感兴趣的一个。它只是返回“未定义”。试过这个：contacts[i].name[0].value。纳达。

所以问题：联系人列表中的字段名称是什么，Phonegap 中有联系人的人可以要求他们对他们文档的糟糕状态做些什么。我会自愿参加，但我没有必要的 Phonegap 知识来完成这项工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T06:18:30.387

该应用程序是这样的：出于性能原因，我想将我的所有联系方式都放在 SQLite 数据库中，并允许我更轻松地操作数据。因此，我提取了所有联系人：

 `````
var options = new ContactFindOptions();

options.filter=""; // Note empty filter will pick up all contacts

options.multiple = true;

var fields = ["*"]; // Picks up all fields

navigator.contacts.find(fields, findSuccess, onError, options); 
```` 

`然后，我将其全部保存在具有选定字段名称的数据库中：displayNmae、phoneNumbers、addresses、emails。我真正想做的事情是遍历所有字段并将大量内容保存在数据库中，并使用这样的例程findSuccess 回调函数：`

 ``````
var contactsArray=new Array();
var contactFieldsArray = new Array('displayName','firstName','lastName' ...);
for(var i = 0; i < contacts.length;i++){
   for(var j = 0; j < contactFieldsArray.length; j++){
      if(contactFieldsArray[j].match(/(phoneNumbers)|(emails)/i){
         contactsArray,push(contacts[i].contactFieldsArray[j][0].value);
      }else{
          contactsArray.push(contacts[i].contactFieldsArray[j]);      
      }
   }
} 
```` 

`不幸的是，这需要一些可用字段的 id。它必须比出现时更容易。`

 `* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T01:09:39.717

首先，您正在查看 W3C 联系人规范的旧版本。你会想看看这个：

[http://www.w3.org/TR/contacts-api/](http://www.w3.org/TR/contacts-api/)

至于您关于联系人中哪些字段名称的问题，它们列在[联系人对象下的文档中](http://docs.phonegap.com/en/1.7.0/cordova_contacts_contacts.md.html#Contact)。如果您想创建联系人，请不要使用“new Contact()”，而是使用[navigator.contacts.create()](http://docs.phonegap.com/en/1.7.0/cordova_contacts_contacts.md.html#contacts.create)。基本上，您将对象文字传递给该方法，它会从您的对象中提取匹配的属性并填充联系人。

我不确定您如何在示例中使用联系人数组，但如果您使用[navigator.contacts.find()](http://docs.phonegap.com/en/1.7.0/cordova_contacts_contacts.md.html#contacts.find)您需要指定find 应返回哪些[联系人字段。](http://docs.phonegap.com/en/1.7.0/cordova_contacts_contacts.md.html#contactFields)这是根据 W3C 规范，我不完全同意，但我们尝试按照规范编写代码。

希望能回答您的问题，如果它不只是 ping 我，我会尽力回答。`````

# php - PHP通过gmail smtp使用PEAR发送电子邮件

> ID：10710973
> 
> 赞同：2
> 
> 时间：2012-05-22T22:17:16.817
> 
> 标签：php, email, smtp, pear

经过一场战斗，获得梨的正确位置后，我的代码不会产生任何错误。但是它不会发送电子邮件。电子邮件正文是从一个表单生成的，该表单首先将数据输入 mysql 数据库，然后将相同的数据通过电子邮件发送给一个人，然后该人将这些数据用于任何用途。我已经在这个论坛和其他（这是最好的）上阅读了大量的问题和答案，并且我编写的大部分代码都受到了这个论坛的启发。gmail账号有效，密码正确。任何帮助或建议将不胜感激。

pear 和 pear mail 安装在服务器上并且似乎正在工作（至少没有产生任何错误）这是我的代码：

```
 //Email process code

   ini_set('display_errors','on');
   error_reporting(E_ALL);
   /*
   require_once 'System.php';
  if(class_exists('System')===true) {
  echo 'PEAR is installed!';
  } else {
  echo 'PEAR is not installed :(';
   }
  */

  set_include_path('/home/surfcup/php/');
  require_once "Mail.php";

  $from = "<me@gmail.com>";
  $ToEmail = "<new@apdapalabs.com>"; 

  $EmailSubject = 'Hotel Registration Form'; 

  $host ="ssl://smtp.gmail.com";
  $port ="465";
  $username = "myAccount@gmail.com";
  $password =   "password";

  $headers = array ('From' => $from, 'To'=> $ToEmail, 'Subject'=> $EmailSubject);

  $smtp = Mail::factory('smtp',
    array ('host'=> $host,
           'port'=> $port,
           'auth'=> true,
           'username'=> $username,
           'password'=> $password));

  $MESSAGE_BODY = "Event: ".$Event."\n"; 
  $MESSAGE_BODY .= "Name: ".$realname."\n"; 
  $MESSAGE_BODY .= "Age Group: ".$Age."\n"; 
  $MESSAGE_BODY .= "Sex: ".$Sex."\n"; 
  $MESSAGE_BODY .= "Contact Name: ".$Contact_Name."\n"; 
  $MESSAGE_BODY .= "Contact Email: ".$Contact_Email."\n"; 
  $MESSAGE_BODY .= "Phone: ".$Phone."\n"; 
  $MESSAGE_BODY .= "Hotel Name: ".$Hotel_Name."\n"; 
  $MESSAGE_BODY .= "No Rooms: ".$No_Rooms."\n"; 
  $MESSAGE_BODY .= "Rate: ".$Rate."\n"; 
  $MESSAGE_BODY .= "Check In Date: ".$Check_In."\n"; 
  $MESSAGE_BODY .= "Check Out Date: ".$Check_Out."\n"; 
  $MESSAGE_BODY .= "Additional Info: ".$Add_Info."\n"; 

  $mail = $smtp->send($ToEmail, $headers, $MESSAGE_BODY);

        if (PEAR::isError($mail)){
            echo("<p>" . $mail->getMessage . "</p>");
            echo("\n");
            echo("<p>" . $mail->getDebugInfo . "</p>");

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T00:38:36.093

我看到的关于通过 GMAIL 发送的大多数错误是您自己的服务器上未启用 OpenSSL。检查您的 php.ini 中是否启用了扩展

（另外，如果失败，您能否错误检查“smtp”。）

# clojure - Clojure：多方法与协议

> ID：10710975
> 
> 赞同：8
> 
> 时间：2012-05-22T22:17:45.353
> 
> 标签：clojure

## 语境

最近我一直在写很多涉及多方法和协议的代码。

我发现我的大多数多方法都是单次调度——它们只取决于其中一个参数的类型。

在这些情况下，实际上可以通过向协议添加额外字段来替换多方法。

## 问题

在可以用协议替换多方法的情况下，是否有*任何*理由使用多方法而不是协议？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T23:40:52.460

如果您的需求很有可能会发生变化，并且您将来需要利用多重调度，那么您可能会选择使用多重方法。

否则，当协议足以满足您的目的时，您应该支持它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T06:38:45.243

我通常**更喜欢协议**：它们提供更好的性能并很好地处理常见情况（类型上的单一调度）。

有时您确实需要更复杂的调度，在这种情况下，您可以：

*   全力以赴并使用多种方法
*   编写一小段自定义代码（通常是 a `(cond .....)`）来处理调度。有时这比多方法更好，因为例如多方法不能很好地处理值的范围。

一个有用的额外建议是以委托给适当协议函数的方式编写您的主要（公开公开的）函数。

例如，它可能是这样的：

```
(defn my-api-function [a b]
  "Do interesting things with a and b"
  (multimethod-function
    (protocol-function a)
    (protocol-function b))) 
```

这为您以后更改内部实现提供了很大的灵活性，而无需大量重构或影响调用代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T07:07:04.457

就个人而言，我更喜欢多方法，因为它们比协议更有效地将表示与行为分离。除了性能之外，我认为没有理由牺牲使用普通映射来表示我的数据、根据需要添加多个调度或根据“物理”类型以外的属性进行调度（这本身通常不是一个很好的概念）在我看来，依靠）。

# android - Android - Activity 泄露了 IntentReceiver

> ID：10710984
> 
> 赞同：6
> 
> 时间：2012-05-22T22:19:02.670
> 
> 标签：android, broadcastreceiver, power-management

我正在编写非常简单的应用程序。它工作正常，但是当我按下后退键时它崩溃了（Activity 泄露了最初在此处注册的 IntentReceiver）。这个应用程序应该在后台运行。如何正确地做到这一点？

```
import android.app.Activity;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.content.SharedPreferences;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.os.PowerManager;
import android.os.PowerManager.WakeLock;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ProgressBar;
import android.widget.RadioButton;
import android.widget.SeekBar;
import android.widget.SeekBar.OnSeekBarChangeListener;
import android.widget.TextView;
import android.widget.Toast;

public class Bateria extends Activity implements OnClickListener, OnSeekBarChangeListener {

    ProgressBar pbBatteryLevel;
    TextView tvBatteryLevel;
    TextView tvLeft;
    RadioButton rbPercent;
    RadioButton rbTime;
    SeekBar sbSetLeft;
    boolean percent; // true - percent, false - time
    boolean informed;
    int progress;
    int MAX_TIME;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {

        PowerManager pM = (PowerManager) getSystemService(Context.POWER_SERVICE);
        WakeLock wL = pM.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, "whatever");
        long HOURS24 = 86400000;

        super.onCreate(savedInstanceState);

        wL.acquire(HOURS24);

        setContentView(R.layout.main);

        initialize();
    }

    @Override
    protected void onResume() {
        // TODO Auto-generated method stub
        super.onResume();
        registerReceiver(batteryInfoReceiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
    }

    private void initialize() {
        // TODO Auto-generated method stub
        SharedPreferences preferences = getSharedPreferences("SP_BATTERY", 0);
        percent = preferences.getBoolean("percent", true);
        progress = preferences.getInt("progress", 0);
        informed = false;

        MAX_TIME = 72*60;

        pbBatteryLevel = (ProgressBar) findViewById(R.id.pbBatteryLevel);
        tvBatteryLevel = (TextView) findViewById(R.id.tvBatteryLevel);
        tvBatteryLevel.setTextSize(20);
        tvLeft = (TextView) findViewById(R.id.tvLeft);
        if(percent)
            tvLeft.setText(String.valueOf(progress) + " %");
        else{
            int minutes = MAX_TIME*progress/100;
            int hours = minutes / 60;
            minutes -= hours*60;
            tvLeft.setText(String.valueOf(hours) + "h " + String.valueOf(minutes) + "min");
        }
        rbPercent = (RadioButton) findViewById(R.id.rbPercent);
        rbPercent.setOnClickListener(this);
        rbPercent.setChecked(percent);
        rbTime = (RadioButton) findViewById(R.id.rbTime);
        rbTime.setOnClickListener(this);
        rbTime.setChecked(!percent);

        sbSetLeft = (SeekBar) findViewById(R.id.sbSetPercent);
        sbSetLeft.setOnSeekBarChangeListener(this);
        sbSetLeft.setProgress(progress);

        registerReceiver(batteryInfoReceiver, new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
    }

    private BroadcastReceiver batteryInfoReceiver = new BroadcastReceiver() {

        @Override
        public void onReceive(Context c, Intent i) {
            int level = i.getIntExtra("level", 0);
            int voltage = i.getIntExtra("voltage", 0);
            int temperature = i.getIntExtra("temperature", 0);
            pbBatteryLevel.setProgress(level);
            tvBatteryLevel.setText("Battery Level: " + Integer.toString(level)
                    + "%" + "\n" + voltage + " mV " + temperature + " C");
            if(level < progress && !informed){
                //////////
                Toast.makeText(getApplicationContext(), "BATTERY", Toast.LENGTH_LONG).show();
                MediaPlayer mp = MediaPlayer.create(Bateria.this, R.raw.explosion);
                mp.start();
                //////////
                informed = true;
            }
            else if(level >= progress){
                informed = false;
            }
        }
    };

    public void onClick(View v) {
        // TODO Auto-generated method stub
        switch(v.getId()){
        case(R.id.rbPercent):
            percent = true;
            tvLeft.setText(String.valueOf(progress) + " %");
            break;
        case(R.id.rbTime):
            percent = false;
            int minutes = MAX_TIME*progress/100;
            int hours = minutes / 60;
            minutes -= hours*60;
            tvLeft.setText(String.valueOf(hours) + "h " + String.valueOf(minutes) + "min");
            break;
        }

        SharedPreferences preferences = getSharedPreferences("SP_BATTERY", 0);
        SharedPreferences.Editor editor = preferences.edit();
        editor.putBoolean("percent", percent);
        editor.commit();
    }

    public void onProgressChanged(SeekBar seekBar, int progress,
            boolean fromUser) {
        // TODO Auto-generated method stub
        if(percent)
            tvLeft.setText(String.valueOf(progress) + " %");
        else{
            int minutes = MAX_TIME*progress/100;
            int hours = minutes / 60;
            minutes -= hours*60;
            tvLeft.setText(String.valueOf(hours) + "h " + String.valueOf(minutes) + "min");
        }

        this.progress = progress;
        SharedPreferences preferences = getSharedPreferences("SP_BATTERY", 0);
        SharedPreferences.Editor editor = preferences.edit();
        editor.putInt("progress", progress);
        editor.commit();
        informed = false;
    }

    public void onStartTrackingTouch(SeekBar seekBar) {
        // TODO Auto-generated method stub

    }

    public void onStopTrackingTouch(SeekBar seekBar) {
        // TODO Auto-generated method stub

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // TODO Auto-generated method stub
        super.onCreateOptionsMenu(menu);
        MenuInflater blowUp = getMenuInflater();
        blowUp.inflate(R.menu.menu, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        // TODO Auto-generated method stub
        System.exit(0);
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T22:34:49.603

首先，您需要根据需要取消注册已注册的 BroadcastReceiver。有关更多信息，请参见此处：http: [//developer.android.com/reference/android/content/BroadcastReceiver.html](http://developer.android.com/reference/android/content/BroadcastReceiver.html)

更重要的是，你不能仅仅通过开发一个 Activity 来开发一个在后台运行的应用程序。您需要为此开发服务。检查此链接以获取有关如何执行此操作的说明以及 API 文档：http: [//developer.android.com/reference/android/app/Service.html](http://developer.android.com/reference/android/app/Service.html)

# android - 在没有root的情况下监控android上的位置提供程序访问？

> ID：10710986
> 
> 赞同：0
> 
> 时间：2012-05-22T22:19:10.173
> 
> 标签：android

有没有办法监视哪个应用程序或应用程序何时向位置提供者询问当前位置而无需 root 访问权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T00:12:57.433

不，对不起。使用`PASSIVE_PROVIDER`，您可以确定其他人正在请求修复，因为这些修复进入，但您无法知道哪些应用程序正在请求它们。

# php - 如何使用 PHP 选择第 1、12、68 甚至第 651 条记录？

> ID：10710989
> 
> 赞同：0
> 
> 时间：2012-05-22T22:19:27.347
> 
> 标签：php, mysql

想象一下，我有一个 MySQL 数据库表，里面有 1000 条记录，我想随机选择 1 条记录。

记录没有数字每次上升 +1 的 ID 列。ID 号是随机生成的，因此第一个记录 ID 可以是“932151540”，第二个记录 ID 可以是“541577961”。

我能想到随机选择 1 条记录的唯一方法是找出总共有多少条记录。选择一个介于 1 和有多少之间的随机数（比如随机数是 467）。然后获得第 467 条记录。

我将如何使用 PHP 做到这一点？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T22:21:41.840

```
SELECT * FROM table ORDER BY RAND() LIMIT 1; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-22T22:21:45.897

```
SELECT *
FROM TABLE
ORDER BY RAND()
LIMIT 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T22:34:51.477

您可以使用的替代查询是

`SELECT * FROM myTable WHERE RAND()<(SELECT ((1/COUNT(*))*10) FROM myTable) ORDER BY RAND() LIMIT 1;`随着表大小的增加，这将产生更好的性能。

引用作者的话：

> 此方法使用 ORDER BY RAND()，但仅对一小部分表行；此百分比基于您想要的行数 LIMIT 1 除以表的行数 COUNT(*)，然后将该数字乘以 10 以避免返回的行数少于您的请求数。在阅读[了如何在 MySQL@rndblog.com 中选择随机行](http://www.rndblog.com/how-to-select-random-rows-in-mysql/)之后，我开发了这种方法。

阅读[此处](http://www.warpconduit.net/2011/03/23/selecting-a-random-record-using-mysql-benchmark-results/)的完整帖子以获得详细的解释和性能分析，以及其他可能不适用于您的情况的替代方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T22:56:19.090

我使用它而不是慢**ORDER BY rand()**，相当快。

```
$table = "mytable";
$offset_result = mysql_query("SELECT FLOOR(RAND() * COUNT(*)) AS offset FROM ".$table.";");
$offset_row = mysql_fetch_object($offset_result);
$offset = $offset_row->offset;
$result = mysql_query("SELECT * FROM ".$table." LIMIT ".$offset.", 1;"); 
$result_row = mysql_fetch_row($result);  // point to record
$row = $result_row[0]; 
```

# objective-c - 将 nil 传递给 arrayWithArray: 的结果是什么？

> ID：10710990
> 
> 赞同：5
> 
> 时间：2012-05-22T22:19:28.253
> 
> 标签：objective-c, cocoa, nsmutablearray, nsarray

当你传递`nil`给时会发生什么`arrayWithArray:`？

假设我有以下代码：

`NSMutableArray *myArray = [NSMutableArray arrayWithArray:someOtherArray];`

如果`someOtherArray`碰巧是`nil`，将`myArray`是`nil`还是将是一个空的可变数组？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-22T22:32:16.150

返回一个空数组。

的示例实现`+arrayWithArray:`如下：

```
+(id) arrayWithArray:(NSArray *) arr
{
    NSMutableArray *returnValue = [NSMutableArray new];
    returnValue->objectsCount = [arr count];
    returnValue->objectsPtr = malloc(sizeof(id) * returnValue->objectsCount);
    [arr getObjects:returnValue->objectsPtr range:NSMakeRange(0, returnValue->objectsCount)];
    return returnValue;
} 
```

因此，如果`arr`为 null，则`-count`返回 0，没有`malloc`'d，并且没有任何内容被复制，因为发送到 nil 对象的消息返回该类型的默认返回值，并且不执行任何其他操作。

# regex - Notepad ++ RegEx 重复语法

> ID：10710994
> 
> 赞同：1
> 
> 时间：2012-05-22T22:20:01.623
> 
> 标签：regex, notepad++, repeat

想象一下，我有一个词“香蕉”。找到这个词的正则表达式重复语法是什么：

到目前为止，我尝试`ba(na){4}s`了，但没有产生任何结果。请问这样做的正确语法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T22:26:34.540

正如我在评论中提到的，您的正则表达式仅适用于从版本 6 开始的 Notepad++，该版本支持 PCRE，因此支持数字量词。以前的版本会报错。

如果您使用的是旧版本并且由于某种原因无法升级，您将无法使用该语法。你将不得不忍受类似的东西`ba(na)+s`，它匹配`na`重复多次，直到达到`s`.

# sql - 能否使用 CTE 或 OVER 将此递归解决方案写入 T-SQL 查询？

> ID：10710995
> 
> 赞同：1
> 
> 时间：2012-05-22T22:20:02.480
> 
> 标签：sql, sql-server, sql-server-2008, tsql

假设您有一个名为 Table1 of Orders 的表格，按时间顺序从 In-line UDF 返回。请注意，OrderID 可能不同步，所以我故意在那里创建了一个异常（即我没有包含 Date 字段，但如果您更容易，我可以访问该列）。

```
 OrderID  BuySell  FilledSize  ExecutionPrice  RunningTotal AverageBookCost  RealisedPnL
   339      Buy      2           24.5            NULL         NULL             NULL
   375      Sell     3           23.5            NULL         NULL             NULL
   396      Sell     3           20.5            NULL         NULL             NULL
   416      Sell     1           16.4            NULL         NULL             NULL
   405      Buy      4           18.2            NULL         NULL             NULL
   421      Sell     1           16.7            NULL         NULL             NULL
   432      Buy      3           18.6            NULL         NULL             NULL 
```

我有一个函数，我想从上到下递归地应用它来计算 3 个 NULL 列，但是该函数的输入将是上一次调用的输出。我创建的函数称为 mfCalc_RunningTotalBookCostPnL，我在下面附上了这个

```
CREATE FUNCTION [fMath].[mfCalc_RunningTotalBookCostPnL](
    @BuySell           VARCHAR(4),
    @FilledSize        DECIMAL(31,15),
    @ExecutionPrice    DECIMAL(31,15),
    @OldRunningTotal   DECIMAL(31,15),
    @OldBookCost       DECIMAL(31,15)
    )

RETURNS @ReturnTable TABLE(
    NewRunningTotal DECIMAL(31,15),
    NewBookCost DECIMAL(31,15),
    PreMultRealisedPnL  DECIMAL(31,15)
    )
AS
BEGIN
    DECLARE @SignedFilledSize   DECIMAL(31,15),
            @NewRunningTotal    DECIMAL(31,15),
            @NewBookCost        DECIMAL(31,15),
            @PreMultRealisedPnL DECIMAL(31,15)

    SET @SignedFilledSize = fMath.sfSignedSize(@BuySell, @FilledSize)
    SET @NewRunningTotal = @OldRunningTotal + @SignedFilledSize
    SET @PreMultRealisedPnL = 0
    IF SIGN(@SignedFilledSize) = SIGN(@OldRunningTotal)
        -- This Trade is adding to the existing position.
        SET @NewBookCost = (@SignedFilledSize * @ExecutionPrice +
            @OldRunningTotal * @OldBookCost) / (@NewRunningTotal)
    ELSE
    BEGIN
        -- This trade is reversing the existing position.
        -- This could be buying when short or selling when long.
        DECLARE @AbsClosedSize DECIMAL(31,15)
        SET @AbsClosedSize = fMath.sfMin(ABS(@SignedFilledSize), ABS(@OldRunningTotal));

        -- There must be Crystalising of PnL.
        SET @PreMultRealisedPnL = (@ExecutionPrice - @OldBookCost) * @AbsClosedSize * SIGN(-@SignedFilledSize)

        -- Work out the NewBookCost
        SET @NewBookCost = CASE
            WHEN ABS(@SignedFilledSize) < ABS(@OldRunningTotal) THEN @OldBookCost
            WHEN ABS(@SignedFilledSize) = ABS(@OldRunningTotal) THEN 0
            WHEN ABS(@SignedFilledSize) > ABS(@OldRunningTotal) THEN @ExecutionPrice
        END
    END

    -- Insert values into Return Table
    INSERT INTO @ReturnTable
        VALUES (@NewRunningTotal, @NewBookCost, @PreMultRealisedPnL)

    -- Return
    RETURN
END 
```

因此，我正在寻找的 t-SQL 命令（我不介意是否有人也可以创建外部应用）将生成以下结果/解决方案集：

```
OrderID BuySell FilledSize ExecutionPrice RunningTotal AverageBookCost RealisedPnL
339     Buy     2          24.5           2            24.5            0
375     Sell    3          23.5           -1           23.5            -2
396     Sell    3          20.5           -4           21.25           0
416     Sell    1          16.4           -5           20.28           0
405     Buy     4          18.2           -1           20.28           8.32
421     Sell    1          16.7           -2           18.49           0
432     Buy     3          18.6           1            18.6            -0.29 
```

需要注意的是，上面的存储过程调用了一个简单的函数 fMath.sfSignedSize，它只使 ('Sell',3) = -3。此外，为免生疑问，假设我的计算正确，我会看到按此顺序进行这些调用的解决方案！（请注意，我开始假设 OldRunningTotal 和 OldBookCost 都为零）：

```
SELECT * FROM fMath.mfCalc_RunningTotalBookCostPnL('Buy',2,24.5,0,0)
SELECT * FROM fMath.mfCalc_RunningTotalBookCostPnL('Sell',3,23.5,2,24.5)
SELECT * FROM fMath.mfCalc_RunningTotalBookCostPnL('Sell',3,20.5,-1,23.5)
SELECT * FROM fMath.mfCalc_RunningTotalBookCostPnL('Sell',1,16.4,-4,21.25)
SELECT * FROM fMath.mfCalc_RunningTotalBookCostPnL('Buy',4,18.2,-5,20.28)
SELECT * FROM fMath.mfCalc_RunningTotalBookCostPnL('Sell',1,16.7,-1,20.28)
SELECT * FROM fMath.mfCalc_RunningTotalBookCostPnL('Buy',3,18.6,-2,18.49) 
```

显然，[fMath].[mfCalc_RunningTotalBookCostPnL] 可能需要调整，以便它可以从作为 OldRunningTotal 和 OldBookCost 的 NULL 条目开始，但这很简单。应用递归性质的 SQL 集理论有点困难。

非常感谢，伯蒂。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T02:26:34.407

### 运行总。更新临时表与 CTE

```
create table Test(
    OrderID int primary key,
    Qty int not null
);

declare @i int = 1;

while @i <= 5000 begin
    insert into Test(OrderID, Qty) values (@i * 2,rand() * 10); 
    set @i = @i + 1;
end; 
```

**递归求解**需要 9 秒：

```
with T AS
(
    select ROW_NUMBER() over(order by OrderID) as rn, * from test
)
,R(Rn, OrderId, Qty, RunningTotal) as
(
    select Rn, OrderID, Qty, Qty
    from t 
    where rn = 1

    union all

    select t.Rn, t.OrderId, t.Qty, p.RunningTotal + t.Qty
    from t t
    join r p on t.rn = p.rn + 1

)
select R.OrderId, R.Qty, R.RunningTotal from r
option(maxrecursion 0); 
```

**UPDATE 表**需要 0 秒：

```
create function TestRunningTotal()
returns @ReturnTable table(
    OrderId int, Qty int, RunningTotal int
)
as begin

    insert into @ReturnTable(OrderID, Qty, RunningTotal)
    select OrderID, Qty, 0 from Test
    order by OrderID;

    declare @RunningTotal int = 0;

    update @ReturnTable set 
           RunningTotal = @RunningTotal, 
           @RunningTotal = @RunningTotal + Qty;

    return;
end; 
```

这两种方法至少可以为您提供一个构建查询的框架。

* * *

顺便说一句，在 SQL Server 中，与 MySQL 不同，变量赋值的顺序无关紧要。这：

```
update @ReturnTable set 
    RunningTotal = @RunningTotal, 
    @RunningTotal = @RunningTotal + Qty; 
```

以及以下内容：

```
update @ReturnTable set 
    @RunningTotal = @RunningTotal + Qty,
    RunningTotal = @RunningTotal; 
```

它们都以相同的方式执行，即变量赋值首先发生，而不管变量赋值在语句中的位置。两个查询都有相同的输出：

```
OrderId     Qty         RunningTotal
----------- ----------- ------------
2           4           4
4           8           12
6           4           16
8           5           21
10          3           24
12          8           32
14          2           34
16          9           43
18          1           44
20          2           46
22          0           46
24          2           48
26          6           54 
```

在您的确切表格上，只需检测买入/卖出，您可以分别将其乘以 1 和 -1，或者您只需在字段上签名，例如：

```
update @ReturnTable set 
       @RunningTotal = @RunningTotal + 
                       CASE WHEN BuySell = 'Buy' THEN Qty ELSE -Qty END,
       RunningTotal = @RunningTotal; 
```

* * *

如果您碰巧升级到 SQL Server 2012，以下是运行总计的简单实现：

```
select OrderID, Qty, sum(Qty) over(order by OrderID) as RunningTotal
from Test 
```

关于您的确切问题：

```
select OrderID, Qty, 

   sum(CASE WHEN BuySell = 'Buy' THEN Qty ELSE -Qty END) 
   over(order by OrderID) as RunningTotal

from Test; 
```

* * *

**更新**

如果您对[古怪的 update](http://ask.sqlservercentral.com/questions/5150/please-can-somebody-explain-how-quirky-updates-wor.html)感到不安，您可以添加一个保护子句来检查要更新的行的顺序是否与原始顺序匹配（由 identity(1,1) 辅助）：

```
create function TestRunningTotalGuarded()
returns @ReturnTable table(
    OrderId int, Qty int, 
    RunningTotal int not null, 
    RN int identity(1,1) not null
)
as begin

    insert into @ReturnTable(OrderID, Qty, RunningTotal)
    select OrderID, Qty, 0 from Test
    order by OrderID;

    declare @RunningTotal int = 0;

    declare @RN_check INT = 0;

    update @ReturnTable set 
            @RN_check = @RN_check + 1,
            @RunningTotal = 
                (case when RN = @RN_check then @RunningTotal + Qty else 1/0 end),
            RunningTotal = @RunningTotal;

    return;

end; 
```

如果 UPDATE 真的以不可预知的顺序更新行（或任何机会），@RN_Check 将不再等于 RN（身份顺序），那么代码将引发**被零除的错误**。使用保护子句，不可预测的更新顺序将[快速失败](http://c2.com/cgi/wiki?FailFast)；如果发生这种情况，是时候向微软提交~~错误~~请愿书，让这个古怪的更新不那么古怪了 :-)

内在命令式操作（变量赋值）上的保护子句对冲实际上是顺序的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T01:45:38.730

如果没有完全运行的 [fMath].[mfCalc_RunningTotalBookCostPnL] 进行测试，这有点暗中刺伤。我在测试前第一次获得递归 CTE 的记录只有大约 50%，但即使不完美，如果我正确理解您的要求，它也应该足以让您开始：

```
-- First, cache Table1 into #temp to improve recursive CTE performance
select
RowNum=ROW_NUMBER()OVER(ORDER BY OrderID)
, *
INTO #temp
FROM Table1;
GO

; WITH CTE (RowNum,OrderID, BuySell, FilledSize, ExecutionPrice, RunningTotal, AverageBookCost, RealisedPnL) AS (
    SELECT RowNum,OrderID, BuySell, FilledSize, ExecutionPrice, RunningTotal=0, AverageBookCost=0, RealisedPnL=0
    FROM #temp
    WHERE RowNum=1

    UNION ALL

    SELECT t.RowNum, t.OrderID, t.BuySell, t.FilledSize, t.ExecutionPrice
    , RunningTotal=c.NewRunningTotal, AverageBookCost=c.NewBookCost, RealisedPnL=c.PreMultRealisedPnL
    FROM #temp t
    INNER JOIN CTE ON CTE.RowNum+1 = t.RowNum
    CROSS APPLY [fMath].[mfCalc_RunningTotalBookCostPnL](t.BuySell, t.FilledSize, t.ExecutionPrice, CTE.RunningTotal, CTE.AverageBookCost) AS c
)
SELECT OrderID, BuySell, FilledSize, ExecutionPrice, RunningTotal, AverageBookCost, RealisedPnL
FROM CTE
/* Replace the above SELECT with the following after testing ok
UPDATE tab
SET RunningTotal=CTE.RunningTotal
, AverageBookCost=CTE.AverageBookCost
, RealisedPnL=CTE.RealisedPnL
FROM Table1 tab
INNER JOIN CTE on CTE.OrderID=tab.OrderID
*/
OPTION (MAXRECURSION 32767);
GO

-- clean up
DROP TABLE #temp
GO 
```

还有一个免责声明 - 递归 CTE 适用于 32767 的最大深度。如果这限制性太大，您将需要探索一种不同的方法，或者对数据集进行某种窗口化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-28T17:55:27.787

我重新制作了正在运行的总查询以包括一个分区（在客户上）

CTE方法：

```
with T AS
(
    select 
       ROW_NUMBER() over(partition by CustomerCode order by OrderID) as rn, * 
    from test
)
,R(CustomerCode, Rn, OrderId, Qty, RunningTotal) as
(
    select CustomerCode, Rn, OrderID, Qty, Qty
    from t 
    where rn = 1

    union all

    select t.CustomerCode, t.Rn, t.OrderId, t.Qty, p.RunningTotal + t.Qty
    from t t
    join r p on p.CustomerCode = t.CustomerCode and t.rn = p.rn + 1

)
select R.CustomerCode, R.OrderId, R.Qty, R.RunningTotal from r
order by R.CustomerCode, R.OrderId 
option(maxrecursion 0); 
```

古怪的更新方法：

```
create function TestRunningTotalGuarded()
returns @ReturnTable table(
    CustomerCode varchar(50), OrderId int, Qty int, 
    RunningTotal int not null, RN int identity(1,1) not null
)
as begin

    insert into @ReturnTable(CustomerCode, OrderID, Qty, RunningTotal)
    select CustomerCode, OrderID, Qty, 0 from Test
    order by CustomerCode, OrderID;

    declare @RunningTotal int;

    declare @RN_check INT = 0;
    declare @PrevCustomerCode varchar(50) = NULL;

    update @ReturnTable set
            @RN_check = @RN_check + 1,
            @RunningTotal = 
                (case when RN = @RN_check then
                    case when @PrevCustomerCode = CustomerCode then
                        @RunningTotal + Qty 
                    else
                        Qty
                    end
                else
                    1/0 
                end),
            @PrevCustomerCode = CustomerCode,
            RunningTotal = @RunningTotal;

    return;
end; 
```

光标方法（压缩代码以删除滚动条）

```
create function TestRunningTotalCursor()
returns @ReturnTable table(CustomerCode varchar(50), OrderId int, 
                           Qty int, RunningTotal int not null) as
begin     
    declare @c_CustomerCode varchar(50);
    declare @c_OrderID int;
    declare @c_qty int;

    declare @PrevCustomerCode varchar(50) = null;
    declare @RunningTotal int = 0;

    declare o_cur cursor for
    select CustomerCode, OrderID, Qty from Test order by CustomerCode, OrderID;     
    open o_cur;
    fetch next from o_cur into @c_CustomerCode, @c_OrderID, @c_Qty;

    while @@FETCH_STATUS = 0 begin

        if @c_CustomerCode = @PrevCustomerCode begin
            set @RunningTotal = @RunningTotal + @c_qty;
        end else begin
            set @RunningTotal = @c_Qty;
        end;

        set @PrevCustomerCode = @c_CustomerCode;

        insert into @ReturnTable(CustomerCode, OrderId, Qty, RunningTotal)
        values(@c_CustomerCode, @c_OrderID, @c_Qty, @RunningTotal);

        fetch next from o_cur into @c_CustomerCode, @c_OrderID, @c_Qty;
    end;

    close o_cur; deallocate o_cur; return;
end; 
```

5,000 行的指标：

```
* Recursive CTE : 49 seconds
* Quirky Update : 0 second
* Cursor        : 0 second 
```

那些 0 秒没有意义。在我将行数增加到 50,000 行后，以下是指标：

```
* Quirky Update : 1 second
* Cursor        : 3 second
* Recursive CTE : An hour 
```

警告，我[发现](http://www.ienablemuch.com/2012/05/recursive-cte-is-evil-and-cursor-is.html)古怪的更新真的很古怪，有时它有效，有时它不（由五分之一的查询运行中存在被零除错误表示）。

* * *

这是数据的 DDL：

```
create table Test(
    OrderID int primary key,
    CustomerCode varchar(50),
    Qty int not null
);

declare @i int = 1;

while @i <= 20 begin
    insert into Test(OrderID, CustomerCode, Qty) values (
        @i * 2
        ,case @i % 4 
        when 0 then 'JOHN'
        when 1 then 'PAUL'
        when 2 then 'GEORGE'
        when 3 then 'RINGO'
        end
        ,rand() * 10);    
    set @i = @i + 1;
end; 
```

* * *

**更新**

显然，纯 CTE 方法并不好。必须使用混合方法。将行编号具体化为实际表时，速度会上升

```
select ROW_NUMBER() over(partition by CustomerCode order by OrderID) as rn, * into #xxx 
from test;

with T AS
(
    select * from #xxx
)
,R(CustomerCode, Rn, OrderId, Qty, RunningTotal) as
(
    select CustomerCode, Rn, OrderID, Qty, Qty
    from t 
    where rn = 1

    union all

    select t.CustomerCode, t.Rn, t.OrderId, t.Qty, p.RunningTotal + t.Qty
    from t t
    join r p on p.CustomerCode = t.CustomerCode and t.rn = p.rn + 1

)
select R.CustomerCode, R.OrderId, R.Qty, R.RunningTotal from r
order by R.CustomerCode, R.OrderId 
option(maxrecursion 0);

drop table #xxx; 
```

回顾一下，这里是在将纯 CTE 转换为使用物化行编号之前的指标（行编号结果在实际表中，即在临时表中）

```
* Quirky Update       : 1 second
* Cursor              : 3 second
* Recursive CTE(Pure) : An hour 
```

将行编号具体化到临时表后：

```
* Quirky Update         : 1 second
* Cursor                : 3 second
* Recursive CTE(Hybrid) : 2 second (inclusive of row numbering table materialization) 
```

混合递归 CTE 方法实际上比游标方法更快。

* * *

**另一个更新**

只需将聚集的主键放在顺序列上，UPDATE 就可以更新其*物理*顺序上的行。不再发生除以零（检测非顺序更新的保护子句）。例如

```
alter function TestRunningTotalGuarded()
returns @ReturnTable table(
    CustomerCode varchar(50), OrderId int, Qty int, 
    RunningTotal int not null, 
    RN int identity(1,1) not null primary key clustered
) 
```

如果可能存在极端情况，我尝试运行古怪的更新（使用集群主键）100 次，但到目前为止我没有发现。我没有遇到任何被零除的错误。阅读这篇博文底部的结论：[http ://www.ienablemuch.com/2012/05/recursive-cte-is-evil-and-cursor-is.html](http://www.ienablemuch.com/2012/05/recursive-cte-is-evil-and-cursor-is.html)

即使有集群主键，它仍然很快。

这是 100,000 行的指标：

```
Quirky Update        : 3 seconds
Hybrid Recursive CTE : 5 seconds
Cursor               : 6 seconds 
```

古怪的更新（毕竟不是那么古怪）仍然很快。它比混合递归 CTE 更快。