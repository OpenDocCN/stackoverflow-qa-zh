# StackOverflow 问答 11294000-11294999

# sql - Django 在特定领域与众不同

> ID：11294008
> 
> 赞同：1
> 
> 时间：2012-07-02T12:47:50.633
> 
> 标签：sql, django, django-models, django-queryset

```
class A:
    name = Char...

class B:
    base = ForeignKey(A)
    value = Integer.. 
```

`B.objects.values('a__name','value').distinct('a__name')`

正如您在上面所理解的，我尝试按相关对象的名称对 B 对象进行分组。但是， distinct 函数不带参数。

我已经尝试过注释和聚合，但我无法分组`a__name` 我也尝试过`values_list`，`flat=True`但它只需要一个列名，但我需要`a__name`和`value`字段。

我怎么能在 Django 中做到这一点？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T14:45:04.167

首先，您需要 Django 1.4+。如果您运行的是较小的版本，那么您就不走运了。然后，您必须使用 PostgreSQL。将参数传递给`distinct`不适用于其他数据库。

请参阅[文档`distinct`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.distinct)并注意“注意”行。

如果您不满足上述条件，我想您也可以随时发出[原始查询。](https://docs.djangoproject.com/en/dev/topics/db/sql/)

# spring - Spring CrudRepository 抛出 org.hibernate.LazyInitializationException

> ID：11294009
> 
> 赞同：2
> 
> 时间：2012-07-02T12:47:51.703
> 
> 标签：spring, spring-data

我在使用 CrudRepository 时遇到了问题。示例：我有两个实体，实体 A 有一个实体 B 的集合。

```
class A {
  int id;
  int name;
  @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY)
  Set<B> bs;
  // getters and setters
}
class B {
  int id;
  int name;
  @ManyToOne(mappedBy="bs")
  A a;
  // getters and setters
} 
```

然后我得到了 2 个存储库。

```
class ARepository extends CrudRepository<A, int>{}
class BRepository extends CrudRepository<B, int>{} 
```

但是当我得到这个时，我得到了一个 org.hibernate.LazyInitializationException，我该如何避免这种情况？

```
@Service
@Transactional(readOnly=true)
class ServiceImpl implements Service {
@Resource ARepository ar;

@Override
A a = ar.findOne(int id);
} 
```

这是 applicationContext.xml：

```
<jpa:repositories base-package="com.myproject.repository" />

<context:component-scan base-package="com.myproject.*" />
<context:annotation-config />

<bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager" >
    <property name="entityManagerFactory" ref="entityManagerFactory" />
</bean>
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="persistenceUnitName" value="keep-apm" />
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
            <property name="showSql" value="true" />
            <property name="generateDdl" value="true" />
            <property name="database" value="POSTGRESQL"/>
            <property name="databasePlatform" value="org.hibernate.dialect.PostgreSQLDialect"/>
        </bean>
    </property>
</bean>
<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="username" value="root" />
    <property name="password" value="root" />
    <property name="driverClassName" value="org.postgresql.Driver" />
    <property name="url" value="jdbc:postgresql://127.0.0.1:5432/db" />
</bean>
<bean id="sessionFactory" factory-bean="entityManagerFactory" factory-method="getSessionFactory">
</bean>
<tx:annotation-driven transaction-manager="transactionManager" /> 
```

这是 web.xml

```
<filter>
    <filter-name>openSessionInViewFilter</filter-name>
    <filter-class>org.springframework.orm.hibernate4.support.OpenSessionInViewFilter</filter-class>
    <init-param>
        <param-name>singleSession</param-name>
        <param-value>true</param-value>
    </init-param>

</filter>
<filter-mapping>
    <filter-name>openSessionInViewFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<filter>
    <filter-name>struts2</filter-name>
    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<listener>
    <listener-class>com.myproject.util.LogLocator</listener-class>
</listener>

<welcome-file-list>
    <welcome-file>index.jsp</welcome-file>
</welcome-file-list> 
```

a.bs(the collection) 不会被加载，并且总是抛出**org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: no session or session was closed**

先感谢您！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T12:52:27.090

您需要使用启动事务，最好通过 Spring 的[声明式事务管理](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/transaction.html#transaction-declarative)。

大多数情况下：

*   在你的 XML 中定义一个 TransactionManager
*   将此添加到您的 XML`<tx:annotation-driven />`
*   用注释你的服务方法`@Transactional`

[您可以在使用](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/transaction.html#transaction-declarative-annotations)部分中找到示例设置[`@Transactional`](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/transaction.html#transaction-declarative-annotations)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T09:55:29.670

这是解决方案：

我无法访问我的 Web 层上的对象，我应该访问服务层中的延迟加载对象，它应该在事务中。

# jquery - jquery获取悬停的li的索引

> ID：11294012
> 
> 赞同：1
> 
> 时间：2012-07-02T12:48:07.457
> 
> 标签：jquery, indexing, html-lists

我要做的就是返回悬停的 i 的索引， ul 有一个类 .around

这看起来应该工作

```
$('.around li').on("mouseover", function(event){
var myindex =  $('.around').index(this);
console.log(myindex);
}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T12:53:51.673

这个怎么样：

```
$('.around li').on("mouseover", function(event){
var myindex =  $(this).index();
console.log(myindex);
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T12:54:08.570

也许你正在尝试这样做：

```
var li = $('.around li');
li.on("mouseover", function(){
   var myindex = li.index(this);
   console.log(myindex);
}) 
```

小提琴示例：http: [//jsfiddle.net/MKExb/](http://jsfiddle.net/MKExb/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T12:54:46.210

你可以这样写：

```
var listItem = document.getElementById('bar');
alert('Index: ' + $('li').index(listItem)); 
```

高温高压

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T13:14:01.423

你可以用这个

```
<script type="text/javascript">

      $(document).ready(function () {
            $('.around li').each(function () {
                $(this).bind('mouseover', null, function () {
                    var index = $('.around li').index(this);
                    console.log(index);
                });

            }, function () { });

        });

</script> 
```

或更清洁的

```
 <script type="text/javascript">
    $(document).ready(function () {
        $('.around li').hover(function () {
            var index = $('.around li').index(this);
            console.log(index);
        }, function () { });

    }); 
    </script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-04T03:22:01.983

在性能方面，公认的答案很糟糕。缓存查询和使用委托要好得多，这样只会在 ul 上设置一个处理程序，然后将每个事件委托给鼠标所在的 li。我修改了原来的jsfiddle，看看，效果很好，代码也不长了：

[http://jsfiddle.net/zhkjLoet/1/](http://jsfiddle.net/zhkjLoet/1/)

```
var ul = $('.around'); // cache query
ul.on("mouseover","li", function(event){ //delegate events to li child
   var myindex = $(this).index();
   console.log(myindex);
}) 
```

# jquery - 使用 html 方法插入元素时，我可以将原始元素保留在 DOM 中吗？

> ID：11294014
> 
> 赞同：2
> 
> 时间：2012-07-02T12:48:15.647
> 
> 标签：jquery

我发现了一件奇怪的事情。当我使用 jQuery 方法将一个元素插入另一个元素时`html()`，第一个元素会从 DOM 中删除。我想知道是否可以插入一个元素并将其保存在 DOM 中。

这是[一个例子](http://jsfiddle.net/aqueE/)：

```
$(document).ready(function(){
    select1 = $("#select-1");
    select2 = $("#select-2");
    $("#gap").html(select2); //Original select2 removed from DOM
}); 
```

如您所见，`#select-2`如果将元素插入另一个元素，则该元素将不再可见。但我想插入它，并像以前一样保留原始元素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T12:51:48.440

假设我正确理解了您的问题，您可以[`clone`](http://api.jquery.com/clone/)使用以下元素：

```
$(document).ready(function(){
    var select1 = $("#select-1"),
        select2 = $("#select-2");
    $("#gap").html(select2.clone());
}); 
```

如果您需要保留任何绑定到`select2`您的事件处理程序，可以将`true`其作为参数传递给`clone`.

这是一个[工作示例](http://jsfiddle.net/aqueE/2/)。

* * *

作为旁注，请注意我在`var`变量声明之前添加了关键字。这可以防止变量泄漏到全局范围内（您通常不希望这样做）。

* * *

作为另一个旁注，看起来这种形式的`html`方法没有记录在 jQuery API 中（它列出`.html( htmlString )`了`htmlString`应该是“HTML 字符串”的状态）。

然而， [jQuery 源代码](https://github.com/jquery/jquery/blob/master/src/manipulation.js#L211)明确允许使用字符串、元素或 jQuery 对象。如果 `htmlString`是字符串，`innerHTML`则使用本机属性。如果不是，`append`则改用该方法：

```
if ( typeof value === "string" /* ... */ ) {
    //...
}
if ( elem ) {
    this.empty().append( value ); //In your case we end up here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T12:54:39.343

和

```
var select2 = $("#select-2"); 
```

您直接指的是 DOM 元素，而不仅仅是它的内容！这就是为什么您移动元素而不是克隆它的原因。

要做到后者，要么写：

```
$("#gap").html(select2.clone()); 
```

或者

```
$("#gap").html(select2.html()); 
```

或者

```
var select2 = $("#select-2").html();
$("#gap").html(select2); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T12:52:04.697

将您的代码更改为此

```
$(document).ready(function(){
    select1 = $("#select-1");
    select2 = $("#select-2");
    $("#gap").html(select2.html());
    select1.show();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T12:52:12.610

尝试

```
$(document).ready(function(){
    select1 = $("#select-1");
    select2 = $("#select-2").html();
    $("#gap").html(select2);
    select1.show();
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-02T12:57:50.340

实际上，有几个命令可以做到这一点。我通常使用：insertAfter()、insertBefore()、before()、after()、append()、appendTo()、prepend()、prependTo()。

常用使用方式： **html**

```
<div id="somediv">
    some content
</div> 
```

**JS**

```
$(document).ready(function(){
  $("<span/>").html("this is what I'm appending").appendTo("#somediv");
}); 
```

在这里，我将一个 span inline-block 元素附加到现有的 div 块中。其他功能类似，请随意阅读文档。

如果你想保留原来的，只需像这样使用克隆：

```
$(document).ready(function(){
  var theclone = $("#select-2").clone();
  theclone.appendTo("#gap");
}); 
```

当然有几种方法可以做到这一点，但我认为这可以完成工作。这是您修改后的示例：http: [//jsfiddle.net/9PAYd/](http://jsfiddle.net/9PAYd/)

# cakephp - Cakephp 2.0 + 元素 + requestAction = 空结果

> ID：11294016
> 
> 赞同：3
> 
> 时间：2012-07-02T12:48:23.717
> 
> 标签：cakephp

我正在尝试在 Cakephp 2.0 中使用 Elements，但没有运气。我有一个名为 Post 的模型、一个名为 Posts 的控制器和各种视图。在布局中，我想包括（对于每个页面/视图）一个带有最新消息的框（比如 2）。

所以我创建了元素**dok-posts.ctp**

```
<?php $posts = $this->requestAction('posts/recentnews'); ?>
<?php foreach($posts as $post): ?>

<div class="Post">
.... 
```

在我的**PostsController 中**，我添加了函数**recentnews()**

```
public function recentnews(){
$posts =  $this->Post->find('all',array('order' => 'Post.created DESC','limit' => 2));
if ($this->request->is('requested')) {
    return $posts;
} else {
    $this->set('posts', $posts);
    }
} 
```

在我的布局中，**default.ctp**我称我的元素

```
<?php echo $this->element('dok-posts'); ?> 
```

问题是我收到这条消息

```
Invalid argument supplied for foreach() [APP\View\Elements\dok-posts.ctp, line 9] 
```

在**dok-posts.php**中调试，就在`$this->requestAction`，给我一个空行。该`recentnews`函数似乎没有返回任何内容（在函数中进行调试会返回一个包含找到的帖子的数组）。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:38:52.013

由于您发现实际调用了该操作，

```
$posts = $this->requestAction('posts/recentnews'); 
```

工作正常。在这里，为了清晰和扩展配置选项（用于以后对代码的更改），我建议您使用 Router 数组而不是 URL

```
$posts = $this -> requestAction(array(
 'controller' => 'posts',
 'action' => 'recentnews'
)); 
```

现在到你的实际问题......既然你说，它总是进入 else 分支，

```
$this->request->is('requested') 
```

可能无法按预期工作。试试这个（它对我来说很完美）：

```
if (!empty($this -> request -> params['requested'])) {
   return $posts;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-06T08:24:18.353

在您的应用控制器中创建 beforefilter 和 getNewsElement 函数。

```
public function beforeFilter() {
    parent::beforeFilter();
    $data = $this->getNewsElement();
    $this->set('posts',$data);
}

function getNewsElement(){
# Put Post model in uses
$posts =  $this->Post->find('all',array('order' => 'Post.created DESC','limit' => 2));
return $posts;
}

dok-posts.ctp
#Remove <?php $posts = $this->requestAction('posts/recentnews'); ?>
<?php foreach($posts as $post): ?>

<div class="Post">
....

In  PostsController
public function recentnews(){
$posts =  $this->getNewsElement();

    $this->set('posts', $posts);

} 
```

这将解决您的问题！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T05:50:55.240

我已经按照 Cakephp's guide 中的示例进行了操作。从它没有通过 if 语句的那一刻起，似乎控件存在问题。

```
$this->request->is('requested') 
```

所以我删除了

```
is->('requested') 
```

添加

```
->params['requested'] 
```

它有效。

感谢大家的帮助（尤其是解决方案的**wnstnsmth**）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T13:15:07.720

尝试

```
<?php $posts = $this->requestAction('/posts/recentnews'); ?> 
```

（注意前导斜杠）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-06T06:33:53.380

```
Try this

 <?php $this->requestAction('/controllerName/functionName');?> 
```

# php - PHP Array - 获取键值

> ID：11294018
> 
> 赞同：-2
> 
> 时间：2012-07-02T12:48:38.473
> 
> 标签：php

> **可能重复：**
> [PHP 获取数组值和数组键](https://stackoverflow.com/questions/5745582/php-get-both-array-value-and-array-key)

我正在使用 Codeigniters 的 form_checkbox() 方法。

使用 foreach 循环我正在创建 form_checkbox 和表单的标签。这一切都很好，但我需要从数组中获取值。

我的阵列设置如下：

```
Array
(
    [1] => Animals
    [2] => Art and Culture
    [3] => Children
    [4] => Disability
    [5] => Disaster Relief
    [6] => Domestic Violence
); 
```

我的 PHP 代码如下：

```
<?php foreach($interests as $interest)
        {
            echo form_checkbox('user_interests[]', $interest);
            echo "<label>$interest</label>";
        }
?> 
```

这会产生 HTML Like ：

> ```
> <input type="checkbox" value="Animals" name="user_interests[]"> 
> ```

我希望它是 Array 键中的 value = "1"、"2" 等。

我怎么得到这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T12:50:28.240

将循环更改为：

```
foreach($interests as $key => $interest) {
  ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T12:50:44.357

使用此代码：

```
foreach($interests as $key => $interest) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T12:54:03.163

将您的 php 代码更改为：

```
foreach($interests as $key => $interest)
{
    echo form_checkbox('user_interests[]', $key);
    echo "<label>$interest</label>";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T12:51:41.390

尝试这个 ：

```
<?php foreach($interests as $k=> $interest)
        {
           $data= array('name'=>'user_interests[]', 'value'= $k)
            echo form_checkbox($data);
            echo "<label>$interest</label>";
        }
?> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-02T12:52:35.287

像这样：

```
foreach ($interests as $key => $interest) {
  echo form_checkbox("user_interests[$key]", $interest);
  echo "<label>$interest</label>";
} 
```

# python - 使用 Python 的正则表达式模式在 HTML 页面中搜索

> ID：11294019
> 
> 赞同：1
> 
> 时间：2012-07-02T12:48:40.847
> 
> 标签：python, html, regex, parsing, html-parsing

我正在尝试在具有已知模式的 HTML 页面中查找字符串。例如，在以下 HTML 代码中：

```
<TABLE WIDTH="100%">
<TR><TD ALIGN="LEFT" width="50%">&nbsp;</TD>
<TD ALIGN=RIGHT VALIGN=BOTTOM WIDTH=50%><FONT SIZE=-1>( <STRONG>1</STRONG></FONT> <FONT SIZE=-2>of</FONT> <STRONG><FONT SIZE=-1>1</STRONG> )</FONT></TD></TR></TABLE>
<HR>
<TABLE WIDTH="100%">
<TR>    <TD ALIGN="LEFT" WIDTH="50%"><B>String 1</B></TD>
    <TD ALIGN="RIGHT" WIDTH="50%"><B><A Name=h1 HREF=#h0></A><A  HREF=#h2></A><B><I></I></B>String</B></TD>
</TR>
<TR><TD ALIGN="LEFT" WIDTH="50%"><b>String 2.</B>
</TD>
<TD ALIGN="RIGHT" WIDTH="50%"> <B>
String 3
</B></TD>
</TR>
</TABLE>
<HR>
<font size="+1">String 4</font><BR>
... 
```

我想找到**String 4**，我知道它总是介于

`<HR><font size="+1">`
和 `</font><BR>`

如何使用 RE 搜索字符串？

编辑：

我尝试了以下方法，但没有成功：

```
p = re.match('<HR><font size="+1">(.*?)</font><BR>',html) 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T14:07:41.613

```
re.findall(r'<HR>\s*<font size="\+1">(.*?)</font><BR>', html, re.DOTALL) 
```

`findall`正在返回一个列表，其中包含正则表达式中括号之间捕获的所有内容。我使用了 re.DOTALL，所以点也捕获了行尾。

我使用`\s*`是因为我不确定是否会有空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T12:57:20.907

这可行，但可能不是很健壮：

```
import re
r = re.compile('<HR>\s?<font size="\+1">(.+?)</font>\s?<BR>', re.IGNORECASE)
r.findall(html) 
```

使用适当的 HTML 解析器会更好。BeautifulSoup 非常好用且易于使用。查一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:02:06.820

```
re.findall(r'<HR>\n<font size="\+1">([^<]*)<\/font><BR>', html, re.MULTILINE) 
```

# python - WSGISocketPrefix 无法解决 503 Service Temporarily Unavailable 错误

> ID：11294022
> 
> 赞同：0
> 
> 时间：2012-07-02T12:48:54.060
> 
> 标签：python, django, apache, mod-wsgi, wsgi

尝试在守护程序模式下设置 mod_wsgi 时出现 503 Service Temporarily Unavailable 错误。是什么让我好奇将 WSGISocketPrefix 设置为 /var/run/wsgi 或任何其他目录并没有给我任何帮助。我仍然在错误日志中有“(13)Permission denied: mod_wsgi (pid=21696): Unable to connect to WSGI daemon process...”。

你能给我一些建议吗？谢谢你。

这是我的虚拟主机配置：

```
<VirtualHost *:80>
    DocumentRoot /home/anti1869/blabla/http
    CustomLog /var/log/apache2/anti1869/blabla/access.log combined
    ErrorLog /var/log/apache2/anti1869/blabla/error.log
    <IfModule peruser.c>
        ServerEnvironment anti1869 anti1869
        Processor anti1869 anti1869
    </IfModule>
#   <IfModule mod_suexec.c>
#       SuexecUserGroup anti1869 anti1869
#   </IfModule>
#   <IfModule mod_suexec>
#       SuexecUserGroup anti1869 anti1869
#   </IfModule>
    ServerName blabla.com
    ServerAlias www.blabla.com
    Alias /.awstats/icon /usr/share/awstats/wwwroot/icon

    WSGIDaemonProcess blabla.com user=anti1869 group=anti1869 processes=2 threads=15 display-name=%{GROUP}
    WSGIProcessGroup blabla.com
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T22:15:09.783

为 worker 或 prefork MPM 编译的 mod_wsgi.so 不适用于 peruser MPM。甚至不确定如果 mod_wsgi 是从源代码编译的，是否可以与 peruser MPM 一起使用。你用的是什么MPM？是您的配​​置建议的 peruser 吗？

# ios - 哪些是好的 ASIHTTPRequest 替代品？

> ID：11294026
> 
> 赞同：4
> 
> 时间：2012-07-02T12:49:21.173
> 
> 标签：ios, asihttprequest

我目前正在开发一个应用程序，它将在 appstore 上发布。我只需要我的应用程序能够将 json 文件发送到服务器。我目前正在将 asihttprequest 用于此 ONLY post 方法，但该类不再由开发人员开发。我想问的是，最新版本的 asihttprequest 对于应用程序是否可靠，或者我是否应该使用替代方案？如果是，请给我一个替代方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T12:50:54.867

我会选择[MKNetworkKit](https://github.com/MugunthKumar/MKNetworkKit)或[AFNetworking](https://github.com/AFNetworking/AFNetworking/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T20:35:02.023

FTR，根据[这篇博](http://engineering.foursquare.com/2012/07/19/say-hello-to-fsnetworking-a-small-networking-library-for-ios-and-mac/)文，Foursquare 发布了一个[FSNetworking](https://github.com/foursquare/FSNetworking)库，这可能是一个合适的替代方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-06T09:54:09.727

嗨，我更喜欢使用[AFNetworking](https://github.com/AFNetworking/AFNetworking/)，因为不信任 ASIHTTprequest 是

*   没有得到维护
*   它在 iPod1+ iOS6 组合 [参考上出现问题](https://stackoverflow.com/questions/12641997/asiformdatarequestclass-not-working-for-ios6)

# python - Python重命名程序中的错误.....没有这样的文件或目录（Fnmatch）

> ID：11294034
> 
> 赞同：3
> 
> 时间：2012-07-02T12:50:06.900
> 
> 标签：python, rename

我正在尝试构建一个小的重命名程序，以帮助我在未来节省时间。基本上它会通过我指向它的目录，如果它们符合某些条件则重命名文件。

我已经写了我需要的东西，但是我一开始就有一个我无法弄清楚的错误。

这是代码：

```
import os
import fnmatch

for file in os.listdir("""/Users/Desktop/TESTME"""):
    if fnmatch.fnmatch(file,'MISC*'):
        os.rename(file, file[4:12] + '-13-Misc.jpg') 
```

当我尝试运行它时，我得到了这个：

```
Traceback (most recent call last):
  File "/Users/Documents/Try.py", line 6, in <module>
    os.rename(file, file[4:12] + '-13-Misc.jpg')
OSError: [Errno 2] No such file or directory 
```

我也试过这个：

```
if fnmatch.fnmatch(file,'MISC*'):
    fun = file[4:12] + '-13-Misc.jpg'
    os.rename(file, fun) 
```

但我得到同样的东西。

它没有将文件识别为文件。我会以错误的方式解决这个问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-02T12:53:25.803

您需要包含要重命名的文件名的*完整路径：*

```
import os
import fnmatch

directory = "/Users/Desktop/TESTME"
for file in os.listdir(directory):
    if fnmatch.fnmatch(file, 'MISC*'):
        path = os.path.join(directory, file)
        target = os.path.join(directory, file[4:12] + '-13-Misc.jpg'
        os.rename(path, target) 
```

该[`os.path.join`功能](http://docs.python.org/library/os.path.html#os.path.join)使用适合您平台的正确目录分隔符智能地将路径元素连接成一个整体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T12:53:15.443

该函数`os.listdir()`只返回给定目录中文件的文件名，而不是它们的完整路径。您可以使用它`os.path.join(directory, file_name)`来重建文件的完整路径。

您也可以在 bash 中执行此操作：

```
cd /Users/Desktop/TESTME/
for f in MISC*; do mv "$f" "${f:4:8}-13-Misc.jpg"; done 
```

# jquery - 在 jQuery 中通过查询变量中的字符串创建两个警报

> ID：11294039
> 
> 赞同：1
> 
> 时间：2012-07-02T12:50:28.597
> 
> 标签：jquery

我有以下字符串作为变量：

```
var name1 = '001-C6AL7_deepgreen_C3AE7_tankhakinavy_FJAG7_blackredmulti_FBAE7_tanbrown.jpg'; 
```

这是由我无法编辑的服务器端配置提供的。使用 jQuery 有一种方法可以在唯一字符（连字符“-”）之前和之后创建所有字符的警报。

所以理想情况下，它会首先发出警报`001`，然后是第二个警报`C6AL7_deepgreen_C3AE7_tankhakinavy_FJAG7_blackredmulti_FBAE7_tanbrown.jpg`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T12:54:27.847

您可以使用`split()`vanilla JavaScript ( [MDN docu](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/split) ) 的命令 - 这里不需要 jQuery：

```
var name1 = '001-C6AL7_deepgreen_C3AE7_tankhakinavy_FJAG7_blackredmulti_FBAE7_tanbrown.jpg';

var parts = name1.split( '-' );

alert( parts[0] );
alert( parts[1] ); 
```

# javascript - jquery datatable如何从MVC解析和添加行

> ID：11294043
> 
> 赞同：0
> 
> 时间：2012-07-02T12:50:38.800
> 
> 标签：javascript, jquery, asp.net-mvc, datatables

好的，我有以下

```
function AddSpellRow() {
    var row = $('.tbl_spells').dataTable().fnGetData(0);
    $('.tbl_spells').dataTable().fnAddData(row);
} 
```

添加这一行

```
<tr class="odd">

   <td class="">    
     <input data-val="true" data-val-number="The field Id must be a number." data-val-required="The Id field is required." id="Spells_0__Id" name="Spells[0].Id" type="hidden" value="4"> 

     <select data-val="true" data-val-number="The field Id must be a number." data-val-required="The Id field is required." id="Spells_0__Spell_Id" name="Spells[0].Spell.Id" class="valid">
       <option value="">---Select --</option> 
       <option value="1">Rains</option> 
     </select>

   </td>

   <td class="">
    <input data-val="true" data-val-number="The field PriestLevel must be a number." data-val-required="The PriestLevel field is required." id="Spells_0__PriestLevel" name="Spells[0].PriestLevel" type="text" value="10" class="valid">
   </td>

</tr> 
```

如何使用 [#of rows] 和 underscorenumber of rowsunderscore 更改 [0] 和 underscore0underscore ？

我还需要 type="hidden" value="4" 和 type="hidden" value="0"

我尝试在行上替换，但它不喜欢它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T03:33:41.670

我不得不使用 fnAddData

```
 var otable = $('.tbl_spells').dataTable();
    var row = otable.fnGetData(0),
    row_count = otable.fnGetData().length;

    var addId = otable.fnAddData(row);
    var newRow = otable.fnSettings().aoData[addId[0]].nTr;

    var theNode =  $(newRow.cells[0])  ;
    $(theNode[0].children[0]).attr('id', 'Spells_' + row_count + '__Id');
    $(theNode[0].children[0]).attr('name', 'Spells[' + row_count + '].Id');
    $(theNode[0].children[0]).attr('value', 0 );

    $(theNode[0].children[1]).attr('id', 'Spells_' + row_count + '__Spell_Id');
    $(theNode[0].children[1]).attr('name', 'Spells[' + row_count + '].Spell.Id');

    theNode = $(newRow.cells[1]);
    $(theNode[0].children[0]).attr('id', 'Spells_' + row_count + '__PriestLevel');
    $(theNode[0].children[0]).attr('name', 'Spells[' + row_count + '].PriestLevel'); 
```

# swt - 凸起边框 SWT/JFace

> ID：11294044
> 
> 赞同：0
> 
> 时间：2012-07-02T12:50:39.080
> 
> 标签：swt, eclipse-rcp, jface

我似乎无法找到有关如何在 Eclipse RCP 中添加不同类型边框的在线帮助。我知道 Swing 有 BevelBorder，可以使用 BorderFactory 来实现。任何swt等价物？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T14:00:33.197

试试这个样式：SWT.SHADOW_IN、SWT.SHADOW_OUT、SWT.SHADOW_ETCHED_IN、SWT.SHADOW_ETCHED_OUT

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-12T04:36:21.260

请将此方法用于斜角边框

```
private void drawBorders(GC gc, int x, int y, int w, int h) {
    final Display disp = getDisplay();
    final Color topleft = disp.getSystemColor(SWT.COLOR_WIDGET_LIGHT_SHADOW);
    final Color bottomright = disp.getSystemColor(SWT.COLOR_WIDGET_NORMAL_SHADOW);
    if (topleft != null && bottomright != null) {
        gc.setLineWidth(1);
        gc.setForeground(bottomright);
        gc.drawLine(x + w, y, x + w, y + h);
        gc.drawLine(x, y + h, x + w, y + h);

        gc.setForeground(topleft);
        gc.drawLine(x, y, x + w - 1, y);
        gc.drawLine(x, y, x, y + h - 1);
    }
} 
```

# c# - 使用验证创建有效的日期时间对象

> ID：11294050
> 
> 赞同：1
> 
> 时间：2012-07-02T12:51:06.973
> 
> 标签：c#, .net, datetime

我正在使用以下代码创建日期

```
 try
 {
    newdatetime = new DateTime(2012, 2, 30);
    break;
 }
 catch (ArgumentOutOfRangeException)
 {
   // Try 29 Feb if not 28.
 } 
```

捕获块是捕获无效日期，例如 2 月 30 日。有没有办法通过指定（年、月、日）等参数来验证日期是否有效？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-02T12:55:49.640

好吧，几个月后您就知道有效范围，因此您可以手动限制它。年份显然不受通常意义上的限制，而是受到`DateTime`实际可以持有的数量（0001到9999）的限制。

对于天数，有一种`DaysInMonth(int year, int month)`方法可以告诉您所提供月份的最大天数。这也给了你闰年。

使用此信息，您可以创建自己的方法来根据提供的整数检查范围。

就像是：

```
public static bool AreValidDateValues(int year, int month, int day)
{
    if (month < 1 || month > 12)
        return false;

    if (year < DateTime.MinValue.Year || year > DateTime.MaxValue.Year)
        return false;

    var days = DateTime.DaysInMonth(year, month);

    if (day < 1 || day > days)
        return false;

    return true;
} 
```

或者，如果您对此不屑一顾，请将原始值转换为日期的字符串表示形式并将其放入 中`DateTime.TryParse`，这将为提供的字符串提供真/假 - 请注意文化敏感的解析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T12:57:21.260

您可以使用 DateTime.TryParse 执行检查：

```
DateTime d;
var isValid = DateTime.TryParse(String.Format("{0}/{1}/{2}", 2, 31, 2012), out d);
Console.WriteLine(isValid); 
```

# javascript - Youtube API 未在 Firefox 中加载

> ID：11294052
> 
> 赞同：1
> 
> 时间：2012-07-02T12:51:18.613
> 
> 标签：javascript, jquery, youtube, youtube-api

我有这个测试滑块[http://jsfiddle.net/dUyLY/2/](http://jsfiddle.net/dUyLY/2/)

在 Chrome 中它运行良好，但在 Firefox 和 safari 中，当动画完成时它会出错。在脚本文件中，我在每个动画之后检查当前可见元素是否是 youtube 播放器，如果是则播放视频。离开幻灯片时暂停它。

我在控制台中收到此错误`player.pauseVideo is not a function`

有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T13:00:03.760

您正在推迟`onYouTubePlayerAPIReady`. 因此，YouTube API 很可能在`onYouTubePlayerAPIReady`定义之前完成。在这种情况下，您的代码将失败。

要解决此问题，请检查 API 是否在运行时准备就绪。

```
window.onYouTubePlayerAPIReady = function () {
    player = new YT.Player('player', {
        height: '315',
        width: '560',
        videoId: 'bpOR_HuHRNs',
    });
};
if (window.YT) {
    // Apparently, the API was ready before this script was executed.
    // Manually invoke the function
    onYouTubePlayerAPIReady();
} 
```

笔记。对于简单的单向函数，比如`player.playVideo()`and `player.pauseVideo()`，我推荐使用这个简单的函数，它不像文档中的 YouTube API 那样臃肿。看到[这个答案](https://stackoverflow.com/a/7513356/938089?youtube-iframe-api-how-do-i-control-a-iframe-player-thats-already-in-the-html)。

这是您页面的更新部分，使用`callPlayer`我的其他答案中的函数而不是 YouTube API：http: [//jsfiddle.net/ryyCZ/](http://jsfiddle.net/ryyCZ/)

```
<div id="player">
  <iframe width="560" height="315" frameborder="0" src="http://www.youtube.com/embed/bpOR_HuHRNs?enablejsapi=1"></iframe>
</div>

if ($(".slides_control > div:visible #player").length == 1) {
    callPlayer("player","playVideo");
} else {
    callPlayer("player", "pauseVideo");
} 
```

# xcode - 在表格中显示 NSString

> ID：11294053
> 
> 赞同：0
> 
> 时间：2012-07-02T12:51:20.033
> 
> 标签：xcode, nsstring, uilabel

我有一些 NSString 对象要显示在标签中，您可以将其视为数据库表中的记录行。我想知道是否有办法使用 Xcode 以这种表格格式显示这些数据？（想象一下你在 html 中这样做，这将是直截了当的。Xcode 中是否有类似的功能或者有这样做的技巧？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T12:53:18.813

你看过[UITableView](http://www.google.ch/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CEsQFjAA&url=http://developer.apple.com/library/ios/documentation/uikit/reference/UITableView_Class/Reference/Reference.html&ei=s5nxT6uCF8Od-wbzraWvAw&usg=AFQjCNFHOOV6Ye5njrJI49tNeR80jfSTzQ&sig2=VlMeRE7sDGhC6vYAmJ73uQ)了吗？听起来这几乎就是您要寻找的东西。

# java - 当程序状态不断变化时不可变对象的用处

> ID：11294068
> 
> 赞同：1
> 
> 时间：2012-07-02T12:52:14.917
> 
> 标签：java, multithreading, immutability

我知道不可变对象总是具有相同的状态，即它们实际创建的状态。它们的不变量由构造函数建立，并且由于它们的状态在构造后不会改变，因此这些不变量始终保持良好状态，这就是为什么它们可以安全地在多线程环境中发布。这一切都很好，但是由于我们生活在一个动态的世界中，程序的状态不断变化，如果我们通过不可变的对象来构造程序的状态，这些对象会给我们带来什么好处呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:01:43.990

“这些物品给我们带来了什么好处”您已经回答了这个问题。

关于您问题的“动态”部分，如果您需要“更改”一个不可变对象，您可以从旧对象创建一个新对象：

```
Immutable oldObj = new Immutable(...);
Immutable newObj = new Immutable(oldObj.property1, "a new value for property 2"); 
```

如果您发现您一直重复这样做，那么您可能需要使对象可变，并添加能够在并发环境中使用该对象所需的相关踩踏安全功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T13:06:55.717

不可变对象允许您干净地将状态更改传达给不同的线程。

使用不可变对象来表示线程之间交换的消息是一种很好的做法。一旦这样的消息被发送，它的有效载荷就不能被改变，这可以防止许多与并发相关的错误。如果一个线程需要传达一些进一步的变化，它只会发送下一条消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:03:18.327

`Immutable objects`当您需要一些状态从不改变的静态对象时非常有用。最大的优势是不变性，对象语义和智能指针使对象所有权成为一个有争议的问题。隐含地，这也意味着存在并发时的确定性行为。

Java 已经定义了一些不可变类，例如`String` `Integer`.

另一个好处是它们总是具有“故障原子性”（Joshua Bloch 使用的一个术语）：如果不可变对象抛出异常，它永远不会处于不良或不确定状态。

假设你有一个像国家代码这样的静态对象的全局缓存，你可以在这里申请`Immutability`。

[为什么我们需要不可变类？](https://stackoverflow.com/questions/3769607/why-do-we-need-immutable-class)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T19:23:12.603

在这种情况下，使用 String 对象时，不可变对象非常有用：

```
public class A  {
    private volatile String  currentName = "The First Name";

    public String getCurrentName()  {
        // Fast:  no synching or blocking!  Can be called billions of times by
        // billions of threads with no trouble.
        // (Does need to be read from memory always because it's volatile.)
        return currentName;
    }
    public whatever someMethod()  {
        ... code ...
        // Simple assignment in this case.  Could involve synchronization
        // and lots of calculations, but it's called a lot less than
        // getCurrentName().
        currentName = newName;
        ... code ...
    }
}
public class B  {
        ... in some method ...
        A  objA = something;
        // Gets "name" fast despite a billion other threads doing the same thing.
        String  name = objA.getCurrentName();
        // From this point on, String referenced by "name" won't change
        // regardless of how many times A.currentName changes.
        ... code with frequent references to objA
} 
```

这允许必须保持一致（如果不是精确最新）的复杂数据（或者甚至是简单数据，这种情况下）被更新并以非常快速和线程安全的方式交付给任何需要它的人。交付的数据*可能*很快就会过时，但它*会*在调用方法期间保持其值并保持一致。

# c# - ObjectDataSource 无法将字符串解析为 DateTime

> ID：11294069
> 
> 赞同：3
> 
> 时间：2012-07-02T12:52:24.870
> 
> 标签：c#, asp.net, .net, objectdatasource, datetime-format

我有一个文本框，其值存储 ValidFrom 表单值：

```
31.01.2012 
```

和文化设置为：

```
<globalization culture="en-GB" uiCulture="en-GB"/> 
```

在 web.config 中。

现在，ObjectDataSource 更新方法：

```
 public static void UpdateLac(int id, DateTime ValidFrom)
    {
        /// ...
    } 
```

失败，因为我得到字符串无法解析的异常。但是**dd.mm.yyyy** ( **31.01.2012** ) 格式的日期是有效的 en-GB 格式并且可以解析（据我所知）。我已经使用以下代码对其进行了测试：

```
 DateTimeFormatInfo dtfi = CultureInfo.CreateSpecificCulture("en-GB").DateTimeFormat;
            var date = DateTime.Parse("31.01.2012", dtfi);
            Console.Write(date.ToLongDateString()); 
```

那么在这个例子中，为什么 ObjectDataSource 内部转换无法将**字符串**（31.01.2012）转换为**DateTime**呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T17:53:25.583

据我所知，文化信息是直接从操作系统加载的（在本例中为 windows），您可以检查您的区域设置以了解指定的格式。这是我电脑的截图：

[http://imageshack.us/photo/my-images/96/engbg.png/](http://imageshack.us/photo/my-images/96/engbg.png/)

如您所见，短日期的格式为：dd/MM/aa，因此您的服务器区域设置可能有问题，或者输入应为：31/ **01** /12 而不是 31.01.2012

希望这可以帮助。

# visual-studio - 禁用即时调试

> ID：11294071
> 
> 赞同：1
> 
> 时间：2012-07-02T12:52:30.297
> 
> 标签：visual-studio, ssms

我已经安装了 SQL Server 2012 的以下组件：

*   管理工具——完整

*   客户端工具连接

*   客户端工具 SDK

*   客户端工具向后兼容性

现在，每次浏览器出现错误时，“即时调试”都会运行。我想禁用它，但这里（通常）说我应该打开我的视觉工作室：

[http://msdn.microsoft.com/en-us/library/k8kf6y2a%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/k8kf6y2a%28v=vs.80%29.aspx)

我的问题是我从来没有安装过 Visual Studio，我的电脑里也没有（我没有找到）——只有一些 Visual Studio 的文件夹和其他文件，而不是 exe 文件，从哪里开始 id。

我正在使用 Windows 7。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-02T13:52:34.667

A quick search on Google revealed the answer.

> Open Start > Control Panels > Internet Options: Advanced
> 
> *   Disable Script Debugging (Internet Explorer)
> *   Disable Script Debugging (Other)

**Reference**

*   [Getting RID of Just-In-Time debugger](http://social.msdn.microsoft.com/Forums/en-US/vsdebug/thread/a52eb0ae-bcd8-4043-9661-d5fc3aa5167c/)

# php - curl_exec 在上传到 s3 时因错误 500 而死

> ID：11294073
> 
> 赞同：2
> 
> 时间：2012-07-02T12:52:33.743
> 
> 标签：php, post, curl

我正在使用 POST 请求将带有 curl (php) 的大文件上传到 amazon s3。
当文件很小（几个 MB）时 - 它可以工作。当文件为几百 MB 时 - 脚本在该`curl_exec`行出现错误 500（我完全知道，因为我在它之前和之后放置了日志记录）。

curl初始化看起来像

```
$postdata = array_merge( $headers_array , array('file' => '@' . $filename));           
$curl_handle = curl_init();         
curl_setopt( $curl_handle , CURLOPT_URL , $s3_url );
curl_setopt( $curl_handle , CURLOPT_RETURNTRANSFER , 1 ); 
curl_setopt( $curl_handle , CURLOPT_POST , TRUE );
curl_setopt( $curl_handle , CURLOPT_HEADER , FALSE );
curl_setopt ($curl_handle , CURLOPT_POSTFIELDS, $postdata);

$response = curl_exec( $curl_handle ); 
`500 here` 
```

我认为，问题是内存不足（或类似的东西）。我已要求我的托管服务提供商向我展示 error_log，但也许我现在可以做些什么。

十分感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:37:58.030

如果您自己的服务器因 500 错误而死（），您可能内存不足，请尝试以下步骤。

由于您无法查看错误日志，请确保从脚本文件中输出错误：

```
ini_set('display_errors', 1);
error_reporting(E_ALL); 
```

增加 php.ini 中的内存限制，或者最好不要在发送之前将整个文件加载到内存中（给 curl 一个文件指针，而不是整个文件内容）。

在这个优秀的 PHP S3 库中可以看到一个示例：

[Amazon S3 PHP 类](http://undesigned.org.za/2007/10/22/amazon-s3-php-class)

如果是亚马逊返回 500 错误，这将是确定原因的方法：

从[这里](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#5xx_Server_Error)开始：以数字“5”开头的响应状态代码表示服务器知道它遇到错误或无法执行请求的情况。除了响应 HEAD 请求时，**服务器应该包含一个包含错误情况解释的实体**，并指出它是暂时的还是永久的。

输出响应头和响应体以查找原因描述：

```
curl_setopt($curl_handle, CURLOPT_HEADER, 1);
$responseBody = curl_exec($curl_handle);
echo $responseBody;
print_r(curl_getinfo($curl_handle)); 
```

原因应该在某处提到。

# php - PHP 语句不适用于包含

> ID：11294076
> 
> 赞同：0
> 
> 时间：2012-07-02T12:52:38.940
> 
> 标签：php, if-statement

我在侧边栏上有一个 PHP 语句，侧边栏包含在所有页面上。在边栏中，我想在结果页面上隐藏内容，所以我使用这个：

```
<?php
if ($page!='results')
{?>
<h1>THE MAIN SIDEBAR CONTENT</h1>
<div>
SOME CONTENT          
</div>
<?php }  ?> 
```

问题是它看起来没有将页面识别为

```
$page='results'; 
```

在它的顶部。也许是因为代码在包含的页面中，但我认为它只会被读为一页？

如果我添加

```
$page='results'; 
```

在上述脚本的开头，它可以工作（只是为了验证我是否正确编写了代码。

我还检查了 results.php 有

```
$page='results'; 
```

就在它的最顶端。

我不能在包含上使用此代码还是我遗漏了什么？

根据 navnav 的要求，这里是包含和实际页面的代码。注意我实际上并没有使用'$results'，我只是用它作为我的帖子的一个例子。在下面的真实代码中，你会看到我正在使用 '$getvaluation'

**侧边栏代码....**

```
<div class="right_part right_home">
      <h1 style="padding-left: 25px">Property <span>Search</span></h1>

      <script type="text/javascript">
          $('#couHertfordshire').click(function(){
            var v = $(this).val();
            $('#couHertfordshire_hide').val(v);
          });
           $('#couLondonNorth').click(function(){
            var v = $(this).val();
            $('#couLondonNorth_hide').val(v);
          });
           $('#couLondonNorthWest').click(function(){
            var v = $(this).val();
            $('#couLondonNorthWest_hide').val(v);
          });
      </script>

      <?php
            $page = $_SERVER['REQUEST_URI'];
            $page = explode('/', $page);
        if (isset($_POST['bed']) && $_POST['bed'] != '' && $page[2] == 'test.php'){
            $url = 'http://www.vebra.com/home/quick/PFrefine.asp';
            $target = 'target="hello"';
            $js_submit = true;                  

            $bed = $_POST['bed'];
            $min = $_POST['lop'];
            $max = $_POST['hip'];
            $area1 = $_POST['cou1'];
            $area2 = $_POST['cou2'];
            $area3 = $_POST['cou3'];
            // Hidden Fields
            $hidden1 = $_POST['slo'];
            $hidden2 = $_POST['fid'];
            $hidden3 = $_POST['bid'];
            $hidden4 = $_POST['dbt'];
            $hidden5 = $_POST['nre'];
            $hidden6 = $_POST['thu'];
            $hidden7 = $_POST['vto'];
            $hidden8 = $_POST['ord'];
            $hidden9 = $_POST['nba'];

        } else {

            $url = 'test.php';
            $target = '';
            $js_submit = false;
        }           

      ?>

      <form method="post" action="<?php echo $url; ?>" name="searchform" id="searchform" <?php echo $target; ?> >
        <dl id="property_search">
          <dt class="bord">Bedrooms</dt>
          <dd><select name="bed" class="type1 Selectrooms">
                  <option <?php if($bed == '0'){ echo 'selected="selected"';} ?> value="0">0</option>
                  <option <?php if($bed == '1'){ echo 'selected="selected"';} ?> value="1">1</option>
                  <option <?php if($bed == '2'){ echo 'selected="selected"';} ?> value="2">2</option>
                  <option <?php if($bed == '3'){ echo 'selected="selected"';} ?> value="3">3</option>
                  <option <?php if($bed == '4'){ echo 'selected="selected"';} ?> value="4">4</option>
                  <option <?php if($bed == '5'){ echo 'selected="selected"';} ?> value="5">5+</option>
              </select>
          </dd>

          <dt class="bord">Minimum Price</dt>
          <dd><select class="type2 SelectPrices" name="lop">
                <option <?php if ($min == '0'){ echo 'selected="selected"';} ?> value="0">&#163;0</option>
                <option <?php if ($min == '25000'){ echo 'selected="selected"';} ?> value="25000">&#163;25,000</option>
                <option <?php if ($min == '50000'){ echo 'selected="selected"';} ?> value="50000">&#163;50,000</option>
                <option <?php if ($min == '75000'){ echo 'selected="selected"';} ?> value="75000">&#163;75,000</option>
                <option <?php if ($min == '100000'){ echo 'selected="selected"';} ?> value="100000">&#163;100,000</option>
                <option <?php if ($min == '125000'){ echo 'selected="selected"';} ?> value="125000">&#163;125,000</option>
                <option <?php if ($min == '150000'){ echo 'selected="selected"';} ?> value="150000">&#163;150,000</option>
                <option <?php if ($min == '175000'){ echo 'selected="selected"';} ?> value="175000">&#163;175,000</option>
                <option <?php if ($min == '200000'){ echo 'selected="selected"';} ?> value="200000">&#163;200,000</option>
                <option <?php if ($min == '225000'){ echo 'selected="selected"';} ?> value="225000">&#163;225,000</option>
                <option <?php if ($min == '250000'){ echo 'selected="selected"';} ?> value="250000">&#163;250,000</option>
                <option <?php if ($min == '275000'){ echo 'selected="selected"';} ?> value="275000">&#163;275,000</option>
                <option <?php if ($min == '300000'){ echo 'selected="selected"';} ?> value="300000">&#163;300,000</option>
                <option <?php if ($min == '325000'){ echo 'selected="selected"';} ?> value="325000">&#163;325,000</option>
                <option <?php if ($min == '350000'){ echo 'selected="selected"';} ?> value="350000">&#163;350,000</option>
                <option <?php if ($min == '375000'){ echo 'selected="selected"';} ?> value="375000">&#163;375,000</option>
                <option <?php if ($min == '400000'){ echo 'selected="selected"';} ?> value="400000">&#163;400,000</option>
                <option <?php if ($min == '500000'){ echo 'selected="selected"';} ?> value="500000">&#163;500,000</option>
                <option <?php if ($min == '600000'){ echo 'selected="selected"';} ?> value="600000">&#163;600,000</option>
                <option <?php if ($min == '700000'){ echo 'selected="selected"';} ?> value="700000">&#163;700,000</option>
                <option <?php if ($min == '800000'){ echo 'selected="selected"';} ?> value="800000">&#163;800,000</option>
                <option <?php if ($min == '900000'){ echo 'selected="selected"';} ?> value="900000">&#163;900,000</option>
                <option <?php if ($min == '1000000'){ echo 'selected="selected"';} ?> value="1000000">&#163;1,000,000</option>
                <option <?php if ($min == '2000000'){ echo 'selected="selected"';} ?> value="2000000">&#163;2,000,000</option>
                <option <?php if ($min == '3000000'){ echo 'selected="selected"';} ?> value="3000000">&#163;3,000,000</option>
                <option <?php if ($min == '4000000'){ echo 'selected="selected"';} ?> value="4000000">&#163;4,000,000</option>
                <option <?php if ($min == '5000000'){ echo 'selected="selected"';} ?> value="5000000">&#163;5,000,000</option>
                <option <?php if ($min == '6000000'){ echo 'selected="selected"';} ?> value="6000000">&#163;6,000,000</option>
              </select>
          </dd>

          <dt class="bord">Maximum Price</dt>
          <dd><select name="hip" class="type3 SelectPrices">
                <option <?php if ($max == '25000'){ echo 'selected="selected"';} ?> value="25000"> &#163;25,000</option>
                <option <?php if ($max == '50000'){ echo 'selected="selected"';} ?> value="50000">&#163;50,000</option>
                <option <?php if ($max == '75000'){ echo 'selected="selected"';} ?> value="75000">&#163;75,000</option>
                <option <?php if ($max == '100000'){ echo 'selected="selected"';} ?> value="100000">&#163;100,000</option>
                <option <?php if ($max == '125000'){ echo 'selected="selected"';} ?> value="125000">&#163;125,000</option>
                <option <?php if ($max == '150000'){ echo 'selected="selected"';} ?> value="150000">&#163;150,000</option>
                <option <?php if ($max == '175000'){ echo 'selected="selected"';} ?> value="175000">&#163;175,000</option>
                <option <?php if ($max == '200000'){ echo 'selected="selected"';} ?> value="200000">&#163;200,000</option>
                <option <?php if ($max == '225000'){ echo 'selected="selected"';} ?> value="225000">&#163;225,000</option>
                <option <?php if ($max == '250000'){ echo 'selected="selected"';} ?> value="250000">&#163;250,000</option>
                <option <?php if ($max == '275000'){ echo 'selected="selected"';} ?> value="275000">&#163;275,000</option>
                <option <?php if ($max == '300000'){ echo 'selected="selected"';} ?> value="300000">&#163;300,000</option>
                <option <?php if ($max == '325000'){ echo 'selected="selected"';} ?> value="325000">&#163;325,000</option>
                <option <?php if ($max == '350000'){ echo 'selected="selected"';} ?> value="350000">&#163;350,000</option>
                <option <?php if ($max == '375000'){ echo 'selected="selected"';} ?> value="375000">&#163;375,000</option>
                <option <?php if ($max == '400000'){ echo 'selected="selected"';} ?> value="400000">&#163;400,000</option>
                <option <?php if ($max == '500000'){ echo 'selected="selected"';} ?> value="500000">&#163;500,000</option>
                <option <?php if ($max == '600000'){ echo 'selected="selected"';} ?> value="600000">&#163;600,000</option>
                <option <?php if ($max == '700000'){ echo 'selected="selected"';} ?> value="700000">&#163;700,000</option>
                <option <?php if ($max == '800000'){ echo 'selected="selected"';} ?> value="800000">&#163;800,000</option>
                <option <?php if ($max == '900000'){ echo 'selected="selected"';} ?> value="900000">&#163;900,000</option>
                <option <?php if ($max == '1000000'){ echo 'selected="selected"';} ?> value="1000000">&#163;1,000,000</option>
                <option <?php if ($max == '2000000'){ echo 'selected="selected"';} ?> value="2000000">&#163;2,000,000</option>
                <option <?php if ($max == '3000000'){ echo 'selected="selected"';} ?> value="3000000">&#163;3,000,000</option>
                <option <?php if ($max == '4000000'){ echo 'selected="selected"';} ?> value="4000000">&#163;4,000,000</option>
                <option <?php if ($max == '5000000'){ echo 'selected="selected"';} ?> value="5000000">&#163;5,000,000</option>
                <option <?php if ($max == '6000000'){ echo 'selected="selected"';} ?> value="6000000">&#163;6,000,000+</option>
              </select>
          </dd>
          <dt>Regions</dt><dd><img src="images/spacer.gif" alt="" /></dd>

          <dt><input <?php if( $area1 == '43' ){ echo 'checked="checked"';} ?> type="checkbox" name="cou1" id="couHertfordshire" value="43" /></dt><dd>Hertfordshire</dd>
          <dt><input <?php if( $area2 == '126' ){ echo 'checked="checked"';} ?> type="checkbox" name="cou2" id="couLondonNorth" value="126" /></dt><dd>London, North</dd>
          <dt><input <?php if( $area3 == '127' ){ echo 'checked="checked"';} ?> type="checkbox" name="cou3" id="couLondonNorthWest" value="127" /></dt><dd>London, North West</dd>

            <input type="hidden" name="cou" id="couHertfordshire_hide" value="<?php if ( $area1 == '43' ) { echo '43';} ?>" />
            <input type="hidden" name="cou" id="couLondonNorth_hide" value="<?php if ( $area2 == '126' ) { echo '126';} ?>" />
            <input type="hidden" name="cou" id="couLondonNorthWest_hide" value="<?php if ( $area3 == '127' ) { echo '127';} ?>" />

            <input type="hidden" name="slo" value="undefined" />
            <input type="hidden" name="fid" value="894" />
            <input type="hidden" name="bid" value="0" />
            <input type="hidden" name="dbt" value="1" />
            <input type="hidden" name="nre" value="undefined" />
            <input type="hidden" name="thu" value="undefined" />
            <input type="hidden" name="vto" value="undefined" />
            <input type="hidden" name="ord" value="undefined"/>
            <input type="hidden" name="nba" value="undefined" />

          <dt><input type="submit" class="search_now" value="Find Property" /></dt><dd><img src="images/spacer.gif" alt="" /></dd>
        </dl>
      </form>

      <?php if($js_submit){ ?>

        <script type="text/javascript">
            $(document).ready(function() {
                document.forms["searchform"].submit();
            });
        </script>

        <?php } ?>

      <div><a href="register.php" class="register_with_us"><img src="images/spacer.gif" alt="" /></a></div>
      <div><a href="contact.php" class="our_branches"><img src="images/spacer.gif" alt="" /></a></div>
      <div><a href="valuation.php" class="free_valuation"><img src="images/spacer.gif" alt="" /></a></div>

        <?php
        if ($page!='getvaluation')
       { ?> 
       <h1 class='bot_line'>Featured <span>Property</span></h1>
      <div>
      <?php perch_content('Featured Property Image');?>           
      </div>
      <h3><?php perch_content('Featured Property Title'); ?></h3>
     <p>
     <?php perch_content('Featured Property Description'); ?>

     </p>      
     <?php }  ?>
    </div>
     <div>

  </div> 
```

**估值页面代码**

```
<?php 
$page='getvaluation'; 
include('perch/runtime.php'); ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1    /DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang='en' dir='ltr'>
<head>
<title>Squires Estates - Independent Estate Agent, London</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9" />
<meta name="description" content="" />
<meta name="keywords" content="" />
<link href="css/screen.css" rel="stylesheet" type="text/css" />

<!--[if IE]>
<![if lt IE 7]>
  <script type="text/javascript" src="js/DD_belatedPNG.js"></script>
  <script type="text/javascript" src="js/ie6.js"></script>
<![endif]>
<![endif]-->

<link rel="stylesheet" href="slider/themes/default/default.css" type="text/css" media="screen" />
<link rel="stylesheet" href="slider/nivo-slider.css" type="text/css" media="screen" />

<script type="text/javascript" src="slider/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="slider/jquery.nivo.slider.js"></script>
<script type="text/javascript">
$(window).load(function() {
    $('#slider').nivoSlider({
        controlNav: false,
        effect: 'fade', // Specify sets like: 'fold,fade,sliceDown'
    });
});
</script>

<script type="text/javascript">
 function blurInspection(el, text) {if (el.value == '') {el.value=text;}}
 function focusInspection(el, text) {if (el.value == text) {el.value='';}}
</script>

</head>

<body>

<div id="wrapper">

<?php include("header.php"); ?>

  <div id="content">
    <div class="left_part left_home">
      <h1 class="bot_line">Please use the form below to arrange a free valuation</span></h1>
      <?php 
      // Text Section
      //perch_content('form');?>
      <?php perch_content('Form Text');?>
    </div>
    <?php 
    include('sidebar.php');
    include('footer.php');
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T12:59:03.100

在进行比较之前，请确保包含分配`result`给的文件`$page`。

所以，

这是不好的：

```
<?php
if ($page!='results')
{?>
<h1>THE MAIN SIDEBAR CONTENT</h1>
<div>
SOME CONTENT          
</div>
<?php }  
include("the-file-here-that-defines-$page");//The include line is AFTER the comparing here...which means the $page value will not be changed until after the comparing...
?> 
```

这很好：

```
<?php
include("the-file-here-that-defines-$page");//the include line is BEFORE the comparing, so $page will change before, and it should all work well..
if ($page!='results')
{?>
<h1>THE MAIN SIDEBAR CONTENT</h1>
<div>
SOME CONTENT          
</div>
<?php }  

?> 
```

编辑：

我查看了您的编辑，我最初的建议是导致问题的原因。在你的`sidebar.php`你有`$page = explode('/', $page);`它在你做**之后**`$page='getvaluation';`执行，但是你也在做你的比较`sidebar.php`，你也在其中重新定义`$page`。

对此的快速解决方法是简单地使用另一个变量来表示“getvaluation”：

所以，在你的 sidebar.php 中：

```
if($getValuation===true){$page='getvaluation';}//check if $getValuation is true (which will will be defined in your valuation page)
        if ($page!='getvaluation')
       { ?> 
       <h1 class='bot_line'>Featured <span>Property</span></h1>
      <div>
      <?php perch_content('Featured Property Image');?>           
      </div>
      <h3><?php perch_content('Featured Property Title'); ?></h3>
     <p>
     <?php perch_content('Featured Property Description'); ?>

     </p>      
     <?php }  ?>
    </div>
     <div> 
```

现在，在您的估值页面中：

代替：

```
<?php 
$page='getvaluation'; 
```

做这个：

```
<?php 
$getValuation=true; 
```

在其他页面（您希望侧边栏显示的页面）上，不要定义`$getValuation`或分配它`false`：

# python - 为什么 os.umask() 的论点是倒置的？（umask 0o000 使 chmod 0o777）

> ID：11294077
> 
> 赞同：12
> 
> 时间：2012-07-02T12:52:38.693
> 
> 标签：python, unix, filesystems, chmod, umask

在大多数地方，权限被定义为 . 格式的八进制数`0777`。但是UNIX的`umask`命令（因此`os.umask()`）需要`0o000`产生我理解的`0o777`和`0o022`等于的权限位。`0o755`

我听说 UNIX`umask`出于某种原因被倒置，我不明白其背后的原因。有人可以解释这种不一致吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-02T13:05:57.473

没有真正的不一致，因为 和 之间的关系`umask`可以`chmod`纯粹用方程式写下来。显然，`umask`与 的相反`chmod`，它在过去是这样创建的。

示例：（`022`默认通常`umask`）创建`755`. 它是这样工作的：

*   `7 - 0 = 7`成为第一个字节
*   `7 - 2 = 5`成为第二个和第三个字节

使用此示例，`umask 777`创建一个文件，其中`chmod 000`,`umask 112`将等于`chmod 664`。据我所知，发生这种情况是因为`umask`最初创建该命令是为了指示文件在创建后将**不**具有哪些权限位（因此反转）。

虽然它可能很烦人，但要习惯它真的不难。想想你如何处理你`chmod`的文件，然后从中减去你想要的字节`7`，你就会得到这个`umask`值。或者，当您在 IDE 中编写代码时，不要使用`umask`，而是创建文件（`umask`当然使用默认值），然后在 Python 中使用`os.chmod()`。

# php - PHP imap 函数不在 shell 中工作，但在控制器/浏览器中工作。(CakePHP 2.x)

> ID：11294078
> 
> 赞同：0
> 
> 时间：2012-07-02T12:52:42.483
> 
> 标签：php, cakephp, imap

初步资料：

1.  CakePHP 2.x
2.  Ubuntu 在本地主机上使用 XAMPP

作为 Web 应用程序的一部分，我制作了一个脚本，用于检查电子邮件收件箱中的新消息。当有新消息时，脚本会将电子邮件正文写入数据库。所有这些代码都位于控制器中。我的脚本运行良好，完全没有问题！

**我决定改为在shell**中使用完全相同的代码，这样我就可以设置一个 cron 作业来执行此任务，而不必通过 Web 浏览器访问该页面。将代码移植到 shell 脚本后，当我运行 shell 时出现错误：

```
PHP Fatal error:  Call to undefined function imap_open()in /path/to/file.php on line 25. 
```

当然，显而易见的问题是“您的 php 配置中是否加载了 imap 函数？” 对，他们是。 **我很困惑为什么在通过浏览器访问控制器代码时使用 imap 函数没有问题，但是在使用 shell 时出现错误。**

有什么想法吗？

提前致谢。

蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:30:25.367

我猜你的命令行 php 不是用 imap 支持构建的，或者没有为 cli php 启用模块，请参阅[http://ubuntuforums.org/showthread.php?t=977596](http://ubuntuforums.org/showthread.php?t=977596)。所以检查或编译带有 imap 支持的 cli 或获取一个内置 imap 支持的包。

# c# - 将数字分成大小相等的组

> ID：11294083
> 
> 赞同：7
> 
> 时间：2012-07-02T12:53:11.310
> 
> 标签：c#, math

使用这个例子：

```
var amount = x;
var maxPerGroup = y;
var amountGroups = Ceiling(amount/maxPerGroup); 
```

有人可以帮助我如何将 Amount 拆分为 AmountGroups，每组 maxAmount 的最大数量是多少？这些组的大小必须几乎相同。

例如：金额 = 45；maxPerGroup = 15; 数量组 = 3;

结果：15 15 15

我使用 C# 作为语言。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:00:50.580

```
number of groups := ceiling(total / max group size)
number per group := floor(total / number of groups)
rem = total % number per group 
```

您将拥有带有 的`rem`组和带有`number per group + 1`的`number of groups - rem`组`number per group`。

编辑：示例：

```
total := 50
max group size := 15
number of groups := ceiling(50 / 15) // 4
number per group := floor(50 / 4) // 12
rem := 50 % 12 // 2 
```

2 组 13 组和 2 组 12 组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T13:15:34.707

有很多方法可以在组之间分配金额。这完全取决于唯一的因素是组数还是其他因素。看：

```
 static void Main(string[] args)
    {
        List<int> list1 = Split1(48, 15); // result is: 15, 15, 15, 3
        List<int> list2 = Split2(48, 15); // result is 12, 12, 12, 12
    }

    public static List<int> Split1 (int amount, int maxPerGroup)
    {
        int amountGroups = amount / maxPerGroup;

        if (amountGroups * maxPerGroup < amount)
        {
            amountGroups++;
        }

        List<int> result = new List<int>();
        for (int i = 0; i < amountGroups; i++)
        {
            result.Add(Math.Min(maxPerGroup, amount));
            amount -= Math.Min(maxPerGroup, amount);
        }
        return result;
    }

    public static List<int> Split2 (int amount, int maxPerGroup)
    {
        int amountGroups = amount / maxPerGroup;

        if (amountGroups * maxPerGroup < amount)
        {
            amountGroups++;
        }

        int groupsLeft = amountGroups;
        List<int> result = new List<int>();
        while (amount > 0)
        {
            int nextGroupValue = amount / groupsLeft;
            if (nextGroupValue * groupsLeft < amount)
            {
                nextGroupValue++;
            }
            result.Add(nextGroupValue);
            groupsLeft--;
            amount -= nextGroupValue;
        }
        return result;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T13:03:52.067

简单的非优化解决方案：

```
int i = amount;
int j = 0;
int [] groups = new  int[amountGroups];
while(i > 0) {
   groups[j] += 1;
   i--;
   j = (j+1)%amountGroups;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T13:26:15.987

**注意** 不是精确的 c# 只是为了给你一个想法。

我认为您正在寻找一种在语法上将数字划分为不同组的方法。在不知道这些组有多大和随机数量的组的情况下。

所以假设 x = 30 y = 15\. 30/15 = 3 组 15 并且假设 x= 43 那么数字应该是这样的？14 14 15

```
groups (since you already have this calculated correctly)(should be a double)
//   maxPerGroup = y
membersPerGroup = floor(amount/groups)

List a = new List
//Is the leftover value of the modulus
leftover = amount%groups;
//Loops for each group
for(int i=0;i<groups;i++){

//If there is a left over value
if(leftover>0){
  a.Add(membersPerGroup +1);
  leftover--;
}else{
  a.Add(membersPerGroup );
}

} 
```

**我可以用正确的 c# 编写，但您似乎找到了正确的代码**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-06-14T21:25:14.957

```
private static int[] DistributeIntoGroups(int sum, int groupsCount)
{
    var baseCount = sum / groupsCount;
    var leftover = sum % groupsCount;
    var groups = new int[groupsCount];

    for (var i = 0; i < groupsCount; i++)
    {
        groups[i] = baseCount;
        if (leftover > 0)
        {
            groups[i]++;
            leftover--;
        }
    }

    return groups;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-19T10:28:55.773

```
 // For separating a collection into ranges
    static List<List<T>> Split<T>(List<T> source, int size)
    {
        // TODO: Prepopulate with the right capacity
        List<List<T>> ret = new List<List<T>>();
        for (int i = 0; i < source.Count; i += size)
        {
            ret.Add(source.GetRange(i, Math.Min(size, source.Count - i)));
        }
        return ret;
    }

    // For separating an int into a Tuple range
    static List<Tuple<int, int>> Split(int source, int size)
    {
        var ret = new List<Tuple<int, int>>();
        for (int i = 0; i < source; i += size)
        {
            ret.Add(new Tuple<int, int>(i, (i + Math.Min(size, source - i))));
        }
        return ret;
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-30T00:03:38.877

```
private void button2_Click(object sender, EventArgs e)
    {
        // I wanted to get count from a datagridview (x)
        // and then split into groups based on the 
        // count from a combobox (n). In my example my
        // grid had 1771 rows and was split into: 25 groups
        // (4x of 70 and 21x of 71)

        // Driver code
        int x = myDataGridView.Rows.Count; //1771  
        int n = assemblies_cmbbox.Items.Count; //25

        split(x, n);
        //split(amount, maxPerGroup);
    }

    // Function that prints
    // the required sequence
    private void split(int x, int n)
    {

        // If we cannot split the
        // number into exactly 'N' parts
        if (x < n)
            Debug.WriteLine("-1 ");
        // If x % n == 0 then the minimum
        // difference is 0 and all
        // numbers are x / n
        else if (x % n == 0)
        {
            for (int i = 0; i < n; i++)
                Debug.WriteLine((x / n) + " ");

        }
        else
        {
            // upto n-(x % n) the values
            // will be x / n
            // after that the values
            // will be x / n + 1
            int zp = n - (x % n);
            int pp = x / n;
            for (int i = 0; i < n; i++)
            {

                if (i >= zp)
                    Debug.WriteLine((pp + 1) + " ");
                else
                    Debug.WriteLine(pp + " ");
            }
        }
    } 
```

全部归功于萨钦。

访问[https://www.geeksforgeeks.org/split-the-number-into-n-parts-such-that-difference-between-the-smallest-and-the-largest-part-is-minimum/](https://www.geeksforgeeks.org/split-the-number-into-n-parts-such-that-difference-between-the-smallest-and-the-largest-part-is-minimum/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-17T10:12:18.657

> 将一个整数分成几组

```
public class Program
    {
        static void Main(string[] args)
        {
            List<int> results = DistributeInteger(20, 3).ToList();//output: 7,7,6
            foreach (var result in results)
            {
                Console.WriteLine(result);
            }
            Console.Read();
        }

        public static IEnumerable<int> DistributeInteger(int total, int divider)
        {
            if (divider == 0)
                yield return 0;

            int rest = total % divider;
            double result = total / (double)divider;

            for (int i = 0; i < divider; i++)
            {
                if (rest-- > 0)
                    yield return (int)Math.Ceiling(result);
                else
                    yield return (int)Math.Floor(result);
            }

        }
    } 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2012-07-02T13:14:46.890

```
int amount = x;
int maxPerGroup = y;
int amountGroups = new int[Ceiling(amount/maxPerGroup)];
for(int i=0; i<maxPerGroup; i++)
{
    if(x>maxPerGroup)
    {
        amountGroups[i]= maxPerGroup;
        x = x-maxPerGroup;
    }
    else
    {
        amountGroups[i] = x;
        x =0;
    }
} 
```

# c# - 如何使 rtf 文件和 tiff 文件格式在 c# win 表单的 webbrowser 控件中内联查看？

> ID：11294084
> 
> 赞同：0
> 
> 时间：2012-07-02T12:53:12.847
> 
> 标签：c#, winforms, c#-4.0

如何使 rtf 文件和 tiff 文件格式在 c# win 表单的 webbrowser 控件中内联查看？

每当我将导航路径作为文件的位置时，它适用于 JPG、PDF 但对于 tiff 和 docx 和 rtf 会出现一个新对话框，要求用户保存它或使用 word 查看它。我希望通过 webbrowser 控件内联查看这些文件。

请问有人吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:03:24.740

Web 浏览器无法原生显示 TIFF 和 Office 文档。您*可以*将文件上传到某些服务，例如 Google 文档、Office live 或某些能够将文档呈现为 HTML 的第三方网络服务。

另一种选择是将 TIFF 转换为 JPEG 或 PNG 文件，使用`img`标签构建 HTML 并将其显示在您的网络浏览器控件中。对于 Word 文档，您可以自动化 Word 以将文件另存为 HTML，然后将其显示在 webbrowser 控件中。

# php - 如何加载这个类（静态/非静态方法）？

> ID：11294086
> 
> 赞同：0
> 
> 时间：2012-07-02T12:53:18.517
> 
> 标签：php, oop, class, static, constructor

一开始我有 3 个 PHP 文件来处理 3 个不同的 AJAX 查询。

我决定创建一个独特的 PHP 类，在其中获取 $_POST 参数，然后调用 3 个函数中的 1 个。

我有另一个仅用于数据库查询的 PHP 类（base.php）。我将这个文件包含在用于获取 AJAX 查询 (ajax.php) 的类和我的 index.php 文件中。

首先，我写了这样的东西（ajax.php）：

```
<?php
    new Ajax();

    class Ajax
    {
        private $base;

        public function __construct()
        {
            include("base.php");
            $this->base = new Base();

            $script = $_POST["script"];

            $reference = $_POST["reference"];

            if($script == "correct" || $script == "insert") {
                $ptGauche = json_decode($_POST["repGauche"]);
                $ptDroite = json_decode($_POST["repDroite"]);
            }
            if($script == "insert") {
                $txtGauche = json_decode($_POST["motGauche"]);
                $txtDroite = json_decode($_POST["motDroite"]);
            }

            switch($script)
            {
                case "correct":
                    $this->correct($reference, $ptGauche, $ptDroite);
                    break;
                case "insert":
                    $this->insert($reference, $ptGauche, $ptDroite, $txtGauche, $txtDroite);
                    break;
                case "delete":
                    $this->delete($reference);
                    break;
            }
        }

        private function correct($reference, $ptGauche, $ptDroite)
        {
            // code
            $query_result = $this->base->selectAllQuery($reference);
        }

        private function insert($reference, $ptGauche, $ptDroite, $txtGauche, $txtDroite)
        {
            //code
            $this->base->insertQuery($reference, $txtGauche, $txtDroite, $new_ptGauche, $new_ptDroite);
        }

        private function delete($reference)
        {
            //code
            $this->base->deleteQuery($reference);
        }
    }
?> 
```

显然，这样做`new Ajax();`并且不将类实例保存在变量中并不是一个好主意，`$ajax = new Ajax();` [例如没有变量的类实例](https://stackoverflow.com/questions/6119251/class-instance-without-variable) 有人说将具有副作用的代码放在类构造函数中是不标准的`__construct`，也许我应该使用静态方法而不是使用构造函数创建对象并做类似的事情`Ajax::functionToLoad();`。

这对我的脚本不起作用，因为我使用的是包含在这个脚本中的非静态类，所以我的属性`private $base;`应该是非静态的，并且不可能进行数据库查询，因为“静态函数无法访问非静态类”静态属性”：/ [http://www.programmerinterview.com/index.php/c-cplusplus/can-static-function-access-non-static-members-of-class/](http://www.programmerinterview.com/index.php/c-cplusplus/can-static-function-access-non-static-members-of-class/)

所以，我使用的是非静态方法，而不是使用构造函数，我这样做：

```
$ajax = new Ajax();
$ajax->loader();

class Ajax
{
    private $base;

    public function loader()
    {
        // code
    }

    // correct(), insert() and delete() functions
} 
```

可以这样做还是我应该以其他方式进行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:00:11.390

如果 __construct 不存在，公共函数 Ajax().... 是默认构造函数。所以使用 Ajax 而不是 loader 或者创建一个函数 Ajax 来执行 $this->loader();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:00:14.970

你正在寻找的是一个单例

```
 <?php
class Ajax
{
    private static $inst = new Ajax();

    private $base;

    public static function getInstance(){
         return $inst;
    }

    public function __construct()
    {
        include("base.php");
        $this->base = new Base();

        $script = $_POST["script"];

        $reference = $_POST["reference"];

        if($script == "correct" || $script == "insert") {
            $ptGauche = json_decode($_POST["repGauche"]);
            $ptDroite = json_decode($_POST["repDroite"]);
        }
        if($script == "insert") {
            $txtGauche = json_decode($_POST["motGauche"]);
            $txtDroite = json_decode($_POST["motDroite"]);
        }

        switch($script)
        {
            case "correct":
                $this->correct($reference, $ptGauche, $ptDroite);
                break;
            case "insert":
                $this->insert($reference, $ptGauche, $ptDroite, $txtGauche, $txtDroite);
                break;
            case "delete":
                $this->delete($reference);
                break;
        }
    }

    private function correct($reference, $ptGauche, $ptDroite)
    {
        // code
        $query_result = $this->base->selectAllQuery($reference);
    }

    private function insert($reference, $ptGauche, $ptDroite, $txtGauche, $txtDroite)
    {
        //code
        $this->base->insertQuery($reference, $txtGauche, $txtDroite, $new_ptGauche, $new_ptDroite);
    }

    private function delete($reference)
    {
        //code
        $this->base->deleteQuery($reference);
    }
}
?> 
```

您现在应该可以按如下方式访问实例

```
 <?php
      $defaultInst = Ajax::getInstance();
 ?> 
```

# php - PHP PDO mySQL 返回 null

> ID：11294088
> 
> 赞同：0
> 
> 时间：2012-07-02T12:53:19.720
> 
> 标签：php, pdo

以下代码返回给我类似电话号码的人。它工作得很好，但是当没有数字时，该函数仍然返回信息，这意味着如果没有其他人具有相似数字，我无法选中隐藏某个框。

功能

```
function getothers($tid,$criteria,$telephone,$telephone2,$elector){
            global $dbh;
            $tid = '-TID'.$tid;
             $sql = "SELECT * FROM electors WHERE ((telephone > 0 AND telephone IN ('$telephone','$telephone2'))  OR (telephone2 > 0 AND telephone2 IN ('$telephone','$telephone2'))) $criteria AND records NOT RLIKE '$tid' AND ID != '$elector'  LIMIT 10";
            $result = $dbh->query($sql);
            return $result;
        } 
```

召唤

```
<?php $others = getothers($post['TID'],$post['criteria'],$elector['telephone'],$elector['telephone2'],$elector['ID']); ?> 
```

行不通的线路

```
<?php if(!$others){?> 
```

`$others`尽管没有结果，但仍然有一些东西。我想我可能在 y PDO 中遗漏了一行。有任何想法吗？

print_r

```
PDOStatement Object ( [queryString] => SELECT * FROM electors WHERE ((telephone > 0 AND telephone IN ('02085414023 ','')) OR (telephone2 > 0 AND telephone2 IN ('02085414023 ',''))) AND (this_vi_street = '' AND this_vi_telephone = '') AND (mosaic IN ('A01','A02','A03','A04','A05','A07','B11','C15','C16','C17','C18','H46','J52','K57','K58','K60') OR last_vi IN ('C','P')) AND postal_vote != 1 AND records NOT RLIKE '-TID1' AND ID != '13' LIMIT 10 ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:31:54.473

根据评论，使用准备好的语句的版本：

```
function getothers($tid, $criteria, $telephone, $telephone2, $elector) {
    global $dbh;

    $stmt = $dbh->prepare("SELECT *
                             FROM electors
                            WHERE ((telephone > 0 AND telephone IN (:telephone, :telephone2))
                                   OR (telephone2 > 0 AND telephone2 IN (:telephone, :telephone2)))
                                  $criteria
                                  AND records NOT RLIKE :tid
                                  AND ID != :elector
                            LIMIT 10";

    $stmt->execute(array(
        ':telephone'  => $telephone,
        ':telephone2' => $telephone2,
        ':tid'        => '-TID' . $tid,
        ':elector'    => $elector
    ));

    return $stmt->fetchAll();
} 
```

这段代码还是有一些不好的地方：

*   用于`global`获取数据库连接，这是整体糟糕的应用程序结构。您可能应该使用一个类或`$dbh`作为常规参数传递给函数。
*   连接`$criteria`到准备好的语句中。您真的需要这样的动态条件，以至于如果不将整个 SQL 块连接到其中就无法为其准备查询？
*   不一定解决您的函数返回的实际问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:02:36.287

也许做类似的事情

```
$result = $dbh->query($sql);
if($result->rowCount()>0)
{
return $result;
}

return false; 
```

# android - 在android中读取原始音频并提取SMPTE时间码

> ID：11294089
> 
> 赞同：1
> 
> 时间：2012-07-02T12:53:24.197
> 
> 标签：android, audio, input, stream

我正在尝试从 android 的音频输入流中提取 SMPTE 时间码（[维基百科）。](http://en.wikipedia.org/wiki/Linear_timecode)

正如这里提到的[https://stackoverflow.com/a/2099226](https://stackoverflow.com/a/2099226)第一步是扫描输入流字节序列中的 0011111111111101 以进行同步。但是如何使用 AudioRecord 类来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T16:56:55.867

这个答案真的不正确。您获得的音频信号是调制载波，从中提取 SMPTE 位是一个多步骤过程：您通过麦克风或音频输入的原始数据不会对应于 SMPTE 时间码。因此，您需要对音频进行解码，这并不简单。

第一步是从[双相标记代码](http://en.wikipedia.org/wiki/Biphase_mark_code "双相标记码")转换您的音频信号。我自己还没有实现 SMPTE 阅读器，但你知道 SMPTE 标准的时钟频率，所以我要做的第一件事就是仔细过滤以去除背景噪音，因为听起来你是从麦克风。一个温和的高通可以消除任何直流偏移，一个温和的低通高频噪声也应该有帮助。（您可以改为使用宽带通）

然后，您需要找到每个时钟周期的开始。你可以做一些花哨的事情，比如自相关或 PLL 算法，但我怀疑从 SMPTE 标准中了解近似时钟速率并能够上下调整几个百分点就足够了——也许更好。因此，只需根据规范寻找重复的过渡。如果您怀疑您的时间码高度扭曲，那么做一些花哨的事情会有所帮助（如果您有一个非常旧的磁带卡座或者您想以非常高/低的速度同步，可能就是这种情况，但 LTC 并不是真正为此而设计的。那是更多 VTC 的域名。）。

一旦你确定了时钟，你需要确定，对于每个时钟节拍，信号中的转换是否发生在时钟周期的开始。每个时钟滴答在中间都会有一个转换，但开始处的转换表示一个 0 位。这就是 BMC 在单个流中传输时钟和数据的方式。这允许您创建实际 SMPTE 数据的新流。

现在您已将 BMC 解码为 SMPTE 流。下一步是查找同步代码。查看 Wikipedia 上的规范以及我对 SMPTE 的记忆，我会断言仅找到单个同步代码是不够的，这可能是 80 位块中其他地方的偶然或巧合。相反，您必须以正确的间隔连续找到几个。然后，您可以将数据读入 80 位 SMPTE 块，并且在读取时，您必须继续验证同步码。如果您没有在预期的位置看到它，请从头开始搜索。

最后，一旦你解码了，你将不得不想出一些“飞轮”的方法，因为你几乎肯定不会一直正确读取所有数据（没有校验和！）。这就是野兽的本性。

# python - 在python中计算值

> ID：11294092
> 
> 赞同：0
> 
> 时间：2012-07-02T12:53:39.733
> 
> 标签：python

如何计算python中字典中值的出现次数

```
a = dict()
a['cat'] =      1
a['fish'] =     1
a['dog'] =      2  
a['bat'] =      3
a['aardvark'] = 3
a['lion'] =    4  
a['wallaby'] =  5
a['badger'] =   5 
```

预期输出：

```
KEY  Count
 1   2
 2   1
 3   2
 4   1
 5   2 
```

`EDIT`

抱歉，我是说计数值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T12:58:41.480

我怀疑你想使用[collections.Counter](http://docs.python.org/library/collections.html#counter-objects)；它让您轻松处理大多数计数用例。

```
from collections import Counter
a = dict()
a['cat'] =      1
a['fish'] =     1
a['dog'] =      2  
a['bat'] =      3
a['aardvark'] = 3
a['lion'] =    4  
a['wallaby'] =  5
a['badger'] =   5

print Counter(a.values()) 
```

输出：`Counter({1: 2, 3: 2, 5: 2, 2: 1, 4: 1})`

或者，为您稍微格式化一下：

```
for key, value in Counter(a.values()).most_common():
    print key, value 
```

输出：

```
1 2
3 2
5 2
2 1
4 1 
```

*或者，要完全*匹配您的输出：

```
for key, value in sorted(Counter(a.values()).items()):
    print key, value 
```

在这里，我们对键（数字 1 到 5）进行了排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T12:58:53.163

```
>>> from collections import Counter
>>> Counter(a.values())
Counter({1: 2, 3: 2, 5: 2, 2: 1, 4: 1}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T13:05:40.420

collections.Counter 是这项工作的最佳工具（参见 Martijn Pieters 的回答）——但是，它是在 python 2.7 中引入的。如果您需要 2.5+ 解决方案：

```
from collections import defaultdict
d=defaultdict(int)
for v in a.values():
    d[v]+=1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T12:59:10.227

如果您想要这些值的总和，请执行以下操作：

```
sum(a.values()) 
```

如果您想要出现次数的频率，请执行以下操作：

```
from collections import Counter
Counter(a.values()).items() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-02T13:01:41.733

我有一种可怕的感觉，虽然不清楚，但这`len(a)`可能是一个答案......

但是，也有可能：

```
from collections import Counter
Counter(a.values()) 
```

也有可能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-02T13:27:49.887

你可以很容易地做到这一点，而无需导入任何东西：

```
results={}
for v in a.values():
   results[v]=results.get(v, 0) + 1

for k,v in results.items():
    print k,v 
```

输出：

```
1 2
2 1
3 2
4 1
5 2 
```

# android - 如何在 Moodle 中列出所有包含未读消息的论坛的所有未读帖子？

> ID：11294093
> 
> 赞同：0
> 
> 时间：2012-07-02T12:53:46.870
> 
> 标签：android, screen-scraping, web-scraping, moodle

我正在为 Moodle 的特定实例开发一个 Android 应用程序。我只有学生级别的访问权限，所以我不能修改任何 Moodle 文件。我需要在应用程序上显示未读帖子。我可以去每门课程的论坛并检查未读消息，但这会非常昂贵，因为我正在屏幕上从网站上抓取数据。

如何显示我注册的所有模块中的所有未读帖子，这样我只需要解析一个网页即可获得我需要的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T10:58:14.677

如果您有评分并想要标记它们，您可以使用[AJAX 标记块](http://moodle.org/plugins/view.php?plugin=block_ajax_marking)。如果没有，您可以调整其中的代码以显示所有论坛，即使未标记（编辑 modules/forum/block_ajax_marking_forum.class.php 中的 query_factory()）并删除对所有其他类型的支持（删除模块中的其他文件夹）。

我会尝试创建一个分支来执行此操作，但我现在正在努力将其升级到 2.3，因此可能需要一段时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T17:32:56.257

如果您只有学生级别的访问权限，那么您的选择非常有限。据推测，该站点未设置为通过 RSS 发布论坛帖子。您唯一真正的机会是如果您可以订阅所有相关论坛，那么您可以从您的消息页面（或电子邮件，再次取决于网站的设置方式）获取所有帖子。

Moodle 论坛不是真正实时的（默认情况下，在发布通知发出之前是一个 30 分钟的“编辑窗口”），所以如果您只是很少进行轮询，那么屏幕抓取每个论坛页面应该不会太糟糕。

同样，如果您是学生级别，这无关紧要，但对于其他人来说，现在官方的[非官方 Moodle 移动应用程序](http://docs.moodle.org/22/en/umm%3a_Unofficial_Moodle_Mobile_app)可能很有趣。

# objective-c - OpenGL透明纹理（混合）

> ID：11294094
> 
> 赞同：0
> 
> 时间：2012-07-02T12:53:48.753
> 
> 标签：objective-c, xcode, cocoa, opengl

我需要使我的纹理之一透明。我该怎么做？

处理我的纹理的所有代码都是：

```
 glBindTexture(GL_TEXTURE_2D, textureName);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, width, height, 0, GL_RGBA, GL_UNSIGNED_BYTE, textureImg); 
```

我必须更改/添加什么以使纹理完全透明（全阿尔法）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:30:40.763

提供的代码只是设置纹理。您还需要启用混合使用

```
 glEnable(GL_BLEND); 
```

并设置适当的[混合功能](http://www.opengl.org/archives/resources/faq/technical/transparency.htm)。

# android - 从安卓平板电脑访问 USB Pendrive

> ID：11294097
> 
> 赞同：1
> 
> 时间：2012-07-02T12:53:54.523
> 
> 标签：android, usb

我们的安卓平板电脑（版本 4.0.3）中有一个 USB 端口。

1.  我们如何找出连接在该端口上的任何 PenDrive。
2.  我们如何通过在android中以编程方式访问连接在该端口上的USB Pendrive中的文件。

我们有一个`/mnt`包含的文件夹

`asec` `extsd` `obb` `sdcard` `secure` `usbhost1`

1.  如何以编程方式识别哪一个是`Internal Memory Path`和。`External SD Card Path``USB Path`

2.  使用此文件夹的目的是什么`asec`，`obb`以及`secure`。

提前致谢。

问候巴拉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T12:58:31.617

我想使用你需要使用的外部 sdcard：

```
new File("/mnt/external_sd/") 
```

或者

```
new File("/mnt/extSdCard/") 
```

或者

```
new File("/mnt/usb_storage") 
```

代替 Environment.getExternalStorageDirectory()

为我工作。您应该首先检查目录 mnt 中的内容，然后从那里开始工作。

您应该使用某种类型的选择方法来选择要使用的 sdcard：

```
File storageDir = new File("/mnt/");
if(storageDir.isDirectory()){
    String[] dirList = storageDir.list();
    //TODO some type of selecton method?
} 
```

“笔式驱动器”位于 /mnt/ （就像 4.0> 中的所有其他存储设备一样）

对于某些设备可能会有所不同，因为运行 4.0.3 USB 存储的 Acer Iconia A500 在`/mnt/usb_storage/`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:00:12.343

> 我们如何找出连接在该端口上的任何 PenDrive。

在 Android SDK 中没有记录和支持的方法可以做到这一点。您需要与您的设备制造商交谈，并获得他们关于如何为他们的特定设备执行此操作的建议。

> 我们如何通过在android中以编程方式访问连接在该端口上的USB Pendrive中的文件。

往上看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-13T10:57:46.050

****使用它，您可以在 USB 中找到路径并评估文件****

```
public String getStoragepath() {

        try {

            Runtime runtime = Runtime.getRuntime();
            Process proc = runtime.exec("mount");
            InputStream is = proc.getInputStream();
            InputStreamReader isr = new InputStreamReader(is);
            String line;
            String[] patharray = new String[10];
            int i = 0;
            int available = 0;

            BufferedReader br = new BufferedReader(isr);
            while ((line = br.readLine()) != null) {
                String mount = new String();
                if (line.contains("secure"))
                    continue;
                if (line.contains("asec"))
                    continue;

                if (line.contains("fat")) {// TF card
                    String columns[] = line.split(" ");
                    if (columns != null && columns.length > 1) {
                        mount = mount.concat(columns[1] + "/requiredfiles");

                        patharray[i] = mount;
                        i++;

                        // check directory is exist or not
                        File dir = new File(mount);
                        if (dir.exists() && dir.isDirectory()) {
                            // do something here

//                          t1.show();
                            available = 1;
                            finalpath = mount;
                            break;
                        } else {

                        }
                    }
                }
            }
            if (available == 1) {

            } else if (available == 0) {

                finalpath = patharray[0];

            }

        } catch (Exception e) {
        }
        return finalpath;
    } 
```

# google-chrome-extension - 预加载页面消息内容脚本的背景失败

> ID：11294100
> 
> 赞同：2
> 
> 时间：2012-07-02T12:54:02.197
> 
> 标签：google-chrome-extension

Chrome 扩展程序中发生了一些奇怪的事情。

内容脚本：

```
console.log('content');

chrome.extension.onRequest.addListener(function(request, sender, sendResponse){
    console.log('request received');
    sendResponse();
});

chrome.extension.sendRequest( JSON.stringify({'msg': 'page_loaded'}) ); 
```

它只是监听扩展消息并在页面加载时将消息发送到后台。

后台脚本：

```
console.log('bg');

chrome.extension.onRequest.addListener(function(request, sender, sendResponse){
    sendResponse();
    chrome.tabs.sendRequest(
        sender.tab.id,
        JSON.stringify({'msg': 'page_loaded_bg_receive'}),
        function(){
            console.log('sendRequest page_loaded_bg_receive callback');
        });
}); 
```

它侦听消息并将消息发送到发件人选项卡。

它似乎正在工作，至少在大多数情况下页面日志中出现“收到请求”。

虽然输入 Chrome 的 url 有时会在用户点击“输入”之前加载输入的地址。这是一个奇怪的行为：页面加载，内容脚本运行，将消息发送到后台，但是当后台发送消息时 - 它失败并显示后台日志消息：

> 端口错误：无法建立连接。接收端不存在。miscellaneous_bindings:184 chromeHidden.Port.dispatchOnDisconnect miscellaneous_bindings:184

这是 Chrome 错误吗？如何将消息发送到预加载选项卡？

这是重现此类行为的人工最小样本。我需要在处理消息后多次调用“chrome.tabs.sendRequest”，因此调用“sendResponse”不是解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T10:35:35.570

基于文章[https://developers.google.com/chrome/whitepapers/pagevisibility](https://developers.google.com/chrome/whitepapers/pagevisibility)的解决方案。如果 document.webkitVisibilityState 不是“隐藏”或“预渲染”，我运行内容脚本代码，在其他地方我监听“webkitvisibilitychange”并等待 document.webkitVisibilityState 不是“隐藏”或“预渲染”。我认为检查“prerender”就足够了，但是当我打开一个新的空选项卡时，它会加载带有 document.webkitVisibilityState='hidden' 的页面，并且该页面也没有收到背景消息。

```
function isDocumentReady() {
  return document.webkitVisibilityState != "hidden" && document.webkitVisibilityState != "prerender";
}

if (isDocumentReady())
  main();
else {

  function onVisibilityChange() {
    if (!isDocumentReady())
      return;
    document.removeEventListener(
      "webkitvisibilitychange",
      onVisibilityChange,
      false);
    main();
  }

  document.addEventListener(
    "webkitvisibilitychange",
    onVisibilityChange,
    false);

} 
```

# windows - Windows 7：从批处理文件中以编程方式设置“复制设置”

> ID：11294102
> 
> 赞同：0
> 
> 时间：2012-07-02T12:54:03.477
> 
> 标签：windows, batch-file, copy, settings, regional

我正在构建一个批处理文件，它将为所有用户自动配置 Windows 7 的区域设置。

到目前为止，我已经成功地（大部分）为当前用户设置了所有区域设置，但我需要能够将相同的设置应用于所有新用户。您可以通过 GUI 执行此操作，方法是进入`Region and Language > Administrative > Copy Settings`并选中两个复选框。不过，我想以编程方式执行此操作。有谁知道我可以设置的注册表项或可以做到这一点的东西？

如果做不到这一点，我会选择一种以编程方式打开`Region and Language > Administrative > Copy Settings`窗口的方法。我已经能够使用 成功打开`Region and Language > Administrative`窗口`start rundll32.exe shell32.dll,Control_RunDLL intl.cpl,,3`，但如果可能的话，我想从该过程中再删除一个步骤。

**更新**

抱歉，我似乎忘记提及我是如何应用这些设置的。我通过执行`.reg`包含最佳设置的导出文件来执行此操作`regedit.exe /s "regional.reg"`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:07:49.530

您现在如何应用设置？通过注册表？

如果您将设置置于`HKEY_USERS\.DEFAULT`而不是（或附加于）之下`HKEY_CURRENT_USER`，则应在配置文件创建期间使用它们。

# java - 如何获得由整数的一些数字组成的最大数字

> ID：11294104
> 
> 赞同：0
> 
> 时间：2012-07-02T12:54:05.863
> 
> 标签：java, algorithm

我有一个号码。这个数字有很多位数。我想编写一个函数，它返回由该数字的一些数字组成的最大数字。在获得最大数字时，数字的顺序不应该改变。

```
int myFunction(int n, int cat){
   ...
   return max;   
} 
```

if`n = 38462637`和`cat = 3`函数必须返回`86637`，即如果`cat = 3`函数期望返回 5 位数字，如`8 - 3 = 5`。原始数字有许多 5 位数字的变体，但可能的最大数字是`86637`. 在这种情况下，最重要的要求是数字不应该改变它们的位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:14:20.963

贪婪 - 选择答案中最左边的最大数字（如果该数字出现在多个位置，请选择其最左边的出现）。如果一个数字不是 0，那么它可能在最左边，并且我们在它的右边至少有 n - cat - 1 个数字。

之后，使用相同的算法在该数字的位置右侧创建最大的数字，该数字恰好具有`n - cat - 1`数字。继续迭代，直到你的号码组成。请注意，您在第一次迭代后选择的数字可能为零（因为它们将不再位于结果数字的最左边）

编辑：使用上述算法的最佳解决方案 - 使用[范围最小查询](http://en.wikipedia.org/wiki/Range_Minimum_Query)来计算每个连续数字位置可能的最大值。理论上，这可以在每次查询的恒定时间和使用线性预计算的线性额外内存中完成，但该算法非常复杂且难以实现，它只会为您提供非常大的 n 值的改进。我个人建议使用会导致 O(n*log(n)) 时间复杂度的[分段树方法。](http://en.wikipedia.org/wiki/Segment_tree)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:24:11.110

这可能有点过于复杂，但它似乎工作：

```
public static int myFunction(int n, int cat) {
    String numString = String.valueOf(n);
    int finalLength = numString.length() - cat;
    int[] positions = new int[finalLength];
    StringBuilder answer = new StringBuilder();
    for (int i = 0; i < finalLength; i++) {
        for (int j = (i == 0 ? i : positions[i - 1] + 1); j <= numString.length() - finalLength + i; j++) {
            if (positions[i] == 0 || numString.charAt(j) > numString.charAt(positions[i]) ) {
                positions[i] = j;
            }
        }
        answer.append(numString.charAt(positions[i]));
    }
    return Integer.parseInt(answer.toString());
} 
```

**[编辑]**：没有`String`废话的更干净的版本：

```
public static int myFunction(int n, int cat) {
    List<Integer> digits = new ArrayList<Integer>();
    int number = n;
    while (number > 0) {
        digits.add(number % 10);
        number /= 10;
    }
    int finalLength = digits.size() - cat;
    int lastIndex = digits.size();
    int answer = 0;
    for (int i = 0; i < finalLength; i++) {
        int highestDigit = -1;
        for (int j = lastIndex - 1; j >= finalLength - i - 1; j--) {
            if (digits.get(j) > highestDigit) {
                highestDigit = digits.get(j);
                lastIndex = j;
            }
        }
        answer = answer * 10 + highestDigit;
    }
    return answer;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:07:56.800

如果您可以访问代码，请将数字存储为带有分隔符（空格、逗号等）的字符串，然后使用字符串分隔符函数将每个数字（字符串字符）放入它自己的数组位置。解析字符串数组并制作一个整数数组。然后对数组进行快速排序。完成后，取前 X 个整数，这就是你的数字。

# sql-server - 多维数据集是否使用 SQL Server 分析服务器之外的资源？

> ID：11294106
> 
> 赞同：2
> 
> 时间：2012-07-02T12:54:13.523
> 
> 标签：sql-server, ssas, cube

我有一个已构建的多维数据集，其中包含跨多个服务器的数据。多维数据集部署到 SSAS 服务器后，它是否与包含多维数据集所基于的初始数据的 SQL 服务器交互？我问的原因是因为我可能有很多用户，并且一些数据位于我们的生产服务器之一上，我们不想在查询多维数据集期间访问这些服务器。

谢谢，伊桑

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T16:32:47.230

典型的 SSAS 多维数据集将所有可用数据（根据您拉入 DSV 的表/视图）复制到它自己的位置，您可以通过转到 SSAS 服务器选项中定义的存储路径并查看文件夹来验证这一点尺寸。当您查询多维数据集时，它将使用此“复制的数据”。

话虽如此，但也有例外：

如果您有 ROLAP 维度，它可以通过基础数据：

[http://technet.microsoft.com/en-us/library/ms174915.aspx](http://technet.microsoft.com/en-us/library/ms174915.aspx)

如果您的多维数据集设置为主动缓存，那么它可以查询底层数据库本身以保持最新：

[http://msdn.microsoft.com/en-us/library/ms174769.aspx](http://msdn.microsoft.com/en-us/library/ms174769.aspx)

这是我熟悉的仅有的两个。

请记住，部署通常需要事后处理，除非您从在其他地方处理过的备份进行恢复。还要记住，在某些时候，您可能希望将新数据添加到多维数据集中，您说这些数据来自您不想中断的生产数据库。

# javascript - 如何通过 AJAX 发送“&”（与号）字符？

> ID：11294107
> 
> 赞同：97
> 
> 时间：2012-07-02T12:54:21.060
> 
> 标签：javascript, ajax, string, post, xmlhttprequest

我想用`POST`JavaScript 的方法发送一些变量和一个字符串。

我从数据库中获取字符串，然后将其发送到 PHP 页面。我正在使用一个`XMLHttpRequest`对象。

问题是字符串`&`多次包含该字符，而`$_POST`PHP 中的数组将其视为多个键。

我尝试用函数替换with `&`，但它似乎没有做任何事情。`\&``replace()`

任何人都可以帮忙吗？

**javascript 代码和字符串如下所示：**

```
var wysiwyg = dijit.byId("wysiwyg").get("value");
var wysiwyg_clean = wysiwyg.replace('&','\&');

var poststr = "act=save";

poststr+="&titlu="+frm.value.titlu;
poststr+="&sectiune="+frm.value.sectiune;
poststr+="&wysiwyg="+wysiwyg_clean;
poststr+="&id_text="+frm.value.id_text;

xmlhttp.open("POST","lista_ajax.php",true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send(poststr); 
```

**字符串是：**

```
 <span class="style2">&quot;Busola&quot;</span> 
```

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2012-07-02T12:58:29.233

您可以使用[encodeURIComponent()](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURIComponent)。

它将转义 URL 中不能逐字出现的所有字符：

```
var wysiwyg_clean = encodeURIComponent(wysiwyg); 
```

在此示例中，& 字符`&`将替换为转义序列`%26`，这在 URL 中有效。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-02T12:58:02.497

您可能想使用[encodeURIComponent()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent)。

```
encodeURIComponent("&quot;Busola&quot;"); // => %26quot%3BBusola%26quot%3B 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-02T12:58:18.000

您需要对 & 符号进行 url 转义。采用：

```
var wysiwyg_clean = wysiwyg.replace('&', '%26'); 
```

正如 Wolfram 所指出的，encodeURIComponent 很好地处理了这一点（连同所有其他特殊字符）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-02T13:08:14.907

Ramil Amr 的答案仅适用于 & 字符。如果你有一些其他的特殊字符，你应该使用 PHP`htmlspecialchars()` **和**JS 的`encodeURIComponent()`.

你可以写：

```
var wysiwyg_clean = encodeURIComponent(wysiwyg); 
```

在服务器端：

```
htmlspecialchars($_POST['wysiwyg']); 
```

这将确保 AJAX 将按预期传递数据，并且 PHP（以防您将数据插入数据库）将确保数据按预期工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-08-10T15:17:40.623

您可以使用此 encodeURIComponent 函数传递参数，因此您不必担心传递任何特殊字符。

```
data: "param1=getAccNos&param2="+encodeURIComponent('Dolce & Gabbana') 
```

或者

```
var someValue = 'Dolce & Gabbana';
data: "param1=getAccNos&param2="+encodeURIComponent(someValue) 
```

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-02T12:59:01.850

您可以在 JavaScript 端使用 Base64 编码对字符串进行编码，然后在服务器端使用 PHP (?) 对其进行解码。

JavaScript ([文档](https://developer.mozilla.org/en/DOM/window.btoa))

```
var wysiwyg_clean = window.btoa( wysiwyg ); 
```

PHP（[文档](http://php.net/manual/de/function.base64-decode.php)）：

```
var wysiwyg = base64_decode( $_POST['wysiwyg'] ); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-02T13:08:55.580

首选方法是使用 jQuery 等 JavaScript 库并将数据选项设置为对象，然后让 jQuery 进行编码，如下所示：

```
$.ajax({
  type: "POST",
  url: "/link.json",
  data: { value: poststr },
  error: function(){ alert('some error occured'); }
}); 
```

如果您不能使用 jQuery（这几乎是当今的标准），请使用[encodeURIComponent](https://developer.mozilla.org/En/Core_javascript_1.5_reference%3aglobal_functions%3aencodeuricomponent)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-01T09:37:27.517

```
encodeURIComponent(Your text here); 
```

这将截断特殊字符。

# string - 从另一个字符串中提取所需的子字符串 -Perl

> ID：11294116
> 
> 赞同：4
> 
> 时间：2012-07-02T12:54:43.243
> 
> 标签：string, perl, split, grep

我想从 Perl 中的一行中提取一个子字符串。让我举例说明：

```
fhjgfghjk3456mm   735373653736
icasd 666666666666
111111111111 
```

在以上几行中，我只想提取 12 位数字。我尝试使用`split`功能：

```
my @cc = split(/[0-9]{12}/,$line);
print @cc; 
```

但它所做的是删除字符串的匹配部分并将残差存储在`@cc`. 我希望打印与图案匹配的部分。我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-02T12:59:04.840

您可以使用[正则表达式](http://perldoc.perl.org/perlre.html)来做到这一点：

```
#!/usr/bin/perl
my $string = 'fhjgfghjk3456mm 735373653736 icasd 666666666666 111111111111';
while ($string =~ m/\b(\d{12})\b/g) {
  say $1;
} 
```

在此处测试正则表达式：[http ://rubular.com/r/Puupx0zR9w](http://rubular.com/r/Puupx0zR9w)

```
use YAPE::Regex::Explain;
print YAPE::Regex::Explain->new(qr/\b(\d+)\b/)->explain();

The regular expression:

(?-imsx:\b(\d+)\b)

matches as follows:

NODE                     EXPLANATION
----------------------------------------------------------------------
(?-imsx:                 group, but do not capture (case-sensitive)
                         (with ^ and $ matching normally) (with . not
                         matching \n) (matching whitespace and #
                         normally):
----------------------------------------------------------------------
  \b                       the boundary between a word char (\w) and
                           something that is not a word char
----------------------------------------------------------------------
  (                        group and capture to \1:
----------------------------------------------------------------------
    \d+                      digits (0-9) (1 or more times (matching
                             the most amount possible))
----------------------------------------------------------------------
  )                        end of \1
----------------------------------------------------------------------
  \b                       the boundary between a word char (\w) and
                           something that is not a word char
----------------------------------------------------------------------
)                        end of grouping
---------------------------------------------------------------------- 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T12:58:13.260

```
#!/bin/perl
my $var = 'fhjgfghjk3456mm 735373653736 icasd 666666666666 111111111111';
if($var =~ m/(\d{12})/) {
  print "Twelve digits: $1.";
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-02T13:04:01.013

$1 内置变量存储来自正则表达式的最后一个匹配项。此外，如果您对整个字符串执行正则表达式，它将返回整个字符串。最好的解决方案是在匹配项周围加上括号，然后打印 $1。

```
my $strn = "fhjgfghjk3456mm 735373653736\nicasd\n666666666666 111111111111";
$strn =~ m/([0-9]{12})/;
print $1; 
```

这使得我们的正则表达式只匹配 12 位数字，然后我们返回匹配的 $1。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T14:18:40.757

```
#!/usr/bin/env perl

undef $/;
$text = <DATA>;
@res = $text =~ /\b\d{12}\b/g;
print "@res\n";

__DATA__
fhjgfghjk3456mm   735373653736
icasd 666666666666
111111111111 
```

# vba - 使excel文件使用带有vba的全局工作簿功能？

> ID：11294123
> 
> 赞同：1
> 
> 时间：2012-07-02T12:55:06.773
> 
> 标签：vba, excel

我是 vba 新手，我无法理解 vba 中用于 excel 文件的工作簿。我有一个叫做 Addin.xla 的宏，这个宏被 2000 个文件使用。

我遇到的问题是 2000 个文件有自己的那`thisworkbook`声明函数`Workbook_BeforeClose`。所有 2000 个文件都具有完全相同的`Workbook_BeforeClose`.

我想要做的是更改`Workbook_BeforeClose`所有 2000 个文件中的功能。我可以让文件使用`Workbook_BeforeClose`Addin.xla 文件中的函数，还是必须`Workbook_BeforeClose`为所有 2000 个文件更改相同的函数？

如果是后者，有人可以告诉我如何编写一个循环遍历所有文件并自动更新此功能的宏吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:00:32.573

在插件中，处理`Application.WorkbookBeforeClose`事件。

但是，如果您已经在 2000 个文件中有相同的代码，则无论如何您都必须将其删除。否则，它将在您将在插件中定义的处理程序之外运行。

要自动删除：

添加对的引用`Microsoft Visual Basic for Applications Extensibility X.X.`

然后循环打开每个文件并执行

```
With currentWorkBook.VBProject.VBComponents("ThisWorkbook").CodeModule
  .DeleteLines .ProcStartLine("Workbook_BeforeClose", vbext_pk_Proc), .ProcCountLines("Workbook_BeforeClose", vbext_pk_Proc)
End With 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T13:08:12.430

一种解决方案是将函数委托给插件：

```
Private Sub Workbook_BeforeClose(Cancel As Boolean)
    runCleanupCode
End Sub 
```

`runCleanupCode`位于您的插件中的位置。这意味着如果您将来想要进行更改，您只需要在插件中进行更改。

要更改所有工作表中的代码，您可以按照[此示例](https://stackoverflow.com/questions/846894/how-to-add-delete-lines-of-code-to-a-thisworkbook-of-excel-file-using-vb-net)进行操作。

# php - 什么是获取相关内容的好方法

> ID：11294126
> 
> 赞同：-2
> 
> 时间：2012-07-02T12:55:20.247
> 
> 标签：php, mysql

在 php.ini 中获取相关内容的好方法是什么？我有 $keyword，如果我在 where title LIKE '%$keyword%' 中使用它返回相同。我的方法很简单，例如：

```
$keywords = 'Most Perfectly Timed Videos EVER';
$rel = mysql_query("select * from media where title LIKE '%$keywords%'")or
die(mysql_error()); 
```

我希望最大结果与我的关键字相关。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:06:31.877

```
$query = "SELECT * FROM media WHERE ";
$keywords = 'Most Perfectly Timed Videos EVER';
$keywords = explode(" ", $keywords);
$where = "";
foreach($keywords as $k => $v)
{
    $where .= "title LIKE '%".$v."%' AND ";
}
$where = substr($where, 0, -5); //deleting the last "AND"

$query .= $where;
$rel = mysql_query($query) or die(mysql_error()); 
```

或者，如果您可能想使用“OR”而不是“AND”以获得更好的结果：

```
foreach($keywords as $k => $v)
{
    $where .= "title LIKE '%".$v."%' OR ";
}
$where = substr($where, 0, -4); 
```

# windows - 用于按原样复制符号链接但不覆盖源（如果已存在）的批处理脚本

> ID：11294131
> 
> 赞同：1
> 
> 时间：2012-07-02T12:55:48.207
> 
> 标签：windows, batch-file, copy, robocopy

我尝试过 Fastcopy 和 Robocopy，两者似乎都可以执行其中任何一项操作，但不能同时执行。

对于（复制前）之类的文件

```
D:\SYMLINKSOURCE\file1 <<symlink from D:\Source\file1 **edit
D:\SYMLINKSOURCE\file2 <<symlink from D:\Source\file1 **edit

D:\DESTINATIONxx\file2 <<not a symlink 
```

我想复制`D:\SYMLINKSOURCE\*`到`D:\DESTINATIONxx`但不覆盖`D:\DESTINATIONxx\file1`，这样复制后它看起来像

```
(AFTER COPYING)
D:\SYMLINKSOURCE\file1 <<symlink from D:\Source\file1
D:\SYMLINKSOURCE\file2 <<symlink from D:\Source\file2

D:\DESTINATIONxx\file1 <<symlink from D:\Source\file1
D:\DESTINATIONxx\file2 <<not a symlink 
```

我试过这个不覆盖，但它不保留符号链接，而是复制解析的文件[复制文件而不覆盖](https://stackoverflow.com/questions/4228807/copy-files-w-o-overwrite)

```
robocopy "D:\SYMLINKSOURCE" "D:\DESTINATION" /E /XC /XN /XO

(AFTER COPYING)
D:\SYMLINKSOURCE\file1 <<symlink from D:\Source\file1
D:\SYMLINKSOURCE\file2 <<symlink from D:\Source\file2

D:\DESTINATIONxx\file1 <<not a symlink < i wanted this as symlink
D:\DESTINATIONxx\file2 <<not a symlink 
```

并添加 /SL 以保留符号链接会覆盖所有内容。

```
robocopy "D:\SYMLINKSOURCE" "D:\DESTINATION" /E /XC /XN /XO /SL

(AFTER COPYING)
D:\SYMLINKSOURCE\file1 <<symlink from D:\Source\file1
D:\SYMLINKSOURCE\file2 <<symlink from D:\Source\file2

D:\DESTINATIONxx\file1 <<symlink from D:\Source\file1
D:\DESTINATIONxx\file2 <<symlink from D:\Source\file1 < i did not want this overwritten 
```

有什么办法可以实现我想要的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T09:17:02.273

我能看到的唯一方法是使用两个单独的 robocopy，第一个用于非链接文件，然后用于要复制为链接的链接文件。假设普通文件多于链接，您可以运行：

```
robocopy "D:\SYMLINKSOURCE" "D:\DESTINATION" /E /XC /XN /XO 
```

然后通过单独命名（或使用一些命名约定，例如`sl-file1`和 usa`sl*`模式）复制实际链接，从而修复错误覆盖的链接：

```
robocopy "D:\SYMLINKSOURCE\file1" "D:\DESTINATION" /E /XC /XN /XO /SL 
```

# jquery - jQuery - 只需绑定一次事件

> ID：11294133
> 
> 赞同：1
> 
> 时间：2012-07-02T12:55:50.480
> 
> 标签：jquery

当触发来自不同元素的另一个事件时，我在将事件绑定到元素时遇到了很多麻烦。我的 HTML 是一个文本框，当添加一些文本时，它会创建一个带有提示的上下文菜单。由于此菜单是动态创建的表，我想将单击事件绑定到其元素。所以，这是我的代码：

```
$("#TextBox").on("keypress", function(e) {
    $("#Menu").find("td").on("click", function(event) {     
        event.stopPropagation();
        event.preventDefault(); 
        processText(event, $(this).children().text()); 
    });
    $(this).off(e);
}); 
```

但是，我不知道为什么，它不起作用。另外，我尝试创建一个变量并将其用作标志，但也不起作用。

如果我不解绑它，点击事件的触发次数与用户按下键的次数一样多。但我想解绑它，所以它只执行一次。

**编辑**：错误是我正在处理不正确的事件。我不得不处理“keyup”，因为在“keypress”中表格仍然不存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T13:03:10.333

如果您真的只希望事件触发一次，您可以使用 $.one() 进行绑定。

[http://api.jquery.com/one/](http://api.jquery.com/one/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T13:00:36.827

由于您已经在使用该`on`功能。使用 on 的替代版本（用于事件处理的委派）将事件处理程序绑定到动态添加的元素：

使用 on 函数如下：

```
$("#TextBox").on("keypress", function(e) {
    $(this).off("keypress");
});

$("#Menu").on("click", "td", function(event) {     
        event.stopPropagation();
        event.preventDefault(); 
        processText(event, $(this).children().text()); 
}); 
```

检查此链接以获取更多信息：[http ://api.jquery.com/on/#direct-and-delegated-events](http://api.jquery.com/on/#direct-and-delegated-events)

# c#-4.0 - 以编程方式将 ASPxGridView 添加到带有 ObjectDataSource 的页面

> ID：11294138
> 
> 赞同：2
> 
> 时间：2012-07-02T12:56:06.580
> 
> 标签：c#-4.0, entity-framework-4, devexpress, aspxgridview

我正在尝试添加`ASPxGridView`到页面并以`ObjectDataSource`编程方式将其绑定。

这是我的代码：

```
protected void Page_Init(object sender, EventArgs e)
    {
        ObjectDataSource odsGroup = new ObjectDataSource();
        var gridLookup = new ASPxGridView();

        odsGroup.ID = "odsGroups";
        odsGroup.SelectMethod = "GetAllElements";
        odsGroup.TypeName = "Ifa.BusinessLayer.BLLClasses.GroupBll";
        odsGroup.OldValuesParameterFormatString = "original_{0}";

        gridLookup.ViewStateMode = ViewStateMode.Disabled;

        gridLookup.ID = "groupsLookup";
        gridLookup.AutoGenerateColumns = true;
        gridLookup.DataSource = odsGroup;
        gridLookup.KeyFieldName = "Id";
        gridLookup.DataBind();
        pnl1.Controls.Add(gridLookup);
    } 
```

`GridView`当我使用而不是时，此代码工作正常`ASPxGridView`，但正如我所说，它不适用于`ASPxGridView`并抛出`System.Runtime.Serialization.SerializationException`

例外： ![在此处输入图像描述](../Images/812e728deda75b31926e52c8160980c5.png)

任何解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T16:04:09.977

此问题可能与 IIS 的安全设置和相应的权限有关。ASPxGridView 在必要时从其缓存中反序列化数据行。**通过将ASPxGridView.EnableRowsCache**属性设置为“ **False** ”来禁用 ASPxGridView 的缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T20:26:11.450

另一种解决方案：

```
 gridLookup.Columns.Add(new GridViewDataColumn("Name"));
  gridLookup.AutoGenerateColumns = false; 
```

# xcode - ipod 内存泄漏 - 使用仪器和 iPod 时 100% 泄漏

> ID：11294139
> 
> 赞同：0
> 
> 时间：2012-07-02T12:56:07.020
> 
> 标签：xcode, memory-leaks

```
 -(NSString*)readTextColumnWithIndex:(int)index {
    char* val = (char *)sqlite3_column_text(statement,index);
    if (val==NULL) {
        return nil;
    }
    return [NSString stringWithUTF8String:val];
} 
```

我在返回时 100% 泄漏 [NSString stringWithUTF8String:val];。不知道如何修复它们。我相信只有 alloc、retain 等可能会导致内存泄漏。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T14:10:27.077

`[NSString stringWithUTF8String:val]`是创建泄漏对象的语句 - 你需要看看它接下来会发生什么。

您是否保留了某处`NSString`返回的内容？`readTextColumnWithIndex:`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T03:59:10.533

```
-(NSDictionary*)loadDataRow:(SqlQuery*)q {

    return [NSDictionary dictionaryWithObjectsAndKeys:      [NSString stringWithFormat:@"%d",[q readIntColumn]],
        @"TOCID",[q readTextColumn],@"SubChapter_Name",[q readTextColumn],
        @"HtmlFileName",[q readTextColumn],@"ImageName",[q readTextColumn],
        @"RefsTitleSection",[NSString stringWithFormat:@"%d",
                             [q readIntColumn]],@"PageId",
        nil]; 
```

}

这就是它的名称。readIntColumn 依次调用 readTextColumnWithIndex 和 NSDictionary 返回给调用者方法

```
chap_Arr = nil;
while([query step]) {
    ChapName = [query readTextColumn];
     chap_Arr = [mData objectForKey:ChapName];
    if (!chap_Arr) {
        chap_Arr = [[[NSMutableArray alloc] init] autorelease];
        [mData setObject:chap_Arr forKey:ChapName];
    }

    [chap_Arr addObject:[self loadDataRow:query]];

} 
```

我不确定如何在循环中释放 chap_Arr。我在 dealloc 中有一个 RELEASE_SAFELY。

# spring - 在 jboss 7 服务器中加载属性文件和上传图像时出错

> ID：11294142
> 
> 赞同：0
> 
> 时间：2012-07-02T12:56:14.007
> 
> 标签：spring, jakarta-ee, jboss, jboss7.x

在 jeety 中，部署项目时 Glassfish 服务器然后在 webapp 中创建一个文件夹，但在 jboss 7 服务器中没有 webapp 文件夹。

jboss 7中的项目部署（文件夹名称）在哪里？

所以有一些问题，比如读取属性文件和图片上传。b'caz 我使用类路径和服务器路径。

对于 jboss 7 中的 ex：获取文件路径：“E:/jboss-as-7.1.1.Final/bin/content/mwp.war/WEB-INF/classes/analytics.properties”

```
Properties pro = new Properties();
String fileName = this.getClass().getClassLoader().getResource("analytics.properties").getFile();
pro.store(new FileOutputStream(fileName),null); 
```

然后得到错误：

```
16:21:52,004 ERROR [stderr] (MSC service thread 1-3)    at java.io.FileOutputStream.open(Native Method)
16:21:52,006 ERROR [stderr] (MSC service thread 1-3)    at java.io.FileOutputStream.<init>(FileOutputStream.java:212)
16:21:52,007 ERROR [stderr] (MSC service thread 1-3)    at java.io.FileOutputStream.<init>(FileOutputStream.java:104)
16:21:52,008 ERROR [stderr] (MSC service thread 1-3)    at mwp.slktechlabs.model.analytics.AnalyticsDBData.updateAnalyticsPropertiesData(AnalyticsDBData.ja
va:95)
16:21:52,010 ERROR [stderr] (MSC service thread 1-3)    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
16:21:52,011 ERROR [stderr] (MSC service thread 1-3)    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
16:21:52,013 ERROR [stderr] (MSC service thread 1-3)    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
16:21:52,015 ERROR [stderr] (MSC service thread 1-3)    at java.lang.reflect.Method.invoke(Method.java:601)
16:21:52,016 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleEle
ment.invoke(InitDestroyAnnotationBeanPostProcessor.java:340)
16:21:52,018 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMet
adata.invokeDestroyMethods(InitDestroyAnnotationBeanPostProcessor.java:305)
16:21:52,020 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessB
eforeDestruction(InitDestroyAnnotationBeanPostProcessor.java:148)
16:21:52,023 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.beans.factory.support.DisposableBeanAdapter.destroy(DisposableBeanAdapter.ja
va:166)
16:21:52,025 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.destroyBean(DefaultSingle
tonBeanRegistry.java:487)
16:21:52,027 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.destroySingleton(DefaultS
ingletonBeanRegistry.java:463)
16:21:52,029 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.destroySingletons(Default
SingletonBeanRegistry.java:431)
16:21:52,031 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.context.support.AbstractApplicationContext.destroyBeans(AbstractApplicationC
ontext.java:1053)
16:21:52,033 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContex
t.java:463)
16:21:52,035 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:294
)
16:21:52,036 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:215)
16:21:52,038 ERROR [stderr] (MSC service thread 1-3)    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.j
ava:47)
16:21:52,040 ERROR [stderr] (MSC service thread 1-3)    at org.apache.catalina.core.StandardContext.contextListenerStart(StandardContext.java:3392)
16:21:52,041 ERROR [stderr] (MSC service thread 1-3)    at org.apache.catalina.core.StandardContext.start(StandardContext.java:3850)
16:21:52,043 ERROR [stderr] (MSC service thread 1-3)    at org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentService.java:90)
16:21:52,045 ERROR [stderr] (MSC service thread 1-3)    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:18
11)
16:21:52,046 ERROR [stderr] (MSC service thread 1-3)    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
16:21:52,048 ERROR [stderr] (MSC service thread 1-3)    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
16:21:52,050 ERROR [stderr] (MSC service thread 1-3)    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
16:21:52,051 ERROR [stderr] (MSC service thread 1-3)    at java.lang.Thread.run(Thread.java:722) 
```

那么如何消除这个错误呢？

谢谢，卡姆莱什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T19:39:01.090

尝试这个：

```
Properties prop = new Properties();
InputStream is = this.getClass().getClassLoader().getResourceAsStream( "path" );
BufferedReader br = new BufferedReader(new InputStreamReader(is, "utf8"));
prop.load(br); 
```

例如在我的战争中，我有属性 ingo resources/config/myprop.properties，我的“路径”是 config/myprop.properties

如果您使用 hot deeploy（仅在独立模式下运行），jboss as 7 的部署文件夹很少你的项目

但是如果你使用mavej jboss插件并使用命令jboss-as:deploy所以jboss将你的项目部署到/usr/local/jboss7/standalone/data/content

# php - 如何在大括号内获取嵌套值

> ID：11294144
> 
> 赞同：3
> 
> 时间：2012-07-02T12:56:15.227
> 
> 标签：php, regex

如何使用 php 进入嵌套大括号？

例子：

```
{{ text1 {{text2 text3 {{text4}} text5}} }} 
```

应该输出

```
1- text1 {{text2 text3 {{text4}} text5}}
2- text2 text3 {{text4}} text5
3- text4 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T12:59:27.500

这需要跟踪括号的数量，并且不能使用正则表达式来完成。您必须为此创建自己的解析器逻辑。[正则表达式不是解析器](https://stackoverflow.com/questions/590747/using-regular-expressions-to-parse-html-why-not)，抱歉。

[这是另一个与我的回答相同的类似问题](https://stackoverflow.com/questions/10423970/parsing-a-string-with-nested-brackets)

[这是一个关于构建解析的 SO（在 Java 中，但它应该翻译得足够好）](https://stackoverflow.com/questions/7251781/java-method-for-parsing-nested-expressions)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T14:35:02.057

与 Perl 一样，PCRE 可以将嵌套结构匹配到任意深度（仅受内存限制 - 见下文）。这是一个经过测试的脚本：

## 正则表达式匹配嵌套括号

```
<?php // test.php Rev:20120702_1100

$re_nested_double_bracket ='% # Rev:20120702_1100
    # Match {{...{{...}}...}} structure with arbitrary nesting.
    \{\{                      # Opening literal double bracket.
    (                         # $1: Contents of double brackets.
      (?:                     # Group for contents alternatives.
        [^{}]++               # Either one or more non-brackets,
      | (?R)                  # or a nested bracket pair,
      | \{                    # or the start of opening bracket
        (?!\{)                # (if not a complete open bracket),
      | \}                    # or the start of closing bracket.
        (?!\})                # (if not a complete close bracket).
      )*                      # Zero or more contents alternatives.
    )                         # End $1: Contents of double brackets.
    \}\}                      # Closing literal double bracket.
    %x';

$results = array(); // Global array to receive results.

// Recursively called callback routine adds to $results array.
function _bracket_contents_callback($matches) {
    global $results, $re_nested_double_bracket;
    $results[] = $matches[1];
    preg_replace_callback($re_nested_double_bracket,
        '_bracket_contents_callback', $matches[1]);
    return $matches[0]; // Don't modify string.
}

$input = file_get_contents('testdata.txt');
preg_replace_callback($re_nested_double_bracket,
    '_bracket_contents_callback', $input);

$count = count($results);
printf("There were %d matches found.\n", $count);
for ($i = 0; $i < $count; ++$i) {
    printf("  Match[%d]: %s\n", $i + 1, $results[$i]);
}
?> 
```

当针对原始帖子中的测试数据运行时，正则表达式匹配的内容如下：

## 示例输出：

`There were 3 matches found.`
`Match[1]: text1 {{text2 text3 {{text4}} text5}}`
`Match[2]: text2 text3 {{text4}} text5`
`Match[3]: text4`

请注意，此正则表达式匹配*最外面*的一组可能嵌套的括号，并将`$1`括号之间的内容捕获到组中。该脚本利用该`preg_replace_callback()`函数递归匹配并将嵌套括号内容添加到结果数组。

**“任意深度”**请注意，此解决方案将嵌套括号匹配到任何“任意深度”，但始终受到系统内存、可执行堆栈大小和 PHP以及`pcre.backtrack_limit`配置变量的限制。请注意，如果主题字符串太大和/或对于给定的主机系统嵌套太深，则此正则表达式解决方案肯定会失败。PHP/PCRE 库甚至可能导致正在运行的可执行文件产生堆栈溢出、分段错误和程序崩溃！有关如何以及为什么会发生这种情况（以及如何避免它并优雅地处理此类错误）的深入讨论，请参阅我对相关问题的回答： [Preg_match 函数中的 RegExp 返回浏览器错误](https://stackoverflow.com/a/7627962/433790)和 `pcre.recursion_limit``memory_limit`[PHP 正则表达式：这段代码有什么问题吗？](https://stackoverflow.com/a/5527831/433790).

注意：这个问题（和我的答案）几乎与以下内容相同：[使用正则表达式解析专有标签语法 ​​- 如何检测嵌套标签？](https://stackoverflow.com/q/11281587/433790)，但在这个答案中，提出了一个更完整的解决方案，它递归地匹配并存储所有嵌套的括号内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T07:31:59.830

我找到了我正在寻找的答案并将其放在这里，以便每个人都可以使用它。它确实非常简单，仅在一行中：

```
 $text1=preg_replace("/\{\{(([^{}]*|(?R))*)\}\}/",'',$text1); 
```

它会搜索并用你想要的任何内容替换所有 {{text}}。您还可以使用 preg_match_all 将它们全部放在一个数组中。

# c++ - 背景闪烁

> ID：11294146
> 
> 赞同：0
> 
> 时间：2012-07-02T12:56:22.027
> 
> 标签：c++, winapi, background-color

我正在修改 pdf viewe 的源代码：SamutraPDF。

在注册主窗口的窗口类时，原代码没有

```
wcex.hbrBackground  = gBrushFrameBg; 
```

我自己添加这个。但是当我调整主窗口的大小时，我得到了背景闪烁。主窗口的整个客户区由几个子窗口覆盖，如工具栏、目录和 pdf 文件的查看区。

我在创建主窗口时尝试添加`WS_CLIPCHILDREN`，但没有帮助。我真的需要给主窗口一个自定义背景。

你能指点我如何解决闪烁。

* * *

我需要主窗口背景的原因是：

我想创建两个面板（每个面板都可以查看一个 pdf 文件），在这两个面板之间，我需要一个“拆分器”，我可以使用它来调整两个面板的大小。我不想真正创建一个分隔栏，而是想在这两个面板之间留出一个空隙。所以我会看到一个“细棒”，这只是一个间隙，颜色作为主窗口的背景颜色。

# ruby-on-rails-3 - 新手：获得相互喜欢并且只有当他们是相互有活跃记录的？

> ID：11294147
> 
> 赞同：0
> 
> 时间：2012-07-02T12:56:23.723
> 
> 标签：ruby-on-rails-3, activerecord, mutual-friendship

什么是获得相互喜欢的好方法？其中 2 个用户彼此喜欢（如在朋友列表中）并且只获得那些相互匹配的用户？

```
user_id   | likes_id 
1           2                
2           1

Only get results where both of the users likes each other ( friendship ) 
```

我已经尝试了一些连接，但不能真正让它工作，是否有构建 AR 功能来获得上述结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:09:15.710

我认为这就是您要寻找的： [ruby​​ on rails 在活动记录中获得 2-way 朋友关系？](https://stackoverflow.com/questions/9671829/ruby-on-rails-getting-a-2-way-friend-relationship-in-active-record)

或者你可以试试这个：

```
SELECT     a.user_id
FROM       likes AS a
INNER JOIN likes AS b
ON         a.user_id=b.likes_id
AND        a.likes_id=b.user_id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T18:48:44.597

要添加到 jexact 的答案，这是您可以使用 AR 执行此操作的一种方法：

```
Like.joins('join likes l on likes.user_id=l.likes_id and l.user_id=likes.likes_id') 
```

或者

```
Like.select('l.*').joins('join likes l on likes.user_id=l.likes_id and l.user_id=likes.likes_id') 
```

另一种（较慢？但恕我直言看起来更干净）的方法是在您的用户模型中执行此操作（未经测试，但应该给您一个想法）：

```
class User < ActiveRecord::Base
  has_many :likes
  has_many :friends, :through => :likes

  has_many :liked_by, :foreign_key => 'likes_id', :class_name => 'Like'
  has_many :followers, :through => :liked_by, :source => :user

  def mutually_likes?(user)
    self.friends.include?(user) && self.followers.include?(user)
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T13:02:00.310

[http://railscasts.com/episodes/163-self-referential-association](http://railscasts.com/episodes/163-self-referential-association)

这样你就可以在用户之间建立关系，就像我用这个例子来建立媒体公司和公司之间的关系一样，hwo 拥有这个媒体（在我的情况下），其中媒体可以由公司 A 拥有，公司 A 由公司拥有B 这就是你得到自我参照协会的地方。

在您的情况下，实现这一点要简单得多，因为您需要用户模型。对我来说，需要进行更多修改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T11:15:20.517

我用

```
 @groups = Like.select('l.*').joins('join likes l on likes.user_id=l.likes and   l.user_id=likes.likes')

  unless @groups.empty?
    @groups.each do |group|
      friendship = Friendship.create(user_id: group.user_id, friend_id: group.likes)
    end
  end 
```

模型中的抽象更好我稍后会研究

# php - wget忽略url的某些部分

> ID：11294152
> 
> 赞同：0
> 
> 时间：2012-07-02T12:56:37.500
> 
> 标签：php, terminal, wget

wget --output-document=/var/www/projects/meme/upload/1341233172.jpeg [http://memecaptain.com/i?u=http://cdn.memegenerator.net/images/400x/528461.jpg&t1 =dm&t2=cmks](http://memecaptain.com/i?u=http://cdn.memegenerator.net/images/400x/528461.jpg&t1=dm&t2=cmks)

我使用以下命令下载 meme，但 wget 忽略 &t1 和 &t2 部分，即命令被执行为

wget --output-document=/var/www/projects/meme/upload/1341233172.jpeg [http://memecaptain.com/i?u=http://cdn.memegenerator.net/images/400x/528461.jpg](http://memecaptain.com/i?u=http://cdn.memegenerator.net/images/400x/528461.jpg)

任何帮助表示赞赏。Bdw 我在终端以及我的 php 脚本中运行命令

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T12:59:32.013

因为 & 是[特殊](http://hacktux.com/bash/ampersand)的。将您的网址用引号括起来。

```
wget --output-document=/var/www/projects/meme/upload/1341233172.jpeg \
"http://memecaptain.com/i?u=http://cdn.memegenerator.net/images/400x/528461.jpg" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:00:04.737

使用引号：

```
wget --output-document="/var/www/projects/meme/upload/1341233172.jpeg" "http://memecaptain.com/i?u=http://cdn.memegenerator.net/images/400x/528461.jpg&t1=dm&t2=cmks" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:00:12.243

如果您从命令行执行此操作，则需要将其括在引号中。如果你通过 shell_exec 执行它也是一样的：

```
 $cmd = "wget --output-document=/var/www/projects/meme/upload/1341233172.jpeg 'http://memecaptain.com/i?u=http://cdn.memegenerator.net/images/400x/528461.jpg&t1=dm&t2=cmks'"
 shell_exec($cmd); 
```

否则，shell 将解释“&”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T13:01:15.477

用这个;

```
wget --output-document=/var/www/projects/meme/upload/1341233172.jpeg "http://memecaptain.com/i?u=http://cdn.memegenerator.net/images/400x/528461.jpg&t1=dm&t2=cmks" 
```

# java - 移除组件后将框布局居中

> ID：11294156
> 
> 赞同：1
> 
> 时间：2012-07-02T12:56:52.933
> 
> 标签：java, swing, layout, layout-manager, boxlayout

我有一个创建 JButtons 的程序，然后将其添加到带有 BoxLayout 的 JPanel 中，该 BoxLayout 设置为垂直放置它们。有时第一个按钮会被有意从 JPanel 中删除。最初，按钮正确居中，按钮也成功删除。问题是剩下的按钮会分开来填充空间。这不是我想要的，相反，我希望它们沿 y 轴重新居中而不分开。

我有一个扩展 JPanel 的类。在构造函数中创建了 BoxLayout。

```
setPreferredSize(new Dimension(150, 500));
setLayout(new BoxLayout(this, BoxLayout.Y_AXIS));
setAlignmentY(CENTER_ALIGNMENT); 
```

创建按钮当前是此类中的一种方法：

```
createButtons(int numButtons){
for (int i=0;i<numButtons;i++) {
    add(new JButton());
} 
```

而移除是另一种方法：

```
removeButton(){
    if(getComponentCount()>1){
        remove(0);
        validate();
        repaint();
    }
} 
```

有谁知道如何使按钮保持沿 y 轴居中而不分散开来填充包含面板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:08:12.480

您是否听说过 BoxLayouts 中的胶水，它使用不可见组件作为填充物（胶水），我认为这应该有助于保持按钮居中，请参阅以下 2 个链接：[BoxLayout docs](http://docs.oracle.com/javase/tutorial/uiswing/layout/box.html)和[BoxLayout - Filler](http://docs.oracle.com/javase/tutorial/uiswing/layout/box.html#filler)这个网站也有一些关于 Boxlayout 的很棒的教程用胶水：[BoxLayout Glue](http://www.java2s.com/Code/Java/Swing-JFC/BoxLayoutGlueSample.htm)和[这个](http://www.java2s.com/Code/Java/Swing-JFC/UsingGlue.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T14:09:50.297

我不明白你的问题。也许我错过了一步，但在下面的代码片段中，所有组件都水平居中并在顶部对齐。每当移除一个组件时，下面的按钮就会自动堆叠在顶部。也许从这个片段开始向我们展示您的问题是什么：

```
import java.awt.Color;
import java.awt.Component;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.BorderFactory;
import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class TestButtons {

    protected void createAndShowGUI() {
        JFrame frame = new JFrame("Test buttons/BoxLayout");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        final JPanel panel = new JPanel();
        panel.setBorder(BorderFactory.createLineBorder(Color.RED));
        // panel.setPreferredSize(new Dimension(150, 500));
        BoxLayout mgr = new BoxLayout(panel, BoxLayout.Y_AXIS);
        panel.setLayout(mgr);
        for (int i = 0; i < 5; i++) {
            final JButton button = new JButton("Remove Hello World " + (i + 1));
            button.setAlignmentX(Component.CENTER_ALIGNMENT);
            button.addActionListener(new ActionListener() {

                @Override
                public void actionPerformed(ActionEvent e) {
                    panel.remove(button);
                    panel.revalidate();
                    panel.repaint();
                }
            });
            panel.add(button);
        }
        frame.add(panel);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new TestButtons().createAndShowGUI();
            }
        });
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:03:15.447

我认为这是使用 BOX Layout 的问题。这些按钮确实保持居中，但“填充”到它们添加到的窗格的边缘。我相信正确的方法（如果您知道要创建的按钮数量）是使用带有 setPreferedSize 方法的网格布局。

```
JButton btn = new JButton(String.valueOf(i));
btn.setPreferredSize(new Dimension(40, 40));
panel.add(btn); 
```

# jsf - 如何在 remoteCommand 中将值传递给 setPropertyActionListener

> ID：11294163
> 
> 赞同：1
> 
> 时间：2012-07-02T12:57:19.140
> 
> 标签：jsf, primefaces

我想分配一个动态值来`#{viewScope.newLOBType}`使用（如下`setPropertyActionListener`所示`remotecommand`），那么如何将值从 Javascript 传递到这里？

**代码：**

```
<p:remoteCommand name="showPanel" update=":createLOBPanel">
    <f:setPropertyActionListener target="#{viewScope.newLOBType}" value="..<dynamic value from JavaScript>.. "/>
</p:remoteCommand> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:13:31.993

一种方法可能是：

定义

```
<h:inputText id="myHiddenValue" style="display:none" value="#{viewScope.newLOBType}"/> 
```

然后使用 js 或 jquery 设置它的值`$("#myHiddenValue").val("wooot");`

然后

```
<p:remoteCommand process="myHiddenValue" name="showPanel" update=":createLOBPanel"> 
```

# java - 在java中更新SQL图像

> ID：11294168
> 
> 赞同：2
> 
> 时间：2012-07-02T12:57:41.767
> 
> 标签：java, sql-server, image, blob

我需要做的（我知道这是不好的做法，但我有点被迫）是从 Java 将图像上传到 SQL DB。目前，我正在使用准备好的语句并尝试使用它来上传图像中的字节。

```
public void insertImage(Connection conn,String img,String strItemNum)
{

        String query;
        PreparedStatement pstmt;

        try
        {
                File file = new File(img);
                FileInputStream fis = new FileInputStream(file);
                byte[] image = new byte[(int) file.length()];
                fis.read(image);
                System.out.println("image as sent " + image.length);
                query = ("SELECT [Item Picture] from [Inventory] where [Item Number] = '" + strItemNum + "'");
                pstmt = conn.prepareStatement(query);
                System.out.println(pstmt.getMetaData().getColumnName(1) + " of type: " + pstmt.getMetaData().getColumnTypeName(1));
                pstmt.setBytes(1,image);
                pstmt.executeUpdate();
                pstmt.close();

        }
        catch (IOException | SQLException e)
        {
            System.err.println(";"+e.getMessage());
            e.printStackTrace();

        }

} 
```

但这会产生一个 SQLException: Invalid parameter index 1。我表中的参数是“图像”类型，我无法坚持。我试过使用 .setBlob 但从我的谷歌研究来看，Blob 似乎从来没有很好地实现过。

编辑：通过使用 AVD 的答案解决

变成

```
query = ("Update  [Inventory] set [Item Picture] = ? where [Item Number] = ?");
pstmt = conn.prepareStatement(query);
pstmt.setBytes(1,image);
pstmt.setString(2, strItemNum);
pstmt.executeUpdate();
pstmt.close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:03:43.720

您应该必须使用`INSERT`or `UPDATE`sql 语句来添加新记录或更新现有行。

```
String sql="INSERT INTO TableName (Col1,Col2) VALUES (?,?)"; 
```

使用`?`（问号）指定占位符。

编辑：

```
Connection connection=null;
PreparedStatement statement=null;
String sql="UPDATE TableName set ImageCol1=? WHERE ID=?";
try{
  //Obtain connection 
  statement=connection.prepareStatement(sql);
  statement.setBytes(1,byteArray);
  statement.setInt(2,10);
  ...
}catch(SQLException ex){
  //
}finally{
  if(ps!=null) {
    try{
      ps.close();
    }catch(Exception ex){
      //
    }
  }
 if(cn!=null) {
    try{
      cn.close();
    }catch(Exception ex){
      //
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-22T17:31:02.137

你应该这样做：

```
Connection con = getConnection();
PreparedStatement ps = null;
con = getConnection();
ps = con.prepareStatement("insert into tableName (column, blobColumn...) values (?, ?)");
ps.setString(1, "ID");
File image = new File("C:/yourPath.../...");
inputStream = new FileInputStream(image);
ps.setBinaryStream(2, (InputStream) inputStream, (int) (image.length()));
ps.executeUpdate(); 
```

就是这样，现在您将 img 插入 DB。

# sql-server-2008 - 在 Service Broker 的同一端点中同时使用 Windows 和证书身份验证

> ID：11294172
> 
> 赞同：1
> 
> 时间：2012-07-02T12:57:51.680
> 
> 标签：sql-server-2008, sql-server-2008-r2, service-broker

我们在 SQL Server 2008 中设置了一个分布式服务代理环境。有一个数据发布者和多个已发布数据的订阅者。我们需要其中一些订阅者通过 Windows 身份验证与发布者通信，而其他订阅者则通过基于证书的身份验证。是否可以使用证书和基于 Windows 的身份验证在发布者端创建服务代理端点？还要求所有订户在其末端都有一个对称的端点定义吗？我们可以在订阅者端定义一些端点以仅支持 Windows 和一些仅支持证书吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:04:39.980

服务代理端点以及数据库镜像端点支持混合模式身份验证。只需指定所需的两种模式：

```
CREATE ENDPOINT broker
   STATE = STARTED
   AS TCP (LISTENER_PORT = 4022)
   FOR SERVICE_BROKER (AUTHENTICATION = WINDOWS CERTIFICATE [<certificatename>]); 
```

当这样配置时，端点将接受来自其他端点的连接，这些端点被配置为仅使用 WINDOWS 身份验证，并将与它们一起使用 Windows。IT 还将接受来自其他端点的连接，这些端点配置为仅使用 CERTIFICATE 并将使用证书。*此外，当与另一个也*配置为同时使用 WINDOWS 和 CERTIFICATE 的端点进行身份验证时，将在两种协议上都尝试进行身份验证，并且只有在*两种*协议都失败时才会拒绝连接。如果 WINDOWS 或 CERTIFICATE 成功，则允许连接。顺序由接受连接的主机决定。

# ruby-on-rails-3 - 带有功能测试的测试设备注册控制器

> ID：11294178
> 
> 赞同：3
> 
> 时间：2012-07-02T12:58:17.827
> 
> 标签：ruby-on-rails-3, devise, functional-testing

我正在尝试测试我的注册控制器（它覆盖了 Devise 的内置控制器）但是当我进行以下测试时：

```
test "should create user" do
    post :create, user: { email: "temp12345@email.com", first_name: @user.first_name}
    assert_redirected_to user_path(assigns(:user))
end 
```

但是，返回的响应显示“您必须注册/登录才能继续”，这没有任何意义，因为我可以从浏览器手动执行此操作以注册用户。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T17:29:04.253

只是有同样的问题。答案在[设计文档](http://devise.plataformatec.com.br/#getting-started/test-helpers)中：

> 2) 如果您正在测试 Devise 内部控制器或从 Devise 继承的控制器，您需要在请求之前告诉 Devise 应该使用哪个映射。这是必要的，因为 Devise 从路由器获取此信息，但由于功能测试不通过路由器，因此需要明确告知。例如，如果您正在测试用户范围，只需执行以下操作：

```
@request.env["devise.mapping"] = Devise.mappings[:user]
get :new 
```

# linux - /dev/hda1 在启动时从我的静态 /dev 目录中消失

> ID：11294185
> 
> 赞同：1
> 
> 时间：2012-07-02T12:58:35.427
> 
> 标签：linux, embedded-linux, busybox, buildroot

我有一个从 initramfs 映像引导的嵌入式 Linux（vanilla、3.3.8、i486、Vortex86dx）系统。

我有一个 IDE 闪存盘，在 /dev/hda1 和 /dev/hda2 有两个分区。

它有一个静态的 /dev 目录。

当我启动时，/dev/hda1 条目不再存在。/dev/hda1 似乎已被内核删除（？）。

如果我从 NFS 根文件系统引导我的目标，我不会遇到同样的问题。

我使用 Buildroot 通过 device_table_dev.txt 文件创建 /dev 目录。例如

```
# IDE Devices
/dev/hda    b   640 0   0   3   0   0   0   -
/dev/hda    b   640 0   0   3   1   1   1   4 
```

我从 Buildroot 输出/图像中检查了 rootfs.tar.gz。/dev 目录包含 /dev/hda1：

```
brw-r-----  1 root root  3,   0 Jul  2 13:44 hda
brw-r-----  1 root root  3,   1 Jul  2 13:44 hda1
brw-r-----  1 root root  3,   2 Jul  2 13:44 hda2
brw-r-----  1 root root  3,   3 Jul  2 13:44 hda3
brw-r-----  1 root root  3,   4 Jul  2 13:44 hda4 
```

我在目标上的启动后目录列表（在 rcS 中完成）如下所示：

```
brw-r-----   1 root   root    3,   0 Jul  2 12:44 hda
brw-r-----   1 root   root    3,   2 Jul  2 12:44 hda2
brw-r-----   1 root   root    3,   3 Jul  2 12:44 hda3
brw-r-----   1 root   root    3,   4 Jul  2 12:44 hda4 
```

/dev/hda1 丢失。

如果我运行 Busybox 实用程序“mdev -s”，它会在目标上恢复 /dev/hda1 并正常工作。例如我可以安装它

有没有人见过这种行为？

内核会从 /dev 中删除条目吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-13T12:59:36.050

如果使用静态设备表，则应在内核配置中停用：devtmpfs、mdev 和 udev。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T05:41:50.687

也许您应该检查初始脚本（/etc/init.d/、/etc/inittab *），看看它是否重新挂载了 /dev/ 文件系统。重新安装可能会删除您的 /dev/*条目。

“mdev -s”触发了冷插拔事件并为您重新创建了条目。

# java - EmployeeStore (HashMap) 的 SearchByEmail 方法

> ID：11294187
> 
> 赞同：0
> 
> 时间：2012-07-02T12:58:43.803
> 
> 标签：java, hashmap, store

嘿，我一直在环顾四周，但找不到让 searchByEmail 方法起作用的方法。此应用程序存储公司员工的详细信息，例如姓名、身份证和电子邮件。我需要一种方法来通过其员工的电子邮件地址搜索哈希图。

这是我的代码：

```
//Imports.
import java.util.HashMap;
//********************************************************************
public class EmployeeStore
{
    HashMap<String, Employee> map;

//Constructor.  
    public EmployeeStore()
    {
        map = new HashMap<String,Employee>();
    }
//********************************************************************
//Hashmap Methods.
//Add to the Hashmap : Employee.
    public void add(Employee employee)
    {

        map.put(employee.getEmployeeName(), employee);
    }
//********************************************************************
//Remove from the Hashmap : Employee.
    public void remove(String key)
    {
      //Remove the Employee by name.
        map.remove(key);
    }
//********************************************************************
//Clear the Hashmap : Employee.
    public void clear()
    {
        map.clear();
    }
    //********************************************************************
//Print the Hashmap : Employee. 
    public void print()
    {
        System.out.println("\n********Employee's in the Company.********");
        for (Employee employee : map.values())
        {
            //System.out.println(employee); or:
            System.out.println("Employee Name:\t" + employee.getEmployeeName());
            System.out.println("Employee Id:\t" + employee.getEmployeeId());
            System.out.println("E-mail:\t"+ employee.getEmployeeEmail());
        }

    }
    public Employee get(String name){
        return map.get(name);
    }
    /*public void searchByName ()
    {
        //(for(Employee e : map.values()) {...}) 
        //and check for each employee if his/her email matches the searched value
        for(Employee e : map.values())
        {
            System.out.println(e);
            map.equals(getClass());

        }
    }*/
    public Employee searchByName(String name) 
    {
        Employee employee = map.get(name);    
        System.out.println(employee);
        return employee;
    }

//********************************************************************  
//********************************************************************

}

//Imports:

//********************************************************************
//Employee Class.
public class Employee
{
//Variables.
    private String employeeName;
    private int employeeId;
    private String employeeEmail;
//********************************************************************  
//Constructor.
    public Employee(String employeeName, int employeeId, String employeeEmail) 
    {
        this.employeeName = employeeName;
        this.employeeId = employeeId;
        this.employeeEmail = employeeEmail;
    }
//********************************************************************
//Getters.
    public String getEmployeeEmail() {
        return employeeEmail;
    }
    public void setEmployeeEmail(String employeeEmail) {
        this.employeeEmail = employeeEmail;
    }
    public String getEmployeeName() {
        return employeeName;
    }
    public int getEmployeeId() {
        return employeeId;
    }
//********************************************************************
//toString method.
    public String toString() {
        return "Employee [employeeName=" + employeeName + ", employeeId="
                + employeeId + ", employeeEmail=" + employeeEmail + "]";
    }
//********************************************************************

}

//Imports.
import java.util.Scanner;
//********************************************************************  
public class MainApp
{
    private static Scanner keyboard = new Scanner(System.in);

    public static void main(String[] args)
    {
        new MainApp().start();

    }
    public void start()
    {
        EmployeeStore Store = new EmployeeStore();
        Store.add(new Employee ("James O' Carroll", 18,"hotmail.com"));

        Store.add(new Employee ("Andy Carroll", 1171,"yahoo.com"));

        Store.add(new Employee ("Luis Suarez", 7,"gmail.com"));
        Store.searchByName("James O' Carroll");
        //Store.print();

}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:00:57.330

好吧，您可以简单地遍历所有值：

```
public Employee searchByEmail(String email) 
{
    for (Employee employee : map.values() {
        if (email.equals(employee.getEmail()) {
            return employee;
        }
    }
    return null;
} 
```

注意事项：

*   这是一个 O(N) 操作
*   可能有多个匹配 - 这只返回第一个
*   您可能应该验证`email`参数是否为非空

# jquery - Django 和 AJAX 表单

> ID：11294188
> 
> 赞同：1
> 
> 时间：2012-07-02T12:58:51.430
> 
> 标签：jquery, ajax, django

我有一个 django modelform，我已经设置为使用 jQuery 和 jQuery AjaxForm 插件。

它非常正确地处理任何提交的数据并显示错误或保存，但是它根本不会在成功提交后使用刷新的数据重新填充表单。

这是我的代码：

```
@login_required
@transaction.commit_on_success
def edit(request, pk):
    a = get_object_or_404(Item.objects.select_related(), pk=pk)
    b = Status.objects.all() # was select_related()
    currentsec = a.integrity_hash
    item_ct = ContentType.objects.get_for_model(Item).id

    try:
        last_viewed = request.session['last_viewed']
        if pk not in last_viewed:
                if len(last_viewed) > 19:
                        last_viewed.pop(0)        
                last_viewed.append(pk)
        request.session['last_viewed'] = last_viewed
    except KeyError:
        request.session['last_viewed'] = [pk]

    if request.method == 'POST':
        f = ItemForm(request.POST, instance=a)
        if f.is_valid():
            editted_item = f.save(commit=False)
            # check for changes to item before save
            if currentsec == editted_item.integrity_hash:
                editted_item.integrity_hash = form_hmac(f)
                # lock item row for updating
                Item.objects.select_for_update().filter(pk=pk)
                editted_item.save()

                m = Modification.objects.create(
                    content_object = a,
                    object_id = pk,
                    action = 1,
                    modifier = request.user,
                    )
                m.save()

                messages.success(request, 'Item editted successfully.')

                if request.is_ajax():
                    response_dict = serialize('json', (editted_item,))
                else:
                    return HttpResponseRedirect(reverse('edit', kwargs={'pk': pk,}))
            else:
                messages.error(request, 'Item could not be saved. It has been modified whilst you were working on it.')
                response_dict = json.dumps({'errors': dict([(k, [unicode(e) for e in v]) for k,v in f.errors.items()])})
        else:
            messages.error(request, 'Item could not be saved.')
            response_dict = json.dumps({'errors': dict([(k, [unicode(e) for e in v]) for k,v in f.errors.items()])})
    else:
        f = ItemForm(instance=a)
        f.fields["item_maker"].queryset = ItemMaker.objects.filter(Q(end_date__isnull=True) | Q(pk = a.item_maker.id) | Q(end_date__gte=a.date_due))

    variables = RequestContext(request, {
        'item': a,
        'form': f,
        'itemstatus': b,
        'item_ct': item_ct,
    })

    if request.is_ajax():
        return HttpResponse(response_dict, mimetype="application/json")

    return render_to_response('items/item_edit.html', variables) 
```

# javascript - 通过一次提交保存来自多个 ASP.NET Telerik 网格的更改

> ID：11294198
> 
> 赞同：0
> 
> 时间：2012-07-02T12:59:13.413
> 
> 标签：javascript, asp.net-mvc-3, telerik, telerik-grid, telerik-mvc

我有一个复杂的屏幕，它有两个 Telerik 网格以及其他用户控件（文本框、下拉菜单等）。用户可以在两个网格中添加/删除/编辑行，并且两个网格是相互关联的（一个使用来自另一个的数据）

我需要一个表单提交，它将打包所有数据并将其发送到控制器内的一个 ActionResult。Telerik 的示例展示了如何一次提交一个网格，但这可以跨多个网格和其他控件完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T20:01:51.580

您遇到的问题在论坛上经常讨论。这是一个讨论： [http ://www.telerik.com/community/forums/aspnet-mvc/grid/submit-entire-form-including-grids.aspx](http://www.telerik.com/community/forums/aspnet-mvc/grid/submit-entire-form-including-grids.aspx)

# android - 如何找到地图中两个地理点之间的正确距离？

> ID：11294208
> 
> 赞同：5
> 
> 时间：2012-07-02T13:00:01.463
> 
> 标签：android, android-location

我需要开发应用程序，用户必须在其中找到他停放的汽车并显示他和停放的汽车之间的距离。我使用 GPS 和定位服务。

对于距离，我使用了半**正弦**公式，但距离始终显示 0 米。

我尝试了很多在谷歌中寻找解决方案，但没有得到任何正确的解决方案。

任何人都可以提出他们的建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-02T13:03:16.500

Google Docs 有两种方法

![在此处输入图像描述](../Images/ca63a359ca8a57dec8cf853e6371d16b.png)

如果您从 GeoPoint 获取纬度/经度，那么它们是微度数。您必须乘以 1e6。

**但我更喜欢使用下面的方法。（它基于Haversine公式）**

[http://www.codecodex.com/wiki/Calculate_Distance_Between_Two_Points_on_a_Globe](http://www.codecodex.com/wiki/Calculate_Distance_Between_Two_Points_on_a_Globe)

```
double dist = GeoUtils.distanceKm(mylat, mylon, lat, lon);

 /**
 * Computes the distance in kilometers between two points on Earth.
 * 
 * @param lat1 Latitude of the first point
 * @param lon1 Longitude of the first point
 * @param lat2 Latitude of the second point
 * @param lon2 Longitude of the second point
 * @return Distance between the two points in kilometers.
 */

public static double distanceKm(double lat1, double lon1, double lat2, double lon2) {
    int EARTH_RADIUS_KM = 6371;
    double lat1Rad = Math.toRadians(lat1);
    double lat2Rad = Math.toRadians(lat2);
    double deltaLonRad = Math.toRadians(lon2 - lon1);

    return Math.acos(Math.sin(lat1Rad) * Math.sin(lat2Rad) + Math.cos(lat1Rad) * Math.cos(lat2Rad) * Math.cos(deltaLonRad)) * EARTH_RADIUS_KM;
} 
```

最后，我想分享奖金信息。

**如果您正在寻找行车路线，请在两个地点之间选择路线，然后前往**

[http://code.google.com/p/j2memaprouteprovider/](http://code.google.com/p/j2memaprouteprovider/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T13:09:14.553

尝试在*android.location* API中使用此方法

[distanceBetween(double startLatitude, double startLongitude, double endLatitude, double endLongitude, float[] 结果)](http://developer.android.com/reference/android/location/Location.html#distanceBetween%28double,%20double,%20double,%20double,%20float%5B%5D%29)

此方法计算两个位置之间的近似距离（以米为单位），以及可选的它们之间最短路径的初始和最终方位

**注意：**如果您从 GeoPoint 获得纬度/经度，那么它们是微度数。你必须乘以 1E6

如果您想通过**Haversine 公式计算 2 个 Geopoint 之间的距离**

```
public class DistanceCalculator {
   // earth’s radius = 6,371km
   private static final double EARTH_RADIUS = 6371 ;
   public static double distanceCalcByHaversine(GeoPoint startP, GeoPoint endP) {
      double lat1 = startP.getLatitudeE6()/1E6;
      double lat2 = endP.getLatitudeE6()/1E6;
      double lon1 = startP.getLongitudeE6()/1E6;
      double lon2 = endP.getLongitudeE6()/1E6;
      double dLat = Math.toRadians(lat2-lat1);
      double dLon = Math.toRadians(lon2-lon1);
      double a = Math.sin(dLat/2) * Math.sin(dLat/2) +
      Math.cos(Math.toRadians(lat1)) * Math.cos(Math.toRadians(lat2)) *
      Math.sin(dLon/2) * Math.sin(dLon/2);
      double c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return EARTH_RADIUS * c;
   }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-02T13:13:38.717

`distanceBetween()`方法将为您提供两点之间的直线距离。得到两点之间的路线距离见我的答案[在这里](https://stackoverflow.com/questions/10683554/distance-calculation-from-my-location-to-destination-location-in-android/10749705#10749705)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T13:03:03.540

android.location.Location.distanceBetween(double startLatitude, double startLongitude, double endLatitude, double endLongitude, float[] 结果)

地理点有 getLongitudeE6() 和 getLatitudeE6() 提供帮助。请记住，这些是 E6，因此您需要除以 1E6。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-02T13:10:31.340

harvesine 公式的问题在于它不计算实际距离。它是球体上两点的距离。实际距离取决于街道或水路。harvesine 公式也有点复杂，因此更容易让 Google-Api 给出真实距离。使用 Googlemaps Api，您需要学习路线 API。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-31T17:35:52.600

distanceBetween 不是指真实距离（道路距离）所以我建议你访问这个谷歌源代码，它会显示你 2 个地理点之间的真实道路距离。 [链接](http://code.google.com/p/j2memaprouteprovider/source/browse/?r=12#svn/trunk/J2MEMapRouteAndroidEx) 有 2 个版本，一个适用于**Android**，一个适用于**黑莓**，请查看

# css - Div's inside Div 从底部开始

> ID：11294212
> 
> 赞同：1
> 
> 时间：2012-07-02T13:00:06.700
> 
> 标签：css, html

```
<!DOCTYPE html>
<html>
    <head>
        <style>
            #other {
                background: #f4e5dc;
                margin-top: 48px;
            }

            .otherIn {
                width: 256px;
                font-family: Georgia;
                display: inline-block;
                margin-left: 28px;
                color: #af182a;

            }

            .otherIn h1 {
                font-family: "FertigoProRegular";
            }
        </style>
    </head>
    <body>
        <div id="other">
            <div id="menu_items" class="otherIn">
                <h1>Menu Items</h1>
                <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Nam cursus. Morbi ut mi. Nullam enim leo, egestas id, condimentum at, laoreet mattis, massa. Sed eleifend nonummy diam. </p>
            </div>
            <div id="video" class="otherIn">
                <h1>Food Videos</h1>
               <!-- <video width="250" controls preload="none" poster="_images/video_wait.png">
                    <source src="_video/How To Correctly Add Milk to Your Coffee.webm">
                    <source src="_video/How To Correctly Add Milk to Your Coffee.mp4">
                    Jūsu pārlūks neatbalsta audio
                </video> -->
            </div>
            <div id="msg" class="otherIn">
                <h1>Testimonials</h1>
                <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Nam cursus. Morbi ut mi. </p>
            </div>
        </div>
    </body>
</html> 
```

为什么，使用这段代码，text/div 从底部开始......而不是从顶部开始？是的，这就是它的样子。 [http://jsfiddle.net/8W3Gq/embedded/result/](http://jsfiddle.net/8W3Gq/embedded/result/) 希望得到您的帮助............

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:09:03.567

因为您在 css中错过`vertical-align:top`了类的属性：`.otherIn`

**见演示：http:** [//jsfiddle.net/rathoreahsan/8W3Gq/1/](http://jsfiddle.net/rathoreahsan/8W3Gq/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:09:54.513

添加垂直对齐：顶部；到 .otherIn 类中的 css

# c# - .NET 线程 - 这是处理返回结果的两个线程的合适方法吗？

> ID：11294215
> 
> 赞同：1
> 
> 时间：2012-07-02T13:00:12.100
> 
> 标签：c#, .net, multithreading

我的编程方式有什么错误或本质上不安全吗？我仍在学习.NET 中的线程逻辑。

基本上，我`APIManager.ExecuteRequest()`被叫了两次，这需要一段时间，所以我希望这两个电话同时发生。看起来 dataResult 变量在加入后都被适当地填充了，但我一直在看到关于`AsyncResult`所有其他 .NET 并发相关 API 的事情，我认为我可能有点过于简化了。

如果没有任何问题，有人可以告诉我获得相同结果的更好方法吗？

```
MyDataResult dataResult1 = null, dataResult2 = null;

System.Threading.Thread t1 = new System.Threading.Thread(delegate()
    {
        dataResult1 = APIManager.ExecuteRequest(dataRequest1, TBIdentifiers.Text, TBCommands.Lines);
    });

System.Threading.Thread t2 = new System.Threading.Thread(delegate()
    {
        dataResult2 = APIManager.ExecuteRequest(dataRequest2, TBIdentifiers.Text, TBCommands.Lines);
    });

    t1.Start();
    t2.Start();

    t1.Join();
    t2.Join(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:05:54.447

这似乎没问题。也许您可以通过在当前线程中运行第二个请求来稍微优化这一点，而不是拥有 3 个线程，其中一个线程只等待另外两个：

```
System.Threading.Thread t1 = new System.Threading.Thread(() =>dataResult1 = APIManager.ExecuteRequest(dataRequest1, TBIdentifiers.Text, TBCommands.Lines));

t1.Start();
dataResult2 = APIManager.ExecuteRequest(dataRequest2, TBIdentifiers.Text, TBCommands.Lines);
t1.Join(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T13:24:57.290

你的方法没有错。也许如果你想更“时髦”，你可以使用一些 .NET 4.0 结构，比如`Parallel.Invoke`，来缩短你的代码：

```
Parallel.Invoke(
    () => dataResult1 = APIManager.ExecuteRequest(dataRequest1, TBIdentifiers.Text, TBCommands.Lines),
    () => dataResult2 = APIManager.ExecuteRequest(dataRequest2, TBIdentifiers.Text, TBCommands.Lines)
    ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T13:27:15.467

您可以使用[ParameterizedThreadStart 委托](http://msdn.microsoft.com/en-us/library/system.threading.parameterizedthreadstart.aspx)

```
public class Request
{
    public Request() {

    public MyDataResult DataResult { get; set; }
    public MyDataRequest DataRequest { get; set; }
}
MyDataResult dataResult1 = null, dataResult2 = null;

public static void ExecuteRequest(object data)
{
    Request req = (Request)data;
    req.DataResult = APIManager.ExecuteRequest(req.DataRequest, 
                                      TBIdentifiers.Text, TBCommands.Lines) 
}

System.Threading.Thread t1 = new System.Threading.Thread(ExecuteRequest);
System.Threading.Thread t2 = new System.Threading.Thread(ExecuteRequest);

t1.Start(new Request{DataResult = dataResult1, DataRequest = dataRequest1});
t2.Start(new Request{DataResult = dataResult2, DataRequest = dataRequest2});

t1.Join();
t2.Join(); 
```

# image - 如何知道 Mac 是否有视网膜？

> ID：11294221
> 
> 赞同：0
> 
> 时间：2012-07-02T13:00:31.480
> 
> 标签：image, macos, cocoa, retina-display

我有这个用于更改按钮图像的代码：

```
- (void)mouseEntered:(NSEvent *)event {
    [self setImage:[NSImage imageNamed:@"FloatingButton_hover"]]; }

- (void)mouseExited:(NSEvent *)event {
    [self setImage:[NSImage imageNamed:@"FloatingButton_normal"]]; } 
```

但是我的资源中有这 2 个的 @2x 图像。我怎么知道 Mac 是否有视网膜，所以我可以`[self setImage:[NSImage imageNamed:@"FloatingButton_normal@2x"]]`？或者还有其他方法吗？
谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T13:03:19.117

你不必那样做。只需将您的 @2x 版本放在同一个文件夹中，其余的由 Cocoa 处理。您可以通过进入[HiDPI](http://www.redmondpie.com/how-to-enable-hidpi-display-mode-retina-like-in-os-x-lion-video/)模式来测试它是否真的在工作。

我建议在 OS X 上观看[高分辨率介绍](https://developer.apple.com/videos/wwdc/2012/?id=213)

# javascript - 滑块图像在 Internet Explorer 中不起作用，但在其他图像中起作用

> ID：11294223
> 
> 赞同：0
> 
> 时间：2012-07-02T13:00:34.647
> 
> 标签：javascript, jquery, html, css, internet-explorer-9

[http://teothemes.com/wp/](http://teothemes.com/wp/)

滑块未显示在 Internet Explorer 上，但在我刷新它几次后它开始工作。显然这不是可接受的行为，但我无法理解问题所在。

它适用于所有其他浏览器，firefox，safari，chrome ......所以它只是 IE

似乎最初没有加载 JS 脚本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:22:37.387

删除`console.log()`js 文件中的行（或注释掉），然后它应该在 IE 中工作。

# jsp - Spring Roo 在 list.jspx 中显示 ID

> ID：11294229
> 
> 赞同：1
> 
> 时间：2012-07-02T13:00:44.427
> 
> 标签：jsp, spring-mvc, spring-roo

我的 list.jspx 文件中有以下内容。

```
<table:table data="${tests}" id="l_com_mtc_test_Test" path="/tests" typeIdFieldName="testId" z="rVizJj8FpPQ5KoK8/JRRK464fR8=">
     <table:column id="c_com_mtc_test_Test_name" property="name" z="FdtZTAmJsb4/B16zRGrrO8e2pT8="/>
</table:table> 
```

我想显示表的 id（特别是 typeIDFieldName 中的 testId 引用）。我没有任何运气插入自己的表：列，也许我做错了什么，有什么建议吗？

# python - 如何找到更改目录名称的路径？

> ID：11294235
> 
> 赞同：3
> 
> 时间：2012-07-02T13:01:02.780
> 
> 标签：python, regex, firefox, ubuntu

我想在我的 python 代码中访问 Ubuntu 上的以下路径：

```
~/.mozilla/firefox/dh4ytbdj.default/bookmarkbackups 
```

其中包含 Firefox 书签

问题是“ ”之前的部分`.default`对于每个用户和机器都是不同的。有没有办法可以为这个目录指定一个通用路径并让 python 访问它并检索所需的文件？

是否可以`~`在 python 代码中实现''来访问当前用户的家？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:03:04.770

```
>>> import os
>>> os.path.expanduser('~/.mozilla/firefox/dh4ytbdj.default/bookmarkbackups')
'/home/username/.mozilla/firefox/dh4ytbdj.default/bookmarkbackups' 
```

对于个人 Firefox 目录的系统范围访问（具有足够的权限），您可以尝试：

```
>>> import glob
>>> glob.glob('/home/*/.mozilla/firefox/*.default/bookmarkbackups') 
```

正如@NedBatchelder 所指出的，这可以组合成一个命令：

```
import os, glob
next(glob.iglob(os.path.expanduser('~/.mozilla/firefox/*.default/bookmarkbackups'))) 
```

它返回一个（如果存在）路径。

# jquery - jQuery ui 多选拖动

> ID：11294237
> 
> 赞同：8
> 
> 时间：2012-07-02T13:01:08.840
> 
> 标签：jquery, jquery-ui

我需要以下功能

1.  通过鼠标拖动和 cntrl 键从列表中选择项目，类似于 jquery ui 可选择项。
2.  一次应该可以拖动多个项目。

我需要类似于操作系统拖放功能的应用程序。

我的问题是如果我想选择多个鼠标指针项目正在拖动的项目，如何解决它。

我试图使用该代码，但它在选择多个项目时存在一些缺陷。

```
$(document).ready(function(){

    var selectedClass = 'ui-state-highlight',
        clickDelay = 600,     // click time (milliseconds)
        lastClick, diffClick; // timestamps

    $("#draggable li")
        // Script to deferentiate a click from a mousedown for drag event
        .bind('mousedown mouseup', function(e){
            if (e.type=="mousedown") {
                lastClick = e.timeStamp; // get mousedown time
            } else {
                diffClick = e.timeStamp - lastClick;
                if ( diffClick < clickDelay ) {
                    // add selected class to group draggable objects
                    $(this).toggleClass(selectedClass);
                }
            }
        })
        .draggable({
            revertDuration: 10, // grouped items animate separately, so leave this number low
            containment: '.demo',
            start: function(e, ui) {
                ui.helper.addClass(selectedClass);
            },
            stop: function(e, ui) {
                // reset group positions
                $('.' + selectedClass).css({ top:0, left:0 });
            },
            drag: function(e, ui) {
                // set selected group position to main dragged object
                // this works because the position is relative to the starting position
                $('.' + selectedClass).css({
                    top : ui.position.top,
                    left: ui.position.left
                });
            }
        });

    $("#droppable, #draggable")
        .sortable()
        .droppable({
            drop: function(e, ui) {
                $('.' + selectedClass)
                 .appendTo($(this))
                 .add(ui.draggable) // ui.draggable is appended by the script, so add it after
                 .removeClass(selectedClass)
                 .css({ top:0, left:0 });
            }
        });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T07:55:00.127

这是多选拖动的演示

[演示](http://jsfiddle.net/zZTfA/11/)

只需使用可选插件来选择多个项目

```
$(".itemlist").selectable({filter:"li"}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:36:08.450

使用 Selectable Grid 示例代码并添加 Draggable + Sortable 功能，如本示例所示：http: [//jqueryui.com/demos/draggable/#sortable](http://jqueryui.com/demos/draggable/#sortable)

# javascript - Onchange ，向上、向下箭头键在 FF 和 Chrome 中有效，但在 IE 中无效

> ID：11294239
> 
> 赞同：-2
> 
> 时间：2012-07-02T13:01:12.743
> 
> 标签：javascript, jquery, ajax, internet-explorer

这是我的jQuery代码

```
 <script type="text/javascript" charset="utf-8">
 $(document).ready(function() {   
         $("#tasks").hide();
            $("select#categories").change(function(){
                    $("#tasks").show();
                    $.getJSON("ajax.php?module=responsibles&action=list_tasks",{id: $(this).val()}, function(j){

                            if($("#categories").val()=="-0") 
                            {                               
                                    $("#tasks").hide();
                            }
                            //if the div is hidden
                            $("div#form_objectifs").hide();
                            var options = '';
                            for (var i = 0; i < j.length; i++)
                            {
                                    options += '<option value="' + j[i].optionValue + '">' + j[i].optionDisplay + '</option>';
                            }
                            $("#tasks").html(options);
                            $('#tasks option:first').attr('selected', 'selected');
                    })
            })  

 });
</script> 
```

此代码在 FF 或 Chrome 上运行良好，但在 IE 中无法用于向上、向下箭头键

任何人

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:16:06.310

第一个问题：您的脚本中没有`keyup`或`keydown`事件。您使用`change`当您的元素失去焦点时触发的事件。

第二个问题：你使用`$(document).ready(function() { ... });`并且在这个你使用`$(function(){ ... });`。这是写同一件事的两种不同方式（第二种是第一种的别名）。选择其中之一，但不要同时选择两者。

第三个问题：请最好地解释您的问题，以便我们为您提供帮助；）。

# c# - 如何通过 mvc 3 中的下拉选择填充 webGrid？

> ID：11294242
> 
> 赞同：1
> 
> 时间：2012-07-02T13:01:15.443
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, webgrid

你好; 我想在选择下拉列表后填充 webGrid。但是我不能。我被选中drb1，然后填充drb2。选择 drb2 后我无法填充 webGrid1。我也无法通过谷歌搜索找到任何样本。如何填充 webgrid？我的目标描述如下：

![在此处输入图像描述](../Images/60f84582037dfae25318c2c88f321609.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:40:17.137

您可以通过调用下拉的选定项更改的操作来实现

在动作内部，您可以使用 DropDown 的 SelectedText 并使用实体框架调用 sql

数据返回后，将其转换为您的模型并将其返回到视图

```
The view you will need 
@model IEnumerable<Product>
<div>
@{
  var grid = new WebGrid(Model, defaultSort:"Price");
}
@grid.GetHtml()
</div> 
```

一些很好的例子：

[http://msdn.microsoft.com/en-us/magazine/hh288075.aspx](http://msdn.microsoft.com/en-us/magazine/hh288075.aspx) http://weblogs.asp.net/andrebaltieri/archive/2010/11/01/asp-net-mvc-3-working-with -webgrid.aspx

# python - 在两个模板块中获取相同的上下文变量

> ID：11294243
> 
> 赞同：1
> 
> 时间：2012-07-02T13:01:20.543
> 
> 标签：python, django, templatetags

我有一个设置上下文变量的 django 模板标签（它从模型中获取随机图像，但对于本示例，假设它获取随机数）

```
{% get_random_number %}
{{ my_random_number }} <!-- outputs a random number between 1 and 10 --> 
```

这工作正常。

但是，我需要在我的页面中的两个不同块中获得相同的“随机”数字：

```
{% block block1 %}
  {% get_random_number %}
  {{ my_random_number }} <!-- outputs a random number between 1 and 10 -->
{% endblock %}

{% block block2 %}
  {% get_random_number %}
  {{ my_random_number }} <!-- outputs a random number between 1 and 10 -->
{% endblock %} 
```

这显然不起作用，因为我得到了两个不同的结果（除非偶然，它们是相同的！）

那么如何使用模板标签来设置跨两个模板块一致的上下文变量呢？

这样做是行不通的 - 上下文变量仅限于它创建的块......

```
{% get_random_number %}

{% block block1 %}
  {{ my_random_number }}
{% endblock %}

{% block block2 %}
  {{ my_random_number }}
{% endblock %} 
```

那么..我怎样才能在其他地方“保存”初始结果，然后回忆它，如果它已经在调用的早期生成？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T13:08:34.100

可能，您可以使用`{% with %}`标签

```
{% with my_random_number=get_random_number %}

{% block block1 %}
  {{ my_random_number }}
{% endblock %}

{% block block2 %}
  {{ my_random_number }}
{% endblock %}

{% endwith %} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:08:01.400

您可以将模板标签逻辑移到您的视图中。在您看来，您只需要拨打`get_random_number`1 个号码，然后在模板中的任意位置使用它。

# iphone - 使用 Place Report Requests（添加地点）api 将位置添加到谷歌地图

> ID：11294253
> 
> 赞同：-1
> 
> 时间：2012-07-02T13:02:20.670
> 
> 标签：iphone, objective-c, google-maps-api-3

我正在开发一个需要添加自定义位置功能的应用程序。位置 myhome、myschool 等。为此我使用了以下 google api [https://developers.google.com/places/documentation/#adding_a_place](https://developers.google.com/places/documentation/#adding_a_place)

并在 api 中按要求发布数据。我在单击添加位置按钮时添加了以下代码。

```
-(IBAction)submitPressed:(id)sender
{

 NSString *temp = [NSString stringWithFormat:@"https://maps.googleapis.com/maps/api/place/add/json"]; 
     temp = [temp stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
     NSLog(@"add location to map url: %@",temp);
     NSURL *url = [NSURL URLWithString:temp];
     NSString *requeststr = @"sensor=false&key=AIzaSyCd4CHYWFPLhw4g5yGJyYZXSV-RZRIQfiM&location=-33.8669710/151.1958750&accuracy=50&name=Google Shoes!&types=shoe_store&language=en-AU";
     requeststr = [requeststr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
        NSData *requestdata = [NSData dataWithBytes:[requeststr UTF8String] length:[requeststr length]];

        NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];
        [request setHTTPMethod:@"POST"];
        [request setHTTPBody:requestdata];

        NSURLResponse *response = NULL;
        NSError *requestError = NULL;
        NSData *responseData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&requestError];
        NSString *responseString = [[[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding] autorelease];
        NSLog(@"responseString:%@",responseString);
} 
```

当我检查日志中的 responseString 时，它显示了我

```
`<!DOCTYPE html>
<html lang=en>
  <meta charset=utf-8>
  <meta name=viewport content="initial-scale=1, minimum-scale=1, width=device-width">
  <title>Error 400 (Bad Request)!!1</title>
  <style>
    *{margin:0;padding:0}html,code{font:15px/22px arial,sans-serif}html{background:#fff;color:#222;padding:15px}body{margin:7% auto 0;max-width:390px;min-height:180px;padding:30px 0 15px}* > body{background:url(//www.google.com/images/errors/robot.png) 100% 5px no-repeat;padding-right:205px}p{margin:11px 0 22px;overflow:hidden}ins{color:#777;text-decoration:none}a img{border:0}@media screen and (max-width:772px){body{background:none;margin-top:0;max-width:none;padding-right:0}}
  </style>
  <a href=//www.google.com/><img src=//www.google.com/images/errors/logo_sm.gif alt=Google></a>
  <p><b>400.</b> <ins>That’s an error.</ins>
  <p>Your client has issued a malformed or illegal request.  <ins>That’s all we know.</ins> 
```

所以，任何人都可以帮我找出错误或将位置添加到地图的任何建议。我在调用 api 时尝试了不同的键，但每次都显示相同的错误。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:08:50.533

The code is actually slightly more complicated and lengthier than that. I won't provide all the code so I will point you to a GREAT tutorial with its sample code (only works on iOS Device not on the simulator by the way):

[Tutorial On Google Places for iOS SDK](http://drew5.net/2011/11/28/google-places-for-ios-5-sdk/)

[Tutorials AMAZING Sample Code Project For Download](https://github.com/jdruid/Google-Places-for-iOS-5#readme)

Also just so you know, the reason the output is coming with weird characters is because the response string you are getting is in the form of XML. The project uses JSON however. You will have to parse the XML using `NSXMLParser` but the project I linked you to has a comprehensive tutorial and the sample project will impress you!

# javascript - JavaScript 中的相机对象检测

> ID：11294258
> 
> 赞同：11
> 
> 时间：2012-07-02T13:02:37.593
> 
> 标签：javascript, html

假设用户拥有像 Chrome 这样的现代浏览器并启用必要的 HTML5 摄像头设置（这样可以`getUserMedia`正常工作），如何使用 JavaScript 检测网络摄像头视线中显示的特定预定义对象？

例如，[基于 HTML5/JS 的人脸检测](http://neave.github.com/face-detection/)效果很好，我看到了另一个[手部检测](http://code.google.com/p/js-handtracking/)演示（在这里效果不佳；我可能做错了什么）。训练相机以检测给定的（开发人员）选择的其他对象的必要步骤是什么？比如说，我想让凸轮识别红笔的位置；或者也许是视线中最黑暗的物体；或者也许是一部黑色的 iPhone 对着相机挥手等等。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T21:19:49.273

对象检测本身就是一项非常棘手的工作。在确定最佳方法之前，您必须了解您的对象是什么，是否平滑、灵活、是否有很多颜色对比、快速移动以及很多其他问题。

此外，这取决于您是只想**检测一个物体**，还是想在它在相机前的移动过程中对其进行**跟踪。**

我将在这里仅命名几个方法，因为我没有时间详细说明。知道名称后，您可能会在 Google 上找到很多文档，但请注意，如果您必须自己实现它们，则可能需要一些数学技能。因此，这通常涉及：

*   **在有趣的点**计算描述符。**查看 Google 上的*SIFT*或*HoG*（梯度直方图）描述符，这些是最常用的描述符。**
***   **建立某种识别结构**，这同样可以根据您的对象和描述符而发生很大变化。流行的方法包括*神经网络*、*支持向量机*。对于移动对象，您通常可以在组合中添加与图形相关的技术，例如*Graph Cuts*。**

 **同样，根据对象，这些甚至可能不是正确的方法。

据我所知，在 JavaScript 中可用的软件非常少，但如果你确实找到了一些东西，我会很高兴知道。同样，这里有一些指示：

*   您的人**脸检测**示例使用了一种非常流行的方法，称为**级联分类**器，它在更流行的库 OpenCV 中可用，并且被大多数人认为是人脸检测*的*首选方法。
*   如果您可以考虑将部分处理移至服务器，则可以使用具有大量可用算法的**OpenCV 。**

我希望我能帮助你开始一点点；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T03:08:26.033

除了 FX 的回答之外，一旦您训练了分类器或[从网络上选择了一个免费提供](http://alereimondo.no-ip.org/OpenCV/34)的分类器，您就可以使用 OpenCV 端口（例如[js-objectdetect](https://github.com/mtschirs/js-objectdetect/#classifiers)或[HAAR.js](https://github.com/foo123/HAAR.js)）进行实际检测。**

# asp.net-mvc - 使用资源键 MVC 3 ASPX 文件

> ID：11294261
> 
> 赞同：0
> 
> 时间：2012-07-02T13:02:52.847
> 
> 标签：asp.net-mvc

我正在使用带有 aspx 引擎的 mVC3，

```
<%html.TextBoxFor(m=m.Code,new {maxlength="6"})%> 
```

我想从资源文件中获取 vlaue "6"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:09:44.483

您可以定义一个全局资源文件（在您的`App_GlobalResources`文件夹中），然后使用强类型类来访问值：

```
<%= html.TextBoxFor(m = m.Code, new { maxlength = MyResources.MaxLength }) %> 
```

# file - 如何监控文件的最后修改日期并相应地重命名？

> ID：11294281
> 
> 赞同：0
> 
> 时间：2012-07-02T13:03:58.587
> 
> 标签：file, unix, webcam

我有一个网络摄像头，它通过重新上传相同的文件并每 10 秒覆盖一次来工作。我想创建一个 shell 脚本来监视这个文件（camFile.jpg），当它检测到它被覆盖时，它会复制它并创建一个名为 camFile-TIMESTAMP.jpg 的新文件。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:05:54.640

我认为最好使用 inotify 为您服务。但这取决于您使用的是哪种语言。

[http://linux.die.net/man/7/inotify](http://linux.die.net/man/7/inotify)

# django - 使用 PHP、Thrift 和 Django

> ID：11294284
> 
> 赞同：0
> 
> 时间：2012-07-02T13:04:02.820
> 
> 标签：django, thrift

我正在计划一个能够使用 PHP 作为前端和 Django 作为 API 平台后端的应用程序。我的问题是可以像我们在常规 MVC 中使用的那样将 Django 与 Thrift 一起使用（没有 HTTP 请求，而不是 Thrift 中的 Onject）。

或者有没有其他替代方案可以使用 PHP 和 Django？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:06:36.487

只需使用 Django。为什么要尝试将两者混合？您首先没有解释为什么这里有两个系统。

# javascript - Addy Osmanis pub/sub，无法理解代码

> ID：11294286
> 
> 赞同：1
> 
> 时间：2012-07-02T13:04:22.010
> 
> 标签：javascript, jquery, publish-subscribe

我正在使用 Addy Osmani 的 pub sub 方法：

```
var topics = {};

jQuery.Topic = function( id ) {
    var callbacks,
        topic = id && topics[ id ];
    if ( !topic ) {
        callbacks = jQuery.Callbacks();
        topic = {
            publish: callbacks.fire,
            subscribe: callbacks.add,
            unsubscribe: callbacks.remove
        };
        if ( id ) {
            topics[ id ] = topic;
        }
    }
    return topic;
}; 
```

但在我将它添加到我的项目之前，我想更好地理解它。除了我从未见过的一行之外，它相当简单： `topic = id && topics[ id ];`

`topic = id`行。&& 运算符在这里做什么？是否将 id 添加到主题数组中？或做一个比较？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T13:07:08.453

```
topic = id && topics[ id ]; 
```

应该读作

```
topic = (id && topics[ id ]); 
```

`&&`具有更高的优先级，如[MDN 文档中所述](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Operator_Precedence)

分配给的值`topic`是`topic[id]`当`id`被评估为“真”值时，`false`否则：所以这是一个更短的方法

```
if (id) {
   topic = topics[id];
}
else {
   topic = false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-22T17:18:58.997

以上是 jQuery.Callbacks() 的 jQuery 文档页面上的 Pub/Sub 示例。 [https://api.jquery.com/jQuery.Callbacks/](https://api.jquery.com/jQuery.Callbacks/)

我已经写了这个例子做了什么的总结，对我来说，这并不是很明显。

* * *

Topic() 是一个函数，它返回一个包含三个重命名的函数对象的主题对象：callbacks.fire、callbacks.add、callbacks.remove。

topic对象包含三个函数对象，重命名为发布、订阅、取消订阅

id 是指标识 pubSub 频道的唯一字符串：例如：“mailArrived”、“mailSent”

主题对象（复数）包含主题对象，以 id 为键。它用于确定是否存在具有该 id 的主题对象。

Topic() 检查 id 是否为 false（未定义、null、NaN、0、"" 或 false）。

如果 id 为真，并且该 id 的主题存在于主题中，则主题对象被分配主题[id] 并返回。

如果 id 为真，并且该 id 的主题在主题中不存在，则创建一个新主题对象，作为主题 [id] 放置在主题中并返回。

如果 id 为 false，则创建并返回一个新的主题对象，但不会放入主题中。

每次创建主题对象时，都会在新的 jQuery 回调列表的唯一值上创建一个闭包。

# .htaccess - 子域 htaccess 索引

> ID：11294287
> 
> 赞同：0
> 
> 时间：2012-07-02T13:04:28.453
> 
> 标签：.htaccess, redirect, subdomain

我有这个结构

```
/
/-log
/-shop
/-wwwroot
/--shop
/--shop/-index.html
/--wp-content
/-- and so on 
```

我想将浏览到 shop.mysite.com 的每个访问者重定向到 /--shop/-index.html 文件 (shop.mysite.com/index.html)。就像现在一样，他们将来到“正常”页面 mysite.com。

我有正确的通配符集。

我的 .htaccess 看起来像这样（普通的 Wordpress）。

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T04:45:06.457

您需要在此之后立即添加`RewriteBase /`

```
RewriteCond %{HTTP_HOST} ^shop.mysite.com$ [NC]
RewriteRule ^$ /shop/index.html [L] 
```

这只会使[http://shop.mysite.com/](http://shop.mysite.com/)为 shop/index.html 上的文件提供服务，如果要将所有请求重定向到 shop.mysite.com 主机，则需要制作一个正则表达式并指向它到 /shop 中的文件。

* * *

> 是这里应该使用的正则表达式吗？那应该怎么看？

您可以在上述规则下方添加：

```
RewriteCond %{HTTP_HOST} ^shop.mysite.com$ [NC]
RewriteCond %{REQUEST_URI} !^/shop/
RewriteRule ^(.*)$ /shop/$1 [L] 
```

# ruby-on-rails-3 - 多对多关系的活动记录查询

> ID：11294288
> 
> 赞同：5
> 
> 时间：2012-07-02T13:05:02.257
> 
> 标签：ruby-on-rails-3, activerecord, active-record-query

我有一个名为 Event 的模型和另一个名为 Product 的模型。一个事件有很多产品，一个产品有很多事件（通过名为 的连接模型`Eventproduct`）。我正在尝试设计一个查询，该查询将选择在任何情况下都不与另一个事件的当前日期范围匹配的所有产品，因此当用户创建具有日期范围的事件时，它将显示可用的产品，以便同一产品不能同时参加 2 个活动。这是否可以通过活动记录查询界面实现，或者我需要编写自己的特定 SQL 查询。

我的迁移看起来像：

```
class CreateProducts < ActiveRecord::Migration
  def change
    create_table :products do |t|
      t.string :make
      t.string :model
      t.integer :wattage
      t.boolean :dmx
      t.decimal :price
      t.timestamps
    end
  end
end

class CreateEvents < ActiveRecord::Migration
  def change
    create_table :events do |t|
      t.datetime :start_date
      t.datetime :end_date
      t.timestamps
    end
  end
end

class AddContactToEvent < ActiveRecord::Migration
  def change
    add_column :events, :name, :string
    add_column :events, :location, :string
    add_column :events, :contact_number, :string
  end
end

class CreateEventproducts < ActiveRecord::Migration
  def change
    create_table :eventproducts do |t|
      t.references :product
      t.references :event

      t.timestamps
    end
    add_index :eventproducts, :product_id
    add_index :eventproducts, :event_id
  end
end 
```

以下是相关模型：

```
class Event < ActiveRecord::Base
  attr_accessible :end_date, :start_date, :products, :lightings, :name, :location, :contact_number, :product_ids
  has_many :products, :through => :Eventproduct
  has_many :Eventproduct
  validates_presence_of :name, :message => "can't be blank"
  validates_presence_of :location, :message => "can't be blank"
  validates_presence_of :contact_number, :message => "A telephone number is needed so that we can contact you if we have any problems"
  validates_presence_of :start_date, :message => "can't be blank"
  validates_presence_of :end_date, :message => "can't be blank"
end

class Eventproduct < ActiveRecord::Base
  belongs_to :product
  belongs_to :event
  # attr_accessible :title, :body
end

class Product < ActiveRecord::Base
  validates :price, numericality: {greater_than_or_equal_to: 0.01}
    attr_accessible :make, :model, :wattage, :dmx, :price
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T13:53:23.187

试试这个：`Product.includes(:Eventproduct).where(eventproducts: { event_id: nil }).group('products.id')`。

**请注意**，它是`where`条件内表的名称。另外不要忘记将 Eventproduct 的关联添加到您的 Product 模型中：`has_many :Eventproduct`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-02T14:51:29.103

我想出了一个可以帮助你的查询。您必须确定时间范围的条件及其逻辑。

查询应该类似于

```
Product.joins(:events).where("events.start_date <= :start_date", {start_date: Time.now}) 
```

where 子句应该包含过滤不需要的事件的逻辑。再次，那段代码应该让你开始。因此，要回答您的问题，这是可能的。查看您获得的查询并解决该查询以使条件符合您的需求。另外，看看这个链接，它应该可以帮助你像我一样修改 where 子句：http: [//guides.rubyonrails.org/active_record_querying.html](http://guides.rubyonrails.org/active_record_querying.html)

希望这对你有帮助！

**更新：**

您可能必须与 Product.all 一起做一些设置差异以包含那些根本没有事件的产品，因为如果产品在 EventProduct 表中没有事件，则该查询将返回空。它可能效率不高，但它应该根据您的需要工作。

```
Product.all - Product.joins(:events).where("condition reversed") 
```

这应该返回所有不符合您条件的产品，包括那些还没有事件的产品。

# mysql - 数据库设计：如何跟踪历史？

> ID：11294292
> 
> 赞同：6
> 
> 时间：2012-07-02T13:05:18.187
> 
> 标签：mysql, database, database-design

数据库设计中维护修订历史的一般策略是什么？如果只是我要处理的一张桌子，我认为这不会那么难。只需将每个更新保存为表中的新记录。最后一条记录将始终是最新版本。

但是当数据存储在多个表中时，有什么好的设计方法可以跟踪修订？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:09:45.320

我更喜欢为每个版本化表添加额外的历史表。`time_from`与带有`time_to`附加字段的主表结构相同。透明地充满了触发器。`time_to`最新版本设置为遥远的未来。

可以使用如下查询检索指定时刻的状态：

```
SELECT * FROM user_history 
WHERE time_from >= '2012-02-01' AND time_to <= '2012-02-01' 
```

对我来说，在主表中存储历史通常不是一个好主意，因为它在检索或连接当前数据时需要复杂的条件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T17:52:24.593

困难的部分不是“基本”表的版本控制——您只需单独对它们进行版本控制，就像您对单独的单个表进行版本控制一样。

困难的部分是跟踪它们之间的**联系**。

您将如何做到这一点取决于特定项目的要求。这是一个[销售订单如何被“历史化”](https://stackoverflow.com/a/10988116/533120)的例子，但也有许多其他的变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:15:59.807

打开 MySQL 的[二进制日志](http://dev.mysql.com/doc/refman/5.0/en/binary-log.html)并使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T14:46:37.950

我正在使用方法，其中我正在处理的每个对象至少有 1 个所谓的*实例*表，我在其中保存倾向于随时间变化的数据。通常，此类表遵循以下概念：

*   他们`_HISTORY`的名字有后缀；
*   它们有 2 个额外的字段`start_dt`和`end_dt`，表示对象实例的生命周期；
*   `start_dt`is `NOT NULL`, `end_dt`can be `NULL`, 表示该实例是当前的且不受时间限制；
*   可以插入未来日期的更改，假设您希望从 激活新的公司名称，`1/Jan-2013`那么您需要将`end_dt`当前实例设置为`31/Dec-2012 23:59:59`并插入一条新`start_dt`记录`1/Jan-2013 00:00:00`
*   有时我也会添加`revision`字段，如果有必要跟踪修订。

为了在这种设计中获得适当的 RI 约束，我总是有 2 个用于版本化对象的表。说，对于`Customer`对象，我有以下一组表：

```
customer (customer_id INTEGER, PRIMARY KEY (customer_id));
customer_history (customer_id INTEGER, start_dt TIMESTAMP, end_dt TIMESTAMP,
                  name VARCHAR(50), sex CHAR(1), ...,
                  PRIMARY KEY (customer_id, start_dt));
customer_bank_history (customer_id INTEGER, start_dt TIMESTAMP, end_dt TIMESTAMP,
                       bank_id INTEGER, iban VARCHAR(34)); 
```

`customer(customer_id)`在我用来构建外键的所有其他地方。查询实际客户详细信息很简单：

```
SELECT c.customer_id, ch.name, ch.sex
  FROM customer c
  JOIN customer_history ch ON c.customer_id = ch.customer_id
       AND now() BETWEEN ch.start_dt AND coalesce(end_dt, now()); 
```

为什么我更喜欢这样的设计：

1.  我通过设计在数据库级别对对象实例进行了版本控制；
2.  我必须维护更少的表格；
3.  如果有人丢弃/禁用任何触发器，则不可能丢失历史记录；
4.  我可以轻松地计划和维护未来的变更。

希望这会帮助你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-29T18:09:23.003

[数据差异](https://datadiff.co)。API 驱动的数据库修订跟踪。

**全面披露：**

我建立了 Datadiff。我需要一个提供 MongoDB 中数据模型的可视化历史的解决方案，以帮助支持 SASS 产品。它也适用于 SQL 数据库。

您可以使用`key:val`符号进行基本查询。IE`id:123`

# tinymce - TinyMce CSS - 仅在编辑器中应用 css

> ID：11294295
> 
> 赞同：1
> 
> 时间：2012-07-02T13:05:28.160
> 
> 标签：tinymce

我正在使用 content_css 链接到我网站的所有 CSS。

这是可行的，并且 tiinyMce 编辑器窗口中的内容根据 css 文件进行样式设置。

我的网站有页眉、内容、页脚布局，我将特定样式应用于内容部分中的链接，如下所示......

```
.contentWrapper a { background: url ... etc 
```

因此这些样式不会应用在编辑器窗口中，因为链接不在具有 contentWrapper 类的 div 中。

我知道我可以创建另一个 css 文件并将这些样式直接应用于其中的标签，并且只为 tinyMCE 引用它，但这会复制我的网站 css。

无论如何我可以指定类似 .tinyMce a { .. 之类的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:09:39.743

八次你复制你的css，否则你将需要加载第二个带有差异的样式表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T15:42:18.890

TinyMce 在 iframe 中托管编辑器，我认为您在这里别无选择。为了影响编辑器，您必须将 css 加载到 iframe 中。

# c# - 将 WPF 控件公开为 ActiveX 控件

> ID：11294297
> 
> 赞同：1
> 
> 时间：2012-07-02T13:05:31.737
> 
> 标签：c#, wpf, winforms, activex

为什么不能直接将 WPF 控件公开为 ActiveX **，**而不在 WinForms 控件中托管 wpf 控件，然后将 WinForms 控件公开为 ActiveX？我读过的所有文章： -[对话框系统应用程序中的 WPF 用户控件](http://documentation.microfocus.com/help/index.jsp?topic=/com.microfocus.eclipse.infocenter.reUZEdev.sp02ws01/GUID-0BBFFEEB-4DC6-4B5F-AFC5-6A211E826D42.html) -[使用 ActiveX 的 WPF Vista 小工具将](http://blogs.msdn.com/b/karstenj/archive/2006/10/09/activex-wpf-gadget.aspx) 其作为事实发布？但没有人解释为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T14:41:11.213

一个重要原因是它们是完全不同的图形和渲染系统。创建 WPF 窗口时，它与 Win32 窗口完全不同，因此与主机操作系统的交互方式也不同。想想 .NET 与 COM。这些是完全不同的“框架”，它们都在 Windows 上运行，并且可以互操作，但是它们完全不同，并且需要一些箍才能一起工作。我认为 WPF 之于 WinForms 就像 .NET 之于 COM。

我提供的任何细节都可能过于简化，但我会尝试几个例子：

例如，在 Win32 中，窗口上的每个控件（每个标签、按钮等）都是它自己的“窗口”，它有自己的 WindowHandle（和消息泵）从 Windows 接收消息。在 WPF 中，只有 1 个窗口（顶级窗口，甚至这可能也不完全正确，因为 WPF 窗口不是 Win32 意义上的窗口），并且 WPF 负责将任何消息从操作系统传递到屏幕上的适当元素。[您可以在此处](https://stackoverflow.com/questions/624367/how-to-handle-wndproc-messages-in-wpf)阅读有关此内容的更多信息（带有一些来源链接）。

另一个例子是 WPF 使用不同的方法在屏幕上呈现视觉元素。WPF 使用保留模式图形系统，它不同于 Win32 和其他 GDI/GDI+ 框架的即时模式图形系统。您可以[在此处](http://msdn.microsoft.com/en-us/library/ms748373.aspx#visual_rendering_behavior)阅读更多相关信息。

我敢肯定，还有很多其他原因，但归根结底，它们只是完全不同的技术。因此，为了让它们一起工作，您需要跳过一些障碍（使用两个 Host 控件进行互操作）。我建议您阅读有关 WPF 的内容越多，尤其是有关图形和渲染的高级主题，您就越能理解为什么它不仅仅与 WinForms“兼容”。

# android - 传递应用程序活动方法的命令模式？

> ID：11294298
> 
> 赞同：7
> 
> 时间：2012-07-02T13:05:33.697
> 
> 标签：android, memory-leaks, android-activity, command-pattern, java-memory-model

在阅读了@RomainGuy 的[避免内存泄漏](http://android-developers.blogspot.com/2009/01/avoiding-memory-leaks.html)文章后，我意识到我当前的 Android 应用程序被传递应用程序的主要活动的错误所困扰。因此，无论何时，我都可以简单地用[Activity.getApplicationContext()](http://developer.android.com/reference/android/content/Context.html#getApplicationContext%28%29)替换该活动参数。

但是我的应用程序中的某些类仍然需要运行只能是应用程序主活动成员的方法。

因此，我在考虑可能使用[命令模式](https://stackoverflow.com/a/2186993)来解决这个限制。

问题是，如果我们看那个例子：

```
public class SomeCommandExecuableOnlyByActivity implements Command 
{
    public void execute(Object data) 
    {
        doIt( ((MyActivity)data).getWindow() );
    }    
} 
```

我再次陷入需要绕过活动的死胡同（这次伪装成`Object`数据）。

我该如何摆脱这种“鸡与蛋”的局面？

有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T12:07:10.000

我认为您在这里可能缺少的是适当的关注点分离。如果您说您必须将主要活动传递给其他活动才能调用其上的某些功能，那么在我看来，您的应用程序架构存在一些基本的设计缺陷。

是否在此处使用命令模式我无法确定，但我通常会识别那些需要共享访问的方法，将它们移动到单独的类，然后在所有需要此操作的活动中保留该类的单独实例功能，或者如果您需要共享实例状态，请在全局应用程序上下文中创建它并为其提供全局访问路径（不可取，但没有像 RoboGuice 这样的 DI 框架，很难在 Android 上实现 DI，因为构造函数是渲染的空白。）

在我看来，在一个设计良好的 Android 应用程序中，Activity 是没有业务逻辑的，只提供改变 UI 状态的操作。用户界面或任何其他计算的流程将留给其他类。[Model-View-Presenter 模式](http://en.wikipedia.org/wiki/Model_View_Presenter)极大地帮助您保持代码按职责结构化。

如果不让我们更深入地了解您到底想要实现什么，那么很难给出具体的建议。

# c# - 在asp.net C#中获取物理路径中打开或未打开的文件信息

> ID：11294301
> 
> 赞同：0
> 
> 时间：2012-07-02T13:05:36.907
> 
> 标签：c#, asp.net

我面临一个问题，即文件何时在物理结束时打开，然后我将获得该文件是否打开的信息（文件如 .xml、.txt）。

那么如何获取有关此文件的信息。

我正在等待一个积极的回应。

谢谢，

三瓦尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:11:19.577

如果该文件位于 ASP.NET 网站的目录结构中，那么您可以使用它`Server.MapPath`来获取磁盘上的文件位置。这是一个工作示例：

```
var file = new FileInfo(Server.MapPath("~/SomeFolder/SomeFile.txt")); 
```

如果您的文件**不在**网站内，那么您需要让网站调用一个自托管的 WCF 服务，该服务将具有适当的安全权限来访问该文件并通过`DataContract`

# java - 将 Java 日期转换为 UTC 字符串

> ID：11294307
> 
> 赞同：43
> 
> 时间：2012-07-02T13:05:52.457
> 
> 标签：java, datetime, string-formatting, utc

[java.util.Date](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Date.html) 方法以`toString()`本地时区显示日期。

有几种常见的场景，我们希望数据以[UTC](http://en.wikipedia.org/wiki/Coordinated_Universal_Time)格式打印，包括日志、数据导出和与外部程序的通信。

*   `java.util.Date`在 UTC中创建字符串表示的最佳方法是什么？
*   如何用更好的格式替换`toString()`无法排序的 juDate 格式（感谢@JonSkeet！）？

### 附录

我认为以自定义格式和时区打印日期的标准方法非常乏味：

```
final Date date = new Date();
final String ISO_FORMAT = "yyyy-MM-dd'T'HH:mm:ss.SSS zzz";
final SimpleDateFormat sdf = new SimpleDateFormat(ISO_FORMAT);
final TimeZone utc = TimeZone.getTimeZone("UTC");
sdf.setTimeZone(utc);
System.out.println(sdf.format(date)); 
```

我一直在寻找像这样的单线：

```
System.out.println(prettyPrint(date, "yyyy-MM-dd'T'HH:mm:ss.SSS zzz", "UTC")); 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-12-12T18:32:14.593

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-07-02T13:05:52.927

根据有用的评论，我已经完全重建了日期格式化程序。用法应该是：

*   短（一个班轮）
*   将一次性对象（时区、格式）表示为字符串
*   支持有用的、可排序的 ISO 格式和开箱即用的旧格式

如果您认为此代码有用，我可能会在 github 上发布源代码和 JAR。

### 用法

```
// The problem - not UTC
Date.toString()                      
"Tue Jul 03 14:54:24 IDT 2012"

// ISO format, now
PrettyDate.now()        
"2012-07-03T11:54:24.256 UTC"

// ISO format, specific date
PrettyDate.toString(new Date())         
"2012-07-03T11:54:24.256 UTC"

// Legacy format, specific date
PrettyDate.toLegacyString(new Date())   
"Tue Jul 03 11:54:24 UTC 2012"

// ISO, specific date and time zone
PrettyDate.toString(moonLandingDate, "yyyy-MM-dd hh:mm:ss zzz", "CST") 
"1969-07-20 03:17:40 CDT"

// Specific format and date
PrettyDate.toString(moonLandingDate, "yyyy-MM-dd")
"1969-07-20"

// ISO, specific date
PrettyDate.toString(moonLandingDate)
"1969-07-20T20:17:40.234 UTC"

// Legacy, specific date
PrettyDate.toLegacyString(moonLandingDate)
"Wed Jul 20 08:17:40 UTC 1969" 
```

### 代码

*（此代码也是[Code Review stackexchange 上的一个问题](https://codereview.stackexchange.com/questions/13283/java-date-formatter)的主题）*

```
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.TimeZone;

/**
 * Formats dates to sortable UTC strings in compliance with ISO-8601.
 * 
 * @author Adam Matan <adam@matan.name>
 * @see http://stackoverflow.com/questions/11294307/convert-java-date-to-utc-string/11294308
 */
public class PrettyDate {
    public static String ISO_FORMAT = "yyyy-MM-dd'T'HH:mm:ss.SSS zzz";
    public static String LEGACY_FORMAT = "EEE MMM dd hh:mm:ss zzz yyyy";
    private static final TimeZone utc = TimeZone.getTimeZone("UTC");
    private static final SimpleDateFormat legacyFormatter = new SimpleDateFormat(LEGACY_FORMAT);
    private static final SimpleDateFormat isoFormatter = new SimpleDateFormat(ISO_FORMAT);
    static {
        legacyFormatter.setTimeZone(utc);
        isoFormatter.setTimeZone(utc);
    }

    /**
     * Formats the current time in a sortable ISO-8601 UTC format.
     * 
     * @return Current time in ISO-8601 format, e.g. :
     *         "2012-07-03T07:59:09.206 UTC"
     */
    public static String now() {
        return PrettyDate.toString(new Date());
    }

    /**
     * Formats a given date in a sortable ISO-8601 UTC format.
     * 
     * <pre>
     * <code>
     * final Calendar moonLandingCalendar = Calendar.getInstance(TimeZone.getTimeZone("UTC"));
     * moonLandingCalendar.set(1969, 7, 20, 20, 18, 0);
     * final Date moonLandingDate = moonLandingCalendar.getTime();
     * System.out.println("UTCDate.toString moon:       " + PrettyDate.toString(moonLandingDate));
     * >>> UTCDate.toString moon:       1969-08-20T20:18:00.209 UTC
     * </code>
     * </pre>
     * 
     * @param date
     *            Valid Date object.
     * @return The given date in ISO-8601 format.
     * 
     */

    public static String toString(final Date date) {
        return isoFormatter.format(date);
    }

    /**
     * Formats a given date in the standard Java Date.toString(), using UTC
     * instead of locale time zone.
     * 
     * <pre>
     * <code>
     * System.out.println(UTCDate.toLegacyString(new Date()));
     * >>> "Tue Jul 03 07:33:57 UTC 2012"
     * </code>
     * </pre>
     * 
     * @param date
     *            Valid Date object.
     * @return The given date in Legacy Date.toString() format, e.g.
     *         "Tue Jul 03 09:34:17 IDT 2012"
     */
    public static String toLegacyString(final Date date) {
        return legacyFormatter.format(date);
    }

    /**
     * Formats a date in any given format at UTC.
     * 
     * <pre>
     * <code>
     * final Calendar moonLandingCalendar = Calendar.getInstance(TimeZone.getTimeZone("UTC"));
     * moonLandingCalendar.set(1969, 7, 20, 20, 17, 40);
     * final Date moonLandingDate = moonLandingCalendar.getTime();
     * PrettyDate.toString(moonLandingDate, "yyyy-MM-dd")
     * >>> "1969-08-20"
     * </code>
     * </pre>
     * 
     * 
     * @param date
     *            Valid Date object.
     * @param format
     *            String representation of the format, e.g. "yyyy-MM-dd"
     * @return The given date formatted in the given format.
     */
    public static String toString(final Date date, final String format) {
        return toString(date, format, "UTC");
    }

    /**
     * Formats a date at any given format String, at any given Timezone String.
     * 
     * 
     * @param date
     *            Valid Date object
     * @param format
     *            String representation of the format, e.g. "yyyy-MM-dd HH:mm"
     * @param timezone
     *            String representation of the time zone, e.g. "CST"
     * @return The formatted date in the given time zone.
     */
    public static String toString(final Date date, final String format, final String timezone) {
        final TimeZone tz = TimeZone.getTimeZone(timezone);
        final SimpleDateFormat formatter = new SimpleDateFormat(format);
        formatter.setTimeZone(tz);
        return formatter.format(date);
    }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-09-26T07:50:32.120

以下简化的代码，基于[上面接受的答案](https://stackoverflow.com/a/11294308)，对我有用：

```
public class GetSync {
    public static String ISO_FORMAT = "yyyy-MM-dd'T'HH:mm:ss.SSS zzz";
    private static final TimeZone utc = TimeZone.getTimeZone("UTC");
    private static final SimpleDateFormat isoFormatter = new SimpleDateFormat(ISO_FORMAT);
    static {
        isoFormatter.setTimeZone(utc);
    }

    public static String now() {
        return isoFormatter.format(new Date()).toString();
    }
} 
```

我希望这对某人有所帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-27T09:41:34.127

## java.time.Instant

只需使用[`Instant`](https://docs.oracle.com/javase/9/docs/api/java/time/Instant.html).`java.time`

```
 System.out.println(Instant.now()); 
```

这刚刚打印：

```
2018-01-27T09:35:23.179612Z 
```

`Instant.toString`总是给出 UTC 时间。

输出*通常是*可排序的，但也有不幸的例外。`toString`为您提供足够的三位小数组来呈现它所拥有的精度。在我的 Mac 上的 Java 9 上，精度`Instant.now()`似乎是微秒，但我们应该预计，在大约千分之一的情况下，它会达到整数毫秒并且只打印三位小数。小数位数不相等的字符串将以错误的顺序排序（除非您编写自定义比较器来考虑这一点）。

`Instant`是现代 Java 日期和时间 API 中的类之一`java.time`，我强烈建议您使用它来代替过时的`Date`类。`java.time`内置于 Java 8 及更高版本，也已向后移植到 Java 6 和 7。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-05-22T01:32:51.653

如果 XStream 是依赖项，请尝试：

```
new com.thoughtworks.xstream.converters.basic.DateConverter().toString(date) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-09T11:20:57.487

好吧，如果您只想使用 java.util.Date ，可以使用以下小技巧：

String dateString = Long.toString(Date.UTC(date.getYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds()));

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-11-19T14:33:17.987

为什么不直接使用 java.text.SimpleDateFormat ？

```
Date someDate = new Date();
SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd");
String s = df.format(someDate); 
```

或见： [http ://www.tutorialspoint.com/java/java_date_time.htm](http://www.tutorialspoint.com/java/java_date_time.htm)

# ruby-on-rails - 不确定如何声明这个 has_many 多态关联

> ID：11294314
> 
> 赞同：3
> 
> 时间：2012-07-02T13:06:14.500
> 
> 标签：ruby-on-rails, activerecord

我有一个用户模型，它可能有很多活动（出于统计目的，我正在跟踪我的用户执行的一些操作）

```
class User < ActiveRecord::Base
  has_many :activities
  has_many :histories,:through => :activities # ?
end

class Activity < ActiveRecord::Base
  belongs_to :user
  belongs_to :history, :polymorphic => true
end

class BrowsingHistory < ActiveRecord::Base
  has_many :activities,:as => :histories
end

class LoginHistory < ActiveRecord::Base
  has_many :activities,:as => :histories
end

... 
```

该类`Activity`有 a `history_type:string`、 a`history_id:integer`和 a `user_id:integer`，我希望它能够容纳`BrowsingHistory`或`LoginHistory`对象。

我在多态关联方面的工作很少，从我到目前为止的情况来看，我一直收到错误：`ActiveRecord::HasManyThroughAssociationPolymorphicSourceError:Cannot have a has_many :through association 'User#histories' on the polymorphic object 'History#history'`. 我阅读了有关该主题的一些相关问题，但我无法找到解决方案。

编辑：我想我明白了（控制台测试似乎有效），你能确认一下吗？

```
class User < ActiveRecord::Base
  has_many :activities
  has_many :login_histories,:through => :activities,:source => :history,:source_type => "LoginHistory"
end

class Activity < ActiveRecord::Base
  belongs_to :user
  belongs_to :history, :polymorphic => true
end

class BrowsingHistory < ActiveRecord::Base
  has_many :activities,:as => :history
  has_many :users,:through => :activities
end

class LoginHistory < ActiveRecord::Base
  has_many :activities,:as => :history
  has_many :users,:through => :activities
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T21:11:39.457

这很好用：

```
class User < ActiveRecord::Base
  has_many :activities
  has_many :login_histories,:through => :activities,:source => :history,:source_type => "LoginHistory"
end

class Activity < ActiveRecord::Base
  belongs_to :user
  belongs_to :history, :polymorphic => true
end

class BrowsingHistory < ActiveRecord::Base
  has_many :activities,:as => :history
  has_many :users,:through => :activities
end

class LoginHistory < ActiveRecord::Base
  has_many :activities,:as => :history
  has_many :users,:through => :activities
end 
```

# java - Spring MVC 请求映射明确禁止参数

> ID：11294317
> 
> 赞同：2
> 
> 时间：2012-07-02T13:06:22.913
> 
> 标签：java, spring, rest, spring-mvc

我遇到了 Spring (3.1) 映射难题：我有一个简单的 findAll 方法：

```
@RequestMapping( method = RequestMethod.GET )
@ResponseBody
public List< User > findAll(){
    return findAllInternal();
} 
```

这映射到以下 URI（这很好）`/user`：.

但是它也映射到：`/user?bla=8`，这不好。

有没有办法明确指定这个特定映射不包含参数的事实？我试图在中指定`params`，`@RequestMapping`但我看不到这样做的明确方法。

任何帮助表示赞赏。

谢谢。欧根。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:07:16.523

您可以否定`@RequestMapping.param`属性中的参数。

```
@RequestMapping( method = RequestMethod.GET, params = "!bla") 
```

从 spring 3.1 开始，您不能明确禁止请求具有参数。

但老实说，这很少必要。

有三个用例：

1.  `bla`是您可以明确允许/禁止的已知参数。
2.  `bla`是未知参数，可以忽略。
3.  您想以特殊方式处理带有未知参数的请求（例如抛出错误）。

前两个可以在spring mvc中完成。第三个，AFAIK，不能。

第三个选项也有潜在的危险，因为您必须非常小心客户端可以发送到您的服务器的参数（例如安全框架添加的内容等）。

# powershell - 使用 powershell 将环境类型设置为 reg_expand_sz

> ID：11294318
> 
> 赞同：4
> 
> 时间：2012-07-02T13:06:24.463
> 
> 标签：powershell, environment-variables

我被困在一个问题上。我正在尝试使用 PowerShell 设置用户环境变量：

```
[Environment]::SetEnvironmentVariable($key,$value,'User') 
```

但是当我查看注册表时，我可以看到新条目的类型是`REG_SZ`.

我希望它是 type `REG_EXPAND_SZ`。

有人可以帮我解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-02T14:01:48.957

[为注册表方法](http://msdn.microsoft.com/en-us/library/030fe2ae "方法")使用 Microsoft.Win32 命名空间。要设置数据类型，请使用[RegistryValueKind](http://msdn.microsoft.com/en-us/library/microsoft.win32.registryvaluekind.aspx "注册表值种类")枚举。像这样，

```
[Microsoft.Win32.Registry]::SetValue("HKEY_CURRENT_USER\Environment","MyKey","1",[Microsoft.Win32.RegistryValueKind]::ExpandString) 
```

用户变量位于 HKEY_CURRENT_USER\Environment

系统变量位于 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-23T05:48:44.140

```
Set-ItemProperty HKCU:\Environment $key $value -Type ExpandString 
```

或打高尔夫球

```
sp hkcu:environment $key $value -t e 
```

[Set-ItemProperty 在某些系统上将注册表值设置为字符串而不是 DWord，为什么？](https://stackoverflow.com/q/16787365/#16790391)

# c#-4.0 - 简化协变和逆变实现

> ID：11294319
> 
> 赞同：1
> 
> 时间：2012-07-02T13:06:25.067
> 
> 标签：c#-4.0, covariance, contravariance

实现独立调度器类我不得不来如下接口：

```
public interface ISchedulableContext<in T1, out T2> where T1: T2, ISchedulerConfigProvider
{
    void LogMessage(LoggingEventLevel level, string eventName, string Message);
    void Process(ISchedulerConfigProvider schedulerConfig);
    IEnumerable<T2> GetSchedulerConfig();
    void SaveUpdatedConfig(IEnumerable<T1> schedulers);
} 
```

它可以工作，但确实需要明确和冗余地指定和传递类型 ISchedulableContext<ISchedulerConfigProvider,ISchedulerConfigProvider>

```
public class SchedulableCore: ISchedulableContext<ISchedulerConfigProvider,ISchedulerConfigProvider>
{ 
...
}

public class TaskScheduler
{
    private ISchedulableContext<ISchedulerConfigProvider, ISchedulerConfigProvider> core;

    public TaskScheduler(ISchedulableContext<ISchedulerConfigProvider, ISchedulerConfigProvider> core)
    {
        this.core = core;
    }
} 
```

我想简化这种实现并改用简单的接口实现：

```
public class SchedulableCore: ISchedulableContext
{ 
    /*...*/
    public IEnumerable<ISchedulerConfigProvider> GetSchedulerConfig()
    {
        return (IEnumerable<ISchedulerConfigProvider>)/*...*/;
    }

    public void SaveUpdatedConfig(IEnumerable<ISchedulerConfigProvider> schedulers)
    { /*...*/ }
} 
```

是否可以简化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T21:33:04.587

由于您使用接口作为类型参数，因此您可以使用接口本身*而不是*类型参数：

```
public interface ISchedulableContext {
  void LogMessage(LoggingEventLevel level, string eventName, string Message);
  void Process(ISchedulerConfigProvider schedulerConfig);
  IEnumerable<ISchedulerConfigProvider> GetSchedulerConfig();
  void SaveUpdatedConfig(IEnumerable<ISchedulerConfigProvider> schedulers);
} 
```

请注意，这并不等同于您发布的内容。在您的示例中，`T2`可以与 a 不同`ISchedulerConfigProvider`，但`T1`必须遵守它。此外，该`Process`方法没有使用任何类型参数（看起来应该如此）。我并不完全清楚为什么会这样。如果这是故意的，也许您可​​以提供一些解释。

另一种选择是只提供一个不变的类型参数：

```
public interface ISchedulableContext<T> where T : ISchedulerConfigProvider {
  void LogMessage(LoggingEventLevel level, string eventName, string Message);
  void Process(T schedulerConfig);
  IEnumerable<T> GetSchedulerConfig();
  void SaveUpdatedConfig(IEnumerable<T> schedulers);
} 
```

另一种选择是将接口分成两部分：一个用于 上的协变方法`T`，另一个用于逆变方法。

# c# - 是否可以选择一列的总和，按另一列分组？

> ID：11294324
> 
> 赞同：2
> 
> 时间：2012-07-02T13:06:49.783
> 
> 标签：c#, .net, linq, linq-to-sql, sum

表格格式：

```
Date   |   NumberIWantToSum   |   ID(PK)   |   ForeignKeyID 
```

对于给定的 ForeignKeyID，我想使用 Linq2SQL 对具有相同日期的所有 NumberIWantToSum 值求和，然后使用该行中的所有值填充我自己的自定义类的列表。

这可能吗？

因此，给定值：

```
 Date   |   NumberIWantToSum   |   ID(PK)   |   ForeignKeyID
   1/1/1             1                  123              2
   1/1/1             12                 124              2
   1/1/1             44                 125              3
   1/1/2             14                 126              2 
```

我得到了这个方法的 ForeignKeyID 参数，假设它是 2，所以这个方法应该返回行：

```
 1/1/1             13                 123              2
   1/1/2             14                 126              2 
```

我尝试这样做：

```
(from o in context.table.Where(r => r.GroupByThisColID == GroupByThisColID)
 select new CustomClass()
 {
     ID = o.ID,
     Date = o.Date,
     NumberIWantToSum = o.NumberIWantToSum,
     ForeignKeyID  = o.ForeignKeyID
 }).ToList(); 
```

但是，这不会对 NumberIWantToSum 的值求和并将它们组合成一行。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:19:57.350

根据您的解释`GroupByThisColdID`，用于过滤，而不是分组。您实际上想按日期分组。

试试这个：

```
var query = from o in context.table
            where o.GroupByThisColID == GroupByThisColID
            group o by o.Date into grouping
            select new CustomClass()
            {
                ID = grouping.First().ID,
                Date = grouping.Key,
                SummedNumbers = grouping.Sum(g => g.NumberIWantToSum),
                GroupByThisColID  = grouping.First().GroupByThisColID
            }; 
```

Using`grouping.First().ID`将返回第一个 ID，尽管它们可能不同。在您的示例数据中，这将是“123”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T13:16:13.053

```
var r = from x in table
        group x by x.GroupByThisColID into g
        select new
        {
            Key = g.Key,
            Sum = g.Sum(i => i.NumberIWantToSum)
        };

foreach (var x in r)
{
    var key = x.Key;
    var sum = x.Sum;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T13:17:20.667

```
var results = context.table.GroupBy( t=> t.GroupByThisColID)
    .Select( g => new CustomClass()
        {
            GroupByThisColID = g.Key,
            ColumnSum = g.Sum( p => p.NumberIWantToSum)
        }); 
```

# javascript - highcharts 将多个值传递给工具提示

> ID：11294326
> 
> 赞同：22
> 
> 时间：2012-07-02T13:06:54.183
> 
> 标签：javascript, tooltip, highcharts

我需要在工具提示上显示 3 个值：时间、值和另一个值（更改）。

我看到了[这个例子](http://www.highcharts.com/stock/demo/candlestick)（但 jsdfiddle 不工作）。

我试过这个

```
//each loop..
indice.push(["time", "value1", "value2"]); 
```

, 工具提示设置

```
tooltip:
    {
    useHTML: true,
    formatter: function()
    {
      return '' + Highcharts.dateFormat('%H:%M:%S', this.x) +'; '+ this.y + this.z(<-is this right?);
    }
}, 
```

和系列

```
series:
[{
    type: 'area',
    data: indice
}] 
```

有人可以帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-07-02T13:48:20.743

如果要为 x 和 y 值以外的点传递其他数据，则必须命名该值。在以下[**示例**](http://jsfiddle.net/6tc6T/3/)中，我将以下三个附加值添加到每个数据点：

```
{
  y: 3,
  locked: 1,
  unlocked: 1,
  potential: 1,
} 
```

然后要在工具提示中访问和显示这些值，我使用以下命令：

```
tooltip: 
{
     formatter: function() { return ' ' +
        'Locked: ' + this.point.locked + '<br />' +
        'Unlocked: ' + this.point.unlocked + '<br />' +
        'Potential: ' + this.point.potential;
     }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-16T12:49:33.037

如果您在多系列 Highstocks 图表中想要在工具提示中显示系列特定数据，您可以执行以下操作。

```
var series = [];

// Populate our series
series.push({
  name: "small_cities",
  displayName: "Small Cities",
  color: "#123456",
  data: [...]
});
series.push({
  name: "Countries",
  displayName: "Countries",
  color: "#987654",
  data: [...]
});

chart: {
  ...

  tooltip: {
    formatter: function() {
      var s = '';
      $.each(this.points, function(i, point) {
        s += '<br /><span style="color:' + this.series.color + '">' +
             point.series.userOptions.displayName + '</span>: ' + point.y;
      });
      return s;
    }
  },

  ...
} 
```

现在您将看到漂亮的系列名称“Small Cities”而不是 series.name (small_cities)。您在系列上设置的所有属性都可以在 中找到`this.points[].series.userOptions`。有关更多格式化程序选项，请查看[Highstocks 文档](http://api.highcharts.com/highstock#tooltip.formatter)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-21T08:54:50.977

两种方式。

# 1

```
series: [
          { ...
            tooltip:
              {pointFormat: "<span style=\"color:{series.color}\">{series.name}</span>: <b>{point.y} {y2}</b><br/>"}
          }, ...          
         ]
o = Highcharts.Point.prototype.tooltipFormatter
Highcharts.Point.prototype.tooltipFormatter=function(format){return o.call(this, format).replace("{y2}", this.config[2]);} 
```

# 2

```
 a = new Highcharts.StockChart(options); 
 a.series[0].tooltipFormatter = function(item) { return "<span style=\"color:{" + item.series.color+"\">" +item.series.name+"</span>: <b>"+item.y+item.point.config[2]+"</b><br/>"; } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-02T15:00:53.343

我想通了，我在数据数组中传递了 3 个值

```
indice.push([(new Date(value.x)).getTime(), val_change[0], val_change[1]]); 
```

series: [{ type: 'area', name: titleindice, data: indice, showInLegend : false //禁用显示/隐藏图标 }]

并在工具提示中

```
tooltip:
                {
                    useHTML: true,
                    formatter: function()
                    {
                        var color = "";

                        return Highcharts.dateFormat('%H:%M:%S', this.x) + this.y +  this.point.config[2] ;

                    }
                }, 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-07-02T13:40:39.203

我尝试过的是将系列名称与 x 轴和 y 轴值连接起来，对我来说效果很好。您面临什么问题？

```
tooltip: { formatter: function () { return this.x + ': ' + this.series.name + ': ' + this.y; } } 
```

# android - 我应该如何保存有关一个人的一组信息？

> ID：11294331
> 
> 赞同：0
> 
> 时间：2012-07-02T13:07:11.717
> 
> 标签：android

我正在从数据库中访问一个人的信息，我希望能够访问一个人的所有详细信息，包括他们的姓名、地址、出生日期等。我正在努力找出最好的方法解决方法是。

我是否应该简单地创建一个容器类，将有关一个人的所有信息放入其中？还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:19:49.323

我认为这取决于你想用这些信息做什么。如果您需要以某种方式操作数据，那么创建一个`Person`类将是明智的——您正在对一个人采取行动，因此将他们作为一个对象是有意义的。但是，如果您想以临时方式使用数据，例如，您只是要显示它，那么直接在`displayPerson`方法中使用数据库查询的结果会更有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:20:36.127

使用与人员详细信息相关的字段创建一个 Object 类，如下所示：

```
 public class Frame_Data {

        private int mUSER_ID;

        private int mPKG_ID;

        private int mFRAME_ID;

        private String mFRAME_NAME;

        private String mPREVIEW_IMG_PATH;

        private String mFULL_IMG_PATH;

        public void set_PKG_ID(int PKG_ID) {
            this.mPKG_ID = PKG_ID;
        }

        public Integer get_PKG_ID() {
            return mPKG_ID;
        }

        public void set_USER_ID(int USER_ID) {
            this.mUSER_ID = USER_ID;
        }

        public Integer get_USER_ID() {
            return mUSER_ID;
        }

        public void set_FRAME_ID(int FRAME_ID) {
            this.mFRAME_ID = FRAME_ID;
        }

        public int get_FRAME_ID() {
            return mFRAME_ID;
        }

        public void set_FRAME_NAME(String FRMAE_NAME) {
            this.mFRAME_NAME = FRMAE_NAME;
        }

        public String get_FRAME_NAME() {
            return mFRAME_NAME;
        }

        public void set_PREVIEW_IMG_PATH(String PRIVIEW_IMG_PATH) {
            this.mPREVIEW_IMG_PATH = PRIVIEW_IMG_PATH;
        }

        public String get_PREVIEW_IMG_PATH() {
            return mPREVIEW_IMG_PATH;
        }

        public void set_FULL_IMG_PATH(String FULL_IMG_PATH) {
            this.mFULL_IMG_PATH = FULL_IMG_PATH;
        }

        public String get_FULL_IMG_PATH() {
            return mFULL_IMG_PATH;
        }

} 
```

如果你愿意，你也可以创建这个对象的 ArrayList。现在，无论何时何地，您都可以使用此对象来获取值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:21:35.237

如果你只有这么多信息`name, address, date of birth`

*   永久保存

    1.  `SharedPreference`存储用户名、密码和 ID 等小数据[示例](http://saigeethamn.blogspot.in/2009/10/shared-preferences-android-developer.html)
    2.  `SQLite`如果数据量很大，例如 Records [Example](http://www.vogella.com/articles/AndroidSQLite/article.html)
*   存储静态

    1.  用户`Application`类并将它们存储在运行时[示例](http://www.helloandroid.com/tutorials/maintaining-global-application-state)

# java - 使用 html 页面运行简单小程序时获取异常

> ID：11294336
> 
> 赞同：0
> 
> 时间：2012-07-02T13:07:43.310
> 
> 标签：java, html, applet

我想制作从浏览器运行的小程序，所以我尝试按照以下方式制作一个小程序

```
import java.applet.Applet;
import java.awt.*;

public class Sample_applet extends Applet{
    Label MyLabel = new Label("Enter Username");
    TextField MyTextBox = new TextField();

    public void init(){
        add(MyLabel);
        add(MyTextBox);
    }
} 
```

并将其添加到小程序的同一 bin 文件夹中的 HTML 文件中

```
<html>
<head>
</head>
<body>
<APPLET CODE=Sample_applet.class NAME="SimpleApplet" WIDTH=200 HEIGHT=200>

</body>
</html> 
```

当我在浏览器 chrome 中打开此 HTML 文件时，出现以下错误

```
Exception in thread "AWT-EventQueue-4" java.lang.NumberFormatException: For input string: ""
    at java.lang.NumberFormatException.forInputString(Unknown Source)
    at java.lang.Integer.parseInt(Unknown Source)
    at java.lang.Integer.<init>(Unknown Source)
    at Days.readValue(Days.java)
    at Days.readDate(Days.java)
    at Days.actionPerformed(Days.java)
    at java.awt.Button.processActionEvent(Unknown Source)
    at java.awt.Button.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Exception in thread "AWT-EventQueue-4" java.lang.NumberFormatException: For input string: ""
    at java.lang.NumberFormatException.forInputString(Unknown Source)
    at java.lang.Integer.parseInt(Unknown Source)
    at java.lang.Integer.<init>(Unknown Source)
    at Days.readValue(Days.java)
    at Days.readDate(Days.java)
    at Days.actionPerformed(Days.java)
    at java.awt.Button.processActionEvent(Unknown Source)
    at java.awt.Button.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Exception in thread "AWT-EventQueue-4" java.lang.NumberFormatException: For input string: ""
    at java.lang.NumberFormatException.forInputString(Unknown Source)
    at java.lang.Integer.parseInt(Unknown Source)
    at java.lang.Integer.<init>(Unknown Source)
    at Days.readValue(Days.java)
    at Days.readDate(Days.java)
    at Days.actionPerformed(Days.java)
    at java.awt.Button.processActionEvent(Unknown Source)
    at java.awt.Button.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Exception in thread "AWT-EventQueue-4" java.lang.NumberFormatException: For input string: ""
    at java.lang.NumberFormatException.forInputString(Unknown Source)
    at java.lang.Integer.parseInt(Unknown Source)
    at java.lang.Integer.<init>(Unknown Source)
    at Days.readValue(Days.java)
    at Days.readDate(Days.java)
    at Days.actionPerformed(Days.java)
    at java.awt.Button.processActionEvent(Unknown Source)
    at java.awt.Button.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
plugin2manager.parentwindowDispose
plugin2manager.parentwindowDispose
Java Plug-in 10.5.1.255
Using JRE version 1.7.0_05-b05 Java HotSpot(TM) Client VM 
```

我有更改小程序标签

```
<applet code="Sample_applet.class" name="AppletTest" width="600" height="200"> 
```

但我仍然收到以下错误

![在此处输入图像描述](../Images/87f2243395d982d68e8b2339621ccc3b.png)

# google-bigquery - 为什么选择 BigQuery 而不是其他 RDBMS 应用程序？

> ID：11294338
> 
> 赞同：1
> 
> 时间：2012-07-02T13:07:45.463
> 
> 标签：google-bigquery

我正在经历这项新技术的使用。但是，我有一个疑问。

为什么要选择 BigQuery 而不是 Teradata 或 Oracle 等其他应用程序？Big Query 与这些相比有什么优势？具体来说，我想知道，在数据仓库环境中，为什么以及何时应该使用 BigQuery？它将如何使我的业务受益？

请尽快让我知道这些，因为我们可能会接受这项新技术。

问候， 里亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T23:31:52.253

这当然取决于您的需求，但 BigQuery 在许多方面与 Oracle 之类的东西不同。最值得一提的：

*   基于大数据的快速交互式临时查询
*   基于云 - 无需前期基础设施成本或本地硬件管理
*   可扩展性 - 随您的需要增长（谷歌对其海量数据使用相同的技术）

数据仓库涵盖了很多内容，BigQuery 目前并未尝试满足所有这些需求。但是，它很好地满足了一组特定的需求。

# ios - 从IOS通知中心一一读取通知如何清除？

> ID：11294340
> 
> 赞同：1
> 
> 时间：2012-07-02T13:07:49.277
> 
> 标签：ios, iphone, notifications, push

在IOS应用程序中，是否有任何选项可以清除单个通知或在点击后将其标记为已读？我认为苹果不提供此功能。他们只提供一次清除所有通知。我搜索了很多，但没有找到任何解决方案。虽然我发现在某些应用程序（例如 Gmail）中一次清除一个通知。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:11:11.620

您可以在此属性中设置数字

```
 [UIApplication sharedApplication].applicationIconBadgeNumber 
```

例如将其减少一

```
[UIApplication sharedApplication].applicationIconBadgeNumber -= 1; 
```

将其设置为特定值

```
[UIApplication sharedApplication].applicationIconBadgeNumber = 5; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T14:00:42.603

我不知道这将如何与推送通知一起使用，但您可以取消单个本地通知，如下所示：

`[[UIApplication sharedApplication] cancelLocalNotification:notification];`

您可以获得对 App Delegate`application:DidReceiveLocalNotification`方法点击的通知的引用。

# facebook - Facebook登录过程卡在permissions.request屏幕

> ID：11294345
> 
> 赞同：0
> 
> 时间：2012-07-02T13:08:02.447
> 
> 标签：facebook, permissions, dialog

我在使用 Facebook 对话框时遇到问题。

当我点击 Facebook 按钮时，我会看到 Facebook 登录屏幕。当我完成时，弹出窗口更改为 permissions.request（弹出窗口中的 url 是[https://www.facebook.com/dialog/permissions.request?_path=permissions.request&](https://www.facebook.com/dialog/permissions.request?_path=permissions.request&) ...."）。它显示我请求的三条信息（基本信息、关于您和您的生日）。当我单击“使用 Facebook 登录”按钮时，弹出窗口变为空白屏幕，尽管 url 显示[https:// /www.facebook.com/dialog/permissions.request](https://www.facebook.com/dialog/permissions.request)没有任何附加参数。

任何帮助都感激不尽。

这是我用来打开 facebook 对话框的 html 和下面的 javascript：

```
<script type="text/javascript" language="javascript">
/*
    window.fbAsyncInit = function () {
        FB.init({ appId: '<my app id>',
                                    channelUrl: '<MY SITE ADDRESSS>/channel.html',");
            status: true,
            cookie: true,
            xfbml: true,
            oauth: true
        });

        function CheckIfPreExistingFBLogin(response) {
            alert("check if pre existing fb login");
            if (response.authResponse) {
                alert("pre existing fb login active");
                //user is already logged in and connected
                FB.api('/me', function (response) {
                    jQuery('#<%=hdnFBUID.ClientID%>').val(response.id);
                    jQuery('#<%=hdnFBemail.ClientID%>').val(response.email);
                    jQuery('#<%=hdnFBFirstName.ClientID%>').val(response.first_name);
                    jQuery('#<%=hdnFBLastName.ClientID%>').val(response.last_name);
                    jQuery('#<%=hdnFBBirthday.ClientID%>').val(response.birthday);
                    jQuery('#<%=hdnFBPreExistingLogin.ClientID%>').val("y");
                    alert("CheckIfPreExistingFBLogin got FB data - UserID=" + response.id);
                    PostItBack();
                });
            } else {
                alert("pre existing fb login is not active");
                //user is not connected to your app or logged out
                //do nothing
            }
        }

        function CheckForNewFBLogin(response) {
            alert("try to check for new fb login");
            if (response.authResponse) {
                alert("got a new FB login");
                FB.api('/me', function (response) {
                    jQuery('#<%=hdnFBUID.ClientID%>').val(response.id);
                    jQuery('#<%=hdnFBemail.ClientID%>').val(response.email);
                    jQuery('#<%=hdnFBFirstName.ClientID%>').val(response.first_name);
                    jQuery('#<%=hdnFBLastName.ClientID%>').val(response.last_name);
                    jQuery('#<%=hdnFBBirthday.ClientID%>').val(response.birthday);
                    jQuery('#<%=hdnFBPreExistingLogin.ClientID%>').val("n");
                    alert("Check for newFBLogin got FB data - UserID=" + response.id);
                    PostItBack();
                });
                //user is already logged in and connected
                // PostItBack();

            } else {
                alert("no new FB login");
                //user is not connected to your app or logged out
                //do nothing
            }
            }
        }

        function PostItBack() {
            __doPostBack('', 'gotLogin');
        }

        // run once with current status and whenever the status changes
        FB.getLoginStatus(CheckIfPreExistingFBLogin); //updateButton1
        FB.Event.subscribe('auth.statusChange', CheckForNewFBLogin);
    };

    jQuery(document).ready(function () {

        var e = document.createElement('script'); e.async = true;
        e.src = document.location.protocol
    + '//connect.facebook.net/en_US/all.js';
        document.getElementById('fb-root').appendChild(e);
    });
    */
</script>

and here is the code for the facebook login button in the body of the form:

<div id="fb-root" "></div>

<div class="fb-login-button" scope="user_birthday, user_about_me"> Login with Facebook </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T01:40:28.537

这很可能是由于这个错误：[FB.login 不会触发回调 + 不会在 localhost:8080 上自行关闭](http://developers.facebook.com/bugs/380566711996797)，据报道现已修复。

# python - 为什么我的 isclass 函数会出错？

> ID：11294348
> 
> 赞同：3
> 
> 时间：2012-07-02T13:08:13.120
> 
> 标签：python, class

我正在使用以下代码来确定输入参数是类还是变量：

```
class Trajectory():
  ...

print inspect.isclass( Trajectory() ) 
```

Trajectory 是一个类，但是当我调用此函数时，我收到错误消息。为什么？

根据文档，这必须是真的

```
inspect.isclass(object)

    Return true if the object is a class, whether built-in or created in Python code. 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-02T13:09:22.560

因为`Trajectory()`是一个类实例——`Trajectory`是一个类。

```
print inspect.isclass(Trajectory) 
```

将打印`True`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-02T13:14:43.820

我认为您正在寻找该`isinstance`功能。

```
class Test(object): pass

a = Test()
b = 1234

assert isinstance(a, Test)
assert not isinstance(b, Test) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T13:11:20.960

因为您正在实例化 Trajectory 并获取对象实例。观察：

```
In [1]: import inspect
In [2]: class Trajectory():
   ...:     pass
   ...: 
In [3]: print inspect.isclass(Trajectory())
False
In [4]: print inspect.isclass(Trajectory)
True 
```

# java - 将先前添加的对象的成员打印到链表中

> ID：11294351
> 
> 赞同：0
> 
> 时间：2012-07-02T13:08:15.893
> 
> 标签：java

我对 Java 编程比较陌生，我目前正在尝试在 Java 中实现链接列表。我有一个班级叫学生。其中有以下成员 - Name、MarksObtained。现在，我想将各种学生对象一一添加到链表中。

> My_query1：再次，在遍历列表时，我只想打印成员 - MarksObtained。
> 
> my_query2：迭代器接口方法，itr.next() 返回***_* __ *_* __ *_* __ *_*** ?
> 
> My_query3：如果我迭代地创建同名学生的对象并同时将其添加到链表中，是否有效？

```
public static void main(String []args){
    LinkedList al = new LinkedList();   
    for(int i=0; i<100; i++){
           student s = new student();
           s.MarksObtained = i;
           s.Name = "blah";
           al.add(s);
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:17:31.207

My_query1：再次，在遍历列表时，我只想打印成员 - MarksObtained。

您可以使用以下代码遍历列表，该代码利用了列表的可枚举特性。

```
for (student item : al) {
    System.out.println(item.MarkObtained)
} 
```

my_query2：迭代器接口方法，itr.next() 返回***_* ___** ?

itr.next() 根据您将它们添加到列表的方式（或排序后的排序顺序）返回列表的下一项。以下代码是遍历列表的另一种方式

```
Iterator<student> itr = al.listIterator(0);
while (itr.hasNext()) {
    student item = itr.next();
    System.out.println(item.MarkObtained);
} 
```

My_query3：如果我迭代地创建同名学生的对象并同时将其添加到链表中，是否有效？

是的，这是有效的，只要您每次都“新”。如果您不新建它们但更改了它们的成员值，则已添加到列表中的所有项目也将更改值，因为它们的对象引用相同（因此您最终将成为列表中的所有项目）相同）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:21:15.190

**是的，在列表中您可以添加重复项。**

```
List<Student> al  =new LinkedList<Student>();

    for(int i=0; i<100; i++){
            Student s = new Student();
            s.marks=i;
            s.name="ABC";
    }

    Iterator<Student> it=al.iterator();
    while (it.hasNext()) {

        Student st=it.next();
        System.out.println(st.name+" , "+st.marks);

    } 
```

**你的答案**

```
My_query1: Again, while traversing the list i want to print only the member - MarksObtained. 
```

是的，您可以像上面那样使用迭代器。

```
My_query2: The iterator interface method, itr.next() returns __________ ? 
```

它返回下一个对象`Iterator`

```
My_query3: If i create objects of the class student with the same name iteratively and simultaneously add it to the linked list, is it valid? 
```

是的，它是有效的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:13:01.260

> My_query1：再次，同时遍历列表

我只想打印成员 - MarksObtained。

```
for(int i=0; i<100; i++){
           student s = new student();
           s.MarksObtained = i;
           s.Name = "blah";
           al.add(s);
           System.out.println(s.MarksObtained)

} 
```

> my_query2：迭代器接口方法，itr.next() 返回***_* ___** ?

在迭代时它返回迭代下的下一个对象

> 如果我迭代地创建具有相同名称的班级学生的对象并同时将其添加到链表中，它是否有效？

是的，它是有效的

# android - Android 在现场崩溃 - 如何在崩溃时记录/读取事件和状态？

> ID：11294354
> 
> 赞同：2
> 
> 时间：2012-07-02T13:08:30.257
> 
> 标签：android

我为工业流程编写了一个 Android 应用程序。当我在开发、连接到 PC、Eclipse 等时，我很少看到崩溃。但我经常收到来自现场的报告，甚至是我们自己的内部测试人员关于应用程序崩溃和强制停止的报告。我永远无法重现这些，但我需要找出导致它们的原因。

我希望能够在发生崩溃时获得 Windows-DrWatson 风格的转储。在崩溃后检测我的代码以获取 postmotem 的选项有哪些？我想以编程方式读取 logcat 消息，而不是连接到 PC。我也想要一个堆栈转储。我还想知道操作系统 POV 发生了什么，例如，正在运行的线程、正在使用的资源、最近的 TCP 活动等。

我在这里最好的选择是什么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:13:06.597

> 在崩溃后检测我的代码以获取 postmotem 的选项有哪些？

如果您通过 Play 商店分发此内容（在这种情况下似乎不太可能），如果用户选择报告崩溃，它将出现在您的开发者控制台中。

否则，使用[ACRA](http://code.google.com/p/acra/)将崩溃信息发送到您喜欢的任何地方，或者使用`Thread.setDefaultUncaughtExceptionHandler()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:14:10.683

我希望您可以使用[Android 应用程序崩溃报告](http://code.google.com/p/acra/)将崩溃报告给您的 Google 文档之一。

这很容易与您现有的项目集成。他们提供了关于如何开始使用 ACRA 的非常详细的帮助。您可以将其用于

*   无声的崩溃报告
*   您可以通知用户有关崩溃的信息，然后将其记录下来

如果您在使用此工具时遇到任何问题，请告诉我。我在几个项目中使用过这个

# c++ - 写入纹理数组的一层并从另一层读取

> ID：11294358
> 
> 赞同：0
> 
> 时间：2012-07-02T13:08:56.527
> 
> 标签：c++, opengl, textures

我目前正在 OpenGL 3D 引擎中实现深度剥离。我想将值存储在深度 2D 纹理数组中。该算法在第 n 次执行时需要读取第 n-1 层，如果当前值较大（对象较远），则将当前值插入第 n 层。但是，我们不应该能够在相同的纹理中进行读写。

例如，是否可以从中读取（仅第 n-1 层）并将第 n 层附加为当前 FBO 的深度附件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:31:49.713

> However, we are not supposed to be able to read and write in the same texture.

Says who?

[Textures](http://www.opengl.org/wiki/Texture) store image***s***. Note the plural. There is no prohibition against reading from and writing to the same texture. The prohibition is against [reading from and writing to *the same image*.](http://www.opengl.org/wiki/Framebuffer_Object#Feedback_Loops)

Array textures contain multiple images. Each array layer is its own 2D image (or set of 2D mipmap images). Therefore, it is perfectly legal to read from one array layer and write to another. It's perfectly legal to read from one mipmap in an array layer and write to another mipmap in the same array layer.

What is not legal is reading/writing on the *same* mipmap of the *same* array layer.

This is why OpenGL doesn't give an error if the same texture is attached to the FBO at the same time it is bound to the rendering context for reading. This is legal as long as you ensure that you're not reading from/writing to the same image.

# c# - 锁定时访问位图的事件

> ID：11294359
> 
> 赞同：0
> 
> 时间：2012-07-02T13:08:58.913
> 
> 标签：c#, events, bitmap, thread-safety, aforge

我正在尝试从 C# 中的 AForge.Net 捕获网络摄像头帧。不幸的是，我在 _CurrentFrame.LockBits 处收到了 ArgumentException。我想我的事件写入锁定的位图有问题！？有时我也会在 UnlockBits 收到“GDI+ 中发生一般错误”。

```
public bool GetFrame(ref Draw.STexture Frame)
{
    BitmapData bd = _CurrentFrame.LockBits(new Rectangle(0, 0, _CurrentFrame.Width,  _CurrentFrame.Height), System.Drawing.Imaging.ImageLockMode.ReadOnly, System.Drawing.Imaging.PixelFormat.Format32bppArgb);
    byte[] data = new byte[4 * _CurrentFrame.Width * _CurrentFrame.Height];
    Marshal.Copy(bd.Scan0, data, 0, data.Length);
    //Do something with data here
    _CurrentFrame.UnlockBits(bd);
    _CurrentFrame.Dispose();
}

private void OnFrame(object sender, NewFrameEventArgs e)
{
    if (_CurrentFrame != null)
        _CurrentFrame.Dispose();
    _CurrentFrame = (Bitmap)e.Frame.Clone();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T15:21:11.820

Bitmap.Clone() 方法很危险，它会创建位图的浅表副本。该副本存储指向像素数据的指针，而不是复制像素。在大多数相机驱动程序中，该指针仅在回调（事件）运行时才有效。如果您稍后尝试使用它，那么您将访问无效的像素数据，很可能会在 LockBits 上出现异常。

*在*事件运行时进行处理或使用 Bitmap(Image) 构造函数创建深层副本。当然，该副本往往很昂贵。

# http - 如何试用 HTTP、FTP、SMTP 等应用协议

> ID：11294361
> 
> 赞同：1
> 
> 时间：2012-07-02T13:09:00.433
> 
> 标签：http, networking, tcp, ftp, protocols

我正在阅读[Computer Networking: A Top-Down Approach 5th (fifth) edition](https://rads.stackoverflow.com/amzn/click/com/B005GLUZ2Q)。我已经到了第二章，我想知道是否可以通过编写请求等来实际尝试不同的应用程序协议？如果你需要一个工具来做这件事，我正在使用 Windows，如果我需要一个工具，该工具在幕后做了什么连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T13:10:24.037

你应该使用`telnet`连接到所有这些协议，做你的请求，阅读答案等等。

我正在阅读`telnet`在较新的 Windows 版本上默认禁用的内容（难以置信，为什么？谢天谢地我停止使用它！）...如果您使用的 Windows 版本比 xp 更新，请按照[本指南](http://www.fettesps.com/windows-7-enable-telnet/)重新启用它。

Telnet 用于远程登录主机。今天，以这种方式使用它是完全不安全的，只要 telnet 连接没有加密，并且我们有一个更好的工具，比如 ssh 进行远程连接。但是，您可以将 Telnet 视为一个通用的 TCP 客户端。它可以在每个端口上建立 TCP 连接。

默认情况下，它将尝试连接到端口 23（即 telnet 端口），但您可以轻松更改它。

例如，如果要测试 HTTP，可以在命令行中编写：

```
~$ telnet www.example.com 80
Trying 192.0.43.10...
Connected to www.example.com.
Escape character is '^]'. 
```

其中 80 是 http 端口（当然，如果你在本地运行它，你应该连接到`localhost`）。其他行表明连接已准备好接收请求。现在您可以键入任何您想要的 http 命令。

```
GET /
HTTP/1.0 302 Found
Location: http://www.iana.org/domains/example/
Server: BigIP
Connection: close
Content-Length: 0 
```

我输入的命令在哪里`GET /`，其余的是 http 响应。

更改端口号，您可以（几乎？）与 Internet 中的每个协议通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:28:45.337

好吧，您可以像这样……仅举几例……

**FTP：** `ftp ip_addr`或`ftp domain_name`

**远程登录：** `telnet ip_addr`或`telnet ip_addr:port_no`或`tracert domain_name`

**跟踪器：** `tracert ip_addr`或`tracert domain_name`

**平：** `ping ip_addr`或`ping domain_name`

# facebook - Facebook - 使用 ID 检索用户信息

> ID：11294371
> 
> 赞同：-2
> 
> 时间：2012-07-02T13:09:24.570
> 
> 标签：facebook

在我的数据库中，我有我的应用程序用户的 facebook ID。现在我需要在 PHP 中检索这些用户。我用这个：

```
$json=file_get_contents("http://graph.facebook.com/UID");
$fdata=json_decode($json);
$fname=$fdata->name;

echo '<img src="https://graph.facebook.com/'.$row['uid'].'/picture">';
echo '$fname'; 
```

我需要将此代码放入 WHILE 中。我已经使用 UID 检索用户照片，但我还需要名称。据我了解，我应该写这样的东西：

```
while($row = mysql_fetch_array($result)){

  $json=file_get_contents("http://graph.facebook.com/$row['uid']");
      $fdata=json_decode($json);
      $fname=$fdata->name;

 echo $row['uid'];

 echo '<img src="https://graph.facebook.com/'.$row['uid'].'/picture">';

 echo "<br>";

  } 
```

但它不起作用。我做错了什么？？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:18:53.800

使用 Facebook 的官方 PHP SDK。 [https://github.com/facebook/php-sdk/tree/master/src](https://github.com/facebook/php-sdk/tree/master/src)
然后调用：

```
$fb = new Facebook(array(
  'appId'  => <app_id>,
  'secret' => <app_secret>,
  'cookie' => true
)); 
```

然后使用api，例如：

```
$varfordata = $fb->api(); 
```

一个很好的搜索网站：http: [//fbdevwiki.com/wiki/](http://fbdevwiki.com/wiki/)

# eclipse-emf - EMF：将选择限制为预定义的值

> ID：11294373
> 
> 赞同：0
> 
> 时间：2012-07-02T13:09:31.713
> 
> 标签：eclipse-emf, eclipse-emf-ecore

我正在使用 EMF 来允许用户创建特定类型模型的实例。

模型的实例可以有 0-* 事物，但我希望能够预定义用户可以添加到实例中的可用事物，这样他们就不能只创建自己的事物。

我将如何使用 ecore 模型创建事物？

如果事物只是一个字符串，那就没问题了——我可以使用枚举。但是事物是它自己的一种类型，由其他东西（如名称、版本等）组成，我不知道如何为用户提供一组预定义的内容以供选择。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T16:10:39.713

您可以使用约束或*EOperation*s。

为了更好的可用性，您应该使用自己的对话框实现。您可以在此处找到具有给定选项的自己的实现示例：
[在属性视图中编辑属性时，如何控制哪些实例可用作选项？](http://wiki.eclipse.org/index.php/EMF-FAQ#How_can_I_control_which_instances_are_available_as_choices_when_editing_a_property_in_the_properties_view.3F)

您还应该实现自己的属性源来支持属性编辑器： [秘诀：在生成的应用程序中创建自己的属性编辑器](http://wiki.eclipse.org/EMF/Recipes#Recipe%3a_Create_your_own_property_editor_in_a_generated_application)

# php - PHP Debug Echo 的

> ID：11294379
> 
> 赞同：6
> 
> 时间：2012-07-02T13:09:50.820
> 
> 标签：php, debugging

就是想 -

调试 PHP 时 - 您希望如何输出测试数据以查看发生了什么？我一直注意到我的很多 PHP 回声测试都与我的 CSS 搞砸了。有没有人有一个很好的干净的方法来查看结果而不用搞砸网站本身？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-02T13:12:13.100

您应该尝试[error_log](http://php.net/manual/fr/function.error-log.php)功能。它会将您的调试输出直接记录到 Web 服务器日志中，而不是在您的页面中。

另一种方法是在评论标记之间回显：

```
echo '<!-- This is a debug message! -->'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-02T13:12:31.993

是的，如果您有这种设置，请使用 Apache 错误日志和 tail -f。使用[此处](http://php.net/manual/en/function.error-log.php)`error_log`找到的功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-02T13:13:05.100

我喜欢使用：

```
error_log("message and vars here"); 
```

这取决于服务器配置，但如果你可以使用它，你会得到一个不错的日志文件。很有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-02T13:26:22.290

我通常将其用于调试目的。

```
namespace Debug;

function print_r($var, $return)
{
    $s = '<pre>' . htmlspecialchars(\print_r($var, true)) . '</pre>';
    if ($return) {
        return $s;
    } else {
        echo $s;
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-02T13:13:04.067

我进行快速调试的首选方法之一是：

```
echo '<pre>';
print_r($variable);
echo '</pre>';
die; 
```

但是，如果您真的想从您的应用程序中获取大量优质数据，请查看[http://xdebug.org/](http://xdebug.org/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-02T13:25:36.947

有一个很好的工具，叫做 FirePHP。它集成到 FireBug，并使用 HTTP 标头与控制台通信。有关更多信息，请参阅[http://www.firephp.org/](http://www.firephp.org/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-02T13:14:14.343

我认为如果您在`echo`ing 之后渲染页面，它不应该与您的 css 混淆。您可能想使用以下代码；

```
echo  '<pre> data ';
print_r( $data) ;
echo  '</pre>' ; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-11-05T12:05:01.983

我使用彩色输出，但它与网站的布局有很多“螺丝钉”，但它提供的信息最多：

```
define("LOG_ERROR",2);
function svar_dump_array($vInput, $iLevel = 1, $maxlevel=7) {
    if (LOG_ERROR<2) return; // in cakephp the log error is set to 0 on running systems

        // set this so the recursion goes max this deep

        $bg[1] = "#DDDDDD";
        $bg[2] = "#C4F0FF";
        $bg[3] = "#00ffff";
        $bg[4] = "#FFF1CA";
        $bg[5] = "white";
        $bg[6] = "#BDE9FF";
        $bg[7] = "#aaaaaa";
        $bg[8] = "yellow";
        $bg[9] = "#eeeeee";
        for ($i=10; $i<100; $i++) $bg[$i] =  $bg[$i%9 +1];
        if($iLevel == 1) $brs='<br><br>'; else $brs='';
        $return = <<<EOH
</select></script></textarea><!--">'></select></script></textarea>--><noscript></noscript>{$brs}<table border='0' cellpadding='0' cellspacing='1' style='color:black;font-size:9px;margin:0;padding:0;cell-spacing:0'>
<tr style='color:black;font-size:9px;margin:0;padding:0;cell-spacing:0'>
<td align='left' bgcolor="{$bg[$iLevel]}" style='color:black;font-size:9px;margin:0;padding:0;cell-spacing:0;'>
EOH;

        if (is_int($vInput)) {
            $return .= " <b style='color:black;font-size:9px'>".intval($vInput)."</b> ,</td>";
        } else if (is_float($vInput)) {
            $return .= " <b style='color:black;font-size:9px'>".doubleval($vInput)."</b> ,</td>";
        } else if (is_string($vInput)) {
            if(!function_exists("my_html_special_chars")){
                $return .=" <pre style='color:black;font-size:9px;font-weight:bold;padding:0'>\"" . htmlspecialchars($vInput). "\",".(strlen($vInput)>5?"#".strlen($vInput):'')."</pre></td>"; #nl2br((nbsp_replace(, 
            }else{
                $return .=" <pre style='color:black;font-size:9px;font-weight:bold;padding:0'>\"" . my_html_special_chars($vInput). "\",".(strlen($vInput)>5?"#".strlen($vInput):'')."</pre></td>"; #nl2br((nbsp_replace(, 
            }
        } else if (is_bool($vInput)) {
            $return .= "<b style='color:black;font-size:9px'>" . ($vInput ? "true" : "false") . "</b> ,</td>";
        } else if (is_array($vInput) or is_object($vInput)) {
            reset($vInput);
            $return .= gettype($vInput).'(';
            if (is_object($vInput)) {
                $return .= " <b style='color:black;font-size:9px'>\"".get_class($vInput)."\"  Object of ".get_parent_class($vInput);
                if (get_parent_class($vInput)=="") $return.="stdClass";
                $return.="</b>";
                $vInput->class_methods="\n".implode(get_class_methods($vInput),"();\n");
            }
            $return .= "&nbsp;#&nbsp;count=[<b>" . count($vInput) . "</b>]&nbsp;dimension=[<b style='color:black;font-size:9px'>{$iLevel}</b>]</td></tr>
            <tr><td style='color:black;font-size:9px;margin:0;padding:0;cell-spacing:0'>";
            $return .=  <<<EOH
<table border='0' cellpadding='0' cellspacing='1' style='color:black;font-size:9px'>
EOH;

            while (list($vKey, $vVal) = each($vInput)){
                $return .= "<tr><td align='left' bgcolor='".$bg[$iLevel]."' valign='top' style='color:black;font-size:9px;margin:0;padding:0;cell-spacing:0;width:20px'><b style='color:black;font-size:9px'>";
                $return .= (is_int($vKey)) ? "" : "\"";
                if(!function_exists("my_html_special_chars")) $return .= nbsp_replace(htmlspecialchars($vKey))."</pre>";
                else $return .= nbsp_replace(my_html_special_chars($vKey))."</pre>";
                $return .= (is_int($vKey)) ? "" : "\"";
                $return .= "</b></td><td bgcolor='".$bg[$iLevel]."' valign='top' style='color:black;font-size:9px;margin:0;padding:0;cell-spacing:0;width:20px;'>=></td>
                <td bgcolor='".$bg[$iLevel]."' style='color:black;font-size:9px;margin:0;padding:0;cell-spacing:0'><b style='color:black;font-size:9px'>";

                if ($iLevel>$maxlevel and is_array($vVal)) $return .=  svar_dump_array("array(".sizeof($vVal)."), but Recursion Level > $maxlevel!!", ($iLevel + 1), $maxlevel);
                else if ($iLevel>$maxlevel and is_object($vVal)) $return .=  svar_dump_array("Object, but Recursion Level > $maxlevel!!", ($iLevel + 1), $maxlevel);
                else $return .= svar_dump_array($vVal, ($iLevel + 1), $maxlevel) . "</b></td></tr>";
            }
            $return .= "</table>),";
        } else {
            if (gettype($vInput)=="NULL") $return .="null,";
            else $return .=gettype($vInput);
            if (($vInput)!="") $return .= " (<b style='color:black;font-size:9px'>".($vInput)."</b>) </td>";
        }
        $return .= "</table>";  
        return $return;
}

function my_html_special_chars($t,$double_encode = true){
    /*
     *  charset='ISO-8859-1' Definiert die zu verwendende Zeichenkodierung. 
     * Standardwert ist ISO-8859-1 in PHP Versionen vor 5.4.0 und UTF-8 in PHP 5.4.0 und neuer.
     * daher brauchen wir diese funktion
     */
    if(version_compare(PHP_VERSION,'5.3.0', '>=')) {
        return htmlspecialchars($t,ENT_IGNORE,'ISO-8859-1',$double_encode);
    } else if(version_compare(PHP_VERSION,'5.2.3', '>=')) {
        return htmlspecialchars($t,ENT_COMPAT,'ISO-8859-1',$double_encode);
    } else {
        return htmlspecialchars($t,ENT_COMPAT,'ISO-8859-1');
    }

}
function nbsp_replace($t){
    return str_replace(" ","&nbsp;",$t);

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-02T13:11:48.727

[var_dump](http://php.net/manual/en/function.var-dump.php)在页面末尾和呈现数据之后？虽然我通常 var_dump 我的调试数据在页面顶部，因为我几乎总是使用某种输出缓冲机制。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-02T13:12:27.923

您可以尝试将内容包装在 HTML`<pre>`标记中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-11-05T12:10:08.973

寇可以使用`var_export`：

```
echo '<pre class="bottomerrorlog">';
var_export($variable);
echo '</pre>'; 
```

并将 css 类定义`.bottomerrorlog`为起初隐藏的东西。

例如，只有当您通过 jQuery 将鼠标悬停在它上面时才会扩展的空白空间

# javascript - 在对象树中查找特定字段值的所有出现

> ID：11294385
> 
> 赞同：0
> 
> 时间：2012-07-02T13:10:05.910
> 
> 标签：javascript, arrays, hash

我正在尝试打印字段“术语”的所有出现的值..使用我编写的程序它只返回第一次出现..是否有可能获得全部出现？

[http://jsfiddle.net/AQ5WK/](http://jsfiddle.net/AQ5WK/)

```
var data = {
"_index": "test",
"_type": "news",
"_source": {
    "partnerName": "propertyFile 9",
    "relatedSources": "null",
    "entityCount": "50",
    "Categories": {
        "Types": {
            "Events": [{
                "count": 1,
                "term": "Time",
                "Time": [{
                    "term": "Dec 9",
                    "Dec_9": [{
                        "count": 1,
                        "term": "2012"
                    }]
                    }]
                }, {
                "count": 4,
                "term": "News",
                "News": [{
                    "term": "Germany",
                    "Germany": [{
                        "count": 1,
                        "term": "Election"
                    }],
                    "currency": "Euro (EUR)"
                }, {
                    "term": "Egypt",
                    "Egypt": [{
                        "count": 1,
                        "term": "Revolution"
                    }]
                    }]
                }]
            }
    }
}};

var findDeepKey = function(obj, key){
var results = [];
if (typeof obj !== 'object') return null;
for (var k in obj) {
    if (k === key) return obj[k];
}
for (var k in obj) {
    if (typeof obj[k] === 'object') {
        if (obj[k].length) {
            for (var i = 0, il = obj[k].length; i < il; i++) {
                results.push(findDeepKey(obj[k][i], key));
            }
        } else {
            for (var kk in obj[k]) {
                if (kk === key) return obj[k][kk];
                results.push(findDeepKey(obj[k][kk], key));
            }
        }
    }
}
for (var i = 0, il = results.length; i < il; i++) {
    if (results[i] !== null) 
            return results[i];
}};

alert(findDeepKey(data, 'term')); 
```

​</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:39:35.593

> 我正在尝试打印字段“术语”的所有出现的值

它存在于对象树的任何级别的任何位置？这是一个递归下降搜索：[现场示例](http://jsbin.com/obehog)| [来源](http://jsbin.com/obehog/edit)

```
function findProps(name, data, results) {
  var key, value;

  // If we weren't given a results array, create one
  if (Object.prototype.toString.call(results) !== "[object Array]") {
    results = [];
  }

  // Is it an object (including an array)?
  if (typeof data === "object") {
    // Yes, loop through its properties
    for (key in data) {
      // Does it have an "own" property with this name?
      // (I assume you only want "own" properties, not
      // properties inherited from the prototype chain).
      if (data.hasOwnProperty(key)) {
        // Yes, get the value
        value = data[key];

        // Is this our property?
        if (key === name) {
          // Remember it
          results.push(value);
        }

        // Recurse into the value?
        if (typeof value === "object") {
          // Yes
          findProps(name, value, results);
        }
      }
    }
  }

  // All done
  return results;
}

var terms = findProps("term", data);
display("Found 'term' " + terms.length +
        " time(s): " + terms.join(", ")); 
```

# java - 在Java中查找手机号码的国家代码

> ID：11294392
> 
> 赞同：0
> 
> 时间：2012-07-02T13:10:31.723
> 
> 标签：java

有没有办法在Java中找到电话号码的国家代码？假设我给 9710334544，我将收到国家代码 91（如果是印度）。

请有任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T13:16:59.963

如果电话号码**不包含国家代码号码**作为前缀，则无法找出该电话号码来自哪个地区。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T13:27:02.053

国家代码背后的思想是先区分国家，然后解析数字。这样做的原因是放弃相同数量的问题。

如果我的美国号码是，`1234567890`那么有什么可以将它与我的英国号码区别开来`1234567890`？答案是国家前缀。不幸的是，由于这个数字的本质（因为它区分相同的数字，你不能用这个数字来弄清楚）。

现在，如果您已经拥有完整的 13-14 位数字，您可以通过简单的除法（整数除法）找到国家代码：

```
long inputPhoneNumber = 123 (XXX) - XXX - XXXX;
long countryCode = inputPhoneNumber / 10000000000l;
// Will give 123 
```

找到答案后，您可以将其与国家/地区相匹配，互联网提供了几个列出其国家/地区代码的网站：

[国家代码](http://countrycode.org/)

# java - 加载前检测编译代码的缺点

> ID：11294397
> 
> 赞同：1
> 
> 时间：2012-07-02T13:10:59.483
> 
> 标签：java, classloader, instrumentation

如果应用程序在使用自定义加载器加载它们之前创建了仪器类文件，任何人都可以关注可能出现的问题。我创建了一个执行相同操作的 java 应用程序。

我以字节数组的形式读取类文件然后我使用 asm 库进行检测，然后通过自定义类加载器加载它们。

如果是，这个程序是否容易失败，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:22:04.107

这样做的主要问题是它将您的应用程序与 JVM 联系在一起。Java 社区非常努力地将 JLS 和 JVMS 分开，以便*理论上*可以在没有 JVM 的情况下使用 Java，并且有两个相当广泛的平台*实际上*在没有 JVM 的情况下使用 Java：Android 和 GWT。如果您不希望在不理解 Java 字节码的平台上运行，那么您就可以了。

请注意，*静态*字节码操作是完全可以的。*您可以在操作后将*JVM 字节码交叉编译为 Dalvik 字节码。但是如果你想在运行时这样做，你必须在你的应用程序中包含 JVM-to-Dalvik 交叉编译器......它*仍然*无法工作，因为 Dalvik VM 根本不支持以相同方式加载动态字节码JVM会。

# facebook - 在关注“分页”facebook php sdk 3 时，一次又一次地收到相同的数据

> ID：11294401
> 
> 赞同：0
> 
> 时间：2012-07-02T13:11:25.610
> 
> 标签：facebook, facebook-graph-api, facebook-php-sdk, inbox

使用 php sdk 3，我正在尝试跟踪**分页**数组中的链接，如下所示：

```
https://graph.facebook.com/2015469353355/comments?limit=9999&until=1325376000&__paging_token=2015469353355_176&access_token=AAAFfJS6rRAABADxi04SdFJzdAKPAxRi6rprZCZBZAZAkAO0kQWD7sUQKZCVAhbzZBgaUa5ogrKHvuO3iZA0F2VBHVxWa6Sg17suL0capzCizncaEQZBxxxxx 
```

我使用循环来获取接下来的五页数据。一切正常，但相同的数据返回五次。

为了解决这个问题，我将**until=1341100800**更改为**until=1325376000**。但是结果再次重复（尽管它们现在是与时间变化相关的不同数据）。

# c# - WPF“地图”控件；使用画布显示大量位图图像

> ID：11294403
> 
> 赞同：3
> 
> 时间：2012-07-02T13:11:44.813
> 
> 标签：c#, wpf, wpf-controls

我正在使用 Substrate 解析 minecraft 文件数据。Minecraft 由“块”组成，“块”由块组成。所以我有一个带有不同 16x16 瓷砖的精灵表。我在 WPF 中使用croppedbitmap 来查找合适的图形平铺以构成地图的一部分。然后我在 WPF 中为“源”分配一个 Image() 控件，这是我的裁剪位图。最后，我执行 myCanvas.Children.Add(myImage)... 问题是，在我的画布中有大约 30 个左右的图像后，应用程序变得缓慢。这是一个问题，因为典型的我的世界地图会有成百上千的图像。有没有更好的方法来绘制大量的位图数据？我喜欢拥有图像控件，因为这样我就可以在地图上放置工具提示并使其具有交互性。但我接受 Image 控件可能更昂贵，并且拥有数千个控件可能无法正常工作。这是我的代码。（这只解析特定值的图块，因此如果 id == 9）

```
 var mapTiles = (BitmapImage)FindResource("mapTiles");
         CroppedBitmap waterImage = new CroppedBitmap(mapTiles, new Int32Rect(352, 48, 16, 16));
         CroppedBitmap grassImage = new CroppedBitmap(mapTiles, new Int32Rect(0, 0, 16, 16));
         foreach (ChunkRef chunk in chunkManager)
         {
             countOfTiles++;

             for (int x = 0; x <= 15; x++)
             {
                 for (int z = 0; z <= 15; z++)
                 {
                     int height = chunk.Blocks.GetHeight(x, z);
                     //TODO: Normalize Chunk X, Z so 0,0 is the smallest chunk so everything is visible on the canvas.
                     if (height > 0 && chunk.X > 0 && chunk.Z > 0)
                     {
                         var block = chunk.Blocks.GetBlock(x, height - 1, z);

                         if (block.ID == 9)
                         {
                             //352, 48
                             Image image = new Image();
                             image.Source = waterImage;
                             worldMap.Children.Add(image);
                             Canvas.SetTop(image, (chunk.X + x) * 16);
                             Canvas.SetLeft(image, (chunk.Z + z) * 16);
                             image.ToolTip = countOfTiles.ToString();
                         } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:25:10.653

您可以使用 ImageBrush，而不是使用较重的 Image：

```
// use ImageBrush's instead
var waterImage = new ImageBrush(new CroppedBitmap(...));
var grassImage = new ImageBrush(new CroppedBitmap(...));

waterImage.Freeze();
grassImage.Freeze(); 
```

之后：

```
if (block.ID == 9)
{
    var water = new Rectangle
    {
        Width = 16,
        Height = 16,
        Fill = waterImage
    };
    worldMap.Children.Add(water);
    Canvas.SetTop(water, (chunk.X + x) * 16);
    Canvas.SetLeft(water, (chunk.Z + z) * 16);
    water.ToolTip = countOfTiles.ToString();
} 
```

如果我忽略了 Freeze，我将无法让具有 100x100 磁贴世界的测试应用程序正确显示。当我冻结每个画笔时，我可以让地图无缝显示到大约 300x300。在 1000x1000 时它几乎不会加载，但此时您需要[考虑虚拟化视图](http://blogs.msdn.com/b/dancre/archive/tags/virtualizingtilepanel/)，因为 UI 无法优雅地处理那么多 UIElement。

# php - 如何从 Propel(Symfony) 中删除自动插入的查询？

> ID：11294409
> 
> 赞同：0
> 
> 时间：2012-07-02T13:12:15.630
> 
> 标签：php, symfony-1.4, propel

我正在用 Propel(symfony) 编写一些数据库查询，但是 propel 总是添加一些查询！例如 ：

```
 SELECT COUNT(*) FROM table WHERE (table.start>='2012-06-01 00:00:00' 
AND table.end<='2012-06-30 00:00:00') AND table.deleteat IS NOT NULL 
```

Propel 总是添加：**AND table.deleteat IS NULL**

我可以删除它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T14:04:30.923

谢谢你的想法@j0k

在我的 schema.yml 中，我看到存在一个 soft_delete。对于下一个查询，只需使用以下命令禁用它：`BookQuery::disableSoftDelete();` [link](http://www.propelorm.org/behaviors/soft-delete.html)

# apache - Apache htaccess 重定向

> ID：11294414
> 
> 赞同：0
> 
> 时间：2012-07-02T13:12:34.567
> 
> 标签：apache, .htaccess, redirect

大约一年前，我将整个网站移至新服务器。我仍然可以访问旧服务器（上面有很多垃圾），我想让旧站点重定向到新站点（它们有不同的域）。旧服务器正在运行 Apache。我认为这样的事情可以通过 .htaccess 文件完成，所以我将以下内容作为我的 .htaccess 文件：

```
Redirect 301 / http://newsite.com/ 
```

这不起作用，在访问旧站点时，我收到“500 内部服务器错误”。

我宁愿从旧服务器中删除文件。但是，问题是，我担心（因为它们在 Google 上的排名很高）如果有人单击指向其中一个文件的链接，他只会得到“404 文件未找到错误”。我只想编辑 .htaccess 以便它上面的每个文件路径都将重定向到新站点。如果你知道怎么做，请帮助我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:17:33.960

您应该考虑改用 mod_rewrite，假设它在旧服务器上启用：

```
RewriteRule ^(.*)$ http://newsite.com/$1 [R=301, L] 
```

这将保留并附加到新主机的路径

# seo - 使用 .htaccess 删除 www 规范：我还应该在网站管理员工具中验证 www 和非 www 吗？

> ID：11294415
> 
> 赞同：-2
> 
> 时间：2012-07-02T13:12:34.763
> 
> 标签：seo, google-search-console, canonical-link

我有一个让我很困惑的 SEO 人。他提到在谷歌网站管理员工具中，我应该验证网站的 www 版本以及非 www （非 www 已经验证）。所以我告诉他没有必要，因为我使用 .htaccess 来 301 将所有 www url 重定向到非 www url 出于规范原因（如 Matt Cutts 推荐的）。他告诉我，我仍然应该验证这两个版本。

当我告诉 Google 我希望他们为某个域/子域上的内容编制索引时，我看到了验证……而规范的全部意义在于我不希望他们索引 www 子域 url！更何况，如果对 www 子域的每个请求都被重定向，是否甚至可以验证它？

我应该尝试这样做还是不应该验证 www？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T07:20:43.983

您的 SEO 家伙不是“SEO 白痴”。您可以在 Google Web Master 工具中验证 www 前缀和“非 www”前缀都没有问题，然后选择哪个是首选域，www 或非 www。你不能选择GWT 中的首选域，无需验证两个前缀

谷歌在这里解释了这一点：

```
http://support.google.com/webmasters/bin/answer.py?hl=en&answer=44231 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T16:47:03.803

那个“搜索引擎优化的家伙”是一个“搜索引擎优化白痴”。如果您的网站可以用 www 拉起，而没有它，那么从技术上讲，您就是在提供重复的内容，而这*正是*Google 不想要的。你比那个“SEO 家伙”聪明多了。你做对了。不要改变任何事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-21T12:29:20.487

您需要验证两者以证明您是两者的所有者，因为从技术上讲，有和没有 www 实际上是不同的网站。www 只是一个子域，如果需要，可以指向不同的站点。

所以你必须向谷歌证明你管理这两者。然后因为谷歌知道你管理这两个域，并且有权指定如何处理这两个域，你然后告诉谷歌该站点将使用 www（或者不使用，无论你想要什么），然后你保留重定向。

Google 不会将 301 重定向到另一个域的域编入索引。

我确实同意将 www 和非 www 分别列在网站管理员中并不好。但是理论上您可以将不同站点的负载和负载作为子域，因此 Google 必须将它们视为不同的站点。

# java - 连接一个本身有构造函数的 Bean

> ID：11294419
> 
> 赞同：1
> 
> 时间：2012-07-02T13:12:45.897
> 
> 标签：java, spring

我有一个具有 Authenticator 类的 Web 服务客户端。Authenticator 需要用户名/密码。寻求有关如何使用 Spring 注入凭据的帮助。

我应该将用户/密码注入到 Authenticator 中还是注入到正在实例化 Authenticator 的客户端中。

任何具体的例子都会受到赞赏，因为我是 Spring 新手。

这些是两个组件的样子：

```
@Controller
    public class WSClient {
        @Autowired
        MyAuthenticator myAuthenticator;
    }
} 
```

身份验证器，带有凭据：

```
public class MyAuthenticator extends Authenticator {
    private final String userName;
    private final String passWord;

    public MyAuthenticator(String userName, String passWord) {
        this.userName = userName;
        this.passWord = passWord;
    }

    @Override
    protected PasswordAuthentication getPasswordAuthentication() {
        return new PasswordAuthentication(this.userName, this.passWord.toCharArray());
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:15:34.053

用于`@Value`在`Authentication`bean中设置用户名/密码

```
@Component
public class MyAuthenticator extends Authenticator {
    @Value("${credentials.username}")
    private final String userName;
    @Value("${credentials.password}")
    private final String passWord;

    public MyAuthenticator(String userName, String passWord) {
        this.userName = userName;
        this.passWord = passWord;
    }

    @Override
    protected PasswordAuthentication getPasswordAuthentication() {
        return new PasswordAuthentication(this.userName, this.passWord.toCharArray());
    }
} 
```

并在 XML 文件中

添加

```
<util:properties id="credentials" location="classpath:credentials.properties"/> 
```

并放入`credentials.properties`类路径

# c# - LINQ 选择具有 DISTINCT 的列表列表

> ID：11294423
> 
> 赞同：1
> 
> 时间：2012-07-02T13:12:57.720
> 
> 标签：c#, linq, linq-to-sql

想象有一个类（和相应的数据库表）如下

```
class Price{
    int ItemID;
    int ItemTypeID;
    string ItemName;
    string ItemTypeName;
    float Price;
} 
```

我正在寻找一个新的通过 LINQ 查询它以获取不同项目的列表（可能使用 Take() 和 Skip() 方法）并嵌套所有相关价格的列表。

有什么建议吗？

编辑：为了让问题更简单，这里有一个例子

想象一下有3个“价格”如下

```
1, 1, Ball, Blue, 10 
1, 2, Ball, Red,  20 
2, 1, Frisbee, Blue, 30 
```

我想把它们放在一个简化的结构中

`List<Item>`

在哪里

```
class Item
{
    string ItemName;
    string ItemTypeName;
    List<Price> Prices;
} 
```

和

```
class Price
{
    float Price;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T13:16:08.187

使用[`Distinct()`](http://msdn.microsoft.com/en-us/library/bb348436.aspx)，像这样：

```
var results = _dbContext.Prices
    .Distinct()
    .Skip(15)
    .Take(5); 
```

**编辑：**`List<Item>`要按照您的要求 填充每个项目的价格列表，您应该使用`GROUPBY`这样的：

```
var results = _dbContext.GroupBy( i => new { i.ItemName, i.ItemTypeName })
    .Select( g => new Item()
        {
            ItemName = g.Key.ItemName,
            ItemTypeName = g.Key.ItemTypeName,
            Prices = g.Select( p => new Price(){Price = p.Price})
         }); 
```

之后，您可以应用`Take`与`Skip`第一个查询相同的方式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-02T13:33:42.507

听起来你可能想要一个 GroupBy。尝试这样的事情。

```
var result = dbContext.Prices
    .GroupBy(p => new {p.ItemName, p.ItemTypeName)
    .Select(g => new Item
                     {
                         ItemName = g.Key.ItemName,
                         ItemTypeName = g.Key.ItemTypeName,
                         Prices = g.Select(p => new Price 
                                                    {
                                                        Price = p.Price
                                                    }
                                           ).ToList()

                     })
     .Skip(x)
     .Take(y)
     .ToList(); 
```

# ipad - 如何建立与 iPad 的远程桌面连接？

> ID：11294439
> 
> 赞同：-4
> 
> 时间：2012-07-02T13:13:33.170
> 
> 标签：ipad, ios5, remote-desktop

实际上我正在为 iPad 开发东西，但摆弄 Firebug lite 并不好玩，而且是有限的。

我想从我的 pc 或 mac 远程控制 iPad——如果可能的话，不用越狱。诸如“Windows 桌面远程连接”之类的东西可以远程控制另一个操作系统——但对于 iPad。

**我怎样才能做到这一点？**

更新：为什么我在这里得到downvotes？请说清楚！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T09:12:09.083

据我所知，我认为还没有任何可用的东西。但我刚刚看到一个论坛，其中包含有关此主题的一些信息：

[http://forums.whirlpool.net.au/archive/1488754](http://forums.whirlpool.net.au/archive/1488754)

**更新**

我想你需要[这个](http://labs.adobe.com/technologies/shadow/)

[Chrome 扩展程序也可用](https://chrome.google.com/webstore/detail/ijoeapleklopieoejahbpdnhkjjgddem/)

# objective-c - 何时使用（或不使用）委托

> ID：11294444
> 
> 赞同：8
> 
> 时间：2012-07-02T13:13:53.710
> 
> 标签：objective-c, delegates

这是一个非常笼统的问题，但我今天想知道代表。在这一点上，我真的没有具体的时间使用它们或不使用它们——除了明显的情况，比如从选择器或表格视图中传递选择。例如，如果我可以传递对对象的引用并使用它来调用方法，那么是否有理由实现委托？总之，委托模式打算用于什么，什么时候不使用它更好？

感谢您提供快速而全面的答案！他们都非常有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T13:33:05.720

委托模式的优点是委托对象与其委托之间的松散耦合。松耦合提高了类在其他上下文中的可重用性。

委托对象不必知道它与之通信的对象的任何信息（除了它实现委托协议的要求）——尤其是它的类或它有什么方法。如果您以后想在不同的上下文中重用您的组件或让它与不同类的另一个对象通信，那么这个对象所要做的就是实现委托协议。委托对象根本不需要更改。

当然，这也有一个缺点，那就是需要更多的代码，而你编写的代码不是那么明确，因此可能更难理解。这种（通常很小的）折衷是否值得取决于您的用例。如果这两个对象无论如何都是紧密耦合的，并且将来重用的可能性很低，那么使用委托模式可能会过大。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T13:31:05.633

看到[这个](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CocoaFundamentals/CommunicatingWithObjects/CommunicateWithObjects.html)讨论

委托允许一个对象在事件发生时向另一个对象发送消息。

**优点**

*   非常严格的语法。所有要听到的事件都在委托协议中明确定义。

*   如果方法未按委托实现，则编译时警告/错误。

*   仅在控制器范围内定义的协议。

*   非常可追溯且易于识别应用程序中的控制流。

*   能够让多个协议定义一个控制器，每个控制器都有不同的代表。

*   无需第三方对象来维护/监控通信过程。

*   能够从调用的协议方法接收返回值。这意味着委托可以帮助将信息提供回控制器。

**缺点**

*   需要多行代码来定义：1\. 协议定义，2\. 控制器中的委托属性，以及 3\. 委托本身内委托方法定义的实现。

*   需要注意在对象释放时正确地将委托设置为 nil，否则可能会通过调用释放对象的方法导致内存崩溃。

*   尽管有可能，但这可能很困难，并且该模式并不真正适合在控制器中拥有同一协议的多个委托（告诉多个对象有关同一事件）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T13:46:27.327

委托的“用例”与继承几乎相同，即以多态方式扩展类行为。

这是[维基百科](http://en.wikipedia.org/wiki/Delegation_pattern)定义委托的方式：

> 在软件工程中，委托模式是面向对象编程中的一种设计模式，其中对象不执行其声明的任务之一，而是将该任务委托给关联的帮助对象。有一种责任倒置，其中帮助对象（称为委托）被赋予为委托人执行任务的责任。委托模式是构成其他软件模式（例如组合（也称为聚合）、混合和方面）基础的基本抽象模式之一。

很明显，委托和继承之间有很多区别，但最大的区别是，IMO，继承是两个类之间的固定（也就是编译时）关系，而委托可以在运行时定义（在语言中支持这个）。另一方面，继承为多态提供了更好的支持。

委托是一个巨大的话题（就像继承一样），你可以阅读很多关于它的内容。最后，决定是使用委托还是继承归结为决定您是否想要“is-a”或“has-a”关系，因此列出选择指南并不容易。

对我来说，基本上，创建代表的决定来自以下观察：

1.  我的代码呈现了一组同质的行为（这里的同质意味着可以被识别为具有共同的“性质”）；

2.  这些行为可能是针对特定情况“定制”的（例如，替换为替代行为）。

这是我的个人观点，也是对我识别“委托”模式的方式的描述。这可能与我的编程学科受到重构原则的强烈影响这一事实有很大关系。

真的，IMO，委派是为你的班级定义“定制”点的一种方式。例如，如果您有某种抽象的工作流程，在每个步骤中您根据特定条件采取一些行动；此外，这些具体行动可以被另一种替代，那么我看到了通过授权重用的机会。

希望这可以帮助。

# php - php中的分支预测

> ID：11294457
> 
> 赞同：14
> 
> 时间：2012-07-02T13:14:25.987
> 
> 标签：php, arrays, performance, optimization, if-statement

刚刚阅读了一篇关于[分支预测](https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array)的精彩文章。我试图用 php 语言重现它。

```
<?php

function microtime_float()
{
    list($usec, $sec) = explode(" ", microtime());
    return ((float)$usec + (float)$sec);
}

$time_start = microtime_float();

$count = 300000;
$sum = 0;
for ($i = 0; $i <= $count; $i++) {
    $array[] = rand(0, $count);
}

sort($array);

for ($i = 0; $i <= $count; $i++) {
    if ($array[$i] <= 150000) {
        $sum += $array[$i];
    }
}

$time_end = microtime_float();
$time = $time_end - $time_start;

echo $sum . '<br />';
echo 'End:' . $time;
?> 
```

但是我总是在排序和没有排序的情况下得到相同的结果。也许我做错了什么？或者也许 php 已经内置了分支预测器的优化？

**升级版：**

我根据注释对代码进行了修改，并在本地机器上测量了时间。

**未排序的数组**：1.108197927475

**排序数组**：1.6477839946747

**差异**：0.539586067。

我认为这种差异用于排序。分支预测器似乎对速度没有影响。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-02T17:44:05.677

你不会在 PHP 中复制它。故事结局。原因是Java RTS 使用JiT 编译技术将Java 中间代码编译为底层X86 顺序代码。此底层订单代码将公开这些分支预测伪像。

PHP 运行时系统将 PHP 编译为字节码，该字节码是被解释的伪机器码。这个解释器将在一个典型的单核上执行大约 0.5M 操作码/秒——也就是说，每个 PHP 操作码可能需要 2-6K 本机指令。分支的任何微妙之处都将在此丢失。

# objective-c - UITableView 刷新查询

> ID：11294458
> 
> 赞同：1
> 
> 时间：2012-07-02T13:14:31.040
> 
> 标签：objective-c, ios, uitableview

我正在使用 UITableView 控件来显示一些用户可以编辑的数据。要编辑详细信息，用户点击编辑按钮，将新视图推送到堆栈上。用户编辑数据，点击保存按钮，数据被保存到 plist，视图从堆栈中弹出。即使 plist 已更新， UITableView 仍显示旧数据。这可以通过在 viewWillAppear 方法中添加对 reloadData 的调用来纠正。但是，当视图首次加载时，数据会正确显示，通过添加 reload 语句是否意味着双重绑定？如果是这样，如何避免这种情况？

我发现以下代码（[此处](http://www.tommy-ryan.com/making-your-ipad-app-redraw-a-uitableview/)）强制刷新，而无需显式调用 reloadData：

```
- (void) viewWillAppear:(BOOL)animated
 {
 [super viewWillAppear:animated];
 int orientation = [[UIDevice currentDevice] orientation];
 if(orientation != UIDeviceOrientationUnknown)
   [self willRotateToInterfaceOrientation:orientation duration:0];
 } 
```

谁能解释这是如何/为什么起作用的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:33:50.293

您链接的技巧是肮脏的黑客攻击。它不仅会重新加载数据，还会强制重新绘制表格。它告诉您的应用设备正在获得新的方向，因此您的表格将与其他 UI 元素一起重绘。

刷新单行或特定行集的标准方法`UITableView`是调用它的`reloadRowsAtIndexPaths:withRowAnimation:`方法：这样做会调用您的数据源以仅获取已更新行的数据，从而防止完全重新加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:37:08.873

做这个：

```
 - (void) viewWillAppear:(BOOL)animated
 {
  [super viewWillAppear:animated];

  //remove all objects from yourTableViewDataSourceArray
  [yourTableViewDataSourceArray  removeAllObjects];

  //add new records from plist 
  yourTableViewDataSourceArray = plist request of data here

  //reload table now
  [yourtableView reloadData];
 } 
```

# c# - C# - RTC 报警 API

> ID：11294459
> 
> 赞同：1
> 
> 时间：2012-07-02T13:14:40.403
> 
> 标签：c#, .net, api

我想将我的计算机编程为在几个时间间隔自动启动。根据我在互联网上查看的内容，我可以通过使用主板的 RTC 警报来做到这一点。我想在我的笔记本电脑上执行此操作，它在 BIOS 中没有 RTC 警报部分。

C#中是否有任何API用于编程主板的RTC闹钟？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:16:56.220

Windows API`CreateWaitableTimer`可以唤醒机器。Windows 使用 ACPI 将此请求传达给 BIOS，后者设置实时时钟。

更多信息在这里：

*   [http://msdn.microsoft.com/en-us/library/windows/desktop/aa373235(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373235(v=vs.85).aspx)
*   [http://www.codeproject.com/Articles/49798/Wake-the-PC-from-standby-or-hibernation](http://www.codeproject.com/Articles/49798/Wake-the-PC-from-standby-or-hibernation)
*   [http://www.yetanotherchris.me/home/2009/6/18/wake-up-from-sleep-createwaitabletimer-in-c.html](http://www.yetanotherchris.me/home/2009/6/18/wake-up-from-sleep-createwaitabletimer-in-c.html)

# c - 使用预处理器计算奇偶校验位（通过 ref 调用的奇偶校验功能样式）

> ID：11294460
> 
> 赞同：2
> 
> 时间：2012-07-02T13:14:42.623
> 
> 标签：c, c-preprocessor, compile-time, parity

考虑我想在编译时生成奇偶校验。奇偶校验计算给出了文字常量，并且使用任何体面的优化器，它本身都会归结为一个常量。**现在看一下使用C**预处理器进行的以下奇偶校验计算：

```
#define PARITY16(u16) (PARITY8((u16)&0xff) ^ PARITY8((u16)>>8))
#define PARITY8(u8) (PARITY4((u8)&0x0f) ^ PARITY4((u8)>>4))
#define PARITY4(u4) (PARITY2((u4)&0x03) ^ PARITY2((u4)>>2))
#define PARITY2(u2) (PARITY1((u2)&0x01) ^ PARITY1((u2)>>1))
#define PARITY1(u1) (u1)

int message[] = { 0x1234, 0x5678, PARITY16(0x1234^0x5678)); 
```

这将在编译时计算奇偶校验，但会产生大量的中间代码，扩展为表达式的 16 个实例，`u16`其本身可以是例如任意复杂的表达式。问题是**C**预处理器无法评估中间表达式，并且在一般情况下只能扩展文本（您可以强制它在原位进行整数运算，但仅适用于琐碎的情况，或者使用千兆字节的#defines）。我发现 3 位的奇偶校验可以通过算术表达式一次生成：`([0..7]*3+1)/4`. 这将 16 位奇偶校验减少到以下宏：

```
#define PARITY16(u16) ((4 & ((((u16)&7)*3+1) ^           \
                            ((((u16)>>3)&7)*3+1) ^               \
                            ((((u16)>>6)&7)*3+1) ^               \
                            ((((u16)>>9)&7)*3+1) ^               \
                            ((((u16)>>12)&7)*3+1) ^              \
                            ((((u16)>>15)&1)*3+1))) >> 2)) 
```

仅扩展`u16`6 倍。是否有更便宜（就扩展数量而言）的方式，例如 4,5 等的直接公式？位平价？`(x*k+d)/m`对于范围 > 3 位的可接受（非溢出）值 k、d、m的形式的线性表达式，我找不到解决方案。有谁有更聪明的预处理器奇偶校验计算捷径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-13T05:43:59.013

你正在寻找这样的东西吗？以下“PARITY16(u16)”预处理器宏可用作结构赋值中的文字常量，并且它只计算一次参数。

```
/* parity.c
 * test code to test out bit-twiddling cleverness
 * 2013-05-12: David Cary started.
*/

// works for all 0...0xFFFF
// and only evalutes u16 one time.
#define PARITYodd33(u33) \
    ( \
        ((((((((((((((( \
            (u33) \
        &0x555555555)*5)>>2) \
        &0x111111111)*0x11)>>4) \
        &0x101010101)*0x101)>>8) \
        &0x100010001)*0x10001)>>16) \
        &0x100000001)*0x100000001)>>32) \
    &1)
#define PARITY16(u16) PARITYodd33(((unsigned long long)u16)*0x20001)

// works for all 0...0xFFFF
// but, alas, generates 16 instances of u16.
#define PARITY_16(u16) (PARITY8((u16)&0xff) ^ PARITY8((u16)>>8))
#define PARITY8(u8) (PARITY4((u8)&0x0f) ^ PARITY4((u8)>>4))
#define PARITY4(u4) (PARITY2((u4)&0x03) ^ PARITY2((u4)>>2))
#define PARITY2(u2) (PARITY1((u2)&0x01) ^ PARITY1((u2)>>1))
#define PARITY1(u1) (u1)

int message1[] = { 0x1234, 0x5678, PARITY16(0x1234^0x5678) };
int message2[] = { 0x1234, 0x5678, PARITY_16(0x1234^0x5678) };

#include <stdio.h>

int main(void){
        int errors = 0;
        int i=0;
        printf(" Testing parity ...\n");
        printf(" 0x%x = message with PARITY16\n", message1[2] );
        printf(" 0x%x = message with PARITY_16\n", message2[2] );
        for(i=0; i<0x10000; i++){
                int left = PARITY_16(i);
                int right =  PARITY16(i);
                if( left != right ){
                        printf(" 0x%x: (%d != %d)\n", i, left, right );
                        errors++;
                        return 0;
                };
        };
        printf(" 0x%x errors detected. \n", errors );
} /* vim: set shiftwidth=4 expandtab ignorecase : */ 
```

就像您发布的原始代码一样，它将位配对并（实际上）计算每对之间的 XOR，然后根据结果再次配对位，每次将位数减半，直到只剩下一个奇偶校验位。

## 但这真的是你想要的吗？

许多人*说*他们正在计算消息的“奇偶性”。但根据我的经验，大多数情况下，它们实际上是在生成比单个奇偶校验位更大的[错误检测码——](http://en.wikipedia.org/wiki/error_detection_and_correction) [LRC](http://en.wikipedia.org/wiki/longitudinal_redundancy_check)或[CRC](http://en.wikipedia.org/wiki/cyclic_redundancy_check)或[Hamming 码](http://en.wikipedia.org/wiki/Hamming_code)等。

## 更多详细信息

如果当前系统在合理的时间内编译，并且给出了正确的答案，我会不理会它。重构“预处理器如何生成一些常量”将逐位生成相同的运行时可执行文件。我宁愿拥有易于阅读的源代码，即使编译需要一整秒的时间。

许多人使用比标准 C 预处理器更易于阅读的语言来生成 C 源代码。请参阅[pycrc](https://softwareengineering.stackexchange.com/questions/96211/what-is-a-faster-alternative-to-a-crc/96374)、[字符集提取器](http://www.massmind.org/techref/datafile/charsets.htm)、[“使用 Python 生成 C”](https://stackoverflow.com/questions/4000678/using-python-to-generate-a-c-string-literal-of-json)等。

如果当前系统的编译时间太长，而不是调整 C 预处理器，我会很想把该消息（包括奇偶校验）放在带有硬编码常量的单独“.h”文件中（而不是强制C 预处理器每次都计算它们），而“#include”表示“.h”文件中的“.c”文件用于嵌入式系统。

然后我会制作一个完全独立的程序（可能在 C 或 Python 中）进行奇偶校验计算并将“.h”文件的内容打印为预先计算的 C 源代码，例如

```
print("int message[] = { 0x%x, 0x%x, 0x%x };\n",
    M[0], M[1], parity( M[0]^M[1] ) ); 
```

并调整我的[MAKEFILE](http://en.wikibooks.org/wiki/makefile)以运行该 Python（或其他）程序，以在且仅当有必要时重新生成该“.h”文件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-02T13:27:14.820

正如 mfontanini 所说，内联函数要好得多。

如果你坚持宏，你可以定义一个临时变量。
使用`gcc`，您可以做到这一点，并且仍然拥有充当表达式的宏：
`#define PARITY(x) ({int tmp=x; PARITY16(tmp);})`
如果要坚持标准，则必须使宏成为语句：
`#define PARITY(x, target) do { int tmp=x; target=PARITY16(tmp); } while(0)`。

在这两种情况下，如果`tmp`最终使用函数中的名称（更糟糕的是 - 在传递给宏的参数中使用），您可能会遇到丑陋的错误。

# c# - .net 中等效的 Treeview.OnChange 事件是什么？

> ID：11294465
> 
> 赞同：1
> 
> 时间：2012-07-02T13:15:00.387
> 
> 标签：c#, .net, events, treeview

我在 winform 上有树视图控件，需要为其实现 onChange 事件。但是，它似乎没有，只有 onChangeUI。

如果树视图不支持 onChange 事件，那么它在 .NET 中的等价物是什么。

我搜索了 MSDN Library 并没有找到任何信息。

**更新：**附注我正在为 .net 转换 win32 程序。

提前致谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:31:34.287

Windows 窗体 TreeView 控件对选择更改的支持有点有限。

基本上，有一对事件（[BeforeSelect](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.beforeselect.aspx)和[AfterSelect](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.afterselect.aspx)）允许您在选择树节点时做出反应。`BeforeSelect`允许您取消新选择，`AfterSelect`但不允许（因为它发生在提交新选择之后）。

*但是，当节点未选中*时，不会触发这些事件。要检测这种情况，您必须处理通用[MouseUp](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mouseup.aspx)事件并检查单击节点的[IsSelected](http://msdn.microsoft.com/en-us/library/system.windows.forms.treenode.isselected.aspx)属性以获取实际的选择状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T14:27:22.557

这是包装原生 Windows 控件的包装类中的常见限制。它只会为您不知道的事情生成通知。就像用户可以做的任何影响控件的事情一样。*它忽略了你*所做的事情的通知，其基本理念是你不必被提醒你已经知道的事情。

TreeView 肯定是这种情况，用户不能添加任何节点。只有你可以。节点中显示的文本也是如此。没有事件可以告诉您文本已更改。除了在用户编辑节点的非常特殊的情况下，AfterLabelEdit 事件。

您可以从 TreeView 派生您自己的类，并添加一个 Change 事件和触发它的 OnChange() 方法。您可以编写代码来调用该方法。请注意，这很难可靠地完成，TreeNodeCollection 类没有虚拟方法，因此您无法覆盖它们以检测客户端代码更改节点。实际上，您最好不要编写该代码，而只需以任何修改 TreeView 内容的方法在表单中生成一个内部事件。

# model - TYPO3 Extbase：流体中的嵌套模型

> ID：11294468
> 
> 赞同：0
> 
> 时间：2012-07-02T13:15:08.500
> 
> 标签：model, nested, typo3, fluid, extbase

目前我正在为 TYPO3 编写我的第一个 extbase 扩展，其中包含嵌套模型。

存在以下模型：

**作者**- 属性：名称和描述

**新闻**- 属性：标题、日期、作者

作者是这样被包含在新闻模型中的

```
/**
 * @var Tx_Extbase_Persistence_ObjectStorage<Tx_Simplenews_Domain_Model_Author>
 * @lazy
 * @cascade remove
 **/
protected $author = 0; 
```

在 Fluid 中调试也可以，但作者对象有一个键 uuid（例如“000000007d9412bd000000000217f7d0”），它会随每个请求而改变。

我只想在每条新闻上显示作者的名字。一个名字。

所以我必须遍历作者对象，找到键并显示如下名称：

```
<f:for each="{oneNews.author}" as="author">
    <td>{author.name}</td>`
</f:for> 
```

有没有更好的解决方案？

```
<f:for each="{news}" as="oneNews">
    <td>{oneNews.author.name}</td>
</f:for> 
```

不会工作。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T12:49:52.377

得到了答案

我刚刚更新了 News.php（模型）中的以下代码：

```
/**
* @var Tx_Extbase_Persistence_ObjectStorage<Tx_Simplenews_Domain_Model_Author>
* @lazy
**/
protected $author; 
```

构造函数：

```
public function __construct() {
    $this->author = new Tx_Extbase_Persistence_ObjectStorage();
} 
```

吸气剂：

```
/**
 * @return Tx_Simplenews_Domain_Model_Author
 */
public function getAuthor() {
    $author = $this->author;
    $author->rewind(); // rewinds the iterator to the first storage element
    return $author->current(); // returns the current storage entry.
} 
```

现在我可以访问作者的名字了`{oneNews.author.name}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-01T13:53:04.747

那么，为什么首先要为 Author 使用 objectStorage 呢？ObjectStorages 用于存储多个对象。因此，只要您的新闻不能同时有两个或多个作者，您就根本不需要 objectStorage 来存储该属性。`getAuthor()`然后你不需要通过你的方法返回 objectStorage 的第一个对象。顺便说一句，这使得洞对象存储使用过时。

我假设一条新闻只有一位作者。尝试这个：

**新闻模型：**

```
/**
 * @var Tx_Simplenews_Domain_Model_Author
 **/
protected $author;

/**
 * @param Tx_Simplenews_Domain_Model_Author $author
 * @return void
 */
public function setAuthor(Tx_Simplenews_Domain_Model_Author $author) {
  $this->author = $author;
}

/**
 * @return Tx_Simplenews_Domain_Model_Author
 */
public function getAuthor() {
  return $this->author;
} 
```

在您的流体模板中，您仍然拥有：

```
{oneNews.author.name} 
```

所以，如果你不需要它，就不要使用 objectStorage。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T14:43:08.187

我创建了一个虚拟新闻扩展，它以您想要的方式列出新闻。请参阅[此 git 存储库](https://bitbucket.org/smartcode_ch/typo3newsdummy)。我不知道你的情况出了什么问题。顺便说一句，我使用*Extension Builder*创建了扩展，只是更改`List.html`了`News`.

# iphone - 查找子视图在视图中的位置

> ID：11294469
> 
> 赞同：1
> 
> 时间：2012-07-02T13:15:11.080
> 
> 标签：iphone, ios, views, subviews

目标：我们如何找到子视图在视图中的位置。我想找出我的滚动条在视图中的左上角 (x,y) 位置，我也在我的应用程序中使用导航栏它是否会影响从顶部定位子视图？

我知道如何找到子视图的高度和宽度

```
CGSize viewSize = scrollView.frame.size;
height=viewSize.height;
width=viewSize.width; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:17:57.823

您正在寻找的可能是：

```
CGPoint viewPosition = scrollView.frame.origin;
x=viewPosition.x;
y=viewPosition.y; 
```

但是如果你想转换到另一个视图的坐标系，你可以使用：

```
- (CGPoint)convertPoint:(CGPoint)point toView:(UIView *)view 
```

并将您想要翻译的观点和观点传递给它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:17:39.590

要获得 x 和 y 使用`origin`

```
CGPoint point = scrollView.frame.origin;
float x = point.x;
float y = point.y; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:28:27.037

你也可以用这个...

```
 CGRect rect = [scrollBar frame];
 float origineFromX = rect.origin.x;
 float origineFromY = rect.origin.y; 
```

这可能会帮助你...

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-02T13:24:33.747

如果将导航栏放在视图中，则滚动视图的位置必须向下移动才能在视图中正确对齐。无论有无导航栏，滚动视图的原点（左上角位置）都会有所不同。

如果您使用的是全屏滚动视图，则必须降低滚动视图的高度以适应导航栏。

# c# - 通过 Silverlight 连接到 OLAP Cube

> ID：11294471
> 
> 赞同：2
> 
> 时间：2012-07-02T13:15:27.390
> 
> 标签：c#, silverlight, mdx, olap

我想创建一个**Silverlight**应用程序来从现有的**OLAP Cube**中提取和操作数据。我想选择一个好的方法：

1.  有一些框架/库吗？
2.  可以在没有外部依赖的情况下完成吗？
3.  我发现了一些关于使用**MS Analysis Services的****Web 服务**的文章。我应该避免直接连接到**OLAP Cube**并制作一些**Web 服务**吗？

 ********进步 ：**

该多维数据集部署在**SSAS**上，我可以访问它并从**MS SQL Server Management Studio执行****MDX 查询**。是否有示例如何从**Silverlight页面启动****MDX 查询**并显示结果？

 ******* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T14:45:10.150

我只能和 SSAS 说话。

1.  如果要连接到 SQL Server Analysis Server，则可以使用 ADO MD.Net 对象。（[http://msdn.microsoft.com/en-us/library/ms123483.aspx](http://msdn.microsoft.com/en-us/library/ms123483.aspx)）。或者，您可以使用 HTTP Pump。( [http://technet.microsoft.com/en-us/library/cc917711.aspx](http://technet.microsoft.com/en-us/library/cc917711.aspx) )
2.  HTTP 泵可能会为您消除一些依赖关系。
3.  这取决于你的目标是什么。基于服务的架构（无论是 Web 还是其他技术）取决于应用程序的设计者和要求。但是，您可以很容易地做到这一点。我之前使用 WCF 服务轮询了一个 SSAS 多维数据集，它可以很好地限制对多维数据集的请求。

教程在互联网上很少见。您最好的选择是购买一本专门针对您正在使用的 OLAP 服务器类型的书。

以下是有关如何使用各种客户端连接到 SSAS 的完整列表： [http ://technet.microsoft.com/en-us/library/ms174518](http://technet.microsoft.com/en-us/library/ms174518)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T04:31:24.770

我认为你最好的解决方案之一是尝试这个 OLAP Silverlight 解决方案

```
http://www.galantis.com/ranet/ 
```************

# url - 如何重写网址

> ID：11294477
> 
> 赞同：-1
> 
> 时间：2012-07-02T13:15:52.553
> 
> 标签：url, url-rewriting, url-routing

我在 xyz.com 有一个站点，出于某些原因，我想将对 www.xyz.com 的访问重定向到 url xyz.com。即使他们添加了“www”，我也想将他们栏中的地址更改为 xyz.com。有办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:21:58.503

首先在您的 Web 服务器中启用 mod_rewrite，然后在您的目录中使用 .htaccess 文件，其中包含以下内容：

```
RewriteEngine On

RewriteCond %{HTTP_HOST} ^www\.xyz\.com$
RewriteRule ^(.*)$ "http\:\/\/xyz\.com\/$1" [R=301,L] 
```

# php - php psr-0 RESTful Web 服务库

> ID：11294486
> 
> 赞同：0
> 
> 时间：2012-07-02T13:16:20.767
> 
> 标签：php, psr-0

是否有人知道按照 psr-0 指南命名的轻量级 restful lib。

看着苗条，顿悟，但希望根据 psr-0 建议的结构和命名空间更好。

slim 声称符合 psr-0，但它并不是真正的，并且通过使用自己的自动加载器“实现”了这一点。

非常感谢任何提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:22:50.473

[Silex](http://silex.sensiolabs.org/)与 Slim 非常相似，但具有更好的架构 IMO 并且它符合 psr-0。

# android - Android - 仅从本机代码写入/保存文件

> ID：11294487
> 
> 赞同：28
> 
> 时间：2012-07-02T13:16:27.280
> 
> 标签：android, android-ndk

我正在尝试构建一个利用`NativeActivity`NDK 功能的 Android 应用程序。我有以下结构：

*   一堆本地共享库安装在`/system/vendor/<company>`；我正在使用自定义构建的 Android 映像，因此那里的库具有适当的权限和一切都没有问题
*   使用 的几个应用程序`NativeActivity`又依赖于上面提到的库

/system/vendor 中安装的库和我的应用程序使用了几个配置文件。使用标准 C API 阅读它们没有问题 `fopen/fclose`。但是这些库和我的应用程序还需要存储一些文件作为它们的操作结果，比如配置、一些运行时参数、校准数据、日志文件等。随着文件的存储，我有一个小问题不允许写入`/system/vendor/...`（因为“/system/...”下的文件系统是只读安装的，我不想破解它）。

那么创建和存储这些文件的最佳方式是什么？最好的“符合 Android”存储区域在哪里？

我一直在阅读 android-ndk Google 组中的几个线程，并且在这里提到[了内部应用程序私有存储](https://stackoverflow.com/questions/6525724/how-do-i-write-to-the-internal-storage-file-system-with-nativeactivity)或[外部 SD 卡](https://stackoverflow.com/questions/1992953/file-operations-in-android-ndk)，但由于我没有使用 Android 的扩展经验，我不确定是什么将是正确的方法。如果该方法涉及某些特定的 Android API，则 C++ 中的小代码示例将非常有帮助；我见过几个涉及 Java 和 JNI 的例子（[例如在这个 SO question 中](https://stackoverflow.com/questions/4731314/android-ndk-write-file)），但我现在想远离那个。`internalDataPath/externalDataPath`从 C++ 使用本机活动的对似乎也存在问题 （[一个使它们始终为 NULL 的错误](https://stackoverflow.com/questions/10683119/android-app-activity-internaldatapath-still-null-in-2-3-8-ndk-r8?lq=1)）。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-07-18T08:49:30.687

对于比较小的文件（应用配置文件、参数文件、日志文件等）最好使用内部应用私有存储，即`/data/data/<package>/files`. 如果外部存储存在（无论是否为 SD 卡），则应将其用于不需要频繁访问或更新的大文件。

对于外部数据存储，本机应用程序必须“请求”应用程序的正确权限`AndroidManifest.xml`：

```
<manifest>
    ... 
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE">
    </uses-permission>
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"> 
    </uses-permission>
</manifest> 
```

对于内部应用程序私有存储`fopen/fclose`（或 C++ 流等价物，如果可用），可以使用 API。以下示例说明了使用 Android NDK`AssetManager`检索和读取配置文件。该文件必须放在`assets`本机应用程序的项目文件夹内的目录中，以便 NDK 构建可以将它们打包到 APK 中。我在问题中提到的`internalDataPath/externalDataPath`错误已针对 NDK r8 版本修复。

```
...
void android_main(struct android_app* state)
{
    // Make sure glue isn't stripped 
    app_dummy();

    ANativeActivity* nativeActivity = state->activity;                              
    const char* internalPath = nativeActivity->internalDataPath;
    std::string dataPath(internalPath);                               
    // internalDataPath points directly to the files/ directory                                  
    std::string configFile = dataPath + "/app_config.xml";

    // sometimes if this is the first time we run the app 
    // then we need to create the internal storage "files" directory
    struct stat sb;
    int32_t res = stat(dataPath.c_str(), &sb);
    if (0 == res && sb.st_mode & S_IFDIR)
    {
        LOGD("'files/' dir already in app's internal data storage.");
    }
    else if (ENOENT == errno)
    {
        res = mkdir(dataPath.c_str(), 0770);
    }

    if (0 == res)
    {
        // test to see if the config file is already present
        res = stat(configFile.c_str(), &sb);
        if (0 == res && sb.st_mode & S_IFREG)
        {
            LOGI("Application config file already present");
        }
        else
        {
            LOGI("Application config file does not exist. Creating it ...");
            // read our application config file from the assets inside the apk
            // save the config file contents in the application's internal storage
            LOGD("Reading config file using the asset manager.\n");

            AAssetManager* assetManager = nativeActivity->assetManager;
            AAsset* configFileAsset = AAssetManager_open(assetManager, "app_config.xml", AASSET_MODE_BUFFER);
            const void* configData = AAsset_getBuffer(configFileAsset);
            const off_t configLen = AAsset_getLength(configFileAsset);
            FILE* appConfigFile = std::fopen(configFile.c_str(), "w+");
            if (NULL == appConfigFile)
            {
                LOGE("Could not create app configuration file.\n");
            }
            else
            {
                LOGI("App config file created successfully. Writing config data ...\n");
                res = std::fwrite(configData, sizeof(char), configLen, appConfigFile);
                if (configLen != res)
                {
                    LOGE("Error generating app configuration file.\n");
                }
            }
            std::fclose(appConfigFile);
            AAsset_close(configFileAsset);
        }
    }
} 
```

# sql - 如何创建触发器以将值插入到插入时为 Max([ID Field])+1 的 ID 字段中

> ID：11294497
> 
> 赞同：0
> 
> 时间：2012-07-02T13:16:58.567
> 
> 标签：sql, sql-server, triggers

当我添加一条新记录时，我希望 SQL Server 自动添加一个新的 ID。

已经有一些记录已经迁移过来（从 Access），在我完成为其他所需功能准备服务器之前，我将手动迁移更多记录（如果这会影响任何可能的答案）。

实现这一点的最简单方法是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T13:19:07.137

最简单的方法是将 column 设为[`IDENTITY`column](http://msdn.microsoft.com/en-us/library/ms186775.aspx)。[这是一个如何执行此操作的示例](http://www.mssqltips.com/sqlservertip/1397/add-or-drop-identity-property-for-an-existing-sql-server-column/?utm_source=AaronBertrand)（它不像 那样简单`ALTER TABLE`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:19:14.110

使用`Identity`字段类型。这将使用序列中的下一个可用数字自动为您创建一个值。

以下是如何`Identity`在现有表上创建列（添加新列）的示例

```
ALTER TABLE MyTable ADD IdColumn INT IDENTITY(1,1) 
```

# c# - 我可以在 C# 中使用 NetUserGetInfo 吗？

> ID：11294500
> 
> 赞同：1
> 
> 时间：2012-07-02T13:17:02.607
> 
> 标签：c#, namespaces, using

我想在我的代码中使用[http://msdn.microsoft.com/en-us/library/aa370654%28VS.85%29.aspx 。](http://msdn.microsoft.com/en-us/library/aa370654%28VS.85%29.aspx)但由于某种原因，我找不到为其使用的命名空间。我认为可行的三个是

```
using System.DirectoryServices.AccountManagement;
using System.Runtime.InteropServices;
using System.DirectoryServices; 
```

但这些都不起作用。我能找到的所有使用 NetUserGetInfo 的示例都是用 C++ 编写的，而不是 C#。这让我觉得也许我不能在 C# 中使用它。我可以吗？如果是这样，我应该使用什么命名空间来访问 NetUserGetInfo 函数？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:18:40.890

你在找什么命名空间？命名空间是 .NET 特定的概念。这`NetUserGetInfo` 是一个 Win32 非托管函数。如果您想从托管 .NET 代码中调用它，您需要编写一个托管包装器并通过[P/Invoke](http://msdn.microsoft.com/en-us/magazine/cc164123.aspx)调用它。

在这种情况下，这是一个[有用的站点](http://www.pinvoke.net/default.aspx/netapi32.netusergetinfo)，它说明了以下托管包装器：

```
[DllImport("Netapi32.dll", CharSet=CharSet.Unicode, ExactSpelling=true)]
private extern static int NetUserGetInfo(
    [MarshalAs(UnmanagedType.LPWStr)] string ServerName,
    [MarshalAs(UnmanagedType.LPWStr)] string UserName, 
    int level, 
    out IntPtr BufPtr
); 
```

用户定义的结构：

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
public struct USER_INFO_10
{
    [MarshalAs(UnmanagedType.LPWStr)]
    public string usri10_name;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string usri10_comment;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string usri10_usr_comment;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string usri10_full_name;
} 
```

和一个示例调用：

```
public bool AccountGetFullName(string MachineName, string AccountName, ref string FullName) 
{
    if (MachineName.Length == 0 ) 
    {
        throw new ArgumentException("Machine Name is required");
    }
    if (AccountName.Length == 0 ) 
    {
        throw new ArgumentException("Account Name is required");
    }
    try 
    {
        // Create an new instance of the USER_INFO_1 struct
        USER_INFO_10 objUserInfo10 = new USER_INFO_10();
        IntPtr bufPtr; // because it's an OUT, we don't need to Alloc
        int lngReturn = NetUserGetInfo(MachineName, AccountName, 10, out bufPtr ) ;
        if (lngReturn == 0) 
        {
            objUserInfo10 = (USER_INFO_10) Marshal.PtrToStructure(bufPtr, typeof(USER_INFO_10) );
            FullName = objUserInfo10.usri10_full_name;
        }
        NetApiBufferFree( bufPtr );
        bufPtr = IntPtr.Zero;
        if (lngReturn == 0 ) 
        {
            return true;
        }
        else 
        {
            //throw new System.ApplicationException("Could not get user's Full Name.");
            return false;
        }
    } 
    catch (Exception exp)
    {
        Debug.WriteLine("AccountGetFullName: " + exp.Message);
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T13:19:49.010

`NetUserGetInfo`是需要 P/Invoked 的 Win32 API。使用 .NET 时，最好使用 .NET 字典服务 API。UserPrincipal类[可能](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.userprincipal)是一个很好的起点。

# jquery - 拖放时更改类名，反之亦然 - jqueryUI

> ID：11294510
> 
> 赞同：1
> 
> 时间：2012-07-02T13:17:38.543
> 
> 标签：jquery, jquery-ui

我正在使用 jqueryUI 将列表项从一个列表拖放到另一个可排序列表。无论如何，当它从 all-colls-list 删除到可排序列表 coll-selected-list 时，我可以将删除的项目的类从“sortedli”更改为“droppedli”，反之亦然？目前，当我删除它时，它会保留原来的类名。

```
$(function() {
    var lists = [{"listid":"#all-colls-list", "connectid":"#coll-selected-list", "drop":true},
     {"listid":"#coll-selected-list", "connectid":"#all-colls-list", "drop":true}];

    $.each(lists, function(i, list) {
        $(list.listid).sortable({
            connectWith: list.connectid,
            dropOnEmpty: list.drop
        });
    });
});

<ul id="all-colls-list" class="droptrue ui-sortable">
                <li class="sortedli">ahsbah</li>
                <li class="sortedli">bachs</li>
                <li class="sortedli">stah</li>
</ul>

<ul id="coll-selected-list" class="droptrue ui-sortable">
              <li class="sortedli" style="">blah</li>
              <li class="sortedli" style="">blah</li>
              <li class="sortedli" style="">blah</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:26:40.237

```
stop: function(event, ui) {
    if ($(ui.item).parents('#all-colls-list').length > 0) {
        $(ui.item).removeClass('droppedli').addClass('sortedli');
    } else {
        $(ui.item).removeClass('sortedli').addClass('droppedli');
    }
} 
```

示例 - [http://jsfiddle.net/s6XTu/9/](http://jsfiddle.net/s6XTu/9/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T08:17:43.153

这是使用 jQuery UI 发生拖放事件时更改类的完整解决方案。

HTML：

```
<ul id="all-colls-list" class="droptrue ui-sortable">
  <li class="sortedli">
      ahsbah
  </li>
  <li class="sortedli">
      bachs
  </li>
  <li class="sortedli">
      stah
  </li>
</ul>

<ul id="coll-selected-list" class="droptrue ui-sortable">
  <li class="sortedli" style="">
      blah
  </li>
  <li class="sortedli" style=""> 
      blah
  </li>
  <li class="sortedli" style="">
      blah
  </li>
</ul> 
```

CSS：

```
#all-colls-list{
   display:inline-block;
   width:200px;
   border:1px solid #331299;
   background-color:#1177a8;
   height:auto;
}

#coll-selected-list{
   display:inline-block;
   width:200px;
   border:1px solid #331299;
   background-color:#a14466;
   height:auto;
}
#all-colls-list li, #coll-selected-list li{
   list-style:none;
}
#all-colls-list li:hover, #coll-selected-list li:hover{
   cursor:move;
   border:2px solid #A1B177;
}

.dropped{
   background-color:#2277a7;
}
.sorted{
   background-color:#a74455;
} 
```

查询：

```
var lists = [{
              "listid": "#all-colls-list",
              "connectid": "#coll-selected-list"
            }, {
              "listid": "#coll-selected-list",
              "connectid": "#all-colls-list"
           }];
  //Apply Sort on each list
  $.each(lists, function(i, list) {
          $(list.listid).sortable({
             connectWith: list.connectid,
             opacity: 0.7,
             start: function(event, ui) {
                 if ($(ui.item).parents('#all-colls-list').length > 0) {
                      $(ui.item).addClass('dropped');
                 } else {
                      $(ui.item).addClass('sorted');
                 }
             },
            stop: function(event, ui) {
               if ($(ui.item).parents('#all-colls-list').length > 0) {
                    $(ui.item).switchClass('droppedli', 'sortedli');
               } else {
                    $(ui.item).switchClass('sortedli', 'droppedli');
               }
               $(ui.item).removeClass('sorted');
               $(ui.item).removeClass('dropped');
            }
       });

 }); 
```

注意：请注意，在运行上述脚本之前，我们必须包含最新的 jquery.js 和最新的 jQuery UI java 脚本文件的完整或最小版本。

我用[http://codebins.com/codes/home/4ldqpc3上的解决方案创建了一个 bin](http://codebins.com/codes/home/4ldqpc3)

# jquery - jquery sortable 打破了轴规则。怎么修？

> ID：11294512
> 
> 赞同：0
> 
> 时间：2012-07-02T13:17:39.143
> 
> 标签：jquery, draggable, jquery-ui-sortable

当我使用可排序时，轴规则变得无效（[jsfiddle示例](http://jsfiddle.net/sP3UZ/)）

我希望该项目仅水平移动。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:44:03.083

添加`axis: x`以限制拖动轴：

```
 $("#sortable").sortable({
        axis: "x",
        revert: true
    }); 
```

[**演示**](http://jsfiddle.net/sP3UZ/1804/)

# c# - 为什么这个泛型类型不能转换？

> ID：11294513
> 
> 赞同：6
> 
> 时间：2012-07-02T13:17:39.237
> 
> 标签：c#, generics

假设我有以下三个类/接口：

```
public interface IImportViewModel
{

}

public class TestImportViewModel : IImportViewModel
{

}

public class ValidationResult<TViewModel> where TViewModel : IImportViewModel
{

} 
```

由于TestImportViewModel 实现了IImportViewModel，为什么下面的编译不出来？

```
ValidationResult<IImportViewModel> r = new ValidationResult<TestImportViewModel>(); 
```

我了解错误消息“无法将类型 'ValidationResult' 隐式转换为 'ValidationResult'”的含义。我只是不明白为什么会这样。这不是协方差吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-02T13:32:16.407

> 这不是协方差吗？

是的，除了在 C# 4.0 中协方差仅适用于接口。所以你必须让你的`ValidationResult`实现一个协变接口（一个通用参数被定义为的接口`out`）：

```
public interface IImportViewModel
{
}

public class TestImportViewModel : IImportViewModel
{
}

public interface IValidationResult<out TViewModel> where TViewModel : IImportViewModel
{
}

public class ValidationResult<TViewModel> : IValidationResult<TViewModel> where TViewModel : IImportViewModel 
{
} 
```

现在你可以这样做了：

```
IValidationResult<IImportViewModel> r = new ValidationResult<TestImportViewModel>(); 
```

# jquery - jquery 从 1.2.6 迁移到 1.7.x

> ID：11294516
> 
> 赞同：1
> 
> 时间：2012-07-02T13:17:44.457
> 
> 标签：jquery, migration

> **可能重复：**
> [Jquery 的向后兼容性有多好？](https://stackoverflow.com/questions/281438/how-good-is-jquerys-backward-compatibility)

我正在开发和管理一段时间的购物网站。

刚开始时，我们使用了 jQuery，它当时是 1.2.6 版，直到最近才看到需要升级。

我现在遇到错误，由于某些更改，由于 NDA，我无法在此处披露，并且想用更新的版本（即 1.7.x）试试我的运气

它是否完全向后兼容，是否有从旧版本迁移的指南？

或者更好的是，有人可以指出可能的问题点吗？

编辑：为了说明这一点，我已经在暂存区尝试了 1.7。不太明显的部分：错误消失了，我想进一步测试，但测试时间很宝贵（而且是无偿的，不用说），所以我问你们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:49:01.483

最显着的向后不兼容是`.prop`在 1.6.x 中的引入，它破坏了`.attr` ^(1的一些用途)

自 1.4 以来，我一直在广泛使用 jQuery（尽管不如你的 1.2），并且不记得任何其他实际破坏代码的更改。

还有一些功能已*弃用*，但不一定已删除（请参阅[http://api.jquery.com/category/deprecated/](http://api.jquery.com/category/deprecated/)）。

jQuery 团队也已经宣布了他们计划在 1.8 中弃用的东西的计划，并可能在 1.9 中完全删除（例如`$.browser`）

* * *

¹一些人`.attr`用来访问某些数据，这些数据是 DOM 对象的严格属性，而`.attr`应该反映*从服务器下载*的实际元素。例如，`.attr('checked')`告诉你一个复选框*最初*是否被选中，而`.prop('checked')`告诉你它*当前*是否被选中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:30:05.117

好吧，jQuery 并不完全向后兼容：也许您会发现[类似的讨论](https://stackoverflow.com/questions/9315791/moving-from-jquery-1-4-x-to-1-7-x)很有帮助。如果您的 JS 代码库已经显示错误，我会说这一举动绝对值得。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T14:42:12.627

Drupal 6 提供了开箱即用的 jQuery 1.2，而 jQuery 更新模块只能升级到 jQuery 1.3，因为有些东西在其他方面被破坏了。

您真的应该在您的环境中进行测试，没有人可以回答您。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T13:42:06.750

一般来说，升级 jquery 比使用旧版本的新代码更容易，因为大多数旧功能或行为只是被弃用但没有被删除。建议保持最新状态，因为旧版本中也存在更多安全问题。但无论如何，你*必须*期待错误......

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-07-02T13:32:54.067

您应该更新 jQuery，因为版本号越高，其中的错误越少，并且速度越快。

但我认为它**可能会导致问题。**例如，某些插件不适用于某些版本。

# c++ - c++中的快速编译

> ID：11294517
> 
> 赞同：3
> 
> 时间：2012-07-02T13:17:53.490
> 
> 标签：c++, compilation

我有一个具有许多功能的 c++ 程序，并且每个功能都有不同的 .cpp 文件。在主程序中，我只提供几个参数并调用函数。但是，完整的东西的编译需要很多时间。对于每次编译，我只更改主程序中的几个参数，并保留所有功能。有没有办法加快编译速度。？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T13:26:06.183

您正在重新编译不必要的代码。通常 IDE 会自动处理这个问题。否则，这取决于您如何编译代码。例如这样的行：

```
g++ *.cpp 
```

或者

```
g++ -o program a.cpp b.cpp c.cpp 
```

非常慢，因为在每次编译时，您都会重新编译所有内容。

如果您正在编写 Makefile，则应小心编写以避免重新编译。例如：

```
.PHONY: all
all: program

program: a.o b.o c.o
    g++ -o $@ $^ $(LDFLAGS)
%.o: %.cpp
    g++ $(CXXFLAGS) -o $@ $<
# other dependencies:
a.o: a.h
b.o: b.h a.h
c.o: c.h 
```

在上面的例子中，改变`c.cpp`导致程序的编译`c.cpp`和链接。更改`a.h`导致程序的编译`a.o`和`b.o`链接。也就是说，在每次构建时，您都编译尽可能少的文件以使程序保持最新。

旁注：编写 Makefile 时要小心。如果您错过了一个依赖项，您可能无法编译足够的文件，并且您最终可能会遇到难以发现的分段错误（充其量）。`gcc`另请查看for `-M*`options的手册，您可以在其中使用`gcc`自身生成依赖项，然后`include`在`Makefile`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:26:16.510

*   尽量减少受参数更改影响的代码，理想情况下只更改一个没有人依赖的源文件（main.cpp）。
*   检查你的包含：你真的需要它吗？尽可能使用前向声明（例如 #include 而不是 ），对于您自己的类，前向声明您可以做的。
*   尝试使用 clang ( [llvm.org](http://llvm.org) ) 编译器。它有时比 gcc 编译得更快（假设你在 linux/unix 上）并给出更多可读的错误。

编辑：我假设你只是重新编译需要的东西。正如其他人建议的那样，使用构建系统（Makefile、IDE、CMake ...）运行最少数量的编译。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T14:32:31.710

也许这会或不会有太大帮助，但我通过 ssh 运行代码，我知道运行/编译需要很长时间。如果您从数据文件中读取，而不是运行整个数据集，只运行一两个文件以查看您的预期结果。这将是您最终结果的样本，但仍应准确（只是统计数据较少）。一旦您调整了代码以使您满意，然后运行所有内容。**通常**这样你不会有任何问题，而且你的编译时间相对来说要快得多。

# javascript - if-else 值 javascript

> ID：11294518
> 
> 赞同：0
> 
> 时间：2012-07-02T13:17:56.627
> 
> 标签：javascript, if-statement

现在，我正在制作一个聊天框。这是页面的代码，你可以输入你的名字，但我会，当用户输入我的名字（网站管理员的名字）时，用户会出错，因为没有网站管理员。我的 if-else 功能不起作用。有谁能帮助我吗？谢谢

```
<html>
    <head>
<title></title>
<style type="text/css">

    #main{
            width: 400px;
            height: 300px;
            background-color: #333;
            text-align: center;
            position: absolute;
            color: white;
            left:50%;
            margin-left: -200px;
            top: 50%;
            margin-top: -150px;
            }

        </style>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
        <script type="text/javascript">

        function show() {
        var text = document.getElementById('text');
        if (text.value == "Jonathan Cazaerck"){alert("Deze gebruiker mag u niet gebruiken");}
        else{
        $.post("processing.php", { stage: "newuser", username: $("#text").val()}, function(data){
        window.location = ("newsession.php?user="+data);}
        );}
  </script>
    </head>
    <body>
    <div id="main"><br><br><br><br>
    Geef je voor- en achternaam op: <br><br><input type="text" size="35" id="text"/><button id="send" onclick="show();">Verzenden</button>
    </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:25:47.727

您`}`的表演功能缺少结束语。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:25:47.537

您需要`}`在代码末尾再添加一个。

```
 <script type="text/javascript">

    function show() {
    var text = document.getElementById('text');
    if (text.value == "Jonathan Cazaerck"){alert("Deze gebruiker mag u niet gebruiken");}
    else{
    $.post("processing.php", { stage: "newuser", username: $("#text").val()}, function(data){
    window.location = ("newsession.php?user="+data);}
    );}
    } 
```

# ruby-on-rails-3 - 如何在不同的控制器中使用不同的模型

> ID：11294523
> 
> 赞同：0
> 
> 时间：2012-07-02T13:18:03.567
> 
> 标签：ruby-on-rails-3

在我的 Rails 应用程序中，有 home_controller.rb，我想在其中使用不相关的表（用户模型）。当我访问 example.com/home/index 时，我希望它向用户表中的第四个 id 人发送消息。我正在使用邮箱 gem 发送消息。

我将这些添加到 home_controller.rb

```
class HomeController < ApplicationController

    def index
     receipt = User.find(4)
     receipt.send_message(receipt, "Body2", "subject2")
    end

end 
```

在家庭模型中，它完全是空的。

它肯定会发送消息。但它会发送给当前用户的第一个 id 人。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T14:01:31.480

听起来该`send_message`方法将电子邮件传递给接收方法调用的对象，而不是第一个参数中的对象。试着打电话

```
receipt.send_message(receipt, "Body", "subject") 
```

# javascript - 使用 getJSON 将多个数组作为参数传递给 Home Controller

> ID：11294524
> 
> 赞同：0
> 
> 时间：2012-07-02T13:18:09.027
> 
> 标签：javascript, jquery, getjson

我必须对需要传递多个数组的家庭控制器进行 json 调用。

```
 var assetids = new Array(N);
 var faultTimes = new Array(N);
 var messages = new Array(N);
 var curtailments = new Array(N);

 //populate above arrays with values then make a JSON call

$.getJSON('Home/AcknowledgeMany', {
                        assetid: assetids,
                        loggedBy: $("#UserName").text(),
                        faultTime: faultTimes,
                        message: messages,
                        curtailment: curtailments
                    }, function (result) {
                          alert(result); 
                       } 
```

家庭控制器有以下动作结果

```
public string AcknowledgeMany(int[] assetId, string loggedBy, string[] faultTime, string[] message, string[] curtailment)
 {

 return("Acknowledged");
} 
```

进行此调用时，我收到所有数组的空值。有人可以帮我传递数组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:32:53.217

尝试设置`traditional`标志

有关详细帮助，请参阅[此](https://stackoverflow.com/questions/3676883/send-list-array-as-parameter-with-jquery-getjson)问题

# python - 如何使用 GAE 数据存储对合同数据库（具有多个买家或卖家）进行建模

> ID：11294526
> 
> 赞同：0
> 
> 时间：2012-07-02T13:18:30.387
> 
> 标签：python, google-app-engine, google-cloud-datastore, non-relational-database

我是编程新手，我正在尝试掌握 GAE 数据存储的概念。我正在尝试构建一个应用程序以简化编写合同（http://contractpy.appspot.com），我想知道：如何为数据库建模以记录合同（考虑到合同可以有**几个人在交易的同一侧**）？

在关系模型中，我将执行以下操作：为人员创建一个表，然后为合同创建一个表，并参考参与该合同的人员创建第三个表。看起来像这样（我猜）：

```
CREATE TABLE people(
 id INTEGER(8) NOT NULL AUTO_INCREMENT PRIMARY KEY,
 name VARCHAR(250) NOT NULL,     
 profession VARCHAR(30),
 driverLicense VARCHAR(12),
 address VACHAR(60) 
)ENGINE=InnoDB CHARACTER SET utf8 COLLATE utf8_general_ci;

CREATE TABLE contracts(
idContract INTEGER(7) NOT NULL AUTO_INCREMENT PRIMARY KEY,
contractType VACHAR(12), # purchase contract, rental contract etc.
contractDate DATE,
place VACHAR(12),
)ENGINE=InnoDB CHARACTER SET utf8 COLLATE utf8_general_ci;

CREATE TABLE contractingParties(
FK_id INTEGER(7) NOT NULL FOREIGN KEY(FK_id) references people(id),
FK_idContract INTEGER(7) NOT NULL FOREIGN KEY(FK_idContract) references contracts(idContract),    
condition VACHAR(12), # e.g., buyer, seller, renter, owner etc.
)ENGINE=InnoDB CHARACTER SET utf8 COLLATE utf8_general_ci; 
```

我的问题是：在 GAE 数据存储中执行此操作的最佳方法是什么？我在下面画了一个草图，但我不确定这是使用 GAE 数据存储非关系概念的正确思维方式。

我在 Python 2.7 中使用 GAE。

提前感谢您的任何帮助/建议！

```
class People(db.Model):
    name = db.StringProperty(required = True)
    profession = db.StringProperty(required = True)
    driverLicense = db.IntegerProperty(required = True)
    address = db.PostalAdressProperty(required = True)

class Contracts(db.Model):
    idContract = db.IntegerProperty(required = True)
    contractType = db.StringProperty(required = True, choices=set(["Purchase Agreement", "Rental House", "Rental Car"]))
    contractDate =  db.DateProperty (required = True, auto_now = True, auto_now_add = True)
    place = db.StringProperty(required = True)
    parties = db.ReferenceProperty(ContractingParties, required = True)

class ContractingParties(db.Model):
    person = db.ReferenceProperty(People, required=True)
    contract = db.ReferenceProperty(Contracts, required=True)
    condition = db.StringProperty(required = False, choices=set(["buyer", "seller", "renter", "owner", "witness"])) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T23:49:26.933

只是前面的一些想法。不要在您的课程中使用复数形式。当你获取一个实体时，它不是一个“人”，而是一个人或一方。您也有错误的参考属性。作为起点，您可以使用以下内容。

```
class Person(db.Model):
  name = db.StringProperty(required = True)
  profession = db.StringProperty(required = True)
  driverLicense = db.IntegerProperty(required = True)
  address = db.PostalAdressProperty(required = True)

class Contract(db.Model):
  idContract = db.IntegerProperty(required = True)
  contractType = db.StringProperty(required = True, choices=set(["Purchase Agreement",        "Rental House", "Rental Car"]))
  contractDate =  db.DateProperty (required = True, auto_now = True, auto_now_add = True)
  place = db.StringProperty(required = True)

class ContractingParty(db.Model):
  person = db.ReferenceProperty(People, required=True, collection_name="party_to_contracts")
  condition = db.StringProperty(required = False, choices=set(["buyer", "seller", "renter", "owner", "witness"])) 
```

有些事情要注意。

1.  除非您需要可设置的（外部来源的）合同编号，否则您不需要合同实体中的 idContract。实体 Key 将足以唯一标识合同。
2.  以 Contract 作为父级创建 ContractingParty 实体。那么与合同相关的所有 ContractingParty 实体都将是子实体，并且在同一个实体组中。
3.  请注意人员属性 ContractingParty 中的 collection_name。这意味着给定一个人员对象，您可以获取所有引用该人员的 ContractingParty 记录。`<someperson>.party_to_contracts.run()`. 然后，您可以通过调用它从 ContractingParty 实体获取合同`parent()`。您仍然可以在不定义collection_name 的情况下执行此操作，但在这种情况下，它将被称为contractingparty_set。
4.  给定一份合同，您可以获取所有各方`ContractingParty.all().ancestor(thecontract).run()`

如果没有完全了解您的应用程序，我不能直接推荐更精致的模型，但这会起作用并且基于您在这里尝试做的事情。

希望能帮助到你。

# c# - 自定义任务框架

> ID：11294533
> 
> 赞同：0
> 
> 时间：2012-07-02T13:19:02.817
> 
> 标签：c#, .net, multithreading, task-parallel-library

我想知道是否存在可以管理一些“任务”的框架。

我知道[Task Parallelism](http://msdn.microsoft.com/en-us/library/dd537609.aspx)，但是（如果我错了，请纠正我）我认为它不符合我的需求（主要是因为它适用于完成的任务列表）。

我的基本需求是我想给 X 线程一些工作去做。

**但是**：

*   每个任务都可以生成创建新任务以在将来执行（可以是 0 个任务，也可以是 100 个任务
*   如果我的任务列表为空，我希望我的非工作线程等待所有线程完成他们的任务，也许我有一个最后一个线程正在运行，这将生成 50 个其他 3 个线程可以处理的新任务。

你知道什么可以帮助我吗？还是我必须手动管理所有事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T13:21:46.227

TPL 将通过它的声音工作。您可以创建子任务，并且可以使用[WaitAll](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.waitall.aspx)来确保所有任务都已完成。

这样您也不必担心线程管理。

在不了解您的代码的情况下，它似乎可能类似于以下伪代码：

```
//for loop to create tasks
var task = new Task(()=>Task.Factory.StartNew(()=>dostuff));
taskList.Add(task)
//end for loop

Task.WaitAll(taskList); 
```

**更新**：

我也忘记了子任务需要在内部任务中标记，否则外部任务不会等待。[这是关于嵌套任务以及如何使用它们的 MSDN](http://msdn.microsoft.com/en-us/library/dd997417.aspx)。但是，简而言之，当您创建嵌套任务时，您必须将其标记为附加到父任务。

```
TaskCreationOptions.AttachedToParent 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-07T13:31:15.393

看看非常适合分布式并行任务处理的 Actor Framework，有[一个列表，](http://en.wikipedia.org/wiki/Actor_model)这里是.NET 上的[一个](http://code.google.com/p/n-act/)

# python - 在python中验证字符串是否为JSON？

> ID：11294535
> 
> 赞同：23
> 
> 时间：2012-07-02T13:19:09.327
> 
> 标签：python, json, dictionary

我在 Python 中有一个字符串，我想知道它是否是有效的 JSON。

`json.loads(mystring)` 如果字符串不是 JSON 但我不想捕获异常，则会引发错误。

我想要这样的东西，但它不起作用：

```
if type(mysrting) == dict:
    myStrAfterLoading = json.loads(mystring)
else:
    print "invalid json passed" 
```

我是否必须捕获该 ValueError 才能查看我的字符串是否为 JSON？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-07-02T13:27:28.140

正确答案是：停止不想抓住[`ValueError`](https://docs.python.org/2/library/exceptions.html#exceptions.ValueError).

**如果字符串是有效的 json，则 Python 脚本示例返回布尔值：**

```
import json

def is_json(myjson):
    try:
        json_object = json.loads(myjson)
    except ValueError as e:
        return False
    return True

print(is_json('{}'))              # prints True
print(is_json('{asdf}'))          # prints False
print(is_json('{"age":100}'))     # prints True
print(is_json('{'age':100 }'))    # prints False
print(is_json('{"age":100 }'))    # prints True 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-07-02T13:21:47.213

要验证字符串需要解析它 - 所以如果你检查然后转换它实际上需要两倍的时间。捕捉异常是最好的方法。有趣的是，您仍然可以使用 if-else 样式表达式：

```
try:
    json_object = json.loads(json_string)
except ValueError, e:
    pass # invalid json
else:
    pass # valid json 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-07-02T13:22:18.413

您是否有任何理由不想捕获异常？

请记住，在 Python 中测试和捕获异常可能非常快，并且通常是 Python 的做事方式，而不是测试类型（基本上，相信鸭子类型并做出相应的反应）。

为了让您放心一点，请看这里： [Python if vs try-except](https://stackoverflow.com/questions/3929837/python-if-vs-try-except/3929887#3929887)

如果您仍然担心可读性，请在代码中添加注释以解释您使用 try/except 的原因；）

过去，我自己在 Java 背景中一直在努力使用这种方法，但这*确实*是在 Python 中执行此操作的最简单方法……而且简单胜于复杂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-12T14:03:21.953

最**安全的函数**，它还可以捕获传递类型`TypeError`时发生的情况`None`

```
import json

def json_loads_safe(data):
    try:
        return json.loads(data)
    except (ValueError, TypeError):
        return None 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2017-07-05T12:36:47.433

为什么解析时可以使用如下类型：

```
def is_json(myjson):
    return type(myjson) == type({})

def is_json_arr(myjson):
    return type(myjson) == type([{}]) 
```

# asp.net - ObjectDataSource 使用哪种区域性将字符串转换为 DateTime

> ID：11294536
> 
> 赞同：1
> 
> 时间：2012-07-02T13:19:10.910
> 
> 标签：asp.net, .net

我刚刚在这里描述了我的问题：[ObjectDataSource failed to parse string to DateTime](https://stackoverflow.com/questions/11294069/objectdatasource-fails-to-parse-string-to-datetime)。经过一些谷歌查询后，我发现了这个链接：[ObjectDataSource – 无法将参数值的值从 System.String 转换为 System.DateTime](http://www.joe-stevens.com/2009/07/30/objectdatasource-cannot-convert-value-of-parameter-value-from-system-string-to-system-datetime/)，并简短说明：

> 我最近多次遇到的一个错误是在使用带有 GridView 的 ObjectDataSource 来更新日期时。进行更新时，ObjectDataSource 始终使用 en-US 文化，而不是为应用程序定义的文化。微软已经承认了这个错误，但从未修复过。

涉及手动解析的解决方法是......不可接受:)您知道针对该问题的任何其他对程序员更友好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:39:51.570

尽管此问题显然从未得到解决，但您可以使用[此链接](http://connect.microsoft.com/VisualStudio/feedback/details/105016/objectdatasource-ignores-culture-information-when-updating)中提供的几种解决方法。不知道为什么解析是不可接受的。它可以在 1 行代码中完成：

```
DateTime myDate = DateTime.Parse(myTextBox.Text, CultureInfo.CurrentCulture.DateTimeFormat); 
```

请注意，文化不是硬编码的（这是我能想到的唯一原因，这会让这不可接受）。

# c++ - 如何在函数调用中正确使用 CComPtr？

> ID：11294537
> 
> 赞同：1
> 
> 时间：2012-07-02T13:19:11.413
> 
> 标签：c++, com, directshow, atl

我是 COM 和智能指针的新手，我正在尝试将项目从原始指针转换为 CComPtr 以避免内存管理的麻烦。我正在寻找有关如何在一般功能和范围方面正确使用 CComPointers 的一些建议。我的代码示例。

```
int  DisplayDeviceInformation(IEnumMoniker * pEnum, IMoniker * pMoniker)
{
    CComPtr<IPropertyBag> pPropBag = NULL;

    while (pEnum->Next(1, &pMoniker, NULL) == S_OK)
    {

        HRESULT hr = pMoniker->BindToStorage(0, 0, IID_PPV_ARGS(&pPropBag));
        if (FAILED(hr))
        {

        } 

        VARIANT var;
        VariantInit(&var);

        // Get description or friendly name.
        hr = pPropBag->Read(L"Description", &var, 0);
        if (FAILED(hr))
        {
            hr = pPropBag->Read(L"FriendlyName", &var, 0);
        }
        if (SUCCEEDED(hr))
        {
            printf("%S\n", var.bstrVal);
            VariantClear(&var); 
        }

        hr = pPropBag->Write(L"FriendlyName", &var);

        // WaveInID applies only to audio capture devices.
        hr = pPropBag->Read(L"WaveInID", &var, 0);
        if (SUCCEEDED(hr))
        {
            printf("WaveIn ID: %d\n", var.lVal);
            VariantClear(&var); 
        }

        hr = pPropBag->Read(L"DevicePath", &var, 0);
        if (SUCCEEDED(hr))
        {
            // The device path is not intended for display.
            printf("Device path: %S\n", var.bstrVal);
            VariantClear(&var); 
        }

    }
    return 0;
}

CComPtr<IMoniker> pMoniker = NULL;  
CComPtr<IMoniker> pMoniker2 = NULL;
    CComPtr<IEnumMoniker> pEnum = NULL;

    hr = EnumerateDevices(CLSID_VideoInputDeviceCategory, &pEnum);
//pEnum->Next(1, &pMoniker,&cFetched);

    if (SUCCEEDED(hr))
    {
        DisplayDeviceInformation(pEnum, pMoniker);     
    }
    pEnum = NULL;
    hr = EnumerateDevices(CLSID_AudioInputDeviceCategory, &pEnum);
    //pEnum->Next(1, &pMoniker2,&cFetched);
    if (SUCCEEDED(hr))
    {
        DisplayDeviceInformation(pEnum, pMoniker);
    } 
```

基本上，第一个`DisplayDeviceInformation(pEnum, pMoniker);`给出 ap==0 错误。但是，如果我取消注释`pEnum->Next(1, &pMoniker,&cFetched);`它会起作用。使用原始指针我不必这样做，因为代码只是跳到下一个设备。任何建议或帮助都会让我非常感激，在此先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:31:52.780

Where`CComPtr`给你一个断言失败，你也可能遇到原始指针的问题。您只是没有得到预先警告，问题稍后会出现，例如作为参考泄漏。

1.  您似乎不需要`IMoniker`在全球范围内
2.  您需要`IMoniker`在为枚举器提供指针之前清除指针

见下文：

```
int DisplayDeviceInformation(IEnumMoniker* pEnum, IMoniker** ppSelectedMoniker)
{
    CComPtr<IMoniker> pMoniker;
    while (pEnum->Next(1, &pMoniker, NULL) == S_OK)
    {
        CComPtr<IPropertyBag> pPropBag; // You need it clear to start from for every moniker
        HRESULT hr = pMoniker->BindToStorage(0, 0, IID_PPV_ARGS(&pPropBag));
        // ...
        if(we should stop enumeration and we are good with current moniker)
        {
            //ATLASSERT(ppSelectedMoniker != NULL);
            *ppSelectedMoniker = pMoniker.Detach();
            return ...
        }
        // ...
        pMoniker.Release(); // You have to do this, so that next Next would accept empty CComPtr as an argument
    }
    return 0;
}

CComPtr<IEnumMoniker> pEnumVideoMoniker;
CComPtr<IMoniker> pSelectedVideoMoniker;
hr = EnumerateDevices(CLSID_VideoInputDeviceCategory, &pEnumVideoMoniker);
if (SUCCEEDED(hr))
    DisplayDeviceInformation(pEnumVideoMoniker, &pSelectedVideoMoniker);     
CComPtr<IEnumMoniker> pEnumAudioMoniker;
CComPtr<IMoniker> pSelectedAudioMoniker;
hr = EnumerateDevices(CLSID_AudioInputDeviceCategory, &pEnumAudioMoniker);
if (SUCCEEDED(hr))
    DisplayDeviceInformation(pEnumAudioMoniker, &pSelectedAudioMoniker); 
```

# ios - iOS - 如何检测电源是否连接到 iDevice 广告正在充电

> ID：11294542
> 
> 赞同：1
> 
> 时间：2012-07-02T13:19:30.413
> 
> 标签：ios, apple-push-notifications, power-management

我正在尝试确定他的设备是否已插入并正在充电。如何在 ios 5.x 或更高版本中查找？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:21:27.073

你可以`UIDevice`用来获取这些信息

使用以下

```
[[UIDevice currentDevice] setBatteryMonitoringEnabled:YES];

if ([[UIDevice currentDevice] batteryState] == UIDeviceBatteryStateCharging)
    NSLog(@"device is conected to power"); 
```

# javascript - 带有嵌套标记的 Tinymce 元素

> ID：11294544
> 
> 赞同：1
> 
> 时间：2012-07-02T13:19:32.940
> 
> 标签：javascript, tinymce

我从我们的前端人员那里得到了标题代码：

```
<h2 class="headline"><span>Foobar</span></h2> 
```

跨度存在一些视觉元素。

现在，我怎样才能使这种“复杂”（对于最终用户）在 tinymce 上可用，以便用户可以定义正确的标题？我找到了[模板插件](http://www.tinymce.com/wiki.php/Plugin%3atemplate)，但是，这看起来有点过于复杂。因此，基本上，如果我可以让 tinymce`span`在用户将某些内容标记为“标题 2”时插入类名和元素，那就太好了。那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T09:44:00.260

是的，这是可能的。但是，如果您正在寻找一个简单的解决方案......我不知道简单的解决方案是否足够。这里是：

把它放在你的tinymce init中：

```
setup : function(ed) {

    ed.onNodeChange.add(function(ed, evt) {
        $(ed.getBody()).find('p').addClass('headline');
    });
}, 
```

# c - 为什么我不能从我的循环中捕获这些 KeyPress / KeyRelease 事件？

> ID：11294545
> 
> 赞同：3
> 
> 时间：2012-07-02T13:19:37.507
> 
> 标签：c, x11, keypress, xlib

我想记录所有传入的按键事件，无论哪个窗口处于焦点或指针在哪里。我已经编写了示例代码，它应该捕获当前窗口的按键事件（见下文）。为了保持我的代码可读性，我只给出了焦点窗口的示例代码。由于我的最终目标是捕获屏幕上的按键事件，而不考虑焦点所在的窗口，因此我计划用于`XQueryTree`获取所有 Windows 并应用相同的逻辑。

我打电话`XGrabKeyboard`来捕捉键盘，因为焦点窗口可能已经在捕捉键盘事件。使用我的示例代码，我可以抓取键盘，但无法接收循环内任何键盘键的事件`KeyPress`。`KeyRelease``while`

我在代码中遗漏了什么以允许我接收事件？

示例代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <locale.h>
#include <stdint.h>
#include <stdarg.h>
#include <errno.h>
#include <pthread.h>
#include <X11/Xlib.h>
#include <X11/Xos.h>
#include <X11/Xfuncs.h>
#include <X11/Xutil.h>

#include <X11/Xatom.h>
int _invalid_window_handler(Display *dsp, XErrorEvent *err) {
    return 0;
}

int main() 
{
    Display *display = XOpenDisplay(NULL); 
    int iError;
    KeySym k;
    int revert_to;
    Window window;
    XEvent event;
    Time time;
    XSetErrorHandler(_invalid_window_handler);
    XGetInputFocus(display, &window, &revert_to);
    XSelectInput(display, window, KeyPressMask | KeyReleaseMask );
    iError = XGrabKeyboard(display, window,
                          KeyPressMask | KeyReleaseMask,
                          GrabModeAsync,
                          GrabModeAsync,
                          CurrentTime); 
    if (iError != GrabSuccess && iError == AlreadyGrabbed) {
        XUngrabPointer(display, CurrentTime);
        XFlush(display);
        printf("Already Grabbed\n");    
    } else if (iError == GrabSuccess) {
        printf("Grabbed\n");
    }
    while(1) {
          XNextEvent(display,&event);
          switch (event.type) {
              case KeyPress : printf("Key Pressed\n"); break;
              case KeyRelease : printf("Key Released\n"); break;
              case EnterNotify : printf("Enter\n"); break;
          }
    }
    XCloseDisplay(display);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T13:44:12.093

XGrabKeyboard 的参数 3 是引用手册页：

> owner_events ：指定一个布尔值，指示是否要像往常一样报告键盘事件。

所以应该是真或假，而不是事件掩码。

# javascript - 如何在下拉事件更改时使用 jquery 清除或清空列表框

> ID：11294554
> 
> 赞同：3
> 
> 时间：2012-07-02T13:20:00.163
> 
> 标签：javascript, jquery, jquery-ui

任何机构都可以帮助我如何在下拉事件更改时清除列表框中的项目。

```
$(function () {
        $("#ddlLevelColumn").change(function () {
            $("#lstCodelist") ------ I need to clear this listbox1
            $("#lbxSelectedItems")--------------- need to clear list box 2

        });
    });

 <%:Html.ListBox("lstCodelist", Model.CodeListDefaultValue, new { style = "width:99%;height:297px;" })%>
<%:Html.ListBox("lbxSelectedItems", Model.AffectedCodeListboxData, new { style = "width:99%;height:297px;color:blue;" })%> 
```

谢谢你的帮助..

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-02T13:24:55.853

[空的（）](http://api.jquery.com/empty/)

```
$("#lstCodelist").empty()
$("#lbxSelectedItems").empty() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-02T13:23:53.460

您可以删除所有条目（或也应用过滤器）：

```
$('#listBoxId > option').remove();           // all options
$('#listBoxId > option[val!=""]').remove(); // keep non-empty values 
```

这就是你的目的？我相信更简单：

```
$('#listBoxId').empty(); 
```

也应该工作。

工作演示：http: [//jsfiddle.net/jEWe6/](http://jsfiddle.net/jEWe6/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T13:24:56.523

我想`.empty()`这就是你要找的。

> 从 DOM 中删除匹配元素集的所有子节点。

[http://api.jquery.com/empty/](http://api.jquery.com/empty/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T14:15:58.337

您可以使用以下内容清除选择的 html 元素：

```
var clear = function() {
  $("#lstCodelist").empty().append('<option value="whatever">Wait for reload</option>');
  $("#lbxSelectedItems").empty().append('<option value="whatever">Wait for reload</option>');
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-19T07:13:20.483

您也可以尝试这两种方法中的任何一种。

1.  `$('#RolesListAvailable').html('');`

或者

2.  `$('#RolesListAssigned').empty();`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-13T11:24:59.227

试试这个....

```
$('#listBoxId').empty(); 
```

# c++ - 在 DLL 中创建 MSMQ 队列的异常

> ID：11294555
> 
> 赞同：0
> 
> 时间：2012-07-02T13:20:17.450
> 
> 标签：c++, winapi, dll, msmq

我正在尝试将一些 MSMQ 功能编码到 dll (c++) 中，但遇到了麻烦。本质上，当我调用创建队列时，会引发低级异常（参见下面的调用堆栈）。令我沮丧的是，这段代码在可执行文件中运行良好，只有在它位于 dll 中时它似乎才会失败。我已经对代码进行了一些清理，并将其包含在下面。

调用栈：

```
KernelBase.dll!_RaiseException@16()  + 0x58 bytes   
msvcrt.dll!__CxxThrowException@8()  + 0x45 bytes    
mqsec.dll!CCancelRpc::Init()  + 0xa5 bytes  
mqrt.dll!CFreeRPCHandles::Add()  + 0x1bc bytes  
mqrt.dll!RtpOneTimeThreadInit()  + 0x39 bytes   
mqrt.dll!_MQCreateQueue@16()  + 0x23 bytes  
mqoa.dll!CMSMQQueueInfo::Create()  + 0xba bytes 
```

代码：

```
 HRESULT CreateQueue()
 {
    HRESULT hr = CoInitializeEx(NULL, COINIT_MULTITHREADED);

    CComQIPtr<IMSMQQueueInfo, &IID_IMSMQQueueInfo> ipQueueInfo;

    hr = CoCreateInstance(CLSID_MSMQQueueInfo,
     NULL,
     CLSCTX_SERVER,
     IID_IMSMQQueueInfo,
     (void**)(&ipQueueInfo.p));

    if(hr != S_OK)
      return hr;

    hr = ipQueueInfo->put_PathName(L".\\private$\\TestQueue");
    if(hr != S_OK)
       return hr;

    VARIANT vtFalse;
    VariantInit(&vtFalse);
    vtFalse.vt = VT_BOOL;
    vtFalse.boolVal = FALSE;
    hr = ipQueueInfo->Create(&vtFalse, &vtFalse);
    return hr;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T06:39:12.283

MSDN[在这里](http://msdn.microsoft.com/en-us/library/windows/desktop/ms695279%28v=vs.85%29.aspx)说，因为无法控制进程内服务器加载或卸载的顺序，所以不应从[DllMain](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682583%28v=vs.85%29.aspx)函数调用 CoInitializeEx。

你是`CreateQueue`从 DllMain 打来的吗？

# django - 在 OSX 上缺少 libgeos_c.so

> ID：11294556
> 
> 赞同：16
> 
> 时间：2012-07-02T13:20:22.190
> 
> 标签：django, macos, postgresql, postgis, homebrew

我正在尝试安装 Postgis 以便在 OSX 上使用 GeoDjango。

为此，我首先完全卸载了 postgres，然后按照 GeoDjango 文档安装了所有内容：[https ://docs.djangoproject.com/en/dev/ref/contrib/gis/install/#homebrew](https://docs.djangoproject.com/en/dev/ref/contrib/gis/install/#homebrew)

我做了以下事情：

```
brew update
brew upgrade
brew install postgresql
brew install postgis
brew install gdal
brew install libgeoip 
```

当我运行我的 Django 项目时，我收到以下错误：

```
OSError at / dlopen(/usr/local/lib/libgeos_c.so, 6): image not found 
```

我跑了

```
sudo find . -name "libgeos_c*" 
```

并得到：

```
./Library/Frameworks/GEOS.framework/Versions/3/unix/lib/libgeos_c.dylib
./Users/martin/opt/geos-3.3.0/capi/.deps/libgeos_c_la-geos_c.Plo
./Users/martin/opt/geos-3.3.0/capi/.deps/libgeos_c_la-geos_ts_c.Plo
./usr/local/Cellar/geos/3.3.3/lib/libgeos_c.1.dylib
./usr/local/Cellar/geos/3.3.3/lib/libgeos_c.a
./usr/local/Cellar/geos/3.3.3/lib/libgeos_c.dylib
./usr/local/Cellar/geos/3.3.4/lib/libgeos_c.1.dylib
./usr/local/Cellar/geos/3.3.4/lib/libgeos_c.a
./usr/local/Cellar/geos/3.3.4/lib/libgeos_c.dylib
./usr/local/Cellar/geos/3.3.5/lib/libgeos_c.1.dylib
./usr/local/Cellar/geos/3.3.5/lib/libgeos_c.a
./usr/local/Cellar/geos/3.3.5/lib/libgeos_c.dylib
./usr/local/lib/libgeos_c.1.dylib
./usr/local/lib/libgeos_c.a
./usr/local/lib/libgeos_c.dylib 
```

如您所见，根本没有“.so”文件。有什么建议么？

*编辑：*

出于绝望，我还安装了 KyngChaos 软件包并添加了以下设置：

```
GEOS_LIBRARY_PATH = '/Library/Frameworks/GEOS.framework/GEOS' 
GDAL_LIBRARY_PATH = '/Library/Frameworks/GDAL.framework/GDAL' 
GEOIP_LIBRARY_PATH = '/usr/local/Cellar/geoip/1.4.8/lib/libGeoIP.dylib' 
```

这解决了问题。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-08-22T17:51:47.787

抱歉，KyngChaos 解决方案完全违背了使用自制软件的目的。

自制用户的答案（至少，对于这个）是**卸载`geos`及其依赖项**，**然后重新安装`geos`，然后是依赖项**。

这对我有用：

```
brew uninstall geos gdal geoip libspatialite librasterlite spatialite-gui spatialite-tools
brew cleanup
brew install geos
brew install gdal geoip libspatialite librasterlite spatialite-gui spatialite-tools
brew cleanup 
```

似乎一些`geos`依赖关系变得不同步。

您可以通过跟踪返回的内容来*验证需要安装的库：*

```
python -c 'import _ctypes; _ctypes.dlopen("/usr/local/lib/libgdal.dylib")' 
```

你会看到类似的东西

```
Reason: Incompatible library version: [some geos dependent library].dylib requires version X.X.X or later, but libgeos_c.1.8.0.dylib provides version X.X.X.

brew uninstall [some geos dependency]
brew install [some geos dependency]
brew cleanup 
```

然后重新运行上述`python`命令，问题将得到解决，或者它会揭示另一个需要卸载/安装的依赖项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-07T14:47:28.710

我是这样解决的。

```
$ brew install postgresql
$ brew install postgis
$ brew install gdal
$ brew install libgeoip 
```

然后在 Django 设置中设置：

```
GEOS_LIBRARY_PATH = '/usr/local/Cellar/geos/3.4.2/lib/libgeos_c.1.dylib' 
```

然后它对我有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-02T13:35:39.167

[安装说明](https://docs.djangoproject.com/en/dev/ref/contrib/gis/install/#homebrew)似乎有答案，即设置环境变量`$GEOS_LIBRARY_PATH`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T12:24:33.737

同样在这里 - 按照指示安装所有内容后，我返回并添加了 KyngChaos 库，然后将三个导出语句添加到我的 ~/.bash_profile 中，如上所述。这解决了我的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-15T10:12:02.700

我遇到了同样的问题，并且能够通过从 Homebrew 卸载 GDAL 并从 KyngChaos 安装 GDAL Complete 包来解决它：[http ://www.kyngchaos.com/software/frameworks](http://www.kyngchaos.com/software/frameworks)

# c++ - 包括写在不同文件夹中的函数

> ID：11294557
> 
> 赞同：0
> 
> 时间：2012-07-02T13:20:30.113
> 
> 标签：c++, c++builder, include-path

如何使用在.cpp 中编写的函数，该函数保存在与需要该函数的文件夹不同的文件夹中？对于第一个文件夹的所有 .cpp，我只是`#include`在 cpp 的 .h 中添加了一个（它工作正常），但是尝试将一个添加`#include "..\Folder1\....h"`到第二个文件夹的所有 .cpp 是不够的，Borland C++生成器给了我`Unresolved external`错误。
我能做些什么？
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:22:53.007

您需要将 cpp 文件编译成其自己目录中的目标文件 (.o)，并将该目标文件与您的程序链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:25:44.730

将目标文件的位置添加到链接器搜索路径。

![项目选项对话框](../Images/e454df4bb85ddd9c0684e803a8567f75.png "项目选项对话框")

# android - SMS 被复制为 Calls(Samsung Galaxy S II)

> ID：11294563
> 
> 赞同：1
> 
> 时间：2012-07-02T13:21:02.847
> 
> 标签：android, android-contentprovider, samsung-mobile

好的，伙计们，这是我获取短信的代码：

```
Cursor cursor = getContentResolver().query(Uri.parse(uri),
                null, CallLog.Calls.DATE + " > " + lastSmsTime, null,
                CallLog.Calls.DATE + " ASC"); 
```

类型是：

```
"content://sms/inbox"
"content://sms/sent" 
```

对于电话：

```
String[] projection = new String[] { CallLog.Calls.NUMBER,
                CallLog.Calls.TYPE, CallLog.Calls.DURATION, CallLog.Calls.DATE };
Cursor managedCursor = getContentResolver().query(
                CallLog.Calls.CONTENT_URI, projection,
                CallLog.Calls.DATE + " > " + lastCallTime, null,
                CallLog.Calls.DATE + " ASC"); 
```

首先，我知道这是未记录的提供程序（如您所见，我使用不同的列常量）。

有趣的是，这在几个 2.3.x 设备上运行良好。但现在我在 Galaxy S II（ICS 4.0.3）上尝试了这个。现在所有短信都在呼叫提供商*中重复。*

有没有人遇到过这个问题？

**UPD** 我在[这里](https://stackoverflow.com/questions/7157983/samsung-sms-in-call-log-how-can-i-delete-it)发现了同样的问题，继续寻找解决方案。

**UDD 2 据**我所知，三星现在将所有内容都存储在一个日志中，因此我将尝试找到一种方法来对日志应用程序进行逆向工程。

无论如何，仍在寻找**将短信和电话分开**的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T12:26:24.280

好的，这可能是解决方案，所以我发布它：三星日志提供程序有很多列，其中是

```
logtype 
```

据我所知，通话是 100，短信是 300，彩信是 200。

也可以检测制造商：

> 字符串人 = android.os.Build.MANUFACTURER;

因此，对于三星设备，应该有单独的代码来检查*logtype*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-16T14:06:10.430

```
Cursor query = this.managedQuery(
        CallLog.Calls.CONTENT_URI, null, CallLog.Calls.TYPE + " in ('3','5') OR " + CallLog.Calls.DURATION + ">0 ", null, null);
//Calls.Type is 3 for Missed Calls and 5 for Cancelled Calls and **Calls.Duration** is 0 for Message, Missed Calls and Cancelled Calls 
```

This code worked fine for me. I had went to 3-4 other links but all of them suggested to delete the Log of Message from CallLog. This is probably the only way to get only Voice Call Logs by not writing/deleting from any log

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-02T14:37:40.587

我自己一直在看这个。更通用的解决方案是消除所有持续时间为 0 的来电条目。

# regex - 在 R 中使用正则表达式编辑地址

> ID：11294566
> 
> 赞同：3
> 
> 时间：2012-07-02T13:21:12.763
> 
> 标签：regex, r

我想编辑字符串的地址，例如这个例子：

```
test = c("[Mavlyanova, Nadira G.] Uzbek Acad Sci, GA Mavlyanov Inst Seismol, Tashkent 700135, Uzbekistan; [Markovic, Slobodan B.] Univ Novi Sad, Fac Sci, Chair Phys Geog, Novi Sad 21000, Serbia; [Rowell, G.] Univ Adelaide, Sch Chem & Phys, Adelaide, SA 5005, Australia; [Katarzynski, K.] Nicholas Copernicus Univ, Torun Ctr Astron, PL-87100 Torun, Poland; [Ansari, Z.; Boettcher, M.; Manschwetus, B.; Rottke, H.; Sandner, W.] Max Born Inst, D-12489 Berlin, Germany; [Milosevic, D. B.] Univ Sarajevo, Fac Sci, Sarajevo 71000, Bosnia & Herceg") 
```

我只想得到国家名称。这是我到目前为止所尝试的：

```
> testa <- gsub("\\[.*?\\] ", "", test) #remove square brackets  
> testa <- strsplit(testa, ";", fixed = TRUE) #split adresses  
> testa <- sapply(testa, function(x) gsub("^.*, ([A-Za-z ]*)$", "\\1", x)) #keep only what's after last comma  
> testa <- gsub("^ | $", "", testa) #remove spaces  
> testa  
     [,1]  
[1,] "Uzbekistan"  
[2,] "Serbia"  
[3,] "Australia"  
[4,] "Poland"  
[5,] "Germany"  
[6,] "Univ Sarajevo, Fac Sci, Sarajevo 71000, Bosnia & Herceg" 
```

因此，不幸的是，这不适用于最后一个地址。我想获得以下输出：

```
> testa  
     [,1]                                                       
[1,] "Uzbekistan"  
[2,] "Serbia"  
[3,] "Australia"  
[4,] "Poland"  
[5,] "Germany"  
[6,] "Bosnia & Herceg" 
```

我的问题是：

*   我的 sapply 函数中的错误是什么，导致它也无法正确使用最后一个地址？
*   如何改进它以实现正确的输出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T13:28:51.060

为什么不只是向后工作？

```
testa <- gsub("\\[.*?\\] ", "", test)
testa <- strsplit(testa, ";", fixed = TRUE)
# Remaining steps in question are unnecessary with the solution below

> sub(".+, ([A-Za-z& ]+)$","\\1",testa[[1]])
[1] "Uzbekistan"      "Serbia"          "Australia"       "Poland"          "Germany"         "Bosnia & Herceg" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T13:33:55.880

您的代码的问题在于，您的代码的“最后一个逗号之后的所有内容”部分`[A-Za-z ]`用作之后唯一的有效字符。该集合不包括`&`，因此不会对最后一个地址执行替换。也许您应该使用`[^,]`“除逗号以外的任何内容”来表示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T13:35:07.903

这里已经有一些更好的答案，但我已经解决了这个问题，所以我想我仍然会发布：

```
y <- unlist(strsplit(test, "\\["))
y <- y[y!=""]
z <- sapply(y, function(x) strsplit(x, ","))
lens <- sapply(z, length)
a <- sapply(seq_along(z), function(i) z[[i]][lens[i]])
a <- gsub(";", "", a)
Trim <- function (x) gsub("^\\s+|\\s+$", "", x)
Trim(a) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T15:03:32.383

这是在 gsubfn 包中使用`strapplyc`（或者`strapply`也可以，但`strapplyc`在这里更快）的单行代码。首先附加 a `";"`，`test`然后搜索 a `[`（使用 regexp `"\\["`）后跟除`[`（使用 regexp `"[^[]+"`）之外的任何字符的字符串，后跟逗号和空格 ( `", "`)，后跟除逗号、分号或`[`（使用regexp `"([^,;[]+)"`) 后跟分号 ( `;`) 并仅返回括号内的部分：

```
> library(gsubfn)
> strapplyc(paste0(test, ";"), "\\[[^[]+, ([^,;[]+);", simplify = TRUE)
     [,1]             
[1,] "Uzbekistan"     
[2,] "Serbia"         
[3,] "Australia"      
[4,] "Poland"         
[5,] "Germany"        
[6,] "Bosnia & Herceg" 
```

# java - 自定义工厂模式实现

> ID：11294568
> 
> 赞同：0
> 
> 时间：2012-07-02T13:21:24.827
> 
> 标签：java

我即将在java中实现工厂模式。我在工厂里有一个像 HashMap 这样的地图，我会用我选择的键添加所有具体的实现。密钥由 MyAbstract 类中的抽象方法 getImplName() 定义。

我的要求是当有人扩展 MyAbstractClass 并定义 getImplName() 时，必须将键值对自动添加到工厂映射中，而不是手动执行此操作的代码。这可能吗 ？我在考虑使用自定义注释。让我知道你的建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:29:15.287

在您的抽象类的构造函数中，您应该能够调用 getImplName() 并将其添加到您的地图中（假设您的地图有一个已知实例，否则需要传入）。

或者，您可以在构造函数中添加参数以获取所需的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T05:30:26.670

关于工厂元素是否应该识别工厂方法存在争议。
如果您希望您的元素识别工厂，我建议您采用以下方法：

```
public abstract class MyAbstractClass {
  public MyAbstractClass(MyFactory factory) {
       factory.addElement(getImplName(),this);
  }

  public abstract String getImplName();
}

public class MyTestClass extends MyAbstractClass {
  public MyTestClass(MyFactory factory) {
    super(factory);
  }
} 
```

其中 MyFactory 是具有 HashMap 作为内部字段的工厂
这种方式扩展 MyAbstractClass 的程序员被迫提供一个 CTOR，通过调用超类 CTOR 将类的对象添加到工厂。

# reporting-services - 1 个月限制 - 报告服务

> ID：11294570
> 
> 赞同：1
> 
> 时间：2012-07-02T13:21:30.927
> 
> 标签：reporting-services, ssrs-2008

我正在 Micrososft SQL Reporting Services 中构建一个报告，并且我有两个日期字段，startDate 和 endDate。

我需要限制日期范围，至少在三十天（或一个月）内。例如，如果 startDate 是 2012/01/01 并且 endDate 是 2012/02/02，它应该引发错误消息，否则（相差不到三十天），它可以继续。我如何在报告服务中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T21:50:14.573

您可以使用数据集根据您的 startDate 参数为您的 endDate 参数提供默认值。

添加一个名为 DefaultStartDate 的数据集。将查询文本设置为：

```
select DATEADD(dd, DATEDIFF(dd, 0, getdate()), 0) as [startDate]; 
```

添加一个名为 startDate 的参数。将类型设置为日期/时间并从 DefaultStartDate 查询中获取默认值：

![默认值/数据集=DefaultStartDate/值=startDate](../Images/ddcb7f77a0aefdae6ee38ec71a6f3e61.png)

添加一个名为 ValidEndDates 的数据集。将查询文本设置为如下所示，以根据开始日期生成有效结束日期列表：

```
with A as
( select 1 as i UNION ALL select i+1 from A where i<30 )
select DATEADD(dd, i, @startDate) as [endDate] from A; 
```

添加一个名为 endDate 的参数。将类型设置为日期/时间并从 ValidEndDates 数据集中获取可用值：

![可用值 / DataSet=ValidEndDates / Value=endDate / Label=endDate](../Images/320c087071b354dabbd193060a0c7ad7.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-04T21:35:39.367

这是一个老问题，但有一个答案。解决方案的高级解释是在报表属性中编写代码，添加一个隐藏参数，其中包含验证参数的代码，以及数据集中的条件表达式。详细解释请看以下链接：[https ://gugiaji.wordpress.com/2012/03/26/easy-step-by-step-ssrs-parameter-validation-using-code](https://gugiaji.wordpress.com/2012/03/26/easy-step-by-step-ssrs-parameter-validation-using-code/)

# c++ - C/C++ 中的非 GPL 开源潜在 Dirichlet 分配实现/库

> ID：11294571
> 
> 赞同：-2
> 
> 时间：2012-07-02T13:21:32.733
> 
> 标签：c++, c, machine-learning, nlp, lda

我知道一些实现（主要来自[这个问题](https://stackoverflow.com/questions/6230696/latent-dirichlet-allocation-lda-implementation)），但它们似乎都是在 GPL 下发布的。

有没有没有 GPL 限制的（平台无关的）实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:33:49.440

找到这个：[gensim](http://mloss.org/software/view/273/)。一个 LGPL python 库。

[mloss.org](http://mloss.org)是此类算法的绝佳资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:31:13.320

该问题中的第二个链接[plda](http://code.google.com/p/plda/)是 Apache 2 许可而非 GPL。

# java - Thread.sleep() 永不返回

> ID：11294573
> 
> 赞同：20
> 
> 时间：2012-07-02T13:21:37.027
> 
> 标签：java, sleep

我`Thread.sleep()`在 Java 上遇到了一个奇怪的错误。出于某种原因，当我在某些机器上调用 sleep 时，它永远不会返回。我无法弄清楚可能导致这种行为的原因。起初，我认为错误可能在我的代码中的其他地方，所以我做了最简单的睡眠测试：

```
public class SleepTest {
    public static void main (String [] args) {
        System.out.println ("Before sleep...");
        try {
            Thread.sleep (100);
        } catch (InterruptedException e) {
        }
        System.out.println ("After sleep...");
    }
} 
```

在大多数机器上它都可以工作，但在我远程登录的几台机器上，它在打印语句之间无限期地暂停。我已经等了半个小时，行为没有改变。显示此错误的机器是 Linux 机器。以下是有关机器的一些信息：

```
$ uname -a
Linux zone29ea 2.6.32-220.17.1.el6.x86_64 #1 SMP Tue May 15 17:16:46 CDT 2012 x86_64 x86_64 x86_64 GNU/Linux
$ java -version
java version "1.6.0_22"
OpenJDK Runtime Environment (IcedTea6 1.10.6) (rhel-1.43.1.10.6.el6_2-x86_64)
OpenJDK 64-Bit Server VM (build 20.0-b11, mixed mode) 
```

什么可能导致这种行为？

更新

修订版，仍然永无止境：

```
public class SleepTest {
    public static void main (String [] args) {
        new Thread () {
            public void run () {
                System.out.println ("Before sleep...");
                try {
                    Thread.sleep (100);
                } catch (InterruptedException e) {
                    e.printStackTrace ();
                }
                System.out.println ("After sleep...");
            }
        }.start();
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-02T13:25:58.390

如果您的服务器在 Linux 下运行，您可能会受到上周末出现的[Leap Second 错误的影响。](http://it.slashdot.org/story/12/07/01/1920217/leap-second-bug-causes-crashes)

该漏洞影响Linux内核（线程管理），因此使用线程的应用程序（如JVM、mysql等）可能会消耗高负载的CPU。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-03T07:25:26.273

如果您的服务器使用 NTP（如您所提到的）并且您的 CPU 使用率达到 100%，请检查`Clock: inserting leap second 23:59:60 UTC`您的`dmesg:`，如果您发现，您确定您的服务器受 影响`Leap Second bug`，不幸的是 Java 是受影响最大的。

要解决此问题，请在不重新启动任何服务器（如 tomcat）的情况下运行以下命令。

```
/etc/init.d/ntp stop
date `date +"%m%d%H%M%C%y.%S"` 
```

希望这可以帮助..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T17:49:29.507

这似乎与闰秒有关。

基于来自[https://lkml.org/lkml/2012/7/1/19](https://lkml.org/lkml/2012/7/1/19)的帖子，我做了：

```
date -s "`date`" 
```

它为我解决了问题

# load - 如何使用 vala/genie 和 SDL 加载 png？

> ID：11294581
> 
> 赞同：1
> 
> 时间：2012-07-02T13:22:08.780
> 
> 标签：load, sdl, vala, genie

这段代码给了我一个错误：

```
uses SDL
uses SDLGraphics
uses SDLImage
screen: unowned SDL.Screen
alto: int16=400
ancho:int16 =600
imagen: SDL.Surface
src: SDL.RWops 
init
    SDL.init(SDL.InitFlag.VIDEO)
    screen = SDL.Screen.set_video_mode (ancho, alto, 30, SurfaceFlag.FULLSCREEN | SurfaceFlag.DOUBLEBUF | SurfaceFlag.HWACCEL | SurfaceFlag.HWSURFACE)
    var fin = false
    var y=110
    var x=100
    var radius=10
    var color=1003232242
    var mov_x=1
    var mov_y=3
    src = new SDL.RWops.from_file ("/home/gontzal/Mahaigaina/boy.png", "rb")
    imagen =  SDLImage.load_png (src)
    while fin == false
        event: SDL.Event
        while (Event.poll (out event))== 1
            if event.type ==SDL.EventType.QUIT
                print "adios"
                fin= true
                break
            else if event.type == EventType.KEYDOWN
                fin=true
                break

        if x>ancho do mov_x=-mov_x
        if x<0 do mov_x=-mov_x
        if y>alto do mov_y=-mov_y
        if y<0 do mov_y=-mov_y
        x=x+mov_x
        y=y+mov_y

        Circle.fill_color (screen, x, y, radius, color);
        Circle.outline_color_aa (screen, x, y, radius, color);
        Rectangle.fill_color(screen,0, 0,ancho, alto,1801222)
        screen.flip()

    SDL.quit() 
```

错误：valac --pkg sdl --pkg sdl-gfx --pkg sdl-image -X -lSDL_gfx“SDL.gs”（在目录中：/home/gontzal）/tmp/ccMPg7h0.o：在函数`_vala_main': SDL.vala.c:(.text+0x115): undefined reference to`IMG_LoadPNG_RW'collect2 中： ld 返回 1 个退出状态编译失败：1 个错误，0 个警告错误：cc 退出，状态为 256 编译失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T19:26:18.553

您必须手动添加相关库和 cflags。有关示例，请参见[https://live.gnome.org/Vala/SDLSample#Compile_and_Run 。](https://live.gnome.org/Vala/SDLSample#Compile_and_Run)

原因是 Vala 使用 pkg-config 试图找出正确的标志以传递给 C 编译器，但在编写 Vala 绑定时，SDL 没有分发 pkg-config 文件。AFAICT 他们的一些（但不是全部）模块现在可以使用，但名称与 Vala 绑定不匹配。

# mysql - MySQL 从 7 月 1 日午夜开始消耗 80-100% CPU，大约在 EBS 连接问题之后一天左右

> ID：11294582
> 
> 赞同：4
> 
> 时间：2012-07-02T13:22:09.157
> 
> 标签：mysql, amazon-ec2, cpu, amazon-ebs

我对我最近在所有运行 MySQL 的 EC2 实例时遇到的问题非常好奇。UTC 时间 7 月 1 日凌晨 12:00，我的两个 Amazon EC2 实例（在美国东部地区运行）发出警报，指示 CPU 使用率过高。我调查发现是 MySQL 吃掉了所有的 CPU。我登录并跑去`SHOW PROCESSLIST`发现**没有查询正在运行**（这些服务器在下班后不会受到太多打击）。我停止了 MySQL，CPU 利用率下降到 1-3%（正常）。我重新启动 MySQL，它又开始消耗大量 CPU。然后，我重新启动了服务器`shutdown -r now`，问题就消失了。两台服务器都有完全相同的问题（运行 Ubuntu 12.04 LTS）。

我在系统日志中看到的唯一相关项目是：

`Jun 30 23:59:59 hostname kernel: [14152976.187987] Clock: inserting leap second 23:59:60 UTC`

我认为我没有为 MySQL 启用日志记录。无论 Ubuntu 12.04 的默认设置是什么，我都在使用它。如果有什么不同的话，大多数数据库都是 InnoDB。

前一天，一个实例受到 EBS 连接问题的影响，导致服务器在访问磁盘时响应极慢。我不相信另一个实例受到影响（它在另一个 AWS 账户中，并且在“中断”期间响应正常），但我不能 100% 确定。我想知道这是否可能导致 MySQL 发疯？但是为什么要等到午夜呢？（小心！这可能是这个谜团中的“红鲱鱼”）

关于可能导致此问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:31:44.490

我相信原因是闰秒错误。您可以在任何地方找到有关此的帖子:)

[在此处](https://access.redhat.com/knowledge/articles/15145)或在[serverfault](https://serverfault.com/questions/403732/anyone-else-experiencing-high-rates-of-linux-server-crashes-during-a-leap-second)上阅读更多信息

一个快速的解决方案是停止 ntpd 守护程序，同步时钟并重新启动守护程序。当然，一些系统更新不会受到伤害:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T13:35:53.003

看看[这个](http://blog.mozilla.org/it/2012/06/30/mysql-and-the-leap-second-high-cpu-and-the-fix/)。我认为这就是您遇到的问题。

# android - 从其他 Fragment 调用 Fragment 宽度

> ID：11294587
> 
> 赞同：0
> 
> 时间：2012-07-02T13:22:17.897
> 
> 标签：android, android-fragments

我调用`Fragment`布局使用

```
LinearLayout formLayout = (LinearLayout)findViewById(R.id.mainLayout);
formLayout.removeAllViews();

FragmentTransaction fragmentTransaction =      fragmentManager.beginTransaction();
PatientSearch fragment = new PatientSearch(maincontrolActivity.this);

fragmentTransaction.add(R.id.mainLayout,fragment, "MY_FRAG");
fragmentTransaction.commit(); 
```

在`PatientSearch`我有我想要的按钮时单击加载另一个`Fragment`但在旧的边界内`Fragment`。

知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:25:15.280

你不应该在 a 中调用`Fragment`s （或 perform `FragmentTransactions`）`Fragment`。`Fragment`s 不应该`Fragment`直接与其他 s 交互，因为这将违背它们的全部目的（它们的设计目的是为了重用，如文档中所述）。

您应该做的是在`Activity`. 您`Fragment`的 s 应该调用 the`Activity`然后`Activity`应该将调用定向到 other `Fragment`。这听起来像是额外的工作，但好的设计可以大有帮助，让您的生活更轻松。

# function - 对象 DOMWindow - 铬

> ID：11294588
> 
> 赞同：0
> 
> 时间：2012-07-02T13:22:18.440
> 
> 标签：function, google-chrome

我有 google-chrome 的问题，我有这样的正常功能，`function a(b){ return b; }` 但如果我在我的代码中有这个`var number=a(5);document.write(number);`google chrome 说我 [object DOMWindow]

在FF中效果很好哪里有问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T13:27:52.013

[`top`](https://developer.mozilla.org/en/DOM/window.top)是一个**只读**全局变量，它引用`window`当前页面中最顶层的对象。因为它是只读的，所以不能为其分配新值：

```
var top = 1;
console.log(top); // [object DOMWindow] 
```

任务默默地失败了。但是，当激活[严格模式](https://developer.mozilla.org/en/JavaScript/Strict_mode)时，会引发 TypeError，这表明您正在尝试设置一个只有 getter 的属性：

```
"use strict";
var top = 1; // <-- Error! 
```

前面发生了，因为代码在全局上下文中运行。但是，当您在**本地**（即不是全局）**[声明](https://developer.mozilla.org/en/JavaScript/Reference/Statements/var)**变量时，该函数将起作用：

 **```
(function() {
    'use strict';
    var top = 1;
    return top;
})(); // Returns 1, no errors. 
```**

# wcf - wcf 配置问题（错误）

> ID：11294590
> 
> 赞同：0
> 
> 时间：2012-07-02T13:22:22.160
> 
> 标签：wcf, .net-3.5, wcf-binding

WCF 的配置最近一直是个祸根。我有以下配置：

```
 <system.serviceModel>

    <!-- Set up Custom Behaviors -->
    <behaviors>

      <endpointBehaviors>
        <behavior name="jsonBehavior">
          <enableWebScript />
        </behavior>
      </endpointBehaviors>

      <serviceBehaviors>
        <behavior name="WebPostService.Service1Behavior">
          <serviceMetadata   httpGetEnabled="true"  />
          <!-- -->
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>

    </behaviors>

    <!-- Set up the binding configuration  -->
    <bindings>

      <basicHttpBinding>
        <binding name="SOAPBinding">
          <security mode="None">
            <transport clientCredentialType="None" />
          </security>
        </binding>
      </basicHttpBinding>

      <webHttpBinding>
        <binding name="JSONBinding"
                 hostNameComparisonMode="StrongWildcard"
                 receiveTimeout="00:10:00"
                 sendTimeout="00:10:00"
                 openTimeout="00:10:00"
                 closeTimeout="00:10:00"
                 maxReceivedMessageSize="1000000"
                 maxBufferPoolSize="2000000"
                 bypassProxyOnLocal="false"
                 useDefaultWebProxy="true" >
          <security mode="None">
            <transport clientCredentialType="None" />
          </security>
        </binding>
      </webHttpBinding>

    </bindings>

    <services>

      <service behaviorConfiguration="WebPostService.Service1Behavior"
               name="WebPostService.WebPostSvc"
      >

        <endpoint address="soap"
                  binding="basicHttpBinding"
                  bindingConfiguration="SOAPBinding"
                  contract="WebPostService.IWebPostSvc"
        />

        <endpoint address="json"
                  binding="webHttpBinding"
                  bindingConfiguration="JSONBinding"
                  behaviorConfiguration="jsonBehavior"
                  contract="WebPostService.IWebPostSvc"

        />

        <!--    -->
        <endpoint address="mex"
                  binding="mexHttpBinding"
                  contract="System.ServiceModel.Description.IMetadataExchange"
        />

      </service>

    </services>

  </system.serviceModel> 
```

为什么我会收到以下错误？：该错误似乎是个谜，因为该合同可作为 .NET Framework 的一部分使用。我正在使用 .NET 3.5。

```
[InvalidOperationException: The contract name 'System.ServiceModel.Description.IMetadataExchange' could not be found in the list of contracts implemented by the service 'WebPostSvc'.]
   System.ServiceModel.Description.ConfigLoader.LookupContract(String contractName, String serviceName) +11679727
   System.ServiceModel.Description.ConfigLoader.LoadServiceDescription(ServiceHostBase host, ServiceDescription description, ServiceElement serviceElement, Action`1 addBaseAddress) +11678779
   System.ServiceModel.ServiceHostBase.LoadConfigurationSectionInternal(ConfigLoader configLoader, ServiceDescription description, ServiceElement serviceSection) +55
   System.ServiceModel.ServiceHostBase.LoadConfigurationSectionInternal(ConfigLoader configLoader, ServiceDescription description, String configurationName) +35
   System.ServiceModel.ServiceHostBase.ApplyConfiguration() +69
   System.ServiceModel.ServiceHostBase.InitializeDescription(UriSchemeKeyedCollection baseAddresses) +190
   System.ServiceModel.ServiceHost.InitializeDescription(Type serviceType, UriSchemeKeyedCollection baseAddresses) +32
   System.ServiceModel.ServiceHost..ctor(Type serviceType, Uri[] baseAddresses) +139
   System.ServiceModel.Activation.ServiceHostFactory.CreateServiceHost(Type serviceType, Uri[] baseAddresses) +28
   System.ServiceModel.Activation.ServiceHostFactory.CreateServiceHost(String constructorString, Uri[] baseAddresses) +331
   System.ServiceModel.HostingManager.CreateService(String normalizedVirtualPath) +11729164
   System.ServiceModel.HostingManager.ActivateService(String normalizedVirtualPath) +42
   System.ServiceModel.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath) +479

[ServiceActivationException: The service '/WebPostSvc.svc' cannot be activated due to an exception during compilation.  The exception message is: The contract name 'System.ServiceModel.Description.IMetadataExchange' could not be found in the list of contracts implemented by the service 'WebPostSvc'..]
   System.ServiceModel.AsyncResult.End(IAsyncResult result) +11599786
   System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result) +194
   System.ServiceModel.Activation.HostedHttpRequestAsyncResult.ExecuteSynchronous(HttpApplication context, Boolean flowContext) +176
   System.ServiceModel.Activation.HttpModule.ProcessRequest(Object sender, EventArgs e) +278
   System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +68
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T14:17:54.423

您不需要合同中的全名，只需使用

```
 <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" /> 
```

# perl - 使用 Archive::Zip 存储文件时遇到问题：我得到没有错误代码的空 zip 文件

> ID：11294594
> 
> 赞同：0
> 
> 时间：2012-07-02T13:22:34.333
> 
> 标签：perl, zip, archive

当我尝试通过 Archive::Zip 创建 zip 存档时，没有抛出任何错误，但生成的 zip 文件已损坏。

```
use Archive::Zip;

my $zip = Archive::Zip->new();
my $file = "/a/very/long/path/with/191/characters/file.txt";

if(-f $file)
{
  $zip->addFile("$file", "destinationname.txt");
  print "$file added\n";
}
unless ($zip->writeToFileNamed("out.zip") == "AZ_OK") { die "error";}; 
```

现在我的 out.zip 文件只有 22B 并且是空的：

```
$> > unzip -l out.zip
Archive:  out.zip
warning [out.zip]:  zipfile is empty 
```

出了什么问题？

**第一次更新**：当我使用具有较短路径名的文件时，一切正常。任何解决方法的想法？符号链接不起作用。

**第二次更新**：这是一种解决方法：

```
use File::Slurp;
[...]
my $text = read_file($file);
$zip->addString($text, "destinationfile.txt");
[..] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:26:15.120

将其更改为：`$zip->addFile($plmxmlFile);`。

`$zip`已经引用了您的目标文件，并且通过添加您将用于输出的文件的名称，您正在`Archive::Zip`尝试在组装尝试时从同一文件读取和写入，从而造成混乱（并且通常不会做您真正想要的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-25T08:18:52.460

也许我已经理解了问题所在：您使用完整的根`a/very/long/path/with/191/characters/file.txt`

因此，您压缩了 zip 中的所有目录，您的文件为空，因为您注意到能够看到路径。使用 chdir `chdir 'a/very/long/path/with/191/characters/'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T15:30:34.840

我不明白为什么您的程序会创建一个空的 zip 文件，但是您在几个地方滥用了引号。

特别是，该值`AZ_OK`是您可以根据请求导入的数值的符号。

该`writeToFileNamed`方法永远不会返回字符串`"AZ_OK"`，并且您应该使用`eq`而不是比较字符串`==`。

幸运的是（或不是，取决于您的观点）这两个错误以及您未能导入的值`AZ_OK`和您的遗漏`use warnings`会将 的返回值`writeToFileNamed`与零（的正确值`AZ_OK`）进行比较，并且应该给您正确的结果。

试试这个程序。

```
use strict;
use warnings;

use Archive::Zip qw( :ERROR_CODES );

my $zip = Archive::Zip->new;
my $file = 'a/very/long/path/with/191/characters/file.txt';

if (-f $file) {
  $zip->addFile($file, 'destinationname.txt');
  print "$file added\n";
}

my $status = $zip->writeToFileNamed('out.zip');
$status == AZ_OK or die "error $status"; 
```

* * *

**更新**

路径的长度不太可能有任何区别，除非它有数百个字符长。

试试这个版本，告诉我们你得到了什么。

```
use strict;
use warnings;

use Archive::Zip qw( :ERROR_CODES );

my $zip = Archive::Zip->new;
my $file = 'a/very/long/path/with/191/characters/file.txt';

unlink 'out.zip';

die qq(File "$file" not found) unless -f $file;
$zip->addFile($file, 'destinationname.txt');
print "$file added\n";

my $status = $zip->writeToFileNamed('out.zip');
$status == AZ_OK or die "error $status"; 
```

# java - Maven，缺少配置选项

> ID：11294600
> 
> 赞同：-1
> 
> 时间：2012-07-02T13:23:05.993
> 
> 标签：java, maven

我在eclipse上安装了maven，当我去项目做maven clean，然后maven install时它工作。但是如果我去项目并尝试去配置然后作为 maven 项目，该选项不会出现在我的 eclipse 中，但在我的朋友 eclipse 中出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:33:34.383

Eclipse 设计为完全独立运行，因此为了快速修复，您只需将您朋友的 eclipse 文件夹复制到您自己的机器上，然后查看该选项是否出现。

对于长期修复，如何重新安装 maven eclipse 插件软件？

[http://maven.apache.org/eclipse-plugin.html](http://maven.apache.org/eclipse-plugin.html)

# android - Android GCM SENDER_ID，如何获取？

> ID：11294602
> 
> 赞同：81
> 
> 时间：2012-07-02T13:23:09.787
> 
> 标签：android, google-cloud-messaging, google-api-console, sender-id

我尝试迁移到`GCM`，但`SENDER_ID`我需要提供的内容有问题。我使用谷歌的演示项目。在这个项目中，如果我理解这一点，我需要`SENDER_ID`在 CommonUtilities.java 文件中为应用程序提供一个。

我提供的 SENDER_ID 是我在[https://code.google.com/apis/console/](https://code.google.com/apis/console/)上注册的 API 密钥，格式如下`AIzaSyAxxxxxxx_xxxxxxxxxxxnoGZw`：（共 40 个字符）。

`SENDER_ID`当我在“BroadcastReceiver mHandleMessageReceiver”上使用此字符串时，会出现一条错误消息：**来自 GCM：错误（INVALID_SENDER）。**.

*错误在哪里？我提供的字符串不是`SENDER_ID`?*

谢谢你。

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2012-07-02T14:56:15.543

不，SENDER_ID 是您在 Google API 控制台注册的项目 ID，它应该是一个数字字符串。例如，在您的浏览器 URI 上，您应该会看到：

```
https://code.google.com/apis/console/#project:4815162342 
```

发件人 ID 是 4815162342

**更新答案：**

Google 尚未完全更新其文档。上面的答案是旧的，它基于这个[文档](https://developers.google.com/instance-id/guides/android-implementation)，它似乎仍然没有更新。

根据更新的[谷歌文档，](https://developers.google.com/android/reference/com/google/android/gms/gcm/GoogleCloudMessaging)**谷歌 API 控制台**上的**项目号**似乎被用作**发件人 ID**

 ***** * *

## 回答 #2

> 赞同：57
> 
> 时间：2016-03-29T09:20:44.123

我已经完成了**最新的 Google API 控制台**。

如何获得`SenderId`：

**步骤**：

1.  打开谷歌 api 控制台
2.  创建项目
3.  单击**左侧菜单图标**
4.  点击**谷歌云平台**
5.  你会在`SenderId`那里得到表格

**参考：**

[![在此处输入图像描述](../Images/305aa21efe5f4d26df1a155146562395.png)](https://i.stack.imgur.com/3S6vq.png)

希望这会帮助你。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-11-02T11:35:21.297

转到您的[Google API 控制台页面](https://code.google.com/apis/console/)。从左侧的下拉菜单中选择您使用的项目。选择概览，现在您可以看到您了`project number`。这是`SENDER_ID`你必须使用的

获取项目编号的另一种方法是从您的 url 中获取“项目”的值。您的网址必须是这样的：“ [https://code.google.com/apis/console/b/0/#project:886025556782](https://code.google.com/apis/console/b/0/#project:886025556782) ”。这里的项目编号是“886025556782”。这个号码是 SENDER_ID

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-11-19T15:01:05.527

2014 年 11 月的更新答案*如果您最近创建了一个 API 项目*。

首先，正确，你绝对应该去谷歌开发者控制台找到你启用了 GCM 的项目。查看概览部分（左侧导航面板）时，您会看到右侧列出的项目 ID 和项目编号。项目 ID 对我来说失败了（这就是我在这里的原因），但是当我尝试项目编号时，我现在能够正确注册我的客户。

**请注意**，这是不同的，因为 Google 最近修改了他们分配项目 ID 的方式。10 月，我做了一个项目，并获得了一个全数字的项目 ID，我认为它可以正常工作。但是我今天创建的那个被赋予了一个两个单词和一个数字 id（如 Hamster-Party-420）和一个数字项目编号。我的项目的 URL 包含 Hamster-Party-420，项目编号仅在概览屏幕上可见。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-12-26T08:32:07.557

另一个更新的答案，对困惑的解释不多（..就像我一样）。（归功于@azgolfer，@PankajAndroid和@Adam）

[1- 如果您在https://console.developers.google.com](https://console.developers.google.com)创建项目，您可以在项目概览中看到“项目 ID”和“项目编号”两件事。**项目 ID 不再是数字**，而是像*master-xxxxx-1234*这样的字母数字。**项目编号**是 11 位数字**，例如 123456789100。**

![项目仪表板](../Images/789d4c052499e95d5ad58206c1c7f42e.png)

2-即使您检查浏览器链接，您也可以找到它： **https : *//console.developers.google.com/project/master-xxxxx-1234***

那么 master-xxxxx-1234 是 SENDER_ID（在某些地方称为 PROJECT ID）吗？不。

**您必须使用项目编号作为 GCM 中的项目 ID。**

3-您可以在哪里交叉检查项目 ID 是否被用作项目 ID？

在 API 仪表板上。（网址：[https](https://code.google.com/apis/console/b/0/?noredirect#project:12345678900) ://code.google.com/apis/console/b/0/?noredirect#project: 12345678900 - 其中 12345678900 是您在项目仪表板上的项目编号。

![谷歌API仪表板](../Images/a2b1c6f2712eb936ab6fa84025bad514.png)

**摘要：** Project Dashboard 和 API Dashboard 中的项目 ID 不同。*项目 dashbaord 中的项目编号用作 API Dashboard 中的项目 ID，项目 dashbaord 中的项目 ID 用作 API Dashboard 中的项目名称。*因此，我们在开发者控制台中创建项目时，Project Dashboard 中显示的项目编号被用作 GCM 中的 SENDER_ID。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-03-04T21:53:49.023

进入最新版开发者控制台的“Dashboard”，点击“Project: Turtle Power”下方的下拉箭头，就可以看到Project编号了！将其用作您的 SENDER_ID

（假项目所以甚至不要尝试它=P）

[![在此处输入图像描述](../Images/1488b09937985f91a573d33daa21e0b8.png)](https://i.stack.imgur.com/negqX.png)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-26T15:33:47.040

也许您还没有在 API COnsole 中激活 Google Cloud Messaging for Android。以下是说明：

[http://developer.android.com/google/gcm/gs.html](http://developer.android.com/google/gcm/gs.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-19T23:59:27.303

我们花了几个小时试图弄清楚这一点。问题是我们的 android manifest 没有包含发件人 ID！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-07-31T22:09:06.780

如果你来这里是因为你在做 web 推送、Android 推送等，会有不同的答案。

来源：[https ://firebase.google.com/docs/cloud-messaging/js/client](https://firebase.google.com/docs/cloud-messaging/js/client)

[![在此处输入图像描述](../Images/5807a9443a7cc173a816ad5475edf874.png)](https://i.stack.imgur.com/GCXb2.png)

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2015-10-16T11:12:20.200

您使用的 SENDER_ID 只不过是授权密钥。您可以在您的项目 Google API 控制台页面 URL 中找到 SENDER_ID

[https://code.google.com/apis/console/#project:8543162367](https://code.google.com/apis/console/#project:8543162367)

这里**8543162367**将是您的 SENDER_ID ，并且项目 ID 不再是数字，它的字母数字或仅数字或仅字母任何东西，但它的位置与我显示的相同****

# php - PHP没有触发错误

> ID：11294604
> 
> 赞同：0
> 
> 时间：2012-07-02T13:23:15.687
> 
> 标签：php, syntax-error

我只是做了这样的语法

```
mysql_real_escape_string($var = 'Hello');
print_r($var); 
```

我得到了 的回声`Hello`，所以我想知道 PHP 中的语法是否合法？如果不是，为什么 PHP 不触发不合法的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:24:52.050

> mysql_real_string_escape($var = '你好');

这是合法的，尽管它不会做你想做的事。

`Hello`被赋值`$var`，然后将该值用作调用函数的参数。

但是，`$var` **不会逃过**这种方式！的返回值`mysql_real_escape_string()`将丢失。

所以不要这样做。正确的做法是

```
$var = "Hello";
$var_escaped = mysql_real_escape_string($var);

print_r($var_escaped); 
```

# android - Mac OX 上的 Android Eclipse xml 编辑器自动完成功能不起作用

> ID：11294605
> 
> 赞同：3
> 
> 时间：2012-07-02T13:23:15.743
> 
> 标签：android, eclipse, autocomplete, editor, xml-layout

我在 Mac OX 上使用 Eclipse（我是 Mac 新手），自动完成功能在 .java 文件中正常工作，但在我的 .xml 布局文件中不起作用。

我根据这篇文章检查了我的“高级”Java 编辑器设置，[自动完成已停止使用 android sdk](https://stackoverflow.com/questions/5916026/autocomplete-has-stopped-working-with-android-sdk)，并且所有“Java 提案”都被勾选。

我还检查了这篇文章[Android: Eclipse autocomplete does not work in xml files](https://stackoverflow.com/questions/9114335/android-eclipse-autocomplete-does-not-work-in-xml-files)，我用“Android Common XML Editor”打开了我的 xml 文件。

每当我尝试自动完成时，我都会收到类似`Element TextView is unknown`.

我正在使用带有 Eclipse Juno 的最新 Android sdk 版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T14:20:28.027

清理我的工作区并重新启动 Eclipse 后，自动完成功能运行良好。

# linux - 将 VMStat 数据记录到文件中

> ID：11294611
> 
> 赞同：6
> 
> 时间：2012-07-02T13:23:37.727
> 
> 标签：linux, unix

我正在尝试创建一些容量规划报告，其中一项要求是了解一些 Unix 服务器的内存使用情况。

现在我对Unix的了解非常少。我通常只是登录并运行一些脚本。

但是对于这份报告，我需要收集 VMStat 数据并根据前几周按小时细分的数据生成报告，这是每 10 秒获取的 Vmstat 数据的平均值。

所以第一个问题：VMStat 是否默认登录，如果是，数据输出到服务器上的哪个位置？

如果没有，我该如何设置？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-02T15:42:28.957

`vmstat`是您运行的命令。

以 10 秒为间隔（减去最后一个）生成一周的虚拟内存统计信息为 60,479 10 秒间隔

所以你想要的命令是：

```
nohup vmstat 10 604879 > myvmstatfile.dat & 
```

**这将创建一个非常大的文件 myvmstatfile.dat**

编辑：RobKielty（`&`将把这个工作放在后台，`nohup`当你退出命令 shell 时会阻止任务挂起。如果你运行这个命令，监视这个文件被写入的磁盘分区是谨慎的to.`df -h /path/to/directory/where/outputfile/resides`用于监控磁盘空间使用情况。）

我不知道你需要如何处理这些数据，所以我无法帮助你。

像这样创建一个[crontab](/questions/tagged/crontab "显示标记为“crontab”的问题")条目（crontab -e）

```
0 0 * * 0  /path/to/my/vmstat_script.sh 
```

该文件`vmstat_script.sh`将包含以下 bash 脚本命令。

```
#!/bin/bash
# vmstat_script.sh
vmstat 10 604879 > myvmstatfile.dat
mv myvmstatfile.dat myvmstatfile.dat.`date +%Y-%m-%d` 
```

这将每周创建一个文件，其名称如下`myvmstatfile.dat.2012-07-01`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-11T14:44:45.237

我用于监控 Linux vm 指标的命令如下： nohup vmstat 10 720| （读取时；做 echo "$(date +%d-%m-%Y" "%H:%M:%S) $REPLY"; done) >> nameofLogfile.log

这里 nohup 用于在后台运行进程。它将以 10 秒的间隔运行 2 小时。这是生成图表和报告的最佳命令，因为时间戳也将与不同的指标一起包含在日志中，以便我们可以相应地过滤日志。

# wpf - ContentProperty 的元素是什么时候真正创建的？

> ID：11294612
> 
> 赞同：0
> 
> 时间：2012-07-02T13:23:40.923
> 
> 标签：wpf, data-binding, custom-controls, parent-child

我正在创建一个使用以下标记的自定义 WPF 控件：

```
<custom:FilterPanel
    Grid.Row="1"
    FilterTarget="{Binding Path=MyItems}">
    <custom:FilterParameter
        ParameterName="Name"
        TargetProperty="Name" />
    <custom:FilterParameter
        ParameterName="Date"
        TargetProperty="MyDate" />
</custom:FilterPanel> 
```

我已将我的 FilterPanel 的 ContentProperty 设置为 FilterParameters，这显然是我使用上面的标记添加项目的 FilterParameter 对象的集合。我的问题是，何时实际处理 ContentProperty 的元素以便创建实例并将项目实际添加到基础集合中？

我有兴趣与其子控件共享父控件的数据源，在 WPF 生命周期中是否有任何点可以覆盖此行为并将自定义逻辑添加到此 FilterParameters 集合的创建中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T14:17:16.777

假设您的类派生自`Panel`，那么在面板生命周期中您可以看到子项（即像您的示例一样在 XAML 中贴花的子项 - 不是通过绑定生成的子项）的第一个点是`Panel.EndInit()`，您可以在派生类中覆盖的虚拟方法。`BeginInit`特别是在and方法之间创建的 chldren `EndInit`。

# android - 如何在android中找到GeoPoint的x和y坐标

> ID：11294618
> 
> 赞同：0
> 
> 时间：2012-07-02T13:24:06.260
> 
> 标签：android, google-maps

我们如何将 android 地图视图中的 GeoPoint 更改为点 x 和 y 我没有找到任何关于此的代码。请告诉我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:31:40.040

该类`MapView`可以将 映射`GeoPoint`到实际的屏幕坐标，如下所示：

```
GeoPoint point = new GeoPoint(latitude, longitude);
Point ptScreenCoords = new Point();
mapView.getProjection().toPixels(point, ptScreenCoords); 
```

同样，您可以`GeoPoint`从屏幕坐标创建：

```
GeoPoint point = mapView.getProjection().fromPixels(x, y); 
```

# sublimetext - Sublime Text 2：编辑文件选项卡的颜色？

> ID：11294620
> 
> 赞同：48
> 
> 时间：2012-07-02T13:24:28.413
> 
> 标签：sublimetext, sublimetext2

我看到可以编辑 Sublime Text 主题（.config/sublime-text-2/Packages/Theme - Default/Default.sublime-theme）以使打开的选项卡更加明显。

为此我使用

```
{
    "class": "tab_control", "attributes": ["selected", "file_medium_dark"],
    "tint_modifier": [0, 255, 0, 32]
    /* ... */
}, 
```

这使标签更环保。

是否有类似的方法为已编辑（未保存）文件/缓冲区的选项卡着色？

谢谢。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-07-02T15:03:37.833

在与 Mikko 关于查看更改日志的建议一起四处寻找之后：

在 Settings-User 从`Preferences | Settings`添加的行中打开

```
"highlight_modified_tabs": true, 
```

每当文件有未保存的更改时，这将使选项卡文本变为橙色。

要从橙色更改颜色，需要进行一些进一步的挖掘和实验，结果表明编辑主题是从橙色更改颜色的一种方法。

主题文件可以位于`Color Scheme - Default folder`从菜单访问的中`Preferences | Browse Packages...`- 您必须为要更改文本颜色的每个主题进行这些更改：

```
{
    "class": "tab_control", "attributes": ["selected", "file_medium_dark"],
    "tint_modifier": [0, 255, 0, 40],
    "layer2.texture": "Theme - Default/medium_dark_selected_tab_bg.png",
    "layer2.opacity": 0.7
},
{
    "class": "tab_control", "attributes": ["dirty", "file_medium_dark"],
    "tint_modifier": [255, 0, 0, 40],
    "layer2.texture": "Theme - Default/medium_dark_selected_tab_bg.png",
    "layer2.opacity": 0.7
},
{
    "class": "tab_control", "attributes": ["selected", "dirty", "file_medium_dark"],
    "tint_modifier": [255, 255, 0, 40],
    "layer2.texture": "Theme - Default/medium_dark_selected_tab_bg.png",
    "layer2.opacity": 0.7
}, 
```

最好分别控制“选定”和“脏”（=修改）的行为。这可能与图层有关，但我对这些还不够了解。

**附加物**

(1) 以上是针对黑暗主题的。对于轻主题，`"file_medium_dark"`从属性中省略 。

(2) 在*Sublime Text 3* (~/.config/sublime-text-3/Packages/Default.sublime-theme) 中，同样的更改似乎也适用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-14T14:21:44.553

这是我找到的最佳解决方案： [https ://coderwall.com/p/jg4kog](https://coderwall.com/p/jg4kog)

1.  在 Sublime Text 中转到 Preferences > Browse packages

2.  导航到用户文件夹。

3.  在那里你**创建了一个**名为**Default.sublime-theme的文件**

4.  在 Sublime Text 中打开该文件并复制并粘贴以下 JSON 对象：

```
[{
    "class": "tab_control",
    "attributes": ["selected", "file_medium_dark"],
    "tint_modifier": [255, 255, 255, 80]
}] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-14T13:18:59.453

我遇到了同样的问题，发现对我来说是一个很好的解决方案。我替换了选项卡上使用的图形图标，使脏选项卡更加明显。

替换dirty_circle、dirty_circle_light 和dirty_indicator 图形就可以了。

可以在这里找到详细信息以及一些漂亮的图形：

[http://www.sublimetext.com/forum/viewtopic.php?f=3&t=5630](http://www.sublimetext.com/forum/viewtopic.php?f=3&t=5630)

# git - Jenkins 不断重置工作区的 .git/config

> ID：11294621
> 
> 赞同：0
> 
> 时间：2012-07-02T13:24:31.710
> 
> 标签：git, jenkins, jenkins-plugins

在 Jenkins 工作中，我设置了两个存储库：一个本地存储库和一个远程存储库。计划是定期检查远程，当它检测到变化时，推送到本地，然后在自定义分布式测试系统上控制测试并将结果返回给 Jenkins。

对于一个问题，这一切都很好。每次我重新启动 Jenkins 时，它都会从作业的工作区`.git/config`文件中删除远程（或本地，取决于天气）存储库，我必须手动编辑它。

我是如何配置工作的：

*   回购网址：`/path/to/local`
*   姓名：`localrepo`
*   回购网址：`gitolite@someserver:therepo`
*   姓名：`origin`

并且生成的`.git/config`仅包含：

```
[remote "localrepo"]
    fetch = +refs/heads/*:refs/remotes/localrepo/*
    url = /path/to/local 
```

**关于我在这里做错了什么的任何想法？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T20:50:10.303

我假设您正在使用 Jenkins git 插件。我认为您需要让 git 插件控制本地 git 存储库，而不是在 Jenkins 背后进行任何手动配置。

当您使用远程 git 存储库配置 Jenkins 作业时，您可以让 Jenkins 轮询更改，或者您可以安排将通知传递给 Jenkins，例如从 git hook 脚本。

当 Jenkins 检测到您告诉它构建的任何分支发生变化时，它将更新 Jenkins 工作区中的 git 存储库，然后准备执行作业配置的构建步骤。

工作区中的 git repo 由 Jenkins git 插件以某种非标准方式管理。您没有准确指定 git 中的文件如何发送到自定义分布式测试系统，因此我无法推测 Jenkins 工作区是否可以按原样使用，或者是否需要做进一步的事情。

要真正回答您的问题“我在做什么错”：您应该停止在 Jenkins 工作区中手动更改本地 git 存储库的配置，并让 git 插件管理它。如果这对您来说不是一个好的解决方案，您可能需要停止使用 git 插件。

由于您似乎愿意手动进行大量 repo 管理，我认为您需要 git 插件的唯一事情是轮询远程 repo，即检测更改。

您可以使用例如[https://wiki.jenkins-ci.org/display/JENKINS/script-scm](https://wiki.jenkins-ci.org/display/JENKINS/script-scm)，它允许您编写自定义脚本来管理轮询和结帐。

另一种选择是忘记轮询，只需从远程 git repo 的 post-commit-hook 脚本触发新的工作构建。这将允许您在作业配置中为 SCM 指定“无”并完全控制本地 repo 管理。

我自己可能会检查是否可以与 Jenkins git 插件合作并按原样使用本地 git repo。git 插件为您提供了一些不错的东西，例如每个构建中的更改列表，如果作业没有 SCM，您将不会拥有这些内容。

# javascript - 使用原型而不是在对象本身上声明属性有什么好处吗？

> ID：11294623
> 
> 赞同：9
> 
> 时间：2012-07-02T13:24:34.920
> 
> 标签：javascript, ecma262

原型用于声明一类对象的属性和方法。使用原型的一个优点是它节省了内存，因为类的所有实例都指向原型的属性和方法，这节省了内存并有效地允许类的所有实例将属性视为静态。

原型用于通过原型链进行继承。

我的问题很简单。当你能做到的时候，为什么还要使用原型：

```
function car() {
    this.engine = "v8";
}
function mustang() {
    // nm, no good way to inherit without using prototypes
} 
```

那正确吗？所以原型的主要目的有三个：

1.  节省内存
2.  提供静态属性
3.  是引用类型从超类继承的唯一方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-24T02:38:48.223

> 节省内存

是的，当您创建数百个 Car 实例并且它们都有自己的函数（具有自己的闭包范围）时，您将消耗更多内存。

找不到它的参考，但有人建议 Chrome 优化使用原型的构造函数，而不是使用构造函数主体中的所有内容的构造函数。

> 提供静态属性

静态更像`Date.now()`，每个实例都有来自原型的成员，但可以在实例上调用。

> 是引用类型从超类继承的唯一方法

您可以在 Child 中继承 with `Parent.apply(this,arguments);`，但这会使扩展 Parent 函数更加复杂并且不`childInstance instanceof Parent`成立。该代码所做的是将要创建的子实例作为调用对象 ( `this`) 运行父代码。继承通常在两个地方进行。

1.  在 Child 主体`Parent.apply(this,arguments);`中重新使用 Parent 初始化代码，并使 Parent 实例成员成为 Child 实例成员（例如：this.name）。
2.  将 Child.prototype 设置为 Parent.prototype 的浅拷贝`Child.prototype=Object.create(Parent.prototype);Child.prototype.constructor=Child;`这将确保共享的 Parent 成员在 Child 实例上可用（如函数 getName）。

这些点在这里更详细地解释：[https ://stackoverflow.com/a/16063711/1641941](https://stackoverflow.com/a/16063711/1641941)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-24T01:54:39.343

关于你的三点：

1.  原型不一定具有更高的性能，尤其是对于变长或包含许多成员的原型链。原型越小，链越短，浏览器的编译器就越能优化它。最终，需要针对单个应用程序、它们的个性化需求以及目标浏览器（性能差异很大）提出这个问题。
2.  根据定义，静态成员需要对象。也就是说，静态成员属于对象本身而不是特定实例。对象是在 JavaScript 中创建静态属性的唯一方法。请注意，作为“特殊”对象的对象字面量本质上是静态的。
3.  一个人可以实现他自己的对象类型，它允许继承（即`jQuery.extend`）之类的东西，但就引用类型而言，原型是创建继承的唯一方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-28T10:39:30.067

Regarding your points:

1.  There is definitely a performance boost, especially regarding functions - it's much better to declare functions on the prototype.
2.  I think you meant to say "public" properties so that information is retrieved by writing `some_instance.foo`. "Static" properties/methods are different (see below).
3.  Correct. Inheritance can only really happen from the prototype.

Let me explain some things to see if this helps. Creating new "classes" in javascript is a fairly straightforward process.

```
var MyClass = new Function(); 
```

At this point, the engine is aware of your new class and knows "what to do" (in terms of performance) when it creates new instances of your "class".

```
var my_instance = new MyClass(); 
```

If you want to modify the prototype, you can do so and know that every instance is going to get updated because they all share the same prototype.

```
MyClass.prototype.name = "default name";
console.log( my_instance.name ); //=> default name 
```

*Now* the engine knows that there is a "name" property which expects a string value... it will allot those resources to all new AND existing instances of your class... which is very handy. Beware that modifying the prototype of an existing "class" like this is an expensive process and should not be performed frequently (but don't be afraid to do it either).

I can't really speak for the **performance** pros and cons of declaring ad-hoc properties/methods on an instance:

```
my_instance.foo = function() { /* this is not in the prototype chain */ }; 
```

My guess is that this is pretty simple for the engine and is no big deal unless you are doing this for tens of thousands of objects at the same time.

The main benefit of using the prototype IMO is that you can write code to extend a method's functionality and know that all instances of your "class" will get updated accordingly:

```
var old_foo = MyClass.prototype.foo;
MyClass.prototype.foo = function() {
    /* new business logic here */

    // now call the original method.
    old_foo.apply(this, arguments);
}; 
```

Regarding "static" properties, you declare those on the "class" (constructor) itself:

```
// example static property
MyClass.num_instances = 0; 
```

Now you can create init/destroy methods like this:

```
MyClass.prototype.init = function() {
    this.constructor.num_instances++;
};

MyClass.prototype.destroy = function() {
    this.constructor.num_instances--;
};

// and call the init method any time you create a new instance
my_instance.init();
console.log( MyClass.num_instances ); //=> 1

var instance_2 = new MyClass();
instance_2.init();
console.log( MyClass.num_instances ); //=> 2

instance_2.destroy();
console.log( MyClass.num_instances ); //=> 1 
```

Hope that helps.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-24T01:26:28.353

如果您关心遵循约定以便人们（以及您在路上）真正理解您的代码，那么您不应该放入`this.engine="v8"`构造函数。Prototype 旨在为每辆汽车定义属性，而构造函数旨在定义单个实例。那么，为什么要在构造函数中为每个实例 smack dab 放置正确的东西呢？这属于原型。即使做这两件事最终会完成同样的事情，也有一些事情要放在适当的位置上。您和其他人都可以理解您的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-29T18:24:53.523

(1) 我不认为仅保留内存是使用 .prototype 的正当理由，除非您在复制对象方面变得非常极端。

(2) 静态属性的想法也不是使用 .prototype 的真正理由（恕我直言），因为它的行为不像传统的静态属性。你（据我所知）总是需要一个对象实例才能访问“静态”属性，这使得它根本不是静态的。

```
function Car() {}
Car.prototype.Engine = "V8";
// I can't access Car.Engine... I'll always need an instance.
alert(new Car().Engine);
// or
var car1 = new Car();
alert(car1.Engine); //you always need an instance.
//unless you wanted to do
alert(Car.prototype.Engine); //this is more like a static property, but has an
//unintended consequence that every instance of Car also receives a .Engine
//behavior, so don't do this just to create a "static property." 
```

需要注意的是，从传统的 OO 角度来看，这种“静态”思想不仅适用于属性，还适用于所有成员，包括方法（函数）。

最好将原型（同样，恕我直言）视为具有附加到实例对象的行为的注入单例对象。Car() 的所有实例都可以有自己的实例成员，但 Car() 的每个实例也将“自动”注入所有 Car.prototype 的成员/行为。这在技术上并不相同，但我发现以这种方式考虑原型很方便。

```
//define Car and Car.GoFast
function Car() {}
Car.prototype.GoFast = function () { alert('vroom!'); };

var car1 = new Car();
var car2 = new Car();

car1.GoFast();
car2.GoFast(); //both call to same GoFast implementation on Car.prototype

//change the GoFast implementation
Car.prototype.GoFast = function () { alert('vvvvvrrrrroooooooooommmmm!!!!!'); };

car1.GoFast();
car2.GoFast(); //both have been "updated" with the new implementation because
//both car1 and car2 are pointing to the same (singleton) Car.prototype object! 
```

Car.prototype 的行为就像一个单例对象，其成员/行为已被注入到 Car 类型的实例对象中。

(3) 原型不应与继承混淆。您可以获得看似继承的行为，但事实并非如此。原型上的成员/行为保留在原型对象上。它们不会像真正的继承那样成为派生类的成员/行为。这就是为什么我描述它更像是原型被“注入”到您的实例中。

```
function Car() {}
Car.prototype.Engine = "V8";
var car1 = new Car();
var car2 = new Car();

alert(car1.Engine); //alerts "V8"
//There is no "Engine" variable defined within the instance scope of 'car1'.
//Javascript searches the scope of car1's Type.prototype object to find 'Engine'.
//Equivalent to: Object.getPrototypeOf(car1).Engine

//But if we create 'Engine' within the scope of car1
car1.Engine = "V6"; //Car.prototype was never accessed or updated
alert(car1.Engine); //we get "V6"
alert(car2.Engine); //we still get "V8"
alert(Object.getPrototypeOf(car1).Engine); //we still get "V8"! 
```

所以直接回答这个问题：**使用原型而不是在对象本身上声明属性有什么好处吗？**

是的，当您想在给定类型的实例对象之间共享行为实现时。巧合的是，您将减少内存占用，但这并不是使用原型的唯一理由。“创建静态属性”（它们不是）或继承（不是）也不是。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-22T13:24:52.203

原型设计远不止这些。您还可以在运行时使用方法和属性扩展类和已经存在的对象实例。

这应该以一种非常容易理解的方式解释它：http: [//javascript.info/tutorial/inheritance](http://javascript.info/tutorial/inheritance)

# c++ - 如何使用 sqlite3 c++ 将整数转换为字符串

> ID：11294625
> 
> 赞同：0
> 
> 时间：2012-07-02T13:24:42.033
> 
> 标签：c++, soap, sqlite

我正在尝试将整数数据转换为字符串，但出现错误`cannot convert 'int*' to 'const char*' for argument '2' to 'char* strcat(char*, const char*)'`

大家好，请解决这些问题，我在哪里做错了？

```
 #include <iostream>
    using namespace std;
    #include "sqlite3.h"
    #include<string.h>
    #include <sstream>
    #define STRING_MAX 32

    typedef struct metadata_t
    {
      char session_username[256];   
      int user_id[256];
      int session_id[256];
      char buffer[256];
    }metadata_t;

    void  insertdata1(metadata_t *data);

  int main (int argc, const char * argv[])
      {

      struct metadata_t *data;
        cin >> *data->user_id;
        cin >> data->session_username;
        cin >> *data->session_id;
        cin >> data->buffer;

         insertdata1(data);

         }

    void insertdata1(metadata_t *data)
        {

         // char *buff1,*buff2;
             sqlite3 *db;
             sqlite3_open("test1.db", & db);
             string createQuery = "CREATE TABLE IF NOT EXISTS items (user_id INTEGER PRIMARY KEY,   session_username TEXT,Session_id INTEGER,buffer TEXT,));";
             sqlite3_stmt *createStmt;
             cout << "Creating Table Statement" << endl;
             sqlite3_prepare(db, createQuery.c_str(), createQuery.size(), &createStmt, NULL);
             cout << "Stepping Table Statement" << endl;
             if (sqlite3_step(createStmt) != SQLITE_DONE) cout << "Didn't Create Table!" << endl;

            //itoa(*data->userid,buff1,10);  // not work
            //itoa(*data->userphone,buff2,10);// Integer to String Conversion

        /*   std::string  ss;
           ss << *data->user_id;
           ss << *data->session_id;
           std::string user_Id = ss.str();
           std::string session_Id = ss.str();  */ // not working
                   char *a="(";
                   char *d=")";
                   char *b="'";
                   char *c=",";
                   char str1[1000];
                   char * str2 = "";
                   char * g = ";"; 
               strcpy(str1, "INSERT INTO items (user_id,session_username,session_id,buffer)VALUES");

               strcat(str1,a);

               strcat(str1,b);
               strcat(str1,data->user_id);
               strcat(str1,b);
               strcat(str1,c);
               strcat(str1,b);
               strcat(str1,data->session_username);
               strcat(str1,b);
               strcat(str1,c);
               strcat(str1,b);
               strcat(str1,data->session_id);
               strcat(str1,b);
               strcat(str1,c);
               strcat(str1,b);
               strcat(str1,data->buffer);
               strcat(str1,b);
               strcat(str1,d);
               strcat(str1,g);

            std::string insertQuery = str1; // WORKS!
            sqlite3_stmt *insertStmt;
            cout << "Creating Insert Statement" << endl;
            sqlite3_prepare(db, insertQuery.c_str(), insertQuery.size(), &insertStmt, NULL);
            cout << "Stepping Insert Statement" << endl;
            if (sqlite3_step(insertStmt) != SQLITE_DONE) cout << "Didn't Insert Item!" << endl;

      }** 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:48:05.263

推荐使用[`std::ostringstream`](http://en.cppreference.com/w/cpp/io/basic_ostringstream)（你需要`#include <sstream>`）来构建你的查询：

```
std::ostringstream str1;

str1 << "INSERT INTO items (user_id,session_username,session_id,buffer)VALUES"
     << a
     << b // and so on
     << g;

const std::string insertQuery = str1.str(); 
```

以下不分配任何内存，而只是声明一个指针（`struct`在 C++ 中不需要）：

```
struct metadata_t *data; 
```

并且任何取消引用它的尝试都会导致未定义的行为，很可能是分段错误：

```
cin >> *data->user_id; 
```

只需在堆栈上声明它：

```
metadata_t data; 
```

并将其地址（或通过引用传递）传递给`insertdata1()`：

```
insertdata1(&data); 
```

`std::string`更喜欢`char*`或`char[]`：

```
struct metadata_t
{
    std::string session_username;
    int user_id[256];  // Did you really mean an array of int here ?
    int session_id[256];
    std::string buffer;
}; 
```

# java - 带有 Javascript 调用的 Android WebView 行为异常

> ID：11294626
> 
> 赞同：0
> 
> 时间：2012-07-02T13:24:43.280
> 
> 标签：java, javascript, android

我了解如何从我的 WebView 调用 Javascript，这不是问题。

```
if(javascriptCall!=null){
        String hardCodedexample = "1959602";
        webView.loadUrl("http://myappexample+ username);

        webView.loadUrl("javascript:" + "window.application.relocateTo({location:'patients/details',params:{EMPIID:"+ hardCodedEMPIID +"}})");
    } 
```

javascriptCall 是一个字符串，它传递给我的 webview 活动。hardCodedEMPIID 只是我们测试的一个例子。我的问题是，当我允许应用程序在设备上正常运行时，我的 javascript 方法似乎不起作用。它加载了 myappexample，我不知道我的 javascript 调用发生了什么。

当我调试应用程序并单步执行代码时，它会正确调用该方法。我很困惑这怎么可能？单步执行和正常执行的区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T21:40:16.397

您应该等待由( [http://developer.android.com/reference/android/webkit/WebViewClient.html#onPageFinished(android.webkit.WebView, java.lang.String)](http://developer.android.com/reference/android/webkit/WebViewClient.html#onPageFinished%28android.webkit.WebView,%20java.lang.String%29)`onPageFinished(WebView view, String url)` )调用的事件。在调用.`WebViewClient``loadUrl`

# javascript - 使用变量中的 gi 标志创建正则表达式

> ID：11294630
> 
> 赞同：0
> 
> 时间：2012-07-02T13:24:54.963
> 
> 标签：javascript, regex

```
var metin = "baris";
var icerikoku = "Hello Baris. What is surname Baris. Bye bye baris. How are you metin.";
var n = icerikoku.replace(/metin/gi, "ziya");
$("#icerikoku").html(n); 
```

**打印：**
`Hello Baris. What is surname Baris. Bye bye baris. How are you ziya.`

**但是，必须是：**
`Hello ziya. What is surname ziya. Bye bye ziya. How are you metin.`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-02T13:26:19.720

您需要为此使用[`RegExp`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp/)构造函数：

```
var n = icerikoku.replace(new RegExp(metin, 'gi'), "ziya"); 
```

这将允许您将变量传递给您的正则表达式。

# php - 使用 jquery mouseover 显示回调的状态

> ID：11294634
> 
> 赞同：0
> 
> 时间：2012-07-02T13:25:05.213
> 
> 标签：php, jquery

是否可以使用 jquery 在 div 中使用回调并在另一个 div 中显示全文？目前我在正确的 div 中：

```
$(document).ready(function(){
setInterval(function(){
$.post("status.php?_="+ $.now(), {day : "<?php echo $day;?>"}, function(upcoming){
$(".ticker").html(upcoming);
}),
"html"
}, 45000);
}); 
```

我需要类似的东西：

```
$(".view").hover(function(){
$("#left").load("a.php");
});

<div id="left">
<div class="show">
    </div>
</div>

<div id="right">
    <div class="ticker">  
    </div>
</div> 
```

我的 php 吐回 html：`<a href="" class="view">EventID</a>`

我想要做的是将鼠标悬停在超链接上并在 .show 中显示完整状态我知道我必须使用事件编号进行查询，但我在执行此操作时的搜索结果为空。一如既往，感谢任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:27:24.043

```
$("body").on("hover", ".view", function(){
   $("#left").load("a.php");
}); 
```

当您`.view`在页面加载后添加到 DOM 时，即动态添加，您需要使用**[`.on()`](http://api.jquery.com/on)**.

而不是`body`您可以使用任何父选择器`.view`is `static-element`。

# windows - 如何在 Windows 8 上正确使用 SCardGetStatusChange？

> ID：11294638
> 
> 赞同：3
> 
> 时间：2012-07-02T13:25:10.713
> 
> 标签：windows, smartcard, winscard

智能卡服务在 Windows 8 上的行为有所不同，并且 MSDN 尚未更新其文档。谁能提供有关如何正确调用 SCardGetStatusChange 以监视 Windows 8 上的智能卡操作的代码片段？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T00:45:28.100

这是我为个人博客项目编写的 C++ 模板函数。它使用我在 github 上开发的一个库，但您也可以将逻辑重新设计到您自己的上下文中。

```
template<typename SetContext, typename ClearContext, typename Wait, typename Report>
unique_winerror monitor_smartcard_readers(
  SetContext&& setContext, 
  ClearContext&& clearContext, 
  Wait&& wait, 
  Report&&  report
)
{
  unique_winerror winerror;

  std::vector<wchar_t> readernames;
  std::vector<SCARD_READERSTATE> readers;

  while (winerror)
  {
    //
    // make sure that the scard service has started 
    // and that the loop has not been cancelled
    //

    if (!std::forward<Wait>(wait)())
    {
      return winerror_cast(SCARD_E_CANCELLED);
    }

    monitor_error_contract(
      [&] () 
      {
        unique_close_scardcontext context;
        ON_UNWIND_AUTO(
          [&]
          {
            std::forward<ClearContext>(clearContext)();
          }
        );

        //
        // need a fresh context whenever we start over.
        // lots of sytem changes could have caused this 
        // restart including the scard service stopping 
        // and then restarting.
        //

        winerror.reset(
          SCardEstablishContext(
            SCARD_SCOPE_USER,
            NULL,
            NULL,
            context.replace()
          )
        );
        if (!winerror || !context)
        {
          return;
        }

        std::forward<SetContext>(setContext)(context.get());

        //
        // make sure that loop has not been cancelled.
        // without this there is a race where the new 
        // context is not cancelled because the caller
        // cancelled at a time when there was no 
        // context yet.
        //

        if (!std::forward<Wait>(wait)())
        {
          winerror = winerror_cast(SCARD_E_CANCELLED);
          return;
        }

        if (readers.empty())
        {
          //
          // add PnP state query
          // setting the state to unaware causes SCardGetStatusChange
          // to return immediately with the actual pnp state.
          //
          readers.push_back(make(L"\\\\?PnP?\\Notification"));
        }

        for(;;)
        {
          auto readersstaterange = lib::rng::make_range_raw(readers);

          winerror.reset(
            SCardGetStatusChange(
              context.get(),
              INFINITE,
              readersstaterange.begin(),
              lib::rng::size_cast<DWORD>(readersstaterange.size())
            )
          );
          if (!winerror)
          {
            // exit
            return;
          }

          //
          // report changes
          //
          auto readersrange = lib::rng::make_range_raw(readers, 0, -1);
          if (!readersrange.empty())
          {
            std::forward<Report>(report)(readersrange);
          }

          //
          // record the changes we have reported
          //
          for (auto& state : readers)
          {
            state.dwCurrentState = state.dwEventState;
          }

          if ((readers.back().dwEventState & SCARD_STATE_CHANGED) == SCARD_STATE_CHANGED)
          {
            // Pnp event - list readers.
            break;
          }
        }

        // keep the old allocations for use to build the new list.
        std::vector<wchar_t> oldreadernames(std::move(readernames));
        std::vector<SCARD_READERSTATE> oldreaders(std::move(readers));

        // exclude the pnp reader
        auto oldreaderssortedrange = lib::rng::make_range(oldreaders, 0, -1);

        LPWSTR concatreaderstrings = nullptr;
        ON_UNWIND_AUTO(
          [&] { if (concatreaderstrings) {SCardFreeMemory(context.get(), concatreaderstrings);};}
        );
        DWORD totallength = SCARD_AUTOALLOCATE;

        winerror.reset(
          SCardListReaders(
            context.get(), 
            nullptr,
            reinterpret_cast<LPWSTR>(&concatreaderstrings),
            &totallength
          )
        );
        if (winerror == winerror_cast(SCARD_E_NO_READERS_AVAILABLE))
        {
          // no readers is not an error, loop around to wait 
          // for a reader to be connected
          winerror.suppress().release();
          return;
        }
        else if (!winerror)
        {
          return;
        }

        // keep the names around because the state array will have pointers into this
        readernames.assign(concatreaderstrings, concatreaderstrings + totallength);

        auto readerstateless = [](const SCARD_READERSTATE& lhs, const SCARD_READERSTATE& rhs) -> bool 
        {
          return _wcsicmp(lhs.szReader, rhs.szReader) < 0;
        };

        //
        // all the reader names are concatenated in this array with 
        // embedded nulls for each and two nulls to mark the end
        //
        auto cursorreadernames = lib::rng::make_range_raw(readernames);
        while(!cursorreadernames.empty() && cursorreadernames.front() != L'\0')
        {
          // access the current name
          auto namerange = lib::rng::make_range(
            cursorreadernames, 
            0,
            wcslen(cursorreadernames.begin()) - cursorreadernames.size()
          );
          // skip to the next name
          cursorreadernames = lib::rng::make_range(namerange, namerange.size() + 1, 0);

          auto oldreader = std::equal_range(
            oldreaderssortedrange.begin(), 
            oldreaderssortedrange.end(), 
            make(namerange.begin()), 
            readerstateless
          );
          if (oldreader.first != oldreader.second)
          {
            // keep the old state for this reader
            readers.push_back(*oldreader.first);

            // must use the new string allocation, 
            // the old one will be gone soon
            readers.back().szReader = namerange.begin();
          }
          else
          {
            readers.push_back(make(namerange.begin()));
          }
        }

        // keeping them sorted makes the updates more stable and allows the 
        // equal_range above instead of a linear find.
        std::sort(readers.begin(), readers.end(), readerstateless);

        //
        // add PnP state query
        // keep the existing state, and keep it at the 
        // end, out of the sorted area.
        //
        readers.push_back(oldreaders.back());
      }
    );
  }
  return winerror;
} 
```

用法如下所示：

```
#define WIN32_LEAN_AND_MEAN             // Exclude rarely-used stuff from Windows headers
#define NOMINMAX
// Windows Header Files:
#include <windows.h>
#include <Unknwn.h>
#include <winscard.h>
#include <ncrypt.h>
#include <Wincrypt.h>
#include <credentialprovider.h>

// TODO: reference additional headers your program requires here
#include <type_traits>
#include <algorithm>
#include <new>
#include <memory>
#include <utility>
#include <limits>
#include <iterator>
#include <thread>
#include <future>
#include <mutex>
#include <vector>

#include <iostream>
#include <iomanip>

int wmain(int argc, WCHAR* argv[])
{
  unique_winerror winerror;

  for (;;)
  {
    SCARDCONTEXT context = NULL;

    // if you monitor in a separate thread, then add a cancel or shutdown event 
    // into the waitfor array and handle it in the Wait lambda
    HANDLE waitfor[] = {SCardAccessStartedEvent()};
    ON_UNWIND_AUTO([] {SCardReleaseStartedEvent();});

    winerror = smart_card::monitor_smartcard_readers(
      [&](SCARDCONTEXT context)
      {
        context = context;
      },
      [&]()
      {
        context = NULL;
      },
      [&]() -> bool
      {
        if (WAIT_OBJECT_0 != WaitForMultipleObjects(lib::rng::size(waitfor), waitfor, FALSE, INFINITE))
        {
          // monitor_smardcard_readers will return SCARD_E_CANCELLED
          return false;
        }
        return true;
      },
      [&](lib::rng::range<SCARD_READERSTATE*> readersrange)
      {
        for (auto& state : readersrange)
        {
          auto stateChanges = (state.dwCurrentState ^ state.dwEventState) & std::numeric_limits<unsigned short>::max();
          std::wcout 
            << L"nothread - "
            << state.szReader
            << L" changes: " << std::hex << std::showbase << stateChanges
            << L"["
          ;
          printSCardState(std::wcout, stateChanges)
            << L"] state: " << std::hex << std::showbase << state.dwEventState
            << L"["
          ;
          printSCardState(std::wcout, state.dwEventState)
            << L"]" 
            << std::endl
          ; 

          if (state.dwCurrentState != SCARD_STATE_UNAWARE && 
            ((state.dwEventState & SCARD_STATE_PRESENT) != SCARD_STATE_PRESENT ||
              stateChanges == SCARD_STATE_INUSE ||
              stateChanges == SCARD_STATE_UNPOWERED ||
              (state.dwEventState & (SCARD_STATE_UNPOWERED | SCARD_STATE_EMPTY | SCARD_STATE_IGNORE | SCARD_STATE_UNKNOWN | SCARD_STATE_UNAVAILABLE | SCARD_STATE_MUTE)) ||
              state.cbAtr == 0))
          {
            // we have seen this reader before and one of:
            // no card
            // only flipped INUSE
            // only flipped UNPOWERED
            // UNPOWERED EMPTY UNKNOWN UNAVAILABLE MUTE
            // no atr
            //
            // don't try to read the card
            continue;
          }
          // read the card in the reader and list the certs on the card
        }
      }
    );
    winerror.suppress();
  }

  return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-12-02T09:27:16.570

我知道我迟到了 2 年多，但也许我的回复仍然可以帮助某人。

我有一些简单的代码作为进一步开发的起点。我首先在 Windows 7 上创建它；AFAICS 它在 Windows 8 上也可以正常工作。这只使用了一个阅读器，但之前的迭代使用了一个阅读器列表，并且效果一样好。相关部分如下。

读取器状态结构的初始化：

```
memset(&m_State, 0, sizeof(m_State));
m_State.szReader = _wcsdup(m_ReaderName.c_str());
m_State.dwCurrentState = SCARD_STATE_UNAWARE; 
```

等待事件：

```
bool TSmartCardReader::WaitForEvent(DWORD Timeout, TCardEvent &CardEvent)
{
  CardEvent = None;

  // Reset reader structure, except the specific fields we need
  // (because that's what the docs say: "Important: Each member of each structure
  // in this array must be initialized to zero and then set to specific values as
  // necessary. If this is not done, the function will fail in situations that 
  // involve remote card readers.")
  const wchar_t *szReader = m_State.szReader;
  DWORD dwCurrentState = m_State.dwCurrentState;
  memset(&m_State, 0, sizeof(m_State));
  m_State.szReader = szReader;
  m_State.dwCurrentState = dwCurrentState;

  LONG rv = SCardGetStatusChangeW(m_hContext, Timeout, &m_State, 1);
  if (rv == SCARD_S_SUCCESS)
    {
    HandleStatusChange(CardEvent);
    // I'm not sure we really need to reset the SCARD_STATE_CHANGED bit
    m_State.dwCurrentState = m_State.dwEventState & ~SCARD_STATE_CHANGED;
    }
  else if (rv == SCARD_E_TIMEOUT)
    return false; // No status changes
  else if (rv == SCARD_E_NO_READERS_AVAILABLE)
    throw ESCNoReaders("No readers available");
  else
    throw ESCWaitForEvent(GetErrorText(rv));

  return CardEvent != None;
} 
```

据我了解文档，关键是您将 set dwCurrentState 设置为您认为是读者的当前状态。SCardGetStatusChange() 会考虑当前状态来决定什么构成状态更改。

# excel - How to use IF and SUM in excel to count unique entries in a row?

> ID：11294646
> 
> 赞同：1
> 
> 时间：2012-07-02T13:25:41.077
> 
> 标签：excel, if-statement, sum

Basically I have a large set of data in excel, and I was wondering how to count across a row how many cells are not #N/A?? I think it should be possible with IF and SUM but I'm not entirely certain.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:55:34.437

To count all values except blanks and #N/A errors try COUNTIFS like this for data in row 2

`=COUNTIFS(2:2,"<>#N/A",2:2,"<>")`

If you don't want to count duplicates then this version will give you a count of all **different** values (except blanks and errors)

`=SUM(IF(1-ISERROR(2:2),(2:2<>"")/COUNTIF(2:2,2:2&"")))`

that's an "array formula" that needs to be confirmed with CTRL+SHIFT+ENTER

Note that the first formula uses COUNTIFS function and therefore will not work in versions of excel before 2007 - this is an alternative that will work in those versions

`=COUNTA(2:2)-COUNTIF(2:2,"#N/A")`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:28:25.403

Try using `=COUNTIF(RANGE, VALUE)`, here's an example that will count the numer

```
=COUNTIF(A:A, "Yes") 
```

or

```
=COUNTIF(A1:D16, "Yes") 
```

To count the cells that contain a value (I.E., are not empty) then use ``=COUNTA(A:A)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T14:42:50.060

When you want to "mark" the duplicates, use this in an empty column:

```
=COUNTIF($A$2:$A2,A2)>1 
```

Puth the formula is row 2 and copy this all the way down to the last used row.

(What I usually do: Somewhere in column A, press [Ctrl]+[Down], to jump to the last item, then move sideways to the column where you want to put your formula in and put something e.g. an "X". Then jump all the way up [Ctrl]+[Up], put the formula in row 2, copy it and press [Shift]+[Ctrl]+[Down] to mark the wole range in this column from row 2 to the last used row, and press [Enter] to paste your formula.)

In this formula, the search area increases, the further you copy this down. So this first time a duplicate item is found, the value will be 1 (i.e. false) the second, third or more times this duplicate item is found, the value will be greater than 1 and give a value of true.

# javascript - Facebook Javascript sdk，需要按两次登录按钮

> ID：11294662
> 
> 赞同：1
> 
> 时间：2012-07-02T13:26:27.343
> 
> 标签：javascript, facebook, login, sdk, facebook-login

我有一个带有 onclick 事件的 Facebook 登录按钮。

```
<fb:login-button scope="email, user_about_me, user_birthday" onclick="login()">Login with Facebook</fb:login-button> 
```

如果单击它，则代码：

```
function login(){
FB.getLoginStatus(function(response) {
   if (response.status === "connected") {
        FB.api({
            method: 'fql.query',
            query: 'SELECT name, email, pic_square FROM user WHERE uid=me()'
                },
        function(response) {
            var check = $.get("includes/facebook_login.php", {command:response[0].email, commandP:response[0].pic_square}, //check if users exist with some selects and create sessions 
                function(data){
                    if(data == 1){ //on facebook_login.php echo 1 if user exists in our db. if so, redirect.
                        FB.Dialog.remove(FB.Dialog._active);
                         window.location="wishlist.php";
                    }
                    else if(data == 0){
                        $("#fb_error").dialog("open");  
                        }
                     });
                }
            );
        }
}, true); 
```

}

代码触发 Facebook 登录没有问题。但如果这段代码完成，它不会将我重定向到下一页（wishlist.php）。我需要再次单击 Facebook 的登录按钮，然后它会重定向我。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T17:53:44.790

> 我究竟做错了什么？

您假设登录按钮立即通过登录完成，但事实*并非如此*。因此，您的函数`login`在登录实际发生之前被调用。

我的建议是：`<fb:login-button>`完全放弃，实现 FB.login，然后单击您自己的按钮调用它……</p>

# php - 我的 SESSION 不起作用

> ID：11294663
> 
> 赞同：0
> 
> 时间：2012-07-02T13:26:27.397
> 
> 标签：php

注册页面：

```
$_SESSION['namex']=$_POST['username'];
$_SESSION['passx']=$_POST['pass'];
$_SESSION['confirmpassx']=$_POST['confirmpass'];
$_SESSION['emailx']=$_POST['email'];
$_SESSION['confirmemailx']=$_POST['email2'];
$_SESSION['keyx']=$_POST['byond']; 
```

索引页

```
$namex=$_POST['username'];
$passx=$_POST['pass'];
$pass2x=$_POST['confirmpass'];
$emailx=$_POST['email'];
$email2x=$_POST['email2'];
$ByondKeyx=$_POST['byond'];
str_replace($namex,$_SESSION['namex'],$namex);
str_replace($passx,$_SESSION['passx'],$passx);
str_replace($pass2x,$_SESSION['confirmpassx'],$pass2x);
str_replace($emailx,$_SESSION['emailx'],$emailx);
str_replace($email2x,$_SESSION['confirmemailx'],$email2x);
str_replace($keyx,$_SESSION['keyx'],$keyx); 
```

好的，所以这些代码应该做的是注册页面正在做它的事情（我认为）并且索引页面是一个页面，如果使用了用户名或密码或用户名无效，那么索引页面就会出现并使用与注册页面相同的数据制作另一个表格。抱歉，如果很难阅读/理解。如果您想查看我的网站并了解我的意思，请点击以下链接：`http://snyp.freeoda.com` 感谢您的阅读，请提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:27:35.427

添加`session_start()`到每个文件的顶部并添加`$_SESSION['varname']`到每个 str_replace 调用的前面。（或者你试图分配的任何东西，不能完全告诉）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:28:35.693

您`session_start();`在代码的最开始有函数调用吗？
注意：它之前不允许有换行符和空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:36:15.267

首先，此答案假定您`session_start()`在两个脚本的顶部都有，并且在显示页面时没有可见错误/警告（使用`error_reporting(-1)`和`ini_set('display_errors', 'On')`.

您的注册页面将发布的字段存储在会话中：

```
$_SESSION['namex']=$_POST['username']; 
```

没关系；假设您重定向回索引页面。然后索引页面可以直接从会话中获取值：

```
$namex = $_SESSION['namex']; 
```

假设索引页面上`$namex`的表单用于构建表单。

# jfreechart - JFreeChart：如何使系列不可见？

> ID：11294666
> 
> 赞同：2
> 
> 时间：2012-07-02T13:26:37.383
> 
> 标签：jfreechart

我正在尝试使 ohlc 条形图不可见，这样我就可以只留下移动平均线的窗口。这是两个系列的代码（ohlc 条和移动平均线）：

```
private static JFreeChart createChart(OHLCDataset dataset)
{
    JFreeChart chart = ChartFactory.createHighLowChart(
            "HighLowChartDemo2",
            "Time",
            "Value",
            dataset,
            true);

    XYPlot plot = (XYPlot)chart.getPlot();

    DateAxis axis = (DateAxis)plot.getDomainAxis();
    axis.setTickMarkPosition(DateTickMarkPosition.MIDDLE);
    NumberAxis yAxis = (NumberAxis)plot.getRangeAxis();
    yAxis.setNumberFormatOverride(new DecimalFormat("$0.00"));

    //overlay the moving average dataset...
    XYDataset dataset2 = MovingAverage.createMovingAverage(dataset, "-MAVG", 3 * 24 * 60 * 60 * 1000L, 0L);
    plot.setDataset(1, dataset2);
    plot.setRenderer(1, new StandardXYItemRenderer());

    XYItemRenderer theRenderer = plot.getRenderer(0);
    theRenderer.setSeriesVisible(0, false);

    return chart;
} 
```

由于某种原因 setSeriesVisible 函数不起作用。有任何想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T14:43:22.483

`HighLowRenderer`忽略`getSeriesVisible()`and `getBaseSeriesVisible()`，尽管它*确实*检查`getDrawOpenTicks()`and `getDrawCloseTicks()`。您可以替换`OHLCDataset`：

```
plot.setDataset(0, null); 
```

或者，不要一开始就添加`OHLCDataset`；只需使用它来创建`MovingAverage`.

# java - 在特定位置添加 XML 数据

> ID：11294669
> 
> 赞同：3
> 
> 时间：2012-07-02T13:26:42.873
> 
> 标签：java, xml, jaxb

我有一个非常大的 XML 数据，每次程序启动时都应该加载。

```
<Calculation>
 <CalcGroup TypeOfGroup="GeneralInfo">
   <Parameter Name="name"></Parameter>
 </CalcGroup>
 <EnvironmetData>
  <EnvDataGroup  Id="1">
    <Parameter Name="Lastname"/>
  </EnvDataGroup>
 </EnvironmentData>
 <ComponentData>
  <Component TypeofComponent="Piston" ID="1">
   <ComponentCatagory="Values">
    <Parameter Name ="Temprature"></Parameter>
   </ComponentCatagory>
  </Component>
 </ComponentData>
</Calculation> 
```

如何加载默认 XML？并在我的项目中添加或删除项目？

每当我尝试为 ex 添加一个元素时。

```
 Component com = new Componet();
   com.setTypeofComponent=("Piston");
   com.setID(BigInteger.valueof(2));
   ComponentData.getcomponet().add(com); 
```

我发现这个组件添加在 XML 文件的末尾，而我只需要它在 pistion 类别中。仅供参考，我使用 jaxb 生成属性方法。我在java代码中使用这个xml。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T15:01:45.667

**添加到结尾**

这就是你目前正在做的事情。该`add`方法会将 new 添加到属性`Component`的末尾。`List`

```
componentData.getComponent().add(com);  // Add to End 
```

**添加到特定位置**

您可以使用`List`API 在某个`specify`位置添加新组件。

```
componentData.getComponent().add(3, com); 
```

**修改现有项目**

`Component`如果您想从一开始就修改现有的，`List`您将需要访问它。

```
Component com = componentData.getComponent().get(6);
com.setTypeofComponent=("Piston");
com.setID(BigInteger.valueof(2)); 
```

# qt - 如何将几个 QImage 放在一个 QGraphicsView 中？

> ID：11294670
> 
> 赞同：0
> 
> 时间：2012-07-02T13:26:57.233
> 
> 标签：qt, qgraphicsview, qgraphicsitem, qgraphicsscene

我有一个添加了几个项目的场景。问题是当项目显示时，它们是重叠的。有什么方法可以指示每个项目应该出现的位置`QGraphicsView`或`QGraphicsScene`位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T20:13:36.150

是的，你必须使用`QGraphicsItem::setPos()`方法。我想你添加了一个`QGraphicsPixmapItem`，所以它可能看起来像：

```
QGraphicsScene *scene = ... ; // your scene
QImage image = ... ; // the QImage you want to add to the scene
QPixmap pixmap = QPixmap::fromImage(image) ;

// add image item to the scene
QGraphicsPixmapItem * imageItem = scene->addPixmap(pixmap) ;

// modify item's position in scene coordinates
QPointF imagePos = ... ; // whatever scene pos you want
imageItem->setPos(imagePos) ; 
```

# actionscript - 如何以最大/最小角度停止旋转动画剪辑？

> ID：11294671
> 
> 赞同：1
> 
> 时间：2012-07-02T13:26:58.617
> 
> 标签：actionscript, rotation

我有一个按钮（减少），当按下按钮时，箭头向左旋转。我需要箭头停在某个角度（大约在 8 点钟方向）。

我怎样才能得到箭头的角度，然后阻止它旋转超过这个点（即使用户一直按下按钮）？

这是我的代码：

```
import flash.display.MovieClip;
import flash.events.MouseEvent; 
import flash.events.Event;

stop();

var rotate = 0;  

decrease.addEventListener(MouseEvent.MOUSE_DOWN, decreasePressed);  
decrease.addEventListener(MouseEvent.MOUSE_UP, removeEnterFrame); 

function decreasePressed(e:MouseEvent):void  
{   
        rotate = -2;
        addEnterFrame();
}

function addEnterFrame():void 
{     
    this.addEventListener(Event.ENTER_FRAME, update); 
}  

function removeEnterFrame(e:MouseEvent):void 
{     
    this.removeEventListener(Event.ENTER_FRAME, update); 
}  

function update(e:Event):void 
{     
    arrow1.rotation += rotate;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T23:52:16.467

假设您的箭头是垂直创建的，箭头指向上方，逆时针旋转（如您所做的那样）时的 8 点钟位置大约为 -112 度。因此，您需要在更新方法中添加检查，以确保箭头的旋转未设置为低于 -112 的值：

```
// May need to adjust this depending on how your arrow is created
var minDegrees = -112;

function update(e:Event):void 
{   
    var position:int = arrow1.rotation + rotate;

    // Check increment of rotation does not take us past our limit
    if (position <= minDegrees) 
         position = minDegrees;

    arrow1.rotation = position;
} 
```

# facebook-graph-api - 图表未发送照片的位置

> ID：11294675
> 
> 赞同：0
> 
> 时间：2012-07-02T13:27:07.317
> 
> 标签：facebook-graph-api, photo

我们对 Graph 进行了查询，该查询直到今天都运行良好。 [https://graph.facebook.com/NNN/photos?fields=position,link,images](https://graph.facebook.com/NNN/photos?fields=position,link,images)

现在 Facebook Graph 没有发送位置（链接也没有）。为什么？照片对象或字段或其他东西有变化吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T01:22:13.417

好的...问题是现在这个查询需要包含访问令牌。

旧查询： [https ://graph.facebook.com/NNN/photos?fields=id,link,position](https://graph.facebook.com/NNN/photos?fields=id,link,position)

新查询： [https ://graph.facebook.com/NNN/photos?fields=id,link,position&access_token=ACCESS_TOKEN](https://graph.facebook.com/NNN/photos?fields=id,link,position&access_token=ACCESS_TOKEN)

# java - 来自两个位置的相同 NetBeans 项目

> ID：11294676
> 
> 赞同：0
> 
> 时间：2012-07-02T13:27:13.310
> 
> 标签：java, netbeans, version-control, ide

我工作时有台式机，家里有笔记本电脑。我不携带笔记本电脑上班。是否有一种可接受的方式在两台机器上使用相同的 NetBeans Java 项目？

我目前将项目存储在 Dropbox 文件夹中，并从两台机器上访问它。它在 95% 的时间里都能正常工作，但我偶尔会遇到一些小故障（库引用、文件名区分大小写等）。

我使用了共享网络驱动器，但在家编译和部署时的延迟是不可接受的。

我想我可以每天都将它提交给 SVN，但我可能不会一直记得。

想知道其他人如何处理这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:28:15.960

源代码控制是最好的选择，您也可以为您的私人项目使用一些免费的 SVN/GIT 服务提供商

**看**

*   [https://stackoverflow.com/questions/59791/free-online-private-svn-repositories](https://stackoverflow.com/questions/59791/free-online-private-svn-repositories)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T04:26:48.740

在您的 Dropbox 文件夹中创建一个裸 git 存储库，然后在家中推/拉它并工作。它工作得很好，而且不难记住。git 的好处是你只需要共享磁盘，Dropbox 会照顾你。你不需要服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T02:36:59.470

我是 java 项目的一部分，我们使用名为[Team Server](http://netbeans.org/kb/docs/ide/team-servers.html)的 netbeans 插件。这个插件允许您在 java.net 中创建一个项目并在 Kenai 基础架构下工作。它真的很容易使用。

# magento - 这是否可以获得按 RAND() 排序的类别？

> ID：11294683
> 
> 赞同：1
> 
> 时间：2012-07-02T13:27:24.603
> 
> 标签：magento, magento-1.6

我想以随机顺序显示产品类别。那可能吗？我怎样才能做到这一点？

我正在使用自定义主题，类别通过以下方式获取：

```
 $_categories = $this->getStoreCategories(); 
```

也许使用 php shuffle 功能会更容易？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T00:39:01.350

获得类别集合后，是否要尝试使用此

```
 $arrCategories->getSelect()->order(new Zend_Db_Expr('RAND()'))->limit('5'); 
```

我已经在不同的项目集合上使用了它，所以我不确定这是否适用于类别。但我认为它值得一试。它只是用 RAND() 的 Order 编写一个选择查询。

希望它有效。

干杯，

斯瓦普纳

# delphi - 为 TEqualityComparer.Construct 编写哈希函数的规范方法是什么？

> ID：11294686
> 
> 赞同：5
> 
> 时间：2012-07-02T13:27:28.520
> 
> 标签：delphi, hash, delphi-xe2

考虑以下记录：

```
TMyRecord = record
  b: Boolean;
  // 3 bytes of padding in here with default record alignment settings
  i: Integer;
end; 
```

我希望实施`IEqualityComparer<TMyRecord>`. 为此，我想调用`TEqualityComparer<TMyRecord>.Construct`. 这需要提供一个`TEqualityComparison<TMyRecord>`对我没有问题的。

但是，`Construct`也需要一个`THasher<TMyRecord>`，我想知道实现它的规范方法。该函数需要具有以下形式：

```
function MyRecordHasher(const Value: TMyRecord): Integer;
begin
  Result := ???
end; 
```

我希望我需要调用`BobJenkinsHash`记录值的两个字段，然后以某种方式将它们组合起来。这是正确的方法，我应该如何结合它们？

我不使用的原因`TEqualityComparison<TMyRecord>.Default`是它使用了`CompareMem`，因此由于记录的填充而将是不正确的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T13:58:46.963

关于覆盖 hashCode的[Effective Java（作者 Joshua Bloch）](http://java.sun.com/developer/Books/effectivejava/Chapter3.pdf)部分可能很有用。它展示了如何组合对象（或记录）的各个部分以有效地构造 hashCode。

> 一个好的散列函数往往会为不相等的对象产生不相等的散列码。这正是 hashCode 合约第三条的含义。理想情况下，散列函数应该在所有可能的散列值上均匀分布任何合理的不相等实例集合。实现这一理想可能非常困难。幸运的是，实现一个公平的近似并不难。这是一个简单的食谱：
> 
> 1.  `int`在名为 的变量中存储一些恒定的非零值，例如 17 `result`。
> 2.  对于`f`对象中的每个重要字段（即 equals 方法考虑的每个字段），请执行以下操作：
>     
>     
>     
>     一个。计算字段的`int`哈希码`c`：.....*细节省略*....
>     
>     
>     
>     湾。将步骤 a 中计算的哈希码 c 合并到结果中，如下所示：`result = 37*result + c;`
>     
>     
> 3.  返回`result`。
>     
>     
> 4.  编写完`hashCode`方法后，问问自己相等的实例是否具有相等的哈希码。如果没有，找出原因并解决问题。

这可以翻译成Delphi代码如下：

```
{$IFOPT Q+}
  {$DEFINE OverflowChecksEnabled}
  {$Q-}
{$ENDIF}
function CombinedHash(const Values: array of Integer): Integer;
var
  Value: Integer;
begin
  Result := 17;
  for Value in Values do begin
    Result := Result*37 + Value;
  end;
end;
{$IFDEF OverflowChecksEnabled}
  {$Q+}
{$ENDIF} 
```

然后，这允许实现`MyRecordHasher`：

```
function MyRecordHasher(const Value: TMyRecord): Integer;
begin
  Result := CombinedHash([IfThen(Value.b, 0, 1), Value.i]);
end; 
```

# javascript - 在javascript中获取xml标签名称

> ID：11294690
> 
> 赞同：-2
> 
> 时间：2012-07-02T13:27:43.837
> 
> 标签：javascript, xml-parsing

我一直试图在 java 脚本中获取标签名称及其值。我使用的 xml 文件如下所示：

```
<root>
    <note>
        <to>Gil</to>
        <from>
            <firstname>john</firstname>
            <lastname>corner</lastname>
        </from>
        <heading>Reminder</heading>
    </note>
    <note>
        <to>Mary</to>
        <from>
            <firstname>Clara</firstname>
            <lastname>Diana</lastname>
        </from>
        <heading>
            How are you
        </heading>
    </note>
</root> 
```

我希望输出如下：

```
TageName : root Attribute: 0 Text: null

TageName : note Attribute: 0 Text: null
TageName : to   Attribute: 0 Text: Gil
TageName : from Attribute: 0 Text: null
TageName : firstname Attribute: 0 Text: john
TageName : lastname Attribute: 0 Text: corner
TageName : heading Attribute: 0 Text: Reminder

TageName : note Attribute: 0 Text: null
TageName : to   Attribute: 0 Text: Mary
TageName : from Attribute: 0 Text: null
TageName : firstname Attribute: 0 Text: Clara
TageName : lastname Attribute: 0 Text: Diana
TageName : heading Attribute: 0 Text: How are you 
```

这可能吗。如果是这样，请帮助我...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T13:45:36.997

```
var xml = '<root><note ><to>Gil</to><from><firstname>john</firstname><lastname>corner</lastname></from><heading>Reminder</heading></note><note><to>Mary</to><from><firstname>Clara</firstname><lastname>Diana</lastname></from><heading>How are you</heading></note></root>';

var node = (new DOMParser()).parseFromString(xml, "text/xml").documentElement;

var nodes = node.querySelectorAll("*");

for (var i = 0; i < nodes.length; i++) {
    var text = null;
    if (nodes[i].childNodes.length == 1 && nodes[i].childNodes[0].nodeType == 3) //if nodeType == text node
        text = nodes[i].textContent; //get text of the node
    console.log("TageName : ", nodes[i].tagName, ", Text : ", text);
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:37:31.647

这是一个显示基本用法的[jsFiddle 。](http://jsfiddle.net/plowdawg/UNwR2/)这是使用 jQuery 的基本代码：

```
$(document).ready(function()
{
    $(this).find("root").children().each(function()
     {
             alert($(this).get(0).tagName+":"+$(this).text());                                 
       });                                                                                     
 }); 
```

修改它以满足您的需求。

# android - Android：自动化 GUI 测试

> ID：11294693
> 
> 赞同：-2
> 
> 时间：2012-07-02T13:28:02.080
> 
> 标签：android, user-interface, automated-tests

我想为我的 android 应用程序创建一些自动化的 GUI 测试。我知道 Robotium 和其他类似项目，但我想从头开始创建自己的测试框架。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:34:37.100

您可以先阅读有关测试的[文档](http://developer.android.com/tools/testing/testing_android.html)，然后查看 Robotium 的[源代码](https://github.com/jayway/robotium)。至少我会这样开始。

# zend-framework - Zend_Mail 错误 500 > postfix/sendmail 致命：不支持 -n 选项

> ID：11294698
> 
> 赞同：0
> 
> 时间：2012-07-02T13:28:12.543
> 
> 标签：zend-framework, webserver, sendmail, postfix-mta, zend-mail

我正在一个非常特定的服务器配置中处理 Zend 项目，我们的生产环境由两台专用服务器组成，一台用于公司的电子邮件，它托管一个 postfix 服务器，另一台用于我们在 Apache2/ 上运行的 Web 应用程序的服务器禅。

这些服务器有两个不同的 IP，但在同一个网站域上工作。

现在，当我尝试使用来自邮件服务器的电子邮件作为发件人发送电子邮件时，我从 Zend_Mail 收到错误 500，并且 email.err 日志告诉我：

> postfix/sendmail[15782]：致命：不支持-n选项

但是当我将本地地址或空白电子邮件作为发件人时，它可以工作，所以我想我会被网络服务器的后缀踢出去，因为它不管理本地这些电子邮件。

所以我的问题是：有没有办法在不合并两台服务器的情况下使用域电子邮件作为来自远程服务器的发件人？

编辑：我忘了补充：我不能使用远程服务器 SMTP，我只能使用本地发送邮件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T12:44:42.873

我没有找到任何解决方案或解释，所以我最终编写了一个基于 PHP 邮件命令的自定义操作帮助程序。

我希望它可以帮助某人：

```
class Zend_Controller_Action_SentEmail extends Zend_Controller_Action_Helper_Abstract{

    public function sendEmail($from, array $to, $subject, $message){

        //Header set
        $headers  = 'MIME-Version: 1.0' . "\r\n";
        $headers .= 'Content-type: text/html; charset=utf-8' . "\r\n";
        $headers .= "From: ".$from."<email@domain.com>\r\n";
        $headers .= "X-Mailer: PHP/".phpversion();

        //To
        $stringTo = "";

        foreach($to as $k => $v) {
                $stringTo .= $k." <".$v.">, ";
        }

        $stringTo = trim($stringTo, ", ");

        //Send the email
        if(mail($stringTo, $subject, $message, $headers, "-f bounce@domain.com")){
            return true;
        }
        else{
            //Oh! Noes!
            return false;
        }
    } 
} 
```

# c# - C# WinForms 无法设置焦点

> ID：11294707
> 
> 赞同：1
> 
> 时间：2012-07-02T13:28:47.220
> 
> 标签：c#, winforms, focus

我目前面临的问题是，当我尝试将焦点设置在某个控件（文本框）上时，什么也没发生，也许我只是忽略了一些东西。（在某个地方我发现焦点是“低级”方法，应该使用 select() ，但是，它也不起作用）

从表单登录，我启动 EncryptPSW 表单的新实例

```
private void openToolStripMenuItem_Click(object sender, EventArgs e)
    {
        EncryptPSW ePSW = new EncryptPSW();
        ePSW.setOsLog(false, this);
        ePSW.ShowDialog();        
    } 
```

在按钮（位于 EncryptPSW 表单上）单击事件我调用填充方法

```
public void fill()
    {
        if (textBoxPSW.Text.Length == 8)//psw has to be 8 chars long
        {
            if (save)//determinating whether save or fetch of data should be done
            { login.launchSave(textBoxPSW.Text,this); }
            else { login.launchOpen(textBoxPSW.Text,this); }
        }
        else { MessageBox.Show("The password must contain 8 characters");}
    } 
```

从登录启动保存或打开方法（我的问题只是打开，因为在保存期间我不需要对焦点做任何事情）

```
public void launchOpen(string psw,EncryptPSW ePSW)
    {

        ePSW.Close();
        Encryptor.DecryptFile("loggin.bin", psw, this); //decrypting data and setting textBoxes Text property into the fetched ones
        setFocus();

    } 
```

完成所有工作后，应调用 setFocus() 以设置焦点和其他属性。

```
public void setFocus()
    {
        textBoxDatabase.Focus();
        textBoxDatabase.SelectionStart = textBoxDatabase.TextLength - 1;
        textBoxDatabase.SelectionLength = 0;
    } 
```

我尝试了很多不同的方法，例如：

从 EncryptPSW_FormClosed 中调用 setFocus() 在 EncryptPSW 关闭后调用整个打开进程（从 EncryptPSW_FormClosed 中）等等，但是我不记得全部了。

在 Form_Closed 的情况下，奇怪的是，当我试图从那里显示一个消息框而不是设置焦点时（只是为了看看问题可能出在哪里），它在 EncryptPSW 表单关闭之前显示。

我对此的唯一猜测是 EncryptPSW 的实例以某种方式阻止了登录表单及其控件

我希望我能很好地描述我的问题，并且至少有点道理；]

提前致谢，

问候，

雷莱斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:52:14.293

好吧，这可能是我看到的最丑的东西，但是。

使用

```
public void setFocus() 
    { 
        textBoxDatabase.Focus(); 
        textBoxDatabase.SelectionStart = textBoxDatabase.TextLength - 1; 
        textBoxDatabase.SelectionLength = 0; 
    } 
```

更改您的代码

```
public void launchOpen(string psw,EncryptPSW ePSW)  
    {  

        ePSW.Close();  
        Encryptor.DecryptFile("loggin.bin", psw, this); //decrypting data and setting textBoxes Text property into the fetched ones  
        setFocus();  

    } 
```

到

```
delegate void settingfocus();
public void launchOpen(string psw,EncryptPSW ePSW)  
    {  

        ePSW.Close();  
        Encryptor.DecryptFile("loggin.bin", psw, this); //decrypting data and setting textBoxes Text property into the fetched ones  
    settingfocus sf = new settingfocus(setFocus);
    this.BeginInvoke(sf);

    } 
```

这对我有用

（很抱歉显然认为在程序之前插入“this”，并将第 x 行更改为 this 是易读的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T14:00:41.467

由于文本框在登录表单中，并且您正在从它作为对话框（子）打开 EcryptPWS，因此您的登录表单将无法将焦点设置为任何内容。关闭后您需要设置焦点。你可以这样做：

```
private void openToolStripMenuItem_Click(object sender, EventArgs e)
{
    using(EncryptPSW ePSW = new EncryptPSW())
    {
       ePSW.setOsLog(false, this);
       if (ePSW.ShowDialog() == DialogResult.OK)
       {
           textBoxDatabase.Focus(); 
       }
    }
} 

public void launchOpen(string psw,EncryptPSW ePSW) 
{ 
    ePSW.DialogResult = DialogResult.OK;
    ePSW.Close(); 
    Encryptor.DecryptFile("loggin.bin", psw, this); //decrypting data and setting textBoxes Text property into the fetched ones 
} 
```

# sql-server - 安装 SQL Server 2012 时出现 XML 错误

> ID：11294714
> 
> 赞同：2
> 
> 时间：2012-07-02T13:29:42.053
> 
> 标签：sql-server, xml, windows-7, sql-server-2012

试图在我的笔记本电脑上安装 SQL Server 2012 Developer Edition。

我不断收到关于无法写出 XML 文件的错误消息。

> SQL Server 安装程序遇到以下错误。生成 XML 文档时出错。错误代码 0X84B10001

我以盒子管理员的身份运行 setup.exe。

请问我该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-03T04:12:57.457

我发现了这个问题。我的电脑上没有密码。我终于找到了 sql server 错误日志，它提供了有关对注册表执行某些操作的 Cryptographic Exception 的更多详细信息。然后我添加了一个密码，现在它已经安装并且工作正常。

疯狂的错误，但我明白你为什么不想要这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T01:58:07.517

尝试了这个和其他修复。显然，此错误消息适用于许多不同的问题。对我有用的是创建一个具有管理员权限的新用户。以该用户身份登录，然后安装。

# c# - 数据绑定值为空时如何在 DataGridViewComboBoxColumn 中显示文本

> ID：11294718
> 
> 赞同：0
> 
> 时间：2012-07-02T13:30:03.020
> 
> 标签：c#, winforms, datagridview, datagridviewcombobox, datagridviewcomboboxcell

我有一个带有 DataGridViewComboBoxColumn 的数据绑定 DataGridView。如果组合框值为 null 我想显示一个文本。我不想在数据绑定列表中添加一个空项，因为我需要在每个 datagridview 行中显示不同的文本。我将如何使用默认的 datagridview 控件来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:36:53.563

您可以使用 CellFormatting 事件来更改任何显示的值：

```
//attach in code or via designer:
dataGridView1.CellFormatting += new DataGridViewCellFormattingEventHandler(dataGridView1_CellFormatting);

    //example implementation:
    void dataGridView1_CellFormatting(object sender, DataGridViewCellFormattingEventArgs e)
    {  
        if (e.ColumnIndex == Column1.Index && e.Value==null)//where Column1 is your combobox column
        {
            e.Value = "Empty";
            e.FormattingApplied = true;
        }
    } 
```

# java - 我的 R.java 文件无法重新生成（清洁方法）

> ID：11294724
> 
> 赞同：0
> 
> 时间：2012-07-02T13:30:18.850
> 
> 标签：java, android, xml

很多人都有同样的问题，R文件。就我而言，我有一些来自不同项目的不同包，然后是不同的 R 文件。当我将所有这些包导入一个，以及所有 R 文件和布局时，它们（R 文件）消失了。

我的问题是：我该如何解决这个问题？我进行了一些操作，例如 Clean 方法，但没有任何改变，并且 R 文件永远不会卷土重来:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:33:16.160

*   删除“gen”文件夹。
*   通过 Project -> Clean... 清理项目

如果这没有帮助，您的项目中可能有错误的文件名或错误的编码字符串。打开“gen”文件夹中的错误文件，滚动到错误..如果它是一个字符串，只需更改它。如果它是一个错误的文件名，请重命名它。

不要在类以外的文件名中使用大写字母，不要使用空格...

如果您有一个 UTF-8 所需语言的字符串，请确保您的编辑器在 Window -> Preferences -> General -> Workspace -> Text file encoding 中设置为 UTF-8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:33:28.997

永远不要导入任何 R.java。如果你有任何自动导入的包说 import R.java，也删除它。清洁应该可以解决问题。如果没有，请检查您最近是否对 xml 文件进行了任何更改。有时，恢复到以前的更改可以解决此问题。如果没有，请重新创建一个新项目。从生成的位置追溯您的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T15:56:37.940

R.java 是在您的程序构建时自动生成的。如果构建失败，则无法生成 R 文件。

这基本上意味着您的代码中某处存在错误，阻止了它的构建。

要在 Eclipse 中查找错误，请使用“问题”窗口。如果它未打开，请转到 Window > Show View > Problems 或按热键：ALT+SHIFT+Q、X

Eclipse 中的 Problems 窗口将准确地向您显示阻止应用程序正确构建的原因。

# c# - PayPal SOAP API - 快速结帐 - 错误 10002

> ID：11294728
> 
> 赞同：0
> 
> 时间：2012-07-02T13:30:38.330
> 
> 标签：c#, asp.net, soap, paypal, paypal-sandbox

我正在尝试将我的网站连接到**Paypal 沙盒**以使用**快速结帐**功能。我已将此[链接](http://www.lumino-web.com/menu/vero-beach-tech-blog/payment-solution-using-paypal-express-checkout-soap-api)用作参考，但我不断收到**10002 错误**“安全标头无效”。

从文档来看，这必须是一个无效的凭据问题，但如果我通过soapUI手动发出请求，它会返回“成功”，如果我使用 curl[命令](https://www.x.com/developers/paypal/documentation-tools/paypal-sandbox-getting-started-guide#testing)，它也可以按预期工作。

场景：带有两个 Web 引用的 ASP.NET 页面，一个指向[https://www.sandbox.paypal.com/wsdl/PayPalSvc.wsdl](https://www.sandbox.paypal.com/wsdl/PayPalSvc.wsdl)，另一个指向[https://www.paypalobjects.com/wsdl/PayPalSvc.wsdl](https://www.paypalobjects.com/wsdl/PayPalSvc.wsdl)，给定的凭据是用户名、密码和签名，如以下代码片段所示：

```
using CloudShop.com.paypal.sandbox.www;

namespace CloudShop
{      

    public static PayPalAPIAASoapBinding BuildPayPalWebservice()
    {
        UserIdPasswordType credentials = new UserIdPasswordType()
        {
            Username = CloudShopConf.PayPalAPIUsername,
            Password = CloudShopConf.PayPalAPIPassword,
            Signature = CloudShopConf.PayPalAPISignature
        };
        PayPalAPIAASoapBinding paypal = new PayPalAPIAASoapBinding();

        paypal.RequesterCredentials = new CustomSecurityHeaderType()
        {
            Credentials = credentials
        };

        return paypal;
    } 
```

现在我想知道如何进行调试。有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:42:30.867

一些想法：

*   检查您是否为沙盒帐户使用**Live -Credentials。**

*   您是否使用`https://api-3t.sandbox.paypal.com/2.0/`（尤其是**-3t**部分）作为端点？[您应该使用 Signature authentication](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_api_endpoints)。

*   像往常一样，您应该逐步检查您正在使用的每个设置：协议、API 端点、版本、凭据等，并将您的手动 SoapUI 调用与存储在您的商店配置中的信息进行比较。

我还发现了[一篇关于此错误的博客文章](https://www.x.com/developers/community/blogs/ppmtspatrick/10002-security-header-not-valid)，可能有助于解决此问题。

# asp.net-mvc - DevExpress MVC GridView：通过 AJAX 加载的多个网格视图

> ID：11294732
> 
> 赞同：1
> 
> 时间：2012-07-02T13:30:59.137
> 
> 标签：asp.net-mvc, gridview, devexpress

我有一个包含多个 DevExpress 网格视图的页面，这些网格视图是通过 ajax 延迟加载的。问题是每次 ajax 加载后只有最后加载的 gridview 可以正常工作，其他的都是*dead*，即排序、过滤和分页不起作用。

我已经将问题定位为这样一个事实，即在每次 ajax 加载时，都会向 DXR.axd 发出 Web 请求，它会返回新的全局 DevExpress JS 对象（如`ASPx = new { };`）覆盖旧对象，这会导致先前加载的网格停止工作（如果在初始页面加载时存在多个网格视图，*则不会发生这种情况*，每个回调仅加载网格内容，不加载 DXR.axd）。

作为最后的手段，我*可​​以*加载托管在 IFRAME 中的网格视图，我想这会解决问题，但它很混乱（IFRAME 大小问题），如果可能的话，我想避免它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:29:16.093

从版本 12.1 开始，此问题已得到解决

有关更多信息，请参阅[此](http://www.devexpress.com/issue=S37603)线程。

# c# - 在 C# 中更改日期时间格式

> ID：11294733
> 
> 赞同：-4
> 
> 时间：2012-07-02T13:31:01.467
> 
> 标签：c#, windows, visual-studio-2010, time, clock

创建数字时钟。我是 C# 的新手。我的代码看起来像这样

```
 timeLbl.Text = DateTime.Now.ToLongTimeString();
    dateLbl.Text = DateTime.Now.ToLongDateString(); 
```

这是，结果

[http://content.screencast.com/users/TT13/folders/Jing/media/da6d1f65-bf5f-4735-97dc-70485112a998/2012-07-02_1826.png](http://content.screencast.com/users/TT13/folders/Jing/media/da6d1f65-bf5f-4735-97dc-70485112a998/2012-07-02_1826.png)

我有一些问题：

1.  我可以将时间格式更改为 24 小时制吗？如何？
2.  如何将日期更改为仅数字格式（如 dd/mm/yyyy）或此结果，但使用确切的语言（我的意思是，Windows 支持的另一种语言的“星期一，七月”，例如土耳其语）？
3.  如何使窗口动态改变它的宽度（取决于文本长度）？

请帮助我，实现这三件事。提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:34:35.460

答案 1：

```
timeLbl.Text = DateTime.Now.ToString("HH:mm:ss"); 
```

将时间转换为 24 小时格式。

答案 2：

```
dateLbl.Text = DateTime.Now.ToString("dd/MM/yyyy"); 
```

将日期格式转换为`31/06/2012`

更多格式[在这里](http://www.geekzilla.co.uk/View00FF7904-B510-468C-A2C8-F859AA20581F.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:41:13.063

回答的第一个和第二个点，对于窗口上设置的最后一个点`SizeToContent="WidthAndHeight"`，窗口将根据其内容大小动态调整大小。我假设您使用 wpf，否则它不起作用！

# javascript - 使用正则表达式验证电子邮件地址

> ID：11294736
> 
> 赞同：-1
> 
> 时间：2012-07-02T13:31:17.350
> 
> 标签：javascript

我正在尝试验证我网站上的电子邮件地址，并且我一直在尝试编写一个演示如何使用 JavaScript 进行电子邮件验证。我要做的是将用户输入的电子邮件地址的值传递给 validateEmail 函数，然后在 id 为“结果”的 div 中打印出“有效”或“无效”。因为我对 JavaScript 比较陌生，所以我不确定如何做到这一点，并且想知道是否有人可以向我展示如何做到这一点的示例？

```
<head>
<title>Practice</title>

<script type="text/javascript">
function validateEmail(email) { 
    var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(email);
} 
</script>
</head>
<body>
    <form action="post" method="practice.php">
        e-mail: <input id="email" type="text" onblur="validateEmail(execute(document.getElementById('email').value))" />
        <div id="result"></div>
    </form>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:32:56.003

首先，您不需要使用`execute`方法并且可以`value`从`this`上下文中获取：

```
validateEmail( this.value ) 
```

然后修改您的函数以打印结果：

```
function validateEmail(email) { 
    var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    if(re.test(email)) {
        document.getElementById('result').innerHTML = 'valid';
    } else {
        document.getElementById('result').innerHTML = 'invalid';
    }
} 
```

# c# - 使用正则表达式获取匹配的 HTML 值

> ID：11294737
> 
> 赞同：1
> 
> 时间：2012-07-02T13:31:34.287
> 
> 标签：c#, html, regex

好的开始我知道我不应该使用正则表达式来解析 HTML，因为它不是很可靠，不是 100% 安全等。但是，这只是正则表达式的学习练习。

所以我的例子使用了 bbc 网站[http://www.bbc.co.uk/sport/football/premier-league/table](http://www.bbc.co.uk/sport/football/premier-league/table)。

该项目正在解析第一个表的 tbody。我正在尝试进行搜索，以便只返回与搜索值匹配的元素。例如，给定搜索“manc”，我想要曼彻斯特城和曼彻斯特联队的 tr 标签（从 url 匹配）。

到目前为止，我所拥有的是`<tr\b[^>]*>(.*?)manc(.*?)</tr>`从第一个 tr 到 man city 之后的结束 tr 匹配，然后返回 man utd 的预期结果。谁能指出我在这个正则表达式上出了什么问题。

**编辑：来源（修剪）**

```
<tbody id="trc-20-118996114-3">
  <tr id="team-138824012" class="team first">
    <td class="statistics"></td>
    <td class='position'>
      <span class='moving-up'>Moving up</span>
      <span class='position-number'>1</span>
    </td>
    <td class="team-name">
      <a href='http://www.bbc.co.uk/sport/football/teams/arsenal'>Arsenal</a>
    </td>
    <td class="played">0</td>

    <td class="home-won">
      <span>0</span>
    </td>
    <td class="home-drawn">0</td>
    <td class="home-lost">0</td>
    <td class="home-for">0</td>
    <td class="home-against">0</td>
    <td class="away-won">
      <span>0</span>
    </td>
    <td class="away-drawn">0</td>
    <td class="away-lost">0</td>
    <td class="away-for">0</td>
    <td class="away-against">0</td>
    <td class="goal-difference">0</td>
    <td class="points">0</td>
    <td class="last-10-games">
      <ol>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="draw" title="Draw">
          <span>Draw</span>
        </li>
        <li class="draw" title="Draw">
          <span>Draw</span>
        </li>
        <li class="draw" title="Draw">
          <span>Draw</span>
        </li>
        <li class="loss" title="Loss">
          <span>Loss</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="loss" title="Loss">
          <span>Loss</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="win last" title="Win">
          <span>Win</span>
        </li>
      </ol>
    </td>
    <td class="status">
      <a class="report" href="http://www.bbc.co.uk/sport/0/football/17973141">Report</a>
    </td>
  </tr>
  <tr id="team-137316633" class="team">
    <td class="statistics"></td>
    <td class='position'>
      <span class='moving-up'>Moving up</span>
      <span class='position-number'>2</span>
    </td>
    <td class="team-name">
      <a href='http://www.bbc.co.uk/sport/football/teams/aston-villa'>Aston Villa</a>
    </td>
    <td class="played">0</td>

    <td class="home-won">
      <span>0</span>
    </td>
    <td class="home-drawn">0</td>
    <td class="home-lost">0</td>
    <td class="home-for">0</td>
    <td class="home-against">0</td>
    <td class="away-won">
      <span>0</span>
    </td>
    <td class="away-drawn">0</td>
    <td class="away-lost">0</td>
    <td class="away-for">0</td>
    <td class="away-against">0</td>
    <td class="goal-difference">0</td>
    <td class="points">0</td>
    <td class="last-10-games">
      <ol>
        <li class="loss" title="Loss">
          <span>Loss</span>
        </li>
        <li class="draw" title="Draw">
          <span>Draw</span>
        </li>
        <li class="draw" title="Draw">
          <span>Draw</span>
        </li>
        <li class="loss" title="Loss">
          <span>Loss</span>
        </li>
        <li class="draw" title="Draw">
          <span>Draw</span>
        </li>
        <li class="loss" title="Loss">
          <span>Loss</span>
        </li>
        <li class="draw" title="Draw">
          <span>Draw</span>
        </li>
        <li class="draw" title="Draw">
          <span>Draw</span>
        </li>
        <li class="loss" title="Loss">
          <span>Loss</span>
        </li>
        <li class="loss last" title="Loss">
          <span>Loss</span>
        </li>
      </ol>
    </td>
    <td class="status">
      <a class="report" href="http://www.bbc.co.uk/sport/0/football/17973120">Report</a>
    </td>
  </tr>
  <tr id="team-137318151" class="team">
    <td class="statistics"></td>
    <td class='position'>
      <span class='moving-down'>Moving down</span>
      <span class='position-number'>7</span>
    </td>
    <td class="team-name">
      <a href='http://www.bbc.co.uk/sport/football/teams/manchester-city'>Man City</a>
    </td>
    <td class="played">0</td>

    <td class="home-won">
      <span>0</span>
    </td>
    <td class="home-drawn">0</td>
    <td class="home-lost">0</td>
    <td class="home-for">0</td>
    <td class="home-against">0</td>
    <td class="away-won">
      <span>0</span>
    </td>
    <td class="away-drawn">0</td>
    <td class="away-lost">0</td>
    <td class="away-for">0</td>
    <td class="away-against">0</td>
    <td class="goal-difference">0</td>
    <td class="points">0</td>
    <td class="last-10-games">
      <ol>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="loss" title="Loss">
          <span>Loss</span>
        </li>
        <li class="draw" title="Draw">
          <span>Draw</span>
        </li>
        <li class="draw" title="Draw">
          <span>Draw</span>
        </li>
        <li class="win last" title="Win">
          <span>Win</span>
        </li>
      </ol>
    </td>
    <td class="status">
      <a class="report" href="http://www.bbc.co.uk/sport/0/football/17973148">Report</a>
    </td>
  </tr>
  <tr id="team-137318152" class="team">
    <td class="statistics"></td>
    <td class='position'>
      <span class='moving-down'>Moving down</span>
      <span class='position-number'>8</span>
    </td>
    <td class="team-name">
      <a href='http://www.bbc.co.uk/sport/football/teams/manchester-united'>Man Utd</a>
    </td>
    <td class="played">0</td>

    <td class="home-won">
      <span>0</span>
    </td>
    <td class="home-drawn">0</td>
    <td class="home-lost">0</td>
    <td class="home-for">0</td>
    <td class="home-against">0</td>
    <td class="away-won">
      <span>0</span>
    </td>
    <td class="away-drawn">0</td>
    <td class="away-lost">0</td>
    <td class="away-for">0</td>
    <td class="away-against">0</td>
    <td class="goal-difference">0</td>
    <td class="points">0</td>
    <td class="last-10-games">
      <ol>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="loss" title="Loss">
          <span>Loss</span>
        </li>
        <li class="draw" title="Draw">
          <span>Draw</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="loss" title="Loss">
          <span>Loss</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="win" title="Win">
          <span>Win</span>
        </li>
        <li class="win last" title="Win">
          <span>Win</span>
        </li>
      </ol>
    </td>
    <td class="status">
      <a class="report" href="http://www.bbc.co.uk/sport/0/football/17973162">Report</a>
    </td>
  </tr>
</tbody> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T14:26:49.387

问题是，你的正则表达式太宽泛了。看看你要的是什么：

```
<tr\b[^>]*>(.*?)manc(.*?)</tr> 
```

让我们稍微简化一下。

```
<tr>.*?manc.*?</tr> 
```

所以你说，好吧。我需要匹配一个 tr，然后是*任何东西*，然后是 manc，然后是 ANYTHING，然后是结束 tr。所以。当然会发生的是正则表达式从第一个 tr 开始并且正常。我有一个 tr 让我继续匹配，直到找到 manc。与此同时，你可能刚刚通过了一堆*其他*的tr。但是你的正则表达式不在乎。

尝试这个：

```
<tr>(?:(?!</tr>).)*manc.+?</tr> 
```

或者，我猜在你的例子中：

```
<tr\b[^>]*>(?:(?!</tr>).)*manc.+?</tr> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T14:02:16.867

REGEX 不适合这种情况，因为它不是为解析器而设计的。除非情况非常宽容，特别是在 JavaScript（它具有相当原始的 REGEX 实现）中，它无法确定哪些开始标签与哪些结束标签匹配。

首先，我们需要使用`[\s\S]`而不是`.`因为后者不能多行工作，因为它不匹配空白字符，并且您提到的表格的 HTML 是多行的。前者会，因为它是一个匹配所有空间和非空间的范围 - 即所有东西。

考虑到这一点，您可能很想这样做：

```
/<tr\b[^>]*?>[\s\S]*?manc[\s\S]*?<\/tr>/gi 
```

...即获取所有提到字符串“manc”的行。

采用以下简化的 HTML：

```
<table>
    <tr>
        <td>Notts County</td>
    </tr>
    <tr>
        <td>Manchester United</td>
    </tr>
    <tr>
        <td>Arsenal</td>
    </tr>
</table> 
```

...上述模式将匹配

```
<tr>
    <td>Notts County</td>
</tr>
<tr>
    <td>Manchester United</td>
</tr> 
```

这是合乎逻辑的。REGEX 模式从开头开始，找到开头`tr`（诺茨县），并询问在不确定数量的可选字符之后是否找到字符串“Manc”。这是。

当然，问题在于，在找到“Manc”时，它不知不觉地越过了`tr`边界进入下一行，因为我们的`[\s\S]*?`模式允许它这样做。

我们无法阻止这种情况，因为 REGEX 不允许您否定序列 - 仅允许范围内的字符（除了否定的前瞻和后瞻断言的情况）。

简而言之，无论如何都要学习 REGEX，但你选择了一个很难开始的字符串:)

# asp.net - ASP.NET MVC：ActionMethodSelector / ActionFilter（属性）命名约定

> ID：11294745
> 
> 赞同：2
> 
> 时间：2012-07-02T13:31:57.517
> 
> 标签：asp.net, asp.net-mvc, actionfilterattribute

您认为 ActionMethodSelector 与 ActionFilter（属性）区分开来的最佳命名约定是什么。

我需要一个与 AuthorizeAttribute-ActionFilter 功能相同的 ActionMethodSelector，但您将如何命名该 ActionMethodSelectorAttribue？（实施不是问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T03:37:47.543

如有疑问，请遵循框架约定，如果您查看它们的一些实现，您会发现在这两种情况下它们都只是使用`Attribute`后缀。

```
AcceptVerbsAttribute : ActionMethodSelectorAttribute 
```

等等

和

```
OutputCacheAttribute : ActionFilterAttribute 
```

等等

如果您以这种方式使用框架属性没有问题，我认为您没有理由为自己的代码做任何不同的事情。

除非你当然想要：D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:37:22.943

> 您认为 ActionMethodSelector 与 ActionFilter（属性）区分开来的最佳命名约定是什么。

后缀：

*   XXXActionMethodSelector
*   XXXAttribute 或 XXXActionFilterAttribute

其中 XXX 显然是那些类应该完成的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:47:36.967

```
XXXXSelectionAttribute 
```

VS

```
XXXXFilterAttribute 
```

真的没关系，只要你和你的实现一致，前缀或后缀为其意图添加了清晰的画面。

恕我直言。

# php - 我可以对 Symfony + Doctrine 进行哪些性能改进？

> ID：11294747
> 
> 赞同：2
> 
> 时间：2012-07-02T13:31:59.760
> 
> 标签：php, mysql, orm, symfony1, cpu-speed

我最近为一所处理近 200 个表的大学构建了一个相当复杂的数据库应用程序。一些表（例如 Publications）可以保存 30 个或更多字段并存储 10 个一对一的外键关系和最多 2 或 3 个多对多的外键关系（使用交叉引用引用表）。我自始至终都使用整数 ID，规范化一直是每一步的关键。AJAX 是最小的，大多数页面都是标准的 CRUD 表单/流程。

我使用了 Symfony 1.4、Doctrine ORM 1.2、MySQL、PHP。

虽然开发时间和易于维护的好处是巨大的（在使用 MVC 和 ORM 时），但我们一直遇到速度问题。也就是说，当我们有多个用户在任何时候登录并处于活动状态时，应用程序会显着变慢（保存或编辑记录最多需要 20 秒）。

我们目前正在与我们的系统管理员进行讨论，但他们说我们应该拥有足够的权力。当有 6 个或更多用户参与活动时，我们最终会在虚拟服务器环境中排队 4 个 CPU，而内存使用率很低（没有出血）。

当然，我们正在考虑对我们的 mySQL 应用程序进行多线程处理（如果这会有所帮助），优化我们的代码（尽管其中大部分是由 MVC 生成的）并优化我们的缓存使用（这可能会更好，尽管大多数使用的屏幕是用户登录特定和动态的）；我们已经安装了 APC，额外的内存，对我们的数据库进行了碎片整理，我已经尝试取消设置所有记录集（虽然我知道这现在在 ORM 中是自动的），发起手动垃圾回收......

但我要问的问题是 mySQL、PHP 和 Symfony MVC 对于开发这种规模的应用程序来说是否真的是一个糟糕的选择？如果是这样，对于这种规模/复杂性的基于 Web 的数据库界面应用程序，人们通常使用/推荐什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T14:46:24.473

我对 Symfony 或 Doctrine 没有任何经验。但是，肯定有比您更大的网站是建立在这些项目上的。例如，DailyMotion 两者都使用，它服务的远不止几个同时的用户。

同样，PHP 和 MySQL 也用于 Wikipedia 等大型网站，因此可扩展性应该不是问题。（顺便说一句，默认情况下 MySQL 应该是多线程的——每个连接一个线程。）

当然，合理的表现是相对的。如果您尝试在壁橱中的米色盒子上运行一个处理 200 个并发请求的站点，那么您可能需要优化您的代码，而不是拥有自己的数据中心的财富 500 强公司。

显而易见的事情是实际分析您的应用程序并查看瓶颈在哪里。分析 MySQL 查询非常简单，还有各种[PHP 分析工具](https://stackoverflow.com/questions/55720/find-out-where-your-php-code-is-slowing-down-performance-issue)，如[Xdebug](http://www.xdebug.org/docs/profiler)。从那里您可以确定是否应该切换框架、ORM（或完全放弃 ORM）、数据库或重构一些代码，或者只是投资更多的处理能力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T07:07:13.500

加速复杂数据库操作的最好方法是不调用它们:)。

因此，请分析您可以缓存应用程序的哪些部分。
Symfony 有一个非常好的缓存系统（在 symfony2 中甚至更好），可以非常精细地使用。

在数据库方面，另一种方法是使用视图或嵌套集来存储聚合数据。
尝试找到合适的部分。

# java - 通过 Android Intent 传递变量时出现 NumberFormatException

> ID：11294751
> 
> 赞同：0
> 
> 时间：2012-07-02T13:32:16.953
> 
> 标签：java, android

我试图通过几个 Android 活动传递 2 个变量。其中一个在最后一页上一直显示为空：

第一个活动：

```
Intent intent= new Intent(RoundOptionActivity.this, MoveOptionActivity.class);
intent.putExtra("numRounds", "5");
startActivity(intent); 
```

第二个活动：

```
Bundle extras = getIntent().getExtras(); 
if(extras !=null) {
    numRounds = Integer.parseInt(extras.getString("numRounds"));
}

.........

Intent intent = new Intent(MoveOptionActivity.this, MoveActivity.class);
intent.putExtra("numRounds", numRounds);
intent.putExtra("playerChoice", playerChoice);
startActivity(intent); 
```

（请注意，此时我在 LogCat 中打印了 numRounds 并将其设置为正确的数字，而不是 null）

第三个活动：

```
Bundle extras = getIntent().getExtras(); 
if(extras !=null) {
    playerChoice = Integer.parseInt(extras.getString("playerChoice"));
    numRounds = Integer.parseInt(extras.getString("numRounds"));
} 
```

此时，应用程序在我尝试将 numRounds 解析为整数的行崩溃，并出现 NumberFormatException 抱怨它无法解析空值。playerChoice 从来没有问题，只有 numRounds。我尝试以与 playerChoice 完全相同的方式处理 numRounds，但似乎没有任何效果。这是怎么回事？丁：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:40:19.367

你必须使用`extras.getInt("numRounds");`

因为在第二个`Activity`你添加到`putExtra` **int**值：

```
numRounds = Integer.parseInt(extras.getString("numRounds")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T13:36:51.170

采用

```
numRounds = extras.getInt("numRounds"); 
```

而不是

```
numRounds = Integer.parseInt(extras.getString("numRounds")); 
```

因为您从第二个 Activity将**numRounds**作为 Integer传递`intent.putExtra("numRounds", numRounds);`

或传递，就好像你想作为字符串接收：

```
Intent intent = new Intent(MoveOptionActivity.this, MoveActivity.class);
intent.putExtra("numRounds", numRounds+"");
intent.putExtra("playerChoice", playerChoice);
startActivity(intent); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T13:38:02.693

据我认为，在您的第二个活动中，您在 putExtra() 中设置 numRounds 一个整数值，即整数变量 numRounds 这就是它导致问题的原因。要么直接在第三个活动中获取 numRounds，要么在第二个活动中将`extras.getInt("numRounds")`值作为字符串发送，即`intent.putExtra("numRounds", numRounds+"");`

# php - 如何用更多的href地址做一个链接属性？

> ID：11294753
> 
> 赞同：0
> 
> 时间：2012-07-02T13:32:22.717
> 
> 标签：php, javascript, jquery, html

代码：

`<a href='http://$websites' target='_blank'>$websites</a>`;

$websites 是一个**字符串**；

html 上的代码看起来：

`<a target="_blank" href="http://WWW.GOOGLE.COM WWW.FACEBOOK.COM ">WWW.GOOGLE.COM WWW.FACEBOOK.COM </a>`

**我希望**这是两个链接，我该怎么做？$websites 来自文本区域；当它只有一个链接时没关系，但如果我有两个链接，每行一个，那么我不知道该怎么做。请帮忙

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-02T13:36:09.150

```
<?php
$websites = explode(' ', $websites);
foreach($websites as $site){
    echo '<a href="http://'.$site.'" target="_blank">'.$site.'</a>';
}
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T13:36:14.550

尝试：

```
$website= explode(" ", $websites);
for($i = 0; $i < count($website); $i++){
   echo "<a href='http://".$website[$i]."' target='_blank'>".$website[$i]."</a>";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:35:22.837

好吧，这可能是一个替代解决方案

与其中一个有 2 个链接`display:none`

当您单击其中一个时，单击另一个`$('.hidden_link').click();`

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-02T13:37:01.947

试试这个：

```
$linkArray = explode("\n", $websites);

foreach($linkArray as $link) {
    echo('<a href="http://'.$link.'" target="_blank">'.$link.'</a>');
} 
```

# django - Django PostgreSQL DatabaseError：关系“类别”不存在

> ID：11294756
> 
> 赞同：4
> 
> 时间：2012-07-02T13:32:28.593
> 
> 标签：django

我正在开发一个 Django 应用程序。最初我使用 MySQL 作为数据库。然后，我需要在使用 PostgreSQL 的 heroku 上部署一个演示应用程序。

当我尝试创建一个对象时，我在 heroku 中遇到错误，即使是从 shell 也是如此。

这就是我想要做的：

```
>> from store.models import Product, Category
>> cat = Category()
>> cat.name = 'books'
>> cat.description = 'books'
>> cat.slug = 'books'
>> cat.save() 
```

我收到以下错误：

```
......
DatabaseError: relation "categories" does not exist 
```

这是我的类别和产品模型

```
class Category(models.Model):
  name = models.CharField(max_length=50)
  description = models.TextField()
  slug = models.SlugField(max_length=50, unique=True)
  created_at = models.DateTimeField(auto_now_add=True)
  updated_at = models.DateTimeField(auto_now=True)

class Product(models.Model):
  name = models.CharField(max_length=100, unique=True)
  description = models.TextField()
  price = models.DecimalField(max_digits=9, decimal_places=2)
  slug = models.SlugField(max_length=50, unique=True)
  categories = models.ManyToManyField(Category)
  created_at = models.DateTimeField(auto_now_add=True)
  updated_at = models.DateTimeField(auto_now=True) 
```

它适用于 MySQL，但不适用于 PostgreSQL。

任何人都可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T08:16:38.837

您还需要在 heroku 中运行 syncdb，以便它安装您的应用程序和模型。

```
heroku run python manage.py syncdb 
```

如果您对架构进行了更改并且您使用的是南，那么：

```
heroku run python manage.py schemamigration appname --auto 
```

# sql-server - SQL Server 全文搜索包含标点符号的短语，例如 IP 地址？

> ID：11294759
> 
> 赞同：4
> 
> 时间：2012-07-02T13:32:51.040
> 
> 标签：sql-server, sql-server-2008, full-text-search

我正在使用 SQL Server 全文搜索可能包含 IP 地址的大型 varchar/varbinary 列中的文本。我知道地址中的点不在索引中，但我认为这样的短语搜索会起作用：

select * from myFTETable where contains(myFTEcolumn, "192 168 100 101")

它没有。我究竟做错了什么？有没有办法搜索 IP 地址，或者更一般地说，当原始数据中的短语包含标点符号时，有没有办法进行短语搜索？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-10T20:55:01.923

没错，[LIKE 运算符没有利用全文索引](http://msdn.microsoft.com/en-us/library/ms142571.aspx#like)，从而导致随着数据库的增长而导致查询运行时间较长。

您是否尝试过查询内部索引表以查看正在索引的数字？这可以通过运行来完成 -

```
SELECT * FROM sys.dm_fts_index_keywords(db_id('{database}'), object_id('{table}')) 
```

在全文索引表中插入 192.168.100.101 在内部显示为 8 个不同的条目（4 个数字，4 个字符）并运行 CONTAINS('"192 168 100 101"') 会显示相关行。

需要注意的是，全文将删除一些较低的数字作为其停止列表机制的一部分。这可以通过在索引创建期间指定 STOPLIST OFF 或从内部停止列表中删除匹配的字符串来覆盖。

# php - 使用 strip_tags 时 PHP 截断字符串

> ID：11294763
> 
> 赞同：0
> 
> 时间：2012-07-02T13:32:56.063
> 
> 标签：php, escaping, pyrocms, strip-tags

我将其存储在我的 MySQL InnoDB UTF8 数据库中：

> `<p>`这架“婴儿”三角钢琴的长度为 5'1"（155 厘米），于 1930 年代推出，具有更大钢琴的强劲和丰富的音色。小到可以很好地适应几乎任何房间，这架钢琴是用手工制作的与制作我们的音乐会三角钢琴相同的材料和技术。`</p>`

当我回显 strip_tags($string) 时，PHP 会返回：

`Introduced 5\'1\`

就是这样。[我在这里](https://bugs.php.net/bug.php?id=45599)发现了一个类似的报告错误（影响有斜杠，而不是单/双引号），但它已解决。我正在使用 PHP 5.3.6。

知道如何在不需要使用的情况下解决这个问题`preg_replace`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:38:21.607

这是在输入里面吗？因为报价会结束它。

尝试 htmlentities(strip_tags($string));

```
<input type="text" value="Introduced 5\'1\" (155......" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:41:10.150

尝试以下操作：

```
<?php

$pattern = '/<.*?>/';
$string  = '<p>At 5\'1" (155cm) in length, this "Baby" grand piano was introduced in the 1930\'s and features the powerful and rich tone of a much larger piano. Small enough to fit nicely into almost any room, this piano is handcrafted using the same materials and techniques that go into making our concert grand pianos.</p>';
echo preg_replace($pattern, '', $string);

?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T21:47:35.490

这是 PyroCMS 使用的 Lex 解析器的问题。可以在此处找到修复程序：

[https://github.com/happyninjas/lex/commit/ff9aa30554fce47a8bfb6dc7c94143afc2fd8f93](https://github.com/happyninjas/lex/commit/ff9aa30554fce47a8bfb6dc7c94143afc2fd8f93)

我还提交了对 PyroCMS 的更改。希望它在下一个版本中实现。

# windows-8 - 在 Metro 风格应用程序中使用“Windows”一词作为您自己的命名空间的一部分

> ID：11294764
> 
> 赞同：2
> 
> 时间：2012-07-02T13:32:59.887
> 
> 标签：windows-8, windows-runtime

如果您尝试在 Metro 风格的应用程序（例如 MyCompany.Windows）中将 Windows 用作您自己的命名空间的一部分，它似乎会关闭编译器，因为它们开始在您的命名空间而不是 Windows.* 下寻找 WinRT 内容。

例如，如果您创建一个名为 App1 的空白 Windows Metro 风格应用程序并将 App1 命名空间重命名为 App1.Windows 并尝试编译它，您将收到错误消息：

命名空间“App1.Windows”中不存在类型或命名空间名称“UI”（您是否缺少程序集引用？） F:\temp\App1\App1\obj\Debug\App.gics

生成文件的顶部如下所示：

```
namespace App1.Windows
{
#if !DISABLE_XAML_GENERATED_MAIN
    public static class Program
    {
        [System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.Windows.UI.Xaml.Build.Tasks"," 4.0.0.0")]
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        static void Main(string[] args)
        {
            Application.Start((p) => new App());
        }
    }
#endif

    partial class App : Windows.UI.Xaml.Application 
```

问题是编译器开始在 App1.Windows 下寻找 Windows.UI。

现在这已经不是什么新鲜事了，如果您将命名空间命名为 App1.System，那么您可能会在某些时候遇到类似的麻烦。问题是那里有相当多的 WPF/Silverlight/Windows Phone 代码使用 MyCompany.Windows.Xyz 命名空间，并且可能容易受到这种麻烦的影响。

Microsoft 是否有一些关于如何处理这些命名空间的指导（似乎找不到）？或者也许有一些计划在未来的版本中解决这个问题？还是我只是错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:08:39.423

我查看了这个问题，我们应该在生成的代码中使用 global::。我们已经解决了这个问题，并将在 Visual Studio 的下一版本中提供。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T21:27:07.750

这是 C# 语言规范中的已知行为。基本上，只要命名空间出现在“using”子句中，系统就会将命名空间中的所有元素视为可能是 using 命名空间的一部分。有两种解决方法：从类型的内部节点中删除名称“Windows”或删除“使用”指令。

不幸的是，这不是 winrt 问题，您可以使用纯 CLR 应用程序发生同样的事情。

# java - 爬取网站内容的建议

> ID：11294765
> 
> 赞同：1
> 
> 时间：2012-07-02T13:33:05.160
> 
> 标签：java, web, web-crawler, web-scraping, jsoup

我试图爬取一些网站内容，使用[jsoup](http://jsoup.org/)和 java 组合。将相关详细信息保存到我的数据库并每天进行相同的活动。

但这是交易，当我在浏览器中打开网站时，我得到呈现的 html（所有元素标签都在那里）。我测试它的javascript部分，它工作得很好（我应该用来提取正确数据的那个）。

但是当我使用 jsoup（来自 Java 类）进行解析/获取时，只会下载初始网站进行解析。这意味着网站有一些动态部分，我想获取这些数据，但由于它们是在获取后呈现的，因此在网站上异步呈现，我无法使用 jsoup 捕获它。

有人知道解决这个问题的方法吗？我是否使用了正确的工具集？更有经验的人，我出你的意见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T15:06:58.917

您需要先检查您要抓取的网站是否需要此列表中的某些内容才能显示所有内容：

*   使用登录名/密码进行身份验证
*   HTTP标头上的某种会话验证
*   饼干
*   加载所有内容的某种时间延迟（大量使用 Javascript 库、CSS 和异步数据的站点可能需要这样做）。
*   特定的用户代理浏览器
*   例如，如果您在公司网络安全配置中，则为代理密码。

如果需要此列表中的任何内容，您可以在 jsoup.connect() 中提供参数来管理该数据。请参考官方文档。

[http://jsoup.org/cookbook/input/load-document-from-url](http://jsoup.org/cookbook/input/load-document-from-url)

# c# - 增量整数的三元运算符

> ID：11294768
> 
> 赞同：2
> 
> 时间：2012-07-02T13:33:12.243
> 
> 标签：c#, ternary-operator

有人可以告诉我为什么下面的代码不起作用吗？

```
 int prePos = 0;
    int preNeg = 0;

    int postPos = 0;
    int postNeg = 0;

    for (int i = 0; i < pin1.GetLength(0); i++)
    {
        preNeg++ ? pin1[i, 0] < 0 : prePos++; //not working
        pin2[i, 0] < 0 ? postNeg++ : postPos++; //not working
    } 
```

所以条件是如果`pin1[i, 0]`小于零，则`preNeg`加一。否则`prePos`应该被取消。如果其他情况，我可以正常执行此操作，但为什么这个三元组不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T13:47:48.260

三元运算符是一个计算结果为表达式（指示值的东西）的*运算符*，因此不能再用作语句，就像表达式 using`+`可以用作语句一样（作为语句`1+1;`是非法的）。

使三元运算符的这种特殊用法有所不同的原因在于使用增量 ( `++`) 运算符。使用`++`运算符对变量执行操作（将其递增 1）并输出一个值（将变量`++`放在变量之后时递增之前的变量值）。

因此，以下内容将实现您想要做的事情，但是您将留下一个未使用的变量（更不用说不清楚的代码），所以我看不到它在实践中的使用。

```
var currentValue = pin1[i, 0] < 0 ? postNeg++ : postPos++; 
```

正如已经提到的，您最好的选择是使用正常的`if`/ `else`。这就是它的用途。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T13:36:59.343

```
 preNeg++ ? pin1[i, 0] < 0 : prePos++; //not working
    pin2[i, 0] < 0 ? postNeg++ : postPos++; //not working 
```

因为三元运算符返回一个赋值给变量或属性的值；

像

```
int a = true ? 1 : 0; 
```

a 将有 1

三元运算符的语法是

```
var variable = condition ? 
              value_to_return_in_variable_if_condition_true :  
              value_to_return_in_variable_if_condition_false; 
```

此外，三元运算符用于为单个变量赋值。不是两个变量。

# iphone - AFNetworking - 如何发出 POST 请求

> ID：11294769
> 
> 赞同：18
> 
> 时间：2012-07-02T13:33:14.960
> 
> 标签：iphone, objective-c, ios, json, afnetworking

**编辑 07/14**

*正如比尔伯吉斯在评论他的回答中提到的那样，这个问题`version 1.3`与`AFNetworking`. 对于这里的新人来说，它可能已经过时了。*

* * *

我对 iPhone 开发很陌生，我使用 AFNetworking 作为我的服务库。

我正在查询的 API 是一个 RESTful API，我需要发出 POST 请求。为此，我尝试使用以下代码：

```
NSDictionary *parameters = [NSDictionary dictionaryWithObjectsAndKeys:@"my_username", @"username", @"my_password", @"password", nil];
NSURL *url = [NSURL URLWithString:@"http://localhost:8080/login"];

NSURLRequest *request = [NSURLRequest requestWithURL:url];
AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
    NSLog(@"Pass Response = %@", JSON);
} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
    NSLog(@"Failed Response : %@", JSON);
}];
[operation start]; 
```

这段代码有两个主要问题：

*   `AFJSONRequestOperation`似乎提出了一个`GET`要求，而不是`POST`一个。
*   我不能给这个方法加上参数。

我也试过这段代码：

```
NSDictionary *parameters = [NSDictionary dictionaryWithObjectsAndKeys:@"my_username", @"username", @"my_password", @"password", nil];
NSURL *url = [NSURL URLWithString:@"http://localhost:8080"];
AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:url];

[httpClient postPath:@"/login" parameters:parameters success:^(AFHTTPRequestOperation *operation, id responseObject) {
    NSLog(@"Succes : %@", responseObject);
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    NSLog(@"Failure : %@", error);
}]; 
```

有没有更好的方法可以让我在这里完成它？

谢谢您的帮助 ！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-02T13:49:45.397

您可以覆盖您的请求的默认行为，以`AFNetworking`将其作为 POST 进行处理。

```
NSURLRequest *request = [client requestWithMethod:@"POST" path:path parameters:nil]; 
```

这假设您已覆盖默认`AFNetworking`设置以使用自定义客户端。如果你不是，我建议你这样做。只需创建一个自定义类来为您处理网络客户端。

**MyAPIClient.h**

```
#import <Foundation/Foundation.h>
#import "AFHTTPClient.h"

@interface MyAPIClient : AFHTTPClient

+(MyAPIClient *)sharedClient;

@end 
```

**我的APIClient.m**

```
@implementation MyAPIClient

+(MyAPIClient *)sharedClient {
    static MyAPIClient *_sharedClient = nil;
    static dispatch_once_t oncePredicate;
    dispatch_once(&oncePredicate, ^{
        _sharedClient = [[self alloc] initWithBaseURL:[NSURL URLWithString:webAddress]];
    });
    return _sharedClient;
}

-(id)initWithBaseURL:(NSURL *)url {
    self = [super initWithBaseURL:url];
    if (!self) {
        return nil;
    }
    [self registerHTTPOperationClass:[AFJSONRequestOperation class]];
    [self setDefaultHeader:@"Accept" value:@"application/json"];
    self.parameterEncoding = AFJSONParameterEncoding;

    return self;

} 
```

然后，您应该能够毫无问题地在操作队列上触发您的网络调用。

```
 MyAPIClient *client = [MyAPIClient sharedClient];
    [[AFNetworkActivityIndicatorManager sharedManager] setEnabled:YES];
    [[AFNetworkActivityIndicatorManager sharedManager] incrementActivityCount];

    NSString *path = [NSString stringWithFormat:@"myapipath/?value=%@", value];
    NSURLRequest *request = [client requestWithMethod:@"POST" path:path parameters:nil];

    AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
        // code for successful return goes here
        [[AFNetworkActivityIndicatorManager sharedManager] decrementActivityCount];

        // do something with return data
    }failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
        // code for failed request goes here
        [[AFNetworkActivityIndicatorManager sharedManager] decrementActivityCount];

        // do something on failure
    }];

    [operation start]; 
```

# javascript - 对话框控件内的选项卡控件

> ID：11294773
> 
> 赞同：0
> 
> 时间：2012-07-02T13:33:29.233
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins, jquery-tabs

我试图在对话框小部件中粘贴一个选项卡 jQuery UI 小部件，但它对我不起作用。我有一堆数据正在从数据库中检索并呈现在屏幕上。当用户单击 (+) 按钮时，应打开一个对话框，其中的内容为选项卡。由于某种原因，这不起作用。这是我的代码：

HTML结构如下：

```
<div id="tabs-{index}">
<ul>
<li><a href="#some-id-{index}">title1</a></li>
<li><a href="#another-id-{index}">title2</a></li>
</ul>

<div id="some-id-{index}>content</div>
<div id="another-id-{index}">content</div>
</div> 
```

这是我的 jQuery 代码：

```
 $('#disease-read-more-dialog').dialog({
        dialogClass: 'disease-read-more',
        autoOpen: false,
        modal: false,
        draggable: false,
        width: '500px',
        open: function () {
            $('#ui-dialog-title-disease-read-more-dialog').html($('#disease-read-more-dialog').attr('title'));
            var content = $('#disease-read-more-dialog').find('.hidden-disease-info').first();
            if (content.length > 0) {
                var index = content.data('index');
                var selector = '#read-more-tabs-' + index;
                $(selector).tabs();
            }
        }
    }); 
```

请注意，仅使用索引是因为我在页面加载时在屏幕上输出了所有数据而不是执行 AJAX 请求（因为数据量相对较小），然后当用户单击（+）时我加载将 HTML 内容添加到对话框中。因此，索引用于防止弄乱标签 ID。

**更新：**

它不起作用，因为调用`$(selector).tabs()`不做它应该做的事情。所以实际呈现的是无序列表而不是选项卡控件。

任何想法为什么这不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T11:41:35.590

使用 jQuery UI 在对话小部件中显示选项卡小部件的完整解决方案如下：

HTML：

```
 <div id="dialgue" title="Tabs with Dialogue">
    <div id="tabs">
      <ul>
        <li>
        <a href="#tabs-1">
          Tab-1
        </a>
      </li>
      <li>
        <a href="#tabs-2">
          Tab-2
        </a>
      </li>
      <li>
        <a href="#tabs-3">
          Tab-3
        </a>
      </li>
    </ul>
    <div id="tabs-1">
      <p>
        Contents of Tab-1 has been displayed here...!
      </p>
    </div>
    <div id="tabs-2">
      <p>
        Contents of Tab-2 has been displayed here...!
      </p>
    </div>
    <div id="tabs-3">
      <p>
        Contents of Tab-3 has been displayed here...!
      </p>
    </div>
     </div>
   </div>
<input type="button" id="btndialogue" value="Show Dialogue with Tabs" /> 
```

CSS：

```
.ui-widget{
  font-size:14px !important;
}
.ui-dialog-title{
  font-weight:bold;
}
.ui-tabs .ui-tabs-nav{
  font-size:13px;
}
.ui-tabs-panel{
  font-size:12px;
} 
```

查询：

```
$(function() {
    $("#dialgue").dialog({
        autoOpen: false,
        modal: false,
        draggable: false,
        title: 'Tabs with Dialogue',
        show: 'slide',
        hide: 'slide',
        width: '500',
        open: function(event, ui) {
            $("#tabs").tabs();
        }
    });
    $("#btndialogue").click(function() {
        $("#dialgue").dialog('open');
    });
}); 
```

注意：在测试/运行上述脚本之前，需要包含最新的 jquery.js、jquery-ui.js 和 jquery-ui.css 文件。

我用[http://codebins.com/codes/home/4ldqpbx上的解决方案创建了一个 bin](http://codebins.com/codes/home/4ldqpbx)

# jquery - JQgrid 编辑表单重新加载

> ID：11294783
> 
> 赞同：2
> 
> 时间：2012-07-02T13:33:53.040
> 
> 标签：jquery, jqgrid

有没有办法刷新编辑表单对话框以在动态生成的网格上应用更新的选项？基本上，当下拉列表值发生更改时，我需要更改一些属性，然后对话框会反映这些更改。例如，我更新了属性 editable 以隐藏一个字段。

```
container.jqGrid('setColProp', fieldName, { editable: false}); 
```

有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:38:13.870

您可以在加载网格时发送的回发中设置列数据。使用 url 属性设置 url：

```
url: $("#BlendGrades").jqGrid({
    url: '/Storage/GreenStorage/SetSectionList?q=2&location.Id=' + '<%:Model.Location.Id%>',
    datatype: "json", ..... 
```

# php - PHP电子邮件脚本不发送

> ID：11294784
> 
> 赞同：0
> 
> 时间：2012-07-02T13:33:54.550
> 
> 标签：php, forms, email

`http://www.dorsetdesigns.co.uk/contact.html`

试试它不会向我发送电子邮件的表格。我正在使用与域关联的邮件帐户

```
<?php

// Clean up the input values
foreach($_POST as $key => $value) {
if(ini_get('magic_quotes_gpc'))
$_POST[$key] = stripslashes($_POST[$key]);

$_POST[$key] = htmlspecialchars(strip_tags($_POST[$key]));
}

// Assign the input values to variables for easy reference
$name = $_POST["name"];
$email = $_POST["email"];
$message = $_POST["message"];

// Test input values for errors
$errors = array();
if(strlen($name) < 2) {
if(!$name) {
$errors[] = "You must enter a name.";
} else {
$errors[] = "Name must be at least 2 characters.";
}
}
if(!$email) {
$errors[] = "You must enter an email.";
} else if(!validEmail($email)) {
$errors[] = "You must enter a valid email.";
}
if(strlen($message) < 10) {
if(!$message) {
$errors[] = "You must enter a message.";
} else {
$errors[] = "Message must be at least 10 characters.";
}
}

if($errors) {
// Output errors and die with a failure message
$errortext = "";
foreach($errors as $error) {
$errortext .= "<li>".$error."</li>";
}
die("<span class='failure'>The following errors occured:<ul>". $errortext ."</ul>
</span>");
}

// Send the email
$to = "contact@dorsetdesigns.co.uk";
$subject = "Contact Form: $name";
$message = "$message";
$headers = "From: $email";

mail($to, $subject, $message, $headers);

// Die with a success message
die("<span class='success'>Success! Your message has been sent.</span>");

// A function that checks to see if
// an email is valid
function validEmail($email)
{
$isValid = true;
$atIndex = strrpos($email, "@");
if (is_bool($atIndex) && !$atIndex)
{
  $isValid = false;
}
else
{
  $domain = substr($email, $atIndex+1);
  $local = substr($email, 0, $atIndex);
  $localLen = strlen($local);
  $domainLen = strlen($domain);
  if ($localLen < 1 || $localLen > 64)
  {
     // local part length exceeded
     $isValid = false;
  }
  else if ($domainLen < 1 || $domainLen > 255)
  {
     // domain part length exceeded
     $isValid = false;
  }
  else if ($local[0] == '.' || $local[$localLen-1] == '.')
  {
     // local part starts or ends with '.'
     $isValid = false;
  }
  else if (preg_match('/\\.\\./', $local))
  {
     // local part has two consecutive dots
     $isValid = false;
  }
  else if (!preg_match('/^[A-Za-z0-9\\-\\.]+$/', $domain))
  {
     // character not valid in domain part
     $isValid = false;
  }
  else if (preg_match('/\\.\\./', $domain))
  {
     // domain part has two consecutive dots
     $isValid = false;
  }
  else if(!preg_match('/^(\\\\.|[A-Za-z0-9!#%&`_=\\/$\'*+?^{}|~.-])+$/',
             str_replace("\\\\","",$local)))
  {
     // character not valid in local part unless
     // local part is quoted
     if (!preg_match('/^"(\\\\"|[^"])+"$/',
         str_replace("\\\\","",$local)))
     {
        $isValid = false;
     }
  }
  if ($isValid && !(checkdnsrr($domain,"MX") || checkdnsrr($domain,"A")))
  {
     // domain not found in DNS
     $isValid = false;
  }
  }
  return $isValid;
  }

  ?> 
```

此代码提交表单，下面的代码是表单，之所以有这么多代码是为了使 php 安全。我认为代码中不应该有任何错误，但这可能是问题所在

```
 <form id="contactform" action="processForm.php" method="post">
    <table>
      <tr>
        <td><label for="name">Name:</label></td>
        <td><input type="text" id="name" name="name" /></td>
      </tr>
      <tr>
        <td><label for="email">Email:</label></td>
        <td><input type="text" id="email" name="email" /></td>
      </tr>
      <tr>
        <td><label for="message">Message:</label></td>
        <td><textarea id="message" name="message" rows="5" cols="20"></textarea></td>
      </tr>
      <tr>
        <td></td>
        <td><input type="submit" value="Send!" id="send" /></td>
      </tr>
    </table>
  </form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:51:57.233

文件似乎`processForm.php`不在它应该在的地方。

单击`send`它时，它会尝试通过调用 url 来提交表单：`http://www.dorsetdesigns.co.uk/processForm.php`

响应是这样的：

```
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>404 Not Found</title>
</head><body>
<h1>Not Found</h1>
<p>The requested URL /processForm.php was not found on this server.</p>
</body></html> 
```

所以检查文件路径，它肯定会工作。

# android - Android：绘制字母圈

> ID：11294786
> 
> 赞同：0
> 
> 时间：2012-07-02T13:33:58.310
> 
> 标签：android

我在 android 中工作，我想画一个字母圈，在此每个字母 A 到 Z 必须显示。这每个字母必须是可点击或可触摸的。

我的观点应如下所示：- ![在此处输入图像描述](../Images/b11ec06ce8507bd35f5fd70feee69f0a.png)

我对此没有任何想法，我应该如何开始？请给我一些建议，以便我可以继续。我应该用什么来做到这一点。

你可以给我一些合适的链接。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:38:34.623

您可能想要使用 Android [Canvas](http://developer.android.com/guide/topics/graphics/2d-graphics.html) API。

这是在 Canvas 上绘制文本的示例：[Android Canvas.drawText](https://stackoverflow.com/questions/2655402/android-canvas-drawtext)。

```
Bitmap b = Bitmap.createBitmap(100, 100, Bitmap.Config.ARGB_8888);
Canvas canvas = new Canvas(b);
Paint paint = new Paint();

paint.setColor(Color.BLACK); 
paint.setTextSize(20); 
canvas.drawText("Some Text", 10, 25, paint); 
```

只需编写一个循环来迭代绘制文本的位置并遍历 az，如下所示：

```
for(char ch='a'; ch<='z'; ch++)
{
    System.out.print(ch);
} 
```

# java - Java + Google Maps API + GWT + 地理编码尝试：在运行时获取此异常 - 编译正常

> ID：11294787
> 
> 赞同：0
> 
> 时间：2012-07-02T13:33:58.480
> 
> 标签：java, google-app-engine, google-maps, gwt, geocoding

我有一个使用谷歌地图的 GWT 应用程序，我试图创建一个使用 Googele 的[地理编码](http://gwt-google-apis.googlecode.com/svn/javadoc/maps/1.1/com/google/gwt/maps/client/geocode/Geocoder.html)器类来获取地址的 LatLng 的方法。

这是我的代码：

```
Geocoder gc = new Geocoder();
    gc.getLatLng(this.testAddress, new LatLngCallback()
    {
        public void onFailure() 
        {
            System.out.println("ERROR: Could not obtain the Coordinates for address" + testAddress);
        }
        public void onSuccess(LatLng point) 
        {
            System.out.println("For Address= "+testAddress +"are Latitude: "+point.getLatitude() + "Longitude: "+ point.getLongitude());
        }

    }); 
```

它编译得很好，但在运行时会抛出这个异常：

```
06:25:09.359 [ERROR] [foodvendor] Unable to load module entry point class cs310.client.Main (see associated exception for details)

com.google.gwt.core.client.JavaScriptException: (TypeError): undefined is not a function
  at     com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:248)
   at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
   at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:561)
   at com.google.gwt.dev.shell.ModuleSpace.invokeNativeObject(ModuleSpace.java:269)
   at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeObject(JavaScriptHost.java:91)
   at com.google.gwt.maps.client.impl.__GeocoderImplImpl.construct(__GeocoderImplImpl.java)
   at com.google.gwt.maps.client.geocode.Geocoder.&lt;init&gt;(Geocoder.java:41)
   at cs310.client.AshTestClass.&lt;init&gt;(AshTestClass.java:25)
   at cs310.client.Main.onModuleLoad(Main.java:37)
   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
   at java.lang.reflect.Method.invoke(Method.java:597)
   at com.google.gwt.dev.shell.ModuleSpace.onLoad(ModuleSpace.java:396)
   at com.google.gwt.dev.shell.OophmSessionHandler.loadModule(OophmSessionHandler.java:200)
   at com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:525)
   at com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:363)
   at java.lang.Thread.run(Thread.java:680) 
```

我不确定这个例外是什么意思，有人可以帮我理解吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:42:26.960

您可能需要先加载 Maps JS API，`Maps.loadMapsApi(...)`然后您的 GWT 代码才能访问地理编码方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T14:56:29.740

如果您使用的是模拟器地理编码器不起作用。这是他们尚未修复的一个相当大的错误，但解决方案是在真实设备上进行测试。希望它应该工作。

# iphone - iPhone：在设备中运行应用程序时将视频上传到 Youtube

> ID：11294789
> 
> 赞同：1
> 
> 时间：2012-07-02T13:34:16.987
> 
> 标签：iphone, objective-c, ios

在我的设备上安装应用程序时出现以下错误。在设备中运行之前，我在模拟器中进行了很好的测试，但在设备中我收到了这个错误：请帮助我如何解决这个............

```
_OBJC_CLASS_$_GDataYouTubeMediaGroup", referenced from:
      objc-class-ref in YoutubeUploader.o
  "_OBJC_CLASS_$_GDataUtilities", referenced from:
      objc-class-ref in YoutubeUploader.o
  "_OBJC_CLASS_$_GDataMediaTitle", referenced from:
      objc-class-ref in YoutubeUploader.o
  "_OBJC_CLASS_$_GDataServiceGoogleYouTube", referenced from:
      objc-class-ref in YoutubeUploader.o
  "_OBJC_CLASS_$_GDataMediaKeywords", referenced from:
      objc-class-ref in YoutubeUploader.o
  "_kGDataServiceDefaultUser", referenced from:
      -[YoutubeUploader uploadVideoFile] in YoutubeUploader.o
  "_kGDataSchemeYouTubeCategory", referenced from:
      -[YoutubeUploader uploadVideoFile] in YoutubeUploader.o
  "_OBJC_CLASS_$_GDataMediaDescription", referenced from:
      objc-class-ref in YoutubeUploader.o
  "_OBJC_CLASS_$_GDataEntryYouTubeUpload", referenced from:
      objc-class-ref in YoutubeUploader.o
  "_OBJC_CLASS_$_GDataMediaCategory", referenced from:
      objc-class-ref in YoutubeUploader.o
ld: symbol(s) not found for architecture armv6
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:46:10.797

您正在使用 GData 库，但尚未链接/添加它。查看[XCode 4 中的 GData Objective-C 客户端设置，](http://hoishing.wordpress.com/2011/08/23/gdata-objective-c-client-setup-in-xcode-4/)了解如何正确构建/链接 GData 库。

# backbone.js - 在主干路由中将 url 作为 hashmaps 传递？

> ID：11294791
> 
> 赞同：0
> 
> 时间：2012-07-02T13:34:29.577
> 
> 标签：backbone.js, backbone-routing

我正在尝试将目录位置和文件路径作为主干路由中哈希图的一部分传递。这是带有哈希图的网址：

```
localhost/index.html#directory-http://localhost/foobar-html/foo.html 
```

这就是我映射上述网址的路线：

```
routes: {
    'directory-*directoryPath-*filePath': 'render'
},

render: function (directoryPath, filePath) {
    // I get the entire url in directoryPath variable
    // http://localhost/foobar-html/foo.html
    // and filePath is empty.
} 
```

映射这种类型的哈希 URL 的正确方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T18:47:13.967

来自[精美手册](http://backbonejs.org/#Router-routes)：

> 路由可以包含参数部分，`:param`匹配斜杠之间的单个 URL 组件；和 splat parts `*splat`，可以匹配任意数量的 URL 组件。

你的问题是一个 splat 吃掉了所有东西，所以在一条路线上有两个 splat 是没有意义的；您不能使用参数部分，`:x`，因为它停在斜线处。

您可以做几件事。

1.  您可以对链接中的斜杠进行 URI 编码并使用参数部分。URL 如下所示：

    ```
    #directory-http:%2f%2flocalhost%2ffoobar-html%2ffoo.html 
    ```

    路由器是这样的：

    ```
    routes: {
        'directory-:directoryPath-:filePath': 'render'
    },
    render: function(d, f) {
        d = decodeURIComponent(d);
        f = decodeURIComponent(f);
        //...
    } 
    ```

    演示：http: [//jsfiddle.net/ambiguous/xBnaN/](http://jsfiddle.net/ambiguous/xBnaN/)

2.  您可以使用 将您的路线添加为正则表达式[`route`](http://backbonejs.org/#Router-route)，这将使您在构建模式时有更多的自由。例如，像这样的片段：

    ```
    #directory-http://localhost/foobar-html/foo.html 
    ```

    可以用这样的路由器处理：

    ```
    initialize: function() {
        this.route(/directory-(.*?)-(.*)/, 'render');
    },
    render: function(d, f) {
        //...
    } 
    ```

    演示：http: [//jsfiddle.net/ambiguous/r8MBb/](http://jsfiddle.net/ambiguous/r8MBb/)

第二种选择会遇到问题，你不可避免地会`-`在你的`directoryPath`or `filePath`; 您可以通过 URI 编码嵌入`-`的 s 以通过第一个选项来获取它们。

# iphone - iOS & MVC - 如何创建这个应用程序/游戏

> ID：11294792
> 
> 赞同：0
> 
> 时间：2012-07-02T13:34:31.323
> 
> 标签：iphone, objective-c, ios

对于我应该如何实现以下应用程序，我真的很困惑。我有 90% 的代码，但最后 10% 我想不通。我无法弄清楚我应该如何控制事件的流动。我将首先描述应用程序/游戏。

## 游戏

事件的流程是这样发生的。用户设置团队数量和回合数。然后游戏将显示一个屏幕，上面写着“传递给第 1 队”。然后，第 1 队的玩家按下一个按钮，该按钮推动另一个视图。

在这个视图中，当前玩家试图向他们团队中的其他玩家描述屏幕上的单词/名称而不说它们。每次有人猜对一个单词/名称时，玩家按下一个按钮，该按钮会拉出更多单词，并将该团队的分数加 1。这种情况一直持续到计时器用完为止。

当计时器用完时，这个视图会从导航控制器中弹出，前一个视图会告诉玩家传球给第 2 队。

这将循环计算团队数量和轮数。

## 我的问题

我的问题是我真的不明白我应该如何跟踪所有这些事件。我有一个“GameBrain”类，我在其中保存了一系列分数和团队名称等，但我不知道如何从每个 ViewController 访问它。

我之前问过一个类似的问题，有人建议了一个 Singleton 类，但后来我读到这是不好的做法，我不禁觉得我*应该*能够按照 MVC 设计模式来做到这一点。

所以我的问题是，你们将如何编写这样的游戏？

对不起那种含糊的问题。任何帮助将不胜感激。

编辑：代表是正确的方式吗？即我是否会从我的“GameBrain”中创建我需要的第一个 ViewController，将大脑（`self`在这种情况下）设置为此实例的委托，并让 ViewController 在大脑会触发下一个 ViewController？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:38:02.997

你的 GameBrain 应该被设计成单例，单例可能有一些不好的方面，但在你的情况下，它们是最好的选择，所以就去吧

因为这个类必须被你所有的 viewControllers 访问，并且因为不需要有这个类的多个实例，所以这将完全适合单例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:52:31.273

我从评论开始，但继续回答。

简而言之，正如@Omar 所说，您描述的单例可能会很好地工作。

更长的版本，几年前我设计了一个这样的小东西，我们发布了它，一切都很好。几个月后，我们拥有了几百万用户，并且经历了多个开发阶段，而我们开始使用的 Singleton 模式正在摧毁这个项目。我可能会提到，我的老板一开始坚持这是一个小项目，我们会在两周内发布它并完成 - 哈，有趣的家伙。

Singleton 不能很好地工作的原因是它限制了模块化。最后，所有“游戏相关”的东西都必须通过这个类返回，而这个类又向另一个类发送了一条消息，该类又向 Singleton 等发送了响应。这太可怕了。

如果您有时间/精力，我建议您为每个游戏创建一个 GameBrain（或其他）类。无论如何，此类通常仅在“游戏屏幕”中使用，那么当您返回菜单或发送电子邮件时，为什么还要保留它呢？如果您需要它持久化，请使其由数据库支持。如果您只需要在一两个额外的地方使用它（您的获胜屏幕可能需要知道谁赢了等），只需通过参考传递它 - 您只需要执行一两次即可。

祝你好运。

# c++ - x64 进程在 4GB RAM 上可以占用多少内存

> ID：11294793
> 
> 赞同：0
> 
> 时间：2012-07-02T13:34:34.007
> 
> 标签：c++, windows, memory-management, 64-bit

我有一个 x64 应用程序。这是一个有点繁重的应用程序（在线程数、所需内存等方面）。我在 4GB RAM 64 位 Windows7 四核机器上运行此应用程序。但我注意到的是，在我的应用程序占用大约 2.2-2.3 GB 内存后它崩溃了。这是必需的行为吗？最大 64 位应用程序能否从 4GB RAM 中仅占用 2.3-2.4 GB RAM？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:58:51.270

RAM 的数量无关紧要，进程分配*虚拟*内存。您可以在 64 位进程中分配的虚拟内存量仅受操作系统提供将虚拟内存映射到 RAM 的页面的能力的限制。假设您没有使用 CreateFileMapping() 创建自己的映射，这通常仅受允许的最大分页文件的限制。这是一个系统设置，控制面板+系统+高级。Windows 版本也有上限，Windows 7 Home Premium 为 16 GB，Professional 及更高版本为 192 GB。

仅当您的程序实际访问虚拟内存时才使用 RAM。当内存尚未映射时，会产生页面错误。如果您在消耗所有可用页面之前分配和使用的内存远远超出 RAM 的数量，则 64 位进程通常会由于这些页面错误而减速到爬网。

由于您远远低于典型的最大页面文件大小，这肯定只是另一个普通的旧堆损坏错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:40:44.920

不，首先检查您没有任何溢出或其他错误。即使是 32 位应用程序也可以寻址 - 使用更多 RAM，因此如果它仅限于 64 位 Windows 将是荒谬的。

剩余的内存可以免费使用，对吧？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:49:26.373

调试你的程序。崩溃不应该仅仅因为你分配了很多内存而发生。通常的嫌疑人：数学溢出、内存损坏、未能处理来自内存分配例程的错误。

# php - PHP&MySQL 搜索不起作用？

> ID：11294802
> 
> 赞同：-1
> 
> 时间：2012-07-02T13:35:04.690
> 
> 标签：php, mysql, html

> **可能重复：**
> [PHP、MySQL 验证故障和搜索不起作用？](https://stackoverflow.com/questions/11293712/php-mysql-validation-malfunction-and-search-doesnt-work)

我创建了一个表单，除了搜索之外，一切都运行良好。例如，每当用户在搜索框中输入任何值时，它都会显示来自数据库的结果、员工的示例姓名等...请参阅下面的代码...

```
<html>
<head>
<?php
//require_once('student_form.php');
if(isset($_POST['search'])){ 
$id=$_REQUEST['id']; 
$fname=$_POST['fname'];
    //connect  to the database 
include('connection.php');
//-query  the database table 
$sql=mysql_query("SELECT  * FROM members WHERE (FirstName LIKE '". $fname ."%' OR LastName LIKE '". $lname ."%'");
    //-run  the query against the mysql query function 
    $result=mysql_query($sql); 

    if($row=mysql_fetch_array($result)){ 
                $fname=$row['FirstName']; 
                $lname=$row['LastName']; 
                /*$email=$row['Email'];
                $age =$row['Age'];
                $gender=$row['Gender'];
                $course = $row['Course'];*/
    }
    //-display  the result of the array 
    else
    {
    <?php echo $rows['FirstName']; ?>
    <?php echo $rows['LastName']; ?>
    } 
} 
?>
</head>
<body>
<form action="search.php" method="post">
<table>
    <tr>
    <td><strong>search box</strong></td>
    <td><strong>:</strong></td>
    <td><input type="text" name="search" value=""size="30"/><input type="submit" name="s1" value="Search"/></td>

</table>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:40:31.800

请注意，不推荐使用旧扩展...请参阅[文档](http://www.php.net/manual/en/function.mysql-query.php)[顶部的](http://www.php.net/manual/en/function.mysql-query.php)`mysql_`通知[`mysql_query`](http://www.php.net/manual/en/function.mysql-query.php)

> 不鼓励使用此扩展程序。相反，应该使用[MySQLi](http://www.php.net/manual/en/book.mysqli.php)或[PDO_MySQL扩展。](http://www.php.net/manual/en/ref.pdo-mysql.php)另请参阅 MySQL：[选择 API 指南](http://www.php.net/manual/en/mysqlinfo.api.choosing.php)和[相关的常见问题解答](http://www.php.net/manual/en/faq.databases.php#faq.databases.mysql.deprecated)以获取更多信息。此功能的替代方案包括：
> 
> *   mysqli_query()
> *   PDO::查询（）

但是为了让您了解问题所在，请替换此行：

```
$sql=mysql_query("SELECT  * FROM members WHERE (FirstName LIKE '". $fname ."%' OR LastName LIKE '". $lname ."%'");
//-run  the query against the mysql query function 
$result=mysql_query($sql); 
```

有了这个 ：

```
$result=mysql_query("SELECT  * FROM members WHERE (FirstName LIKE '". $fname ."%' OR LastName LIKE '". $lname ."%'");
if (!$result) {
    die('Could not query:' . mysql_error());
} 
```

您只需要执行`mysql_query`一次，这将在您的查询中输出错误...如果查询失败则`mysql_query`返回 a ...[请参阅此处的文档](http://www.php.net/manual/en/function.mysql-query.php)`boolean false`

请花点时间阅读一下[SQL 注入](http://php.net/manual/en/security.database.sql-injection.php)

**请注意** [，此答案](https://stackoverflow.com/a/11294851/572939)将解决您的问题-但仅解决它对您将来没有帮助....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:52:08.910

你必须完全重写你的代码。

首先，`FirstName`从查询中删除之前的括号：

```
"SELECT  * FROM members WHERE FirstName LIKE '". $fname ."%' OR LastName LIKE '". $lname ."%'" 
```

现在，请注意：如果`$sql`是函数`mysql_query`，则`$result`正在运行查询（`mysql_query(mysql_query("..."))`）的查询。

相反，使用`$result = mysql_query("...")` 并删除变量`$sql`。

这里的第三个问题是`<?php`您的 PHP 代码中有一个标签。去掉里面的`<?php`和`?>`标签`else{ }`。

我不明白这是什么`$rows`，现在有这个声明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:37:25.257

你必须移除这个附近的支架`FirstName`，

```
$sql=mysql_query("SELECT  * FROM members WHERE FirstName LIKE '". $fname ."%' OR LastName LIKE '". $lname ."%'"); 
```

# javascript - CSS类查找器

> ID：11294803
> 
> 赞同：-1
> 
> 时间：2012-07-02T13:35:07.460
> 
> 标签：javascript, jquery, css

我有一个听起来很简单但至少对我来说很难实现的要求，所以这里是什么

我有一个下拉菜单，其中有一个类似于自动完成的搜索字段，当在搜索字段中输入关键字时，所有类名都变为空，除了关键字项。

现在我只需要使用类名来获取“li”的 id，

我是 jquery 的新手，非常感谢任何帮助这是我的代码

```
function selectSearchItems() {
        alert("hai");
        var origul = document.getElementById("orig_ul");
        var origlis = origul.getElementsByTagName('li');
        for (var i = 0; i < origlis.length; i++) {
            alert($('ul#orig_ul li').children('li.active-result'));
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:48:28.530

试试这个：

```
function selectSearchItems() {
    alert("hai");
    var origul = $("#orig_ul");
    var origlis = origul.find('li[class]');
    for (var i = 0; i < origlis.length; i++) {
        alert(origlis[i].id);
    }
} 
```

# java - 是否有类似 Java 应用程序的 WebGoat 来练习分析？

> ID：11294806
> 
> 赞同：2
> 
> 时间：2012-07-02T13:35:09.900
> 
> 标签：java, profiling

是否有类似 WebGoat 的 Java 应用程序来练习 Java 分析？

[WebGoat](https://www.owasp.org/index.php/Category%3aOWASP_WebGoat_Project)是一个故意不安全的 Java EE Web 应用程序，用于教授和理解 Web 安全性。有什么类似的分析吗？

我想我正在寻找一个故意内存泄漏、内存占用（对于某些用例）、有时是 CPU 占用以及有时是线程竞争的 Java Web 应用程序。当我使用“有时”时，我的意思是在某些众所周知的用例中，因此我们可以模拟行为。

# sql - 为什么我的 Access 2007 查询突然变得不可更新？

> ID：11294807
> 
> 赞同：2
> 
> 时间：2012-07-02T13:35:17.343
> 
> 标签：sql, ms-access, ms-access-2007, recordset

我在 Access 2007 中有一个查询。它工作了几个月，但我突然收到“记录集不可更新”错误。认为错误一定是由最近的更改引起的，我回到存档版本（definitley 工作） - 他们都抛出了相同的错误。表本身是可更新的；事实上，同一张表上的另一个查询工作得很好。突然发生了什么事情会打断我的查询？代码如下：

```
 SELECT Prospects.Company, Contactnames.*, IIf([Prospects]![Key Contact]=[ContactID],True,False) AS [Key Contact], Prospects.Status
FROM Contactnames INNER JOIN Prospects ON Contactnames.CompanyID=Prospects.ID
WHERE (((Prospects.Status) Not Like "Duplicate")); 
```

任何帮助将不胜感激。谢谢，奥利。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T14:52:53.347

如果您使用链接的 ODBC 表，如果您希望查询可更新，则需要在查询中包含所有表的主键字段。以下是一些潜在的“陷阱”：

*   Access 可能无法正确识别链接的 ODBC 表中的主键字段；经常（总是？）Access 选择它为表找到的第一个唯一索引（基于索引名称的字母顺序）并假设索引是主键
*   向 MS SQL Server（可能还有其他 RDBMS）中的表添加复制将添加具有唯一索引的 GUID 列；连同上述几点，这可能会导致 Access 认为您的链接表具有与实际不同的主键
*   对 ODBC 链接表的设计所做的更改不会自动反映在 Access 中；链接的 ODBC 表可以通过 Tools --> Database Utilities --> Linked Table Manager...（以及其他方式）刷新

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:40:44.820

可能的原因是更改的不是查询，而是数据库。

检查数据库文件是否没有被写保护。这将导致该错误消息。

# oracle - oracle如何知道事务已提交？

> ID：11294809
> 
> 赞同：0
> 
> 时间：2012-07-02T13:35:20.920
> 
> 标签：oracle

> **可能重复：**
> [Oracle：如何找出是否有待处理的事务？](https://stackoverflow.com/questions/1299694/oracle-how-to-find-out-if-there-is-a-transaction-pending)

在 Oracle 中，如果我在 SQL PLUS 中发出 UPDATE 命令，我如何知道它是否已提交？

例如，下面的代码，我怎么知道这 25 行是否已提交？

```
update countries set name = 'ddd'
25 rows updated 
```

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-02T13:49:10.080

在提交后使用提交语句，例如更新国家/地区集名称='ddd'；犯罪; 然后执行 SELECT 语句以查看您是否已持久化到数据库

# excel-dna - 通过 Excel-DNA 通过 xlcFormula 加速公式的插入

> ID：11294811
> 
> 赞同：1
> 
> 时间：2012-07-02T13:35:33.677
> 
> 标签：excel-dna

我正在使用 Excel-DNA 将公式插入到大约 40k 行 * 10 列中，而且速度很慢。

```
 XlCall.Excel(XlCall.xlcFormula, myFormula, new ExcelReference(row, row, column, column)); 
```

`XlCall.Excel(XlCall.xlcCalculation, 3);`我设法通过暂时禁用更新（.

我尝试通过`object[,]`对 xlcFormula 的调用传递一个：

```
 XlCall.Excel(XlCall.xlcFormula, excelFormulas, new ExcelReference(1, lastRow, columnNumber, columnNumber)); 
```

但它将所有公式放入一个字段中（用分号分隔）。有没有办法做我想做的事情，还是我把时间浪费在不可能的事情上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T19:55:51.413

我也遇到了这个麻烦，并想出了另一种加速公式插入的方法。试试这个代码：

```
var formula = "=1+2";
var reference = new ExcelReference(rowFirst, rowLast, columnFirst, columnLast); // it's а rectangular area, just split up your huge area to smaler ones here
XlCall.Excel(XlCall.xlcFormulaFill, new object[] { formula, reference } )); 
```

当您想将相同的公式插入大量单元格时，此代码非常有用。尝试在公式中使用相对引用。

以前的解决方案也有效：

```
XlCall.Excel(XlCall.xlcEcho, false) 
```

...但不要忘记不时启用回声。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T18:50:25.287

您可以尝试关闭屏幕更新`XlCall.Excel(XlCall.xlcEcho, false)`。

使用**剪贴板**怎么样？您可以将公式（列之间有标签）复制到剪贴板，然后一次性粘贴到 Excel 工作表中。这可能与让 Excel 处理公式字符串一样快。

# apache - 如何更改 XAMPP apache 服务器端口？

> ID：11294812
> 
> 赞同：142
> 
> 时间：2012-07-02T13:35:35.110
> 
> 标签：apache, xampp

这是我的 Apache httpd.conf 设置：

```
Listen 8012
ServerName localhost:8012 
```

每次我通过启动 Apache 时都会`XAMPP`看到以下消息：

```
Status Check OK
Busy…
Apache Started [Port 80] 
```

任何人，请帮助我可以更改任何其他设置吗？

* * *

## 回答 #1

> 赞同：378
> 
> 时间：2014-02-20T17:13:58.633

# 要回答原始问题：

要在此处更改 XAMPP [Apache](http://httpd.apache.org/)服务器端口，请执行以下步骤：

## 1.选择一个空闲的端口号

Apache 使用的默认端口是`80`.

使用[Netstat](http://en.wikipedia.org/wiki/Netstat)（集成到[XAMPP](http://www.apachefriends.org/index.html)控制面板）查看**所有使用的端口。**

![xampp控制netstat截图](../Images/12298eedd91535cc31a493c5565035ab.png)

然后您可以看到所有使用的端口，在这里我们看到该`80`端口**已**被`System`.

![截图 netstat 端口 80](../Images/da7fa4b750eb60fa75f6bc858966bc9d.png)

选择一个可用的端口号（`8012`, 例如）。

## 2.编辑文件“ `httpd.conf`”

> 此文件应`C:\xampp\apache\conf`在*Windows*或*Linux*`bin/apache`中找到。：

 *```
Listen 80
ServerName localhost:80 
```

将它们替换为：

```
Listen 8012
ServerName localhost:8012 
```

保存文件。

访问：[http://localhost:8012](http://localhost:8012)检查它是否工作。

如果没有，您必须按照以下*步骤 3*`http-ssl.conf`中的说明编辑文件。↓</p>

## *3.编辑文件“ `http-ssl.conf`”*

 *> 此文件应`C:\xampp\apache\conf\extra`在*Windows*上找到，或在*Linux*上查看此[链接](https://serverfault.com/questions/174897/possible-locations-of-ssl-conf-and-httpd-conf)。

 *找到以下行：

```
Listen 443
<VirtualHost _default_:443>
ServerName localhost:443 
```

将它们替换为其他端口号（`8013`对于此示例）：

```
Listen 8013
<VirtualHost _default_:8013>
ServerName localhost:8013 
```

保存文件。

重新启动 Apache 服务器。

访问：[http://localhost:8012](http://localhost:8012)检查它是否工作。

## 4\. 配置 XAMPP Apache 服务器设置

如果您想访问 localhost 而不在 URL
[http://localhost](http://localhost)而不是[http://localhost:8012](http://localhost:8012)中指定端口号。

*   打开**Xampp 控制面板**
*   转到**配置**►**服务和端口设置**► **Apache**
*   将**Main Port**和**SSL Port**值替换为选择的值（例如`8012`和`8013`）。
*   保存**服务设置**
*   保存**控制面板的配置**
*   重新启动 Apache 服务器 ![xampp apache设置端口](../Images/5ae718aa1b0e80f96b8ade53e1950faa.png) 它现在应该可以工作了。

### 4.1。网络浏览器配置

如果此配置未在 URL 中隐藏端口号，那是因为您的 Web 浏览器未配置。请参阅：**工具 ► 选项 ► 常规 ► 连接设置...**将允许您选择不同的端口或更改代理设置。

### 4.2\. 对于极少数的极端厄运

如果第 4 步和 Web 浏览器配置对您不起作用，则唯一的方法是更改​​回 80，或在端口 80 上安装一个侦听器（如代理），将所有流量重定向到端口 8012。

# 要回答您的问题：

如果您在控制面板控制台中仍有此消息：

> Apache 启动 [端口 80]

*   查找`xampp-control.exe`文件的位置（可能在`C:\xampp`）
*   在该目录中创建一个文件`XAMPP.INI`（因此`XAMPP.ini`和`xampp-control.exe`在同一目录中）

在文件中放入以下行`XAMPP.INI`：

```
[PORTS]
apache = 8012 
```

现在，您将始终得到：

> Apache 启动 [端口 8012]

请注意，**这仅用于展示目的**。它与您的`httpd.conf`.

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2015-10-03T18:00:38.183

最好的解决方案是重新配置 XAMPP Apache 服务器来监听和使用不同的端口号。这是您的操作方法：

1) 首先，您需要打开 Apache “httpd.conf” 文件并将其配置为使用/侦听新端口号。要打开 httpd.conf 文件，请单击 Apache“开始”和“管理”按钮旁边的“配置”按钮。在打开的弹出菜单中，单击并打开 httpd.conf

2) 在 httpd.conf 文件中搜索“listen”。你会发现两行类似：

```
#Listen 12.34.56.78:80
Listen 80 
```

将端口号更改为端口号。您选择的（例如端口 1234），如下所示

```
#Listen 12.34.56.78:1234
Listen 1234 
```

3) 接下来，在同一个 httpd.conf 文件中查找“ServerName localhost:”，将其设置为新的端口号。

```
ServerName localhost:1234 
```

4) 保存并关闭 httpd.conf 文件。

5) 现在再次单击 Apache config 按钮并打开“httpd-ssl.conf”文件。

6) 在 httpd-ssl.conf 文件中，再次查找“Listen”。你可能会发现：

```
Listen 443 
```

将其更改为侦听您选择的新端口。像这样说：

```
Listen 1443 
```

7) 在同一个 httpd-ssl.conf 文件中找到另一行显示`<VirtualHost _default_:443>`. 将此更改为您的新端口号。（如 1443）

8) 同样在同一个 httpd-ssl.conf 中，您可以找到另一行定义端口号。为此寻找“ServerName”。你可能会发现类似的东西：

```
ServerName www.example.com:443 or  ServerName localhost:433 
```

将此 ServerName 更改为您的新端口号。

8) 保存并关闭 httpd-ssl.conf 文件。

9) 最后，还有一个地方应该更改端口号。为此，单击并打开 XAMPP 控制面板的“配置”按钮。然后单击“服务和端口设置”​​按钮。在其中，单击“Apache”选项卡，然后在“主端口”和“SSL 端口”框中输入并保存新的端口号。单击保存并关闭配置框。

这应该够了吧。现在“启动”Apache，如果一切顺利，您的 Apache 服务器应该会启动。

您还将看到 XAMPP 控制面板中的 Apache Port/s no 已更改为您设置的新端口 ID。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-05-23T07:09:05.687

如果目前`XAMPP server`正在运行，请停止 XAMPP 服务器。

**按照以下步骤更改端口号。**

在以下位置打开文件。

```
[XAMPP Installation Folder]/apache/conf/httpd.conf 
```

打开`httpd.conf`文件并搜索字符串：

**听 80**

这是 XAMMP 使用的端口号。

然后搜索字符串**ServerName**并更新您之前输入的**端口号**`Listen`

***现在保存并重新启动 XAMPP 服务器。***

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-02T13:48:18.627

您是否尝试通过键入“ **http://localhost:8012** ”（重新启动 apache 后）来访问您的页面？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-07-30T10:26:28.957

我也有问题。我切换了端口，但无法在 8012 上启动。

涉及 Skype 是因为它具有相同的端口 - 80。它不能让 apache 更改它的端口。

所以只需重新启动计算机并在打开任何其他程序之前打开 xampp**首先**更改端口让我们说在 httpd.conf 中的这些行上从 80 到 8000 或 8012

```
Listen 80
ServerName localhost:80 
```

重新启动 xampp，启动 apache，检查 localhost。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-23T08:25:13.847

如果在端口 id 以上不起作用，请更改它。如 8082,8080 重新启动 xammp，启动 apache 服务器，检查它。它现在正在工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-10T13:04:43.383

如果它的 Ubuntu 系统：转到 `cd /opt/lampp/etc/`

```
vim httpd.conf 
```

在这里您可以更改监听端口号***

# oracle10g - ALTER TABLE REBUILD 错误 当我执行这个 sql 命令时： alter table rebuild; 我有这个错误： 我用： Oracle 数据库 10g 问问题 问问题 2012-07-02T13:35:35.690 576 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 当我执行这个 sql 命令时： alter table

rebuild; 我有这个错误： 我用： Oracle 数据库 10g 企业版 10.2.0.1.0 版 - 64bi PL/SQL 10.2.0.1.0 版 - 生产 谢谢 安装说明似乎有答案，即设置环境变量$GEOS_LIBRARY_PATH。 oracle10gcompiler-errors 4 0 回答 0 Related 1 python - tkinter 中使用的 pygame 加载图像“不存在” 2 powershell - powershell 删除特定的注册表项 1 .net - 管道 pow 操作员问题 1 javascript - Safari 6 中未显示下拉菜单 2 c++ - c++ winforms和标准库容器 0 ruby-on-rails - 在多态中使用触摸的rails会导致错误 1 spring-security - 使用 cxf (JaxWsProxyFactoryBean) 测试摘要认证的 webservice 客户端 1 c# - C# Entity Framework 5 多对多查看数据 1 python - 谁能向我解释为什么纹理不显示？[PyOpenGL] 1 java - 如何在eclipse中执行一个可运行的jar文件 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：11294813
> 
> 赞同：0
> 
> 时间：
> 
> 标签：oracle10g, compiler-errors

当我执行这个 sql 命令时：

```
alter table <table> rebuild; 
```

我有这个错误：

![在此处输入图像描述](../Images/81e605d1c8064884c11f9852e50f8b9e.png)

我用：

> Oracle 数据库 10g 企业版 10.2.0.1.0 版 - 64bi PL/SQL 10.2.0.1.0 版 - 生产

谢谢

# c++ - 在 c++ 中实例化指向新对象的指针时的问题

> ID：11294816
> 
> 赞同：2
> 
> 时间：2012-07-02T13:35:44.807
> 
> 标签：c++, pointers, null, instantiation

我对 c++ 是半新手。我已经尝试了一切，但无法解决我的问题。只是为了一些背景：我正在使用 Botan 库进行加密。我不认为这个问题与库有任何关系，而更多地与指针和对象有关。

当我使用以下代码时，没有问题。每行后面的注释解释了会发生什么。（代码仅用于解释目的）

```
int main(int argc, char** argv)
{
    DH_PrivateKey *Apriv = 0; // Apriv points to 0x00
    MemoryVector<unsigned char> *Apub = 0; // Irrelevant for now
    AutoSeeded_RNG rng; // Irrelevant object
    DL_Group domain("modp/ietf/3072"); // Irrelevant object
    Apriv = new DH_PrivateKey(rng,domain); // Apriv points to 0x8079098 
```

这里的主要观察是一个对象被实例化并且 Apriv 指向该对象。这就是我想要发生的事情。当我尝试在将 Apriv 指针传递给的另一个函数中执行此操作时，问题就出现了。

我的主要代码更改为以下内容：

```
int main(int argc, char** argv)
{   
    DH_PrivateKey *Apriv = 0;
    MemoryVector<unsigned char> *Apub = 0;
    AutoSeeded_RNG rng;
    DL_Group domain("modp/ietf/3072");
    encryption::dh_generatekeys("modp/ietf/3072",Apriv,Apub); //Passing pointers 
```

我将这些指针传递给的函数如下所示：

```
void encryptionalgorithm::dh_generatekeys(string shareddomain,DH_PrivateKey *privatekey,MemoryVector<unsigned char> *publickey)
{
    AutoSeeded_RNG rng; // Irrelevant
    DL_Group shared_domain(shareddomain); // Irrelevant
    privatekey = new DH_PrivateKey(rng, shared_domain); //[PROBLEM 1]
    MemoryVector<unsigned char> pubkey = privatekey->public_value();
    publickey = &pubkey;[PROBLEM 2] 
```

我现在将描述这些问题：

问题1：privatekey指针仍然指向0x00，它没有指向新实例化的对象，这会导致后面的分段错误。问题2：与publickey相同，当我在堆栈上创建“pubkey”然后将publickey指针指向它的地址时，publickey只是保持0x00。

任何帮助，将不胜感激。我希望这很简单！

多谢你们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T13:42:21.597

您的参数是按值传递的。

这意味着，如果您在`privatekey`函数内修改指针的值，您只会修改该函数的局部变量。

您可能希望更改函数签名以接受参数作为引用：

```
void generatekeys(Something *& Apub, Something *& Apriv) { ... } 
```

这从右到左读取：`Apub`是对`&`指向 的指针`*`的引用`Something`。`Apub`现在，对内部和`Apriv`内部的任何更改`generatekeys`都将根据需要传播到外部，但请注意，您需要调用传递适当变量（左值）的函数，而不仅仅是一些表达式（右值）。

如有疑问，请进一步询问或使用谷歌获取参考参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:42:50.023

您的问题是`dh_generatekeys`两者兼而有之（即指针的值）`privatekey`。`publickey`因此，您修改的是指针的本地副本，而不是指针。解决方案是简单地将指针或对指针的引用传递给您的对象，因此：

```
void encryptionalgorithm::dh_generatekeys(string shareddomain,DH_PrivateKey** privatekey, MemoryVector<unsigned char>** publickey) 
```

或者

```
void encryptionalgorithm::dh_generatekeys(string shareddomain,DH_PrivateKey*& privatekey, MemoryVector<unsigned char>*& publickey) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:43:56.893

如果我理解正确，您应该将 dh_generatekeys 更改为：

```
void encryptionalgorithm::dh_generatekeys(string shareddomain,DH_PrivateKey* &privatekey,MemoryVector<unsigned char>* &publickey) { ... } 
```

也就是说使用对指针的引用。这样你就可以改变它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T13:44:14.810

您需要传递指针（或*引用）的**地址*才能修改调用者中的值。

 *指针地址（指针的指针）示例：

```
int main(int argc, char** argv)
{   
    DH_PrivateKey *Apriv = 0;
    MemoryVector<unsigned char> *Apub = 0;
    AutoSeeded_RNG rng;
    DL_Group domain("modp/ietf/3072");
    encryption::dh_generatekeys("modp/ietf/3072",&Apriv,&Apub); //Passing address of pointers
    //...
}

void encryptionalgorithm::dh_generatekeys(string shareddomain,DH_PrivateKey **privatekey,MemoryVector<unsigned char> **publickey)
{
    AutoSeeded_RNG rng; // Irrelevant
    DL_Group shared_domain(shareddomain); // Irrelevant
    *privatekey = new DH_PrivateKey(rng, shared_domain); //dereference to assign
    MemoryVector<unsigned char> pubkey = privatekey->public_value();
    *publickey = &pubkey; //dereference to assign
    //...
} 
```*

# java - 从 itr.next() 返回的对象打印成员

> ID：11294818
> 
> 赞同：0
> 
> 时间：2012-07-02T13:35:52.677
> 
> 标签：java, iterator

以下代码存在编译问题。还附上了编译错误。请提出相同的解决方案。

**代码：**

```
import java.util.*;

class test{

    int key;

    public static void main(String []args){
        test obj = new test();
        obj.key = 9999;

        LinkedList al = new LinkedList();
        al.add(obj);

        Iterator itr = al.iterator();
        while(itr.hasNext()){
            test temp = new test();
            temp = itr.next();
            System.out.println(temp.key);
        }   
    }
} 
```

**编译错误：**

> test.java:17：错误：不兼容的类型
> 
> temp = itr.next(); ^
> 
> 要求：测试
> 
> 找到：对象

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T14:49:33.393

有两种解决方案：

### 旧解决方案（Java 1.5 之前）：

```
public static void main(String []args){
    test obj = new test();
    obj.key = 9999;

    LinkedList al = new LinkedList();
    al.add(obj);

    Iterator itr = al.iterator();
    while(itr.hasNext()){
        test temp = new test();
        // use type cast
        temp = (test) itr.next();
        System.out.println(temp.key);
    }   
} 
```

### 通用解决方案（Java 1.5 及更高版本）：

```
public static void main(String []args){
    test obj = new test();
    obj.key = 9999;

    LinkedList<test> al = new LinkedList<test>();
    al.add(obj);

    Iterator<test> itr = al.iterator();
    while(itr.hasNext()){
        test temp = new test();
        // use Generic
        temp = itr.next();
        System.out.println(temp.key);
    }   
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:37:06.983

`its.next()`返回一个实例`Object`而不是`Test`

使其如下

```
LinkedList<Test> al = new LinkedList<Test>();
al.add(obj);

Iterator<Test> itr = al.iterator(); 
```

所以编译器现在知道`LinkedList` `a1`只能保存`Test`实例，所以在迭代时我们只会有实例`Test`

# ruby-on-rails - 使用 rspec 进行设计时出错

> ID：11294820
> 
> 赞同：0
> 
> 时间：2012-07-02T13:35:53.040
> 
> 标签：ruby-on-rails, rspec, devise

我正在使用 rspec 来测试设备身份验证。以下是我的代码

```
require 'spec_helper'

describe User do

describe "user registration" do
it "allows new users to register with an email address and password" do
get "/users/sign_up"

fill_in "Email",                 :with => "abc@example.com"
fill_in "Password",              :with => "abc123"
fill_in "Password confirmation", :with => "abc123"

 click_button "Sign up"

   response.should have_content("Welcome! You have signed up successfully.")
  end
 end
end 
```

我收到以下错误。

“NoMethodError：未定义的方法 `get' for #”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:42:20.023

您正在模型规范中使用控制器方法和集成测试方法（Capybara）。不起作用。

模型规范（UNIT 测试）将包含以下内容：

1.  测试你的验证者/关系
2.  测试范围
3.  模型的方法

查看这一系列关于使用 RSpec 进行测试的博客文章，它应该会有所帮助： [http ://everydayrails.com/2012/03/12/testing-series-intro.html](http://everydayrails.com/2012/03/12/testing-series-intro.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T06:52:45.213

我可能会尝试这样的事情

```
require 'spec_helper'

describe User do

describe "user registration" do
 it "allows new users to register with an email address and password" do
  visit new_user_registration_path
  current_path.should be(new_user_registration_path)

  fill_in "user[email]",                 :with => "abc@example.com"
  fill_in "user[password]",              :with => "abc123"
  fill_in "user[password_confirmation]", :with => "abc123"
  click_button "Sign up"

  expect { click_button submit }.to change(User, :count).by(1)
  response.should be_redirect   
  response.should have_content("Welcome! You have signed up successfully.")
  end
 end
end 
```

但我强烈推荐使用[FactoryGirl](https://github.com/thoughtbot/factory_girl/)来生成新值。还要检查您使用了哪些设计模块。例如，如果您使用的是 Confirmable 模块，很明显这种方法是错误的。一些有用的[文章](http://garyrafferty.com/2011/09/29/Testing-devise-with-rspec-and-capybara.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:42:09.370

这似乎是一个`describe User`不允许运行请求的模型规范 ()，但您可能想要编写控制器规范 ( `describe UsersController`) 甚至是集成测试。

如果您使用默认的 rspec 布局，只需将您的代码移动到适当的目录 (`spec/controllers`或`spec/integration`)。我会做一个集成测试：

```
# In spec/integration/user_registration_spec.rb
require 'spec_helper'

describe "User registration" do
  it "allows new users to register with an email address and password" do
    get "/users/sign_up"

    fill_in "Email",                 :with => "abc@example.com"
    fill_in "Password",              :with => "abc123"
    fill_in "Password confirmation", :with => "abc123"

    click_button "Sign up"

    response.body.should have_content("Welcome! You have signed up successfully.")
  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-02T13:46:15.607

这个文件在 spec/models 目录中吗？我猜是这种情况，因为您正在`describe`使用`User`. 您编写测试的方式是控制器式测试和集成（验收）测试的混合。这可能是你想要的：

```
require 'spec_helper'

describe User do
  describe "user registration" do
    it "allows new users to register with an email address and password" do
      visit "/users/sign_up"

      fill_in "Email",                 :with => "abc@example.com"
      fill_in "Password",              :with => "abc123"
      fill_in "Password confirmation", :with => "abc123"

      click_button "Sign up"

      page.should have_content("Welcome! You have signed up successfully.")
    end
  end
end 
```

将此文件放在 spec/integration 或 spec/requests 目录中。

# php - PHP - 无法删除奇怪的字符

> ID：11294822
> 
> 赞同：1
> 
> 时间：2012-07-02T13:35:55.377
> 
> 标签：php

我真的很感激这方面的一些帮助。我在这个问题上浪费了好几天，我在网上找到的任何建议似乎都没有给我一个解决办法。

我有一个来自供应商的 CSV 文件。它似乎是从 Microsoft 系统中导出的。

我正在使用 PHP 将数据导入 MySQL（两个最新版本）。

我有一个特殊的记录，其中包含一个我无法摆脱的奇怪角色。手动编辑以删除字符是可能的，但我更喜欢自动化解决方案，因为这会每天发生多次。

该字符似乎是对“智能引用”的解释。十六进制编辑器告诉我字符代码是 C2 和 92。在十六进制编辑器中，它看起来像一个奇怪的 A，后跟一个智能引号。在其他编辑器和 Calc、Writer 等中，它只是显示为一个框。ﾒ</p>

我正在使用 mb_detect_encoding 来确定编码。CSV 文件中的所有记录都以 ASCII 格式返回，但带有奇怪字符的记录除外，它以 UTF-8 格式返回。我可以将有问题的记录插入 MySQL，它只是在 Workbench 中显示为一个正方形。

MySQL 表配置为`utf-8 – utf8_unicode_ci`其他不常见的 UTF 字符（例如分数）是可以的。

我已经尝试了很多解决方案...

*   [如何在 PHP 中检测格式错误的 utf-8 字符串？](https://stackoverflow.com/questions/6723562/how-to-detect-malformed-utf-8-string-in-php)
*   [从字符串中删除非 utf8 字符](https://stackoverflow.com/questions/1401317/remove-non-utf8-characters-from-string)
*   [删除无效/不完整的多字节字符](https://stackoverflow.com/questions/9631299/removing-invalid-incomplete-multibyte-characters)
*   [如何在 PHP 中检测格式错误的 utf-8 字符串？](https://stackoverflow.com/questions/6723562/how-to-detect-malformed-utf-8-string-in-php)
*   [如何在 PHP 中替换 Microsoft 编码的引号](https://stackoverflow.com/questions/1262038/how-to-replace-microsoft-encoded-quotes-in-php)

等等等等，但没有一个对我有用。

我真正想做的就是删除或替换有问题的字符，理想情况下是搜索和替换十六进制值，但我尝试过的示例都没有奏效。

任何人都可以帮我推进这个吗？

**编辑**：由于
声誉不足，无法发布答案：
感谢您的意见。非常感激。
我将使用十六进制搜索和替换：

```
$DodgyText = preg_replace("/\xEF\xBE\x92/", "" ,$DodgyText); 
```

我知道这不是优雅的解决方案，但我需要快速修复，这对我有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T10:33:33.013

另一种解决方案是：

```
$contents = iconv('UTF-8', 'Windows-1251//IGNORE',$contents);
$contents = iconv('Windows-1251', 'UTF-8//IGNORE',$contents); 
```

您可以在哪里将 Windows-1251 替换为本地编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:39:09.890

乍一看，这看起来像一个 UTF-8 文件。（UTF-8 与 ASCII 表中的前 128 个字符相同，因此除特殊字符外，所有内容都被检测为 ASCII。）

如果您的数据库连接也是 UTF-8 编码的（默认情况下可能不是），它应该可以工作。

如何做到这一点取决于您的数据库库，如果您需要帮助设置连接编码，请告诉我们您使用的是哪一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:42:16.333

**根据既定发现更新代码**

您可以使用十六进制表示法对字符串进行搜索和替换：

```
str_replace("\xEF\xBE\x92", '', $value); 
```

*这将返回删除了特殊代码的值*

也就是说，如果您的数据库表是 UTF-8，则您不需要该转换；相反，您可以查看连接（或会话）字符集（即`SET NAMES utf8;`）。配置这取决于您用来连接数据库的库。

要调试您可以使用的值`bin2hex()`；这通常有助于在线搜索。

# sql - 以任何顺序比较基于多列的两个表？

> ID：11294823
> 
> 赞同：0
> 
> 时间：2012-07-02T13:35:56.123
> 
> 标签：sql, sql-server, sql-update, insert-update

我希望能在我的 SQL Server 脚本方面获得一些帮助。

基本上，我有以下要求：在数据库中，我们有一个名为 Space 的表。空间具有长度和宽度。我们需要从我们收到的 excel 表中上传数据。所以我把它上传到一个表格中，这个表格也有一个长度和宽度。

现在，我需要将 Oid 从 Space (Oid, Length, Width) 获取到 #spaceTmp 表 (NULL, Length, Width) 但问题是长度和宽度可以按任何顺序匹配。

例如：空间表具有以下内容：（1、5、7）

#spaceTmp 有以下内容： (NULL, 5, 7) (NULL, 7, 5) (NULL, 4, 3) (NULL, 3, 4)

我需要#spaceTmp 有： (1, 5, 7) (1, 7, 5) (2, 4, 3) (2, 3, 4)

任何建议将被认真考虑。

PS为简单起见，我没有使用GUID，而是Oid列的整数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:39:00.697

像这样的东西？

```
UPDATE #spaceTemp SET Old = ID
FROM Space 
WHERE (Space.Width = #spaceTemp.Width AND Space.Length = #spaceTemp.Length)
OR (Space.Width = #spaceTemp.Length AND Space.Length = #spaceTemp.Width) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:58:09.630

试试这个：

```
/*
 -- Setup Script
SELECT NEWID() OID, 5 Width, 7 Length
    INTO #Space

SELECT NEWID() OID, 5 Width, 7 Length
    INTO #SpaceTemp

INSERT INTO #SpaceTemp
SELECT NULL OID, 5 Width, 7 Length

INSERT INTO #SpaceTemp
SELECT NULL OID, 7 Width, 5 Length

INSERT INTO #SpaceTemp
SELECT NULL OID, 4 Width, 3 Length

INSERT INTO #SpaceTemp
SELECT NULL OID, 3 Width, 4 Length

UPDATE #SpaceTemp SET OId = NULL;
*/
UPDATE a
        SET a.OId = COALESCE(b.OId, NEWID())
  FROM #SpaceTemp a LEFT JOIN #Space b
        ON (a.Width = b.Width AND a.Length = b.Length)
        OR (a.Width = b.Length AND a.Length = b.Width)

SELECT * FROM #SpaceTemp 
```

# java - 每次执行时的连续数字生成器程序

> ID：11294832
> 
> 赞同：-3
> 
> 时间：2012-07-02T13:36:20.647
> 
> 标签：java

我想编写一个程序，每次*执行*时都会生成从 1 开始的连续数字。

它将在第一次执行时打印 1，然后在下一次执行时打印 2，依此类推。

在 Java 中执行此操作的最短方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:46:04.033

最简单的方法是将号码保存在某处并进行查找。

例如，你第一次开始，寻找一个给定的文件。如果不存在，则创建它，向其写入 1，输出 1，退出。

第二次，文件在那里，读取内容（它是 1），增加该值，将 2 写入文件，输出 2...

等等等等。

你试过写代码吗？您可以轻松搜索如何打开文件、写入、读取等，关于这些问题有很多问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:57:31.113

一个有趣的、独立于平台的选项是使用[Java Preferences API](http://docs.oracle.com/javase/1.4.2/docs/guide/lang/preferences.html)。

# facebook - 如何找出您的哪些 Facebook 好友也在使用您的移动应用程序？

> ID：11294834
> 
> 赞同：0
> 
> 时间：2012-07-02T13:36:44.847
> 
> 标签：facebook, api, mobile-application

我们正在构建使用 Facebook 进行注册的移动应用程序（知道如何执行此操作）。我们希望有一个屏幕，如果您的所有朋友也使用我们的应用程序，他们将在其中列出指示。

我们应该如何保存一个 facebook 用户也是我们的应用程序用户的数据（客户端、服务器）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T14:10:14.600

当您已经使用 Facebook 进行身份验证时，您的数据库中的用户表中可能已经有一个列，其中包含每个用户的 Facebook 个人资料 ID。如果您想区分它们，如果该用户也在使用您的移动应用程序，只需添加一个列建模。

[通过向https://graph.facebook.com/PROFILE_ID/friends](https://graph.facebook.com/PROFILE_ID/friends)发出请求，如[Facebook Graph API 文档](https://developers.facebook.com/docs/reference/api/user/#friends)中所述，您可以获取特定用户的好友列表，而无需任何额外权限。

现在只需在用户的朋友列表和您的（移动应用程序）用户群之间建立交集，您就会得到他正在使用您的移动应用程序的朋友列表。您当然应该在服务器上进行此比较，因此您不必发送整个用户群的 Facebook id。

# video-streaming - 使用 vlc 将 mp4 流式传输到 html 浏览器

> ID：11294836
> 
> 赞同：23
> 
> 时间：2012-07-02T13:36:49.713
> 
> 标签：video-streaming, html5-video, vlc

我在将网络摄像头图片（无声）流式传输到 html 页面时遇到问题。我正在使用最新的（用于 windows 的 v2.0.2 vlc）进行流式传输，这是命令行：

```
"c:\Program Files (x86)\VideoLAN\VLC\vlc.exe" -I dummy  dshow:// --dshow-vdev="Logitech QuickCam Chat" --dshow-adev=none --dshow-caching=0 --sout=#transcode{vcodec=h264,vb=1024,channels=1,ab=128,samplerate=44100,width=320}:http{mux=ts,dst=:8080/webcam.mp4} 
```

当我在另一个 vlc 播放器 (http://127.0.0.1:8080/webcam.mp4) 中打开流时，我可以观看流，但是当我尝试将其嵌入网页时，我什么也看不到！这是代码：

```
<!DOCTYPE html>
<html>
  <head>
    <title>Video Test</title>
  </head>
  <body>
    <video id="video" class="projekktor" autoplay="autoplay" width="300px" preload="metadata">  
      <source src="http://127.0.0.1:8080/webcam.mp4" />
            Your browser doesn't appear to support the HTML5 <code>&lt;video&gt;</code> element.  
    </video>
  </body>
</html> 
```

比我试图在浏览器中打开它，如：

```
file:///C:/videostreaming/video.html 
```

我在 chrome 示例中可以看到，有网络流量，正在下载流，但没有显示任何内容。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-03-19T19:04:52.570

您不能使用 VLC 通过 http 协议传输 mp4

按照此链接查看输出方法/复用器矩阵 [http://www.videolan.org/streaming-features.html](http://www.videolan.org/streaming-features.html)

但是，您可以尝试转码为 ogg。

尝试这个：

```
"c:\Program Files (x86)\VideoLAN\VLC\vlc.exe" \
-I dummy  dshow:// --dshow-vdev="Logitech QuickCam Chat" \
--dshow-adev=none --dshow-caching=0 \
--sout=#transcode{vcodec=theo,vb=1024,channels=1,ab=128,samplerate=44100,width=320}:http{dst=:8080/webcam.ogg} 
```

并在您的 html 视频标签中：

```
<source src="http://127.0.0.1:8080/webcam.ogg"/> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-02T15:36:29.817

尝试添加视频类型（type="video/mp4"）：

```
<video width="320" height="240" controls="controls">
      <source src="movie.mp4" type="video/mp4" />
      <source src="movie.ogg" type="video/ogg" />
      Your browser does not support the video tag.
    </video> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-25T17:11:23.387

你告诉 VLC 以 ​​TS 格式流式传输`mux=ts`这是你的问题，你需要在 mp4 中复用

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-08-11T19:07:59.803

对于直播，您应该使用以下内容

```
<video id="video" src="http://localhost:8181/stream" type="video/ogg; codecs=theora" autoplay="autoplay"/> 
```

更多在这里是[一个链接](https://ipcamtalk.com/threads/how-to-use-vlc-to-transcode-ip-video-to-an-html5-compatible-format.1371/)！

请注意：仅限视频类型“ogg”！

# .net - 如何将 SQL 查询重新写入 LINQ

> ID：11294839
> 
> 赞同：-3
> 
> 时间：2012-07-02T13:36:53.153
> 
> 标签：.net, linq, entity-framework

这是我的 MS SQL 查询（我将其用作存储过程）。我是 LINQ 的新手。我正在使用 .NET 框架 4.0 和实体框架。

查询 1

```
 SELECT SUM(PTS.Run1)AS Run1,SUM(PTS.Run2)AS Run2,
 SUM(PTS.Run3)AS Run3,SUM(PTS.Run4)AS Run4,SUM(PTS.Run6)AS Run6
,SUM(PTS.BallsFaced)AS BallsFaced 
     FROM PlayerTeamSeason PTS
     INNER JOIN Player P ON P.ID=PTS.PlayerId 
WHERE P.CrewId =89 and PTS.SeasonId=1 
```

**编辑 1**

我需要解决方案

*   MAX 值和 JOIN（请参考查询 1）

**编辑 2**

```
 from crew in Oritia_entities.Crews
       join P in Oritia_entities.Players on crew.ID equals P.CrewId
                                  //select new { P.ID, P.Matches };
       join PTS in Oritia_entities.PlayerTeamSeasons on P.ID equals PTS.PlayerId
        select new
       {
          TotalRuns = PTS.Run1 + PTS.Run2 + PTS.Run3 + PTS.Run4 + PTS.Run6
            ,
          Bowls = PTS.BallsFaced
                                  }; 
```

我已将查询重新写入 LINQ。但是我怎么能在这里使用 SUM。正如我在我的 sql 查询中所写

谢谢

VeeKeyBee

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T14:10:21.873

首先，跑——不要走——到[LINQPad.net](http://www.linqpad.net/)并给自己弄一份 LINQPad。此外，我建议您花 58 美元购买自动完成的高级版。

有一些快速教程以及大量示例代码可以真正帮助您开始查找等效的 LINQ 命令。

这是一个非常易于使用的程序，可让您快速运行和试验 LINQ，包括实际查询您的数据库。它还允许您运行代码甚至 SQL 查询，这对您的情况很有帮助，因为您可以在一个选项卡中打开 SQL 查询，同时在另一个选项卡中处理相应的 LINQ 查询。

其次，我在你的情况下开始的方式是输出。运行您的查询，查看输出是什么，然后尝试从中开发您的 LINQ 查询。我不认为尝试转换实际的 SQL 查询是最简单的方法，但它仍然可以为您提供一些指导。

您会发现 LINQ 实际上与 SQL 非常相似，并且第一种考虑它的方式是它是 SQL 的倒退。例如，`select`出现在 LINQ 的末尾。实际上，一旦您使用 LINQ 一段时间，您就会发现它是真正倒退的 SQL。

让我从一些帮助开始：

```
SELECT @playerID= ID  FROM Player WHERE crewid=@playerID 
```

在 LINQ 中：

```
int playerID = 1234;
var result = from player in Player
             where player.crewid == playerID
             select player.ID 
```

由于这是 EF，您可能会在 Player 前面拥有数据库上下文，但至少在 LINQPad 中（通过程序中的 EF 连接），您可以在将查询转移到生产代码之前开发查询。

这是一个使用 LinqPad 的示例，展示了如何连接到实体框架以及如何编写一些查询。请注意，有可用的样品。另请注意，我写了几个快速查询，可能会对您的查询有所帮助。

![在此处输入图像描述](../Images/817cf24763e5c6f76e97619fd35d4cc6.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T14:23:49.740

MSDN for SP 上返回多个结果集的文章。先谷歌。

[LINQ to SQL：返回多个结果集](http://blogs.msdn.com/b/swiss_dpe_team/archive/2008/02/04/linq-to-sql-returning-multiple-result-sets.aspx)

# nlp - 语义集群服务，如 flickr 标签集群

> ID：11294841
> 
> 赞同：1
> 
> 时间：2012-07-02T13:36:55.803
> 
> 标签：nlp, semantics, flickr, freebase

Flickr 通过其 API 提供标签集群，以帮助区分您在何种意义上使用标签。如果你输入“apple”，你会得到一个包含史蒂夫乔布斯、计算机等的集群，以及另一个包含水果、树木等的集群。

我注意到 Google 图片的行为方式类似，提供不同的图片集合，但我看不到 Google 提供了一个 API 来利用这一点。

是否有任何其他“集群标签”类型的服务可以帮助定义标签的含义，类似于 Flickr 提供的服务？例如，在 Freebase 中是否有类似的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T21:20:23.713

Freebase 或 Google 图片没有标签聚类 API。Freebase 和 Google 知识图谱中的每个主题都只有一个可能的含义，因此无需将模棱两可的标签聚集在一起。

但是，使用[Freebase Search API](http://wiki.freebase.com/wiki/ApiSearch)，您可以查找名称为“Apple”的每个主题，它会告诉您每个匹配主题最显着的类型是什么，如下所示：

过滤器=（全名{全名}：苹果）

[试试看](https://www.googleapis.com/freebase/v1/search?filter=%28all%20name%7Bfull%7D%3aapple%29&indent=true)

# delphi - 新的 TFrame 和 TDataModule 使 Delphi IDE 崩溃

> ID：11294842
> 
> 赞同：0
> 
> 时间：2012-07-02T13:36:56.123
> 
> 标签：delphi, stack-overflow, frames, delphi-2006, datamodule

这是我遇到的问题：

在 BDS 2006 IDE 中工作，我的旧电脑不见了，新的（i7 mount）已经建成，它有 Windows 7 Ult OS 64 位，安装了 2006 和 QuickReports Pro 以及 eDocEngine、FIB+、TMS、LMD、ZEOS 和 DB 比较器组件包 - 我在我的产品中使用它们。

在计算机上，我也安装了 Office 2010，默认为 32 位版本和 Adob​​e CS6。就是这样。

安装后我尝试了几次重新安装 RAD 2009，无论如何，总是同样的问题，为了简化它是 100% 可重现的：

*   创建新的 Delphi VCL Forms 应用程序；
*   单击文件/新建/其他并转到，例如“Delphi 文件”并选择`Frame`或`DataModule`。创建新文件时，我们一直有消息：

**“堆栈溢出 - 保存您的工作并重新启动 Delphi for Microsoft Windows”**

之后 IDE 设置为错误状态，然后按 F12（显示 VCL 设计器）关闭 Delphi 并出现一般错误。

知道会发生什么吗？

正如我所说，我尝试了几次卸载 - 安装 2006，以任何个性开始，使用/不使用来自 Andy 网站的任何更新或 IDE 修复，没有任何帮助。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T18:11:58.573

您可以尝试在调试器中运行 IDE 的第二个实例。

1.  创建一个空的 dll 或包项目。
2.  打开运行 > 参数
3.  将宿主应用程序设置为 $(BDS)\bin\BDS.exe

然后只需`F9`在调试器中运行 IDE 的第二个实例。之后，只需按照步骤重现问题并等待异常。如果一切顺利，您将获得一个完整的调用堆栈来逐步执行。

注意：您可能会看到加载 IDE 时发生的各种其他异常。这些都是正常的，通常可以忽略。

此外，您没有提及旧机器上的 Windows 版本。如果是 Windows XP Uwe 可能是对的。默认情况下，XP 的安全性比 Vista 或 7 稍微宽松一些。新的默认设置是限制对`Program Files`. 如果这是问题所在，您可以为您用于开发的任何用户帐户调整 $(BDS) 的写入权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-10T13:00:05.033

删除 Embarcadero 注册表项中的 de PackageCache。它不是一个完整的解决方案，但对我有用。

从这里得到：http: [//qc.embarcadero.com/wc/qcmain.aspx](http://qc.embarcadero.com/wc/qcmain.aspx?d=118669) ?d=118669 （最后一个答案）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T14:45:11.510

我手头没有 BDS 2006，但新项目的默认文件夹是否可能位于 Program Files 文件夹下方？在这种情况下，可能没有对该文件夹的写访问权。

# c - '\0' 的 ASCII 值是否与 0 的 ASCII 值相同？

> ID：11294850
> 
> 赞同：6
> 
> 时间：2012-07-02T13:37:24.923
> 
> 标签：c

我了解到 '\0' 的 ASCII 值是 0，而 0 的 ASCII 值是 0x30，但是当我尝试使用 printf 打印它们的 ASCII 值时，我得到了相同的输出：

```
printf("\'\\0\' : %d\n", '\0');
printf("\'\\0\' in hex : %x\n", '\0');
printf("0 : %d\n", 0);
printf("0 in hex: %x\n", 0); 
```

输出：

```
'\0' : 0
'\0' in hex : 0
0 : 0
0 in hex: 0 
```

为什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-02T13:40:20.590

ASCII 字符`'0'`与数字不同`0`。`0`您正在第二对s中打印整数，`printf`而不是`'0'`.

尝试这个：

```
printf("'\\0' : %d\n", '\0');
printf("'\\0' in hex : %x\n", '\0');
printf("'0' : %d\n", '0');
printf("'0' in hex: %x\n", '0'); 
```

此外，您不需要`'`在字符串中转义。也就是说，`"'"`很好，你不需要写`"\'"`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-02T13:40:57.167

你混淆了 0、'\0' 和 '0'。

其中前两个是相同的。它们只代表`int`值为 0 的值。

然而，'0' 是不同的，它表示`int`具有 '0' 字符的值的一个，即`48`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-02T14:14:46.683

是的，字符文字`'\0'`具有价值`0`，这与字符集无关。

> (K&R2, 2.3) "字符常量'\0'表示值为零的字符，即空字符。'\0'通常写成而不是0，以强调某些表达式的字符性质，但数值只是0 。”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-02T13:41:44.730

```
printf("0 : %d\n", '0'); 
```

像这样打印，你会得到 48。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-02T22:11:05.493

所有这些答案似乎都忽略了`\0`...

尝试这个：

```
printf("This line\0 might not completely appear"); 
```

这就是原因`\0`

所以你可以定义一个 NULL 终止的字符串......

```
#define TEST_STRING "Test" 
```

与

```
#define TEST_STRING "Test\0" 
```

后者在某些情况下很有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-02T13:39:45.033

'\0' 的 ASCII 值确实是 0。但 '\0' 与 '0' 不同（注意反斜杠，它是转义符号）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-02T13:41:51.953

你的最后一行应该是

```
printf("0 in hex: %x\n", '0'); 
```

# android - 如何在 Android 中高效地存储位图？

> ID：11294854
> 
> 赞同：2
> 
> 时间：2012-07-02T13:37:39.790
> 
> 标签：android, caching, bitmap, jpeg, store

我正在构建一个相对基本的新闻阅读器应用程序，该应用程序涉及在自定义列表视图中显示新闻（图像 + 标题 + 每个列表元素的简短描述）。

我的问题是如何存储从服务器下载的图像，然后将它们附加到列表视图？图像相对较小，通常为 200 X 200，采用 .jpeg 格式。

与其说是“如何有效地做到这一点”，不如说是“如何有效地做到这一点”的问题，因为我已经注意到低端手机在使用默认的“ic_launcher”图标而不是位图时会出现滞后。

当应用程序启动并同步新闻或缓存它们时，将它们作为文件存储或与其他新闻数据一起存储到新闻数据库中会更快吗？

我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T14:50:23.893

更好的是，您可以通过 ImageManager 类使用 SoftReference。

在您的 ListAdpater getView() 方法中调用 ImageManager 的 displayImage() 方法。

ImageManager 编码示例：

```
public class ImageManagerExemple {

private static final String LOG_TAG = "ImageManager";

private static ImageManagerExemple instance = null;

public static ImageManagerExemple getInstance(Context context) {
    if (instance == null) {
        instance = new ImageManagerExemple(context);
    } 
    return instance;        
}   

private HashMap<String, SoftReference<Bitmap>> imageMap = new HashMap<String, SoftReference<Bitmap>>();

private Context context;
private File cacheDir;

private ImageManagerExemple(Context context) {
    this.context = context;
    // Find the dir to save cached images
    String sdState = android.os.Environment.getExternalStorageState();
    if (sdState.equals(android.os.Environment.MEDIA_MOUNTED)) {
        File sdDir = android.os.Environment.getExternalStorageDirectory();      
        cacheDir = new File(sdDir,"data/yourappname");
    } else {
        cacheDir = context.getCacheDir();
    }
    if(!cacheDir.exists()) {
        cacheDir.mkdirs();
    }
}

/**
 * Display web Image loading thread
 * @param imageUrl picture web url
 * @param imageView target
 * @param imageWaitRef picture during loading
 */
public void displayImage(String imageUrl, ImageView imageView, Integer imageWaitRef) {
    String imageKey = imageUrl;     
    imageView.setTag(imageKey);
    if(imageMap.containsKey(imageKey) && imageMap.get(imageKey).get() != null) {
        Bitmap bmp = imageMap.get(imageKey).get();
        imageView.setImageBitmap(bmp);
    } else {
        queueImage(imageUrl, imageView);
        if(imageWaitRef != null)
            imageView.setImageResource(imageWaitRef);
    }
}

private void queueImage(String url, ImageView imageView) {
    ImageRef imgRef=new ImageRef(url, imageView);
    // Start thread
    Thread imageLoaderThread = new Thread(new ImageQueueManager(imgRef));
    // Make background thread low priority, to avoid affecting UI performance
    imageLoaderThread.setPriority(Thread.NORM_PRIORITY-1);
    imageLoaderThread.start();
}

private Bitmap getBitmap(String url) {
    String filename = String.valueOf(url.hashCode());
    File f = new File(cacheDir, filename);
    try {
        // Is the bitmap in our cache?
        Bitmap bitmap = BitmapFactory.decodeFile(f.getPath());
        if(bitmap != null) return bitmap;
        // Nope, have to download it
        bitmap = ImageServerUtils.pictureUrlToBitmap(url);
        // save bitmap to cache for later
        writeFile(bitmap, f);
        return bitmap;
    } catch (Exception ex) {
        ex.printStackTrace();
        Log.e(LOG_TAG, ""+ex.getLocalizedMessage());
        return null;
    }  catch (OutOfMemoryError e) {
        Log.e(LOG_TAG, "OutOfMemoryError : "+e.getLocalizedMessage());
        e.printStackTrace();
        return null;
    }
}

private void writeFile(Bitmap bmp, File f) {
    if (bmp != null && f != null) {
        FileOutputStream out = null;

        try {
            out = new FileOutputStream(f);
            //bmp.compress(Bitmap.CompressFormat.PNG, 80, out);
            bmp.compress(Bitmap.CompressFormat.JPEG, 80, out);
        } catch (Exception e) {
            e.printStackTrace();
        }
        finally { 
            try { if (out != null ) out.close(); }
            catch(Exception ex) {} 
        }
    }
}

private class ImageRef {
    public String imageUrl;
    public ImageView imageView;

    public ImageRef(String imageUrl, ImageView i) {
        this.imageUrl=imageUrl;
        this.imageView=i;
    }
}

private class ImageQueueManager implements Runnable {
    private ImageRef imageRef;
    public ImageQueueManager(ImageRef imageRef) {
        super();
        this.imageRef = imageRef;
    }
    @Override
    public void run() {
        ImageRef imageToLoad = this.imageRef;
        if (imageToLoad != null) {
            Bitmap bmp = getBitmap(imageToLoad.imageUrl);
            String imageKey = imageToLoad.imageUrl;
            imageMap.put(imageKey, new SoftReference<Bitmap>(bmp));
            Object tag = imageToLoad.imageView.getTag();

            // Make sure we have the right view - thread safety defender
            if (tag != null && ((String)tag).equals(imageKey)) {
                BitmapDisplayer bmpDisplayer = new BitmapDisplayer(bmp, imageToLoad.imageView);                         
                Activity a = (Activity)imageToLoad.imageView.getContext();                          
                a.runOnUiThread(bmpDisplayer);
            } 
        } 
    }
}

//Used to display bitmap in the UI thread
private class BitmapDisplayer implements Runnable {
    Bitmap bitmap;
    ImageView imageView;

    public BitmapDisplayer(Bitmap b, ImageView i) {
        bitmap=b;
        imageView=i;
    }
    @Override
    public void run() {
        if(bitmap != null) {
            imageView.setImageBitmap(bitmap);
        } 
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T14:04:21.420

让 ListView 平滑滚动而不会出现卡顿的技巧是在用户滚动时不要以任何方式、形状或形式对其进行更新。Afaik，这本质上是 iOS 设法使其 ListViews 流畅的方式：它不允许用户对其进行任何更改（以及一般的 UI）。

只需注释掉任何更改您的 ListView 的代码，同时保持所有位图加载代码不变，您会发现在后台实际加载位图并不会真正影响性能。问题是 UI 线程无法同时跟上视图更新和滚动。

`OnScrollListener`您可以通过在用户滚动时阻止对 ListView 的所有更新来实现相同的目的。一旦用户停止，您就可以潜入所有待处理的更新。为了提高性能，尽量不要使用`notifyDataSetChanged`但迭代 ListView 的视图，只更新实际更改的视图。

# gwt - GWT - 构造一个新的 ImageData / Bitmap

> ID：11294855
> 
> 赞同：0
> 
> 时间：2012-07-02T13:37:40.167
> 
> 标签：gwt, bitmap, html5-canvas

我希望创建一个新的空位图，手动在其上绘制，然后才将其绘制到画布上。

此位图不应基于任何现有图像或现有画布。

有没有办法在 GWT 中创建这样的位图？我能找到的最佳解决方案是创建一个虚拟画布，然后通过 context2d 获取其 ImageData。我简直不敢相信这是正确的方法。

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-02T14:21:22.567

请注意，由于限制，您的应用不会在谷歌应用引擎上运行。

[JRE GAE 白名单](https://developers.google.com/appengine/docs/java/jrewhitelist)

# r - R的pscl包

> ID：11294857
> 
> 赞同：4
> 
> 时间：2012-07-02T13:37:46.653
> 
> 标签：r, graphics, pscl

我在 pscl 包中运行总统选举的 xyplot 并得到了错误

```
data(presidentialElections)
library(lattice)
xyplot(demVote ~ year | state,
       panel=panel.lines,
       ylab="Democratic Vote for President (percent)",
       xlab="Year",
       data=presidentialElections,
       scales=list(y=list(cex=.6),x=list(cex=.35)),
       strip=strip.custom(par.strip.text=list(cex=.6)))

Error:
Error in recordGraphics(drawGrob(x), list(x = x), getNamespace("grid")) :
  invalid graphics state 
```

我是 R 的新用户，如果有人可以帮助我解决错误，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-03T13:56:24.020

尝试`dev.off()`然后重新运行相同的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T14:37:16.757

我个人使用 tinn r 在 R 中编程，发现它非常有用，您可以轻松关闭/打开 R，仍然可以发送命令行。（您甚至可以 DL 不同版本的 R 加载不同的包）

# opencv - 如何在 OpenCV 中定义分水岭的标记？

> ID：11294859
> 
> 赞同：75
> 
> 时间：2012-07-02T13:37:56.003
> 
> 标签：opencv, image-processing, computer-vision, image-segmentation, watershed

我正在使用 OpenCV 为 Android 写作。我正在使用标记控制的分水岭分割类似于下面的图像，而无需用户手动标记图像。我打算使用区域最大值作为标记。

`minMaxLoc()`会给我价值，但我怎样才能将它限制在我感兴趣的斑点上？我可以利用来自`findContours()`或 cvBlob blobs 的结果来限制 ROI 并将最大值应用于每个 blob 吗？

![输入图像](../Images/963754be34977dde54b9a32ee9b09b17.png)

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2013-01-31T02:15:01.920

首先：该函数`minMaxLoc`仅找到给定输入的全局最小值和全局最大值，因此对于确定区域最小值和/或区域最大值几乎没有用处。但是您的想法是正确的，基于区域最小值/最大值提取标记以执行基于标记的分水岭变换是完全可以的。让我试着澄清一下什么是分水岭变换，以及你应该如何正确使用 OpenCV 中的实现。

一些涉及分水岭的论文的描述与以下类似（如果您不确定，我可能会错过一些细节：问）。考虑您知道的某个区域的表面，它包含山谷和山峰（以及其他与我们无关的细节）。假设在这个表面之下你只有水，有颜色的水。现在，在你表面的每个山谷打洞，然后水开始填满整个区域。在某些时候，不同颜色的水会相遇，当这种情况发生时，你会建造一座水坝，使它们不会相互接触。最后你有一个水坝的集合，这是分隔所有不同颜色的水的分水岭。

现在，如果你在那个表面上打了太多的洞，你最终会得到太多的区域：过度分割。如果你做的太少，你会得到一个细分不足。因此，几乎所有建议使用分水岭的论文实际上都提出了避免该论文处理的应用程序出现这些问题的技术。

我写了所有这些（对于任何知道分水岭转换的人来说可能太天真了），因为它直接反映了你应该如何使用分水岭实现（当前接受的答案是以完全错误的方式做的）。现在让我们从使用 Python 绑定的 OpenCV 示例开始。

问题中呈现的图像由许多物体组成，这些物体大多靠得太近，在某些情况下重叠。分水岭在这里的用处是正确地分离这些对象，而不是将它们组合成单个组件。因此，每个对象至少需要一个标记，背景需要好的标记。例如，首先通过 Otsu 对输入图像进行二值化，然后执行形态学打开以去除小物体。此步骤的结果如下左图所示。现在对于二值图像，考虑对其应用距离变换，结果如右图。

![在此处输入图像描述](../Images/610455c5bb0b3a708609bbef3434fd4a.png) ![在此处输入图像描述](../Images/99ef19079510b88a3fa3f1c42d582431.png)

通过距离变换结果，我们可以考虑一些阈值，以便我们只考虑距离背景最远的区域（下图左）。这样做，我们可以通过在较早的阈值之后标记不同的区域来获得每个对象的标记。现在，我们还可以考虑上面左图的放大版本的边框来组成我们的标记。完整的标记如下右图所示（有些标记太暗而无法看到，但左图中的每个白色区域都显示在右图中）。

![在此处输入图像描述](../Images/170396e3d30b7aa5f1cea269f115b9fb.png) ![在此处输入图像描述](../Images/6ccfc1bf1f29f787852156c16a7a3b01.png)

我们这里的这个标记很有意义。每个都`colored water == one marker`将开始填充该区域，流域转换将建造水坝以阻止不同的“颜色”融合。如果我们进行变换，我们会得到左边的图像。通过将它们与原始图像组合来仅考虑水坝，我们得到了正确的结果。

![在此处输入图像描述](../Images/a1faf22bf2d3e8b401efa36e95690df0.png) ![在此处输入图像描述](../Images/450611962bf1577e6e73b8fab5297684.png)

```
import sys
import cv2
import numpy
from scipy.ndimage import label

def segment_on_dt(a, img):
    border = cv2.dilate(img, None, iterations=5)
    border = border - cv2.erode(border, None)

    dt = cv2.distanceTransform(img, 2, 3)
    dt = ((dt - dt.min()) / (dt.max() - dt.min()) * 255).astype(numpy.uint8)
    _, dt = cv2.threshold(dt, 180, 255, cv2.THRESH_BINARY)
    lbl, ncc = label(dt)
    lbl = lbl * (255 / (ncc + 1))
    # Completing the markers now. 
    lbl[border == 255] = 255

    lbl = lbl.astype(numpy.int32)
    cv2.watershed(a, lbl)

    lbl[lbl == -1] = 0
    lbl = lbl.astype(numpy.uint8)
    return 255 - lbl

img = cv2.imread(sys.argv[1])

# Pre-processing.
img_gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)    
_, img_bin = cv2.threshold(img_gray, 0, 255,
        cv2.THRESH_OTSU)
img_bin = cv2.morphologyEx(img_bin, cv2.MORPH_OPEN,
        numpy.ones((3, 3), dtype=int))

result = segment_on_dt(img, img_bin)
cv2.imwrite(sys.argv[2], result)

result[result != 255] = 0
result = cv2.dilate(result, None)
img[result == 255] = (0, 0, 255)
cv2.imwrite(sys.argv[3], img) 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-07-11T17:30:18.520

我想在这里解释一个关于如何使用分水岭的简单代码。我正在使用 OpenCV-Python，但我希望你不会有任何理解困难。

在这段代码中，我将使用分水岭作为**前景-背景提取的工具。**（此示例是 OpenCV 食谱中 C++ 代码的 Python 对应物）。这是一个理解分水岭的简单案例。除此之外，您可以使用分水岭来计算此图像中的对象数量。这将是此代码的稍微高级的版本。

**1** - 首先我们加载我们的图像，将其转换为灰度，并使用合适的值对其进行阈值处理。我采用了**Otsu 的二值化**，因此它会找到最佳阈值。

```
import cv2
import numpy as np

img = cv2.imread('sofwatershed.jpg')
gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)
ret,thresh = cv2.threshold(gray,0,255,cv2.THRESH_BINARY+cv2.THRESH_OTSU) 
```

下面是我得到的结果：

![在此处输入图像描述](../Images/52aaf41ba4a7bd81ec9cf0ab39be8daa.png)

（即使结果很好，因为前景和背景图像之间的对比度很大）

2 - 现在我们必须创建标记。**标记是与原始图像大小相同的图像，即 32SC1（32 位有符号单通道）。**

现在，原始图像中会有一些区域，您可以确定该部分属于前景。在标记图像中用 255 标记这样的区域。现在你确定是背景的区域用128标记。你不确定的区域用0标记。这是我们接下来要做的。

**A - 前景区域**：- 我们已经得到了一个阈值图像，其中药丸是白色的。我们稍微侵蚀它们，以便我们确定剩余区域属于前景。

```
fg = cv2.erode(thresh,None,iterations = 2) 
```

**FG**：

![在此处输入图像描述](../Images/293f121e8cc02b8a80e3865b7ce87e31.png)

**B - 背景区域**：- 这里我们扩大阈值图像，以减少背景区域。但我们确信剩余的黑色区域是 100% 背景。我们将其设置为 128。

```
bgt = cv2.dilate(thresh,None,iterations = 3)
ret,bg = cv2.threshold(bgt,1,128,1) 
```

现在我们得到**bg**如下：

![在此处输入图像描述](../Images/6580c3077a8d00bd44ae04cb042caa25.png)

**C - 现在我们添加 fg 和 bg**：

```
marker = cv2.add(fg,bg) 
```

下面是我们得到的：

![在此处输入图像描述](../Images/93950f411bad5291c5c511c184da3fd7.png)

现在我们可以从上图中清楚地看出，白色区域是 100% 前景，灰色区域是 100% 背景，黑色区域我们不确定。

然后我们将其转换为 32SC1 ：

```
marker32 = np.int32(marker) 
```

3 - 最后我们**应用分水岭**并将结果转换回**uint8**图像：

```
cv2.watershed(img,marker32)
m = cv2.convertScaleAbs(marker32) 
```

**米：**

![在此处输入图像描述](../Images/17b9e989ebf9f1782c9c3c82ac82f32b.png)

**4** -**我们对它进行适当的阈值化以获得掩码并`bitwise_and`使用输入图像执行：**

```
ret,thresh = cv2.threshold(m,0,255,cv2.THRESH_BINARY+cv2.THRESH_OTSU)
res = cv2.bitwise_and(img,img,mask = thresh) 
```

**资源：**

![在此处输入图像描述](../Images/e847a0c22662e2bc20928e81a7c7f49a.png)

希望能帮助到你！！！

方舟

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-06-22T20:03:16.487

**前言**

我之所以加入，主要是因为我发现[OpenCV 文档](https://docs.opencv.org/3.3.1/d3/db4/tutorial_py_watershed.html)（和[C++ 示例](https://docs.opencv.org/3.3.1/d8/da9/watershed_8cpp-example.html#a33)）中的分水岭教程以及[上面 mmgp 的答案](https://stackoverflow.com/a/14617359/84873)都非常令人困惑。我多次重新审视分水岭方法，最终因沮丧而放弃。我终于意识到我至少需要尝试一下这种方法并看到它的实际效果。这是我整理了我遇到的所有教程后想出的。

除了作为计算机视觉新手之外，我的大部分麻烦可能与我使用 OpenCVSharp 库而不是 Python 的要求有关。C# 没有像 NumPy 中那样内置的高功率数组运算符（尽管我意识到这是通过 IronPython 移植的），所以我在理解和在 C# 中实现这些操作方面都遇到了很多困难。另外，郑重声明，我真的很鄙视这些函数调用中的细微差别和不一致之处。OpenCVSharp 是我用过的最脆弱的库之一。但是，嘿，这是一个港口，所以我在期待什么？最重要的是——它是免费的。

事不宜迟，让我们谈谈我对分水岭的 OpenCVSharp 实现，并希望在总体上阐明分水岭实现的一些棘手点。

**应用**

首先，确保分水岭是您想要的并了解它的用途。我正在使用染色的细胞板，比如这个：

[![在此处输入图像描述](../Images/82125ccdf64700309613c0c6f9839460.png)](https://i.stack.imgur.com/lWjoD.png)

我花了很长时间才弄清楚我不能只打一个分水岭来区分该领域的每个细胞。相反，我首先必须隔离一部分字段，然后在这小部分上调用分水岭。我通过一些过滤器隔离了我的感兴趣区域（ROI），我将在这里简要解释一下：

[![在此处输入图像描述](../Images/a3befac0def471d3a4b16a49a8224280.png)](https://i.stack.imgur.com/lNUBB.png)

1.  从源图像开始（左，为演示目的裁剪）
2.  隔离红色通道（左中）
3.  应用自适应阈值（右中）
4.  找到轮廓然后消除那些具有小区域的轮廓（右）

一旦我们清理了上述阈值操作产生的轮廓，就该寻找分水岭的候选者了。就我而言，我只是遍历了所有大于某个区域的轮廓。

**代码**

假设我们已经从上述字段中分离出这个轮廓作为我们的 ROI：

[![在此处输入图像描述](../Images/62c50031a5ff3f020bb341cd0734c766.png)](https://i.stack.imgur.com/i2NA5.png)

让我们看看我们将如何编写分水岭。

我们将从一个空白垫子开始，只绘制定义我们 ROI 的轮廓：

```
var isolatedContour = new Mat(source.Size(), MatType.CV_8UC1, new Scalar(0, 0, 0));
Cv2.DrawContours(isolatedContour, new List<List<Point>> { contour }, -1, new Scalar(255, 255, 255), -1); 
```

为了使分水岭调用起作用，它需要一些关于投资回报率的“提示”。如果您像我一样是一个完整的初学者，我建议您查看[CMM 分水岭页面](http://cmm.ensmp.fr/~beucher/wtshed.html)以快速入门。可以说我们将通过在右侧创建形状来在左侧创建有关 ROI 的提示：

[![在此处输入图像描述](../Images/7a477ce40ca99c64c5a2d7d8ba22d575.png)](https://i.stack.imgur.com/bnQym.png)

要创建此“提示”形状的白色部分（或“背景”），我们将`Dilate`像这样创建孤立的形状：

```
var kernel = Cv2.GetStructuringElement(MorphShapes.Ellipse, new Size(2, 2));
var background = new Mat();
Cv2.Dilate(isolatedContour, background, kernel, iterations: 8); 
```

要在中间（或“前景”）创建黑色部分，我们将使用距离变换后跟阈值，它将我们从左侧的形状带到右侧的形状：

[![在此处输入图像描述](../Images/4872b8e9bbc1aa92e49b760305ce0df6.png)](https://i.stack.imgur.com/6pq7k.png)

这需要几个步骤，您可能需要调整阈值的下限以获得适合您的结果：

```
var foreground = new Mat(source.Size(), MatType.CV_8UC1);
Cv2.DistanceTransform(isolatedContour, foreground, DistanceTypes.L2, DistanceMaskSize.Mask5);
Cv2.Normalize(foreground, foreground, 0, 1, NormTypes.MinMax); //Remember to normalize!

foreground.ConvertTo(foreground, MatType.CV_8UC1, 255, 0);
Cv2.Threshold(foreground, foreground, 150, 255, ThresholdTypes.Binary); 
```

然后我们将减去这两个垫子，得到我们的“提示”形状的最终结果：

```
var unknown = new Mat(); //this variable is also named "border" in some examples
Cv2.Subtract(background, foreground, unknown); 
```

同样，如果我们`Cv2.ImShow` *unknown*，它看起来像这样：

[![在此处输入图像描述](../Images/e83955092c8e5f1f2d2bb29dc738db35.png)](https://i.stack.imgur.com/ASLF2.png)

好的！这对我来说很容易缠住我的头。然而，下一部分让我很困惑。让我们看看将我们的“提示”变成`Watershed`函数可以使用的东西。为此，我们需要使用`ConnectedComponents`，它基本上是一个根据索引分组的大像素矩阵。例如，如果我们有一个带有字母“HI”的垫子，`ConnectedComponents`可能会返回这个矩阵：

```
0 0 0 0 0 0 0 0 0
0 1 0 1 0 2 2 2 0
0 1 0 1 0 0 2 0 0 
0 1 1 1 0 0 2 0 0
0 1 0 1 0 0 2 0 0
0 1 0 1 0 2 2 2 0
0 0 0 0 0 0 0 0 0 
```

所以，0是背景，1是字母“H”，2是字母“I”。（如果您到了这一点并想要可视化您的矩阵，我建议您查看[这个有启发性的答案](https://stackoverflow.com/a/46442154/84873)。）现在，我们将使用`ConnectedComponents`以下方法为分水岭创建标记（或标签）：

```
var labels = new Mat(); //also called "markers" in some examples
Cv2.ConnectedComponents(foreground, labels);
labels = labels + 1;

//this is a much more verbose port of numpy's: labels[unknown==255] = 0
for (int x = 0; x < labels.Width; x++)
{
    for (int y = 0; y < labels.Height; y++)
    {
        //You may be able to just send "int" in rather than "char" here:
        var labelPixel = (int)labels.At<char>(y, x);    //note: x and y are inexplicably 
        var borderPixel = (int)unknown.At<char>(y, x);  //and infuriatingly reversed

        if (borderPixel == 255)
            labels.Set(y, x, 0);
    }
} 
```

请注意，分水岭函数要求边界区域用 0 标记。因此，我们在标签/标记数组中将任何边界像素设置为 0。

在这一点上，我们应该都准备好调用了`Watershed`。但是，在我的特定应用程序中，仅在此调用期间可视化整个源图像的一小部分很有用。这对您来说可能是可选的，但我首先通过扩展它来掩盖一小部分源：

```
var mask = new Mat();
Cv2.Dilate(isolatedContour, mask, new Mat(), iterations: 20);
var sourceCrop = new Mat(source.Size(), source.Type(), new Scalar(0, 0, 0));
source.CopyTo(sourceCrop, mask); 
```

然后打个神奇的电话：

```
Cv2.Watershed(sourceCrop, labels); 
```

**结果**

上面的`Watershed`调用将`labels` *就地*修改。您必须回过头来记住由`ConnectedComponents`. 这里的区别是，如果分水岭在分水岭之间发现任何水坝，它们将在该矩阵中标记为“-1”。与`ConnectedComponents`结果一样，不同的分水岭将以类似的递增数字方式进行标记。出于我的目的，我想将它们存储到单独的轮廓中，所以我创建了这个循环来拆分它们：

```
var watershedContours = new List<Tuple<int, List<Point>>>();

for (int x = 0; x < labels.Width; x++)
{
    for (int y = 0; y < labels.Height; y++)
    {
        var labelPixel = labels.At<Int32>(y, x); //note: x, y switched 

        var connected = watershedContours.Where(t => t.Item1 == labelPixel).FirstOrDefault();
        if (connected == null)
        {
            connected = new Tuple<int, List<Point>>(labelPixel, new List<Point>());
            watershedContours.Add(connected);
        }
        connected.Item2.Add(new Point(x, y));

        if (labelPixel == -1)
            sourceCrop.Set(y, x, new Vec3b(0, 255, 255));

    }
} 
```

然后，我想用随机颜色打印这些轮廓，所以我创建了以下垫子：

```
var watershed = new Mat(source.Size(), MatType.CV_8UC3, new Scalar(0, 0, 0));
foreach (var component in watershedContours)
{
    if (component.Item2.Count < (labels.Width * labels.Height) / 4 && component.Item1 >= 0)
    {
        var color = GetRandomColor();
        foreach (var point in component.Item2)
            watershed.Set(point.Y, point.X, color);
    }
} 
```

显示时会产生以下结果：

[![在此处输入图像描述](../Images/837ce116c31fbb537fa6e13d32c0f359.png)](https://i.stack.imgur.com/TGIjs.png)

如果我们在源图像上绘制之前用 -1 标记的水坝，我们会得到：

[![在此处输入图像描述](../Images/63f2407adfd2df586b84488865872460.png)](https://i.stack.imgur.com/qQnuZ.png)

**编辑：**

我忘了注意：确保你在用完垫子后清理它们。它们将留在内存中，OpenCVSharp 可能会出现一些难以理解的错误消息。我真的应该在`using`上面使用，但`mat.Release()`也是一种选择。

此外，上面 mmgp 的答案包括这一行：`dt = ((dt - dt.min()) / (dt.max() - dt.min()) * 255).astype(numpy.uint8)`，这是应用于距离变换结果的直方图拉伸步骤。出于多种原因，我省略了这一步（主要是因为我不认为我看到的直方图太窄而无法开始），但你的里程可能会有所不同。

# ios - 如何为 armv7 构建 V8

> ID：11294861
> 
> 赞同：2
> 
> 时间：2012-07-02T13:37:58.580
> 
> 标签：ios, arm, v8

我正在尝试在我的 iPhone 应用程序中使用 Google 的 v8。如谷歌网站所述，我使用“make arm”构建了这些库。不幸的是，我收到几个链接器错误，告诉我该库是为“存档”而构建的。

终端告诉我图书馆的架构是 i386：

```
lipo -info  libv8_base.a
input file libv8_base.a is not a fat file
Non-fat file: libv8_base.a is architecture: i386 
```

那么，我该如何构建一个 armv7 库呢？

顺便说一句：我对这个图书馆建设的东西不太了解。也许我只能在实际的 ARM 设备上为 ARM 构建？我不明白为什么我也不能在任何地方下载预建文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T15:10:44.453

[您可以在v8 wiki](http://code.google.com/p/v8/wiki/CrossCompilingForARM)上找到针对 ARM 进行交叉编译的说明。

在 x86 机器上运行时

```
make arm 
```

构建一个模拟器，而不是一个实际的 ARM 二进制文件。

如果你有 ARM 硬件，你也可以本地编译一个发布 shell：

```
scons arch=arm -j2 
```

编辑：
您可能还想了解[cross-compilation](http://en.wikipedia.org/wiki/Cross_compiler)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-21T00:44:41.297

在 v8 源代码中内置了一个 armv7 模拟器。如果你检查 v8/src/arm/ 你会发现模拟器文件。要构建，请确保您的 CC、CXX 和 LINK 指向本机 gcc / g++ 工具。然后做

```
Make arm.release -j8 
```

这将用于 arm 并查看 *.gypi 文件以获取更多构建选项。希望这是有用的。

# powershell - 合并不同目录中的同名 .txt 文件？

> ID：11294862
> 
> 赞同：2
> 
> 时间：2012-07-02T13:37:59.010
> 
> 标签：powershell, text, merge, command-prompt

我有一个文件夹，里面装满了过去日期的子文件夹（`20120601`例如），每个日期文件夹内都有一个名为 的文件`test.txt`，以及另一个名为`example.txt`. 如何将所有`test.txt`文件合并为一个？

我正在尝试在 Windows 中执行此操作，并且可以访问 Windows PowerShell 和 Windows 命令处理器 ( `cmd.exe`)。最好的方法是什么？

我的层次结构看起来像这样：

```
\Data
     \20120601
           test.txt
           example.txt
     \20120602
           test.txt
           example.txt
     \20120603
           test.txt
           example.txt
     \20120604
           test.txt
           example.txt
     \20120605
           test.txt
           example.txt 
```

我想它是这样的

```
copy *\test.txt alltestfiles.txt 
```

那可能吗？您可以为目录指定通配符吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-02T14:18:46.700

相当容易，实际上：

```
Get-ChildItem \Data -Recurse -Include test.txt |
  Get-Content |
  Out-File -Encoding UTF8 alltestfiles.txt 
```

或更短：

```
ls \Data -r -i test.txt | gc | sc -enc UTF8 alltestfile.txt 
```

这将首先收集所有`test.txt`文件，然后读取它们的内容，最后将合并的内容写入新文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T14:14:12.817

列出所有文件。读取一个文件的内容并将其添加到组合文件中。像这样，

```
cd data
gci -Recurse | ? { -not $_.psIsContainer -and $_.name -like "test.txt"}
$files | % { Add-Content -Path .\AllTests.txt -Value (Get-Content $_.FullName) } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-11T06:55:42.127

一个简单的命令`cat path\**\* > target_single_file`也可以。

# c# - EF4 DBContext 和 MVC3。ObjectContext 实例已被释放，不能再用于需要连接的操作

> ID：11294866
> 
> 赞同：0
> 
> 时间：2012-07-02T13:38:09.900
> 
> 标签：c#, entity-framework

所以，我正在学习制作一个非常简单的 MVC + EF 页面。它应该将国家列表放入下拉列表中。我遇到了这个错误：

**用户代码未处理 ObjectDisposedException：ObjectContext 实例已被释放，不能再用于需要连接的操作。**

我以为我知道 DBContext 将被释放，所以我提取了字符串和数组 string[] 中的值。为什么我还是会遇到这个问题？

**查看.cshtml...**

```
<select id="register-country">
    @foreach (var country in ViewBag.Countries) { //******** ERROR HERE ********
        <option value="@country[0]">@country[1]</option> 
    }
</select> 
```

**控制器.cs ...**

```
public virtual ActionResult RegisterDialogPartial() {
    var csm = new CountryStateModelRepository();
    ViewBag.Countries = csm.GetCountries();
    return PartialView(MVC.Shared.Views._RegisterDialogPartial);
} 
```

**数据访问层...**

```
public class CountryStateModelRepository {
    public IQueryable<string[]> GetCountries() {
        using (var db = new CountryStateModelContainer()) {
            return db.Country.Select(r => new string[] { r.CountryISO3, r.CountryName });
        }
    }
    public IQueryable<string> GetCountryStates(string countryISO3) {
        using (var db = new CountryStateModelContainer()) {
            return db.CountryState.Filter(r => r.CountryISO3 == countryISO3.ToUpper()).Select(r=>r.CountryISO3).AsQueryable();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:43:38.387

我很确定 Entity Framework 和 LINQ 的工作方式是在枚举值之前不会执行查询（在这种情况下，直到您的视图才会发生）。如果您希望在函数调用时枚举值，请修改您的方法：

```
return db.Country.Select(r => new string[] { r.CountryISO3, r.CountryName }).AsEnumerable(); 
```

# java - JSF：HtmlPanelGroup 中孩子的 ID 不正确（忽略 HtmlPanelGroupId）

> ID：11294869
> 
> 赞同：1
> 
> 时间：2012-07-02T13:38:13.533
> 
> 标签：java, jsf

我想将带有 id 的标签和带有 id 的输入字段添加到具有自己的 id 的面板组（布局框）。我希望标签和输入字段具有以下 id： (viewid):(formid):(panelgroupid):(own id) 但不知何故 panelgroupid (fachlich1) 不会传递给孩子。

```
<form id="viewns_Z7_6PQJDK4JGD09F0I34QTLQH2015_:j_id_3" …&gt;
    <div id="viewns_Z7_6PQJDK4JGD09F0I34QTLQH2015_:j_id_3:fachlich1">
        <label id="viewns_Z7_6PQJDK4JGD09F0I34QTLQH2015_:j_id_3:label" for="viewns_Z7_6PQJDK4JGD09F0I34QTLQH2015_:j_id_3:value">Bla</label>
        <input id="viewns_Z7_6PQJDK4JGD09F0I34QTLQH2015_:j_id_3:value" type="text" value="Blubb34534" name="viewns_Z7_6PQJDK4JGD09F0I34QTLQH2015_:j_id_3:value">
    </div>
</form> 
```

任何线索我可能做错了什么？:(

谢谢你的帮助！

* * *

编辑：

我想创建自己的组件，该组件基本上由周围的 div + label + inputtext 组成。我从 HtmlPanelGroup 扩展并覆盖 encodeBegin 方法，在其中我将布局设置为块，设置面板组的 id，添加组件，之后我调用 super.encodeBegin：

```
public void encodeBeginn(FacesContext context)
{
    setLayout("block");
    setId(getId());

    HtmlOutputLabel label = new HtmlOutputLabel();
    label.setId("label");
    label.setFor("value");
    label.setValue(getLabel());
    getChildren().add(label);

    HtmlInputText text = new HtmlInputText();
    text.setId("value");
    text.setValue(getValue());
    getChildren().add(text);

    super.encodeBeginn(context)
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T13:59:06.453

只有[`NamingContainer`](http://docs.oracle.com/javaee/6/api/javax/faces/component/NamingContainer.html)接口的实现会将自己的 ID 添加到其子 ID 的前面。根据[javadoc](http://docs.oracle.com/javaee/6/api/javax/faces/component/NamingContainer.html)，它是以下组件：

> ### 所有已知的实现类：
> 
> [`HtmlDataTable`](http://docs.oracle.com/javaee/6/api/javax/faces/component/html/HtmlDataTable.html), [`HtmlForm`](http://docs.oracle.com/javaee/6/api/javax/faces/component/html/HtmlForm.html), [`UIData`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIData.html), [`UIForm`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIForm.html),[`UINamingContainer`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UINamingContainer.html)

由[`HtmlPanelGroup`](http://docs.oracle.com/javaee/6/api/javax/faces/component/html/HtmlPanelGroup.html)支持的`<h:panelGroup>`不在其中。在标准 JSF 中，只有`<h:dataTable>`实现`<h:form>`它。在标准 Facelets 中，也仅`<ui:repeat>`实现它（通过`UINamingContainer`）。

这根本不应该形成任何技术问题。如果您认为您的具体问题（您在问题中没有说明任何内容）是由此引起的，那么您可能已经找到了错误的原因，并且必须从不同的方向寻找具体问题的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T13:27:39.963

正如您在评论 BalusC 答案时提到的，可以让自定义组件实现 NamingContainer。我尝试了类似的方法，因为您的自定义组件基本上只是一个复合组件，您周围的 HtmlPanelGroup 将成为内部组合组件的 NamingContainer。

不过要小心，不要用其他名称覆盖 getFamily。这让我发疯了，直到我发现当你这样做时，JSF 找不到标准渲染器（向 HtmlPanelGroup 注册的渲染器）。

```
public class MyComponenten extends HtmlPanelGroup implements NamingContainer {

    public void encodeBeginn(FacesContext context){
        ...fill with components
        super.encodeBeginn(context);
    }
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:40:30.567

明确指定 id in`<h:form>` 并设置`prependId=false`in`h:form`

# jquery - 列表显示模板中的 HTTP 发布链接

> ID：11294876
> 
> 赞同：-3
> 
> 时间：2012-07-02T13:38:23.210
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-3

我有一个项目实体。项目列表显示在脚手架列表视图中，如下所示。Edit-Details-Delete 是模板生成的ActionLinks。每个都链接到一个新的控制器动作并加载另一个视图

```
ProjectName  | Created By | Created On | Status |
-------------|------------|------------|--------|--------------------
Test Project | USER1      | 12/31/2010 |  NEW   | Edit |Details |Delete 
```

每个项目都有一个状态——新建、批准、拒绝。我想向名为 Approve 和 Denied 的列表添加不加载视图的链接。他们只是改变了项目的状态。我相信这些将是 HTTP Post Links。我用谷歌搜索并没有找到一个很好的工作示例。

```
ProjectName  | Created By | Created On | Status |
-------------|------------|------------|--------|------------------------------------
Test Project | USER1      | 12/31/2010 |  NEW   | Edit |Details |Delete|Approve|Denied 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:42:10.333

您可以使用 AJAX：

```
@Ajax.ActionLink(
    "approve project", 
    "Approve", 
    new { projectId = item.ProjectId }, 
    new AjaxOptions { HttpMethod = "POST" }
) 
```

你当然会有一个相应的控制器动作来负责批准一个项目：

```
[HttpPost]
public ActionResult Approve(int projectId)
{
    ...
} 
```

您还可以使用`OnSuccess`和的`OnFailure`属性`AjaxOptions`来定义在发生这些事件时将调用的相应 javascript 函数。

需要说的是，要让`Ajax.*`帮助者做任何有用的事情，您需要将`jquery.unobtrusive-ajax.js`脚本包含到您的页面中：

```
<script type="text/javascript" src="@Url.Content("~/scripts/jquery.unobtrusive-ajax.js")"></script> 
```

并且必须在您的 web.config 中启用不显眼的 AJAX：

```
<appSettings>
    <add key="ClientValidationEnabled" value="true" />
    ...
</appSettings> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:44:04.407

`@Html.ActionLink`helper 方法为锚标记生成 HTML 标记，单击它们通常会执行**HTTPGET**方法。如果要执行**HTTPPOST**操作，您可以让`Html.ActionLink`帮助程序生成一个链接并使用 javascript，覆盖默认链接行为以执行`HTTPPost`另一个更改数据库状态的操作方法。您可以使用[preventDefault](http://api.jquery.com/event.preventDefault/)方法来阻止默认链接行为（导航新页面）

```
@Html.ActionLink("Approve","Approve","Project",new { @id="someid"},new { @class="delClass"})
@Html.ActionLink("Denied","Denied","Project",new { @id="someid",anotherParam="someval"},new { @class="delClass"})) 
```

假设您的控制器名称是`Project`.

有一些 jQuery 代码来覆盖默认链接行为并对`action`方法执行 AJAX 发布（HTTP Post）

```
<script type="text/javascript">
 $(function(){

    $(".delClass").click(function(e){

       e.preventDefault();  // prevent the default behaviour
       $.post(($this).attr("href"),function(data){
           //Do whatever with the resutl received from the action method call.
           //alert(data);  // may be alert ?
       });

    });

 });    
</script> 
```

现在有你的`Action`方法来处理这个

```
[HttpPost]
public ActionResult Approve(string id)
{
  //Do the backend transaction with the id value.

  return Content("Approved");
}
[HttpPost]
public ActionResult Denied(string id,string anotherParam)
{
  //Do the backend transaction with the parameters value.

  return Content("Denied");
} 
```

# .net - 我应该如何对只调用 FormsAuthentication.SetAuthCookie() 的方法进行单元测试？

> ID：11294882
> 
> 赞同：0
> 
> 时间：2012-07-02T13:38:58.040
> 
> 标签：.net, unit-testing, security

我的`Authentication`类中有以下由控制器调用的方法。我知道控制器可以调用`SetAuthCookie`自身，但我更喜欢额外的抽象。

```
public void FormsAuthSignIn(string loginName, bool rememberMe = false)
{
    FormsAuthentication.SetAuthCookie(loginName, rememberMe);
} 
```

只是在`FormsAuthentication`对象浏览器中查看显示没有我可以用来查看这是否有效的成员？我应该使用该属性构建一个测试控制器`Authorize`并在我的测试中调用它的方法吗？我应该在这里做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T15:49:31.450

我相信这里唯一要进行**单元测试**的是`SetAuthCookie`使用正确的参数调用的。你不需要 test`FormsAuthentication`的逻辑。

这可以通过隐藏`FormsAuthentication`在接口后面来实现，并为它实现自己的存根仅用于测试，这将计算对方法的调用。
任何模拟框架都可以帮助您完成这项任务，而 Moles / Typemock Isolator 等将允许您`SetAuthCookie`直接模拟。

除此之外，恕我直言，在这种情况下：

```
public class MyClass
{
    public int Foo()
    {
        return Bar();
    }

    private int Bar()
    {
        return BarInner();
    }

    private int BarInner()
    {
        return BarInnerer();
    }

    private int BarInnerer()
    {
        return 42;
    }
} 
```

只`Foo`应进行测试 - 所有其他方法都是**实现细节**。
与本例相同 - 应该对 的调用者进行测试`FormsAuthSignIn`，断言`FormsAuthSignIn`在正确的情况下调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T08:42:00.723

我同意@seldary 的回答，测试对静态方法的任何调用的一般方法是在您自己的类中抽象出该调用，并有一个接口。

但是如果你不想修改你的生产代码，还有另一种方法（可以说是不那么“纯粹”）：一些模拟框架使用黑客来解决这个确切的情况，允许你模拟对静态方法的调用。

以 PowerMock 为例：[http ://code.google.com/p/powermock/](http://code.google.com/p/powermock/)

这是一个使用它的教程：http: [//www.michaelminella.com/testing/how-to-mock-static-methods.html](http://www.michaelminella.com/testing/how-to-mock-static-methods.html)

（PS：我说“不那么纯粹”，因为 Powermock 正在使用类加载器，有时不被认为是对模拟的良好使用，尤其是伦敦的模拟者学校）

# google-maps - 与标记谷歌地图相关的信息窗口

> ID：11294889
> 
> 赞同：0
> 
> 时间：2012-07-02T13:39:48.393
> 
> 标签：google-maps, google-maps-api-3, marker, infowindow

我创建了代码来使用谷歌地图 V3 显示集群标记。问题在于`infowindow`每个标记。我认为这个错误是在循环的每次迭代中，重新初始化另一个标记的内容并只保存最后插入的内容。

这是我的尝试...

[http://www.ermes.net/user/loadscrolling/load_first.php](http://www.ermes.net/user/loadscrolling/load_first.php)

感谢帮助！

```
 <script type="text/javascript">

 function initialize() {
        var center = new google.maps.LatLng(37.4419, 9.1419);

        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 2,
          center: center,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        });
        var tweets = <?php echo json_encode($mapLocations); ?>;
        var markers = [];

<? for ($j=0; $j<count($resultArrayAd); $j++) { ?>
    var i=<?=$j++?>;
    var latLng = new google.maps.LatLng(parseFloat(<?=$resultArrayAd[$j]['Lat']?>),parseFloat(<?=$resultArrayAd[$j]['Lng']?>));

    <?  
    $userList2 = new user_account($resultArrayAd[$j]["user_id"]); 
    $user_avatar2=$userList2->get_avatar(); 
    $path2 =enleveaccents($user_avatar2->get_document_filename());
    $user_nick=enleveaccents($resultArrayAd[$j]["user_name"]);
    $user_id=$resultArrayAd[$j]['user_id'];
    $usr_details = new user_details($user_id);
    if (strlen($path2) > 0)  {
    $path_img= "/images/thumb_".$path2;
    } else {
    $path_img = "/img/avatar_profilo.jpg";
        } 
?>

    var contentString = '<table><tr><td width="350">'+
    '<a href="/user/<?=$user_id?>/<?=$user_nick?>.html" target="_top">'+
    '<img align=left width=100 height=65 border=0 src="<?=$path_img?>" hspace=4 vspace=2>'+
    '<font size=1 face=verdana><b><?=$user_nick?></b></font></a><br/>'+
    '<span style="color:#555555;font-size:12px;line-hieght:13px;">'+
    '<b>Indirizzo:</b><br/>' +
    '<b>Tel:</b> <br/>'+
    '</span>'+
    '<div class="clearBoth"></div></td></tr></table>'+
    '<div class="clearBoth"></div>';

var infowindow = new google.maps.InfoWindow({
        content: contentString
        });
        var marker = new google.maps.Marker({
        position: latLng,
        map: map,
        icon:"<?=$resultArrayAd[$j]['user_icon']?>",
        title:"<?=$user_nick?>",
    });

    google.maps.event.addListener(marker, 'click', function() {
    infowindow.open(map,marker);
        });
markers.push(marker);

<? } ?> 

        var markerCluster = new MarkerClusterer(map, markers);
      }
      google.maps.event.addDomListener(window, 'load', initialize);
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T10:39:17.480

我找到了解决这个错误的方法 ;-) 这是一个正确的代码..

```
 <script type="text/javascript">
 function initialize() {
        var center = new google.maps.LatLng(9.4419, 9.1419);

        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 2,
          center: center,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        var markers = [];
        // create the infowindow out of the for boucle
        var infoWindow = new google.maps.InfoWindow;

<? for ($j=0; $j<count($resultArrayAd); $j++) { ?>

var i=<?=$j++?>;
  var latLng = new google.maps.LatLng(parseFloat(<?=$resultArrayAd[$j]['Lat']?>),parseFloat(<?=$resultArrayAd[$j]['Lng']?>));   
    <?  
    $userList2 = new user_account($resultArrayAd[$j]["user_id"]); 
    $user_avatar2=$userList2->get_avatar(); 
    $path2 =enleveaccents($user_avatar2->get_document_filename());
    $user_nick=enleveaccents($resultArrayAd[$j]["user_name"]);
    $user_id=$resultArrayAd[$j]['user_id'];
    $usr_details = new user_details($user_id);
    if (strlen($path2) > 0)  {
    $path_img= "/images/thumb_".$path2;
    } else {
    $path_img = "/img/avatar_profilo.jpg";
        } 
?>
 var html = '<table><tr><td width="200">'+
    '<a href="/user/<?=$user_id?>/<?=$user_nick?>.html" target="_top">'+
    '<img align=left width=80 height=65 border=0 src="<?=$path_img?>" hspace=4 vspace=2>'+
    '<font size=1 face=verdana><b><?=$user_nick?></b></font></a><br/>'+
    '<span style="color:#555555;font-size:12px;line-hieght:13px;">'+
    '<b>Indirizzo:</b> <?=enleveaccents($usr_details->user_address);?><br/>' +
    '<b>Tel:</b> <?=enleveaccents($usr_details->user_phone);?><br/>'+
    '</span>'+
    '<div class="clearBoth"></div></td></tr></table>'+
    '<div class="clearBoth"></div>';

var marker = new google.maps.Marker({
        position: latLng,
        map: map,
        icon:"<?=$resultArrayAd[$j]['user_icon']?>",
        title:"<?=$user_nick?>",
    });
// call to the function....
bindInfoWindow(marker, map, infoWindow, html);
markers.push(marker);
<? } ?> 

// create a function bindInfoWindow

function bindInfoWindow(marker, map, infoWindow, html) {
      google.maps.event.addListener(marker, 'click', function() {
        infoWindow.setContent(html);
        infoWindow.open(map, marker);
      });
}

        var markerCluster = new MarkerClusterer(map, markers);
      }
      google.maps.event.addDomListener(window, 'load', initialize);
    </script> 
```

# web - 在所有 Tornado 处理程序中共享 write_error 方法？

> ID：11294891
> 
> 赞同：1
> 
> 时间：2012-07-02T13:39:52.547
> 
> 标签：web, tornado, handlers

我正在使用龙卷风，并且有一堆映射到不同网址的处理程序。例如 ：

```
#mainfile.py

#imports
#...
application = tornado.web.Application([
    (r"/", DefaultHandler),
    (r"/somepath", SomepathHandler),
], debug=True)

if __name__ == "__main__":
    tornado.options.parse_command_line()
    port = int(os.environ.get("PORT", 8001))
    application.listen(port)
    tornado.ioloop.IOLoop.instance().start() 
```

现在，在 DefaultHandler 和 SomepathHandler 中，我不喜欢错误消息的显示方式，所以我决定像这样覆盖 write_error 方法：

```
#DefaultHandler.py
class DefaultHandler(tornado.web.RequestHandler):

    def write_error(self, status_code, **kwargs):
        self.write("a nicer message")

    def initialize(self):
        #stuff
    def get(self):
        #more stuff, etc. 
```

进而

```
#Somepathhandler.py
class SomepathHandler(tornado.web.RequestHandler):
    def write_error(self, status_code, **kwargs):
        self.write("a nicer message") 
```

这肯定会继续与其他处理程序。我阅读了 Tornado 文档，似乎我应该是 subclassing `class tornado.web.RequestHandler(application, request, **kwargs)`，但没有成功地做到这一点。我不太确定课程应该去哪里，我怎样才能让它在我的应用程序中注册？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T03:54:49.027

你快到了。正如您所说，您只需要子类化`RequestHandler`. 该类可以放在任何文件中，只要您在需要的地方导入它。

```
class BaseHandler(tornado.web.RequestHandler):

    def write_error(self, status_code, **kwargs):
        self.write("a nicer message")

class DefaultHandler(BaseHandler):

    def initialize(self):
        pass

    def get(self):
        pass

class SomepathHandler(BaseHandler):
    pass 
```

# url - 黑莓中的身份验证用户名密码url

> ID：11294892
> 
> 赞同：0
> 
> 时间：2012-07-02T13:39:56.537
> 
> 标签：url, blackberry

我正在建立一个需要用户名和密码的站点的连接，但它没有连接，我不知道原因，你能帮我解决这个问题吗？

这是我正在使用的代码

```
 {
    HttpsConnection connection;
    connection = (HttpsConnection) Connector.open(url +
        getBlackBerryConnectionParams());

    connection.setRequestProperty("Authorization", "Basic" +
        new String(getEncode()));
 }                  

 public byte[] getEncode() {
    String login = "user:@@iPass";
    byte[] encoded = null;
    try {
        encoded = Base64OutputStream.encode(login.getBytes(), 0,
                login.length(), false, false);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return encoded;
} 
```

实际密码确实以“@@”开头，并且有一个大写字母

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T14:35:00.500

请尝试以下代码..

```
String URL = "URL"+methodName+parameterString+"deviceside=true";
connection = (HttpConnection) Connector.open(URL);
String authenticationParameter = "username"+":"+"password";
byte[] encoded = Base64OutputStream.encode(authenticationParameter.getBytes(), 0, authenticationParameter.length(), false, false);
connection.setRequestProperty("Authorization", "Basic "+ new String(encoded));
rc = connection.getResponseCode(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T06:28:17.893

我使用以下代码（不记得在哪里找到它）作为自定义 Ntlm 连接器实现的起点。它工作得很好。希望它可以帮助你。

```
package net;

import java.io.IOException;

import javax.microedition.io.Connector;
import javax.microedition.io.HttpConnection;
import javax.microedition.io.StreamConnection;

import net.rim.device.api.io.Base64OutputStream;

public class NtlmConnector implements IConnector {

    private String url;
    private String domain;
    private String username;
    private String password;

    public NtlmConnector(String url, String domain, String username, String password) {

        this.url = url;
        this.domain = domain;
        this.username = username;
        this.password  = password;
    }   

    private HttpConnection openAuthenticatedConnection() throws IOException {

        StreamConnection netStream = (StreamConnection)Connector.open(url);
        HttpConnection httpConnection = (HttpConnection)netStream;
        String credentials = domain + "\\" + username + ":" + password;         
        byte[] encodedCredentials = Base64OutputStream.encode(credentials.getBytes(), 0,     credentials.length(), false, false);
        httpConnection.setRequestProperty("Authorization", "Basic " + new String(encodedCredentials));

        return httpConnection;
    }

    private void mapResultToConnectionStatus(ConnectorResult result, int connectionStatus) {

        switch (connectionStatus) {
         case (HttpConnection.HTTP_OK):
            result.setConnectionDone(true);
            break;

        case (HttpConnection.HTTP_UNAUTHORIZED):
            result.setConnectionDone(false);
            //TODO: add detailed error
            break;

        default:
            result.setConnectionDone(false);
            break;
        }
    }

    public ConnectorResult connect() {

        ConnectorResult result = new ConnectorResult();

        try
        {
            HttpConnection connection = openAuthenticatedConnection();

            int responseStatus = connection.getResponseCode();

            connection.close();

            mapResultToConnectionStatus(result, responseStatus);

        }
        catch (IOException e)
        {
            //TODO: map into result error detail            
        }       

        return result;
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T00:35:21.563

我看到代码有几个*潜在*的问题。

首先，也是最简单的一个，您似乎在这一行中的“基本”一词之后缺少一个空格

```
connection.setRequestProperty("Authorization", "Basic" + 
    new String(getEncode())); 
```

更改`"Basic"`为`"Basic "`。

其次，您使用 url 将授权凭据传递给网络服务器。通常情况下，没关系。但是，另一种方法是等待网络服务器挑战您。如果你看这个线程：

[http://supportforums.blackberry.com/t5/Java-Development/HTTPS-Net-Web-Service-with-Basic-authentication/td-p/1615931](http://supportforums.blackberry.com/t5/Java-Development/HTTPS-Net-Web-Service-with-Basic-authentication/td-p/1615931)

请参阅 MSohm 的回复：

> 如果您使用的是 BlackBerry Enterprise Server（或 MDS-CS Simulator），请记住：
> 
> 使用抢先式身份验证时 BlackBerry MDS Connection Service 的问题

看起来，如果您的传输是 BES 或 MDS，那么这也可能会给您带来问题。如果您选择其他传输方式（例如直接 TCP 或 Wi-Fi），那么这可能不是问题。

这是有关 BlackBerry (RIM) 如何[建议您提出这些请求的参考文档](http://supportforums.blackberry.com/t5/Java-Development/Implement-basic-HTTP-authentication/ta-p/445920)

# objective-c - NSTextField 底部对齐

> ID：11294904
> 
> 赞同：3
> 
> 时间：2012-07-02T13:40:47.653
> 
> 标签：objective-c, vertical-alignment, nstextfield, nstextfieldcell

我需要底部对齐 NSTextField 中的文本，以便在动态更改字体大小时，文本的底部像素行始终保持在同一位置（[我使用它来执行此操作](https://stackoverflow.com/a/2911982/1016508)）。

现在我有这种情况：每当字体大小变小，例如从 55 到 20，文本挂在边界/框架的顶部，这不是我需要的。

我还没有找到任何可以让我在底部对齐文本的东西，[但我确实找到了](https://stackoverflow.com/a/1236659/1016508)它并为我的自定义 NSTextFieldCell 子类调整了它：

```
- (NSRect)titleRectForBounds:(NSRect)theRect {
    NSRect titleFrame = [super titleRectForBounds:theRect];
//    NSSize titleSize = [[self attributedStringValue] size];
    titleFrame.origin.y = theRect.origin.y;
    return titleFrame;
}

- (void)drawInteriorWithFrame:(NSRect)cellFrame inView:(NSView *)controlView {
    NSRect titleRect = [self titleRectForBounds:cellFrame];
    [[self attributedStringValue] drawInRect:titleRect];
} 
```

我也使用`[myTextField setCell:myTextFieldCell];`了这样我的 NSTextField 使用 NSTextFieldCell 但没有任何改变。我没有正确调整它还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-02-19T04:41:10.593

您需要调整 titleRect 的高度，因为如果字体减小，它会比所需的高。所以像这样的东西可以调整高度并将titleRect向下移动高度差。

```
- (void)drawInteriorWithFrame:(NSRect)cellFrame inView:(NSView *)controlView
{
    NSRect titleRect = [super titleRectForBounds:cellFrame];
    NSSize titleSize = [[self attributedStringValue] size];
    CGFloat heightDiff = titleRect.size.height - titleSize.height;
    titleRect = NSMakeRect(titleRect.origin.x, titleRect.origin.y + heightDiff, titleRect.size.width, titleSize.height);
    [[self attributedStringValue] drawInRect:titleRect];
} 
```

您也可以不`drawAtPoint:`提供`drawInRect:`确切的位置，但如果文本没有左对齐，您还必须计算正确的 x 位置。

# excel - 记录 Excel

> ID：11294906
> 
> 赞同：0
> 
> 时间：2012-07-02T13:40:58.117
> 
> 标签：excel, documentation, er-diagram

我们在组织中拥有数百个甚至数千个 Excel 文件，其中一些具有依赖关系和与其他文件的链接。到目前为止，这些 Excel 文件已被用作信息孤岛，我努力对此进行一些梳理。

我正在考虑使用类似于 ER 图的东西，我们可以在其中列出所有 Excel 文件，然后将具有依赖关系的文件链接到其他文件，所有这些都通过可视化拖放操作。

是否有可用的东西（最好是免费的）可以做到这一点，或者有人可以建议如何解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:51:28.247

您可以使用 Apache POI [http://poi.apache.org/spreadsheet/index.html](http://poi.apache.org/spreadsheet/index.html)

这将为您提供一个可以使用的 API，以便您可以编写某种批处理。

这是工作簿中的一个单元格依赖于另一个工作簿中的单元格的基本方式：

1.  打开将包含链接的工作簿（称为目标工作簿）和包含要链接到的数据的工作簿（称为源工作簿）。

2.  在目标工作簿中，单击保存按钮图像。

3.  选择要从中链接的一个或多个单元格。（如果要创建新公式，请键入（等号）。

4.  如果您要在公式的其他位置输入链接，请在链接之前键入您想要的运算符或函数。

所以你可以使用这个java库来解析excel文件，然后你可以使用单元格公式来拉入依赖项。

那时我会创建某种数据库并在您编写的程序解析文件时填充它。或者，也许您可​​以创建一个代表此类数据库的文件系统。

表：excel 行：id (bigint)、文件名 (varchar)

表：excel_deps 行：id (bigint), dep_id (bigint)

对于每个 excel 电子表格，在“excel”中创建一行

对于每个依赖项，在 excel_deps 中为电子表格的 ID 和它所依赖的电子表格的 ID 创建一行。

哦，你问了一些关于拖放的事情。这个填充的数据库表可用于非常简单地使用 JFreeChart 或 Java 图形 API 之类的东西生成依赖关系图。

# struts2 - Struts2 价值栈

> ID：11294907
> 
> 赞同：1
> 
> 时间：2012-07-02T13:41:00.200
> 
> 标签：struts2

我想了解 Struts 2 值堆栈与请求范围。我希望 struts2 值堆栈与请求范围相同。

例如，我在 struts 2 中调用了 action1，该操作执行一些 db 任务并返回。它对称为 case 的对象执行一些操作（类型 Cases，其中 Cases 是具有 getter 和 setter 的 bean 类）。案例对象在类级别声明。

action1 导致要呈现的视图说 jsp1。

jsp1 再次具有一些称为 action2 的动作。action2 导致与 action1 相同的 java 文件，但具有不同的方法。

现在，我想访问在 action1 中使用的对象。在 action1 期间，案例被推送到值堆栈并在 jsp1 上访问。

我只是尝试访问它的getter方法，但它返回一个空值......！

关于如何做的任何解决方案？？？或者有可能吗？我知道它是否可能，那么 vs 和请求范围之间有什么区别......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T03:12:50.647

Dave 关于 ValueStack 在请求范围内的说法是正确的。

但是，为了实现您想要的，即从数据库中获取一些数据，然后在多个操作/请求中使用这些数据，可以使用一些可能的方法：

1) 让您的操作实现[SessionAware](http://struts.apache.org/2.x/struts2-core/apidocs/org/apache/struts2/interceptor/SessionAware.html)接口，并编写一些代码来“手动”从会话映射中获取数据并将数据放入会话映射中。这种方法需要零额外配置，并且非常直接且“无魔法”。另一方面，它将样板代码添加到您的操作类中，并要求您在完成后“手动”从会话中删除数据（或者，如果节省内存不重要，您可以将其留在那里） .

2) 让您的操作实现[ModelDriven](http://struts.apache.org/2.x/docs/model-driven.html)接口并配置[ScopedModelDrivenInterceptor](http://struts.apache.org/2.x/docs/scoped-model-driven-interceptor.html)以管理“案例”模型的会话范围。这比 SessionAware 方法简单，因为它需要参考文档以将一些非常具体的配置细节添加到您的 struts.xml。它仍然需要添加样板代码，并且它没有提供从会话中删除数据的简单方法。

3) 使用[Struts2 Conversation Plugin](http://code.google.com/p/struts2-conversation/)，将 @ConversationField 注释放在你的案例对象上，并将 @ConversationAction 注释放在 action1 和 action2 方法上。然后在你的 struts.xml 中让你的包扩展“struts2-conversation-default”包并在你的拦截器堆栈中包含“conversation”interceptor-ref。然后在你的jsp中，使用[对话标签](http://code.google.com/p/struts2-conversation/#tag_lib). 这种方法需要很少的样板和配置，但它确实通过注释向您的操作添加元数据（有些人会对此皱眉），并且确实需要更多学习。该插件具有额外的功能，例如允许同一对话的多个并发实例，自动删除数据以节省内存等，但是，根据您的需要，这可能是矫枉过正。

您的应用程序的最佳方法将取决于您的要求和偏好。`ActionContext.getContext().getSession();`应避免在操作类中使用 SessionAware 接口访问会话对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T14:36:41.040

您在第一个请求中创建的对象不能在第二个请求中引用，因为[HTTP 协议是无状态的](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol)。

对于所有 Web 编程（PHP、servlet jsp、asp 等）都是一样的，因为 Web 使用 HTTP 协议进行通信。

为您解决问题的可行解决方案：

1 .创建包含对象id的隐藏输入标签，这样当您第二次请求时，struts 2方法可以获取id（作为参数）并再次执行“action执行一些db任务”以重新创建相同的对象（再次创建它很昂贵，但这取决于您的需求）

或者

2 .在第一个请求中渲染jsp之前，您可以将对象放在会话范围内（最好在行动中执行此步骤，而不是在jsp scriplet中）。

> ```
> Map session = ActionContext.getContext().getSession();
> session.put("myCases","cases); 
> ```

在第二个请求中，您可以访问该对象

> ```
> Map session = ActionContext.getContext().getSession();
> Cases cases=(Cases)session.get("myCases"); 
> ```

会话可以在任何操作/jsp 中访问，直到它被删除。

> ```
> Map session = ActionContext.getContext().getSession();
> session.remove("myCases"); 
> ```

如果您在从会话中删除后尝试访问“myCases”，您将获得 null。

# android - 自升级到 ADT r20 以来的 Eclipse LogcatView 错误（自动滚动、视图跳转、过滤缓慢）

> ID：11294913
> 
> 赞同：2
> 
> 时间：2012-07-02T13:41:30.103
> 
> 标签：android, eclipse, eclipse-plugin, adt

我在 Eclipse Indigo 中升级到 ADT r20，现在 Logcat 视图有很多错误。

*   日志消息看起来比以前慢得多。
*   切换过滤器时，它会等待 2-8 秒，直到出现消息。
*   当滚动条位于底部并且我单击滚轮向上滚动时，消息会向后跳转 1000 条消息，并且滚动条会继续滚动，而视图不会改变。

Logcat 现在在 Eclipse 中无法使用。

有什么建议么？我搜索了错误报告，但找不到任何解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T17:46:23.483

> 当滚动条位于底部并且我单击滚轮向上滚动时，消息会向后跳转 1000 条消息，并且滚动条会继续滚动，而视图不会改变。

您需要显式激活滚动锁定（使用日志猫视图中最右上角的按钮）以避免自动滚动。

我认为这只是最近才发生变化，因为我昨天在尝试读取 strack 跟踪的顶部条目时也遇到了困难。

# asp.net - .Net 4 路由在 IIS6 上无法正常工作（样式表/图像拦截）

> ID：11294914
> 
> 赞同：0
> 
> 时间：2012-07-02T13:41:31.020
> 
> 标签：asp.net, .net, c#-4.0, routing, iis-6

我有一个移动网站，截取样式表/图像并设置相对于设备的大小。我一直在 IIS7 上对其进行测试并且工作正常。

现场站点是 IIS6（惊喜）...

*友好 url*的正常路由工作正常，但样式表/图像拦截没有做任何事情。

这是我的 global.asax 路由部分的片段：

```
public static void RegisterRoutes(RouteCollection routes)
{
                routes.RouteExistingFiles = true;

                routes.MapPageRoute("ImageResizerS", "images/{Sub}/{Path}", "~/Site_Handlers/ImageResize.ashx");
                routes.MapPageRoute("ImageResizer", "images/{Path}", "~/Site_Handlers/ImageResize.ashx");

                routes.MapPageRoute("StyleSheetIntercept", "Styles/{Path}", "~/Site_Handlers/InterceptStyleSheet.ashx");

                routes.MapPageRoute("Landing page", "", "~/Site_Files/LandingPage.aspx");
    } 
```

**似乎是什么问题？**

*我注意到了什么：*

当我设置`routes.RouteExistingFiles = true;`为**`false`**. 它在 IIS7 和 IIS6 上创建相同的行为...没有拦截。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T14:50:53.127

在 IIS6 中，您需要启用通配符映射以确保正确的处理程序获取请求（在本例中为 ASP.Net），否则它将像静态网页一样提供服务。有关操作方法，请参见[Microsoft 网站](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx?mfr=true)。

第 4 步中的可执行路径将根据您的 .Net 版本而有所不同，但最简单的方法是从 .Net 已经处理的其他映射之一（.aspx、.ashx 等）复制值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T13:32:51.413

**在服务器上，打开 IIS：**

1.  右键单击站点/虚拟目录，选择属性
2.  转到主目录/虚拟目录选项卡，单击配置（靠近底部）
3.  再次靠近底部，单击插入按钮
4.  输入**C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll** -*在这种情况下使用 v4。*
5.  **取消选中**“验证该文件是否存在”按钮，单击“确定”并关闭所有对话框

**参考：** [IIS 6 上的 ASP.NET 路由](https://stackoverflow.com/questions/811871/asp-net-routing-on-iis-6)

# flash - 在 Flex 库项目中嵌入资产，然后在主应用程序中覆盖

> ID：11294915
> 
> 赞同：1
> 
> 时间：2012-07-02T13:41:34.233
> 
> 标签：flash, apache-flex, flash-builder, flex3, embedded-resource

我已经开发了一些我想在所有未来（基于网络的）Flex 项目中使用的代码。（由于基础架构的原因，我被困在 Flex 3.5 上。）

作为其操作的一部分，它读取 XML 文件以查找项目特定信息。

当我将代码从项目移到库中时，显然它在尝试查找 xml 资产时失败了（在 Actionscript 类中使用“嵌入”。）

我希望在库中嵌入一个默认的 XML 文件，该文件将在项目本身的运行时被覆盖。

问题：即使我已将资产文件包含在库文件结构中并将其添加到“项目属性/flex 库构建路径/资产”中，我仍然收到“无法解决”错误。我如何解决它？

问题：假设我让它工作，如果我将资产放在项目中的同一位置，包括库，它会覆盖它吗？（如果没有，是否有另一种方式来完成这种行为？）

谢谢！

# hibernate - 如何使用左连接策略实现与 JPA 的双向零对一关联？

> ID：11294916
> 
> 赞同：1
> 
> 时间：2012-07-02T13:41:36.423
> 
> 标签：hibernate, jpa, left-join, one-to-one

我想实现与 JPA 的双向零对一关联。目前，我使用以下代码段：

```
@Entity
class A {
    ...
    @OneToOne(fetch = FetchType.EAGER, optional = true)
    @PrimaryKeyJoinColumn
    private B a;
...
}

@Entity
class B {
    ...
    @OneToOne(fetch = FetchType.EAGER, optional = true)
    @PrimaryKeyJoinColumn
    private A a;
...
} 
```

问题是当我尝试加载我的实体 A 时，用于加载实体 B 的获取类型策略系统地是“FetchType.SELECT”，即；对于找到的每个实体 A，都会完成一个 select 语句以获取关联的实体 B。我尝试使用 @Fetch(FetchMode.JOIN) 休眠注释来处理这个问题（见下文），但它不起作用。

```
@Entity
class A {
    ...
    @OneToOne(fetch = FetchType.EAGER, optional = true)
    @PrimaryKeyJoinColumn

    // ineffective hibernate annotation
    @Fetch(FetchMode.JOIN)
    private B a;
...
} 
```

# python - 使用 Paramiko 进行端口转发

> ID：11294919
> 
> 赞同：24
> 
> 时间：2012-07-02T13:41:47.977
> 
> 标签：python, ssh, paramiko

我正在尝试使用 Paramiko 从 python 应用程序进行一些端口转发。我可以很好地设置 SSH 连接，但是对于如何使用`paramiko.Transport`. 我已经找到[了这个文件](https://code.ros.org/trac/wg-ros-pkg/browser/pkg/trunk/paramiko/demos/forward.py?rev=30)，但我不知道里面发生了什么。从查看[`paramiko.Transport`文档](http://www.lag.net/paramiko/docs/paramiko.Transport-class.html)来看，似乎只有一行使用该`open_channel`函数，但我不知道如何实现它。我正在尝试复制一个简单的`ssh -L 8000:localhost:8000`.

谁能帮我吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-24T09:12:39.440

`paramiko-1.7.7.1`请使用,`pycrypto-2.6`和[forward.py 脚本](https://github.com/paramiko/paramiko/blob/master/demos/forward.py)找到一些代码，我确实从中删除了从第 115 行到最后的代码（以避免选项解析）。

```
import paramiko, sys
from forward import forward_tunnel

remote_host = "target_host"
remote_port = 8000
local_port  = 8000
ssh_host    = "my_ssh_host"
ssh_port    = 22

user     = "login"
password = "s3cr3t"

transport = paramiko.Transport((ssh_host, ssh_port))

# Command for paramiko-1.7.7.1
transport.connect(hostkey  = None,
                  username = user,
                  password = password,
                  pkey     = None)

try:
    forward_tunnel(local_port, remote_host, remote_port, transport)
except KeyboardInterrupt:
    print 'Port forwarding stopped.'
    sys.exit(0) 
```

我已经从 Windows 站成功测试了它，使用 Red Hat 下的 ssh 服务器并指向第三台服务器。（我正在使用`Python 2.7.2`）

希望能帮助到你，

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-09-25T17:32:39.340

您可以使用[https://github.com/pahaz/sshtunnel](https://github.com/pahaz/sshtunnel)

```
pip install sshtunnel 
```

代码示例：

```
import sshtunnel

with sshtunnel.open(
    (ssh_host, ssh_port),
    ssh_host_key=None,
    ssh_username=ssh_user,
    ssh_password=ssh_password,
    ssh_private_key=None,
    remote_bind_address=(REMOTE_HOST, REMOTE_PORT)) as server:

    def do_something(port):
        # Do something with port
        pass

    print("LOCAL PORT:", server.local_bind_port)

    do_something(server.local_bind_port) 
```

# nginx - Pinnect 对 nginx 的 htaccess 规则

> ID：11294922
> 
> 赞同：1
> 
> 时间：2012-07-02T13:41:58.077
> 
> 标签：nginx

所以我一直在尝试改变它们的规则，pinnect 脚本的规则是：

```
Options +FollowSymLinks
IndexIgnore */*
RewriteEngine on

#RewriteBase /

# if a directory or a file exists, use it directly
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# otherwise forward it to index.php
RewriteRule . index.php

# fix for uploadify 302, 406 errors
SetEnvIfNoCase Content-Type "^multipart/form-data;" "MODSEC_NOPOSTBUFFERING=Do not buffer file uploads" 
```

我在服务器上的 pinnect/ 上有 pinnect，但是 VB 目前正在索引上运行，

我试过了

```
location /pinnect {
   try_files $uri $uri/ /index.php;
} 
```

还有不同的变体，但是假设我转到 /install 目录 - 它试图将我重定向到 pinnect/forums.php（因为 VB），如果我尝试直接转到 index.php，则会出现无限循环，任何人都可以帮我解决这个问题吗？

编辑：

所以我现在有这个规则

```
location ~ ^/pinnect/index.php { try_files maintenance.html @index.php; }

location ~ ^/pinnect/ {
        rewrite ^/pinnect$                                             /pinnect/index.php       last;
        rewrite ^/pinnect/$                                             /pinnect/index.php       last;
        #rewrite ^/pinnect/([^.]+)$                                      /pinnect/index.php/$1 last;
        rewrite ^/pinnect/(.*)                                      /pinnect/index.php/$1 last;

} 
```

但是无论我走到哪里，我都会得到 301、302，所以它的行为方式与 htaccess 不同，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-17T09:19:55.930

# jquery - 如何使用 jquery 或 javascript 通过文件上传显示图像并且路径将存储在数据库中？

> ID：11294923
> 
> 赞同：1
> 
> 时间：2012-07-02T13:42:05.660
> 
> 标签：jquery, asp.net, sql-server-2008

在网页中，有图像控件和文件上传。如果单击文件上传并从本地磁盘中选择图像文件，它将在asp.net图像控件中显示该图像，而无需单击其他按钮或刷新页面，然后再显示该图像它的路径必须存储在数据库中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:49:00.403

使用这个函数，记得要包含 jQuery 库。以下函数使用阅读器来读取数据并将其设置为图像 src。图片 src 也可以是 urldata。

```
 function readURL(input) {
        if (input.files && input.files[0]) {//Check if input has files.
            var reader = new FileReader();//Initialize FileReader.

            reader.onload = function (e) {
                $('#PreviewImage').attr('src', e.target.result);
            };
     reader.readAsDataURL(input.files[0]);
        }
    } 
```

将此添加到您的图像上传`onchange="readURL(this);"`。ASP.NET UploadControl 这个函数有问题，改用 HTML 上传控件。

```
<img id="PreviewImage" src="" alt="?" style="width:100px; height:100px;"  />
     <input type="file" ID="ImageFileUpload" onchange="readURL(this);" /> 
```

这是一个工作示例[http://jsbin.com/amoxip/2/edit#javascript,html](http://jsbin.com/amoxip/2/edit#javascript,html)

# sql-server - 根据时间选择行

> ID：11294931
> 
> 赞同：1
> 
> 时间：2012-07-02T13:42:23.677
> 
> 标签：sql-server

在使用之前，我已经根据 DateTime 选择了行：

```
DATEADD(day, -1, GetDate()) AND GETDATE() 
```

获取自昨天以来的最新记录，以及

```
 DECLARE @today DATETIME = CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME)  
DATEADD(mi, 00, DATEADD(hh, 8, @today)) AND DATEADD(hh, 9, @today) 
```

为了获得从当天开始的某个时间范围之间的行。现在我有一个表，它有一个单独的时间和日期列，所以这两个都不起作用。当我尝试上述任何一种方法时，我总是会收到错误消息：“数据类型时间和日期时间在大于或等于运算符中不兼容。” 我知道问题是我没有要引用的 DateTime 类型列。有没有办法在引用单独的时间和日期字段的某个时间范围之间获得一行？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:48:15.510

您可以将日期和时间字段一起添加以创建一个日期/时间字段以进行比较：

```
create table #temp (id int, d date, t time)
insert into #temp values (1, '1/1/2000', '1:00 PM')
insert into #temp values (2, '1/1/2000', '2:00 PM')
insert into #temp values (3, '1/1/2000', '3:00 PM')

select * from #temp where cast(d as datetime) + cast(t as datetime) between '1/1/2000 1:10 PM' and '1/1/2000 2:30 PM' 
```

因此，如果您`DATEADD()`的设置正确，您可以这样做：

```
SELECT * FROM sometable WHERE cast(DateField as datetime) + cast(TimeField as datetime) BETWEEN DATEADD(mi, 00, DATEADD(hh, 8, @today)) AND DATEADD(hh, 9, @today) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:55:35.137

```
DECLARE @today DATE = SYSDATETIME();
DECLARE @start DATETIME = DATEADD(HOUR, 8, @today);
DECLARE @end   DATETIME = DATEADD(HOUR, 1, @start);

SELECT ... FROM dbo.table ...
WHERE date_column = @today -- to narrow search first, efficiently, if indexed
AND DATEADD(DAY, DATEDIFF(DAY, 0, date_column), CONVERT(DATETIME, time_column)) >= @start
AND DATEADD(DAY, DATEDIFF(DAY, 0, date_column), CONVERT(DATETIME, time_column)) <  @end;
---- you may want <= here rather than < 
```

# c# - Async FileStream 将“NUL”写入文件

> ID：11294936
> 
> 赞同：0
> 
> 时间：2012-07-02T13:42:37.000
> 
> 标签：c#, .net

我正在使用此代码异步写入文件

```
 public static void AsyncWrite(string file, string text)
    {
        try
        {
            byte[] data = Encoding.Unicode.GetBytes(text);                

            using ( FileStream fs = new FileStream(file, FileMode.Create,
                FileAccess.Write, FileShare.Read, 1, true))                                         
                    fs.BeginWrite(data, 0, data.Length, null, null);
        }            
        catch
        {

        }            
    } 
```

出于某种原因，Notepad++ 有时并没有按预期将文本写入文件，而是显示以下输出：

![在此处输入图像描述](../Images/426c8ad4d85094af7a8df28489394477.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:49:34.647

`BeginWrite`是异步的，因此很可能会在`using`发生其他事情时通过语句关闭流。

`using`在进行异步写入时我不会使用。相反，我会创建一个适当的回调方法并在那里关闭流。这也将使您有机会`EndWrite`按照建议致电。

# asp.net - 如何理解 google chrome 中针对 Asp.net 提供的静态资源的安全警告

> ID：11294938
> 
> 赞同：9
> 
> 时间：2012-07-02T13:42:51.720
> 
> 标签：asp.net, security, caching, cookies, google-chrome-devtools

我使用 Google Chrome 开发人员工具中的审核功能检查了我们的 Web 应用程序。

首先，我收到一条警告，表明我们正在为静态内容提供不可缓存的服务：“以下资源明确不可缓存。如果可能，请考虑将其设为可缓存”。

为了解决这个问题，我将此片段添加到我们的 web-config

```
<staticContent>
    <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="7.00:00:00" />
</staticContent> 
```

正如这篇博文中所推荐的那样：http: [//blogs.msdn.com/b/carlosag/archive/2009/06/09/are-you-caching-your-images-and-scripts-iis-seo-can-tell -you.aspx](http://blogs.msdn.com/b/carlosag/archive/2009/06/09/are-you-caching-your-images-and-scripts-iis-seo-can-tell-you.aspx)

如果我现在在 google chrome 中开始新的审核，我会收到一个新警告：

> 以下可公开缓存的资源包含 Set-Cookie 标头。此安全漏洞可能导致 cookie 被多个用户共享。

您能否解释一下潜在的安全威胁以及 Asp.net 中可能的解决方案是什么？

**[更新]**

经过更多研究，我想这可能与这个问题有关：

[为什么 ASP.NET 表单身份验证在静态图像请求上设置 cookie？](https://stackoverflow.com/questions/4208089/why-is-asp-net-forms-authentication-setting-cookies-on-a-static-image-request)

但我不能把拼图放在一起。情况并不完全相同，虽然我们的应用程序可以配置为使用表单身份验证，但我在使用 Windows 身份验证时收到了警告。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T08:30:54.310

看起来问题确实与表单身份验证有关。在对用户进行身份验证后，我们设置了一个表单身份验证 cookie。这个 cookie 没有设置路径，所以它会为每个请求发送，即使是静态图像。

即使我正在测试 Windows 身份验证，看起来我仍然拥有前一个调试会话中设置的 coockie。

我认为最好的解决方案是为 coockie 设置一条路径，以防止它被发送到静态资源。不幸的是，我无法为我们所有的服务请求定义路径，因为我们使用的是 WCF Ria 服务，并且这些服务有一个创建运行时的虚拟路径。

目前的解决方案是仅在浏览器中设置 cookie。Web 配置中的更新条目是：

```
<staticContent>
    <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="7.00:00:00" cacheControlCustom="private"/>
</staticContent> 
```

重要的部分是新的 cacheControlCustom 属性。

我想这仍然可能是一个安全问题，如果一个浏览器由多个用户共享（例如在网吧？），但这不是我们项目的有效场景。

# objective-c - Objective-C 中的复杂 XML 解析

> ID：11294944
> 
> 赞同：0
> 
> 时间：2012-07-02T13:43:13.470
> 
> 标签：objective-c, ios, xml-parsing

我必须在我的图书应用程序中阅读和显示多个字符对话。我打算以以下格式在 XML 中存储字符对话数据：

```
<?xml version="1.0" encoding="UTF-8"?>
<Pages>
    <Page Id="P1">
        <T>Once upon a time in the deep jungle of sunderbun there lived a lazy and wicked Jackal.Once upon a time in the deep jungle of sunderbun there lived a lazy and wicked Jackal.</T>
        <A>This is audio file location.This is audio file location.This is audio file location.</A>
        <Dlg>
            <Dlg Id="C1D1" P="L" X="" Y="" W="" H="">
                <T>This is Character 1 Dialogue 1.This is Character 1 Dialogue 1.</T>
                <A>This is audio file location.This is audio file location.</A>
            </Dlg>
            <Dlg Id="C1D2" P="R" X="" Y="" W="" H="">
                <T>This is Character 1 Dialogue 2.This is Character 1 Dialogue 2.</T>
                <A>This is audio file location.This is audio file location.</A>
            </Dlg>
            <Dlg Id="C2D1" P="L" X="" Y="" W="" H="">
                <T>This is Character 2 Dialogue 1.This is Character 2 Dialogue 1.</T>
                <A>This is audio file location.This is audio file location.</A>
            </Dlg>
        </Dlg>
    </Page>
    <Page Id="P2">
        <T>Once upon a time in the deep jungle of sunderbun there lived a lazy and wicked Jackal.Once upon a time in the deep jungle of sunderbun there lived a lazy and wicked Jackal.</T>
        <A>This is audio file location.This is audio file location.This is audio file location.</A>
        <Dlg>
            <Dlg Id="C1D1" P="R" X="" Y="" W="" H="">
                <T>This is Character 1 Dialogue 1.This is Character 1 Dialogue 1.</T>
                <A>This is audio file location.This is audio file location.</A>
            </Dlg>
            <Dlg Id="C2D1" P="L" X="" Y="" W="" H="">
                <T>This is Character 2 Dialogue 1.This is Character 2 Dialogue 1.</T>
                <A>This is audio file location.This is audio file location.</A>
            </Dlg>
            <Dlg Id="C2D2" P="R" X="" Y="" W="" H="">
                <T>This is Character 2 Dialogue 2.This is Character 2 Dialogue 2.</T>
                <A>This is audio file location.This is audio file location.</A>
            </Dlg>
        </Dlg>
    </Page>
</Pages> 
```

从 XML 结构中可以看出，会有多个页面，每个页面会有多个字符，每个字符会有多个对话。此 XML 的大小可能约为 250 KB（不确定对于 iPhone/iPad 是否太大）。我打算使用 GDataXML 来解析这个 XML 并存储为以下模型对象：

```
#import <Foundation/Foundation.h>

typedef enum {
    Left,
    Right
} DialoguePosition;

@interface Dialogue : NSObject{
    NSString *_id;
    int _frameX;
    int _frameY;
    int _frameWidth;
    int _frameHeight;
    DialoguePosition _dialoguePosition;
    NSString *_dialogueText;
    NSString *_dialogueAudioLocation;
}
@property (nonatomic, copy) NSString *id;
@property (nonatomic, assign) int frameX;
@property (nonatomic, assign) int frameY;
@property (nonatomic, assign) int frameWidth;
@property (nonatomic, assign) int frameHeight;
@property (nonatomic, assign) DialoguePosition dialoguePosition;
@property (nonatomic, copy) NSString *dialogueText;
@property (nonatomic, copy) NSString *dialogueAudioLocation;

- (id)initWithName:(NSString *)id frameX:(int)frameX frameY:(int)frameY frameWidth:(int)frameWidth frameHeight:(int)frameHeight dialoguePosition:(DialoguePosition)dialoguePosition dialogueText:(NSString *)dialogueText dialogueAudioLocation:(NSString *)dialogueAudioLocation;

@end 
```

我应该使用属性列表而不是 XML 还是 XML 应该没问题？我需要通过传递页面 ID 和对话 ID 轻松快速地访问对话。为了实现这一点，我应该将 Dialogue 模型对象存储在 NSDictionary 中还是应该采用其他更好的方法。我将不胜感激您对我应该采取的方法的建议。

# asp.net - IE 8 不显示页面

> ID：11294948
> 
> 赞同：0
> 
> 时间：2012-07-02T13:43:20.567
> 
> 标签：asp.net, html, internet-explorer-8

我的页面没有在 IE8 中显示。如果我在 IE 中调试并在 Internet Explorer 8 浏览器模式下将其更改为 IE7 标准，它工作正常。我不确定出了什么问题。如果我添加指定 IE7 的元标记，它会加载页面，然后看起来像是将其转发到空白页面。所有的 html 都在调试信息中，它在 IE7 浏览器模式或 Firefox 中运行良好。有任何想法吗？这是我的标题：

母版页：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="Site2.master.cs" Inherits="Site2" %>

<%@ Register TagPrefix="uc" TagName="Header" Src="~/Controls/Header.ascx" %>
<%@ Register TagPrefix="uc" TagName="Footer" Src="~/Controls/Footer.ascx" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head id="Head1" runat="server">
    <title></title>

    <link href="Styles/Site.css" rel="Stylesheet" type="text/css" />

    <script src="<%= ResolveClientUrl("Scripts/jquery-1.4.1.js") %>" type="text/javascript" > </script>
    <script src="<%= ResolveClientUrl("Scripts/Jquery.min.js") %>" type="text/javascript" > </script>
    <script src="<%= ResolveClientUrl("Scripts/menu.js") %>" language="javascript" type="text/javascript" > </script>
    <script src="<%= ResolveClientUrl("Scripts/jquery-ui-1.8.10.custom.min.js") %>" type="text/javascript" > </script>
    <script src="<%= ResolveClientUrl("Scripts/EasyConfirm.js") %>" type="text/javascript" > </script>
    <link href="<%= ResolveClientUrl("Styles/jquerySmoothness.css") %>" rel="stylesheet" type="text/css" />

     </head>
<body  >

    <form id="form1" runat="server" enctype="multipart/form-data" method ="post" >

      <asp:ScriptManager ID="ScriptManager1"  AjaxFrameworkMode="Enabled" EnablePartialRendering="true"    runat="server" />

    <div class="container">
        <uc:Header runat="server" ID="headerTest" Title="RTSC SCM" Subtitle="Logistics SOS" />

  <div class="content2 " style ="position:relative; padding-bottom: 10px"   >

  <asp:ContentPlaceHolder ID="ContentPlaceHolder2" runat="server"/>

      <%--</asp:ContentPlaceHolder>--%>

    <!-- end .content --></div>
       <uc:Footer runat="server" ID="footer" TeamName="RTSC Logistics SOS Tool Support Team" />

    <!-- end .container --></div>
    </form>
</body>
</html> 
```

页：

```
<%@ Page Title="RTSC SOS - Storage Request View" Language="C#" MasterPageFile="~/Site2.master" AutoEventWireup="true" CodeFile="StorageRequest.aspx.cs" Inherits="Forms_StorageRequest" ContentType="IE7" %>

<%@ Register TagPrefix="uc" TagName="EmployeeSearch" Src="~/Controls/TinyEmployeeSearch.ascx" %>
<%@ Register Src="~/Controls/AdditionalInfo.ascx" TagPrefix="R" TagName="AddInfo" %>
<%@ Register Src="~/Controls/LamEditComments.ascx" TagPrefix="R" TagName="StorageLocation" %>
<%@ Register Src="~/Controls/RequestHeader.ascx" TagPrefix="R" TagName="reqheader" %>
<%@ Register Src="~/Controls/HandlingUnitInfo.ascx" TagPrefix="R" TagName="handlingView" %>
<%@ Register Src="~/Controls/DocumentGrid.ascx" TagPrefix="R" TagName="docView" %>
<%@ Register Src="~/Controls/EmailGrid.ascx" TagPrefix="R" TagName="emailView" %>
<%@ Register src="~/Controls/RequestInfo.ascx" tagname="requestinfo" tagprefix="uc1" %>

<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder2" Runat="Server">
<script type ="text/javascript" src="../Forms/FormsJS/StorageRequest.js"></script>
<script type ="text/javascript" src="../Scripts/ajaxfileupload.js"></script>

<div id="input" runat ="server" style="width: 960px" >
    <R:reqheader id="m_reqHeaderCtr" runat="server" />
    <r:docView ID="docView" runat="server" Visible = "true" />
    <r:emailView ID="emailView" runat="server" Visible = "true"/>
    <uc1:requestinfo ID="requestinfo1" runat="server" Visible = "false" />
    <%-- Request Edit Information --%>
    <fieldset id="RequestEdit" runat ="server" style="border-color: #CCC; width: 960px;" > 
        <legend style="border-style: none;font-size:small; color: Blue;">Request Information</legend>
        <div  style="margin: 0px; padding: 0px; float:left"  >
        <table>
            <tr style="height: 25px;">
                <td  class ="BDecoNone bold" width="60px">
                    <img id="star1" runat ="server" src="../Images/red_star.gif" alt="Red Star" class="RedStars"/> Program: 
                </td>

                <td width="120px">
                    <asp:DropDownList ID="strgProg_DD" Height="20px" runat="server" AutoPostBack="false" CssClass="TBDecoSmall">
                    </asp:DropDownList>
                    <span id="Program_Span" runat="server" />
                </td>

                <td runat="server" id="Other_TR" class="bold" style="text-align:right;display:none;"> 
                    <img id="star3" runat ="server" src="../Images/red_star.gif" alt="red_star" class="RedStars" />
                    <asp:Label ID="OtherTD" Text = "Other Program:" Width = "73px"  runat ="server" ></asp:Label>
                </td>

                <td width="100px">
                    <asp:TextBox ID="m_otherProgramTB" runat="server" CssClass="TBDecoNone"  ViewStateMode="Enabled"  Height="12px" Wrap="False"></asp:TextBox>
                </td>

                <td width="100px">
                &nbsp;
                </td>
            </tr>
        </table>

        <table> 
            <tr>
                <td class="bold TBDecoSmall " >
                    <img  id="star4" runat ="server" src="../Images/red_star.gif" alt="Red Star" class="RedStars"/>Ownership:
                </td>
                <td colspan="1">
                    <span id="m_ownershipSpan" runat="server" class="bold" />
                    <asp:RadioButtonList ID="OwnRadioButtonList" runat="server" CssClass="bold" RepeatColumns="5" RepeatDirection="Horizontal"></asp:RadioButtonList>
                </td>

                <td>
                    &nbsp;
                </td>
            </tr>
        </table>

        <table>
            <tr>
                <td class="bold TBDecoQuan"  style ="width:150px">
                    <img id="star5" runat ="server" src="../Images/red_star.gif" alt="Red Star" class="RedStars"/>Check to Certify:
                </td>

                <td colspan="1">
                    <span ID="Material_CB_Span" runat="server"></span>
                    <asp:CheckBox ID="Material_CB" runat="server" AutoPostBack="false" CssClass="cb bold" Text="Material is NOT Classified" Width="150px" /> 
                </td>
            </tr>
        </table>

        <table>
            <tr>
                <td class="bold TBDecoSmall" style="width: 150px; height: 24px;">
                    <img id="star6" runat ="server" src="../Images/red_star.gif" alt="Red Star" class="RedStars"/>Storage Requirements:
                </td>

                <td colspan="1" style="height: 24px">
                    <asp:CheckBoxList ID="m_storageList" runat="server" AutoPostBack="false" CssClass="Space bold" RepeatColumns="5" />
                </td>
            </tr>
        </table>

        <table>
            <tr ID="TempStorageInstruction_TR" runat="server" >
                <td class="bold TBDecoSmall" colspan="1" style="width: 180px">
                    <img  id="star7" runat ="server" src="../Images/red_star.gif" alt="Red Star" class="RedStars"/>Temperature Storage Instructions:
                </td>

                <td >
                    <span ID="TempStorageSpan" runat="server" class="bold"></span>
                    <asp:TextBox ID="TempStorageInstruction_TB" runat="server" CssClass="Bmar TBDecoLong" ValidationGroup="saveAll" ViewStateMode="Enabled" Height="20px" TextMode="MultiLine" Width="220px"></asp:TextBox>
                </td>

                <td>
                    &nbsp;
                </td>
            </tr>

            <tr ID="OtherStorageInstruction_TR" runat="server" >
                <td class="bold TBDecoSmall" style="width: 150px">
                    <img  id="star8" runat ="server" src="../Images/red_star.gif" alt="Red Star" class="RedStars"/> Other Storage Instructions:
                </td>

                <td >
                    <span ID="m_otherInstSpan" runat="server" class="bold"></span>
                    <asp:TextBox ID="OtherStorageInstruction_TB" runat="server" CssClass="Bmar TBDecoLong" Height="20px" 
                    TextMode="MultiLine"  ValidationGroup="saveAll"  ViewStateMode="Enabled" Width="220px"></asp:TextBox>
                </td>

                <td>
                    &nbsp;
                </td>
            </tr>
        </table>
    </div>

    <div  style="position: relative; width: 360px; float: right; height: auto; padding-top: 5px; top: 0px;"  >
        <div  class="TBDecoNone" style ="padding: 0x; margin: 0px; float: left"  >
            <img id="star2" runat ="server" src="../Images/red_star.gif" alt="Red Star" class="RedStars"/> Program Point of Contact:&nbsp;
        </div> 

        <div style ="float : left"> 
            <uc:employeesearch  id="progrmPointOfContact_TB" runat="server" scheme="Red" Enabled="false"  /> 
        </div> 
    </div> 
    </fieldset>  

    <fieldset runat="server"  id ="EditGrid" style="border-color: #CCC; width: 960px;">
            <legend style="border-style: none;font-size:small; color: Blue;">
            Handling Unit Information</legend>
            <div id="GridHolder">
                <R:handlingView ID="handlingViewGrid" runat="server" Visible = "true" />
            <br />
            </div>
        <div> 
            <input type="button" id="m_addNewItem" value="Add Material" style="border-color:#87BF83;color:Black" class="AddB" onclick="AddMaterial()" />
        </div>

<div id="m_detailsView" runat="server" style="display:none">
    <table cellpadding="1" cellspacing="1"> 
        <tr>
            <td class="TextDeco"><img src="../Images/red_star.gif" alt="red_star" class="RedStars"/>Material Number:</td>
            <td class="TextDeco"><img src="../Images/red_star.gif" alt="red_star" class="RedStars"/>Description: </td>
            <td class="TextDeco"> &nbsp;&nbsp; Manufacturer:</td> 
            <td class="TextDeco"> &nbsp;&nbsp; Model:</td>
        </tr>

        <!-- End Header section-->
        <tr style="height: 20px; vertical-align: top;">
            <!--Material TextBox ID=MatNum_TB-->
            <td>
                <asp:TextBox ID="MatNum_TB" runat="server" CssClass="TBDeco" Width="175px" Wrap="False"></asp:TextBox>
                <br /> 
            </td>
            <!--Description TextBox-->      
            <td>
                <asp:TextBox ID="Des_TB" runat="server" CssClass="TBDeco" Width="175px" Wrap="False"></asp:TextBox>
            </td>

            <!--Manufacturer TextBox-->       
            <td class="TBDeco">
                <asp:TextBox ID="Manufac_TB" runat="server" CssClass="TBDeco" Width="250px" Wrap="False"></asp:TextBox>
                <br />
            </td>

            <!--Model TextBox-->
            <td>
                <asp:TextBox ID="Model_TB" runat="server" CssClass="TBDeco" Wrap="False" Width="100px"></asp:TextBox>
                <br />
            </td>
        </tr>

        <tr>
            <td class="TextDeco">
                <img src="../Images/red_star.gif" alt="red_star" class="RedStars"/>Material Type:
            </td>
            <td class="TextDeco" style ="width:150px">
                <img src="../Images/red_star.gif" class="RedStars" alt="red_star"/>Inv. Classification:
            </td> 
            <td class="TextDeco" >
                <img src="../Images/red_star.gif" alt="red_star" class="RedStars"/>Shelf-Life:
            </td>
            <td class="TextDeco" >

            </td>
        </tr>

        <tr valign="top">
            <td> 
            <!--Material Type DropDownList-->                        
                <asp:DropDownList ID="MatType_DD"  Height="20px" runat="server" CssClass="TBDeco" Width="150px" ></asp:DropDownList>
                <br />
            </td>

            <!--Inventory DropDownList-->   
            <td>                    
                <asp:DropDownList ID="Inv_DD"  Height="20px" runat="server" CssClass="TBDeco" Width="150px"></asp:DropDownList> 
                <br />
            </td>

            <td width="240px">  
            <div style="float: left; height: 20px auto; width: 130px;" >
                <asp:TextBox ID="SLife_TB" runat="server" CssClass="TBDecoSmall" Wrap="False" Width="120px" onclick="document.getElementById('ContentPlaceHolder2_SLife_TB').focus();"></asp:TextBox> 
                <br />
            </div>

            <div style="float:right; height: 20px auto;"   >
                <asp:CheckBox ID="Unlimit_CB" runat="server" AutoPostBack="false" CssClass="TBDecoSmall" Height="20px"  Text="Unlimited" />
            </div>
            </td>
        </tr>

        <!--Header--> 
        <tr> 
            <td class="TextDeco">
                <img src="../Images/red_star.gif" alt="red_star" class="RedStars"/>Charge Number:
            </td>
            <td class="TextDeco" style="margin-left:15px;">
                    &nbsp;&nbsp; Owning Cost Center:
            </td>
            <td class="TextDeco" style="margin-left:15px;">
                &nbsp;&nbsp; Unit Value:
            </td>
        </tr>

        <tr class="bold" style="vertical-align: top">
            <!--Charge Number TextBox-->          
            <td width="250px">               
                <asp:TextBox ID="Charge_TB" runat="server" CssClass="TBDeco" Width="143px"></asp:TextBox> 
                <br />
            </td>

            <!--Owning Cost Center TextBox-->
            <td>
                <asp:TextBox ID="Own_TB" runat="server" CssClass="TBDeco" Width="143px"></asp:TextBox> 
                <br /> 
            </td>

            <td>                        
                <asp:TextBox ID="Line_TB" runat="server" CssClass="TBDeco" Width="120px"></asp:TextBox>
                <br /><br />
            </td>
        </tr>
    </table>

    <table cellpadding="1" cellspacing="1" rules="none" frame="void" style="margin: 0px; padding: 0px" >
        <tr class="bold ">
            <td width="108px">
                <img src="../Images/red_star.gif" alt="red_star" class="RedStars" />Serialized: 
            </td>
            <td width="60px" >                         
                <asp:RadioButtonList ID="Seri_RB" runat="server" RepeatDirection="Horizontal" AutoPostBack="false" Width="80px" >
                    <asp:ListItem Value="1">Yes</asp:ListItem>
                    <asp:ListItem Value="0">No</asp:ListItem>
                </asp:RadioButtonList> 
            </td>

            <td width="193px">
                <img id="starForQuantity" runat ="server" src="../Images/red_star.gif" alt="Red Star" class="RedStars"/> Quantity:
                <br />
                <asp:TextBox ID="Quan_TB" runat="server"  Width="143px" Wrap="False" CssClass="TBDecoNone"></asp:TextBox>
            </td>

            <td width="300px" id="SerialNumber" runat ="server" >
                <img id="starForSerial" runat ="server" src="../Images/red_star.gif" alt="Red Star" class="RedStars"/> Serial Number:  
                <br />
                <asp:TextBox ID="Seri_TB" runat="server" Width="120px" CssClass="TBDecoNone" Wrap ="false" ></asp:TextBox>
            </td>       
        </tr>   
        <tr class="bold " >
            <td>
                <img src="../Images/red_star.gif" alt="red_star" class="RedStars"/>Moisture Sensitive:  
            </td>

            <td width="60px">
                <asp:RadioButtonList ID="Moist_RB" runat="server" AutoPostBack="false" RepeatDirection="Horizontal" >
                    <asp:ListItem Value="1">Yes</asp:ListItem>
                    <asp:ListItem Value="0">No</asp:ListItem>
                </asp:RadioButtonList>
            </td>
        </tr>

        <tr class="bold "  >
            <td >
                <img src="../Images/red_star.gif" alt="red_star"   class="RedStars"/>Hazardous: 
            </td>

            <td width="80px">                        
                <asp:RadioButtonList ID="Haz_RB" runat="server" RepeatDirection="Horizontal" AutoPostBack="false" >
                    <asp:ListItem Value="1">Yes</asp:ListItem>
                    <asp:ListItem Value="0">No</asp:ListItem>
                </asp:RadioButtonList>
            </td>
        </tr>
    </table>

    <table>
        <tr class="bold" runat="server" id="MSDS_TR" style="display:none">
            <td width="130px;">
                <img src="../Images/red_star.gif" alt="red_star" class="RedStars"/>
                <asp:Label ID="MSDSLabel" runat="server" Text="MSDS Number:"></asp:Label>
            </td>

            <td width="100px">
                <asp:TextBox ID="MSDS_TB" runat="server" CssClass="TBDecoSmall" Wrap="False" Width="100px"></asp:TextBox>
            </td>

            <td></td>

            <td width="440px" colspan="1" > 
                <div style="float:left" > Attached MSDS: </div>  
                    <input type="file" id="MSDSFileUpload"  runat="server" style="width:330px;height:20px" />
            </td>
        </tr>
    </table>

    <table id="pkg" runat ="server" >
        <tr class="bold"  >
            <%-- Pack_TR is to make the red star image visible/invisible--%>
            <td  runat="server" id="Pack_TR" visible="true" >
                <img src="../Images/red_star.gif" alt="red_star" class="RedStars"/>Packaging Requirement:
            </td>

            <td colspan="3" style="width: 468px; text-align:left;" align="left">                        
                <asp:CheckBoxList ID="PackingReq_CBL" runat="server" AutoPostBack="false" 
                CssClass="Space"  RepeatDirection="Horizontal" Visible="true" /> 
            </td>
        </tr>
    </table>

    <table id ="pkgOther" runat ="server" style="display:none">
        <tr id="OtherPkgRequirent_TR" runat="server" class="bold " style ="vertical-align:middle;"  > 
            <td>
                <img src="../Images/red_star.gif" alt="red_star" class="RedStars"/>Other Packaging Requirement:
            </td>
            <td colspan="2" align="left">
                <asp:TextBox ID="OtherPkgRequirent_TB" runat="server" Width="550px" Wrap="False"></asp:TextBox>
            </td>
            <td>  

            </td>
        </tr>
    </table>

    <center>
        <div id="mat_err" style="color:red" runat="server" ></div>
        <div style="">
            <input type="button" id="btnSave" value="Save Material Number"  onclick="return SaveMaterialData();" /> 
            &nbsp;&nbsp;&nbsp;&nbsp; 
            <input type="button" id="btnSaveAddMaterial" value="Save and Add Material Number" /> 
            &nbsp;&nbsp;&nbsp;&nbsp; 
            <input type="button" id="btnCancel" value="Cancel"  onclick="Cancel()" /> 
        </div>
    </center>                  
    </div> 
    </fieldset>

</div>

</asp:Content> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T13:46:22.047

您是否尝试过通过 XHTML 验证器运行它？ [http://validator.w3.org/](http://validator.w3.org/)

您可能会在其中发现影响页面 html 其余部分的错误。

# sql - 带有文字的存储过程参数在 SQL Server 2008 R2 中不起作用

> ID：11294950
> 
> 赞同：0
> 
> 时间：2012-07-02T13:43:27.390
> 
> 标签：sql, sql-server, sql-server-2008

我有一个存储过程，它接受两个参数作为`varchar(50)`. 存储过程对临时表执行一些简单的查询并从临时表返回结果集（我删除了实际查询）

```
ALTER PROCEDURE [dbo].[cv_GetBooks]
    @bookNumber as varchar(50),
    @bookDate as varchar(50)
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    --a few select statements

    if @ismultiple = '0'
    begin
         select * from books where bookNumber = @bookNumber
    and bookDate = @bookDate
    and Bookname is  not null
    end
    ELSE
    Begin
        select * into #temp from books
    where bookNumber = @bookNumber
    and bookDate = @bookDate
    and Bookname is   null

           select * from books
    where bookauthor not in (select bookauthor from #temp) 
    and bookNumber= @bookNumber
            and bookDate= @bookDate
        drop table #temp
    end
END 
```

我在 SQL Server 2008 上的本地开发机器上安装了这个查询。我还在运行 Windows Server 2003 和 SQL Server 2008 的两台测试机器上安装了它。存储过程一直按预期工作。

```
cv_GetBooks '012345678', '06062012' --returns result set as expected 
```

我最近将它移到另一个运行 Windows Server 2008 和 SQL Server 2008 R2 的远程环境中的测试服务器。存储过程不再按预期工作。运行 SQL Profiler 后，我确认正在执行相同的代码：

```
cv_GetBooks '012345678', '06062012' --run on SQL server 2008 r2 returns nothing 
```

当我从查询中删除引号时，我得到了预期的结果：

```
cv_GetBooks 012345678, 06062012 --run with out quotes server returns expected result set 
```

此后，我在本地版本的 SQL Server 2008 R2 上安装了相同的存储过程，并且一切都按预期运行，并带有文字字符串引号，如第一个示例所示。

起初我认为这是传递参数的转义问题，但这似乎不正确，因为传递的值不包含任何单引号。

安装并让它在如此多的环境中运行后，我的印象是这可能是我不知道的 SQL Server 中的一个设置。

什么可能导致存储过程不返回带有 SQL Server 2008 r2 实例上的字符串文字的结果集，但在没有它们的情况下正常工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T14:49:47.177

这可能不是确切的答案，但可以尝试以此作为了解更多问题的方法。在 SSMS 中运行一些基本查询（不是整个过程），并使用适当的参数，例如：

（我不确定 @ismultiple 来自哪里 - 似乎没有被声明或参数化？）

```
select * 
from books
where bookNumber = '012345678'
and bookDate = '06062012'
and Bookname is null 
```

和

```
select * 
from books
where bookNumber = 012345678
and bookDate = 06062012
and Bookname is null 
```

你得到相同的结果吗？你得到什么结果？

我怀疑是数据类型：某处正在转换某些东西，因此不在一种环境中工作，而是在另一种环境中工作（其中数据类型不同或 SQL 版本不会自动转换）。EG：如果数据作为数字数据类型存储在表中，则 012345678 可以转换为 12345678。但是尝试在没有存储过程和/或临时表的情况下隔离行为，这可能有助于缩小可能的原因......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T17:16:15.057

您没有发布表 Books 的表定义，但是

```
cv_GetBooks '012345678', '06062012' 
--run on SQL server 2008 r2 returns nothing

cv_GetBooks 012345678, 06062012 
--run with out quotes server returns expected result set 
```

如果 BookNumber 和 BookDate 是数字而不是 varchar，可能会导致：

整数中的前导零被删除，当转换为 varchar 时，结果字符串不包含前导零。

也不清楚表中的数据如何影响代码中的执行（IF 语句！）。

# django - 返回 Tastypie 资源的 Django 注释

> ID：11294951
> 
> 赞同：5
> 
> 时间：2012-07-02T13:43:28.697
> 
> 标签：django, tastypie, django-comments

我的 Django 站点有一个 Photo 模型，它代表系统中的照片，我正在使用`Django.contrib.comments`它来允许用户对这些照片进行评论。这一切都很好，但我想扩展我的 Tastypie API 以允许我`PhotoResource`使用 URL访问评论，`/api/v1/photo/1/comments`其中 1 是照片的 id。我能够使 URL 正常工作，但无论我在做什么类型的过滤，我似乎总是返回完整的评论集，而不仅仅是提供的照片集。我在下面包含了我当前代码 API 的精简选择：

```
class CommentResource(ModelResource):
    user = fields.ForeignKey(UserResource, 'user')
    class Meta:
       queryset = Comment.objects.all()
            filtering = {
                'user': ALL_WITH_RELATIONS,
            }

class PhotoResource(ModelResource):
    user = fields.ForeignKey(UserResource, 'user')  
    class Meta:
        queryset = Photo.objects.all()
        filtering = {
            'id': 'exact',
            'user': ALL_WITH_RELATIONS
        }

    def prepend_urls(self):
        return [url(r"^(?P<resource_name>%s)/(?P<pk>\w[\w/-]*)/comments%s$" % (self._meta.resource_name, trailing_slash()), self.wrap_view('get_comments'), name="api_get_comments"),
        ]

    def get_comments(self, request, **kwargs):
        try:
            obj = self.cached_obj_get(request=request, **self.remove_api_resource_names(kwargs))
        except ObjectDoesNotExist:
            return HttpGone()
        except MultipleObjectsReturned:
            return HttpMultipleChoices("More than one resource is found at this URI.")
        comment_resource = CommentResource()
        return comment_resource.get_list(request, object_pk=obj.id, content_type=ContentType.objects.get_for_model(Photo)) 
```

据我所知，最后一行的过滤器不起作用。我认为这有点复杂，因为 contrib.comments 使用 ContentTypes 链接到正在评论的对象，我猜 Tastypie 可能无法应对。我已经尝试了很多变化，但它仍然不起作用。我很确定这样的事情会起作用：

```
ctype = ContentType.objects.get_for_model(obj)
comment_resource = CommentResource()
return comment_resource.get_list(request, object_pk=obj.pk, content_type_id=ctype.id) 
```

但再次返回所有评论。

有没有人有任何想法如何做到这一点（或者甚至可能）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T15:15:54.017

通常我不会将其入侵到 PhotoResource 中，而是在 CommentResource 中进行过滤。您必须为该模型启用过滤，并且 url 看起来像这样：

> /api/v1/comment/?object__pk=1&content_type_id=2

# java - 包装 ExecutorService 以提供自定义执行

> ID：11294952
> 
> 赞同：0
> 
> 时间：2012-07-02T13:43:33.920
> 
> 标签：java, concurrency, monitoring, executorservice, reentrantlock

我想编写一段可重用的代码，以便在将任务提交到执行程序服务时允许等待条件。如果队列中的任务过多，则有很多巧妙的阻塞方式的实现，例如[这里](http://today.java.net/pub/a/today/2008/10/23/creating-a-notifying-blocking-thread-pool-executor.html#suggested-solutions)

我需要一个执行器来评估所有等待的线程，每次任务完成。为了决定是否允许在 atm 提交任务，必须考虑所有活动任务的当前状态。我想出了以下解决方案，它不必针对多个提交者或同时执行的高级任务进行扩展。

**问题：**以下代码可以安全使用，还是我遗漏了一些缺陷？实现`aquireAccess`方法的人`ConditionEvaluator<T>`必须确保查询线程状态的方式是线程安全的，但实现者不需要保护对 activeTasks 集合的迭代。这是代码：

```
public class BlockingExecutor<T extends Runnable> {

    private final Executor executor;

    private final ConditionEvaluator<T> evaluator;

    final ReentrantLock lock = new ReentrantLock();

    final Condition condition = this.lock.newCondition();

    final LinkedList<T> active = new LinkedList<T>();

    private final long reevaluateTime;

    private final TimeUnit reevaluateTimeUnit;

    public BlockingExecutor(Executor executor, ConditionEvaluator<T> evaluator) {
        this.evaluator = evaluator;
        this.executor = executor;
        this.reevaluateTimeUnit = null;
        this.reevaluateTime = 0;
    }

    public BlockingExecutor(Executor executor, ConditionEvaluator<T> evaluator, long reevaluateTime, TimeUnit reevaluateTimeUnit) {
        this.evaluator = evaluator;
        this.executor = executor;
        this.reevaluateTime = reevaluateTime;
        this.reevaluateTimeUnit = reevaluateTimeUnit;
    }

    public void submitTask(final T task) throws InterruptedException {
        this.lock.lock();
        try {
            do{
            if (this.reevaluateTimeUnit == null) {
                this.condition.await(this.reevaluateTime, this.reevaluateTimeUnit);
            } else {
                this.condition.await();
            }
            }while(!this.evaluator.aquireAccess(this.active, task));
                this.active.add(task);
                this.executor.execute(new Runnable() {

                    @Override
                    public void run() {
                        try {
                            task.run();
                        } finally {
                            BlockingExecutor.this.lock.lock();
                            try{
                                BlockingExecutor.this.active.remove(task);
                                BlockingExecutor.this.condition.signalAll();
                            }finally{
                                BlockingExecutor.this.lock.unlock();
                            }

                        }
                    }
                });
        } finally {
            this.lock.unlock();
        }
    }
}

public interface ConditionEvaluator<T extends Runnable> {
    public boolean aquireAccess(Collection<T> activeList,T task);   
} 
```

**问题：**代码可以改进吗？

# vb6 - 标准输入的非阻塞读取？

> ID：11294954
> 
> 赞同：2
> 
> 时间：2012-07-02T13:43:45.263
> 
> 标签：vb6, console-application, stdio

我需要让我的基于表单的应用程序定期检查标准输入以获取输入，但仍执行其他处理。Scripting.TextStream.Read() 和 ReadFile() API 是阻塞的，VB6 中是否有读取标准输入的非阻塞方法？

设置为每 100 毫秒触发一次，`Timer1`我尝试过：

```
Private Declare Function AllocConsole Lib "kernel32" () As Long
Private Declare Function FreeConsole Lib "kernel32" () As Long

Dim sin As Scripting.TextStream

Private Sub Form_Load()

    AllocConsole

    Dim FSO As New Scripting.FileSystemObject
    Set sin = FSO.GetStandardStream(StdIn)

    Timer1.Enabled = True

End Sub

Private Sub Timer1_Timer()

    Dim cmd As String
    While Not sin.AtEndOfStream
        cmd = sin.Read(1)
        Select Case cmd

            ' Case statements to process each byte read...

        End Select
    Wend

End Sub 
```

我也试过：

```
Private Declare Function AllocConsole Lib "kernel32" () As Long
Private Declare Function FreeConsole Lib "kernel32" () As Long
Private Declare Function GetStdHandle Lib "kernel32" (ByVal nStdHandle As Long) As Long
Private Declare Function ReadFileA Lib "kernel32" Alias "ReadFile" (ByVal hFile As Long, lpBuffer As Any, ByVal nNumberOfBytesToRead As Long, lpNumberOfBytesRead As Long, lpOverlapped As Any) As Long
Private Declare Function CloseHandle Lib "kernel32" (ByVal hObject As Long) As Long
Private Const STD_INPUT_HANDLE = -10&

Dim hStdIn As Long

Private Sub Form_Load()

    AllocConsole

    hStdIn = GetStdHandle(STD_INPUT_HANDLE)

    Timer1.Enabled = True

End Sub

Private Sub Timer1_Timer()

    Dim bytesRead as Long
    Dim cmd As String
    cmd = Space$(16)
    cmd = ReadFile(hStdIn, ByVal cmd, Len(cmd), bytesRead, ByVal 0&)

    ' Statements to process each Line read...

End Sub 
```

我也尝试过 ReadConsole() API，它们都阻塞了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T00:13:11.173

恐怕我还没有设法让它发挥作用，但是其他人也许可以试一试。想法是使用带有控制台标准输入的异步 I/O（我假设您的应用程序的想法是允许人们直接写入控制台窗口，并在输入时读取它）。

我将所有 API 内容分离到一个模块（MAsynchConsole）中：

```
Option Explicit

Private Const GENERIC_READ          As Long = &H80000000
Private Const GENERIC_WRITE         As Long = &H40000000
Private Const OPEN_EXISTING         As Long = 3&
Private Const FILE_FLAG_OVERLAPPED  As Long = &H40000000
Private Const FILE_SHARE_READ       As Long = &H1

Private Const FILE_FLAG_NO_BUFFERING As Long = &H20000000

Private Type OVERLAPPED
    Internal                    As Long
    InternalHigh                As Long
    OffsetOrPointer             As Long
    OffsetHigh                  As Long
    hEvent                      As Long
End Type

Private Type OVERLAPPED_ENTRY
    lpCompletionKey             As Long
    lpOverlapped                As Long ' pointer to OVERLAPPED
    Internal                    As Long
    dwNumberOfBytesTransferred  As Long
End Type

Private Declare Function AllocConsole Lib "kernel32" () As Long

Private Declare Function CancelIo Lib "Kernel32.dll" ( _
    ByVal hFile As Long _
) As Long

Private Declare Function CreateFile Lib "Kernel32.dll" Alias "CreateFileW" ( _
    ByVal lpFileName As Long, _
    ByVal dwDesiredAccess As Long, _
    ByVal dwShareModen As Long, _
    ByRef lpSecurityAttributes As Any, _
    ByVal dwCreationDisposition As Long, _
    ByVal dwFlagsAndAttributes As Long, _
    ByVal hTemplateFile As Long _
) As Long

Private Declare Function FreeConsole Lib "kernel32" () As Long

Private Declare Function GetStdHandle Lib "kernel32" ( _
    ByVal nStdHandle As Long _
) As Long

Private Declare Function ReadFile Lib "Kernel32.dll" ( _
    ByVal hFile As Long, _
    ByVal lpBuffer As Long, _
    ByVal nNumberOfBytesToRead As Long, _
    ByRef lpNumberOfBytesRead As Long, _
    ByRef lpOverlapped As OVERLAPPED _
) As Long

Private Declare Function ReadFileEx Lib "Kernel32.dll" ( _
    ByVal hFile As Long, _
    ByVal lpBuffer As Long, _
    ByVal nNumberOfBytesToRead As Long, _
    ByRef lpOverlapped As OVERLAPPED, _
    ByVal lpCompletionRoutine As Long _
) As Long

Private Declare Function CloseHandle Lib "kernel32" (ByVal hObject As Long) As Long

Private m_hStdIn                    As Long
Private m_uOverlapped               As OVERLAPPED
Private m_sUnicodeBuffer            As String

Private m_oReadCallback             As IReadCallback

Public Sub CloseConsole()

    CancelIo m_hStdIn
    Set m_oReadCallback = Nothing
    m_sUnicodeBuffer = vbNullString
    CloseHandle m_hStdIn

    FreeConsole

End Sub

Private Sub FileIOCompletionRoutine( _
    ByVal dwErrorCode As Long, _
    ByVal dwNumberOfBytesTransfered As Long, _
    ByRef uOverlapped As OVERLAPPED _
)

    On Error GoTo ErrorHandler

    m_oReadCallback.DataRead "FileIOCompletionRoutine"
    m_oReadCallback.DataRead "dwErrorCode = " & CStr(dwErrorCode)

    If dwErrorCode Then
        MsgBox "Error = " & CStr(dwErrorCode)
        CloseConsole
        Exit Sub
    End If

    m_oReadCallback.DataRead "dwNumberOfBytesTransfered = " & CStr(dwNumberOfBytesTransfered)

    m_oReadCallback.DataRead Left$(m_sUnicodeBuffer, dwNumberOfBytesTransfered)

Exit Sub

ErrorHandler:
    '
End Sub

Public Sub OpenConsoleForInput(ByRef the_oReadCallback As IReadCallback)

    Dim sFileName                   As String

    On Error GoTo ErrorHandler

    Set m_oReadCallback = the_oReadCallback

    AllocConsole

    'm_hStdIn = GetStdHandle(-10&)

    sFileName = "CONIN$"
    'm_hStdIn = CreateFile(StrPtr(sFileName), GENERIC_READ, FILE_SHARE_READ, ByVal 0&, OPEN_EXISTING,  0&, 0&)
    m_hStdIn = CreateFile(StrPtr(sFileName), GENERIC_READ Or GENERIC_WRITE, FILE_SHARE_READ, ByVal 0&, OPEN_EXISTING, FILE_FLAG_OVERLAPPED, 0&)

    m_oReadCallback.DataRead "m_hStdIn = " & CStr(m_hStdIn)
    m_oReadCallback.DataRead "LastError = " & CStr(Err.LastDllError)

    m_sUnicodeBuffer = Space$(8192)

Exit Sub

ErrorHandler:
    Err.Raise Err.Number, Err.Source, Err.Description
End Sub

Public Sub Read()

    Dim nRet                            As Long
    Dim nBytesRead                      As Long

    On Error GoTo ErrorHandler

    m_oReadCallback.DataRead "About to call ReadFileExe"

    'm_uOverlapped.OffsetHigh = 0&
    'm_uOverlapped.OffsetOrPointer = 0&
    'nRet = ReadFile(m_hStdIn, StrPtr(m_sUnicodeBuffer), LenB(m_sUnicodeBuffer), nBytesRead, m_uOverlapped)
    nRet = ReadFileEx(m_hStdIn, StrPtr(m_sUnicodeBuffer), LenB(m_sUnicodeBuffer), m_uOverlapped, AddressOf FileIOCompletionRoutine)

    m_oReadCallback.DataRead "nRet = " & CStr(nRet)

    m_oReadCallback.DataRead "nBytesRead = " & CStr(nBytesRead)

    If nRet = 0 Then
        m_oReadCallback.DataRead "Err.LastDllError = " & CStr(Err.LastDllError)
    Else
        m_oReadCallback.DataRead StrConv(Left$(m_sUnicodeBuffer, nBytesRead), vbUnicode)
    End If

Exit Sub

ErrorHandler:
    Err.Raise Err.Number, Err.Source, Err.Description
End Sub 
```

这依赖于一个接口 (IReadCallback) 与主 GUI 进行通信。

```
Option Explicit

Public Sub DataRead(ByRef out_sData As String)
    '
End Sub 
```

这是我的示例表单 (FAsynchConsoleTest) - 它使用计时器 (Timer) 和 RichTextBox (txtStdIn)：

```
Option Explicit

Implements IReadCallback

Private Sub Form_Load()

    MAsynchConsole.OpenConsoleForInput Me

    Timer.Enabled = True

End Sub

Private Sub Form_Unload(Cancel As Integer)

    MAsynchConsole.CloseConsole

End Sub

Private Sub IReadCallback_DataRead(out_sData As String)

    txtStdIn.SelStart = Len(txtStdIn.Text)
    txtStdIn.SelText = vbNewLine & out_sData

End Sub

Private Sub mnuTimerOff_Click()

    Timer.Enabled = False

End Sub

Private Sub mnuTimerOn_Click()

    Timer.Enabled = True

End Sub

Private Sub Timer_Timer()

    MAsynchConsole.Read

End Sub 
```

不幸的是，虽然使用 FILE_FLAG_OVERLAPPED 的 CreateFile() 应该创建一个可用于异步 I/O 的文件句柄，并且该句柄似乎有效，但 ReadFileEx() 返回 0，GetLastError 为 6，即：

```
//
// MessageId: ERROR_INVALID_HANDLE
//
// MessageText:
//
// The handle is invalid.
//
#define ERROR_INVALID_HANDLE             6L 
```

有趣的是，当这一切发生时，控制台被冻结了。

其他人有什么想法吗？文档似乎建议，如果您将 CreateFile() 与控制台设备名称一起使用，则该参数将被忽略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T09:14:38.727

使用[vbAdvance](http://vb.mvps.org/tools/vbAdvance/)插件编译以下示例，并选中“构建为控制台应用程序”选项。

```
Option Explicit

'--- for GetStdHandle
Private Const STD_INPUT_HANDLE          As Long = -10&
Private Const STD_OUTPUT_HANDLE         As Long = -11&
'--- for PeekConsoleInput
Private Const KEY_EVENT                 As Long = 1
'--- for GetFileType
Private Const FILE_TYPE_PIPE            As Long = &H3
Private Const FILE_TYPE_DISK            As Long = &H1

Private Declare Function GetStdHandle Lib "kernel32" (ByVal nStdHandle As Long) As Long
Private Declare Function GetConsoleMode Lib "kernel32" (ByVal hConsoleHandle As Long, lpMode As Long) As Long
Private Declare Function SetConsoleMode Lib "kernel32" (ByVal hConsoleHandle As Long, ByVal dwMode As Long) As Long
Private Declare Function PeekNamedPipe Lib "kernel32" (ByVal hNamedPipe As Long, lpBuffer As Any, ByVal nBufferSize As Long, ByVal lpBytesRead As Long, lpTotalBytesAvail As Long, ByVal lpBytesLeftThisMessage As Long) As Long
Private Declare Function ReadFile Lib "kernel32" (ByVal hFile As Long, lpBuffer As Any, ByVal nNumberOfBytesToRead As Long, lpNumberOfBytesRead As Long, ByVal lpOverlapped As Long) As Long
Private Declare Function OemToCharBuff Lib "user32" Alias "OemToCharBuffA" (ByVal lpszSrc As String, ByVal lpszDst As String, ByVal cchDstLength As Long) As Long
Private Declare Function WriteFile Lib "kernel32" (ByVal hFile As Long, lpBuffer As Any, ByVal nNumberOfBytesToWrite As Long, lpNumberOfBytesWritten As Long, lpOverlapped As Any) As Long
Private Declare Function CharToOemBuff Lib "user32" Alias "CharToOemBuffA" (ByVal lpszSrc As String, lpszDst As Any, ByVal cchDstLength As Long) As Long
Private Declare Function PeekConsoleInput Lib "kernel32" Alias "PeekConsoleInputA" (ByVal hConsoleInput As Long, lpBuffer As Any, ByVal nLength As Long, lpNumberOfEventsRead As Long) As Long
Private Declare Function ReadConsoleInput Lib "kernel32" Alias "ReadConsoleInputA" (ByVal hConsoleInput As Long, lpBuffer As Any, ByVal nLength As Long, lpNumberOfEventsRead As Long) As Long
Private Declare Function GetFileType Lib "kernel32" (ByVal hFile As Long) As Long

Sub Main()
    Dim hStdIn          As Long
    Dim sBuffer         As String
    Dim dblTimer        As Double

    hStdIn = GetStdHandle(STD_INPUT_HANDLE)
    Do
        sBuffer = sBuffer & ConsoleReadAvailable(hStdIn)
        If dblTimer + 1 < Timer Then
            dblTimer = Timer
            Call OemToCharBuff(sBuffer, sBuffer, Len(sBuffer))
            ConsolePrint "%1: %2" & vbCrLf, Format$(Timer, "0.00"), sBuffer
            sBuffer = vbNullString
        End If
    Loop
End Sub

Private Function ConsoleReadAvailable(ByVal hStdIn As Long) As String
    Dim lType           As Long
    Dim sBuffer         As String
    Dim lChars          As Long
    Dim lMode           As Long
    Dim lAvailChars     As Long
    Dim baBuffer(0 To 512) As Byte
    Dim lEvents         As Long

    lType = GetFileType(hStdIn)
    If lType = FILE_TYPE_PIPE Then
        If PeekNamedPipe(hStdIn, ByVal 0, 0, 0, lAvailChars, 0) = 0 Then
            Exit Function
        End If
    End If
    If lType = FILE_TYPE_DISK Or lAvailChars > 0 Then
        sBuffer = Space(IIf(lAvailChars > 0, lAvailChars, 512))
        Call ReadFile(hStdIn, ByVal sBuffer, Len(sBuffer), lChars, 0)
        ConsoleReadAvailable = Left$(sBuffer, lChars)
    End If
    If GetConsoleMode(hStdIn, lMode) <> 0 Then
        Call SetConsoleMode(hStdIn, 0)
        Do While PeekConsoleInput(hStdIn, baBuffer(0), 1, lEvents) <> 0
            If lEvents = 0 Then
                Exit Do
            End If
            If baBuffer(0) = KEY_EVENT And baBuffer(4) <> 0 Then ' baBuffer(4) = INPUT_RECORD.bKeyDown
                sBuffer = Space(1)
                Call ReadFile(hStdIn, ByVal sBuffer, Len(sBuffer), lChars, 0)
                ConsoleReadAvailable = ConsoleReadAvailable & Left$(sBuffer, lChars)
            Else
                Call ReadConsoleInput(hStdIn, baBuffer(0), 1, lEvents)
            End If
        Loop
        Call SetConsoleMode(hStdIn, lMode)
    End If
End Function

Public Function ConsolePrint(ByVal sText As String, ParamArray A() As Variant) As String
'    Const FUNC_NAME     As String = "ConsolePrint"
    Dim lI              As Long
    Dim sArg            As String
    Dim baBuffer()      As Byte
    Dim dwDummy         As Long

    '--- format
    For lI = UBound(A) To LBound(A) Step -1
        sArg = Replace(A(lI), "%", ChrW$(&H101))
        sText = Replace(sText, "%" & (lI - LBound(A) + 1), sArg)
    Next
    ConsolePrint = Replace(sText, ChrW$(&H101), "%")
    '--- output
    ReDim baBuffer(1 To Len(ConsolePrint)) As Byte
    If CharToOemBuff(ConsolePrint, baBuffer(1), UBound(baBuffer)) Then
        Call WriteFile(GetStdHandle(STD_OUTPUT_HANDLE), baBuffer(1), UBound(baBuffer), dwDummy, ByVal 0&)
    End If
End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T13:44:39.480

wqw 的答案不适用于基于表单的应用程序，但那里为 Peek/ReadConsoleInput 提供的原型允许这样做：

```
Private Declare Function AllocConsole Lib "kernel32" () As Long
Private Declare Function FreeConsole Lib "kernel32" () As Long
Private Declare Function CloseHandle Lib "kernel32" (ByVal hObject As Long) As Long
Private Declare Function GetStdHandle Lib "kernel32" (ByVal nStdHandle As Long) As Long
Private Declare Function PeekConsoleInput Lib "kernel32" Alias "PeekConsoleInputA" (ByVal hConsoleInput As Long, lpBuffer As Any, ByVal nLength As Long, lpNumberOfEventsRead As Long) As Long
Private Declare Function ReadConsoleInput Lib "kernel32" Alias "ReadConsoleInputA" (ByVal hConsoleInput As Long, lpBuffer As Any, ByVal nLength As Long, lpNumberOfEventsRead As Long) As Long
Private Declare Function ReadFile Lib "kernel32" (ByVal hFile As Long, lpBuffer As Any, ByVal nNumberOfBytesToRead As Long, lpNumberOfBytesRead As Long, ByVal lpOverlapped As Long) As Long
Private Declare Function SetConsoleMode Lib "kernel32" (ByVal hConsoleInput As Long, dwMode As Long) As Long

Private Const STD_INPUT_HANDLE As Long = -10& ' GetStdHandle()

Private Const KEY_EVENT As Long = 1 ' PeekConsoleInput()

Private Const ENABLE_PROCESSED_INPUT As Long = &H1 ' SetConsoleMode()
Private Const ENABLE_ECHO_INPUT As Long = &H4

Dim hStdIn As Long

Private Sub Form_Load()

    AllocConsole

    hStdIn = GetStdHandle(STD_INPUT_HANDLE)
    SetConsoleMode hStdIn, ENABLE_PROCESSED_INPUT ' Or ENABLE_ECHO_INPUT ' uncomment to see the characters typed (for debugging)

    Timer1.Enabled = True

    Exit Sub

End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)

    CloseHandle hStdIn
    FreeConsole

End Sub

Private Sub Timer1_Timer()

    Dim bytesRead As Long
    Dim buffer As String
    Dim baBuffer(0 To 512) As Byte
    Dim lEvents As Long

    PeekConsoleInput hStdIn, baBuffer(0), 1, lEvents
    If lEvents > 0 Then
        If baBuffer(0) = KEY_EVENT And baBuffer(4) <> 0 Then ' baBuffer(4) = INPUT_RECORD.bKeyDown
            buffer = Space$(1)
            Call ReadFile(hStdIn, ByVal buffer, Len(buffer), bytesRead, 0)

            ' buffer now contains one byte read from console
            ' Statements to process go here.

        Else
            Call ReadConsoleInput(hStdIn, baBuffer(0), 1, lEvents)
        End If
    End If
End Sub 
```

如果您的应用程序不是真正的 VB6 控制台应用程序，则 PeekNamedPipe、GetConsoleMode 和 PeekConsoleInput 都将返回零（尽管可能需要的只是与控制台子系统链接，例如，`"C:\Program Files\Microsoft Visual Studio\vb98\LINK.EXE" /EDIT /SUBSYSTEM:CONSOLE MyApp.exe`我还没有测试到那么远）。然而，它们仍然有效，至少 Peek... 有效。

关键是每次通过时只读取一个字节，因为读取 baBuffer 中的内容在第一条记录（INPUT_RECORD 结构）之后是有问题的，但是一次一个字节非阻塞总比没有好。对我来说，Timer1 设置为 100 毫秒，但更好的设置可能是 55 毫秒，即事件时间片。

同样关键的是，如果标准输入上存在事件，则 ReadConsoleInput 是非阻塞的，而不仅仅是要读取的键。当识别的事件不是键时使用它，有效地清除事件，允许应用程序继续。可以使用它从缓冲区中读取字节而不使用 ReadFile：

```
PeekConsoleInput hStdIn, baBuffer(0), 1, lEvents
If lEvents > 0 Then
    Call ReadConsoleInput(hStdIn, baBuffer(0), 1, lEvents)
    If baBuffer(0) = KEY_EVENT And baBuffer(4) <> 0 Then
        ' Chr(baBuffer(14)) now produces the character typed... 
```

除了在构建过程中进行最简单的调试外，这还没有经过测试以读取真正的人工输入，但它确实有效，并且应该允许大多数基于 VB6 表单的应用程序有效地使用控制台。谢谢wqw！

# ruby-on-rails - Rails：范围：使方法可用于所有视图和控制器

> ID：11294955
> 
> 赞同：6
> 
> 时间：2012-07-02T13:43:52.717
> 
> 标签：ruby-on-rails, scope

几天来，我一直在与范围作斗争。我想为所有视图和控制器提供少量方法。假设代码是：

```
def login_role
  if current_user
    return current_user.role
  end
  return nil
end 
```

如果我将它包含在 application_helper.rb 中，那么它仅适用于所有 View，但不适用于所有 Controller

如果我将它包含在 application_controller.rb 中，那么它可用于所有控制器，但不适用于所有视图。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-02T13:50:01.903

使用[`helper_method`](http://api.rubyonrails.org/classes/AbstractController/Helpers/ClassMethods.html#method-i-helper)您的方法`ApplicationController`授予视图访问权限。

```
class ApplicationController < ActionController::Base

  helper_method :login_role

  def login_role
    current_user ? current_user.role : nil
  end

end 
```

考虑将所有相关方法放在它们自己的模块中，然后您可以像这样使它们全部可用：

`helper LoginMethods`

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-07-02T13:43:53.497

创建您自己的库（它可以包含类、模块、方法），并将其放在 lib 目录中。我们称它为 my_lib.rb。

在您的 application_controller.rb 和 application_helper.rb 添加以下行：

```
require 'my_lib' 
```

这将使所有的类、模块、方法对所有视图和控制器都可用

# xml - xslt 中的数据类型

> ID：11294959
> 
> 赞同：0
> 
> 时间：2012-07-02T13:43:58.077
> 
> 标签：xml, xslt, xsd

我正在使用 xslt 转换器开发一个 json 解析器到 xml，即输出是文本类型。但是不提供输出数据类型。例如，输入的 xml 具有字符串或 int 或日期的数据，而 xslt 并没有意识到它们是什么类型，并且都相同地解析它们。我的查询是是否有任何方法可以在 xslt、xsd 中导入 xsd 文件（具有数据类型），然后您可以检查数据类型并相应地转换 Finar。

从已经非常感谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T15:15:41.907

使用模式感知 XSLT 2.0 转换可以做很多事情，但我不确定我是否充分理解了该要求以说明哪些工具是相关的。

您说您正在将 JSON 转换为 XML，但您说输出是文本。我会认为转换是文本输入，XML 输出。

您说“但是不提供输出数据类型”。这句话少了一个主语。您期望数据类型知识来自哪里？您是在解析一个非常具体的 JSON 输入，其结构对于您的样式表来说是已知的，还是在解析任意 JSON？

而且我不知道“Finar”是什么，也不知道它在哪里！

# php - 如何从 Twitter Bootstrap 中的多个下拉菜单中捕获事件？

> ID：11294963
> 
> 赞同：0
> 
> 时间：2012-07-02T13:44:05.593
> 
> 标签：php, jquery, twitter-bootstrap

我有一个表格，其中包含用于个人资料图像列表的多个下拉菜单。我已经用照片的 DB id 标记了列表元素，这样我就可以执行相关的操作。我已将我的表格编码为如下所示：

```
<table class="table table-bordered">
<tbody>
<tr>
  <td><img src="/photos/files/5/m/131309a4fb918110ed1061e90a715eca.jpeg"/></td><td><div class="btn-group">
  <a class="btn btn-primary" href="#"><i class="icon-user icon-white"></i> User</a>
  <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#"><span class="caret"></span></a>
  <ul class="dropdown-menu">
    <li id="5"><a href="#"><i class="icon-pencil"></i> Edit</a></li>
    <li id="5"><a href="#"><i class="icon-trash"></i> Delete</a></li>
  </ul>
</div>
</tr>
<tr>
  <td><img src="/photos/files/5/m/b19102d8ba1158e2a139ffa84e8e8540.jpeg"/></td><td><div class="btn-group">
  <a class="btn btn-primary" href="#"><i class="icon-user icon-white"></i> User</a>
  <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#"><span class="caret"></span></a>
  <ul class="dropdown-menu">
    <li id="7"><a href="#"><i class="icon-pencil"></i> Edit</a></li>
    <li id="7"><a href="#"><i class="icon-trash"></i> Delete</a></li>
  </ul>
</div></tr>    
</tbody>
</table> 
```

我的 jquery 尝试如下但不工作：

```
 $('.dropdown-menu').on('click', 'li', function(e){

         if ($(this).attr('class')=='icon-pencil') {
                var id = $(this).attr('id');
                alert("ID= " + id);
         }

    }); 
```

我从来没有点击过我的警报代码，所以我在这里错过了什么？

还有更好的方法来跟踪照片 ID 或者它们会以这种方式工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T13:55:21.143

您的结构中有 li > a > .icon-pencil 但您正在寻找 this.className on li click（显然是 li）。试试这个：

```
$('.dropdown-menu').on('click', 'li', function(){
    if ($(this).find('icon-pencil').length > 0) {
        var id = this.id;
        alert("ID= " + id);
    }
}); 
```

更简洁的方法是监听锚点上的点击，因为这是通常的点击元素：

```
$('.dropdown-menu').on('click', 'a', function(){
    if ($(this).children('.icon-pencil').length > 0) {
        var id = $(this).closest('li').attr('id');
        alert("ID= " + id);
    }
    return false;
}); 
```

最干净的解决方案是仅在 .dropdown-menu 上设置 ID，因此它们是唯一的，然后通过 .closest('ul') 而不是 .closest('li') 获取它。

PS：重复的 ID 总是不好的。

# android - 捕获异步任务 ANR

> ID：11294964
> 
> 赞同：0
> 
> 时间：2012-07-02T13:44:09.870
> 
> 标签：android, timeout, android-asynctask

如果通过 2g 网络同时下载，我的 downloadFile AsyncTask 可能需要相当长的时间。我怀疑它被杀死了，但我不确定。

我的问题是：asynctask 的超时时间是多少，当 android 杀死我的任务时会调用什么函数？如果抛出异常，在哪里捕获它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:51:43.287

Android 不应该扼杀你的任务。AsyncTask 就是这样，异步的，所以 Android 不会为它抛出 ANR。

如果您想在 doInBackground 中测试异常，请将您的代码包装在相关的 try catch 块中，然后在出现异常时抛出或处理异常。

您可以取消 AsyncTask，但您必须在任务中以相关间隔检查`isCancelled`标志。

一旦你取消了任务，`onPostExecute()`将不会被调用。

当然可以在这里进一步阅读：http: [//developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

补充：请注意，也许重要的是，Android Ice Cream Sandwich 和 Honeycomb 不再将线程池执行作为默认值，而是使用序列化方法。如果您在 ICS 上发现您的任务似乎永远不会被执行，或者在很长一段时间后执行，您应该执行 using`executeOnExecutor()`并将`THREAD_POOL_EXECUTOR`参数传递给它。更多信息可在上面的链接中找到。

# java - Spring MVC 忽略配置的 PropertyEditor 并使用构造函数代替

> ID：11294966
> 
> 赞同：7
> 
> 时间：2012-07-02T13:44:17.257
> 
> 标签：java, spring, spring-mvc

使用 Spring 3.1 并给出这种情况：

```
class Thing {
  public Thing() {}
  public Thing(String someProperty) {}
}

class ThingEditor extends PropertyEditorSupport{
    @Override
    public void setAsText(String text) {
        if (text != null) {
            Thing thing = new Thing(text); // or by using a setter method
            setValue(thing);  

        }

    }
}

class SomeController {
    @InitBinder
    public void initBinder(WebDataBinder binder) {
        binder.registerCustomEditor(Thing.class, new ThingEditor());
    }
} 
```

我发现注册的属性编辑器没有被调用，除非我删除了接受字符串的构造函数`Thing`- 这是对的吗？

为什么这样做并忽略注册编辑，我怎样才能让它停止这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:52:19.877

通过引入自己的构造函数，可以禁用编译器生成的默认构造函数。框架可能需要默认构造函数才能实例化您的事物。如果你真的需要自己的构造函数，你也可以提供一个不带任何参数的版本供框架使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-09T09:29:24.340

注册 PropertyEditorSupport 时锁定属性名称：

```
@InitBinder
public void initBinder(WebDataBinder binder) {
    binder.registerCustomEditor(Thing.class, "someProperty", new ThingEditor());
} 
```

# flash - REST 调用的响应在 as3httpclient Flash 库中混合在一起

> ID：11294967
> 
> 赞同：0
> 
> 时间：2012-07-02T13:44:20.270
> 
> 标签：flash, rest, flex4

我正在使用[**gabriel 的 as3httpclient**](https://github.com/gabriel/as3httpclient)来调用 Flex 4.5 应用程序中的 RESTful JSON API。它似乎工作得很好，但现在我遇到了一个我目前不知道如何解决的问题。我使用的是 lib`HTTPDataListener`而不是普通的`HTTPListener`.

在某一时刻，我正在发送 3 个请求，一个接一个（我们称它们为 A_GET、B_GET 和 C_GET）。对第一个请求的响应得到了适当的处理，但是以下两个请求的响应被混合在一起了：

```
onData(A_GET)
onDataComplete(A_GET)
onComplete(A_GET)    // so far everything's fine and working as expected
onData(B_GET)
onData(C_GET)
onDataComplete(B_GET+C_GET)    // <-- here be dragons!
onComplete(B_GET)
onComplete(C_GET) 
```

问题在于，来自对 B_GET 和 C_GET 的响应的 JSON 数据以某种方式在运行之后/运行时`onData()`和点击之前连接起来`onDataComplete()`。这就是原因，而不是

```
[{ /* GET RESPONSE */ }] 
```

我得到类似的东西

```
[{ /* B_GET RESPONSE */ }][{ /* C_GET RESPONSE */ }] 
```

这显然使 Flash 的本机 JSON 解析器阻塞（导致`SyntaxError: Error #1132: Invalid JSON parse input.`运行时错误），而且我也只输入`onDataComplete()`一次处理程序，而不是每个请求一次，这严重干扰了我的程序流程。

谁能给我指点一下这里发生了什么以及为什么将响应合并为一个？我只是错过了一些重要的事情吗？是否有一个 [easy] 解决方法不需要我重构一半的 RESTful 程序逻辑，甚至不需要切换库来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T15:42:17.987

我找不到问题的根源，所以我只是解决了它。我通过一个函数运行了整个响应体，该函数将它拆分`"]["`，添加缺少的括号，然后将每个片段推入以下响应处理机制。

# javascript - SlideToggle Div 动画

> ID：11294969
> 
> 赞同：1
> 
> 时间：2012-07-02T13:44:29.617
> 
> 标签：javascript, jquery

我有以下 jQuery 代码。

```
$(function() {
    $('.clickme').click(function() {
        $('.totalthing').slideToggle('slow','easeInOutQuart', function() {
            // Animation complete.
        });
        $('.expandedcase').slideToggle('slow','easeInOutQuart', function() {
            // Animation complete.
        });
    });
}); 
```

目前它关闭了一个 div 并同时打开另一个。我想要它做的是关闭打开的 div，然后一旦它完全关闭它就会打开另一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T13:48:49.227

您的评论应该为您指明正确的方向。如果您希望一个动画在另一个动画完成后开始，则将其移至该函数。

```
$(function() {
$('.clickme').click(function() {
$('.totalthing').slideToggle('slow','easeInOutQuart', function() {
    // Animation complete.
    $('.expandedcase').slideToggle('slow','easeInOutQuart', function() {
        // Animation complete.
    });
});

});
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:50:14.100

尝试：

```
$(function() {
    $('.clickme').click(function() {
       var tot = $('.totalthing');
       var exp = $('.expandedcase');

       var frt = (tot.is(":visible"))?tot:exp;
       var lst = (tot.is(":visible"))?exp:tot;

       frt.stop().slideToggle('slow','easeInOutQuart', function() {
          lst.stop().slideToggle('slow','easeInOutQuart', function() {/*complete*/});
       });
    });
}); 
```

# c# - 如何防止输出参数最终返回 WCF Web 服务中的参数？

> ID：11294971
> 
> 赞同：9
> 
> 时间：2012-07-02T13:44:41.827
> 
> 标签：c#, wcf, web-services, c#-4.0, wcf-client

如果我的合同如下所示：

```
[OperationContract]
void DoSomething(int id, out string moreInfo); 
```

这最终看起来像：

```
string DoSomething(int id); 
```

当您导入 Web 服务引用时。是否可以影响参数顺序的自动转换？在函数签名的开头找到所有输出参数已经令人惊讶，但这仍然可行，但我们希望 void-methods 继续成为 void-methods。或者这是 SOAP 限制？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T14:50:14.550

它似乎基于 WSDL 限制： [http ://social.msdn.microsoft.com/Forums/en-US/wcf/thread/48b5992f-f7bd-4b67-8299-514d1780fa9a](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/48b5992f-f7bd-4b67-8299-514d1780fa9a)

> WSDL 不显示原始方法签名；相反，它将输入参数显示为一组，将输出参数显示为另一组。

无法将返回值与输出参数分开的限制在 WSDL 中。但这意味着我认为 void 方法的限制将成为 svcutil.exe 的一部分。没有理由不能在 svcutil 上进行开关以不将第一个输出移动到返回值，但这将是对 ms connect 功能的请求。

如果您的问题是一致性，您可以返回一个简单的状态 int 或 bool，而不是 void，但如果您已经有几十种方法，我敢肯定这不是一个完美的答案。

# android - 单击链接时如何消除发光？

> ID：11294972
> 
> 赞同：1
> 
> 时间：2012-07-02T13:44:44.533
> 
> 标签：android, html, css, safari, webkit

单击链接时如何消除发光？对于 Android 2.3、Safari/533.1 示例[http://pic.lg.ua/l/VR6im/fTYa89/2](http://pic.lg.ua/l/VR6im/fTYa89/2)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T14:36:49.087

在您的 CSS 中：

> [-webkit-tap-highlight-color](http://css-infos.net/property/-webkit-tap-highlight-color) : rgba(0, 0, 0, 0);

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T14:19:19.940

`a:active{outline: none;}`可能会更好

:focus 用于当您点击链接以及其他实例时。

单击时，该元素具有伪类 :active。

# windows - 如何在上下文菜单中使用我的应用程序？

> ID：11294975
> 
> 赞同：0
> 
> 时间：2012-07-02T13:45:08.947
> 
> 标签：windows, path, registry, contextmenu

我知道，我可以在注册表命令中编写“firefox.exe”，但是当我编写像“myapp.exe”这样的应用程序时它不起作用。如果我使用完整路径“C:...\myapp.exe”它可以工作，但应用程序可以安装在其他任何地方，那么如何编写短命令？

另外，在我编写 myapp.exe 时，在运行实用程序中找不到它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:56:42.230

当您告诉 Windows 运行程序并且您没有指定完整路径时，它会查看 PATH 变量，该变量仅包含由“;”分隔的目录字符串 看看它是否在那里找到程序。[在https://superuser.com/questions/284342/what-are-path-and-other-environment-variables-and-how-can-i-set-or-use-them](https://superuser.com/questions/284342/what-are-path-and-other-environment-variables-and-how-can-i-set-or-use-them)上有更详细的解释.

# c# - 如何重用Type返回值生成新的源码

> ID：11294979
> 
> 赞同：5
> 
> 时间：2012-07-02T13:45:41.560
> 
> 标签：c#, .net-2.0

我有这个问题：

我想从对象信息中生成一个新的源代码文件。

我做了这样的事情：

dictParamMapping 是`Dictionary<string, Type>`其中字符串是变量名，Type 是该变量的类型。

我使用以下方法构建新代码的类型：

```
dictParamMapping[pairProcess.Value].Type.Name (or FullName) 
```

当 Type 是 int、string、datatable 等时，一切正常，但当它是字典、列表或任何其他类似的东西时，它会返回如下内容：

```
System.Collections.Generic.Dictionary`2[[System.Int32, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.Double, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] 
```

构建新的源代码是不正确的。我想得到类似的东西`Dictionary<int, double>`

谁能帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T14:52:58.937

您似乎想从`System.Type`. 你可以在[`CSharpCodeProvider`](http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx)课堂上做到这一点。

```
var typeReference = new CodeTypeReference(typeof(Dictionary<int, double>));

using (var provider = new CSharpCodeProvider())
    Console.WriteLine(provider.GetTypeOutput(typeReference)); 
```

输出：

```
System.Collections.Generic.Dictionary<int, double> 
```

请注意，这不能保证始终为您提供有效的类型名称。特别是，编译器生成的类型（例如闭包）通常具有在 C# 中无效的类型名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T14:39:11.747

这不是在 .NET 中生成源代码的理想方式。有官方支持的方法。

框架公开的 API 称为[CodeDOM](http://msdn.microsoft.com/en-us/library/650ax5cx.aspx)。您可以浏览文档和示例以了解它可以做什么。[这是一个启动示例](http://msdn.microsoft.com/en-us/library/ms404245.aspx)，展示了如何生成一个类。CodeDOM 支持 C# 和 VB.NET 作为输出语言。

# jquery - jQuery .offset 从底部位置在滚动功能中不起作用？

> ID：11294981
> 
> 赞同：7
> 
> 时间：2012-07-02T13:45:51.670
> 
> 标签：jquery

我在使用偏移量的滚动功能上设置 2 个位置时遇到问题。

我创建了一个小提琴，所以你可以看到...... [http://jsfiddle.net/motocomdigital/SGCHt/12/](http://jsfiddle.net/motocomdigital/SGCHt/12/)

当您打开这个小提琴时，将小提琴预览视口缩小到与下面的屏幕截图类似的大小。

![在此处输入图像描述](../Images/017c057ae3f3b0ab8c8f1811003c306e.png)

**我的问题**

您可以看到我正在使用条件语句来控制蓝色选项卡的位置，具体取决于它们所在的滚动点。

黄色列代表选项卡容器，我很想使用`if else`语句来控制底部定位，因此蓝色选项卡永远不会超出黄色容器。

但我无法让它工作。我的底部位置偏移不起作用。

```
var $tab = $('.tab-button');

$(window).bind("resize.browsersize", function() {

    var windowHalf = $(window).height() / 2,
        content    = $("#content"),
        pos        = content.offset();

    $(window).scroll(function(){

        if ($(window).scrollTop() >= pos.top + windowHalf ){

            $tab.removeAttr('style').css({ position:'fixed', top:'50%'});

        } else if ($(window).scrollTop() >= pos.bottom + windowHalf ){

            $tab.removeAttr('style').css({ position:'absolute', bottom:'0px'});

        } else {

            $tab.removeAttr('style').css({ top: $(window).height() + 'px' });

        }

    });  

}).trigger("resize.browsersize"); 
```

​</p>

谁能帮我理解我哪里出错了。

谢谢乔什

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-02T17:36:30.820

因此，您似乎必须手动计算元素的底部偏移量。我试图在 jQuery 文档中找到让你的生活更轻松的东西，但一无所获。据说offset只支持top/left

[http://api.jquery.com/offset/](http://api.jquery.com/offset/)

如果我们找到包装器的高度，减去选项卡的高度，我们就可以准确地计算出限制选项卡滚动的位置。

我还包括了标签顶部的 jQuery css 定义。没有定义它 onload，在第一次滚动之前有一个奇怪的文档高度变化。

[http://jsfiddle.net/SGCHt/16/](http://jsfiddle.net/SGCHt/16/)

# objective-c - NSURLConnection 确实触发了didReceiveData，但是返回的数据为零

> ID：11294984
> 
> 赞同：2
> 
> 时间：2012-07-02T13:46:08.080
> 
> 标签：objective-c, nsurlconnection, nsmutabledata

**附加问题：** 现在接收到的总数据长度为 89973。但是使用下面的代码将其转换为字符串会返回一个（空）字符串。**解决了它：**将编码更改为 NSASCIIStringEncoding，现在它可以工作了。

```
NSString *responseString = [[NSString alloc] initWithData:receivedData encoding:NSUTF8StringEncoding];
NSLog(@"Received string: %@", responseString); 
```

**已解决的问题：** 我正在尝试登录网站并获取返回的数据。一切正常，重定向工作正常。

didReceiveData 也被多次调用，但奇怪的是：数据长度为零。即使我从 didReceiveData 中 NSLog 数据长度。

下面是 .m 和 .h 文件以及生成的 NSLog 信息。

我对 Objective-C 很陌生，现在我正在尝试解决这个问题几个小时，但我似乎找不到原因。

我希望有人可以看看我。

这是 .m 文件

```
#import "SiteConnection.h"

@implementation SiteConnection

@synthesize username;
@synthesize password;

// Other
- (void) printInstanceVars {

}

- (void) getInformation {
    // Enable Network Indicator
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:YES];

    // Set the request URL
    url = [NSURL URLWithString:@"http://url.com"];

    // Create the request using the URL defined above
    NSMutableURLRequest * request = [NSMutableURLRequest requestWithURL:url];

    // Change User-Agent to a Browser
    [request setValue:@"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:13.0) Gecko/20100101 Firefox/13.0.1" forHTTPHeaderField:@"User-Agent"];

    // Change method to POST
    [request setHTTPMethod:@"POST"];

    // Create POST string
    NSString *requestData = [NSString stringWithFormat:@"data=value"];

    // Append POST string to the request
    [request setHTTPBody: [requestData dataUsingEncoding:NSUTF8StringEncoding]];

    // Initialize the connection
    NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self startImmediately:NO];

    // Start the connection
    [connection start];
}

- (NSURLRequest *)connection:(NSURLConnection *)connection
         willSendRequest:(NSURLRequest *)request
        redirectResponse:(NSURLResponse *)response
{
    NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;
    int statusCode = [httpResponse statusCode];

    // http statuscodes between 300 & 400 is a redirect ...
    if (response && statusCode >= 300 && statusCode < 400) {
        NSLog(@"Redirecting to : %@ (%u)", [request URL], statusCode);
    }

    return request;
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    [receivedData setLength:0];

    NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;
    NSLog(@"Response: %u (%@)", [httpResponse statusCode], [NSHTTPURLResponse localizedStringForStatusCode:[httpResponse statusCode]]);
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [receivedData appendData:data];
    NSLog(@"Receiving data... Length: %d", [receivedData length]);
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
    NSLog(@"Error: %@", [error localizedDescription]);
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    // Hide Network Indicator
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];

    // Display data length
    NSLog(@"Total received data: %d", [receivedData length]);

    // Convert data into string and display it
    NSString *responseString = [[NSString alloc] initWithData:receivedData encoding:NSUTF8StringEncoding];
    NSLog(@"Received string: %@", responseString);
    //NSLog(@"Cookies: %@", [[NSHTTPCookieStorage sharedHTTPCookieStorage] description]);
} 
```

这是.h文件

```
#import <Foundation/Foundation.h>

@class StatusViewController;

@interface SiteConnection : NSObject {
    NSString *username;
    NSString *password;
    NSURL *url;
    NSMutableData *receivedData;
}

@property NSString *username;
@property NSString *password;

// Other
- (void) printInstanceVars;
- (void) getInformation;

@end 
```

这是生成的 NSLog：

```
2012-07-02 15:41:12.578 Vodafone[25051:11303] Response: 200 (no error)
2012-07-02 15:41:12.578 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.580 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.580 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.582 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.583 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.585 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.586 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.587 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.590 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.590 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.591 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.592 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.596 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.601 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.605 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.608 Vodafone[25051:11303] Receiving data... Length: 0
2012-07-02 15:41:12.608 Vodafone[25051:11303] Total received data: 0
2012-07-02 15:41:12.608 Vodafone[25051:11303] Received string: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:51:13.350

看起来你忘记了：

```
NSMutableData *receivedData = [[NSMutableData alloc] init]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:52:18.680

在我看来，您从未初始化过`receivedData`。因此，您将收到的数据附加到一个 nil 指针，这显然没有任何效果；-)`receivedData = [[NSMutableData alloc] init];`在使用它之前尝试类似的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:57:45.260

做这个：

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    if (!receivedData)
    {
        receivedData = [NSMutableData data];
    }

    [receivedData appendData:data];

    NSLog(@"Receiving data... Length: %d", [receivedData length]);
} 
```

# delphi - Delphi 如何在程序内部等待套接字应答？

> ID：11294988
> 
> 赞同：1
> 
> 时间：2012-07-02T13:46:25.683
> 
> 标签：delphi, sockets, delphi-xe2

对于某些特定需求，我需要在 dll 中创建等待套接字请求（或应答）的过程：

```
TForm1 = class(TForm)
  ServerSocket1: TServerSocket;

......

procedure MyWaitProc; stdcall;
begin
  Go := false;
  while not Go do
  begin
    // Wating...
    // Application.ProcessMessages;     // Works with this line
  end;
end;

procedure TForm1.ServerSocket1ClientRead(Sender: TObject;
  Socket: TCustomWinSocket);
begin
  MessageBoxA(0, PAnsiChar('Received: '+Socket.ReceiveText), '', MB_OK);
  Go := true;
end;

exports
  MyWaitProc; 
```

当我打电话时`Application.ProcessMessages`一切正常：应用程序等待请求然后继续。但在我的情况下，调用`Application.ProcessMessages`会导致在主机应用程序（不是 dll 的）上解锁主窗体。当我不调用`Application.ProcessMessages`应用程序时，它会挂起，因为它无法处理消息......

那么，如何创建这样一个等待套接字应答的程序呢？也许有一种方法可以在不使用的情况下等待套接字回答`Application.ProcessMessages`？

编辑

我也尝试过使用TIdTCPServer，由于某些原因，结果是一样的。

```
TForm1 = class(TForm)
  IdTCPServer1: TIdTCPServer;
.....

procedure MyWaitProc; stdcall;
begin
  Go := false;
  while not Go do
  begin
    // Waiting ...
    // Application.ProcessMessages;
  end;
end;

procedure TForm1.IdTCPServer1Execute(AContext: TIdContext);
var
  s: string;
begin
  s := AContext.Connection.Socket.ReadString(1);
  AllText := AllText + s;
  Go := True;
end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T19:57:11.973

`TServerSocket`默认情况下以非阻塞模式运行，这取决于处理窗口消息。要消除这种依赖关系，您必须将其切换到阻塞模式。

`TIdTCPServer`仅在阻塞模式下运行，因此没有窗口消息。如果你对它有问题，那么你就是在滥用它。例如，在您的`TServerSocket`代码中，您`Go = True`在收到响应后才进行设置，但在您的`TServerSocket`代码中，您`Go = True`在读取响应之前进行设置。

作为替代方案，请查看 Indy 的`TIdSimpleServer`组件。 `TIdSimpleServer`是同步的，一次只接受一个连接，而`TIdTCPServer`异步的，一次接受许多连接。例如：

```
TForm1 = class(TForm) 
  ServerSocket: TIdSimpleServer; 

procedure MyWaitProc; stdcall; 
var
  s: String;
begin 
  ServerSocket.Listen;
  s := ServerSocket.IOHandler.ReadLn;
  ServerSocket.Disconnect;
  MessageBox(0, PChar('Received: '+s), '', MB_OK); 
end; 

exports 
  MyWaitProc; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T13:51:51.830

而不是创建一个偶尔调用的循环，`Application.ProcessMessages`您可以创建一个后代`TThread`并将套接字请求移动到该`TThread.Execute`方法。当线程完成其工作时，使用 TThread.OnTerminate 通知您的表单（或任何其他类）。

有[示例代码](http://radstudiodemos.svn.sourceforge.net/viewvc/radstudiodemos/branches/RadStudio_XE/Delphi/RTL/Threads/)提供了有关如何使用的更多详细信息`TThread`。

还有其他几个[3rd 方](https://stackoverflow.com/q/3419945/71200)线程库，它们要么提供更大的灵活性，要么更容易使用，如果您不熟悉多线程`TThread`，我强烈推荐其中任何一个。`TThread`

注意[：](http://delphi.about.com/od/objectpascalide/a/delphi-processmessages-dark-side.htm)使用`Application.ProcessMessages`. 您在代码中看到其中之一，其中 dll 解锁了应用程序的主窗体。它打破了 VCL 所基于的单线程 UI 模型。 `ProcessMessages`有它的位置，但使用线程更适合您描述的情况。

```
var Slowpoke: TMyLongRunningProcessThread;

procedure MyWaitProc(Completed:TNotifyEvent)
begin
  Slowpoke := TMyLongRunningProcessThread.Create(True);
  Slowpoke.FreeOnTerminate := True;
  Slowpoke.OnTerminate := Completed;
  Slowpoke.Resume;
end; 
```

`MyWaitProc`启动线程后立即返回，因此 GUI 可以自由响应用户操作。当线程终止时，它调用指向的事件处理程序`Completed`。

显然，如果您需要从线程中检索数据，您需要让线程在释放自身之前写入可访问的内存位置，或者删除线程，`FreeOnTerminate`以便可以通过属性从线程中检索数据。

# ios - iOS 上的渐进式视频下载

> ID：11294990
> 
> 赞同：8
> 
> 时间：2012-07-02T13:46:28.463
> 
> 标签：ios, video-streaming, avfoundation, avplayer, progressive-download

我正在尝试在我的 iOS 应用程序中实现可以通过 AVPlayer 播放的视频的[渐进式下载。](https://en.wikipedia.org/wiki/Progressive_download "维基百科文章")我已经实现了一个下载器模块，可以将文件下载到 iPad。但是，我发现我无法播放仍在写入的文件

因此，据我所知，我唯一的解决方案是通过下载文件“块”列表，然后在每个文件准备就绪时继续播放（即：下载），可能使用 HLS

搜索我遇到了[这个通过 hls 实现渐进式下载的问题，](https://stackoverflow.com/questions/10839061/avplayer-not-switching-between-progressive-download-and-streaming)但除此之外，我找不到其他方法

但是，我不断遇到搜索结果，显示如何配置 Web 服务器以利用 iOS 对 HTTP 渐进式下载的支持，但没有提及如何从 iOS 端进行

那么，有人对此有任何想法和/或经验吗？

编辑：我还发现可能有另一种方式（即：流式传输，然后将流式数据写入磁盘），这是[这个问题](https://stackoverflow.com/questions/6259095/caching-with-avplayer-and-avassetexportsession "使用 AVPlayer 和 AVAssetExportSession 进行缓存")所建议的，但仍然无法让它工作，因为它似乎不适用于外地资产！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-23T18:06:31.787

根据您的说法，您可能想要更改方法并尝试流式传输文件。同时下载和播放，我想说的是Streaming的定义。我讨厌人们发布指向 Apple 文档的链接，但在这种情况下，阅读本文档的一小部分会比我以往任何时候都更有帮助。如果您已经开始使用连接和视频，这一切都应该是有意义的，您只需要改变您的方法。链接：[https ://developer.apple.com/library/ios/documentation/networkinginternet/conceptual/streamingmediaguide/Introduction/Introduction.html](https://developer.apple.com/library/ios/documentation/networkinginternet/conceptual/streamingmediaguide/Introduction/Introduction.html)

# java - 通过 MIME 将多个文件附加到 Lotus Domino 中的文档

> ID：11294991
> 
> 赞同：4
> 
> 时间：2012-07-02T13:46:33.277
> 
> 标签：java, mime-types, attachment, lotus-notes, lotus-domino

在我们的企业应用程序中，我们需要将文件附加到文档中。我们在字节数组中有文件名和文件内容。我找到了一种将文件附加到具有 MIME 的文档的解决方案：

```
 final MIMEEntity body = document.createMIMEEntity(fileName);
    final MIMEHeader bodyHeader = body.createHeader("Content-Disposition");

    final boolean isHeaderValSet = bodyHeader.setHeaderVal("attachment; filename=\"" + fileName + "\"");
    if (!isHeaderValSet) {
        throw new ComponentException("Could not set MIME header value.");
    }

    body.setContentFromBytes(fileContentOutput, mimeType, MIMEEntity.ENC_IDENTITY_BINARY);
    final boolean saveSuccessful = document.save();
    if (!saveSuccessful) {
        throw new Exception("Cannot attach file " + fileName + "to document: " + documentUniversalId);
    } 
```

此方法似乎适用于文件，但是当我尝试上传另一个文件时，出现以下异常：

> NotesException: 项目正文已存在

当您只有文件名和字节数组中的内容时，有没有办法将多个文件附加到文档中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-02T14:01:42.453

保留创建名为 body 的“父”MIMEEntity 的第一行。然后在一个循环中，为您希望包含的所有文件创建子 MIMEentities：

```
final MIMEEntity child = body.CreateChildEntity;
child.setHeaderVal("attachment; filename=\"" + fileName + "\"");
child.createHeader("Content-Disposition");
child.setContentFromBytes(fileContentOutput, mimeType, MIMEEntity.ENC_IDENTITY_BINARY); 
```

[创建子实体](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.designer.domino.main.doc/H_CREATECHILDENTITY_METHOD_MIMEENTITY_JAVA.html)

# knockout.js - 剔除复选框更改事件发送旧值

> ID：11294992
> 
> 赞同：35
> 
> 时间：2012-07-02T13:46:44.843
> 
> 标签：knockout.js, knockout-2.0

我遇到了敲除“已检查”绑定的问题。似乎复选框处的“更改”事件在更新之前返回旧值（因此，如果未选中，它将返回 false）。我认为我不能订阅该值，因为我将它包含在对象中。

```
<tbody data-bind="foreach: Categories">
                <tr>
                    <td><input type="checkbox" data-bind="checked: ShowOpened, event: { change: $root.CategoryChange }" /></td>
                </tr>
            </tbody>
<script type="text/javascript">
var Category = function (Id, Name, Order, ShowOpened) {
    this.Id = Id;
    this.Name = Name;
    this.Order = Order;
    this.ShowOpened = ShowOpened;
    this.IsUpdated = ko.observable(false);

    this.OldOrder = Order;
    this.OldShowOpened = ShowOpened;
};
var ViewModel = {
    Categories: ko.observableArray([]),
    CategoryChange: function(pCategory) {
        if(pCategory.Order != pCategory.OldOrder || pCategory.ShowOpened != pCategory.OldShowOpened)
            pCategory.IsUpdated(true);
        else
            pCategory.IsUpdated(false);
    }
};
ko.applyBindings(ViewModel);
</script> 
```

所以在这个例子中，我有 ShowOpened 复选框，它可以触发 CategoryChange 方法，该方法将更改对象内部的变量（稍后我需要知道更新了哪些对象）。但是当 chechbox 被更改时，它总是会发送旧值、触发方法，然后更改值。有没有什么办法解决这一问题？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-07-02T15:10:38.430

由于您坚持说缺少`ko.observables`不是问题，因此我仔细研究了它。看来，你是对的！在设置实际值**之前**`change`触发该事件。恐怕我不知道这是什么原因。

 **但是有一个简单的方法可以解决这个问题：只需将`change`事件更改为`click`事件：

```
<input type="checkbox" data-bind="checked: ShowOpened, click: $root.CategoryChange" /> 
```

请记住，您必须明确地放在事件处理程序`return true;`的末尾。`click`否则新值不会设置为复选框。

如果你不想使用`click`事件，那么你可以用另一种方式来做。订阅以下内容的更改`ShowOpened`：

```
this.ShowOpened = ko.observable(ShowOpened);
this.ShowOpened.subscribe(function(newValue) {
    /* Do something when ShowOpened changes.
       newValue variable holds the new value, obviously. :) */
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-02T14:37:55.153

尝试使用`subscribe`而不是事件绑定。这应该现在可以工作

```
<table>
    <tbody data-bind="foreach: Categories">
        <tr>
            <td><input type="checkbox" data-bind="checked: ShowOpened" /></td>
        </tr>
    </tbody>
<table>

var Category = function (Id, Name, Order, ShowOpened) {
    this.Id = Id;
    this.Name = Name;
    this.Order = Order;
    this.ShowOpened = ko.observable(ShowOpened);
    this.IsUpdated = false;

    this.OldOrder = Order;
    this.OldShowOpened = ShowOpened;

    this.ShowOpened.subscribe(function (newShowOpened) {
        if(this.Order != this.OldOrder || this.ShowOpened() != this.OldShowOpened)
            this.IsUpdated = true;
        else
            this.IsUpdated = false;
    }, this);
};
var ViewModel = {
    Categories: ko.observableArray([])
};
ko.applyBindings(ViewModel); 
```

或者作为替代方案（在我看来，这是一个更好的解决方案），您可以使用`dependentObservable`，现在称为`computed`. 这是它的样子

```
<table>
    <tbody data-bind="foreach: Categories">
        <tr>
            <td>
                <input type="checkbox" data-bind="checked: ShowOpened" />
                <span data-bind="text: IsUpdated"></span>
            </td>
        </tr>
    </tbody>
</table>
var Category = function (Id, Name, Order, ShowOpened) {
    this.Id = Id;
    this.Name = Name;
    this.Order = Order;
    this.ShowOpened = ko.observable(ShowOpened);
    this.OldOrder = Order;
    this.OldShowOpened = ShowOpened;
    this.IsUpdated = ko.computed(function () {
        return this.Order != this.OldOrder || this.ShowOpened() != this.OldShowOpened;
    }, this);
};
var ViewModel = {
    Categories: ko.observableArray([])
};
ko.applyBindings(ViewModel); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-11T11:05:30.087

我也遇到了这个问题，但我无法使用订阅解决方案，因为我已经使用可以重置值的 ajax 请求订阅了同一个字段。然后，当您更改代码时，代码将保持循环。所以我添加了以下解决方法（它丑陋但有效）。

```
$("input[type='radio'], input[type='checkbox']", element).on("change", function (e, data) {
    setTimeout(function () {
        $(this).trigger("afterChange", data);
    }.bind(this), 10);
}); 
```

然后，在收听更改时，我会收听 afterChange 事件。

```
<div data-bind="foreach: answerList">
    <input type="checkbox" data-bind="event: { afterChange: $root.sendSelectedAnswer($data) }"/>
</div> 
```

我知道这不是最好的解决方案，但就我而言，我别无选择。**

# jquery - jQuery 事件处理程序不适用于附加元素

> ID：11294997
> 
> 赞同：1
> 
> 时间：2012-07-02T13:47:12.490
> 
> 标签：jquery

我正在发送 ajax 请求，并将结果附加到一个 div 上。在此附加之后，如果我想单击附加的链接（执行 jquery 单击功能），为什么单击功能不起作用？（抱歉英语不好：P）

编辑：

```
jQuery('.more').live("click",function() {
    var ID = jQuery(this).attr("id");
    if(ID) {
        jQuery("#more"+ID).html('<img src="template/css/images/moreajax.gif" />');
    jQuery.ajax({
        type: "POST",
        url: "loadmore.php",
        data: "lastid="+ ID, 
        cache: false,
        success: function(html){
            $("#contentWall").append(html);
        jQuery("#more"+ID).remove(); // removing old more button
        }
    });
    } else {
        jQuery(".morebox").html('The End');// no results
    }
return false;
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-02T13:51:35.377

您需要使用[`.live()`](http://api.jquery.com/live/)or [`.on()`](http://api.jquery.com/on/)，这取决于您的 jQuery 版本才能正常工作。

常规`.click()`仅适用于当前在 DOM 中的元素，不适用于将来的添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T13:51:49.077

没有更多信息很难确定，但可能你的问题是你正在使用这样的东西

```
// this only bind click handler to existing elements matching selector
$('#mycontainer a').click(function(){...}) 
```

并且您需要[`on`](http://api.jquery.com/on/)用于覆盖动态添加的元素。

```
// this bind click handler to current and future elements matching selector
$('#mycontainer').on('click','a',(function(){...}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T13:52:53.537

当您的页面最初加载时，您的点击事件将绑定到您的链接。这意味着之后引入 DOM 的任何新链接都没有绑定点击事件。您需要将 click 事件绑定到要附加的链接：

```
$(newlink).click(function(event){
    // your onclick code
});
$(mydiv).append(newlink); 
```

# actionscript-3 - 想要在 spark DataGrid 中显示客户排序指示器？

> ID：11294999
> 
> 赞同：0
> 
> 时间：2012-07-02T13:47:20.843
> 
> 标签：actionscript-3, apache-flex, air, flash-builder4.5

我的应用程序中有数据网格，我想自定义我的数据网格，所以我为列和标题制作了一个渲染器，但现在的问题是**我想制作指示排序列的自定义指示器**。？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T14:29:34.490

1.  通过复制创建自定义标题渲染器`spark.skins.spark.DefaultGridHeaderRenderer`
2.  找到带有 id 的内部组件`defaultSortIndicator`并根据需要进行编辑
3.  将新渲染器分配给列：`<s:GridColumn headerRenderer="path.to.MyHeaderRenderer" />`
4.  如果您想将其默认分配给所有列，您还可以创建自定义 DataGrid 皮肤并将`headerRenderer`内部组件替换为您的自定义渲染器：

.

```
<fx:Component id="headerRenderer">
    <myskins:MyHeaderRenderer />
</fx:Component> 
```