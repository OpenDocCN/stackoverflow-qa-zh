# StackOverflow 问答 000544000-000544999

# asp.net-mvc - 在 ASP.NET MVC 中，返回 RedirectToAction 时保留 URL

> ID：544000
> 
> 赞同：3
> 
> 时间：2009-02-12T23:28:04.320
> 
> 标签：asp.net-mvc, transfer, redirecttoaction

我有一个动作方法，根据传递给它的内容，我想重定向到另一个控制器中的另一个动作。动作和控制器名称是在运行时确定的。

如果我返回 RedirectToAction()，它将强制重定向并更改浏览器中的 URL。我想要的是类似于 TransferToAction() 的东西，它可以将当前请求的处理转移到另一个动作，而无需进行重定向。我似乎记得在早期的预览中有这样的方法，但我似乎无法在 ASP.NET MVC 的 RC 中找到它。

你知道我会怎么做吗？

更新

我添加了以下路线：

```
routes.MapRoute(
    "PageRouter",
    "{site}/{*url}",
    new { controller = "PageRouter", 
          action = "RoutePage", site = "", url = "" }
); 
```

和 PageRouter 控制器动作 RoutePage：

```
public ActionResult RoutePage(string site, string url)
{
    var controller = new HomeController {ControllerContext = ControllerContext};
    controller.RouteData.Values["controller"] = "Home";
    controller.RouteData.Values["action"] = "Index";

    return controller.Index(site, url);
} 
```

我必须在 RouteData 中设置控制器和操作才能呈现 Home Index 视图。否则，它将在 PageRouterController 中查找索引视图。

我仍然需要弄清楚如何创建一个控制器及其只知道它们的名称的动作。例如，我希望能够调用这样的东西：

```
public ActionResult RoutePage(string site, string url)
{
    return InvokeAction("Home", "Index");
} 
```

InvokeAction() 应该做什么？我需要传递任何上下文吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T23:36:12.583

您应该能够直接调用另一个方法，并且假设它返回一个 ViewResult，它将呈现该视图以响应请求并且 url 不会改变。请注意，您将负责确保其他方法所需的所有数据对其可用。例如，如果您的其他方法需要一些未提供的表单参数，您可能需要构造一个合适的 FormCollection 并根据您的 FormCollection 将控制器的 ValueProvider 设置为 ValueProvider。方法所需的任何参数也是如此。

# language-agnostic - 不存在“游戏特定”库的游戏编程

> ID：544003
> 
> 赞同：4
> 
> 时间：2009-02-12T23:29:21.587
> 
> 标签：language-agnostic

如果有人想用一种不寻常的语言编写游戏，但没有库或函数来操作图形，这将如何实现？通过编写自己的低级例程？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T23:35:02.027

你站在房子旁边。一条路向东延伸，向南有一条狭窄的小路通向房子的后面。

这里有一个邮箱。

你做什么工作？_

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-12T23:31:51.300

通过与 OpenGL 接口，它是独立于显卡的 API。

有关这意味着什么以及如何完成的具体示例，请[查看 Python 的 OpenGL 绑定](http://pyopengl.sourceforge.net/)

[在此处](http://www.opengl.org/resources/bindings/)查找与其他语言的绑定。

**为什么你必须这样做？**

好吧，图形编程高度依赖硬件（即显卡），其中有很多。OpenGL是他们都懂的标准语言。（我认为 Direct3D 也可以这样说，但它归微软所有，而 OpenGL 更开放）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T23:38:00.553

了解它如何与 C 库交互，然后使用它来创建与 OpenGL、DirectX 或 OpenAL 的接口。或者，您可以移植其他内容，例如 SDLlib。在一个奇怪的情况下，您可能想要嵌入一种具有您想要的库的语言。假设它是 Java3D 并且您想用 Mono 2.2 编译它。我不确定这是否可行，但单一项目的变化之一是 Java 支持。当然，在 Mono 上，您还有其他游戏库选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-12T23:34:20.390

如果您打算使用图形硬件，您需要有它的驱动程序和 OpenGL 或 DirectX。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T23:37:41.410

如果您正在为一些奇特的有限硬件进行编程，那么您可以做的只有这么多。如果除了以某种极其有限的方式（也许您所能做的只是渲染一串文本）之外，您根本无法访问屏幕，那么您无能为力。

如果您在普通计算机上执行此操作，但您选择的语言根本没有任何 OpenGL 或 DirectX 绑定，那么您需要自己编写一些。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T23:32:20.177

传统智慧会建议“使用最好的工具来完成这项工作”，如果没有现有的库来为您的语言处理图形，那么它可能不是这项工作的最佳工具。

# sql-server - Sybase/SQLServer 数据库上的表统计信息过期有什么影响？

> ID：544007
> 
> 赞同：0
> 
> 时间：2009-02-12T23:29:45.550
> 
> 标签：sql-server, performance, tsql, sybase, table-statistics

例如，对于数量为 1000 万行且每月增长 100 万行的大量使用表，如果统计数据是 6 到 8 个月的数据，这对数据库的性能会有多大的不利影响？你应该多久刷新一次统计数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T23:35:17.687

统计信息由查询计划器保存和使用，它们具有显着的影响。我不能给你确切的指导方针，告诉你应该多久刷新一次。这将取决于刷新它们需要多少工作以及新统计数据对您的查询有多大影响。真正的答案是进行良好的测量并根据结果判断选项。没有测量的修补是掷骰子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-15T10:26:17.017

我们每晚都会刷新统计数据。如果统计数据可以每晚刷新，那么等待周末是没有意义的——到周五，情况会比周一更糟……

问题是如果时间太长怎么办？

对于有这个问题的数据库，我们每晚都会刷新某些表的统计信息——所以有些表每晚都会完成，有些则不那么频繁。（我们有一个数据库表，其中包含何时执行哪些表，以及统计数据重新生成所需时间的历史记录，并相应地调整时间表）

> > 如果统计数据是 6-8 个月大，这对数据库的性能有多大的不利影响

如果它对每月增长 100 万行的表没有太大的影响，我会感到非常惊讶

如果那是您的实际状态，我希望表也需要碎片整理

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T19:52:40.417

影响是可怕的。您应该尽可能频繁地刷新它们，以便为优化器提供最佳信息以做出决策。通过运行 optdiag 实用程序，您将能够找出统计数据的糟糕程度。分析输出并再次运行以比较几天或一周将使您确切知道情况有多糟糕。我建议您尽早删除并重新创建索引并在相关表上运行“更新索引统计信息”。这应该足以让您通过。我假设您能够分析 optdiag 的输出。

# html - id 和 class 有什么区别？

> ID：544010
> 
> 赞同：233
> 
> 时间：2009-02-12T23:30:10.883
> 
> 标签：html, css

CSS之间`<div class="">`有什么区别？`<div id="">`可以用`<div id="">`吗？

我看到不同的开发人员以两种方式这样做，而且由于我是自学成才的，所以我从来没有真正弄清楚。

* * *

## 回答 #1

> 赞同：336
> 
> 时间：2009-02-12T23:38:15.403

`ids``class`在可以应用于许多事物的情况下，必须是唯一的。在 CSS 中，`id`s 看起来像`#elementID`，`class`元素看起来像`.someClass`

一般来说，`id`只要你想引用一个特定的元素，并且`class`当你有许多相似的东西时，就使用它。例如，常见`id`的元素是`header`, `footer`, `sidebar`. 常见的元素是或`class`之类的东西。`highlight``external-link`

阅读级联并了解分配给各种选择器的优先级是一个好主意：http: [//www.w3.org/TR/CSS2/cascade.html](http://www.w3.org/TR/CSS2/cascade.html)

但是，您应该了解的最基本的优先级是`id`选择器优先于`class`选择器。如果你有这个：

```
<p id="intro" class="foo">Hello!</p> 
```

和：

```
#intro { color: red }
.foo { color: blue } 
```

文本将是红色的，因为`id`选择器优先于`class`选择器。

* * *

## 回答 #2

> 赞同：162
> 
> 时间：2009-02-13T22:46:00.963

也许一个类比将有助于理解差异：

```
<student id="JonathanSampson" class="Biology Calculus" />
<student id="MarySmith" class="Biology Networking" /> 
```

学生**证**是不同的。校园里没有两个学生会拥有同一张学生**证**。但是，许多学生可以并且将彼此共享至少一个**班级**。

可以将多个学生放在一个**班级**名称下，例如生物学。但是将多个学生放在一个学生**证**下是绝对不能接受的。

在学校对讲系统上给出规则时，您可以将**规则****分配**给**班级**：

> “明天，所有学生都要穿红衬衫上生物课。”

```
.Biology {
  color: red;
} 
```

或者，您可以通过调用特定学生的唯一**ID**来为特定学生提供规则：

> “乔纳森·桑普森明天要穿一件绿衬衫。”

```
#JonathanSampson {
  color: green;
} 
```

在这种情况下，Jonathan Sampson 收到两个命令：一个是生物学课的学生，另一个是直接要求。因为通过 id 属性直接告诉 Jonathan 穿绿色衬衫，所以他将忽略之前的穿红色衬衫的请求。

更具体的选择器获胜。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-04-05T20:20:52.747

## 在哪里使用 ID 与类

两者之间的简单区别在于，虽然一个类可以在一个页面上重复使用，但一个 ID 每页只能使用一次。因此，在标记页面主要内容的 div 元素上使用 ID 是合适的，因为只有一个主要内容部分。相反，您必须使用一个类来设置表格上的交替行颜色，因为根据定义它们将被多次使用。

ID 是一个非常强大的工具。具有 ID 的元素可以是一段 JavaScript 的目标，该 JavaScript 以某种方式操纵该元素或其内容。ID 属性可以用作内部链接的目标，将锚标记替换为名称属性。最后，如果您使您的 ID 清晰且合乎逻辑，它们可以作为文档中的一种“自我文档”。例如，如果块的开始标签的 ID 为“main”、“header”、“footer”，则不必在块之前添加注释说明代码块将包含主要内容“， ETC。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-12T23:31:46.230

一个 id 在整个页面中必须是唯一的。

一个类可能适用于许多元素。

有时，使用 id 是个好主意。

在一个页面中，您通常有一个页脚，一个页眉......

然后页脚可能会进入带有 id 的 div

> <div id="footer" class="...">

仍然有课

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-12T23:34:18.453

ID 是唯一的。上课不是。元素也可以有多个类。类也可以动态地添加和删除到元素中。

在任何可以使用 ID 的地方，您都可以使用类。反过来是不正确的。

惯例似乎是对每个页面上的页面元素（如“navbar”或“menu”）使用 ID 并为其他所有内容使用类，但这只是惯例，您会发现用法差异很大。

另一个区别是，对于表单输入元素，该`<label>`元素通过 ID 引用字段，因此如果要使用`<label>`. 是一个可访问性的东西，你真的应该使用它。

在过去的几年里，ID 也是首选，因为它们很容易在 Javascript (getElementById) 中访问。随着 jQuery 和其他 Javascript 框架的出现，这几乎不再是问题。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-12T23:35:42.977

一个**CLASS**应该用于您想要相同样式的多个元素。**ID**应该用于唯一元素。请参阅本[教程](http://css-tricks.com/the-difference-between-id-and-class/)。

如果您想成为一个严格的遵从者，或者如果您希望您的页面通过标准[验证](http://validator.w3.org/)，您应该参考[W3C](http://www.w3.org/TR/CSS2/selector.html)标准。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-12T23:53:34.603

类就像类别。许多 HTML 元素可以属于一个类，一个 HTML 元素可以有多个类。类用于应用通用样式或可跨多个 HTML 元素应用的样式。

ID 是标识符。它们是独一无二的；不允许其他人拥有相同的 ID。ID 用于将独特的样式应用于 HTML 元素。

我以这种方式使用 ID 和类：

```
<div id="header">
  <h1>I am a header!</h1>
  <p>I am subtext for a header!</p>
</div>
<div id="content">
  <div class="section">
    <p>I am a section!</p>
  </div>
  <div class="section special">
    <p>I am a section!</p>
  </div>
  <div class="section">
    <p>I am a section!</p>
  </div>
</div> 
```

在此示例中，标题和内容部分可以通过#header 和#content 设置样式。内容的每个部分都可以通过#content .section 应用一种通用样式。只是为了好玩，我为中间部分添加了一个“特殊”类。假设您希望特定部分具有特殊样式。这可以通过 .special 类来实现，但该部分仍然从 #content .section 继承通用样式。

当我进行 JavaScript 或 CSS 开发时，我通常使用 ID 来访问/操作一个非常特定的 HTML 元素，并且我使用类来访问/应用样式到广泛的元素。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-13T21:54:46.953

CSS是面向对象的。ID 表示实例，类表示类。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-05-30T09:27:43.517

应用 CSS 时，将其应用到一个类上，并尽量避免应用到一个 id 上。ID 只能在 JavaScript 中用于获取元素或用于任何事件绑定。

应该使用类来应用 CSS。

有时您必须使用类进行事件绑定。在这种情况下，尽量避免用于应用 CSS 的类，而是添加没有相应 CSS 的新类。当您需要更改任何类的 CSS 或更改任何元素的 CSS 类名称时，这将有所帮助。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-12-07T19:52:44.897

CSS 选择器空间实际上允许条件 id 样式：

```
h1#my-id {color:red}
p#my-id {color:blue} 
```

将按预期呈现。你为什么要这样做？有时 ID 是动态生成的，等等。进一步的用途是根据高级 ID 分配以不同方式呈现标题：

```
body#list-page #title {font-size:56px}
body#detail-page #title {font-size:24px} 
```

就个人而言，我更喜欢更长的类名选择器：

```
body#list-page .title-block > h1 {font-size:56px} 
```

我发现使用嵌套 ID 来区分治疗有点不合常理。只要知道，随着[Sass](http://en.wikipedia.org/wiki/Sass_%28stylesheet_language%29) / [SCSS](https://en.wikipedia.org/wiki/Sass_(stylesheet_language))世界的开发人员接触到这些东西，嵌套 ID 正在成为常态。

最后，在选择器性能和优先级方面，ID 往往胜出。这是一个完全不同的主题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-12T23:34:22.353

类用于将您的样式应用于一组元素。ID 样式仅适用于具有该 ID 的元素（应该只有一个）。通常您使用类，但如果有一次性的，您可以使用 ID（或者直接将样式粘贴到元素中）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-12T23:35:15.130

任何元素都可以有一个类或一个 ID。

一个类用于引用某种类型的显示，例如您可能有一个用于表示此问题答案的 div 的 css 类。由于会有很多答案，因此多个 div 需要相同的样式，并且您将使用一个类。

id 仅指单个元素，例如右侧的相关部分可能具有特定于它的样式，而不是在其他地方重用，它将使用 id。

从技术上讲，您可以对所有这些使用类，或者在逻辑上将它们拆分。但是，您不能为多个元素重用 id。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-02-14T16:18:37.020

在高级开发**id**中我们基本上可以使用 JavaScript。

出于可重复的目的，与应该是唯一的**id不同，** **class**派上用场了。

 **以下是说明上述表达式的示例：

```
<div id="box" class="box bg-color-red">this is a box</div>
<div id="box1" class="box bg-color-red">this is a box</div> 
```

现在您可以在这里看到`box`和`box1`是两 (2) 个不同的**`<div>`**元素，但我们可以将`box`和`bg-color-red`类应用于它们。

这个概念是[OOP](http://en.wikipedia.org/wiki/Object-oriented_programming)语言中的继承。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-06-22T07:16:19.673

1) div id 不可重用，只能应用于 HTML 的一个元素，而 div 类可以添加到多个元素。

2) id 更重要，如果两者都应用于同一个元素并且具有冲突的样式，则将应用 id 的样式。

3) 样式元素总是通过放置一个 . （点）在他们的名字前面，而 ​​div id 类是通过在他们的名字前面放一个 # （哈希）来引用的。

4）示例：-

> 声明中的类`<style>`-`.red-background { background-color: red; }`
> 
> 声明中的 id `<style>`- `#blue-background {background-color: blue;}`
> 
> `<div class="red-background" id="blue-background">Hello</div>` 这里的背景将是蓝色的

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-02-27T06:55:15.133

`id`并且`class`是两个[全局/标准 HTML 属性](https://www.w3schools.com/tags/ref_standardattributes.asp)（下面的全局属性可用于任何 HTML 元素。）

`class`为元素指定一个或多个类名（指样式表中的类）

`id` 指定元素的唯一 ID

id 属性提供了一个元素文档范围的唯一标识符，其中 class 属性提供了一种对相似元素进行分类的方法。

id 属性值在 HTML 页面中必须是唯一的，其中 class 属性可以在您想要应用相同属性的任何地方重复使用

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-02-27T15:39:59.090

类用于具有共同属性的多个元素。例如，如果您希望 p 和 body 标记使用相同的颜色和字体，请使用类属性或在一个部门本身中。

另一方面，ID 用于突出显示单个元素的属性，并且仅用于特定元素。例如，我们有一个带有一些属性的 h1 标签，我们不希望它们在整个页面的任何其他元素中重复。

需要注意的是，如果我们在一个元素中同时使用 class 和 id，*id 会覆盖类属性。*仅仅是因为 id 专用于单个元素

参考下面的例子

```
<html>
<head>
<style>
    #html_id{
        color:aqua;
        background-color: black;

    }
    .html_class{
        color:burlywood;
        background-color: brown;
    }
</style>

   </head>
    <body>
<p  class="html_class">Lorem ipsum dolor sit amet consectetur adipisicing 
   elit. 
    Perspiciatis a dicta qui unde veritatis cupiditate ullam quibusdam! 
     Mollitia enim, 
    nulla totam deserunt ex nihil quod, eaque, sed facilis quos iste.</p>
    </body>
   </html> 
```

我们生成输出

[输出](https://i.stack.imgur.com/4XluV.png)

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2020-08-07T22:25:58.487

在 CSS 中，类选择器是一个以句号 (“.”) 开头的名称，而 ID 选择器是一个以井号 (“#”) 开头的名称。ID 和类之间的区别在于，ID 可用于标识一个元素，而类可用于标识多个元素。

# php - Convincing an IT Manager to allow SQL Server instead of Access

> ID：544025
> 
> 赞同：4
> 
> 时间：2009-02-12T23:34:11.340
> 
> 标签：php, asp.net, sql, ms-access

An IT Manager is not allowing the use of SQL Server with an ASP.NET website being developed. The current setup being replaced is a php site connecting to a Microsoft Access database. I have a few reasons of my own as to why SQL should be used, but would like as many strong arguments as possible (student vs. IT Man.). Does anyone have any strong arguments on why SQL should be used? Particularly posed towards an IT Manager who has stated "this is the way we have been doing it, and [it] has been working."

Thanks in advance!

**UPDATE**

In the interest of 'unloading' this question... If you would recommend keeping Access, when and why?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-12T23:38:56.087

Do a load test on your finished product and prove that Access isn't meant for powering websites.

Write your code so that you can change out the database back end easily. Then when access fails migrate your data to a real db, or MySQL if you have to.

Here are some [Microsoft Web server stress tools](http://support.microsoft.com/kb/231282)

For the record, it is possible to send mostly SQL commands to the database and not keep an active connection open, thereby allowing far more than 6 or 7 connections at once, but the fact is that access just isn't meant to do it. So the "it works fine" point is like saying it is fine to clean your floor with sticky tape: it works, but isn't the right tool for the job.

**UPDATED ANSWER TO UPDATED QUESTION:**

Really the key here is the separation of data access in your code. You should be able to more or less have the data database structure in any number of DBMS. Things can get complicated, but a map of tables should be universal. Then should access not work, decide to use a different database.

Access CAN be used in kinda high traffic sites. With the SQL statement only routines I was able to build an e-commerce site that did a couple million a year in sales, and had 60K visitors a month. It is possible, but maybe not ideal. Those aren't big numbers, but they are the biggest for any site I have been a part of.

Keep access if IT Manager is too busy to maintain another server, or unwilling to spend time configuring one. Ultimately guessing does nothing, and testing tells you everything you need to know. Test and make decisions on the results.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-12T23:40:00.687

Here's a document from Microsoft that might help:

[Access vs. Sql Server](http://www.microsoft.com/sql/solutions/migration/access/compare-access.mspx)

[Another Article](http://designstudio222.com/access_vs_sql.html).

My own personal thoughts, Access has no place in an environment that could scale beyond more than two or three concurrent connections. Would you use Excel as the back end?

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T23:44:05.747

Your manager has stated the reason he wants to use Access. Are you responsible for designing an alternative? Do you have any reason to think you will benefit from proving your manager wrong? What is your personal upside in this conversation? Are you certain that Access won't be "good enough"? Is the redesigned site going to have heaver or different loads (i.e. more users, or less efficient design)? I'm not sure you want to be arguing with your manager that you can't implement something that does as well as the old design.

It's going to be a lot easier to let the project fail (if you expect that will be the outcome) and rescue it with SQL Server, than to get your manager to concede that you understand the situation better than he does.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T23:42:00.370

Don't forget that for something as small as most Access Databases, you can use SQL Server Express Edition, which is free, so it won't cost you anything.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T23:43:14.423

I found this nice quote as well:

> It is not recommended to use an Access database in a production web application. For production purposes, consider connecting to a Microsoft™ SQL Server database using the SqlDataSource or ObjectDataSource controls.

[http://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/accessdatasource.aspx](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/accessdatasource.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-13T00:13:44.803

Don't argue, benchmark it. Real data should trump rhetoric (in a rational world, at least! ;-)

Set up text boxen with the two alternatives and run 'em hard. (If you're exposing web services, you can use a tool such as [SoapUI](http://www.soapui.org/) for automated stress testing. There are lots of other tools in this space.) Collect stats and analyze them to determine the tradeoffs.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T23:39:16.430

One simple reason to use SQL Server instead of a Microsoft Access Database: The MS Access DB can result in a bottleneck if the DB will be used heavily by a lot of users.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-12T23:42:45.127

Licensing for one. I doubt he wants to have hundreds of Office licenses (one for each end user that connects to the site). SQL has licenses that allows multiple connects at the same time without specific connection licenses.

Not to mention scalability and reliability issues. SQL Server ios designed to be used and administrated in a 24/7 environment. Access has not.

SQL can scale to squillions of simultaneous connections, Access cannot.

SQL can backup while operating, Access cannot.

SQL is designed as a highly robust data repository, Access is not designed with the same requirements in mind.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-12T23:42:46.967

Access doesn't deal with multiple users very well (at all?). This means if you have more than one person trying to access or especially update your site it's very likely to die or at best be very slow.

There's much better tooling around SQL Server (linq to sql or entity framework or any number of ORMs).

SQL express is a much better choice than access for a web site backend and it's free.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-12T23:47:29.873

Consider the option that maybe he is right. If it is working fine with Access just leave it like this. If there are scalability problems in the future ( the site is used from more than 1 user simultaneously), than it his problem, not yours.

Also consider sqlite, may be better than access

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-13T00:55:39.930

Just grab a testsuite (or just throw one together):

1.  compare the time taken for create a db with 1000,000 enteries.
2.  search an entry in the db.
3.  Vaccum the db
4.  Delete the db
5.  Do couple of operations that you think will be done more on the db couple of times.

and do it infront of him to compare (write a script).My guess is that either your IT manager is joking, or the site that you are working on are non critical and he doesn't want to allocate resources(including you).

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-02-13T01:00:31.820

MS Access is for 1 desk 1 user ! I was spending a year in a previous project to detach an application (growing to enterprise size in terms of users) from Access because its strange locking behavior and awful performance. SQL Server Express Edition is a good starting point, as echoed from previous posts.

# ruby - 正则表达式删除 HTML 标签的问题

> ID：544031
> 
> 赞同：5
> 
> 时间：2009-02-12T23:34:39.233
> 
> 标签：ruby, regex, string, encoding

在我的 Ruby 应用程序中，我使用以下方法和正则表达式从字符串中删除所有 HTML 标记：

```
str.gsub(/<\/?[^>]*>/,"") 
```

这个正则表达式几乎完成了我所期望的所有事情，除了它导致所有引号都被转换为`&#8220;` 并且所有单引号被更改为`&#8221;` .

将凌乱的代码转换回正确的字符时，我缺少什么明显的东西？

**编辑：有或没有正则表达式都会出现问题，所以很明显我的问题与它无关。我现在的问题是如何处理这个格式错误并纠正它。谢谢！**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-14T23:04:20.057

在执行正则表达式替换后使用 CGI::unescapeHTML：

```
CGI::unescapeHTML(str.gsub(/<\/?[^>]*>/,"")) 
```

见[http://www.ruby-doc.org/core/classes/CGI.html#M000547](http://www.ruby-doc.org/core/classes/CGI.html#M000547)

在上面的代码片段中，gsub 删除了所有 HTML 标记。然后，unescapeHTML() 将所有 HTML 实体（例如 <、“）恢复为它们的实际字符（<、引号等）

关于此页面上的另一篇文章，请注意，您*永远*不会收到 HTML，例如

```
<tag attribute="<value>">2 + 3 < 6</tag> 
```

（这是无效的 HTML）；相反，您可能会收到：

```
<tag attribute="&lt;value&gt;">2 + 3 &lt; 6</tag> 
```

对 gsub 的调用会将上述内容转换为：

```
2 + 3 &lt; 6 
```

unescapeHTML 将完成这项工作：

```
2 + 3 < 6 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T23:45:50.690

当您看到类似以下内容时，您将遇到更多麻烦：

```
<doohickey name="<foobar>"> 
```

您需要应用以下内容：

```
gsub(/<[^<>]*>/, "") 
```

...只要模式匹配。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T00:10:16.620

> 这个正则表达式几乎完成了我所期望的一切，除了它导致所有引号都转换为 " 并且所有单引号被更改为 " 。

这听起来好像 RegExp 不会这样做。你确定和以前不一样？

有关该问题的信息，请参见此处的此问题，它有一个很好的答案：
[Get non UTF-8 form fields as UTF-8 in php。](https://stackoverflow.com/questions/544071/get-non-utf-8-form-fields-as-utf-8-in-php/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T21:15:00.903

我在字符更改方面遇到了类似的问题，这发生在我的代码通过另一个强制执行 UTF-8 编码的模块时，然后当它回来时，我手上有一个不同的文件（slurped 行数组）。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-02-12T23:40:29.360

您可以使用多通道系统来获得您正在寻找的结果。

运行正则表达式后，运行一个表达式来转换**&8220;** 到引号和另一个转换**&8221;** 到单引号。

# sql - C# 使用 LIKE 查看 X 是否包含 Y

> ID：544037
> 
> 赞同：0
> 
> 时间：2009-02-12T23:35:46.423
> 
> 标签：sql, sql-server, tsql, sql-like

我继承了下面的代码，但我很困惑，因为代码工作得很好，但我不相信它是正确的。我以前没有使用过 LIKE，所以我无法决定是否应该费心改变它。这在你看来如何？

该代码用于 db 中的过滤器，它检查 X 值是否包含 Y 值，在 X 中找到 X*（例如，匹配将是 Fun 和 Fan 中的 F*），并且 X 不包含 Y。

感谢您的意见。

```
foreach (ListViewItem item in listView1.Items)
                {
                    strStuff += item.Text;
                    object o = item.SubItems[1].Tag;
                    switch ((int)item.SubItems[1].Tag)
                    {
                        case 0:
                            strStuff += " LIKE '%" + item.SubItems[2].Text + "%'"; //contains
                            break;
                        case 1:
                            strStuff += " LIKE '" + item.SubItems[2].Text + "'"; //allows * wildcard
                            break;
                        case 2:
                            _strCriteria += " NOT LIKE '%" + item.SubItems[2].Text + "%'"; //doesn't contain
                            break;

                        default:
                            strStuff += "\"" + item.SubItems[2].Text + "\"";
                            break;
                    }
                    strStuff += " And ";
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T23:37:43.877

虽然这看起来应该可以达到预期目的，但您确实应该转义附加到可能是 SQL 字符串的文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T00:04:51.517

转义文本字符串以避免 SQL 注入，否则你很好。SQL 中的 LIKE 进行字符串模式匹配，并接受各种通配符，如“%”和“_”。

详细信息可以在[这里](http://www.firstsql.com/tutor2.htm)和[这里](http://www.techonthenet.com/sql/like.php)找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T23:42:23.287

它看起来对我来说是正确的，你必须提供更多的上下文来说明它是否真的正确。如前所述，您必须寻找可能的 SQL 注入攻击（是网络应用程序）

要了解 Sql LIKE 关键字的功能，只需直接尝试对数据库进行一些查询。

# wcf - Why is this WCF service not recognizing the UriTemplate parameter?

> ID：544038
> 
> 赞同：7
> 
> 时间：2009-02-12T23:36:00.587
> 
> 标签：wcf, web-services, rest

I've created the following RESTful WCF service, which works just fine when running it in VS.

```
[OperationContract]
[WebGet(ResponseFormat = WebMessageFormat.Json, 
    UriTemplate = "/sales/start={start}&end={end}")]
List<Sales> GetSalesByDate(string start, string end); 
```

However, when deploying this to my test server (running Win2K3 and IIS6) I received the following server error:

*Operation 'GetSalesByDate' in contract 'ISalesService' uses GET, but also has body parameter 'start'. GET operations cannot have a body. Either make the parameter 'start' a UriTemplate parameter, or switch from WebGetAttribute to WebInvokeAttribute.*

Obviously I have already made 'start' a UriParameter. So can anyone tell me why an exception is being thrown?

EDIT: For reference, here is my configuration file:

```
<?xml version="1.0"?>
<configuration>
    <system.serviceModel>
        <services>
            <service name="Services.SalesService">
                <endpoint behaviorConfiguration="webBehavior" 
                          binding="webHttpBinding" 
                          contract="Services.ISalesService"/>
            </service>
        </services>
        <behaviors>
            <endpointBehaviors>
                <behavior name="webBehavior">
                    <webHttp/>
                </behavior>
            </endpointBehaviors>
        </behaviors>
    </system.serviceModel>
</configuration> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-13T04:21:23.850

It turns out `/sales/start={start}&end={end}` is not a valid Uri (duh!). After a little trial and error I finally figured this out. Tweaking the UriTemplate with a '?' solved the problem.

```
[OperationContract]
[WebGet(ResponseFormat = WebMessageFormat.Json, 
    UriTemplate = "/sales/?start={start}&end={end}")]
List<Sales> GetSalesByDate(string start, string end); 
```

Thanks for your help!

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-12-16T00:17:52.213

I know it is really late but why didn't you use the following format.

```
UriTemplate = "/sales/{start}/{end}" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T03:59:05.590

I bet it is that the dev machine has SP1 and the server does not.

[http://blogs.msdn.com/endpoint/archive/2008/08/22/rest-in-wcf-part-ix-controlling-the-uri.aspx](http://blogs.msdn.com/endpoint/archive/2008/08/22/rest-in-wcf-part-ix-controlling-the-uri.aspx)

# cygwin - Cygwin 中的 Make/Execvp 错误：

> ID：544041
> 
> 赞同：0
> 
> 时间：2009-02-12T23:36:24.877
> 
> 标签：cygwin, makefile

在尝试进行增量构建时，make 中会出现以下错误：

> make[2]: execvp: C:/path/to/compiler.exe: 消息太长

我怀疑我的问题是 execvp 的参数长度。知道那个限制是什么吗？如何改变这一点？

一些奇怪的额外信息：当先前的 make 依赖项位于名称较短的文件夹中时，相同的命令会成功。execvp 可用的内存量是否受先前命令的某种影响？

例如，从增量构建文件（其中有数百个）的路径中删除 17 个字符可以节省大约 12k 个字符，并且编译器的 6k char 命令行成功。如果不减少该路径，相同的命令行将失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T10:52:30.423

Windows 中的 CreateProcess() 具有以下限制：

1) pCommandLine [输入，输出，可选]

```
The command line to be executed. The maximum length of this string is 32,768 characters, including the Unicode terminating null character. 
```

2) 如果进程的环境块的总大小超过 32,767 个字符，则此函数的 ANSI 版本 CreateProcessA 将失败。

我遇到了由限制 2) 引起的类似问题，但没有找到好的解决方案。可能使用对 CreateProcess() 的 Unicode 调用重新编译 cygwin 会有所帮助。对我来说，从环境中移除一些东西就足够了。

克日什托夫·诺瓦克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-12T11:19:22.460

我收到此错误是因为我的 %PATH%（取自 $PATH）太长。

# java - Apache Wicket 的优势是什么？

> ID：544049
> 
> 赞同：22
> 
> 时间：2009-02-12T23:38:11.673
> 
> 标签：java, model-view-controller, spring, wicket

我不是 Java 开发人员，所以我可能会弄错一些术语……但是。

我集成的一个应用程序正在从 Spring 迁移到 Wicket。虽然它不应该影响我与它的整合，但我想知道他们为什么要这样做？

据我所知，Spring 是更流行的框架。我对它一无所知，除了它很受欢迎。我确实阅读了 Wicket 页面，Wicket 看起来非常简单明了。

Wicket 有哪些优势？

在我看来，改变你的整个框架将是一些工作，所以我想知道 Wicket 是否提供了 Spring 不提供的东西？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-13T01:50:40.827

我经常在圈子里吹捧的优点是：

1.  您的 html 可以完全符合 xhtml 标准 - 表示和逻辑的分离非常好，因为您的表示/html 层需要了解的关于 wicket 的唯一内容是标准 html 标记中的 wicketid 属性。这对于您团队中几乎没有实际 Java 工作的 html/css/javascript 客户端人员来说非常棒。没有其他基于 java 的 web 框架可以声称这一点，afaik。
2.  没有任何特定于检票口的 xml 配置 - 一切都可以在源代码中完成，并且您的 .war 的标准 web.xml 几乎不需要做任何事情
3.  基于组件的开发很容易理解——尤其是如果你有非网络背景（例如摇摆程序员）。它比 mvc 更鼓励重用，imo。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-26T10:09:41.427

以下是 apache wicket 的一些功能：

**POJO 组件模型**

Wicket 中的页面和组件是支持封装、继承和事件的真实 Java 对象。

**易于开发**

因为 Wicket 是 Java 和 HTML，所以您可以利用您对 Java 的了解或您最喜欢的 HTML 编辑器来编写 Wicket 应用程序。

**关注点分离**

Wicket 不会将标记与 Java 代码混合，也不会向标记文件添加特殊语法。HTML 和 Java 的世界是平行的，并且仅通过 Wicket id 相关联，Wicket id 是 HTML 中的属性和 Java 中的组件属性。由于 Wicket HTML 只是 HTML，而 Wicket Java 只是 Java，因此编码人员和设计人员可以在很大程度上独立工作，而无需依赖任何特殊工具。

**安全的**

Wicket 默认是安全的。URL 不会暴露敏感信息，并且所有组件路径都是会话相关的。必须采取明确的步骤在会话之间共享信息。此外，URL 加密允许高度安全的网站。

**透明、可扩展的集群支持**

所有 Wicket 应用程序都将自动在集群上运行，无需额外工作。一旦了解了瓶颈，Wicket 就可以调整页面状态复制。下一版本的 Wicket 将支持客户端模型以实现零状态可扩展性。

**透明后退按钮支持**

Wicket 支持可配置的页面版本管理。当用户提交表单或从他们使用浏览器中的后退按钮访问的页面点击链接时，Wicket 能够将页面对象恢复到页面最初呈现时的状态。这意味着您可以编写支持后退按钮的 Web 应用程序，而且工作量很少。

**多标签和多窗口支持**

Wicket 提供了一种编写支持多窗口和多选项卡使用的应用程序的简单方法，允许开发人员在用户打开新的浏览器窗口或选项卡时做出正确反应

**可重用组件**

Wicket 中的可重用组件特别容易创建。您不仅可以使用 Java extends 关键字扩展现有组件，还可以创建将一组组件关联为可重用单元的面板组件。

**简单、灵活、可本地化的表单验证**

在 Wicket 中编写和使用验证器很简单。自定义和本地化验证错误消息的显示和内容也很容易。

**类型安全会话**

Wicket 消除了手动管理 HttpSession 属性的需要。页面和组件对象透明地存储在会话中，您的应用程序也可以创建具有类型安全属性的自定义会话子类。会话中存储的所有对象都可以自动参与集群复制。

**工厂可定制**

Wicket 是非常可扩展的。大多数操作都可以通过工厂或工厂方法进行定制。

**可拆卸模型**

Wicket 中的模型对象在集群中的内存和网络使用方面非常轻量级。使用模型时，它可以“附加”，用来自持久存储的信息填充自己。当模型不再使用时，可以重置瞬态信息，减小对象的大小。

**边框组件**

Wicket Border 组件能够以可重用的方式装饰页面。这对于继承常见的导航结构或布局特别有用。

**支持所有基本 HTML 功能**

Wicket 支持图像标签、链接、表单以及您在 Web 应用程序开发中习惯使用的所有其他内容。

**属性的程序化操作**

Wicket 组件可以以编程方式更改任何 HTML 标记属性。

**自动转换**

表单验证后，可以使用 Wicket 转换器更新模型。大多数普通转换都是内置的，很容易编写新的转换器。

**动态图像**

Wicket 使图像的使用、共享和生成变得非常容易。可以通过简单地实现绘画方法来创建动态图像。

**可分页列表视图**

Wicket 中的 ListView 非常强大。您可以在 ListView 行中嵌套任何类型的组件，甚至是其他 ListView。PageableListView 支持大型列表的导航链接。

**树组件**

开箱即用的树组件，用于导航和选择节点。

**本土化**

HTML 页面、图像和资源字符串都可以本地化。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-04T16:54:32.983

Spring 不仅仅是 Spring MVC。您可以（并且可能应该）将 Spring*与*Wicket 一起使用。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-06-24T22:32:31.683

检票口岩石！

Spring（其中的 UI 部分称为 Spring MVC）似乎是一个巨大的，“做所有事情，包括厨房水槽”，当我开始评估 Spring（和 Spring MVC)。在我看来，今天 Spring 似乎并不专注于任何一件事。最初我认为它只是一个依赖注入框架，但它很快发展为试图成为所有人的一切，并且失去了简单性。

我在 Spring 上阅读的书籍中有包含太多 XML 配置的示例。XML 配置文件中的错误比 java 代码中的错误更难调试和修复，您可以使用调试器单步执行。

无论如何用 Java 代码而不是 XML 声明东西有什么问题？从什么时候开始有人下令无论如何都应该在 XML 中声明所有内容？如果您喜欢在复杂的 XML 配置文件的海洋中畅游，那么请选择 Spring。如果您喜欢完成工作并提高工作效率，请选择 Wicket。

Wicket 非常专注于成为最好的基于 Java 的 Web 应用程序开发 UI 框架。它不会试图将您锁定在任何特定的依赖注入框架或任何特定的持久性框架中（与 JDO/JPA、DataNucleus、Hibernate 等一起使用）。

它的重点显然是 UI，但您可以使用任何您喜欢的依赖注入框架（您不必使用 Spring 的 DI，但如果您愿意，可以使用）。我们甚至使用我们自己的 DI ( [http://www.expojo.com](http://www.expojo.com) ) 和 Wicket，一切都很时髦。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-02-12T23:56:13.550

Spring 比 Wicket 更包罗万象。

Wicket 是一个 Java Web UI 框架。Spring 也有一个，以及用于持久性、远程处理、安全性、消息传递等的模块。

Spring 建立在依赖注入和 AOP 之上。检票口都没有。

我没有使用它，但它应该很简单。我不能说春天是更容易还是更难。

除了 Web 应用程序之外，您还可以在很多情况下使用 Spring。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-08-13T17:55:37.140

您可以在 Wicket In Action 的免费第一章中了解使用 Wicket 的优势：http: [//www.manning.com/dashorst/](http://www.manning.com/dashorst/)

简而言之，当您开发的应用程序相对复杂时，Wicket 是一个很棒的框架，您希望它是可维护的，能够扩展团队并利用重用。面向对象编程被证明是一种非常有用的 UI 编程范式，但不幸的是，大多数用于开发 Web 应用程序的 Java 框架，包括 Spring MVC，只支持一种非常程序化的编程模型，它们在其中标记 MVC 术语以使其听起来很酷（但事实上，由于它们支持的粒度是请求/响应往返而不是自包含的小部件，因此 MVC 确实具有误导性）。

Spring 的 DI 部分很棒，您可以轻松地与 Wicket 一起使用。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-07-14T10:55:12.053

我同意到目前为止提供的答案。没有提到的是以下几点，这是 Wicket 专注于 Java 代码的 Web 应用程序开发方法的结果：-

*   Wicket 开发不涉及编写 JSP。
*   无需编写 Javascript 即可开发 AJAX 组件。

我还没有遇到任何其他采用这种以 Java 为中心的方法的框架。我使用过的所有其他工具（Struts、Spring）都涉及 JSP 开发。

对我来说，Wicket 的一大优势是专注于 Java，以及丰富的开发环境工具（如 Eclipse）的可用性。此外，业务逻辑与应用程序的表示方面非常清晰地分离。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-10-12T19:58:57.783

我喜欢 Wicket 的一些优点：

1.  简单 - 学习曲线很小，特别是如果您来自 Swing 学校。
2.  关注点的清晰分离 - 网页设计师不需要对代码了解太多。
3.  易于部署。

    [这是我在 Wicket 中展示 hello world 代码的博客](http://shengchien.blogspot.com/2009/10/wicket-in-iphone-development.html)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-09-14T20:20:06.620

Spring 仅在页面级别为您提供 MVC 设计模式——确实是一个非常粗略的粒度级别。相比之下，Wicket 为您提供了单个组件级别的 MVC 设计模式（就像 Swing 为胖客户端编程提供的那样）。使用 Spring MVC，表单的所有数据对整个前端 servlet 都是全局的，因此信息隐藏、松散耦合或紧密内聚的机会并不多。使用 Wicket，您的显示逻辑可以更加模块化——由 componentA 管理的数据不需要对 componentB 的代码可见。

较小的粒度级别使得跨多个不同网页甚至跨 Web 应用程序重用显示代码变得更加容易。

此外，由于组件配置是在 Java 而不是 XML 中完成的，因此它们可以在运行时动态配置，从而获得更大的功能和灵活性（与大多数其他面向组件的框架相比，例如 ASP.NET Web表单或 Java Server Faces）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-01-23T11:58:40.343

One other advantage of Wicket over other popular java web frameworks is that it allows you to create modular and extensible web applications. This is particularly useful when you are designing a web based product, which you intend to extend by adding extra functionality and pages in the form of plugins at deploy time, and eliminating the impact on the core functionality/source of your product. Here is a very good article on it.

[http://www.infoq.com/articles/modular-wicket](http://www.infoq.com/articles/modular-wicket)

# css - 是否有理由仍然使用“@import”css 规则？

> ID：544050
> 
> 赞同：8
> 
> 时间：2009-02-12T23:38:12.253
> 
> 标签：css, web-standards

我最近在 Coda.com 上遇到了 @import 规则的用法。他们实际上是用来导入网站的主要样式表，特别是格式：

```
<style type="text/css" media="screen">
  @import url(./coda.css);
</style> 
```

这将隐藏 Netscape 3 和 IE 3 和 4 的规则。由于 Web 开发工具的主要受众将使用现代浏览器，那么还有什么其他理由使用它而不是链接？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-12T23:44:32.580

没有任何。使用`<link>`元素还具有摆脱[FOUC](http://bluerobot.com/web/css/fouc.asp/)的优势。

**编辑**：`@import`在另一个样式表（`.css`文件）中使用可以像`#include`在 C 中一样使用，但没有任何理由`@import` *在*`<style>`块中使用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-12T23:47:37.550

对于 Coda 的网站，我想他们这样做更多是出于习惯，而不是出于任何紧迫的技术需求。

`@import`实际 CSS 文件中的语句（不在`<style>`HTML 中的元素中）有很多用途，例如便于换入和换出其他 CSS 文件。Blueprint CSS 框架这样做是为了让您轻松删除框架的某些部分，例如排版内容或网格内容。

当然，在生产环境中，不赞成使用一堆`@import`语句，因为它会增加 Web 浏览器必须下拉的文件数量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-12T23:47:59.077

今天使用此规则的唯一原因是通过将 CSS 拆分为不同的文件（如库）来使您的 CSS 更加模块化。

因此，虽然您的页面可能链接到一个样式表，但该样式表可以 @import 其他样式表以进行重置、排版等。

但是，这确实会减慢页面的加载速度，因为它只是更连续的 http 请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T03:41:52.883

我同意安德鲁的观点。我还使用导入来逻辑拆分我的 css。就我个人而言，我喜欢将它们分成 4 个：重置、结构、排版、一般（bgs/borders 等）

根据执行此操作的人、他们的风格和偏好，css 文件也可以按页面部分拆分，例如 header.css、footer.css 等。

然而，为了避免多个 http 请求，我做的另一件事是有一个构建过程，它合并（按导入顺序）并压缩 css 文件以进行实时部署。

希望这可以帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T03:47:53.447

我自己使用模块化开发方法，通常会得到 10 多个单独的 CSS 文件。如您所知，HTTP 请求的数量非常庞大，因此我喜欢使用[Blender](http://github.com/front-end/front-end-blender/tree/master)。

Blender 是一个 ruby​​gem，它可以将任意数量的 CSS 文件合并并压缩到一个样式表中。它也适用于 JavaScript。

您可以在单独的样式表中定义 @media 以仅将适当的规则提供给正确的设备类型。

# latex - 如何更改 LaTeX 中的 \paragraph 格式

> ID：544051
> 
> 赞同：5
> 
> 时间：2009-02-12T23:38:14.780
> 
> 标签：latex, paragraphs

这源于[如何在 LaTeX 中编号段落？](https://stackoverflow.com/questions/543208/how-can-one-number-paragraphs-in-latex)，我今天早些时候问过：

使用[Brent.Longborough](https://stackoverflow.com/users/9634/brent-longborough)关于如何对文档中的段落进行编号的建议：

```
\setcounter{secnumdepth}{5}
...
\paragraph{If we want to}
\paragraph{do something} 
```

这导致 LaTeX 产生类似的东西：

```
0.0.0.1 If we want to 
0.0.0.2 do something 
```

如何改变*\paragraph{}*的编号方案以产生如下内容：

```
1\. If we want to
2\. do something 
```

或者

```
A. If we want to
B. do something 
```

谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-12T23:51:48.287

要更改引用段落时引用的数字，您需要更改`\theparagraph`. 这是一个例子：

```
\documentclass[12pt]{article}
\setcounter{secnumdepth}{5}
\renewcommand\theparagraph{\roman{paragraph}}
\usepackage{lipsum}
\begin{document}
\paragraph{foo} \lipsum[1]
\paragraph{bar} \lipsum[2]
\end{document} 
```

`\roman`您也可以使用`\Roman`, `\arabic`, `\alph`,代替`\Alph`。虽然如果你有很多段落，你会想要使用 alphalph 包并使用 \alphalph 来获得超过 26 个段落。

请注意，`\paragraph`“段落标题”需要一个参数。如果你不想这样，你可能想定义自己的命令来简化事情：

```
\newcommand\PARA{\paragraph{}} 
```

您可能还想删除段落在“部分内”编号的方式；即，对于每个新部分，它们都从“1”重置。你可以用类似的东西来解决这个问题

```
\usepackage{remreset}
\makeatletter
\@removefromreset{paragraph}{section}
\makeatother 
```

# java - 使用 Java 的通用访问卡 (CAC) 身份验证

> ID：544056
> 
> 赞同：29
> 
> 时间：2009-02-12T23:39:55.993
> 
> 标签：java, smartcard, cac

我基本上正在寻找某个地方开始学习如何使用 java 与政府 CAC 卡进行交互。

**最终，我的目标是找出如何使用 CAC 卡身份验证（通过 PIN 号）来授权访问使用 Tomcat/J2EE 服务器托管的网站。**

但我需要从某个地方开始。所以我想我会先编写一个小型java程序来简单地从插入我键盘上的读卡器的CAC卡中读取CAC卡信息（DELL键盘，数字键盘上方有CAC读卡器）。

通过谷歌搜索，我找到了被**OpenSSO项目取代的****cacard** java 项目（[https://cacard.dev.java.net/](https://cacard.dev.java.net/) ） 。但我似乎找不到如何使用它连接到卡、从卡中读取等的示例代码。

 **有谁知道我在哪里可以找到一些示例代码，以便我可以开始学习如何使用 java 与 CAC 卡进行交互？

谢谢

编辑：

在研究了更多之后，我在想，我可以只`clientAuth="true"`在`server.xml`文件中设置连接器元素吗？

[http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html](http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html)

clientAuth：如果您希望 Tomcat 要求所有 SSL 客户端提供客户端证书才能使用此套接字，请将此值设置为 true。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-13T00:31:44.167

您是在创建 Web 应用程序，还是尝试编写在客户端运行的软件（有点像您自己的 Web 浏览器）？

如果您正在创建一个 Web 应用程序，它几乎只是标准的客户端认证身份验证。证书来自硬件令牌这一事实对服务器而言并没有太大变化。*如果*您只想接受CAC 证书，您可以在服务器验证客户端证书时指定一组可接受的证书策略。（策略验证是 PKIX 验证的标准部分。）如果此应用程序是针对政府客户的，您需要与他们的安全团队密切合作，以确保您的解决方案满足他们的要求，这可能是严格的。如果这是您的情况，请告诉我，我会用我们遇到的一些问题更新我的答案。

如果您正在编写客户端，并且需要访问物理阅读器，则可以使用[Sun PKCS #11 提供程序](http://java.sun.com/j2se/1.5.0/docs/guide/security/p11guide.html)，从 Java 1.5 开始。我已经尝试过这个提供程序，你可以在[另一个答案中阅读更多关于它的信息。](https://stackoverflow.com/questions/752890/how-to-connect-to-https-server-using-common-access-card/753129#753129)

* * *

在服务器上，您应该检查证书是否未被吊销。然而，其中一些 CRL 非常*庞大*——我们有超过 100 Mb 的 CRL 文件，而内置的 Sun 撤销检查器无法很好地扩展到这个大小。

您还需要确保在 Tomcat 的“信任”密钥库中拥有正确的根 CA 证书（政府根 CA 证书更难找到，因为他们希望确保用户正确验证它们）。我们还发现，除非用户手动将中间证书导入浏览器，否则 Firefox 不会发送整个证书链。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-27T18:48:53.287

您需要创建一个名为`card.config`并在其中包含以下行的文件：

```
name = myConfig
library = /path/to/library/that/implements/cac/card/reader 
```

然后试试这个：

```
import java.io.*;
import java.util.*;

import java.security.cert.CertificateException;
import java.security.KeyStoreException;
import java.security.cert.X509Certificate;

import java.security.KeyStore;
import java.security.Provider;
import java.security.SecureRandom;
import java.security.Security;

import javax.net.ssl.KeyManagerFactory;
import javax.net.ssl.SSLContext;
import javax.net.ssl.SSLSocketFactory;
import javax.net.ssl.TrustManagerFactory;

public class Test  
{
   public static void  main(String arg[]) throws Exception
   {
       try
       {   
         //Create our certificates from our CAC Card
         String configName = "card.config";
         Provider p = new sun.security.pkcs11.SunPKCS11(configName);
         Security.addProvider(p);

         //Get the pin from user entered data
         Console c = System.console();
         char[] pin = c.readPassword("Enter your PIN: ");
         KeyStore cac = null;

         cac = KeyStore.getInstance("PKCS11");
         cac.load(null, pin);

         showInfoAboutCAC(cac);

      }
      catch(Exception ex)
      {
         //System.out.println("*" + ex.getMessage());
         ex.printStackTrace();
         System.exit(0);
      }
   }

   public static void showInfoAboutCAC(KeyStore ks) throws KeyStoreException, CertificateException
   {
      Enumeration<String> aliases = ks.aliases();

      while (aliases.hasMoreElements()) 
      {
         String alias = aliases.nextElement();
         X509Certificate[] cchain = (X509Certificate[]) ks.getCertificateChain(alias);

         System.out.println("Certificate Chain for : " + alias);
         for (int i = 0; i < cchain.length; i ++)
         {
            System.out.println(i + " SubjectDN: " + cchain[i].getSubjectDN());
            System.out.println(i + " IssuerDN:  " + cchain[i].getIssuerDN());
         }
      }
   }
} 
```

此时，您有一个密钥库，可用于创建 ssl 套接字以与 https Web 服务器通信。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-08T22:08:19.327

研究使用 SSO 类型应用程序（例如[OpenSSO](https://opensso.dev.java.net/)或[JOSSO](http://www.josso.org) ）使用证书身份验证。代理应该更易于嵌入，并且他们已经实现了大部分细节。如果您需要自己做，他们也有很多与所需步骤相关的文档，例如：[数字证书设置](http://www.josso.org/confluence/display/JOSSO1/Strong+Authentication+%28Digital+Certificates%29+Setup)

# ruby - Ruby 的 ZipInputStream 搞砸了我的行尾是怎么回事？

> ID：544059
> 
> 赞同：2
> 
> 时间：2009-02-12T23:40:20.763
> 
> 标签：ruby, zip, newline, zipinputstream

我会很高兴 ZipInputStream 对存储在文件中的行结尾采取不雅的自由，如果它至少能让它们适合我存储文件的平台。不幸的是，我从 zip 中提取了一个文本文件（.txt、.cpp..etc.），并且 \n (0x0A) 被替换为 \r\n (0x0d0a)，正如您可以想象的那样，这是导致我很麻烦。

是否可以设置一个标志来告诉它完全避免更改行尾或使用我选择的一个？

谢谢。

（我已经检查了 zip 文件、我的创建等。我已经使用其他 zip 工具将其解压缩并验证它是否已正确存档。我已经使用 rdebug 逐步完成了我的项目并看到 ZipInputStream 调用读取() 返回 \r\n 作为行尾。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-12-21T13:14:19.770

如果您的代码中有`open(filename)`or`open(filename,"r")`调用，请尝试将其替换为`open(filename,"rb")`

# php - 在 PHP 中将非 UTF-8 格式的字段作为 UTF-8 获取？

> ID：544071
> 
> 赞同：1
> 
> 时间：2009-02-12T23:43:19.853
> 
> 标签：php, html, utf-8, webforms

我有一个以非 UTF-8 格式提供的表单（实际上是在 Windows-1251 中）。当然，人们会在那里发布他们喜欢的任何角色。浏览器有助于将 unpresentable-in-Windows-1251 字符转换为 html 实体，因此我仍然可以识别它们。例如，如果用户键入 →，我会收到一个`&#8594;`. 这部分很棒，比如，如果我只是回显它，浏览器无论如何都会正确显示 →。

问题是，我实际上在显示之前对文本做了一个 htmlspecialchars () （这是一个将特殊字符转换为 HTML 实体的 PHP 函数，例如 & 变为`&amp;`）。我的用户有时会输入类似`&mdash;`or的内容`&copy;`，我想将它们显示为实际的`&mdash;`or `&copy;`，而不是 - 和 ©。

我无法区分 → 和`&#8594;`，因为我把它们都当作`&#8594;`. 而且，由于我 htmlspecialchars () 文本，*并且*我还`&#8594;`从浏览器中获得了一个 →，我回显了一个在浏览器中`&amp;#8594;`显示`&#8594;`的内容。所以用户的输入被破坏了。

有没有办法说：“好的，我在 Windows-1251 中提供此表单，但是请*您*将输入的 UTF-8 发送给我，让我自己处理”？

哦，我知道将整个软件切换到 UTF-8 是个好主意，但这工作量太大，我很乐意快速解决这个问题。如果这很重要，表单的 enctype 是“multipart/form-data”（包括文件上传器，因此不能使用任何其他 enctype）。我使用 Apache 和 PHP。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T01:05:09.517

> 浏览器有助于将 unpresentable-in-Windows-1251 字符转换为 html 实体

好吧，几乎，除了它根本没有帮助。现在你无法区分真正的“&#411;” 有人键入期望它以带有“&”的文本字符串形式出现 在其中，还有一个“Б”字符。

> 我实际上在显示之前对文本做了一个 htmlspecialchars()

是的。您必须这样做，否则您将遇到安全问题。

> 好的，我在 Windows-1251 中提供此表单，但是请您将输入的 UTF-8 发送给我，让我自己处理

是的，据说你在表单标签中发送“accept-charset="UTF-8"”。但现实情况是，这在 IE 中不起作用。要获取 UTF-8 格式的表单，您必须发送 UTF-8 格式的表单（页面）。

> 我知道最好的办法是将整个软件切换到 UTF-8，

是的。好吧，至少包含表单的页面的编码应该是 UTF-8。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T00:07:18.687

```
<form action="action.php" method="get" accept-charset="UTF-8">
    <!-- some elements -->
</form> 
```

所有浏览器都应该返回`accept-charset`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T23:57:25.000

您检查字符是否在特定范围内。如果它们超出标准 UTF-8 字符的范围，请随心所欲地使用它。我会通过查看每个字符 &、#、8、5、9、4 来做到这一点，并将其解析为您可以应用的东西。

如果找不到某人创建了 Windows-1251 到 UTF-8 转换脚本的地方，您可能不得不自己动手。您可能必须查看每个特定角色，看看需要对它做什么。如果它类似于 © 您将希望以不同于 → 的方式处理它 因为第二个里面有#。

我认为这回答了你的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T00:01:17.610

该[`html_entity_decode`](http://php.net/html_entity_decode)功能可能是您想要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T00:09:01.820

您可以将[`htmlspecialchars`函数](http://docs.php.net/manual/en/function.htmlspecialchars.php)的第四个参数( `double_encode`，自 PHP 5.2.3 起) 设置为*false*以避免再次对字符引用进行编码。

或者您首先解码那些现有的字符引用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-13T01:01:41.567

您可以使用 PHP[多字节函数](http://www.php.net/manual/en/ref.mbstring.php)将字符串转换为 UTF-8 。从那里你可以做你想做的事。尤其是[`mb_convert_encoding()`](http://www.php.net/manual/en/function.mb-convert-encoding.php)将其从 windows-1251 移动到 UTF-8 或任何地方。

不过我不太明白你的问题，因为如果有人输入 & 作为文本字符串，当您执行`htmlspecialchars()`时应将其转换为 &amp; ...当通过 a 运行时，它`html_entity_decode()`会作为用户输入的文本字符串出现。

[*`double_encode`*](http://www.php.net/manual/en/function.htmlspecialchars.php)这当然是如果您在运行字符串时没有使用该选项`htmlspecialchars()`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-13T01:31:20.593

mbstring 支持“字符集”HTML 实体

```
for($i=0;$i<strlen($out);$i++){
  printf('%02X', ord($out[$i]));
}
```

> 61 20 **E2 86 92** 20 62 20 26 20 63

E2 86 92 是 utf8 中 → (RIGHTWARDS ARROW) 的字节序列。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-13T04:11:35.527

您将无法区分将代码点转换为实体的浏览器和您的用户输入实体，因为它们看起来相同。真正的解决方案是放弃 Windows 1251。取而代之的是，以 UTF-8 提供网页和表单，要求 UTF-8 编码，所有这些问题都应该消失。

# delphi - 我应该如何在 Delphi 7 析构函数中释放对象数组？

> ID：544075
> 
> 赞同：9
> 
> 时间：2009-02-12T23:44:34.110
> 
> 标签：delphi, memory-leaks

假设我的 Delphi 类如下所示：

```
interface
type

    TMySubInfo = class
    public
        Name : string;
        Date : TDateTime;
        Age  : Integer;
    end;

    TMyInfo = class
    public
        Name : string;
        SubInfo : array of TMySubInfo;
        destructor Destroy; override;
    end;

implementation

    destructor TMyInfo.Destroy;
    begin
      // hmmm..
    end;

end. 
```

要正确清理，析构函数中应该包含什么？是否足够做`SetLength(SubInfo,0)`，或者我需要循环并释放每个`TMySubInfo`？我需要做什么吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-12T23:50:16.293

您需要循环并释放每个创建的对象。

您必须知道，声明一个 TMySubInfo 数组实际上并没有创建对象。您必须稍后创建它们。

我会使用 TList 来代替更动态的方法。您甚至可以使用一个 TObjectList 来释放列表中的所有项目。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-13T00:07:37.703

您应该像这样释放每个项目

```
destructor TMyInfo.Destroy;
var
  I: Integer;
begin
  for I:= Low(SubInfo) to High(SubInfo) do
   SubInfo[I].Free;
  SetLength(SubInfo, 0); 
  inherited;
end; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-13T00:08:52.583

释放对象的方式与分配对象的方式相同。如果您通过调用类的构造函数来分配元素的值，则释放该元素引用的对象。

```
destructor TMyInfo.Destroy;
var
  info: TMySubInfo;
begin
  for info in SubInfo do
    info.Free;
  inherited;
end; 
```

这使用了 Delphi 2005 中引入的语法。如果您有旧版本，请使用显式循环控制变量：

```
var
  i: Integer;
begin
  for i := 0 to High(SubInfo) do
    SubInfo[i].Free; 
```

你不需要`SetLength`在最后打电话。当对象被销毁时，动态数组字段`SubInfo`会自动释放。它与接口、字符串和 Variant 字段的工作方式相同。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-13T15:03:46.833

同意上述所有建议，但我想添加一个（诚然有点肛门）建议，即您始终优先调用 FreeAndNil() 过程而不是 Free 方法。

迟早你会意外访问一个你已经释放的对象。如果您有 FreeAndNil-ing 一切的习惯，那么您会在包含问题的行上立即获得一个音频/视频。如果您只是释放了该对象，那么一段时间后您可能会遇到一个神秘且明显无关的故障......

这在析构函数的上下文中可能看起来很着迷，就像这里一样。好的，有点，但是要么在任何地方都这样做，要么根本不这样做。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-09-15T13:19:34.743

也是肛交，但喜欢以与创作相反的顺序释放，例如：

```
For I := List.Count-1 downto 0 do
  List[I].Free; 
```

我将创建和销毁视为括号（），尽管它在实际执行中略有不同。布里

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-12T23:50:28.463

如果您通过构造函数调用创建了对象，则需要调用 Free 以释放它们。如果没有，你不会。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-12T23:49:33.723

每一个新的都应该有一个免费的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-15T09:40:08.243

你不能使用[Finalize](http://www.drbob42.com/delphi4/dynarray.htm)吗？

# asp.net - ASP.Net 映射值查找

> ID：544078
> 
> 赞同：0
> 
> 时间：2009-02-12T23:45:00.067
> 
> 标签：asp.net, regex, parsing, web-config, lookup

目前在我的 ASP.Net 应用程序 web.config 中，我有一个应用程序设置，它存储一个以逗号分隔的映射值列表，如下所示。在后面的代码中，我需要根据输入值 1、2、3 等对此数据执行查找。我可以将字符串拆分并循环，直到找到匹配项，或者使用正则表达式从配置字符串中提取值。

目前我正在使用正则表达式来获取映射值。我不反对更改数据在 web.config 中的存储方式。有没有更简单优雅的处理方式？

```
<add key="Mappings" value="1|APP,2|TRG,3|KPK,4|KWT,5|CUT" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T00:24:51.157

只是好奇:) LINQ 怎么样

```
string inputValue = "2";
string fromConfig = "1|APP,2|TRG,3|KPK,4|KWT,5|CUT";            
string result = fromConfig
    .Split(',')
    .Where(s => s.StartsWith(inputValue))
    .Select(s => s.Split('|')[1])
    .FirstOrDefault(); 
```

或者

```
Regex parseRegex = new Regex(@"((?<Key>\d)\|(?<Value>\S{3}),?)");
parseRegex.Matches(fromConfig)
    .Cast<Match>()
    .Where(m => m.Groups["Key"].Value == inputValue)
    .Select(m => m.Groups["Value"].Value)
    .FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T00:51:49.923

如果您需要经常使用此查找并且 web.config 中的字符串不会经常更改，那么将字符串解析为 Dictionary 对象并将其存储在应用程序或缓存中是有意义的。

从字典中查找将是闪电般的速度，尤其是与每次解析字符串相比。

```
private static readonly object _MappingsLock = new object();

public static string GetMapping(int id)
{
    // lock to avoid race conditions
    lock (_MappingsLock)
    {
        // try to get the dictionary from the application object
        Dictionary<int, string> mappingsDictionary =
            (Dictionary<int, string>)Application["MappingsDictionary"];

        if (mappingsDictionary == null)
        {
            // the dictionary wasn't found in the application object
            // so we'll create it from the string in web.config
            mappingsDictionary = new Dictionary<int, string>();

            foreach (string s in mappingsStringFromWebConfig.Split(','))
            {
                string[] a = s.Split('|');
                mappingsDictionary.Add(int.Parse(a[0]), a[1]);
            }

            // store the dictionary in the application object
            // next time around we won't need to recreate it
            Application["MappingsDictionary"] = mappingsDictionary;
        }

        // now do the lookup in the dictionary
        return mappingsDictionary[id];
    }
}

// eg, get the mapping for id 4
string mapping = GetMapping(4);  // returns "KWT" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T00:03:02.207

用逗号分割字符串，然后用 | 分割每个子字符串，将它们存储在字典中并按键查找。

这只是作为 Regex 的替代品。你知道他们对 Regex 的评价。

# c++ - 如何在 C++ 中使用 glutBitmapString() 将文本绘制到屏幕上？

> ID：544079
> 
> 赞同：11
> 
> 时间：2009-02-12T23:45:00.707
> 
> 标签：c++, graphics, glut

我正在尝试在 2d 中使用 GLUT 将文本绘制到屏幕上。

我想使用 glutBitmapString()，有人可以给我看一个简单的例子，说明你必须在 C++ 中设置和正确使用此方法，以便我可以在 (X,Y) 位置绘制任意字符串吗？

```
glutBitmapString(void *font, const unsigned char *string); 
```

我正在使用 linux，并且我知道我需要创建一个 Font 对象，尽管我不确定如何以及我可以将字符串作为第二个参数提供给它。但是，我如何也指定 x/y 位置？

一个简单的例子对我有很大帮助。如果你能告诉我从创建字体到调用最好的方法。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-12T23:52:04.123

您必须[`glRasterPos`](http://linux.die.net/man/3/glrasterpos)在调用之前使用设置光栅位置`glutBitmapString()`。请注意，每次调用都会`glutBitmapString()`推进光栅位置，因此几个连续的调用将一个接一个地打印出字符串。您还可以使用 设置文本颜色[`glColor()`](http://linux.die.net/man/3/glcolor)。[此处](http://www.opengl.org/resources/libraries/glut/spec3/node76.html#SECTION000111000000000000000)列出了可用字体集。

```
// Draw blue text at screen coordinates (100, 120), where (0, 0) is the top-left of the
// screen in an 18-point Helvetica font
glRasterPos2i(100, 120);
glColor4f(0.0f, 0.0f, 1.0f, 1.0f);
glutBitmapString(GLUT_BITMAP_HELVETICA_18, "text to render"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-31T12:07:07.787

添加到亚当的答案，

```
glColor4f(0.0f, 0.0f, 1.0f, 1.0f);  //RGBA values of text color
glRasterPos2i(100, 120);            //Top left corner of text
const unsigned char* t = reinterpret_cast<const unsigned char *>("text to render");
// Since 2nd argument of glutBitmapString must be const unsigned char*
glutBitmapString(GLUT_BITMAP_HELVETICA_18,t); 
```

查看[https://www.opengl.org/resources/libraries/glut/spec3/node76.html](https://www.opengl.org/resources/libraries/glut/spec3/node76.html)了解更多字体选项

# perl - 为什么我不能说 print $somehash{$var}{fh} "foo"？

> ID：544088
> 
> 赞同：8
> 
> 时间：2009-02-12T23:46:57.973
> 
> 标签：perl

我有一行代码：

```
print $somehash{$var}{fh} "foo"; 
```

哈希包含向下几级的文件句柄。错误是：

```
String found where operator expected at test.pl line 10, near "} "foo"" 
```

我可以通过这样做来解决它：

```
my $fh = $somehash{$var}{fh};
print $fh "foo"; 
```

...但是有单行吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-12T23:54:54.490

见[http://perldoc.perl.org/functions/print.html](http://perldoc.perl.org/functions/print.html)

> 请注意，如果您将 FILEHANDLE 存储在数组中，**或者如果您使用任何其他比标量变量更复杂的表达式来检索它**，则必须使用返回文件句柄值的块来代替：...

因此，在您的情况下，您将使用这样的块：

```
print { $somehash{$var}{fh} } "foo"; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-13T05:32:51.743

如果你的文件句柄不是一个简单的标量，你需要将持有文件句柄的引用包裹在大括号中，这样 Perl 就知道如何解析语句：

```
print { $somehash{$var}{fh} } $foo; 
```

*Perl Best Practices*的一部分说总是出于这个原因将文件句柄包装在大括号中，尽管我对此并不了解。

语法很奇怪，因为`print`它是文件句柄对象的间接方法：

```
method_name Object @arguments; 
```

您可能已经在老式[CGI.pm](http://search.cpan.org/dist/CGI)中看到了这一点。以下是两个间接方法调用：

```
use CGI;

my $cgi_object = new CGI 'cat=Buster&bird=nightengale';

my $value = param $cgi_object 'bird';

print "Indirect value is $value\n"; 
```

只要对象是简单的标量，这几乎可以正常工作（请参阅[Schwern 关于歧义的回答）。](https://stackoverflow.com/questions/544088/why-cant-i-say-print-somehashvarfh-foo/548221#548221)但是，如果我将 放`$cgi_object`入哈希中，我会得到与 . 相同的语法错误`print`。我可以将大括号放在散列访问周围以使其正常工作。继续前面的代码：

```
my %hash;

$hash{animals}{cgi} = $cgi_object;

# $value = param $hash{animals}{cgi} 'cat';  # syntax error
$value = param { $hash{animals}{cgi} } 'cat';
print "Braced value is $value\n"; 
```

这有点笨拙，所以只需对所有内容使用箭头符号即可：

```
my $cgi_object = CGI->new( ... );
$cgi_object->param( ... );

$hash{animals}{cgi}->param( ... ); 
```

您可以对文件句柄执行相同的操作，但您必须使用[IO::Handle](http://perldoc.perl.org/IO/Handle.html)模块才能完成所有操作：

```
use IO::Handle;

STDOUT->print( 'Hello World' );

open my( $fh ), ">", $filename or die ...;
$fh->print( ... );

$hash{animals}{fh} = $fh;

$hash{animals}{fh}->print( ... ); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-14T00:27:40.097

上面的答案都是正确的。他们不允许在那里使用完整表达式的原因`print FH LIST`已经很奇怪的语法。把更复杂的东西放在那里会引入大量模棱两可的语法。该块消除了这种歧义。

要了解这种疯狂导致的结果，请考虑间接对象语法的恐怖。

```
foo $bar;  # Is that foo($bar) or $bar->foo()?  Good luck! 
```

# sql - MySQL：查找不参与关系的行

> ID：544094
> 
> 赞同：31
> 
> 时间：2009-02-12T23:48:06.347
> 
> 标签：sql, mysql, join, entity-relationship

我有两个表：“电影”和“用户”。它们之间存在 n:m 关系，描述了用户看过的电影。这是用“看过”的表格来描述的 现在我想为给定的用户找出他没有看过的所有电影。我目前的解决方案是这样的：

```
SELECT *
FROM movies 
WHERE movies.id NOT IN (
     SELECT seen.movie_id 
     FROM seen 
     WHERE seen.user_id=123
) 
```

这工作正常，但似乎不能很好地扩展。有更好的方法吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-02-13T00:05:51.890

这是不使用您显示的子查询方法的典型方法。这可能会满足@Godeke 要求查看基于联接的解决方案。

```
SELECT * 
FROM movies m
 LEFT OUTER JOIN seen s
 ON (m.id = s.movie_id AND s.user_id = 123)
WHERE s.movie_id IS NULL; 
```

但是，在大多数品牌的数据库中，此解决方案的性能可能比子查询解决方案差。最好使用 EXPLAIN 来分析这两个查询，看看哪一个会根据您的架构和数据做得更好。

这是子查询解决方案的另一个变体：

```
SELECT * 
FROM movies m
WHERE NOT EXISTS (SELECT * FROM seen s 
                  WHERE s.movie_id = m.id 
                    AND s.user_id=123); 
```

这是一个相关子查询，必须针对外部查询的每一行进行评估。通常这很昂贵，并且您的原始示例查询更好。另一方面，在 MySQL 中，“ `NOT EXISTS`”往往比“ `column NOT IN (...)`” 好

同样，您必须测试每个解决方案并比较结果以确定。 **在不衡量性能的情况下选择任何解决方案都是浪费时间。**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T23:54:59.530

您的查询不仅有效，而且是解决问题的正确方法。也许您可以找到解决问题的不同方法？例如，即使对于大型表，外部选择的简单限制也应该非常快。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-12T23:55:18.297

看到的是您的连接表，所以是的，这看起来是正确的解决方案。您实际上是从 MOVIES 中的全部内容中“减去”SEEN（对于用户）中的电影 ID 集，从而导致该用户看不到的电影。

这被称为“负连接”，遗憾的是 NOT IN 或 NOT EXISTS 是最好的选择。（我希望看到类似于 INNER/OUTER/LEFT/RIGHT 连接的否定连接语法，但其中的 ON 子句可以是减法语句）。

@Bill 没有子查询的解决方案应该可以工作，尽管正如他指出的那样，测试您的解决方案的两种性能是一个好主意。我怀疑子查询与否，整个 SEEN.ID 索引（当然还有整个 MOVIE.ID 索引）将以两种方式进行评估：这将取决于优化器如何从那里处理它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T00:02:17.920

如果您的 DBMS 支持位图索引，您可以尝试一下。

# asp.net - 在 ASP.NET 应用程序中用于开发和生产的不同配置文件

> ID：544096
> 
> 赞同：3
> 
> 时间：2009-02-12T23:48:26.423
> 
> 标签：asp.net, configuration, web-config

在我正在进行的一个项目中，我们有一个包含三个配置文件的 Web 应用程序；Web.Config Web.Config.TestServer Web.Config.LiveServer

当我们发布到测试服务器时，Web.Config 被重命名为 Web.Config.Development 并且 Web.Config.TestServer 被重命名为 Web.Config，从而使该配置对应用程序处于活动状态。

使三个非常相似的配置文件保持最新是相当繁重的，并且该系统用于作为该项目一部分的许多应用程序；不仅仅是网站。

配置上的差异最常见的是本地目录或路径、URL、IP、端口号和电子邮件地址。

我正在寻找更好的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T23:57:04.593

虽然你的方法看起来很乏味，但我发现它是最好的方法。

我曾经将所有配置保存在一个 web.config 文件中，只是将“生产”部分注释掉。

此后不久，我不得不进行“混合”测试，其中我的查找数据来自生产服务器，但新数据被插入到测试数据库中。那时我不得不开始对配置块的哪些部分进行评论/取消评论，这变成了一场噩梦。

同样，我们让我们的服务器管理员进行从测试到生产的实际迁移，他们中的大多数人在 .NET 中不够流利，不知道如何管理 web.config 文件。对他们来说，简单地查看 .test 或 .prod 文件并向上迁移正确的文件要容易得多。

您可以使用诸如数据库之类的东西来存储您的所有配置，但随后您将遇到另一层抽象，您必须在此基础上对其进行管理。

一旦您掌握了如何设置两个（或三个）配置文件的诀窍或模板，管理它们就会变得容易得多，并且您可以修改您的测试服务器配置以进行一些独特的测试，而无需太多麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-12T23:52:17.053

如果您有一个数据库服务器，您可以创建一个包含配置、属性名称和属性值的表，然后您所要做的就是更改 web.config 中的一个值，即配置名称（开发，测试，产品）。

如果每个配置都有不同的数据库，那么唯一不同的是连接字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-06T05:15:55.290

使用配置转换，这里有一个关于它的博客。

[http://blogs.msdn.com/b/webdevtools/archive/2009/05/04/web-deployment-web-config-transformation.aspx](http://blogs.msdn.com/b/webdevtools/archive/2009/05/04/web-deployment-web-config-transformation.aspx)

基本上，您创建名为 web.{build configuration}.config 的目标。在每个目标文件中编写转换，您可以在其中添加、删除和修改节点和属性。示例可能是

```
web.staging.configss

<?xml version="1.0"?> 
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform"> 
     <connectionStrings> 
        <add name="personalDB" 
          connectionString="Server=StagingBox; Database=personal; User Id=admin; password=StagingPersonalPassword" 
          providerName="System.Data.SqlClient" xdt:Transform="Replace" xdt:Locator="Match(name)" /> 
        <add name="professionalDB" 
         connectionString="Server=StagingBox; Database=professional; User Id=professional; password=StagingProfessionalPassword" 
         providerName="System.Data.SqlClient" xdt:Transform="Replace" xdt:Locator="Match(name)"/> 
       </connectionStrings> 
</configuration> 
```

然后通过调用执行转换`MSBuild {project file} /t:TransformWebConfig /p:Configuration=Staging`

# iphone - 在 OpenGL ES 1.1 中创建闪电

> ID：544097
> 
> 赞同：3
> 
> 时间：2009-02-12T23:48:51.290
> 
> 标签：iphone, animation, opengl-es

我需要使用 OpenGL ES 1.1 (iPhone) 创建好看的闪电，并计划使用着色器。[但是，当我在上一个问题（ OpenGL ES 1.x Shaders](https://stackoverflow.com/questions/543948/opengl-es-1-x-shaders) ）中询问它时，我被告知这可能不是 iPhone 上的选项。

所以现在我回到了第一方，想知道如何制作闪电动画。它不需要看起来超现实。我已经尝试过使用剥离在一起的三角形之类的东西。虽然这种方法确实有效，但它并不像我希望的那样好。

有人对这个主题有任何想法吗？

再次感谢，
〜埃里克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T00:41:44.720

尝试使用具有从黑色到低饱和度蓝色或紫色到白色的渐变纹理的三角形条。将混合设置为添加剂（GL_SRC_ALPHA，GL_ONE）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T00:16:34.500

你也许可以改编[这个项目](http://www.nitrogen.za.org/projectinfo.asp?id=14)的代码。虽然它不是 ObjC/C，但它确实使用了 OpenGL。

[这](http://www.gamedev.net/reference/articles/article1512.asp)是一篇文章，更详细地描述了效果并提供了 VB/DirectX 实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-24T12:49:15.587

通常的方法是使用 Perlin 函数计算闪电的路径，将其渲染到发光缓冲区，使用高斯模糊着色器创建漂亮的模糊，然后将其与场景合并。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T23:54:49.217

也许我错过了一些东西，但是`glLight()`像其他人一样简单地使用和固定功能有什么问题？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T00:03:32.393

必须是非常明亮的光才能使它看起来像闪电，并且您不需要将光照射到或穿过某物吗？

# sql - 从一个查询窗口，一个存储过程可以打开到另一个查询窗口吗？

> ID：544108
> 
> 赞同：4
> 
> 时间：2009-02-12T23:52:09.957
> 
> 标签：sql, sql-server, tsql

查询窗口中是否有可以在另一个查询窗口中打开存储过程的命令？

即修改 dbo.pCreateGarnishmentForEmployee

我正在使用 SQL Server management Studio 2005 和 Red Gate 的 SQL Prompt。

目前我必须执行以下多个步骤：

打开对象资源管理器导航可编程性 | 存储过程右键单击存储过程名称选择修改

查询窗口将打开，并带有 ALTER PROCEDURE。

正如我上面提到的，我想做的是从查询窗口类型中输入一些内容

修改 dbo.pCreateGarnishmentForEmployee

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T00:02:40.103

您正在尝试在这里混合两种技术。

1.  SQL 和 SQL 语法
2.  SQL 管理工具

可能无法使用 TSQL 来操作 Management Studio，而这正是您想要的。我怀疑剪切和粘贴是您唯一的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T00:02:53.270

我认为我知道的唯一方法会产生类似于您所要求的结果的结果是针对您的存储过程名称运行 sp_helptext

```
sp_helptext 'dbo.pCreateGarnishmentForEmployee' 
```

这会将文本作为结果集输出。然后单击列标题并将结果集复制/粘贴到查询窗口中。您还需要更改

```
CREATE PROCEDURE ... 
```

至

```
ALTER PROCEDURE ... 
```

但是，此方法并不总是生成格式良好的存储过程布局，因此请记住这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-11T17:24:36.753

有一种方法可以从命令行（即，从 SSMS 外部）执行此操作。

它要求您保存存储过程文本（如单击“保存”，而不是执行）。这是一个例子：

```
Ssms "C:\...\SQL Server Management Studio Projects\mySolution\myProject\myScript.sql" 
```

有关更多详细信息，请参阅 MSDN 上的文章：http: [//msdn.microsoft.com/en-us/library/ms162825.aspx](http://msdn.microsoft.com/en-us/library/ms162825.aspx)

# url - XAMPP 显示来自非本地域的 .exe 错误

> ID：544110
> 
> 赞同：0
> 
> 时间：2009-02-12T23:53:06.663
> 
> 标签：url, http-status-code-404, localhost, xampp

在 FireFox3 中，当我访问 URL 时，例如：

[http://download.microsoft.com/download/4/A/A/4AA524C6-239D-47FF-860B-5B397199CBF8/windows-kb890830-v2.7.exe](http://download.microsoft.com/download/4/A/A/4AA524C6-239D-47FF-860B-5B397199CBF8/windows-kb890830-v2.7.exe)

在我用于本地开发的 XAMPP 安装中，本地 URL 出现 404 错误。

我认为它与.exe有关，但我不知道为什么。

有什么问题？

找不到对象！

* * *

错误：

* * *

在此服务器上找不到请求的 URL。如果您手动输入了 URL，请检查您的拼写并重试。

如果您认为这是服务器错误，请联系网站管理员。错误 404 download.microsoft.com 02/12/09 15:47:20 Apache/2.2.8 (Win32) DAV/2 mod_ssl/2.2.8 OpenSSL/0.9.8g mod_autoindex_color PHP/5.2.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-21T03:53:53.370

此问题是由 root 工具包引起的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T00:03:54.327

发生错误时是否正在运行 xampp 服务？

# html - 抑制 IE 中的 SWF 点击事件，改为跟随锚标记

> ID：544123
> 
> 赞同：1
> 
> 时间：2009-02-12T23:56:49.197
> 
> 标签：html, events, flash, click

场景：您有一个带有内置点击事件的 SWF 文件，可将您带到某个网页。您想使用该 SWF 文件（源不可用），但让 click 事件将您带到不同的网页。将嵌入的 SWF 包装在一个锚标记中并将 swf 设置为 wmode=transparent 似乎只在 FF 中工作，而不是 IE，并且由于所讨论的网站迎合了非精通技术的人群，IE 兼容性非常重要。

需要更改哪些设置才能以浏览器兼容的方式尊重锚标记？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T12:44:17.603

创建您自己的 Flash 应用程序，该应用程序嵌入主 SWF，并在其顶部放置一个透明精灵以捕捉鼠标点击。您可以在参数中传递目标 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T00:08:07.547

如果你几个月前问过这个问题，我会告诉你把透明的 gif 放在 swf 的前面，但是现在它可能被认为是 clikljacking 和 noscript 并且一些防病毒工具看到它时可能会发疯。（另一方面，可能不会，因为该透明图像将直接在`<a>`标签中，如果 swf “意外”位于其下方，那么...没什么大不了的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T00:35:43.300

尝试对可点击部分使用非常高的 z-index。默认情况下，IE 中的 Flash 在堆叠顺序中将自身置于非常高的位置，导致所有点击默认转到它。从[http://www.webmasterworld.com/css/3639440.htm](http://www.webmasterworld.com/css/3639440.htm)判断，99 应该这样做，但请记住，自那篇文章以来，Flash 使用的实际 z-index 可能已经改变（如果 z-index 有最大值索引，他们现在可能正在使用它，使其不可能 - 我相信这将取决于实施）。

此外，使用其他浏览器和其他操作系统进行测试。行为可能不同。

IE8 有新的 Clickjacking 保护，但我认为它不会影响这种情况。在决定走这条路之前，您可能需要查看[http://blogs.msdn.com/ie/archive/2009/01/27/ie8-security-part-vii-clickjacking-defenses.aspx](http://blogs.msdn.com/ie/archive/2009/01/27/ie8-security-part-vii-clickjacking-defenses.aspx)，以防万一.

# sql - 在所有存储过程中搜索模式然后将其打开以进行更改的方法

> ID：544134
> 
> 赞同：4
> 
> 时间：2009-02-13T00:01:52.443
> 
> 标签：sql, sql-server, tsql

如何在所有存储过程中搜索模式，然后打开要编辑的存储过程？

SQL Server 2005 内部有什么内置的吗？

或者是否有任何第三方插件可以进行此搜索？

我也在使用 Red Gate 的 SQL Prompt，但我没有注意到该选项。

目前我正在使用以下命令进行搜索

```
SELECT ROUTINE_SCHEMA, ROUTINE_NAME, ROUTINE_DEFINITION 
    FROM INFORMATION_SCHEMA.ROUTINES 
    WHERE ROUTINE_DEFINITION LIKE '%tblVacationAllocationItem%' 
    AND ROUTINE_TYPE='PROCEDURE'
    ORDER BY ROUTINE_SCHEMA, ROUTINE_NAME 
```

这工作得很好，但它在其中一列中返回存储过程的内容，这很难阅读。所以我必须使用对象资源管理器来查找并打开存储过程才能看到完整的内容。

已编辑： [SQL Dependency Tracker](http://www.red-gate.com/products/SQL_Dependency_Tracker/index.htm)允许您使用一系列图形布局动态探索所有数据库对象依赖项。这看起来可以在搜索模式时回答一些问题。还有其他类似 SQL Dependency Tracker 的软件吗？

已编辑： [Redgate的](http://www.red-gate.com/)[SQL Search](http://www.red-gate.com/products/sql-development/sql-search/)是用于搜索的工具。它会在您键入时进行搜索（类似于 Bing 或 Google）。它也很快！价格现在仍然是免费的（2011 年 2 月 24 日），但我认为他们会在某个时候开始收费。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-13T00:24:46.227

有一个名为 sp_grep 的开源存储过程允许您根据其 makup 的 DDL/代码查找数据库对象。我一直使用这个程序来寻找满足特定条件的对象。这在数据库重构中非常有用。

要以编程方式打开和修改 SQL 对象，您可以在任何 .Net 应用程序中使用 SQLDMO 对象。[下面](http://www.simple-talk.com/sql/database-administration/automating-common-sql-server-tasks-using-dmo/)是一些使用 SQLDMO 的示例。

示例： exec sp_grep 'colA='

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO

/*********************************************************************
* Stored procedure  sp_grep 
* SQL Server:   Microsoft SQL Server 6.0, 4.21 for Windows NT, 
*               Microsoft SQL Server 4.2 for OS/2.
* Author:       Andrew Zanevsky, AZ Databases, Inc.
* Version/Date: Version 1.1,  October 26, 1995
* Description:  Searches syscomments table in the current database
*               for occurences of a combination of strings. 
*               Correclty handles cases when a substring begins in 
*               one row of syscomments and continues in the next. 
* Parameters: - @parameter describes the search:
*               string1 {operation1 string2} {operation2 string 3} ...
*               where - stringN is a string of characters enclosed in
*                       curly brackets not longer than 80 characters. 
*                       Brackets may be omitted if stringN does not 
*                       contain spaces or characters: +,-,&;
*                     - operationN is one of the characters: +,-,&.
*               Parameter is interpreted as follows:
*               1.Compose the list of all objects where string1 occurs.
*               2.If there is no more operations in the parameter,
*                 then display the list and stop. Otherwise continue.
*               3.If the next operation is + then add to the list all 
*                   objects where the next string occurs;
*                 else if the next operation is - then delete from the 
*                   list all objects where the next string occurs;
*                 else if the next operation is & then delete from the 
*                   list all objects where the next string does not 
*                   occur (leave in the list only those objects where 
*                   the next string occurs);
*               4.Goto step 2.
*               Parameter may be up to 255 characters long, and may not 
*               contain <CarriageReturn> or <LineFeed> characters.
*               Please note that operations are applied in the order
*               they are used in the parameter string (left to right). 
*               There is no other priority of executing them. Every 
*               operation is applied to the list combined as a result 
*               of all previous operations.
*               Number of spaces between words of a string matters in a
*               search (e.g. "select *" is not equal to "select  *").
*               Short or frequently used strings (such as "select") may 
*               produce a long result set.
*
*             - @case: i = insensitive / s = sensitive (default)
*               Insensitive search is performed regardless of this parameter 
*               if SQL Server is set up with case insensitive sort order.
*
* Examples:     sp_grep employee 
*                 list all objects where string 'employee' occurs;
*               sp_grep employee, i
*                 list all objects where string 'employee' occurs in 
*                 any case (upper, lower, or mixed), such as 
*                 'EMPLOYEE', 'Employee', 'employee', etc.;
*               sp_grep 'employee&salary+department-trigger'
*                 list all objects where either both strings 'employee'
*                 and 'salary' occur or string 'department' occurs, and 
*                 string 'trigger' does not occur;
*               sp_grep '{select FirstName + LastName}'
*                 list all objects where string 
*                 "select FirstName + LastName" occurs;
*               sp_grep '{create table}-{drop table}'
*                 list all objects where tables are created and not 
*                 dropped.
*                 
**********************************************************************/

-- sp_grep   v1.0 03/16/1995, v1.1 10/26/1995
-- Author:   Andrew Zanevsky, AZ Databases, Inc. 
-- E-mail:   zanevsky@azdatabases.com
ALTER proc [dbo].[sp_grep] @parameter varchar(255) = null, @case char(1) = 's'
as

declare @str_no          tinyint, 
        @msg_str_no      varchar(3),
        @operation       char(1), 
        @string          varchar(80), 
        @oper_pos        smallint,
        @context         varchar(255),
        @i               tinyint,
        @longest         tinyint,
        @msg             varchar(255)

if @parameter is null /* provide instructions */
begin
    print 'Execute sp_grep "{string1}operation1{string2}operation2{string3}...", [case]'
    print '- stringN is a string of characters up to 80 characters long, '
    print '  enclosed in curly brackets. Brackets may be omitted if stringN '
    print '  does not contain leading and trailing spaces or characters: +,-,&.'
    print '- operationN is one of the characters: +,-,&. Interpreted as or,minus,and.'
    print '  Operations are executed from left to right with no priorities.'
    print '- case: specify "i" for case insensitive comparison.'
    print 'E.g. sp_grep "alpha+{beta gamma}-{delta}&{+++}"'
    print '     will search for all objects that have an occurence of string "alpha"'
    print '     or string "beta gamma", do not have string "delta", '
    print '     and have string "+++".'
    return
end

/* Check for <CarriageReturn> or <LineFeed> characters */
if charindex( char(10), @parameter ) > 0 or charindex( char(13), @parameter ) > 0
begin
    print 'Parameter string may not contain <CarriageReturn> or <LineFeed> characters.'
    return
end

if lower( @case ) = 'i'
        select  @parameter = lower( ltrim( rtrim( @parameter ) ) )
else
        select  @parameter = ltrim( rtrim( @parameter ) )

create table #search ( str_no tinyint, operation char(1), string varchar(80), last_obj int )
create table #found_objects ( id int, str_no tinyint )
create table #result ( id int )

/* Parse the parameter string */
select @str_no = 0
while datalength( @parameter ) > 0
begin
  /* Get operation */
  select @str_no = @str_no + 1, @msg_str_no = rtrim( convert( char(3), @str_no + 1 ) )
  if @str_no = 1
    select  @operation = '+'
  else 
  begin
    if substring( @parameter, 1, 1 ) in ( '+', '-', '&' )
        select  @operation = substring( @parameter, 1, 1 ),
                @parameter = ltrim( right( @parameter, datalength( @parameter ) - 1 ) )
    else
    begin
        select @context = rtrim( substring( 
                        @parameter + space( 255 - datalength( @parameter) ), 1, 20 ) )
        select @msg = 'Incorrect or missing operation sign before "' + @context + '".'
        print  @msg 
        select @msg = 'Search string ' + @msg_str_no + '.'
        print  @msg 
        return
    end
  end

  /* Get string */
  if datalength( @parameter ) = 0
  begin
      print 'Missing search string at the end of the parameter.'
      select @msg = 'Search string ' + @msg_str_no + '.'
      print  @msg 
      return
  end
  if substring( @parameter, 1, 1 ) = '{'
  begin
      if charindex( '}', @parameter ) = 0
      begin
          select @context = rtrim( substring( 
                      @parameter + space( 255 - datalength( @parameter) ), 1, 200 ) )
          select @msg = 'Bracket not closed after "' + @context + '".'
          print  @msg 
          select @msg = 'Search string ' + @msg_str_no + '.'
          print  @msg 
          return
      end
      if charindex( '}', @parameter ) > 82
      begin
          select @context = rtrim( substring( 
                      @parameter + space( 255 - datalength( @parameter) ), 2, 20 ) )
          select @msg = 'Search string ' + @msg_str_no + ' is longer than 80 characters.'
          print  @msg 
          select @msg = 'String begins with "' + @context + '".'
          print  @msg 
          return
      end        
      select  @string    = substring( @parameter, 2, charindex( '}', @parameter ) - 2 ),
              @parameter = ltrim( right( @parameter, 
                              datalength( @parameter ) - charindex( '}', @parameter ) ) )
  end
  else
  begin
      /* Find the first operation sign */
      select @oper_pos = datalength( @parameter ) + 1
      if charindex( '+', @parameter ) between 1 and @oper_pos
          select @oper_pos = charindex( '+', @parameter )
      if charindex( '-', @parameter ) between 1 and @oper_pos
          select @oper_pos = charindex( '-', @parameter )
      if charindex( '&', @parameter ) between 1 and @oper_pos
          select @oper_pos = charindex( '&', @parameter )

      if @oper_pos = 1
      begin
          select @context = rtrim( substring( 
                      @parameter + space( 255 - datalength( @parameter) ), 1, 20 ) )
          select @msg = 'Search string ' + @msg_str_no + 
                        ' is missing, before "' + @context + '".'
          print  @msg 
          return
      end        
      if @oper_pos > 81
      begin
          select @context = rtrim( substring( 
                      @parameter + space( 255 - datalength( @parameter) ), 1, 20 ) )
          select @msg = 'Search string ' + @msg_str_no + ' is longer than 80 characters.'
          print  @msg 
          select @msg = 'String begins with "' + @context + '".'
          print  @msg 
          return
      end        

      select  @string    = substring( @parameter, 1, @oper_pos - 1 ),
              @parameter = ltrim( right( @parameter, 
                              datalength( @parameter ) - @oper_pos + 1 ) )
  end
  insert #search values ( @str_no, @operation, @string, 0 )

end
select @longest = max( datalength( string ) ) - 1
from   #search
/* ------------------------------------------------------------------ */
/* Search for strings */
if @case = 'i'
begin
    insert #found_objects
    select a.id, c.str_no
    from   syscomments a, #search c
    where  charindex( c.string, lower( a.text ) ) > 0

    insert #found_objects
    select a.id, c.str_no
    from   syscomments a, syscomments b, #search c
    where  a.id        = b.id
    and    a.number    = b.number
    and    a.colid + 1 = b.colid
    and    charindex( c.string, 
                lower( right( a.text, @longest ) + 
/*                     space( 255 - datalength( a.text ) ) +*/
                       substring( b.text, 1, @longest ) ) ) > 0
end
else
begin
    insert #found_objects
    select a.id, c.str_no
    from   syscomments a, #search c
    where  charindex( c.string, a.text ) > 0

    insert #found_objects
    select a.id, c.str_no
    from   syscomments a, syscomments b, #search c
    where  a.id        = b.id
    and    a.number    = b.number
    and    a.colid + 1 = b.colid
    and    charindex( c.string, 
                right( a.text, @longest ) + 
/*              space( 255 - datalength( a.text ) ) +*/
                substring( b.text, 1, @longest ) ) > 0
end
/* ------------------------------------------------------------------ */
select distinct str_no, id into #dist_objects from #found_objects
create unique clustered index obj on #dist_objects  ( str_no, id )

/* Apply one operation at a time */
select @i = 0
while @i < @str_no
begin
    select @i = @i + 1
    select @operation = operation from #search where str_no = @i

    if @operation = '+'
        insert #result
        select id
        from   #dist_objects 
        where  str_no = @i
    else if @operation = '-'
        delete #result
        from   #result a, #dist_objects b
        where  b.str_no = @i
        and    a.id = b.id
    else if @operation = '&'
        delete #result
        where  not exists 
                ( select 1
                  from   #dist_objects b
                  where  b.str_no = @i
                  and    b.id = #result.id )
end

/* Select results */
select distinct id into #dist_result from #result

/* The following select has been borrowed from the sp_help 
** system stored procedure, and modified. */
select  Name        = o.name,
        /* Remove 'convert(char(15)' in the following line 
        ** if user names on your server are longer. */
        Owner       = convert( char(15), user_name(uid) ),
        Object_type = substring(v.name + x.name, 1, 16)
from    #dist_result           d,
        sysobjects             o, 
        master.dbo.spt_values  v,
        master.dbo.spt_values  x
where   d.id = o.id
/* SQL Server version 6.x uses 15, prior versions use 7 in expression below */
and     o.sysstat & ( 7 + 8 * sign( charindex( '6.', @@version ) ) ) = v.number
and     v.type = "O"
and     x.type = "R"
and     o.userstat & -32768 = x.number
order by Object_type desc, Name asc 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-14T08:58:40.150

要查询对象的定义，可以使用 syscomments。例如：

```
select * from syscomments where text like '%tblVacationAllocationItem%' 
```

虽然这适用于大多数情况，但如果定义超过 4000 个字符，则单个对象将存在多个 syscomment 行。尽管不太可能，但您的搜索短语可能跨越多个系统注释行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-22T19:30:40.973

我在下面的文章中发布了适用于 SQL 2000 及更高版本的存储过程的代码，它可以进行全面搜索（跨过程、函数、视图、默认值、作业等），并且可以选择忽略注释并可选择忽略字符串文字. 您可以在 SQLServerCentral.com 上找到它：

**[http://www.sqlservercentral.com/articles/Stored+Procedure/62975/](http://www.sqlservercentral.com/articles/Stored+Procedure/62975/)**

它不会自动打开任何内容进行编辑，但会给出与文本匹配的行号，并考虑到 Cadaeic 提到的 4000 个字符的块。我计划很快更新这篇文章，以包含所有数据库的循环，甚至包括我的一些[SQL#](http://www.SQLsharp.com/ "SQL#") RegEx 函数（用于对象名称匹配以及搜索字符串）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T10:38:21.877

不是您问题的答案，但我们将所有 SProcs 保存为单独的文件 - 使用程序员的编辑器更容易全局进行更改，并且它们很容易进入版本管理存储库（在我们的例子中是 SVN）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T10:29:58.433

```
begin
--select column_name from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME='Products' 
--Declare the Table variable 
DECLARE @GeneratedStoredProcedures TABLE
(
        Number INT IDENTITY(1,1), --Auto incrementing Identity column
        name VARCHAR(300) --The string value
)

--Decalre a variable to remember the position of the current delimiter
DECLARE @CurrentDelimiterPositionVar INT 
declare @sqlCode varchar(max)
--Decalre a variable to remember the number of rows in the table
DECLARE @Count INT

--Populate the TABLE variable using some logic
INSERT INTO @GeneratedStoredProcedures SELECT name FROM sys.procedures where name like 'procGen_%'

--Initialize the looper variable
SET @CurrentDelimiterPositionVar = 1

--Determine the number of rows in the Table
SELECT @Count=max(Number) from @GeneratedStoredProcedures

--A variable to hold the currently selected value from the table
DECLARE @CurrentValue varchar(300);

--Loop through until all row processing is done
WHILE @CurrentDelimiterPositionVar <= @Count
BEGIN
    --Load current value from the Table
    SELECT @CurrentValue = name FROM @GeneratedStoredProcedures WHERE Number = @CurrentDelimiterPositionVar 
    --Process the current value
    --print @CurrentValue
    set @sqlCode = 'drop procedure ' + @CurrentValue
    print @sqlCode
    --exec (@sqlCode)

    --Increment loop counter
    SET @CurrentDelimiterPositionVar = @CurrentDelimiterPositionVar + 1;
END

end 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-13T00:20:19.687

不幸的是，SQL Server 2005 中除了查询之外没有其他功能，可以根据存储过程的内容查找存储过程。您唯一能做的就是在对象资源管理器中按名称过滤。

我使用 Visual Studio 数据库版来完成这项任务。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-06T09:20:46.813

迟到但希望有用。

以下是我成功用于搜索数据库对象和数据的另外两个工具：

*   [ApexSQL 搜索](http://www.apexsql.com/sql_tools_search.aspx)——所有版本的 SSMS 都免费。具有一些附加功能，例如检查依赖项等。

*   [SSMS 工具包](http://www.ssmstoolspack.com/)– 除 SQL 2012 之外的所有版本均免费。除了搜索功能外，还有更多有用的功能。

基本上，任何第三方工具都不会出错，因为所有这些工具都是免费的，与执行某些存储过程相比，它们将为您节省大量时间。

# c# - 如何将字符转换为等效的 System.Windows.Input.Key 枚举值？

> ID：544141
> 
> 赞同：16
> 
> 时间：2009-02-13T00:02:40.430
> 
> 标签：c#, .net, enums, input, key

我想写一个这样的函数，

```
 public System.Windows.Input.Key ResolveKey(char charToResolve)
        {
            // Code goes here, that resolves the charToResolve
            // in to the Key enumerated value
            // (For example with '.' as the character for Key.OemPeriod)

        } 
```

我知道我可以写一个巨大的 Switch-case 来匹配角色，但是还有其他方法吗？与此有关的是 Key 枚举的字符串可能与字符不匹配，因此 Enum.IsDefined 将不起作用

有任何想法吗？

更新：这是在 Windows 环境中

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-13T00:42:08.573

```
[DllImport("user32.dll")]
static extern short VkKeyScan(char ch);

static public Key ResolveKey(char charToResolve)
{
    return KeyInterop.KeyFromVirtualKey(VkKeyScan(charToResolve));
}
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-13T00:35:08.230

尝试使用 System.Windows.Input.KeyConverter 类的 ConvertFrom 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-23T12:41:10.690

只需这样转换：

```
Dim KeyConverter As New Forms.KeysConverter    
Dim S As String = KeyConverter.ConvertToString(e.Key)
Dim O As System.Windows.Forms.Keys = KeyConverter.ConvertFrom(S)
Dim ChValue As Integer = CType(O, Integer) 
```

在我的情况下，我在键盘上按“ENTER”，`O`正在进入`ENTER {13}`并且 ChValue 正在进入字符代码`13` 对于`TAB`键，例如，我将以`9`这种方式接收字符代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-29T21:43:56.150

最近我找到了[Jon Hanna 的类似问题的一个很好的答案，](https://stackoverflow.com/a/20571193/2721611)它也可以处理控制键状态：

> 使用示例程序可能比其他任何内容都更容易解释这一点：

```
namespace KeyFinder
{
  class Program
  {
    [DllImport("user32.dll", CharSet = CharSet.Unicode)]
    static extern short VkKeyScanEx(char ch, IntPtr dwhkl);
    [DllImport("user32.dll")]
    static extern bool UnloadKeyboardLayout(IntPtr hkl);
    [DllImport("user32.dll")]
    static extern IntPtr LoadKeyboardLayout(string pwszKLID, uint Flags);
    public class KeyboardPointer : IDisposable
    {
      private readonly IntPtr pointer;
      public KeyboardPointer(int klid)
      {
        pointer = LoadKeyboardLayout(klid.ToString("X8"), 1);
      }
      public KeyboardPointer(CultureInfo culture)
        :this(culture.KeyboardLayoutId){}
      public void Dispose()
      {
        UnloadKeyboardLayout(pointer);
        GC.SuppressFinalize(this);
      }
      ~KeyboardPointer()
      {
        UnloadKeyboardLayout(pointer);
      }
      // Converting to System.Windows.Forms.Key here, but
      // some other enumerations for similar tasks have the same
      // one-to-one mapping to the underlying Windows API values
      public bool GetKey(char character, out Keys key)
      {
        short keyNumber = VkKeyScanEx(character, pointer);
        if(keyNumber == -1)
        {
          key = System.Windows.Forms.Keys.None;
          return false;
        }
        key = (System.Windows.Forms.Keys)(((keyNumber & 0xFF00) << 8) | (keyNumber & 0xFF));
        return true;
      }
    }
    private static string DescribeKey(Keys key)
    {
      StringBuilder desc = new StringBuilder();
      if((key & Keys.Shift) != Keys.None)
        desc.Append("Shift: ");
      if((key & Keys.Control) != Keys.None)
        desc.Append("Control: ");
      if((key & Keys.Alt) != Keys.None)
        desc.Append("Alt: ");
      return desc.Append(key & Keys.KeyCode).ToString();
    }
    public static void Main(string[] args)
    {
      string testChars = "Aéש";
      Keys key;
      foreach(var culture in (new string[]{"he-IL", "en-US", "en-IE"}).Select(code => CultureInfo.GetCultureInfo(code)))
      {
        Console.WriteLine(culture.Name);
        using(var keyboard = new KeyboardPointer(culture))
          foreach(char test in testChars)
          {
            Console.Write(test);
            Console.Write('\t');
            if(keyboard.GetKey(test, out key))
              Console.WriteLine(DescribeKey(key));
            else
              Console.WriteLine("No Key");
          }
      }
      Console.Read();//Stop window closing
    }
  }
} 
```

> 输出：

```
he-IL
A  Shift: A
é  No Key
ש  A
en-US
A  Shift: A
é  No Key
ש  No Key
en-IE
A  Shift: A
é  Control: Alt: E
ש  No Key 
```

> （尽管您自己的控制台可能会根据设置和字体弄乱 ש 和/或 é）。

[从参考答案](https://stackoverflow.com/a/20571193/2721611)中阅读完整描述

# c# - 将我的 360 连接到应用程序

> ID：544152
> 
> 赞同：2
> 
> 时间：2009-02-13T00:04:55.107
> 
> 标签：c#, xbox360

有没有办法（使用.net）将我写的应用程序连接到360？我想做的是编写一个自定义媒体共享应用程序，并将内容流式传输到 xbox。

我看到有一个名为[Connect360](http://www.nullriver.com/products/connect360)的 mac 应用程序可以做到这一点，所以一定有办法，对吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T00:33:18.517

使用[Platinum UPnP 库的](http://www.plutinosoft.com/blog/projects/platinum)[XBMC曾](http://xbmc.org)[一度](http://www.plutinosoft.com/blog/category/blah-blah/213)支持 Xbox 360 。不确定它是否仍然存在。但是，两者都是开源的并且受修订控制，因此源代码应该让您很好地了解如何在您的应用程序中实现 UPnP 支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T00:21:47.873

编写[DLNA 服务器](http://www.allegrosoft.com/downloads/UPnP_DLNA_White_Paper.pdf)。有一个用于 linux 的媒体共享服务器，您可以查看有关协议如何工作的想法，但我不记得它叫什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T00:25:07.320

Connect360 模拟 Windows 媒体服务器。360 所做的只是像平常一样（或者它认为的那样）连接到 Windows Media Server。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T00:09:07.607

我认为在 XNA 中有一个可用于套接字的对象。您可能需要使用套接字对象连接回您的 PC。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T00:20:44.537

假设您想使用 Xbox 360 内置的媒体播放器，我认为您需要研究媒体流标准以及 360 识别的内容（我自己不确定）。

您可能还对处理各种流媒体功能的[TVersity感兴趣。](http://tversity.com/)

# java - 如何在xsl中找出具有空字符串值的元素节点

> ID：544153
> 
> 赞同：2
> 
> 时间：2009-02-13T00:05:04.870
> 
> 标签：java, xml, xslt, xpath, xsd

我正在将 xml 文件从旧版本转换为新版本。这是我正在使用的基本模板：

```
<xsl:template match="*">
    <xsl:element name="{name(.)}" namespace="{namespace-uri(.)}">
      <xsl:copy-of select="@*"></xsl:copy-of>
      <xsl:apply-templates></xsl:apply-templates>
    </xsl:element>
</xsl:template> 
```

但是，新版本的 xml 模式要求所有具有文本值的元素都不应为空字符串。如此旧的xml文档，例如：

```
<dataset>
 <title> </title>
</dataset> 
```

在新版本中无效。我试图修改文本节点的默认模板。新的文本模板将检查文本节点，如果文本代码为空字符串，则终止转换，否则将值复制到输出 xml。这是模板：

```
<xsl:template match="text()">
    <xsl:variable name="text-value" select="."/>
      <xsl:if test="normalize-space($text-value) = ''">
          <xsl:message terminate="yes">
                <xsl:call-template name="output_message3_fail">
                  <xsl:with-param name="parent_node" select="name(parent::node())"/>
                </xsl:call-template>
          </xsl:message>
      </xsl:if>
      <xsl:value-of select="$text-value"/>
</xsl:template> 
```

但是，我发现输入是否如下所示：

```
<dataset>
 <title>My tile</title>
</dataset 
```

将调用新的文本模板。如果输入看起来像：

```
<dataset>
 <title> </title>
</dataset> 
```

永远不会调用新的文本模板，输出看起来像

```
<dataset>
     <title/>
</dataset> 
```

所以我的方法 - 修改文本模板，不起作用。您对如何执行此操作有任何建议 - 如果找到带有空字符串的元素，则终止转换。

非常感谢！

顺便说一句，我正在使用 java xalan xslt 处理器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T03:47:38.080

> 但是，我发现输入是否如下所示：
> 
> ```
> <dataset>
>   <title>My tile</title>
> </dataset> 
> ```
> 
> 将调用新的文本模板

**是的，这正是所提供的代码应该做的**——我稍后会解释这一点。

> 如果输入看起来像：
> 
> ```
> <dataset>
>   <title> </title>
> </dataset> 
> ```
> 
> 永远不会调用新的文本模板，输出看起来像
> 
> ```
> <dataset>
>   <title/>
> </dataset> 
> ```

**我无法使用 Xalan（J 或 c）和**我拥有的许多其他 XSLT 处理器（Saxon 6.5.3、.NET XslCompiledTransform 和 XslTransform、Msxml3、4、6、JD 等）重现这一点。**它们都显示一条错误消息**（内部`<xsl:message terminate="yes">`）

**产生上述输出的唯一 XSLT 处理器是 AltovaXML (XmlSPY)。**

如果您正在使用 XmlSPY，您可能会考虑尝试使用另一个 XSLT 处理器或联系 Altova 寻求帮助。

现在，回到第一个行为。

**说明**：

提供的源 XML 文件：

```
<dataset>
  <title>My tile</title>
</dataset> 
```

**有三个文本节点**：

1.  第一个文本节点是介于`<dataset>`和之间的节点`<title>`，它只包含空格。

2.  第二个文本节点是唯一的子节点`<title>`，其值为字符串“My tile”。

3.  第三个也是最后一个文本节点在空格之间`</title>`并且`</dataset>`仅由空格组成。

When the template matching `text()`is selected for processing the first of the above three text nodes, the test is positive and `<xsl:message terminate="yes">`is executed -- and this is exactly the reported behavior.

**解决方案**：

存在一个简单的解决方案。**只需更改模板匹配`text()`以仅匹配作为其父级唯一文本节点的文本节点。现在，对于最初提供的两种 XML 文档，XSLT 转换的行为都符合预期**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output omit-xml-declaration="yes" indent="yes"/>

  <xsl:template match="*">
    <xsl:element name="{name(.)}" namespace="{namespace-uri(.)}">
      <xsl:copy-of select="@*"/>
      <xsl:apply-templates/>
    </xsl:element>
  </xsl:template>

  <xsl:template match=
    "*[not(node()[2])]/text()
              [normalize-space()='']">
    <xsl:message terminate="yes">
      <xsl:call-template name="output_message3_fail">
        <xsl:with-param name="parent_node" select="name(..)"/>
      </xsl:call-template>
    </xsl:message>
  </xsl:template>

  <xsl:template name="output_message3_fail">
    <xsl:param name="parent_node"/>

    <xsl:message>        ERROR:        
      &lt;<xsl:copy-of select="$parent_node"/>> is empty
    </xsl:message>
  </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于**提供的 XML 文档时：

```
<dataset>
  <title>My tile</title>
</dataset> 
```

**产生了想要的结果**：

```
<dataset>
   <title>My tile</title>
</dataset> 
```

**当它应用于第二个 XML 文档时**：

```
<dataset>
    <title> </title>
</dataset> 
```

产生正确的结果：

```
ERROR:        
        <title> is empty 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T20:02:38.300

I'm not clear on what it is you really want. You say you don't want to emit elements that contain the empty string, and then give as an example this:

```
<dataset>
   <title> </title>
</dataset> 
```

in which the `title` element *doesn't* contain the empty string. It contains whitespace. So I'm going to assume that by "empty string" you mean "whitespace only."

Using `xsl:strip-space` will eliminate whitespace-only text nodes from the source tree before processing it. If you genuinely want to abort the transform with an exception if you encounter an element containing whitespace, you can't use `xsl:strip-space`, as it will remove all of the exception-triggering conditions before the transform runs.

I think what you want to do instead is write a template that looks like this:

```
<xsl:template match="*[not(*) and text() and not(normalize-space(text()) != '')]">
   ... 
```

This template will match any element for which the following is true:

*   it doesn't have child elements
*   it does contain at least one text node
*   all of the text nodes it contains are whitespace-only

So in your example, it won't match the `dataset` element (because it has a child element), but it will match the `title` element. It wouldn't match `<title/>` or `<title></title>`, though, because neither of those elements contains text nodes.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T10:44:33.900

也许测试应该是这样的

```
length(text())!=0 && length(strip-whitespace(text())) == 0 
```

xslt 不支持正则表达式吗？如果是这样，那将是要走的路。

但他是否希望*每个*元素都*必须*包含一些非空格文本？或者是否有一些元素必须至少包含某些东西和其他元素

```
<foo bar="BAR"/> 
```

好吗？我敢打赌它是什么。我认为他很可能不得不为那些必须为非空的元素逐个编写规则。

这引出了我的最后一条评论：检查XML 文档*有效性*的正确技术是 XML 模式。

# asp.net-mvc - 如何在 ASP.NET MVC 验证中要求非空 varchar 列不为空？

> ID：544159
> 
> 赞同：1
> 
> 时间：2009-02-13T00:06:36.600
> 
> 标签：asp.net-mvc, database, validation, model

因此，当非空整数字段未设置为值时，我使用 ASP.NET MVC RC1 并使用 DefaultModelBinder 的验证来显示验证错误。这是 MVC 默认完成的。但是，对于 string(varchar) 字段，情况并非如此，因为从视图中向绑定器传递了一个空字符串，这对于非空 varchar 列是完全有效的。

但是在实践中，当我将列标记为非空时，我几乎总是意味着我希望它不为空。所以我想出了这种将验证检查添加到默认活页夹的方法：

```
public class DefaultEntityBinder : DefaultModelBinder
{
    protected override bool OnPropertyValidating(ControllerContext controllerContext, ModelBindingContext bindingContext, System.ComponentModel.PropertyDescriptor propertyDescriptor, object value)
    {
        bool valid = base.OnPropertyValidating(controllerContext, bindingContext, propertyDescriptor, value);

        ColumnAttribute column = propertyDescriptor.Attributes.OfType<ColumnAttribute>().FirstOrDefault();
        if (column != null &&
            propertyDescriptor.PropertyType == typeof(string) &&
            !column.CanBeNull &&
            value.IsNullOrBlankString())
        {
            valid = false;
            bindingContext.ModelState[propertyDescriptor.Name].Errors.Add("A value is required");
        }
        return valid;
    }
} 
```

我想知道这是否是实现将必需的字符串字段验证添加到 MVC 中的默认验证的目标的最有效方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T14:09:59.910

我查看了默认模型绑定（特别是 TypeHelpers.TypeAllowsNullValue），但我没有看到更好的方法。您可以在包含字符串的类型上实现 IDataErrorInfo，但您必须在您支持的每种类型上执行此操作。所以你在做什么是好的。如果您对第三方代码持开放态度，[xVal](http://www.codeplex.com/xval)验证框架值得考虑。然后，您可以使用 System.ComponentModel 中的属性之类的东西来装饰不可为空的字符串。

# c# - 寻找允许分组的 DataGridView

> ID：544162
> 
> 赞同：0
> 
> 时间：2009-02-13T00:07:30.527
> 
> 标签：c#, vb.net, controls

基本上，我正在寻找一个允许在 DataGridView 控件中进行分组的控件，该控件也可以进行编辑（即像 DataGridView 和 TreeView 这样的单个控件）。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-07T00:54:45.540

Herre Kuijpers 在 CodeProject 中制作了[OutlookGrid](http://www.codeproject.com/KB/grid/OutlookGrid.aspx)，它派生自 DataGridView，并允许对行进行分组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T00:12:45.180

DevExpress 有一个很棒的[控件](http://www.devexpress.com/Products/NET/Controls/ASP/Tree_List/)，它是一个带分组的树/网格视图。

演示[在这里](http://demos.devexpress.com/ASPxTreeListDemos/)。

一些 ASP.Net 控件的索引可以在[这里](http://www.asp.net/Community/Control-gallery/)找到。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T02:31:23.053

[Infragistics](http://www.infragistics.com/dotnet/netadvantage.aspx#Overview) UltraWebGrid (ASP.NET) 和 UltraWinGrid (Windows Forms) 支持分组并且可以设置为可编辑的网格。这些控件是其 NetAdvantage Suite 的一部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-30T15:51:06.987

我们的轻量级和廉价的[iGrid.NET](http://10tec.com/winforms-grid/row-grouping.aspx)支持具有间隔分组等高级功能的内置分组，也可以用作树形网格。

# java - Glassfish 登录 JSF 页面

> ID：544172
> 
> 赞同：1
> 
> 时间：2009-02-13T00:10:47.010
> 
> 标签：java, ajax, logging, glassfish, richfaces

我在 Glassfish 服务器上有带有 Richfaces 应用程序的 JSF。是否可以在页面上创建一个 ajax 窗口并显示位于 [GlassfishFolder]/domains/domain1/logs/server.log 中的 Glassfish 日志文件中的信息？而且我还想清理该日志以使其看起来像在 NetBeans 中。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T15:52:56.157

是的，

创建命令链接

```
<a4j:commandLink action="#{Bean.method}" reRender="output" /> 
```

创建输出以查看 server.log 内容

```
<h:outputText id="output" value="#{Bean.logcontent}" /> 
```

Bean.method 提取 server.log 的内容（[参见 java 文件 io](http://java.sun.com/docs/books/tutorial/essential/io/file.html)）并将其存储在 logcontent 变量中。重新渲染输出时，它将显示 server.log 文件。

您可以在 Bean 中操作日志内容，以使输出看起来像您希望的那样。

# python - 使用 ctypes 从共享库映射全局变量

> ID：544173
> 
> 赞同：14
> 
> 时间：2009-02-13T00:11:38.677
> 
> 标签：python, ctypes

我想使用 ctypes`pbs_errno`在库中映射一个声明为全局的 int 值。`libtorque.so`

目前我可以像这样加载库：

```
from ctypes import *
libtorque = CDLL("libtorque.so") 
```

并成功映射了一堆功能。但是，出于错误检查的目的，他们中的许多人设置了`pbs_errno`变量，所以我也需要访问它。但是，如果我尝试访问它，我会得到：

```
>>> pytorque.libtorque.pbs_errno
<_FuncPtr object at 0x9fc690> 
```

当然，它不是函数指针，尝试调用它会导致段错误。

它`int pbs_errno;`在主头文件和`extern int pbs_errno;`API 头文件中声明。

Objdump 将符号显示为：

```
00000000001294f8 g    DO .bss   0000000000000004  Base        pbs_errno 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-13T14:30:16.197

ctypes 文档中有一个关于访问在 dll 中导出的值的部分：

[http://docs.python.org/library/ctypes.html#accessing-values-exported-from-dlls](http://docs.python.org/library/ctypes.html#accessing-values-exported-from-dlls)

例如

```
定义 pbs_errno():
    返回 c_int.in_dll（libtorque，“pbs_errno”）

```

# javascript - 可见性会影响 DOM 操作性能吗？

> ID：544180
> 
> 赞同：10
> 
> 时间：2009-02-13T00:15:49.430
> 
> 标签：javascript, performance, optimization, dom

IE7/Windows XP

我的页面中有一个第三方组件，它会在每次调整浏览器窗口大小时进行大量 DOM 操作以调整自身。

不幸的是，我几乎无法控制它在内部做什么，并且我已经尽可能地优化了其他所有内容（例如回调和事件处理程序）。我无法通过设置 display:none 将组件从流程中移除，因为如果我这样做，它会无法自行测量。

一般来说，在调整大小期间将容器的可见性设置为不可见有助于提高 DOM 渲染性能吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-13T00:34:48.747

警告：我没有专门用 IE7 测试过这个，但根据我对它的 DOM 操作模型的了解，我相当有信心。

在我使用过的任何浏览器的任何版本中，更改 CSS 属性（无论`display: none`你`visibility: hidden`有什么）都不会影响 DOM 操作的性能。提高 DOM 操作速度的主要方法是从文档树中删除您将使用的节点，执行您的操作，然后重新添加它们。这包括跟踪它们的后续兄弟节点（如果有） （与 一起使用`insertBefore`），如果您使用分散在文档周围的节点，这可能会变得复杂。

我在一次执行大量 DOM 操作时看到的一种技术是获取`body`元素子节点的列表，删除它们，执行您的操作（无论它们落在文档树的哪个位置），然后重新附加主体的子节点。根据您的 DOM 操作需要多长时间（这本身部分取决于访问者计算机的速度！），这可能会产生明显的闪烁。这就是为什么通过 AJAX 操作内容的网站通常会用“微调器”或加载屏幕替换任何临时删除的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T00:24:11.783

我不确定，但是从活动文档的 DOM 中删除它然后对其进行操作*确实可以*提高性能。完成所有操作后，将其附加回文档的 DOM。可以把它想象成视频缓冲区交换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-10T04:54:02.593

我刚刚使用我遇到的按钮对话框情况对此进行了测试。基本上，我多次复制一个长对话框，直到我有一个 10000 行的文件。

### html:

```
<div class="no-visible dialog">
    ....
</div> 
```

### CSS：

```
.no-visible {
    visibility: hidden;
    animation:....
    ....
} 
```

## 结论：

使用所有的 JS 和 CSS 会大大降低计算机的速度，并且我所有的 css 动画都消失了**。**尤其是当一个按钮被点击并且 JS 必须找到相应的对话框来显示时，它会滞后。

## 解决方案：

将对话框放在另一个 html (dialogs.html) 中，并在需要时加载必要的内容。

# c# - 上传的 HttpPostedFile 为空

> ID：544182
> 
> 赞同：20
> 
> 时间：2009-02-13T00:16:40.617
> 
> 标签：c#, asp.net, asp.net-mvc

在视图上：

```
<% =Html.BeginForm("About", "Home", FormMethod.Post, new {enctype="multipart/form-data "})%>
  <input type="file" name="postedFile" />
  <input type="submit" name="upload" value="Upload" />
<% Html.EndForm(); %> 
```

在控制器中，有这样的东西：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult About(HttpPostedFile postedFile)
{
    //but postedFile is null 
    View();
} 
```

`postedFile`在 About() 中为空。如何上传文件？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-07-13T12:29:41.683

使用 HttpPostedFileBase（不是 HttpPostedFile），并按照表格中的方式命名参数。例如。如果你有

```
<input type="file" id="file1" name="file1" /> 
```

你必须有方法头：

```
public ActionResult About(HttpPostedFileBase file1) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-13T00:51:45.303

这不能回答为什么您的参数为空，但您可以直接深入研究请求。不过，这可能不是最“MVC”的方式。在你的方法体中试试这个：

```
var upload = Request.Files["postedFile"]
if (upload.ContentLength > 0)
{
  // Do whatever
} 
```

为了更“MVC”，您可以将该代码从控制器中拉出到 IModelBinder 实现中，并使用自定义对象作为方法的参数。这篇[Scott Hanselman 博客文章](http://www.hanselman.com/blog/IPrincipalUserModelBinderInASPNETMVCForEasierTesting.aspx)展示了实现自定义 ModelBinder 的步骤。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-08-25T16:06:45.760

用这个

```
public ActionResult Upload(HttpPostedFileBase excelfile) 
```

改变`HttpPostedFile`为`HttpPostedFileBase`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-06-05T06:44:43.377

我有同样的问题：

您必须为输入元素定义名称和 ID：

```
<input type="file" name="postedFile" id="postedFileId"  /> 
```

此致

斯特凡

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-06-04T17:35:52.227

您应该从 enctype 属性的末尾删除空格：

```
new {enctype="multipart/form-data "} => new {enctype="multipart/form-data"} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-20T18:31:04.987

您使用的是哪个版本的 MVC？现在，我尝试使用 HttpPostedFile 的 RC 候选人，但我得到了“没有空白构造函数错误”。我不得不使用 HttpPostedFileBase。

更重要的是，您正在运行的 MVC 版本取决于版本，您检索已发布文件的方式会有所不同。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-13T01:22:38.757

我也有一些怪癖`<%= Html.BeginForm ...%>`。所以，我使用 using。同样，在控制器端，我只是从请求对象中获取我上传的文件。

尝试这个。有用：

```
<% using (Html.BeginForm("Post", "Home", FormMethod.Post, new {enctype = "multipart/form-data"}))
   {%>

    <input type="file" id="postedFile" name="PostedFile" />
    <input type="submit" />

<%
} 
```

%>

```
[AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Post(FormCollection form)
    {
      HttpPostedFileBase postedFile =   Request.Files["PostedFile"];
        return RedirectToAction("Index");
    } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-07-05T12:54:34.367

“multipart/form-data”之后的空白是真正的问题......

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-06-04T14:51:41.833

你在用jquery mobile吗？如果是，您需要将 @data_ajax 设置为 false

```
new { enctype = "multipart/form-data", @data_ajax = "false" } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-07-15T11:21:56.567

此外，我发现文件上传所在的表单声明必须始终具有

```
new {enctype="multipart/form-data"} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-06-20T18:43:31.657

```
<form id="Form1" method="post" encType="multipart/form-data" runat="server"> 
```

添加`encType="multipart/form-data"`到您的表单中。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-01-26T11:09:07.427

这是上传文件所需的所有位

```
//in your model 
public partial class Profile
{
    [DisplayName("Image Upload")]
    [DataType(DataType.Upload)] 
    public HttpPostedFileBase FileUpload { get; set; }
}

// in your view
@model ProjName.Blabla.Profile

@using (Html.BeginForm("Edit", "Profile", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <input type="file" name="FileUpload" id="FileUpload" value="Choose File" class="form-control" />

    <input type="submit" value="Save" class="btn btn-default" />
} 
```

# apache-flex - Flex Date() 构造函数错误地转换了 Unix 时间戳啊

> ID：544186
> 
> 赞同：10
> 
> 时间：2009-02-13T00:17:57.210
> 
> 标签：apache-flex, actionscript-3, actionscript, flex3, timestamp

这真是要了我的命。我正在尝试将 Unix 时间戳（1236268800，相当于 2009 年 3 月 5 日星期四 16:00:00 GMT）转​​换为 Flex 中的 Date 对象。

```
var timestamp:Number = 1236268800;
trace(new Date(timestamp));

Output: Wed Jan 14 23:24:28 GMT-0800 1970 
```

也试过这个：

```
var timestamp:Number = 1236268800;
var date:Date = new Date;
date.time = timestamp;
trace(date);

Output: Wed Jan 14 23:24:28 GMT-0800 1970 
```

这些方法中的任何一种都应该有效。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-13T00:31:22.343

你必须转换为毫秒，乘以 1000

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T00:34:10.400

[http://livedocs.adobe.com/flex/2/langref/Date.html#Date()](http://livedocs.adobe.com/flex/2/langref/Date.html#Date())

如果您传递一个数据类型为 Number 的参数，则 Date 对象被分配一个基于自 1970 年 1 月 1 日 0:00:000 GMT 以来的**毫秒数的时间值，由 lone 参数指定。**

您需要将您的数字乘以 1000。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-13T00:34:40.243

由于它被解析为毫秒，只需将 epoch 值乘以 1000：

```
trace(new Date(1236268800 * 1000));
// Thu Mar 5 08:00:00 GMT-0800 2009 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-13T00:35:06.810

在 AS3 中，Date() 构造函数以毫秒为单位，而 Unix 时间以秒为单位。试试这个：

```
var timestamp:Number = 1236268800;
trace(new Date(timestamp * 1000)); 
```

# php - 动态设置多个复选框、混合 javascript 和 php 表单的技术

> ID：544187
> 
> 赞同：0
> 
> 时间：2009-02-13T00:18:33.043
> 
> 标签：php, javascript, html

我是 javascript 新手，我的问题很有效：我有一个 php 页面，它生成一个包含多个进程块或部分的表单，每个表单都有一组复选框

例如

```
<form action='./this.php' method='POST'>
One<br>
<input type='checkbox' name='one[part1]'>a<br>
<input type='checkbox' name='one[part2]'>b<br>
<input type='checkbox' name='one[part3]'>c<br>

<input type='checkbox' name='one[all]'>all<br>
<br>
Two<br>
<input type='checkbox' name='two[part1]'>a<br>
<input type='checkbox' name='two[part2]'>b<br>
<input type='checkbox' name='two[part3]'>c<br>

<input type='checkbox' name='two[all]'>all<br>

<input type='submit'>
</form> 
```

示例问题：我希望能够单击 two[all] 复选框并选中 two[part1]、two[part2] 和 two[part3]。

如果我将组中的所有复选框命名为相同，则 php post 值只会显示一个，因此我需要保持名称不同。

是否有任何简单的方法可以做到这一点，没有动态（通过 php）为每个部分生成单独的 onclick 函数。

请注意，并非所有部分都相同，有时 one.part1 可能无法检查，但会显示其信息，并且复选框名称将从 b 开始。

或者可能遍历 DOM 以在开始标记之后和全部检查之前查找所有复选框。

希望这足够清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T01:28:48.257

将表格更改为更像：

```
<input type='checkbox' name='section[one][]' value='part1'>a<br>
<input type='checkbox' name='section[one][]' value='part2'>b<br>
<input type='checkbox' name='section[one][]' value='part3'>c<br>

<input type='checkbox' name='one[all]' onclick='checkAll(one,this)>all<br> 
```

CheckAll 函数是：

```
function checkAll(checkid, exby) {
    boxes = document.getElementsByName('section[' + checkid + '][]');
    for (i = 0; i < boxes.length; i++){
        boxes[i].checked = exby.checked? true:false
    }
} 
```

这最终仍然在 php post var 中提供了可管理的数组，同时具有单数名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T00:23:16.310

您需要一个带有组名参数的 javascript onClickAll 函数。然后，您可以遍历 getElementsByName 返回的每个复选框并将它们标记为选中/未选中。在回发时，您将获得一组带有所用组名的复选框的值。通过循环，您可以知道哪些已检查，哪些未检查。

我会写一些示例代码，但自从我使用 PHP/Javascript 工作以来已经有一段时间了，我认为最好的人会更好地做到这一点。但我告诉你的应该是它的要点。祝你好运！

# winforms - 您可以关闭单个窗口控件的视觉样式/主题吗？

> ID：544203
> 
> 赞同：0
> 
> 时间：2009-02-13T00:25:24.463
> 
> 标签：winforms, themes, datetimepicker, uxtheme

我的 Windows 窗体应用程序使用以下标准代码行，以便为整个应用程序启用视觉样式（主题）...

```
Application.EnableVisualStyles(); 
```

...效果很好，所有控件都具有主题外观，而不是您会得到的平坦的战舰灰色。但我只需要关闭单个控件实例的视觉样式。我无法删除上面的行，因为那样我会失去所有控件的主题。是否可以从单个控件实例中删除主题？

仅供参考：碰巧我想从 DateTimePicker 实例中删除主题，所以如果除了 DateTimePicker 之外一般答案是否定的，那么这就足够了。如果解决方案涉及在最低级别使用控件，我很乐意使用平台调用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-13T00:50:24.123

看起来您可以在控件上使用 SetWindowTheme：

```
[DllImport("uxtheme", ExactSpelling = true, CharSet = CharSet.Unicode)]
public extern static Int32 SetWindowTheme (IntPtr hWnd, 
              String textSubAppName, String textSubIdList);

yourControl.FlatStyle = FlatStyle.System;
SetWindowTheme(yourControl.Handle, "", ""); 
```

[原始代码项目文章](http://www.codeproject.com/KB/miscctrl/DisableWindowsThemes.aspx)

# delphi - Delphi 2009，Indy 10，TIdTCPServer.OnExecute，如何抓取InputBuffer中的所有字节

> ID：544204
> 
> 赞同：7
> 
> 时间：2009-02-13T00:26:46.333
> 
> 标签：delphi, delphi-2009, indy

我正在搞乱 Delphi 2009 提供的 Indy 10，并且在 OnExecute 触发时无法从 IOHandler 获取所有数据......

```
procedure TFormMain.IdTCPServerExecute(AContext: TIdContext);
var
  RxBufStr: UTF8String;
  RxBufSize: Integer;
begin

  if AContext.Connection.IOHandler.Readable then
  begin
    RxBufSize := AContext.Connection.IOHandler.InputBuffer.Size;
    if RxBufSize > 0 then
    begin
      SetLength(RxBufStr, RxBufSize);
      AContext.Connection.IOHandler.ReadBytes(TBytes(RxBufStr), RxBufSize, False);
    end;
  end;

end; 
```

AContext.Connection.IOHandler.InputBuffer.Size 似乎不可靠并且经常返回 0，但在下一次通过 OnExecute 运行时，它会获取正确的字节数，但为时已晚。

本质上，我希望能够抓取所有数据，将其填充到 UTF8String（*不是*Unicode 字符串）中，然后解析特殊标记。所以我没有标题，消息是可变长度的。似乎 Indy 10 IOHandlers 没有为此设置，或者我只是使用错误。

做一些事情会很好，比如传递一个特定大小的缓冲区，尽可能多地填充它并返回实际填充的字节数，然后如果还有更多则继续。

顺便说一句 TIdSchedulerOfFiber 的状态如何，这看起来很有趣，它有效吗？有人在用吗？我注意到它不在 Delphi 2009 的标准安装中。

**更新：**我发现 Msg := AContext.Connection.IOHandler.ReadLn(#0, enUTF8); 哪个可行，但我仍然想知道上述问题的答案，是因为它是基于阻塞IO的吗？这使得 TIdSchedulerOfFiber 更加热衷。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-13T02:07:31.533

你不应该那样使用 Readable() 。请尝试以下操作：

```
procedure TFormMain.IdTCPServerExecute(AContext: TIdContext);
var
  RxBuf: TIdBytes;
begin
  RxBuf := nil;
  with AContext.Connection.IOHandler do
  begin
    CheckForDataOnSource(10);
    if not InputBufferIsEmpty then
    begin
      InputBuffer.ExtractToBytes(RxBuf);
      // process RxBuf as needed...
    end;
  end;
end; 
```

或者：

```
procedure TFormMain.IdTCPServerExecute(AContext: TIdContext);
var
  RxBufStr: String; // not UTF8String
begin
  with AContext.Connection.IOHandler do
  begin
    CheckForDataOnSource(10);
    if not InputBufferIsEmpty then
    begin
      RxBufStr := InputBuffer.Extract(-1, enUtf8);

      // Alternatively to above, you can set the
      // InputBuffer.Encoding property to enUtf8
      // beforehand, and then call TIdBuffer.Extract()
      // without any parameters.
      //
      // Or, set the IOHandler.DefStringEncoding
      // property to enUtf8 beforehand, and then
      // call TIdIOHandler.InputBufferAsString()

      // process RxBufStr as needed...
    end;
  end;
end; 
```

至于 TIdSchedulerOfFiber - SuperCore 包此时实际上已经死了。它已经很长时间没有工作了，并且没有与最新的 Indy 10 架构保持同步。我们可能会在以后尝试复活它，但这不在我们近期的计划中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-11T11:32:52.907

```
procedure TFormMain.IdTCPServerExecute(AContext: TIdContext); 
var
  RxBufStr: UTF8String;
  RxBufSize: Integer;
begin    
  if AContext.Connection.IOHandler.Readable then
  begin     
    AContext.Connection.IOHandler.ReadBytes(TBytes(RxBufStr),-1, False);
  end;
end; 
```

# c++ - 是否有可能（或可以）有一个 std::list 的 std::list？

> ID：544206
> 
> 赞同：2
> 
> 时间：2009-02-13T00:27:57.610
> 
> 标签：c++

我有一个 std::list 点（只存储一个 x，y）。这些点中的每一个都代表一个多边形，我稍后会绘制它。

```
class Point {
public:
    int x, y;
    Point(int x1, int y1)
    {
        x = x1;
        y = y1;
    }
};

std::list <Point> currentPolygon; 
```

我想要一个这些多边形的列表（列表本身）。

这可能吗？我如何拥有一个点列表的 std::list （这样我可以存储多个多边形）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-13T00:33:50.510

确实是。但是你可能想要的——为了以后的可扩展性——创建第二个类——“多边形”，它包含一个点列表。然后使用多边形列表。

编辑：我不是 C++ 程序员，所以如果你需要一个真正的项目，我相信像[j_random_hacker 的响应这样的实现会更好。](https://stackoverflow.com/questions/544206/is-it-possible-or-ok-to-have-a-stdlist-of-stdlists/544685#544685)我只是想给出这个设计的快速代码示例。

```
class Point {
public:
    int x, y;
    Point(int x1, int y1)
    {
        x = x1;
        y = y1;
    }
};

class Polygon {
public:
    std::list <Point> currentPolygon;
    Polygon(std::list <Point> p1)
    {
        currentPolygon = p1
    }
}; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-13T00:35:04.377

你可以使用这个：

```
std::list< std::list<Point> > polygons; 
```

为了使事情变得更容易，请使用 typedef。

```
class Point {
public:
    int x, y;
    Point(int x1, int y1)
    {
        x = x1;
        y = y1;
    }
};
typedef std::list<Point> PolygonType;
typedef std::list<PolygonType> PolygonsType; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-13T04:12:18.927

这是 Jeffrey 的代码，稍微整理一下以解决我在评论中抱怨的问题 :)

```
class Point {
public:
    int x, y;
    Point(int x1, int y1) : x(x1), y(y1)
    {
    }
};

class Polygon {
public:
    std::list <Point> currentPolygon;    // Consider making this private.
    explicit Polygon(std::list <Point> const& p1) : currentPolygon(p1)
    {
    }
}; 
```

**[编辑：感谢 Matt Davis 指出我提供的用户定义的复制构造函数是不必要的，这简化了事情。]**

# css - 你能帮我居中吗 带有 CSS 的元素？

> ID：544207
> 
> 赞同：49
> 
> 时间：2009-02-13T00:28:46.407
> 
> 标签：css, navigation, html-lists, center

我一直在为确实应该很容易的事情感到困惑，但是在徒劳的三个小时之后，我还没有解决它：

一位朋友让我修复[他的 WordPress 网站](http://www.hootingyard.org/)的模板，使水平导航菜单栏在页面上水平居中。他希望它紧贴红色部分的底部中间 - 然后它正好适合红页两侧的两个标志之间。

红色部分 ( `class="header"`) 已`text-align`设置为`center`。这似乎足以确保标题和其下方的描述文本居中对齐，但由于某种原因，我无法使菜单（即 a `ul`）与页面中心对齐。

有人愿意建议我做错了什么吗？为什么我无法使菜单居中？我需要在样式表中更改什么才能使其正常工作？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-02-13T00:40:28.607

要将一行块居中，您应该使用 inline-block：

```
ul.menu { display: block; text-align:center; }
ul.menu li { display: inline-block; } 
```

IE 不理解 inline-block，但如果你只为 IE 将其设置为 inline，它仍然会表现为 inline-block：

```
<!--[if lt IE 8]>
ul.menu li { display: inline }
<![endif]--> 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-08-29T20:09:14.917

1写给`style="text-align: center;"`家长`div``ul`

2 写信`style="display: inline-table;"`给`ul`

2 写信`style=" display: inline;"`给`li`

```
<div class="menu">
  <ul>
    <li>menu 1</li>
    <li>menu 2</li>
    <li>menu 3</li>
  </ul>
</div>

<style>
.menu { text-align:center; }
.menu ul { display:inline-table;}
.menu ul li {display:inline;}
</style> 
```

结束

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T00:44:26.057

最好的方法是：

将 ul 包裹在一个新的 div id="topmenu" 或类似的东西中，然后给它以下样式

```
bottom:0;
position:absolute;
width:780px; 
```

并给 ul.menu 这个

```
margin:0 auto;
width:535px; 
```

这里唯一的问题是您正在设置菜单列表的宽度，因此如果菜单项的宽度发生变化，也需要在 CSS 文件中进行更改（即，如果添加了新的菜单项。

**更新：**刚刚注意到您上面关于不手动设置宽度的评论。如果您愿意使用一点点 javascript，您可以将其粘贴在 document ready 块中并删除`width: 535px;`

```
var sum = 0; jQuery('.menu').children().each(function() { sum += jQuery(this).outerWidth(); }); jQuery('.menu').css('width', sum + 30); 
```

一旦页面加载，这会将 css width 属性设置为实际呈现的宽度，因此布局将起作用。

完整的 HTML 如下：

```
<div id="header">
    <h1 class="blog-title"><a href="http://www.hootingyard.org/" accesskey="1">Hooting Yard</a></h1>
    <p class="description">A Website by Frank Key</p>
    <div id="topmenu">
        <ul class="menu">
        <li class="current_page_item"><a href="http://www.hootingyard.org/" title="Prose, etc">Prose, etc</a></li>      
        <li class="page_item page-item-533"><a href="http://www.hootingyard.org/archivepage" title="Archives">Archives</a></li>
<li class="page_item page-item-534"><a href="http://www.hootingyard.org/books" title="Books">Books</a></li>
<li class="page_item page-item-551"><a href="http://www.hootingyard.org/regarding-mr-key" title="Regarding Mr Key">Regarding Mr Key</a></li>
<li class="page_item page-item-1186"><a href="http://www.hootingyard.org/subscriptions" title="Subscriptions">Subscriptions</a></li>
        <li class="admintab"><a href="http://www.hootingyard.org/wp-login.php?action=register">Register</a></li>    
    </ul>
</div>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-24T16:20:38.280

ul 的指定宽度 `ul{ width:700px; margin:0 auto;}`

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2009-02-13T00:35:32.443

由于它是绝对定位的，你可以给它一个 left 属性：

> .menu { 左：125px; }

125px左右应该不错

# asp.net - 如何打印与 phpinfo() 类似的信息，但用于 ASP.NET？

> ID：544209
> 
> 赞同：19
> 
> 时间：2009-02-13T00:29:23.627
> 
> 标签：asp.net, configuration, webserver, phpinfo

我已经在 ASP.NET 中遍历了该`Request.ServerVariables`集合，但它不如`phpinfo()`.

如何为 ASP.NET 打印所有这些信息，包括服务器软件、驱动程序等？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-07-10T20:16:28.050

带有此标题的空页面应该可以解决问题：

```
<%@ Page Trace="true"  Language="C#" 
    ContentType="text/html" ResponseEncoding="utf-8" %> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-03-22T02:57:49.267

[http://code.google.com/p/aspnetsysinfo/](http://code.google.com/p/aspnetsysinfo/)

> 该项目是一个 ASP.Net 系统信息探测器。这是一个试图获取尽可能多的有用托管信息的页面。这个概念类似于 PHP 页面，其中包含`phpinfo()`...

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-02-22T03:41:22.260

[`ServerInfo.GetHtml()`](https://msdn.microsoft.com/en-us/library/system.web.helpers.serverinfo.gethtml)基本相同`phpinfo()`。不仅实际返回的信息非常相似，而且 html 演示文稿也非常相似。[这是一个现场演示！](http://service.magic-mouse.net/WebPage.cshtml)

* * *

即使您只是制作一个纯 Web API 应用程序，但让控制器返回`HttpResponseMessage`如下内容，您也可以使用它：

```
 public System.Net.Http.HttpResponseMessage Get()
    {
        var serverinfo = System.Web.Helpers.ServerInfo.GetHtml().ToHtmlString();
        var response = new System.Net.Http.HttpResponseMessage();
        response.Content = new System.Net.Http.StringContent("<html><body>" + serverinfo + "</body></html>");
        response.Content.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue("text/html");
        return response;
    } 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-13T00:53:10.200

使用 ASP.Net 跟踪子系统怎么样？它允许您获得：

> 控制树：控制树呈现 ASP.NET 控制树的 HTML 表示。显示每个控件的 ID、运行时类型、呈现所需的字节数以及它​​在视图状态和控件状态中所需的字节数。
> 
> 会话状态：列出特定用户会话的所有键、它们的类型和值。
> 
> 应用程序状态：列出当前应用程序的应用程序对象中的所有键及其类型和值。
> 
> Request Cookies：列出请求页面期间传入的所有cookies。
> 
> 响应 Cookie：列出在页面响应期间传回的所有 cookie。
> 
> Headers Collection：显示浏览器请求过程中可能传入的所有header，包括Accept-Encoding，表示浏览器是否支持压缩的HTTP响应和Accept语言。
> 
> 表单集合：显示表单集合及其所有键和值的完整转储。
> 
> QueryString 集合：显示 QueryString 集合及其包含的所有键和值的转储。
> 
> 服务器变量：Web 服务器知道的关于应用程序的所有内容的名称-值对的完整转储。

见[这里](http://www.beansoftware.com/ASP.NET-Tutorials/Tracing-ASP.NET.aspx)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-20T18:54:37.993

看看[一瞥](https://github.com/glimpse/glimpse)。

> [glimpse](https://github.com/glimpse/glimpse) : 客户端瞥见你的服务器
> 
> Firebug 用于客户端，Glimpse 用于服务器......换句话说，客户端 Glimpse 用于查看服务器中正在发生的事情。

这是[浏览器中显示的请求选项卡](https://web.archive.org/web/20120508210254/http://getglimpse.com/Help/Plugin/Request)。 [（来源：][[getglimpse.com](http://getglimpse.com/Content/Plugin/Request.jpg)][）][![](https://i.stack.imgur.com/1vhkc.jpg)](https://web.archive.org/web/20120508210254/http://getglimpse.com/Help/Plugin/Request)

还有[其他带有信息](https://web.archive.org/web/20140330024121/http://getglimpse.com:80/Help/)的选项卡，并且可以[编写插件](https://web.archive.org/web/20120825184747/http://getglimpse.com:80/Help/CreatingPlugins)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-13T00:41:02.990

以下可能有效？

```
foreach (string Key in Request.ServerVariables.AllKeys) 
   Response.Write(Key + ": " + Request.ServerVariables[Key] + "<br>"); 
```

我不确定 phpinfo() 会吐出什么信息。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-06T20:37:17.097

这是我找到的答案，乍一看，它似乎涵盖了它： [http](http://www.actionscript.org/forums/showthread.php3?p=133347) ://www.actionscript.org/forums/showthread.php3?p= 133347 有人编写了它

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-13T00:32:14.027

快速谷歌结果：

[http://forums.asp.net/p/901862/2087653.aspx](http://forums.asp.net/p/901862/2087653.aspx)

据他们说，答案是否定的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-01-15T20:40:06.687

对于带有 VBScript 的 ASP 经典（**不是 ASP.net** - 请参阅下面的免责声明），`Sub aspinfo()`在[Planet Source Code](http://www.planet-source-code.com/vb/scripts/ShowCodeAsText.asp?txtCodeId=8048&lngWId=4)上有一个，我对其进行了非常小的更改（将调用`aspinfo()`移动到顶部作者/评论块）。

这是我修改后的[Dennis Pallett's`aspinfo()`](http://www.planet-source-code.com/vb/scripts/ShowCodeAsText.asp?txtCodeId=8048&lngWId=4)版本的来源，它可以保存`aspinfo.asp`在相关的网络服务器上。

```
<%@ Language="VBSCRIPT" %>
<%

    '**************************************
    ' Name: aspinfo()
    ' Description:aspinfo() is the equivalent of phpinfo(). It displays all kinds of
    '     information about the server, asp, cookies, sessions and several other things in
    '     a neat table, properly formatted.
    ' By: Dennis Pallett (from psc cd)
    '
    '
    ' Inputs:None
    '
    ' Returns:None
    '
    'Assumes:You can include my code in any of your pages and call aspinfo() to show
    '     the information of your server and asp. 
    '
    '**************************************

Sub aspinfo()
    Dim strVariable, strASPVersion
    Dim strCookie, strKey, strSession
    'Retrieve the version of ASP
    strASPVersion = ScriptEngine & " Version " & ScriptEngineMajorVersion & "." & ScriptEngineMinorVersion
%>
    <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
    <html>
    <head>
    <style type="text/css"><!--
    a { text-decoration: none; }
    a:hover { text-decoration: underline; }
    h1 { font-family: arial, helvetica, sans-serif; font-size: 18pt; font-weight: bold;}
    h2 { font-family: arial, helvetica, sans-serif; font-size: 14pt; font-weight: bold;}
    body, td { font-family: arial, helvetica, sans-serif; font-size: 10pt; }
    th { font-family: arial, helvetica, sans-serif; font-size: 10pt; font-weight: bold; }
    //--></style>
    <title>aspinfo()</title></head>
    <body>
    <div align="center">
    <table width="80%" border="0" bgcolor="#000000" cellspacing="1" cellpadding="3">
    <tr>
        <td align="center" valign="top" bgcolor="#FFFFAE" align="left" colspan="2">
            <h3>ASP (<%= strASPVersion %>)</h3>
        </td>
    </tr>
    </table>
    <br>
    <hr>
    <br>
    <h3>Server Variables</h3>
    <table width="80%" border="0" bgcolor="#000000" cellspacing="1" cellpadding="3">
<%
    For Each strVariable In Request.ServerVariables
      Response.write("<tr>")
      Response.write("<th width=""30%"" bgcolor=""#FFFFAE"" align=""left"">" & strVariable & "</th>")
      Response.write("<td bgcolor=""#FFFFD9"" align=""left"">" & Request.ServerVariables(strVariable) & "&nbsp;</td>")
      Response.write("</tr>")
    Next 'strVariable
%>
    </table>
    <br>
    <hr>
    <br>
    <h3>Cookies</h3>
    <table width="80%" border="0" bgcolor="#000000" cellspacing="1" cellpadding="3">
<%
    For Each strCookie In Request.Cookies
        If Not Request.Cookies(strCookie).HasKeys Then
            Response.write("<tr>")
            Response.write("<th width=""30%"" bgcolor=""#FFFFAE"" align=""left"">" & strCookie & "</th>")
            Response.write("<td bgcolor=""#FFFFD9"" align=""left"">" & Request.Cookies(strCookie) & "&nbsp;</td>")
            Response.write("</tr>")
        Else
            For Each strKey In Request.Cookies(strCookie)
                Response.write("<tr>")
                Response.write("<th width=""30%"" bgcolor=""#FFFFAE"" align=""left"">" & strCookie & "(" & strKey & ")</th>")
                Response.write("<td bgcolor=""#FFFFD9"" align=""left"">" & Request.Cookies(strCookie)(strKey) & "&nbsp;</td>")
                Response.write("</tr>")
            Next
        End If
    Next
%>
    </table>
    <br>
    <hr>
    <br>
    <h3>Session Cookies</h3>
    <table width="80%" border="0" bgcolor="#000000" cellspacing="1" cellpadding="3">
<%
    For Each strSession In Session.Contents
            Response.write("<tr>")
            Response.write("<th width=""30%"" bgcolor=""#FFFFAE"" align=""left"">" & strSession & "</th>")
            Response.write("<td bgcolor=""#FFFFD9"" align=""left"">" & Session(strSession) & "&nbsp;</td>")
            Response.write("</tr>")
    Next
%>
    </table>
    <br>
    <hr>
    <br>
    <h3>Other variables</h3>
    <table width="80%" border="0" bgcolor="#000000" cellspacing="1" cellpadding="3">
    <tr><th width="30%" bgcolor="#FFFFAE" align="left">Session.sessionid</th><td bgcolor="#FFFFD9"><%= Session.sessionid %></td></tr>
    <tr><th width="30%" bgcolor="#FFFFAE" align="left">Server.MapPath</th><td bgcolor="#FFFFD9"><%= Server.MapPath ("/") %></td></tr>
    </table>
    </div>
    </body>
    </html>
<%
End Sub
aspinfo()
%> 
```

* * *

*免责声明：请注意，这最初是作为对[Rob 答案的](https://stackoverflow.com/a/4370704/4228193)[编辑](https://stackoverflow.com/review/suggested-edits/10899562)提交的，但建议将其作为全新的答案响应。另请注意，正如[frankadelic 在对 Rob 回答的评论中指出](https://stackoverflow.com/questions/544209/is-there-an-equivalent-to-phpinfo-in-asp-net/4370704#comment4771518_4370704)的那样，此响应并未解决 OP 的问题，因为该问题是针对 ASP.net，而不是针对 ASP Classic。*

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-08T19:39:30.717

我实现了一个包含在名为[InfoPage](https://github.com/zeppaman/info-page)的项目中的简单库。该库向您显示系统信息、应用程序中包含的程序集、内部版本号和更改日志。

您可以通过 nuget 将其简单地包含在您的项目中，它可以快速集成和自定义。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-10-30T11:48:38.183

我有一个[要点可](https://gist.github.com/mika76/84df6985535c54d9c4a7adffb43e53eb)用于在 .net 核心中添加带有 phpinfo 类型信息的剃须刀页面......

# sharepoint - Sharepoint 2007 文档管理

> ID：544210
> 
> 赞同：2
> 
> 时间：2009-02-13T00:30:24.653
> 
> 标签：sharepoint, sharepoint-2007

我们正在使用 Sharepoint 2007 开发文档管理解决方案，但在确定几个项目的结构时遇到了一些问题。这些文档是用于将数据合并为发送给客户的信件的模板。虽然模板将在 Sharepoint 中进行管理，但实际生成的信件将通过 Web 应用程序进行处理。要提取模板的规则将通过元数据通过 Sharepoint “分配”。该数据将被发送到另一个系统（它将跟踪规则和原始模板的标识符）。将在 SP 端创建一个 Web 服务，因此前端应用程序只需调用它来提取模板（一旦确定要使用哪个模板）。

好吧，真正的问题是如何处理规则？我最初认为元数据并将数据写出（通过 Web 服务调用）到 Web 应用程序数据库。例如，当保存文档时，有一个模板类型的元数据字段（用于此自定义内容类型）。第一个问题如何填充可用于共享点的下拉列表以加载模板类型列表？我可以从数据库中驱动它还是必须使用静态 xml 列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T01:40:10.150

啊。您可以根据 BDC 上的信息查找来创建字段。您还可以基于 SharePoint 中的列表创建查找。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T01:32:38.607

我可能在这里大大简化了您的要求，因此请谨慎对待。

如果所有这些信息都作为列存储在文档库中，则您不必创建自己的 Web 服务。SharePoint 具有用于从列表中检索数据的 Web 服务（请参阅[此 MSDN 参考](http://msdn.microsoft.com/en-us/library/ms953738.aspx)）。

在这种情况下，规则将在客户端而不是在 SharePoint 中处理，但将使用存储在 SharePoint 中的元数据。客户端可以构建一个 CAML 查询来选择最适用的模板。（如果您不了解 CAML，下载[U2U CAML 查询生成器](http://www.u2u.be/res/Tools/CamlQueryBuilder.aspx)是一个不错的起点。）

还：

> 第一个问题如何填充可用于共享点的下拉列表以加载模板类型列表？我可以从数据库中驱动它还是必须使用静态 xml 列表。

如果您需要为文档库中的不同元数据字段提供下拉列表，我会考虑将它们设为查找列。这样，客户端应用程序可以通过 Web 服务下载每列的选项列表，因此您不必在其他地方维护选项列表。

# java - 使用 Spring options 标签显示枚举的 toString 值

> ID：544215
> 
> 赞同：11
> 
> 时间：2009-02-13T00:32:38.470
> 
> 标签：java, spring, jsp, enums

我将 Spring 用于 HTML 表单。其中一个字段是一个`enum`，因此我想要一个 HTML 下拉列表（`<option>`标签）。我的枚举名称与`toString()`值不同。例如：

```
public enum Size {
    SMALL("Small"), LARGE("Large"), VERY_LARGE("Very large");

    private final String displayName;

    private Size(String displayName) {
        this.displayName = displayName;
    }

    public String toString() {
        return displayName;
    }
} 
```

我希望用户看到`toString()`价值。通常这是使用`itemLabel`Spring options 标记来完成的。

```
<form:options items="${enumValues}" itemLabel="beanProperty" /> 
```

但`toString()`它不是 bean 属性，因为它不以“get”开头。有没有办法设置`itemLabel`使用 toString 的值而不必创建 getter？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T16:43:39.977

我知道这已经有几年了，现在必须解决，但我想我会为未来的人添加解决方案。

只需删除 [itemLabel="beanProperty"] 部分。它将使用 toString 打印值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T06:17:26.410

为什么不向您的枚举添加公共 getDisplayName() 方法？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-04T16:04:03.660

您是否尝试过使用 Spring 强大的 AOP 模型从一个地方扩展您的枚举？看起来，根据您拥有的枚举数量，您可以轻松地`getDisplayName()`向所有枚举添加一个简单地返回其`toString()`值的方法。

# apache-flex - 如何防止使用 Flex 将一个项目从另一个 TileList 拖放到另一个 TileList 中？

> ID：544232
> 
> 赞同：2
> 
> 时间：2009-02-13T00:36:13.080
> 
> 标签：apache-flex, drag-and-drop

我想防止用户将某些项目从一个 TileList 拖到另一个。它们是否可以放入 TileList 应根据与项目关联的数据来确定。

为了显示该项目不能拖到 TileList 我想在光标旁边的红色圆圈图标中显示正常的白色十字。如果在确定不应发生丢弃时尝试丢弃，我想显示一条警告消息，解释为什么无法丢弃该项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-07T19:32:37.863

您需要阻止对 dragDrop 事件（阻止它被添加到新列表）和 dragComplete 事件（阻止它从旧列表中删除）的默认操作。这是一个允许项目在列表内移动但不能在列表之间移动的示例：

```
private var preventMove:Boolean = false;
private function onDragDrop(event: DragEvent): void {
    preventMove = (event.dragInitiator != event.target);
    if (preventMove)
        event.preventDefault();
}

private function onDragComplete(event: DragEvent): void {
    if (preventMove) {
        event.preventDefault();
    }
} 
```

您可以使用任何您想要的标准来代替根据 dragDrop 目标检查 dragInitiator。除了在 dragComplete 上调用 preventDefault 外，您还可以弹出错误消息。

你有两个列表（或 TileLists 或其他）：

```
<s:List dragDrop="onDragDrop(event)" dragComplete="onDragComplete(event)"
        dragEnabled="true" dropEnabled="true"  dragMoveEnabled="true">
</s:List>
<s:List dragDrop="onDragDrop(event)" dragComplete="onDragComplete(event)"
        dragEnabled="true" dropEnabled="true"  dragMoveEnabled="true">
</s:List> 
```

如果您不需要能够在同一个列表中拖放东西，或者您只是拖动一个方向，那么只需不启用两个列表上的所有内容就可以更简单。

Chetan Sastry 链接的文章现在已经过时并且链接已断开。

# php - 使用 PHP 的 MySQL 注入保护和漏洞标志

> ID：544239
> 
> 赞同：10
> 
> 时间：2009-02-13T00:39:41.793
> 
> 标签：php, mysql, database, sql-injection

防止 MySQL 注入的最佳方法是什么？我应该注意哪些弱点？

我知道它是什么，但我真的不知道我可能有多脆弱。尽管我已经采取了（我认为的）措施来保护自己和我的数据库。

有什么可靠的方法可以阻止某人吗？

顺便说一句...我用 PHP 编写 :)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-13T00:45:47.427

使用准备好的语句而不是混合语句和实际的有效负载数据。

看

*   [http://dev.mysql.com/tech-resources/articles/4.1/prepared-statements.html](http://dev.mysql.com/tech-resources/articles/4.1/prepared-statements.html)
*   [PDO::准备](http://uk.php.net/manual/en/pdo.prepare.php)
*   [mysqli::准备](http://uk.php.net/manual/en/mysqli.prepare.php)

您可能还对[http://shiflett.org/articles/sql-injection](http://shiflett.org/articles/sql-injection)和[http://shiflett.org/blog/2007/sep/the-unexpected-sql-injection感兴趣](http://shiflett.org/blog/2007/sep/the-unexpected-sql-injection)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-13T01:14:31.600

没有人相信！

根据数据类型清理所有输入 -`filter_var()`或正则表达式或`in_array()`有效值或混合策略。

“输入”是指您不直接控制的任何输入源——不仅仅是表单！

对你从`$_GET`, `$_POST`, `$_SESSION`,回来的任何东西进行消毒`$_COOKIE`——任何可能被污染的东西。

和

使用准备好的语句

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T00:42:47.540

您必须清理所有输入。如何做到这一点取决于您正在使用的编程语言和/或框架。

编辑：

如果您使用 php，您正在寻找的函数是 mysql_real_escape_string($string)。您应该在从客户端收到的应该进入数据库的所有内容上使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T00:50:11.923

如果你没有使用为你提供清理工具的框架 PHP 有一个内置的字符串转义器，你应该从那里开始。您可以在[mysql real escape string 的 PHP 文档中](http://www.php.net/mysql_real_escape_string)找到相关文档。如果您查看示例三，您将对可以遵循的基础知识有一个很好的了解。

我遵循的另一种方法是确保在适当的地方转换变量。例如，如果我希望用户的输入是整数，我将执行以下操作：

```
$age = (int)$age; 
```

此外，如果一列应该被限制为一个或两个值（例如性别列），请确保在将其放入数据库之前在 PHP 中强制执行此操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-13T01:14:49.180

这似乎是常识，但我有一段时间被绊倒了。

**编码** `htmlentities()`和**转义** 是有区别的`mysql_real_escape_string()`。我认为它们是可以互换的。然而，没有......常识会告诉你。:) 通常最好同时应用它们，例如先编码，然后转义。

然后在将数据拉出时反转该过程，取消转义（如果需要）然后取消编码。请注意，具体执行（和反转）步骤的方式将节省很多头痛和双重逃避的麻烦。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-13T00:50:21.673

您可能遇到问题的迹象是直接接受用户输入并将其放入您的 SQL 命令中。

例如，您询问他们的用户名。如果你接受它然后简单地说

“从用户名中选择 * 用户名 = '$USERNAME';”

然后用户可以添加“JOE'; Drop Table...”等等。

在 perl 你可以说类似

```
my $sth2 = $dbh->prepare("Insert Into HostList (HostName,PollTime,Status) values (?,?,?);");
$sth2->execute($Hostname,$myDate,$Status); 
```

然后，execute 方法将寻找上述漏洞利用并正确转义。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-20T05:25:58.023

经过一些实验，我为完全干净的 SQL 注入创建了两个函数。与准备好的语句配合使用，它可以完美运行。

```
 // Cleanup outer SQL
    protected static function escapeOuter( string $s ): string {

        return preg_replace(

                ['/(\/\*\s*\w*\s*(?!.\/\*))/si', '/(\-\-\s*\w*\s*(?!.\-\-))/si', '/(or\s*\w*\s*=\s*\w(?!.*or)|\|\|\s*\w*\s*=\s*\w(?!.\|\|))/si'], 

                [';', ';', ''],

                str_replace(

                    [ '+--', '--+', '"', "\x1a", '%', 'qq ', '--', '/*!',],  

                    [ '', ';', '&quot;', '\\Z', "\%", '&#45;&#45;', '&#47;&#42;&#33;'], 

                    trim( $s )

                )

        );

    }

    // Cleanup inner SQL
    protected static function innerEscape( string $v ): string {

        // Secure stage means that inner SQL clauses fixed to be secure
        $secureStage = str_ireplace(

            ['ASCII', 'UNION', ' OR ', '||', ' AND ', '&&', ' ON ', "'", '+--', '--+', 'qq', '"', '--', '/*!', ], 

            ['', '', ' &#111;&#114; ', ' &#124;&#124; ', ' &#97;&#110;&#100; ', ' &amp;&amp; ', ' &#111;&#110; ', '\'', '', ';', '', '&quot;', '&#45;&#45;', '&#47;&#42;&#33;'],

            addslashes(

                htmlspecialchars( $v )

            )

        );

        // Not available to use built in escape future when DB connection not established
        if( isset( self::$dbx_lnk[ 1 ] ) ) {

            if( (bool)self::$dbx_lnk[ 1 ]['CONNECTION'] ) {

                return mysqli_real_escape_string( self::$dbx_lnk[ 0 ], $secureStage ); 

            }
            else {

                return $secureStage;

            }

        }
        else {

            return $secureStage;

        }

    } 
```

这个函数是我自己的[数据库驱动程序](https://github.com/Full-Rx/RevolveR-CMF/blob/main/Kernel/Modules/DataBaseX.php)的一部分。

例如，您必须使用 innerEscape 未来来清理字段值，而使用 escapeOuter 未来来清理完整的 MySQL 查询。过滤后，您必须使用 PDO 或 MySQLi 的准备好的语句。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-13T01:05:31.870

在我尝试在任何代码（MySQL 查询、数据显示等）中使用它之前，我在所有输入上都使用了这个 PHP 函数。它可能不完整，但它应该停止所有基本的入侵系统的尝试：

```
//$linkID is the link ID of the connection to the MySQL database
function clean_input($input)
{
    GLOBAL $linkID;
    if(get_magic_quotes_gpc())
    {
        //Remove slashes that were used to escape characters in post.
        $input = stripslashes($input);
    }
    //Remove ALL HTML tags to prevent XSS and abuse of the system.
    $input = strip_tags($input);
    //Escape the string for insertion into a MySQL query, and return it.
    return mysql_real_escape_string($input,$linkID);
} 
```

# c# - 保留用户生成函数的最佳模式？

> ID：544241
> 
> 赞同：1
> 
> 时间：2009-02-13T00:40:40.743
> 
> 标签：c#, sql, database-design, schema

我的项目需要用户创建一些基本的数学函数，我需要将它们存储在 ms sql 数据库中，以便在我的业务逻辑中的数据集上使用。

函数将类似于：when (value1 between 20 and 40) then value2 = value 2 * 37.8

存储此类内容的最佳模式是什么？

什么是最有效的方法来翻译持久化的函数，以便我可以将它应用到数据集？

我正在使用 c# 和 ms sql 2008

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T06:10:53.260

这是困难的一个。基本上你想创建一个解析器。

我相信你需要有两个表：第一个表有一个 functionID ，orderID ， operatorID

第二个表将在 operatorID 和操作数之间具有一对多的关系。

FunctionID 将是函数的唯一标识符。orderID 将确定我们需要以何种顺序解析同一 functionID 的各个行。操作数将是需要与运算符一起应用的实际变量。

例如：

```
Table 1 

FuncID         OrderID         OperatorID
1              1               1 (for *)
1              2               2 (for +)

Table 2

OperatorID       Operands
1                a
1                b
2                c 
```

解析后将变为 f(x) = a*b + c

这是一个非常基本的想法。有很多陷阱。希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T05:54:11.490

将它们存储为用户定义的函数

关于他们的好文章在[这里](http://www.sqlteam.com/article/user-defined-functions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T17:42:44.593

如果反射可用，请阅读有关 Emit 和各种形式的 Load 的帮助，看看您是否可以解析用户的函数并以可以存储在数据库中的形式生成 .Net 可执行文件。

不过要非常小心安全性和注入。

抱歉，没有什么比为您指出一个可能有用的方向更有帮助了。

# c# - 为什么编译器不能为我推断类型？（又名 Smarter SmartEnumerable）

> ID：544249
> 
> 赞同：2
> 
> 时间：2009-02-13T00:43:20.847
> 
> 标签：c#, generics

我正在使用 Jon Skeet 非常聪明的[SmartEnumerable](http://msmvps.com/blogs/jon_skeet/archive/2007/07/27/smart-enumerations.aspx)。如果您还没有看过它，我建议您检查一下。

类定义：

```
public class SmartEnumerable<T> : IEnumerable<SmartEnumerable<T>.Entry> 
```

构造函数是：

```
public SmartEnumerable(IEnumerable<T> enumerable) 
```

你用它说：

```
new SmartEnumerable<Cat>(myCats);  // where myCats is IEnumerable<Cat> 
```

现在我真的很想让编译器推断我有一组猫并且能够说：

```
new SmartEnumerable(myCats); 
```

但是，这给了我一个编译器错误：

> 无法从用法中推断出方法“MiscUtil.Collections.SmartEnumerable.SmartEnumerable(System.Collections.Generic.IEnumerable)”的类型参数。尝试明确指定类型参数。

我不清楚这是为什么。有没有办法解决它。为什么它看不到我正在使用`IEnumerable<Cat>`并从中推断出来。我可以更改任何内容以使其识别我正在使用的类型吗？

我真的很想用某种方法来构造一个 SmartEnumerable 而不必指定类型 - 因为我主要将它用于 ASP.NET MVC 中的 UI，我并不总是拥有`includes`这些类型并依赖于`var`让我参考. 我最终不得不包含类型才能使用 SmartEnumerable - 这降低了它的优雅性。

哦，我会直接给约翰发电子邮件，但无论如何他可能会在这里回复得更快:-)

* * *

`<font color=white>skeet skeet skeet, jon, jon, jon, jon skeet, skeet jon, skeetster, skeetmeister</font>`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-13T00:47:41.663

试试这个代码

```
public static class SmartEnumerable {
  public static SmartEnumerable<T> Create<T>(IEnumerable<T> source) {
    return new SmartEnumerable<T>(source);
  }
}

void Example() {
  IEnumerable<string> myCats = GetMyCats();
  var se = SmartEnumerable.Create(myCats);
} 
```

您的代码失败，因为 C# 无法推断构造函数的泛型参数。但是 C# 不仅能够推断出其他方法的泛型参数。

在 C# 中，拥有一个名称仅因泛型参数不同的类是完全合法的。例如 Foo 和 Foo<T> （实际上它们是不同的名称）。因此，上述示例适用于大多数情况。每当我定义一个泛型类时，我个人都会使用它，其中构造函数采用足够的参数来推断完整类型。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-13T00:55:50.723

我同意 JaredPar。我想指出你也可以做一个扩展方法：

```
public static SmartEnumerable<T> AsSmart<T>(this IEnumerable<T> source)
{
    return new SmartEnumerable<T>(source);
} 
```

你会像这样使用它：

```
var smartEnumerable = myCats.AsSmart(); 
```

（这个例子听起来很有趣）

**编辑**：

根据 Jon Skeet，我重命名`ToSmart`为`AsSmart`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T21:19:08.187

快速更新 - 现在在 MiscUtil 本身中可用。根据[使用页面](http://www.yoda.arachsys.com/csharp/miscutil/usage/smartenumerable.html)上的示例：

```
// Old way
foreach (SmartEnumerable<string>.Entry entry in
                 new SmartEnumerable<string>(list))

// Better way
foreach (SmartEnumerable<string>.Entry entry in
                SmartEnumerable.Create(list))

// Best way (C# 3.0)
foreach (var entry in list.AsSmartEnumerable()) 
```

# tfs - TFS: How can you Undo Checkout of Unmodified files in a batch file

> ID：544253
> 
> 赞同：178
> 
> 时间：2009-02-13T00:44:50.937
> 
> 标签：tfs, version-control, tfvc

We use a batch file to generate code, and it automatically checks out the generated files from Team Foundation Server (TFS) so that it can regenerate them. The majority of these files are not modified, but the generator does not know this ahead of time.

The "tfs undo" command undoes the checkout, but prompts if some have been modified (which we don't want to do). We also do not want to check in the generated files right away.

Is there a command (or series of commands) to undo checkout of all unmodified files without prompting the user?

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2009-02-13T00:59:18.283

Take a look on Undo Unchanged command of the [Team Foundation Server Power Tools August 2011](http://visualstudiogallery.msdn.microsoft.com/c255a1e4-04ba-4f68-8f4e-cd473d6b971f)

```
c:\myProject> tfpt uu . /noget /recursive 
```

*Thanks Matt Florence for link update.*

*Thanks Ray Vega for [actual syntax](https://stackoverflow.com/a/2924905/38975).*

* * *

## 回答 #2

> 赞同：127
> 
> 时间：2010-05-27T21:03:08.950

Install [Team Foundation Server Power Tools](http://msdn.microsoft.com/en-us/vstudio/bb980963.aspx) and run the following from the command line using tfpt.exe at the root of your project's workspace directory:

`c:\myProject> tfpt uu . /noget /recursive`

Including `/noget` is highly recommended since it prevents a forced 'get latest' of all your project's files which depending on the total number can take a extremely long time.

* * *

## 回答 #3

> 赞同：122
> 
> 时间：2012-09-06T06:42:42.813

Thank you @mike & @ray,

I wish to make it easier.

In VS, at Tools menu, click on "External Tools".

![External Tools](https://i.stack.imgur.com/UVJVF.jpg)

Click Add.

Enter title.

Command: tfpt.exe

Arguments: uu . /noget /recursive

Initial Directory: [you can choose from the arrow button].

![Undo unchanged in solution](https://i.stack.imgur.com/okGud.jpg)

![Undo unchanged in project](https://i.stack.imgur.com/HjZXJ.jpg)

Two new command are added to Tools menu.

Use them when needed.

Enjoy,

Ofir

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2015-07-31T08:10:13.293

1.  Right-click on your project
2.  Select undo checkout, then just click okay, or whatever confirmation is left...
3.  Then, while undoing checkout, for every file that has REAL changes in it, a prompt will ask you to confirm the check out for that file... simply click "No to All"

Visual studio will know if the checked out file has changes or none.

**WARNING:** This method also removes *new* files, i.e. files that are not yet checked in to TFS. If you want to keep these files then simply exclude them from the set of files you "undo".

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2018-10-16T15:36:30.833

Updated this question with an answer when working with **TFS2017** and **VS2017**/**VS2019** only.

The power tools does not exist for TFS 2017 and the old ones can't work well together with it, but apparently most of the functionality has been moved to VS2017 itself or plugins (see below).

## Visual Studio 2017/2019 Extension

Some actions like undo unchanged files have moved to an

[extension for VS2017](https://marketplace.visualstudio.com/items?itemName=HolanJan.TFSSourceControlExplorerExtension-18397)

[extension for VS2019](https://marketplace.visualstudio.com/items?itemName=HolanJan.TFSSourceControlExplorerExtension-2019)

"Undo Unchanged" button location:

![undo unchanged button location](https://i.stack.imgur.com/wqYDr.png)

# Known bug

You have to open the 'Source Control Explorer' (and leave it open) so that the 'Undo Unchanged' is displayed in the Action menu of the Pending Changes view. [reported here](https://marketplace.visualstudio.com/items?itemName=HolanJan.TFSSourceControlExplorerExtension-18397#qna).

## Windows Shell Integration Extension

Also, you can still set up Windows shell integration through an [separate installer](https://marketplace.visualstudio.com/items?itemName=ms-vscs-vcw.TfsShellExtention) which is no longer linked to TFS Power Tools.

The windows shell integration do not work exactly the same as the powertools before, but the most important actions worked for me.

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-13T13:33:11.950

If you simply check all the files back in again that you checked out, TFS is smart enough to figure out which ones changes and only include them in the changeset that is recorded on the server.

TFS does this by comparing MD5 hashes of the files contents before and after check-in.

This is all assuming that your generation process is purely updating the same set of files, i.e. you will never have the case where a file that was generated in a previous generation is not needed in the next generation (i.e. you would want to pend a delete for that file) or that the files change name.

If your process could potentially need files deleting, the your best bet might be to look at the [Team Foundation Power Tools](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx) command ([tfpt](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx)) and use the tfpt online command that will only check out the files that have changed, and will be smart enough to pend deletes for any files that are no longer needed or changed name and pend adds.

Good luck,

Martin.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-01-04T22:51:42.927

Beware that TFS undo will not revert back the File System's "Date Modified" value. This is very frustrating especially if you use tools like robocopy to sync up remote machines. Even after you undo your check out, if you saved the file thereby updaing the "Date Modified" value, that updated value will stick around even after an undo checkout.

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-12-11T07:47:32.080

There are a couple of points regarding the uu option for tfpt (recommended in most of the other answers) that were not clear to me at first. Firstly, this is the command line help that can be accessed with the command `tfpt uu /?`

> Undoes redundant pending changes. If the state of an item with a pending change is the same as on the server, then the change is undone.
> 
> Usage: tfpt uu [/changeset:changesetnum] [/recursive] [/noget] [filespec...]
> 
> *   /changeset Compare the workspace to item states at the changeset version specified instead of the latest version
> *   filespec... Only check the listed filespecs for redundant changes
> *   /recursive Check the specified filespecs with full recursion
> *   /noget Do not run get before checking
> 
> The /changeset option may not be used with filespecs or /recursive.

Now let me break down the command that is recommended in the other answers.

```
tfpt uu . /noget /recursive 
```

*   `tfpt uu` specifies that we wish to use the 'Undo Unchanged' command.
*   `.` indicates (I guess) that the current working directory should be used as the filespec.
*   `/noget` ensures that 'get latest version' is not called before undoing the unchanged files.
*   `/recursive` ensures that not just the filespec will be considered but all recursive child folders and files. This seems to be dependent on the filespec - if there is none provided then the whole workspace is processed.

So there are a couple of things to note here regarding the command from above...

*   It is dependent on the working directory.
*   It does not process the entire workspace.

I have found that the following command works best for me - it will process the entire workspace.

`tfpt uu /noget`

Note that it is still dependent on the working directory in that tfpt uses it to determine which workspace should be processed. But as long as you provide a path to a file or folder within the workspace, you are good to go.

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-03-04T01:21:01.653

I can see Ray LionFang's approach above. Can't comment there since I don't have the rep. While I like this approach since there's no changes required to Tools etc........

> 1.  Right-click on your project
> 2.  select undo checkout, then just click okay, or whatever confirmation is left...
> 3.  then, while undoing checkout, for every file that has REAL changes in it, a prompt will ask you to confirm the check out for that file... simply click "No to All"
> 4.  Visual studio will know if the checked out file has changes or none. Be aware that this method also removes added files that are not yet checked in from TFS...

.......there's a problem with that approach in that hitting "No To All" retains a few files which are not modified. It seems to do something like Undoing unmodified files until it hits the first file that's actually modified and then ignores the rest of the unmodified files, if that makes any sense. I've only seen this effect once in a while.

A potential work-around is to follow the above process but instead of hitting "No To All", hit "No" for each file. Since this can take a while depending on the number of files you're working with, what I normally do is to hold down "ALT + N", and it just speeds through all the files while undoing ALL unmodified files.

* * *

## 回答 #10

> 赞同：-21
> 
> 时间：2009-02-13T00:48:52.550

As far as I understood, in TFS if you checkout a team project, the whole project is checked out and you do not have control of which files are brought down. If you want to prevent checkins to certain files, you can lock them.

At work, we all hate TFS.

# xcode - 使用 Xcode 链接到 Boost.Signals

> ID：544260
> 
> 赞同：1
> 
> 时间：2009-02-13T00:50:07.743
> 
> 标签：xcode, boost, linker

我一辈子都无法让 Xcode 正确链接到 Boost.Signals。我已经使用 MacPorts 构建了 Boost，我什至自己下载了 Boost 并手动构建它。

我已将库搜索路径设置为包含 /opt/local/lib，并且已将“-lboost_signals-mt”添加到其他链接器标志。我尝试将库拖放到 Frameworks 文件夹中。我已经尝试将库添加到构建目标。

我总是收到“文件不是必需的架构”的错误。

为了确保问题出在 Xcode 上，我继续编写了一个 makefile 来构建项目——它工作正常，使用上面显示的相同链接器标志。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T00:55:27.497

检查 Xcode 项目中的目标架构。看起来您正在尝试编译通用二进制文件。除非您明确要求，否则将为构建机器的体系结构构建 boost。

# fonts - sIFR custom font method doesn't appear to work in linux?

> ID：544265
> 
> 赞同：0
> 
> 时间：2009-02-13T00:51:46.803
> 
> 标签：fonts

In response to a question about custom fonts, I came across a link to a method using javascript/flash/css which is accessible. However, in my browser (Firefox 3/flash 10/Debian) it doesn't work. The website advertises that it works in Linux. Do any other Linux users have this issue? Here's the link:

[http://www.mikeindustries.com/blog/files/sifr/2.0/](http://www.mikeindustries.com/blog/files/sifr/2.0/)

Here's what I see: [image](http://img21.imageshack.us/img21/4691/screenshot2ns6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T01:01:10.353

Actually... the demo doesn't work with Flash 10, no matter for the OS. sIFR 3 fixes that. (or 2.0.7, which the demo doesn't use).

More information at: [http://novemberborn.net/sifr/2.0.7](http://novemberborn.net/sifr/2.0.7)

# .htaccess - Apache mod 重写给出 404 错误

> ID：544276
> 
> 赞同：1
> 
> 时间：2009-02-13T00:55:57.743
> 
> 标签：.htaccess, mod-rewrite

我正在尝试设置一个简单的重写规则来转换一个 url，例如：

```
 index.php?page=login 
```

类似于

```
 page/login 
```

但是，我不断收到 404 错误。

任何人都可以建议为什么以下可能不起作用？

.ht 访问：

```
RewriteEngine on

RewriteRule ^page/([^/\.]+)/?$ index.php?page=$1 [L]

rewriteEngine off 
```

我对此很陌生，任何建议将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T01:05:54.413

我想你可能有它bacwards。你想让用户输入这个吗？

```
http://site.com/page/login 
```

?

这是更合乎逻辑的情况。如果是这样，请执行以下操作：

```
RewriteEngine On
RewriteBase /
RewriteRule ^/page/login$ /index.php?page=login [L] 
```

或者，更一般地说：

```
RewriteRule ^/page/(\w+)$ /index.php?page=$1 [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T01:04:01.470

确保使用 RewriteBase。

这些是我通常使用的规则。他们说任何不是文件或目录的请求，都由 index.php 脚本处理，请求的 URI 可以通过`$_SERVER['REQUEST_URI']`.

```
RewriteEngine On
RewriteBase /some_dir/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /some_dir/index.php [L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T01:08:23.643

> ```
> 重写引擎开启
> 
> RewriteRule ^page/([^/.]+)/?$ index.php?page=$1 [L]
> 
> 重写引擎关闭
> ```

为什么要关闭 RewriteEnginge？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T01:22:29.070

VolkerK 提出了一个很好的观点：不要同时使用`RewriteEngine on`and `RewriteEngine off`，因为您**没有**打开重写引擎、添加规则并再次将其关闭。Apache 配置不像编程那样工作，您有一组计算机按顺序执行的指令。你可以想象它更像这样：当 Apache 解析它的配置文件（如`.htaccess`）时，它首先读入所有指令并将它们排序成一个自然的顺序来应用它们。这更像是在程序开始时初始化变量的值，无论您以什么顺序编写语句，结果通常都是相同的。

在您的情况下，在同一个文件中同时指定`RewriteEngine on`和指定`RewriteEngine off`可能会使 Apache 感到困惑，因为（在我的小比喻中）当 Apache 将指令按“自然”顺序排序时，它会以类似的方式结束

```
RewriteEngine on
RewriteEngine off
RewriteRule ... 
```

这可能会关闭重写引擎。但是，当然，实际发生的事情比将指令排序到列表中要复杂得多，因此您无法真正判断 Apache 将如何处理像您这样的文件。只是不要尝试为文件的不同部分打开和关闭重写引擎，并记住 Apache 的配置指令不仅仅是按顺序运行的语句。

# sql - 编写按对象之间关联数排序的查询

> ID：544284
> 
> 赞同：0
> 
> 时间：2009-02-13T00:59:15.693
> 
> 标签：sql, mysql, database

是时候在我的类似博客的 Web 应用程序上实现排序了。除了按创建日期浏览之外，我还希望用户能够按回复数量进行排序。

鉴于我有两个表 blog_posts 和回复，并且回复有一个名为 blog_post_id 的字段（它是回复的 blog_post 的外键），我该如何编写这个查询？

“选择回复最多的 30 篇博文，按每篇博文的回复数降序排列。”

我也想分页。下个30个，下个30个，等等会不会很难？

我的感觉是，用 SQL 做这件事并不太难，我只是不知道怎么做（还在学习）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-13T01:05:54.523

这应该可以解决问题：

```
SELECT blog_posts.*, count(replies.blog_post_id) as blog_replies 
FROM blog_posts 
LEFT JOIN replies ON replies.blog_post_id = blog_posts.id 
GROUP BY blog_posts.id 
ORDER BY blog_replies DESC 
```

您可以在最后添加 LIMIT 和 OFFSET 子句以使分页正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T01:03:30.957

我在本地没有可以搞乱的 MySQL 副本，但是您可以执行以下操作：

```
SELECT
blog_post.id,
[other relevant fields from blog_post],
(SELECT COUNT(*) FROM replies WHERE blog_post_id = blog_post.id) 'replies'
FROM
blog_post
ORDER BY FIELD('replies') 
```

不确定按字段排序是否适用于子查询，但值得一试。

祝你好运！

伊恩

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T01:07:44.377

就像是：

```
select
    replies = (select count(*) from replies where blog_post_id = b.id),
    id,
    ...
from blog_post b
order by 1 desc
limit 30; 
```

# javascript - 使用 Javascript 对文本文件中的行进行二进制搜索

> ID：544292
> 
> 赞同：1
> 
> 时间：2009-02-13T01:02:16.810
> 
> 标签：javascript, file-io, binary-search

有没有办法在 Javascript 中对文本文件中的特定键进行基于磁盘的二进制搜索？文本文件太大而无法加载到内存中，但按键值排序。特别是，我正在寻找一种在 Javascript中模仿 Perl 的[Search::Dict功能的方法。](http://perldoc.perl.org/Search/Dict.html)

例如，如果我有一个文件 foo.txt：

```
a 1
b 10
c 5
z 4 
```

`look(c,foo.txt)``c 5`应该通过执行二进制搜索而不是线性遍历文件来返回行' '。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T01:08:07.107

并非如此，只有当您可以识别记录开始时，二进制搜索才真正可行。你似乎有可变长度的记录，所以除非你创建一个行起始偏移量数组，否则它不会工作。

正如 Nikhil 在评论中正确指出的那样，一种方法是根据文件大小对文件进行二进制分割，然后从那里找到最近的行。这仍然是相对有效的（即，比顺序搜索要好得多）**。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T01:26:40.447

我不知道 Javascript，但是如果你可以进行随机搜索，你可以通过搜索到当前块的中点（以字节为单位）进行二进制搜索，然后继续前进，直到你消耗了一个换行符，只要您“知道”您的密钥针对换行符。

但是，在某些情况下您需要向后行进，因此您可能会在了解文件缓冲的情况下进行搜索，这样后退步骤不会很昂贵。

如果您不处理 ASCII 文件，我想这可能会有点麻烦。

# windows - 作为一名程序员，在迁移到 64 位 Windows 时我需要担心什么？

> ID：544296
> 
> 赞同：32
> 
> 时间：2009-02-13T01:03:43.903
> 
> 标签：windows, 32bit-64bit

我最近的大部分编程都是在使用 C/C++/C#/VB6 的 32 位 Windows 上进行的。最近，我的客户询问我的代码是否可以在 64 位 Windows 上运行。

我想知道我可能使用的哪些遗留功能会在 64 位 Windows 上中断？我需要考虑和担心哪些现实问题？

显然，我将在 64 位操作系统上测试我的代码，但我想知道要查找哪些常见问题。我更关心现有的二进制文件，但我愿意就重新编译时（在可能的情况下）时要担心的问题发表评论。

编辑：这是一个[很好](http://software.intel.com/en-us/articles/collection-of-examples-of-64-bit-errors-in-real-programs/)的 64 位移植错误列表。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-13T07:50:59.400

就我而言，将 C/C++ 代码移植到 64 位 Windows 的最重要的事情是在**启用分配（****注册表值）的情况下****测试您的应用程序，`MEM_TOP_DOWN``AllocationPreference`**如[4-Gigabyte Tuning](http://msdn.microsoft.com/en-us/library/bb613473(VS.85).aspx)中所述：

> 要强制分配在较低地址之前从较高地址分配以进行测试，请`MEM_TOP_DOWN`在调用时指定`VirtualAlloc`或将以下注册表值设置为 0x100000：
> 
> `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\Memory Management\AllocationPreference`

这什么时候有关系？

*   [`/LARGEADDRESSAWARE`](http://msdn.microsoft.com/en-us/library/wz223b1z.aspx)如果您有使用MSVC 链接器选项构建的现有 32 位 EXE （或`IMAGE_FILE_LARGE_ADDRESS_AWARE`通过其他方式在其 PE 标头中设置标志，例如`editbin.exe`），那么它们将获得完整的 4 GB 64 位虚拟地址空间Windows，您必须使用`AllocationPreference`注册表值集对其进行测试。
*   如果您有现有的 32 位 DLL 可能由大地址感知 EXE 加载，则必须使用`AllocationPreference`注册表值集对其进行测试。
*   如果将 C/C++ 代码重新编译为 64 位 EXE 或 DLL，则必须使用`AllocationPreference`注册表值集对其进行测试。

如果您的 C/C++ 应用程序属于这三个类别之一并且您不使用`MEM_TOP_DOWN`分配进行测试，则测试不太可能在您的代码中捕获任何指针截断/签名错误。

第二个最重要的事情是，如果您使用 MSVC 并且正在为 64 位重新编译 C/C++ 代码，则为您的***64 位*****构建****使用`/Wp64`编译器选项***：*

 **   这将导致编译器对截断指针或将较小的整数类型扩展为指针的类型转换发出警告（即使`reinterpret_cast`使用 C 样式转换），以及其他一些 64 位移植问题。
*   是的，[文档](http://msdn.microsoft.com/en-us/library/yt4xw8fh.aspx)说与其一起`/Wp64`编译，不如使用针对 64 位平台的编译器，但仅此一项就不会在编译时捕获指针截断/扩展问题。使用面向 64 位的编译器**并**`/Wp64`为 64 位构建启用编译器选项将在编译时捕获许多指针截断/扩展问题，从长远来看，这将节省您的时间。
*   不幸的是，对于 MSVC 2008，这也会为每个翻译单元生成一个“命令行警告”，说明该`/Wp64`选项已被弃用。我可以看到为什么该选项在 32 位构建中被弃用（它是一个邪恶的 hack，需要注释您的许多 typedef），但不幸的是，它也被 64 位构建弃用（它实际上很有用）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-14T17:59:34.343

文章：

[64位平台移植C++代码的20个问题](https://www.viva64.com/en/a/0004/)

[64位程序开发中被遗忘的问题](https://www.viva64.com/en/a/0010/)

[64 位、Wp64、Visual Studio 2008、Viva64 和所有其他...](https://www.viva64.com/en/a/0021/)

[将 C 和 C++ 代码迁移到 64 位 Windows 期间的陷阱检测](https://www.viva64.com/en/a/0012/)

[AMD64 (EM64T) 架构](https://www.viva64.com/en/a/0029/)

和

Viva64 工具 - 用于检查 64 位程序：

[Viva64：它是什么，它对谁意味着什么？](https://www.viva64.com/en/a/0009/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-13T01:14:11.927

如果您拥有 100% 的“类型安全托管代码”，则迁移 .NET 代码可能会更容易。直接复制到64位平台，在64位CLR下运行成功即可。检查此[MSDN 链接](http://msdn.microsoft.com/en-us/library/ms973190.aspx)，了解将 32 位托管代码迁移到 64 位。

顺便说一句，hanselman最近[在博客](http://www.hanselman.com/blog/BackToBasics32bitAnd64bitConfusionAroundX86AndX64AndTheNETFrameworkAndCLR.aspx)上讨论了这个话题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-13T01:16:44.370

如果您谈论的是 32 位程序，那么您几乎无需担心，因为 Windows 64 将在仿真下将它们作为 32 位运行。未来 Windows 版本（例如 Windows 7）的任何问题都可能是不兼容问题，而不是 64 位操作系统的问题。

但是，如果您的托管代码是为“任何 CPU”目标平台编译的，并且您调用非托管代码（例如 PInvoke），或者依赖于其他程序集，那么需要注意一些事项。Scott Hanselman 关于 x86/x64 CLR 的[帖子](http://www.hanselman.com/blog/default.aspx#a4099df2d-ef01-4f70-a7f7-829eabc36afc)涵盖了这一点，并且很好地解释了 Win32/64 上的 CLR。

在开发 64 位本机程序时[，64 位 Windows 编程指南](http://msdn.microsoft.com/en-us/library/bb427430(VS.85).aspx)是一个很好的指南。它主要归结为指针和数据类型的大小:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-13T01:52:28.747

32 位程序可以在 64 位窗口上正常运行。当然，只要您不进行任何设备驱动程序类型的开发。

如果您第一次将软件编译为 64 位软件，则需要注意以下事项：

*   指针是 64 位宽，而 int 是 32 位。不要将指针存储在整数中，您的代码会中断。
*   64 位进程需要 64 位 DLL。如果您依赖第三方 DLL，请确保它们也以 64 位提供。如果您需要在 32 位进程和 64 位进程之间进行通信，您将需要 Windows 上许多不同的 IPC 方式中的一些。直接调用函数是没有问题的。
*   64 位 Windows 上的系统目录与 32 位 Windows 上的不同。如果您有一些硬编码路径，您可能需要再次检查它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-14T18:16:41.290

如果您出于任何原因进行 DLL 注入，您将遇到麻烦。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-13T01:24:04.680

从 C/C++ 的角度来看......

一件显而易见的事情是 int 的大小将变为 8 个字节而不是 4 个字节。如果您的任何代码依赖于它，您可能会得到意想不到的结果。结构和变量对齐可能会发生变化。您可以使用#pragma pack 克服它，但我对对齐和打包不是很流利。

如果您使用其中包含整数的任何联合，则行为可能会改变。

如果您使用任何位域结构，基于整数的额外 32 位可能会导致混淆。符号位不会是您认为的位置。

如果您编写任何十六进制常量并期望符号变为负数，您可能会遇到问题。示例 0x8000000 是作为日志的负数，或 32 位整数。0x80000000 作为 64 位平台上的整数是一个正数。要直接设置符号位，您必须使用 0x80000000 00000000 （嵌入空间仅供阅读）

我也希望 size__t 能够适当增长。如果您基于 MAX_INT 进行任何分配，它们会更大。

为了避免这些类型的大小异常，我通常坚持使用 long 而不是 int。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-13T06:10:26.520

32 位仿真真的是防弹的吗？我已经看到注册表的布局略有不同。我只是想知道哪些典型的事情不起作用......

此外，C:\windows\SYSTEM32 目录只能包含 64 位 DLL。如果你有一个 32 位的 DLL，你需要把它放在 C:\windows\syswow64\

# c# - 在 C# 中更改元素值的最佳方法

> ID：544310
> 
> 赞同：16
> 
> 时间：2009-02-13T01:06:29.920
> 
> 标签：c#, .net, xml

我正在尝试寻找更改 XML 中元素值的最佳方法。

```
<MyXmlType>
   <MyXmlElement>Value</MyXmlElement>
</MyXmlType> 
```

在 C# 中更改“值”的最简单和/或最佳方法是什么？

我查看了 XMLDocument，它会导致整个 XML 文档加载到内存中。你能用 XMLReader 安全地做到这一点吗？问题是改变价值并将其发回似乎是一个有趣的难题。

干杯：D

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-13T01:32:44.160

您可以使用 System.Xml.Linq 命名空间的东西来获得最容易阅读的代码。这会将整个文件加载到内存中。

```
XDocument xdoc = XDocument.Load("file.xml");
var element = xdoc.Elements("MyXmlElement").Single();
element.Value = "foo";
xdoc.Save("file.xml"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-13T01:13:27.560

编辑：没有看到你关于 XmlDocument 的条款。XmlReader 就是这样做的。您不能使用此类编辑 xml 文件。

你想要 XmlWriter。但是，如果它仍然有用，这里是 XmlDocument 的代码。

```
private void changeXMLVal(string element, string value)
{
    try
    {
        string fileLoc = "PATH_TO_XML_FILE";
        XmlDocument doc = new XmlDocument();
        doc.Load(fileLoc);
        XmlNode node = doc.SelectSingleNode("/MyXmlType/" + element);
        if (node != null)
        {
            node.InnerText = value;
        }
        else
        {
            XmlNode root = doc.DocumentElement;
            XmlElement elem;
            elem = doc.CreateElement(element);
            elem.InnerText = value;
            root.AppendChild(elem);
        }
        doc.Save(fileLoc);
        doc = null;
    }
    catch (Exception)
    {
        /*
         * Possible Exceptions:
         *  System.ArgumentException
         *  System.ArgumentNullException
         *  System.InvalidOperationException
         *  System.IO.DirectoryNotFoundException
         *  System.IO.FileNotFoundException
         *  System.IO.IOException
         *  System.IO.PathTooLongException
         *  System.NotSupportedException
         *  System.Security.SecurityException
         *  System.UnauthorizedAccessException
         *  System.UriFormatException
         *  System.Xml.XmlException
         *  System.Xml.XPath.XPathException
        */
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T01:09:48.210

您可以使用 XmlReader 读入一个类，该类通过 XmlWriter 将数据泵回并扫描读/写之间的元素，并根据需要更改值。

老实说，我有点惊讶您的 XML 文件如此庞大，以至于您担心内存消耗……并不是说这从来都不是问题。如果没有更多信息，我不能说您假设的 XML 文件不是 50gb，但在许多情况下，将看起来很大的文件加载到内存中足够长的时间以进行操作并不像您想象的那么重要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-13T01:41:16.247

您是否考虑过使用 Linq to XML？（如果您使用的是 .Net 3.0+）

```
public static XElement ChangeValue(string xmlSnippet, 
    string nodeName,
    string newValue)
{
    XElement snippet = XElement.Parse(xmlSnippet);
    if (snippet != null)
    {
        snippet.Element(nodeName).Value = newValue;
    }
    return snippet;
} 
```

我猜 XElement 会比 XmlDocument 执行得更好（虽然不确定），XElement 的基础对象是 XObject，是的，它必须加载整个文档。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-13T02:37:58.967

使用只进阅读器肯定是最有效的方法，在这种情况下 XmlReader 派生似乎是合适的，可以肯定的是，尽管它仍然比使用一次加载整个文件的 DOM 方法工作更多。

XmlReader 据说是对起源于 Java 世界的 SAX XML 解析器 API 的改进，但它已成为业界（Microsoft 之外）事实上的标准。

如果您只想快速完成工作，那么 XmlTextReader 就是为此目的而存在的（在 .NET 中）。

如果您想学习一个稳定的事实上的标准（并且在许多编程语言中也可用），它会迫使您非常高效和优雅地编写代码，但它也非常灵活，那么请研究 SAX。 *但是，除非您要创建高度深奥的 XML 解析器，否则不要打扰 SAX 本身。有很多解析器在后台使用 SAX。*

**请**在此处查看我对 SAX 的回复，以获取 SAX 资源列表和使用 XmlTextReader 作为其基础的真正有创意的**.NET XML 解析器想法**： [SAX 与 XmlTextReader - C# 中的 SAX](https://stackoverflow.com/questions/127869/sax-vs-xmltextreader-sax-in-c/546355#546355)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-20T11:46:41.193

这使用一个旧文件并创建一个具有更新值的新文件。如果找不到元素会抛出异常

```
{
    XDocument newSettingFile =  new XDocument(settingFile);
    //Root element
    var newSetting = newSettingFile.Element("MyXmlType");
    //Update childelement with new value
    newSetting.Element("MyXmlElement").Value = "NewValue";   
    return newSettingFile;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-10-06T20:07:22.303

```
using System;
using System.Xml;
using System.Linq;
using System.Xml.Linq;

namespace ReandAndWriteXML
{
    class MainClass
    {
        public static void Main (string[] args)
        {
            XDocument xdoc = XDocument.Load(@"file.xml");
            var element = xdoc.Root.Elements("MyXmlElement").Single();
            element.Value = "This wasn't nearly as hard as the internet tried to make it!";
            xdoc.Save(@"file.xml");
        }
    }
} 
```

这很像 Ben Robin 的示例，除了它有效（尽管他的示例也有效，现在它已被编辑）。我什至给了你 using 指令！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-08-15T17:29:08.847

我对一个 10.6 K 的文档进行了一些测试。解析 XmlDocument 总是比 Linq 查询快 50%。

```
 var stopwatch2 = Stopwatch.StartNew();
        XmlDocument xd = new XmlDocument();
        xd.LoadXml(instanceXML);
        XmlNode node = xd.SelectSingleNode("//figures/figure[@id='" + stepId + "']/properties/property[@name='" + fieldData + "']");
            node.InnerXml = "<![CDATA[ " + valData + " ]]>";  
        stopwatch2.Stop();
        var xmlDocTicks = stopwatch2.ElapsedTicks;

        Stopwatch stopwatch1 = Stopwatch.StartNew(); 
        XDocument doc = XDocument.Parse(instanceXML);
        XElement prop =
        (from el in doc.Descendants("figure")
         where (string)el.Attribute("id") == stepId
            select el).FirstOrDefault();
        prop.Value = valData;
        stopwatch1.Stop();
        var linqTicks = stopwatch1.ElapsedTicks; 
```

结果如下（xmlDocTicks,linqTicks）：

*   运行1：（1258,1581）
*   运行2：（2667,3463）
*   运行3：（1416,2626）
*   运行4：（1231,2383）
*   平均：（1643,2513）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-04T14:47:40.440

加载和保存

```
public XDocument XDocument { get; set; }
    private async Task OpenResWFileAsync()
    {
        List<XElement> dataElements;
        var reswFile = await StorageHelper.PickSingleFileAsync(".resw");
        if (reswFile == null) return;
        using (Stream fileStream = await reswFile.OpenStreamForReadAsync())
        {
            this.XDocument = XDocument.Load(fileStream);
            dataElements = this.XDocument.Root.Elements("data").ToList();
            this.DataElements = dataElements;
        }
    }
    #region
    private List<string> GetValues()
    {
        if (this.XDocument == null) return new List<string>();
        return this.XDocument.Root.Elements("data").Select(e => e.Attribute("name").Value).ToList();

    }
    public void ChangeValue(string resourceKey, string newValue)
    {
        if (this.DataElements == null) return;
        var element = this.DataElements.Where(e => e.Name == resourceKey).Single();
        element.Value = newValue;
    }
    #endregion 
```

# cocoa - 将 NSString 转换为其在 Cocoa 中的等值货币的最简单方法

> ID：544314
> 
> 赞同：12
> 
> 时间：2009-02-13T01:08:19.460
> 
> 标签：cocoa

我的 NSString 值为@“78000”。我如何以货币格式获得它，即 78,000 美元，而它仍然是一个 NSString。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-13T01:30:20.033

您需要使用数字格式化程序。请注意，这也是您为用户区域设置以正确格式显示日期/时间等的方式

```
// alloc formatter
NSNumberFormatter *currencyStyle = [[NSNumberFormatter alloc] init];

// set options.
[currencyStyle setFormatterBehavior:NSNumberFormatterBehavior10_4];
[currencyStyle setNumberStyle:NSNumberFormatterCurrencyStyle];

NSNumber *amount = [NSNumber numberWithInteger:78000];

// get formatted string
NSString* formatted = [currencyStyle stringFromNumber:amount]

[currencyStyle release]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-29T13:04:40.170

最后的小数/分可以控制如下：

```
[currencyStyle setMaximumFractionDigits:0]; 
```

[这是来自苹果](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNumberFormatter_Class/Reference/Reference.html%23//apple_ref/occ/instm/NSNumberFormatter/setMaximumFractionDigits%3a)的文档链接

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-08-05T18:29:40.013

上面的答案将转换一个数字，但这是一种将 NSString 实际转换为货币格式的方法

```
- (NSString*) formatCurrencyWithString: (NSString *) string
{
    // alloc formatter
    NSNumberFormatter *currencyStyle = [[NSNumberFormatter alloc] init];

    // set options.
    [currencyStyle setFormatterBehavior:NSNumberFormatterBehavior10_4];

    // reset style to no style for converting string to number.
    [currencyStyle setNumberStyle:NSNumberFormatterNoStyle];

    //create number from string
    NSNumber * balance = [currencyStyle numberFromString:string];

    //now set to currency format
    [currencyStyle setNumberStyle:NSNumberFormatterCurrencyStyle];

    // get formatted string
    NSString* formatted = [currencyStyle stringFromNumber:balance];

    //release
    [currencyStyle release];

    //return formatted string
    return formatted;
} 
```

# cocoa-touch - 在分组的 UITableView 中设置 UITableViewCell 的 backgroundColor

> ID：544321
> 
> 赞同：5
> 
> 时间：2009-02-13T01:11:00.453
> 
> 标签：cocoa-touch

是否可以在分组的 UITableView 中设置 UITableViewCell 的 backgroundColor 并保持单元格的圆角？

我所有的尝试都导致圆角丢失。

麦克风

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-13T03:31:16.093

几周前我问了同样的问题，你可以在这里看到有效的答案：

[如何自定义分组表格视图单元格的背景/边框颜色？](https://stackoverflow.com/questions/400965/how-to-customize-the-background-border-colors-of-a-grouped-table-view)

这确实是可能的，并且提供的源代码效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T01:20:35.937

抱歉不行。我相信圆角是背景，单元格的边缘是透明的。当您尝试使用自定义颜色（或图像）时，它会覆盖它们。

# fonts - 如何在 *NIX 的 gvim 中使用绿色字体？

> ID：544324
> 
> 赞同：0
> 
> 时间：2009-02-13T01:12:28.453
> 
> 标签：fonts, vim

我注意到我不能通过 vimrc 中的命令影响 MacVim 的颜色方案。我现在有一个黑色背景上的灰色字体，这使得阅读变得困难。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T01:15:53.657

这很奇怪。尝试后得到什么`":hi Normal guifg=Yellow"`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T01:23:33.670

我通常将所有与 gvim 相关的命令放在 .gvimrc 中。如果您使用 vi/vim，那么终端颜色方案会与 vim 颜色方案混淆。如果 MacVim 有一个单独的 .rc 文件，你可以检查一下（假设 MacVim 弹出一个新窗口）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T01:48:58.180

您可能想[在 Google Code 上查看 gvim 的 Mac 端口](http://code.google.com/p/macvim/)。它存在于自己的窗口中，而不是终端窗口中，并且似乎提供了更多（或更简单）的外观定制。

# sql - T-SQL 模式匹配

> ID：544329
> 
> 赞同：0
> 
> 时间：2009-02-13T01:14:00.650
> 
> 标签：sql, tsql, pattern-matching, sql-like

我试图找到一种方法来通过使用另一个表中的“多值”管道分隔列作为 WHERE 子句来查询数据行。SQL 服务器 2005

这是我对问题的最佳描述：

想象一个用管道分隔的列设置为像 @LIST = 'Bob|Mary|Joe' 这样的变量

然后我试图找到这样的匹配

```
Select * from Users where FirstName = 'Joe' 
```

但扩展为

```
Select * from Users where FirstName "IS CONTAINED IN" @List 
```

这将返回所有 Bob、Mary 和 Joe 条目。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T01:54:40.927

怎么样

```
Select * from Users where CHARINDEX(FirstName + '|', @List + '|') > 0 
```

有点烦人，您必须将管道分隔符附加到两个字符串，但它可以工作，而且它可能比函数更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T01:46:16.080

您可以使用拆分 udf 并将其加入主查询。请参阅此[链接](http://www.sqlmag.com/Article/ArticleID/21071/sql_server_21071.html)以获取代码和示例。您的查询最终看起来像这样。这是未经测试的，但希望这能为您指明正确的方向。

```
Select A.* from Users A JOIN dbo.Fn_Split(@ValueArrayString, '|') B on A.FirstName = B.value 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-25T23:56:38.563

我喜欢 MrTelly 的解决方案。但是，它只处理了一半的误报。完整的解决方案如下：

```
Select * from Users where CHARINDEX('|' + FirstName + '|', '|' + @List + '|') > 0 
```

需要在两端添加管道

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T01:31:44.537

查看 PATINDEX() 函数。它有点有限，但它应该可以满足您的需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T01:49:44.637

[参见](http://www.novicksoftware.com/UDFofWeek/Vol1/T-SQL-UDF-Volume-1-Number-29-udf_Txt_SplitTAB.htm)Andrew Novick 的udf___Txt_SplitTab

```
Select * from Users where FirstName IN (Select Item From udf_Txt_SplitTAB (@LIST, '|')) 
```

# database-design - 管理数据库参考数据及其相关代码

> ID：544333
> 
> 赞同：3
> 
> 时间：2009-02-13T01:14:26.110
> 
> 标签：database-design, version-control, static-data

参考数据或查找表是诸如 CustomerType、ProductType 等。它们很少更改，偶尔会添加新类型或淘汰旧类型。在代码中，它们经常被复制为枚举/常量，也用于填充组合框。添加新类型不应破坏现有应用程序，并且通常只需要这些新类型来支持新应用程序的功能，旧应用程序应该忽略它。

这种情况在大多数开发商店中都很熟悉，几年/几个月后它变得混乱、不受控制，如果数据库和代码不同步，就会发生坏事。

其他人如何处理这个问题？代码/数据库是什么样的，它是如何进行版本控制的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T02:14:19.130

您的意思是，ID 和标签在代码中是硬编码的，*并且也*出现在数据库的查找表中？

我们采用的方法是从数据库中读取“类型”ID 和标签，并使用它们来填充列表框。

（幸运的是）我不必支持需要从同一个查找表中读取不同值集的应用程序的不同版本。

我听说有人将最低版本 ID 分配给查找表值。应用程序传入其版本（可能是 1.5），并检索所有版本为 1.5 或更低版本的查找值。为更高版本的应用程序（例如 2.1）添加的查找值将被忽略。

这显然会引入一些重要的维护开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-05T17:43:36.103

我们创建了一个自主开发的工具，它在构建期间运行在一个或多个文件中指定的查询，并生成枚举类型类，每个引用数据表一个。该工具至少只要求引用数据表具有两列：主键（具有唯一约束）和字符串。每个枚举实例都有一个从字符串生成的名称（通过算法将名称转换为大写，将空格和其他无效字符替换为下划线等）。

该工具足够灵活，可以在每个值上添加其他属性；例如，“显示名称”、“描述”、可能关联的数值和其他简单类型。我们还在枚举类上生成静态方法来获取值的各种子集；总是至少有一个返回所有值，但我们可以根据 SQL 查询生成其他值。例如，对于颜色枚举，我们可能有一个“primaryColors()”静态方法。生成额外的静态方法以根据其键查找值；例如，

```
public static Color valueOf(int key); 
```

枚举使在代码中使用众所周知的参考值变得更容易和更易读；例如，

```
if (selectedColor == Colors.RED) {
   .
   .
   .

} 
```

这确实有一个需要额外构建步骤的缺点，但在我们的案例中，这远远超过了优点：更简洁的代码、确保 UI、业务逻辑和数据库有效值同步等。

我们经常谈论将上述静态机制与添加更多动态行为相结合，但实际上我们从未真正感觉到它足以增加复杂性。

# xml - 如何将具有由 a 分隔的值的属性分解为单独的元素

> ID：544336
> 
> 赞同：3
> 
> 时间：2009-02-13T01:15:28.430
> 
> 标签：xml, xslt

我有一个属性，其值可能是一个或多个由逗号分隔的文本字符串。我希望使用 XSL 将属性值转换为它们自己的元素；

例如

```
<post title='Hello World" tags="Test,Hello,World /> 
```

我希望它转变为；

```
<post>
<title>Hello World</title>
<tag>Test</tag>
<tag>Hello</tag>
<tag>World</tag>
</post> 
```

这可能吗？TIA

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-13T04:43:44.623

有几种方法可以做到这一点。

**I. 在 XSLT 1.0 中使用递归调用的命名模板 这种转换**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="/*">
      <xsl:copy>
        <xsl:apply-templates select="node()|@*"/>
      </xsl:copy>
    </xsl:template>

    <xsl:template match="@*[not(name()='tags')]">
      <xsl:element name="{name()}">
        <xsl:value-of select="."/>
      </xsl:element>
    </xsl:template>

    <xsl:template match="@tags">
      <xsl:call-template name="tokenize">
        <xsl:with-param name="pText" 
         select="concat(., ',')"/>
      </xsl:call-template>
    </xsl:template>

    <xsl:template name="tokenize">
      <xsl:param name="pText"/>

      <xsl:if test="string-length($pText)">
        <tag>
          <xsl:value-of select=
           "substring-before($pText, ',')"/>
        </tag>

        <xsl:call-template name="tokenize">
          <xsl:with-param name="pText" select=
           "substring-after($pText, ',')"/>
        </xsl:call-template>
      </xsl:if>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于最初提供的 XML 文档时**（更正为格式正确）：

```
<post title="Hello World" 
      tags="Test,Hello,World" /> 
```

**产生所需的结果**：

```
<post>
   <title>Hello World</title>
   <tag>Test</tag>
   <tag>Hello</tag>
   <tag>World</tag>
</post> 
```

**二、使用[FXSL](http://fxsl.sf.net) 1.x中的`str-split-to-words`模板/函数**

**此处 FXSL 提供了标记化功能**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"
>

   <xsl:import href="strSplit-to-Words.xsl"/>

   <xsl:output indent="yes" omit-xml-declaration="yes"/>

    <xsl:template match="/*">
      <xsl:copy>
        <xsl:apply-templates select="node()|@*"/>
      </xsl:copy>
    </xsl:template>

    <xsl:template match="@*[not(name()='tags')]">
      <xsl:element name="{name()}">
        <xsl:value-of select="."/>
      </xsl:element>
    </xsl:template>

    <xsl:template match="@tags">
    <xsl:variable name="vwordNodes">
      <xsl:call-template name="str-split-to-words">
        <xsl:with-param name="pStr" select="."/>
        <xsl:with-param name="pDelimiters" 
                  select="','"/>
      </xsl:call-template>
    </xsl:variable>

    <xsl:apply-templates select="ext:node-set($vwordNodes)/*"/>
    </xsl:template>

  <xsl:template match="word">
    <tag>
      <xsl:value-of select="."/>
    </tag>
  </xsl:template>

</xsl:stylesheet> 
```

**当应用于与以前相同的 XML 文档时，会产生相同的正确输出**。

**三、[`tokenize()`](http://www.w3.org/TR/xpath-functions/#func-tokenize)使用XSLT 2.0 转换中的 XPath 2.0 标准函数**

这是最简单的方法——如果可以使用 XSLT 2.0 处理器。

**以下 XSLT 2.0 转换**：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    >
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="/*">
      <xsl:copy>
        <xsl:apply-templates select="node()|@*"/>
      </xsl:copy>
    </xsl:template>

    <xsl:template match="@*[not(name()='tags')]">
      <xsl:element name="{name()}">
        <xsl:value-of select="."/>
      </xsl:element>
    </xsl:template>

    <xsl:template match="@tags">
    <xsl:for-each select="tokenize(.,',')">
      <tag><xsl:value-of select="."/></tag>
    </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于同一个 XML 文档时，会再次产生想要的结果。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-07T16:19:03.553

我真的很喜欢 Dimitre 的回答，但他的 XSLT 1.0 解决方案有一个小错误。当我有 "Value,Value,Value" 时，它只会拆分前两个并跳过最后一个。

**编辑**这不是一个错误，我没有注意到他正在用 CONCAT 调用模板

这是我对他的 tokenize xslt 1 模板的修改。

```
<xsl:template name="tokenize">
  <xsl:param name="pText"/>
  <xsl:param name="pTag"/>
  <xsl:if test="string-length($pText)">
    <xsl:element name="{$pTag}">
             <xsl:choose>
                  <xsl:when test="string-length(substring-before($pText, ','))">
                      <xsl:value-of select="substring-before($pText, ',')"/>
                  </xsl:when>
                  <xsl:otherwise><xsl:value-of select="$pText" /></xsl:otherwise>
              </xsl:choose>
    </xsl:element>

    <xsl:call-template name="tokenize">
      <xsl:with-param name="pText" select=
       "substring-after($pText, ',')"/>
      <xsl:with-param name="pTag"><xsl:value-of select="$pTag" /></xsl:with-param>
    </xsl:call-template>
  </xsl:if> 
```

使用示例

```
<xsl:call-template name="tokenize">
        <xsl:with-param name="pText">123,234,345</xsl:with>
        <xsl:with-param name="pTag">tag</xsl:with-param >
</xsl:call-template> 
```

输出

```
 <tag>123</tag>
  <tag>234</tag>
  <tag>345</tag> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T20:38:02.537

您应该做的第一件事是找到在他应该使用元素的地方使用属性的人并让他停下来。我们接受 XML 冗长的原因是它给我们带来了不必弄清楚如何解析数据的好处。如果您要将 XML 与必须解析的数据打包在一起，为什么首先要使用 XML？

# java - 重新部署应用程序后杀死 Quartz 的线程

> ID：544341
> 
> 赞同：0
> 
> 时间：2009-02-13T01:16:26.867
> 
> 标签：java, multithreading, glassfish

在我的应用程序中，我使用石英来安排一些作业在 Glassfish 上的 Java 应用程序中运行。有时当我重新部署我的应用程序时，我忘记关闭我的调度程序，并且在部署新版本的应用程序后无法停止它们。所以，问题是如何在应用程序被取消部署后停止/杀死石英的线程。

这是我添加工作的代码：

```
 SchedulerFactory sf = new StdSchedulerFactory();
        Scheduler sched sched = sf.getScheduler();

        // 1: EMS2ELC JOB /////////////
        String EMS2ELCScheduleEx = "0 30 0 * * ?";
        job = new JobDetail("EMS2ELCJob", "WebServicesGroup", EMS2ELCJob.class);
        trigger = new CronTrigger("EMSTrigger", "WebServicesGroup", "EMS2ELCJob", "WebServicesGroup", EMS2ELCScheduleEx, TimeZone.getTimeZone("America/Los_Angeles"));
        sched.addJob(job, true);
        ft = sched.scheduleJob(trigger);
        log.info("SchedulerController: " + job.getFullName() + " has been scheduled to run at: " + ft + " and repeat based on expression: " + trigger.getCronExpression()); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T03:21:00.593

当您说重新部署时，它是热部署，即不终止glassfish服务器吗？您可以实现 ServletContextListener.contextDestroyed() 方法，并从中调用石英 API 提供的关闭挂钩。您需要在 web.xml 中注册您的侦听器

# arrays - VB 类型不匹配问题 - inArray()

> ID：544354
> 
> 赞同：1
> 
> 时间：2009-02-13T01:23:21.703
> 
> 标签：arrays, asp-classic, vbscript, function

我不是一个 VB 程序员，但这样的事情应该很简单......不过我真的很难过。

我有一个网络应用程序，它可以处理电子邮件和 PDF 文件。我正在向它添加一些新功能并且遇到了两个非常基本的“类型不匹配”错误并且无法解决它们。

第一次发生在我在一个简单的查找/替换脚本中调用 inArray() 时。我在数据库中创建了一个字段名称数组，并将电子邮件的内容与这些名称进行比较，以便可以将 $*%%P1FirstName 替换为数据库中的实际名字。很简单。

这个确切的代码在网站的其他地方工作，但在这个新页面上，我在包含 inArray() 调用的行上收到类型不匹配错误：

```
 strOut = ""
strIn = strEmail
arrString = split(strIn,"$*")
'make an array of all the fields in the recordset to compare the fields in the email against
strTmp = ""
for each f in rs2.fields
    strTmp = strTmp & f.name & "x%x"
next
arrFields = split(strTmp,"x%x")
for i = lbound(arrString) to ubound(arrString)
    'if the current word in the array is a DB field name (as indicated by the leading '%%' then get the data
    'from the recordset and drop it into the email, otherwise it is a generic term
    if left(arrString(i),2) = "%%" then
        arrString(i) = replace(arrString(i),"%%","")
        if not trim(arrString(i)) = "" then
            if inArray(arrFields, arrString(i)) then
                strOut = strOut & rs2(arrString(i))
            end if
        end if
    else
        strOut = strOut & arrString(i)
    end if
next
```

我不明白为什么不能比较两个字符串数组（或者为什么这个相同的调用在其他地方有效）。当我输出任何内容（如字段名称）并且过度使用 CStr() 无济于事时，似乎没有任何问题。

另一个只是一个函数调用：

WritePDF(iformID, TemplateFile, Appfile, 签名, rsProc("fontSize"),passwordProtect)

其中签名和密码保护是布尔值。它更复杂，因为错误没有具体告诉我哪个字段关闭。我刚刚尝试了一堆改写和 cbool() 并手动设置每个字段但没有得到任何结果。同样，相同的代码适用于站点中的所有其他页面。

我敢肯定这些问题有一个非常简单的答案，而且我还没有找到它，这让我发疯了。如果有什么你立即注意到我很想得到反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T09:34:07.257

vbscript 中没有称为 InArray() 的内置函数。你有包含的功能吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T01:37:22.573

这个***确切的代码***在其他地方有效吗？您确定以正确的顺序将参数传递给 inArray() 函数吗？字符串数组和以错误顺序传递的字符串会导致类型不匹配错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T22:14:56.380

像这样的东西怎么样：

```
strOut = ""
strIn = strEmail

strTmp = ""
For Each f In rs2.fields
    If Instr(strIn, "$*%%" & f.name) > 0 Then
        strIn = Replace(strIn, "$*%%" & f.name, rs2(f.Name).Value)
    End If
Next

strOut = strIn 
```

# nhibernate - 工作单元实施

> ID：544357
> 
> 赞同：3
> 
> 时间：2009-02-13T01:24:07.210
> 
> 标签：nhibernate, design-patterns, transactions, unit-of-work

可能我太n00b无法理解这一点，但我正在阅读Gabriel Schenker [http://nhibernate.info/doc/patternsandpractices/nhibernate-and-the-unit-of-work-pattern.html](http://nhibernate.info/doc/patternsandpractices/nhibernate-and-the-unit-of-work-pattern.html) UnitOfWork实现，我真的不能明白这点。

为什么 UnitOfWorkImplementor.Dispose 需要将 dispose 转发给 UnitOfWorkFactory 而这转发给 UnitOfWork？为什么 UnitOfWorkImplementor 不能自行处理？

周围还有其他 UnitOfWork 实现示例吗？（请一个更简单的）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T14:45:23.193

可能需要告知静态 UnitOfWork 当前 UoW 不再可用。

# zend-framework - Zend 框架过滤器输入 StripTags 和“<3”

> ID：544358
> 
> 赞同：4
> 
> 时间：2009-02-13T01:24:31.293
> 
> 标签：zend-framework, filtering

我目前在评论系统中使用 Zend_Filter_StripTags，但是当输入 '<3' 时东西有点中断。StripTags 似乎不够聪明，无法意识到它不是 HTML 标记，并且将过滤器创建为“new Zend_Filter_StripTags(array('3'))”似乎也不起作用。

我应该先通过正则表达式传递输入，还是有办法让 Zend_Filter_StripTags 变直并正确飞行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T19:19:30.997

最后编写了一个 Zend_Filter 类，它基本上是 HTMLPurifier 的包装器。完美运行，因为 HTMLPurifier 比 striptags 聪明很多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T01:27:41.583

我对 Zend 不太熟悉，但如果你想要`<3`允许的东西，就做[`htmlspecialchars`](http://www.php.net/htmlspecialchars)而不是`strip_tags`在它上面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T08:09:15.253

你想要的是 Zend_Filter_HtmlEntites 最有可能。

请参阅：[Zend_Filter_HtmlEnties](http://framework.zend.com/manual/en/zend.filter.set.html#zend.filter.set.htmlentities)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T22:40:03.167

htmlspecialchars 和 Zend_Filter_HtmlEntities 的问题在于，如果您尝试去除所有 html 标记（如“a”和“img”等），那么您最终会在输出中得到该标记，而不是去除它们。

以博客上的评论为例。如果您使用 htmlspecialchars 或 Zend_Filter_HtmlEntities，在有人尝试使用 html 输入链接的评论中，您最终会在显示评论时显示该标记。但是如果你使用 strip_tags 或 Zend_Filter_StripTags 你最终会破坏评论，因为两者都不够聪明，无法意识到 '<3' 不是标签，并且只是从 '<3' 中删除所有内容，直到评论结束（或直到它找到 '>' ）。

如果 Zend 有类似 HTMLPurifier 之类的东西会很好，它会在去除标签之前实际检查和验证输入。这意味着像'<3'这样的东西会被单独留下，而像'Awesome Site'这样的东西会变成'Awesome Site'。

这是我正在尝试解决的一个问题，目前看来我最终要编写自己的 Zend_Filter 类，它基本上是 HTMLPurifier 的包装器。

# build - 在 Windows 上是否有相当于 Make 的功能？

> ID：544362
> 
> 赞同：16
> 
> 时间：2009-02-13T01:26:30.400
> 
> 标签：build, compiler-construction, makefile

我在 Windows 上开发，我想使用 beanstalkd。它仅作为 tarball 提供，我只是想知道是否有某种方法可以像在 Linux 中一样轻松构建它？我发现了一些适用于 Windows 的 gnu make 端口，但它们似乎不起作用。源代码发行版是否特定于 Linux？

当我尝试使用 mingw32-make 时，它​​显示“*文件*无事可做”。TBH 我不确定在什么上运行它，所以我尝试了 tarball、目录以及 Makefile.in 和 Makefile.am。他们都说同样的话。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-13T01:37:13.573

Make 在[cygwin](http://www.cygwin.com/)中可用，您可以通过安装程序安装 make。

该软件包称为“make”，属于“Devel”类别。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-13T03:53:18.270

> 我发现了一些适用于 Windows 的 gnu make 端口，但它们似乎不起作用。

以下是一些*GNU*工具到*Windows*的端口：

*   **GnuWin32** - [http://gnuwin32.sourceforge.net/summary.html](http://gnuwin32.sourceforge.net/summary.html)
*   **用于 NT 的 Gnu 工具**- [http://www.devhood.com/Tools/tool_details.aspx?tool_id=3](http://www.devhood.com/Tools/tool_details.aspx?tool_id=3)
*   **Win32 的 GNU 实用程序**- [http://unxutils.sourceforge.net/](http://unxutils.sourceforge.net/)

我很确定我已经毫无问题地使用了*unxutils*端口中的一些实用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-13T01:48:53.483

我也会考虑将 msys 与 mingw 一起使用（也可以在[http://mingw.org](http://mingw.org)找到）我可以尝试解释它，但我认为他们页面上的描述效果更好

MSYS：提供与 POSIX 兼容的 Bourne shell 环境的最小系统，带有少量 UNIX 命令行工具。主要开发用于执行用于构建开源软件的配置脚本和 Makefile，但也可用作通用命令行界面来替代 Windows cmd.exe。

在 cygwin 上使用 msys 的一个好处是它可以构建本地 Windows 应用程序，而不必依赖 cygwin 兼容层

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-13T03:25:56.883

大多数 unix 源代码包都需要您运行“configure”，它会读取有关您的系统的一些信息并构建 Makefile - 尽管在 X11 的早期，一些包使用“xmkmf”从 IMakefiles 构建 Makefile。只有在完成之后，您才能运行“make”并且可能运行“make install”。从它的声音来看，您没有 Makefile，只有 Makefile.in（这是配置的输入）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-13T01:36:13.200

Cygwin 很好，正如前面的答案所示，但它包括的不仅仅是 make。

我曾经在 Windows 上使用 NMake 来构建 Perl 模块。看看这个：

[http://johnbokma.com/perl/make-for-windows.html](http://johnbokma.com/perl/make-for-windows.html)

这对 Perl 很有用。看起来也有一个通用的 GNU 端口：

[http://gnuwin32.sourceforge.net/packages/make.htm](http://gnuwin32.sourceforge.net/packages/make.htm)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-13T04:01:21.620

想到了 Cygwin 和 mingw。

MSVC 包括 nmake，它可以在常规 makefile 上进行一些调整。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-13T04:21:24.257

该`make`实用程序需要使用名为*Makefile*的文件。如果您只键入`make`，它将自动找到该文件。如果 makefile 有其他名称，请使用该`-f`选项。如果您只是给出不带 的文件名`-f`，那么`make`会将其解释为它应该弄清楚如何制作的*目标。*

许多仅作为源代码提供的工具假定您将使用 Visual C++ 在 Windows 上构建，即使它们假定您将在其他任何地方使用 G++。查找 Visual C++ 生成文件；它通常被命名为*Makefile.mak*。然后运行`nmake`。

但是，如果您只有名为*Makefile.in*和*Makefile.am*的文件，那么您还没有一个可制作的环境。*Makefile.in*是`configure`脚本的输入之一，它将根据`configure`运行的测试构建真正的 makefile 以及可能特定于您的环境的一两个标头。

In the end, the package you've downloaded might not really be compilable on Windows. Even under Cygwin, you can expect to have to make a few changes to the source code if it hasn't been written with Windows in mind.

*Makefile.in* will contain the basics of the final makefile. Back before I knew what I was supposed to do, I simply renamed *Makefile.in* to *Makefile* and got pretty far. You can try using that file as a starting point for constructing a real Windows makefile, for whichever compiler target you choose. It will take patience; just keep following the compiler messages until you don't see any more. (And then comes the linker. Hope you don't need too many other libraries!)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-13T01:32:29.997

关于替代方案，请查看此[链接](https://stackoverflow.com/questions/524745/make-and-alternatives-pros-and-cons-on-windows-platform)。至于你的问题，你必须对非工作部分更具体一点。什么不起作用，它是如何表现出来的，它给出了什么错误等等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-09-21T15:30:21.770

Let someone else do the hard work. Here's a precompiled [beanstalkd 1.4.6](http://software1987.de/2011/03/beanstalkd-unter-windows-mit-cygwin/) exe.

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-02-13T01:48:23.267

解压缩 tarball，cd 到它的最顶层目录并输入“make”。Make 会自动获取 Makefile。

# .htaccess - 使用 htaccess 将所有流量从根重定向到特定的子域页面

> ID：544369
> 
> 赞同：4
> 
> 时间：2009-02-13T01:30:13.200
> 
> 标签：.htaccess, mod-rewrite, redirect, subdomain

我有一个网站已经上线了一段时间。一段时间以来，我在子域上有一个博客。我决定取消主站点，只支持博客子域。

我为此设置了重定向设置，但它将所有额外参数传递到博客，导致出现找不到文件的页面。我只想重定向到没有参数的索引页面。

我目前在我的 .htaccess 文件中拥有的是这个

```
RewriteCond %{HTTP_HOST} ^.*$
RewriteRule ^/?(.*)$ "http\:\/\/blog\.foo\.org\/index\.php" [R=301,L] 
```

当我收到请求时

[http://www.foo.org/foo/foo/?module=foo](http://www.foo.org/foo/foo/?module=foo)

它重定向到

[http://blog.foo.org/foo/foo/index.php?module=foo](http://blog.foo.org/foo/foo/index.php?module=foo)

我希望它重定向到 [http://blog.foo.org/index.php](http://blog.foo.org/index.php)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T08:42:14.457

您必须在替换中指定查询以覆盖原始查询：

```
RewriteCond %{HTTP_HOST} !^blog\.example\.org$ [NC]
RewriteRule ^ http://blog.example.org/index.php? [R=301,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T03:40:04.603

```
RewriteEngine On
Options +FollowSymlinks
RewriteCond %{HTTP_HOST} ^(www\.)?foo\.org$ [NC]
RewriteRule ^ http://blog.foo.org/ [R=301,L] 
```

# linq-to-entities - Linq to Entities 如何从父级返回所有记录？

> ID：544378
> 
> 赞同：1
> 
> 时间：2009-02-13T01:33:03.083
> 
> 标签：linq-to-entities, left-join

## 员工表

Employee_ID int
Employee_Name varchar(50)

## 销售表：

Sales_ID int
Employee_ID int
Sale_Amount 钱

## 标准 SQL 选择

Select
*
From Employee emp
left outer join
Sales s
on
s.Employee_ID = emp.Employee_ID

## 标准 SQL 结果（我想要使用 Linq to Entites 的确切结果）

1 Emp1 1 1 150.00
1 Emp1 2 1 500.00
2 Emp2 3 2 250.00
3 Emp3 NULL NULL NULL
4 Emp4 NULL NULL NULL
5 Emp5 4 5 700.00

## 现在解决 Linq To Entity

```
 Dim query = From emp In entiites.Employee _
                    From sales In emp.Sales _
                    Select _
                        emp, _
                        sales 
```

## Linq To Entities 结果（Employee_ID 3 和 4 在哪里）

1: Emp1: 150.0000
1: Emp1: 500.0000
2: Emp2: 250.0000
5: Emp5: 700.0000

## 尝试使用具有左外连接的 Linq to Entities：

```
 Dim query = From emp In entiites.Employee _
                    Group Join sales In entiites.Sales _
                    On emp.Employee_ID Equals sales.Employee.Employee_ID _
                    Into sales_grp = Group _
                    From Sel_SalesGrp In sales_grp.DefaultIfEmpty() _
                    Select _
                        emp, _
                        Sel_SalesGrp 
```

**然后我使用 DefaultIfEmpty 得到这个错误：**

LINQ to Entities 无法识别方法 'System.Collections.Generic.IEnumerable `1[m12Model.Sales] DefaultIfEmpty[Sales](System.Collections.Generic.IEnumerable`1[m12Model.Sales])' 方法，并且此方法无法转换为存储表达式。

## Linq to Entites：不支持 DefaultIfEmpty()。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T01:56:36.523

您需要使用“Into”和“DefaultIfEmpty()”关键字执行左连接：

```
Dim query = From emp In entities.Employee _
        Join sal In entities.Sales On emp.Employee_ID Equals sal.Employee_ID Into LeftJoinSal _
        From ljs In LeftJoinSal.DefaultIfEmpty() _
        Select _
            emp, _
            ljs 
```

这个网站展示了另一个简单的例子：[GeeksWithBlogs](http://geekswithblogs.net/AzamSharp/archive/2008/04/07/121103.aspx)。虽然它是在 C# 中。

关键是您需要加入一个新名称以防止它从您的第一个表中过滤结果（隐藏未加入的行），然后使用 DefaultIfEmpty() 函数从中进行选择，该函数提供默认值(null) 在没有连接的情况下的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T20:49:56.733

这个怎么样：

```
Dim query = From emp In entiites.Employee Join sales In In entiites.Sales _
    On emp.Employee_ID Equals sales.Employee_ID select new { emp, sales } 
```

您可以选择所需的列，而不是“select new { emp, sales }”。那应该是使用 LINQ 的标准左连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T19:53:04.720

您现在可能已经找到了解决方案，但我有一个建议，使用与连接不同的方法：

```
 Dim db As New TestEntities
    Dim EmptySale As Decimal? = Nothing
    Dim Q = (From emp In db.Employee From sale In emp.Sale _
             Select emp.Name, amount =sale.SaleAmount).ToList
    Dim Q2 = (From emp In db.Employee Where Not emp.Sale.Any _
             Select emp.Name, amount = EmptySale)
    Dim Q3 = From emp In Q.Union(Q2) Order By emp.Name, emp.amount

    For Each e In Q3
        Console.WriteLine("{0} {1}", e.Name, e.amount)
    Next 
```

结果是：

```
Emp1 150,00
Emp1 500,00
Emp2 250,00
Emp3
Emp4
Emp5 750,00 
```

我希望这可以帮助你

# algorithm - 关键系统中是否有任何软件保证？

> ID：544380
> 
> 赞同：3
> 
> 时间：2009-02-13T01:33:37.623
> 
> 标签：algorithm, correctness, mission-critical

是否有系统或有开发的带有正确性证明的软件来支持它？还是所有关键系统都只是通过积极的代码审查和测试周期开发的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-13T19:21:07.820

在现实世界中，为高完整性应用程序编码通常涉及跳过一堆 QA 圈。有时，这些箍实际上与正确使用软件有关。

美国的医疗器械行业受 FDA 监管。他们发布了一系列涵盖“设计”的法规，其中包括所有软件开发。这些法规基本上是关于类固醇的 ISO 9000。你必须有一堆文件，这些文件是由审阅者编写、标记、更新审阅意见并由高级经理签署的。由于法规有法律支持，因此 FDA 希望看到这些记录未被篡改的证据，例如，在您看到测试给出的结果后写下测试的“预期结果”。因此，您要么必须拥有一个完全安全的 CM 系统，要么必须在纸上签名并注明日期（包括源代码）。FDA检查员拥有真正的执法权力；如果他们认为合适，他们可以与武装的联邦元帅一起检查您的源代码。然而他们不是软件专家：他们的工作不是判断你的代码质量，只是确保你遵守了所有的规定。

航空业必须遵循 DO-178B，这也是 ISO-9000 的类固醇。您必须制作大量文档并证明它们之间的可追溯性。我不知道 FAA 是否采用与 FDA 相同的 QA 方法。

问题在于，没有人真正知道如何生产能够完成预期工作的软件。因此，我们有一种货物崇拜的方法，我们制作大量文档，希望这将使我们的软件充满质量。质量软件通常具有明确的需求和简单的逻辑架构，这是事实，但这并不意味着编写“需求文档”或“架构文档”会改善问题。

证据表明，对代码正确性影响最大的因素是创建它的团队。但是，您不能为团队编写法律约束。因此，负责要求质量的人不得不写下对流程的限制，模糊地希望这会产生类似的效果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T01:38:36.597

请参阅[**他们编写正确的东西**](http://www.fastcompany.com/magazine/06/writestuff.html)，以有趣地了解他们如何为航天飞机开发软件。

摘抄：

> 但该软件做了多少工作并不是让它引人注目的原因。它的显着之处在于该软件的运行效果。这个软件永远不会崩溃。它永远不需要重新启动。该软件没有错误。它是完美的，就像人类已经达到的那样完美。考虑一下这些统计数据：该程序的最后三个版本——每个 420,000 行长——每个都只有一个错误。该软件的最后 11 个版本共有 17 个错误。同等复杂度的商业程序会有 5,000 个错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-10T01:35:49.523

是的，有一些系统开发了正确性证明。Praxis 多年来一直使用 SPARK Ada 来做这件事，现在我们使用 C 和 Escher C Verifier 来做这件事。它不是万能的，因为即使我们证明代码满足规范，通常也很难确定规范是否适合相关应用程序。

更广泛地采用形式证明的障碍之一是现有的航空软件标准 DO-178B 对形式技术不友好。目前正在进行的 DO-178C 重写应该可以解决这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T04:44:43.763

查看 Walter Bright 的这篇专栏文章，他基本上认为编写完美的软件几乎是不可能的，所以[最好的办法是快速失败并建立冗余。](http://dobbscodetalk.com/index.php?option=com_content&task=view&id=698)

# c# - C# 的属性从何而来？

> ID：544382
> 
> 赞同：0
> 
> 时间：2009-02-13T01:35:24.280
> 
> 标签：c#, properties, attributes, annotations, history

我发现 C# 的 Attributes，Python 的 Properties 也是一个非常好的主意，我猜它们的直接祖先可能来自 Java 的 Annotations，但我很好奇这个概念最初来自哪里，有人有任何线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T02:39:18.947

这是一个古老的概念，元数据。看看[这个](https://stackoverflow.com/questions/445332/what-was-the-historical-precursor-for-net-attributes)问题，和你的一样。

# asp.net-mvc - MVC RC 如何在没有代码隐藏的情况下配置 UserControl？

> ID：544383
> 
> 赞同：2
> 
> 时间：2009-02-13T01:35:24.717
> 
> 标签：asp.net-mvc, user-controls

在没有 CodeBehind 的 RC 中，如果我将模型传递给它，我如何将 ascx 与视图连接起来？

我的 CSS 类都说未定义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T01:40:27.247

如果您的模型在 web 项目中，您可以修改 Page 标记以指定您的控件继承自`ViewUserControl<YourModel>`以使其具有强类型。我发现如果您的模型在单独的项目中，那么您需要为控件添加一个 *.ascx.cs 代码隐藏文件，让该类派生自`ViewUserControl<YourModel>`并修复页面指令以指定代码隐藏中的类.

我已将无法在其他项目中找到模型作为 CodePlex 上的错误报告。

对于 CSS，您需要将它们直接包含在 ViewUserControl 中，但使用 if (false) 标记以便您获得智能感知，但在页面处理期间实际上并未重新包含这些文件。

```
 <% if (false) { %>
    <link href=...
 <% } %> 
```

# api - OpenID 身份验证和 API 访问

> ID：544388
> 
> 赞同：16
> 
> 时间：2009-02-13T01:36:18.240
> 
> 标签：api, authentication, openid

OpenID 身份验证本质上是基于浏览器的。如果我想允许 OpenID 用户针对 API 进行身份验证以在替代客户端中使用，是否有公认的最佳实践？

例如，如果用户尝试使用他们的 OpenID 登录 iPhone 应用程序，那将如何工作？我能想到的唯一一件事就是为他们生成某种 API 令牌并让用户在某处手动输入它。这种方法对用户不友好。

这就是像[Basecamp](http://basecamphq.com)这样的网站的工作方式，但对我来说仍然很笨拙。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-17T03:50:08.607

您看到的问题并不是 OpenID 独有的。任何无密码身份验证方案都可能存在此问题。OAuth ( [http://oauth.net/](http://oauth.net/) ) 是一个开放标准的解决方案，在许多网站上迅速获得关注。它完全独立于用户的身份验证方式，因此他们的 OpenID 提供者*不需要*支持甚至不需要知道您的站点（OAuth 术语中的“服务提供者”）正在使用 OAuth。您的 API 客户端可以是基于 Web 的，甚至可以是本地应用程序！

该过程将是这样的：

角色：

*   用户：拥有您网站帐户的人。
*   服务提供商：您的网站，它有一个程序化 API，需要一些凭据才能访问。
*   消费者：需要访问服务提供者 API 的客户端，无论是 Web 还是本地应用程序。

流动：

1.  用户是消费者。他表示他想访问服务提供商的数据。
2.  用户要么被重定向（如果消费者是网站），要么浏览器被弹出（如果消费者是本地应用程序）并且用户看到服务提供商网站。
3.  用户要么已经通过持久性 cookie 登录到服务提供者，要么用户必须先登录到服务提供者，但是已经完成（在你的情况下是 OpenID）。
4.  服务提供者然后询问用户：“消费者（某些消费者）想要访问您的数据（或我们的 API 或其他）。您要授权吗？（是/否）
5.  用户确认，浏览器窗口关闭或被重定向回消费者站点。
6.  通过一些 OAuth 协议魔法，消费者现在拥有一个秘密凭证，它可以使用它来访问您的 API 并访问您刚刚授权的任何用户私有信息。

显然，我不能在此处包含整个 OAuth 规范，但是您可以从上面看到，这应该可以解决您的问题。OAuth 库的存在是为了轻松添加对它的支持。

如果您碰巧使用 ASP.NET，我建议[http://dotnetopenid.googlecode.com/](http://dotnetopenid.googlecode.com/)因为它最近添加了 OAuth 支持（v3.0 beta 1）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-26T21:28:59.177

OpenID 和 OAuth 都没有定义用户如何进行身份验证。它们定义了消费者如何将用户代理引导到身份验证提供者，如何将用户代理返回，以及消费者如何验证用户通过身份验证的身份。

用于认证的实际方法对于这两种方案都是带外的。

OpenID 和 OAuth 之间存在差异，但两者都要求消费者使用 HTTP 重定向和回调 URL。它们都是基于浏览器的。如果您的应用程序使用 HTTP，它可以做到。但是，要点是用户只是将凭据输入到受信任的应用程序中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T01:52:54.130

OpenID 无法实现您想要的。OpenID 的前提是您（iPhone 应用程序）只想了解您的用户，即他们的 OpenID 提供者信任他们。他们从不向您证明自己。

实际上，优秀的 OpenID 提供者甚至会[阻止](http://support.wordpress.com/settings/openid/#what-if-im-not-signed-in-to-wordpresscom)您调解身份验证过程（因为这会使用户面临可能的攻击 - 由您发起！）：他们要求用户直接使用他们登录并拒绝通过推荐登录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T01:41:17.353

请参阅：此[相关问题](https://stackoverflow.com/questions/459428/logging-in-to-an-openid-site-from-a-net-app)

问题是 openid 规范没有与提供者进行身份验证的标准规定，因此提供者可以选择通过电话或其他方式进行身份验证。

希望更多的供应商[接受 OAuth](http://oauth.net/)。或者，您可以为一些较大的站点手动编写身份验证代码。

# c++ - 在 C++ 中连接字符串和数字？

> ID：544397
> 
> 赞同：4
> 
> 时间：2009-02-13T01:39:15.830
> 
> 标签：c++, string

我正在尝试连接“（”+ mouseX +“，”+ mouseY“）”。但是，mouseX 和 mouseY 是整数，所以我尝试使用字符串流，如下所示：

```
std::stringstream pos;
pos << "(" <<  mouseX << ", " << mouseY << ")";
_glutBitmapString(GLUT_BITMAP_HELVETICA_12, pos.str()); 
```

它似乎不起作用。

我收到以下错误：

> mouse.cpp:75: 错误：无法`std::basic_string<char, std::char_traits<char>, std::allocator<char> >' to`为参数`2' to`void _glutBitmapString(void*, const char*)' 转换 const char*'

在这个基本字符串+整数连接中我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-13T01:43:19.503

`glutBitmapString()`期望 a`char*`并且您正在向它发送一个字符串。在字符串上使用 .c_str() ，如下所示：

```
_glutBitmapString(GLUT_BITMAP_HELVETICA_12, pos.str().c_str()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-13T01:42:27.117

尝试

```
_glutBitmapString(GLUT_BITMAP_HELVETICA_12, pos.str().c_str()); 
```

# c# - 将 Windows 窗体 Datagrid 正确绑定到数组

> ID：544398
> 
> 赞同：0
> 
> 时间：2009-02-13T01:39:19.403
> 
> 标签：c#, winforms, datagrid, .net-1.1

我正在尝试使用 Windows 窗体数据网格（.NET 1.1）来更新二维数组的元素。使用微软文档，我已经能够让数据网格正确显示数组。

编辑：我遵循的 MS 说明位于[http://support.microsoft.com/kb/315786](http://support.microsoft.com/kb/315786)。

```
class myrow {
   private int a, b;
   public int A {get { return a; } set {a = value;}}
   public int B {get { return b; } set {b = value;}}
}

myrow[] myRows = new myrow[5] {
    new myrow(3,2),
    new myrow(2,2),
    new myrow(1,2),
    new myrow(3,3),
    new myrow(3,1),
}

myDataGrid.SetDataBinding(myRows, ""); 
```

我还将 DataGrid 的 TableStyle.MappingName 属性设置为`"myrow[]"`.

让我发疯的是我无法更新它。我在表格的一个单元格中输入一个新值，例如“1123”，然后按 Enter 或 Tab，光标移动到下一个单元格，该值变回原始值。

我怎样才能让它接受更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T02:13:28.493

这不是我的想法，但我认为您需要实现一个在更改网格单元格或单击更新按钮时触发的事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-25T20:06:23.143

在我的脑海中，我认为您需要...升级到更新版本的 Visual Studio。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T15:07:45.527

有一种解决方法，如果将数组更改为 ArrayList 或其他集合类，则更新工作。

不是一个真正的答案，因为它仍然没有使用对象数组，并且仍然不适合常规的二维数据数组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T06:29:17.413

不幸的是，我无法检查 .NET 1.1，但对于替换 DataGrid 的 .NET 2.0 控件 DataGridView，不需要手动更新数据源。

希望这会以某种方式帮助你。

# javascript - HTML CSS：Iframes/动态问题

> ID：544404
> 
> 赞同：0
> 
> 时间：2009-02-13T01:40:25.827
> 
> 标签：javascript, html, iframe

我在创建一个实验性的“动态”风格网站时遇到了一些麻烦。该站点设置如下。用户有一个可供选择的链接菜单，特别是使用图像映射。当他们将鼠标悬停在选择上时，会弹出一个 iframe（变得可见）显示一些数据。当用户移开鼠标时，iframe 会消失，直到用户将鼠标悬停在另一个链接上。

- 它似乎运作良好，但只是间歇性的。有时在离开一个锚点后，样式、文本等仍然占据框架，即使我将鼠标悬停在另一个链接上。这种行为似乎是相当随机的，但必须有办法解决它。

这是我正在使用的示例。如果参数为 1，show 函数将框架设置为可见，如果为 0，则将框架设置为隐藏。frameset 将主框架设置为所需的 html 文档。在离开链接尝试修复它后，我尝试实施重置以将框架设置为空白，但问题仍然存在。

```
<area shape="circle" coords="..." href="..." onmouseover="Show('frame', 1);
frameset('page.html');" onmouseout="Show('frame', 0); reset();" /> 
```

以及功能

```
function frameset(a)
{
  document.all.frame.src=a;
}

function reset()
{
  document.all.frame.src=blank.html;
} 
```

这是一个很难描述的问题，所以如果需要更多信息或代码，请告诉我。考虑到我不精通javascript，也欢迎任何更好的方法替代我的方法:)谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T01:52:50.010

我认为通过使用更现代的方法可以更好地执行您正在做的事情。

图像映射可能具有绝对定位的块级锚标记..但这似乎不是问题。

我建议不要使用 iframe，而是使用 AJAX 来获取信息，并使用 jQuery 之类的框架来帮助您显示数据。

您可以加载 AJAX 并在鼠标悬停时显示带有加载 throbber ( [http://www.ajaxload.info](http://www.ajaxload.info) ) 的框，并将数据解析为 div 内的可视格式。

## 学习 AJAX

AJAX 是当页面向服务器发出 http 请求时，还可以返回数据，然后与 Javascript 一起使用来更新 DOM。

jQuery 是一个 Javascript 框架，旨在抽象出浏览器特定的代码和不一致性，让使用 Javascript 的体验更好。

查看[jQuery 的 AJAX 函数](http://docs.jquery.com/Ajax)

祝你好运！！

# c# - C# 控制台应用程序中的 HTTP Post 不会返回与浏览器请求相同的内容

> ID：544411
> 
> 赞同：3
> 
> 时间：2009-02-13T01:42:45.150
> 
> 标签：c#, http, post, console-application

我有一个使用以下代码执行 HTTP 发布的 C# 控制台应用程序（.NET 2.0 框架）：

```
StringBuilder postData = new StringBuilder(100);
postData.Append("post.php?");
postData.Append("Key1=");
postData.Append(val1);
postData.Append("&Key2=");
postData.Append(val2);

byte[] dataArray = Encoding.UTF8.GetBytes(postData.ToString());

HttpWebRequest httpRequest = (HttpWebRequest)WebRequest.Create("http://example.com/");
httpRequest.Method = "POST";
httpRequest.ContentType = "application/x-www-form-urlencoded";

httpRequest.ContentLength = dataArray.Length;
Stream requestStream = httpRequest.GetRequestStream();
requestStream.Write(dataArray, 0, dataArray.Length);
requestStream.Flush();
requestStream.Close();

HttpWebResponse webResponse = (HttpWebResponse)httpRequest.GetResponse();

if (httpRequest.HaveResponse == true) {
  Stream responseStream = webResponse.GetResponseStream();
  StreamReader responseReader = new System.IO.StreamReader(responseStream, Encoding.UTF8);
  String responseString = responseReader.ReadToEnd();
} 
```

其输出为：
webResponse.ContentLength = -1
webResponse.ContentType = text/html
webResponse.ContentEncoding 为空白

responseString 是带有标题和正文的 HTML。

但是，如果我将相同的 URL 发布到浏览器 ( [http://example.com/post.php?Key1=some_value&Key2=some_other_value](http://example.com/post.php?Key1=some_value&Key2=some_other_value) )，我会得到一个小的 XML 片段，例如：

`<?xml version="1.0" ?>`
`<RESPONSE RESULT="SUCCESS"/>`

没有与应用程序中相同的 HTML。为什么反应如此不同？我需要解析在 HTML 中没有得到的返回结果。我是否必须更改我在应用程序中发布帖子的方式？我无法控制接受帖子的服务器端代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-13T02:32:58.137

如果您确实应该使用`POST`HTTP 方法，那么您有几个问题。首先，这一行：

```
postData.Append("post.php?"); 
```

是不正确的。您想发布*到* `post.php`，不想发布值“post.php？” 到页面。只需完全删除此行。

这件作品：

```
... WebRequest.Create("http://example.com/"); 
```

需要`post.php`添加它，所以...

```
... WebRequest.Create("http://example.com/post.php"); 
```

同样，这是假设您实际上应该是`POST`ing 到指定的页面而不是`GET`ing。如果您应该使用`GET`，那么已经提供的其他答案适用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-13T21:00:58.643

你会想要一个像[Fiddler](http://www.fiddlertool.com/fiddler/)这样的 HTTP 嗅探器工具，并将你的应用程序发送的标题与浏览器发送的标题进行比较。会有一些不同的东西导致服务器返回不同的响应。当您调整应用程序以发送浏览器发送的相同内容时，您应该得到相同的响应。（它可以是用户代理、cookie 等任何东西，但肯定会有所不同。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T01:59:03.723

我过去见过这种情况。

当您从浏览器运行时，标题中的“User-Agent”是“Mozilla ...”。

当您从程序运行时，它会有所不同，并且通常特定于所使用的语言。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T02:27:37.820

我认为您需要使用 GET 请求，而不是 POST。如果您使用的 url 具有查询字符串值（如 ?Key1=some_value&Key2=some_other_value），那么它需要一个 GET。无需将 post 值添加到您的 webrequest 中，只需将此数据放在查询字符串中即可。

```
HttpWebRequest httpRequest = (HttpWebRequest)WebRequest.Create("http://example.com/?val1=" + val1 + "&val2=" + val2);
httpRequest.Method = "GET";
httpRequest.ContentType = "application/x-www-form-urlencoded";
.... 
```

因此，当您从应用程序发布数据时，您得到的结果会有所不同，因为服务器端代码在无法读取查询字符串中预期的数据时会产生不同的输出。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-13T01:53:12.350

在您的代码中，您指定将数据发送到 PHP 文件而不将数据放入 Web 地址的 POST 方法。当你把信息放在地址栏中时，那不是POST方法，那是GET方法。这个名字可能会让人混淆，但 GET 只是意味着数据正在通过 Web 地址发送到 PHP 文件，而不是在幕后，而不是它应该获取任何信息。当您将地址放入浏览器时，它使用的是 GET。

创建一个简单的 html 表单并将 POST 指定为方法，将您的 url 指定为操作。您将看到发送的信息没有出现在地址栏中。

然后做同样的事情，但指定 GET。您将在地址栏中看到您发送的信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-13T02:58:44.033

表单是否需要 cookie？这是它在浏览器中运行而不是在控制台应用程序中运行的另一个可能原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-13T01:51:31.323

我相信这个问题与为 WebRequest 设置标头的方式有关。

我见过一些奇怪的情况，尝试通过更改请求中的标头来模拟浏览器会对服务器产生影响。

简短的回答是您的控制台应用程序不是 Web 浏览器，example.com 的 Web 服务器期望与浏览器交互。

您也可以考虑将 ContentType 更改为“multipart/form-data”。

我觉得奇怪的是，你基本上什么也没发。这项工作是由查询字符串完成的。因此，您可能应该使用 GET 而不是 POST。

# command-line - 删除空（零字节）文件

> ID：544417
> 
> 赞同：9
> 
> 时间：2009-02-13T01:45:46.033
> 
> 标签：command-line, file, batch-file

仅使用 Mac OS X 原生工具查找和删除空（零字节）文件的最简单/最佳方法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-13T01:50:03.277

很简单：

```
find . -type f -size 0 -exec rm -f '{}' + 
```

* * *

要忽略任何具有 xattr 内容的文件（假设 MacOS`find`实现）：

```
find . -type f -size 0 '!' -xattr -exec rm -f '{}' + 
```

也就是说，请注意许多 xattr 并不是特别有用（例如，`com.apple.quarantine`存在于所有下载的文件中）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-05-17T09:43:02.167

您可以通过以下方式减少运行 /bin/rm 的潜在大量分叉：

```
find . -type f -size 0 -print0 | xargs -0 /bin/rm -f 
```

上面的命令非常便携，可以在大多数版本的 Unix 上运行，而不仅仅是在 Linux 机器上运行，并且可以在几十年前的 Unix 版本上运行。对于长文件列表，`/bin/rm`可以执行多个命令来防止列表超出命令行长度限制。

在较新的操作系统上通过更少的输入也可以实现类似的效果，使用`+`in`find`来替换样式中最常见的`xargs`in 仍然适用于除`/bin/rm`. 在这种情况下，`find`将处理将真正的长文件列表拆分为单独的`/bin/rm`命令。`{}`通常引用它以防止外壳对其进行任何操作；引号并不总是必需的，但 shell 引用的复杂性太复杂，无法在此处介绍，因此如有疑问，请包括撇号：

```
find . -type f -size 0 -exec /bin/rm -f '{}' + 
```

在 Linux 中，通常使用`-delete`. 请注意，最近`find`的`-delete`主要是直接使用 (2) 实现的，并且`unlink`不会产生无数`/bin/rm`命令，甚至不会产生少数命令。Mac OS也有和初选。`xargs``+``find``-delete``-empty`

```
find . -type f -empty -delete 
```

踩空（和新清空的）文件 - 以及目录 - 许多现代 Linux 主机可以使用这种有效的方法：

```
find . -empty -delete 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T01:49:48.677

```
find /path/to/stuff -empty 
```

如果这是您要查找的文件列表，请执行以下命令：

```
find /path/to/stuff -empty -exec rm {} \; 
```

当心！将没有任何方法可以撤消此操作！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T01:50:51.950

采用：

```
find . -type f -size 0b -exec rm {} ';' 
```

使用所有其他可能的变化来限制被删除的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-27T13:50:37.137

如果您想在一个特定文件夹中执行此操作，这是一个非常简单的解决方案：

1.  进入文件夹，右键单击->查看->作为列表。
2.  现在您会发现所有文件都以列表的形式列出。单击必须是列标题的“大小”。这将根据文件的大小对所有文件进行排序。
3.  最后，您可以找到最后零位的所有文件。只需选择那些并删除它！

# python - 如何在 Python 中验证 RSA SHA1 签名？

> ID：544433
> 
> 赞同：30
> 
> 时间：2009-02-13T01:50:48.923
> 
> 标签：python, cryptography, rsa, sha1, signature

我有一个字符串、一个签名和一个公钥，我想验证字符串上的签名。密钥如下所示：

```
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDfG4IuFO2h/LdDNmonwGNw5srW
nUEWzoBrPRF1NM8LqpOMD45FAPtZ1NmPtHGo0BAS1UsyJEGXx0NPJ8Gw1z+huLrl
XnAVX5B4ec6cJfKKmpL/l94WhP2v8F3OGWrnaEX1mLMoxe124Pcfamt0SPCGkeal
VvXw13PLINE/YptjkQIDAQAB
-----END PUBLIC KEY----- 
```

我一直在阅读 pycrypto 文档，但我不知道如何使用这种密钥制作 RSAobj。如果您了解 PHP，我正在尝试执行以下操作：

```
openssl_verify($data, $signature, $public_key, OPENSSL_ALGO_SHA1); 
```

另外，如果我对任何术语感到困惑，请告诉我。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-13T15:59:41.223

使用[M2Crypto](http://www.heikkitoivonen.net/m2crypto/api/M2Crypto.X509-module.html)。以下是验证 RSA 和 OpenSSL 支持的任何其他算法的方法：

```
pem = """-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDfG4IuFO2h/LdDNmonwGNw5srW
nUEWzoBrPRF1NM8LqpOMD45FAPtZ1NmPtHGo0BAS1UsyJEGXx0NPJ8Gw1z+huLrl
XnAVX5B4ec6cJfKKmpL/l94WhP2v8F3OGWrnaEX1mLMoxe124Pcfamt0SPCGkeal
VvXw13PLINE/YptjkQIDAQAB
-----END PUBLIC KEY-----""" # your example key

from M2Crypto import BIO, RSA, EVP
bio = BIO.MemoryBuffer(pem)
rsa = RSA.load_pub_key_bio(bio)
pubkey = EVP.PKey()
pubkey.assign_rsa(rsa)

# if you need a different digest than the default 'sha1':
pubkey.reset_context(md='sha1')
pubkey.verify_init()
pubkey.verify_update('test  message')
assert pubkey.verify_final(signature) == 1 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-13T08:54:06.860

标记之间的数据是包含 PKCS#1 RSAPublicKey 的 PKCS#8 PublicKeyInfo 的 ASN.1 DER 编码的 base64 编码。

这是很多标准，最好使用加密库对其进行解码（例如 joeforker[建议的 M2Crypto](https://stackoverflow.com/questions/544433/how-do-you-verify-an-rsa-sha1-signature-in-python/546043#546043)）。将以下内容视为有关格式的一些有趣信息：

如果你愿意，你可以这样解码：

Base64 解码字符串：

```
30819f300d06092a864886f70d010101050003818d0030818902818100df1b822e14eda1fcb74336
6a27c06370e6cad69d4116ce806b3d117534cf0baa938c0f8e4500fb59d4d98fb471a8d01012d54b
32244197c7434f27c1b0d73fa1b8bae55e70155f907879ce9c25f28a9a92ff97de1684fdaff05dce
196ae76845f598b328c5ed76e0f71f6a6b7448f08691e6a556f5f0d773cb20d13f629b6391020301
0001 
```

这是DER编码：

```
 0 30  159: SEQUENCE {
   3 30   13:   SEQUENCE {
   5 06    9:     OBJECT IDENTIFIER rsaEncryption (1 2 840 113549 1 1 1)
  16 05    0:     NULL
            :     }
  18 03  141:   BIT STRING 0 unused bits, encapsulates {
  22 30  137:       SEQUENCE {
  25 02  129:         INTEGER
            :           00 DF 1B 82 2E 14 ED A1 FC B7 43 36 6A 27 C0 63
            :           70 E6 CA D6 9D 41 16 CE 80 6B 3D 11 75 34 CF 0B
            :           AA 93 8C 0F 8E 45 00 FB 59 D4 D9 8F B4 71 A8 D0
            :           10 12 D5 4B 32 24 41 97 C7 43 4F 27 C1 B0 D7 3F
            :           A1 B8 BA E5 5E 70 15 5F 90 78 79 CE 9C 25 F2 8A
            :           9A 92 FF 97 DE 16 84 FD AF F0 5D CE 19 6A E7 68
            :           45 F5 98 B3 28 C5 ED 76 E0 F7 1F 6A 6B 74 48 F0
            :           86 91 E6 A5 56 F5 F0 D7 73 CB 20 D1 3F 62 9B 63
            :           91
 157 02    3:         INTEGER 65537
            :         }
            :       }
            :   } 
```

对于 1024 位的 RSA 密钥，您可以将`"30819f300d06092a864886f70d010101050003818d00308189028181"`其视为常量标头，后跟 00 字节，然后是 RSA 模数的 128 字节。在那之后 95% 的时间你会得到`0203010001`，这表示 RSA 公共指数 0x10001 = 65537。

您可以在元组中使用这两个值`n`来`e`构造 RSAobj。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T03:44:34.313

公钥包含一个模数（很长的数字，可以是 1024 位、2058 位、4096 位）和一个公钥指数（小得多的数字，通常等于 1 比 2 的某个幂）。您需要了解如何将该公钥拆分为两个组件，然后才能对其进行任何操作。

我对 pycrypto 了解不多，但要验证签名，请获取字符串的哈希值。现在我们必须解密签名。阅读[模幂运算](http://en.wikipedia.org/wiki/Modular_exponentiation)；解密签名的公式是`message^public exponent % modulus`. 最后一步是检查您制作的哈希值和您获得的解密签名是否相同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T09:01:22.383

~~我认为[ezPyCrypto](http://www.freenet.org.nz/ezPyCrypto)可能会使这更容易一些。**关键**类的高级方法包括这两种方法，希望能解决您的问题：~~

*   ~~[verifyString](http://www.freenet.org.nz/ezPyCrypto/detail/public/ezPyCrypto.key-class.html#verifyString) - 根据签名验证字符串~~
*   ~~[importKey](http://www.freenet.org.nz/ezPyCrypto/detail/public/ezPyCrypto.key-class.html#importKey) - 导入公钥（也可能是私钥）~~

[Rasmus](https://stackoverflow.com/users/5542/rasmus-faber)在注释中指出`verifyString`使用 MD5 进行硬编码，在这种情况下 ezPyCryto 无法帮助 Andrew，除非他涉足其代码。我听从[joeforker 的回答](https://stackoverflow.com/questions/544433/how-do-you-verify-an-rsa-sha1-signature-in-python/546476#546476)：考虑[M2Crypto](http://www.heikkitoivonen.net/m2crypto/api/M2Crypto.X509-module.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-30T08:34:34.613

更多关于 DER 解码。

DER 编码始终遵循 TLV 三元组格式：（标记、长度、值）

*   Tag 指定值的类型（即数据结构）
*   长度指定此值字段占用的字节数
*   值是可能是另一个三元组的实际值

标记基本上告诉如何解释值字段中的字节数据。ANS.1 确实有一个类型系统，例如 0x02 表示整数，0x30 表示序列（一个或多个其他类型实例的有序集合）

长度表示有一个特殊的逻辑：

*   如果长度<127，L字段只用一个字节，直接编码为长度数值
*   如果长度> 127，则在L字段的第一个字节中，第一位必须为1，其余7位表示后面的字节数，用于指定Value字段的长度。值，值本身的实际字节。

例如，假设我想编码一个 256 字节长的数字，那么它会是这样的

```
02  82  01  00  1F  2F  3F  4F  …   DE  AD  BE  EF 
```

*   标记，0x02 表示它是一个数字
*   长度，0x82，它的位表示是1000 0010，意思是后面两个字节指定了值的实际长度，他的0x0100表示​​值域是256字节长
*   值，从 1F 到 EF，实际 256 字节。

现在看你的例子

```
30819f300d06092a864886f70d010101050003818d0030818902818100df1b822e14eda1fcb74336
6a27c06370e6cad69d4116ce806b3d117534cf0baa938c0f8e4500fb59d4d98fb471a8d01012d54b
32244197c7434f27c1b0d73fa1b8bae55e70155f907879ce9c25f28a9a92ff97de1684fdaff05dce
196ae76845f598b328c5ed76e0f71f6a6b7448f08691e6a556f5f0d773cb20d13f629b6391020301
0001 
```

它解释为拉斯穆斯法伯在他的回复中所说的

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-13T02:13:10.100

也许这不是您要寻找的答案，但如果您只需要将密钥转换为位，它看起来就像是 Base64 编码的。查看`codecs`标准 Python 库中的模块（我认为）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-03-27T13:03:19.610

使用 M2Crypto，上述答案不起作用。这是一个经过测试的示例。

```
import base64
import hashlib
import M2Crypto as m2

# detach the signature from the message if it's required in it (useful for url encoded data)
message_without_sign = message.split("&SIGN=")[0]
# decode base64 the signature
binary_signature = base64.b64decode(signature)
# create a pubkey object with the public key stored in a separate file
pubkey = m2.RSA.load_pub_key(os.path.join(os.path.dirname(__file__), 'pubkey.pem'))
# verify the key
assert pubkey.check_key(), 'Key Verification Failed'
# digest the message
sha1_hash = hashlib.sha1(message_without_sign).digest()
# and verify the signature
assert pubkey.verify(data=sha1_hash, signature=binary_signature), 'Certificate Verification Failed' 
```

就是这样

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-08-08T03:59:08.167

我尝试了 joeforker 给出的代码，但它不起作用。这是我的示例代码，它工作正常。

```
from Crypto.Signature import PKCS1_v1_5
from Crypto.PublicKey import RSA 
from Crypto.Hash import SHA

pem = """-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDfG4IuFO2h/LdDNmonwGNw5srW
nUEWzoBrPRF1NM8LqpOMD45FAPtZ1NmPtHGo0BAS1UsyJEGXx0NPJ8Gw1z+huLrl
XnAVX5B4ec6cJfKKmpL/l94WhP2v8F3OGWrnaEX1mLMoxe124Pcfamt0SPCGkeal
VvXw13PLINE/YptjkQIDAQAB
-----END PUBLIC KEY-----""" # your example key

key = RSA.importKey(pem)
h = SHA.new(self.populateSignStr(params))
verifier = PKCS1_v1_5.new(key)
if verifier.verify(h, signature):
  print "verified"
else:
  print "not verified" 
```

# xpath - 使用 XPath 查找变量时，只取该变量的一部分

> ID：544444
> 
> 赞同：2
> 
> 时间：2009-02-13T01:54:05.577
> 
> 标签：xpath, tokenize

我是 XPath 的新手。我正在编写一个代码来从页面中获取所有 3 位数字。它们不是恒定的，在 105、515 和 320 之间变化。我希望两个能够将这些数字标记为两个单独的部分......

我希望能够在一个 X 路径表达式中获取第一个数字，在第二个 X 路径表达式中获取第二个数字

在进行研究时，我发现您无法使用“零值”进行标记，但是有什么办法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T04:03:26.280

**在我看来，问题实际上是关于将3 位数字*拆分***为两个字符串的可能方法，第一个包含第一个数字，第二个包含剩余的两个数字。

**这是一种可能的解决方案**：

**以下 XPath 表达式在计算时会生成一个包含数字 $vNum 的第一位数字的字符串**（在实际的 XPath 表达式中，将 $vNum 替换为生成此值的 XPath 表达式）：

```
 substring($vNum, 1, 1) 
```

**以下 XPath 表达式在求值时生成一个字符串，其中包含 3 位数字 $vNum 的最后两位数字**（在实际的 XPath 表达式中，将 $vNum 替换为产生此值的 XPath 表达式）：

```
 substring($vNum, 2) 
```

**如果我们不确定**$vNum 的位数，**则下面的 XPath 表达式在计算时会生成一个字符串，其中包含紧跟在 3+ 位数字**$vNum 的第一个数字之后的两个数字（在实际的 XPath 表达式中，将 $vNum 替换为产生此值的 XPath 表达式）：

```
 substring($vNum, 2, 2) 
```

最后，**如果我们再次不知道确切的位数，但想要获得最后两位，则以下 XPath 表达式在计算时会生成一个字符串，该字符串包含 2+ 位数字 $vNum 末尾的两位数**（在实际的 XPath 表达式中，将 $vNum 替换为产生此值的 XPath 表达式）：

```
 substring($vNum, string-length($vNum) - 1) 
```

# c# - 你如何摆脱c#中的一个对象

> ID：544449
> 
> 赞同：7
> 
> 时间：2009-02-13T01:55:20.347
> 
> 标签：c#, .net, oop, garbage-collection

在下面的 c# 代码中，当对象不再有用时，如何摆脱它？它会自动得到处理，还是我需要做些什么？

```
public void Test()
{
   object MyObject = new object();

   ... code ...
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-13T01:57:13.680

自动地。当 MyObject 超出范围时（在测试结束时），它被标记为垃圾收集。在未来的某个时候，.NET 运行时将为您清理内存

编辑：（为了完整起见，我应该指出，如果您将 MyObject 传递到某个地方，它会通过引用传递，并且不会被垃圾收集 - 只有当没有更多对对象的引用漂浮时，GC 才能自由收集它）

编辑：在发布版本中，通常会在未使用时立即收集 MyObject（有关更多详细信息，请参阅我的答案--dp）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-13T07:34:17.647

简短的回答是：除非它具有非托管资源（文件句柄等），否则您无需担心。

长答案涉及更多。

当 .NET 决定要释放一些内存时，它会运行*垃圾收集器*。这会查找所有仍在使用的对象，并将它们标记为此类。仍然可以读取的任何局部变量（在任何线程的任何堆栈帧中）都算作*根*，静态变量也是如此。（事实上​​，我相信静态变量是通过实时类型对象引用的，这些对象是通过实时 AppDomain 对象引用的，但在大多数情况下，您可以将静态变量视为根。）

垃圾收集器查看根引用的每个对象，然后根据这些对象中的实例变量找到更多“活动”引用。它向下递归，找到越来越多的对象并将其标记为“活动”。一旦完成这个过程，它就可以查看所有*其余*的对象并释放它们。

*这是一个非常广泛的概念图——但是当你想到垃圾收集、终结器、并发收集等的分代*模型时，它会变得更加详细。我强烈建议你[通过 C# 阅读 Jeff Richter 的 CLR，](https://rads.stackoverflow.com/amzn/click/com/0735621632)它在很多地方都有介绍细节。如果您不想购买这本书，他还有一篇[两](http://msdn.microsoft.com/en-us/magazine/bb985010.aspx) [部分的文章（从 2000 年开始，但仍然非常相关）。](http://msdn.microsoft.com/en-us/magazine/bb985011.aspx)

当然，这并不意味着您无需担心 .NET 中的内存使用和对象生命周期。尤其：

*   毫无意义地创建对象*会*降低性能。特别是，垃圾收集器速度很快但不是免费的。在编写代码时寻找减少内存使用的*简单*方法，但在发现问题之前进行微优化也是不好的。
*   通过使对象的可访问时间超出您的预期，可能会“泄漏”内存。造成这种情况的两个相当常见的原因是静态变量和事件订阅。（事件订阅使事件处理程序可以从事件发布者访问，但反之则不行。）
*   如果您使用的内存（以实时、可访问的方式）超过可用内存，您的应用程序将会崩溃。.NET 无法阻止这种情况发生！
*   使用非内存资源的对象通常实现[`IDisposable`](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx). `Dispose`当您完成对象时，您应该呼吁他们释放这些资源。请注意，这*不会*释放对象本身 - 只有垃圾收集器可以这样做。C# 中的`using`语句是可靠调用的最便捷方式`Dispose`，即使在遇到异常时也是如此。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-13T02:10:47.783

其他答案是正确的，除非您的对象是实现`IDisposable`接口的类的实例，在这种情况下，您应该（显式地或通过`using`语句隐式地）调用对象的`Dispose`方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-13T02:10:11.730

在优化的代码中，MyObject 有可能在方法结束之前被收集。默认情况下，Visual Studio 中的调试配置将在调试开关打开和优化开关关闭的情况下构建，这意味着 MyObject 将保留到方法的末尾（以便您可以在调试时查看值）。关闭优化的构建（在这种情况下调试无关紧要）允许在确定未使用 MyObject 后收集它。强制它保持活动到方法结束的一种方法是在方法结束时调用 GC.KeepAlive(MyObject) 。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-13T04:19:44.650

这将迫使垃圾收集器摆脱未使用的对象。

```
GC.Collect();
GC.WaitForPendingFinalizers(); 
```

如果要收集特定对象。

```
object A = new Object();
...
A = null;
GC.collect();
GC.WaitForPendingFinalizers(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-13T01:57:17.923

它会自动得到照顾。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-13T03:29:24.833

通常可以依靠垃圾收集来进行清理，但是如果您的对象包含任何非托管资源（数据库连接、打开的文件等），您将需要显式关闭这些资源和/或执行对象上的 dispose 方法（如果它实现 IDisposable） . 这可能会导致错误，因此您需要小心处理这些类型的对象。在使用文件后简单地关闭文件并不总是足够的，因为关闭执行之前的异常将使文件保持打开状态。使用 using 块或 try-finally 块。

底线：“使用”是你的朋友。

# c# - 检测诚实的网络爬虫

> ID：544450
> 
> 赞同：45
> 
> 时间：2009-02-13T01:55:33.483
> 
> 标签：c#, web-crawler, bots

我想检测（在服务器端）哪些请求来自机器人。在这一点上，我不关心恶意机器人，只关心那些玩得很好的机器人。我见过一些方法，主要涉及将用户代理字符串与“bot”等关键字进行匹配。但这似乎很尴尬，不完整且无法维护。那么有人有更可靠的方法吗？如果没有，您是否有任何资源用于与所有友好的用户代理保持同步？

如果你很好奇：我不会试图做任何违反任何搜索引擎政策的事情。我们有一个网站部分，用户会随机看到几个稍微不同的页面版本之一。但是，如果检测到网络爬虫，我们将始终为它们提供相同的版本，以使索引保持一致。

我也在使用 Java，但我想这种方法对于任何服务器端技术都是相似的。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2013-01-26T10:27:55.743

你说在“bot”上匹配用户代理可能很尴尬，但我们发现它是一个很好的匹配。我们的研究表明，它将覆盖您收到的大约 98% 的点击。我们也没有遇到任何误报匹配。如果您想将其提高到 99.9%，您可以添加一些其他著名的匹配项，例如“crawler”、“baiduspider”、“ia_archiver”、“curl”等。我们已经在我们的生产系统上测试了数百万个点击数。

这里有一些 c# 解决方案给你：

### 1) 最简单的

处理未命中时最快。即来自非机器人的流量——普通用户。捕获 99+% 的爬虫。

```
bool iscrawler = Regex.IsMatch(Request.UserAgent, @"bot|crawler|baiduspider|80legs|ia_archiver|voyager|curl|wget|yahoo! slurp|mediapartners-google", RegexOptions.IgnoreCase); 
```

### 2) 中等

处理命中时最快。即来自机器人的流量。错过也很快。捕获接近 100% 的爬虫。匹配“bot”、“crawler”、“spider”。您可以向其中添加任何其他已知的爬虫。

```
List<string> Crawlers3 = new List<string>()
{
    "bot","crawler","spider","80legs","baidu","yahoo! slurp","ia_archiver","mediapartners-google",
    "lwp-trivial","nederland.zoek","ahoy","anthill","appie","arale","araneo","ariadne",            
    "atn_worldwide","atomz","bjaaland","ukonline","calif","combine","cosmos","cusco",
    "cyberspyder","digger","grabber","downloadexpress","ecollector","ebiness","esculapio",
    "esther","felix ide","hamahakki","kit-fireball","fouineur","freecrawl","desertrealm",
    "gcreep","golem","griffon","gromit","gulliver","gulper","whowhere","havindex","hotwired",
    "htdig","ingrid","informant","inspectorwww","iron33","teoma","ask jeeves","jeeves",
    "image.kapsi.net","kdd-explorer","label-grabber","larbin","linkidator","linkwalker",
    "lockon","marvin","mattie","mediafox","merzscope","nec-meshexplorer","udmsearch","moget",
    "motor","muncher","muninn","muscatferret","mwdsearch","sharp-info-agent","webmechanic",
    "netscoop","newscan-online","objectssearch","orbsearch","packrat","pageboy","parasite",
    "patric","pegasus","phpdig","piltdownman","pimptrain","plumtreewebaccessor","getterrobo-plus",
    "raven","roadrunner","robbie","robocrawl","robofox","webbandit","scooter","search-au",
    "searchprocess","senrigan","shagseeker","site valet","skymob","slurp","snooper","speedy",
    "curl_image_client","suke","www.sygol.com","tach_bw","templeton","titin","topiclink","udmsearch",
    "urlck","valkyrie libwww-perl","verticrawl","victoria","webscout","voyager","crawlpaper",
    "webcatcher","t-h-u-n-d-e-r-s-t-o-n-e","webmoose","pagesinventory","webquest","webreaper",
    "webwalker","winona","occam","robi","fdse","jobo","rhcs","gazz","dwcp","yeti","fido","wlm",
    "wolp","wwwc","xget","legs","curl","webs","wget","sift","cmc"
};
string ua = Request.UserAgent.ToLower();
bool iscrawler = Crawlers3.Exists(x => ua.Contains(x)); 
```

### 3）偏执狂

相当快，但比选项 1 和 2 慢一点。它是最准确的，并且允许您根据需要维护列表。如果您担心将来出现误报，您可以维护一个单独的名称列表，其中包含“bot”。如果我们得到一个简短的匹配，我们会记录它并检查它是否有误报。

```
// crawlers that have 'bot' in their useragent
List<string> Crawlers1 = new List<string>()
{
    "googlebot","bingbot","yandexbot","ahrefsbot","msnbot","linkedinbot","exabot","compspybot",
    "yesupbot","paperlibot","tweetmemebot","semrushbot","gigabot","voilabot","adsbot-google",
    "botlink","alkalinebot","araybot","undrip bot","borg-bot","boxseabot","yodaobot","admedia bot",
    "ezooms.bot","confuzzledbot","coolbot","internet cruiser robot","yolinkbot","diibot","musobot",
    "dragonbot","elfinbot","wikiobot","twitterbot","contextad bot","hambot","iajabot","news bot",
    "irobot","socialradarbot","ko_yappo_robot","skimbot","psbot","rixbot","seznambot","careerbot",
    "simbot","solbot","mail.ru_bot","spiderbot","blekkobot","bitlybot","techbot","void-bot",
    "vwbot_k","diffbot","friendfeedbot","archive.org_bot","woriobot","crystalsemanticsbot","wepbot",
    "spbot","tweetedtimes bot","mj12bot","who.is bot","psbot","robot","jbot","bbot","bot"
};

// crawlers that don't have 'bot' in their useragent
List<string> Crawlers2 = new List<string>()
{
    "baiduspider","80legs","baidu","yahoo! slurp","ia_archiver","mediapartners-google","lwp-trivial",
    "nederland.zoek","ahoy","anthill","appie","arale","araneo","ariadne","atn_worldwide","atomz",
    "bjaaland","ukonline","bspider","calif","christcrawler","combine","cosmos","cusco","cyberspyder",
    "cydralspider","digger","grabber","downloadexpress","ecollector","ebiness","esculapio","esther",
    "fastcrawler","felix ide","hamahakki","kit-fireball","fouineur","freecrawl","desertrealm",
    "gammaspider","gcreep","golem","griffon","gromit","gulliver","gulper","whowhere","portalbspider",
    "havindex","hotwired","htdig","ingrid","informant","infospiders","inspectorwww","iron33",
    "jcrawler","teoma","ask jeeves","jeeves","image.kapsi.net","kdd-explorer","label-grabber",
    "larbin","linkidator","linkwalker","lockon","logo_gif_crawler","marvin","mattie","mediafox",
    "merzscope","nec-meshexplorer","mindcrawler","udmsearch","moget","motor","muncher","muninn",
    "muscatferret","mwdsearch","sharp-info-agent","webmechanic","netscoop","newscan-online",
    "objectssearch","orbsearch","packrat","pageboy","parasite","patric","pegasus","perlcrawler",
    "phpdig","piltdownman","pimptrain","pjspider","plumtreewebaccessor","getterrobo-plus","raven",
    "roadrunner","robbie","robocrawl","robofox","webbandit","scooter","search-au","searchprocess",
    "senrigan","shagseeker","site valet","skymob","slcrawler","slurp","snooper","speedy",
    "spider_monkey","spiderline","curl_image_client","suke","www.sygol.com","tach_bw","templeton",
    "titin","topiclink","udmsearch","urlck","valkyrie libwww-perl","verticrawl","victoria",
    "webscout","voyager","crawlpaper","wapspider","webcatcher","t-h-u-n-d-e-r-s-t-o-n-e",
    "webmoose","pagesinventory","webquest","webreaper","webspider","webwalker","winona","occam",
    "robi","fdse","jobo","rhcs","gazz","dwcp","yeti","crawler","fido","wlm","wolp","wwwc","xget",
    "legs","curl","webs","wget","sift","cmc"
};

string ua = Request.UserAgent.ToLower();
string match = null;

if (ua.Contains("bot")) match = Crawlers1.FirstOrDefault(x => ua.Contains(x));
else match = Crawlers2.FirstOrDefault(x => ua.Contains(x));

if (match != null && match.Length < 5) Log("Possible new crawler found: ", ua);

bool iscrawler = match != null; 
```

**笔记：**

*   继续向正则表达式选项 1 添加名称是很诱人的。但如果你这样做，它会变得更慢。如果您想要更完整的列表，那么带有 lambda 的 linq 会更快。
*   确保 .ToLower() 在您的 linq 方法之外——记住该方法是一个循环，您将在每次迭代期间修改字符串。
*   始终将最重的机器人放在列表的开头，以便它们更快地匹配。
*   将列表放入静态类中，这样它们就不会在每次页面浏览时重新构建。

**蜜罐**

唯一真正的替代方法是在您的网站上创建一个只有机器人才能访问的“蜜罐”链接。然后，您将访问蜜罐页面的用户代理字符串记录到数据库中。然后，您可以使用这些记录的字符串对爬虫进行分类。

`Postives:`它将匹配一些未声明自己的未知爬虫。

`Negatives:`并非所有爬虫都深入挖掘到足以访问您网站上的每个链接，因此它们可能无法到达您的蜜罐。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-02-13T02:12:00.400

您可以在 robotstxt.org[机器人数据库中找到关于已知“良好”网络爬虫的非常全面的数据数据库](http://www.robotstxt.org/db.html)。利用这些数据将比仅在用户代理中匹配*机器人更有效。*

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-13T02:18:43.473

一个建议是在您的页面上创建一个只有机器人会跟随的空锚点。普通用户看不到链接，留下蜘蛛和机器人跟随。例如，指向子文件夹的空锚标记将在您的日志中记录获取请求...

```
<a href="dontfollowme.aspx"></a> 
```

许多人在运行 HoneyPot 时使用此方法来捕获未遵循 robots.txt 文件的恶意机器人。[我在编写的ASP.NET 蜜罐解决方案](http://gatekeeper.codeplex.com)中使用空锚方法来捕获和阻止那些令人毛骨悚然的爬虫......

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-13T02:06:57.323

任何入口页面为 /robots.txt 的访问者都可能是机器人。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-06-25T22:43:04.757

像这样快速而肮脏的东西可能是一个好的开始：

```
return if request.user_agent =~ /googlebot|msnbot|baidu|curl|wget|Mediapartners-Google|slurp|ia_archiver|Gigabot|libwww-perl|lwp-trivial/i 
```

注意：rails 代码，但正则表达式通常适用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-21T07:57:13.890

我很确定大部分机器人不使用 robots.txt，但这是我的第一个想法。

在我看来，检测机器人的最佳方法是使用请求之间的时间，如果请求之间的时间一直很快，那么它就是一个机器人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-13T10:13:43.663

```
void CheckBrowserCaps()
    {
        String labelText = "";
        System.Web.HttpBrowserCapabilities myBrowserCaps = Request.Browser;
        if (((System.Web.Configuration.HttpCapabilitiesBase)myBrowserCaps).Crawler)
        {
            labelText = "Browser is a search engine.";
        }
        else
        {
            labelText = "Browser is not a search engine.";
        }

        Label1.Text = labelText;
    } 
```

[HttpCapabilitiesBase.Crawler 属性](https://docs.microsoft.com/en-us/dotnet/api/system.web.configuration.httpcapabilitiesbase.crawler?redirectedfrom=MSDN&view=netframework-4.8)

# c++ - 全局变量和范围 - C++

> ID：544462
> 
> 赞同：5
> 
> 时间：2009-02-13T02:01:44.777
> 
> 标签：c++, variables, global-variables, scope

我在制作全局变量时遇到了小问题。我正在使用 Visual Studio 2008 和标准 C++。

我有两个项目，一个是静态库，第二个是使用这个库的测试程序。我在 global.h 中有一个全局变量，例如

```
#ifndef GLOBAL_H
#define GLOBAL_H

#include <string>

extern std::string globalWord;

#endif // GLOBAL_H! 
```

我有一个 global.cpp 我正在初始化这个变量。这个变量在我的库项目中使用。我正在从测试项目中为这个变量设置一个值，但该值没有反映在库项目中。

我已经调试过，它在测试项目中显示了新值，但是当控件到达库项目时，这个变量值显示为空。那么这个全局变量的作用域是否仅限于它所属的项目呢？

还是有更好的方法来做到这一点？我不想修改我的库中的函数或构造函数参数来传递这个值。

任何帮助都会很棒。

编辑：

这是这个变量在 global.cpp 中的声明方式

```
#include <string>
#include "../global.h"

std::string globalWord = ""; 
```

这就是我在图书馆中使用它的方式

```
#include "../global.h"
string text = globalWord; 
```

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-13T02:13:22.207

不要使用全局变量。只是不要。更好的是，如果您必须拥有全局可访问的数据，则使用将返回 globalWord 的全局函数，如下所示：

```
std::string globalWord()
{
    static std::string word("Hi Mom");
    return word;
} 
```

这样可以避免初始化顺序问题（阅读 Effective C++ item #4）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-13T02:11:17.580

使用“extern”关键字，您是在告诉编译器实际变量存在于其他地方。**您还应该在一个且只有一个**地方创建一个没有外部变量的同名变量。通常，如果定义其中两个，链接器会出现错误，但如果一个在库中，一个不在库中，则可能无法识别。

编辑：确保 global.cpp 仅在库或测试程序中，而不是两者。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-13T02:27:36.650

问题很可能是初始化顺序之一。程序链接时，初始化有2个地方`globalWord`用到：

1.  在`text`( `"string text = globalWord;`")的初始化中
2.  `globalWord`自身的初始化

不幸的是，C++ 标准没有指定来自不同模块的全局变量的初始化顺序。类似于[Matt 的](https://stackoverflow.com/questions/544462/global-variables-and-scope-c/544488#544488)使用函数或简单类（例如单例）来访问全局值的答案是强制执行特定初始化顺序的常用方法。

[C++ 常见问题解答对此进行了一些讨论](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.12)-如果您打算`globalWord`在程序中进行修改，情况会比他们讨论的要复杂一些，因为它们似乎没有解决设置隐藏在“首次使用时构造”功能后面的值的问题. 通常这样的事情需要[像单例类这样的东西](http://www.inquiry.com/techtips/cpp_pro/10min/10min0200.asp)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-13T02:32:25.360

当你有一个 DLL 时，你描述的那种行为似乎更像是一个问题，但是你说你的库是静态的，这看起来很奇怪。

无论如何，请注意多个库中的全局变量，如果您有一个共享代码库 (DLL)，您将获得每个部分的值。看看[这个](https://stackoverflow.com/questions/75701/what-happens-to-global-variables-declared-in-a-dll)问题，可能会有用。

# iphone - 您将如何在 iPhone 应用程序中保护机密数据？

> ID：544463
> 
> 赞同：38
> 
> 时间：2009-02-13T02:02:20.597
> 
> 标签：iphone, security, cryptography

假设我需要从 iPhone 应用程序访问 Web 服务。此 Web 服务要求客户​​端对 HTTP 请求进行数字签名，以证明应用程序“知道”共享密钥；客户端密钥。请求签名存储在 HTTP 标头中，请求只是通过 HTTP（不是 HTTPS）发送。

此密钥必须始终保密，但需要由 iPhone 应用程序使用。

那么，鉴于您一直被告知永远不要在客户端存储任何敏感信息，您将如何安全地存储此密钥？

普通用户（99% 的用户）会很乐意使用该应用程序。会有人（敌人？）想要该秘密客户端密钥，以便通过冒充的方式对服务或客户端密钥所有者造成伤害。这样的人可能会越狱他们的手机，访问二进制文件，运行“字符串”或十六进制编辑器并四处寻找。因此，仅将密钥存储在源代码中是一个糟糕的主意。

另一个想法是将密钥存储在代码中，而不是字符串文字，而是存储在从字节文字创建的 NSMutableArray 中。

一个人可以使用钥匙串，但由于 iPhone 应用程序永远不必提供密码来存储钥匙串中的东西，我担心有权访问应用程序沙箱的人可以并且将能够简单地查看或简单地解码其中的项目。

编辑 - 所以我读到了关于钥匙串的内容：“在 iPhone OS 中，应用程序始终可以访问自己的钥匙串项目，而无法访问任何其他应用程序的项目。系统为钥匙串生成自己的密码，并存储密钥以任何应用程序都无法访问的方式在设备上。”

所以也许这是存储密钥的最佳位置......如果是这样，我如何将预先输入到应用程序钥匙串中的密钥发送？那可能吗？否则，如果密钥不在源代码中，您如何在首次启动时添加密钥？唔..

[编辑 - 在http://bugreport.apple.com](http://bugreport.apple.com)提交错误报告 # 6584858

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-13T03:25:28.243

最终目标是限制授权用户访问 Web 服务，对吗？如果您控制 Web 服务（如果您不控制 - 将其包装在您可以控制的 Web 服务中），则非常容易。

1) 创建一个公钥/私钥对。私钥放在网络服务服务器上，该服务器被放置在地牢中并由一条龙守卫。公钥在电话上。如果有人能够读取公钥，**这不是问题**。

2) 让应用程序的每个副本生成一个唯一标识符。你如何做到这一点取决于你。例如，您可以在下载时将其构建到可执行文件中（这对于 iPhone 应用程序是否可行）？您可以使用手机的 GUID，假设他们有一种计算方法。如果你真的想要，你也可以在每个会话中重做这个。

3）使用公钥加密“我的唯一标识符是$FOO，我批准了这个消息”。将其与对 Web 服务的每个请求一起提交。

4) Web 服务解密每个请求，反弹任何不包含有效标识符的请求。您可以在这里做尽可能多或尽可能少的工作：保留白名单/黑名单、监控每个标识符的使用情况以及调查可疑行为等。

5) 由于唯一标识符现在永远不会通过线路发送，因此破坏它的唯一方法是对电话进行物理访问。 **如果他们可以物理访问手机，您将无法控制手机上任何位置的任何数据**。总是。没办法。这就是为什么我们构建了这样一个系统，即损害一部手机永远不会损害一个以上的帐户。

6) 构建业务流程以满足以下需求：a) 删除滥用它的用户的访问权限，以及 b) 恢复对电话受到物理损害的用户的访问权限（这将非常非常罕见，除非用户是对手）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-11-05T20:13:55.963

简单的答案是，就目前的情况而言，在 iPhone 上保守秘密是不可能的。越狱的 iPhone 只是一台适合您手中的通用计算机。没有您可以访问的可信平台硬件。用户可以欺骗任何你能想象到的用来唯一标识给定设备的东西。用户可以将代码注入您的进程以执行检查钥匙串等操作。（搜索 MobileSubstrate 以了解我的意思。）对不起，你搞砸了。

在这种情况下，应用程序购买收据是一道曙光。如果您使用应用内购买在您的应用中销售商品，您将获得一张经过加密签名的收据，并且可以根据需要通过 Apple 进行验证。即使您无法对收据保密，它*也*可以（由 Apple，而不是您）追踪到特定购买，这可能会阻止盗版者分享它们。您还可以根据每个收据限制对服务器的访问，以防止您的服务器资源被盗版者耗尽。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-14T03:52:10.403

[UAObfuscatedString](https://github.com/UrbanApps/UAObfuscatedString)可以解决您的问题。从文档：

> 当您编写包含字符串常量的代码时，该字符串以明文形式保存在二进制文件中。黑客可能会发现漏洞或更改字符串以影响您的应用程序的行为。UAObfuscatedString 只在二进制文件中存储单个字符，然后在运行时将它们组合起来生成你的字符串。这些单个字母不太可能在二进制文件中被发现，因为它们会在编译代码中的随机位置插入。因此，对于任何试图提取字符串的人来说，它们似乎都是随机代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T00:25:57.703

如果您可以忍受只使用 iPhone OS 3.0，您可能需要查看推送通知。我无法详细说明，但您可以将有效负载与通知本身一起发送到 Apple 的服务器。当他们接受警报时（或者如果您的应用程序正在运行），则会调用您的代码的某些部分并存储钥匙串项。在这一点上，这是我能想到的在 iPhone 上安全存储秘密的唯一途径。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-10-13T14:33:21.343

我有同样的问题，并花了很多时间四处寻找答案。问题是先有鸡还是先有蛋：如何使用您的应用所需的数据预先填充钥匙串。

无论如何，我发现了一种技术，至少会让越狱者更难发现信息——他们至少必须反汇编你的代码才能找出你做了什么来掩盖信息：

[字符串混淆](http://iphonedevelopertips.com/cocoa/obfuscation-encryption-of-string-nsstring.html)（如果链接中断搜索“混淆/加密字符串（NSString）”）

本质上，该字符串在放入应用程序之前已被混淆，然后您使用代码对其进行解混淆。

总比什么都不做要好。

大卫

编辑：我实际上在应用程序中使用了它。我将一个基本编码字符串放入 info.plist，然后在代码中对其进行了几项操作 - rot13、旋转/反转字节等。最终处理的字符串用于解码混淆字符串。现在，这三个字母机构肯定可以打破这一点——但要花费数小时解码二进制文件的巨大成本。

我想说这是我遇到的最好的技术，但我刚刚阅读了 Kiran 关于**UAObfuscatedString**的帖子（不同的答案），这是一种完全不同的混淆方式。它的好处是在应用程序的任何地方都没有保存字符串——每个字母都变成了一个方法调用。选择器将显示为字符串，因此黑客可以快速判断您的类使用了该技术。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T00:08:39.520

我认为[这个类似的问题](https://stackoverflow.com/questions/357491/iphone-client-certificate)以及我的[回答](https://stackoverflow.com/questions/357491/iphone-client-certificate/357546#357546)也可能与您的情况有关。简而言之，有一些关于 iPhone 中存在可信平台模块的讨论。这将允许您的服务信任 iPhone，即使在攻击者手中。但是，看起来使用钥匙串是您最好的选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-24T07:41:35.560

您是否考虑过/尝试过推送通知建议，以便最初将秘密传输到应用程序和钥匙串？还是最终找到其他方法来实现这一目标？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-13T00:21:29.463

我要让我的 iphone 应用程序将图像上传到 Amazon S3。我不会将 AWS 凭证放在应用程序中，而是将应用程序电话放在我的服务器上，以便在 S3 上传请求中使用 URI 和标头。我的服务器将生成 S3 URI、正确的签名等。然后我可以在我的应用程序的 Web 服务上实施比 AWS 本身提供的更严格、更具体的安全模型，并且不会将我的 AWS 密钥泄露给任何拥有越狱 iPhone 的人。

但是仍然必须给应用程序一些信任（证书或其他），并且这种信任可能会被窃取。*如果有人越狱 iPhone 并窃取应用程序中的任何凭据，您所能做的就是限制造成的损害。*这些凭据越强大，情况就越糟糕。限制凭证权力的方法包括：

*   避免全局凭据。使它们按用户/应用程序
*   避免永久凭证。如果可能的话，让它们成为临时的
*   避免全局权限。只给他们他们需要的权限。例如，写入权限可以分解为插入、覆盖、删除、写入资源组 A 或 B 等，而读取可以分解为读取命名资源、读取所有现有资源的列表、读取资源组 A 或 B ， ETC。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-02-13T02:09:15.617

听起来很奇怪。将使用 HTTPS 和加密包来处理密钥。

我认为 CommonCrypto 可用于 iPhone。

编辑：听起来还是很奇怪。为什么有人会在 HTTP 标头中传递密钥？任何跟踪您的网络流量（例如通过记录 wifi 路由器）的人都会看到它。

有用于加密消息流量的完善的安全方法......为什么不使用它们而不是发明基本上是一个有微不足道的系统？

编辑二：啊，我明白了。我会继续使用钥匙串......我认为它仅适用于这类情况。我错过了您正在使用密钥生成请求。如果可以的话，我仍然会使用 HTTPS，因为这样你就不会冒险让人们通过检查足够的签名来推断你的密钥生成方案。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-02-13T02:12:30.417

如果可能，我建议在运行时创建一个密钥。这样，如果密钥在特定会话期间被抓获，一旦会话结束，密钥将一文不值。如果他们足够聪明，他们仍然可以从记忆中理解密钥，但没关系，因为密钥会在一段时间后失效。

# language-agnostic - 使用 TDD 开发接口

> ID：544472
> 
> 赞同：4
> 
> 时间：2009-02-13T02:07:27.447
> 
> 标签：language-agnostic, tdd, polymorphism

我是 TDD 的忠实拥护者，并且这些天在我的绝大多数开发中都使用它。但是，我经常遇到的一种情况，并且从未找到我认为是“好的”答案的情况，类似于以下（人为的）示例。

假设我有一个像这样的接口（用 Java 编写，但实际上，这适用于任何 OO 语言）：

```
public interface PathFinder {
    GraphNode[] getShortestPath(GraphNode start, GraphNode goal);

    int getShortestPathLength(GraphNode start, GraphNode goal);
} 
```

现在，假设我想创建这个接口的三个实现。我们称它们`DijkstraPathFinder`为 、`DepthFirstPathFinder`和`AStarPathFinder`。

问题是，如何使用 TDD 开发这三个实现？它们的公共接口将是相同的，并且大概我会为每个接口编写相同的测试，因为 getShortestPath() 和 getShortestPathLength() 的结果在所有三个实现中应该是一致的。

我的选择似乎是：

1.  `PathFinder`当我编写第一个实现时，编写一组测试。然后“盲目”编写其他两个实现并确保它们通过`PathFinder`测试。这似乎不对，因为我没有使用 TDD 来开发后两个实现类。

2.  以测试优先的方式开发每个实现类。这似乎不对，因为我将为每个班级编写相同的测试。

3.  结合上述两种技术；现在我有一组针对接口的测试和一组针对每个实现类的测试，这很好，但是测试都是一样的，这不是很好。

这似乎是一种相当普遍的情况，尤其是在实现策略模式时，当然实现之间的差异可能不仅仅是时间复杂度。其他人如何处理这种情况？是否有针对我不知道的接口进行测试优先开发的模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T02:17:02.980

您编写接口测试来运行接口，并为实际实现编写更详细的测试。[基于接口的设计](https://rads.stackoverflow.com/amzn/click/com/0976694050)谈到了这样一个事实，即您的单元测试应该为该接口形成一种“合同”规范。也许当 Spec# 出来时，会有一种语言支持的方式来做到这一点。

在这种特殊情况下，这是一个严格的策略实现，接口测试就足够了。在其他情况下，接口是实现功能的子集，您将对接口和实现进行测试。例如，考虑一个实现 3 个接口的类。

编辑：这很有用，因此当您添加接口的另一个实现时，您已经有测试来验证该类是否正确实现了接口的契约。这可以适用于像 ISortingStrategy 这样特定的东西，也适用于像 IDisposable 这样广泛的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T03:07:12.703

针对接口编写测试并为每个实现重用它们没有任何问题，例如 -

```
public class TestPathFinder : TestClass
{
    public IPathFinder _pathFinder;
    public IGraphNode _startNode;
    public IGraphNode _goalNode;

    public TestPathFinder() : this(null,null,null) { }
    public TestPathFinder(IPathFinder ipf, 
        IGraphNode start, IGraphNode goal) : base()
    {
        _pathFinder = ipf;
        _startNode = start;
        _goalNode = goal;
    }
}

TestPathFinder tpfDijkstra = new TestPathFinder(
    new DijkstraPathFinder(), n1, nN);
tpfDijkstra.RunTests();

//etc. - factory optional 
```

我认为这是*最省力*的解决方案，非常符合敏捷/TDD 原则。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T05:20:58.543

使用选项 1 没有问题，请记住，重构是 TDD 的一部分，通常在重构阶段你会转向策略等设计模式，所以我不会因为这样做而感到难过/ o 编写新的测试。

如果您想测试每个 PathFinder impl 的特定于实现的细节，您可以考虑传递模拟 GraphNode，这些 GraphNode 能够以某种方式帮助断言实现的 Dijkstra-ness 或 DepthFirst-ness 等。（也许这些模拟 GraphNode 可以记录它们是如何被遍历的，或者以某种方式测量性能。）也许这是测试过度，但是如果你知道你的系统出于某种原因需要这三种不同的策略，那么进行测试可能会很好证明原因 - 否则为什么不只选择一个实现并将其他实现扔掉？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T03:10:22.773

我不介意重用测试代码作为具有类似功能的新测试的模板。根据所测试的特定类，您可能必须使用不同的模拟对象和期望来重新设计它们。至少你必须重构它们以使用新的实现。不过，我会遵循 TDD 方法，即进行一项测试，为新类重新编写它，然后只编写代码以通过该测试。但是，这可能需要更多的纪律，因为您已经有了一个实现，并且无疑会受到您已经编写的代码的影响。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-13T07:14:09.753

> 这似乎不对，因为我没有使用 TDD 来开发后两个实现类。

你当然是。

首先注释掉除一个之外的所有测试。当您使测试通过时，重构或取消注释另一个测试。

联通

# session - 你能帮我理解这个吗？“常见的 REST 错误：会话无关紧要”

> ID：544474
> 
> 赞同：161
> 
> 时间：2009-02-13T02:07:55.917
> 
> 标签：session, rest

免责声明：我是 REST 学派的新手，我正试图围绕它展开思考。

所以，我正在阅读这个页面，[常见的 REST 错误](http://prescod.net/rest/mistakes/)，我发现我完全被关于会话无关的部分所迷惑。这是页面上所说的：

> 客户端应该不需要“登录”或“开始连接”。HTTP 身份验证在每条消息上自动完成。客户端应用程序是资源的消费者，而不是服务。因此没有什么可以登录的！假设您要在 REST Web 服务上预订航班。您不会创建与服务的新“会话”连接。相反，您要求“行程创建者对象”为您创建一个新行程。您可以开始填写空白，然后在网络上的其他地方获取一些完全不同的组件来填写其他空白。没有会话，因此在客户端之间迁移会话状态没有问题。也不存在“会话亲和性”的问题

好的，我知道每条消息都会自动完成 HTTP 身份验证 - 但是如何呢？用户名/密码是否随每个请求一起发送？这不只是增加了攻击面吗？我觉得我错过了拼图的一部分。

`/session`拥有一个接受 GET 请求的 REST 服务会很糟糕吗与后续请求一起传递？从 REST 的角度来看，这是否有意义，还是没有抓住重点？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-02-13T02:43:24.553

要成为 RESTful，每个 HTTP 请求本身都应携带足够的信息，以便其接收者对其进行处理，以与 HTTP 的无状态特性完全一致。

> 好的，我知道每条消息都会自动完成 HTTP 身份验证 - 但是如何呢？

是的，用户名和密码随每个请求一起发送。这样做的常用方法是**基本访问身份验证**和**摘要访问身份验证**。是的，窃听者可以捕获用户的凭据。**因此，人们将使用传输层安全性 (TLS)**对发送和接收的所有数据进行加密。

> 拥有一个接受 GET 请求的 REST 服务（例如 /session）会很糟糕，您可以在其中将用户名/密码作为请求的一部分传递，并在身份验证成功时返回会话令牌，这可以然后与后续请求一起传递？从 REST 的角度来看，这是否有意义，还是没有抓住重点？

这不是**RESTful**，因为它带有状态，但它很常见，因为它为用户提供了便利；用户不必每次都登录。

您在“会话令牌”中描述的内容通常称为**登录 cookie**。例如，如果您尝试登录 Yahoo! 帐户有一个复选框，上面写着“让我登录 2 周”。这本质上是说（用你的话来说）“如果我成功登录，让我的会话令牌保持活动状态 2 周。” Web 浏览器将在您要求它为您发出的每个 HTTP 请求中发送此类登录 cookie（可能还有其他）。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-02-13T02:33:12.503

REST 服务要求对每个 HTTP 请求进行身份验证的情况并不少见。例如，Amazon S3 要求每个请求都具有从用户凭证、要执行的确切请求和当前时间派生的签名。这个签名在客户端很容易计算，可以被服务器快速验证，对拦截它的攻击者使用有限（因为它是基于当前时间的）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-02-12T20:39:08.057

许多人不太清楚 REST 原则，使用会话令牌并不意味着您总是有状态的，每个请求发送用户名/密码的原因仅用于身份验证，发送令牌也是如此（由登录生成过程）只是为了决定客户端是否有权请求数据，当您使用用户名/密码或会话令牌来决定要显示哪些数据时，您只会违反 REST 约定！相反，您必须仅将它们用于身份验证（显示数据或不显示数据）

在您的情况下，我说是的，这是 RESTy，但请尝试避免在您的 REST API 中使用本机 php 会话，并开始生成您自己的散列令牌，这些令牌在确定的时间段内到期！

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-07-18T09:34:03.073

不，它没有错过重点。Google 的[ClientLogin](http://code.google.com/intl/no/apis/accounts/docs/AuthForInstalledApps.html)正是以这种方式工作的，但值得注意的例外是客户端被指示使用 HTTP 401 响应进入“/session”。但这不会创建会话，它只会为客户端（临时）在不以明文方式传递凭据的情况下进行身份验证，并让服务器在它认为合适的情况下控制这些临时凭据的有效性。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-13T12:45:41.000

> 好的，我知道每条消息都会自动完成 HTTP 身份验证 - 但是如何呢？

“授权：”客户端发送的 HTTP 标头。基本（纯文本）或摘要。

> 拥有一个接受 GET 请求的 REST 服务（例如 /session）会很糟糕，您可以在其中将用户名/密码作为请求的一部分传递，并在身份验证成功时返回会话令牌，这可以然后与后续请求一起传递？从 REST 的角度来看，这是否有意义，还是没有抓住重点？

会话的整个想法是通过在服务器端维护状态来使用无状态协议（HTTP）和哑客户端（Web 浏览器）来制作**有状态的应用程序。**REST 原则之一是*“每个资源都可以使用用于超媒体链接的通用语法进行唯一寻址”*。会话变量是不能通过 URI 访问的东西。真正的 RESTful 应用程序将在客户端维护状态，通过 HTTP 发送所有必要的变量，最好是在 URI 中。

示例：分页搜索。您将在表单中有 URL

```
http://server/search/urlencoded-search-terms/page_num 
```

它与可收藏的 URL 有很多共同点

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-13T12:18:53.483

如果您想控制客户端会话的生命周期，我认为您的建议是可以的。我认为 RESTful 架构鼓励您开发无状态应用程序。正如@2pence 所写的那样*，“每个 HTTP 请求本身都应该携带足够的信息，以便其接收者对其进行处理，以与 HTTP 的无状态特性完全一致”*。

但是，情况并非总是如此，有时应用程序需要告知客户端何时登录或注销，并根据此信息维护诸如锁或许可证之类的资源。有关此类案例的示例，请参阅我的后续[问题。](https://stackoverflow.com/questions/545275/licenses-and-sessions-the-restful-way)

# c# - 基于 XAML 的关卡编辑器

> ID：544476
> 
> 赞同：2
> 
> 时间：2009-02-13T02:09:09.270
> 
> 标签：c#, silverlight, xaml

我想用 XAML 为 Silverlight 创建一个关卡编辑器。在开始这样的项目之前，哪些资源对研究有用？

这里有一些信息需要澄清。我制作了 1 个 silverlight 游戏并发布到现在。我想要一个架空风格的动作游戏。地图将比当前的可视空间大得多。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-13T03:03:19.653

WPF 有一个陡峭的学习曲线，不要灰心，它很棒，但是它有很多角落，需要一段时间才能适应。[首先， WPFDisciples](http://wpfdisciples.wordpress.com/)有一个非常好的博客社区，所有这些都值得一读。[Codeplex](http://www.codeplex.com/site/search?projectSearchText=wpf)有一些很好的 3D、物理引擎等库，逆向工程其他代码是学习的好方法。

一些好书是[Windows Presentation Foundation Unleashed](https://rads.stackoverflow.com/amzn/click/com/0672328917)和 Petzold 的[Applications = code + markup](https://rads.stackoverflow.com/amzn/click/com/0735619573)是少数几本书/地方之一，没有宣扬一切都必须在 Xaml 中完成

一个需要一些时间来适应的领域是[绑定](http://geekswithblogs.net/shahed/archive/2007/10/08/115938.aspx)，那里有很多东西，但它可能很复杂，而且在[你掌握魔法知识之前是不可能调试的](http://blogs.msdn.com/mikehillberg/archive/2006/09/14/WpfTraceSources.aspx)。WPF 中的绑定不仅仅是关于数据，它是关于将所有 UI 元素和行为链接在一起 - 这非常重要。

最后，您可以在 Silverlight 和 WPF 之间进行选择，它们并不相同。尽管 Silverlight 是 WPF 的一个很好的子集，但有些事情是您不能做的。

最后，如果您有图形设计、艺术家背景，请尝试使用[Blend](http://www.microsoft.com/expression/products/Overview.aspx?key=blend)，而不是 VS，对于那些有视觉意识的人来说，它是一个更好的工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T02:30:24.523

显然，如果您还没有掌握 XAML 以及如何将其作为一个概念来使用，那么这很重要。它的概述（以 WPF 为例）可以在 MSDN 上找到，[以及](http://msdn.microsoft.com/en-us/library/ms752059.aspx)System.Windows.Markup[命名空间](http://msdn.microsoft.com/en-us/library/system.windows.markup.aspx)，其中包含您将用于使用它的类。

# sql - 如何将 Sql Int 值拆分为多行

> ID：544477
> 
> 赞同：7
> 
> 时间：2009-02-13T02:09:10.220
> 
> 标签：sql

假设我在 MS SQL 2000 中有下表

```
Id | description | quantity |
-------------------------------
1    my desc          3
2    desc 2           2 
```

我需要根据数量显示多行，所以我需要以下输出：

```
Id | description | quantity |
-----------------------------
1    my desc          1
1    my desc          1
1    my desc          1
2    desc 2           1
2    desc 2           1 
```

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T04:47:49.433

这工作得很好，不需要任何光标。也有可能在没有数字表的情况下解决一些问题。

*请注意*，如果要使用这种解决方案，我会保留一个数字表，而不是每次运行查询时都重新创建它。

```
create table #splitme (Id int, description varchar(255), quantity int) 
insert #splitme values (1    ,'my desc',          3)
insert #splitme values (2    ,'desc 2',           2)

create table #numbers (num int identity primary key) 
declare @i int 
select @i = max(quantity) from #splitme
while @i > 0
begin   
    insert #numbers default values 
    set @i = @i - 1 
end

select Id, description, 1 from #splitme 
join #numbers on num <= quantity 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T02:20:15.717

```
DECLARE @Id INT
DECLARE @Description VARCHAR(32)
DECLARE @Quantity INT
DECLARE @Results TABLE (Id INT, [description] VARCHAR(32), quantity INT)
DECLARE MyCursor CURSOR FOR
    SELECT Id, [description], quantity
    FROM
        MyTable

OPEN MyCursor

FETCH NEXT FROM MyCursor INTO @Id, @Description, @Quantity

WHILE @@FETCH_STATUS = 0
BEGIN
    WHILE @Quantity > 0
    BEGIN
        INSERT INTO @Results (
            Id,
            [description],
            quantity
        ) VALUES (
            @Id,
            @Description,
            1
        )
        SET @Quantity = @Quantity - 1
    END
    FETCH NEXT FROM MyCursor INTO @Id, @Description, @Quantity
END

CLOSE MyCursor
DEALLOCATE MyCursor

SELECT *
FROM
    @Results 
```

顺便说一句，游标*通常*被认为是邪恶的。所以我都会反对这样的事情，并提前感谢大家的火焰;）（但它应该工作）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-10T20:29:07.677

任何寻找基于 CTE 的解决方案的人，这里有一个：

```
create table test_splitme (Id int, description varchar(255), quantity int) 

insert test_splitme values (1    ,'my desc',          3)

insert test_splitme values (2    ,'desc 2',           2)
;

--TSQL solution

with splitcte as(
select Id,description, 1 as quantity, quantity as orig_quantity, 1 as cnt

from test_splitme

union all 

select Id, description, quantity, orig_quantity,cnt+1

from splitcte

where cnt < orig_quantity
)

select  Id, description, quantity

from splitcte

order by 1 
```

# postgresql - 寻找使用 PostgreSQL DB 的工具

> ID：544493
> 
> 赞同：1
> 
> 时间：2009-02-13T02:15:32.297
> 
> 标签：postgresql

非常简单的问题（我希望如此），在使用 MySQL 数据库但用于 PostgreSQL 数据库时，是否存在类似于 phpMyAdmin 的工具？

我不只是在谷歌上搜索解决方案的原因是我对 PostgreSQL 的熟悉不如对 MySQL 的熟悉，我希望 SO 社区能够提供一个您有使用经验的工具。

提前感谢您的任何回复。:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-13T02:18:05.910

有一个类似的工具[phppgadmin](http://phppgadmin.sourceforge.net/)。布局与 phpmyadmin 有点不同，但我已经在我的一些 Web 服务器上使用过它，界面工作得非常好，而且同样有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-13T02:41:56.133

如果您更喜欢 GUI 应用程序，这非常好：

[http://www.pgadmin.org/features.php](http://www.pgadmin.org/features.php)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-15T15:14:45.877

[RazorSQL SQL GUI 工具](http://www.razorsql.com/)支持 PostgreSQL 和 MySQL 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T05:00:08.000

PgManager 3 是一个很好的管理任务（[www.pgadmin.org](http://www.pgadmin.org)）[不像 pgplsql dev 对开发任务那么好）。但是您甚至可以使用此工具处理 slony 复制。有一个商业的，用于 PostgreSQL 的 SQL Management Studio，它非常好，我一直在使用它，它在开发和管理任务中非常出色（[http://sqlmanager.net/en/products](http://sqlmanager.net/en/products)） . Navicat for PostgreSQL 是一个简单易用的管理工具，与 MySQL 非常相似。( [pgsql.navicat.com](http://pgsql.navicat.com) ) [商业] 我记得有几个，但现在我只记得那三个。

希望对你有帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-17T01:25:37.510

The [Tadpole DB Hub](https://github.com/hangum/TadpoleForDBTools/wiki) supoort PostgreSQL and Mysql, SQLite, MSSQL, Oracle, Mongodb... etc..

# java - 如何在 Windows 和 Java 下与 USB 设备通信？

> ID：544507
> 
> 赞同：21
> 
> 时间：2009-02-13T02:24:56.377
> 
> 标签：java, windows, usb

我想在 Windows 和 Java 下与 USB 设备通信，但我找不到一个好的库来这样做。我不希望用户必须安装任何额外的硬件或设备驱动程序才能完成这项工作。也就是说，我希望能够像其他 Windows 应用程序一样与 USB 交互。

我熟悉 jUSB 和 JSR 80，但两者似乎都是死项目（至少对于 Windows）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-13T09:11:49.050

libusb-win32 要求您安装他们的通用驱动程序，然后您可以使用 USB 设备。我不确定是否可以对 USB 设备进行无驱动程序访问，除非该设备属于几个标准类之一（特别是存储和 HID）。

libusb-win32有一个[Java 包装器，](http://sourceforge.net/projects/libusbjava/)它可能对您有用。不过我自己没用过。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-13T08:59:13.840

前段时间我对此进行了相当多的研究，不幸的事实是所有有用的免费 USB+Windows+Java 项目都死了。有商业和昂贵的（39.99 美元的价格不是每个开发人员，而是每个销售的软件副本！）[JCommUSB](http://www.icaste.com/)库可能可以工作，虽然我没有经验；我们必须为 USB 驱动程序构建我们自己的自定义 C 包装器，并通过 JNI 与它们通信。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T09:16:12.363

最快和最简单的方法是破解一些本机代码 :) 我为 HID 设备编写了一个小包装器，它使我的 Java 应用程序能够从 CalComp 数字化仪读取数据，所以它绝对是可行的，而且不太难。坏事是我的工作仍然是我的前雇主拥有的专有代码，所以出于法律原因，我不能将它作为开源发布——但。

好消息是您可以从 Microsoft DDK 中的 HID 示例代码开始飞速发展 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-07T23:30:16.067

Windows 与 USB 设备之间通过 java 进行通信。 [http://javausbapi.blogspot.com/2010/05/java-usb-api.html](http://javausbapi.blogspot.com/2010/05/java-usb-api.html)

以飞思卡尔微控制器为例

# java - Quartz 的库冲突

> ID：544514
> 
> 赞同：1
> 
> 时间：2009-02-13T02:27:47.150
> 
> 标签：java, quartz-scheduler, conflicting-libraries

有一个奇怪的情况。我将 Glassfish 服务器用于我的企业应用程序。在那个应用程序中，我使用 JSF、Richfaces、Quartz、Jasper Reports 和 Commons Email。当我构建应用程序并将其部署到我的开发人员时。计算机、开发和测试服务器，一切正常。但是当我使用相同的 glassfish 将应用程序部署到生产服务器时，我无法运行 Quartz 调度程序。它让我知道公共集合存在一些问题。我知道某处有冲突，但我找不到在哪里。你能给我一些指示在哪里看。顺便说一句，我使用的是 NetBeans 6.5。

这是日志：

```
[#|2009-02-13T02:00:03.055+0000|WARNING|sun-appserver9.1|javax.enterprise.resource.webcontainer.jsf.lifecycle|_ThreadID=22;_ThreadName=httpSSLWorkerThread-80-4;_RequestID=97d21f45-2489-486c-b8d9-68625776c546;|#{SchedulerController.play}: java.lang.NoSuchMethodError: org.apache.commons.collections.SetUtils.orderedSet(Ljava/util/Set;)Ljava/util/Set;
javax.faces.FacesException: #{SchedulerController.play}: java.lang.NoSuchMethodError: org.apache.commons.collections.SetUtils.orderedSet(Ljava/util/Set;)Ljava/util/Set;
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:107)
    at javax.faces.component.UICommand.broadcast(UICommand.java:383)
    at org.ajax4jsf.component.AjaxViewRoot.processEvents(AjaxViewRoot.java:321)
    at org.ajax4jsf.component.AjaxViewRoot.broadcastEvents(AjaxViewRoot.java:296)
    at org.ajax4jsf.component.AjaxViewRoot.processPhase(AjaxViewRoot.java:253)
    at org.ajax4jsf.component.AjaxViewRoot.processApplication(AjaxViewRoot.java:466)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:97)
    at com.sun.faces.lifecycle.LifecycleImpl.phase(LifecycleImpl.java:251)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:117)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:244)
    at org.apache.catalina.core.ApplicationFilterChain.servletService(ApplicationFilterChain.java:411)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:317)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:198)
    at org.ajax4jsf.webapp.BaseXMLFilter.doXmlFilter(BaseXMLFilter.java:178)
    at org.ajax4jsf.webapp.BaseFilter.handleRequest(BaseFilter.java:290)
    at org.ajax4jsf.webapp.BaseFilter.processUploadsAndHandleRequest(BaseFilter.java:390)
    at org.ajax4jsf.webapp.BaseFilter.doFilter(BaseFilter.java:517)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:198)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:288)
    at org.apache.catalina.core.StandardContextValve.invokeInternal(StandardContextValve.java:271)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:202)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:632)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:577)
    at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:94)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:206)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:632)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:577)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:571)
    at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:1080)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:150)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:632)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:577)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:571)
    at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:1080)
    at org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:272)
    at com.sun.enterprise.web.connector.grizzly.DefaultProcessorTask.invokeAdapter(DefaultProcessorTask.java:637)
    at com.sun.enterprise.web.connector.grizzly.DefaultProcessorTask.doProcess(DefaultProcessorTask.java:568)
    at com.sun.enterprise.web.connector.grizzly.DefaultProcessorTask.process(DefaultProcessorTask.java:813)
    at com.sun.enterprise.web.connector.grizzly.DefaultReadTask.executeProcessorTask(DefaultReadTask.java:341)
    at com.sun.enterprise.web.connector.grizzly.DefaultReadTask.doTask(DefaultReadTask.java:263)
    at com.sun.enterprise.web.connector.grizzly.DefaultReadTask.doTask(DefaultReadTask.java:214)
    at com.sun.enterprise.web.connector.grizzly.TaskBase.run(TaskBase.java:265)
    at com.sun.enterprise.web.connector.grizzly.ssl.SSLWorkerThread.run(SSLWorkerThread.java:106)
Caused by: javax.faces.el.EvaluationException: java.lang.NoSuchMethodError: org.apache.commons.collections.SetUtils.orderedSet(Ljava/util/Set;)Ljava/util/Set;
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:91)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:91)
    ... 43 more
Caused by: java.lang.NoSuchMethodError: org.apache.commons.collections.SetUtils.orderedSet(Ljava/util/Set;)Ljava/util/Set;
    at org.quartz.JobDetail.<init>(JobDetail.java:85)
    at englearn.elc.controller.SchedulerController.play(SchedulerController.java:43)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:187)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:297)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:77)
    ... 44 more
|#]

[#|2009-02-13T02:00:03.055+0000|WARNING|sun-appserver9.1|javax.enterprise.resource.webcontainer.jsf.lifecycle|_ThreadID=22;_ThreadName=httpSSLWorkerThread-80-4;_RequestID=97d21f45-2489-486c-b8d9-68625776c546;|executePhase(INVOKE_APPLICATION 5,com.sun.faces.context.FacesContextImpl@77d0f1) threw exception
javax.faces.FacesException: #{SchedulerController.play}: java.lang.NoSuchMethodError: org.apache.commons.collections.SetUtils.orderedSet(Ljava/util/Set;)Ljava/util/Set;
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:105)
    at com.sun.faces.lifecycle.LifecycleImpl.phase(LifecycleImpl.java:251)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:117)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:244)
    at org.apache.catalina.core.ApplicationFilterChain.servletService(ApplicationFilterChain.java:411)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:317)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:198)
    at org.ajax4jsf.webapp.BaseXMLFilter.doXmlFilter(BaseXMLFilter.java:178)
    at org.ajax4jsf.webapp.BaseFilter.handleRequest(BaseFilter.java:290)
    at org.ajax4jsf.webapp.BaseFilter.processUploadsAndHandleRequest(BaseFilter.java:390)
    at org.ajax4jsf.webapp.BaseFilter.doFilter(BaseFilter.java:517)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:198)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:288)
    at org.apache.catalina.core.StandardContextValve.invokeInternal(StandardContextValve.java:271)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:202)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:632)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:577)
    at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:94)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:206)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:632)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:577)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:571)
    at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:1080)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:150)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:632)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:577)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:571)
    at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:1080)
    at org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:272)
    at com.sun.enterprise.web.connector.grizzly.DefaultProcessorTask.invokeAdapter(DefaultProcessorTask.java:637)
    at com.sun.enterprise.web.connector.grizzly.DefaultProcessorTask.doProcess(DefaultProcessorTask.java:568)
    at com.sun.enterprise.web.connector.grizzly.DefaultProcessorTask.process(DefaultProcessorTask.java:813)
    at com.sun.enterprise.web.connector.grizzly.DefaultReadTask.executeProcessorTask(DefaultReadTask.java:341)
    at com.sun.enterprise.web.connector.grizzly.DefaultReadTask.doTask(DefaultReadTask.java:263)
    at com.sun.enterprise.web.connector.grizzly.DefaultReadTask.doTask(DefaultReadTask.java:214)
    at com.sun.enterprise.web.connector.grizzly.TaskBase.run(TaskBase.java:265)
    at com.sun.enterprise.web.connector.grizzly.ssl.SSLWorkerThread.run(SSLWorkerThread.java:106)
Caused by: javax.faces.FacesException: #{SchedulerController.play}: java.lang.NoSuchMethodError: org.apache.commons.collections.SetUtils.orderedSet(Ljava/util/Set;)Ljava/util/Set;
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:107)
    at javax.faces.component.UICommand.broadcast(UICommand.java:383)
    at org.ajax4jsf.component.AjaxViewRoot.processEvents(AjaxViewRoot.java:321)
    at org.ajax4jsf.component.AjaxViewRoot.broadcastEvents(AjaxViewRoot.java:296)
    at org.ajax4jsf.component.AjaxViewRoot.processPhase(AjaxViewRoot.java:253)
    at org.ajax4jsf.component.AjaxViewRoot.processApplication(AjaxViewRoot.java:466)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:97)
    ... 37 more
Caused by: javax.faces.el.EvaluationException: java.lang.NoSuchMethodError: org.apache.commons.collections.SetUtils.orderedSet(Ljava/util/Set;)Ljava/util/Set;
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:91)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:91)
    ... 43 more
Caused by: java.lang.NoSuchMethodError: org.apache.commons.collections.SetUtils.orderedSet(Ljava/util/Set;)Ljava/util/Set;
    at org.quartz.JobDetail.<init>(JobDetail.java:85)
    at englearn.elc.controller.SchedulerController.play(SchedulerController.java:43)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:187)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:297)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:77)
    ... 44 more
|#] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-13T02:32:03.893

A`java.lang.NoSuchMethodException`始终表示运行时类路径上的类文件与编译时类路径上的类文件版本不同（如果在编译期间缺少该方法，则编译将失败。）

具体来说，本案的犯法是：`java.util.Set org.apache.commons.collections.SetUtils.orderedSet(java.util.Set)`

您的生产环境中的 commons-collections 版本与您在开发环境中的版本不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-05T23:36:03.887

这可能是因为您使用的 commons-collections.jar 版本没有该方法。为了解决这个问题，您需要上传这个库（版本 3.2.1 是可用的最新版本）并用您项目中所有旧的 commons-collections.jar 替换新的（我建议在您的项目文件夹来了解这个库所在的所有地方，因为它在很多地方都令人惊讶，至少在我的情况下......）

希望这可以帮助所有人解决这个可怕的麻烦！我花了一整天的时间来修复它！祝朋友好运：）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-05T11:31:05.347

最新的石英版本不依赖于公共收藏库，因此请尝试使用较新的版本。在我的情况下，从石英 1.6.0 切换到 1.6.6 解决了这个问题。

# c# - 表单验证

> ID：544517
> 
> 赞同：1
> 
> 时间：2009-02-13T02:29:06.617
> 
> 标签：c#, wpf

嗨，我必须在 WPF 中创建一个带有表单身份验证的应用程序，所以我创建了一个数据库（**UserId、Username、Password、PasswordQuestion、PassworAnswer**）并使用 Linq ToSQL 存储数据，但我不知道如何创建 LoginForm 的正确程序使用 Linq ToSQl 验证用户名和密码并为每个用户设置角色。你有什么想法或建议做对吗？

谢谢

再见

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T02:39:50.367

我认为您应该首先考虑创建角色表。

话虽如此，您的 LINQ 查询将如下所示：

```
var result = 
  (
    from c in dataContext where username == Username and password == Password 
    select c
  ) 
```

不过，非常模糊的问题。如果你能澄清，你会得到更好的结果。

# java - 更改目录并在同一命令提示符下运行批处理文件

> ID：544519
> 
> 赞同：3
> 
> 时间：2009-02-13T02:31:29.777
> 
> 标签：java

有什么方法可以打开命令提示符并在命令提示符中更改目录并使用 java.util.com 在同一命令提示符下运行批处理文件。

我知道如何使用 java 打开命令提示符。谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-13T02:36:52.820

您可以在 cmd.exe /K 的值中对 CD 和批处理文件进行编码。从文档（cmd /？）：

> 请注意，如果用引号括起来，则接受由命令分隔符“&&”分隔的多个命令作为字符串。

例如：

```
cmd /C "CD C:\ && Dir"
cmd /C "CD C:\Windows && Dir"
cmd /C "CD C:\Windows && MySuperSuperBatchFile" 
```

有关更多详细信息，请运行：

```
cmd /? 
```

从命令行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-15T11:18:58.093

警惕 Java 的 exec。如果批处理填满了输出缓冲区，它可能会挂起，并导致其他奇怪的问题。

我建议你看看 apache [exec](http://commons.apache.org/exec/)。专门针对您的需要，您应该注意 Executor 接口有一个[setWorkingDirectory](http://commons.apache.org/exec/apidocs/org/apache/commons/exec/Executor.html#setWorkingDirectory(java.io.File))方法。

基本用法：

```
Executor exec = new DefaultExecutor();
exec.setWorkingDirectory(new File("C:\\My\\Dir\\"));
CommandLine cl = new CommandLine("mybatch.bat");
int exitvalue = exec.execute(cl); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-14T00:55:54.677

几个[java.lang.Runtime.exec()](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html)变体确实有一个 dir 参数，所以我假设你没有想到这一点？

您可以编译以下 C 程序并作为包装器执行，以在您想要的任何目录中启动任何程序。如果您使用带有 Runtime.exec 的字符串数组，您将避免命令行解析/可移植性/正确引用参数的所有问题。

我这里没有要测试的 windows 机器，但是如果你把 C 程序编译成 cdexe.exe，你应该可以像下面这样使用它：

```
public class Main {
        public static void main(String args[]) {
                String[] s = { "c:\\some\\place\\cdexe.exe",
                "c:\\start\\dir", "c:\\my\\batch\\file.bat", "arg1", "..." };
                try {
                        java.lang.Runtime.getRuntime().exec(s);
                } catch (java.io.IOException e) {
                        e.printStackTrace();
                }
        }
} 
```

我猜 unistd.h 在 Windows 上可能不可用，但只需用包含 execv 原型的替代。

```
#include <stdio.h>
#include <unistd.h>  // or hard code "int execv(const char *path, char *const argv[]);"

int main(int argc, char *argv[])
{
        if (argc < 3) {
                fprintf(stderr, "Error: Usage: %s <directory> <program> [arguments]\n", argv[0]);
                return 1;
        }
        if (chdir(argv[1]) < 0) {
                perror("Error");
                fprintf(stderr, "chdir(%s) failed\n", argv[1]);
                return 1;
        }
        argv[1] = argv[2];
        execv(argv[1], &argv[2]);      // use execvp if you want PATH to be searched
        perror("Error");
        fprintf(stderr, "execv returned\n");
        return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T03:11:27.107

由于愚蠢的平台独立性原因，从 Java 中很难做到这一点：基本上，如果您在没有分层目录的系统上运行 java 怎么办？

根据您真正想要做的事情，有许多解决方法，但可能最简单的方法是使用运行最终命令 `java.lang.Runtime.exec()`.

.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T14:07:05.657

获取环境 var "comspec" 然后 exec %comspec% /c start/d directory /b batchfile.bat

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-13T06:20:44.203

将批处理文件保存在“路径”中。您无需转到任何特定目录即可执行它。

（例如，您可以在 Windows 环境中的 Autoexec.bat 中有一个条目“set path=%path%;C:.......\YourBatchFile.bat”）

# python - Python 绘图：如何让 matplotlib.pyplot 停止强制标记我的样式？

> ID：544542
> 
> 赞同：14
> 
> 时间：2009-02-13T02:41:45.400
> 
> 标签：python, coding-style, matplotlib

[我正在尝试使用matplotlib](http://matplotlib.sourceforge.net/index.html)在 Python 中绘制一堆数据点（数千个），因此我需要每个标记都非常小且精确。如何获得最小最简单的标记？我使用这个命令来绘制我的数据：

```
 matplotlib.pyplot( x , y ,'.',markersize=0.1,linewidth=None,markerfacecolor='black') 
```

然后我可以查看它`pl.show()`，然后保存它。或者直接`plt.savefig('filename.ps')`在代码中使用保存。问题是这样的：当我`pl.show()`在 GUI 中查看文件时，它看起来很棒，带有小的黑色标记，但是当我从`show()`GUI 保存到文件或直接使用`savefig`然后查看`ps`我创建的文件时，它看起来不同！每个标记在其周围都有一个蓝色的小光环（好像它从每个点开始将它们与默认的蓝色线条连接起来，但没有）并且样式完全错误。为什么保存时会改变样式？如何阻止 python 强制标记的样式？是的，我已经查看了一些替代软件包，例如[CairoPlot](http://linil.wordpress.com/2008/09/16/cairoplot-11/)，但我现在想继续使用 matplotlib。

**更新：**事实证明，保存到 PNG 首先使颜色变好，但是当我想再次将其保存为`.ps`以后（以包含在 PDF 中）时，它会强制转换图像，然后我会失去质量。如何保留文件的矢量性质并获得正确的格式？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-12T12:58:58.190

对于漂亮的矢量化输出，不要使用`'.'`标记样式。使用例如`'o'`(circle) 或`'s'`(square) （请参阅`help(plot)`选项）并将`markersize`关键字参数设置为适当小的值，例如：

```
plot(x, y, 'ko', markersize=2)
savefig('foo.ps') 
```

那个`'.'`（点）产生不太好的结果可能被解释为matplotlib中的一个错误，但是，“点”在矢量图形格式中*应该是什么意思？*

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-08-08T09:57:43.330

你试过`','`点形状吗？它创建“[像素](http://matplotlib.org/api/markers_api.html)”（小点，而不是形状）。

您也可以`markersize`使用这种形状的选项吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T03:32:39.850

如果还没有，您应该尝试保存在光栅化引擎中——将其保存到 PNG 文件中，看看是否可以修复它。如果您需要矢量图，请尝试保存为 PDF 并使用外部实用程序进行转换。我以前也遇到过 PS 引擎的问题，这些问题通过使用 Agg 或 PDF 引擎保存并在外部转换得到解决。

# spring - 单元测试中的 Spring 嵌入式 ldap 服务器

> ID：544550
> 
> 赞同：11
> 
> 时间：2009-02-13T02:44:48.060
> 
> 标签：spring, spring-security, spring-ldap

我目前正在尝试使用嵌入式 ldap 服务器进行单元测试。

在 Spring Security 中，您可以快速定义一个嵌入式 ldap 服务器，用于使用从指定 ldif 加载的一些示例数据的标记进行测试。

我将使用 Spring Ldap 执行 ldap 操作，并考虑测试我的用户服务对象的常用 CRUD 功能。

但是，有没有一种方法可以确保嵌入式服务器中的条目对于我正在运行的每个测试都处于相同的一致状态（有点像删除所有并重新加载 ldif 条目）？

我想到了以下几点：1）表明该方法弄脏了上下文，并强制重新创建嵌入式 ldap 服务器，这听起来很痛苦，因为它必须为每种方法重新启动服务器 2）在测试组织中创建测试条目，这样我就可以取消绑定它们并简单地再次加载 ldif 文件。

我更喜欢 2，但似乎 Spring LDAP 没有很好的帮手来加载和发送 ldif 文件的内容。

关于如何使用 spring 的嵌入式 ldap 服务器或我提到的两种可能的解决方案执行 ldap 测试的任何建议？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-16T21:59:39.430

Spring LDAP 不提供围绕 LDAP 操作的事务控制吗？如果是这样，为什么不使用具有自动回滚功能的 Spring 测试框架呢？

我还知道一个包装 LDAP 存储库的 JDBC-LDAP 桥驱动程序，将其呈现为关系数据库。我已经使用 iBatis 连接到这个（我已经在[http://lokibear.blogspot.com](http://lokibear.blogspot.com)上写了这个，请参阅 7 月的文章）。我还没有尝试应用事务控制，但驱动程序的网站提到了忽略事务的能力（这意味着你也*不能*忽略它们......对吗？）。

就像我说的，我还没有尝试过；但是，如果这提供了围绕 LDAP 的事务，那么您可以再次使用 Spring 测试框架来实现自动回滚。我已经围绕该框架发布了一份速查表 - 请参阅我博客上 9 月份的帖子。

对不起，我可能在这里错过了你的目标；但也许这些建议很有用。祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-21T16:29:50.383

我可能在这里偏离了轨道，但如果您不测试 LDAP 集成本身，您可以使用 Mock 对象模拟 LDAP 连接，该对象始终返回您期望的值，以便您的其他单元测试可以完成。

如果您正在测试 LDAP 连接，那么您实际上是在进行集成测试。在这种情况下，最好连接到真正的 LDAP 实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-05T05:36:44.867

您可能知道也可能不知道嵌入式 LDAP 功能不是由 Spring LDAP 本身提供的，而是由[Apache Directory Server](http://directory.apache.org)提供的。不幸的是，Apache DS 中的 LDIF 加载器（无论如何都是由 Spring 连接的）具有非常差的错误处理和报告能力，因此可能不会像您真正想要的那样进行单元测试。如果您真的想每次都从头开始，最好的选择是带头进行 Spring Security LDAP 单元测试并每次都重新初始化 Apache DS，并加载干净的 LDIF 文件。

或者，您可以完全避开 LDIF，并构建自己的单元测试包装器，在单元测试运行之前验证数据的前置条件和后置条件。这将是更多的工作，但最终可能对你更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T16:20:48.740

对我来说很好：

```
@Inject
private ApplicationContext applicationContext;

@Before
public void reloadLdapDirectory() throws NamingException, IOException{
    ApacheDSContainer apacheDSContainer = (ApacheDSContainer) applicationContext.getBean(BeanIds.EMBEDDED_APACHE_DS);
    LdapTestUtils.clearSubContexts(contextSource, DistinguishedName.EMPTY_PATH);

    ClassPathResource classPathResource = new ClassPathResource("ldap.ldif");

    File tempFile = File.createTempFile("spring_ldap_test", ".ldif");
    try {
        InputStream inputStream = classPathResource.getInputStream();
        IOUtils.copy(inputStream, new FileOutputStream(tempFile));
        LdifFileLoader fileLoader = new LdifFileLoader(apacheDSContainer.getService().getAdminSession(), tempFile.getAbsolutePath());
        fileLoader.execute();
    }
    finally {
        try {
            tempFile.delete();
        }
        catch (Exception e) {
            // Ignore this
        }
    }
} 
```

我问了类似的问题并得到了 Luke Taylor 的回答：[Integration tests with spring-security and ldap](https://stackoverflow.com/questions/13396708/integration-tests-with-spring-security-and-ldap?lq=1)

# virtualization - 复制 virtualPC 虚拟机

> ID：544551
> 
> 赞同：1
> 
> 时间：2009-02-13T02:48:48.097
> 
> 标签：virtualization, virtual-pc

如何克隆现有的 virtualPC (2007) vm？

我正在设置我的开发环境并想要克隆它，并保留一个作为备份，其中包含我所有的基线安装。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T02:52:14.780

只需复制 vhd（虚拟硬盘）和 vmc（设置）文件即可。您可能需要编辑 vmc 以指向重命名的 vhd 文件（如果您选择使用不同的名称）

或者创建一个新的虚拟机，假设它基于现有的 vhd 并将其指向副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T02:52:15.313

因为我的 Virtual PC 只是几个文件，所以您只需复制 Virtual PC 文件 (VMC) 和 Virtual Hard Drive(s) (vhd) 即可克隆设备。

不要忘记您还可以使用撤消磁盘功能重置在会话中对虚拟 PC 所做的所有更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T02:52:52.207

每个 Virtual PC 都有自己的文件夹和文件集；只需制作其文件夹的副本，您就有了机器的第二个副本。

我相信默认情况下它位于“我的文档”>“我的虚拟机”中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T10:26:33.537

如果您打算启动两台机器（无论是否同时启动），请确保在复制的机器上运行[NewSid 。](http://technet.microsoft.com/en-us/sysinternals/bb897418.aspx)

# flash - 如何查看 Flash 源代码？

> ID：544560
> 
> 赞同：11
> 
> 时间：2009-02-13T02:55:12.200
> 
> 标签：flash, apache-flex, decompiler, swf-decompiler

我在网上找到了一个非常适合我正在进行的项目的 Flash 程序。显然，对于 Web 内容，您通常可以只使用浏览器查看您可能正在查看的任何 HTML、PHP 等的源代码。但是当谈到 Flash 时，我们似乎在查看源代码方面一无所知。

有没有办法查看您下载的 Flash swf 的源代码？

注意：至于窃取 Flash 代码在道德上是否应受谴责，也许这更适合另一个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-13T13:17:28.163

.swf 中没有源代码 - 那是编译后的产品。源代码在 .fla 中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T03:02:35.007

Flash 在大多数情况下是经过编译的。您无法查看原始来源。您可以[反编译 Flash 文件](http://www.google.com/search?q=flash+decompiler)。但是，结果不太可能是可读的。

你需要源代码做什么？如果是为了特定的效果（一些你不知道的 3D 巫术），请询问作者它是如何完成的，而不是尝试自己进行逆向工程。反正这样会容易些。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T03:01:51.047

您可以使用 ActionScript 查看器：

[ASV](http://www.buraks.com/asv/)

此外，还有很多 Flash 反编译器 (SWF->FLA)：

[特里利克斯](http://www.flash-decompiler.com/)

[硕思](http://www.sothink.com/product/flashdecompiler/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T13:04:25.370

实际上，Flex SWF 可以使用捆绑在其中的源代码进行编译，尽管这是由其作者自行决定的，并且通常仅用于教程或教学示例（因为它会稍微增加 SWF 大小）。右键单击网页中的 SWF，如果出现“查看源代码”选项，那么您很幸运。

# asp.net - 付费虚拟主机上没有 FileIOPermission 正常吗？

> ID：544562
> 
> 赞同：0
> 
> 时间：2009-02-13T02:56:28.827
> 
> 标签：asp.net, web-hosting, file-permissions

我目前正在使用 IIS6 和 ASP.NET2.0 的共享服务器上购买虚拟主机（他们宣传 3.5，但我的调查证明这是错误的）。

我做了一些工作以使我的 3.5 敏感 ASP.NET 应用程序在我的主机上编译然后发现另一个问题：由于没有 FileIOPermissions，我的应用程序在“File.Open()”调用中失败。

我已致电技术支持，他们已告知我此权限仅在我将 IIS6 配置为仅使用 .NET 1.1 时可用。我是否认为这还不够好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T03:00:55.370

这是在开始付款之前应该解决的问题，除非这种磁盘访问是新的要求。

我可以从他们的角度来看。您的应用程序所拥有的每一点额外功能都让您更有能力将自己（更重要的是，他们）踢到脚上。

但我不知道他们为什么允许它用于早期的 .NET 版本，这似乎很奇怪。

我会明确表示这是一个交易破坏者。他们可能会重演，或者你可能不得不搬到别处。无论哪种方式，您的问题都会得到解决。

# c# - 正则表达式返回一个常量值作为匹配的一部分

> ID：544580
> 
> 赞同：4
> 
> 时间：2009-02-13T03:08:53.463
> 
> 标签：c#, regex

我有一个正则表达式来匹配 2 种不同的数字格式：*\=(?[0-9]+)\?|\+(?[0-9]+)\?*

这应该返回 9876543 作为其值*;1234567890123456?+1234567890123456789012345123=9876543?*
和*;1234567890123456？+9876543？* 我想要的是能够与匹配的“值”一起返回另一个值。

因此，例如，如果第一个字符串匹配，我希望它返回：

值：9876543 格式：LongFormat

如果在第二个字符串中匹配：

值：9876543 格式：ShortFormat

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-15T09:57:23.390

如果您的实现支持的话，另一个选项是使用命名组，它不是您想要的解决方案，但可以节省您使用两个单独的正则表达式。

这是一些C#：

```
var regex = new Regex(@"\=(?<Long>[0-9]+)\?|\+(?<Short>[0-9]+)\?");
string test1 = ";1234567890123456?+1234567890123456789012345123=9876543?";
string test2 = ";1234567890123456?+9876543?";

var match = regex.Match(test1);
Console.WriteLine("Long: {0}", match.Groups["Long"]);     // 9876543
Console.WriteLine("Short: {0}", match.Groups["Short"]);   // blank
match = regex.Match(test2);
Console.WriteLine("Long: {0}", match.Groups["Long"]);     // blank
Console.WriteLine("Short: {0}", match.Groups["Short"]);   // 9876543 
```

基本上只需修改您的正则表达式以包含名称，然后 regex.Groups[GroupName] 将有一个值或不会。您甚至可以只使用组的 Success 属性来知道哪个匹配（match.Groups["Long"].Success）。

*更新：* 您可以使用以下代码从匹配中获取组名：

```
static void Main(string[] args)
{
    var regex = new Regex(@"\=(?<Long>[0-9]+)\?|\+(?<Short>[0-9]+)\?");
    string test1 = ";1234567890123456?+1234567890123456789012345123=9876543?";
    string test2 = ";1234567890123456?+9876543?";

    ShowGroupMatches(regex, test1);
    ShowGroupMatches(regex, test2);
    Console.ReadLine();
}

private static void ShowGroupMatches(Regex regex, string testCase)
{
    int i = 0;
    foreach (Group grp in regex.Match(testCase).Groups)
    {
        if (grp.Success && i != 0)
        {
            Console.WriteLine(regex.GroupNameFromNumber(i) + " : " + grp.Value);
        }
        i++;
    }
} 
```

我忽略了第 0 组，因为这始终是 .NET 中的全部匹配项

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T03:30:45.873

不，您无法匹配不存在的文本。匹配只能返回目标的子字符串。

您本质上想要匹配两种模式并在每种情况下采取不同的操作。看看您是否可以在代码中将它们分开：

```
if match(\=(?[0-9]+)\?) then
    return 'Value: ' + match + 'Format: LongFormat'
else if match(\+(?[0-9]+)\?) then
    return 'Value: ' + match + 'Format: ShortFormat' 
```

（请原谅狡猾的伪代码，但你明白了。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T08:29:12.897

您无法匹配不存在的文本 - 但是，根据您使用的语言，您可以*处理*匹配的内容，并根据存在的内容有条件地添加文本。

通过一些正则表达式的实现，您可以指定一个“回调函数”，它允许您针对每个结果运行逻辑。

这是一个伪代码示例：

```
Input.replaceAll( /[+=][0-9]+(?=\?)/ , formatValue );

formatValue : function(match,groups)
{
    switch( left(match,1) )
    {
        case '+' : Format = 'Short';   break;
        case '=' : Format = 'Long';    break;
        default  : Format = 'Unknown'; break;
    }

    Value : match.replace('[+=]');

    return 'Value: '+Value+' Format: ' + Format;
} 
```

在支持正则表达式回调的语言中，它会在每次找到匹配项时执行 formatValue 函数，并将函数的结果用作替换文本。

您还没有指定您正在使用哪个实现，所以这对您来说可能可行，也可能不可行，但绝对值得一试。

# java - JasperReport 大小限制

> ID：544581
> 
> 赞同：2
> 
> 时间：2009-02-13T03:09:06.020
> 
> 标签：java, jasper-reports

有没有办法限制 JasperReport 的大小？我们刚刚查看了一个 WebSphere 6.1 Heapdump，有人试图创建一个报告，堆中有 1.5GB 的内存。它使我们的 Websphere 服务器瘫痪。谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T11:45:30.833

我不熟悉 JasperReports，但您可以[包装您的 I/O 流](http://jasperreports.sourceforge.net/api/net/sf/jasperreports/engine/JasperCompileManager.html#compileReportToStream(java.io.InputStream,%20java.io.OutputStream))以确保读取/写入的数据量不超过定义的限制。

[输出流](http://java.sun.com/javase/6/docs/api/java/io/OutputStream.html)示例：

```
public class LimitedSizeOutputStream extends OutputStream {

    private final OutputStream delegate;
    private final long limit;
    private long written = 0L;

    /**
     * Creates a stream wrapper that will throw an IOException if the write
     * limit is exceeded.
     * 
     * @param delegate
     *            the underlying stream
     * @param limit
     *            the maximum number of bytes this stream will accept
     */
    public LimitedSizeOutputStream(OutputStream delegate, long limit) {
        this.delegate = delegate;
        this.limit = limit;
    }

    private void checkLimit(long byteCount) throws IOException {
        if (byteCount + written > limit) {
            throw new IOException("Exceeded stream size limit");
        }
        written += byteCount;
    }

    @Override
    public void write(int b) throws IOException {
        checkLimit(1);
        delegate.write(b);
    }

    @Override
    public void write(byte[] b) throws IOException {
        checkLimit(b.length);
        delegate.write(b);
    }

    @Override
    public void write(byte[] b, int off, int len) throws IOException {
        checkLimit(len);
        delegate.write(b, off, len);
    }

    @Override
    public void close() throws IOException {
        delegate.close();
    }

} 
```

[包装InputStream](http://java.sun.com/javase/6/docs/api/java/io/InputStream.html)也很容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-19T21:14:42.427

JasperReports 现在具有限制报告输出大小的“报告管理器”。例如，您可以设置这些配置参数：

***`net.sf.jasperreports.governor.max.pages.enabled=[true|false]`***

***`net.sf.jasperreports.governor.max.pages=[integer]`***

有关更多信息，请参阅JasperReports 论坛上的[此帖子。](http://jasperforge.org/plugins/espforum/view.php?group_id=102&forumid=103&topicid=48376#55622)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T11:57:47.843

您是否尝试过限制从数据库返回的记录集中的行？

# visual-studio - TFS Team Explorer 独立安装 VS 2008

> ID：544584
> 
> 赞同：1
> 
> 时间：2009-02-13T03:10:51.103
> 
> 标签：visual-studio, tfs

当 Visual Studio 2008 安装在同一台机器上时，有谁知道如何以独立模式安装/运行 TFS Team Explorer？

附加信息：我的问题应该更清楚一点。我正在尝试访问工作项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T13:19:40.373

如果已安装 TFS 团队资源管理器并且无法独立运行它，则 TFS 团队资源管理器将始终与 Visual Studio 的某个版本（Express 除外）集成。

如果您安装了[TFS 2008 Power Tools](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx)，那么您可以拥有它，以便获得许多人喜欢的 TFS 的 Windows 资源管理器集成。您可能还想查看[Team System Web Access](http://go.microsoft.com/fwlink/?LinkID=136577)以提供一种仅从 Web 浏览器访问 TFS 的机制（但显然不包括完整的版本控制功能）

最后，我工作的公司有一个完全独立的 TFS 客户端，称为[Teamprise Explorer](http://www.teamprise.com/products/explorer/)，它是用 Java 实现的，但这是一个商业产品。

希望有帮助，

马丁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T19:11:25.927

答案是确实没有独立版本。在没有 Visual Studio 的机器上安装 VS Team Explorer 时，安装程​​序将安装 Visual Studio shell。然后，当您在独立模式下运行 Team Explorer 时，您实际上是在运行 Visual Studio shell。

Martin 有一个关于[Team System Web Access](http://go.microsoft.com/fwlink/?LinkID=136577)的好观点，它可能会很好地完成这项工作。此外，它还有一个额外的好处是它允许非 Visual Studio 用户访问工作项。但是，决定在这里安装它太麻烦了（为美国陆军工作可能会遇到问题）。

我现在的解决方案是运行另一个 Visual Studio 实例并从那里访问 Team Explorer 工具。

# c# - 在 C# windows.Form 中使用的自定义 .ttf 字体

> ID：544590
> 
> 赞同：11
> 
> 时间：2009-02-13T03:15:19.297
> 
> 标签：c#, winforms, fonts

如何在当前 windows.forms 应用程序中使用自定义 .tff 字体文件？我读了一些将它用作嵌入式资源的地方，但是如何将其设置为 System.Drawing.Font 类型？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-13T03:50:08.200

这篇文章：[如何嵌入真正的类型字体](https://web.archive.org/web/20141224204810/http://bobpowell.net/embedfonts.aspx)展示了如何在 .NET 中执行您所要求的操作。

**如何嵌入 True Type 字体**

> 出于美观或所需视觉风格的原因，某些应用程序将嵌入某些不常见的字体，以便它们在需要时始终存在，而不管该字体是否实际安装在目标系统上。
> 
> 这其中的秘诀是双重的。首先，需要通过将字体添加到解决方案并将其标记为嵌入式资源来将字体放入资源中。其次，在运行时，字体通过流加载并存储在 PrivateFontCollection 对象中供以后使用。
> 
> 此示例使用一种不太可能安装在您的系统上的字体。Alpha Dance 是一种免费的 True Type 字体，可从 Free Fonts Collection 获得。该字体通过将其添加到解决方案并在属性中选择“嵌入式资源”构建操作而嵌入到应用程序中。

[![图 1\. 嵌入在解决方案中的 Alpha Dance 字体文件。](https://i.stack.imgur.com/qSiPn.png)](https://i.stack.imgur.com/qSiPn.png)

> 一旦文件成功包含在资源中，您需要提供一个 PrivateFontCollection 对象来存储它以及将其加载到集合中的方法。执行此操作的最佳位置可能是表单加载覆盖或事件处理程序。以下清单显示了该过程。请注意如何使用 AddMemoryFont 方法。它需要一个指向将字体保存为字节数组的内存的指针。在 C# 中，我们可以使用 unsafe 关键字来方便，但 VB 必须使用 Marshal 类的非托管内存处理功能。后一种选择当然对不喜欢 unsafe 关键字的 C# 程序员开放。PrivateFontCollection pfc = new PrivateFontCollection();

```
private void Form1_Load(object sender, System.EventArgs e)
{
  Stream fontStream = this.GetType().Assembly.GetManifestResourceStream("embedfont.Alphd___.ttf");

  byte[] fontdata = new byte[fontStream.Length];
  fontStream.Read(fontdata,0,(int)fontStream.Length);
  fontStream.Close();
  unsafe
  {
    fixed(byte * pFontData = fontdata)
    {
      pfc.AddMemoryFont((System.IntPtr)pFontData,fontdata.Length);
    }
  }
} 
```

> 字体可能只有某些可用的样式，不幸的是，选择不存在的字体样式会引发异常。为了克服这个问题，可以询问字体以查看哪些样式可用，并且只能使用字体提供的样式。下面的清单通过检查可用的字体样式并显示所有存在的样式来演示如何使用 Alpha Dance 字体。请注意，下划线和删除线样式是由字体渲染引擎构造的伪样式，实际上并未以字形形式提供。

```
private void Form1_Paint(object sender, System.Windows.Forms.PaintEventArgs e)
{
  bool bold=false;
  bool regular=false;
  bool italic=false;

  e.Graphics.PageUnit=GraphicsUnit.Point;
  SolidBrush b = new SolidBrush(Color.Black);

  float y=5;

  System.Drawing.Font fn;

  foreach(FontFamily ff in pfc.Families)
  {
    if(ff.IsStyleAvailable(FontStyle.Regular))
    {
      regular=true;
      fn=new Font(ff,18,FontStyle.Regular);
      e.Graphics.DrawString(fn.Name,fn,b,5,y,StringFormat.GenericTypographic);
      fn.Dispose();
      y+=20;
    }
    if(ff.IsStyleAvailable(FontStyle.Bold))
    {
      bold=true;
      fn=new Font(ff,18,FontStyle.Bold);
      e.Graphics.DrawString(fn.Name,fn,b,5,y,StringFormat.GenericTypographic);
      fn.Dispose();
      y+=20;
    }
    if(ff.IsStyleAvailable(FontStyle.Italic))
    {
      italic=true;
      fn=new Font(ff,18,FontStyle.Italic);
      e.Graphics.DrawString(fn.Name,fn,b,5,y,StringFormat.GenericTypographic);
      fn.Dispose();
      y+=20;
    }
    if(bold  && italic)
    {
      fn=new Font(ff,18,FontStyle.Bold | FontStyle.Italic);
      e.Graphics.DrawString(fn.Name,fn,b,5,y,StringFormat.GenericTypographic);
      fn.Dispose();
      y+=20;
    }
    fn=new Font(ff,18,FontStyle.Underline);
    e.Graphics.DrawString(fn.Name,fn,b,5,y,StringFormat.GenericTypographic);
    fn.Dispose();
    y+=20;
    fn=new Font(ff,18,FontStyle.Strikeout);
    e.Graphics.DrawString(fn.Name,fn,b,5,y,StringFormat.GenericTypographic);
    fn.Dispose();
  }

  b.Dispose();
} 
```

> 图 2 显示了正在运行的应用程序。

[![图 2\. 嵌入的 Alpha Dance 字体。](https://i.stack.imgur.com/J4iLq.png)](https://i.stack.imgur.com/J4iLq.png)

请参阅 Form1_Paint 事件处理程序，它具体显示了如何设置 System.Drawing.Font 类型。它基于使用 System.Drawing.Text.PrivateFontCollection 类。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-13T03:38:42.063

通过 p/invoke使用[AddFontResourceEx](http://msdn.microsoft.com/en-us/library/dd183327(VS.85).aspx) API 函数，传递 FR_PRIVATE 以防止安装全局字体。然后您应该能够像往常一样将字体名称传递给 Font 构造函数。

编辑：如果您使用[PrivateFontCollection](http://msdn.microsoft.com/en-us/library/system.drawing.text.privatefontcollection.aspx)并从外部文件加载字体，您甚至不需要这个。如果您从嵌入式资源加载字体，请使用 Ash 的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-16T11:33:48.327

[您可能会发现 MSDN 文章How to: Create a Private Font Collection](http://msdn.microsoft.com/en-us/library/y505zzfw.aspx)很有用。

# sql-server-2005 - SQL 2005如何设置hasdbaccess

> ID：544592
> 
> 赞同：0
> 
> 时间：2009-02-13T03:17:35.953
> 
> 标签：sql-server-2005

在 MS-SQL 2005 中，当我执行

**从 sys.sysusers 中选择 ***

在**主**数据库中，来宾用户**hasdbaccess** = 1。

如何设置 hasdbaccess = 0 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-27T09:25:32.633

```
REVOKE CONNECT TO [username] 
```

将等于该查询

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T03:21:42.557

我想这不是那么简单：

```
update sys.sysusers
    set hasdbaccess = 0
    where user = 'guest' 
```

或类似的东西？不，生活从来没有那么容易:-)

您通常会使用`deny`或`revoke`删除此类权限，但请注意来宾不被视为普通用户。由于某种原因，`GUEST`不受`REVOKE CONNECT`主数据库或 tempdb 数据库的影响。

请参阅[此处](http://msdn.microsoft.com/en-us/library/ms189438.aspx)以了解该事实的一小部分陈述，但对其原因没有太多解释。

在进一步调查中，有些人似乎建议在主数据库上需要它，因为这是存储用户（登录）信息的地方。因此，在登录期间，每个人都使用访客帐户访问该数据库，因为他们的“真实”帐户和权限尚不清楚。

因为来宾帐户用于没有经过验证的凭据的所有用户（在他们登录成功之前，每个人都是如此），这对我来说很有意义。

# security - 跨域自动部署处理权限的好方法是什么？

> ID：544595
> 
> 赞同：0
> 
> 时间：2009-02-13T03:23:20.807
> 
> 标签：security, automation, nant

暂时我一直在努力使用 Nant 来自动化一些部署过程。一旦 Nant 脚本脚本相当稳定并经过验证，我将寻求合并 CruiseControl.net 或类似产品。

话虽如此，我今天遇到了障碍。

我有一个 Nant 脚本，它将文件从用作暂存区域的网络共享复制到目标（开始非常简单）。在我今天遇到的问题中，我试图将文件复制到位于单独域中的另一个文件共享中。现在这两个域之间确实有任何信任。

运行 Nant 脚本的用户首先通过 Windows 资源管理器访问了这两个位置，以确保他与两个域都有经过身份验证的会话。当他运行脚本时，他当然会遇到拒绝访问错误，因为 Nant.exe 是在另一个域的凭据下运行的。这是我的疏忽。

有没有人对如何在不接触 AD 的情况下解决这个问题有任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T03:37:05.297

如果不接触 AD，我想不出任何方法都不会是 hack。正确的做法是在运行 nant 作业的域中设置一个服务帐户，该服务帐户在另一个域中具有权限。然后让 nant 作业在服务帐户下运行。我能想到的唯一 hacky 方法是找到一种方法让在两个域中都拥有权限的用户启动 nant 工作，我什至不肯定这会奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T03:46:18.770

这很 hacky，但是您可以通过 P/Invoking[`WNetUseConnection`](http://msdn.microsoft.com/en-us/library/aa385482(VS.85).aspx)或通过发出类似

```
net use \\host\share password /user:user@domain 
```

在复制文件之前。

# python - 使用 django-voting 进行投票排序问题

> ID：544597
> 
> 赞同：1
> 
> 时间：2009-02-13T03:25:23.360
> 
> 标签：python, django, django-voting

我有一个模型帖子和一个模型投票。Vote（形式 django-voting）本质上只是一个指向 Post 和 -1、0 或 1 的指针。

还有一个 Tourn，它是一个开始日期和一个结束日期。在锦标赛开始和结束之间发布的帖子将提交给该锦标赛。

为了代表计算，我试图找到锦标赛的前 3 名获胜者。这就是我所拥有的：

```
 posts = Post.objects.filter(status=2, created_at__range=(tourn.start_date, tourn.end_date))

    start = tourn.start_date - timedelta(days=1)
    end = tourn.end_date + timedelta(days=1)
    qn = connection.ops.quote_name
    ctype = ContentType.objects.get_for_model(Post)

    posts.extra(select={'score': """
            SELECT SUM(vote)
            FROM %s
            WHERE content_type_id = %s
            AND object_id = %s.id
            AND voted_at > DATE(%s)
            AND voted_at < DATE(%s)
        """ % (qn(Vote._meta.db_table), ctype.id, qn(Post._meta.db_table), start, end)},
                order_by=['-score'])

    if tourn.limit_to_category:
        posts.filter(category=tourn.category)

    if len(posts) >= 1:
        tourn_winners_1.append(posts[0].author)
        resp += " 1: " + posts[0].author.username + "\n"

    if len(posts) >= 2:
        tourn_winners_2.append(posts[1].author)
        resp += " 2: " + posts[1].author.username + "\n"

    if len(posts) >= 3:
        tourn_winners_3.append(posts[2].author)
        resp += " 3: " + posts[2].author.username + "\n" 
```

看起来很简单，但由于某种原因，结果是错误的。

因此，得到的查询是：

```
SELECT "blog_post"."id", "blog_post"."title", "blog_post"."slug", "blog_post"."a
uthor_id", "blog_post"."creator_ip", "blog_post"."body", "blog_post"."tease", "b
log_post"."status", "blog_post"."allow_comments", "blog_post"."publish", "blog_p
ost"."created_at", "blog_post"."updated_at", "blog_post"."markup", "blog_post"."
tags", "blog_post"."category_id" FROM "blog_post" WHERE ("blog_post"."status" =
2  AND "blog_post"."created_at" BETWEEN 2008-12-21 00:00:00 and 2009-01-04 00:00
:00) ORDER BY "blog_post"."publish" DESC 
```

似乎 posts.extra() 根本没有应用于查询......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T21:34:47.533

我认为您需要分配`posts`给的返回值`posts.extra()`：

```
posts = posts.extra(select={'score': """
                    SELECT SUM(vote)
                    FROM %s
                    WHERE content_type_id = %s
                    AND object_id = %s.id
                    AND voted_at > DATE(%s)
                    AND voted_at < DATE(%s)
                """ % (qn(Vote._meta.db_table), ctype.id, qn(Post._meta.db_table), start, end)},
                        order_by=['-score']) 
```

# sql-server - SQL Server 2005 SP2 或 SP3 未更新 Management Studio？

> ID：544608
> 
> 赞同：2
> 
> 时间：2009-02-13T03:31:30.647
> 
> 标签：sql-server

我应用了 SQL Server 2005 SP2 并标记了所有要更新的组件，包括客户端工具，但是帮助 -> 关于框中的版本仍然是 1399 版本，而服务器确实有 3042。

然后我只将 SP2 重新应用到客户端工具，一切都成功运行（再次，第一次也成功了），但仍然没有管理工作室的版本更新。

现在，我刚刚成功地应用了 SP3，但管理工作室版本仍然没有得到更新。

我该如何更新它？或者至少我怎样才能卸载 Management Studio 以便我可以从较新的 DVD 安装它？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T08:52:40.407

如果您转到控制面板 > 添加删除程序，然后选择适当的 SQL Server 安装，这将启动 SQL Server 的典型安装向导。

然后，您可以选择要卸载的特定组件。

如果您在使用 SQL Server 2005 Service Pack 3 时遇到困难，我建议您访问 SQL Server Central 论坛，因为 SQL Server SP3 有大量资源。实际上是由于该论坛的用户需求导致甚至发布了 SP3。

[http://www.sqlservercentral.com/Forums/Forum146-1.aspx](http://www.sqlservercentral.com/Forums/Forum146-1.aspx)

让我知道你是怎么办的。

干杯，约翰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-23T08:10:09.653

我在 sql server sp3 安装日志中出现错误，导致此错误：错误编号：29538 错误描述：MSP 错误：29538 SQL Server 安装程序没有重命名文件所需的管理员权限：C:\Program Files\Microsoft SQL Server\ MSSQL.1\MSSQL\DATA\mssqlsystemresource1.ldf。要继续，请验证该文件是否存在，然后将管理员权限授予当前运行安装程序的帐户或使用管理员帐户登录。然后再次运行 SQL Server 安装程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-06T22:50:37.893

讨厌回答我自己的问题，但我不得不手动卸载客户端工具，使用 SQL Server 2005 安装程序重新安装它们，然后应用更新。

仅仅尝试对现有的原始安装应用更新是行不通的。

And i mention un-installing using the SQL Server 2005 Setup because trying to do it from the Add/Remove Programs dialog won't let you or will give you trouble.

# cocoa - 如何获取临时图像的路径和网址？

> ID：544614
> 
> 赞同：0
> 
> 时间：2009-02-13T03:36:50.680
> 
> 标签：cocoa

我捕获了播放 Flash 的 webview 图像。因为我想展示这张图片，并使用IKSaveOptions来保存图片。但是我发现图片的路径是nil，现在我想获取图片的路径，怎么办？我的代码： NSString *path = [[NSBundle mainBundle] pathForResource: ?? ofType:??]; NSURL *url = [NSURL fileURLWithPath: path]; 然后我使用url在imageview中显示图像，但现在我没有得到路径，非常感谢！

* * *

多谢。现在我认为 NSBundle 不是我的选择。但我想显示从显示闪光灯的 web 视图中捕获它的图像。我可以在 imagecell 中显示它，但在 imageview 中显示，我使用代码：

[imageView setImage:image imageProperties: mImageProperties];

并且 mImageProperties 来自你带我的 ImageKit 文档的文档，名称是“在图像视图中查看图像”，其中 mImageProperties 是图像的属性。代码是：

mImageProperties = (NSDictionary*)CGImageSourceCopyPropertiesAtIndex(isr, 0, (CFDictionaryRef)mImageProperties);

仍然使用图像的 url，如果我不能使用 NsBundle ，我该如何获取图像的属性，顺便说一句，我已经获得了显示 flash 的捕获 webview 的图像。代码 ：

NSBitmapImageRep *imageRep = [webView bitmapImageRepForCachingDisplayInRect:[webView frame]]; [webView cacheDisplayInRect:[webView frame] toBitmapImageRep:imageRep]; NSImage *image = [[NSImage alloc] initWithSize:[webView frame].size]; [图像添加表示：imageRep]；

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T05:29:55.277

好吧，你在这里混淆了很多东西。首先，IKSaveOptions 不保存图像。它是一种向用户提供有关要保存的选项的界面的机制，但它实际上并不将文件保存在任何地方。要保存文件，请使用底层 CGImage 机制，如 ImnageKit[文档](http://developer.apple.com/DOCUMENTATION/GraphicsImaging/Conceptual/ImageKitProgrammingGuide/ImageViews/chapter_3_section_4.html#//apple_ref/doc/uid/TP40004907-CH4-SW16)中所述。我认为，如果您在那里阅读示例代码，也会清楚保存文件的路径在哪里。

现在，进入第二个问题。你永远不会使用 pathForResource:ofType 来获取它。这会获取应用程序包中的资源。换句话说，作为应用程序一部分的东西，在构建时包含在其中。你不应该在*构建*后修改你的包内容，除了复杂之外，它会使代码签名的应用程序无效。相反，您可能应该使用 CGImage 或 NSImage 来读取它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T09:22:13.113

好的，我有答案了。NSBitmapImageRep *imageRep = [webView bitmapImageRepForCachingDisplayInRect:tmpRect]; [webView cacheDisplayInRect:tmpRect toBitmapImageRep:imageRep];

```
NSImage *theimage = [[NSImage alloc] initWithSize:tmpRect.size];
[theimage addRepresentation:imageRep];

CGImageSourceRef isr = CGImageSourceCreateWithData((CFDataRef)[theimage TIFFRepresentation], NULL);
CGImageRef image = NULL;    

if (isr)
{
    image = CGImageSourceCreateImageAtIndex(isr, 0, NULL);
    if (image)
    {
        mImageProperties = (NSDictionary*)CGImageSourceCopyPropertiesAtIndex(isr, 0, (CFDictionaryRef)mImageProperties);
    }
    CFRelease(isr);
}

if (image)
{
    [imageView setImage:image imageProperties:mImageProperties];
    CGImageRelease(image);
} 
```

# .net - 如何在 winforms 应用程序中测试本地化？

> ID：544620
> 
> 赞同：3
> 
> 时间：2009-02-13T03:39:37.930
> 
> 标签：.net, winforms, testing, localization

有没有办法在一个 Windows 应用程序中测试不同的语言而不改变操作系统的本地化或向应用程序添加代码来强制改变当前的文化？

也许某种类型的启动器会以指定的文化启动应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T03:47:35.630

有这个适用于 XP 的[AppLocale](http://www.microsoft.com/globaldev/tools/apploc.mspx)实用程序，它也可以安装在[vista](http://www.mydigitallife.info/2007/05/26/workaround-to-install-microsoft-applocale-utility-in-windows-vista/)上。

AppLocale 自动检测非 Unicode 程序的语言，并模拟相应的系统区域设置以进行代码页与 Unicode 之间的转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T03:51:02.347

[您可以在主线程设置为指定区域性](http://blogs.msdn.com/shawnfa/archive/2006/10/20/quickly-testing-code-under-different-cultures.aspx)的情况下启动应用程序。

# sql - 错误的批量删除和更新——设计错误？

> ID：544626
> 
> 赞同：4
> 
> 时间：2009-02-13T03:45:38.383
> 
> 标签：sql, language-features

为什么 SQL 的设计者不要求任何没有**Where**子句的**Update**或**Delete语句的关键字（例如“** **All** ”） ？这只是他们的疏忽吗？如果他们这样做了，他们会省去很多悲伤（更不用说工作了！）！

 ******* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-13T05:04:27.007

犯了这个错误后，我虔诚地养成了打字的习惯

```
 BEGIN TRANSACTION;

-- Select Blah

-- Some Sql here that changes Blah

-- Select Blah

ROLLBACK TRANSACTION; 
```

然后运行它，确保受影响的行数看起来很正常，再盯着 Sql，然后替换`ROLLBACK`并`COMMIT`运行它。

它只需要 15 秒的额外时间，并为我节省了一些胃灼热，尤其是在复杂`UPDATE...FROM`类型的查询上。

事实上，我同意，应该有一个`ALL`关键字或类似的东西来防止这样的错误。或者，你的 Sql 查询环境中的一个内置选项，当我手指痉挛并在 Taco Bell 的屏幕上双击时，它就像收银机一样：“你真的是说 99 个 tacos 吗？”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T03:55:30.013

还有很多其他非常简单的方法可以破坏您的 SQL 数据，试图捕获其中任何一种实际上只是浪费时间。没有 WHERE 的更新同样糟糕（可以说更糟）。在连接多个表的 SELECT 中省略一两个子句可能会导致它打印到您的控制台，而不是一行，一万亿。

尽可能在复制的从属服务器上工作。如果不能，请确保备份可用，不会立即被更新损坏。在键入 UPDATE 或 DELETE 查询时，请缓慢而仔细地键入，并且在键入结束分号之前始终盯着它几秒钟。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T04:20:21.090

哪里写到你需要编写一个没有 WHERE 子句的可执行 SQL 语句？当我输入它们时，我将它们打乱了顺序，因此在我完成之前它不是合法的 SQL 语句。换句话说，我输入 WHERE 子句，然后返回并填写 DELETE 或 UPDATE 部分。

每当我在非开发环境中做某事时，我首先执行一个 SELECT 以确保我在 WHERE 条件下获得正确的行，然后将其更改为 DELETE/UPDATE。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T03:48:44.083

出于同样的原因，您可以在 C 中使用 malloc 而不匹配 free ：这是您的责任。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-13T03:52:37.787

我也不知道为什么。

我真希望他们这样做。有几次我想要全部更新或全部删除，我可能会费心写 WHERE 1 = 1。

当然，这不会拯救写作的 Manoj

```
DELETE FROM T2
  FROM Tbl T1, Tbl T2
 WHERE T1.TopLevelId = 'value' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-13T03:59:36.257

我从未见过需要删除所有记录，而很少需要更新所有记录的情况。我一直认为这是一个设计缺陷。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-13T04:09:47.793

我想你会发现他们认为你会知道你在做什么，并表现出一些智慧:-)。

我知道，让我们玩“Reductio Ad Absurdum”：

*   如果没有 ALL 关键字，您应该无法`delete[]`在 C++ 中使用。如果您只想删除数组的一个元素怎么办？
*   如果不强制用户指定 ALL，所有那些人们似乎喜欢的迭代器都是危险的。如果他们只想要一个子集怎么办？
*   星期一！如果人们要在他们的 SELECT 中留下一个 WHERE 子句怎么办？潜在的危害确实是巨大的，检索所有数据可能需要数小时，并在此期间占用宝贵的 DBMS 连接。

请不要被冒犯，我希望你能本着它的本意（轻松幽默）。我认为，作为专业人士，我们应该知道我们在做什么。诚然，我犯了一些漂亮的错误，例如将以下内容附加到 passwd 文件中：

```
echo "....." >/etc/passwd 
```

而不是使用“ `>>`”，这就是为什么我现在非常彻底地测试我所有可能具有破坏性的东西。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-13T06:05:08.250

大量的 IT 内容是（是）最后与用户一起编写的，首先是易于开发。Sql 是一个很好的例子，它可以工作，但是很多（微不足道的）简单的事情很难做到。然而，很难的事情——比如删除所有数据很容易。我认为这是一个设计缺陷。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-13T03:50:56.810

但真正的问题是您的“实时”数据有多安全。在“实时”数据库上运行未经测试的脚本是自找麻烦。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-13T04:55:23.130

正如墨菲所说：如果一件事会出错，它就会出错。“全部”只是另一种情况。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-08-05T17:15:32.047

我相信这是由于 SQL 数据操作语言的集合论启发性质。

使用交易:)

# tcp - 如果服务器终止，TCP 数据包会发生什么？

> ID：544628
> 
> 赞同：3
> 
> 时间：2009-02-13T03:47:34.227
> 
> 标签：tcp

我知道 TCP 非常可靠，发送的任何内容都可以保证到达目的地。但是，如果*在*发送数据包之后，但*在*它到达服务器之前，服务器宕机了，会发生什么情况呢？数据包发送成功的确认是在最初发送数据包时触发服务器存在，还是在数据包成功到达服务器时触发？

基本上我要问的是 - 如果服务器在发送和接收数据包之间发生故障，客户端会知道吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-13T03:54:52.760

这真的没关系，但这里有一些更精细的细节：

您需要区分服务器机器宕机和服务器进程宕机。

如果服务器机器崩溃了，那么很明显，没有任何东西可以接收到数据包。发送客户端将不会收到重试请求，也不会确认成功或失败。在完全没有收到任何反馈后，客户端最终会收到超时，并认为连接已断开。这与意外物理切割的电缆几乎相同。

然而，如果服务器机器仍然运行，但服务器进程由于编程错误而崩溃，那么接收 TCP 堆栈，它是操作系统的功能，而不是进程的功能，可能会确认数据包，并且任何其他到达。这将一直持续到操作系统通知 TCP 堆栈该进程不再处于活动状态。TCP 堆栈可能会向客户端发送 RST（重置）通知，或者可能会断开连接（如上所述）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T03:55:09.357

这基本上就是发生的事情。如果不被不必要的细节束缚，就很难描述完整的现实。

TCP 管理定义为 4 元组（source-ip、source-port、dest-ip、dest-port）的连接。

当服务器关闭连接时，连接将进入 TIME_WAIT2 状态，在该状态下在一定时间内无法重复使用。该时间是数据包最大生存时间值的两倍。在此期间到达的任何数据包都被 TCP 本身丢弃。

因此，当连接可供重用时，所有数据包都已通过以下方式销毁（网络上的任何地方）：

*   由于 TIME_WAIT2 状态，在目的地被接收并被丢弃；或者
*   由于过期而被网络上的数据包转发器销毁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T03:55:57.063

当您将数据包发送到网络时，永远不会有受让人，它将安全地到达另一端。TCP 的可靠性完全按照您使用确认包的建议来实现。

# mysql - 在数据库中实现分层数据结构

> ID：544632
> 
> 赞同：12
> 
> 时间：2009-02-13T03:48:34.257
> 
> 标签：mysql, database, hierarchical-data

我知道有两种方法：邻接表和嵌套树。据说由于大量查询，邻接表在遍历时会变得很慢。但我不知道任何现实的数字。我正在制作的网站将有 200 页左右。生成（例如）站点地图的遍历是否会花费超过 0.3 秒的时间？

在带有 LAMP 堆栈的 MySQL (innoDB) 上运行。

如果可能的话，我更喜欢实现邻接，因为设计更简单。

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-13T04:33:39.313

除了你提到的两个，还有更多的选择。有：

*   邻接表（几乎每个人都使用的“parent_id”）
*   嵌套集
*   路径枚举
*   闭包表（又名邻接关系）

[请参阅我对“将平面表解析为树的最有效/优雅的方法是什么？](https://stackoverflow.com/questions/192220/what-is-the-most-efficient-elegant-way-to-parse-a-flat-table-into-a-tree/192462#192462) ” 的回答。

或者几本书：

*   “[聪明人的 SQL 中的树和层次结构](https://rads.stackoverflow.com/amzn/click/com/1558609202)”，作者：Joe Celko。
*   Vadim Tropashko 的“ [SQL 设计模式](https://rads.stackoverflow.com/amzn/click/com/0977671542)”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T04:02:09.620

[在 MySQL 中管理分层数据一](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)文对此进行了详细介绍。

我会推荐“嵌套集”技术，因为它允许您在一个查询中获取整棵树（及其子树）。基本上读取很便宜，但写入很昂贵，因为必须重新平衡整个树。但如果你有 99% 的阅读量，那么它是完全合理的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-13T05:04:05.150

解析邻接列表的简单方法需要大量查询，并且对于大型列表可能需要大量时间来构建内存。作为参考，我所指的幼稚方法可以概括为：选择所有没有父项的项目，然后为每个项目递归地获取它的子项。这种方法需要 n+1 个数据库查询。

我使用以下方法来构建具有 1 个查询的邻接列表。从数据库中选择所有项目。将所有项目传输到由其键索引的数组中。遍历数组并将父对象的引用分配给它的每个子对象。再次遍历数组并移除所有子对象，只留下根级对象。

由于您提到了 LAMP 堆栈，因此执行此操作的 PHP 代码大致如下：

```
<?php
// Assumes $src is the array if items from the database.
$tmp = array();

// Traverse the array and index it by id, ensuing each item has an empty array of children.
foreach ($src as $item) {
  $item['children'] = array();
  $tmp[$item['id']] = $item;
}

// Now traverse the array a second time and link children to their parents.
foreach ($tmp as $id => $item) {
  if ($item['parent_id'] != 0 || $item['parent_id'] !== NULL) {
    $tmp[$item['parent_id']]['children'][$id] = &$tmp[$id];
  }
}

// Finally create an array with just root level items.
$tree = array();
foreach ($tmp as $id => $item) {
  if ($item['parent_id'] == 0 || $item['parent_id'] === NULL) {
    $tree[$id] = $item;
  }
}

// $tree now contains our adjacency list in tree form.
?> 
```

请注意，此代码旨在说明从单个数据库查询构建邻接列表的技术。它可能会针对更少的内存消耗等进行优化。它还没有经过测试。

吉姆，

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-13T03:54:33.663

这里有几个问题可能会对您有所帮助：

[SQL 如何存储和导航层次结构](https://stackoverflow.com/questions/38801/sql-how-to-store-and-navigate-hierarchies)

[哪个是我导航的最佳数据库架构](https://stackoverflow.com/questions/56981/which-is-the-best-database-schema-for-my-navigation)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-13T03:56:59.243

我认为另一种方法称为“嵌套集”，而不是“嵌套树”。

无论如何，站点地图的一个好处是您可能知道它的最大深度。我认为邻接模型的问题在于相应的 SQL 一次只在一个级别上工作，所以如果你有“n”个级别，那么你需要一个循环“n”个 SQL 语句......但我认为（I' m不确定）如果您提前知道最大'n'，那么您可以编写相应的固定数量的多级SQL。

0.3 秒对我来说听起来像是一个很长的时间来计算 200 页，所以这可能没关系。

站点地图也不会经常更新；因此，即使从 SQL 中检索确实需要很长时间，您也可以将检索/计算的树缓存在 RAM 中。

或者，不用担心构建树的 SQL，您可以尽可能简单地存储它（作为邻接列表），从数据库中检索它作为一组简单的行，然后在 RAM 中构建树（使用循环您的高级编程语言）而不是在 SQL 中使用循环来使用 SQL 语句构建树。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-13T04:19:03.480

为了完整起见：Oracle 有`START_WITH`and`CONNECT_BY`运算符：请参阅此[Hierarchical Queries](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/queries003.htm)文档。

# vb.net - 如何使用 vb.net 在 Windows 窗体上旋转 PictureBox

> ID：544636
> 
> 赞同：7
> 
> 时间：2009-02-13T03:50:05.610
> 
> 标签：vb.net

当满足 if 语句中的条件时，我需要将图片框旋转 180 度。这可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-13T04:04:29.787

我假设你想旋转里面的图像，因为旋转盒子本身没有多大意义（无论如何也不可能）。

试试这个：

```
myPictureBox.Image.RotateFlip(RotateFlipType.Rotate180FlipNone); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T04:09:21.133

System.Drawing.Image.RotateFlip() 方法允许您旋转图片框中显示的实际图像。看到[这个页面](http://msdn.microsoft.com/en-us/library/system.drawing.image.rotateflip(VS.80).aspx)

```
Dim bitmap1 As Bitmap

Private Sub InitializeBitmap()
    Try
        bitmap1 = CType(Bitmap.FromFile("C:\Documents and Settings\All Users\" _
            & "Documents\My Music\music.bmp"), Bitmap)
        PictureBox1.SizeMode = PictureBoxSizeMode.AutoSize
        PictureBox1.Image = bitmap1
    Catch ex As System.IO.FileNotFoundException
        MessageBox.Show("There was an error. Check the path to the bitmap.")
    End Try

End Sub

Private Sub Button1_Click(ByVal sender As System.Object, _
    ByVal e As System.EventArgs) Handles Button1.Click

    If bitmap1 IsNot Nothing Then
   bitmap1.RotateFlip(RotateFlipType.Rotate180FlipY)
        PictureBox1.Image = bitmap1
    End If

End Sub 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-17T21:37:24.237

```
PictureBox1.Image.RotateFlip(RotateFlipType.Rotate180FlipNone)
PictureBox1.Refresh() 
```

当您尝试使用以下方式旋转图像时：

```
PictureBox1.Image.RotateFlip(RotateFlipType.Rotate180FlipNone) 
```

在您关闭表单并再次打开它（不是项目，只是表单）之前，什么都不会发生。如果你想一次旋转，那么你应该使用`PictureBox1.Refresh()`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T04:06:35.290

您掌握了 http://www.codeproject.com/KB/cpp/rimage.aspx 中给出的 C++ 概念， [并且](http://www.codeproject.com/KB/cpp/rimage.aspx) 可以使用 http://www.eggheadcafe.com/community/aspnet/ 中给出的 [VB.net 14/10053817/rotating-picturebox-contr.aspx](http://www.eggheadcafe.com/community/aspnet/14/10053817/rotating-picturebox-contr.aspx)

# php - 使用 PHP 的 Flex

> ID：544640
> 
> 赞同：1
> 
> 时间：2009-02-13T03:51:20.863
> 
> 标签：php, apache-flex

我是 Flex 的新手，只用客户端编程完成了一些应用程序。现在我正在尝试使用 PHP 做后端的东西。有人可以解释将 PHP 文件放在哪里（哪个文件夹），以便 Flex 文件与 PHP 进行通信。我正在使用 Flexbuilder 3 IDE。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T03:58:21.813

Flex 不会通过文件系统访问您的 PHP 脚本，您必须通过 Web 服务器调用您的 PHP 脚本。最简单的解决方案是在数据传输语言中使用 XML。但是您可以花哨并使用 BlazeDS 之类的东西

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T15:03:02.030

这一切都取决于你想要什么。如果您只想偶尔轮询服务器，而不是希望在两者之间有一个常规接口，我会提出一个非常不同的建议。

如果您只是轮询服务器，我建议您只使用 HTTPRequest 类。它将允许您创建 POST 和 GET 数据并提供相对良好的通信。

另一方面，如果您希望在服务器和 SWF 之间进行更复杂的通信集，最好的选择是带有 AMFPHP、WebOrb 或等效的 RemoteObject 类（我们在我工作的地方使用 WebOrb）。这样做的好处是允许您在 Flex 和 PHP 中拥有相似名称/类型的对象，这意味着可以使通信更加全面。

（如果您正在以这种方式工作，请给我发电子邮件 cwATallen-poole.com，我可以提供一些建议，以免您对 Flex 产生疯狂的编译器参数）。

下一个选项是使用 XMLSocket 类，但这似乎比您正在寻找的更强烈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T04:47:43.507

您可能也想看看[AMFPHP](http://www.amfphp.org/)，非常方便。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-25T11:20:20.427

Try XAMPP.Very useful.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-05T00:17:48.833

The new Flash Builder 4 (product formerly known as FlexBuilder) supports connecting to PHP services out of the box. The use the Zend Framework to do it, and will install the framework to your test webserver for you whenever you go to setup a data service.

Adobe video tutorials: [Part 1](http://labs.adobe.com/technologies/flashbuilder4/tutorials/php1/) [Part 2](http://labs.adobe.com/technologies/flashbuilder4/tutorials/php2/)

[Another good, non-video tutorial](http://www.phpbuilder.com/columns/wallace20000608.php3)

# asp.net-membership - 为什么 ValidateUser 不返回更多？

> ID：544646
> 
> 赞同：5
> 
> 时间：2009-02-13T03:54:38.250
> 
> 标签：asp.net-membership, membership, membership-provider

我正在使用标准的 .NET 会员提供程序，并认为我会看看是否有人可以对此有所了解。

调用 ValidateUser 返回 true 或 false。现在，由于该方法接受用户名和密码，因此可以推断返回结果将反映无效的用户名或密码。然而，如果我们进一步深入研究，我们会发现它也在检查 IsLockedOut 和 IsApproved。

```
public override bool ValidateUser (string username, string password)
{
    MembershipUser user = GetUser (username, false);
    /* if the user is locked out, return false immediately */
    if (user.IsLockedOut)
        return false;
    /* if the user is not yet approved, return false */
    if (!user.IsApproved)
        return false;
    ...... 
```

在我的应用程序中，我想将 IsApproved 用于我自己的方式。简单地滚动我自己的提供者是行不通的，因为我仍然受限于 bool 结果。创建用户为我们提供了我们需要的所有信息，那么为什么不 ValidateUser 呢？我错过了什么吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-13T04:05:11.457

我希望您看到的是一个安全决定——通过限制返回的信息，他们不会向恶意方提供信息。

想象一下，你是 Cyril Cracker，试图闯入一个网站。

场景＃1：您尝试输入用户名“Admin”和密码“Password”，系统告诉您不可以。您拥有的唯一信息是管理员/密码不是有效的组合。

场景#2：您尝试输入用户名“Admin”和密码“Password”，系统告诉您没有知道该名称的用户。您可以继续尝试不同的用户名，直到找到一个已知*的*用户名。

场景＃3：您尝试输入用户名“Admin”和密码“Password”，系统告诉您没有密码无效。突然，您知道“管理员”是一个有效用户。你学到了一些有用的东西，你需要不断猜测的只是密码。

场景#4：您尝试输入用户名“Admin”和密码“Password”，系统告诉您该帐户已被阻止。现在，您知道有效的用户名和密码，并且该帐户已被阻止。您可以稍后再回来再试一次。

将 bean 溢出到有效和无效的系统被称为**聊天系统**，它们被认为不安全是有充分理由的，因为它们更容易破解。

希望这会有所帮助。

# ajax - WebKit 是那些实现即将到来的 x-domain XMLHttpRequest 功能的浏览器之一吗？

> ID：544658
> 
> 赞同：3
> 
> 时间：2009-02-13T04:01:15.363
> 
> 标签：ajax, browser, cross-browser, webkit, cross-domain

许多下一代浏览器（FF 3.1、IE8）将以一种或其他方式支持跨域 XMLHttpRequest（只要服务器选择加入等，存在安全问题）。

WebKit 中也会有同样的功能吗？

FF：[https ://developer.mozilla.org/en/Cross-Site_XMLHttpRequest](https://developer.mozilla.org/en/Cross-Site_XMLHttpRequest)

即：http : [//blogs.msdn.com/ie/archive/2008/06/23/securing-cross-site-xmlhttprequest.aspx](http://blogs.msdn.com/ie/archive/2008/06/23/securing-cross-site-xmlhttprequest.aspx)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-20T20:06:45.413

对此的基本支持已于 5 月添加到 WebKit（请参阅此[补丁](http://trac.webkit.org/changeset/34041)）。从那时起，已经有许多其他补丁对其进行了清理并重构了 WebKit 的一些部分，以处理所需的更改以及跟踪规范的更改。由于规范最近发生了变化（并且 webkit已在 3 天前进行了[更新](http://trac.webkit.org/changeset/41046)），我认为可以安全地假设目前没有任何正在发布的浏览器支持它，但他们中的大多数将来会支持它，并且当前的 WebKit nightlies 正在跟踪标准相当接近。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-13T04:06:12.093

我认为这确实符合标准（[http://www.w3.org/TR/XMLHttpRequest/](http://www.w3.org/TR/XMLHttpRequest/)），而不是浏览器框架或 javascript 引擎。

事实上，我完全不同意微软决定[自己](http://msdn.microsoft.com/en-us/library/cc288060(VS.85).aspx)实现与 W3C 标准无关的东西。今天的网络一团糟，主要是因为微软的丑陋实现。

根据 WebKit，它们似乎与 W3C 保持同步。

这里还有一篇很好的文章：[http ://ajaxian.com/archives/the-fight-for-cross-domain-xmlhttprequest](http://ajaxian.com/archives/the-fight-for-cross-domain-xmlhttprequest)

*如果您正在寻找使用ajax*样式（不使用 XMLHttpRequest 对象）进行跨域通信的其他方式，您应该查看[JSONP](http://remysharp.com/2007/10/08/what-is-jsonp/)，它目前在所有浏览器上都完全受支持。

# c - 有什么普通的理由使用 open() 而不是 fopen()？

> ID：544662
> 
> 赞同：7
> 
> 时间：2009-02-13T04:03:25.657
> 
> 标签：c, file, posix, libc

经过很长一段时间后，我正在用 C 语言做一个小项目。这些恰好包括一些文件处理。我在各种文档中注意到，有些函数返回`FILE *`句柄，有些函数返回（小整数）描述符。两组功能都提供了我需要的相同基本服务，所以我使用它真的没关系。

但我很好奇收藏智慧：是用`fopen()`和朋友更好，还是`open()`和朋友更好？

**编辑**由于有人提到缓冲与非缓冲和访问设备，我应该补充一点，这个小项目的一部分将在 FUSE 下编写用户空间文件系统驱动程序。因此，文件级别的访问可以像在“文件”（即图像）上一样容易地在设备（例如 CDROM 或 SCSI 驱动器）上进行。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-13T04:15:49.777

如果您坚持使用类似 unix 的系统，最好使用 open() 并且您可能希望：

*   对文件创建时的 unix 权限位进行更细粒度的控制。
*   使用较低级别的函数，例如 read/write/mmap，而不是 C 缓冲流 I/O 函数。
*   使用基于文件描述符 (fd) 的 IO 调度（轮询、选择等） 您当然可以使用 fileno() 从 FILE * 获取 fd，但必须注意不要将基于 FILE * 的流函数与基于 fd 的函数混合.
*   打开任何特殊设备（不是常规文件）

最好使用 fopen/fread/fwrite 以获得最大的可移植性，因为这些是标准 C 函数，我上面提到的函数不是。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-13T04:27:53.337

“fopen”是可移植的而“open”不是可移植的反对意见是虚假的。

fopen 是 libc 的一部分，open 是一个 POSIX 系统调用。

每个都像他们来自的地方一样便携。

fopen'ed 文件的 i/o 是（您必须假设它可能是，并且出于实际目的，它是）由 libc 缓冲，文件描述符 open()'ed 不由 libc 缓冲（它们很可能并且通常是缓冲在文件系统中——但不是你 open() 的所有内容都是文件系统上的文件。

fopen'ing 有什么意义，例如，像 /dev/sg0 或 /dev/tty0 这样的设备节点……你打算做什么？您要对 FILE * 执行 ioctl？祝你好运。

也许你想用 O_DIRECT 之类的标志打开——用 fopen() 没有意义。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-13T04:18:39.020

fopen 在比 open 更高的级别上工作.... fopen 返回一个指向 FILE 流的指针，它类似于您在 C++ 中读取的流抽象

open 为您返回打开文件的文件描述符...它不为您提供流抽象，您自己负责处理位和字节...与 fopen 相比，它处于较低级别

Stdio 流被缓冲，而 open() 文件描述符则没有。取决于你需要什么。您也可以从另一个创建一个：

int fileno (FILE * stream) 返回 FILE * 的文件描述符，FILE * fdopen(int fildes, const char * mode) 从文件描述符创建 FILE *。

混合缓冲和非缓冲 IO 时要小心，因为如果不使用 fflush() 刷新缓冲区，则会丢失缓冲区中的内容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-13T04:08:31.650

是的。当您需要一个低级句柄时。

在 UNIX 操作系统上，您通常可以交换文件句柄和套接字。

此外，与 FILE 指针相比，低级句柄具有更好的 ABI 兼容性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-13T04:07:30.263

通常，您应该倾向于使用标准库 (fopen)。但是，有时您需要直接使用 open。

想到的一个例子是解决旧版本的 solaris 中的一个错误，该错误导致 fopen 在打开 256 个文件后失败。这是因为他们在 struct FILE 实现中错误地将 unsigned char 用于 fd 字段，而不是 int。但这是一个非常具体的案例。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-03T21:40:36.580

*read()* & *write()* 使用无缓冲 I/O。( ***fd*** : 整数文件描述符)

*fread()*和*fwrite()* 使用缓冲 I/O。（***文件****结构指针）

*由于字节对齐、可变大小等原因，使用write() 写入* 管道的二进制数据***可能无法***使用*fread()*读取二进制数据。这是一个废话。

大多数低级设备驱动程序代码使用无缓冲的 I/O 调用。

大多数应用程序级 I/O 使用缓冲。

在逐个机器的基础上使用*FILE * 及其相关函数是可以的：但是在其他体系结构上在读写二进制数据时会丢失可移植性。*fwrite() 是缓冲 I/O，如果为 64 位架构编写并在 32 位上运行，可能会导致不可靠的结果；或（Windows/Linux）。大多数操作系统在自己的代码中都有兼容性宏来防止这种情况。

对于低级二进制 I/O 可移植性， *read()*和*write()*保证在不同架构上编译时相同的二进制读取和写入。基本的事情是在整个二进制套件中选择一种方式并保持一致。

```
<stdio.h>  // mostly FILE*  some fd input/output parameters for compatibility
             // gives you a lot of helper functions -->
List of Functions
       Function      Description
       ───────────────────────────────────────────────────────────────────
       clearerr      check and reset stream status
       fclose        close a stream
       fdopen        stream open functions //( fd argument, returns FILE*)                      feof          check and reset stream status
       ferror        check and reset stream status
       fflush        flush a stream
       fgetc         get next character or word from input stream
       fgetpos       reposition a stream
       fgets         get a line from a stream
       fileno        get file descriptor   // (FILE* argument, returns fd) 
       fopen         stream open functions
       fprintf       formatted output conversion
       fpurge        flush a stream
       fputc         output a character or word to a stream
       fputs         output a line to a stream
       fread         binary stream input/output
       freopen       stream open functions
       fscanf        input format conversion
       fseek         reposition a stream
       fsetpos       reposition a stream
       ftell         reposition a stream
       fwrite        binary stream input/output
       getc          get next character or word from input stream
       getchar       get next character or word from input stream
       gets          get a line from a stream
       getw          get next character or word from input stream
       mktemp        make temporary filename (unique)
       perror        system error messages
       printf        formatted output conversion
       putc          output a character or word to a stream
       putchar       output a character or word to a stream
       puts          output a line to a stream
       putw          output a character or word to a stream
       remove        remove directory entry
       rewind        reposition a stream
       scanf         input format conversion
       setbuf        stream buffering operations
       setbuffer     stream buffering operations
       setlinebuf    stream buffering operations
       setvbuf       stream buffering operations
       sprintf       formatted output conversion
       sscanf        input format conversion
       strerror      system error messages
       sys_errlist   system error messages
       sys_nerr      system error messages
       tempnam       temporary file routines
       tmpfile       temporary file routines
       tmpnam        temporary file routines
       ungetc        un-get character from input stream
       vfprintf      formatted output conversion
       vfscanf       input format conversion
       vprintf       formatted output conversion
       vscanf        input format conversion
       vsprintf      formatted output conversion
       vsscanf       input format conversion 
```

**因此，对于基本用途，我会亲自使用上述内容，而不会过多地混合成语。**

相比之下，

```
<unistd.h>   write()
             lseek()
             close()
             pipe()
<sys/types.h>
<sys/stat.h>
<fcntl.h>  open()
           creat()
           fcntl() 
all use file descriptors. 
```

这些提供了对读取和写入字节的细粒度控制（推荐用于特殊设备和 fifos（管道））。

再说一次，使用你需要的东西，但在你的习惯用法和界面上保持一致。如果您的大部分代码库都使用一种模式，那么也使用它，除非有真正的理由不这样做。两组 I/O 库函数都非常可靠，每天使用数百万次。

*注意——*如果您正在将 CI/O 与另一种语言（perl、python、java、c#、lua ...）进行交互，请在编写 C 代码之前*查看*这些语言的开发人员推荐的内容，这样可以省去一些麻烦。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-13T04:58:03.433

fopen 和它的表兄弟是缓冲的。打开、读取和写入不会被缓冲。您的应用程序可能会或可能不会在意。

fprintf 和 scanf 具有更丰富的 API，允许您读取和写入格式化的文本文件。读写使用基本的字节数组。转换和格式必须是手工制作的。

文件描述符和 (FILE *) 之间的区别实际上是无关紧要的。

兰迪

# mysql - 如何在mysql中进行此查询？

> ID：544673
> 
> 赞同：1
> 
> 时间：2009-02-13T04:07:54.227
> 
> 标签：mysql, select, logical-operators

从项目中选择`item_name`WHERE `item_id`= $var;

我试过：

$var = 001 || 002 || 003 || 004;

$var = 001 或 002 或 003 或 004；

$var = 001 或 002 或 003 或 004；

但都不起作用。

谢谢，我试试看，但输出只有 1 个结果 => 1。

我想要的是输出全部，即 1、2、3 和 4 .. 意思是，我想从 1 列中选择多个记录（行）

怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-13T04:08:58.530

```
SELECT item_name from items WHERE item_id IN (1, 2, 3, 4) 
```

如果出于某种原因`item_id`是：`VARCHAR`

```
SELECT item_name from items WHERE item_id IN ('001', '002', '003', '004') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T04:10:24.437

或者你可以使用：

SELECT item_name from items WHERE item_id = 001 OR item_id = 002 etc.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T04:10:35.450

正确的 SQL 语法应该是：

```
SELECT item_name from items WHERE item_id = 001 or item_id = 002 or item_id=003; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T04:16:29.587

你有比你提出的问题更大的问题。您尝试编写的查询是微不足道的，而您对此有点迷失的事实并不好。

如果我是你，我会退后一步，复习一些关于 sql 的教程。在继续之前花几个小时（或几天）学习该主题。

当然，您可以尝试“完成任务”，但您编写的查询可能会遇到严重的安全和/或性能问题。

那里有很多很好的教程。去阅读它们。

祝你好运！

# c# - 在 C# 中以编程方式杀死 vista/windows 7 中的进程

> ID：544687
> 
> 赞同：10
> 
> 时间：2009-02-13T04:13:14.307
> 
> 标签：c#, windows-vista, process, kill

我想在 vista/windows 7 中以编程方式终止一个进程（我不确定两者之间的 UAC 实施是否存在重大问题以产生影响）。

现在，我的代码如下所示：

```
 if(killProcess){
      System.Diagnostics.Process[] process = System.Diagnostics.Process.GetProcessesByName("MyProcessName");
       // Before starting the new process make sure no other MyProcessName is running.
        foreach (System.Diagnostics.Process p in process)
        {
            p.Kill();
        }

        myProcess = System.Diagnostics.Process.Start(psi);
   } 
```

我必须这样做，因为我需要确保如果用户使程序崩溃或突然退出，则在重新启动应用程序时会重新启动此辅助进程，或者如果用户想要更改此辅助进程的参数。

该代码在 XP 中运行良好，但在 Windows 7（我假设在 Vista 中）中失败，并显示“访问被拒绝”消息。根据全能谷歌告诉我的内容，我需要以管理员身份运行我的杀戮程序来解决这个问题，但这只是弱点。另一个可能的答案是使用 LinkDemand，但我不理解 LinkDemand 的 msdn 页面，因为它与进程有关。

我可以将代码移动到一个线程中，但这有很多其他固有的困难，我真的不想发现。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-13T04:25:20.690

您是正确的，因为您没有管理权限。您可以通过在本地系统用户下安装服务并根据需要对其运行自定义命令来解决此问题。

在您的 Windows 窗体应用程序中：

```
private enum SimpleServiceCustomCommands { KillProcess = 128 };

ServiceControllerPermission scp = new ServiceControllerPermission(ServiceControllerPermissionAccess.Control, Environment.MachineName, "SERVICE_NAME");
scp.Assert();
System.ServiceProcess.ServiceController serviceCon = new System.ServiceProcess.ServiceController("SERVICE_NAME", Environment.MachineName);
serviceCon.ExecuteCommand((int)SimpleServiceCustomCommands.KillProcess);

myProcess = System.Diagnostics.Process.Start(psi); 
```

在您的服务中：

```
private enum SimpleServiceCustomCommands { KillProcess = 128 };

protected override void OnCustomCommand(int command)
{
    switch (command)
    {
        case (int)SimpleServiceCustomCommands.KillProcess:
            if(killProcess)
            {
                System.Diagnostics.Process[] process = System.Diagnostics.Process.GetProcessesByName("MyProcessName");
                // Before starting the new process make sure no other MyProcessName is running.
                foreach (System.Diagnostics.Process p in process)
                {
                    p.Kill();
                }
            }
            break;
        default:
            break;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T05:30:25.540

我将为 Simon Buchan 的建议添加代码。这是有道理的，并且应该也可以工作，假设您的 Windows 窗体首先启动了该过程。

这是您创建流程的地方。注意变量 myProc。这就是你的处理方式：

```
System.Diagnostics.Process myProc = new System.Diagnostics.Process();
myProc.EnableRaisingEvents=false;
myProc.StartInfo.FileName="PATH_TO_EXE";
myProc.Start(); 
```

稍后，只需使用以下命令将其杀死：

```
myProc.Kill(); 
```

# sharepoint - 文档库爬网

> ID：544688
> 
> 赞同：2
> 
> 时间：2009-02-13T04:13:28.627
> 
> 标签：sharepoint, search, web-crawler

我设置了一个新范围，并传入了我创建的包含 2 个 word 文档的特定文档库的 URL。

出于某种原因，当我开始完全爬网时，它看不到 2 字文档。

Word 文档具有元数据，并且我创建了映射爬网属性的托管属性。

我正在尝试利用高级搜索 webpart 来从这个范围进行搜索。当我输入诸如 word 文档的文件名之类的搜索词时，没有返回任何结果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T04:59:38.860

您需要使文档库可搜索。通过文档库属性启用它。

## 编辑

请参阅[SharePoint 搜索中的利用属性](https://web.archive.org/web/20070831010632/http://www.intranetjournal.com/articles/200508/ij_08_29_05a.html)

要进入文档库高级设置页面，请从给定库中选择“设置”下拉菜单中的“文档库设置”菜单项，然后选择“常规设置”标题下的“高级设置”超链接。在那里的某个地方，您应该看到类似于下图的内容。确保单选按钮设置为是。[来源](http://community.bamboosolutions.com/blogs/sharepoint_blank/archive/2008/10/21/sharepoint-document-library-advanced-settings.aspx)

[![替代文字](https://i.stack.imgur.com/rtuFg.jpg)](https://i.stack.imgur.com/rtuFg.jpg)
[（来源：[bamboosolutions.com](http://community.bamboosolutions.com/cfs-filesystemfile.ashx/__key/CommunityServer.Blogs.Components.WeblogFiles/bambooteamblog/Search.jpg)）]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T03:56:21.087

爬虫以什么帐户运行？也许该帐户没有对列表的读取权限，因此无法对其进行索引。

使用默认搜索范围时，您能否从其他文档库中的相同文档中查找信息？

您可以使用默认搜索范围从该文档库中查找信息吗？

您是在尝试创建自定义搜索结果页面，还是只是范围？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T06:49:15.663

要尝试的一件事是检查搜索爬网日志以查看在搜索库时是否有任何错误。

# debugging - 随着代码变得越来越复杂，有哪些好的策略可以修复错误？

> ID：544696
> 
> 赞同：19
> 
> 时间：2009-02-13T04:16:03.537
> 
> 标签：debugging, language-agnostic

我“只是”一个业余程序员，但我发现随着我的程序变得越来越长，错误变得越来越烦人——而且更难跟踪。就在一切看似顺利的时候，一些新的问题会出现，似乎是自发的。我可能需要很长时间才能弄清楚导致问题的原因。其他时候我会添加一行代码，它会破坏另一个单元中的某些内容。如果我认为一切正常，这可能会令人沮丧。

这对每个人来说都很常见，还是更像是一种新手？我听说过“单元测试”、“设计框架”和其他各种听起来会减少错误、使我的应用程序“健壮”的概念，并且所有内容一目了然:)

那么，对于受过专业培训的人来说，漏洞有多大？

谢谢——Al C.

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-13T04:21:18.203

“进行修复，在别处引起问题”的问题是众所周知的，并且确实是单元测试背后的主要动机之一。

这个想法是，如果您为系统的每个小部分独立编写详尽的测试，并在每次您在任何地方进行更改时在整个系统上运行它们，您将立即发现问题。然而，主要的好处是，在构建这些测试的过程中，您还将改进代码以减少依赖关系。

这类问题的典型解决方案是减少耦合；减少不同的部分相互依赖。更有经验的开发人员有时具有以这种方式构建系统的习惯或设计技能。例如，我们使用接口和实现而不是类；我们将模型-视图-控制器用于用户界面等。此外，我们可以使用有助于进一步减少依赖关系的工具，例如“依赖注入”和面向方面的编程。

所有的程序员都会犯错。优秀且经验丰富的程序员构建他们的程序，以便更容易发现错误并限制其影响。

这对每个人来说都是一件大事。大多数公司花在维护上的时间多于编写新代码的时间。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-13T04:54:51.913

你在**自动化你的测试**吗？如果你不这样做，你就注册创建错误而没有找到它们。

您是否**在修复错误时添加测试**？如果您不这样做，那么您就是在注册一遍又一遍地创建相同的错误。

你在**写单元测试**吗？如果没有，您将在测试失败时注册长时间的调试会话。

您是**先编写单元测试**吗？否则，当您的单元紧密耦合时，您的单元测试将很难编写。

你是在无情地**重构吗？**否则，每次编辑都会变得更加困难，并且更有可能引入错误。（但首先要确保你有好的测试。）

当你修复一个错误时，你是在**修复整个班级**吗？不要只是修复错误；不要只修复整个代码中的类似错误；改变游戏，这样你就永远不会再制造那种错误了。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-13T05:09:40.787

虫子对每个人来说都很重要。我一直发现，我编程的越多，我对编程的了解就越多。我对几年前写的代码感到畏缩！！我一开始是个业余爱好者，非常喜欢它，所以我去了工程学院攻读计算机科学工程专业（我在最后一个学期）。这些是我学到的东西：

1.  我花时间实际设计我要写的东西并记录设计。它确实消除了很多问题。无论设计是简单地写下我要写的内容还是完整的 UML 建模 (:( ) 都无关紧要。重要的是思想和目的的清晰性以及当我来的时候有材料可以回顾一段时间后回到最重要的代码。

2.  无论我用什么语言编写，保持我的代码简单易读都很重要。我认为不要过度复杂化代码同时不要过度简化它是非常重要的。（惨痛的教训！！）

3.  效率优化和花哨的技巧应该在最后应用，只有在必要时才需要。另一件事是我只应用它们如果我真的知道我在做什么并且我总是测试我的代码！

4.  学习语言相关的细节有助于我保持我的代码没有错误。例如，我了解到 scanf() 在 C 中是邪恶的！

5.  其他人已经评论了编写测试的禅宗。我想补充一点，您应该始终进行回归测试。（即编写新代码，测试代码的所有部分以查看是否中断）

6.  有时很难在脑海中保持对代码的了解，所以我总是记录我的代码。

7.  我使用方法来确保我的代码的不同部分之间存在最低限度的依赖关系。接口、类层次结构等（解耦设计）

8.  在我编写代码之前思考并在我写的任何东西中受到纪律是另一项关键技能。我认识一些不格式化他们的代码的人，所以它的可读性（颤抖！）。

9.  阅读其他人的资源以学习最佳实践是很好的。制作我自己的清单更好！在团队中工作时，必须有一组共同的。

10.  不要被分析麻痹。编写测试，然后编写代码，然后执行和测试。漂洗重复！

11.  学习阅读我自己的代码并梳理错误是很重要的。提高我的调试技能是一项巨大的投资。我通过帮助我的同学定期修复错误来保持他们的敏锐度。

12.  当我的代码中有错误时，我认为是我的错误，而不是计算机并从那里开始工作。这是一种对我很有帮助的心态。

13.  一双新的眼睛有助于调试。程序员在精疲力竭时往往会错过自己代码中最明显的错误。有人向您展示您的代码非常棒。

14.  有人提出想法而不被评判是很重要的。我和我妈妈（不是程序员）交谈，向她提出想法并找到解决方案。她帮助我来回调整我的想法并完善它们。如果她不在，我会和我的宠物猫交谈。

15.  我不再对错误感到灰心了。我学会了像编程一样热爱消除错误。

16.  使用版本控制确实帮助我管理我在编码时得到的不同想法。这有助于减少错误。我建议使用 git 或您可能喜欢的任何其他版本控制系统。

17.  正如 Jay Bazzuzi 所说——重构代码。我只是在阅读他的回答后添加了这一点，以保持我的列表完整。所有的功劳都归于他。

18.  尝试编写可重用的代码。重用您的代码和库中的代码。使用没有错误的库来执行一些常见任务确实可以减少错误（有时）。

我认为下面的引用说得最好——“如果调试是消除错误的艺术，那么编程必须是把它们放进去的艺术。”

任何不同意的人都没有冒犯。我希望这个答案有帮助。

**注意**
正如其他人 Peter 所指出的，如果您正在编写大量代码，请使用面向对象编程。代码长度有限制，如果以程序方式编写，代码长度将变得越来越难管理。我喜欢小东西的程序，比如玩算法。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-13T04:30:38.600

1.  有两种方法可以编写无错误的程序；只有第三个有效。~艾伦·J·玻璃市

2.  程序中出现错误的唯一方法是由作者放在那里。没有其他机制是已知的。程序无法通过与其他有缺陷的程序坐在一起来获取错误。~哈兰米尔斯

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-13T04:22:57.777

显然，错误对任何程序员来说都是一件大事。只需查看 Stack Overflow 上的问题列表即可查看此说明。

业余爱好者和经验丰富的专业人士之间的区别在于，专业人士将能够利用他的经验以更“防御性”的方式进行编码，首先避免许多类型的错误。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-13T05:17:08.833

所有其他答案都很棒。我要补充两点。

1.  源代码控制是**强制性**的。我假设你在这里的窗户上。[VisualSVN Server](http://www.visualsvn.com/server/)是免费的，可能只需点击 4 次即可安装。[TortoiseSVN](http://tortoisesvn.net/)也是免费的，它集成到 Windows 资源管理器中，绕过了 VS Express 没有插件的限制。如果您创建了太多错误，您可以还原您的代码并重新开始。如果没有源代码控制，这几乎是不可能的。另外，如果您有笔记本电脑和台式机，您可以同步您的代码。
2.  人们会推荐许多技术，如单元测试、模拟、控制反转、测试驱动开发等。这些都是很好的实践，但不要试图将它们全部塞进你的脑海中。您必须编写代码才能更好地编写代码，因此请慢慢将这些技术运用到您的代码编写中。你必须在走路之前爬行，在你可以跑步之前走路。

祝您在编码冒险中好运！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-13T04:21:21.540

这是新手常见的事情。当然，随着您获得更多经验，您仍然会有错误，但它们会更容易找到和修复，因为您将学习如何使您的代码更加模块化（这样更改一件事就不会产生连锁反应其他任何地方），如何测试它，以及如何构建它以快速失败，接近问题的根源，而不是在某个任意的地方。不需要复杂的基础设施来实现的一件非常基本但有用的事情是检查所有函数的输入，这些函数具有断言的非平凡前提条件。这在我可能会遇到奇怪的段错误和几乎不可能调试的任意行为的情况下救了我好几次。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-13T04:45:47.100

如果 bug 不是问题，那么我可以在 10 分钟内编写一个 100,000 行的程序！

你的问题是，“作为一名业余医生，我担心病人的健康：有时我不够小心，他们会生病。病人的健康对你们专业医生也有问题吗？”

是的：这是核心问题，甚至是唯一的问题（对于任何足够全面的“错误”定义）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-13T05:17:35.337

错误对每个人都很常见——专业与否。

项目越大越分散，越要小心。查看任何开源错误数据库（例如：[https](https://bugzilla.mozilla.org/) ://bugzilla.mozilla.org/ ）都会为您确认这一点。

软件行业已经发展出各种[编程](http://en.wikipedia.org/wiki/Programming_style) [风格](http://en.wikipedia.org/wiki/Defensive_programming)和[标准](http://en.wikipedia.org/wiki/Hungarian_notation)，如果使用得当，可以更容易地发现错误代码或限制其影响。

因此，培训对代码质量有非常积极的影响……但归根结底，错误仍然潜伏着。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-13T08:07:03.027

如果你只是一个业余程序员，学习完整的 TDD 和 OOP 可能需要比你愿意投入的更多时间。所以，假设你不想把时间花在他们身上，一些减少错误的易于理解的建议是：

1.  让每个功能做一件事。怀疑超过 10 行的函数。如果您认为可以将其分解为两个功能，那么您可能应该这样做。可以帮助您控制这一点的方法是根据函数的确切功能命名您的函数。如果你发现你的名字又长又笨拙，那么你的功能可能是在做太多的事情。

2.  将魔术字符串转换为常量。也就是说，而不是使用：

    人[“妈妈”]

改为使用

```
var mom = "mom";
people[mom] 
```

3.  设计你的函数来做某事（命令）或获取某事（查询），但不能两者兼而有之。

[在这里http://www.holub.com/publications/notes_and_slides/Everything.You.Know.is.Wrong.pdf](http://www.holub.com/publications/notes_and_slides/Everything.You.Know.is.Wrong.pdf)对 OOP 进行了非常简短易懂的介绍。如果你明白了这一点，那么你就掌握了 OOP 的精髓，并且坦率地说，你已经领先于许多专业程序员。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-13T04:21:02.510

普遍的看法似乎是，普通程序员每 1000 行代码会产生 12 个错误——这取决于你要求谁提供确切的数字，但总是每行代码——所以，程序越大，错误就越多。

低于标准的程序员倾向于创造更多的错误。

新手经常被语言的特性所困，缺乏经验也容易出现更多的错误。随着你的继续，你会变得更好，但你永远不会创建无错误的代码......好吧，即使在 30 年后，我仍然有错误，但这可能只是我。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-13T04:36:59.460

从专业人士到业余爱好者，每个人都会遇到讨厌的错误。真正优秀的程序员会被要求追踪真正令人讨厌的错误。这是工作的一部分。当你盯着一个讨厌的 bug 看了两天，沮丧地大喊：“谁写了这个废话！？！？”时，你就会知道你已经成为一名软件开发人员了。......才意识到是你。:-)

软件开发人员的部分技能是能够将大量相互关联的项目直接记在他/她的脑海中。听起来你正在发现当你的系统心理模型崩溃时会发生什么。通过练习，您将学会设计感觉不那么脆弱的软件。有大量关于软件设计主题的书籍、博客等。Stack Overflow 当然是针对特定问题的。

综上所述，您可以做以下几件事：

1.  一个好的调试器是无价的。通常，您必须逐行检查代码才能找出问题所在。
2.  如果对您的项目有意义，请使用诸如 Python 或 Java 之类的垃圾收集语言。GC 将帮助您专注于使事情正常运行，而不是被令人抓狂的内存错误所困。
3.  如果您编写 C++，请学会爱上 RAII。
4.  写很多代码。软件在某种程度上是一种艺术形式。大量的练习会让你做得更好。

欢迎来到堆栈溢出！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-13T09:45:42.557

真正改变我对抗代码复杂性和错误的几率是使用编码标准——如何放置括号等等。它可能看起来只是无聊和无用的东西，但它确实统一了所有代码并使其更易于阅读和维护。那么你使用编码标准吗？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-13T05:15:27.557

如果您组织得不好，您的代码库将成为您自己的[Zebra Puzzle](http://en.wikipedia.org/wiki/Zebra_Puzzle)。添加更多代码就像在您的拼图中添加更多人/动物/房屋，很快您的拼图中就有 150 种不同的动物、人、房屋和香烟品牌，您意识到只需一周时间就可以添加 3 行代码，因为一切都是如此相互关联，以至于需要很长时间才能确保代码仍然按照你想要的方式执行。

最流行的组织范式似乎是[面向对象编程](http://en.wikipedia.org/wiki/Object-oriented_programming)，如果你能将你的逻辑分解成可以相互独立构建和使用的小单元，那么你会发现错误发生时的痛苦要小得多。

# visual-studio-2008 - Visual Studio 2008 - 为什么我的窗口不断重新排列自己？

> ID：544697
> 
> 赞同：2
> 
> 时间：2009-02-13T04:16:04.580
> 
> 标签：visual-studio-2008

每隔一段时间（每天至少几次），我的 VS2008 窗口就会重新排列自己。

团队/解决方案/服务器资源管理器 - 他们从右侧边栏跳到底部，或者突然变得自由浮动。

与错误/待更改/等相同。自由浮动或突然消失，就好像它们已经关闭一样。

这是非常奇怪的行为。有其他人经历过吗？我是否在做一些愚蠢的事情来解释这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-04T22:42:19.810

当我同时打开多个 Visual Studio 实例并进行更改时，就会发生这种情况。似乎设置是在 VS 关闭时存储的，所以最后一个关闭的实例将其设置保存在其他实例之上......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T14:07:45.480

打开新解决方案时会发生这种情况吗？.suo 文件包含我认为包括窗口位置的用户设置。

因此，不应将它们签入源代码管理，因为它们可以覆盖其他人的设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T15:41:07.033

I've seen this too. My current project is a web service, and both the client test program and the service projects are both part of the same sln. So, to test, I have the sln open in two VS2008 instances. I always figured this was why it was happening to me.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-04T22:37:50.303

我一直得到这个。据我所知，它没有“修复”。您最好的选择是导出您想要的设置，然后在出现问题时导入它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T04:34:14.100

这对我来说也是如此，通常在多显示器系统上。看看它是否在禁用附加组件的情况下做同样的事情，并考虑切换哪些显示器是主要的。

此外，请跟踪您上次是否干净地关闭了 VS 或因为它再次被冻结而结束了任务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-13T04:38:42.497

同上 - 这在我的双显示器设置中也随机发生在我身上。我希望有人能回答这个问题。

# c# - msdn网站上的会员和方法的区别？

> ID：544698
> 
> 赞同：3
> 
> 时间：2009-02-13T04:16:24.017
> 
> 标签：c#, msdn

[http://msdn.microsoft.com/en-us/library/bb351562.aspx](http://msdn.microsoft.com/en-us/library/bb351562.aspx) 当您转到左侧的该页面时，它具有指向该类的“成员”和“方法”的链接，但对我来说看起来相同。有区别吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-13T04:17:44.123

“成员”是类或接口中的任何内容，因此包括方法、字段、属性、子类型等等。在链接到的页面底部，您会注意到方法页面上缺少属性。

# c++ - C++ 中的指针和引用问题

> ID：544709
> 
> 赞同：2
> 
> 时间：2009-02-13T04:20:57.440
> 
> 标签：c++, pointers, reference

我有一个 PolygonList 和一个 Polygon 类型，它们是点列表的 std::lists 或点列表的列表。

```
class Point {
    public:
        int x, y;
        Point(int x1, int y1)
        {
            x = x1;
            y = y1;
        }
};

typedef std::list<Point> Polygon;
typedef std::list<Polygon> PolygonList;

// List of all our polygons
PolygonList polygonList; 
```

但是，我对引用变量和指针感到困惑。

例如，我希望能够引用我的 polygonList 中的第一个 Polygon，并向其推送一个新点。

所以我试图将多边形列表的前面设置为一个名为 currentPolygon 的多边形，如下所示：

```
 Polygon currentPolygon = polygonList.front();
 currentPolygon.push_front(somePoint); 
```

现在，我可以向 currentPolygon 添加点，但这些更改最终不会反映在多边形列表中的同一个多边形中。currentPolygon 只是polygonList 前面的 Polygon 的一个*副本吗？*当我稍后遍历 polyalList 时，我添加到 currentPolygon 的所有点都没有显示。

如果我这样做，它会起作用：

```
polygonList.front().push_front(somePoint); 
```

为什么这些不一样，我如何创建对物理前多边形的引用而不是它的副本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-13T04:25:12.657

像这样：

```
 Polygon &currentPolygon = polygonList.front();
 currentPolygon.push_front(somePoint); 
```

名称前的 & 符号表示这是一个参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-18T00:54:20.073

```
 Polygon currentPolygon = polygonList.front(); 
```

由于类 Polygon 不会重载赋值运算符，因此编译器会默默地为您执行此操作并在此行实例化它。

在编译器引入的版本中实现的赋值运算符的默认行为是制作对象的副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T04:36:23.503

您可能应该首先将您的列表定义为指针列表：

```
typedef std::list<Point> Polygon;
typedef std::list<Polygon*> PolygonList; 
```

这避免了昂贵的复制。当然，那时您将需要进行一些手动内存管理。

# eclipse - 发布需要大于默认 JVM 堆的 Eclipse 插件的最佳策略/实践？

> ID：544725
> 
> 赞同：3
> 
> 时间：2009-02-13T04:24:48.397
> 
> 标签：eclipse, memory

我正在开发一个 Eclipse 插件，并将开始在会议和其他场所展示它，以便人们安装它。

该插件的一个限制是，由于它必须维护的信息量才能工作，它需要比默认分配给 Eclipse 更多的堆空间。即使在拥有大量 RAM 的计算机上，Eclipse 也以极小的最大堆运行，许多开发人员从不费心去修复这个问题，尤其是在运行新版本时。

如果我的插件在没有足够堆空间的系统上运行，它可能会减慢 Eclipse。

解决这个问题的最佳策略是什么？是否有一些通过 Eclipse 的官方方式？每次插件启动时都会检查运行时间？等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T07:29:50.840

现在似乎有办法在运行时增加堆空间（由这个[SO question](https://stackoverflow.com/questions/514487/modify-jvm-args-from-inside-the-jvm)确认）

[因此，在此 OSGI 包的ACTIVE 状态](http://www.osgi.org/javadoc/r4v41/org/osgi/framework/Bundle.html)下运行时检查应该是唯一的选择（带有可见警告、错误视图中的日志条目以及从此插件立即停止）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T04:43:41.650

首次运行插件时检查 -Xmx 设置，如果太低建议自动增加它。（只需将更改直接写入 eclipse.ini 即可。）

据我所知，没有其他办法。

# java - 哪个 HTML 标记最适合用于 Java 小程序（APPLET、EMBED、OBJECT）？

> ID：544732
> 
> 赞同：3
> 
> 时间：2009-02-13T04:27:01.870
> 
> 标签：java, html, applet

我的理解是 APPLET 已被弃用，而 OBJECT 是用于 Java 小程序的首选标记。这个对吗？很多 Java 小程序示例，无论是在网络上还是在书籍中，似乎仍然使用 APPLET 标记。

OBJECT 是否存在任何浏览器兼容性问题（与 APPLET 相比）？

另外，您能否提供一个 Java 小程序正确使用 OBJECT 标记的示例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T04:30:15.640

这是您[最好的选择](http://java.sun.com/products/plugin/versions.html)。以下是所有标签的[示例](http://java.sun.com/j2se/1.4.2/docs/guide/plugin/developer_guide/using_tags.html)。

# java - 使用 JTextArea 制作剪切/替换方法

> ID：544740
> 
> 赞同：0
> 
> 时间：2009-02-13T04:32:27.007
> 
> 标签：java, swing, jtextarea

我将在 JTextArea 上进行剪切和替换方法。我有用于复制和粘贴的代码，我认为我可以使用它，除了删除 JTA 中的标记文本。

剪切和替换方法的代码看起来如何？

复制代码如下所示：

```
public void copy(){
    int start=ta.getSelectionStart();
    int end=ta.getSelectionEnd();
    String s=ta.getText();
    aString=s.substring(start,end);
    System.out.println(aString);
} 
```

粘贴代码如下所示：

```
public void paste(){
    int start=ta.getSelectionStart();
    String startText=ta.getText().substring(0, start);
    String endText=ta.getText().substring(start);
    String res=startText+clipBoard+endText;
    ta.setText(res);
} 
```

所以基本上：如何删除 JTextArea 中的标记文本？或者有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T05:18:39.920

JTextArea 默认使用关键字组合（Ctrl+C 等）支持剪切/复制/粘贴。如果您想要自定义调用（如菜单操作），JTextComponent 本身提供了可以重复使用的剪切/复制/粘贴方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T04:41:42.040

我想它会混合使用这两种方法，没有*剪贴板*连接。

```
public void cut(){
  int start=ta.getSelectionStart();
  int end=ta.getSelectionEnd();
  String startText=ta.getText().substring(0, start);
  String endText=ta.getText().substring(end, ta.getText.length());
  ta.setText(startText+endText);
} 
```

但是，为什么不使用JTextComponent 的*cut*、*copy*和*paste*方法，它们已经被继承并可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T05:43:06.377

除了 amit.dev 的答案之外，您还应该能够设置自定义键映射以使用您想要的任何键......但如果这样做，您将失去一些平台独立性，因为不同的平台有不同的键用于这些操作.

# javascript - 如何通过openwysiwig外部的javascript代码向openwysiwig编辑器添加文本

> ID：544749
> 
> 赞同：0
> 
> 时间：2009-02-13T04:40:13.883
> 
> 标签：javascript, openwysiwyg

我有一个页面来编辑来自 db 的一些 html 代码，为此我使用 openwysiwig [http://www.openwebware.com/wysiwyg/demo.shtml](http://www.openwebware.com/wysiwyg/demo.shtml)，它托管在 textarea 上，在编辑器中实现的插入图像和超链接的功能不是t 非常适合我，所以我需要找到一些代码来帮助我从编辑器本身外部更改/插入文本到该区域。

我试图找到解决方案，但找不到任何有价值的东西；我只知道 openwysiwig 在主机 textarea 或类似的东西上创建 iframe；除此之外，没有什么可以解决我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T04:52:05.897

这也许不是很有帮助，但是像 tinymce 或 fckeditor 这样的东西有更好的文档记录。我建议改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T05:50:18.177

不知道为什么[FCKEditor](http://www.fckeditor.net/)失败了~投票，但它肯定可以做你需要的。它有一个非常有用的[javascript API](http://docs.fckeditor.net/FCKeditor_2.x/Developers_Guide/JavaScript_API)，它允许你很容易地将元素插入到编辑器区域。它还与各种服务器技术很好地集成，并包括一个精心设计的插件架构以进行扩展。有很多支持和示例代码，我在棘手的 ajax 驱动环境中使用过它，并且对它的功能非常满意。我找不到任何可用于 openwysiwyg 的 Javascript api 文档。我想你应该可以在一小时内启动并运行 FCK

# mysql - 如何从mysql中的列中选择多条记录（行）？

> ID：544750
> 
> 赞同：4
> 
> 时间：2009-02-13T04:40:27.097
> 
> 标签：mysql, select

我想从这些 id 中显示四 (4) 个项目的名称：我可以这样做吗？

```
SELECT item_name from items WHERE item_id IN ('001', '012', '103', '500') 
```

或者

```
SELECT item_name from items WHERE item_id = '001' or item_id = '012' or item_id = '103' or item_id = '500' 
```

**回应所有答案**

好吧，大多数答案都说它有效，但实际上并没有。这是我的代码：

```
$query = "SELECT `item_name` from items WHERE item_id IN('s001','a012','t103','p500')";

$result = mysql_query($query, $conn) or die (mysql_error());
$fetch =  mysql_fetch_assoc($result) or die (mysql_error());
$itemsCollected = $fetch['item_name'];
echo $itemsCollected; 
```

是`item_id`字母数字。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-13T04:44:15.293

您可以执行其中任何一项，但对于任何大型查询，IN 查询都更有效。很久以前我做了一些简单的测试，结果表明使用 IN 结构的速度大约快 10 倍。如果您询问语法是否正确，那么是的，它看起来很好，除了缺少分号来完成语句。

**编辑**：看起来你问的实际问题是“为什么这些查询只返回一个值”。嗯，看看你贴的示例代码，问题就在这里：

```
$fetch = mysql_fetch_assoc($result) or die (mysql_error());
$itemsCollected = $fetch['item_name'];
echo $itemsCollected; 
```

[正如Pax 指出的那样](https://stackoverflow.com/questions/544750/how-to-select-multiple-records-row-from-a-column-in-mysql/544757#544757)，您需要循环并迭代，直到没有更多的结果要获取。请参阅[**mysql_fetch_assoc**](http://us3.php.net/mysql_fetch_assoc)的 PHP 手册页：

```
$sql = "SELECT item_name from items WHERE item_id IN('s001','a012')";
$result = mysql_query($sql);

if (!$result) {
    echo "Could not successfully run query ($sql) from DB: " . mysql_error();
    exit;
}

if (mysql_num_rows($result) == 0) {
    echo "No rows found, nothing to print so am exiting";
    exit;
}

// While a row of data exists, put that row in $row as an associative array
// Note: If you're expecting just one row, no need to use a loop
// Note: If you put extract($row); inside the following loop, you'll
//       then create $userid, $fullname, and $userstatus
while ($row = mysql_fetch_assoc($result)) {
    echo $row["userid"];
    echo $row["fullname"];
    echo $row["userstatus"];
}

mysql_free_result($result); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T04:42:30.087

是的，这两个都应该可以正常工作。你看到的实际问题是什么？

如果如您所说，只返回一条记录，请尝试：

```
select item_name from items order by item_id 
```

并检查完整的输出以确保您有 001、012、103 和 500 的条目。

如果**这两个**查询都只返回一行，我怀疑不会。

如果它们都存在，请检查表定义，可能该列是 CHAR(4) 并且包含其他空格。您可能确实在 MySQL 中发现了一个错误，但我对此表示怀疑。

编辑后：

这是一个 perl/mysql 问题，而不是 SQL 问题：一次**只**`mysql_fetch_array()`返回数据集的一行，并前进一个指向下一行的指针。

 **您需要执行以下操作：

```
$query = "SELECT item_name from items WHERE item_id IN('s001','a012')";
$result = mysql_query($query, $conn) or die (mysql_error());
if (mysql_num_rows($result) == 0) {
    echo "No rows found, nothing to print so am exiting";
    exit;
}
while ($row = mysql_fetch_assoc($result)) {
    echo $row["item_name"];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-23T18:17:22.553

我猜您的 ID 字段必须设置为自动递增。我曾经遇到过问题，我将自动增量更改为 int。在 IN 字段中，如果您传递参数以匹配自动增量变量，您只返回第一个参数，其余的会产生错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T15:21:19.210

您还可以使用 mysql_num_rows 函数告诉您查询检索了多少行，然后使用该结果来增加 for 循环。一个例子。

```
$num_rows=mysql_num_rows($query_results);
for ($i=0; $i <$num_rows ; $i++) { 
    $query_array[]=mysql_fetch_assoc($query_results);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T22:45:37.013

用于`mysql_fetch_assoc`获取查询并将查询中的值分配`mysql_fetch_assoc`到数组中。就那么简单

```
$i=0;
$fullArray = array();

$query = mysql_query("SELECT name FROM users WHERE id='111' OR id='112' OR id='113' ")or die(mysql_error());

while($row = mysql_fetch_assoc($query)){
    foreach ($row as $value) {
        $fullArray[$i] = $value;
    }
    $i++;
}

var_dump($fullArray); 

echo $fullArray[0]."<br/>".$fullArray[1]."<br/>".$fullArray[2];` 
```

# vb.net - VB.Net 启动画面不会消失

> ID：544758
> 
> 赞同：2
> 
> 时间：2009-02-13T04:42:57.247
> 
> 标签：vb.net, splash-screen

我正在使用内置功能在 VS2008 中使用 vb.net 定义启动画面。在 Me.Startup 中，我正在调用一个执行数据库版本检查的函数，然后在需要时进行更新。然后，此函数写入标签，如果需要写入状态，则使用调用。一切正常，所有数据库更新完成，但启动画面永远不会消失。它在更新运行时就在那里，当最后一个代码执行时，主窗体按预期显示，但启动屏幕仍在后台。当我关闭主窗体时，启动画面继续运行。我尝试添加代码以在代码运行时手动关闭启动屏幕表单，但没有效果。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T04:53:10.717

如果您在应用程序启动时执行初始化/更新操作，我建议不要使用内置的启动画面。

你为什么不创建一个 Main() 模块来启动你的应用程序，显示启动画面，进行数据库检查，隐藏启动画面，然后加载主窗体。

# dlna - 如何在我的媒体服务器设备配置文件中指定 DLNA PlaySingle 支持？

> ID：544762
> 
> 赞同：1
> 
> 时间：2009-02-13T04:44:38.367
> 
> 标签：dlna

DLNA CTT 1.5.00.51 测试 7.3.80.1,2,3,4 MM CDS DLNA PlaySingle URI 值失败并显示错误消息“不适用：设备配置文件报告 DUT 不支持 PlaySingle URI”

我已将连接管理器更改为返回

```
"http-get:*:audio/mpeg:*"
",http-get:*:audio/wav:*"
",dlna-playsingle:*:audio/mpeg:*"
",dlna-playsingle:*:audio/wav:*" 
```

当调用 GetProtocolInfo 时。

那是正确的字符串吗？还是我在跟踪？

我也试过

```
"http-get:*:audio/mpeg:*"
",http-get:*:audio/wav:*"
",playsingle-http-get:*:audio/mpeg:*"
",playsingle-http-get:*:audio/wav:*" 
```

我已经阅读了 DLNA 并搜索了网络，但似乎没有太多文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T00:00:38.353

我错过了一个测试工具配置选项。

在 CTT 创建一个新的设备配置文件；在选项页面上选择“播放模式”，然后选中“播放单个 URI”选项。

此后 7.3.80.1,2,3,4 和其他 7.3.80.* 测试用例将可用。

无需更改设备配置文件或 GetProtocolInfo 的结果。

（也许它应该是“PlaySingle URIs”）

# ruby-on-rails - 放置 Git 存储库的位置

> ID：544774
> 
> 赞同：3
> 
> 时间：2009-02-13T04:54:43.753
> 
> 标签：ruby-on-rails, git, version-control

我刚开始使用 Git，我想知道这是否是正确的使用方式。我启动了一个 Rails 应用程序：

```
rails newapp 
```

然后我做了：

```
cd newapp
git init
git add .
git commit -a 
```

那么在我的工作目录中初始化我的 git 是否“正确”？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-13T05:09:16.683

是的。您可以将 git 存储库*放置在任何地方*- 包括由另一个 git 存储库创建的不可见 .git 目录。我有一个朋友有 git 跟踪他所有的系统配置文件，以防他出错。

在处理项目时，您希望在项目的根目录中初始化存储库。

详细地说，Git 存储库的每个“工作副本”*本身就是一个 Git 存储库。*如果您在服务器上有一个远程副本，那也是一个存储库。您不会从那里“签出” - 相反，您“推送”您的更改并将它们合并。如果从事纯粹的个人项目，则通常不需要远程存储库。如果您确实想远程托管，[Github](http://github.com/)是一个不错的免费公共选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T04:57:46.337

是的。对我来说看上去很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T05:00:20.217

是的。在像 git 这样的 DCVS 中，您的工作副本*就是*您的存储库。

# windows-vista - 在 bach 文件或命令提示符中将文件从 XP 复制到 Vista

> ID：544778
> 
> 赞同：-1
> 
> 时间：2009-02-13T04:55:30.257
> 
> 标签：windows-vista

我正在尝试设置一个批处理文件以将文件从我的 XP 笔记本电脑复制到工作组网络上的 Vista 桌面。

但我收到拒绝访问错误。在命令提示符下也一样。

我可以使用 Windows 资源管理器很好地复制文件。

请问有什么想法吗？

马尔科姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T05:15:54.250

我假设您已经在 XP 中访问的 Vista 上设置了一个共享。

在 Vista 中，让每个人都可以匿名访问共享：

1.  右键单击要共享的文件夹，然后单击“属性”。
2.  单击共享选项卡，然后单击高级共享
3.  单击权限。
4.  单击添加。
5.  在“输入要选择的对象名称”下，键入“所有人”（不带引号）。
6.  单击确定。
7.  在“组或用户名”框中选择所有人。
8.  在“所有人的权限”下，选中“完全控制”的“允许”框。
9.  单击确定三次。

您可能应该将该共享映射为 XP 计算机上的网络驱动器。

那应该行得通。

编辑：我已经用您描述的完全相同的条件对此进行了测试，并且它有效。

# sql - 谁能告诉我这个查询中的记录流是如何根据生成的输出发生的

> ID：544779
> 
> 赞同：0
> 
> 时间：2009-02-13T04:56:21.410
> 
> 标签：sql

```
SQL> select * from employee;

ID   FIRST_NAME LAST_NAME  START_DAT END_DATE      SALARY CITY       DESCRIPTION
---- ---------- ---------- --------- --------- ---------- ---------- ---------------
03   Jason      Martin     25-JUL-96 25-JUL-06    1234.56 Toronto    Programmer
03   Alison     Mathews    21-MAR-76 21-FEB-86   13323.56 Vancouver  Tester
04   James      Smith      12-DEC-78 15-MAR-90   52358.24 Vancouver  Tester
05   Celia      Rice       24-OCT-82 21-APR-99    2344.78 Vancouver  Manager
03   Linda      Green      30-JUL-87 04-JAN-96    4322.78 New York   Tester
03   David      Larry      31-DEC-90 12-FEB-98    7897.78 New York   Manager

6 rows selected.

SQL> select id,first_name
  2  from employee
  3  group by id, first_name;

ID   FIRST_NAME
---- ----------
03   Linda
03   Jason
04   James
05   Celia
03   David
03   Alison 
```

我想知道记录的流向...这些记录以什么方式显示...请告诉我这里的组是如何创建的...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T05:23:27.850

我不确定我是否正确理解了这个问题，但我会尝试回答。

你的第二个查询是这样的：

```
select id,first_name
from employee
group by id,first_name; 
```

这意味着，找到所有员工并根据 id 和 first_name 将它们组合在一起。然后以任何顺序返回这些结果。

结果出现的顺序取决于 Oracle 内部决定执行查询的方式（散列分组依据或排序分组依据）以及数据物理存储在磁盘上的位置。它可能每天都在变化，Oracle 版本到 Oracle 版本等。

如果您希望它们按特定顺序出现，则必须使用 ORDER BY

# java - 自动定位客户端的服务器

> ID：544784
> 
> 赞同：1
> 
> 时间：2009-02-13T04:58:03.107
> 
> 标签：java, .net, networking, filemaker

FileMaker Pro 具有一项功能，允许客户端应用程序自动定位其服务器的 IP 地址并连接到该地址。使用 Java 或 .NET 等通用语言执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T10:27:05.703

FileMaker 可能正在使用 Bonjour。检查[http://developer.apple.com/bonjour/](http://developer.apple.com/bonjour/)和 Avahi

它通过实现他们所谓的多播 dns 来做到这一点。使用使用多播的 P2P dns，它们不仅可以显示服务器，还可以显示服务器和端口。

即使您在企业网络上使用，您也可以在内网 dns 服务器上发布记录，因此您不会依赖路由器及其多播容忍度（这可能是压倒性的）。所以，它扩大了规模。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T07:07:12.000

可以使用多播 UDP 尝试联系在已知多播组和端口上列出的服务器。

# batch-file - 批处理脚本读取每一行文本文件并返回一个值？

> ID：544786
> 
> 赞同：1
> 
> 时间：2009-02-13T04:58:22.217
> 
> 标签：batch-file, scripting

我想编写一个批处理脚本，它应该逐行读取文本文件并搜索关键字。

如果找到关键字，它应该返回值 0，否则它应该返回 1。像这样它应该继续增加值直到文件结束。输出应该转到一个文件。

示例日志如下，

```
Website is available HTTP/1.1 200 OK
Website is available HTTP/1.1 200 OK
Website is available HTTP/1.1 200 OK
Website is available HTTP/1.1 200 OK
Website is available HTTP/1.1 200 OK
Website is available HTTP/1.1 200 OK 
```

基本上我想计算网站失败的次数。因此，如果网站正常，则应返回值“0”，否则应返回值“1”。

最后但并非最不重要的一点是，我想要网站失败的总次数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T05:04:22.187

在 Unix 上

```
fgrep 'keyword' log.txt | wc -l 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-13T05:10:49.753

对于 Windows .bat：

```
FINDSTR /V /B /C:"HTTP/1.1 2" log.txt 
```

将列出不是 (/V) 以 (/B) 文字 (/C:) 字符串“HTTP/1.1 2”开头的每一行。

由于 HTTP 成功代码在 200 块中（例如，203 表示缓存命中），这将只列出不成功的响应。FINDSTR 确实有一些正则表达式支持，但它很弱，（尤其是没有分组或交替），所以如果你想使用 FINDSTR 过滤掉多个响应代码，你必须将它们链接起来，例如也过滤掉 Auth 失败：

```
FINDSTR /V /B /C:"HTTP/1.1 2" log.txt | FINDSTR /V /B /C:"HTTP/1.1 403" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T05:25:14.070

在 DOS 上，它将是以下行。将“FAIL STRING”替换为服务器死机时该行将包含的任何内容。

**`FIND /C "FAIL STRING" log.txt`**

当有两行包含“FAIL STRING”时，这会输出如下内容

**---------- LOG.TXT: 2**

您还可以使用 %ERRORLEVEL% 来确定是否有任何故障。像这样：

**`FIND /C "FAIL STRING" log.txt`**
**`IF ERRORLEVEL 1 ECHO Everything is A-OK`**
**`IF NOT ERRORLEVEL 1 ECHO There were failures`**

祝你好运，
兰迪

# django - Django + PostgreSQL：如何重置主键？

> ID：544791
> 
> 赞同：31
> 
> 时间：2009-02-13T05:00:33.740
> 
> 标签：django, database, postgresql, primary-key

我一直在 Django 中开发一个应用程序。首先，为简单起见，我一直使用 sqlite3 作为数据库。

但是，一旦我迁移到 PostgreSQL，我就遇到了一个问题：一旦我清除了一个表，主键就不会重置。

这个应用程序是一个长时间（几周）玩的游戏。因此，每次新游戏开始时，都会从数据库中清除所有数据，然后添加新的随机数据。

我希望能够在`1`每次清理/重建游戏时使用主键“重新开始”。

代码仍然按原样工作，但整数是描述游戏中对象的一种非常自然的方式。我希望每场新游戏都从 1 开始，而不是从上一场比赛结束的地方开始。

如何重置 PostgreSQL 中的主键计数器？请记住，我不需要保留表中的数据，因为无论如何我都会将其清除。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-13T07:04:30.870

在您的应用程序目录中尝试以下操作：

```
python manage.py help sqlsequencereset 
```

像这样将它通过管道传输到 psql 中以实际运行重置：

```
python manage.py sqlsequencereset myapp1 myapp2 | psql 
```

编辑：这是我的一张表上此命令的输出示例：

```
BEGIN;
SELECT setval('"project_row_id_seq"', coalesce(max("id"), 1), max("id") IS NOT null) FROM "project_row";
COMMIT; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2018-05-10T15:20:56.613

正如“Van Gale”所建议的那样，您可以获得解决问题的命令`sqlsequencereset`。

或者

`sqlsequencereset`您可以通过这种方式执行从 python 中生成的 SQL 查询（*使用默认数据库*）：

```
from django.core.management.color import no_style
from django.db import connection

from myapps.models import MyModel1, MyModel2

sequence_sql = connection.ops.sequence_reset_sql(no_style(), [MyModel1, MyModel2])
with connection.cursor() as cursor:
    for sql in sequence_sql:
        cursor.execute(sql) 
```

**我用Python3.6**、**Django 2.0**和**PostgreSQL 10**测试了这段代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-12-20T19:44:58.847

如果您执行原始 sql，可以这样做：

```
ALTER SEQUENCE youApp_id_seq RESTART WITH 1; 
```

文档： [http ://www.postgresql.org/docs/8.2/static/sql-altersequence.html](http://www.postgresql.org/docs/8.2/static/sql-altersequence.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-14T11:57:03.997

我将自动增量主键视为数据库记录的纯粹内部标识符，我不喜欢将它们暴露给用户。诚然，将它们用作 URL 的一部分是一种常见的设计，但即使存在 slug 或其他标识符也感觉更合适。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-11T18:37:41.937

如果您不想手动抓取您需要的应​​用程序，或者如果您有一系列不同的数据库，此命令将从**settings.py**动态收集所有连接并重置序列。

要运行使用：`python manage.py reset_sequences`

```
import psycopg2
from django.conf import settings
from django.core.management.base import BaseCommand
from django.db import connections

def dictfetchall(cursor):
    """Return all rows from a cursor as a dict"""
    columns = [col[0] for col in cursor.description]
    return [
        dict(zip(columns, row))
        for row in cursor.fetchall()
    ]

class Command(BaseCommand):
    help = "Resets sequencing errors in Postgres which normally occur due to importing/restoring a DB"

    def handle(self, *args, **options):
        # loop over all databases in system to figure out the tables that need to be reset
        for name_to_use_for_connection, connection_settings in settings.DATABASES.items():
            db_name = connection_settings['NAME']
            host = connection_settings['HOST']
            user = connection_settings['USER']
            port = connection_settings['PORT']
            password = connection_settings['PASSWORD']

            # connect to this specific DB
            conn_str = f"host={host} port={port} user={user} password={password}"

            conn = psycopg2.connect(conn_str)
            conn.autocommit = True

            select_all_table_statement = f"""SELECT *
                                    FROM information_schema.tables
                                    WHERE table_schema = 'public'
                                    ORDER BY table_name;
                                """
            # just a visual representation of where we are
            print('-' * 20, db_name)
            try:
                not_reset_tables = list()
                # use the specific name for the DB
                with connections[name_to_use_for_connection].cursor() as cursor:
                    # using the current db as the cursor connection
                    cursor.execute(select_all_table_statement)
                    rows = dictfetchall(cursor)
                    # will loop over table names in the connected DB
                    for row in rows:
                        find_pk_statement = f"""
                            SELECT k.COLUMN_NAME
                            FROM information_schema.table_constraints t
                            LEFT JOIN information_schema.key_column_usage k
                            USING(constraint_name,table_schema,table_name)
                            WHERE t.constraint_type='PRIMARY KEY'
                                AND t.table_name='{row['table_name']}';
                        """
                        cursor.execute(find_pk_statement)
                        pk_column_names = dictfetchall(cursor)
                        for pk_dict in pk_column_names:
                            column_name = pk_dict['column_name']

                        # time to build the reset sequence command for each table
                        # taken from django: https://docs.djangoproject.com/en/3.0/ref/django-admin/#sqlsequencereset
                        # example: SELECT setval(pg_get_serial_sequence('"[TABLE]"','id'), coalesce(max("id"), 1), max("id") IS NOT null) FROM "[TABLE]";
                        try:
                            reset_statement = f"""SELECT setval(pg_get_serial_sequence('"{row['table_name']}"','{column_name}'), 
                                                    coalesce(max("{column_name}"), 1), max("{column_name}") IS NOT null) FROM "{row['table_name']}" """
                            cursor.execute(reset_statement)
                            return_values = dictfetchall(cursor)
                            # will be 1 row
                            for value in return_values:
                                print(f"Sequence reset to {value['setval']} for {row['table_name']}")
                        except Exception as ex:
                            # will only fail if PK is not an integer...
                            # currently in my system this is from django.contrib.sessions
                            not_reset_tables.append(f"{row['table_name']} not reset")

            except psycopg2.Error as ex:
                raise SystemExit(f'Error: {ex}')

            conn.close()
            print('-' * 5, ' ALL ERRORS ', '-' * 5)
            for item_statement in not_reset_tables:
                # shows which tables produced errors, so far I have only
                # seen this with PK's that are not integers because of the MAX() method
                print(item_statement)

            # just a visual representation of where we are
            print('-' * 20, db_name) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-13T05:28:25.640

您需要截断表格。见[http://www.postgresql.org/docs/8.1/static/sql-truncate.html](http://www.postgresql.org/docs/8.1/static/sql-truncate.html)

# version-control - 从 Source Safe 迁移大量项目的 TFS 策略

> ID：544799
> 
> 赞同：4
> 
> 时间：2009-02-13T05:05:44.353
> 
> 标签：version-control, tfs, visual-sourcesafe

我工作的公司有超过 1000 个我们维护的应用程序。其中许多是旧技术，如 VB6，或较差的技术 (Access)。

我们正在寻求远离 Source Safe。我们正在运行 TFS，并且我们正在将 dot.net 项目迁移到 TFS。其他项目不与 TFS 集成，并且不需要门户或任何其他 TFS 功能（源代码控制除外）。

由于产品的不可靠性，我担心将其他项目留在 Source Safe 中。

据我所知，有两种选择：

1) 在 TFS 中创建一个名为“VB6”的空项目（例如）。为 VSS 中的每个 VB6 应用程序分支它。这会将所有 VB6 应用程序放在该子文件夹中。这样，所有应用程序都可以在 TFS 中。

2）将点网项目放入TFS。创建一个 CVSNT 存储库并将所有其他 VSS 项目放在那里。

3）将点网项目放入TFS。将所有其他项目留在 VSS 中。对所有 VSS 数据库运行每周压缩和修复。

人们认为哪个选项最好？有没有其他人遇到过类似的情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T07:10:43.320

这三个选项对我来说没有任何意义。如果您希望从 SourceSafe 迁移，并且已经决定迁移到 TFS（至少对于您的 .NET 项目），那么您基本上要问的是是否有一种好方法可以迁移 1000 的源旧技术应用到 TFS？

我的建议是简单地将源代码管理资源管理器用作 TFS 的 SCC 客户端。它的工作方式类似于 SourceSafe GUI。有什么不可行的理由吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-02T15:15:00.397

恕我直言，问题是您对“项目”的定义。团队项目是用于定义流程和隔离的高级容器。没有理由不拥有具有复杂源代码树的 VB6 团队项目。无需为每个 VB6 应用程序创建实际的“分支”（在分支和合并中）。与 SCC 中的文件夹结构相同。

所以基本上我看不出有任何理由不做你的第一个选择——只是不要为分支的开销而烦恼（除非你真的需要它）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T05:32:44.600

在这种情况下，选项 3 似乎是最经济的选择，假设 VSS 存储库的大小保持在 <1-2GB 以内（我的理解是，当它们变大时，它们更容易损坏——这超出了记忆力，但是，所以我可能是错的）。将 VSS 备份保存在物理上独立的位置以备不时之需，否则请保持原样。像您在一般情况下描述的那样采取行动的投资回报率相对较低。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-02-13T05:10:55.370

Git > TFS，改用它。

# powershell - 如何将属性添加到 PowerShell PSDrive“函数：”上的函数对象？

> ID：544804
> 
> 赞同：3
> 
> 时间：2009-02-13T05:10:37.477
> 
> 标签：powershell, properties

我尝试使用 $function:foo 值和 get-item function:foo。所有尝试都成功地修改了临时函数对象，但是在重新分配给存储函数时缺少附加属性（通过 $function:foo = ... 或 set-item function:foo ...）。

这是我尝试的结果（全部失败）：

设置

```
$=>函数 foo { "foo" }
$=>$f = $function:foo
$=>$f = $f | add-member note 属性栏 BARvalue -pass
$=>$f | 通用汽车*

   类型名称：System.Management.Automation.ScriptBlock

名称 MemberType 定义
---- ---------- ----------
bar NoteProperty System.String bar=BARvalue

```

#1

```
$=>set-item 函数：f $f -force
$=>$函数:foo | 通用汽车*
>

```

#2

```
$=>$函数:f = $f
$=>$函数:foo | 通用汽车*
>

```

#3

```
$=>$f = 获取项目函数：foo
$=>$f | 通用汽车

   类型名称：System.Management.Automation.FunctionInfo

名称 MemberType 定义
---- ---------- ----------
等于方法 System.Boolean Equals(Object obj)
GetHashCode 方法 System.Int32 GetHashCode()
GetType 方法 System.Type GetType()
ToString 方法 System.String ToString()
PSDrive NoteProperty System.Management.Automation.PSDriveInfo PSDrive=Function
PIsContainer NoteProperty System.Boolean PIsContainer=False
PSPath NoteProperty System.String PSPath=Microsoft.PowerShell.Core\Function::foo
PSProvider NoteProperty System.Management.Automation.ProviderInfo PSProvider=Microsoft....
CmdletBinding 属性 System.Boolean CmdletBinding {get;}
CommandType 属性 System.Management.Automation.CommandTypes CommandType {get;}
DefaultParameterSet 属性 System.String DefaultParameterSet {get;}
定义属性 System.String 定义 {get;}
描述 属性 System.String 描述 {get;set;}
模块属性 System.Management.Automation.PSModuleInfo 模块 {get;}
ModuleName 属性 System.String ModuleName {get;}
名称属性 System.String 名称 {get;}
选项属性 System.Management.Automation.ScopedItemOptions 选项 {get;set;}
参数 属性 System.Collections.Generic.Dictionary`2[[System.String, mscorli...
ParameterSets 属性 System.Collections.ObjectModel.ReadOnlyCollection`1[[System.Man...
ScriptBlock 属性 System.Management.Automation.ScriptBlock ScriptBlock {get;}
可见性属性 System.Management.Automation.SessionStateEntryVisibility Visibi...

$=>$f = $f | add-member note 属性栏 barValue -pass
$=>$f | 通用汽车*

   类型名称：System.Management.Automation.FunctionInfo

名称 MemberType 定义
---- ---------- ----------
bar NoteProperty System.String bar=barValue

$=>设置项功能：foo $f
$=>$函数:foo | 通用汽车*
>

```

不知道我做错了什么。似乎在重新分配时这些属性被剥离了。那是对的吗？定义的行为？我没有看到任何文档说 FunctionInfo 对象或 ScriptBlocks 被异常处理。这是语言的一些深奥的角落吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T14:24:59.717

我的第一个想法是，当您将此属性附加到对象时，您会将其附加到该对象的特定实例。当您的变量丢失对该对象的引用时，该新属性的任何知识都会丢失。

我的猜测是下次获得该项目时，您正在创建一个具有 foo 属性的新 FunctionInfo 对象（存储在函数提供程序中）。

当您调用 Get-Item 或 Get-ChildItem 时，它会返回对表示基础项的 .NET 类型的对象引用。这些项目不会无限期地存在于内存中（想象一下每个本地驱动器上的每个文件和内存中的每个映射驱动器都有一个 FileInfo 对象......哎哟）。由于每次调用 Get-Item 时 PowerShell 都会创建一个新实例，因此您将获得基本的 FunctionInfo 对象。

如果要为特定类型的所有项添加属性，可以使用 PowerShell 的可扩展类型系统。您可以创建自定义 .ps1xml 文件并将其加载到 PowerShell 会话中，该会话可以将属性添加到类型的每个实例。PowerShell 团队博客上的一些很好的例子在这里 -> [Hate Add-Member](http://blogs.msdn.com/powershell/archive/2008/09/06/hate-add-member-powershell-s-adaptive-type-system.aspx) and [Leveraging the PowerShell Type Extensions to Get Documentation](http://blogs.msdn.com/powershell/archive/2006/06/24/644987.aspx)。

编辑（解决评论）：我了解您要执行的操作，但失败是由于新属性被“嫁接”到允许动态添加属性的 PSObject 包装器上。新属性永远不会真正属于您从 PSDrive 检索的 FunctionInfo 对象。

此外，函数提供者（函数：psdrive）没有存储该附加属性的机制。它知道并使用 FunctionInfo 对象。当您从 Function: PSDrive 请求项目时，Function 提供程序返回一个 FunctionInfo 对象。当您将函数保存到 Function: PSDrive 时，提供程序只能存储它知道如何处理的属性的值。可以编写一个自定义提供程序来处理来自 PSObject 包装器的新属性，但这不是此提供程序中默认功能的一部分。

编辑＃2：好的，这一直困扰着我。 [我在博客上写了一个解决方法](http://blog.usepowershell.com/2009/02/adding-custom-properties-to-functions/)。

# asp.net - 在 asp.net 中的动态编辑按钮事件中需要帮助

> ID：544808
> 
> 赞同：-3
> 
> 时间：2009-02-13T05:13:53.803
> 
> 标签：asp.net

我需要动态编辑按钮事件的帮助。当我以用户身份登录时，我收到欢迎消息...欢迎用户！正是在这种欢迎下，我将编辑个人资料链接。因此，每当用户单击编辑个人资料时，他应该只看到他的个人资料，并且能够编辑他的个人资料。请有人帮我编写代码。

谢谢， 马苏姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T14:14:12.443

您应该考虑使用 ASP.NET 登录控件，尤其是在您使用成员资格提供程序的情况下。

```
<asp:LoginView ID="RegisterLink" runat="server">
  <AnonymousTemplate>
    <div class="titleRegistration">
      <a href="/Users/Register.aspx">Register</a> or 
    </div>
  </AnonymousTemplate>
  <LoggedInTemplate>
    <div class="titleRegistration">
      Welcome back
      <asp:LoginName ID="LoginName1" runat="server" />
      -
    </div>
  </LoggedInTemplate>
</asp:LoginView>
<asp:LoginStatus ID="lsGeneral" runat="server" LogoutPageUrl="/Users/Logout.aspx" /> 
```

所以，我在这里做的是：

1.  使用[LoginView](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginview.aspx)控件向匿名用户和登录用户显示不同的信息 - 匿名用户看到指向我的注册页面的链接，以及单词“或”，登录用户看到他们的姓名（由[LoginName](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginname.aspx)控件自动呈现）和破折号。
2.  使用[LoginStatus](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginstatus.aspx)控件根据用户是否已登录或注销来自动呈现“登录”或“注销”链接。

这将为匿名用户生成以下内容：

> 注册或登录

对于已登录的用户：

> 欢迎回来 Zhaph - 退出

您可以轻松地在 UserName 上添加一个链接以转到一般个人资料页面，然后从他们的个人资料中检索用户详细信息以进行编辑。

这些帮助有用？

# scheme - 如何使用 Scheme 附加到文件？

> ID：544812
> 
> 赞同：1
> 
> 时间：2009-02-13T05:15:37.823
> 
> 标签：scheme, append, gimp, script-fu

我正在使用 TinyScheme（实际上是 GIMP 中的 Script-Fu），但找不到打开文件并向其附加一行文本的好方法。

我正在尝试将一些信息记录到文件中以进行调试，并且似乎没有实现转录...

现在我正在阅读整个文件（一次一个字符！），将它连接成一个字符串，将我的文本连接到它的末尾，然后再次将其全部写入文件。

一定会有更好的办法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T05:40:32.257

它会是这样的

```
(open-file "myfile" (file-options append)) 
```

您想查找该`file-options`功能。

### 更新

这是[狡猾的版本](http://www.delorie.com/gnu/docs/guile/guile_317.html)：

```
(open-file "myfilename.dat" "a") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-04T13:20:55.660

刚刚在 GIMP 中遇到了同样的问题并决定使用`open-input-output-file`. 我的解决方案是这样的：

```
(let* ((out (open-input-output-file "file.txt") ))
  (display "hello world" out)
  (newline out)                    
  (close-output-port out)) 
```

浏览 TinyScheme 源代码并检查此函数是否实际调用`fopen`. `"a+"`该文件已打开以供读取和写入。为了我们的目的，我们只想写，所以忽略阅读。

我正在编写一个 Script-Fu 来将值写入`gimp-selection-bounds`文件。

# php - jQuery：使用链接提交 ajax 查询

> ID：544823
> 
> 赞同：1
> 
> 时间：2009-02-13T05:23:51.563
> 
> 标签：php, ajax, jquery

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T05:39:33.490

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T05:32:54.707

你真的打算将你的ajax成功返回函数声明为

```
function(html) 
```

? ..我想也许你的意思是参数是“数据”？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T06:45:24.130

由于您的 php 脚本返回 json，您应该将 dataType 设置为 json。请注意，在您发布的代码示例中，成功 function() 在 $.ajax() 之外，它需要在里面。

```
 $.ajax({
   url: "ajaxPostOnline.php?b=" + bizID + "&p=" + shouldPost,
   dataType: "json",
   success: function(json){
     $("#onlineStatus" + bizID).html(json.return);
   }
 }); 
```

您可能想查看 getJSON 方法，因为它对于这种特殊情况更加简洁。

```
$.getJSON("ajaxPostOnline.php", {b:bizID, p:shouldPost}, function(json) {
    $("#onlineStatus" + bizID).html(json.return);
}); 
```

编辑：原始问题已被编辑，提供的样本发生了显着变化。我仍然会推荐 $.getJSON 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T07:05:22.053

除非我弄错了，否则您似乎在混合 AJAX 和服务器端脚本时遇到了错误。

这取决于 $return 是否在 ajaxPostOnline.php 中的赋值片段之后的任何地方被 PHP 解析（几乎没有，如果它是从 AJAX 调用的！）。

```
$return = "<a class='onlineStatus' href='#' onchange='doAjaxPostOnline( 1, <?php echo $b_id ?> ); return false;' >Post Online</a>"; 
```

当然这应该是：

```
$return = "<a class='onlineStatus' href='#' onchange='doAjaxPostOnline( 1, ".$id." ); return false;' >Post Online</a>"; 
```

# java - 使用Java从串口读取文件

> ID：544824
> 
> 赞同：7
> 
> 时间：2009-02-13T05:23:59.130
> 
> 标签：java, serial-port, core

我是 Java 初学者，我正在`("FLASH").getbytes()`这样写`serialport`。

在我得到`FLASH_OK`回应后，我再次发送文件请求。之后我会得到响应，因为`FILE_OK`我已经读取了文件直到文件末尾。

我不知道如何做到这一点，所以请帮助我。

谢谢您的回复。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-03T17:22:05.163

[**jSSC**](https://code.google.com/p/java-simple-serial-connector/)是一个稳定的串行 IO java 库，看看下面的[例子](http://code.google.com/p/java-simple-serial-connector/wiki/jSSC_examples)：

*   将数据写入串口
*   从串口读取数据

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-13T06:52:49.587

看起来需要一个**[`SerialPortReader`](http://www.koders.com/java/fid3870A59B6C87B047751FC843024AAF0C4D60E1E5.aspx?s=getbytes+serialport+ok#L110)**需要实现一个`SerialPortEventListener`

```
 public void serialEvent(SerialPortEvent event)
     {
            case SerialPortEvent.DATA_AVAILABLE:
            byte[] readBuffer = new byte[40];

            try
            {
                while (inputStream.available() > 0)
                {
                    int numBytes = inputStream.read(readBuffer);
                }
                System.out.print(new String(readBuffer));

                System.out.println();
                System.out.println("DTR: " + serialPort.isDTR());
                System.out.println("DSR: " + serialPort.isDSR());
                System.out.println("CTS: " + serialPort.isCTS());
                System.out.println("RTS: " + serialPort.isRTS());
                System.out.println();
                outputStream.write("ACTIVESYNC".getBytes());
            }
            catch (IOException e)
            {
                e.printStackTrace();
            } 
```

# mysql4 - 仅当它存在于 mysql server 5.0 中时才删除约束

> ID：544825
> 
> 赞同：4
> 
> 时间：2009-02-13T05:24:52.560
> 
> 标签：mysql4

我想知道如何仅在存在约束时才删除约束。mysql 服务器中是否有任何单行语句可以让我这样做。

我尝试了以下命令，但无法获得所需的输出

```
alter table airlines 
drop foreign key if exits FK_airlines; 
```

对此有任何帮助真的可以帮助我在mysql中前进

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T07:15:07.817

我不相信这在一行中是可能的，除非您**愿意**检测错误并继续前进（这不是一件坏事）。

INFORMATION_SCHEMA 数据库包含您需要判断外键是否存在的信息，因此您可以分两步实现它。

[http://dev.mysql.com/doc/refman/5.1/en/table-constraints-table.html](http://dev.mysql.com/doc/refman/5.1/en/table-constraints-table.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T10:10:02.963

是的，如果存在仅适用于数据库表和视图是不可能的：http: [//dev.mysql.com/doc/refman/5.0/en/replication-features-drop-if-exists.html](http://dev.mysql.com/doc/refman/5.0/en/replication-features-drop-if-exists.html)

是的，两步过程是一个好方法，就像 gahooa 说的那样

# c++ - 为模板类创建类型别名

> ID：544842
> 
> 赞同：9
> 
> 时间：2009-02-13T05:34:11.897
> 
> 标签：c++

而不是使用

```
std::vector<Object> ObjectArray; 
```

我希望它是

```
MyArray<Object> ObjectArray; 
```

保留所有 std::vector 方法。（如 push_back()、reserve()、...等）

但是，使用

```
typedef std::vector MyArray; 
```

不会工作。我应该改用模板吗？如何？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-13T05:37:42.293

你真正想要的是一个模板化的 typedef。不幸的是，当前版本的 C++ 不支持这些，但它们将在 C++0x 中添加。

目前，这是一个可能的解决方法：

```
template<class T> struct My {
    typedef std::vector<T> Array;
};

My<Object>::Array ObjectArray 
```

这是否比直接使用更好`std::vector`，我将由您决定。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-12-29T01:42:12.420

从 C++11 开始，您可以使用模板类型别名

```
template <typename T>
using MyArray = std::vector<T>; 
```

如果您想更通用，可以使用可变参数模板（这将允许在向量的情况下分配器而不必具体）

```
template <typename... Ts>
using MyArray = std::vector<Ts...>; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-13T21:11:12.830

其他方式：

```
#include <vector>

template <typename T>
struct MyArray
    :std::vector<T>
{
};

void func()
{
    MyArray<int> my;

    my.push_back(5);

    MyArray<int>::iterator i;
} 
```

为我编译，但您可能会发现 vector<> 中可用的某些内容需要“拉起”到 MyArray 中。

# latex - 从 TOC 中排除一章

> ID：544844
> 
> 赞同：10
> 
> 时间：2009-02-13T05:36:35.073
> 
> 标签：latex, pdflatex

在我的 LaTeX 文档中，我有一个目录，它是通过收集所有格式为`\chapter`.

但是，我在目录之前有一个致谢章节，我不希望它被自动标记为“第 1 章”或在目录中捕获。我应该`\chapter`完全避免并`\section`改用吗？我想保留其他章节的字体/格式。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-13T05:50:26.210

处理这种事情的通常方法是使用`\frontmatter`命令。把它放在 之后`\begin{document}`，然后把它放在你想要对应第 1 章的前面。这可能只在`\mainmatter`课堂上有效。如果您在 a 中使用，则还应该创建一个没有编号且不会出现在目录中的章节。`\chapter``book``\chapter``report``\chapter*`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-13T06:00:28.200

确实，正如未知（谷歌）所提到的，使用`\frontmatter`and`\mainmatter`是最好的解决方案。这也会将您的页码调整为前面的小写罗马数字。但是，它仅适用于`book`类似的文档类。

如果您正在使用`report`，请尝试`\chapter*`。这将创建一个没有出现在目录中的编号的章节。

# c++ - 引用这些指针时，我是如何意外覆盖的？

> ID：544845
> 
> 赞同：6
> 
> 时间：2009-02-13T05:37:21.407
> 
> 标签：c++, pointers

今晚的最后一个问题，我保证。这些指针让我很头疼。

我有一个 std::list `<Point`> 称为 Polygon 和一个 std::list 的多边形定义如下：

```
typedef std::list<Point> Polygon; 
typedef std::list<Polygon> PolygonList; 

// List of all our polygons 
PolygonList polygonList; 
```

我创建了下面的方法来尝试从（x，y）中删除最近的点，检查我的多边形列表中的所有多边形。

```
void deleteNearestPoint(int x, int y)
{
    y = screenHeight - y;

    Polygon &closestPolygon = polygonList.front();
    Polygon::iterator closestPoint = closestPolygon.begin();

    float closestDistance = sqrt(pow(x - closestPoint->x, 2) + pow(y - closestPoint->y, 2));

    // Search PolygonList
    PolygonList::iterator listIter;
    Polygon::iterator iter;

    for(listIter = polygonList.begin(); listIter != polygonList.end(); listIter++)
    {
        Polygon &tempPolygon = *listIter;

        for(iter = tempPolygon.begin(); iter != tempPolygon.end(); iter++)
        {
            const float distance = sqrt(pow(x - iter->x, 2) + pow(y - iter->y, 2));

            if (distance < closestDistance)
            {
                closestPolygon = *listIter;
                closestPoint = iter;
                closestDistance = distance;
            }
        }

    }

    closestPolygon.erase(closestPoint);

    redraw();
} 
```

但是，在某处我有一个指针或引用变量让我搞砸了。这段代码可以编译，但以一种非常奇怪的方式运行。

我写了一个调试语句，假设我的多边形列表中有 3 个多边形，如下所示：

> 多边形#：0
> 点：(448, 43)
> 点：(469, 177)
> 点：(374, 123)
> 多边形#：1
> 点：(295, 360)
> 点：(422, 350)
> 点：(315, 266)
> 点：(295, 360)
> 多边形#：2
> 点：(143, 202)
> 点：(301, 203)
> 点：(222, 100)
> 点：(143, 202)

现在，假设我尝试使用删除函数给它一个接近点 422, 350 的 x/y 期望的结果是它只是从 Polygon #1 中删除该点 (422, 350) 但我得到了这个：

> 多边形#：0
> 点：(295, 360)
> 点：(422, 350)
> 点：(315, 266)
> 点：(295, 360)
> 多边形#：1
> 点：(295, 360)
> 点：(315, 266)
> 点：(295, 360)
> 多边形#：2
> 点：(143, 202)
> 点：(301, 203)
> 点：(222, 100)
> 点：(143, 202)

它确实删除了 (422, 350)，但它也有一个奇怪的副作用，即将 Polygon#0 覆盖为 Polygon#1 在删除其点之前的样子。

我知道我在我的方法中错误地使用了指针或引用。有人能指出我可能在做什么导致这种情况吗？我认为这是因为我的 &closestPolygon 被声明为引用，但是如果我尝试将其设置为其他任何内容，则会出现编译错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-13T05:50:35.210

不幸的是，您不能重新绑定引用，即这一行：

最接近多边形 = *listIter;

将复制`*listIter`到`closestPolygon`，而不是将引用重新绑定到`*listIter`。

编辑：要做你想做的事，你应该使用`PolygonList::iterator`而不是`Polygon &`相应地调整代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T06:15:13.467

其他答案指出了导致错误的原因。作为一般建议，我建议不要在函数参数中使用引用。语义令人困惑，对于试图阅读您的代码的人来说也是如此。尝试重写为这样的东西（我没有测试代码）：

```
void deleteNearestPoint(int x, int y)
{
    y = screenHeight - y;

    PolygonList::iterator closestPolygon = polygonList.begin();
    Polygon::iterator closestPoint = closestPolygon->begin();

    float closestDistance = sqrt(pow(x - closestPoint->x, 2) + pow(y - closestPoint->y, 2));

    // Search PolygonList
    PolygonList::iterator listIter;
    Polygon::iterator iter;

    for(listIter = polygonList.begin(); listIter != polygonList.end(); listIter++)
    {
        for(iter = listIter->begin(); iter != listIter->end(); iter++)
        {
            const float distance = sqrt(pow(x - iter->x, 2) + pow(y - iter->y, 2));

            if (distance < closestDistance)
            {
                closestPolygon = listIter;
                closestPoint = iter;
                closestDistance = distance;
            }
        }

    }

    closestPolygon->erase(closestPoint);

    redraw();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-13T05:49:49.690

您不能分配给参考。
这是 C++ 中的引用与 C# 等中的引用之间的主要区别。一旦你用一个对象初始化了一个引用变量，这个变量就会成为那个对象的别名。赋值给引用变量等价于赋值给原始对象。考虑到这一点，这一行：

```
closestPolygon = *listIter; 
```

意味着您正在用当前多边形覆盖先前找到的最近多边形。这也与您得到的结果一致。我建议您对这种方法使用指针而不是引用。

此外，正如其他人所指出的，使用`pow(... , 2)`是非常浪费的。更好的是写这样的东西：

```
x = a - b;
xsquare = x * x; 
```

* * *

编辑：用指针写这个将以这样的方式开始：

```
void deleteNearestPoint(int x, int y)
{
    y = screenHeight - y;

    Polygon *closestPolygon = &polygonList.front();
    Polygon::iterator closestPoint = closestPolygon.begin(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-13T05:52:39.013

> ```
> closestPolygon = *listIter; 
> ```

将改为在引用指向的对象上调用 operator=()，因此它将用第二个多边形覆盖第一个多边形。

将最接近多边形声明为指针（即使在声明之后也可以指向不同的对象）

> ```
> Polygon *closestPolygon = &(polygonList.front());
> ...
> closestPolygon = &(*listIter); 
> ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-13T06:05:48.997

我看到您的问题已经得到解答 - 我将投入 2 美分并建议您将距离作为一种 Point 方法来保存重复代码。

正如其他人所说，您可能还需要一个 squareDistance(x, y) 方法，如果这会让您的生活更轻松。

如果您担心函数调用的开销，任何一个都可以内联。

# c# - 如何为 Dataview 设置行过滤器以根据列的值过滤行？

> ID：544850
> 
> 赞同：1
> 
> 时间：2009-02-13T05:39:54.240
> 
> 标签：c#, asp.net

嗨，我正在使用 DataView 控件来绑定网格视图。在 dataview 中，数据来自表“cloneUserEntry”。cloneUserEntry 表包含一列“可见性”，其值为真或假（布尔类型）。我想显示可见性为真的行。那么如何设置行过滤器来过滤列“可见性”只包含真值的行。我正在使用以下代码..

```
Boolean var=true ;
gvUserDataReadOnly.DataSource = new DataView(cloneUserEntry, string.Format("Visibility = #{0}#", var),  "FirstName ASC", DataViewRowState.CurrentRows); 
```

但这不起作用。谁能告诉我怎么做这个任务..?? 提前致谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T06:08:27.307

尝试从过滤器语句中删除 # 字符，即，`"Visibility = true"`而不是`"Visibility = #true#"`. # 在使用 DateTime 对象进行过滤时使用。

# php - 世界上有多少 Zend 认证工程师？

> ID：544853
> 
> 赞同：5
> 
> 时间：2009-02-13T05:40:55.610
> 
> 标签：php, certificate

我在 Zend 网站上找到[了一个工具。](http://www.zend.com/store/education/certification/yellow-pages.php)但这只是按国家/地区划分谁实现了 ZCE。

我计划将 ZCE 用于 PHP 5，我只想知道全球有多少 Zend 认证工程师。

谢谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T06:02:58.457

我不了解你，但如果我很想知道有多少 Zend 认证工程师可用，那么我会编写某种刮板，获取每个国家的结果并进行总结。

...并在 php.ini 中执行此操作。这会给一些雇主留下深刻印象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-31T11:55:37.837

您可以查看每个国家/地区的数量以及总和。没有那么多，有些国家比其他国家更倾向于认证。西班牙有 42 个 ZCE，与程序员总数或人口总数相比非常少。以色列为更少的程序员/人口增加了一倍。美国大约有 1000 家，可能是因为大公司在其中看到了您的专业知识，微软风格的确认。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T05:58:16.707

我认识一个获得认证的人。

当我终于开始检查 Zend 框架时，我会考虑获得认证。

如果雇主要求，我学习和申请都没有问题。

# xml - 从数据库或变量列表创建 xml 文件

> ID：544865
> 
> 赞同：0
> 
> 时间：2009-02-13T05:52:43.520
> 
> 标签：xml, text, text-files

我有一个模板，需要创建几个 xml 文件。该文件包含一个变量 -this- 替换多次，将其另存为该名称 -this-.xml 然后对我的文本或 excel 列表或数据库中的每个值重复 - 我最好如何去做?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T19:30:56.613

老派 unix 方式（bash shell 语法）：

```
for var in $(cat replacelist.txt); do sed "s/-this-/$var/g" < template.xml >$var.xml; done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T06:22:35.010

您是在考虑在代码中执行此操作，还是使用模板驱动的生成器？

几种选择：

*   在 Visual Studio 中，您可以使用 T4 模板来实现这一点
*   您可以使用 CodeSmith、MyGeneration 等代码生成器
*   您可以编写自己的小程序来执行此操作（在 C#、VB 中 - 任何东西）

您真正在寻找哪些？

马克

# winapi - 如何快速退出软件

> ID：544875
> 
> 赞同：0
> 
> 时间：2009-02-13T06:02:34.450
> 
> 标签：winapi

我有一个驻留在外置硬盘中的软件，当用户插入外置硬盘时它会自动运行，当然，当用户拔出外置硬盘时，软件必须自动关闭。我可以收到设备丢失消息，但是我的 SW 在释放所有对象时不会响应，如果我直接调用 exit(0)，则 SW 将显示崩溃消息。有什么方法可以快速退出SW？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T06:12:16.127

退出 Windows 应用程序的干净方法是

```
PostQuitMessage(0); 
```

这将发送`WM_QUIT`到应用程序，导致消息循环终止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T06:38:29.417

终止进程最快的方法是调用[`TerminateProcess()`](http://msdn.microsoft.com/en-us/library/ms686714(VS.85).aspx). 这只是阻止进程接收任何进一步的时间片并释放窗口分配给它的所有资源。

尽管出于各种原因，不建议使用这种结束进程的方法。例如，如果您有一个使用标准库写入的打开文件，则某些数据可能仍会被缓冲并且未完全写入文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T01:29:45.457

我假设你想干净地退出。如果您不需要干净地退出，请使用 PostQuitMessage。如果您这样做，并且它是一个 UI 应用程序，请将 WM_CLOSE 发送到您的主窗口。

您应该澄清当您退出时您的软件“将不会响应”哪些对象，以及它为什么停止响应

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T01:39:32.737

我假设您正在寻找一种方法来防止您的应用在用户拔出外部设备时崩溃。您可以强制操作系统将可执行文件从可移动媒体复制到交换文件并从那里执行。相应的链接器开关（用于 MSVC++）是**/SWAPRUN:{NET|CD}**。
将其设置为 CD，操作系统将在从外部驱动器执行时将可执行文件复制到交换。

# c# - 编码 CDATA 元素的有效方法

> ID：544876
> 
> 赞同：2
> 
> 时间：2009-02-13T06:02:40.813
> 
> 标签：c#, .net, xml, cdata, streamreader

好的，我正在使用 StreamReader 从流中读取数据。流中的数据不是 xml，它可以是任何东西。

基于输入 StreamReader，我正在使用 XmlTextWriter 写入输出流。基本上，当一切都说完了，输出流包含来自输​​入流的数据，这些数据包装在父元素中包含的元素中。

我的问题是双重的。数据以块的形式从输入流中读取，StreamReader 类返回 char[]。如果输入流中的数据包含“]]>”，则需要将其拆分为两个 CDATA 元素。首先，如何在 char 数组中搜索“]]>”？其次，因为我是分块阅读，所以“]]>”子字符串可以分成两个块，那么我该如何解释呢？

我可能会将 char[] 转换为字符串，然后对其进行搜索替换。这将解决我的第一个问题。在每次读取时，我还可以检查最后一个字符是否是“]”，以便在下一次读取时，如果前两个字符是“]>”，我将开始一个新的 CDATA 部分。

这看起来几乎没有效率，因为它涉及将 char 数组转换为字符串，这意味着要花费时间来复制数据，并占用两倍的内存。有没有更有效的方法，无论是在速度方面还是在内存方面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T14:37:06.867

根据[*HOWTO 避免在生产 XML 时被称为 Bozo*](http://hsivonen.iki.fi/producing-xml/)：

> [不要打扰 CDATA 部分](http://hsivonen.iki.fi/producing-xml/#cdata)
> 
> XML 提供了两种转义标记有效字符的方法：预定义实体和 CDATA 部分。CDATA 部分只是语法糖。这两种替代句法结构没有语义差异。
> 
> 当您手动编辑 XML 并且需要粘贴包含标记有效字符的大量文本（例如代码示例）时，CDATA 部分很方便。但是，当使用序列化程序生成 XML 时，序列化程序会自动处理转义，并且尝试对转义方法的选择进行微观管理只会带来错误的可能性。
> ...
> 只有 <、>、& 和（在属性值中）" 需要转义。

只要对一小部分特殊字符进行编码/转义，它就应该可以工作。

你是否必须自己处理逃跑是另一回事，但肯定是一个更容易解决的问题。

然后只需将全部作为子文本节点附加到相关的 XML 元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T20:15:59.717

我知道 CDATA 的两个真实用例：

一个是在包含脚本的 XHTML 文档中：

```
<script type="text/javascript">
<![CDATA[
   function foo()
   {
      alert("You don't want <this> text escaped.");
   }
]]>
</script> 
```

另一种是手工编写的 XML 文档，其中文本包含嵌入的标记，例如：

```
<p>
   A typical XML element looks like this:
</p>
<p>
   <pre>
   <![CDATA[
      <sample>
         <text>
            I'm using CDATA here so that I don't have to manually escape
            all of the special characters in this example.
         </text>
      </sample>
   ]]>
   </pre>
</p> 
```

在所有其他情况下，只要让 DOM（或 XmlWriter，或您用来创建 XML 的任何工具）转义文本节点就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T10:21:38.273

> 其次，因为我正在分块阅读，所以“]]>”子字符串可以分成两个块，那么我该如何解释呢？

实际上，您必须将最后两个字符保留在队列中，而不是立即将它们吐出。然后当新输入进入时，将其附加到队列中，然后再次获取除最后两个字符之外的所有字符，搜索并替换它们，然后输出。

更好：根本不用担心 CDATA 部分。它们只是为了方便手工创作而存在。如果您已经在进行搜索和替换，那么您没有理由不只搜索和替换 '<'、'>' 和 '&' 及其预定义的实体，并将这些实体包含在普通的 Text 节点中。由于这些是简单的单字符替换，因此您无需担心缓冲。

但是：如果您按照您所说的那样使用 XmlTextWriter，那么它就像为每个传入文本块调用 WriteString() 一样简单。

# c# - 使用 CodeDomSerializer 为所有 CLR 支持的语言生成代码

> ID：544884
> 
> 赞同：1
> 
> 时间：2009-02-13T06:06:20.760
> 
> 标签：c#, user-controls, codedom

我正在使用自定义 CodeDomSerializer 在设计时为 WindowsForm 控件实现代码生成。

这就是我所拥有的。

*   一个用户控件，即用 C# 编写的 MyControl。
*   MyControl 有一个 ObjectXXX 类型的属性 MyControlProperty，可公开访问。（如 myControl.MyControlProperty）。
*   ObjectYYY 类型有一个 Collection 类型的公共属性 PropertyXXX。
*   ObjectXXX 有一个 ObjectYYY 类型的内部字段。
*   ObjectXXX 应该通过传递 Collection（只不过是 ObjectYYY.PropertyXXX）来初始化。

生成的代码应该在下面的代码片段中给出。

```
Line1\. NamespaceX.NamespaceY.ObjectXXX x = new NamespaceX.NamespaceY.ObjectXXX(NamespaceX.NamespaceY.ObjectYYY.PropertyXXX);
Line2\. myControl.MyControlProperty = x; 
```

通过为 C# 语言编写自定义 CodeDomSerializer，我成功地在设计时生成了上述代码。

但是，如果我使用 MyControl 以 C++ 语言开发应用程序，则 DOT 运算符将针对 ScopeResolution 和 Pointer-To-Member 运算符进行序列化。

我正在为 Line1 中的代码做的是，

```
string fullyQualifiedName = "NamespaceX.NamespaceY.ObjectYYY.PropertyXXX"; // HERE VARIABLE NAME IS HARDCODED WITH TWO TYPES OF OPERATORS
CodeExpression[] parameters = new CodeExpression[] {new CodeVariableReferenceExpression(fullyQualifiedName);};
CodeStatement code = new CodeVariableDeclarationStatement(typeof(ObjectXXX), "objectXXX1", new CodeObjectCreateExpression(new CodeTypeReference(typeof(ObjectXXX)), parameters));
generatedCode.Add(code); //generatedCode has the final code 
```

对于线路 2，

```
CodeExpression codeLhs = new CodeVariableReferenceExpression(myControlVariable + "." + "MyControlProperty"); // HERE Pointer-To-Member IS HARDCODED AS DOT
CodeExpression codeRhs = new CodeVariableReferenceExpression("objectXXX1");
CodeAssignStatement codeAssignStmt = new CodeAssignStatement(codeLhs, codeRhs);
generatedCode.Add(codeAssignStmt); //generatedCode has the final code 
```

显然，C++ Designer 生成的代码应该有 '::' 运算符（而不是 DOT）用于 ScopeResolution 和 '->' 用于 Pointer-To-Member 分辨率。我无法弄清楚如何为任何 CLR 支持的语言进行代码序列化。

如何解决这个问题呢？

-非常感谢

达特巴约

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T09:00:19.217

感谢您的快速回复。

我找到了解决方案。

我需要的是生成包含属性访问的代码并为 .NET 类型生成代码。

要生成访问属性的代码，应该使用 CodePropertyReferenceExpression。这解决了我对 Line2 的问题。

要生成包含类型的代码，应该使用 Code CodeTypeReferenceExpression。这结合 CodePropertyReferenceExpression 解决了 Line1 的问题。

现在，我能够正确地生成使用中的语言的代码。

```
//For C# The code would be
NamespaceX.NamespaceY.ObjectXXX x = new NamespaceX.NamespaceY.ObjectXXX(NamespaceX.NamespaceY.ObjectYYY.PropertyXXX);
this.myControl.MyControlProperty = x;

//For C++ The code would be
NamespaceX::NamespaceY::ObjectXXX x = new NamespaceX::NamespaceY::ObjectXXX(NamespaceX::NamespaceY::ObjectYYY::PropertyXXX);
this->myControl->MyControlProperty = x; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T06:11:28.640

不确定这是否会有所帮助，但您是否看过[MyGeneration](http://www.mygenerationsoftware.com/portal/default.aspx) ，它是一个用 .Net 编写的多语言代码生成器。它不使用 CodeDomSerializer，但它确实生成了很好的代码——也许它可以解决你的潜在问题而无需重新发明轮子？

# sql-server - SQL Server 2005 / 2008 - 多个文件组？

> ID：544898
> 
> 赞同：13
> 
> 时间：2009-02-13T06:16:47.833
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, database-design, filegroup

我本质上是一名开发人员——但时不时地，客户没有像样的 DBA 来处理这些问题，所以我被召唤来决定......

在处理合理大小的 SQL Server 数据库（比 Northwind 或 AdventureWorks 更大的数据库）时，您的策略/最佳实践是什么 - 您是否使用多个文件组？如果有：有多少？为什么？

您决定何时摆脱“一个文件组处理所有内容”方法的标准是什么：

*   数据库大小？
*   数据库复杂度？
*   可用性/可靠性要求？
*   还有什么？

如果您使用多个文件组，您使用多少个？一个用于数据，一个用于索引，一个用于日志？几个（多少）的数据？您选择的原因是什么 -*为什么*使用确切数量的文件组:-)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-13T06:50:08.767

Microsoft 培训的最佳实践方法如下：

*   日志文件放置在单独的物理驱动器上
*   数据文件放置在单独的物理驱动器上
*   多个文件组：当特定表非常大时。事务数据库中经常出现这种情况（单独的物理驱动器）
*   多个文件组：使用范围或想要将查找数据拆分为只读数据库文件（单独的物理驱动器）时

请记住，在存储数据方面，MDF 在技术上与硬盘分区类似。MDF 是随机读取的文件，而 LDF 是顺序读取的文件。因此，将它们分成单独的驱动器会导致巨大的性能增益，除非运行固态驱动器，在这种情况下增益仍然存在。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T21:41:42.260

在 SQL Server 2008 中拥有多个（至少两个）文件组至少有一个充分的*理由：如果您想使用 FILESTREAM 功能，您必须为您的 FILESTREAM 数据提供一个专用的自定义文件组 :-)*

马克

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-01T06:14:05.153

维护多个文件组有助于减少 I/O 负担。它还为您提供了存储灵活性，您可以轻松地备份文件组而不是单个文件，并将它们分成每个文件组的单独磁盘驱动器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T02:44:37.950

通常，您应该只有一个主文件组和一个日志文件。

有时当您有非常静态的数据时，您可以创建一个包含此静态数据的*SECOND文件组。*然后，您可以将文件组*设为 READONLY*以提高性能。毕竟，这是相当静态的数据。如果您的只读行数较少（例如查找表值），则不值得。但是对于某些东西（例如，仍然可以读入的存档内容），这可能是一个不错的选择。

我从[这篇博](http://blogs.msdn.com/davidlean/archive/2008/11/04/sql-spatial-tips-on-storage.aspx)文中得到了这个想法。

HTH。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T06:35:59.750

我研究过很多数据库，我们唯一一次使用文件组是当磁盘空间不足时，我们不得不在另一个主轴上创建一个新文件组。我敢肯定这不是理想的原因有很好的性能原因，但这是现实。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-30T10:17:06.890

among other reasons additional filegroups make sense if you want to partition a table. and that makes sense if there are many rivaling reads with dissimilar where-conditions of that table. you can configure each partition to reflect one such where-condition and to be located on a different disk, thereby sending each read to another disk, thus parallel reads and less conflict.

# javascript - javascript 是否缓存 DOM 元素？

> ID：544901
> 
> 赞同：2
> 
> 时间：2009-02-13T06:18:21.853
> 
> 标签：javascript, dom, caching

我正在使用 mootools 在我的一种表单中切换两个 DOM 元素的显示（和存在）。然后，我使用 javascript 来验证表单以确保填写了所有必填字段。问题是浏览器似乎正在缓存元素。例如，我有这样的html：

```
<input name="inputbox" id="inputbox" type="text" />
<select name="selection" id="selection">...</select> 
```

用于验证的 javascript 是这样的：

```
if (form.inputbox != null && form.inputbox.value == "") {
  //don't submit form
{
else if (form.selection != null && form.selection.value == 0) {
  //don't submit form
} 
```

现在，当页面首次加载并且`input`元素已被删除时，这可以正常工作。但是，当我单击将`input`元素替换为元素的按钮时`select`，从那时起，`form.inputbox`javascript`form.selection`代码中的各个元素都将包含相应的元素，因为它在 DOM 中处于其最后状态 - 即使它不再在 DOM 中。那么 javascript 缓存 DOM 并且在从 DOM 中删除元素时不更新元素吗？这里发生了什么，更重要的是，我应该如何修复它？

编辑：我正在使用 mootools 来删除和替换元素，可以在[此处](http://docs111.mootools.net/Native/Element.js#Element.remove)和[此处](http://docs111.mootools.net/Native/Element.js#Element.replaceWith)找到相应功能的文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T06:42:41.717

当不存在返回未定义时，按名称 (form.elementName) 评估元素。评估对象的属性值 ($('elementId')) 返回 null。Undefined 和 null 的处理方式不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T06:27:01.100

好吧，我现在可以回答我的问题的第二部分：如何解决它。如果您使用的是 mootools，则使用美元函数（或 getElementById 可能有效）而不是使用`form.selection`and `form.inputbox`：

```
if ($("inputbox") != null && $("inputbox").value == "") {
  //don't submit form
{
else if ($("selection") != null && $("selection").value == 0) {
  //don't submit form
} 
```

它有效，但我没有解释为什么另一个没有......

# c# - 如何获取当前的 Windows 主题名称？

> ID：544906
> 
> 赞同：0
> 
> 时间：2009-02-13T06:23:56.317
> 
> 标签：c#

我试图在 C# 中获取当前的 Windows 主题名称，但结果比预期的要难一些。我有一个来自 MSDN 的代码示例：

```
public void Test()
{
    StringBuilder themeFileName = new StringBuilder(0x200);
    GetCurrentThemeName(themeFileName, themeFileName.Capacity, null, 0, null, 0);
    string fileName = Path.GetFileName(VisualStyleInformation.ThemeFilename);
    if (string.Equals("aero.msstyles", fileName, StringComparison.OrdinalIgnoreCase))
    {
        // user is using aero theme
    }
}

[DllImport("uxtheme.dll", CharSet = CharSet.Auto)]
public static extern int GetCurrentThemeName(StringBuilder pszThemeFileName, int   
    dwMaxNameChars, StringBuilder pszColorBuff, int dwMaxColorChars,
    StringBuilder pszSizeBuff, int cchMaxSizeChars); 
```

GetCurrentTheme() 不会修改 StringBuilder。我还尝试查看
System.Windows.Forms.VisualStyles.VisualStyleInformation 类，但它充满了空值。有人知道怎么做吗？我一定错过了一些简单的东西，但我还没有找到任何有效的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T06:46:59.117

[CodeProject 上的那篇文章](http://www.codeproject.com/KB/miscctrl/uxtheme.aspx)描述了如何获取“当前视觉样式信息”（在文章中搜索该字符串）。

它包含如何做到这一点的示例代码。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-14T15:24:39.070

您没有通过引用传递字符串生成器。

# latex - 从 LaTeX 中的超链接 ToC 中删除框

> ID：544907
> 
> 赞同：56
> 
> 时间：2009-02-13T06:25:15.627
> 
> 标签：latex, pdflatex, tableofcontents

如何从使用 LaTeX 中的 hyperref 包创建的超链接目录中删除红色框。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-02-13T18:15:18.243

要删除边框：

```
\hypersetup{%
    pdfborder = {0 0 0}
} 
```

该`colorlinks`选项将打开链接颜色并删除边框。（这就是为什么 alamodey 将所有链接颜色设置为黑色。）

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-02-13T06:41:05.340

```
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
} 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2012-02-09T20:34:57.140

2011 年 2 月发布的 hyperref 6.82a 版本引入了一个新`hidelinks`选项，可以更轻松地完成此任务。你现在需要的是：

```
\usepackage[hidelinks]{hyperref} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-08-25T23:19:28.727

我意识到回答有点晚了，但根据我的经验，有一种更简单的方法

```
\usepackage[colorlinks=true]{hyperref} 
```

这会将 hyperref 从丑陋的边框转变为链接着色，这是您通常想要的。有关更多选项，请参见此处：

[http://en.wikibooks.org/wiki/LaTeX/Hyperlinks](http://en.wikibooks.org/wiki/LaTeX/Hyperlinks)

# c# - 如何将代码隐藏在多个文件中？

> ID：544908
> 
> 赞同：0
> 
> 时间：2009-02-13T06:25:34.893
> 
> 标签：c#, asp.net, code-behind

关于在 Visual Web Developer 2008 Express 环境中正确编译和执行的内容以及在我的 Web 服务器上失败的内容，我遇到了很多不一致的问题。

特别是，我的 Web Developer 项目中有一个 aspx 和 aspx.cs 代码隐藏，以及一些额外的 .cs 文件。它在开发服务器下构建良好并且可以正常执行。将文件上传到服务器后，代码隐藏似乎不知道其他 .cs 文件。

使我的 aspx 应用程序继承其他 .cs 文件的正确方法是什么？

--- 更新 --- 由于我并没有真正找到我需要的答案，所以让我对我正在做的事情更明确一点：

我有三个文件：

默认.aspx

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default" %>
<%@ Import Namespace="UtilClasses" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

默认.aspx.cs

```
public partial class _Default : Page { } 
```

App_Code/UtilClasses.cs

```
namespace UtilClasses {
  public class AClass {
    public const int A = 1;
  }
} 
```

在此示例中，如果我尝试执行以下任何操作，我的 Web 服务器上会出现编译错误：

*   使用 @Import 引用 App_Code
*   从 aspx.cs 代码隐藏中调用其中包含的代码或
*   从 aspx 页面调用代码。

它在 Web Developer 2008 中编译得很好。解决方案是一个网站，它通过 FTP 自动发布到我的 Web 服务器。正在发布的文件的确切列表是：

*   默认.aspx
*   默认.aspx.cs
*   App_Code/UtilClasses.cs
*   网络配置

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T06:35:12.390

看来您有部署问题。

只需将您的 Web 应用程序/站点**发布**（在构建菜单中有一个发布项）到一个文件夹，然后将该文件夹中的文件移动到您的服务器。

我认为您的目录中有旧的程序集文件和新类。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T13:38:09.860

您可以使用部分类。添加一个文件 ( *.cs) 并将您的类定义为部分。这样，您就可以分发您的方法，属性另一个文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T06:40:33.703

这是在您的 Web 应用程序中组织代码的一个非常常见的问题。这里有一些提示可以帮助您解决问题。

1.  如果使用单个项目并且它是 ASP.net 网站项目，请将您的 .cs 文件放在 app_code 文件夹中。

2.  明智地使用名称空间并跟踪哪个名称空间中的内容。如果你有类似 Resharper 的东西，它可以保存这个任务。

3.  理想情况下，您的 Web 项目中应该只有与页面相关的类和实用类。使用 C# express 为其他功能创建库。使用 NUnit/MbUnit 或类似工具测试这些库。

4.  如果您怀疑某些东西是否在 Cassini 上运行而不是在 IIS 上运行。开发或本地 IIS 是唯一的解决方案。

希望有帮助！

# algorithm - 是否有任何算法可以在复杂度小于 log2(n) 的排序数组中搜索元素

> ID：544910
> 
> 赞同：0
> 
> 时间：2009-02-13T06:25:51.040
> 
> 标签：algorithm, search, time-complexity

我已经编写了一种算法，用于在复杂度为 log2(n)/5 的排序数组中进行搜索。它有用吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-13T06:33:43.003

可以证明，对于仅假设比较操作的搜索，您不能低于 O(log(n))。log2(n)/5 的复杂度与 O(log(n)) 相同。
有用性取决于您使用它的目的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T13:39:33.463

嗯。棘手的问题。你为什么不发布你的算法，让我们看看你做了什么。

但是，对于真正的胜利，您应该比 O(log2 log2 (n)) 更好？这就是插值搜索平均所做的事情。

[http://en.wikipedia.org/wiki/Interpolation_search](http://en.wikipedia.org/wiki/Interpolation_search)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T06:57:07.267

除了排序之外，如果没有关于数组的任何其他假设，或者没有任何预计算/数据结构创建，不可能比 log2n 做得更好。

如果您要查找的元素不在您的数组中，您如何建议在少于 log₂n 的步骤中终止？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T07:01:59.313

当然，您总是可以争论非线性搜索是否一定比线性搜索快：[http ://www.ddj.com/184405848](http://www.ddj.com/184405848)

即，如果您正在搜索高速缓存行，则线性搜索它可能比分支搜索更快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-13T13:47:26.033

*我认为如果它在实践中*比其他现有的 O(logn) 搜索算法更快会很有用。换句话说，如果您的基准测试显示速度有所提高。然而，对于非常大的输入，恒定时间改进（如 1/5）并没有太大的区别。这就是为什么最重视算法的*渐近复杂度*的原因。

# visual-c++ - dll问题

> ID：544914
> 
> 赞同：0
> 
> 时间：2009-02-13T06:27:21.147
> 
> 标签：visual-c++, dll, function

后续问题：我在循环中重复调用该函数。当需要使用该函数处理多个项目时，应用程序会崩溃。当只处理一项时它工作正常。该怎么办？

[已解决] 我在 dll 中有一个涉及读取和写入文件的函数。我在测试应用程序中调用 dll 函数，但是当应用程序仍然打开时无法写入文件。在成功写入文件之前，我总是需要先关闭测试应用程序。

我该怎么做才能解决这个问题？

注意：我的 dll 实际上是我转换为 dll 的 .exe

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T06:35:50.860

我的猜测是文件已经打开。您的代码是否打开文件然后保持文件打开？

检查代码以确保每个打开的文件都有一个匹配的文件关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T06:32:55.563

以正确的共享权限打开文件？您使用什么 API 来打开文件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T06:35:03.357

当您从测试代码调用该函数时，我建议您使用不同的文件名。如果可能，修改 dll 以接受文件名。

如果没有，请确保以共享模式打开文件。

# unit-testing - 如何处理代码覆盖率？

> ID：544915
> 
> 赞同：2
> 
> 时间：2009-02-13T06:27:21.690
> 
> 标签：unit-testing, code-coverage

前几天，我们在不同的开发人员和项目负责人之间就代码覆盖工具和相应报告的使用进行了激烈的讨论。

*   你在你的项目中使用代码覆盖率吗？如果是，为什么不呢？
*   代码覆盖率是您构建或持续集成的固定部分，还是您只是不时使用它？
*   您如何处理从报告中得出的数字？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T06:30:35.380

我们使用代码覆盖率来验证我们在测试工作中没有遗漏重要部分。一旦一个里程碑左右，我们就会运行一份完整的覆盖率报告，并花几天时间分析结果，为我们错过的区域添加测试覆盖率。

我们不会在每次构建时都运行它，因为我不知道我们是否会定期对其进行分析以证明这一点。

我们分析大块未命中代码的报告。我们发现这是最有效的使用方式。在过去，我们会尝试达到特定的代码覆盖率目标，但在某个时间点之后，回报变得非常减少。相反，最好使用代码覆盖率作为一种工具来确保您没有忘记任何事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-13T06:33:18.493

1) 是的，我们确实使用代码覆盖率

2）是的，它是 CI 构建的一部分（为什么不呢？）

3) 重要的部分——我们不寻求 100% 的覆盖率。我们要寻找的是有缺陷/复杂的代码，这些代码很容易从您的单元测试中找到，并且开发人员/主管会知道系统的微妙部分。我们确保此类代码区域的覆盖率良好，并且随着时间的推移而增加，而不是随着人们在没有必要测试的情况下进行更多修复而减少。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T23:07:33.107

查看代码覆盖率的方法是查看未覆盖的内容并找出未覆盖的原因。代码覆盖率只是告诉我们，当单元测试运行时，代码行正在被命中。它并没有告诉我们代码是否正常工作。100% 的代码覆盖率是一个不错的数字，但在中/大型项目中很难实现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-13T07:28:11.013

代码覆盖率告诉您“捕捉错误”的网络有多大，但它并没有告诉您网络中的漏洞有多大。

将其用作衡量测试工作的指标，而不是绝对指标。

可以编写可以为您提供 100% 覆盖率并且根本不测试任何内容的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-13T06:48:49.190

我喜欢测量任何重要项目的代码覆盖率。如前所述，尽量不要太着迷于实现任意/神奇的百分比。有更好的指标，例如基于复杂性的风险、包/命名空间的覆盖率等。

查看此示例 Clover[仪表板](http://downloads.atlassian.com/software/clover/samples/pmd/index.html "仪表板")以了解类似的想法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-13T07:00:55.603

我们在构建中这样做，我们看到它不应该低于某个值，比如 85%。我还做了自动 Top 10 Largest Not-covered 方法，以了解开始覆盖的内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-13T11:51:05.343

我发现这取决于代码本身。我不会重复 Joel 在 SO podcast #38 中的陈述，但结果是“尽量务实”。

代码覆盖率在应用程序的核心元素中非常好。

我将代码视为依赖树，如果叶子工作（例如基本 UI 或调用单元测试 DAL 的代码）并且我在开发或更新它们时对它们进行了测试，那么它们很有可能会工作，如果有错误，那么查找或修复并不难，因此模拟一些测试所花费的时间可能会浪费时间。是的，有一个问题是他们所依赖的代码的更新可能会影响他们，但同样，这是一个个案，他们所依赖的代码的单元测试应该涵盖它。

*当涉及到代码的主干或分支时，是的，功能*的代码覆盖率（相对于每个功能）非常重要。

例如，我最近在一个团队中构建了一个应用程序，该应用程序需要一系列计算来计算碳排放量。我编写了一套测试来测试每一个计算，并且在这样做时很高兴看到依赖注入模式运行良好。

不可避免地，由于政府行为的改变，我们不得不在方程中添加一个参数，并且所有 100 多个测试都失败了。

我意识到要更新它们，除了测试拼写错误（我可以测试一次），我是单元/回归测试数学，并最终把时间花在构建应用程序的另一个区域上。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-13T07:05:09.807

许多切换到 Agile/XP 的团队使用代码覆盖率作为衡量其测试自动化工作 ROI 的间接方式。

我认为这是一个实验——假设“如果我们开始编写单元测试，我们的代码覆盖率将会提高”——通过 CI 自动收集相应的观察结果，在图表中报告它等是有意义的。

您可以使用结果来检测粗略点：例如，如果更多覆盖率的趋势在某个时候趋于平稳，您可能会停下来询问发生了什么。也许团队无法编写相关的测试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-13T07:09:45.070

我们使用代码覆盖率来确保我们的测试中没有重大漏洞，并且它每晚在我们的 CI 中运行。

由于我们还有一整套贯穿整个堆栈的 selenium-web 测试，我们还做了一个额外的覆盖技巧：

我们设置了覆盖运行的 Web 应用程序。然后我们运行硒测试的全自动测试电池。其中一些只是冒烟测试。

运行全套测试后，我们可以通过查看覆盖率和检查代码来识别可疑的*死代码。*这在处理大型项目时非常好，因为一段时间后您可能会拥有大量死代码。

对于我们执行此操作的频率，我们实际上并没有任何固定的指标，但它全部设置为通过一两个按键运行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-13T07:22:59.827

我们确实使用代码覆盖率，它集成在我们的夜间构建中。有几种工具可以分析覆盖率数据，通常它们会报告

1.  报表覆盖率
2.  分支覆盖
3.  MC/DC 覆盖范围

我们预计将达到 + 90% 的语句和分支覆盖率。另一方面，MC/DC 覆盖为测试团队提供了更广泛的意义。对于未发现的代码，顺便说一下，我们期望有理由记录。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-03-14T16:35:27.157

1）是的，我们确实测量了简单的节点覆盖率，因为：

*   使用我们当前的项目很容易做到*（Rails 网络应用程序）
*   它鼓励我们的开发人员编写测试（一些来自临时测试的背景）

2) 代码覆盖率是我们持续集成过程的一部分。

3) 报告中的数字用于：

*   强制执行最低覆盖率（95% 否则构建失败）
*   找到应该测试的代码段

在系统的某些部分，测试并不是那么有帮助（通常需要使用模拟对象来处理外部系统）。但是通常具有良好的覆盖范围可以更容易地维护项目。人们知道修复或新功能不会破坏现有功能。

*为 Rails 设置所需覆盖范围的详细信息：[Min Limit 95 Ahead](http://blog.codesherpas.com/on_the_path/2010/03/min-limit-95-ahead.html "最低限 95 领先")

# python - 从函数返回后如何在 Python 中打印原始变量的名称？

> ID：544919
> 
> 赞同：61
> 
> 时间：2009-02-13T06:30:06.210
> 
> 标签：python, variables

我有枚举并使用变量，如`myEnum.SomeNameA`，`myEnum.SomeNameB`等。当我从函数返回这些变量之一时，我可以打印它们的名称（例如`myEnum.SomeNameA`）而不是它们返回的值吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-13T06:38:01.213

简短的回答：没有。

长答案：使用回溯、检查等一些丑陋的黑客可以做到这一点，但通常不建议将其用于生产代码。例如参见：

*   [http://groups.google.com/group/comp.lang.python/msg/237dc92f3629dd9a?pli=1](http://groups.google.com/group/comp.lang.python/msg/237dc92f3629dd9a?pli=1)
*   [http://aspn.activestate.com/ASPN/Mail/Message/python-Tutor/330294](http://aspn.activestate.com/ASPN/Mail/Message/python-Tutor/330294)

也许您可以使用一种解决方法将值转换回名称/表示字符串。如果您发布更多示例代码和有关您想要什么的详细信息，也许我们可以提供更深入的帮助。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-02-13T11:50:19.107

没有唯一的或原始的变量名称 [http://www.amk.ca/quotations/python-quotes/page-8](http://www.amk.ca/quotations/python-quotes/page-8)

> 就像你得到你在门廊上发现的那只猫的名字一样：猫（物体）本身不能告诉你它的名字，它并不真正关心——所以找出它叫什么的唯一方法是询问你所有的邻居（命名空间）是否是他们的猫（对象）......
> 
> ....如果您发现它有很多名字，或者根本没有名字，请不要感到惊讶！
> 
> **Fredrik Lundh，2000 年 11 月 3 日，回答问题“当我拥有 PyObject* 时，如何从 C++ 中获取变量的名称？”**

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-02-13T06:45:43.770

要添加到[@Jay 的答案](https://stackoverflow.com/questions/544919/python-can-i-print-original-var-name/544944#544944)，一些概念......

Python“变量”只是对值的引用。每个值占用一个给定的内存位置（请参阅`id()`）

```
>>> id(1)
10052552

>>> sys.getrefcount(1)
569 
```

从上面，您可能会注意到值“1”出现在内存位置 10052552。在此解释器实例中，它被引用了 569 次。

```
>>> MYVAR = 1
>>> sys.getrefcount(1)
570 
```

现在，看到因为另一个名称绑定到这个值，引用计数增加了一个。

基于这些事实，判断单个变量名称指向一个值是不现实的/不可能的。

我认为解决您的问题的最佳方法是将映射和函数添加到您的枚举引用回字符串名称。

```
myEnum.get_name(myEnum.SomeNameA) 
```

如果您想要示例代码，请发表评论。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-09-13T21:42:53.600

# 是的。

在您使用枚举的情况下，这很容易：

```
>>> from enum import Enum
>>> class Type(Enum):
...   AB, SBS, INTERLACED, SPLIT = range(4)
...
>>> Type.AB
<Type.AB: 0>
>>> print(Type.AB)
Type.AB
>>> Type.AB.name
'AB'
>>> Type.AB.value
0
>>> Type(0)
<Type.AB: 0> 
```

一般来说，它可能是模棱两可的：

```
>>> def varname(v): d = globals(); return [k for k in d if d[k] == v]
...
>>> def varnameis(v): d = globals(); return [k for k in d if d[k] is v]
...
>>> foo = {'a':'aap'}
>>> bar = {'a':'aap'}
>>> varname(foo)
['foo', 'bar']
>>> varnameis(foo)
['foo'] 
```

甚至误导：

```
>>> foo = "A"; bar = "A"
>>> varnameis("A")
['foo', 'bar']
>>> foo = "An immutable value."; bar = "An immutable value."
>>> varnameis("An immutable value.")
[]
>>> foo = "An immutable value."; bar = "An immutable value."; varnameis("An immutable value.")
['foo', 'bar']
>>> import sys; sys.version
'3.6.6 (v3.6.6:4cf1f54eb7, Jun 27 2018, 02:47:15) [MSC v.1900 32 bit (Intel)]' 
```

要在任何范围内搜索，请使用以下命令：

```
>>> def varname(v, scope=None): d = globals() if not scope else vars(scope); return [k for k in d if d[k] == v]
...
>>> import time
>>> time.timezone
-3600
>>> varname(-3600)
[]
>>> varname(-3600, time)
['timezone'] 
```

为避免歧义，[请将您的姓名用 data 包裹起来](https://stackoverflow.com/a/67419557/819417)。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2019-10-16T13:56:16.393

Python 3.8 为此添加了一个新的并且可能是**更好**的解决方案：

```
my_nice_variable_name = 'test'
print(f'{my_nice_variable_name=}')

# Output:
# my_nice_variable_name='test' 
```

在这里，您可以使用字符串输出。仍然不可取，但可能比其他方法好一点。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-13T07:47:56.863

只需使用要打印的文本作为枚举的值，如

```
class MyEnum (object):
    valueA = "valueA"
    valueB = "valueB" 
```

在 Python 中比较字符串的身份几乎与比较整数值一样有效（这是因为字符串是不可变的，因为它具有哈希值）

当然，首先有更简单的方法来创建枚举：

```
class Enum (object):
    def __init__(self, *values):
        for v in values:
            self.__dict__[v] = v 
```

然后，像这样创建您的枚举：

```
MyEnum = Enum("valueA", "valueB") 
```

ans 访问方式同上：

```
MyEnum.valueA 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-27T01:51:36.110

这个问题有两个答案：*Yes*和*No*。

```
你能做到吗？-- 是（在大多数情况下）
这值得么？-- 否（在大多数情况下）

```

### 怎么做：

这取决于枚举的实现。例如：

```
class Enum:
    A = 1
    B = 2 
```

*如果您知道 enums 类对象以及它们在该类中的所有名称（或至少是唯一前缀），那么*是否有 100 个名称指的是您想要查找其名称的整数并不重要。

对于上面[@batbrat 建议](https://stackoverflow.com/questions/544919/python-can-i-print-original-var-name/544954#544954)的示例，您可以使用以下命令检查“ `Enum.__dict__`” [`namestr()`](https://stackoverflow.com/questions/592746/how-can-you-print-a-variable-name-in-python/592891#592891)：

```
 >>> getEnum = lambda: Enum.A
 >>> namestr(getEnum(), Enum.__dict__)
 >>> ['A'] 
```

在这种情况下，您甚至不必知道所有枚举名称。如果枚举以不同的方式实现，那么您可能需要使用不同的 hack。在大多数情况下会有一些解决方案，例如，请参阅[@Jay 的回答](https://stackoverflow.com/questions/544919/python-can-i-print-original-var-name/544944#544944)。不过没关系，因为..

### 这值得么？

*   一些枚举实现可能需要丑陋、复杂且最终不可靠的 hack 来实现`namestr()`。

*   Enum 类可以自行返回答案（参见[@David's](https://stackoverflow.com/questions/544919/python-can-i-print-original-var-name/544957#544957)、[@Ber's](https://stackoverflow.com/questions/544919/python-can-i-print-original-var-name/545089#545089)、[@gahooa's](https://stackoverflow.com/questions/544919/python-can-i-print-original-var-name/544966#544966)答案）。

*   正如[@Ber 指出的那样](https://stackoverflow.com/questions/544919/python-can-i-print-original-var-name/545742#545742)，Python 中没有内置的 Enum 和 switch 语句（参见[PEP-0275](http://www.python.org/dev/peps/pep-0275/)，[PEP-3103](http://www.python.org/dev/peps/pep-3103/)）。值得研究没有枚举的解决方案。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-13T06:43:56.877

您可以将规范名称存储为实例的属性，然后将其分配给具有相同名称的变量。这可能有效：

```
class MyEnum(object):
    def __new__(cls, name):
        try:
            return getattr(MyEnum, name)
        except AttributeError:
            e = super(MyEnum, cls).__new__(cls)
            e.name = name
            setattr(MyEnum, name, e)
            return e 
```

无论如何，这并不是一件特别“Pythonic”的事情。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-07-30T14:03:13.427

# 是的

```
import inspect

def printVariableName(abc):
    newvar=inspect.stack()[1][4][0]
    print(newvar.split("(")[1].split(")")[0])

noob=10
printVariableName(noob) 
```

输出：

```
noob 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-13T12:28:17.563

转念一想：

由于 Python 不提供原生 Enum 类型，因此您不应要求提供一种，而应使用其他更强大的构造来构建您的程序。否则，下一步总是会是“为什么 Python 没有`switch ...:`语句，我如何最好地模拟它？”

由于枚举通常用于定义某种状态，因此更好的方法是：创建一个基类，定义属于状态的所有抽象属性、属性和方法。然后，对于每个状态，派生一个实现该状态特定行为的子类。然后，您可以传递这些类（或者可能是其中的实例）来处理状态及其行为。

`if current_state is StateA:`如果您使用类而不是实例（“单例”的 Python 方式），您可以简单地通过（注意`is`而不是）检查任何给定的状态（不是必须的），而不会对`==`比较整数值造成性能损失。

当然，您可以定义一个`name`属性和一个`__str__()`方法来访问和打印州名。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-13T06:46:47.713

Erlang 有一个称为“原子”的概念——它们类似于字符串常量或枚举。考虑使用字符串常量作为枚举的值——与枚举的名称相同。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-13T06:43:23.073

据我所知，这需要一些反省。您可以尝试使用检查模块。

在此之前，您可能想尝试一些简单的事情：

1.  这不是应该使用的确切代码。在打印之前，您必须从 __dict__ 检索变量名称。

    ```
    打印 myEnum.__dict__

    ```

2.  如果你想从函数内部打印变量名，你可以试试这些函数——vars()、locals() 和 globals()。
    **编辑**：
    我只是注意到这不是你想要的。在这种情况下，添加一个 dict 和一个函数可能会起作用
3.  您可能想要打印枚举类的 __dict__ 。

尽管如此，Python 中没有标准的枚举。这将有助于了解您是如何创建它们的。

再三考虑，您可以将变量维护为枚举中的字典，以变量名称为键，并提供一种枚举方法来查找正确的变量并打印其名称。这个解决方案（保留一个字典）很糟糕，因为变量值不一定是唯一的。

**编辑**：
这个问题不是微不足道的，所以你可能想使用一个久经考验的解决方案。恕我直言，如果可以的话，你最好避免这种情况。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-12-14T09:15:33.553

我知道这是一个老问题，但**可以**使用`f strings`.

```
my_variable = some_object
f'{my_variable=}'.split('=', 1)[0] 
```

这将打印 `'my_variable'`

# python - 读取换行符分隔文件并丢弃换行符的最佳方法？

> ID：544921
> 
> 赞同：86
> 
> 时间：2009-02-13T06:31:11.200
> 
> 标签：python, file, readline

我正在尝试确定在 Python 中读取换行符分隔文件时处理摆脱换行符的最佳方法。

我想出的是以下代码，包括要测试的一次性代码。

```
import os

def getfile(filename,results):
   f = open(filename)
   filecontents = f.readlines()
   for line in filecontents:
     foo = line.strip('\n')
     results.append(foo)
   return results

blahblah = []

getfile('/tmp/foo',blahblah)

for x in blahblah:
    print x 
```

* * *

## 回答 #1

> 赞同：199
> 
> 时间：2009-02-13T06:35:50.797

```
lines = open(filename).read().splitlines() 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-13T08:35:46.047

这是一个可以满足您要求的生成器。在这种情况下，使用 rstrip 就足够了，并且比 strip 稍快。

```
lines = (line.rstrip('\n') for line in open(filename)) 
```

但是，您很可能也希望使用它来消除尾随空格。

```
lines = (line.rstrip() for line in open(filename)) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-08-08T07:26:31.353

您如何看待这种方法？

```
with open(filename) as data:
    datalines = (line.rstrip('\r\n') for line in data)
    for line in datalines:
        ...do something awesome... 
```

生成器表达式避免将整个文件加载到内存中并`with`确保关闭文件

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-13T06:36:08.847

```
for line in file('/tmp/foo'):
    print line.strip('\n') 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-14T07:43:58.020

只需使用生成器表达式：

```
blahblah = (l.rstrip() for l in open(filename))
for x in blahblah:
    print x 
```

另外，我想建议您不要在内存中读取整个文件——循环生成器在大数据集上效率更高。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-13T11:07:27.710

我用这个

```
def cleaned( aFile ):
    for line in aFile:
        yield line.strip() 
```

然后我可以做这样的事情。

```
lines = list( cleaned( open("file","r") ) ) 
```

或者，我可以使用额外的功能扩展清理，例如，删除空白行或跳过注释行或其他任何内容。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-13T06:43:59.983

我会这样做：

```
f = open('test.txt')
l = [l for l in f.readlines() if l.strip()]
f.close()
print l 
```

# python - 切换打印机托盘

> ID：544923
> 
> 赞同：5
> 
> 时间：2009-02-13T06:32:56.013
> 
> 标签：python, winapi

我知道以前有人问过这个问题，但没有明确的答案。

如何以编程方式更改打印机托盘？

我正在尝试使用 python 批量打印一些 PDF。我需要从不同的纸盘打印不同的页面。打印机是理光2232C。有没有办法通过 Acrobat Reader 命令行参数来做到这一点？我可以使用 Win32 api 找出哪些 bin 对应于哪些 binnames，但仅此而已。有什么建议/捷径/等等吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-15T22:09:30.727

好的，我想通了。答案是：

1.你需要一台本地打印机（如果你需要打印到网络打印机，下载驱动并添加为本地打印机）
2.使用win32print获取和设置默认打印机
3.同样使用win32print，使用以下代码：

```
import win32print
PRINTER_DEFAULTS = {"DesiredAccess":win32print.PRINTER_ALL_ACCESS}
pHandle = win32print.OpenPrinter('RICOH-LOCAL', PRINTER_DEFAULTS)
properties = win32print.GetPrinter(pHandle, 2) #get the properties
pDevModeObj = properties["pDevMode"] #get the devmode
automaticTray = 7
tray_one = 1
tray_two = 3
tray_three = 2
printer_tray = []
pDevModeObj.DefaultSource = tray_three #set the tray
properties["pDevMode"]=pDevModeObj #write the devmode back to properties
win32print.SetPrinter(pHandle,2,properties,0) #save the properties to the printer 
```

4.  就这样，托盘已经换了

5.  使用 Internet Explorer 完成打印（来自 Graham King 的博客）

    ```
    from win32com import client
        import time
        ie = client.Dispatch("InternetExplorer.Application")
        def printPDFDocument(filename):
            ie.Navigate(filename)
            if ie.Busy:
                time.sleep(1)
            ie.Document.printAll()
        ie.Quit() 
    ```

完毕

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T06:45:28.043

没有简单的方法可以做到这一点，因为您表示要从 pdf 中选择特定页面并使用 Acrobat Reader 将它们打印到特定的垃圾箱

示例：在信头纸盒 1 上打印第 1 页，在纸盒 2 上打印第 2 页

Acrobat Reader 仅允许从命令行打印整个文档：

您可以更改免费软件[Ghostscript](http://pages.cs.wisc.edu/~ghost/doc/GPL/index.htm)并做您想做的事。

或者这个商业产品应该可以完成这项工作。[PDF打印](http://www.globalpdf.com/pdfprint/pdf-print-cmd.html)

* * *

有关详细信息，请参阅第 24 页的 Acrobat Reader[开发人员常见问题解答](http://www.adobe.com/devnet/acrobat/pdfs/Acrobat_SDK_developer_faq.pdf)

**AcroRd32.exe /t path "printername" "drivername" "portname"** — 启动 Adob​​e Reader 并打印文件，同时取消打印对话框。必须完全指定路径。

/t 选项的四个参数计算为路径、打印机名、驱动程序名和端口名（所有字符串）。

**打印机**名称 — 您的打印机名称。

**drivername** — 您的打印机驱动程序的名称，它显示在您的打印机属性中。

**portname** — 打印机的端口。端口名不能包含 — 您的打印机驱动程序的名称，它显示在您的打印机属性中。

**portname** — 打印机的端口。端口名不能包含

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T08:33:27.940

使用纯 PDF 是不可能的，因为您已经为任何特定的纸盒和托盘组合创建了新的*打印作业*（并非所有打印机都允许您这样做，施乐 4x 和 DP 系列允许您这样做）。

我最好的选择是使用 PostScript：将 PDF 转换为 PostScript，您可以在其中访问各个页面，然后提取您需要的页面，并为每个这样的页面（或页面）创建新的打印作业（例如，使用 Windows 程序`lpr`）。为了简化任务，我会为您必须打印到的纸盒和托盘的任意组合创建打印队列，然后将这些队列用作打印机。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-07T13:08:33.107

您已经拥有一台 Ricoh 机器，只需获取 Ricoh Print&Share 软件，您就可以在其中定义要使用的托盘！

这些视频向您展示了如何设置 Ricoh Print&Share 软件：

*   [http://www.youtube.com/watch?v=6iXuU4b5mh4](http://www.youtube.com/watch?v=6iXuU4b5mh4)
*   [http://www.youtube.com/watch?v=cZg0byBj_w0](http://www.youtube.com/watch?v=cZg0byBj_w0)
*   [http://www.youtube.com/watch?v=Hf5sndsWr6I](http://www.youtube.com/watch?v=Hf5sndsWr6I)

# java - java中使用nio包的socketChannel可以从客户端socket获取的最大数据大小

> ID：544924
> 
> 赞同：3
> 
> 时间：2009-02-13T06:33:05.750
> 
> 标签：java

使用`SocketChannel sc =(SocketChannel)key.channel();`，我们可以从端口获取数据到缓冲区。
为了在不丢失数据的情况下从端口连续接收数据，代码应该如何？

这是我的代码

```
import java.io.*;
import java.net.*;
import java.nio.*;
import java.nio.channels.*;
import java.util.*;

public class MultiPortEcho
{
  private int ports[];
  private ByteBuffer echoBuffer = ByteBuffer.allocate(32000);

  public MultiPortEcho( int ports[] ) throws IOException
  {
    this.ports = ports;
    go();
  }

  private void go() throws IOException
  {
    // Create a new selector
    Selector selector = Selector.open();

    // Open a listener on each port, and register each one
    // with the selector
    for (int i=0; i<ports.length; ++i)
    {
      ServerSocketChannel ssc = ServerSocketChannel.open();
      ssc.configureBlocking( false );
      ServerSocket ss = ssc.socket();
      InetSocketAddress address = new InetSocketAddress( ports[i] );
      ss.bind( address );

      SelectionKey key = ssc.register( selector, SelectionKey.OP_ACCEPT );

      System.out.println( "Going to listen on "+ports[i] );
    }

    while (true)
    {
      int num = selector.select();
      System.out.println("num::::"+num);
      Set selectedKeys = selector.selectedKeys();
      Iterator it = selectedKeys.iterator();

      while (it.hasNext())
      {
        SelectionKey key = (SelectionKey)it.next();

        if ((key.readyOps() & SelectionKey.OP_ACCEPT)== SelectionKey.OP_ACCEPT)
          {
              // Accept the new connection
              ServerSocketChannel ssc = (ServerSocketChannel)key.channel();
              SocketChannel sc = ssc.accept();
              sc.configureBlocking( false );

              // Add the new connection to the selector
              SelectionKey newKey = sc.register(selector,SelectionKey.OP_READ);
              it.remove();

              System.out.println( "Got connection from "+sc );
        }
          else if ((key.readyOps() & SelectionKey.OP_READ)== SelectionKey.OP_READ)
          {
              // Read the data
              SocketChannel sc =(SocketChannel)key.channel();
              System.out.println("sc::::"+sc);
              // data to fetched from channel and dump into the datatbase
              int bytesEchoed = 0;
              //while(true)
              {
                    echoBuffer.clear();
                    int r = sc.read(echoBuffer);
                    System.out.println("r:::" + r);
                    /*int pos=echoBuffer.position();
                    System.out.println("pos:::" +pos);*/
                    if (r == -1)
                    {
                        //echoBuffer.flip();
                        echoBuffer.rewind();
                        byte[] array = new byte[100000];
                        while (echoBuffer.hasRemaining())
                        {
                            int n = echoBuffer.remaining();
                            System.out.println("size:" + n);
                            echoBuffer.get(array,0,n );
                            System.out.println(new String(array,0,n));
                            key.cancel();
                            it.remove();

                        }

                    }

                    /*int pos=echoBuffer.position();
                    System.out.println("pos:::" + pos);
                    if(r<=0)
                    {
                        echoBuffer.flip();
                        for (int j = 0; j < pos; j++ )
                        {
                            String ss =Integer.toHexString(echoBuffer.get());
                            if (ss.length() == 1)
                                System.out.print("0" + ss + " ");
                            else if (ss.length() > 2)
                                System.out.print(ss.substring(6) + " ");
                            else System.out.print(ss + " ");
                        }
                      break;
                    }

                    echoBuffer.flip();

                    sc.write( echoBuffer );
                    bytesEchoed += r;*/
              }

             //System.out.println( "Echoed "+bytesEchoed+" from "+sc );
             //it.remove();
        }

      }

//System.out.println( "going to clear" );
//      selectedKeys.clear();
//System.out.println( "cleared" );
    }
  }

  static public void main( String args[] ) throws Exception
  {
    FileOutputStream fileoutputstream = new FileOutputStream("MultiPort.txt", false);
    PrintStream printstream = new PrintStream(fileoutputstream);
    System.setOut(printstream);
    if (args.length<=0) {
      System.err.println( "Usage: java MultiPortEcho port [port port ...]" );
      System.exit( 1 );
    }

    int ports[] = new int[args.length];

    for (int i=0; i<args.length; ++i) {
      ports[i] = Integer.parseInt( args[i] );
    }

    new MultiPortEcho( ports );
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-04T15:00:05.957

您可以读取的最大大小实际上受到您拥有的内存量的限制。

但是，您不需要阅读超大块以提高效率。您应该会发现 1 MB 绰绰有余。事实上，您可能会发现 4KB 的块足够大以获得 1 Gb 连接的最大带宽。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T07:05:40.913

对总体设计的评论：

编写网络服务器有两种基本方法。阻塞和非阻塞。2008 年，我们的任务是用 Python 实现一个高性能的网络服务器。在尝试了几种不同的非阻塞方式后，我们发现使用起来**更容易**、更清晰：

*   阻塞套接字
*   每个连接一个线程
*   几个管理器线程

这样，每个线程都可以坐下来等待数据，直到它死亡的那一天，当它收到一个完整的数据包时，它就会采取行动。

仅供参考。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T20:33:12.747

作为第一个修复，您应该删除带有 key.cancel() 的行。保留它会取消密钥并确保在第一次读取后不考虑密钥 - 这将有效地阻止您之后阅读任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T07:01:25.040

[**您可以在此SocketChannelHandler**](http://www.koders.com/java/fid3CD88A21886023A09357484BC6E96F4246D5FC06.aspx?s=SocketChannel+read+#L8)中找到一些线索，`readFromChannel()`您可能感兴趣的函数在哪里。

```
 public void readFromChannel() {
        try {
                   [...]
                   if (readBuffer != null) {
                readBuffer.flip();
                receivingBroker.broker(readBuffer, false);
                if (readBuffer != null) {
                    readBuffer.clear();
                    readBuffer = null;
                }
            }
            if (readBuffer == null || !readBuffer.hasRemaining()) {
                getThread().removeInterestOp(this, SelectionKey.OP_READ);
                getThread().addInterestOp(this, SelectionKey.OP_WRITE);
            }
            if (receivingBroker.isClosed()) {
                if (getChannelListener() != null) {
                    getChannelListener().readFinished(this);
                }
            }
         } catch (Exception e) {
              e.printStackTrace();
         }
         } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T14:28:37.703

当您使用 NIO 接受连接时，您可以获取套接字并设置相应的输入/输出缓冲区大小。

```
socketChannel.socket().setReceiveBufferSize(512);
socketChannel.socket().setSendBufferSize(16); 
```

由于 NIO 大量使用操作系统的网络堆栈，这只是一个提示。[所有这些实际上都在Socket JavaDoc](http://java.sun.com/javase/6/docs/api/java/net/Socket.html#setReceiveBufferSize(int))中有很好的记录

# macos - Mac 上的网络发现

> ID：544926
> 
> 赞同：8
> 
> 时间：2009-02-13T06:33:25.157
> 
> 标签：macos, networking

是否有 Mac/Unix 命令可以让您根据机器/IP 地址查看本地网络？如果 Mac 上有基于 gui 的东西，那就太好了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-13T06:47:01.677

`ping`广播地址（广播地址作为输出的一部分打印到`ifconfig en0`）

回答的主机在您的本地网络上。（您也可以尝试`arp -a`，但这只会跟踪最近联系的主持人，因此您可能希望在广播后运行它。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T23:20:35.057

有一个名为[Bonjour Browser](http://www.macupdate.com/info.php/id/13388 "卓悦浏览器")的程序将列出已在您的本地网络上注册的知名服务。我相信大多数 Mac 默认都有一个或多个注册协议。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T06:48:03.357

可靠地做到这一点的唯一方法是使用 ping 扫描和类似技术扫描网络，寻找各种地址上的开放端口等。您可以使用适用于 OS X的[**nmap**](http://nmap.org/download.html)来执行此操作。有关示例，请参见[http://www.netadmintools.com/art406.html 。](http://www.netadmintools.com/art406.html)

**编辑**：为了澄清，正如[diciu](https://stackoverflow.com/questions/544926/network-discovery-on-a-mac/544971#544971)指出的那样，您通常可以 ping 广播地址和/或使用您的 arp 缓存。这可能适用于大多数允许定向广播的家庭网络。

如果没有，那么您需要使用 nmap 之类的工具运行 ping 扫描，以单独检查每个地址是否有可用主机。许多网络发现/扫描工具不仅可以检查 ping，还可以检查侦听端口、SNMP 等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-08T17:48:26.963

在 Tiger (10.4) 时代，每台 Mac 都会在 bonjour 上广播“在线”服务，这使得在网络上查找 Macintoshes 变得轻而易举。唉，没有了……

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-13T06:53:49.507

您可以使用[Nmap](http://nmap.org/)，但这对于您既定的目标来说似乎有点多。

~~OS X 附带[netstat](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man1/netstat.1.html)，或者打开 /Applications/Utilities/Network Utility.app，也许这对你有用？~~

**编辑：**哎呀。netstat 没有按照我的想法做。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-17T19:23:02.573

尝试 OS X 的 IP Scanner 2.5。[http://10base-t.com/](http://10base-t.com/)寻找其他，但这是我为 OS X 找到的唯一真正的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-08T06:42:57.157

您可以在 Mac OS 上使用基于 ARP 数据包的[netdiscover 。](https://github.com/alexxy/netdiscover)它将发送 ARP 请求并扫描响应。

例如，`sudo netdiscover -i en0 -r 10.106.0.0/16`在我的本地网络中运行 netdiscover 命令会带来以下结果：

[![在此处输入图像描述](https://i.stack.imgur.com/bJR7W.png)](https://i.stack.imgur.com/bJR7W.png)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-06T19:33:01.360

愤怒的 IP 扫描器，简单易用 - 带有基本端口扫描的 IP 扫描器。NMap 和 Zenmap 用于大功率扫描。我实际上将两者一起使用，因为 nmap 很容易被某些反向代理盒转移。

# c++ - 从 char* 数组中读取“整数”大小的字节。

> ID：544928
> 
> 赞同：15
> 
> 时间：2009-02-13T06:34:30.410
> 
> 标签：c++, c, endianness

我想从 数组中读取`sizeof(int)`字节。`char*`

a）如果需要检查字节顺序，我们需要担心什么情况？

b）考虑或不考虑字节顺序，您将如何读取前 4 个字节。

**编辑：**我读过的`sizeof(int)`字节需要与一个整数值进行比较。

解决这个问题的最佳方法是什么

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-13T06:47:26.387

你的意思是这样的吗？：

```
char* a;
int i;
memcpy(&i, a, sizeof(i)); 
```

如果数据源来自不同的平台（如设备），您只需要担心字节顺序。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-13T07:10:12.837

a) 如果数据是在大端机器上创建并在小端机器上处理的，您只需要担心“字节顺序”（即字节交换），反之亦然。发生这种情况的方式有很多，但这里有几个例子。

1.  您通过套接字在 Windows 机器上接收数据。Windows 采用小端架构，而网络数据“假定”为大端格式。
2.  您处理在具有不同“字节序”的系统上创建的数据文件。

在任何一种情况下，您都需要对所有大于 1 字节的数字进行字节交换，例如，shorts、ints、longs、doubles 等。但是，如果您总是处理来自同一平台的数据，则使用 endian问题是无关紧要的。

b）根据您的问题，听起来您有一个 char 指针，并且想要将前 4 个字节提取为 int，然后处理任何字节序问题。要进行提取，请使用以下命令：

```
int n = *(reinterpret_cast<int *>(myArray)); // where myArray is your data 
```

显然，这假设 myArray 不是空指针；否则，由于它取消引用指针，这将崩溃，因此请采用良好的防御性编程方案。

要在 Windows 上交换字节，您可以使用 winsock2.h 中定义的 ntohs()/ntohl() 和/或 htons()/htonl() 函数。或者您可以在 C++ 中编写一些简单的例程来执行此操作，例如：

```
inline unsigned short swap_16bit(unsigned short us)
{
    return (unsigned short)(((us & 0xFF00) >> 8) |
                            ((us & 0x00FF) << 8));
}

inline unsigned long swap_32bit(unsigned long ul)
{
    return (unsigned long)(((ul & 0xFF000000) >> 24) |
                           ((ul & 0x00FF0000) >>  8) |
                           ((ul & 0x0000FF00) <<  8) |
                           ((ul & 0x000000FF) << 24));
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-13T11:08:31.080

怎么样

```
int int_from_bytes(const char * bytes, _Bool reverse)
{
    if(!reverse)
        return *(int *)(void *)bytes;

    char tmp[sizeof(int)];

    for(size_t i = sizeof(tmp); i--; ++bytes)
        tmp[i] = *bytes;

    return *(int *)(void *)tmp;
} 
```

你会这样使用它：

```
int i = int_from_bytes(bytes, SYSTEM_ENDIANNESS != ARRAY_ENDIANNESS); 
```

* * *

如果您在一个系统上的转换`void *`可能`int *`会导致对齐冲突，您可以使用

```
int int_from_bytes(const char * bytes, _Bool reverse)
{
    int tmp;

    if(reverse)
    {
        for(size_t i = sizeof(tmp); i--; ++bytes)
            ((char *)&tmp)[i] = *bytes;
    }
    else memcpy(&tmp, bytes, sizeof(tmp));

    return tmp;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-13T06:45:33.927

取决于你想如何阅读它们，我觉得你想将 4 个字节转换为一个整数，通过网络流数据这样做通常会以这样的方式结束：

```
int foo = *(int*)(stream+offset_in_stream); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-13T07:10:59.060

解决此问题的简单方法是确保生成字节的任何内容都以一致的字节顺序进行。通常，各种 TCP/IP 东西使用的“网络字节顺序”是最好的：库例程**htonl**和**ntohl**可以很好地处理这个问题，而且它们通常都得到了很好的优化。

但是，如果没有使用网络字节顺序，您可能需要以其他方式执行操作。您需要知道两件事：整数的大小和字节顺序。一旦知道了这一点，您就知道要提取多少字节以及以何种顺序将它们组合成一个 int。

假设 sizeof(int) 是正确的字节数的一些示例代码：

```
#include <limits.h>

int bytes_to_int_big_endian(const char *bytes)
{
    int i;
    int result;

    result = 0;
    for (i = 0; i < sizeof(int); ++i)
        result = (result << CHAR_BIT) + bytes[i];
    return result;
}

int bytes_to_int_little_endian(const char *bytes)
{
    int i;
    int result;

    result = 0;
    for (i = 0; i < sizeof(int); ++i)
        result += bytes[i] << (i * CHAR_BIT);
    return result;
}

#ifdef TEST

#include <stdio.h>

int main(void)
{
    const int correct = 0x01020304;
    const char little[] = "\x04\x03\x02\x01";
    const char big[] = "\x01\x02\x03\x04";

    printf("correct: %0x\n", correct);
    printf("from big-endian: %0x\n", bytes_to_int_big_endian(big));
    printf("from-little-endian: %0x\n", bytes_to_int_little_endian(little));
    return 0;
}

#endif 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-13T06:48:50.890

只需使用一个在 sizeof(int) 块中移动数组的 for 循环。
使用该函数`ntohl`（在 header 中找到`<arpa/inet.h>`，至少在 Linux 上）将网络顺序中的字节（网络顺序定义为 big-endian）转换为本地字节顺序。该库函数的实现是为您运行的任何处理器执行正确的网络到主机转换。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-13T06:38:52.397

除非您从不同机器上创建的源（例如网络流）读取字节，否则您不必担心字节顺序。

鉴于此，您不能只使用 for 循环吗？

```
void ReadBytes(char * stream) {
    for (int i = 0; i < sizeof(int); i++) {
        char foo = stream[i];
        }
    }
 } 
```

您是否要求比这更复杂的东西？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-13T06:43:47.610

只有当您读取的数据由大于一个字节的数字组成时，您才需要担心字节顺序。
如果您正在读取 sizeof(int) 字节并期望将它们解释为 int 那么字节序会有所不同。本质上，[字节序](http://en.wikipedia.org/wiki/Endian)是机器将超过 1 个字节的序列解释为数值的方式。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-13T07:20:44.247

当您可以比较时，为什么还要阅读？

```
bool AreEqual(int i, char *data)
{
   return memcmp(&i, data, sizeof(int)) == 0;
} 
```

如果您在需要将所有整数转换为某种不变形式时担心字节顺序。htonl 和 ntohl 就是很好的例子。

# javascript - 使用 Javascript 从 HTML 列表框（多选）中的项目生成逗号分隔的字符串

> ID：544936
> 
> 赞同：4
> 
> 时间：2009-02-13T06:36:16.803
> 
> 标签：javascript, html, string, textbox, listbox

因此，如果您有一个 html 列表框，也称为多选，并且您想生成一个逗号分隔的字符串来列出该列表框中的所有值，您可以使用以下示例来做到这一点。list_to_string() js 函数是这里唯一重要的东西。您可以在[http://josh.gourneau.com/sandbox/js/list_to_string.html使用此页面](http://josh.gourneau.com/sandbox/js/list_to_string.html)

```
<html>
<head>
    <script>
    function list_to_string()
    {
        var list = document.getElementById('list');
        var chkBox = document.getElementById('chk');
        var str = document.getElementById('str');
        textstring = "";
        for(var i = 0; i < list.options.length; ++i){
            comma = ",";
            if (i == (list.options.length)-1){
                comma = "";
            }
            textstring = textstring + list[i].value + comma;
            str.value = textstring;
        }

    }
    </script>
</head>
<body>
    <form>
        <select name="list" id="list" size="3" multiple="multiple">
            <option value="India">India</option>
            <option value="US">US</option>
            <option value="Germany">Germany</option>
        </select>
        <input type="text" id="str" name="str" />
        <br /><br />
        <input type="button" id="chk" value="make a string!" name="chk" onclick="list_to_string();"/>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T07:20:15.167

字符串连接在 IE 上非常慢，请改用数组：

```
function listBoxToString(listBox,all) {
    if (typeof listBox === "string") {
        listBox = document.getElementById(listBox);
    }
    if (!(listBox || listBox.options)) {
        throw Error("No options");
    }
    var options=[],opt;
    for (var i=0, l=listBox.options.length; i < l; ++i) {
        opt = listBox.options[i];
        if (all || opt.selected ) {
            options.push(opt.value);
        }
    }
    return options.join(",");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T07:19:20.787

你可以使用 array.join(','); 从数组中创建一个逗号分隔的列表。

像这样，只有更好：

```
var list_to_string = function() {
    var opts = document.getElementById('list').options;
    var i = 0, len = opts.length, a = [];
    for (i; i<len; i++) {
        a.push(opts[i].value);
    }
    document.getElementById('str').value = a.join(',');
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-01T12:56:31.240

这也可以通过使用`Request.Form(control.UniqueID)`拉取已经存在于多选列表框的逗号分隔值来简单地完成。

# c# - 以编程方式重新加载 C# 项目

> ID：544940
> 
> 赞同：1
> 
> 时间：2009-02-13T06:37:04.053
> 
> 标签：c#, visual-studio-2008, msbuild

是否可以以编程方式重新加载 C# 项目？在我之前的一个[问题](https://stackoverflow.com/questions/510295/auto-include-files-in-a-c-project)中，我需要将所有 CS 文件添加到特定文件夹中，现在虽然这可行，但我发现我必须每次都重新加载项目，以便它可以注册添加的新文件。

所以现在我需要一种在项目生成后自动重新加载的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T06:55:49.127

我假设，当您第一次输出所有 DAL 文件时，您还创建了一个扩展名为 .csproj 的文件，其中列出了您刚刚添加到文件夹中的所有文件。

***如果我上面的假设是正确的*：** 当您想添加更多文件时，您可以从您的 c# 代码中以编程方式编辑相同的 .csproj 文件。然后，Visual Studio 将强制项目重新加载，说它已经在环境之外发生了变化。

***如果我上面的假设是错误*** 的：您可以创建 .csproj 文件，它应该简单直接。

我不确定我的问题是否正确。

# sql - 编程基础

> ID：544942
> 
> 赞同：-1
> 
> 时间：2009-02-13T06:37:42.697
> 
> 标签：sql, sas

有人会建议我开始学习编程基础的最佳方法吗？我将参与涉及数据库的 SQL 和 SAS 相关技术。

请指教

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T14:35:34.997

SQL 是一个更容易处理的问题。您可以下载一个小型数据库（mysql 或 oracle express）并开始工作。测试、玩耍和阅读，直到你掌握了窍门。有很多文章可以提供指导。只是谷歌。

另一方面，SAS 有点困难。除非您的雇主有副本，或者您从大学或 SAS 购买用户副本，否则您无法获得该软件。我建议从 SAS 上一堂课。他们为初学者提供 SAS Essentials 1。一流的，不便宜。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T06:42:53.213

我能给你的最好建议是购买有关该主题的书籍，也许可以尝试在您所在地区找到可以学习或与之合作以获取一些知识的人。否则，请查找与 SQL 和 SAS 相关的文章和博客。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T06:44:28.297

我对学习编程的最佳建议：选择一个项目并开始工作。当您尝试使用它们时，事情会变得更有意义。你甚至不必完成。不要担心最终的结果。您将在整个过程中学习。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T18:04:28.857

sql和sas都不适合学习编程基础，因为它们不是典型的编程语言。学习 C# 或 Java 进行系统开发，或学习 Python 或 Ruby 编写脚本。大多数本科编程课程还将包括某种函数式编程语言。

一旦掌握了一些基础知识，就可以在很短的时间内学会 sql 本身。在我上数据库系统的课上，教授只讲了两堂关于 sql 的一小时讲座。

sas 有一个陡峭的学习曲线，因为它是一个系统，而不是一种语言。在语言方面，实际上，有人可能会说它有30种或更多不同的“语言”。

# c++ - 跨平台构建库而不运行所有平台

> ID：544946
> 
> 赞同：2
> 
> 时间：2009-02-13T06:38:38.777
> 
> 标签：c++, build, cross-platform, makefile

我有一小段代码可用作大型图形应用程序的插件。开发平台是带有 c++ 代码的 Qt。我已经设法分别为 linux、MacOS 和 Windows 构建了一个 .so、.dylib 和 .dll，但要做到这一点，我必须有一台运行每个操作系统的机器（在我的情况下，本机运行 linux [ubuntu] gcc，以及虚拟机中的 Windows MinGW 和 MacOS XCode gcc）。

有没有办法从一个平台为所有 3 个平台构建？不久前，我对这个问题大发雷霆，迄今为止的研究表明，这并不容易（或可行）完成。代码只需要链接到定义插件 API 的单个标头，并且是从一个相当基本的 Makefile 构建的（目前每个平台都有小的变化）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T07:57:24.097

你应该看看交叉编译。

您基本上构建了一个编译器（在您当前的平台上）将为您所需的平台输出二进制文件。

试试[这个](http://silmor.de/29)关于在 linux、windows、QT 上做的链接

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-10T04:55:44.427

迟到总比没有好，我刚刚遇到了[IMCROSS](http://www.sandroid.org/imcross/)

看起来很有前途！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T06:48:21.797

对于 Linux，例如使用 VMWare 设置甚至下载虚拟机​​相当容易。让 OSX 在 VMWare 上运行有点棘手但可能。

运行 VMWare 并在本地驱动器上共享目录，您甚至可以使用完全相同的文件为不同的平台进行编译。

OSX 有一个交叉编译器，但我不相信它的质量很好。

# c# - 寻找从 100% web 开发到 winforms 的人的反馈

> ID：544965
> 
> 赞同：2
> 
> 时间：2009-02-13T06:45:37.310
> 
> 标签：c#, .net, asp.net, vb.net, winforms

在我的整个开发生涯中，我一直是一名 Web 开发人员。微软几乎 100% 专注于整个时间。自测试版以来，我一直在使用 .Net，包括 C# 和 VB.Net。我现在发现自己有机会开始使用 3.5 框架在 C# 中进行一些 WinForms 开发。与任何新事物一样，我对摆在我面前的学习机会感到兴奋。

我很好奇是否有人有任何关于在 .Net 世界中从 Web 开发过渡到 winform 的建议书籍、文章、反馈等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T06:51:33.553

我认为不言而喻，范式是非常不同的。我真的很喜欢 C#，因为编写出色的 Windows 软件是多么容易。

首先进入 IDE 并创建一个真实但很小的项目。我的第一个 C# 项目之一是轻量级预算程序。这使我进入了 C# 的许多领域，从 XML 处理到自定义窗口控件，再到调试等等。

经验是最好的老师。花时间查看函数列表，并仔细阅读文档。了解构成 .NET 的数千个类中的内容。

读书固然不错，但亲自动手（结合一本好书）要有效得多。

设定一个目标并为之奋斗，您将毫无问题地学习它。不要害怕尝试和冒险——它可以帮助你学习系统。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T07:06:07.963

如果您从 Web 迁移到 Windows，那么这两种环境之间存在一些显着差异。有些好有些坏。如果您基于 .Net 并迁移到 3.5，请考虑 WPF，因为它是目前转换 Web 开发人员的两全其美。

我确实知道 Web 开发人员在进行交叉时所犯的一些常见错误。它们将包括：

*   在每个表单和每个数据库调用上打开数据库连接。（在 Windows 中）
*   Windows 中没有 ViewState 概念或 Stateless 概念

我确信还有一些可以添加，但现在我想不出一个确切的列表。

我确实同意 gahooa，看看做一个小项目并尽可能多地阅读这个主题。像以前从未发展过一样接近它，多年来获得的技能将在需要时自动发挥作用。

# javascript - 用于 JavaScript/VBScript 的 Visual Studio 项目模板？

> ID：544967
> 
> 赞同：15
> 
> 时间：2009-02-13T06:45:49.073
> 
> 标签：javascript, visual-studio, vbscript

有没有人幸运地找到了适用于 JavaScript 和/或 VBScript 的 Visual Studio 项目模板？我想使用 VS 作为我的脚本 IDE，但对缺乏集成感到沮丧。

我希望其他人和我一样沮丧并且已经想出了解决方案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-16T23:43:52.287

1.  文件->新建->新建网站（Shift-Alt-N）。
2.  选择“空网站”（忽略其他控件）
3.  右键单击解决方案资源管理器，选择“添加新项目”
4.  选择 HTMLPage（将其命名为 index.html）。
5.  右键单击解决方案探索，选择“添加新项目；
6.  选择 jscript 文件。

如果这不是你要找的，你能澄清一下吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-25T05:05:34.837

VisualStudio 2008 sp1 对javascript 支持有了很大改进。它并不完美，但它在格式化、语法高亮和智能感知方面做得很好。有一些东西会很好，比如自动创建文档，但在大多数情况下，它的工作原理与任何其他 js“ide”一样好。

有些文章...

[http://weblogs.asp.net/scottgu/archive/2007/06/21/vs-2008-javascript-intellisense.aspx](http://weblogs.asp.net/scottgu/archive/2007/06/21/vs-2008-javascript-intellisense.aspx) [http://www.codeproject.com/KB/dotnet/vs2008JSIntellisense.aspx](http://www.codeproject.com/KB/dotnet/vs2008JSIntellisense.aspx) [http:// blogs.ipona.com/james/archive/2009/01/14/jquery-1.3-and-visual-studio-2008-intellisense.aspx](http://blogs.ipona.com/james/archive/2009/01/14/jquery-1.3-and-visual-studio-2008-intellisense.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T05:15:30.070

除了 jayrdub 的回应之外，VBScript 智能感知和格式化最后一次在 Visual Studio 2005 中得到正式支持。但后来应用户社区的需求，它又被重新添加到 Visual Studio 2008 SP1 中。

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=290845](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=290845) [https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=292379](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=292379)

因此，只要您不在 VS 2008 RTM 上，就不会有太大问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-08T13:36:15.010

试试这个： http: [//krestenm.blogspot.com/2007/12/vbscript-projects-in-visual-studio2.html](http://krestenm.blogspot.com/2007/12/vbscript-projects-in-visual-studio2.html)

# c# - 从 C# 应用程序的文件中加载字体

> ID：544972
> 
> 赞同：23
> 
> 时间：2009-02-13T06:47:13.813
> 
> 标签：c#, .net, winforms, fonts

我希望在 C# 中将字体加载并使用到桌面应用程序。没有在系统上安装字体有可能吗？

这是一种类似[这样](https://stackoverflow.com/questions/107611/how-can-i-temporarily-load-a-font)的问题，但不是来自 DLL。我想从字体文件加载。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-13T07:22:50.013

System.Drawing.dll 中有一个类 System.Drawing.Text.PrivateFontCollection，它可以基于每个应用程序管理字体。

您所做的就是在您的应用程序中维护此集合，并通过 AddFontFile 或 AddMemoryFont 添加字体，然后您将能够使用该字体，就像它已安装在您的系统上一样。

这就像仅为应用程序安装字体一样。一旦进程终止，字体将被卸载。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-12-20T10:50:14.120

[从磁盘、流或字节数组加载字体](https://web.archive.org/web/20170313145219/https://blog.andreloker.de/post/2008/07/03/Load-a-font-from-disk-stream-or-byte-array.aspx)

试试这个...

该博客描述了如何使用 FontCollection 类。

# c# - 除了使用 fullsearch，我如何有效地搜索数据库中的数据

> ID：544974
> 
> 赞同：2
> 
> 时间：2009-02-13T06:47:48.617
> 
> 标签：c#, sql

我想在数据库的某个表或视图中搜索一个句子（单词组合）。我不想使用数据库的全文搜索属性。有没有其他有效的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T06:51:30.433

没有全文搜索那么高效。

基本上它归结为具有*类似衍生品的**位置*，并且由于在大多数情况下都丢弃了索引，因此它变成了一个非常昂贵的查询。

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T06:56:26.833

如果不使用索引，数据库必须执行“全表扫描”。这就像您一次翻一页书以找到所需的内容。

话虽如此，计算机比人类快得多。这实际上取决于您的系统有多少负载。使用 MySQL，我们成功地在潜在客户信息表上实现了一个搜索系统。问题的本质是普通索引（包括全文）无法解决的问题。因此，我们**将其设计**为使用全表扫描来供电。

这涉及使用搜索数据创建尽可能窄的表，并将它们连接到具有相关但非搜索数据的更大表中。

当时（4 年前），可以在 0.06 秒内扫描 100,000 条记录。1,000,000 条记录大约需要 0.6 秒。该系统仍在大量生产中使用，拥有数百万条记录。

如果您的数据需要超过 6 位的记录，您可能需要使用全文索引重新评估，或者对倒排索引进行一些研究。

如果您想了解更多信息，请发表评论。

* * *

**编辑：**搜索表保持尽可能窄。理想情况下，每条记录 50-100 字节。如果您可以使用 ENUMS 和 TINYINT 以另一种方式“映射”到字符串值，那么 ENUMS 和 TINYINT 将非常节省空间。

搜索查询是使用 PHP 类生成的。他们只是：

```
-- DataTable is the big table that holds all of the data
-- SearchTable is the narrow table that holds the bits of searchable data

SELECT 
  MainTable.ID, 
  MainTable.Name, 
  MainTable.Whatever 
FROM 
  MainTable, SearchTable 
WHERE 
  MainTable.ID = SearchTable.ID 
  AND SearchTable.State IN ('PA', 'DE')
  AND SearchTable.Age < 40
  AND SearchTable.Status = 3 
```

本质上，这两个表在主键上连接（快速），过滤是通过 SearchTable 上的全表扫描完成的（非常快）。我们使用的是 MySQL。

我们发现，通过在 MyISAM 表中设置记录格式 == "FIXED"，我们可以将性能提高 3 倍。这意味着没有blob，没有varchars等......

让我知道这是否有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T06:55:51.577

如果您使用的是 JAVA，请查看[Lucene](http://lucene.apache.org/java/docs/)

如果您使用的是 .net，您可以查看[Lucene.net](http://incubator.apache.org/lucene.net/)，它将最大限度地减少搜索查询对数据库的调用。

来自[http://incubator.apache.org/lucene.net/](http://incubator.apache.org/lucene.net/)

> Lucene.Net 是 Java Lucene 搜索引擎到使用 Microsoft .NET Framework 的 C# 和 .NET 平台的源代码、每个类、每个 API 和算法端口。
> 
> Lucene.Net 坚持使用 Lucene 的原始 Java 实现中使用的 API 和类。保留 API 名称和类名称的目的是使 Lucene.Net 具有 C# 语言和 .NET Framework 的外观和感觉。例如，Java 实现中的 Hits.length() 方法现在读取 C# 端口中的 Hits.Length()。
> 
> 除了 API 和类移植到 C# 之外，Java Lucene 的算法也移植到 C# Lucene。这意味着使用 Java Lucene 创建的索引与 C# Lucene 来回兼容；在阅读、写作和更新方面。事实上，可以使用 Java Lucene 和 C# Lucene 进程同时搜索和更新 Lucene 索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T07:32:54.900

您可以将文本分解成单独的单词，将它们放在单独的表中，然后使用它来查找在您的搜索句子中包含所有单词的 PK ID [即，但不一定按正确的顺序]，然后仅搜索这些行为句子。应该避免每次都进行表扫描。

请问您是否需要我进一步解释

# flash - FMS：Flash 动作脚本 3.0：如何获取从 FMS 流式传输的 mp3 文件的比特率

> ID：544986
> 
> 赞同：0
> 
> 时间：2009-02-13T06:53:01.020
> 
> 标签：flash, actionscript-3, mp3, flash-media-server, bitrate

我需要获取在 Flash 动作脚本中作为 netstream 对象流式传输的 mp3 文件的比特率。我正在使用 Flash Media Server 3.2。

我需要比特率来使用以下公式计算 mp3 文件的持续时间：持续时间 = 文件大小（以字节为单位）/比特率

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T12:38:52.033

我不太确定 MP3 流媒体，但在我看来，比特率信息可能作为元数据标头的一部分提供。为什么不尝试定义`onMetaData()`流的方法`client`，看看它包含什么？

**编辑：**替代想法：编写一个简单的服务器端脚本来确定比特率，并与流分开查询此信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T14:18:24.337

您是否尝试过 NetStreamInfo 类（可通过 NetStream.info 访问）？

> **audioBytesPerSecond**
> 
> 指定 NetStream 音频缓冲区以每秒字节数填充的速率。该值计算为最后一秒接收到的音频数据的平滑平均值。
> 
> **播放字节每秒**
> 
> 返回流播放速率，以每秒字节数为单位。播放缓冲区可以包含各种播放列表的内容。此属性提供与当前播放流的比特率非常匹配的播放速率。

看起来里面有很多有用的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T15:07:51.330

问题已解决，问题出在 Flash 播放器上，我使用的是版本 9，版本 10 的 NetStreamInfo 类确实提供了版本 9 中不可用的 mp3 文件的比特率。非常感谢所有帮助人员！ ！

# c# - 使用接口组合的奇怪的接口多态性

> ID：544991
> 
> 赞同：5
> 
> 时间：2009-02-13T06:55:59.390
> 
> 标签：c#, .net, interface, polymorphism, explicit

在我正在处理的项目中，我最终得到了类似以下代码的内容。我认为我被允许这样做真的很奇怪，但现在我开始想知道我最有可能的建筑失误导致我这样做。

我对你的问题是：

*   这到底叫什么？
*   这在现实世界中有什么用途？
*   为什么会有人想要这样做？

这是我的接口：

```
namespace ThisAndThat
{
    public interface ICanDoThis
    {
        string Do();
    }

    public interface ICanDoThat
    {
        string Do();
    }

    public interface ICanDoThisAndThat : ICanDoThis, ICanDoThat
    {
        new string Do();
    }
} 
```

这是我的具体课程：

```
namespace ThisAndThat
{
    public class CanDoThisAndThat : ICanDoThisAndThat
    {
        public string Do()
        {
            return "I Can Do This And That!";
        }

        string ICanDoThis.Do()
        {
            return "I Can Do This!";
        }

        string ICanDoThat.Do()
        {
            return "I Can Do That!";
        }
    }
} 
```

我的及格测试：

```
using Xunit;

namespace ThisAndThat.Tests
{
    public class ThisAndThatTests
    {
        [Fact]
        public void I_Can_Do_This_And_That()
        {
            ICanDoThisAndThat sut = new CanDoThisAndThat();

            Assert.Equal("I Can Do This And That!", sut.Do());
        }

        [Fact]
        public void I_Can_Do_This()
        {
            ICanDoThis sut = new CanDoThisAndThat();

            Assert.Equal("I Can Do This!", sut.Do());
        }

        [Fact]
        public void I_Can_Do_That()
        {
            ICanDoThat sut = new CanDoThisAndThat();

            Assert.Equal("I Can Do That!", sut.Do());
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-13T07:21:45.647

这段代码绝对没有问题（前提是它不会让您的用户感到困惑），而且它不是我熟悉的任何名称的模式。 `CanDoThisAndThat`实现了两个接口，因此客户端可以以任何一种方式使用它。

.NET 允许以这种方式实现接口——称为*显式接口实现*。

显式接口实现在以下情况下很有用：

1.  两个接口具有相同的成员定义
2.  您需要实现一个接口，但不想公开特定成员可用于未使用接口类型声明引用的客户端代码

.NET 框架中案例 2 的示例是`ICollection.SyncLock`. `List<T>`实现`ICollection`但以下代码将无法编译，因为该成员已被故意“隐藏”，因为 BCL 的设计者不再提倡以这种方式锁定集合：

```
List<object> list = new List<object>();

lock (list.SyncRoot) // compiler fails here
{
    // ...
} 
```

这种格式的任何遗留代码仍然可以工作，因为引用是`ICollection`明确的类型：

```
ICollection list = new List<object>();

lock (list.SyncRoot) // no problem
{
    // ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-13T07:13:17.603

每种类型都有一个[*接口映射*](http://msdn.microsoft.com/en-us/library/system.reflection.interfacemapping.aspx)（如果您想通过反射查看它，可以使用[Type.GetInterfaceMap检索它）。](http://msdn.microsoft.com/en-us/library/system.type.getinterfacemap.aspx)这基本上是说，“当接口 Y 上的方法 X 被调用时，这个方法 Z 就是要调用的方法。” 请注意，即使 C# 不支持它，映射目标方法的名称也可能与接口方法名称不同！（我相信，VB 明确支持这一点。）

在您的情况下，您有三个方法，这三个方法中的每一个都对应于所涉及的接口之一中的一个方法。

当编译器通过接口发出对虚拟方法的调用时，生成的 IL 会说“在此对象上调用 IFoo.Bar” - 然后使用接口映射解析 IFoo.Bar。

如果您的签名仅在返回类型上有所不同，或者您正在实现两个恰好具有相同方法名称但应该做不同事情的异构接口，您有时可能需要使用它。但是，只要您*可以避免*它，就去做！它使代码非常混乱。

# jquery - 在执行某事之前要求 jQuery 等待所有图像加载的官方方式

> ID：544993
> 
> 赞同：664
> 
> 时间：2009-02-13T06:56:25.927
> 
> 标签：jquery

在 jQuery 中，当你这样做时：

```
$(function() {
   alert("DOM is loaded, but images not necessarily all loaded");
}); 
```

它等待 DOM 加载并执行您的代码。如果未加载所有图像，则它仍会执行代码。如果我们正在初始化任何 DOM 内容，例如显示或隐藏元素或附加事件，这显然是我们想要的。

假设我想要一些动画，并且在加载所有图像之前我不希望它运行。jQuery中是否有官方方法可以做到这一点？

我最好的方法是使用`<body onload="finished()">`，但我真的不想这样做，除非我必须这样做。

注意：在 Internet Explorer[中的 jQuery 1.3.1 中存在一个错误，](https://stackoverflow.com/questions/477463/jquery-is-waiting-for-images-to-load-before-executing-document-ready)它实际上会等待所有图像加载，然后再执行其中的代码`$function() { }`。因此，如果您使用该平台，您将获得我正在寻找的行为，而不是上述正确行为。

* * *

## 回答 #1

> 赞同：1063
> 
> 时间：2009-02-13T07:03:14.397

使用 jQuery，您可以`$(document).ready()`在加载*DOM*`$(window).on("load", handler)`时执行某些操作，并在加载所有其他内容（例如图像）时执行某些操作。

`jollyrogerNN`如果您有很多JPEG 文件（或其他合适的文件），则可以在以下完整的 HTML 文件中看到不同之处：

```
<html>
    <head>
        <script src="jquery-1.7.1.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                alert ("done");
            });
        </script>
    </head><body>
        Hello
        <img src="jollyroger00.jpg">
        <img src="jollyroger01.jpg">
        // : 100 copies of this in total
        <img src="jollyroger99.jpg">
    </body>
</html> 
```

这样，在加载图像之前会出现警告框，因为此时 DOM 已准备好。如果您随后更改：

```
$(document).ready(function() { 
```

进入：

```
$(window).on("load", function() { 
```

*然后在*加载图像之前不会出现警告框。

因此，要等到整个页面准备好，您可以使用以下内容：

```
$(window).on("load", function() {
    // weave your magic here.
}); 
```

* * *

## 回答 #2

> 赞同：159
> 
> 时间：2011-03-02T05:45:13.493

我写了一个插件，它可以在元素中加载图像时触发回调，或者每个加载的图像触发一次。

它类似于`$(window).load(function() { .. })`，除了它允许您定义任何要检查的选择器。如果您只想知道`#content`（例如）中的所有图像何时加载，这是适合您的插件。

它还支持加载 CSS 中引用的图像，例如`background-image`,`list-style-image`等。

## waitForImages jQuery 插件

*   [GitHub 存储库](https://github.com/alexanderdickson/waitForImages)。
*   [自述文件](https://github.com/alexanderdickson/waitForImages/blob/master/README.md)。
*   [生产来源](https://raw.github.com/alexanderdickson/waitForImages/master/dist/jquery.waitforimages.min.js)。
*   [开发源码](https://raw.github.com/alexanderdickson/waitForImages/master/dist/jquery.waitforimages.js)。

### 示例用法

```
$('selector').waitForImages(function() {
    alert('All images are loaded.');
}); 
```

[jsFiddle 上的示例](http://jsfiddle.net/2sc0rtzL/)。

更多文档可在 GitHub 页面上找到。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2010-02-22T15:13:44.790

`$(window).load()`只会在页面第一次加载时起作用。如果您正在做动态的事情（例如：单击按钮，等待一些新图像加载），这将不起作用。为此，您可以使用我的插件：

[演示](http://www.yankov.us/batchImageLoad/)

[下载](http://www.yankov.us/batchImageLoad/jquery.batchImageLoad.js)

```
/**
 *  Plugin which is applied on a list of img objects and calls
 *  the specified callback function, only when all of them are loaded (or errored).
 *  @author:  H. Yankov (hristo.yankov at gmail dot com)
 *  @version: 1.0.0 (Feb/22/2010)
 *  http://yankov.us
 */

(function($) {
$.fn.batchImageLoad = function(options) {
    var images = $(this);
    var originalTotalImagesCount = images.size();
    var totalImagesCount = originalTotalImagesCount;
    var elementsLoaded = 0;

    // Init
    $.fn.batchImageLoad.defaults = {
        loadingCompleteCallback: null, 
        imageLoadedCallback: null
    }
    var opts = $.extend({}, $.fn.batchImageLoad.defaults, options);

    // Start
    images.each(function() {
        // The image has already been loaded (cached)
        if ($(this)[0].complete) {
            totalImagesCount--;
            if (opts.imageLoadedCallback) opts.imageLoadedCallback(elementsLoaded, originalTotalImagesCount);
        // The image is loading, so attach the listener
        } else {
            $(this).load(function() {
                elementsLoaded++;

                if (opts.imageLoadedCallback) opts.imageLoadedCallback(elementsLoaded, originalTotalImagesCount);

                // An image has been loaded
                if (elementsLoaded >= totalImagesCount)
                    if (opts.loadingCompleteCallback) opts.loadingCompleteCallback();
            });
            $(this).error(function() {
                elementsLoaded++;

                if (opts.imageLoadedCallback) opts.imageLoadedCallback(elementsLoaded, originalTotalImagesCount);

                // The image has errored
                if (elementsLoaded >= totalImagesCount)
                    if (opts.loadingCompleteCallback) opts.loadingCompleteCallback();
            });
        }
    });

    // There are no unloaded images
    if (totalImagesCount <= 0)
        if (opts.loadingCompleteCallback) opts.loadingCompleteCallback();
};
})(jQuery); 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-07-26T20:18:46.060

对于那些想要在`$(window).load`触发后被请求的单个图像的下载完成通知的人，您可以使用图像元素的`load`事件。

例如：

```
// create a dialog box with an embedded image
var $dialog = $("<div><img src='" + img_url + "' /></div>");

// get the image element (as a jQuery object)
var $imgElement = $dialog.find("img");

// wait for the image to load 
$imgElement.load(function() {
    alert("The image has loaded; width: " + $imgElement.width() + "px");
}); 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2016-10-23T21:17:19.243

到目前为止，没有一个答案给出了似乎是最简单的解决方案。

```
$('#image_id').load(
  function () {
    //code here
}); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-11-14T13:15:40.733

我建议使用`imagesLoaded.js`javascript 库。

### 为什么不使用 jQuery 的`$(window).load()`？

正如[https://stackoverflow.com/questions/26927575/why-use-imagesloaded-javascript-library-versus-jquerys-window-load/26929951](https://stackoverflow.com/questions/26927575/why-use-imagesloaded-javascript-library-versus-jquerys-window-load/26929951)

> 这是范围的问题。imagesLoaded 允许您以一组图像为`$(window).load()`目标，而以所有*资产*为目标——包括所有图像、对象、.js 和 .css 文件，甚至 iframe。最有可能的是，imagesLoaded 将比`$(window).load()`因为它针对的是一组较小的资产而更早地触发。

### 使用 imagesloaded 的其他充分理由

*   [IE8+官方支持](https://stackoverflow.com/questions/26732085/imagesloaded-javascript-library-what-is-the-browser-device-support)
*   许可证：麻省理工学院许可证
*   依赖：无
*   重量（缩小和压缩）：7kb 缩小（轻！）
*   下载生成器（有助于减轻重量）：不需要，已经很小了
*   在 Github 上：是的
*   社区和贡献者：相当大，4000 多个成员，虽然只有 13 个贡献者
*   历史和贡献：相对较旧（自 2010 年以来）稳定但仍然活跃的项目

### 资源

*   github上的项目：[https ://github.com/desandro/imagesloaded](https://github.com/desandro/imagesloaded)
*   官网：http: [//imagesloaded.desandro.com/](http://imagesloaded.desandro.com/)
*   [检查是否在 JavaScript 中加载了图像（没有错误）](https://stackoverflow.com/questions/1977871/check-if-an-image-is-loaded-no-errors-in-javascript/19959809)
*   [https://stackoverflow.com/questions/26927575/why-use-imagesloaded-javascript-library-versus-jquerys-window-load](https://stackoverflow.com/questions/26927575/why-use-imagesloaded-javascript-library-versus-jquerys-window-load)
*   [imagesloaded javascript 库：浏览器和设备支持是什么？](https://stackoverflow.com/questions/26732085/imagesloaded-javascript-library-what-is-the-browser-device-support)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-06-02T19:36:31.133

有了 jQuery，我有了这个......

```
$(function() {
    var $img = $('img'),
        totalImg = $img.length;

    var waitImgDone = function() {
        totalImg--;
        if (!totalImg) alert("Images loaded!");
    };

    $('img').each(function() {
        $(this)
            .load(waitImgDone)
            .error(waitImgDone);
    });
}); 
```

演示：http: [//jsfiddle.net/molokoloco/NWjDb/](http://jsfiddle.net/molokoloco/NWjDb/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-04-01T19:25:31.543

这样，您可以在加载正文或任何其他容器（取决于您的选择）内的所有图像时执行操作。纯 JQUERY，无需插件。

```
var counter = 0;
var size = $('img').length;

$("img").load(function() { // many or just one image(w) inside body or any other container
    counter += 1;
    counter === size && $('body').css('background-color', '#fffaaa'); // any action
}).each(function() {
  this.complete && $(this).load();        
}); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-10-20T03:52:53.633

使用 imagesLoaded PACKAGED v3.1.8（最小化时为 6.8 Kb）。它相对较旧（自 2010 年以来）但仍然是活跃的项目。

你可以在 github 上找到它： [https ://github.com/desandro/imagesloaded](https://github.com/desandro/imagesloaded)

他们的官方网站：http: [//imagesloaded.desandro.com/](http://imagesloaded.desandro.com/)

为什么它比使用更好：

```
$(window).load() 
```

因为您可能希望动态加载图像，如下所示：[jsfiddle](http://jsfiddle.net/mynewbox/uq4rq6qs/)

```
$('#button').click(function(){
    $('#image').attr('src', '...');
}); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-06-29T11:34:52.597

我的解决方案类似于[molokoloco](https://stackoverflow.com/users/174449/molokoloco)。写成 jQuery 函数：

```
$.fn.waitForImages = function (callback) {
    var $img = $('img', this),
        totalImg = $img.length;

    var waitImgLoad = function () {
        totalImg--;
        if (!totalImg) {
            callback();
        }
    };

    $img.each(function () {
        if (this.complete) { 
            waitImgLoad();
        }
    })

    $img.load(waitImgLoad)
        .error(waitImgLoad);
}; 
```

例子：

```
<div>
    <img src="img1.png"/>
    <img src="img2.png"/>
</div>
<script>
    $('div').waitForImages(function () {
        console.log('img loaded');
    });
</script> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-12-14T18:08:50.503

我找到了这个解决方案：@Luca Matteis 这里：[https ://www.examplefiles.net/cs/508021](https://www.examplefiles.net/cs/508021)

但是我稍微编辑了一下，如图：

```
function showImage(el){
    $(el).removeClass('hidden');
    $(el).addClass('show');

    $(el).prev().removeClass('show');
    $(el).prev().addClass('hidden');
}

<img src="temp_image.png" />
<img class="hidden" src="blah.png" onload="showImage(this);"/> 
```**************