# StackOverflow 问答 000431000-000431999

# c - 是否有适用于 Windows 的开源 C 可视化调试器？

> ID：431000
> 
> 赞同：6
> 
> 时间：2009-01-10T14:13:11.613
> 
> 标签：c, windows, debugging

是否有适用于 Windows 的开源 C 可视化调试器？我听说过 Visual C++ express 免费版，但它有可视化调试器吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-10T14:15:44.370

它不是开源的（但它真的需要吗？）[Visual C++ 2008 Express Edition](http://www.microsoft.com/express/vc/)是一个带有集成调试器的 IDE。

您可以创建 C++ 项目、删除 .cpp 文件并创建/包含您的 .c 文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-10T14:37:01.550

[Eclipse CDT](http://www.eclipse.org/cdt/)是一个不错的选择。它还具有一些漂亮的功能，例如重构和预处理器宏浏览器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-10T19:17:28.020

我发现声称[DDD 调试器将在](http://www.gnu.org/software/ddd/)[Cygwin](http://www.cygwin.com/)下的 Windows 上运行。我已经使用了很多 DDD 并且喜欢它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T08:53:50.133

我将[Insight](http://sources.redhat.com/insight/)与 mingw (gcc) 结合使用，它是 GDB 的图形前端。

您还可以使用具有集成调试器接口的[Code::Blocks （我只使用 gcc/gdb 尝试过，但它应该可以与其他编译器/调试器一起使用）。](http://www.codeblocks.org/)

如果您不介意它们不是开源的（但只是免费使用），您可以查看基于[lcc](http://www.cs.princeton.edu/software/lcc/)编译器的“ [Pelles C](http://www.smorgasbordet.com/pellesc/index.htm) ”（用于 Windows 和 Windows Mobile）和“ [lcc-win32 ”。](http://www.cs.virginia.edu/~lcc-win32/)

当然，微软已经推荐的[Visual C++ Express](http://www.microsoft.com/express/vc/)将在 Windows 上完美运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-10T14:15:27.020

查看[CodeLite](http://codelite.org/) IDE。我可以附加到 gdb debbager 并为其提供 GUI。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T19:25:57.097

Visual Studio 是 Windows 开发的标准。对于这个平台（或任何其他平台），我从未见过更好的 IDE。

如果在 IDE 中集成了调试器。试试看 - 你可能会喜欢它。

# windows-server-2008 - MSDN 许可？

> ID：431005
> 
> 赞同：4
> 
> 时间：2009-01-10T14:17:48.170
> 
> 标签：windows-server-2008

一个简单的问题，但我在 MSDN 订阅者网站上找不到答案：作为 MSDN 专业订阅者，我可以在多个 VM 中同时安装相同的 Windows 2008 副本吗？

MSDN 密钥声明它们可以用于“多次激活”，但它们没有说明这些是顺序的还是并发的。我似乎记得 Windows 2008 Enterprise 有自己的“您可以在 VM 中运行多个实例”的术语。我没记错吗，这是否适用于 MSDN 订阅？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T15:00:15.153

我相信每个密钥都分配了 10 次激活，而不考虑安装的并发性或顺序。如果 10 次激活用完，可以联系 Microsoft 以请求其他密钥。

不久前（我最近没有检查过），msdn 订阅者还可以访问某种“在线礼宾”聊天室。虽然在该聊天室工作的微软人员无法回答技术问题（显然，考虑到将要提出的技术问题的广度），但他们可以回答有关 msdn 订阅以及与软件相关的许可证和规则的实际问题。我问他们是否可以根据协议使用我的 MSDN 许可证密钥来安装操作系统的副本以在@home 工作，例如

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T14:49:03.053

如果我没记错的话，您可以在测试环境而不是生产环境中同时运行 10 次激活。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-10T14:58:01.880

是的 - 只要您根据 msdn 许可证（开发、测试、演示）使用它们。

您的密钥对 10 次激活有效，但您可以要求另一个密钥。

# unit-testing - 大型团队中的公共库

> ID：431007
> 
> 赞同：15
> 
> 时间：2009-01-10T14:20:16.187
> 
> 标签：unit-testing

假设您有五种产品，并且它们都使用公司内部的一个或多个库，由个人开发人员编写。

这听起来很简单，但在实践中，我发现它*很难*维护。

您如何处理以下情况：

1.  开发人员无意中引入了一个错误并破坏了生产中的一切。

2.  每个库都必须成熟，这意味着 API 需要发展，那么如果每个开发人员都需要更新/测试他们的代码，而他们又忙于其他项目，那么如何将更新的版本部署到生产环境中呢？这是资源和时间问题吗？

3.  版本控制、部署和使用。您会将其存储在一个全球位置还是强制每个项目使用**svn:externals**来“绑定”一个库？

我发现很难想出一个好的策略。我自己的宠物理论是这样的：

1.  每个通用库都必须有一套超级彻底的测试，否则它**永远不会**通用，即使这意味着其他人重复了这项工作。重复的未经测试的代码比普通的未经测试的代码更好（你只破坏了一个项目）。

2.  每个通用库都必须有一个专门的维护者（可以在较小的团队中通过一个非常好的测试套件来抵消）。

3.  每个项目都应该检查已知可以使用它的库的版本。这意味着开发人员不必因为公共代码的更新而被迫更新 API 使用。它会是什么。每一段重要的代码都会经过数月和数年的演变。

感谢您对此的想法！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-10T14:39:54.273

您在这里有一组相互竞争的目标。首先，可重用组件库必须足够开放，以便其他项目的人可以轻松地添加（或向其提交组件）。如果这对他们来说太难了，他们就会构建自己的库，而忽略通用库，从而导致大量重复代码和浪费精力。另一方面，您希望对库的开发进行足够的控制，以确保其质量。

我一直处于这个位置。没有简单的答案。但是，有一些启发式方法可以提供帮助。

*   将库视为内部项目。定期释放它。确保它有一个定义明确的发布程序，包括单元测试和质量保证。而且，最重要的是，经常发布，以便库的新提交内容经常出现在产品中。
*   鼓励人们为图书馆做出贡献，而不仅仅是建立自己的内部图书馆。
*   使人们可以轻松地为库做出贡献，并使标准清晰且定义明确（例如，新类必须带有单元测试和文档）。
*   让一两个开发人员负责该库，并（重要！）为他们分配时间来处理它。一个被视为事后考虑的图书馆很快就会*成为*事后的想法。

简而言之，在一个成功的开源库项目之后，为你的内部库的开发和维护建模。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-10T14:26:46.437

我不同意这一点：

> 重复的未经测试的代码比普通的未经测试的代码更好（你只破坏了一个项目）。

如果你们都同样可能通过实现相同的东西来创建错误，那么你们都必须在“重复”库的每个实例中修复潜在的*不同*错误。

似乎编写一次库会更快/更便宜，而不是让多个其他团队编写相同的东西，而是将一些资源分配给测试。

* * *

现在解决你的实际问题：我会模仿我们对真正的第三方库所做的事情。在我们准备好或被迫升级之前，我们会使用特定版本。我不会仅仅因为我可以升级所有东西——这一定是有原因的。

一旦我看到了这个原因（错误修复、新功能等），我就会升级，新库可能会有新错误或重大更改。

因此，您的库项目将根据需要继续开发，而不会影响各个团队，直到他们准备好“升级”。

您可以发布版本或 peg/branches/tag svn 来帮助解决所有这些问题。

如果所有团队都可以访问错误跟踪器，他们也可以在升级之前轻松查看升级候选人中存在哪些已知问题。或者，您可以自己维护该列表。

[@Brian Clapper 在他的回答](https://stackoverflow.com/questions/431007/common-libraries-in-a-large-team#431043)中提供了一些关于如何将您的库作为项目运行的出色指南。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-10T15:11:13.413

我曾经在与您描述的情况类似的情况下工作，只有我公司有几十个软件产品。我在负责维护和升级其他人使用的核心库集的团队工作。

我们处理这些场景如下：

1.  测试核心库。维护重复的代码是一场噩梦。您不仅要维护核心和一份副本。在您公司的源代码控制中的某个地方，有*多个*相同代码的副本。我们有几十种产品，所以这意味着几十份。追捕并杀死他们。

2.  我们有一个由 10-12 名开发人员组成的小型团队，致力于维护核心库及其测试套件。我们还负责接听公司其他 1100 名开发人员关于如何*使用*核心库的电话，所以你可以想象，我们非常忙。

3.  每个其他项目都需要使用它已知可以使用的核心库版本。您可以使用版本控制分支来使用旧产品测试核心库的新版本，以确保您不会破坏有效的代码。如果核心团队做了彻底的测试工作，这应该会非常顺利。唯一一次对我们来说变得非常复杂的时候是核心 API 发生变化，或者当我们彻底搞砸了一些事情时。即使您对核心测试非常有信心，也可以使用分支来测试单个产品。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-10T15:55:33.233

我同意——这很难。在我们的小团队中（咨询.. 不是一家产品公司——这让事情变得更加困难），我们有一个共同的组件，从其他组件中脱颖而出。在这种情况下，成功的秘诀是：

*   让*优秀*的开发人员负责开发组件
*   让*优秀*的开发人员成为维护组件的看门人
*   确保所有升级（有几个）向后兼容
*   确保有一些基本文档（或简单的参考应用程序）解释了如何使用该组件
*   确保所有开发人员都知道该组件存在（！）以及他们可以在哪里找到它（连同代码，如果他们希望查看它）

让开发人员能够审查代码并提出更好的实现或反思建议，但最终的 mod 需要由经验丰富的看门人完成。当组件升级时，旧应用程序不必*升级*。如果我们发布新版本，我们会评估是否要升级，如果升级，我们需要做的就是交换库 - 无需更改代码，除非我们想使用升级中可用的一些新功能。阻力是不可避免的，但有时当它来自对新一代或重构组件有更好想法的优秀开发人员时，它是一种很好的阻力。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-10T14:45:09.723

像对待任何其他产品一样对待库的开发。每个库都有自己的存储库、自己的版本和版本号。该库的编译和官方测试版本也保存在存储库中。记录不同版本的功能和变化。

然后像使用第三方库一样使用这些库。您的产品仅使用已编译库的固定版本。当您真正需要时切换到新版本，并注意这涉及更多测试。将您使用的版本添加到版本控制中。

当您在库中发现错误或需要新功能时，会创建一个新版本或子版本。使用像 svn 这样的版本控制系统可以让这变得简单。当您出于调试目的需要源代码时，将其导出并将其包含在您的项目中，但不要在那里更改它，而是修复库存储库中的问题。

这样，每个团队都可以为库做出贡献，而不会危及其他团队的工作。切换版本是故意的，而不是偶然的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-10T15:44:37.293

为现有库创建一个反腐败（DDD）层......这只不过是一个门面......然后为这个反腐败层编写单元测试......现在即使有人升级/更新库，你也会通过运行单元测试知道是否有问题...

这些测试也可以作为合同的文档......并且不是每个需要使用该库的项目都必须编写这个反腐败层，如果它们使用相同的确切功能的话......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-10T17:26:17.043

“[重复是万恶之源](http://www.google.com/search?&q=%22duplication+is+the+root+of+all+evil%22&btnG=Search)”

听起来你需要：

*   [像Ivy](http://ant.apache.org/ivy/)这样的工件存储库，因此您可以共享库并对其进行版本控制，区分 API 稳定版本和“成熟”版本
*   库的测试
*   测试使用它们的项目
*   一个持续集成系统，以便在引入不兼容或错误时通知项目和原始库开发人员

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-10T14:34:25.003

我认为**一个共享库比 3 个**重复库好（1 个经过测试肯定比 3 个未经测试好）。那是因为当您发现并修复问题时，这会使**整个应用程序区域更加稳固**（并且**开发和维护更加高效**）。

[顺便说一句，这不是我们公司向公众公开我们的.NET 共享库](http://rabdullin.com/shared-libraries/)作为开源的原因之一（除了回馈社区） 。

另外，要编写的代码更少。并且您可以指定一名开发人员对库及其使用实施良好的开发实践（即通过对库消费者内的单元测试实施的代码合同）。这**提高了质量并降低了维护成本**。

我们将共享库作为二进制文件存储在解决方案中。这来自于任何解决方案必须是原子和独立的逻辑要求（这排除了 svn:externals 链接）。

**API 兼容性根本不是问题**。只需**让您的集成服务器重建并重新测试整个产品堆栈**（同时更新所有内部引用并传播更改），您将始终确保所有内部 API 都是可靠的。任何破坏 API 的人都必须修复它或更新其用法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-10T17:49:25.123

> 重复是万恶之源

我认为不受约束的政府是万恶之源:)

我什至建议复制应该是一种选择，我确实受到了很多批评。我明白为什么，但让我把它复杂一点。

假设你有一个相当大的库，它实际上并没有做任何特别的事情——它只是一个实用程序的集合。这个库没有测试 - 根本没有。你只需要它的一个功能。比如说，解析出文件扩展名的东西。

小测验：你是在自己的项目中写了这么小的东西，还是硬着头皮使用未经测试的免费工具集，如果有人破坏了这个功能，这会破坏你的应用程序？

此外，假设您处于编写测试不是文化的一部分的环境中，因为大多数项目都非常紧张并且开发时间很短。

当然，复制大型系统（例如客户注册）将是愚蠢的难以置信。但是，如果替代方案不够安全（没有用于维护通用代码的系统），是否存在在项目中复制相当小的东西更安全的情况。

这样想——这种情况一直都在发生——多个承包商为同一家公司从事不同的项目。他们甚至不知道彼此。

我的论点是这样的：

**如果一个团队不能致力于维护一个可靠的通用代码库，或者如果环境没有给他们足够的时间，最好让他们作为单独的“承包商”工作。**

您仍然需要使用无法复制的大型现有系统。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-14T22:13:32.407

> 复制大型系统 - 例如客户注册 - 将是难以置信的愚蠢，

这就是这些系统发布外部接口的原因。

如果您将库定义为项目之间的共享代码：根据我的经验，这几乎总是很糟糕。一个项目应该是独立的，一个项目的更新不应该影响其他项目。

即使你从库开始，你最终还是会复制代码。想要修复项目 1？它是与库 1.34 一起发布的，因此为了使修补程序尽可能小，您将返回到库 1.34 并修复它。但是，嘿——现在你做了图书馆应该避免的事情——你已经复制了代码。

每个开发人员都使用 Google 来查找代码并将其复制到他的应用程序中。这可能就是他们最初发现 Stack Overflow 的方式。想象一下，如果 Stackoverflow 发布库而不是代码片段会发生什么，您就会了解困扰许多善意库创建者的问题。

图书馆往往是针对特定问题的通用解决方案。通常，通用解决方案比两个特定解决方案的总和更复杂。这意味着你需要一个优秀的程序员来解决一个本来可以由两个白痴解决的问题。对我来说听起来像是一个糟糕的权衡：D

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-10-01T12:17:43.603

我想指出上面建议的解决方案中的一个问题：将库视为具有自己的版本控制方案的内部项目。

***问题***

如果您的公司有多个产品（假设两个团队 - 两个产品：A、B），那么每个产品都有自己的发布时间表。举个例子：团队 A 正在开发产品 A v1.6。他们的发布时间表是从现在开始的两周（假设是 10 月 30 日）。B 团队正在开发产品 B v2.4。他们的发布时间表是从现在开始的 1.5 个月 - 11 月 30 日。让我们假设两者都在 acme-commons-1.2-SNAPSHOT 上工作。两者都在根据需要添加对 acme-commons 的更改。在 10 月 30 日之前的几天，B 团队对 acme-commons-1.2-SNAPSHOT 引入了一个错误的更改。团队 A 正在进入压力模式，因为他们在代码冻结前 1 天发现了错误。

这种情况表明，将公共库视为第三方库几乎是不可能的。微不足道但有问题的解决方案是让每个团队拥有自己即将更改的版本的副本。例如，产品 A v1.2 将为名为“1.2-A-1.6”的 acme-commons 创建一个分支（和版本）。B 团队还将在 acme-commons 中创建一个名为“1.2-B-2.4”的分支。他们的发展永远不会发生冲突，一旦他们测试了他们的产品，他们就会没有压力。

当然，有人必须将他们的更改合并回原始分支（比如说 master 或 1.2）。

我发现这个解决方案的问题是：

1.  分支膨胀 - 树结构将非常蓬松，并且更难理解更改/合并的流程。
2.  Merges back to 1.2 will probably never happen - Unless a team/developer is dedicated to this library, the chances that Team A or Team B merges their code back to 1.2 branch is slim. They will always stay focused on their tasks, thus creating and using their own branch space. Allocation of a developer/team is expensive, thus not always a viable solution.

I'm still trying to figure this one out, so any thoughts of this matter are welcome

# linq-to-sql - Linq to SQL：每个页面都有一个小的 DataContext 还是全局的更好？

> ID：431008
> 
> 赞同：8
> 
> 时间：2009-01-10T14:20:44.687
> 
> 标签：linq-to-sql

我正在一个 ASP.NET 应用程序中尝试 Linq to SQL，该应用程序使用具有大量外键（100 多个表）的大型数据库。我对 Linq 如何允许您创建所有关系完整的数据上下文，然后创建自动连接表的 Linq 语句印象深刻。但是，这会导致一个问题：如果我提交的 Linq 语句只适用于一个或两个表，那么拥有一个只包含必要表/表的数据上下文会更好吗？在我看来，如果我用数据库中的所有表构建一个数据上下文，它会非常庞大​​，并且每次使用 Linq 都加载它会对性能产生负面影响。我对吗？

评论：我知道仅在需要时创建数据上下文（但仍然感谢您提及它）。问题实际上是关于我是否应该有很多小数据上下文，或者是否可以构建一个大数据上下文。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-10T15:33:02.967

每组**连接**的表应该有一个 DataContext。在大多数应用程序中，这意味着所有内容都有一个 DataContext。如果您碰巧有几组不需要一起修改的表，则可以考虑使用多个 DataContext。如果您甚至**可能**需要跨 DataContexts 进行查询，请不要将它们分开。

DataContext 不仅仅是一组表 - 它是数据网关模式的实现 - 您可以使用返回所需数据的方法填充它，因此您不必将查询硬编码到您的每个角落应用。现在，如果您有多个 DataContext，每页一个，那么您很可能最终不得不在其中的每一个中都粘贴您的通用功能（想想 MyDataContext.GetActiveCustomers()）。这将是可怕的重复。

所以答案是构建很多小的DataContexts 通常是不行的。这仅在您的数据是完全独立的（不同的逻辑或物理数据库）或您将 DataContext 用作简单的 Connection 对象时才可行，这并不意味着要这样做。

但是请注意，DataContexts 应该是短暂的——它们是工作单元模式的实现，因此它们的生命周期应该等于一个逻辑操作（例如加载一组产品或插入新订单）。DataContext 的创建和销毁成本很低，因此不要仅仅因为缓存它们而浪费时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-10T14:25:30.557

这个页面[http://www.albahari.com/nutshell/10linqmyths.aspx](http://www.albahari.com/nutshell/10linqmyths.aspx)（见神话#10）说最好使用短暂的DataContext实例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-10T14:32:44.990

我相信数据上下文非常轻量级，主要是容器。在您查询数据之前，数据实际上并未加载到上下文中。我不认为拥有一个单一的数据上下文是错误的，而只是根据需要（作为一个工作单元）实例化它，而不是一直保留它。这样一来，您就没有可能会继续变得越来越大的长寿对象。

如果您的表可以分成相关的表组，您可能需要考虑为每个组设置单独的数据上下文。我不确定 LINQ 将如何处理使用来自多个上下文的数据的查询，但只要表位于同一台服务器上，它似乎就应该工作。如果您确实将事情分解为多个上下文并且有需要来自多个表的查询，则必须检查这一点。

通常，我使用单个上下文并根据需要对其进行实例化，但我没有任何数据库与您的数据库一样大。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-22T04:57:29.690

我对我们的数据库进行了测试，该数据库有大约 600 个表。首先，我将它们分成 9 个离散的数据上下文，每个上下文都非常易于管理。然后我编写了一个脚本，在其中一个上选择、更新和删除了几百次（在每次访问之后处理数据上下文，以便 LINQ 被迫为每次访问重新创建它）。

然后我创建了另一个包含所有 600 个表的数据上下文 - 并运行了相同的测试。

结果几乎相同。我的结论是较小的数据上下文没有性能提升。使用来自单个数据上下文的实体当然要容易得多（尽管不在设计器视图中——呸！）。

# design-patterns - 领域驱动设计问题

> ID：431010
> 
> 赞同：4
> 
> 时间：2009-01-10T14:21:53.747
> 
> 标签：design-patterns, oop, dns, domain-driven-design

我想为此寻求推荐的解决方案：我们有一份比赛清单。每场比赛都规定了参赛者必须支付的费用 我们有参赛者 我必须知道有参加比赛的参赛者是否支付了费用。我正在考虑 2 个解决方案，问题是它必须是领域驱动设计中最合适的解决方案。首先是在竞赛中创建字典而不是列表，字典的类型为 <Participator, bool>。第二个可能是创建一个不同的类，它有 2 个字段，一个参与者和 feePaid。在竞争中，我会有一个新类的对象列表。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T15:02:53.930

听起来像是典型的多对多关系。我将使用 Entry 关联类对其进行建模，如下所示：

```
class Participator {
}
class Competition {
    Currency fee
}
class Entry {
    Competition competition
    Participator participator
    Boolean feePaid
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-10T14:47:58.220

我处理这个问题的方式是举办比赛、参与者和注册。参与者将注册比赛，创建注册。注册将包含竞赛 ID、参赛者 ID、指示是否已支付费用的标志以及任何其他注册特定数据（如注册日期）。这将在数​​据库中建模为“连接表”（带有附加数据）。在应用程序方面，参与者将有一个注册列表，每个注册都会有一个关联的参与者和一个比赛。同样，每个比赛都会有一个注册列表。

# c# - 通过IP地址限制访问的最佳方法？

> ID：431013
> 
> 赞同：19
> 
> 时间：2009-01-10T14:23:40.017
> 
> 标签：c#, .net, asp.net, security

对于 ASP.NET C# 应用程序，我们需要根据 IP 地址限制访问。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-10T14:31:48.160

一种方法是使用[HttpModule](http://www.codeproject.com/KB/aspnet/http-module-ip-security.aspx)。

从链接（以防它消失）：

```
/// <summary>
/// HTTP module to restrict access by IP address
/// </summary>

public class SecurityHttpModule : IHttpModule
{
 public SecurityHttpModule() { }

    public void Init(HttpApplication context)
    {
        context.BeginRequest += new EventHandler(Application_BeginRequest);
    }

    private void Application_BeginRequest(object source, EventArgs e)
    {
        HttpContext context = ((HttpApplication)source).Context;
        string ipAddress = context.Request.UserHostAddress;
        if (!IsValidIpAddress(ipAddress))
        {
            context.Response.StatusCode = 403;  // (Forbidden)

        }
    }

    private bool IsValidIpAddress(string ipAddress)
    {
        return (ipAddress == "127.0.0.1");
    }

    public void Dispose() { /* clean up */ }
} 
```

构建 HTTP Module 类后，您需要在 web.config 文件的 httpModules 部分中注册它，如下所示：

```
<configuration>
    <system.web>
        <httpModules>
            <add name="SecurityHttpModule" type="SecurityHttpModule"/>
        </httpModules>
    </system.web>
</configuration> 
```

这会将模块添加到您的 Web 应用程序的 ASP.NET 请求管道中。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-10T14:31:06.647

这是[Microsoft](http://support.microsoft.com/kb/324066)关于如何执行此操作的文章。

* * *

**通过 IP 地址或域名设置文件夹安全性**

Apache 使用 Allow 和 Deny 指令来确定可以访问特定网站或文件夹的站点。但是，Apache 提供了自主访问控制；您必须拒绝所有站点并提供可以访问文件夹的站点或 IP 地址的特定列表，或者允许所有站点并仅拒绝您不想访问的那些站点。例如，如果您使用以下指令，则所有客户端计算机都将被拒绝访问，除非它们被识别为 domain.com 域的一部分：

**拒绝所有**
**来自 .domain.com 的允许**

IIS 的工作方式相同。除列出的客户端外，所有客户端都被明确拒绝或授予访问权限。

**定义特定文件夹或站点的访问控制**

*   以管理员身份登录到 Web 服务器计算机。
*   单击开始，指向设置，然后单击控制面板。
*   双击管理工具，然后双击 Internet 服务管理器。
*   如果要限制对整个站点的访问，请从左窗格中不同服务站点的列表中选择网站。

*   如果您只想限制对特定文件夹的访问，请单击您要控制的文件夹。

*   右键单击网站或文件夹，然后单击“属性”。
*   单击目录安全面板。
*   如果您想限制对一组特定站点的访问但拒绝访问所有其他站点，请单击拒绝访问。
*   如果您希望默认授予所有客户端访问权限但排除特定客户端列表，请单击授予访问权限。
*   要更新“除外”列表中的主机或域列表，请单击“添加”。
*   要将单台计算机添加到列表中，请单击单台计算机，在相应的框中键入 IP 地址，然后单击确定。
*   要在特定地址范围内添加计算机范围，请单击计算机组，在相应的框中键入网络的 IP 地址，键入要配置的网络范围的子网掩码，然后单击确定。
*   要按识别的域名添加计算机，请单击域名，然后在相应的框中键入域名。
*   单击“属性”，键入域名，然后单击“确定”。
*   单击确定，然后单击确定。

**注意**：如果您使用域名限制，服务器必须为每个请求执行反向 DNS 查找以检查主机的注册域名。Microsoft 建议您尽可能使用 IP 地址或网络范围。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-12-24T17:27:09.560

在 IIS 7 中限制 IP 的最佳方法是使用配置文件。

全文：
[http ://boseca.blogspot.com/2010/12/programmatically-addremove-ip-security.html](http://boseca.blogspot.com/2010/12/programmatically-addremove-ip-security.html)

# mysql - MySQL 复制 - 一个网站，许多服务器，不同的大陆

> ID：431025
> 
> 赞同：3
> 
> 时间：2009-01-10T14:30:51.123
> 
> 标签：mysql, replication

考虑一个相当大的网站（2M+ 浏览量/m，大量用户），它有 2 台前端服务器：一台在美国，一台在欧洲。两个专用 URL 将访问者带到一台服务器上，一个是法语，另一个是英语。两个站点共享完全相同的数据。

什么是最具成本效益的解决方案？（我公司使用的数据库：MySQL）

**1/ Amazon EC2（美国）上的单个主服务器，前端服务器上的从属服务器？**

*   优点：没有master-master rep，这意味着没有数据与自动增量冲突和唯一列重复的风险等。

*   缺点：滞后！在欧洲写东西在美国不会有太多的滞后吗？另一个缺点可能是在主人死亡的情况下缺乏快速的肮脏解决方案。那么在与前端相同的服务器上拥有从属呢？

**2/ 两个 Amazon EC2 实例，一个在美国，一个在欧洲，充当主-主复制服务器。在每个前端加上两个奴隶？**

*   Adv：数据的速度和安全性。当然没有负载均衡器，但是做一个 hack 来将 master 切换到另一个似乎是微不足道的。

*   Drwbcks：价格。以及数据库损坏的风险

**3/ 还有其他解决方案吗？**

由于这是我第一次在 2 大洲使用服务器，我非常感谢您向您学习该领域的经验，包括 MySQL 与否，包括 EC2 与否。

谢谢马歇尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T15:27:47.343

像往常一样，我要说的取决于你的应用程序，它如何使用数据库等。你需要问自己：

*   如果您使用的是现成的软件，那么其他人在这种情况下做了什么？
*   应用程序是否需要在整个数据集上运行，或者您可以分区吗？
*   您的应用程序是为处理多主复制而构建的吗（通常意味着使用自动增量 pk）
*   更新/删除冲突的可能性有多大？费用是多少？
*   什么是读：写比率？写作的本质是什么？它们通常是更新还是追加操作？

我假设法国服务器在欧洲，而英语服务器在美国？如果您可以对数据进行分区，以便法语站点使用一个数据库，而英语站点使用另一个数据库，那么您会更好。即使两个站点都访问两个数据库，因为您不必担心冲突。您甚至可以在每个主服务器上运行两个 mysql 实例并为两者进行多主复制。

如果您不能分区，我可能会选择#2，但我会将其中一台机器指定为“真正的”主机并将所有写入发送给它，以帮助避免数据破坏。这种方式很容易在紧要关头切换。

如果您对成本敏感，并且无论如何都要在前端服务器上运行副本，那么只需在前端服务器上运行主数据库即可。你以后总是可以把它拉下来。副本通常比具有相同读取负载的主节点具有更高的 CPU/IO 成本：它们必须以串行方式执行写入，这确实会搞砸事情。

另外，不要为您的数据库使用 m1.small 实例。或者至少关注你的表现。m1.smalls 的供电明显不足，如果您观看`top`，您会注意到您的 CPU 时间的很大一部分被管理程序窃取了。我推荐 c1.medium 的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T07:41:13.947

永远不要使用主-主复制。没有解决冲突的机制。如果您尝试同时写入两个 master（或者在一个 master 赶上您之前写入另一个 master 的更改之前写入一个 master），那么您最终会遇到一个损坏的复制场景。服务不会停止，它们只会越来越远，使和解变得不可能。

如果没有精心设计的监控来检查它是否工作正常，请不要使用 MySQL 复制。不要假设因为您最初已正确配置它，它会继续工作或保持同步。

DO 有一个有据可查、经过充分测试的程序来恢复从站不同步或停止。从头开始安装新的从站有一个类似的记录过程。

如果您关心正确或最新的数据，您的应用程序可能需要足够的智能才能知道从站不同步或停止，并且不应该使用它。您需要从您的监控中获得某种反馈来执行此操作。

如果你有一个奴隶，比如说美国，而你的主人在欧洲，那通常会给你你期望的延迟量，即比它们位于同一位置的延迟大约 150 毫秒。

在 MySQL 中，从属服务器在主服务器完成查询之前不会启动查询，因此它总是会落后于更新所需的时间长度。

此外，slave 是单线程的，因此单个“硬”更新查询将延迟所有后续查询。

如果你在多线程写入负载上努力推动你的主人，假设你的奴隶有相同的硬件，他们不太可能跟上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-11T02:44:41.733

我们正在研究一个类似的场景——在亚马逊东海岸本周两次完全断网之后——这意味着甚至没有在多个区域进行复制，并且使用 RDB 实例让我们保持可用。

但是 DRB 不允许从东到西甚至进入欧洲。

我们现在正在审查东西方甚至欧洲 Master Master 的方法，其中一个 master 仅作为故障转移，通过 dnsmadeeasy 进行故障转移，响应速度非常快。

优点：快速可靠的故障转移，停机时间短，无需复杂的故障转移功能管理。

缺点：一个额外的系统在不使用的情况下运行 - 但与使用 RDB 相比，它并不昂贵

DRB 由 Amazon 很好地管理，包括时间点恢复等——所有这些都因离开它而丢失。但它仅限于一个区域内的复制，并且该区域可以完全切断，这一事实使其成为问题。作为 RDB 备份的替代方案，我们正在寻找 Zmanda 开源工具来处理备份管理。尚未测试，但基于我们所有的故障转移、数据库和硬件，所以这看起来是最简单的，因此也是最有前途的高可用性方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-07T22:49:53.483

这个问题很老，但现在存在解决方案：Galera。它执行 MySQL (InnoDB) 复制，并且也适用于 WAN。[http://codership.com/](http://codership.com/)

# c# - 如何从我的 winform 应用程序运行该数据库备份和恢复脚本？

> ID：431033
> 
> 赞同：0
> 
> 时间：2009-01-10T14:34:16.967
> 
> 标签：c#, sql-server, database, backup, database-restore

我正在开发一个使用 Sqlserver 2005 数据库的小型企业应用程序。

平台：.Net framework 3.5；应用类型：windows应用；语言：C#

问题：

我需要从我的应用程序中获取并恢复备份。我有从 SSME 生成的所需脚本。

如何从我的 winform 应用程序运行该特定脚本（或多个脚本）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T14:37:00.193

您可以像运行查询一样运行这些脚本，只是您不连接到要恢复的数据库，而是连接到 master。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T14:37:46.167

如果运行应用程序的计算机安装了 SQL Server 客户端工具，则可以使用[sqlcmd](http://msdn.microsoft.com/en-us/library/ms170207.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T14:46:48.830

如果您想以编程方式执行此操作，您可以使用[SMO](http://msdn.microsoft.com/en-us/library/cc285859.aspx)

[教程](http://www.geekpedia.com/tutorial180_Backup-and-restore-SQL-databases.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T15:04:53.443

只需使用与数据库的连接（我猜是 ADO 吗？）并通过此连接将纯 TSQL 指令发送到服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T01:46:53.333

对于备份，您可能想要使用 xp_sqlmaint。它具有删除旧备份的便捷功能，并创建了一个不错的日志文件。您可以通过以下方式调用它： EXECUTE master.dbo.xp_sqlmaint N''-S "[ServerName]" [ServerLogonDetails] -D [DatabaseName] -Rpt "[BackupArchive]\BackupLog.txt" [RptExpirationSchedule] -CkDB -BkUpDB “[BackupArchive]”-BkUpMedia DISK [BakExpirationSchedule]''

（用合适的值替换 [方括号]）。

此外，对于备份，您可能需要备份事务日志。类似于： IF DATABASEPROPERTYEX((SELECT db_name(dbid) FROM master..sysprocesses WHERE spid=@@SPID), ''Recovery'') <> ''SIMPLE'' EXECUTE master.dbo.xp_sqlmaint N'' -S " [ServerName]" [ServerLogonDetails] -D [DatabaseName] -Rpt "[BackupArchive]\BackupLog_TRN.txt" [RptExpirationSchedule] -BkUpLog "[BackupArchive]" -BkExt TRN -BkUpMedia DISK [BakExpirationSchedule]''

我建议将您正在使用的实际命令存储在数据库表中（每个命令 1 行），并使用某种模板替换方案来处理可配置的值。这将允许轻松更改命令，而无需部署新代码。

对于还原，您需要终止除内部 sql server 之外的所有连接。基本上取“exec sp_who”的结果和与 dbname 匹配的行，并且状态不是“background”，并且 cmd 不是“SIGNAL HANDLER”、“LOCK MONITOR”、“LAZY WRITER”之一、“LOG WRITER”、“CHECKPOINT SLEEP”对 spid 执行“kill”（例如：ExecuteNonQuery("kill 1283")）。

您需要捕获并忽略来自 KILL 命令的任何异常。你对他们无能为力。如果由于现有连接而无法进行还原，则会引发错误。

终止连接的一个危险是 ADO 的连接池（对于 asp.net 应用程序比 windows 应用程序更多）。ADO 假定从连接池中获取的连接是有效的......并且它对已被终止的连接反应不佳。在该连接上发生的下一个操作将失败。我不记得该错误...您也许可以捕获该特定错误并对其进行处理...也可以使用 3.5 我认为您可以刷新连接池（所以...捕获错误，刷新连接池，打开连接，再次尝试该命令...丑陋但可能可行）。

# apache - Apache (xamp) 和 IIS 不能一起工作

> ID：431041
> 
> 赞同：0
> 
> 时间：2009-01-10T14:38:12.653
> 
> 标签：apache, iis, apache2, xampp

我的 PC (Windows XP SP3) 上安装了 XAMP 1.6.8 和 IIS 5.0。

我无法同时运行它们。如果 IIS 服务正在运行，Apache 会抛出以下错误：

(OS 10048) 每个套接字地址（协议/网络地址/端口）通常只允许使用一次。: make_sock: 无法绑定到地址 0.0.0.0:80 没有可用的监听套接字，正在关闭 无法打开日志 请注意上面的错误或消息，然后按 键退出。24...

Windows 无法在本地计算机上启动 Apache2。有关详细信息，请查看系统事件日志。如果这是一项非 Microsoft 服务，请联系服务供应商，并参阅特定于服务的错误代码 1。

* * *

### 编辑：

Apache 在不同的端口 3128 上运行。而 IIS (asp.net) 通常在不同的端口上运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-10T14:42:10.523

您需要配置 Apache 或 IIS 以侦听不同的端口。

您还可以使用[tcpview](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx)检查哪些应用程序正在使用哪些端口，因为这听起来像您有冲突。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-10T14:56:31.837

“could not bind to address 0.0.0.0:80”意味着，当它启动时，它会尝试绑定到所有可用网络接口上的端口 80。由于 IIS 已经占用了一个（或多个）要绑定的 IP，因此 apache 无法获取任何 IP，因此将失败。

（如果您已将其配置为绑定到所有 IP，我不确定它是否会绑定到任何可用的 IP，但已经使用了一个。）

因此，将 Apache 配置为绑定到不同的端口（如果您只有 1 个 IP 地址），或者绑定到不同的 IP 或 IP 范围。

您可以通过[更改绑定](http://httpd.apache.org/docs/2.0/bind.html)来做到这一点。首先在配置文件（httpd.conf）中找到Listen指令并进行更改。目前它会说`"Listen 80"`（表示所有IP），将其更改为“ `Listen 192.168.0.2:80`”以使其绑定到指定的IP地址。

您可能还必须编辑 IIS 配置以告诉它也只绑定到单个 IP 地址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-24T23:03:46.313

如果你不能击中圆圈中心的箭头，请击中箭头，然后在它周围画一个圆圈。- 我尝试了所有建议，卸载了Skype，没有运行IIS，将apache程序添加到杀毒软件中，仍然没有解决程序

最后我将 apaches 端口从 80 更改为 82 在 httpd.conf 中查找 Listen 80 并更改它

# java - 如何制作全屏java小程序？

> ID：431044
> 
> 赞同：11
> 
> 时间：2009-01-10T14:41:17.670
> 
> 标签：java, applet, fullscreen

我正在用 java 小程序设计一个心理学实验。我必须让我的 java applet 全屏显示。这样做的最佳方法是什么，我该怎么做。

由于我已经 3 年没有使用 java 小程序了（我最后一次使用它是为了完成课程作业 :)）我已经忘记了大部分概念。我用谷歌搜索并找到了该链接： [Dani web](http://www.daniweb.com/forums/thread101963.html)

但是在上面链接中描述的方法中，您必须在小程序中放置一个 JFrame，我不知道该怎么做。

无论我需要一个快速而肮脏的方法，因为我没有太多时间，这就是我在这里问它的原因。

提前感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T14:59:25.623

显而易见的答案是不要使用小程序。编写一个使用 JFrame 或 JWindow 作为其顶级容器的应用程序。将小程序转换为应用程序的工作量并不大。Applet 旨在嵌入到其他东西中，通常是网页。

如果您已经有一个小程序并想要使其全屏显示，那么有两个快速而肮脏的技巧：

1）。如果您知道屏幕分辨率，只需在 HTML 中将小程序参数设置为该大小，然后以全屏模式运行浏览器。

2）。在 appletviewer 中运行 applet，而不是在网页中运行，并最大化 appletviewer 窗口。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-10T17:35:23.453

为什么不直接从小程序中打开一个新框架（通过“start()”方法，或者最好在用户按下“打开”按钮后）并将其设置为最大化？

```
JFrame frame = new JFrame();
//more initialization code here
Dimension dim = Toolkit.getDefaultToolkit().getScreenSize();
frame.setSize(dim.width, dim.height);
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
frame.setVisible(true); 
```

不要忘记：应该从 EDT 创建和打开 JFrame。不能保证在该线程上调用 Applet start()，因此请使用 SwingUtilities.invokeLater()。当然，如果您选择按钮路由，则会在 EDT 上调用按钮侦听器，因此您应该是安全的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-10T15:19:38.267

我想你想使用 WebStart。您可以从浏览器进行部署，但它是一个完整的应用程序。有一些与浏览器相关的安全限制，但是，由于您目前使用的是 Applet，我想我可以假设它们不是问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-19T08:28:01.293

我找到[了一个可以正常工作的解决方案](http://www.java-gaming.org/topics/applet-switching-fullscreen-on-off/20058/view.html)。在 Linux 64 位（Chrome 和 Firefox）和 Windows 7 64 位（Chrome 和 Explorer）中测试

唯一的问题是我的小程序使用了浏览器中的所有空间，当用户关闭全屏模式时，小程序没有缩放到浏览器大小。解决方案是在进入全屏模式之前保持小程序的先前大小，然后在小程序返回正常模式时设置此大小：

```
public void setFullScreen() {   
        if (!this.fullscreen) {
            size = this.getSize();
            if (this.parent == null) {
                this.parent = getParent();
            }
            this.frame = new Frame();
            this.frame.setUndecorated(true);
            this.frame.add(this);
            this.frame.setVisible(true);

            GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
            GraphicsDevice[] devices = ge.getScreenDevices();
            devices[0].setFullScreenWindow(this.frame);
            this.fullscreen = true;
        } else {
            if (this.parent != null) {
                this.parent.add(this);
            }
            if (this.frame != null) {
                this.frame.dispose();
            }
            this.fullscreen = false;
            this.setSize(size);
            this.revalidate();
        }       
        this.requestFocus();
    } 
```

# linux - Linux 设备驱动程序不安全的 FXSAVE/FXRSTOR 错误——任何先例？

> ID：431045
> 
> 赞同：4
> 
> 时间：2009-01-10T14:41:48.623
> 
> 标签：linux, device-driver, device, linux-device-driver, fxsave

有一个令人讨厌的问题暂时难住了我公司的一些工程师试图对其进行调试。

C++ 程序通常在具有 MPI 的多核计算机集群上运行。

它会运行很长时间——也许是几天——然后突然失败。

大多数从事它的工程师已经消除了程序本身存在错误的任何合理可能性，因此他们开始将责任归咎于可能的硬件问题，但我怀疑 Linux 内核模块或设备中一定存在软件问题司机。

值得*怀疑*的是，内核模块或设备驱动程序为了进行一些浮点计算，正在以在 SMP 系统上不安全的方式执行 FXSAVE/FXRSTOR。它可以像对需要可重入的内核例程中的静态缓冲区执行 FXSAVE 一样简单。这将创建一个竞争条件错误，该错误很少会破坏线程的浮点上下文。

在应用程序级别，似乎正在发生的事情是 MXCSR 的一个或多个位（它是 FXSAVE/FXRSTOR 上下文的一部分）突然更改，但没有应用程序代码来更改它。

多年前我在 Windows 上遇到过类似的情况，最终证明是视频驱动程序中的一个错误，因此当应用程序代码被操作系统抢占时，该线程上下文中的一些 MXCSR 位被破坏。

我不是 Linux 内核黑客或设备驱动程序开发方面的专家，但我了解到重入规则已经发生了很大变化；在非 SMP 和 SMP（多核）系统之间；内核版本之间；等等因此出现竞争条件错误的可能性似乎是合理的。

所以我的问题是：**是否有任何已知的 Linux 驱动程序（或内核）错误符合该描述？**

如果他们有类似的症状，我可以引用的任何先例都会有所帮助。在这一点上，很多相关人员（恕我直言）浪费时间思考“好吧，我的代码中没有错误，所以它一定是坏硬件。” 我想让他们超越这一点，并寻找更有可能成为真正原因的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-29T03:04:22.777

您的内核的源代码是可用的，通常是 src.rpm。您可以提取它（以及里面的 .tgz），然后 grep 获取 fxsave asm 指令等的所有内容。如果你发现了什么，我会很惊讶，但谁知道呢？如果您正在运行任何二进制视频驱动程序，那么在没有加载它们的情况下查看问题是否仍然存在。

1.  下载 kernel-2-whatever.src.rpm
2.  mkdir 温度；光盘温度
3.  rpm2cpio ../kernel*rpm | cpio -id
4.  tar xvf linux-*.tgz
5.  grep -ri fxsave *

# api - 在 API 中公开多少底层内容？

> ID：431049
> 
> 赞同：2
> 
> 时间：2009-01-10T14:42:53.317
> 
> 标签：api, encapsulation, abstraction

在设计泛型库的公共 API 时，应该公开多少内部使用的低级内容？一方面，用户不应过于依赖实现细节，过多的低级函数/类可能会使 API 混乱。因此，下意识的反应可能是“无”。另一方面，一些低级功能可能对人们有用，并且公开更多功能可以防止抽象反转（在高级构造之上重新实现低级构造）。

此外，暴露更多的低级细节可以提供性能捷径。例如，假设您有一个查找数组中位数的函数。最不意外的原则是你应该复制数组，这样你的 API 的用户就不必关心它的实现涉及重新排序元素的副作用。在这种情况下，您是否应该注意 medium() 会消耗内存分配并提供另一个绕过分配但会任意重新排序用户输入的函数？

对于要公开多少此类细节，有哪些一般准则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T14:44:59.770

尽可能少。

您公开的细节越多，更改就越有可能破坏消费者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T14:47:19.577

您的 API 不应允许调用者通过破坏内部状态（例如重新排序集合等）来“破坏”任何内容。为了解决这个问题，你暴露的接口应该只在必要时才被读取。

* * *

关于复杂性，我更倾向于简单、基本的方法。我非常努力地不过度设计任何我认为未来需要的东西。

写到今天的要求（也许是明天的），但不能超出。您可以在未来随时扩展。丢掉那些你不能再维护的东西要困难得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T20:24:18.103

我听说过的一种表达方式：公开*what*，而不是*how*。

目标是提供一个有用且丰富的库供客户使用，而不会使他们依赖于库的内部结构。您希望能够更改内部结构，而不会破坏调用者（正如其他人已经指出的那样）。

编写一个好的 API 涉及到一定程度的巧妙的边缘政策。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T15:00:18.523

Unix 的做法是提供机制，而不是策略。只需提供正确的工具来做事（例如，一把刀），但尽量不要预测它们将被如何使用（剥苹果或削铅笔）。

# c# - C# 反射：从 Typed DataSet 中获取 DataRow 的字段

> ID：431050
> 
> 赞同：2
> 
> 时间：2009-01-10T14:44:58.303
> 
> 标签：c#, asp.net, reflection, strongly-typed-dataset, datarow

我目前正在构建一个方法，该方法`DataRow`从类型化的 DataSet 中获取一个类型的对象，然后返回DataRow 中字段的[JSON](http://en.wikipedia.org/wiki/Json)格式的字符串（用于 Web 服务）。

通过使用`System.Reflection`，我正在做这样的事情：

```
public string getJson(DataRow r)
    {
        Type controlType = r.GetType();
        PropertyInfo[] props = controlType.GetProperties();
        foreach (PropertyInfo controlProperty in props)
        {

        }
        return "";
    } 
```

然后在`foreach`语句中，我将迭代每个字段并获取字段名称和值，并将其格式化为 JSON。

* * *

问题是，当迭代`props`（类型`PropertyInfo[]`）时，我得到了我不想被迭代的属性：

[替代文字 http://img88.imageshack.us/img88/2001/datarowreflectionht0.gif](http://img88.imageshack.us/img88/2001/datarowreflectionht0.gif)

从上图中可以看出，我只需要数组`0 - 11`中的字段`props`，因为这些字段是这个特定类型行的“真实字段”。

所以我的问题是，**我怎样才能只获取 Typed DataRow 的字段，而不是其他“元数据”？**

* * *

**[更新解决方案]**

正如[Mehrdad Afshari](https://stackoverflow.com/questions/431050/c-reflection-getting-the-fields-of-a-datarow-from-a-typed-dataset#431058)建议的那样`Reflection`，我使用的是`Table.Columns`数组而不是 using 。

这是完成的功能：

```
public string GetJson(DataRow r)
{
    int index = 0;
    StringBuilder json = new StringBuilder();
    foreach (DataColumn item in r.Table.Columns)
    {
        json.Append(String.Format("\"{0}\" : \"{1}\"", item.ColumnName, r[item.ColumnName].ToString()));
        if (index < r.Table.Columns.Count - 1)
        {
            json.Append(", ");
        }
        index++;
    }
    return "{" + json.ToString() + "}";
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-10T14:48:44.753

为什么不使用`row.Table.Columns`属性而不是反射？

# sql - 在 MYSQL 中生成排名的最佳方法是什么？

> ID：431053
> 
> 赞同：6
> 
> 时间：2009-01-10T14:46:34.057
> 
> 标签：sql, mysql

除了 MYSQL 中的行数据之外，获取行排名的最佳方法是什么？

例如，假设我有一份学生名单，我想在 GPA 上排名。我知道我可以通过 GPA 订购，但是让 MYSQL 在我返回的行数据中返回排名的最快方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T15:00:15.043

这将返回学生的等级、学生 ID 和 GPA。

```
set @rownum := 0;
SELECT @rownum := @rownum + 1 AS rank, student_id, gpa 
    FROM `students` ORDER BY gpa DESC 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-10T14:57:50.087

这将返回排名为`rownum`

```
SELECT @rownum := @rownum + 1 rownum, 
       t.* 
  FROM (SELECT @rownum:=0) r, 
       (SELECT * FROM students ORDER BY gpa DESC) t; 
```

# oracle - Oracle 恢复问题

> ID：431076
> 
> 赞同：1
> 
> 时间：2009-01-10T15:03:46.737
> 
> 标签：oracle, recover

我执行以下命令并发生错误：

```
recover database until time '2009-01-09 12:26';
ORA-00283: recovery session canceled due to errors
ORA-19907: recovery time or SCN does not belong to recovered incarnation; 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T15:26:16.300

[这里](http://ora-19907.ora-code.com/)有一个建议的操作

我不是 Oracle 用户，所以我只能做到这一点。 [只是谷歌搜索代码](http://tinyurl.com/8tc45m)发现了这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T12:43:36.993

你没有说你是在原始的“就地”数据库上还是在其他地方的恢复副本上尝试这种恢复。您的一些选项取决于适用的情况。

为自己指明方向的一件快速事情是启动并挂载数据库，然后发出“recover database until cancel”（如果您在还原过程中还原了控制文件，则可以选择指定“使用备份控制文件”）。然后检查 Oracle 要求您应用的第一个归档日志的详细信息（时间和更改#）。将其与 V$DATABASE 视图中的信息进行比较 - 请记住，您可以在挂载状态下查询 V$ 视图。

# sql - 在 Active Record 中返回列值的更好方法？

> ID：431080
> 
> 赞同：1
> 
> 时间：2009-01-10T15:05:23.800
> 
> 标签：sql, ruby-on-rails, activerecord

快一个，但我想我会问。

有没有比这样更好的方法从模型的列中获取列值？

```
Item.count(:all, :group => 'status').reject! { |i, e| i.blank? }.collect { |i,e| i} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T15:51:46.407

```
Item.find(:all, :select=>:status, :group => 'status', :conditions => "status != ''").collect{|r| r.status} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-10T15:24:56.663

和下面的代码是一样的吗？

```
Item.count(:all, :group => "status", :conditions => "status != ''"} 
```

.. 也许不吧 ..

但是您能否指定更多您想要的标准？即状态为空白？计数为空？

# linux - 在 Linux 设备驱动程序中使用浮点的编码约定是什么？

> ID：431081
> 
> 赞同：11
> 
> 时间：2009-01-10T15:05:28.497
> 
> 标签：linux, floating-point, linux-device-driver, fxsave

这与 [这个问题有关](https://stackoverflow.com/questions/431045/linux-device-driver-unsave-fxsave-fxrstor-bug-any-precedents)。

我不是 Linux 设备驱动程序或内核模块方面的专家，但我一直在阅读 Rubini & Corbet 的“Linux 设备驱动程序”[O'Reilly] 和一些在线资源，但我一直无法找到关于这个具体问题的任何事情。

何时允许内核或驱动程序模块使用浮点寄存器？
如果是这样，谁负责保存和恢复其内容？
（假设 x86-64 架构）

如果我理解正确，每当 KM 运行时，它都在使用已从某个应用程序线程抢占的硬件上下文（或硬件线程或寄存器集——无论您想调用什么）。如果您在 c 中编写 KM，编译器将正确确保通用寄存器正确保存和恢复（就像在应用程序中一样），但浮点寄存器不会自动发生这种情况。就此而言，许多 KM 甚至不能假设处理器具有任何浮点能力。

我猜想使用浮点的KM必须小心保存和恢复浮点状态是否正确？是否有这样做的标准内核函数？

是否在任何地方都说明了此编码约定？
对于非 SMP 驱动程序，它们是否不同？
对于较旧的非抢占式内核和较新的抢占式内核，它们是否不同？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-09-17T08:30:14.077

[Linus 的回答](http://lkml.indiana.edu/hypermail/linux/kernel/0405.3/1620.html)提供了这个非常清晰的引用作为指导：

> 换句话说：规则是你真的不应该在内核中使用 FP。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-10T16:55:12.207

`kernel_fpu_begin()`简短的回答：如果这个用法被/包围，内核代码可以使用浮点`kernel_fpu_end()`。这些函数处理保存和恢复 fpu 上下文。此外，它们调用`preempt_disable()`/ `preempt_enable()`，这意味着这些函数之间的代码中没有休眠、页面错误等。谷歌函数名称以获取更多信息。

> 如果我理解正确，每当 KM 运行时，它都在使用已从某个应用程序线程抢占的硬件上下文（或硬件线程或寄存器集——无论您想调用什么）。

不，内核模块也可以在用户上下文中运行（例如，当用户空间在 KM 提供的设备上调用系统调用时）。然而，它与浮动问题无关。

> 如果您在 c 中编写 KM，编译器将正确确保通用寄存器正确保存和恢复（就像在应用程序中一样），但浮点寄存器不会自动发生这种情况。

那不是因为编译器，而是因为内核上下文切换代码。

# c++ - pthread_join - 多个线程等待

> ID：431082
> 
> 赞同：3
> 
> 时间：2009-01-10T15:06:29.850
> 
> 标签：c++, multithreading, posix

使用 POSIX 线程和 C++，我有一个“插入操作”，一次只能安全地完成一个。

如果我有多个线程等待使用 pthread_join 插入，则在完成时生成一个新线程。他们是否都会一次收到“线程完成”信号并产生多个插入，或者假设首先收到“线程完成”信号的线程将产生一个新线程，阻止其他线程创建新线程。

```
/* --- GLOBAL --- */
pthread_t insertThread;

/* --- DIFFERENT THREADS --- */
// Wait for Current insert to finish
pthread_join(insertThread, NULL); 

// Done start a new one
pthread_create(&insertThread, NULL, Insert, Data); 
```

* * *

感谢您的答复

该程序基本上是一个巨大的哈希表，它通过套接字接收来自客户端的请求。

每个新的客户端连接都会产生一个新线程，然后它可以从中执行多个操作，特别是查找或插入。查找可以并行进行。但是插入需要“重新组合”到一个线程中。您可以说查找操作可以在不为客户端生成新线程的情况下完成，但是它们可能需要一段时间导致服务器锁定，从而丢弃新请求。该设计试图尽可能减少系统调用和线程创建。

但现在我知道我最初认为我应该能够拼凑一些东西的方式并不安全

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T15:26:58.717

来自[pthread_join 上的 opengroup.org](http://opengroup.org/onlinepubs/007908799/xsh/pthread_join.html)：

> 指定同一目标线程的多个同时调用 pthread_join() 的结果未定义。

所以，你真的不应该有几个线程加入你以前的 insertThread。

首先，当你使用 C++ 时，我推荐[boost.thread](http://www.boost.org/doc/libs/1_37_0/doc/html/thread.html)。它们类似于线程的 POSIX 模型，并且也适用于 Windows。它可以帮助您使用 C++，即通过使函数对象更容易使用。

第二，你为什么要开始一个新的线程来插入一个元素，而你总是要等待前一个线程完成才能开始下一个线程？似乎不是多线程的经典使用。

虽然......对此的一种经典解决方案是让一个工作线程从事件队列中获取作业，而其他线程将操作发布到事件队列中。

如果您真的只是想或多或少地保持现在的状态，则必须这样做：

*   创建一个条件变量，例如`insert_finished`.
*   所有想要插入的线程都在条件变量上等待。
*   一旦一个线程完成插入，它就会触发条件变量。
*   由于条件变量需要互斥体，您可以通知*所有*等待的线程，它们都想开始插入，但由于一次只有一个线程可以获取互斥体，所有线程将顺序执行插入。

但是您应该注意不要以过于临时的方式实现同​​步。由于这被称为`insert`，我怀疑您想要操作数据结构，因此您可能希望首先实现线程安全的数据结构，而不是共享数据结构访问和所有客户端之间的同步。我也怀疑会有更多的操作然后只是`insert`，这需要适当的同步......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T15:21:30.647

根据 Single Unix Specifcation：“多个同时调用 pthread_join() 指定同一目标线程的结果是未定义的。”

实现单线程获取任务的“正常方式”是设置一个条件变量（不要忘记相关的互斥锁）：空闲线程在 pthread_cond_wait()（或 pthread_cond_timedwait()）中等待，当线程工作已经完成，它用 pthread_cond_signal() 唤醒一个空闲的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T11:29:11.770

是的，因为大多数人建议最好的方法似乎是让工作线程从队列中读取。下面的一些代码片段

```
 pthread_t       insertThread = NULL;
    pthread_mutex_t insertConditionNewMutex = PTHREAD_MUTEX_INITIALIZER;
    pthread_mutex_t insertConditionDoneMutex    = PTHREAD_MUTEX_INITIALIZER;
    pthread_cond_t  insertConditionNew      = PTHREAD_COND_INITIALIZER;
    pthread_cond_t  insertConditionDone     = PTHREAD_COND_INITIALIZER;

       //Thread for new incoming connection
        void * newBatchInsert()
        {
           for(each Word)
           {
                            //Push It into the queue
                            pthread_mutex_lock(&lexicon[newPendingWord->length - 1]->insertQueueMutex);
                                lexicon[newPendingWord->length - 1]->insertQueue.push(newPendingWord);
                            pthread_mutex_unlock(&lexicon[newPendingWord->length - 1]->insertQueueMutex);

           }

                    //Send signal to worker Thread
                    pthread_mutex_lock(&insertConditionNewMutex);
                        pthread_cond_signal(&insertConditionNew);
                    pthread_mutex_unlock(&insertConditionNewMutex);

                    //Wait Until it's finished
                    pthread_cond_wait(&insertConditionDone, &insertConditionDoneMutex);

        }

            //Worker thread
            void * insertWorker(void *)
            {

                while(1)        
                {

                    pthread_cond_wait(&insertConditionNew, &insertConditionNewMutex);

                    for (int ii = 0; ii < maxWordLength; ++ii)
                    {                   
                            while (!lexicon[ii]->insertQueue.empty())
                            {

                                queueNode * newPendingWord = lexicon[ii]->insertQueue.front();

                                lexicon[ii]->insert(newPendingWord->word);

                                pthread_mutex_lock(&lexicon[ii]->insertQueueMutex);
                                lexicon[ii]->insertQueue.pop();
                                pthread_mutex_unlock(&lexicon[ii]->insertQueueMutex);

                            }

                    }

                    //Send signal that it's done
                    pthread_mutex_lock(&insertConditionDoneMutex);
                        pthread_cond_broadcast(&insertConditionDone);
                    pthread_mutex_unlock(&insertConditionDoneMutex);

                }

            }

            int main(int argc, char * const argv[]) 
            {

                pthread_create(&insertThread, NULL, &insertWorker, NULL);

                lexiconServer = new server(serverPort, (void *) newBatchInsert);

                return 0;
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T16:10:10.567

其他人已经指出这具有未定义的行为。我只想补充一点，完成任务的最简单的方法（只允许一个线程执行部分代码）是使用一个简单的互斥锁 - 您需要执行该代码的线程是互斥的，这就是互斥锁出现的地方它的名字 ：-）

如果您需要在特定线程（如 Java AWT）中运行代码，那么您需要条件变量。但是，您应该三思而后行，这种解决方案是否真的有回报。想象一下，如果您每秒调用 10000 次“插入操作”，您需要多少次上下文切换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-10T16:38:54.440

正如您刚才提到的，您正在使用与插入并行的多个查找的哈希表，我建议您检查是否可以使用并发哈希表。

由于当您同时插入元素时，确切的查找结果是不确定的，因此这样的并发散列映射可能正是您所需要的。不过，我没有在 C++ 中使用并发哈希表，但由于它们在 Java 中可用，您肯定会找到一个在 C++ 中执行此操作的库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T16:56:01.347

我发现的唯一一个支持插入而不锁定新查找的库 - [Sunrise DD](http://www.sunrisetel.net/software/devtools/sunrise-data-dictionary.shtml)（我不确定它是否支持并发插入）

然而，从 Google 的[稀疏散列映射](http://goog-sparsehash.sourceforge.net/)转换后，内存使用量增加了一倍多。查找应该很少发生，所以与其尝试编写我自己的库，它结合了两者的优点，我宁愿在安全地进行更改时锁定表挂起查找。

再次感谢

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-10T17:27:01.660

在我看来，您想将插入序列化到哈希表中。

为此，您需要一个锁 - 而不是产生新线程。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-11T07:49:46.003

从您的描述来看，您每次想要插入某些东西时都在重新创建插入线程，因此看起来效率很低。创建线程的成本不是0。

这个问题的一个更常见的解决方案是产生一个在队列上等待的插入线程（即，当循环为空时，它处于一个休眠的循环中）。然后其他线程将工作项添加到队列中。插入线程按照添加顺序（或根据需要按优先级）选择队列中的项目并执行适当的操作。

您所要做的就是确保对队列的添加受到保护，以便一次只有一个线程可以访问修改实际队列，并且插入线程不会进行忙碌等待，而是在队列中没有任何内容时休眠（见条件变量）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-01T22:25:47.527

理想情况下，您不希望单个进程中有多个线程池，即使它们执行不同的操作。线程的可重用性是一个重要的架构定义，如果使用 C，它会导致在主线程中创建 pthread_join。

当然，对于 C++ 线程池（又名 ThreadFactory），其想法是保持线程原语抽象，因此它可以处理传递给它的任何函数/操作类型。

一个典型的例子是一个网络服务器，它将具有连接池和线程池，它们为连接提供服务，然后进一步处理它们，但是，所有这些都是从一个公共线程池进程派生的。

摘要：避免在主线程以外的任何地方使用 PTHREAD_JOIN。

# delphi - 用于人脸识别和标记的 Delphi 组件

> ID：431086
> 
> 赞同：5
> 
> 时间：2009-01-10T15:10:11.467
> 
> 标签：delphi, image-processing, face-detection, photo-tagging

是否有任何可用于 Delphi（我使用 Delphi 2009）的好的免费或商业组件，可以让我轻松实现人脸检测和照片中人脸的标记（即图形/图像）？

我需要做一些类似于 Google Picasa 的网络相册可以做的事情，但在我的应用程序中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-27T15:42:43.033

您是否看到答案[人脸识别库](https://stackoverflow.com/questions/953714/face-recognition-library)中出现的 SDK 。

来自 nuerotechnology 的那个有一个您可以使用的 activex 组件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-10T23:46:45.753

这就是你想要的

[http://delphimagic.blogspot.com/2011/08/reconocimiento-de-caras-con-delphi.html](http://delphimagic.blogspot.com/2011/08/reconocimiento-de-caras-con-delphi.html)

# php - 使用 Math_Matrix PEAR 库的意外 T_CLONE

> ID：431090
> 
> 赞同：1
> 
> 时间：2009-01-10T15:12:44.440
> 
> 标签：php, matrix, pear

我以前没有使用过 PEAR，所以我可能在做一些愚蠢的事情。我已经安装了 Math_Matrix 库，但是当我包含它时，我得到了一个错误。我的整个代码是这样的：

```
<?php
  $path = '/home/PEAR/Math_Matrix-0.8.0';
  set_include_path(get_include_path() . PATH_SEPARATOR . $path);
  include_once 'Matrix.php';
?> 
```

我得到的错误是这样的：

```
Parse error: syntax error, unexpected T_CLONE, expecting T_STRING in /home/PEAR/Math_Matrix-0.8.0/Matrix.php on line 272 
```

我真的不知道该怎么做。我想我能想到的解释是：

1.  我没有正确安装 Math_Matrix 库（我在一个已经安装了 PEAR 的共享服务器上）或者下载了错误的版本。
2.  在包含 Matrix.php 之前，我应该包含其他内容
3.  我包含了错误的文件（或正确的文件名，但路径错误，不知何故）。

要安装它，我做了以下操作：

```
pear install --alldeps channel://pear.phpunit.de/PHPUnit
pear install --alldeps channel://pear.php.net/Math_Vector-0.6.2
pear install Math_Matrix 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T15:41:21.437

从 [Math_Matrix]( [http://pear.php.net/package/Math_Matrix](http://pear.php.net/package/Math_Matrix)主页) 可以看到，它最后一次更新是在 2003 年。从那时起，PHP 增加了[`clone`关键字](http://www.php.net/clone)`clone()`，这与Matrix 中定义的函数冲突.php。

您需要更新 Matrix.php - 用“clone2”对“clone”进行搜索和替换就可以了。

# c# - 是否存在与 C++ 中的访问修饰符区域等效的 C#

> ID：431091
> 
> 赞同：3
> 
> 时间：2009-01-10T15:16:23.247
> 
> 标签：c#, access-modifiers

可以在 C++ 中使用以下结构声明变量

```
private:
public:
protected:
    float bla1;
    float bla2;
    float bla3; 
```

C#中是否有等价物？不得不重复自己似乎相当乏味；

```
protected float bla1;
protected float bla2;
protected float bla3; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-10T15:23:20.643

不可以。每个声明都指定了访问权限。

这样做的好处是方法在源文件中的位置对行为没有影响。这意味着您可以随意移动方法和属性（例如，将相关方法聚集在一起）而不受惩罚。字段的情况并非*如此*- 可以使字段的声明顺序很重要。诚然，最好不要一开始就这样做......

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-10T15:17:45.600

不，没有这样的事情。事实上，它的设计目的就是让代码更具可读性。这适用于 C# 和 Java。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-10T15:20:06.267

值得注意的是，如果你有多个相同类型的成员，你可以将它们声明为：

```
protected float bla1, bla2, bla3; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T15:25:55.523

不，C# 中没有等价物（VB 和 F# 也是如此）。

我个人喜欢这种差异。我在一个非常大的 C++ 代码库中工作，没有办法查看特定方法并知道它的特殊可访问性。有些类变得如此之大，以至于需要大量的页面滚动才能看到修饰符。

一些程序员可能认为这还不错，但考虑一下当人们开始在类中间混合#if defs 并在这些#if 中添加修饰符时会发生什么。它使在代码审查期间确定访问修饰符成为一项重要的操作。

内联添加修饰符是一个小的打字牺牲，但在长期可读性方面是值得的。

# java - Spring 上下文文件组织和最佳实践

> ID：431107
> 
> 赞同：22
> 
> 时间：2009-01-10T15:23:31.783
> 
> 标签：java, spring, jakarta-ee

我们已经开始在我的项目中使用 Spring 框架。在熟悉了基本功能（IoC）之后，我们也开始使用 spring aop 和 spring security。

问题是我们现在有超过 8 个不同的上下文文件，我觉得我们没有对这些文件的组织及其角色给予足够的考虑。随着项目的发展，引入了新文件。我们有不同的上下文文件：元数据、aop、授权、服务、Web 资源（它是一个 RESTful 应用程序）。因此，当开发人员想要添加一个新 bean 时，并不总是很清楚应该在哪个文件中添加它。我们需要方法论。

问题：

春季文件组织是否有最佳实践？

上下文文件应该封装层（DAL、业务逻辑、Web）还是用例？还是流量？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-10T17:14:33.103

如果您还处于项目的早期阶段，我强烈建议您查看注释驱动的配置。转换为注解后，我们只有 1 个带有定义的 xml 文件，它真的很小，这是一个大项目。注释驱动的配置将重点放在您的实现而不是 xml。它也或多或少地删除了相当冗余的抽象层，即 spring “bean name”。事实证明，bean 名称的存在主要是*因为*xml（bean 名称仍然存在于注释配置中，但在大多数情况下无关紧要）。在对一个大型项目进行此切换后，每个人都 100% 同意它*要*好得多，而且我们也有相当充分的证据表明它是一个更有生产力的环境。

我真的会推荐*任何*使用 spring 切换到注释的人。也可以混合它们。如果您需要过渡性建议，我想很容易询问 SO ;)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-10T21:05:41.157

从 applicationContext.xml 开始，当有很多有共同点的 bean 时分开。

To give you some idea of a possible setup, in the application I'm currently working on, here's what I have in server:

*   applicationContext.xml
*   securityContext.xml
*   schedulingContext.xml
*   dataSourcecontext.xml
*   spring-ws-servlet.xml (Spring Web Services related beans)

For GUI clients, since this project has several, there is one folder with shared context files, and on top of that, each client has its own context folder. Shared context files:

*   sharedMainApplicationContext.xml
*   sharedGuiContext.xml
*   sharedSecurityContext.xml

App-specific files:

*   mainApplicationContext.xml and
*   guiContext.xml and
*   commandsContext.xml (menu structure)
*   sharedBusinessLayerContext.xml (beans for connecting to server)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-10T15:38:55.713

Spring 上下文文件包含 bean 的定义，所以我认为最好遵循 OO 原则并按照与在包中构造类相同的方式来构造它们。我们通常创建包来封装一组类，这些类协同工作以解决特定问题。一个包通常封装了一个水平层（数据库层、中间件、业务逻辑或其中的一部分）。在某些情况下，包包含对应于水平层的类（您提到的用例或流）。一般来说，我建议为每个包或一组包创建一个上下文文件。添加新 bean 时，将其添加到与类的包对应的上下文文件中。

当然，这不应该是一个非常严格的规则，因为在某些情况下，遵循另一种做法可能会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T17:04:43.967

我发现我将它们逐层分解。

当我为每一层编写单元测试时，我会用与测试相关的值覆盖生产环境。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T05:12:23.713

yep - split on similar roles for the beans therein. As for annotations, I believe they "may" have a small role to play, perhaps with transaction definitions, but otherwise they just forever bind your code and you might as well be adding spring (or any other 3rd party) references directly everywhere. For me annotations=shortcut and technical debt. They aren't externally configurable, so its not trivial to rewire, or unwire your code, and limits reuse. A given bean is forever stuck with its annotated dependencies and configuration so cant be used by multiple projects/processes simultaneously with different wiring and config. just my 2 cents.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-21T02:05:31.287

I would follow spring's recommendations and place the context files in `META-INF/spring` as described in the [Spring Roo documentation](http://static.springsource.org/spring-roo/reference/html/usage.html#usage-file-system). In general, I would recommend trying out [roo](http://www.springsource.org/spring-roo) and following their project structure and layout.

**Example**

```
src/
+-- main/
|   +-- java/
|   \-- resources/
|       +-- META-INF/
|       |   \-- spring/                    ‹ normal spring context files
|       |       +-- context.xml
|       |       \-- context-services.xml
|       \-- other files
|
+-- test/
|   +-- java/
|   \-- resources/
|       +-- META-INF/
|       |   \-- spring/                    ‹ context files for testing
|       |       +-- context-test.xml
|       |       \-- context-dao-test.xml   
|       \-- other files
|
\-- pom.xml 
```

**Spring XML vs annotations**

There are many good articles on the topic, but I would like to break up a common misconception, because both approaches have their merits: If you want to separate the configuration from the actual implementation, it is easier with XML, but you can achieve the same thing with annotations, as [krosenvold said](https://stackoverflow.com/a/431352/12039). However, when using XML configuration files, bean names are only required, if the bean has to be referenced directly. You can always use [auto-wiring](http://static.springsource.org/spring/docs/3.0.x/reference/beans.html#beans-factory-autowire) by name or by type.

The only important thing is that you should stay consistent throughout the project, or, where possible, across your company's projects.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-10T17:51:36.103

在测试方面，将配置分解为单独的文件对我很有用。在一个小项目中，我会将 Spring Security 配置放入“securityContext.xml”，将其余的 bean 放入“applicationContext.xml”。然后在运行集成测试时，通过选择是否包含 securityContext.xml 可以轻松启用或禁用安全简单。这在某种程度上几乎类似于 AOP，因为您可以通过选择是否包含特定文件来为应用程序添加更多功能。

# c# - 使用 Rhino Mocks 模拟包含子对象的对象

> ID：431113
> 
> 赞同：0
> 
> 时间：2009-01-10T15:26:19.313
> 
> 标签：c#, .net, rhino-mocks

假设一个 IMouvement 对象包含一些子对象，如 ITache、IStockPalette。

```
public interface IMouvement : IObjectBase<Guid>
{
        ITache Tache { get; set; }
        IStockPalette StockPalOrigine { get; set; }
} 
```

如何使用 Rhino Mocks 模拟这个？

假设这个测试，这有什么问题？

```
[TestMethod]
public void Can_Validate_EmplacementTransitoireRule()
{
    var mocks = new MockRepository();
    var mouvement = mocks.StrictMock<IMouvement>();
    var manager = mocks.StrictMock<ValidationManager>();

    mouvement.Tache = mocks.StrictMock<ITache>();
    mouvement.StockPalOrigine = mocks.StrictMock<IStockPalette>();
    mouvement.ID = Guid.NewGuid();

    var rule = new EmplacementTransitoireRule(mouvement);
    manager.AddRule(rule);

    Expect.Call(manager.ValidateAll()).Return(true);

    mocks.ReplayAll();

    var all = manager.ValidateAll();

    mocks.VerifyAll();

    Assert.IsTrue(all);
} 
```

这个测试总是失败..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T15:44:51.943

通常我会在模拟对象上设置期望，而不是仅仅分配它们的属性。

```
 Tache tache = mocks.StrictMock<Tache>();
 Expect.Call( mouvement.Tache ).Return( tache ); 
```

此外，您可能希望对 RhinoMocks 使用[AAA](http://ayende.com/Blog/archive/2008/05/16/Rhino-Mocks--Arrange-Act-Assert-Syntax.aspx)（Arrange-Act-Assert）语法——我相信 StrictMock 已被弃用。

```
 Mouvement mouvement = MockRepository.GenerateMock<Mouvement>();
 Tache tache = MockRepository.GenerateMock<Tache>();

 mouvement.Expect( m => m.Tache ).Return( tache );
 tache.Expect( t => t.Value ).Return( 100 );  // or whatever

 ... test code...

 tache.VerifyAllExpectations();
 mouvement.VerifyAllExpectations(); 
```

# html - HTML2PDF 转换

> ID：431117
> 
> 赞同：8
> 
> 时间：2009-01-10T15:28:32.787
> 
> 标签：html, windows, pdf

我们正在为 Linux 和 Windows 开发需要将 CVS 文件生成为 PDF 报告的软件。我用 C 语言编写了一个程序，将 CVS 文件转换为 HTML 文件（td、tr 等），然后在 Linux 下使用 html2ps 和 ps2pdf 将 HTML 转换为 PS。

然而，如上所述，我们也在为 Windows 开发，虽然我知道 html2ps 和 ps2pdf 在 Windows 下可用，但它们有一些依赖项会导致我们的客户头疼（即 Perl 和 Ghostscript）。是否有任何本机 Windows 控制台应用程序可以将 HTML 转换为可以作为单个可执行文件分发而没有主要依赖关系的 PDF？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-02-17T13:46:23.920

我想添加一个我最近使用的新条目 - [wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/) - 它是一个使用 webkit 进行渲染的开源项目，这意味着它具有所有最新和最好的可用包括 CSS3、SVG，甚至可以让 javascript在创建 pdf 之前运行。它没有与princeXML 相同的抛光水平，但它是我找到的最好的FOSS 解决方案。

我还没有将它用于多页文档，但我相信它确实支持 css 分页符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T02:05:31.867

我已经将[Prince XML](http://www.princexml.com/)与 Java 一起使用，它非常强大且易于使用，但它也是商业的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T00:05:11.873

我使用了 ExpertPDF 的[Html2Pdf](http://www.html-to-pdf.net/Features.aspx)转换器组件。易于使 .NET 应用程序进行转换。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T09:21:59.727

检查[比萨](http://pypi.python.org/pypi/pisa/)。它完全用 python 编写，所以应该可以在 Windows 和 Unix 上运行。许可证是 GPL，但也可以使用商业许可证。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T12:15:02.010

我们过去曾使用[Apache FOP](http://xmlgraphics.apache.org/fop/)将 XML 文档转换为 PDF。也许不是您正在寻找的东西，但它可能是一种选择？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T21:17:55.613

I had lots of luck with [HTMLDOC](https://www.msweet.org/projects.php?Z1). It is open source and available on many platforms and has a commercial version if you want to pay for it.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T21:15:29.083

I've used [Aspose](http://www.aspose.com/) which has both .NET and Java libraries to use for PDF conversion. I think it's great to use, but there's definitely a cost involved.

Since you're looking for something open source, I might suggest [iText](http://www.lowagie.com/iText/). I hear it's good, but haven't used it myself.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T21:17:52.243

[PDFLib](http://www.pdflib.com/pdflib-gmbh/) could be bundled with a native application written by yourselves to create PDFs. It's a great library - used to be free but it looks you have to pay for it these days.

Another option, but it doesn't exactly fit your non-dependency requirement, is [iTextSharp](http://itextsharp.sourceforge.net/).

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-04-09T00:27:51.890

正如 Russell 所说，wkhtmltopdf 可能是最好的选择。我创建了一个免费的在线服务，用于将 HTML 转换为 PDF 文件[http://www.html2pdfrocket.com](http://www.html2pdfrocket.com)，它使用 wkhtmltopdf，但使该过程变得简单且跨平台。

我添加了关于如何将 HTML 转换为 PHP、C#、RUBY 和 HTML 的 PDF 的示例。如果你愿意，你可以在 JavaScript 中触发它。

心脏基金会和其他人正在使用它来实时创建 PDF 文件，例如食谱、发票、收据等的 PDF - 尽管您可以根据需要下载和缓存 PDF 输出。

希望你觉得它有帮助，如果你有反馈或者如果你需要帮助让 kwhtmltopdf 在你自己的环境中工作，请写信给我。

# language-agnostic - 在您的第一个程序中，哪个结构让您对编程产生了兴趣？

> ID：431119
> 
> 赞同：5
> 
> 时间：2009-01-10T15:30:16.263
> 
> 标签：language-agnostic, language-construct

对我来说，这是 If 语句，我很兴奋，从那时起我就相信计算机非常智能，或者我至少可以因此让它看起来很智能。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-10T15:33:00.797

对于我们许多在 70 年代末或 80 年代初接触计算机的人来说，我们看到的第一个程序是这样的：

```
10 PRINT "Commodore sucks!  "
20 GOTO 10 
```

（“Commodore”可以替换为“Apple”、“Atari”或“TRS-80”）。

GOTO 很棒。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-10T16:03:51.313

答案＃2 :)

首先真正让我着迷的实际语言结构是递归。问题

> 编写一个名为 SumDigits 的函数，它将数字的数字相加。示例：SumDigits(1234) -> 10

起初我写了一个很长的迭代解决方案。但过了一会儿，我想出了这个答案。

```
string SumDigits(int value) {
  if ( value > 10 ) {
    return SumDigits(value/10) + (value%10);
  }
  return value;
} 
```

答案的简洁让我感到惊讶，我立即在递归和简洁编程中找到了新的爱好。

只花了几个星期就学会了递归的坏处:)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-10T15:31:32.623

让电脑服从我。惊人的。

我也喜欢（喜欢讨厌）即使我错了计算机也会服从。

* * *

但认真的人。

我被迷住了，当：

*   我看到你可以用代码做丰富而动态的事情。
*   即机器大体一致。
*   从某种意义上说，编程就像数学一样，对于所有“它取决于”，我们仍然有比我们公平份额的问题更多的实际、可证明的答案。
*   我可以用逻辑和循环自动完成琐碎的任务。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-10T15:40:07.427

从[QBasic](http://en.wikipedia.org/wiki/QBasic)开始，所以，我认为它是这样的：

```
INPUT "What's your name?", a$
PRINT "Hi, "; a$; "!" 
```

能够在屏幕上显示一些东西`PRINT`足以让我对编程感到兴奋。交互性使用`INPUT`是锦上添花！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-10T15:46:30.053

指针。

当我开始使用 Turbo Pascal 编程时，我真的无法理解，他们到底是如何编写大程序的。内存是有限的，无论我试图做什么 - 我经常会达到堆栈限制。

当我终于被介绍给指针时，我终于被迷住了，因为我终于可以开始做大事了！并不是说我做了什么大事，而是... :)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-10T15:54:54.310

当我第一次开始使用 QBASIC 学习编程时，使用 if 语句和循环进行流控制的整个想法很棒。我想在我了解 if 语句之后几天，我就构建了我的第一个“选择你自己的冒险”游戏。回想起来，我知道它在代码行方面一定是非常低效和庞大的，但是我可以只使用 if 语句来分支故事这一事实真是太棒了。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-10T21:40:17.343

我编写的第一个 Fortran 代码中有一个 if 语句，这是我当时看到的最令人着迷的东西之一。像这样的东西

```
 integer n

     n = 1
  20 if (n .le. 100) then
        n = 2*n
        write (*,*) n
        goto 20
     endif 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-10T15:48:17.803

对我来说，这不是一种特定的语法——它发现我可以突破并改变 ZX Spectrum 游戏——我想发现源代码是让我着迷的原因。

然后，当我真正开始编程并从书中复制代码时，能够自定义书中的内容并使程序仍然可以工作，但是我想要的方式。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-10T16:10:31.203

? “你好世界”

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-10T16:20:16.660

从我的第一本 BASIC 书（我相信为孩子们准备的 BASIC）：

```
10 INPUT A
20 INPUT B
30 LET C = A + B
40 PRINT C 
```

那是在书的封面上，我对这些可能性感到兴奋（它可以做我的功课！）......我花了几个星期才掌握了这个简单的概念，但一旦我明白了，世界编程为我打开了大门。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-10T16:56:36.900

发现评论后，我真的爱上了编程语言。你可以用它做各种事情，比如

```
// a commment!
int /* whoa, an inline comment! */ a; 
```

;)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-10T17:43:33.280

For Loops + Arrays 为我做了。一旦我意识到我可以遍历任意大的一组事物并对它们中的每一个做一些事情，这一切就开始融合在一起。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-01-10T20:11:43.340

最肯定的是 FOR 循环 - 在 6 岁时，让那个 lil' LOGO Turtle 从画线到画正方形再到画圆，这就是我从用户变成程序员的全部过程。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-01-10T20:37:14.787

清除案例，循环。特别是在 Gwbasic 中循环。只是为了好玩，我想在屏幕上打印从 0 到 100 的所有数字。所以我开始：

```
10 print 1
20 print 2
30 print 3
40 print 4 
```

在某些时候，我认为 WTF 或类似的东西。肯定有更好的办法。所以我问了某个人（可能是老师或同学），然后他向我介绍了**变量**和**循环**的魔力。那一定是我上瘾的那一刻。

```
10 SET i = 0
20 IF i > 100 THEN GOTO 60
30 PRINT i
40 SET I = I + 1
50 GOTO 20
60 REM END LOOP 
```

那是 6 行而不是 100 行！！！那好多了。对不起，如果我的语法不完全正确。:-) 我真的很喜欢那一刻。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-11-17T12:02:40.623

Lambda 表达式

我几乎一生都在编程，但即使是现在，也能在像 lamdba 表达式这样的新事物中找到兴奋。

```
 MyList.Any(p => p.IsCurrent) 
```

嗯。。喜欢。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-01-10T15:32:24.417

当我第一次学习时，我肯定认为数组。在此之前，我真的只是考虑单个变量。当我了解数组时，我能够用我的 qbasic 做更多的事情:)。

现在我有各种可用的数据结构，而不仅仅是数组:)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-01-10T23:07:36.823

for 或 while 循环，因为我可以在分子动力学模拟中使用它，而且我不必一次次手动进行计算

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-10T15:45:10.913

对我来说是指针。

虽然我什至不会假装完全理解指针，但这是我第一次真正陷入编程困境。在弄乱了 Visual Basic 6 和服务器端脚本语言之后，我转向了 C，拿起了最基本的东西，然后遇到了指针。

在那次演讲中，我记得人们对指针的反应。自称编程之神吓得瑟瑟发抖，那些一无所知的人开始阅读当地报纸上的招聘广告。我真的记得班上的一个女孩说“哇？”

许多程序员在命中指针时都会被叫醒。编程世界刚刚向您介绍了计算世界，如果您只是刚刚认识，您会发现几乎没有什么可谈的。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-10T15:53:21.660

我记得第一个真正让我着迷的计算机问题。这是我在高中编程课上遇到的一个问题。

> 编写一个程序，从控制台读取一个数字

为什么这让我着迷？好吧，一开始并没有。我编写了一个快速而肮脏的程序来完成这项工作，但后来老师做了一些非常出乎意料的事情。她在程序中输入了“a”，它死得很惨。

我花了一天剩下的时间来处理邪恶的输入，但最终我得到了它的工作。这个过程完全让我对程序正确性的想法产生了兴趣。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-10T15:57:14.430

如果转到。

不是开玩笑。早在我得到一种有指针的语言之前，我就被迷住了。

到那时，我已经使用数组索引编写了类似指针的算法。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-01-10T16:45:02.913

C中的函数指针。

首先我学习了 C，但没有学习函数指针。

然后我开始在大学里用汇编程序编程大约一个学期。然后我使用了函数指针，甚至不知道它们。不知何故，它们对我来说似乎是汇编程序中的自然现象。我不得不向我的老师解释几次，因为他们不理解:)。

然后，我回到C，启示击中了我。

现在我嘲笑 Java 方法、泛型、后期多态性和诸如此类的“神奇”事物。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-01-10T18:24:01.730

`PRINT 3 + 4`
电脑说 7。这一切都在我父母的电视上可见。在电视上！！！你能想象吗？我立刻就被迷住了。你可以告诉机器该做什么，你可以在电视上看到。哇。

背景：我父亲的雇主为工程师购买了一台小型计算机（Robotron KC 85/1）来接触这项技术。他们可以在周末把它带回家玩。所以我爸爸把它带回家了，他对它的新认识就是如何连接它以及如何打开它。他的一位同事告诉他“打印”命令和添加数字的技巧。他给我看了，我被迷住了。大约是 1986 年，那时我 12 岁。我仍然因为基本相同的原因而着迷（告诉机器该做什么）。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-01-10T18:34:00.120

qBasic，当我大约 10 到 12 岁时，我开始制作“医生问你奇怪问题”的游戏副本。结果是很多讨厌的问题。那时我知道我想与计算机一起工作。

几年后，我开始使用 HTML 和 PHP，给了我几个客户，然后我创办了一家公司，那时我知道我可以在这方面变得非常富有:)

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-01-10T19:44:17.340

我只编程了大约一年，所以对我来说，它是 LINQ。我查看了将查询字符串暴露给数据库的书籍中的代码，并想“哇，这有点蹩脚。”。我遇到了 LINQ，从那以后我们一直幸福地结婚。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-01-10T20:08:44.377

当 DBase II 允许我将记录打印到文本文件并在我想要的几乎所有位置粘贴正确的排版代码时——在它们之前、在它们内部、在它们之后、在它们周围。我仍然能感觉到脖子后面的凉意。哇，我的小电脑里有一整套排版系统！预热 300 波特调制解调器并将此文件直接发送到 8 英寸磁盘并通过 Compugraphic 运行。几码漂亮闪亮的相纸，所有字母都在正确的位置。我不配得到这样的幸福……

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-01-10T20:11:03.560

我的是基本的。我认为你可以让程序跳转到任何你想要的地方是不可思议的。直到后来我才意识到，强大的力量伴随着巨大的责任。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-01-11T00:14:33.537

真正让我对编程着迷的是以下 x86 汇编程序行：

```
mov ax, 13h
int 10h
mov ax, 0a000h
mov es, ax 
```

当我了解到通过弄乱视频内存来绘制东西是多么容易时，我学到的所有其他东西突然变得有用了。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-01-10T15:37:36.387

作为编程构造的函数。无论问题有*多大*，我都可以将其分解为对一组函数的合理调用。如果任何一个函数要解决的问题太大，我也可以分解（当时我们不叫它重构）。我想，迟早我可以通过完成这些功能来解决*任何问题。*

更一般地说，当我意识到我可以创建决定团队、部门、业务甚至整个行业如何运作的*流程时，我迷上了开发。*我可以帮助他们更好更快地工作。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-01-10T18:03:32.710

启发了这个词

BASIC **B**初学者通用符号指令**代码****_** _ **_** **_** **_** _

 *** * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-01-10T18:43:54.030

我发现 ++ 在高中时很迷人。

其他人都知道 Basic、Pascal 等。但 i++ 是*代码*！还有只有我知道的代码！

如此微小的变化可能会产生非常重要的影响：++i 在许多重要方面与 i++ 不同。++ 直接翻译成机器代码。所以通过学习这个，我可以直接访问机器的核心。想象一下力量！

了解这一点让我想学习 C 语言的所有其他奇怪的操作和角落。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-01-10T19:15:17.430

除了**if 语句**（我首先从 Pascal [第一语言学习] 中学到）。C 中指针和数组之间的**一一对应**是真正让我着迷于编程的原因。它使我对计算机能力的理解达到了很高的水平，包括但不限于高效的内存遍历、堆栈、将数组的特定部分（切片）传递给函数、处理指向内存映射 IO（例如 VGA 地址）的指针作为一个数组。在 Pascal 中，指针是如此不透明，以至于程序员对计算机内存及其能力的理解受到严重阻碍。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-01-10T19:31:14.123

BASIC 结构化编程的开端...

```
GOSUB 1000 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-01-10T19:33:07.707

DOS中断

```
INT 21h 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-01-10T19:38:24.827

TRS-80 显卡

```
POKE 15360, 191 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2009-01-10T20:31:44.267

我大约在 7-8 岁（1992-93 年）开始使用 QBasic。一位朋友（同龄）向我展示了他可以做的惊人的图形程序。我经常问诸如“你能让……做……代替吗？”，他可以！

我还记得的一个程序是类似液体的东西充满了屏幕，最初包含几个又大又粗的圆圈。从左到右再向后扫描，撞到墙壁，如果卡在某个地方就会爆炸（！）。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2009-01-10T20:35:54.397

绝对`while`！但我的编程经验是最近的。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2009-06-20T09:33:04.293

这不是一种语言结构，但是当我发现更改 TextAttr（文本颜色，Pascal）的效果即使从我的程序返回到 DOS 后仍然存在时，我被迷住了。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2009-06-20T09:41:26.197

QBASIC 中有 PLOT 命令，当我第一次编写一个可以在屏幕上绘制螺旋的程序时，有一种成就感。我想那是我理解计算机可以做很棒的事情的时候，我在接下来的几十年里一直坚持使用它们。

（怀旧。我还记得黑屏上的石灰绿色螺旋……）

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2009-06-20T09:54:41.083

我从基本开始，但真正让我大吃一惊的是 LOGO，这是一种允许您编写“虚拟笔”（称为乌龟）在屏幕上绘制东西的语言。我开始画非常复杂的形状，考虑到我还很小，我完全参与其中。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2009-06-20T09:58:46.097

我认为我的第一个程序（除了菜鸟 PHP）是为任天堂 GBA 构建的 RPG。我喜欢你如何将位和字节操作成一个很棒的游戏。当 Nintendo DS 发布时，我失去了兴趣，不仅因为它没有针对自制软件进行逆向工程，而且开发要求也大大增加。

它没有“吸引”我，而是 cout << "Hello World!" <<endl; 非常棒。不过我一直不明白怎么会有人使用控制台，所以我直接去了win32 UI，哈哈。很快就失去了兴趣，直到成年。美好的时光。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2009-06-20T10:04:24.573

```
POKE 53280,5 
```

将 C-64 上的屏幕边框更改为紫色。把它放在一个 for 循环中，将颜色从 0 循环到 15，你会让孩子们对编程感到兴奋。好吧，至少在 80 年代末/90 年代初是这样。

# flash - Flash上 传图片大小调整客户端

> ID：431120
> 
> 赞同：20
> 
> 时间：2009-01-10T15:31:21.220
> 
> 标签：flash, image-processing, upload

有没有人知道如何使用 Flash 调整客户端图像大小。

示例：客户选择一张 1200x800 的图像，在上传之前，flash 会将其变成一半或其他东西。

有什么想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-01-05T22:39:17.660

Plupload 是开源的，具有良好的文档并支持多种平台，包括 Gears 和 HTML5！

[http://www.plupload.com/index.php](http://www.plupload.com/index.php)
[http://www.plupload.com/example_all_runtimes.php](http://www.plupload.com/example_all_runtimes.php)

啊，是的，它支持在上传之前调整图像大小。最接近 aurigma 的选项，但免费 :)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-08-05T05:32:25.643

看看我写的脚本： [在客户端调整图像大小](http://www.adylevy.com/index.php/2009/06/07/client-side-image-resize-flash-cs4-filereferencedata/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-15T21:46:51.037

[http://www.shift8creative.com/projects/agile-uploader/index.html](http://www.shift8creative.com/projects/agile-uploader/index.html)

我刚刚完成了这个小项目 - 免费使用。它不会真正允许最终用户选择尺寸，但您可以传递最大宽度和最大高度约束。也许您可以使用不同的选项制作多个页面/嵌入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T16:17:39.567

Silverlight、ActiveX 和 Java 可以完全在客户端执行此操作。如果您必须使用 Flash，您将需要使用尚未流行的 Flash 10。这是一个[将图像上传到 Flash 然后](http://flexgraphix.com/blog/?p=51)从 Flash Cafe 在客户端上调整其大小的示例。

Flash 8 或 9 中的其他选项将涉及服务器端大小调整脚本，在大多数情况下都无法达到目的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T07:22:33.950

您需要创建一个转换矩阵，然后使用它将原始位图绘制成新的位图。这是我刚刚输入但尚未测试的内容中的想法：

```
function resize(obm:BitmapData, scale:Number): BitmapData {
   var resizeMatrix:Matrix = new Matrix();
   resizeMatrix.scale(scale, scale);

   var rbm:BitmapData = new BitmapData(obm.width * scale, obm.height * scale);
   rbm.draw(obm, resizeMatrix);

   return rbm;
} 
```

然而，我没有对结果的质量提出任何要求。我想我记得过去尝试过这个，不喜欢结果，然后下注......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-05-04T08:41:58.883

我正在使用来自[http://www.resize-before-upload.com](http://www.resize-before-upload.com)的 Flash 上传器，效果很好:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-19T04:28:16.420

最新版本的**SwfUpload 进行**客户端图像大小调整（使用 Flash）。一个非常有用的工具，尽管显示上传进度之类的附加功能可能会有些繁琐。

[http://code.google.com/p/swfupload/](http://code.google.com/p/swfupload/)

# jsf - JSF 数据表查询

> ID：431123
> 
> 赞同：0
> 
> 时间：2009-01-10T15:32:41.077
> 
> 标签：jsf

有人可以帮我处理以下 JSF 数据表吗？在这里，我从数据库表中获取数据并使用了 dataTable 绑定，但我不知道为什么它在屏幕上显示行 3 次，但如果我删除绑定，那么它只显示一次。

* * *

```
<h:dataTable binding="#{threadController.dataTable}" var="category" value="#{threadController.queryCategories}" border="1" cellpadding="2" cellspacing="0">
  <h:column>
  <img src="../../images/directory.jpg" alt="Forum Icon" />
  </h:column>
  <h:column>
  <h:form>
  <h:commandLink value="#{category.cname}" action="#{threadController.categoryDateItem}" />
  </h:form>
  </h:column> 
```

```
// defined globally
private HtmlDataTable dataTable;
private HtmlInputHidden dataItemId = new HtmlInputHidden();

public String categoryDateItem() {
            category = (Category) dataTable.getRowData();
            System.out.println("category action by select: "+category.getCname());
            dataItemId.setValue(category.getId());
            return "editItem"; // Navigation case.
 }

@SuppressWarnings("unchecked")
public ArrayList<Category> getQueryCategories(){    

    return (ArrayList<Category>)HibernateUtil.getSession().createCriteria(Category.class).list();   

} 
```

* * *

输出：

```
 myText   myText   myText 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T04:57:39.550

将此组件绑定到 bean value="#{threadController.queryCategories}" 的绑定表达式。因此 value 属性足以使用 dataTable 标记检索数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T01:00:51.417

Binding = component backing bean

Value= data model backing bean

So, you have the Value and Binding set correctly (at least, as far as I can see). Your problem may result from the fact that you're not caching the list you're getting back from the database in getQueryCategories().

You really can't have any idea how often getQueryCategories() will be called in the process of rendering that dataTable, so it's a good idea to do something like this:

```
// Somewhere near the top of the handler class.. create a cache variable:
private ArrayList<Category> qCategories = null;

// now for getQueryCategories
public ArrayList<Category> getQueryCategories(){    
      if ( qCategories == null ) {  // qCategories should be a member of the handler
           qCategories = (ArrayList<Category>)HibernateUtil.getSession().createCriteria(Category.class).list();   
      }

      return qCategories
} 
```

This kind of cache-ing is very helpful in JSF apps with handlers that are session of even request scoped, as again you can't really know how often JSF will evaluate your "value" expression in the dataTable.

# c# - 读取值时是否应该锁定资源？

> ID：431138
> 
> 赞同：5
> 
> 时间：2009-01-10T15:43:36.330
> 
> 标签：c#, .net, multithreading, synchronization

在 C# 中进行线程同步时，我是否应该在读取值或只是更改它时锁定一个对象？

例如我有 Queue<T> 对象。我应该在执行 Enqueue 和 Dequeue 时锁定它，还是在检查 Count 等值时也应该锁定它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T15:49:12.450

来自 MSDN：

> 一个 Queue<(Of <(T>)>) 可以同时支持多个读取器，只要不修改集合即可。即便如此，通过集合枚举本质上不是线程安全的过程。为了保证枚举过程中的线程安全，可以在整个枚举过程中锁定集合。要允许集合被多个线程访问以进行读写，您必须实现自己的同步。

您应该确保在项目排队时没有阅读器处于活动状态（锁定可能是个好主意）。

查看反射器中的计数显示来自私有字段的读取。这可能没问题，具体取决于您对值的处理方式。这意味着你不应该做这样的事情（没有适当的锁定）：

```
if(queue.Count > 0)
    queue.Dequeue(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T15:45:09.243

取决于你想用锁做什么。通常这种锁定需要读写器锁定机制。

读者/作者锁定意味着读者共享一个锁，因此您可以让多个读者同时读取集合，但要写入，您应该获取排他锁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T15:48:44.867

如果你不锁定它，你可能会得到一个较旧的值。可能会出现竞争条件，即执行写入操作会更改 Count，但您将获得更改*之前*的值。例如，如果队列只有一个项目，并且一个线程调用 dequeue，另一个线程可能会读取计数，发现它仍然是 1，然后再次调用 dequeue。在授予锁定之前不会完成第二次调用，但那时队列实际上是空的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T15:46:44.763

CLR 保证原子读取最大处理器宽度的值。因此，如果您在 32 位上运行，读取`int`s 将是原子的。如果您在 64 位机器上运行，读取`long`s 将是原子的。因此，如果`Count`是，`Int32`则无需锁定。

[这篇文章](http://blogs.msdn.com/brada/archive/2003/04/03/49896.aspx)与您的问题有关。

# visual-c++ - Visual C++ 中的错误突出显示

> ID：431154
> 
> 赞同：3
> 
> 时间：2009-01-10T15:48:15.057
> 
> 标签：visual-c++, highlighting

在 Java 项目上使用 Eclipse 或 NetBeans IDE 时，我可以在编译之前和之后查看代码中的错误在哪里。显示了导致问题的行。我记得在过去，Visual C++ 98' 版本确实在代码中的错误下划线。有没有办法在 Visual C++ 2005 中启用此功能？或者是否有第三方插件可以这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T19:14:14.580

为此，您需要一个用于 C++ 的静态代码分析工具，并带有 VS2005 的实时插件。不幸的是，我不知道任何可以插入 VS2005 的开源静态代码分析器，但有一些商业的。[Riverblade 的 Visual Lint](http://www.riverblade.co.uk/products/visual_lint/index.html)就是其中一款广受欢迎的产品。

一般来说，谷歌搜索“visual c++ static code analysis”是开始寻找这类软件的好地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-08T06:58:37.053

视觉辅助也是一个有用的工具。适用于所有版本的视觉工作室。

# java - 如何在 Java 中识别文本文档的语言？

> ID：431159
> 
> 赞同：9
> 
> 时间：2009-01-10T15:48:48.160
> 
> 标签：java, text, dictionary, text-processing

是否有现有的 Java 库可以告诉我字符串是否包含英语文本（例如，我需要能够区分法语或意大利语文本——该函数需要为法语和意大利语返回 false，对英语返回 true） ?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-10T16:58:06.273

有多种技术，一种强大的方法将结合各种技术：

*   查看文本**中*n 个*字母**组（例如，3 个字母或**三元组**）的频率，看看它们是否与您正在测试的语言的频率相似
*   查看给定语言中**常用词的实例**是否与您的文本中发现的频率相匹配（这对于**较长的文本**往往效果更好）
*   文本是否包含强烈缩小到特定语言的**字符？**（例如，如果文本包含一个倒置的问号，则很有可能是西班牙语）
*   您能否**“松散地解析”**文本中指示特定语言的某些特征，例如，如果它包含与以下正则表达式的匹配项，您可以将此作为语言是法语的有力线索：

    \bvous\s+\p{L}+ez\b

为了帮助您入门，这里是英语、法语和意大利语的常用三元组和字数统计（从一些代码复制和粘贴——我将把它作为一个练习来解析它们）：

```
 Locale.ENGLISH,
      "he_=38426;the=38122;nd_=20901;ed_=20519;and=18417;ing=16248;to_=15295;ng_=15281;er_=15192;at_=14219",
      "the=11209;and=6631;to=5763;of=5561;a=5487;in=3421;was=3214;his=2313;that=2311;he=2115",
  Locale.FRENCH,
      "es_=38676;de_=28820;ent=21451;nt_=21072;e_d=18764;le_=17051;ion=15803;s_d=15491;e_l=14888;la_=14260",
      "de=10726;la=5581;le=3954;" + ((char)224) + "=3930;et=3563;des=3295;les=3277;du=2667;en=2505;un=1588",
  Locale.ITALIAN,
      "re_=7275;la_=7251;to_=7208;_di=7170;_e_=7031;_co=5919;che=5876;he_=5622;no_=5546;di_=5460",
      "di=7014;e=4045;il=3313;che=3006;la=2943;a=2541;in=2434;per=2165;del=2013;un=1945", 
```

（Trigram 计数是每百万个字符；字数是每百万个单词。“_”字符表示单词边界。）

我记得，这些数字是在牛津计算语言学家手册中引用的，并且是基于报纸文章的样本。如果您有这些语言的文本语料库，那么您自己很容易得出类似的数字。

如果您想要一种真正快速而肮脏的方式来应用上述内容，请尝试：

*   考虑文本中的每个三个字符序列（用“_”替换单词边界）
*   对于与给定语言的常见三元组匹配的每个三元组，将该语言的“分数”增加 1（更复杂的是，您可以根据列表中的位置加权）
*   最后，假设语言是得分最高的语言
*   可选地，对常用词做同样的事情（组合分数）

显然，这可以被细化，但您可能会发现这个简单的解决方案足以满足您的需求，因为您本质上对“英语与否”感兴趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-23T03:48:21.480

您是否尝试过 Apache Tika。它有很好的API来检测语言，它还可以通过加载相应的配置文件来支持不同的语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T16:25:59.567

您可以尝试将每个单词与英语、法语或意大利语词典进行比较。请记住，尽管某些单词可能会出现在多个词典中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T16:26:28.660

这是一篇[有趣的博客文章](http://www.codecommit.com/blog/scala/bloom-filters-in-scala)，讨论了这个概念。这些示例在 Scala 中，但您应该能够将相同的一般概念应用于 Java。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-10T16:32:21.020

如果您正在查看单个字符或单词，这是一个棘手的问题。但是，由于您正在处理整个文档，因此可能会有一些希望。不幸的是，我不知道现有的图书馆可以做到这一点。

一般来说，每个语言都需要一个相当全面的单词列表。然后检查文档中的每个单词。如果它出现在一种语言的字典中，请给该语言“投票”。有些词会出现在不止一种语言中，有时一种语言的文档会使用另一种语言的借词，但是文档不需要很长时间就会看到一种语言的非常明显的趋势。

一些最好的英语单词列表是[拼字游戏](http://zyzzyva.net/)玩家使用的。这些列表可能也适用于其他语言。原始列表可能很难通过 Google 找到，但它们就在那里。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T15:58:45.160

没有“好”的方式来做这个海事组织。关于这个主题的所有答案都可能非常复杂。显而易见的部分是检查法语 + 意大利语而不是英语的字符，然后返回 false。

但是，如果单词是法语但没有特殊字符怎么办？想一想你有一个完整的句子。您可以匹配字典中的每个单词，如果句子的法语分数多于英语分数，则它不是英语。这将阻止法语、意大利语和英语的常用词。

祝你好运。

# cocoa-touch - iPhone SDK：方向（横向和纵向视图）

> ID：431165
> 
> 赞同：9
> 
> 时间：2009-01-10T15:53:13.797
> 
> 标签：cocoa-touch

好的，我的普通应用程序处于纵向模式。我可以强制我的应用程序进入横向模式以获得这样的视图（使用导航控制器和视图控制器）：

```
- (void)viewWillAppear:(BOOL)animated {
    [[UIDevice currentDevice] setOrientation:UIInterfaceOrientationLandscapeRight];
} 
```

但是当我回到主菜单（tableview）时，它直接回到纵向。我试试这段代码：

```
- (void)viewWillAppear:(BOOL)animated {
    [[UIDevice currentDevice] setOrientation:UIInterfaceOrientationPortrait];
} 
```

但这不起作用..

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-04-04T02:25:07.743

看一下UIViewController 类中的函数[shouldAutorotateToInterfaceOrientation:。](https://developer.apple.com/documentation/uikit/uiviewcontroller/1621459-shouldautorotatetointerfaceorien?language=objc)如果您的 UIView 支持方向，则此函数返回 YES。如果您只对横向返回 YES，则 iPhone 将自动置于该方向。

下面的代码应该做到这一点。将它放在 UIViewController 中，该控制器控制要置于横向模式的视图。

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    // Return YES for supported orientations
    return (interfaceOrientation == UIInterfaceOrientationLandscape);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-11T19:45:38.650

为了让它工作，我将它添加到 rootviewcontroller：

```
- (void)viewWillAppear:(BOOL)animated {
    [[UIDevice currentDevice] setOrientation:UIInterfaceOrientationPortrait];

} 
```

这似乎现在起作用了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-21T04:03:49.203

这是我正在做的事情：

首先，将此定义放在文件顶部，就在您的#imports 下方：

```
#define degreesToRadian(x) (M_PI * (x) / 180.0) 
```

然后，在 viewWillAppear: 方法中

```
[[UIApplication sharedApplication] setStatusBarHidden:YES animated:NO];     
if (self.interfaceOrientation == UIInterfaceOrientationPortrait) {  
    self.view.transform = CGAffineTransformIdentity;
    self.view.transform = CGAffineTransformMakeRotation(degreesToRadian(90));
    self.view.bounds = CGRectMake(0.0, 0.0, 480, 320);
} 
```

如果你想让它被动画化，那么你可以将整个东西包装在一个动画块中，如下所示：

```
[UIView beginAnimations:@"View Flip" context:nil];
[UIView setAnimationDuration:1.25];
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];

[[UIApplication sharedApplication] setStatusBarHidden:YES animated:NO];     
if (self.interfaceOrientation == UIInterfaceOrientationPortrait) {  
    self.view.transform = CGAffineTransformIdentity;
    self.view.transform = CGAffineTransformMakeRotation(degreesToRadian(90));
    self.view.bounds = CGRectMake(0.0, 0.0, 480, 320);
}
[UIView commitAnimations]; 
```

然后，在您的纵向模式控制器中，您可以执行相反的操作 - 检查它当前是否处于横向状态，如果是，请将其旋转回纵向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T16:09:16.043

您需要编辑 Info.plist 文件以添加具有适当值（UIInterfaceOrientationLandscapeRight 或 UIInterfaceOrientationLandscapeLeft）的 UIInterfaceOrientation 键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-12T11:38:11.497

您不能使用此私有 API。

有一个解决方案：使用视图控制器并将其视图添加到窗口中。然后在该控制器中，您在 shouldAutorotate... 方法中强制景观。它工作得很好，但要确保你的项目有必要使用它，因为强迫用户转动他的 iPhone 并不是很聪明。顺便说一句，如果您需要，这里有一个示例代码。

[http://www.geckogeek.fr/iphone-forcer-le-mode-landscape-ou-portrait-en-cours-dexecution.html](http://www.geckogeek.fr/iphone-forcer-le-mode-landscape-ou-portrait-en-cours-dexecution.html)

# visual-studio - Visual Studio 文本框换行功能

> ID：431194
> 
> 赞同：0
> 
> 时间：2009-01-10T16:02:47.740
> 
> 标签：visual-studio, textbox, word-wrap

当我在文本框中写入文本而不是继续输入一行时，如何使文本自动换行到下一行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T16:04:58.283

在属性设置中使您的文本框多行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T16:15:04.067

我已经做到了，但是尽管文本框变大了，但打字一直在直线上！

# git - Git：如何维护一个项目的两个分支并只合并共享数据？

> ID：431201
> 
> 赞同：3
> 
> 时间：2009-01-10T16:05:20.623
> 
> 标签：git, merge

假设我有一个项目 IMClient-MacOS 和 IMClient-Windows 的两个分支，并且它们的代码仅相差（假设）一个目录 main/。所有其他目录都包含独立于系统的代码并且可以互换。

有些工人在 Windows 版本上工作，有些在 MacOS 版本上工作。当他们从对应的分支合并时，他们如何防止覆盖更改到 main/ 目录？有没有一种方法可以在 Git 中合并始终忽略依赖于操作系统的目录？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-10T19:09:58.877

您可能*可以*`git`使用. 还是我忽略了让来自不同系统的代码共享一个目录的充分理由？

 ** * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-11T07:52:17.793

不要每个平台（windows 和 mac）只使用一个分支。

相反，至少要有三个分支：Generic、windows 和 mac。通用分支没有任何系统相关代码，平台分支没有任何通用代码，因此没有一个分支将自行构建。相反，mac 开发人员总是创建一个一次性分支，该分支是 generic 和 mac 之间的合并，以便构建。

然后，开发通用功能并将其提交到通用分支，并在平台分支上使用相关的平台支持代码。

更好的是有一个单一的代码库，构建系统可以在两个平台上构建（makefile 变量和条件编译）。然后一个mac开发者会为新特性添加一个通用特性和平台支持代码，只针对mac，同时为其他平台添加一个非工作存根，并将结果交给其他平台的开发者填写存根。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-10T19:01:38.737

尝试过滤合并的另一种方法是将通用部分和特定于操作系统的部分拆分为两个存储库。然后，您可以将一个设置为另一个的子模块。是否将公共部分设置为操作系统特定部分的子模块，或者其他方式可能取决于大多数提交的去向。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T18:34:25.813

有一个选项可以忽略整个文件或目录结构，但是这些文件根本不会被添加到 repo 中。我想你已经知道了，通过使用`.gitignore`文件

正如你所说，我认为为 Windows 和 OS X 的代码有一个单独的分支。然后，您将通过`cherry-picking`来自其他分支的代码合并更改（语法为`git cherry-pick refspec`）但是，这些开发人员应始终注意其他操作系统分支上的“更改”。

我还建议始终对 中的文件进行单独的提交`main`，这样在您挑选分支时就不会混淆。

# c# - C# 中字段的顺序是否重要？

> ID：431203
> 
> 赞同：4
> 
> 时间：2009-01-10T16:06:25.613
> 
> 标签：c#, field, specifications

这个问题的灵感来自 Jon Skeet 的回答： [Is there ac# equivalent to c++'s access-modifier region](https://stackoverflow.com/questions/431091/is-there-a-c-equivalent-to-cs-access-modifier-regions#431105)

他评论说文件中字段的顺序可能很重要。我猜这与字段初始化的顺序有关，但我认为基于这种副作用进行编码是一件足够危险的事情，它需要自己的问题和讨论。

关于如何操纵代码文件中的字段顺序以及可能产生什么影响，是否还有其他想法？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-10T16:15:07.153

这是 C# 语言规范中的一个经典示例（第 10.5.5 节）

```
class Test
{
    static int a = b + 1;
    static int b = a + 1;
    static void Main() {
        Console.WriteLine("a = {0}, b = {1}", a, b);
    }
} 
```

这是一个完全有效的程序，如所写（a = 1，b =2）。但是，如果您交换字段的顺序，它们也会交换值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-10T16:08:26.590

是的，与非托管代码交互时确实很重要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-10T16:13:28.733

我主要是在考虑初始化的顺序，是的 - 特别是对于静态字段。例如（使用公共字段只是为了简化演示）：

```
using System;

class First
{
    static int a = 10;
    public static int b = CalculateB();
    static int c = 5;

    static int CalculateB()
    {
        return a*c;
    }
}

class Second
{
    static int a = 10;
    static int c = 5;
    public static int b = CalculateB();

    static int CalculateB()
    {
        return a*c;       
    }
}

class Test
{
    static void Main()
    {
        Console.WriteLine("First.b: {0}, Second.b: {1}",
                          First.b, Second.b);
    }
} 
```

初始化的顺序在规范中定义为声明变量的文本顺序 - 但是当两个变量位于对部分类有贡献的不同文件中时，它变得未定义。

[Mehrdad 的回答](https://stackoverflow.com/questions/431203/does-the-order-of-fields-in-c-matter#431212)是另一个好答案：任何对物理布局很重要的东西都很可能会受到声明顺序的影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T16:14:17.033

如果字段被初始化为声明的一部分，它们会按照它们在文件中出现的顺序添加到构造函数（实例或静态）中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-10T16:55:07.993

您可以使用（滥用？）字段顺序作为类的元数据，而不是通过反射读取。

例如，如果您有一个类表示具有字段 ID、PORT 和 XOR 的网络协议，按照该顺序，您可以将其定义为：

```
class MyProtocol {
    int ID;
    int PORT;
    int XOR;
} 
```

现在假设您使用反射来迭代协议的字段，以通过线路发送。GetProperties 返回的顺序将与您定义的一样，您不必显式编写任何额外的元数据。

不知道这是否是一个好主意，但依赖于此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T17:34:25.420

我相信 XmlSerializer 按照它们在源文件中出现的顺序对成员进行序列化。

# python - 如何以编程方式更改 Mac OS X 中的背景？

> ID：431205
> 
> 赞同：34
> 
> 时间：2009-01-10T16:06:48.483
> 
> 标签：python, image, macos

我将如何以编程方式更改 Mac OS X 中的桌面背景？我想使用 python，但我对任何可能的方式都感兴趣。我可以连接到终端并调用某个命令吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-10T16:38:06.453

在 python 中，如果你安装了[appscript](http://appscript.sourceforge.net/) ( `sudo easy_install appscript`)，你可以简单地做

```
from appscript import app, mactypes
app('Finder').desktop_picture.set(mactypes.File('/your/filename.jpg')) 
```

否则，这个applescript会改变桌面背景

```
tell application "Finder"
    set desktop picture to POSIX file "/your/filename.jpg"
end tell 
```

您可以使用 命令行 从命令行运行它，也可以[`osascript`](http://developer.apple.com/DOCUMENTATION/DARWIN/Reference/ManPages/man1/osascript.1.html)使用类似的东西从 Python运行它

```
import subprocess

SCRIPT = """/usr/bin/osascript<<END
tell application "Finder"
set desktop picture to POSIX file "%s"
end tell
END"""

def set_desktop_background(filename):
    subprocess.Popen(SCRIPT%filename, shell=True) 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-01-22T17:18:27.877

如果您正在为当前用户执行此操作，则可以从 shell 运行：

```
defaults write com.apple.desktop Background '{default = {ImageFilePath = "/Library/Desktop Pictures/Black & White/Lightning.jpg"; };}' 
```

或者，作为 root，对于另一个用户：

```
/usr/bin/defaults write /Users/joeuser/Library/Preferences/com.apple.desktop Background '{default = {ImageFilePath = "/Library/Desktop Pictures/Black & White/Lightning.jpg"; };}'
chown joeuser /Users/joeuser/Library/Preferences/com.apple.desktop.plist 
```

您当然会想要替换图像文件名和用户名。

新设置将在 Dock 启动时生效 - 无论是在登录时，还是在您

```
killall Dock 
```

[基于[其他地方的帖子](http://forums.macrumors.com/showpost.php?p=7237192&postcount=18)，并基于[马特米勒的回答](https://stackoverflow.com/questions/431205/how-can-i-programatically-change-the-background-in-mac-os-x/431273#431273)中的信息。]

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-07-18T20:17:05.377

我有同样的问题，*除了*我想更改*所有连接的显示器上的墙纸。*`appscript`这是一个使用（上面提到的； ）的 Python 脚本`sudo easy_install appscript`，它就是这样做的。

```
#!/usr/bin/python

from appscript import *
import argparse

def __main__():
  parser = argparse.ArgumentParser(description='Set desktop wallpaper.')
  parser.add_argument('file', type=file, help='File to use as wallpaper.')
  args = parser.parse_args()
  f = args.file
  se = app('System Events')
  desktops = se.desktops.display_name.get()
  for d in desktops:
    desk = se.desktops[its.display_name == d]
    desk.picture.set(mactypes.File(f.name))

__main__() 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-12-28T20:09:20.370

在[dF.'s answer 的](https://stackoverflow.com/a/431279/9008248)基础上，您可以在没有 Finder 的情况下使用 Apple Script 执行此操作，并且可以针对多个桌面执行此操作。

设置桌面壁纸`i`（桌面编号从 1 开始）：

```
tell application "System Events"
    set currDesktop to item i of desktop
    set currDesktop's picture to "image_path"
end tell 
```

这就是我最终做的事情（在 Python 中）：

```
SET_DESKTOP_IMAGE_WRAPPER = """/usr/bin/osascript<<END
tell application "System Events"
{}
end tell
END"""

SET_DESKTOP_IMAGE = """
set currDesktop to item {idx} of desktops
set currDesktop's picture to "{image_path}"
"""

def set_wallpapers(images):
    """ images is an array of file paths of desktops """

    script_contents = ""
    for i, img in enumerate(images):
        idx = i+1
        script_contents += SET_DESKTOP_IMAGE.format(idx=idx, image_path=img)

    script = SET_DESKTOP_IMAGE_WRAPPER.format(script_contents)
    subprocess.check_call(script, shell=True) 
```

有时，桌面图像不会立即出现。我不知道为什么会发生这种情况，但是重新启动扩展坞可以解决它。从 python 做到这一点：

```
subprocess.check_call("killall Dock", shell=True) 
```

顺便说一句，您可以使用以下 AppleScript 代码获取系统上的桌面数量：

```
tell application "System Events"
    get the number of desktops
end tell 
```

您可以使用它`subprocess.check_output`来获取输出

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-10T16:34:51.047

您可以按照本文所述调用“默认写入com.apple.Desktop Background ...”：http: [//thingsthatwork.net/index.php/2008/02/07/fun-with-os-x-defaults-并启动/](http://thingsthatwork.net/index.php/2008/02/07/fun-with-os-x-defaults-and-launchd/)

本文还介绍了编写脚本以自动运行，但第一个小点应该可以帮助您入门。

您可能还对默认手册页感兴趣：http: [//developer.apple.com/documentation/Darwin/Reference/ManPages/man1/defaults.1.html](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man1/defaults.1.html)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-10-13T04:15:12.753

小牛的单线解决方案是：

```
osascript -e 'tell application "Finder" to set desktop picture to POSIX file "/Library/Desktop Pictures/Earth Horizon.jpg"' 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-08-12T00:37:53.547

将以下内容放入您的 ~/.bashrc

```
function wallpaper() {
    wallpaper_script="tell application \"Finder\" to set desktop picture to POSIX file \"$HOME/$1\""
    osascript -e $wallpaper_script 
} 
```

像这样使用：

```
wallpaper /path/to/image.png 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-10T16:41:05.777

添加到[马特米勒的响应](https://stackoverflow.com/questions/431205/how-can-i-programatically-change-the-background-in-mac-os-x#431273)中：您可以使用[subprocess.call()](http://docs.python.org/library/subprocess.html#subprocess.call)执行 shell 命令，如下所示：

```
import subprocess
subprocess.call(["defaults", "write", "com.apple.Desktop", "background", ...]) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-05-14T15:52:14.910

有一个默认的高质量图像集合：

```
/Library/Desktop Pictures/ 
```

要在所有桌面上自动选择其中之一，而不依赖于第 3 方：

```
osascript -e 'tell application "System Events" to set picture of every desktop to "/Library/Desktop Pictures/Solid Colors/Stone.png"' 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-10T17:31:43.880

您也可以使用[py-appscript](http://sourceforge.net/projects/appscript)而不是 Popening osascript 或使用[ScriptingBridge](http://developer.apple.com/documentation/Cocoa/Conceptual/RubyPythonCocoa/Articles/UsingScriptingBridge.html)和 pyobjc，它包含在 10.5 中，但使用起来有点麻烦。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-02-13T19:05:16.593

以编程方式更改桌面墙纸的另一种方法是简单地将墙纸设置指向文件。使用您的程序用新设计覆盖文件，然后重新启动扩展坞：`killall Dock`.

以下内容依赖于 Xcode、lynx 和 wget，但这是我在 Mountain Lion 上自动下载和安装月度壁纸的方法（无耻窃取并改编自[http://ubuntuforums.org/showthread.php?t=1409827](http://ubuntuforums.org/showthread.php?t=1409827)）：

```
#!/bin/bash
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/opt/local/bin
size=1440
dest="/usr/local/share/backgrounds/wallpaperEAA.jpg"
read -r baseurl < <(lynx -nonumbers -listonly -dump 'http://www.eaa.org/en/eaa/aviation-education-and-resources/airplane-desktop-wallpaper' | grep $size) &&
wget -q "$baseurl" -O "$dest"
killall Dock 
```

把它倒进去`/etc/periodic/monthly/`，宝贝，你有炖菜了！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-02-19T06:24:43.363

您**无需** `killall Dock`从 Python 脚本运行 Swift 脚本即可做到这一点。

`chwall.swift`使用以下代码创建一个文件：

```
#!/usr/bin/env swift

import Cocoa

do {
    // get the main (currently active) screen
    if let screen = NSScreen.main {
        // get path to wallpaper file from first command line argument
        let url = URL(fileURLWithPath: CommandLine.arguments[1])
        // set the desktop wallpaper
        try NSWorkspace.shared.setDesktopImageURL(url, for: screen, options: [:])
    }
} catch {
    print(error)
} 
```

现在用Python运行上面的`chwall.swift`文件。`subprocess`

```
import subprocess

subprocess.run(["./chwall.swift", "/path/to/your/wallpaper/file.png"]) 
```

# c++ - 预定义的 IDL 文件中没有类型定义

> ID：431206
> 
> 赞同：0
> 
> 时间：2009-01-10T16:06:50.790
> 
> 标签：c++, idl, midl

首先，

使用**纯**C++，没有 ATL，MFC 试图使用 COM 对象接口。

使用**oleview** (OLE/COM Object viewer) - 用于设计 IDL 代码。

在这个阶段，使用**MIDL**编译器，现在我在尝试生成以下内容时遇到了麻烦：

cmd行上的语法：

midl /nologo /env win32 /tlb ".\S8_.tlb" /h ".\S8_.h" /iid ".\S8_i.c" S8.idl

*   对应的 .TLB（类型库）
*   A .H（标题）
*   IID 定义包含文件 (*_i.c)
*   代理 (*_p.c)

MIDL 编译器错误：

S8.IDL(513)：错误 MIDL2025：语法错误：期望“S8SimObject”附近的类型规范

```
 HRESULT LinkSimObjects(
                    [in] S8SimObject* SourceObject, ####line 513 ####
                    [in] S8SimObject* DestObject,
                    [in] float TravelTime); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T16:50:28.550

好吧，我在这里不太了解您的问题，但是以下内容应该会有所帮助：

*   公共枚举定义需要有自己的*uuid*才能真正公开。
*   我已经看到这些枚举定义不会进入类型库，除非它们实际用于某些接口方法。我不知道这是什么原因，可能我错过了一些简单的事情（比如将该枚举添加到库块中，或者其他什么）。
*   `short`通常表示一个短整数，而不是单精度浮点数。
*   在 VB 中相当于`float`is `single`，但正如我在您的其他问题上看到的那样，我怀疑您实际上的意思是`single`用`float`.

顺便说一句，我建议发布一个最小的（可编译的）IDL 文件（去除大多数定义），它或多或少类似于您要编译的内容。这有助于避免一些混淆，例如`IS8Simulation`，您在文本中使用，但`S8SimObject`在复制的 IDL 片段中使用。如果您指定预期的结果和意外的（对您而言）错误，它也会有所帮助。

**编辑**

好吧，您现在插入的这个编译错误很简单：`S8SimObject`未定义。您需要始终在方法声明 ( `IS8Simulation`) 中引用接口，而不是实现接口的 coclass。

正如您所说，您正在更改现有的 IDL 文件：基本目标是什么？如果原始 IDL 文件总是使用`S8SimObject`，也许唯一的问题是`S8SimObject`IDL 文件顶部没有包含 的定义？如果你已经定义了类型库`S8SimObject`，你可以使用 OleView 导出这个接口的 IDL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T22:42:50.460

# MIDL 编译器错误

S8.IDL(513)：**错误 MIDL2025**：语法错误：期望**“S8SimObject”附近的类型规范**

## 解决了

添加**前向声明**- 在 IDL 文件的顶部：

*   导入“ocidl.idl”；
*   接口 S8SimObject；

# php - 选择在网页上使用的随机记录

> ID：431208
> 
> 赞同：1
> 
> 时间：2009-01-10T16:07:40.883
> 
> 标签：php, mysql, web

嗨，大家好，

我拥有一个网站 我有一个名为“移动部分”的部分，该部分包含许多类别（对象名称 + 图片 + 小描述和下载链接） 现在该部分被视为内部部分。我想查看第一页上该部分的随机记录（我不知道喜欢 RSS，但不知道 Rss）显示对象的名称以及它所属的子类别及其图片（如果可能）。我希望任何人都明白我想说什么。

这是我的网站，这是内部页面的链接，[这里](http://www.sy-stu.com/stu/prog.php?PHPSESSID=249686f422aa4d8b1d06afaf44d7eee6)[检查](http://www.sy-stu.com)说移动部分的块它有点乱。是否有任何脚本或技术可以以正确的方式查看它，如果可能，请向我展示示例

我正在使用 php 和 MySQL

提前感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T21:27:29.817

无论你做什么，都不要在 MySQL 中使用 ORDER BY RAND()。它不会扩展。是的，由于数据集很小，它似乎对少量行工作正常。ORDER BY RAND() 需要全表扫描，这意味着您的表越大，查询所需的时间就越长。这将表现为“哎呀，网站似乎变慢了”......越来越慢......越来越慢......

如果您有一个 id 列恰好是一个整数并充当主键，那么您可以在查询之前在 PHP 中生成最大值，因为您实际上使用的是索引，所以它会快得多。

示例可能类似于：

```
$random_row_id = rand(1, $max); 
```

接着...

```
SELECT * FROM foo WHERE id = $random_row_id 
```

您必须弄清楚如何获得 $max，但很可能您只能获取最后一行 id。

这里需要注意的一点是，如果您从表中删除了记录，您将有“漏洞”，您可能会在其中要求不再存在的行。在这种情况下，您可以继续探测直到找到匹配项——它仍然比全表扫描快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T18:43:53.173

这个想法有点像大卫·托马斯·加西亚的抢断。你可以做的是在你的数据库中实现一个字段来跟踪产品的视图（或者你可以避开这个并只跟踪购买），你可以从你的数据库中选择项目作为“畅销产品”或“热销”产品”然后显示在您的网站上。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-10T16:25:49.457

你真的希望它是随机的吗？很高兴在主页上最受欢迎，并且可能对您的访问者更有用和信息更丰富。

也就是说，在 Microsoft SQL 中编写一个方法来做到这一点真的很容易：

```
SELECT TOP 1 Name, Picture, Description, Link
FROM Software
WHERE Category = 'Mobile Section'
ORDER BY NEWID() 
```

如果您不使用 Microsoft SQL，这里是一个包含许多数据库[的随机选择器的站点。](http://www.petefreitag.com/item/466.cfm)

# coding-style - C++ 中初始化列表后的大括号放置

> ID：431217
> 
> 赞同：1
> 
> 时间：2009-01-10T16:10:13.203
> 
> 标签：coding-style

对于任何这样放置牙套的人：

```
void f() {
    stuff();
} 
```

您更喜欢如何在长初始化列表之后放置大括号？
一样的方法？

```
Object::Object()
    : foo(1)
    , bar(2) {
    stuff();
} 
```

或者做一个例外，以便您真正看到初始化列表的结束位置？

```
Object::Object()
    : foo(1)
    , bar(2)
{
    stuff();
} 
```

还是留一个空行？

```
Object::Object()
    : foo(1)
    , bar(2) {

    stuff();
} 
```

或者也许制造一个奇怪的混合体？

```
Object::Object()
    : foo(1)
    , bar(2)
    {
    stuff();
} 
```

或滥用缩进

```
Object::Object()
: foo(1)
, bar(2) {
    stuff();
}

Object::Object() : foo(1)
                            , bar(2) {
    stuff();
} 
```

在这个小例子中，所有的东西都很漂亮，但有十几个初始化器和一个中等长度的函数体，这很快就会改变。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-10T16:16:04.983

能够检测 ctor-initializer 列表开始/结束的位置以及代码块开始/结束的位置似乎很重要。

```
Object::Object ()
  : foo (1)
  , bar (2)
{
  ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T16:21:33.787

我喜欢同时在屏幕上显示尽可能多的代码，这样我的眼睛就可以在尽可能少的滚动的情况下来回跳跃。当然，有一个限制。一旦我开始需要在一条线上过于努力地寻找某些东西，我就达到了收益递减的地步。如果我没有初始化超过 3 或 4 个字段，我通常会这样做。

```
Object::Object() : foo(1), bar(2) {
    stuff();
} 
```

如果我需要初始化很多字段，它往往看起来像这样。

```
Object::Object() : foo(1), 
                   bar(2),
                   baz(3) {
    stuff();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T21:22:43.400

我将左大括号放在新行上。结果看起来很像第二个示例，但没有初始化器的缩进。

也就是说，由于这似乎是 C++ 中在实践中具有最广泛布局的部分，所以我个人已经回到在构造函数中初始化变量（仍然有效）以避免冒犯任何人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T21:47:24.300

我承认我做的很多事情在全球范围内都不一致，这意味着我没有一个全局大括号方法，相反，每种语言结构都可能有自己的大括号方法，我一直使用它。

```
 function()
 {
 }

 control-flow () {
 } else {
 }

 type name {
 }; 
```

作为构造函数是一个函数......

```
 foo::foo()
  : bar(1)
  , baz(2)
 {
 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-10T16:17:56.667

我猜想大多数开发人员都喜欢与他们的括号格式保持一致，以及他们在其余代码中的使用方式。阅读不是您自己风格的括号格式已经够难了。尝试破译混合格式会使不熟悉您的代码的人更难以阅读您的程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T23:17:26.240

这是我的风格：

```
Object::Object()
        : foo(1),
          bar(2) {

    // First line here.
} 
```

它与我的括号样式保持一致，但也在初始化程序和代码之间建立了视觉分离。

# ruby-on-rails - 之间使用时的奇怪行为？日期方法

> ID：431230
> 
> 赞同：3
> 
> 时间：2009-01-10T16:17:38.303
> 
> 标签：ruby-on-rails, ruby, date

打开 Rails 控制台并输入：

```
2.weeks.ago.between? 2.weeks.ago, 1.week.ago 
```

它给你的是真的还是假的？不，真的，多试几次，它会给你不同的答案。

现在，我在想，因为我们将 2.weeks.ago 与 2.weeks.ago 进行比较，所以评估这两个语句之间的时间导致了这种行为。

我不能肯定地说，但我猜这两者之间？方法不包含在内，因此如果两个语句之间经过了几毫秒，上面的代码将评估为真，因为它将在两个比较日期之间。

但是，如果 CPU 设法处理得足够快，以至于经过的时间可以忽略，那么它将评估为假。

任何人都可以对此有所了解吗？在一个可能很关键的系统中，这充其量只是一个边缘情况，但是当我的测试通过并看似随机失败时，这让我很头疼。

奇怪的是，在执行以下操作时不会发生这种情况：

```
 Date.yesterday.between? Date.yesterday, Date.tomorrow 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-10T16:39:45.687

原因无疑是由于时间函数的分辨率。有时 2.weeks.ago 的两个实例会同时解析，有时则不会。当您昨天使用时，您看不到问题，因为它总是解决为零小时而不是相对于当前时间。

在像您这样的情况下，您可能只想比较日期，而不是日期和时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T17:11:11.660

tvanfosson，击中它的头部。

`2.weeks.ago`为您提供从执行到毫秒的准确时间两周。因此，对其进行两次评估可以提供两个不同的时间。

执行以下操作将为您提供一致的结果：

```
two_weeks_ago = 2.weeks.ago
two_weeks_ago.between? two_weeks_ago, 1.week.ago

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T18:33:07.673

我刚试过这个，每次都错了。这个问题背后的意图是什么？我问 b/c 我在数据库级别进行这样的日期比较。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T18:37:04.387

绝对是由于 thwt 2.weeks.ago 被调用了两次，由于处理时间的原因，每次都返回不同的响应。但是有没有关系。between 函数完全按预期工作。这种行为并不奇怪，因为如果您使用调试器进入代码，您会看到它完全按照应有的方式运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T12:43:35.397

尝试做：

```
two_weeks_ago = 2.weeks.ago.to_date
two_weeks_ago.between? two_weeks_ago, 1.week.ago 
```

# c# - Cassini 错误：“未提供此类页面”

> ID：431233
> 
> 赞同：0
> 
> 时间：2009-01-10T16:18:21.733
> 
> 标签：c#, cassini

我正在尝试使用 Cassini 的 Server 类在我自己的应用程序中包含一个基本的 Web 服务器。我刚开始使用它来熟悉服务器的工作方式，并设置了一个简单的应用程序，如下所示：

```
 static void Main(string[] args)
    {
        Server server = new Server(80, "/", @"C:\Projects\");
        server.Start();
        Console.ReadLine();
        server.Stop();
    } 
```

它允许我浏览目录，但是如果我尝试单击文件，例如 C# 源文件 (*.cs)，则会出现以下错误：

> “/”应用程序中的服务器错误。
> 
> 不提供此类页面。
> 
> 说明：您请求的页面类型未提供服务，因为它已被明确禁止。扩展名“.cs”可能不正确。
> 请查看下面的 URL 并确保其拼写正确。

我尝试在 Cassini 库中搜索该错误文本，但没有找到任何内容。

这个错误来自哪里？我怎样才能让它提供任何文件？我知道它是用来做 asp.net 和 HTML 的，但我希望它也像普通服务器一样服务器化任何文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T16:56:58.740

`.cs`文件和许多源代码类型被阻止呈现，因为它们由 ASP.NET 的禁止文件处理程序处理。

这最初是在主 web.config 中的以下设置中配置的`c:\windows\microsoft.net\v2.0.50727\CONFIG\web.config`：

在该部分中查找`<httpHandlers>`，您会看到如下设置：

```
<add path="*.cs" verb="*" type="System.Web.HttpForbiddenHandler" validate="True"/> 
```

通常这是一个好主意，因为它可以防止随意浏览可能包含敏感数据（如连接字符串）的源代码。

您应该能够通过执行以下操作在应用的本地 web.config 中删除此限制：

```
<configuration>
   <system.web>
      <httpHandlers>
         <remove verb="*" path="*.cs"/>
      </httpHandlers>
   </system.web>
</configuration> 
```

I probably wouldn't recommend doing this on a web facing production environment.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-05T04:19:42.743

Downloading and installing the MS ASP.Net Web Pages worked for me.

[http://www.microsoft.com/download/en/details.aspx?id=15979](http://www.microsoft.com/download/en/details.aspx?id=15979)

S.

# objective-c - 什么是“中止陷阱”以及如何调试它？

> ID：431235
> 
> 赞同：7
> 
> 时间：2009-01-10T16:20:16.647
> 
> 标签：objective-c, debugging

每次编译我的项目时，我都会收到此消息：

```
RunIPhoneUnitTest.sh: line 92: 31389 Abort trap              "$TARGET_BUILD_DIR/$EXECUTABLE_PATH" -RegisterForSystemEvents 
```

我知道这是我的代码中的一个问题，但是我不知道如何解决或找到它。

奇怪的是，我通过这个电话得到了这个：

```
-- This is the interface
@interface DbObject : NSObject {
    NSInteger Id;
    NSDate* timeStamp;
}

@property (nonatomic) NSInteger Id;
@property (nonatomic, retain) NSDate *timeStamp;
----
This fail with above error
----
NSString * filter = [NSString stringWithFormat:"id = %@", ds.Id, nil]; 
```

但最重要的是，我删除了那条线，那个方法，仍然得到它！让我发疯。

目前，我正在考虑删除代码，直到没有出现错误并开始添加它，但想知道是否存在更实用的解决方案......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-10T16:45:20.557

中止陷阱通常意味着在某处调用了中止。这很可能发生，因为您的单元测试工具代码抛出了一个它没有预料到的异常，并且只是通过调用 abort(3) 来处理它。中止调用不是很容易调试，因为它不提供有关谁调用它或为什么调用它的信息，从不返回并生成一个 SIGABRT。您可以为 SIGABRT 安装一个新的处理程序并在那里放置一个断点，然后至少检查当前的调用堆栈......但请阅读其余部分以了解为什么会首先发生这种情况。

但是，上面代码的问题在于 NSInteger 不是对象类型，它是常规原语。要更正您的错误，请将失败的行替换为：

```
NSString *filter = [NSString stringWithFormat:@"id = %lld", (long long)ds.Id]; 
```

首先，`stringWithFormat`将一个`NSString`对象作为参数，因此需要使用'@'字符来指定字符串字面量是一个NSString。这非常重要，因为`@"blah blah"`它实际上被翻译成一个对象。您正在进行的调用`stringWithFormat`是期望 NSString 对象信息驻留在该内存地址，但相反，它得到的是字符串，并且很可能在那里爆炸。确保所有字符串文字都`@"blah blah"`在预期的 NSString 类型的位置，并且它们不是简单的 c 字符串。

其次，格式字符串中的“@”字符指定了一个对象。由于 NSInteger 不是对象，因此不能使用此格式字符。而是使用 %lld 指定一个 long long 整数。最后，使用时不需要`nil`在参数列表的末尾添加 ，`stringWithFormat`因为格式字符串本身指定了预期的参数数量。

顺便说一句，使用它的原因`%lld`不仅仅是`%d`NSInteger 会根据您是针对 32 位还是 64 位目标进行编译而改变大小。通过将 NSInteger 提升为`long long`类型并使用说明`%lld`符，您可以确保如果您编译为 64 位并且您的 NSInteger 值需要超过 32 位来存储，则将来不会出现截断问题。

# visual-studio - 如果您的构建在 Visual Studio 中花费的时间过长，则最佳做法

> ID：431249
> 
> 赞同：22
> 
> 时间：2009-01-10T16:25:55.493
> 
> 标签：visual-studio, language-agnostic

我在 Visual Studio 中有中等大小的解决方案，构建大约需要 5 分钟（由于 FxCop 和其他后期构建步骤，它需要很长时间）。我的问题是，Visual Studio 在构建时停止响应。您无法继续工作，因为 VS 几乎挂起。我尝试使用两个 VS 实例，仅使用一个进行构建，但它时不时地崩溃。

我的问题是，如何不浪费时间查看 Visual Studio 构建您的大型/中型项目。有没有这方面的最佳实践？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-01-10T16:27:59.623

![](https://imgs.xkcd.com/comics/compiling.png "“你在偷那些液晶显示器吗？”  “是的，但我是在我的代码编译时这样做的。”")

[来源](http://xkcd.com/303/)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-10T16:31:07.730

我昨天刚学到的两个优秀的 MSBuild 技巧......

您可以使用 /m:n 开关并行运行任务，其中 n 是要使用的处理器数。您所要做的就是在您的 MSBuild 任务上设置[BuildInParallel 。](http://msdn.microsoft.com/en-us/library/bb651793.aspx)

另一个技巧是，如果您有多个 <exec /> 任务要运行，您实际上也可以通过在每个命令之间使用管道字符调用 <exec command="sleep 10|sleep 10|sleep 20" /> 来并行运行它们. 一个更实际的例子：

```
<CreateItem Include="server1;server2;server3;server2">
  <Output ItemName="IISServer" TaskParameter="Include"/>
</CreateItem>
<CreateProperty Value="@(IISServer->'iisreset.exe /start %(Identity)', '|')">
  <Output TaskParameter="Value" PropertyName="IISServerStartAll" />
</CreateProperty>
<exec command="$(IISServerStartAll)" /> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-10T16:31:47.357

1.  您当然不需要在每次构建解决方案时都运行静态代码分析。
2.  通过合并一些项目来减少项目数量也有很大帮助。

您还执行了哪些其他后期构建任务？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-10T08:42:24.613

如果您拥有多台计算机或将此程序设置给工作中的其他朋友，请使用 Incredibuild。它易于设置和使用。加速对于编译是线性的。

它也适用于多核 cpu，因为通常与为一个项目使用一个内核相比，但 incredibuild 使其对每个 .cpp 文件都并行...

试试看.. :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-10T16:32:57.617

您可以考虑使用 MSBuild 的专用构建机器。从那里，您可以在编译时继续工作。但是，当您引入网络问题时，它确实使它变得更加复杂。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-10T16:33:45.043

您可以通过对编译代码所需的类进行存根来在另一个项目中创建类。这样，您可以测试和记录您的新代码。在此之后，您只需将其包含到实际项目中并“真正地”编译。到它编译时，您已经在处理项目的另一个片段，因为您有 95% 的情况下它会成功编译。或者，在它编译时，您还可以编写单元测试。

# c# - 解析 Quickbook IIF 格式文件

> ID：431254
> 
> 赞同：2
> 
> 时间：2009-01-10T16:27:57.253
> 
> 标签：c#, parsing, io, text-parsing, fileparsing

我正在使用 Quickbook 的 IIF 文件格式，我需要编写一个解析器来读取和写入 IIF 文件，并且在读取文件时遇到了一些问题。

这些文件很简单，它们是制表符分隔的。每一行要么是一个表定义，要么是一行。定义以“！”开头 和表名，行仅以表名开头。这是我遇到的问题：某些字段允许换行。

当我第一次遇到这个问题时，我想，好吧，只需逐个标签而不是逐行解析它，但要做到这一点，我必须用制表符替换换行符，并得到比列更多的值，但我发现用换行符分散在太多列中的值。

你将如何解析这样的文件？

编辑：一个例子

```
!CUST   NAME    REFNUM  TIMESTAMP   BADDR1  BADDR2  BADDR3  BADDR4  BADDR5  SADDR1  SADDR2  SADDR3  SADDR4  SADDR5  PHONE1  PHONE2  FAXNUM  CONT1   CONT2   CTYPE   TERMS   TAXABLE LIMIT   RESALENUM   REP TAXITEM NOTEPAD SALUTATION  COMPANYNAME FIRSTNAME   MIDINIT LASTNAME    CUSTFLD1    CUSTFLD2    CUSTFLD3    CUSTFLD4    CUSTFLD5    CUSTFLD6    CUSTFLD7    CUSTFLD8    CUSTFLD9    CUSTFLD10   CUSTFLD11   CUSTFLD12   CUSTFLD13   CUSTFLD14   CUSTFLD15   JOBDESC JOBTYPE JOBSTATUS   JOBSTART    JOBPROJEND  JOBEND  HIDDEN  DELCOUNT
CUST    St. Mark    359 1176670332  Saint Mark Catholic Church  609 W Main St   City, State Zip 
!CLASS  NAME    REFNUM  TIMESTAMP   HIDDEN  DELCOUNT
!INVITEM    NAME    REFNUM  TIMESTAMP   INVITEMTYPE DESC    PURCHASEDESC    ACCNT   ASSETACCNT  COGSACCNT   QNTY    QNTY    PRICE   COST    TAXABLE PAYMETH TAXVEND TAXDIST PREFVEND    REORDERPOINT    EXTRA   CUSTFLD1    CUSTFLD2    CUSTFLD3    CUSTFLD4    CUSTFLD5    DEP_TYPE    ISPASSEDTHRU    HIDDEN  DELCOUNT    USEID
INVITEM Labor   1   1119915308  SERV    Labor                                                                                               0
!TIMEACT    DATE    JOB EMP ITEM    PITEM   DURATION    PROJ    NOTE    XFERTOPAYROLL   BILLINGSTATUS
TIMEACT 3/8/08  876 Development Jane Doe {Consultant}   Labor       00:15       Renewing all domain name for 876 Development.
REIMBURSEMENT: 44.72 for one year renewal on all domain names.  N   1
TIMEACT 3/17/08 Greg:Bridge Jane Doe {Consultant}   Labor       01:00       Preparing Studio    N   1
TIMEACT 3/17/08 John Doe and Associates Jane Doe {Consultant}   Labor       00:06       REIMBURSEMENT: Toner cartridge on ebay & Fuser from FastPrinters- ask wendell before invoicing to see if this fixed the problem
49.99 (include tax) toner
$175.18 (include tax) fuser
    N   1
TIMEACT 3/17/08 John Doe II Jane Doe {Consultant}   Labor       01:00       Fixing Kandis's computer - replaced entire computer with similar system N   1 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T17:52:38.893

我做到了：

```
 public DataSet parseIIF(Stream file) {
            iifSet = new DataSet();
            String fileText;

            using (StreamReader sr = new StreamReader(file)) {
                fileText = sr.ReadToEnd();
            }
            //replace line breaks with tabs
            //fileText.Replace('\n', '\t');
            fileText = fileText.Replace("\r\n", "\n");
            fileText = fileText.Replace('\r', '\n');

            //split along tabs
            string[] lines = fileText.Split('\n');

            this.createTables(lines, iifSet);
            this.fillSet(lines, iifSet);

            return iifSet;
        }

        /// <summary>
        /// Reads an array of lines and parses them into tables for the dataset
        /// </summary>
        /// <param name="lines">String Array of lines from the iif file</param>
        /// <param name="iifSet">DataSet to be manipulated</param>
        private void fillSet(string[] lines, DataSet set) {
            //CODING HORROR
            //WARNING: I will monkey with the for loop index, be prepared!
            for (int i = 0; i < lines.Length; i++) {
                if (this.isTableHeader(lines[i])) {
                    //ignore this line, tables are alread defined
                    continue;
                }
                if (lines[i] == "" || lines[i] == "\r" || lines[i] == "\n\r" || lines[i] == "\n") {
                    //ignore lines that are empty if not inside a record
                    //probably the end of the file, it always ends with a blank line break
                    continue;
                }

                if (lines[i].IndexOf(";__IMPORTED__") != -1) {
                    continue;
                    //just signifying that it's been imported by quickbook's timer before, don't need it
                }

                string line = lines[i];
                while (!isFullLine(line, set)){
                    i++;            //<--------------------------- MONKEYING done here!
                    line += lines[i];       
                }
                //now, the line should be complete, we can parse it by tabs now
                this.parseRecord(line, set);
            }
        }

        private void parseRecord(string line, DataSet set) {
            if (isTableHeader(line)) {
                //we don't want to deal with headers here
                return;
            }

            String tablename = line.Split('\t')[0];
            //this just removes the first value and the line break from the last value
            String[] parameters = this.createDataRowParams(line);

            //add it to the dataset
            set.Tables[tablename].Rows.Add(parameters);
        }

        private bool isFullLine(string line, DataSet set) {
            if (isTableHeader(line)) {
                return true;    //assumes table headers won't have line breaks
            }
            int values = line.Split('\t').Length;
            string tableName = line.Split('\t')[0];
            int columns = set.Tables[tableName].Columns.Count;

            if (values < columns) {
                return false;
            } else {
                return true;
            }
        }

        private void createTables(string[] lines, DataSet set) {
            for (int index = 0; index < lines.Length; index++) {
                if (this.isTableHeader(lines[index])) {
                    set.Tables.Add(createTable(lines[index]));
                }
            }
        }

        private bool isTableHeader(string tab) {
            if (tab.StartsWith("!"))
                return true;
            else
                return false;
        }

        private bool isNewLine(string p) {
            if (p.StartsWith("!"))
                return true;
            if (iifSet.Tables[p.Split('\t')[0]] != null)    //that little mess there grabs the first record in the line, sorry about the mess
                return true;
            return false;
        }

    private DataTable createTable(string line) {
        String[] values = line.Split('\t');

        //first value is always the title
        //remove the ! from it
        values[0] = values[0].Substring(1);     //remove the first character
        DataTable dt = new DataTable(values[0]);
        values[0] = null;   //hide first title so it doesn't get used, cheaper than resetting array
        foreach (String name in values) {
            if (name == null || name == "")
                continue;
            DataColumn dc = new DataColumn(name, typeof(String));
            try {
                dt.Columns.Add(dc);
            } catch (DuplicateNameException) {
                //odd
                dc = new DataColumn(name + "_duplicateCol" + dt.Columns.Count.ToString());
                dt.Columns.Add(dc);
                //if there is a triple, just throw it
            }
        }

        return dt;
    }

   private string getTableName(string line) {
        String[] values = line.Split('\t');

        //first value is always the title
        if(values[0].StartsWith("!")){
            //remove the ! from it
            values[0] = values[0].Substring(1);     //remove the first character
        }
        return values[0];
    }

    private string[] createDataRowParams(string line) {
        string[] raw = line.Split('\t');
        string[] values = new string[raw.Length - 1];

        //copy all values except the first one
        for (int i = 0; i < values.Length; i++) {
            values[i] = raw[i + 1];
        }

        //remove last line break from the record
        if (values[values.Length - 1].EndsWith("\n")) {
            values[values.Length - 1] = values[values.Length - 1].Substring(0, values[values.Length - 1].LastIndexOf('\n'));
        } else if (values[values.Length - 1].EndsWith("\n\r")) {
            values[values.Length - 1] = values[values.Length - 1].Substring(0, values[values.Length - 1].LastIndexOf("\n\r"));
        } else if (values[values.Length - 1].EndsWith("\r")) {
            values[values.Length - 1] = values[values.Length - 1].Substring(0, values[values.Length - 1].LastIndexOf('\r'));
        }

        return values;
    }

    private string[] createDataRowParams(string line, int max) {
        string[] raw = line.Split('\t');

        int length = raw.Length - 1;
        if (length > max) {
            length = max;
        }

        string[] values = new string[length];
        for (int i = 0; i < length; i++) {
            values[i] = raw[i + 1];
        }

        if (values[values.Length - 1].EndsWith("\n")) {
            values[values.Length - 1] = values[values.Length - 1].Substring(0, values[values.Length - 1].LastIndexOf('\n'));
        } else if (values[values.Length - 1].EndsWith("\n\r")) {
            values[values.Length - 1] = values[values.Length - 1].Substring(0, values[values.Length - 1].LastIndexOf("\n\r"));
        } else if (values[values.Length - 1].EndsWith("\r")) {
            values[values.Length - 1] = values[values.Length - 1].Substring(0, values[values.Length - 1].LastIndexOf('\r'));
        }

        return values;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T17:29:59.093

自从我完成 IIF 以来已经有一段时间了，但除非他们修复了它，否则 QuickBooks 无论如何都会在这些换行符上吐槽。似乎[这些人](http://getmytime.com/faq.asp#atq7)有同样的问题，他们用空格来处理它。

就我个人而言，我倾向于使用管道或其他可以清楚地描绘 QuickBooks 中的换行符的东西。如果您绝对肯定必须有换行符，请加入[Intuit 开发人员网络](http://developer.intuit.com/)，并在您的程序导入这些值后使用 SDK 将这些值发送给 QB。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T16:31:45.467

为什么不用空格而不是制表符替换换行符？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T17:49:36.903

我经常遇到这种事情。在进行解析时处理这种特殊情况的关键是用文本中极不可能出现的东西替换特殊情况，然后在完成后再次替换它。

例如，输出中有换行符，可以使用正则表达式轻松检测到。使用 Regex.Replace 将它们转换为类似***LINEBREAK***的东西。让它在编辑器中脱颖而出以进行调试。然后像往常一样进行其余的解析，最后一步，用原始值（或新值）替换特殊标记。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T14:06:03.697

想法：

1.  预处理您的文件，用一些高 ascii 字符替换换行符（假设它是单个 CR 或 LF）。然后按标签解析，最后用换行符替换所说的高ASCII。

2.  不是逐行处理，而是逐个字符处理。请注意，仅当嵌入的换行符与记录末尾的标准 CRLF 有所不同时，这仍然有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-09T21:57:46.397

我在 CodePlex 上找到了这个。您可以使用 nugget 包获取它。 [https://qif.codeplex.com/](https://qif.codeplex.com/)

我对其进行了测试，并且能够读写快速书格式。

# c - C、HTTP 1.1 和 Socket 发送的烦恼

> ID：431281
> 
> 赞同：2
> 
> 时间：2009-01-10T16:39:20.367
> 
> 标签：c, http, sockets, unix

作为我之前关于[用纯 C 创建 Web 服务器的](https://stackoverflow.com/questions/409087/creating-a-web-server-in-pure-c)帖子的补充，我在发送功能方面遇到了一些问题。这是两个代码片段：

```
int Send(char *message)
{
        int length, bytes_sent;
        length = strlen(message);

        bytes_sent = send(connecting_socket, message, length, 0);

        return bytes_sent;
} 
```

此代码将 void * 发送到当前套接字。奇迹般有效！

现在来了 SendHTML

```
void SendHTML(char *Status_code, char *Content_Type, char *HTML)
{
        char *head = "\r\nHTTP/1.1 ";
        char *content_head = "\r\nContent-Type: ";
        char *server_head = "\r\nServer: PT06";
        char *length_head = "\r\nContent-Length: ";
        char *date_head = "\r\nDate: ";
        char *newline = "\r\n";
        char Content_Length[100];
        int content_length = strlen(HTML);

        sprintf(Content_Length, "%i", content_length);

        char *message = malloc((
                strlen(head) +
                strlen(content_head) +
                strlen(server_head) +
                strlen(length_head) +
                strlen(date_head) +
                strlen(newline) +
                strlen(Status_code) +
                strlen(Content_Type) +
                strlen(Content_Length) +
                content_length +
                sizeof(char)) * 2);

        if ( message != NULL )
        {
                time_t rawtime;

                time ( &rawtime );

                strcpy(message, head);

                strcat(message, Status_code);

                strcat(message, content_head);
                strcat(message, Content_Type);
                strcat(message, server_head);
                strcat(message, length_head);
                strcat(message, Content_Length);
                strcat(message, date_head);
                strcat(message, (char*)ctime(&rawtime));
                strcat(message, newline);
                strcat(message, HTML);

                Send(message);

                free(message);
        }     
} 
```

如果我要添加

```
Send("Oh end of HTML Sending eh?"); 
```

after`Send(message)`和 before `free(message)`，这不是发送到浏览器吗？

我认为这可能是 HTTP 1.1 问题，RFC 是否说我只能发送一次？浏览器收到第一条消息后是否关闭连接？

我该如何解决这个问题，以便我可以执行以下操作：

```
SendHTML("200 OK", "text/plain", "HAaaaii!!");
Send("lolwut?"); 
```

这应该会导致浏览器显示：

> 哈啊啊！！呸呸呸？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T16:44:02.760

由于您要发送内容长度，因此浏览器在“HAaaaii!!”之后将不再接受任何内容 因此将解释“lolwut”？作为其下一个请求的答案的一部分，这当然会失败。

您可以跳过发送内容长度，但这意味着您没有使用 keep-alive，因此每个 TCP 连接不能处理多个请求。

每个 TCP 连接处理多个请求-响应交换可以大大加快浏览速度，因为一个正常的网页由几个单独的资源组成，每个资源都必须单独请求。而且由于建立 TCP 连接至少需要 3 次往返，这将为每个资源增加额外的、不必要的延迟。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-10T16:44:42.947

在您的`head`变量中，不应该有前导`"\r\n"`。这可能是导致问题的原因。此外，当您分配消息时，您没有为日期+时间保留足够的空间（根据文档为 26 个字节`ctime(3)`），因此您几乎肯定会覆盖缓冲区并导致堆损坏。

如果您想在知道 Content-Length 是什么之前开始发送数据，则可以改用[分块传输编码](https://www.rfc-editor.org/rfc/rfc2616#section-3.6.1)。分块传输编码说，“我将继续以块的形式给你一堆数据，我可以告诉你每个块有多长，但在我完成之前我不知道有多少块。 " 例如，Google 使用分块传输编码。[下面是使用cURL](http://curl.haxx.se/)生成的对 Google 主页的 HTTP 请求的跟踪：

```
curl www.google.com --trace-ascii - 
```

（标头被剪断——但没有 Content-Length 标头）

数据流由块大小（十六进制）后跟 CRLF，然后是数据字节组成。在这种情况下，只有一大块，但很容易有更多。在最后一个块之后，传输一个大小为 0 的块，表示最后一个块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T16:46:06.483

您是否在每个标题后添加换行符？

当然，您可以使用 telnet 测试您的应用程序并查看输出。

不，不需要只发送一次。假设流式传输 2GB 文件。这根本不合逻辑。

# .net - 如何在 ASP.NET 中获得更多控制权？

> ID：431296
> 
> 赞同：124
> 
> 时间：2009-01-10T16:44:24.943
> 
> 标签：.net, asp.net, .net-3.5, viewstate

我正在尝试构建一个非常非常简单的“微型网络应用程序”，如果我完成它，我怀疑一些 Stack Overflow 的人会对它感兴趣。我将它托管在我的 C# in Depth 站点上，它是 vanilla ASP.NET 3.5（即不是 MVC）。

流程非常简单：

*   如果用户使用未指定所有参数的 URL 输入应用程序（或者如果其中任何参数无效），我只想显示用户输入控件。（只有两个。）
*   如果用户使用包含所有必需参数的 URL 进入应用程序*，*我想显示结果*和*输入控件（以便他们可以更改参数）

这是我自己提出的要求（设计和实现的混合）：

*   我希望提交使用 GET 而不是 POST，主要是为了让用户可以轻松地为页面添加书签。
*   我*不*希望 URL 在提交后看起来很傻，上面有多余的点点滴滴。请仅提供主 URL 和实际参数。
*   理想情况下，我想完全避免需要 JavaScript。在这个应用程序中没有充分的理由。
*   我希望能够在渲染期间访问控件并设置值等。特别是，如果 ASP.NET 无法自动执行此操作，我希望能够将控件的默认值设置为传入的参数值对我来说（在其他限制范围内）。
*   我很高兴自己完成所有参数验证，而且我不需要太多服务器端事件的方式。在页面加载时设置所有内容而不是将事件附加到按钮等非常简单。

大部分都可以，但我还没有找到*完全*删除视图状态并保留其余有用功能的任何方法。使用[这篇博文中的帖子](http://aspnyc.blogspot.com/2007/10/how-to-completely-disable-viewstate.html)，我设法避免获得视图状态的任何实际*值*- 但它仍然最终作为 URL 上的参数，看起来非常难看。

如果我将其设为纯 HTML 表单而不是 ASP.NET 表单（即取出`runat="server"`），那么我不会得到任何神奇的视图状态 - 但是我无法以编程方式访问控件。

我*可以*通过忽略大部分 ASP.NET 并使用 LINQ to XML 构建 XML 文档并实现`IHttpHandler`. 不过感觉水平有点低。

我意识到我的问题可以通过放松我的约束（例如使用 POST 并且不关心剩余参数）或使用 ASP.NET MVC 来解决，但是我的要求真的不合理吗？

也许 ASP.NET 并没有*缩小*到这种应用程序？不过，有一个很可能的选择：我只是愚蠢，而且有一种非常简单的方法可以做到，我只是还没有找到。

有什么想法，有人吗？（关于强者如何倒下的提示评论等。这很好 - 我希望我从未声称自己是 ASP.NET 专家，因为事实恰恰相反......）

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-01-10T17:18:36.200

该解决方案将使您能够以编程方式访问整个控件，包括控件上的所有属性。此外，提交时只有文本框值会出现在 URL 中，因此您的 GET 请求 URL 会更“有意义”

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="JonSkeetForm.aspx.cs" Inherits="JonSkeetForm" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Jon Skeet's Form Page</title>
</head>
<body>
    <form action="JonSkeetForm.aspx" method="get">
    <div>
        <input type="text" ID="text1" runat="server" />
        <input type="text" ID="text2" runat="server" />
        <button type="submit">Submit</button>
        <asp:Repeater ID="Repeater1" runat="server">
            <ItemTemplate>
                <div>Some text</div>
            </ItemTemplate>
        </asp:Repeater>
    </div>
    </form>
</body>
</html> 
```

然后在您的代码隐藏中，您可以在 PageLoad 上执行您需要的所有操作

```
public partial class JonSkeetForm : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        text1.Value = Request.QueryString[text1.ClientID];
        text2.Value = Request.QueryString[text2.ClientID];
    }
} 
```

如果你不想要一个有 的表单`runat="server"`，那么你应该使用 HTML 控件。为您的目的使用它更容易。只需使用常规 HTML 标记并放置`runat="server"`并给它们一个 ID。然后，您可以以编程方式访问它们**并**编写不带`ViewState`.

唯一的缺点是您将无法访问许多“有用”的 ASP.NET 服务器控件，例如`GridView`s。我在示例中包含了 a `Repeater`，因为我假设您希望将字段与结果放在同一页面上，并且（据我所知） a`Repeater`是唯一一个`runat="server"`在 Form 标签中没有属性的情况下运行的 DataBound 控件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-10T17:02:23.660

通过不在您的 FORM 标签中使用 runat="server" ，您绝对（恕我直言）在正确的轨道上。这只是意味着您需要直接从 Request.QueryString 中提取值，如下例所示：

在 .aspx 页面本身中：

```
<%@ Page Language="C#" AutoEventWireup="true" 
     CodeFile="FormPage.aspx.cs" Inherits="FormPage" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>ASP.NET with GET requests and no viewstate</title>
</head>
<body>
    <asp:Panel ID="ResultsPanel" runat="server">
      <h1>Results:</h1>
      <asp:Literal ID="ResultLiteral" runat="server" />
      <hr />
    </asp:Panel>
    <h1>Parameters</h1>
    <form action="FormPage.aspx" method="get">
    <label for="parameter1TextBox">
      Parameter 1:</label>
    <input type="text" name="param1" id="param1TextBox" value='<asp:Literal id="Param1ValueLiteral" runat="server" />'/>
    <label for="parameter1TextBox">
      Parameter 2:</label>
    <input type="text" name="param2" id="param2TextBox"  value='<asp:Literal id="Param2ValueLiteral" runat="server" />'/>
    <input type="submit" name="verb" value="Submit" />
    </form>
</body>
</html> 
```

在代码隐藏中：

```
using System;

public partial class FormPage : System.Web.UI.Page {

        private string param1;
        private string param2;

        protected void Page_Load(object sender, EventArgs e) {

            param1 = Request.QueryString["param1"];
            param2 = Request.QueryString["param2"];

            string result = GetResult(param1, param2);
            ResultsPanel.Visible = (!String.IsNullOrEmpty(result));

            Param1ValueLiteral.Text = Server.HtmlEncode(param1);
            Param2ValueLiteral.Text = Server.HtmlEncode(param2);
            ResultLiteral.Text = Server.HtmlEncode(result);
        }

        // Do something with parameters and return some result.
        private string GetResult(string param1, string param2) {
            if (String.IsNullOrEmpty(param1) && String.IsNullOrEmpty(param2)) return(String.Empty);
            return (String.Format("You supplied {0} and {1}", param1, param2));
        }
    } 
```

这里的技巧是我们在文本输入的 value="" 属性中使用 ASP.NET Literals，因此文本框本身不必 runat="server"。然后将结果包装在 ASP:Panel 中，并在页面加载时设置 Visible 属性，具体取决于您是否要显示任何结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-09T19:05:11.097

好的，乔恩，首先是视图状态问题：

我没有检查自 2.0 以来是否有任何内部代码更改，但这是我几年前处理摆脱视图状态的方式。实际上，该隐藏字段在 HtmlForm 中是硬编码的，因此您应该派生新的字段并自行进行调用并进入其渲染。请注意，如果您坚持使用普通的旧输入控件，您也可以将 __eventtarget 和 __eventtarget 排除在外（我想您会想要这样做，因为它也有助于在客户端上不需要 JS）：

```
protected override void RenderChildren(System.Web.UI.HtmlTextWriter writer)
{
    System.Web.UI.Page page = this.Page;
    if (page != null)
    {
        onFormRender.Invoke(page, null);
        writer.Write("<div><input type=\"hidden\" name=\"__eventtarget\" id=\"__eventtarget\" value=\"\" /><input type=\"hidden\" name=\"__eventargument\" id=\"__eventargument\" value=\"\" /></div>");
    }

    ICollection controls = (this.Controls as ICollection);
    renderChildrenInternal.Invoke(this, new object[] {writer, controls});

    if (page != null)
        onFormPostRender.Invoke(page, null);
} 
```

所以你得到那 3 个静态 MethodInfo 并把它们叫出来，跳过那个 viewstate 部分；）

```
static MethodInfo onFormRender;
static MethodInfo renderChildrenInternal;
static MethodInfo onFormPostRender; 
```

这是您表单的类型构造函数：

```
static Form()
{
    Type aspNetPageType = typeof(System.Web.UI.Page);

    onFormRender = aspNetPageType.GetMethod("OnFormRender", BindingFlags.Instance | BindingFlags.NonPublic);
    renderChildrenInternal = typeof(System.Web.UI.Control).GetMethod("RenderChildrenInternal", BindingFlags.Instance | BindingFlags.NonPublic);
    onFormPostRender = aspNetPageType.GetMethod("OnFormPostRender", BindingFlags.Instance | BindingFlags.NonPublic);
} 
```

如果我的问题是正确的，那么您也不想使用 POST 作为表单的操作，因此您可以这样做：

```
protected override void RenderAttributes(System.Web.UI.HtmlTextWriter writer)
{
    writer.WriteAttribute("method", "get");
    base.Attributes.Remove("method");

    // the rest of it...
} 
```

我想这差不多。让我知道事情的后续。

编辑：我忘记了页面视图状态方法：

因此，您的自定义表单：HtmlForm 获得了全新的抽象（或没有）页面：System.Web.UI.Page：P

```
protected override sealed object SaveViewState()
{
    return null;
}

protected override sealed void SavePageStateToPersistenceMedium(object state)
{
}

protected override sealed void LoadViewState(object savedState)
{
}

protected override sealed object LoadPageStateFromPersistenceMedium()
{
    return null;
} 
```

在这种情况下，我会密封方法，因为您无法密封页面（即使它不是抽象的，Scott Guthrie 也会将其包装成另一个：P），但您可以密封您的表单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T16:52:24.053

您是否考虑过在发布表单时不消除 POST，而是重定向到合适的 GET url。也就是说，接受 GET 和 POST，但在 POST 上构造一个 GET 请求并重定向到它。这可以在页面上处理，也可以通过 HttpModule 来处理，如果你想让它独立于页面的话。我认为这会使事情变得容易得多。

**编辑：**我假设您在页面上设置了 EnableViewState="false" 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-10T16:55:07.370

我将创建一个处理路由的 HTTP 模块（类似于 MVC，但并不复杂，只是几个`if`语句）并将其交给`aspx`或`ashx`页面。`aspx`是首选，因为它更容易修改页面模板。但是我不会使用`WebControls`。`aspx`只是`Response.Write`。

顺便说一句，为了简化事情，您可以在模块中进行参数验证（因为它可能与路由共享代码）并将其保存到`HttpContext.Items`页面中，然后在页面中呈现它们。这将非常像 MVC 一样工作，没有所有的花里胡哨。这是我在 ASP.NET MVC 时代之前做的很多事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-10T17:18:32.847

我真的很高兴完全放弃页面类，只使用基于 url 的大 switch case 处理每个请求。每一个“页面”变成了一个 html 模板和 ac# 对象。模板类使用带有匹配委托的正则表达式，该委托与密钥集合进行比较。

好处：

1.  真快，重新编译后几乎没有卡顿（页面类一定要大）
2.  控制非常精细（非常适合 SEO，以及制作 DOM 以与 JS 很好地配合）
3.  呈现与逻辑是分开的
4.  jQuery 完全控制了 html

无赖：

1.  简单的东西需要更长的时间，因为单个文本框需要多个地方的代码，但它确实可以很好地扩展
2.  总是很想只用页面视图来做，直到我看到一个视图状态（呃）然后我又回到现实。

乔恩，星期六早上我们在 SO 上做什么：）？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-23T12:39:45.227

我认为 asp:Repeater 控件已过时。

ASP.NET 模板引擎很不错，但您可以使用 for 循环轻松完成重复...

```
<form action="JonSkeetForm.aspx" method="get">
<div>
    <input type="text" ID="text1" runat="server" />
    <input type="text" ID="text2" runat="server" />
    <button type="submit">Submit</button>
    <% foreach( var item in dataSource ) { %>
        <div>Some text</div>   
    <% } %>
</div>
</form> 
```

ASP.NET Forms 还可以，Visual Studio 提供了不错的支持，但这个 runat="server" 是错误的。ViewState 到。

我建议你看看是什么让 ASP.NET MVC 如此出色，它从 ASP.NET Forms 方法中移开而不将其全部丢弃。

您甚至可以编写自己的构建提供程序来编译像 NHaml 这样的自定义视图。我认为您应该在这里寻找更多控制权，并简单地依赖 ASP.NET 运行时来包装 HTTP 并作为 CLR 托管环境。如果您运行集成模式，那么您也可以操作 HTTP 请求/响应。

# c++ - 如何决定在哪里处理异常——在它被抛出的函数范围内还是在全局范围内？

> ID：431311
> 
> 赞同：0
> 
> 时间：2009-01-10T16:47:54.797
> 
> 标签：c++, exception

我正在使用 WinSock 为 Windows 编写客户端-服务器应用程序，并且我有服务器类。
在初始化服务器时，我有这样的代码：

```
 class Server {
    static const int MaxClients = 10;
    std::vector connections;
    CRITICAL_SECTION cs;
    int port;
    SOCKET ServerSocket;
    sockaddr_in ServerAddress;
    void init(); 
public:
    Server(int Port);
    void addConnection(const Client& newClient); 
    void closeConnection(int index); 
    void Listen();
    int size(); 
    /*virtual void ClientService();
    virtual void SendMsg(const std::string& msg);*/
    virtual ~Server();
};

void Server::init() {
    WSADATA wsaData;
    if(WSAStartup(MAKEWORD(2, 2), &wsaData))
        throw Exception("WinSock init failed");
    ServerSocket = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
    if (ServerSocket == INVALID_SOCKET)
        throw Exception("Socket failed to create!");
    ServerAddress.sin_family = AF_INET;
    ServerAddress.sin_addr.s_addr = htonl(INADDR_ANY); 
    ServerAddress.sin_port = htons(port);
    if(bind(ServerSocket,(sockaddr*)&ServerAddress,sizeof(ServerAddress)) == SOCKET_ERROR)
    {
        throw Exception("Binding failed");
        closesocket(ServerSocket); 
    }
} 
```

我需要在哪里处理异常？在这里，在 init() 私有方法（从构造函数中调用）还是在主函数中？有什么规则可以在哪里放置异常处理程序，它取决于什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-10T16:54:30.913

基本规则是您只在代码的那部分捕获异常，您可以在其中实际*处理*它。通过处理它，我的意思是您可以根据抛出的异常采取一些措施，例如尝试再次创建套接字，或尝试使用不同的配置。

此外，需要审查跨图书馆边界的例外情况。根据上下文，您可能希望捕获它们并重新引发不同类型的异常，例如从库客户端隐藏实现细节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-10T16:53:54.550

这取决于您是否真的要*处理*异常，例如使用稍微不同的输入重试，或者决定忽略问题并继续进行（很少合适，但*可能*有用）。在这种情况下，您可能希望在靠近其源的位置捕获异常。

在大多数情况下，您真正​​可以对异常做的唯一事情就是记录它并中止操作（例如，在 Web 应用程序中为用户提供错误页面，或弹出友好的“此程序已崩溃，抱歉”对话框并退出）。在这种情况下，您的 catch 块可能非常接近堆栈的顶部 - 例如在 main 方法中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T20:49:33.997

至于在抛出异常的函数范围内（即在`init()`函数中）捕获异常的问题 - 在抛出异常的范围内捕获异常很少有意义。从本质上讲，这意味着您已经检测到错误并知道如何处理它（并且将要处理它），但是您使用异常只是将控制权转移到函数的另一部分.

虽然在某些情况下这可能是有意义的（尽管这将是一种代码味道，表明该函数足够复杂以至于应该对其进行重构），处理该错误的逻辑（因为它*正在*被处理）应该使用更常见的控制流技术，例如`if`语句或`break`. 即使是非常不受欢迎的`goto`也可能比抛出异常只在同一个函数中处理它更可取。

# computer-science - 有人对量子计算机的可能操作/使用感兴趣吗？

> ID：431327
> 
> 赞同：5
> 
> 时间：2009-01-10T16:56:59.630
> 
> 标签：computer-science, quantum-computing

我经历了一段对量子计算机如何工作以及如果它们变得实用可能有什么好处感兴趣的时期。我知道他们被谈论破解密码。[我感兴趣的是通过基本上尝试所有可能的输入（并行）并查看是否达到任何错误状态来使用它们来验证软件。](http://aps.arxiv.org/PS_cache/quant-ph/pdf/9807/9807026v1.pdf)

我知道这有点天方夜谭，但我想知道其他人是否对量子计算机感兴趣，它们是如何工作的，以及它们有什么用处。

补充：只是为了好玩，让我抛出一个迷你教程：

假设你有 N 位内存可以玩。假设您可以使用输入数据加载这些位（或其中一些位）。然后假设您可以对它们执行有限的操作序列（不使用任何额外的内存），将答案留在其中。

要使用量子计算机执行此操作，您只需确保整个计算是可逆的，通过保留一些位来记录您采用的分支，以便您可以撤消它们。如果这样做，那么所有操作都可以写成 N 位上的简单酉矩阵变换。（酉变换是 N 维坐标系中的纯旋转。）因此执行计算包括在位向量上应用一系列纯旋转。

如果你这样做，那么如果 N 位向量在量子计算机中，它可以被初始化为所有 2^N（或更少）可能的输入在“平行宇宙”中同时叠加的状态。然后，如果您进行计算，它会同时进行所有计算。

现在，要查看其中一个输入是否为您提供特定答案，您所要做的就是让它运行到特定状态。如果你停止它并检查状态，它所做的就是随机选择一个宇宙并丢弃所有其余的。因此，Grover 算法让你做的是，在不停止它的情况下，强调具有答案状态的宇宙的概率。然后你向前运行它，然后向后运行，然后向前运行，以此类推进行多次迭代，直到答案宇宙具有非常高的概率。然后如果你检查它，你很有可能看到你想要的答案。

呼...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T17:23:26.097

在大学的符号 AI 模块中，我被要求就某个主题向全班做一个小型演示，我的主题是 AI 应用程序。我在本次演讲中的主题是人工智能中的量子计算。

如果我在这里写的信息是过时的/错误的/糟糕的，不要太生气。我只是一所蹩脚大学的二年级 CS 学生，大部分细节都依赖他的记忆。

量子计算的力量似乎在于它能够以惊人的速度处理事物（如果我没记错的话，由于它的感知状态）。这显然将彻底改变安全性，因为白帽和黑帽黑客将抓住机会开发和压力测试各种安全系统方法。如果您对物理感兴趣，那么这就是您的主题！如果您想了解更多关于量子计算机如何通过使用算法分解大数来实现安全性的信息，[请阅读 Peter Shor 的这篇论文](http://fy.chalmers.se/~delsing/QI/Shor-JOC-97.pdf)。

它的力量来自量子比特和一种称为[量子干涉](http://en.wikipedia.org/wiki/Quantum_Interference)的技术。我可以花一整天的时间谈论它，但你最好阅读一下双缝实验，看看量子计算是如何工作的。

传统计算机妥协了逻辑门，而量子计算机有自己的。由于许多此类计算机已被构建（硬连线）以解决某些问题，因此针对不同的问题提出了许多不同的 QLG（量子逻辑门）。在功能上，量子网络是使用这些门以一种称为门阵列的方法形成的。如果您需要这方面的更多信息，那么 Ekert 论文就是您的最佳选择。

请注意，表示超级位置的*传统*方法是在 2^n 维希尔伯特空间（其中 n 是量子比特的数量）中作为单位逆变向量（每个量子比特一个）。门被定义为旋转这些*宇宙*并不可避免地改变量子比特。一个这样的门是[Hadamard Gate](http://en.wikipedia.org/wiki/Hadamard_gate)。

量子人工智能有光明的未来，但不会很长。许多学者将量子计算视为计算的遥远未来，类似于查尔斯巴贝奇如何看待他的机器。

对不起，如果这个答案有点失控。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-10T17:32:56.453

澄清一下，您那里的链接讨论了有限状态机的验证。这在硬件市场可能是一件好事，但从那里到软件验证，路还很长。

特别是，软件至少在堆栈自动机上运行，​​如果不是在图灵机上运行的话。

此外，没有手动抽象的软件验证（a-la 模型检查）将需要您解决停机问题。充其量，量子计算机可以将您从 NP 带到 P，它不会将您从 RE 带到 R。即使您并行运行任何无限项，您通常也无法确定程序是否结束。尽管对于某些可以运行的程序来说，这是可能的。

无论哪种方式，我都会等到我首先看到在普通计算机上运行的操作系统。我只能想象量子计算的 GPF ......“宇宙执行了非法行为，现在将内爆”或类似的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-10T17:03:06.653

我有点兴趣，因为我对所有科学都感兴趣，但老实说，我没有花一点时间深入研究它们，也没有想过如何将它们应用于我研究的问题。关于我们如何应用我们今天使用的冯诺依曼式架构，我还有很多东西要学习。

也许多核和大规模并行化是解决这类问题的半步。但我只是在那个方向爬行。

我不知道如何对它们进行编程以获得任何有用的东西。

Connection Machine 和 Long Now 成名的 Danny Hillis 使用机器编写了一种排序算法，该算法使用遗传技术进行了优化。我想知道重新审视这样的事情是否是一个值得的问题？或者也许是一个稳定、更快的线性代数解决方案？

你的问题是反问吗？您是否可以使用这样的机器，近期计划尝试您的想法？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-10T17:04:38.473

链接：[http ://www.dwavesys.com/index.php?page=applications](http://www.dwavesys.com/index.php?page=applications)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-10T17:34:32.347

你在开玩笑吗？

If half of what David Deutsch says is right this will be either the end of encryption or the end of encryption-breaking, and will make the central problems in chemistry, physics, and nano-tech *knowing the question* not *finding the answer*.

# visual-studio - 在 VC++ 项目中包含 VB 项目

> ID：431329
> 
> 赞同：0
> 
> 时间：2009-01-10T17:00:29.107
> 
> 标签：visual-studio, build-process, dependencies

我正在寻找有关依赖问题的帮助。简而言之，我在一个更大的 VC++ 工作区中包含了一个 makefile 项目，但子项目总是会重新构建，即使它不是必需的。

## 细节

我继承了一个由几个不同模块组成的大型项目，包括一个（主要）Visual C++ 6.0 可执行文件和一个较小的 Visual Basic 6.0 DLL。

今天，它是手动构建的，通过启动每个 IDE 并从其自己的环境中生成每个组件。我想把它变成从 VC++ IDE 中的一键式构建。（最终目标是导出生成文件，自动化整个过程，并进行夜间构建。）

为此，我在 VC++ 工作区中添加了一个“Makefile”项目。makefile 通过从命令行调用 VB 编译器来构建 VB DLL。

问题是 VB 项目*总是会*重新构建自己，从而在构建过程中增加了几分钟。我想我可以通过将所有 VB 源文件添加为依赖项来避免这种情况，但这可能会变成一个维护问题，因为它需要开发人员在每次 VB 组件更改时更新 VC++ 工作区。

**有没有办法让构建过程更具选择性，所以 VB 仅在*需要*重新构建 DLL 时运行，而不是将每个源文件作为依赖项添加到 VC++ 项目中？**

谢谢你的想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T17:10:02.613

您可以自己进行依赖扫描。仅当任何 VB 源文件比 VB 构建的构建输出更新时才触发 VB 构建（您可以使用通配符递归扫描，即没有显式配置）。您可能需要额外注意 VB 项目使用的引用。

这当然需要一些手动的 make-file 编写。由于 VB6 本身似乎不支持任何依赖项检查，我想不出任何纯粹基于 IDE 的解决方案（它不需要你提到的双重簿记）。

当您刚刚开始为 VB 项目实施夜间构建时，这似乎表明该项目可能处于开发/维护中的时间更长。更长的时间本身可能表明将 VB 项目移植到 VB.NET，这大大改善了 VB 项目的构建过程。

# artificial-intelligence - 图灵测试的替代方案

> ID：431331
> 
> 赞同：9
> 
> 时间：2009-01-10T17:02:48.900
> 
> 标签：artificial-intelligence

所以我们在我的 AI 课上学到了一些关于图灵测试的知识。这让我开始思考。我可以看到一些限制：

1.  它仅限于特定的上下文。如果我不设计一个人工智能来与人类交谈怎么办？
2.  它倾向于以人为本的行动胜过理性的行动。例如，如果我正在设计一个人工智能来控制核导弹，我*真的*希望它扮演人类吗？当然，这是一个极端的例子，但你明白了。
3.  它可能受到不表明计算机可以进行人类思考的因素的影响。例如，假设我问 2334 * 321 是什么。我可以判断该设备是否是一台计算机，因为它可能会很快回答我，而人类必须弄清楚它。解决方案？让电脑暂停。

现在，我确信图灵测试在确定机器智能方面仍然占有一席之地。但我认为它的范围相当有限。有没有其他选择？就此而言，我认为它的局限性是错误的吗？

**编辑**：让我明确一点：我并不是建议应该放弃图灵测试。我只是好奇是否有任何其他测试可以克服其限制（可能将它们换成其他限制）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-10T17:24:32.583

告诉你什么：在我们回答你的问题之前，先定义“智能”。

正如最初描述的那样，图灵测试也存在一些其他问题，其中最值得注意的是它不是“有效”的，也就是说无法判断它何时结束。

现在，看看你的（相当合理的）反对意见：一方面，如果它给出正确答案的速度太快，会让你怀疑；另一方面，你不确定如果它给出错误的答案会很好，即使它会让你认为它可能是“智能的”。

但是，现在，考虑我们的交互：你不知道我*不是*智能计算机。怎么样，作为星际迷航的参考，ST:TNG 上的数据先生？他当然与人类有区别，并且不会一直给予人类回应，但大多是通过。

现在，让我们考虑一下你遇到的一个人，他不是聪明人，而是完全是一种机制：没有“意识”，没有“灵魂”。（这种实体在文献中被称为[“哲学僵尸”](http://en.wikipedia.org/wiki/Philosophical_zombie)。） *除了*那个缺失的“意识”之外，这个人，或一个人的拟像，在所有其他方面都像一个人：表达受伤时的痛苦，表现出吃好饭时的快乐，对小猫表示爱意~~和小孩~~. （更正，因为我想自己通过这个测试。）

你怎么能说这个哲学僵尸*不*“聪明”？

这里的重点是你有很好的问题，但不一定有被广泛接受的答案。我自己对图灵测试的看法是它是一个很好的有效测试，因为它的重点，正如图灵自己所说，如果你不能区分智能或有感知的计算机，以及*真正*智能的实体，那么你必须假设没有区别。

您可以阅读的其他一些内容：

*   阅读约翰塞尔的[“中国房间”](http://en.wikipedia.org/wiki/Chinese_Room)
*   阅读 Doug Hofstadter 的[“哥德尔·埃舍尔·巴赫：永恒的金色辫子”](https://rads.stackoverflow.com/amzn/click/com/0465026567)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-10T17:17:42.397

我认为您错过了图灵测试的重点。它并不是要评判人工智能算法的好坏，而是要模拟人类智能的人工智能算法的成功与否。从这个意义上说，它实际上更像是对人工智能最先进水平的测试，而不是任何特定的人工智能算法。也就是说，如果我们可以设计一个人工智能算法来通过这个测试，那么我们可以说我们能够用人工智能来开发具有人类智能的机器。

可以合理地假设还有其他测试同样足够，但是这个测试在其简单性和相对缺乏约束方面是优雅的。除了格式外，输入基本上没有限制。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-10T17:25:44.797

菲利普·K·迪克（Philip K Dick）会和这个人一起度过一个愉快的一天……

1）。还存在哪些其他上下文？AI-海豚？人类智能是我们唯一可以直接体验到的（哲学仍然不确定），是唯一一个我们甚至可以开始接近任何经验和可测量的东西。其他一切都是二阶抽象。*最好*

2）。你真的希望人工智能理性行事吗？理性并没有说道德可以带你去一些可怕的地方。纯粹理性行事的人会做一些非常糟糕的事情。即使你将理性扩大到逻辑——两者*并不*相同——仍然有一些不可言喻的*更多*关于人类的东西。

3）。这就是诀窍不是吗？你不能停下来，因为大多数真实的人根本无法回答这个问题，或者会以非常人性化的方式回答——“错误，大约 750k ish”。图灵是关于外观的。

不要太拘泥于技术，这更像是一个哲学假设。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-10T17:09:13.880

取决于您如何定义对话。

图灵的思想实验中使用的问答上下文可能看起来有限且做作。但是，如果您将其切换到医疗诊断会话或金融投资组合优化问题呢？这些感觉不像是问答环节，但仍然很难让机器与人类无法区分。

自然语言处理呢？仍然不是一个已解决的问题，因为自然语法不是上下文无关的。

我认为图灵测试仍然是一种思考问题的方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-10T19:44:06.483

应该有替代方案，在某种程度上，图灵测试将 AI 与“人类智能”进行对比，而“人类智能”并不是唯一可能的类型。我们大多是聪明的，但通常只领先于像狗这样的生物，它们有自己的“智力”类型和自己的“逻辑”形式。如果你质疑一个可以通过 Turning 测试的 AI 足够长的时间，你会像任何其他人一样认为它在一些事情上是错误的。我们没有人是完美的，这是我们存在固有的（图灵测试可能会从双方失败）。

以下帖子可能会很有趣：[决定论的必要性](http://theprogrammersparadox.blogspot.com/2008/09/necessity-of-determinism.html)，因为它无论如何都质疑对人工智能的潜在需求。

至于另一种选择，有趣的是有一个测试来比较不同层次的一些“智能”行为，比如昆虫、狗、人类及以上。真正的问题是智能在其边缘的行为方式。这是人类的动态行为，即使他们没有足够的信息来处理事情，这是我们的定义属性之一。你会注意到计算机的故障方式，而不是它的工作方式（它试图模仿人）。

因此，如果您真的在寻找智能，那么当系统功能失调时，系统如何动态工作就变成了一个问题。如果您无法判断错误条件是什么，那么它是动态的，足以处理无限大量的输入。如果有一些输入导致输出发生明显变化，那么它就不够动态。

除了动态之外，您还可以衡量“思考”本身的质量。随着“思想”更加合乎逻辑和理性，它上升到跨越昆虫、狗、人、火神（是的，来自星际迷航）到纯数学的更高阶存在。我们不是唯一的智慧生物，我们只是比其他生物更具逻辑性和理性。图灵认为我们正处于巅峰，但我认为这很容易引起争议。一个好的测试可以显示出真正的智力水平。

保罗。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-17T19:05:43.783

图灵测试中测试的能力不仅是自然语言理解，还有伪装成人类的能力。所以在电缆的另一端有一台伪装成人类的计算机，这就是为什么计算机认为在回答 2334*321 的结果之前暂停一下是合理的。这回答了 2) 和 3)。此外，“如果我正在设计一个人工智能来控制核导弹”——这就像设计一个可以钉钉子的手机一样错误。

据我了解，与人类交谈的能力是程序被认为是人工智能的最低要求。这回答 1)

很抱歉提出意见，但我认为图灵测试很棒。

# maven-2 - 寻找新版本的依赖

> ID：431332
> 
> 赞同：17
> 
> 时间：2009-01-10T17:03:05.420
> 
> 标签：maven-2

有什么方法可以让 maven 寻找新版本的依赖项？

例如，我有 commons-lang commons-lang 2.3

2.4版可能会出来，我不知道。我宁愿不手动检查（在这种情况下通过编写 2.4），因为我有很多依赖项。我想我看到了一些让 Maven 使用最新版本的技巧。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2010-07-15T14:43:44.967

`mvn versions:display-dependency-updates`

将显示依赖项更新

在这里阅读更多：[显示依赖更新](http://mojohaus.org/versions-maven-plugin/examples/display-dependency-updates.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-11T13:39:22.163

> 我想我看到了一些让 Maven 使用最新版本的技巧。

是的，有特殊的版本号来处理这个问题：

> 当您依赖插件或依赖项时，您可以使用 LATEST 或 RELEASE 的版本值。LATEST 是指特定工件的最新发布或快照版本，即特定存储库中最近部署的工件。RELEASE 是指存储库中的最后一个非快照版本。

（摘自[权威指南 Maven](http://books.sonatype.com/maven-book/reference/pom-relationships-sect-pom-syntax.html#pom-relationships-sect-latest-release)）

PS：虽然这本书也提到这是一种“不是那么好”的做法......

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-08-26T19:53:15.287

```
mvn versions:display-dependency-updates 
```

不要自动更改版本。依赖项更新还显示了 beta/alfa 版本，例如。用于休眠

另外使用以下命令进行插件更新：

```
mvn versions:display-plugin-updates 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T18:02:48.637

是的，你不能让它寻找更新版本的依赖项。您可以做的是查看 repo，尝试在[http://www.mvnrepository.com/上搜索](http://www.mvnrepository.com/)

真的，您不应该希望 Maven 这样做。它可能会导致很多令人讨厌的问题。有时向后兼容性可以在点版本中达到平衡。

# sharepoint - 是否可以让自定义 Web 部件收听默认 SharePoint 搜索框？

> ID：431335
> 
> 赞同：3
> 
> 时间：2009-01-10T17:04:32.470
> 
> 标签：sharepoint, search

默认情况下，SharePoint 在门户顶部有一个搜索框。我希望我的 WebPart 能够拦截该搜索并提供搜索结果。这可能吗，如果可以，有任何提示或链接如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-10T17:55:22.367

在结果页面上，只需删除核心搜索结果 webpart 并添加您的 webpart。
在您的 webpart 中，从查询字符串中获取查询（参数 k 表示关键字，s 表示范围）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T19:18:53.087

你实际上有几个选择。您可以按照 Nico 的建议替换 CSR Web 部件。但是您也可以只更改搜索范围上的目标 URL 以指向另一个 ASPX 页面，您在该页面中拥有自己的搜索结果 Web 部件。通过转到站点设置 -> 搜索范围来更改目标 URL。但是，必须在共享服务提供者级别编辑共享范围上的目标 URL。

最后，还可以完全替换所有页面上的搜索框。这相当简单，因为您只需要安装一个 SharePoint 功能，该功能指示底层委托控件显示您的搜索框，而不是 SharePoint 的。再次停用该功能，网站集中的所有页面都会再次恢复到原始搜索框。聪明吧？但是，如果您从根本上需要扩展搜索框的行为或布局，您当然应该选择此解决方案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-10T18:22:46.337

您可以在 webpart 中使用 jQuery 并处理该文本框的 onkeypress 事件。

# java - 使用 XMLStreamWriter 附加到 XML

> ID：431338
> 
> 赞同：1
> 
> 时间：2009-01-10T17:06:05.150
> 
> 标签：java, xml

基本上，应用程序将 Collection 的内容写入 XML。`XMLOutputFactory.newInstance().createXMLStreamWriter(...)`为此，我使用 XMLStreamWriter ( )。

效果很好，除了我无法了解如何将数据附加到现有文件。不太喜欢先读取所有数据，将数据附加到内存然后覆盖的想法。或者这是唯一的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T17:27:29.600

简单地附加到 XML 文件将导致 XML 格式错误。您应该构建 DOM 并附加您需要的新元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T17:49:09.897

如果你要附加一个顶级元素，你可能会做你想做的事。例如，如果你有这个文件：

```
<some_element>
  <nested_element>
    ...
  </nested_element>
</some_element> 
```

您很可能可以通过附加另一个`some_element`元素而侥幸逃脱。

但是，如果有一个外层元素，你显然会搞砸，你必须附加一个*内层*元素。例如，假设您想`some_element`向此文件添加一个元素：

```
<data>
  <some_element>
    <nested_element>
      ...
    </nested_element>
  </some_element>
</data> 
```

一般来说，最好先重新解析文档，然后再重写它。如果它很小，请使用基于 DOM 的解析器；这更容易。如果文件很大，则使用基于 SAX 的文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T17:42:22.627

另一种方法是构建一个新的 XML 文件，然后通过[XSLT 转换](http://www.dpawson.co.uk/xsl/sect2/merge.html)将它与前一个文件合并。要应用 XSLT 样式表，您应该使用[Java XML Transformation API](http://java.sun.com/j2se/1.4.2/docs/api/javax/xml/transform/package-summary.html)。

# c# - C# 多索引器

> ID：431339
> 
> 赞同：16
> 
> 时间：2009-01-10T17:06:15.693
> 
> 标签：c#, properties, indexer

是否有可能有以下内容：

```
class C
{
    public Foo Foos[int i]
    {
        ...
    }

    public Bar Bars[int i]
    {
        ...
    }
} 
```

如果没有，那么我可以通过哪些方式实现这一目标？我知道我可以制作名为 getFoo(int i) 和 getBar(int i) 的函数，但我希望用属性来做到这一点。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-10T17:10:03.940

不在 C# 中，不。

但是，您始终可以从属性中返回集合，如下所示：

```
public IList<Foo> Foos
{
    get { return ...; }
}

public IList<Bar> Bars
{
    get { return ...; }
} 
```

IList<T> 有一个索引器，因此您可以编写以下内容：

```
C whatever = new C();
Foo myFoo = whatever.Foos[13]; 
```

在“返回...;”行 你可以返回任何实现 IList<T> 的东西，但你可能会在你的集合周围返回一个只读包装器，请参阅 AsReadOnly() 方法。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-10-30T21:15:58.803

这来自 C# 3.0 规范

“索引器的重载允许类、结构或接口声明多个索引器，前提是它们的签名在该类、结构或接口中是唯一的。”

```
public class MultiIndexer : List<string>  
{
    public string this[int i]
    {
        get{
            return this[i];
        }
    }
    public string this[string pValue]
    {
        get
        {
            //Just to demonstrate
            return this.Find(x => x == pValue);  
        }
    }      
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-10T17:49:26.077

有一种方法..如果您定义两种新类型来让编译器区分两个不同的签名...

```
 public struct EmployeeId
  { 
      public int val;
      public EmployeeId(int employeeId) { val = employeeId; }
  }
  public struct HRId
  { 
      public int val;
      public HRId(int hrId) { val = hrId; }
  }
  public class Employee 
  {
      public int EmployeeId;
      public int HrId;
      // other stuff
  }
  public class Employees: Collection<Employee>
  {
      public Employee this[EmployeeId employeeId]
      {
          get
             {
                foreach (Employee emp in this)
                   if (emp.EmployeeId == employeeId.val)
                      return emp;
                return null;
             }
      }
      public Employee this[HRId hrId]
      {
          get
             {
                foreach (Employee emp in this)
                   if (emp.HRId == hrId.val)
                      return emp;
                return null;
             }
      }
      // (or using new C#6+ "expression-body" syntax)
      public Employee this[EmployeeId empId] => 
             this.FirstorDefault(e=>e.EmployeeId == empId .val;
      public Employee this[HRId hrId] => 
             this.FirstorDefault(e=>e.EmployeeId == hrId.val;

  } 
```

然后要调用它，您必须编写：

```
Employee Bob = MyEmployeeCollection[new EmployeeID(34)]; 
```

如果你写了一个隐式转换运算符：

```
public static implicit operator EmployeeID(int x)
{ return new EmployeeID(x); } 
```

那么你甚至不必这样做来使用它，你可以写：

```
Employee Bob = MyEmployeeCollection[34]; 
```

即使两个索引器返回不同的类型，同样的事情也适用......

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-01-25T22:04:06.973

尝试我的 IndexProperty 类以启用同一类中的[多个索引器](http://www.codeproject.com/Tips/319825/Multiple-Indexers-in-Csharp)

[http://www.codeproject.com/Tips/319825/Multiple-Indexers-in-Csharp](http://www.codeproject.com/Tips/319825/Multiple-Indexers-in-Csharp)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-10T17:13:23.277

如果您尝试执行以下操作：

```
var myClass = new MyClass();

Console.WriteLine(myClass.Foos[0]);
Console.WriteLine(myClass.Bars[0]); 
```

那么你需要自己定义 Foo 和 Bar 类的索引器——即将所有的 Foo 对象放在 Foos 中，并使 Foos 成为直接支持索引的类型实例。

为了演示对成员属性使用数组（因为它们已经支持索引器）：

```
public class C {
    private string[] foos = new string[] { "foo1", "foo2", "foo3" };
    private string[] bars = new string[] { "bar1", "bar2", "bar3" };
    public string[] Foos { get { return foos; } }
    public string[] Bars { get { return bars; } }
} 
```

会让你说：

```
 C myThing = new C();
 Console.WriteLine(myThing.Foos[1]);
 Console.WriteLine(myThing.Bars[2]); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-04-16T19:50:51.953

我相信接受的答案是错误的。如果您将使用显式接口实现，则有可能：

```
class C
{
    public IFooProvider Foos => this;
    public IBarProvider Bars => this;

    Foo IFooProvider.this[int i]
    {
        ...
    }

    Bar IBarProvider.this[int i]
    {
        ...
    }

    public interface IFooProvider
    {
        Foo this[int i] { get; set; }
    }

    public interface IBarProvider
    {
        Bar this[int i] { get; set; }
    }
} 
```

然后你可以完全按照你的意愿使用它：

```
C c;
c.Foos[1] = new Foo();
c.Bars[0] = new Bar(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-10T17:24:05.113

C# 没有返回类型重载。如果输入参数不同，您可以定义多个索引器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-10T17:32:34.347

不，你不能这样做。只有其签名仅因返回类型而异的方法才是转换运算符。索引器必须具有不同的输入参数类型才能编译。

# json - 提供 API 是否有助于阻止屏幕抓取？

> ID：431355
> 
> 赞同：7
> 
> 时间：2009-01-10T17:16:08.170
> 
> 标签：json, language-agnostic, api, screen-scraping

最近我在这里一直在思考屏幕抓取以及它可能是一项什么样的任务。所以我提出以下问题。

作为站点开发人员，您是否会公开简单的 API 以防止用户抓取屏幕，例如 JSON 结果？

然后，这些结果可以实现缓存，并且它们的流量比可能下载的大量标记要小得多。

我不是在看预防，而是在阻止刮擦。

* * *

**抓取带宽样本**
((users * (% / 100)) * ((freq * 60) * 24)) * 文件大小

*   用户：200,000
*   使用实用程序的用户百分比：5
*   文件大小：1kb
*   频率：1分钟

公式：

((用户 * (% / 100)) * ((freq * 60) * 24)) * 文件大小

10,000 * 1440 * 1

14400000kb 或 13.73291015625gb

假设您的 JSON 结果是 200 字节，即现在 (10,000 * 1440 * 0.2) 或每天 2.74658203125gb。

这相当于每天大约 11GB 的流量变化。

* * *

我的 Stack Overflow 配置文件是 96k 以供参考。

* * *

这个问题的原因提示要求从用户配置文件中获取 JSON 结果：
[http ://stackoverflow.uservoice.com/pages/general/suggestions/101342-add-json-for-user-information](http://stackoverflow.uservoice.com/pages/general/suggestions/101342-add-json-for-user-information)

我想了解其他开发人员是否会公开此类 API，以及是否值得您花时间提供这些 API 以减少带宽。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T17:28:59.283

提供 API 肯定会减少对您的网站进行的屏幕抓取量。使用良好的 REST API 比屏幕抓取更容易、更安全。屏幕可以在没有通知的情况下更改，这使得屏幕抓取代码更难维护。作为一名开发人员，如果我需要来自某个站点的信息，如果可以通过 API 获得相同的信息，我将永远不会抓取该站点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T17:21:24.447

屏幕刮擦实际上是不可预防的。提供 API 虽然对那些使用您的数据的人很好，但无法阻止它。由于数据最终必须是人类可读的，因此它是机器可读的。您最好将精力花在您的网站上，而不是为那些会使用您的数据的人工作（合法与否）。

wget、perl、正则表达式是抓取数据的常用机制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T17:30:30.450

如果您想鼓励人们与您的网站集成，或者它足够流行以至于成为一个问题（因此您被迫允许人们与之集成），那么一定要提供一个 API。如果您的 API 足够且易于使用，那么人们会更喜欢它而不是屏幕抓取。如果您的 API 比屏幕抓取工具不充分或更难使用，那么您可能仍然会遇到问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T17:37:19.720

如果技术用户使用 API 比屏幕抓取更容易，他们就会这样做。更好的是，如果您可以*鼓励*人们使用您的 API 而不是屏幕抓取，您应该可以更轻松地监控流量，因为自动用户代理与浏览器用户代理明显不同。

RESTful JSON 接口是一个不错的选择，因为它可以很容易地从任何其他语言编写脚本（*给我展示一种没有 JSON 解析器的语言，我将给您展示一种没人关心的语言*）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-10T17:20:44.900

如果您想提供一个开放模型，人们可以在您的站点上开发解决方案，那么是的，您应该提供一个 API。屏幕抓取是一种恶意集成的方法，只能在不得已的情况下使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T17:53:26.833

大多数开发人员会出于自己的原因选择要使用的技术。因此，如果您提供的 API 比他们用来抓取屏幕的 API 更容易，那么一些未知的百分比将会转移到它。在他们的考虑清单中，带宽减少可能非常低。

由于您尚未指定要抓取的内容，因此我们无法帮助您猜测要提供哪种 API，或者将使用它的比例。

一种非常常见的难以偏转的刮擦工具是使用 Excel 或其他使刮擦无痛的产品。

如果您的目的只是为了尽量减少痛苦（可能从您的问题中推断出），那么到目前为止，最有用的事情就是查询他们的爬虫——无论如何，这比查询 SO 更有用。

您可以查看 woot.com 并查看他们在 RSS 提要上提供的内容，以减轻 Web http 服务器的负担。

# c# - 如何模拟 WCF 服务？

> ID：431363
> 
> 赞同：6
> 
> 时间：2009-01-10T17:20:25.633
> 
> 标签：c#, .net, wcf, unit-testing, rhino-mocks

如何使用 Rhino Mocks 模拟 WCF 服务代理？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-10T17:23:32.010

创建您的服务，以便它实现一个接口。然后，您可以在客户端中模拟接口，也可以创建接口的假实现以在测试中使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-05T11:35:50.150

我知道这是一个旧帖子，但它是我最近所做的。在我的场景中，我有一些与 Wcf 服务对话的验收测试，但我不想使用真正的服务。我确实在它上面写了[一篇博](http://bronumski.blogspot.com/2011/09/hosting-mock-as-wcf-service.html)文，但这里是低调。

为给定对象创建 wcf 服务的静态类：

```
public static class MockServiceHostFactory
{
    public static ServiceHost GenerateMockServiceHost<TMock>(TMock mock, Uri baseAddress, string endpointAddress)
    {
        var serviceHost = new ServiceHost(mock, new[] { baseAddress });

        serviceHost.Description.Behaviors.Find<ServiceDebugBehavior>().IncludeExceptionDetailInFaults = true;
        serviceHost.Description.Behaviors.Find<ServiceBehaviorAttribute>().InstanceContextMode = InstanceContextMode.Single;

        serviceHost.AddServiceEndpoint(typeof(TMock), new BasicHttpBinding(), endpointAddress);

        return serviceHost;
    }
} 
```

创建一个模拟并将其用作 wcf 服务：

```
Castle.DynamicProxy.Generators.AttributesToAvoidReplicating.Add<ServiceContractAttribute>();

var myWcfServiceMock = Substitute.For<IMyWcfService>();
var mockServiceHost = MockServiceHostFactory.GenerateMockServiceHost(myWcfServiceMock , new Uri("http://localhost:8001"), "MyService");
mockServiceHost.Open();
...
mockServiceHost.Close(); 
```

# c# - 如何在复制或查询中制作进度条？

> ID：431377
> 
> 赞同：0
> 
> 时间：2009-01-10T17:29:16.240
> 
> 标签：c#

如何在复制或 SQL 查询或文件传输 (rapi) 中制作进度条？

或者有些东西是我无法测量的？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T18:21:10.287

将进度条设置为选取框而不是进度。这将使您的用户知道某些事情仍在发生，而无需提供确切的百分比。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T17:53:52.230

这实际上取决于如何构建您的代码。

据我所知，没有用于跟踪任务进度的 API，例如复制文件或运行 SQL 命令。如果您希望能够跟踪进度，则必须设计某种方法将任务分解为可衡量的任务，然后将其用作进度基准。

例如，如果您正在执行一系列 SQL`INSERT`查询，请测量您需要的查询数量（如果可能）。`inserts`数一数你到目前为止已经完成了多少。每次完成查询时，您都可以做一些简单的数学运算来衡量您的进度，因为您已经获得了所需的总查询量以及到目前为止的查询量。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-10T17:42:11.817

嗯......真的，因为你无法衡量你只需要猜测。你曾经安装过windows并且进度条移动很慢但是突然间它跳了很多？

几个想法。如果您只有一个 SQL 查询，那么您可以随着时间慢慢移动进度条（比如每秒 0.5%？）。然后，如果查询在达到 90% 时还没有完成，请停止它。然后在完成之前不要让它完成。如果它提前完成（在缓慢爬升的过程中），只需跳到 100%。

另一个想法是多次运行查询以计算平均时间。使用它来做我在上一段中提到的相同的事情，但平均时间你可以使增量与实际进度更好地匹配。

祝你好运！

# php - 检索结果时如何解决不明确的列名？

> ID：431391
> 
> 赞同：76
> 
> 时间：2009-01-10T17:34:25.153
> 
> 标签：php, sql, mysql, mysql-error-1052

我的数据库中有两个表：

带有列的 NEWS 表：

*   `id`- 新闻 ID
*   `user`- 作者的用户ID）

带有列的 USERS 表：

*   `id`- 用户 ID

我想执行这个 SQL：

```
SELECT * FROM news JOIN users ON news.user = user.id 
```

当我在 PHP 中获得结果时，我想获得关联数组并通过`$row['column-name']`. 如何获得具有相同列名的新闻 ID 和用户 ID？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-01-10T17:37:42.277

您可以为您选择的列设置别名：

```
$query = 'SELECT news.id AS newsId, user.id AS userId, [OTHER FIELDS HERE] FROM news JOIN users ON news.user = user.id' 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-01-10T17:38:20.670

您可以使用数字索引 ( `$row[0]`) 或更好，`AS`在 MySQL 中使用：

`SELECT *, user.id AS user_id FROM ...`

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-11-14T02:11:53.663

我只是想通了。这可能是一个不好的做法，但在这种情况下它对我有用。

我是不想为每个列名加上表前缀的别名或写出的懒人之一。

`table_name.*`您可以通过在 select 语句中使用来选择特定表中的所有列。

当你有重复的列名时，mysql会从头到尾覆盖。当再次遇到该列名时，将覆盖第一个重复列名中的数据。因此，最后出现的重复列名获胜。

如果我要连接 3 个表，每个表都包含一个重复的列名，那么 select 语句中表的顺序将决定我为重复列获取的数据。

例子：

```
SELECT table1.* , table2.* , table3.* FROM table1 LEFT JOIN table2 ON table1.dup = table2.dup LEFT JOIN table3 ON table2.dup = table3.dup; 
```

在上面的示例中，`dup`我得到的值将来自`table3`.

如果我想`dup`从中获得价值`table1`怎么办？

然后我需要这样做：

```
SELECT table3.* , table2.* , table1.* FROM table1 LEFT JOIN table2 ON table1.dup = table2.dup LEFT JOIN table3 ON table2.dup = table3.dup; 
```

现在，`table1`排在最后，所以 的值`dup`将是表 1 中的值。

我得到了我想要的价值，`dup`而不必写出每一个可怕的专栏，而且我仍然可以使用所有的专栏。耶！

我知道`dup`3 个表中的值应该相同，但是如果`table3`没有匹配值`dup`怎么办？然后`dup`在第一个示例中将是空白的，这将是一个无赖。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2011-08-31T20:03:31.563

@杰森。你是对的，除了 php 是罪魁祸首而不是 mysql。如果你把你`JOIN`放在 Mysql Workbench 中，你会得到三个名称完全相同的列（每个表一个），但数据不同（`null`如果该表与`JOIN`.

如果你在 php 中使用`MYSQL_NUM`，`mysql_fetch_array()`那么你将获得所有列。问题是当您使用`mysql_fetch_array()`with时`MYSQL_ASSOC`。然后，在该函数内部，php 正在构建返回值，如下所示：

```
$row['dup'] = [value from table1] 
```

后来……

```
$row['dup'] = [value from table2] 
```

...

```
$row['dup'] = [value from table3] 
```

所以你只会从 table3 中得到值。问题是来自 mysql 的结果集可以包含具有相同名称的列，但 php 中的关联数组不允许数组中的重复键。当数据保存在关联数组中时，在php中，一些信息会默默地丢失......

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2011-10-14T16:24:46.890

另一个提示：如果你想有更干净的 PHP 代码，你可以在数据库中创建一个 VIEW，例如

例如：

```
CREATE VIEW view_news AS
SELECT
  news.id news_id,
  user.id user_id,
  user.name user_name,
  [ OTHER FIELDS ]
FROM news, users
WHERE news.user_id = user.id; 
```

在 PHP 中：

```
$sql = "SELECT * FROM view_news"; 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-01-10T17:38:40.217

你可以做类似的事情

```
SELECT news.id as news_id, user.id as user_id .... 
```

然后`$row['news_id']`将是新闻 id 和`$row['user_id']`用户 id

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-06-03T15:01:45.197

我对动态表也有同样的问题。（假设有一个 id 可以加入但对其余字段没有任何假设的表。）在这种情况下，您事先不知道别名。

在这种情况下，您可以首先获取所有动态表的表列名称：

```
$tblFields = array_keys($zendDbInstance->describeTable($tableName)); 
```

其中 $zendDbInstance 是 Zend_Db 的一个实例，或者您可以使用此处的一个函数来不依赖 Zend [php pdo：获取表的列名](https://stackoverflow.com/questions/5428262/php-pdo-get-the-columns-name-of-a-table)

然后对于所有动态表，您可以获得别名并将 $tableName.* 用于不需要别名的那些：

```
$aliases = "";
foreach($tblKeys as $field)
    $aliases .= $tableName . '.' . $field . ' AS ' . $tableName . '_' . $field . ',' ;
$aliases = trim($aliases, ','); 
```

您可以将整个过程包装到一个通用函数中，并且只需要更简洁的代码或根据需要变得更懒惰:)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-03-15T11:21:08.477

当使用 PDO 进行数据库交互时，可以使用[PDO::FETCH_NAMED](https://phpdelusions.net/pdo/fetch_modes#FETCH_NAMED)获取模式，这有助于解决问题：

```
$sql = "SELECT * FROM news JOIN users ON news.user = user.id";
$data = $pdo->query($sql)->fetchAll(PDO::FETCH_NAMED);
foreach ($data as $row) {
    echo $row['column-name'][0]; // from the news table
    echo $row['column-name'][1]; // from the users table
    echo $row['other-column']; // any unique column name
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-10T21:34:12.673

如果您不想使用别名，您也可以只为表名添加前缀。

这样，您可以更好地自动生成查询。此外，最好不要使用 select * （它显然比只选择您*需要*的字段要慢 此外，只明确命名您想要拥有的字段。

```
SELECT
    news.id, news.title, news.author, news.posted, 
    users.id, users.name, users.registered 
FROM 
    news 
LEFT JOIN 
    users 
ON 
    news.user = user.id 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-02-19T04:24:37.827

这是上面的答案，它既简单又适用于返回的 JSON 结果。虽然当您使用 SELECT * 时，SQL 查询会自动为具有相同字段名称的每个实例添加表名前缀，但要发送回网页的结果的 JSON 编码会忽略具有重复名称的那些字段的值，而是返回 NULL 值.

它所做的正是包含重复字段名称的第一个实例，但使其值为 NULL。并且字段名称的第二个实例（在另一个表中）被完全省略，包括字段名称和值。但是，当您直接在数据库上测试查询时（例如使用 Navicat），结果集中会返回所有字段。只有当您接下来对该结果进行 JSON 编码时，它们是否具有 NULL 值并且后续的重复名称将被完全省略。

因此，解决该问题的一种简单方法是首先执行 SELECT *，然后为重复项使用别名字段。这是一个示例，其中两个表具有相同名称的 site_name 字段。

```
SELECT *, w.site_name AS wo_site_name FROM ws_work_orders w JOIN ws_inspections i WHERE w.hma_num NOT IN(SELECT hma_number FROM ws_inspections) ORDER BY CAST(w.hma_num AS UNSIGNED); 
```

现在在解码的 JSON 中，您可以使用字段 wo_site_name 并且它有一个值。在这种情况下，站点名称具有特殊字符，例如撇号和单引号，因此在最初保存时进行编码，而在使用数据库结果时进行解码。

```
...decHTMLifEnc(decodeURIComponent( jsArrInspections[x]["wo_site_name"])) 
```

您必须始终将 * 放在 SELECT 语句的前面，但在它之后您可以包含任意数量的命名和别名列，因为重复选择一个列不会产生任何问题。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-01-18T15:10:08.090

有两种方法：

1.  使用别名；在此方法中，您为各个列赋予新的唯一名称 (ALIAS)，然后在 PHP 检索中使用它们。例如

    ```
    SELECT student_id AS FEES_LINK, student_class AS CLASS_LINK 
    FROM students_fee_tbl 
    LEFT JOIN student_class_tbl ON students_fee_tbl.student_id = student_class_tbl.student_id 
    ```

    然后在 PHP 中获取结果：

    ```
    $query = $PDO_stmt->fetchAll();

    foreach($query as $q) {
        echo $q['FEES_LINK'];
    } 
    ```

2.  使用位置或结果集列索引；在此，数组位置用于引用重复的列名。由于它们出现在不同的位置，因此将使用的索引号始终是唯一的。但是，索引定位编号从 0 开始。例如

    ```
    SELECT student_id, student_class 
    FROM students_fee_tbl 
    LEFT JOIN student_class_tbl ON students_fee_tbl.student_id = student_class_tbl.student_id 
    ```

    然后在 PHP 中获取结果：

    ```
    $query = $PDO_stmt->fetchAll();

    foreach($query as $q) {
        echo $q[0];
    } 
    ```

# opensocial - 在构建 3rd 方应用程序方面，我可以使用 OpenSocial 做什么？

> ID：431409
> 
> 赞同：2
> 
> 时间：2009-01-10T17:43:41.143
> 
> 标签：opensocial

我已阅读该`Open Social`博客，并正在尝试为其中一个使用 Open Social 模型的第三方构建应用程序。

而且我仍然不清楚它使我能够对我们的应用程序做什么，有人可以提供`OpenSocial for Dummies`故障吗？

以下是我的问题：

*   它是否允许我使用托管网站的登录作为我的 Web 应用程序的身份验证和会话（例如，一旦有人登录到第三方，如果它是基于 OpenSocial 构建的，他们会自动为我的身份验证？

*   它是否允许 Web 服务调用来获取有关该人网络的选择性信息？

谢谢。

# asp.net - 带有寻呼机 TopAndBottom 的 GridView

> ID：431413
> 
> 赞同：2
> 
> 时间：2009-01-10T17:48:11.833
> 
> 标签：asp.net, gridview

我在 ASP.NET 中扩展了标准的 GridView 控件。基本上是一样的，但是分页和排序是使用回调完成的。

我已经成功创建了自己的 PagerTemplate，但它仅在 PagerSettings.Position 设置为 Top 时才有效。我想在顶部和底部都有寻呼机。

我收到一个 HttpException 说：表格必须包含按页眉、正文和页脚的顺序排列的行部分。

有谁知道这可能是什么？

我已经尝试调用 MakeAccessible() 方法，但这无济于事。

代码：

```
private int _IdColumnIndex = -1;

public override object DataSource
{
  get
  {
    return HttpContext.Current.Session[this.ClientID + "_DataSource"];
  }
  set
  {
    if (!value.GetType().Equals(typeof(DataView)))
      throw new ArgumentException("Only System.Data.DataView is accepted as a DataSource for DataGridView!");

    HttpContext.Current.Session[this.ClientID + "_DataSource"] = value;
  }
}

/// <summary>
/// Sets the default settings.
/// </summary>
private void SetDefaultSettings()
{
  base.AllowPaging = true;
  base.AllowSorting = true;
  base.ShowHeader = true;
  base.ShowFooter = true;
  base.PagerTemplate = new GridPagerTemplate(PAGER_ID, this);
  base.PagerSettings.Position = PagerPosition.TopAndBottom;
  base.PageSize = 10;

  AddSelectionCheckbox();
}

//private void MakeAccessible()
//{
//  if (this.Rows.Count > 0)
//  {
//    //This replaces <td> with <th> and adds the scope attribute 
//    this.UseAccessibleHeader = true;

//    //This will add the <thead> and <tbody> elements
//    this.HeaderRow.TableSection = TableRowSection.TableHeader;

//    //This adds the <tfoot> element. Remove if you don't have a footer row 
//    this.FooterRow.TableSection = TableRowSection.TableFooter;
//  }
//} 

private void AddSelectionCheckbox()
{
  TemplateField tf = new TemplateField();
  tf.HeaderText = "";
  tf.ItemTemplate = new CheckboxTemplate(ROW_CHECKBOX_ID);

  base.Columns.Add(tf);
}

protected override void OnInit(EventArgs e)
{
  SetDefaultSettings();

  base.DataBound += new EventHandler(DataGridView_DataBound);
  base.RowDataBound += new GridViewRowEventHandler(DataGridView_RowDataBound);

  base.OnInit(e);
}

protected override void OnPreRender(EventArgs e)
{
  base.OnPreRender(e);
  //this.PaintRows();
  //this.FormatCells();

  // Get JavaScript for this DataGridView, and include it on the page.
  string scriptUrl = Page.ClientScript.GetWebResourceUrl(this.GetType(), "Yakinix.UI.Controls.DataGridView.js");
  Page.ClientScript.RegisterClientScriptInclude("DataGridView", scriptUrl);

  string js = "function DGV_MakeCallback(argument)" +
              "{" +
                  "__theFormPostData = '';" +
                  "__theFormPostCollection = new Array();" +
                  "WebForm_InitCallback();" +
                  GetCallbackEventReference("DGV_Callback") +
              ";}";

  Page.ClientScript.RegisterClientScriptBlock(typeof(DataGridView), typeof(DataGridView).FullName + "DGV_MakeCallback", js, true);

  if (this.HeaderRow != null)
    this.HeaderRow.TableSection = TableRowSection.TableHeader;
}

private string GetCallbackEventReference(string func)
{
  string callbackEventReference = Page.ClientScript.GetCallbackEventReference(this, "argument", func, "'" + ClientID + "'", false);

  return callbackEventReference;
}

public override void RenderBeginTag(HtmlTextWriter writer)
{
  writer.RenderBeginTag(HtmlTextWriterTag.Div); // <div>
  base.RenderBeginTag(writer);
}

public override void RenderEndTag(HtmlTextWriter writer)
{
  base.RenderEndTag(writer);
  writer.RenderEndTag(); // </div>
}

/// <summary>
/// Renders the gridview control and strips whitespace. It also
/// applies the right formatting.
/// </summary>
public string RenderHtml()
{
  using (StringWriter sw = new StringWriter(CultureInfo.InvariantCulture))
  {
    //this.PaintRows();
    //this.FormatCells();

    if (this.HeaderRow != null)
      this.HeaderRow.TableSection = TableRowSection.TableHeader;

    this.UseAccessibleHeader = true;
    this.RenderControl(new HtmlTextWriter(sw));
    string html = sw.ToString();

    return html;
  }
}

// TODO: Style all rows for the column matching current SortExpression.
protected void DataGridView_RowDataBound(object sender, GridViewRowEventArgs e)
{
  //DataGridView gridView = (DataGridView)sender;

  //if (gridView.SortExpression.Length > 0)
  //{
  //  int cellIndex = -1;

  //  //  find the column index for the corresponding sort expression
  //  foreach (DataControlField field in gridView.Columns)
  //  {
  //    if (field.SortExpression == gridView.SortExpression)
  //    {
  //      cellIndex = gridView.Columns.IndexOf(field);
  //      break;
  //    }
  //  }

  //  if (cellIndex > -1)
  //  {
  //    if (e.Row.RowType == DataControlRowType.Header)
  //    {
  //      //  this is a header row,
  //      //  set the sort style
  //      e.Row.Cells[cellIndex].CssClass += (gridView.SortDirection == SortDirection.Ascending ? " sortascheader" : " sortdescheader");
  //    }
  //    else if (e.Row.RowType == DataControlRowType.DataRow)
  //    {
  //      //  this is a data row
  //      e.Row.Cells[cellIndex].CssClass += (e.Row.RowIndex % 2 == 0 ? " sortaltrow" : "sortrow");
  //    }
  //  }
  //}

  RenderDetailsRow(e);
}

/// <summary>
/// Renders the details row, which is hidden when rendered. Clicking a details link, displays the row and more detailed data is shown, and is editable.
/// </summary>
/// <param name="e">The <see cref="System.Web.UI.WebControls.GridViewRowEventArgs"/> instance containing the event data.</param>
private void RenderDetailsRow(GridViewRowEventArgs e)
{
  // Only add a details row to DataRows
  if (false && e.Row.RowType == DataControlRowType.DataRow)
  {
    Table table = e.Row.Parent as Table;

    if (table != null)
    {
      GridViewRow row = new GridViewRow(-1, -1, DataControlRowType.DataRow, DataControlRowState.Normal);
      row.Style[HtmlTextWriterStyle.Display] = "none";

      TableCell rowCell = new TableCell();
      rowCell.ColumnSpan = this.Columns.Count;
      rowCell.Height = new Unit(100);

      row.Cells.Add(rowCell);
      table.Rows.Add(row);

      HtmlAnchor htmlAhref = new HtmlAnchor();
      htmlAhref.HRef = "javascript:void(0);";
      htmlAhref.Attributes.Add("onclick", "ToggleElement('" + row.ClientID + "');");
      htmlAhref.InnerText = "Test";

      e.Row.Cells[e.Row.Cells.Count - 1].Controls.Add(htmlAhref);
    }
  }
}

protected void DataGridView_DataBound(object sender, EventArgs e)
{
  FillPagerDetails(base.TopPagerRow);
  FillPagerDetails(base.BottomPagerRow);
}

private void FillPagerDetails(GridViewRow pagerRow)
{
  if (pagerRow != null)
  {
    // Retrieve the DropDownList and Label controls from the row.
    DropDownList pageList = pagerRow.Cells[0].FindControl(PAGER_ID) as DropDownList;

    if (pageList != null)
    {
      pageList.Attributes.Add("onchange", "DataGridViewPage(this.value, '" + ClientID + "');");

      // Add the number of pages to the ListBox
      for (int i = 0; i < base.PageCount; i++)
      {
        int pageNumber = i + 1;

        // Create a ListItem that represents a page
        ListItem item = new ListItem(String.Format("{0}", pageNumber), i.ToString());

        // If the page is already selected, make sure the 
        // ListBox select the selected page
        if (i == base.PageIndex)
          item.Selected = true;

        // Add the ListItem object to the Items collection of the DropDownList.
        pageList.Items.Add(item);
      }
    }
  }
}

protected override void InitializeRow(GridViewRow row, DataControlField[] fields)
{
  base.InitializeRow(row, fields);

  if (row.RowType == DataControlRowType.Header)
  {
    for (int i = 0; i < row.Cells.Count; i++)
    {
      row.Cells[i].Controls.Clear();

      if (row.Cells[i].Text.Equals("CHKCOL", StringComparison.Ordinal))
      {
        CheckBox chkSelectAll = new CheckBox();
        chkSelectAll.ID = "chkSelectAllRows";
        row.Cells[i].Controls.Add(chkSelectAll);
      }
      else
      {
        row.Cells[i].Text = String.Format(CultureInfo.InvariantCulture, "<a href=\"javaScript:DataGridViewSort('{0}', '{2}');void(0)\" title=\"{1}\">{1}</a>", fields[i].SortExpression, fields[i].HeaderText, this.ClientID);
      }
    }
    //if (ViewState["SortExpression"] != null)
    //{
    //  int index;
    //  index = 0;// GetHeaderCellIndex(ViewState["SortExpression"].ToString());
    //  if (index != -1)
    //  {
    //    //Literal literal;
    //    //if ((SortDirection)ViewState["SortDirection"] == SortDirection.Ascending)
    //    //{
    //    //  if (string.IsNullOrEmpty(SortAscendingImageUrl))
    //    //  {
    //    //    literal = new Literal();
    //    //    literal.Text = "&#8593;";
    //    //    row.Cells[index].Controls.Add(literal);
    //    //  }
    //    //  else
    //    //  {
    //    //    sortImage.ImageUrl = SortAscendingImageUrl;
    //    //    row.Cells[index].Controls.Add(sortImage);
    //    //  }
    //    //}
    //    //else
    //    //{
    //    //  if (string.IsNullOrEmpty(SortDescendingImageUrl))
    //    //  {
    //    //    literal = new Literal();
    //    //    literal.Text = "&#8595;";
    //    //    row.Cells[index].Controls.Add(literal);
    //    //  }
    //    //  else
    //    //  {
    //    //    sortImage.ImageUrl = SortDescendingImageUrl;
    //    //    row.Cells[index].Controls.Add(sortImage);
    //    //  }
    //    //}
    //  }
    //}
  }
  else if (row.RowType == DataControlRowType.DataRow)
  {
    for (int i = 0; i < row.Cells.Count; i++)
    {
      if (fields[i].HeaderText.Equals("id", StringComparison.InvariantCultureIgnoreCase))
      {
        _IdColumnIndex = i;
        break;
      }
    }
  }
}

protected override void OnRowCreated(GridViewRowEventArgs e)
{
  base.OnRowCreated(e);

  if (e.Row.RowType == DataControlRowType.Header)
  {
    //HtmlImage img = new HtmlImage();
    //img.ID = "lbCheckAll";
    //img.Src = "/img/btn_slct_all.gif";
    //img.Alt = "Select all";
    //img.Attributes.Add("onclick", "SelectAllRows('" + this.ClientID + "',true);return false;");
    //e.Row.Cells[0].Controls.Add(img);
  }
  else if (e.Row.RowType == DataControlRowType.DataRow)
  {
    //AddCheckbox(e);
  }
  else if (e.Row.RowType == DataControlRowType.Footer)
  {
    //e.Row.Cells[0].Text = "sdsds";
  }
}

protected override void OnRowDataBound(GridViewRowEventArgs e)
{
  base.OnRowDataBound(e);

  if (e.Row.RowType == DataControlRowType.DataRow)
  {
    //AddCheckbox(e);

    if (_IdColumnIndex != -1)
      e.Row.Cells[_IdColumnIndex].Text = "<a href=\"Details.aspx?id=" + e.Row.Cells[_IdColumnIndex].Text + "\">Edit</a>";
  }
}

public override void Sort(string sortExpression, SortDirection sortDirection)
{
  DataView dv = this.DataSource as DataView;

  if (dv != null)
  {
    dv.Sort = sortExpression + " " + (sortDirection == SortDirection.Ascending ? "ASC" : "DESC");
  }
}

#region ICallbackEventHandler Members

private string callbackArg = String.Empty;

string ICallbackEventHandler.GetCallbackResult()
{
  // Save state with PageStatePersister and place it to Page.ClientState
  System.Reflection.MethodInfo mi = typeof(Page).GetMethod("SaveAllState", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.NonPublic);
  mi.Invoke(this.Page, null);

  // Get serialized viewstate from Page's ClientState
  System.Reflection.PropertyInfo stateProp = typeof(Page).GetProperty("ClientState", System.Reflection.BindingFlags.Instance | System.Reflection.BindingFlags.NonPublic);
  string state = stateProp.GetValue(this.Page, null).ToString();

  return callbackArg + "¤#¤" + state;
}

void ICallbackEventHandler.RaiseCallbackEvent(string eventArgument)
{
  try
  {
    // Load XML from client
    XmlDocument doc = new XmlDocument();
    doc.LoadXml(eventArgument.Replace("&", "&amp;"));
    string pagerId = String.Empty;

    if (doc.DocumentElement.Name == "callback")
    {
      string gridId = doc.DocumentElement["arguments"]["gridId"].InnerText;

      switch (doc.DocumentElement["action"].InnerText)
      {
        case "sort":
          string sortExpression = doc.DocumentElement["arguments"]["sortExpression"].InnerText;
          Sort(sortExpression.Split(' ')[0].Trim(), sortExpression.Split(' ')[1].Trim().Equals("ASC") ? SortDirection.Ascending : SortDirection.Descending);
          break;

        case "page":
          string pageIndex = doc.DocumentElement["arguments"]["pageIndex"].InnerText;
          this.PageIndex = Convert.ToInt32(pageIndex);
          pagerId = base.BottomPagerRow.Cells[0].FindControl(PAGER_ID).ClientID;
          break;

        case "search":
          break;
      }

      this.DataBind();
      callbackArg = String.Format("{0}¤|¤{1}¤|¤{2}", gridId, this.RenderHtml(), pagerId);
    }

    doc = null;
  }
  catch (Exception ex)
  {
    callbackArg = String.Format(AJAX_ERROR_FORMAT, ex.Message + "\n\n" + ex.StackTrace);
  }
  finally
  {
    if (callbackArg.Equals(string.Empty))
    {
      callbackArg = String.Format(AJAX_ERROR_FORMAT, "An AJAX Error occurred!");
    }
  }
}

#endregion 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-08-23T00:21:25.227

这对我有用.. PagerRows 必须设置为适当的部分。

我从 [http://www.codeproject.com/Members/iguigova?msg=3153516](http://www.codeproject.com/Members/iguigova?msg=3153516)得到这个提示 （搜索 MakeAccessible）

```
protected override void OnPreRender(EventArgs e)
{
    base.OnPreRender(e);

    if (Rows.Count > 0)
    {
        UseAccessibleHeader = true;
        HeaderRow.TableSection = TableRowSection.TableHeader;
        FooterRow.TableSection = TableRowSection.TableFooter;
    }

    if (TopPagerRow != null)
    {
        TopPagerRow.TableSection = TableRowSection.TableHeader;
    }
    if (BottomPagerRow != null)
    {
        BottomPagerRow.TableSection = TableRowSection.TableFooter;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T21:22:20.107

快速浏览一下，您需要确保将页眉和页脚分页器正确设置为 TableRowSection.TableHeader 或 TableRowSection.TableFooter。

您可能正在尝试将您的底部寻呼机绘制为一个 thead 而不是一个 tfoot。

我认为是由 WebControls.Table 引发的错误

# c++ - 仅用于数据的类与结构？

> ID：431429
> 
> 赞同：12
> 
> 时间：2009-01-10T17:54:32.850
> 
> 标签：c++, class, struct

在这种情况下，使用类而不是结构有什么优势吗？（注意：它只会保存变量，永远不会有函数）

```
class Foo { 
private:   
   struct Pos { int x, y, z };
public:    
   Pos Position; 
}; 
```

相对：

```
struct Foo {
   struct Pos { int x, y, z } Pos;
}; 
```

* * *

类似的问题：

*   [什么时候应该在 C++ 中使用类和结构？](https://stackoverflow.com/questions/54585/when-should-you-use-a-class-vs-a-struct-in-c)
*   [C ++中的结构和类有什么区别？](https://stackoverflow.com/questions/92859/what-are-the-differences-between-struct-and-class-in-c)
*   [我什么时候应该使用结构而不是类？](https://stackoverflow.com/questions/85553/when-should-i-use-a-struct-instead-of-a-class)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-10T17:58:23.063

在 c++ 中，使用其中一个并没有真正的优势，结构和类之间的唯一区别是其成员的默认可见性（结构默认为公共，类默认为私有）。

就个人而言，我倾向于将结构用于 POD 类型，而将类用于其他所有类型。

编辑：[litb](https://stackoverflow.com/users/34509/litb)在评论中提出了一个很好的观点，所以我要在这里引用他的话：

> 另一个重要的区别是结构默认派生自其他类/结构公共，而类默认派生私有。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-12T20:53:44.470

一方面，结构通常用于聚合初始化数据结构，因为所有非静态数据成员无论如何都必须是公共的（C++03、8.5.1/1）。

```
struct A {  // (valid)
{
   int a;
   int b;
} x = { 1, 2 };

struct A {  // (invalid)
private:
   int a;
   int b;
} x = { 1, 2 };

class A {  // (invalid)
   int a;
   int b;
} x = { 1, 2 };

class A {  // (valid)
public:
   int a;
   int b;
} x = { 1, 2 };

class A {  // (invalid)
public:
   int a;
private:
   int b;
} x = { 1, 2 }; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-10T17:59:08.117

`struct`并且在 C++ 中的`class`含义*完全相同*，只是结构成员和基的默认访问是公共的，而对于类是私有的。我倾向于为只有公共成员的类和其他所有类的类选择结构，但这只是一个样式问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-10T17:58:57.040

类和结构的*唯一*区别是结构成员默认是公共的，类成员默认是私有的。所以我说选择你最喜欢的那个。我敢肯定，对于哪个更具可读性，有一些争论，但我真的不认为这有什么大不了的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-11T00:16:50.600

本质上，结构和类之间的选择取决于你的风格和你想输入多少。

*   如果您在类/结构中只有公共成员，您不妨使用 struct 关键字。这将使您不必在以后输入“public：”。
*   选择结构而不是类的另一个原因是隐式记录对象的意图。因此，您将创建 POD 类型结构（即使它们包含构造函数和一些静态辅助方法等），并且您将对所有其他“常规”类使用类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T19:13:36.187

如果类型的内容没有内存分配问题（例如普通 int），那么`struct`如果这是您想要的方式，并且您已经做出有意识的决定，您可以向使用您的代码的人证明这一点，那么使用就可以了. 但是，如果任何成员是指针类型，那么您需要认真考虑内存管理问题。使用 a 可能仍然可以`struct`，但您更有可能需要一个析构函数和一些构造函数，等等。那个时候，你想要一个`class`.

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-10T17:58:43.763

“（注意：它只会保存变量，永远不会有函数）”

从来不是一个大词。通常“从不”的意思是“最终”。既然如此，我建议你使用一个类。这样，当事情发生变化时，你就没有太多需要改变的地方了。

Java（和 Python）的人在一切都是一个类的问题上相处得很好。没有这些被 C++ 称为“结构”的专门的无方法类并没有对他们造成任何伤害。

# process - 一个跨平台的流程管理工具

> ID：431431
> 
> 赞同：1
> 
> 时间：2009-01-10T17:55:27.797
> 
> 标签：process, cross-platform, schedule

我需要一个能够根据计划/配置启动一组进程的程序；该程序将在后台运行并重新启动进程，以防它们崩溃。

在 windows 和 unix 上都有用于此类任务的标准工具——我需要的是一个跨平台程序，它可以使用相同的配置在不同的操作系统上运行。

任何实现基本功能（即创建进程、通知进程终止事件等）的可移植 C/C++ 库也可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T16:34:15.260

你可能不得不自己写。它有很多令人讨厌的可移植性黑客，没有（真正的）光荣目的......即完成可以通过其他方式完成的事情的大量工作。

在 *nix、*bsd 和 MacOS 上运行一些东西不会太难。制作/生成解析器来处理某种简单的基于规则的配置文件不会太难。将最终的 Windows 香料添加到混合中将是一个皇家痛苦。然后你去学习一些新的基于 Python 的构建配置系统，因为不是每个 Windows 用户都有 cygwin 和 shell ......然后你去寻找帮助你发现错误的人。

几百小时后，你会开始怀疑它是否真的值得写。在 2 - 3 小时内，您可以让 cygwin、ssh 和一些方便的 shell 脚本完成这项工作。

据说大多数真正有用的程序都是程序员挠痒痒的直接结果。所以..如果这是你真正需要并且有时间去做的事情，我会说去做。当然，它会变得相当受欢迎。除此之外，出于上述原因，我怀疑这样的程序在相当长的一段时间内仍将是不成文的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T16:23:29.743

如果您愿意完全以 Unix 为中心，Cygwin 附带了一个可以在 Windows 上作为服务运行的*cron版本。*然后，您可以跨平台使用通用`crontab`文件。请参阅[http://www.noah.org/ssh/cygwin-crond.html](http://www.noah.org/ssh/cygwin-crond.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T18:11:21.523

在所有这些平台上安装[ssh 服务器](http://www.openssh.com/)并通过每个平台自己的命令行工具处理进程的启动/停止怎么样？

为了能够在没有提示身份验证的情况下访问，我将使用没有密码的非对称密钥身份验证，因此可以立即从控制机器访问所有托管主机。

所以我的解决方案将是一个自制的，由一堆脚本（.bat 或 .sh 或您想要的任何脚本语言）和几个 ssh 服务器组成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-10T04:18:39.607

Golang 中的 cron 实现怎么样？

[https://godoc.org/github.com/robfig/cron](https://godoc.org/github.com/robfig/cron)

它是跨平台的，并在您需要时发出您的命令。它作为一个小的可执行文件分发。不需要依赖。它允许您添加 crons，但有趣的是，remove 不是内置的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-06T12:31:02.043

[supervisord](http://supervisord.org/)是一个用户空间进程管理器，用 python 编写，适用于[unix](https://github.com/Supervisor/supervisor)和[windows](https://github.com/alexsilva/supervisor)

> supervisord 与 launchd、daemontools 和 runit 等程序有一些相同的目标。与其中一些程序不同，它并不意味着作为“进程 id 1”的 init 的替代品运行。相反，它旨在用于控制与项目或客户相关的流程，并且旨在在启动时像任何其他程序一样启动。

[相关：在 windows 上的 cygwin 上运行 supervisord-unix（ windows 版本的 supervisor](https://github.com/alexsilva/supervisor)可能不需要）

*   [是否有类似于supervisord的Windows？](https://stackoverflow.com/questions/7629813/is-there-windows-analog-to-supervisord)
*   [用于 Windows 的类似 Supervisord 的工具](https://superuser.com/questions/331675/supervisord-like-tool-for-windows)

# python - 安静地重启 Python 解释器

> ID：431432
> 
> 赞同：7
> 
> 时间：2009-01-10T17:56:27.137
> 
> 标签：python, interpreter

我在应用程序中嵌入了一个 python 解释器。该应用程序需要很长时间才能启动，并且我无法在不重新启动整个应用程序的情况下重新启动解释器。我想做的是本质上保存解释器的状态并轻松返回该状态。

我首先将所有模块的名称存储在 python 解释器开始使用的 sys.modules 中，然后在请求时从 sys.modules 中删除所有新模块。这似乎使解释器准备重新导入相同的模块，即使它之前已经导入了它们。但是，这似乎并不适用于所有情况，例如使用单例类和静态方法等。

如果可以避免的话，我宁愿不要在这个解释器中嵌入另一个解释器，因为将失去使用应用程序 API 的便利性（以及包括我想象的轻微的速度影响）。

那么，有没有人知道我可以存储解释器的状态然后返回到这个状态以便它可以应对所有情况的方法？

谢谢，

担

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-10T21:19:39.193

试试 ActiveState 食谱中的这段代码：http: [//code.activestate.com/recipes/572213/](http://code.activestate.com/recipes/572213/)

它扩展了 pickle，因此它支持对 shell 控制台中定义的任何内容进行酸洗。根据他们的文档，理论上你应该能够腌制**主模块：**

```
import savestate, pickle, __main__
pickle.dump(__main__, open('savestate.pickle', 'wb'), 2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T21:46:02.277

我建议解决根本原因问题。

> “应用程序需要很长时间才能启动，我无法在不重新启动整个应用程序的情况下重新启动解释器”

我怀疑这实际上是 100% 正确的。如果整个申请是国会法案的结果，好吧，它不能改变。但如果整个应用程序是由真人编写的，那么查找并移动代码以重新启动 Python 解释器应该是可能的。它比你为解决这个问题所做的*任何事情*都更便宜、更简单、更可靠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T00:24:43.283

> 将所有模块的名称存储在 python 解释器开始使用的 sys.modules 中，然后在请求时从 sys.modules 中删除所有新模块。这似乎使解释器准备重新导入相同的模块，即使它之前已经导入了它们。

在某些情况下可以使模块重新加载强制方法起作用，但它有点麻烦。总之：

*   您需要确保所有相互依赖的模块都立即重新加载。因此，任何执行“import y”或“from y import ...”的模块“x”都必须与模块“y”同时从 sys.modules 中删除。

*   如果您的应用程序或任何其他活动模块正在使用线程，则此过程将需要锁定保护。

*   任何在其他模块中留下指向自身的钩子的模块都无法有效地重新加载，因为对旧模块的引用将保留在未重新加载/不可重新加载的代码中。这包括异常钩子、信号、警告过滤器、编码、猴子补丁等。如果您开始愉快地重新加载包含其他人代码的模块，您可能会惊讶于他们这样做的频率，这可能会导致微妙和奇怪的错误。

所以要让它工作，你需要在相互依赖的模块之间有明确定义的边界——“它是在初始启动时导入的”可能还不够好——并确保它们被很好地封装而没有意外的依赖关系，比如猴子补丁。

这可以基于文件夹，因此例如 /home/me/myapp/lib 中的任何内容都可以作为一个单元重新加载，同时不理会其他模块 - 尤其是例如 stdlib 中的内容。/usr/lib/python2.x/ 通常不可靠地重新加载。如果需要，我在尚未发布的 webapp 重新加载包装器中提供了此代码。

最后：

*   您需要了解一些关于 sys.modules 的内部结构，特别是它会留下一堆“无”值来表示相对导入失败。如果您没有在删除其他模块值的同时删除它们，则后续导入模块的尝试可能（有时）最终导入“无”，从而导致令人困惑的错误。

这是一个令人讨厌的实现细节，可能会在未来的某个 Python 版本中改变和破坏您的应用程序，但这是以不受支持的方式使用 sys.modules 的代价。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T18:11:07.250

一种非常 hacky 和容易出错的方法可能是 ac 模块，它只是将内存复制到一个文件中，以便下次可以将其加载回来。但既然我无法想象这总是能正常工作，那么酸洗会是另一种选择吗？

如果您能够使所有模块都可腌制，那么您应该能够腌制 globals() 中的所有内容，以便可以再次重新加载。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-10T20:28:26.440

如果您事先知道正在使用的模块、类、函数、变量等...，您可以将它们腌制到磁盘并重新加载。如果您的环境包含许多未知数，我不确定解决该问题的最佳方法。不过，腌制全球和当地人可能就足够了。

# asp.net - 如何直接从 Visual Studio 2008 部署 Web 应用程序？

> ID：431443
> 
> 赞同：5
> 
> 时间：2009-01-10T18:01:25.740
> 
> 标签：asp.net, asp.net-mvc, visual-studio, deployment, amazon-ec2

我曾经使用 discountasp.net，我可以使用 Visual Studio 2008 将网站直接“发布”到网络主机。我现在正在使用专用服务器（准确地说是 Amazon EC2 Windows），我应该如何设置 Web 服务器以便可以直接从 VS 2008 部署网站？我尝试设置 FTP 服务器，但无法正常工作。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-10T18:19:30.680

这是来自官方 Amazon EC2 开发者站点的教程（“像典型的远程服务器一样将 ASP.NET 应用程序部署到 Amazon EC2。本教程向您展示如何”）

> 如果您需要直接从 Microsoft Visual Studio 部署 ASP.NET 应用程序，您可以使用 Microsoft Visual Studio 2005 及更高版本中提供的复制网站向导。
> 
> 复制网站向导允许您使用文件传输协议 (FTP) 或 Microsoft Office FrontPage 服务器扩展部署应用程序。要使用 FTP，您必须安装 IIS 的 FTP 组件，**并使用 ec2-authorize 命令允许端口 20 和 21 通过防火墙。**
> 
> [...]
> 
> 借助 Amazon EC2，您可以在 Amazon 数据中心中运行的专用 Windows 实例上部署 ASP.NET 应用程序。要部署应用程序，您需要基于 AMI 模板创建实例。创建实例后，您可以访问管理员密码，然后为服务器配置防火墙规则和远程桌面。要提供持久存储，您需要创建一个 EBS 卷，然后设置 IIS 和 ASP.NET 应用程序。您可以使用 Visual Studio 等工具或通过 FTP 将 ASP.NET 应用程序部署到服务器。

来自：[在 Amazon EC2 上部署 ASP.NET 应用程序](https://web.archive.org/web/20100305204730/http://developer.amazonwebservices.com/connect/entry.jspa?externalID=1791)（通过 archive.org）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-14T16:53:38.537

如果您想在 Amazon EC2 上运行 ASP.NET 应用程序，您可能需要考虑使用[AppHarbor](http://appharbor.com/)。AppHarbor 让您可以利用 Amazon 的可扩展且稳定的平台，而无需自己安装、管理和更新服务器。AppHarbor 还可以使用您选择的 Git、Mercurial、Subversion 或 TFS 使部署变得轻而易举。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T18:11:04.410

首先是一些基础知识 -

您是否已验证可以使用标准 FTP 客户端连接到 EC2 服务器上的 FTP 帐户？

您在服务器上使用什么 FTP 服务器？

您是否检查过 FTP 服务器支持哪些连接类型，主动或被动（或两者）。我认为发布网站向导将使用在您的 IE 浏览器 FTP 设置（工具 - 高级 - 使用被动 FTP）中指定的任何连接类型，默认是使用被动 FTP。

***更新：***[另请参阅@Splattne](https://stackoverflow.com/questions/431443/how-to-deploy-web-app-directly-from-visual-studio-2008#431477)关于在 ec2 防火墙上打开端口 20/21 的答案粗体文本

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T18:22:58.830

您可以在 IIS 中配置 FTP 服务器以接受使用您的 Windows 帐户的连接。请注意，您必须将 FTP 帐户的“主”目录指向您的 web 目录或其父目录（如果您使用父目录，您将配置系统以在登录时导航到 web 目录）。

这并不特定于 IIS，您还可以使用 IpSwitch 的付费服务器或 FileZilla 的免费服务器。

如果您无法使 FTP 工作，则可能是权限问题。请注意，这样做的“老派”方式只是发布到本地目录，压缩整个目录，然后将压缩的存档复制到服务器。在您让 FTP 工作之前，它可能会帮助您度过难关。

# c# - 在为 C# 程序编写数学函数时，F# 会表现良好吗？

> ID：431444
> 
> 赞同：7
> 
> 时间：2009-01-10T18:02:01.183
> 
> 标签：c#, performance, f#

有谁知道与 C# 相比，F# 在性能方面的衡量标准有多好。我有一个 C# 光线追踪器，其中包含许多矢量操作、光线碰撞算法等，我认为它们可能更容易在 F# 中表达。我不是在问 F# 在表达数学问题方面有多好，[这里](https://stackoverflow.com/questions/379722/is-f-really-better-than-c-for-math)已经回答了一些问题，而是我是否应该期待更好或更差的性能？由于光线追踪对性能的要求非常高，因此即使是性能不佳的小情况也可能在错误的地方出现问题。

**编辑：**

似乎已经有很多关于该主题的问题我找不到（如果您实际搜索带有“F#”一词的任何内容，则没有结果）。[这里](https://stackoverflow.com/questions/142985/is-a-program-f-any-more-efficient-execution-wise-than-c)的一个好点是以下答案：

> F# 提供了一些与性能相关的功能，这些功能可以发挥作用。
> 
> 首先，.NET 上的委托实现目前效率很低，因此，F# 使用自己的 FastFunc 类型来实现高性能的一流功能。
> 
> 其次，F# 使用 .NET 元数据来传递内联函数，以便它们可以跨 API 导出，当然，这可以在某些情况下显着提高性能。
> 
> 最后，模式匹配在 C# 中表达起来非常费力，因为该语言缺乏模式匹配，但几乎不可能维护与许多非平凡模式匹配等效的优化 C# 代码。相比之下，F# 编译器会在编译期间积极优化模式匹配。
> 
> 相反，C# 编译器更擅长使用 IEnumerables 优化循环，更擅长优化值类型的计算（例如复杂算术）。
> 
> 干杯，乔恩·哈罗普。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-10T21:23:27.703

**是的，F# 会表现得更好。**

以下是用不同语言实现的单线程算法的一些性能结果（神经网络的基准激活函数方法）：

**C＃：**

```
10^7 iterations using Sigmoid1() took 3899,1979 ms
10^7 iterations using Sigmoid2() took 411,4441 ms 
```

**纯C：**

```
10^7 iterations using sigmoid1: 628 ms
10^7 iterations using sigmoid2: 157 ms 
```

**F＃：**

```
10^7 iterations using sigmoid1: 588.843700 ms
10^7 iterations using sigmoid2: 156.626700 ms 
```

[更多细节](http://rabdullin.com/journal/2009/1/6/f-has-better-performance-than-c-in-math.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T18:14:14.560

对于计算，F# 的行为与 C# 相同（因为它只是 IL）。只要确保将您的向量表示为一个结构 - 因为您将构建许多短暂的对象。

度量单位对性能的影响为零，实际上在编译时度量单位信息被完全删除。因此，您实际上无法判断您的 F# 代码上是否有度量单位。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T18:16:42.057

F# 的性能与 C# 的性能大致相同，它们都编译为 IL，这是一个重要因素（与 IronPython 和 IronRuby 不同，它们被解释，因此速度慢得多）。算法的性能更多地取决于它的实现，而不是 F# 或 C# 的选择，因为 F# 将有助于在几行代码中实现它，与在 C# 中相比，在 F# 中发现优化的机会要大得多。

这篇文章对性能问题也有类似的看法：http: [//diditwith.net/2008/04/03/ApplesAndOranges.aspx](http://diditwith.net/2008/04/03/ApplesAndOranges.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T20:19:41.983

也许你已经知道了，但也许还没有。

Google 上的名字是“Luke Hoban”，他用 C# 3.0 做了一个光线追踪器，现在在微软的 F# 团队工作。

另请参阅：http: [//blogs.msdn.com/lukeh/](http://blogs.msdn.com/lukeh/)和[http://blogs.msdn.com/lukeh/archive/2007/04/03/a-ray-tracer-in-c-3-0。 .aspx](http://blogs.msdn.com/lukeh/archive/2007/04/03/a-ray-tracer-in-c-3-0.aspx) _

他应该知道。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-10T18:15:17.023

事实上，理论上，x86机器只能执行命令式的x86汇编，因此理论上可以命令式地实现函数式语言的性能。因此，您可以编写与 F# 同类程序相同或更好的 C# 程序。这里的关键字是**can**. 这并不意味着所有 C# 程序都比 F# 程序或类似的程序更好。通常，在大多数问题中，F# 的性能是可以接受的。在某些情况下，F# 的性能远远落后于 C#，但一般来说，对于大多数应用程序来说是可以的。但是，如果您想对代码实际执行的操作进行细粒度控制，那么函数式语言不适合您。C# 中的优化机会比 F# 中的多。顺便说一句，我所说的 F# 并不是指编写命令式代码，而是普通的函数式方法（如果您想以命令式方式编写代码，我认为 F# 没有多大意义）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T18:16:04.570

我最初的反应是，由于 C# 和 F# 都输出 MSIL，性能将是相同的。但是您使用的结构可能会产生不同的 IL。该主题已[在 SO](https://stackoverflow.com/questions/144227/c-f-performance-comparison)上的链接中进行了详细讨论。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-10T20:39:55.263

F# 更适合并行编程。所以开箱即用它可以比 C# 更快（在多核/cpu 上）。

但是话又说回来，您可以优化 C# 以同样使用它，但这需要更多的工作。

# windows - 类未注册 HRESULT 0x80040154

> ID：431455
> 
> 赞同：2
> 
> 时间：2009-01-10T18:09:11.933
> 
> 标签：windows, windows-vista

我在 Windows Vista 上使用 .NET 框架 6.0 版。我最近安装了一个显示图表的程序。当我打开它时，我收到来自 Microsoft .NET 框架的错误消息：

> 类未注册（HRESULT 异常：0x80040154 (REGDB_E_CLASSNOTREG)）。

我该如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T18:20:49.867

简单的答案是您注册课程。（如果你知道哪个类没有注册，以及它在哪个库中。）但是像这样的错误是一个很大的失败，他们没有告诉你这些重要的细节。

我认为您更好的选择是卸载软件，然后仔细重新安装，仔细阅读每个安装面板，检查先决条件或任何其他说明。并确保使用“以管理员身份运行”启动安装程序。

如果仍然失败，请致电该软件的技术支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T01:50:16.657

这可能是由于缺少依赖项或某些二进制文件的版本不正确。您可以通过使用 IL Disassembler 工具 (ildasm.exe) 查看程序集的清单来查看托管 (MSIL) 依赖项。要探索非托管（本机）世界中的依赖关系，请使用 Dependency Walker 工具 (depends.exe)。这些工具以各种方式随 .NET Framework、Visual Studio 等提供，或者可以在 Microsoft 的网站上获得。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T02:15:04.647

我认为6.0是Windows版本。与 Vista 版本相匹配。
但是，问题与 COM 注册有关。有一个类未注册，并且可能（正如abelenky 指出的那样）在设置时失败，因为它不是以管理员身份执行的。我的建议：

1.  再次以管理员身份运行安装程序（如果安装程序被命名为 setup 或 install 或带有这些词的名称，则应自动发生）然后再试一次
2.  如果它不起作用，以管理员身份运行应用程序
3.  如果仍然不起作用，请尝试查找依赖项，在这里我将在程序引用的 COM dll 上使用[Depencency Walker 。](http://www.dependencywalker.com/)

如果程序不是你的程序，还有一个未解决的问题，即那些 COM dll，程序引用？，我在这里：

1.  尝试注册程序文件夹中的所有 dll
2.  如果这不起作用，我会尝试按创建日期排序 System32 文件夹。

我正在考虑在 Vista 中不完全支持的应用程序以及如何强制安装它。

还有其他想法吗？

# java - 你能在Eclipse中定义你自己的模板变量吗

> ID：431465
> 
> 赞同：22
> 
> 时间：2009-01-10T18:12:02.833
> 
> 标签：java, eclipse, templates

在 Eclipse 中，有一些模板可以通过自动插入一些代码或注释来帮助您。您可以通过 Preferences > Java > Editor > Templates 自己编辑这些模板。您可以使用所谓的“模板变量”使这些模板更智能一些。

例如，有 ${see_to_overridden} 变量将“@see my.package.name.SpuerclassName#methodName(int, my.other.package.SomeType, ...)”插入到 javadoc 注释中。如果我可以定义自己的变量，那就太好了，这样我就可以获得 Superclassname、SomeType 等，而无需在其前面加上“@see”，这样我就可以例如链接到适当的方法。似乎不存在为此的模板变量，所以我想知道是否有任何方法可以创建自己的模板变量。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-10T20:01:40.973

根据Eclipse 团队的这篇[博客文章](http://dev.eclipse.org/blogs/jdtui/2007/12/04/text-templates-2/)（[替代链接），您可以。](http://web.archive.org/web/20100414054049/http://dev.eclipse.org/blogs/jdtui/2007/12/04/text-templates-2/)

扩展org.eclipse.ui.editors.templates，添加一个org.eclipse.jface.text.templates.TemplateVariableResolver，填写系统需要的值。如果您曾经定义过自己的模板，它们应该是不言自明的。

然后实现解析器，用适当的字符串替换您的变量。

博客文章包含更多详细信息和屏幕截图。

# c++ - 构建一个垂直的 IE 浏览器栏（带对象）（如收藏夹面板）

> ID：431467
> 
> 赞同：2
> 
> 时间：2009-01-10T18:14:13.810
> 
> 标签：c++, windows, internet-explorer

我正在尝试构建一个垂直的资源管理器栏（ IE7 中的[band 对象](http://msdn.microsoft.com/en-us/library/cc144099(VS.85).aspx))，它“粘在”所有选项卡上（类似于“收藏夹”栏）。

如果您不知道我在说什么，请打开 IE7 并转到 View->Explorer Bar->Research 以打开 Research 栏。在同一窗口中打开一个新选项卡，并注意研究栏未显示在新选项卡或您打开的任何其他新选项卡上。

另一方面，如果您打开收藏夹栏（查看-> 浏览器栏-> 收藏夹）并打开另一个选项卡。您会注意到该栏显示在所有窗口上。

这可以通过使用带对象来实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T17:47:17.280

In general, these band objects are created with a separate instance per tab in IE7/8\. In order to sync up your open/closed state, you may have to track all of your live instances of your band. When the user opens/closes the visible band, you would send an event to the others to invoke ShowBrowserBar().

# c++ - 取消引用指针的成本是多少？

> ID：431469
> 
> 赞同：50
> 
> 时间：2009-01-10T18:14:33.060
> 
> 标签：c++, pointers

对指针执行取消引用操作有多昂贵？

我可以想象内存传输在某种程度上与对象大小成正比，但我想知道取消引用操作部分的成本是多少。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-01-10T18:27:55.047

取消引用，当翻译成机器代码时，可能意味着不同的事情，这取决于您对取消引用的对象所做的事情。通过指针访问类的单个成员通常很便宜。例如，如果 c 是指向`class C`具有`int`成员 n 的实例的指针，则如下所示：

```
int n = c->n; 
```

可能会转换为一两条机器指令，并可能加载具有单个内存访问权限的寄存器。

另一方面，这意味着制作 c 指向的对象的完整副本：

```
C d = *c; 
```

这样做的成本将取决于 C 的大小，但请注意，复制是主要费用，“取消引用”部分实际上只是“使用”复制指令中的指针地址。

请注意，访问大对象的成员通常需要指针偏移计算和内存访问，无论该对象是否为本地对象。通常只有非常小的对象被优化为只存在于寄存器中。

如果您担心指针在引用上的成本，那就不要担心。这些之间的差异是语言语义差异，并且在生成机器代码时，指针和引用访问看起来完全一样。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-01-10T18:43:43.283

这取决于您如何处理取消引用的指针。单纯的取消引用操作本身并没有任何作用。如果您的指针`T`是`T*`

```
struct a {
    int big[42];
};

void f(a * t) {
    // does nothing. Only interesting for standard or compiler writers.
    // it just binds the lvalue to a reference t1\. 
    a & t1 = *t; 
} 
```

如果您实际上从取消引用操作返回的左值表示的该对象中获取值，则编译器必须复制该对象包含的数据。对于一个简单的 POD，这只是一个`memcpy`：

```
a aGlobalA;
void f(a * t) {
    // gets the value of of the object denoted by *t, copying it into aGlobalA
    aGlobalA = *t; 
} 
```

我的 gcc 端口为 f 输出此代码：

```
 sub     $29, $29, 24       ; subtract stack-pointer, creating this frame
    stw     $31, $29, 20       ; save return address
    add     $5, $0, $4         ; copy pointer t into $5 (src)
    add     $4, $0, aGlobalA   ; load address of aGlobalA into $4 (dst)
    add     $6, $0, 168        ; put size (168 bytes) as 3rd argument
    jal     memcpy             ; call memcpy
    ldw     $31, $29, 20       ; restore return address
    add     $29, $29, 24       ; add stack-pointer, destroying this frame
    jr      $31 
```

优化的机器代码将使用内联代码而不是调用`memcpy`，但这实际上只是一个实现细节。重要的是，这只是`*t`不执行任何代码，但访问该对象的值实际上需要复制它。

我们是否必须处理具有用户定义的复制赋值运算符的类型，事务更复杂：

```
struct a {
    int big[42];
    void operator=(a const&) { }
}; 
```

相同函数的代码`f`现在如下所示：

```
 sub     $29, $29, 8
    add     $29, $29, 8
    jr      $31 
```

哈。但这并没有那么令人惊讶，不是吗？毕竟，编译器应该调用 our `operator=`，如果它什么也不做，整个函数也什么都不做！

### 结论

我认为我们可以得出的结论是，这完全取决于如何使用 的返回值`operator*`。如果我们只有一个要取消引用的指针，我们在上面看到生成的代码很大程度上取决于环境。如果我们取消引用具有重载的类类型，我还没有展示它的行为`operator*`。但本质上，它的行为就像我们在`operator=`. 所有测量均使用 完成`-O2`，因此编译器正确内联调用:)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-10T19:51:29.650

在普通系统上取消引用指针的最重要因素是您可能会产生缓存未命中。SDRAM 内存中的随机访问花费数十纳秒（例如 64）。在千兆赫处理器上，这意味着您的处理器正在闲置数百（或>千）个周期，同时无法做任何其他事情。

只有在基于 SRAM 的系统上（您只能在嵌入式软件中找到），或者当您的软件经过缓存优化时，其他帖子中讨论的因素才会发挥作用。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-10T18:20:35.857

取消引用可能很昂贵，主要是因为它需要一条指令来从可能很远的内存中获取数据并且不显示引用的局部性。在这种情况下，处理器应该从非缓存内存甚至硬盘中获取数据（以防出现硬页错误）。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-10T18:47:55.537

取消引用（多个）会消耗 CPU 周期。

而不是写：

```
string name = first->next->next->next->name;
int age = first->next->next->next->age;

this is O(n) 
```

写成：

```
node* billy_block = first->next->next->next;

string name = billy_block->name;
int age = billy_block->age;

this is O(1) 
```

因此，您的代码不会为了到达第四个块而“询问”每个块。

多重取消引用就像有一个只知道他们旁边的邻居的邻居。

想象一下，如果你从第一个街区问一个人，你的朋友比利住在哪里，他会告诉你他不认识你的朋友，他会告诉你他只认识他们旁边的邻居，然后他就会告诉你问他的邻居，然后你会问他的邻居，他会回答和第一个街区一样的问题，你一直在问，直到你到达你朋友的街区。效率不是很高

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T18:30:24.213

指针的取消引用不应该比将地址复制到（地址）寄存器更多。就这样。

# c++ - Win32中的窗口边框宽度和高度 - 我如何获得它？

> ID：431470
> 
> 赞同：32
> 
> 时间：2009-01-10T18:14:46.243
> 
> 标签：c++, winapi

```
      ::GetSystemMetrics (SM_CYBORDER)

```

...返回 1，我知道标题栏比一个像素高：/

我也试过：

```
     矩形 r;
      r.left = r.top = 0; r.right = r.bottom = 400;
      ::AdjustWindowRect (& r, WS_OVERLAPPED, FALSE);
      _bdW = (uword)(r.right - r.left - 400);
      _bdH = (uword)(r.bottom - r.top - 400);

```

但是边界 w,h 回到 0。

在我的 WM_SIZE 处理程序中，我需要确保窗口的高度以“步长”变化，例如，一个全新的文本行可以适合窗口，底部没有“垃圾部分行空间”。

但是 ::MoveWindow 需要添加边框空间的尺寸。

以前一定有人这样做过...感谢您的帮助:)

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-01-10T19:01:49.783

[GetWindowRect](http://msdn.microsoft.com/en-us/library/ms633519(VS.85).aspx)和[GetClientRect](http://msdn.microsoft.com/en-us/library/ms633503(VS.85).aspx)函数可用于计算所有窗口边框的大小。

Suite101 有一篇关于[调整窗口大小和将客户区保持在已知大小](http://suite101.com/article/client-area-size-with-movewindow-a17846)的文章。

这是他们的示例代码：

```
void ClientResize(HWND hWnd, int nWidth, int nHeight)
{
  RECT rcClient, rcWind;
  POINT ptDiff;
  GetClientRect(hWnd, &rcClient);
  GetWindowRect(hWnd, &rcWind);
  ptDiff.x = (rcWind.right - rcWind.left) - rcClient.right;
  ptDiff.y = (rcWind.bottom - rcWind.top) - rcClient.bottom;
  MoveWindow(hWnd,rcWind.left, rcWind.top, nWidth + ptDiff.x, nHeight + ptDiff.y, TRUE);
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-09-01T14:47:27.820

```
int border_thickness = GetSystemMetrics(SM_CXSIZEFRAME); 
```

实际上，上述结果可能等于：

```
GetClientRect(hWnd, &rcClient); 
GetWindowRect(hWnd, &rcWind); 
int border_thickness = ((rcWind.right - rcWind.left) - rcClient.right) / 2; 
```

但`GetSystemMetrics(SM_CXSIZEFRAME)`更容易使用。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-10T18:26:58.700

我认为您正在寻找的是`SM_CYCAPTION`- 这是标题栏的高度。`SM_CYBORDER`是窗口水平边缘的高度。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-06T17:31:01.720

stukelly 建议的方法将起作用，除非窗口被最小化或没有完全初始化。在这些条件下为您提供边框大小的另一种方法是使用该`AdjustWindowRectEx`函数。这是一个例子：

```
CSize GetBorderSize(const CWnd& window)
{
   // Determine the border size by asking windows to calculate the window rect
   // required for a client rect with a width and height of 0
   CRect rect;
   AdjustWindowRectEx(&rect, window.GetStyle(), FALSE, window.GetExStyle());
   return rect.Size();
} 
```

根据应用程序，如果需要当前可见边框大小，则可能需要将此方法与 stukelly 的方法结合使用：

```
CSize GetBorderSize(const CWnd& window)
{
   if (window.IsZoomed())
   {
      // The total border size is found by subtracting the size of the client rect
      // from the size of the window rect. Note that when the window is zoomed, the
      // borders are hidden, but the title bar is not.
      CRect wndRect, clientRect;
      window.GetWindowRect(&wndRect);
      window.GetClientRect(&clientRect);
      return wndRect.Size() - clientRect.Size();
   }
   else
   {
      // Determine the border size by asking windows to calculate the window rect
      // required for a client rect with a width and height of 0\. This method will
      // work before the window is fully initialized and when the window is minimized.
      CRect rect;
      AdjustWindowRectEx(&rect, window.GetStyle(), FALSE, window.GetExStyle());
      return rect.Size();
   }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-10T18:45:45.727

Head Geek 给出了详细的答案：使用 GetSystemMetrics 将标题和边框位相加。您还可以对 GetWindowRect 和 GetClientRect 之间的宽度/高度进行区分。这将为您提供所有字幕/边框/等的总数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-12-31T19:06:11.820

[GetWindowInfo](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getwindowinfo)函数能够返回给定窗口的边框宽度和高度。成员获取垂直边框宽度，并
获取水平边框高度。[这也提供了这个答案](https://stackoverflow.com/a/431548/2128797) 的评论中提到的调整边框的值，这台机器上的值是 7px，在其他机器上可能会有所不同。因此，在进一步的测试中，检索到的成员值似乎只符合窗口的*一个*边框，而不是两者。`cxWindowBorders``cyWindowBorders`

 ** * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-24T13:22:41.803

您还有另一个解决方案...您可以通过在 WM_CREATE 和 WM_INITDIALOG 消息中调用专用函数来预先计算边界。并在您更改窗口样式或菜单分成两行时刷新值。

```
RECT cRect, wRect, oRect;
GetWindowRect(hWnd, &wRect);
GetClientRect(hWnd, &cRect);
MapWindowPoints(hWnd, NULL, (LPPOINT)&cRect, 2);

oRect.left = cRect.left - wRect.left;
oRect.top = cRect.top - wRect.top;
oRect.right = wRect.right - cRect.right;
oRect.bottom = wRect.bottom - cRect.bottom; 
```

# java - Alternative document structure in JTextPane?

> ID：431481
> 
> 赞同：0
> 
> 时间：2009-01-10T18:22:01.063
> 
> 标签：java, swing, jtextpane

In a JTextPane with a DefaultStyledDocument the document structure (hierarchy of Element objects) ends with a LeafElement that spans all the character of the enclosing paragraph. Is there a way to customize the document such that each leaf element will represent a single character?

(Background: I am trying to implementing a custom coloring scheme - somewhat similar to syntax coloring in an IDE. Using setCharacterAttributes() for this purpose is not an option, mainly due to performance considerations.)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-17T17:19:13.670

You may be interested in [jsyntaxpane](http://code.google.com/p/jsyntaxpane/ "JSyntaxPane"). It uses a PlainDocument instead of using the more resource hungry StyledDocument. A Leaf for each character will require lots of memory, so you may want to use a leaf for each "Token".

You can also use a StyledDocument then update the style for each Token in a separate Thread.

# iphone - iphone：将多点触控从设备发送到模拟器？

> ID：431485
> 
> 赞同：3
> 
> 时间：2009-01-10T18:24:44.523
> 
> 标签：iphone, cocoa-touch

我需要录制我正在开发的多点触控游戏的视频，我想从模拟器中录制它。我的想法是将触摸从设备发送到模拟器（就像[这个项目](http://code.google.com/p/accelerometer-simulator/wiki/Home)对加速度计所做的那样）。只是通过谷歌搜索我还没有找到类似的东西，但在我开始实施它之前，我想我会在这里问是否有人知道已经存在的解决方案。

为了清楚起见，我确实需要完整的多点触控（最多 5 个手指）。模拟器上可用的捏和拖动是不够的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-04T19:39:27.877

查看[iSimulate](http://www.vimov.com/isimulate/)，它是一个应用程序/库对，可让您在 iPhone 模拟器中使用多点触控（最多 5 个手指）、加速度计和 GPS。只需几分钟即可集成到您的 iPhone 项目中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T14:34:51.693

Matt Gallagher 有一篇关于[合成触摸事件](http://cocoawithlove.com/2008/10/synthesizing-touch-event-on-iphone.html)的文章，它可能会提供您正在寻找的内容，尽管我自己没有测试过。

# java - GWT 中的 Wiki 渲染

> ID：431491
> 
> 赞同：5
> 
> 时间：2009-01-10T18:28:15.030
> 
> 标签：java, gwt, wiki

当我们想要使用类似 wiki 的语法时，客户端渲染很有用。不幸的是，我还没有找到任何在 GWT 客户端提供 wiki 语法呈现的库。

有谁知道这样的 API/库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-15T22:52:36.710

也很不错：[http ://code.google.com/p/gwtwiki/](http://code.google.com/p/gwtwiki/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T18:53:55.197

听起来你想要一个 Javascript wiki 渲染 API。[http://www.mediawiki.org/wiki/Alternative_parsers](http://www.mediawiki.org/wiki/Alternative_parsers)列出了几个 Mediawiki（维基百科语法）。

还有一些基于 Java 的 wiki 标记解析器；您可以简单地在服务器端解析 wiki 标记。这里有些例子：

*   [JWPL](http://www.ukp.tu-darmstadt.de/software/jwpl/)包含一个 Mediawiki 标记解析器。
*   [MathEclipse Java 维基百科 API](http://www.matheclipse.org/en/Java_Wikipedia_API)
*   [米林](http://wiki.eclipse.org/Mylyn/Incubator/WikiText)
*   [java-维基百科解析器](http://code.google.com/p/java-wikipedia-parser/)

谷歌搜索可能会找到其他 wiki 语法的解析器，尽管 Mediawiki 似乎非常有名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T22:01:55.050

一位 XWiki 开发人员在他的博客中写道，他们开发了一个基于 GWT 的 Wiki 编辑器：

*   [XWiki 2009 年超速发展](http://massol.myxwiki.org/xwiki/bin/view/Blog/XWikiDevOverride)

# json - JSON 语法：传输数组

> ID：431494
> 
> 赞同：12
> 
> 时间：2009-01-10T18:32:26.723
> 
> 标签：json, serialization, data-transfer

**有效**的JSON 语法是这样的：

```
{
  "username": "admin",
  "password": "123"
} 
```

但是，如果我想传输一组“用户”（*给出示例*）而不是单个“用户”怎么办？

根据规范，以下代码是否为 Valid JSON？

```
[{
  "username": "admin",
  "password": "123"
}, {
  "username": "bbvb",
  "password": "sdfsdf"
}, {
  "username": "asd",
  "password": "222"
}] 
```

如果不是，那么使用 JSON 传输一组值的最佳方式是什么？（*对于“最佳方式”，我的意思是语法上）*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-10T18:36:11.020

是的，您的示例是有效的 JSON - 这正是您想要使用数组的方式。

**编辑**：[这是关于 JSON 及其用法的一个很好的链接。](http://www.json.org/fatfree.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-10T18:36:43.500

不太知名的页面[json.org](http://json.org/)有一个显示语法的图表。恕我直言，这非常容易理解。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-22T02:25:39.657

**Json 语法包括以下内容。**

```
 1\. Data is represented in name/value pairs.
 2\. Each name is followed by ':'(colon).
 3\. The name/value pairs are separated by ,(comma).
 4\. Json object starts and ends with '{' and '}'.
 5\. Square brackets '[ ]' hold arrays and values are separated by
    ,(comma). 
```

**Json 对象示例**

```
 {
    "id":"21",
    "language": "Json",
    "edition": "second",
    } 
```

**Json 数组示例**

```
 {
        "book": [
        {
        "id":"21",
        "language": "Json",
        "edition": "second"
        },
        {
        "id":"42",
        "language": "Json",
        "edition": "third"
        }]
        } 
```

我参考了[http://www.tutsway.com/json-syntax.php](http://www.tutsway.com/json-syntax.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T18:36:45.217

你在那里写的已经是正确的:)

```
[{ "username" : "admin", "password" : "123" }, { "username" : "bbvb", "password" : "sdfsdf" }, { "username" : "asd", "password" : "222" }] 
```

# c# - Cascade.SaveOrUpdate (SQLite) fluent-nhibernate

> ID：431509
> 
> 赞同：1
> 
> 时间：2009-01-10T18:39:31.467
> 
> 标签：c#, nhibernate, fluent-nhibernate, nhibernate-mapping

我有两个类之间的多对多关系：锦标赛和玩家

我在映射中设置了 Cascade.SaveUpdate，但是在保存 Tournament 实例时，Players 不会保存到 Players 表中。Nhibernate 只在链接表中写入父键列和子键列。数据库是 SQLite。

这些是映射

```
 public TournamentMap()
    {
        WithTable("Tournaments");
        Id(x => x.Name);
        Map(x => x.Start).Access.AsLowerCaseField();
        Map(x => x.End).Access.AsLowerCaseField();

        HasManyToMany<Player>(x => x.Players)
            .WithTableName("TournamentsPlayers")
            .WithParentKeyColumn("tournamentName")
            .WithChildKeyColumn("playerName").AsSet()
            .Access.AsLowerCaseField()
            .Cascade.SaveUpdate().LazyLoad();

        References(x => x.Type).Access.AsLowerCaseField()
            .TheColumnNameIs("typeName")
            .Cascade.SaveUpdate();
    }

  public class PlayerMap : ClassMap<Player>
{
    public PlayerMap()
    {
        WithTable("Players");
        Id(x => x.Name);

        HasManyToMany<Player>(x => x.Tournaments)
            .Access.AsLowerCaseField()
            .WithTableName("TournamentsPlayers")
            .WithParentKeyColumn("playerName")
            .WithChildKeyColumn("tournamentName").AsSet()
            .Cascade.SaveUpdate().IsInverse().LazyLoad();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T03:44:47.837

也许晚了一点（或很多），但尽管如此，

我将您的示例简化为如下所示：

```
public class Tournament
{
    public virtual Guid Id { get; private set; }

    private readonly ISet<Player> players;

    public Tournament()
    {
        players = new HashedSet<Player>();
    }

    public virtual ISet<Player> Players
    {
        get { return players; }
    }

    public virtual void AddPlayer(Player player)
    {
        players.Add(player);
    }
}

public class Player 
{
    public virtual Guid Id { get; private set; }

    private readonly ISet<Tournament> tournaments;

    public Player()
    {
        tournaments = new HashedSet<Tournament>();
    }

    public virtual ISet<Tournament> Tournaments
    {
        get { return tournaments; }
    }

    public virtual void AddTournament(Tournament tournament)
    {
        tournaments.Add(tournament);
    }
}

public class TournamentMap : ClassMap<Tournament>
{
    public TournamentMap()
    {
        Id(x => x.Id).GeneratedBy.GuidComb();

        HasManyToMany<Player>(x => x.Players)
            .AsSet().Access.AsLowerCaseField()
            .Cascade.SaveUpdate();
    }
}
public class PlayerMap : ClassMap<Player>
{
    public PlayerMap()
    {
        Id(x => x.Id).GeneratedBy.GuidComb();

        HasManyToMany<Tournament>(x => x.Tournaments)
            .Access.AsLowerCaseField()
            .AsSet()
            .Cascade.SaveUpdate().Inverse();
    }
} 
```

第一个测试看起来像：

```
 [Test]
    public void CanSavePlayerAttachedToTournament()
    {
        Player player = new Player();
        Tournament tournament = new Tournament();
        player.AddTournament(tournament);
        tournament.AddPlayer(player);
        Session.Save(tournament);
        Session.Flush();
    } 
```

并产生以下 sql：

NHibernate：插入“锦标赛”（Id）值（@p0）；@p0 = '65559bba-8603-4874-8a8f-9bf4018596df' NHibernate：插入“玩家”（ID）值（@p0）；@p0 = '549e10​​7c-1339-4fab-8960-9bf4018596e8' NHibernate: 插入 PlayerToTournament (Tournament_id, Player_id) 值 (@p0, @p1); @p0 = '65559bba-8603-4874-8a8f-9bf4018596df'，@p1 = '549e10​​7c-1339-4fab-8960-9bf4018596e8'

第二个测试看起来像：

```
 [Test]
    public void CanSaveTounamentAttachedToPlayer()
    {
        Player player = new Player();
        Tournament tournament = new Tournament();
        player.AddTournament(tournament);
        tournament.AddPlayer(player);
        Session.Save(player);
        Session.Flush();
    } 
```

并产生以下 sql：

NHibernate：插入“播放器”（Id）值（@p0）；@p0 = '35c078c5-1102-4c63-91ca-9bf40185971c' NHibernate：插入“锦标赛”（Id）值（@p0）；@p0 = '367898cf-5835-4e1b-9d7d-9bf40185971c' NHibernate: 插入 PlayerToTournament (Tournament_id, Player_id) 值 (@p0, @p1); @p0 = '367898cf-5835-4e1b-9d7d-9bf40185971c'，@p1 = '35c078c5-1102-4c63-91ca-9bf40185971c'

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-10-22T06:36:54.213

始终在交易中保存。

干杯

# c# - 确定表是否存在于 SQL Server CE 中？

> ID：431511
> 
> 赞同：18
> 
> 时间：2009-01-10T18:41:41.680
> 
> 标签：c#, sql, sql-server, sql-server-ce

我知道这与[这个问题](https://stackoverflow.com/questions/167576/sql-server-check-if-table-exists)类似，但我在 C# 中使用 SQL Server CE 3.5 和 WinForms 项目。如何确定表是否存在？我知道`IF`不支持关键字，但支持`EXISTS`。CE 中是否存在 information_schema 可以查询它？谢谢。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-10T18:51:21.567

是的，它确实存在：

```
SELECT *
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_NAME = 'TableName' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T00:34:03.790

作为替代方案，您可以查询表并捕获抛出的异常。如果有异常，则表未找到，否则表存在。

```
SELECT TOP 1 1 FROM TableName; 
```

一个小而简单的性能测试比针对 INFORMATION_SCHEMA 的查询有更好的结果。尽管我认为针对 INFORMATION_SCHEMA 的查询更清洁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-08T07:08:01.503

使用数据库助手：

```
var db = Database.Open("MyDatabase");
var sql = @"SELECT Count(*) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MyTable'"
var count = db.QueryValue(sql);
if(count.Equals(1)){
    //table exists
} 
```

# linux - 在 shell 中运行命令并在关闭会话时继续运行该命令

> ID：431521
> 
> 赞同：35
> 
> 时间：2009-01-10T18:46:55.977
> 
> 标签：linux, shell, command

我正在使用 Putty 连接到远程服务器。我想知道的是，在我关闭与 Putty 的会话后，是否有任何方法可以编写我的命令并允许它们继续运行。这样做的原因是我不想让电脑一直开着。有没有办法做到这一点？

**更新解决方案**

对于我提出的问题，最好的解决方案是使用提供的命令之一，例如**nohup**，因为您不必安装任何其他软件。但是，如果您遇到同样的问题，请安装并使用它。这是惊人的。

我选择了 Norman Ramsey 的答案作为最喜欢的答案，因为使用 commands 和**screen**提出了几种解决方案。但是请特别检查 PEZ 的其他答案，然后您将了解屏幕能够做什么。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-01-10T19:20:09.323

**屏幕！**这是自切片面包以来最好的事情。（是的，我知道其他人已经提出了建议，但这太好了，全世界都应该加入并提出建议。）

screen 就像，像，嗯……就像使用 VNC 或类似的东西连接到 GUI destop，但用于命令 shell 窗口。您可以在同一个屏幕会话中同时打开多个外壳“窗口”。您可以执行以下操作：

1.  使用“screen -dR”启动屏幕会话（习惯使用 -dR）
    *   在一个窗口中运行一些命令
    *   按`CTRL`- `A`,`C`创建一个新窗口在 vim 中打开一个文件
    *   按`CTRL`- `A`,`0`返回第一个窗口并对刚刚编辑的文件发出一些命令
    *   `CTRL`- `A`,`1`回到你的 vim 会话
    *   `CTRL`- `A`，`C`对于另一个窗口，也许做“sudo - su”（因为你恰好需要一个完整的 root shell）
    *   `CTRL`- `A`，`0`并启动后台进程
    *   `CTRL`- `A`，`C`创建一个新窗口，“tail -f”该后台进程的日志
    *   `CTRL`- `A`,`d`断开您的屏幕然后`CTRL`-`D`断开与服务器的连接
    *   去度假三周
    *   再次登录服务器并发出“screen -dR”以连接到您现有的屏幕会话
    *   `CTRL`用-检查第四个窗口中的日志`A`，`3`（就像你一直在那里看着它一样）
    *   `CTRL`- `A`，`1`再次拿起那个vim会话
    *   我猜你现在开始看照片了？=)

这就像魔术一样。我使用屏幕的时间比我记忆中的要长，但我仍然对它的出色表现感到惊讶。

**编辑**：只想提一下现在还有**tmux**。非常像**screen**，但有一些独特的功能，分割窗口是最突出的。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-01-10T18:58:57.277

`nohup`, `disown`, 和`screen`都很好，但是`screen`是最好的，因为与其他两个不同，它`screen`允许您断开与远程服务器的连接，保持一切运行，然后稍后重新连接以查看发生了什么。和你不能恢复互动`nohup`。`disown`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-10T18:48:49.967

尝试使用[GNU Screen](http://www.gnu.org/software/screen/)。它允许您一次打开多个 shell。您可以断开与那些正在运行的 shell（即与 Putty 的关闭会话）的连接，他们将继续做他们的事情。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-10T18:48:08.813

您正在寻找的是[nohup](http://en.wikipedia.org/wiki/Nohup)。

请参阅 wiki 链接了解如何使用它。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-11T04:40:35.137

`screen`是最好的。

尝试：

```
screen -dmS "MyTail" tail -f /var/log/syslog 
```

这个在后台启动命令。

用于`screen -r`列出，或使用`screen -r`Mytail 进入会话。

如果更多用户需要访问同一个会话，请使用：screen -rx MyTail，两个或多个用户共享会话。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-10T19:13:47.857

如果您不能使用`screen`（例如，因为您的 SSH 会话是由程序驱动的），您也可以使用[daemonize](http://www.clapper.org/software/daemonize/)将程序作为守护程序运行。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-11-13T05:51:38.643

一种对我很有效的方法是`at`.

`at`像 cron 一样工作，但是是一次性工作。我今天用它来下载一个大文件，而不必让我的会话保持活动状态。

例如：

```
$ at 23:55
at> wget http://file.to.download.com/bigfile.iso
at> ^D 
```

你打发`at`时间（在未来），它会给你一个提示。您输入当时要运行的命令，然后按 ctrl+d。您可以退出会话，它将在指定时间运行命令。

[维基百科](http://en.wikipedia.org/wiki/At_%28Unix_command%29)有更多信息`at`。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-10T18:54:47.877

```
./command & disown 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-10T06:45:43.580

```
ssh localhost && ./command && exit 
```

# haskell - 模棱两可的类型变量错误消息

> ID：431527
> 
> 赞同：22
> 
> 时间：2009-01-10T18:49:44.643
> 
> 标签：haskell, type-inference, typeclass

我不认为这是一个错误，但我有点困惑为什么这不起作用。一个额外的问题是为什么它提到变量 e？没有变量 e。

```
    Prelude> :m +Control.Exception
    Prelude Control.Exception> 句柄 (\_-> return "err") 未定义

    <交互式>:1:0:
        约束中的模糊类型变量“e”：
          `异常 e'
            由在 <interactive>:1:0-35 处使用 `handle' 引起
        可能的修复：添加修复这些类型变量的类型签名
    Prelude Control.Exception>

```

显然它在 ghci 6.8 中运行良好，我使用的是 6.10.1。

编辑：我已经最小化了代码。我希望在 6.8 和 6.10 中都有相同的结果

```
class C a                                                                                                     

foo :: C a => (a -> Int)-> Int                                                                                
foo _ = 1                                                                                                     

arg :: C a => a -> Int                                                                                        
arg _ = 2                                                                                                     

bar :: Int                                                                                                    
bar = foo arg 
```

试图编译它：

```
[1 of 1] 编译 Main（/tmp/foo.hs，解释）

/tmp/foo.hs:12:10:
    约束中的模糊类型变量“a”：
      由在 /tmp/foo.hs:12:10-12 使用 `arg' 引起的 `C a'
    可能的修复：添加修复这些类型变量的类型签名
失败，加载模块：无。
Prelude Control.Exception>

```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-07T01:57:28.930

的类型`Control.Exception.handle`是：

```
handle :: Exception e => (e -> IO a) -> IO a -> IO a 
```

您看到的问题是 lambda 表达式的`(\_ -> return "err")`类型不是. 清如泥？好的。现在我将提供一个实际上应该有用的解决方案:)`e -> IO a``e``Exception`

它只是发生在你的情况下，`e`应该是`Control.Exception.ErrorCall`因为`undefined`使用`error`which throws `ErrorCall`（的实例`Exception`）。

要处理您的使用，`undefined`可以定义如下内容`handleError`：

```
handleError :: (ErrorCall -> IO a) -> IO a -> IO a
handleError = handle 
```

它本质上是一个别名`Control.Exception.handle`，`e`固定 as `ErrorCall`which is what `error`throws。

在**GHCi 7.4.1**中运行时看起来像这样：

```
ghci> handleError (\_ -> return "err") undefined
"err" 
```

要处理所有异常，`handleAll`可以编写如下函数：

```
handleAll :: (SomeException -> IO a) -> IO a -> IO a
handleAll = handle 
```

捕获所有异常的后果在`Control.Exception`文档摘录中有很好的描述：

> # 捕获所有异常
> 
> 可以使用以下类型捕获所有异常`SomeException`：
> 
> ```
> catch f (\e -> ... (e :: SomeException) ...) 
> ```
> 
> 但是，这通常不是您想要做的！
> 
> 例如，假设您要读取一个文件，但如果它不存在，则继续，就好像它包含`""`. 您可能很想捕获所有异常并`""`在处理程序中返回。然而，这会带来各种不良后果。例如，如果用户在恰当的时刻按下了 control-C，那么`UserInterrupt`异常就会被捕获，并且程序会继续运行，并认为文件包含`""`. 同样，如果另一个线程试图杀死读取文件的线程，那么`ThreadKilled`异常将被忽略。
> 
> 相反，您应该只准确捕获您真正想要的异常。在这种情况下，这可能比“任何 IO 异常”更具体；权限错误也可能希望以不同方式处理。相反，您可能想要类似的东西：
> 
> ```
>  e <- tryJust (guard . isDoesNotExistError) (readFile f)
>  let str = either (const "") id e 
> ```
> 
> 有时您确实需要捕获任何类型的异常。但是，在大多数情况下，这只是为了您可以进行一些清理；您实际上对异常本身并不感兴趣。例如，如果您打开一个文件，那么您想再次关闭它，无论处理该文件是正常执行还是抛出异常。但是，在这些情况下，您可以使用 和 之类的函数，`bracket`它们实际上不会向您传递异常，而只是在适当的位置调用清理函数。`finally``onException`
> 
> 但有时您确实需要捕获任何异常，并实际查看异常是什么。一个例子是在程序的最顶层，您可能希望捕获任何异常，将其打印到日志文件或屏幕上，然后优雅地退出。对于这些情况，您可以`catch`对类型使用（或其他异常捕获函数之一）`SomeException`。

**资料来源：[http ://www.haskell.org/ghc/docs/latest/html/libraries/base/Control-Exception.html#g:4](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Control-Exception.html#g:4)**

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-10T19:06:07.637

此问题仅在 GHC 6.10 中出现；它不能在 GHC 6.8 中复制，因为类型`handle`不同：

```
: nr@homedog 620 ; ghci
GHCi, version 6.8.2: http://www.haskell.org/ghc/  :? for help
Loading package base ... linking ... done.
Prelude> :m +Control.Exception
Prelude Control.Exception>  handle (\_ -> return "err") undefined
"err"
Prelude Control.Exception> 
```

* * *

好吧，也许我终于可以做到这一点了。我认为问题*不*在于单态限制，而是您遇到了读取/显示问题的一个实例：您提供处理某种类型的异常，在新版本的 `handle 中，有不止一种类型异常，并且该异常的类型不会出现在您的结果中。所以编译器无法知道你试图处理*哪种类型的异常。*解决这个问题的一种方法是选择一个。这是一些有效的代码：

```
Prelude Control.Exception> let alwaysError :: SomeException -> IO String; alwaysError = \_ -> return "err"
Prelude Control.Exception> handle alwaysError undefined
"err" 
```

顺便说一句，`handle`GHC 库文档中的示例使用不能在 6.10 下编译。我已经提交了错误报告。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-24T10:48:52.493

一种解决方法是`Control.OldException`在 ghc 6.10.* 中使用，而不是`Control.Exception`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-26T03:02:33.663

尝试为您的处理程序提供 type `SomeException -> IO x`，其中 x 是具体类型，例如

```
import Control.Exception
let f _ = putStrLn "error" :: SomeException -> IO () 
in handle f undefined 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-10T19:18:26.660

“异常 e”可能来自“句柄”的类型签名。

[文档](http://haskell.org/ghc/docs/latest/html/libraries/base/Control-Exception.html#v:handle) 说：

```
handle :: Exception e => (e -> IO a) -> IO a -> IO a 
```

在 GHC 6.8 中它曾经是不同的，这可以解释为什么我没有得到那个错误。

```
handle :: (Exception -> IO a) -> IO a -> IO a 
```

似乎您遇到了单态性限制。“_”-模式必须是单态的（它与 ghc 6.8 相同）或显式类型。“解决方法”是将模式放在定义的左侧，它构成了 Haskell 报告中指定的“简单模式绑定”。

尝试这个：

```
let f _ = return "err"
handle f undefined 
```

[http://www.haskell.org/haskellwiki/Monomorphism_restriction](http://www.haskell.org/haskellwiki/Monomorphism_restriction)

# c++ - C++：从 dll 动态加载类

> ID：431533
> 
> 赞同：29
> 
> 时间：2009-01-10T18:52:31.783
> 
> 标签：c++, windows, class, dll

对于我当前的项目，我希望能够从 dll 加载一些类（这并不总是相同的，甚至在我的应用程序编译时可能不存在）。一个给定的类也可能有几个替代的 dll（例如 Direct3D9 的实现和 OpenGL 的一个实现），但任何时候只有一个 dll 将被加载/使用。

我有一组定义接口的基类以及我要加载的类的一些基本方法/成员（即用于引用计数的方法/成员），然后 dll 项目在创建类时从中派生。

```
//in namespace base
class Sprite : public RefCounted//void AddRef(), void Release() and unsigned refCnt
{
public:
    virtual base::Texture *GetTexture()=0;
    virtual unsigned GetWidth()=0;
    virtual unsigned GetHeight()=0;
    virtual float GetCentreX()=0;
    virtual float GetCentreY()=0;
    virtual void SetCentre(float x, float y)=0;

    virtual void Draw(float x, float y)=0;
    virtual void Draw(float x, float y, float angle)=0;
    virtual void Draw(float x, float y, float scaleX, flota scaleY)=0;
    virtual void Draw(float x, float y, float scaleX, flota scaleY, float angle)=0;
}; 
```

问题是我不确定如何做这一切，以便可执行文件和其他 dll 可以加载和使用这些类，因为我只使用过只有一个 dll 的 dll，我可以让 Visual Studio 链接器对其进行排序使用我在编译 dll 时得到的 .lib 文件。

我不介意使用工厂方法来实例化类，其中许多已经通过设计（即精灵类是由主图形类创建的，例如 Graphics->CreateSpriteFromTexture(base::Texture*)

编辑：当我需要编写一些用于 python 的 c++ dll 时，我使用了一个名为 pyCxx 的库。生成的 dll 基本上只导出了一个方法，该方法创建了“模块”类的实例，然后可以包含工厂方法来创建其他类等。

生成的 dll 可以仅使用“import [dllname]”在 python 中导入。

```
//dll compiled as cpputill.pyd
extern "C" void initcpputill()//only exported method
{
    static CppUtill* cpputill = new CppUtill;
}

class CppUtill : public Py::ExtensionModule<CppUtill>
{
public:
    CppUtill()
    : Py::ExtensionModule<CppUtill>("cpputill")
    {
        ExampleClass::init_type();

        add_varargs_method("ExampleClass",&CppUtill::ExampleClassFactory, "ExampleClass(), create instance of ExampleClass");
        add_varargs_method("HelloWorld",  &CppUtill::HelloWorld,  "HelloWorld(), print Hello World to console");

        initialize("C Plus Plus module");
    }
...
class ExampleClass
...
    static void init_type()
    {
        behaviors().name("ExampleClass");
        behaviors().doc ("example class");
        behaviors().supportGetattr();
        add_varargs_method("Random", &ExampleClass::Random, "Random(), get float in range 0<=x<1");
    } 
```

这究竟是如何工作的，我可以在纯 c++ 环境中使用它来解决我的问题吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-10T19:25:03.417

恕我直言，最简单的方法是使用一个简单的 C 函数，该函数返回一个指向其他地方描述的接口的指针。然后，您的应用程序可以调用该接口的所有功能，而无需实际知道它正在使用什么类。

编辑：这是一个简单的例子。

在您的主应用程序代码中，您为界面创建一个标头：

```
class IModule
{
public:
    virtual ~IModule(); // <= important!
    virtual void doStuff() = 0;
}; 
```

主应用程序被编码为使用上面的接口，没有关于接口的实际实现的任何细节。

```
class ActualModule: public IModule
{
/* implementation */
}; 
```

现在，模块——DLL 具有该接口的实际实现，甚至不必导出这些类——`__declspec (dllexport)`不再需要。模块的唯一要求是导出单个函数，该函数将创建并返回接口的实现：

```
__declspec (dllexport) IModule* CreateModule()
{
    // call the constructor of the actual implementation
    IModule * module = new ActualModule();
    // return the created function
    return module;
} 
```

注意：错误检查被忽略了——你通常想检查一下，如果 new 返回了正确的指针，你应该保护自己免受类的构造函数中可能抛出的异常的影响`ActualModule`。

然后，在您的主应用程序中，您只需要简单地加载模块（`LoadLibrary`函数）并找到函数`CreateModule`（`GetProcAddr`函数）。然后，您通过接口使用该类。

编辑 2：您的 RefCount （接口的基类），可以在主应用程序中实现（并从中导出）。然后，您的所有模块都需要链接到主应用程序的 lib 文件（是的！EXE 文件可以像 DLL 文件一样具有 LIB 文件！）这就足够了。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-10T19:42:30.857

您正在重新发明 COM。您的 RefCounted 类是 IUnknown。您的抽象类是一个接口。DLL 中的 COM 服务器有一个名为 DllGetClassObject() 的入口点，它是一个类工厂。微软提供了很多关于 COM 的文档，随便看看他们是如何做到的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-10T21:12:47.163

[编辑：当我在撰写这一切时，保利乌斯·马鲁什卡编辑了他的评论，说的基本相同。因此，对任何重复表示歉意。虽然我想你现在有一个备用的:)]

在我的脑海中，假设 Visual C++ ......

您需要使用 LoadLibrary 动态加载 DLL，然后使用 GetProcAddress 从中检索将创建 DLL 代码实现的实际派生类的函数的地址。您如何决定如何准确地执行此操作取决于您（需要查找 DLL，需要指定公开其功能的方式等），所以现在让我们假设插件仅提供新的 Sprite 实现。

为此，请确定主程序将调用以创建这些新精灵之一的 DLL 中函数的签名。这个看起来很合适：

```
typedef Sprite *(*CreateSpriteFn)(); 
```

然后，从主程序中，您必须加载一个 DLL（同样，如何找到该 DLL 取决于您）并从中获取精灵创建函数。我决定将精灵创建函数称为“CreateSprite”：

```
HMODULE hDLL=LoadLibrary(pDLLName);
CreateSpriteFn pfnCreateSprite=CreateSpriteFn(GetProcAddress(hDLL,"CreateSprite")); 
```

然后要实际创建其中之一，只需调用该函数：

```
Sprite *pSprite=(*pfnCreateSprite)(); 
```

一旦你完成了 DLL 并且没有留下任何由它创建的对象，你就可以使用 FreeLibrary 来摆脱它：

```
FreeLibrary(hDLL); 
```

要创建一个支持此接口的 DLL，请为派生类编写代码等，然后在 DLL 代码的某处使用适当的签名提供调用程序所需的 CreateSprite 函数：

```
__declspec(dllexport)
extern "C"
Sprite *CreateSprite()
{
    return new MyNewSprite;
} 
```

dllexport 的意思是您可以使用 GetProcAddress 按名称选择此函数，而 extern "C" 确保名称未损坏并且不会以 "CreateSprite@4" 或类似名称结尾。

另外两个注意事项：

1.  如果 GetProcAddress 找不到该函数，则返回 0，因此您可以使用它来扫描 DLL 列表（例如，从 FindFirstFile 和朋友返回）以查找支持该接口的 DLL，和/或尝试查找多个入口点并支持每个插件的多种类型。
2.  如果主程序要使用delete 操作符删除精灵，这就要求DLL 和主程序都使用相同的运行时库构建，这样主程序的delete 和DLL 的new 都使用同一个堆。您可以通过让 DLL 提供一个 DeleteSprite 函数在一定程度上解决此问题，该函数使用 DLL 的运行时库而不是主程序的运行时库来删除精灵，但您仍然需要注意程序的其余部分，所以您可能只是想要强制 DLL 编写者使用与您的程序相同的运行时库。（我不会说你这样做会很好，但这并不少见。例如，3D Studio MAX 需要这个。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-10T19:21:41.693

也许您想研究 DLL 延迟加载 ( [http://www.codeproject.com/KB/DLL/Delay_Loading_Dll.aspx](http://www.codeproject.com/KB/DLL/Delay_Loading_Dll.aspx) ) - 这将为您提供您想要的东西，而不必为此付出太多努力

# lucene - 搜索确切的短语

> ID：431556
> 
> 赞同：1
> 
> 时间：2009-01-10T19:10:12.450
> 
> 标签：lucene

如何使用 BooleanQuery/任何其他类在此字段上实现“精确短语”功能？例如，如果用户输入“畅销书”，那么它应该返回描述中包含该短语的书籍。

再次感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T19:14:30.397

将查询放在双引号内应该可以工作。

# asp.net - ASP.net：在 asp.net 网页中显示 PDF

> ID：431560
> 
> 赞同：2
> 
> 时间：2009-01-10T19:14:08.463
> 
> 标签：asp.net

用户单击链接按钮，它会将他们定向到动态生成的 pdf 文件的 url。浏览器将提示用户保存或打开它。

我想知道是否可以将 pdf 文件下载到服务器，然后在 asp.net 网页中显示 pdf 文件。当我在这个问题上搜索时，99% 的顶部链接是一些第三方组件。是否可以在不购买任何第三方组件的情况下做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-10T19:28:08.793

我使用[itextsharp](http://sourceforge.net/projects/itextsharp/)，它是 java itext 库的免费开源 c# 端口。

使在 asp.net 中生成动态 pdf 变得轻而易举，并且有很多文档/示例随处可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T19:22:35.437

如果没有 3rd 方组件，我认为您不会有太多运气。首先，问题不是显示 PDF，而是生成它。为此，您需要一个库来提供帮助。除非您手头有大量无偿时间，否则 自己滚动一个*不会更便宜。*

关于第三方控件，我推荐并使用 CeTe 的 DynamicPDF。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T19:22:42.657

是的，有一种方法可以在没有 3rd 方工具的情况下做到这一点，但它涉及编写 PDF 到 html 翻译器的代码。

如果这适用于企业，第 3 方控制的投资回报率是您不必花费数百小时编码和测试此组件，而您只需几百美元即可购买一个。

现在，另一种方法是编写一个页面，该页面以与 PDF 文件生成数据的方式相同的方式显示数据（这实际上可以由 RDLC 处理）。这样当用户点击链接按钮时，他们会被带到这个显示页面，如果他们想要本地副本，他们可以从中下载 PDF 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T19:56:45.787

无论您如何生成 PDF，如果您在 IFRAME 而不是完整的浏览器窗口中打开 PDF，我会发现更好的用户体验。您可以向用户提供说明并维护浏览器导航。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-10T20:03:42.777

我想你想做的是去： http://my_site.com/generate-pdf.aspx?= [someId](http://my_site.com/generate-pdf.aspx?=someId) 这实际上应该只显示PDF文件？您需要做的是更改响应类型。

有关如何使用图像执行此操作的信息，[请参见此处。](http://www.sitepoint.com/article/generating-asp-net-images-fly/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T21:18:34.577

查找 Content-Disposition HTTP 标头。您可以发回一个值，该值要求内联显示而不是下载内容。

# php - PHP：连接 1 行还是多行更好？还是有区别？

> ID：431569
> 
> 赞同：10
> 
> 时间：2009-01-10T19:19:28.030
> 
> 标签：php, concatenation

是否有区别或比以下另一种更好：

```
$var = '';
...
$var .= 'blah blah';
$var .= $var2;
$var .= 'blah blah'; 
```

或者

```
$var = '';
...
$var .= 'blah blah' . $var2 . 'blah blah'; 
```

是否存在速度差异，或者有理由选择一个而不是另一个？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-10T20:19:22.810

PEZ 和 Topbit 都是正确的。我只想指出一些我认为比这里看到的更好的东西：

```
$var  = "line 1 \n";
$var .= "line 2 \n"; 
```

相对

```
$var = "line 1 \n"
     . "line 2 \n"; 
```

我更喜欢第二个而不是第一个，因为很明显你的结果是一个字符串 $var。它还可以防止愚蠢的错误，例如：

```
$var  = "line 1 \n";
$var .= "line 2 \n";
$vat .= "line 3 \n";
$var .= "line 4 \n"; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-10T19:31:40.627

如果您回显字符串，则存在细微差别。

```
echo $var1,$var2,$var3 // comma (echo with multiple arguments) 
```

略快于

```
echo $var1.$var2.$var3 // dot   (concat and echo) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-10T19:32:00.923

几个短的字符串无关紧要。使用更清晰的阅读方式。

但是，如果您有很多（比如数千个）而不是那么短的，您可能希望将它们保持在一个数组中并将它们连接在一起。（碰巧这样的代码通常像使用“。=”连接字符串一样容易阅读，因此您不会牺牲性能祭坛上的清晰度。）

**编辑：我不认为我的上述想法是有效的。PHP 的字符串是可变的，对吧？**

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-10T20:27:07.567

不会有什么不同。两者都是串联，所以最容易阅读的就是你应该使用的。

如果您追求最佳性能，请尝试使用数组，然后在完成后将其内爆。

```
$var = array();
$var[] = "line 1\n";
$var[] = "line 2\n";
$var[] = "line 3";
$var = implode('', $var); 
```

无论如何，除非您使用数千个大字符串，否则速度差异将可以忽略不计。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-10T20:01:13.547

对于您在代码中手动连接的任何内容，性能可能并不重要，因此可读性是王道。对我来说，这通常意味着使用[heredoc](http://us3.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)语法。我不喜欢它破坏我的缩进结构的方式，但是当您希望将换行符和/或制表符正确插入到您的字符串中时，它特别好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T19:27:54.987

我想你不会注意到这么短的情况。我通常出于可读性的原因决定使用哪个。我只在两种情况下分开，否则在一行：

a) 创建一个多行响应，以便代码在某种程度上模仿用户将看到的内容。我发现这样更容易发现错别字和错误。

```
$var  = "line 1 \n";
$var .= "line 2 \n"; 
```

b) 行长。如果该行会溢出我的窗口，我通常会将其拆分，这样我就不必走到行尾来阅读结尾。大多数语言都支持换行符，所以我真的不需要在代码中物理地破坏它，但这只是我的一个习惯，因为我确实在一些没有它的语言中工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-10T20:07:49.120

将大量数据放入单个字符串的最快方法是输出缓冲以捕获 echo 的输出。

```
ob_start();
/* many echos. For example, in a loop */
$outString = ob_get_contents(); // get the complete string
ob_end_clean(); 
```

一般来说，它不太可能对您的程序速度产生显着影响，所以让您在做什么看起来很明显，因为无论如何您必须稍后再回来修复/更新它。可读性为王。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-11T10:14:35.183

没有有意义的区别。这只是编码偏好的问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-13T02:46:10.490

我有一种预感，制作一个数组然后内爆可能是最快的方法。我错了！但是，执行 $str = $str + $bla 确实慢了一个数量级！仅当您进行大量连接时才重要。这是我的测试代码：

```
<?php

function doit($n) {

    $str2concat = 'Esta es una prueba. ¿Cuál manera es más rápida?';

    $str = '';

    // option 1
    $start = microtime(true);

    for( $i=0; $i <= $n; $i++ ) {
        $str .= $str2concat;
    }

    $end = microtime(true);
    echo " Concat: $n Iterations, duration:" . ($end-$start) . "\n";

    // option 2
    $str = '';
    $start = microtime(true);

    for( $i=0; $i <= $n; $i++ ) {
        $str = $str . $str2concat;
    }

    $end = microtime(true);
    echo "Concat2: $n Iterations, duration:" . ($end-$start) . "\n";

    // option 3
    $str = [];
    $start = microtime(true);

    for( $i=0; $i <= $n; $i++ ) {
        $str[] = $str2concat;
    }

    $str = implode( $str );
    $end = microtime(true);
    echo "Implode: $n Iterations, duration:" . ($end-$start) . "\n\n";

}

doit( 5000 );
doit( 10000 );
doit( 100000 ); 
```

这是我得到的结果：

```
 Concat: 5000 Iterations, duration:0.0031819343566895
Concat2: 5000 Iterations, duration:0.41280508041382
Implode: 5000 Iterations, duration:0.0094010829925537

 Concat: 10000 Iterations, duration:0.0071289539337158
Concat2: 10000 Iterations, duration:1.776113986969
Implode: 10000 Iterations, duration:0.013410091400146

 Concat: 100000 Iterations, duration:0.06755805015564
Concat2: 100000 Iterations, duration:264.86760401726
Implode: 100000 Iterations, duration:0.12707781791687 
```

# mysql - 在 MySQL 中使用条件连接

> ID：431571
> 
> 赞同：0
> 
> 时间：2009-01-10T19:20:56.313
> 
> 标签：mysql

我的表中有三列 - `company_name, first_name, last_name`。在 a 的结果中`SELECT`，我希望只有一列: ，如果未设置`name`，则应包含`company_name`if 的内容`NULL`或 的连接。`first_name +' '+ last_name``company_name`

有什么建议吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T19:24:21.657

```
SELECT IFNULL(company_name,CONCAT(first_name,' ',last_name)) as NAME 
```

# java - HTML 中的 Swing 组件

> ID：431579
> 
> 赞同：1
> 
> 时间：2009-01-10T19:25:13.370
> 
> 标签：java, html, user-interface, swing, components

有谁知道一个纯java（至少是跨平台）开源组件/库，它显示可以在其中包含swing组件的HTML？

我所能找到的要么被遗弃，要么不完整。

我之所以问，是因为我正在考虑尝试使用这种组合来创建桌面应用程序的方法。

编辑：似乎这个问题被误解了，所以让我澄清一下。我基本上想以与 web 类似的方式创建桌面应用程序。理想情况下，我希望浏览器充当 UI 层。该浏览器应该允许我嵌入自己的组件，例如能够使用 JTextField 而不是`<input type="text">`.

因为我不知道这么容易使用的浏览器，所以我要求一个 html 组件让我这样做。我希望这个问题现在更清楚了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T01:01:08.170

JEdi​​torPane 已经支持你想做的事情。它可以呈现 HTML（我承认这很糟糕），并且您可以使用 <object> 标记将 Swing 组件嵌入到该 HTML 中。这是演示此技术的博客文章：[http ://weblogs.java.net/blog/aim/archive/2007/07/index.html](http://weblogs.java.net/blog/aim/archive/2007/07/index.html)

否则，我认为你没有很多选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T22:04:35.750

我认为问题是相反的，或者更好的是，比使用 JTextPane 更进一步。据我了解这个问题：Marko 需要一个可以显示 HTML 并且还能够包含更多 Swing 组件的 Java 组件。说，应该有一个新标签

```
<swing jclass="MySwingComponent" /> 
```

这将呈现该 MySwingComponent 类。不确定，也许拥有一个可以嵌入更多小程序的支持 HTML 的 Swing 组件也可以？

不，我不知道这样的事情。对不起。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T22:11:21.587

JavaFX 也许？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T21:59:59.797

查看 xhtmlrenderer：[https ://xhtmlrenderer.dev.java.net/](https://xhtmlrenderer.dev.java.net/)

你必须努力让它做你想做的一切。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-10T22:47:52.323

我认为[Google Web Toolkit](http://code.google.com/webtoolkit/overview.html)允许您使用 Java/Swing 编写 UI。然后它将其转换为 JavaScript。也许这就是你要找的。

# iis-7 - 如何以编程方式使用 IIS7 的 FREB

> ID：431581
> 
> 赞同：3
> 
> 时间：2009-01-10T19:27:36.830
> 
> 标签：iis-7, trace, freb

IIS 7 有一个非常有用的功能，称为[Failed Request Tracing](http://channel9.msdn.com/posts/dunnry/Failed-Request-Tracing-on-IIS7/#356252)（简称 FREB）。它有一个非常好的可视化功能，涉及一个极其复杂的 XSL 样式表，可以将结果解析为有用的树形视图。

但是，我希望以编程方式使用 FREB，并能够在我的智能客户端上呈现结果（无需等待 XML 被写入服务器端）。

到目前为止，我发现的唯一可能的解决方案是编译一个将 FREB 转换为 OutputDebugStrings 的 IIS7 C++ 插件，即使是作者建议也不应该在生产服务器上使用这种方法（[这里是文章](http://blogs.iis.net/rickjames/archive/2007/10/10/iis-7-c-module-api-sample-consuming-trace-events.aspx)）

我的问题是：还有其他方法吗？

与往常一样，感谢您的阅读，更感谢您的回复。盖伊

# language-agnostic - 我应该如何开始为炮战游戏设计 AI 算法？

> ID：431586
> 
> 赞同：19
> 
> 时间：2009-01-10T19:28:35.157
> 
> 标签：language-agnostic, artificial-intelligence

这里是背景... 在我的空闲时间，我正在设计一个名为 Staker 的炮兵战争游戏（灵感来自旧的 BASIC 游戏[Tank Wars](http://en.wikipedia.org/wiki/Tank_Wars)和[Scorched Earth](http://en.wikipedia.org/wiki/Scorched_Earth_(computer_game))），我正在用 MATLAB 对其进行编程。您的第一个想法可能是“为什么选择 MATLAB？还有很多其他语言/软件包更适合游戏设计。” 你是对的。然而，我是个笨蛋，我有兴趣学习如何从头开始设计游戏的具体细节，所以我不一定想使用任何带有预制模块的东西。此外，我已经使用 MATLAB 多年，我喜欢用它来做其他人没有真正尝试过的事情的挑战。

现在到了手头的问题：我想加入人工智能，这样玩家就可以对抗电脑了。我才刚刚开始思考如何设计算法来选择方位角、仰角和弹丸速度来击中目标，然后每转一圈进行调整。我觉得我可能一开始就过度思考了这个问题，并试图让 AI 变得过于复杂，所以我想我会在这里停下来向社区询问他们如何设计算法的想法。

一些具体问题：

1.  您是否会建议我查看有关 AI 设计的具体参考资料？

2.  你会设计 AI 玩家以连续的方式改变难度（难度从 0（容易）到 1（困难），都仍然使用相同的通用算​​法）还是会为离散数量的 AI 玩家设计特定的算法（就像一个向随机方向射击的简单敌人或一个能够解释风影响的顽固敌人）？

3.  您将从哪种数学算法（伪代码描述）开始？

一些附加信息：我用来模拟弹丸运动的模型结合了流体阻力和风的影响。“流体”可以是空气或水。在空气中，根据一些简单的大气模型，空气密度（以及阻力效应）随离地高度而变化。在水中，阻力非常大，以至于弹丸通常需要额外的推力。换句话说，抛射物可能会受到重力以外的力的影响。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-10T19:52:03.630

在真实的炮兵情况下，所有这些因素都可以通过公式或简单的蛮力模拟来处理：发射一个电子炮弹，施加所有相关的力量，看看它落在哪里。调整并重试，直到电子炮弹击中目标。现在你有你的号码发送到枪。

鉴于情况的复杂性，我怀疑没有比暴力破解更好的答案了。虽然您可以预先计算出预期阻力效果与速度的表格，但我认为它不值得。

当然，AI 每次都将第一个炮弹落在你头上的游戏不会很有趣。一旦你知道了正确的值，你就必须让 AI 变得糟糕透顶。对射击应用一个随机因素，然后走向目标——每次射击时将其移动到真实目标的 30+random(140)%。

编辑：

我确实同意 BCS 的概念，即随着时间的推移对其进行改进。我说过，但后来改变了如何写一堆它的想法，然后最终忘记把它放回去。它应该越硬，随机组件应该越小。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T00:38:58.247

我现在正在处理您发布的回复：

虽然您有一般的想法，但我不相信您的方法可行 - 即使对于较低的 nSims 值，它也会收敛得太快。我怀疑您是否希望在 shell 之间进行不止一次的 get_new_guess 迭代，而且它很可能需要一些随机化。

即使您可以使用多次迭代，它们也不擅长不断增加难度，因为它们将是大步骤。在我看来，困难必须由随机性来处理。

首先，get_initial_guess：

开始时，我将有一张将世界划分为区域的表格——难度越高，区域越多。这些区域之间的边界将具有 45、60 和 75 度的预先计算的功率。做一个测试图，如果炮弹击中地形，请以更高的角度再试一次——如果 75 次击中地形，无论如何都要使用它。

初始 shell 应该在给定的下限和上限值之间的随机功率下触发。

现在，对于 get_new_guess：

炮弹击中地形了吗？增加角度。我认为需要增加多少功率以保持相同的距离会有一个恒定的比例——你需要对此进行测试。

假设它没有撞到一座山，请注意它是短的还是长的。这给了你一个界限。新的猜测介于两个界限之间（如果您缺少界限，请使用 get_initial_guess 中表中的值。）

注意目标在下限和上限影响点之间的距离百分比，并选择在下限和上限功率之间较远的功率。

这可能太准确了，可能需要一些随机化。我已经改变主意添加一个简单的随机百分比。相反，应该使用多个随机数来获得钟形曲线。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-10T21:36:58.223

感谢 Loren 和 BCS，我想你已经想到了我正在考虑的一个想法（这引发了上面的问题 #2）。AI 回合的伪代码如下所示：

```
nSims;        % A variable storing the numbers of projectile simulations
              %    done per turn for the AI (i.e. difficulty)
prevParams;   % A variable storing the previous shot parameters
prevResults;  % A variable storing some measure of accuracy of the last shot
newParams = get_new_guess(prevParams,prevResults);
loop for nSims times,
  newResults = simulate_projectile_flight(newParams);
  newParams = get_new_guess(newParams,newResults);
end
fire_projectile(newParams); 
```

在这种情况下，变量 nSims 本质上是衡量人工智能“智能”的指标。一个“愚蠢”的 AI 的 nSims = 0，并且每回合都会做出新的猜测（基于前一回合的结果）。“智能”人工智能会通过模拟弹丸飞行来改进其每转的猜测 nSims 时间。

由此产生了另外两个问题：

1) get_new_guess 函数包含什么？我应该如何调整三个射击参数以最小化与目标的距离？例如，如果一发子弹没有达到目标，您可以尝试通过仅调整仰角、仅调整弹丸速度或同时调整两者来使其更接近。

2) 所有 AI 的 get_new_guess 是否应该相同，而 nSims 值是“智能”的唯一决定因素？或者 get_new_guess 是否应该依赖于另一个“智能”参数（如guessAccuracy）？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-10T22:01:01.573

炮兵游戏和真实炮兵情况的区别在于，各方都有 100% 的信息，并且通常有超过 2 个对手。

因此，你的评估函数应该考虑哪个对手更迫切地尝试和消除。例如，如果我有 90% 的轻松击杀几率，但有 50% 的几率击杀试图击杀我但在我附近错过了两枪的人，那么处理这个机会就更重要了。

我认为您需要某种方法来评估每个人在弹药、位置、活动、过去历史等方面对您构成的风险。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-10T20:01:09.587

Loren 的蛮力解决方案很有吸引力，因为它可以通过添加更多迭代来轻松进行“智能调整”。此外，迭代的调整因子可能是智能的一部分，因为某些值会使它收敛得更快。

同样对于基本系统（无阻力、风等），有一个封闭形式的解决方案可以从基本的物理文本中得出。我会做出第一个猜测，然后每轮进行一次或多次迭代。您可能想尝试提出一个经验校正相关性来改进第一个镜头（这将使第一个镜头的分布平均值更接近正确）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-11T00:47:11.427

另一个想法：我们是否正在处理一个同时只有一个 shell 处于活动状态的系统？很久以前，我实现了一个火炮游戏，你有 5 个枪管，每个枪管都有一个固定的装填时间，高于最大可能的飞行时间。

有了这个，我发现自己使用了一种在我当前的下限和上限之间的范围内发射炮弹的策略。不过，作为一个普通人，我可能没有使用最佳策略——这是实时的，一旦枪管准备好就完成一轮比确保它尽可能地瞄准更重要，因为它会收敛反正很快。我通常会在第二次齐射时将炮弹放在目标上，而第三次通常都会被击中。（杀死需要杀死目标中的*所有*像素。）

在人工智能的情况下，我会模拟这个和阻止一些枪管稍后发射更准确的子弹的策略。我仍然会在目标范围内展开散布，唯一的问题是我是否会使用所有枪管。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-25T19:01:48.897

我亲自创建了这样一个系统 - 用于网络游戏 Zwok，使用蛮力。我朝随机方向开了很多枪，并记录了最好的结果。我不建议以任何其他方式这样做，因为时间步长等之间的差异会给你带来意想不到的结果。

# performance - 压缩以提高硬盘写入性能

> ID：431594
> 
> 赞同：10
> 
> 时间：2009-01-10T19:31:48.770
> 
> 标签：performance, compression, io

在现代系统上，可以通过压缩输出流来提高本地硬盘写入速度吗？

这个问题源于我正在处理的一个案例，其中一个程序连续生成大约 1-2GB 的文本记录数据并将其转储到硬盘上的原始文本文件中，我认为它是 IO 绑定的。我是否希望能够通过在数据进入磁盘之前对其进行压缩来减少运行时间，或者压缩的开销是否会耗尽我可以获得的任何收益？有一个空闲的第二个核心会影响这个吗？

我知道这会受到用于生成数据的 CPU 数量的影响，因此关于需要多少空闲 CPU 时间的经验法则会很好。

* * *

我记得一个视频演讲，有人使用压缩来提高数据库的读取速度，但 IIRC 压缩比解压缩更占用 CPU 资源。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T09:15:40.567

是的，是的，是的，绝对的。

以这种方式看待它：以每秒兆字节为单位获取最大连续磁盘写入速度。（继续测量它，为一个巨大的 fwrite 计时或其他东西。）假设是 100mb/s。现在以兆赫为单位计算您的 CPU 速度；假设 3Ghz = 3000mhz。将 CPU 速度除以磁盘写入速度。这是 CPU 空闲的周期数，您可以将*每个字节*用于压缩。在这种情况下，3000/100 = 每字节 30 个周期。

如果您有一种算法可以将数据压缩 25% 以实现 125mb/s 的有效写入速度，那么您将有 24 个周期来运行它，并且它基本上是*免费*的，因为 CPU 无论如何都不会做任何其他事情在等待磁盘搅动时。每字节 24 个周期 = 每 128 字节高速缓存行 3072 个周期，很容易实现。

我们在阅读光学媒体时一直这样做。

如果你有一个空闲的第二个核心，那就更容易了。只需将日志缓冲区移交给该内核的线程，它可能需要尽可能长的时间来压缩数据，因为它没有做任何其他事情！唯一棘手的一点是您实际上希望拥有一圈缓冲区，这样您就不会让生产者线程（制作日志的线程）在互斥锁上等待消费者线程（将其写入磁盘的缓冲区）持有。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-10T20:27:41.810

是的，至少 10 年来都是如此。有关于它的操作系统论文。我认为 Chris Small 可能已经对其中一些进行了研究。

对于速度，较低质量级别的`gzip`/`zlib`压缩非常快；如果这还不够快，您可以**尝试[FastLZ](http://www.fastlz.org/)**。使用额外内核的一种快速方法就是`popen(3)`使用`gzip`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-17T09:24:32.013

值得一提的是，Sun 的文件系统 ZFS 能够启用动态压缩以减少磁盘 IO 的数量，而不会显着增加开销作为实践中的示例。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-03T12:16:59.283

Stony Brook的[文件系统和存储实验室](http://www.fsl.cs.sunysb.edu/)在今年[IBM 的 SYSTOR 系统研究会议上](http://www.haifa.ibm.com/conferences/systor2009/program.shtml)发表了关于服务器系统上文件数据压缩的相当广泛的性能（和能量）评估： [ACM 数字图书馆的论文](http://portal.acm.org/citation.cfm?id=1534530.1534536)，[演示文稿](http://www.haifa.ibm.com/conferences/systor2009/papers/1_2_2.pdf)。

结果取决于

*   使用压缩算法和设置，
*   文件工作量和
*   您机器的特性。

例如，在论文的测量中，使用文本工作负载和使用**lzop 的服务器环境以低压缩量比普通写入更快，但 bzip 和 gz 不是**。

*在您的特定设置中，您应该尝试并测量。它确实可能会提高性能，但并非总是如此。*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-10T20:15:43.113

CPU 的增长速度比硬盘访问速度更快。甚至早在 80 年代，就可以从磁盘上读取许多压缩文件并在比读取原始（未压缩）文件所需的时间更短的时间内解压缩。那不会改变。

不过，一般来说，现在压缩/解压缩的处理级别比您编写的级别要低，例如在数据库 I/O 层中。

至于第二个内核的有用性，只有在系统还将执行大量其他事情时才重要——并且您的程序必须是多线程的才能利用额外的 CPU。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-17T08:40:31.527

以二进制形式记录数据可能是一个快速的改进。您将减少对磁盘的写入，CPU 将花费更少的时间将数字转换为文本。如果人们要阅读日志，它可能没有用，但他们也无法阅读压缩日志。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-04T15:24:27.113

Windows 已经支持 NTFS 中的文件压缩，因此您所要做的就是在文件属性中设置“压缩”标志。然后，您可以衡量它是否值得。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-10T19:39:21.017

如果只是文本，那么压缩肯定会有所帮助。只需选择一种压缩算法和设置，使压缩成本低廉。“gzip”比“bzip2”便宜，并且两者都有参数，您可以调整以提高速度或压缩比。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-10T19:46:08.663

这取决于很多因素，我认为没有一个正确的答案。归结为：

考虑到您可用于此目的的 CPU 带宽，您能否以比磁盘的原始写入性能乘以您正在实现的压缩率（或您尝试获得的速度倍数）更快的速度压缩原始数据？

鉴于当今相对较高的数据写入速率（10 兆字节/秒），这是一个相当高的障碍。就其他一些答案而言，您可能必须拥有易于压缩的数据，并且只需要通过一些合理性类型的实验测试来对其进行基准测试并找出答案。

*相对于特定意见（猜！？）到关于额外核心的观点。如果您将数据压缩线程化并保持内核馈送 - 文本的高压缩率，那么这种技术很可能会取得一些成果。但这只是一个猜测。在磁盘写入和压缩操作之间交替的单线程应用程序中，对我来说似乎不太可能。*

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-07-28T06:33:01.983

如果您受 I/O 限制，将人类可读的文本保存到硬盘驱动器，我希望压缩能够减少您的总运行时间。

如果您有一个空闲的 2 GHz 内核和一个相对较快的 100 MB/s 流式硬盘驱动器，则将净记录时间减半需要至少 2:1 压缩，并且每个未压缩字节不超过大约 10 个 CPU 周期，以便压缩器考虑数据。使用双管道处理器，每字节（非常粗略）20 条指令。

我看到 LZRW1-A（最快的压缩算法之一）每个字节使用 10 到 20 条指令，并以大约 2:1 的比例压缩典型的英文文本。在高端（每字节 20 条指令），您正处于 IO 限制和 CPU 限制之间的边缘。在中端和低端，您仍然受 IO 限制，因此有几个周期（不多）可用于稍微复杂一点的压缩器来更长时间地思考数据。

如果您有一个更典型的非顶级硬盘驱动器，或者由于某些其他原因（碎片、其他使用磁盘的多任务处理等）硬盘驱动器速度较慢，那么您有更多的时间来获得更多复杂的压缩器来思考数据。

您可能会考虑设置一个压缩分区，将数据保存到该分区（让设备驱动程序对其进行压缩），并将速度与您的原始速度进行比较。与更改程序和在压缩算法中链接相比，这可能需要更少的时间并且不太可能引入新的错误。

我看到一个[基于 FUSE 的压缩文件系统列表，](http://sourceforge.net/apps/mediawiki/fuse/index.php?title=CompressedFileSystems)听说 NTFS 也支持压缩分区。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-07-29T19:20:41.077

如果这台特定的机器经常受 IO 限制，另一种加快速度的方法是安装 RAID 阵列。这将为每个程序和每种数据（甚至是不可压缩的数据）提供加速。

例如，共有 4 个磁盘的流行 RAID 1+0 配置可提供近 2 倍的加速。

几乎同样流行的 RAID 5 配置，总共有 4 个磁盘，使所有速度提高了近 3 倍。

设置速度是单个驱动器速度 8 倍的 RAID 阵列相对简单。

另一方面，高压缩比显然不是那么简单。将“仅”6.30 压缩为 1 将为您提供现金奖励，以打破当前的压缩世界纪录（Hutter 奖）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-10T19:41:08.830

这曾经是可以在很多应用程序中提高性能的东西。我猜今天它不太可能得到回报，但它可能在你的特定情况下，特别是如果你记录的数据很容易压缩，

然而，正如 Shog9 所说：

> 经验法则在这里对您没有帮助。它是您的磁盘、您的 CPU 和您的数据。设置一个测试用例，并在压缩和不压缩的情况下测量吞吐量和 CPU 负载 - 看看是否值得权衡。

# windows - Windows Home Server 备份解决方案

> ID：431605
> 
> 赞同：0
> 
> 时间：2009-01-10T19:40:01.967
> 
> 标签：windows, backup

我承认这不是一个严格的编程问题，尽管我确实使用我的 WHS 作为家庭项目的源存储库服务器，而且我猜这里的许多其他编码人员也是如此。

有没有人推荐 Windows Home Server 的非文件共享部分的良好备份解决方案？我见过的所有 WHS 备份都处理文件共享，但没有系统文件或其他管理内容。

谢谢，安迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T21:14:42.230

Windows Home Server 旨在不需要操作系统的备份。如果您的系统驱动器出现故障，请安装新驱动器，然后启动 WHS 操作系统安装光盘并安装操作系统。它将在其他驱动器上找到数据并重新创建所有共享文件夹。备份后您确实需要进行一些配置，但与不必备份相比，这非常小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T06:38:16.873

备份家庭服务器本身的一个很好的解决方案是连接外部驱动器，例如通过 USB 2.0 或 eSATA。但是，要使其正常工作，您需要在 WHS 服务器上安装 Norton Ghost 等支持软件或类似软件。

Windows Home Server Power Pack 1（又名 WHS PP1）添加了一项功能，可将 WHS 共享文件夹备份到外部驱动器——正如您所提到的，此功能仅用于数据端而不是操作系统。

如果您有 HP MediaSmart 服务器，您可以尝试[Quick & Easy Windows Home Server Backup and Restore](http://forhackers.com/?p=12)中提到的方法。作者说它对他有用，但当然，*买者自负。* 此技术让您为备份创建磁盘映像，并使用它在恢复磁盘/恢复磁盘过程中进行恢复。

如果您想要一种更快的方式来恢复您的操作系统并且您没有 Media Smart 服务器，您还可以查看这些[关于如何使用 USB 闪存驱动器安装 WHS](http://wiki.wegotserved.com/index.php?title=Turn_your_USB_Flash_Drive_Into_a_Windows_Install_Disk)的说明，并合并上面找到的恢复磁盘的说明相对于 OS 恢复磁盘进程的图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-23T04:38:31.313

WHS OS backup solved by running two copies of WHS each on its own computer in a virtual machine with each WHS backing up the other (running in a VM makes the WHS a file thus able to be backed up and restored by WHS).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T20:10:13.547

[iDrive](http://www.idrive.com/)很棒而且在 2 场演出以下免费

# linq - 邮政编码到城市/州查找 XML 文件？

> ID：431616
> 
> 赞同：0
> 
> 时间：2009-01-10T19:44:55.467
> 
> 标签：linq, zipcode

试图找到一个我可以用来代替查找数据库表的 XML 文件，直到我们将我们的网络托管切换到正确的数据库。

任何人都可以向我推荐一个 XML 文件，其中包含其子项具有邮政编码、州和城市的元素吗？例如：

```
<zip code="98117">
    <state>WA</state>
    <city>Seattle</state>
</zip> 
```

或者

```
<entry>
    <zip>98117</zip>
    <state>WA</state>
    <city>Seattle</city>
</entry> 
```

我将在 C# 中使用 LINQ 来查询这些数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T19:50:30.607

看看这个，它提供了几种不同的免费的。

[https://stackoverflow.com/questions/24471/zip-code-database](https://stackoverflow.com/questions/24471/zip-code-database)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T04:43:04.550

有一个免费的邮政编码数据库位于：

[http://www.populardata.com](http://www.populardata.com)

我相信它是一个 .CSV 文件，但您可以很容易地将其转换为 XML 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-09T15:40:02.077

这是根据输入的邮政编码执行 city.state 自动填充的代码。

```
<script type="text/javascript">//<![CDATA[
$(function() {
    // IMPORTANT: Fill in your client key
    var clientKey = "js-9qZHzu2Flc59Eq5rx10JdKERovBlJp3TQ3ApyC4TOa3tA8U7aVRnFwf41RpLgtE7";

    var cache = {};
    var container = $("#example1");
    var errorDiv = container.find("div.text-error");

    /** Handle successful response */
    function handleResp(data)
    {
        // Check for error
        if (data.error_msg)
            errorDiv.text(data.error_msg);
        else if ("city" in data)
        {
            // Set city and state
            container.find("input[name='city']").val(data.city);
            container.find("input[name='state']").val(data.state);
        }
    }

    // Set up event handlers
    container.find("input[name='zipcode']").on("keyup change", function() {
        // Get zip code
        var zipcode = $(this).val().substring(0, 5);
        if (zipcode.length == 5 && /^[0-9]+$/.test(zipcode))
        {
            // Clear error
            errorDiv.empty();

            // Check cache
            if (zipcode in cache)
            {
                handleResp(cache[zipcode]);
            }
            else
            {
                // Build url
                var url = "http://www.zipcodeapi.com/rest/"+clientKey+"/info.json/" + zipcode + "/radians";

                // Make AJAX request
                $.ajax({
                    "url": url,
                    "dataType": "json"
                }).done(function(data) {
                    handleResp(data);

                    // Store in cache
                    cache[zipcode] = data;
                }).fail(function(data) {
                    if (data.responseText && (json = $.parseJSON(data.responseText)))
                    {
                        // Store in cache
                        cache[zipcode] = json;

                        // Check for error
                        if (json.error_msg)
                            errorDiv.text(json.error_msg);
                    }
                    else
                        errorDiv.text('Request failed.');
                });
            }
        }
    }).trigger("change");
}); 
```

//]]>

这是 API - [http://www.zipcodeapi.com/Examples#example1](http://www.zipcodeapi.com/Examples#example1)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-12T16:04:39.250

您可以通过以下方式请求 XML 中的内容。要直接以 XML 格式取回数据，您可以使用请求中格式的 .xml。

[https://www.zipcodeapi.com/rest/RbdapNcxbjoCvfCv4N5iwB3L4beZg017bfiB2u9eOxQkMtQQgV9NxdyCoNCENDMZ/info.xml/90210/degrees](https://www.zipcodeapi.com/rest/RbdapNcxbjoCvfCv4N5iwB3L4beZg017bfiB2u9eOxQkMtQQgV9NxdyCoNCENDMZ/info.xml/90210/degrees)

将回应

```
<response>
   <zip_code>90210</zip_code>
   <lat>34.100501</lat>
   <lng>-118.414908</lng>
   <city>Beverly Hills</city>
   <state>CA</state>
   <timezone>
   <timezone_identifier>America/Los_Angeles</timezone_identifier>
   <timezone_abbr>PDT</timezone_abbr>
      <utc_offset_sec>-25200</utc_offset_sec>
      <is_dst>T</is_dst>
   </timezone>
   <acceptable_city_names/>
</response> 
```

Api 文档位于[https://www.zipcodeapi.com/API](https://www.zipcodeapi.com/API)

# ruby-on-rails - 在 ActiveRecord 中创建时覆盖 id

> ID：431617
> 
> 赞同：108
> 
> 时间：2009-01-10T19:44:57.840
> 
> 标签：ruby-on-rails, activerecord

有没有办法在创建时覆盖模型的 id 值？就像是：

```
Post.create(:id => 10, :title => 'Test') 
```

将是理想的，但显然行不通。

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-10-02T20:55:30.430

id 只是 attr_protected，这就是为什么您不能使用批量分配来设置它的原因。但是，当手动设置它时，它就可以工作：

```
o = SomeObject.new
o.id = 8888
o.save!
o.reload.id # => 8888 
```

我不确定最初的动机是什么，但我在将 ActiveHash 模型转换为 ActiveRecord 时这样做。ActiveHash 允许您在 ActiveRecord 中使用相同的 belongs_to 语义，但无需迁移和创建表，并且每次调用都会产生数据库开销，您只需将数据存储在 yml 文件中。数据库中的外键引用 yml 中的内存 id。

ActiveHash 非常适合不经常更改且仅由开发人员更改的选项列表和小表。因此，从 ActiveHash 到 ActiveRecord 时，最简单的方法是保持所有外键引用相同。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-06-07T16:19:24.227

你也可以使用这样的东西：

```
Post.create({:id => 10, :title => 'Test'}, :without_protection => true) 
```

尽管如[文档](http://api.rubyonrails.org/classes/ActiveRecord/Persistence/ClassMethods.html#method-i-create)中所述，这将绕过批量分配安全性。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-01-10T20:55:40.083

尝试

```
a_post = Post.new do |p| 
  p.id = 10
  p.title = 'Test'
  p.save
end 
```

那应该给你你正在寻找的东西。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2015-09-09T23:01:04.240

对于 Rails 4：

```
Post.create(:title => 'Test').update_column(:id, 10) 
```

其他 Rails 4 答案对我**不起作用**。在使用 Rails 控制台检查时，其中许多*似乎*发生了变化，但是当我检查 MySQL 数据库中的值时，它们保持不变。其他答案有时只起作用。

至少对于 MySQL，`id`除非**您**使用`update_column`. 例如，

```
p = Post.create(:title => 'Test')
p.id
=> 20 # 20 was the id the auto increment gave it

p2 = Post.create(:id => 40, :title => 'Test')
p2.id
=> 40 # 40 > the next auto increment id (21) so allow it

p3 = Post.create(:id => 10, :title => 'Test')
p3.id
=> 10 # Go check your database, it may say 41.
# Assigning an id to a number below the next auto generated id will not update the db 
```

如果你改成`create`使用`new`+`save`你仍然会遇到这个问题。手动更改`id`类似`p.id = 10`也会产生这个问题。

一般来说，我会使用`update_column`更改，`id`即使它需要额外的数据库查询，因为它会一直工作。这是一个可能不会出现在您的开发环境中的错误，但可能会悄悄地破坏您的生产数据库，同时说它正在工作。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-11-17T03:24:51.653

我们可以覆盖 attributes_protected_by_default

```
class Example < ActiveRecord::Base
    def self.attributes_protected_by_default
        # default is ["id", "type"]
        ["type"]
    end
end

e = Example.new(:id => 10000) 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-31T12:44:41.000

实际上，事实证明，执行以下工作：

```
p = Post.new(:id => 10, :title => 'Test')
p.save(false) 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2010-01-13T18:43:28.703

正如 Jeff 指出的那样，id 的行为就像是 attr_protected。为了防止这种情况，您需要覆盖默认受保护属性的列表。在属性信息可能来自外部的任何地方都要小心。id 字段默认受保护是有原因的。

```
class Post < ActiveRecord::Base

  private

  def attributes_protected_by_default
    []
  end
end 
```

（使用 ActiveRecord 2.3.5 测试）

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-03-22T05:49:42.480

```
Post.create!(:title => "Test") { |t| t.id = 10 } 
```

这并不像您通常想要做的那样让我感到震惊，但是如果您需要使用一组固定的 id 填充表（例如，当使用 rake 任务创建默认值时）并且您想要覆盖自动递增（这样每次运行任务时，表都会填充相同的 id）：

```
post_types.each_with_index do |post_type|
  PostType.create!(:name => post_type) { |t| t.id = i + 1 }
end 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-11-29T16:03:44.143

将此**create_with_id**函数放在种子.rb 的顶部，然后在需要显式 ID 的地方使用它来创建对象。

```
def create_with_id(clazz, params)
obj = clazz.send(:new, params)
obj.id = params[:id]
obj.save!
    obj
end 
```

并像这样使用它

```
create_with_id( Foo, {id:1,name:"My Foo",prop:"My other property"}) 
```

而不是使用

`Foo.create({id:1,name:"My Foo",prop:"My other property"})`

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-07-27T20:41:25.887

这种情况是一个类似的问题，需要`id`用一种自定义日期覆盖：

```
# in app/models/calendar_block_group.rb
class CalendarBlockGroup < ActiveRecord::Base
...
 before_validation :parse_id

 def parse_id
    self.id = self.date.strftime('%d%m%Y')
 end
...
end 
```

进而 ：

```
CalendarBlockGroup.create!(:date => Date.today)
# => #<CalendarBlockGroup id: 27072014, date: "2014-07-27", created_at: "2014-07-27 20:41:49", updated_at: "2014-07-27 20:41:49"> 
```

回调工作正常。

祝你好运！。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-07-02T17:26:14.373

对于 Rails 3，最简单的方法是使用`new`细化`without_protection`，然后`save`：

```
Post.new({:id => 10, :title => 'Test'}, :without_protection => true).save 
```

对于种子数据，绕过验证可能有意义，您可以这样做：

```
Post.new({:id => 10, :title => 'Test'}, :without_protection => true).save(validate: false) 
```

我们实际上在 ActiveRecord::Base 中添加了一个辅助方法，该方法在执行种子文件之前立即声明：

```
class ActiveRecord::Base
  def self.seed_create(attributes)
    new(attributes, without_protection: true).save(validate: false)
  end
end 
```

现在：

```
Post.seed_create(:id => 10, :title => 'Test') 
```

对于 Rails 4，您应该使用 StrongParams 而不是受保护的属性。如果是这种情况，您将能够简单地分配和保存，而无需将任何标志传递给`new`：

```
Post.new(id: 10, title: 'Test').save      # optionally pass `{validate: false}` 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-06-20T20:32:07.307

在带有 Postgresql 9.5.3 的 Rails 4.2.1 中，`Post.create(:id => 10, :title => 'Test')`只要没有 id = 10 的行就可以工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-11-14T10:33:01.163

你可以通过sql插入id：

```
 arr = record_line.strip.split(",")
  sql = "insert into records(id, created_at, updated_at, count, type_id, cycle, date) values(#{arr[0]},#{arr[1]},#{arr[2]},#{arr[3]},#{arr[4]},#{arr[5]},#{arr[6]})"
  ActiveRecord::Base.connection.execute sql 
```

# perl - Perl 中中型数据的最佳 IPC 机制是什么？

> ID：431623
> 
> 赞同：7
> 
> 时间：2009-01-10T19:49:09.720
> 
> 标签：perl, ipc

我正在用 Perl 设计一个多层应用程序，我想知道我可以使用的各种 IPC 机制的优缺点。我正在研究处理中等大小的数据，通常为几十 KB，但最多为几兆字节，并且负载非常轻，每分钟最多几百个请求。

我主要关心的是可维护性和性能（按此顺序）。我认为我不需要扩展到一台以上的服务器，或者从我们的主平台 (RHEL) 移植，但我认为这是需要考虑的事情。

我可以想到以下选项：

*   临时文件 - 简单，可能是速度和存储要求方面最差的选择
*   UNIX 域套接字 - 不可移植，不可扩展
*   Internet Sockets - 便携、可扩展
*   管道 - 可移植，不可扩展（？）

考虑到可扩展性和可移植性不是我最关心的问题，我需要了解更多。什么是最好的选择，为什么？如果您需要更多信息，请发表评论。

* * *

**编辑：**我将尝试提供更多详细信息以回答[ysth 的问题](https://stackoverflow.com/questions/431623/whats-the-best-ipc-mechanism-for-medium-sized-data-in-perl#432629) ***（警告，文字墙如下）***：

*   **读者/作者是一对一的关系，还是更复杂的关系？**
*   **如果读者不在或忙，你希望作者怎么办？**
*   **反之亦然？**
*   **关于您想要的用途，您还有哪些其他信息？**

在这一点上，我正在考虑采用三层方法，但我不确定每一层有多少进程。我认为我需要在左侧有更多的流程，而在右侧有更少的流程，但也许我应该有相同的数字：

```
.---------。.---------。.--------。
 | 请求 | -----> | 商业 | -----> | 数据 |
 | 经理 | <----- | 逻辑 | <----- | 层 |
 `---------' `----------' `--------'

```

这些名称仍然是通用的，可能不会以这些形式进入实现。

**请求管理器**负责监听来自不同接口的请求，例如 Web 请求和 CLI（响应时间很重要）和电子邮件（响应时间不太重要）。它执行日志记录并管理对请求的响应（以适合请求类型的格式呈现）。

它将有关请求的数据发送到**业务逻辑**，业务逻辑根据业务规则执行日志记录、授权等。

然后业务逻辑（如果需要）从**数据层**请求数据，数据层可以（最常见）与内部 MySQL 数据库或我们团队无法控制的其他数据源（例如，我们组织的主 LDAP 服务器或我们的DB2 员工信息数据库等）。这主要是一个简单的包装器，它以统一的方式格式化数据，以便在业务逻辑中更容易地处理它。

然后信息流回请求管理器进行呈现。

如果，当数据向右流动时，读者很忙，对于交互式请求，我只想等待一段合适的时间，如果我在这段时间内没有访问权限，则返回超时错误（例如“稍后再试”）。对于非交互请求（例如电子邮件），轮询系统可以简单地退出并在下一次调用时重试（可能每 1-3 分钟一次）。

当数据在另一个方向流动时，不应该有任何等待的情况。如果在尝试返回左侧时其中一个进程已经死亡，那么我真正能做的就是登录并退出。

无论如何，这非常冗长，而且由于我仍处于早期设计阶段，因此我可能仍然有一些混乱的想法。我提到的一些内容可能**与使用哪个 IPC 系统**的问题无关。我对设计的其他建议持开放态度，但我试图将问题限制在范围内（例如，也许我应该考虑分解为两层，这对于 IPC 来说要简单得多）。你怎么认为？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-11T04:40:27.057

如果您目前不确定您的确切要求，请尝试考虑一个您可以编码的简单接口，*任何*IPC 实现（无论是临时文件、TCP/IP 还是其他）都需要支持。然后，您可以选择特定的 IPC 风格（我会从最容易和/或最容易调试的任何东西开始——可能是临时文件）并使用它来实现接口。如果结果太慢，请使用 TCP/IP 等实现接口。实际上实现接口并不涉及太多工作，因为您基本上只是将调用转发到一些现有的库。

关键是您有一个高级任务要执行（“将数据从程序 A 传输到程序 B”），它或多或少独立于其执行方式的细节。通过建立接口并对其进行编码，您可以在需要更改实现的情况下将**主程序与更改隔离开来。**

请注意，您不需要使用任何重量级的 Perl 语言机制来利用具有接口的想法。您可以简单地拥有例如 3 个不同的包（用于临时文件、TCP/IP、Unix 域套接字），每个包都导出相同的方法集。选择要在主程序中使用的实现相当于选择要使用的模块`use`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-10T20:13:57.127

除此之外，临时文件还有其他问题。我觉得网袜真的是最好的选择。它们有据可查，正如您所说，可扩展且可移植。即使这不是核心要求，您也几乎可以免费获得它。套接字很容易处理，同样有大量的文档。您可以在库中构建您的数据共享机制和协议，而无需再次查看！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-11T01:11:14.030

临时文件（和相关的东西，如共享内存区域）可能是一个糟糕的选择。如果你想在一台机器上运行你的服务器而在另一台机器上运行你的客户端，你将需要重写你的应用程序。如果您选择任何其他选项，至少语义基本相同，如果您需要在以后在它们之间切换。

不过，我唯一真正的建议是不要自己写这个。在服务器端，你应该使用 POE（或 Coro 等），而不是自己`select`在 socket 上做。此外，如果您的接口将是 RPC-ish，请使用CPAN 中的[JSON-RPC-Common/之类的东西。](http://search.cpan.org/~nuffin/JSON-RPC-Common-0.03/)

最后，还有 IPC::PubSub，它可能对你有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-11T01:33:27.653

UNIX 域套接字可跨单元移植。它的便携性不亚于管道。它也比 IP 套接字更有效。

无论如何，您错过了一些选项，例如共享内存。有些人会将数据库添加到该列表中，但我会说这是一个相当重量级的解决方案。

消息队列也是一种可能，尽管您必须更改内核选项才能处理如此大的消息。否则，它们对很多事情都有理想的界面，恕我直言，它们的使用率很低。

尽管我普遍同意使用现有解决方案比构建自己的解决方案要好。我不知道您的问题的具体情况，但我建议您查看 CPAN 的[IPC](http://search.cpan.org/search?m=module&q=IPC%3A%3A&s=1&n=100)部分

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-11T09:08:39.497

有很多不同的选择，因为它们中的大多数更适合某些特定情况，但是您并没有真正提供任何可以识别您的情况的信息。

读者/作者是一对一的关系，还是更复杂的关系？如果读者不在或忙，你希望作者怎么办？反之亦然？关于您想要的用途，您还有哪些其他信息？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-05T10:03:13.480

对于“交互式”请求（在等待响应（异步或非异步）时保持连接打开）：HTTP + JSON。JSON [::XS](http://search.cpan.org/dist/JSON-XS/)非常快。每个人都可以说 HTTP，并且很容易进行负载平衡、调试、.. .

对于排队的请求（“请这样做，谢谢！”）：[Beanstalkd](http://xph.us/software/beanstalkd/)和[Beanstalk::Client](http://search.cpan.org/dist/Beanstalk-Client/)。使用 JSON 序列化 beanstalk 队列中的请求。

根据您的应用程序，[Thrift也可能值得研究。](http://developers.facebook.com/thrift/)

# django - 如何在 Django 视图中组合两个或多个查询集？

> ID：431628
> 
> 赞同：761
> 
> 时间：2009-01-10T19:51:43.317
> 
> 标签：django, search, django-queryset, django-q

我正在尝试为我正在构建的 Django 站点构建搜索，并且在该搜索中，我正在搜索三种不同的模型。为了对搜索结果列表进行分页，我想使用通用的 object_list 视图来显示结果。但要做到这一点，我必须将三个查询集合并为一个。

我怎样才能做到这一点？我试过这个：

```
result_list = []
page_list = Page.objects.filter(
    Q(title__icontains=cleaned_search_term) |
    Q(body__icontains=cleaned_search_term))
article_list = Article.objects.filter(
    Q(title__icontains=cleaned_search_term) |
    Q(body__icontains=cleaned_search_term) |
    Q(tags__icontains=cleaned_search_term))
post_list = Post.objects.filter(
    Q(title__icontains=cleaned_search_term) |
    Q(body__icontains=cleaned_search_term) |
    Q(tags__icontains=cleaned_search_term))

for x in page_list:
    result_list.append(x)
for x in article_list:
    result_list.append(x)
for x in post_list:
    result_list.append(x)

return object_list(
    request,
    queryset=result_list,
    template_object_name='result',
    paginate_by=10,
    extra_context={
        'search_term': search_term},
    template_name="search/result_list.html") 
```

但这不起作用。当我尝试在通用视图中使用该列表时出现错误。该列表缺少克隆属性。

如何合并三个列表`page_list`，`article_list`和`post_list`？

* * *

## 回答 #1

> 赞同：1169
> 
> 时间：2009-01-12T08:00:46.823

将查询集连接成一个列表是最简单的方法。如果无论如何都会为所有查询集命中数据库（例如，因为需要对结果进行排序），这不会增加进一步的成本。

```
from itertools import chain
result_list = list(chain(page_list, article_list, post_list)) 
```

使用`itertools.chain`比循环每个列表并逐个附加元素要快，因为`itertools`它是在 C 中实现的。与在连接之前将每个查询集转换为列表相比，它消耗的内存更少。

现在可以对结果列表进行排序，例如按日期（如 hasen j 对另一个答案的评论中所要求的）。该`sorted()`函数方便地接受一个生成器并返回一个列表：

```
result_list = sorted(
    chain(page_list, article_list, post_list),
    key=lambda instance: instance.date_created) 
```

如果您使用的是 Python 2.4 或更高版本，则可以使用`attrgetter`lambda 代替。我记得读过它更快，但我没有看到一百万个项目列表的明显速度差异。

```
from operator import attrgetter
result_list = sorted(
    chain(page_list, article_list, post_list),
    key=attrgetter('date_created')) 
```

* * *

## 回答 #2

> 赞同：537
> 
> 时间：2009-04-28T05:48:33.827

试试这个：

```
matches = pages | articles | posts 
```

它保留了查询集的所有功能，如果您愿意`order_by`或类似的话，这很好。

**请注意：**这不适用于来自两个不同模型的查询集。

* * *

## 回答 #3

> 赞同：156
> 
> 时间：2017-02-12T11:23:28.270

相关的，对于来自同一模型的混合查询集，或者对于来自几个模型的类似字段，*从***Django 1.11**开始，还可以使用一种[`QuerySet.union()`方法：](https://docs.djangoproject.com/en/stable/ref/models/querysets/#django.db.models.query.QuerySet.union)

> **`union()`**
> 
> ```
> union(*other_qs, all=False) 
> ```
> 
> **Django 1.11 中的新功能**。使用 SQL 的 UNION 运算符组合两个或多个 QuerySet 的结果。例如：
> 
> ```
> >>> qs1.union(qs2, qs3) 
> ```
> 
> 默认情况下，UNION 运算符仅选择不同的值。要允许重复值，请使用 all=True 参数。
> 
> union()、intersection() 和 difference() 返回第一个 QuerySet 类型的模型实例，即使参数是其他模型的 QuerySet。只要 SELECT 列表在所有 QuerySet 中都相同，传递不同的模型就可以工作（至少类型，名称无关紧要，只要类型顺序相同）。
> 
> 此外，生成的 QuerySet 上只允许使用 LIMIT、OFFSET 和 ORDER BY（即切片和 order_by()）。此外，**数据库对组合查询中允许的操作设置了限制。**例如，大多数数据库不允许在组合查询中使用 LIMIT 或 OFFSET。

* * *

## 回答 #4

> 赞同：83
> 
> 时间：2009-01-11T09:51:23.013

您可以使用`QuerySetChain`下面的课程。将它与 Django 的分页器一起使用时，它应该只`COUNT(*)`对所有`SELECT()`查询集的查询和那些记录显示在当前页面上的查询集的查询来访问数据库。

请注意，您需要指定`template_name=`是否将 a`QuerySetChain`与通用视图一起使用，即使链接的查询集都使用相同的模型。

```
from itertools import islice, chain

class QuerySetChain(object):
    """
    Chains multiple subquerysets (possibly of different models) and behaves as
    one queryset.  Supports minimal methods needed for use with
    django.core.paginator.
    """

    def __init__(self, *subquerysets):
        self.querysets = subquerysets

    def count(self):
        """
        Performs a .count() for all subquerysets and returns the number of
        records as an integer.
        """
        return sum(qs.count() for qs in self.querysets)

    def _clone(self):
        "Returns a clone of this queryset chain"
        return self.__class__(*self.querysets)

    def _all(self):
        "Iterates records in all subquerysets"
        return chain(*self.querysets)

    def __getitem__(self, ndx):
        """
        Retrieves an item or slice from the chained set of results from all
        subquerysets.
        """
        if type(ndx) is slice:
            return list(islice(self._all(), ndx.start, ndx.stop, ndx.step or 1))
        else:
            return islice(self._all(), ndx, ndx+1).next() 
```

在您的示例中，用法为：

```
pages = Page.objects.filter(Q(title__icontains=cleaned_search_term) |
                            Q(body__icontains=cleaned_search_term))
articles = Article.objects.filter(Q(title__icontains=cleaned_search_term) |
                                  Q(body__icontains=cleaned_search_term) |
                                  Q(tags__icontains=cleaned_search_term))
posts = Post.objects.filter(Q(title__icontains=cleaned_search_term) |
                            Q(body__icontains=cleaned_search_term) | 
                            Q(tags__icontains=cleaned_search_term))
matches = QuerySetChain(pages, articles, posts) 
```

然后与您在示例中使用`matches`的分页器一起使用。`result_list`

该`itertools`模块是在 Python 2.3 中引入的，因此它应该在 Django 运行的所有 Python 版本中都可用。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2012-11-26T21:42:21.987

如果你想链接很多查询集，试试这个：

```
from itertools import chain
result = list(chain(*docs)) 
```

其中： docs 是查询集列表

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2009-01-10T22:43:25.420

当前方法的最大缺点是它对大型搜索结果集的效率低下，因为您每次都必须从数据库中提取整个结果集，即使您只打算显示一页结果。

为了只从数据库中提取您实际需要的对象，您必须在 QuerySet 上使用分页，而不是列表。如果这样做，Django 实际上会在执行查询之前对 QuerySet 进行切片，因此 SQL 查询将使用 OFFSET 和 LIMIT 来仅获取您将实际显示的记录。但是你不能这样做，除非你能以某种方式将你的搜索塞进一个单一的查询中。

鉴于您的所有三个模型都有标题和正文字段，为什么不使用[模型继承](http://docs.djangoproject.com/en/dev/topics/db/models/#model-inheritance)？只需让所有三个模型都从具有标题和正文的共同祖先继承，并将搜索作为对祖先模型的单个查询执行。

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2019-04-07T16:35:54.700

这可以通过两种方式来实现。

**第一种方法**

对查询集使用联合运算符来合并`|`两个查询集。如果两个查询集都属于同一模型/单个模型，则可以使用联合运算符组合查询集。

*举个例子*

```
pagelist1 = Page.objects.filter(
    Q(title__icontains=cleaned_search_term) | 
    Q(body__icontains=cleaned_search_term))
pagelist2 = Page.objects.filter(
    Q(title__icontains=cleaned_search_term) | 
    Q(body__icontains=cleaned_search_term))
combined_list = pagelist1 | pagelist2 # this would take union of two querysets 
```

**第二种方法**

在两个查询集之间实现组合操作的另一种方法是使用**itertools**链函数。

```
from itertools import chain
combined_results = list(chain(pagelist1, pagelist2)) 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2013-12-23T12:42:00.293

```
DATE_FIELD_MAPPING = {
    Model1: 'date',
    Model2: 'pubdate',
}

def my_key_func(obj):
    return getattr(obj, DATE_FIELD_MAPPING[type(obj)])

And then sorted(chain(Model1.objects.all(), Model2.objects.all()), key=my_key_func) 
```

引自[https://groups.google.com/forum/#!topic/django-users/6wUNuJa4jVw](https://groups.google.com/forum/#!topic/django-users/6wUNuJa4jVw)。见**亚历克斯·盖纳**

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2020-09-26T06:51:51.257

您可以使用[联合](https://docs.djangoproject.com/en/3.1/ref/models/querysets/#union)：

```
qs = qs1.union(qs2, qs3) 
```

但是如果你想应用于`order_by`组合查询集的外国模型......那么你需要预先[选择](https://docs.djangoproject.com/en/3.1/ref/models/querysets/#select-related)它们......否则它将无法正常工作。

例子

```
qs = qs1.union(qs2.select_related("foreignModel"), qs3.select_related("foreignModel"))
qs.order_by("foreignModel__prop1") 
```

`prop1`外国模型中的属性在哪里。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2018-02-12T12:49:46.787

**要求：** `Django==2.0.2` ,`django-querysetsequence==0.8`

如果您想组合`querysets`并仍然输出 a `QuerySet`，您可能需要查看[django-queryset-sequence](https://github.com/percipient/django-querysetsequence)。

但是关于它的一个注释。它只需要两个`querysets`作为它的论点。但是使用 python`reduce`你总是可以将它应用到多个`queryset`s.

```
from functools import reduce
from queryset_sequence import QuerySetSequence

combined_queryset = reduce(QuerySetSequence, list_of_queryset) 
```

就是这样。以下是我遇到的情况以及我的就业方式`list comprehension`，`reduce`以及`django-queryset-sequence`

```
from functools import reduce
from django.shortcuts import render    
from queryset_sequence import QuerySetSequence

class People(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE)
    mentor = models.ForeignKey('self', null=True, on_delete=models.SET_NULL, related_name='my_mentees')

class Book(models.Model):
    name = models.CharField(max_length=20)
    owner = models.ForeignKey(Student, on_delete=models.CASCADE)

# as a mentor, I want to see all the books owned by all my mentees in one view.
def mentee_books(request):
    template = "my_mentee_books.html"
    mentor = People.objects.get(user=request.user)
    my_mentees = mentor.my_mentees.all() # returns QuerySet of all my mentees
    mentee_books = reduce(QuerySetSequence, [each.book_set.all() for each in my_mentees])

    return render(request, template, {'mentee_books' : mentee_books}) 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-01-13T17:12:01.033

这是一个想法……只需从三个结果中的每一个中提取一整页的结果，然后丢弃 20 个最不有用的结果……这消除了大型查询集，这样您只牺牲了一点性能而不是很多。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2020-03-14T06:56:30.263

这将在不使用任何其他库的情况下完成工作：

```
result_list = page_list | article_list | post_list 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2021-03-30T19:20:03.883

最好的选择是使用 Django 内置方法：

```
# Union method
result_list = page_list.union(article_list, post_list) 
```

这将返回这些查询集中所有对象的联合。

如果您只想获取三个查询集中的对象，您会喜欢查询集的内置方法，`intersection`.

```
# intersection method
result_list = page_list.intersection(article_list, post_list) 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2019-02-01T09:41:54.307

这个递归函数将一组查询集连接成一个查询集。

```
def merge_query(ar):
    if len(ar) ==0:
        return [ar]
    while len(ar)>1:
        tmp=ar[0] | ar[1]
        ar[0]=tmp
        ar.pop(1)
        return ar 
```

# .net - 在我的 .NET WPF 应用程序中在运行时指定 XBAP？

> ID：431632
> 
> 赞同：2
> 
> 时间：2009-01-10T20:00:29.977
> 
> 标签：.net, wpf, xbap

我可以在我的 WPF 应用程序中动态托管 XBAP 吗？

我可以下载 XBAP，将其设置为托管在我的 WPF 应用程序中，并以编程方式与之交互吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T23:21:31.770

我会假设“是”，因为您始终可以在您的应用程序中放置一个[`WebBrowser`控件](http://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser%28v=VS.100%29.aspx)，然后[`Navigate`](http://msdn.microsoft.com/en-us/library/cc491252.aspx)使用 URL 调用您希望启动的 XBAP 应用程序。

事实上，这是[在 Microsoft 的`IWpfHostSupport`接口文档中推荐的](http://msdn.microsoft.com/en-us/library/aa970784.aspx)

具体来说，在“备注”部分（强调我的）：

Web 浏览器等 Win32 应用程序可以承载 WPF 内容，包括 XAML 浏览器应用程序 (XBAP) 和松散的 XAML。 **为了承载 WPF 内容，Win32 应用程序创建 WebBrowser 控件的实例。**

# java - Grails，使用 withTransaction 插入大量数据会导致 OutOfMemoryError

> ID：431635
> 
> 赞同：13
> 
> 时间：2009-01-10T20:01:35.607
> 
> 标签：java, hibernate, spring, grails, transactions

我正在使用 Grails 1.1 beta2。我需要将大量数据导入我的 Grails 应用程序。如果我反复实例化一个 grails 域类然后保存它，性能会慢得无法接受。以从电话簿中导入人员为例：

```
for (each person in legacy phone book) {
    // Construct new Grails domain class from legacy phone book person
    Person person = new Person(...)
    person.save()
} 
```

事实证明这非常缓慢。Grails 邮件列表中的某个人建议在事务中批量保存。所以现在我有：

```
List batch = new ArrayList()
for (each person in legacy phone book) {
    // Construct new Grails domain class from legacy phone book person
    Person person = new Person(...)
    batch.add(person)
    if (batch.size() > 500) {
        Person.withTransaction {
            for (Person p: batch)
                p.save()
            batch.clear()
        }
    }
}
// Save any remaining
for (Person p: batch)
    p.save() 
```

这项工作必须更快，至少在最初是这样。每笔交易保存 500 条记录。随着时间的推移，交易需要的时间越来越长。前几笔交易大约需要 5 秒钟，然后它就从那里开始。在大约 100 笔交易之后，每笔交易都需要一分钟以上，这再次令人无法接受。更糟糕的是，最终 Grails 最终会耗尽 Java 堆内存。我可以增加 JVM 堆大小，但这只会延迟`OutOfMemoryError`异常。

任何想法为什么会这样？这就像有一些内部资源没有被释放。性能变得更糟，内存被占用，最终系统内存不足。

根据[Grails 文档](http://grails.org/doc/1.0.x/ref/Domain%20Classes/withTransaction.html)，`withTransaction`将闭包传递给 Spring 的`TransactionStatus`对象。我找不到任何东西`TransactionStatus`来关闭/结束交易。

**编辑：**我从 Grails 的控制台（`grails console`）运行它

**编辑：**这是内存不足异常：

```
Exception thrown: Java heap space

java.lang.OutOfMemoryError: Java heap space
    at org.hibernate.util.IdentityMap.entryArray(IdentityMap.java:194)
    at org.hibernate.util.IdentityMap.concurrentEntries(IdentityMap.java:59)
    at org.hibernate.event.def.AbstractFlushingEventListener.prepareEntityFlushes(AbstractFlushingEventListener.java:113)
    at org.hibernate.event.def.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:65)
    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:26)
    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1000)
    at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:338)
    at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:106)
    at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:655)
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:732)
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:701)
    at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-10-28T04:03:29.067

Ted Naleid 写了一篇 关于提高批处理性能的[精彩博客文章。](http://www.naleid.com/2009/10/01/batch-import-performance-with-grails-and-mysql.html)包括这里作为参考。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-10T21:45:46.613

这是所有休眠应用程序的常见问题，它是由休眠会话的增长引起的。我猜测 grails 控制台会为您打开一个休眠会话，其方式类似于我知道它用于正常 Web 请求的“视图中打开会话”模式。

解决方案是获取当前会话并在每批之后清除它。我不确定您如何使用控制台获取 spring bean，通常对于控制器或服务，您只需将它们声明为成员。然后您可以使用`sessionFactory.getCurrentSession()`. 为了清除它，只需调用`session.clear()`，或者如果您`session.evict(Object)`对每个`Person`对象有选择性地使用什么。

对于控制器/服务：

```
class FooController {
    def sessionFactory

    def doStuff = {
        List batch = new ArrayList()
        for (each person in legacy phone book) {
            // Construct new Grails domain class from legacy phone book person
            Person person = new Person(...)
            batch.add(person)
            if (batch.size() > 500) {
                Person.withTransaction {
                    for (Person p: batch)
                        p.save()
                    batch.clear()
                }
                // clear session here.
                sessionFactory.getCurrentSession().clear();
            }
        }
        // Save any remaining
        for (Person p: batch)
            p.save()
        }
    }
} 
```

希望这可以帮助。

# winapi - 相当于 opendir 的 Win32

> ID：431638
> 
> 赞同：0
> 
> 时间：2009-01-10T20:02:55.447
> 
> 标签：winapi, file, directory, io

有谁知道opendir的Win32等价物是什么（或者它是否存在）？显然，我可以将 FindFirstFile(Ex) 与 FindNextFile 一起使用，但是将 * 附加到路径似乎是一种很老套的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T20:38:03.457

`FindFirstFile`并且`FindNextFile`是适当的 Win32 API。假设您正在编写 C++ 代码，作为可移植替代方案，您可以考虑使用`directory_iterator`Boost [Filesystem](http://www.boost.org/doc/libs/1_37_0/libs/filesystem/doc/index.htm)库（在 Windows 上使用`FindFirstFile`and实现`FindNextFile`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T20:19:52.013

我相信您可以使用[`CreateFile`](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)with`FILE_FLAG_BACKUP_SEMANTICS`和 then[`BackupRead`](http://msdn.microsoft.com/en-us/library/aa362509(VS.85).aspx)来读取目录数据，但我不确定数据实际上是什么格式。另外，您需要以`SE_BACKUP_NAME`启用权限的用户身份运行，所以这不太适合通用应用程序。

# c# - 将一个类的实例设置为另一个类时的 SerializationException

> ID：431642
> 
> 赞同：0
> 
> 时间：2009-01-10T20:07:52.863
> 
> 标签：c#, exception, class

我试图在两个单独的类之间传递一个类的实例，如下所示。

```
//classes
public class A
{
  public string name;
  public string data;
}

public class B : MarshalByRefObject
{
  public A _a;
}

public class C : MarshalByRefObject
{
  public A _a;
}

//main program
static void Main(string[] args)
{
  B _b = new B();
  C _c = new C();

  _b._a = new A();

  _c._a = _b._a;
} 
```

A 存在于 B 和 C 类中，我想让 C 中的 A 类的实例等于 B 中的 A 类的实例。我基本上想确保 B 和 C 具有相同的精确副本A的

但是，当我尝试运行它时，我得到一个 SerializationException 说类 A 未标记为可序列化。我知道我以前做过这样的事情，它从来不希望它被序列化。为什么它仍然需要这个？我认为那是用于 xml 序列化。

我确实尝试将 [Serializable] 属性添加到类 A，异常显然消失了。但是在这样做之后，对 B 类内部的 A 进行更改不会传播到 C 内部的 A 实例......就像它们现在是完全独立的副本一样。

有任何想法吗？

编辑：之前没有意识到这很重要，但是环顾四周后，我认为确实如此。类 B 和 C 继承自 MarshalByRefObject 类。也许这将有助于弄清楚。我已经更新了上面的课程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T20:21:47.110

我最近有一个类似的问题（确保反序列化后的单例盒装值类型）。

为了解决我的问题，我不得不使用 ISerializationSurrogate 和 SurrogateSelector 来修复引用，而不是让它重新装箱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T21:39:29.387

上面在 Visual Studio 中运行的代码没有出现这样的异常。我根本看不到任何序列化发生，您只是指向不同对象的引用。

# iphone - 如何使用 iPhone SDK 访问一组照片？

> ID：431643
> 
> 赞同：3
> 
> 时间：2009-01-10T20:07:59.040
> 
> 标签：iphone, camera, image

我知道我可以访问相机或向用户显示图像选择器，但如果我只想从存储在设备上的图像中随机选择 10 张照片而无需用户交互怎么办？

使用 UIImagePickerController 使我能够使用相机或图像选择器，但我怎样才能在没有用户交互的情况下自动执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T09:19:15.480

AFAIK 除非您使用 SDK 提供的类之一，否则无法从任何 Apple 应用程序（或任何其他应用程序）访问任何文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T14:28:10.943

我曾经写过一个简单的浏览器应用程序，它从 / 开始，并用目录的内容填充 UITableView。它让我看到我可以访问哪些目录，以及我可以在这些目录中访问哪些文件。如果您能找到您要查找的内容，请自行查看其目录内容。否则，它可能对您隐藏，无法从您的应用程序的沙箱中访问。

# asp.net - 如何在中等信任环境中连接到当前的 FormsAuthenticationModule？

> ID：431644
> 
> 赞同：3
> 
> 时间：2009-01-10T20:08:31.053
> 
> 标签：asp.net, events, forms-authentication, httpmodule, medium-trust

我的应用程序中有一个 HttpModule，它使用以下代码连接到 FormsAuthenticationModule 的 Authenticate 事件：

```
public void Init(HttpApplication context)
{
    FormsAuthenticationModule faModule =
        (FormsAuthenticationModule)context.Modules["FormsAuthentication"];
    faModule.Authenticate +=
        new FormsAuthenticationEventHandler(faModule_Authenticate);
} 
```

不幸的是，对 context.Modules 的调用失败，因为应用程序需要在中等信任环境中运行。还有其他方法可以让我参与此活动吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T20:39:07.870

这很难——您甚至无法从全局应用程序文件中访问 Modules 集合。

您可以尝试从 Global 中的 AuthenticateRequest 处理程序调用您的自定义代码：

```
protected void Application_AuthenticateRequest(object sender, EventArgs e)
{
    // Call your module's code here..
} 
```

您也无法从集合中获取自定义模块，因此您需要对模块库的静态引用。

除了在机器级别的 web.config 中向您的站点授予 AspNetHostingPermission （[详见此处的其他权限](http://msdn.microsoft.com/en-us/library/ms998341.aspx#paght000020_oledbpermission)）之外，我没有想法！

# c++ - 确定一个位置是否在封闭哈希中是空闲的

> ID：431647
> 
> 赞同：2
> 
> 时间：2009-01-10T20:10:16.540
> 
> 标签：c++, hash

您将如何确定一个职位是否已被占用？分配内存时，其中的所有内容都是垃圾（在 C++ 中，这是我正在使用的 atm）。我正在考虑使用一个辅助的布尔数组来了解该位置是否被占用，但这需要相当多的额外内存。

我也可以为每个位置设置一个值，但是我将无法使用该值。在这两种情况下，我也会失去一些初始化值的性能（例如，布尔值为 false，其他值为 0 表示该位置是空闲的）。

还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T20:19:38.050

通常，您使用特殊的占位符元素来指示空值。在最简单的情况下，这可能是一个空指针，但这当然意味着您引入了间接；你不能直接存储你的值。在所有其他情况下，您必须考虑实际存储的类型。例如，如果您存储 32 位整数，则必须保留至少一个预定义值（例如 0）作为标记元素，从而减少可能存储在哈希表中的值的范围。

带有标志的附加数组是一个很好的解决方案。考虑到通过存储位标志而不是全字节变量（甚至是布尔值，在大多数架构上每个都需要 4 个字节），这个数组可以减少至少 8 倍。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T01:00:46.890

您可以使用`boost::optional`它，而不是原始值。这就是创建它的原因，为项目添加未初始化的值。它的性能损失类似于首先初始化值，但每个项目只需要少量的额外内存。

# c# - 在 Mac 上学习 C#？

> ID：431648
> 
> 赞同：16
> 
> 时间：2009-01-10T20:10:18.630
> 
> 标签：c#, macos

单声道是唯一的路线，您推荐任何特定的视觉工作室，如编辑器吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-10T20:26:16.697

无需说明明显和错过重点，如果您指的是 Mac 计算机而不是 Mac OS，您可以安装[bootcamp](http://www.apple.com/macosx/features/bootcamp.html)或使用[并行](http://www.parallels.com/)程序在 Mac 上运行 Windows，然后使用 Visual Studio（也有[Visual Studio](http://www.microsoft.com/Express/)的免费版本)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-10T20:17:33.937

是的，单声道确实是你唯一的选择，除非某个地方的某个本科生开发了一些我不知道的非常实验性的东西。至于 IDE，我相信现在可以在 Mac OS X 上运行的唯一稳定的一半是 Monodevelop：

[http://tirania.org/blog/archive/2008/Feb-07-2.html](http://tirania.org/blog/archive/2008/Feb-07-2.html)

我的意思是，您可以使用 Visual Studio 在 Windows VM 上运行 Parallels 并开发您的代码，并且只要您遵循某些关于可移植性的准则，您就可以使用 VS 来开发您的单声道应用程序。虽然，您可能还不如熟悉 Monodevelop。看看 SharpDevelop 是否被移植会很有趣。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-10T20:21:37.860

好吧，你也可以试试[Silverlight](http://silverlight.net/) ...

临：

*   这是微软的官方实现，所以它更有可能工作
*   它对 C# 3.0 等最新内容的支持要好得多

缺点：

*   它仅限浏览器，Silverlight 应用程序不能独立运行
*   你不会得到整个 .NET 类库，只有一个子集，所以它有些有限
*   你不会在 Mac 上获得 Visual Studio

对于 IDE，我建议您使用 MonoDevelop 或 SharpDevelop 之类的[~~用于 Microsoft Silverlight 的 Eclipse 工具（显然它目前仅适用于 Windows）。~~](http://www.eclipse4sl.org/download/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-02T20:45:36.697

使用 Xamarin Studio IDE。 [https://xamarin.com/mac](https://xamarin.com/mac)

使用 Mono 和 C#。它具有您可能期望从现代 IDE 获得的任何功能，并与 XCode for GUI 结合使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-10T20:17:02.533

Mono 几乎是你现在唯一的途径，尽管有不断的谣言（不过我不会过多考虑）微软计划在未来将 C# 移植到 Mac。不过，如果发生这种情况，我会感到非常惊讶。

至于 IDE，我无能为力......如果我想要 C#，我坚持使用 Visual Studio（如果你真的想使用 VS，可以通过 Parallels 或 BootCamp 运行它）。

**编辑：**正如格雷厄姆指出的那样，有 Cocoa#，但我会警告说，这仅仅是因为该项目已经停滞不前，而且它的未来不太可能。:(

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-10T20:25:27.993

我会走虚拟化路线，Parallels 或 VMware Fusion。两者都可以在现代 Mac 上很好地运行 Windows XP 和 Visual Studio。Windows 拥有用于 .NET 和 C# 开发的最佳工具，而且它只会使用它们，尤其是在您刚刚开始的时候。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-04-06T18:08:33.017

Virtual Box 是我最喜欢的开源（意味着免费）VM 软件。不要为 Parallels 付费。此外，使用 BootCamp，您必须重新启动机器才能在 Windows 和 OS X 之间切换，因此 Virtual Box 是可行的方法。

# java - 禁用接缝的重定向过滤器

> ID：431652
> 
> 赞同：7
> 
> 时间：2009-01-10T20:13:51.323
> 
> 标签：java, seam

我正在接缝中做一个需要宁静 URL 的项目。我有一个映射到 /group/{group}/{locale} 的视图。在那个页面上，我有一个所谓的消息列表。每条消息都有一个按钮来保存对消息的更改。这与这样的操作 bean 相关联：

```
<h:commandButton type="submit" value="Save Changes" action="#{groupAction.update}" /> 
```

每条消息都有一个锚点，因此 /group/{group}/{locale}#{id} 可用于使浏览器转到该锚点。这就是为什么我需要在 POST 之后进行重定向：

```
<page view-id="/group.xhtml">
  <rewrite pattern="/group/{group}/{locale}"/>

  <param name="group" value="#{groupAction.group}"/>
  <param name="locale" value="#{groupAction.locale}"/>

  <navigation from-action="#{groupAction.update}">
    <redirect view-id="/group.xhtml?group=#{group}&locale=#{locale}##{id}"/>
  </navigation>
</page> 
```

此外，我有以下重定向规则 (UrlRewriteFilter) 来获取正确的 RESTful URL：

```
<outbound-rule>
  <from>^/group.xhtml\?group=([\.\w]+)&locale=([\.\w]+)\#([\.\w]+)\?cid=(\d*)$</from>
  <to type="temporary-redirect" last="true">/group/$1/$2#$3</to>
</outbound-rule> 
```

我在这里去掉了 conversationId。这是一个经过测试的作品。然而，接缝仍然附加一个“？conversationId = {cid}”。所以有什么问题？好吧，想象一个像 '/group/{group}/{locale}#{id}?conversationId={cid}' 这样的 URL。显然浏览器不喜欢这个并且不会自动转到那个锚点。

我做了一些研究并在接缝文档中发现了我的问题：

**29.1.4.2。带有重定向的对话传播** 这个过滤器允许Seam 跨浏览器重定向传播对话上下文。它拦截任何浏览器重定向并添加一个指定Seam 对话标识符的请求参数。重定向过滤器默认会处理所有请求，但也可以在 components.xml 中调整此行为：

```
<web:redirect-filter url-pattern="*.seam"/> 
```

我不需要重定向过滤器，我尝试在 url 模式中放置一些无效的东西来“禁用”过滤器。然而这并没有奏效。所以我现在的问题是：

如何禁用接缝中的重定向过滤器？

我找不到答案。接缝文档谈到在 web.xml 中禁用它，但我的尝试还没有成功。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-13T15:53:53.217

我已经弄清楚了不需要的`conversationId`查询字符串参数的来源。

结果`<redirect/>`调用`org.jboss.seam.faces.FacesManager.redirect(String viewId, Map<String, Object> parameters, boolean includeConversationId)`

这是从以下`org.jboss.seam.faces.Navigator`设置`includeConversationId`为 true 的代码中调用的：

```
 FacesManager.instance().redirect(viewId, parameters, true); 
```

我看不到任何避免这种情况的方法，因此修复/解决方法是在操作方法中以编程方式进行重定向：

```
 FacesManager.instance().redirect(viewId, parameters, false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T09:05:08.440

好的，我设法通过将其添加到我的 compononents.xml 来杀死重定向过滤器：

```
<web:redirect-filter disabled="true" installed="false" /> 
```

但是我的主要问题仍然存在，所以这显然不是问题。它仍然在 URL 上添加了 conversationId 作为额外的查询字符串。显然我做错了什么，因为[它已经完成了](http://www.jtict.com/blog/seam-form-url-rewriting/)。

@Adeel Ansari：

组件.xml：

```
 <web:rewrite-filter view-mapping="/seam/*" /> 
```

pages.xml 看到我最初的问题。

# java - Java Swing 中是否有等效的“组框”？

> ID：431654
> 
> 赞同：60
> 
> 时间：2009-01-10T20:14:58.420
> 
> 标签：java, swing, grouping

尝试在 Java/Swing 中构建 GUI 应用程序。我主要习惯于使用 VB 之类的工具在 Windows 端“绘制”GUI（或者更准确地说，Gupta SQLWindows ......想知道有多少人知道那是什么 ;-)）。

我在 Swing 中找不到与 Group Box 等效的东西...

使用组框，您可以在几个相关的小部件周围有一个方形框（通常带有标题）。一个例子是围绕几个单选按钮的组框（标题解释了单选按钮的含义，例如，标题为“Sex”的组框带有“Male”和“Female”单选按钮）。

我搜索了一下......我发现的唯一方法是添加一个子窗格，在子窗格上设置边框，然后将“组”中的所有小部件添加到子窗格中。有没有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-01-10T21:00:10.870

创建一个 JPanel，并将您的单选按钮添加到其中。不要忘记将 JPanel 的布局设置为适当的。

然后打电话`panel.setBorder(BorderFactory.createTitledBorder(name));`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-12T05:18:56.777

其他人已经评论了 JPanel 并使用了 TitledBorder，这很好。

但是，在使用 Swing LayoutManagers 时，您可能会发现不同 JPanel 中的组件无法正确对齐（每个面板都有自己的 LayoutManager）很烦人。

出于这个原因，在 Swing GUI 中不使用 TitledBorders 而是使用 JLabel 后跟水平 JSeparator 将 JPanel 中的组件组分开是一种很好的做法（有关更多详细信息，请查看 Web 上的“JGoodies”）。

参考。《[秋千急救](http://www.jgoodies.com/download/presentations/first%20aid%20for%20swing-75min.pdf)》

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-10T21:02:56.340

组框只是一组“逻辑分组的小部件”。这在摇摆世界中是一个`JPanel`。

将您的小部件添加到`JPanel`.

将其边框类型设置为“标题边框”并给出与 VB6“框架”的名称相同的标题。

瞧。你有你的组框。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T17:41:44.747

自从您提出单选按钮以来，这是来自 JRadioButton javadocs 的引述。

> 单选按钮的实现——可以选择或取消选择的项目，并向用户显示其状态。与 ButtonGroup 对象一起使用以创建一组按钮，其中一次只能选择一个按钮。（创建一个 ButtonGroup 对象并使用它的 add 方法将 JRadioButton 对象包含在组中。）
> 
> 注意：ButtonGroup 对象是一个逻辑分组——不是物理分组。要创建一个按钮面板，您仍然应该创建一个 JPanel 或类似的容器对象，并为其添加一个 Border 以将其与周围的组件隔离开来。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-10T20:22:28.217

不是 AFAIK，至少不是标准的摆动小部件。

在 VB 中，您有一个组小部件，它本质上是一个面板 + 边框。

在 Swing 中，您有一个 JPanel，它是容器小部件，并且只有在需要时才在其上创建和设置边框对象。有人可以争辩说，以一种更优雅的方式，因为你不为你不使用的东西付费（例如，边框）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-26T09:13:55.570

正如 David Koelle 提到的通过 java 代码设置边框，您也可以在设计器模式下获得类似的结果。

[![在此处输入图像描述](https://i.stack.imgur.com/HFulv.png)](https://i.stack.imgur.com/HFulv.png)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-10T20:25:42.687

我根据 Uri 的评论做出回应，该评论解释了 OP 的含义`Group Box`：

> Uri：我认为他指的是您在许多对话框中看到的控制组，例如，您在一堆小部件（例如单选按钮）周围有一个正方形。

据我所知，每个人`JComponent`都可以为自己设置一个边框，所以你不需要第二个面板。

# c# - 我将如何通过与 RPC 样式服务相反的 REST 服务添加新数据？

> ID：431658
> 
> 赞同：5
> 
> 时间：2009-01-10T20:17:40.083
> 
> 标签：c#, wcf, rest

我仍在学习 REST，在我的测试中，我想出了这个我不知道如何处理的场景。

我有一个使用 Linq-to-Sql 的现有示例 WCF 服务。它是一个非常简单的数据库，只有一个名为“Tasks”的表，其中包含四个字段：Id、Description、IsCompleted 和 EnteredDate。（我之所以提到这一点，是因为我在服务本身中没有定义数据契约，它都来自于 Linq 创建的 Context。）

获取数据转换为 REST 很简单……就像删除数据一样。但是，插入新记录似乎并不容易。

我的 RPC 风格的合约操作如下所示：

```
 [OperationContract]
    void AddTask(string description); 
```

不需要 Id、IsCompleted 和 EnteredDate，因为服务实现如下所示：

```
 public void AddTask(string description)
    {
        TaskListLinqDataContext db = new TaskListLinqDataContext();
        Task task = new Task() 
           { Description = description, IsCompleted = false, 
             EntryDate = DateTime.Now };

        db.Tasks.InsertOnSubmit(task);
        db.SubmitChanges();
    } 
```

Id 是一个身份，因此由数据库处理。

我的第一个想法是像这样装饰 Operation 合约：

```
 [WebInvoke(Method="PUT", UriTemplate="tasks/{description}")]
    [OperationContract]
    void AddTask(string description); 
```

但我真的不知道如何让它发挥作用。当我尝试使用 Fiddler 添加它时，它返回 411（需要长度）的结果。

这样做的正确方法是什么？我是否必须重新编写实现以接受代表新记录的整个 XML 文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T15:44:40.497

结果：

我终于找到了一篇[很好的博客文章](http://blog.donnfelker.com/post/How-To-REST-Services-in-WCF-35-Part-2-The-POST.aspx)来帮助我解决这个问题。事实证明我做的事情几乎是正确的，但我把测试不正确地放入了 Fiddler。我还为我的属性添加了更多细节。

```
[WebInvoke(RequestFormat = WebMessageFormat.Xml, 
           ResponseFormat = WebMessageFormat.Xml,
           Method = "POST", UriTemplate = "tasks/{description}", 
           BodyStyle = WebMessageBodyStyle.Bare)]
[OperationContract]
void AddTask(string description); 
```

当我将 Uri 放入 Fiddler 时，它需要看起来像这样：

[http://ipv4.fiddler:8054/tasks/this+is+a+sample+desc+that+works](http://ipv4.fiddler:8054/tasks/this+is+a+sample+desc+that+works)

现在我的服务正确地接受了数据并且可以将任务添加到数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T03:13:02.263

查看[WCF REST Starter Kit](http://msdn.microsoft.com/en-us/netframework/cc950529.aspx)，可以从 CodePlex[下载](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=18830)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T20:58:49.953

我认为[这](https://stackoverflow.com/questions/430809/rest-interface-for-finding-average)几乎描述了如何以一种宁静的方式将项目添加到容器中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T22:02:27.437

根据要求，您可以简单地通过 Astoria 启用常规 CRUD？我有一个系列，介绍如何在此处使用 LINQ-to-SQL 执行[此](http://marcgravell.blogspot.com/)操作。只是一个想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T17:09:11.740

如果你想做一个 RESTful Web 服务，那么不要使用 WCF 应用程序。将您的 URI 模板修改为类似 Task/new 的内容，并将新任务的数据放入 POST http 请求的正文中。我在 ASP.NET 中将 RESTful Web 服务实现为通用处理程序 (*.ashx)。这让我可以准备好 http 方法并从那里开始。

凯文

# java - Java中的VisualEditor - 动态构建子面板？

> ID：431663
> 
> 赞同：0
> 
> 时间：2009-01-10T20:19:30.657
> 
> 标签：java, swing, panel, visual-editor

我正在使用“可视化编辑器”来“​​绘制”我的 Swing GUI。我可以使用 VE 动态构建子面板的内容，还是必须使用 JPanel 的预定义子类（并使用 VE 构建它）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-10T21:08:30.637

您*可以*动态构建子面板的内容 - 例如基于文件或某些东西 - 可视化编辑器不会阻止您。

通常，VE 足够智能，可以看到您正在动态构建面板并显示内容（例如 JList 中文件的内容）

有时，VE 无法渲染项目，因为“控件太复杂”——但这并不经常发生。

# visual-studio - 有人在 Windows 7 上使用过 Visual Studio 2008 吗？

> ID：431667
> 
> 赞同：5
> 
> 时间：2009-01-10T20:20:17.550
> 
> 标签：visual-studio, windows-7

有没有人已经尝试过这个，我需要注意的任何特别之处？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-10T20:37:12.243

是的，已经运行了一段时间，我还没有遇到任何问题。不能说我每天都在使用它，但我已经用它构建了 WPF、WinForms、Web 和控制台应用程序来测试各种东西，并且没有遇到任何问题。

我在我的戴尔 X1 上安装了它，这实际上是我的“上网本”，而且速度非常快。我遇到的唯一故障是图形加速方面的一些问题，但这取决于我使用的英特尔驱动程序是旧的 XP 驱动程序，而且很容易解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T22:56:21.823

我一直在 MacBook Pro 上的 Parallels Desktop 4 的虚拟机中运行它。绝对没有问题可言。

（通过 Parallels 虚拟化的 Windows 7 中没有声音，这是一个已知问题 - 但与 Visual Studio 的操作不太相关。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T14:21:23.980

杰伦，

我一直无法安装 2008 Team Developer 版本 - 不断收到权限错误。但是，我能够安装 2008 Team Database 版本。我通常会同时安装这两个版本，所以对于没有安装开发者版感到有点沮丧。如果您好奇，错误的屏幕截图在[这里。](https://stackoverflow.com/questions/443075/install-vs-2008-team-developer-on-windows-7)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-01T12:10:24.893

团队版没有问题，但仅用于 Web 项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-01T12:16:06.870

自 RC1 以来，我一直在工作中使用它，并且没有遇到任何问题。已经开发了一个 WinForms 应用程序、一个 WebForms 站点，现在正在从事一个 MVC 项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-01T12:32:34.717

I have had zero problems running Visual Studio 2008 Pro on 32 bit and 64 bit editions of Windows 7 for full-time C++ development.

If the application you are developing doesn't behave correctly under UAC you may will need to run the IDE as admin otherwise it won't run correctly under debug (this is the applications problem, not Windows 7 or Visual Studios).

Others seem to have problems with access rights/permissions, this should also be fixable by running the IDE as admin (via right click) or more permanently via the compatibility tab in the shortcut properties. I don't know why this happens, is probably related to their particular user account settings.

# php - 如何在 JS 中翻译字符串

> ID：431672
> 
> 赞同：6
> 
> 时间：2009-01-10T20:22:14.957
> 
> 标签：php, javascript, jquery, zend-framework, translation

我有一个项目，我想为 PHP 部分翻译成多种语言，我使用 Zend Frameworks Zend_Translate 和 GetText。现在我也想翻译 JS 部分。

我正在使用 jQuery JS 框架，很想听听您对 JS 文件翻译的想法

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-10T20:59:18.313

我已经在三个项目中成功地使用 GetText 翻译了 JavaScript 文件。

当然，GetText 本身不支持 JavaScript，JavaScript 也不支持 GetText。我的解决方案如下。

*   在 JavaScript 中，我用`gettext("your text here")`.
*   然后我有一个脚本，它从 JavaScript 文件中提取字符串并创建一个 C 文件，因为 gettext 支持 C。
*   然后我使用`xgettext`生成的 C 文件和项目中的任何其他文件来生成 POT 和 PO 文件。

翻译 PO 文件后，我必须将翻译返回到 JavaScript...

*   我再次解析 JavaScript 文件，记住可翻译字符串的列表，然后为每个语言环境：
*   使用支持 GetText 的语言（在我的情况下为 PHP）我翻译所有字符串并输出 JavaScript 文件。

例如，爱沙尼亚语（例如`et_EE.js`）的语言环境文件可能如下所示：

```
var LOCALE = {
  "Hello": "Tere",
  "My name is %s": "Minu nimi on %s",
  "Enter your credit card number": "Sisesta oma krediitkaardi number"
};

function gettext(string) {
  return LOCALE[string] ? LOCALE[string] : string;
} 
```

根据您选择的语言环境，您可以包括`et_EE.js`或`en_US.js`...

`en_US.js`可能只包含以下内容：

```
function gettext(string) {
  return string;
} 
```

有点棘手`ngettext()`，但您应该了解总体思路。

最棒的是我可以使用所有已经可用的 gettext 工具。特别是当我在 PHP 和 JavaScript 中都有可翻译的文本时 - 我可以使用相同的工具来翻译它们，并确保在 JavaScript 和 PHP 中以相同的方式翻译相同的字符串。

**注意：**如果您不是在处理 JavaScript 密集型网络应用程序，那么在首先使用 JavaScript 创建页面内容之前，您应该三思而后行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T05:53:45.910

[http://24ways.org/2007/javascript-internationalisation](http://24ways.org/2007/javascript-internationalisation)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-11T08:46:10.960

您可能也会感兴趣：[一个用于 jQuery 的 gettext 插件](http://plugins.jquery.com/project/gettext)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-11T08:51:46.923

好吧，您可以扩展字符串以给它们一个翻译函数，该函数在语言环境中查找接收者。

你会像这样使用它：

alert("你最喜欢的语言是英语！".translated());

并且您会收到“tu idiom prefiero es Espanol”或其他内容的警报

尼可

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-11T01:34:39.320

```
// just for some idea 
//var language ="fr_FR";
var language ="sp_SP";

var FRLOCALE = {
  "Hello": "bonjure ",
  "My name is %s": "mo nome oc ",
  "what": "some french thing"
};

var SPLOCALE = {
  "Hello": "Spanish for hello",
  "My name is %s": "spanish for my name is ",
  "what": "qu"
};

function translated(language, string){
    if (language.indexOf("fr") > -1) {
        return FRLOCALE[string] ? FRLOCALE[string] : string;
    } 

    if (language.indexOf("sp") > -1) {
      return SPLOCALE[string] ? SPLOCALE[string] : string;
    }

    return string; 
}

alert(translated(language,"Hello"));

alert(translated(language,"some thing not translated ")); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T20:34:21.373

[http://plugins.jquery.com/project/jquery-localize](http://plugins.jquery.com/project/jquery-localize)找到了这个，它被 letmegooglethatforyou.com 使用，也找到了这个[http://plugins.jquery.com/project/l10n](http://plugins.jquery.com/project/l10n)哪个更好？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T18:14:18.210

我有一个 PHP 网页，它也以多种语言存在。我已经用 PHP 编写了自己的语言类，当涉及到本地化 JavaScript 文件时，我刚刚将服务器配置为也将 .js 文件作为 PHP 执行，并且我使用我的 PHP 类来翻译 JavaScript 字符串。

像这样的东西：

```
alert ( '<?php echo $l->Get ( 'MyString' ); ?>' ); 
```

我只是在每个 JavaScript 文件的开头包含一个初始化“$l”的文件。我对此没有任何问题。

# unit-testing - Resharper 是否支持 RowTest？

> ID：431673
> 
> 赞同：4
> 
> 时间：2009-01-10T20:22:16.437
> 
> 标签：unit-testing, resharper, rowtest

Resharper 无法识别 Rowtests，这正常吗？有没有办法修复它？（*除了手动拆分rowtest*）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-10T20:57:24.060

安装 Gallio www.gallio.org

它有一个 ReSharper 插件，可让您运行 NUnit/MbUnit 行测试

# python - 等效于 shell 'cd' 命令来更改工作目录？

> ID：431684
> 
> 赞同：789
> 
> 时间：2009-01-10T20:28:16.723
> 
> 标签：python, cd

`cd`是改变工作目录的shell命令。

如何更改 Python 中的当前工作目录？

* * *

## 回答 #1

> 赞同：883
> 
> 时间：2009-01-10T20:41:50.877

您可以使用以下命令更改工作目录：

```
import os

os.chdir(path) 
```

使用此方法时，需要遵循两个最佳实践：

1.  在无效路径上捕获异常（WindowsError、OSError）。如果抛出异常，请不要执行任何递归操作，尤其是破坏性操作。他们将在旧路径上运行，而不是在新路径上运行。
2.  完成后返回旧目录。这可以通过将您的 chdir 调用包装在上下文管理器中以异常安全的方式完成，就像 Brian M. Hunt 在[他的 answer](https://stackoverflow.com/questions/431684/how-do-i-cd-in-python/13197763#13197763)中所做的那样。

更改子进程中的当前工作目录不会更改父进程中的当前工作目录。Python 解释器也是如此。您不能用于`os.chdir()`更改调用进程的 CWD。

* * *

## 回答 #2

> 赞同：345
> 
> 时间：2012-11-02T15:00:21.080

这是更改工作目录的上下文管理器的示例。它比其他地方提到的[ActiveState 版本](http://code.activestate.com/recipes/576620-changedirectory-context-manager)更简单，但这可以完成工作。

### 上下文管理器：`cd`

```
import os

class cd:
    """Context manager for changing the current working directory"""
    def __init__(self, newPath):
        self.newPath = os.path.expanduser(newPath)

    def __enter__(self):
        self.savedPath = os.getcwd()
        os.chdir(self.newPath)

    def __exit__(self, etype, value, traceback):
        os.chdir(self.savedPath) 
```

或者使用[ContextManager](https://docs.python.org/2/library/contextlib.html#contextlib.contextmanager)尝试[更简洁的等价物（如下）](https://stackoverflow.com/a/24176022/263998)。

### 例子

```
import subprocess # just to call an arbitrary command e.g. 'ls'

# enter the directory like this:
with cd("~/Library"):
   # we are in ~/Library
   subprocess.call("ls")

# outside the context manager we are back wherever we started. 
```

* * *

## 回答 #3

> 赞同：150
> 
> 时间：2009-01-10T20:43:26.880

我会这样使用`os.chdir`：

```
os.chdir("/path/to/change/to") 
```

顺便说一句，如果您需要找出当前路径，请使用`os.getcwd()`.

更多[在这里](http://effbot.org/librarybook/os.htm)

* * *

## 回答 #4

> 赞同：142
> 
> 时间：2014-06-12T03:30:46.080

`cd()`使用生成器和装饰器很容易编写。

```
from contextlib import contextmanager
import os

@contextmanager
def cd(newdir):
    prevdir = os.getcwd()
    os.chdir(os.path.expanduser(newdir))
    try:
        yield
    finally:
        os.chdir(prevdir) 
```

然后，即使在引发异常后，目录也会恢复：

```
os.chdir('/home')

with cd('/tmp'):
    # ...
    raise Exception("There's no place like /home.")
# Directory is now back to '/home'. 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2009-01-10T21:02:31.147

如果您使用的是相对较新的 Python 版本，您还可以使用上下文管理器，例如[这个](http://software.clapper.org/grizzled-python/epydoc/grizzled.os-module.html#working_directory)：

```
from __future__ import with_statement
from grizzled.os import working_directory

with working_directory(path_to_directory):
    # code in here occurs within the directory

# code here is in the original directory 
```

*更新*

如果您更喜欢自己动手：

```
import os
from contextlib import contextmanager

@contextmanager
def working_directory(directory):
    owd = os.getcwd()
    try:
        os.chdir(directory)
        yield directory
    finally:
        os.chdir(owd) 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2013-05-22T14:48:03.950

正如其他人已经指出的那样，上述所有解决方案仅更改当前进程的工作目录。当您退出到 Unix shell 时，这将丢失。如果绝望，你**可以**用这个可怕的 hack 改变 Unix 上的父 shell 目录：

```
def quote_against_shell_expansion(s):
    import pipes
    return pipes.quote(s)

def put_text_back_into_terminal_input_buffer(text):
    # use of this means that it only works in an interactive session
    # (and if the user types while it runs they could insert characters between the characters in 'text'!)
    import fcntl, termios
    for c in text:
        fcntl.ioctl(1, termios.TIOCSTI, c)

def change_parent_process_directory(dest):
    # the horror
    put_text_back_into_terminal_input_buffer("cd "+quote_against_shell_expansion(dest)+"\n") 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-01-10T20:34:31.093

`os.chdir()`是 Pythonic 版本的`cd`.

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-01-10T20:34:53.450

`os.chdir()`是正确的方法。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2018-11-07T16:40:15.383

```
import os

abs_path = 'C://a/b/c'
rel_path = './folder'

os.chdir(abs_path)
os.chdir(rel_path) 
```

您可以同时使用 os.chdir(abs_path) 或 os.chdir(rel_path)，无需调用 os.getcwd() 来使用相对路径。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-07-02T13:50:24.640

进一步进入 Brian 指出的方向并基于[sh](https://github.com/amoffat/sh) (1.0.8+)

```
from sh import cd, ls

cd('/tmp')
print ls() 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-10-10T18:05:47.963

如果您想执行类似“cd..”选项的操作，只需键入：

**os.chdir("..")**

它与 Windows cmd 中的相同： cd.. 当然**import os**是必需的（例如，将其键入为代码的第一行）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-08-08T14:01:28.047

[路径](https://github.com/jaraco/path)库中的`Path`对象为此提供了上下文管理器和方法：`chdir`

```
from path import Path

with Path("somewhere"):
    ...

Path("somewhere").chdir() 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-04-03T04:48:02.807

如果您使用 spyder 和 love GUI，您只需单击屏幕右上角的文件夹按钮并浏览您想要作为当前目录的文件夹/目录。这样做之后，您可以转到 spyder IDE 窗口的文件资源管理器选项卡，您可以看到那里存在的所有文件/文件夹。要检查您当前的工作目录，请转到 spyder IDE 的控制台并简单地键入

```
pwd 
```

它将打印与您之前选择的相同路径。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2016-03-06T21:08:55.100

更改脚本进程的当前目录很简单。我认为问题实际上是如何更改调用python脚本的命令窗口的当前目录，这非常困难。Windows 中的 Bat 脚本或 Bash shell 中的 Bash 脚本可以使用普通的 cd 命令执行此操作，因为 shell 本身就是解释器。在 Windows 和 Linux 中，Python 都是一个程序，没有任何程序可以直接改变其父环境。然而，将一个简单的 shell 脚本与一个 Python 脚本相结合，可以完成大多数困难的工作，可以达到预期的效果。例如，为了制作一个带有遍历历史的扩展 cd 命令，用于向后/向前/选择重新访问，我编写了一个相对复杂的 Python 脚本，由一个简单的 bat 脚本调用。遍历列表存储在一个文件中，目标目录在第一行。当 python 脚本返回时，bat 脚本读取文件的第一行并将其作为 cd 的参数。完整的 bat 脚本（为简洁起见减去注释）是：

```
if _%1 == _. goto cdDone
if _%1 == _? goto help
if /i _%1 NEQ _-H goto doCd
:help
echo d.bat and dSup.py 2016.03.05\. Extended chdir.
echo -C = clear traversal list.
echo -B or nothing = backward (to previous dir).
echo -F or - = forward (to next dir).
echo -R = remove current from list and return to previous.
echo -S = select from list.
echo -H, -h, ? = help.
echo . = make window title current directory.
echo Anything else = target directory.
goto done

:doCd
%~dp0dSup.py %1
for /F %%d in ( %~dp0dSupList ) do (
    cd %%d
    if errorlevel 1 ( %~dp0dSup.py -R )
    goto cdDone
)
:cdDone
title %CD%
:done 
```

python 脚本 dSup.py 是：

```
import sys, os, msvcrt

def indexNoCase ( slist, s ) :
    for idx in range( len( slist )) :
        if slist[idx].upper() == s.upper() :
            return idx
    raise ValueError

# .........main process ...................
if len( sys.argv ) < 2 :
    cmd = 1 # No argument defaults to -B, the most common operation
elif sys.argv[1][0] == '-':
    if len(sys.argv[1]) == 1 :
        cmd = 2 # '-' alone defaults to -F, second most common operation.
    else :
        cmd = 'CBFRS'.find( sys.argv[1][1:2].upper())
else :
    cmd = -1
    dir = os.path.abspath( sys.argv[1] ) + '\n'

# cmd is -1 = path, 0 = C, 1 = B, 2 = F, 3 = R, 4 = S

fo = open( os.path.dirname( sys.argv[0] ) + '\\dSupList', mode = 'a+t' )
fo.seek( 0 )
dlist = fo.readlines( -1 )
if len( dlist ) == 0 :
    dlist.append( os.getcwd() + '\n' ) # Prime new directory list with current.

if cmd == 1 : # B: move backward, i.e. to previous
    target = dlist.pop(0)
    dlist.append( target )
elif cmd == 2 : # F: move forward, i.e. to next
    target = dlist.pop( len( dlist ) - 1 )
    dlist.insert( 0, target )
elif cmd == 3 : # R: remove current from list. This forces cd to previous, a
                # desireable side-effect
    dlist.pop( 0 )
elif cmd == 4 : # S: select from list
# The current directory (dlist[0]) is included essentially as ESC.
    for idx in range( len( dlist )) :
        print( '(' + str( idx ) + ')', dlist[ idx ][:-1])
    while True :
        inp = msvcrt.getche()
        if inp.isdigit() :
            inp = int( inp )
            if inp < len( dlist ) :
                print( '' ) # Print the newline we didn't get from getche.
                break
        print( ' is out of range' )
# Select 0 means the current directory and the list is not changed. Otherwise
# the selected directory is moved to the top of the list. This can be done by
# either rotating the whole list until the selection is at the head or pop it
# and insert it to 0\. It isn't obvious which would be better for the user but
# since pop-insert is simpler, it is used.
    if inp > 0 :
        dlist.insert( 0, dlist.pop( inp ))

elif cmd == -1 : # -1: dir is the requested new directory.
# If it is already in the list then remove it before inserting it at the head.
# This takes care of both the common case of it having been recently visited
# and the less common case of user mistakenly requesting current, in which
# case it is already at the head. Deleting and putting it back is a trivial
# inefficiency.
    try:
        dlist.pop( indexNoCase( dlist, dir ))
    except ValueError :
        pass
    dlist = dlist[:9] # Control list length by removing older dirs (should be
                      # no more than one).
    dlist.insert( 0, dir ) 

fo.truncate( 0 )
if cmd != 0 : # C: clear the list
    fo.writelines( dlist )

fo.close()
exit(0) 
```

# windows-vista - Windows Vista 去饱和：灰度 UI

> ID：431686
> 
> 赞同：1
> 
> 时间：2009-01-10T20:29:42.680
> 
> 标签：windows-vista, colors

偶尔在 Windows Vista 中运行时，操作系统会使屏幕去饱和，将所有颜色呈现为灰度。**有没有办法以编程方式做到这一点？**如果做不到这一点，有没有办法通过调整 Vista 设置来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T21:23:07.643

嗯，如果我不得不猜测的话，我会说 Vista（顺便说一下，XP）只是在整个屏幕上应用某种覆盖。我猜这是通过使用某种混合模式渲染一个不透明的矩形来完成的。**不过，这只是我的猜测**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T20:49:59.933

德米特里的怀疑是正确的。Windows 基本上会截取屏幕截图并将其淡化，同时在其前面显示一个弹出窗口。如果需要，您也可以这样做。

您可以通过运行视频或动画来测试这一点，然后选择关闭以显示该弹出窗口和变暗的背景 - 请注意视频已停止，当您取消“关闭”并返回您的应用程序时，您会看到视频在后台继续播放。

编辑：我不知道执行此操作的现有功能，但没有什么能阻止您创建自己的功能。

# iphone - UIImageView 动画慢

> ID：431696
> 
> 赞同：2
> 
> 时间：2009-01-10T20:34:59.017
> 
> 标签：iphone, ios, cocoa-touch, core-animation

我有一个`UIImageView`大约 10 个全屏 jpeg，总计约 128k。将这些放入`UIImageView`with`setAnimationImages`就像模拟器中的冠军一样，直到我尝试在 iPhone 上运行它导致失败。这里有什么问题吗？我认为对于我看过的所有花哨的 3D 游戏，我的蹩脚的小动画应该可以正常工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T11:39:53.933

3D游戏不是用`UIImageView`的，他们用`OpenGL`。

从这些来看：

[使用 UIImageView setAnimationImages 时出现虚拟内存泄漏？](http://www.iphonedevsdk.com/forum/iphone-sdk-development/7546-virtual-memory-leak-when-using-uiimageview-setanimationimages.html)

[UIImageView setAnimationImages：泄漏动画数组](http://openradar.appspot.com/radar?id=330)

该方法本身是错误的。我建议自己加载和动画图像（创建和管理 s 数组`UILayer`或简单地将 s 切换`UIImage`为`UIImageView`）。

# php - “使用 PHP 进行 HTTP 身份验证”的好处

> ID：431698
> 
> 赞同：11
> 
> 时间：2009-01-10T20:35:21.793
> 
> 标签：php, security, authentication

[使用带有 PHP](http://www.php.net/features.http-auth)（HTTP 401 标头）的 HTTP 身份验证
而不是使用普通表单提交身份验证有什么好处？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-11T11:56:59.920

从安全角度来看，**基于表单的**身份验证和**[HTTP 基本访问身份验证](http://en.wikipedia.org/wiki/Basic_access_authentication)**都使用纯文本来发送身份验证数据。（当然，HTTP Basic Auth 还使用 Base64，但这不是问题。）

虽然 HTTP Basic Auth 在每个请求上发送身份验证数据，但基于表单的身份验证仅在发送表单时发送身份验证数据（请记住：都是纯文本）。使用基于表单的身份验证时，通常使用会话来维护状态。

因此，如果您想使用其中之一，请务必使用 HTTPS 加密您的连接，以防止嗅探和[中间人攻击](http://en.wikipedia.org/wiki/Session_hijacking)。当您选择基于表单和会话的变体时，请务必保护您的会话处理，以防止或至少检测会话欺诈，如[Session Hijacking](http://en.wikipedia.org/wiki/Session_fixation)和[Session Fixation](http://en.wikipedia.org/wiki/Digest_access_authentication)。

最后一个变体是**[HTTP Digest Access Authentication](http://en.wikipedia.org/wiki/Challenge-response_authentication)**。这与 Basic 之间的主要区别在于，Digest 是一种[质询-响应身份验证](http://en.wikipedia.org/wiki/Challenge-response_authentication)，而客户端必须对每个请求都进行质询，而响应只是一个 MD5 哈希。因此，没有发送纯文本的身份验证数据。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-10T21:02:33.220

您的问题有点含糊，但一般的答案是使用此方法为您提供了一个更“RESTful”的实现，该实现遵循 HTTP 已经擅长的。在这种情况下，抛出 401 是其他 Web 服务器、Web 代理和 Web 浏览器知道如何处理的。如果您只是吐出一个 HTML 表单，它只能由最终用户操作，而使用 HTTP 状态代码允许机器交互。

我建议检查一下[`http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol`](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol)以了解 HTTP 的真正含义。我认为这应该使所有这些更有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T01:39:00.060

作为revolutiontrigger所说的一个例子，对于使用基于表单的身份验证的网站，我最常在RSS提要上使用HTTP身份验证，仅仅是因为许多RSS阅读器可以进行HTTP身份验证，但不能进行基于表单的身份验证。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-10T22:23:31.780

你做网站？如果是，则使用 <form> 标签.. 它更漂亮；）

您让应用程序可以被其他应用程序访问并发送某种形式的数据？然后使用 HTTP 身份验证。

据我所知，在安全方面、速度或其他方面没有太大区别……它只是丑陋且易于实施。

# data-structures - AVL 树总是红黑树的子集吗？

> ID：431714
> 
> 赞同：3
> 
> 时间：2009-01-10T20:41:49.940
> 
> 标签：data-structures, avl-tree, red-black-tree

我正在寻找所有 AVL 树都可以像红黑树一样着色的证据？任何人都可以提供证据吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-24T13:05:39.647

根据定义，R/B 树的平衡可能比 AVL-s 稍差，如 |maxPath - minPath| 对于 AVL 必须 <= 1 并且 maxPath <= 2 * minPath 对于 R/Bs 以便不是每个 R/B 都是 AVL，但另一方面，AVL-s 不需要有空子树，所以

```
 4
    / \
   3   6
  /\   /\
 1  E 5  8 
```

是完全合法的 AVL，它不是 R/B，因为 R/B 不能包含叶子，并且必须由始终为黑色的空树终止 - 这样您就无法为上面的树着色。要使其成为 R/B，您可以将每个叶子 x 转换为节点 E x E，然后遵循以下规则： R/B 树：必须是 BST 必须仅包含节点和空树，其颜色为黑色或红色 每个红色节点有黑色子节点所有空树都是黑色给定一个节点，到空树的所有路径必须具有相同数量的黑色节点任何叶子都可以替换为左右子树为空的节点最大路径 T ≤ 2 * 最小路径 T

顺便说一句，它刚刚意识到它把我的节点和叶子染成红色——这不是故意的。卡罗尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-23T22:49:38.557

红黑树通过红色节点调整分支高度，因此如果高度差有界，则始终可以调整所有分支，从最短的黑色分支开始。但这需要非常大的成本，因为你必须计算所有的分支高度。

红黑树的最大局部高度差界为 2。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-15T18:19:58.620

答案是肯定的，每棵 AVL 树都可以着色为红黑，反之则不成立。

我还没有完全弄清楚如何做到这一点，并且也在寻找证据。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-24T21:19:29.790

I suspect the answer is no.

AVL trees balance better than RB trees, which means they balance differently, which would rather imply that you could not colour every AVL tree as a valid RB tree.

# c - 为什么由于弱类型在 C 中实现垃圾收集是“不可能的”？

> ID：431719
> 
> 赞同：21
> 
> 时间：2009-01-10T20:43:21.373
> 
> 标签：c, memory-management, garbage-collection

一个相当聪明的人告诉我，你不能在 C 中实现垃圾收集，因为它是弱类型的。基本思想似乎是 C 给了你太多的自由。他提到了没有类型检查的铸造指针......

我真的不明白这个想法。有人可以给我一个解释，可能还有一个代码示例，说明为什么这不起作用。

注意：显然 C 是关于速度的，为什么要添加垃圾收集？我真的很好奇。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-10T20:48:28.257

他可能提到了这样一个事实，即您可以将指针强制转换为 int 并返回原始指针类型。当你这样做时，GC 几乎不可能正确清理，请考虑：

```
char * p = (char *) malloc(16);
int i = (int) p;
p = 0;
// GC runs and finds that the memory is no longer referenced
p = (char *) i;
// p is now a dangling pointer 
```

**编辑**：上面只会产生一个带有精确 GC 的悬空指针。正如其他人指出的那样，保守的收集器仍然可以正确处理这种情况，因为它假定**任何**可能是有效指针的位模式实际上都是指针，因此不会释放分配的内存。但是，当 i 被进一步修改以使其不再看起来像指向收集器的有效指针时，这当然不再可能，例如如下：

```
char * p = (char *) malloc(16);
int i = ~((int) p);
p = 0;
// GC runs and finds that the memory is no longer referenced
p = (char *) ~i;
// p is now a dangling pointer 
```

此外，（再次正如其他人所指出的）如果您想保留该语言的全部功能，则仅不可能为 C 实现 GC。如果您避免使用上述技巧（即您将自己限制在可能操作的一个子集），那么 GC 确实是可行的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-10T21:08:43.897

完全有可能在 C 中实现你能想到的任何内存管理器。问题是你必须专门使用它的分配/释放功能，并将你的“指针魔法”限制在它可以跟踪的东西上。此外，内存管理可能仅限于某些受支持的类型。

例如，Objective-C 的保留/释放系统和自动释放池基本上是用 C 实现的内存管理器。许多库也实现了自己的简单形式的内存管理，如引用计数。

然后是 Boehm 垃圾收集器。要使用它，只需将您的`malloc()`/`realloc()`调用替换为 Boehm 版本，您就不必再调用`free()`了。阅读[此方法可能存在的问题](http://www.hpl.hp.com/personal/Hans_Boehm/gc/issues.html)。

此外，[请查看此维基百科页面](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)#Precise_vs._conservative_and_internal_pointers)以快速了解保守垃圾收集器的工作原理。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-11T01:05:30.937

如果您阅读了正确的论文并且拥有 CS 学士学位，那么实际上很容易为 C 实现一个体面的*保守*垃圾收集器——我有十几个学生在课堂练习中完成了它，大约需要四个星期。然后花 20 年改进它，你就得到了[Boehm 收集器 (libgc)](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)。

基本思想很简单：如果在寄存器、堆栈、全局变量或活动堆对象中的任何位置存在位模式，并且该位模式恰好是位于分配有 的对象内的地址`malloc`，比那个对象被认为是*活*的。任何不活动的对象都不可能通过跟随指针到达，因此它可以被回收并用于满足未来的分配请求。这种技术对指针的硬件表示进行操作，它*完全*独立于指针的*类型*——类型在这里是无关紧要的。

确实有一个警告：保守的垃圾收集技术可能会被故意隐藏的指针所欺骗。压缩包含指针的结构，在磁盘上保留指针的唯一副本，通过 XORing 混淆指针`0xdeadbeef`，所有这些技术都会破坏保守的收集器。但除非刻意去做，否则这种问题极为罕见。优化编译器的作者通常注意不要对此类收集器隐藏指针。

您问题中最有趣的部分是**为什么要这样做**。三个原因：

*   它消除了许多内存管理错误的可能性。

*   它**简化了您的 API**，因为不再需要指定谁分配内存、谁拥有分配的内存、是否需要复制内存以及谁负责释放内存。

*   信不信由你，[它可以](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.14.1816)比使用`malloc`and更快`free`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-10T21:05:51.327

问题是运行时无法确定是否引用了任何内存。即使您将所有内存分配包装在注册使用情况的代码中，您仍然可以通过常规指针操作（或错误地）获得指向已用内存的指针。强制转换只会使问题在运行时变得更加困难。因此，如果运行时释放了一块内存，那么对于仍然指向该内存区域的任何指针，它都会搞砸。显然，当您认为垃圾收集也必须适用于多线程应用程序时，情况只会变得更糟。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-10T21:25:51.473

为 C 实现垃圾收集器并非*不可能*（事实上，它们确实存在，正如一个简单的[谷歌搜索](http://www.google.com/search?q=c+garbage+collector)所揭示的那样），这很困难，因为很难确定某个位字符串**是否**是指向已分配的指针块或只是**看起来**像一个。

这是一个问题的原因是因为 C（和 C++，就此而言）允许您从指针类型强制转换为整数类型，因此整数变量可能会在分配的块中保存地址，从而阻止 GC 释放该块，即使该值不打算用作指针。

例如，假设我分配了一块内存。假设这块内存从地址 0x00100000 (1,048,576) 开始分配，长度为 1 MB，因此扩展到 0x001FFFFF (2,097,151)。

假设我还将图像文件的大小存储在一个变量中（我们称之为 fileSize）。该图像文件恰好为 1.5 MB（1,572,864 字节）。

所以当垃圾收集器运行时，它会遇到我的`fileSize`变量，发现它包含一个与我分配的块中的地址相对应的值，并决定它不能释放这个块，以免它使我的可能指针无效。那是因为 GC 不知道我是否这样做了：

```
int fileSize;
{
    char *mem = (char*)malloc(1048576);
    fileSize = (int)(mem + 524288);
}
// say GC runs here 
```

或者如果我刚刚这样做：

```
int fileSize;
{
    char *mem = (char*)malloc(1048576);
    fileSize = 1572864;
}
// say GC runs here; 
```

在后一种情况下，在 *mem 处释放块是安全的（如果不存在其他引用），而在前一种情况下则不然。它必须是保守的并假设它不是，因此内存“泄漏”（至少直到 fileSize 超出范围或更改为分配块之外的值）。

但是 C（和 C++）的垃圾收集器**确实**存在。它们是否有价值是另一个讨论的问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-10T21:22:00.983

由于 C 指针的自由度以及 C 数组的长度是任何人的猜测，因此不可能为 C 实现[精确的垃圾收集器。](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)#Precise_vs._conservative_and_internal_pointers)这意味着不能使用许多复杂的垃圾收集方法。（我想到了复制和压缩垃圾收集器。）

但是，可以实现一个保守的垃圾收集器（[boehm](http://en.wikipedia.org/wiki/Boehm_garbage_collector)），它基本上假设所有看起来可能是指针的东西都是指针。这不是很有效，但它适用于“作品”的适当宽松定义。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-10T21:27:30.847

C 不是弱类型，但这段代码说明了在语言中构建垃圾收集器的困难：

```
#include <stdio.h>
#include <stdlib.h>

int GetSomeMemory() {
    char* pointerToHeapMemory = malloc(10);
    return (int)pointerToHeapMemory;
}

int main() {
    int memoryAddress = GetSomeMemory();

    /* at this point a garbage collector might decide to clear up the memory that
     * was allocated in GetSomeMemory on the grounds that pointerToHeapMemory 
     * is no longer in scope. But the truth is we still know about that memory and 
     * we're about to use it again... */

    char* anotherPointerToHeapMemory = (char*) memoryAddress;

    sprintf(anotherPointerToHeapMemory, "123456789\0");
    printf("%s\n", anotherPointerToHeapMemory);
} 
```

只要从事项目的每个人都同意避免这种事情并使用一组通用的函数来分配和访问内存，就可以进行垃圾收集。例如，[这是一个 C 垃圾收集器实现](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)

# powershell - 有没有更简单的方法在 Powershell v2 中使用扩展方法

> ID：431727
> 
> 赞同：6
> 
> 时间：2009-01-10T20:49:07.883
> 
> 标签：powershell, extension-methods

## 背景

这篇文章解释了如何在 Powershell 中使用扩展方法

[http://community.bartdesmet.net/blogs/bart/archive/2007/09/06/extension-methods-in-windows-powershell.aspx](http://community.bartdesmet.net/blogs/bart/archive/2007/09/06/extension-methods-in-windows-powershell.aspx)

将此与某人在 C# 中所做的比较 - 他们添加了“使用 SomeAssembly”并加载了所有扩展方法。

## 我的问题

这是否变得更简单 Powershell 2.0\. 如果是这样，如何在 Powershell 2.0 中使用扩展方法？我检查了公开可用的文档并安装了 CTP，但没有看到任何有用的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T00:08:11.723

在 V2 中它并没有变得更容易，但是有一个您可能不知道的扩展机制。

我相信部分问题在于 PowerShell 对泛型的处理（或缺乏）。

此外，对于要应用的扩展方法，必须强制执行类型化集合，这在 PowerShell 中是困难的。PowerShell 作为一种动态语言，支持构建各种类型的集合，并且大多数集合都表示为 Object 数组。扩展方法需要从集合类型中推断出参数，然后检查谓词的类型是否正确。

如果您关心的是一些类似 LINQ 的函数，那么有许多 cmdlet 在处理对象集合时提供了相同的功能。

PowerShell 的扩展类型系统允许您通过添加 xml 文件或修改现有文件（建议创建新文件）来为各种类型添加方法。Jeffrey Snover 在[这篇博](http://blogs.msdn.com/powershell/archive/2008/09/06/hate-add-member-powershell-s-adaptive-type-system.aspx)文中演示了如何将 ScriptProperty 添加到 Object 类中。

它不完全相同，但它可以完成工作。

# bash - 用于操作 dhcp/conf 的脚本

> ID：431736
> 
> 赞同：1
> 
> 时间：2009-01-10T20:54:48.790
> 
> 标签：bash, shell

我想编写一个脚本来操作 dhcp.conf 文件。从某种意义上说，它必须读取文件，它应该 ping 所有租用 IP，并应该提供另一个文本文件，其中应该提供 IP 列表，哪些设备现在存在。

编辑：感谢您的迅速回复。dhcpd.conf 文件是这样的

```
lease 172.31.0.10 {
  some text
  some text1
}

lease 172.31.0.12 {
  some text
  some text1
}

lease 172.31.0.100 {
  some text
  some text1
} 
```

所以首先我需要先提取IP地址，然后我们必须逐个ping

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T22:06:01.610

# 假设

首先，您需要注意两点：

*   并非所有设备都响应 ping。相当多的 PC 防火墙禁用 ping 回复。如果您在以太网上，`arping`则可以使用它，甚至可以检测防火墙 PC。
*   dhcpd 在它/knows/ 不再有效的文件中留下租约。

所以，这里有一个例子：

```
lease 192.168.66.132 {
  starts 4 2009/01/08 23:58:41;
  ends 5 2009/01/09 00:00:41;
  binding state free;
  hardware ethernet 00:e0:81:28:2d:56;
}
lease 192.168.66.133 {
  starts 5 2009/01/09 03:17:17;
  ends 2 2038/01/19 03:14:06;
  binding state active;
  next binding state free;
  hardware ethernet 00:e0:81:28:2d:57;
} 
```

你可以看到 132 没有被使用 ( `binding state free`) 而 133 是 ( `binding state active`)。另一种可能性是`binding state backup`，但这仅发生在故障转移配置中。

也可以放弃租约，这意味着 DHCP 服务器将分配该 IP，但发现它已在使用中（通过 ping）。

这都记录在`dhcpd.leases(5)`.

# 你为什么要这个？

1.  DHCP 服务器已经重新使用过期的租约。您是否有充分的理由需要检查其工作？如果您的租约已用完，您是否考虑过缩短租约时间？

2.  做`nmap -sP <start_ip>-<end_ip>`你需要的吗？这还将检测具有静态 IP 地址的机器。

# 重写问题

因此，鉴于上述情况，并假设您仍然想要这个，我将回答这个问题：

> 请编写一个脚本来查找所有处于活动状态或已放弃的租约，并确定当前是否有机器使用该 IP 地址。

所以：

```
#!/usr/bin/perl
use File::Slurp qw(slurp);
use Data::Dump qw(pp);
use strict;

1 == @ARGV
    or die "Usage: $0 dhpcd.leases\n";
my $leases = slurp($ARGV[0]);
$leases =~ s/^#.*\n//mg;
my @leases = split(/lease (\d.+\d.+\d.+\d+) {/, $leases);
shift @leases;
my %lease = @leases;

while (my ($ip, $rec) = each %lease) {
    print $ip;
    $rec =~ /^\s*abandoned;\s*$/m and print " abandoned";
    $rec =~ /^\s*binding state free;\s*$/m and print " free";
    $rec =~ /^\s*binding state active;\s*$/m and print " active";
    print "\n";
} 
```

这个相对丑陋的 perl 脚本会给你如下输出：

```
192.168.66.132 free
192.168.66.133 active 
```

这对你来说应该很容易喂给arping。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T15:45:27.183

问题是，**绑定状态处于活动状态；**并不意味着，设备处于活动状态。为了确保设备处于活动状态，我们需要先 ping 设备。我们别无他法

# html - 以 HTML 格式显示 Django 查询结果 - 表、列表、css div？

> ID：431738
> 
> 赞同：0
> 
> 时间：2009-01-10T20:57:12.733
> 
> 标签：html, css, django

我正在开发一个 django 应用程序，它将返回历史上的信息表：

```
ISSUE  DESCRIPTION  INITIATOR  INITIATEDDATE  ASSIGNEE  FORECASTDATE  STATUS  REMARKS 
```

这将是用户对问题列表进行排序/过滤等的入口点。
ISSUE、DATES、NAMES 等列的宽度相对固定，但其他列可以是一个段落或更多。

在 HTML 中呈现它的最佳方式是什么？作为 HTML 表格、列表或带有大量 CSS 跨度/div 的？

我最终希望使问题列表也可以使用 javascript 进行排序或过滤。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T21:50:23.343

CSS 纯粹主义者提出的整个论点是，您需要保持代码与其包含的信息在语义上相关。您需要显示的是表格数据，并且您使用`<table>`标签来执行此操作。表的唯一“问题”是当它们用于控制布局时，例如使您的两列布局成为两个`<td>`s 而不是两个`<div>`s。但是，在这种情况下，表格就足够了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-10T21:24:28.980

如果您尝试显示的信息是表格的（看起来是这样），那么请使用表格。

另外，请参阅这些问题以进行更多辩论！

*   [表而不是 DIV](https://stackoverflow.com/questions/30251/tables-instead-of-divs)
*   [为什么不在 HTML 中使用表格进行布局？](https://stackoverflow.com/questions/83073/div-vs-table)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T01:53:33.057

正如两个答案所说，表格数据应该使用`<table>`标签显示。

换个角度来看，当使用表格进行布局时，这是对表格标签的滥用。当 div 标签用于做表格布局时，这是相反方向的滥用。不要用一个来做另一个的工作。

# c# - CustomControl 棋盘上突出显示的方块不会持续超出初始 MouseDown 事件

> ID：431739
> 
> 赞同：1
> 
> 时间：2009-01-10T20:57:13.433
> 
> 标签：c#, .net, gdi+, chess

我一直在用 C# 编写一个 Windows 应用程序国际象棋游戏作为磨练我的技能的练习，也因为它很有趣。我已经包含了允许玩家选择选项以突出显示一个棋子在被点击时可以合法移动到的方格的功能。CustomControl 处理棋盘的呈现，它还突出显示正方形。

这一切都按计划进行，直到玩家开始将棋子拖到新的方块上。鼠标一移动，高光就消失了。我怀疑引发了 Paint 事件并且板重新绘制自身。而且由于高光不是初始电路板布局的一部分，因此它们不会被绘制。

我想要做的是让方块保持突出显示，直到将棋子放在其目标方块上。有可能做到这一点吗？任何建议将不胜感激。

伪代码：

```
 void piece_MouseDown(object sender, MouseEventArgs e)
    {
        Piece piece = (Piece)sender;

        legalSquares = CalculateLegalSquares(piece.CurrentSquare);

        if (legalSquares.Count > 0 && this.showLegalMoves)
        {
            chessBoard1.HighlightSquares(legalSquares);
        }

        // I believe a Paint event gets raised either here...
        piece.DoDragDrop(piece, DragDropEffects.Move);
    }

    void piece_DragEnter(object sender, DragEventArgs e)
    {
        // ...or here, that removes the highlights.
        if (e.Data.GetDataPresent("Chess.Piece"))
        {
            e.Effect = DragDropEffects.Move;
        }
        else
        {
            e.Effect = DragDropEffects.None;
        }
    }

    void piece_DragDrop(object sender, DragEventArgs e)
    {
        Piece piece = (Piece)e.Data.GetData("Chess.Piece");

        if (piece.CurrentSquare != dropSquare)
        {
            if (legalSquares.Contains(dropSquare))
            {
                // This is where I’d like the highlights to stop

                // DoStuff()
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T21:05:52.153

听起来您正在通过直接绘制来突出显示有效的方块，但这会在任何重绘时被删除。如果您的窗口也因其他原因而重新绘制，例如最小化和恢复它，或者在其上拖动另一个窗口，您可能会丢失高光。

如果是这种情况，您可能需要覆盖 OnPaint 方法并在那里进行突出显示。当您想要更改突出显示的内容时，请在您的类中设置一些状态以控制在 OnPaint 方法中突出显示的内容，然后使您的窗口无效。

# c# - 带有图像的组合框 - 将值传递给 drawItem 事件

> ID：431749
> 
> 赞同：1
> 
> 时间：2009-01-10T21:02:44.657
> 
> 标签：c#, combobox

我有一个带有组合框的 C# 应用程序。我以通常的方式向其中添加项目，使用循环遍历一些对象并将每个名称属性值添加到组合框：

```
comboBox1.Items.Add(object.name); 
```

但后来我决定要通过文本显示图像，所以我更改了 drawMode 和 dropDownStyle 并在 drawItem 上设置了一个事件处理程序，以先绘制图像然后绘制文本。

图像绘制正确，然后出现问题。我正在使用类似的东西

```
 e.Graphics.DrawString("What goes here?", e.Font, new SolidBrush(e.ForeColor), e.Bounds.Left,e.Bounds.Top); 
```

我无法将 object.name 值放入 DrawString 参数中。DrawItemEventArgs 对象 e 是否具有该值，如果是，我如何访问它？

如果不是，我真正的选择是什么？我似乎有一些示例维护一个列表以保留值，然后使用 e.Index 引用它。这真的是最好的方法吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T21:30:52.977

看起来[DrawItemEventArgs 为您提供了 index](http://msdn.microsoft.com/en-us/library/system.windows.forms.drawitemeventargs.index.aspx)。使用该索引索引到 comboBox1.Items。

# python - Python csv.reader：如何返回文件顶部？

> ID：431752
> 
> 赞同：57
> 
> 时间：2009-01-10T21:04:49.097
> 
> 标签：python, csv

当我使用 csv.reader 浏览文件时，如何返回文件顶部。如果我使用普通文件执行此操作，我可以执行“file.seek(0)”之类的操作。csv 模块有类似的东西吗？

提前谢谢;)

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-01-10T21:12:26.150

您可以直接查找文件。例如：

```
>>> f = open("csv.txt")
>>> c = csv.reader(f)
>>> for row in c: print row
['1', '2', '3']
['4', '5', '6']
>>> f.seek(0)
>>> for row in c: print row   # again
['1', '2', '3']
['4', '5', '6'] 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-10T21:11:23.220

您仍然可以使用 file.seek(0)。例如，请看以下内容：

```
import csv
file_handle = open("somefile.csv", "r")
reader = csv.reader(file_handle)
# Do stuff with reader
file_handle.seek(0)
# Do more stuff with reader as it is back at the beginning now 
```

这应该可以工作，因为 csv.reader 正在使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-09T13:57:58.377

由于当前`csv.reader`的. [从第一次阅读中列出清单](https://stackoverflow.com/a/55790863/7621907)效果很好：`csv.DictReader``line_num`

```
>>> import csv
>>> f = open('csv.txt')
>>> lines = list( csv.reader(f) ) # <-- list from csvReader
>>>
>>> for line in lines:
...  print(line)
['1', '2', '3']
['4', '5', '6']
>>>
>>> for line in lines:
...  print(line)
['1', '2', '3']
['4', '5', '6']
>>>
>>>lines[1]
['4', '5', '6'] 
```

这捕获了[可选的第一行](https://docs.python.org/3/library/csv.html#csv.DictReader)，`dictReader`但允许您一次又一次地使用列表，甚至检查单个行。

# c# - 获取我在 Windows Vista 上使用 C# .Net 连接的无线网络的 SSID

> ID：431755
> 
> 赞同：27
> 
> 时间：2009-01-10T21:05:50.110
> 
> 标签：c#, windows-vista, wireless

我想知道是否有任何 .Net 类可以让我知道我连接的无线网络的 SSID。到目前为止，我只找到了下面链接的库。是我能得到的最好的还是我应该使用别的东西？ [托管 WiFi](http://www.codeplex.com/managedwifi) ( [http://www.codeplex.com/managedwifi](http://www.codeplex.com/managedwifi) )

利用**WMI**的方法适用于 Windows XP，但它不再适用于 Windows Vista。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-10T23:35:34.333

我解决了使用图书馆。结果很容易使用提供的类：

首先我必须创建一个 WlanClient 对象

```
wlan = new WlanClient(); 
```

然后我可以使用以下代码获取 PC 连接到的 SSID 列表：

```
Collection<String> connectedSsids = new Collection<string>();

foreach (WlanClient.WlanInterface wlanInterface in wlan.Interfaces)
{
   Wlan.Dot11Ssid ssid = wlanInterface.CurrentConnection.wlanAssociationAttributes.dot11Ssid;
   connectedSsids.Add(new String(Encoding.ASCII.GetChars(ssid.SSID,0, (int)ssid.SSIDLength)));
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-08-23T09:37:12.893

我们使用的是托管 wifi 库，但如果在查询期间网络断开连接，它会引发异常。

尝试：

```
var process = new Process
{
    StartInfo =
    {
    FileName = "netsh.exe",
    Arguments = "wlan show interfaces",
    UseShellExecute = false,
    RedirectStandardOutput = true,
    CreateNoWindow = true
    }
};
process.Start();

var output = process.StandardOutput.ReadToEnd();
var line = output.Split(new[] { Environment.NewLine }, StringSplitOptions.RemoveEmptyEntries).FirstOrDefault(l => l.Contains("SSID") && !l.Contains("BSSID"));
if (line == null)
{
    return string.Empty;
}
var ssid = line.Split(new[] { ":" }, StringSplitOptions.RemoveEmptyEntries)[1].TrimStart();
return ssid; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-10T21:12:23.263

看起来这会做你想要的：

```
ManagementObjectSearcher searcher = new ManagementObjectSearcher("root\\WMI",
"SELECT * FROM MSNdis_80211_ServiceSetIdentifier");

foreach (ManagementObject queryObj in searcher.Get())
{
    Console.WriteLine("-----------------------------------");
    Console.WriteLine("MSNdis_80211_ServiceSetIdentifier instance");
    Console.WriteLine("-----------------------------------");

    if(queryObj["Ndis80211SsId"] == null)
        Console.WriteLine("Ndis80211SsId: {0}",queryObj["Ndis80211SsId"]);
    else
    {
        Byte[] arrNdis80211SsId = (Byte[])
        (queryObj["Ndis80211SsId"]);
        foreach (Byte arrValue in arrNdis80211SsId)
        {
            Console.WriteLine("Ndis80211SsId: {0}", arrValue);
        }
    }
} 
```

来自[http://bytes.com/groups/net-c/657473-wmi-wifi-discovery](http://bytes.com/groups/net-c/657473-wmi-wifi-discovery)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-02T21:46:52.563

[如何在 .net 中获取可用的 wifi AP 及其信号强度](https://stackoverflow.com/questions/496568/how-do-i-get-the-available-wifi-aps-and-their-signal-strength-in-net)？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-13T20:20:02.773

（交叉发布在[如何使用 WMI 或 System.Net.NetworkInformation windows 10 在 c# 中获取当前连接的 wifi SSID？](https://stackoverflow.com/questions/39346232/how-to-get-currently-connected-wifi-ssid-in-c-sharp-using-wmi-or-system-net-netw)）

我发现了一个可以追溯到 2014 年的相当古老的图书馆：

```
Microsoft.WindowsAPICodePack-Core version 1.1.0.2 
```

虽然它不符合 .NET Standard，但这个库与我的 .NET Core 3.0 应用程序集成，但显然不是跨平台的。

示例代码：

```
var networks = NetworkListManager.GetNetworks(NetworkConnectivityLevels.Connected);            
foreach (var network in networks) { 
    sConnected = ((network.IsConnected == true) ? " (connected)" : " (disconnected)");
    Console.WriteLine("Network : " + network.Name + " - Category : " + network.Category.ToString() + sConnected);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T23:10:54.023

您将不得不使用本机 WLAN API。[这里](http://social.msdn.microsoft.com/forums/en-US/windowsgeneraldevelopmentissues/thread/a2daf71e-b0f2-4d0d-bbf0-54518881cafd/#page:1)有一个很长的讨论。显然这是 Managed Wifi API 使用的，因此如果您对使用 LGPL 代码没有任何限制，那么使用它会更容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-07T14:48:48.283

我想做到这一点，并尝试使用 ManagedWifi，正如其他答案中所建议的那样。但这导致了此处无法解决的异常： [Issue with using Managed WiFi (NativeWiFi API)](https://stackoverflow.com/questions/42371871/issues-with-using-managed-wifi-nativewifi-api/60115715#60115715)

我通过完全切换到使用[SimpleWiFi](https://github.com/DigiExam/simplewifi/blob/master/SimpleWifi/Win32/WlanApi.cs#L131)并忽略了 ManagedWifi 包解决了这个问题。

看一下源代码，看起来 SW 是对 MW 中某些功能的固定重新实现。

# windows - 系统信息：产品 ID

> ID：431759
> 
> 赞同：0
> 
> 时间：2009-01-10T21:08:01.463
> 
> 标签：windows, registration, system-information

如果您在命令提示符下键入*systeminfo ，则会有**Product ID*的列表。有人能解释一下这到底是什么吗，它会成为注册码算法的好种子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-10T21:41:59.680

这是一个好的开始。但是（恕我直言）您可以直接使用 GUID。在此处阅读更多信息：[http](http://en.wikipedia.org/wiki/Device_fingerprint) ://en.wikipedia.org/wiki/Device_fingerprint （阅读有关**主动指纹识别**的信息）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T21:42:13.267

我相信它代表（或是）您的 Windows 产品密钥。无论哪种方式，您真正想要的只是一个[GUID](http://rtipton.wordpress.com/2007/09/30/generating-a-guid-in-c/)。

来自[http://technet.microsoft.com/en-us/library/bb878062.aspx](http://technet.microsoft.com/en-us/library/bb878062.aspx)

> 您可以通过右键单击“我的电脑”并选择“属性”，然后查看“常规”选项卡来找到安装的产品 ID。您还可以在注册表中找到产品密钥：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProductId。

# c# - 存储图像以在应用程序中使用

> ID：431760
> 
> 赞同：0
> 
> 时间：2009-01-10T21:08:25.487
> 
> 标签：c#, resx

我想存储一些图像以在我的 C# 应用程序中使用。它们是 png 文件，当前位于包含 dll 的文件夹中。理想情况下，我希望将它们包含在 dll 中，因此我不必在安装中包含实际图像。

做这个的最好方式是什么？

我有关于 resx 的信息，但我不确定最好的解决方法。我是否应该使用另一个项目创建 resx 文件，然后将其添加到我要使用的项目中？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T01:07:11.527

最简单的方法是将它们添加到您当前的项目中，然后将它们的 Build Action 属性设置为 Embedded。我相信会自动将它们添加到资源文件中，然后您可以使用反射访问它们。

这是一篇关于检索它们的文章：

[MSDN](http://msdn.microsoft.com/en-us/library/aa287676(VS.71).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T21:11:31.130

将它们放在资源文件中。您可以将其添加到同一个项目中，无需创建另一个。

# c# - Asp.net Request.Browser.Crawler - 动态爬虫列表？

> ID：431765
> 
> 赞同：8
> 
> 时间：2009-01-10T21:10:08.697
> 
> 标签：c#, asp.net, web-crawler

我了解了为什么 Request.Browser.Crawler 在 C# 中总是 False ( [http://www.digcode.com/default.aspx?page=ed51cde3-d979-4daf-afae-fa6192562ea9&article=bc3a7a4f-f53e-4f88-8e9c-c9337f6c05a0](http://www.digcode.com/default.aspx?page=ed51cde3-d979-4daf-afae-fa6192562ea9&article=bc3a7a4f-f53e-4f88-8e9c-c9337f6c05a0) ) .

有没有人使用某种方法来动态更新爬虫的列表，所以 Request.Browser.Crawler 真的有用吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-10T23:51:42.257

我对[Ocean 的 Browsercaps](http://owenbrady.net/browsercaps/)提供的结果很满意。它支持微软的配置文件没有检测到的爬虫。它甚至会解析出您网​​站上的爬虫版本，而不是我真的需要那种详细程度。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-10T21:40:48.870

您可以对照`Request.UserAgent`.

Peter Bromberg 写了一篇关于在 ASP.NET 中编写[ASP.NET 请求记录器和爬虫杀手](http://www.eggheadcafe.com/tutorials/aspnet/a988f8c3-f69e-4ad2-a2e9-f9e01867769c/aspnet-request-logger-an.aspx)的好文章。

这是他在`Logger`课堂上使用的方法：

```
public static bool IsCrawler(HttpRequest request)
{
   // set next line to "bool isCrawler = false; to use this to deny certain bots
   bool isCrawler = request.Browser.Crawler;
   // Microsoft doesn't properly detect several crawlers
   if (!isCrawler)
   {
       // put any additional known crawlers in the Regex below
       // you can also use this list to deny certain bots instead, if desired:
       // just set bool isCrawler = false; for first line in method 
       // and only have the ones you want to deny in the following Regex list
       Regex regEx = new Regex("Slurp|slurp|ask|Ask|Teoma|teoma");
       isCrawler = regEx.Match(request.UserAgent).Success;
   }
   return isCrawler;
} 
```

# c# - C# 我需要 TRY/CATCH 才能抛出吗？

> ID：431785
> 
> 赞同：9
> 
> 时间：2009-01-10T21:19:50.597
> 
> 标签：c#, try-catch

如果我只想在异常发生时将其提高一个级别？

```
private void TryCatch()
{
   try
   {
       foo();
   }
   catch (Exception ex)
   {
       throw;
   }
}

private void NoTryCatch()
{
   foo();
} 
```

这两种方法不一样吗？

如果在 TryCatch 中发生异常，则会向上抛出一个级别，如果在 NoTryCatch 中发生异常，则该异常也会被向上抛出一个级别。

这个问题是在使用 ReSharper 之后出现的，并注意到它建议删除 try/catch 块，因为它是多余的。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-10T21:23:04.520

是的，这些方法几乎 (*) 相同。唯一的区别是在第一个断点很容易。我总是选择第二个，除非我真的需要在那里打破并且只在那里（而不是立即抛出任何那种类型的异常，这很容易）。即使我曾经使用过第一种形式，我也会在提交代码之前将其放回第二种形式。

(*) JIT 处理它们的方式可能存在一些差异。第一个最终会得到更多的 IL，这将影响内联等的机会。

编辑：我无法抗拒一些微基准测试。看起来 try/catch/throw 对性能的影响比仅仅禁用内联更严重：

```
using System;
using System.Diagnostics;
using System.Runtime.CompilerServices;

public class Test
{
    const int Iterations = 1000000000;

    static void Main()
    {
        Stopwatch sw;

        sw = Stopwatch.StartNew();
        for (int i=0; i < Iterations; i++)
        {
            SimpleMethod();
        }
        sw.Stop();
        Console.WriteLine("Simple method: {0}", sw.ElapsedMilliseconds);

        sw = Stopwatch.StartNew();
        for (int i=0; i < Iterations; i++)
        {
            NoInlining();
        }
        sw.Stop();
        Console.WriteLine("No inlining: {0}", sw.ElapsedMilliseconds);

        sw = Stopwatch.StartNew();
        for (int i=0; i < Iterations; i++)
        {
            TryCatchThrow();
        }
        sw.Stop();
        Console.WriteLine("try/catch/throw: {0}", sw.ElapsedMilliseconds);
    }

    static void SimpleMethod()
    {
        Foo();
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    static void NoInlining()
    {
    }

    static void TryCatchThrow()
    {
        try
        {
            Foo();
        }
        catch (Exception)
        {
            throw;
        }
    }

    static void Foo() {}
} 
```

编译`/o+ /debug-`

结果（三轮）：

简单方法：504、495、489
无内联：2977、3060、3019
try/catch/throw：5274、4543、5145

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-10T21:21:57.300

不，您不需要 try catch。您想要使用第一个函数的唯一原因是，如果您想在进一步处理该函数之前进行一些日志记录或释放资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T21:21:52.963

这两种方法本质上是一样的。在这种情况下，ReSharper 的建议是正确的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T23:10:13.807

They really are not the same. `Throw` on its own or `throw ex` mess with the stack trace information and can make debugging harder.

The best reason to catch an exception is to add context to the stack trace, like:

```
try {
  Foo();
}
catch (Exception e) {
  throw new BetterException("I did something slightly silly", e);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-10T22:35:46.823

我想到了一些东西，但我不确定100％，所以我去检查了。我是对的，有时。

显然，如果您重新抛出异常，这就是您的代码正在执行的操作，您最终可能会更改堆栈跟踪。首先，如果您要编写`throw ex;`它将重置堆栈跟踪。其次，即使在写作时`throw;`，也可能会出现信息丢失的情况。请参阅这篇[文章](http://weblogs.asp.net/fmarguerie/archive/2008/01/02/rethrowing-exceptions-and-preserving-the-full-call-stack-trace.aspx)和一些后续的[用户评论。](http://kristofverbiest.blogspot.com/2007/02/rethrow-exception-using-throw.html)

当然，这些问题大多与堆栈跟踪和行号有关，这很重要，但我认为它也会影响性能，不仅仅是因为内联（或缺少内联），还因为整个异常捕获并抛出开销，但我没有找到任何具体的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T21:22:26.660

ReSharper 是正确的。除非您真的打算捕获并处理异常，否则包含 try..catch 块是没有意义的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-10T21:22:32.807

是的，try catch 块是多余的。堆栈将被展开，直到找到一个 try/catch 来处理异常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-10T21:22:35.600

如果您所做的只是重新抛出异常，则不需要 try/catch 块。通常，您应该仅在可以处理异常时才捕获异常。否则让它们向上传播。

# objective-c - 以编程方式更新 Core Data 中的属性

> ID：431797
> 
> 赞同：19
> 
> 时间：2009-01-10T21:23:44.240
> 
> 标签：objective-c, cocoa, core-data, object

我查看了 Core Data 的所有类文档，但找不到以编程方式更新核心数据实体中的值的方法。例如，我有一个类似这样的结构：

```
 id  | title
============
  1  | Foo  
  2  | Bar  
  3  | FooFoo 
```

假设我想将 Bar 更新为 BarBar，我在任何文档中都找不到任何方法来执行此操作。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2011-07-13T19:59:41.520

在 Core Data 中，对象就是对象——数据库不是你向其抛出命令的东西。

要更新持久化的内容，您需要将其重新创建为对象、更新并保存。

```
NSError *error = nil;

//This is your NSManagedObject subclass
Books * aBook = nil;

//Set up to get the thing you want to update
NSFetchRequest * request = [[NSFetchRequest alloc] init];
[request setEntity:[NSEntityDescription entityForName:@"MyLibrary" inManagedObjectContext:context]];
[request setPredicate:[NSPredicate predicateWithFormat:@"Title=%@",@"Bar"]];

//Ask for it
aBook = [[context executeFetchRequest:request error:&error] lastObject];
[request release];

if (error) {
//Handle any errors
}

if (!aBook) {
    //Nothing there to update
}

//Update the object
aBook.Title = @"BarBar";

//Save it
error = nil;
if (![context save:&error]) {
           //Handle any error with the saving of the context
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-10T22:12:10.117

[Apple 关于在 Core Data 中使用托管对象的文档](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CoreData/Articles/cdUsingMOs.html)可能有你的答案。简而言之，您应该能够执行以下操作：

```
NSError *saveError;
[bookTwo setTitle:@"BarBar"];
if (![managedObjectContext save:&saveError]) {
    NSLog(@"Saving changes to book book two failed: %@", saveError);
} else {
    // The changes to bookTwo have been persisted.
} 
```

（注意：`bookTwo`必须是与`managedObjectContext`此示例相关联的托管对象才能工作。）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-11T01:08:13.973

听起来您正在考虑基础关系数据库。Core Data 的 API 是围绕模型对象构建的，而不是关系数据库。

实体是一个 Cocoa 对象——它的一个实例`NSManagedObject`或某个子类。实体的属性是对象的属性。您使用键值编码，或者，如果您实现子类，则使用点语法或访问器方法来设置这些属性。

Evan DiBiase 的回答显示了设置属性的一种正确方法——特别是访问器消息。这是点语法：

```
bookTwo.title = @"BarBar"; 
```

和 KVC（你可以使用普通的 old `NSManagedObject`）：

```
[bookTwo setValue:@"BarBar" forKey:@"title"]; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-11T01:10:28.430

如果我正确理解您的问题，我认为您需要记住的只是托管对象与任何其他 Cocoa 类实际上没有什么不同。属性有访问器和修改器，你可以在代码中使用，通过键值编码或绑定，只有在这种情况下它们是由 Core Data 生成的。唯一的技巧是，如果您想避免使用 setValue:ForKey:，则需要在类文件（如果有的话）中为您的实体手动声明生成的访问器。文档对此进行了更详细的描述，但简短的回答是您可以在数据模型设计器中选择您的属性，然后从“设计”菜单中选择**“复制 Obj-C 2.0 方法声明” 。**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-26T02:30:42.407

```
NSManagedObject *object = [self.fetchedResultsController objectAtIndexPath:indexPath];

NSManagedObjectContext *context = [self.fetchedResultsController managedObjectContext];

        NSArray *temp = [[NSArray alloc]initWithObjects:@"NewWord", nil];

        [object setValue:[temp objectAtIndex:0] forKey:@"title"];

        // Save the context.
        NSError *error = nil;
        if (![context save:&error]) {
            NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
            abort();
        } 
```

我认为这段代码会给你这个想法；）

# asp.net - 在 Silverlight 2 数据网格上，如何获取仅包含已编辑行的集合？

> ID：431803
> 
> 赞同：0
> 
> 时间：2009-01-10T21:28:34.823
> 
> 标签：asp.net, silverlight, datagrid, silverlight-2.0

我使用 WCF 服务将数据加载到我的网格中。当用户在我的 silverlight 2 控件上单击“提交”时，我只想将已编辑的行发送回我的 WCF 服务以进行更新。有没有好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T03:03:42.120

如果您监视源对象的更改，那就更好了。编写一个简单的类来使用 INotifyPropertyChange 注册更改并保留更改对象（源）的列表很容易。

# mysql - 部署 .NET 应用程序时出现 MySQL 错误

> ID：431821
> 
> 赞同：0
> 
> 时间：2009-01-10T21:41:20.117
> 
> 标签：mysql, connection

我正在尝试将 MYSQL 驱动的 .net 应用程序安装到 Windows XP sp2 机器上。开发机器是相同的操作系统。该应用程序和所有连接在我的机器上都可以正常工作（开发人员的口头禅），但是在尝试连接到数据库时，我在安装机器上收到以下错误。

作为旁注，我可以通过 OLE 提供程序（通过 UDL 文件）连接到数据库

************** 异常文本 ************** System.ArgumentException：不支持关键字。参数名称：在 MySql.Data.MySqlClient.MySqlConnectionStringBuilder.set_Item(String key,对象值）在 System.Data.Common.DbConnectionStringBuilder.set_ConnectionString(String value) 在 MySql.Data.MySqlClient.MySqlConnection.set_ConnectionString(String value) 在 MySql.Data.MySqlClient.MySqlConnection..ctor(String connectionString) 在 CaseManager.Login .OpenConnection() 在 CaseManager.Login.button1_Click(Object sender, EventArgs e) 在 System.Windows.Forms.Control.OnClick(EventArgs e) 在 System.Windows.Forms.Button。

************** 加载的程序集 ************** mscorlib 程序集版本：2.0.0.0 Win32 版本：2.0.50727.42 (RTM.050727-4200)

## 代码库：file:///C:/WINDOWS/Microsoft.NET/Framework/v2.0.50727/mscorlib.dll

CaseManager 程序集版本：1.0.0.0 Win32 版本：1.0.0.0

## 代码库：file:///C:/Program%20Files/B3IS/Intelicase/CaseManager.exe

System.Windows.Forms 程序集版本：2.0.0.0 Win32 版本：2.0.50727.42 (RTM.050727-4200)

## 代码库：file:///C:/WINDOWS/assembly/GAC_MSIL/System.Windows.Forms/2.0.0.0__b77a5c561934e089/System.Windows.Forms.dll

系统组装版本：2.0.0.0 Win32 版本：2.0.50727.42 (RTM.050727-4200)

## 代码库：file:///C:/WINDOWS/assembly/GAC_MSIL/System/2.0.0.0__b77a5c561934e089/System.dll

System.Drawing 程序集版本：2.0.0.0 Win32 版本：2.0.50727.42 (RTM.050727-4200)

## 代码库：file:///C:/WINDOWS/assembly/GAC_MSIL/System.Drawing/2.0.0.0__b03f5f7f11d50a3a/System.Drawing.dll

BusinessEntities 程序集版本：1.0.0.0 Win32 版本：1.0.0.0

## 代码库：file:///C:/Program%20Files/B3IS/Intelicase/BusinessEntities.DLL

MySql.Data 程序集版本：5.0.8.1 Win32 版本：5.0.8.1

## 代码库：file:///C:/WINDOWS/assembly/GAC_MSIL/MySql.Data/5.0.8.1__c5687fc88969c44d/MySql.Data.dll

System.Data 程序集版本：2.0.0.0 Win32 版本：2.0.50727.42 (RTM.050727-4200)

## 代码库：file:///C:/WINDOWS/assembly/GAC_32/System.Data/2.0.0.0__b77a5c561934e089/System.Data.dll

System.Transactions 程序集版本：2.0.0.0 Win32 版本：2.0.50727.42 (RTM.050727-4200)

## 代码库：file:///C:/WINDOWS/assembly/GAC_32/System.Transactions/2.0.0.0__b77a5c561934e089/System.Transactions.dll

************** JIT 调试 ************** 要启用即时 (JIT) 调试，此应用程序的 .config 文件或计算机 (machine.config) 必须在 system.windows.forms 部分中设置 jitDebugging 值。还必须在启用调试的情况下编译应用程序。

例如：

启用 JIT 调试后，任何未处理的异常都将发送到计算机上注册的 JIT 调试器，而不是由该对话框处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T22:09:14.757

```
Keyword not supported. Parameter name: command logging 
```

这似乎是相关的部分。MySQL 连接 DSN 是由我猜想在您的 UDL 文件中的参数构造的。只有某些参数对 MySQL DSN 有意义，无法识别的参数会导致这样的错误。

在这种情况下，“ `command logging`”似乎是无法识别的参数。

我不知道您是如何生成 UDL 文件的，但显然您输入了一些无法识别的参数。有关 MySQL DSN 参数的有效列表，请参阅文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T22:26:38.497

发布请求后，我删除了该参数以及 Allow Zero DateTime 并且它起作用了。奇怪的是，它（在代码中）在开发机器上工作。两台机器上的驱动程序和 MDAC 版本相同。

# mysql - 如何在 SQL 中连接多个表，其对象将使用继承建模？

> ID：431825
> 
> 赞同：1
> 
> 时间：2009-01-10T21:44:02.203
> 
> 标签：mysql, database, inheritance, modeling

对于我的大学作业，我必须设计一些基本的疾病管理系统，以及所有的学校。我决定以以下形式对一些基本继承进行建模

*   人 --> 学生
*   人员 --> 员工
*   人 --> 监护人

人员（PersonID、FirstName、LastName）

学生（StudentID（引用 PersonID），...）

我决定这样做的原因是我首先在 UML 中对其进行建模并在其中继承。

我有另一个表，其中存储了同时具有 StudentID、StaffID 和 GuardianID 的事件。但是我想知道如何在 mysql 中创建一个连接来显示所有三个继承人的名字？

例如

Student.FirstName Student.LastName、Staff.FirstName、Staff.LastName 等...

我该怎么做？

还是我这样做完全错了？

提前致谢。

[http://pastebin.com/m263dd7](http://pastebin.com/m263dd7) - 链接到我的 DDL 以获取表格。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T22:20:27.777

我对您描述的数据库设计没有任何问题。在 SQL 中建模继承总是有点尴尬，但您使用了问题最少的解决方案。

这是一个查询，用于回答您有关检索给定事件的学生和工作人员姓名的问题：

```
SELECT ps.FirstName, ps.LastName, pf.FirstName, pf.LastName
FROM Incidents i
 JOIN Students s USING (student_id)
 JOIN Persons ps ON (s.student_id = ps.person_id)
 JOIN Staff f USING (staff_id)
 JOIN Persons pf ON (f.staff_id = pf.person_id)
WHERE i.incident_id = ?; 
```

我假设`Incidents`表格看起来包括以下列：

```
CREATE TABLE Incidents (
  incident_id SERIAL PRIMARY KEY,
  student_id  INT NOT NULL,
  staff_id    INT NOT NULL,
  FOREIGN KEY (student_id) REFERENCES Students(student_id),
  FOREIGN KEY (staff_id) REFERENCES Staff(staff_id)
); 
```

实际上，我希望事件与每个教职员工和学生之间存在某种多对多的关系。否则，事件可能只涉及一名学生和一名工作人员？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T21:50:54.857

这个不对。您应该有一个 Person 类，而其他类将确定某个 Person 是 Student、Staff 等。如果您有一个 Staff 也是学生，会发生什么？如果学生毕业会怎样？

这是关系模型和OO模型之间阻抗不匹配的典型例子。

例如，您可以有三个表：

PERSON
PersonId 姓 名

STUDENT StudentId PersonId

STAFF
StaffId PersonId

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T22:00:37.050

我不知道真正的用法是什么，但是仅仅为了可重用性而使用继承并不是一个好主意。

乍一看，`Person`在大学管理系统（类似的东西）上上课似乎是不对的。

你最好提及任务的目标/目的——应该做什么。

# iphone - 从 iPhone 应用程序发出 GET 和 POST 请求 - 需要澄清

> ID：431826
> 
> 赞同：5
> 
> 时间：2009-01-10T21:44:15.307
> 
> 标签：iphone, cocoa-touch, http, networking

我正在关注[我的问题的这个有用的答案](https://stackoverflow.com/questions/319463/can-i-make-post-or-get-requests-from-an-iphone-application#322573)。

它似乎有效，但我有两个问题：

1.  如何检测 HTTP 错误？didFailWithError 方法似乎没有被调用？

**更新：** [它认为任何响应都是成功的](http://www.gigliwood.com/weblog/Cocoa/Q__When_is_an_conne.html)。所以我想我必须在 didRecieveResponse 方法中处理 HTTP 错误，但是除了在遇到 HTTP 错误时告诉用户有错误之外，我是否需要以某种方式停止连接？和/或清理？

2.  我在答案中看到了这一行：

> ```
> [[NSURLConnection alloc] initWithRequest:request delegate:self]; 
> ```

我需要释放它吗？在哪里，如何，何时？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-11T07:36:28.340

您将获得在 didReceiveResponse 中返回的状态码

```
-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response{
    NSHTTPURLResponse *httpResponse;
    httpResponse = (NSHTTPURLResponse *)response;
    int statusCode = [httpResponse statusCode];
    //statusCode will be the http code returned like 201,500
 } 
```

要停止连接，请使用连接的类级别变量。最好的方法是创建一个发送请求和接收响应的包装器。使您的视图控制器成为此类的委托，并且每当 didReceiveResponse 给出错误状态代码时，调用委托的适当方法并停止连接。

这是一个很好的包装类示例

[http://kosmaczewski.net/projects/objective-c-rest-client/](http://kosmaczewski.net/projects/objective-c-rest-client/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-10T23:41:54.570

是的，您需要释放该对象。请参阅[Cocoa 的内存管理编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Tasks/MemoryManagementRules.html)。基本上，如果您创建了一个方法名称以`alloc`or`new`或 contains开头`copy`的对象，您将成为该对象的所有者并负责稍后释放它。只有在您知道在程序终止之前您将需要该对象的情况下才可以不释放它，在这种情况下，操作系统会在您的应用程序终止时回收内存。

如果您只需要小范围内的对象，您可以向它发送`autorelease`消息。这会将其添加到自动释放池中。自动释放池会定期向其中的`release`每个对象发送一条消息。这有点复杂；请参阅有关[自动释放池](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Concepts/AutoreleasePools.html#//apple_ref/doc/uid/20000047)的部分。例如：

但是，在这种情况下，因为`NSURLConnection`s 是异步的，所以自动释放将不起作用。你不知道它什么时候会用数据回调到你的对象中，所以你要确保对象还没有被释放。唯一可以确定的方法是确切地知道您何时完成了该对象，然后`release`自己向它发送一条消息。

所有的各种`init*`函数都返回一个指向给定对象的指针，所以你可以这样做：

```
NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
...
// when done with connection:
[connection release]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T01:47:13.473

在您的“更新”中回答问题...

立即自动释放 NSURLConnection。连接对象由 NSRunLoop 保留（除非您使用 startImmediately:NO 构造函数，否则它会自动添加到该对象中）。它会在错误或完成时自动从运行循环中删除（并因此被释放）。

# c++ - 消息窗口 C++ Win32 类/示例

> ID：431827
> 
> 赞同：1
> 
> 时间：2009-01-10T21:44:36.240
> 
> 标签：c++, winapi, window, message

是否有用于 C++ [Win32](http://en.wikipedia.org/wiki/Windows_API)中的仅消息窗口的类/示例应用程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-11T01:13:40.937

[来自CreateWindow](http://msdn.microsoft.com/en-us/library/ms632679(VS.85).aspx)的文档：

> hWndParent [in] 正在创建的窗口的父窗口或所有者窗口的句柄。要创建子窗口或拥有的窗口，请提供有效的窗口句柄。该参数对于弹出窗口是可选的。
> 
> Windows 2000/XP：**要创建仅消息窗口，请提供 HWND_MESSAGE 或现有仅消息窗口的句柄**。

[这](http://www.google.com/codesearch/p?hl=en#N6Qhr5kJSgQ/WebCore/platform/win/SharedTimerWin.cpp&q=HWND_MESSAGE)是我认为来自 WebKit 的一些代码，它为计时器事件设置了一个仅消息窗口。

这是一篇文章，展示了一种（可能过于）奇特的方式来创建一个不可见的、仅消息窗口： http: [//www.codeguru.com/cpp/wp/win32/tutorials/article.php/c12689](http://www.codeguru.com/cpp/w-p/win32/tutorials/article.php/c12689)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T00:47:36.747

如果我记得，标准的解决方案是像往常一样创建一个带有消息泵的基本无样式窗口，但永远不要在其上调用 ShowWindow。通过这种方式，您可以接收和处理发送到所有窗口的标准消息，例如 WM_QUERYENDSESSION。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T23:56:43.103

当您需要在线程中处理窗口消息但您实际上不想在屏幕上显示窗口时，使用仅消息窗口。

例如，如果您想使用 Windows 计时器，但没有可以锁定的现有 UI 窗口。

# c# - 使用 Firefox 和 Safari 捕获网页的图像

> ID：431833
> 
> 赞同：1
> 
> 时间：2009-01-10T21:47:54.707
> 
> 标签：c#, .net

我有一个实用程序，它使用 .NET Framework 来捕获网页的图像，以便我可以使用缩略图来预览页面。有些网站提供此服务，例如 websnapr.com、kwiboo.com 和 shrinktheweb.com。我想自己做，并利用 Firefox (Gecko) 和 Safari (WebKit) 来呈现图像。

目前有什么可以做的吗？是否有一个 C# 项目可以连接到 Gecko 和/或 WebKit 以创建加载网页的图像。

我的项目名为 WebPreview，它使用 .NET Framework 中的 WebBrowser 控件，但由于这可能有点过时，因此呈现的屏幕截图看起来不会像最近的 Gecko 或 WebKit 版本那样准确。

[http://www.smallsharptools.com/Projects/WebPreview/](http://www.smallsharptools.com/Projects/WebPreview/)

请对任何可以帮助我的开源项目发表评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-10T22:03:39.277

[我使用一个名为Screengrab](http://addons.mozilla.org/en-US/firefox/addon/1146)的 Firefox 插件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T22:09:23.803

结帐[http://browsershots.org/](http://browsershots.org/)它免费且开放。它在网站的某处说他们使用了哪些插件和技术......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-05T14:10:11.430

你可以看看这个项目[http://www.codeplex.com/url2jpeg](http://www.codeplex.com/url2jpeg)。它使用 Internet Explorer。

# c# - 在 C# 中获取域 LogonServer

> ID：431836
> 
> 赞同：1
> 
> 时间：2009-01-10T21:50:50.580
> 
> 标签：c#, dns, logonserver

在命令提示符下，我可以通过键入以下内容来获取域登录服务​​器：

```
echo %logonserver% 
```

如何在 C# 中获得相同的结果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T21:53:53.743

System.Environment.GetEnvironmentVariable("logonserver")

# .net - 是否可以在 vb.net 中执行内联函数？

> ID：431839
> 
> 赞同：8
> 
> 时间：2009-01-10T21:52:56.800
> 
> 标签：.net, vb.net

问题在标题中

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-10T22:11:57.607

我看到的答案假设您正在谈论编译或 JIT 时间内联 - 它们是完全正确的。但是，我听说过的“内联”一词的另一种用法是用于 lambda 表达式之类的东西 - 在 C# 中，例如：

```
public IEnumerable<int> Foo()
{
    int[] numbers = new[] { 1, 5, 2, 5, 6 };

    return numbers.Select(x => x+10);
} 
```

（`x => x+10`一个 lambda 表达式）在源代码术语中可以被视为“内联函数”，因为它是在另一个方法中声明为“内联”的额外函数。

是的，VB9 有这个：

```
Dim len As Func(Of String, Integer) = Function(x) x.Length       
Console.WriteLine(len("foo")) 
```

我相信 VB9 与 C# 相比有更多限制 - 例如，我*认为*您不能在 VB9 中使用 lambda 表达式创建`Action<T>`（或任何其他具有 void 返回类型的委托类型），而在 C# 中很容易。同样，我相信 lambda 在 VB9 中必须只是一个表达式，而在 C# 中它可以是大括号中的整个块。

从 VB10 开始，您也可以在 VB 中创建多行 lambda 表达式。

当然，如果问题真的是指执行而不是源代码，那么所有这些都是无关紧要的:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-10T22:22:00.330

内联是 CLR (JIT) 的职责，并且有一些关于何时内联函数的条件：

1.  代码大小小于 32 字节的 IL。
2.  该函数不包含“复杂”结构，例如循环、开关等。
3.  该函数不包含 try/catch/finally。
4.  该函数未声明为虚拟函数。

您可能会发现，就代码而言，32 字节**并不是很多**，它适用于快速和小型的 if-else 条件测试、属性 getter/setter。我不认为你可以通过内联更多的代码来获得任何速度。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-04-14T14:41:50.640

5年后这个问题仍然有一些活动（已经？？？）

[使用 .net 4.5 现在可以指定内联方法](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.methodimploptions%28v=vs.110%29.aspx)

只需使用此属性

```
<MethodImplAttribute(MethodImplOptions.AggressiveInlining)> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-10T22:01:44.523

.NET 团队明智地决定，这些特性在编程语言本身中没有位置，因为编译器更擅长决定内联的内容。这是相当激进的说法，但事实是现代 C++ 实际上经常无视`inline`关于内联哪些函数的决策过程的指令。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-07T10:19:48.287

这是一个很好的设施的情况：

我们有一个标准的日志记录函数，传递调用者的名字通常很有用。但是，如果将日志记录设置为低详细度，则日志记录函数会简单地返回以提高性能。为了避免调用者对 System.Reflection.MethodBase.GetCurrentMethod.Name 进行 CPU 昂贵的调用，只是为了让日志记录函数不使用它们，如果我们可以创建一个内联函数，它会提前决定是否要费心查找方法名称：

```
Public Inline Function GetMyname(iLogLevel) as string
  if iLogLevel < 3 then return ""
  return System.Reflection.MethodBase.GetCurrentMethod.Name()
End Function 
```

然后在调用者中，我们可以写一个简洁的行，如：

日志（2，GetMyname（2）和“：发生了什么事”）

但是，如果编译器决定不内联 GetMyname()（因为它肯定会），那么出现在日志中的方法名将始终是“GetMyName”——根本没有用。

称我为老式的，但如果我们开始将所有决定留给编译器（或 CLR！），那么我们不妨寻找新的职业并将其留给“.Net 团队”。有时，软件设计师确实最了解？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-10T21:55:06.657

您不能将函数显式声明为内联，但如果 JIT 优化器看到好处，它可以自由地内联函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-27T20:33:03.873

注意到 Tom 的 5 月 11 日问题，我不得不说，如果您有一个*真正*对性能至关重要的应用程序，那么使用依赖于 CLR 的语言可能不是您的最佳选择。

事实上，面向对象的设计也可能不是您的最佳选择。您可能想认真地看待 C 作为替代方案。

# c# - 如何 在 GridView 单元格中的一个（即一个）中呈现解码的 HTML

> ID：431840
> 
> 赞同：30
> 
> 时间：2009-01-10T21:53:37.907
> 
> 标签：c#, asp.net, gridview, newline

我将 GridView 绑定到 LINQ 查询。LINQ 语句创建的对象中的某些字段是字符串，需要包含换行符。

显然，GridView 对每个单元格中的所有内容进行了 HTML 编码，因此我无法插入 <br /> 来在单元格中创建新行。

如何告诉 GridView 不要对单元格的内容进行 HTML 编码？

也许我应该改用不同的控件？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2010-04-02T04:31:46.480

将[`HtmlEncode`属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.boundfield.htmlencode.aspx)设置为`false`? 对我来说，这要简​​单得多。

```
<asp:BoundField DataField="MyColumn" HtmlEncode="False" /> 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-01-10T22:08:19.283

您可以订阅 RowDataBound 事件吗？如果可以，您可以运行：

```
if (e.Row.RowType == DataControlRowType.DataRow)
{
  string decodedText = HttpUtility.HtmlDecode(e.Row.Cells[0].Text);
  e.Row.Cells[0].Text = decodedText;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-24T13:00:33.160

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{

    for (int i = 0; i < e.Row.Cells.Count; i++)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            string decodedText = HttpUtility.HtmlDecode(e.Row.Cells[i].Text);
            e.Row.Cells[i].Text = decodedText;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-10T22:36:59.910

输出中是否保留了正常的换行符？如果是这样，您可以发送换行符，并使用 css 样式`white-space: pre`，这将保留换行符、空格和制表符。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-18T15:07:39.890

我首先使用从多行文本框中将数据插入到我的 sql-server 表中来解决这个问题

```
 replace (txt = Replace(txt, vbCrLf,"<br />")) 
```

然后我使用 Ray Booysen 的解决方案将其返回到我的 gridview：

```
 Protected Sub grdHist_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles grdHist.RowDataBound

      Dim col1 As String = HttpUtility.HtmlDecode(e.Row.Cells(2).Text)

      e.Row.Cells(2).Text = col1

End Sub 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-04-02T03:20:33.807

Booysen 的答案有效，但仅适用于一列。如果您在 RowDataBound 事件中运行一个循环，您可以用一个变量替换 [0] 并根据需要对每一列进行此操作。这是我所做的：

```
protected void gridCart_RowDataBound(object sender, GridViewRowEventArgs e)
{
    for (int i = 1; i < 4; i++)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            string decode = HttpUtility.HtmlDecode(e.Row.Cells[i].Text);
            e.Row.Cells[i].Text = decode;
        }
    }
} 
```

由于我的数据，我故意从 1 开始，但显然它可以满足您的任何需求。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-09-26T02:35:19.453

```
protected void gvHead_OnRowDataBound(object sender, GridViewRowEventArgs e) {
  for (int i = 0; i < e.Row.Cells.Count; i++) 
    e.Row.Cells[i].Text = HttpUtility.HtmlDecode(e.Row.Cells[i].Text);
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-09-18T10:47:15.203

您必须绑定到 DataBoundGrid 事件并更改要呈现 HTML 代码的列的呈现。

```
public event EventHandler DataBoundGrid {
  add { ctlOverviewGridView.DataBound += value; }
  remove { ctlOverviewGridView.DataBound -= value; }
}

ctlOverview.DataBoundGrid += (sender, args) => {
  ((sender as ASPxGridView).Columns["YourColumnName"] as GridViewDataTextColumn).PropertiesTextEdit.EncodeHtml = false;
}; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-10T08:48:32.617

`@Ray Booysen`答案是正确的，但在某些情况下 HtmlDecode() 无法处理您的问题。您可以使用 UrlDecode() 而不是 HtmlDecode()。
这是另一个解决方案：

```
if (e.Row.RowType == DataControlRowType.DataRow)
{
  string decodedText = HttpUtility.UrlDecode(e.Row.Cells[0].Text);
  e.Row.Cells[0].Text = decodedText;
} 
```

# c++ - 使用八叉树算法进行网格渲染

> ID：431841
> 
> 赞同：1
> 
> 时间：2009-01-10T21:53:41.900
> 
> 标签：c++, direct3d, octree, 3d-engine

我是 SceneMax 的创始人 - 自 2005 年以来是一种 3D 脚本语言。我想使用一个使用 3ds max 等 3d 包构建的网格对象添加场景渲染，并按八叉树算法分割以优化性能。

你知道我在哪里可以找到一种算法，它采用网格 .X 文件，将其拆分为节点（八叉树）并知道如何渲染它？我想将它添加到我的引擎中。该引擎是开源的（如果您有兴趣，请在谷歌上搜索 SceneMax）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T22:41:31.900

有几种变体，但是在构建八叉树时，一种方法是：

1.  从包含整个场景或被分割对象的一个​​节点（即一个立方体）开始。
2.  对于场景/对象中的每个元素（例如网格、多边形或您正在处理的任何粒度）：
    1.  检查该元素是否完全适合节点。
    2.  如果是，则将该节点细分为八个子节点，然后对每个子节点递归执行步骤 2。
    3.  如果否，则继续下一个节点，直到没有节点为止。
    4.  将元素添加到可以包含它的最小节点。

基于一些启发式停止递归也很常见，例如节点的大小或节点内的元素数量是否小于某个阈值。

有关构建八叉树的更多详细信息，请参阅[此 Flipcode 教程。](http://www.flipcode.com/archives/Introduction_To_Octrees.shtml)

一旦你有了八叉树，你可以采取几种方法来渲染它。基本思想是，如果你不能“看到”一个节点，那么你也看不到它的子节点，因此该节点（及其子节点）内的所有内容都不需要渲染。

截锥体剔除很容易实现，“你能看到吗？” 使用您的视图投影的平截头体进行测试。[Gamedev.net 有一篇](http://www.gamedev.net/reference/programming/features/culling/)讨论截锥体剔除和其他一些方法的文章。

您还可以更进一步并在截锥体剔除之后实现遮挡剔除，这将让您跳过渲染被它们前面的节点覆盖的任何节点，使用 z 缓冲区来确定节点是否隐藏。这涉及能够从最近到最远遍历您的八叉树节点。[此Gamasutra 文章](http://www.gamasutra.com/features/19991109/moller_haines_01.htm)中讨论了此技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-13T01:23:31.830

首先考虑您必须支持的网格文件类型很重要。

实际上有 3 种不同类型的对象。1.开阔的自然地形。这非常适合四叉树，因为八叉树带来了不必要的复杂性。如果它不会给你带来太多的性能提升，那么没有理由引入第三维。2\. 开阔的地形，有很多高大的物体。这非常适合八叉树，因为八叉树允许您从渲染中删除垂直轴上的东西，并且像这样的场景有很多这样的东西。老实说，我无法说出任何适合我的想法。3\. 封闭空间或角色模型/静态网格。这非常适合 BSP 树。BSP 树允许完全在屏幕上的对象或封闭空间仅根据需要渲染尽可能多的多边形。

我建议添加 1 和 3，假设 1 甚至是您需要支持的模型类型。#3 对于第一人称射击游戏或角色模型来说是非常标准的，增加对它的支持可能会给你带来最大的收益。总体思路是从渲染中移除尽可能多的几何体，因此对于 95% 的户外地形玩家游戏世界拥有的四叉树是完美的。八叉树有用途，但比你想象的要少。

这些算法中的每一个都相对容易编写。例如，多年前我在 3 小时内写了一个八叉树。通常，这些是在加载时处理的，几何图形被添加到每个正方形（如果是四叉树/八叉树）或树（如果是 BSP），然后进行渲染。通过快速谷歌搜索有很多很棒的文章，我会留给你研究。快速说明的是，BSP 树还具有处理碰撞检测的能力，并且是角色模型和静态网格的理想候选者。因此，我建议您花时间研究这种算法，以确保它足够灵活，可用于多种用途。

# javascript - Firefox 3.0 中未定义 jQuery 每个 tr.children

> ID：431861
> 
> 赞同：2
> 
> 时间：2009-01-10T22:11:20.947
> 
> 标签：javascript, jquery, firefox-3

我正在使用一段代码来过滤表中的行。它在除 Firefox v3.0.x 之外的所有浏览器中都能完美运行（适用于 3.1 beta 2）。当我在 Firefox 3.0.x 中运行该代码段时，它显示`children is undefined`. 我也在使用 jQuery v1.2.6。

代码片段：

```
var bodyRows = $("#resultsTable tbody tr");
bodyRows.each(function(n){
    if(!filterPattern.test($.trim(this.children[2].innerHTML))){ //errors here
            this.style.display = 'none';
    }
    else {
            this.style.display = '';
    }
}); 
```

代码选择所有表格行，然后循环遍历它们，测试第三列的 innerHTML 文本。如果 RegEx 测试失败，则隐藏该行，否则显示该行。

有没有人看到这个问题和/或知道如何让它工作？

谢谢

**编辑：** 这是表格的 HTML 标记。为简洁起见，我只提供了 2 条记录，尽管更多的记录。

```
<table id="resultsTable" cellpadding="0" cellspacing="0">
    <thead>
        <tr>
            <th>First</th>
                <th>Last</th>
            <th>City</th>
            <th>State</th>
            <th>Zip</th>
            <th>Email</th>
            <th>&nbsp;</th>
        </tr>
    </thead>    
    <tbody id="resultsBody">
        <tr>
            <th>James</th>
                <th>Eggers</th>
            <th>SomeCity</th>
            <th>IA</th>
            <th>55555</th>
            <th>email@email.com</th>
            <th>&nbsp;</th>
        </tr>
        <tr>
            <th>John</th>
                <th>Doe</th>
            <th>SomeCity</th>
            <th>KY</th>
            <th>88888</th>
            <th>email2@email.com</th>
            <th>&nbsp;</th>
        </tr>
    </tbody>        
</table> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-10T22:43:15.390

为什么不使用 jQuery 来遍历 DOM 元素呢？

```
var bodyRows = $("#resultsTable tbody tr");
bodyRows.each(function(){
    var thirdCell = $(this).find('td').eq(2);
    if(!filterPattern.test($.trim(thirdCell.html()))){
        this.style.display = 'none';
    } else {
        this.style.display = '';
    }
}); 
```

`.text()`如果您只想返回没有任何可能标记的文本，也可以使用 ' '。

该属性`children`是仅 IE 的 DOM 属性，其他浏览器没有（据我所知）。Firefox 使用标准属性`childNodes`来访问子级。问题`childNodes`在于它认为空白和文本是一个节点（或者至少 Firebug 是这样说的），这使得它（在我看来）非常难以处理。如果你有 JavaScript API，你应该利用它，这样你就不必处理浏览器的 DOM 遍历技术之间的差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T23:55:07.290

```
if(!filterPattern.test($.trim(this.children[2].innerHTML))) 
```

当一个 'each' 回调被 jQuery 调用时，'this' 是一个直接的浏览器 DOM 节点，而不是一个 jQuery 对象。

出现混淆的原因是 jQuery 在其 DOM 包装器上提供了一个“children”方法，而 IE 在其原生 DOM 节点上提供了一个非标准的“children”集合，但是这两个接口几乎完全不兼容。

所以对于 jQuery 版本使用 $(this).children()[2] 或类似的，或者对于标准 DOM 版本使用 this.getElementsByTagName('td')[2] 。

（假设您打算将表格数据元素设为“td”而不是“th”，您可能已经这样做了。另外，您可能想要获取单元格的原始文本，而不是可能有字符以意想不到的方式转义的 innerHTML 版本。 )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T22:18:35.907

在尝试访问第三个元素之前，您可能需要检查子元素的数量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T22:31:33.057

您是否明确添加

```
<tbody>
   ...
</tbody> 
```

标签到你的桌子？如果没有，我会说从以下位置删除“tbody”部分： $("#resultsTable tbody tr");

只是 $("#resultsTable tr");

我很好奇这个版本的 Firefox 是否没有为你隐式创建它。

# python - 忽略python多重返回值

> ID：431866
> 
> 赞同：344
> 
> 时间：2009-01-10T22:12:49.053
> 
> 标签：python, function, tuples

假设我有一个 Python 函数，它在一个元组中返回多个值：

```
def func():
    return 1, 2 
```

有没有一种很好的方法来忽略其中一个结果，而不仅仅是分配给一个临时变量？假设我只对第一个值感兴趣，有没有比这更好的方法：

```
x, temp = func() 
```

* * *

## 回答 #1

> 赞同：697
> 
> 时间：2009-01-10T22:14:42.653

您可以使用`x = func()[0]`返回第一个值，`x = func()[1]`返回第二个值，依此类推。

如果您想一次获取多个值，请使用类似`x, y = func()[2:4]`.

* * *

## 回答 #2

> 赞同：305
> 
> 时间：2009-01-10T22:18:57.810

一种常见的约定是使用“_”作为您希望忽略的元组元素的变量名。例如：

```
def f():
    return 1, 2, 3

_, _, x = f() 
```

* * *

## 回答 #3

> 赞同：131
> 
> 时间：2009-01-11T21:15:51.383

如果您使用的是 Python 3，您可以在变量前使用星号（在赋值的左侧），使其成为解包时的列表。

```
# Example 1: a is 1 and b is [2, 3]

a, *b = [1, 2, 3]

# Example 2: a is 1, b is [2, 3], and c is 4

a, *b, c = [1, 2, 3, 4]

# Example 3: b is [1, 2] and c is 3

*b, c = [1, 2, 3]       

# Example 4: a is 1 and b is []

a, *b = [1] 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2015-03-06T10:01:14.027

通常的做法是使用虚拟变量`_`（单下划线），正如许多人在此之前指出的那样。

但是，为避免与该变量名的其他用途发生冲突（请参阅[此](https://stackoverflow.com/a/5893946/3511304)`__`响应），使用(双下划线) 作为一次性变量可能是一种更好的做法，正如[ncoghlan](https://stackoverflow.com/users/597742/ncoghlan)所指出的那样。例如：

```
x, __ = func() 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-01-10T22:20:20.210

请记住，当您返回多个项目时，您实际上是在返回一个元组。所以你可以做这样的事情：

```
def func():
    return 1, 2

print func()[0] # prints 1
print func()[1] # prints 2 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2009-01-10T22:19:44.547

三个简单的选择。

明显的

```
x, _ = func()

x, junk = func() 
```

可怕

```
x = func()[0] 
```

并且有一些方法可以使用装饰器来做到这一点。

```
def val0( aFunc ):
    def pick0( *args, **kw ):
        return aFunc(*args,**kw)[0]
    return pick0

func0= val0(func) 
```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2018-02-22T16:34:18.097

最好的解决方案可能是命名事物而不是返回无意义的元组（除非返回项目的顺序背后有一些逻辑）。例如，您可以使用字典：

```
def func():
    return {'lat': 1, 'lng': 2}

latitude = func()['lat'] 
```

如果您想添加有关您返回的内容的额外信息，您甚至可以使用[namedtuple](https://docs.python.org/3/library/collections.html#namedtuple-factory-function-for-tuples-with-named-fields)（它不仅仅是一个字典，它是一对坐标）：

```
from collections import namedtuple 

Coordinates = namedtuple('Coordinates', ['lat', 'lng'])

def func():
    return Coordinates(lat=1, lng=2)

latitude = func().lat 
```

如果您的字典/元组中的对象紧密联系在一起，那么为它定义一个类可能是个好主意。这样，您还可以定义更复杂的操作。接下来的一个自然问题是：[我什么时候应该在 Python 中使用类？](https://stackoverflow.com/q/33072570/1720199)

最新版本的 python (≥ 3.7) 具有[数据类](https://docs.python.org/3/library/dataclasses.html)，您可以使用这些数据类来用很少的代码行定义类：

```
from dataclasses import dataclass

@dataclass
class Coordinates:
    lat: float = 0
    lng: float = 0

def func():
    return Coordinates(lat=1, lng=2)

latitude = func().lat 
```

与 namedtuple 相比，数据类的主要优势在于它更易于扩展，但还有[其他区别](https://stackoverflow.com/q/51671699/1720199)。请注意，默认情况下，数据类是可变的，但您可以使用`@dataclass(frozen=True)`而不是`@dataclass`强制它们是不可变的。

[这是一个视频](https://youtu.be/vCLetdhswMg)，可以帮助您为您的用例选择正确的数据类。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-10-13T14:46:36.503

如果这是一个你一直使用但总是丢弃第二个参数的函数，我认为在没有第二个返回值的情况下使用`lambda`.

```
def func():
    return 1, 2

func_ = lambda: func()[0] 

func_()  # Prints 1 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-11T17:44:24.773

这对我来说似乎是最好的选择：

```
val1, val2, ignored1, ignored2 = some_function() 
```

它既不神秘也不丑陋（如 func()[index] 方法），并且清楚地说明了您的目的。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-03-08T20:42:09.717

这不是问题的直接答案。相反，它回答了这个问题：“我如何从许多可能的选项中选择一个特定的函数输出？”。

如果您能够编写函数（即，它不在您无法修改的库中），则添加一个输入参数，表明您希望从函数中得到什么。使其成为具有默认值的命名参数，因此在“常见情况”中您甚至不必指定它。

```
 def fancy_function( arg1, arg2, return_type=1 ):
        ret_val = None
        if( 1 == return_type ):
            ret_val = arg1 + arg2
        elif( 2 == return_type ):
            ret_val = [ arg1, arg2, arg1 * arg2 ]
        else:
            ret_val = ( arg1, arg2, arg1 + arg2, arg1 * arg2 ) 
        return( ret_val ) 
```

此方法提供有关所需输出的“高级警告”功能。因此，它可以跳过不需要的处理，只做获得所需输出所需的工作。同样因为 Python 进行动态类型，所以返回类型可以改变。注意这个例子是如何返回一个标量、一个列表或一个元组......任何你喜欢的！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-10-18T20:37:48.107

当您从一个函数有许多输出并且您不想多次调用它时，我认为选择结果的最清晰方法是：

```
results = fct()
a,b = [results[i] for i in list_of_index] 
```

作为一个最小的工作示例，还演示了该函数仅被调用一次：

```
def fct(a):
    b=a*2
    c=a+2
    d=a+b
    e=b*2
    f=a*a
    print("fct called")
    return[a,b,c,d,e,f]

results=fct(3)
> fct called

x,y = [results[i] for i in [1,4]] 
```

并且值如预期：

```
results
> [3,6,5,9,12,9]
x
> 6
y
> 12 
```

为方便起见，也可以使用 Python 列表索引：

```
x,y = [results[i] for i in [0,-2]] 
```

返回：a = 3 和 b = 12

# .net - 最好的独立于数据库的 SQL DDL 实用程序？

> ID：431875
> 
> 赞同：4
> 
> 时间：2009-01-10T22:20:47.947
> 
> 标签：.net, sql, version-control, ddl

我正在为 .net 平台开发一个项目，并希望支持多种数据库类型。我想以通用格式将 DDL 置于源代码控制之下，然后将其转换为特定于数据库的 DDL 以进行部署。

因此，我正在寻找将通用 DDL 转换为特定于数据库的 DDL 的实用程序。理想情况下，它将支持 MSSQL 05/08、MySQL、Oracle、Postgres 和 DB2 开箱即用。

以下是我到目前为止找到的工具：

1.  [XML 到 DDL](http://xml2ddl.berlios.de/)
    *   没有对 MSSQL 的内置支持。
2.  [DdlUtils](http://db.apache.org/ddlutils/)
    *   没有命令行实用程序。必须从 java 或 ant 脚本调用。
3.  [ActiveRecord::迁移](http://api.rubyonrails.org/classes/ActiveRecord/Migration.html)
    *   不支持外键
    *   不确定如何与 .net 项目集成。

有没有人有我提到的或认识其他人的经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T23:00:08.647

NHibernate 的[SchemaExport 工具](http://hibernate.org/hib_docs/nhibernate/html/toolsetguide.html)可以为任何 NHibernate 支持的 DBMS 方言从 OR 映射生成适当的 DDL。但是，正如其他人所暗示的那样，如果您在该级别上工作，那么您实际上会受到 DBMS 之间相当薄的共同点的限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T22:47:35.613

我所知道的唯一支持 SQL Server 的是[SQLFairy](http://sqlfairy.sourceforge.net/)。它是用 Perl 编写的，功能非常丰富。XML2DDL 也相当不错，但如果它不支持您选择的 DBMS，它就不是真正可行的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T11:28:58.870

我已经在 Oracle、SQL Server 2005、MySQL 和 SQLite 上成功使用了[Ruby](http://www.ruby-lang.org/en/) / [Rails](http://rubyonrails.org/)的 ActiveRecord[迁移。](http://guides.rails.info/migrations.html)我想我可能也设法在 Access 上使用它，但这可能是一个错误的记忆。它还支持我所知道的 PostgreSQL 和 db2，无论是“开箱即用”还是通过额外下载。如果你想要更奇特的东西并且渴望一个真正自我鞭挞的 DIY 项目，你总是可以编写自己的适配器......

它工作得非常好，但您必须接受这是一个限制您访问特定平台功能的概念。不仅使用 AR，而且很可能使用任何不需要花费数十亿美元的跨平台工具：例如，如果您的目标平台不支持触发器，您会怎么做？还是存储过程？（例如 MySQL 4.0 或 SQLite）。任何跨平台系统都必须处理这样的问题（例如，在与尝试在 SQL Server 查询中应用 Oracle 外连接运算符的版本进行了一场灾难性的搏斗之后，我对 Crystal Reports 产生了终生的仇恨）。

如果您坚持使用表、索引和更简单的约束，我希望您可以使用各种各样的平台。有一个论点建议您通常应该在数据库之外寻找任何进一步处理的东西。我不会在这里更进一步 - 这是一个有点宗教性的辩论......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-29T16:52:54.203

我相信[Liquibase](http://www.liquibase.org)会做你想做的，并且还会随着时间的推移管理数据库的变化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-10T22:49:44.393

您的应用程序完全与数据库无关是必备功能吗？相信您需要投入这么多工作来支持这么多数据库，这似乎有些牵强。最重要的是，您的数据层将非常复杂，因为每个 RDBMS 中存在细微差别。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T23:35:56.517

您可能成功地获得了表及其关系的抽象表示 - 但是您如何处理视图、存储过程、触发器等？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-16T23:12:59.500

[DDLUtils](http://db.apache.org/ddlutils/)似乎是正确的选择。效果很好，即使这些天该项目并不真正活跃。

编码很好，我没有任何问题（在 MySQL、Oracle、H2DB 上工作......）。

确实现在没有内置命令行，但是您可以从命令行启动 ant 任务，或者编写自己的命令行包装器（这真的不那么难……我是在我身边做的，实际上）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-21T08:29:58.737

我已经用 DDLUtils 做了基本的实验。我尝试了 Mysql、MSSql 和 oracle，它工作正常。检查表创建、约束和索引。拒绝使用它，因为它不活跃，并且很长一段时间都打开了阻止程序错误。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-23T18:35:58.180

jOOQ 可以在方言之间翻译任意 SQL，而不仅仅是 DDL。可以在此处找到可能的在线版本：[https](https://www.jooq.org/translate) ://www.jooq.org/translate ，并且还提供[CLI 版本](https://www.jooq.org/doc/latest/manual/sql-building/sql-parser/sql-parser-cli/)。

免责声明：我为 jOOQ 背后的公司工作

# javascript - 链接的下拉列表和加载 div

> ID：431876
> 
> 赞同：3
> 
> 时间：2009-01-10T22:21:44.823
> 
> 标签：javascript, html, html-select

我在编程方面有点新手，但我正在努力学习。我需要为我的网站做的是有 2 或 3 个链接的下拉菜单，所以当我从第一个中选择一个项目时，第二个将用其他选项刷新。我已经找到了一种使用 Java 来做到这一点的方法，但我似乎无法通过刷新`div`部分来做到这一点。我抬头看`prototypejs`/`updater`但它有点过头了`head`，似乎无法将它与我用于下拉菜单的 JavaScript 链接起来......

因此，如果有人能告诉我如何链接两个，也许是 3 个下拉菜单，然后如果我单击最后一个菜单中的一个选项，请`div`从页面刷新其他内容，请帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T22:47:33.773

不是 100% 确定你在追求什么——但我认为这至少应该让你有所收获：

[http://remysharp.com/2007/09/18/auto-populate-multiple-select-boxes/](http://remysharp.com/2007/09/18/auto-populate-multiple-select-boxes/)

这是一个 jQuery 插件，用于将选择框链接在一起，使用 Ajax 加载数据以根据前一个选择的值填充链中的下一个框。

然后，您仍然需要将最后一个框与`div`- 但您应该能够自己使用类似的方法来完成 - 请参阅 jQuery Ajax 文档。

[http://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T15:40:01.360

尝试在谷歌上搜索动态选择框，它有很多例子，选择最适合您知识的不太复杂的一个。

原理是将函数链接到选择框在选择项目时触发的“onchange”事件。

假设这个选择框：

```
<select id="select1" name="option">
</select> 
```

javascript片段是：

```
var sel1 = document.getElementById("select1");
sel1.onchange = function() {
  //do whatever you want
}; 
```

对于第一个和第二个选择，该函数将加载其他选择的选项，而在第三种情况下，它将显示您的 div

# cocoa - 哪个 SCM 系统适用于 Xcode？

> ID：431881
> 
> 赞同：21
> 
> 时间：2009-01-10T22:27:35.017
> 
> 标签：cocoa, xcode, svn, macos, version-control

我正在为 Mac 开发一个应用程序作为一个小团队（我 + 另一个人）的努力。我们位于不同的城市，并且已经开始看到对可靠源代码控制管理的需求。

我们都没有这方面的经验，而且我们都对 Cocoa/Obj-C/Xcode 比较陌生（但确实有 C 知识）。

有人对选择哪个 SCM 系统有任何建议吗？我知道很多人都在使用 Subversion，Xcode 3.1 也支持它。有人有通过 Xcode 使用 Subversion 的经验吗？还是选择独立的 GUI 替代方案（例如版本）是更好的选择？

感谢您对此的任何意见。

格雷戈尔·托马塞维奇，瑞典

更新/个人经验：自从这篇文章以来，我们尝试了 Versions 和 Cornerstone（它们都是 SVN GUI 客户端），以及 Xcodes 对 SVN 的内置支持。我们对 Versions 不是特别满意，它在提交未版本化的文件/构建文件时似乎存在一些问题。Xcode 中内置的 SVN 支持运行良好，尽管它可能有一些我们还没有遇到的限制。Cornerstone 既简单易用又功能强大，而且似乎没有遇到我们在使用版本时遇到的问题。

到目前为止，我们刚刚尝试提交、更新 repo、检查文件的最新/以前版本，并进行了一些文件比较。一旦您开始广泛使用分支，这可能是一个完全不同的球游戏，我们被告知这两个 GUI 客户端可能在这个领域存在一些弱点。

对于它的价值（并且只需要几天的评估），Cornerstone 似乎是一个更好的选择，尽管对于更简单的 SCM，Xcode 也能很好地工作。

感谢所有的评论。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-11T01:01:15.470

Xcode 仅支持 Subversion、Perforce 和 CVS。但是，也有分布式版本控制系统，例如 Mercurial、Bazaar 和 Git。这些没有 Mac 原生 GUI，但您仍应考虑使用它们。就个人而言，我喜欢在 Mercurial 存储库中管理我的项目。

[添加于 2011-03-10] Xcode 4 增加了对 Git 的支持。我们中的一些人已经提出了 Mercurial 支持的请求；如果你愿意，你也应该这样做。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-07-02T13:07:29.297

Mac 上的 Mercurial 有一个不错的 GUI 前端，称为 MacHG：http: [//jasonfharris.com/machg/](http://jasonfharris.com/machg/)

它是免费的，非常好恕我直言。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-10T23:38:55.607

Xcode 的 Subversion 支持非常好。我执行的 90% 的 SVN 活动都可以通过 Xcode 轻松完成。对于其他几件事，我只是启动终端。

在他们的 SVN 客户端实现中有几件事很烦人：

*   检查以查看哪些本地文件已被修改的代码似乎在后台计时器上运行，并且它非常潜在。有时 Xcode 需要 5 分钟才能将文件显示为已修改。同样的事情是更加夸张的 w/r/t 远程修改。
*   有时，当您重命名或删除*不受*源代码控制的文件时，会出现一个对话框，询问“您是否也希望在 SVN 中[重命名/删除]此文件？” 选项是“是”或“取消”。您绝望地选择“是”只是为了得到一个当之无愧的 SVN 错误。

总的来说，我会推荐它。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-11T02:53:58.817

使用 Subversion 不会出错。

如果像我一样，您不太喜欢 Xcode 的 SVN 集成，您可以随时选择使用命令行工具，或几个 GUI 应用程序之一，如 Versions、CornerStone 或 SvnX。这些工具中的大多数都可以很好地协同工作，因此您不必依赖于您开始使用的工具。

我个人的大部分工作都是使用 Versions 完成的，并且每隔一段时间就使用具有相同工作副本的命令行工具。

如果在有人围绕它创建一个好的 GUI 应用程序之前，你习惯于只使用命令行工具，那么 git 也是一个非常可行的选择。

披露：我是从事版本工作的人之一，所以我可能有点偏见；）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-11T01:41:00.040

警告：如果你只是简单地告诉 XCode 将项目添加到存储库，通过给它顶级目录，它会将构建目录添加到存储库，这当然是一件糟糕的事情。

为了解决这个问题，您必须将构建目录移动到另一个位置，以便 XCode 不会尝试导入它，或者手动逐个添加项目的离散文件夹。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-11T01:02:54.797

Subversion 是传统的 OS X 源代码控制解决方案，在 Leopard 中，Xcode 和 OS X 都支持它，更不用说第三方 GUI 应用程序（其中一些看起来很漂亮）。尽管如此，许多独立的 OS X 开发人员在过去的一两年里已经转向了 Git。作为一个单一的开发者，我可以告诉你，Git 对我来说是一个非常好的解决方案，并且它与 Github 一起为小型团队工作提供了一个很好的解决方案。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-13T18:36:12.513

如果您对在 OS X 上使用 Mercurial 感兴趣，请尝试 SourceTree，它不是免费的，但价格具有竞争力，并且具有非常精致的 Mac OS 感觉。在过去的几个月里，我断断续续地将它用于个人项目，并发现它直观且相当强大。

它可通过 Mac App Store 获得，并支持 Git 和 Mercurial。他们有一个网站[http://www.sourcetreeapp.com/](http://www.sourcetreeapp.com/)提供更多信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-10T22:45:25.323

如果你想要颠覆，我听说过关于[Springloops](http://springloops.com/)的好消息。我也以类似的方式与一些朋友一起编写代码，我们使用[Github](http://github.com)。Git 是一个如此美妙的体验。我不使用任何 GUI，因为我使用 shell 提示时效率更高。当然，如果 Xcode 支持 Git 存储库，我会很高兴。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-13T16:27:18.630

Mercurial（如 git）是“分布式的”，可能被认为比 svn（但不太成熟）更现代、更新潮。如果要使用 mercurial 自动签入，可以添加以下行：

hg commit -m "Xcode 自动提交"

作为 XCode 构建的“运行脚本”阶段的一部分，可在以下位置找到：项目 > 新构建阶段 > 新运行脚本构建阶段

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-07-15T12:09:50.247

我使用：[https ://bitbucket.org/hsivank/xcode4-with-mercurial/wiki/Home](https://bitbucket.org/hsivank/xcode4-with-mercurial/wiki/Home)

# sql - 垂直到水平？

> ID：431882
> 
> 赞同：1
> 
> 时间：2009-01-10T22:29:39.160
> 
> 标签：sql, arrays, postgresql, rdbms

我有一个如下所示的 PostgreSQL 表：

```
A -> B
A -> C
A -> G
A -> H
B -> O
B -> K 
```

其中“->”分隔两列，第一列指向第二列（超链接）。现在我想在第一列中获取所有不同的值，并为它们分配一个 ARRAY，其中包含它们在第二列中指向的所有值，从而减少索引大小并帮助我更接近我希望到达的位置。

因此，我希望排列 [many] 行的单列结果集。如果我可以调用像`arrayify(SELECT column2 FROM table WHERE column1 = 'A'`) 这样的函数，那会让我的生活变得如此轻松。

任何人或任何人都知道吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T02:18:08.133

这取决于您使用的 PostgreSQL 版本。如果您使用的是最新版本（目前支持的任何版本），您可以使用`array_agg(col)`

例如：

```
select array_agg(test) from test;
                                       array_agg                                

--------------------------------------------------------------------------------
-------
 {4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,
32,33}
(1 row) 
```

如果您使用的是旧版本，您可能需要编写自己的 array_agg 聚合或类似工作。这是一种编写名为“as_array”的方法：

```
CREATE AGGREGATE as_array (
        BASETYPE = ANYELEMENT,
        STYPE = ANYARRAY,
        SFUNC = ARRAY_APPEND,
        INITCOND = '{}'
); 
```

# sql - 嵌套表的最佳查询语法？

> ID：431884
> 
> 赞同：1
> 
> 时间：2009-01-10T22:30:15.383
> 
> 标签：sql, mysql

我的表中有一个数字字段`category_id`。我想做这样的事情。

```
$ids=implode(',',$id_array);
$sql="SELECT * FROM myTbl WHERE IN(category_id,'$ids')"; 
```

应该输出如下内容：

```
SELECT * FROM myTbl WHERE IN(category_id,'1,2,3,4,5,6'); 
```

这可能吗？我是否为此使用了正确的语法？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T22:34:45.483

几乎，但不完全——这是它可以工作的一种方式

```
$ids="'".implode("','",$id_array)."'";
$sql="SELECT * FROM myTbl WHERE category_id IN($ids)"; 
```

应该输出如下内容：

```
SELECT * FROM myTbl WHERE category_id IN('1', '2', '3', '4', '5', '6'); 
```

请注意，由于该字段是数字，因此引号是不必要的，但它是一个有用的代码习惯用法，用于构建带引号的字符串列表。在您的情况下，您可以简化为

```
$ids=implode(',',$id_array); 
```

*（为了清楚起见，我假设数组不为空，数组元素经过消毒等！）*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T22:49:45.593

你从哪里得到 id 数组？如果它来自数据库，您应该考虑在那里进行所有操作：

```
SELECT * FROM myTbl WHERE c_id IN (SELECT c_id FROM yourTable WHERE ...); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T22:35:53.440

是的，mysql 的语法是这样的：

```
SELECT * FROM myTbl WHERE category_id IN(1,2,3,4,5,6); 
```

（因为值是整数，所以它们不需要引号。如果它们是字符串，它们每个都需要用自己的引号括起来 - category_id IN ('a', 'b')

# objective-c - 是否可以在 Obj-c 中为可变参数函数发送一个数组？

> ID：431910
> 
> 赞同：12
> 
> 时间：2009-01-10T22:51:19.180
> 
> 标签：objective-c

在 python 中，很容易构建字典或数组并将其解包传递给具有可变参数的函数

我有这个：

```
- (BOOL) executeUpdate:(NSString*)sql, ... { 
```

手动方式是这样的：

```
[db executeUpdate:@"insert into test (a, b, c, d, e) values (?, ?, ?, ?, ?)" ,
  @"hi'", // look!  I put in a ', and I'm not escaping it!
  [NSString stringWithFormat:@"number %d", i],
  [NSNumber numberWithInt:i],
  [NSDate date],
  [NSNumber numberWithFloat:2.2f]]; 
```

但我不能硬编码我正在调用的参数，我想要：

```
NSMutableArray *values = [NSMutableArray array];

for (NSString *fieldName in props) {
  ..
  ..
  [values addObject : value]
}
[db executeUpdate:@"insert into test (a, b, c, d, e) values (?, ?, ?, ?, ?)" ,??values]; 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-11-05T21:12:03.143

Chuck 是对的，Objective-C 中没有适当的参数解包。但是，对于需要 nil 终止 (NS_REQUIRES_NIL_TERMINATION) 的方法，您可以使用返回 nil when 的数组访问器将变量列表扩展得比所需的更大`index >= count`。这肯定是一个 hack，但它确实有效。

```
// Return nil when __INDEX__ is beyond the bounds of the array
#define NSArrayObjectMaybeNil(__ARRAY__, __INDEX__) ((__INDEX__ >= [__ARRAY__ count]) ? nil : [__ARRAY__ objectAtIndex:__INDEX__])

// Manually expand an array into an argument list
#define NSArrayToVariableArgumentsList(__ARRAYNAME__)\
NSArrayObjectMaybeNil(__ARRAYNAME__, 0),\
NSArrayObjectMaybeNil(__ARRAYNAME__, 1),\
NSArrayObjectMaybeNil(__ARRAYNAME__, 2),\
NSArrayObjectMaybeNil(__ARRAYNAME__, 3),\
NSArrayObjectMaybeNil(__ARRAYNAME__, 4),\
NSArrayObjectMaybeNil(__ARRAYNAME__, 5),\
NSArrayObjectMaybeNil(__ARRAYNAME__, 6),\
NSArrayObjectMaybeNil(__ARRAYNAME__, 7),\
NSArrayObjectMaybeNil(__ARRAYNAME__, 8),\
NSArrayObjectMaybeNil(__ARRAYNAME__, 9),\
nil 
```

现在，您可以`NSArrayToVariableArgumentsList`在任何期望以零结尾的变量参数列表的地方使用（只要您的数组小于 10 个元素）。例如：

```
NSArray *otherButtonTitles = @[@"button1", @"button2", @"button3"];
UIActionSheet *actionSheet = [[self alloc] initWithTitle:@"Title"
                                                delegate:self
                                       cancelButtonTitle:@"Cancel"
                                  destructiveButtonTitle:nil
                                       otherButtonTitles:NSArrayToVariableArgumentsList(otherButtonTitles)]; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-10T23:35:52.460

很不幸的是，不行。Objective-C 不像许多现代语言那样具有参数解包功能。我什至没有找到解决它的好方法。

部分问题在于，Objective-C 本质上只是 C。它使用 C 可变参数传递多个参数，并且没有简单的方法可以使用可变参数来做到这一点。[一个相关的 SO 讨论](https://stackoverflow.com/questions/280940/calling-a-c-function-with-a-varargs-argument-dynamically)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-16T07:03:09.077

我想做同样的事情。考虑到对输入变量的一些限制，我想出了以下方法，效果很好。

```
NSArray* VarArgs(va_list ap)
{
  id obj;
  NSMutableArray* array = [NSMutableArray array];

  while ((obj = va_arg(ap, id))) {
    [array addObject:obj];
  }
  return array;
}

#define VarArgs2(_last_) ({ \
  va_list ap; \
  va_start(ap, _last_); \
  NSArray* __args = VarArgs(ap); \
  va_end(ap); \
  if (([__args count] == 1) && ([[__args objectAtIndex:0] isKindOfClass:[NSArray class]])) { \
    __args = [__args objectAtIndex:0]; \
  } \
__args; }) 
```

使用上述内容，我可以使用 NSArray 或 varargs 调用以下内容。

```
// '...' must be objc objects with nil sentinel OR an NSArray with nil sentinel
- (void)someMethod:(NSString *)sql, ...
{
   NSArray *args = VarArgs2(sql);

   // Do stuff with args
} 
```

另一个技巧是在原型中使用以下内容让编译器检查 nil 标记以避免潜在的坏事。我从苹果标题中得到了这个......

```
- (void)someMethod:(NSString *)sql, ... NS_REQUIRES_NIL_TERMINATION; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-10T23:42:12.463

这里有一个很好的例子，你可以如何从 NSArray 转到 va_list（参见底部的“va_list in Cocoa”和“Creating a fake va_list”部分）：

[http://cocoawithlove.com/2009/05/variable-argument-lists-in-cocoa.html](http://cocoawithlove.com/2009/05/variable-argument-lists-in-cocoa.html)

这是一个预告片（“参数”是 NSArray）：

```
char *argList = (char *)malloc(sizeof(NSString *) * [arguments count]);
[arguments getObjects:(id *)argList];
contents = [[NSString alloc] initWithFormat:formatString arguments:argList];
free(argList); 
```

不完全是python或ruby，但是嘿......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-07-20T08:35:49.287

您应该使用新的 FMDB 版本[http://github.com/ccgus/fmdb](http://github.com/ccgus/fmdb)。它有你需要的方法：

```
- (BOOL) executeUpdate:(NSString*)sql withArgumentsInArray:(NSArray *)arguments; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-10T23:28:07.593

要完成你想要的，你必须使用“varargs”，就像你的方法使用的那样，或者你可以传入一个值数组，比如`[db executeUpdate:sql withValues:vals];`，然后拉出方法中的值。但是没有办法做一些更“Pythonic”的事情，比如自动解包一个值的元组，á la `def executeUpdate(sql, *args)`。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-10T23:30:00.507

不幸的是，(Objective-)C 没有提供这样做的方法。在这种情况下，executeUpdate 方法需要接受 NSArray 而不是变量参数列表。

但是，如果您确实知道数组中的条目数量（无论如何，您在示例中的字符串中有数量），您当然可以执行类似的操作

```
[db executeUpdate:@"insert into test (a, b) values (?, ?)", [values objectAtIndex:0], [values objectAtIndex:1]] 
```

如果 executeUpdate 是一个外部库方法并且该库不提供接受 NSArray 的方法版本，您可以提出自己的包装函数。该函数将查询字符串和一个数组作为参数。然后，此函数将根据数组的长度使用正确数量的参数调用 executeUpdate 方法，类似于

```
if ([values count] == 1) {
  [db executeUpdate:query, [values objectAtIndex:0]];
}
else if ([values count] == 2) {
  [db executeUpdate:query, [values objectAtIndex:0], [values objectAtIndex:1]];
} 
```

然后你可以把这个新函数称为

```
executeUpdateWrapper(@"insert into test (a, b) values (?, ?)", values); 
```

此解决方案的明显缺点是您需要在函数中单独处理数组的所有可能长度，并且它有很多复制粘贴代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-16T07:58:53.810

除了robottobor的解决方案：如果您添加以下宏：

```
#define splitAlternatingArray(args,arg1,arg2) \
NSMutableArray *arg1 = [NSMutableArray array];\
NSMutableArray *arg2 = [NSMutableArray array];\
{\
  BOOL isFirst = YES;\
  for (id arg in args) {\
    if (isFirst) {\
        [arg1 addObject:arg];\
    } else {\
        [arg2 addObject:arg];\
    }\
    isFirst = !isFirst;\
  }\
} 
```

然后你可以做一些棘手的事情，比如：

```
- (id)initWithObjectsAndKeys:(id)firstObject, ...{
    NSArray *objKeyArray = VarArgs2(firstObject);
    splitAlternatingArray(objKeyArray,objs,keys);
    return [self initWithObjects:objs forKeys:keys];
} 
```

# namespaces - 命名空间经验法则

> ID：431911
> 
> 赞同：6
> 
> 时间：2009-01-10T22:52:37.023
> 
> 标签：namespaces, organization

在将项目进一步分类到新的命名空间之前，是否有关于有多少类、接口等应该进入给定命名空间的一般经验法则？喜欢最佳实践或社区偏好？还是这都是个人喜好？

```
namespace: MyExample.Namespace
 interface1
 interface2
 interface3
 interface4
 interface5
 interface6
 interface7
 interface8
 interface9 
```

或者

```
namespace: MyExample.Namespace.Group1
 interface1
 interface2
 interface3
namespace: MyExample.Namespace.Group2
 interface4
 interface5
 interface6
namespace: MyExample.Namespace.Group3
 interface7
 interface8
 interface9 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-10T23:21:08.840

我没有在任何可靠来源看到任何经验法则，但在与大多数开发人员合作时，我看到了一些常见的偏好。有一些东西可以帮助您创建命名空间。

1.  类域
2.  它是一个类还是一个接口（我看到一些开发人员更喜欢 ShopApp.Model.Interfaces 之类的命名空间）。如果您的接口是某种服务或数据合同，则效果非常好。
3.  不要有太深的命名空间，3 (.) 就足够了。不仅如此，可能会令人讨厌。
4.  如果您在任何时候觉得它变得不合逻辑或难以管理，请愿意重新组织命名空间。
5.  不要仅仅为了它而创建名称空间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-10T23:15:15.433

如果构建库或模块，通常最好只使用一个命名空间，因为命名空间的主要功能是避免名称冲突，并且您可以控制将哪些名称分配给类和接口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-10T23:07:32.330

我不知道关于项目数量的任何经验法则，但无论如何，这些规则往往是过度概括的垃圾。确保同一命名空间中的项目之间存在逻辑连接。如果命名空间变得过于拥挤（我希望不太可能），或者命名空间中的事物充其量只是松散相关，请考虑将其分解为多个命名空间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T23:28:59.307

我认为命名空间层次结构应该只由设计考虑和模型/API 的层次结构来管理。

如果一个命名空间包含大量不相关的类，请重新考虑您的设计。

与 Andrew 所说的相反，我*不会*担心名称空间包含很少的类——当然，层次结构应该只根据需要细粒度来表达设计。

另一方面，我发现命名空间只包含一个高度特殊的类，或者可能只包含非常小的一组类型是完全合理的，其中一个编码任务，其他提供 API（异常，参数枚举...... ）。

`System.Text.RegularExpressions`以（在 .NET 中）为例。当然，略多于一堂课，但仅此而已。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-10T23:04:33.240

在命名空间中包含少量类通常被认为是不好的形式。我一直将此归因于许多命名空间会导致混淆的事实。

我建议您将类分解为尽可能合理和实用的逻辑名称空间。但是，如果您最终每个命名空间只有一两个类，那么您可能会分崩离析，应该考虑整合。

# php - 在PHP中获取数组中所有字母字符的方法？

> ID：431912
> 
> 赞同：193
> 
> 时间：2009-01-10T22:52:38.117
> 
> 标签：php

有没有办法在 PHP 中的数组中获取所有字母字符（AZ），以便我可以遍历它们并显示它们？

* * *

## 回答 #1

> 赞同：533
> 
> 时间：2009-01-10T23:05:34.253

```
$alphas = range('A', 'Z'); 
```

文档：[https ://www.php.net/manual/en/function.range.php](https://www.php.net/manual/en/function.range.php)

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-01-11T16:04:39.313

要同时获得大写和小写合并两个范围：

```
$alphas = array_merge(range('A', 'Z'), range('a', 'z')); 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-01-10T22:59:44.013

```
$alphabet = array('A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'); 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-11T16:17:10.567

其他方式：

```
$c = 'A';
$chars = array($c);
while ($c < 'Z') $chars[] = ++$c; 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-10-08T07:59:02.147

PHP 已经为此类应用程序提供了功能。
`chr(x)`返回整数索引为 x 的 ascii 字符。
在某些情况下，这种方法应该被证明是最直观的。
参考[http://www.asciitable.com/](http://www.asciitable.com/)

```
$UPPERCASE_LETTERS = range(chr(65),chr(90));
$LOWERCASE_LETTERS = range(chr(97),chr(122));
$NUMBERS_ZERO_THROUGH_NINE = range(chr(48),chr(57));

$ALPHA_NUMERIC_CHARS = array_merge($UPPERCASE_LETTERS, $LOWERCASE_LETTERS, $NUMBERS_ZERO_THROUGH_NINE); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-10T23:05:23.287

```
<?php 

$array = Array();
for( $i = 65; $i < 91; $i++){
        $array[] = chr($i);
}

foreach( $array as $k => $v){
        echo "$k $v \n";
}

?>

$ php loop.php 
0 A 
1 B 
2 C 
3 D 
4 E 
5 F 
6 G 
7 H
... 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-07-24T14:12:07.573

AZ 的范围，但如果你想从 A 到 DU，那么：

```
 function generateAlphabet($na) {
        $sa = "";
        while ($na >= 0) {
            $sa = chr($na % 26 + 65) . $sa;
            $na = floor($na / 26) - 1;
        }
        return $sa;
    }

    $alphabet = Array();
    for ($na = 0; $na < 125; $na++) {
        $alphabet[]=generateAlphabet($na);
    }

    print_r($alphabet); 
```

您的答案将如下所示：

```
Array ( [0] => A [1] => B [2] => C [3] => D [4] => E [5] => F [6] => G [7] => H [8] => I [9] => J [10] => K [11] => L [12] => M [13] => N [14] => O [15] => P [16] => Q [17] => R [18] => S [19] => T [20] => U [21] => V [22] => W [23] => X [24] => Y [25] => Z [26] => AA [27] => AB [28] => AC [29] => AD [30] => AE [31] => AF [32] => AG [33] => AH [34] => AI [35] => AJ [36] => AK [37] => AL [38] => AM [39] => AN [40] => AO [41] => AP [42] => AQ [43] => AR [44] => AS [45] => AT [46] => AU [47] => AV [48] => AW [49] => AX [50] => AY [51] => AZ [52] => BA [53] => BB [54] => BC [55] => BD [56] => BE [57] => BF [58] => BG [59] => BH [60] => BI [61] => BJ [62] => BK [63] => BL [64] => BM [65] => BN [66] => BO [67] => BP [68] => BQ [69] => BR [70] => BS [71] => BT [72] => BU [73] => BV [74] => BW [75] => BX [76] => BY [77] => BZ [78] => CA [79] => CB [80] => CC [81] => CD [82] => CE [83] => CF [84] => CG [85] => CH [86] => CI [87] => CJ [88] => CK [89] => CL [90] => CM [91] => CN [92] => CO [93] => CP [94] => CQ [95] => CR [96] => CS [97] => CT [98] => CU [99] => CV [100] => CW [101] => CX [102] => CY [103] => CZ [104] => DA [105] => DB [106] => DC [107] => DD [108] => DE [109] => DF [110] => DG [111] => DH [112] => DI [113] => DJ [114] => DK [115] => DL [116] => DM [117] => DN [118] => DO [119] => DP [120] => DQ [121] => DR [122] => DS [123] => DT [124] => DU ) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-10T23:19:58.390

```
$array = range('a', 'z'); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-11-20T00:29:14.813

如果您需要一个包含字母键和元素的数组（例如，对于字母下拉列表），您可以这样做：

```
$alphas = array_combine(range('A','Z'),range('A','Z')) 
```

产量：

```
array (size=26)
  'A' => string 'A' (length=1)
  'B' => string 'B' (length=1)
  'C' => string 'C' (length=1)
  'D' => string 'D' (length=1)
  ...etc 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-01-07T05:32:45.310

所有好的答案，如果有人正在寻找一系列小写和大写字母，这里是：

```
$alpha = array('A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-11-10T03:52:31.487

也许这有点离题（仅针对 AZ 的主题启动器要求解决方案），但对于西里尔字符的解决方案是：

```
// to place letters into the array
$alphas = array();
foreach (range(chr(0xC0), chr(0xDF)) as $b) {
    $alphas[] = iconv('CP1251', 'UTF-8', $b);
}    

// or conver array into comma-separated string
$alphas = array_reduce($alphas, function($p, $n) {
  return $p . '\'' . $n . '\',';
});
$alphas = rtrim($alphas, ',');

// echo string for testing
echo $alphas;
// or echo mb_strtolower($alphas); for lowercase letters 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-08-09T07:25:46.353

```
$alphabets = range('A', 'Z');
    $doubleAlphabets = array();
    $count = 0;
    foreach($alphabets as $key => $alphabet)
    {
        $count++;
        $letter = $alphabet;
        while ($letter <= 'Z') 
        {
            $doubleAlphabets[] = $letter;

            ++$letter;
        }
    }

    return $doubleAlphabets; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-05-20T09:59:09.620

试试这个 ：

```
function missingCharacter($list) {

        // Create an array with a range from array minimum to maximu
        $newArray = range(min($list), max($list));

        // Find those elements that are present in the $newArray but not in given $list
        return array_diff($newArray, $list);
    }
print_r(missCharacter(array('a','b','d','g'))); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-01-29T13:49:42.420

为了做出贡献，昨天，PEZ 在这篇文章中的回答[https://stackoverflow.com/a/431930/9710921](https://stackoverflow.com/a/431930/9710921)帮助我创建了一个数组来管理用于数据导出的**Excel 列**，如下所示：

```
public static function makeAlphas() : array {
    $alphas = $cells = range('A', 'Z');
    foreach($alphas as $alpha) {
        foreach($alphas as $beta) {
            $cells[] = $alpha.$beta;
        }
    }
    return $cells;
}

// Output
// array:702 ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z" "AA", "AB", "AC", "AD", "AE", "AF", "AG", "AH", "AI", "AJ", "AK", "AL", "AM", "AN", "AO", "AP", "AQ", "AR", "AS", "AT", "AU", "AV", "AW", "AX", "AY", "AZ", "BA", "BB", "BC", "BD", "BE", "BF", "BG", "BH", "BI", "BJ", "BK", "BL", "BM", "BN", "BO", "BP", "BQ", "BR", "BS", "BT", "BU", "BV", "BW", "BX", "BY", "BZ", "CA", "CB", "CC", "CD", "CE", "CF", "CG", "CH", "CI", "CJ", "CK", "CL", "CM", "CN", "CO", "CP", "CQ", "CR", "CS", "CT", "CU", "CV", "CW", "CX", "CY", "CZ", "DA", "DB", "DC", "DD", "DE", "DF", "DG", "DH", "DI", "DJ", "DK", "DL", "DM", "DN", "DO", "DP", "DQ", "DR", "DS", "DT", "DU", "DV", "DW", "DX", "DY", "DZ", "EA", "EB", "EC", "ED", "EE", "EF", "EG", "EH", "EI", "EJ", "EK", "EL", "EM", "EN", "EO", "EP", "EQ", "ER", "ES", "ET", "EU", "EV", "EW", "EX", "EY", "EZ", "FA", "FB", "FC", "FD", "FE", "FF", "FG", "FH", "FI", "FJ", "FK", "FL", "FM", "FN", "FO", "FP", "FQ", "FR", "FS", "FT", "FU", "FV", "FW", "FX", "FY", "FZ", "GA", "GB", "GC", "GD", "GE", "GF", "GG", "GH", "GI", "GJ", "GK", "GL", "GM", "GN", "GO", "GP", "GQ", "GR", "GS", "GT", "GU", "GV", "GW", "GX", "GY", "GZ", "HA", "HB", "HC", "HD", "HE", "HF", "HG", "HH", "HI", "HJ", "HK", "HL", "HM", "HN", "HO", "HP", "HQ", "HR", "HS", "HT", "HU", "HV", "HW", "HX", "HY", "HZ", "IA", "IB", "IC", "ID", "IE", "IF", "IG", "IH", "II", "IJ", "IK", "IL", "IM", "IN", "IO", "IP", "IQ", "IR", "IS", "IT", "IU", "IV", "IW", "IX", "IY", "IZ", "JA", "JB", "JC", "JD", "JE", "JF", "JG", "JH", "JI", "JJ", "JK", "JL", "JM", "JN", "JO", "JP", "JQ", "JR", "JS", "JT", "JU", "JV", "JW", "JX", "JY", "JZ", "KA", "KB", "KC", "KD", "KE", "KF", "KG", "KH", "KI", "KJ", "KK", "KL", "KM", "KN", "KO", "KP", "KQ", "KR", "KS", "KT", "KU", "KV", "KW", "KX", "KY", "KZ", "LA", "LB", "LC", "LD", "LE", "LF", "LG", "LH", "LI", "LJ", "LK", "LL", "LM", "LN", "LO", "LP", "LQ", "LR", "LS", "LT", "LU", "LV", "LW", "LX", "LY", "LZ", "MA", "MB", "MC", "MD", "ME", "MF", "MG", "MH", "MI", "MJ", "MK", "ML", "MM", "MN", "MO", "MP", "MQ", "MR", "MS", "MT", "MU", "MV", "MW", "MX", "MY", "MZ", "NA", "NB", "NC", "ND", "NE", "NF", "NG", "NH", "NI", "NJ", "NK", "NL", "NM", "NN", "NO", "NP", "NQ", "NR", "NS", "NT", "NU", "NV", "NW", "NX", "NY", "NZ", "OA", "OB", "OC", "OD", "OE", "OF", "OG", "OH", "OI", "OJ", "OK", "OL", "OM", "ON", "OO", "OP", "OQ", "OR", "OS", "OT", "OU", "OV", "OW", "OX", "OY", "OZ", "PA", "PB", "PC", "PD", "PE", "PF", "PG", "PH", "PI", "PJ", "PK", "PL", "PM", "PN", "PO", "PP", "PQ", "PR", "PS", "PT", "PU", "PV", "PW", "PX", "PY", "PZ", "QA", "QB", "QC", "QD", "QE", "QF", "QG", "QH", "QI", "QJ", "QK", "QL", "QM", "QN", "QO", "QP", "QQ", "QR", "QS", "QT", "QU", "QV", "QW", "QX", "QY", "QZ", "RA", "RB", "RC", "RD", "RE", "RF", "RG", "RH", "RI", "RJ", "RK", "RL", "RM", "RN", "RO", "RP", "RQ", "RR", "RS", "RT", "RU", "RV", "RW", "RX", "RY", "RZ", "SA", "SB", "SC", "SD", "SE", "SF", "SG", "SH", "SI", "SJ", "SK", "SL", "SM", "SN", "SO", "SP", "SQ", "SR", "SS", "ST", "SU", "SV", "SW", "SX", "SY", "SZ", "TA", "TB", "TC", "TD", "TE", "TF", "TG", "TH", "TI", "TJ", "TK", "TL", "TM", "TN", "TO", "TP", "TQ", "TR", "TS", "TT", "TU", "TV", "TW", "TX", "TY", "TZ", "UA", "UB", "UC", "UD", "UE", "UF", "UG", "UH", "UI", "UJ", "UK", "UL", "UM", "UN", "UO", "UP", "UQ", "UR", "US", "UT", "UU", "UV", "UW", "UX", "UY", "UZ", "VA", "VB", "VC", "VD", "VE", "VF", "VG", "VH", "VI", "VJ", "VK", "VL", "VM", "VN", "VO", "VP", "VQ", "VR", "VS", "VT", "VU", "VV", "VW", "VX", "VY", "VZ", "WA", "WB", "WC", "WD", "WE", "WF", "WG", "WH", "WI", "WJ", "WK", "WL", "WM", "WN", "WO", "WP", "WQ", "WR", "WS", "WT", "WU", "WV", "WW", "WX", "WY", "WZ", "XA", "XB", "XC", "XD", "XE", "XF", "XG", "XH", "XI", "XJ", "XK", "XL", "XM", "XN", "XO", "XP", "XQ", "XR", "XS", "XT", "XU", "XV", "XW", "XX", "XY", "XZ", "YA", "YB", "YC", "YD", "YE", "YF", "YG", "YH", "YI", "YJ", "YK", "YL", "YM", "YN", "YO", "YP", "YQ", "YR", "YS", "YT", "YU", "YV", "YW", "YX", "YY", "YZ", "ZA", "ZB", "ZC", "ZD", "ZE", "ZF", "ZG", "ZH", "ZI", "ZJ", "ZK", "ZL", "ZM", "ZN", "ZO", "ZP", "ZQ", "ZR", "ZS", "ZT", "ZU", "ZV", "ZW", "ZX", "ZY", "ZZ",]; 
```

谢谢佩兹！

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2017-06-06T12:27:58.030

小写字母

```
for ($x = 97; $x < 122; $x++) {
    $y = chr($x);
    echo $y;
    echo "<br>";
} 
```

大写字母

```
for ($x = 65; $x < 90; $x++) {
    $y = chr($x);
    echo $y;
    echo "<br>";
} 
```

# sql - 如何导入大型 MS SQL .sql 文件？

> ID：431913
> 
> 赞同：266
> 
> 时间：2009-01-10T22:53:24.683
> 
> 标签：sql, sql-server, import

我使用 RedGate SQL 数据比较并生成了一个 .sql 文件，所以我可以在本地机器上运行它。但问题是文件超过 300mb，这意味着我无法复制和粘贴，因为剪贴板无法处理它，当我尝试在 SQL Server Management Studio 中打开文件时出现错误关于文件太大。

有没有办法运行一个大的 .sql 文件？该文件基本上包含两个新表的数据。

* * *

## 回答 #1

> 赞同：491
> 
> 时间：2009-01-10T22:56:07.610

从命令提示符启动`sqlcmd`：

```
sqlcmd -S <server> -i C:\<your file here>.sql 
```

只需替换`<server>`为 SQL 框的位置和`<your file here>`脚本的名称。不要忘记，如果您使用的是 SQL 实例，则语法是：

```
sqlcmd -S <server>\instance. 
```

以下是您可以传递 sqlcmd 的所有参数的列表：

```
Sqlcmd            [-U login id]          [-P password]
  [-S server]            [-H hostname]          [-E trusted connection]
  [-d use database name] [-l login timeout]     [-t query timeout] 
  [-h headers]           [-s colseparator]      [-w screen width]
  [-a packetsize]        [-e echo input]        [-I Enable Quoted Identifiers]
  [-c cmdend]            [-L[c] list servers[clean output]]
  [-q "cmdline query"]   [-Q "cmdline query" and exit] 
  [-m errorlevel]        [-V severitylevel]     [-W remove trailing spaces]
  [-u unicode output]    [-r[0|1] msgs to stderr]
  [-i inputfile]         [-o outputfile]        [-z new password]
  [-f  | i:[,o:]] [-Z new password and exit] 
  [-k[1|2] remove[replace] control characters]
  [-y variable length type display width]
  [-Y fixed length type display width]
  [-p[1] print statistics[colon format]]
  [-R use client regional setting]
  [-b On error batch abort]
  [-v var = "value"...]  [-A dedicated admin connection]
  [-X[1] disable commands, startup script, environment variables [and exit]]
  [-x disable variable substitution]
  [-? show syntax summary] 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2013-03-14T08:40:22.797

我遇到了完全相同的问题并且已经挣扎了一段时间然后终于找到了将`-a`参数设置`sqlcmd`为以更改其默认数据包大小的解决方案：

```
sqlcmd -S [servername] -d [databasename] -i [scriptfilename] -a 32767 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-08-25T09:25:31.927

您也可以使用此工具。它真的很有用。

[BigSqlRunner](https://github.com/kevinly1989/BigSqlRunner)

注意：链接断开，因此已更新。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2016-06-03T09:43:14.397

1.  以管理员权限获取命令提示符

2.  将目录更改为 .sql 文件的存储位置

3.  执行以下命令

    `sqlcmd -S 'your server name' -U 'user name of server' -P 'password of server' -d 'db name'-i script.sql`

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-04-06T07:17:42.607

我正在使用 MSSQL Express 2014，但没有一个解决方案适合我。他们都只是崩溃了SQL。因为我只需要**运行一个包含许多简单插入语句的一次性脚本**，所以我通过编写一个小控制台应用程序作为最后的手段来解决它：

```
class Program
{
    static void Main(string[] args)
    {
        RunScript();
    }

    private static void RunScript()
    {
        My_DataEntities db = new My_DataEntities();

        string line;

        System.IO.StreamReader file =
           new System.IO.StreamReader("c:\\ukpostcodesmssql.sql");
        while ((line = file.ReadLine()) != null)
        {
            db.Database.ExecuteSqlCommand(line);
        }

        file.Close();
    }
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-10T22:55:55.410

使用 osql 在命令行运行它，请参见此处：

[http://metrix.fcny.org/wiki/display/dev/How+to+execute+a+.SQL+script+using+OSQL](http://metrix.fcny.org/wiki/display/dev/How+to+execute+a+.SQL+script+using+OSQL)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-08-18T16:35:02.567

**希望这对你有帮助！**

```
sqlcmd -u UserName -s <ServerName\InstanceName> -i U:\<Path>\script.sql 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-03-07T22:27:31.193

我有类似的问题。我的带有 sql 脚本的文件大小超过 150MB（几乎 900k 的非常简单的*INSERT* s）。我使用了 Takuro 建议的解决方案（作为这个问题的答案），但我仍然收到错误消息，提示内存不足（“资源池'内部'中的系统内存不足，无法运行此查询”）。

对我有帮助的是，我在每 50k *INSERT之后放置了***GO**命令。

 *（它不是直接解决问题（文件大小），但我相信它解决了与大尺寸 sql 脚本本身间接相关的问题。在我的情况下，许多插入命令）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-10T23:19:39.077

[你的问题和这个](https://stackoverflow.com/questions/243583/easiest-way-to-copy-an-entire-sql-server-database-from-a-server-to-local-sql-expr)很相似

您可以将文件/脚本保存为 .txt 或 .sql 并从 Sql Server Management Studio 运行它（我认为菜单是 Open/Query，然后只需在 SSMS 界面中运行查询）。您可能必须更新第一行，指示要在本地计算机上创建或选择的数据库。

如果您必须经常进行此数据传输，则可以进行复制。根据您的需要，快照复制可能没问题。如果您必须在两台服务器之间同步数据，则可以采用更复杂的模型，例如合并复制。

编辑：我没有注意到与文件大小相关的 SSMS 存在问题。然后您可以按照其他人的建议使用命令行，快照复制（在主服务器上发布，在本地服务器上订阅，复制，然后取消订阅）甚至备份/恢复

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-11T00:18:49.783

> 该文件基本上包含两个新表的数据。

然后，如果两台服务器位于同一网络上，您可能会发现仅 DTS（或 SSIS，如果这是 SQL Server 2005+）数据更简单。

如果两台服务器不在同一个网络上，您可以备份源数据库并将其还原到目标服务器上的新数据库。然后，您可以使用 DTS/SSIS，甚至是简单的`INSERT INTO SELECT`，将这两个表传输到目标数据库。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-10-10T18:26:24.577

==> sqlcmd -S [服务器名] -d [数据库名] -i [脚本文件名] -a 32767

我已经用 365mb 的 sql 文件成功完成了这个命令。此语法运行大约 15 分钟。它帮助我解决了一个我花了很长时间才弄清楚的问题

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2022-02-15T06:41:59.017

**运行脚本文件**

打开命令提示符窗口。

在命令提示符窗口中，键入：`sqlcmd -S <ServerName\InstanceName> -i C:\yourScript.sql`

按 ENTER。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-28T14:05:18.420

对于所有仍然遇到导入非常大的 SQL 转储问题的人来说，可能还有另一种方法。

可能时还应考虑的事项：如果您可以访问服务器，则可以将数据库导出为多个部分，例如首先是结构，然后是每个表（或相关对象）以较小的部分导出数据，而不是一个大文件.

当您无权访问服务器和/或需要使用现有的大文件时，您可以尝试使用 SQLDumpSplitter 将它们拆分为多个部分：[https](https://philiplb.de/sqldumpsplitter3/) ://philiplb.de/sqldumpsplitter3/ 。

然后导入这些片段以获得数据库的完整副本。

祝大家好运。

# capistrano - Capistrano 在向 Ubuntu 框提示输入 SUDO 密码时挂起

> ID：431925
> 
> 赞同：18
> 
> 时间：2009-01-10T23:03:05.380
> 
> 标签：capistrano, sudo

我有一个 capistrano 部署配方，我已经使用了一段时间来部署我的 web 应用程序，然后使用 sudo 命令重新启动 apache/nginx。最近，当我尝试执行这些 sudo 命令时，cap deploy 挂起。我看到输出：“[sudo] password for” 带有我的服务器名称和远程登录，但这不是安全登录提示。cap shell 只是挂起等待更多输出，不允许我输入密码来完成远程 sudo 命令。

有没有办法解决这个问题或体面的工作？我不想删除远程用户对 web 重启命令的 sudo 密码提示。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-11T00:32:18.023

这似乎在连接到 CentOS 机器时也会发生。在 capistrano 部署文件中添加以下行：

```
default_run_options[:pty] = true 
```

还要确保使用`sudo`帮助程序而不是`sudo`直接在运行命令中执行。例如：

```
# not
run "sudo chown root:root /etc/my.cnf"

# but
sudo "chown root:root /etc/my.cnf" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T15:18:18.530

其他建议可能是合理的，但我发现一旦我更新到 Capistrano 2.5.3，问题就消失了。我必须确保我停止运行我的操作系统附带的默认版本的工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-19T10:31:33.087

```
# prevent sudo prompting for password
set :sudo_prompt, "" 
```

# wpf - How to set default WPF Window Style in app.xaml?

> ID：431940
> 
> 赞同：65
> 
> 时间：2009-01-10T23:11:22.290
> 
> 标签：wpf, c#-3.0, themes, styles

I am trying to set the default Style for every window in my WPF Windows application in my app.xaml. So far i have this in app.xaml:

```
<Application.Resources>
    <ResourceDictionary>
        <Style x:Key="WindowStyle" TargetType="{x:Type Window}">
            <Setter Property="Background" Value="Blue" />
        </Style>
    </ResourceDictionary>
</Application.Resources> 
```

I can get the window to appear with this style when running the app (but not in VS designer) by specifically telling the window to use this style via:

```
Style="{DynamicResource WindowStyle} 
```

This works, but is not ideal. So how do I:

1.  Have all windows automatically use the style (so i don't have to specify it on every window)?
2.  Have VS designer show the style?

Thanks!

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-20T10:34:40.133

补充一下Ray所说的：

对于样式，您需要提供 Key/ID 或指定 TargetType。

> 如果 FrameworkElement 没有明确指定的样式，它将始终使用自己的类型作为键来查找样式资源
> - Programming WPF (Sells, Griffith)

如果您提供 TargetType，则该类型的所有实例都将应用该样式。但是派生类型不会......似乎。`<Style TargetType="{x:Type Window}">`不适用于您的所有自定义派生/窗口。`<Style TargetType="{x:Type local:MyWindow}">`将仅适用于 MyWindow。所以选项是

*   使用您指定为要应用该样式的**每个**窗口的 Style 属性的键控样式。设计器将显示样式化的窗口。

.

```
 <Application.Resources>
        <Style x:Key="MyWindowStyle">
            <Setter Property="Control.Background" Value="PaleGreen"/>
            <Setter Property="Window.Title" Value="Styled Window"/>
        </Style>
    </Application.Resources> ...
    <Window x:Class="MyNS.MyWindow" Style="{StaticResource MyWindowStyleKey}">  ... 
```

*   或者您可以从自定义 BaseWindow 类（它有[自己的怪癖](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/c45910f8-3619-4834-992a-19a0f042340e/)）派生，您可以在 Ctor/Initialization/Load 阶段设置 Style 属性一次。然后所有派生将自动应用该样式。**但是设计器不会注意到您的样式**您需要运行您的应用程序才能看到正在应用的样式。我猜设计器只是运行 InitializeComponent （这是自动/设计器生成的代码），因此应用了 XAML 但不是自定义的代码隐藏。

所以我想说明确指定的样式是最少的工作。无论如何，您都可以集中更改样式的各个方面。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-03-27T21:11:41.867

知道这是几年后的事了，但是由于问题仍然存在...

1.  在您的项目中创建资源字典（右键单击项目...）

    我将在名为“Assets”的项目下创建一个新文件夹，并将“resourceDict.XAML”放入其中。

2.  将代码添加到 resourceDict.XAML：

    ```
    <Style x:Key="WindowStyle" Target Type="Window" >
         <Setter Property="Background" Value="Blue" />
    </Style> 
    ```

3.  在您的 Project XAML 文件中，在 Window 下添加以下内容：

    ```
    <Window.Resources>
        <ResourceDictionary>
            <!-- Believe it or not the next line fixes a bug MS acknowledges -->
            <Style TargetType="{x:Type Rectangle}" />
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Assets/resourceDict.XAML" />
            </ResourceDictionary.MergedDictionaries>
        <ResourceDictionary>
    </Window.Resources> 
    ```

    参考以下网站：[引用包含合并字典的资源字典时遇到](https://stackoverflow.com/questions/1229395/trouble-referencing-a-resource-dictionary-that-contains-a-merged-dictionary) 问题 “有一个错误：如果您的所有默认样式都嵌套在合并字典中三层深（或更深），则顶部字典不会被标记，因此搜索会跳过它。解决方法是在根词典中为某事、任何事物设置一个默认样式。” 它似乎可以可靠地解决问题。去搞清楚...

4.  最后，在 Window 下，可能在 Title 之后，但在最终 Window '>' 之前：

    ```
    Style="{DynamicResource windowStyle}" 
    ```

5.  您需要将第 3 步和第 4 步中的代码添加到您希望应用该样式的每个项目中。

6.  如果您想使用渐变背景而不是纯色，请将以下代码添加到 resourceDict.XAML：

    ```
    <LinearGradientBrush x:Key="windowGradientBackground" StartPoint="0,0"
            EndPoint="0,1" >
    <GradientStop Color= "AliceBlue" Offset="0" />
    <GradientStop Color= "Blue" Offset=".75" />
    </LinearGradientBrush> 
    ```

7.  并修改您的样式设置器的背景颜色为：

    ```
    <Setter Property="Background" Value="{DynamicResource
            windowGradientBackground}" /> 
    ```

如上所述，需要在每个 project.XAML 文件中重复第 3 步和第 4 步，但是，您可以在解决方案中获得统一的 Windows！同样的过程也适用于任何你想要具有统一外观的控件、按钮等等。

对于迟到的任何人，希望这会有所帮助，因为我确信原始海报几年前就已经弄清楚了。

保罗

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-10T23:23:18.553

The designer is not working because you're specifying a DynamicResource. Please change this to StaticResource and all will be well.

To apply to all windows, you should remove the x:Key from the style. Setting the TargetType implicitly sets the x:Key to whatever is in TargetType. However, in my tests, this is not working, so I am looking into it.

If I set the TargetType to x:Type TextBlock, the designer works perfectly, it just seems to be the Window that is showing different behaviour.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-01-31T15:15:23.447

您可以将此代码添加到您的 App.xaml.cs 文件中：

```
 FrameworkElement.StyleProperty.OverrideMetadata(typeof(Window), new FrameworkPropertyMetadata
        {
            DefaultValue = Application.Current.FindResource(typeof(Window))
        }); 
```

在此之后，应用于`Window`类型的样式也将应用于派生自的所有类型`Window`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-02-25T09:58:17.313

我已经调查了几天，并通过我的自定义窗口类的构造函数使它工作：

```
public class KWindow : Window
{
        public KWindow()
        {
            this.SetResourceReference(StyleProperty, typeof(KWindow));
        }

        static KWindow()
        {
            DefaultStyleKeyProperty.OverrideMetadata(typeof(KWindow), new FrameworkPropertyMetadata(typeof(KWindow)));

        }

        public override void OnApplyTemplate()
        {
            base.OnApplyTemplate();

            // gets called finally
        }
} 
```

希望它可以帮助某人

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-05-10T17:06:10.887

对于那些为解决问题而苦苦挣扎的人：如何将自定义样式自动应用于我的所有 Window 派生类型？以下是我想出的解决方案

注意：出于特定于我的项目的原因（我的产品的消费者使用我的通用可重用样式库并创建自己的布局/窗口等）所以我真的很想*找出*一个可行的解决方案，我愿意忍受任何副作用

需要遍历所有实例化的窗口并简单地强制它们使用您为 Window 类型定义的新自定义样式。这对于已经启动的窗口非常有用，但是当实例化窗口或子窗口时，它不会知道使用已为其基类型声明的新/自定义类型；香草窗口类型。所以我能想到的最好的办法是在 MainWindow 上使用 LostKeyBoardFocus 以在它失去对 ChildWindow 的焦点时（IOW 当创建子窗口时），然后调用这个 FixupWindowDerivedTypes()。

如果有人在实例化任何类型的窗口派生类型时有更好的“检测”解决方案并因此调用 FixupWindowDerivedTypes() 那就太好了。在此区域中处理 WM_WINDOWPOSCHANGING 可能也有一些用处。

因此，这个解决方案并不优雅，但无需我接触任何与我的窗口相关的代码或 XAML 就可以完成工作。

```
 public static void FixupWindowDerivedTypes()
    {
        foreach (Window window in Application.Current.Windows)
        {
           //May look strange but kindly inform each of your window derived types to actually use the default style for the window type

                    window.SetResourceReference(FrameworkElement.StyleProperty, DefaultStyleKeyRetriever.GetDefaultStyleKey(window));
                }
            }
        }
    }

//Great little post here from Jafa to retrieve a protected property like DefaultStyleKey without using reflection.
http://themechanicalbride.blogspot.com/2008/11/protected-dependency-properties-are-not.html

//Helper class to retrieve a protected property so we can set it
internal class DefaultStyleKeyRetriever : Control
{
    /// <summary>
    /// This method retrieves the default style key of a control.
    /// </summary>
    /// <param name="control">The control to retrieve the default style key 
    /// from.</param>
    /// <returns>The default style key of the control.</returns>
    public static object GetDefaultStyleKey(Control control)
    {
        return control.GetValue(Control.DefaultStyleKeyProperty);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-02T09:32:58.650

考虑到**Gishu**的回答，我想出了另一种解决方法。但这可能有点奇怪。如果您使用 MVVM 模式，您可以删除窗口的代码隐藏和 XAML 文件中的 x:Class 标记。因此，您将获得一个窗口实例或您的自定义窗口，但不是从“Window”类派生并标记为部分的“MainWindow”类的某个实例。我正在制作类似 VS 的窗口，所以我必须继承窗口类并扩展它的功能。在这种情况下，可以将新窗口类设为部分，这将允许我们在没有继承的情况下进行代码隐藏。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2013-11-18T09:25:21.070

1.  您将所有样式保存在一个 xaml 文件中（示例 design.xaml）

2.  然后像这样在所有页面中调用该（design.xaml）xaml文件

喜欢：

```
<ResourceDictionary.MergedDictionaries>
                <ResourceDictionary  Source="Design.xaml"/>                
</ResourceDictionary.MergedDictionaries> 
```

# sql-server - NHibernate 生成的 GUID - 字段类型

> ID：431942
> 
> 赞同：2
> 
> 时间：2009-01-10T23:14:40.757
> 
> 标签：sql-server, nhibernate

我是 NHibernate 的新手。如果我使用 NHibernate 为 MS Sql2005 的插入生成 GUID，那么 db 中的 id 字段需要是什么类型。任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-10T23:18:55.847

[唯一标识符](http://msdn.microsoft.com/en-us/library/ms190215(SQL.90).aspx)

# python - 解压到未知数量的变量？

> ID：431944
> 
> 赞同：17
> 
> 时间：2009-01-10T23:15:59.037
> 
> 标签：python, casting, iterable-unpacking

我怎样才能将一个未知的元组解包到一个列表中？

我有许多数据列，它们被某些函数分成一个元组。我想将此元组解压缩为变量，但我不知道我将拥有多少列。有没有办法将它动态解包到我需要的尽可能多的变量中？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-10T23:24:12.327

您可以使用星号解压缩可变长度，例如：

```
foo, bar, *other = funct() 
```

这应该将第一个项目放入`foo`，第二个放入`bar`，其余所有放入`other`。

**更新：**我忘了提到这仅与 Python 3.0 兼容。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-10T23:18:02.917

将元组解包到列表中？

```
l = list(t) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-10T23:23:39.210

你的意思是你想动态创建变量吗？如果它们是动态创建的，您的程序如何知道如何引用它们？

元组有长度，就像列表一样。完全可以这样做：

```
total_columns = len(the_tuple) 
```

您还可以将元组转换为列表，但这样做没有任何好处，除非您想开始修改结果。（元组不能修改；列表可以。）但是，无论如何，将元组转换为列表是微不足道的：

```
my_list = list(the_tuple) 
```

有*很多*方法可以动态创建变量（例如，使用`eval`），但同样，您如何知道如何引用它们？

我认为您应该明确说明您要在这里做什么。

# asp.net-mvc - asp.net mvc routing when passed parameter contains dot

> ID：431945
> 
> 赞同：11
> 
> 时间：2009-01-10T23:16:20.953
> 
> 标签：asp.net-mvc, routing

I have very basic routing:

```
routes.MapRoute(
                "Default",                                              
                "{controller}/{action}/{id}",parameters
                new { controller = "Home", action = "Index", id = "" }
            ); 
```

The problem is that it works perfectly in all simple cases, like `www.xxx.yy/pages/filter/test`". As soon as I add dot "." to {id} part it fails, returning 'The resource cannot be found.' It happens for `www.xxx.yy/pages/filter/test.`

Any suggestions?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-02-12T13:03:39.190

只需在 URL 末尾添加一个斜杠“/”：`www.xxx.yy/pages/filter/test./`

请参阅：[URL 中的点会导致 404 与 ASP.NET mvc 和 IIS](https://stackoverflow.com/questions/11728846/dots-in-url-causes-404-with-asp-net-mvc-and-iis)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T23:26:51.027

看看这篇文章：[“找不到资源。” url 末尾有“点”时出错](https://stackoverflow.com/questions/429963/the-resource-cannot-be-found-error-when-there-is-a-dot-at-the-end-of-the-url)

# sql - 为什么@@IDENTITY 或 SCOPE_IDENTITY() 会是 DBNull？

> ID：431955
> 
> 赞同：1
> 
> 时间：2009-01-10T23:21:36.967
> 
> 标签：sql, vb.net, identity

**（已解决：见底部）**

我有以下代码片段：

```
Protected Sub SqlDataSource1_Inserted(ByVal sender As Object, 
ByVal e As System.Web.UI.WebControls.SqlDataSourceStatusEventArgs)
Handles SqlDataSource1.Inserted
    affected = CInt(DirectCast(e.Command.Parameters("@affected"), IDbDataParameter).Value)
    newID = CInt(DirectCast(e.Command.Parameters("@newID"), IDbDataParameter).Value)
End Sub 
```

在 SQL 字符串中，@newID 的定义如下：

```
"INSERT INTO x(a,b,c) VALUES (@a,@b,@c); SELECT @affected = @@rowcount, @newID = SCOPE_IDENTITY(); 
```

使用 ASP.NET 定义的参数如下：

奇怪的是，这在 90% 的情况下都有效，但每隔一段时间它就会抛出一个 InvalidCastException，说“从类型 'DBNull' 转换为类型 'Integer' 无效”。关于什么可能导致该值为空的任何想法？我没有在表上设置任何触发器，我的查询唯一要做的就是将普通插入运行到 1 个表中。

**编辑**：根据这里的建议，我添加了一个`affected`参数。我设置了一个断点，并影响 = 1，但我仍然得到了异常。但是，我后来发现我在 SELECT @affected 之前有 SELECT @newID。我切换了顺序，现在@affected = 0。所以这似乎是我的插入语句的问题。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-10T23:36:14.423

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms187342.aspx)

> 在 INSERT、SELECT INTO 或大容量复制语句完成后，@@IDENTITY 包含该语句生成的最后一个标识值。如果该语句不影响任何具有标识列的表，则@@IDENTITY 返回 NULL。

你有没有检查插入是否成功？您尝试插入的记录可能由于某种原因无法插入任何内容，因此 id 为空。

桌子上是否设置了任何触发器？您可能正在使用 @@IDENTITY 从触发过程中检索 id

我建议使用[SCOPE_IDENTITY()](http://msdn.microsoft.com/en-us/library/ms190315.aspx)或[输出参数](http://msdn.microsoft.com/en-us/library/ms378108(SQL.90).aspx)来获取 id

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-11T00:19:01.297

您应该在 99.9% 的情况下使用`SCOPE_IDENTITY()`as 相反。`@@IDENTITY`您很少会遇到需要其他东西的情况`SCOPE_IDENTITY()`

> `@@IDENTITY`返回在连接上生成的最后一个 IDENTITY 值，与生成该值的表无关，也与生成该值的语句的范围无关。如果您在一个表上有一个触发器导致在另一个表中创建一个身份，您将获得最后创建的身份，即使它是创建它的触发器。
> 
> `SCOPE_IDENTITY()`返回连接上和同一范围内的语句生成的最后一个 IDENTITY 值，而不管生成该值的表是什么。SCOPE_IDENTITY() 与@@IDENTITY 一样，将返回在当前会话中创建的最后一个身份值，但它也会将其限制在您当前的范围内。

您确定该表上没有审计触发器（可能是您的 DBA 添加的）？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-10T23:31:46.900

各种可能性：

*   INSERT 不插入任何东西（正如 erikkallen 所说）

*   您的语句（未显示）插入到各种表中，其中最后一个没有标识列

*   INSERT 触发一个触发器，该触发器插入到没有标识列的表中 - 改为尝试 SCOPE_IDENTITY()

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-10T23:41:24.633

您可能需要检查@@ROWCOUNT 是否 > 0。

此外，在过去版本的 SQL Server 中也存在影响@@IDENTITY 生存能力的触发器的已知问题。你有什么触发器吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-05T02:52:23.467

另一次发生这种情况时，改变

```
<asp:Parameter Name="newID" Direction="Output" Size="4" /> 
```

到

```
<asp:Parameter Name="newID" Direction="Output" Type="Int32" Size="4" /> 
```

为我解决了这个问题。看来我的主人打开了一些更明确的声明的要求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-10T23:25:32.030

什么是`query text...` 零件？一个插入，我猜。会不会是一个`insert ... select`没有找到任何行的？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-29T11:58:35.767

[使用 SCOPE_IDENTITY() 和 @@IDENTITY 时，您可能会收到不正确的值](http://support.microsoft.com/default.aspx?scid=kb;en-US;2019779)。特别是当查询最终作为并行查询执行时：

[http://support.microsoft.com/default.aspx?scid=kb;en-US;2019779](http://support.microsoft.com/default.aspx?scid=kb;en-US;2019779)

# haskell - 在 Haskell 中解构元组时，可以在哪里使用元素？

> ID：431956
> 
> 赞同：7
> 
> 时间：2009-01-10T23:22:10.693
> 
> 标签：haskell, syntax, pattern-matching

我正在阅读使用以下示例的教程（我将对其进行概括）：

```
f :: Foo -> (Int, Foo)
...
fList :: Foo -> [Int]
fList foo = x : fList bar
  where
    (x, bar) = f foo 
```

我的问题在于，您似乎可以在获取它们的元组之外按名称引用`x`and 。`bar`如果我的猜测是正确的，这似乎就像在其他语言中解构参数列表一样。（换句话说，我不必执行以下操作：）

```
fList foo = (fst tuple) : fList (snd tuple)
      where
        tuple = f foo 
```

我对这种行为是否正确？我从未在我一直在阅读的教程/书籍中看到它。有人可以指出有关该主题的更多信息吗？

**编辑**：可以以类似的方式解构任何东西（列表、数组等），还是只能用元组来解构？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-11T12:16:54.343

看到您的编辑，我认为您要问的是[Pattern matching](http://en.wikibooks.org/wiki/Haskell/Pattern_matching)。

并回答您的问题：是的，您可以构造任何东西，您也可以使用构造函数“解构”。例如，您可能熟悉这种形式的模式匹配：

```
head :: [a] -> a
head (x:xs) = x
head []     = error "Can't take head of empty list" 
```

但是，还有更多可以使用模式匹配的地方，其他有效的符号是：

```
head xs = case xs of
              (y:ys) -> y
              []     -> error "Can't take head of empty list"

head xs = let (y:ys) = xs
          in y

head xs = y
  where
    (y:ys) = xs 
```

请注意，最后两个示例与第一个示例有点不同，因为当您使用空列表调用它们时，它们会给出不同的错误消息。

* * *

尽管这些示例特定于列表，但您可以对其他数据类型执行相同操作，如下所示：

```
first :: (a, b) -> a
first tuple = x
  where
    (x, y) = tuple

second :: (a, b) -> b
second tuple = let (x, y) = tuple
               in y

fromJust :: Maybe a -> a
fromJust ma = x
  where
    (Just x) = ma 
```

同样，如果您使用 调用最后一个函数，它也会崩溃`Nothing`。

总结一下; 如果您可以使用构造函数（如列表、`(:)`元组或Maybe ）创建某些东西，则可以使用相同的构造函数以多种方式进行模式匹配。`[]``(,)``Nothing``Just`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-10T23:31:49.583

> 我对这种行为是否正确？

是的。但是，这些名称仅存在于您定义它们的块中。在您的情况下，这意味着您的`where`子句应用于的逻辑单元，即内部的表达式`fList`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T01:25:53.657

另一种看待它的方式是这样的代码

```
x where x = 3 
```

大致相当于

```
let x = 3 in x 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-11T01:12:38.193

你是对的。在 where 子句中绑定的名称对 where 子句之前的完整声明是可见的。在您的情况下，这些名称是`f`and `bar`。

（学习 Haskell 的难点之一是，在源代码中在定义这些变量的位置之前的位置中使用变量不仅是允许的，而且是常见的。）

阅读有关 where 子句的更多信息的地方是[Haskell 98 报告](http://www.haskell.org/haskellwiki/Language_and_library_specification#The_Haskell_98_report)或可在 中找到的许多优秀教程之一[`haskell.org`](http://www.haskell.org/)。

# java - iText 复制表单域

> ID：431966
> 
> 赞同：1
> 
> 时间：2009-01-10T23:30:49.553
> 
> 标签：java, pdf, forms, itext

iText 中是否可以将 PDF acroform 字段从一个 PDF 文档复制*到*另一个 PDF 文档？我有复制整个 PDF 的代码，但我希望能够将我的所有字段覆盖到一个新的/更新的 PDF 文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T18:16:36.017

```
public void replaceBackground(String newBackground, String CurrentForm, String newFile) throws Exception
        {
            PdfReader reader = new PdfReader(newBackground);
            PdfReader reader2 = new PdfReader(CurrentForm);
            PdfStamper stamp = new PdfStamper(reader2, new FileOutputStream(newFile));
            stamp.replacePage(reader, 1, 1);
            stamp.close();
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T08:10:14.420

我不太清楚我们是否能够实现这一目标，因为我没有直接从事实施工作，但我记得不久前有人指出了这个方向。

您可以使用 PdfStamper 从 acroForm 中提取字段，然后使用 PdfWriter 创建具有预填充字段的新 AcroForm。我希望我能给你一个更好的例子，但我没有代码。

# c# - 我可以在 C# 的设计时迭代引用的程序集吗？

> ID：431967
> 
> 赞同：2
> 
> 时间：2009-01-10T23:31:32.517
> 
> 标签：c#, components, design-time

我正在尝试编写一个 .NET 组件。该组件将被拖放到表单/用户控件上，并且需要在设计时访问组件父表单/用户控件引用的程序集中的属性。是否有可能在设计时获得这些组件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-11T00:29:11.463

[Visual Studio 自动化和可扩展性](http://msdn.microsoft.com/en-us/library/ms228763(VS.80).aspx)将允许您在设计时访问此类信息，从某种意义上说，您可以在设计时拥有和加载项访问数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-10T23:38:14.983

您是否尝试过使用[Assembly.GetReferencedAssemblies](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getreferencedassemblies.aspx)？

### 编辑：

我取消删除了这篇文章，因为你没有任何其他回复。当我最初回答时，我没有正确阅读问题，所以没有看到“设计时”部分。另一方面，也许这并不重要——这至少给了你一些尝试的机会。

祝你好运，如果这是一场疯狂的追逐，我们深表歉意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T03:43:38.620

这是我最终为这个问题提出的概念证明。它并非没有缺陷，但我相信只要稍加努力，它就会正常运行。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.ComponentModel.Design;
using System.Reflection;
using System.Windows.Forms;

namespace ReferencedAssemblies
{
    public partial class GetReferencedComponents : Component, ISupportInitialize
    {
        private Control hostingControl;

        public GetReferencedComponents(IContainer container) : this()
        {
            container.Add(this);
        }

        public GetReferencedComponents()
        {
            InitializeComponent();
            Assemblies = new List<string>();
            GetAssemblies();
        }

        public List<string> Assemblies { get; private set;  }

        [Browsable(false)]
        public Control HostingControl
        {
            get
            {
                if (hostingControl == null && this.DesignMode)
                {
                    IDesignerHost designer = this.GetService(typeof(IDesignerHost)) as IDesignerHost;
                    if (designer != null)
                        hostingControl = designer.RootComponent as Control;
                }
                return hostingControl;
            }
            set
            {
                if (!this.DesignMode && hostingControl != null && hostingControl != value)
                    throw new InvalidOperationException("Cannot set at runtime.");
                else
                    hostingControl = value;
            }
        }

        public void BeginInit()
        {
        }

        public void EndInit()
        {
            // use ISupportInitialize.EndInit() to trigger loading assemblies at design-time.
            GetAssemblies();
        }

        private void GetAssemblies()
        {
            if (HostingControl != null)
            {
                if (this.DesignMode)
                    MessageBox.Show(String.Format("Getting Referenced Assemblies from {0}", HostingControl.Name));
                Assemblies.Clear();
                AssemblyName[] assemblyNames = HostingControl.GetType().Assembly.GetReferencedAssemblies();
                foreach (AssemblyName item in assemblyNames)
                    Assemblies.Add(item.Name);
            }
        }
    } 
```

}

感谢您的回答！

麦克风

# c# - Keep WCF Service Connected

> ID：431973
> 
> 赞同：1
> 
> 时间：2009-01-10T23:34:31.900
> 
> 标签：c#, .net, wcf

How can I keep my WCF Service Client Connected with WinForm even if a Faulted State appened ?

Thanks.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T00:01:55.480

Answer myself :)

You might subscribe to InnerChannel Events

```
 svc.InnerChannel.Closed += InnerChannel_Error;
            svc.InnerChannel.Closing += InnerChannel_Error;
            svc.InnerChannel.Faulted += InnerChannel_Error; 
```

Then Handle Exceptions and Recreate the Service Proxy

```
private void InnerChannel_Error(object sender, EventArgs e)
{
    var svc = _entrepotService as EntrepotServiceProxy;
    try
    {
        if (svc != null)
        {
            if (svc.State != CommunicationState.Faulted)
            {
                svc.Close();
            }
            else
            {
                svc.Abort();
            }
        }
    }
    catch (CommunicationException)
    {
        if (svc != null) svc.Abort();
    }
    catch (TimeoutException)
    {
        if (svc != null) svc.Abort();
    }
    catch
    {
        if (svc != null) svc.Abort();
        throw;
    }
    _entrepotService = new EntrepotServiceProxy();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T23:55:28.940

As far as I know, a faulted state is usually terminal to a WCF proxy. So no, I don't think so.

# wpf - How to set the Image / Icon on a WPF Page

> ID：431979
> 
> 赞同：0
> 
> 时间：2009-01-10T23:36:59.383
> 
> 标签：wpf

I need to know how to set the very top left icon / image on a WPF page. I know how to do it in a WPF Window the page looks to be different.

Thanks,

Darren

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T02:54:18.270

我认为在导航样式的应用程序中不支持根据当前页面更改主机窗口的图标。

一种解决方法可能是在页面中引入 Image 类型的属性（可能从基本页面派生所有页面，或者引入 IHasIcon 接口并实现它），然后将主机窗口的图标绑定到该属性。类似于以下内容：

```
<Window ...
    Icon="{Binding Content.Icon,ElementName=frame1>
    <Frame x:Name="frame1" ... />
</Window> 
```

我还没有尝试过，但我已经通过将 TextBlock 绑定到导航应用程序中当前页面的“标题”做了类似的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-17T10:51:52.410

可以通过将以下（VB）代码添加到页面的Loaded事件来修改宿主窗口的图标（我没有测试将代码放在构造函数中）。

```
Dim hostWindow As NavigationWindow =
        DirectCast(
            DirectCast(Me.VisualParent, 
                System.Windows.Controls.ContentPresenter).
                TemplatedParent, 
        System.Windows.Navigation.NavigationWindow)

Dim iconUri As New Uri("MyIcon.ico", UriKind.RelativeOrAbsolute)
hostWindow.Icon = BitmapFrame.Create(iconUri) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-11T01:01:39.853

您是否指的是部署为 XBAP 的 WPF 应用程序，如果是这样，则与普通网站一样适用相同的规则，您只需将 favicon.ico 放在 IIS 网站的根目录中。

[http://en.wikipedia.org/wiki/Favicon](http://en.wikipedia.org/wiki/Favicon)

# .net - dotfuscator 减慢执行速度？

> ID：431985
> 
> 赞同：2
> 
> 时间：2009-01-10T23:42:56.767
> 
> 标签：.net, obfuscation

我刚刚发现我的程序在通过 dotfuscator 社区版时执行速度降低了 5%。

这正常吗？dotfuscator 的替代品（免费）是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T00:39:12.003

是的，这是混淆的副作用。可能还有一些其他的，比如 Salamander，可以提供更好的性能，但这是混淆的副作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-11T00:44:16.877

混淆器所做的其中一件事是混淆代码中的文字，尤其是文字字符串。这些文字必须在运行时不混淆。字符串处理不是特别快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T04:39:57.553

由于您使用的是免费版本的 Dotfuscator，它只执行重命名，因此您的性能问题很可能与字符串文字混淆的任何开销无关（因为该功能不在该版本中）。

如果您正在使用序列化并且在混淆它们之前在您的程序集上运行 sgen，并且不包括可能导致性能问题的 sgen 程序集。

由于较小的二进制大小和减小的字符串表大小，重命名本身对性能提升通常是性能中立的。我建议的一件事是在混淆程序上运行分析器并尝试找到热点，这些热点可能会给你一些线索，进入可能包含问题线索的区域。

# .net - 如何使用 ADO.net 数据服务将 ASP.net MVC 配置为脚手架？

> ID：431988
> 
> 赞同：1
> 
> 时间：2009-01-10T23:46:16.260
> 
> 标签：.net, asp.net-mvc, wcf-data-services

使用 Linq2SQL 或实体框架的上下文设置 ASP.net MVC 以进行开箱即用的脚手架工作非常容易。您将进行哪些调整以使其与 ADO.net 数据服务一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-11T02:07:41.093

在[http://www.codeplex.com/aspnet](http://www.codeplex.com/aspnet)上有一个使用 ASP.NET 动态数据和 ASP.NET MVC 的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-28T10:01:57.443

我已经自定义了 MVC 脚手架模板，以针对 WCF 数据服务上下文（ADO.NET 数据服务，oData，他们将停止更改名称！）进行脚手架。您可以在此处找到模板：

[http://odatascaffolding.codeplex.com/](http://odatascaffolding.codeplex.com/)

# python - Programming Design Help - How to Structure a Sudoku Solver program?

> ID：431996
> 
> 赞同：0
> 
> 时间：2009-01-10T23:57:46.473
> 
> 标签：python, data-structures, sudoku

I'm trying to create a sudoku solver program in Java (maybe Python). I'm just wondering how I should go about structuring this...

Do I create a class and make each box a object of that class (9x9=81 objects)? If yes, how do I control all the objects - in other words, how do I make them all call a certain method in the class?

Do I just create functions to calculate and just control all the numbers in there with something like an multi-D array?

And actually, even if I could just create multiple functions, how would I control all the objects if I were to make each box an object?

Thanks.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-11T00:05:14.240

Don't over-engineer it. It's a 2-D array or maybe a Board class that represents a 2-D array at best. Have functions that calculate a given row/column and functions that let you access each square. Additional methods can be used validate that each sub-3x3 and row/column don't violate the required constraints.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-11T00:06:27.983

Well, I would use one class for the sudoku itself, with a 9 x 9 array and all the functionality to add numbers and detect errors in the pattern.

Another class will be used to solve the puzzle.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T13:58:12.663

只是为了好玩，这应该是最短的程序，在 python 中，可以解决数独网格：

```
def r(a):i=a.find('0') if i<0:print a [m in[(i-j)%9*(i/9^j/9)*(i/27^j/27|i%9/3^j%9/3)or a[j]for j in range(81)]or r(a[:i]+m+a[i+1:])for m in`14**7*9`]r(raw_input()) 
```

嗯，好吧，这很神秘，我认为它与您的问题不符，所以我为这种噪音道歉:)

[无论如何，您会在这里](http://www.daniweb.com/software-development/python/threads/86363/soduko-problem)找到对这 173 个字符的一些解释。[这里](http://drgoulu.com/2008/10/12/python/)也有法语解释

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-11T00:07:04.097

Do you need to do it in Python or Java? I do a lot of programming in Python, but this can be done much more concisely with integer program using a language like AMPL or GLPK, which I find more elegant (and generally more efficient) for problems like this.

Here it is in AMPL, although I haven't verified how this works: [http://taha.ineg.uark.edu/Sudoku.txt](http://taha.ineg.uark.edu/Sudoku.txt)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-11T00:08:57.307

The simplest way to do it is to represent the board by a 2D 9x9 array. You'll want to have references to each row, column and 3x3 box as a separate object, so storing each cell in a String makes more sense (in Java) than using a primitive. With a String you can keep references to the same object in multiple containers.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-11T00:40:43.530

首先，看起来有两种细胞。

*   已知电话；那些有固定值的，没有选择。

*   未知细胞；那些具有一组候选值的候选值减少到一个最终值。

其次，有几组细胞。

*   水平行和垂直列，每个值必须有一个单元格。该约束用于从行或列中的各个单元格中删除值。

*   3x3 块，每个值必须有一个单元格。该约束用于从块中的各个单元格中删除值。

最后是整体网格。这有几个互补的观点。

*   这是81个细胞。

*   这些细胞也被收集到一个由 3x3 块组成的 3x3 网格中。

*   细胞也被收集到 9 列中。

*   细胞也被收集成 9 行。

你有一个求解器策略对象。

1.  `set( range(1,10) )`它设置为具有候选值的每个未知单元格。

2.  对于每一行、每一列和 3x3 块（27 个不同的集合）：

    一个。对于每个单元格：

    *   如果它具有确定的值（已知单元格和未知单元格的实现方式不同）：从该分组中的所有其他单元格中删除该值。

以上必须迭代，直到没有发现任何变化。

此时，您要么解决了它（所有单元格都报告了一个确定的值），要么您有一些具有多个值的单元格。现在，您必须使用复杂的回溯求解器来找到“有效”的剩余值的组合。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-11T00:49:56.273

包含 81 个整数的一维数组（0 为空）的类对于规则类来说就足够了。规则类强制执行规则（每行、每列或 3x3 方格中没有重复的数字）。它还有一个包含 81 个布尔值的数组，因此它知道哪些单元格是固定的，哪些需要解决。此类的公共接口具有操作板所需的所有方法：

```
int getCell(int x, int y);
bool setCell(int x, int y, int value);
bool clearCell(int x, int y);
int[] getRow(int x);
int[] getCol(int y);
int[] getSubBox(int x, int y);
void resetPuzzle();
void loadPuzzle(InputStream stream); 
```

然后你的求解器使用这个类的公共接口来解决这个难题。我认为求解器的类结构是编写第 5 百万个数独求解器的目的。如果您正在寻找提示，我稍后会编辑此帖子。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-11T00:06:23.770

Maybe a design that had a box per square, and another class to represent the puzzle itself that would have a collection of boxes, contain all the rules for box interactions, and control the overall game would be a good design.*****