# StackOverflow 问答 000421000-000421999

# sql - 表上的索引策略

> ID：421002
> 
> 赞同：4
> 
> 时间：2009-01-07T16:30:26.790
> 
> 标签：sql, sql-server, sql-server-2005, indexing

我有一个名为“EventTable”的 SQL Server 2005 表，定义如下：

事件 ID、事件类型代码、事件状态代码、事件日期

目前该表在主键“EventID”上有一个聚集索引，目前没有其他索引

EventTypeCode 和 EventStatusCode 列是 CHAR(3)（例如 'NEW'、'SEN'、'SAL'）并且是外键

常见选择将是...

```
select * from EventTable Where EventDate = @dateparam;
select * from EventTable Where EventTypeCode = @eventtype;
select * from EventTable Where EventStatusCode = @statustype; 
```

你会使用什么索引策略来处理上面的 Select 语句？

在 3 列上有一个覆盖（复合）索引会更好吗？如果是这样，复合索引应该按什么顺序排列？

还是在 3 列中的每一列上都有一个单独的索引？

该表将以每天大约 300 个事件的速度增长。

* * *

执行查询也很常见，例如

```
`where EventDate between '2008-12-01' and '2008-12-31'
  and EventTypeCode = 'todo'` 
```

 `*   该表更有可能以每天 500-800/条记录而不是 300 条记录的速度增长
*   在正常使用 ASP.NET 应用程序期间，第一个问题中提到的查询将在一天中运行多次
*   NHibernate 'HQL' 用于执行此类查询
*   没有初始数据加载，该表现在只有大约 10K 条记录，因为这是一个新应用程序
*   ...我或多或少只是试图避免客户不得不在几年内打电话给我们抱怨应用程序变得“慢”，因为这张桌子会受到如此多的打击

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T16:44:18.417

策略1，提供可用于过滤的索引。表查找将获取剩余数据。这几乎使空间的使用增加了一倍，写入 IO 成本增加了四倍。

```
on EventTable(EventDate)
on EventTable(EventTypeCode)
on EventTable(EventStatusCode) 
```

策略2，提供可用于过滤的覆盖索引。不会有任何查找。这使空间使用和写入 IO 成本增加了四倍。

```
on EventTable(EventDate, EventId,
              EventTypeCode, EventStatusCode)
on EventTable(EventTypeCode, EventId,
              EventDate, EventStatusCode)
on EventTable(EventStatusCode, EventId,
              EventDate, EventTypeCode) 
```

* * *

列顺序在覆盖索引中很重要的原因（通常）是数据按每列依次排序。也就是说：第2列平局1列。第3列平局1和2列。

由于您没有任何过滤多个列的查询，因此（在您的情况下）第一列之后的列顺序没有意义。

如果您有查询，例如

```
where EventDate = @EventDate
  and EventTypeCode = @EventTypeCode 
```

那么这个覆盖指数会很有用。EventDate 可能比 EventTypeCode 更具选择性，因此它首先出现。

```
on EventTable(EventDate, EventTypeCode,
              EventId, EventStatusCode) 
```

* * *

进一步编辑：如果您有查询，例如

```
where EventDate between '2008-12-01' and '2008-12-31'
  and EventTypeCode = 'todo' 
```

那么这个索引效果最好：

```
on EventTable(EventTypeCode, EventDate,
              EventId, EventStatusCode) 
```

这会将所有 'todo' 事件放在一起，按 EventDate 排序作为决胜局。SQL Server 只需找到第一个元素并读取，直到找到不符合条件的元素并停止。

如果 EventDate 在索引中排在第一位，那么数据将按日期排序，然后每个日期都会将“待办事项”事件聚集在一起。SQL Server 会在 12 月 1 日找到第一个待办事项，直到找到不符合条件的元素……然后在 12 月 2 日找到第一个待办事项，直到它没有待办事项……然后找到。 .. 持续 31 天。

您想选择一个索引来放置您想要的项目彼此相邻。

* * *

如果每天有 300 条记录，您的表将在 50 年内达到 500 万条记录。这不是那么大。任何一种策略都会奏效。策略 1 可能会足够快（空间方面的错误）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T16:47:52.403

您对表运行选择的频率如何？选择通常是正常处理的一部分还是更多用于报告和/或维护和调试？

是否有初始数据加载？如果不是，那么桌子的尺寸就非常小，而且很可能在未来几年都保持这种状态。

尽管您提供了一些示例选择，但您知道每种选择的运行频率吗？

我可能只是将表保持原样并运行分析器以查看在生产中如何访问该表。如果它是一个不断访问的表，并且可能成为不同功能的瓶颈，那么我最好猜测哪些列最常成为 WHERE 子句的一部分，并在其上放置一个索引。例如，如果有一个进程查看过去 24 小时内的所有事件，每 10 秒运行一次，那么日期列上的索引可能是有序的，我什至会聚集在那个索引上而不是主键上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T16:33:25.737

我会在每个外键上放置一个索引（我通常索引大多数外键），然后可能在日期字段上放置一个索引，具体取决于它在搜索中使用的频率。

# c# - 我为所见即所得工具设计 ASP.NET 组件是在浪费时间吗

> ID：421004
> 
> 赞同：7
> 
> 时间：2009-01-07T16:30:41.437
> 
> 标签：c#, asp.net, vb.net, wysiwyg

几天前，我读到一个问题，询问有多少开发人员手工编写 HTML/XHTML 代码而不是依赖所见即所得工具 - [https://stackoverflow.com/questions/406052/do-most-web-programmers-not-designers -使用所见即所得的编辑器或手工编码他们](https://stackoverflow.com/questions/406052/do-most-web-programmers-not-designers-use-wysiwyg-editors-or-hand-code-their)

我倾向于设计用于我的代码的 ASP.NET 服务器控件而不是用户控件。我这样做是为了可以通过拖放到 WYSIWYG 中来重用它们，并且只需设置一些相关的属性。这在设计组件时确实会花费一些额外的时间，但是当我在更大的应用程序中使用它们时会大大简化事情。

在阅读了大多数开发人员似乎是手工编写代码而不是使用 WYSIWYG 之后，这让我想知道：我这样开发组件是在浪费时间吗？

**编辑：**澄清一下-主要是，最初的意图是这些控件是供我自己使用的。但是，在很多情况下，它们可能对我的团队其他成员有用，或者可能用于公开发布。然而，像大多数事情一样，我倾向于看到相对较少的额外工作提供了巨大的潜在额外价值，而不管额外价值实现的可能性如何。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T16:39:32.590

不，你不是在浪费时间。如果所见即所得的用户可以轻松使用您的组件，您的潜在用户群将会更大。如果您是这些组件的唯一用户，请设计它们以符合您的开发风格。如果您进行视觉设计，那么拥有所见即所得的支持是有意义的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T16:44:18.383

您可以创建一个 UserControl 并使用不同的技术将其编译为一个 dll，然后您的 Web 应用程序可以引用该 dll：

一些方法的概述：http: [//geekswithblogs.net/dotnetrodent/archive/2006/06/16/82136.aspx](http://geekswithblogs.net/dotnetrodent/archive/2006/06/16/82136.aspx)

详细方法： [http ://webproject.scottgu.com/CSharp/UserControls/UserControls.aspx](http://webproject.scottgu.com/CSharp/UserControls/UserControls.aspx)

我从不使用 WYSIWYG 工具，因为一旦你考虑了 javascript、CSS 和其他东西，它就永远不会真正是 WYSIWYG。（我知道 VS2008 变得更好但并不完美）。设计师总是很慢。我更喜欢使用标记进行编码。

如果您开发打算出售的商业组件，您应该花时间拥有最完整的功能集恕我直言。包括所见即所得。如果您的构建组件以便您或您的团队可以使用它们，那么您应该评估让您的组件执行额外步骤所花费的时间的成本效益。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T16:45:01.237

我认为您不会浪费时间，特别是如果您想发布这些控件供其他开发人员使用。如果所需的努力确实是“额外的一点”，并且您发现它在更大的项目中对您有所帮助，我认为您的控件通过与所见即所得工具兼容而得到改进。

就个人而言，我通常手动编写 HTML/XHTML 代码，但我喜欢偶尔使用 WYSIWYG 功能。我一直发现，所见即所得友好的控件比依赖手动编写的所有代码的控件更易于使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T17:09:01.157

为了您自己的使用，您已经知道您是否在浪费时间。

[我进入业力防空洞]

对于公众和您团队的其他成员，我将提出反对流程的意见，即您可能正在……不浪费您的时间，但可能没有充分利用它。

我认为很少有 Web 开发人员会认真对待所见即所得的产品，但是如果大多数人可以在手动代码级别使用您的控件，而少数人可以进行拖放，那么您提供了选择的好处，这绝不是一件坏事. 除非可能涉及小孩和良好行为。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T16:40:50.200

如果您对所见即所得编辑器中的工作更满意，并且开发服务器组件使您的工作更轻松，那么如果您所做的工作适合您，我不明白为什么您应该尝试遵循其他开发人员的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T17:13:31.197

我认为您必须对这项民意调查持保留态度。仅仅因为 Stack Overflow 上的大多数人都说他们手动编写 HTML 代码并不意味着大多数 Web 开发人员都会这样做。例如，Dreamweaver 和 Microsoft Frontpage 等工具是非常受欢迎的工具，主要是因为它们的 WYSIWYG 功能。网络托管公司通常拥有所见即所得的网页构建器，这些构建器也非常受欢迎。我的大部分内容也是手工编写的，但我与来自世界各地其他公司的 Web 开发人员一起做了大量自由职业，根据我的个人经验，我可能会说大多数 Web 开发人员确实使用 WYSIWYG工具。Web 开发人员越有经验，他们使用所见即所得工具的可能性就越小，但经验较少的人远远超过经验丰富的人。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T17:38:56.247

您可能会向自己提出一个问题，“其他开发人员是否在浪费时间手工编写控件？”。

如果只在一个页面上使用，我通常只是在页面上拖放控件并在需要时更改生成的 html。如果控件及其功能在同一个 Web 应用程序的多个页面上使用，那么我会转到用户控件。当它肯定会跨应用程序使用时，我只想编写一次代码，所以我转到一个可以轻松分发的服务器控件。我认为关键是它（布局和功能）正在多个地方使用，或者您将在多个地方使用它。在许多地方有重复的代码，就像花更多的时间为一个用途开发可重用的代码一样，是一个“错误”。另外，它是软件，因此您可以稍后更改！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-07T17:42:43.867

我认为您真正的问题可能是，“有没有一种方法可以开发我的 UI，我应该更多地了解它，因为它可能比我现在做的方式更好？”

考虑到事情变化的速度有多快，这是我们都经常问的一个问题。我记得第一次看到使用 Ruby on Rails 开发的网站；然后我浏览了一个**没有**所见即所得步骤的教程；但一切都是通过 CSS 和主题完成的；我突然想到，也许 Dreamweaver 并不是对所有事情都最高效的环境，结果至少同样具有吸引力。

阅读 MVC 教程给了我同样的震撼。

因此，我认为至少值得尝试替代方案，以明智地决定什么最适合我、我的技能和我的要求。我想要我的工具包中最好的工具，即使我并不是每个项目都需要它们。

特别是因为您似乎意识到您当前的方法会占用您大量的时间。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-09T02:37:26.750

我会说，如果它确实只是一点点额外的工作并且它增加了如此多的额外价值，那么很难想象它可能是浪费时间。后面的用户希望将来使用您的组件会发现它更容易，并且将节省大量时间，否则这些时间将花费在手动编码上。更何况如果你可以通过鼠标点击和拖动来拖放一个组件，那为什么还要浪费按键呢？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-09T03:01:31.197

像其他所有事情一样，适当的答案是“视情况而定”......

您必须衡量添加此功能的投资回报率。

对于“我”；就个人而言，我从未创建过适用于所见即所得编辑器的 Web 控件，所以我不知道它需要付出多少努力。

对于'R'；如果您在大型开发团队中工作，分发您的代码，将自己在所见即所得编辑器中重用这些控件，或者甚至只是想要体验，那么您一定会得到回报。但是如果这样做是基于未来的维护程序员；您可能有点倾向于过度优化方面。（恕我直言）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-07T16:45:17.167

我会同意以前的帖子。我不认为你在浪费时间。启用所见即所得的控件允许用户以两种方式做事，扔设计师和扔代码。有时，当您使用属性编辑器时，更容易发现控件的作用，而不是在代码中进行更改，然后编译和运行应用程序。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-07T16:50:26.000

当我开始编程时，我喜欢 WYSIWYG 并将它用于几乎所有事情。

我开始编写 html 代码是必要的，总有一些事情我只是使用 WYSIWYG 编辑器无法正确处理。时间过去了，我意识到对我来说，简单地调整 html 比使用鼠标设置属性要快，所以随着时间的流逝，我使用了越来越多的 html，直到我不再需要所见即所得的编辑器。

我为什么要告诉你这个故事？因为我的个人经验告诉我，初学者程序员会喜欢 WYSIWYG，而您在制作服务器控件和高级程序员方面所做的努力不会给您任何功劳。

我的意见是，你应该随心所欲。如果您这样做是为了取悦他人，那么如果您的团队中没有初学者程序员，请不要打扰。

那是我的 5 美分；）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-07T21:58:27.313

我想如果它在很多地方使用，我会创建控件。即使您手动编写 html 代码，它仍然可以节省时间并简化工作。但我同意手动编码 html/css 更有效，所见即所得的网页构建器不太支持这一点。

# php - 使用 zend 框架创建动态侧边栏的最佳实践

> ID：421013
> 
> 赞同：5
> 
> 时间：2009-01-07T16:33:23.477
> 
> 标签：php, zend-framework

使用 zend 框架创建动态侧边栏或其他非内容布局位置的最佳实践是什么？此时我创建了控制器女巫，我称之为 WidgetsController。在这个控制器中，我为侧边栏定义了一些带有“侧边栏”响应段的操作，在 IndexController 中，我用 $this->view->action(); 调用它们。功能，但我认为这不是创建动态侧边栏的最佳实践。感谢您的回答。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T16:47:09.860

你的问题没有提供很多细节。通常，我会说通过视图的渲染/部分方法将侧边栏加载为视图模板。因此，从内部视图：

```
//$data is dynamic data you want to pass to the sidebar
echo $this -> partial('/path/to/sidebar.phtml',array('menuitems' => $data)); 
```

然后侧边栏可以处理该动态数据：

```
//sidebar.phtml
<div id="sidebar">

    <?php foreach($this -> menuitems as $item) : ?>
    <a href="<?php echo $item['url']; ?>"><?php echo $item['title']; ?></a>
    <?php endforeach; ?>

</div> 
```

如果您需要额外的功能，您可以创建一个专用的[视图助手](http://framework.zend.com/manual/en/zend.view.helpers.html)来处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-07T10:58:26.180

这适用于 ZF 1.11：[Zend Framework 中的动态侧边栏实现](http://hewmc.blogspot.com/2010/09/dynamic-sidebar-implementation-in-zend.html.)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-10-27T01:07:32.553

是的，伙计们，我敢打赌，来自 Code Igniter 的人的答案是正确的方法。实际上，了解 CI 如何简单地完成它并进行比较很有帮助。在 ZF 中基本相同，只是 ZF 使用“Partials”代替“命名视图”。

ZF 只是有更多强加的规则，例如布局 + 视图 + 部分，以及更多的内部机制来实现这一点，这实际上使它运行速度减半，而代码点火器似乎只是将整个设备扁平化为“命名视图”。

（我还没有决定 ZF 是否煮过头了，或者某些 CI 牛排是否必须在中间保持生吃。）

如果你使用 $navigation->setPartial(blah blah) 那么前导数组（从技术上讲，这种数据构成了 MVC 事物的“模型”部分）并且对部分可用。

所以你有它，这个想法似乎是不要将模型的显示方面拉到控制器中，将模型显示的东西推到视图处理机器上。

我自己也想尝试一下，我确实在 Zend 手册的 view helpers 部分中搜索了 partials 以找到它，即使示例有点薄。

祝我好运基思

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-01-07T16:42:06.220

我们想要更多详细信息，即侧边栏中显示的内容类型、显示方式（即使用或其他） `<ul>`、`<div>`从数据库中检索的内容等。

在同样使用该格式的[CodeIgniter](http://www.codeigniter.com)`Model, View, Controller`中，我们创建了一个名为“sidebar.php”的视图，并且在该`Header`视图中，我们包含了对该侧边栏视图的调用，即：

```
<html>
<head>.......</head>
<div id="header">....</div>
<?php $this->load->view('sidebar');?> 
```

侧边栏视图包含显示菜单项的逻辑。通常它是一个静态菜单，但如果它是动态的并且必须从数据库中获取，我会这样做：

```
<ul>
   <?php
   $items=$this->some_model->getMenuItems();
   foreach ($items as $item):
   ?>
     <li><a href="<?=$item['url'];?>"><?=$item['text'];?></li>
   <?php endforeach;?>
</ul> 
```

# java - How to convert a string to RegularTimePeriod in java?

> ID：421020
> 
> 赞同：0
> 
> 时间：2009-01-07T16:34:56.313
> 
> 标签：java, jfreechart

I am using Jfreechart. I have the code like this:

```
TimeSeries t1 = new TimeSeries("EUR/GBP");
t1.add(new Day(4, MonthConstants.JANUARY, 2001), new Double(1.5807)); 
```

But I get `String` from my SQL query. TimeSeries accepts only `RegularTimePeriod` or `TimeSeriesDataItem`.

Please let me know how to convert a `String` into `RegularTimePeriod`.

Thanks in Advance.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T16:45:11.033

首先，您可以通过使用 SimpleDateFormat 解析 mysql 日期字符串来获取 Date 对象，然后使用带有 Date arg 的构造函数创建您的 RegularTimePeriod。

基本上（假设 mysqlDateStr 是您来自 mysql 查询的字符串）：

```
SimpleDateFormat standardDateFormat = new SimpleDateFormat("yyyy-MM-dd");
// (Define your formatter only once, then reuse)

Date myDate = standardDateFormat.parse(mysqlDateStr);
// (you may want to catch a ParseException)

t1.add(new Day(myDate), new Double(1.5807)); 
```

# eclipse - 使用 TDD 进行 Eclipse 插件开发

> ID：421025
> 
> 赞同：1
> 
> 时间：2009-01-07T16:36:25.763
> 
> 标签：eclipse, eclipse-plugin, tdd, eclipse-pde

我想将视图添加到透视图，而无需访问透视图的源代码。这可能吗？

有没有使用 TDD 开发插件的好教程？

[编辑] 我认为我在插件开发中使用 TDDing 有一个很好的起点 [Eclipse 插件开发的自动化单元测试 (junit)](https://stackoverflow.com/questions/255370/automating-unit-tests-junit-for-eclipse-plugin-development)

[edit 02/17/09] 我能够下载插件的源代码。我只是可能会分叉它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T03:55:37.487

测试 GUI 很痛苦！痛苦随着 gui 设计的复杂性呈指数增长。最好的办法是使用 MVC 模式尽可能地将业务逻辑与 GUI 分开，并且在测试 gui 时，将 GUI 连接到“模拟”应用程序。

参见 Object Mentor 的论文，[Humble Dialog Box](http://www.objectmentor.com/resources/articles/TheHumbleDialogBox.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T16:40:56.673

您可能想查看 org.eclipse.ui.perspectiveExtensions 扩展点。

这是一篇关于 Perspectives 的好文章：[Using Perspectives in the Eclipse UI](http://www.eclipse.org/articles/using-perspectives/PerspectiveArticle.html)

抱歉，无法帮助您解决问题的 TDD 部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T01:41:10.797

如果您的目标是简单地将视图添加到您自己的 Eclipse 实例中的透视图，您可以在该透视图中打开它，然后选择 Window -> Save Perspective As...

对于单元测试插件，您基本上可以使用普通的 JUnit 测试来测试它们，您可以将其作为 JUnit 插件测试而不是 Eclipse 中的普通 JUnit 测试来运行。对于 GUI 测试，您可以查看[SWTBot](http://swtbot.sourceforge.net/index.html)。

# ruby-on-rails - 如何在 Rails 上向客户“出售”红宝石

> ID：421026
> 
> 赞同：2
> 
> 时间：2009-01-07T16:36:52.673
> 
> 标签：ruby-on-rails

明天，我将遇到一个不从事技术工作的客户，但可能会问 RubyOnRails 是否适合他的网站。他可能认为没有足够的 RoR 程序员，他将成为该语言的“人质”。

我有充分的理由使用 RoR，客户也有充分的理由喜欢它（它的成本更低！）。

你有我可以向他们展示的“官方”资源吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T16:55:46.147

从某种意义上说，这是“[公共汽车撞击因素](https://stackoverflow.com/questions/400382/how-does-a-good-developer-keep-from-creating-code-with-a-high-bus-hit-factor)”问题的一种变体。任何应用程序，一旦开发，几乎就是语言的“人质”，问题是它是否也是编写应用程序的单个开发人员的“人质”。我认为 RoR 是一个非常合理的开发选择，但问题是如果你碰巧“被公共汽车撞了”，你当地有多少开发人员可以接管它。如果客户愿意与某人远程合作，那么问题就不会那么严重了。不过，为了让他放心，我会先看看当地的情况，了解当地的 Ruby 开发人员团体。活跃的本地开发者团体的存在是可能说服他的一项措施。

另一方面，如果他担心 RoR 在未来不会继续可行，那是一个稍微不同的问题。再说一次，我认为你没问题——你可能想指出使用 RoR 编写的其他应用程序，以表明改进语言 (Ruby) 和框架 (Rails) 的持续压力。[您可以在http://rubyonrails.org/](http://rubyonrails.org/)找到很多此类信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T17:36:28.887

*   使用框架可确保“下一个人”可以快速上手
*   与手工编码相比，Rails 将我的工作量减少了 80%。
*   庞大、活跃、友好的社区可供借鉴
*   自记录测试框架
*   它使用 Ruby，在紧要关头非常容易学习
*   使用开源操作系统的开源语言、框架和数据库。免费销售。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T17:57:40.607

“可能会问 RubyOnRails 是否是他网站的正确选择。他可能会认为 RoR 程序员不够，他将成为该语言的“人质”。”

您是否考虑过这些是应该认真对待的有效问题的可能性？

“我有充分的理由使用 RoR”

但是，这对您的客户有什么帮助？

“成本更低！”

可以？你有什么具体的证据来支持这种说法吗？您是否考虑了托管成本？MRI 上的 Rails 使用大量 RAM。您可能在 Java 领域或更糟。当然取决于应用程序和负载。Phusion Passenger ( `mod_rails`) 在一定程度上改善了这种情况，但这仍然是一个问题。

正如其他文档所提到的，这是一个“巨大的”问题。说得客气一点，Ruby 和 Rails 的官方文档很少。社区倾向于依赖在几周内变得过时和具有误导性的纸质书籍、成千上万的不可靠、相互矛盾的博客文章，以及同样遭受“快速过时”问题严重影响的截屏视频。不要认为 PeepCode 会拯救你。

我仍然会考虑建议客户使用 Rails，因为程序员效率的说法或多或少是正确的，但我会非常谨慎地这样做，我会让他知道缺点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T16:56:42.663

当涉及到开源项目时，文档是巨大的。

您可以做的一件事是向您的客户解释，如果让您和您的开发人员花费数小时和数天时间在其他一些使用和支持较少的开源框架上搜索文档，他们将花费更多。说明 ROR 开发人员可能没有 PHP 开发人员说的那么多，但事实上有大量关于 ruby​​ 和 rails 的文档和信息，这使得任何开源开发人员学习起来都变得更加容易并使用框架。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T17:40:10.517

我会尝试一些事情来说服客户-

1.  Ruby 社区非常庞大
2.  Ruby已经足够成熟了
3.  Ruby 适用于大多数数据库系统。
4.  Rails 是一个基于大多数其他平台已经接受的 Idea(MVC) 的产品。
5.  提高了代码的可读性和可测试性。
6.  成本更低！！
7.  RubyOnRails 中的迁移方法
8.  如果您愿意，您甚至可以使用 JRuby 来定位 Java 平台，而 Java 平台是一个非常受人尊敬的平台。
9.  展示一些很酷的 RoR 应用程序。
10.  解释你如何变得敏捷！

当您没有大公司支持技术时，我很清楚客户不会同意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T19:20:34.217

RoR 的“成本更低”的特性值得商榷，我同意你的看法。但就我而言，我有一个完整的 RoR-ready 环境，而且我知道我可以为 RoR 应用程序收取比我可以做的任何 PHP 应用程序更低的费用。

PHP 和 Rails 的硬件/软件环境几乎相同......价格也是如此。对客户来说成本更低的是我们构建的强大环境。

这就是“成本更低”的功能。我不是在谈论内存消耗或其他任何事情。这一切几乎可以一无所获。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T20:11:38.700

这在很大程度上取决于位置。如果 RoR 开发人员数量众多并且工作价格与其他程序员相当，那么您可以使用它来帮助销售 Ruby。

对于客户来说，主要关注的问题之一是成本。也许他关心的是寻找和支付 RoR 开发人员的维护成本，而不是技术成本。

我知道一家网店被 RoR 的相对“新鲜感”所困扰。他们聘请了一名开发人员来制作网站，而该开发人员使用 RoR。项目结束后，开发商离开了。在我们所在的地区，RoR 开发人员不仅稀缺，而且收费比任何其他类型的 Web 开发人员都高。在这种特殊情况下，网店最终失去了客户。我最后一次检查他们客户的网站是用 PHP 编写的。

我并不是说 RoR 不好，我认为这是一个极端情况，但请务必考虑客户的担忧。维护成本是一个非常合理的问题。

# php - 在 Zend 模型中使用多个表并返回组合结果集

> ID：421031
> 
> 赞同：3
> 
> 时间：2009-01-07T16:38:24.027
> 
> 标签：php, zend-framework

嗨，这是一个非常具体或非常通用的问题 - 我不确定，而且我通常是 Zend 框架/oo 的新手。如果这是一个愚蠢的Q，请耐心等待...

无论如何，我想创建一个执行以下操作的模型：

```
Read all the itmes from a table 'gifts' into a row set

for each row in the table, read from a second table which shows how many have been bought, the append this as another "field" in the returned row

return the row set, with the number bought included. 
```

大多数简单的 Zend 示例似乎只在模型中使用一个表，但我的阅读似乎表明我应该在那里完成大部分工作，而不是在控制器中。如果这是一个过于笼统的问题，那么任何适用于 2 个表并返回数组的模型示例都会很棒！

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T20:28:46.423

我假设第二张桌子类似于“gift_order”之类的东西。

在这种情况下，您需要通过外键指定“gift”和“gift_order”之间的表关系，并在表类中描述它。

```
It will look like this

    class GiftOrder extends Zend_Db_Table_Abstract
    {
    /** Table name */
    protected $_name    = 'gif_order';
    protected $_referenceMap = array(
    "Fileset" =>array(
        "columns" => array("gifId"),
        "refTableClass" => "Gift",
        "refColumns" => array("id")
    ));
      ........................

You need to specify foreigh key constraint while create table with SQL
      ALTER TABLE `gift_order`
  ADD CONSTRAINT `order_to_gift` FOREIGN KEY (`giftId`) REFERENCES `gift` (`id`) ON DELETE CASCADE; 
```

如果这是您正在寻找的东西，您可以在此链接[链接 http://framework.zend.com/manual/en/zend.db.table.relationships.html中找到更多信息](http://framework.zend.com/manual/en/zend.db.table.relationships.html)

有了这样的解决方案，您将能够循环礼物并获得他们的订单，而无需任何复杂的 SQL

$rowSetGifts = $this->findGifts();

```
while($rowSetGifts->next()){
   $gift = $rowSetGifts->current();
   $orders = $gift->findGiftOrder();//This is magick methods, this is the same $gift->findDependentRowset('GiftOrder'); 
```

//现在你可以对订单做一些事情 - count($orders)，循环它们或编辑

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T16:54:10.157

我建议在你的礼物模型类中创建一个函数来返回你想要的。它可能看起来像：

```
public function getGiftWithAdditionalField($giftId) {
  $select = $this->getAdapter()->select()
    ->from(array('g' => 'gifts'))
    ->joinLeft(array('table2' => 't2'), 'g.gift_id = t2.gift_id', array('field' => 'field'))
    ->where('g.gift_id = ?', $giftId);
  return $this->getAdapter->fetchAll($select);
} 
```

您可以查看[Zend Framework Docs on Joins](http://framework.zend.com/manual/en/zend.db.select.html#zend.db.select.building.join)了解更多信息。

# html - 为什么 IE7 在清除浮动时会导致边距错误？

> ID：421040
> 
> 赞同：1
> 
> 时间：2009-01-07T16:41:49.667
> 
> 标签：html, css, internet-explorer, internet-explorer-7

我有一个非常简单的 HTML 页面（验证为 XHTML 1.0 Strict）：

```
<div class="news-result">
    <h2><a href="#">Title</a></h2><span class="date">(1-1-2009)</span>
    <p>Some text...</p>
</div> 
```

使用以下 CSS：

```
.news-result {
    overflow: hidden;
    padding: 30px 0 20px;
}

.news-result h2 {
    float: left;
    margin: 0 10px 0 0;
}

.news-result span.date {
    margin: 1px 0 0;
    float : left;
}

.news-result p {
    padding: 3px 0 0 0;
    clear: left;
} 
```

在 IE6 或 FF3 中呈现此页面完美呈现（标题和日期在一行，然后是段落）。然而，在 IE7 中，标题和日期以及段落之间有很大的空格。

我们有一个简单的重置，可以清除每个元素上的每个边距和填充。

将浮点数放在日期元素上可以解决这个问题，就像`zoom: 1`在段落上设置或`overflow: hidden`在容器上删除一样，但都不是理想的。为什么浮动后跟一个段落会触发这个额外的上边距，只在 IE7 上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T17:12:11.730

我可以假设您有文档类型吗？

但是，将 h2 和 span 更改为 display: inline; 也应该澄清你的问题。

编辑---添加hasLayout

了解内联并不总是一种选择，这里有[一篇解释发生了什么的文章](http://www.search-this.com/2007/09/05/lets-be-clear-about-this/)。

本质上，您必须提供`<p>`hasLayout。有很多方法可以做到这一点，我不喜欢使用`<div class="clearall"></div>`并且更喜欢使用`overflow: hidden;`或`zoom: 1;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T17:06:44.173

我在 IE6、7 和 8B2 中看到了额外的空格。

`<p>`似乎 IE 对标签应用了非零的上边距。

通过进行以下更改，我能够删除 IE 中的空格：

```
.news-result p {
    margin-top: 0;
    padding: 3px 0 0 0;
    clear: left;
} 
```

在 Firefox 2 或 3、Opera 9.63 或 Safari for Windows 3.2.1 中，这一变化似乎没有任何负面影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T13:51:36.160

只需`&nbsp;`在浮动 DIV 和清除 div 之间添加。这将消除差距。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T17:14:35.920

因为 IE7[**仍然**](http://www.maratz.com/blog/archives/2006/11/11/ie-7-quirks-floats-and-margins/) [是浮动](http://retiredblog.gkaindl.com/2007/05/07/ie7-floatmargin-bottom-annoyance/) [窃听器](http://www.positioniseverything.net/explorer/doubled-margin.html)，恐怕。

*（修复链接）*

# character-encoding - 人名的所有允许字符是什么？

> ID：421046
> 
> 赞同：55
> 
> 时间：2009-01-07T16:42:41.663
> 
> 标签：character-encoding, character, names

有标准的 AZ、az 字符，也有连字符、破折号、引号等。

此外，还有所有的国际字符，如变音符号等。

那么，对于一个基于英语的系统，完整的集合是什么？其他语言的集合呢？UTF8、UTF16 等呢？

额外问题：需要多少个名称字段，它们的最大长度是多少？

**编辑：**人名中肯定有两种不同类型的字符，一种是作为上下文的一部分，另一种是出于结构原因。我不想限制或干扰上下文字符，但我确实需要处理结构字符。

例如，我输入了一个用 em 破折号分隔的名称，但很难将其与减号字符区分开来。为了使系统更易于搜索，我想采用所有五种不同类型的破折号，并将它们映射到一个唯一字符（减号）上，这样搜索者就不需要具体知道最初输入的是哪个符号。

破折号存在问题，可能还有引号，还有多少其他符号？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-01-07T16:48:02.933

W3C 有一篇名为[Personal names 的好文章在世界各地](http://www.w3.org/International/questions/qa-personal-names) 很好地解释了问题（和可能的解决方案）（它最初是 Richard Ishida 的两部分博客文章：[第 1](https://r12a.github.io/blog/200610#20070709)部分和[第 2 部分](https://r12a.github.io/blog/200707#20070716)）

我个人会说：支持每个可打印的 Unicode 字符，并且为了安全起见，只提供一个包含完整格式名称的字段“名称”。这样您就可以存储几乎所有形式的名称。您可能需要更结构化的存储，但不要期望能够以结构化形式存储每个组合，因为不同的组合太多了。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-07T16:49:29.560

如果您问我，将可能出现在人名中的字符列入白名单是错误的做法。当然，[A-Za-z] 是一个公平的起点，但是，正如您所说，您会遇到“欧洲”名称的问题。所以你映射所有的变音符号，抑扬符和那些。中文名字呢？日本人？印度人？希伯来语？您正在与风力涡轮机进行战斗。

如果您*绝对必须*检查某人姓名的有效性，我建议您对某些字符进行适度的黑名单。大括号、数学字符、一些标点符号等可能是可以安全忽略的。但如果我是你，我会小心的。

最好只接受进来的任何东西。UTF-16 应该是今天的过度杀伤字符集，在未来几年应该足够了。

**编辑：**至于您关于名称长度和名称数量的问题。如果你真的想让人们写下他们真实而完整的名字，我想这两个问题的唯一万无一失的答案就是“无限”。无法为人类找出任何真实的例子，但作为[曼谷市的本地名称，](http://en.wikipedia.org/wiki/Bangkok#Full_name)人类肯定有类似的例子。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-07T16:56:14.943

我不认为有一个确定的答案。毕竟，有些人的名字甚至无法用 UTF-16 表达……

![王子符号](https://upload.wikimedia.org/wikipedia/en/thumb/a/af/Prince_logo.svg/200px-Prince_logo.svg.png)

那里有一些奇怪的人，他们会给他们的孩子起最疯狂的名字，包括使用奇怪的标点符号、他们自己的语言中不存在的口音等等。

但是，您可以对数据库设置任意限制。如果您愿意，您可以坚持使用 7 位 ASCII 名称。这对用户有点粗鲁，但他们会接受它。它当然使搜索更容易。

我同事的女儿叫 Amélie。但即使是一些（不是全部！）英国政府官方网站（“请准确输入出生证明上显示的姓名”）也不接受 unicode，因此他不得不使用“Amelie”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T16:50:44.033

任何可以由 8 位的任意倍数（大于零）表示的字符都是人名的可能字符。名称和编码的长度都是任意的，因此不应考虑上限。

只要确保你清理了你的数据库输入，那么小 Bobby Drop-tables 就不会得到你。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-07T17:27:49.920

在姓名字段的问题上，错误的***答案***是名字、中间名首字母、姓氏等，原因有很多。

1.  许多人以他们的中间名而闻名，并正式使用首字母、中间名、姓氏的格式。

2.  在某些文化中，姓是名，名是姓。

3.  多个名字和/或中间名越来越普遍。正如@Dour High Arch 指出的那样，另一个极端是名字中只有一个单词的人。

在面向对象的数据库中，您将存储一个 Name 对象，其中包含返回目录样式或签名样式名称的方法；并且后备存储将包含支持这些方法所需的任何数据。

我还没有看到一个关系数据库模型改进了目录样式和签名样式名称的两个可变长度字符串的模型。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-10-26T18:20:55.933

我正在为美国的驾驶学校制作软件，所以对我来说最重要的是州 DMV 接受的驾驶执照上的专有名称。就我而言，允许使用超出 DMV 允许范围的名称会导致问题，即使这些名称是合法的，因为以后必须将相同的名称用于驾驶执照。

从 StackOverflow，我仍然没有确认我需要的答案。而且我碰巧知道，在我所在的州（加利福尼亚州），他们使用的软件可能是用 COBOL 编写的 AS400，据我所知，这些软件仅支持 8 位字符集。（是 EBCDIC 吗？） 无论如何……呃。

所以，我给加州 DMV 打了电话……果然，他们的系统允许 AZ 和空间，绝对没有别的。连连字符都不允许——连字符被替换为空格。事实上，显然只是为了难，他们只使用大写字母。并且必须将“O'Malley”等名称替换为 OMALLEY。

交给政府吧。我必须说我很高兴没有成为 DMV 的开发人员。（虽然我真的可以用那种薪水。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-08T00:17:42.133

这实际上取决于应用程序应该用于什么。

当然，理论上如果你允许使用上帝的绿色地球上的每一个脚本是很好的，但如果数据库也被支持人员使用，他们是否能够处理日文、希伯来文和泰文的名字？如果它用于打印邮资标签，您可以打印机吗？

您可能会添加一个额外的字段“拉丁语转录”，但 IMO 将其限制为 ISO-8859-1 字符真的没问题 - 不使用拉丁字符的人现在已经习惯了不得不使用他们不使用的转录本别再介意了，除非他们是铁杆民族主义者。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T16:47:29.390

UTF-8 应该足够好，就名称字段而言，您至少需要名字和姓氏。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T16:55:56.160

当你有《艺术家原名王子》时，你会怎么做。他使用的那个符号不是 unicode 集 (AFAIK) 中的字符。

这有点轻率，但与此同时，名称是一个相当广泛的概念，不适合结构化格式。在这种情况下，自由形式的东西可能是最合适的。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-07T16:51:56.293

根据您的名称结构的复杂性，我可以看到：

1.  名
2.  中间名首字母/中间名
3.  姓
4.  后缀（Jr. Sr. II、III、IV 等）
5.  前缀（先生、夫人、女士等）

# sql - SQL Server UNION - 默认的 ORDER BY 行为是什么

> ID：421049
> 
> 赞同：39
> 
> 时间：2009-01-07T16:43:19.400
> 
> 标签：sql, sql-server, union, sql-order-by

如果我有几个 UNION 语句作为人为的例子：

```
SELECT * FROM xxx WHERE z = 1
UNION 
SELECT * FROM xxx WHERE z = 2
UNION
SELECT * FROM xxx WHERE z = 3 
```

**默认`order by`行为是什么？**

我看到的测试数据基本上不会按照上面指定的顺序返回数据。即数据是有序的，但我想知道这方面的优先规则是什么。

另一件事是，在这种情况下，xxx 是一个视图。该视图将 3 个不同的表连接在一起以返回我想要的结果。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-01-07T16:48:34.647

没有默认顺序。

如果没有**Order By**子句，则返回的订单是未定义的。这意味着 SQL Server 可以按照它喜欢的任何顺序恢复它们。

编辑：根据我所看到的，没有 Order By，结果返回的顺序取决于查询计划。因此，如果它正在使用一个索引，则结果可能会按该顺序返回，但同样不能保证。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-08T17:08:40.830

关于添加 ORDER BY 子句：

这对大多数人来说可能是基本的，但我想我添加了这个。有时您不希望结果混合在一起，因此您需要第一个查询的结果，然后是第二个，依此类推。为此，我只需添加一个虚拟的第一列并按此排序。由于忘记为联合中的列命名可能存在问题，我通常在 order by 子句中使用序数，而不是列名。

例如：

```
SELECT 1, * FROM xxx WHERE z = 'abc'
UNION ALL
SELECT 2, * FROM xxx WHERE z = 'def'
UNION ALL
SELECT 3, * FROM xxx WHERE z = 'ghi'
ORDER BY 1 
```

当我要运行两个查询并且我知道只有一个会返回任何结果时，虚拟序数列也很有用。然后我可以检查返回结果的序数。这使我不必进行多次数据库调用和大多数空结果集检查。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-11T11:48:59.583

刚刚找到实际答案。

因为 UNION 会删除重复项，所以它会执行 DISTINCT SORT。这是在连接所有 UNION 语句之前完成的（查看执行计划）。

要停止排序，请执行 UNION ALL，这也不会删除重复项。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-07T18:27:22.513

**如果您关心返回记录的顺序，则必须使用 order by。**

如果您忽略它，它可能会*显得*井井有条（基于查询计划选择的索引），但是您今天看到的结果可能不是您期望的结果，甚至在明天运行相同的查询时它甚至可能会发生变化。

编辑：一些好的，具体的例子：（所有例子都是 MS SQL 服务器）

*   [Dave Pinal 的博客](http://blog.sqlauthority.com/2008/11/24/sql-server-interesting-observation-about-order-of-resultset-without-order-by/)描述了两个非常相似的查询如何显示不同的明显顺序，因为使用了不同的索引：

    ```
    SELECT ContactID FROM Person.Contact
    SELECT *         FROM Person.Contact 
    ```

*   [Conor Cunningham](http://blogs.msdn.com/conor_cunningham_msft/archive/2008/08/27/no-seatbelt-expecting-order-without-order-by.aspx)展示了当表变大时（如果查询优化器决定使用并行执行计划），表观顺序会如何变化。

*   [Hugo Kornelis](http://sqlblog.com/blogs/hugo_kornelis/archive/2006/12/31/Beatles-vs-Stones.aspx)证明了明显的顺序**并不**总是基于主键。[这是他的后续帖子](http://sqlblog.com/blogs/hugo_kornelis/archive/2007/01/16/Beatles_2D00_vs_2D00_Stones_2D00_explanation.aspx)，并附有解释。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T18:15:49.480

UNION 在结果集排序方面可能具有欺骗性，因为数据库有时会使用排序方法来提供 UNION 中隐含的 DISTINCT，这使得行看起来像是故意排序的——这不适用于 UNION ALL当然，其中没有隐含的不同。

但是有一些隐式 distinct 算法，例如 Oracle 在 10g+ 中的散列方法，不会应用排序。

正如 DJ 所说，始终使用 ORDER BY

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T18:31:55.547

遇到写得不好的代码假设表数据以插入顺序返回是很常见的，95% 的时间编码人员都没有意识到这是一个问题，就像在许多常见数据库（MSSQL、Oracle、 MySQL)。这当然是一个完全的谬误，当遇到它时应*始终予以纠正，并且始终无一例外地自己使用 Order By 子句。*

# python - python setup.py develop 不更新easy_install.pth

> ID：421050
> 
> 赞同：6
> 
> 时间：2009-01-07T16:43:28.590
> 
> 标签：python, setuptools

根据[setuptools](http://peak.telecommunity.com/DevCenter/setuptools#development-mode)文档， setup.py develop 应该在安装到 site-packages 文件夹时创建 egg-link 文件并更新 easy_install.pth。但是，就我而言，它只是创建了 egg-link 文件。setuptools 如何决定是否需要更新 easy_install.pth？

更多信息：当我将 setuptools 0.6c7 作为站点包下的文件夹安装时，它可以工作。但是当我使用作为压缩鸡蛋安装的 setuptools 0.6c9 时，它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T15:06:09.677

使用命令重新安装 setuptools `easy_install --always-unzip --upgrade setuptools`。如果这样可以解决问题，那么压缩就是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T08:38:39.007

我会尝试用 pdb 调试它。问题很可能与easy install 的方法check_site_dir 相关，该方法寻找easy-install.pth。

# image - 如何将图像保存为具有给定输出文件大小的 PNG 或 JPG 文件？（在 C# 中首选）

> ID：421056
> 
> 赞同：2
> 
> 时间：2009-01-07T16:44:33.267
> 
> 标签：image, png, jpeg

我想以给定的文件大小（例如 100KB）将现有图像保存为 PNG 或 JPG。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T16:47:53.213

只有使用 JPG 2000 才能将文件大小设置为特定值。使用 JPG，您将不得不尝试不同的质量值，而使用 PNG 将为给定的图像和压缩级别提供一个尺寸 - 您只能尝试调整图像的大小，从而获得更小的尺寸。

您也可以尝试调整图像的大小，以便未压缩的图像具有您想要的大小，但是 PNG 尤其是 JPG 通常会具有较小的文件大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T16:55:01.827

PNG使用无损压缩，因此您不能将其压缩到一定水平以下。

在 .NET 中，您可以保存带有压缩的 JPG，并猜测完成后文件的大小。

[http://msdn.microsoft.com/en-us/library/system.drawing.image.save(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.drawing.image.save(VS.80).aspx) - 请参阅“使用压缩值保存 JPEG 图像”部分。

此外，您可以调整图像尺寸以使其更小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T17:05:20.417

对于 PNG，没有真正的质量设置，因此您无法真正控制文件大小。

Jpg 有一个质量设置，它决定了图像的质量有多好。较低的质量设置会导致较小的文件。但是，通常没有“提供大小为 x 的文件所需的质量”的选项。

您可以使用一种效率相当低的方法在内存中转换为 jpg，查看输出的大小，上下调整质量并重复直到足够接近，从而获得相同的结果。这听起来可能很糟糕，但如果您的图像不是太大，您可能会发现在您执行此操作时没有人注意到短暂的延迟。

# nhibernate - 将 Hibernate 过滤器属性应用于具有多对多关系的 Bag

> ID：421075
> 
> 赞同：13
> 
> 时间：2009-01-07T16:48:20.437
> 
> 标签：nhibernate, hibernate, nhibernate-mapping

考虑以下 Hibernate 映射文件：

```
<hibernate-mapping ...>
<class name="ContentPackage" table="contentPackages">
    <id name="Id" column="id" type="int"><generator class="native" /></id>
    ...
    <bag name="Clips" table="contentAudVidLinks">
      <key column="fk_contentPackageId"></key>
      <many-to-many class="Clip" column="fk_AudVidId"></many-to-many>
      <filter name="effectiveDate" condition=":asOfDate BETWEEN startDate and endDate"  />
    </bag>
</class>
</hibernate-mapping> 
```

当我运行以下命令时：

```
 _session.EnableFilter("effectiveDate").SetParameter("asOfDate", DateTime.Today);

  IList<ContentPackage> items = _session.CreateCriteria(typeof(ContentPackage))
                                     .Add(Restrictions.Eq("Id", id))
                                     .List<ContentPackage>(); 
```

生成的 SQL 在中间映射表 (contentAudVidLinks) 上有 WHERE 子句，而不是“剪辑”表，即使我已将过滤器属性添加到剪辑袋。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-07T19:48:25.173

弄清楚了。对于任何有兴趣的人，我把我的`<filter>`属性放在了错误的地方：

前：

```
<bag name="Clips" table="ctv_bb_contentAudVidLinks">
  <key column="fk_contentPackageId"></key>
  <many-to-many class="Clip" column="fk_AudVidId"></many-to-many>
  <filter name="effectiveDate" condition=":asOfDate BETWEEN startDate and endDate" />
</bag> 
```

后：

```
<bag name="Clips" table="ctv_bb_contentAudVidLinks">
  <key column="fk_contentPackageId"></key>
  <many-to-many class="Clip" column="fk_AudVidId">
    <filter name="effectiveDate" condition=":asOfDate BETWEEN startDate and endDate" />
  </many-to-many>
</bag> 
```

# database - 处理架构更改的 SSIS 传输任务

> ID：421088
> 
> 赞同：0
> 
> 时间：2009-01-07T16:51:25.843
> 
> 标签：database, sql-server-2005, ssis, automation

我正在使用带有 SQL Server 2k5 的 SSIS 来构建传输任务，以将所有数据从一个数据库复制到另一个数据库。这工作得很好，除了一个问题 - 源数据库将定期进行模式更改（通常只是添加新列等），但如果两个模式不完全匹配，传输任务似乎会阻塞。有什么方法可以使用 SSIS 首先使目标数据库与源数据库的架构保持同步，然后进行传输？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T05:51:28.597

您可以以编程方式打开包并在执行前重新保存它。您还可以使用 SSIS 对象模型以编程方式构建包。

# c++ - 如何为第三方遗留代码创建测试对象

> ID：421107
> 
> 赞同：4
> 
> 时间：2009-01-07T16:56:46.753
> 
> 标签：c++, unit-testing, legacy

我有一个代码库，其中我实现的许多类都派生自我公司其他部门提供的类。与这些其他部门合作通常具有工作关系，就好像他们是第三方中间件供应商一样。

我正在尝试在不修改这些基类的情况下编写测试代码。但是，由于缺少接口，创建有意义的测试对象存在问题：

```
//ACommonClass.h
#include "globalthermonuclearwar.h" //which contains deep #include dependencies...
#include "tictactoe.h" //...and need to exist at compile time to get into test...

class Something //which may or may not inherit from another class similar to this...
{
public:
  virtual void fxn1(void);  //which often calls into many other classes, similar to this
  //...
  int data1;  //will be the only thing I can test against, but is often meaningless without fxn1 implemented
  //...
}; 
```

我通常会提取一个界面并从那里工作，但由于这些是“第三方”，我无法提交这些更改。

目前，我创建了一个单独的文件，其中包含在需要知道的基础上在第三方提供的基类头文件中定义的函数的假实现，如“使用遗留代码”一书中所述。

我的计划是继续使用这些定义，并为我需要的每个第三方类提供替代测试实现：

```
//SomethingRequiredImplementations.cpp
#include "ACommonClass.h"
void CGlobalThermoNuclearWar::Simulate(void) {};  // fake this and all other required functions...
// fake implementations for otherwise undefined functions in globalthermonuclearwar.h's #include files...
void Something::fxn1(void) { data1 = blah(); } //test specific functionality. 
```

但在我开始这样做之前，我想知道是否有人尝试在类似于我的代码库上提供实际对象，这将允许创建新的测试特定类来代替实际的第三方类。

请注意，所有有问题的代码库都是用 C++ 编写的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T17:09:09.567

[模拟对象](http://en.wikipedia.org/wiki/Mock_object)适合这种任务。它们允许您模拟其他组件的存在而不需要它们存在。您只需在测试中定义预期的输入和输出。

[Google](http://code.google.com/p/googlemock/)有一个很好的 C++ 模拟框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T17:05:13.060

我现在遇到了一个非常相似的问题。我不想添加一堆只是为了测试而存在的接口，所以我不能使用任何现有的模拟对象库。为了解决这个问题，我做了同样的事情，用假实现创建一个不同的文件，让我的测试链接假行为，生产代码链接真实行为。

在这一点上，我希望我能做的是获取另一个模拟框架的内部结构，并在我的假对象中使用它。它看起来有点像这样：

*生产.h*

```
class ConcreteProductionClass { // regular everyday class
protected:
    ConcreteProductionClass(); // I've found the 0 arg constructor useful
public:
    void regularFunction(); // regular function that I want to mock
} 
```

*模拟.h*

```
class MockProductionClass 
    : public ConcreteProductionClass
    , public ClassThatLetsMeSetExpectations 
{
    friend class ConcreteProductionClass;
    MockTypes membersNeededToSetExpectations;
public:
    MockClass() : ConcreteProductionClass() {}
}

ConcreteProductionClass::regularFunction() {
    membersNeededToSetExpectations.PassOrFailTheTest();
} 
```

*生产代码.cpp*

```
void doSomething(ConcreteProductionClass c) {
    c.regularFunction();
} 
```

*测试.cpp*

```
TEST(myTest) {
    MockProductionClass m;
    m.SetExpectationsAndReturnValues();
    doSomething(m);
    ASSERT(m.verify());
} 
```

所有这一切中最痛苦的部分是其他模拟框架非常接近这一点，但没有完全做到这一点，而且宏非常复杂，以至于调整它们并非易事。我已经开始在业余时间研究这个问题，但进展并不快。即使我的方法按照我想要的方式工作，并且期望设置代码到位，这种方法仍然有几个缺点，其中一个是如果你必须链接，你的构建命令可能会有点长很多.o 文件而不是一个.a，但这是可以管理的。也不可能通过默认实现，因为我们没有链接它。无论如何，我知道这并不能回答这个问题，或者真的告诉你任何你不知道的事情，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T19:58:43.077

您在问题中没有指出的一件事是您的类从另一个部门的基类派生的原因。这种关系真的是一种 IS-A 关系吗？

除非您的类需要由框架使用，否则您可以考虑使用**委托而不是继承**。然后，您可以使用依赖注入在单元测试中为您的类提供类的模拟。

否则，一个想法是编写一个脚本，从它们提供的标头中提取和创建您需要的接口，并将其集成到编译过程中，以便您的单元测试可以签入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T17:03:39.640

您可能需要考虑将[模拟](http://code.google.com/p/googlemock/)而不是伪装作为一种潜在的解决方案。在某些情况下，如果原始类不是，您可能需要编写可模拟的包装类。我已经用 C#/.Net 中的框架类完成了这个，但不是 C++ 所以 YMMV。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T17:22:42.270

如果我有一个需要测试的类，该类源自我不能（或不想）在测试中运行的东西，我将：

1.  创建一个新的纯逻辑类。
2.  将 code-i-wanna-test 移动到逻辑类。
3.  使用接口与真实类对话，以与基类和/或我不能或不会放入逻辑的事物进行交互。
4.  使用相同的接口定义一个测试类。这个测试类可能只有 noops 或模拟真实类的花哨代码。

如果我有一个只需要在测试中使用的类，但使用真正的类是一个问题（依赖关系或不需要的行为）：

1.  我将定义一个新接口，它看起来像我需要调用的所有公共方法。
2.  我将创建一个支持该接口进行测试的对象的模拟版本。
3.  我将创建另一个由该类的“真实”版本构建的类。它还支持该接口。所有接口调用一个转发给真实对象的方法。
4.  我只会对我实际调用的方法执行此操作 - 而不是所有公共方法。当我编写更多测试时，我将添加到这些类中。

例如，我像这样包装 MFC 的 GDI 类来测试 Windows GDI 绘图代码。模板可以使其中的一些变得更容易 - 但由于各种技术原因（Windows DLL 类导出的东西......），我们经常最终没有这样做。

我确信所有这些都在 Feather 的*《使用遗留代码》*一书中 - 我所描述的内容具有实际意义。只是不要让我把书从书架上拉下来......

# c# - 有没有一种简单的方法可以在 C# 中模拟 Objective-C 类别？

> ID：421119
> 
> 赞同：6
> 
> 时间：2009-01-07T17:00:47.710
> 
> 标签：c#, objective-c, design-patterns, oop, visitor-pattern

我有一个以前从未遇到过的奇怪的设计情况......如果我使用的是Objective-C，我会用类别来解决它，但我必须使用C# 2.0。

首先，一些背景。我在这个类库中有两个抽象层。底层实现了用于扫描内容的组件的插件架构（抱歉，不能比这更具体）。每个插件都会以某种独特的方式进行扫描，但插件也会因它们接受的内容类型而异。由于与本次讨论无关的各种原因，我不想通过插件接口公开泛型。因此，我最终得到了 IScanner 接口和每种内容类型的派生接口。

顶层是一个方便的包装器，它接受包含各个部分的复合内容格式。不同的扫描器将需要复合的不同部分，具体取决于他们感兴趣的内容类型。因此，我需要具有特定于每个 IScanner 派生接口的逻辑，用于解析复合内容，查找所需的相关部分。

解决这个问题的一种方法是简单地向 IScanner 添加另一个方法并在每个插件中实现它。但是，两层设计的重点是让插件本身不需要了解复合格式。解决这个问题的蛮力方法是在上层进行类型测试和向下转换，但这些都需要小心维护，因为将来会添加对新内容类型的支持。在这种情况下，访问者模式也会很尴尬，因为实际上只有一个访问者，但不同访问类型的数量只会随着时间的推移而增加（即——这些是访问者适用的相反条件）。另外，当我真正想要的是劫持 IScanner 的单次调度时，双重调度感觉有点过头了！

如果我使用的是 Objective-C，我只需在每个 IScanner 派生接口上定义一个类别，然后在其中添加 parseContent 方法。类别将在上层定义，因此插件不需要更改，同时避免了类型测试的需要。不幸的是，C# 扩展方法不起作用，因为它们基本上是静态的（即——绑定到调用站点使用的引用的编译时类型，而不是像 Obj-C 类别那样与动态调度挂钩）。更不用说，我必须使用 C# 2.0，所以我什至无法使用扩展方法。:-P

那么在 C# 中是否有一种干净简单的方法来解决这个问题，类似于如何使用 Objective-C 类别来解决这个问题？

* * *

编辑：一些伪代码有助于使当前设计的结构清晰：

```
interface IScanner
{ // Nothing to see here...
}

interface IContentTypeAScanner : IScanner
{
    void ScanTypeA(TypeA content);
}

interface IContentTypeBScanner : IScanner
{
    void ScanTypeB(TypeB content);
}

class CompositeScanner
{
    private readonly IScanner realScanner;

    // C-tor omitted for brevity... It takes an IScanner that was created
    // from an assembly-qualified type name using dynamic type loading.

    // NOTE: Composite is defined outside my code and completely outside my control.
    public void ScanComposite(Composite c)
    {
        // Solution I would like (imaginary syntax borrowed from Obj-C):
        // [realScanner parseAndScanContentFrom: c];
        // where parseAndScanContentFrom: is defined in a category for each
        // interface derived from IScanner.

        // Solution I am stuck with for now:
        if (realScanner is IContentTypeAScanner)
        {
            (realScanner as IContentTypeAScanner).ScanTypeA(this.parseTypeA(c));
        }
        else if (realScanner is IContentTypeBScanner)
        {
            (realScanner as IContentTypeBScanner).ScanTypeB(this.parseTypeB(c));
        }
        else
        {
            throw new SomeKindOfException();
        }
    }

    // Private parsing methods omitted for brevity...
} 
```

* * *

编辑：澄清一下，我已经对这个设计进行了很多思考。我有很多原因，其中大部分我无法分享，为什么它是这样的。我还没有接受任何答案，因为虽然很有趣，但他们回避了最初的问题。

事实上，在 Obj-C 中，我可以简单而优雅地解决这个问题。问题是，我可以在 C# 中使用相同的技术吗？如果可以，如何使用？我不介意寻找替代品，但公平地说，这不是我问的问题。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T17:35:51.820

听起来您的意思是您的内容布局如下：

```
+--------+
| 第 1 部分 |
| A型 |
+--------+
| 第 2 部分 |
| C型|
+--------+
| 第 3 部分 |
| F型 |
+--------+
| 第 4 部分 |
| D型 |
+--------+

```

并且每个零件类型都有阅读器。也就是说，AScanner 知道如何处理类型 A 的一部分中的数据（例如上面的第 1 部分），BScanner 知道如何处理类型 B 中的一部分中的数据，等等。到目前为止我是对的吗？

现在，如果我理解您，您遇到的问题是类型读取器（`IScanner`实现）不知道如何定位他们在复合容器中识别的部分。

您的复合容器能否正确列举单独的部分（即，它知道一个部分在哪里结束，另一个在哪里开始），如果是这样，每个部分是否具有某种类型的标识，扫描仪或容器可以区分？

我的意思是，数据是这样排列的吗？

```
+--------------+
| 第 1 部分 |
| 长度：100 |
| 类型：“A”|
| 数据：... |
+--------------+
| 第 2 部分 |
| 长度：460 |
| 类型：“C”|
| 数据：... |
+--------------+
| 第 3 部分 |
| 长度：26 |
| 类型：“F”|
| 数据：... |
+--------------+
| 第 4 部分 |
| 长度：790 |
| 类型：“D”|
| 数据：... |
+--------------+

```

如果您的数据布局与此类似，那么扫描器是否可以不请求容器所有具有与给定模式匹配的标识符的部分？就像是：

```
class Container : IContainer{
    IEnumerable IContainer.GetParts(string type){
        foreach(IPart part in internalPartsList)
            if(part.TypeID == type)
                yield return part;
    }
}

class AScanner : IScanner{
    void IScanner.ProcessContainer(IContainer c){
        foreach(IPart part in c.GetParts("A"))
            ProcessPart(part);
    }
} 
```

或者，如果容器可能无法识别部件类型，但扫描仪能够识别其自己的部件类型，可能类似于：

```
delegate void PartCallback(IPart part);

class Container : IContainer{
    void IContainer.GetParts(PartCallback callback){
        foreach(IPart part in internalPartsList)
            callback(part);
    }
}

class AScanner : IScanner{
    void IScanner.ProcessContainer(IContainer c){
        c.GetParts(delegate(IPart part){
            if(IsTypeA(part))
                ProcessPart(part);
        });
    }

    bool IsTypeA(IPart part){
        // determine if part is of type A
    }
} 
```

也许我误解了您的内容和/或您的架构。如果是这样，请澄清，我会更新。

* * *

来自OP的评论：

> 1.  扫描仪不应该对容器类型有任何了解。
> 2.  容器类型没有内置智能。它与您在 C# 中获得的普通旧数据一样接近。
> 3.  我无法更改容器类型；它是现有架构的一部分。

我的回复太长，无法评论：

1.  扫描仪必须有*某种*方式来检索他们处理的零件。如果您担心`IScanner`界面不应该知道`IContainer`界面，以便您`IContainer`将来可以自由更改界面，那么您可以通过以下几种方式之一进行妥协：

    *   您可以将派生自（或包含）的`IPartProvider`接口传递给扫描仪。`IContainer`这`IPartProvider`只会提供提供零件的功能，因此它应该非常稳定，并且可以在与 相同的程序集中定义`IScanner`，这样您的插件就不需要引用`IContainer`定义的程序集。
    *   您可以将委托传递给扫描仪，他们可以使用该委托来检索零件。然后，扫描程序将不需要任何接口的知识（`IScanner`当然除了 ），只需要委托。
2.  和

3.  听起来您可能需要一个知道如何与容器和扫描仪通信的代理类。上面提到的任何功能都可以在任何 ol' 类中实现，只要容器已经公开（或受保护地 [这是一个词吗？]）公开了足够的功能，外部/派生类将能够访问相关数据.

* * *

从您编辑的问题中的伪代码来看，您似乎并没有真正从界面中获得任何好处，而是将您的插件紧密耦合到您的主应用程序，因为每种扫描仪类型都有一个独特的派生，`IScanner`它定义了一个独特的“扫描" 方法，并且`CompositeScanner`该类对每个部件类型都有一个唯一的“解析”方法。

我会说这是你的主要问题。您需要将插件（我假设它是`IScanner`接口的实现者）与主应用程序（我假设它是`CompositeScanner`类所在的位置）分离。我之前的建议之一是*我*将如何实现它，但具体细节取决于您的`parseType`*X*函数的工作方式。这些可以抽象和概括吗？

据推测，您的`parseType`*X*函数与`Composite`类对象通信以获取所需的数据。这些不能移动到通过类代理`Parse`的接口上的方法中以从对象中获取这些数据吗？像这样的东西：`IScanner``CompositeScanner``Composite`

```
delegate byte[] GetDataHandler(int offset, int length);

interface IScanner{
    void   Scan(byte[] data);
    byte[] Parse(GetDataHandler getData);
}

class Composite{
    public byte[] GetData(int offset, int length){/*...*/}
}

class CompositeScanner{}
    IScanner realScanner;

    public void ScanComposite(Composite c){
        realScanner.Scan(realScanner.Parse(delegate(int offset, int length){
            return c.GetData(offset, length);
        });
    }
} 
```

当然，这可以通过删除单独的`Parse`方法`IScanner`并简单地将`GetDataHandler`委托直接传递给（如果需要，`Scan`其实现可以调用 private ）来简化。`Parse`然后代码看起来与我之前的示例非常相似。

这种设计提供了我能想到的尽可能多的关注点分离和解耦。

* * *

我只是想到了一些你可能会觉得更可口的东西，而且确实可以提供更好的关注点分离。

如果您可以让每个插件“注册”到应用程序，那么您可以将解析留在应用程序中，只要插件可以告诉应用程序如何检索其数据。示例如下，但由于我不知道您的部件是如何识别的，因此我实现了两种可能性——一种用于索引部件，一种用于命名部件：

```
// parts identified by their offset within the file
class MainApp{
    struct BlockBounds{
        public int offset;
        public int length;

        public BlockBounds(int offset, int length){
            this.offset = offset;
            this.length = length;
        }
    }

    Dictionary<Type, BlockBounds> plugins = new Dictionary<Type, BlockBounds>();

    public void RegisterPlugin(Type type, int offset, int length){
        plugins[type] = new BlockBounds(offset, length);
    }

    public void ScanContent(Container c){
        foreach(KeyValuePair<Type, int> pair in plugins)
            ((IScanner)Activator.CreateInstance(pair.Key)).Scan(
                c.GetData(pair.Value.offset, pair.Value.length);
    }
} 
```

或者

```
// parts identified by name, block length stored within content (as in diagram above)
class MainApp{
    Dictionary<string, Type> plugins = new Dictionary<string, Type>();

    public void RegisterPlugin(Type type, string partID){
        plugins[partID] = type;
    }

    public void ScanContent(Container c){
        foreach(IPart part in c.GetParts()){
            Type type;
            if(plugins.TryGetValue(part.ID, out type))
                ((IScanner)Activator.CreateInstance(type)).Scan(part.Data);
        }
    }
} 
```

显然，我已经极大地简化了这些示例，但希望你能明白。此外，如果您可以将工厂（或工厂委托）传递给该方法，而不是使用`Activator.CreateInstance`，那就太好了。`RegisterPlugin`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T17:44:47.170

我将尝试... ;-) 如果在您的系统中有一个阶段，当您填充`IScanner`对象的“目录”时，您可以考虑使用说明他们感兴趣`IScanner`的属性来装饰您的 s 。然后您可以映射`Part`此信息并使用地图驱动您的扫描`Composite`。这不是一个完整的答案：如果我有一点时间，我会尝试详细说明......

编辑：一些伪代码来支持我的困惑解释

```
public interface IScanner
{
    void Scan(IPart part);
}

public interface IPart
{
    string ID { get; }
}

[ScannedPart("your-id-for-A")]
public class AlphaScanner : IScanner
{
    public void Scan(IPart part)
    {
        throw new NotImplementedException();
    }
}

[ScannedPart("your-id-for-B")]
public class BetaScanner : IScanner
{
    public void Scan(IPart part)
    {
        throw new NotImplementedException();
    }
}

public interface IComposite
{
    List<IPart> Parts { get; }
}

public class ScannerDriver
{
    public Dictionary<string, IScanner> Scanners { get; private set; }

    public void DoScan(IComposite composite)
    {
        foreach (IPart part in composite.Parts)
        {
            IScanner scanner = Scanners[part.ID];
            scanner.Scan(part);
        }
    }
} 
```

不要照原样：这是为了解释的目的。

编辑：回答内核上校的评论。我很高兴你觉得这很有趣。:-) 在这个简单的代码反射草图中，应该仅在字典初始化期间（或在需要时）涉及，并且在此阶段您可以“强制”属性的存在（甚至使用其他映射扫描仪和部件的方式）。我说“强制”是因为，即使它不是编译时约束，我认为您在将代码投入生产之前*至少会运行一次；-) 因此，如果需要，它可能是运行时约束。*我会说灵感是（非常非常轻微地）类似于[MEF](http://www.codeplex.com/MEF)或其他类似框架的东西。只是我的2美分。

# visual-studio - 要制作的 Visual Studio

> ID：421126
> 
> 赞同：2
> 
> 时间：2009-01-07T17:01:58.037
> 
> 标签：visual-studio, makefile

虽然我喜欢 Unix 工具集系列（包括它的害群之马 Make），但我目前正在从事的项目是跨平台的。这意味着准备好构建 Visual Studio 项目。

所以我的问题是，**是否有用于将 Make 文件导入 VS 的工具/插件，或者相反是否有将 Visual Studio 项目导出到 Make 的方法？**或者任何文本形式，实际上。我可以编写一个脚本，将其解析为 Make 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T17:10:46.863

我建议使用[Cmake](http://www.cmake.org/) ... 进行制作，这将生成一组 makefile 或一个 Visual Studio 项目。

# .net-2.0 - 如何防止未经授权的代码访问我在 .NET 2.0 中的程序集？

> ID：421137
> 
> 赞同：7
> 
> 时间：2009-01-07T17:03:58.093
> 
> 标签：.net-2.0, code-access-security

在 .NET 1.x 中，您可以在程序集上使用[StrongNameIdentityPermissionAttribute](http://msdn.microsoft.com/en-us/library/system.security.permissions.strongnameidentitypermissionattribute.aspx)，以确保只有您签名的代码才能访问您的程序集。根据 MSDN 文档，

> 在 .NET Framework 2.0 版及更高版本中，如果调用程序集具有完全信任，则对标识权限的要求无效。

这意味着任何完全信任的应用程序都可以绕过我的安全要求。

如何防止未经授权的代码访问我在 .NET 2.0 中的程序集？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T20:25:08.827

根据 Eric 的建议，我通过自己检查密钥来解决它。在我要保护的代码中，我添加了以下调用，

```
EnsureAssemblyIsSignedByMyCompany( Assembly.GetCallingAssembly() ); 
```

然后该方法的实现是

```
 /// <summary>
  /// Ensures that the given assembly is signed by My Company or Microsoft.
  /// </summary>
  /// <param name="assembly"></param>
  private static void EnsureAssemblyIsSignedByMyCompany( Assembly assembly )
  {
     if ( assembly == null )
        throw new ArgumentNullException( "assembly" );

     byte[] pubkey = assembly.GetName().GetPublicKeyToken();
     if ( pubkey.Length == 0 )
        throw new ArgumentException( "No public key token in assembly." );

     StringBuilder builder = new StringBuilder();
     foreach ( byte b in pubkey )
     {
        builder.AppendFormat( "{0:x2}", b );
     }
     string pkString = builder.ToString();
     if ( pkString != "b77a5c561934e089" /* Microsoft */ &&
          pkString != "abababababababab" /* Ivara */ )
     {
        throw new ArgumentException( "Assembly is not signed by My Company or Microsoft. You do not have permission to call this code." );
     }
  } 
```

** 更改名称和密钥以保护无辜者。任何与真实姓名或公司的相似之处都只是巧合。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T17:15:24.093

请参阅这篇文章：http:
[//blogs.msdn.com/ericlippert/archive/2008/10/06/preventing-third-party-derivation-part-two.aspx](http://blogs.msdn.com/ericlippert/archive/2008/10/06/preventing-third-party-derivation-part-two.aspx)

特别是这部分：

> 在最新版本的 .NET 中，“完全信任意味着完全信任”。也就是说，完全可信的代码满足所有需求，包括诸如“用这个密钥签名”之类的需求，无论它是否真的被签名。
> 
> 这不是安全系统的致命缺陷吗？不，完全受信任的代码总是有能力做到这一点，因为完全受信任的代码有能力控制与给定程序集相关的证据。如果您可以控制证据，那么您可以伪造一个看起来像是来自微软的程序集，没问题。（如果您的进程中已经有恶意的完全信任代码，那么您已经失败了——它不需要模拟 Microsoft 签名的程序集；它已经有权执行用户可以执行的任何操作。）

显然，.Net 设计者认为这个属性对于 .Net 1.x 中的完全信任代码也不是很有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T18:34:02.717

正如乔尔所指出的，您在 CAS 方面不走运。但是，您可以通过使用 Assembly.GetCallingAssembly() 以获取对包含调用代码的程序集的引用，然后手动检查该程序集上的强名称，以您需要保护的任何方法自己进行检查。

# c - C中的舍入快捷方式

> ID：421139
> 
> 赞同：2
> 
> 时间：2009-01-07T17:04:07.767
> 
> 标签：c, rounding

我正在使用 C 来实现伪代码，上面写着：

```
delay = ROUND(64*(floatDelay - intDelay))
where intDelay = (int) floatDelay 
```

floatDelay 将始终为正。使用 math.h 中的 round 函数是否有优势：

```
#inlcude <math.h>
delay=(int) round(64*(floatDelay-intDelay)); 
```

或者我可以使用：

```
delay=(int)(64*(floatDelay - intDelay) + 0.5)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T17:11:28.830

我所知道的没有任何优点，除了强制转换为 int 对其他程序员来说可能不会立即显而易见，它就像一个 trunc...

而使用圆形功能，您的意图很明确。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T17:12:50.963

两者都可以，只要你说`floatDelay`的是肯定的。

一个可能比另一个稍微快一点，尽管如果没有基准测试很难判断哪个，因为它`round()`很可能作为编译器内在函数实现。更有可能的是，任何速度差异都压倒性地不重要，因此请使用您认为更清晰的任何一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T18:24:25.000

在处理浮点数时，您应该始终使用适当的数学库。浮点数可能只是实际值的非常接近的近似值，这可能会导致奇怪。

例如，5f 可能近似为 4.9999999...，如果您尝试直接转换为 int，它将被截断为 4。

要深入了解原因，您应该在 wikipedia 上查找浮点数。但简而言之，它不是将数字存储为像 int 那样的一系列位，而是存储在两个部分中。有一个“分数”和一个指数，其中浮点数的最终值为分数 *（基数 ^ 指数）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T20:41:06.627

> 例如，5f 可能近似为 4.9999999...，如果您尝试直接转换为 int，它将被截断为 4。

这是真的吗？

如果您确保在截断为 int 之前添加 0.5，
那么 4.9999 确实是个问题。

我的意思是：4.9999+0.5=5.4999 -> 5

/约翰

# asp.net-mvc - 如何在 ASP.Net MVC 控制器操作中动态切换视图引擎？

> ID：421143
> 
> 赞同：1
> 
> 时间：2009-01-07T17:05:03.117
> 
> 标签：asp.net-mvc

我想编写一个返回自定义文本（如逗号分隔）的自定义视图引擎有谁知道我将如何动态更改视图引擎来处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T17:13:57.060

我会创建一个自定义 ActionResult。当我需要 JSON 作为响应时，我使用 Json() 函数返回 JsonResult。我使用此代码使用 JSON 数据填充 ExtJS 树。

```
 public JsonResult Folders(string node)
    {

        var relativePath = (node == "root") ? "" : node;
        var path = Path.Combine(BASE_PATH, relativePath);
        var folder = new DirectoryInfo(path);
        var subFolders = folder.GetDirectories();
        var folders = new List<ExtJsTreeNode>();
        foreach (var subFolder in subFolders)
        {
            folders.Add(new ExtJsTreeNode(subFolder.Name, subFolder.FullName.Replace(BASE_PATH, ""), "folder"));
        }
        return Json(folders);

    }

    private class ExtJsTreeNode
    {

        public string text { get; set; }
        public string id { get; set; }
        public string cls { get; set; }

        public ExtJsTreeNode(string text, string id, string cls)
        {
            this.text = text;
            this.id = id;
            this.cls = cls;
        }

    } 
```

[此处](http://blog.maartenballiauw.be/post/2008/05/ASPNET-MVC-custom-ActionResult.aspx)是自定义 ActionResult 的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T17:12:23.913

如果我正确理解了您的问题，您希望根据传递给控制器​​的参数使用不同的视图。如果是这样，您可以在控制器操作中使用此语句：

```
return View("ViewName"); 
```

否则，请澄清您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T17:15:32.050

除了将数据发送到哪个 View 之外，您的控制器不应该知道或关心这一点。视图可以以任何可以想象的格式呈现。我有发出 RSS (XML) 等的视图。在控制器中，要么将其发送到默认视图，要么显式识别目标视图。

# vbscript - ldap vbscript：msExchOmaAdminWirelessEnable 在不同帐户上随机丢失

> ID：421154
> 
> 赞同：0
> 
> 时间：2009-01-07T17:08:04.420
> 
> 标签：vbscript, active-directory, ldap, exchange-server, exchange-server-2003

在我的脚本中：

```
Function getDescript (strname, uname) 

    Set MyUser = GetObject ("LDAP://cn=" & uname & ",ou=" & strname & ",DC=tms-1,DC=net")

getDescript = myUser.Get("msExchOmaAdminWirelessEnable")
End Function

uname = "Bob Gardner"
strname = "bgConsultants"

WScript.Echo "wireless enable: " & getDescript(strname, uname) 
```

我注意到，当我在 sysinternals 的活动目录资源管理器中检查 msExchOmaAdminWirelessEnable 属性时，同一 OU 中的某些用户有时会，有时没有。所有用户都在同一个 OU 中，并且 Exchange 2003 服务器安装了 sp2。

任何人都可能知道这是为什么？

*更新：我发现如果我为每个用户禁用并重新启用 Outlook Mobile Access 设置，msExchOmaAdminWirelessEnable 属性会再次显示那些缺少该属性的用户......奇怪......*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T17:49:53.450

根据 Microsoft 的说法，默认情况下，当您安装 Microsoft Exchange Server 2003 时，允许所有用户使用 Microsoft Outlook Mobile Access 的选项在 Active Directory 用户和计算机中打开。所以这会让我相信这个值只存在于已切换设置的帐户中。您可能可以做一个简单的 ADSI 以仅返回没有设置此设置或未设置启用的用户，请参阅此处以获取良好的 ADSI 参考：[http ://www.rlmueller.net/ADOSearchTips.htm](http://www.rlmueller.net/ADOSearchTips.htm)

~~[“默认情况下，当您安装 Microsoft Exchange Server 2003 时，允许所有用户使用 Microsoft Outlook Mobile Access 的选项在 Active Directory 用户和计算机中打开。”](http://support.microsoft.com/kb/830188)~~

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-31T19:01:24.467

答案是对的，用户属性`msExchOmaAdminWirelessEnable`值默认为空（oma 工作）。当 oma 被禁用时，值为 7 (4+2+1)，当 oma 再次启用时，值为 0。我制作了一些 oma 脚本，它们可以在以下位置找到：

[http://deludi.nl/blog/vbscript/active-directory/outlookmobileaccess/active-directory-vbscript-to-disable-outlook-mobile-access-oma-for-all-users-in-your-company/](http://deludi.nl/blog/vbscript/active-directory/outlookmobileaccess/active-directory-vbscript-to-disable-outlook-mobile-access-oma-for-all-users-in-your-company/)

# c# - 为什么我不能在 foreach 中添加 Dictionary(Key, Value)？

> ID：421155
> 
> 赞同：2
> 
> 时间：2009-01-07T17:08:23.657
> 
> 标签：c#, dictionary, foreach

如果我想遍历 Dictionary(Key, Value)... 为什么不能在循环中添加新的键值对？

```
Dictionary<string, string> persons = new Dictionary<string, string>();

persons.Add("roger", "12");
persons.Add("mary", "13");

foreach (KeyValuePair<string,string> person in persons)
{
 Console.WriteLine("Name: " + person.Key + ", Age: " + person.Value);
 persons.Add("Xico", "22");
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-07T17:13:23.147

这是因为枚举器的构造方式。

来自 MSDN [Dictionary.Enumerator](http://msdn.microsoft.com/en-us/library/k3z2hhax.aspx)：

> 只要集合保持不变，枚举数就保持有效。如果对集合进行了更改，例如添加、修改或删除元素，则枚举器将不可恢复地失效，并且其行为未定义。

不过，解决这个问题很容易。只需制作字典（或其键）的副本并遍历它，添加/删除/等。根据需要从原始字典中获取。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-07T17:10:24.620

枚举时不能修改字典，就这么简单。否则你什么时候知道你已经完成了？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-07T17:12:02.073

如果您想这样做，您应该获取 Dictionary Object 的副本（可以通过多种方式完成）然后枚举它，将您想要的内容添加到原始对象中。

只是在枚举字典时不能添加新项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T17:13:55.250

枚举集合（即foreach 循环）时，无法从集合中添加或删除项目。想想如果允许的话会带来的所有问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T17:10:04.480

那只是……奇怪。您正在尝试为字典中已有的每个人再次添加同一个人。

另外：为什么将年龄存储为字符串？int（甚至 DateTime）似乎更合适。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T17:12:28.110

因为它会改变你正在滚动的字典的项目......它没有意义......（你可能会永远循环）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T17:14:40.443

您试图在遍历循环时更改集合中的条目数。for 循环可以完成此操作，但 foreach 迭代器不允许您这样做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T17:17:34.183

```
Dictionary<string, string> persons = new Dictionary<string, string>();
persons.Add("roger", "12");
persons.Add("mary", "13");
for (int i = 0; i < persons.Count; i++){ 
Console.WriteLine("Name: " + persons[i].Key + ", Age: " + persons[i].Value); 
persons.Add("Xico", "22");
} 
```

请注意，这是一个无限循环，因为您总是在到达最后一个条目之前添加一个人。

# installation - 是否可以使用 InstallShield 2009 在卸载期间运行自定义操作

> ID：421170
> 
> 赞同：1
> 
> 时间：2009-01-07T17:12:10.823
> 
> 标签：installation, action, installshield

我需要在卸载作为安装一部分的 ManagedCode 期间运行自定义操作（在卸载过程中将其删除之前）在 Install Shield 2009 中是否可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T21:09:46.150

是的。您可以在卸载过程中运行 ManagedCode 自定义操作。您只需在 Install Exec Sequence 中对其进行排序，条件为`REMOVE="ALL"`. InstallShield 只是微软 MSI 技术的一个包装器，所以很多时候最好去 MSDN 寻求帮助以了解您想要做什么。例如，此条目应该可以帮助您安排您的操作， http: [//msdn.microsoft.com/en-us/library/aa371626 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa371626(VS.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T20:36:08.383

至少在我的 IntallShield Express 11 中，我可以在几个不同的地方有自定义操作卸载。

# c# - 我可以更改默认配置文件吗？

> ID：421174
> 
> 赞同：3
> 
> 时间：2009-01-07T17:12:48.140
> 
> 标签：c#, .net

我正在使用 Jeff Atwood 的[Last Configuration Section Handler You'll Ever Need](http://www.codinghorror.com/blog/archives/000656.html)，但它似乎只适用于默认的 app.config 文件。如果我想将某些设置分离到另一个文件中，则反序列化不起作用，因为 ConfigurationManager.GetSection 仅从应用程序的默认 app.config 文件中读取。是否可以更改默认配置文件的路径或将 ConfigurationManager 指向第二个配置文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T17:27:55.847

是的，只需将默认配置文件中的部分替换为具有指向另一个文件的 configSource="" 属性的同名 xml 元素...

...在您的 App.config 或 web.config...

```
 <configSections>
      <section name="Connections"
         type="BPA.AMP.Configuration.XmlConfigurator, BPA.AMP.Data.Config.DAL"/>
      <section name="AutoProcessConfig"
         type="BPA.AMP.Configuration.XmlConfigurator, BPA.AMP.Data.Config.DAL"/>
  </configSections>

  <Connections configSource="Config\Connections.config" />
  <AutoProcessConfig configSource="Config\AutoProcess.config" /> 
```

然后是常见的xml；Configurator类

```
 public class XmlConfigurator : IConfigurationSectionHandler
    {
        public object Create(object parent, 
                          object configContext, XmlNode section)
        {
            XPathNavigator xPN;
            if (section == null || (xPN = section.CreateNavigator()) == null ) 
                 return null;
            // ---------------------------------------------------------
            Type sectionType = Type.GetType((string)xPN.Evaluate
                                    ("string(@configType)"));
            XmlSerializer xs = new XmlSerializer(sectionType);
            return xs.Deserialize(new XmlNodeReader(section));
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T17:29:29.650

您可以手动执行此操作，方法是将文档作为 XDocument 打开，找到适当的部分并将其传递给您的配置部分处理程序。

```
XDocument configDoc = XDocument.Load( alternateConfigFile );

var section = configDoc.Descendants( "sectionName" ).First();

var obj = sectionHandler.Create( null, null, section ); 
```

# python - 如何使用 Python imaplib 为 IMAP (Gmail) 启用推送通知？

> ID：421178
> 
> 赞同：26
> 
> 时间：2009-01-07T17:13:32.863
> 
> 标签：python, gmail, imap

有没有一种方法可以使用 imaplib 监控 gmail 帐户，而无需每次我想查看是否有新邮件时轮询 gmail。或者换句话说，我只想通知脚本有新消息，以便我可以立即处理它，而不是轮询之间的任何滞后时间。

我看到 IMAP 协议通过 IDLE 命令支持这一点，但我在 imaplib 文档中看不到任何与它相关的文档，因此对此的任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-07T18:04:46.663

imaplib 中没有任何东西可以做到这一点，AFAIK（免责声明：我对 Python 知之甚少），但是，似乎有人已经为 Python 实现了一个 IDLE 扩展，它具有与 imaplib 相同的接口（你可以用显然，对现有代码没有任何更改）：

[https://github.com/imaplib2/imaplib2](https://github.com/imaplib2/imaplib2)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-14T06:44:40.800

查看[ProcImap](http://packages.python.org/ProcImap/)。它是在 libimap 和 libimap2 之上的一个更抽象的框架，为处理 IMAP 服务提供了一个很好的解决方案。看起来就像你正在寻找的东西，对我来说也是如此。我对你有同样的问题，刚刚找到了 ProcImap。我自己试试吧。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-01-28T21:23:28.717

此链接显示了使用 IMAP IDLE 的示例：http: [//blog.timstoop.nl/2009/03/11/python-imap-idle-with-imaplib2/](http://blog.timstoop.nl/2009/03/11/python-imap-idle-with-imaplib2/)

它使用与 casperOne 的答案（imaplib2）中链接的相同库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-19T20:26:11.600

[bugs.python.org](http://bugs.python.org/issue11245)提出了一个简单的[补丁](http://bugs.python.org/file27400/imapidle.patch)，以同步方式实现 [RFC 2177 IMAP IDLE] [3](https://www.rfc-editor.org/rfc/rfc2177)命令（要等待超过 1 个 IMAP 服务器，您必须使用线程或其他并行执行方式）。它使用 stdlib select 等待套接字，包括超时。这个补丁[最终](http://bugs.python.org/issue11245#msg171889)会被添加到标准库中，[但必须先编写测试](http://bugs.python.org/issue11245#msg172383)。[IDLE](https://www.rfc-editor.org/rfc/rfc2177)命令是gmail IMAP 推送通知[所需](https://blogs.oracle.com/chienr/entry/gmail_supports_imap_idle)的。希望，这会有所帮助:)

# c# - 导出到excel时线程被中止？

> ID：421199
> 
> 赞同：4
> 
> 时间：2009-01-07T17:21:32.100
> 
> 标签：c#, asp.net, exception

我有一个绑定到 GridView 的 DataTable。我还有一个按钮，单击该按钮可将 DataTable 导出到 Excel 文件。但是，出现以下错误：

ErrMsg = "线程被中止。"

以下是引发错误的部分代码：

```
private static void Export_with_XSLT_Web(DataSet dsExport, 
                                         string[] sHeaders,
                                         string[] sFileds, 
                                         ExportFormat FormatType,
                                         string FileName)
{
    try
    {
        // Appending Headers
        HttpContext.Current.Response.Clear();
        HttpContext.Current.Response.Buffer = true;

        if(FormatType == ExportFormat.CSV)
        {
            HttpContext.Current.Response.ContentType = "text/csv";
            HttpContext.Current.Response.AppendHeader("content-disposition",
                                                      "attachment; 
                                                      filename=" + FileName);
        }
        else
        {
            HttpContext.Current.Response.ContentType = "application/vnd.ms-excel";
            HttpContext.Current.Response.AppendHeader("content-disposition", 
                                                      "attachment; 
                                                      filename=" + FileName);
        }

        // XSLT to use for transforming this dataset.                       
        MemoryStream stream = new MemoryStream();
        XmlTextWriter writer = new XmlTextWriter(stream, Encoding.UTF8);

        CreateStylesheet(writer, sHeaders, sFileds, FormatType);
        writer.Flush();
        stream.Seek(0, SeekOrigin.Begin);

        XmlDataDocument xmlDoc = new XmlDataDocument(dsExport);
        //dsExport.WriteXml("Data.xml");
        XslTransform xslTran = new XslTransform();
        xslTran.Load(new XmlTextReader(stream), null, null);

        using(StringWriter sw = new StringWriter())
        {
            xslTran.Transform(xmlDoc, null, sw, null);

            //Writeout the Content              
            HttpContext.Current.Response.Write(sw.ToString());                
            writer.Close();
            stream.Close();
            HttpContext.Current.Response.End();
        }
    }
    catch(ThreadAbortException Ex)
    {
        string ErrMsg = Ex.Message;
    }
    catch(Exception Ex)
    {
        throw Ex;
    }
    finally
    {

    }
} 
```

将 HttpContext.Current.Response.End 更改为 HttpContext.Current.ApplicationInstance.CompleteRequest 后，它现在只是进入 finally 块，我无法弄清楚抛出了什么错误消息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T17:25:45.727

ThreadAbortException 从以下行引发：

```
HttpContext.Current.Response.End(); 
```

这是更多[详细信息](http://support.microsoft.com/kb/312629)和解决方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-01T11:43:51.007

我尝试使用`HttpContext.Current.ApplicationInstance.CompleteRequest`. 它确实有效，但还在下载文件的末尾导出了页面的完整 HTML 代码，这是不可取的。

```
Response.BuffferOutput = True;
Response.Flush();
Response.Close(); 
```

然后经过一番努力，我碰到了上面的代码。它可以完美运行，在下载文件的末尾没有任何异常或不需要的代码。

[来源](http://forums.asp.net/post/2270919.aspx "来源")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-27T01:45:54.237

异常是由`Response.End`

您可以做的一件事是在逻辑上捕获异常消息......

此方法不会影响数据，但只会捕获异常...

```
Try

    .........(codes here)
    Response.End

Catch ex as Message

    If Not ex.Message = "Thread was being aborted." Then
         Response.write(ex.message)
    End If

End Try 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T18:33:08.380

我在这里有不同的故事，我正在使用**Telerik**控件并且 NONE 帮助了我，最终我知道我必须将我的标记包装在**telerik:RadAjaxPanel**中，下面是在 RequestStart 客户端事件处理程序上禁用 ajax 的代码片段。

```
<telerik:RadAjaxPanel runat="server" 
    ClientEvents-OnRequestStart="AjaxRequestStart"> 
```

然后在我的用户控件中，我又添加了一项功能，如下图所示：

```
<script type="text/javascript">
    function AjaxRequestStart(target, arguments) {
        arguments.set_enableAjax(false);
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-02-23T11:14:20.933

很简单，你可以试试：

`Response.Close();`代替`Response.End();`

# c++ - 你能让 Visual Studio 2005 为你的启动程序提供命令行参数吗？

> ID：421203
> 
> 赞同：6
> 
> 时间：2009-01-07T17:23:36.340
> 
> 标签：c++, visual-studio-2005, visual-c++-2005

出于测试目的，在 Visual Studio IDE 中是否有某个地方可以指定从 IDE 启动时要发送到启动项目的命令行参数？

提前感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-07T17:25:46.430

是的 - 单击项目的属性，然后单击调试，然后单击命令参数。您可以在那里输入命令行参数，它们将在启动时传递给您的应用程序。

# css - CSS 性能问题

> ID：421205
> 
> 赞同：4
> 
> 时间：2009-01-07T17:24:23.857
> 
> 标签：css, performance

样式表 (CSS) 的哪些方面会导致网站性能不佳？有什么东西可以真正阻塞 CPU 吗？

提前致谢。

塞什

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T17:26:33.650

如果过度使用，IE 表达式可能会成为杀手。每次应用规则时，都会重新评估它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T17:30:55.140

CSS？与其说它很紧，但在较旧的（如第 4 代）浏览器上，我发现了以下问题：

*   `*`在选择器上做的太多
*   `inherit`大量使用
*   滥用 IE 表达式值
*   加载大量外部资源（图像、其他 CSS 文档）
*   应用很多你可能称之为非锚定选择器的东西，比如`div div`

基本上任何难以级联或级联很多的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T17:38:33.517

浏览器非常擅长快速渲染 CSS 规则。

可能更重要的是 CSS 文件的大小。对于大多数站点，这不是问题，但对于较大的站点，这是需要注意的。

例如，[cnn.com](http://cnn.com)提供了 150K 的 CSS。这在旧调制解调器上需要几秒钟，所以 CNN 应该确保他们的 CSS 是可缓存和 gzip 的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T17:27:50.653

我个人从未在 CSS 中遇到过任何可以做到这一点的东西。Flash 内容和过大的页面更有可能降低浏览器的速度。也就是说，我会过度使用表达式或自定义 IE 过滤器（通常用于 PNG 图像的透明度）可能会占用大量 CPU。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T17:40:20.207

让不太旧的浏览器窒息的是巨大的背景，它使用“ `background-position: fixed`”a la [Complexspiral Redux](http://meyerweb.com/eric/css/edge/complexspiral/glassy.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T22:11:20.797

很难影响 CPU（除了 IE 表达式，如 sblundy 提到的），但很容易影响页面加载时间。

尝试遵循[Yahoo 客户端性能指南](http://developer.yahoo.com/performance/rules.html)，例如：

*   将 CSS 链接放在页面顶部
*   使用`<link>`代替`@import`
*   合并 CSS 文件
*   缩小 CSS 文件

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T22:15:52.850

我见过高分辨率平铺背景图像（通常为 jpg 或 png）在滚动时会导致严重减速（断断续续的效果）的情况。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T22:24:37.167

最有可能的是，CSS 文件并没有像访问服务器、复杂计算等那样使站点阻塞。但如果是：

*   至少可以说，编写一个不断发展的轻量级但有效的 css 文件系统是一门艺术。例如，有效地使用类和 ID 来利用级联可能会很困难，尤其是当项目随着时间的推移而演变时，或者如果编写它的 GUI 在生命周期中被多次替换时。

*   对于您必须支持的每个旧版浏览器，它都会增加性能损失，特别是如果您使用黑客来完成它。这些可能很棘手，尤其是如果彼此分层。条件注释是类似的——浏览器必须破译它遵循哪些规则，并在呈现之前通读*所有内容。*

*   当您可以在背景上平铺或设置颜色时，使用全尺寸图像也会拖累网站加载。

*   （免费拍摄） IE 可能需要很长时间才能错误渲染您的样式和元素。

# python - 在 Python 中，我如何使用子进程而不是 os.system？

> ID：421206
> 
> 赞同：3
> 
> 时间：2009-01-07T17:24:50.563
> 
> 标签：python, syntax, scripting, process

我有一个 Python 脚本，它调用具有各种参数的可执行程序（在本例中，它是“sqlpubwiz.exe”，即“Microsoft SQL Server 数据库发布向导”）：

```
import os

sqlpubwiz = r'"C:\Program Files\Microsoft SQL Server\90\Tools\Publishing\sqlpubwiz.exe"'
server = 'myLocalServer'
database = 'myLocalDatabase'
connection_values = ['server=' + server, 'database=' + database, 'trusted_connection=true']
connection_string = ';'.join(connection_values)
dbms_version = '2000'
sqlscript_filename = 'CreateSchema.sql'

args = [
        sqlpubwiz,
        'script',
        '-C ' + connection_string,
        sqlscript_filename,
        '-schemaonly',
        '-targetserver ' + dbms_version,
        '-f',
]

cmd = ' '.join(args)
os.system(cmd) 
```

该代码运行正常，但我想养成使用[子](http://docs.python.org/library/subprocess)进程的习惯，因为它旨在替换 os.system。但是，经过几次失败的尝试后，我似乎无法使其正常工作。

如果将上面的代码转换为使用 subprocess 代替 os.system，它会是什么样子？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T17:31:02.533

```
import subprocess
p=subprocess.Popen(args, stdout=subprocess.PIPE)
print p.communicate()[0] 
```

它看起来几乎一样。但是路径不应该是 r'"无论路径是什么"'。因为这给了我一个错误。您想要“带有转义反斜杠的路径”或“没有转义的路径”。

args 的形式也应该是 ['-arg', 'args'] 而不是 ['arg argsval']。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T17:44:36.703

从可执行文件的名称中删除引号。在您示例的第一行，而不是

```
sqlpubwiz = r'"C:\Program Files\Microsoft SQL Server\90\Tools\Publishing\sqlpubwiz.exe"' 
```

采用：

```
sqlpubwiz = r'C:\Program Files\Microsoft SQL Server\90\Tools\Publishing\sqlpubwiz.exe' 
```

那是因为您不必逃避任何东西，因为不会涉及外壳。

然后只需使用`subprocess.call(args)`（不要使用`join`参数，将它们作为列表传递）

如果您想捕获输出（`os.system`不能这样做），只需遵循[子流程](http://docs.python.org/library/subprocess.html)文档：

```
result = subprocess.Popen(args, stdout=subprocess.PIPE).communicate()[0]
print result 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T18:31:59.913

以下是我根据[Carlos Rendon](https://stackoverflow.com/questions/421206/in-python-how-i-do-use-subprocess-instead-of-os-system#421228)（和[nosklo](https://stackoverflow.com/questions/421206/in-python-how-i-do-use-subprocess-instead-of-os-system#421269)）帮助和建议修改后的代码：

```
# import os
import subprocess    

sqlpubwiz = r'C:\Program Files\Microsoft SQL Server\90\Tools\Publishing\sqlpubwiz.exe'
server = 'myLocalServer'
database = 'myLocalDatabase'
connection_values = ['server=' + server, 'database=' + database, 'trusted_connection=true']
connection_string = ';'.join(connection_values)
dbms_version = '2000'
sqlscript_filename = 'CreateSchema.sql'       

args = [
            sqlpubwiz,
            'script',
            '-C',
            connection_string,
            sqlscript_filename,
            '-schemaonly',
            '-targetserver',
            dbms_version,
            '-f',
    ]   

# cmd = ' '.join(args)
# os.system(cmd)

subprocess.call(args) 
```

（注意：包含空格的原始参数值需要转换为单独的列表项。）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T19:41:10.820

仅供参考，`subprocess`有一个`list2cmdline()`函数可以让你看到`Popen`将要使用的字符串。

你的版本给出：

```
'"C:\\Program Files\\Microsoft SQL Server\\90\\Tools\\Publishing\\sqlpubwiz.exe" script "-C server=myLocalServer;database=myLocalDatabase;trusted_connection=true" CreateSchema.sql -schemaonly "-targetserver 2000" -f' 
```

`"-C server=myLocalServer;database=myLocalDatabase;trusted_connection=true"`和周围有额外的引号`"-targetserver 2000"`。

正确格式化：

```
args = [
        sqlpubwiz,
        'script',
        '-C', connection_string,
        sqlscript_filename,
        '-schemaonly',
        '-targetserver', dbms_version,
        '-f',
] 
```

给出：

```
'"C:\\Program Files\\Microsoft SQL Server\\90\\Tools\\Publishing\\sqlpubwiz.exe" script -C server=myLocalServer;database=myLocalDatabase;trusted_connection=true CreateSchema.sql -schemaonly -targetserver 2000 -f' 
```

另外，次要的一点，但是使诸如`args`不需要可变为元组而不是列表的序列是一个好习惯。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T18:11:02.547

请记住 os.system 使用 shell，所以你必须真正通过

```
shell=True 
```

到 Popen 构造函数/调用以正确模拟它。当然，您实际上可能不需要外壳，但它确实存在。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T18:22:03.833

这不是直接回答您的问题，但我认为它可能会有所帮助。

如果您想要更精细地控制异常处理等返回的内容，您还可以查看[**pexpect**](http://www.noah.org/wiki/Pexpect)。我曾在我调用的进程不一定以正常状态信号退出的情况下使用它，或者我想与它进行更多交互。这是一个非常方便的功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T19:55:04.567

Windows 命令将接受正斜杠“/”代替路径名中的反斜杠，因此您可以使用前者来避免在命令字符串中转义反斜杠。不完全是您问题的答案，但可能有用。

# python - 使用 python 运行未导出的 .dll 函数

> ID：421223
> 
> 赞同：5
> 
> 时间：2009-01-07T17:30:21.927
> 
> 标签：python, memory, ctypes

这似乎是一个奇怪的问题，但我想知道如何从内存“签名”中运行 .dll 中的函数。我不太了解它的实际工作原理，但我非常需要它。如果您知道它的内存签名和地址，它是一种从 .dll 中运行未导出函数的方法。例如，我有这些：

```
respawn_f "_ZN9CCSPlayer12RoundRespawnEv"
respawn_sig "568BF18B06FF90B80400008B86E80D00"
respawn_mask "xxxxx?xxx??xxxx?" 
```

并且使用一些非常漂亮的 C++ 代码，您可以使用它在 .dll 中运行函数。

这是一篇解释得很好的文章： [http ://wiki.alliedmods.net/Signature_Scanning](http://wiki.alliedmods.net/Signature_Scanning)

那么，是否可以使用 Ctypes 或任何其他方式在 python 中执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-10T03:45:30.897

如果您已经可以使用 C++ 运行它们，那么您可以尝试使用 SWIG 为您编写的 C++ 代码生成 python 包装器，使其可从 python 调用。

[http://www.swig.org/](http://www.swig.org/)

我使用 SWIG 发现的一些警告：

Swig 根据字符串值查找类型。例如，Python 中的整数类型 (int) 会确保 cpp 类型是“int”，否则 swig 会抱怨类型不匹配。没有自动转换。

Swig 逐字复制源代码，因此即使在同一命名空间中的对象也需要完全限定，以便 cxx 文件能够正确编译。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T19:41:12.077

您说您正在尝试调用未导出的函数；据我所知，这在 Python 中是不可能的。但是，您的问题似乎仅仅是名称被破坏了。

您可以使用 ctypes 调用任意导出。由于名称被破坏，并且不是有效的 Python 标识符，您可以使用 getattr()。

如果您有正确的信息，另一种方法是按序号查找导出，如果根本没有导出名称，则必须这样做。获得序数的一种方法是使用包含在许多 Windows 编译语言中的 dumpbin.exe。它实际上是链接器的前端，所以如果你有 MS LinK.exe，你也可以将它与适当的命令行开关一起使用。

要获取函数引用（这是一个绑定到它的地址的“函数指针”对象），您可以使用以下内容：

导入 ctypes func = getattr(ctypes.windll.msvcrt, "@@myfunc") retval = func(None)

自然地，你会用你特别想调用的 dll 替换“msvcrt”。

我在这里没有展示的是如何解开名称以派生调用签名，从而获得必要的参数。这样做需要一个 demangler，并且这些都非常特定于用于创建 DLL 的 C++ 编译器的品牌*和版本。*

如果函数是stdcall，会有一定数量的错误检查，所以你有时可以摆弄一些东西，直到你把它们弄对为止。但是如果函数是cdecl，那么就没有办法自动检查了。同样，如果合适，您必须记住包含额外的 this 参数。

# ruby-on-rails - 为什么我不能安装 SQLite gem？

> ID：421225
> 
> 赞同：65
> 
> 时间：2009-01-07T17:30:55.467
> 
> 标签：ruby-on-rails, ruby, sqlite, gem

我正在尝试在带有 Ruby 1.8.6、Rails 2.2.2、gem 1.3 和 sqlite-3.5.9 的 Fedora 9 Linux 机器上安装 SQLite gem。这是我正在运行的命令及其结果：

```
sudo gem install sqlite3-ruby
Building native extensions.  This could take a while...
ERROR:  Error installing sqlite3-ruby:
    ERROR: Failed to build gem native extension.

/usr/bin/ruby extconf.rb install sqlite3-ruby
can't find header files for ruby.

Gem files will remain installed in /usr/lib/ruby/gems/1.8/gems/sqlite3-ruby-1.2.4 for inspection.
Results logged to /usr/lib/ruby/gems/1.8/gems/sqlite3-ruby-1.2.4/ext/sqlite3_api/gem_make.out 
```

`gem_make.out`只是重复已经发送到控制台的内容。我怎样才能安装这个宝石？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2009-01-07T18:04:42.123

SQLite RubyGem 实际上并不是一个*Ruby* Gem，它是一个“ *C* Gem”，IOW 它是用 C 编写的。这意味着当你安装它时，它必须被编译并链接到 Ruby 解释器，为了做到*这*一点，它需要Ruby 解释器的 C 头文件。

如果你自己编译 Ruby，这些头文件会被自动安装，然而，在 RedHat-ish 系统中，这些头文件通常打包在一个单独的包中，称为`<whatever>-dev`. 因此，在这种情况下，您将需要安装`ruby-dev`软件包，可能还需要安装`libsqlite3-dev`(Ubuntu) 或`sqlite-devel`(Fedora) 软件包。

但是，最好只安装操作系统的预打`libsqlite3-ruby`包包，这样所有依赖项都会自动得到满足。

（注意：所有的包名都是凭空而来的，在你的系统上可能会有所不同。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-08T02:55:43.313

您可能需要 ruby​​ 开发包。对于 Ubuntu，您必须安装包含 ruby​​ 头文件的 ruby​​1.8-dev。一个快速的谷歌说 yum 包是 ruby​​-devel。所以运行这个：

> sudo yum install ruby​​-devel

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-01-06T10:42:07.623

我在我的 Fedora 13 盒子上安装 sqlite3-ruby gem 时遇到问题。**sudo yum install sqlite-devel**后修复

 *** * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-05-12T12:33:46.633

当我遇到这个问题时：

```
gem install sqlite3 -v '1.3.9'
Building native extensions.  This could take a while...
ERROR:  Error installing sqlite3:
    ERROR: Failed to build gem native extension. 
```

对我来说，安装“ **libsqlite3-dev** ”：

```
apt-get install libsqlite3-dev 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-12-18T10:31:28.107

```
sudo apt-get install ruby-dev 
```

为我修好了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-08-23T21:19:05.507

在 Ubuntu 9 和 10 上尝试：

```
sudo apt-get install ruby-dev
sudo apt-get install sqlite3-dev 
```

然后运行

```
gem install sqlite3 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-07-20T06:08:56.347

为 Fedora 操作系统运行以下命令：

```
yum install rubygem-sqlite3 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-02-13T09:45:02.180

在 alpine 上，您需要安装该`sqlite-dev`软件包。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-08-07T06:41:01.040

我也遇到了同样的问题，问题是您的 Linux 安装需要安装 SQLite3 的开发库才能构建 gem。

**这是我解决问题的方法**

打开终端并运行以下命令

```
sudo apt-get install sqlite3

sudo apt-get install libsqlite3-dev 
```

然后尝试使用此命令再次安装 Sqlite3 gem

```
gem install sqlite3 
```

就这样。

**我希望这有帮助**

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-07T17:44:00.057

你有构建 sqlite3-ruby 所需的所有源代码吗？Gem 正在尝试编译一些 C 代码，但找不到标头。如果您愿意放弃编译，您可能可以为 sqlite3-ruby 使用 fedora rpm（我不使用 fedora，但我确定存在）。就个人而言，对于 ruby​​ 的东西，我更喜欢使用 gem 而不是发行版的包装系统。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-07T17:53:51.630

我对 Fedora 不是很熟悉，但是在 Ubuntu 中，当您安装软件包时，您有 apt-get，并且您必须安装包含 gcc 和其他 C 编译工具的 build-essentials。我会说这可能是您的问题，然后您将了解如何在 Fedora 上使用 RPM 或 apt-get 进行安装。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-15T21:48:32.693

我通过奇怪地安装'gcc'解决了我的OLPC（Fedora 9）上的问题。似乎它应该是那些开发包之一，但不是。

另外，关于其他包，后缀是“-devel”，而不是“-dev”，所以请确保你得到正确的结尾：“ruby-devel”，“sqlite-devel”......

安装完成后，如果在尝试运行各种 rails 脚本（例如：脚本/服务器或脚本/控制台）时遇到有关 gem 太旧“< 1.3.1”的错误，请使用谷歌“upgrade_rubygems”来解决该问题。 ..

HTH...

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-12-21T19:23:57.607

我遇到了同样的问题……我没有在 unbuntu 上使用突触的缺失部分。

对我来说，关键包是 libsqlite-ruby1.9.1 ...我在以下位置记录了我的经验（供参考）： [Sqlite3-gem-error-during-bundle-install](http://ridingwithrails.wordpress.com/2010/12/21/sqlite3-gem-error-during-bundle-install/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-08-01T05:38:51.693

运行“sudo yum install sqlite-devel”，然后运行“gem install sqlite3”。我的 Fedora 15 也有同样的问题。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-04-15T15:50:45.180

我在 Fedora 29 上生成 react-rails 应用程序后运行时遇到此错误`bundle install`。我能够通过运行确定合适的开发包`dnf search sqlite3`，然后安装它`dnf install libsqlite3x-devel`。这为我修好了。

# sql - 在 mySQL 中搜索和替换的 SQL

> ID：421227
> 
> 赞同：4
> 
> 时间：2009-01-07T17:31:02.503
> 
> 标签：sql, mysql

在修复导入不良的数据库的过程中，由于使用错误的数据库编码或类似的原因导致的问题。

无论如何，回到我的问题，为了解决这个问题，我正在使用这种形式的查询：

> UPDATE `table_name`SET field_name = replace(field_name,'search_text','replace_text');

因此，如果我正在处理的表有多个列，我必须为每一列调用这个查询。而且，由于不仅有一对东西要运行查找和替换，我还必须为每一对调用查询。

所以你可以想象，我最终运行了几十个查询来修复一张表。

我想知道是否有一种方法可以在一个查询中组合多个查找和替换，比如，假设查找这组事物，如果找到，则用另一组事物中的对应对替换。

或者，如果有一种方法可以查询我上面显示的表单，以某种方式递归地运行表的每一列，而不管它们的名称或编号如何。

提前感谢您的支持，标题

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T17:48:01.610

让我们尝试分别解决这些问题：

如果您需要执行此操作的每个表中的每一列的替换集都相同（或者只有几个模式），请考虑创建一个用户定义的函数，该函数接受一个 varchar 并返回一个只调用`replace(replace(@input,'search1','replace1'),'search2','replace2')`嵌套的 varchar作为适当的。

要同时更新多个列，您应该能够执行`UPDATE table_name SET field_name1 = replace(field_name1,...), field_name2 = replace(field_name2,...)`或类似的操作。

至于为每个表中的每一列运行类似的东西，我认为编写一些代码来获取列列表并生成要从中执行的查询是最简单的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T17:46:06.123

我不知道在每一列上自动运行搜索和替换的方法，但是`UPDATE`通过嵌套调用可以轻松解决单个查询中的多对搜索和替换术语的问题`replace()`：

```
UPDATE table_name SET field_name =
    replace(
        replace(
            replace(
                field_name,
                'foo',
                'bar'
            ),
            'see',
            'what',
        ),
        'I',
        'mean?'
    ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T18:43:20.063

如果您在同一字段中有多个不同文本的替换，我建议您创建一个包含当前值以及您希望将它们替换为什么的表。（如果这是一次性交易，可能是某种临时表；如果不是，则将其设为永久表。）然后加入该表并进行更新。

就像是：

```
update t1
set field1 = t2.newvalue
from table1 t1
join mycrossreferncetable t2 on t1.field1 = t2.oldvalue 
```

抱歉没有注意到这是 MySQL，代码是我将在 SQL Server 中使用的代码，我的 SQL 语法可能不同但技术相似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T16:35:37.143

我写了一个存储过程来做到这一点。我在每个数据库级别上使用它，尽管很容易将它抽象为跨服务器全局操作。

我只是粘贴这个内联，但似乎我太密集了，无法弄清楚如何使用降价交易，所以代码在这里：

[http://www.anovasolutions.com/content/mysql-search-and-replace-stored-procedure](http://www.anovasolutions.com/content/mysql-search-and-replace-stored-procedure)

# javascript - JQuery 可通过旋钮调整大小

> ID：421231
> 
> 赞同：1
> 
> 时间：2009-01-07T17:31:53.110
> 
> 标签：javascript, jquery, jquery-ui, resizable, jquery-ui-resizable

我正在使用[`jQuery-ui Resizable`](http://docs.jquery.com/UI/Resizable/resizable#options)- 我想使用旋钮而不是边框​​（我的旋钮是右下角的按钮）。

我看到在选项中我有一个`KnobHandles`，我必须设置为`true`。

我在哪里设置我的手柄？我试图在句柄选项中设置它，但它不起作用。

下面是我的代码：

```
window.resizable({
    'handles':'handler-resize',
    'knobHandles': true
}); 
```

更新：刚刚注意到旋钮手柄是一些默认的东西。我想用自定义按钮调整它的大小，有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T17:54:04.000

我做到了，我只需要设置旋钮的样式...

顺便说一句：手柄必须带有方向，如 s、n、se、...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T17:59:09.107

每个句柄字符串（如果指定）应采用 jQuery 选择器的形式，匹配可调整大小的子元素以用作句柄。

所以我认为你想要这样的东西：

```
'handles': '.handler-size' 
```

# perl - 如何在 Perl 中找到两个数组的不区分大小写的唯一元素？

> ID：421232
> 
> 赞同：1
> 
> 时间：2009-01-07T17:33:28.923
> 
> 标签：perl, arrays, grep

我有三个数组。

*   @array1 包含文件名
*   @array2 包含文件名
*   @unique 我想包含独特的项目

我使用以下代码比较两个数组并输出包含唯一文件名的第三个数组。

```
@test{@array1} = ();
@unqiue = grep {!exists $test{$_}} @array2; 
```

但是输出区分大小写，如何将其更改为不区分大小写？

谢谢

* * *

嗨，对不起，我认为我没有很好地提出我的问题！

我保留了一个旧的轨道阵列，其中包含我已经播放过的曲目，然后我有一个要从中选择的新曲目阵列。我想将新轨道与旧轨道阵列进行比较，以确保我只获得唯一的轨道然后从中进行选择。

所以目前的输出是；

```
独特的曲目：
\我的音乐\腐败的灵魂\b-corrupt.mp3
\我的音乐\gta4\10 - Vagabond.mp3
\我的音乐\gta4\14 - 战争是必要的.mp3
\我的音乐\回到黑色\05 回到黑色.mp3

```

我需要的是让结果只返回轨道 10、14 和 05，因为第一个轨道 b-corrupt 已经在旧轨道阵列中，只是情况不同。

在此先感谢您的帮助

```
#!/usr/bin/perl
$element = '\\My Music\\Corrupt Souls\\b-corrupt.mp3';
推（@oldtrackarray，$元素）；

$element = '\\My Music\\Back To Black\\03 我和琼斯先生.mp3';
推（@oldtrackarray，$元素）；

$element = '\\My Music\\Jazz\\Classic Jazz-Funk Vol1\\11 - Till You Take My Love [Original 12 Mix].mp3';
推（@oldtrackarray，$元素）；

$element = '\\我的音乐\\gta4\\01 - 苏联联系（侠盗猎车手IV主题）.mp3';
推（@oldtrackarray，$元素）；

$element = '\\My Music\\gta4\\07 - Rocky Mountain Way.mp3';
推（@oldtrackarray，$元素）；

$element = '\\我的音乐\\gta4\\02 - 肮脏的纽约客.mp3';
推（@oldtrackarray，$元素）；

打印“旧轨道阵列\n”；
for($index=0;$index<@oldtrackarray+1;$index++){
    打印 "$oldtrackarray[$index]\n";}

$element = '\\my Music\\Corrupt Souls\\b-corrupt.mp3';
推（@newtrackarray，$元素）；

$element = '\\我的音乐\\gta4\\10 - Vagabond.mp3';
推（@newtrackarray，$元素）；

$element = '\\My Music\\gta4\\14 - War Is Necessary.mp3';
推（@newtrackarray，$元素）；

$element = '\\我的音乐\\回到黑色\\05 回到黑色.mp3';
推（@newtrackarray，$元素）；

打印“新曲目\n”；
for($index=0;$index<@newtrackarray+1;$index++){
    打印 "$newtrackarray[$index]\n";
}

@test{@oldtrackarray} = ();
@uninvited = grep {!exists $test{$_}} @newtrackarray;

打印“独特的曲目：\ n”；
for($index=0;$index<$#uninvited+1;$index++){
    print "$uninvited[$index]\n";
}

```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T17:36:36.750

```
@test{ map { lc } @array1 } = ();
@new_ones = grep { !exists $test{lc $_} } @array2; 
```

如果您想将 的列表添加`@new_ones`到已经在 中`@array1`的列表，从而生成到目前为止看到的所有唯一项目的列表：

```
push @array1, @new_ones; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T17:59:08.467

你只想要独特的元素`@array2`吗？如果你想要两个数组中的所有唯一元素，你只需要遍历所有元素并记住你以前见过的元素：

```
my %Seen = ();
my @unique = grep { ! $Seen{ lc $_ }++ } @array1, @array2; 
```

您发布了一个更新，您说要选择尚未处理的元素。考虑使用一个哈希来将所有数据保存在一个位置，而不是两个数组。首先用值 0 初始化所有内容：

```
my %Tracks = map { $_, 0 } @all_tracks; 
```

当您处理（或播放）其中一个元素时，将其哈希值设置为真值：

```
$Tracks{ $playing } = 1; 
```

当您想要尚未处理的曲目时，请选择值不为 true 的键：

```
@not_processed = grep { ! $Tracks{$_} } keys %Tracks; 
```

每当您对您的物品有任何疑问时，您只需提出`%Tracks`正确的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T17:37:59.057

这应该可以解决问题..

```
 $test{lc $_} = 1 foreach @array1;  @unique = grep { ! exists $test{lc $_}} @array2; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T20:43:50.553

尽管我一般同意布赖恩的`%Seen`解决方案，但我在原始问题中注意到输出显示了正确大小写的歌曲标题。

第二个哈希（即由内而外的设计），大致如下：

```
my %title;
foreach (@array1, @array2) {
    my $lc = lc $_;
    $title{$lc} = $_ unless $title{$lc} && $title{$lc} =~/[:upper:][:lower:]/;
        # ie don't overwrite if saved title matches '[A-Z][a-z]'
} 
```

然后使用`%title`输出中的内容。

# c++ - 将 MYSQL_TIME 数据类型转换为 char * 或 C++ 字符串

> ID：421234
> 
> 赞同：4
> 
> 时间：2009-01-07T17:34:12.497
> 
> 标签：c++, mysql, c

我在 C++ 应用程序中使用 MySQL C API。我的结果集中有一列类型为 MYSQL_TIME（mysql.h 的一部分）。

有没有办法将 MYSQL_TIME 转换为 char* 或 C++ 字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T17:39:51.110

我想到了：

```
fprintf(stdout, " %04d-%02d-%02d %02d:%02d:%02d (%ld)\n",
                 ts.year, ts.month, ts.day,
                 ts.hour, ts.minute, ts.second,
                 length[3]); 
```

其中 length[3] 包含 ts 的长度。

# c# - FlowPanel 垂直滚动

> ID：421247
> 
> 赞同：2
> 
> 时间：2009-01-07T17:38:32.423
> 
> 标签：c#, flowpanel

我有一个我正在动态添加用户控件的流程面板。我希望它继续添加它们并使用垂直滚动条。而是将它们包装到顶部并放置一个水平滚动条。我确定我只是遗漏了一些东西，但是如何让它进行垂直滚动呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T17:44:13.257

我弄清楚我做了什么。我将流向设置为 TopDown，它需要设置为 LeftRight。

有时我觉得自己像个白痴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-20T20:32:35.693

你必须启用滚动写这个：`flowLayoutPanel1.AutoScroll = true;`

# java - 如何从 Java 的 https 网页登录和下载文件？

> ID：421251
> 
> 赞同：3
> 
> 时间：2009-01-07T17:39:44.467
> 
> 标签：java, https

我必须登录 https 网页并使用 Java 下载文件。我事先知道所有的网址：

```
baseURL = // a https URL;
urlMap = new HashMap<String, URL>();
urlMap.put("login", new URL(baseURL, "exec.asp?login=username&pass=XPTO"));
urlMap.put("logout", new URL(baseURL, "exec.asp?exec.asp?page=999"));
urlMap.put("file", new URL(baseURL, "exec.asp?file=111")); 
```

如果我在 Firefox 等网络浏览器中尝试所有这些链接，它们就会起作用。

现在当我这样做时：

```
urlConnection = urlMap.get("login").openConnection();
urlConnection.connect();
BufferedReader in = new BufferedReader(
    new InputStreamReader(urlConnection.getInputStream()));
String inputLine;
while ((inputLine = in.readLine()) != null)
    System.out.println(inputLine);
in.close(); 
```

我只是再次返回登录页面 HTML，但无法继续下载文件。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T17:57:24.243

我同意 Alnitak 的观点，即问题可能在于存储和返回 cookie。

我使用的另一个不错的选择是来自 Jakarta Commons的[HttpClient 。](http://hc.apache.org/httpclient-3.x/)

顺便说一句，值得注意的是，如果这是您控制的服务器，您应该知道将用户名和密码作为查询字符串发送是不安全的（即使您使用的是 HTTPS）。HttpClient 支持使用 POST 发送参数，您应该考虑这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T20:51:33.813

如前所述，您必须在请求之间维护会话 cookie（请参阅[CookieHandler](http://java.sun.com/javase/6/docs/api/java/net/CookieHandler.html)）。

这是一个示例实现：

```
class MyCookieHandler extends CookieHandler {

    private Map<String, List<String>> cookies = new HashMap<String, List<String>>();

    @Override
    public Map<String, List<String>> get(URI uri,
            Map<String, List<String>> requestHeaders) throws IOException {
        String host = uri.getHost();
        Map<String, List<String>> ret = new HashMap<String, List<String>>();
        synchronized (cookies) {
            List<String> store = cookies.get(host);
            if (store != null) {
                store = Collections.unmodifiableList(store);
                ret.put("Cookie", store);
            }
        }

        return Collections.unmodifiableMap(ret);
    }

    @Override
    public void put(URI uri, Map<String, List<String>> responseHeaders)
            throws IOException {
        List<String> newCookies = responseHeaders.get("Set-Cookie");
        if (newCookies != null) {
            String host = uri.getHost();
            synchronized (cookies) {
                List<String> store = cookies.get(host);
                if (store == null) {
                    store = new ArrayList<String>();
                    cookies.put(host, store);
                }
                store.addAll(newCookies);
            }
        }
    }

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T17:48:08.707

尽管您可能有其他问题阻止登录请求让您登录，但除非您存储并返回登录页面生成的任何 cookie，否则您不太可能继续下载页面。

那是因为 HTTP 本身是无状态的，所以在您当前的代码中，远程服务器无法判断第二个下载请求来自刚刚登录的同一用户。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T17:46:36.293

我想说看看 Java CURL [http://sourceforge.net/projects/javacurl](http://sourceforge.net/projects/javacurl)。我以前用它来登录 https 网站并下载东西，它具有欺骗浏览器 ID 等功能。这可能会解决您重定向回登录的问题。

虽然他们为它提供了一个 eclipse 插件，但我没有使用它，它工作正常。

或者，您可以使用 wget 并从 java 调用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T18:06:19.060

也许您想尝试[HttpUnit](http://httpunit.sourceforge.net/ "HttpUnit")。尽管在编写时考虑了网站测试，但它可能对您的问题有用。

从他们的网站：

“...... 用 Ja​​va 编写的 HttpUnit 模拟浏览器行为的相关部分，包括表单提交、JavaScript、基本 http 身份验证、cookie 和自动页面重定向，并允许 Java 测试代码检查返回的页面作为文本、XML DOM、或表格、表格和链接的容器。”

# apache - SSO-plus-SSL 和 Shibboleth：拥有大量虚拟主机的站点有哪些选择？

> ID：421254
> 
> 赞同：1
> 
> 时间：2009-01-07T17:40:02.420
> 
> 标签：apache, authentication, ssl, single-sign-on, virtual-hosts

**背景：**客户 X 是一家低预算的非盈利机构，但在虚拟主机上配置了很多活动，并且虚拟主机成倍增加。客户 X 也有很多用户，并且有兴趣让他们使用单点登录解决方案。这样，所有用户都可以在所有虚拟主机上使用相同的凭据。

我们也几乎强制要求使用 [Shibboleth 单点登录]( [http://en.wikipedia.org/wiki/Shibboleth_(Internet2)](http://en.wikipedia.org/wiki/Shibboleth_(Internet2))来处理身份验证。

**问题：** Shibboleth Single Sign On 使用 SSL 作为其协议的一部分，但让多个虚拟主机使用 SSL 并不是在公园里散步。 [This question about virtual-hosts with SSL详细介绍了一些陷阱](https://stackoverflow.com/questions/276134/how-can-i-setup-different-ssl-certificates-for-vhosts-on-apache)。

**问题：**处理这种情况的最佳方法是什么（总结）：

*   apache上的多个虚拟主机
*   为每个虚拟主机设置不同的 IP 和 NIC 几乎不是一种选择
*   SSL 几乎需要一个单独的 IP
*   他们都需要某种 SSO
*   我们在使用 Shibboleth 作为 SSO 提供者方面承受着巨大压力

有什么我们可能在这里遗漏的东西，或者有什么方法可以解决这个问题，而不需要为所有虚拟主机提供单独的 IP？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T17:43:30.060

我有一个客户的情况完全相同，他们解决的方法是购买通配符域 *.example.com 并让所有虚拟主机在 example.com 上都有一个特定的子域来解决这个问题。

这是 Shibboleth 并且确实成功了，尽管您需要主机域同意属于 SSO 的一个父域。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-17T09:02:18.920

如果您与给定站点（服务提供商）交换的数据本身不是安全敏感的，您可以关闭 SSL 以访问该站点。

我们正在谈论两个 SSL 通道。

*   SP 与 IDP 通信时使用的一种
*   另一个正在访问该站点

只有后一个应该是“知名”（您必须支付的）证书。

可以使用 HTTP 工件来避免将数据从 idp（受 SSL 保护）发布到未受 SSL 保护的 SP。这样可以避免浏览器的安全警告。

此设置仍可保护用户凭据。您与网站交换的数据不会。

# c# - 如何使用 C# 关键字作为属性名称？

> ID：421257
> 
> 赞同：69
> 
> 时间：2009-01-07T17:40:55.960
> 
> 标签：c#, .net, asp.net-mvc

使用 asp.net MVC 我想在视图中执行此操作：

```
<%= Html.TextBox("textbox1", null, new { class="class1" }) %> 
```

此语句无法编译，因为 class 是 C# 中的关键字。我想知道如何转义属性名称以便编译。

如果我将“class”属性更改为“Class”（大写 C），则可以编译它。但这不合适，因为严格的 xhtml 规定所有属性（和元素）名称必须小写。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-01-07T17:43:07.937

您可以在 C# 中使用关键字作为标识符，方法是在它们前面加上 @。

```
var @class = new object(); 
```

引用关于[**C# 关键字**](http://msdn.microsoft.com/en-us/library/x53a06bb.aspx)的 MSDN 文档：

> 关键字是预定义的、保留的标识符，对编译器具有特殊含义。**除非它们包含@**作为前缀，否则它们不能用作程序中的标识符。例如，**@if**是有效标识符，但**if**不是，因为 if 是关键字。

# css - 您如何在项目中组织 CSS？

> ID：421258
> 
> 赞同：6
> 
> 时间：2009-01-07T17:41:23.260
> 
> 标签：css, stylesheet

在处理（复杂）Web 应用程序时，我感受到的最具挑战性的事情之一是组织 CSS。以下是我们在多个项目中尝试过的不同方法。

**1：每个网页/模块都有不同的样式表。**

显然，那时我们对 Web 应用程序还很陌生，这种方法导致样式表过多和样式重复过多。我们很难在整个应用程序中实现一致性。

**2：有一个通用的样式表，在相似的网页中共享。**

这在一段时间内运作良好，直到变得过于复杂。我们还发现我们有太多的例外情况，这些例外情况仍然会导致针对特定情况调整通用样式，如果做得不正确，可能会影响应用程序的不同部分，并且在某些时候会变得困难。此外，拥有庞大的开发团队（跨越不同时区）和艰难的项目时间表并没有帮助我们的事业。

虽然 #2 有效，但我们仍然看到我们的产品仍然没有我们想要的类似 UI 质量和一致性。

对于非常复杂的 web 2.0 应用程序，是否有任何 CSS 样式指南可供参考。其他人如何维护他们的样式表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T18:10:17.523

我发现自己处于类似的情况。

首先，确保您有效地使用 CSS。如果您不觉得自己是使用 CSS 的绝对专家，请花一些时间学习，您将显着减少冗余并最终获得更易于使用的样式表。

在大多数情况下，如果您将所有样式合并到一个文件中，实际上不会对性能造成太大影响，实际上，将样式拆分为数十个文件只是为了确保排除任何不会出现的文件由于所有额外的请求， used 可能会导致更长的加载时间。但我相信你知道，一个庞大的 CSS 文件很快就会变得难以维护。

考虑这个 hack 以达成妥协。使用您选择的语言（对我来说是 PHP）来提供您的 CSS。我的意思是包含您的样式文件，如下所示：

```
<link rel="stylesheet" type="text/css" href="styles.php" /> 
```

, 让该文件的标题以 text/CSS 内容类型返回它，并让该文件

a) 将多个样式表拉入一个文件和/或 b) 根据各种参数（正在加载的文件、用户数据、一天中的时间等）更改样式的编写方式

A 总体上是一个很好的解决方案，可以减少开发性头痛和页面加载开销。B 可能还需要您设置适当的文件到期日期，以避免让浏览器忽略您当前想要生成的任何新样式，而支持上次访问时下载的内容。由于您通常可以通过简单地使用静态样式表和动态编写的元素类/ID 名称在 B 中完成相同的事情，因此除非您正在做一些非常奇怪的事情，否则它通常不是理想的解决方案。

并请一位设计师为您提供有关此类东西的建议。通常，我们开发人员很难围绕高效 CSS 的一些细节以及在该特定领域受过培训的人员展开思考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-21T17:20:06.300

我已经很多次了。首先，在早期，我过去只做一个包含所有内容的样式表，反正不多，那是旧时代；然后我决定采用您的第二种方法，幸运的是第一种方法我认为这是一个错误，太多的代码和碎片漂浮在...

第二种方法适用于您开始提出问题的时间......我的意思是：

这个 div 的背景样式应该放在 graphics.css 还是 layout.css 中？

当涉及到 P 的宽度时，字体样式应该在 fonts.css 中还是在布局中？

带有图标位置 div 的标题的边距是否应该转到图形.css 或 layout.css 或 fonts.css（对图标、文本和位置使用相同的声明会更简单.. .)？

然后你意识到这种方法有问题。

我现在做的是评论。很多。

模板.css -

```
/* ////// Headers ////// */
#header {
    width: 1004px;
    height: 243px; /* 263H-20MARG=243H */
    padding: 20px 0px 0px 0px;
    background-color: #000000;
    background-image:url('../images/redset/top1-bk.png');
    background-repeat:no-repeat;
    background-position:right top;
    clear: both;
}

/* logo */
#logo {
    background-image:url('../images/redset/wh-logo.png');
    background-repeat:no-repeat;
    width:327px;
    height: 263px;
    float: left;
    margin: -20px 0px 0px 0px;
}
#logo a {
    width:327px;
    height:263px;
}

/* Top menu & Banner */
#menuybanner {
    text-align: center;
/*  margin-right: 65px; optional*/
}
#bannerz {
    height: 152px;
    width: 653px;
    text-align: left;
    margin-right: 24px;
    /* optional: width: 100%;
    margin: 0px */
}
#bigmenu {
    text-align: left;
    margin: 18px 0px 14px 74px;
}

#bigmenu img {
    margin: 0px 22px 0px 0px;
} 
```

最初这将是三种不同的 css：布局、图形和文本。现在我知道每个人都在做什么。

顺便说一句，我知道它会增加存档的重量，但我不想做一些混合效果，因为跟随我并阅读 css 的每个人都应该能够理解我做了什么，并且 css 如下所示：

```
a, .b, .c, .d, #f, #2 { background-color: black; } 
```

真的很难揭开。当然，如果您需要这样做，请继续，但我的意思是，有时它们只是毫无意义地分组只是为了更加神秘......就像穆德尔......哈哈哈。

希望能有所帮助。

再见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T18:05:49.967

我使用一个 mastersheet template.css 来设置我的主模板的样式。对于需要主模板无法涵盖的单独样式的任何站点，如果它很短，我要么将它放在站点头部，要么为这种情况创建一个新工作表。

理想情况下，我希望将 template.css 文件设计为灵活地涵盖大多数情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T18:04:46.007

您想利用 CSS 的级联特性和继承规则的方式。

首先编码最一般的情况，然后更改细节。

对于一个正常大小的项目，这根本不应该失控。

为了更清楚地看到事物，您可以使用索引表并从中调用其他样式表。当您想要进行更改时，您将知道要转到哪个样式表，这样您就可以节省时间。这是我的一个项目中的一个例子。

```
/* 
This is the CSS index page. It contains no CSS code but calls the other sheets
*/
@import url("main/reset.css");
@import url("main/colors.css");
@import url("main/structure.css");
@import url("main/html-tags.css");
@import url("main/sign-up-sign-in.css");
@import url("main/pagination.css");
@import url("main/menu-items.css");
@import url("main/teachers-list.css");
@import url("main/footer.css");
@import url("main/misc-custom-sections.css");
@import url("main/error-messages.css"); 
```

祝你找到自己的风格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T18:22:34.940

我通常会尝试按视觉元素对我的 CSS 进行分组，并且只包含给定页面的相关样式表以保持我的加载时间较短。使用 PHP 或您使用的任何环境将所需的样式表动态合并到给定页面的单个样式表中是一个很好的解决方案。

对我有帮助的一件事是我实际上为我的 CSS 创建了伪命名空间。我知道 CSS 3 支持命名空间，这使它更容易，但由于某些浏览器不支持它，这就是我所做的：

1.  创建与您的项目相关的文件夹和文件（我使用 Java 命名空间样式）
    *   例如 /css/com/mydomain/myprojectname/globalheader.css
2.  接下来，我使用映射到文件系统位置的类名
    *   例如 <div id='header' class='com-mydomain-myprojectname-globalheader-topClass'>
3.  在你的 css 文件中使用分隔符和好的注释
    *   例如 /*---------------- 开始链接部分 --------------- -----*/
4.  使用 PHP 或其他方式加载这些文件并在加载时将它们组合成一个样式表（如果你真的很聪明，你可以缓存结果表。命名空间约定将防止类名之间的冲突。

虽然设计者认为这很冗长，但它可以很容易地在文件系统中找到特定的 css 类，而不会影响加载时间。此外，您不会遇到一个设计师/开发人员覆盖另一个类的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T18:22:45.893

如果您可以让每个人都正确地使用级联并将您的目标优势保持在最低限度，那么维护 css 文件会容易得多。

确保元素继承样式并且覆盖不会太重将防止你的 css 变得疯狂。通过这样做，您就可以让自己只有 2 或 3 个用于布局/基本样式和覆盖的样式表。如果您对进入布局/基本样式表的内容进行严格控制，并定期访问以重新评估覆盖表中的内容，以查看可以将哪些内容移至基本样式以及可以简化哪些内容，您将解放自己让人们随意覆盖，同时也保持对蠕变的控制。

这是我的理论...

# sql - 直接执行语句和从存储过程执行语句时的执行计划不同

> ID：421275
> 
> 赞同：7
> 
> 时间：2009-01-07T17:47:59.037
> 
> 标签：sql, sql-server, tsql, stored-procedures, sql-execution-plan

在工作中开发一个新查询时，我编写了它并在 SQL 查询分析器中对其进行了分析。该查询在没有任何表扫描的情况下执行得非常好，但是当我将它封装在存储过程中时，性能非常糟糕。当我查看执行计划时，我可以看到 SQL Server 选择了一个不同的计划，该计划使用表扫描而不是 TableB 上的索引搜索（我被迫稍微混淆表和列名，但没有任何查询逻辑已经改变）。

这是查询

```
SELECT     
    DATEADD(dd, 0, DATEDIFF(dd, 0, TableA.Created)) AS Day, 
    DATEPART(hh, TableA.Created) AS [Hour], 
    SUM(TableB.Quantity) AS Quantity, 
    SUM(TableB.Amount) AS Amount
FROM
    TableA
    INNER JOIN TableB ON TableA.BID = TableB.ID
WHERE     
    (TableA.ShopId = @ShopId)
GROUP BY 
    DATEADD(dd, 0, DATEDIFF(dd, 0, TableA.Created)), 
    DATEPART(hh, TableA.Created)
ORDER BY 
    DATEPART(hh, TableA.Created) 
```

当我运行查询“原始”时，我得到以下跟踪统计信息

```
事件类持续时间 CPU 读取 写入
SQL:Stmt 已完成 75 41 7 0

```

当我使用以下命令将查询作为存储过程运行时

```
DECLARE @ShopId int
SELECT @ShopId = 1
EXEC spStats_GetSalesStatsByHour @ShopId 
```

我得到以下跟踪统计信息

```
事件类持续时间 CPU 读取 写入
SQL:Stmt 已完成 222 10 48 0

```

如果我将查询存储在 nvarchar 中并像这样使用 sp_executesql 执行它（它的执行类似于 sproc），我也会得到相同的结果

```
DECLARE @SQL nvarchar(2000)
SET @SQL = 'SELECT DATEADD(dd, ...'
exec sp_executesql @SQL 
```

除了上面的 select 语句，存储过程不包含任何内容。什么会导致 sql server 仅仅因为语句作为存储过程执行而选择较差的执行计划？

我们目前在**SQL Server 2000上运行**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-07T17:53:09.180

这通常与参数嗅探有关。处理起来可能非常令人沮丧。有时可以通过重新编译存储过程来解决，有时甚至可以在存储过程中使用重复变量，如下所示：

```
alter procedure p_myproc (@p1 int) as
declare @p1_copy int;
set @p1_copy = @p1; 
```

然后在查询中使用@p1_copy。看起来很荒谬，但它确实有效。

检查我最近关于同一主题的问题：

[为什么 SqlServer 优化器会与参数混淆？](https://stackoverflow.com/questions/414336/why-does-the-sqlserver-optimizer-get-so-confused-with-parameters)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-12-31T14:05:09.283

是的——我在 Oracle DB 11g 上也看到过这一点——在 SQL 提示符下，相同的查询在 db 服务器的 2 个节点上运行得很快，但是当从包中调用它时，它真的挂了！

必须清除共享池才能获得相同的行为：原因是某些作业/脚本正在运行，该作业/脚本将较旧的副本锁定在一个执行计划较差的节点上的库缓存/内存中。

# resharper - 如何让 Resharper 在导航到类时忽略 Designer 文件？

> ID：421278
> 
> 赞同：6
> 
> 时间：2009-01-07T17:48:29.067
> 
> 标签：resharper

在 Resharper 中，如果您按住 ctrl 键单击类的名称以导航到其定义并且具有设计器文件，Resharper 将询问我是否要转到 X.cs 或 X.Designer.cs，因为该类是部分的。

有谁知道如何禁用这种烦恼，以便它只进入 X.cs 并忽略设计器文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T21:41:13.167

我使用的解决方法是 Ctrl-Shift-N（ReSharper 经典绑定）或 Ctrl-T（Visual Studio 绑定）并开始输入类名。如果您的类在同名文件中，您就可以从下拉列表中选择正确的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T19:03:10.617

这是一个很好的问题。每当我有这样的问题时，我都会在 ReSharper JIRA 网站上提出建议。我建议你也这样做。

[http://www.jetbrains.net/jira/browse/RSRP](http://www.jetbrains.net/jira/browse/RSRP)

我不相信你现在可以做你想做的事，即使是最新的夜间版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T17:54:32.580

你最好的选择是下载夜间构建我不知道他们是否解决了这个问题，虽然我认为这是一个功能，而不是一个问题。

[每晚构建](http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+4.5+Nightly+Builds)

# mysql - 我应该将两个相似的表合二为一吗？

> ID：421279
> 
> 赞同：4
> 
> 时间：2009-01-07T17:48:54.150
> 
> 标签：mysql, database, database-design

在我的数据库中，我目前有两个几乎相同的表，除了一个字段。

快速解释一下，在我的项目中，每年企业都会向我提交一份他们销售给我的供应商名单，并从他们那里购买东西。由于这是每年进行一次，因此我有一张名为 的桌子`sales`和一张名为`purchases`.

所以在`sales`表格中，我会有如下字段：`BusinessID`, `year`,`PurchaserID`等。而在表格中则完全相反`purchases`，除了会有一个`SellerID`.

`PurchaserID`所以基本上除了/之外，两个表在字段方面都是完全相同的`SellerID`。我继承了这个系统，所以我没有这样设计数据库。我正在辩论将这两个表合并到一个名为的表中`suppliers`，并只是添加一个`type`字段来区分它们是卖给还是购买。

这听起来是个好主意吗？关于为什么这不是一个好主意，我有什么遗漏吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T17:57:00.860

做对你有用的事。

教科书的答案是[normalize](http://en.wikipedia.org/wiki/Database_normalization)。如果您标准化，您可能会有 2 张表，其中一张将您的买家和卖家都**作为公司**。还有一个交易表，告诉谁从谁那里买了什么。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T18:00:54.377

如果它没有坏，就不要修理它。让他们分开。

由于系统已经构建，我只会在您发现自己在两个表中执行大量查询时才考虑这一点，例如大的讨厌的 UNION 查询。将这两个表合二为一可以使诸如“向我显示在这些日期之间出售/购买的所有卖家或买家......”之类的查询变得更加容易。

但是从业务规则的角度来看，这两个组的处理方式听起来非常不同，因此此时进行应用程序更改可能不值得麻烦。（每个查询都必须有一个“WHERE Type = 1”或类似的东西）。

如果您在数据库设计阶段就问过这个问题，我的回答可能会有所不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T18:19:45.307

没有一张桌子。它们是具有相似结构的不同实体。巩固它们没有任何好处。（除了清醒之外，什么也没有丢失；但恕我直言，这是至关重要的）。

“规范化”不包括查找具有相似模式的表并将它们合并。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T17:52:45.080

标准化会说“是”。

有多少应用程序受到此更改的影响？那会影响决定。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T17:55:44.293

绝对是一张桌子。而且我不会称它为供应商，因为这并不反映表格的含义。像 busibess_partner 之类的东西或比这更好的东西可能更合适。而不是purchase_id和seller_id，然后像business_partner_id这样更通用，是的，添加一个字段来区分。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T18:20:02.340

数据库始终是您的业务目标的有限模型。如果这对您的业务没有意义，请忽略那些说您应该通过创建新的公司表来增加数据模型的复杂性的人（尽管您可能已经有类似的东西）。如果您真的想进入“完美模型”游戏，只需开始将所有内容抽象到“实体”表中，很快您将拥有一个完全无法管理的数据库。

规范化将要求您不要组合这两个字段，除非外键实际上指向同一个表。要记住的一个关键规则是，表中的每一列都应该只表示一件事。添加第二个字段来解释第一个字段的含义会违反此规则。

如果您的查询变得一团糟，因为您总是加入两个表，您可以创建一个视图。

此外，表中的记录数几乎完全不相关。系统安装到位后，始终优化性能。如果它杀死了您的应用程序以将所有记录放在一个表中，请在以有意义的方式对表进行分区的列上设置聚集索引。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T18:09:49.303

您必须考虑两个表上的记录数。如果它们太大，它可能会对与客户和供应商有多个连接的查询产生很大影响。

示例：谁向我们出售了计算机，我们将它们卖给了谁。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T18:22:32.570

从完全不同的角度来看。我倾向于考虑逻辑而不是技术。对我来说，决定的不是数据在形状或字段上是否相似，而是混合它们是否有意义。这就是说技术答案是否可能是*normalize*，我的答案是：将两者结合在一起对您（业务逻辑）有意义吗？

另一个答案是关于合并和更改命名约定。对我来说，这是一个合乎逻辑的决定：您是说您不与买家和卖家合作，而是与商业伙伴合作。如果这是你的情况，那就去做吧。

您还可以考虑您对表格的用途。如果它们是一种独特的逻辑类型（业务合作伙伴），您肯定会有需要同时访问买家和卖家的查询。否则，如果您的所有查询都是分开的，则可能表明它们不相同，不应放在一起。将它们放在一起意味着需要进行大量额外检查，并且花费的 CPU 时间与单独的实体不同。

有一个关于接口的长期使用的比喻可能适用于此。仅仅因为火枪和相机都可以射击，这并不意味着它们共享一个界面，除非您喜欢玩俄罗斯轮盘赌。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T20:16:05.150

从逻辑上看，报告的交易之间似乎没有区别，只是向您报告的人不同。它应该是一个包含 SellerID、BuyerID 和（如果需要）ReporterID（可能还有其他交易信息）的表。

这是*应该*的。现在，如何进行过渡？制作一个使用两个旧表填充新表的脚本应该是一个简单的练习，但是您还需要更改所有使用该信息的查询。这可能需要大量工作，而且可能不值得付出努力。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-05T19:05:03.800

Since none of the *experts* reporting in are willing to answer your question, the simple answer is: query1 UNION query2

EX. SELECT * FROM table1 UNION SELECT * FROM table2 assuming table1 and table2 have the same structure/heading titles

# java - 如何使用堆栈跟踪或反射找到方法的调用者？

> ID：421280
> 
> 赞同：420
> 
> 时间：2009-01-07T17:49:54.883
> 
> 标签：java, stack-trace

我需要找到方法的调用者。是否可以使用堆栈跟踪或反射？

* * *

## 回答 #1

> 赞同：440
> 
> 时间：2009-01-07T18:04:01.640

```
StackTraceElement[] stackTraceElements = Thread.currentThread().getStackTrace() 
```

根据Javadocs：

> 数组的最后一个元素表示堆栈的底部，它是序列中最近的方法调用。

A`StackTraceElement`有`getClassName()`,和. `getFileName()`_`getLineNumber()``getMethodName()`

您将不得不尝试确定您想要的索引（可能是`stackTraceElements[1]`或`[2]`）。

* * *

## 回答 #2

> 赞同：221
> 
> 时间：2010-05-27T19:56:03.987

**注意**：如果您使用的是 Java 9 或更高版本，则应`StackWalker.getCallerClass()`按照[Ali Dehghani 的回答](https://stackoverflow.com/a/45812871/350692)中所述使用。

由于历史原因，以下不同方法的比较主要是有趣的。

* * *

可以在对此[增强请求](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4851444)的评论中找到替代解决方案。它使用`getClassContext()`自定义的方法，`SecurityManager`似乎比堆栈跟踪方法更快。

以下程序测试不同建议方法的速度（最有趣的是在内部类中`SecurityManagerMethod`）：

```
/**
 * Test the speed of various methods for getting the caller class name
 */
public class TestGetCallerClassName {

  /**
   * Abstract class for testing different methods of getting the caller class name
   */
  private static abstract class GetCallerClassNameMethod {
      public abstract String getCallerClassName(int callStackDepth);
      public abstract String getMethodName();
  }

  /**
   * Uses the internal Reflection class
   */
  private static class ReflectionMethod extends GetCallerClassNameMethod {
      public String getCallerClassName(int callStackDepth) {
          return sun.reflect.Reflection.getCallerClass(callStackDepth).getName();
      }

      public String getMethodName() {
          return "Reflection";
      }
  }

  /**
   * Get a stack trace from the current thread
   */
  private static class ThreadStackTraceMethod extends GetCallerClassNameMethod {
      public String  getCallerClassName(int callStackDepth) {
          return Thread.currentThread().getStackTrace()[callStackDepth].getClassName();
      }

      public String getMethodName() {
          return "Current Thread StackTrace";
      }
  }

  /**
   * Get a stack trace from a new Throwable
   */
  private static class ThrowableStackTraceMethod extends GetCallerClassNameMethod {

      public String getCallerClassName(int callStackDepth) {
          return new Throwable().getStackTrace()[callStackDepth].getClassName();
      }

      public String getMethodName() {
          return "Throwable StackTrace";
      }
  }

  /**
   * Use the SecurityManager.getClassContext()
   */
  private static class SecurityManagerMethod extends GetCallerClassNameMethod {
      public String  getCallerClassName(int callStackDepth) {
          return mySecurityManager.getCallerClassName(callStackDepth);
      }

      public String getMethodName() {
          return "SecurityManager";
      }

      /** 
       * A custom security manager that exposes the getClassContext() information
       */
      static class MySecurityManager extends SecurityManager {
          public String getCallerClassName(int callStackDepth) {
              return getClassContext()[callStackDepth].getName();
          }
      }

      private final static MySecurityManager mySecurityManager =
          new MySecurityManager();
  }

  /**
   * Test all four methods
   */
  public static void main(String[] args) {
      testMethod(new ReflectionMethod());
      testMethod(new ThreadStackTraceMethod());
      testMethod(new ThrowableStackTraceMethod());
      testMethod(new SecurityManagerMethod());
  }

  private static void testMethod(GetCallerClassNameMethod method) {
      long startTime = System.nanoTime();
      String className = null;
      for (int i = 0; i < 1000000; i++) {
          className = method.getCallerClassName(2);
      }
      printElapsedTime(method.getMethodName(), startTime);
  }

  private static void printElapsedTime(String title, long startTime) {
      System.out.println(title + ": " + ((double)(System.nanoTime() - startTime))/1000000 + " ms.");
  }
} 
```

运行 Java 1.6.0_17 的 2.4 GHz Intel Core 2 Duo MacBook 的输出示例：

```
Reflection: 10.195 ms.
Current Thread StackTrace: 5886.964 ms.
Throwable StackTrace: 4700.073 ms.
SecurityManager: 1046.804 ms. 
```

内部反射方法比其他方法*快得多*。从新创建`Throwable`的获取堆栈跟踪比从当前获取更快`Thread`。在查找调用者类的非内部方法中，自定义`SecurityManager`似乎是最快的。

## 更新

正如**lyomi在**[此评论](https://stackoverflow.com/questions/421280/how-do-i-find-the-caller-of-a-method-using-stacktrace-or-reflection/2924426#comment26408146_2924426)中指出的那样，该`sun.reflect.Reflection.getCallerClass()`方法在 Java 7 更新 40 中默认已禁用，并在 Java 8 中完全删除。[在 Java 错误数据库中的此问题中](https://bugs.openjdk.java.net/browse/JDK-8014925)阅读有关此问题的更多信息。

## 更新 2

正如**zammbi**发现的那样，甲骨文[被迫退出](https://bugs.openjdk.java.net/browse/JDK-8021946)删除`sun.reflect.Reflection.getCallerClass()`. 它在 Java 8 中仍然可用（但已弃用）。

## 更新 3

3 年后：更新当前 JVM 的时间。

```
> java -version
java version "1.8.0"
Java(TM) SE Runtime Environment (build 1.8.0-b132)
Java HotSpot(TM) 64-Bit Server VM (build 25.0-b70, mixed mode)
> java TestGetCallerClassName
Reflection: 0.194s.
Current Thread StackTrace: 3.887s.
Throwable StackTrace: 3.173s.
SecurityManager: 0.565s. 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2017-08-22T08:42:27.443

# Java 9 - JEP 259：Stack-Walking API

[JEP 259](http://openjdk.java.net/jeps/259)为堆栈遍历提供了一个高效的标准 API，允许轻松过滤和延迟访问堆栈跟踪中的信息。在 Stack-Walking API 之前，访问堆栈帧的常用方法有：

> `Throwable::getStackTrace`并`Thread::getStackTrace`返回一个对象数组 `StackTraceElement`，其中包含每个堆栈跟踪元素的类名和方法名。
> 
> `SecurityManager::getClassContext`是一个受保护的方法，它允许 `SecurityManager`子类访问类上下文。
> 
> `sun.reflect.Reflection::getCallerClass`无论如何都不应该使用的JDK 内部方法

使用这些 API 通常效率低下：

> **这些 API 要求 VM 急切地捕获整个堆栈的快照**，并返回代表整个堆栈的信息。如果调用者只对堆栈上的前几帧感兴趣，则无法避免检查所有帧的成本。

为了找到直接调用者的类，首先获取一个`StackWalker`：

```
StackWalker walker = StackWalker
                           .getInstance(StackWalker.Option.RETAIN_CLASS_REFERENCE); 
```

然后要么调用`getCallerClass()`：

```
Class<?> callerClass = walker.getCallerClass(); 
```

或s 并获得`walk`第`StackFrame`一个前面的`StackFrame`：

```
walker.walk(frames -> frames
      .map(StackWalker.StackFrame::getDeclaringClass)
      .skip(1)
      .findFirst()); 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2009-01-07T18:06:08.173

听起来您正试图避免将引用传递给`this`该方法。传递`this`比通过当前堆栈跟踪找到调用者要好得多。 **重构为更面向对象的设计会更好。** 您不需要知道来电者。如有必要，传递一个回调对象。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2017-06-07T08:40:19.260

**单线**：

```
Thread.currentThread().getStackTrace()[2].getMethodName() 
```

请注意，您可能需要将 2 替换为 1。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-01-07T19:52:11.327

这个方法做同样的事情，但更简单一点，可能性能更高一点，如果您使用反射，它会自动跳过这些帧。唯一的问题是它可能不存在于非 Sun JVM 中，尽管它包含在 JRockit 1.4-->1.6 的运行时类中。（重点是，它不是*公共*课程）。

```
sun.reflect.Reflection

    /** Returns the class of the method <code>realFramesToSkip</code>
        frames up the stack (zero-based), ignoring frames associated
        with java.lang.reflect.Method.invoke() and its implementation.
        The first frame is that associated with this method, so
        <code>getCallerClass(0)</code> returns the Class object for
        sun.reflect.Reflection. Frames associated with
        java.lang.reflect.Method.invoke() and its implementation are
        completely ignored and do not count toward the number of "real"
        frames skipped. */
    public static native Class getCallerClass(int realFramesToSkip); 
```

至于`realFramesToSkip`值应该是多少，Sun 1.5 和 1.6 VM 版本`java.lang.System`，有一个名为 getCallerClass() 的包保护方法，它调用`sun.reflect.Reflection.getCallerClass(3)`，但在我的辅助实用程序类中，我使用了 4，因为添加了辅助类的框架调用。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-01-07T18:15:06.237

```
 /**
       * Get the method name for a depth in call stack. <br />
       * Utility function
       * @param depth depth in the call stack (0 means current method, 1 means call method, ...)
       * @return method name
       */
      public static String getMethodName(final int depth)
      {
        final StackTraceElement[] ste = new Throwable().getStackTrace();

        //System. out.println(ste[ste.length-depth].getClassName()+"#"+ste[ste.length-depth].getMethodName());
        return ste[ste.length - depth].getMethodName();
      } 
```

* * *

例如，如果您尝试获取用于调试目的的调用方法行，则需要通过在其中编写这些静态方法的 Utility 类：（
旧 java1.4 代码，只是为了说明潜在的 StackTraceElement 用法）

```
 /**
          * Returns the first "[class#method(line)]: " of the first class not equal to "StackTraceUtils". <br />
          * From the Stack Trace.
          * @return "[class#method(line)]: " (never empty, first class past StackTraceUtils)
          */
        public static String getClassMethodLine()
        {
            return getClassMethodLine(null);
        }

        /**
          * Returns the first "[class#method(line)]: " of the first class not equal to "StackTraceUtils" and aclass. <br />
          * Allows to get past a certain class.
          * @param aclass class to get pass in the stack trace. If null, only try to get past StackTraceUtils. 
          * @return "[class#method(line)]: " (never empty, because if aclass is not found, returns first class past StackTraceUtils)
          */
        public static String getClassMethodLine(final Class aclass)
        {
            final StackTraceElement st = getCallingStackTraceElement(aclass);
            final String amsg = "[" + st.getClassName() + "#" + st.getMethodName() + "(" + st.getLineNumber()
            +")] <" + Thread.currentThread().getName() + ">: ";
            return amsg;
        }

     /**
       * Returns the first stack trace element of the first class not equal to "StackTraceUtils" or "LogUtils" and aClass. <br />
       * Stored in array of the callstack. <br />
       * Allows to get past a certain class.
       * @param aclass class to get pass in the stack trace. If null, only try to get past StackTraceUtils. 
       * @return stackTraceElement (never null, because if aClass is not found, returns first class past StackTraceUtils)
       * @throws AssertionFailedException if resulting statckTrace is null (RuntimeException)
       */
      public static StackTraceElement getCallingStackTraceElement(final Class aclass)
      {
        final Throwable           t         = new Throwable();
        final StackTraceElement[] ste       = t.getStackTrace();
        int index = 1;
        final int limit = ste.length;
        StackTraceElement   st        = ste[index];
        String              className = st.getClassName();
        boolean aclassfound = false;
        if(aclass == null)
        {
            aclassfound = true;
        }
        StackTraceElement   resst = null;
        while(index < limit)
        {
            if(shouldExamine(className, aclass) == true)
            {
                if(resst == null)
                {
                    resst = st;
                }
                if(aclassfound == true)
                {
                    final StackTraceElement ast = onClassfound(aclass, className, st);
                    if(ast != null)
                    {
                        resst = ast;
                        break;
                    }
                }
                else
                {
                    if(aclass != null && aclass.getName().equals(className) == true)
                    {
                        aclassfound = true;
                    }
                }
            }
            index = index + 1;
            st        = ste[index];
            className = st.getClassName();
        }
        if(resst == null) 
        {
            //Assert.isNotNull(resst, "stack trace should null"); //NO OTHERWISE circular dependencies 
            throw new AssertionFailedException(StackTraceUtils.getClassMethodLine() + " null argument:" + "stack trace should null"); //$NON-NLS-1$
        }
        return resst;
      }

      static private boolean shouldExamine(String className, Class aclass)
      {
          final boolean res = StackTraceUtils.class.getName().equals(className) == false && (className.endsWith("LogUtils"
            ) == false || (aclass !=null && aclass.getName().endsWith("LogUtils")));
          return res;
      }

      static private StackTraceElement onClassfound(Class aclass, String className, StackTraceElement st)
      {
          StackTraceElement   resst = null;
          if(aclass != null && aclass.getName().equals(className) == false)
          {
              resst = st;
          }
          if(aclass == null)
          {
              resst = st;
          }
          return resst;
      } 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-01-07T17:59:37.217

我以前做过。您可以只创建一个新异常并在其上获取堆栈跟踪而不抛出它，然后检查堆栈跟踪。正如另一个答案所说，它的成本非常高——不要在一个紧密的循环中进行。

我之前已经为性能无关紧要的应用程序上的日志实用程序完成了此操作（实际上，性能几乎不重要 - 只要您将结果显示为诸如快速单击按钮之类的操作）。

在您获得堆栈跟踪之前，异常只有 .printStackTrace() 所以我不得不将 System.out 重定向到我自己创建的流，然后 (new Exception()).printStackTrace(); 重定向 System.out 并解析流。好玩的东西。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-02-03T03:16:16.160

```
private void parseExceptionContents(
      final Exception exception,
      final OutputStream out)
   {
      final StackTraceElement[] stackTrace = exception.getStackTrace();
      int index = 0;
      for (StackTraceElement element : stackTrace)
      {
         final String exceptionMsg =
              "Exception thrown from " + element.getMethodName()
            + " in class " + element.getClassName() + " [on line number "
            + element.getLineNumber() + " of file " + element.getFileName() + "]";
         try
         {
            out.write((headerLine + newLine).getBytes());
            out.write((headerTitlePortion + index++ + newLine).getBytes() );
            out.write((headerLine + newLine).getBytes());
            out.write((exceptionMsg + newLine + newLine).getBytes());
            out.write(
               ("Exception.toString: " + element.toString() + newLine).getBytes());
         }
         catch (IOException ioEx)
         {
            System.err.println(
                 "IOException encountered while trying to write "
               + "StackTraceElement data to provided OutputStream.\n"
               + ioEx.getMessage() );
         }
      }
   } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-22T02:23:14.270

这是我根据本主题中显示的提示编写的部分代码。希望能帮助到你。

（请随时提出改进此代码的任何建议，请告诉我）

柜台：

```
public class InstanceCount{
    private static Map<Integer, CounterInstanceLog> instanceMap = new HashMap<Integer, CounterInstanceLog>();
private CounterInstanceLog counterInstanceLog;

    public void count() {
        counterInstanceLog= new counterInstanceLog();
    if(counterInstanceLog.getIdHashCode() != 0){
    try {
        if (instanceMap .containsKey(counterInstanceLog.getIdHashCode())) {
         counterInstanceLog= instanceMap .get(counterInstanceLog.getIdHashCode());
    }

    counterInstanceLog.incrementCounter();

            instanceMap .put(counterInstanceLog.getIdHashCode(), counterInstanceLog);
    }

    (...)
} 
```

和对象：

```
public class CounterInstanceLog{
    private int idHashCode;
    private StackTraceElement[] arrayStackTraceElements;
    private int instanceCount;
    private String callerClassName;

    private StackTraceElement getProjectClasses(int depth) {
      if(depth< 10){
        getCallerClassName(sun.reflect.Reflection.getCallerClass(depth).getName());
        if(getCallerClassName().startsWith("com.yourproject.model")){
            setStackTraceElements(Thread.currentThread().getStackTrace());
            setIdHashCode();
        return arrayStackTraceElements[depth];
        }
        //+2 because one new item are added to the stackflow
        return getProjectClasses(profundidade+2);           
      }else{
        return null;
      }
    }

    private void setIdHashCode() {
        if(getNomeClasse() != null){
            this.idHashCode = (getCallerClassName()).hashCode();
        }
    }

    public void incrementaContador() {
    this.instanceCount++;
}

    //getters and setters

    (...)

} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-09-28T02:21:02.230

```
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.PrintWriter;

class DBConnection {
    String createdBy = null;

    DBConnection(Throwable whoCreatedMe) {
        ByteArrayOutputStream os = new ByteArrayOutputStream();
        PrintWriter pw = new PrintWriter(os);
        whoCreatedMe.printStackTrace(pw);
        try {
            createdBy = os.toString();
            pw.close();
            os.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

public class ThrowableTest {

    public static void main(String[] args) {

        Throwable createdBy = new Throwable(
                "Connection created from DBConnectionManager");
        DBConnection conn = new DBConnection(createdBy);
        System.out.println(conn.createdBy);
    }
} 
```

## 或者

```
public static interface ICallback<T> { T doOperation(); }

public class TestCallerOfMethod {

    public static <T> T callTwo(final ICallback<T> c){
        // Pass the object created at callee to the caller
        // From the passed object we can get; what is the callee name like below.
        System.out.println(c.getClass().getEnclosingMethod().getName());
        return c.doOperation();
    }

    public static boolean callOne(){
        ICallback callBackInstance = new ICallback(Boolean){
            @Override
            public Boolean doOperation() 
            {
                return true;
            }
        };
        return callTwo(callBackInstance);
    }

    public static void main(String[] args) {
         callOne();
    }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-01-18T08:33:18.640

使用这种方法： -

```
 StackTraceElement[] stacktrace = Thread.currentThread().getStackTrace();
 stackTraceElement e = stacktrace[2];//maybe this number needs to be corrected
 System.out.println(e.getMethodName()); 
```

方法示例代码的调用者在这里：-

```
public class TestString {

    public static void main(String[] args) {
        TestString testString = new TestString();
        testString.doit1();
        testString.doit2();
        testString.doit3();
        testString.doit4();
    }

    public void doit() {
        StackTraceElement[] stacktrace = Thread.currentThread().getStackTrace();
        StackTraceElement e = stacktrace[2];//maybe this number needs to be corrected
        System.out.println(e.getMethodName());
    }

    public void doit1() {
        doit();
    }

    public void doit2() {
        doit();
    }

    public void doit3() {
        doit();
    }

    public void doit4() {
        doit();
    }
} 
```

# c++ - 是什么让 g++ 包含 GLIBCXX_3.4.9？

> ID：421282
> 
> 赞同：4
> 
> 时间：2009-01-07T17:51:33.617
> 
> 标签：c++, linux, compiler-construction, g++, gnu

我使用 g++ 4.2.3 版在同一个 GNU/Linux 服务器上编译了 2 个不同的二进制文件。

第一个使用：

```
GLIBC_2.0
GLIBC_2.2
GLIBC_2.1
GLIBCXX_3.4
GLIBC_2.1.3 
```

第二个使用：

```
GLIBC_2.0
GLIBC_2.2
GLIBC_2.1
GLIBCXX_3.4.9
GLIBCXX_3.4
GLIBC_2.1.3 
```

为什么第二个二进制文件使用仅在 libstdc++.so.6.0.9 上可用*而不*在 libstdc++.so.6.0.8 上可用的 GLIBCXX_3.4.9

g++ 生成的需要 ABI 中断并强制系统具有 GLIBCXX_3.4.9 的新功能是什么？

有没有办法禁用这个新功能而不需要 GLIBCXX_3.4.9？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-08T04:58:55.327

要找出您的二进制文件实际上依赖于列出的 GLIBCXX_3.4.9 符号中的哪个，请执行以下操作：

```
readelf -s ./a.out | grep 'GLIBCXX_3\.4\.9' | c++filt 
```

一旦知道要查找哪些符号，就可以追溯到需要它们的对象：

```
nm -A *.o | grep _ZN<whatever> 
```

最后，要将其与源代码联系起来，您可以执行以下操作：

```
objdump -dS foo.o 
```

并查看哪个代码引用了 3.4.9 符号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T19:15:09.000

既然你要求它，这里有至少 ABI 版本 3.4.9 的符号：

```
GLIBCXX_3.4.9 {

    _ZNSt6__norm15_List_node_base4hook*;
    _ZNSt6__norm15_List_node_base4swap*;
    _ZNSt6__norm15_List_node_base6unhookEv;
    _ZNSt6__norm15_List_node_base7reverseEv;
    _ZNSt6__norm15_List_node_base8transfer*;

    _ZNSo9_M_insertI[^g]*;
    _ZNSt13basic_ostreamIwSt11char_traitsIwEE9_M_insertI[^g]*;
    _ZNSi10_M_extractI[^g]*;
    _ZNSt13basic_istreamIwSt11char_traitsIwEE10_M_extractI[^g]*;

    _ZSt21__copy_streambufs_eofI[cw]St11char_traitsI[cw]EE[il]PSt15basic_streambuf*;

    _ZSt16__ostream_insert*;

    _ZN11__gnu_debug19_Safe_sequence_base12_M_get_mutexEv;
    _ZN11__gnu_debug19_Safe_iterator_base16_M_attach_singleEPNS_19_Safe_sequence_baseEb;
    _ZN11__gnu_debug19_Safe_iterator_base16_M_detach_singleEv;
    _ZN11__gnu_debug19_Safe_iterator_base12_M_get_mutexEv;

    _ZNKSt9bad_alloc4whatEv;
    _ZNKSt8bad_cast4whatEv;
    _ZNKSt10bad_typeid4whatEv;
    _ZNKSt13bad_exception4whatEv;

} GLIBCXX_3.4.8; 
```

通过 c++filt运行文件`libstdc++-v3/config/abi/post/i386-linux-gnu/baseline_symbols.txt`，查找 GLIBCXX_3.4.9 以理解这些名称（它们看起来只是通配符）。我没有这样做，因为这些名字变得很长而且嵌套。后来的版本主要包括 c++1x 的东西。请参阅上述文件`libstdc++-v3/config/abi/pre/gnu.ver`。[在此处](http://www.bilmuh.gyte.edu.tr/gokturk/introcpp/gcc/ld_3.html#SEC39)阅读有关 VERSION 链接描述文件命令的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T18:24:44.843

那么第一个问题是您是如何生成上述列表的。
有人会假设编译器是确定性的，因此以相同的方式链接二进制文件。

我想我因为没有直接回答问题而被打分，但评论会很好。但我仍然认为您没有提供正确的信息，很高兴看到显示您的问题的命令输出。

假设您使用 ldd:
您将得到如下所示的输出：

```
lib<X>.so.<ver>  =>  /usr/lib/lib<X>.so.<verM>  (<Addr>) 
```

但这不是故事的结局。
尝试对文件执行 ls 可能是符号链接

```
> ls /usr/lilb/lib<X>.so.<verM>
lrwxrwxrwx 1 root root    <Date>  /usr/lib/lib<X>.so.<verM>  -> lib<X>.so.<verM>.<verm>.<verp> 
```

# python - 在 Python 中进行 Web 爬网的最佳预建库是什么

> ID：421283
> 
> 赞同：0
> 
> 时间：2009-01-07T17:52:07.623
> 
> 标签：python, web-crawler

我需要在本地抓取和存储以供将来分析有限网站列表的内容。我基本上想在所有页面中啜饮并按照所有内部链接获取整个公开网站。

是否有现有的免费图书馆可以让我到达那里？我见过奇尔卡特，但它是收费的。我只是在这里寻找基线功能。想法？建议？

* * *

完全重复：[有人知道我可以使用的基于 python 的网络爬虫吗？](https://stackoverflow.com/questions/419235/anyone-know-of-a-good-python-based-web-crawler-that-i-could-use)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T18:03:35.447

使用[Scrapy](http://scrapy.org/)。

它是一个基于twisted的网络爬虫框架。仍在大力开发中，但它已经可以工作了。有很多好东西：

*   内置支持解析 HTML、XML、CSV 和 Javascript
*   用于使用图像（或任何其他媒体）抓取项目并下载图像文件的媒体管道
*   支持通过使用中间件、扩展和管道插入您自己的功能来扩展 Scrapy
*   广泛的内置中间件和扩展，用于处理压缩、缓存、cookie、身份验证、用户代理欺骗、robots.txt 处理、统计、抓取深度限制等
*   交互式爬虫控制台，对开发和调试非常有用
*   用于监视和控制机器人的 Web 管理控制台
*   用于对 Scrapy 进程进行低级访问的 Telnet 控制台

通过在返回的 HTML 上使用 XPath 选择器，提取有关今天在[mininova种子站点中添加的所有种子文件的信息的示例代码：](http://www.mininova.org/)

```
class Torrent(ScrapedItem):
    pass

class MininovaSpider(CrawlSpider):
    domain_name = 'mininova.org'
    start_urls = ['http://www.mininova.org/today']
    rules = [Rule(RegexLinkExtractor(allow=['/tor/\d+']), 'parse_torrent')]

    def parse_torrent(self, response):
        x = HtmlXPathSelector(response)
        torrent = Torrent()

        torrent.url = response.url
        torrent.name = x.x("//h1/text()").extract()
        torrent.description = x.x("//div[@id='description']").extract()
        torrent.size = x.x("//div[@id='info-left']/p[2]/text()[2]").extract()
        return [torrent] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T17:56:36.240

你真的需要图书馆吗？我强烈推荐[Heritrix](http://crawler.archive.org)作为一个伟大的通用爬虫，它将保留整个网页（与只存储部分文本的更常见的爬虫相反）。边缘有点粗糙，但效果很好。

也就是说，你可以试试 HarvestMan [http://www.harvestmanontheweb.com/](http://www.harvestmanontheweb.com/)

# c# - Vista家长控制导致套接字异常？

> ID：421289
> 
> 赞同：1
> 
> 时间：2009-01-07T17:53:10.303
> 
> 标签：c#, .net, sockets, windows-vista, parental-control

前几天我收到了一个奇怪的错误报告，希望有人能帮助我找出罪魁祸首。我有一个插件，它使用 Facebook API 从桌面客户端程序进行调用。一位用户报告说，当他打开 Vista 的家长控制时，他遇到了运行时异常。

[详细的错误报告可在此处获得](http://www.codeplex.com/liveuploadfacebook/WorkItem/View.aspx?WorkItemId=8786)，并且我已经验证 Vista 的家长控制确实是问题所在。即使没有站点被阻止，即使`http://api.facebook.com`是特别允许的，我仍然得到异常。

犯法方法如下。具体来说，该行`string result = reader.ReadToEnd();` 是引发异常的地方。

```
 private static XmlDocument ExecuteQuery(SortedDictionary<string, string> parameters,
        string secretKey)
    {
        string query = GetQueryFromParameters(parameters, secretKey);
        HttpWebResponse response = null;

        try
        {
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(FACEBOOK_REST_URL);
            request.Method = "POST";
            request.ContentType = "application/x-www-form-urlencoded";

            // Write the POST parameters to Facebook.
            StreamWriter writer = new StreamWriter(request.GetRequestStream());
            writer.Write(query);
            writer.Close();

            // Get a response.
            response = request.GetResponse() as HttpWebResponse;
        }
        catch (WebException we)
        {
            // Getting the response must have thrown an HTTP error. We can still try to get the 
            // response from the caught exception though.
            response = we.Response as HttpWebResponse;
        }

        if (response != null)
        {
            // Read the response.
            StreamReader reader = new StreamReader(response.GetResponseStream());
            string result = reader.ReadToEnd();
            reader.Close();
            response.Close();

            XmlDocument responseXml = new XmlDocument();
            responseXml.LoadXml(result);
            return responseXml;
        }
        else
        {
            throw new FacebookException(Resources.FacebookResponseError);
        }
    } 
```

显然，我应该捕获 IOException，而不是让它成为运行时异常。但即便如此，问题仍然存在。我花了一些时间在谷歌上搜索这个问题，但没有找到关于家长控制的任何内容。

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T07:55:45.617

好吧，我不知道*为什么*会抛出异常，但至少如果我只是抓住它而不做任何事情，那么读者仍然会读到最后并且所有结果都被保存了。

# xslt - 使用 XSL 呈现整个网页的优点/缺点

> ID：421297
> 
> 赞同：12
> 
> 时间：2009-01-07T17:55:06.040
> 
> 标签：xslt

我正处于与客户一起计划一个项目以重做他们当前的网站的初步阶段。我查看了他们当前的站点以了解他们当前正在处理的问题，并且在检查后我注意到每个页面都是完全使用 XSLT 呈现的。我熟悉 XSLT，我用它来呈现需要在客户端经常刷新的自定义控件，但从不呈现整个页面。

帮助我变得不那么无知，这背后的原因是什么？这会给桌面带来什么好处或坏处？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T18:03:14.747

### 服务器端：

好处：

*   干净简洁的模板
*   一种将 XML 数据处理成 HTML 的简单方法
*   相当快

缺点：

*   许多过程语言程序员不熟悉和不舒服的编程模型
*   如果部分或全部源数据*不在*XML 中，则很尴尬
*   不小心使用时可能会很慢（小的变化可能会产生很大的影响）

* * *

### 客户端：

好处：

*   一种将处理负载转移到客户端代码的便捷方式，其中脚本可以更好地了解如何最好地格式化生成的 HTML。

缺点：

*   浏览器支持无处不在。
*   谷歌不会感谢你。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T18:02:26.387

听起来他们这样做是因为他们非常了解 XSL-T 并且手头已经有了 XML 数据。

我自己不喜欢这个解决方案。XSL-T 不是最容易读或写的东西。它不适合可视化页面的外观。它将设计师和 Web 开发人员排除在流程之外。而且它的国际化并不好。没有什么与 Java 资源包相当，可以提取特定于语言环境的信息。我不认为剪切和粘贴是一个好的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T18:04:17.833

## 客户端的 XSLT

*   禁用渐进式渲染。在整个样式表和数据完全加载之前，用户根本看不到任何东西。
*   搜索引擎和其他爬虫不支持。他们将看到原始 XML。
*   旧版/不太高级的浏览器不支持。

## 一般的 XSLT

*   除非您仔细设计样式表，否则它们很快就会变得难以维护：
    *   对于众多模板，可能很难确定应用了哪些模板。
    *   XSLT 和 XML 语法的冗长使得任何东西都难以一目了然。
    *   XPath 技巧很诱人，但以后修改却是噩梦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T19:54:14.963

我认为以正确的方式构建 XSLT 非常棒（我们在工作中使用模板框架）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T18:08:50.117

听起来像是全唱全跳的 XML 迷信。

既然您可以用 XSLT 做任何事情，那么不妨做任何事情。我曾有人问为什么数据仓库不仅仅是输入、数据集市和报告之间的 XSLT 转换。

优势。一切都在 XML 中。

缺点。

*   不太可读。您的页面模板被绑定为具有令人困惑的循环和条件处理功能的 XSLT 转换。

*   除了创建（和调试）HTML 和 CSS 的图形设计师之外，对页面模板的任何更改都需要 XSLT 专家。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T19:02:42.350

**最大的好处：** 平台中立的方式来呈现 xml

**xsl的最大缺点** 是难以维护

我曾经不得不使用超过 4,000 行的 xsl，其中还包括其他几个 xsl 模板。现在这很难处理！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T09:40:02.753

上面的答案很好地调查了 XSLT 的一些优点和缺点。我想补充另一个缺点。我们发现，在将 XSLT 用于中等大小的数据集时，您很快就会遇到可伸缩性问题。

在处理 XML 文件时，XSLT 必须将整个文档加载到内存中。使用 Xalan，这会消耗大约 10 倍于输入文件的大小（saxon 有一个使用更少内存的替代 DOM 实现）。如果您的任何输入数据集超过几百兆字节，您的 XSLT 处理器可能会崩溃。

# c# - .net 远程调用非本地应用程序域中的语音服务器工作流

> ID：421306
> 
> 赞同：0
> 
> 时间：2009-01-07T17:57:41.840
> 
> 标签：c#, .net, remoting, speech

我正在实现一个基于 Windows 工作流基础的 Microsoft Speech Server 应用程序。该应用程序管理其他子应用程序 - 用户调用并且管理器加载包含正确应用程序的程序集并调用工作流。

我面临的问题是语音服务或 iis 喜欢将程序集锁定到内存中，防止我覆盖 dll。这使得调试应用程序很痛苦，但一旦应用程序部署到生产环境，这也是完全不可接受的。

无法手动卸载单个特定程序集 - 程序集仅在其父应用程序域卸载时才被卸载。

因此，我尝试使用 .net 远程创建一个新的应用程序域，将程序集加载到该域中，通过代理创建工作流对象，然后我想传递该代理。

这是我要创建的类型的代码。它在我要加载的程序集中：

```
public class typeContainer : MarshalByRefObject
{
    public static Type workflowType = typeof(mainWorkflow);
} 
```

这是管理器中的代码：

```
AppDomain newDomain = AppDomain.CreateDomain("newdomain");
System.Runtime.Remoting.ObjectHandle oh = newDomain.CreateInstanceFrom(
                @"FullPathToAssembly",
                "namespace.typeContainer");
object unwrapped = oh.Unwrap(); 
```

所以问题是，我怎样才能在管理器中访问 typeContainer.workflowType ？oh.Unwrap() 产生一种 _TransparentProxy。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T21:23:01.650

简而言之，我在上面尝试做的事情是不可能的。简而言之，跨 AppDomains 发送 Type 会导致将程序集注入到当前域中。有关替代解决方案，请参阅[这篇文章](https://stackoverflow.com/questions/458699/how-do-i-implement-net-plugins-without-using-appdomains)。

# project-server - Project Server 中的 TS_ACT_VALUE 计算

> ID：421309
> 
> 赞同：1
> 
> 时间：2009-01-07T17:58:46.970
> 
> 标签：project-server

我正在尝试使用 c# 在 Project Server 中创建时间表条目，并遇到一个问题，即在某一天保存时间表行的小时数。

如果我查看数据集，则有一个`TS_ACT_VALUE`. 如果我使用 1 小时，它会显示 60000。有谁知道获得该值的计算是什么，或者另一种方法可以节省在时间表行项目上工作的小时数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-22T15:08:08.017

这仅仅是因为时间以毫秒为单位......只需将您的价值乘以 60000 在一小时内

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T17:39:11.633

约翰，

[根据http://msdn.microsoft.com/en-us/library/websvctimesheet.timesheetdataset.actualsrow.ts_act_value.aspx](http://msdn.microsoft.com/en-us/library/websvctimesheet.timesheetdataset.actualsrow.ts_act_value.aspx)上的文档，TS_ACT_VALUE 列“表示为此时间表行项目记录的实际成本”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T20:44:01.037

我知道该列的实际定义，但更感兴趣的是他们如何获得它的计算。当我查看示例数据时，该列可被 1000 整除

# list - 来自 SQL 调用的列表排序

> ID：421319
> 
> 赞同：1
> 
> 时间：2009-01-07T17:59:56.890
> 
> 标签：list, sql-order-by

我有一个从`daoTemplate.query()`通话中返回的列表，使用`rowMapper`.

SQL对列进行排序，恰好是日期列，当我使用列表时按asc排序，我总是保证列表将按照sql规定的顺序排列。我可以依赖第一个元素（`theList.get(0)`），总是最早的日期（在这种情况下）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T19:37:44.960

是的，如果您在日期列上订购，则在执行时，第一个项目将始终是最新的。

# javascript - 需要 AJAX 工作流方面的帮助

> ID：421326
> 
> 赞同：1
> 
> 时间：2009-01-07T18:01:34.047
> 
> 标签：javascript, asp.net-ajax

抱歉，我无法对标题进行更多描述，我将在下面详细说明：

我有一个 Web 应用程序，我想在其中实现一些 AJAX 功能。目前，它正在运行带有 VB.NET 代码隐藏的 ASP.NET 3.5。我当前的“问题”是当用户单击列表中的项目时，我希望能够动态填充 DIV。列表项当前包含`HttpUtility.UrlEncode()`应出现在 DIV 中的内容 (ASP.NET) 字符串。

例子：

```
 <li onclick="setFAQ('The+maximum+number+of+digits+a+patient+account+number+can+contain+is+ten+(10).');">
What is the maximum number of digits a patient account number can contain?</li> 
```

我可以使用 JavaScript 函数部分解码字符串，`unescape()`但不能完全解码字符串。我宁愿将 faq ID 传递给 JavaScript 函数，然后以某种方式从其来源的数据库中提取信息。

我 99% 确定不可能从 JavaScript 函数中调用 ASP 函数，所以我有点难过。我对 AJAX/ASP.NET 有点陌生，所以这对我来说是一次学习经历。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-09T16:32:42.703

首先，如果您在页面加载时从数据库中提取问题，那么您很可能也拥有所有答案，因此只需按照您的代码示例将答案插入页面，继续使用您当前的方法。除非您的常见问题解答列表有成千上万的问题，否则通过在每次单击列表项时点击数据库来执行“AJAX 方式”不会给您带来太多的 IMO。如果它确实有那么多问题，那么直接列出无论如何都是错误的方法。

其次，您的方法要记住两件事：

1.  您将 html 放在 html 属性中
2.  该属性指定要调用的 javascript 函数

所以你需要确保你的“答案”转义了 html*并且*是有效的 js。通过有效的 js，我的意思是它不能有新行并且必须正确地转义引号。例如，下面的 html - 虽然是有效的 html - 不会触发 onclick，你只会得到一个 js 语法错误：

```
<li onclick="setFAQ('This line's
multi line and has a single quote in it!')" 
```

为了解释这些，我会说`HttpUtility.HtmlAttributeEncode`更`System.Web.Script.Serialization.JavaScriptSerializer`适合您显示的标记。

```
JavaScriptSerializer json = new JavaScriptSerializer();
string answerString = "This line's\nmulti line and has a single quote in it!";
string onClickJS = String.Format("setFAQ({0})", json.Serialize(answerString));
string onClickAttr = HttpUtility.HtmlAttributeEncode(onClickJs); 
```

更好的是，使用 .NET 的`ListItem`对象并完全失去`HtmlAttributeEncode`：

```
ListItem faqItem = new ListItem(questionString);
faqItem.Attributes.Add("onclick", String.Format("setFAQ({0})", json.Serialize(answerString))); 
```

html 部分会自动为您转义，而且更简洁。

至于您的 javascript，您不必在`setFAQ()`. 只需将其参数放入您的“答案”div中：

```
function setFAQ(answer) {
    document.getElementById('answer').innerHTML = answer
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T18:14:13.757

我认为仅使用`HttpUtility.HtmlEncode`可以解决您的问题。我不确定我是否完全遵循：\

# sql - LINQ 2 SQL，错误的 SQL 生成

> ID：421329
> 
> 赞同：1
> 
> 时间：2009-01-07T18:02:36.243
> 
> 标签：sql, linq, linq-to-sql

我有一个具有以下结构的数据库表：

```
Id           int (identity)
Company      string
Cluster      string 
BU           string 
Department   string
SalesPoint   string 
```

**以下 LINQ 查询：**

```
var chEntities = from a in dataContext.CompanyHierarchies                                 
let parent = (dataContext.CompanyHierarchies.Where(ch => ch.Id == companyHierarchyId).Single())
where 
( 
                                (a.Company == (parent.Company == null ? a.Company : parent.Company)) && 
                                (a.Cluster == (parent.Cluster == null ? a.Cluster : parent.Cluster)) &&
                                (a.Company == (parent.BU == null ? a.BU : parent.BU)) &&
                                (a.Company == (parent.Department == null ? a.Department : parent.Department)) &&
                                (a.Company == (parent.SalesPoint == null ? a.SalesPoint : parent.SalesPoint))                                   
                             ) 
                             select new CompanyHierarchyEntity 
                             { 
                                 Id = a.Id,
                                 Name = a.SalesPoint == null ? (a.BU == null ? (a.Cluster == null ? (a.Company) : a.Cluster) : a.BU) : a.SalesPoint,
                                 CompanyHierarchyLevel = (CompanyHierarchyLevel)a.HierarchyLevel,
                                 Company = a.Company, 
                                 Cluster = a.Cluster, 
                                 BU = a.BU,
                                 Department = a.Department,
                                 Section = a.SalesPoint
                             }; 
```

**生成以下 SQL**

```
{SELECT 
(CASE
        WHEN [t0].[SalesPoint] IS NULL THEN
        (CASE 
            WHEN [t0].[BU] IS NULL THEN 
                (CASE 
                    WHEN [t0].[Cluster] IS NULL THEN [t0].[Company]
                    ELSE [t0].[Cluster]
                 END)
            ELSE [t0].[BU]
         END)
    ELSE [t0].[SalesPoint]
 END) AS [Name], [t0].[Id], [t0].[HierarchyLevel] AS [CompanyHierarchyLevel], [t0].[Company], [t0].[Cluster], [t0].[BU], [t0].[Department], [t0].[SalesPoint] AS [Section] 
```

**在此之后查询是错误的。 `Company`应该是`Company`, `Cluster`, `BU`, 等等，但`Company`在所有情况下都是如此。**

```
FROM [dbo].[CompanyHierarchy] AS [t0]
WHERE ([t0].[Company] = (
(CASE 
    WHEN ((
        SELECT [t1].[Company]
        FROM [dbo].[CompanyHierarchy] AS [t1]
        WHERE [t1].[Id] = @p0
        )) IS NULL THEN [t0].[Company]
    ELSE (
        SELECT [t2].[Company]
        FROM [dbo].[CompanyHierarchy] AS [t2]
        WHERE [t2].[Id] = @p0
        )
  END))) AND ([t0].[Cluster] = (
 (CASE 
    WHEN ((
        SELECT [t3].[Cluster]
        FROM [dbo].[CompanyHierarchy] AS [t3]
        WHERE [t3].[Id] = @p0
        )) IS NULL THEN [t0].[Cluster]
    ELSE (
        SELECT [t4].[Cluster]
        FROM [dbo].[CompanyHierarchy] AS [t4]
        WHERE [t4].[Id] = @p0
        )
 END))) AND ([t0].[Company] = (
(CASE 
    WHEN ((
        SELECT [t5].[BU]
        FROM [dbo].[CompanyHierarchy] AS [t5]
        WHERE [t5].[Id] = @p0
        )) IS NULL THEN [t0].[BU]
    ELSE (
        SELECT [t6].[BU]
        FROM [dbo].[CompanyHierarchy] AS [t6]
        WHERE [t6].[Id] = @p0
        )
 END))) AND ([t0].[Company] = (
(CASE 
    WHEN ((
        SELECT [t7].[Department]
        FROM [dbo].[CompanyHierarchy] AS [t7]
        WHERE [t7].[Id] = @p0
        )) IS NULL THEN [t0].[Department]
    ELSE (
        SELECT [t8].[Department]
        FROM [dbo].[CompanyHierarchy] AS [t8]
        WHERE [t8].[Id] = @p0
        )
 END))) AND ([t0].[Company] = (
(CASE 
    WHEN ((
        SELECT [t9].[SalesPoint]
        FROM [dbo].[CompanyHierarchy] AS [t9]
        WHERE [t9].[Id] = @p0
        )) IS NULL THEN [t0].[SalesPoint]
    ELSE (
        SELECT [t10].[SalesPoint]
        FROM [dbo].[CompanyHierarchy] AS [t10]
        WHERE [t10].[Id] = @p0
        )
 END))) 
```

}

有没有其他人遇到过类似的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T18:10:40.660

我认为这是你的问题：

```
(a.Company == (parent.BU == null ? a.BU : parent.BU)) &&
(a.Company == (parent.Department == null ? a.Department : parent.Department)) &&
(a.Company == (parent.SalesPoint == null ? a.SalesPoint : parent.SalesPoint)) 
```

不应该是：

```
(a.BU == (parent.BU == null ? a.BU : parent.BU)) &&
(a.Department == (parent.Department == null ? a.Department : parent.Department)) &&
(a.SalesPoint == (parent.SalesPoint == null ? a.SalesPoint : parent.SalesPoint)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T21:50:49.670

我用等效于`LEFT OUTER JOIN`. 我认为这样的东西是你正在寻找的。由于没有您的数据库，我无法真正检查生成的 SQL。

```
var chEntities = from a in dataContext.CompanyHierarchies
join parent in (from ch in dataContext.CompanHeirarchies
                where ch.Id == companyHierarchyId
                select ch) on 
    new {a.Company, a.Cluster, a.BU, a.Department, a.SalesPoint} 
    equals new {parent.Company, parent.Cluster, parent.BU, parent.Department, parent.SalesPoint} 
    into temp
from t in temp.DefaultIfEmpty()
select new CompanyHierarchyEntity
{
Id = a.Id,
Name = a.SalesPoint == null ? (a.BU == null ? (a.Cluster == null ? (a.Company) : a.Cluster) : a.BU) : a.SalesPoint, 
CompanyHierarchyLevel = (CompanyHierarchyLevel)a.HierarchyLevel,
Company = a.Company,
Cluster = a.Cluster,
BU = a.BU,
Department = a.Department,
Section = a.SalesPoint
}; 
```

我想您可以`.Single()`在 中的子查询之后添加一个`Join`，但我不确定这将如何影响您的结果。

让我知道它是否有效！

# java - Java-如何使用图像设置窗格的背景？

> ID：421337
> 
> 赞同：1
> 
> 时间：2009-01-07T18:03:58.287
> 
> 标签：java, background, panel, jpanel

我想知道是否有任何方法可以将 JPanel 的背景设置为图像而不仅仅是颜色。谢谢，我正在研究博士。爪哇

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T18:10:08.290

一种选择是像[这里](http://www.java2s.com/Code/Java/Swing-JFC/Panelwithbackgroundimage.htm)那样扩展 JPanel 。还有另一个（更简单的）示例在[JavaRanch](http://faq.javaranch.com/java/BackgroundImageOnJPanel)上使用相同的基本技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T08:32:39.950

您可以将 JPanel 子类化 - 这是我的 ImagePanel 的摘录，它将图像放置在 5 个位置中的任何一个位置：上/左、上/右、中/中、下/左或下/右：

```
public void setImage(Image img, int vs, int hs) {
    mmImage=img;
    mmVrtShift=vs;
    mmHrzShift=hs;
    mmSize=(img!=null ? new Dimension(img.getWidth(null),img.getHeight(null)) : null);
    }

public void setTopLeftImage(Image img, int vs, int hs) {
    tlImage=img;
    tlVrtShift=vs;
    tlHrzShift=hs;
    tlSize=(img!=null ? new Dimension(img.getWidth(null),img.getHeight(null)) : null);
    }

public void setTopRightImage(Image img, int vs, int hs) {
    trImage=img;
    trVrtShift=vs;
    trHrzShift=hs;
    trSize=(img!=null ? new Dimension(img.getWidth(null),img.getHeight(null)) : null);
    }

public void setBottomLeftImage(Image img, int vs, int hs) {
    blImage=img;
    blVrtShift=vs;
    blHrzShift=hs;
    blSize=(img!=null ? new Dimension(img.getWidth(null),img.getHeight(null)) : null);
    }

public void setBottomRightImage(Image img, int vs, int hs) {
    brImage=img;
    brVrtShift=vs;
    brHrzShift=hs;
    brSize=(img!=null ? new Dimension(img.getWidth(null),img.getHeight(null)) : null);
    }

...

protected void paintComponent(Graphics gc) {
    super.paintComponent(gc);

    Dimension                           cs=getSize();                           // component size

    gc=gc.create();
    gc.clipRect(insets.left,insets.top,(cs.width-insets.left-insets.right),(cs.height-insets.top-insets.bottom));
    if(mmImage!=null) { gc.drawImage(mmImage,(((cs.width-mmSize.width)/2)       +mmHrzShift),(((cs.height-mmSize.height)/2)        +mmVrtShift),null); }
    if(tlImage!=null) { gc.drawImage(tlImage,(insets.left                       +tlHrzShift),(insets.top                           +tlVrtShift),null); }
    if(trImage!=null) { gc.drawImage(trImage,(cs.width-insets.right-trSize.width+trHrzShift),(insets.top                           +trVrtShift),null); }
    if(blImage!=null) { gc.drawImage(blImage,(insets.left                       +blHrzShift),(cs.height-insets.bottom-blSize.height+blVrtShift),null); }
    if(brImage!=null) { gc.drawImage(brImage,(cs.width-insets.right-brSize.width+brHrzShift),(cs.height-insets.bottom-brSize.height+brVrtShift),null); }
    } 
```

# algorithm - 日期插入算法

> ID：421339
> 
> 赞同：-2
> 
> 时间：2009-01-07T18:04:06.413
> 
> 标签：algorithm, list, date

我有一个列表，它有 Foo 对象，每个 Foo 都有一个开始日期和一个结束日期。我想插入一个新的 Foo 对象，它有自己的开始和结束日期。

我希望列表中的元素在插入新的 Foo 对象时相应地更新它们的开始和结束日期，并让新的 Foo 对象在列表中找到它的正确位置。我会等待，看看这是否足以让某人理解我的问题，看看我是否需要进一步解释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T18:19:53.667

要找到插入点，您可以使用[插值搜索](http://en.wikipedia.org/wiki/Interpolation_search)（例如，将每个日期视为一个整数，以毫秒为单位），当插入项目时，它可以触发一个更新其邻居的方法，然后在收到更新请求时更新他们的邻居，下线。

我可能过度简化了您的问题，但根据我对您帖子的理解，这平均应该比 O(n) 时间多一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T19:10:31.227

您的新 Foo 对象需要遍历列表并找到需要插入的位置。但要小心，因为有很多边缘情况可能会弄乱你的列表。您的逻辑应该适用于以下情况：

```
 1) The new interval fits into an existing interval -- do nothing
   2) The new interval begins and ends before the first interval -- 
           insert it at the front of the list
   3) The new interval stretches the existing start, end, 
      or both without cutting across adjacent intervals --
          replace the start or end date on existing Foo.
   4) The new interval begins after the end of the previous interval, but 
      ends after the beginning of the next interval --
           walk the list with a sentinel until you find a Foo that begins before
           the end of your new Foo. Delete the Foos that fall in 
           between the current Foo and the sentinel, adjusting the 
           end time if necessary.
   5) The new interval begins after the end of the last interval --
           insert it at the end of the list. 
```

我可能遗漏了一个边缘案例，但这是我在解决非常相似的问题时使用的模型。

# svn - SVN 'svndiff 输入意外结束' 错误

> ID：421345
> 
> 赞同：3
> 
> 时间：2009-01-07T18:05:02.013
> 
> 标签：svn, version-control

我在使用 svn 时遇到问题，运行 'svn up' 会产生以下错误：

```
svn: Unexpected end of svndiff input 
```

具有讽刺意味的是，运行 'svnadmin verify repository_path' 也会返回相同的错误。它也发生在现有的工作副本和全新的工作副本上。

以前有人遇到过并解决过这个问题吗？我们已经使用 svn 很多年了，并且非常了解我们的方式，但是这个让我们很难过！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T18:46:32.787

如果

```
svnadmin verify repo/path 
```

返回相同的错误，然后您的存储库已损坏（可能是坏硬盘？）。

尝试运行

```
svnadmin recover repo/path 
```

如果这没有帮助，您可能必须从备份中恢复您的存储库。

# c# - 访问 GridViewCommandEventArgs 对象的非公共成员

> ID：421350
> 
> 赞同：0
> 
> 时间：2009-01-07T18:06:18.670
> 
> 标签：c#, asp.net, gridview

我在我的 aspx 页面上有一个 gridview，它使用一系列 ASP.NET LinkBut​​ton 对象设置 OnRowCommand 事件，以使用 CommandName 属性处理逻辑。我需要访问 GridViewRow.RowIndex 以从所选行中检索值，并在调试应用程序时注意它是 GridViewCommandEventArgs 对象的非公共成员

有没有办法可以访问这个属性是否有更好的实现？

这是我的源代码：

页面：

```
<asp:GridView ID="MyGridView" runat="server" OnRowCommand="MyGirdView_OnRowCommand">
    <Columns>
        <asp:TemplateField>
            <ItemTemplate>
                <asp:LinkButton 
                 id="MyLinkButton" 
                 runat="server" 
                 CommandName="MyCommand" 
                />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

后面的代码

```
protected void MyGirdView_OnRowCommand(object sender, GridViewCommandEventArgs e)
{
    //need to access row index here....
} 
```

**更新：**
@brendan - 我在以下代码行收到以下编译错误：

> “无法将类型 'System.Web.UI.WebControls.GridViewCommandEventArgs' 转换为 'System.Web.UI.WebControls.LinkBut​​ton'”

```
LinkButton lb = (LinkButton) ((GridViewCommandEventArgs)e.CommandSource); 
```

我稍微修改了代码，以下解决方案有效：

```
LinkButton lb = e.CommandSource as LinkButton;
GridViewRow gvr = lb.Parent.Parent as GridViewRow;
int gvr = gvr.RowIndex; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T18:34:26.960

不是世界上最干净的东西，但我过去就是这样做的。通常我会把它全部写成一行，但我会在这里分解它以便更清楚。

```
LinkButton lb = (LinkButton) ((GridViewCommandEventArgs)e.CommandSource);
GridViewRow gr = (GridViewRow) lb.Parent.Parent;
var id = gr.RowIndex; 
```

基本上你得到你的按钮并从一个按钮到另一个单元格，从一个单元格到另一个行。

这是单行版本：

```
 var id = ((GridViewRow)((LinkButton)((GridViewCommandEventArgs)e).CommandSource).Parent.Parent).RowIndex; 
```

# c# - asp:ImageButton 没有在 asp.net UpdatePanel 中触发？

> ID：421353
> 
> 赞同：0
> 
> 时间：2009-01-07T18:06:46.207
> 
> 标签：c#, asp.net

我有一个 asp:ImageButton 应该在单击时弹出一个保存对话框。当我把它放在 UpdatePanel 外面时，它工作正常，但是当我把它放在 UpdatePanel 里面时，对话框不会弹出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T20:39:16.133

Response.Write 通常在 UpdatePanels 中不起作用。假设您只是在客户端的 onclick 事件中运行一些 javascript，那么您最好将服务器端的 javascript 代码添加到 OnClientClick 属性中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T20:56:43.880

我在 GridView 中遇到了类似的问题，但通过在 LinkBut​​ton 中使用图像解决了它。[http://netpl.blogspot.com/2008/01/imagebutton-in-templatefield-does-not.html](http://netpl.blogspot.com/2008/01/imagebutton-in-templatefield-does-not.html)了解更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-16T08:06:49.820

txtmail.Attributes.Add("onkeydown","if(event.which || event.keyCode){if ((event.which == 13) || (event.keyCode == 13)) {document.getElementById(' "+Ibtnsend.UniqueID+"').click();return false;}} else {return true};");

onkeydown="submitOnEnter(this.Form1.Ibtnsend)"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T10:28:09.020

你在显示弹出窗口后调用 UpdatePanel.Update() 吗？

# .net - .NET WebBrowser 控件与 Adob e SVG 查看器

> ID：421356
> 
> 赞同：0
> 
> 时间：2009-01-07T18:07:49.963
> 
> 标签：.net, browser, svg

我在 .NET 2.0 WebBrowser 控件中加载 SVG 文件时遇到问题。如果我创建一个新的 WinForms 应用程序项目，将一个 WebBrowser 控件和一个按钮拖到 Form1.cs 设计图面上，并在按钮的单击处理程序中添加一行以将 WebBrowser 控件的 Url 属性设置为 SVG 文件，我在运行时出现两个 IE 脚本错误（如出现 Javascript 问题时出现的对话框）。因此，我正在编写的唯一代码行是：

```
webBrowser1.Url = new Uri(@"http://wiki.allegro.cc/pub/f/fb/Grozilla.svg"); 
```

如果我使用 IE 直接浏览链接，则此 SVG 文件可以正常加载；我通过我的测试应用程序得到的错误是：

```
line 2, char 1, error: Invalid character, followed by
line 1, char 1, error: Object expected 
```

（假设我对“继续在此页面上运行脚本”的提示回答“是”）。

我正在使用`IE 7.0.5730.13, Adobe SVG Viewer 3.03 build 94, Visual Studio 2008`. 任何人都可以复制这个吗？有没有人看到它/知道如何解决它？

（编辑：之前为了示例的目的在构造函数中设置了 URL，但这引发了控件是否已完成初始化的问题，因此已将示例更改为使用按钮 - 问题仍然存在。这个错误最初出现在生产代码中，所以我编写的示例程序试图隔离问题并尽可能简单地重现它。）

（编辑2：在几台不同的机器上测试过，这个问题似乎与IE7有关——运行IE6，一切正常。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T18:17:07.493

我发现在使用 WebBrowser 时，您无法在创建控件时调用导航到页面。

我通过创建一个计时器来解决这个问题，该计时器在加载表单时触发一次（在构造函数中启用它），然后在计时器的事件处理程序中，调用 Navigate 或设置 Url 属性，它应该可以工作。

我无法告诉你*为什么*我的生活。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-09T10:29:07.003

看起来将 SVG 文件的源网站添加到我的受信任的站点列表可以解决问题，所以这与 IE 安全性有关。

# java - 如何安全地更新具有多个读者和一个作者的文件？

> ID：421357
> 
> 赞同：3
> 
> 时间：2009-01-07T18:08:19.837
> 
> 标签：java, concurrency, filesystems, ntfs, atomic

我有一组文件。该文件集在 NTFS 共享上是只读的，因此可以有许多阅读器。每个文件由一个具有写访问权限的写入者偶尔更新。

我如何确保：

1.  如果写入失败，则表示之前的文件仍然可读
2.  读者无法支撑单个作者

我正在使用 Java，我目前的解决方案是让作者写入一个临时文件，然后使用`File.renameTo()`. 问题出在 NTFS 上，`renameTo`如果目标文件已经存在则失败，因此您必须自己删除它。但是如果作者删除目标文件然后失败（计算机崩溃），我没有可读的文件。

~~nio 的 FileLock 只适用于同一个 JVM，所以对我来说没用。~~

如何使用 Java 安全地更新具有多个阅读器的文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T18:15:42.460

根据[JavaDoc](http://java.sun.com/javase/6/docs/api/java/nio/channels/FileLock.html)：

> 此文件锁定 API 旨在直接映射到底层操作系统的本机锁定设施。因此，文件上的锁应该对所有有权访问该文件的程序可见，而不管这些程序是用什么语言编写的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T18:12:52.090

我不知道这是否适用，但如果您在纯 Vista/Windows Server 2008 解决方案中运行，我会使用 TxF（事务性 NTFS），然后确保您打开文件句柄并通过调用通过 JNI 提供适当的文件 API。

如果这不是一个选项，那么我认为您需要某种服务，所有客户端都可以访问该服务，该服务负责协调文件的读/写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T18:17:17.683

在 Unix 系统上，我会删除该文件，然后打开它进行写入。任何打开它以供阅读的人仍然会看到旧的，一旦他们全部关闭它，它就会从文件系统中消失。我不知道 NTFS 是否具有类似的语义，尽管我听说它基于 BSD 的文件系统而失败，所以也许它确实如此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T19:29:26.663

无论什么操作系统等，应该始终有效的东西正在改变您的客户端软件。

如果这是一个选项，那么你可以有一个文件“settings1.ini”，如果你想改变它，你创建一个文件“settings2.ini.wait”，然后把你的东西写进去，然后把它重命名为“settings2” .ini”，然后删除“settings1.ini”。

如果您更改的客户端软件最后读取了 settings1.ini，则它只会检查 settings2.ini，反之亦然。

这样你总是有一个工作副本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T18:26:35.667

可能不需要锁定。我对 Windows 上的 FS API 不太熟悉，但由于 NTFS 支持硬链接和软链接，AFAIK，如果你的设置允许，你可以试试这个：

使用硬链接或软链接指向实际文件，并以不同的方式命名文件。让每个人都可以使用链接的名称访问文件。

在同一文件夹中以不同的名称写入新文件。

完成后，让文件指向新文件。最佳情况下，Windows 将允许您通过在一个原子操作中替换现有链接来创建新链接。然后，您将有效地让链接始终识别有效文件，无论是旧文件还是新文件。在最坏的情况下，您必须先删除旧文件，然后创建指向新文件的链接。在这种情况下，程序将在短时间内无法找到该文件。（另外，Mac OS X 提供了一个“ExchangeObjects”功能，允许您以原子方式交换两个项目——也许 Windows 提供类似的东西）。

这样，任何已打开旧文件的程序都将继续访问旧文件，而您不会进入创建新文件的过程。只有当应用程序注意到新版本的存在时，它才能关闭当前并再次打开它，这样才能访问新版本。

但是，我不知道如何在 Java 中创建链接。也许您必须为此使用一些本机 API。

我希望这无论如何都会有所帮助。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-07T18:19:15.587

我最近一直在处理类似的事情。如果您正在运行 Java 5，也许您可​​以考虑将 NIO 文件锁与 ReentrantReadWriteLock 结合使用？确保所有引用 FileChannel 对象的代码也引用 ReentrantReadWriteLock。这样，NIO 将其锁定在每个 VM 级别，而可重入锁将其锁定在每个线程级别。

```
FileLock fileLock = filechannel.lock(position, size, shared);
reentrantReadWriteLock.lock();

// do stuff

fileLock.release();
reentrantReadWriteLock.unlock(); 
```

当然，需要一些异常处理。

# php - 如果您使用 POST 请求访问 GET 样式的 url，会发生什么？

> ID：421378
> 
> 赞同：0
> 
> 时间：2009-01-07T18:14:35.003
> 
> 标签：php, post, get

假设我有一个名为的页面`display.php`，用户正在查看`display.php?page=3`. 我想允许用户通过 POST 请求进行投票等操作，然后将他们带回他们所在的页面。那么，如果我发出 POST 请求，`display.php?page=3`页面信息是否也可用于脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T18:40:20.117

简单的答案是“是”。您可以使用 GET 样式的 URL 作为 POST 表单的提交 URL。提交表单时，PHP 将以通常的方式获得 POST 和 GET 信息。

这并不是说您*应该*这样做，但它会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T18:25:40.490

在 PHP 中，您可以从特殊的全局数组中获取请求变量：

```
$_GET['page'] (for GET requests)
$_POST['page'] (for POST requests)
$_REQUEST['page'] (for either) 
```

听起来您正在寻找“发布后重定向”，我建议将 display.php 和 vote.php 分离到单独的文件中。投票看起来像这样：

```
<?php
//vote.php
$page_number = (int)$_REQUEST['page'];
vote_for_page($page_number); //your voting logic
header('Location: display.php?page=' . $page_number); //return to display.php 
```

请注意，盲目接受未经处理的表单数据可能会对您的应用程序造成危害。

编辑：有些人认为使用 $_REQUEST 处理这两种情况是不好的形式。危险在于，如果您在期望 POST 时收到 GET，您可能希望发出错误信号。通常 GET 保留用于查看，POST 保留用于进行更改（创建/更新/删除操作）。这是否真的是一个问题取决于您的应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T18:46:30.900

是的，无论请求方法如何，GET 数组始终填充 URL 参数。您可以使用这样的简单页面进行尝试：

```
<form action="test.php?a=b" method="post">
    <input name="a"/>
    <input type="submit"/>
</form>
<pre>
POST:
<?php print_r($_POST); ?>
GET:
<?php print_r($_GET); ?>
</pre> 
```

# sql - SQL Server - 在子查询中使用列别名

> ID：421379
> 
> 赞同：0
> 
> 时间：2009-01-07T18:14:35.660
> 
> 标签：sql, sql-server, nested

我有以下查询，它适用于 MySQL，但拒绝适用于 SQL 服务器：

```
SELECT table1.someField AS theField, 
       COUNT(table2.someField) / (SELECT COUNT(someField) FROM table1 WHERE someField = theField),
FROM table1 LEFT JOIN table2 ON table1.someField = table2.someField 
```

SQL Server 似乎不喜欢子查询中的别名。有人告诉我我需要使用 CTE，但我以前从未使用过它们。它是否正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T18:18:13.827

问题很可能在于子查询中的混乱

```
SELECT COUNT(someField) FROM table1 WHERE someField = theField 
```

条件将`someField`是本地的 - 但你可以得到`table1.someField`同样的结果。

怎么样

```
SELECT COUNT(t3.someField) FROM table1 t3 WHERE t3.someField = table1.someField 
```

?

# user-interface - 在 Web 应用程序中支持多种分辨率的最佳实践是什么？

> ID：421380
> 
> 赞同：1
> 
> 时间：2009-01-07T18:14:43.520
> 
> 标签：user-interface

使 Web 应用程序支持多种分辨率的最佳实践是什么？特别是宽屏与正常宽高比的分辨率。

似乎没有一个简单的答案 - 除了简单地支持一些固定分辨率并使用一些绝对定位来使布局正常工作之外。

当然，跨浏览器变得更加困难。

有没有人有这个问题的好资源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T18:28:07.050

您始终可以尝试使用*流动布局*结构，其中元素的宽度与浏览器窗口的宽度成比例。

这是一篇很好的文章，解释了不同的布局，包括流式布局。

[http://www.maxdesign.com.au/presentation/liquid/](http://www.maxdesign.com.au/presentation/liquid/)

PS。上述网站 (maxdesign.com.au) 本身使用的是流式布局，因此请在阅读文章时尝试更改浏览器的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T18:26:40.143

一种快速、简单、相当健壮的方法是使用[Blueprint](http://www.blueprintcss.org/)或[960gs](http://960.gs/)之类的框架来布局站点。它们独立于浏览器，因此您无需担心这一点，并且它们使大多数列布局非常容易。

他们都致力于为您的内容创建一个宽度在 900 到 1000 像素之间的固定大小的容器。如今，大多数人至少以 1024x768 的分辨率运行。如果您需要比内容更大的宽度，那么您可能做错了。

~960px 可能不起作用的一个领域是手机……但这就是[移动样式表](http://alistapart.com/articles/returnofthemobilestylesheet)的用途，对吧？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T18:38:40.947

在 Opera 和 Safari（尤其是它们的移动版本）中，您可以使用[CSS3 媒体查询](http://www.w3.org/TR/css3-mediaqueries/)，它可以让您为不同的屏幕分辨率声明完全不同的样式。

这可以在其他浏览器中使用 Javascript 进行模拟 - <a href="http://www.alistapart.com/articles/switchymclayout" rel="nofollow noreferrer">Alistpart: Switchy McLayout

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T18:18:20.567

您也可以使用百分比来设置宽度和高度，但这有时也很困难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T18:23:56.577

您在这里有两个选择：

1.  固定宽度布局
2.  流程布局

两者都有优点和缺点，最终，哪个是最佳选择是一个设计决定。

# java - 摆动按钮不会立即做出反应！我该如何改变呢？

> ID：421381
> 
> 赞同：3
> 
> 时间：2009-01-07T18:14:47.610
> 
> 标签：java, swing

我用 Netbeans 的可视化编辑器构建了一个表单。当我按下其中一个按钮时，它应该执行以下操作：

*   将其设置为禁用
*   执行需要一些时间的任务
*   当任务完成时，按钮将再次启用

但是，会发生以下情况：

*   按钮保持按下状态，直到任务完成
*   任务完成后，按钮的启用/禁用将非常快（它们会发生，但您不会注意到它们）

这种行为不是我想要的。我尝试在 JButton、JFrame 甚至包含该按钮的 JPanel 上使用重绘，但我似乎无法让它做我想做的事。一些提示？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-07T18:20:38.360

当您在按钮回调中工作时，您将暂停 GUI 绘制线程，直到它完成。

您需要做的是生成一个线程来执行长时间运行的任务，然后让该线程`SwingUtilities.invokeLater()`在完成时使用它来更新 UI。不使用`invokeLater`不是线程安全的，通常是不好的魔力。

一个基本的例子是：

```
button.setEnabled(false);
new Thread(new Runnable() {
 public void run() {
  // Do heavy lifting here
  SwingUtilies.invokeLater(new Runnable() {
   public void run() {
    button.setEnabled(true);
   }
  });
 }
}).start(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-07T18:19:25.307

当您在按钮回调中执行操作时，您实际上是在停止 gui 绘制线程 - 不仅仅是按钮，而是任何 gui 绘制。（尝试用另一个窗口覆盖界面，然后再次暴露它 - 在任务完成之前它不会重新绘制！）

您需要做的是生成一个线程来执行长时间运行的任务，然后让该线程使用 SwingUtilities.invokeLater() 来启用按钮。invokeLater 强制按钮启用在 gui 绘画线程中发生。

在长时间运行的线程正在运行时，您可能想要设置一个繁忙的光标或以其他方式锁定界面。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T18:48:36.247

Sun的[**Concurrency in Swing**教程](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/index.html)非常值得一读。优秀的讲解和背景阅读，包括事件派发线程、使用工作线程等

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T18:20:03.573

您需要在不同的线程中执行需要一些时间的任务。

按钮阻塞的原因是因为工作是在绘制按钮的同一个线程中完成的。一旦工作完成，按钮就可以完成您告诉它的其余工作。

如果您使用不同的线程，该线程将执行任务，而绘图代码可以继续绘制表单。

# validation - 使用 Access 2003 ADP 项目执行表单验证

> ID：421382
> 
> 赞同：2
> 
> 时间：2009-01-07T18:14:51.977
> 
> 标签：validation, ms-access, vba

我正在开发一个使用 MS SQLServer 后端的 Access 2003 数据库。

我正在尝试进行表单验证并且遇到了一些问题。

1.  每个字段的 ValidationRule 似乎都被忽略了
2.  我不知道我应该重写什么事件来强制验证，而无需数据库执行它。（我并不反对这一点，我只是不知道如何捕获错误消息，而不是向用户显示它们）

我已经尝试通过禁止关闭并强制使用“关闭按钮”来绕过第 2 号，但用户可以通过按 Tab 或按底部的“下一个记录”按钮来绕过它。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T18:36:59.157

如果您给我们一个验证规则的示例，它可能会有所帮助。

但是，我一直有将验证放在更新前的习惯（尤其是当我有更复杂的验证算法时）

更新：我做了一些实验，似乎只有在您更新该字段时才检查该字段的验证规则，但如果您在表单上的其他地方进行更新，而不是在您保存记录时，则不会检查。所以我认为您的解决方案是将验证移至 Form_BeforeUpdate。

或者，您可以使表中的列不为空 - 这将强制用户对该字段执行某些操作。

或者，如果该字段必须是“测试”，那么您可以通过设置默认值并锁定该字段以使用户无法更改它来绕过整个事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T20:21:52.547

如果您使用验证规则属性，则可以在 Form Error 事件中捕获验证和重复键错误等：

```
Private Sub Form_Error(DataErr As Integer, Response As Integer)
   If DataErr=2107 Then
      MsgBox "Validation error! "  & ActiveControl.Name
   End If
End Sub 
```

您可以强制使用带有在表单级别定义的变量并设置为 false 的关闭按钮，除非您的按钮被单击。

```
Option Compare Database
Option Explicit

Public AllowClose As Boolean

Private Sub Form_Load()
    AllowClose = False
End Sub

Private Sub Form_Unload(Cancel As Integer)
    Cancel = Not AllowClose
End Sub
Private Sub cmdClose_Click()
On Error GoTo Err_cmdClose_Click

    AllowClose = True
    DoCmd.Close

Exit_cmdClose_Click:
    Exit Sub

Err_cmdClose_Click:
    MsgBox Err.Description
    Resume Exit_cmdClose_Click

End Sub 
```

来自：[http ://www.tek-tips.com/faqs.cfm?fid=2071](http://www.tek-tips.com/faqs.cfm?fid=2071)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T02:18:49.370

您可以通过将表单的导航按钮属性设置为“否”来隐藏导航按钮。您还可以通过将表单的 Cycle 属性设置为“当前记录”来禁止跳到新记录。

对于 Access 中的任何非平凡的应用程序界面，我通常会非常严格地锁定表单并根据需要提供我自己的导航按钮、关闭按钮等。

# c# - 这个 thread.abort() 正常且安全吗？

> ID：421389
> 
> 赞同：20
> 
> 时间：2009-01-07T18:16:53.190
> 
> 标签：c#, multithreading

我创建了一个自定义自动完成控件，当用户按下一个键时，它会在另一个线程上查询数据库服务器（使用远程处理）。当用户打字非常快时，程序必须取消之前执行的请求/线程。

我之前先将它实现为 AsyncCallback，但我觉得它很麻烦，要遵循的内部规则太多（例如 AsyncResult、AsyncState、EndInvoke），而且您必须检测 BeginInvoke 对象的线程，这样您就可以终止之前执行的线程. 此外，如果我继续 AsyncCallback，那些 AsyncCallback 上没有任何方法可以正确终止先前执行的线程。

EndInvoke 不能终止线程，它仍然会完成被终止线程的操作。我最终还是会在线程上使用 Abort() 。

所以我决定用纯线程方法来实现它，没有 AsyncCallback。这个 thread.abort() 对你来说正常和安全吗？

```
public delegate DataSet LookupValuesDelegate(LookupTextEventArgs e);

internal delegate void PassDataSet(DataSet ds);

public class AutoCompleteBox : UserControl
{
   Thread _yarn = null;

   [System.ComponentModel.Category("Data")]
   public LookupValuesDelegate LookupValuesDelegate { set; get; }

   void DataSetCallback(DataSet ds)
   {
      if (this.InvokeRequired)
         this.Invoke(new PassDataSet(DataSetCallback), ds);
      else
      {
         // implements the appending of text on textbox here
      }
   }

   private void txt_TextChanged(object sender, EventArgs e)
   {
      if (_yarn != null) _yarn.Abort();

      _yarn = new Thread(
         new Mate
         {
            LookupValuesDelegate = this.LookupValuesDelegate,
            LookupTextEventArgs =
            new LookupTextEventArgs
            {
               RowOffset = offset,
               Filter = txt.Text
            },
            PassDataSet = this.DataSetCallback
         }.DoWork);

      _yarn.Start();
   }
}

internal class Mate
{
   internal LookupTextEventArgs LookupTextEventArgs = null;

   internal LookupValuesDelegate LookupValuesDelegate = null;

   internal PassDataSet PassDataSet = null;

   object o = new object();
   internal void DoWork()
   {
      lock (o)
      {
         // the actual code that queries the database
         var ds = LookupValuesDelegate(LookupTextEventArgs);
         PassDataSet(ds);
      }
   }
} 
```

### 笔记

用户连续敲键时取消上一个线程，不仅是为了防止文本的追加，也是为了取消之前的网络往返，这样程序就不会因为连续而占用太多内存网络运营。

我担心如果我完全避免 thread.Abort()，程序可能会消耗太多内存。

这是没有 thread.Abort() 的代码，使用计数器：

```
internal delegate void PassDataSet(DataSet ds, int keyIndex);

public class AutoCompleteBox : UserControl
{
   [System.ComponentModel.Category("Data")]
   public LookupValuesDelegate LookupValuesDelegate { set; get; }

   static int _currentKeyIndex = 0;

   void DataSetCallback(DataSet ds, int keyIndex)
   {
      if (this.InvokeRequired)
         this.Invoke(new PassDataSet(DataSetCallback), ds, keyIndex);
      else
      {
         // ignore the returned DataSet
         if (keyIndex < _currentKeyIndex) return; 

         // implements the appending of text on textbox here...
      }
   }

   private void txt_TextChanged(object sender, EventArgs e)
   {
      Interlocked.Increment(ref _currentKeyIndex);

      var yarn = new Thread(
         new Mate
         {
            KeyIndex = _currentKeyIndex,
            LookupValuesDelegate = this.LookupValuesDelegate,
            LookupTextEventArgs =
            new LookupTextEventArgs
            {
               RowOffset = offset,
               Filter = txt.Text
            },
            PassDataSet = this.DataSetCallback
         }.DoWork);

      yarn.Start();
   }
}

internal class Mate
{
   internal int KeyIndex;
   internal LookupTextEventArgs LookupTextEventArgs = null;
   internal LookupValuesDelegate LookupValuesDelegate = null;
   internal PassDataSet PassDataSet = null;

   object o = new object();
   internal void DoWork()
   {
      lock (o)
      {
         // the actual code that queries the database
         var ds = LookupValuesDelegate(LookupTextEventArgs);
         PassDataSet(ds, KeyIndex);
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-07T18:24:46.683

不，这**不安全**。`Thread.Abort()`在最好的情况下已经足够粗略了，但在这种情况下，您的控件无法（呵呵）控制委托回调中正在执行的操作。您不知道应用程序的其余部分将处于什么状态，并且当再次致电代表时，您可能会发现自己处于一个受伤的世界。

设置一个计时器。在文本更改后稍等片刻，然后再调用委托。然后等待它返回，然后再次调用它。如果速度*那么*慢，或者用户输入速度*那么*快，那么他们可能无论如何都不会期望自动完成。

### 关于您更新的（Abort()-free）代码：

您现在正在（可能）为*每个 keypress*启动一个新线程。这不仅会降低性能，而且是不必要的——如果用户没有暂停，他们可能不是在寻找控件来完成他们正在输入的内容。

我早些时候谈到了这一点，但[P Daddy 说得更好](https://stackoverflow.com/questions/421389/is-this-thread-abort-normal-and-safe#421445)：

> 你最好只实现一个单次计时器，可能有半秒的超时，并在每次击键时重置它。

想一想：快速打字员可能会在第一个自动完成回调有机会完成之前创建许多线程，即使快速连接到快速数据库也是如此。但是，如果您将请求延迟到最后一次击键过去后的一小段时间，那么您就有更好的机会到达用户输入他们想要的所有内容（或他们知道的所有内容！）的最佳位置，并且*只是*开始等待自动完成启动。玩延迟 - 半秒可能适合不耐烦的触摸打字员，但如果您的用户更放松......或者您的数据库更慢......那么您可能会在 2-3 秒的延迟甚至更长的时间内获得更好的结果。不过，这项技术最重要的部分是您`reset the timer on every keystroke`.

除非您希望数据库请求实际*挂起*，否则不要费心尝试允许多个并发请求。如果一个请求当前正在进行中，请等待它完成后再发出另一个请求。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-07T18:27:15.227

[网上](http://www.google.com/search?q=Thread.Abort)[有](http://blogs.msdn.com/ankur/archive/2005/11/30/498293.aspx)[很多](http://msmvps.com/blogs/senthil/archive/2008/12/17/the-dangers-of-thread-abort.aspx) [关于](http://www.interact-sw.co.uk/iangblog/2004/11/12/cancellation)使用. [_](http://www.manning-sandbox.com/message.jspa?messageID=33703) [_](http://haacked.com/archive/2004/11/12/how-to-stop-a-thread.aspx) 除非真的需要，否则我建议避免使用它，在这种情况下，我认为不需要。你最好只实现一个单次计时器，可能有半秒的超时，并在每次击键时重置它。这样，您的昂贵操作只会在用户不活动半秒或更长时间（或您选择的任何长度）后发生。 `Thread.Abort`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T18:24:07.637

您可能想看看[An Introduction to Programming with C# Threads](http://birrell.org/andrew/papers/ThreadsCSharp.pdf) - Andrew D. Birrell。他概述了 C# 中围绕线程的一些最佳实践。

在第 4 页，他说：

> 当您查看“System.Threading”命名空间时，您会（或应该）对面临的选择范围感到畏惧：“Monitor”或“Mutex”；“等待”或“AutoResetEvent”；“中断”还是“中止”？幸运的是，有一个简单的答案：使用“lock”语句、“Monitor”类和“Interrupt”方法。这些是我将用于本文其余部分的大部分功能。现在，您应该忽略“System.Threading”的其余部分，尽管我将在第 9 节为您概述它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T18:46:54.720

不，我会避免在您自己的代码上调用 Thread.Abort。您希望自己的后台线程正常完成并自然展开其堆栈。我可能会考虑调用 Thread.Abort 的唯一一次是在我的代码在另一个线程上托管外来代码的情况下（例如插件场景），我真的想中止外来代码。

相反，在这种情况下，您可以考虑简单地对每个后台请求进行版本控制。在回调中，忽略“过时”的响应，因为服务器响应可能以错误的顺序返回。我不会太担心中止已经发送到数据库的请求。如果您发现您的数据库没有响应或被太多请求所淹没，那么请考虑使用其他人建议的计时器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-04T22:15:36.127

仅在`Thread.Abort`您退出应用程序并知道所有重要资源都已安全释放时用作最后手段。

否则，不要这样做。那时更糟

```
try
{
//  do stuff
}
catch { } //  gulp the exception, don't do anything about it 
```

安全网...

# c# - 有没有办法从 C# 中的方法创建和返回新变量？

> ID：421391
> 
> 赞同：0
> 
> 时间：2009-01-07T18:17:14.857
> 
> 标签：c#, .net

基本上就像使用 out 关键字一样。但是问题在于 out 关键字，您仍然必须在方法调用之外声明一个变量，例如：

```
double result;
Double.TryParse ( "76", out result ); 
```

我想要类似的东西：

```
Double.TryParse ( "76", out result ); 
```

在那里我得到了一个名为 result 的新变量。

有没有办法做到这一点（通过使用或不使用）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T18:18:52.030

不，您必须先声明变量，因为您将它传递给方法，唯一的区别是您明确要求方法在返回之前填写它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T18:22:15.363

此外，您可以“重新抛出”它，也就是说，您可以再次将它向上传递到堆栈中。例如：

```
public void MyMethod(out int MyParam)
{
    SomeMethod(out MyParam);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T05:31:09.180

您可以使用[C# 元组](http://rabdullin.com/journal/2008/9/30/using-tuples-in-c-functions-and-dictionaries.html)将**多个变量组合成一个**.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T06:27:13.387

变量必须在使用前声明，参数过多的方法很快就会变得很臭。尤其是输出参数。

我认为您要做的是声明一个包含五个或六个变量的类，并将其作为参数传递给方法：

```
class Args
{
  public int One { get; set; }
  public int Two { get; set; }
  public int Three { get; set; }
  public int Four { get; set; }
  public int Five { get; set; }
} 
```

然后将其作为参数的方法：

```
public void Foo(Args args)
{
  // Modify members of args here.
} 
```

并像这样使用它：

```
Args args = new Args();

Foo(args);

// Do stuff with results in args. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T18:19:54.603

在通话之前声明它有什么问题？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T18:20:37.613

你为什么要这样做？没有理由不在方法调用之前声明它，省去几次击键。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T18:21:46.127

有没有对你的情景有意义的案例？

为了在调用函数后使用变量，您必须知道变量的类型。否则你会忽略编译器的类型安全并且很容易遇到运行时错误。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T19:44:09.097

不，您必须将其包装在另一个声明局部变量然后返回它的方法中。

通过您给出的具体示例，您可以使用：

```
Double d = Double.Parse( "76" ); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-07T19:23:07.707

变量存在于堆栈上，而不是堆上，因此调用函数来创建新变量的概念——虽然这是一个有趣的想法，但在其他语言中并非不可能——这意味着您不了解 C# 中变量和对象之间的区别.

*   变量的存储分配在堆栈上，并且该变量仅在声明该变量的函数执行期间存在

这与“成员变量”不同，“成员变量”是属于对象的字段。

C# 中的“out”关键字意味着一个变量将“通过引用”传递给函数，并且该函数应该（需要）设置变量的值。

一般来说，应该避免使用“out”参数；如果您需要从函数中传递多个值，它们可能属于丢失的对象！

编辑：在 C# 中，“out”参数类似于“ref”参数，因为它们都是[按引用调用的](http://en.wikipedia.org/wiki/Evaluation_strategy#Call_by_reference)参数，而不是更典型的按值调用参数。

# .net - 将数据导入 Windows 工作流实例

> ID：421398
> 
> 赞同：0
> 
> 时间：2009-01-07T18:18:21.517
> 
> 标签：.net, workflow-foundation

我们目前正在构建一个系统，该系统从其他一些系统中抽象出有关 Web 服务的各种技术细节。它有点像企业总线，但功能更多。

我们决定使用 Windows Workflow 来处理请求。一旦我们弄清楚请求了什么样的操作，我们将启动一个专门设计用于处理该操作的工作流。现在，我们将调用的一些 Web 服务是异步的，因此工作流应该等待响应。基本思想是，我们将在我们端实现回调 Web 服务，当回调“以某种方式”到达时，将其数据提供给正在等待答案的正在运行的工作流。

到目前为止，我已经看到了两种可能性：

1.  外部数据交换服务
2.  工作流队列服务

第一个服务相对容易使用，但是是基于事件的，所以如果你错过了事件，你就会错过数据。我们需要一个基于队列的解决方案，因为从技术上讲，甚至在我们获得告诉我们很快会收到回调的同步响应之前，就可以从 Web 服务接收回调。

第二项服务似乎很完美，但它的使用方式非常有限。将项目放入队列非常简单，但我们需要先确保队列存在，然后才能执行此操作。并且创建队列似乎只能在 Activity 的 Execute 覆盖中实现。由于我们有很多不同的工作流，我们有一个基础工作流类，它在它的 Initialize 覆盖中做了一些工作，并且非常希望在那里创建队列，所以我们不必创建一个特殊的“Initialize”活动每个工作流程都应该开始。我们还希望在收到新项目时通知基类。因此，特定的工作流只需要等待 WaitHandle 就可以知道队列中有数据。

有没有人有想法，不必使用我提到的两个服务，但我们真的希望让事情尽可能简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T13:11:52.523

在 WF 中，运行时或服务与实际工作流之间的所有通信都是基于队列的。ExternalDataExchangeService 似乎使用事件，但这些只是围绕 WorkflowQueuingService 和 WorkflowQueue 机制的一个薄层。

一般来说，我更喜欢使用 WorkflowQueuingService，因为它可以提供完全控制。一旦您了解了基础知识，在大多数情况下使用 ExternalDataExchangeService 会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T22:37:01.863

事实证明我的假设是错误的。我 100% 确定我已经测试了该场景并遇到了问题，但在与同事讨论后，我重新测试了它，并且 ExternalDataExchangeService 工作得很好。因此无需寻找更复杂的解决方案，现在我们只需要使用 ExternalDataExchangeService 即可。

# api - 构建一个基本的会计应用程序

> ID：421405
> 
> 赞同：2
> 
> 时间：2009-01-07T18:19:43.357
> 
> 标签：api, finance, accounting

我正在构建一个用于个人理财的简单会计应用程序。

用户可能会跟踪购买、即将到来的账单、定期存款等。这将非常简单。

两个问题：

1）我应该记住什么建议？显然，我将在适当的情况下使用事务，但最好了解正确的数据类型和其他注意事项。

2) 您知道我可以使用任何 API 来定期从他们的银行获取用户的余额吗？即，无论他们是在 Chase、BofA 还是其他机构，都可以轻松查询他们的帐户的 API？

非常感谢，

迈克尔

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T19:03:58.367

刚刚为学校相关的非营利组织完成了一些定制的在线会计软件的 1.0 版，我有一些建议:)

*   使用标准复式记账/簿记（借记和贷记）作为您的财务引擎的基础。您会发现这不仅可以存储交易数据，还可以生成报告。资产 = 负债 + 股权是一种经过验证的、真实的方法来跟踪谁拥有什么。
*   使用十进制类型的钱。
*   使用事务。
*   使界面尽可能简单。
*   您将需要一种方法来允许用户将银行记录与他们自己的记录进行核对。提取银行数据将有助于此过程，但您需要为用户提供一种比较方法。您可以在此流程中使用银行对账单。
*   银行总是被认为是正确的。如果银行和用户记录之间存在差异……故障几乎总是出在用户记录上。
*   确保为用户提供某种备份工具
*   保护用户数据
*   确保您完全了解您正在自动化的过程。不要做假设。由专门研究个人理财的会计师来管理您的想法。进行此审查将有很大帮助。
*   准备好编写大量代码。会计软件已经存在多年，典型会计软件包的“标准功能”列表已经增加，市场上有相当多的参与者。如果您打算销售此产品，您将需要提供这些标准功能，然后找到某种方式将其与已有附加功能的产品区分开来。
*   测试测试测试并再次测试。您正在记录人们的个人金融交易（他们的钱）。错误不会掉以轻心。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-27T14:52:45.133

当我完成一个专注于会计的 POS 系统时，我将添加一些提示——这意味着需要跟踪购买、费用、发票、账户、信用卡、现金、车辆等。这些概念最终将应用于个人系统。

最好的建议是查看您的文书工作，并尝试围绕将物理文档翻译到计算机所需的操作来构建您的数据库。将此与会计教科书的前几章结合起来，该教科书讨论了帐户、会计科目表和日记帐。

我使用的书籍：George Murray 的《Accounting at your fingertips》 苏珊娜·卡普兰（Suzanne Caplan）的财务和企业家会计 安斯沃思（Ai​​nsworth）的会计导论 霍兰德（Hollander）的会计、信息技术和商业解决方案

将源文档输入系统后，您可以运行查询以获得答案。这样做消除了“总帐”和“试算表”的概念，因为您只需更正或添加到您的源文档。所以“总账”变成了计算。这让我非常困惑。同样，所有源文档都将放入“期刊”中，可以是您的数据库表。我使用一般日记帐、采购日记帐、付款或现金支出日记帐、销售日记帐和现金收据日记帐。请记住，“现金”一词是指现金、信用卡、支票、借记卡。

例如，我有一个“普通日记”，基本上就是你需要的。在这本日记中，我记录了“来源收据”。收据可能是发票，如时代华纳有线电视，它有一个帐号。在这种情况下，我为时代华纳创建了一个“帐户”。时代华纳账户将链接到“账户图表”，该账户将指定费用类型为“互联网”。然后输入发票，其中包含日期、金额等。发票链接到时代华纳的帐户。一旦输入发票，它是未付款的。然后，您需要添加付款。当然，您可以按应有的方式全额支付账单，但您可能需要分两次付款，或分期付款，或不全额付款。这将引导您进入“付款日志”以及“发票到付款查找表” 这需要有一个应用金额才能应用于发票。这个应用的金额很重要，因为您可能有 4 张未付的时间警告账单，而您只是惊慌失措地寄出 200 多美元来恢复您的帐户。然后，这笔付款需要在发票中拆分，并带有适用于每张发票的金额。当然，付款帐户将链接回您的帐户。

对于输入收据的情况，不使用帐户。假设你在 embrasse-moi 买了一些内衣，然后付现金。您的系统将获取供应商、embrasse-moi、日期、成本，如果您通过互联网购买并且没有缴税但您仍然欠税，我添加了“使用税”、金额和“图表帐户”，这本质上是您的费用类别。这一切都归于一般期刊。在同一张表格上，您将拥有付款方式。我为费用+确切付款制作了一个简化表格，因为这很常见。如果付款被拆分，那么您将需要使用一种表格输入收据，然后使用其他表格创建链接到该收据的多笔付款。

因此，最终您的这个简单会计应用程序的数据库将包含以下表格： **账户**（账户信息包括账户类型，如 cc/借记卡、支票、现金、商业采购的库存账户、公用事业等费用账户、默认图表科目表） **科目表**（基本上是一个描述如何对将流向您的运营报表的费用和科目进行分类的列表，我把我的放在这里供您查看： [http](http://embrasse-moi.com/exampleData/pos_chart_of_accounts.csv) ://embrasse-moi.com/exampleData/pos_chart_of_accounts.csv ) 我有一个用于开立账户余额的表格，因为你必须从某个地方开始 **账户类型**- 表示信用卡、借记卡等。请记住，会计等式基本上会根据帐户进行切换。支票账户借方是“坏的”，因为你放弃了你的钱，贷方是“好”，因为你赚了钱，而信用卡借方是“好”，因为你减少了债务，贷方是“坏”，因为你添加到了你的债务 **图表帐户类型**，它是“资产、负债、长期资产等。这可以作为枚举类型包含在帐户购物车中。然后是**一般日记帐**，如上所述，它包含足够的信息来描述您的文档。是算账吗？日期、金额、类型（收据或发票）到期日，我保留“已付款”标志以方便查询。然后你有一个**查找**在“一般日记帐”表和付款表之间然后您有**付款表**。

一旦你掌握了所有这些信息，你几乎永远不会使用你的银行作为来源，因为它们并不总是正确的，至少我的银行会出错。因此，这种类型的结构将使您始终掌握您的信息，并且在月底，该系统将生成与您的帐户报表看起来相同的报表。这就是目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T18:31:35.250

关于从银行获取信息的 API：如果可能的话，这并不简单。您可以想象您的银行将花费多少时间来确保一切安全。我认为不可能自动连接。通常有一种方法可以在您登录网上银行后（如果有的话）通过手动下载文件来下载数据。希望它是 CSV 格式或类似的格式 ;-)

[编辑]

显然我在这里错了，主要银行确实允许直接连接。我想你必须咨询你的银行技术支持。

[/编辑]

至于要使用的数据类型，我至少建议货币值使用小数，而不是双精度/浮点数。也请参阅[此](https://stackoverflow.com/questions/316727/is-a-double-really-unsuitable-for-money)SO question thread。

# c - 如何为 CreateProcess() 启动的进程设置语言环境

> ID：421409
> 
> 赞同：3
> 
> 时间：2009-01-07T18:19:48.910
> 
> 标签：c, windows, winapi

使用 启动进程时`CreateProcessW()`，是否可以使用不同的 MBCP 语言环境/代码页创建该进程，然后是配置为系统范围默认代码页的进程？在目标进程中，这应该与调用具有相同的效果`_setmbcp()`。

目标进程不是启用 unicode 的，而是使用普通`main(int argc, char **argv)`入口点。我希望能够选择将传递给的 unicode 参数`CreateProcessW()`转换为与非 unicode 程序的系统默认代码页不同的代码页。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-25T12:36:59.157

我刚刚遇到了一个 Microsoft 实用程序：[AppLocale](http://www.microsoft.com/globaldev/tools/apploc.mspx "应用语言环境")，它似乎正好满足了这种需求......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T18:26:47.927

我相信（自从我不得不知道这一点以来已经很长时间了）子进程继承了父进程（或其中的线程）的语言环境——您是否尝试过切换线程语言环境，启动您的进程（并切换回来)?

# java - 轻量级校验和算法的好选择？

> ID：421419
> 
> 赞同：13
> 
> 时间：2009-01-07T18:21:34.960
> 
> 标签：java, javascript, hash, checksum

为了保持一致性，我发现自己需要为一串数据生成校验和。广义的想法是客户端可以根据接收到的有效负载重新生成校验和，从而检测传输过程中发生的任何损坏。我隐约知道这种事情背后有各种各样的数学原理，如果你自己尝试滚动它，很容易出现细微的错误使整个算法失效。

因此，我正在寻找有关具有以下标准的散列/校验和算法的建议：

*   它将由 Javascript 生成，因此需要相对较轻的计算量。
*   验证将由 Java 完成（尽管我看不出这实际上是一个问题）。
*   它将采用中等长度的文本输入（URL 编码的 Unicode，我认为是 ASCII）；通常大约 200-300 个字符，并且在所有情况下都低于 2000 个。
*   输出也应该是 ASCII 文本，越短越好。

我主要对轻量级的东西感兴趣，而不是获得绝对最小的碰撞可能性。我会天真地想象一个八字符的哈希会适合这个吗？我还应该澄清，如果在验证阶段没有发现损坏，这不是世界末日（而且我确实意识到这不会 100% 可靠），尽管我的其余代码对每个人来说效率明显较低漏掉的损坏条目。

编辑 - 感谢所有的贡献。我选择了 Adler32 选项，考虑到它在 Java 中得到原生支持，在 Javascript 中非常容易实现，两端计算速度快，输出 8 字节，完全符合我的要求。

（请注意，我意识到网络传输不太可能对任何损坏错误负责，并且暂时不会在这个问题上袖手旁观；但是添加校验和验证可以消除一个故障点，意味着我们可以专注于其他领域如果这种情况再次发生。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-07T18:28:59.827

CRC32 用任何语言都不太难实现，它足以检测简单的数据损坏，并且当以良好的方式实现时，它非常快。但是，您也可以尝试 Adler32，它几乎与 CRC32 一样好，但它更容易实现（而且速度也差不多）。

[维基百科中的 Adler32](http://en.wikipedia.org/wiki/Adler32)

[CRC32 JavaScript 实现示例](http://noteslog.com/post/crc32-for-javascript/)

这两者中的任何一个（或者甚至两者）都可以在 Java 中开箱即用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T19:13:41.890

是否知道 TCP 和 UDP（以及 IP、以太网和...）已经为传输中的数据提供校验和保护？

除非你在做一些非常奇怪的事情，否则如果你看到腐败，那就是大错特错了。我建议从[内存测试仪](http://www.memtest.org/)开始。

此外，如果您使用 SSL/TLS，您将获得强大的数据完整性保护。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T18:27:44.307

**[更新 30/5/2013：旧 JS CRC32 实现的链接失效了，所以我现在链接到另一个。]**

Google CRC32：速度快，重量比 MD5 等轻得多。[这里](http://code.google.com/p/hype-free/source/browse/trunk/crc32-benchmark/javascript/crc32.html)有一个 Javascript 实现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T18:30:52.427

[MD4、MD5 和 SHA1 的 Javascript 实现](http://pajhome.org.uk/crypt/md5/)。BSD 许可证。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T20:12:09.137

其他人已经提到了 CRC32，但这里有一个指向[PNG 的 CRC-32 的 W3C 实现的](http://www.w3.org/TR/PNG-CRCAppendix.html)链接，它是为数不多的具有参考 CRC 实现的知名网站之一。

（几年前，我试图找到一个有 CRC 算法的知名网站，或者至少有一个引用了其算法来源的网站，在找到 PNG 页面之前，我差点把头发扯掉。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-11-07T14:48:56.520

在我寻找一个好的校验和算法的 JavaScript 实现时，我遇到了这个问题。*Andrzej Doyle*正确地选择了 Adler32 作为校验和，因为它确实很容易实现并且具有一些出色的特性。*DroidOS*然后用 JavaScript 提供了一个实际的实现，这证明了它的简单性。

但是，该算法可以进一步改进，如 Wikipedia 页面中所详述并在下面实现。诀窍是您不需要确定每个步骤中的模数。相反，您可以将其推迟到最后。这大大提高了实施速度，在 Chrome 和 Safari 上速度提高了 6 倍。此外，这种优化不会影响代码的可读性，从而实现双赢。因此，它绝对适合最初的问题，即拥有计算量轻的算法/实现。

```
function adler32(data) {
  var MOD_ADLER = 65521;
  var a = 1, b = 0;

  var len = data.length;

  for (var i = 0; i < len; i++) {
    a += data.charCodeAt(i);
    b += a;
  }

  a %= MOD_ADLER;
  b %= MOD_ADLER;

  return (b << 16) | a;
} 
```

**编辑：** *imaya 不久前*创建了一个 jsperf 比较，显示了运行简单版本时的速度差异，如*DroidOS*所详述，与延迟模运算的优化版本相比。我在[jsperf 页面](http://jsperf.com/adler-32-simple-vs-optimized/6)中添加了名为***full-length***的上述实现，显示上述实现比*imaya*的实现快约 25%，比简单实现快约 570%（测试在 Chrome 30 上运行）：[http： //jsperf.com/adler-32-simple-vs-optimized/6](http://jsperf.com/adler-32-simple-vs-optimized/6)

 ***编辑2：**请不要忘记，在处理大文件时，您最终会在 a 和 b 变量方面达到 JavaScript 实现的限制。因此，在处理大型数据源时，您应该执行中间模运算，以确保您不会超过可以可靠存储的整数的最大值。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T18:27:14.200

使用[SHA-1 JS 实现](http://pajhome.org.uk/crypt/md5/sha1src.html)。它没有你想象的那么慢（Core 2 Duo 2.4Ghz 上的 Firefox 3.0 每秒散列超过 100KB）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-11-16T09:19:42.990

这是我“发明”的一个相对简单的方法——它背后没有数学研究，但它非常快并且在实践中有效。我还包括了测试算法的 Java 等效项，并显示失败的可能性不到 10,000,000 分之一（运行需要一两分钟）。

JavaScript

```
function getCrc(s) {
    var result = 0;
    for(var i = 0; i < s.length; i++) {
        var c = s.charCodeAt(i);
        result = (result << 1) ^ c;
    }
    return result;
} 
```

爪哇

```
package test;

import java.util.*;

public class SimpleCrc {

    public static void main(String[] args) {
        final Random randomGenerator = new Random();
        int lastCrc = -1;
        int dupes = 0;
        for(int i = 0; i < 10000000; i++) {
            final StringBuilder sb = new StringBuilder();
            for(int j = 0; j < 1000; j++) {
                final char c = (char)(randomGenerator.nextInt(128 - 32) + 32);
                sb.append(c);
            }
            final int crc = crc(sb.toString());
            if(lastCrc == crc) {
                dupes++;
            }
            lastCrc = crc;
        }
        System.out.println("Dupes: " + dupes);
    }

    public static int crc(String string) {
        int result = 0;
        for(final char c : string.toCharArray()) {
            result = (result << 1) ^ c;
        }
        return result;
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-13T05:49:14.060

这是一个相当古老的线程，但我怀疑它仍然经常被查看 - 如果您只需要一段简短但可靠的代码来生成校验和，那么[Adler32](http://en.wikipedia.org/wiki/Adler32#Example_implementation)位算法必须是您的选择。这是JavaScript代码

```
function adler32(data)
{
 var MOD_ADLER = 65521;
 var a = 1, b = 0;

 for (var i = 0;i < data.length;i++) 
 {
  a = (a + data.charCodeAt(i)) % MOD_ADLER;
  b = (b + a) % MOD_ADLER;
 }

 var adler = a | (b << 16);
 return adler;
} 
```

演示该算法的相应小提琴在[这里](http://jsfiddle.net/EWmrw/2/)。

# java - 在正在运行的 JVM 中查找正在运行的实例

> ID：421422
> 
> 赞同：4
> 
> 时间：2009-01-07T18:22:05.550
> 
> 标签：java, jvm, classloader

我想知道是否可以处理给定类的运行实例。触发此问题的特定问题是由于许多正在运行的线程而无法正常退出的应用程序。

是的，我知道您可以对theads 进行守护，这样它们就不会阻止应用程序退出。但这确实让我想知道这是否可能。我能做的最接近的事情是类加载器（受保护！）[findLoadedClass](http://java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html#findLoadedClass(java.lang.String))，尽管您必须运行自己的类加载器才能做到这一点。

在相关的说明中，这是分析工具如何管理跟踪对象句柄的吗？通过运行他们自己的自定义类加载器？还是有一些我没有看到的好方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T21:04:07.110

您确实可以通过`kill -QUIT <pid>`在 *NIX 之类的操作系统上使用或通过在 Windows 控制台中运行应用程序并按下`Ctrl-Pause`（作为另一张海报说明）来获取转储到标准输出的所有正在运行的线程的堆栈跟踪。

但是，您似乎在要求以编程方式来做到这一点。因此，假设您真正想要的是当前调用堆栈中包含来自给定类的一个或多个方法的所有线程的集合......

我能找到的最好的不涉及调用 JVMTI 的事情是检查所有正在运行的线程的堆栈。我还没有尝试过，但它应该可以在 Java 1.5 及更高版本中使用。请记住，根据定义，这根本不是线程安全的（正在运行的线程列表 - 以及它们当前的堆栈跟踪 - 将在你的身下不断变化......实际使用大量偏执的东西是必要的这份名单。）

```
public Set<Thread> findThreadsRunningClass(Class classToFindRunning) {

  Set<Thread> runningThreads = new HashSet<Thread>();
  String className = classToFindRunning.getName();

  Map<Thread,StackTraceElement[]> stackTraces = Thread.getAllStackTraces();
  for(Thread t : stackTraces.keySey()) {
    StackTraceElement[] steArray = stackTraces.get(t);
    for(int i = 0;i<steArray.size();i++) {
      StackTraceElement ste = steArray[i];
      if(ste.getClassName().equals(className)) {
        runningThreads.add(t);
        continue;
      }
    }
  }

  return runningThreads;
} 
```

让我知道这种方法是否适合您！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T18:41:22.423

从[这个页面](http://alek.xspaces.org/2005/08/11/how-does-a-java-profiler-work-ej-technologies-jprofiler)，

> Java 分析器使用 JVM 的本机接口（Java <=1.4.2 的 JVMPI 或[Java >=1.5.0 的 JVMTI](http://en.wikipedia.org/wiki/Java_Virtual_Machine_Tools_Interface)）从正在运行的 Java 应用程序获取分析信息。

这相当于[Sun 提供的一些本机代码](http://java.sun.com/javase/6/docs/technotes/guides/jvmti/)，这些代码将探查器挂钩到 JVM。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T19:35:40.580

如果您只需要对正在运行的应用程序进行快速堆栈跟踪以找出哪些线程阻塞了 JVM 退出，则可以向其发送 QUIT 信号。

```
$ kill -QUIT <pid of java process> 
```

在 Windows 下，您需要在控制台窗口中运行应用程序（使用`java.exe`，而不是`javaw.exe`），然后您可以按 Ctrl-Pause 生成堆栈转储。在这两种情况下，它都被写入标准输出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T18:29:03.243

我使用[Visual VM](https://visualvm.dev.java.net/)来监控 JVM。有很多功能，试试吧。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T18:41:09.147

我认为你需要一个[Java 线程转储](http://www.myloadtest.com/java-thread-dump/)。这应该列出所有线程以及他们目前正在做什么。我自己也遇到了类似的问题，线程转储帮助解决了这个问题（Quartz 调度程序线程，当 Tomcat 完成时它没有退出）。

# c# - 树视图更新

> ID：421437
> 
> 赞同：2
> 
> 时间：2009-01-07T18:25:28.040
> 
> 标签：c#, asp.net, javascript, treeview

我在 aspx 页面上有一个树视图控件。数据来自数据库，我以编程方式将其绑定到树视图控件。（当然是数据库中的亲子关系）

好吧，我添加了一个文本框，用于在所选节点下添加新子节点，它也很好用，但是为了看到新添加的节点，我必须刷新和分页，所有展开的节点都会自然折叠。我怎样才能防止这种情况。我也使用 updatepanel 不刷新整个页面并扩展子节点我当然使用 topicTree_TreeNodePopulate 事件。当用户在所选节点下添加内容时，无需任何刷新或回发，最近添加的节点应该会显示在所选页面的正下方。

提前致谢..

顺便说一句，我对 Javascript 没有太多经验，所以我不能用 javascript 来做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T07:29:39.517

您可以在绑定 TreeView 时或刷新 TreeView 时将 TreeNode 的 Expand 属性设置为“false”。

# datetime - 为什么 > SSIS 包中的条件拆分返回 >= 结果？更新：（日期时间！= DT_DBTIMESTAMP？！）

> ID：421448
> 
> 赞同：0
> 
> 时间：2009-01-07T18:27:57.473
> 
> 标签：datetime, ssis, conditional, dataflow, dataflowtask

我有一个 SSIS 数据流条件拆分转换，它在应该返回 > 结果时返回 >= 结果。

从一开始...我的 SSIS 包执行一个 SQL 任务，该任务将一个表中的 max(date) 存储在具有包范围的 DateTime 类型的变量 User::max_date 中。

然后我的包继续执行一个数据流任务，其中有一个条件拆分转换，它具有条件`date > @[User::max_date]`。结果集始终是单行，其 DateTime 值等于 User::max_date，也就是说，如果没有添加比 max(date) 更新的行，则返回包含 max(date) 的行。这是意想不到的行为。

此外，条件拆分的另一个输出是不正确的——它是所有行，`date < @[User::max_date]`而不是所有行，`date <= @[User::max_date]`正如人们所期望的那样。

为什么会这样？

**更新：**

我已经弄清楚这是怎么发生的，但不知道为什么。 `User::max_date`正在存储 DateTime ，`date`我的数据流任务中的值是`DT_DBTIMESTAMP`. 在将它们与 a 进行比较时，`DATEDIFF(..)`它们仅在几毫秒或更长时间内有所不同。

所以我可以解决这个问题，但我不知道为什么会这样实现。

评论？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-09T01:49:31.387

没关系。[在微软论坛](http://social.msdn.microsoft.com/forums/en-US/sqlintegrationservices/thread/2ecc9ae5-2975-4c16-9e47-c87d3247de1a/)上找到了答案。

# windows - 创建桌面应用程序的最佳技术是什么

> ID：421455
> 
> 赞同：7
> 
> 时间：2009-01-07T18:29:28.873
> 
> 标签：windows

我不是开发人员，因此不了解科技界的最新发展。我正在考虑创建一个供我自己使用的桌面应用程序，并尝试学习最好的可用技术，如果可以的话。我计划为 Windows 开发它，并且我有 C++ 和 Visual Studio 的实践经验。将期待专家的建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T18:39:46.717

除非你明确你的优先事项是什么，否则这个问题没有真正的答案（就像大多数“什么是最好的......？”问题一样）：

*   你关心什么环境/操作系统？视窗？Linux？Mac OS X？
*   易于开发有多重要？
*   内存占用有多重要？
*   “自由”有多重要（无论你对它的定义是什么）？
*   你有多少钱可以完成这项任务？
*   你有多少时间？
*   应用程序的稳定性有多重要？
*   您的应用程序的可证明性有多重要？
*   如果有的话，你知道什么开发语言？

在给出一个好的答案之前，这些只是你需要澄清的几件事。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T18:33:36.027

使用[flex](http://flex.org/ "flex.org")创建[AIR](http://en.wikipedia.org/wiki/Adobe_Integrated_Runtime "空气")应用程序可以让您创建跨平台桌面应用程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T18:32:51.207

带有 .net 的 C# 是在 Windows 上开发桌面应用程序的最受青睐的方式，与通过学习和使用 C++ 和 Win32 API 等更底层的东西进行编码相比，它会更快地为您提供解决方案。另外，正如 Josh 所指出的，如果考虑成本，可以免费获得一个精简但功能足够的版本。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T18:41:58.943

我必须在这里支持**Java Swing**应用程序。作为多年的桌面 Java 开发人员，我开发了许多确实可以在多个平台上运行的可靠应用程序。

您绝对可以使用 Swing（CellRenderers 等）非常熟悉，但基本的 Swing 本身可能会满足 80% 的用例。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T18:34:16.197

在 .Net 世界中，您需要在 WPF 和 WinForms 之间进行选择。

WPF 很漂亮。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-07T18:34:52.263

正如 EB 指出的那样，这一切都取决于。我建议您从 C# 或 Java 之类的托管语言开始，我个人的偏好是学习 C#，您可以使用 Microsoft 提供的免费 IDE，称为 Visual Studio Express Editions。[http://www.microsoft.com/Express/](http://www.microsoft.com/Express/)

我还假设您在 Windows 上开发？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-07T18:35:13.463

WPF 真的很容易使用：漂亮的标记，易于编辑。而且它可以轻松地缩减到 Silverlight（因为 Silverlight = WPF/E = WPF Everywhere）并成为一个只需稍作调整的 Web 应用程序。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-09T13:53:00.390

尽管我很难说，但还是使用 Microsoft 技术。无论您选择哪种语言，您都可以使用 .Net 快速获得结果。C# 具有出色的工具支持，在 .Net 3.5 中它正在变成一种半体面的语言，并且 .Net 平台有很多很多（太多！）您可以使用的框架和类库。

在 Windows 平台上物超所值和浅薄的学习曲线——这就是 .Net 的全部意义所在。Visual Studio 的 Express 版本是免费的，因此构建供个人使用的应用程序不会花费您一毛钱。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-09T13:57:16.560

你会从不同的人那里得到不同的答案，这取决于他们每天使用什么。

使用你所知道的。你知道 C++，所以 C++ 和 Qt 可能是最快的方法。它为您提供拖放式 gui 设计器、快速的开发时间和跨平台能力作为奖励。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-04-11T16:59:37.467

试试 wxWidgets。

它是 C++，它是多平台的，看起来很原生，很容易上手。代码速度快，可以静态编译，不需要安装程序。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-07T18:33:56.977

我们使用 C#，目前使用 dot net 2.0，但我们可能会在明年左右迁移到 3.0 或 3.5。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-07T18:34:50.220

我建议等待 2009 年 4 月 1 日到期的 MS Visual COBOL#。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-07T18:39:30.400

这是一个相反的建议：MFC。是的，C# 和 WPF 是最新的东西，得到很好的支持等。但是，MFC 应用程序速度快，没​​有框架依赖，安装简单等。最近微软对 MFC 进行了重大升级，提供对 Office 2007 的支持-像用户界面等。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-09T13:21:23.963

这里没有真正的正确或错误答案。在选择编程语言时，您有很多选择。我已经做了 10 年的 Java 开发人员，所以我可以这么说，是的，如果你愿意，Java 会成功的。Java 是一项成熟的技术，并且有大量可用资源，但您可以轻松地为许多其他语言提供相同的案例。

如果平台独立性很重要，那么您的选择就会更少。

我建议您下载 NetBeans 以尝试制作 GUI，但您也可以下载 Visual Studio Express 并尝试使用 C# 的 GUI 构建器。

玩得开心

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-08T15:52:17.660

使用 COM 和 ATL。任何客户端都可以使用，从 VB、C++、Java 脚本开始。或者您可以使用 Qt，如果您希望它独立于平台。

# ruby-on-rails - Rails 中的匿名用户——安全考虑？

> ID：421458
> 
> 赞同：7
> 
> 时间：2009-01-07T18:29:36.987
> 
> 标签：ruby-on-rails, ruby, security, anonymous-users

我正在考虑在 Rails 中实现某种形式的匿名用户系统。我需要让人们做事（创建记录、查看他们创建的内容等），而无需实际创建帐户。一旦他们创建了一个帐户，一切都会持续存在，而不会因清除 cookie 或其他东西而丢失它。

现在，我认为这很简单。在 User 模型中有一个 is_anonymous 字段，并使用类似这样的东西来访问当前登录的用户：

```
def find_user
  session[:user_id] ||= create_new_anonymous_user.id
end 
```

假设会话持续了一段合理的时间，并且会话 cookie 没有过期，那应该可以让一切顺利运行。

然而，我的这一部分确信我错过了一些与安全相关的东西。有没有人做过这样的事情？我错过了一些非常明显的东西吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-10T04:33:26.587

唯一真正的安全问题是这些匿名用户是否可以执行关键操作。

您的系统意味着任何拥有特定 cookie 的人都可以访问该网站。不一定是大问题，但这实际上取决于您的用户提供的信息类型。

我过去做过类似的事情（在我的情况下，我正在通过网站跟踪进度，当用户登录或注册时，我将“访客”数据附加到他们的帐户中。当您进行切换时，请确保删除匿名记录以防止进一步访问，应该没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-13T15:53:30.493

I just found a pretty cool example of "trial users" using Authlogic: [http://github.com/gisikw/authlogic_trial](http://github.com/gisikw/authlogic_trial)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T18:32:12.037

> 假设会话持续了一段合理的时间，并且会话 cookie 没有过期，那应该可以让一切顺利运行。

也许您应该为新用户设置一个单独的长期 cookie，以便他们可以拥有多个会话（至少来自该浏览器）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T20:58:50.373

您确定要让人们创建与可能不存在的帐户相关联的对象吗？不幸的是，我不太了解您的应用程序实际上在做什么，但我认为沿着这条路走下去可能会给您留下一堆没有真正“拥有”任何真正用户的孤立对象。

If you really *do* want to do this I think what you have is decent. You could be creating a real user, flagged as "guest" (or whatever) and once the user wants to really register they are prompted for other information and unflagged. You should add access control for guest vs non-guest, etc.

# javascript - 试图找到一个javascript下拉控件

> ID：421459
> 
> 赞同：1
> 
> 时间：2009-01-07T18:29:37.237
> 
> 标签：javascript, controls, widget

我正在寻找类似于 stackoverflow 登录页面上的 openid 站点选择下拉列表的下拉列表：

[![替代文字](https://i.stack.imgur.com/VIn51.png)](https://i.stack.imgur.com/VIn51.png)
[（来源：[codinghorror.com](http://www.codinghorror.com/blog/images/openid-1-login-helper.png)）]

......现在我宁愿不坐下来自己写一个。我正在寻找一种包含在纯 html/javascript（php 代码）中的内容，必须免费用于商业用途。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T19:15:32.790

有几十个[jquery 插件](http://plugins.jquery.com/search/node/dropdown+type:project_project)，您可能会发现它们具有商业价值。

# cocoa - 我应该使用 NSDecimalNumber 来处理金钱吗？

> ID：421463
> 
> 赞同：55
> 
> 时间：2009-01-07T18:29:52.273
> 
> 标签：cocoa, cocoa-touch, rounding, currency

当我开始编写我的第一个应用程序时，我毫不犹豫地将 NSNumber 用于货币价值。然后我想也许 c 类型足以处理我的价值观。然而，iPhone SDK 论坛建议我使用 NSDecimalNumber，因为它具有出色的舍入功能。

不是气质上的数学家，我认为尾数/指数范式可能有点矫枉过正。尽管如此，谷歌搜索，我意识到大多数关于可可货币/货币的讨论都提到了 NSDecimalNumber。

请注意，我正在开发的应用程序将国际化，因此以美分计算金额的选项实际上并不可行，因为货币结构很大程度上取决于所使用的语言环境。

我 90% 确定我需要使用 NSDecimalNumber，但由于我在网络上没有找到明确的答案（例如：“如果你处理金钱，请使用 NSDecimalNumber！”）我想我会在这里问。也许答案对大多数人来说是显而易见的，但在开始对我的应用程序进行大规模重构之前，我想确定一下。

说服我 ：）

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-01-07T22:46:12.287

Marcus Zarra 对此有非常明确的立场：[“如果你正在处理货币，那么你应该使用 NSDecimalNumber。”](http://www.cimgf.com/2008/04/23/cocoa-tutorial-dont-be-lazy-with-nsdecimalnumber-like-me/) 他的文章启发我研究 NSDecimalNumber，我对它印象非常深刻。处理 base-10 数学时的 IEEE 浮点错误让我恼火了一段时间 (1 * (0.5 - 0.4 - 0.1) = -0.00000000000000002776) 并且 NSDecimalNumber 消除了它们。

NSDecimalNumber 不只是添加另外几位二进制浮点精度，它实际上做了以 10 为底的数学运算。这消除了上面示例中所示的错误。

现在，我正在编写一个符号数学应用程序，所以我希望 30+ 十进制数字精度和没有奇怪的浮点错误可能是一个例外，但我认为它值得一看。这些操作比简单的 var = 1 + 2 风格的数学有点尴尬，但它们仍然易于管理。如果您担心在数学运算期间分配各种实例，则 NSDecimal 是 NSDecimalNumber 的 C 结构等价物，并且有 C 函数可以使用它进行完全相同的数学运算。根据我的经验，除了要求最苛刻的应用程序（MacBook Air 上 3,344,593 个添加/秒、254,017 个分区/秒、281,555 个添加/秒、iPhone 上 12,027 个分区/秒）之外，这些速度都非常快。

作为一个额外的好处，NSDecimalNumber 的 descriptionWithLocale: 方法提供了一个带有数字本地化版本的字符串，包括正确的小数分隔符。它的 initWithString:locale: 方法也是如此。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-06-14T11:02:09.320

是的。你必须使用

***NSDecimalNumber***和

在 iOS 上处理货币时不要**加倍**或**浮动。**

## 这是为什么？？

因为我们不想得到像**9.9999999998 美元**而不是**10美元这样的东西**

## 这是怎么回事？？

浮点数和双精度数是近似值。它们总是带有舍入误差。计算机用于存储小数的格式会导致此路由错误。如果您需要更多详细信息，请阅读

[http://floating-point-gui.de/](http://floating-point-gui.de/)

根据苹果文档，

*NSDecimalNumber 是 NSNumber 的不可变子类，为进行 base-10 算术提供了一个面向对象的包装器。实例可以表示可以表示为尾数 x 10^exponent 的任何数字，其中尾数是最多 38 位长的十进制整数，指数是从 –128 到 127.wrapper 的整数，用于进行以 10 为底的算术运算。*

所以 NSDecimalNumber 被推荐用于处理货币。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-07T22:26:13.203

（改编自我对另一个答案的评论。）

是的你应该。整数个便士仅在您不需要代表（例如，半美分）时才有效。如果发生这种情况，您可以将其更改为计算半美分，但如果您需要表示四分之一美分或八分之一美分怎么办？

唯一正确的解决方案是NSDecimalNumber（或类似的东西），这使关问题10 ^ -128¢（即，
0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000001¢）。

（另一种方法是任意精度算术，但这需要一个单独的库，例如[GNU MP Bignum 库。GMP](http://gmplib.org/)属于 LGPL。我从未使用过该库，也不知道它是如何工作的，所以我不能说它对你有多好。）

[编辑：显然，至少有一个人——布拉德·拉森——认为我在这个答案的某个地方谈论二进制浮点。我不是。]

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T18:37:02.790

我发现使用整数表示美分数然后除以 100 来表示很方便。回避整个问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-09T19:50:11.027

一个更好的问题是，什么时候不应该*使用*NSDecimalNumber 来处理金钱。对这个问题的简短回答是，当您不能容忍 NSDecimalNumber 的性能开销并且您不关心小的舍入误差时，因为您处理的精度永远不会超过几位数。更简短的答案是，在处理金钱时，您应该**始终使用 NSDecimalNumber。**

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-04-08T03:23:39.647

VISA、万事达卡和其他卡在传递金额时使用整数值。根据货币指数（除以或乘以 10^num，其中 num - 是货币的指数）正确解析金额取决于发送方和接收方。请注意，不同的货币有不同的指数。通常它是 2（因此我们除以 100 并相乘），但有些货币的指数 = 0（VND 等），或 = 3。

# .net - 从 .NET 向 COM 公开事件

> ID：421467
> 
> 赞同：1
> 
> 时间：2009-01-07T18:31:33.910
> 
> 标签：.net, events, com, interop, iunknown

最近我遇到了将事件从 .NET 公开到 COM 的问题。

我在这个例子中取得了成功（概念上取自[http://blogs.msdn.com/andreww/archive/2008/10/13/exposing-events-from-managed-add-in-objects.aspx](http://blogs.msdn.com/andreww/archive/2008/10/13/exposing-events-from-managed-add-in-objects.aspx)）：

// 我们自定义事件的委托类型。

```
[ComVisible(false)]
public delegate void SomeEventHandler(object sender, EventArgs e);

// Outgoing (source/event) interface.
[ComVisible(true)]
[InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
public interface IAddInEvents
{
    [DispId(1)]
    void SomeEvent(object sender, EventArgs e);
}

[ComVisible(true)]
[ClassInterface(ClassInterfaceType.None)]
[ComSourceInterfaces(typeof(IAddInEvents))]
public class AddInUtilities :
{       
    // Event field. This is what a COM client will hook up
    // their sink to.
    public event SomeEventHandler SomeEvent;

    inernal void FireEvent(object sender, EventArgs e)
    {
        if (SomeEvent != null)
        {
            SomeEvent(sender, e);
        }
    }
} 
```

这很好用，因为 IAddInEvents 接口被定义为**IDispatch**。但是，我需要**发布一个 IUnknown 事件源接口**。我无法控制事件接口，因为它来自第三方库（也将是已发布事件的消费者）。每当我尝试挂钩事件时，VB 环境（我试图接收事件的地方）就会崩溃，第三方产品（ESRI ArcMap）使用的 VBA 环境也会崩溃。

我已经能够（部分）手动实现**IConnectionPointContainer**接口（COM 在后台使用它来处理事件），然后我能够接收事件并进入我的 IConnectionPointContainer 实现。但是，这对我来说似乎有点矫枉过正，我认为 .NET 中必须对此提供隐式支持。其次，通过这种方法，我立即失去了代表的支持。

有人对这个有经验么？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T19:05:55.867

很简单，您将无法做到这一点。Classic VB 不支持非自动化 COM（如您所见）。

您将必须有一个包装器，您可以将您的自动化实例传递给它将公开非自动化事件。您实际上将必须有两种不同的类型来处理事件的两个独立客户端（启用自动化和未启用自动化）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T17:33:44.733

好的，所以我已经能够通过实现经典的 COM IConnectionPointCointainer、IConnectionPoint 和 IConnection（加上枚举接口）来实现这一点。它没有集成到 .NET 委托/事件模型中，但可以工作。

# javascript - 将类“固定”到选定的单选按钮？

> ID：421486
> 
> 赞同：1
> 
> 时间：2009-01-07T18:35:04.293
> 
> 标签：javascript, jquery, button, radio-button

我正在尝试向选定的收音机输入添加一个类，然后在选择另一个相同类型的收音机时删除该类

单选按钮具有类“radio_button”，但我无法使用以下代码更改类。

```
 jQuery(".radio_button").livequery('click',function() {  

      $('input.radio_button :radio').focus(updateSelectedStyle);
      $('input.radio_button :radio').blur(updateSelectedStyle);
      $('input.radio_button :radio').change(updateSelectedStyle);
  }
  function updateSelectedStyle() {
      $('input.radio_button :radio').removeClass('focused');
      $('input.radio_button :radio:checked').addClass('focused');
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T19:34:27.183

Tre 问题是由选择器中的一个额外空间引起的。

代替：

```
$('input.radio_button :radio') 
```

你想写：

```
$('input.radio_button:radio') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T21:12:52.007

您可能还想利用 jQuery 的可链接性来减少您正在做的工作量。（而不是一遍又一遍地重新找到这些按钮。）像这样的东西：

```
 jQuery(".radio_button").livequery('click',function() {  
    $('input.radio_button:radio')
      .focus(updateSelectedStyle)
      .blur(updateSelectedStyle)
      .change(updateSelectedStyle);
  });
  function updateSelectedStyle() {
    $('input.radio_button:radio')
      .removeClass('focused')
      .filter(':checked').addClass('focused');
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T19:12:02.627

*   给每个单选按钮一个唯一的 ID
*   通过点击传递ID
*   删除所有具有相同类的单选按钮的“聚焦”类名
*   使用您传递的 ID 将“focussed”类添加到单选按钮

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T20:18:28.560

首先，我同意 Rene Saarsoo 关于额外空间的回答。

其次，您是否也尝试将样式应用于单选按钮标签？您可能想以某种方式将按钮和标签包装在一起。例如：

```
<span class="radiowrapper"><input type="radio" name="system" value="1" class="radio_button"> 1</span>
<br>
<span class="radiowrapper"><input type="radio" name="system" value="2" class="radio_button"> 2</span> 
```

然后摆脱你的 livequery 调用中的额外调用，并将代码从 *updateSelectedStyle()*函数移动到你的 livequery 调用中（否则我注意到 IE 的问题）：

```
 jQuery(".radio_button").livequery('click',function() {
        $('input.radio_button:radio').parent(".radiowrapper").removeClass('focused');
        $('input.radio_button:radio:checked').parent(".radiowrapper").addClass('focused');
   }); 
```

# excel - 将 excel 文件作为 clob 上传

> ID：421494
> 
> 赞同：2
> 
> 时间：2009-01-07T18:37:48.280
> 
> 标签：excel, jdbc, clob

有人可以提供一个关于如何通过 JDBC 将 excel 文件转换为 oracle 中的 CLOB 的想法。我想知道如何使用作为 JDK 一部分提供的 API 将 excel 文件转换为字符串，并且从字符串到 clob 的转换应该是直截了当的。提前致谢。如果已经提出了类似的问题，请提供链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T15:33:28.327

当您需要解析数据（读取内容）时，您可以使用像[Apache POI这样的库](http://poi.apache.org/)

如果您想使用唯一的标准 API，则将 excel 保存为 CSV 文件并将文件处理为逗号分隔值列表。这可以通过 readline 轻松完成，读取每一行并使用字符串上的 split 方法将该行拆分为值。

如果您不需要解析数据，您应该将数据直接从文件流式传输到 CLOB，而不是先将 excel 转换为字符串。可以在此处找到示例：[http ://www.oracle.com/technology/sample_code/tech /java/sqlj_jdbc/files/advanced/LOBSample/LOBSample.java.html](http://www.oracle.com/technology/sample_code/tech/java/sqlj_jdbc/files/advanced/LOBSample/LOBSample.java.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T18:57:02.377

You will need a library out side of the standard java api to read a binary excel document.

You could use the [JExcelApi](http://jexcelapi.sourceforge.net/) to read in the Excel document then create a CSV String as you read in the document.

If you don't want to use an outside library then I would change the field type to blob and use the setBlob method of java.sql.PreparedStatment passing it a FileInputStream.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-10T15:48:44.407

文本格式的电子表格的表示形式是什么？制表符缩进的值？公式？如果 xls 文件中有多个页面怎么办？

如果您真正想做的是将文件存储在数据库中，请使用 BLOB 并将其存储为字节。

# erlang - Mnesia 数据库的存储容量是多少？

> ID：421501
> 
> 赞同：34
> 
> 时间：2009-01-07T18:39:46.327
> 
> 标签：erlang, mnesia

有些地方规定2GB期限。有些地方说这取决于节点的数量。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-01-07T21:50:24.117

如果您的问题是“由大量`disc_only_copies`表组成的 mnesia 数据库的存储容量是多少”，则相当大 - 您在很大程度上受到可用磁盘空间的限制。

一个更容易回答的问题是不同类型的单个 mnesia 表的最大容量是多少。`ram_copies`表受可用内存的限制。`disc_copies`表受到`dets`后端的限制（[Mnesia 上的 Hakan Mattsson](http://www.erlang.org/~hakan/mnesia_consumption.txt)）——目前这个限制是 4Gb 的数据。

所以简单的答案是，简单的`disc_copies`表可以在遇到问题之前存储多达 4Gb 的数据。（*如果您超过磁盘大小限制，Mnesia 实际上不会崩溃 - 表的 ram_copies 部分继续运行，因此您可以通过删除数据或在运行时进行其他安排来修复此问题*）

但是，如果您考虑其他 mnesia 功能，那么答案会更加复杂。

*   [`local_content`](http://erlang.org/doc/apps/mnesia/Mnesia_chap5.html#5.4)表。如果表是一张`local_content`表，那么它在mnesia集群的每个节点上可以有不同的内容，所以表的容量为 `4Gb * <number of nodes>`
*   [零散的表](http://erlang.org/doc/apps/mnesia/Mnesia_chap5.html#5.3)。Mnesia 支持用户可配置的表分区或使用表碎片的分片。在这种情况下，您可以有效地将表中的数据分布和重新分布到多个原始表中。这些原始表都可以有自己的配置——比如一个 ram_copies 表和其余的 disc_only_copies 表。这些原始表的大小限制与前面提到的相同，现在碎片表的有效容量为`4Gb * <number of fragments>`. （*可悲的是，如果您将表格分段，则必须修改您的表格访问代码以`mnesia:activity/4`代替`mnesia:write`和朋友使用，但如果您提前计划，它是可管理的*）
*   [外部副本](http://code.google.com/p/mnesiaex/)如果您喜欢生活在最前沿，您可以将[mnesiaex](http://code.google.com/p/mnesiaex/)补丁应用到 mnesia 并将您的表数据存储在外部系统中，例如[Amazon S3](http://code.google.com/p/erlaws/)或[Tokyo Cabinet](http://code.google.com/p/tcerl/)。在这种情况下，表的容量受到后端存储的限制。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2018-03-11T21:09:07.833

**TL;DR：** Mnesia 数据库的存储容量仅受可用 RAM的限制^。

^*假设您使用表类型`ram_copies`或`disc_copies`. 此外，如果您在表中存储大量数据`disc_copies`，则需要在启动时从磁盘读取数据，这可能会增加启动时间，超出可接受的范围。

* * *

当涉及到类型表时，这个答案与现有的两个答案相矛盾`disc_copies`。让我首先提出一些一般性的观点：

*   记忆表类型`ram_copies`仅受可用 RAM 的限制（除非您在 32 位机器上）。数据存储在 ETS 表中。
*   类型的 mnesia 表`disc_only_copies`存储在 Dets 表中。由于文件格式的限制，Dets 表被限制为 2 GB。
*   绕过该限制的明显方法是创建更多表，可能通过[表碎片](http://erlang.org/doc/apps/mnesia/Mnesia_chap5.html)。
*   该模式也存储在 Dets 表中，因此描述所有现有表的信息也限制为 2 GB。不过，在达到其他限制之前，您可能会遇到其他限制。
*   一个类型的记忆表`disc_copies`存储*在*RAM 和磁盘上，所以它受到可用 RAM 的限制——也许还有别的东西？

我将尝试在下面展示Mnesia 对表格大小*没有*具体限制。`disc_copies`但是请注意，许多 Erlang 程序员认为`disc_copies`表被限制为 2 GB。这在该问题[的公认答案](https://stackoverflow.com/a/422259/113848)中有所说明，在撰写本文时，该答案的得分比该答案高出 7 倍。

* * *

# disc_copies 于 2001 年从 dets 移至 disk_log

通常认为`disc_copies`表是由 Dets 表支持的。据我所知，直到 Erlang/OTP R7B-4（2001 年 9 月 30 日发布）之前都是这种情况。从[自述文件](http://erlang.org/download/otp_src_R7B-4.readme)：

```
 -- mnesia -----------------------------------------------------------------

        OTP-3712 - Speed/load improvements disc_copies tables are not 
                   implemented with dets anymore. 
```

查看[差异](https://github.com/mfoemmel/erlang-otp/commit/456bf42ac5efb77851334b271378737ea2df41b8#diff-bd5cbe94ceb22df01d6e87f8e3cbc187)以获取更多详细信息，特别是`mnesia_lib.erl`和`mnesia_loader.erl`。

* * *

# 支持 dets 和 2 / 4 GB 限制的来源

[archelaus 的回答](https://stackoverflow.com/a/422259/113848)来自[http://erlang.org/~hakan/mnesia_consumption.txt](http://erlang.org/~hakan/mnesia_consumption.txt)，它解释了`disc_copies`表位于 ets 和 dets 表中。但是，查看[目录的索引](http://erlang.org/~hakan/)，我们看到该文档的日期为 1999：

```
[TXT] mnesia_consumption.txt  26-Oct-1999 10:57    10k 
```

它会这样说是有道理的，因为它是在更改前两年写的。

[Ray Boosen 的回答](https://stackoverflow.com/a/421548/113848)来自[Erlang FAQ](http://erlang.org/faq/mnesia.html)：

> ## 11.5 Mnesia可以存储多少数据？
> 
> Dets 使用 32 位整数作为文件偏移量，因此最大可能的 mnesia 表（目前）是 4Gb。
> 
> 实际上，在达到此限制之前，您的机器会慢到爬行。

至少从 2001 年 1 月开始，FAQ 就一直这么说（参见[Wayback Machine 中最早的副本](https://web.archive.org/web/20010121162200/http://www.erlang.org:80/faq/x1108.html)）。这意味着这个FAQ条目的日期是在切换到disk_log之前，并且很长时间没有更新。（无论如何，Dets 表的大小限制是 2 GB，而不是 4 GB。）我提交[了一个常见问题的拉取请求](https://github.com/matthiasl/Erlang-FAQ/pull/9)。

* * *

# 支持更高限制的来源

[关于 Mnesia 的 Learn You Some Erlang 章节](http://learnyousomeerlang.com/mnesia#from-record-to-table)说：

> **ram_copies**
> 此选项使所有数据都专门存储在 ETS 中，因此仅存储在内存中。对于在 32 位上编译的虚拟机，内存应限制在理论上的 4GB（实际上约为 3GB），但在 64 位虚拟机上，假设有超过 4GB 的可用内存，这个限制会被推得更远。
> 
> **disc_only_copies**
> 此选项表示数据仅存储在 DETS 中。仅限光盘，因此存储仅限于 DETS 的 2GB 限制。
> 
> **disc_copies**
> 这个选项意味着数据既存储在 ETS 中，也存储在磁盘上，因此既存储在内存上，也存储在硬盘上。disc_copies 表不受 DETS 限制，因为 Mnesia 使用复杂的事务日志和检查点系统，允许在内存中创建基于磁盘的表备份。

我不确定这是什么时候写的，但上面的文字存在于[最早的 Wayback Machine 副本](https://web.archive.org/web/20120430101844/http://learnyousomeerlang.com/mnesia)中，日期为 2012 年 4 月。

Ulf Wiger在2005 年 11 月 7 日[的一篇题为“将 mnesia 打死（RE: Using 4Gb of ram with Erlang VM）”的 erlang-questions帖子中写道：](http://erlang.org/pipermail/erlang-questions/2005-November/017730.html)

> 在 16 GB 机器上，您可以：
> 
> *   同时运行 600 万个进程（通过使用 erlang:hibernate，我实际上能够运行 2000 万个 - 生成时间：6.3 us，消息传递时间：5.3 us，我有 1.8 GB 的空闲空间。）
>     
>     
> *   用至少 12 GB 的数据填充 mnesia，但要仔细考虑如何表示它，因为 64 位字长有点搞砸了。
>     
>     
> *   在 mnesia 中保留一个 10 GB 以上的 disc_copy 表。加载时间和日志转储成本似乎可以接受（加载 10 分钟，转储需要一段时间，但在后台运行得非常好。）

# 结论

混乱似乎源于官方消息来源的缺失或过时信息：

*   Mnesia 文档没有提到任何表大小限制
*   Erlang FAQ 说 Mnesia 受 4 GB Dets 大小限制，但这个答案是在 dets 到 disk_log 更改之前写的
*   erlang.org 域上唯一的其他文档是 Håkan Mattsson 的文档，可以追溯到 dets 到 disk_log 更改之前

LYSE 似乎是第一个提到`disc_copies`表不受 Dets 表大小限制的“权威”来源。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T18:50:48.613

根据文档，这是 4GB。第 11.5 节

[http://erlang.org/faq/mnesia.html](http://erlang.org/faq/mnesia.html)

# sql - sql帮助：如何将数量加在一起？

> ID：421509
> 
> 赞同：0
> 
> 时间：2009-01-07T18:41:24.357
> 
> 标签：sql, database

基本上，下面的这段代码返回了正确的信息，但我需要将数量加在一起才能带回一条记录。有没有办法做到这一点？

```
select category.category_name, (equipment.total_stock-equipment.stock_out) AS Current_Stock, equipment.stock_out
from
EQUIPMENT,
CATEGORY
WHERE  EQUIPMENT.CATEGORY_ID = CATEGORY.CATEGORY_ID
and category.category_name = 'Power Tools' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T18:45:24.490

您想使用 SUM 函数和 GROUP BY 子句。

```
select category.category_name, SUM((equipment.total_stock-equipment.stock_out)) AS Current_Stock, SUM(equipment.stock_out) as stock_out
from EQUIPMENT, CATEGORY 
WHERE EQUIPMENT.CATEGORY_ID = CATEGORY.CATEGORY_ID and category.category_name = 'Power Tools'
GROUP BY Category.Category_Name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T18:44:46.847

1 - Sum() 和 Group By 可以解决问题

2 - 在一篇文章中只发布一次您的问题，更简单

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T18:45:05.520

对我来说，这听起来像是 SUM 和 GROUP BY，每个 GROUP 返回一条记录。

为什么一个记录很重要？您是否尝试在一个步骤中结合查询和呈现？我的建议：不要。

# c# - 如何编写我也可以作为 winforms 程序运行的 c# 服务？

> ID：421516
> 
> 赞同：8
> 
> 时间：2009-01-07T18:44:46.410
> 
> 标签：c#, winforms, windows-services, installation, service

我有一个用 C# 编写的 Windows 服务，它充当一组网络设备到后端数据库的代理。为了进行测试以及添加模拟层来测试后端，我希望有一个 GUI 供测试操作员运行模拟。还可以将条带化版本作为演示发送出去。GUI 和服务不必同时运行。实现这种对决操作的最佳方法是什么？

编辑：这是我的解决方案，结合了[这个问题](https://stackoverflow.com/questions/421516)的内容，[我是作为服务运行](https://stackoverflow.com/questions/200163/am-i-running-as-a-service)并在没有 InstallUtil.exe 的情况下使用[Marc Gravell](https://stackoverflow.com/users/23354/marc-gravell)编写 的[优秀代码](http://groups.google.co.uk/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/4d45e9ea5471cba4/4519371a77ed4a74)[安装 .NET Windows 服务](https://stackoverflow.com/questions/255056/install-a-net-windows-service-without-installutil-exe/255062#255062)

它使用以下行来测试是运行 gui 还是作为服务运行。

```
 if (arg_gui || Environment.UserInteractive || Debugger.IsAttached) 
```

这是代码。

```
 using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using System.Windows.Forms;
using System.ComponentModel;
using System.ServiceProcess;
using System.Configuration.Install;
using System.Diagnostics;

namespace Form_Service
{
   static class Program
   {
      /// 
      /// The main entry point for the application.
      /// 
      [STAThread]
      static int Main(string[] args)
      {
         bool arg_install =  false;
         bool arg_uninstall = false;
         bool arg_gui = false;
         bool rethrow = false;
         try
         {
            foreach (string arg in args)
            {
               switch (arg)
               {
                  case "-i":
                  case "-install":
                     arg_install = true; break;
                  case "-u":
                  case "-uninstall":
                     arg_uninstall = true; break;
                  case "-g":
                  case "-gui":
                     arg_gui = true; break;
                  default:
                     Console.Error.WriteLine("Argument not expected: " + arg);
                     break;
               }
            }
            if (arg_uninstall)
            {
               Install(true, args);
            }
            if (arg_install)
            {
               Install(false, args);
            }
            if (!(arg_install || arg_uninstall))
            {
               if (arg_gui || Environment.UserInteractive || Debugger.IsAttached)
               {
                  Application.EnableVisualStyles();
                  Application.SetCompatibleTextRenderingDefault(false);
                  Application.Run(new Form1());
               }
               else
               {
                  rethrow = true; // so that windows sees error... 
                  ServiceBase[] services = { new Service1() };
                  ServiceBase.Run(services);
                  rethrow = false;
               }
            }
            return 0;
         }
         catch (Exception ex)
         {
            if (rethrow) throw;
            Console.Error.WriteLine(ex.Message);
            return -1;
         }
      }

      static void Install(bool undo, string[] args)
      {
         try
         {
            Console.WriteLine(undo ? "uninstalling" : "installing");
            using (AssemblyInstaller inst = new AssemblyInstaller(typeof(Program).Assembly, args))
            {
               IDictionary state = new Hashtable();
               inst.UseNewContext = true;
               try
               {
                  if (undo)
                  {
                     inst.Uninstall(state);
                  }
                  else
                  {
                     inst.Install(state);
                     inst.Commit(state);
                  }
               }
               catch
               {
                  try
                  {
                     inst.Rollback(state);
                  }
                  catch { }
                  throw;
               }
            }
         }
         catch (Exception ex)
         {
            Console.Error.WriteLine(ex.Message);
         }
      }
   }

   [RunInstaller(true)]
   public sealed class MyServiceInstallerProcess : ServiceProcessInstaller
   {
      public MyServiceInstallerProcess()
      {
         this.Account = ServiceAccount.NetworkService;
      }
   }

   [RunInstaller(true)]
   public sealed class MyServiceInstaller : ServiceInstaller
   {
      public MyServiceInstaller()
      {
         this.Description = "My Service";
         this.DisplayName = "My Service";
         this.ServiceName = "My Service";
         this.StartType = System.ServiceProcess.ServiceStartMode.Manual;
      }
   }

} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-07T19:02:49.680

你基本上有两个选择。在服务上公开一个 API，然后您可以从 UI 应用程序调用该 API，或者使该服务能够作为 winforms 应用程序或服务运行。

第一个选项非常简单 - 使用远程处理或 WCF 来公开 API。

第二个选项可以通过将你的应用程序的“guts”移动到一个单独的类中来实现，然后创建一个服务包装器和一个 win-forms 包装器，它们都调用你的“guts”类。

```
static void Main(string[] args)
{
    Guts guts = new Guts();

    if (runWinForms)
    {
        System.Windows.Forms.Application.EnableVisualStyles();
        System.Windows.Forms.Application.SetCompatibleTextRenderingDefault(false);

        FormWrapper fw = new FormWrapper(guts);

        System.Windows.Forms.Application.Run(fw);
    }
    else
    {
        ServiceBase[] ServicesToRun;
        ServicesToRun = new ServiceBase[] { new ServiceWrapper(guts) };
        ServiceBase.Run(ServicesToRun);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T18:46:49.667

创建一个新的 winforms 应用程序引用您的服务程序集。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T19:15:46.347

如果您使用以下代码：

```
[DllImport("advapi32.dll", CharSet=CharSet.Unicode)]
static extern bool StartServiceCtrlDispatcher(IntPtr services);
[DllImport("ntdll.dll", EntryPoint="RtlZeroMemory")]
static extern void ZeroMemory(IntPtr destination, int length);

static bool StartService(){
    MySvc svc = new MySvc(); // replace "MySvc" with your service name, of course
    typeof(ServiceBase).InvokeMember("Initialize", BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.InvokeMethod,
        null, svc, new object[]{false});
    object entry = typeof(ServiceBase).InvokeMember("GetEntry",
        BindingFlags.Instance | BindingFlags.NonPublic | BindingFlags.InvokeMethod, null, svc, null);
    int len = Marshal.SizeOf(entry) * 2;
    IntPtr memory = Marshal.AllocHGlobal(len);
    ZeroMemory(memory, len);
    Marshal.StructureToPtr(entry, memory, false);
    return StartServiceCtrlDispatcher(memory);
}

[STAThread]
static void Main(){
    if(StartService())
        return;

    Application.Run(new MainWnd()); // replace "MainWnd" with whatever your main window is called
} 
```

然后，您的 EXE 将作为服务（如果由 SCM 启动）或 GUI（如果由任何其他进程启动）运行。

本质上，我在这里所做的只是使用[Reflector](http://www.red-gate.com/products/reflector/)来找出其中的内容[`ServiceBase.Run`](http://msdn.microsoft.com/en-us/library/tks2stkt.aspx)，并在此处复制它（反射是必需的，因为它调用私有方法）。不直接调用的原因`ServiceBase.Run`是它会弹出一个消息框告诉*用户*服务无法启动（如果不是由单片机启动），并且没有返回任何内容告诉*代码*服务无法启动。

因为这使用反射来调用私有框架方法，所以它在框架的未来版本中可能无法正常运行。 *警告编码。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T18:48:05.513

还有[FireDaemon](http://www.firedaemon.com/)。这允许您将任何 Windows 应用程序作为服务运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T18:28:16.723

有关更多有用信息，请参阅[我作为服务运行。](https://stackoverflow.com/questions/200163/am-i-running-as-a-service#200183)

涵盖的最重要的事情是如何可靠地确定我们是在交互运行还是通过服务运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T18:48:17.807

您必须实现一个可以与您的服务通信的单独进程。虽然在 XP 和更早的系统上可以提供显示 UI 的服务，但在 Vista 和更高版本上不再可能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T18:50:08.940

另一种可能性是不使用服务，而是使用驻留在任务栏中的应用程序（想想 Roxio Drag-to-Disc，很可能你的防病毒软件就在那里），它有一个按时钟显示的图标，它右键单击时启动菜单，双击时启动 UI。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T18:51:46.020

如果您的服务被正确调制，您可以将服务托管在作为服务的可执行文件中，或者使用带有 gui 的可执行文件进行测试。我们也将这种方法与我们的服务一起使用，独立的服务可执行文件在生产环境中托管服务，但我们也有一个控制台应用程序来托管服务。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T18:56:08.977

将您的代码分成不同的组件：一个用于管理服务方面，一个用于执行实际的业务逻辑。从服务组件创建业务逻辑并与之交互。为了测试（您的业务逻辑），您可以创建使用业务逻辑组件而不使用服务组件的 WinForm 或控制台应用程序。更好的是，使用单元测试框架进行大部分测试。服务组件中的许多方法无疑也是可单元测试的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-07T21:52:37.623

如果将业务逻辑封装在服务类中，然后使用工厂模式创建这些服务，则可以将同一组服务用于桌面应用程序（桌面工厂）和 Web 服务（WCF 中的主机）。

服务定义：

```
[ServiceContract]
public interface IYourBusinessService
{
    [OperationContract]
    void DoWork();
}

public class YourBusinessService : IYourBusinessService
{
    public void DoWork()
    {
        //do some business logic here
    }

} 
```

桌面 WinForms 工厂以获取服务以开展业务：

```
public class ServiceFactory
{
    public static IYourBusinessService GetService()
    {
        //you can set any addition info here
        //like connection string for db, etc.
        return new YourBusinessService();
    }
} 
```

您可以使用 WCF ServiceHost 类或在 IIS 中托管它。两者都允许您指定如何实例化服务的每个实例，以便您可以进行初始化，如连接字符串等。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-10T18:25:30.450

You can create the service to call another executable with a command line argument so it is run without the form. When that exe is called without the command line argument it shows the form and act as normal.

# database - 有没有办法在 db2 v7 中启用/禁用约束？

> ID：421518
> 
> 赞同：5
> 
> 时间：2009-01-07T18:45:00.013
> 
> 标签：database, db2, constraints

我必须将表从 Oracle 数据库复制到 db2 v7 数据库中，为了做到这一点（避免数百万次删除和创建），我想知道 db2 是否具有类似 Oracle 的功能，可以临时启用/禁用约束而不删除他们。

在此先感谢，毛罗。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-03-22T21:59:49.920

你可以做：

```
ALTER TABLE <table-name> ALTER FOREIGN KEY <constraint-name> NOT ENFORCED 
```

然后重新启用：

```
ALTER TABLE <table-name> ALTER FOREIGN KEY <constraint-name> ENFORCED 
```

[http://publib.boulder.ibm.com/infocenter/mptoolic/v1r0/index.jsp?topic=/com.ibm.db2tools.ama.doc.ug/amacric0.htm](http://publib.boulder.ibm.com/infocenter/mptoolic/v1r0/index.jsp?topic=/com.ibm.db2tools.ama.doc.ug/amacric0.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T18:59:32.667

I'm not sure if this works in version 7, but you can try the following:

```
set integrity for table_name off
set integrity for table_name foreign key immediate unchecked 
```

And then you can do your inserts. To re-enable, you can then do the following:

```
set integrity for table_name immediate checked 
```

# c++ - wchar_t 数据是否需要字节序转换？

> ID：421530
> 
> 赞同：7
> 
> 时间：2009-01-07T18:47:44.297
> 
> 标签：c++, c, endianness, data-transfer, wchar-t

在 C/C++ 中，如果一个多字节宽字符 (wchar_t) 值从大端系统传输到小端系统（或反之亦然），它会在另一端输出相同的值吗？还是需要交换字节？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T19:02:53.860

是的，您需要交换它们。
字节将按照它们放入的顺序从传输中检索。只是在另一端，这些字节的顺序具有不同的含义。因此，您需要将它们转换为正确的字节序（这是一个词吗？）。

行之有效的方法是在传输之前转换为网络字节顺序。然后在收到时转换回主机特定的字节顺序（来自网络字节顺序）。

一组帮助进行字节序转换的函数：

```
ntohs   Convert a 16-bit quantity from network byte order to host byte order
ntohl   Convert a 32-bit quantity from network byte order to host byte order
htons   Convert a 16-bit quantity from host byte order to network byte order
htonl   Convert a 32-bit quantity from host byte order to network byte order 
```

只是为了添加另一个注意事项。
不同的系统对 wchar_t 使用不同的大小，所以不要假设 sizeof(wchar_t) == 2。

此外，每个主机可以为 wchar_t 使用不同的表示格式。
为了帮助解决这个问题，大多数系统将文本转换为已知的传输格式（UTF-8 或 UTF-16 是不错的选择）。在另一端将文本转换回主机特定格式。

您可以查看 IBM 的 icu，它具有所有这些功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T12:12:55.717

Endian 转换是不够的，因此不需要。Sizeof(wchar_t) 不同，因此编码也不同。因此，您需要就交换格式达成一致。合乎逻辑的选择是 UTF-8。但是由于 UTF-8 是面向字节的，因此您不再有字节顺序问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T18:51:26.957

是的，您需要执行字节序转换。仔细定义您的序列化格式，即通过网络传输或存储到磁盘文件中的数据的字节顺序。然后，在发送数据时，从本机格式转换为有线格式（可能需要也可能不需要字节交换），在接收数据时，从有线格式转换为本机格式（同样可能需要也可能不需要字节交换）。您应该选择一种大多数客户端都会使用的有线格式，以最大限度地减少平均字节交换量。

# sql - Rails：提交具有多个对象的表单

> ID：421536
> 
> 赞同：4
> 
> 时间：2009-01-07T18:49:12.330
> 
> 标签：sql, ruby-on-rails, ruby, activerecord

我正在创建一个 Rails 应用程序，但遇到了一些障碍。我想要一个“为 DataType1 创建新记录”表单，它不仅为 DataType1 创建一个新行，还为 DataType2 插入多达四个新行。

我对fields_for 了如指掌，但我的问题是我需要提交最多四个DataType2，而它们与DataType1 的唯一联系是它们是通过DataType2 中的一个字段引用的。

这是简化的数据库：

```
create_table :data_type_1 do |t|
  t.string     :title
  t.text       :body

  t.timestamps
end

create_table :data_type_2 do |t|
  t.belongs_to :parent

  t.timestamps
end 
```

现在，我已经建立了所有关系和一切；那不是问题。问题是我似乎无法弄清楚如何将 DataType2 的参数与新 DataType1 的参数一起传递。一旦有人向我展示了我应该如何执行此操作，我就可以相当容易地设置新的 DataType2 以与新的 DataType1 关联。

这是我目前的表格：

```
<% form_for(@data_type_1) do |f| %>
  <%= f.error_messages %>

  <p>
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </p>

  # Etc...

  <p>
    # New items need to be iterated here
    # DataType2[1]: [         ]
    # DataType2[2]: [         ]
    # DataType2[3]: [         ]
    # DataType2[4]: [         ]
    # (Note that these numbers are just examples.)
  </p>

  <p>
    <%= f.submit "Create" %>
  </p>
<% end %> 
```

我对 Rails 比较陌生，如果这个问题有点啰嗦，我深表歉意。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-07T19:47:21.760

[这个](http://railscasts.com/episodes/73 "RailsCast")RailsCast 讨论了将“DataType2”列表插入“DataType1”。有趣的部分是这些

`app/views/projects/_form.html.erb`

```
 <% for task in @project.tasks %>
    <% fields_for "project[task_attributes][]", task do |task_form| %>
      <p>
        Task: <%= task_form.text_field :name %>
      </p>
    <% end %>
  <% end %> 
```

`app/models/project.rb`

```
def task_attributes=(task_attributes)
  task_attributes.each do |attributes|
    tasks.build(attributes)
  end
end 
```

# c# - 垃圾收集器是否会在 .NET 中的异步调用期间销毁临时未引用的对象？

> ID：421547
> 
> 赞同：9
> 
> 时间：2009-01-07T18:50:43.137
> 
> 标签：c#, .net, asynchronous, garbage-collection

想象一下，我将在 .NET 中进行异步调用，即 HttpWebRequest.BeginGetResponse，并且 HttpWebRequest 对象没有在更广泛的范围内被引用。垃圾收集器会破坏它并引起问题吗？

示例代码：

```
using System;
using System.Net;

public class AsyncHttpWebRequest
{
    void Main()
    {
        var Request = HttpWebRequest.Create("http://www.contoso.com");
        var result = Request.BeginGetResponse(GetResponseCallback, null);
    }

    private void GetResponseCallback(IAsyncResult AsyncResult)
    {
        // Do Something..
    }
} 
```

替代版本（请求作为 AsyncState 传递）：

```
using System;
using System.Net;

public class AsyncHttpWebRequest
{
    void Main()
    {
        var Request = HttpWebRequest.Create("http://www.contoso.com");
        var result = Request.BeginGetResponse(GetResponseCallback, Request);
    }

    private void GetResponseCallback(IAsyncResult AsyncResult)
    {
        // Do Something..
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T18:58:05.227

如果任何活动线程包含对它的引用，或者如果它被静态引用（在这两种情况下都是直接或间接），则认为该对象是活动的并且不符合垃圾回收的条件。

在这两个示例中，异步 API 都会保留对您的请求的引用（在提交异步 IO 操作的线程池中），因此在完成之前不会被垃圾收集。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T18:58:48.957

不，垃圾收集器不会给你带来麻烦。

Don't assume that because **you** don't have access to the object, the garbage collector is going to clean it up.

The garbage collector starts with a number of "roots" - objects and references that are known reachable. Then, all the objects reachable from those roots are found, and everything else is collected.

Each running thread - including the thread(s) that process the Async calls are included in the list of roots.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T19:03:21.397

If an object has no references as far as the GC is concerned then you can no longer *get* a reference to it. So you can't have an object that *temporarily* doesn't have a reference to it.

(This assumes nothing sneaky like unmanaged or unsafe code playing games)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T18:58:21.233

在第一个示例代码中，如果不使用它，为什么要创建 Request？

无论如何，如果当前范围内的任何对象都不存在对对象的引用（直接或间接），GC**可能会**收集它。

因此，在您的第一个示例中，当程序退出 Main 方法时，请求仍在范围内（在另一个线程中），因此在异步调用结束之前不会被收集。在您的第二个示例中，线程池线程和您的代码都保留了对您的对象的引用，因此它显然也不会被收集。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T18:58:29.237

通过异步调用的实现，该对象仍然被很好地引用——它需要维护所有打开请求的列表，以将传入数据与请求相关联。最有可能的是，.NET 使用全局（或类）变量来存储请求。

# sql - 使用存储过程访问数据提供了哪些安全优势？

> ID：421553
> 
> 赞同：12
> 
> 时间：2009-01-07T18:51:31.233
> 
> 标签：sql, sql-server, security, stored-procedures

我看过一些指导，建议您通过存储过程对所有数据访问进行分层来保护数据库。

我知道对于 SQL Server，您可以保护表，甚至针对 CRUD 操作的列。

例如：

```
 --// Logged in as 'sa'
 USE AdventureWorks;
 GRANT SELECT ON Person.Address(AddressID, AddressLine1) to Matt;
 GRANT UPDATE ON Person.Address(AddressLine1) to Matt;

 --// Logged in as 'Matt'
 SELECT * from Person.Address;                       --// Fail
 SELECT AddressID, AddressLine1 from Person.Address; --// Succeed
 UPDATE Person.Address SET AddressLine1 = '#____ 2700 Production Way' 
        WHERE AddressID = 497;                       --// Succeed 
```

鉴于您可以保护表甚至列免受 CRUD 操作，使用存储过程如何提供额外的安全性或安全性管理？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T19:00:13.117

Because by limiting all access to those stored procs you have established a defined interface to the database, through which all access must occur... Since you will have DENY'd Direct select, insert, update, and delete operations against the tables and views, noone can directly write sql of their own design that does whatever they want to... If you want to limit inserts into the employee table where the employee is assigned to more than three projects to to only those employees that have a score greater than 85 on a proficiency test, then you can write that constraint intoi the SaveEmployee sproc, and have it throw an exception to any client code that attempts to do that...

Sure you COULD do the same thing using client-side code, but using sProcs makes the process easier to design and manage, cause it's all in one place, and ALL applications that attempt to access this database system HAVE to conform to whatever constraints and/or security provisions you define in the SProcs... No rogue developer writing a new separate client app that hits the database can ignore or work-around a constraint or security provision in a SProc if that SProc s the ONLY WAY to insert or update a record...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-07T19:00:20.107

You might not want to give Matt carte-blanc to update certain tables or columns directly. What if Matt decided to do this:

```
UPDATE Person.Address SET AddressLine1 = NULL 
```

Whoops. Matt forgot the WHERE clause and just hosed your database. Or maybe Matt just got pissed at his boss and has decided to quit at the end of the day. Or maybe Matt's password isn't as secure as it should have been and now a hacker has it.

This is just one simple example. Control over tables and columns could become much more complex and might be untenable through anything other than stored procedures.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T19:00:02.823

Stored procedures provide additional security by allowing users to perform CRUD operations (insert, update, delete) but only in a limited fashion. For example allowing user Matt to update the address of some rows but not others.

It allows you to add data checks to make sure that the data inserted is valid data, not random garbage. For most things you can use constraints and or triggers to do some of this work, but there are limitations. Stored procedures enhance security by ensuring that operations being performed are allowed by the user.

It's easier to track changes to the database though a single point of access, controlled by your applications, rather than through any number of interfaces. And the procedure can update an audit log.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-08T19:41:27.013

在 SQL Server 中，如果您正确使用存储过程（这意味着没有动态 SQl），则不必授予对表的任何直接访问权限。这意味着您的用户只能执行 procs 定义的那些事情。如果您的数据库中有任何财务数据或敏感数据，则只有尽可能少的人（通常只有 dbas）才能直接访问这些表。这大大降低了欺诈或心怀不满的员工破坏您的业务关键数据或员工窃取个人信息以进行身份​​盗窃的风险。在会计方面，这是一种必要的内部控制，开发人员的便利性或个人希望从用户界面动态地做所有事情都应该被数据的不安全性所压倒。不幸的是，在太少的公司中，事实并非如此。

如果您在表级别限制用户，然后用户触发查询以进行合法插入，则不会发生。如果您授予他们执行插入的权利，那么他们可以执行他们想要的任何临时插入，而不仅限于来自用户界面的插入。使用存储过程，他们只能做由过程特别定义的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T19:04:13.983

In most (all?) RDBMS's you can 'GRANT' access on specific tables to specific users. A stored procedure can run as a different user, one with greater access. But the Stored procedure is not the same as giving access to the whole table, rather it could first check some things and only return rows that match your particular security concerns.

You might be able to do similar checks with a view but stored procedures are usually much more flexible since they can run almost any SQL - compare the results and decide what rows to return.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T11:19:51.133

在存储过程中，您可以添加逻辑控件。如果出现问题，您可以返回错误代码，而不是直接更新表数据。

例如，您有一个反馈系统。只有在管理员启动反馈活动后才能提交反馈。它只是更新某个表中的标志。然后当用户来提交反馈时，SP 可以检查标志是否设置。

```
Select @IsFeedbackDefined = IsFeedbackDefined From sometable where ID = @ID

IF @IsFeedbackDefined is Null or @IsFeedbackDefined = false 
Begin
    Return -2   --can not submit feedback
End 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T19:01:26.767

The stored procedure is better because the security on the stored procedure (IIRC) will trump security on the tables/columns.

For single-table access, that's not a big deal. However, if you have an operation that involves multiple columns on multiple tables, having one access/deny flag for a table/column might not work for all situations.

However, a stored procedure can perform the composite operation and you can set the security appropriately on that.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-08T19:50:58.240

简而言之，它允许您在功能上而不是在结构上定义安全性。换句话说，它限制了用户可以做什么（以更大的粒度），而不是可以访问哪些数据库对象（以非常粗的粒度）。

请注意，我们说的是“由 DBA 控制的安全性”，而不是由站点或系统管理员或软件模块控制，所有这些都是有用的，并且是整个安全基础架构的一部分。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-08T22:32:19.227

在这里详细讨论的第一个好处是更好地控制权限 - 用户可以被限制在特定的行中，而不仅仅是每列（顺便说一句，在大型系统中管理它）；SP 可以强制执行业务逻辑和事务逻辑；可能仅根据其他数据（例如连接）检索数据；一次更新可能仅限于单行；等等

其次，这可以为 SQL 注入提供额外的保护层（尽管它不是完整的和自动的）。虽然这可能会被 SP 内的动态 SQL 或错误的连接调用破坏，但 SP 确实强制执行参数类型等，将代码与数据分开。

第三，在开发阶段归结为控制——通常你会训练 DBA 编写 SP，而不是程序员（他们接受过代码培训......）

更不用说，这是非安全性的好处，例如更好的性能。

# monitor - 光面或哑光 LCD 屏幕更适合长时间的编码工作吗？

> ID：421560
> 
> 赞同：39
> 
> 时间：2009-01-07T18:52:45.847
> 
> 标签：monitor

我正在考虑购买一台新的液晶显示器，但我担心在工作一整天后，有光泽的显示器可能会导致更多的眼睛疲劳。我通常会花很多时间在显示器前，所以眼睛疲劳绝对是我考虑过的问题。您更喜欢哑光还是光面 LCD 屏幕，为什么？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-07T18:56:53.547

哑光，因为您对它的反射较少，如果您的工作场所明亮，这很好。我都用过，但特别是如果你的显示器周围有明亮的物体，或者侧面有窗户，你真的想要一个哑光的。

不断地在其中进行反思真的很烦人，并且从长远来看会损害可读性。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-07T19:09:57.280

我的笔记本电脑上有一个光滑的屏幕，我有一个连接的 LCD 独立显示器。我喜欢他们都有不同的原因。

我喜欢我的光面显示器的原因：

*   图形看起来很棒
*   颜色看起来很鲜艳
*   演示文稿看起来很棒
*   图形真的很容易在眼睛上看起来就像在电视上一样流动
*   非常适合看起来很出色的游戏
*   它是宽屏的，非常适合看电影
*   我可以看到我的所有代码而无需向右滚动 [因为宽屏]

我喜欢我的独立哑光显示器的原因：

*   我的代码更容易阅读[因此这是我用于编程的内容]
*   我在光面屏幕上设计的图形在磨砂显示器上并不总是看起来很棒，但我在磨砂屏幕上设计的图形在两者上总是看起来很棒。
*   它更大（可能与您无关）
*   它具有更高的对比度和更好的背光

如果您在某个明亮的地方或身后有光源，即您背对着太阳坐着，则两个屏幕上的眩光都无法忍受……无论哪个“明亮”设置最高，都会在这里胜出。

我发现很多人所说的“你应该使用哑光，因为......”或“你应该使用光泽，因为......”只是重复 FutureShop 或 CompUSA 的人试图向他们推销他们最终购买的东西.

我各有一个，我喜欢各有一个，并且出于不同的原因都爱他们。选择最适合您使用它的那个。

我的建议是：找一个地方，你可以并排尝试它们，看看你将要使用它，或者如果*可以*的话，每一个都尝试几天再决定。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T18:55:08.947

我更喜欢有光泽的，只要光线不照在上面。检查你的电脑在哪里，你的灯在哪里，你的窗户/天窗在哪里。否则，我会一直使用哑光。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T18:57:01.407

我认为这几乎是个人选择。我曾经认为光面是无法忍受的，直到我得到一台带有光面屏幕的笔记本电脑并被迫使用它一段时间。现在我什至不在乎太多，也不觉得它变得更糟。但是，如果我有选择，我仍然会选择哑光的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T19:37:51.933

当我购买当前的笔记本电脑时，我也遇到了同样的困境。我是个老前辈，我不想要有光泽的屏幕。我几乎买了一个不同的，因为我想要磨砂屏幕。我会去电路城和百思买，我会讨厌眩光。然后我在朋友家中使用了几个小时，在更真实的条件下使用，我很喜欢它。我买了一个有光泽的，但我仍然为我的决定而苦恼。

现在我很高兴我得到了光面纸，没有它我不会买笔记本电脑。不仅大多数东西看起来更好，而且它的视角也很好。在演示东西或与用户一起工作时，我倾向于经常使用我的笔记本电脑。您无法击败光面显示器的视角。

使用它两年后，我很少遇到强光眩光的情况。我做了几次，只需稍微重新定位即可修复它。

当我更换当前的显示器时，它们会变得光滑。笔记本电脑的问题，因为它是移动的，在台式显示器上并不存在。我的两个桌面环境都没有出现眩光问题。我目前在工作中使用一种光泽和一种哑光，就眼睛疲劳而言，我并没有真正看到两者之间的区别。对我来说，这一切都是视角和光面的东西看起来有多棒。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-07T19:00:33.210

我认为有光泽的东西太粘了。在错误的环境中反射可能会令人讨厌，但磨砂屏幕并不能提供某些人似乎认为的纯净、不受干扰的画面——入射光通过抗反射涂层在屏幕表面扩散，因此清晰度和对比度底层面板能够提供的功能有所降低。

# vb6 - 这个 VB6 变量声明有什么作用？

> ID：421561
> 
> 赞同：2
> 
> 时间：2009-01-07T18:53:18.873
> 
> 标签：vb6, declaration

我只是在一些旧代码中找到了这个，我不确定它是什么意思。

```
Dim sTemp As String * 1 
```

最后的 * 1 是什么？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T18:54:42.350

这意味着该变量是一个长度正好为一个字符的字符串。

本质上，一个固定长度的字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T18:56:33.033

它是一个字符的固定长度字符串。这很方便，因为您可以定义固定字符串的结构并将文件直接读入结构中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T18:57:05.153

它创建一个固定长度的字符串。在该示例中，变量将只包含一个字符。

# visual-studio - 在 Visual Studio IntelliSense 中使用向上箭头选择最后一项

> ID：421563
> 
> 赞同：1
> 
> 时间：2009-01-07T18:54:17.590
> 
> 标签：visual-studio, ide, intellisense

任何人都知道这是否可能？我在 vs 2005 和 2008 中尝试过它并没有这样做。当我知道我想选择最后一个项目或靠近 IntelliSense 列表末尾的项目时，IMO 这将是一个非常有用的功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T18:55:56.950

这是不可能的。如果绝对需要，我会反复点击 Page Down 以到达最后一项。通常我只是点击我接下来需要的第一个字母，然后选择它。

# .net - 有没有办法从自定义 3ds Max 插件返回 dotNetObject 值？

> ID：421566
> 
> 赞同：0
> 
> 时间：2009-01-07T18:54:46.157
> 
> 标签：.net, 3dsmax, maxscript

我有一个用于 3ds Max 的自定义插件，它与后端的一些托管代码交互。在某些情况下，我想将托管对象转发到 MAXScript 以进行直接交互，即从我的一个函数返回一个包装的对象。

MAXScript 能够通过 Max 附带的另一个插件 (msxdotNet) 直接相对较好地操作托管对象（我使用的是 3ds Max 2008）。它基本上包装了一个对象并使用反射来进行后期绑定调用，但它完全是自包含的，没有任何 sdk 暴露。除了 Max 添加一些顶级脚本类所需的最小接口外，插件 dll 本身也没有暴露任何东西。

脚本类允许通过构造函数实例化一个新对象

```
local inst = (dotNetObject "MyPlugin.MyClass" 0 0 "arg3") 
```

就我而言，我已经有一个我想使用的对象的实例。

**有没有办法从我的插件中构造一个 dotNetObject 包装器的实例以返回 Max？**

* * *

理想情况下，我想要一个带有（C++/CLI）签名的辅助函数，类似于：

```
Value* WrapObject(System::Object ^obj); 
```

我可以做出的一些基本保证：

*   msxdotNet 插件已加载。
*   msxdotNet 插件和我的托管程序集位于同一个 AppDomain 中。

msxdotNet 插件的源代码*作为*sdk 示例包含在内，但出于管理/理智的考虑，修改它并重新编译它不是一种选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T21:49:53.857

我通过利用 dotNetObject 包装的任何 CLR 对象将自动用另一个包装器包装返回值（方法结果和属性值）这一事实解决了这个问题。这甚至适用于用 dotNetClass 包装的 CLR 类型的静态方法和属性。

假设我的插件中已经有了一个方法，可以让我执行任意 MAXScript：

```
Value* EvalScript(System::String ^script); 
```

现在我只需要将一个对象序列化为一个字符串，然后再返回一个活动对象（对同一对象的引用，而不仅仅是一个副本！）。

我通过抓取`GCHandle`对象的 来做到这一点，`GCHandle::ToIntPtr`用于将其转换为可 blitable 的对象，并用于`GCHandle::FromIntPtr`在不同的上下文中实现相同的对象。当然，我正在处理中（并且在同一个应用程序域中）这样做，否则这是行不通的。

```
Value* WrapObject(System::Object ^obj)
{
    GCHandle handle = GCHandle::Alloc(obj)
    try
    {
        return EvalScript(System::String::Format(
            L"((dotNetClass \"System.Runtime.InteropServices.GCHandle\").FromIntPtr (dotNetObject \"System.IntPtr\" {0})).get_Target()",
            GCHandle::ToIntPtr(handle));
    }
    finally
    {
        handle.Free();
    }
} 
```

我在实际代码中解释这一点的注释是实际代码的 10 倍以上。

# asp.net - 如何在 ASP.NET 菜单项上放置渐变背景？

> ID：421570
> 
> 赞同：2
> 
> 时间：2009-01-07T18:55:26.793
> 
> 标签：asp.net, css, relative-path, menu, absolute-path

老板希望母版页的菜单看起来更好。我用网上可用的工具之一生成了我的渐变文件，那里没问题..

我尝试为每个菜单项创建一个 CSS 类，但是当我使用 background-image 指令和样式生成器时，我得到如下一行：

```
background-image: url('file:///C:/Documents and Settings/Username/My Documents/Visual Studio 2008/WebSites/ThisSite/Images/Gradient.png') 
```

...当我*想要*的是

```
background-image: url('~/Images/Gradient.png') 
```

当然，第一个 url 仅在我在本地机器上调试时才有效 - 部署它并且我已经被淹没了。许多其他 ASP.NET 对象使用“~/”来指示网站的顶级目录，但我的 css 文件不喜欢它，我无法为菜单控件或菜单​​项设置背景图像 -当我可以对这么多其他控件执行此操作时，这似乎是一个明显的遗漏。

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T18:58:54.867

CSS 中的 url 需要是绝对（或相对）url，并且不使用波浪号映射，因为它不是服务器端组件。

```
 background-image: url(  "/images/menu.jpg" ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T19:19:15.513

你快到了......试试这个：

```
.menuStyle
{
  background-image: url('/images/BG.gif'); /* Putting a slash in front means its relative to the root.  No slash would be relative to the current directory. */
  background-repeat: repeat-x; /* assuming you have a vertical gradient. */
} 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T19:04:35.713

这不是一个明显的遗漏。一点也不遗漏。波浪号是一个 ASP 结构。在您的 CSS 中，它没有任何意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T19:15:47.657

一次“全部替换”操作就可以了。

将**file:///C:/Documents and Settings/Username/My Documents/Visual Studio 2008/WebSites/ThisSite 替换**为空白。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-13T21:32:07.933

我已经尝试在我的 ASP.Net 应用程序中设置 CSS 的 background-image 属性（即给出帖子中描述的相对路径）。但是，它对我不起作用。后来，设置背景图像，因为`background-image:url('http://localhost:1701/Images/BannerTileBackground.gif');`它确实有效..

请让我知道什么是正确的方法，以及它以前不起作用的原因。

# c++ - 从向量中提取子向量的最佳方法？

> ID：421573
> 
> 赞同：350
> 
> 时间：2009-01-07T18:56:28.663
> 
> 标签：c++, stl, vector, range

假设我有一个`std::vector`（我们称之为`myVec`） size `N`。构造一个由元素 X 到 Y 的副本组成的新向量的最简单方法是什么，其中 0 <= X <= Y <= N-1？例如，`myVec [100000]`通过`myVec [100999]`一个大小为 的向量`150000`。

如果这不能用向量有效地完成，我应该使用另一种 STL 数据类型吗？

* * *

## 回答 #1

> 赞同：430
> 
> 时间：2009-01-07T19:04:54.513

```
vector<T>::const_iterator first = myVec.begin() + 100000;
vector<T>::const_iterator last = myVec.begin() + 101000;
vector<T> newVec(first, last); 
```

构造新向量是一个 O(N) 操作，但实际上没有更好的方法。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2009-01-07T19:14:47.300

只需使用向量构造函数。

```
std::vector<int>   data();
// Load Z elements into data so that Z > Y > X

std::vector<int>   sub(&data[100000],&data[101000]); 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2019-11-06T06:47:01.127

这个讨论已经很老了，但是最简单的还没有提到，使用[list-initialization](https://en.cppreference.com/w/cpp/language/list_initialization)：

```
 vector<int> subvector = {big_vector.begin() + 3, big_vector.end() - 2}; 
```

它需要 c++11 或更高版本。

示例用法：

```
#include <iostream>
#include <vector>
#include <algorithm>

using namespace std;

int main(){

    vector<int> big_vector = {5,12,4,6,7,8,9,9,31,1,1,5,76,78,8};
    vector<int> subvector = {big_vector.begin() + 3, big_vector.end() - 2};

    cout << "Big vector: ";
    for_each(big_vector.begin(), big_vector.end(),[](int number){cout << number << ";";});
    cout << endl << "Subvector: ";
    for_each(subvector.begin(), subvector.end(),[](int number){cout << number << ";";});
    cout << endl;
} 
```

结果：

```
Big vector: 5;12;4;6;7;8;9;9;31;1;1;5;76;78;8;
Subvector: 6;7;8;9;9;31;1;1;5;76; 
```

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2017-08-09T13:16:10.343

这些天来，我们使用`span`s! 所以你会写：

```
#include <gsl/span>

...
auto start_pos = 100000;
auto length = 1000;
auto span_of_myvec = gsl::make_span(myvec);
auto my_subspan = span_of_myvec.subspan(start_pos, length); 
```

`myvec`获得与's相同类型的 1000 个元素的跨度。或者更简洁的形式：

```
auto my_subspan = gsl::make_span(myvec).subspan(1000000, 1000); 
```

（但我不太喜欢这个，因为每个数字参数的含义并不完全清楚；如果 length 和 start_pos 处于同一数量级，情况会变得更糟。）

无论如何，记住这*不是一个副本，它只是一个*向量中数据的视图，所以要小心。如果你想要一个实际的副本，你可以这样做：

```
std::vector<T> new_vec(my_subspan.cbegin(), my_subspan.cend()); 
```

笔记：

*   `gsl`代表指南支持库。有关 的更多信息`gsl`，请参阅：[http](http://www.modernescpp.com/index.php/c-core-guideline-the-guidelines-support-library) ://www.modernescpp.com/index.php/c-core-guideline-the-guidelines-support-library 。
*   有几种`gsl`实现方式。例如：[https ://github.com/martinmoene/gsl-lite](https://github.com/martinmoene/gsl-lite)
*   C++20 提供了`span`. 您将使用`std::span`and`#include <span>`而不是`#include <gsl/span>`.
*   有关跨度的更多信息，请参阅：[什么是“跨度”以及何时应该使用跨度？](https://stackoverflow.com/questions/45723819/what-is-a-span-and-when-should-i-use-one)
*   `std::vector`有无数的构造函数，很容易陷入你不打算使用的构造函数中，所以要小心。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2009-01-07T19:04:46.197

`std::vector<T>(input_iterator, input_iterator)`，在您的情况下，请参见[此处](https://web.archive.org/web/20120120235758/http://www.dinkumware.com/manuals/default.aspx?manual=compleat&page=vector.html)`foo = std::vector<T>(myVec.begin () + 100000, myVec.begin () + 150000);`的示例

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-01-07T19:26:37.870

如果两者都不会被修改（不添加/删除项目 - 只要您注意线程问题，修改现有项目就可以了），您可以简单地传递`data.begin() + 100000`and `data.begin() + 101000`，并假装它们是较小向量的`begin()`and `end()`。

或者，由于向量存储保证是连续的，您可以简单地传递一个 1000 项数组：

```
T *arrayOfT = &data[0] + 100000;
size_t arrayOfTLength = 1000; 
```

这两种技术都需要恒定的时间，但要求数据的长度不会增加，从而触发重新分配。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-10-16T02:03:14.890

你没有提到类型`std::vector<...> myVec`是什么，但是如果它是一个简单的类型或不包含指针的结构/类，并且你想要最好的效率，那么你可以做一个直接的内存复制（我认为这会比提供的其他答案）。以下是在这种情况下为`std::vector<type> myVec`where的一般示例：`type``int`

```
typedef int type; //choose your custom type/struct/class
int iFirst = 100000; //first index to copy
int iLast = 101000; //last index + 1
int iLen = iLast - iFirst;
std::vector<type> newVec;
newVec.resize(iLen); //pre-allocate the space needed to write the data directly
memcpy(&newVec[0], &myVec[iFirst], iLen*sizeof(type)); //write directly to destination buffer from source buffer 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2019-06-10T00:27:45.283

你可以使用`insert`

```
vector<type> myVec { n_elements };

vector<type> newVec;

newVec.insert(newVec.begin(), myVec.begin() + X, myVec.begin() + Y); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-07T19:03:48.150

当 M 是子向量的大小时，您可以使用具有 O(M) 性能的[STL 复制。](http://www.cplusplus.com/reference/algorithm/copy.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-07T19:06:30.203

投影非线性时间集合的唯一方法是懒惰地这样做，其中生成的“向量”实际上是委托给原始集合的子类型。例如，Scala 的`List#subseq`方法在恒定时间内创建一个子序列。但是，这仅在集合是不可变的并且基础语言支持垃圾收集的情况下才有效。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-11-15T02:13:03.167

假设有两个向量。

```
 vector<int> vect1{1, 2, 3, 4};
 vector<int> vect2; 
```

方法 1\. 使用复制功能。copy(first_iterator_index, last_iterator_index, back_inserter()) :- 这个函数有 3 个参数，首先是旧向量的第一个迭代器。其次，旧向量的最后一个迭代器和第三个是 back_inserter 函数，用于从后面插入值。

```
 // Copying vector by copy function
    copy(vect1.begin(), vect1.end(), back_inserter(vect2)); 
```

方法 2\. 通过使用分配功能。分配（first_iterator_o，last_iterator_o）。此方法为新向量分配与旧向量相同的值。这需要 2 个参数，第一个迭代器到旧向量，最后一个迭代器到旧向量。

```
 //Copying vector by assign function
    vect2.assign(vect1.begin(), vect1.end()); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-27T07:36:01.240

也许 GSL 库中的[array_view/span](https://stackoverflow.com/questions/34832090/whats-the-difference-between-span-and-array-view-in-the-gsl-library)是一个不错的选择。

这也是一个单一的文件实现：[array_view](https://github.com/rhysd/array_view)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-06-24T05:25:54.923

**将元素从一个向量轻松复制到另一个向量**
在此示例中，我使用成对向量以使其易于
理解

```
vector<pair<int, int> > v(n);

//we want half of elements in vector a and another half in vector b
vector<pair<lli, lli> > a(v.begin(),v.begin()+n/2);
vector<pair<lli, lli> > b(v.begin()+n/2, v.end());

//if v = [(1, 2), (2, 3), (3, 4), (4, 5), (5, 6)]
//then a = [(1, 2), (2, 3)]
//and b = [(3, 4), (4, 5), (5, 6)]

//if v = [(1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)]
//then a = [(1, 2), (2, 3), (3, 4)]
//and b = [(4, 5), (5, 6), (6, 7)] 
```

'
如您所见，您可以轻松地将元素从一个向量复制到另一个向量，例如，如果您想将元素从索引 10 复制到 16，那么我们将使用

```
vector<pair<int, int> > a(v.begin()+10, v.begin+16); 
```

如果你想要从索引 10 到末尾的某个索引的元素，那么在这种情况下

```
vector<pair<int, int> > a(v.begin()+10, v.end()-5); 
```

希望这会有所帮助，请记住最后一种情况`v.end()-5 > v.begin()+10`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-06-29T20:22:38.913

还有一个选项：例如在 a`thrust::device_vector`和 a之间移动时很有用`thrust::host_vector`，你不能使用构造函数。

```
std::vector<T> newVector;
newVector.reserve(1000);
std::copy_n(&vec[100000], 1000, std::back_inserter(newVector)); 
```

也应该是复杂度 O(N)

您可以将其与顶级答案代码结合使用

```
vector<T>::const_iterator first = myVec.begin() + 100000;
vector<T>::const_iterator last = myVec.begin() + 101000;
std::copy(first, last, std::back_inserter(newVector)); 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2013-11-18T20:06:07.077

为其他人发布这个迟到..我敢打赌第一个编码器现在已经完成了。对于简单的数据类型，不需要复制，只需恢复到良好的旧 C 代码方法。

```
std::vector <int>   myVec;
int *p;
// Add some data here and set start, then
p=myVec.data()+start; 
```

然后将指针 p 和 len 传递给任何需要子向量的东西。

注意一定是！！`len < myVec.size()-start`

# .net - Silverlight: Binding a child controls property to a property in a user control

> ID：421581
> 
> 赞同：8
> 
> 时间：2009-01-07T18:57:24.823
> 
> 标签：.net, silverlight

If I have a user control defined:

```
public partial class MainFooter : UserControl
{
    public System.Windows.Media.Color BkColor;
} 
```

and it's xaml:

```
<UserControl x:Class="Test.MainFooter">
    <Grid x:Name="LayoutRoot">
        <Rectangle x:Name="rctBottom_Background2"
                   HorizontalAlignment="Stretch" 
                   Grid.Row="2">
            <Rectangle.Fill>
                <LinearGradientBrush EndPoint="0.82,0.895" StartPoint="0.911,-0.442">
                    <GradientStop Color="{**How can I bind this to the BkColor property?}"/**>
                    <GradientStop Color="#00FFFFFF" Offset="1"/>
                </LinearGradientBrush>
            </Rectangle.Fill>
        </Rectangle>
    </Grid>
</UserControl> 
```

and used:

```
<MyControls:MainFooter x:Name="rcrMainFooter"
                       BkColor="#FFE2B42A">
</MyControls:MainFooter> 
```

How would I go about binding the GradientStop Color in the Rectangle to the value of the it's user controls BkColor property?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-03-27T03:21:36.987

通常当我看到这个问题提出的答案是“你必须在代码中做”，这听起来像“Silverlight 绑定不支持这个” - 所以你必须通过设置“*完全手动*”来完成手的财产。但事实并非如此：

**Silverlight 绑定确实支持这一点——它只是 Silverlight XAML 不支持。**

`UserControl`这是一个基本上包装了 a的示例`DataForm`。在构造函数中，您运行可以绑定到“用户控件属性”的绑定。希望如果他们将来更改对此的 XAML 支持，那么回来修复将是微不足道的。

**应用程序.xaml**

```
<AddressControl MyHeader="Shipping Address"/> 
```

**地址控制.xaml**

```
<UserControl>
    <DataForm Name="dfAddress" Header="BOUND IN CODE"/>
</UserControl> 
```

*可选：*表明您已将代码中的值与注释绑定

**地址控制.xaml.cs**

```
publicAddressControl()
{
    InitializeComponent();

    // bind the HeaderProperty of 'dfAddress' to the 'MyHeader' dependency
    // property defined in this file
    dfAddress.SetBinding(DataForm.HeaderProperty, 
    new System.Windows.Data.Binding { Source = this, 
                                      Path = new PropertyPath("MyHeader") });
}

// standard string dependency property
public string MyHeader
{
    get { return (string)GetValue(MyHeaderProperty); }
    set { SetValue(MyHeaderProperty, value); }
}

public static readonly DependencyProperty MyHeaderProperty = 
       DependencyProperty.Register("MyHeader", typeof(string), 
       typeof(AddressControl), null); 
```

`MyHeader`这将我的`AddressControl`用户控件上的属性绑定到`Header`数据表单上的属性。我将其设为“我的”只是为了便于阅读——但实际上我在我的真实代码中只使用了“标题”。

真遗憾，我们仍然无法在 XAML 中执行此操作，但它比我第一次尝试捕获`DataContextChanged`事件然后手动设置要好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T02:53:33.107

唯一的方法是以编程方式进行（例如，在 BkColor 的更改事件中（假设它是 DependencyProperty）在控件的其他位置更改它。或者，您可以使用 ControlTemplate 并使用 TemplateBinding。如果您的 UserControl 是这（例如没有行为/方法/事件），然后用 ContentControl 替换您的用户控件并使用模板绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T19:07:59.390

Take a look at this blog post: [Workaround for missing ElementName in Silverlight 2.0 Binding](http://www.thejoyofcode.com/Workaround_for_missing_ElementName_in_Silverlight_2_0_Binding.aspx). It sounds like its a little different from what you're trying to do, but you may be able to wrangle his code to do what you want. Good luck! :-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-30T14:14:14.840

还有另一种选择。虽然您似乎无法绑定颜色值本身，但您可以绑定整个 Background 属性，如下所示：

< Border BorderThickness="2" BorderBrush="Black" CornerRadius="20" Background="{Binding Path=Background}" />

...接着...

```
Public ReadOnly Property Background As Brush
    Get
        Dim lgb As New LinearGradientBrush
        lgb.GradientStops = New GradientStopCollection From {New GradientStop With {.Color = PrimaryColor, .Offset = 0.0}, New GradientStop With {.Color = SecondaryColor, .Offset = 1.0}}
        lgb.StartPoint = New Point(0, 0)
        lgb.EndPoint = New Point(1, 1)
        Return lgb
    End Get
End Property 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-25T16:47:50.170

```
<LinearGradientBrush EndPoint="0.82,0.895" StartPoint="0.911,-0.442">                    
 <GradientStop Color="{TemplateBinding BackGround}" />
 <GradientStop Color="#00FFFFFF" Offset="1"/> </LinearGradientBrush> 
```

# opengl - 3ds max对象到opengl

> ID：421600
> 
> 赞同：6
> 
> 时间：2009-01-07T19:02:36.000
> 
> 标签：opengl, 3dsmax

我正在尝试使用已经制作的对象在 opengl 中组装一个场景。问题是对象是 .max 格式并且没有外部纹理。我怎么能在 opengl 中导入我的对象，而不重新纹理化它们。我正在考虑将它们导出到 3ds 并使用 3ds 文件加载器。你能推荐一个吗，当然它只能使用 3ds 文件本身，没有外部纹理文件。

* * *

3ds max 已经允许我将文件导出到 obj。我有一个没有外部纹理文件的对象，但它已经完全着色为 3ds 文件。有没有办法在opengl中导入并具有相同的颜色，用于树干，叶子？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T19:06:35.540

您可能想查看[lib3ds](http://www.lib3ds.org/)，它将为您解析 3ds 二进制格式并让您访问所有对象属性。我认为 Autodesk 也有自己的工具包来执行此操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T20:28:15.453

你应该看看这个[链接](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=6357&lngWId=3)。它是一个带有源代码的 3DS 查看器，使用 OpenGL 进行渲染。代码很简单。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-04T02:39:33.443

另一种选择可能是[Assimp](http://assimp.sourceforge.net/main_features.html)，这是一个用于 C 或 C++ 的开源资产导入库，这似乎是将 3DS 资产导入 opengl 程序的好方法。如果您希望它用于骨骼动画并支持嵌入式纹理，它会特别有用。虽然在这一点上，这个答案对你来说可能比遇到这个问题的其他人要少。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T20:30:51.873

如果我没记错的话，3ds 文件不存储顶点法线，因此您可能必须以某种方式自己计算它们，否则它将使用面部本身的法线，这将非常难看。

# qt - 从 QTreeWidget 中删除行（qt 编程）

> ID：421604
> 
> 赞同：2
> 
> 时间：2009-01-07T19:02:59.883
> 
> 标签：qt, kde, qtreewidget

从 QTreeWidget 中删除一行（QTreeWidgetItem）的最佳方法是什么？

QTreeWidget 内容由以下人员设置：

```
myQTreeWidget->insertTopLevelItems(0, items); // items = QList<QTreeWidgetItem*> 
```

然后我从我的 QList“项目”中删除一个项目，我尝试清除/重置 QTreeWidget

```
packList->clear();    
packList->insertTopLevelItems(0, items); 
```

但是我的应用程序在这里崩溃了！建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T19:20:04.030

您的问题是调用`packList->clear()`会删除树包含的树小部件项目。（请参阅有关 的文档`QTreeWidget::clear()`，其中包括有关在删除之前从树中删除的项目的注释。）您要么需要找到删除项目的方法，要么不维护与树分开的列表。

在一个稍微相关的说明中，如果您尝试跟踪其他数据以及树，我建议您尝试使用模型范例。在不平凡的情况下，通常值得我花时间转换为该技术，而不是使用小部件/项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T19:19:39.473

根据[本文档](http://docs.huihoo.com/pyqt/pyqt4/html/qtreewidget.html#takeTopLevelItem)的说明，您应该能够做到这一点：

```
packList->takeTopLevelItem(index); 
```

哪个返回删除并返回提供的索引处的项目。

# c# - 非常非常大的 C# 浮点数

> ID：421612
> 
> 赞同：6
> 
> 时间：2009-01-07T19:04:45.777
> 
> 标签：c#, math, bigdecimal

我正在做一些人口建模（为了好玩，主要是为了玩承载能力和物流功能的概念）。该模型适用于多个行星（目前大约有 100,000 个）。当人口达到一个星球的承载能力时，居民开始向附近的星球扩张，依此类推。

问题：100,000 多个行星可以容纳很多人。不仅仅是 C#`Decimal`可以处理的。由于我正在用这些数字做平均值和其他东西，我需要能够处理浮点数（或者我只使用 BigInt 库）。

有谁知道我可以使用的 BigFloatingPoint 类（或其他）？谷歌今天非常无助。我可能会编写一个运行良好的类，但如果存在这样的东西，我宁愿使用预先存在的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-07T19:29:50.093

使用百万人的单位来获得更多的净空。

此外，如果[我的算术](http://www.google.co.uk/search?hl=en&rlz=1B5GGGL_enGB302GB302&q=(79228162514264337593543950335+%2F+100000)+%2F+6000000000&btnG=Search&meta=)正确的话，十进制可以让你拥有 100,000 个行星，每个行星的人口是地球人口的 100000000000000 倍。你确定这还不够吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T19:32:38.030

即使每个星球有1000亿人，总数也只有1E16。这完全在有符号 64 位整数的限制范围内（2^63 变为 9,223,372,036,854,775,807，几乎是 1E19...

你可以在每个星球上拥有 100 亿人，在接近极限之前拥有 100000 颗星球......

至于分数和平均值等，当您进行任何此类计算时，您不能转换为浮点数或双精度数吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T19:10:16.233

你真的需要 28 位精度吗？您可以使用浮点数进行一些计算吗？

（准确地说是双倍：±5.0e−324 到 ±1.7e308）

# c# - How can I strip punctuation from a string?

> ID：421616
> 
> 赞同：73
> 
> 时间：2009-01-07T19:05:05.743
> 
> 标签：c#, string

For the hope-to-have-an-answer-in-30-seconds part of this question, I'm specifically looking for C#

But in the general case, what's the best way to strip punctuation in any language?

**I should add:** Ideally, the solutions won't require you to enumerate all the possible punctuation marks.

Related: [Strip Punctuation in Python](https://stackoverflow.com/questions/265960/best-way-to-strip-punctuation-from-a-string-in-python)

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2009-01-07T19:09:49.730

```
new string(myCharCollection.Where(c => !char.IsPunctuation(c)).ToArray()); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-07T19:51:00.567

为什么不简单：

```
字符串 s = "sxrdct?fvzguh,bij.";
var sb = new StringBuilder();

foreach (char c in s)
{
   if (!char.IsPunctuation(c))
      sb.Append(c);
}

s = sb.ToString();

```

RegEx 的使用通常比简单的字符操作要慢。那些 LINQ 操作对我来说看起来有点矫枉过正。而且你不能在.NET 2.0中使用这样的代码......

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-06-17T16:57:20.997

描述意图，最容易阅读（恕我直言）和最佳表现：

```
 s = s.StripPunctuation(); 
```

实施：

```
public static class StringExtension
{
    public static string StripPunctuation(this string s)
    {
        var sb = new StringBuilder();
        foreach (char c in s)
        {
            if (!char.IsPunctuation(c))
                sb.Append(c);
        }
        return sb.ToString();
    }
} 
```

这是使用 Hades32 的算法，这是发布的一堆中表现最好的。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-07T19:09:27.420

Assuming "best" means "simplest" I suggest using something like this:

```
String stripped = input.replaceAll("\\p{Punct}+", ""); 
```

This example is for [Java,](http://java.sun.com/javase/6/docs/api/java/util/regex/Pattern.html) but all sufficiently modern Regex engines should support this (or something similar).

Edit: the Unicode-Aware version would be this:

```
String stripped = input.replaceAll("\\p{P}+", ""); 
```

The first version only looks at punctuation characters contained in ASCII.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-07T19:12:33.170

You can use the regex.replace method:

```
 replace(YourString, RegularExpressionWithPunctuationMarks, Empty String) 
```

Since this returns a string, your method will look something like this:

```
 string s = Regex.Replace("Hello!?!?!?!", "[?!]", ""); 
```

You can replace "[?!]" with something more sophiticated if you want:

```
(\p{P}) 
```

This should find any punctuation.

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-09-29T13:26:07.520

这个线程太老了，但我不会发布更优雅（IMO）的解决方案。

```
string inputSansPunc = input.Where(c => !char.IsPunctuation(c)).Aggregate("", (current, c) => current + c); 
```

这是没有 WTF 的 LINQ。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-07T19:23:43.540

根据 GWLlosa 的想法，我能够想出极其丑陋但有效的方法：

> ```
> string s = "cat!";
> s = s.ToCharArray().ToList<char>()
>       .Where<char>(x => !char.IsPunctuation(x))
>       .Aggregate<char, string>(string.Empty, new Func<string, char, string>(
>              delegate(string s, char c) { return s + c; })); 
> ```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-07T19:08:38.640

The most braindead simple way of doing it would be using string.replace

The other way I would imagine is a regex.replace and have your regular expression with all the appropriate punctuation marks in it.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-07T19:39:11.073

这是使用 linq 的一种稍微不同的方法。我喜欢 AviewAnew 的，但这避免了聚合

```
 string myStr = "Hello there..';,]';';., Get rid of Punction";

        var s = from ch in myStr
                where !Char.IsPunctuation(ch)
                select ch;

        var bytes = UnicodeEncoding.ASCII.GetBytes(s.ToArray());
        var stringResult = UnicodeEncoding.ASCII.GetString(bytes); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-04-05T20:44:48.887

如果您想使用它来标记文本，您可以使用：

```
new string(myText.Select(c => char.IsPunctuation(c) ? ' ' : c).ToArray()) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-04-03T17:17:26.577

For anyone who would like to do this via RegEx:

This code shows the full RegEx replace process and gives a sample Regex that only keeps letters, numbers, and spaces in a string - replacing ALL other characters with an empty string:

```
//Regex to remove all non-alphanumeric characters
System.Text.RegularExpressions.Regex TitleRegex = new 
System.Text.RegularExpressions.Regex("[^a-z0-9 ]+", 
System.Text.RegularExpressions.RegexOptions.IgnoreCase);

string ParsedString = TitleRegex.Replace(stringToParse, String.Empty);

return ParsedString; 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-04-18T22:05:33.767

我遇到了同样的问题，并且担心每次检查都调用 IsPunctuation 对性能的影响。

我发现了这篇文章： http: [//www.dotnetperls.com/char-ispunctuation](http://www.dotnetperls.com/char-ispunctuation)。

跨界：char.IsPunctuation 还在 ASCII 之上处理 Unicode。该方法匹配一堆字符，包括控制字符。根据定义，这种方法既重又昂贵。

最重要的是，我最终没有选择它，因为它对我的 ETL 流程的性能影响。

我选择了 dotnetperls 的自定义实现。

仅供参考，这里是从之前的答案中推导出来的一些代码，以获取所有标点符号的列表（不包括控制符号）：

```
var punctuationCharacters = new List<char>();

        for (int i = char.MinValue; i <= char.MaxValue; i++)
        {
            var character = Convert.ToChar(i);

            if (char.IsPunctuation(character) && !char.IsControl(character))
            {
                punctuationCharacters.Add(character);
            }
        }

        var commaSeparatedValueOfPunctuationCharacters = string.Join("", punctuationCharacters);

        Console.WriteLine(commaSeparatedValueOfPunctuationCharacters); 
```

干杯，安德鲁

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-12-14T11:42:21.667

```
$newstr=ereg_replace("[[:punct:]]",'',$oldstr); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-09-03T11:38:05.940

对于长字符串，我使用这个：

```
var normalized = input
                .Where(c => !char.IsPunctuation(c))
                .Aggregate(new StringBuilder(),
                           (current, next) => current.Append(next), sb => sb.ToString()); 
```

性能比使用字符串连接好得多（尽管我同意它不太直观）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-10-26T19:07:00.563

这是从用户给出的字符串中删除标点符号的简单代码

## 导入所需库

```
 import string 
```

## 以字符串格式向用户询问输入

```
 strs = str(input('Enter your string:'))

    for c in string.punctuation:
        strs= strs.replace(c,"")
    print(f"\n Your String without punctuation:{strs}") 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-05-11T03:09:57.533

```
#include<string>
    #include<cctype>
    using namespace std;

    int main(int a, char* b[]){
    string strOne = "H,e.l/l!o W#o@r^l&d!!!";
    int punct_count = 0;

cout<<"before : "<<strOne<<endl;
for(string::size_type ix = 0 ;ix < strOne.size();++ix)   
{   
    if(ispunct(strOne[ix])) 
    {
            ++punct_count;  
            strOne.erase(ix,1); 
            ix--;
    }//if
}
    cout<<"after : "<<strOne<<endl;
                  return 0;
    }//main 
```

# python - 用于列出用户和组的 Python 脚本

> ID：421618
> 
> 赞同：25
> 
> 时间：2009-01-07T19:05:11.440
> 
> 标签：python, linux, sysadmin

我正在尝试编写一个脚本，在自己的行上输出每个用户及其组，如下所示：

```
user1 group1  
user2 group1  
user3 group2  
...  
user10 group6 
```

等等

我正在为此用python编写一个脚本，但想知道SO如何做到这一点。

ps 用任何语言尝试一下，但我更喜欢 python。

编辑：我在 Linux 上工作。Ubuntu 8.10 或 CentOS =)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-07T19:14:47.487

对于 *nix，你有[pwd](http://docs.python.org/2/library/pwd.html)和[grp](http://docs.python.org/2/library/grp.html)模块。您遍历`pwd.getpwall()`以获取所有用户。您使用 查找他们的组名`grp.getgrgid(gid)`。

```
import pwd, grp
for p in pwd.getpwall():
    print p[0], grp.getgrgid(p[3])[0] 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-07T19:12:27.697

该`grp`模块是你的朋友。查看`grp.getgrall()`以获取所有组及其成员的列表。

**编辑**示例：

```
import grp
groups = grp.getgrall()
for group in groups:
    for user in group[3]:
        print user, group[0] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-04-23T10:39:46.813

python 调用`grp.getgrall()`只显示本地组，这与调用 getgrouplist c 函数不同，后者会重新运行所有用户，例如 sssd 中由 ldap 支持但已关闭枚举的用户。（就像在 FreeIPA 中一样）。在搜索了在 python 中获取用户所属的所有组的最简单方法后，我发现最好的方法是实际调用[getgrouplist](http://man7.org/linux/man-pages/man3/getgrouplist.3.html) c 函数：

```
#!/usr/bin/python

import grp, pwd, os
from ctypes import *
from ctypes.util import find_library

libc = cdll.LoadLibrary(find_library('libc'))

getgrouplist = libc.getgrouplist
# 50 groups should be enought?
ngroups = 50
getgrouplist.argtypes = [c_char_p, c_uint, POINTER(c_uint * ngroups), POINTER(c_int)]
getgrouplist.restype = c_int32

grouplist = (c_uint * ngroups)()
ngrouplist = c_int(ngroups)

user = pwd.getpwuid(2540485)

ct = getgrouplist(user.pw_name, user.pw_gid, byref(grouplist), byref(ngrouplist))

# if 50 groups was not enough this will be -1, try again
# luckily the last call put the correct number of groups in ngrouplist
if ct < 0:
    getgrouplist.argtypes = [c_char_p, c_uint, POINTER(c_uint *int(ngrouplist.value)), POINTER(c_int)]
    grouplist = (c_uint * int(ngrouplist.value))()
    ct = getgrouplist(user.pw_name, user.pw_gid, byref(grouplist), byref(ngrouplist))

for i in xrange(0, ct):
    gid = grouplist[i]
    print grp.getgrgid(gid).gr_name 
```

获取所有用户的列表以类似地运行此函数需要弄清楚 c 调用是由什么进行的，`getent passwd`并在 python 中调用它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T19:19:11.193

sh/bash：

```
getent passwd | cut -f1 -d: | while read name; do echo -n "$name " ; groups $name ; done 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-08T20:29:40.177

> 一个简单的函数，它能够处理任何这些文件（/etc/passwd 和 /etc/group）的结构。

我相信这段代码可以满足您的需求，具有 Python 内置函数且无需额外模块：

```
#!/usr/bin/python

def read_and_parse(filename):
    """
        Reads and parses lines from /etc/passwd and /etc/group.

        Parameters

          filename : str
            Full path for filename.
    """
    data = []
    with open(filename, "r") as f:
        for line in f.readlines():
            data.append(line.split(":")[0])
        data.sort()
        for item in data:
            print("- " + item)

read_and_parse("/etc/group")
read_and_parse("/etc/passwd") 
```

# javascript - 帮助 javascript 中的正则表达式

> ID：421619
> 
> 赞同：1
> 
> 时间：2009-01-07T19:05:24.090
> 
> 标签：javascript, regex, classname

我有这个示例文本，它是从 html 元素上的类名中检索的：

```
rich-message err-test1 erroractive
rich-message err-test2 erroractive
rich-message erroractive err-test1
err-test2 rich-message erroractive 
```

我正在尝试匹配每个示例中的“test1”/“test2”数据。我目前正在使用以下正则表达式，它匹配“err-test1”类型的单词。我不知道如何将其限制为连字符（-）之后的数据。

```
/err-(\S*)/ig 
```

撞到这堵墙头疼。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T19:14:37.957

从我正在阅读的内容来看，您的代码已经有效。

**`Regex.exec()`成功返回结果数组。**

数组中的第一个元素（索引 0）返回整个字符串，之后所有`()`封闭的元素都被推入这个数组。

```
var string = 'rich-message err-test1 erroractive';
var regex = new RegExp('err-(\S*)', 'ig');
var result = regex.exec(string);

alert(result[0]) --> returns err-test1
alert(result[1]) --> returns test1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T19:12:21.907

您可以尝试 'err-([^ \n\r]*)' - 但您确定问题出在正则表达式吗？您是否使用整个结果，而不仅仅是第一次捕获？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T19:15:19.903

- 之后的东西应该在结果数组中。第一项是所有匹配的文本（例如“err-test1”），下一项是捕获括号中的匹配项（例如“test1”）。

```
myregex = /err-(\S*)/ig;
mymatch = myregex.exec("data with matches in it");
testnum = mymatch[1]; 
```

这是一个[参考站点](http://www.regular-expressions.info/javascript.html)。

# c - 如何将几个字符从 char[] 复制到 C 中的 char*？

> ID：421630
> 
> 赞同：3
> 
> 时间：2009-01-07T19:08:44.490
> 
> 标签：c, unix

哟！

我正在尝试将一些字符从 char[] 复制到 char*。我只想要索引 6 到（消息长度 - 9）的字符。

也许代码示例会更多地解释我的问题：

```
char buffer[512] = "GET /testfile.htm HTTP/1.0";
char* filename; // I want *filename to hold only "/testfile.htm"

msgLen = recv(connecting_socket, buffer, 512, 0);
strncpy(filename, buffer+5, msgLen-9); 
```

任何回应都会有很大帮助！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T19:12:33.670

我猜你的意思是...

```
strncpy(filename, buffer+5, msgLen-9); 
```

问题是你没有分配任何内存来保存你正在复制的字符。“文件名”是一个指针，但它不指向任何东西。

要么就声明

```
char filename[512]; 
```

或为新名称分配一些内存（不要忘记释放（）它......）

在您的代码中使用 strncpy() 存在一些问题。

*   buffer+5 指向字符串中的第六个字符（“T”），而你说你想要反斜杠。
*   最后一个参数是要复制的最大字节数，因此应该是 msglen-13。
*   strncpy() 不会终止复制的字符串，因此您需要手动执行此操作。
*   另外，从可读性的角度来看，我更喜欢

    strncpy(文件名, &buffer[4], msgLen-(9 + 4));

&buffer[5] 是数组中第五个位置的字符的地址。不过，这是个人的事情。

此外，值得指出的是，“recv”的结果可能是一个字节或 512 个字节。它不会只读取一行。你真的应该循环调用 recv 直到你有一个完整的行可以使用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T19:14:36.380

首先，您应该为`filename`. 下一个问题是您的偏移量。

```
char buffer[512] = "GET /testfile.htm HTTP/1.0";
char filename[512]; // I want *filename to hold only "/testfile.htm"

msgLen = recv(connecting_socket, buffer, 512, 0);
strncpy(filename, buffer+4, msgLen-4-9); 
//the first parameter should be buffer+4, not 5\. Indexes are zero based.
//the second parameter is count, not the end pointer. You should subtract
//the first 4 chars too. 
```

此外，您应该确保在字符串末尾添加一个空值，因为`strncpy`不会这样做。

```
filename[msgLen-4-9] = 0; 
```

您也可以使用`memcpy`而不是`strncpy`只复制一些字节：

```
memcpy(filename, buffer+4, msgLen-4-9);
fileName[msgLen-4-9] = 0; 
```

无论哪种情况，请确保验证您的输入。您可能会收到来自套接字的无效输入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T19:14:41.810

您的示例代码具有以下行：

```
char* filename; 
```

这是一个未初始化的指针——它没有指向任何地方，也没有任何存储支持。您需要为其分配一些内存，例如使用`malloc()`（并在完成后记住`free()`它），或者，在这种情况下，您可以简单地将其声明为字符数组，例如

```
char filename[SOME_BUFFER_SIZE]; 
```

在堆栈上声明一个数组的好处是当你完成它时你不需要显式地释放它。

从根本上说，C 中的数组只是隐藏指针的语法糖，因此您可以（通常）将 a`char[]`视为 a `char*`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T19:14:46.210

您没有为文件名分配任何空间

要么用类似的东西替换文件名的声明

```
char filename[512] 
```

或（可能更好）为文件名留出足够的空间

```
filename = (char *)malloc(msgLen - 9  - 6 + 1 ); /* + 1 for the terminating null */ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T19:16:27.937

您尚未为文件名分配任何内存空间。它是一个指针......但在初始化之前，它指向一些随机的内存区域。

您需要为文件名分配内存。正如罗迪所说，您可以将文件名声明为 512 字节。或者你可以：

```
filename = (char*)malloc(512*sizeof(char)); 
```

（注意： sizeof(char) 不是严格需要的，但我认为有助于明确分配的内容）。

在此语句之后，filename 是一个指向已分配内存的指针，您可以自由使用它，包括从缓冲区复制数据到它。如果您只复制有限的区域，请确保将文件名保留为空终止。

# assembly - 学习 (N)ASM 的最佳资源是什么？

> ID：421631
> 
> 赞同：11
> 
> 时间：2009-01-07T19:08:51.680
> 
> 标签：assembly, nasm

我想学习汇编已经有一段时间了，虽然我之前尝试过几次，但我还是没能通过“Hello, world”。是否有任何好的组装入门教程（最好使用 NASM，因为我使用 Windows 和 Linux）？

我确实有一点 C 知识，但主要是用 Ruby、Python、C# 和 JavaScript 等高级语言编写代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T19:15:31.043

这是一位前老师的有趣页面。[http://drpaulcarter.com/pcasm/](http://drpaulcarter.com/pcasm/)

不过，我还没有阅读过他的在线书籍。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T19:42:05.717

我尝试了一些汇编程序，我发现[FASM](http://flatassembler.net/)是最适合初学者的。它的宏语言有点糟糕，但除此之外它是一款出色的软件。它支持 Windows 和 Linux 对象格式（32 位或 64 位）。它有一个活跃且良好的社区，以及大量适合初学者的示例。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T20:15:01.687

对于我的汇编语言课，我们使用的是[比尔](https://stackoverflow.com/questions/421631/what-is-the-best-resource-for-learning-nasm#421676)推荐的书。我的教授还推荐了这本书：[Assembly Language Step-by-step: Programming with DOS and Linux](https://rads.stackoverflow.com/amzn/click/com/0471375233)。他说这是他所知道的唯一一本涵盖 NASM 的书（而且有点过时了）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-01-18T16:25:09.737

不幸的是，没有那么多好的资源和书籍可以学习`nasm`。但其中一些我可以推荐：

**资源**：

*   当然是[官方 NASM 文档](https://www.nasm.us/doc/)
*   [低级编程：英特尔® 64 位架构上的 C、汇编和程序执行](https://rads.stackoverflow.com/amzn/click/com/1484224027)
*   [基于 Intel 的计算机的汇编语言（Kip R. Irvine）](https://rads.stackoverflow.com/amzn/click/com/0132383101)
*   [Linux 64 位英特尔汇编语言编程简介（Benjamin Ray Seyfarth）](https://rads.stackoverflow.com/amzn/click/com/1478119209)
*   SO 的 x86 标签 wiki，[https://stackoverflow.com/tags/x86/info](https://stackoverflow.com/tags/x86/info)有指向教程、手册和性能调整信息的链接。

一旦我找到新的好资源，此列表将立即更新。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-07T19:56:52.443

不是专门针对 NASM，但[MASM 论坛](http://www.masm32.com/board/index.php?)有很多很好的信息，如果您向他们提出问题，您将获得更多帮助。

# .net - 使用“解决方案文件夹”组织 Visual Studio 解决方案

> ID：421641
> 
> 赞同：11
> 
> 时间：2009-01-07T19:10:23.113
> 
> 标签：.net, visual-studio-2008

在设置包含许多项目的 Visual Studio .NET 解决方案时，您发现“解决方案文件夹”有用吗？有什么缺点？

我最初的想法是，使用解决方案文件夹对于在解决方案中逻辑组织类似项目很有用。但是，我惊讶地发现创建解决方案文件夹不会创建相应的 Windows 文件夹。来自 MSDN：

> “解决方案文件夹是解决方案资源管理器中的一种组织工具；不会创建相应的 Windows 文件夹。我们建议您以与在解决方案中组织项目相同的方式组织磁盘上的项目。”

我正在考虑组织解决方案，以便每个项目都包含在解决方案文件夹中。这是一个好主意吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-07T19:51:49.440

解决方案文件夹可以帮助组织您的项目。它们有一个很大的优势：如果你想构建一些项目集，那么你可以标记它们并右键单击它们并选择“构建选定的项目”。如果您的解决方案文件夹组织适合您，您只需右键单击解决方案文件夹并选择“构建”。

我们有用于“MainApps”和“Test”（以及其他一些）的 sln 文件夹。如果您需要所有应用程序，则构建完整的解决方案。但是，如果您不想等待构建测试项目，您只需右键单击并构建“MainApps”文件夹！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-07T19:22:52.417

解决方案是相关项目的集合，它们聚集在一起以满足某些目的，例如应用程序。解决方案文件（是的，它是一个实际文件，而不是文件夹，尽管它在 VS 中看起来像一个文件夹）本身值得一看——它只是描述解决方案包含的内容的元数据，最重要的是它的项目。

您可以在不同的解决方案中完全合法地使用相同的项目。

例如，我们有一个 WinForms 应用程序，它有以下项目：

*   业务对象
*   数据访问
*   环境支持
*   自定义控件
*   MainUI（实际上并没有这样称呼它，但就是这样）

构建解决方案会构建整个 Windows 应用程序。

然后我们还有一个 Web 应用程序 - 在它自己的解决方案中。但是由于我们重用了我们的几个项目，它们也出现在 Web 解决方案中，它具有：

*   业务对象
*   数据访问
*   环境支持
*   MainWebUI（同样，它实际上并没有被称为这个）
*   自定义Web控件

同样，构建解决方案构建了整个网站。

我们的项目只出现在源代码管理中一次，这一切都是一种享受。

我们构建它的方式，一个解决方案几乎等同于一个应用程序，尽管这只是一种松散的关系。我们还有一个适用于 windows 应用程序的部署解决方案，其中包含所有 WinForms 应用程序项目，以及安装项目（创建 .MSI）。我们将其分开，因为它包含许多使其非常大的附加内容。

HTH。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T19:37:47.723

我们经常使用解决方案文件夹来“关联”解决方案中的项目。例如，我们的大多数“项目”都有 3 个实际项目——实现、单元测试和集成测试。我们将所有 3 个放在一个解决方案文件夹中。我们还可以将所有基础设施放在一个中，将所有 CAB 模块放在另一个中。基本上，当您有一个包含 50 多个项目的解决方案时，它有助于使它们保持井井有条，这样您就可以仅扩展您正在寻找的内容并根据逻辑分组查找内容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T19:13:07.007

不，您应该将所有*相关*项目放在一个解决方案中。如果您碰巧引用了另一个解决方案并希望访问其源代码，那么您可以将其添加为单独的解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T19:14:51.233

你应该以一种明智的方式组织起来。每个项目有一个解决方案文件夹是没有意义的。

我们经常使用的是这个

-> Web（所有 Web 项目）-> Data（任何与数据相关的项目）-> Test（所有单元测试项目）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-07T19:15:19.763

根据我的经验，由于 MSDN 所述，它们只会让事情变得更加混乱。如果您在 VS 中右键单击一个真实文件夹，您将获得“在 Windows 资源管理器中打开文件夹”命令。如果您右键单击解决方案文件夹，则什么也没有。此外，他们往往会弄乱导致解决方案资源管理器崩溃的例程；解决方案文件夹中的内容无法正确折叠。

如果您的解决方案中有很多项目，您觉得需要解决方案文件夹来整理它们，请考虑是否可以改为创建单独的解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T19:12:21.313

我不知道解决方案文件夹，但是在项目内部，您可以使用文件夹以合乎逻辑的方式将源文件组织在一起，这些似乎可以很好地转移到文件系统中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T20:38:45.073

对于正在开发的 WPF 应用程序让设计人员访问 Expression Blend 中的解决方案的情况，解决方案文件夹在 Blend 环境中将被忽略。因此，所有项目仍将显示在顶层。

此外，当 Blend 加载解决方案时，会显示一个消息框，说明“不支持解决方案文件夹。嵌套项目将正常加载。” 可以选中“不再显示此消息”选项，但这仍然有些麻烦。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-12T06:55:49.913

[这](https://stackoverflow.com/questions/152053/structuring-projects-dependencies-of-large-winforms-applications-in-c)是我不久前问的一个相关问题。我在那里的一个答案谈到了解决方案文件夹的一些优点/缺点，以及我目前如何使用它们。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-06-29T22:46:40.230

使用解决方案文件夹的一个缺点是它们在您的版本控制系统中的外观。由于解决方案文件夹是逻辑文件夹，因此您不会在 VCS 中看到它们。相反，您将在一个平面列表中看到所有项目。

这给我造成了困惑，因为结构可能看起来完全不同，特别是如果您的解决方案文件夹中有文件而不仅仅是项目。

# gdb - How do I stop execution in GDB without a breakpoint?

> ID：421655
> 
> 赞同：38
> 
> 时间：2009-01-07T19:13:06.133
> 
> 标签：gdb

How do I stop a GDB execution without a breakpoint?

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-07T19:19:28.117

只需使用常规中断`Ctrl`-`c`就可以正常工作。GDB 只是将其转发`SIGINT`给调试过程，然后该过程就死掉了。GDB 将捕获非标准出口并在那里中断进程，因此您仍然可以检查所有线程、它们的堆栈和变量的当前值。这很好用，但最好使用断点。我发现自己这样做的唯一一次是，如果我认为我已经陷入某种无限循环。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-06-27T16:17:10.140

GUI 应用程序不会像控制台应用程序那样对 ^C 和 ^Break 做出反应。由于现在大多数重要的项目往往是 GUI 应用程序或主要用于 GUI 应用程序的库，因此您有两种选择：

1.  从单独的终端向应用程序发送 SIGSTOP。这很麻烦。

2.  如果在 GDB 提示符下按 ^C 或 ^Break，GDB 将终止，但应用程序将继续运行。`-p`然后，您可以使用命令行开关再次运行 GDB 以附加到它。这会丢失调试器状态。

在这两种情况下，您可能会发现这很有帮助：您可以修改它以用于 shell 脚本、makefile 或发送信号而不是附加 GDB。`tasklist | grep`*`ProcessName`*`| sed -e 's/`*`ProcessName`*`*\([0-9]*\).*/gdb`*`ModuleName`*`-pid=\1/' > rungdb.sh`

`info threads`将帮助您确定要查看的线程。然后使用`thread`*`ThreadNumber`*切换到它。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-07T19:45:55.583

启动一个 shell，使用 ps 找到进程 ID，然后使用 kill 命令（例如 kill -INT pid）向它发送 SIGSTOP 或 SIGINT。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-07T19:20:40.440

只需键入不带任何参数的 BREAK。

Break，当不带任何参数调用时，break 在所选堆栈帧中要执行的下一条指令处设置断点

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-05-12T18:00:45.260

Ctrl + Z 似乎对我有用（但仅在某些情况下-我不确定为什么）。

# .net - XML 反序列化 - 自动将属性值转换为类 (.net)

> ID：421660
> 
> 赞同：0
> 
> 时间：2009-01-07T19:13:45.853
> 
> 标签：.net, xml-serialization

(vb.net/c#/等)

我无法弄清楚如何做一些反序列化魔术。目前标准反序列化工作正常，包括枚举，但*现在*我想将属性转换为类。哦！我在*想*什么！

我的 xml 看起来有点像这样：

```
....
<review user="..." version="2.2">...</review> 
```

这适用于我的财产/班级：

```
[XmlAttribute("version")]
public MyVersion Version { get; set; }

class MyVersion  {
    // equality overloaded
    // can ctype() from string to MyVersion
    // constructor that takes a single string, etc
} 
```

我怎样才能帮助序列化程序，以便它可以自动将我的字符串属性反序列化到这个类中？我是否需要以某种方式修改 MyVersion 类，或更改属性的定义？

*   我**不想**重写任何方法，如 OnDeserialized 等。这对这个项目来说是不值得的。

如果这不能用默认的 xml 反序列化器完成，那么知道就足够了。它有很多不好的地方，所以我不会感到惊讶。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T19:33:24.033

这不受声明性方式的支持。您必须在父类（序列化为元素的类）上实现 IXmlSerializable 并手动执行字符串和 MyValue 类型之间的转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T19:46:58.670

你可以很容易地做到这一点 - 只是不是作为反序列化操作。

使用 XSD 创建您的反序列化类。现在这些都是部分类，因此您可以编写评论类的新部分（包含属性“版本”）并添加一个获取/设置版本的方法。

在 get 方法中简单地创建该类的新实例，并在 set 方法中简单地从提供的版本类更新现有版本。

# java - 用 Java 监控网络适配器的轻量级方法是什么？

> ID：421662
> 
> 赞同：1
> 
> 时间：2009-01-07T19:14:27.380
> 
> 标签：java, windows, networking

我希望能够检测计算机何时连接到网络。环境是Windows下的Java 5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T19:39:33.490

我认为您的选择是使用一些 JNI 库（尽管我不熟悉一个临时库，而且这往往是特定于平台的），或者只是尝试与某个已知 IP 建立网络连接（例如谷歌）。这两种解决方案都不优雅，但我认为 1.5 中没有纯 Java API 来确定这一点。

在 Java 1.6 中，您可以使用 java.net.NetworkInterface.isUp()，但显然这对您使用 1.5 的情况没有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T19:48:28.857

也许签入一个线程？

```
try {
  InetAddress inetAddr = InetAddress.getByName(host);
  setOnline();
} catch (UnknownHostException e) {
  setOffline();
} 
```

# cocoa-touch - Animating Tab Bar page switching

> ID：421683
> 
> 赞同：3
> 
> 时间：2009-01-07T19:16:53.613
> 
> 标签：cocoa-touch

I'm quite confused with the whole animation stuff in iPhone SDK. I tried to study throught the SDK documentation, this website or tried googling it out without success. I'm unable to get my scenario work.

*   I have single XIB file, with tab bar and a 4 tabs.
*   In a special event i want to switch from one page to another "in code", so I call eg: `[tabController selectedIndex: 0]`.
*   I need this transition to be animated. Is there a way?
*   If user switches tabs manually, no animated transitions are needed

Also I have one subquestion:

*   In one of the tabs I have a UITableView with set of items. When user clicks any of these items, another set of items are beign shown (sort of hierarchy browser)
*   I tried to animate this transition using `-deleteRowsAtIndexPaths:withRowAnimation:` and `-insertRowsAtIndexPaths:withRowAnimation:`, but without luck.
*   Desired transition is shifting the old items set to the left side and the new items from the right side.

This is first time of my iPhone development, when I got lost even with all the forums and documentation. :)

Thanks in advance to anyone trying to help me!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T08:54:26.293

至于你的第一个问题：是的，你可以。试试这个链接以获得一些答案： [标签栏示例代码上的转换](http://www.iphonedevsdk.com/forum/iphone-sdk-development/13427-uiview-slide-transition.html)。

简而言之：您应该添加一个委托对象来通过设置`tabBarController.delegate = self`.
然而，这个论坛帖子不会告诉你的是，你需要“导入”一些框架来做到这一点。
首先 - 右键单击​​ Xcode 左侧列表中的框架文件夹，然后添加一个名为“QuartzCore.framework”的现有框架。
比 - 将这些行添加到您的标签栏持有人（在 .h 文件上）：

```
#import <QuartzCore/CAAnimation.h>
#import <QuartzCore/CAMediaTimingFunction.h> 
```

至于您的第二个问题，请尝试替换数据源（数组或其他）或在单元格上创建登录功能以替换其内容。

享受！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T20:09:43.133

第一个问题：不，您不能为标签切换设置动画。请阅读 Apple 的人机界面指南。选项卡旨在立即切换。动画过渡会打破“标签”范式。

第二个问题：当您点击一行时，用户不希望其他行消失而新行出现。相反，这听起来像是 UINavigationController 的一个案例。请参考 Apple 的示例代码，特别是 UICatalog 以获取有关如何实现此功能的示例代码。

# javascript - 你最喜欢的 JS/CSS 下拉菜单是什么？

> ID：421708
> 
> 赞同：2
> 
> 时间：2009-01-07T19:23:55.223
> 
> 标签：javascript, html, css

希望在网站上实现一个，只是好奇其他人都使用过什么以及他们有过什么样的体验

**编辑**我也不是一个超级粉丝，但客户很坚持，在这种情况下，他们可以点击“悬停”部分，然后从那里进入下拉列表中的相同页面，所以基本上这只是一种获得到页面少点击

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T19:39:54.333

我真的很喜欢[A List Apart中的](http://www.alistapart.com/articles/dropdowns)[Suckerfish](http://www.htmldog.com/articles/suckerfish/example/)下拉菜单。它真的很容易实现（我自己做过，而且我不是一个Web程序员），甚至可以在IE中工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-08T15:13:56.133

[Superfish](http://users.tpg.com.au/j_birch/plugins/superfish/#examples)是 Suckerfish 的 jQuery 增强，支持多级下拉菜单和各种布局选项。

它很好地退化：

*   使用 Javascript 和 CSS，下拉菜单可以很好地淡入，并且菜单还有[其他增强功能](http://users.tpg.com.au/j_birch/plugins/superfish/#getting-started)。
*   仅使用 CSS，下拉菜单仍然有效（支持 IE6）。
*   两者都没有，菜单会降级为无序列的嵌套列表。

我现在正在使用它并且喜欢它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T19:38:21.340

我使用[YUI 菜单](http://developer.yahoo.com/yui/menu/)。它非常灵活，提供了许多声明列表中内容的方法，并且易于蒙皮。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T19:37:01.327

我在 Steve Gibson 的网站[grc.com](http://www.grc.com/menudemo.htm)上使用 on 。它是纯粹的 CSS——不使用 Javascript。它并不是那么直观，并且有些部分是特定于 IE 的，但它运行良好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T15:44:43.310

我推荐[mygosuMenu](http://code.gosu.pl/)。
从页面：
- 水平或垂直菜单
- 可以静态或绝对定位
- 显示/隐藏菜单的延迟（可以通过设置为 0 关闭）
- 子菜单的位置可以更改，因此它们可以例如溢出父元素
-在同一页面上可以创建许多菜单
- 分为 3 层：行为（javascript）、结构（html）、演示（css）
- 搜索引擎友好
- 任何使用免费（BSD 许可证）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T00:41:16.003

值得一试的是在吸盘鱼上略微扩张的超级鱼

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-01-07T19:27:55.807

我不喜欢它们，倾向于尽可能避免它们。

# asp.net - 将 asp.net 项目页面从 Windows-1251 转换为 Utf-8

> ID：421709
> 
> 赞同：0
> 
> 时间：2009-01-07T19:24:02.507
> 
> 标签：asp.net, visual-studio, encoding, utf-8, project

我可以在 Visual Studio 中使用 Save As Encoding 逐个文件地完成该文件，但我想一键完成。是否可以？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T21:36:10.627

我知道，有些人会开始抨击我：

下载一个 smalltalk IDE（例如 ST/X），打开一个工作区，输入：

```
'yourDirectoryHere' asFilename directoryContentsAsFilenamesDo:[:oldFileName |
   |cyrString utfString newFile|

   cyrString := oldFileName contentsAsString. 
   utfString := CharacterEncoder encodeString:cyrString from:#'iso8859-5' into:#'utf'.
   newFile := oldFile withSuffix:'utf'.
   newFile contents:utfString.
]. 
```

这将转换给定目录中的所有文件并创建相应的 .utf 文件而不影响原始文件。即使您通常不使用 smalltalk，对于此类操作，smalltalk 也是一个完美的脚本环境。

我知道，你们中的大多数人不阅读 smalltalk，但即使对于非 smalltalkers 和相应的 perl/python/java/c# 代码段也应该是可读的，并且也可以在 1 分钟左右的时间内编写和执行，将上述代码视为指引。我想所有当前的语言都提供类似于上面的 CharacterEncoder 的东西。

# debugging - 诊断/确定导致 Web 应用程序中混合内容警告的原因的最佳策略是什么？

> ID：421713
> 
> 赞同：2
> 
> 时间：2009-01-07T19:27:06.217
> 
> 标签：debugging, ssl

是否有某种可用的分析工具？查看源代码并搜索/替换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T19:34:26.467

尽管该消息通常是 IE 中的问题，但使用 Firebug 在 Firefox 中加载该页面会让您了解发生了什么。

此外，您可能会发现首先将协议从 URL 中移除会很有帮助：[Http-https 转换和相对 URL](http://nedbatchelder.com/blog/200710/httphttps_transitions_and_relative_urls.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T19:46:09.250

我使用了有帮助的查看源代码，尽管您可能想要一个工具来查看页面的当前源代码，例如 firefox 中的 firebug。

我遇到的一件没有帮助的事情是，如果您在 IE6 中有一个没有 src 属性的 iFrame。IE6 会警告您混合内容。没有大量的查看源对此有所帮助。

# 编辑

不知道为什么我不建议这样做，但您尝试使用 Fiddler？还是另一个数据包嗅探器？这应该让您看到 ssl 流量，这可能会帮助您缩小范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T01:00:12.267

如果您想要除[Fiddler](http://www.fiddlertool.com/fiddler/)、[Firebug](http://getfirebug.com/)或[HttpWatch](http://www.httpwatch.com/)之外的其他工具来尝试解决问题， [WireShark也可能会有所帮助。](http://www.wireshark.org/)

# mysql - 帮助访问 2007 sql 表？

> ID：421714
> 
> 赞同：0
> 
> 时间：2009-01-07T19:27:13.283
> 
> 标签：mysql, ms-access, ms-access-2007

有谁知道在哪里访问 2007 可以访问我的 sql 数据库的功能？我需要它来创建报告。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T19:30:40.700

创建 ODBC 连接。在 Microsoft Access 中，转到文件菜单并选择获取外部数据，然后从结果菜单中选择链接表...。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T19:52:42.967

除了 ocdecio 建议的链接表之外，您还可以执行“Access Database Project”——它基本上是 SQL 后端的 Access 前端。如果你这样做，你可以使用所有现有的视图、存储过程、函数等。

# c# - 使用带有 ASP.net 数据控件的 POCO 时实现排序/页面功能

> ID：421720
> 
> 赞同：2
> 
> 时间：2009-01-07T19:29:00.923
> 
> 标签：c#, data-binding, gridview, sorting, paging

我不是数据集的忠实粉丝，所以我使用 POCO 来返回数据。我已经使用我为适用于页面大小的 POCO 类型创建的自定义方法实现了分页和排序，并一次给我一组完整的 POCO 集合，我使用检查单击的 DataItem 的名称和排序顺序的方法做那种。为您计划与 Gridview 等 ASP.net 数据控件一起使用的每个 POCO 一遍又一遍地创建此类方法非常痛苦。

是否有一种技术可以自动执行此操作，这样我就不需要每次都为新的 POCO 制作这样的方法，以便它像使用 DataTable 一样工作？如果需要，我可以提供更多解释。

注意：有些人可能将 POCO 称为 DTO。

编辑：我发现[这篇](http://geekswithblogs.net/czumbano/archive/2006/03/27/73532.aspx)关于这个主题的文章。这是实现我想要做的唯一可能的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T19:47:24.130

我同意基类的想法，因为这将保存所有重复的代码。我朝着这个方向迈出的一步是创建一个类来处理任何通用列表的排序（对于 DTO/POCO）。这使我可以仅用 1 行代码对我的演示者或代码隐藏中的列表进行排序。

通常对于 SortExpression，我会返回要排序的 DTO 的属性名称。此外，SortDirection 将是一个简单的“升序”或“降序”

```
List<Supplier> SupplierList = mSupplierService.GetSuppliers();
SupplierList.Sort(new GenericComparer<Supplier>(mView.SortExpression, mView.SortDirection));
mView.Suppliers = SupplierList; 
```

这是我使用的课程

```
public class GenericComparer<T> : IComparer<T>
 {

     private string mDirection;
     private string mExpression;

     public GenericComparer(string Expression, string Direction)
     {
         mExpression = Expression;
         mDirection = Direction;
     }

     public int Compare(T x, T y)
     {
         PropertyInfo propertyInfo = typeof(T).GetProperty(mExpression);
         IComparable obj1 = (IComparable)propertyInfo.GetValue(x, null);
         IComparable obj2 = (IComparable)propertyInfo.GetValue(y, null);
         if (mDirection == "Ascending") {
             return obj1.CompareTo(obj2);
         }
         else {
             return obj2.CompareTo(obj1);
         }
     }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T19:33:16.733

我创建了一个实体基类。我的 DAO 派生自它并具有对应于表列的属性（大部分）。我的 DAL 为任何查询返回列表，并且可以绑定到 GridView。

# asp.net - 用于 asp.net 会员登录控制的模板或 css 皮肤？

> ID：421731
> 
> 赞同：1
> 
> 时间：2009-01-07T19:32:09.107
> 
> 标签：asp.net, css

我想设计 asp.net 会员登录控件的样式，我懒得手工制作一个看起来很专业的控件。

我找不到登录控件的现成 css 样式。网上有没有可用的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T01:09:57.683

最简单的做法是扩展当前样式表的外观。很可能在 Web 上找到的任何样式表在您的站点上下文中都显得格格不入。

话虽这么说，如果您想要一个具有许多良好内置样式的干净的起点，请查看[Google Blueprint](http://www.blueprintcss.org/)特别是他们的[表单演示页面](http://www.blueprintcss.org/tests/parts/forms.html)。

# sql-server - SQL Server 复制能否在复制数据中包含源 dbid？

> ID：421739
> 
> 赞同：2
> 
> 时间：2009-01-07T19:33:30.400
> 
> 标签：sql-server, replication

假设我有带有 TableA 的 DatabaseA，它具有以下字段：Id、Name。

在另一个数据库 DatabaseB 中，我有 TableA，其中包含以下字段：DatabaseId、Id、Name。

是否可以设置将发送的复制发布：

DatabaseA.dbid、DatabaseA.TableA.Id、DatabaseA.TableA.Name

到DatabaseB.TableA？

编辑：我要问的原因是我需要将多个数据库（具有相同的模式）组合到一个数据库中，并尽可能减少延迟。复制似乎是一个不错的起点（需要将数据从一个地方复制到另一个地方），但我正处于头脑风暴阶段。我肯定会接受有关如何在不使用复制的情况下完成此任务的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T19:39:21.730

您是否将来自多个来源的这些事件汇总到一个地方？复制只来自一个来源——它是一对一的，所以来源 ID 似乎没有多大意义。

如果您正在聚合来自多个来源的数据，那么链接服务器和触发器可能是更好的选择，如果是这种情况，那么您绝对可以包含有关您想要的来源的任何信息。

如果您可以澄清您的问题以描述目的，这将有助于我们找到最佳解决方案。

从问题的新细节更新：

这个解决方案听起来像是您需要的吗？

1.  在源数据库上设置 AFTER 触发器，将任何更改的行发送到中央存储库数据库，在某种保存表中。这些行可以包括其他列，例如“源”、“更改类型”（用于插入、删除等）。
2.  一些中央进程监视表并处理新行（或定期运行 - 也许每分钟一次），将它们合并到中央数据库中

您可以根据需要调整检查/合并过程在服务器上运行的频率（甚至不断运行它以处理出现的新行，甚至可能在该表上使用 AFTER 触发器）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T19:51:23.793

可能有更简单的方法，但我想到的第一件事是将 TableA 包装在源数据库上的索引视图中，然后将视图复制为表（即 type = "indexed view logbased"）。不过，我认为这不适用于合并复制。

所以，大概是这样的：

```
CREATE VIEW TableA_with_dbid WITH SCHEMABINDING AS
SELECT DatabaseA.dbid, Id, Name FROM TableA

CREATE UNIQUE CLUSTERED INDEX ON TableA_with_dbid (Id) -- or whatever your PK is

EXEC sp_addarticle ...,
    @source_object = 'TableA_with_dbid',
    @destination_table = 'TableA',
    @type = 'indexed view logbased',
    ... 
```

大警告：索引视图有[很多](http://msdn.microsoft.com/en-us/library/ms191432.aspx)可能不适合您的应用程序的要求。例如，每次更新基表时都必须设置某些选项。

（响应您问题中的编辑......）这不适用于将多个来源组合到一个表中。AFAIK，订阅数据库中的对象只能来自一篇已发表的文章。而且您不能在订阅端进行索引视图，因为在索引视图中不允许使用 UNION。（文档没有明确声明 UNION ALL 是不允许的，但这不会让我感到惊讶。您可以尝试以防万一。）但它仍然回答了您的明确问题：dbid 将在复制表中。

# google-app-engine - 在 GQL 中计算结果的最佳方法是什么？

> ID：421751
> 
> 赞同：30
> 
> 时间：2009-01-07T19:37:16.320
> 
> 标签：google-app-engine, gql, gqlquery

我认为进行计数的一种方法是这样的：

```
foo = db.GqlQuery("SELECT * FROM bar WHERE baz = 'baz')
my_count = foo.count() 
```

我不喜欢的是我的计数将被限制为最大 1000 并且我的查询可能会很慢。有人有解决方法吗？我有一个想法，但感觉不干净。如果只有 GQL 有一个真正的 COUNT 函数......

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-07T22:44:35.443

在使用像 GAE 这样的可扩展数据存储来预先进行计算时，您必须转变思路。在这种情况下，这意味着您需要为每个计数器保留`baz`并在添加新时递增它们`bar`，而不是在显示时计数。

```
class CategoryCounter(db.Model):
    category = db.StringProperty()
    count = db.IntegerProperty(default=0) 
```

然后在创建 Bar 对象时，增加计数器

```
def createNewBar(category_name):
  bar = Bar(...,baz=category_name)

  counter = CategoryCounter.filter('category =',category_name).get()
  if not counter:
    counter = CategoryCounter(category=category_name)
  else:
    counter.count += 1
  bar.put()
  counter.put()

db.run_in_transaction(createNewBar,'asdf') 
```

现在您可以轻松获取任何特定类别的计数

```
CategoryCounter.filter('category =',category_name).get().count 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-25T22:40:24.987

+1 对耶希亚的回应。

在 GAE 上获取对象计数器的官方和祝福方法是构建[分片计数器](http://code.google.com/appengine/articles/sharding_counters.html)。尽管名字听起来很重，但这很简单。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-08T09:57:36.753

所有数据库中的计数函数都很慢（例如，O(n)）——GAE 数据存储只是让这一点更加明显。正如 Jehiah 建议的那样，您需要将计算出的计数存储在一个实体中，如果您想要可扩展性，请参考它。

这不是 App Engine 独有的 - 其他数据库只是更好地隐藏它，直到您尝试计算每个请求的数万条记录，并且您的页面呈现时间开始呈指数增长......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-31T16:43:10.143

根据[`GqlQuery.count()`文档](https://developers.google.com/appengine/docs/python/datastore/gqlqueryclass#GqlQuery_count)，您可以将 设置为`limit`大于 1000 的某个数字：

```
from models import Troll
troll_count = Troll.all(keys_only=True).count(limit=31337) 
```

正如人们所说，分片计数器是跟踪此类数字的正确方法，但是如果您在游戏后期（像我一样）发现了这一点，那么您需要根据对象的实际计数来初始化计数器。但这是消耗 Datastore Small Operations 的免费配额（我认为是 50,000）的好方法。每次运行代码时，它都会使用与模型对象一样多的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T21:51:40.480

我还没有尝试过，这完全是资源消耗，但也许迭代`.fetch()`并指定偏移量会起作用吗？

```
LIMIT=1000
def count(query):
   result = offset = 0
   gql_query = db.GqlQuery(query)
   while True:
     count = gql_query.fetch(LIMIT, offset)
     if count < LIMIT:
       return result
     result += count
     offset += LIMIT 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-07T04:47:23.520

orip 的解决方案需要稍作调整：

```
LIMIT=1000
def count(query):
    result = offset = 0
    gql_query = db.GqlQuery(query)
    while True:
        count = len(gql_query.fetch(LIMIT, offset))
        result += count
        offset += LIMIT
        if count < LIMIT:
            return result 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-07T18:37:05.957

我们现在拥有可用于查询实体计数和其他数据的 Datastore Statistics。这些值并不总是反映最近的更改，因为它们每 24-48 小时更新一次。查看文档（请参阅下面的链接）以获取更多详细信息：

[数据存储统计](https://cloud.google.com/datastore/docs/concepts/stats)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-11T09:26:00.540

正如@Dimu 所指出的，当不需要精确的计数并且记录的百分比在任何一天都没有发生剧烈变化时，Google 定期计算的统计数据是一个不错的首选资源。

要查询给定种类的统计信息，可以使用以下 GQL 结构：

```
select * from __Stat_Kind__ where kind_name = 'Person' 
```

这返回了许多有用的属性：

*   `count`-- 此类实体的数量
*   `bytes`-- 存储的所有此类实体的总大小
*   `timestamp`--上次计算统计数据*的日期/时间*

**示例代码**

为了回答作为对我的答案的评论发布的后续问题，我现在提供一些`C#`我正在使用的示例代码，诚然，这些代码可能没有应有的强大，但对我来说似乎工作正常：

```
/// <summary>Returns an *estimated* number of entities of a given kind</summary>
public static long GetEstimatedEntityCount(this DatastoreDb database, string kind)
{
    var query = new GqlQuery
    {
        QueryString = $"select * from __Stat_Kind__ where kind_name = '{kind}'",
        AllowLiterals = true
    };
    var result = database.RunQuery(query);
    return (long) (result?.Entities?[0]?["count"] ?? 0L);
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2010-01-19T02:46:36.077

最好的解决方法可能看起来有点违反直觉，但它在我所有的 appengine 应用程序中都非常有效。与其依赖整数 KEY 和 count() 方法，不如将自己的整数字段添加到数据类型中。直到您实际上拥有超过 1000 条记录，并且您突然发现 fetch() 和 limit() 超过 1000 条记录边界时，这似乎是一种浪费。

```
def MyObj(db.Model):
  num = db.IntegerProperty() 
```

创建新对象时，必须手动检索最高键：

```
max = MyObj.all().order('-num').get()
if max : max = max.num+1
else : max = 0
newObj = MyObj(num = max)
newObj.put() 
```

这似乎是对查询的浪费，但 get() 从索引顶部返回一条记录。它非常快。

然后，当您想要获取超过第 1000 个对象限制时，您只需执行以下操作：

```
MyObj.all().filter('num > ' , 2345).fetch(67) 
```

当我阅读 Aral Balkan 的严厉评论时，我已经这样做了：http: [//aralbalkan.com/1504](http://aralbalkan.com/1504)。这很令人沮丧，但是当您习惯它并意识到这比关系数据库上的 count() 快得多时，您不会介意...

# regex - 正则表达式将逗号格式的数字与小数匹配

> ID：421757
> 
> 赞同：0
> 
> 时间：2009-01-07T19:38:46.020
> 
> 标签：regex

我有这个正则表达式：

```
^\$?(\d{1,3}(\,\d{3})*|(\d+))(\.\d{2})?$ 
```

但是，当我有这样的金额时，它就失败了：`41022095.6`

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T19:40:44.177

您的正则表达式不需要小数点，或者小数点后跟*两位*小数。这取决于您想要什么，但您可以通过执行以下操作使您的正则表达式匹配您建议的输入：

```
^\$?(\d{1,3}(\,\d{3})*|(\d+))(\.\d{1,2})?$ 
```

我`{2}`将近尾更改`{1,2}`为允许小数点后的一位或两位小数。我也将其更改为`.`，`\.`因为`.`正则表达式中的普通表示“匹配任何字符”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T19:41:03.177

除非它在括号中，否则点不是表示“[任何字符”吗？](http://www.regular-expressions.info/dot.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T19:41:10.867

这部分：`"(.\d{2})?"`表示您的号码可以选择以“点后跟两位数”结尾，但它是可选的。由于您的示例中的任何地方都没有“点后跟两位数”，并且没有其他允许点，因此它不匹配。

此外，ass duffymo 指出，您可能希望转义点以使其匹配句号而不是任何字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T19:41:22.630

尝试将最后一位更改为 (.\d{1,2})?。否则最后需要 2 位数字。

此外，您可能想转义“。”

# php - 这是什么编程语言？

> ID：421763
> 
> 赞同：1
> 
> 时间：2009-01-07T19:40:42.163
> 
> 标签：php, programming-languages, smarty

```
 <{if $ishtml == true}><font face="Verdana, Arial, Helvetica" size="2"><{$contentshtml}>
<BR><BR>
<{if $settings[t_enhistory] == 1}>
<fieldset style="margin-bottom: 6px; color: #333333;FONT: 11px Verdana, Tahoma;PADDING:3px;">
<legend><{$language[tickethistory]}></legend>
<{foreach key=key value=post from=$postlist}>
<{if $post[ticketpostid] != $ticket[lastpostid]}>
<b><{$post[fullname]}></b> (<{if $post[creator] == "staff"}><{$language[thstaff]}><{elseif $post[creator] == "thirdparty"}><{$language[ththirdparty]}><{elseif $post[creator] == "recipient"}><{$language[threcipient]}><{else}><{$language[thclient]}><{/if}>) <{$language[thpostedon]}> <{$post[date]}>
<hr>
<br>
<{$post[contents]}>

<{if $ticket[hasattachments] == "1" && $post[attachmentcount] > 0}>
<BR /><BR /><fieldset style="margin-bottom: 6px; color: #333333;FONT: 11px Verdana, Tahoma;PADDING:3px;"><legend><{$language[thattachments]}></legend>
<{foreach key=attachkey value=attachment from=$post[attachments]}>
<{$attachment[filename]}> (<{$attachment[attachmentsize]}>)<BR />
<{/foreach}>
</fieldset>
<{/if}>
<br><br>
<{/if}>
<{/foreach}>
</fieldset>
<{/if}>

<fieldset style="margin-bottom: 6px; color: #333333;FONT: 11px Verdana, Tahoma;PADDING:3px;">
<legend><{$language[ticketdetails]}></legend><BR>
<{$language[articketid]}><{$ticket[fticketid]}><BR>
<{$language[ardepartment]}><{$ticket[department]}><BR>
<{$language[arpriority]}><font color="<{$priority[frcolorcode]}>"><{$ticket[priority]}></font><BR>
<{$language[arstatus]}><font color="<{$status[statuscolor]}>"><{$ticket[status]}></font><BR>
</fieldset>
</font><{else}><{$contentstext}>

<{if $settings[t_enhistory] == 1}>
<{$language[tickethistory]}>
===================
<{foreach key=key value=post from=$postlist}>
<{if $post[ticketpostid] != $ticket[lastpostid]}>
<{$post[fullname]}> (<{if $post[creator] == "staff"}><{$language[thstaff]}><{elseif $post[creator] == "thirdparty"}><{$language[ththirdparty]}><{elseif $post[creator] == "recipient"}><{$language[threcipient]}><{else}><{$language[thclient]}><{/if}>) <{$language[thpostedon]}> <{$post[date]}>

===============================================================
<{$post[contentstext]}>

<{if $ticket[hasattachments] == "1" && $post[attachmentcount] > 0}>
<{foreach key=attachkey value=attachment from=$post[attachments]}>
<{$attachment[filename]}> (<{$attachment[attachmentsize]}>)
<{/foreach}>
<{/if}>

<{/if}>
<{/foreach}>

<{/if}>
<{$language[ticketdetails]}>
===================
<{$language[articketid]}><{$ticket[fticketid]}>
<{$language[ardepartment]}><{$ticket[department]}>
<{$language[arpriority]}><{$ticket[priority]}>
<{$language[arstatus]}><{$ticket[status]}><{/if}> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T19:44:44.027

我猜它来自 PHP 的[Smarty](http://www.smarty.net/crashcourse.php)模板。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T19:54:40.730

100% 肯定它很聪明，典型的文件扩展名是 .tpl

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T19:45:07.427

它看起来像[Smarty](http://www.smarty.net/)模板语法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T19:53:15.133

它聪明的模板语法

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T19:44:14.387

看起来像一些 php 或 perl 模板引擎，例如 Mason。

# c# - Linux上的WPF（已经）可能吗？

> ID：421764
> 
> 赞同：44
> 
> 时间：2009-01-07T19:40:44.160
> 
> 标签：c#, .net, wpf, mono

我喜欢使用 .NET 进行编程，尤其是 C# 3.0、.NET 3.5 和 WPF。但我特别喜欢的是 Mono .NET 真正独立于平台。

现在我听说了 Mono 中的 Olive 项目。我找不到某种 Beta。

它已经工作了吗？你们中的任何人有任何经验吗？

编辑：我知道月光。但我想要一个独立的 WPF 应用程序。并且**因为**Moonlight，我希望 Linux 上的 WPF 能够成为现实。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-07T19:50:34.560

使用以 Silverlight API 为目标的 Moonlight 会更好，它是完整 WPF 的子集。

编辑：当然，Silverlight 不是“打算”用于桌面的，但是没有理由不能在应用程序中嵌入 silverlight 引擎。以前做过，比如[Mac NY Times Reader](http://firstlook.blogs.nytimes.com/2008/05/12/times-reader-beta-coming-this-month/)

更多编辑：参见 Miguel 关于[独立 Silverlight 应用程序的帖子](http://tirania.org/blog/archive/2008/Apr-17.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-07T21:38:17.760

**更新**：由于人们一直对此表示赞同，我想指出它已经*过时*了。Mono 几年前被 MS 收购，他们对开源的态度已经改变，所以认为这篇文章已经过时了。（与 WPF 框架本身一样过时，呵呵）。

当涉及到 Winforms 和 WPF 等 Microsoft API 时，Mono 有点不舒服。.Net 技术的一个子集是 ECMA 标准，但这些 API 的免费实现可能在法律基础上更不稳定。我相信这是 Novell 和 Microsoft 之间的契约的一个重要因素，这对 Novell 客户来说是件好事。但是，使用 Mono 而不是 Novell 客户的人不受保护。出于这个原因，F/OSS 社区中的很多人都对 Mono 持怀疑态度，尽管它具有技术优势。

出于这个原因，Gtk# 将永远是首选，因为它是真正免费的。无论如何，许多人认为它优于 Winforms。就 WPF 而言，它几乎肯定是 Novell 的低优先级。他们最终可能会实施它，但我希望 Moonlight 是您在可预见的未来可以获得的最接近的。

* * *

自发布此消息以来，Microsoft 已将其承诺扩展到[任何实施 ECMA 334 和 335 标准的人](http://arstechnica.com/microsoft/news/2009/07/microsoft-issues-patent-promise-dispels-mono-concerns.ars)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-07T20:36:04.330

从[单声道网站](http://www.mono-project.com/WPF)

> 目前，Mono 项目没有计划将 Windows Presentation Foundation API 实现为项目的一部分。

Moonlight 是 silverlight 的一个实现，它是一种基于 WPF 子集的基于浏览器的类似 Flash 的技术。

在我看来，选择不实现 WPF 是 monos 最大的错误。由于 WPF 正迅速成为新的 .net 用户界面的默认选择。[有关更多信息，请参阅此博客](http://trampster.blogspot.com/2008/08/wpf-mono-and-wine.html)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-07-21T17:19:20.083

有一个名为[Silverform SDK](http://www.silverform.com "Silverform SDK")的库，旨在提供跨平台的 WPF 和 Silverlight 实现。

该库在托管代码中实现，目前使用 OpenTK 和 Unity3D 作为渲染后端。主要功能，例如绑定、布局、主控件和原语，已经实现（[在此处](http://www.silverform.com/demonstration-page "Silverform 演示页面")查看 Unity 网络播放器演示）。最初它专注于 Unity3d 渲染，而对独立 Mono 应用程序的支持将在未来作为单独的构建添加。

免责声明：我是该库的开发人员之一。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-01-14T10:39:30.647

如果您检查[此链接](https://appdb.winehq.org/objectManager.php?bShowAll=true&bIsQueue=false&bIsRejected=false&sClass=version&sTitle=&sReturnTo=&iId=17886)的已知错误（还包括在 Ubuntu 上安装 .NET 所需的步骤），或者您可能[会](http://wine.1045685.n5.nabble.com/Bug-33384-New-Basic-WPF-application-fails-to-handle-images-td5751393.html)发现 WPF 的某些（可能是错误的）版本目前可以在 Wine 上运行。我目前没有找到任何明确的测试，但值得尝试运行 WPF“Hello world”。

更新2：

我已经为16.04运行了最新`IlSpy`的最新版本。使用 32 位版本并通过与 windows 7 兼容安装。`Wine``Ubuntu``dotnet45``corefonts``winetricks`

这次没有崩溃，一切正常。字体看起来真的很好。

`IlSpy`通过 WPF 和`loves programming with .NET`必不可少的工具 - 反编译器显示。

我下载了最新的便携式 SharpDevelop（使用 WPF 构建），没有额外的。它开始了。无法创建 WPF 项目。创建 WinForms。打开一些 cs 文件并证明一些故障后，尝试输入 - 它崩溃了。

[![在 Ubuntu 上通过 Wine 进行 IlSpy](https://i.stack.imgur.com/twKF8.png)](https://i.stack.imgur.com/twKF8.png)

更新

我按照步骤在 Ubuntu 14.4 上运行了最新的 ILSpy.exe。

![在此处输入图像描述](https://i.stack.imgur.com/0wChC.png)

接下来要注意的事项：

1.  wine 表示 dotnet40 不支持 64 位配置，改为 32 位

2.  字体很丑，但可读

3.  基本功能工作正常 - 我可以看到反编译的代码 - 这对于某些开发来说已经足够了，但是查看 -> 搜索和查看 -> 选项 -> 显示崩溃。

结论：

Linux 上的 WPF 是可能的。但是需要一些方法来解决问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-07T19:47:59.370

从橄榄[主页](http://www.mono-project.com/Olive)：

> Olive 不受支持，应被视为实验性软件，并且由于它实现了不断变化的 API，因此无法保证 API 的稳定性。

我怀疑有人会在实际项目中使用它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-04-13T20:46:32.587

是的，可以使用[NoesisGUI](http://www.noesisengine.com/)实时多平台 XAML 实现。在 Linux 中已经有一些使用这种技术发布的游戏，比如[VoidExpanse](http://store.steampowered.com/app/324260/)

**披露**：我是该产品的开发人员之一。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T19:46:36.533

我听到一个播客采访 miguel de icaza（单声道领导）可能是几周前，所以那可能是 2008 年 12 月中旬，他说他们还没有 WPF 支持。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2019-07-03T01:41:04.810

理论上，可以针对 WinPR 或 LibWine 编译 WPF 的剥离版本以在 Linux 上运行。

目前没有这样的设置，所以需要有人做一个。希望这可能会很快改变。

就在完整的 Wine 环境中运行或在完整的 Wine 环境中运行而言，我认为这严重过度，并且会导致过多的臃肿，不值得让少量额外的程序工作。

# linux - bash 脚本在使用 . 操作员？

> ID：421772
> 
> 赞同：12
> 
> 时间：2009-01-07T19:41:47.277
> 
> 标签：linux, bash, unix, shell, scripting

我想做的是将文件中的设置包含到我当前的交互式 bash shell 中，如下所示：

$ . /path/to/some/dir/.settings

问题是 .settings 脚本也需要使用“.”。运算符包含其他文件，如下所示：

. .extra_settings

如何在 .settings 文件中引用 .extra_settings 的相对路径？这两个文件始终存储在同一个目录中，但该目录的路径将根据这些文件的安装位置而有所不同。

操作员始终知道 /path/to/some/dir/，如上所示。.settings 文件如何知道它的安装目录？我宁愿没有记录安装目录名称的安装过程。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-07T21:14:25.763

`$(dirname "$BASH_SOURCE")`只要您采购的文件**不是**符号链接，我相信会做您想做的事。

如果您正在采购的文件可能是符号链接，您可以执行以下操作来获取真实目录：

```
PRG="$BASH_SOURCE"
progname=`basename "$BASH_SOURCE"`

while [ -h "$PRG" ] ; do
    ls=`ls -ld "$PRG"`
    link=`expr "$ls" : '.*-> \(.*\)$'`
    if expr "$link" : '/.*' > /dev/null; then
        PRG="$link"
    else
        PRG=`dirname "$PRG"`"/$link"
    fi
done

dir=$(dirname "$PRG") 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-14T17:18:53.647

这可能是一个优雅的解决方案：

```
script_path="${BASH_SOURCE[0]}"
script_dir="$(cd "$(dirname "${script_path}")" && pwd)" 
```

但是，这在获取链接时不起作用。在这种情况下，一个人可能会做

```
script_path="$(readlink -f "$(readlink "${BASH_SOURCE[0]}")")"
script_dir="$(cd "$(dirname "${script_path}")" && pwd)" 
```

注意事项：

*   像这样`${array[x]}`的数组不符合 POSIX - 但是`BASH_SOURCE`，无论如何，该数组仅在 Bash 中可用
*   在 macOS 上，本机 BSD`readlink`不支持`-f`，因此您可能必须`readlink`使用例如[brew](https://brew.sh) by`brew install coreutils`和 replace `readlink`by来安装 GNU`greadlink`
*   根据您的用例，您可能希望使用`-e`or`-m`开关而不是`-f`plus 可能`-n`；有关详细信息，请参阅[readlink](https://linux.die.net/man/1/readlink)手册页

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T20:17:34.193

对这个问题有不同的看法——如果你使用的是“。” 为了设置环境变量，另一种标准方法是让您的脚本回显变量设置命令，例如：

```
# settings.sh
echo export CLASSPATH=${CLASSPATH}:/foo/bar 
```

然后评估输出：

```
eval $(/path/to/settings.sh) 
```

这就是像[模块](http://modules.sourceforge.net/)这样的包的工作方式。这种方式还可以轻松支持从 sh ( `X=...; export X`) 和 csh ( `setenv X ...`)派生的 shell

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-01T17:53:46.360

我们发现`$(dirname "$(realpath "$0")")`和 都是最可靠`sh`的`bash`。由于队友可以互换使用它们，我们遇到了 $BASH_SOURCE 不支持的问题`sh`。

相反，我们现在依赖`dirname`，它也可以堆叠来获取父文件夹或祖父文件夹。

以下示例返回包含 .sh 文件的文件夹的父目录：

```
parent_path=$(dirname "$(dirname "$(realpath "$0")")")
echo $parent_path 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T20:03:37.123

我尝试弄乱 $(dirname $0) 的变体，但是当 .settings 文件包含在“.”中时它会失败。如果我正在执行 .settings 文件而不是包含它，则此解决方案将起作用。相反，$(dirname $0) 总是返回“.”，表示当前目录。执行以下操作时失败：

$ 光盘 / $ 。/some/path/.settings

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T21:17:47.053

这类作品。它的工作原理是您可以使用 .settings 文件中的 $(dirname $0) 语法来确定它的主目录，因为您在新的 shell 中执行此脚本。但是，它增加了一个额外的卷积层，您需要在其中更改行，例如：

```
export MYDATE=$(date) 
```

到

```
echo "export MYDATE=\$(date)" 
```

也许这是唯一的方法？

# asp.net - 如何在 ASPX 中的 Repeater 中填充 UpdatePanel（不是代码隐藏）？

> ID：421773
> 
> 赞同：1
> 
> 时间：2009-01-07T19:42:00.693
> 
> 标签：asp.net, asp.net-ajax

我有一个Repeater，它显示项目列表（在类似网格/表格视图中）。当用户单击一个项目时，我会在该项目下显示一个 UpdatePanel，其中包含与该项目相关的附加信息（类似于 Accordion 控件）。我知道如何在代码隐藏中填充 UpdatePanel 的元素（我将 Repeater 控件中选定元素的 ID 作为 CommandArgument 传递，获取此 ID 的附加信息，并设置活动 UpdatePanel 控件的文本字段）。但我想知道是否可以直接在 ASPX 中设置绑定（而不是代码隐藏）。当我使用`<%= %>`语法来分配 UpdatePanel 的文本字段时，控制页面属性的值，例如`<%= Comment %>`，它有点工作，但它改变了转发器中所有 UpdatePanels 的字段。有没有办法将活动的 UpdatePanel 绑定到当前值并保持已绑定的 UpdatePanel 不变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-09T17:40:07.593

您是否正在寻找显示附加信息的容器？“盒子”中是否有其他活动需要它是更新面板？

```
<asp:repeater>
   <itemtemplate>
      <%# Eval("Name") %> <%# Eval("LastName") %><br />
      <span onclick="$get('<%# Eval("Id") %>')">View Age</span>
      <div id="<%# Eval("Id")%>" style="display:none;">
          Age: <%# Eval("Age") %>
      </div>
   <itemtemplate>
</asp:repeater> 
```

我认为这是对的，某些语法可能有点偏离（没有智能感知的打字）。那行得通吗？我使用 ID 作为 div id 和 onclick 命令的唯一标识符。你也可以使用 jquery、asp:controls 或任何你想要的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T08:03:48.110

最简单的方法是在更新面板中嵌套一个 FormView。然后在后面的代码中您唯一需要做的就是获取附加信息，将其分配给 FormView.DataSource，然后调用 FormView.DataBind()。FormView 中的所有内容都将使用 <%# Eval("SomeColumn") %> 语法。您可能需要使用 FindControl() 来获取对 FormView 的引用。我会为你输入代码，但我会为你省去一些麻烦，然后说不**要这样做。**

更新面板是关于做任何 ajax 东西的最低效的方法。使用此转发器和服务器端代码正确连接所有内容的唯一方法是拥有一个巨大的视图状态或在页面加载中重新绑定转发器。您正在将一个可能需要 300 毫秒的请求转换为需要一秒钟以上的时间……或更长的时间！熟悉一个好的 ajax 框架，不要害怕写真正的 html。至少，使用一个使用你的标记加载用户控件的 web 服务。

我知道更新面板很简单，而且它是内置的。它甚至可能足以满足您正在做的事情，但您必须抵制。你会很高兴你做到了。

# asp.net - 子文件夹中的 asp.net 站点默认文档

> ID：421778
> 
> 赞同：14
> 
> 时间：2009-01-07T19:43:48.693
> 
> 标签：asp.net, iis-7

我的默认文档位于子文件夹中，而不是根目录中，如何在 asp.net 2.0 网站中将其设为默认值。

尝试将 iis7 默认文档设置为 '/pages/default.aspx' '~/pages/default.aspx' 但它不起作用。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-07T19:56:42.770

默认文档与起始页不同。默认文档表示如果我请求`mysite.com/somefolder`但未指定文件，IIS 应显示哪个文件。

如果您想使用特定页面作为主页，请创建一个 Default.aspx 文件并将其写入它的代码隐藏类中：

```
public override void ProcessRequest(HttpContext context) {
    context.Response.Redirect("pages/default.aspx", true);
} 
```

由于客户端可能禁用了 Javascript，因此服务器端方法会更可靠。但是，最好发出永久重定向而不是简单的`Response.Redirect`. 从 SEO 的角度来看，使用 JS 也很糟糕。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-06-25T19:36:28.413

您不需要创建一个虚拟 Default.aspx 页面。

在 Global.asax.cs 文件中，编写以下内容：

```
public void Application_Start(object sender, EventArgs e)
{
    var routeCollection = RouteTable.Routes;
    routeCollection.MapPageRoute("DefaultRoute", string.Empty, "~/YourDesiredSubFolder/YourDesiredDocument.aspx");
} 
```

解释：

*   Application_Start 代码保证在应用程序启动时运行一次且仅运行一次。
*   第一行代码获取应用程序的 URL 路由集合。
*   第二行代码定义了一个新路由，指向您希望的子文件夹中的内页。
*   第二个参数为空，表示在没有请求特定页面且不存在默认文档时使用此路由。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T19:51:59.567

默认文档是特定于子文件夹的东西-您尝试做的事情不会（直接）起作用。在根目录中设置一个 default.htm 文件，并让它刷新到您真正的“主页”。

您应该问的更好的问题是您的主页到底是如何脱离根目录的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-18T13:25:03.443

理论上，您可以在目录中有一个 Web.config 文件并使用[defaultDocument 元素](http://msdn.microsoft.com/en-us/library/ms690361%28v=vs.90%29.aspx)来设置默认文档。见这里：[https](https://stackoverflow.com/a/2012079/125938) ://stackoverflow.com/a/2012079/125938 。
不幸的是，我无法让它自己在本地工作，但这[可能是](https://stackoverflow.com/a/1741405/125938)因为 Visual Studio 开发服务器不支持它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-11T09:29:34.500

说“index.html”是您想要的默认页面，它存在于“公共”子文件夹中。

不要将“/Public/index.html”指定为默认站点，而是尝试“Public/index.html”

# java - 在 Java 中进行对象到对象转换的简单/优雅的方法？

> ID：421782
> 
> 赞同：1
> 
> 时间：2009-01-07T19:44:31.453
> 
> 标签：java

我必须接管并改进/完成一些将 Java 对象从第三方库转换为内部对象的代码。目前，这是通过一个大的 if-else 语句来完成的：

```
if (obj instanceOf X)
{
    //code to initialize internal object
}
else if (obj instanceOf Y)
{
    //code to initialize different object
}
else if (obj instanceOf Z)
{
    //more init code
}
... 
```

我个人认为这个解决方案并不令人满意；它又长又乱，更糟糕的是，许多 if-else 块包含更多处理子类和边缘情况的 if-else 块。这个问题有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T19:48:11.150

创建这样的界面

```
public interface Converter<S,T> {
  public T convert(S source);
} 
```

并为 X,Y,Z 的每个对象实现它。然后将所有已知的转换器放入 Map 并获得快乐！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T19:51:00.707

虽然它不适用于边缘情况，但在类和转换器之间构建映射

X.getClass() -> X 转换器
Y.getClass() -> Y 转换器

会让你更接近。如果找不到叶类，您还想检查超类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T19:53:14.930

像这样的代码，连同它的所有`instanceof`条件，都需要一个接口！

你可能想`public interface Initializable`用一个方法创建一个 , `public void initialize()`。

然后，如果您的 if-else 只是简单地解析为一个`obj.initialize()`调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T21:04:48.513

如果这些内部对象为应用程序提供了一个接口，而不是直接使用，则调整它们而不是转换它们。

也就是说，如果你有这样的东西：

```
public class ThirdPartyClass { ... }
public interface InternalInterface { ... }
public class InternalClass { ... }

Internal foo(ThirdPartyClass thirdParty) {
    InternalClass internal = new InternalClass();
    // convert thirdPaty -> internal
    return internal;
} 
```

然后改为执行以下操作：

```
public class ThirdPartyClass { ... }
public interface InternalInterface { ... }
public class InternalClass { ... }

public class ThirdPartyInternalAdapter implements InternalInterface {
    private final ThirdPartyClass thirdParty;
    public ThirdPartyInternalAdapter(ThirdPartyClass thirdParty) {
        this.thirdParty = thirdParty;
    }
    // implement interface in terms of thirdParty
} 
```

从您的问题中不清楚这是否适用，但如果适用，这可能比直接的对象到对象转换更容易和更有效。

# asp.net - 如何创建动态 ASP:ImageMap

> ID：421789
> 
> 赞同：0
> 
> 时间：2009-01-07T19:45:51.903
> 
> 标签：asp.net

我想创建一个具有动态热点数量的 ASP:ImageMap。我尝试了下面的代码，但它抱怨在图像映射中嵌套了一个中继器。关于如何做到这一点的任何想法？

```
 <asp:ImageMap ID="imgMap" runat="server" ImageUrl="~/circles.png" 
                  HotSpotMode="PostBack">
       <asp:Repeater runat="server" id="repeat" DataSource=<%#circles %>>
            <asp:CircleHotSpot PostBackValue="<%#name %>" 
                               Radius="<%#r %>" 
                               X="<%#x %>" 
                               Y="<%#y %>" />
        </asp:Repeater>
    </asp:ImageMap> 
```

（请忽略数据绑定的问题。稍后我会解决这些问题。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T21:26:46.147

您需要使用服务器控件还是可以在常规 HTML 中使用？像这样的东西：

```
<map id="map1">
    <asp:Repeater ID="rep" runat="server">
    <ItemTemplate>
    <div align=center> 

    <area href="<%# DataBinder.Eval(Container.DataItem,"page")%>" 
     shape="circle" 
     coords="<%# DataBinder.Eval(Container.DataItem,"Coords")%>" 
     alt="area1" />
    </ItemTemplate>
    </asp:Repeater>
    </map>
    <img src="Images/HPIM1784.jpg" alt="bajs" usemap="#map1" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T04:59:26.607

您不能将转发器放置在另一个服务器标签内。ImageMap动态添加热点的方法是在后面的代码中动态添加。您应该能够在页面加载事件中使用与此类似的内容：

```
CircleHotSpot hotSpot = new CircleHotSpot();
hotSpot.PostBackValue = "xxxx";
hotSpot.X = xx;
hotSpot.Y = yy;
hotSpot.radius = r;
imgMap.HotSpots.Add(hotSpot); 
```

请原谅我有一段时间没有写这段代码，确切的语法可能有点偏差，但你应该明白这一点。如果您想添加多个热点，您可以将此代码块粘贴在 for/foreach 循环中，并遍历您想要变成热点的项目列表。

# javascript - 在javascript上循环数组的最快方法是什么？

> ID：421794
> 
> 赞同：0
> 
> 时间：2009-01-07T19:46:31.963
> 
> 标签：javascript, performance

> **可能重复：**
> [在 JavaScript 中循环的最佳方法是什么 在 JavaScript](https://stackoverflow.com/questions/193547/what-is-the-best-way-to-do-loops-in-javascript)
> [中循环一组元素的最佳方法是什么？](https://stackoverflow.com/questions/157260/whats-the-best-way-to-loop-through-a-set-of-elements-in-javascript)

有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-07T19:49:20.087

检查这个[JavaScript 循环基准](http://www.devpro.it/examples/loopsbench/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T19:48:43.380

一个好的老式`for`循环有什么问题？

```
for( var i = 0; i < list.length; i++ ) {
    // do something with list[i]
} 
```

`for...in`和的语义`for...each...in`往往会混淆人们并导致意想不到的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T20:09:52.417

CMS 的链接应该向您展示它们都很快的小型数据集，我唯一建议您避免`for (a in b)`，因为它比任何其他循环构造具有更高的内存开销，并且由于其“有趣”而可能会慢得多“语义。

Anyhoo，除了`for(in)`任何真正的 JS 之外，实际做实际工作的时间应该比处理循环本身所花费的时间要多得多，因此循环成本的微小变化不应该太重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T20:42:18.497

[Greg Reimer 的博客](http://blogs.oracle.com/greimer/entry/best_way_to_code_a)最近对此进行了介绍。

快速的答案是这样的：

```
for (var i=0, node; node = hColl[i++];) {
    // do something with node
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T20:58:03.597

正如在其他地方回答的那样（为什么这个线程存在？）：反过来：

```
var i = foo.length; while (i--) { /* do something with foo[i] */ } 
```

..是最快的循环，如果你能处理以下警告：

*   倒序并不总是合适的

*   有点难读

*   它将一个变量添加到它所在的任何范围的足迹

*   它仅比占用空间更小且可读性更强的缓存长度`for`循环稍快

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T01:41:16.960

据说对象更快......例如：

```
var array = {"0": "foo", "1": "bar"}
for(var i in array){
    var val = array[i];
    // do something
} 
```

# c# - 在 try { return x; 中真正发生了什么？} 最后 { x = null; } 陈述？

> ID：421797
> 
> 赞同：272
> 
> 时间：2009-01-07T19:47:03.350
> 
> 标签：c#, .net, exception-handling

我在另一个问题中看到了这个提示，想知道是否有人可以向我解释这到底是如何工作的？

```
try { return x; } finally { x = null; } 
```

我的意思是，`finally`子句真的在语句*之后执行吗？*`return`这段代码有多线程不安全？你能想到任何其他可以通过这个`try-finally`hack 完成的黑客行为吗？

* * *

## 回答 #1

> 赞同：376
> 
> 时间：2009-01-07T19:53:56.940

finally 语句被执行，但返回值不受影响。执行顺序为：

1.  执行 return 语句之前的代码
2.  return 语句中的表达式被评估
3.  finally 块被执行
4.  返回步骤 2 中评估的结果

这是一个简短的程序来演示：

```
using System;

class Test
{
    static string x;

    static void Main()
    {
        Console.WriteLine(Method());
        Console.WriteLine(x);
    }

    static string Method()
    {
        try
        {
            x = "try";
            return x;
        }
        finally
        {
            x = "finally";
        }
    }
} 
```

这会打印“try”（因为这是返回的内容），然后是“finally”，因为这是 x 的新值。

当然，如果我们返回一个对可变对象（例如 StringBuilder）的引用，那么在 finally 块中对对象所做的任何更改都将在返回时可见——这并没有影响返回值本身（这只是一个参考）。

* * *

## 回答 #2

> 赞同：245
> 
> 时间：2009-01-07T19:50:20.037

不 - 在 IL 级别，您不能从异常处理块内部返回。它本质上将其存储在一个变量中，然后返回

即类似于：

```
int tmp;
try {
  tmp = ...
} finally {
  ...
}
return tmp; 
```

例如（使用反射器）：

```
static int Test() {
    try {
        return SomeNumber();
    } finally {
        Foo();
    }
} 
```

编译为：

```
.method private hidebysig static int32 Test() cil managed
{
    .maxstack 1
    .locals init (
        [0] int32 CS$1$0000)
    L_0000: call int32 Program::SomeNumber()
    L_0005: stloc.0 
    L_0006: leave.s L_000e
    L_0008: call void Program::Foo()
    L_000d: endfinally 
    L_000e: ldloc.0 
    L_000f: ret 
    .try L_0000 to L_0008 finally handler L_0008 to L_000e
} 
```

这基本上声明了一个局部变量（`CS$1$0000`），将值放入变量中（在处理的块内），然后在退出块后加载变量，然后返回它。反射器将其呈现为：

```
private static int Test()
{
    int CS$1$0000;
    try
    {
        CS$1$0000 = SomeNumber();
    }
    finally
    {
        Foo();
    }
    return CS$1$0000;
} 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-01-07T19:49:44.750

finally 子句在 return 语句之后但在从函数实际返回之前执行。我认为这与线程安全无关。这不是 hack - finally 保证始终运行，无论您在 try 块或 catch 块中做什么。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-07-12T17:54:45.827

除了 Marc Gravell 和 Jon Skeet 给出的答案之外，重要的是要注意对象和其他引用类型在返回时的行为相似，但确实存在一些差异。

返回的“What”遵循与简单类型相同的逻辑：

```
class Test {
    public static Exception AnException() {
        Exception ex = new Exception("Me");
        try {
            return ex;
        } finally {
            // Reference unchanged, Local variable changed
            ex = new Exception("Not Me");
        }
    }
} 
```

在finally 块中为局部变量分配新引用之前，已经评估了正在返回的引用。

执行本质上是：

```
class Test {
    public static Exception AnException() {
        Exception ex = new Exception("Me");
        Exception CS$1$0000 = null;
        try {
            CS$1$0000 = ex;
        } finally {
            // Reference unchanged, Local variable changed
            ex = new Exception("Not Me");
        }
        return CS$1$0000;
    }
} 
```

不同之处在于仍然可以使用对象的属性/方法来修改可变类型，如果您不小心，可能会导致意外行为。

```
class Test2 {
    public static System.IO.MemoryStream BadStream(byte[] buffer) {
        System.IO.MemoryStream ms = new System.IO.MemoryStream(buffer);
        try {
            return ms;
        } finally {
            // Reference unchanged, Referenced Object changed
            ms.Dispose();
        }
    }
} 
```

关于 try-return-finally 要考虑的第二件事是“通过引用”传递的参数在返回后仍然可以修改。只有**返回值**已被评估并存储在等待返回的临时变量中，任何其他变量仍以正常方式修改。out 参数的合约甚至可以在 finally 块以这种方式之前无法实现。

```
class ByRefTests {
    public static int One(out int i) {
        try {
            i = 1;
            return i;
        } finally {
            // Return value unchanged, Store new value referenced variable
            i = 1000;
        }
    }

    public static int Two(ref int i) {
        try {
            i = 2;
            return i;
        } finally {
            // Return value unchanged, Store new value referenced variable
            i = 2000;
        }
    }

    public static int Three(out int i) {
        try {
            return 3;
        } finally {
            // This is not a compile error!
            // Return value unchanged, Store new value referenced variable
            i = 3000;
        }
    }
} 
```

像任何其他流结构一样，“try-return-finally”有它的位置，可以让代码看起来更简洁，而不是编写它**实际**编译到的结构。但必须小心使用它以避免陷阱。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-07T19:53:51.183

if`x`是一个局部变量，我看不到重点， as`x`无论如何都会在方法退出并且返回值的值不为 null 时有效设置为 null （因为它是在调用 set 之前放置在寄存器中的`x`为空）。

如果您想保证在返回时（以及在确定返回值之后）更改字段的值，我只能看到这样做。

# c# - SmsMessage 不是线程安全的吗？

> ID：421801
> 
> 赞同：2
> 
> 时间：2009-01-07T19:47:43.927
> 
> 标签：c#, windows-mobile

我正在为 WM 编写一个处理传入 SMS 事件的应用程序。我尝试使它成为多线程（使用 ThreadPool.QueueWorkItem），其中 SmsMessage 被传递。但是，我注意到当我这样做时，程序只会处理第一个短信事件 - 之后，设备根本没有收到任何短信！但是当程序退出时，所有错过的短信都到了。

基于此，我猜我的问题的答案是 SmsMessage 对象不是线程安全的，即使没有真正的迹象表明情况确实如此。

那么如果我们想尝试线程化一个 SmsMessage 对象呢？今晚我将通过制作 SmsMessage 的副本（可能通过使用带有项目 ID 的构造函数）来尝试这一点，或者我将创建一个空的并手动复制字段。

发现：

我缩小了我的问题。当我将 SmsMessage 复制到我自己的对象中时，我能够让一切在后台线程中工作，注意不要引用任何 SmsMessage 的对象。短信顺利通过。

但是，当我设置 MessageIntercepter 来启动应用程序并在该应用程序实例中使用后台线程发送 SMS 时，该应用程序可以正常工作，但是在它退出我的代码后它崩溃并显示“出现错误在 yourapp.exe 中”并询问我是否要将崩溃数据发送给 MS。我永远无法弄清楚那个错误是什么，但我发现如果我从启动应用程序的同一个线程发送 SMS，一切正常。

因此，应用程序打开时的线程 = 很好，只要您在应用程序外部启动时不传递/使用 SmsMessage 线程 = 很好，只要您不在另一个线程中发送 SmsMessage。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T20:05:12.863

根据[MSDN 库（Microsoft.WindowsMo​​bile.PocketOutlook.SmsMessage）](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.pocketoutlook.smsmessage.aspx)：

> 此类型的任何公共静态（在 Visual Basic 中为**Shared**）成员都是线程安全的。不保证任何实例成员都是线程安全的。

所以你的问题的答案是：**它不是线程安全的**。

**编辑**：我很高兴你设法让这件事发挥作用。我很确定这是 PocketOutlook 库中的一些竞争条件或非托管资源处理问题。

就个人而言，我认为您应该将所有与消息传递相关的代码保存在一个线程中，从 MessageInterceptor 创建的那一点到它被释放的那一点，并且只传递您编写的对象，这样您就知道它们没有狡猾的非托管依赖项（这就是我认为的那种） - 这应该足以避免这些问题。

无论如何，拥有 2 个 SMS 拦截器线程有什么意义？这不像一部手机可以同时接收两条短信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T19:57:09.447

如果没有看到更多代码，很难猜测发生了什么。我强烈怀疑这是您的线程代码而不是 SmsMessage 的问题。

如果你能解释你的应用程序的架构，那将有很大帮助。我不会惊讶地发现你在某个地方遇到了一个阻塞一切的死锁。

# java - 使用Java的FileLock时，可以让close()自动做一个lock.release()吗？

> ID：421833
> 
> 赞同：13
> 
> 时间：2009-01-07T19:55:56.530
> 
> 标签：java, nio, filelock

正如大多数人应该知道的那样，`close()`也关闭了任何流使用。

这允许以下代码：

```
BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(...)));
...
br.close(); 
```

这很好，因为我们不需要引用`FileInputStream`并记得关闭它。

但它也适用于`FileLock`s 吗？

```
final FileInputStream fis = new FileInputStream(new File("buffer.txt"));
final FileChannel c = fis.getChannel();
final FileLock lock = c.lock(0L, Long.MAX_VALUE, true);
final BufferedReader br = new BufferedReader(new InputStreamReader(fis));

try {
    while(br.ready()) {
        System.out.println(br.readLine());
    }
} finally {
    br.close();
} 
```

我已经尝试过这段代码，并且在`br.close()`调用时锁被正确释放，但是这样做安全吗？Closeable [JavaDoc](http://java.sun.com/javase/6/docs/api/java/io/Closeable.html#close())说：*“关闭此流并释放与之关联的任何系统资源。”* 我可以安全地假设我按照锁`close()`的规定使用吗？`release()`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T20:11:30.837

根据[JavaDoc](http://java.sun.com/javase/6/docs/api/java/nio/channels/FileLock.html)：

> 在通过调用 release 方法、关闭用于获取它的通道或终止 Java 虚拟机（以先到者为准）释放锁之前，它一直有效。

这里是内容`FileInputStream.close()`

```
public void close() throws IOException {
    if (channel != null)
        channel.close();
    close0();
} 
```

看起来`close`流上关闭了释放锁的通道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T19:59:14.480

是的。

锁依赖于文件描述符。当进程中没有代表文件的文件描述符时，就不会有与之关联的锁。

# sql-server - Sql Server 管理工作室如何自动大写

> ID：421847
> 
> 赞同：15
> 
> 时间：2009-01-07T20:00:05.243
> 
> 标签：sql-server, tsql, ssms

当您编写 sql 查询时，是否有任何免费的“内置”方法可以将 SQL 2005/2008 管理工作室中的“关键字”大写？

IE

```
truncate table x 
```

应自动更改为：

```
TRUNCATE TABLE x 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T20:04:20.680

只要您连接到 SQL 2008 数据库，2008 管理工作室中的智能感知就会执行此操作。

您可以在工具/选项/文本编辑器/Transact-SQL/IntelliSense 下更改您喜欢的大小写

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T20:01:49.717

SQL Server 2005 中没有内置的“智能感知”（2008 年有），但 Redgate 为这个和更多内容做了一个加载项。它将自动完成表名、列、添加方括号、重新格式化存储的过程等，并且效果很好：

[http://www.red-gate.com/products/SQL_Refactor/index.htm](http://www.red-gate.com/products/SQL_Refactor/index.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-12-07T17:48:30.857

我在 SSMS 中找到了一个用于自动大写/小写格式和缩进的隐藏宝石，我将永远使用它。不再有“新查询”。

对象资源管理器中的 Rt-Click 表名 | 编辑前 200 行 | QueryDesigner 菜单选项 | 窗格 | SQL。编写或放入一些丑陋的、非格式化的 SQL。查询设计器 | 验证 SQL 语法将为您提供 UC 保留字和缩进。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-06T18:47:30.713

您可以使用新查询并在编辑器中以小写形式输入 SQL。要将关键字更改为大写，请选择 SQL，然后按`Ctrl + Shift + Q`。查询设计器将打开。突出显示 SQL，然后右键单击以弹出菜单并选择验证 SQL 语法，这将大写关键字并格式化 SQL。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2021-02-02T11:53:44.120

据我所知，使用一些第三方工具，因为微软在过去 12 年没有做过这个请求，他们可能 - 不会很快做，我想这等于在黑暗中射击期待他们的这个功能！

-可悲的是，一个新的 SQL 开发人员 :(

# security - 是否有任何 JavaScript 工具包存在众所周知的安全漏洞？

> ID：421848
> 
> 赞同：0
> 
> 时间：2009-01-07T20:00:14.730
> 
> 标签：security, javascript-framework

我正在调查各种各样的网络框架，大多数都没有在他们的网站上提到安全问题（例如 scriptaculous、jQuery、Prototype、Rico）

有谁知道比其他人或多或少安全的东西？（忽略使用 JavaScript 提供的常见安全漏洞，例如 XSS）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T20:06:47.493

鉴于网站可以返回恶意 javascript，我猜想这取决于浏览器（而不是 javascript）来强制执行安全性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T20:45:24.043

qooxdoo 声称没有内存泄漏，并且还在其类定义中提供了析构函数机制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T20:23:01.650

由于 Javascript 被告知要在沙箱中执行，因此任何框架本身都不应存在安全问题。可能只有浏览器/JS 实现错误，如果有的话。

# c# - 如何在 C# 中子类的重写方法中返回子类型？

> ID：421851
> 
> 赞同：32
> 
> 时间：2009-01-07T20:01:33.760
> 
> 标签：c#, inheritance

我有一个带有重写方法的子类，我知道它总是返回基类中声明的返回类型的特定子类型。如果我以这种方式编写代码，它将无法编译。既然这可能没有意义，让我举一个代码示例：

```
class BaseReturnType { }
class DerivedReturnType : BaseReturnType { }

abstract class BaseClass {
    public abstract BaseReturnType PolymorphicMethod();
}

class DerivedClass : BaseClass {
    // Compile Error: return type must be 'BaseReturnType' to match 
    // overridden member 'BaseClass.PolymorphicMethod()'
    public override DerivedReturnType PolymorphicMethod() { 
        return new DerivedReturnType(); 
    }
} 
```

有什么方法可以在 C# 中实现这一点吗？如果没有，实现类似目标的最佳方法是什么？为什么不允许？它似乎不允许任何逻辑上的不一致，因为从被覆盖的方法返回的任何对象仍然是`is BaseReturnType`. 也许有一些我没有考虑过的事情。或者，原因可能是技术或历史。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-07T20:06:55.010

不幸的是，C# 不支持协变返回类型用于方法覆盖。（同上逆变参数类型。）

如果您正在实现一个接口，您可以使用“弱”版本显式实现它，并提供具有更强合约的公共版本。对于父类的简单覆盖，恐怕你没有这种奢侈:(

（编辑：Marc 有一个[合理的解决方案](https://stackoverflow.com/questions/421851/how-to-return-subtype-in-overridden-method-of-subclass-in-c#421881)——尽管它非常难看，而且方法隐藏通常对可读性不利。没有冒犯的意思，Marc；）

我*相信*这实际上是一个 CLR 限制，而不仅仅是一种语言限制——但我很可能是错的。

（作为历史问题，Java（该语言）在 1.5 之前具有相同的限制 - 但它与泛型同时获得协变。）

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-07T20:11:04.957

如果这不打扰您，您可以使该类通用：

```
 class BaseReturnType { }
    class DerivedReturnType : BaseReturnType { }

    abstract class BaseClass<T> where T : BaseReturnType
    {
        public abstract T PolymorphicMethod();
    }

    class DerivedClass : BaseClass<DerivedReturnType>
    {
        // Error: return type must be 'BaseReturnType' to match 
        // overridden member 'BaseClass.PolymorphicMethod()'
        public override DerivedReturnType PolymorphicMethod()
        {
            return new DerivedReturnType();
        }
    } 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-07T20:10:55.737

如果您引入一个额外的方法来覆盖，您可以这样做（因为您不能在同一类型中使用具有相同名称的方法）`override`：`new`

```
abstract class BaseClass
{
    public BaseReturnType PolymorphicMethod()
    { return PolymorphicMethodCore();}

    protected abstract BaseReturnType PolymorphicMethodCore();
}

class DerivedClass : BaseClass
{
    protected override BaseReturnType PolymorphicMethodCore()
    { return PolymorphicMethod(); }

    public new DerivedReturnType PolymorphicMethod()
    { return new DerivedReturnType(); }
} 
```

现在您`PolymorphicMethod`在每个级别都有一个具有正确类型的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T21:08:01.550

泛型不一定是要走的路。特别是，type(of Derived) 不被认为是 type(of Base)。

首先，向派生类添加一个新方法，该方法将返回具有正确类型的值。其次，将覆盖方法标记为不可覆盖，并将其委托给您的新方法。

就是这样。你已经解决了你的问题。子类将无法重新扩展类型，因为它们必须覆盖您的新方法。

如果代码不完全正确，我深表歉意；我习惯了 VB.net。

```
abstract class C1 {
    public abstract IEnumerable<Byte> F1();
}
class C2 : C1 {
    public sealed override IEnumerable<Byte> F1() {
        Return F2();
    }
    public overridable IList<Byte> F2() {
        Return {1, 2, 3, 4};
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T20:10:07.500

```
class BaseReturnType { }
class DerivedReturnType : BaseReturnType { }

abstract class BaseClass {
    public abstract BaseReturnType PolymorphicMethod();
}

class DerivedClass : BaseClass {
    // Error: return type must be 'BaseReturnType' to match 
    // overridden member 'BaseClass.PolymorphicMethod()'
    public override BaseReturnType PolymorphicMethod() { 
        return new DerivedReturnType(); 
    }
} 
```

这应该工作

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T20:14:15.963

将 Derived 类上的方法签名更改为：

```
 public override BaseReturnType PolymorphicMethod() 
 {
    return new DerivedReturnType();     
 } 
```

C# 不支持变体返回类型。您可以查看这篇文章，了解使用泛型执行此操作的方法... [http://srtsolutions.com/blogs/billwagner/archive/2005/06/17/covariint-return-types-in-c.aspx](http://srtsolutions.com/blogs/billwagner/archive/2005/06/17/covaraint-return-types-in-c.aspx)

这是在您的模型中使用泛型的示例：

```
public class BaseReturnType
{
}
public class DerivedReturnType : BaseReturnType
{
}

public abstract class BaseClass<T> where T : BaseReturnType
{
    public abstract T PolymorphicMethod();

}

public class DerviedClass : BaseClass<DerivedReturnType>
{
    public override DerivedReturnType PolymorphicMethod()
    {
        throw new NotImplementedException();
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T20:09:21.480

在我看来，您需要返回一个接口，而不是基类。

# interop - 在 C# 中使用 ActiveX PropertyBags

> ID：421857
> 
> 赞同：4
> 
> 时间：2009-01-07T20:03:06.423
> 
> 标签：interop, activex, propertybag

我创建了一个带有 ActiveX 界面的 .NET 用户控件。它运作良好。

现在，我希望能够从 ActiveX 接口的属性包中读取和写入。

我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-29T21:20:07.957

最简单的方法是使用客户端脚本将参数值传递给 ActiveX

```
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
<title></title>
<script language="javascript">

    function Rundata(file) 
    {            
        var winCtrl = document.getElementById("YourActiveX");                     
        winCtrl.Option1 = file;             
        winCtrl.WriteToFile();        
    }
</script>
</head>
<body>
<form id="form1" runat="server">
<div>
    <object id="YourActiveX" classid="clsid:6b1bdf22-1c1d-774e-cd9d-1d1aaf7fd88f" 
    width="300px" height="200px">
    <param name="Option1" value="valuetoRetrieve1" />
    </object>

    <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>

    <asp:Button runat="server" ID="Button1" OnClientClick="javascript:Rundata('valuetoRetrieve2');" />
</div>
</form>
</body>
</html> 
```

**如果您不能使用客户端脚本，您可以尝试这种方式：**

假设您要读取一个参数，例如：

```
<object id="YourActiveX" classid="clsid:6b1bdf22-1c1d-774e-cd9d-1d1aaf7fd88f" 
    width="300px" height="200px">
    <param name="option1" value="valuetoRetrieve" />
    </object> 
```

您需要在项目中公开以下 COM 接口：

```
[ComImport]
[Guid("55272A00-42CB-11CE-8135-00AA004BB851")]
[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IPropertyBag
{
    void Write([InAttribute] string propName, [InAttribute] ref Object ptrVar);
    void Read([InAttribute] string propName, out Object ptrVar, int errorLog);
}

[ComImport]
[Guid("37D84F60-42CB-11CE-8135-00AA004BB851")]
[InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
interface IPersistPropertyBag
{

    [PreserveSig]
    void InitNew();

    [PreserveSig]
    void Load(IPropertyBag propertyBag, int errorLog);

    [PreserveSig]
    void Save(IPropertyBag propertyBag, [InAttribute] bool clearDirty, [InAttribute] bool saveAllProperties);

    [PreserveSig]
    void GetClassID(out Guid classID);
} 
```

您的 activeX 控件应该实现这些接口。您需要实现一种方法：

```
void IPersistPropertyBag.Load(IPropertyBag propertyBag, int errorLog) 
    {
        object value; 
        propertyBag.Read("option1", out value, errorLog);  
        string parameter = (string)value;
    } 
```

瞧！参数应等于“valuetoRetrieve”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-03-18T16:27:42.963

我试图让我的 C# ActiveX 在 OBJECT 标记中接收 PARAM 属性。

我尝试使用此处提出的解决方案，但在加载对象时发现 IE 崩溃...

最后，我可以使用不同的 IPropertyBag 和 IPersistPropertyBag 接口来正确处理它：

```
[ComVisible(true), ComImport, 
Guid("0000010C-0000-0000-C000-000000000046"),
InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IPersist
{
    [PreserveSig]
    int GetClassID([Out] out Guid pClassID);
}

[ComVisible(true), ComImport,
Guid("37D84F60-42CB-11CE-8135-00AA004BB851"),//Guid("5738E040-B67F-11d0-BD4D-00A0C911CE86"),
InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IPersistPropertyBag : IPersist
{
    #region IPersist
    [PreserveSig]
    new int GetClassID([Out] out Guid pClassID);
    #endregion

    [PreserveSig]
    int InitNew();

    [PreserveSig]
    int Load(
    [In] IPropertyBag pPropBag,
    [In, MarshalAs(UnmanagedType.Interface)] object pErrorLog
    );

    [PreserveSig]
    int Save(
    IPropertyBag pPropBag,
    [In, MarshalAs(UnmanagedType.Bool)] bool fClearDirty,
    [In, MarshalAs(UnmanagedType.Bool)] bool fSaveAllProperties
    );
}

[ComVisible(true), ComImport,
Guid("55272A00-42CB-11CE-8135-00AA004BB851"),
InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
public interface IPropertyBag
{
    [PreserveSig]
    int Read(
    [In, MarshalAs(UnmanagedType.LPWStr)] string pszPropName,
    [In, Out, MarshalAs(UnmanagedType.Struct)]    ref    object pVar,
    [In] IntPtr pErrorLog);

    [PreserveSig]
    int Write(
    [In, MarshalAs(UnmanagedType.LPWStr)] string pszPropName,
    [In, MarshalAs(UnmanagedType.Struct)] ref object pVar);
} 
```

然后我实现了这样的加载方法：

```
#region IPropertyBag Members

    public int Read(string pszPropName, ref object pVar, IntPtr pErrorLog)
    {
        pVar = null;
        switch (pszPropName)
        {
            case "FileType": pVar = _fileType; break;
            case "WebServiceUrl": pVar = _webServiceUrl; break;
            case "Language": pVar = _language; break;
        }

        return 0;
    }

    public int Write(string pszPropName, ref object pVar)
    {
        switch (pszPropName)
        {
            case "FileType": _fileType = (string)pVar; break;
            case "WebServiceUrl": _webServiceUrl = (string)pVar; break;
            case "Language": _language = (string)pVar; break;
        }

        return 0;
    }

    #endregion

    #region IPersistPropertyBag Members

    public int GetClassID(out Guid pClassID)
    {
        throw new NotImplementedException();
    }

    public int InitNew()
    {
        return 0;
    }

    public int Load(IPropertyBag pPropBag, object pErrorLog)
    {
        object val = null;

        pPropBag.Read("FileType", ref val, IntPtr.Zero);
        Write("FileType", ref val);

        pPropBag.Read("WebServiceUrl", ref val, IntPtr.Zero);
        Write("WebServiceUrl", ref val);

        pPropBag.Read("Language", ref val, IntPtr.Zero);
        Write("Language", ref val);

        return 0;
    }

    public int Save(IPropertyBag pPropBag, bool fClearDirty, bool fSaveAllProperties)
    {
        return 0;
    }

    #endregion 
```

它奏效了。

希望这可以帮助处于相同情况的人。

# c++ - 从标准输入中捕获字符而无需等待按下回车键

> ID：421860
> 
> 赞同：214
> 
> 时间：2009-01-07T20:04:16.750
> 
> 标签：c++, c, inputstream

我永远不记得我是如何做到这一点的，因为它对我来说很少出现。但是在 C 或 C++ 中，从标准输入读取字符而不等待换行符（按回车键）的最佳方法是什么。

理想情况下，它不会将输入字符回显到屏幕上。我只想在不影响控制台屏幕的情况下捕获击键。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-01-07T20:08:54.710

这在纯 C++ 中以可移植的方式是不可能的，因为它过多地依赖于可能连接的终端`stdin`（它们通常是行缓冲的）。但是，您可以为此使用库：

1.  conio 可用于 Windows 编译器。使用该`_getch()`功能为您提供一个字符，而无需等待 Enter 键。我不是经常使用 Windows 开发人员，但我看到我的同学只是包含`<conio.h>`并使用它。参见[`conio.h`](http://en.wikipedia.org/wiki/Conio.h)维基百科。它列出了`getch()`，它在 Visual C++ 中被声明为弃用。

2.  可用于 Linux 的诅咒。兼容的 curses 实现也可用于 Windows。它还有一个`getch()`功能。（尝试`man getch`查看其联机帮助页）。参见维基百科上的[诅咒](http://en.wikipedia.org/wiki/Curses_%28programming_library%29)。

如果您的目标是跨平台兼容性，我建议您使用 curses。也就是说，我确信您可以使用某些功能来关闭线路缓冲（我相信这被称为“原始模式”，而不是“熟模式” - 查看`man stty`）。如果我没记错的话，Curses 会以便携的方式为你处理。

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2009-05-26T21:14:31.007

在 Linux（和其他类 unix 系统）上，这可以通过以下方式完成：

```
#include <unistd.h>
#include <termios.h>

char getch() {
        char buf = 0;
        struct termios old = {0};
        if (tcgetattr(0, &old) < 0)
                perror("tcsetattr()");
        old.c_lflag &= ~ICANON;
        old.c_lflag &= ~ECHO;
        old.c_cc[VMIN] = 1;
        old.c_cc[VTIME] = 0;
        if (tcsetattr(0, TCSANOW, &old) < 0)
                perror("tcsetattr ICANON");
        if (read(0, &buf, 1) < 0)
                perror ("read()");
        old.c_lflag |= ICANON;
        old.c_lflag |= ECHO;
        if (tcsetattr(0, TCSADRAIN, &old) < 0)
                perror ("tcsetattr ~ICANON");
        return (buf);
} 
```

基本上你必须关闭规范模式（和回声模式来抑制回声）。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-05-26T19:07:25.320

我在另一个论坛上发现了这个，同时寻求解决同样的问题。我已经根据我的发现对其进行了一些修改。它工作得很好。我运行的是 OS X，所以如果你运行的是 Microsoft，你需要找到正确的 system() 命令来切换到原始模式和熟模式。

```
#include <iostream> 
#include <stdio.h>  
using namespace std;  

int main() { 
  // Output prompt 
  cout << "Press any key to continue..." << endl; 

  // Set terminal to raw mode 
  system("stty raw"); 

  // Wait for single character 
  char input = getchar(); 

  // Echo input:
  cout << "--" << input << "--";

  // Reset terminal to normal "cooked" mode 
  system("stty cooked"); 

  // And we're out of here 
  return 0; 
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-01-07T21:37:10.243

CONIO.H

您需要的功能是：

```
int getch();
Prototype
    int _getch(void); 
Description
    _getch obtains a character  from stdin. Input is unbuffered, and this
    routine  will  return as  soon as  a character is  available  without 
    waiting for a carriage return. The character is not echoed to stdout.
    _getch bypasses the normal buffering done by getchar and getc. ungetc 
    cannot be used with _getch. 
Synonym
    Function: getch 

int kbhit();
Description
    Checks if a keyboard key has been pressed but not yet read. 
Return Value
    Returns a non-zero value if a key was pressed. Otherwise, returns 0. 
```

libconio [http://sourceforge.net/projects/libconio](http://sourceforge.net/projects/libconio)

或者

conio.h的Linux c++实现 [http://sourceforge.net/projects/linux-conioh](http://sourceforge.net/projects/linux-conioh)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-01-08T01:10:29.580

如果您在 Windows 上，您可以使用[PeekConsoleInput](http://msdn.microsoft.com/en-us/library/ms684344(VS.85).aspx)来检测是否有任何输入，

```
HANDLE handle = GetStdHandle(STD_INPUT_HANDLE);
DWORD events;
INPUT_RECORD buffer;
PeekConsoleInput( handle, &buffer, 1, &events ); 
```

然后使用 ReadConsoleInput 来“使用”输入字符..

```
PeekConsoleInput(handle, &buffer, 1, &events);
if(events > 0)
{
    ReadConsoleInput(handle, &buffer, 1, &events);  
    return buffer.Event.KeyEvent.wVirtualKeyCode;
}
else return 0 
```

老实说，这是来自我拥有的一些旧代码，所以你必须稍微摆弄一下。

很酷的一点是，它在不提示任何内容的情况下读取输入，因此根本不显示字符。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-07-07T23:44:17.643

```
#include <conio.h>

if (kbhit() != 0) {
    cout << getch() << endl;
} 
```

这用于`kbhit()`检查键盘是否被按下并用于`getch()`获取被按下的字符。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-10-18T18:01:29.270

我使用 kbhit() 查看是否存在 char，然后使用 getchar() 读取数据。在 Windows 上，您可以使用“conio.h”。在 linux 上，您必须实现自己的 kbhit()。

请参见下面的代码：

```
// kbhit
#include <stdio.h>
#include <sys/ioctl.h> // For FIONREAD
#include <termios.h>
#include <stdbool.h>

int kbhit(void) {
    static bool initflag = false;
    static const int STDIN = 0;

    if (!initflag) {
        // Use termios to turn off line buffering
        struct termios term;
        tcgetattr(STDIN, &term);
        term.c_lflag &= ~ICANON;
        tcsetattr(STDIN, TCSANOW, &term);
        setbuf(stdin, NULL);
        initflag = true;
    }

    int nbbytes;
    ioctl(STDIN, FIONREAD, &nbbytes);  // 0 is STDIN
    return nbbytes;
}

// main
#include <unistd.h>

int main(int argc, char** argv) {
    char c;
    //setbuf(stdout, NULL); // Optional: No buffering.
    //setbuf(stdin, NULL);  // Optional: No buffering.
    printf("Press key");
    while (!kbhit()) {
        printf(".");
        fflush(stdout);
        sleep(1);
    }
    c = getchar();
    printf("\nChar received:%c\n", c);
    printf("Done.\n");

    return 0;
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-06-26T21:53:31.480

ncurses 提供了一个很好的方法来做到这一点！这也是我的第一篇文章（我记得），所以欢迎任何评论。我会感谢有用的，但欢迎所有人！

编译： g++ -std=c++11 -pthread -lncurses .cpp -o

```
#include <iostream>
#include <ncurses.h>
#include <future>

char get_keyboard_input();

int main(int argc, char *argv[])
{
    initscr();
    raw();
    noecho();
    keypad(stdscr,true);

    auto f = std::async(std::launch::async, get_keyboard_input);
    while (f.wait_for(std::chrono::milliseconds(20)) != std::future_status::ready)
    {
        // do some work
    }

    endwin();
    std::cout << "returned: " << f.get() << std::endl;
    return 0;
}

char get_keyboard_input()
{
    char input = '0';
    while(input != 'q')
    {
        input = getch();
    }
    return input;
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-07T20:13:06.543

假设是 Windows，看一下**ReadConsoleInput**函数。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-07T20:59:51.020

C 和 C++ 对 I/O 采取了非常抽象的观点，并且没有标准的方式来做你想做的事。有标准的方法可以从标准输入流中获取字符，如果有的话，这两种语言都没有定义任何其他内容。因此，任何答案都必须是特定于平台的，可能不仅取决于操作系统，还取决于软件框架。

这里有一些合理的猜测，但是如果不知道您的目标环境是什么，就无法回答您的问题。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-08T00:44:35.857

最接近可移植的方法是使用[`ncurses`](http://www.gnu.org/software/ncurses/)库将终端置于“cbreak 模式”。API 是巨大的；你最想要的例程是

*   `initscr`和`endwin`
*   `cbreak`和`nocbreak`
*   `getch`

祝你好运！

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2021-04-10T19:29:18.890

由于此处以前的解决方案不能跨平台工作并且在使用特殊键时遇到问题，因此这是我的解决方案，它适用于 Windows 和 Linux，并且使用最少的外部库（`Windows.h`适用于 Windows 和`sys/ioctl.h`+`termios.h`用于 Linux）。

对于 ASCII 字符（换行符/制表符/空格/退格/删除，!"#$%&'()*+,-./0-9:;<=>?@AZ[]^_`az{|}~ üäÄöÖÜßµ´§°¹³²)，ASCII 代码（正数）被返回，对于特殊键（箭头键、向上/向下翻页、pos1/end、escape、insert、F1-F12），[Windows 虚拟键代码](https://docs.microsoft.com/en-us/windows/win32/inputdev/virtual-key-codes)的负数（负数）被返回。

```
#include <iostream>
#include <string>
#include <thread> // contains <chrono>
using namespace std;

void println(const string& s="") {
    cout << s << endl;
}
void sleep(const double t) {
    if(t>0.0) this_thread::sleep_for(chrono::milliseconds((int)(1E3*t+0.5)));
}

// ASCII codes (key>0): 8 backspace, 9 tab, 10 newline, 27 escape, 127 delete, !"#$%&'()*+,-./0-9:;<=>?@A-Z[]^_`a-z{|}~üäÄöÖÜßµ´§°¹³²
// control key codes (key<0): -38/-40/-37/-39 up/down/left/right arrow, -33/-34 page up/down, -36/-35 pos1/end
// other key codes (key<0): -45 insert, -144 num lock, -20 caps lock, -91 windows key, -93 kontext menu key, -112 to -123 F1 to F12
// not working: ¹ (251), num lock (-144), caps lock (-20), windows key (-91), kontext menu key (-93), F11 (-122)
#if defined(_WIN32)
#define WIN32_LEAN_AND_MEAN
#define VC_EXTRALEAN
#include <Windows.h>
int key_press() { // not working: F11 (-122, toggles fullscreen)
    KEY_EVENT_RECORD keyevent;
    INPUT_RECORD irec;
    DWORD events;
    while(true) {
        ReadConsoleInput(GetStdHandle(STD_INPUT_HANDLE), &irec, 1, &events);
        if(irec.EventType==KEY_EVENT&&((KEY_EVENT_RECORD&)irec.Event).bKeyDown) {
            keyevent = (KEY_EVENT_RECORD&)irec.Event;
            const int ca = (int)keyevent.uChar.AsciiChar;
            const int cv = (int)keyevent.wVirtualKeyCode;
            const int key = ca==0 ? -cv : ca+(ca>0?0:256);
            switch(key) {
                case  -16: continue; // disable Shift
                case  -17: continue; // disable Ctrl / AltGr
                case  -18: continue; // disable Alt / AltGr
                case -220: continue; // disable first detection of "^" key (not "^" symbol)
                case -221: continue; // disable first detection of "`" key (not "`" symbol)
                case -191: continue; // disable AltGr + "#"
                case  -52: continue; // disable AltGr + "4"
                case  -53: continue; // disable AltGr + "5"
                case  -54: continue; // disable AltGr + "6"
                case  -12: continue; // disable num block 5 with num lock deactivated
                case   13: return  10; // enter
                case  -46: return 127; // delete
                case  -49: return 251; // ¹
                case    0: continue;
                case    1: continue; // disable Ctrl + a (selects all text)
                case    2: continue; // disable Ctrl + b
                case    3: continue; // disable Ctrl + c (terminates program)
                case    4: continue; // disable Ctrl + d
                case    5: continue; // disable Ctrl + e
                case    6: continue; // disable Ctrl + f (opens search)
                case    7: continue; // disable Ctrl + g
                //case    8: continue; // disable Ctrl + h (ascii for backspace)
                //case    9: continue; // disable Ctrl + i (ascii for tab)
                case   10: continue; // disable Ctrl + j
                case   11: continue; // disable Ctrl + k
                case   12: continue; // disable Ctrl + l
                //case   13: continue; // disable Ctrl + m (breaks console, ascii for new line)
                case   14: continue; // disable Ctrl + n
                case   15: continue; // disable Ctrl + o
                case   16: continue; // disable Ctrl + p
                case   17: continue; // disable Ctrl + q
                case   18: continue; // disable Ctrl + r
                case   19: continue; // disable Ctrl + s
                case   20: continue; // disable Ctrl + t
                case   21: continue; // disable Ctrl + u
                case   22: continue; // disable Ctrl + v (inserts clipboard)
                case   23: continue; // disable Ctrl + w
                case   24: continue; // disable Ctrl + x
                case   25: continue; // disable Ctrl + y
                case   26: continue; // disable Ctrl + z
                default: return key; // any other ASCII/virtual character
            }
        }
    }
}
#elif defined(__linux__)
#include <sys/ioctl.h>
#include <termios.h>
int key_press() { // not working: ¹ (251), num lock (-144), caps lock (-20), windows key (-91), kontext menu key (-93)
    struct termios term;
    tcgetattr(0, &term);
    while(true) {
        term.c_lflag &= ~(ICANON|ECHO); // turn off line buffering and echoing
        tcsetattr(0, TCSANOW, &term);
        int nbbytes;
        ioctl(0, FIONREAD, &nbbytes); // 0 is STDIN
        while(!nbbytes) {
            sleep(0.01);
            fflush(stdout);
            ioctl(0, FIONREAD, &nbbytes); // 0 is STDIN
        }
        int key = (int)getchar();
        if(key==27||key==194||key==195) { // escape, 194/195 is escape for °ß´äöüÄÖÜ
            key = (int)getchar();
            if(key==91) { // [ following escape
                key = (int)getchar(); // get code of next char after \e[
                if(key==49) { // F5-F8
                    key = 62+(int)getchar(); // 53, 55-57
                    if(key==115) key++; // F5 code is too low by 1
                    getchar(); // take in following ~ (126), but discard code
                } else if(key==50) { // insert or F9-F12
                    key = (int)getchar();
                    if(key==126) { // insert
                        key = 45;
                    } else { // F9-F12
                        key += 71; // 48, 49, 51, 52
                        if(key<121) key++; // F11 and F12 are too low by 1
                        getchar(); // take in following ~ (126), but discard code
                    }
                } else if(key==51||key==53||key==54) { // delete, page up/down
                    getchar(); // take in following ~ (126), but discard code
                }
            } else if(key==79) { // F1-F4
                key = 32+(int)getchar(); // 80-83
            }
            key = -key; // use negative numbers for escaped keys
        }
        term.c_lflag |= (ICANON|ECHO); // turn on line buffering and echoing
        tcsetattr(0, TCSANOW, &term);
        switch(key) {
            case  127: return   8; // backspace
            case  -27: return  27; // escape
            case  -51: return 127; // delete
            case -164: return 132; // ä
            case -182: return 148; // ö
            case -188: return 129; // ü
            case -132: return 142; // Ä
            case -150: return 153; // Ö
            case -156: return 154; // Ü
            case -159: return 225; // ß
            case -181: return 230; // µ
            case -167: return 245; // §
            case -176: return 248; // °
            case -178: return 253; // ²
            case -179: return 252; // ³
            case -180: return 239; // ´
            case  -65: return -38; // up arrow
            case  -66: return -40; // down arrow
            case  -68: return -37; // left arrow
            case  -67: return -39; // right arrow
            case  -53: return -33; // page up
            case  -54: return -34; // page down
            case  -72: return -36; // pos1
            case  -70: return -35; // end
            case    0: continue;
            case    1: continue; // disable Ctrl + a
            case    2: continue; // disable Ctrl + b
            case    3: continue; // disable Ctrl + c (terminates program)
            case    4: continue; // disable Ctrl + d
            case    5: continue; // disable Ctrl + e
            case    6: continue; // disable Ctrl + f
            case    7: continue; // disable Ctrl + g
            case    8: continue; // disable Ctrl + h
            //case    9: continue; // disable Ctrl + i (ascii for tab)
            //case   10: continue; // disable Ctrl + j (ascii for new line)
            case   11: continue; // disable Ctrl + k
            case   12: continue; // disable Ctrl + l
            case   13: continue; // disable Ctrl + m
            case   14: continue; // disable Ctrl + n
            case   15: continue; // disable Ctrl + o
            case   16: continue; // disable Ctrl + p
            case   17: continue; // disable Ctrl + q
            case   18: continue; // disable Ctrl + r
            case   19: continue; // disable Ctrl + s
            case   20: continue; // disable Ctrl + t
            case   21: continue; // disable Ctrl + u
            case   22: continue; // disable Ctrl + v
            case   23: continue; // disable Ctrl + w
            case   24: continue; // disable Ctrl + x
            case   25: continue; // disable Ctrl + y
            case   26: continue; // disable Ctrl + z (terminates program)
            default: return key; // any other ASCII character
        }
    }
}
#endif // Windows/Linux 
```

最后，这是一个关于如何使用它的示例：

```
int main() {
    while(true) {
        const int key = key_press(); // blocks until a key is pressed
        println("Input is: "+to_string(key)+", \""+(char)key+"\"");
    }
    return 0;
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2015-02-19T19:10:25.750

我一直想要一个循环来读取我的输入而不按回车键。这对我有用。

```
#include<stdio.h>
 main()
 {
   char ch;
    system("stty raw");//seting the terminal in raw mode
    while(1)
     {
     ch=getchar();
      if(ch=='~'){          //terminate or come out of raw mode on "~" pressed
      system("stty cooked");
     //while(1);//you may still run the code 
     exit(0); //or terminate
     }
       printf("you pressed %c\n ",ch);  //write rest code here
      }

    } 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-08T09:04:38.123

以下是从*Expert C Programming: Deep Secrets*中提取的解决方案，它应该适用于 SVr4。它使用*stty*和*ioctl*。

```
#include <sys/filio.h>
int kbhit()
{
 int i;
 ioctl(0, FIONREAD, &i);
 return i; /* return a count of chars available to read */
}
main()
{
 int i = 0;
 intc='';
 system("stty raw -echo");
 printf("enter 'q' to quit \n");
 for (;c!='q';i++) {
    if (kbhit()) {
        c=getchar();
       printf("\n got %c, on iteration %d",c, i);
    }
}
 system("stty cooked echo");
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-06-12T06:40:51.317

在 Windows 上为我工作：

```
#include <conio.h>
char c = _getch(); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-08-28T22:38:51.747

您可以使用 SDL（简单 DirectMedia 库）以可移植的方式完成此操作，但我怀疑您可能不喜欢它的行为。当我尝试它时，我必须让 SDL 创建一个新的视频窗口（即使我的程序不需要它）并让这个窗口“抓取”几乎所有的键盘和鼠标输入（这对我的使用来说还可以，但可以在其他情况下令人讨厌或不可行）。我怀疑这是矫枉过正，不值得，除非完全可移植性是必须的 - 否则尝试其他建议的解决方案之一。

顺便说一句，如果您对此感兴趣，这将为您分别提供按键和释放事件。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-05-03T03:11:39.433

[ssinfod 对 Linux 的回答](https://stackoverflow.com/a/33201364/1599699)的变体，对我的口味来说更干净一些，为`wcout`and实现了`wchar_t`，并且删除了没有错误的无效字符。

```
#include <functional>

//For Linux kbhit(). For Windows, use conio.h.
#ifdef __unix__
  #include <sys/ioctl.h> //For FIONREAD.
  #include <termios.h>

  //Call this at program start to setup for kbhit.
  void initTerminalInput()
  {
    //Disable internal buffering.
    std::wcout << std::unitbuf;

    //Turn off line buffering.
    struct termios term;
    tcgetattr(0, &term);
    term.c_lflag &= ~ICANON;
    tcsetattr(0, TCSANOW, &term);
    setbuf(stdin, NULL);
  }

  //Returns 0 if there's no input character to read.
  int kbhit()
  {
    static int nbbytes;
    ioctl(0, FIONREAD, &nbbytes);
    return nbbytes;
  }
#endif

//Waits for and retrieves a single validated character, calling a validation function on each character entered and
//erasing any that are invalid (when the validation function returns false).
static wchar_t getWChar(std::function<bool(wchar_t)> validationFunction)
{
  static wchar_t inputWChar;
  do
  {
    //Wait until there's an input character.
    while (!kbhit())
    {
    }
    inputWChar = getwchar();
    //Validate the input character.
    if (validationFunction(inputWChar))
    {
      //Valid.
      break;
    }
    else
    {
      //Erase the invalid character.
      std::wcout << L"\b \b";
    }
  } while (true);
  return inputWChar;
} 
```

在下面的示例中，我希望用户输入 1、2 或 3。输入的任何其他字符都不会显示，它会等到按下有效字符之一：

```
int main()
{
  #ifdef __unix__
    initTerminalInput();
  #endif

  getWChar([] (wchar_t inputWChar)
  {
    return (inputWChar >= L'1' && inputWChar <= L'3');
  });

  return 0;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-03-13T10:41:36.957

这是一个不支持系统的版本（在 macOS 10.14 上编写和测试）

```
#include <unistd.h>
#include <termios.h>
#include <stdio.h>
#include <string.h>

char* getStr( char* buffer , int maxRead ) {
  int  numRead  = 0;
  char ch;

  struct termios old = {0};
  struct termios new = {0};
  if( tcgetattr( 0 , &old ) < 0 )        perror( "tcgetattr() old settings" );
  if( tcgetattr( 0 , &new ) < 0 )        perror( "tcgetaart() new settings" );
  cfmakeraw( &new );
  if( tcsetattr( 0 , TCSADRAIN , &new ) < 0 ) perror( "tcssetattr makeraw new" );

  for( int i = 0 ; i < maxRead ; i++)  {
    ch = getchar();
    switch( ch )  {
      case EOF: 
      case '\n':
      case '\r':
        goto exit_getStr;
        break;

      default:
        printf( "%1c" , ch );
        buffer[ numRead++ ] = ch;
        if( numRead >= maxRead )  {
          goto exit_getStr;
        }
        break;
    }
  }

exit_getStr:
  if( tcsetattr( 0 , TCSADRAIN , &old) < 0)   perror ("tcsetattr reset to old" );
  printf( "\n" );   
  return buffer;
}

int main( void ) 
{
  const int maxChars = 20;
  char      stringBuffer[ maxChars+1 ];
  memset(   stringBuffer , 0 , maxChars+1 ); // initialize to 0

  printf( "enter a string: ");
  getStr( stringBuffer , maxChars );
  printf( "you entered: [%s]\n" , stringBuffer );
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-01-13T16:57:54.537

**在 WINDOWS**上我这样做：

```
#include <Windows.h>
int main()
{
    system("PAUSE>NUL");
    if (GetKeyState(0x41/*(the 'A' key, choosen e.g.)*/) & (0xff80/*That stands for "Default state / Key Down"*/)) {
        //whatever I want to do after 'A' is pressed
    }
} 
```

在这里可以找到一个键列表，每个键都有自己的十六进制值： [https ://docs.microsoft.com/en-us/windows/win32/inputdev/virtual-key-codes](https://docs.microsoft.com/en-us/windows/win32/inputdev/virtual-key-codes)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2022-02-03T23:39:31.747

> 理想情况下，它不会将输入字符回显到屏幕上。我只想在不影响控制台屏幕的情况下捕获击键。

要**在 Linux 上**执行此操作，您可以使用以下*bash 命令*：

```
read -sn1 c && printf "You Pressed: %s\n" "$c" 
```

有关详细信息，请参见我的答案：[shell script respond to keypress](https://stackoverflow.com/a/70979348/4561887)。

因此，要在 Linux 上使用 C 或 C++ 执行此操作，您只需通过管道*系统调用*`popen()`调用上述 bash 命令，`fgets()`这样您就可以读取 bash 命令的输出。

这是一个在 C 和 C++ 的 Linux 上运行良好的完整示例：

**read_keypress_system_call.c：**

```
#include <stdbool.h> // For `true` (`1`) and `false` (`0`) macros in C
#include <stdint.h>  // For `uint8_t`, `int8_t`, etc.
#include <stdio.h>   // For `printf()`
#include <stdlib.h>

#define BUFSIZE 32

// Read a keyboard key press and return the character pressed, or a negative
// number in the event of an error.
// NB: for help reading output from system calls, see here:
//  1\. https://stackoverflow.com/a/28971647/4561887
//  2\. https://stackoverflow.com/a/18297075/4561887
char getKeypress()
{
    // This bash cmd is from my answer here:
    // https://stackoverflow.com/a/70979348/4561887
    const char* cmd = "bash -c 'read -s -n1 c && printf \"%s\" \"$c\"'";
    FILE *fp = popen(cmd, "r");
    if (fp == NULL)
    {
        printf("\nError opening pipe!\n");
        return -1;
    }

    char buf[BUFSIZE] = {0};
    char* retval1 = fgets(buf, BUFSIZE, fp);
    if (retval1 == NULL)
    {
        printf("\nFailed to read cmd response.\n");
        return -2;
    }

    // See meaning of this return value here:
    // https://stackoverflow.com/questions/43116/how-can-i-run-an-external-program-from-c-and-parse-its-output/28971647#comment60311936_28971647
    int retval2 = pclose(fp);
    if (retval2 == -1)
    {
        printf("\nError obtaining the cmd's exit status code.\n");
        return -3;
    }
    else if (retval2 != 0)
    {
        printf("\nCommand exited with exit status code %i.\n", retval2);
        return -4;
    }

    char keyPressed = buf[0];
    return keyPressed;
}

// int main(int argc, char *argv[])  // alternative prototype
int main()
{
    printf("Press any key to continue: ");
    fflush(stdout);
    char keyPressed = getKeypress();
    if (keyPressed > 0)
    {
        printf("\nKey pressed = %c\n", keyPressed);
    }

    return 0;
} 
```

C 和 C++ 编译和运行命令是下面输出的一部分。以下是一些演示：

在 C 中：

```
eRCaGuy_hello_world/c$ gcc -Wall -Wextra -Werror -O3 -std=gnu17 read_keypress_system_call.c -o bin/a && bin/a
Press any key to continue:
Key pressed = P 
```

或者，在 C++ 中：

```
eRCaGuy_hello_world/c$ g++ -Wall -Wextra -Werror -O3 -std=c++17 read_keypress_system_call.c -o bin/a && bin/a
Press any key to continue:
Key pressed = u 
```

## 也可以看看：

1.  要更进一步，请在此处查看我的另一个答案，其中我一次检测并解析 3 个字符，以检测箭头键按下、、、或`Up`：读取C [ex 中的按键。](https://stackoverflow.com/a/70980046/4561887)[方向键、回车键](https://stackoverflow.com/a/70980046/4561887)`Down``Left``Right`

## 参考：

1.  我如何学会从管道中读取以获取系统调用输出：
    1.  [如何从 C 运行外部程序并解析其输出？](https://stackoverflow.com/a/28971647/4561887)
    2.  [有没有办法使用 C 程序在 .txt 文件上获取 linux 命令（如 ifconfig）的输出？[复制]](https://stackoverflow.com/a/18297075/4561887)
    3.  如何`popen()`在 C 中编译和使用：[即使添加了#include <stdio.h>，也隐式声明](https://stackoverflow.com/a/41406311/4561887)`-std=gnu17`了使用而不是`-std=c17`： popen
2.  [我的回答] 如何通过 bash 不阻塞地阅读：[shell 脚本响应按键](https://stackoverflow.com/a/70979348/4561887)
3.  [我的回答][如何在 C 中将 Enter 键作为输入读取？](https://stackoverflow.com/a/70978704/4561887)

## 关于此主题的所有 3 个问答

1.  [从标准输入中捕获字符而无需等待按下回车键](https://stackoverflow.com/q/421860/4561887)
2.  [C 非阻塞键盘输入](https://stackoverflow.com/q/448944/4561887)
3.  [如何避免使用 getchar() 按 Enter 键仅读取单个字符？](https://stackoverflow.com/q/1798511/4561887)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2022-02-09T23:06:47.887

我遇到了同样的问题。这是一个使用 cygwin g++ 和`if(GetKeyState(keycode) & bitANDcompare){};`.

```
#include <windows.h>
#include <fstream>
#include <iostream>

using namespace std;
void clear() {
    COORD topLeft  = { 0, 0 };
    HANDLE console = GetStdHandle(STD_OUTPUT_HANDLE);
    CONSOLE_SCREEN_BUFFER_INFO screen;
    DWORD written;

    GetConsoleScreenBufferInfo(console, &screen);
    FillConsoleOutputCharacterA(
        console, ' ', screen.dwSize.X * screen.dwSize.Y, topLeft, &written
    );
    FillConsoleOutputAttribute(
        console, FOREGROUND_GREEN | FOREGROUND_RED | FOREGROUND_BLUE,
        screen.dwSize.X * screen.dwSize.Y, topLeft, &written
    );
    SetConsoleCursorPosition(console, topLeft);
}

class Keyclick{
    private:
    int key;
    char id;
    public:
    bool keydown = false;
    Keyclick(int key1, char id1){
        key=key1;
        id=id1;
    };
    void watch(){
        if(keydown==false){
            if(GetKeyState(key) & 0x8000 ){
                cout << id;
                cout << "  pressed.\r\n";
                keydown = true;
            }
        }
        if(keydown == true){
            if(!(GetKeyState(key) & 0x8000)) {
                cout << "released!!!!!!!!!!\r\n";
                keydown = false;
                clear();
            }
        }
    };
};

int main()
{
    bool primaryloop =true;
    Keyclick keysp(VK_SPACE,'S');
    Keyclick keyw(0x57,'w');
    Keyclick keya(0x41,'a');
    Keyclick keys(0x53,'s');
    Keyclick keyd(0x44,'d');
    Keyclick keyesc(VK_ESCAPE,'E');

    while(primaryloop){
        keysp.watch();
        keyw.watch();
        keya.watch();
        keys.watch();
        keyd.watch();
        keyesc.watch();

        if(keyesc.keydown){
            primaryloop=false;
        };      
    }
    return 0;
} 
```

[https://github.com/wark77/windows_console_keypoller/blob/main/getkeystate_SOLUTION01.cpp](https://github.com/wark77/windows_console_keypoller/blob/main/getkeystate_SOLUTION01.cpp)

# matlab - matlab变量中的函数名和参数

> ID：421873
> 
> 赞同：0
> 
> 时间：2009-01-07T20:09:10.717
> 
> 标签：matlab, eval

在我的 matlab m 文件中，我使用一些逻辑（字符串 concat）来构建如下变量：

```
c = 'CalcPrediction(1,10)' 
```

这意味着我有一个字符串，它是一个函数和一些参数。我该怎么做那个函数调用？

尝试 run(c) 会导致：

```
>> run(c)
??? Error using ==> run at 71
CalcPrediction(1,10) not found. 
```

注意：如果没有参数，run(c) 可以正常工作。例如 c='CalcPrediction'; 运行（c）；

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T20:49:41.633

您正在寻找的命令`eval()`是`run()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T21:32:38.973

如果没有真正看到脚本，很难概括，但是......

其中 squareRoot 是一个 m 文件，仅包含：`y=sqrt(x)`

然后执行：

`x=[2,0];`

`c='squareRoot';`

`run(c);`

给出：

`y =`

`1.4142 0`

这个例子是说您可以定义脚本以使用声明的变量（`x`在这种情况下），然后在运行脚本之前声明变量。

没有脚本，我不知道你在用参数做什么。如果这不能回答您的问题，请发布您的脚本。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-07T20:47:17.067

你想使用[str2func](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/ref/str2func.html)。此函数接受一个字符串并返回一个可以使用您的参数调用的函数处理程序。查看链接页面上的示例。

```
fh = str2func('CalcPrediction')
fh(1, 10) 
```

# sql-server-2008 - 为 Web 应用程序调整 SQL Server 2008

> ID：421874
> 
> 赞同：2
> 
> 时间：2009-01-07T20:09:21.030
> 
> 标签：sql-server-2008, locking, isolation-level, read-committed-snapshot

在其中一个 Stackoverflow 播客中，我记得 Jeff Atwood 说过 SQL Server 2008 中有一个配置选项可以减少锁定，并且是在所有查询中使用“with (nolock)”的一种替代方法。有谁知道如何启用他所说的功能，甚至可能是 Jeff 本人。我正在考虑部署 SQL Server 2008，并想看看使用这样的功能是否有助于我的 Web 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T20:28:37.637

Jeff 在谈论快照隔离

这是命令

```
ALTER DATABASE MyDatabase
SET ALLOW_SNAPSHOT_ISOLATION ON

ALTER DATABASE MyDatabase
SET READ_COMMITTED_SNAPSHOT ON 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T20:29:29.210

您正在寻找的是使用 READ COMMITTED 并将 READ_COMMITTED_SNAPSHOT 数据库选项设置为 ON。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T20:29:29.693

我不认为这是特定于 SQL 2008 的，而是[SQL 2005](http://www.codinghorror.com/blog/archives/001166.html)。他们在升级时确实有一些 DBA 帮助，不过您可以阅读 Brents 的[博客](http://www.brentozar.com/archive/2008/10/sql-2008-upgrade-tuning-for-stackoverflowcom/)条目或[Jeffs](https://blog.stackoverflow.com/2008/10/adde-a-second-server/)

# sql - postgresql 中的长更新

> ID：421878
> 
> 赞同：7
> 
> 时间：2009-01-07T20:09:55.740
> 
> 标签：sql, postgresql, sql-update

我一直在对包含 3 个索引的 2.5 亿行的表运行更新；此 UPDATE 使用另一个包含 3000 万行的表。它已经运行了大约 36 个小时。我想知道他们是否是一种了解它距离完成有多近的方法，如果它计划花费一百万天来完成它，我会杀了它；但是，如果它只需要一两天，我会让它运行。这是命令查询：

```
UPDATE pagelinks SET pl_to = page_id
    FROM page
    WHERE 
        (pl_namespace, pl_title) = (page_namespace, page_title)
        AND
        page_is_redirect = 0
; 
```

EXPLAIN 不是这里的问题，我只提到大表有多个索引，以便在某种程度上证明更新它需要多长时间。但无论如何，这里是解释：

```
Merge Join  (cost=127710692.21..135714045.43 rows=452882848 width=57)
  Merge Cond: (("outer".page_namespace = "inner".pl_namespace) AND ("outer"."?column4?" = "inner"."?column5?"))
  ->  Sort  (cost=3193335.39..3219544.38 rows=10483593 width=41)
        Sort Key: page.page_namespace, (page.page_title)::text
        ->  Seq Scan on page  (cost=0.00..439678.01 rows=10483593 width=41)
              Filter: (page_is_redirect = 0::numeric)
  ->  Sort  (cost=124517356.82..125285665.74 rows=307323566 width=46)
        Sort Key: pagelinks.pl_namespace, (pagelinks.pl_title)::text"
        ->  Seq Scan on pagelinks  (cost=0.00..6169460.66 rows=307323566 width=46) 
```

现在我还发送了一个并行查询命令，以删除*页面链接的*索引之一；当然它正在等待更新完成（但我还是想尝试一下！）。因此，我不能从*页面链接*中选择任何内容，因为害怕破坏数据（除非您认为终止 DROP INDEX postmaster 进程是安全的？）。

所以我想知道他们是否是一个可以跟踪死元组数量的表或其他东西。很高兴知道 UPDATE 在完成其任务时有多快或多远。

Thx（PostgreSQL 没有我想象的那么智能；它需要启发式）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-09T18:55:32.527

[您是否阅读了“使用](http://www.postgresql.org/docs/8.3/static/using-explain.html)说明”的 PostgreSQL 文档来解释您显示的输出？

我不是普通的 PostgreSQL 用户，但我只是阅读了该文档，然后与`EXPLAIN`您显示的输出进行了比较。您的`UPDATE`查询似乎没有使用索引，并且它被迫进行表扫描以对`page`和进行排序`pagelinks`。毫无疑问，该排序足够大，需要临时磁盘文件，我认为这些文件是在您的`temp_tablespace`.

然后我看到估计读取的数据库页面。`EXPLAIN`该输出的顶层显示`(cost=127710692.21..135714045.43)`. 这里的单元在磁盘 I/O 访问中。因此，它将访问磁盘超过 1.35 亿次来执行此操作`UPDATE`。

请注意，即使是 10,000rpm 的磁盘，寻道时间为 5 毫秒，在最佳条件下也最多可以达到每秒 200 次 I/O 操作。这意味着您`UPDATE`将需要 188 小时（7.8 天）的磁盘 I/O，即使您可以在此期间维持饱和的磁盘 I/O（即连续读取/写入没有中断）。这是不可能的，而且我预计实际吞吐量至少会下降一个数量级，尤其是因为您毫无疑问同时在使用此服务器进行各种其他工作。所以我猜你只是通过你的`UPDATE`.

如果是我，我会在第一天杀死这个查询，然后找到另一种`UPDATE`更好地利用索引并且不需要磁盘排序的方法。您可能无法在单个 SQL 语句中执行此操作。

至于你的`DROP INDEX`，我猜它只是阻塞，等待对表的独占访问，当它处于这种状态时，我认为你可能会杀死它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-09-20T11:09:59.547

这已经很老了，但是如果您想要一种方法来监视您的更新...请记住，序列会受到全局影响，因此您只需创建一个以在另一个会话中监视此更新，只需执行以下操作：

```
create sequence yourprogress; 

UPDATE pagelinks SET pl_to = page_id
    FROM page
    WHERE 
        (pl_namespace, pl_title) = (page_namespace, page_title)
        AND
        page_is_redirect = 0 AND NEXTVAL('yourprogress')!=0; 
```

然后在另一个会话中执行此操作（不要担心事务，因为序列会受到全局影响）：

```
select last_value from yourprogress; 
```

这将显示有多少行受到影响，因此您可以估计需要多长时间。

在刚刚结束时重新启动您的序列以再次尝试：

```
alter sequence yourprogress restart with 1; 
```

或者干脆放弃它：

```
drop sequence yourprogress; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T19:13:19.900

您需要索引，或者正如比尔指出的那样，它需要对所有表进行顺序扫描。

```
CREATE INDEX page_ns_title_idx on page(page_namespace, page_title);
CREATE INDEX pl_ns_title_idx on pagelink(pl_namespace, pl_title);
CREATE INDEX page_redir_idx on page(page_is_redirect); 
```

# svn - 您是否将构建工具保留在版本控制中？

> ID：421880
> 
> 赞同：19
> 
> 时间：2009-01-07T20:10:30.480
> 
> 标签：svn, version-control

您是否将构建项目所需的工具置于版本控制之下？

如果您这样做，您对包含哪些工具的指导方针是什么？我猜没有人将 Visual Studio 置于版本控制中，但你的单元测试运行器呢？Nant/Ant/Maven 可执行文件？

外部依赖如何？你在版本控制中有 Boost 吗？JDK？NUnit/JUnit？你在这里画的极限在哪里？

（另见[这个问题](https://stackoverflow.com/questions/191533/svn-and-binaries)）。

**编辑：** 我想我的问题并不完全清楚：我不想知道您是否将它们保存在版本控制与某些共享驱动器中。我真的很想知道您是否将构建项目所需的工具与项目*一起*检查到版本控制中，这样当您检查项目时，您会自动获得这些工具。

作为对那些回答“否”的人的一般后续行动：您跟踪这些工具的过程是什么？你的脚本会下载它们吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-07T20:18:33.443

是的，我保留了在版本控制中交付软件产品过程中的所有内容。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-07T20:30:38.770

对此有两种思想流派：

1.  **仅**将您的源代码放入存储库。
2.  将人们构建您的软件所需的一切都放入存储库中，而不是操作系统和语言运行时。

我个人更倾向于＃2，因为它使某人更容易启动和运行我的代码。无论如何，我认为如果您选择第一种方法，您至少应该这样做，以便人们可以一步*获得*第 2 点和您的源代码所需的东西，即使不一定通过版本控制。

不幸的是，构建系统有点像灰色地带。我个人将它排除在外，除非我使用的是晦涩或非标准的东西。什么是晦涩的和非标准的取决于你工作的环境。例如，如果你的公司总是使用 MSBuild，但出于任何原因决定在这个项目中使用 Nant，那么我会包括它。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-07T20:16:13.107

我将构建**脚本**置于版本控制之下，而不是工具。通常，我版本的文件要么是应用程序核心的一部分，要么可能在项目的生命周期内频繁更改（并且每个人都需要访问这些更改）。这包括几乎所有的配置文件。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-07T20:34:07.360

我通常在 java 项目中使用 eclipse/ant。不，我不会将 JDK、Ant 或 eclipse 置于版本控制之下，但是：

*   我所有的来源
*   构建脚本
*   所有 3rd 方库都在他们使用的版本中（是的，还有 junit）

原因：我有一个几乎独立的构建系统，任何安装了 jdk 和 ant 的系统都可以构建，无需网络连接（也签入了外部 javadoc 的包列表）。这可以是我的 macbook、公司的 windows 桌面、任何连续的构建服务器。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-07T20:45:26.820

我们使用[maven](http://maven.apache.org)，所以我们只签入代码、测试、配置文件，当然还有 pom.xml，没有库，没有工具。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-07T20:23:54.540

我将 makefile、shell 脚本和我编写的任何代码生成器放入版本控制中。我不会将二进制文件存储在版本控制中，除非存在无法从源代码轻松构建的库。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-07T20:14:07.273

通常，我只会将可能由我自己或与我一起工作的其他人维护的项目添加到版本控制中。外部库通常由项目使用——大多数不在业务中的项目都在重写它们所依赖的库。

我建议将您***自定义***的工具添加到版本控制中。对于其他所有内容，您只需将包保存在一个公共位置即可。无需使用永远不会从标准发行版更改的代码来膨胀您的存储库。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-07T20:17:34.100

我们不会将来自外部的工具（Visual Studio、Eclipse、CDT-Plugin...）放入 SVN 中。

但是我们有一大套自写的工具（代码生成器、VS 的自定义构建组件和一个 Eclipse 插件），我们将源代码和二进制文件放入 SVN。

做出这个决定的原因很简单：

*   我们的工具非常小，不需要显式的设置程序来运行（所以一个简单的 svn checkout 就可以为您提供一套正在运行的工具）
*   我们的工具比第 3 方工具更频繁地更改（因此我们不需要告诉我们的开发人员每月更新工具 3 次）

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-07T20:33:05.613

是的！是我的答案。

我将 NUnit 和 NAnt 等构建工具放入版本控制中。

我的主要规则是：

*   构建服务器必须能够构建解决方案。

而且我使用的构建服务器没有安装 NUnit、NAnt 等。

构建服务器拥有 .NET 框架和 CruiseControl.NET，仅此而已......

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-07T20:36:52.160

我们走了一条不同的路径来设置我们在其上进行发布构建的 VM。然后将其存档（但由于某种原因没有进入修订控制系统）。

只要我们有一台可以托管 VM 的机器，我们就可以重新创建二进制文件。使我们独立于底层操作系统。

让许可管理器启动并运行有一些问题，但在那之后一切都很好。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-07T20:31:14.150

不，大多数开发商店都有一套相当标准的工具。不过，一个想法是保留一个标准的“快速设置”wiki 或类似的，为所有需要的构建工具提供安装程序的深层链接。编写它，以便经验相对较少的人可以轻松设置开发机器。更高级的选择是保留一个包含所有内容的标准虚拟硬盘。

我们这样做，但是将所有其他内容保留在源代码控制中 - 所有构建脚本、SQL 脚本、文件依赖项（即未安装在 GAC 或程序文件中的引用的 dll）等。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-07T22:02:56.277

我们是一家 Maven 商店，之前是一家 ANT 商店。在 ANT 时代，我们会将依赖库检查到项目结构中。现在我们只检查构建应用程序所需的资源（pom、源代码、资源等），但绝对没有库。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-08T14:32:39.023

我们保留 2 个存储库：“快速移动的”包含我们的代码，以及用于发布和补丁的分支。

缓慢移动的包含 3rd 方库和工具，包括 JDK 版本。其中大部分没有分支或标记，因为另一个中的代码知道如何选择它需要的内容。同一库的两个版本以不同的名称签入，因此在签出后两者都将可用。我们自己的一些交叉发布工具也包含在这个存储库中。IDE 不包括在内，因为它们不是官方构建过程的一部分。

将工具存储在某种存储库中有两个原因：

1.  任何开发人员都可以轻松找到他们需要的工具。
2.  可以创建过去任何官方构建的副本，以便生成补丁。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-06-23T07:14:29.417

我对所有“不，我不这样做”的回答感到非常惊讶。除非您拥有编写代码所针对的特定版本的依赖项，否则您无法可靠地构建代码库。因此，这将包括您引用的任何 DLL，例如单元测试和模拟框架、UI 控件集等。

开发人员应该能够通过几个步骤进行结帐和构建。有些地方需要一整天。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-07T20:16:34.727

我们没有——事实上，我从来没有为这样的地方工作过。

我们确实在源代码控制中保留了 Makefile 和构建脚本和测试脚本之类的东西，但从来没有 ant 或 C 编译器之类的东西。

原因是，要让构建工具进入可用状态，通常需要的不仅仅是简单的检查，而且您需要做一些繁重的系统管理员工作来同时维护多个版本或在版本之间切换。因此，将它们保留在源代码控制中将解决问题的一小部分。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-07T20:35:42.397

不是工具，而是脚本。我们使用[Ant](http://ant.apache.org/)。驱动该过程的 build.xml 脚本受源代码控制。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-07T20:56:15.473

就个人而言，我更喜欢将尽可能多的构建工具放在存储库中，但我在 IDE 和编译器上划清界限。

我喜欢将其视为一种权衡：我可以选择：

*   记录必要的工具（包括维护该文档），并且每次我需要回到项目时都必须安装它们（并乘以项目中每个额外的开发人员）
*   将工具放入存储库中，以便使用正确的版本自动检出它们。

对于 IDE 之类的东西，只记录它更容易，而且大多数开发人员已经安装了它。对于 Ant、Nant、JUnit 等，将其包含在存储库中更容易。

我特别喜欢在存储库中使用 Ant/Nant，因为它允许我包含这样的 go.bat/go.sh-script：

```
set ANT_HOME=tools/apache-ant-x.x.x
tools/apache-ant-x.x.x %* 
```

然后我总是可以签出一个项目，运行“go”，它应该构建项目（假设我安装了 JDK/.Net 框架）。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-07T22:57:55.370

编码、构建、测试、文档和任何其他自动化。我通常什至将时间表和任何其他与项目相关的文档也放在存储库中。

对于大多数项目，如果我有依赖库的源代码，我通常会将它们放在自己的存储库中，这样我就可以随着时间的推移跟踪它们的变化。

至于可安装包中的预打包工具，我将它们全部保存在可访问服务器上的一个大目录树中（使用旧版本）。这样，我可以将任何新开发人员指向目录并告诉他们要安装什么（并且知道他们与团队的其他成员具有相同的版本）。我会使用存储库，但这有点过头了，而且共享文件系统更容易被每个人访问。保留旧版本以防出现支持问题。

保罗。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-08T00:18:25.347

进入我们的存储库的内容：

*   我写的任何代码或我的任何学生写的

*   所有 Makefile、测试脚本和类似的东西

*   我们修改的外部工具（我们通常放入整个工具，而不仅仅是补丁），包括 Andrew Hume 的 Make 版本

什么不进去：

*   我们正在使用的所有编译器的源代码

*   外壳的来源

如果我们有更好的工具，我们会将其*全部*放入存储库中。有关如何做到这一点并跟踪自一开始以来所有版本的好书，请查看有关 Digital SRC [Vesta 项目](http://books.google.com/books?id=eIcAtrxitvEC&dq=vesta+levin&printsec=frontcover&source=bl&ots=s5f-GSv4fc&sig=9SRLLRgrpFnYf4bY-v2Np-7PM0w&hl=en&sa=X&oi=book_result&resnum=4&ct=result)的书。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-12-10T14:08:54.803

不，绝对不是。绝不。您的 VCS 应该只存放您的代码。如果你想确保有人可以快速安装你的代码，你需要提供一个分发系统。希望安装您的代码的人应该使用打包的二进制发行版或从源代码 tarball 构建。他们不应该从 VCS 构建。分发 tarball 是放置项目构建所必需的东西的地方，这些东西要么是自动生成的，要么不是你项目的直接部分。然而，它不是依赖的地方。如果您的项目需要 boost 库，则应在文档中将其声明为依赖项，如果未安装，您的构建将失败。从源 tarball 构建的用户应该能够安装依赖项。从打包的二进制发行版构建的用户期望包系统处理依赖问题。从 VCS 构建的用户（即开发人员）需要安装项目所需的构建工具。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2012-03-22T10:09:41.957

我尝试始终使用虚拟机作为构建系统。
并为每个项目存储这些（在最好的情况下）。

将 tarball 或存储库与所有工具一起使用的主要问题：
安装它们需要花费太多时间，然后在几年后再次运行时总是会遇到问题。

也可以通过脚本下载或仅告诉网络源在几年后不稳定，您将获得一些具有其他功能和错误的更新版本。

有时根本无法在较新的操作系统版本上安装构建系统。
或者某些工具的较新版本（如 Visual Studio 2025）将使用其他项目文件并且“完全向上兼容”失败。

几年后许可证也有问题，您能在合理的时间内获得新的激活密钥吗？公司还支持吗？

虚拟机只包含所有必要的已安装工具，并在几分钟后运行。
很好，特别是如果我只想更改几行代码。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-07T20:20:19.133

不，我不这样做，因为我使用 MsBuild，无论如何它都是 .NET 框架的一部分

# vb.net - vb.net 中的 DataGridView、BindingSource 和排序

> ID：421887
> 
> 赞同：1
> 
> 时间：2009-01-07T20:11:52.537
> 
> 标签：vb.net, data-binding, ado.net, datagridview, bindingsource

我正在模拟 VB.Net 中旧应用程序的功能。我的表单上有一个绑定到 BindingSource 的 DataGridView。我在工具栏上有一个按钮，它启动了一个排序对话框。排序对话框最多允许按 3 列排序。

所以我正在从对话框的结果中构建一个字符串，并用它设置 BindingSource.Sort 属性。但这不会更新我的 DataGridView。我错过了一步 - 我需要告诉一些东西来刷新吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T20:34:15.317

我只是用一个简单的测试应用程序尝试了这个，它排序而无需调用任何刷新。你能发布一些代码吗？你确定你正确地建立了排序字符串吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T20:17:30.310

您是否必须调用 DataGridView.DataBind() 方法？

我已经习惯了 ASP.NET，以至于忘记了 WinForms 的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T20:20:31.707

什么是底层对象，它是否支持排序？您可以通过 .SupportsSorting 属性 (iirc) 进行检查。如果它是一个 DataTable 那么你应该没问题。

您是否尝试过将排序直接应用于网格？

您可以在更新排序属性后尝试调用**BindingSource.ResetBindings(false)**，只是为了安全起见，但您不必这样做。

# spring - 如何在 Spring + JSP 中创建超链接

> ID：421891
> 
> 赞同：5
> 
> 时间：2009-01-07T20:12:27.653
> 
> 标签：spring, jsp, jstl

在 Spring + JSP 中创建超链接的正确方法是什么？必须有比仅仅在`<a href="...">`标签中编码更好的方法。以显示人员的页面为例。网址是`people.htm`。相应的控制器从数据库中获取人员并执行可选的列排序。JSP 可能如下所示：

```
<table>
<tr>
  <td><a href="people.htm?sort=name">Name</a></td>
  <td><a href="people.htm?sort=age">Age</a></td>
  <td><a href="people.htm?sort=address">Address</a></td>
</tr>
... 
```

这似乎很糟糕，因为 URL`people.htm`在 JSP 中是硬编码的。应该有一种方法可以让 Spring`<a>`使用定义在`servlet.xml`.

**编辑**：也许我应该使用 Spring 表单。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T20:31:04.073

唯一想到的是 JSTL 标准标记`<c:url>`。 [例如](http://www.sitepoint.com/article/java-standard-tag-library/3/)：

```
<c:url var="thisURL" value="homer.jsp">
  <c:param name="iq" value="${homer.iq}"/>
  <c:param name="checkAgainst" value="marge simpson"/>
</c:url>
<a href="<c:out value="${thisURL}"/>">Next</a> 
```

现在这不会让你得到 servlet 映射或类似的东西，但什么都不会。这不是您真正可以通过编程完成的事情（毕竟，servlet 可以而且通常确实映射到一系列 URL）。但这会照顾你逃跑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T20:23:44.183

我还没有在纯 spring 中看到过这种功能（尽管 grails 提供了类似的功能）。

对于您的特定情况，您可能会考虑删除文件部分并仅使用查询字符串作为 href 属性：

```
<td><a href="?sort=name">Name</a></td>
<td><a href="?sort=age">Age</a></td>
<td><a href="?sort=address">Address</a></td> 
```

这些链接将查询字符串附加到当前 url 的路径部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-04T09:33:23.290

**在 jsp 中的 Spring MVC 中：**

您可以使用：

一般超链接：

```
<a href="/Portfolio/login">Click Here</a> 
```

如果从控制器传递：

```
<a href="/Portfolio/${page}">Click Here</a> 
```

jsp标签

```
<c:url var="URL" value="login">
<c:param name="param" value="${parameter}"/>
</c:url>
<a href="<c:out value="${URL}"/>">Click Here</a> 
```

希望能帮助到你.. ：）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-06T14:14:30.397

创建链接的更好方法是：

```
<a href="<%=request.getContextPath() %>/people">Name</a> 
```

<%=request.getContextPath() %> 确保考虑到正确的 URI。

“排序”参数，您可以使用隐藏字段克服并使用一点 javascript 更改值：

```
<input type="hidden" name="sort" id="sort" value="name"> 
```

控制器方法应如下所示：

```
@RequestMapping("/people")
public String createUser(String sort) {

   ...

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-12T09:43:15.860

在你的jsp文件中导入这个包

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %> 
```

当您想重定向新页面或网址时，请使用例如。

```
<a href='<c:url value="url of next page" />'>Home</a> 
```

# xss - 防止来自第三方站点的 HTML 表单中的 XSS

> ID：421893
> 
> 赞同：0
> 
> 时间：2009-01-07T20:13:43.483
> 
> 标签：xss, forms

基础：

*   我有一个使用 php 来验证表单的联系表单。（除了客户端）这可以用任何服务器端语言完成。
*   服务器端仅允许某些字段使用 Az 0-9（仅在极其有限的范围内将此字段验证为英语是可以接受的）
*   如果表单包含错误，我会重新填充字段，以便用户在再次提交之前不必重新输入
*   我愿意不让其他网站张贴到我的表格，即使在那里可以找到合法用途。

我可以轻松地在另一个网站上制作一个表单，将脏词发布到字段中。根据验证规则，某些脏话是完全合法的，但我的员工显然不希望发生这种情况。

我的印象是，专门的黑客可以影响 cookie、php 会话，当然隐藏字段很容易与引荐来源等一起欺骗。如何阻止第三方网站发布到我的页面？

请随时帮助我谷歌这件事。我的搜索词很弱，提出我知道会失败的方法。

如果有人通过他们网站上的表单提交“d03boy 吃​​猫”并让人们点击将其提交到我的表单的链接怎么办？（承认这是可能的，我的公司不能接受任何风险）然后，当用户点击他们在“名称”字段中看到的链接时，“d03boy 吃​​猫”非常生气，并就我们网站的内容联系了 PETA。我们只是无法向用户解释发生了什么。诚然，什么都没发生，但我的雇主不能接受让单个用户感到不安。

我们目前的解决方案是不报告任何用户输入，在我看来这是一个很大的可用性问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T21:21:38.200

这听起来像是您需要一个用于用户生成内容的审核系统，而不是技术解决方案。显然，您可以检查推荐人字段、内容清理并尝试过滤亵渎，但列举坏处*永远不会*奏效。（这可能是一个可接受的“第一次通过”，但人类在避免此类过滤器方面非常足智多谋）。

将用户提交的内容放入队列，让版主审核和批准内容。为了减轻负担，您可以将受信任的用户设置为“预先批准”，但您已经说过您的客户不能接受任何风险。

坦率地说，我发现这是不可能的：即使有版主，版主也有可能颠覆你的系统。如果这确实是真的（他们的风险容忍度为零），那么我建议他们不要接受任何用户输入，不要相信版主，实际上要消除网站本身（因为内部人员可能会变得流氓并提出不正当的内容）。显然，每一个行为都有风险；您需要了解他们可以接受多少，例如基于版主的批准队列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T20:29:02.487

我不确定我是否完全理解你的问题，但我会尽力给你一个基本的答案。

跨站点脚本 (XSS) 通常在其他人将 HTML 放入您的表单时发生。您的网站允许这种情况发生，因为它没有正确转义 HTML。如果您使用 PHP，您可能想要使用 htmlentities($str, ENT_QUOTES) 函数。

```
htmlentities($str, ENT_QUOTES) 
```

[PHP 实体](http://us3.php.net/htmlentities)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T23:17:23.973

我的尝试

```
...
<?
$form_token = "";
$token = "";
$encoded_token = "";
$salt = "ThiséèÞ....$ÖyiìeéèÞ";  //it is 70 characters long
...
...
$blnGoodToken = false;
...
...
//Check for the encoded token
session_start();
$encoded_token = GetSuper('POST', 'TOKEN');
if (isset($_SESSION['TOKEN'])) {
    if (sha1($_SESSION['TOKEN'] + $salt) === $encoded_token) {
        $blnGoodToken = true;
        //echo "Good Token";
        }
    else {
        //echo "Bad Token";
        $blnGoodToken = false;
        unset($_SESSION);
        session_unset();
        session_destroy();
        session_start();
        }
    }
else {
    $blnDoit = false;
    echo "No Token, possible no session";
    }

$token = uniqid(rand(), TRUE);
$_SESSION['TOKEN'] = $token;
$form_token = sha1($token + $salt);
...
...
?>
...
...
<form action="request.php?doit=y" method="post">
    <input type="text" name="TOKEN" id="TOKEN" value="<?=$form_token?>" />
    <!--
    form stuff
    -->
    <input type="reset"  value="Clear" />
    <input type="submit" value="Submit" />
</form> 
```

由于我不在网站上的其他任何地方使用会话，我认为我们不会受到会话劫持的影响。令牌会更改每次负载，并让令牌与您必须知道的会话匹配

1.  我正在使用 SHA。对我的 php 代码的一个简单猜测
2.  我把它保留在会话中。我想会话是可获取的
3.  我的盐。我认为这是一个很好的秘密。如果他们知道我的盐，他们已经拥有了我的服务器

# nhibernate - NHibernate 的标准问题

> ID：421933
> 
> 赞同：0
> 
> 时间：2009-01-07T20:28:39.257
> 
> 标签：nhibernate, criteria

我正在尝试使用 NHibernate 进行数据访问，并且我有 2 个如下所示的简单实体：

```
public class User : IEntity
{
   public int ID { get; set; }
   public string FirstName { get; set; }
   public string LastName { get; set; }
   public string Email { get; set; }
   public string Logon { get; set; }
   public string Password { get; set; }
   public ICollection<Role> Roles { get; set; }

   public bool IsNew
   {
      get { return (ID == 0) ? true : false; }
   }

   public User()
   {
      Roles = new List<Role>();
   }
}

public class Role : IEntity
{
   public int ID { get; set; }
   public string RoleName { get; set; }
   public string RoleDescription { get; set; }

   public bool IsNew
   {
      get { return (ID == 0) ? true : false; }
   }
} 
```

我的问题......如果我想在其 Roles 集合中找到包含 ID 为 1 的 Role 的任何用户，我该如何构造一个 Criteria？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T20:47:45.850

没关系，这最终变得相对简单：

```
// role was the role passed in to my Find method.
var criteria = DetachedCriteria.For(typeof (User))
            .CreateCriteria("Roles")
            .Add(Restrictions.Eq("ID", role.ID)); 
```

# delphi - Delphi 中 TDataSetProvider 所需的信息

> ID：421934
> 
> 赞同：2
> 
> 时间：2009-01-07T20:28:44.750
> 
> 标签：delphi, delphi-2006

我有一个在服务器的 RemoteDataModules 之一中使用 TDataSetProvider 的 Midas 项目

目前我正在使用以下事件

*   BeforeApplyUpdates - 创建一个对象
*   BeforeUpdateRecord - 使用对象
*   AfterApplyUpdates - 破坏对象

问题：

即使是更新错误，是否总是会调用“AfterApplyUpdates”？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T20:40:14.617

如果您查看源代码：

```
function TCustomProvider.DoApplyUpdates(const Delta: OleVariant; MaxErrors: Integer;
  out ErrorCount: Integer; var OwnerData: OleVariant): OleVariant;
begin
  SetActiveUpdateException(nil);
  try
    try
      if Assigned(FOnValidate) then
        FOnValidate(Delta);
      DoBeforeApplyUpdates(OwnerData);
      Self.OwnerData := OwnerData;
      try
        Result := InternalApplyUpdates(Delta, MaxErrors, ErrorCount);
      finally
        OwnerData := Self.OwnerData;
        Self.OwnerData := unassigned;
      end;
    except
      on E: Exception do
      begin
        SetActiveUpdateException(E);
        raise;
      end;
    end;
  finally
    try
      DoAfterApplyUpdates(OwnerData);
    finally
      SetActiveUpdateException(nil);
    end;
  end;
end; 
```

Yoy 看到在 finally 块中调用了 DoAfterApplyUpdates。这意味着它总是被调用，不管任何异常。

# java - 使用 JavaMail 创建带有附件的 EML 文件

> ID：421944
> 
> 赞同：2
> 
> 时间：2009-01-07T20:31:25.290
> 
> 标签：java, email, outlook, jakarta-mail, eml

我将使用 JavaMail 创建一个带有附件的 EML 文件。

我成功创建了一个简单的 EML 文件，但添加附件无法正常工作。我要添加一个 PDF 文件。我的 EML 文件将成功创建。如果我用 Outlook 打开生成的 EML 文件，我会发现我的 PDF 文件不是附件，但我会发现 EML 文件本身是附件。有人有想法吗？

我尝试了两种变体（结果相同），我使用了`FileDataSource`类和简单的方法`MimeBodyPart#attachFile(File)`。

我将发布一个示例：

```
File pdfFile = new File("somePdfFile");

Properties p = System.getProperties();
Session session = Session.getInstance(p);
MimeMessage message = new MimeMessage(session);
// MimeBodyPart txt = new MimeBodyPart();
// txt.setText("");
MimeBodyPart mbp = new MimeBodyPart();
mbp.attachFile(attachment);
// FileDataSource fds = new FileDataSource(attachment);
// fds.setFileTypeMap(new FileTypeMap() {
//    
//   @Override
//   public String getContentType(String arg0) {
//     return "application/pdf";
//   }
//    
//    @Override
//    public String getContentType(File file) {
//      return "application/pdf";
//    }
//      
//  });
//  mbp.setDataHandler(new DataHandler(fds));
//  mbp.setFileName("\"" + attachment.getName() + "\"");
//  mbp.setDisposition(MimePart.ATTACHMENT);
//  mbp.setHeader("Content-ID", "Attachment");
Multipart mp = new MimeMultipart();
//  mp.addBodyPart(txt);
mp.addBodyPart(mbp);
message.setContent(mp);
File emlFile = new File("message.eml");
emlFile.createNewFile();
message.writeTo(new FileOutputStream(emlFile));

// do something with the EML file
// Desktop.getDesktop().open(emlFile); 
```

[在 Java 中创建一个 .eml（电子邮件）文件](https://stackoverflow.com/questions/157195/create-an-eml-e-mail-file-in-java)

* * *

谢谢您的答复。我上传了一个 PDF 文件（我用于测试，它是一个使用 Crystal Reports 生成的简单 HelloWorld）和生成的 EML 文件，其中应该包含 PDF 文件。

我只是注意到，如果我使用 Apple Mail 或 Outlook Express 打开链接的 EML 文件，它可以工作（但没有编辑的可能性）。也许这是 Microsoft Outlook 的问题？

*链接已删除*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T21:58:05.660

Zubi，看起来问题是附件上的内容类型设置为“application/octet-stream”。因此，看起来邮件阅读器正在将 PDF 文件作为不存在的邮件“文本”正文的替代显示（它只是空白）。

你必须原谅我，自从我与 Mime 打交道已经一年多了，但我想你会想要 A) 在消息中添加一些正文，B) 确保附件上的类型设置为应用程序/pdf。希望这将防止邮件阅读尝试将 PDF 显示为邮件的主要正文。

除此之外，它看起来很正常......现在，Outlook 可能是个婊子，因为主体中没有 RFC 822 标头。您可能希望至少添加一个`From:`、、`To:`和一个`Subject:`。

消息通过了 MY MIME 解析代码...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T18:07:39.057

您应该尝试将我提到的标题行添加到邮件的最顶部，然后查看 Outlook 如何处理它。添加一个`To:`, `From:`，`Subject:`甚至可能是其中`Date:`包含真实数据的 a，Outlook 更有可能将其视为消息，而不仅仅是文件。

# internet-explorer-7 - 是否可以出于调试目的从 Internet Explorer 7 降级到 Internet Explorer 6？

> ID：421945
> 
> 赞同：3
> 
> 时间：2009-01-07T20:31:26.647
> 
> 标签：internet-explorer-7, internet-explorer-6

我在我的一个站点上遇到 Internet Explorer 6 问题，我真的希望我安装它而不是 Internet Explorer 7。有没有快速的方法来做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-07T20:40:51.403

下载[Microsoft VirtualPC](http://www.microsoft.com/windows/products/winfamily/virtualpc/default.mspx)。然后下载[Internet Explorer Application Compatibility VPC Image](http://www.microsoft.com/downloads/details.aspx?FamilyId=21EABB90-958F-4B64-B5F1-73D0A413C8EF&displaylang=en)中的任何文件。第二次下载包含四个 VHD（虚拟硬盘）文件，它们具有：

*   XP SP2
    *   即 7
*   XP SP3
    *   IE 6、IE 8 测试版 2
*   远景SP1
    *   即 7

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-07T20:33:50.463

[多个IE](http://tredosoft.com/Multiple_IE)：

> [由于Joe Maddalone](http://web.archive.org/web/20090101200355/http://archivist.incutio.com/viewlist/css-discuss/33150)在 2003 年 11 月提出了实现这一目标的方法，因此可以在独立模式下运行 Internet Explorer 而无需覆盖以前的版本。基本上，Internet Explorer 是通过利用已知的 DLL hell 解决方法来运行的 -这是在 Windows 2000 和更高版本中引入的 - 称为 DLL 重定向。
> 
> [Manfred Staudinger](http://web.archive.org/web/20090101200355/http://www.positioniseverything.net/articles/multiIE.html)通过在独立浏览器窗口的标题栏中添加 IE 版本号来完善独立版本。此外，通过删除注册表子键中的“IE”键，`[HKLM\SOFTWARE\Microsoft\Internet Explorer\Version Vector]`Internet Explorer 默认尊重基于程序中预建的版本号的条件注释。
> 
> 遵循说明并让任何版本的 IE 与其他版本一起独立运行并不难。你们中的大多数人可能都知道[evolt 的 Internet Explorer 存档，](http://web.archive.org/web/20090101200355/http://browsers.evolt.org/?ie/32bit/standalone)其中很容易将它们打包成 ZIP 文件。现在假设您想全部下载它们。一个可以方便地自动化整个过程的安装程序会很棒。感谢[这个想法的评论](http://web.archive.org/web/20090101200355/http://tredosoft.com/node/25#comment-512)。
> 
> 所以我做了一个包含 IE3 IE4.01 IE5 IE5.5 和 IE6 的安装程序...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T20:34:11.540

下载[Virtual PC](http://www.microsoft.com/windows/downloads/virtualpc/default.mspx)并设置一组用于测试各种浏览器/操作系统。一旦设置完成，就可以轻松地在 IE6、7 和 8、各种 Firefox 风格、Konqueror、Opera、Safari 等上进行测试......

请参阅[Samuel 的答案](https://stackoverflow.com/questions/421945/possible-to-degrade-from-ie7-to-ie6-for-debuggin-purposes#421988)以获取有用的 VPC 图像以开始此操作：

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T20:50:47.433

我建议始终使用[BrowserShots](http://browsershots.org/)测试您的网站。您可以查看您的网站在多个操作系统上的多个浏览器、多个版本的外观。您可以在他们的免费服务上每天进行 50 次测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T21:32:00.410

另请查看[IETester](http://www.my-debugbar.com/wiki/IETester/HomePage)，它在一个应用程序中为您提供 5.5、6、7、8b2。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T21:09:01.010

[Litmus](http://litmusapp.com/)是另一个 BrowserShots-esque 服务。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T20:36:01.130

这对我来说很好：[Multiple IE](http://tredosoft.com/Multiple_IE)

编辑：看起来我找到 URL 的那一刻就足以让 3 个人打败我......哇

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-07T21:34:33.073

[IETester](http://www.my-debugbar.com/wiki/IETester/HomePage)还不错，对比一下IE5.5/IE6/IE7/IE8。

# sql - SQL 帮助：使用嵌套 SELECT 计算单个查询中的行数

> ID：421949
> 
> 赞同：6
> 
> 时间：2009-01-07T20:33:18.233
> 
> 标签：sql

我正在寻找一种更好的方法来执行以下查询。我有一个看起来像这样的表：

```
game_id | home_team_id | away_team_id
1       | 100          | 200
2       | 200          | 300
3       | 200          | 400
4       | 300          | 100
5       | 100          | 400 
```

我想写一个查询来计算每支球队的主场和客场比赛的数量，并输出以下内容：

```
team_id | home_games | away_games
100     | 2          | 1
200     | 2          | 1
300     | 1          | 1
400     | 0          | 2 
```

现在，我写了这个可行的怪物，但它很慢（我知道它会从表中拉出整个 2,800 行两次）。

```
SELECT 
  home_team_id as team_id,
  (SELECT count(*) FROM `game` WHERE home_team_id = temp_game.home_team_id) as home_games,
  (SELECT count(*) FROM `game` WHERE home_team_id = temp_game.away_team_id) as away_games
  FROM (SELECT * FROM `game`) as temp_game
  GROUP BY home_team_id 
```

SQL 大师能帮我找出更好的方法吗？我认为我的问题是我不明白如何获得一个不同的团队 ID 列表来抛出计数查询。我敢打赌，有一个更好的方法可以放置更好的嵌套 SELECT。提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T20:55:27.643

如果您有另一个具有 team_id 和 team_name 的表团队，它会更干净。

```
选择团队 ID、团队名称、
     sum(team_id = home_team_id) 作为 home_games，
     sum(team_id = away_team_id) as away_games
 FROM 游戏，团队
 GROUP BY team_id

```

发生了什么：没有 WHERE 子句导致两个表之间出现笛卡尔积；我们按 team_id 分组以返回每个团队的一行。现在每个 team_id 都有来自游戏表的所有行，因此您需要对它们进行计数，但 SQL 计数函数并不完全正确（它将计算所有行或所有不同的行）。所以我们说 team_id = home_team_id 解析为 1 或 0，然后我们使用 sum 将 1 相加。

team_name 只是因为当我们应该说“泥城扼杀者队有 20 场主场比赛”时说“200 队有 20 场主场比赛”是令人讨厌的。

PS。即使没有比赛，这也可以工作（通常是 SQL 中的问题，其中有一个团队有 0 场比赛，并且该行不会显示，因为加入失败）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T20:47:04.930

如果你想要不同的球队名单，你必须从比赛表中选择两次，将主队和客队联合起来（理论上，一个球队可以在客场或主场进行所有比赛，如果你有防止这种情况发生的逻辑，那么你可以调整这个查询）：

```
select home_team_id as team_id from game union
select away_team_id as team_id from game 
```

运算符将`union`确保您仅在返回集中获得不同的元素（除非您使用`union all`）

从那里，您可以使用左外连接来聚合数据：

```
select
    u.team_id, count(h.game_id) as home_games, count(a.game_id) as away_games
from
    (
        select home_team_id as team_id from game union
        select away_team_id as team_id from game
    ) as u
        left outer join game as h on h.home_team_id = u.team_id
        left outer join game as a on a.away_team_id = u.team_id
group by
    u.team_id 
```

如果您想进一步减少表扫描（以上将产生四个），您可以添加更多代码，但这会花费您。您可以获得带有 team_id 的行列表，以及比赛是在主场还是客场进行：

```
select
    case ha.home when 0 then g.away_team_id else g.home_team_id end as team_id,
    case ha.home when 0 then 0 else 1 end as home_games,
    case ha.home when 0 then 1 else 0 end as away_games
from
    game as g, (select 0 as home union select 1 as home) as ha 
```

从那里，您可以简单地总结每支球队的主场和客场比赛：

```
select
    t.team_id, sum(t.home_games) as home_games, sum(t.away_games) as away_games
from
    (
        select
            case ha.home when 0 then g.away_team_id else g.home_team_id end as team_id,
            case ha.home when 0 then 0 else 1 end as home_games,
            case ha.home when 0 then 1 else 0 end as away_games
        from
            game as g, (select 0 as home union select 1 as home) as ha
    ) as t
group by
    t.team_id 
```

这将导致单表扫描。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T20:48:51.933

格雷格，

我认为您的最终解决方案将是特定于语言的。但是，如果您在 Oracle 中执行此操作，则只能使用以下命令查询该表一次：

```
SELECT game.home_team_id AS team_id,
       SUM(CASE WHEN game.home_team_id = game.away_team_id
                THEN 1
                ELSE 0 END) AS home_games,
       SUM(CASE WHEN game.home_team_id <> game.away_team_id
                THEN 1
                ELSE 0 END) AS away_games
  FROM game
GROUP BY game.home_team_id
ORDER BY game.home_team_id; 
```

你没有说你正在使用什么风格的 SQL，所以这是我能做的最好的。

祝你好运，

炖

ps 看起来我给出了与 MarlonRibunal 相同的解决方案。我只是没有方便的链接，所以不得不手动创建代码。：-/

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T20:50:18.810

试试这个：

```
Select Z.teamId, 
    Count(H.Game_Id) HomeGames, 
    Count(A.Game_Id) AwayGames
From (Select Distinct home_team_id TeamId From Game
        Union 
      Select Distinct away_team_id TeamId From Game) Z
   Left Join Game H On H.home_team_id = Z.TeamId
   Left Join Game A On A.away_team_id = Z.TeamId
Group By Z.TeamId 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T20:52:45.170

```
declare @ts table

(
    team_id int
)

declare @t table
(
    id int,
    h int,
    a int
)

insert into @ts values (100)
insert into @ts values (200)
insert into @ts values (300)
insert into @ts values (400)

insert into @t values (1, 100, 200)
insert into @t values (2, 200, 300)
insert into @t values (3, 200, 400)
insert into @t values (4, 300, 100)
insert into @t values (5, 100, 400)

select s.team_id, t0.home, t1.away
from @ts s
    left outer join (select team_id, count(h) as [home] from @ts inner join @t on h = team_id group by team_id) t0 on t0.team_id = s.team_id
    left outer join (select team_id, count(a) as away from @ts inner join @t on a = team_id group by team_id) t1 on t1.team_id = s.team_id 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T21:00:14.203

这是另一个例子。

我要指出的是，您应该从 teams 表中开始 from 子句，这样您就可以确保包括所有球队，即使他们还没有参加过比赛。

此查询将您的两个查询作为连接而不是子选择执行，这应该会更好。

-- 注意：如果你使用 mysql，coalesce 就像 ifnull。

```
SELECT  
team_id as team_id,  
coalesce(home_game_counts.games,0) home_games,  
coalesce(away_game_counts.games,0) away_games  
FROM teams  
left join (select home_team_id, count(*) games from games group by home_team_id) as   home_game_counts on home_game_counts.home_team_id = teams.team_id  
left join (select away_team_id, count(*) games from games group by away_team_id) as   away_game_counts on away_game_counts.away_team_id = teams.team_id  
GROUP BY teams.team_id, home_game_counts.games ,  
away_game_counts.games 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T21:13:08.873

这个解决方案相当难看，但它应该可以在大型数据集上快速运行：

```
select
  teams.team_id
 ,case when home.home_game_count is null
       then 0
       else home.home_game_count
  end home_game_count  
 ,case when away.away_game_count is null
       then 0
       else away.away_game_count
  end as away_game_count
from
  ( 
  select home_team_id as team_id from games
  union
  select away_team_id as team_id from games  
  ) teams
  left outer join
  (  
  select home_team_id as team_id, count(*) as home_game_count
  from games
  group by home_team_id
  ) home
  on teams.team_id = home.team_id
  left outer join
  (
  select away_team_id as team_id, count(*) as away_game_count
  from games
  group by away_team_id
  ) away  
  on teams.team_id = away.team_id 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T21:22:10.553

抱歉，我在 away_games 条款中的错误。我更改了比较运算符（改为 <>）而不是更改结果值。我必须创建额外的数据才能看到问题。

```
SELECT team_id,
       teams.team_name,
       SUM(CASE
               WHEN game.home_team_id = game.away_team_id THEN
                1
               ELSE
                0
           END) AS home_games,
       SUM(CASE
               WHEN game.home_team_id = game.away_team_id THEN
                0
               ELSE
                1
           END) AS away_games
  FROM teams
  LEFT OUTER JOIN game ON game.home_team_id = teams.team_id
 GROUP BY team_id, teams.team_name 
```

# java - 在 JVM 之上运行/解释 C？

> ID：421951
> 
> 赞同：30
> 
> 时间：2009-01-07T20:33:28.420
> 
> 标签：java, c, jvm, antlr, interpreter

有没有办法在 JVM 上运行纯 c 代码？
不通过 JNI 连接，运行，就像你可以通过 JRuby 运行 ruby​​ 代码，或者通过 Rhino 运行 javascript。

如果没有当前的解决方案，您建议我应该怎么做？
显然，我想使用尽可能多的部分解决方案来实现它。

ANTLR 似乎是一个很好的起点，拥有完整的“ANSI C”语法实现......
我应该使用 ANTLR 生成的代码在 JVM 上构建一个“玩具”虚拟机吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-07T20:39:57.690

2012-01-26 更新：根据[公司网站上的此页面，](http://axiomsol.com/ampc-acquired-by-private-company)该产品已被买断，不再可用。

是的。

这是[一个生成 JVM 字节码的商业 C 编译器](http://www.axiomsol.com/pro_serv/compiler.php)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-10T23:18:07.270

还有另外两种可能性，都是开源的：

[JPC](https://github.com/ianopolous/JPC)在 JVM 中模拟整个 x86 pc，并且能够运行 DOS 和 Linux。

[NestedVM](http://nestedvm.ibex.org/)为 Java 字节码提供二进制翻译。这是通过将 GCC 编译为 MIPS 二进制文件来完成的，然后将其转换为 Java 类文件。因此，任何用 C、C++、Fortran 或 GCC 支持的任何其他语言编写的应用程序都可以在 100% 纯 Java 中运行，而无需更改源代码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-04-02T15:33:21.373

看来[LLJVM](http://da.vidr.cc/projects/lljvm/)也能满足你的要求。

LLJVM：源代码首先由 llvm-gcc 或 clang 等前端编译为 LLVM 中间表示 (IR)。然后将 LLVM IR 转换为 Jasmin 汇编代码，链接到其他 Java 类，然后汇编为 JVM 字节码。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-06-13T12:42:05.060

截至 2016 年，有一个年轻但有前途的选项，称为[gcc-bridge](https://github.com/bedatadriven/renjin/tree/2afb9639d24b65b61b6df1123ff02ee03ca79e60/tools/gcc-bridge)。它的目的是利用 JVM 的 R 实现。目标是使用用 C 或 Fortran 编写的 R 库。但是 gcc-bridge 可以作为常规的 maven 插件独立使用。另请参阅[gcc-brigde-example](https://github.com/bedatadriven/gcc-bridge-example)。

# asp.net - asp.net - gridview 验证 - 重复验证消息问题

> ID：421953
> 
> 赞同：1
> 
> 时间：2009-01-07T20:33:40.543
> 
> 标签：asp.net, gridview, validation

我有一个包含一对多行的gridview（就像大多数行一样） - 每个都有一个输入文本框。每行都有一个针对该文本框的 requiredfieldvalidator。提交表单时，gridview 被验证，完全有可能不止一行有一个空的文本框。这会导致重复验证消息，例如

*   请为“名称”字段提供文本
*   请为“名称”字段提供文本
*   请为“名称”字段提供文本

是否可以将这些消息合并为一条消息？

我知道可以通过设置验证器类并从可用于验证整个网格视图的 BaseValidator 类继承来创建验证器。但是当它无效时，我会在每一行上放置一个图像，所以我应该想象我需要在每一行上使用单独的验证器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-05T08:21:30.790

这是一个使用 CustomValidator 并需要进行一些组织更改的解决方案。这需要回发，因为 CustomValidator 验证是在服务器端执行的。

**这是设置：**

1.  对于显示“请为'名称'字段提供文本”消息的每个现有RequiredFieldValidators，您需要设置：

*   EnableClientScript="假"
*   ValidationGroup="vgTxtName"（提供你自己的名字）
*   ErrorMessage="" （或完全删除它；CustomValidator 现在将对此负责）

您可以选择不显示任何内容（用户不太清楚）或显示星号以指示哪个验证器无效。
*选项1：*

*   显示="无"

*选项 2（首选）：*

*   显示="动态"
*   将验证器标签之间的文本设置为：*

*   您的 ValidationSummary 控件不需要更改（它应该是中性的，并且没有设置 ValidationGroup 属性，这是默认设置）*   添加一个 CustomValidator（见下面的代码）

*   为 CustomValidator 的 ServerValidate 事件添加一个事件处理程序（您可以从设计器中双击它来生成它）
*   实现事件处理逻辑（见下面的代码）

我们的想法是不再直接允许页面处理那些RequiredFieldValidator，而是让CustomValidator 来处理。

**TextBoxRequiredFieldValidator 示例**（您应该具有与上述步骤 1 相对应的相关 ID 名称看起来像这样的内容）：

选项1：

```
<asp:RequiredFieldValidator ControlToValidate="txt1" ID="rfv1" runat="server" 
EnableClientScript="false" Display="None" ValidationGroup="vgTxtName" /> 
```

选项 2：

```
<asp:RequiredFieldValidator ControlToValidate="txt1" ID="rfv1" runat="server" 
EnableClientScript="false" Display="Dynamic" ValidationGroup="vgTxtName">*
</asp:RequiredFieldValidator> 
```

**CustomValidator 标记**（您可以将其放置在任何合理的位置，例如 ValidationSummary 控件旁边）：

```
<asp:CustomValidator ID="cvName" runat="server" Display="None"
ErrorMessage="Please provide text for 'Name' field" 
OnServerValidate="cvName_ServerValidate" /> 
```

此处的错误消息替换了来自各个验证器的错误消息。另请注意，没有 ControlToValidate 集，它对这种类型的验证器有效，并且对于应用覆盖多个控件的验证很有用。

**CustomValidator 事件**处理程序（cvName_ServerValidate）：

```
protected void cvName_ServerValidate(object source, ServerValidateEventArgs args)
{
    // Validate vgTxtName group
    Page.Validate("vgTxtName");

    // .NET 3.5 - add using System.Linq;
    args.IsValid = Page.GetValidators("vgTxtName")
                        .OfType<RequiredFieldValidator>()
                        .All(v => v.IsValid);

    // .NET 2.0 (use either this or the above, not both)
    bool isValid = true;
    foreach (RequiredFieldValidator validator in Page.GetValidators("vgTxtName"))
    {
        isValid &= validator.IsValid;
    }
    args.IsValid = isValid;
} 
```

而已！请记住，这仅适用于RequiredFieldValidators。您不应将不同类型的验证器放在“vgTxtName”组中，因为 cvName 逻辑严格处理 RequiredFieldValidator 类型。如果您打算使用其他验证器类型，则需要设置不同的分组或调整代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T01:41:03.323

我建议不要使用验证器摘要。

将验证器的 Text 属性或内部内容更改为更适合您的应用程序的内容。

例如...

```
<asp:Validator ID="X" ... runAt="server" Text="*" /> 
```

或者

```
<asp:Validator ID="X" ... runAt="server">*</asp:Validator> 
```

或显示图像...

```
<asp:Validator ID="X" ... runAt="server"><img src="../path.png" alt="Invalid" /></asp:Validator> 
```

我还设置了验证器的样式以更改为指向帮助光标的指针，并添加一个 ToolTip 属性以显示相同的错误消息。

# database - Filemaker 的优缺点是什么？

> ID：421960
> 
> 赞同：38
> 
> 时间：2009-01-07T20:35:50.273
> 
> 标签：database, filemaker

一位潜在客户要求我查看一些属于联系人管理/调度程序类别的应用程序的宣传传单。两者都使用 Filemaker 作为后端。看起来这两个应用程序是作为网络应用程序出售的。无论如何，我已经有大约 10 年没有听说过 Filemaker 了，所以看到它在同一次会议上出现两次令人惊讶。我认为它最初是一个 Mac 平台数据库系统。

我更偏爱 SQL Server、MY SQL 等，但在对 Filemaker 发表任何评论之前，我想了解一些系统的优缺点。它肯定不仅仅是 Mac 的 Access，但我从来没有在客户端/服务器或 Web 应用程序领域作为播放器运行过它。

非常感谢迈克·托马斯

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-18T02:52:59.817

调用 Filemaker Pro，Mac 的 Access 有点像说，Mac OS X 是 Mac 的 Windows。它们都属于同一类软件，它们是集成的编程环境。就像您将 MySQL、PHP、HTML 和您的编辑器放在一个 GUI 中一样。两者对比，各有优劣。以下是根据我的经验使用 Filemaker Pro 与 PHP/MySQL/HTML 的优缺点。

**优点：**

*   易于上手
*   易于在本地部署，打开共享并从另一个客户端连接
*   跨平台（Mac OS X、Windows、iOS）
*   有许多插件可用于扩展功能
*   包括入门解决方案
*   任何有权访问的人都可以编辑该程序
*   在大多数情况下，拖放编程
*   事后更改字段/数据库/脚本名称是免费的
*   有一些巧妙的内置技巧，如内置图表、选项卡控件、网络查看器
*   内置支持导入导出 excel、cvs、制表符格式

**缺点：**

*   不灵活：它做得很好，但如果你需要更多，大部分情况下你的运气不好
*   与免费替代方案相比价格昂贵：本地用户每年花费约 100 美元，每位开发人员 150 美元，如果您将其用作网站，则需要专门的托管，这往往会花费更多。另外软件的服务器部分每年大约300-800美元
*   扩展功能所需的插件也可能很昂贵
*   几乎只有拖放编程，您只能使用预定义的脚本步骤，通过制作图表来建立关系
*   源代码控制是个问题
*   缺乏可扩展性
*   无法从解决方案复制和粘贴/导入或导出某些项目
*   需要鼠标才能访问功能
*   布局设计相当静态且过时（Filemaker 12 及更高版本正在改进）

一般来说，我会说，如果您专门为 Web 或大型组织开发，Filemaker Pro 可能不是最合适的。很难让多个人在同一个解决方案上进行开发。另一方面，对于需要可定制内部数据库的小型组织来说，这可能是一个巨大的福音。如果您愿意处理它的缺陷，您可以使用它非常快速地构建相当复杂的应用程序。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-01-07T20:47:33.650

优点：

*   很便宜

缺点：

*   它很便宜（制作）
*   它是非标准的（很容易找到 MySQL/Oracle/MSSQL/Access 专家，但没有人知道 Filemaker）

使用低于标准和/或非标准的技术只会产生[技术债务](http://onstartups.com/tabid/3339/bid/165/Development-Short-Cuts-Are-Not-Free-Understanding-Technology-Debt.aspx)。我从来没有找到真正喜欢（或想要）使用这个利基产品的受人尊敬的开发者。

在我看来，这个产品之所以存在，是因为它是 Mac 的 Access，它获得了足够多的用户群和现有应用程序，以至于有足够多的人购买了每次升级以维持它的业务。市场上有许多产品仍然存在，因为它的用户被锁定了，而不是因为它是一个好的选择。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-02-11T02:57:16.630

我承认在这个主题上存在偏见——我与那里的一家较大的 FileMaker 开发商店合作，并就这个主题写了一本奇怪的书。我们实际上雇佣了许多喜欢使用 FMP 的受人尊敬的开发人员。我会尽量保持简短。:-)

FileMaker Pro 是一款快速应用程序开发工具。它主要是客户端-服务器，尽管它具有一些非常受人尊敬的 Web 发布功能，适用于许多应用程序。它不是基于 SQL 的，但具有 ODBC 和 JDBC 接口，以及 XML/HTTP 接口。

就锁定而言，FileMaker Inc 的销售额稳步增长，平台的稳固性和易用性吸引了新用户的显着增长。

我认为 Matt Haughton 做到了——对于正确的应用程序，FMP 是最好的选择。也就是说，您的客户正在查看使用 FMP Pro 编写的应用程序，您需要根据这些应用程序自身的优点来评估这些应用程序。它们可能是 FMP 开发的良好实例，也可能不是。

要了解更多关于 FMP 适合该任务的信息，我们需要了解更多关于提议的应用程序和用户群的信息。这些确实是 Web 应用程序还是客户端服务器？有多少用户将使用它？他们是在一个或两个站点工作，还是分布在 Internet 上？

如果有更多的兴趣，很高兴进一步详细说明。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-12-03T05:36:10.860

FileMaker 旨在*非常简单地*与其他数据库和客户端应用程序集成。如果您正在考虑构建复杂的分布式系统，请查看其他地方。

由于外部 SQL 数据源 (ESS) 功能集的设计目标， FileMaker**不**适合用作另一个数据源的前端，也不**适合**用作 FM 客户端以外的任何东西的后端由于缓慢和错误的 ODBC 驱动程序。FileMaker 架构的性质意味着它不能很好地扩展复杂的解决方案，无论它与其他系统的集成程度如何。

以下是开发人员对我在将 FileMaker 与其他后端和 ODBC 客户端组合时发现的一些限制**的看法：**

*   **ODBC 驱动程序**是有限的、缓慢的，并且会在客户端泄漏内存。xdbc_listender.exe 在服务器端也有类似的内存泄漏问题，最终会在使用一定数量的 RAM 时崩溃。我们有一个预定的脚本来每天晚上重新启动它。
*   FileMaker 需要先将所有相关数据库加载到内存中，然后才能连接到数据库。如果它是一个复杂的数据库，**打开和关闭一个连接可能会很慢**（1-2 秒），具体取决于它的结构，如果数据库引用其他 FM 数据库中的表，则更是如此，因为它们也需要加载。我通过创建在应用程序的生命周期内保持打开状态的持久连接来解决这个问题。尽管我们尝试最小化打开连接的数量，但我们还没有看到服务器的性能受到影响。
*   ODBC 驱动程序以奇怪的方式解释查询。例如，我对 76k 行运行查询以 UPDATE table_1 SET field_1 = 1 执行查询需要 5 分钟，因为我认为它将一个查询拆分为 46k 更新查询，每行一个。我知道这一点，因为我看到它在 FM 客户端中逐一更新行。所以我根本不信任 ODBC 驱动程序。

这是 3 个不同查询的另一个示例，以及他们在两个日期字段上搜索的时间：

```
SELECT id FROM table
WHERE datefield1 = {d '2014-03-26'} 
```

。5秒

```
SELECT id FROM table
WHERE datefield2 = {d '2014-03-26'} 
```

。5秒

```
SELECT id FROM table
WHERE datefield1 = {d '2014-03-26'} OR datefield2 = {d '2014-03-26'} 
```

1分13秒！

*   **FileMaker 如何缓存**SQL Express 数据库中的数据时，我们遇到了问题。我们试图运行命令来清除缓存，但它并不总是有效（花了很多时间研究这个）。
*   FileMaker 使用**悲观锁定**记录；在编辑（从客户端或作为 odbc 事务的一部分）之前，FileMaker 会首先尝试锁定该行。
*   FileMaker Server 服务“倾向于”使用 Admin Console 停止（尽管 Admin Console 有时也可能无法停止它）。如果 FileMaker Server 服务以任何其他方式停止（包括断电、通过管理控制台，甚至是正常的系统关闭），那么您的某些数据库可能会损坏。如果客户端在操作过程中崩溃，或者网络连接突然丢失，也是如此。断电的解决方案是编写一个[批处理脚本](http://buzz.beezwax.net/2010/04/20/stop-filemaker-server-from-script)来尝试自动关机，然后购买一个 UPS 并对其进行编程以在果汁用完之前执行您的脚本。并希望它有效。否则，使用内置调度程序每小时备份一次。旁白：SQL server 没有这个问题，因为它可以回滚未提交的事务。
*   **使用内置调度程序**执行备份实际上会在备份过程中暂停对数据库的操作。**即，如果它是一个大型数据库，那么备份可能需要一分钟，用户会注意到暂停，因为他们将无法编辑/插入等。**
***   如果您使用的是**FileMaker PHP API**，请注意您不能在同一个请求中同时使用 AND 和 OR。*   使用 ODBC 驱动程序运行密集查询本身可能很快，但同时**运行相同的查询**（如在多用户环境中），它会以指数方式减慢大约 300%。如果您期望大量密集查询同时访问数据库，您将遇到速度问题。*   我们发现，当 FileMaker ODBC 驱动程序说它已经完成更新/插入操作时，它仍然不能保证事务被提交；似乎 FileMaker 将继续在服务器缓存中保存更改，直到自动输入计算字段被评估/索引，然后保存到磁盘，这意味着在实际提交记录之前可能会有更多延迟。所以实际上 ODBC 写入操作并不总是立即写入，而是**最终写入**。这种延迟在具有许多计算字段和触发器的复杂表中尤其明显。*   **计算字段可能会减慢**通过 ODBC 驱动程序执行和读取的速度，具体取决于正在评估的内容。尽可能尝试读取存储的值。*   **使用 BLOB 容器**：不推荐。将 PDF 等文档存储在容器字段中会增加数据库文件的大小，需要更长的备份时间，并使通过 ODBC 检索和编辑这些文件变得复杂。将文件存储在网络共享上并写入磁盘上的文件要容易得多。**

 **如果您必须使用 FM 作为另一个数据库的前端解决方案，请务必仔细阅读[FileMaker 的外部 SQL 源简介](http://www.filemaker.com/downloads/documentation/techbrief_intro_ess.pdf)。

另请参阅其网站上相应版本的 FileMaker ODBC 指南。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-03T16:03:17.513

只是对这个主题的一些评论

FileMaker 在许可成本方面肯定比某些企业解决方案便宜。然而，真正的成本效益在于开发时间。开发生命周期通常比其他企业平台低几个数量级（无论这些平台的许可成本如何）。我的意思是几天而不是几周，或者几周而不是几个月来开发一些功能。

有一个强有力的论点是 FileMaker 是 Mac 的 Access。虽然几年前这是一个有效的论点，但 FileMaker 在最近几年已经形成了自己的观点。值得注意的是，FileMaker 是跨平台的，在 Windows 和 Mac 上广泛使用。话虽如此，FileMaker 和 Access 之间仍然存在巨大的相似之处和不同之处，但事实是它们都与您的情况无关。

虽然 FileMaker 是非标准的，但它确实支持与 MySQL、MS SQL Server 和 Oracle 的实时连接。

此外，还有许多 FileMaker 开发人员，没有更多标准平台，但他们肯定是关于，如果您让我知道您在哪里，我可以让您与您所在地区的一些开发人员联系。

我想说的重要一点是，在正确的上下文中，FileMaker 是世界上最好的东西——如果你试图做一些它不应该做的事情，你就会陷入困境。但是，它可以支持 4 个地点的办公室，它可以并且正在完成。

在您在其他平台上重写您的系统之前，您应该与 FileMaker 专家取得联系，看看他们对您目前拥有的内容有什么看法，在此网站上写下更多详细信息，让非专家给出正面或负面的回答不会帮你的。最后，它必须是成本与收益的商业选择。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-06-09T08:39:23.423

无需再列出“缺点”——但这里有一个重要的“优点”——Filemaker Go。设置好数据库后，下载 ipad/iphone 应用程序（FM12 免费）并从移动设备运行它。数据库可以本地存储在 ipad/iphone 上或同步回主机 PC。

我确信这种移动解决方案在其他地方也是可行的——但基本点是入门级用户（我的意思是没有以前的数据库经验）可以在几周内创建一个令人印象深刻的解决方案。

个人经验：运行 FM 11 的主数据库托管在我桌下的 PC 上 - 4 名研究人员分散在城市中收集 ipad 上的数据 - 全部同步回我的 PC。以前的解决方案是使用纸张并手动输入数据。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-09-09T19:03:19.233

FileMaker 是一个有趣的应用程序 :) 它最初是一个最终用户工具，但它仍然是非程序员可以实际使用的极少数数据库应用程序之一。但不知何故，FileMaker 开发人员设法使其具有很高的可扩展性。没有其他平台可以让人们从一个有用的工具开始，最终得到一个适用于整个公司的客户端-服务器应用程序。在过去，他们曾经有一个闪屏来捕捉这个想法（我只发现了一个不完美的版本）：

![一本关于 FileMaker 的旧书的封面](https://i.stack.imgur.com/cTIP4.jpg)

即像文件柜一样简单的东西，可以变得很大。

FileMaker 的所有优点和缺点都源于其本源。作为最终用户工具，它与其他 DBMS 应用程序非常不同。没有 SQL。没有真正的编程：脚本基本上是使用变量和一些逻辑以稍微更通用的方式重复用户操作的宏。很多限制；例如列表视图不能有侧边栏；动态值列表始终按字母顺序排序；打开“另存为”对话框并读回您需要插件的文件名；等等。对于程序员来说，这可能非常令人沮丧，因为他的大多数假设都是错误的。由非程序员编写的现有应用程序并不完全是清晰和可靠设计的典范。

但是如果你设法克服了这些障碍，你会发现一个相当不错的 RAD 用于客户端-服务器、单用户、Web 和移动应用程序，它在 WAN 上保持相当可用，具有运行时和信息亭模式等细节。

话虽如此，我不太确定 FileMaker 中的通用联系人管理和计划应用程序。如果它们是这样的，那么它们应该被解锁，以便客户可以进行更改；或者它们必须是小众应用程序，为客户做其他没有做的事情。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-01-07T05:28:14.913

Filemaker 功能强大且用途广泛。出色的多用户支持。您可以在 Filemaker 中创建出色的解决方案，包括文档管理、Web 界面、iPhone 界面、自动发布支持、预定脚本、PDF/Excel/HTML 报告、XML 支持、来电显示记录查找、网络数据集成（UPS 和 Fedex 链接到订单例如记录）。可通过插件扩展。这就像在数据的家得宝中一样。不要试图建立亚马逊；除此之外，您不能用它构建什么，以及比其他任何地方都更快的应用程序开发？

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-09-09T16:52:22.247

自从我运行 FM 并将其用于为各种客户开发解决方案以来，已经一年多了。以下是我的FM经验：

1.  学习曲线远低于使用硬编码的行业标准技术；
2.  由于它的 ODBC 和 JDBC 连接性，它可以很好地适应行业标准平台。您的数据未锁定在FM中，其他数据格式可以在FM中获取；
3.  它非常适合前端和后端解决方案。
4.  FM 可以匹配具有正确数据库设计和部署的企业平台，即面向工作组或部门的解决方案。这是其工作组所有者的数据，并可供其他工作组或部门使用；
5.  FM 非常适合采用原型设计的快速应用程序开发；
6.  FM 拥有更多的功能...

我建议你自己尝试一下，我相信你会喜欢 FM 提供的东西！

快乐的计算...

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-11T03:08:16.493

虽然与“Access for Mac”的比较是不可避免的，但必须做出一些重要的区分。

如果发生 2 件事中的 1 件，则可以将 FileMaker 数据库共享给多人。一，您网络上的一个人打开数据库并从他们的计算机共享它，充当主机。第二，您购买并安装托管 DB 的 FileMaker 服务器。

此外，我的经验是，虽然 FileMaker 开发人员喜欢 FM，但他们不得不学习其他技术，因为越来越多的政府机构（我过去 10 年的主要雇主）正在从 FM 转移到 SQL Server、Oracle 以及在某种程度上访问和开源。公共部门对 FileMaker 技能的需求越来越少，因此获得对这些应用程序的支持变得更加困难，因此也更加昂贵。

话虽如此，我们有一个 FM 服务器和 FM 5.5 客户端运行一个过去 5 年一直坚如磐石的应用程序。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-07T21:45:51.130

一些研究让我认为 FileMaker 确实是 Mac 的 Access，但可能更强大一些。我与 Access 合作了多年，从来没有真正喜欢过它，并且很高兴远离它（我一直对 MSFT 杀死 FoxPro 怀恨在心，我确实很喜欢）。

我很难想象它是一个很好的解决方案，适用于全国四个地点的办公室使用的基于 Web 的应用程序，以及许多其他人在家登录等。

当 MySQL、SQL Server 等可用于数据存储并且 ASP.NET、PHP、Ruby 等可用于编程时，使用它没有多大意义。

迈克·托马斯

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-10-08T08:38:47.177

i've been using FM for more than a year now. i'm doing and providing solutions for SMBs using the SQL standard for several years. i love those SQL stuff, but just a year a ago i run through FM Pro 9 and have it a try. amazingly, i got all i wanted in just a short time. in my experience as developer, FM Pro impressed me the way it does things.

true enough, FM is not an industry database standard but a good number of its features can compensate to what "standard" is being required of. FM pro has live connectivity to MySQL, MS SQL Server and Oracle. for me, it doesn't make sense to speak about standard if you can move your data around from FM to other platforms and vice-versa.

well, this note can't make that much convincing. it's good to try it for yourself... especially now that FM has its new version 10\. believe me... you'll love it...

happy computing.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-02-01T22:05:18.957

很多关于 FileMaker 不标准的评论。但什么是“标准”？许多人所说的“标准”是指数据库支持结构化查询语言 (SQL)（ISO 标准 9075），而 FileMaker 已经并将继续支持 SQL。每个数据库引擎如何支持 SQL 是每个数据库专有的。现在它可能是开源的，例如 MySQL，但 SQL 是一个需要支持的标准，而不是实现它的底层语言。

当大多数人谈论数据库时，他们只是在谈论后端表和架构。前端用户界面通常是别的东西。他们中的大多数现在通过 PHP 等开放标准将这些结果呈现为 html 页面。同样，FileMaker 完全支持 PHP 调用和 Apache 或 IIS（取决于您使用的操作系统平台）。

所以我不同意人们说 FileMaker 是非标准的。

FileMaker 的独特之处在于其架构和用户界面之间的紧密集成。这类似于苹果在硬件和操作系统之间的紧密集成，它有一些不错的好处。有趣的是，FileMaker 归苹果所有，但我想这是另一个话题。

通常，FileMaker 的用户界面比大多数开放标准更容易使用，并且大多数人坚持使用 FileMaker 的客户端用户界面而不是 Web 界面。仍有许多仅在 FileMaker 用户界面中支持的内容无法在 Web 浏览器中复制。

FileMaker 将架构和用户界面紧密集成在一起，真正让快速应用程序开发变得更加容易。在大多数情况下，这使得开发成本大大降低。

FileMaker 的数据库服务最多可以分布在 3 台机器上，从而赋予它与 Web 服务的原始负载平衡能力。虽然 FileMaker 轻松支持数百个用户，但如果您同时处理数千个用户，许多仅 SQL 的数据库（例如 Oracle、MS SQL Server、MySQL、Postgres）旨在更好地将负载分散到更多机器上。基本上，如果您有高并发事务，FileMaker 不是您的解决方案。例如，一家拥有来自全县各地的多个销售点终端的公司同时访问它。

虽然 FileMaker 支持 SQL 和 PHP，但仅以这种方式使用它是在浪费用于 FileMaker 用户界面许可的资金。开发 Web 前端并仅为后端支付全部 FileMaker 许可费用并不是一种经济高效的解决方案。因此，FileMaker 对 PHP 和 SQL 的支持最好与那些为员工提供内部解决方案但又希望将其与外部客户的 Web 开发团队集成的公司结合使用。

最后一点是，FileMaker 将架构和用户界面紧密集成在一起，使安全性变得更加容易。显然，您必须设置组和用户，我通常将 FileMaker 与 Active Directory（或 Open Directory）集成。但是，当您使用 FileMaker 客户端和服务器连接时，打开加密安全是服务器上的一个复选框。FileMaker 处理所有证书并使用 AES 256 位密码（至少从版本 11 开始，可能在此之前也是如此）。目前，美国政府认为批准最高并包括第一级绝密通信。在典型的 SQL 系统中，在数据库端以及用户界面端配置安全性有很多工作，这比单个复选框要多得多。

FileMaker 的目标受众是中小型公司，通常拥有 5 到 200 名用户，对于这种规模的公司来说，它是一款价格合理的产品，可用于数据库的快速应用程序开发。

如果不评论在 iPad 和 iPhone 等 iOS 设备上创建和部署移动解决方案是多么容易，我就无法结束这篇评论。FileMaker Go 是一款可在这些移动设备上使用的免费应用程序，它们完全支持相同的用户界面和安全性。事实上，我知道一家公司使用 FileMaker 作为其 Oracle 数据库的前端接口，只是为了在 iPhone 上进行访问。对未来移动市场的期待会更多，而 FileMaker 显然针对的是移动用户。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-02-01T14:27:23.607

有两点似乎主导了这个讨论并且需要考虑：

非标准和政府机构正在做什么。

让我们考虑创建数据库以满足他们的需求的小企业主或单个用户。

现在不管政府在做什么，这是你的员工数据库。做你想做的（当然只要合法）。

非标准，通常这是最好的主意，因为你想做的事情对你有用。随心所欲地命名您的字段和表，然后根据您的喜好重命名。不要尝试使用 dbf 或 sql... 任何人都记得那些“标准”文件名 bks1999.dbf bks2000.dbf 请记住，“标准”的存在是因为其他人在您到达之前编写了它们，而不是因为它们是最好的主意。

是的，有很多“糟糕”的 Filemaker 解决方案，但它们正在工作并支持数十万人。但是尝试改进这些糟糕的解决方案之一，并比较改进类似糟糕的 dbf 解决方案的努力。重命名的字段可以轻松过滤相关 Filemaker 文件中的数千个脚本和脚本。在 dbf 解决方案中，它可能成为一场噩梦，因为每个实例都必须手动重新键入。

一项真正的测试是比较 Filemaker 与其他应用程序相比使用 SQL 等的难易程度。那可能很有趣。我从来没有这样做过，但我敢打赌，我可以在很短的时间内创建一个可以处理此类数据的工作文件。

我一直说每个开发人员都应该使用并熟悉所有的工具。

Filemaker Pro 25 年，FoxPro 3 年，4D 2 年，等等。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-01-06T20:46:22.373

只是将我的 2 美分添加到已经给出的答案中：**每个人在投票答案中写的关于 Filemaker 的所有内容都是真实的**。该产品足够强大，可以保证正面和负面的意见。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-08-03T20:18:09.760

我不是专业人士，无法解决您的顾虑，但您可能想查看许多用 FMP 编写的大型复杂应用程序。Jungle Software 是一个很好的起点。作为其中一些应用程序的用户，FMP 的缺点是它们带有一堆文件。FMP 应用程序的运行时没有打包为一个包，因此对于大型应用程序来说它看起来有点复杂。我们很久以前就做过一些测试，因为 FMP 以速度慢着称。当时（12 年前）FMP 需要为数据库建立索引，或者速度很慢，但一旦建立索引，它就和我们测试的其他任何东西一样快。对于半专业人士来说，最大的好处是很容易做基本的事情并最终得到工作工具。我对 Access 的体验非常消极，所以我根本不会将它与 FMP 进行比较。

最后，写什么并不重要，如果软件可以满足您的需求并且稳定，请购买它。如果没有。将数据输入和输出 FMP 非常容易，因此 db 格式的专有性并没有真正进入它。

# naming-conventions - 还有其他人发现命名类和方法是编程中最困难的部分之一吗？

> ID：421965
> 
> 赞同：288
> 
> 时间：2009-01-07T20:36:20.210
> 
> 标签：naming-conventions

所以我正在研究这个应该通过网络服务向供应商请求帮助文档的课程。我试着把它命名为`DocumentRetriever`, `VendorDocRequester`, `DocGetter`，但它们听起来不太对劲。我最终浏览了[dictionary.com](http://dictionary.com/)半小时，试图想出一个合适的词。

用坏名字开始编程就像早上头发很糟糕，一天的其余时间从那里走下坡路。感觉我？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-01-07T20:57:04.973

您现在所做的很好，我强烈建议您坚持当前的语法，即：

上下文+动词+如何

我使用这种方法来命名函数/方法、SQL 存储过程等。通过保持这种语法，它将使您的智能感知/代码窗格更加整洁。所以你想要EmployeeGetByID() EmployeeAdd(), EmployeeDeleteByID()。当您使用语法更正确的语法时，例如 GetEmployee()、AddEmployee()，您会发现如果在同一个类中有多个 Get，这会变得非常混乱，因为不相关的东西将被组合在一起。

这类似于用日期命名文件，你想说 2009-01-07.log 而不是 1-7-2009.log，因为在你拥有一堆文件之后，订单就变得完全没用了。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-01-08T11:19:31.957

我学到的一个教训是，如果你找不到一个类的名字，那么这个类几乎总是有问题：

*   你不需要它
*   它做得太多了

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2009-01-08T03:21:55.507

一个好的命名约定应该尽量减少可以用于任何给定变量、类、方法或函数的可能名称的数量。如果只有一个可能的名字，你永远不会有记住它的麻烦。

对于函数和单例类，我会仔细检查函数，看看它的基本功能是否是*将*一种事物转换为另一种事物。我非常宽松地使用该术语，但是您会发现您编写的大量函数本质上以一种形式获取某些内容并以另一种形式产生某些内容。

在您的情况下，听起来您的课程*将*Url 转换为 Document。这样想有点奇怪，但完全正确，当你开始寻找这种模式时，你会到处看到它。

当我找到这种模式时，我总是将函数命名为*x* `From`*y*。

由于您的函数*将*Url 转换为文档，因此我将其命名为

```
DocumentFromUrl 
```

这种模式非常普遍。例如：

```
atoi -> IntFromString
GetWindowWidth -> WidthInPixelsFromHwnd // or DxFromWnd if you like Hungarian
CreateProcess -> ProcessFromCommandLine 
```

`UrlToDocument`如果您对该订单更满意，也可以使用。你说*x* `From`*y*还是*y* `To`*x*可能是个人喜好问题，但我更喜欢`From`顺序，因为这样函数名的开头已经告诉你它返回什么类型。

选择一个约定并坚持下去。如果您在*x* `From`*y*函数中小心使用与类名相同的名称，那么记住您使用的名称会容易得多。当然，这种模式并不适用于所有情况，但它确实适用于您编写可以被认为是“函数式”的代码。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2009-01-07T20:41:52.647

有时一个类或方法没有一个好名字，它发生在我们所有人身上。然而，很多时候，无法想出一个名字可能暗示你的设计有问题。你的方法是否有太多的责任？您的课程是否包含一个连贯的想法？

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2009-01-07T21:07:38.150

线程 1：

```
function programming_job(){
    while (i make classes){
         Give each class a name quickly; always fairly long and descriptive.
         Implement and test each class to see what they really are. 
         while (not satisfied){
            Re-visit each class and make small adjustments 
         }
    }
} 
```

线程 2：

```
while(true){
      if (any code smells bad){
           rework, rename until at least somewhat better
      }
} 
```

这里的任何地方都没有 Thread.sleep(...) 。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2009-01-07T20:39:59.673

我确实花了很多时间来担心在我编程时可以命名的任何东西的名称。我会说它的回报非常好。有时当我被卡住时，我会暂时离开它，然后在喝咖啡休息时间时，我会问周围是否有人有好的建议。

对于你的课，我建议`VendorHelpDocRequester`。

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2009-01-07T22:06:28.297

[史蒂夫·麦康奈尔（Steve McConnell）的《代码完成](http://cc2e.com/)》一书有一章很好的关于命名变量/类/函数/...

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2009-05-30T22:52:36.080

我认为这是一个副作用。

实际命名并不难。困难的是，命名的过程让你面临一个可怕的事实，即你不知道自己到底在做什么。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2009-01-07T23:12:57.290

实际上，我昨天刚刚通过 37Signals 的[Signal vs. Noise](http://www.37signals.com/svn/)博客听到了这句话，我当然同意它：

“计算机科学中只有两个难点：缓存失效和命名。” — 菲尔·卡尔顿

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2009-01-07T20:40:40.013

难是好事。它迫使你思考这个问题，以及课程实际上应该做什么。好的名字可以帮助带来好的设计。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-01-07T20:41:45.317

同意。我喜欢让我的类型名称和变量尽可能具有描述性，而不会太长，但有时只是某个概念，你找不到合适的词。

在这种情况下，向同事征求意见总是有帮助的——即使他们最终没有帮助，它通常至少可以帮助我大声解释并让我的轮子转动。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2009-01-08T04:00:47.147

上个月我刚刚写了关于命名约定的文章：http: [//caseysoftware.com/blog/useful-naming-conventions](http://caseysoftware.com/blog/useful-naming-conventions)

它的要点：

**verbAdjectiveNounStructure** - 结构和形容词作为可选部分

对于**动词**，我坚持使用动作动词：保存、删除、通知、更新或生成。偶尔，我会使用“流程”，但仅专门指队列或工作积压。

对于**名词**，我使用与之交互的类或对象。在 web2project 中，这通常是任务或项目。如果是 Javascript 与页面交互，它可能是正文或表格。关键是代码清楚地描述了它正在与之交互的对象。

该**结构**是可选的，因为它是特定情况的。列表屏幕可能会请求列表或数组。web2project 的项目列表中使用的核心函数之一就是 getProjectList。它不会修改底层数据，只是数据的表示。

**形容词**完全是另外一回事。它们用作名词的修饰语。像 getOpenProjects 这样简单的东西可能很容易用 getProjects 和 switch 参数来实现，但这往往会生成需要对对象的底层数据和/或结构有相当多了解的方法......不一定是你想要的东西鼓励。通过拥有更明确和具体的功能，您可以完全包装和隐藏使用它的代码的实现。这不是OO的要点之一吗？

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-01-07T21:28:56.437

不仅仅是命名一个类，创建一个合适的包结构可能是一个困难但有益的挑战。您需要考虑分离模块的关注点以及它们与应用程序愿景的关系。

现在考虑您的应用程序的布局：

> *   应用程序
>     *   VendorDocRequester（从 Web 服务读取并提供数据）
>     *   VendorDocViewer（使用请求者提供供应商文档）

我冒昧地猜测，在几个班级里发生了很多事情。如果您要将其重构为更加 MVC 化的方法，并允许小类处理个人职责，您最终可能会得到如下结果：

> *   应用程序
>     *   供应商文档
>         *   模型
>             *   文档（保存数据的普通对象）
>             *   WebServiceConsumer（处理 Web 服务中的细节问题）
>         *   控制器
>             *   DatabaseAdapter（使用 ORM 或其他方法处理持久性）
>             *   WebServiceAdapter（利用消费者抓取一个文档并将其粘贴到数据库中）
>         *   看法
>             *   HelpViewer（使用 DBAdapter 吐出文档）

然后你的类名依赖命名空间来提供完整的上下文。类本身可以与应用程序固有地相关，而无需明确说明。结果，类名更简单，更容易定义！

另一个非常重要的建议：请帮自己一个忙，并拿起一份 Head First Design Patterns。这是一本非常棒且易于阅读的书，可帮助您组织应用程序并编写更好的代码。欣赏设计模式将帮助您了解您遇到的许多问题已经解决，并且您将能够将解决方案合并到您的代码中。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-01-08T02:59:49.610

Leo Brodie 在他的《Thinking Forth》一书中写道，对程序员来说最困难的任务就是给事物命名，他说最重要的编程工具是词库。

尝试使用[http://thesaurus.reference.com/](http://thesaurus.reference.com/)上的词库。

除此之外，永远不要使用匈牙利符号，避免缩写，并保持一致。

最良好的祝愿。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2009-01-08T09:35:01.043

**简而言之：**
我同意好名字很重要，但我认为您不必在不惜一切代价实施之前找到它们。

当然，最好从一开始就拥有一个好名字。但是如果你不能在 2 分钟内想出一个，那么稍后重命名将花费更少的时间，并且从生产力的角度来看是正确的选择。

**Long：**
一般来说，在实施之前考虑一个名字通常是不值得的。如果你实现你的类，将它命名为“Foo”或“Dsnfdkgx”，在实现时你会看到你应该给它起什么名字。

尤其是在 Java+Eclipse 中，重命名一点也不痛苦，因为它会仔细处理所有类中的所有引用，警告您名称冲突等。只要该类尚未在版本控制存储库中，我就不会不认为重命名 5 次有什么问题。

基本上，这是您如何看待重构的问题。就个人而言，我喜欢它，尽管它有时会惹恼我的队友，因为他们相信*永远不要碰正在运行的系统*。从您可以重构的所有内容来看，更改名称是您可以做的最无害的事情之一。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-01-07T20:41:18.140

为什么不用HelpDocumentServiceClient 或HelpDocumentClient……它是供应商并不重要，关键是它是处理帮助文档的Web 服务的客户端。

是的，命名很难。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-01-08T03:44:26.587

该类只有一个合理的名称：

```
HelpRequest 
```

不要让实现细节分散你的注意力。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-01-07T20:40:09.063

投资一个好的重构工具！

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-01-07T20:45:19.787

我坚持基础：动词名词（参数）。示例：GetDoc(docID)。

没必要花里胡哨。一年后，无论是你还是其他人，都会很容易理解。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-03-29T18:18:51.387

对我来说，我不在乎方法或类名与它的描述性和在正确的库中一样长。您应该记住 API 的每个部分所在位置的日子已经一去不复返了。

Intelisense 适用于所有主要语言。因此，当使用第 3 方 API 时，我喜欢将其 intelisense 用于文档，而不是使用“实际”文档。

考虑到这一点，我可以创建一个方法名称，例如

StevesPostOnMethodNames 做多或做空

长 - 但那又怎样。现在谁不用24寸屏幕！

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-01-07T20:39:52.200

我不得不同意命名是一门艺术。如果您的班级遵循某种“设计模式”（工厂等），它会变得容易一些。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-01-07T20:44:58.210

这是制定编码标准的原因之一。有一个标准往往有助于在需要时提出名称。它有助于解放您的思想，将其用于其他更有趣的事情！（-：

我建议阅读 Steve McConnell 的 Code Complete（[Amazon 链接](https://rads.stackoverflow.com/amzn/click/com/0735619670)）的相关章节，其中包含几个规则以提高可读性甚至可维护性。

高温高压

干杯，

抢

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-01-07T21:26:41.560

不，调试对我来说是最困难的事情！:-)

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-01-07T21:54:16.823

文档提取器？没有上下文很难说。

它可以帮助您像数学家一样行事，并在您进行的过程中为您的领域借用/发明一个词典：选择简短的简单单词来*暗示*这个概念，而无需每次都将其拼写出来。我经常看到很长的拉丁短语变成了首字母缩略词，这让你*无论如何*都需要一本关于首字母缩略词的字典。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-01-07T22:39:15.593

您用来描述问题的语言，是您应该用于变量、方法、对象、类等的语言。大致上，名词匹配对象，动词匹配方法。如果您缺少描述问题的词语，那么您也缺少对问题的完整理解（规范）。

如果它只是在一组名称之间进行选择，那么它应该由您用于构建系统的约定驱动。如果你来到了一个新的地方，之前的约定没有发现，那么总是值得花一些精力尝试扩展它们（正确地，一致地）以涵盖这个新案例。

如果有疑问，睡在上面，然后选择第一个最明显的名字，第二天早上:-)

如果有一天你醒来发现自己错了，那就马上改。

保罗。

顺便说一句： Document.fetch() 非常明显。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-01-07T22:49:28.053

我发现局部变量最麻烦。例如，我想创建一个 DocGetter 类型的对象。所以我知道这是一个DocGetter。为什么我需要给它另一个名字？我通常最终给它起一个名字，比如 dg（代表 DocGetter）或 temp 或同样不具描述性的名字。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-01-07T22:51:11.543

不要忘记设计模式（不仅仅是 GoF 模式）是提供通用词汇表的好方法，只要适合情况，就应该使用它们的名称。这甚至可以帮助熟悉命名法的新手快速理解架构。您正在研究的这个类是否应该像代理一样，甚至是 Façade ？

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-01-08T00:14:07.400

供应商文档不应该是对象吗？我的意思是，那个是有形的，而不仅仅是你程序的一部分的拟人化。因此，您可能有一个`VendorDocumentation`带有构造函数的类来获取信息。我认为，如果一个类名包含一个动词，通常会出现问题。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2009-05-30T22:47:25.480

我绝对感觉到你。我感觉到你的痛苦。我想到的每个名字对我来说都是垃圾。这一切看起来都很笼统，我想最终学会如何为我的名字注入一点天赋和创造力，让它们真正反映他们所描述的内容。

我的一个建议是查阅词库。Word 有一个很好的，Mac OS X 也有。这真的可以帮助我摆脱困境，给我一个好的起点和一些灵感。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-01-07T20:41:45.033

如果名称可以向外行程序员解释，那么可能不需要更改它。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-01-07T20:42:34.923

我不觉得难。如果你不能命名它，那么也许你不需要它。您的设计越好，就越容易命名您的设计所做的事情。

现在临时变量，这是一个不同的故事。:)

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-01-07T20:43:08.060

好吧，我从另一个角度看待它，如果您希望您的代码被其他人阅读，这是最重要的事情之一。

尝试使其具有描述性，如果它来自第三方，为什么不在类或方法名称中包含 [第三方的] 名称。

如果需要很长时间，只需使用任何名称，后缀即可更改。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-01-07T20:52:25.123

我感觉到你的痛苦。：/

我希望有一个工具可以结合数据字典（描述各种变量/方法名称的文件，我猜有点像 javadoc）来查看源代码，所以你可以编写如下代码：

```
class Battery 
{
   double I; // current
   double T; // temperature
   double V; // voltage
   double Q; // charge

   void update(double Inew, double dt) { I = Inew; Q += I*dt; }
   // ... etc ...
}; 
```

并且代码审查工具可以做许多不同的事情来更容易地在上下文中查看代码，包括显示 I = 当前的提醒（例如，在窗口右侧的窗格中，它将显示变量定义/semantics/comments 用于您单击的代码中的位置），甚至允许您进行“虚拟重构”，作为代码审查员，您可以出于可读性/显示原因重命名某些内容，而无需实际更改存储在磁盘。

尽管我喜欢自我描述的名字，但我讨厌阅读诸如`BatteryFilteredCurrentInMilliamps`. 通常在嵌入式系统中，我们基于代数方程对对象进行建模，而方程中的名称会变得非常麻烦。（另一方面，顶部带有帽子的“I”和下标“d”和上标“*”相当令人困惑。）

我是一名 EE / 系统工程师，首先负责少量软件职责，最后我真的不在乎变量的名称，只要我有一种方便的方式来告诉它是什么，并将其映射到我自己的内部模型中被控制的系统。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-01-07T20:53:23.157

这对我来说通常感觉很自然。我总是做很短的方法，从不超过 6 行 Smalltalk 代码（自动格式化），所以我真的很容易说出这个方法是关于什么的。

有时类名很困难，因为我要选择的词在系统的某个地方使用，因为有时同一个词在不同的上下文中具有不同的含义。我希望在这些情况下，允许一些类似维基百科的语法，所以我可以将我的类命名为“任务（待办事项列表项）”。在这合法之前，我用它制作了一个大的德语风格的词：ToDoListItemTask。您可能已经猜到了：我的方法名称也可能很长。但我认为它们是可读的。

因此，就您而言，您的班级是“吸气剂”或检索器，或其他任何东西。你确定这应该在课堂上建模吗？供应商文档不应该能够自己请求吗？像 vendorDoc.requestFrom(source); 会更容易命名，不是吗？

干杯，

尼可

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2009-01-07T21:20:02.913

当每个明智的名字看起来太长或模棱两可时，你可以尝试使用一些*不太*明智的东西，例如：

*   GoForHelpLassie 类
*   类 DunnoAskTechSupport
*   类 RTFVM [其中 V 代表供应商]

确保这个名字是*独一无二*的，并且在类的顶部有一个描述性的注释，因为在代码中看到它的任何人都需要查找它以找出它的作用（但是当他们这样做时，他们'可能会更容易记住）。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2009-01-07T21:54:04.763

每个软件开发人员都应该具备写作和沟通技巧的另一个原因。

PD：我相信丰富的词汇量也很重要。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2009-01-07T22:43:12.280

我要做的是检查它是否太长，如果我不记得它太长了

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2009-01-07T22:48:25.793

如果 10 个人中有 8 个人理解它，那么您可以放心地假设它是可以理解的、可读的和清晰的。总会有那些 1 或 2 挑剔的人会无缘无故地试图指责你，除了他们是小事之外。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2009-01-08T04:45:54.683

我发现一旦完成某件事，选择一个名字就更容易了。重构->重命名ftw。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2009-01-08T11:01:40.820

如果您是 .NET 开发人员，我强烈建议您阅读 BradA, Cwalina 的书 - 框架设计指南。这一切都在那里解释。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2009-01-09T10:46:27.530

只需总结“一个词”中的方法/类，回答它的含义是什么？这个词不应该有等价物。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2009-01-09T11:10:07.840

并不真地。考虑到你在编码中必须理解的所有困难的事情，说命名类和方法是编程中最困难的事情之一是荒谬的。不要误会我的意思，有时很难想出一个好名字，但让我们在这里真实。我会说它是编程中最简单的部分之一。

# java - 在 firefox 上运行特定版本的 java

> ID：421967
> 
> 赞同：1
> 
> 时间：2009-01-07T20:36:57.323
> 
> 标签：java, browser, applet

在 IE 中，我可以使用 classid "clsid:CAFEEFAC-0015-0000-0011-ABCDEFFEDCBA" 来告诉它使用 java 版本 1.5.0_11。Firefox 和其他浏览器是否有等价物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T03:35:44.467

> 我可以使用 classid "clsid:CAFEEFAC-0015-0000-0011-ABCDEFFEDCBA" 告诉它使用 java 版本 1.5.0_11

出于良好（安全）的原因，您不能再这样做了。请参阅[http://java.sun.com/javase/6/webnotes/deploy/deployment-policy.html](http://java.sun.com/javase/6/webnotes/deploy/deployment-policy.html)

一般来说，有一个 IE-only clsid 机制来请求“5.0_(something)” - [http://java.sun.com/javase/6/webnotes/family-clsid.html](http://java.sun.com/javase/6/webnotes/family-clsid.html)。这是在 5.0u7 中引入的，因此如果您安装了从 u7 开始的任何一个 JRE，您将获得此行为，否则您将获得旧的和不兼容的行为。

Sun 直到 6.0u10 才打算为其他浏览器提供类似的机制，当时他们添加了更多用于选择版本的机制并弃用了所有旧的机制，包括 5.0u7 系列选择器。有关所有血腥细节，请参阅[https://jdk6.dev.java.net/plugin2/version-selection/](https://jdk6.dev.java.net/plugin2/version-selection/)。

所以你得到什么行为不仅取决于浏览器和是否安装了你想要的JVM版本，还取决于安装了哪些其他版本。新行为至少是一致的，但它与之前的所有行为完全不同，并且不完全兼容。当您的应用程序的部署 HTML 已更新以应对它时，它们可能无论如何都可以与 1.6 一起使用。

所以总而言之，就像小程序一样，整个事情都是一团糟。耶。

# wpf - 模糊的不透明度

> ID：421968
> 
> 赞同：16
> 
> 时间：2009-01-07T20:37:12.407
> 
> 标签：wpf, .net-3.0

我需要创建一个透明的模糊背景。假设我有一个带有白色模糊透明背景的边框。边界后面的一切都是模糊的。

我试图避免依赖；我目前正在使用 .NET 3.0，并且希望它也可以与 XP 一起运行。

样机图片：

![样机图像](https://i.stack.imgur.com/rmKkp.png)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-07T23:08:00.870

VisualBrush 可用于接近您想要的，但有一些限制。

只要您只需要窗口内的玻璃效果（而不是其他窗口的效果）并且严格控制玻璃效果边框的位置，那么您可以这样做：-

```
 <Grid>
    <Border x:Name="src" Background="Silver">
      <Label HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="50">Hello World</Label>
    </Border>
    <Border Background="White" Margin="40" >
      <Border Opacity="0.5" >
          <Border.Effect>
            <BlurEffect Radius="10"/>
          </Border.Effect>
        <Border.Background>
          <VisualBrush  Visual="{Binding ElementName=src}" Stretch="None" />
        </Border.Background>
      </Border>
    </Border>
  </Grid> 
```

我不认为可视树中的子元素能够获得其父元素的 VisualBrush，因此这可能是您的限制。（即玻璃面板不能被背景面板包含）

我已经多次使用 VisualBrushes 通常与 TranslateTransforms 一起移动它们以在正确的位置获得正确的图像。

## 更新：

改用`XAML`，`Effect`而不是`BitmapEffect`更慢，现在已经贬值，正如 Steven Robbins 在下面的评论中提到的那样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T20:40:32.057

我想你需要为此使用一个效果，应用于背景矩形或网格。

如果它能让你的船漂浮，[这里](http://www.codeplex.com/wpffx)有一个不错的效果库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T20:42:10.370

使用[Vista 玻璃](http://blogs.msdn.com/adam_nathan/archive/2006/05/04/589686.aspx)。

# iphone - OpenGL ES/iPhone 的性能和背景图像

> ID：421969
> 
> 赞同：7
> 
> 时间：2009-01-07T20:37:26.947
> 
> 标签：iphone, opengl-es

我正在使用 OpenGL ES 为 iPhone 开发 2D 游戏，我想使用 320x480 位图图像作为持久背景。

我的第一个想法是创建一个 320x480 的四边形，然后在其上映射一个代表背景的纹理。所以...我创建了一个 512x512 的纹理，上面有一个 320x480 的图像。然后我将其映射到 320x480 四边形。

我每帧都绘制这个背景，然后在它上面绘制动画精灵。除了所有这些对象（背景+精灵）的绘制太慢之外，这很好用。

我做了一些测试，发现我的减速是在像素管道中。毫不奇怪，大背景图片是罪魁祸首。为了证明这一点，我删除了背景绘制，其他一切都渲染得非常快。

我正在寻找有关如何保持我的背景并提高绩效的建议。

这里有更多信息：

1）我目前正在模拟器上进行测试（仍在等待 Apple 获得许可）

2）背景是压缩到128k的PVR纹理

3）我曾希望有一种方法可以将此背景缓存到颜色缓冲区中，但没有任何运气。这可能是由于我对 OpenGL ES 缺乏经验，或者这可能是一个愚蠢的想法，行不通:)

4）我意识到整个背景并不总是需要刷新，只是被移动精灵绘制的部分。我开始研究刷新（根据需要）背景部分的技术，无论是作为单独的纹理还是使用剪刀框，但这似乎不够优雅。

任何提示/建议将不胜感激......

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-13T19:21:57.463

1.  **不要在模拟器上进行性能测试。曾经！**
    与真实硬件的差异是巨大的。在两个方向。
2.  如果每帧都绘制背景：
    不要清除帧缓冲区。无论如何，背景都会透支整个事物。
3.  你真的需要背景纹理吗？
    通过顶点颜色使用颜色渐变怎么样？
4.  尝试对纹理使用 2 位模式。
5.  关闭背景不需要的所有渲染步骤。
    例如：照明、混合、深度测试、...

如果您可以发布一些绘图代码，那么帮助您会容易得多。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-13T17:57:51.360

如果您正在制作 2D 游戏，是否有任何理由不使用现有库？具体来说，用于 iPhone 的 cocos2d 可能值得您花时间。我无法回答你关于如何自己解决问题的问题，但我可以说我已经用 cocos2d 完成了你所说的（有一个全屏背景，顶部有精灵）并且它有效伟大的。（假设 60 fps 对您来说足够快。）您可能有自己的理由，但如果可以的话，我强烈建议您至少使用 cocos2d 做一个快速原型，看看这是否对您没有帮助。（iPhone版本的详细信息和来源在这里：[http](http://code.google.com/p/cocos2d-iphone/) ://code.google.com/p/cocos2d-iphone/ ）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T16:44:19.987

感谢所有提供这方面信息的人。所有的建议都以一种或另一种方式有所帮助。

但是，我想明确指出，这里的主要问题是模拟器本身的行为（正如 Andreas 在他的回复中暗示的那样）。一旦我能够在设备上安装应用程序，它的性能就会好得多。我之所以提到这一点，是因为在开发我的游戏之前，我看到很多帖子表明该设备比模拟器慢得多。这在某些情况下可能是正确的（例如一般应用程序逻辑），但根据我的经验，动画（尤其是 3d 转换）在设备上要快得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T00:02:12.500

我对OpenGL ES没有太多经验，但是这个问题通常会发生。

您对“颜色缓冲区”的想法很直观，本质上您希望将背景存储为帧缓冲区，并在绘制前景之前将其直接加载到渲染缓冲区中。

在 OpenGL 中，这对于帧缓冲区对象 (FBO) 来说是相当直接的。不幸的是，我不认为 OpenGL ES 支持它们，但它可能会给你一个开始寻找的地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T14:26:35.313

您可能想尝试使用 VBO（顶点缓冲区对象）并查看是否可以加快速度。教程在[这里](http://www.ozone3d.net/tutorials/opengl_vbo_p1.php)

另外，我刚刚看到，从[OpenGL ES v1.1](http://www.khronos.org/opengles/1_X/)开始，有一个名为 glDrawTex (Draw Texture) 的函数是为

> 快速渲染游戏中的背景画、位图字体字形和 2D 框架元素

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T12:42:25.117

1.  您可以使用类似于 Apple 的 GLPaint 示例的帧缓冲区对象。
2.  使用纹理图集可以最大限度地减少绘制调用的次数。您可以使用 glTexCoordPointer 设置将每个图像映射到其正确位置的纹理坐标。记住也要设置你的顶点缓冲区。理想情况下，一次绘制调用将渲染您的整个 2D 场景。
3.  尽可能避免启用/禁用状态。

# drupal - 如何仅显示与视图 2 中关联的节点的分类术语？

> ID：421972
> 
> 赞同：8
> 
> 时间：2009-01-07T20:38:14.277
> 
> 标签：drupal, views, drupal-views

我创建了一个视图，其中显示了一组过滤器（以在页面中显示过滤选项）。其中一个过滤器是一个包含词汇表所有分类术语的选择字段。

没关系，现在正在显示。但我只想显示至少有一个节点与之关联的分类术语。如果选择一个空术语，以避免出现空结果。

有谁知道该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-02-05T18:47:35.703

视图 3 中的解决方案（可能适用于视图 2）

为视图设置关系以将术语连接到节点（在视图 3 中，这是“分类术语：包含术语的内容”）

然后在选项中勾选“需要这种关系”（这不包括没有任何节点的术语）

这可能会产生重复，在视图 3 中打开查询设置，并勾选 Distinct（这将省略重复）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-10T03:25:22.060

这对于 Views 来说将是一个很棒的功能，您应该为此向维护者提交功能请求。不幸的是，您无法使用现有的 Views 代码执行此操作。

\但是，您可以做的是查看 Views 如何在其自己的源代码中构造一个过滤器控件，并自己实现该功能并添加额外的检查以查看是否有任何带有该术语的帖子，而不是显示它如果没有的话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T04:37:39.953

这是一种更简单的方法。希望能帮助到你。

添加关系，过滤术语并选择“分类术语：代表节点”。检查“需要这种关系”，就是这样。如果有重复的术语，可以选择勾选“查询设置 > 不同”。

基于[http://www.waldbeek.com/blog/view-taxonomy-term-and-hide-empty-terms](http://www.waldbeek.com/blog/view-taxonomy-term-and-hide-empty-terms)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-09T08:22:33.690

对于视图 3，使用聚合变得非常简单！我发布这个回放是因为我花了很多时间来发现它。在这个截屏视频中，一切都得到了很好的解释：http: [//dev.nodeone.se/en/the-aggregation-setting-the-emmajane-episode](http://dev.nodeone.se/en/the-aggregation-setting-the-emmajane-episode)

# sql - Oracle 优化器会在同一个 SELECT 中使用多个提示吗？

> ID：421973
> 
> 赞同：20
> 
> 时间：2009-01-07T20:38:41.390
> 
> 标签：sql, oracle, optimization, hints

我正在尝试优化查询性能，不得不求助于使用优化器提示。但是我从来没有知道优化器是否一次会使用多个提示。

例如

```
SELECT /*+ INDEX(i dcf_vol_prospect_ids_idx)*/
       /*+ LEADING(i vol) */ 
       /*+ ALL_ROWS */ 
       i.id_number,
       ...
  FROM i_table i
  JOIN vol_table vol on vol.id_number = i.id_number
  JOIN to_a_bunch_of_other_tables...
 WHERE i.solicitor_id = '123'
   AND vol.solicitable_ind = 1; 
```

解释计划显示相同的成本，但我知道这只是一个估计。

请假设所有表和索引统计信息都已计算完毕。仅供参考，索引 dcf_vol_prospect_ids_idx 在 i.solicitor_id 列上。

谢谢，

炖

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-07T20:49:58.043

尝试在单个注释块中指定所有提示，如精彩的 Oracle 文档 ( [http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm](http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm) ) 中的示例所示。

> 16.2.1 指定一整套提示
> 
> 在使用提示时，在某些情况下，您可能需要指定一整套提示，以确保最佳执行计划。例如，如果您有一个非常复杂的查询，它由许多表连接组成，并且如果您只为给定表指定 INDEX 提示，那么优化器需要确定要使用的剩余访问路径，以及对应的加入方法。因此，即使您提供了 INDEX 提示，优化器也可能不一定使用该提示，因为优化器可能已确定由于优化器选择的连接方法和访问路径而无法使用请求的索引。
> 
> 在示例 16-1 中，LEADING 提示指定了要使用的确切连接顺序；还指定了要在不同表上使用的连接方法。
> 
> 示例 16-1 指定完整的提示集

```
SELECT /*+ LEADING(e2 e1) USE_NL(e1) INDEX(e1 emp_emp_id_pk)
           USE_MERGE(j) FULL(j) */
    e1.first_name, e1.last_name, j.job_id, sum(e2.salary) total_sal  
FROM employees e1, employees e2, job_history j
WHERE e1.employee_id = e2.manager_id
  AND e1.employee_id = j.employee_id
  AND e1.hire_date = j.start_date
GROUP BY e1.first_name, e1.last_name, j.job_id   ORDER BY total_sal; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-01-22T15:46:04.180

Oracle 19c 引入了[提示使用报告功能](https://blogs.oracle.com/optimizer/livesql-now-live-on-oracle-database-19c)：

```
EXPLAIN PLAN FOR
SELECT /*+ INDEX(i dcf_vol_prospect_ids_idx)*/
       /*+ LEADING(i vol) */ 
       /*+ ALL_ROWS */ 
       i.id_number,
       ...
  FROM i_table i
  JOIN vol_table vol on vol.id_number = i.id_number
  JOIN to_a_bunch_of_other_tables...
 WHERE i.solicitor_id = '123'
   AND vol.solicitable_ind = 1;

SELECT * FROM table(DBMS_XPLAN.DISPLAY(FORMAT=>'BASIC +HINT_REPORT'));
                                                     --============ 
```

它显示了另一部分`Hint Report`：

```
Hint Report (identified by operation id / Query Block Name / Object Alias):
Total hints for statement: ...
---------------------------------------------------
... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T22:47:24.673

事实上，基于成本的 Oracle Fundamentals 的作者 Jonathan Lewis 的建议是，如果 CBO 未能找到正确的计划，您需要接管 CBO 的工作并“嵌入”提示 - 平均查询中每个表有两个提示。

原因是，一个提示可能会导致另一个糟糕的甚至可能比 CBO 没有帮助的计划更糟糕。如果 CBO 错了，你需要给它整个计划，而不仅仅是朝着正确的方向轻推。

# open-source - 当我不允许被开源代码“污染”时，学习和编写代码的策略？

> ID：421975
> 
> 赞同：0
> 
> 时间：2009-01-07T20:39:07.163
> 
> 标签：open-source, licensing

我在一家公司工作，该公司的规则基本上是（据我了解）您不能使用任何代码，除非（a）您自己编写代码或（b）有一些明确的赔偿条款保护您使用任何其他代码（例如开源代码）。我发现这使我的编码变得困难。

例如，书中的编码示例几乎都是“按原样”使用的。Microsoft SDK 代码示例按“原样”使用。有关编码的博客文章按“原样”使用。有几个站点带有代码示例（包括 SO），使用风险自负。对知识产权诉讼、废话、废话等没有暗示的保证或赔偿。

基本上，我仅限于使用 Asp.Net 和 .Net Framework，仅此而已，并防止我的眼睛意外捡起我没有创建的东西（好吧……这可能是我对规则的肛门解释； -)。

我觉得这很困难，因为我认为学习编码的很大一部分是阅读其他代码。阅读有代码的博客，阅读有代码的书籍，查看编码示例，使用 SDK 示例中的代码等。此外，我认为使用人们已经证明是一个很好的解决方案或模式的代码是安全的，并且可以自由地使用供他人使用。我不会认为我可以自己编写所有代码。我绝对必须站在别人的编码肩膀上才能达到一定的高度。

可能是我也不太了解许可。从公司的角度来看（我想），他们不想承担任何因知识产权侵权而被起诉的风险。

我的想法是你必须权衡风险。从书中获取代码片段的风险很低。合并来自开源库的代码可能是高风险的。我说根据您愿意承担的风险做出决定。

有没有人在这样或类似的情况下工作过？这是罕见的事情还是在某些领域很常见？外面有没有和我一样位置的人？

任何见解或指导将不胜感激！谢谢！

**编辑：** 感谢您的回复！澄清一些事情：我不提倡窃取代码。我说的是具有某种公共许可的代码，允许以定义的合法方式使用它。关键是公共许可证在使用该代码时没有任何***赔偿。***这意味着您使用它需要您自己承担*法律*风险（和其他风险）。如果有人起诉您使用代码的开源项目，您也可能会被卷入诉讼，因为您正在使用该代码，即使它具有公共许可证。

2005 年，微软通过向其合作伙伴承诺微软将保护他们免受知识产权诉讼，利用赔偿与开源供应商竞争。[http://www.microsoft.com/presspass/press/2005/jun05/06-22PartnerIndemnificationPR.mspx](http://www.microsoft.com/presspass/press/2005/jun05/06-22PartnerIndemnificationPR.mspx "微软加强对合作伙伴的知识产权保护")

所以，即使被诉侵犯知识产权的风险可能极低，也属于非零概率。因此，我不能使用任何一个。即使它有某种公共许可证。:-(

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T21:06:26.670

“因侵犯知识产权而被起诉的风险”并不是真正的正确思考方式。这不是一个“风险”的事情。

任何一个

*   您有许可证并且可以使用源代码。没有风险。你有执照。不能打官司。

或者

*   你没有执照，你违反了。实际上，您*将*被起诉。这里也没有风险。您侵犯了某人的版权（或更糟）。

出于各种奇怪的原因，公司反对开源。诉讼风险不是其中之一。

我听说的事情。

*   如果它有病毒怎么办？

*   如果它没有像宣传的那样工作怎么办？

*   如果它“崩溃”了一些东西怎么办？我们起诉谁？

这些都不是“风险”项目。它们是“尽职调查”项目。大多数情况下，它们很容易解决：选择具有足够用户的产品，让其他人在你之前审查代码；QA 开源就像您自己的一个人输入的一样。除了一个。

这让我们找到了真正的原因。[提示：这不是“诉讼风险”。]

**当你没有对开源进行尽职调查时，没有人可以起诉。**

大多数商店都没有真正可靠的配置管理或 QA 政策（那种可以在法庭上被视为最佳实践的政策）。在他们准备好这些东西之前，他们不敢考虑引入真正需要可靠 QA 和配置管理的开源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T20:47:12.217

我认为您的公司真正担心的是您直接复制可能存在许可问题的大段代码，如果他们被发现使用它会给公司带来法律问题。但是，您可能会阅读博客或其他未经许可的代码，并发现适用于您正在处理的特定问题的解决方案。在这种情况下，您最好重写代码（即查看解决方案并重现它），而不是仅仅复制代码并对其进行修改。在我的公司，他们通常建议使用非专有代码。

同样，对于每个人都以相同方式实现的少量代码（例如缓存的标准实现），您的公司每次都不太可能害怕使用外部代码，只要您确保仔细测试即可.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T22:08:31.473

通过“赔偿”，我认为他们的意思是保证代码没有版权或专利，或者可能是他们事先不知道的商业秘密产权负担，或者如果出现类似情况，有人愿意赔偿他们。我从来没有在一家公司担心过这个问题，我以前也没有听说过。

目前还不清楚你在这里真正想要什么，除了同情（我确实对陷入企业愚蠢的人表示同情）。如果您担心书中的示例代码，听起来该政策非常严格。这是一个糟糕的政策，会阻碍你，但我不知道你能做些什么。与 Joel 的博客文章不同的是，在没有明显违反公司政策的情况下，您不能仅仅开始明智地做事。

不知道你的情况，我的建议是另找工作。这肯定会扼杀你的职业发展，而拥有该政策的公司不太可能对此感到合理。

（如果你能向他们保证没有危险就好了，但那不是真的。人们在版权问题上撒谎，尽管开源项目往往不会这样做，只有傻瓜才会肯定地声称一大块代码没有侵犯版权在美国的任何专利上；即使它是在软件专利首次授予前一年编写的，那也只是打官司的好理由，而不是避免打官司。GPL 软件实际上比 BSD 软件好，因为它下游需要一些专利授权，但是不能处理第三方专利。当然，如果他们那么担心被起诉，写内部软件是没有办法的，那会侵犯专利。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T20:48:33.197

您可以重命名变量，它们将如何发现？他们检查每一行代码吗？大学一直告诉你，不要在没有引用的情况下复制代码。为什么不尝试编写一些代码并使用在 Internet 上找到的部分代码？

通常，您将使用更多来自堆栈溢出或博客等社区的内容，而不是来自开源项目的内容。

最后，由于代码没有任何保证，风险自负。如果您自己提出代码，情况也是如此：风险自负。

希望这会有所帮助......祝你好运。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T21:01:48.193

> 可能是我也不太了解许可。从公司的角度来看（我想），他们不想承担任何因知识产权侵权而被起诉的风险。
> 
> 我的想法是你必须权衡风险。从书中获取代码片段的风险很低。合并来自开源库的代码可能是高风险的。我说根据您愿意承担的风险做出决定。

我不确定我是否理解正确。如果您说在不被抓到的情况下违反许可是可以的，我将不得不不同意您的看法。

您可以通过阅读代码来学习，而不会违反法律或被解雇。如果许可证不允许，请不要将代码复制到您公司的代码库中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T21:21:00.977

如果您不了解“洁净室”的概念，那么总会有这种方法。让朋友看看一些开源代码，让他们告诉你他们认为它是如何工作的。把它画出来，然后自己编码。

如果它适用于 IBM，对吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T21:41:27.270

请记住，并非所有开源都是 GPL。您的公司可以复制任意数量的 BSD 许可代码。BSD 许可的代码已经进入了 OS X（这可能是我今天最大的轻描淡写），并且在较小程度上进入了 Windows NT。

# asp.net - Model View Presenter 是使 asp.net UI 可测试的正确选择吗？

> ID：421979
> 
> 赞同：1
> 
> 时间：2009-01-07T20:39:29.360
> 
> 标签：asp.net, unit-testing, mvp

我已经阅读了很多关于 MVP 模式的文章。有人说它太复杂，有人说它已经过时了。但是对我来说，这似乎是提供对 UI 的单元测试访问的完美方式——这就是我的目标。

你用过 MVP，如果用过，你怎么看？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T20:51:08.073

模型视图展示器、模型视图控制器、传统的三层（UI/业务逻辑/数据存储）或几乎任何其他隔离代码的各种关注点的架构都可以帮助您编写测试。

通常架构在某种程度上取决于您的工具：Asp.Net MVP 标签似乎表明您已经在那里做出了选择。*在任何*配置中测试最棘手的部分是 UI，因为即使您创建了一个模拟 UI 来执行用户可以执行的所有功能......在某些时候，您必须在浏览器中呈现它并确保自己理论是正确的声音。

请注意，这并*没有*贬低模拟演示者 UI 的好处，它带有单元测试，可以执行用户将拥有的所有选项：这样做会让您比单独进行直接 UI 测试的人领先数年。另一方面，我还没有找到一个程序，它的 UI 在每个浏览器中总是按我们预期的那样呈现。找到这些案例仍然需要人工干预（或者在您完成初步运行后，充其量是 Selenium 或 Test Complete 之类的东西）。

关于“过时”方面，我认为这是一个红鲱鱼。关于架构选择当然存在宗教战争，但在一些 ASP.NET 项目中使用 MVP 的原因是有不少人认为传统的 ASP.NET 堆栈在 UI 和业务逻辑之间过于紧密集成. （我就是其中之一。）对于小型项目，紧密耦合并不是什么大不了的事，并且有助于表单设计器通过数据绑定快速“启动并运行”能力。在大型项目中，这些工具的局限性很快就会显现出来，并且在事后将“中间”层重新加入是一个挑战：你不必面对 MVP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T20:55:38.547

去年我使用 MVP 做了一个 ASP.NET 项目。是的，我能够比以前在网络表单世界中涵盖更多的单元测试，但它感觉很hacky。另外，试着向别人解释你在做什么。出于某种原因，人们很难理解它。如果我不得不重来一遍，我会选择 ASP.NET MVC 框架，因为它得到了大量文档和讨论的官方支持，而不仅仅是 hack。

# latex - 如何根据 LaTeX 中的状态变量定义输出？

> ID：421989
> 
> 赞同：3
> 
> 时间：2009-01-07T20:41:05.723
> 
> 标签：latex, tex, if-statement

我有一些标准文本，但其中的某些部分是不同的。但在这些不同的部分中，只有少数存在。

例如我想要：

```
\mytext{...}{a}

\mytext{...}{b} 
```

这会产生：

```
\section{Item: ...}\label{item...}
This is a standard item. Items of type a are very precious.

\section{Item: ...}\label{item...}
This is a standard item. Items of type b are cheap. 
```

一个简单的解决方案是定义命令 mytexta 和 mytextb，但由于我有更多选项，我想要更多的东西，比如编程语言中的 if 或 switch。有没有人解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T21:10:00.657

该`ifthen`包（包含在标准 LaTeX 安装中）定义了一个 command `\ifthenelse`，它的使用如下：

```
\usepackage{ifthen}
\ifthenelse{test}{then-code}{else-code} 
```

所以你可以做类似的事情：

```
\newcommand\mytext[1]{%
    \ifthenelse{\equal{#1}{a}}{very precious}{%
    \ifthenelse{\equal{#1}{b}}{cheap}{unknown}}} 
```

对于 LaTeX 编程，我建议获取一份[The LaTeX Companion](http://www.latex-project.org/guides/books.html)的副本。这对这些东西来说是一个很好的参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T21:00:00.707

您可以使用 \newif\ifoo 来声明一个新条件。然后\footrue 或\foofalse 将其设置为true 或false，你可以通过\iffoo ... \else ... \fi 来使用它。

还有更多条件，请参阅 TeXbook 中的第 209 页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-15T17:43:01.943

另一种选择是使用`etoolbox`（与 XeLaTeX 一起使用），下面是一个 MWE

```
\documentclass{article}

\usepackage{etoolbox}

\begin{document}

\newcommand{\mytext}[1]
{
\ifstrequal{#1}{a} %% make the first comparison
{ %% print text in the first scenario
\section{Item: #1}\label{item.#1}
This is a standard item. Items of type a are very precious.
}
{} %% do nothing if false
\ifstrequal{#1}{b} %% make the second comparison
{ %% print text in the second scenario
\section{Item: #1}\label{item.#1}
This is a standard item. Items of type b are cheap.
}
{} %% do nothing if false
}

\mytext{a}
\mytext{b}
\\

\noindent
We can refer to sections \ref{item.a} and \ref{item.b}

\end{document} 
```

它产生

[![我的文本](https://i.stack.imgur.com/m9WnG.jpg)](https://i.stack.imgur.com/m9WnG.jpg)*****`