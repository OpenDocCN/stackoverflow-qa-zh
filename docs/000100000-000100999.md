# StackOverflow 问答 100000-100999

# web-frameworks - MVC 还是事件驱动的面向组件的 Web 框架？

> ID：100001
> 
> 赞同：5
> 
> 时间：2008-09-19T06:10:16.207
> 
> 标签：web-frameworks

这个问题与技术无关。您更喜欢哪种 Web 框架，以及何时：*纯 MVC 还是面向事件驱动的组件？*

只是为了说明“技术不可知论”，在这里我列举了一些 MVC 与组件 Web 框架，它们采用不同的技术/语言：

*   Struts**与**Java Server Faces / Tapestry
*   新的 ASP.NET MVC**与**“经典” ASP.NET
*   Cake PHP**与**PRADO

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T00:27:14.007

我白天是 php 开发人员；但是，我更喜欢 Wicket 和/或 Lift，尤其是后者。Prado 的问题似乎是控制器绑定到页面，而不是页面上的逻辑控件，否则，它似乎仍然比 PHP 领域的大多数其他选项更好。我认为一切都归结为可重用性，除非您拥有由控制器支持的组件，否则您无法将显示与支持控制逻辑完全分开。

所有这些“MVC”框架实现的 MVC 似乎很糟糕，你得到一个带有大量控件的逻辑页面，你必须处理页面控制器上的所有这些，哇，谢谢，现在我有了 MVC / n，其中 n 是控件的数量。到目前为止，我看到的大多数“MVC”系统都是脑死亡标签库的混搭，将请求响应扭曲到必须了解页面上所有内容的单个控制器中。

xhtml 模板与 js 和 css 完美分离。除了支持这些组件的一些类之外，突然之间，您不再忙于想知道复杂的页面将如何工作，或者您是否想将部分 x 放到其他地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T06:15:41.137

现在，“新热点”趋势是朝着 MVC 方法发展。我个人更喜欢 MVC 框架的约定，因为很多占用宝贵开发时间的杂乱无章的工作都被取消了。话虽如此，约束往往相当严格，在某些情况下可能需要更传统的基于组件的方法。总而言之，它是工作选择的正确工具。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T06:29:53.460

使用的技术通常不是选择问题，尤其是在大公司中，您没有太多选择。

如果我能够选择一种技术，在 Java 中我会选择 Wicket。我一直在使用 Spring MVC，它很好，但是 Wicket 有一个 Spring MVC 没有的简洁特性：服务器端状态管理和封装，丰富的组件模型，没有不必要的 XML 映射文件——只有纯 Java 和 HTML。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T10:10:05.303

就我个人而言，我会说 MVC 是网站的必经之路。您可以更好地控制 HTML 和 CSS，同时控制器模式与 HTTP 配合得很好。事件驱动的 Web 编程非常适合小型网站或不熟悉 HTML 和 CSS 以及更底层概念的人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T07:25:27.850

我主要是 ASP.Net 开发人员，但我发现 MVC 是创建功能复杂的网站（通常是业务线类型的网站）的更好方法，因为它允许更好地将业务逻辑和规则与用于显示的标记分开数据给最终用户。对于快速而肮脏的站点（通常与数据库直接连接）或更丰富的接口，“*事件驱动的面向组件*”模型更有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T06:28:51.183

我大致遵循以下准则：

*   Web Forms/SQLDataSource - 内部使用的快速而肮脏的应用程序，用于显示报告或其他一些此类数据。
*   MVC - 核心产品的简单到复杂的业务逻辑。
*   MVC/REST Web 服务/jQuery-HTML/任何类型的客户端 RIA（当用户体验至高无上时）。
*   Flash/Flex RIA - 当需要一个非常丰富的客户端时很有用（想想这里的多媒体操作）。

当然，这个列表中有很多空白，但这只是代表了一个问题的复杂程度。

# python - Python 中的元类是什么？

> ID：100003
> 
> 赞同：6653
> 
> 时间：2008-09-19T06:10:46.830
> 
> 标签：python, oop, metaclass, python-class, python-datamodel

在 Python 中，什么是元类，我们用它们做什么？

* * *

## 回答 #1

> 赞同：7906
> 
> 时间：2011-07-05T11:29:50.927

# 作为对象的类

在了解元类之前，您需要掌握 Python 中的类。Python 对什么是类有一个非常奇特的想法，这是从 Smalltalk 语言中借来的。

在大多数语言中，类只是描述如何生成对象的代码片段。在 Python 中也是如此：

```
>>> class ObjectCreator(object):
...       pass
...

>>> my_object = ObjectCreator()
>>> print(my_object)
<__main__.ObjectCreator object at 0x8974f2c> 
```

但是类不仅仅是 Python 中的类。类也是对象。

是的，对象。

只要您使用关键字`class`，Python 就会执行它并创建一个**对象**。该指令

```
>>> class ObjectCreator(object):
...       pass
... 
```

在内存中创建一个名为 的对象`ObjectCreator`。

**这个对象（类）本身能够创建对象（实例），这就是为什么它是一个类**。

但是，它仍然是一个对象，因此：

*   您可以将其分配给变量
*   你可以复制它
*   您可以为其添加属性
*   您可以将其作为函数参数传递

例如：

```
>>> print(ObjectCreator) # you can print a class because it's an object
<class '__main__.ObjectCreator'>
>>> def echo(o):
...       print(o)
...
>>> echo(ObjectCreator) # you can pass a class as a parameter
<class '__main__.ObjectCreator'>
>>> print(hasattr(ObjectCreator, 'new_attribute'))
False
>>> ObjectCreator.new_attribute = 'foo' # you can add attributes to a class
>>> print(hasattr(ObjectCreator, 'new_attribute'))
True
>>> print(ObjectCreator.new_attribute)
foo
>>> ObjectCreatorMirror = ObjectCreator # you can assign a class to a variable
>>> print(ObjectCreatorMirror.new_attribute)
foo
>>> print(ObjectCreatorMirror())
<__main__.ObjectCreator object at 0x8997b4c> 
```

# 动态创建类

由于类是对象，因此您可以像任何对象一样动态创建它们。

首先，您可以使用以下方法在函数中创建一个类`class`：

```
>>> def choose_class(name):
...     if name == 'foo':
...         class Foo(object):
...             pass
...         return Foo # return the class, not an instance
...     else:
...         class Bar(object):
...             pass
...         return Bar
...
>>> MyClass = choose_class('foo')
>>> print(MyClass) # the function returns a class, not an instance
<class '__main__.Foo'>
>>> print(MyClass()) # you can create an object from this class
<__main__.Foo object at 0x89c6d4c> 
```

但它不是那么动态的，因为你仍然需要自己编写整个类。

由于类是对象，因此它们必须由某些东西生成。

当您使用`class`关键字时，Python 会自动创建此对象。但与 Python 中的大多数事情一样，它为您提供了一种手动完成的方法。

还记得函数`type`吗？让您知道对象是什么类型的旧函数：

```
>>> print(type(1))
<type 'int'>
>>> print(type("1"))
<type 'str'>
>>> print(type(ObjectCreator))
<type 'type'>
>>> print(type(ObjectCreator()))
<class '__main__.ObjectCreator'> 
```

嗯，[`type`](http://docs.python.org/2/library/functions.html#type)有一个完全不同的能力，它也可以在运行中创建类。`type`可以将类的描述作为参数，返回一个类。

（我知道，根据您传递给它的参数，同一个函数可以有两种完全不同的用途，这是愚蠢的。由于 Python 的向后兼容性，这是一个问题）

`type`以这种方式工作：

```
type(name, bases, attrs) 
```

在哪里：

*   **`name`**: 类名
*   **`bases`**: 父类的元组（用于继承，可以为空）
*   **`attrs`**: 包含属性名称和值的字典

例如：

```
>>> class MyShinyClass(object):
...       pass 
```

可以通过这种方式手动创建：

```
>>> MyShinyClass = type('MyShinyClass', (), {}) # returns a class object
>>> print(MyShinyClass)
<class '__main__.MyShinyClass'>
>>> print(MyShinyClass()) # create an instance with the class
<__main__.MyShinyClass object at 0x8997cec> 
```

您会注意到我们使用`MyShinyClass`了类名和保存类引用的变量。它们可以不同，但​​没有理由使事情复杂化。

`type`接受一个字典来定义类的属性。所以：

```
>>> class Foo(object):
...       bar = True 
```

可以翻译成：

```
>>> Foo = type('Foo', (), {'bar':True}) 
```

并用作普通类：

```
>>> print(Foo)
<class '__main__.Foo'>
>>> print(Foo.bar)
True
>>> f = Foo()
>>> print(f)
<__main__.Foo object at 0x8a9b84c>
>>> print(f.bar)
True 
```

当然，你可以继承它，所以：

```
>>>   class FooChild(Foo):
...         pass 
```

将会：

```
>>> FooChild = type('FooChild', (Foo,), {})
>>> print(FooChild)
<class '__main__.FooChild'>
>>> print(FooChild.bar) # bar is inherited from Foo
True 
```

最终，你会想要为你的类添加方法。只需定义一个具有适当签名的函数并将其分配为属性。

```
>>> def echo_bar(self):
...       print(self.bar)
...
>>> FooChild = type('FooChild', (Foo,), {'echo_bar': echo_bar})
>>> hasattr(Foo, 'echo_bar')
False
>>> hasattr(FooChild, 'echo_bar')
True
>>> my_foo = FooChild()
>>> my_foo.echo_bar()
True 
```

并且你可以在动态创建类之后添加更多的方法，就像在正常创建的类对象中添加方法一样。

```
>>> def echo_bar_more(self):
...       print('yet another method')
...
>>> FooChild.echo_bar_more = echo_bar_more
>>> hasattr(FooChild, 'echo_bar_more')
True 
```

你知道我们要去哪里：在 Python 中，类是对象，你可以动态地创建一个类。

这就是 Python 在使用关键字时`class`所做的事情，它通过使用元类来做到这一点。

# 什么是元类（最后）

元类是创建类的“东西”。

你定义类是为了创建对象，对吧？

但是我们了解到 Python 类是对象。

好吧，元类是创建这些对象的原因。它们是班级的班级，您可以这样描绘它们：

```
MyClass = MetaClass()
my_object = MyClass() 
```

您已经看到，它`type`可以让您执行以下操作：

```
MyClass = type('MyClass', (), {}) 
```

这是因为该函数`type`实际上是一个元类。`type`是 Python 用来在幕后创建所有类的元类。

现在你想知道“为什么它是小写的，而不是小写的`Type`？”

好吧，我想这是与`str`创建字符串对象`int`的类和创建整数对象的类的一致性问题。`type`只是创建类对象的类。

您可以通过检查`__class__`属性看到这一点。

一切，我的意思是一切，都是 Python 中的对象。这包括整数、字符串、函数和类。它们都是对象。所有这些都是从一个类创建的：

```
>>> age = 35
>>> age.__class__
<type 'int'>
>>> name = 'bob'
>>> name.__class__
<type 'str'>
>>> def foo(): pass
>>> foo.__class__
<type 'function'>
>>> class Bar(object): pass
>>> b = Bar()
>>> b.__class__
<class '__main__.Bar'> 
```

现在， any 是`__class__`什么`__class__`？

```
>>> age.__class__.__class__
<type 'type'>
>>> name.__class__.__class__
<type 'type'>
>>> foo.__class__.__class__
<type 'type'>
>>> b.__class__.__class__
<type 'type'> 
```

因此，元类只是创建类对象的东西。

如果你愿意，你可以称它为“类工厂”。

`type`是 Python 使用的内置元类，但当然，您可以创建自己的元类。

# [`__metaclass__`](http://docs.python.org/2/reference/datamodel.html?highlight=__metaclass__#__metaclass__)属性_

在 Python 2 中，您可以`__metaclass__`在编写类时添加属性（请参阅下一节了解 Python 3 语法）：

```
class Foo(object):
    __metaclass__ = something...
    [...] 
```

如果这样做，Python 将使用元类来创建类`Foo`。

小心，这很棘手。

您先编写，但尚未在内存中创建`class Foo(object)`类对象。`Foo`

Python 将`__metaclass__`在类定义中查找。如果找到它，它将使用它来创建对象类`Foo`。如果没有，它将 `type`用于创建类。

多读几遍。

当你这样做时：

```
class Foo(Bar):
    pass 
```

Python 执行以下操作：

中是否有`__metaclass__`属性`Foo`？

如果是，则在内存中创建一个类对象（我说的是类对象，请留在我这里），其名称`Foo`使用`__metaclass__`.

如果 Python 找不到`__metaclass__`，它将`__metaclass__`在 MODULE 级别查找 a ，并尝试做同样的事情（但仅适用于不继承任何东西的类，基本上是旧式类）。

然后，如果它根本找不到任何`__metaclass__`东西，它将使用`Bar`'s（第一个父级）自己的元类（可能是默认的`type`）来创建类对象。

注意这里的`__metaclass__`属性不会被继承，父类（`Bar.__class__`）的元类会被继承。如果`Bar`使用使用（而不是）创建的属性，`__metaclass__`子类将不会继承该行为。`Bar``type()``type.__new__()`

现在最大的问题是，你能放`__metaclass__`什么？

答案是可以创建类的东西。

什么可以创建一个类？`type`，或任何子类或使用它的东西。

# Python 3 中的元类

Python 3 中设置元类的语法已更改：

```
class Foo(object, metaclass=something):
    ... 
```

即`__metaclass__`不再使用该属性，取而代之的是基类列表中的关键字参数。

然而，元类的行为基本保持[不变](https://www.python.org/dev/peps/pep-3115/)。

在 Python 3 中添加到元类的一件事是，您还可以将属性作为关键字参数传递给元类，如下所示：

```
class Foo(object, metaclass=something, kwarg1=value1, kwarg2=value2):
    ... 
```

阅读下面的部分，了解 Python 如何处理这个问题。

# 自定义元类

元类的主要目的是在创建类时自动更改它。

您通常为 API 执行此操作，您希望在其中创建与当前上下文匹配的类。

想象一个愚蠢的例子，你决定模块中的所有类的属性都应该用大写字母写。有几种方法可以做到这一点，但一种方法是`__metaclass__`在模块级别进行设置。

这样，这个模块的所有类都将使用这个元类创建，我们只需要告诉元类将所有属性都转为大写即可。

幸运的是，`__metaclass__`实际上可以是任何可调用的，它不需要是一个正式的类（我知道，名称中带有“类”的东西不需要是一个类，去看看......但它很有帮助）。

所以我们将从一个简单的例子开始，使用一个函数。

```
# the metaclass will automatically get passed the same argument
# that you usually pass to `type`
def upper_attr(future_class_name, future_class_parents, future_class_attrs):
    """
      Return a class object, with the list of its attribute turned
      into uppercase.
    """
    # pick up any attribute that doesn't start with '__' and uppercase it
    uppercase_attrs = {
        attr if attr.startswith("__") else attr.upper(): v
        for attr, v in future_class_attrs.items()
    }

    # let `type` do the class creation
    return type(future_class_name, future_class_parents, uppercase_attrs)

__metaclass__ = upper_attr # this will affect all classes in the module

class Foo(): # global __metaclass__ won't work with "object" though
    # but we can define __metaclass__ here instead to affect only this class
    # and this will work with "object" children
    bar = 'bip' 
```

让我们检查：

```
>>> hasattr(Foo, 'bar')
False
>>> hasattr(Foo, 'BAR')
True
>>> Foo.BAR
'bip' 
```

现在，让我们做同样的事情，但使用一个真正的类作为元类：

```
# remember that `type` is actually a class like `str` and `int`
# so you can inherit from it
class UpperAttrMetaclass(type):
    # __new__ is the method called before __init__
    # it's the method that creates the object and returns it
    # while __init__ just initializes the object passed as parameter
    # you rarely use __new__, except when you want to control how the object
    # is created.
    # here the created object is the class, and we want to customize it
    # so we override __new__
    # you can do some stuff in __init__ too if you wish
    # some advanced use involves overriding __call__ as well, but we won't
    # see this
    def __new__(upperattr_metaclass, future_class_name,
                future_class_parents, future_class_attrs):
        uppercase_attrs = {
            attr if attr.startswith("__") else attr.upper(): v
            for attr, v in future_class_attrs.items()
        }
        return type(future_class_name, future_class_parents, uppercase_attrs) 
```

让我们重写上面的内容，但是现在我们知道它们的含义，使用更短和更真实的变量名称：

```
class UpperAttrMetaclass(type):
    def __new__(cls, clsname, bases, attrs):
        uppercase_attrs = {
            attr if attr.startswith("__") else attr.upper(): v
            for attr, v in attrs.items()
        }
        return type(clsname, bases, uppercase_attrs) 
```

您可能已经注意到额外的参数`cls`。它没有什么特别之处：`__new__`总是接收它定义的类，作为第一个参数。就像您`self`对接收实例作为第一个参数的普通方法或类方法的定义类一样。

但这不是正确的 OOP。我们`type`直接调用，我们没有覆盖或调用父级的`__new__`. 让我们这样做：

```
class UpperAttrMetaclass(type):
    def __new__(cls, clsname, bases, attrs):
        uppercase_attrs = {
            attr if attr.startswith("__") else attr.upper(): v
            for attr, v in attrs.items()
        }
        return type.__new__(cls, clsname, bases, uppercase_attrs) 
```

我们可以通过 using 使其更简洁`super`，这将简化继承（因为是的，您可以拥有元类，从元类继承，从类型继承）：

```
class UpperAttrMetaclass(type):
    def __new__(cls, clsname, bases, attrs):
        uppercase_attrs = {
            attr if attr.startswith("__") else attr.upper(): v
            for attr, v in attrs.items()
        }
        return super(UpperAttrMetaclass, cls).__new__(
            cls, clsname, bases, uppercase_attrs) 
```

哦，在 Python 3 中，如果您使用关键字参数进行此调用，如下所示：

```
class Foo(object, metaclass=MyMetaclass, kwarg1=value1):
    ... 
```

它在元类中转换为 this 以使用它：

```
class MyMetaclass(type):
    def __new__(cls, clsname, bases, dct, kwargs1=default):
        ... 
```

就是这样。元类真的没有更多的东西了。

使用元类的代码复杂性背后的原因不是因为元类，而是因为您通常使用元类来做一些扭曲的事情，依赖于自省、操作继承、vars 等`__dict__`。

事实上，元类对于做黑魔法特别有用，因此也很复杂。但就其本身而言，它们很简单：

*   拦截类创建
*   修改类
*   返回修改后的类

# 为什么要使用元类类而不是函数？

既然`__metaclass__`可以接受任何可调用的，为什么要使用一个类，因为它显然更复杂？

这样做有几个原因：

*   意图很明确。当你阅读时`UpperAttrMetaclass(type)`，你知道接下来会发生什么
*   您可以使用 OOP。元类可以继承元类，覆盖父方法。元类甚至可以使用元类。
*   如果您指定了元类类，则类的子类将是其元类的实例，但不使用元类函数。
*   您可以更好地构建代码。您永远不会将元类用于像上面的示例这样微不足道的事情。它通常用于复杂的事情。能够创建多个方法并将它们分组到一个类中对于使代码更易于阅读非常有用。
*   你可以挂上`__new__`,`__init__`和`__call__`。这将使您可以做不同的事情，即使通常您可以全部完成`__new__`，但有些人使用起来更舒服`__init__`。
*   这些被称为元类，该死！一定是什么意思！

# 为什么要使用元类？

现在是个大问题。为什么要使用一些晦涩易错的功能？

好吧，通常你不会：

> 元类是更深层次的魔法，99% 的用户都不应该担心它。如果你想知道你是否需要它们，你不需要（实际上需要它们的人肯定知道他们需要它们并且不需要解释为什么）。

*Python 大师蒂姆·彼得斯*

元类的主要用例是创建 API。一个典型的例子是 Django ORM。它允许您定义如下内容：

```
class Person(models.Model):
    name = models.CharField(max_length=30)
    age = models.IntegerField() 
```

但如果你这样做：

```
person = Person(name='bob', age='35')
print(person.age) 
```

它不会返回`IntegerField`对象。它将返回一个`int`，甚至可以直接从数据库中获取。

这是可能的，因为`models.Model`定义`__metaclass__`并且它使用了一些魔法，将`Person`您刚刚使用简单语句定义的内容转换为数据库字段的复杂挂钩。

Django 通过公开一个简单的 API 并使用元类，从这个 API 重新创建代码来完成幕后的真正工作，让复杂的事情看起来很简单。

# 最后一个字

首先，您知道类是可以创建实例的对象。

好吧，事实上，类本身就是实例。元类。

```
>>> class Foo(object): pass
>>> id(Foo)
142630324 
```

Python 中的一切都是对象，它们要么是类的实例，要么是元类的实例。

除了`type`.

`type`实际上是它自己的元类。这不是您可以在纯 Python 中重现的东西，而是通过在实现级别上作弊来完成的。

其次，元类很复杂。您可能不想将它们用于非常简单的类更改。您可以使用两种不同的技术更改类：

*   [猴子补丁](http://en.wikipedia.org/wiki/Monkey_patch)
*   类装饰器

99% 的时间你需要改变班级，你最好使用这些。

但是 98% 的情况下，您根本不需要更改班级。

* * *

## 回答 #2

> 赞同：3342
> 
> 时间：2008-09-19T07:01:58.623

元类是类的类。类定义类的实例（即对象）的行为方式，而元类定义类的行为方式。类是元类的一个实例。

在 Python 中，您可以对元类使用任意可调用对象（如[Jerub](https://stackoverflow.com/questions/100003/what-is-a-metaclass-in-python/100037#100037)所示），更好的方法是使其本身成为实际类。`type`是 Python 中常用的元类。`type`它本身就是一个类，它是它自己的类型。您将无法重新创建`type`纯粹在 Python 中的东西，但 Python 会作弊。要在 Python 中创建自己的元类，你真的只想继承`type`.

元类最常用作类工厂。当您通过调用类创建对象时，Python 通过调用元类创建一个新类（当它执行“类”语句时）。结合普通`__init__`和`__new__`方法，元类因此允许您在创建类时做“额外的事情”，例如使用某个注册表注册新类或完全用其他东西替换该类。

执行语句时`class`，Python 首先将`class`语句体作为普通代码块执行。生成的命名空间（一个字典）保存了类的属性。元类是通过查看待定类的基类（继承元类）、待定类的`__metaclass__`属性（如果有）或`__metaclass__`全局变量来确定的。然后使用类的名称、基类和属性调用元类以实例化它。

然而，元类实际上定义了一个类的*类型*，而不仅仅是它的工厂，所以你可以用它们做更多的事情。例如，您可以在元类上定义普通方法。这些元类方法类似于类方法，因为它们可以在没有实例的类上调用，但它们也不像类方法，因为它们不能在类的实例上调用。是元类`type.__subclasses__()`上的方法的示例。`type`您还可以定义普通的“魔术”方法，如和`__add__`，以实现或更改类的行为方式。`__iter__``__getattr__`

下面是一个点点滴滴的汇总示例：

```
def make_hook(f):
    """Decorator to turn 'foo' method into '__foo__'"""
    f.is_hook = 1
    return f

class MyType(type):
    def __new__(mcls, name, bases, attrs):

        if name.startswith('None'):
            return None

        # Go over attributes and see if they should be renamed.
        newattrs = {}
        for attrname, attrvalue in attrs.iteritems():
            if getattr(attrvalue, 'is_hook', 0):
                newattrs['__%s__' % attrname] = attrvalue
            else:
                newattrs[attrname] = attrvalue

        return super(MyType, mcls).__new__(mcls, name, bases, newattrs)

    def __init__(self, name, bases, attrs):
        super(MyType, self).__init__(name, bases, attrs)

        # classregistry.register(self, self.interfaces)
        print "Would register class %s now." % self

    def __add__(self, other):
        class AutoClass(self, other):
            pass
        return AutoClass
        # Alternatively, to autogenerate the classname as well as the class:
        # return type(self.__name__ + other.__name__, (self, other), {})

    def unregister(self):
        # classregistry.unregister(self)
        print "Would unregister class %s now." % self

class MyObject:
    __metaclass__ = MyType

class NoneSample(MyObject):
    pass

# Will print "NoneType None"
print type(NoneSample), repr(NoneSample)

class Example(MyObject):
    def __init__(self, value):
        self.value = value
    @make_hook
    def add(self, other):
        return self.__class__(self.value + other.value)

# Will unregister the class
Example.unregister()

inst = Example(10)
# Will fail with an AttributeError
#inst.unregister()

print inst + inst
class Sibling(MyObject):
    pass

ExampleSibling = Example + Sibling
# ExampleSibling is now a subclass of both Example and Sibling (with no
# content of its own) although it will believe it's called 'AutoClass'
print ExampleSibling
print ExampleSibling.__mro__ 
```

* * *

## 回答 #3

> 赞同：455
> 
> 时间：2008-09-19T06:26:10.537

*请注意，此答案适用于 Python 2.x，因为它是在 2008 年编写的，元类在 3.x 中略有不同。*

元类是让“类”发挥作用的秘诀。新样式对象的默认元类称为“类型”。

```
class type(object)
  |  type(object) -> the object's type
  |  type(name, bases, dict) -> a new type 
```

元类需要 3 个参数。' **name** '、' **bases** ' 和 ' **dict** '

这里是秘密开始的地方。在这个示例类定义中查找名称、基数和字典的来源。

```
class ThisIsTheName(Bases, Are, Here):
    All_the_code_here
    def doesIs(create, a):
        dict 
```

让我们定义一个元类来演示“**类：** ”如何调用它。

```
def test_metaclass(name, bases, dict):
    print 'The Class Name is', name
    print 'The Class Bases are', bases
    print 'The dict has', len(dict), 'elems, the keys are', dict.keys()

    return "yellow"

class TestName(object, None, int, 1):
    __metaclass__ = test_metaclass
    foo = 1
    def baz(self, arr):
        pass

print 'TestName = ', repr(TestName)

# output => 
The Class Name is TestName
The Class Bases are (<type 'object'>, None, <type 'int'>, 1)
The dict has 4 elems, the keys are ['baz', '__module__', 'foo', '__metaclass__']
TestName =  'yellow' 
```

现在，一个真正有意义的例子，这将自动使列表中的变量“属性”设置在类上，并设置为无。

```
def init_attributes(name, bases, dict):
    if 'attributes' in dict:
        for attr in dict['attributes']:
            dict[attr] = None

    return type(name, bases, dict)

class Initialised(object):
    __metaclass__ = init_attributes
    attributes = ['foo', 'bar', 'baz']

print 'foo =>', Initialised.foo
# output=>
foo => None 
```

**请注意，`Initialised`通过元类获得的神奇行为`init_attributes`不会传递给`Initialised`.**

这是一个更具体的示例，展示了如何将“type”子类化以创建一个元类，该元类在创建类时执行操作。这很棘手：

```
class MetaSingleton(type):
    instance = None
    def __call__(cls, *args, **kw):
        if cls.instance is None:
            cls.instance = super(MetaSingleton, cls).__call__(*args, **kw)
        return cls.instance

class Foo(object):
    __metaclass__ = MetaSingleton

a = Foo()
b = Foo()
assert a is b 
```

* * *

## 回答 #4

> 赞同：210
> 
> 时间：2011-06-21T16:30:26.837

其他人已经解释了元类如何工作以及它们如何适应 Python 类型系统。这是它们可以用于什么的示例。在我编写的测试框架中，我想跟踪定义类的顺序，以便以后可以按此顺序实例化它们。我发现使用元类最容易做到这一点。

```
class MyMeta(type):

    counter = 0

    def __init__(cls, name, bases, dic):
        type.__init__(cls, name, bases, dic)
        cls._order = MyMeta.counter
        MyMeta.counter += 1

class MyType(object):              # Python 2
    __metaclass__ = MyMeta

class MyType(metaclass=MyMeta):    # Python 3
    pass 
```

任何作为`MyType`then 子类的东西都会获得一个类属性，该属性`_order`记录了定义类的顺序。

* * *

## 回答 #5

> 赞同：187
> 
> 时间：2008-09-19T06:45:40.020

元类的一种用途是自动向实例添加新属性和方法。

例如，如果您查看[Django 模型](http://docs.djangoproject.com/en/dev/topics/db/models/)，它们的定义看起来有点混乱。看起来好像您只定义类属性：

```
class Person(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=30) 
```

然而，在运行时，Person 对象充满了各种有用的方法。查看一些惊人的元分类的[源代码。](http://code.djangoproject.com/browser/django/trunk/django/db/models/base.py)

* * *

## 回答 #6

> 赞同：150
> 
> 时间：2008-09-19T06:32:58.397

我认为元类编程的 ONLamp 介绍写得很好，尽管已经有好几年的历史了，但对这个主题给出了很好的介绍。

[http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html](http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html)（存档于[https://web.archive.org/web/20080206005253/http://www.onlamp。 com/pub/a/python/2003/04/17/metaclasses.html](https://web.archive.org/web/20080206005253/http://www.onlamp.com/pub/a/python/2003/04/17/metaclasses.html) )

简而言之：类是创建实例的蓝图，元类是创建类的蓝图。很容易看出，在 Python 中，类也需要是一流的对象才能启用此行为。

我自己从来没有写过，但我认为元类最好的用途之一可以在[Django 框架](http://www.djangoproject.com/)中看到。模型类使用元类方法来启用编写新模型或表单类的声明式风格。当元类创建类时，所有成员都可以自定义类本身。

*   [创建新模型](http://docs.djangoproject.com/en/dev/intro/tutorial01/#id3)
*   [启用此功能的元类](http://code.djangoproject.com/browser/django/trunk/django/db/models/base.py#L25)

剩下要说的是：如果你不知道元类是什么，那么你**不需要它们**的概率是 99%。

* * *

## 回答 #7

> 赞同：137
> 
> 时间：2015-08-10T23:28:09.000

> ## 什么是元类？你用它们做什么？

TLDR：元类实例化并定义类的行为，就像类实例化并定义实例的行为一样。

伪代码：

```
>>> Class(...)
instance 
```

上面应该看起来很熟悉。那么，`Class`从哪里来？它是元类的一个实例（也是伪代码）：

```
>>> Metaclass(...)
Class 
```

在实际代码中，我们可以传递默认的元类，`type`我们需要实例化一个类，我们得到一个类：

```
>>> type('Foo', (object,), {}) # requires a name, bases, and a namespace
<class '__main__.Foo'> 
```

## 换个说法

*   类对实例就像元类对类一样。

    当我们实例化一个对象时，我们得到一个实例：

    ```
    >>> object()                          # instantiation of class
    <object object at 0x7f9069b4e0b0>     # instance 
    ```

    同样，当我们使用默认元类显式定义一个类时`type`，我们将其实例化：

    ```
    >>> type('Object', (object,), {})     # instantiation of metaclass
    <class '__main__.Object'>             # instance 
    ```

*   换句话说，类是元类的一个实例：

    ```
    >>> isinstance(object, type)
    True 
    ```

*   第三种方式，元类是类的类。

    ```
    >>> type(object) == type
    True
    >>> object.__class__
    <class 'type'> 
    ```

当你编写一个类定义并且 Python 执行它时，它使用一个元类来实例化类对象（反过来，它将被用来实例化该类的实例）。

正如我们可以使用类定义来改变自定义对象实例的行为方式一样，我们可以使用元类类定义来改变类对象的行为方式。

它们可以用来做什么？从[文档](https://docs.python.org/3/reference/datamodel.html#metaclass-example)：

> 元类的潜在用途是无限的。已经探索的一些想法包括日志记录、接口检查、自动委托、自动属性创建、代理、框架和自动资源锁定/同步。

尽管如此，除非绝对必要，否则通常鼓励用户避免使用元类。

# 每次创建类时都使用元类：

例如，当您编写类定义时，像这样，

```
class Foo(object): 
    'demo' 
```

您实例化一个类对象。

```
>>> Foo
<class '__main__.Foo'>
>>> isinstance(Foo, type), isinstance(Foo, object)
(True, True) 
```

这`type`与使用适当的参数进行功能调用并将结果分配给该名称的变量相同：

```
name = 'Foo'
bases = (object,)
namespace = {'__doc__': 'demo'}
Foo = type(name, bases, namespace) 
```

注意，有些东西会自动添加到`__dict__`，即命名空间：

```
>>> Foo.__dict__
dict_proxy({'__dict__': <attribute '__dict__' of 'Foo' objects>, 
'__module__': '__main__', '__weakref__': <attribute '__weakref__' 
of 'Foo' objects>, '__doc__': 'demo'}) 
```

在这两种情况下，我们创建的对象的*元类*都是`type`.

（关于类内容的旁注`__dict__`：`__module__`是因为类必须知道它们在哪里定义，并且 `__dict__`存在`__weakref__`是因为我们没有定义`__slots__`- 如果我们[定义`__slots__`](https://stackoverflow.com/q/472000/541136)，我们将在实例中节省一些空间，如我们可以禁止`__dict__`并`__weakref__`排除它们。例如：

```
>>> Baz = type('Bar', (object,), {'__doc__': 'demo', '__slots__': ()})
>>> Baz.__dict__
mappingproxy({'__doc__': 'demo', '__slots__': (), '__module__': '__main__'}) 
```

...但我离题了。）

# 我们可以`type`像任何其他类定义一样扩展：

这是类的默认值`__repr__`：

```
>>> Foo
<class '__main__.Foo'> 
```

默认情况下，我们在编写 Python 对象时可以做的最有价值的事情之一就是为它提供一个好的`__repr__`. 当我们打电话时，`help(repr)`我们了解到有一个很好的测试 a`__repr__`也需要测试相等性 - `obj == eval(repr(obj))`。下面对我们类型类的类实例的简单实现为`__repr__`我们`__eq__`提供了一个可以改进`__repr__`类默认值的演示：

```
class Type(type):
    def __repr__(cls):
        """
        >>> Baz
        Type('Baz', (Foo, Bar,), {'__module__': '__main__', '__doc__': None})
        >>> eval(repr(Baz))
        Type('Baz', (Foo, Bar,), {'__module__': '__main__', '__doc__': None})
        """
        metaname = type(cls).__name__
        name = cls.__name__
        parents = ', '.join(b.__name__ for b in cls.__bases__)
        if parents:
            parents += ','
        namespace = ', '.join(': '.join(
          (repr(k), repr(v) if not isinstance(v, type) else v.__name__))
               for k, v in cls.__dict__.items())
        return '{0}(\'{1}\', ({2}), {{{3}}})'.format(metaname, name, parents, namespace)
    def __eq__(cls, other):
        """
        >>> Baz == eval(repr(Baz))
        True            
        """
        return (cls.__name__, cls.__bases__, cls.__dict__) == (
                other.__name__, other.__bases__, other.__dict__) 
```

所以现在当我们用这个元类创建一个对象时，`__repr__`命令行上的回显提供了一个比默认值少得多的丑陋景象：

```
>>> class Bar(object): pass
>>> Baz = Type('Baz', (Foo, Bar,), {'__module__': '__main__', '__doc__': None})
>>> Baz
Type('Baz', (Foo, Bar,), {'__module__': '__main__', '__doc__': None}) 
```

为类实例定义了一个很好的`__repr__`定义，我们有更强的调试代码的能力。然而，更进一步的检查`eval(repr(Class))`是不可能的（因为函数是不可能从它们的 default `__repr__`'s 进行评估的）。

# 预期用途：`__prepare__`命名空间

例如，如果我们想知道一个类的方法是按什么顺序创建的，我们可以提供一个有序的字典作为类的命名空间。如果它是在 Python 3 中实现的，我们将使用`__prepare__`它[返回类的命名空间字典](https://docs.python.org/3/reference/datamodel.html#preparing-the-class-namespace)：

```
from collections import OrderedDict

class OrderedType(Type):
    @classmethod
    def __prepare__(metacls, name, bases, **kwargs):
        return OrderedDict()
    def __new__(cls, name, bases, namespace, **kwargs):
        result = Type.__new__(cls, name, bases, dict(namespace))
        result.members = tuple(namespace)
        return result 
```

和用法：

```
class OrderedMethodsObject(object, metaclass=OrderedType):
    def method1(self): pass
    def method2(self): pass
    def method3(self): pass
    def method4(self): pass 
```

现在我们记录了这些方法（和其他类属性）的创建顺序：

```
>>> OrderedMethodsObject.members
('__module__', '__qualname__', 'method1', 'method2', 'method3', 'method4') 
```

请注意，此示例改编自[文档-](https://docs.python.org/3/reference/datamodel.html#metaclass-example)[标准库](https://github.com/python/cpython/blob/master/Lib/enum.py)中的新枚举执行此操作。

所以我们所做的是通过创建一个类来实例化一个元类。我们也可以像对待任何其他类一样对待元类。它有一个方法解析顺序：

```
>>> inspect.getmro(OrderedType)
(<class '__main__.OrderedType'>, <class '__main__.Type'>, <class 'type'>, <class 'object'>) 
```

并且它大致正确`repr`（除非我们能找到一种方法来表示我们的函数，否则我们无法再评估它。）：

```
>>> OrderedMethodsObject
OrderedType('OrderedMethodsObject', (object,), {'method1': <function OrderedMethodsObject.method1 at 0x0000000002DB01E0>, 'members': ('__module__', '__qualname__', 'method1', 'method2', 'method3', 'method4'), 'method3': <function OrderedMet
hodsObject.method3 at 0x0000000002DB02F0>, 'method2': <function OrderedMethodsObject.method2 at 0x0000000002DB0268>, '__module__': '__main__', '__weakref__': <attribute '__weakref__' of 'OrderedMethodsObject' objects>, '__doc__': None, '__d
ict__': <attribute '__dict__' of 'OrderedMethodsObject' objects>, 'method4': <function OrderedMethodsObject.method4 at 0x0000000002DB0378>}) 
```

* * *

## 回答 #8

> 赞同：103
> 
> 时间：2016-03-01T19:48:34.813

**Python 3 更新**

元类中有（此时）两个关键方法：

*   `__prepare__`， 和
*   `__new__`

`__prepare__`允许您在创建类时提供自定义映射（例如`OrderedDict`）以用作命名空间。您必须返回您选择的任何命名空间的实例。如果你不实现`__prepare__`一个正常`dict`的使用。

`__new__`负责最终类的实际创建/修改。

一个简单的、什么都不做的额外元类会喜欢：

```
class Meta(type):

    def __prepare__(metaclass, cls, bases):
        return dict()

    def __new__(metacls, cls, bases, clsdict):
        return super().__new__(metacls, cls, bases, clsdict) 
```

一个简单的例子：

假设您希望在属性上运行一些简单的验证代码——比如它必须始终是 an`int`或 a `str`。如果没有元类，您的类将类似于：

```
class Person:
    weight = ValidateType('weight', int)
    age = ValidateType('age', int)
    name = ValidateType('name', str) 
```

如您所见，您必须重复两次属性名称。这使得拼写错误和恼人的错误成为可能。

一个简单的元类可以解决这个问题：

```
class Person(metaclass=Validator):
    weight = ValidateType(int)
    age = ValidateType(int)
    name = ValidateType(str) 
```

这是元类的样子（不使用`__prepare__`，因为不需要它）：

```
class Validator(type):
    def __new__(metacls, cls, bases, clsdict):
        # search clsdict looking for ValidateType descriptors
        for name, attr in clsdict.items():
            if isinstance(attr, ValidateType):
                attr.name = name
                attr.attr = '_' + name
        # create final class and return it
        return super().__new__(metacls, cls, bases, clsdict) 
```

运行示例：

```
p = Person()
p.weight = 9
print(p.weight)
p.weight = '9' 
```

产生：

```
9
Traceback (most recent call last):
  File "simple_meta.py", line 36, in <module>
    p.weight = '9'
  File "simple_meta.py", line 24, in __set__
    (self.name, self.type, value))
TypeError: weight must be of type(s) <class 'int'> (got '9') 
```

* * *

**注意**：这个例子很简单，它也可以用一个类装饰器来完成，但大概一个实际的元类会做更多的事情。

'ValidateType' 类供参考：

```
class ValidateType:
    def __init__(self, type):
        self.name = None  # will be set by metaclass
        self.attr = None  # will be set by metaclass
        self.type = type
    def __get__(self, inst, cls):
        if inst is None:
            return self
        else:
            return inst.__dict__[self.attr]
    def __set__(self, inst, value):
        if not isinstance(value, self.type):
            raise TypeError('%s must be of type(s) %s (got %r)' %
                    (self.name, self.type, value))
        else:
            inst.__dict__[self.attr] = value 
```

* * *

## 回答 #9

> 赞同：89
> 
> 时间：2016-10-13T09:21:26.067

# `__call__()`创建类实例时元类方法的作用

如果您已经进行了几个月以上的 Python 编程，您最终会偶然发现如下所示的代码：

```
# define a class
class SomeClass(object):
    # ...
    # some definition here ...
    # ...

# create an instance of it
instance = SomeClass()

# then call the object as if it's a function
result = instance('foo', 'bar') 
```

当您`__call__()`在类上实现魔术方法时，后者是可能的。

```
class SomeClass(object):
    # ...
    # some definition here ...
    # ...

    def __call__(self, foo, bar):
        return bar + foo 
```

`__call__()`当类的实例用作可调用对象时，将调用该方法。但是正如我们从之前的答案中看到的那样，一个类本身就是一个元类的实例，所以当我们将该类用作可调用对象时（即当我们创建它的实例时），我们实际上是在调用它的元类`__call__()`方法。在这一点上，大多数 Python 程序员有点困惑，因为他们被告知在创建这样的实例时，`instance = SomeClass()`您正在调用它的`__init__()`方法。一些深入挖掘的人知道，`__init__()`在`__new__()`. `__new__()`好吧，今天在元类出现之前，另一层真相正在被揭示`__call__()`。

我们具体从创建类实例的角度来研究方法调用链。

这是一个元类，它准确记录实例创建之前的时刻和即将返回它的时刻。

```
class Meta_1(type):
    def __call__(cls):
        print "Meta_1.__call__() before creating an instance of ", cls
        instance = super(Meta_1, cls).__call__()
        print "Meta_1.__call__() about to return instance."
        return instance 
```

这是一个使用该元类的类

```
class Class_1(object):

    __metaclass__ = Meta_1

    def __new__(cls):
        print "Class_1.__new__() before creating an instance."
        instance = super(Class_1, cls).__new__(cls)
        print "Class_1.__new__() about to return instance."
        return instance

    def __init__(self):
        print "entering Class_1.__init__() for instance initialization."
        super(Class_1,self).__init__()
        print "exiting Class_1.__init__()." 
```

现在让我们创建一个实例`Class_1`

```
instance = Class_1()
# Meta_1.__call__() before creating an instance of <class '__main__.Class_1'>.
# Class_1.__new__() before creating an instance.
# Class_1.__new__() about to return instance.
# entering Class_1.__init__() for instance initialization.
# exiting Class_1.__init__().
# Meta_1.__call__() about to return instance. 
```

请注意，上面的代码实际上除了记录任务之外没有做任何事情。每个方法都将实际工作委托给其父级的实现，从而保持默认行为。由于`type`is`Meta_1`的父类（`type`作为默认的父元类）并考虑到上面输出的排序顺序，我们现在知道什么是伪实现的线索`type.__call__()`：

```
class type:
    def __call__(cls, *args, **kwarg):

        # ... maybe a few things done to cls here

        # then we call __new__() on the class to create an instance
        instance = cls.__new__(cls, *args, **kwargs)

        # ... maybe a few things done to the instance here

        # then we initialize the instance with its __init__() method
        instance.__init__(*args, **kwargs)

        # ... maybe a few more things done to instance here

        # then we return it
        return instance 
```

我们可以看到元类的`__call__()`方法是第一个被调用的。然后它将实例的创建委托给类的`__new__()`方法，并将初始化委托给实例的`__init__()`. 它也是最终返回实例的那个。

从上面可以看出，元类'`__call__()`也有机会决定是否调用`Class_1.__new__()`或`Class_1.__init__()`最终将被调用。在其执行过程中，它实际上可以返回一个尚未被这两种方法中的任何一种接触过的对象。以单例模式的这种方法为例：

```
class Meta_2(type):
    singletons = {}

    def __call__(cls, *args, **kwargs):
        if cls in Meta_2.singletons:
            # we return the only instance and skip a call to __new__()
            # and __init__()
            print ("{} singleton returning from Meta_2.__call__(), "
                   "skipping creation of new instance.".format(cls))
            return Meta_2.singletons[cls]

        # else if the singleton isn't present we proceed as usual
        print "Meta_2.__call__() before creating an instance."
        instance = super(Meta_2, cls).__call__(*args, **kwargs)
        Meta_2.singletons[cls] = instance
        print "Meta_2.__call__() returning new instance."
        return instance

class Class_2(object):

    __metaclass__ = Meta_2

    def __new__(cls, *args, **kwargs):
        print "Class_2.__new__() before creating instance."
        instance = super(Class_2, cls).__new__(cls)
        print "Class_2.__new__() returning instance."
        return instance

    def __init__(self, *args, **kwargs):
        print "entering Class_2.__init__() for initialization."
        super(Class_2, self).__init__()
        print "exiting Class_2.__init__()." 
```

让我们观察当反复尝试创建一个类型的对象时会发生什么`Class_2`

```
a = Class_2()
# Meta_2.__call__() before creating an instance.
# Class_2.__new__() before creating instance.
# Class_2.__new__() returning instance.
# entering Class_2.__init__() for initialization.
# exiting Class_2.__init__().
# Meta_2.__call__() returning new instance.

b = Class_2()
# <class '__main__.Class_2'> singleton returning from Meta_2.__call__(), skipping creation of new instance.

c = Class_2()
# <class '__main__.Class_2'> singleton returning from Meta_2.__call__(), skipping creation of new instance.

a is b is c # True 
```

* * *

## 回答 #10

> 赞同：71
> 
> 时间：2014-02-24T21:20:49.270

元类是一个类，它告诉应该如何创建（一些）其他类。

在这种情况下，我将元类视为我的问题的解决方案：我有一个非常复杂的问题，可能可以用不同的方式解决，但我选择使用元类来解决它。由于复杂性，它是我编写的少数模块之一，其中模块中的注释超过了已编写的代码量。这里是...

```
#!/usr/bin/env python

# Copyright (C) 2013-2014 Craig Phillips.  All rights reserved.

# This requires some explaining.  The point of this metaclass excercise is to
# create a static abstract class that is in one way or another, dormant until
# queried.  I experimented with creating a singlton on import, but that did
# not quite behave how I wanted it to.  See now here, we are creating a class
# called GsyncOptions, that on import, will do nothing except state that its
# class creator is GsyncOptionsType.  This means, docopt doesn't parse any
# of the help document, nor does it start processing command line options.
# So importing this module becomes really efficient.  The complicated bit
# comes from requiring the GsyncOptions class to be static.  By that, I mean
# any property on it, may or may not exist, since they are not statically
# defined; so I can't simply just define the class with a whole bunch of
# properties that are @property @staticmethods.
#
# So here's how it works:
#
# Executing 'from libgsync.options import GsyncOptions' does nothing more
# than load up this module, define the Type and the Class and import them
# into the callers namespace.  Simple.
#
# Invoking 'GsyncOptions.debug' for the first time, or any other property
# causes the __metaclass__ __getattr__ method to be called, since the class
# is not instantiated as a class instance yet.  The __getattr__ method on
# the type then initialises the class (GsyncOptions) via the __initialiseClass
# method.  This is the first and only time the class will actually have its
# dictionary statically populated.  The docopt module is invoked to parse the
# usage document and generate command line options from it.  These are then
# paired with their defaults and what's in sys.argv.  After all that, we
# setup some dynamic properties that could not be defined by their name in
# the usage, before everything is then transplanted onto the actual class
# object (or static class GsyncOptions).
#
# Another piece of magic, is to allow command line options to be set in
# in their native form and be translated into argparse style properties.
#
# Finally, the GsyncListOptions class is actually where the options are
# stored.  This only acts as a mechanism for storing options as lists, to
# allow aggregation of duplicate options or options that can be specified
# multiple times.  The __getattr__ call hides this by default, returning the
# last item in a property's list.  However, if the entire list is required,
# calling the 'list()' method on the GsyncOptions class, returns a reference
# to the GsyncListOptions class, which contains all of the same properties
# but as lists and without the duplication of having them as both lists and
# static singlton values.
#
# So this actually means that GsyncOptions is actually a static proxy class...
#
# ...And all this is neatly hidden within a closure for safe keeping.
def GetGsyncOptionsType():
    class GsyncListOptions(object):
        __initialised = False

    class GsyncOptionsType(type):
        def __initialiseClass(cls):
            if GsyncListOptions._GsyncListOptions__initialised: return

            from docopt import docopt
            from libgsync.options import doc
            from libgsync import __version__

            options = docopt(
                doc.__doc__ % __version__,
                version = __version__,
                options_first = True
            )

            paths = options.pop('<path>', None)
            setattr(cls, "destination_path", paths.pop() if paths else None)
            setattr(cls, "source_paths", paths)
            setattr(cls, "options", options)

            for k, v in options.iteritems():
                setattr(cls, k, v)

            GsyncListOptions._GsyncListOptions__initialised = True

        def list(cls):
            return GsyncListOptions

        def __getattr__(cls, name):
            cls.__initialiseClass()
            return getattr(GsyncListOptions, name)[-1]

        def __setattr__(cls, name, value):
            # Substitut option names: --an-option-name for an_option_name
            import re
            name = re.sub(r'^__', "", re.sub(r'-', "_", name))
            listvalue = []

            # Ensure value is converted to a list type for GsyncListOptions
            if isinstance(value, list):
                if value:
                    listvalue = [] + value
                else:
                    listvalue = [ None ]
            else:
                listvalue = [ value ]

            type.__setattr__(GsyncListOptions, name, listvalue)

    # Cleanup this module to prevent tinkering.
    import sys
    module = sys.modules[__name__]
    del module.__dict__['GetGsyncOptionsType']

    return GsyncOptionsType

# Our singlton abstract proxy class.
class GsyncOptions(object):
    __metaclass__ = GetGsyncOptionsType() 
```

* * *

## 回答 #11

> 赞同：59
> 
> 时间：2016-12-27T02:21:01.297

## tl;dr 版本

该`type(obj)`函数为您获取对象的类型。

**`type()`一个类的 是它的元*类*。**

要使用元类：

```
class Foo(object):
    __metaclass__ = MyMetaClass 
```

`type`是它自己的元类。类的类是元类——类的主体是传递给用于构造类的元类的参数。

[在这里](https://docs.python.org/3/reference/datamodel.html#metaclasses)，您可以阅读有关如何使用元类来自定义类构造的信息。

* * *

## 回答 #12

> 赞同：56
> 
> 时间：2016-08-09T18:49:44.417

`type`实际上是一个`metaclass`——一个创建另一个类的类。大多数`metaclass`是 的子类`type`。`metaclass`接收类作为其`new`第一个参数，并提供对类对象的访问，其详细信息如下所述：

```
>>> class MetaClass(type):
...     def __init__(cls, name, bases, attrs):
...         print ('class name: %s' %name )
...         print ('Defining class %s' %cls)
...         print('Bases %s: ' %bases)
...         print('Attributes')
...         for (name, value) in attrs.items():
...             print ('%s :%r' %(name, value))
... 

>>> class NewClass(object, metaclass=MetaClass):
...    get_choch='dairy'
... 
class name: NewClass
Bases <class 'object'>: 
Defining class <class 'NewClass'>
get_choch :'dairy'
__module__ :'builtins'
__qualname__ :'NewClass' 
```

`Note:`

请注意，该类在任何时候都没有实例化；创建类的简单行为触发了`metaclass`.

* * *

## 回答 #13

> 赞同：39
> 
> 时间：2017-07-13T07:58:10.633

Python 类本身就是它们的元类的对象（例如实例）。

默认元类，当您将类确定为时应用：

```
class foo:
    ... 
```

元类用于将某些规则应用于整个类集。例如，假设您正在构建一个 ORM 来访问数据库，并且您希望每个表中的记录属于映射到该表的类（基于字段、业务规则等），这可能是元类的使用例如，连接池逻辑，由所有表中的所有记录类共享。另一个用途是支持外键的逻辑，它涉及多类记录。

当您定义元类时，您可以子类化类型，并且可以覆盖以下魔术方法来插入您的逻辑。

```
class somemeta(type):
    __new__(mcs, name, bases, clsdict):
      """
  mcs: is the base metaclass, in this case type.
  name: name of the new class, as provided by the user.
  bases: tuple of base classes 
  clsdict: a dictionary containing all methods and attributes defined on class

  you must return a class object by invoking the __new__ constructor on the base metaclass. 
 ie: 
    return type.__call__(mcs, name, bases, clsdict).

  in the following case:

  class foo(baseclass):
        __metaclass__ = somemeta

  an_attr = 12

  def bar(self):
      ...

  @classmethod
  def foo(cls):
      ...

      arguments would be : ( somemeta, "foo", (baseclass, baseofbase,..., object), {"an_attr":12, "bar": <function>, "foo": <bound class method>}

      you can modify any of these values before passing on to type
      """
      return type.__call__(mcs, name, bases, clsdict)

    def __init__(self, name, bases, clsdict):
      """ 
      called after type has been created. unlike in standard classes, __init__ method cannot modify the instance (cls) - and should be used for class validaton.
      """
      pass

    def __prepare__():
        """
        returns a dict or something that can be used as a namespace.
        the type will then attach methods and attributes from class definition to it.

        call order :

        somemeta.__new__ ->  type.__new__ -> type.__init__ -> somemeta.__init__ 
        """
        return dict()

    def mymethod(cls):
        """ works like a classmethod, but for class objects. Also, my method will not be visible to instances of cls.
        """
        pass 
```

总之，这两个是最常用的钩子。元分类很强大，上面还没有详尽列出元分类的用途。

* * *

## 回答 #14

> 赞同：36
> 
> 时间：2018-01-12T09:16:56.803

type() 函数可以返回一个对象的类型或者创建一个新的类型，

例如，我们可以使用 type() 函数创建一个 Hi 类，而无需对 Hi(object) 类使用这种方式：

```
def func(self, name='mike'):
    print('Hi, %s.' % name)

Hi = type('Hi', (object,), dict(hi=func))
h = Hi()
h.hi()
Hi, mike.

type(Hi)
type

type(h)
__main__.Hi 
```

除了使用 type() 动态创建类之外，您还可以控制类的创建行为并使用元类。

根据 Python 的对象模型，类就是对象，所以类必须是另一个特定类的实例。默认情况下，Python 类是类型类的实例。也就是说，type 是大多数内置类的元类和用户定义类的元类。

```
class ListMetaclass(type):
    def __new__(cls, name, bases, attrs):
        attrs['add'] = lambda self, value: self.append(value)
        return type.__new__(cls, name, bases, attrs)

class CustomList(list, metaclass=ListMetaclass):
    pass

lst = CustomList()
lst.add('custom_list_1')
lst.add('custom_list_2')

lst
['custom_list_1', 'custom_list_2'] 
```

当我们在 metaclass 中传递关键字参数时，Magic 就会生效，它指示 Python 解释器通过 ListMetaclass 创建 CustomList。**new** ()，此时，我们可以修改类定义，例如，添加一个新方法，然后返回修改后的定义。

* * *

## 回答 #15

> 赞同：25
> 
> 时间：2018-09-15T12:41:20.950

除了已发布的答案，我可以说 a`metaclass`定义了一个类的行为。因此，您可以显式设置元类。每当 Python 获得关键字`class`时，它就会开始搜索`metaclass`. 如果没有找到——默认的元类类型用于创建类的对象。使用该`__metaclass__`属性，您可以设置`metaclass`您的类：

```
class MyClass:
   __metaclass__ = type
   # write here other method
   # write here one more method

print(MyClass.__metaclass__) 
```

它将产生如下输出：

```
class 'type' 
```

而且，当然，您可以创建自己的`metaclass`来定义使用您的类创建的任何类的行为。

为此，您的默认`metaclass`类型类必须被继承，因为这是主要的`metaclass`：

```
class MyMetaClass(type):
   __metaclass__ = type
   # you can write here any behaviour you want

class MyTestClass:
   __metaclass__ = MyMetaClass

Obj = MyTestClass()
print(Obj.__metaclass__)
print(MyMetaClass.__metaclass__) 
```

输出将是：

```
class '__main__.MyMetaClass'
class 'type' 
```

* * *

## 回答 #16

> 赞同：17
> 
> 时间：2020-03-03T10:06:52.060

请注意，在 python 3.6`__init_subclass__(cls, **kwargs)`中引入了一个新的 dunder 方法来替换元类的许多常见用例。Is 在定义类的子类创建时调用。请参阅[python 文档](https://docs.python.org/3.6/reference/datamodel.html)。

* * *

## 回答 #17

> 赞同：15
> 
> 时间：2019-12-20T11:03:31.263

这是它可用于的另一个示例：

*   您可以使用`metaclass`来更改其实例（类）的功能。

```
class MetaMemberControl(type):
    __slots__ = ()

    @classmethod
    def __prepare__(mcs, f_cls_name, f_cls_parents,  # f_cls means: future class
                    meta_args=None, meta_options=None):  # meta_args and meta_options is not necessarily needed, just so you know.
        f_cls_attr = dict()
        if not "do something or if you want to define your cool stuff of dict...":
            return dict(make_your_special_dict=None)
        else:
            return f_cls_attr

    def __new__(mcs, f_cls_name, f_cls_parents, f_cls_attr,
                meta_args=None, meta_options=None):

        original_getattr = f_cls_attr.get('__getattribute__')
        original_setattr = f_cls_attr.get('__setattr__')

        def init_getattr(self, item):
            if not item.startswith('_'):  # you can set break points at here
                alias_name = '_' + item
                if alias_name in f_cls_attr['__slots__']:
                    item = alias_name
            if original_getattr is not None:
                return original_getattr(self, item)
            else:
                return super(eval(f_cls_name), self).__getattribute__(item)

        def init_setattr(self, key, value):
            if not key.startswith('_') and ('_' + key) in f_cls_attr['__slots__']:
                raise AttributeError(f"you can't modify private members:_{key}")
            if original_setattr is not None:
                original_setattr(self, key, value)
            else:
                super(eval(f_cls_name), self).__setattr__(key, value)

        f_cls_attr['__getattribute__'] = init_getattr
        f_cls_attr['__setattr__'] = init_setattr

        cls = super().__new__(mcs, f_cls_name, f_cls_parents, f_cls_attr)
        return cls

class Human(metaclass=MetaMemberControl):
    __slots__ = ('_age', '_name')

    def __init__(self, name, age):
        self._name = name
        self._age = age

    def __getattribute__(self, item):
        """
        is just for IDE recognize.
        """
        return super().__getattribute__(item)

    """ with MetaMemberControl then you don't have to write as following
    @property
    def name(self):
        return self._name

    @property
    def age(self):
        return self._age
    """

def test_demo():
    human = Human('Carson', 27)
    # human.age = 18  # you can't modify private members:_age  <-- this is defined by yourself.
    # human.k = 18  # 'Human' object has no attribute 'k'  <-- system error.
    age1 = human._age  # It's OK, although the IDE will show some warnings. (Access to a protected member _age of a class)

    age2 = human.age  # It's OK! see below:
    """
    if you do not define `__getattribute__` at the class of Human,
    the IDE will show you: Unresolved attribute reference 'age' for class 'Human'
    but it's ok on running since the MetaMemberControl will help you.
    """

if __name__ == '__main__':
    test_demo() 
```

很强大，`metaclass`你可以用它做很多事情（比如猴子魔法），但要小心，这可能只有你知道。

* * *

## 回答 #18

> 赞同：14
> 
> 时间：2019-07-09T05:37:53.293

在面向对象编程中，元类是一个类，其实例是类。正如普通类定义某些对象的行为一样，元类定义某些类及其实例的行为。术语元类仅表示用于创建类的东西。换句话说，它是一个类的类。元类用于创建类，就像对象是类的实例一样，类是元类的实例。在 python 中，类也被认为是对象。

* * *

## 回答 #19

> 赞同：13
> 
> 时间：2020-01-20T06:59:32.447

在 Python 中，类是一个对象，就像任何其他对象一样，它是“某物”的一个实例。这个“东西”就是所谓的元类。这个元类是一种特殊类型的类，它创建其他类的对象。因此，元类负责创建新类。这允许程序员自定义生成类的方式。

要创建元类，通常需要重写**new** () 和**init () 方法。****new** () 可以重写来改变对象的创建方式，而**init** () 可以重写来改变初始化对象的方式。元类可以通过多种方式创建。其中一种方法是使用 type() 函数。type() 函数，当使用 3 个参数调用时，会创建一个元类。参数是：-

1.  班级名称
2.  具有由类继承的基类的元组
3.  包含所有类方法和类变量的字典

创建元类的另一种方法包括“元类”关键字。将元类定义为一个简单的类。在继承类的参数中，传递metaclass=metaclass_name

元类可以专门用于以下情况：-

1.  当必须将特定效果应用于所有子类时
2.  需要自动更改类（创建时）
3.  由 API 开发人员提供

* * *

## 回答 #20

> 赞同：12
> 
> 时间：2021-07-17T05:18:53.113

**最佳答案是正确的**。

但是读者可能会来这里寻找类似名称的内部类的答案。它们存在于流行的库中，例如`Django`和`WTForms`。

正如 DavidW 在此答案下方的评论中指出的那样，**这些是*特定于库的*功能，不要与具有相似名称的高级、不相关的*Python 语言***功能相混淆。

相反，这些是类字典中的命名空间。为了可读性，它们是使用内部类构造的。

在此示例中，特殊字段`abstract`明显与 Author 模型的字段分开。

```
from django.db import models

class Author(models.Model):
    name = models.CharField(max_length=50)
    email = models.EmailField()

    class Meta:
        abstract = True 
```

另一个示例来自以下文档`WTForms`：

```
from wtforms.form import Form
from wtforms.csrf.session import SessionCSRF
from wtforms.fields import StringField

class MyBaseForm(Form):
    class Meta:
        csrf = True
        csrf_class = SessionCSRF

    name = StringField("name") 
```

此语法在 python 编程语言中没有得到特殊处理。`Meta`这里不是关键字，也不会触发元类行为。相反，包中的第三方库代码喜欢`Django`并`WTForms`在某些类的构造函数和其他地方读取此属性。

这些声明的存在修改了具有这些声明的类的行为。例如，`WTForms`读取`self.Meta.csrf`以确定表单是否需要`csrf`字段。

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2021-04-21T18:41:33.320

在 Python 中，元类是确定子类行为方式的子类的子类。一个类是另一个元类的一个实例。在 Python 中，类指定类的实例的行为方式。

由于元类负责类生成，因此您可以编写自己的自定义元类，通过执行附加操作或注入代码来更改类的创建方式。自定义元类并不总是很重要，但它们可能很重要。

* * *

## 回答 #22

> 赞同：7
> 
> 时间：2021-07-12T22:51:40.790

我在一个名为`classutilities`. 它检查所有类变量是否都是大写格式（便于对配置类进行统一的逻辑），并检查类中是否没有实例级方法。Metaclases 的另一个有趣示例是基于复杂条件（检查多个环境变量的值）停用单元测试。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2022-02-06T13:10:56.903

**什么是元编程？**

简而言之，我们可以说元编程是操纵代码的代码。*Python 支持一种称为元类的类元编程形式。*

**何时使用：**

它通常用于复杂的事情，但我们使用元类的少数情况是——</p>

*   元类向下传播继承层次结构。它也会影响所有子类。如果我们有这种情况，那么我们应该使用元类。
*   如果我们想自动更改类，当它被创建时，我们使用元类。
*   对于 API 开发，我们可能会使用元类。
*   在创建时进一步：记录和分析、接口检查、在创建时注册类、自动添加新方法、自动属性创建、代理、自动资源、锁定/同步。

**新手图：** [![元类](../Images/33d4b56de32d95285e29b099a60c2e0a.png)](https://i.stack.imgur.com/FOyn1.png)

**类工厂：**

元类主要用作类工厂。当您通过调用类创建对象时，Python 通过调用元类创建一个新类。

**>**结合普通`__init__`和`__new__`方法，元类，允许您在创建类时做额外的事情，例如使用某个注册表注册新类或用其他东西完全替换该类。

1-**`__new__():`**这是一个之前调用的方法`__init__()`。它创建对象并返回它。我们可以重写此方法来控制对象的创建方式。

2-**`__init__():`**此方法只是初始化作为参数传递的创建对象。

**定义元类的方法：**

1-**方法1：**

```
class MyMeta1(type):
    def __new__(cls, name, bases, dict):
        pass 
```

2-**方法2：**

```
class MyMeta2(type):
    def __init__(self, name, bases, dict):
        pass 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2021-10-03T16:06:40.173

看看这个：

```
Python 3.10.0rc2 (tags/v3.10.0rc2:839d789, Sep  7 2021, 18:51:45) [MSC v.1929 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> class Object:
...     pass
... 
>>> class Meta(type):
...     test = 'Worked!!!'
...     def __repr__(self):
...             return 'This is "Meta" metaclass'
... 
>>> class ObjectWithMetaClass(metaclass=Meta):
...     pass
... 
>>> Object or type(Object())
<class '__main__.Object'>
>>> ObjectWithMetaClass or type(ObjectWithMetaClass())
This is "Meta" metaclass
>>> Object.test
AttributeError: ...
>>> ObjectWithMetaClass.test
'Worked!!!'
>>> type(Object)
<class 'type'>
>>> type(ObjectWithMetaClass)
<class '__main__.Meta'>
>>> type(type(ObjectWithMetaClass))
<class 'type'>
>>> Object.__bases__
(<class 'object'>,)
>>> ObjectWithMetaClass.__bases__
(<class 'object'>,)
>>> type(ObjectWithMetaClass).__bases__
(<class 'type'>,)
>>> Object.__mro__
(<class '__main__.Object'>, <class 'object'>)
>>> ObjectWithMetaClass.__mro__
(This is "Meta" metaclass, <class 'object'>)
>>> 
```

换句话说，当一个对象没有被创建时（对象的类型），我们看的是 MetaClass。

# c# - 记录应用程序块 - 记录调用者

> ID：100007
> 
> 赞同：2
> 
> 时间：2008-09-19T06:12:37.777
> 
> 标签：c#, logging, enterprise-library, application-blocks

使用 Log4Net 进行日志记录时，很容易将调用日志的类放入日志文件中。我过去发现，这使得跟踪代码和查看类的流程变得非常容易。在 Log4Net 中，我在转换模式中使用 %logger 属性，如下所示：

```
<conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" /> 
```

这给了我想要的输出：

`2008-09-19 15:40:26,906 [3132] ERROR <b>Log4NetTechDemo.Tester</b> [(null)] - Failed method`

您可以从输出中看到调用日志的类是 Log4NetTechDemo.Tester，因此我可以很容易地将错误追溯到该类。

在日志记录应用程序块中，我无法弄清楚如何通过简单的日志调用来做到这一点。有谁知道怎么做？如果是这样，这样做的示例或步骤将非常有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T10:24:25.330

将调用方法添加到 LogEntry 的 ExtendedProperties 字典中；当然，假设您没有从格式化程序模板中删除 ExtendedProperties 标记。

把这样的东西放在日志包装器中：

```
public void LogSomething(string msg)
{
  LogEntry le = new LogEntry { Message = msg };
  le.ExtendedProperties.Add("Called from", new StackFrame(1).GetMethod().ReflectedType);
  Logger.Write(le);
} 
```

调用它会在日志末尾产生类似这样的内容：

```
Extended Properties: Called from - LAB_Demo.Tester 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T06:38:11.817

我们还没有找到一个不点击 StackTrace 的简单方法。如果这是一个例外，我们只是从中获取：

```
 StackTrace trace = new StackTrace(ex, true);
 StackFrame frame = trace.GetFrame(0); 
```

对于聊天项目，我们只写字符串。我们有一个片段可以在插入时获取类名。我们还用类名声明了 const 字符串。

不漂亮，但它是我们找到的最好的。我希望其他人在这个线程中有一个更好的答案:)

# php - Facebook RSS 应用程序

> ID：100038
> 
> 赞同：3
> 
> 时间：2008-09-19T06:26:52.547
> 
> 标签：php, facebook, rss

如何制作一个从提供的 RSS 提要自动更新的 Facebook RSS 应用程序。当然，这样做对于画布应用程序来说是微不足道的，但我需要它来显示在 Facebook 页面上。我看过的所有 RSS 应用程序要么不更新，要么不能在 Facebook 页面上运行。

特别是现在无限会话密钥已被弃用（甚至可能被禁止）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T08:52:26.137

1.  无限会话密钥[不再存在](http://developers.facebook.com/news.php?blog=1&story=135)
2.  每个提要都是独一无二的。但即使不是，我是否可以将 fbml.refreshRefUrl 填充到 cron 作业中，并且它可以在没有会话的情况下工作（因为我无法获得无限会话）= 或者我可能首先需要请求 offline_access 扩展权限？有什么办法不使用 cron 作业？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T08:18:22.653

I specifically said I do not need this for canvas applications (as that is trivial to do), but on Facebook Pages! This is done with [profile.setFBML](http://wiki.developers.facebook.com/index.php/Profile.setFBML) and data published that way does reside on the facebook servers.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T08:57:11.780

你有两个选择。

1.  将您的用户会话（当用户手动访问您的应用程序时）转换为无限会话，然后定期更新用户的个人资料信息。这里有一些关于如何做到这一点的信息（以及你可以在没有会话[的](http://wiki.developers.facebook.com/index.php/Authorizing_Applications#About_Session_Keys)情况下进行哪些 API 调用） 。

2.  为每个唯一的提要创建一个新的“句柄”（请参阅​​ 参考资料[`fb:ref`](http://wiki.developers.facebook.com/index.php/Fb:ref)），并在提要更改时更新该句柄。句柄是与您的应用程序相关联的键值对，您可以通过 FBML 将其包含在内。这允许您对 API 进行一次调用，该 API 将更新订阅给定提要的所有用户。

从长远来看，第二种选择可能是最好的。

# c# - C# 中用于文件名验证的正则表达式

> ID：100045
> 
> 赞同：19
> 
> 时间：2008-09-19T06:28:45.677
> 
> 标签：c#, regex

什么是可以验证文本字符串以确保它是有效的 Windows 文件名的好的正则表达式？（AKA 没有`\/:*?"<>|`字符）。

我想像下面这样使用它：

```
// Return true if string is invalid.
if (Regex.IsMatch(szFileName, "<your regex string>"))
{
    // Tell user to reformat their filename.
} 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-09-19T06:34:58.377

正如已经回答的那样， GetInvalidFileNameChars 应该为您完成，您甚至不需要正则表达式的开销：

```
if (proposedFilename.IndexOfAny(System.IO.Path.GetInvalidFileNameChars()) != -1)
{
  MessageBox.Show("The filename is invalid");
  return;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-19T07:14:58.860

这并不像检查文件名是否包含任何[System.IO.Path.GetInvalidFileNameChars](http://msdn.microsoft.com/en-us/library/system.io.path.getinvalidfilenamechars.aspx)那样简单（正如其他几个答案中已经提到的那样）。

例如，如果有人输入的名称不包含无效字符但长度为 300 个字符（即大于 MAX_PATH）怎么办 - 这不适用于任何 .NET 文件 API，并且仅在其余窗口中使用有限的支持\?\ 路径语法。您需要关于路径的其余部分有多长的上下文来确定文件名的长度。您可以[在此处找到有关此类事物的更多信息](http://blogs.msdn.com/brian_dewey/archive/2004/01/19/60263.aspx)。

最终，您可以*可靠地*做的所有检查都是证明文件名无效，或者为您提供关于它是否有效的合理估计。如果不实际尝试使用它，几乎不可能证明文件名是有效的。（即使那样，您也会遇到问题，例如如果它已经存在怎么办？它可能是一个有效的文件名，但在您的场景中重复名称是否有效？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T06:32:56.573

为什么不使用 System.IO.FileInfo 类，以及 DirectoryInfo 类，你有一组有用的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T14:41:00.207

Path.GetInvalidFileNameChars - 不是一个好方法。试试这个：

```
if(@"C:\A.txt".IndexOfAny(System.IO.Path.GetInvalidFileNameChars()) != -1)
{
  MessageBox.Show("The filename is invalid");
  return;
} 
```

# algorithm - 我需要加入两个列表，对它们进行排序并删除重复项。有一个更好的方法吗？

> ID：100048
> 
> 赞同：6
> 
> 时间：2008-09-19T06:29:18.797
> 
> 标签：algorithm, sorting, lisp, list

我有两个未排序的列表，我需要生成另一个已排序且所有元素都是唯一的列表。

这些元素可以在两个列表中出现多次，并且它们最初是未排序的。

我的功能如下所示：

```
(defun merge-lists (list-a list-b sort-fn)
    "Merges two lists of (x, y) coordinates sorting them and removing dupes"
    (let   ((prev nil))
        (remove-if
            (lambda (point)
                (let   ((ret-val (equal point prev)))
                    (setf prev point)
                    ret-val))
            (sort
                (merge 'list list-a list-b sort-fn) ;'
                 sort-fn)))) 
```

有没有更好的方法来实现同样的目标？

示例调用：

```
[CL]> (merge-lists '(9 8 4 8 9 7 2) '(1 7 3 9 2 6) #'>)
  ==> (9 8 7 6 4 3 2 1) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-19T06:49:24.113

我们邻里友好的 Lisp 大师指出了[删除重复项功能](http://www.lispworks.com/documentation/HyperSpec/Body/f_rm_dup.htm)。

他还提供了以下片段：

```
(defun merge-lists (list-a list-b sort-fn test-fn)
    (sort (remove-duplicates (append list-a list-b) :test test-fn) sort-fn)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T06:38:58.743

我想我会先分别对这两个列表进行排序，然后将它们与一个也跳过重复项的函数合并。这应该会快一点，因为它需要少遍历两个列表。

PS：我怀疑它可以做得更快，因为你基本上总是需要至少一种排序和一次合并。也许您可以将两者结合在一个功能中，但如果这不会产生（大）差异，我不会感到惊讶。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T06:54:28.767

如果列表在合并之前已排序，则可以同时合并、删除重复和排序。如果它们已排序且无重复，则合并/排序/重复删除功能变得非常简单。

事实上，最好更改您的插入函数，以便它执行检查重复项的排序插入。然后你总是有没有重复的排序列表，合并它们是一件小事。

再说一次，您可能更喜欢以稍后排序/删除重复项为代价的快速插入功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T10:46:52.267

如果在删除重复项之前应用排序，删除重复项功能是否会更好地运行？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T12:05:50.333

正如 Antti 指出的那样，您可能想要利用 REMOVE-DUPLICATES 和 SORT，尽管我可能会为测试函数使用关键字（或可选参数）：(defun merge-lists (list-1 list-2 sort-fn &key (test #'eql)) ...) 或 (defun 合并列表 (list-1 list-2 sort-fn &optional (test #'eql) ...)

这样，您不必指定测试函数（由 REMOVE-DUPLICATES 用于测试“这些被认为是重复的”），除非 EQL 不够好。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-19T06:44:06.547

听起来你需要使用 Sets。

# wcf - WCF - 在您的服务中抛出 FaultExceptions 的开销

> ID：100053
> 
> 赞同：3
> 
> 时间：2008-09-19T06:31:53.003
> 
> 标签：wcf, exception, optimization

我发布了一个[关于](https://stackoverflow.com/questions/81306/wcf-faults-exceptions-versus-messages)使用消息与故障异常在服务之间传达业务规则的问题。

我的印象是通过网络抛出这个异常会带来开销，但考虑到它只是一个被序列化和反序列化的消息，它们实际上是相同的。

但这让我开始考虑抛出一般的异常或更具体地抛出 FaultExceptions。

现在在我的服务范围内，如果我使用

```
throw new FaultException 
```

传达一个简单的业务规则，例如“您的帐户尚未激活”，现在这会带来什么开销？它与在 .NET 中引发常规异常的开销相同吗？或者 WCF 服务是否使用故障契约更有效地处理这些问题。

所以在我的用户示例中，这是编写我的服务方法的最佳/首选方式

选项一

```
public void AuthenticateUser()
{
    throw new FaultException("Your account has not been activated");
} 
```

选项 b

```
public AutheticateDto AutheticateUser()
{
     return new AutheticateDto() { 
          Success = false,
          Message = "Your account has not been activated"};
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T06:50:07.233

嗯...一般来说，您不应该为预期的条件或您*希望*定期发生的任何事情抛出异常。它们比普通方法慢得多。例如，如果您希望文件打开失败，请不要向调用者抛出该异常，将失败代码传回，或提供“CanOpenFile”方法来进行测试。

确实，消息文本本身并不多，但是会抛出并处理一个真正的异常（可能由于 IIS 成本更高），然后在反序列化故障时再次在客户端上抛出真正的异常。所以，双杀。

老实说，如果通话量很少，那么您可能不会受到任何明显的打击，但无论如何也不是一个好主意。谁想把业务逻辑放在一个 catch 块中:)

[微软：例外和性能，及替代方案](http://msdn.microsoft.com/en-us/library/ms229009.aspx)

[开发者融合：性能，举例](http://www.developerfusion.co.uk/show/5250/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T06:44:19.027

它就像一个普通异常，并使用与普通异常相同的包装代码来编组为错误，包括展开堆栈。

就像异常一样，在我看来，SOAP 错误不应该用于程序流，而是用于指示错误。

# testing - 您如何测试您的 Web UI 以查看它是否在不同的浏览器中统一呈现？

> ID：100058
> 
> 赞同：7
> 
> 时间：2008-09-19T06:32:57.367
> 
> 标签：testing, browser, user-interface

Selenium 之类的工具非常适合测试 Web UI 上的用户交互。但是，我很好奇人们用什么方法来严格测试和验证网页是否在一组浏览器中正确呈现？

这甚至可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-19T06:38:40.600

我可以推荐[browsershots](http://browsershots.org/)，您可以在其中提交页面并让它们在各种浏览器中呈现出来，并打开或关闭各种设置，例如Flash和JavaScript。在一天结束时，您仍然需要安装 FF、IE6-8、Opera 和 Safari/Chrome 以进行手动测试。此外，如果您的朋友使用 Mac（或者如果您使用的是 Mac，则使用 PC）让他们在 Safari 中进行测试，因为我个人发现它们在呈现同一页面的方式上存在差异。

我还建议您主要在 Firefox 中进行开发，并在工作时定期在 IE6 中检查它。IE6 是最会搞砸的，所以如果它在这两种情况下都可以工作，那么它更有可能在所有情况下都可以工作。

当您发现渲染异常时，请先尝试在您的标记和 CSS 中修复它，然后再使用 CSS hack，因为它们可能会在以后或在其他浏览器中导致“有趣”的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T10:08:05.143

您只需要测试少数浏览器，因为有些浏览器共享一个通用的渲染引擎（[Gecko 或 Webkit](http://arstechnica.com/open-source/news/2008/09/mozilla-committed-to-gecko.ars)）。没有解释哪个或为什么，这是当前的智慧（2009）：

1.  使用 Firefox 或 Opera（在任何平台上）构建您的网站。BTW Opera 使用自己的 Presto 引擎；
2.  测试您没有使用的上述任何一个。
3.  验证 (X)HTML 和 CSS（重要！）。
4.  在 >=IE7 中测试它并注意故障（如果有）。
5.  在每个版本的 IE 的单独样式表中使用[条件注释-](http://msdn.microsoft.com/en-us/library/ms537512(VS.85).aspx)*永远不要*使用 CSS hack，因为它们会过时。
6.  如果您喜欢并执行相同的操作，请在 IE <7 中进行测试，或者使用条件注释（礼貌地）要求用户升级他们的 IE 版本。
7.  在 Safari (Webkit) 中进行测试。
8.  不要在 Chrome 中测试，您已经通过代理（Webkit）拥有！
9.  不要在 IE for Mac 中测试 - 份额太低，不再更新。

最后，尝试在 Firefox、Opera、IE 和 Safari 中放大文本。Opera 还具有适用于手机的手持仿真模式。

您现在将覆盖（戏剧性的猜测）99.9% 的浏览器设置。如果您使用的是 OS X 或 Linux，则可以在 Parallels 或[Wine](http://www.winehq.org/site/download)等虚拟环境中运行 Windows 。显然 Wine 也有一个 Windows 二进制文件，但我找不到它。**注意：**您需要确保您的虚拟环境允许 IE 读取条件注释。

在实践中，我发现如果一个站点有有效的代码并且可以在 Firefox、Safari 和 Opera 中运行，那么在 IE7 上可能会没问题。唯一的 HTML/CSS 问题是 IE 的“ [haslayout](http://www.satzansatz.de/cssd/onhavinglayout.html) ”处理。如果您没有浏览器，[BrowserStack](https://www.browserstack.com/)是一个出色的在线测试服务。

最后，如果您使用 Javascript，您将需要经历类似的过程，问题是作为一个快速发展的领域，一些浏览器的新版本以越来越有效的方式处理 Javascript，因此旧版本中的功能可能会中断或失败悄悄。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-20T12:11:13.137

Previously I was use WM for different versions of IE, but I find out some new tool for testing layout, and UI as well with this tool, [link](http://www.my-debugbar.com/wiki/IETester/HomePage) for FF use fire bug extension, those tools are for manually testing.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T06:36:14.863

手动？

如果您想进行严格的测试，我看不到其他选择。只需安装尽可能多的不同浏览器并在所有浏览器中进行测试。当然，这包括大多数流行浏览器的不同版本，您需要在 Windows、Linux 和 Macintosh 上进行检查。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T06:40:28.567

如果您只是想看看布局是否正确，只需将您的网站提交到[BrowserShots.org](http://browsershots.org/)并稍后访问以查看屏幕截图。

如果您想测试功能（JavaScript 等），则需要手动测试。

# c# - LINQ to SQL 插入 - 如果不存在

> ID：100068
> 
> 赞同：12
> 
> 时间：2008-09-19T06:35:08.330
> 
> 标签：c#, linq-to-sql

如果表中不存在记录，我想知道是否有更简单的方法来插入记录。我仍在尝试建立我的 LINQ to SQL 技能。

这就是我所拥有的，但似乎应该有一个更简单的方法。

```
public static TEntity InsertIfNotExists<TEntity>
(
    DataContext db,
    Table<TEntity> table,
    Func<TEntity,bool> where,
    TEntity record
)
    where TEntity : class
{
    TEntity existing = table.SingleOrDefault<TEntity>(where);

    if (existing != null)
    {
        return existing; 
    }
    else
    {
        table.InsertOnSubmit(record);

        // Can't use table.Context.SubmitChanges()
        // 'cause it's read-only

        db.SubmitChanges();
    }

    return record;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-19T08:30:35.650

```
public static void InsertIfNotExists<TEntity>
                    (this Table<TEntity> table,
                     TEntity entity,
                     Expression<Func<TEntity,bool>> predicate)
    where TEntity : class
{ 
    if (!table.Any(predicate)) 
    {
        table.InsertOnSubmit(record);
        table.Context.SubmitChanges();
    }
 }

table.InsertIfNotExists(entity, e=>e.BooleanProperty); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-01-25T22:02:09.073

正如其他人指出的那样，`if (!Any()) { InsertOnSubmit(); }`解决方案都有竞争条件。如果你走那条路，当你打电话时`SubmitChanges`，你必须考虑到a）a）`SqlException`可以为重复插入引发，或者b）你可能在表中有重复的记录。

幸运的是，我们可以使用数据库通过强制唯一性来避免竞争条件。下面的代码假定表上有一个主键或唯一约束，以防止插入重复记录。

```
using (var db = new DataContext()) {

    // Add the new (possibly duplicate) record to the data context here.

    try {
        db.SubmitChanges();
    } catch (SqlException ex) {
        const int violationOfPrimaryKeyContraint = 2627;
        const int violationOfUniqueConstraint = 2601;
        var duplicateRecordExceptionNumbers = new [] {
            violationOfPrimaryKeyContraint, violationOfUniqueConstraint
        };
        if (!duplicateRecordExceptionNumbers.Contains(ex.Number)) {
            throw;
        }
    }
} 
```

现在......如果您必须在具有其他数据库更新的批处理事务中执行插入，事情会变得更加复杂。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-19T09:06:44.143

同意[马克思的回答](https://stackoverflow.com/questions/100068/linq-to-sql-insert-if-non-existent#100496)，但见注1。

注意 1：恕我直言，调用辅助方法是不明智`db.SubmitChanges()`的，因为您可能会破坏上下文事务。这意味着，如果您`InsertIfNotExists<TEntity>`在多个实体的复杂更新中间调用 ，您不是一次保存更改，而是分步保存更改。

注 2：该`InsertIfNotExists<TEntity>`方法是一种非常通用的方法，适用于任何场景。如果您只想区分从数据库加载的实体和从代码创建的实体，可以使用`OnLoaded`Entity 类的部分方法，如下所示：

```
public partial class MyEntity
{
    public bool IsLoaded { get; private set; }
    partial void OnLoaded()
    {
        IsLoaded = true;
    }
} 
```

鉴于此（和注 1），InsertIfNotExists 功能被简化为以下内容：

```
if (!record.IsLoaded)
    db.InsertOnSubmit(record); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-21T10:37:12.220

马克回答的小修改：

如果您只关心通过其主键检查实体是否存在，则可以像这样使用 Marke 的答案：

```
public static void InsertIfNotExists<TEntity>
                    (this Table<TEntity> table
                     , TEntity entity
                    ) where TEntity : class
    {
        if (!table.Contains(entity))
        {
            table.InsertOnSubmit(entity);

        }
    } 
```

# c# - 为什么我不能通过 Resharper 的测试运行单元测试从单元测试中删除 %ProgramFiles% 中的文件？

> ID：100070
> 
> 赞同：2
> 
> 时间：2008-09-19T06:35:29.780
> 
> 标签：c#, unit-testing, testing, resharper

我正在尝试编写一个测试，在它的固定装置设置中，它备份一个文件并删除原始文件，在没有原始文件的情况下运行测试，然后在拆解中，从备份中恢复原始文件。该文件位于我的 %ProgramFiles% 文件夹中。我在 fileInfo.Delete() 语句上收到 UnauthorizedAccessException。从 Resharper 测试运行器未运行的同一台机器上的另一个测试项目中删除此文件没有问题。

我无法将文件移动到其他地方——它是 ssapi.dll，一个为 Visual SourceSafe 安装的 dll。（是的，我在单元测试中做一些侵入性的事情。）

两种方式都是同一个用户（我）——我通过任务管理器检查了它。我的用户帐户是本地管理员组的成员。还有哪些其他因素决定了我对文件做某事的“授权”？

已解决：虽然它没有回答我最初的问题（我仍然想知道答案），但我找到了一种用于测试目的的解决方法，使用 System.Security.Permissions 框架，对 FileIOPermissionAccess 执行需求。读入需要该文件（用于互操作调用）的应用程序（非测试）代码，并在该代码的测试中读取相同的拒绝，这需要该文件不存在的场景。这现在应该可以工作（我喜欢了解一些关于 System.Security.Permissions 命名空间的知识）！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T13:42:51.973

Not really a solution, but I'd consider fixing this problem from a different angle.

You could perhaps consider changing the directory to %AppData% (you might need to make this change for you main application also).

It might solve your problem and also will see you well when you move to Vista, since UAC could stop you (or the application user) from using the %ProgramFiles% directory.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T15:36:14.683

您可以通过授予您的用户帐户对该文件夹的完全访问权限来解决此问题。

导航到 Windows 资源管理器中的文件夹。右键单击该文件夹并选择属性。选择安全选项卡，然后选择编辑按钮，然后为自己添加完全控制权。是的 - 我认为这是一个潜在的安全问题，但您必须更改该目录中的文件，并且您似乎知道自己在做什么，所以它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T06:47:35.540

ReSharper 可能将其 Test Runner 作为一个单独的进程运行，并且该单独的进程没有使用您的 Windows 身份，而是使用另一个具有较低权限的身份。

您可能能够验证此打开任务管理器并检查所有用户的显示进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T07:01:04.667

您可以激活文件的审核，并检查事件日志中的错误消息。请注意，您必须在两个地方打开审核，一次在本地安全策略/本地策略/审核策略下，一次在文件本身上。这不会解决问题，但至少有助于诊断问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T19:33:18.190

您是否在打开 UAC 的情况下运行 Vista 或 Server 2008？如果是，这可能是原因 - 测试运行程序进程可能未处于“提升”模式。

# windows-server-2003 - Winsock - 10038 错误 - Win2K3 服务器 - 令人费解的行为

> ID：100074
> 
> 赞同：0
> 
> 时间：2008-09-19T06:37:32.490
> 
> 标签：windows-server-2003, winsock

尝试通过套接字发送消息失败，出现 WinSock 错误 10038。大约 40 秒后，从同一个套接字成功接收到消息，随后 send() 在同一个套接字中也成功。此行为已在 Windows Server 2003 中出现。这是 WinSock 和 Windows Server 2003 的任何已知行为吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T12:46:49.627

Winsock 错误 10038 表示“尝试对非套接字的操作进行操作”。

查找错误代码信息的小技巧（适用于各种 Windows 错误代码）：

*   打开命令提示符
*   输入“net helpmsg 10038”

您的应用程序是用什么语言编写的？如果是 C/C++，会不会是您使用了无效的套接字句柄？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-03T17:38:44.370

非常感谢 a_mole 检查分层的 winsock 提供程序的想法。我们的一些 PC 和 TimesTen DB 存在问题。当我们尝试设置 ODBC 客户端 DSN 时，我们收到 10038 错误。在检查受影响 PC 的 netsh 输出时，我们发现他们安装了 Wave Systems 的 Embassy Trust Suite。显然戴尔在他们的一些个人电脑上预装了这个。不管怎样，卸载这个软件，问题就解决了。

再次感谢

娄

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T23:46:34.510

不是平台问题，我可以保证。最有可能的是，您用于访问套接字句柄的任何变量都不是线程安全的，并且在创建实际套接字之前在 send() 调用中使用。

另一个可能的原因是存在分层的 Winsock 提供程序。cmd 提示符下的“netsh winsock show”将向您显示已安装的提供程序，您可以尝试删除任何非微软的提供程序。

# c# - 什么是 C# 中好的线程安全单例泛型模板模式

> ID：100081
> 
> 赞同：31
> 
> 时间：2008-09-19T06:41:07.503
> 
> 标签：c#, design-patterns

我有以下 C# 单例模式，有什么方法可以改进它吗？

```
 public class Singleton<T> where T : class, new()
    {

        private static object _syncobj = new object();
        private static volatile T _instance = null;
        public static T Instance
        {
            get
            {
                if (_instance == null)
                {
                    lock (_syncobj)
                    {
                        if (_instance == null)
                        {
                            _instance = new T();
                        }
                    }
                }
                return _instance;
            }
        }

        public Singleton()
        { }

    } 
```

首选用法示例：

```
class Foo : Singleton<Foo> 
{
} 
```

**相关**：

[.NET 的明显单例实现？](https://stackoverflow.com/questions/953259/an-obvious-singleton-implementation-for-net)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-19T06:52:39.380

根据 Jon Skeet 在[Implementation the Singleton Pattern in C#](https://csharpindepth.com/articles/Singleton)中的说法，您发布的代码实际上被认为是错误代码，因为在根据 ECMA CLI 标准检查时它似乎已损坏。

还要注意：每次用新类型的 T 实例化对象时，它都会变成另一个实例；它不会反映在您原来的单身人士中。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-19T07:05:24.373

此代码无法编译，您需要对 T 进行“类”约束。

此外，此代码需要目标类上的公共构造函数，这对单例不利，因为您无法在编译时控制仅通过 Instance 属性（或字段）获取（单个）实例。如果您没有除 Instance 之外的任何其他静态成员，则可以使用以下方法：

```
class Foo
{
  public static readonly Instance = new Foo();
  private Foo() {}
  static Foo() {}
} 
```

它是线程安全的（由 CLR 保证）和惰性（实例是在第一次访问类型时创建的）。有关 BeforeFieldInit 的更多讨论以及为什么我们需要静态构造函数，请参阅[https://csharpindepth.com/articles/BeforeFieldInit](https://csharpindepth.com/articles/BeforeFieldInit)。

如果您想在类型上有其他公共静态成员，但仅在访问实例时创建对象，您可以创建嵌套类型，如[https://csharpindepth.com/articles/Singleton](https://csharpindepth.com/articles/Singleton)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-19T06:45:48.960

由 Judith Bishop 提供，[http ://patterns.cs.up.ac.za/](http://patterns.cs.up.ac.za/)

这种单例模式实现确保了延迟初始化。

```
//  Singleton PatternJudith Bishop Nov 2007
//  Generic version

public class Singleton<T> where T : class, new()
{
    Singleton() { }

    class SingletonCreator
    {
        static SingletonCreator() { }
        // Private object instantiated with private constructor
        internal static readonly T instance = new T();
    }

    public static T UniqueInstance
    {
        get { return SingletonCreator.instance; }
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-10-25T15:41:55.927

这是我使用 .NET 4 的观点

```
public class Singleton<T> where T : class, new()
    {
        Singleton (){}

        private static readonly Lazy<T> instance = new Lazy<T>(()=> new T());

        public static T Instance { get { return instance.Value; } } 
    } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-15T05:52:39.020

我不认为你真的想“烧掉你的基类”，这样你就可以节省 2 行代码。你真的不需要基类来实现单例。

每当您需要单例时，只需执行以下操作：

```
class MyConcreteClass
{
  #region Singleton Implementation

    public static readonly Instance = new MyConcreteClass();

    private MyConcreteClass(){}

  #endregion

    /// ...
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-11T15:01:51.600

有关此答案的更多详细信息，请参见另一个线程：[如何在 C# 中实现单例？](https://stackoverflow.com/questions/246710/how-to-implement-a-singleton-in-c)

但是该线程不使用***generic***。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-19T06:46:55.463

```
public sealed class Singleton
{
   private static readonly Singleton instance = new Singleton();

   private Singleton(){}

   public static Singleton Instance
   {
      get 
      {
         return instance; 
      }
   }
} 
```

.NET 中的[初始化顺序没有歧义](http://msdn.microsoft.com/en-us/library/ms998558.aspx)；但这会引发线程问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-08-24T16:15:24.540

:/ Judith Bishop 的通用“单例”模式似乎有点缺陷，它总是可以创建多个类型 T 的实例，因为构造函数必须是公共的才能在这个“模式”中使用它。在我看来，它与单例完全无关，它只是一种工厂，它总是返回相同的对象，但不会使其成为单例......只要可以有多个类的实例它不能是单身人士。这种模式获得最高评价的任何原因？

```
public sealed class Singleton
{
  private static readonly Singleton _instance = new Singleton();

  private Singleton()
  {
  }

  public static Singleton Instance
  {
    get
    {
      return _instance;
    }
  }
} 
```

静态初始化器被认为是线程安全的。我不知道，但你根本不应该使用单例的习惯用法，如果你将我的代码包装在它不超过 3 行的上面......并且从单例继承不会使任何意义。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-18T03:39:15.760

根据要求，从我的原始答案交叉发布到另一个问题。

我的版本使用反射，与派生类中的非公共构造函数一起使用，是线程安全的（显然）具有延迟实例化（根据我在下面找到的链接）：

```
public class SingletonBase<T> where T : class
{
    static SingletonBase()
    {
    }

    public static readonly T Instance = 
        typeof(T).InvokeMember(typeof(T).Name, 
                                BindingFlags.CreateInstance | 
                                BindingFlags.Instance |
                                BindingFlags.Public |
                                BindingFlags.NonPublic, 
                                null, null, null) as T;
} 
```

几年前我捡到了这个，不确定我的多少钱，但如果不是我，谷歌搜索代码可能会找到该技术的原始来源。

这是[我能找到的最古老的代码来源，](http://www.360doc.com/content/070103/00/16729_316696.html)不是我发布的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-07-20T03:47:43.680

[Microsoft在此处](http://msdn.microsoft.com/en-us/library/ff650316.aspx)提供的 Double-Check Locking [Lea99] 习语与您提供的代码惊人地相似，不幸的是，这不符合 ECMA CLI 标准，即线程安全代码的清教徒视图，并且可能无法在所有情况下正常工作。

在多线程程序中，不同的线程可以尝试同时实例化一个类。出于这个原因，依赖 if 语句来检查实例是否为 null 的 Singleton 实现**将不是线程安全的**。不要写这样的代码！

创建线程安全单例的一种简单但有效的方法是使用嵌套类来实例化它。以下是惰性实例化单例的示例：

```
public sealed class Singleton
{ 
   private Singleton() { }

   public static Singleton Instance
   {
      get
      {
         return SingletonCreator.instance;
      }
   }

   private class SingletonCreator
   {
      static SingletonCreator() { }
      internal static readonly Singleton instance = new Singleton();
   }
} 
```

*用法：*

```
Singleton s1 = Singleton.Instance;
Singleton s2 = Singleton.Instance;
if (s1.Equals(s2))
{
    Console.WriteLine("Thread-Safe Singleton objects are the same");
} 
```

**通用解决方案：**

```
public class Singleton<T>
    where T : class, new()
{
    private Singleton() { }

    public static T Instance 
    { 
        get 
        { 
            return SingletonCreator.instance; 
        } 
    } 

    private class SingletonCreator 
    {
        static SingletonCreator() { }

        internal static readonly T instance = new T();
    }
} 
```

*用法：*

```
class TestClass { }

Singleton s1 = Singleton<TestClass>.Instance;
Singleton s2 = Singleton<TestClass>.Instance;
if (s1.Equals(s2))
{
    Console.WriteLine("Thread-Safe Generic Singleton objects are the same");
} 
```

最后，这里有一个相关且有用的建议 - 为了帮助避免使用 lock 关键字可能导致的死锁，请考虑添加以下属性以帮助保护仅公共静态方法中的代码：

```
using System.Runtime.CompilerServices;
[MethodImpl (MethodImplOptions.Synchronized)]
public static void MySynchronizedMethod()
{
} 
```

*参考：*

1.  C# Cookbook (O'Reilly)、Jay Hilyard 和 Stephen Teilhet
2.  C# 3.0 设计模式 (O'Reilly)，Judith Bishop
3.  [CSharp-Online.Net](http://en.csharp-online.net/Singleton_design_pattern%3A_Thread-safe_Singleton) - 单例设计模式：线程安全的单例

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-15T16:00:02.687

我一直在寻找一种更好的单例模式并且喜欢这个。因此将其移植到 VB.NET，对其他人有用：

```
Public MustInherit Class Singleton(Of T As {Class, New})
    Public Sub New()
    End Sub

    Private Class SingletonCreator
        Shared Sub New()
        End Sub
        Friend Shared ReadOnly Instance As New T
    End Class

    Public Shared ReadOnly Property Instance() As T
        Get
            Return SingletonCreator.Instance
        End Get
    End Property
End Class 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-10-19T20:53:56.840

试试这个以线程安全和惰性的方式实现 Singleton 设计模式的通用 Singleton 类（感谢 wcell）。

```
public abstract class Singleton<T> where T : class
{
    /// <summary>
    /// Returns the singleton instance.
    /// </summary>
    public static T Instance
    {
        get
        {
            return SingletonAllocator.instance;
        }
    }

    internal static class SingletonAllocator
    {
        internal static T instance;

        static SingletonAllocator()
        {
            CreateInstance(typeof(T));
        }

        public static T CreateInstance(Type type)
        {
            ConstructorInfo[] ctorsPublic = type.GetConstructors(
                BindingFlags.Instance | BindingFlags.Public);

            if (ctorsPublic.Length > 0)
                throw new Exception(
                    type.FullName + " has one or more public constructors so the property cannot be enforced.");

            ConstructorInfo ctorNonPublic = type.GetConstructor(
                BindingFlags.Instance | BindingFlags.NonPublic, null, new Type[0], new ParameterModifier[0]);

            if (ctorNonPublic == null)
            {
                throw new Exception(
                    type.FullName + " doesn't have a private/protected constructor so the property cannot be enforced.");
            }

            try
            {
                return instance = (T)ctorNonPublic.Invoke(new object[0]);
            }
            catch (Exception e)
            {
                throw new Exception(
                    "The Singleton couldnt be constructed, check if " + type.FullName + " has a default constructor", e);
            }
        }
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-30T09:14:50.710

我对确保按需创建实例数据的贡献：

```
 /// <summary>Abstract base class for thread-safe singleton objects</summary>
/// <typeparam name="T">Instance type</typeparam>
public abstract class SingletonOnDemand<T> {
    private static object __SYNC = new object();
    private static volatile bool _IsInstanceCreated = false;
    private static T _Instance = default(T);

    /// <summary>Instance data</summary>
    public static T Instance {
        get {
            if (!_IsInstanceCreated)
                lock (__SYNC)
                    if (!_IsInstanceCreated)
                        _Instance = Activator.CreateInstance<T>();
            return _Instance;
        }
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T06:55:17.393

我非常喜欢您的原始答案-唯一缺少的（根据吹镖发布的链接）是使 _instance 变量易失，以确保它实际上已被设置在锁中。当我必须使用单例时，我实际上使用吹镖解决方案，但我不需要后期实例化等。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-01-21T20:31:33.693

如[维基百科](http://en.wikipedia.org/wiki/Singleton_pattern)：

> 单例模式是一种**将类的实例化限制**为一个对象的设计模式

我相信使用泛型没有保证的方法，如果你限制了单例本身的实例化，如何限制主类的实例化，我认为不可能做到这一点，并实现这个简单的模式并不难，使用静态构造函数和私有集采取这种方式：

```
public class MyClass
{
        private MyClass()
        {

        }

        static MyClass()
        {
            Instance = new MyClass();
        }

        public static MyClass Instance { get; private set; }
} 
```

或者：

```
public class MyClass
    {
            private MyClass()
            {

            }

            static MyClass()
            {
                Instance = new MyClass();
            }

            private static MyClass instance;

            public static MyClass Instance
            {
                get
                {
                    return instance;
                }
                private set
                {
                    instance = value;
                }
            }
    } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-30T09:38:15.997

pff...再次... :)
我对确保按需创建实例数据的贡献：

```
 /// <summary>Abstract base class for thread-safe singleton objects</summary>
/// <typeparam name="T">Instance type</typeparam>
public abstract class SingletonOnDemand<T> {
  private static object __SYNC = new object();
  private static volatile bool _IsInstanceCreated = false;
  private static T _Instance = default(T);

  /// <summary>Instance data</summary>
  public static T Instance {
    get {
      if (!_IsInstanceCreated)
        lock (__SYNC)
          if (!_IsInstanceCreated) {
            _Instance = Activator.CreateInstance<T>();
            _IsInstanceCreated = true;
          }
          return _Instance;
    }
  }
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-09-24T20:25:24.583

```
public static class LazyGlobal<T> where T : new()
{
    public static T Instance
    {
        get { return TType.Instance; }
    }

    private static class TType
    {
        public static readonly T Instance = new T();
    }
}

// user code:
{
    LazyGlobal<Foo>.Instance.Bar();
} 
```

或者：

```
public delegate T Func<T>();

public static class CustomGlobalActivator<T>
{
    public static Func<T> CreateInstance { get; set; }
}

public static class LazyGlobal<T>
{
    public static T Instance
    {
        get { return TType.Instance; }
    }

    private static class TType
    {
        public static readonly T Instance = CustomGlobalActivator<T>.CreateInstance();
    }
}

{
    // setup code:
    // CustomGlobalActivator<Foo>.CreateInstance = () => new Foo(instanceOf_SL_or_IoC.DoSomeMagicReturning<FooDependencies>());
    CustomGlobalActivator<Foo>.CreateInstance = () => instanceOf_SL_or_IoC.PleaseResolve<Foo>();
    // ...
    // user code:
    LazyGlobal<Foo>.Instance.Bar();
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-09-24T20:34:57.010

前段时间看到一个使用反射来访问私有（或公共）默认构造函数：

```
public static class Singleton<T>
{
    private static object lockVar = new object();
    private static bool made;
    private static T _singleton = default(T);

    /// <summary>
    /// Get The Singleton
    /// </summary>
    public static T Get
    {
        get
        {
            if (!made)
            {
                lock (lockVar)
                {
                    if (!made)
                    {
                        ConstructorInfo cInfo = typeof(T).GetConstructor(BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic, null, new Type[0], null);
                        if (cInfo != null)
                            _singleton = (T)cInfo.Invoke(new object[0]);
                        else
                            throw new ArgumentException("Type Does Not Have A Default Constructor.");
                        made = true;
                    }
                }
            }

            return _singleton;
        }
    }
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-10-09T13:31:14.307

我将此提交给小组。它似乎是线程安全的、通用的并且遵循模式。你可以继承它。这是从其他人所说的拼凑而成的。

```
public class Singleton<T> where T : class
{
    class SingletonCreator
    {
        static SingletonCreator() { }

        internal static readonly T Instance =
            typeof(T).InvokeMember(typeof(T).Name,
                                    BindingFlags.CreateInstance |
                                    BindingFlags.Instance |
                                    BindingFlags.Public |
                                    BindingFlags.NonPublic,
                                    null, null, null) as T;
    }

    public static T Instance
    {
        get { return SingletonCreator.Instance; }
    }
} 
```

预期实施：

```
public class Foo: Singleton<Foo>
{
     private Foo() { }
} 
```

然后：

```
Foo.Instance.SomeMethod(); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-09-14T00:58:11.070

这对我有用：

```
public static class Singleton<T> 
{
    private static readonly object Sync = new object();

    public static T GetSingleton(ref T singletonMember, Func<T> initializer)
    {
        if (singletonMember == null)
        {
            lock (Sync)
            {
                if (singletonMember == null)
                    singletonMember = initializer();
            }
        }
        return singletonMember;
    }
} 
```

用法：

```
private static MyType _current;
public static MyType Current = Singleton<MyType>.GetSingleton(ref _current, () => new MyType()); 
```

使用单例：

```
MyType.Current. ... 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-07-04T08:39:19.983

无论您选择哪个示例，始终使用 Parallel.For 检查并发性！（迭代可以并行运行的循环）

放入 Singleton C'tor ：

```
 private Singleton ()
        {
            Console.WriteLine("usage of the Singleton for the first time");
        } 
```

放入 Main ：

```
Parallel.For(0, 10,
              index => {
                  Thread tt = new Thread(new ThreadStart(Singleton.Instance.SomePrintMethod));
                  tt.Start();
              }); 
```

* * *

## 回答 #22

> 赞同：-8
> 
> 时间：2008-09-19T07:02:49.403

您不需要所有这些，C# 已经内置了一个很好的单例模式。

```
static class Foo 
```

如果您需要比这更有趣的东西，那么您的新单例很可能会变得足够不同，以至于您的通用模式将毫无用处。

编辑：通过“任何更有趣的”我包括继承。如果你可以从单例继承，它就不再是单例了。

# java - 您认为 Java 中最好的 CMS

> ID：100089
> 
> 赞同：2
> 
> 时间：2008-09-19T06:45:01.567
> 
> 标签：java, content-management-system

您在 Java 中使用的是哪种 CMS，您对它的体验如何（在可扩展性、使用舒适度、框架 API、内存使用、性能等方面）。我正在寻找建议。

特别是支持搜索引擎的任何一个（可能是 lucene 或类似的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T17:13:56.990

“你用什么”这部分很容易回答，但正如“困惑”已经说过的那样——其余的取决于你的需要：

我们开始使用liferay，它基本上是一个带有cms portlet 的门户服务器。按照

**可扩展性**：它使用portlet api

**使用舒适度**：嗯......它并没有妨碍我们使用它。

**框架 API**：将 portlet api 作为 api，这比（例如）拥有自己的 API 的 OpenCMS 更具吸引力。

**内存使用**：还没有硬知识，但出于我们的需要，我们不希望任何可用的 cms 有坏事。

**性能**：与内存相同。

*如果您*想知道应该使用什么，请提出更具体的问题。如果您对系统列表感兴趣，请参阅[http://en.wikipedia.org/wiki/List_of_Content_Management_Systems](http://en.wikipedia.org/wiki/List_of_Content_Management_Systems)或[http://en.wikipedia.org/wiki/Content_management_framework](http://en.wikipedia.org/wiki/Content_management_framework)并过滤掉 java 的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T07:51:55.510

这在很大程度上取决于您的要求。例如，[Apache Lenya](http://lenya.apache.org/)非常完整，但这也使得它变得更大更复杂。如果您不需要它们的大部分功能，则最好使用较小的 cms。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T07:14:01.170

我们正在使用[opencms](http://www.opencms.org/en/)。我没有尝试将它扩展到更改页面模板（编写 JSP）之外，但是在使用方面它可以完成工作，尽管你得到的感觉是你一直在与系统作斗争。

运行 opencms 的 JVM 现在的内存消耗为 161 Mb，JVM 自 2008 年 1 月以来运行。这是一个低流量站点，每月提供大约 6000 次点击，平均每月流量为 1800 Mb。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T08:59:19.373

我使用[Magnolia](http://www.magnolia.info/home.html)，发现它非常干净且可定制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-27T15:48:23.503

看看 alfresco 和 day.com

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-20T10:03:34.263

这是[比较](http://goo.gl/gfvfo)。[Jahia](http://www.jahia.com/cms/home.html)也值得一试。

# c# - 如何让 silverlight 从 MySQL 获取数据

> ID：100104
> 
> 赞同：1
> 
> 时间：2008-09-19T06:48:44.617
> 
> 标签：c#, .net, mysql, silverlight, data-binding

我在 Silverlight 中编写了一个小型 hello world 测试应用程序，我想将它托管在 Linux/Apache2 服务器上。我希望数据来自 MySQL（或其他一些与 linux 兼容的数据库），以便我可以将数据绑定到数据库中的内容。

[我已经设法通过使用MySQL Connector/.NET](http://www.mysql.com/products/connector/net/)让它工作：

```
MySqlConnection conn = new MySqlConnection("Server=the.server.com;Database=theDb;User=myUser;Password=myPassword;");
conn.Open();
MySqlCommand command = new MySqlCommand("SELECT * FROM test;", conn);
using (MySqlDataReader reader = command.ExecuteReader())
{
     StringBuilder sb = new StringBuilder();
     while (reader.Read())
     {
         sb.AppendLine(reader.GetString("myColumn"));
     }
     this.txtResults.Text = sb.ToString();
} 
```

如果我完全信任已发布的 ClickOnce 应用程序（或至少是 SocketPermission）并**在本地运行它，这会很好**。

我希望它在服务器上运行，但我无法让它工作，总是以权限异常结束（不允许使用 SocketPermission）。

如果这有什么不同的话，数据库与 silverlight 应用程序托管在同一台服务器上。

**编辑** 好的，我现在明白为什么在客户端应用程序中拥有数据库凭据是一个坏主意（显然）。那么人们是如何做到这一点的呢？您如何保护代理 Web 服务，以便它以安全的方式将数据中继到客户端/db？网上有没有例子？

当然，我不能成为第一个想使用数据库来支持 silverlight 应用程序的人吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-06-01T14:33:21.800

虽然“官方”的答案是使用 WCF 将服务推送到 Silverlight，但我认为任何使用 MySQL 的人都可能不会使用完整的 ASP.NET 解决方案。我的解决方案是构建一个 PHP Web 服务（如 Rob 建议的那样）来与 MySQL 数据库交互并让 Silverlight 以 RESTful 方式访问它。

这是使用 Silverlight 通过 PHP Web 服务访问 MySQL 数据库的三部分教程的开头：

[PHP、MySQL 和 Silverlight：完整教程](http://www.designersilverlight.com/2010/05/23/php-mysql-and-silverlight-the-complete-tutorial-part-1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T18:26:40.037

做你想做的最简单的方法（现在已经阅读了你的编辑:)）将公开可以使用的服务。Microsoft 现在真正推动的模式是公开 WCF 服务，但事实是您的 Silverlight 客户端可以使用 WCF 来使用许多不同类型的服务。

您现在最容易做的事情是在 Web 服务器上使用 .NET 服务或 PHP REST 服务，然后将您的 Silverlight 应用程序指向该服务。通过这样做，您不仅可以保护您的数据库免受他人窥探，更重要的是，您可以限制人们可以对您的数据库执行的操作。如果您的数据应该是只读的，并且您的服务合同只允许读取操作，那么您已经设置好了。或者，您的服务可以再次通过 WCF 设置与凭据协商会话。

WCF 可以是仅客户端、仅服务器或客户端-服务器连接器平台。您选择的内容会影响您编写的代码，但这一切都将独立于您的数据库。您的代码可以构造成一对一映射到您的数据库表，或者它可以更加抽象（如果您愿意，您可以设置表示完整逻辑视图的类）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-19T07:38:08.677

Silverlight 没有任何直接访问数据库服务器的能力。您可以做的是通过 Web 服务（ASMX 或 WCF，甚至非 .NET！）公开您的数据库操作，并使用 Silverlight 访问这些服务。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-28T18:07:52.010

我刚刚开始工作；在 Linux Ubuntu 10 / Apache2 服务器上具有 Silverlight4 内容的 ASP.NET4 站点。内容是使用 Visual Studio 2010 开发的。VS2008 也应该可以正常工作。

服务器：

*   使用 Apache2 和 MySQL 设置 Linux 服务器，这方面有大量指南。
    *   确保可以从开发 PC 访问 MySQL，也可以从 Internet 访问 MySQL。有关详细信息，请参见此处：[拒绝访问错误的原因](http://dev.mysql.com/doc/refman/5.5/en/access-denied.html)。
    *   设置数据库表结构并添加一些内容以供稍后测试。在我们的示例中，我们假设您有表 'persons' 和列 'name'。
*   由于 Silverlight 是一种客户端技术，因此您非常适合使用，并且可以使用简单的 HTML 页面托管应用程序。
*   Silverlight 和 MySQL 之间需要 Web 服务。Microsoft 的 WCF RIA 是一种风格，但需要 .NET。从好的方面来说，您还可以托管 ASP.NET4 页面。这是设置它的详尽指南：[使用 MySql Membership 在 Ubuntu 上使用 Asp.Net 4.0 和 MVC2 设置 Mono 2.8](http://www.integratedwebsystems.com/2010/11/setting-up-mono-2-8-with-asp-net-4-0-and-mvc2-on-ubuntu-with-mysql-membership/)

视觉工作室：

*   安装最新的[MySQL Connector/Net](http://dev.mysql.com/downloads/connector/net/)并重启 VS
*   将您的 MySQL 数据库添加为数据源
    *   打开服务器资源管理器 -> 添加数据连接 -> 选择“MySQL 数据库”
    *   填写凭据并测试连接

设置具有 MySQL 访问权限的站点：

这是一个我觉得很有帮助的指南：[Step By Step Guide to WCF RIA enabled SL4 application with Entity Framework](http://manaspatnaik.com/blog/index.php/technology/silverlight-4/step-by-step-guide-to-wcf-ria-enabled-sl4-application-with-entity-framework/404)

*   创建或打开 Silverlight 项目。
    *   服务器端项目通常命名为“ProjectName.Web”
    *   客户端项目通常命名为“ProjectName”
*   将“ADO.NET 实体数据模型”添加到服务器项目。这将是您的数据库结构的模型。
    *   选择“从数据库生成”
    *   选择您创建的 MySQL 数据库连接
    *   选择要访问的表
*   在继续之前立即构建您的解决方案。
*   将“域服务类”添加到服务器项目 f.ex。'FooDomain'。这将使数据库实体可用于客户端 Silverlight 代码。
    *   在“可用的 DataContext/ObjectContext 类：”中选择您在上一步中创建的实体框架模型。
    *   检查您要访问的实体并在适当的地方选中“启用编辑”
    *   选中“为元数据生成关联类”
*   再次构建您的解决方案以基于服务器项目中的“FooDomain”生成“FooDomainContext”。

测试：

让我们将数据从 MySQL 导入 Silverlight。假设有一个名为“persons”的表，列名为“name”，我们可以绑定一个列表框来显示人员的姓名。

首先添加一个 Silverlight 页面，假设是“主页”。在 Home.xaml 添加：

```
<ListBox x:Name="TestList" Width="100" /> 
```

在 Home.xaml.cs 文件中添加：

```
public partial class Home : Page
{
    public Home()
    {
        InitializeComponent();

        Loaded += Home_Loaded;
    }

    void Home_Loaded(object sender, RoutedEventArgs e)
    {
        var context = new FooDomainContext();
        var query = context.Load(context.GetPersonsQuery());
        TestList.ItemsSource = query.Entities;
        TestList.DisplayMemberPath = "name";
    }
} 
```

在这里，我们假设您将域服务命名为“FooDomain”，这将生成使用的“FooDomainContext”类。

希望如果一切设置正确，您现在将在运行 Silverlight 项目时看到人员姓名列表。

**编辑：** ASP.NET 不是可选的，但在我的示例中使用的 WCF RIA Web 服务是必需的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T08:09:29.320

从客户端直接与服务器建立数据库连接通常是一个坏主意。我不知道反编译 Silverlight 应用程序有多么容易，但我想这在某种程度上是可能的。然后，您基本上是在将您的数据库凭据提供给您的用户。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-12-29T07:39:38.377

您可以使用 Web 服务从 MySQL 获取数据。

演练：

第 1 步：创建 Web 服务

步骤 2：将服务引用添加到 Silverlight

* * *

**第 1 步：创建 Web 服务**

添加一个新的 Silverlight 项目。

![添加一个新的 Silverlight 项目](../Images/25bbebf93bf5684e371d53d76edf9fa1.png)

创建一个新的 Web 服务。右键单击 web 项目 > 添加 > 新项目

![创建一个新的 Web 服务](../Images/8fc5095897f828ee4d0f4a5a6c35da9d.png)

选择“网络服务”。

![在此处输入图像描述](../Images/54bdfc70bc1fb203d4480ee5f781115f.png)

新 Web 服务的初始代码。

```
using System;
using System.Collections.Generic;
using System.Web;
using System.Web.Services;

namespace SilverlightApplication1.Web
{
    /// <summary>
    /// Summary description for WebService1
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    public class WebService1 : System.Web.Services.WebService
    {
        [WebMethod]
        public string HelloWorld()
        {
            return "Hello World";
        }
    }
} 
```

为了让 Web Service 能够连接到 MySQL，我们需要在 Web 项目中添加对 MySql.Data.DLL 的引用，并在 Web Service 类的顶部添加 Using 语句：

```
using MySql.Data.MySqlClient; 
```

**HelloWorld()**是 Visual Studio 创建的初始示例方法。您可能需要删除它，因为它不需要。我将创建 2 个简单的方法来演示如何使用 Web 服务在 SilverLight 和 MySQL 之间进行通信。

第一种方法：**ExecuteScalar()**

这个方法很简单。从 MySQL 获取单个对象。

```
public string ExecuteScalar(string sql)
{
    try
    {
        string result = "";
        using (MySqlConnection conn = new MySqlConnection(constr))
        {
            using (MySqlCommand cmd = new MySqlCommand())
            {
                conn.Open();
                cmd.Connection = conn;
                cmd.CommandText = sql;
                result = cmd.ExecuteScalar() + "";
                conn.Close();
            }
        }
        return result;
    }
    catch (Exception ex)
    {
        return ex.Message;
    }
} 
```

第二种方法：**ExecuteNonQuery()**

对于单个 SQL 执行。SQL 类型示例：INSERT、UPDATE、DELETE。

```
public string ExecuteNonQuery(string sql)
{
    try
    {
        long i = 0;
        using (MySqlConnection conn = new MySqlConnection(constr))
        {
            using (MySqlCommand cmd = new MySqlCommand())
            {
                conn.Open();
                cmd.Connection = conn;
                cmd.CommandText = sql;
                i = cmd.ExecuteNonQuery();
                conn.Close();
            }
        }
        return i + " row(s) affected by the last command, no resultset returned.";
    }
    catch (Exception ex)
    {
        return ex.Message;
    }
} 
```

这是添加上述两种方法后 Web Service 的样子：

```
using System;
using System.Collections.Generic;
using System.Web;
using System.Web.Services;
using MySql.Data.MySqlClient;

namespace SilverlightApplication1.Web
{
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    public class WebService1 : System.Web.Services.WebService
    {
        string constr = "server=localhost;user=root;pwd=1234;database=test;";

        [WebMethod]
        public string ExecuteScalar(string sql)
        {
            try
            {
                string result = "";
                using (MySqlConnection conn = new MySqlConnection(constr))
                {
                    using (MySqlCommand cmd = new MySqlCommand())
                    {
                        conn.Open();
                        cmd.Connection = conn;
                        cmd.CommandText = sql;
                        result = cmd.ExecuteScalar() + "";
                        conn.Close();
                    }
                }
                return result;
            }
            catch (Exception ex)
            {
                return ex.Message;
            }
        }

        [WebMethod]
        public string ExecuteNonQuery(string sql)
        {
            try
            {
                long i = 0;
                using (MySqlConnection conn = new MySqlConnection(constr))
                {
                    using (MySqlCommand cmd = new MySqlCommand())
                    {
                        conn.Open();
                        cmd.Connection = conn;
                        cmd.CommandText = sql;
                        i = cmd.ExecuteNonQuery();
                        conn.Close();
                    }
                }
                return i + " row(s) affected by the last command, no resultset returned.";
            }
            catch (Exception ex)
            {
                return ex.Message;
            }
        }  
    }
} 
```

您会注意到**[WebMethod]**的属性被添加到方法中。

重建项目并让 Web 服务为下一步做好准备。

![重建项目](../Images/7420cf4320b4a9192ab99aa93c15d485.png)

*网络服务访问权限*

请注意，默认情况下，Web Service 仅允许与 Web Service 托管在同一域中的 Silverlight 访问。如果 Silverlight 应用程序托管在另一个网站/域上，Web 服务将拒绝通信。因此，我们必须为托管在不同域的 Silverlight 配置 Web 服务的访问权限。

您必须创建两个附加文件：*clientaccesspolicy.xml*和*crossdomain.xml*。

这些文件必须放在托管 Web 服务的域的根目录中。

示例：`[http://www.mywebsite.com/clientaccesspolicy.xml](http://www.mywebsite.com/clientaccesspolicy.xml)`和`[http://www.mywebsite.com/crossdomain.xml](http://www.mywebsite.com/crossdomain.xml)`

*客户端访问策略.xml*

```
<?xml version="1.0" encoding="utf-8"?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="SOAPAction">
        <domain uri="*"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

如果您只想允许特定域访问 Web 服务（例如：www.myanotherwebsite.com），您可以将其添加到 . 例子：

```
<?xml version="1.0" encoding="utf-8"?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="SOAPAction">
        <domain uri="http://www.myanotherwebsite.com"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

*跨域.xml*

```
<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE cross-domain-policy SYSTEM 
"http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
  <allow-http-request-headers-from domain="*" headers="SOAPAction,Content-Type"/>
</cross-domain-policy> 
```

要了解有关此的更多信息，请阅读：[跨域边界提供服务 (MSDN)](http://msdn.microsoft.com/en-us/library/cc197955%28v=vs.95%29.aspx)

* * *

**步骤 2：将服务引用添加到 Silverlight**

添加对 Silverlight 的服务引用。

![添加对 Silverlight 的服务引用](../Images/a5a9909d213d03eb6448f1cab177469e.png)

输入 Web 服务的地址并按 [Go]。

地址示例：[http ://www.mywebsite.com/MyCoolWebService.asmx](http://www.mywebsite.com/MyCoolWebService.asmx)

将命名空间更改为您喜欢的，然后按 [OK]。

![网络服务浏览器](../Images/b6b658f94141ac7d1b98638763269271.png)

Visual Studio 将分析 Web 服务，进行数据绑定并创建一个类。

在继续编码之前，让我们看看我们可以在新创建的类中使用哪些方法。右键单击新类并选择[在对象浏览器中查看]。

![在对象浏览器中查看](../Images/8915ccd4a989ad9857ae97843f7c733e.png)

我们要使用的类是 WebService1SoapClient（在本例中）。命名基于服务名称。如果我们将我们的服务类命名为 MyCoolWebService，那么 MyCoolWebServiceSoapClient 将被选为 Silverlight 中类的名称。在右侧面板中，突出显示了两个方法和两个事件。这些是用于调用 Web 服务的方法。

![WebService1SoapClient 的对象](../Images/dbc1e19a34f03a3f6ce54bccbe54811b.png)

让我们通过添加一个文本框和两个按钮来创建一个简单的 Silverlight 应用程序。

在此示例中，用户将直接在文本框中键入 SQL 查询。

[ExecuteScalar] 的按钮会将 SQL 发送到 Web 服务并取回数据。（选择、显示等）

[ExecuteNonQuery] 按钮只会将 SQL 发送到 Web 服务执行。（插入、更新、删除等）

![设计一个简单的 SilverLight 应用程序](../Images/84578b4c160c56e7ca0c7be5b6a2d86c.png)

这是 MainPage.xaml 背后的初始代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;

namespace SilverlightApplication1
{
    public partial class MainPage : UserControl
    {
        public MainPage()
        {
            InitializeComponent();
        }

        private void btExecuteScalar_Click(object sender, RoutedEventArgs e)
        {
        }

        private void btExecuteNonQuery_Click(object sender, RoutedEventArgs e)
        {
        }
    }
} 
```

现在，这些是我们要在这里做的事情：

*   将服务声明为类级别的静态对象：ServiceReference1.WebService1SoapClient
*   创建两个方法的服务完成事件。
*   在按钮单击的情况下调用服务。
*   显示服务结果：MessageBox.Show()

```
public partial class MainPage : UserControl
{
    ServiceReference1.WebService1SoapClient myService;

    public MainPage()
    {
        InitializeComponent();
        myService = new ServiceReference1.WebService1SoapClient();
        myService.ExecuteScalarCompleted += myService_ExecuteScalarCompleted;
        myService.ExecuteNonQueryCompleted += myService_ExecuteNonQueryCompleted;
    }

    void myService_ExecuteNonQueryCompleted(object sender, 
                   ServiceReference1.ExecuteNonQueryCompletedEventArgs e)
    {
        MessageBox.Show(e.Result);
    }

    void myService_ExecuteScalarCompleted(object sender, 
         ServiceReference1.ExecuteScalarCompletedEventArgs e)
    {
        MessageBox.Show(e.Result);
    }

    private void btExecuteScalar_Click(object sender, RoutedEventArgs e)
    {
        myService.ExecuteScalarAsync(textBox1.Text);
    }

    private void btExecuteNonQuery_Click(object sender, RoutedEventArgs e)
    {
        myService.ExecuteNonQueryAsync(textBox1.Text);
    }
} 
```

按 [F5]，运行并测试 Silverlight 应用程序。

![测试](../Images/63591bb96fceec2c4dad930896c06996.png)

![测试](../Images/152bc77afd9d5dd35e65e797bb333495.png)

![测试](../Images/a5bb0ebdb7e7555991105056000bb494.png)

加上你的创意，相信你现在可以做的不止这些 微笑 | :)

如果您对 Web 服务进行了任何更改，也许您添加了新服务（新的 Web 方法），您必须在 Silverlight 更新服务参考以重新绑定服务。如果您将文件上传到不同的 Web 主机，您可能需要更新 Web 服务地址。

![更新服务参考](../Images/39614629e07c32d693e808a57c9c36b7.png)

快乐编码。

阅读更多：

1.  [原始帖子 - 从 SilverLight 连接 MySQL 与 Web 服务 - CodeProject.com（由我编写）](http://www.codeproject.com/Articles/633789/Connecting-MySQL-From-SilverLight-With-Web-Service)

2.  [从 Silverlight 应用程序访问 Web 服务](http://www.codeproject.com/Articles/263087/Access-a-Web-Service-from-a-Silverlight-Applicatio)

3.  [如何：使用 Visual C# .NET 编写简单的 Web 服务](http://support.microsoft.com/kb/308359)

4.  [如何：为 Silverlight 客户端构建服务](http://msdn.microsoft.com/en-us/library/cc197940%28v=vs.95%29.aspx)

# perl - 混淆谜题：你能弄清楚这个 Perl 函数的作用吗？

> ID：100106
> 
> 赞同：5
> 
> 时间：2008-09-19T06:49:14.427
> 
> 标签：perl, obfuscation, puzzle

```
sub foo {[$#{$_[!$||$|]}*@{$_[!!$_^!$_]}?@{$_[!$..!!$.]}[$_[@--@+]%
@{$_[$==~/(?=)//!$`]}..$#{$_[$??!!$?:!$?]},($)?!$):!!$))..$_[$--$-]%@{
$_[$]/$]]}-(!!$++!$+)]:@{$_[!!$^^^!$^^]}]} 
```

更新：我认为“拼图”这个词会暗示这一点，但是：*我*知道它的作用 - 我写了它。如果你对这个谜题不感兴趣，请不要在上面浪费任何时间。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-29T03:56:15.923

### 以下是您如何弄清楚如何对这个子例程进行去混淆处理。

*抱歉太长了*

首先让我们整理一下代码，并添加有用的注释。

```
sub foo {
  [
    (
      # ($#{$_[1]})
      $#{
        $_[
          ! ( $| | $| )
          # $OUTPUT_AUTOFLUSH === $|
          # $| is usually 0
          # ! ( $| | $| )
          # ! (  0 |  0 )
          # ! (  0 )
          # 1
        ]
      }

      *

      # @{$_[1]}
      @{
        $_[
          !!$_ ^ !$_

          # !! 1 ^ ! 1
          # !  0 ^   0
          #    1 ^   0
          # 1

          # !! 0 ^ ! 0
          # !  1 ^   1
          #    0 ^   1
          # 1
        ]
      }
    )

    ?

    # @{$_[1]}
    @{
      $_[
        !$. . !!$.
        # $INPUT_LINE_NUMBER === $.
        # $. starts at 1
        # !$. . !!$.
        # ! 1 . !! 1
        #   0 . ! 0
        #   0 . 1
        #   01
      ]
    }

    [
      # $_[0]
      $_[
        # @LAST_MATCH_START - @LAST_MATCH_END
        # 0
        @- - @+
      ]

      %

      # @{$_[1]}
      @{
        $_[
          $= =~ /(?=)/ / !$` #( fix highlighting )`/
          # $= is usually 60
          # /(?=)/ will match, returns 1
          # $` will be ''
          # 1 / ! ''
          # 1 / ! 0
          # 1 / 1
          # 1
        ]
      }

      ..

      # $#{$_[1]}
      $#{
        $_[
          $? ? !!$? : !$?

          # $CHILD_ERROR === $?
          # $? ? !!$? : !$?

          #  0 ? !! 0 : ! 0
          #  0 ?    0 :   1
          # 1

          #  1 ? !! 1 : ! 1
          #  1 ?    1 :   0
          # 1
        ]
      }

      ,

      # ( 0 )
      (
        $) ? !$) : !!$)

        # $EFFECTIVE_GROUP_ID === $)

        # $) ? !$) : !!$)

        #  0 ? ! 0 : !! 0
        #  0 ?   1 :    0
        # 0

        #  1 ? ! 1 : !! 1
        #  1 ?   0 :    1
        # 0
      )

      ..

      # $_[0]
      $_[
        $- - $- # 0

        # $LAST_PAREN_MATCH = $-

        # 1 - 1 == 0
        # 5 - 5 == 0
      ]

      %

      # @{$_[1]}
      @{
        $_[
          $] / $]
          # $] === The version + patchlevel / 1000 of the Perl interpreter.

          # 1 / 1 == 1
          # 5 / 5 == 1
        ]
      }

      -

      # ( 1 )
      (
        !!$+ + !$+

        # !! 1 + ! 1
        # !  0 + 0
        #    1 + 0
        # 1
      )
    ]

    :

    # @{$_[1]}
    @{
      $_[
        !!$^^ ^ !$^^

        # !! 1 ^ ! 1
        # !  0 ^   0
        #    1 ^   0
        # 1

        # !! 0 ^ ! 0
        # !  1 ^ 1
        #    0 ^ 1
        # 1
      ]
    }
  ]
} 
```

现在让我们删除一些混淆。

```
sub foo{
  [
    (
      $#{$_[1]} * @{$_[1]}
    )

    ?

    @{$_[1]}[
      ( $_[0] % @{$_[1]} ) .. $#{$_[1]}

      ,

      0 .. ( $_[0] % @{$_[1]} - 1 )
    ]

    :

    @{$_[1]}
  ]
} 
```

现在我们对发生的事情有了一些了解，让我们为变量命名。

```
sub foo{
  my( $item_0, $arr_1 ) = @_;
  my $len_1  = @$arr_1;

  [
      # This essentially just checks that the length of $arr_1 is greater than 1
      ( ( $len_1 -1 ) * $len_1 )
      # ( ( $len_1 -1 ) * $len_1 )
      # ( (      5 -1 ) *      5 )
      #             4   *      5
      # 20
      # 20 ? 1 : 0 == 1

      # ( ( $len_1 -1 ) * $len_1 )
      # ( (      2 -1 ) *      2 )
      #             1   *      2
      # 2
      # 2 ? 1 : 0 == 1

      # ( ( $len_1 -1 ) * $len_1 )
      # ( (      1 -1 ) *      1 )
      #             0   *      1
      # 0
      # 0 ? 1 : 0 == 0

      # ( ( $len_1 -1 ) * $len_1 )
      # ( (      0 -1 ) *      0 )
      #            -1   *      0
      # 0
      # 0 ? 1 : 0 == 0

    ?

      @{$arr_1}[
        ( $item_0 % $len_1 ) .. ( $len_1 -1 ),
        0 .. ( $item_0 % $len_1 - 1 )
      ]

    :

      # If we get here, @$arr_1 is either empty or has only one element
      @$arr_1
  ]
} 
```

让我们重构代码以使其更具可读性。

```
sub foo{
  my( $item_0, $arr_1 ) = @_;
  my $len_1  = @$arr_1;

  if( $len_1 > 1 ){
    return [
      @{$arr_1}[
        ( $item_0 % $len_1 ) .. ( $len_1 -1 ),
        0 .. ( $item_0 % $len_1 - 1 )
      ]
    ];
  }elsif( $len_1 ){
    return [ @$arr_1 ];
  }else{
    return [];
  }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-29T01:56:44.433

在处理我的其他答案时，我发现此命令很有帮助。

`perl -MO=Concise,foo,-terse,-compact obpuz.pl > obpuz.out`

[B::简洁](http://search.cpan.org/~rgarcia/perl-5.10.0/ext/B/B/Concise.pm)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-19T08:32:59.263

它需要两个数组引用并返回一个新的数组引用，其中第二个数组的内容重新排列，使得第二部分在第一部分之前，根据第一个数组的内存位置在一个点处拆分。当第二个数组为空或包含一项时，只返回第二个数组的副本。相当于以下内容：

```
sub foo {
    my ($list1, $list2) = @_;
    my @output;
    if (@$list2 > 0) {
        my $split = $list1 % @$list2;
        @output = @$list2[$split .. $#$list2, 0 .. ($split - 1)];
    } else {
        @output = @$list2;
    }
    return \@output;
} 
```

`$list1 % @$list2`本质上选择一个随机位置来拆分数组，基于`$list`该位置在数字上下文中评估时评估为 $list 的内存地址。

原文主要使用大量涉及标点符号变量的重言式来混淆。例如

*   `!$| | $|`总是 1
*   `@- - @+`始终为 0

更新到注意`perltidy`这里的破译非常有帮助，但是它卡住了`!!$^^^!$^^`，它重新格式化为`!!$^ ^ ^ !$^ ^`，这是无效的 Perl；它应该是`!!$^^ ^ !$^^`。这可能是 RWendi 编译错误的原因。

# java - 获取 java.lang.VerifyError 的原因

> ID：100107
> 
> 赞同：204
> 
> 时间：2008-09-19T06:49:17.813
> 
> 标签：java, exception, deployment, verifyerror

我正在调查以下内容`java.lang.VerifyError`

```
java.lang.VerifyError: (class: be/post/ehr/wfm/application/serviceorganization/report/DisplayReportServlet, method: getMonthData signature: (IILjava/util/Collection;Ljava/util/Collection;Ljava/util/HashMap;Ljava/util/Collection;Ljava/util/Locale;Lorg/apache/struts/util/MessageReÂ˜Ì´MtÌ´MÃšwÂ€mÃ§wÂ€mp:Â”MÂŒÂŒ
                at java.lang.Class.getDeclaredConstructors0(Native Method)
                at java.lang.Class.privateGetDeclaredConstructors(Class.java:2357)
                at java.lang.Class.getConstructor0(Class.java:2671) 
```

它在部署 servlet 的 jboss 服务器启动时发生。它是用 jdk-1.5.0_11 编译的，我尝试用 jdk-1.5.0_15 重新编译它但没有成功。那就是编译运行良好，但是在部署时，会发生 java.lang.VerifyError。

当我更改方法名称并收到以下错误时：

```
java.lang.VerifyError: (class: be/post/ehr/wfm/application/serviceorganization/report/DisplayReportServlet, method: getMD signature: (IILjava/util/Collection;Lj    ava/util/Collection;Ljava/util/HashMap;Ljava/util/Collection;Ljava/util/Locale;Lorg/apache/struts/util/MessageResources┬á├ÿ├àN|├ÿ├àN├Üw┬Çm├ºw┬ÇmX#├ûM|X├öM
            at java.lang.Class.getDeclaredConstructors0(Native Method)
            at java.lang.Class.privateGetDeclaredConstructors(Class.java:2357
            at java.lang.Class.getConstructor0(Class.java:2671)
            at java.lang.Class.newInstance0(Class.java:321)
            at java.lang.Class.newInstance(Class.java:303) 
```

您可以看到显示了更多方法签名。

实际的方法签名是

```
 private PgasePdfTable getMonthData(int month, int year, Collection dayTypes,
                          Collection calendarDays,
                          HashMap bcSpecialDays,
                          Collection activityPeriods,
                          Locale locale, MessageResources resources) throws   Exception { 
```

我已经试过用它来查看它，`javap`它给出了它应该的方法签名。

当我的其他同事检查代码、编译并部署它时，他们遇到了同样的问题。当构建服务器获取代码并将其部署到开发或测试环境 (HPUX) 时，会发生相同的错误。此外，运行 Ubuntu 的自动测试机在服务器启动期间显示相同的错误。

应用程序的其余部分运行正常，只有一个 servlet 出现故障。任何在哪里寻找的想法都会有所帮助。

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2010-03-25T17:40:48.603

`java.lang.VerifyError`当您针对与运行时使用的库不同的库进行编译时，可能会出现结果。

例如，当我尝试运行针对 Xerces 1 编译的程序时发生了这种情况，但在类路径中找到了 Xerces 2。所需的类（在`org.apache.*`命名空间中）是在运行时找到的，所以***不是***`ClassNotFoundException`结果。类和方法发生了变化，因此在运行时找到的方法签名与编译时的签名不匹配。

 *通常，编译器会标记方法签名不匹配的问题。JVM 将在加载类时再次验证字节码，并`VerifyError`在字节码尝试执行不应允许的操作时抛出异常——例如调用返回的方法，`String`然后将该返回值存储在包含`List`.

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-19T06:58:14.873

`java.lang.VerifyError`是最糟糕的。

如果您的方法的字节码大小超过 64kb 限制，您将收到此错误；但你可能已经注意到了。

您是否 100% 确定该类不存在于应用程序其他地方的类路径中，也许在另一个 jar 中？

另外，从您的堆栈跟踪中，源文件的字符编码（`utf-8`？）是否正确？

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-03-03T17:15:01.930

正如 Kevin Panko 所说，这主要是因为图书馆的变化。因此，在某些情况下，对项目（目录）进行“清理”，然后进行构建就可以了。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-19T12:14:03.297

您可能会尝试的一件事是使用`-Xverify:all`它将验证加载时的字节码，如果字节码无效，有时会提供有用的错误消息。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-01-11T12:13:20.720

VerifyError 意味着类文件包含语法正确但违反某些语义限制的字节码，例如跨越方法边界的跳转目标。

基本上，VerifyError 只会在存在编译器错误或类文件以其他方式损坏（例如，通过有故障的 RAM 或故障的 HD）时发生。

尝试在不同的机器上使用不同的 JDK 版本进行编译。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-12-13T00:17:57.220

我通过使我正在导入库的项目在 Android 上修复了此错误，如此处所述[http://developer.android.com/tools/projects/projects-eclipse.html#SettingUpLibraryProject](http://developer.android.com/tools/projects/projects-eclipse.html#SettingUpLibraryProject)

以前，我只是在引用该项目（而不是使它成为一个库）并且我得到了这个奇怪的 VerifyError。

希望它可以帮助某人。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-05-19T11:14:51.830

在我的情况下，我的 Android 项目依赖于为 Java 7 编译的另一个 Java 项目。`java.lang.VerifyError`在我将该 Java 项目的编译器合规级别更改为 6.0 后消失了

后来我发现这是一个 Dalvik 问题：[https ://groups.google.com/forum/?fromgroups#!topic/android-developers/sKsMTZ42pwE](https://groups.google.com/forum/?fromgroups#!topic/android-developers/sKsMTZ42pwE)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-27T21:03:35.820

由于 pack200 修改了类文件，我遇到了这个问题。稍微搜索一下就发现了这个[java 错误](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6313847)。基本上，设置`--effort=4`导致问题消失。

使用 java 1.5.0_17（尽管它出现在我尝试过的 java 1.5 的每个变体中）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-04-17T12:37:16.643

我通过替换修复了类似的 java.lang.VerifyError 问题

```
 catch (MagickException e) 
```

和

```
 catch (Exception e) 
```

where`MagickException`在库项目中定义（我的项目依赖于该项目）。

之后，我`java.lang.NoClassDefFoundError`从同一个库中获得了一个关于类的内容（根据[https://stackoverflow.com/a/9898820/755804](https://stackoverflow.com/a/9898820/755804)修复）。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-05-10T09:22:57.773

当您尝试加载针对 Oracle 的 JDK 编译的库时，这可能会在 Android 上发生。

[这是](https://groups.google.com/forum/?fromgroups=#!topic/asynchttpclient/Ml6bOndZbDY)Ning Async HTTP 客户端的问题。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-04-27T16:19:19.837

在我的情况下，我不得不删除这个块：

```
compileOptions {
    sourceCompatibility JavaVersion.VERSION_1_7
    targetCompatibility JavaVersion.VERSION_1_7
} 
```

它在`Fragment.showDialog()`方法调用附近显示错误。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-04-06T12:49:28.223

**产生错误的最小示例**

一种简单的可能性是使用[Jasmin](https://github.com/Sable/jasmin)，或者使用二进制文件编辑器手动编辑字节码。

让我们创建`void`没有`return`指令的方法（由`return;`Java 中的语句生成），JVMS 说这是非法的。

在 Jasmin 中，我们可以这样写：

```
.class public Main
.super java/lang/Object

.method public static main([Ljava/lang/String;)V
   aload_0 ; Just so that we won't get another verify error for empty code.
.end method 
```

然后我们说我们已经编译了`javac Main.j`：`javap -v Main`

```
public static void main(java.lang.String[]);
  descriptor: ([Ljava/lang/String;)V
  flags: ACC_PUBLIC, ACC_STATIC
  Code:
    stack=1, locals=1, args_size=1
       0: aload_0 
```

所以真的没有返回指令。

现在，如果我们尝试运行，`java Main`我们会得到：

```
Error: A JNI error has occurred, please check your installation and try again
Exception in thread "main" java.lang.VerifyError: (class: NoReturn, method: main signature: ([Ljava/lang/String;)V) Falling off the end of the code
        at java.lang.Class.getDeclaredMethods0(Native Method)
        at java.lang.Class.privateGetDeclaredMethods(Class.java:2701)
        at java.lang.Class.privateGetMethodRecursive(Class.java:3048)
        at java.lang.Class.getMethod0(Class.java:3018)
        at java.lang.Class.getMethod(Class.java:1784)
        at sun.launcher.LauncherHelper.validateMainClass(LauncherHelper.java:544)
        at sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:526) 
```

这个错误通常不会在 Java 中发生，因为 Java 编译器为我们添加了隐式`return`方法`void`。这就是我们不需要在方法中添加 a`return`的原因`main`。您可以使用`javap`.

**虚拟机**

当您尝试运行[JVMS 7 第 4.5 章指定的某些类型的非法类文件时，会发生 VerifyError](https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.8)

JVMS 表示，当 Java 加载文件时，它必须在运行之前运行一系列检查以查看类文件是否正常。

此类错误不能在 Java 代码的单个编译和运行周期中生成，因为[JVMS 7 4.10 说](https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.10)：

> 尽管 Java 编程语言的编译器必须只生成满足所有静态和结构约束的类文件 [...]

因此，要查看最小故障示例，我们需要生成不带`javac`.

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-19T06:57:23.567

这个页面可能会给你一些提示 - [http://www.zanthan.com/itymbi/archives/000337.html](http://www.zanthan.com/itymbi/archives/000337.html)

该方法的主体中可能存在 javac 未能发现的细微错误。除非您在此处发布整个方法，否则很难诊断。

您可以从声明尽可能多的变量作为 final 开始......这将捕获 zanthan 网站上提到的错误，并且通常是一个很好的做法。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-07-31T15:03:54.763

就我而言，我的项目 A 依赖于另一个项目，比如 X（A 正在使用 X 中定义的一些类）。所以当我在 A 的构建路径中添加 X 作为参考项目时，我得到了这个错误。但是，当我删除 X 作为引用项目并将 X 的 jar 作为库之一包含时，问题就解决了。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-05-02T20:47:59.460

检查类路径中同一 jar 文件的多个版本。

例如，我的类路径中有 opennlp-tools-1.3.0.jar 和 opennlp-tools-1.5.3.jar 并收到此错误。解决方案是删除 opennlp-tools-1.3.0.jar。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-09-18T01:26:20.347

此错误的另一个原因可能是 AspectJ <= 1.6.11 与 JRE > 6 的组合。

有关详细信息，请参阅[Eclipse 错误 353467](https://bugs.eclipse.org/bugs/show_bug.cgi?id=353467)和[Kieker 票证 307](http://kieker.uni-kiel.de/trac/ticket/307)。

当在 JRE 6 上一切正常并且迁移到 JRE7 时，情况尤其如此。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-09-18T01:30:11.307

CGLIB < 2.2 with JRE > 6 可能会触发类似的错误，请参阅[“我应该升级到 CGLIB 3.0 吗？”](https://stackoverflow.com/questions/14456692/should-i-upgrade-to-cglib-3-0) [以及Spring SPR-9669](https://jira.spring.io/browse/SPR-9669)上的一些评论。

当在 JRE 6 上一切正常并且简单地切换到 JRE7 时，情况尤其如此。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-05-04T12:09:09.383

当您使用 maven 导入大量模块时，也可能发生这种情况。将有两个或多个类具有完全相同的名称（相同的限定名称）。此错误是由编译时和运行时之间的解释差异引起的。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-02-16T05:57:46.450

如果您正在迁移到 java7 或使用 java7，那么通常可以看到此错误。我遇到了上述错误并努力找出根本原因，我建议在运行应用程序时尝试添加**“-XX:-UseSplitVerifier” JVM 参数。**

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-03-04T16:21:24.787

`Gradle`在*Android Studio 3.6.1*中更新后，API 19 在发布版本中发生了崩溃。

出现`Glide`库[错误](https://github.com/bumptech/glide/issues/3152#issuecomment-601699075)。解决方案是重写[proguard-rules.txt](https://github.com/bumptech/glide/blob/master/library/proguard-rules.txt)。

也可以降级`Gradle`（`classpath 'com.android.tools.build:gradle:3.5.3'`），但它是一个过时的解决方案，不要使用它。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-12-24T17:13:17.443

虽然凯文提到的原因是正确的，但我肯定会在转移到其他内容之前检查以下内容：

1.  检查`cglibs`我的类路径。
2.  检查`hibernate`我的类路径中的版本。

拥有上述任何一个版本的多个或冲突版本很可能会导致像所讨论的问题一样的意外问题。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-02-18T12:20:56.913

java.lang.VerifyError 表示您编译的字节码指的是 Android 找不到的东西。此 verifyError 仅向我**发出 kitkat4.4 和较小版本**的问题，即使我在两个设备中运行相同的版本，也不在上述版本中。当我使用旧版本的杰克逊 json 解析器时，它显示 java.lang.verifyerror

```
compile 'com.fasterxml.jackson.core:jackson-databind:2.2.+'
compile 'com.fasterxml.jackson.core:jackson-core:2.2.+'
compile 'com.fasterxml.jackson.core:jackson-annotations:2.2.+' 
```

然后我将 Dependancy 更改为没有**核心库的****最新版本 2.2 到 2.7**，然后它就可以工作了。这意味着**core**的 Methods 和其他内容被迁移到最新版本的**Databind2.7**。这解决了我的问题。

 ******```
compile 'com.fasterxml.jackson.core:jackson-annotations:2.7.0-rc3'
compile 'com.fasterxml.jackson.core:jackson-databind:2.7.0-rc3' 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-12-27T10:07:10.450

请删除任何不可用的 jar 文件并尝试运行。及其对我的工作我添加了一个 jcommons jar 文件和另一个 jcommons.1.0.14 jar 文件，因此删除 jcommons 及其为我工作

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-09-09T16:52:27.520

写在文件上：

```
{Wildfly-home}\modules\system\layers\base\org\picketbox\main 
```

接下来进入依赖项：`<module name="sun.jdk"/>`

* * *

## 回答 #25

> 赞同：-2
> 
> 时间：2018-01-04T04:50:12.263

就我而言，我在下面的堆栈跟踪中遇到了验证错误

```
jasperreports-server-cp-6.4.0-bin\buildomatic\build.xml:61: The following error occurred while executing this line:
TIB_js-jrs-cp_6.4.0_bin\jasperreports-server-cp-6.4.0-bin\buildomatic\bin\setup.xml:320: java.lang.VerifyError: (class: org/apache/commons/codec/binary/Base64OutputStream, method: <init> signature: (Ljava/io/OutputStream;ZI[B)V) Incompatible argument to function
    at com.jaspersoft.jasperserver.crypto.KeystoreManager.createKeystore(KeystoreManager.java:257)
    at com.jaspersoft.jasperserver.crypto.KeystoreManager.init(KeystoreManager.java:224)
    at com.jaspersoft.buildomatic.crypto.KeystoreTask.execute(KeystoreTask.java:64)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:292)
    at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:498)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.taskdefs.Sequential.execute(Sequential.java:68)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:292)
    at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:498)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.Target.execute(Target.java:435)
    at org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:169)
    at org.apache.tools.ant.taskdefs.ImportTask.importResource(ImportTask.java:222)
    at org.apache.tools.ant.taskdefs.ImportTask.execute(ImportTask.java:163)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:292)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:498)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.Target.execute(Target.java:435)
    at org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:180)
    at org.apache.tools.ant.ProjectHelper.configureProject(ProjectHelper.java:93)
    at org.apache.tools.ant.Main.runBuild(Main.java:826)
    at org.apache.tools.ant.Main.startAnt(Main.java:235)
    at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
    at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109) 
```

我通过删除 commons-codec-1.3.jar 的类路径条目解决了这个问题，这个 jar 的版本与 Jasper 附带的版本不匹配。*******

# java - 应用程序范围的键盘快捷键 - Java Swing

> ID：100123
> 
> 赞同：33
> 
> 时间：2008-09-19T06:54:03.887
> 
> 标签：java, swing, shortcut, keystroke

我想为 Java Swing 应用程序创建一个应用程序范围的键盘快捷键。循环遍历所有组件并在每个组件上添加快捷方式，具有与焦点相关的副作用，并且似乎是一种蛮力解决方案。

有人有更清洁的解决方案吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-09-19T09:35:47.053

对于每个窗口，使用`JComponent.registerKeyboardAction`条件为`WHEN_IN_FOCUSED_WINDOW`. 或者使用：

```
JComponent.getInputMap(WHEN_IN_FOCUSED_WINDOW).put(keyStroke, command);
JComponent.getActionMap().put(command,action); 
```

如[registerKeyboardAction API 文档](http://docs.oracle.com/javase/6/docs/api/javax/swing/JComponent.html#registerKeyboardAction%28java.awt.event.ActionListener,%20java.lang.String,%20javax.swing.KeyStroke,%20int%29)中所述。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-19T06:58:36.543

安装自定义 KeyEventDispatcher。KeyboardFocusManager 类也是这个功能的好地方。

[键事件调度程序](http://java.sun.com/javase/6/docs/api/java/awt/KeyEventDispatcher.html)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-12-13T07:52:07.780

对于想知道（像我一样）如何使用 KeyEventDispatcher 的人，这是我放在一起的一个示例。它使用 HashMap 来存储所有全局操作，因为我不喜欢大型`if (key == ..) then .. else if (key == ..) then .. else if (key ==..) ..`构造。

```
/** map containing all global actions */
private HashMap<KeyStroke, Action> actionMap = new HashMap<KeyStroke, Action>();

/** call this somewhere in your GUI construction */
private void setup() {
  KeyStroke key1 = KeyStroke.getKeyStroke(KeyEvent.VK_A, KeyEvent.CTRL_DOWN_MASK);
  actionMap.put(key1, new AbstractAction("action1") {
    @Override
    public void actionPerformed(ActionEvent e) {
      System.out.println("Ctrl-A pressed: " + e);
    }
  });
  // add more actions..

  KeyboardFocusManager kfm = KeyboardFocusManager.getCurrentKeyboardFocusManager();
  kfm.addKeyEventDispatcher( new KeyEventDispatcher() {

    @Override
    public boolean dispatchKeyEvent(KeyEvent e) {
      KeyStroke keyStroke = KeyStroke.getKeyStrokeForEvent(e);
      if ( actionMap.containsKey(keyStroke) ) {
        final Action a = actionMap.get(keyStroke);
        final ActionEvent ae = new ActionEvent(e.getSource(), e.getID(), null );
        SwingUtilities.invokeLater( new Runnable() {
          @Override
          public void run() {
            a.actionPerformed(ae);
          }
        } ); 
        return true;
      }
      return false;
    }
  });
} 
```

使用 SwingUtils.invokeLater() 可能不是必需的，但最好不要阻塞全局事件循环。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-12-13T07:19:57.970

当你有一个菜单时，你可以为菜单项添加全局键盘快捷键：

```
 JMenuItem item = new JMenuItem(action);
    KeyStroke key = KeyStroke.getKeyStroke(
        KeyEvent.VK_R, KeyEvent.CTRL_DOWN_MASK);
    item.setAccelerator(key);
    menu.add(item); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-04-21T10:48:30.893

一个简单的例子：

```
KeyboardFocusManager keyManager;

keyManager=KeyboardFocusManager.getCurrentKeyboardFocusManager();
keyManager.addKeyEventDispatcher(new KeyEventDispatcher() {

  @Override
  public boolean dispatchKeyEvent(KeyEvent e) {
    if(e.getID()==KeyEvent.KEY_PRESSED && e.getKeyCode()==27){
      System.out.println("Esc");
      return true;
    }
    return false;
  }

}); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-07-04T20:49:20.277

使用以下代码

```
ActionListener a=new ActionListener(){
   public void actionPerformed(ActionEvent ae)
   {
    // your code
   }
};
getRootPane().registerKeyboardAction(a,KeyStroke.getKeyStroke("ctrl D"),JComponent.WHEN_IN_FOCUSED_WINDOW); 
```

将“ctrl D”替换为您想要的快捷方式。

# eclipse - Eclipse 3.4 (Ganymede) 内存使用率是否明显高于 3.2？

> ID：100161
> 
> 赞同：4
> 
> 时间：2008-09-19T07:05:42.967
> 
> 标签：eclipse, eclipse-3.4, ganymede

我很高兴使用 Eclipse 3.2（或者像使用 Eclipse 一样高兴），但由于某种被遗忘的原因，我决定升级到 3.4。我主要使用 PyDev、Aptana 和 Subclipse，很少使用 Java 开发。

我注意到与 3.2（vista、core2duo、2G）相比，3.4 往往会给我的笔记本电脑带来疝气。3.4 的内存使用量实际上是否高于 3.2，如果是，有没有办法减少它？

编辑：我尝试禁用插件（反正我没有启用太多）并使用了 jvm 监视器；后者很有趣，但我不知道如何以任何实际的方式使用这些信息。我仍然无法减少它的内存占用。我也注意到每隔一段时间 Eclipse 只会挂起约 30 秒，然后神奇地回来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T07:11:23.983

是的，内存使用可能会变得非常高，并且您可能会遇到 JVM 问题，因为默认设置有点低。运行 eclipse 时考虑使用这个启动参数：

```
-vmargs -XX:MaxPermSize=1024M -Xms256M -Xmx1024M 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T11:20:19.220

使用这些选项，我设法将使用的内存限制为 700Mo（这是相当高的，但仍然适用于我的 2 Go）

```
-vmargs
-Xms128m
-Xmx384m
-Xssv2m
-XX:PermSize=128m
-XX:MaxPermSize=128m
-XX:CompileThreshold=5
-XX:+UseParallelGC
-Dcom.sun.management.jmxremote 
```

并考虑推出

```
C:\[jdk1.6.0_0x path]\bin\jconsole.exe 
```

并选择'Connection/New connection/'eclipse'来监控eclipse使用的内存
（这就是我使用'-Dcom.sun.management.jmxremote'的原因）

[此处](http://my.opera.com/karmazilla/blog/2007/03/13/good-riddance-permgen-outofmemoryerror)提供其他选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-25T06:28:31.140

要添加到我之前的答案和您最近的更新：

> Eclipse 只挂起约 30 秒，然后神奇地回来了。

这通常表示网络访问失败并出现超时（以及应用程序等待所述超时时相关的“冻结”）。

尝试在 DOS 提示符下键入“net use”，并检查您是否在此处声明了网络路径，其中一些您可以删除（“net use /D aUselessPath”）。可以肯定的是，还要检查您声明的份额（净份额）。

* * *

由于您使用的是 Vista，请尝试停用**[superfetch](http://www.speedyvista.com/services/Superfetch.php)**并查看您是否仍然遇到这些冻结（对于 eclipse 和 Firefox）。
使用管理权限打开 CMD 提示符并输入“net stop superfetch”以停止 SuperFetch 服务。
不过，这不是一个好的长期解决方案，只是快速检查一下。Superfetch 应该保持打开状态，并且实际上会在您下次重新启动时重新启动，因为该服务设置为在每个 Windows 会话时自动启动。
同样，这只是为了查看该服务与您的冻结之间是否存在任何联系。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-22T04:33:42.440

您拥有的插件越多，Eclipse 消耗的内存就越多。3.4 默认包含比 3.3 更多的插件，依此类推，因为越来越多的开发人员要求包含更多功能。

转到 Window->Show View，然后开始输入“plug in”，其中一个选项将是 Plug In Registry。打开该视图，然后单击箭头以仅显示活动插件。这些是实际加载到内存中的插件。我的 Eclipse 3.3 目前加载了 445 个左右的插件中的 89 个。然后，您可以有选择地从“帮助”菜单开始禁用插件，一旦您看到您不会使用哪些插件（例如，现在我没有使用 Mylyn，但我希望将来会这样做）。

# linux - 有没有办法检查是否有指向目录的符号链接？

> ID：100170
> 
> 赞同：67
> 
> 时间：2008-09-19T07:08:42.447
> 
> 标签：linux, symlink

我的服务器上有一个文件夹，有许多符号链接指向该文件夹。我已经创建了一个新文件夹，我想更改所有这些符号链接以指向新文件夹。我曾考虑用指向新文件夹的符号链接替换原始文件夹，但似乎如果我继续这种做法，它可能会很快变得非常混乱。

我一直在做的是手动更改符号链接以指向新文件夹，但我可能错过了几个。

有没有办法检查是否有任何符号链接指向特定文件夹？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-09-19T07:15:09.810

我会使用 find 命令。

```
find . -lname /particular/folder 
```

这将递归搜索当前目录的符号链接到`/particular/folder`. 请注意，它只会找到绝对符号链接。可以使用类似的命令来搜索指向名为“文件夹”的对象的所有符号链接：

```
find . -lname '*folder' 
```

从那里你需要清除任何误报。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-03-13T10:46:03.310

[您可以使用 Mark Lord 编写的`symlinks`程序](http://linux.die.net/man/8/symlinks)审核符号链接——它将扫描整个文件系统，将符号链接路径标准化为绝对形式并将它们打印到标准输出。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-19T07:19:03.293

实际上没有任何直接的方法可以检查此类符号链接。考虑到您可能有一个未始终挂载的文件系统（例如，外部 USB 驱动器），其中可能包含指向系统上另一个卷的符号链接。

你可以做一些事情：

```
for a in `find / -type l`; do echo "$a -> `readlink $a`"; done | grep destfolder 
```

我注意到 FreeBSD`find`不支持该`-lname`选项，这就是我最终选择上述内容的原因。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-10-08T15:26:08.630

```
find . -type l -printf '%p -> %l\n' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T07:19:39.550

除了查看所有其他文件夹是否有指向原始文件夹的链接外，我认为这是不可能的。如果是的话，我会很感兴趣。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T07:16:28.370

```
find / -lname 'fullyqualifiedpathoffile' 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T07:17:41.083

对于硬链接，您可以使用“ls”选项之一（`-i`我认为）获取目录的 inode。

然后`find`with`-inum`将找到所有常见的硬链接。

对于软链接，您可能必须`ls -l`在所有文件上查找“->”之后的文本并将其规范化以确保它是绝对路径。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-03T12:50:31.850

```
find /foldername -type l -exec ls -lad {} \; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-28T12:06:45.480

对于任何看这里的程序员（cmdline 工具问题可能现在应该转到 unix.stackexchange.com）：

您应该知道，Linux/BSD 函数`fts_open()`为您提供了一个易于使用的迭代器，用于遍历所有子目录内容，同时还检测此类符号链接递归。

大多数命令行工具都使用此功能为它们处理这种情况。那些不经常遇到符号链接递归问题的人，因为“手动”这样做很困难（任何知道它的人都应该使用上面的函数）。

# specifications - 你用什么工具/格式来写你的规范？

> ID：100174
> 
> 赞同：6
> 
> 时间：2008-09-19T07:09:48.683
> 
> 标签：specifications

我想知道您使用哪种工具来编写规范。我认为使用支持某种纯文本格式的工具是必不可少的，这样人们就可以使用像 SVN 这样的源代码控制系统来控制规范。对于规范和代码一样，拥有所有更改的历史记录很重要。

目前我们以 XML 格式编写规范。TeX 也是一种替代方案，但对于从未使用过它的人来说很难。

所以让我知道，你使用什么样的工具或格式来制定规范。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T07:19:51.233

DocBook 使用 XXE 编辑，在需要发送给客户时使用 xslt 翻译成 pdf。

有史以来最好的改变，更容易编写，更容易合并，而且当它被转换时，它看起来不像 MSWord 那样不专业。

再加上结构化的文档样式已经存在，不像你必须与之斗争才能开始工作的血腥词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T07:13:37.443

我们使用了 TeX (MikTeX)，它非常完美，因为：

*   纯文本 - 在 Vim/记事本中编辑 - 无处不在
*   我们中的一个人使用预定义的宏进行了强大的格式化
*   onclick 生成为 PDF

唯一的问题是获取图表（来自 ArgoUML）。

在另一个项目中，我看到使用 Word 模板 - 来自上面的可怕东西。

我会考虑在 Intranet 上使用类似 wiki/forum 的东西。想象一下使用 GoogleDocs - 有版本控制，它是在线的.. 但不适用于商业开发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T04:36:39.017

在工作中，我们的许多文档都在 Sharepoint 或其他一些真正减慢文档“发布”速度的文档系统下。这意味着到处都有文件的副本，让某人正确发布某些东西是一件令人头疼的事情。因此，我通常会收到电源点或废纸上的规格。所以我在工作中建立了一个 wiki (Media Wiki)，我们现在将所有项目规范保存在其中。这使公司中的任何人都可以查看它们，并且可以由我们的开发团队进行编辑。有时开发人员会在他们经过或其他任何事情时要求老板澄清，并且开发人员可以自己更新规范，我认为这是一个巨大的优势。还，

我仍然保留在我墙上的一些笔记本纸上潦草的规格作为提醒。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T07:10:52.363

我已经开始使用[Docbook](http://www.docbook.org/)来处理所有这些事情。它简单、灵活，可以生成 html、tex（以及 pdf）等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T07:13:44.570

微软Word。我知道它不符合您的要求，但在我从事的每项工作中，我都使用 Microsoft Word 作为规范。您可以，而且我已经将 Word 文档放在源代码控制系统中 - 您唯一失去的就是区分文档的能力。尽管我隐约记得在某处读到过可以使用单词的差异工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T04:01:02.520

在工作中，我们使用 wiki，因为它们非常适合协作，但 Microsoft Word 也可以。

实际上，您可以使用 Word 本身来区分 Word 文档的两个不同版本 - 它使用“跟踪更改”功能来显示差异。（如果您不相信我，请尝试使用 TortoiseSVN 区分 Word 文档的两个版本。）

对于长文档，我实际上更喜欢 Word 而不是 wiki，因为它非常适合编辑长文档，而且商务人士更喜欢使用 Word 文档。

# icons - windows中应用程序图标的最佳实践

> ID：100177
> 
> 赞同：3
> 
> 时间：2008-09-19T07:10:36.107
> 
> 标签：icons, windows

到目前为止，我已经在 Visual-Studio-Editor 中“设计”了我的应用程序图标。16 色，4kB。现在有人为我创建了一个更复杂和最新的应用程序图标，其文件大小约为 250kB。

**问题：**一位用户报告说，win2000 正在抱怨，因为它无法消化这个图标的数据量。

**问题：**什么可以被视为*application-icons 的最佳实践*。详细说明：图标中应包含哪些分辨率和哪些颜色深度变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-19T04:25:06.110

icoFX 是我刚刚发现的免费图标编辑器。它似乎工作得很好 - 您只需选中您想要“从属”到您编辑的 256x256 大图标的格式框。搜索 icoFX 的堆栈溢出 - 其他人同意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T08:52:55.380

我一直试图坚持以下一组尺寸，以便在大多数系统上获得合理的图标。

*   16 x 16 16 色
*   16 x 16 XP 风格（带有 Alpha 通道信息的真彩色）
*   32 x 32 256 色
*   32 x 32 XP 风格
*   48 x 48 XP 风格
*   64 x 64 XP 风格

这会产生一个大小约为 35KB 的图标，并且似乎可以在从 win95/98 一直到 Vista 的系统上运行。我仍然在 Win2000 机器上开发，这些工作正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T08:40:05.130

我想说最好的做法是遵循 Microsoft 使用 XP 和 Vista 图标设置的图标示例。现在很少看到少于 256 个颜色的图标，当我看到它们时，我觉得这个程序很古怪而且过时了。也许最好的选择是等待微软添加 SVG 图标支持；如果幸运的话，也许在 Windows 7 中？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T07:49:40.867

总的来说，我不会再关心 Windows 2000，因为即使微软已经开始停止对它的支持。对于 Windows XP [，MSDN 上的这篇文章](http://msdn.microsoft.com/en-us/library/ms997636.aspx)可能会对您有所帮助。

# visual-studio-2008 - Adding a classic ASP webapplication to VS 2008

> ID：100187
> 
> 赞同：2
> 
> 时间：2008-09-19T07:13:32.717
> 
> 标签：visual-studio-2008, asp-classic, solution

is there a way to add an existing classic ASP webapp into a solution in VS? The application is around 4000 files large and currently maintained outisde Visual Studio.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T07:34:20.043

The best way to do this IMO is:-

In VS 2008 File | Open | Web Site...

In the dialog ensure File System is selected. Navigate to the physical folder that represents the root of your Web app.

Click Open. Job Done.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T07:34:52.897

You can't do this with Visual Studio 2008 out of the box, but you can if you install Service Pack 1 - see S[cott Guthrie's blog post](http://weblogs.asp.net/scottgu/archive/2008/05/12/visual-studio-2008-and-net-framework-3-5-service-pack-1-beta.aspx) for more info.

**Edit:** To clarify, whilst you can create a project out of the box, there is no intellisense or debugging unless you install SP1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T07:32:08.177

There's no real point though is there? As Classic ASP files aren't compiled. I keep just opening them individually as needed from File Explorer.

Although you could add them all to a VBProj or CSProj so you get them all showing up in your Solution Explorer, and could use features like Project -> Deploy.

# .net - .NET 列表 Concat 与 AddRange

> ID：100196
> 
> 赞同：107
> 
> 时间：2008-09-19T07:14:48.640
> 
> 标签：.net, linq, list, extension-methods

泛型 List 上的[AddRange](https://msdn.microsoft.com/en-us/library/z883w3dc(v=vs.110).aspx)和[Concat](https://msdn.microsoft.com/en-us/library/bb302894(v=vs.110).aspx)函数有什么区别？一个比另一个推荐吗？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2008-09-19T07:17:46.153

它们具有完全不同的语义。

AddRange 通过将其他项目添加到列表中来修改列表。

Concat 返回一个包含列表和其他项目的新序列，而不修改列表。

选择具有您想要的语义的任何一个。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-09-19T07:26:23.637

最大的区别是它`AddRange`改变了调用它的列表，同时`Concat`创建了一个新列表。因此它们有不同的用途。

也是`Concat`一种扩展方法，适用于任何`IEnumerable<T>`并返回`IEnumerable<T>`您需要的`.ToList()`以生成新列表。

如果要扩展现有列表的内容，请使用`AddRange`.

如果您要从两个`IEnumerable<T>`来源创建新列表，请使用`Concat`with `.ToList`。这具有不会改变任何一个来源的质量。

如果您只需要枚举两个列表（或任何其他 IEnumerable）的内容，那么只需`Concat`每次都使用，这样做的好处是不会实际分配新内存来保存统一列表。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-03-05T09:55:42.260

我发现这篇有趣的文章讨论了这两种结构之间的区别并比较了它们的性能......

主要思想是 AddRange 在处理大尺寸集合时要快得多。

这是[链接](https://www.tabsoverspaces.com/232514-collection-type-result-whats-faster-ilist-add-or-ienumerable-concat)

希望这可以帮助，

# semantic-web - 如何使用 Pellet 进行离线推理？

> ID：100209
> 
> 赞同：2
> 
> 时间：2008-09-19T07:19:22.343
> 
> 标签：semantic-web, owl, rdfs, pellet, semweb

我有一个 OWL 本体，我正在使用 Pellet 对其进行推理。像大多数本体一样，它首先包含各种标准本体：

```
<rdf:RDF
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
    xmlns:owl="http://www.w3.org/2002/07/owl#"> 
```

我知道一些推理器“内置”了这些标准本体，但 Pellet 没有。当我离线且无法访问它们时，有什么方法可以继续使用 Pellet？（或者如果他们的 URL 离线，就像 dublincore.org 上周进行的例行维护）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T17:55:33.850

Pellet 在加载时会识别所有这些命名空间，并且不应尝试取消引用 URI。如果是这样，则表明使用 Pellet 的应用程序做错了什么。

[您可以在颗粒用户邮件列表中](http://lists.owldl.com/mailman/listinfo/pellet-users/)找到更多帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T13:58:33.153

[使用 Pellet 的 Local Ontology Repositories](http://clarkparsia.com/weblog/2009/03/16/local-ontology-repositories-with-pellet/)中描述了此问题的通用解决方案 - 无需公共 Web 访问即可访问本体。享受。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T17:04:35.670

制作四个文件的本地副本并将远程 URL 替换为本地 URI（即 file://... 或从您自己的框中提供它们： [http://localhost...](http://localhost..)）。

# python - 在 Python 中将 N 秒添加到 datetime.time 的标准方法是什么？

> ID：100210
> 
> 赞同：470
> 
> 时间：2008-09-19T07:19:36.320
> 
> 标签：python, datetime, time, math

给定 Python 中的一个`datetime.time`值，是否有一种标准方法可以向其添加整数秒数，例如`11:34:59`+ 3 = ？`11:35:02`

这些明显的想法不起作用：

```
>>> datetime.time(11, 34, 59) + 3
TypeError: unsupported operand type(s) for +: 'datetime.time' and 'int'
>>> datetime.time(11, 34, 59) + datetime.timedelta(0, 3)
TypeError: unsupported operand type(s) for +: 'datetime.time' and 'datetime.timedelta'
>>> datetime.time(11, 34, 59) + datetime.time(0, 0, 3)
TypeError: unsupported operand type(s) for +: 'datetime.time' and 'datetime.time' 
```

最后我写了这样的函数：

```
def add_secs_to_time(timeval, secs_to_add):
    secs = timeval.hour * 3600 + timeval.minute * 60 + timeval.second
    secs += secs_to_add
    return datetime.time(secs // 3600, (secs % 3600) // 60, secs % 60) 
```

我不禁想到我错过了一种更简单的方法来做到这一点。

### 有关的

*   [python时间+ timedelta等效](https://stackoverflow.com/questions/656297/python-time-timedelta-equivalent)

* * *

## 回答 #1

> 赞同：630
> 
> 时间：2008-09-19T07:54:39.683

您可以使用完整的`datetime`变量`timedelta`，并通过提供一个虚拟日期然后使用`time`来获取时间值。

例如：

```
import datetime
a = datetime.datetime(100,1,1,11,34,59)
b = a + datetime.timedelta(0,3) # days, seconds, then other fields.
print(a.time())
print(b.time()) 
```

产生两个值，相隔三秒：

```
11:34:59
11:35:02 
```

您也可以选择更具可读性的

```
b = a + datetime.timedelta(seconds=3) 
```

如果你这么倾向。

* * *

如果您正在使用可以执行此操作的功能，则可以考虑使用`addSecs`以下方法：

```
import datetime

def addSecs(tm, secs):
    fulldate = datetime.datetime(100, 1, 1, tm.hour, tm.minute, tm.second)
    fulldate = fulldate + datetime.timedelta(seconds=secs)
    return fulldate.time()

a = datetime.datetime.now().time()
b = addSecs(a, 300)
print(a)
print(b) 
```

这输出：

```
 09:11:55.775695
 09:16:55 
```

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2008-09-19T13:47:29.530

正如其他人在这里所说，您可以在整个过程中使用完整的日期时间对象：

```
from datetime import datetime, date, time, timedelta
sometime = time(8,00) # 8am
later = (datetime.combine(date.today(), sometime) + timedelta(seconds=3)).time() 
```

但是，我认为值得解释为什么需要完整的日期时间对象。考虑一下如果我在晚上 11 点增加 2 小时会发生什么。什么是正确的行为？一个例外，因为您的时间不能超过晚上 11:59？它应该绕回来吗？

不同的程序员会有不同的期望，所以无论他们选择哪个结果都会让很多人感到惊讶。更糟糕的是，程序员会编写在最初测试时运行良好的代码，然后通过做一些意想不到的事情让它中断。这非常糟糕，这就是为什么不允许将 timedelta 对象添加到时间对象的原因。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-09-19T08:08:10.587

一件小事，可能会增加清晰度以覆盖几秒钟的默认值

```
>>> b = a + datetime.timedelta(seconds=3000)
>>> b
datetime.datetime(1, 1, 1, 12, 24, 59) 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-19T09:40:06.373

感谢@Pax Diablo、@bvmou 和@Arachnid 提出的在整个过程中使用完整日期时间的建议。如果我必须接受来自外部源的 datetime.time 对象，那么这似乎是一个替代`add_secs_to_time()`功能：

```
def add_secs_to_time(timeval, secs_to_add):
    dummy_date = datetime.date(1, 1, 1)
    full_datetime = datetime.datetime.combine(dummy_date, timeval)
    added_datetime = full_datetime + datetime.timedelta(seconds=secs_to_add)
    return added_datetime.time() 
```

这个冗长的代码可以压缩成这样一行：

```
(datetime.datetime.combine(datetime.date(1, 1, 1), timeval) + datetime.timedelta(seconds=secs_to_add)).time() 
```

但我想我还是想把它包装在一个函数中以使代码清晰。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-01-18T07:30:26.623

您不能简单地添加数字，`datetime`因为不清楚使用什么单位：秒、小时、周......

有`timedelta`日期和时间的操作类。`datetime`减号，加号，两个对象不能相加，虽然两个`datetime`可以相加。`timedelta``datetime``timedelta``datetime``datetime``timedelta`

`timedelta`使用要添加的秒数创建对象并将其添加到`datetime`对象：

```
>>> from datetime import datetime, timedelta
>>> t = datetime.now() + timedelta(seconds=3000)
>>> print(t)
datetime.datetime(2018, 1, 17, 21, 47, 13, 90244) 
```

C++ 中也有同样的概念：`std::chrono::duration`.

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-07-27T03:49:05.383

如果值得在您的项目中添加另一个文件/依赖项，我刚刚编写了一个很小的类，它扩展`datetime.time`了进行算术的能力。当你过了午夜时，它会绕零。现在，“What time will it be, 24 hours from now”有很多极端情况，包括夏令时、闰秒、历史时区变化等等。但有时你确实需要简单的案例，这就是它的作用。

你的例子会写成：

```
>>> import datetime
>>> import nptime
>>> nptime.nptime(11, 34, 59) + datetime.timedelta(0, 3)
nptime(11, 35, 2) 
```

`nptime`继承自`datetime.time`，因此这些方法中的任何一个也应该可用。

它可以从 PyPi 作为`nptime`（“非迂腐时间”）或在 GitHub 上获得：[https ://github.com/tgs/nptime](https://github.com/tgs/nptime)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-10-09T19:41:17.423

为了完整起见，这是使用的方法[`arrow`](http://arrow.readthedocs.io/en/latest/)（Python 的更好的日期和时间）：

```
sometime = arrow.now()
abitlater = sometime.shift(seconds=3) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-01-27T13:44:32.197

在现实世界的环境中，单独使用`time`、始终使用`datetime`，甚至更好`utc`地避免冲突，如隔夜、夏令时、用户和服务器之间的不同时区等，从来都不是一个好主意。

所以我推荐这种方法：

```
import datetime as dt

_now = dt.datetime.now()  # or dt.datetime.now(dt.timezone.utc)
_in_5_sec = _now + dt.timedelta(seconds=5)

# get '14:39:57':
_in_5_sec.strftime('%H:%M:%S') 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T07:29:25.143

尝试将 a 添加`datetime.datetime`到`datetime.timedelta`. 如果您只想要时间部分，您可以调用`time()`结果`datetime.datetime`对象上的方法来获取它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-08-14T15:58:48.657

老问题，但我想我会抛出一个处理时区的函数。关键部分是将`datetime.time`对象的`tzinfo`属性传递给组合，然后在生成的虚拟日期时间上使用`timetz()`而不是。`time()`该答案部分受到此处其他答案的启发。

```
def add_timedelta_to_time(t, td):
    """Add a timedelta object to a time object using a dummy datetime.

    :param t: datetime.time object.
    :param td: datetime.timedelta object.

    :returns: datetime.time object, representing the result of t + td.

    NOTE: Using a gigantic td may result in an overflow. You've been
    warned.
    """
    # Create a dummy date object.
    dummy_date = date(year=100, month=1, day=1)

    # Combine the dummy date with the given time.
    dummy_datetime = datetime.combine(date=dummy_date, time=t, tzinfo=t.tzinfo)

    # Add the timedelta to the dummy datetime.
    new_datetime = dummy_datetime + td

    # Return the resulting time, including timezone information.
    return new_datetime.timetz() 
```

这是一个非常简单的测试用例类（使用 built-in `unittest`）：

```
import unittest
from datetime import datetime, timezone, timedelta, time

class AddTimedeltaToTimeTestCase(unittest.TestCase):
    """Test add_timedelta_to_time."""

    def test_wraps(self):
        t = time(hour=23, minute=59)
        td = timedelta(minutes=2)
        t_expected = time(hour=0, minute=1)
        t_actual = add_timedelta_to_time(t=t, td=td)
        self.assertEqual(t_expected, t_actual)

    def test_tz(self):
        t = time(hour=4, minute=16, tzinfo=timezone.utc)
        td = timedelta(hours=10, minutes=4)
        t_expected = time(hour=14, minute=20, tzinfo=timezone.utc)
        t_actual = add_timedelta_to_time(t=t, td=td)
        self.assertEqual(t_expected, t_actual)

if __name__ == '__main__':
    unittest.main() 
```

# java - 如何使用 javax.ws.rs.* 和 Glassfish 从 GET HTTP 方法中检索参数？

> ID：100211
> 
> 赞同：1
> 
> 时间：2008-09-19T07:19:38.677
> 
> 标签：java, jakarta-ee, glassfish

我刚刚在我的本地机器上安装了 Glassfish V2 只是为了玩弄它。

我想知道是否有办法检索 GET HTTP 方法传入的参数。

例如，

```
http://localhost:8080/HelloWorld/resources/helloWorld?name=ABC 
```

如何在我的 Java 代码中检索“名称”参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T08:06:30.920

像这样：

```
@Path("/helloWorld")
@Consumes({"application/xml", "application/json"})
@Produces({"application/xml", "application/json"})
@Singleton
public class MyService {
    @GET
    public String getRequest(@QueryParam("name") String name) {
            return "Name was " + name;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T08:11:59.877

通过放置：

```
@Context
private UriInfo context; 
```

在您的 HelloWorld 类中，您可以访问

```
context.getQueryParameters() ; 
```

获取参数映射的方法？

[http://docs.sun.com/app/docs/doc/820-4867/ggrby?a=view](http://docs.sun.com/app/docs/doc/820-4867/ggrby?a=view)

似乎建议你可以:)

# selenium - 从 Fitnesse 启动 seleniumRC

> ID：100216
> 
> 赞同：1
> 
> 时间：2008-09-19T07:20:08.457
> 
> 标签：selenium, tfs, selenium-rc, fitnesse, fit-framework

我正在尝试将 MSBuild 中运行的 Fitnesse 测试集成到我在 TFS 上的夜间构建中。

为了使其自包含，我想仅在健身需要时启动 seleniumRC 服务器。

我已经看到有一个“命令行夹具”，但它是用 java 编写的，我可以使用它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T09:09:11.237

我想你也许可以。您可以使用 MSBuild 轻松调用任何进程任务。但是，这样做的问题是 exec 任务将等待 Selinium 进程完成后再继续，这不是您想要的行为。您想运行该过程，在构建期间保持其运行，然后在构建完成时将其拆除。

因此，我认为您可能需要创建一个自定义 MSBuild 任务来执行此操作。有关某人创建的任务的示例，请参阅以下帖子，该任务将异步运行，将控制权返回给构建脚本：

[http://blog.eleutian.com/2007/03/01/AsyncExecMsBuildTask.aspx](http://blog.eleutian.com/2007/03/01/AsyncExecMsBuildTask.aspx)

对于从 MSBuild 调用 Java 程序的示例（但在这种情况下是同步的），请查看我在此处[从 MSBuild 调用 Ant 的任务](http://teamprise.com/products/build/)

[http://team.com/products/build/](http://teamprise.com/products/build/)

作为 MSBuild 任务的一部分，您需要将创建的进程 ID 输出到输出属性，以便在构建脚本结束时调用另一个自定义 MSBuild 任务来终止该进程。它可以通过在 MSBuild 中查找作为变量传入的进程 ID，然后调用[Process.Kill](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.kill.aspx)方法来做到这一点，即

```
Process process = Process.GetProcessById(ProcessId);
process.Kill(); 
```

也就是说，您需要小心确保您的 kill 任务始终在 MSBuild 中执行，方法是确保它包含在构建中的错误路径等期间。您可以通过让 selenium RC 启动任务查找其他 seleniumRC 进程并在启动新进程之前杀死它们来使事情更具弹性 - 这样，如果一个进程由于某种原因没有正确关闭，它只会运行到下一个构建。

无论如何-我的回答听起来像是很多工作，所以希望其他人会想出一个更简单的方法。您可能可以在测试套件中创建 seleniumRC 进程，启动 FitNesse 测试并在套件拆解中将其杀死，或者您可以编写自定义任务来扩展您的 FitNesse 运行器任务并在之前异步启动 seleniumRC运行测试过程，然后将其杀死。

祝你好运，

马丁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T08:51:29.847

感谢您的回复！

这就是我到目前为止所做的。

我制作了一个合适的夹具（非常简单），它使用提供的命令行启动一个进程，在我的例子中是 startSelenium.bat。夹具返回 ProcessID，因此我可以将其存储在我的健身上下文中并稍后关闭该会话。

我现在可以在我的健身测试中创建一个 SuiteSetUp 页面，如下所示。

|运行命令夹具|

|命令行|运行命令？|

|C:\Projects...\startSeleniumRC.bat|>>seleniumprocess|

和这样的 SuiteTearDown

|运行命令夹具|

|进程ID|停止命令？| |<

这对我行得通。我的健身测试要求没有硒 RC 启动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T09:06:53.333

编写一个简单的 .NET 应用程序来执行由您的构建脚本运行的 Process.Start("selenumRC commandline") 怎么样？

如果您离 Selenium 路线不太远；我可以建议您查看类似的 .NET 浏览器自动化工具吗？特别是 WatiN 或 ArtOfTest。这些中的“堆栈”完全是 .NET，因此让它们在不同的机器上运行要容易得多。

# c++ - 查找未使用的函数声明的工具？

> ID：100221
> 
> 赞同：3
> 
> 时间：2008-09-19T07:22:06.580
> 
> 标签：c++, function, header

在重构一些旧代码时，我意识到一个特定的头文件充满了函数的函数声明，这些函数早已从 .cpp 文件中删除。有谁知道可以自动找到（并剥离）这些的工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T08:40:01.633

如果可能的话，你可以创建一个 test.cpp 文件来调用它们，链接器会将没有代码的那些标记为未解析，这样你的测试代码只需要编译而不用担心实际运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T09:28:59.793

PC-lint 可以针对专用目的进行调整：

我针对您的问题测试了以下代码：

```
void foo(int );

int main()
{
    return 0;
} 
```

```
lint.bat test_unused.cpp

```

并得到以下结果：

```
==================================================== ==========

--- 模块：test_unused.cpp (C++)

    --- 模块总结：test_unused.cpp

信息 752：未引用本地声明符 'foo(int)'（第 2 行，文件 test_unused.cpp）
test_unused.cpp(2) ：信息 830：先前消息中引用的位置

==================================================== ==========

```

因此，您可以为您的目的传递警告编号 752：

```
lint.bat -"e*" +e752 test_unused.cpp

```

-e"*" 将删除所有警告，+e752 将打开此特定警告

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T07:29:53.237

如果您使用 Doxygen 对代码进行索引，您可以看到每个函数引用的位置。但是，您必须浏览每个类（每个类 1 个 HTML 页面）并扫描那些没有任何指向它们的内容。

或者，您可以使用 ctags 生成代码中所有函数的列表，然后使用 objdump 或其他类似工具获取 .o 文件中所有函数的列表 - 然后比较这些列表。但是，由于名称修改，这可能会出现问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T07:31:00.037

我不认为有这样的事情，因为某些在实际源代码树中没有主体的函数可能是在某个外部库中定义的。这只能通过创建一个脚本来完成，该脚本在标题中列出声明的函数并验证它们是否有时被调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T09:26:25.703

我有一个[用于 vim 的 C++ ftplugin](http://code.google.com/p/lh-vim/wiki/lhCpp)，它能够检查和报告不匹配的功能—— vimers，ftplugin 套件还不是很容易安装。ftplugin 基于 ctags 结果（因此它的[启发式](http://code.google.com/p/lh-vim/source/browse/cpp/trunk/autoload/lh/cpp/AnalysisLib_Function.vim)可以很容易地适应其他环境），有时在内联函数的情况下会出现误报。

高温下，

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T12:15:43.620

除了 Doxygen (@Milan Babuskov)，您可以查看编译器中是否有警告。例如 gcc 有 -Wunused-function 用于静态函数；-fdump-ipa-cgraph。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T15:22:38.257

我听说过有关[PC-Lint 的](http://www.gimpel.com/)好消息，但我想这可能对您的需求来说有点过头了。

# xml - “这些元素中的任何一个或多个，但必须至少是一个”的 XML 模式构造

> ID：100228
> 
> 赞同：25
> 
> 时间：2008-09-19T07:24:10.223
> 
> 标签：xml, xsd, schema

我正在尝试设置类似于“序列”的模式的一部分，其中所有子元素都是可选的，但至少有一个元素**必须**存在，并且可能不止一个。

我尝试执行以下操作，但 XMLSpy 抱怨“内容模型包含无法唯一确定的元素 <element name="DateConstant"> 和 <element name="DateConstant">。”：

```
 <xs:choice>
        <xs:sequence>
            <xs:element name="DateConstant"/>
            <xs:element name="TimeConstant"/>
        </xs:sequence>
        <xs:element name="DateConstant"/>
        <xs:element name="TimeConstant"/>
    </xs:choice> 
```

可以做到这一点（如果可以，如何做到）？

一些澄清：我只想允许同名的每个元素之一。可以有一个“DateConstant”和/或一个“TimeConstant”，但不能有两个。Gizmo 的答案符合我的要求，但对于大量元素来说是不切实际的。赫斯特的回答允许两个或多个同名元素，这是我不想要的。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-19T07:45:28.410

试试这个：

```
<xs:choice>
  <xs:sequence>
    <xs:element name="Elem1" />
    <xs:element name="Elem2" minOccurs="0" />
    <xs:element name="Elem3" minOccurs="0" />
  </xs:sequence>
  <xs:sequence>
    <xs:element name="Elem2" />
    <xs:element name="Elem3" minOccurs="0" />
  </xs:sequence>
  <xs:element name="Elem3" />
</xs:choice> 
```

这样做，你强制要么选择第一个元素，然后其余的是可选的，要么是第二个元素，其余的是可选的，要么是第三个元素。

我希望这应该做你想做的事。

当然，您可以将子序列分组，以避免在您意识到错过一个元素时在每个序列中重复一个元素。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-19T08:56:33.840

根据[http://msdn.microsoft.com/en-us/library/aa468557.aspx#understandxsd_topic5上的 MSDN 上标题为“](http://msdn.microsoft.com/en-us/library/aa468557.aspx#understandxsd_topic5 "定义复杂类型")**理解 XML 架构**”的技术文章 ， 您可以利用诸如*minOccurs*之类的选项定义（合成器）本身的约束：

 **“在合成器上使用出现约束适用于整个组”*

（请参阅使用嵌套复杂类型的更复杂的示例和 AuthorType 示例）

您将您的要求声明为“必须存在至少一个元素，并且可能有多个元素”。因此，我建议您尝试以下方法：

```
<xs:choice minOccurs="1" maxOccurs="unbounded">
    <xs:element name="DateConstant" type="..."/>
    <xs:element name="TimeConstant" type="..."/>
</xs:choice> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-14T03:47:39.517

@赫斯特，

不幸的是，您未能理解最初的问题。当所有具有 minOccurs="0" 的元素作为选项包含时，将自动满足将 minOccurs="1" 放置在选项上。

因此，您未能考虑原始海报要求的“至少一个”，因为没有元素正确满足两个完全可选元素的 1 次出现。

到目前为止，我无法找到解决方案，因为 minOccur/maxOccur 都与定义它们的组有关，并且与节点的总数无关。您也不能多次使用选择元素来定义相同的命名元素，否则它会变得“模棱两可”。我已经看到一些示例使用引用而不是特定类型的元素，但我相信这会使 microsoft XSD 解析器失败。

```
<xs:choice minOccurs="1" maxOccurs="1">
  <xs:sequence minOccurs="1" maxOccurs="1">
    <xs:element name="Elem1" minOccurs="1" maxOccurs="1" />
    <xs:element name="Elem2" minOccurs="0" maxOccurs="1" />
  </xs:sequence>
  <xs:sequence >
    <xs:element name="Elem2" minOccurs="1" maxOccurs="1" />
  </xs:sequence>
</xs:choice> 
```

在这里你可以看到要么你有第一个序列（它必须有 Elem1，但可能有 Elem2 可选），或者你有第二个序列（它必须有 Elem2）。

因此，您现在拥有这两个元素中的“任何一个或多个”。当然，随着您需要为所有可能的组合提供额外的选择，您拥有的选项越多，这就会变得越复杂。*

# c# - 在 C# 中寻找一个简单的独立持久字典实现

> ID：100235
> 
> 赞同：25
> 
> 时间：2008-09-19T07:25:32.250
> 
> 标签：c#, .net

对于一个开源项目，我正在寻找一个好的、简单的由文件支持的 Dictionary 实现。这意味着，如果应用程序崩溃或重新启动，字典将保持其状态。我希望它在每次触摸字典时更新基础文件。（添加一个值或删除一个值）。FileWatcher 不是必需的，但它可能很有用。

```
class PersistentDictionary<T,V> : IDictionary<T,V>
{
    public PersistentDictionary(string filename)
    {

    } 
} 
```

要求：

*   开源，不依赖本机代码（无 sqlite）
*   理想情况下是一个非常简短的实现
*   当设置或清除一个值时，它不应该重写整个底层文件，而是应该寻找文件中的位置并更新值。

**类似问题**

*   [.Net 中的持久二叉树/哈希表](https://stackoverflow.com/questions/108435/persistent-binary-tree-hash-table-in-net)
*   [c# 的磁盘支持字典/缓存](https://stackoverflow.com/questions/408401/disk-backed-dictionary-cache-for-c)
*   [`PersistentDictionary<Key,Value>`](http://izlooite.blogspot.com/2011/04/persistent-dictionary.html)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-27T11:00:10.460

*   [**bplustreedotnet**](http://bplusdotnet.sourceforge.net/)

    bplusdotnet 包是 C#、java 和 Python 中交叉兼容的数据结构实现的库，对于需要存储和检索持久信息的应用程序很有用。bplusdotnet 数据结构可以轻松地**永久存储与值关联的字符串键**。

*   [**ESENT 托管接口**](http://www.codeplex.com/ManagedEsent)

    *不是 100% 托管代码，但值得一提的是，非托管库本身已经是每个 Windows XP/2003/Vista/7 盒子的一部分*

    ESENT 是一个嵌入式数据库存储引擎 (ISAM)，它是 Windows 的一部分。它通过行级锁定、预写日志记录和快照隔离提供可靠、事务处理、并发、高性能的数据存储。这是 ESENT Win32 API 的托管包装器。

*   [**阿卡瓦切**](https://github.com/github/Akavache)

    *Akavache 是一个异步、持久的键值缓存，用于在 C# 中编写本机桌面和移动应用程序。把它想象成桌面应用程序的 memcached。

~~- [**C5 通用集合库**](http://www.itu.dk/research/c5/)~~

~~C5 提供标准 .Net 命名空间未提供的功能和数据结构`System.Collections.Generic`，例如**持久树数据结构**、基于堆的优先级队列、哈希索引数组列表和链表，以及集合更改事件。~~

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-27T13:02:53.987

让我分析一下：

1.  按键检索信息
2.  永久存储
3.  当 1 个值更改时，不想写回整个文件
4.  应该在崩溃中幸存下来

我想你想要一个数据库。

编辑：我认为您正在寻找错误的东西。搜索符合您要求的数据库。并改变你的一些要求，因为我认为很难全部满足。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-27T11:03:52.293

一种方法是使用内置于 windows 中的[可扩展存储引擎来存储你的东西。](http://msdn.microsoft.com/en-us/library/ms684493(VS.85).aspx)它是一个原生的win数据库，支持索引、事务等...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-31T08:03:17.110

我正在将 EHCache 移植到 .NET。看看项目

[http://sourceforge.net/projects/thecache/](http://sourceforge.net/projects/thecache/)

持久缓存是已经实现的核心功能。所有主要的单元测试都通过了。我有点卡在分布式缓存上，但你不需要那部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T09:15:58.850

听起来很酷，但是您将如何绕过对存储值（如果它是引用类型）本身的更改？如果它是不可变的，那么一切都很好，但如果不是，你有点吃饱了:-)

如果您不处理不可变的值，我怀疑更好的方法是在值级别处理持久性并在必要时重建字典。

（已编辑以添加说明）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T13:15:11.193

我认为您的问题很可能是最后一点：

> 当设置或清除一个值时，它不应该重写整个底层文件，而是应该寻找文件中的位置并更新值。

这正是数据库所做的——您基本上是在描述一个简单的基于文件的表结构。

我们可以通过查看字符串来说明问题。

内存中的字符串是灵活的东西——当你声明它的类型时，你不需要知道 C# 中字符串的长度。

在数据存储中，字符串和其他所有内容都是固定大小的。您在磁盘上保存的字典只是按顺序排列的字节集合。

如果在中间替换一个值，它要么必须是完全相同的大小，要么必须*重写它之后的每个字节*。

这就是大多数数据库将文本和 blob 字段限制为固定大小的原因。`varchar(max)`Sql 2005+ 中的/等新功能`varbinary(max)`实际上是对行的巧妙简化，仅实际存储了指向真实数据的指针。

您不能在示例中使用固定大小，因为它是通用的 - 您不知道要存储的类型，因此您无法将值填充到最大大小。

你可以这样做：

```
class PersistantDictionary<T,V> : Dictionary<T,V>
    where V:struct 
```

...因为值类型的存储大小没有变化，尽管您必须小心实现以为每种类型保存正确的存储量。

但是，您的模型不会非常高效 - 如果您查看 SQL Server 和 Oracle 如何处理表更改，它们不会像这样更改值。相反，他们将旧记录标记为幽灵，并添加具有新值的新记录。当数据库不太忙时，旧的幻影记录会在以后清理。

我认为您正在尝试重新发明轮子：

*   如果您正在处理大量数据，那么您确实需要使用成熟的数据库进行检查。MySql 或 SqlLite 都很好，但你不会找到一个好的、简单的、开源的和精简的实现。

*   如果您不处理大量数据，那么我会进行整个文件序列化，并且这里已经有很多关于如何做到这一点的好建议。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-30T13:41:34.387

我根据不久前在另一个项目中的一个非常相似（我认为相同）的要求自己编写了一个实现。当我这样做时，我意识到的一件事是，大多数时候您将进行写入，而您很少在程序崩溃或关闭时进行读取。所以我们的想法是尽可能快地进行写入。我所做的是创建一个非常简单的类，它只会在事情发生时将所有操作（添加和删除）的日志写入字典。因此，一段时间后，您会在键之间进行大量重复。正因为如此，一旦对象检测到一定数量的重复，它就会清除日志并重写它，这样每个键和它的值只出现一次。

不幸的是，您不能继承 Dictionary，因为您不能覆盖其中的任何内容。这是我的简单实现，虽然很抱歉，但我还没有测试过，我想你可能想要这个想法。随意使用它并随心所欲地改变它。

```
class PersistentDictManager {
    const int SaveAllThreshold = 1000;

    PersistentDictManager(string logpath) {
        this.LogPath = logpath;
        this.mydictionary = new Dictionary<string, string>();
        this.LoadData();
    }

    public string LogPath { get; private set; }

    public string this[string key] {
        get{ return this.mydictionary[key]; }
        set{
            string existingvalue;
            if(!this.mydictionary.TryGetValue(key, out existingvalue)) { existingvalue = null; }
            if(string.Equals(value, existingvalue)) { return; }
            this[key] = value;

            // store in log
            if(existingvalue != null) { // was an update (not a create)
                if(this.IncrementSaveAll()) { return; } // because we're going to repeat a key the log
            }
            this.LogStore(key, value);
        }
    }

    public void Remove(string key) {
        if(!this.mydictionary.Remove(key)) { return; }
        if(this.IncrementSaveAll()) { return; } // because we're going to repeat a key in the log
        this.LogDelete(key);
    }

    private void CreateWriter() {
        if(this.writer == null) {
            this.writer = new BinaryWriter(File.Open(this.LogPath, FileMode.Open)); 
        }
    }

    private bool IncrementSaveAll() {
        ++this.saveallcount;
        if(this.saveallcount >= PersistentDictManager.SaveAllThreshold) {
            this.SaveAllData();
            return true;
        }
        else { return false; }
    }

    private void LoadData() {
        try{
            using(BinaryReader reader = new BinaryReader(File.Open(LogPath, FileMode.Open))) {
                while(reader.PeekChar() != -1) {
                    string key = reader.ReadString();
                    bool isdeleted = reader.ReadBoolean();
                    if(isdeleted) { this.mydictionary.Remove(key); }
                    else {
                        string value = reader.ReadString();
                        this.mydictionary[key] = value;
                    }
                }
            }
        }
        catch(FileNotFoundException) { }
    }

    private void LogDelete(string key) {
        this.CreateWriter();
        this.writer.Write(key);
        this.writer.Write(true); // yes, key was deleted
    }

    private void LogStore(string key, string value) {
        this.CreateWriter();
        this.writer.Write(key);
        this.writer.Write(false); // no, key was not deleted
        this.writer.Write(value);
    }

    private void SaveAllData() {
        if(this.writer != null) {
            this.writer.Close();
            this.writer = null;
        }
        using(BinaryWriter writer = new BinaryWriter(File.Open(this.LogPath, FileMode.Create))) {
            foreach(KeyValuePair<string, string> kv in this.mydictionary) {
                writer.Write(kv.Key);
                writer.Write(false); // is not deleted flag
                writer.Write(kv.Value);
            }
        }
    }

    private readonly Dictionary<string, string> mydictionary;
    private int saveallcount = 0;
    private BinaryWriter writer = null;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-31T15:38:01.687

看看这个博客：

[http://ayende.com/Blog/archive/2009/01/17/rhino.dht-ndash-persistent-amp-distributed-storage.aspx](http://ayende.com/Blog/archive/2009/01/17/rhino.dht-ndash-persistent-amp-distributed-storage.aspx)

看起来正是您正在寻找的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T09:18:43.023

只需使用序列化。查看 BinaryFormatter 类。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-03T19:01:45.217

我不知道有什么可以解决你的问题。它需要是一个固定大小的结构，这样您就可以满足在不重写整个文件的情况下能够重写记录的要求。

这意味着正常的字符串已出。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-06T23:01:11.673

就像道格拉斯说的，你需要知道你的类型（T 和 V）的固定大小。此外，任何这些实例引用的对象网格中的可变长度实例都已失效。

尽管如此，实现由文件支持的字典非常简单，您可以`BinaryWriter`在继承或封装类之后使用该类将类型写入磁盘`Dictionary<TKey, TValue>`。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-27T11:04:41.463

考虑一个内存映射文件。我不确定 .NET 中是否有直接支持，但您可以调用 Win32 调用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-27T11:33:35.243

我实际上并没有使用它，但是这个项目显然在 C# 中提供了一个类似 mmap() 的实现

[地图](http://netdev.usr.dico.unimi.it/software/csharp/mmap/index.html)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-29T16:28:53.363

我推荐[SQL Server Express](http://www.microsoft.com/express/sql/)或其他数据库。

*   免费。
*   它与 C# 很好地集成，包括 LINQ。
*   它比自制解决方案更快。
*   它比自制解决方案更可靠。
*   它比简单的基于磁盘的数据结构更强大，所以将来做更多事情会很容易。
*   SQL 是一种行业标准，因此其他开发人员将更容易理解您的程序，并且您将拥有对未来有用的技能。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2009-01-27T12:55:28.713

我不是一个程序员，但是创建一个非常简单的 XML 格式来存储您的数据不会起到作用吗？

```
<dico> 
   <dicEntry index="x">
     <key>MyKey</key>
     <val type="string">My val</val>
   </dicEntry>
   ...
</dico> 
```

从那里，您加载 XML 文件 DOM 并根据需要填写您的字典，

```
XmlDocument xdocDico = new XmlDocument();
string sXMLfile;
public loadDico(string sXMLfile, [other args...])
{
   xdocDico.load(sXMLfile);
   // Gather whatever you need and load it into your dico
}
public flushDicInXML(string sXMLfile, dictionary dicWhatever)
{
   // Dump the dic in the XML doc & save
}
public updateXMLDOM(index, key, value)
{
   // Update a specific value of the XML DOM based on index or key
} 
```

然后，您可以随时更新 DOM 并将其保存在磁盘上。

`xdocDico.save(sXMLfile);`

如果你能负担得起将 DOM 保存在内存中的性能，那么处理起来就很容易了。根据您的要求，您甚至可能根本不需要字典。

# c# - C# 字符串 ASCII 表示

> ID：100236
> 
> 赞同：2
> 
> 时间：2008-09-19T07:25:46.320
> 
> 标签：c#, regex, string, ascii

如何将 ASCII 特殊字符（例如 ASCII 值 0x01）插入字符串？

我问是因为我正在使用以下内容：

```
str.Replace( "<TAG1>", Convert.ToChar(0x01).ToString() ); 
```

而且我觉得一定有比这更好的方法。有任何想法吗？

更新：

另外，如果我使用这种方法，我是否需要担心 unicode 和 ASCII 冲突？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-19T07:27:33.150

我相信您可以使用`\uXXXX`将指定的代码插入到您的字符串中。

ETA：我刚刚测试过它并且它有效。:-)

```
using System;
class Uxxxx {
    public static void Main() {
        Console.WriteLine("\u20AC");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T07:42:52.503

> 另外，如果我使用这种方法，我是否需要担心 unicode 和 ASCII 冲突？

您的第一个问题将是您的标签与 ASCII 冲突。到达 TAG10 后，您将与 0x0A 发生冲突：换行。如果您确保您永远不会获得超过九个标签，那么您应该是安全的。当字节值介于 0 和 127 之间时，Unicode 编码（或者更确切地说：UTF8）与 ASCII 编码相同。它们仅在设置最高位时有所不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-24T08:20:47.497

> 而且我觉得一定有比这更好的方法。有任何想法吗？

看起来好像您正在尝试**使用文本工具来操作二进制块**。例如，如果您想插入 byte `0x01`，则不再处理文本，因为您不关心该 byte*可能*代表什么，而且看起来您甚至不关心您将输出哪种编码。

更好的方法是将您正在操作的东西视为二进制数据块，这样您就可以轻松插入位和字节，而无需使用脆弱的解决方法并担心副作用。

# realbasic - 如何在 REALbasic 中创建“选择文件夹或文件对话窗口”？

> ID：100242
> 
> 赞同：3
> 
> 时间：2008-09-19T07:27:12.480
> 
> 标签：realbasic

您可以使用

SelectFolder() 获取文件夹

或者

GetOpenFolderitem(filter as string) 获取文件

但是您可以选择文件夹或文件吗？（或为此选择多个文件）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-04T10:38:36.947

MonkeyBread 插件在 OpenDialogMBS 类中允许这样做。

[http://www.monkeybreadsoftware.net/pluginhelp/navigation-opendialogmbs.shtml](http://www.monkeybreadsoftware.net/pluginhelp/navigation-opendialogmbs.shtml)

```
OpenDialogMBS.AllowFolderSelection as Boolean
property, Navigation, MBS Util Plugin (OpenDialog), class OpenDialogMBS, Plugin version: 7.5, Mac OS X: Works, Windows: Does nothing, Linux x86: Does nothing, Feedback.

Function: Whether folders can be selected.
Example: 
dim o as OpenDialogMBS
dim i,c as integer
dim f as FolderItem

o=new OpenDialogMBS
o.ShowHiddenFiles=true
o.PromptText="Select one or more files/folders:"
o.MultipleSelection=false
o.ActionButtonLabel="Open files/folders"
o.CancelButtonLabel="no, thanks."
o.WindowTitle="This is a window title."
o.ClientName="Client Name?"
o.AllowFolderSelection=true
o.ShowDialog

c=o.FileCount
if c>0 then
  for i=0 to c-1
    f=o.Files(i)

    FileList.List.AddRow f.AbsolutePath
  next
end if

Notes: 
Default is false.
Setting this to true on Windows or Linux has no effect there.
(Read and Write property) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T16:21:21.147

这是不可能通过任何内置 API 实现的。可能有一个插件可以做到这一点，但我认为没有操作系统支持它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-09T19:42:38.493

有点晚了，但它已包含在最近的版本中。我会把它放在这里，以防有人在这个问题上像我一样绊倒：

[RealBasic 多选：OpenDialog.MultiSelect](http://docs.realsoftware.com/index.php/OpenDialog.MultiSelect)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-09-19T07:29:28.247

假设您使用的是.Net，我认为您需要创建自己的控件（或购买一个）。

# java - Java 框架之战：Spring 和 Hibernate

> ID：100243
> 
> 赞同：28
> 
> 时间：2008-09-19T07:27:22.293
> 
> 标签：java, hibernate, spring

我的开发人员正在发动一场内战。在一个阵营中，他们接受了 Hibernate 和 Spring。在另一个阵营，他们谴责框架——不过他们正在考虑使用 Hibernate。

问题是：新手 Hibernate-Spring 转换者可能会遇到任何令人讨厌的意外、弱点或陷阱吗？

* * *

PS：我们有一个不太复杂的 DAO 库。我怀疑它是否具有 Hibernate 的丰富性，但它正在达到某种成熟度（即它在它所包含的最后几个项目中没有改变）。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-09-19T07:36:50.647

他们谴责*框架*？

这太疯狂了。如果您不使用现成的框架，那么您将创建自己的框架。它仍然是一个框架。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-26T21:16:45.387

我过去曾多次使用过 Hibernate。每次我遇到边缘情况，确定语法会演变为通过文档、谷歌和旧版本进行的寻宝游戏。它是一个强大的工具，但文档记录很差（我最后一次查看）。

至于 Spring，过去几年我面试或看过的几乎所有工作都涉及 Spring，它确实已成为 Java/Web 的事实标准。使用它会帮助您的开发人员在未来更有市场，并且会帮助您，因为您将拥有大量了解您的应用程序的人。

编写自己的框架是诱人的、有教育意义的和有趣的。结果不是很好。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-09-19T07:59:10.220

Hibernate 肯定有一些怪癖，但那是因为它试图解决的问题很复杂。每次有人抱怨 Hibernate 时，我都会提醒他们所有无聊的 DAO 代码，如果他们不使用它就必须维护这些代码。

一些提示：

*   Hibernate 不能替代良好的数据库设计。Hibernate 模式是可以的，但你将不得不偶尔调整它们
*   最终，您将不得不了解 Hibernate 如何延迟加载类以及它如何影响事物。Hibernate 修改了 Java 字节码，如果只是为了解释为什么对象链接为空，您迟早需要深入研究。
*   如果可以，请使用注释。
*   花点时间学习 Hibernate 性能调优技术，从长远来看，它将为您节省开支。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-19T08:09:54.670

如果你有一个相当复杂的数据库，Hibernate 可能不适合你。在工作中，我们有一个相当复杂的数据库，其中包含大量数据，而 Hibernate 并不适合我们。我们已经开始使用 iBATIS。但是，我知道很多开发商店都成功地使用了 Hibernate——它确实为你做了很多繁重的工作——所以值得考虑。

如果您知道如何正确使用 Spring，那么 Spring 是一个很好的工具。

我会说框架绝对是一件好事——就像其他人指出的那样，你不想重新发明轮子。Spring 包含许多模块，这意味着您不必编写太多代码。不要屈服于“这里没有发明”综合症！

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-19T08:29:14.560

这是我在冬眠时陷入的一件事（我记得）。当您从集合（在父实体中）删除（几个）子对象，然后在一个事务中将新实体添加到同一个集合中而不在中间刷新时，Hibernate 将在“删除”之前执行“插入”。如果子表在其中一个列中具有唯一约束，并且您希望不会违反它，因为您之前已经删除了一些数据（就像我一样），那么准备好感到沮丧。Hibernate 论坛建议：

2.  这是一个数据库设计缺陷，重新设计；
3.  在删除和插入之间刷新（或提交）；

我不能两者都做，最终调整了 Hibernate 源代码并重新编译。它只有 1 行代码。但是找到一条线的努力相当于大约 27 杯咖啡和 3 个不眠之夜。

这只是您在团队中没有真正专家（专家：对 Hibernate 的理念和内部工作有足够知识的人）使用 Hibernate 时可能最终遇到的问题和怪癖的一个示例。您的问题、解决方案、咖啡升数和不眠夜数可能会有所不同。但你明白了。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-19T16:35:04.027

延迟加载是使用 Hibernate 作为其持久性框架的 MVC 应用程序中的一大难题。您在控制器中加载对象并将其传递给 JSP 视图。类的部分或全部成员被代理并且一切都爆炸了，因为当控制器完成时您的 Hibernate 会话已关闭。

您需要阅读[Open Session in View](http://www.hibernate.org/43.html)文章以了解问题并获得解决方案。如果您使用的是 Spring，这篇[博客文章](http://springtips.blogspot.com/2007/07/open-session-in-view.html)描述了 Spring 解决在视图中打开会话的问题。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-19T07:49:33.377

我在 Java 方面工作不多，但我确实在大量 Java 开发人员中工作过。我的印象是春天还可以。但是每个人都对 Hibernate 感到不安。如果被问到“如果你可以改变一件事，你会改变什么？”，则有一半的团队成员。他们会说“摆脱休眠”。当我开始学习 Hibernate 时，它​​让我惊讶地发现它的复杂性，但我学得还不够（幸好我已经学会了），无法知道这种复杂性是否合理（也许需要解决一些复杂的问题）。

团队放弃了 Spring 转而支持 Guice，但这更像是一种政治变革，至少从我和与我交谈过的其他开发人员的角度来看是这样。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-19T10:28:52.170

我一直发现 Hibernate 有点复杂且难以学习。但是随着[JPA](http://java.sun.com/developer/technicalArticles/J2EE/jpa/)（Java Persistence API）和[EJB](http://java.sun.com/products/ejb/)（Enterprise Java Beans）3.0 已经存在了一段时间，事情变得容易多了，我更喜欢注释我的类以通过 JavaDoc 或 XML 创建映射。查看[Hibernate 中的支持](http://www.hibernate.org/397.html)。额外的好处是，如果需要，以后可以（但并非毫不费力地）更改数据库框架。我使用[OpenJPA](http://openjpa.apache.org/)取得了很好的效果。

最近我越来越多地使用[JCR （Java Content Repository）。](http://en.wikipedia.org/wiki/Content_repository_API_for_Java)我喜欢我的模块可以共享单个数据存储并且我可以让结构和属性发展的方式。我发现使用节点和属性比将我的对象映射到数据库要容易得多。[Jackrabbit](http://jackrabbit.apache.org/)是一个很好的实现。

至于 Spring，它有很多我喜欢的特性，但配置所需的 XML 数量意味着我永远不会使用它。相反，我使用[Guice](http://code.google.com/p/google-guice/)并且非常喜欢它。

总结一下，我会向你怀疑的开发人员展示 Hibernate 将如何让他们的生活更轻松。至于 Spring，我会认真检查 Guice 是否是一个可行的替代方案，然后尝试展示 Spring/Guice 如何使开发变得更好、更容易。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-19T08:00:20.793

我做了很多 Spring/Hibernate 开发。随着时间的推移，人们结合使用两者的方式发生了一些变化。事实证明，原始的 HibernateTemplate 方法难以调试，因为它吞下并包装了其他有用的异常；直接与 Hiberante API 对话！

请继续查看生成的 SQL（配置您的开发日志以显示 SQL）。对数据库有一个抽象层并不意味着您不必再考虑 SQL 了。否则，您将无法获得良好的表现。

考虑项目。在我们有严格的性能要求、复杂的遗留模式或优秀的 DBa 能够编写出色的 SQL 的情况下，我曾多次选择 iBatis 而不是 Hibernate。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-19T08:29:07.103

至于 Hibernate：一个非常好的应用程序工具，它​​处理快速变化的数据库模式、大量表、执行大量简单的 CRUD 操作。涉及复杂查询的报告处理得不太好。但在这些情况下，我更喜欢混合使用 JDBC 或本机查询。所以，简短的回答：我确实认为花时间学习 Hibernate 是一项很好的投资（他们说它也符合 EJB3.0 和 JPA 标准，但是当我为我的个人评估它时，这并没有考虑在内采用）。

至于春天……见[胆汁博客](http://www.bileblog.org/2007/03/xml-wiring-is-for-girls/):)

记住：框架不是[灵丹妙药](http://en.wikipedia.org/wiki/Golden_hammer)，但你也不应该[重新发明轮子](http://en.wikipedia.org/wiki/Reinventing_the_wheel)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-19T09:39:04.130

我发现使用诸如 Hibernate 之类的知名框架确实很有帮助，因为它使您的代码适合特定的模式或思维方式。这意味着，由于您使用的是 Hibernate，因此您以某种方式编写代码，并且大多数（如果不是所有）了解 Hibernate 的开发人员都能够很容易地遵循您的思路。

当然，这有一个缺点。在成为炙手可热的 Hibernate 开发人员之前，您会发现自己正在尝试将正方形放入圆形孔中。你知道你想做什么，以及在 Hibernate 出现之前你应该怎么做，但是找到 Hibernate 的方法可能需要……相当多的时间。

尽管如此，对于那些经常聘请顾问（他们需要在短时间内理解大量源代码）或者开发人员经常登录和退出的公司，或者您只是不想打赌您的主要开发人员会永远留下来，永远不要换工作——我认为 Hibernate 和其他标准框架是一个不错的主意。

/高手

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-24T16:20:20.260

Spring 和 Hibernate 是难以掌握的框架。当您仍在尝试找出框架时，在截止日期紧迫的项目中使用它们可能不是一个好主意。

框架的好处基本上是尝试提供一个平台以允许一致的代码成为产品。根据经验，建议您让开发人员在框架设置方面有经验，并采用最佳实践。

根据您的应用程序和/或数据库的设计，您还需要规避一些怪癖，以确保框架不会影响性能。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-31T21:14:59.693

我必须同意关于这一点的许多帖子。我已经在各种环境中广泛使用了这两种方法。如果我可以撤销一个设计决定，那就是使用 Hibernate。实际上，我们在我们的一个产品中预算了一个版本，以将 Hibernate 换成 iBatis 和 Spring-JDBC 以获得世界上最好的方法。我可以让新开发人员更快地使用 Spring-JDBC、Spring-MVC、Spring-Ioc 和 iBatis，而不是让他们使用 Hibernate。

Hibernate 对这个 KISS 开发者来说太复杂了。如果您的 DBA 看到数据库看到的生成的 SQL 并将优化版本发回给您，那么天堂会帮助您休眠。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-09T17:15:20.280

在我看来，Spring 的最大优势在于它鼓励并支持更好的开发实践，尤其是松耦合、测试和更多接口。没有 Spring 的 Hibernate 可能真的很痛苦，但两者结合起来非常有用。

将现有项目改造到任何框架都会很痛苦，但重构过程通常对长期可维护性有很大好处。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-02-19T09:40:20.753

最佳答案提到 Hibernate 的文档记录很差。我同意在线参考手册可以更完整。然而，Hibernate 的作者所写的一本书，《[Java persistence with Hibernate](http://www.manning.com/bauer2/)》是每个 Hibernate 用户的必读之书，而且非常完整。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-19T07:55:37.810

框架并不邪恶。甚至 Java SDK 也是一个框架。

他们可能反对的是*框架扩散*。你不应该把一个框架带到一个项目中去，它应该在合理的时间内带来一致的价值。每个框架都需要一个学习曲线，但以后应该会以更高的生产力和功能来奖励您。

如果您遇到由于不一致的数据库使用、复杂的缓存机制或无数其他原因而难以调试的代码。Hibernate 将增加巨大的价值。除了学习曲线（我花了大约 1 个月的实际工作时间）之外，没有任何陷阱，只要你身边有人为你解释基础知识。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-19T08:01:52.147

@slim - 今天早上我又和你在一起了。

这听起来像是“**这里不发明综合症**”的经典案例。如果他们不喜欢 spring，他们应该考虑其他选择，而不是滚动他们自己的框架（无论他们是否承认这样做）。 [Guice](http://code.google.com/p/google-guice/)是一种可能性。还有微微容器。还有其他的，取决于你需要什么。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-19T12:27:43.683

Spring 和 Hibernate 绝对让生活更轻松。开始使用它们可能会在开始时有点耗时，但稍后您肯定会从中受益。现在 XML 正在被注释取代，您也不需要键入数百行 XML。

您可能需要考虑[AppFuse](http://appfuse.org/display/APF/Home)来减少您的学习曲线：生成一个应用程序，研究并调整它，然后就可以开始了。

# testing - 测试计划/文档/管理工具

> ID：100246
> 
> 赞同：14
> 
> 时间：2008-09-19T07:28:25.987
> 
> 标签：testing, test-plan

我正在寻找一个好的、最好是免费的测试计划和文档工具。理想情况下，可以跟踪针对哪个软件版本运行了哪些测试，并具有报告能力。[这里](http://www.opensourcetesting.org/testmgt.php)列出了一大堆工具，但还有其他工具吗？您对哪些工具有过最好的体验？（你确实运行测试，对吧？）

**更新 2008-01-29**

到目前为止，已经提到了[TestLink](http://testlink.sourceforge.net/docs/testLink.php)和[Fitness 。](http://fitnesse.org/)[一个相关的问题还产生了一个指向](https://stackoverflow.com/questions/166103/free-program-for-building-managing-test-plans)[ReadySet](http://readyset.tigris.org/)项目的链接，这是一个开放的软件规划文档模板集合。

我使用过 TestLink 并发现它还可以，但我不能说我喜欢使用它。有没有人有过 Fitnesse 的经验？或者有没有其他你用过并觉得满意的免费工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-08-18T11:51:20.163

您绝对应该尝试 Klaros-Testmanagement [http://www.klaros-testmanagement.com](http://www.klaros-testmanagement.com)，它有一个免费的、不受限制的社区版。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T19:16:18.867

是的，我们确实进行了测试，但没有我想要的那么多！

我强烈推荐[TestLink](http://testlink.sourceforge.net/docs/testLink.php) - 您链接到的工具列表显示它的下载量超过了所有其他工具的总和。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T13:47:23.187

我已经使用 QualityCenter/TestDirectory 很长时间了。

我现在正在使用 testlink，我必须说到目前为止我更喜欢 QualityCenter/TestDirectory，即使它基于一些有缺陷的 ActiveX 控件。

QualityCenter/TestDirectory 更容易使用，界面也更好。

TestLink 和 QualityCenter/TestDirectory 主要用于手动测试用例（但是，您可以使用 QualityCenter/TestDirectory 上的 Quick Test Pro 来自动化您的测试）。

Fitnesse 在我看来是另一种工具：基本上，您在 wiki 上编写测试用例并将其链接到 JUnit 测试。其他类似的工具是 GreenPepper、Concordion 等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-28T11:41:53.113

PractiTest 是一个非常好的选择。不是免费的，但非常实惠 - [http://www.practitest.com](http://www.practitest.com)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-27T13:38:33.283

这个有点晚了，但我不得不建议您尝试[使用 TestLodge](http://www.testlodge.com)进行手动测试管理。它的工作方式与 TestLink 的工作方式类似，但它提供了更专业的界面，我们还允许我们的客户在他们的 uat 阶段使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T09:37:48.313

我们使用质量中心/测试总监的东西。据我所知，它很贵，而且不是那么好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T06:16:48.580

我听说过关于[Fitnesse](http://fitnesse.org/)的好消息，但我不知道它的测试跟踪有多好。

我*知道*我最近刚刚看到一个看起来很漂亮的 Trac 测试跟踪器或其他东西，但我现在找不到它......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-09-17T10:06:08.610

质量中心。它很贵，但它是最好的

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-08T08:51:05.457

我和帕特里克在一起——很好的办公工具:)

我只是用*Microsoft Word写我的*

这是我开发的结构：[编写系统测试计划](http://pm4web.blogspot.com/2008/07/writing-system-test-plan.html)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-26T17:44:40.387

一个想法，也许不是一个好的想法，是让每个测试在运行时向您的票务系统提交一张票，指示测试名称、构建版本、日期和测试结果。

这将使结果可在以后搜索。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-28T11:51:30.167

我们使用本土的 Access 数据库。

该数据库跟踪我们的需求、测试用例、测试计划和测试运行。我们能够生成最新的 RVTM，跟踪计划的进度，并将任务分配给测试人员。我们将它与 Outlook 集成，因此每个测试人员都被 QA 负责人从计划中分配了一个任务。完成后，他们只需在 Outlook 中勾选它并更新数据库。

对于我们的小型测试团队来说，它运行良好，我们可以随意定制它。

# c# - 在 .Net 2.0 中读取 PNG 图像文件

> ID：100247
> 
> 赞同：13
> 
> 时间：2008-09-19T07:28:27.623
> 
> 标签：c#, .net

我在 .Net 2.0 中使用 C#，我想读入 PNG 图像文件并检查具有不透明像素的第一行和第一列。

我应该使用什么程序集和/或类？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-19T07:39:41.793

[System.Drawing.dll 程序集中的位图](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)类：

```
Bitmap bitmap = new Bitmap(@"C:\image.png");
Color clr = bitmap.GetPixel(0, 0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-08T16:23:58.587

好吧，Bitmap 类可以读取 PNG 文件并访问像素。它可以看到透明像素吗？PNG 支持透明度，而 BMP 不支持。但是，它仍然有效。

```
Bitmap bitmap = new Bitmap("icn_loading_animated3a.png");
pictureBox1.Image = bitmap;
Color pixel5by10 = bitmap.GetPixel(5, 10); 
```

上面的代码读取了我的小图片，然后读取了一个透明像素。颜色类具有 RGBA 值，并且我读取的像素被识别为透明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T07:39:31.717

当然，我已经用谷歌搜索并找到了 PngBitmapDecoder 类，但它似乎在 .Net 2.0 中不可用？

[http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.pngbitmapdecoder.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.pngbitmapdecoder.aspx)

上面的链接提到它在我似乎没有包含在 .Net 2.0 中的 PresentationCore 程序集中

# perl - 我在哪里可以得到关于 Perl 相关问题的好答案？

> ID：100248
> 
> 赞同：20
> 
> 时间：2008-09-19T07:28:56.483
> 
> 标签：perl, resources, forums

AFAIK Stack Overflow 的目标之一是确保任何人都可以来到这里并找到她的 Perl 相关问题的**好**答案。当然，初学者会问[学习 Perl 的最佳在线资源](https://stackoverflow.com/questions/70573/best-online-%0Asource-to-learn-perl)是什么，但其他人可能只是想问一个问题。

可能最友好的地方是[Perl Monks 修道院](http://perlmonks.org/)。它是一个评级系统类似于 Stack Overflow 但比 Stack Overflow 更简单的网站。你可以在那里找到很多好的答案，如果你没有找到答案，你可以随时问。

另一个重要资源是您当地[Perl Mongers](http://www.pm.org/)组的邮件列表。

当您在寻找 Perl 相关问题的答案时，您会去**哪里**？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-19T07:32:31.047

值得注意的是，除了论坛之外， [http ://perlmonks.org 还有 Chatterbox，可以在与其他用户的对话中立即回答简单的问题。](http://perlmonks.org)

但是，它需要在[使用 Chatterbox](http://perlmonks.org/?node=fullpage+chat)之前[设置一个帐户](http://perlmonks.org/?node=Create+a+New+User)并[登录](http://perlmonks.org/?node=login)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-19T08:34:29.977

到目前为止，我对我在这里看到的 Perl 答案的质量非常满意。我从会议、Perlmonks、use.perl.org 等中认识的许多最有经验的 Perl 程序员似乎都在场并认真而清晰地回答问题。如果某个答案是错误的，或者只是在宣传不良实践的意义上很糟糕，这些答案会很快被识别、否决和/或评论。

我是 Perlmonks 的忠实粉丝，但它与这个网站不同。除了特定于 Perl 之外，它还为审查模块、发布代码片段、审查书籍等预留了单独的区域。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-19T08:00:08.813

最佳地点：这里。每次我问，我都会在不到 20 分钟的时间内得到**正确的答案。**比其他任何地方都快**。**

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-19T07:35:52.850

我从来没有问过问题，但这可能是因为我倾向于编写简单的脚本而不是应用程序。

一直发现[Perldoc 站点](http://perldoc.perl.org/perl.html)是一个很好的方法来解决如何做的事情——而且我通常会在看的时候学到更多。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-19T08:11:30.470

有时，尝试通过 IRC 寻求帮助可能是值得的。很久以前，我发现 freenode 网络上的#perl 频道非常友好和乐于助人。与往常一样，用尽解决问题的常规方法很重要：阅读文档、搜索网络等。

但是，我还要借此机会提一下您不应该*去*哪里寻求帮助：MagNet 上的#perl 频道，又名 irc.perl.org。这是一个人们只是闲逛并谈论除了帮助请求之外的任何事情的频道。然而，在那个网络上，有很多[频道](http://www.irc.perl.org/channels.mhtml)，特别是关于某些 Perl 相关项目的频道。潜伏在其中的人很可能是相关软件的主要作者。这些频道也不是帮助台，但如果你有一个非常具有挑战性和有趣的问题，你也许可以让他们有足够的兴趣来帮助你。只要确保你先做好功课，并准备好自己参与其中。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-19T20:07:35.950

对于 Perl 内置和标准模块的文档，[perldoc.perl.org](http://perldoc.perl.org)是 Perl 文档的 Web 版本，具有漂亮的颜色等。为此，我使用关键字书签`pd`。

对于查找模块，[search.cpan.org](http://search.cpan.org)是去处；为此，我使用关键字`pm`。

当你有一个需要人工回答的问题时，[Perl Monks](http://www.perlmonks.org)是我的首选，尽管 Stack Overflow 似乎已经吸引了很多人。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-19T12:47:12.310

Usenet 也很不错，comp.lang.perl.misc、comp.lang.perl.modules 和 comp.lang.perl.moderated 是提问恕我直言的好地方。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-30T14:29:13.010

[官方 Perl 5 Wiki](http://www.perlfoundation.org/perl5/index.cgi?perl_5_wiki)是另一个包含大量信息和链接的好资源。

（另请参阅 wiki 主页底部的[Planet Perl](http://planet.perl.org/)提要聚合器的最新头条新闻。查看它很有用，因为它有时会提出您不知道应该问的问题。）

顺便说一句，一个雄心勃勃的 stackoverflow Perl 粉丝还可以在 Perl 5 wiki 中添加一个新部分，指向在 stackoverflow 上回答的问题（反之亦然）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-19T10:51:09.447

我更喜欢 use.perl.org 而不是 perlmonks。我不确定为什么。这是一个较小的社区，也许对我来说信噪比更高。

顺便说一句，我在任何问题上都能得到很好的答案，而不仅仅是 Perl 问题。我问 Java 问题、Linux 问题，有时甚至是文化问题，总有人知道。:)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-07-13T02:00:41.547

我很惊讶没有人提到[Perl Beginners](http://lists.cpan.org/showlist.cgi?name=beginners)邮件列表。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-19T09:37:22.260

我喜欢 IRC，试试 irc.perl.org 或 irc.freenode.net 上的 #perl，或者 irc.efnet.nl 上的 #perlhelp。很多非常聪明、乐于助人的人总是愿意讨论与 perl 相关的问题。

也许我会在那里见到你:)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-19T09:36:57.190

我没有特定的网站，但倾向于只用谷歌搜索我正在寻找的主要关键字。那里有很多网站，但是，对于非常具体的东西，我在这里得到了最好的回应。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-21T21:02:23.460

有一个大的 AIM/Jabber 列表，里面有你是朋友的知识渊博的 Perl 人。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-07-13T03:32:56.003

我在 #catalyst、#perl 和 irc.perl.org 上的其他频道上与我想象中的朋友交谈。

[编辑] 请记住，由于与您并不真正认识的人进行非面对面交流的局限性，您需要同时尊重那些表面上看起来对您非常粗鲁的人。在 IRC 上厚脸皮是值得的。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-10-14T21:15:24.657

我会说[Stackoverflow](http://www.stackoverflow.com/)

# c# - .NET 中是否有 OpenFileOrFolderDialog 对象？

> ID：100264
> 
> 赞同：7
> 
> 时间：2008-09-19T07:32:35.493
> 
> 标签：c#, .net, filedialog

是否可以使用[`OpenFileDialog`](https://login.live.com/login.srf?wa=wsignin1.0&rpsnv=10&ct=1221809452&rver=5.5.4177.0&wp=MCLBI&wlcxt=msdn%24msdn%24msdn&wreply=http:%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fsystem.windows.forms.openfiledialog.aspx&id=254354&lc=1033)类选择文件或文件夹？它似乎只允许选择文件，如果您选择一个文件夹然后选择打开，它将导航到该文件夹​​。

如果`OpenFileDialog`不能用于此，我应该使用另一个对象吗？

**编辑**：场景是我有一个可以上传一个...许多文件或文件夹的工具。我需要能够提供一个`OpenFileDialog`允许用户选择文件、文件夹或它们的组合的对话框。我知道`FolderBrowseDialog`在这种情况下，这不是答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-25T06:37:31.667

这是我一直在寻找的解决方案，本文提供了代码并描述了如何创建满足我需求的对话框。

[CodeProject：IShellBrowser 的完整实现](http://www.codeproject.com/KB/dialog/FileDialogs.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-25T20:49:55.913

是的，您可以使用 OpenFileDialog 来选择一个文件夹。这是 CodeProject 中的一篇文章，它演示了一种方法（[http://www.codeproject.com/KB/dialog/OpenFileOrFolderDialog.aspx](http://www.codeproject.com/KB/dialog/OpenFileOrFolderDialog.aspx)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T07:34:19.920

以我在 .NET 的经验，我不得不说不，对于否定和简短的回答，我很抱歉，但我真的不认为有

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T07:47:45.113

[如果您有时间，可以使用System.Windows.Forms.TreeView](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.aspx)类轻松创建自己的。每个节点都可以有一个复选框，因此如果您填充树视图（onexpand），您可以让用户选择他想要上传的文件/目录。

这应该让您开始使用目录填充树视图，在树视图中添加文件的工作应该不会那么难：

[http://www.java2s.com/Tutorial/VB/0280__GUI-Applications/FileTreeview.htm](http://www.java2s.com/Tutorial/VB/0280__GUI-Applications/FileTreeview.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T07:52:23.137

否：OpenFileDialog 仅用于打开文件。无论如何，您可以使用一个 FolderBrowserDialog。

[编辑] 回答太快：提问者的编辑是在之后。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-20T21:31:55.603

我建议看一下**[Ookii Dialogs](https://github.com/ookii-dialogs)**库，它们分别为 Windows 窗体和 WPF 实现了文件夹浏览器对话框：

[![Windows 10 上的 Ookii 文件夹浏览器对话框](../Images/967f4739997a31b3b56c7be42c771775.png)](https://github.com/ookii-dialogs)

> **Ookii.Dialogs.Wpf**
> 
> [https://github.com/augustoproiete/ookii-dialogs-wpf](https://github.com/augustoproiete/ookii-dialogs-wpf)

* * *

> **Ookii.Dialogs.WinForms**
> 
> [https://github.com/augustoproiete/ookii-dialogs-winforms](https://github.com/augustoproiete/ookii-dialogs-winforms)

# web-services - 连接到 IMDB

> ID：100280
> 
> 赞同：23
> 
> 时间：2008-09-19T07:36:36.637
> 
> 标签：web-services, imdb

有没有人这样做过？在我看来，应该有一个网络服务，但我找不到。我正在编写一个供个人使用的应用程序，它只显示来自 IMDB 的基本信息。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-11-16T08:29:33.247

[IMDb](http://www.imdb.com/)的库目前看起来非常不可靠且效率极低。我真的希望[IMDb](http://www.imdb.com/)只创建一个网络服务。

经过一番搜索，我找到了[IMDb](http://www.imdb.com/)的合理替代方案。它提供了所有基本信息，例如概述、年份、评级、海报、预告片等：

[电影数据库 (TMDb)](http://api.themoviedb.org/)。

[它为多种语言](https://www.themoviedb.org/documentation/api/wrappers-libraries)提供了一个带有包装器的 web服务，并且到目前为止看起来很可靠。对我来说，搜索结果也更准确。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-19T07:38:33.903

没有可用的网络服务。

但是每种语言都有足够多的 html 抓取工具来满足您的需求！

我在一些个人项目中使用了[.NET 3.5 Imdb Services 开源项目。](http://www.codeplex.com/imdb)

1 分钟谷歌搜索结果：

*   Perl：[IMDB 电影](http://search.cpan.org/~stepanov/IMDB-Film/)
*   红宝石：[libimdb-ruby](http://rubyforge.org/projects/libimdb-ruby/)
*   蟒蛇：[IMDbPY](http://imdbpy.sourceforge.net/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-19T07:44:16.527

IMDb 发布的唯一“API”是一组[纯文本数据文件](http://www.imdb.com/interfaces)，其中包含格式化的演员、导演、电影等列表。除非有人为您的语言发布了解析器，否则您可能需要编写自己的解析器。尝试 Google 搜索，例如“imdb api”和“imdb parser”。

屏幕刮板可能有用，但他们在使用条款中明确[禁止刮板](http://www.imdb.com/help/show_leaf?usedatasoftware)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-20T21:27:04.847

这是我自己使用 RegEx 的解决方案：

```
private const string UglyMovieRegex = "(?<=5>|3>)(Cast|Director:|Fun\\sStuff|Genre:|Plot:|Runtime:|Tagline:|Writers:)"
                                                + "|href=\"[\\w\\d/]+?(Genres|name|character)/([\\w]+?)/\".*?>([.\\-\\s\\w]+)</a>"
                                                + "|(?<=h\\d>)([.\\w\\s'\\-\"]+)(?=<a\\sc|</d|\\|)";

Regex MovieData = new Regex (UglyMovieRegex, RegexOptions.Compiled | RegexOptions.Multiline | RegexOptions.Singleline ); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-06-27T16:00:08.677

虽然这是两年前发布的，但这里有一个简单的 python 代码

```
import urllib2

movie_id = raw_input('Enter the ID of the movie: ')
json = urllib2.urlopen('http://imdbapi.com/?i=' + movie_id + '&r=json')

print json.read() 
```

另存为 imdb.py ，然后在 shell 或终端或其他任何地方运行

如果您想要 xml 数据，只需将 json 替换为 xml

请注意，这是使用 imdbapi.com 网站返回 json 结果访问该网站以查看更多选项。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-19T07:48:53.240

IMDB 禁止爬虫，并且每隔一段时间就更改一次页面布局，因此解析 HTML 是一种选择，但要准备好每年调整 2-3 次代码（去过那里，做过那个，放弃）。他们确实有一项收费服务，可以完全访问数据，但你还需要解释它的用途，并说服他们你不是在建立一个有竞争力的网站（我有一个链接，但似乎已更改，现在找不到）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-08-23T23:03:33.163

另一种选择是在本地机器上运行 IMDB 数据库。[Java 电影数据库](http://www.jmdb.de/)导入 IMDB 数据库文件，对其进行转换并提供本地可访问的 IMDB 副本。IMDB 有一些 Java 电影数据库没有的功能，反之亦然，但如果您正在寻找的是快速访问所有数据，那么可能值得一试。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-04-20T14:07:54.063

现在有一个（未记录的）API，例如`http://www.imdb.com/xml/find?json=1&q=Harry+Potter`. 请参阅[IMDB 是否提供 API？](https://stackoverflow.com/questions/1966503/does-imdb-provide-an-api)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-14T19:36:26.283

TRYNT Heavy Technologies 提供（免费）用于检索基本 IMDb 数据的 Web 服务——查看他们的网站[http://www.trynt.com/trynt-movie-imdb-api/](http://www.trynt.com/trynt-movie-imdb-api/)。他们还为电视数据提供单独的服务。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-09-22T07:30:17.500

至少有一个名为 IMDb8 的非官方 IMDb API。它有大约 31 个端点，包括

1.  演员/今天出生的名单
2.  演员/获奖总结
3.  标题/获取图
4.  标题/获得顶级船员

etc. Like any other API it is very straightforward to use. I used this API for building a fun trivia project. You can find a tutorial on how to [get started here](https://blog.api.rakuten.net/imdb-api-tutorial/).

# c# - 如何检查扫描仪是否已插入（C#、.NET TWAIN）

> ID：100284
> 
> 赞同：8
> 
> 时间：2008-09-19T07:37:40.007
> 
> 标签：c#, twain

我在我的应用程序中使用来自[http://www.codeproject.com/KB/dotnet/twaindotnet.aspx?msg=1007385#xx1007385xx](http://www.codeproject.com/KB/dotnet/twaindotnet.aspx?msg=1007385#xx1007385xx)的 .NET TWAIN 代码。当我在未插入扫描仪的情况下尝试扫描图像时，应用程序会冻结。

如何使用 TWAIN 驱动程序检查设备是否已插入？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-10T22:12:19.277

也许我的问题过于字面化了，但是使用 TWAIN API，无法检查设备是否已插入，即已连接并打开电源。TWAIN 标准确实为此目的定义了一种称为 CAP_DEVICEONLINE 的功能，但该功能的构思非常糟糕，并且很少有驱动程序正确实现它，因此在实践中它是无用的。

您可以得到的最接近的是： 打开设备 (MSG_OPENDS)：几乎所有驱动程序在打开时都会检查设备就绪，并向用户显示错误对话框。*没有用于抑制或检测此对话框的 TWAIN 机制*某些驱动程序将允许用户更正问题并继续，在这种情况下，您（您的应用程序）将永远不会知道存在问题。一些驱动程序允许用户取消，在这种情况下 MSG_OPENDS 操作将失败，可能返回 TWRC_CANCEL 但也可能返回 TWRC_FAILURE

即使设备处于脱机状态，一些 TWAIN 驱动程序也会正常打开。这样的驱动程序*可能会*向 CAP_DEVICEONLINE 查询返回 FALSE。当您使用 MSG_ENABLEDS 启用设备时，这样的驱动程序可能会执行设备在线检查，然后如果设备不在线，您会收到错误对话框给用户，依此类推。

除了 IMPO：WIA 比 TWAIN 更“现代”，但扫描的全面性也远不如 TWAIN，而且根据我的经验，它无法用于从文档进纸器进行多页扫描。WIA 的设计人员和维护人员似乎不了解或关心除低端消费平板之外的扫描仪。这对相机有好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-01T08:23:13.863

我从您从 CodeProject 下载的相同源代码开始，但将 MainFrame.cs 中启动扫描的大部分代码移至 Scanner 类。为了检查扫描错误，我调用了以下方法，而不是直接调用 Twain.Acquire：

```
enum AcquireResult
{
    OK = 0,
    InitFailed = 1,
    DeviceIDFailed = 2,
    CapabilityFailed = 3,
    UserInterfaceError = 4
}
private void StartScan()
{
    if (!_msgFilter)
    {
        _parent.Enabled = false;
        _msgFilter = true;
        Application.AddMessageFilter(this);
    }
    AcquireResult ar = _twain.Acquire();
    if (ar != AcquireResult.OK)
    {
        EndingScan();
        switch (ar)
        {
            case AcquireResult.CapabilityFailed:
                throw new Exception("Scanner capability setup failed");
            case AcquireResult.DeviceIDFailed:
                throw new Exception("Unable to determine device identity");
            case AcquireResult.InitFailed:
                throw new Exception("Scanner initialisation failed");
            case AcquireResult.UserInterfaceError:
                throw new Exception("Error with the Twain user interface");
            default:
                throw new Exception("Document scanning failed");
        }
    }
} 
```

我通常在单独的线程上启动扫描事件，以使应用程序在扫描过程中不会冻结。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-24T03:49:57.823

只需将此代码添加到您的 TwainCommand (cmd)

```
case TwainCommand.Null:
    {
     EndingScan();
     tw.CloseSrc();
             Msgbox("There is no device or the scannning has been cancelled.");
     break;
    } 
```

如果系统未检测到任何设备或扫描已被取消，则会出现此信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-18T05:28:13.833

您可以在注册表中检查。在：

`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class\{6bdd1fc6-810f-11d0-bec7-08002be2092f}`曾经检测到的每个扫描仪都在子项中枚举。

从 开始`0000`，检查该`CreateFileName`值是否为空白或有数据。

如果它有数据，它是一个连接的扫描仪，如果它是空白的，它没有连接。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2010-04-24T18:51:55.863

我尝试这样做，但不适用于 TWAIN mybe 尝试 WIA

我试试这个：

在按钮上运行扫描仪

```
timer1.Interval = 30000;

switch (cmd)
{
case TwainCommand.TransferReady:

{
..........
}

default:

{
timer1.Start();
break;
} 
```

在事件计时器滴答声上

```
{
EndingScan();
tw.CloseSrc();
} 
```

# .net - 混搭和 SharePoint

> ID：100290
> 
> 赞同：0
> 
> 时间：2008-09-19T07:38:47.053
> 
> 标签：.net, web-services, sharepoint, mashup

SO中的某个人可以向我提供有关与SharePoint平台相关的企业混搭和技术的资源列表吗？

**更新**（根据评论中@Spoon16 的建议）：- 混搭应用程序通常可以从 SharePoint 站点检索联系人列表，并在地图上显示选定联系人的地址（同样可能是谷歌地图）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T07:51:32.297

将外部信息提取到 SharePoint 有多种不同的方法。

在外部应用程序中混搭 SharePoint 数据：

*   [网络服务](http://msdn.microsoft.com/en-us/library/ms479390.aspx)；对底层 API 的出色 Web 服务覆盖将允许您构建外部混搭（就像您在问题评论中提到的那样）。具体看一下[Lists Service](http://msdn.microsoft.com/en-us/library/ms479390.aspx)。

要在 SharePoint 内部混搭外部数据源：

*   [业务数据目录](http://msdn.microsoft.com/en-us/library/ms563661.aspx)；当您拥有 Microsoft Office SharePoint Portal 服务器的企业版时，您可以使用业务数据目录以读/写方式与各种外部数据源进行交互。适用于关系数据库和 Web 服务。
*   [企业搜索](http://msdn.microsoft.com/en-us/library/ms570748.aspx)；SharePoint 的企业搜索技术提供的索引功能非常广泛
*   [RSS Web 部件](http://office.microsoft.com/en-us/sharepointserver/HA101079761033.aspx)；允许您使用 XSLT 转换并将其应用于任何 RSS 提要并在任何 SharePoint 页面上输出结果
*   [页面查看器 Web 部件](http://office.microsoft.com/en-us/sharepointtechnology/HA011609261033.aspx)；允许将 iframe 嵌入任何页面，提供将外部应用程序集成到 SharePoint 环境的简单机制

SharePoint 拥有一个[广泛的开发框架](http://msdn.microsoft.com/en-us/sharepoint/default.aspx)，使您能够利用 .NET 框架的全部功能来实现您最疯狂的混搭梦想。如果您愿意，您甚至可以使用向 SharePoint 添加其他服务，这些服务以自定义方式（不包括在开箱即用的 Web 服务中）公开基础数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T22:31:12.403

也可以自定义 List View 以使用[Google Maps](https://developers.google.com/maps/documentation/javascript/)呈现 Map 。

## 解决方案说明

为了存储地理位置并在地图上可视化，使用自定义列表。自定义列表基于具有自定义内容类型和视图的通用列表来呈现地图。

地图列表视图是使用自定义 XSLT 样式表和地图的 JavaScript 呈现控件实现的。

有关实施详细信息，请关注[将地图功能引入 SharePoint 2010 的帖子：渲染地图列表视图](http://vgrem.wordpress.com/2012/12/21/bringing-map-functionality-into-sharepoint-2010-rendering-map-list-view/)

## 用法

对于指定的解决方案，我们只需要创建 List 实例来存储联系人并填充它。

地理位置保存表格 ![在此处输入图像描述](../Images/2b35e9cc14a1f36d1a0b3d47ca85f55e.png)

地图列表视图 ![在此处输入图像描述](../Images/8f6bebcabbfea1651fab5bae738a6040.png)

# c# - 在 C# 中使用多线程加速循环（问题）

> ID：100291
> 
> 赞同：14
> 
> 时间：2008-09-19T07:39:01.140
> 
> 标签：c#, multithreading, .net-2.0

想象一下，我有一个函数可以遍历一百万/十亿个字符串并检查它们。

前：

```
foreach (String item in ListOfStrings)
{
    result.add(CalculateSmth(item));
} 
```

它消耗大量时间，因为CalculateSmth 是非常耗时的函数。

我想问：如何在这种过程中集成多线程？

f.ex：我想启动 5 个线程，每个线程都返回一些结果，然后一直持续到列表中有项目。

也许任何人都可以展示一些例子或文章..

忘了提我在 .NET 2.0 中需要它

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-19T07:42:38.917

您可以尝试[并行扩展](http://msdn.microsoft.com/en-us/concurrency/default.aspx)（.NET 4.0 的一部分）

这些允许您编写如下内容：

```
Parallel.Foreach (ListOfStrings, (item) => 
    result.add(CalculateSmth(item));
); 
```

当然 result.add 需要是线程安全的。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-19T07:55:41.833

并行扩展很酷，但这也可以通过使用线程池来完成，如下所示：

```
using System.Collections.Generic;
using System.Threading;

namespace noocyte.Threading
{
    class CalcState
    {
        public CalcState(ManualResetEvent reset, string input) {
            Reset = reset;
            Input = input;
        }
        public ManualResetEvent Reset { get; private set; }
        public string Input { get; set; }
    }

    class CalculateMT
    {
        List<string> result = new List<string>();
        List<ManualResetEvent> events = new List<ManualResetEvent>();

        private void Calc() {
            List<string> aList = new List<string>();
            aList.Add("test");

            foreach (var item in aList)
            {
                CalcState cs = new CalcState(new ManualResetEvent(false), item);
                events.Add(cs.Reset);
                ThreadPool.QueueUserWorkItem(new WaitCallback(Calculate), cs);
            }
            WaitHandle.WaitAll(events.ToArray());
        }

        private void Calculate(object s)
        {
            CalcState cs = s as CalcState;
            cs.Reset.Set();
            result.Add(cs.Input);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-19T07:58:32.733

请注意，并发不会神奇地为您提供更多资源。您需要确定是什么让CalculateSmth 变慢了。

例如，如果它是 CPU 密集型的（并且您在单核上），那么无论您是按顺序执行还是并行执行，相同数量的 CPU 滴答都会进入代码。另外，您会从管理线程中获得一些开销。相同的论点适用于其他约束（例如 I/O）

如果CalculateSmth 在其执行期间释放资源，那么您只会在此获得性能提升，这可以由另一个实例使用。这并不少见。例如，如果任务涉及 IO，然后是一些 CPU 的东西，那么进程 1 可能正在做 CPU 的东西，而进程 2 正在做 IO。正如 mats 所指出的，如果你有基础设施，一系列的生产者-消费者单元可以实现这一点。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-19T09:45:05.410

您需要拆分要并行执行的工作。这是一个如何将工作一分为二的示例：

```
List<string> work = (some list with lots of strings)

// Split the work in two
List<string> odd = new List<string>();
List<string> even = new List<string>();
for (int i = 0; i < work.Count; i++)
{
    if (i % 2 == 0)
    {
        even.Add(work[i]);
    }
    else
    {
        odd.Add(work[i]);
    }
}

// Set up to worker delegates
List<Foo> oddResult = new List<Foo>();
Action oddWork = delegate { foreach (string item in odd) oddResult.Add(CalculateSmth(item)); };

List<Foo> evenResult = new List<Foo>();
Action evenWork = delegate { foreach (string item in even) evenResult.Add(CalculateSmth(item)); };

// Run two delegates asynchronously
IAsyncResult evenHandle = evenWork.BeginInvoke(null, null);
IAsyncResult oddHandle = oddWork.BeginInvoke(null, null);

// Wait for both to finish
evenWork.EndInvoke(evenHandle);
oddWork.EndInvoke(oddHandle);

// Merge the results from the two jobs
List<Foo> allResults = new List<Foo>();
allResults.AddRange(oddResult);
allResults.AddRange(evenResult);

return allResults; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T07:53:22.447

您必须回答的第一个问题是您是否应该使用线程

如果您的函数 CalculateSmth() 基本上是 CPU 密集型的，即 CPU 使用量很大并且基本上没有 I/O 使用，那么我很难看到使用线程的意义，因为线程将竞争相同的资源，在这种情况下是 CPU。

如果您的 CalculateSmth() 同时使用 CPU 和 I/O，那么它可能是使用线程的一个要点。

我完全同意对我的回答的评论。我做了一个错误的假设，即我们谈论的是具有一个内核的单个 CPU，但是这些天我们有多核 CPU，我的错。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T07:45:41.780

并不是说我现在在这里有什么好文章，而是你想做的事情是沿着 Producer-Consumer 和 Threadpool 做的。

生产者循环并创建任务（在这种情况下可能只是将列表或堆栈中的项目排队）。比如说，消费者是五个线程，它们从堆栈中读取一项，通过计算来消耗它，然后将它存储在其他地方。

这样，多线程仅限于这五个线程，并且在堆栈为空之前，它们都有工作要做。

需要考虑的事情：

*   将保护放在输入和输出列表上，例如互斥锁。
*   如果顺序很重要，请确保保持输出顺序。一个例子可能是将它们存储在 SortedList 或类似的东西中。
*   确保CalculateSmth 是线程安全的，它不使用任何全局状态。

# flash - ActionScript2 -> ActionScript3 的学习曲线如何？

> ID：100295
> 
> 赞同：1
> 
> 时间：2008-09-19T07:39:58.893
> 
> 标签：flash, actionscript-3

我对 ActionScript 和 ActionScript2 了如指掌，但我已经离开 Flash 好几年了。流利使用 ActionScript3 和新的 Flash 功能有多大？从 Colin Moock 的博客中，我听说一些基本的电影剪辑方法已经改变......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T17:51:33.997

您可能已经看过[as2 -> as3 迁移文档](http://livedocs.adobe.com/flex/3/langref/migration.html)？

当然，一些语法已经改变，但如果你对 as2 很了解，那么编写 as3 就不会成为问题。语法一开始可能会出现一些奇怪的事情，但这只是检查文档以了解新的执行方式。如果您通过 as1 和 as2 破解自己，as3 可能会引起一些头痛，因为它更加严格（不允许您做您不应该做的事情）；）

您可能会在不到一周的时间内使用 as3 就可以了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T08:01:59.993

我想说这取决于您的 AS2（和一般 OOP）知识水平。如果您习惯于面向对象的编程和强类型，那么学习曲线应该不会那么陡峭。

我是作为一名 Java 程序员长大的，发现 AS3 中的新概念大部分都很容易掌握，而且 API 比 AS2 更一致，更有意义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T08:13:17.987

实际上，AS3 更好……更像 C# 或 Java，具有一致的 API、命名、包。使用 AS3 是一种享受，而使用 AS2 往往是地狱。

这就是问题所在。如果你习惯了 AS2 的怪癖，这里和那里都需要 hacks.. 快速而肮脏的方式.. 那么 AS3 并不容易习惯。但从长远来看，它确实值得。无论如何.. AS2 是旧的.. 死了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T18:47:58.067

Actionscript3 在许多方面确实有很大的不同，但重要的是要意识到您只是在记住内置的包、类、属性和方法，这与学习以前的版本类似。一些需要克服的较大障碍是显示列表和事件（事件流 > 示例：冒泡）。许多语言已更改为开发人员的优势，例如使用用于显示对象的 Loader 类或用于加载 XML 和 CSS 等数据的 URLLoader 类或调用 php 脚本来加载动态资产的统一方式。一旦您对语言的这些新方面充满信心，您就可以开始扩展以前的课程或创建新课程。Actionsscript3 可能有一个陡峭的学习曲线，但山的另一边几乎同样陡峭！。睁眼后，“哦，我明白了！

我建议任何想要学习适当的技术、惯例和工作流程的人，请前往[http://www.gotoandlearn.com，Lee](http://www.gotoandlearn.com) Brimelow 在展示前沿技术和效果方面做得非常出色。Lee 还作者[http://theflashblog.com](http://theflashblog.com)，我每天都会亲自查看。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T08:10:54.390

[Antti](https://stackoverflow.com/users/6037/antti)[指出了迁移文档](http://livedocs.adobe.com/flex/3/langref/migration.html)的链接。

Colin Moock 还开始讨论 AS2 和 AS3 之间的[异同](http://www.insideria.com/2008/07/the-charges-against-actionscri.html)[，](http://www.insideria.com/2008/01/actionscript-30-is-it-hard-or.html)并呼吁 Adob​​e 和社区对它们进行排序。

在后一篇文章中，他提出了 10 个关于迁移到 AS3 的可靠 WTF，解释了每个问题，然后包括每个问题的“Adobe 应该做什么”和“我们应该做什么”部分：

> 1.  从 Flash CS3 中删除 on()/onClipEvent() 使得创建简单的交互变得困难。
> 2.  摆脱加载的 .swf 文件很困难。
> 3.  强制转换 DisplayObject.parent 使控制父影片剪辑变得困难。
> 4.  删除 getURL() 使链接变得困难。
> 5.  删除 loadMovie() 使得加载 .swf 文件和图像变得困难。
> 6.  ActionScript 3.0 的附加错误使编码变得繁琐。
> 7.  动态引用库符号是不直观的。
> 8.  向手动创建的文本字段、所有影片剪辑或所有按钮添加自定义功能很麻烦。
> 9.  删除 duplicateMovieClip() 使得克隆 MovieClip 实例（真的）很困难。

# python - 如何分析 Python 代码以识别有问题的区域？

> ID：100298
> 
> 赞同：101
> 
> 时间：2008-09-19T07:40:22.010
> 
> 标签：python, static-analysis, cyclomatic-complexity

我有一个跨多个项目的大型源存储库。我想生成一份关于源代码健康状况的报告，确定需要解决的问题区域。

具体来说，我想调用具有高圈复杂度的例程，识别重复，并可能运行一些类似于 lint 的静态分析来发现可疑（因此可能是错误的）构造。

我该如何构建这样的报告？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-09-19T20:44:22.040

[对于测量圈复杂度， traceback.org](http://www.traceback.org/2008/03/31/measuring-cyclomatic-complexity-of-python-code/)上有一个不错的工具。该页面还很好地概述了如何解释结果。

+1 为[pylint](http://www.logilab.org/project/pylint)。它非常适合验证对编码标准（无论是[PEP8](http://www.python.org/dev/peps/pep-0008/)还是您自己组织的变体）的遵守情况，这最终有助于降低圈复杂度。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-02-10T01:47:31.273

对于圈复杂度，您可以使用`radon`：[https ://github.com/rubik/radon](https://github.com/rubik/radon)

（`pip`用来安装它`pip install radon`：）

此外，它还具有以下功能：

*   原始指标（包括 SLOC、注释行、空白行等）
*   Halstead 指标（全部）
*   可维护性指数（Visual Studio 中使用的指数）

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-19T08:05:48.283

对于静态分析，有[pylint](http://www.logilab.org/857)和[pychecker](http://pychecker.sourceforge.net/)。我个人使用 pylint，因为它似乎比 pychecker 更全面。

对于圈复杂度，你可以试试[这个 perl 程序](http://www.journyx.com/curt/complexity.html)，或者[这篇](http://www.traceback.org/2008/03/31/measuring-cyclomatic-complexity-of-python-code/)介绍了一个 python 程序的文章来做同样的事情。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-05-09T20:50:34.383

当您需要了解一个新项目时，Pycana 就像魅力一样！

> [PyCANa](https://sourceforge.net/projects/pycana/)（Python 代码分析器）是一个用于 python 的简单代码分析器的花哨名称，它在执行代码后创建一个类图。

看看它是如何工作的：http: [//pycana.sourceforge.net/](http://pycana.sourceforge.net/)

输出：

[![替代文字](../Images/b81a98a3dac4b3f711b07284f9c00b5b.png)](https://i.stack.imgur.com/mhEwK.png)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-19T09:19:57.637

感谢[Pydev](http://pydev.org/)，您可以非常轻松地[将 pylint 集成](http://pydev.org/manual_adv_pylint.html)到[Eclipse IDE](http://www.eclipse.org/)中，并在每次保存修改后的文件时获取代码报告。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-03-26T01:08:02.707

使用[flake8](https://pypi.python.org/pypi/flake8)，它在一个工具中提供 pep8、pyflakes 和圈复杂度分析

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-22T09:57:22.757

有一个名为 [CloneDigger](http://clonedigger.sourceforge.net/)的工具可以帮助您找到类似的代码片段。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-10-08T22:11:25.287

为了检查圈复杂度，当然有[**`mccabe`**](https://pypi.python.org/pypi/mccabe/)包。

安装：

```
$ pip install --upgrade mccabe 
```

用法：

```
$ python -m mccabe --min=6 path/to/myfile.py 
```

注意上面 6 的阈值。根据[这个答案](https://stackoverflow.com/a/1365185/832230)，分数 >5 可能应该被简化。

示例输出`--min=3`：

```
68:1: 'Fetcher.fetch' 3
48:1: 'Fetcher._read_dom_tag' 3
103:1: 'main' 3 
```

它也可以通过[pylint-mccabe](https://pypi.python.org/pypi/pylint-mccabe/)或[pytest-mccabe](https://pypi.python.org/pypi/pytest-mccabe/)等选择使用。

# c++ - 为什么调用 BeginPaint() 总是生成 WM_NCPAINT 消息？

> ID：100304
> 
> 赞同：2
> 
> 时间：2008-09-19T07:42:18.043
> 
> 标签：c++, windows, winapi

我在 Win32 API 上遇到问题。我有一个程序，当它处理`WM_PAINT`消息时，它调用`BeginPaint`剪辑区域并验证更新区域，但该`BeginPaint`函数始终生成`WM_NCPAINT`具有相同更新区域的消息，即使需要重新绘制的触摸部分仅在客户端内部地区。

有谁知道为什么会这样？`WS_CHILD`它位于具有样式的子窗口上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T08:09:52.423

The MSDN entry for WM_PAINT says:

> The function **may** also send the `WM_NCPAINT` message to the window procedure if the window frame must be painted and send the `WM_ERASEBKGND` message if the window background must be erased.

I'm trying to figure out why it is always sending even if the border isn't touched. I test that opening a small Notepad inside the control and minimizing. It doesn't touch the borders of the control, just inside and `BeginPaint()` generates a `WM_NCPAINT`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T10:27:45.480

如果您调用并作为参数的参数`SetWindowPos`传递会发生什么？`SWP_DEFERERASE``uFlags`

这应该防止`WM_SYNCPAINT`消息的生成，这将间接导致`WM_NCPAINT`消息被发送。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T07:53:34.087

我猜这个`WM_NCPAINT`消息总是在假设边框也需要重新绘制的情况下发送的！

# inversion-of-control - .Net 的最佳 IoC 框架

> ID：100322
> 
> 赞同：7
> 
> 时间：2008-09-19T07:48:16.360
> 
> 标签：inversion-of-control

> **可能重复：**
> [哪些 .NET 依赖注入框架值得研究？](https://stackoverflow.com/questions/21288/which-net-dependency-injection-frameworks-are-worth-looking-into)

StructureMap 和 Ninject 中哪个是最好的 IoC？

这应该与以下内容合并：[最佳注入框架](https://stackoverflow.com/questions/21288/which-c-net-dependency-injection-frameworks-are-worth-looking-into)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-19T07:56:18.103

视情况而定。对于需要简单容器的小型项目，我会选择 Ninject。我喜欢它又小又瘦的事实。我不喜欢这个属性，但有办法解决这个问题。

对于一个您可能需要的不仅仅是简单的 IoC 的大型解决方案，我会选择 Castle 的东西。那里有很多灵活性，您可以使用 xml、属性或 DSL 来配置东西，如果您以后需要它，您可以将您的 IoC 扩展到 AOP 领域。

我还没有尝试过结构图。它似乎比 IoC 做得更多。但我无法对此发表评论。我认为 Ninject 和 Structuremap 用于不同的目的，因此如果不了解更多关于上下文的信息，很难在两者之间进行选择。更好通常是一个相对概念:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-26T19:25:51.753

没有最好的。他们中的大多数以几乎相同的方式完成您需要的 90% 的工作。在某些情况下，一个可能比另一个更灵活。

如果没有别的选择，我会选择温莎，但我已经非常了解了。但如果我必须使用 Ninject 或 StructureMap，我不会抱怨。它们都是很好的框架。

我知道目前 Ninject 是唯一可以在 Compact 框架上运行的，所以如果这是一个 req. 然后 Ninject 是要走的路。

我有点害怕 Spring.NET，主要是因为我讨厌 XML。但也许它并没有我想的那么糟糕，不要喷我:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-19T07:58:00.610

我使用 StructureMap，所以我可能认为它是最好的。但也许将来我会选择 Unity，因为它是 MS 支持的，这意味着更好的文档和更少的依赖于一个人的善意，尽管那个人非常善意。当然，我不会仅仅因为它很好就改变框架。只要某些东西有效，我什至不升级。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T21:31:51.583

我自己会完成这个过程。我建议从 ninject 开始。只是因为它非常轻巧并且入门级别非常低。您可以在几个小时内启动并运行它。

您会发现，您将在设计系统时考虑到 IoC，并且无论您使用哪种 IoC 框架，设计都将基本相同。

在基本框架管道之外没有太多的返工，如果你愿意的话，你应该能够将 NInject 换成 StructureMap 之类的东西。

您最好的选择是开始使用一个，看看您发现了什么问题，然后决定替代方案是否更适合您的需求。

那里的框架似乎正在经历一个动态时期，新版本在各地发布。而 MEF，即 IoC 等等，可能会迫使格局进一步改变。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-07T10:25:56.110

[autofac](http://code.google.com/p/autofac)是小型项目的不错选择。如果你想要与你能想象到的任何东西进行硬核 IoC + 集成，我推荐[Spring.NET](http://springframework.net/)

**编辑**现在我想起来了，Autofac 适合任何规模的项目，而 Spring.NET 感觉太企业化了。

# xslt - XSL 代码覆盖工具

> ID：100324
> 
> 赞同：7
> 
> 时间：2008-09-19T07:49:11.053
> 
> 标签：xslt, code-coverage

是否有任何工具可以告诉我在测试期间实际执行了多少百分比的 XSL 文档？

**更新**

我找不到比 Oxygen 的 XSL 调试器和分析器更好的东西了，所以我接受了 Mladen 的回答。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-07-27T20:56:50.737

当被问到这个问题时，这并不存在，但现在有一个选项可用于查找 XSLT 文档的代码覆盖率：

[http://code.google.com/p/cakupan/](http://code.google.com/p/cakupan/)

我承认我还没有使用它，因为我现在还在收集信息，但据我所知，这就是 IT。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T09:53:02.473

不确定代码覆盖率本身，但您可以[从 Oxygen 找到一个 XML 调试器和分析器，](http://www.oxygenxml.com/xslt_debugger.html)这可能会帮助您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-26T14:20:34.983

如果有人仍然感兴趣，Saxon 有一个[性能分析](http://www.saxonica.com/html/documentation/using-xsl/performanceanalysis.html)，它有一个功能可以让你分解每个模板以及它们被使用的次数（这对于优化非常有用）。

这就是我的输出的样子：

![在此处输入图像描述](../Images/bd162233d66c6e50d8b696833e13ae84.png)

# groovy - Groovy：XMLSlurper 的正确语法以查找具有给定属性的元素

> ID：100325
> 
> 赞同：9
> 
> 时间：2008-09-19T07:49:26.933
> 
> 标签：groovy, xmlslurper

*给定一个结构为html -> body -> 一堆 div*的 HTML 文件，找到所有具有非空白标签属性的 div 的正确常规语句是什么？

以下不起作用：

```
def nodes = html.body.div.findAll { it.@tags != null } 
```

因为它找到了所有节点。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-19T09:47:29.647

尝试以下（Groovy 1.5.6）：

```
def doc = """
<html>
    <body>
        <div tags="1">test1</div>
        <div>test2</div>
        <div tags="">test3</div>
        <div tags="4">test4</div>
    </body>
</html>
"""

def html = new XmlSlurper().parseText( doc)

html.body.div.findAll { it.@tags.text()}.each { div ->
    println div.text()
} 
```

这输出：

```
test1
test4 
```

# vmware - 自动创建 VMWare 映像

> ID：100327
> 
> 赞同：6
> 
> 时间：2008-09-19T07:49:36.263
> 
> 标签：vmware, vmware-server

我希望能够通过指定应该进入其中的组件（最好是在脚本中）来创建 VMWare 映像，然后获取 VMWare 或第三个进程，以根据规范构建机器。

所以我想说例如。操作系统 - Windows 2003，应用程序 - Visual Studio 等，然后它会根据描述自动构建机器。

我知道您可以从现有机器创建模板，然后使用它，这更进一步，并根据一组规范构建模板。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T08:09:40.397

You can use an opensource [Unattended](http://unattended.sourceforge.net/).

# mysql - 在（My）SQL 数据库中存储事件时间的最佳方式

> ID：100332
> 
> 赞同：5
> 
> 时间：2008-09-19T07:51:23.327
> 
> 标签：mysql, time

我正在尝试决定将事件时间存储在 MySQL 数据库中的最佳方式。这些应该尽可能灵活，并且能够表示“单个事件”（从某个时间开始，不一定需要结束时间）、“全天”和“多天”事件、重复事件、重复全天事件，可能是“每月第三个星期六”类型的事件等。

请提出一些久经考验的数据库方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T08:17:30.923

Table: Events

*   StartTime (dateTime)
*   EndTime (dateTime) null for no end time
*   RepeatUnit (int) null = noRepeat, 1 = hour, 2 = day, 3 = week, 4 = dayOfMonth, 5 = month, 6 = year
*   NthDayOfMonth (int)
*   RepeatMultiple (int) eg, set RepeatUnit to 3, and this to 2 for every fortnight
*   Id - if required, StartTime might be suitable for you to uniquely identify an event.
*   Name (string) - name given to the event, if required

This might help. It would require a decent amount of code to interpret when the repeats are. Parts of the time fields that are at lower resolutions than the repeat unit would have to be ignored. Doing the 3rd saturday of the month woudln't be easy either... the NthDayOfMonth info would be required just for doing this kind of functionality.

The database schema required for this is simple in comparison with the code required to work out where repeats fall.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T09:01:35.077

我开发了一个大致遵循 iCalendar 标准（用于记录事件）的计划器应用程序。您可能需要阅读[RFC 2445](https://www.rfc-editor.org/rfc/rfc2445)或 Apple Inc. [icalendar 架构](https://developer.apple.com/legacy/library/documentation/AppleApplications/Reference/SyncServicesSchemaRef/Articles/Calendars.html#//apple_ref/doc/uid/TP40001540-CJBEHAAG)发布的此架构，以查看它们是否与问题相关。

我的数据库架构（当时没有考虑定期/全天事件）

```
event (event_id, # primary key
       dtstart,
       dtend,
       summary,
       categories,
       class,
       priority,
       summary,
       transp,
       created,
       calendar_id, # foreign key
       status,
       organizer_id, # foreign key
       comment,
       last_modified,
       location,
       uid); 
```

上表中的外键`calendar_id`指的是这个

```
calendar(calendar_id, # primary key
         name); 
```

while`organizer_id`指的是这个（缺少其他属性，如公用名等）

```
organizer(organizer_id, # primary key
          name); 
```

另一个您可能会发现更具可读性的文档位于[此处](http://www.kanzaki.com/docs/ical/)

希望这可以帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T08:17:45.480

You need two tables. One for storing the repeating events (table repeatevent) and one for storing the events (table event). Simple entries are only stored in the event table. Repeating entries are stored in the repeatevent table and all single entries for the repeating event are also stored in the event table. This means that everytime you enter a repeating entry, you have to enter all the single resulting entries. You can do this by using triggers, or as part of your business logic.

The advantage of this approach is, that querying events is simple. They are all in the event table. Without the storage of repeating events in the event table, you would have complex SQL or business logic that would make your system slow.

```
create table repeatevent (
id int not null auto_increment, 
type int, // 0: daily, 1:weekly, 2: monthly, ....
starttime datetime not null, // starttime of the first event of the repetition
endtime datetime, // endtime of the first event of the repetition
allday int, // 0: no, 1: yes
until datetime, // endtime of the last event of the repetition
description varchar(30)
)

create table event (
id int not null auto_increment,
repeatevent null references repeatevent, // filled if created as part of a repeating event
starttime datetime not null,
endtime datetime,
allday int,
description varchar(30)
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T08:13:23.507

Same way the [cron](http://en.wikipedia.org/wiki/Cron#Fields "Cron fields") does it? Recording both start and end time that way.

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-19T09:41:26.010

使用 datetime 和 mysql 内置的 NOW() 函数。在流程开始时创建记录，在流程结束时更新跟踪结束时间的列。

# winapi - Win95 / Win98 / WinME 上的每个进程的 CPU 使用率

> ID：100333
> 
> 赞同：1
> 
> 时间：2008-09-19T07:51:25.777
> 
> 标签：winapi, monitoring, process, windows-98

在 windows 95、windows 98 和 windows ME 下，如何以编程方式测量每个进程（或更好的每个线程）的 CPU 使用率？

如果它需要 DDK，你在哪里可以得到它？

请注意**Win9x 要求**。NT很容易。

编辑：我尝试安装[Win95/98 版本的 WMI](http://www.microsoft.com/downloads/details.aspx?familyid=98a4c5ba-337b-4e92-8c18-a63847760ea5&displaylang=en)，但[Win32_Process](http://msdn.microsoft.com/en-us/library/aa394372(VS.85).aspx)。`KernelModeTime`并`Win32_Process.UserModeTime`返回（ win9x 下`Null`的大多数属性也是如此）。`Win32_Process`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T10:11:21.660

看来 Performance Data Helper 应该可以安装在 Win9x 架构上。使用它，您应该能够获得所花费的时间。希望能对您有所帮助或至少为您提供一些起点的链接：

[[python-win32] 监控 CPU 使用率](http://mail.python.org/pipermail/python-win32/2005-July/003601.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-08T14:54:35.540

看一下[编写性能监视器](http://bcbjournal.org/articles/vol3/9906/Writing_a_Performance_Monitor.htm?PHPSESSID=605e132a2689d24ccd5598e0fdd9743c)，如果需要，可以[在此处](http://www.divshare.com/download/1281170-695)获得 Win98 DDK 。

# java - Java：防止 MetalFileChooserUI$IndentIcon.getIconWidth 中的 NPE？

> ID：100343
> 
> 赞同：3
> 
> 时间：2008-09-19T07:54:15.487
> 
> 标签：java, exception, nullpointerexception, jfilechooser

在 Windows 系统上。我得到以下 NPE 与`FileChooser`. 这是一个已知的错误，尚未被 sun 修复。[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6342301](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6342301)

有人知道防止此异常的解决方法吗？

谢谢。安德烈

> javax.swing.swing.SwingUtilities.layoutCompoundLabelImpl(Unknown Source) at javax.swing.plaf.metal.MetalFileChooserUI$IndentIcon.getIconWidth(Unknown Source) 的线程“AWT-EventQueue-2”java.lang.NullPointerException 中的异常。 SwingUtilities.layoutCompoundLabel(Unknown Source) at javax.swing.plaf.basic.BasicLabelUI.layoutCL(Unknown Source) at javax.swing.plaf.basic.BasicLabelUI.getPreferredSize(Unknown Source) at javax.swing.JComponent.getPreferredSize(Unknown Source) ) at javax.swing.plaf.basic.BasicListUI.updateLayoutState(Unknown Source) at javax.swing.plaf.basic.BasicListUI.maybeUpdateLayoutState(Unknown Source) at javax.swing.plaf.basic.BasicListUI$Handler.valueChanged(Unknown Source ) 在 javax.swing 的 javax.swing.DefaultListSelectionModel.fireValueChanged(Unknown Source)。javax.swing.DefaultListSelectionModel.changeSelection(Unknown Source) at javax.swing.DefaultListSelectionModel.fireValueChanged(Unknown Source) at javax.swing.DefaultListSelectionModel.changeSelection(Unknown Source) at javax.swing.DefaultListSelectionModel。 setSelectionInterval(Unknown Source) at javax.swing.JList.setSelectedIndex(Unknown Source) at javax.swing.plaf.basic.BasicComboPopup.setListSelection(Unknown Source) at javax.swing.plaf.basic.BasicComboPopup.access$300(Unknown Source)在 javax.swing.plaf.basic.BasicComboPopup$Handler.itemStateChanged(Unknown Source) 在 javax.swing.JComboBox.fireItemStateChanged(Unknown Source) 在 javax.swing.JComboBox.selectedItemChanged(Unknown Source) 在 javax.swing.JComboBox。内容更改（未知来源）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T07:57:02.533

在您链接到的错误报告中，他们还提到了一种解决方法。似乎归结为以特定顺序调用方法。你试过吗？

> 问题描述：在显式设置 UI 和删除所有文件过滤器之间似乎存在未记录的不良交互，即使是暂时的。如果后者是在设置 ui 之前完成的，尝试显示文件对话框将引发异常，但如果 ui 是在弄乱过滤器之前设置的，则不会。也许可以使代码对此更加健壮或在文档中包含警告？
> 
> 重现问题的步骤：运行附加的程序：它不会爆炸。然后将 setUI 行移动到构造函数的底部并再试一次：它会的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T08:08:56.233

So, now with registered account :)

The problem with these steps in the mentioned link is, that the look and feel and therefor the UI is set globaly in our software. So the UI is set before I'm able to manipulate the file filters.

Edit: Missunderstood the code for reproduction. The exampled works as mentioned. Thanks.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T08:25:03.650

看起来解决方法描述说您**应该**在操作过滤器之前尝试设置 UI。这不起作用吗？

如果这不起作用，是否可以在您设置 UI 的同时创建您操纵的 FileFilters 的实例？

# c# - 寻找 C# HTML 解析器

> ID：100358
> 
> 赞同：112
> 
> 时间：2008-09-19T07:57:14.513
> 
> 标签：c#, .net, html, parsing

> **可能重复：**
> [在 C# 中解析 html 的最佳方法是什么？](https://stackoverflow.com/questions/56107/what-is-the-best-way-to-parse-html-in-c)

我想提取 HTML 文档的结构 - 所以标签比内容更重要。理想情况下，它也能够在某种程度上合理地处理格式错误的 HTML。

有人知道可靠且高效的解析器吗？

# php - 禁用 Cakephp 的自动模型“功能”

> ID：100365
> 
> 赞同：2
> 
> 时间：2008-09-19T07:59:32.933
> 
> 标签：php, cakephp, model, cakephp-1.2

在 cake 1.2 中，有一个功能允许开发人员不必创建模型，而是让 cake 在运行时进行检测并为您创建模型。这个过程每次都会发生并且很整洁，但在我的情况下非常危险。我在某个地方读到过这个，现在我正在经历这个不好的一面。

我创建了一个包含所有文件的插件，一切看起来都很棒。直到我尝试使用模型的一些关联和功能。然后蛋糕声称我创建的这个模型不存在。**我使用此自动模型功能而不是抛出和错误将其缩小到蛋糕**！所以我不知道出了什么问题！

有人知道如何禁用此自动模型功能吗？这是一个好主意，但我似乎无法找到我的插件出错的地方，一个错误会非常有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T08:12:03.993

总是有可能实际创建模型文件并设置 var $useTable = false。
如果这不是您所要求的，并且模型及其关联确实存在，但 Cake 似乎无法找到它们，那么您必须在实际中对所有模型的名称及其类名进行三次检查模型定义和关联定义。

AFAIK 你不能禁用自动建模。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-20T03:36:02.847

**蛋糕1.2**

这是一个 hack，而且很丑，因为您需要编辑核心蛋糕文件，但这就是我的做法：\cake\libs\class_registry.php：第 127 行

```
if (App::import($type, $plugin . $class)) {
    ${$class} =& new $class($options);
} elseif ($type === 'Model') {
    /* Print out whatever debug info we have then exit */
    pr($objects);
    die("unable to find class $type, $plugin$class");
    /* We don't want to base this on the app model */
    ${$class} =& new AppModel($options);
} 
```

**蛋糕 2**

Costa 建议在第 95 行的 init 函数中将 $strict 更改为 true`Cake\Utility\ClassRegistry.php`

[请参阅 Cake Api Docs for init](http://api.cakephp.org/2.3/class-ClassRegistry.html#_init)

[ClassRegistry.php - 初始化函数](https://github.com/cakephp/cakephp/blob/c989624f8053f28d2ac37f5e84dc436965235177/lib/Cake/Utility/ClassRegistry.php#L96)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T08:15:31.740

采用

```
var $useTable = false; 
```

在您的模型定义中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-28T22:25:39.933

删除所有**缓存文件**（app/tmp下的所有文件，保留文件夹）

在大多数情况下，模型似乎以意想不到的方式运行，通常它们不包括您所做的更改，这是因为该蛋糕使用的是模型的旧缓存版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-18T20:20:02.343

呃……我们从哪里开始。首先，正如 Alexander 建议的那样，清除您的应用缓存。

如果您仍然得到相同的行为，则类和/或文件名可能有问题。

记住[规则](http://book.cakephp.org/view/23/File-and-Classname-Conventions)，对于控制器：

```
* classname: BlastsController
* filename: blasts_controller.php 
```

型号：

```
* classname: Blast
* filename: blast.php 
```

不要忘记正确[处理不规则的曲折](http://book.cakephp.org/view/47/Inflections)。

# html - 如何在 HTML 中进行图片叠加（类似于谷歌地图顶部的标记）？

> ID：100376
> 
> 赞同：22
> 
> 时间：2008-09-19T08:02:01.023
> 
> 标签：html, overlay, image

任何人都知道如何在 HTML 中进行图片叠加或重叠显示？效果将类似于标记/图标出现在谷歌地图上，用户可以指定第二张图片的坐标出现在第一张图片上。

谢谢。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-19T08:10:23.950

您可以使用`<div>`容器将内容分成多个层。因此 div 容器必须绝对定位并用 z-index 标记。例如：

```
<div style="position: absolute; z-index:100">This is in background</div> 
<div style="position: absolute; z-index:5000">This is in foreground</div> 
```

当然内容也可以包含图片等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T08:07:36.533

使用带有 z-index 属性的 DIV 标记和 CSS 绝对定位。

[http://www.w3.org/TR/CSS2/visuren.html](http://www.w3.org/TR/CSS2/visuren.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-19T08:08:18.683

[CSS层](http://www.echoecho.com/csslayers.htm)。

# eclipse - 制表符和空格转换

> ID：100388
> 
> 赞同：32
> 
> 时间：2008-09-19T08:05:18.830
> 
> 标签：eclipse, formatting

当我向/从我们的存储库提交/更新代码时，我想自动在制表符和空格之间转换以进行缩进。我找到了 Eclipse 的 AnyEdit 插件，它可以转换文件目录。一开始还不错，但是有人对如何处理这个问题有更多的经验吗？或者也许知道 Ant 脚本或其他东西？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-01-29T16:17:13.683

1.  确保您的编辑器设置为[使用空格而不是制表符](https://stackoverflow.com/a/408449/573034)。
2.  Select all text and hit `CMD` + `I` on mac or `CTRL` + `I` on windows.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-19T08:10:13.670

为什么不只使用代码格式化程序和/或清理功能？它具有为您处理这些内容的设置。您甚至可以让它在保存时自动运行。

**编辑：**正如 Peter Perháč 在评论中指出的那样，这只回答了一半的问题。我没有任何实践经验，但您可以尝试使用[Maven Eclipse 格式插件](http://mvneclipsefmt.sourceforge.net/)从 Maven 构建中进行格式化。

不幸的是，这只是 Maven，而且我知道没有轻量级的命令行格式化程序。但是如果您碰巧使用 Maven，您可以将格式目标绑定到正确的阶段，并且如果您将 Eclipse 设置为自动构建，它将在更新时格式化。

根据 SCM 工具（git、svn 等），您还可以创建一个运行构建的钩子（但它可能有点太重了）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-19T08:29:21.240

我使用 AnyEdit 插件在保存文件时自动将制表符转换为空格。我还配置了基本文本编辑器（几乎所有其他编辑器都从中派生）插入空格而不是制表符。这听起来是多余的，但它的作用是确保我不插入任何选项卡，并且我编辑的任何已经有选项卡的文件将在我保存后立即转换。

标签在源代码中没有位置。如果其他人在将制表位设置为不同值的情况下查看文件，则无论如何他们都会丢失大多数对齐/格式。

（当然，如果您有直接编辑的 Makefile，您需要确保保留它们的选项卡。但在我的项目中，如果完全使用 make，则 Makefile 派生自不同的源，例如 Makefile。 Perl 中的 PL。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-19T08:12:06.023

有点矫枉过正，只能尝试使用可以处理它的某些存储库产品，但是调用 indent 或[astyle](http://astyle.sf.net)的钩子脚本可以解决问题。它会为每个文件以相同的方式格式化每个人的代码，这取决于你如何编写钩子脚本，当然它必须是预先提交的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-12T01:38:47.483

当且仅当制表符不在行首时，您可能会通过使用制表符而不是空格来丢失对齐/格式。切勿在行内使用制表符，始终在行前使用制表符。这允许您使用编辑器调整到所需的缩进级别，而不会影响您的同事查看文件。挑战：找到一个示例，其中行前的制表符失去对齐。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-12T01:48:58.203

我使用 Kedit 来做这件事。它还可以本地转换来自 Macintosh、UNIX 和 MS-Dos 的文本文件。由于它是一个较旧的编辑器，我使用其中一个脚本来处理 unicode 文件。您可能还想看看其他一些智能编辑器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-07T07:50:33.133

I use Eclipse for Java EE developer 4.6.0 Neon. I use [http://marketplace.eclipse.org/content/anyedit-tools](http://marketplace.eclipse.org/content/anyedit-tools)

# c# - 在 ASP.NET Web 应用程序中隐藏 queryString

> ID：100411
> 
> 赞同：1
> 
> 时间：2008-09-19T08:09:49.413
> 
> 标签：c#, asp.net, web-services

我有两个 web 应用程序，一个是一个简单的身份验证站点，它可以验证登录用户并将他**重定向**到另一个站点。

因此，我必须将用户 ID（GUID）传递给第二个应用程序。目前这是通过 URL 完成的，但我想隐藏这个 id。

有谁知道如何正确地做到这一点？

[编辑]：由于 ApplicationBoundaries（2 个不同的服务器），我无法使用 Session

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T08:40:16.907

这听起来像一个棘手的情况。但是，您可以使用几个选项，但这完全取决于您的应用程序的功能。

让我们将 WebApp1 称为您的身份验证站点，并将 WebApp2 称为您的目标站点（一旦通过身份验证）。

WebApp2不能在后台调用WebApp1吗？（服务）

在应用程序之间传递这个 Guid 的问题是它通过明文，并且考虑到它是一个用户 ID，如果有人设法拦截它，他们将可以终生访问 WebApp2。无论您是在查询字符串还是表单变量中传递它，它仍然容易受到攻击。

如果不能使用 WebApp2 查询 WebApp1，则应考虑 WebApp1 创建一个过期的临时 Guid。从长远来看，这会更安全，但由于它是明文，仍然容易受到攻击。这 2 个 Web 应用程序还需要访问相同的数据存储。

最终，我认为身份验证站点应该是 WebApp2 可以使用的服务。用户应通过 WebApp2 登录，它会安全地调用 WebApp1 进行身份验证。WebApp2 然后可以管理它自己的会话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T08:55:00.333

如果你不能使用cookie，因为它是跨域的，那么用nonce加密它。

在两台服务器之间设置共享密钥/密钥；将加密的 GUID 和随机数组合发送到第二个服务器。取消加密，检查 nonce 尚未被使用（停止回复攻击），然后使用未加密的 GUID。

如果您想更加棘手，请在 app1 上有一个 Web 服务，它可以检查实际发出的随机数（此时您正走向 WSTrust 和单点登录解决方案，它通常可以解决您想要做的事情)

即使使用 cookie，由于它们很容易被编辑/伪造，您应该进行某种形式的检查。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-27T22:25:51.127

您有两个 ASP.NET Web 应用程序，其中一个应用程序只对用户进行身份验证？

这听起来像是一份工作……

# 网页服务！

在身份验证应用程序上创建一个新的 Web 服务（它们是 .asmx 扩​​展名），并添加一个接收用户和密码等的方法，并返回身份验证信息。

然后在您的第二个应用程序上导入 WSDL，并像调用方法一样调用第一个应用程序。它将简化您的代码并解决您的问题。

一个例子：

AuthenticateUserService.asmx 继续 Authentication 应用程序：

```
using System;
using System.Web;
using System.Web.Services;
using System.Web.Services.Protocols;

[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
public class AuthenticateUserService : System.Web.Services.WebService 
{   
    [WebMethod]
    public bool AuthenticateUser(string username, string passhash) 
    {
        // Fake authentication for the example
        return (username == "jon" && passhash == "SomeHashedValueOfFoobar");
    }

} 
```

设置完成后，启动您的主应用程序，然后右键单击项目并单击“添加 Web 引用”。

在身份验证应用程序上输入 asmx 的 url，Visual Studio 将发现它并创建一个代理类。

完成后，我们可以像调用主应用程序中的本地方法一样调用该方法：

```
protected void Page_Load(object sender, EventArgs e)
{
    // Now we can easily authenticate user in our code
    AuthenticateUserService authenticationProxy = 
         new AuthenticateUserService();
    bool isUserAuthenticated = 
         authenticationProxy.AuthenticateUser("jon", SomeHashMethod("foobar"));
} 
```

那么，这到底有什么作用呢？

它将客户端从身份验证过程中消除。

您当前的流程：

*   客户端向 AppA 输入凭据
*   AppA 将客户端重定向到 AppB
*   如果凭据匹配，AppB 会将客户端重定向回 AppA。

替换为 AppA 和 AppB 之间的服务器端 SOAP 调用。现在是这样的：

*   客户端在 AppA 中输入凭据
*   AppA 询问 AppB 是否良好
*   AppA 向客户端提供适当的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T08:12:09.907

通过**会话**传递 GUID ，最好的方法。

[http://www.w3schools.com/ASP/asp_sessions.asp](http://www.w3schools.com/ASP/asp_sessions.asp)

或者，因为它是 2 个不同的服务器，所以通过 POST 方法传递信息：

[http://www.w3schools.com/aspnet/aspnet_forms.asp](http://www.w3schools.com/aspnet/aspnet_forms.asp)

另一种可能性是将会话状态存储在本地服务器上的数据库中，然后从另一台服务器远程访问该数据库，以查看用户是否已成功登录并在会话时间限制内。

考虑到这一点，您也可以远程进行整个身份验证。从远程服务器远程连接到本地数据库并从那里检查登录凭据……这样您就可以在远程服务器上存储会话和/或 cookie。

**我建议反对隐藏字段命题**，因为它完全抵消了你想要做的事情！您试图在 URL 中隐藏 GUID，但在 HTML 代码中发布相同的信息！这不是这样做的方法。

最佳选择是数据库选项，或者如果不可能，则使用 HTTP POST。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T08:13:37.580

使用会话变量或 HTTP POST 而不是 HTTP GET。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T08:15:25.373

如果服务器有一个共同的域名，您可以使用 cookie。

编辑：Cookies 只会在视觉上隐藏 ID，它仍然可以访问。与隐藏字段或使用 POST 而不是 GET 相同。因此，如果 ID 是机密的，并且您希望避免通过未加密的网络发送它，则需要一种不同的方法。

一种解决方案可能是使用服务器共享的密钥对身份验证服务器上的 ID 进行加密。另一种解决方案可能是在身份验证服务器上生成一个随机 GUID，然后让身份验证服务器直接通知其他服务器（通过 SSL）该 GUID 对应的 ID。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T08:17:19.520

而不是通过查询字符串传递它，您应该创建一个带有其值的隐藏表单字段，然后发布到您的第二页，然后可以获取发布的值，并且它将对用户隐藏。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-24T09:19:29.240

进行会话管理或使用上述帖子中所述的 HTTP Post。

# open-source - 开源语法高亮工具？

> ID：100415
> 
> 赞同：3
> 
> 时间：2008-09-19T08:10:14.810
> 
> 标签：open-source, syntax-highlighting

我正在寻找一个开源、跨平台（至少是 Windows 和 Linux）命令行工具来获取一些代码（C++，但多种语言会很不错），并吐出该代码的有效 XHTML 表示，并带有语法突出显示包括。

理想情况下，XHTML 应该只用不同的类包装代码`<span>`和`<div>`标签，这样我就可以提供 CSS 代码并更改颜色，但这是一个可选的附加功能。

有谁知道这样的应用程序？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T23:51:33.680

我可以推荐[Pygments](http://pygments.org/)。它易于使用并支持多种语言。它做你想做的事，即将代码包装在`<span>`标签中：

```
from pygments import highlight
from pygments.lexers import PythonLexer
from pygments.formatters import HtmlFormatter

code = 'print "Hello World"'
print highlight(code, PythonLexer(), HtmlFormatter()) 
```

给

```
<div class="highlight">
<pre><span class="k">print</span> <span class="s">&quot;Hello World&quot;</span></pre>
</div> 
```

然后您可以使用提供的样式表之一制作您自己的样式表。

您也可以通过它的`pygmentize`脚本调用它。该脚本可以以不同的方式格式化输出：HTML、LaTeX、ANSI 颜色终端输出。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T08:15:04.313

[Vim](http://www.vim.org/)可以将它突出显示的任何代码保存为“彩色”HTML（它可以在多个平台上运行）。也有[GNU 亮点](http://www.gnu.org/software/src-highlite/)。还有很多其他的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-19T08:16:44.780

有一个非常好的，由 XML 驱动，快速且开源：[http://sourceforge.net/projects/colorer/](http://sourceforge.net/projects/colorer/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T08:26:17.843

我不记得[GeSHi](http://qbnz.com/highlighter/)是否有命令行程序，但即使没有，也应该不难搞定。它在获取代码和生成漂亮的彩色 HTML/XHTML 方面做得非常好，甚至带有行号（或每个 X 行号，甚至）和其他有用的功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T08:46:42.897

[Enscript](http://www.gnu.org/software/enscript/)看起来像您所要求的：

1.  从 ascii 文件中吐出 HTML（或 PS，或 RTF）
2.  它包括多种编程语言的“漂亮打印”（语言敏感代码突出显示）功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T08:16:22.237

不确定这会有多大帮助，但我的团队使用 doxygen 来生成文档，这恰好在我们的代码视图上提供颜色语法突出显示以及附带的好处。从来没有真正需要它，但它确实做到了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T08:32:29.110

如果您可以使用 ruby​​，您需要[coderay](http://coderay.rubychan.de/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-24T21:41:32.720

我会将[我自己的一个添加到列表中](http://www.shrinkrays.net/tools/csharp-syntax-highlighter.aspx)，它为 C# 着色，但可以适用于 C、C++ 和 Java。它默认生成内联样式和一个 pre 标记。

The source is there in C#, you'll need to grab mono/monodevelop and compile it as as a console app, so it's not shrink wrapped in that respect.

# sql-server - 将列添加到表时强制使用默认值 - SQL Server

> ID：100416
> 
> 赞同：5
> 
> 时间：2008-09-19T08:10:17.010
> 
> 标签：sql-server, database

在 SQL Server 2000/2005 中，

**是否可以在向表中添加新列而不**在新列上使用 NOT NULL时强制将默认值写入现有行？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-19T08:50:29.627

你需要两个陈述。首先创建不为空的列。然后将非空约束更改为可空

```
alter table mytable add mycolumn varchar(10) not null default ('a value')
alter table mytable alter column mycolumn varchar(10) null 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T16:17:32.867

我理解你的问题，但你是说对于未来的记录，NULL（未知、不确定或任何你的语义）是可以接受的（但如果它在插入中被保留，则会有一个默认值），但对于所有现有数据，您将继续并为其分配默认值。

我将不得不仔细研究这种情况，并询问为什么您甚至要在未来的记录中允许 NULL - 鉴于没有任何历史记录会有它，并且未来记录存在默认设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T08:49:12.703

我对此表示怀疑。

[http://msdn.microsoft.com/en-us/library/ms190273(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms190273(SQL.90).aspx)

微软推荐的做法如下（取自上面的url）

```
UPDATE MyTable SET NullCol = N'some_value' WHERE NullCol IS NULL
ALTER TABLE MyTable ALTER COLUMN NullCOl NVARCHAR(20) NOT NULL 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-26T04:56:52.227

`ALTER TABLE {TABLENAME} ADD {COLUMNNAME} {TYPE} {NULL|NOT NULL} CONSTRAINT {CONSTRAINT_NAME} DEFAULT {DEFAULT_VALUE} [**WITH VALUES]**`

**WITH VALUES**可用于将默认值存储在表中每个现有行的新列中。

有关 MSDN 链接的更多详细信息。 [https://msdn.microsoft.com/en-in/library/ms190273.aspx](https://msdn.microsoft.com/en-in/library/ms190273.aspx)

# visual-studio - Hidden Features of Visual Studio (2005-2010)?

> ID：100420
> 
> 赞同：182
> 
> 时间：2008-09-19T08:10:54.997
> 
> 标签：visual-studio, text-editor, hidden-features

Visual Studio is such a massively big product that even after years of working with it I sometimes stumble upon a new/better way to do things or things I didn't even know were possible.

For instance-

*   `Crtl` + `R`, `Ctrl` + `W` to show white spaces. Essential for editing Python build scripts.

*   Under `"HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\8.0\Text Editor"` Create a String called [Guides](https://stackoverflow.com/questions/84209/vertical-line-after-a-certain-amount-characters-in-visual-studio) with the value "RGB(255,0,0), 80" to have a red line at column 80 in the text editor.

What other hidden features have you stumbled upon?

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2008-09-19T08:35:50.660

按住 ALT 进行选择 - 选择一个正方形的文本而不是整行。

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2008-09-19T14:17:29.457

追踪点！

在一行代码上放置一个断点。调出断点窗口并右键单击新断点。选择“点击时...”。通过勾选“打印消息”复选框，Visual Studio 将在每次执行代码行时向调试输出打印一条消息，而不是（或同时）中断它。您还可以让它在通过该行时执行宏。

* * *

## 回答 #3

> 赞同：91
> 
> 时间：2008-09-19T08:58:40.497

您可以将代码拖到工具箱中。试试看！

* * *

## 回答 #4

> 赞同：79
> 
> 时间：2008-09-24T19:36:02.160

单击一个标识符（类名、变量等），然后单击`F12`“转到定义”。我总是很惊讶有多少人使用较慢的右键单击->“转到定义”方法来观看代码。

**编辑：**然后您可以使用`Ctrl`+`-`跳回原来的位置。

* * *

## 回答 #5

> 赞同：57
> 
> 时间：2008-09-19T08:28:56.903

CTRL+SHIFT+V 将循环浏览剪贴板，Visual Studio 保留副本历史记录。

* * *

## 回答 #6

> 赞同：52
> 
> 时间：2008-09-19T08:18:12.357

Sara Ford covers lots of lovely tips: [http://blogs.msdn.com/saraford/archive/tags/Visual+Studio+2008+Tip+of+the+Day/default.aspx](http://blogs.msdn.com/saraford/archive/tags/Visual+Studio+2008+Tip+of+the+Day/default.aspx)

But some of my favourites are Code Snippets, `Ctrl` + `.` to add a `using` <Namespace> or generate a method stub. I can't live without that.

Check out a great list in the Visual Studio 2008 C# Keybinding poster: [http://www.microsoft.com/downloadS/details.aspx?familyid=E5F902A8-5BB5-4CC6-907E-472809749973&displaylang=en](http://www.microsoft.com/downloadS/details.aspx?familyid=E5F902A8-5BB5-4CC6-907E-472809749973&displaylang=en)

* * *

## 回答 #7

> 赞同：49
> 
> 时间：2008-09-19T08:16:03.347

```
CTRL-K, CTRL-D 
```

Reformat Document!
*This is under the VB keybindings, not sure about C#*

* * *

## 回答 #8

> 赞同：43
> 
> 时间：2008-09-19T08:25:34.867

您在快速监视或监视窗口中调试数组多少次，而只有 Visual Studio 向您显示第一个元素？将“,N”添加到定义的末尾以使工作室也向您显示下 N 个项目。IE "this->m_myArray" 变为 "this->m_array,5"。

* * *

## 回答 #9

> 赞同：41
> 
> 时间：2008-09-19T08:23:59.160

增量搜索：在打开源文档时，点击 (CTRL + I) 并键入您要搜索的单词，您可以再次点击 (CTRL + I) 以查看与您的输入匹配的单词。

* * *

## 回答 #10

> 赞同：37
> 
> 时间：2008-10-07T00:07:32.927

您可以在监视窗口中使用以下代码。

```
@err - display last error
@err,hr - display last error as an HRESULT
@exception - display current exception 
```

* * *

## 回答 #11

> 赞同：35
> 
> 时间：2008-09-24T20:48:27.230

*   **Ctrl-K, Ctrl-C**以**//**开头的文本块注释
*   **Ctrl-K、Ctrl-U**取消注释以**//**开头的文本块

没有它就活不下去！:)

* * *

## 回答 #12

> 赞同：25
> 
> 时间：2008-10-10T14:27:48.920

阻止调试器进入琐碎的功能。

当您在调试器中单步执行代码时，您可能会花费大量时间来单步执行您不特别感兴趣的函数，例如 GetID() 或 std::vector<>()，选择一个 C++ 示例。您可以使用注册表使调试器忽略这些。

对于 Visual Studio 2005，您必须转到 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\8.0\NativeDE\StepOver 并为您希望排除的每个函数或一组函数添加包含正则表达式的字符串值；例如

std::vector.*::.*
TextBox::GetID

您还可以为个别例外覆盖这些。例如，假设您确实想进入向量类的析构函数：

std::vector.*::\~.*=StepInto

[您可以在http://blogs.msdn.com/andypennell/archive/2004/02/06/69004.aspx](http://blogs.msdn.com/andypennell/archive/2004/02/06/69004.aspx)找到其他版本的 Visual Studio 的详细信息

* * *

## 回答 #13

> 赞同：23
> 
> 时间：2009-02-08T09:07:58.097

**TAB 键功能**。

1.  如果您知道片段键名称，请编写并单击双 Tab。例如：写

    `foreach`

然后点击tab键两次

```
foreach (object var in collection_to_loop)
{

} 
```

2.如果你写任何事件，写在这里

```
 Button btn = new Button();
        btn.Click += 
```

然后点击tab键两次

```
private void Form1_Load(object sender, EventArgs e)
{
        Button btn = new Button();
        btn.Click += new EventHandler(btn_Click);     
}    
void btn_Click(object sender, EventArgs e)
{
        throw new Exception("The method or operation is not implemented.");
} 
```

btn_Click 函数自动写入

3.  在 XAML 编辑器中，编写任何事件。例如：

`MouseLeftButtonDown`然后单击选项卡，然后在创建的代码部分方法中
`MouseLeftButtonDown=""`再次单击选项卡 。`MouseLeftButtonDown="Button_MouseLeftButtonDown"``Button_MouseLeftButtonDown`

* * *

## 回答 #14

> 赞同：23
> 
> 时间：2008-09-19T08:20:48.950

**Ctrl-F10**: run to cursor during debugging. Took me ages to find this, and I use it all the time;

**Ctrl-E, Ctrl-D**: apply standard formatting (which you can define).

* * *

## 回答 #15

> 赞同：21
> 
> 时间：2008-08-19T10:24:53.500

Sara Ford 垄断了这个市场。

[http://blogs.msdn.com/saraford/default.aspx](http://blogs.msdn.com/saraford/default.aspx)

更多 Visual Studio 提示和技巧，你无法动摇。

其他一些：

*   Visual Studio 2005 和 2008 的 3 个月试用版功能齐全，可以通过在打开 VS 之前将系统时钟调回来[无限期（永久）使用。](http://www.codingthewheel.com/archives/microsoft-vs-the-system-clock)然后，当 VS 打开时，再次将系统时钟调快，这样您的日期时间就不会搞砸了。
*   但这确实是盗版，我不推荐，尤其是当任何拥有 .edu 地址的人都可以通过[Microsoft Dreamspark](https://downloads.channel8.msdn.com/)获得功能齐全的 VS2008 专业版时。
*   您可以使用 Visual Studio 打开第 3 方可执行文件，并浏览存储在其中的嵌入式资源（对话框、字符串表、图像等）。
*   调试可视化工具并不完全是一个“隐藏”功能，但它们在某种程度上被忽视了，而且非常有用，因为除了使用提供的可视化工具之外，您还可以为特定的数据集[滚动自己的可视化工具。](http://nayyeri.net/blog/how-to-write-a-visual-studio-visualizer/)
*   调试器的“设置指令指针”或“设置下一条语句”命令。
*   条件断点（如 KiwiBastard 所述）。
*   您不仅可以使用 Quickwatch 等来评估变量的值，还可以评估围绕该变量的运行时表达式。

* * *

## 回答 #16

> 赞同：21
> 
> 时间：2008-10-15T04:20:01.607

[T4（文本模板转换工具包）](http://msdn.microsoft.com/en-us/library/bb126445.aspx)。T4 是直接内置于 Visual Studio 中的代码生成器

* * *

## 回答 #17

> 赞同：17
> 
> 时间：2009-03-06T20:00:52.957

**自定义 IntelliSense 下拉高度**，例如显示 50 个项目而不是默认的 IMO 小得离谱 (8)。

（为此，只需在下次看到下拉菜单时调整它的大小，Visual Studio 会在下次打开下拉菜单时记住您选择的大小。）

* * *

## 回答 #18

> 赞同：16
> 
> 时间：2008-09-24T06:38:10.423

今天发现：

```
Ctrl + . 
```

调出上下文菜单以进行重构（然后可以通过您刚刚重命名的类/方法/属性的带下划线的最后一个字母访问该菜单 - 将鼠标悬停在菜单上或“Ctrl”+“。”）

* * *

## 回答 #19

> 赞同：14
> 
> 时间：2008-08-19T07:08:00.527

很多人不知道或不充分地使用调试器 - IE 只是使用它来停止代码，但右键单击红色圆圈，还有更多选项，例如条件中断、中断运行代码。

您还可以使用调试器在运行时更改变量值，这是一个很棒的功能 - 保存重新运行代码以修复愚蠢的逻辑错误等。

* * *

## 回答 #20

> 赞同：13
> 
> 时间：2009-06-16T17:17:15.137

行转置，Shift-Alt-T
交换两行（当前行和下一行）并将光标移动到下一行。我就喜欢。我什至编写了一个宏，它再次将位置更改了一行，执行了行转置并再次更改了行位置，所以这一切看起来就像我将当前行与前一行交换（反向行转置）。

字转置，Shift-Ctrl-T

* * *

## 回答 #21

> 赞同：11
> 
> 时间：2009-03-05T10:27:41.080

**FormsDesigner 中的**文档大纲(** **CTRL + ALT + T** )**

 **快速控制重命名、排序等等！

* * *

## 回答 #22

> 赞同：11
> 
> 时间：2008-09-19T09:44:50.027

开发 C++ 时，Ctrl-F7 仅编译当前文件。

* * *

## 回答 #23

> 赞同：11
> 
> 时间：2008-10-03T23:31:59.740

使用解决方案资源管理器自动同步当前文件。所以不必查看文件在项目结构中的位置

工具 -> 选项 -> 项目和解决方案 -> “在解决方案资源管理器中跟踪活动项目”

**编辑：**如果这对您来说太烦人了，那么您可以使用[Dan Vanderboom 的](http://dvanderboom.wordpress.com/2008/03/21/visual-studio-macro-track-item-in-solution-explorer-on-demand/)宏通过击键按需调用此功能。

（注：取自 Jerry 下面的评论）。

* * *

## 回答 #24

> 赞同：9
> 
> 时间：2008-09-19T08:38:41.217

Ctrl-Minus，Ctrl-Plus，在您最近去过的地方前后导航（不过，只打开文件）。

* * *

## 回答 #25

> 赞同：9
> 
> 时间：2008-09-19T08:17:41.203

I'm not sure if it's "hidden", but not many people know about it -- [pseudoregisters](http://www.codeproject.com/KB/debug/pseudoregister.aspx). Comes very handy when debugging, I've @ERR, hr in my watch window all the time.

* * *

## 回答 #26

> 赞同：9
> 
> 时间：2009-08-31T04:46:40.727

这是我学到的东西（对于 C#）：

您可以通过按 Control + ] 将光标从右大括号移动到左大括号。

我在一个受此骗局的 SO 主题上学到了这一点：

[Visual Studio .NET 调试器的“隐藏秘密”？](https://stackoverflow.com/questions/131263/hidden-secrets-of-the-visual-studio-net-debugger)

* * *

## 回答 #27

> 赞同：9
> 
> 时间：2009-08-31T04:48:14.750

我不经常使用它，但我确实喜欢：

```
ctrl-alt + mouse select 
```

在矩形块中选择，以“块”边界。

如评论中所述，

```
alt + mouse select 
```

只做一个普通的矩形块。

* * *

## 回答 #28

> 赞同：8
> 
> 时间：2008-09-24T20:54:13.533

CTRL + Shift + U -> 大写突出显示部分。CTRL + U -> 小写突出显示的部分非常适合让我的 SQL 语句在将它们放入字符串查询时看起来恰到好处。

对于您在网上找到的所有内容都大写的代码也很有用。

* * *

## 回答 #29

> 赞同：8
> 
> 时间：2008-11-09T20:04:51.087

要将任何数据块显示为 n 字节“数组”，请在 Visual Studio 的 QuickWatch 窗口中使用以下语法：

```
variable, n 
```

例如，要查看名为`foo`256 字节数组的变量，请在 QuickWatch 窗口中输入以下表达式：

```
foo, 256 
```

这在查看非空终止的字符串或只能通过指针访问的数据时特别有用。您可以使用 Visual Studio 的 Memory 窗口来获得类似的结果，但使用 QuickWatch 窗口通常更方便快速检查。

* * *

## 回答 #30

> 赞同：8
> 
> 时间：2009-11-10T18:31:05.533

鼠标中键 单击编辑器选项卡关闭选项卡。

* * *

## 回答 #31

> 赞同：7
> 
> 时间：2008-09-02T06:35:40.610

CTRL-D 然后输入“>of”，然后输入文件名。如果标准工具栏已启动，则 crtl-d 将您放入查找组合框，现在您的解决方案中有一个下拉菜单，其中包含与您键入的文件名开头相匹配的文件。选择一个，它会打开它。对于具有大量目录的大型解决方案，这种打开文件对话框的替代方案非常棒。

* * *

## 回答 #32

> 赞同：7
> 
> 时间：2010-07-01T11:57:42.743

`Ctrl`+`Delete`删除整个单词（转发）

`Ctrl`+`Backspace`删除整个单词（向后）

以下是众所周知的，但我说它尚未上市是不是错了？

`Ctrl`++在方法调用的`Shift`括号`Space`内为您提供参数信息。

* * *

## 回答 #33

> 赞同：6
> 
> 时间：2009-08-13T08:51:37.353

.NET 调试器允许您为对象提供标识符，并在会话后期通过这些标识符引用它们。为此，您可以在 Autos/Locals/Watch 窗口或工具提示中右键单击引用对象的变量（或表达式），然后选择“创建对象 ID”。ID 是连续的整数，从 1 开始，并以“#”为后缀 - 例如`1#`将是您创建的第一个 ID。

创建 ID 后，如果对象与给定 ID 相关联，则会显示在括号中。

您可以`1#`在通常可以使用表达式的任何地方使用 ID 引用对象 - 在 Watch 窗口中，在条件断点的条件下，等等。当您只想在某个特定对象的方法上设置断点时，这是最方便的 - 如果您可以首先跟踪对象的创建，或者引用此特定对象的其他地方，您只需为其创建 ID，然后设置具有条件的新断点，例如`this==1#`.

* * *

## 回答 #34

> 赞同：6
> 
> 时间：2008-09-19T08:23:55.370

在调试器中将文本选择拖放到 Watch 窗口。

* * *

## 回答 #35

> 赞同：5
> 
> 时间：2010-05-20T13:27:52.983

刚才无意中找到了这个。当您在一行的任意位置并按`Ctrl`+`Enter`时，它将在当前行**上方**插入一个新行并将光标移动到那里。

此外，如果您按`Ctrl`+ `Shift`+ `Enter`，它将在当前行**下方**插入一个新行并将光标移动到那里（类似于`End`, `Enter`）

* * *

## 回答 #36

> 赞同：5
> 
> 时间：2010-07-07T14:00:38.130

在调试过程中，选择一个标识符或表达式并将其拖动到监视窗口。
节拍必须从头开始编写:)

* * *

## 回答 #37

> 赞同：4
> 
> 时间：2008-08-19T10:47:08.430

*   内存窗口，如果您正在做低级的事情，非常有用。
*   Control + K , Control + F - 格式选择 - 非常适合快速使代码整洁
*   地区，有人爱他们，有人恨他们，大多数人甚至不知道他们的存在
*   在执行期间更改调试窗口中的变量
*   跟踪点
*   条件断点
*   按住 Alt 并拖动以选择“矩形”。
*   Control+B 用于断点，在函数处中断
*   Control+I 用于增量搜索，F3 用于迭代

* * *

## 回答 #38

> 赞同：4
> 
> 时间：2008-09-24T20:50:16.977

*   **Ctrl-K, Ctrl-C**以**//**开头的文本块注释
*   **Ctrl-K、Ctrl-U**取消注释以**//**开头的文本块

没有它就活不下去！:)

* * *

## 回答 #39

> 赞同：4
> 
> 时间：2008-09-19T09:09:21.377

按 F8 键循环浏览搜索结果。（Shift+F8 反向）

按 F12 转到变量的定义。

Shift + alt + 箭头键 = 块选择！

* * *

## 回答 #40

> 赞同：4
> 
> 时间：2009-09-14T15:12:39.807

在监视窗口中，即使您没有变量来保存它，也可以通过添加监视来查看当前异常`$exception`

* * *

## 回答 #41

> 赞同：4
> 
> 时间：2010-07-06T10:10:02.140

曾经想在您当前查看的文件中查找功能但有太多成员无法浏览？需要过滤器吗？然后，导航框就是您所需要的。您可以通过 Ctrl-,（逗号）激活它。

* * *

## 回答 #42

> 赞同：3
> 
> 时间：2010-01-28T18:16:24.637

调试器中的伪变量：http: [//msdn.microsoft.com/en-us/library/ms164891.aspx](http://msdn.microsoft.com/en-us/library/ms164891.aspx)

`$exception`: 避免需要给你的异常名称（并导致变量未引用警告）。

`$user`：告诉您哪个用户正在运行应用程序...在尝试诊断权限问题时有时很有用。

* * *

## 回答 #43

> 赞同：3
> 
> 时间：2009-06-19T03:17:33.540

您可以向下拖动垂直滚动条上方的小灰色框，将窗口拆分为同一文件的两个视图，可以独立滚动 - 如果您要比较同一文件的两个部分，那就太好了。

* * *

## 回答 #44

> 赞同：3
> 
> 时间：2008-09-24T21:00:51.707

有[一篇](http://blogs.msdn.com/vbteam/archive/2008/09/22/did-you-know-300-visual-studio-tips-tricks-lisa-feigenbaum.aspx)关于这个的文章。这似乎是一个漫长的集合。

* * *

## 回答 #45

> 赞同：3
> 
> 时间：2010-06-15T19:47:45.257

通过右键单击文档的选项卡并选择“关闭除此之外的所有文档”来关闭除您所在文档之外的所有文档。您也可以在许多其他 IDE 和浏览器中执行此操作。不是一个大功能，但我发现我每天使用它 10 次以上。这个功能对我隐藏了很多年。我应该将它映射到键盘快捷键：p

* * *

## 回答 #46

> 赞同：3
> 
> 时间：2008-09-19T08:59:40.590

Shift+Alt+F10 调出内置的重构菜单。非常适合从接口添加方法存根，并为特定类自动添加 Using 语句。

* * *

## 回答 #47

> 赞同：3
> 
> 时间：2009-08-31T04:55:57.730

我不知道这是多么“隐藏”，但一些新人可能不知道*coniditonal breakpoints*。

设置断点，然后右键单击它，然后选择`Condition`，然后输入如下表达式：

```
(b == 0) 
```

只有当这是真的时它才会触发。在尝试调试循环的某个阶段时非常有用。

* * *

## 回答 #48

> 赞同：3
> 
> 时间：2010-07-31T02:14:12.787

Ctrl+Tab - 在 Visual Studio 2005 和 2008 中打开的选项卡/窗口之间切换。

有点像 Windows 中的 Alt+Tab，为当前打开的 VS 文件打开一个小框。

这是一个示例屏幕截图：

[替代文字 http://lh3.ggpht.com/_FWrysR9YI18/TFOGxnX9ShI/AAAAAAAAAQI/a-ByCRMmrpw/ctrltab.gif](http://lh3.ggpht.com/_FWrysR9YI18/TFOGxnX9ShI/AAAAAAAAAQI/a-ByCRMmrpw/ctrltab.gif)

* * *

## 回答 #49

> 赞同：3
> 
> 时间：2009-06-19T11:56:18.313

查看, 其他窗口, 对象测试台

对象测试台可用于在设计时执行代码。

您可以在 Class View 中右键单击一个类型，单击 Create Instance，然后选择一个构造函数。然后，您可以为其参数提供值（如果有），并且该实例将显示在 Object Test Bench 中。

您还可以通过右键单击类型并单击调用静态方法来调用静态方法。

在 Object Test Bench 中，您可以右键单击一个对象来调用方法，您可以将鼠标悬停在它上面并查看它的结构（就像调试时一样）。您也可以在设计时在即时窗口中分配这些变量并与之交互。

此功能在编写库时很有用。请注意，要使用它，您的解决方案必须先编译。

* * *

## 回答 #50

> 赞同：3
> 
> 时间：2009-08-31T04:45:41.493

[动态 XSLT 智能感知](http://www.tkachenko.com/blog/archives/000740.html)

> 一个鲜为人知的事实是，Visual Studio 2008 确实支持真正的 XSLT 智能感知——不是基于静态 XSLT 模式的智能感知，而是真正的动态智能感知，能够自动完成模板名称、模式、参数/变量名称、属性集名称、命名空间前缀等。

对于我喜欢的所有版本的 VS

**Ctrl + Shift + V**

用于在剪贴板循环中复制数据。

* * *

## 回答 #51

> 赞同：3
> 
> 时间：2009-08-31T05:31:53.680

**[Resharper](http://www.jetbrains.com/resharper/)**插件的存在。它使使用 Visual Stupidio 变得不那么痛苦:)

这并不是一个真正的隐藏功能，但值得一提的是，它带有大量这些技巧和热键。

* * *

## 回答 #52

> 赞同：3
> 
> 时间：2009-11-06T19:43:33.727

我很惊讶还没有人提到这一点。我发现能力记录和回放一系列动作有时非常非常有用。就像我对文本文件中的几行应用一些重复操作一样。

例如

Ctrl+Shift+R（开始录制宏）

执行一系列击键

Ctrl+Shift+R（停止录制宏）

之后....

Ctrl+Shift+P（回放击键）

这种方法非常适合短时间的一次性操作。如果它涉及更多或需要不止一次，我会写一个脚本。

* * *

## 回答 #53

> 赞同：2
> 
> 时间：2009-08-13T08:30:29.363

我刚刚发现的一个。处理 COM 时，可以使用名为 errlook.exe 的工具从神秘的十六进制错误编号中查找简短消息。

有用的工具位于您的 VS\Common7\Tools 目录中。

* * *

## 回答 #54

> 赞同：2
> 
> 时间：2009-04-25T08:40:34.530

Ctrl-T 交换最后两个字母。例如，“swithc”->“switch”。

* * *

## 回答 #55

> 赞同：2
> 
> 时间：2008-08-19T06:00:46.497

我不能没有的最重要的功能是 Visual Studio 2008。:P

* * *

## 回答 #56

> 赞同：2
> 
> 时间：2008-08-19T06:10:47.507

调试器 :-) 以英里击败记事本。

* * *

## 回答 #57

> 赞同：2
> 
> 时间：2009-02-12T11:47:42.430

Ctrl+L 删除当前选定的行。这是一个很棒的节省时间（当然如果负责任地使用！！！）

* * *

## 回答 #58

> 赞同：2
> 
> 时间：2010-07-27T19:06:02.593

我最喜欢的功能是

1.  书签功能。您可以在代码中添加/删除书签（有点像断点），您可以使用下一个/上一个书签直接在它们之间导航。如果您同时在两个地方进行更改，并且想要经常在两者之间进行交换，这将非常有用。
2.  评论/取消评论功能。`Ctrl+E , Ctrl+C/U`用于 C# 设置。
3.  行的增加/减少缩进。（默认情况下仅适用于 VC。要分配给 C#，请转到工具 -> 选项 -> 常规 -> 键盘并更改`Edit.IncreaseLineIndent/Edit.DecreaseLineIndent`TextEditor）

PS：我想知道如何通过键盘导航到成员下拉列表（位于选项卡列表下方）。

* * *

## 回答 #59

> 赞同：2
> 
> 时间：2009-02-12T13:07:00.007

**Ctrl-M + Ctrl-L**切换全部折叠 - 全部展开

* * *

## 回答 #60

> 赞同：2
> 
> 时间：2009-06-19T03:09:58.797

Ctrl+Shift+L 删除当前行（不剪切到剪贴板）

* * *

## 回答 #61

> 赞同：2
> 
> 时间：2009-06-19T11:44:23.000

> 查看，代码定义窗口。

[代码定义窗口](http://msdn.microsoft.com/en-us/library/f5yx24a6.aspx)显示当前选定标识符的定义（如果它在您的解决方案中，它将显示您的来源；否则，它将提取元数据，如右键单击、转到定义）

* * *

## 回答 #62

> 赞同：2
> 
> 时间：2009-06-19T11:50:48.603

我看到我们很多人都在发布快捷方式。我已经打印了这张海报，学习这些捷径很有帮助 - 现在我很少看海报，因为我已经学会了大部分 :)

VS海报链接：

[http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=c15d210d-a926-46a8-a586-31f8a2e576fe](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=c15d210d-a926-46a8-a586-31f8a2e576fe)

我最喜欢的是重构（CTRL-R + 东西）

* * *

## 回答 #63

> 赞同：2
> 
> 时间：2008-09-19T08:55:01.817

`control + alt + f4`我总是在选项>环境>键盘中映射到documents.CloseAllWindows。

比使用鼠标更直观一些。

* * *

## 回答 #64

> 赞同：2
> 
> 时间：2008-09-19T09:13:22.583

我认为能够在服务器资源管理器中右键单击存储过程并调试..

* * *

## 回答 #65

> 赞同：2
> 
> 时间：2009-08-31T04:59:22.607

MSDN 上有这个博客，里面有一些不错的提示和技巧

[http://blogs.msdn.com/saraford/archive/tags/Visual+Studio+2008+Tip+of+the+Day/default.aspx](http://blogs.msdn.com/saraford/archive/tags/Visual+Studio+2008+Tip+of+the+Day/default.aspx)

* * *

## 回答 #66

> 赞同：2
> 
> 时间：2008-09-24T06:00:44.430

从调试器中对象扩展属性的监视窗口复制粘贴到 Excel 中将保留表格格式并在调试会话结束后保留​​数据。

* * *

## 回答 #67

> 赞同：2
> 
> 时间：2008-12-11T22:47:03.377

这是我的 aspx/aspx.cs 翻转器的宏源。它在 2005 年有效，但在 08 年可能会出现问题。我不确定...这是从我的其他 cpp/h 脚蹼中获取的，因此可能需要进行一些清理以使其达到最佳状态。我编写宏没有报酬，所以当我需要宏时，我必须尽快完成它们。

```
 Sub OpenASPOrCS()
    'DESCRIPTION: Open .aspx file if in .cs file, open .cs file if in .aspx file
    On Error Resume Next

    ' Get current doc path
    Dim FullName
    FullName = LCase(ActiveDocument.FullName)
    If FullName = "" Then
        MsgBox("Error, not a .cs or asp file!")
        Exit Sub
    End If

    ' Get current doc name
    Dim DocName
    DocName = ActiveDocument.Name

    Dim IsCSFile
    IsCSFile = False
    Dim fn
    Dim dn
    If (Right(FullName, 3) = ".cs") Then
        fn = Left(FullName, Len(FullName) - 3)
        dn = Left(DocName, Len(DocName) - 3)
        IsCSFile = True
    ElseIf ((Right(FullName, 5) = ".aspx") Or (Right(FullName, 5) = ".ascx")) Then
        fn = FullName + ".cs"
        dn = DocName + ".cs"
    Else
        MsgBox("Error, not a .cs, or an asp file!")
        Exit Sub
    End If

    Dim doc As EnvDTE.Documents

    DTE.ItemOperations.OpenFile(fn)
    doc.DTE.ItemOperations.OpenFile(fn)

    If Err.Number = 0 Then
        Exit Sub
    End If

    ' First check to see if the file is already open and activate it
    For Each doc In DTE.Documents()
        If doc.Name = dn Then
            doc.Active = True
            Exit Sub
        End If
    Next

End Sub 
```

* * *

## 回答 #68

> 赞同：1
> 
> 时间：2009-02-04T20:44:29.927

“文件打开”对话框中的“打开”按钮旁边有一个向下箭头。单击它，您将获得包含二进制编辑器的“打开方式”选项。作为一个系统型的人，我觉得它很有价值，但我的大多数同事在我展示给他们之前都不知道它。

* * *

## 回答 #69

> 赞同：1
> 
> 时间：2010-02-27T09:10:43.887

How about `Ctrl` + `C` to copy the current line to the clipboard without doing any range selection. This is sooooo... simple and useful.

* * *

## 回答 #70

> 赞同：1
> 
> 时间：2009-06-19T12:45:42.037

我不知道大多数人认为它们有多不为人知，但我不认为很多人使用片段。

我不久前发现了它们，然后发现它们可以通过编辑 Visual Studio Program Files 目录中的 xml 来定制。它们使快速添加大量代码变得非常容易。

此外，为了节省使用片段时的时间，请确保您点击两次选项卡，而不是尝试通过右键菜单执行所有操作。

* * *

## 回答 #71

> 赞同：1
> 
> 时间：2008-09-20T07:23:14.827

我最好的功能是我必须自己制作的。它是一个 cpp/h 脚蹼。如果您正在查看 .h 文件并点击此宏（或其键盘快捷键），它将打开 cpp 文件，反之亦然。

如果有人需要，我可以提供来源。

* * *

## 回答 #72

> 赞同：1
> 
> 时间：2009-02-12T13:28:31.750

回复：阻止调试器进入琐碎的功能。

在 C# 中，您还可以向方法添加属性 [DebuggerStepThrough]（使用 System.Diagnostics）。具有讽刺意味的是，这会导致调试器不逐步执行该方法。

* * *

## 回答 #73

> 赞同：1
> 
> 时间：2009-05-08T21:43:26.073

[Visual Studio 2008 for JavaScript IntelliSense 的引用标签](http://blogs.msdn.com/webdevtools/archive/2007/11/06/jscript-intellisense-a-reference-for-the-reference-tag.aspx)是一个全新的隐藏功能。尤其是[jQuery IntelliSense](http://blogs.msdn.com/webdevtools/archive/2008/10/28/rich-intellisense-for-jquery.aspx)是毁灭性的！

* * *

## 回答 #74

> 赞同：1
> 
> 时间：2008-09-19T17:09:35.003

不完全是一个隐藏的功能，但我做的一件事是在我的“开始调试”按钮旁边添加一个“不调试开始”按钮。只需单击工具栏右端的向下箭头。然后选择“添加或删除按钮”。然后自定义。在命令选项卡中选择调试类别。找到 Start without Debugging 命令并将其拖到工具栏上您想要的位置。

* * *

## 回答 #75

> 赞同：1
> 
> 时间：2010-05-20T13:41:11.550

`Ctrl`++`Shift`调`F`出“搜索解决方案”对话框并以一种很好的导航方式列出所有结果，而不是访问每个结果。它不仅更易于使用，而且也很有用，因为它不会篡改您在常规搜索中使用的搜索范围默认值。

* * *

## 回答 #76

> 赞同：1
> 
> 时间：2008-09-23T14:25:21.887

[在皮肤文件中启用智能感知](http://vladimir.bychkov.info/blog/PermaLink,guid,be76b3bf-c524-456c-9c8f-a2584924aa32.aspx)

1.  转到工具-> 选项菜单。
2.  从选项对话框左侧的树中选择文本编辑器 -> 文件扩展。
3.  在扩展文本框中键入皮肤。
4.  从编辑器下拉列表中选择用户控件编辑器。
5.  单击添加，然后单击确定关闭对话框并重新打开您的皮肤文件。

* * *

## 回答 #77

> 赞同：1
> 
> 时间：2009-08-31T06:33:46.660

鼠标左键单击将光标重置到指针当前悬停的位置。对于在 Visual Studio 中导航非常有用。

* * *

## 回答 #78

> 赞同：1
> 
> 时间：2009-06-19T05:19:55.500

CTRL-G 用于跳转到特定的行号。当您在大型代码文件中获得行号时可以节省几秒钟。

* * *

## 回答 #79

> 赞同：1
> 
> 时间：2009-06-19T12:25:00.643

我想谈谈评论 ( `Ctrl`+ `k`, `Ctrl`+ `c`) 和取消评论 ( `Ctrl`+ `k`, `Ctrl`+ `u`) 快捷方式，但 Bratt (:p) 已经提到了它们。

`Ctrl`+ `k`, `Ctrl`+快捷方式怎么样`d`，非常方便**格式化标记**（ASP.NET、HTML）**和 JavaScript**代码！

* * *

## 回答 #80

> 赞同：1
> 
> 时间：2009-08-31T06:55:15.257

*   **使用“新窗口”和“新垂直选项卡组”组合**垂直拆分窗口。****

 **默认情况下，VS 中只有水平拆分，但窗口复制的技巧也允许使用垂直拆分。

*   Vertical selection is good (it accessible with keyboard too: Alt+Shift+[Ctrl]+Arrows). But sometimes I need to use **Vertical Copy/Cut and Paste**. VS is smart enough to handle this correctly.

*   There are also very useful features: **Go Next/Prev Scope** (Alt+Down/Up), **Go to Implementation** (Alt+G), but they are a part of the [Visual Assist X](http://wholetomato.com/ "Visual Assist X") plug-in.

* * *

## 回答 #81

> 赞同：1
> 
> 时间：2010-01-12T14:38:04.000

除了所有其他人说：

*   `Ctrl`+ `K`+`D`
*   `Ctrl`+ `K`+`U`
*   `Ctrl`+ `M`+`L`
*   `Ctrl`+ `M`+`O`

按住“Alt”时选择。
点击`F12`而不是右键单击并选择“转到定义”。

*   `Ctrl`+ `K`+`C`用于评论。
*   `Ctrl`+ `K`+`U`取消注释。

今天如果发现新东西：
在设计模式下的 WebFroms 中，转到工具菜单并选择“生成本地资源”。它对于制作多语言 Web 应用程序非常方便。

* * *

## 回答 #82

> 赞同：1
> 
> 时间：2010-06-15T13:28:40.693

相信大家都知道，不只是VS，几乎在任何地方都可以做到。如果您按下`Ctrl + left arrow/right arrow`，您将转到下一个/最后一个单词。您也可以`Ctrl + Shift + left/right arrow`一次选择整个单词。

* * *

## 回答 #83

> 赞同：1
> 
> 时间：2010-07-06T04:23:44.813

在 VS 2010 中导航符号的引用： 1\. 将光标放在符号上以突出显示所有引用 2\. Ctrl - Alt - 向上/向下导航向后/向引用。

^_^

* * *

## 回答 #84

> 赞同：1
> 
> 时间：2011-05-19T19:37:33.750

通过在调试期间右键单击代码视图或拖动黄色箭头来设置下一条语句。

这对于再次调试您最近跳过的部分代码非常有用，或者可能更改某些变量的内容并尝试再次执行一组语句。

* * *

## 回答 #85

> 赞同：0
> 
> 时间：2008-09-02T06:49:56.973

[这是一篇关于表达式评估器中的](http://blogs.msdn.com/stevejs/default.aspx?p=2)一些隐藏调试器功能的旧博客文章。

* * *

## 回答 #86

> 赞同：0
> 
> 时间：2009-08-31T05:56:58.107

Shift + Delete 以剪切光标所在的任何行。

我一直使用它来删除整行代码。

* * *

## 回答 #87

> 赞同：0
> 
> 时间：2011-12-20T22:59:26.733

以下是一些我还没有看到的列表：

1.  **快速查找选定的文本：选择文本** 时，按 Ctrl + F3，然后按 F3 可在给定文件中快速查找该文本
2.  **关闭多个文件：** 当您打开了许多窗口并且您只想清除其中的*一些*（与“关闭除此之外的所有文件等”相反）时，转到 Window -> Windows... 会弹出一个对话框，现在您可以选择你想关闭的窗口
3.  **导航到特定文件：**当您的解决方案有很多文件时，可能需要一段时间才能在解决方案资源管理器中找到文件。没问题！选择您的解决方案并开始输入文件名，然后您将被引导至您的文件！

* * *

## 回答 #88

> 赞同：0
> 
> 时间：2008-12-19T19:05:44.253

我更新了我的代码翻转器，我之前发布过。我添加了对 ASP 控件的支持。

拉里

* * *

## 回答 #89

> 赞同：0
> 
> 时间：2009-08-31T05:43:49.350

有时使用 Ctrl-Left Click 进行垂直选择非常有用...

* * *

## 回答 #90

> 赞同：0
> 
> 时间：2008-09-24T21:00:56.980

*   从 http://www.microsoft.com/downloads/details.aspx?FamilyID=6bb41456-9378-4746-b502-b4c5f7182203&DisplayLang=en">Microsoft 页面打印快捷方式并将它们放在您旁边。尝试学习新的每天一个。您会发现这里已经提到的所有快捷方式 + 更多。一些非常有用的包括格式化代码块、评论、在页面之间导航...*   获取 Resharper，它是一个可以大大提高效率的插件。如果您使用 Resharper，您可以找到带有快捷方式的列表。

* * *

## 回答 #91

> 赞同：0
> 
> 时间：2012-01-05T10:01:21.740

*   `Ctrl`+`Z`显然是撤消，但也会撤消工作室应用的**自动格式化。**

在复制/粘贴为可读性而间隔的硬编码表时非常有用。当您粘贴时，Studio 将应用格式，并且不再排列任何内容。快速的 Ctrl-Z 可以恢复您的良好对齐。

* * *

## 回答 #92

> 赞同：0
> 
> 时间：2009-11-10T12:37:57.673

我只是想复制没有注释的代码。

所以，诀窍是简单地按下 Alt 按钮，然后突出显示您喜欢的矩形。（例如下面）。

```
protected void GridView1_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        //if (e.CommandName == "sel")
        //{
        //    lblCat.Text = e.CommandArgument.ToString();
        //}
    } 
```

在上面的代码中，如果我想选择：

```
e.CommandName == "sel"

lblCat.Text = e.Comman 
```

然后我按 ALT 键并选择矩形，无需取消注释行。

看一下这个。

* * *

## 回答 #93

> 赞同：0
> 
> 时间：2011-05-29T18:00:55.433

一些我知道或没见过的贴在这里。

*   `Crtl`+`Space`鼓励 Intellisense 完成一个单词。

*   自定义工具箱 - 右键单击​​工具箱，弹出弹出菜单**>**选择项目**>**选中/取消选中框**>**确定。

*   在没有启动页面的情况下启动 Visual Studio。`Windows`+`R` 然后键入`devenv /nosplash`并按 Enter。

* * *

## 回答 #94

> 赞同：0
> 
> 时间：2010-03-03T15:50:57.077

刚刚发现鼠标上的后退和前进按钮向后或向前移动一个文档。

认为我错了这一点。仅在搜索内容时发生。

* * *

## 回答 #95

> 赞同：0
> 
> 时间：2010-12-15T00:51:34.637

**任务列表令牌**

稍后在打开任务列表窗口并选择用户评论选项时检索配置的任务列表令牌，这将显示包含已配置令牌的所有用户评论。

例如，如果您尝试检索 TODO 注释，这将非常有用。

使用它；工具 --> 选项 --> 环境 --> 任务列表，添加所需的令牌。

* * *

## 回答 #96

> 赞同：0
> 
> 时间：2010-07-06T04:52:29.690

曾经想查看一个接口成员的所有实现吗？[使用“调用层次结构”](https://stackoverflow.com/questions/3163048/how-to-show-all-implement-instance-of-an-interface-method)！

* * *

## 回答 #97

> 赞同：0
> 
> 时间：2011-12-10T15:04:06.043

## 中断发生异常的行

如果要中断发生异常的行，则可以使用 CTRL + ALT + E 并选中 Throw Column 下的 CLR 复选框。

即使异常由用户处理，这也将起作用。

PS：

我尝试发布屏幕截图，但由于不允许新用户发布图像，因此无法发布。对不起 ！

* * *

## 回答 #98

> 赞同：0
> 
> 时间：2011-11-15T19:49:19.603

我每次打开文件时都会使用它。这就是为什么我只是讨厌地区。

折叠到定义

`Ctrl`+ `M`+`O`

* * *

## 回答 #99

> 赞同：-1
> 
> 时间：2009-12-07T16:33:38.530

在阅读了所有这些精彩（和一些重复）的帖子后，我想补充一些我认为我没有看到的内容：

CTRL+Z = 撤消

CTRL+Y = 重做

;-)

另外，不要忘记修改键盘快捷键！工具 > 选项 > 环境 > 键盘

很多好东西！我有 F9 == stepinto，f10 == step over 和 f11 == step out。很有用。

另一个没有被引用的我经常使用的（尽管大多数人可能有一个带有这个按钮的工具栏）：f6 == Build Solution。

享受！

* * *

## 回答 #100

> 赞同：-4
> 
> 时间：2008-09-20T10:07:09.783

Visual Assist, in general, while a bit OT for this question, is a great app and really helps with the day-to-day running of visual studio. Their open-any-file and find-any-symbol windows are particularly awesome.****

# asp.net - 如何在没有多个根节点的情况下使用多个站点地图文件

> ID：100435
> 
> 赞同：1
> 
> 时间：2008-09-19T08:13:24.257
> 
> 标签：asp.net, sitemap, menu

我正在使用 ASP.NET 菜单控件。我希望菜单看起来像这样，其中链接 1 到 10 在一个站点地图文件中，而链接 11 到 20 在另一个站点地图文件中。

```
root
--link 1
(...)
--link 10
--link 11
(...)
--link 20 
```

但是，站点地图文件必须有一个我似乎无法抑制的根。

有什么想法吗？

-Edoode

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T17:28:42.947

您可以通过执行以下操作来抑制根节点：

```
SiteMapDataSource ds = new SiteMapDataSource();
ds.SiteMapProvider = "providername";
ds.ShowStartingNode = false;
TreeView1.DataSource = ds;
TreeView1.DataBind(); 
```

我使用这种方法来隐藏树视图的根节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T12:16:20.840

是否有任何理由不能添加虚拟根节点，然后将 ASP.NET 菜单控件子类化以忽略虚拟“根”节点？

您应该能够告诉您的 SiteMapProvider 为菜单使用不同的站点地图。

我的另一个问题是拥有多个站点地图文件的目的是什么？我相信您对此有充分的理由，但是了解正在发生的事情会更容易理解并提出更好的解决方案。

话虽如此，我会想出一个本土的菜单系统。您可以在前端使用 jQuery 和 superfish 插件，并在后端使用 C# 读取站点地图文件以构建菜单结构。

# c++ - 如何使用命令标志在未来的共享库上设置断点

> ID：100444
> 
> 赞同：101
> 
> 时间：2008-09-19T08:15:45.577
> 
> 标签：c++, c, linux, unix, gdb

我正在尝试使用该`--command`标志自动化 gdb 会话。我正在尝试在共享库（DLL 的 Unix 等效项）中的函数上设置断点。我的 cmds.gdb 看起来像这样：

```
set args /home/shlomi/conf/bugs/kde/font-break.txt
b IA__FcFontMatch
r 
```

但是，我得到以下信息：

```
shlomi:~/progs/bugs-external/kde/font-break$ gdb --command=cmds.gdb...
GNU gdb 6.8-2mdv2009.0（Mandriva Linux 版本 2009.0）
版权所有 (C) 2008 Free Software Foundation, Inc.
许可 GPLv3+：GNU GPL 版本 3 或更高版本
这是免费软件：您可以自由更改和重新分发它。
在法律允许的范围内，不提供任何保证。输入“显示复制”
和“显示保修”了解详情。
此 GDB 配置为“i586-mandriva-linux-gnu”...
（未找到调试符号）
未定义函数“IA__FcFontMatch”。
在未来的共享库加载时使断点挂起？(y or [n]) [回答 N; 输入不是来自终端]

```

所以它毕竟没有设置断点。如何使其默认回答“y”以在未决的未来共享库加载上设置断点？

我记得我能够做某事，但不记得是什么。

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2008-09-19T08:32:20.933

回复我自己，我想给出IRC上有人给我的答案：

```
(gdb) 待定
actions -- 指定要在跟踪点执行的操作
设置断点 -- 断点特定设置
设置断点挂起——设置调试器关于挂起断点的行为
显示断点 -- 断点特定设置
show breakpoint pending -- 显示调试器关于挂起断点的行为

```

所以**设置断点挂起就**可以了；它用于`cmds.gdb`例如

```
set breakpoint pending on
break <source file name>:<line number> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-19T20:41:09.263

OT：在终端中，在一行中调试 Caja 看起来像这样：

```
gdb -ex "set breakpoint pending on" -ex "break gdk_x_error" -ex run --args caja --sync 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-14T02:57:10.383

没有符号。

```
objdump -t /lib/libacl.so
SYMBOL TABLE:
no symbols
objdump -T /lib/libacl.so
...
00002bd0 g    DF .text  000000d0  ACL_1.0     acl_delete_entry
...

(gdb) break 0x0002bd0 

(gdb) x/20i acl_delete_entry
0x2bd0 <acl_delete_entry>:      stwu    r1,-32(r1)
0x2bd4 <acl_delete_entry+4>:    mflr    r0
0x2bd8 <acl_delete_entry+8>:    stw     r29,20(r1)
0x2bdc <acl_delete_entry+12>:   stw     r30,24(r1)
0x2be0 <acl_delete_entry+16>:   mr      r29,r4
0x2be4 <acl_delete_entry+20>:   li      r4,28972 
```

# asp.net - 为什么 DataSourceSelectArguments 是密封的？

> ID：100454
> 
> 赞同：0
> 
> 时间：2008-09-19T08:17:52.840
> 
> 标签：asp.net, database

有人知道密封 DataSourceSelectArguments 背后的逻辑吗？

我已经为一些自定义业务对象和自定义 WebControls 实现了自定义 DataSource（和相关类）。在考虑过滤器（如在网格中）时，我发现 DataSourceSelectArguments 是密封的。当然，我错过了一些东西。（也许逻辑与再次询问数据库是胡说八道，只是为了过滤？，只是一个猜测。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-29T14:11:27.740

抱歉耽搁了，我在圣日。:)

问题是 ListView 等 DataBoundControl 具有 SortExpression 属性，但没有 FilterExpression。可以通过触发 PostBack 和 Command 事件的 IButtonControl WebControl 使用 ListView 实现可排序的网格/列表。然后，您使用 SortExpression 或 Sort 方法并传递一个排序表达式，该表达式将填充 DataSourceSelectArguments.SortExpression 并将其传递给 DataSource，后者可以构造适当的 SQL 语句（在我的情况下）以从数据库中检索数据。这允许在数据和显示它的 WebControl 之间分离，恕我直言。

按照这种模式，我将通过在我的 DataSourceSelectArguments 中使用请求的过滤器填充一个额外的参数对象来实现一个过滤器，我将调用 Sort，它将这个参数对象传递给 DataSource，我将在其中构造适当的选择子句.

我终于通过在 SortExpression 中“编码”过滤器信息来解决它，但我觉得它很难看（首先是名称：sort != filter），我想知道是否有更合适的方法这个或者如果我错过了一些更微妙的东西。

**编辑**：

也许更好的方法是重写`ListView`'s`PerformSelect`方法并询问我自己的实现`DataSourceView`是否可以过滤，然后调用一个特殊`ExecuteSelect`方法，该方法接受`DataSourceSelectArguments`带有过滤器对象的特殊。`ListView`当然，当有人使用带有非增强的自定义时，请注意不要做任何会破坏的事情`DataSourceView`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T20:31:56.017

我的猜测是因为该类是一个愚蠢的数据传输对象，仅用于将参数传递给方法。

这个类本身没有定义任何操作，因此您期望什么样的多态性？比如现有的方法只会知道这个类的属性，这些属性都是可设置的，所以不需要重写属性。如果您添加了新属性，它们将被忽略。

对于您自己的方法，您可以创建自己的 Arguments 类，而该类恰好具有所有相同的属性吗？

# networking - XNA 项目的 Live/GamerServices 的替代方案？

> ID：100459
> 
> 赞同：0
> 
> 时间：2008-09-19T08:18:38.160
> 
> 标签：networking, xna

使用 XNA 的 GamerServices 组件访问 Xbox/GfW Live 以进行联网需要开发人员和玩家每人每年 100 美元订阅 Microsoft 的 Creators Club。这对于 Xbox360 XNA 项目来说不是什么大问题，因为无论如何您都需要订阅才能将您的游戏放到 360 上。

但是对于使用 XNA 的 PC 游戏来说，要求开发者和玩家每年投入这么多钱，仅仅为了获得玩家的玩家卡就非常疯狂。是否有任何 XNA 游戏解决方案可以提供与 GamerServices 类似的好处？或者，如果开发人员不想让他们的玩家（和他们自己）承受 100 美元/人头的打击，他们是否几乎仅限于构建自己的网络功能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-21T11:55:16.973

也许你可以试试[Lidgren](http://code.google.com/p/lidgren-network-gen3)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T15:14:29.273

请注意，Windows Live 游戏现在免费： [http ://www.engadget.com/2008/07/22/games-for-windows-live-now-free/](http://www.engadget.com/2008/07/22/games-for-windows-live-now-free/)

由于使用 Live API 是您在 xbox 和 zune 上的唯一选择，因此它是一个非常引人注目的选择，因为您唯一的问题是 Windows 上的成本 :-) 特别是考虑到一旦游戏工作室 3.0 启动，您将能够在 Xbox Live 的新社区游戏部分出售您的游戏

*编辑，经过进一步调查，事实证明 Windows Live 的游戏有点半生不熟。gamerservices 库似乎不包含在可再发行位中。因此，除非您想打破 EULA，否则您的播放器必须安装 gamestudio。话虽如此，我仍然相信它是免费的，如果不是不方便的话。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T08:49:10.147

好吧，很明显，您可以使用套接字，并且使用套接字您可以创建一个单独的专用服务器应用程序，而 Live 无法做到这一点（据我所知）。你也可以试试 SteamWorks；但是，我还没有听说有人尝试这样做。

# web-applications - 网页中的 SSO

> ID：100460
> 
> 赞同：2
> 
> 时间：2008-09-19T08:19:55.053
> 
> 标签：web-applications, single-sign-on

我想知道在网站上进行单点登录的最佳技术是什么。这意味着如果您进入多个网站，您将以“透明”的方式进行身份验证。我正在使用 php + curl 为不同的站点设置 cookie，但我真的很想知道是否存在一种标准的方法来做到这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T08:43:05.510

对于您需要的标准安全方式：

*   认证服务器
*   每个需要 SSO 的站点上的身份验证过滤器

该机制有点复杂，它涉及 http 重定向和安全身份验证票证。[您将在CAS 网站](http://www.ja-sig.org/products/cas/)（流行的 Java SSO 服务器）上找到详细说明。
我推荐阅读这个页面“ [CAS Java Client Gateway Example](http://www.ja-sig.org/wiki/display/CASC/CAS+Java+Client+Gateway+Example) ”，尤其是页面底部的序列图。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-09-19T08:47:10.087

您还可以查看 OpenId。这与用于登录 stackoverflow 的机制相同，并且具有“全局”单点登录。

我相信有 php 库可以与之集成。

You could also take a look at [this question](https://stackoverflow.com/questions/44509/single-sign-on-across-multiple-domains).

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-09-19T08:23:09.630

最好的方法是使用从外部站点提取图像流的图像标签。

因此，如果您在 www.some-site.com 并且还想登录 www.some-partner-site.com，则登录后会显示以下内容：

因为您使用的是图像，所以它会强制浏览器“拉入”该 URL 的内容。

我最近构建了一个使用 ASP.NET 的解决方案，但我们也有一个基于 php 的合作伙伴站点。

显示的图像无关紧要，实际上您根本不应该显示任何图像（因此为 1x1 大小）

# .net - .NET 中的神经网络示例

> ID：100469
> 
> 赞同：47
> 
> 时间：2008-09-19T08:23:47.040
> 
> 标签：.net, artificial-intelligence, neural-network

任何带有源代码的优秀教程，将演示如何开发神经网络（傻瓜的步进间隔步骤;-)）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-19T08:26:09.873

这是一个很好的例子： [Brainnet 1 - 一个神经网络项目 - 带有插图和代码 - 逐步学习神经网络编程并开发一个简单的手写检测系统](http://www.codeproject.com/KB/dotnet/neuralnetwork.aspx)，该系统将展示神经网络编程的一些实际用途。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-19T08:25:22.013

CodeProject 上有一篇非常好的文章：[图像识别与神经网络](http://www.codeproject.com/KB/cs/BackPropagationNeuralNet.aspx)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-12-02T10:08:13.777

这是关于 C# 神经网络编程的在线课程。

[http://www.heatonresearch.com/course/intro-neural-nets-cs](http://www.heatonresearch.com/course/intro-neural-nets-cs)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T08:26:58.093

[此处](http://www.codeproject.com/KB/recipes/neural_dot_net.aspx)提供了一个有趣的教程。希望它将作为您的介绍。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-09T12:27:04.680

您可以查看[http://generation5.org/articles.asp?Action=List&Topic=Neural+Networks](http://generation5.org/articles.asp?Action=List&Topic=Neural+Networks)，其中包含大量关于针对初学者和高级领域的各种类型的神经网络的文章。

# windows - 如何在 Windows 下暂停/恢复任何外部进程？

> ID：100480
> 
> 赞同：10
> 
> 时间：2008-09-19T08:26:17.127
> 
> 标签：windows, process, process-management

我正在寻找不同的方法来通过 Windows XP 下的进程 ID 以编程方式暂停和恢复特定进程。

[进程挂起/恢复工具](http://www.codeproject.com/KB/threads/pausep.aspx)使用`SuspendThread`/`ResumeThread`但警告多线程程序和死锁问题。

[PsSuspend](http://technet.microsoft.com/en-us/sysinternals/bb897540.aspx)看起来不错，但我想知道它是否对死锁有什么特别之处或使用其他方法？

首选语言：C++ / Python

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T14:22:14.390

如果您“调试调试器”（例如，`logger.exe`用于跟踪由 进行的所有 API 调用`windbg.exe`），则调试器似乎使用`SuspendThread()`/`ResumeThread()`挂起正在调试的进程中的所有线程。

PsSuspend 可能使用不同的挂起进程的方式（我不确定），但仍然有可能挂起其他进程：如果您正在挂起的进程正在持有另一个进程所需的共享同步对象，您可能会阻塞其他过程没有取得任何进展。如果两个程序都写得很好，当您恢复暂停的那个时，它们应该会恢复，但并非所有程序都写得很好。如果这导致您正在执行挂起的程序挂起，那么您就有了死锁。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-04T12:17:01.137

我不确定这是否有效，但使用 MS Systernals 的 ProcessExplorer，您可以暂停一个进程。

这里有人说过：[https](https://superuser.com/a/155263) ://superuser.com/a/155263我也在那里找到了它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-27T11:27:10.007

阅读[这里](https://stackoverflow.com/questions/11010165/how-to-suspend-resume-a-process-in-windows)，你也有 psutil for python，你可以像这样使用它：

```
>>> import psutil
>>> pid = 7012
>>> p = psutil.Process(pid)
>>> p.suspend()
>>> p.resume() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-20T07:25:21.903

我在几个软件上测试了[http://www.codeproject.com/KB/threads/pausep.aspx ：](http://www.codeproject.com/KB/threads/pausep.aspx)

它工作正常。

PsSuspend 和 Pausep 是两个有效的选项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-04-22T17:29:22.830

因此，在我发现[UniversalPauseButton](https://github.com/ryanries/UniversalPauseButton)之后，谷歌搜索（“windows SIGSTOP”），将此问题作为第一个搜索结果（感谢 Ilia K。[您的评论](https://stackoverflow.com/questions/100480/how-to-pause-resume-any-external-process-under-windows#comment4274004_100480)完成了它的工作），并阅读了答案，我回去检查代码.

[显然](https://github.com/ryanries/UniversalPauseButton/blob/72c7e53c5471c15b9fd5f5fc7cfe1d346592aa66/Main.cpp#L17)，它使用未记录的 NT 内核和 Win32 API `_NtSuspendProcess`，`_NtResumeProcess`并且`_HungWindowFromGhostWindow`.

PsSuspend，您提到并链接到的实用程序可能使用了这些 API，我无法验证这一点，没有提供源代码，只有可执行文件和 EULA，您可能可以通过反汇编二进制文件来解决这个问题，但它违反 EULA .

因此，要回答您的具体问题，请查看[UniversalPauseButton](https://github.com/ryanries/UniversalPauseButton)的主要内容。**cpp**，[基本上](https://github.com/ryanries/UniversalPauseButton/blob/72c7e53c5471c15b9fd5f5fc7cfe1d346592aa66/Main.cpp#L314)你调用`_NtSuspendProcess(ProcessHandle)`and `_NtResumeProcess(ProcessHandle)`，`ProcessHandle`作为你想要暂停或恢复的进程的句柄。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T11:46:51.067

我认为 Windows 中没有 SuspendProcess() 函数是有充分理由的。拥有这样的功能为不稳定的系统打开了大门。除非您自己创建了该进程，否则您不得暂停该进程。如果您自己编写了该流程，您可以使用事件（参见 MSDN 中的 ::SetEvent() 等）或其他类型的消息传递来触发流程中的暂停命令。

# .net - 如何在 xaml 中绑定到动态 xpath？

> ID：100500
> 
> 赞同：6
> 
> 时间：2008-09-19T08:32:03.930
> 
> 标签：.net, wpf, xaml, xpath, code-behind

我有一个基于 XPath 查询显示项目的列表框。

这个 XPath 查询会根据用户在 GUI 其他地方的选择而改变。XPath 总是引用同一个文档。

目前，我使用一些 C# 代码将控件的绑定更改为新的 XPath 表达式。

相反，我想在 XAML 中绑定到 XPath，然后根据需要更改该 XPath 的值。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-20T00:57:15.083

我认为您试图使问题复杂化。但是您是否考虑过将 XPath 分配给动态资源：

```
<....   ={Binding XPath={DynamicResource:res resource-name}} ... /> 
```

阅读 all-binding 的最佳位置是 Beatriz 的博客：[http ://www.beacosta.com/blog/](http://www.beacosta.com/blog/)

# sql - 返回表的字段名称的 SQL 命令是什么？

> ID：100504
> 
> 赞同：42
> 
> 时间：2008-09-19T08:33:25.020
> 
> 标签：sql, mysql, sql-server, database

假设我有一个名为 myTable 的表。返回该表的所有字段名的 SQL 命令是什么？如果答案是特定于数据库的，那么我现在需要 SQL Server，但也有兴趣查看其他数据库系统的解决方案。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-09-19T08:36:25.760

MySQL 3 和 4（和 5）：

```
desc tablename 
```

这是一个别名

```
show fields from tablename 
```

SQL Server（从 2000 年开始）和 MySQL 5：

```
select COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS 
where TABLE_NAME = 'tablename' 
```

完成答案：就像下面的人所说，在SQL Server中你也可以使用存储过程`sp_help`

```
exec sp_help 'tablename' 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-19T08:39:11.917

SQL-92 标准定义了符合 rdbms 的 INFORMATION_SCHEMA，如 MS SQL Server 支持。以下适用于 MS SQL Server 2000/2005/2008 和 MySql 5 及更高版本

```
select COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = 'myTable' 
```

MS SQL 服务器特定：

```
exec sp_help 'myTable' 
```

此解决方案返回几个结果集，其中包含您想要的信息，而前者为您提供了您想要的信息。

也只是为了完整性，您可以直接查询 sys 表。不建议这样做，因为架构可以在 SQL Server 版本之间更改，并且 INFORMATION_SCHEMA 是这些表之上的抽象层。但无论如何，对于 SQL Server 2000

```
select [name] from dbo.syscolumns where id = object_id(N'[dbo].[myTable]') 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-19T08:40:55.063

您可以使用提供的系统视图来执行此操作：

例如

```
select * from INFORMATION_SCHEMA.COLUMNS
where table_name = '[table name]' 
```

或者，您可以使用系统 proc **sp_help**

例如

```
sp_help '[table name]' 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-19T10:00:25.887

对于那些在 Oracle 中寻找答案的人：

```
SELECT column_name FROM user_tab_columns WHERE table_name = 'TABLENAME' 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-19T12:33:43.233

PostgreSQL 理解

```
select column_name from information_schema.columns where table_name = 'myTable' 
```

句法。如果你在 psql shell 中工作，你也可以使用

```
\d myTable 
```

用于描述（列及其数据类型和约束）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-19T19:38:51.243

只是为了完整起见，因为已经提到了 MySQL 和 Postgres：对于 SQLite，使用“ `pragma table_info()`”

```
sqlite> pragma table_info('table_name');
cid         name        type        notnull     dflt_value  pk        
----------  ----------  ----------  ----------  ----------  ----------
0           id          integer     99                      1         
1           name                    0                       0 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-19T08:56:04.543

这也是 MySQL 特定的：

```
show fields from [tablename]; 
```

这不仅显示表名，而且还提取有关字段的所有信息。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-19T19:45:10.230

在 Sybase SQL Anywhere 中，列和表信息是分开存储的，因此需要一个连接：

```
select c.column_name from systabcol c 
       key join systab t on t.table_id=c.table_id 
       where t.table_name='tablename' 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-19T08:36:49.380

如果你只想要列名，那么

```
select COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = 'tablename' 
```

在 MS SQL Server 上，有关表的更多信息（例如列的类型），请使用

```
sp_help 'tablename' 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-19T08:39:36.737

MySQL 也是一样的：

```
select COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = 'tablename' 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-20T15:21:42.727

对于 IBM DB2（将在周一再次检查以确保。）

```
SELECT TABNAME,COLNAME from SYSCAT.COLUMNS where TABNAME='MYTABLE' 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T09:44:12.010

MySQL

```
describe tablename 
```

# javascript - 确保现有网页在移动平台上良好显示的最快和最简单的方法是什么？

> ID：100519
> 
> 赞同：5
> 
> 时间：2008-09-19T08:37:50.563
> 
> 标签：javascript, css, browser, mobile

有问题的页面包含大量的 javascript 和 CSS。移动平台对这些的支持程度如何？

是否有浏览器模拟器（或等效工具）来协助测试？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T08:39:26.347

[Opera](http://www.opera.com)可以选择通过移动设备查看页面。我发现它在过去很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T08:46:42.740

我可以告诉你， iPhone 上的[Apple 移动 Safari](http://www.apple.com/iphone/features/safari.html)*完美*呈现了 Stack Overflow ，我觉得这很神奇。

这是一个面向程序员而非普通用户的网站，因此我们接受了很多 JavaScript 依赖项。

我真希望更多的移动设备拥有像 Mobile Safari 一样强大的浏览器。我也听说过关于[Opera Mini](http://www.operamini.com/)的好消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T15:05:18.483

**一个例子**：我的 BlackBerry 8130 (Pearl) 上的标准 BlackBerry 浏览器在加载我的主页时似乎忽略了 CSS 和 JavaScript。

我还在这个设备上安装了 Opera Mobile，它呈现 CSS，但不呈现我的 jQuery 悬停效果。它确实了解一些 jQuery - 例如，我有一个表单验证，如果验证失败，它会执行 show() 错误消息。这在 Opera 中有效，虽然没有动画效果。

**对于移动浏览器来说，最安全的做法是设计在没有 JS 或 CSS 的情况下优雅降级的页面**。这是否值得努力取决于您。

几年后，希望唯一的渲染差异将是手机的屏幕尺寸限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T08:58:11.433

您可以在 Java WTK 等模拟器上安装 Opera Mini，并在 PC 上测试移动渲染。一个缺点是 Opera Mini 仍然通过代理工作，因此无法调试本地文件/站点 - 您必须将站点上传到全球可访问的服务器。

只是谷歌它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T15:35:06.587

这完全取决于手机。如果您想支持现有的每一个设备，甚至不用担心 CSS 或 JavaScript，因为它们在 99% 的设备上都不会工作（或者会做一些完全非标准的事情）。如果您只针对高端设备，例如 iPhone 或最新的 Series 60 Nokias，您应该能够摆脱有限的 JS 和 CSS。

我知道的一些浏览器模拟器：

*   [开波](http://developer.openwave.com/dvl/tools_and_sdk/phone_simulator/)。
*   [诺基亚工具](http://www.forum.nokia.com/main/resources/tools_and_sdks/)

还有更多的制造商根本没有任何工具（我敢于尝试为 LG 寻找开发者网站），因此如果您想确保网站正常显示，您需要访问实体手机.

如果您有现金，[DeviceAnywhere是一个极好的工具。](http://www.deviceanywhere.com/)大约一年半前我最后一次使用它时非常滞后。此外，它是纯 Java，因此在任何机器上都是狗。但它可以说是最好的移动开发工具，相信我，我已经尝试了**很多**。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-09T18:00:26.483

操作系统 4.5 或更早版本的 BlackBerry 设备不能很好地处理 Javascript 或 CSS，如果有的话。OS 4.6 及更高版本（Bold、Pearl Flip、Storm 等）的设备配备了一个新的渲染引擎，它对 Javascript、DOM 和 CSS 有更好的支持。它并不完美，但它应该可以很好地呈现大多数页面。您可以从他们的开发者网站下载这些设备的 BlackBerry 模拟器并试用。由于它运行的代码与实际设备上的代码相同，因此可以很好地代表您可以在设备上看到的内容。

# c# - 接口类型方法参数实现

> ID：100533
> 
> 赞同：2
> 
> 时间：2008-09-19T08:40:44.377
> 
> 标签：c#, asp.net

是否可以这样做：

```
interface IDBBase {
     DataTable getDataTableSql(DataTable curTable,IDbCommand cmd);
     ...
}

class DBBase : IDBBase {
     public DataTable getDataTableSql(DataTable curTable, SqlCommand cmd) {
         ...
     }
} 
```

我想使用接口来实现 d/t 提供程序（MS-SQL，Oracle ...）；其中有一些签名要在实现它的相应类中实现。我也试过这样：

```
genClass<typeOj>
{
    typeOj instOj;

    public  genClass(typeOj o)
    {      instOj=o;    }

    public typeOj getType()
    {        return instOj;    } 
```

...

```
interface IDBBase 
{
    DataTable getDataTableSql(DataTable curTable,genClass<idcommand> cmd);
    ...
}

class DBBase : IDBBase 
{
    public DataTable getDataTableSql(DataTable curTable, genClass<SqlCommand> cmd)
    {
        ...
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T08:50:00.893

不，这是不可能的。方法应具有与接口中声明的签名相同的签名。

但是，您可以使用类型参数约束：

```
interface IDBClass<T> where T:IDbCommand
{
    void Test(T cmd);
}

class DBClass:IDBClass<SqlCommand>
{
    public void Test(SqlCommand cmd)
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T08:53:10.213

[自 C# 3.0 起，协变和逆变](http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science))不被广泛支持，除了将方法组分配给委托。您可以通过使用私有接口实现并使用更具体的参数调用公共方法来模拟它：

```
class DBBase : IDBBase {

    DataTable IDBBase.getDataTableSql(DataTable curTable, IDbCommand cmd) {
         return getDataTableSql(curTable, (SqlCommand)cmd); // of course you should do some type checks
     }

     public DataTable getDataTableSql(DataTable curTable, SqlCommand cmd) {
         ...
     }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T08:51:31.090

尝试编译它。`DBBase`如果没有实现，编译器会报错`IDBBase`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T08:53:07.670

不，这是不可能的。我试着编译这个：

```
interface Interface1 { }
class Class1 : Interface1 {}

interface Interface2 { void Foo(Interface1 i1);}
class Class2 : Interface2 {void Foo(Class1 c1) {}} 
```

我得到了这个错误：

> *“Class2”没有实现接口成员“Interface2.Foo(Interface1)”*

# visual-studio - 在 Visual Studio 中调试时如何设置特定的环境变量？

> ID：100543
> 
> 赞同：72
> 
> 时间：2008-09-19T08:45:39.077
> 
> 标签：visual-studio, debugging, environment-variables

在类库项目中，我将项目属性的“调试”选项卡上的“启动操作”设置为“启动外部程序”（本例中为[NUnit](http://en.wikipedia.org/wiki/NUnit)）。我想在这个程序启动的环境中设置一个环境变量。我该怎么做？（这甚至可能吗？）

编辑：

它是一个影响所有 .NET 应用程序的环境变量（COMplus_Version，它设置运行时版本），因此在系统范围内设置它确实不是一种选择。

作为一种解决方法，我只是通过将其设置为 .NET 来强制 NUnit 在正确的 .NET 版本 (2.0) 中启动`nunit.exe.config`，但不幸的是，这也意味着我的所有 .NET 1.1 单元测试现在也在 .NET 2.0 中运行。我可能应该只制作可执行文件的副本，以便它可以拥有自己的配置文件......

（我保持问题开放（不接受答案），以防有人碰巧发现如何（毕竟它可能对其他目的也有用......））

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2008-09-30T22:24:10.013

至少在 Visual Studio 2008 和 Visual Studio 2005 中，您可以在项目设置中指定对环境变量的更改。

打开你的项目。转到 Project -> Properties... 在 Configuration Properties -> Debugging 下，编辑“Environment”值以设置环境变量。

例如，如果您想在调试应用程序时将目录“c:\foo\bin”添加到路径中，请将 'Environment' 值设置为“PATH=%PATH%;c:\foo\bin”。

[![这是设置对话框的屏幕截图](../Images/5487907b862be69fc93deb9e1cf56f40.png)](https://i.stack.imgur.com/TxoL0.jpg)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-02-18T22:16:15.210

在 Visual Studio for Mac 和 C# 中，您可以使用：

`Environment.SetEnvironmentVariable("<Variable_name>", "<Value>");`

但是您将需要以下命名空间

```
using System.Collections; 
```

你可以用这个检查变量的完整列表：

```
foreach (DictionaryEntry de in Environment.GetEnvironmentVariables())
            Console.WriteLine("  {0} = {1}", de.Key, de.Value); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-07-16T20:52:43.440

Visual Studio 2003 似乎不允许您为调试设置环境变量。

我在 C/C++ 中所做的是使用`_putenv()`并`main()`设置任何变量。通常我用 a 包围它以`#if defined DEBUG_MODE / #endif`确保只有某些版本有它。

```
_putenv("MYANSWER=42"); 
```

我相信你可以使用 os.putenv() 对 C# 做同样的事情，即

```
os.putenv('MYANSWER', '42'); 
```

这些将仅为该 shell 进程设置环境变量，因此是一个临时设置，这正是您要寻找的。

顺便说一句，它很好地使用进程资源管理器 ( [http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx) )，它是一个 sysinternals 工具。您可以查看给定进程的环境变量副本是什么，因此您可以验证您设置的内容是否就是您得到的内容。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-03-23T09:36:33.817

在 Visual Studio 2019 中，右键单击您的项目，选择`Properties`. 在项目属性窗口中，选择`Debug`选项卡。然后，`Environment variables`将您的环境值从`Development`to`Production`或其他环境更改下。对于 .Net Core 和 .Net 5，该属性称为`ASPNETCORE_ENVIRONMENT`。

[![在此处输入图像描述](../Images/ba82847093e846a926b7b541e0bd383d.png)](https://i.stack.imgur.com/817oY.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-09T02:43:16.473

从 NUnit 2.5 开始，您可以使用 /framework 开关，例如：

```
nunit-console myassembly.dll /framework:net-1.1 
```

这是来自[NUnit 的帮助页面](http://nunit.org/index.php?p=consoleCommandLine&r=2.5.5)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-04-21T10:50:37.890

您可以在属性 > 配置属性 > 调试 > 环境中进行设置 [![在此处输入图像描述](../Images/764d023964eebec5f7df7c202eefdb18.png)](https://i.stack.imgur.com/ifLZE.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T08:53:19.263

设置一个可以调用的批处理文件。将路径传递给批处理文件，并让批处理文件设置环境变量，然后调用 NUnit。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T13:16:34.847

如果您不能使用 bat 文件来设置环境，那么您唯一可能的选择是设置系统范围的环境变量。你可以通过这样做找到这些

1.  右键单击“我的电脑”
2.  选择属性
3.  选择“高级”选项卡
4.  点击“环境变量”按钮
5.  在“系统变量”部分中，添加所需的新环境变量
6.  一路“好”接受你的修改

我不知道您是否必须重新启动 Visual Studio，但似乎不太可能。高温高压

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-02T04:49:25.320

由于环境是从父进程继承的，因此您可以为 Visual Studio 编写一个加载项，在执行启动之前修改其环境变量。我不确定将其放入您的流程中是否容易。

# c# - 您使用哪些（第三方）Visual Studio 2005/2008 调试可视化工具？

> ID：100548
> 
> 赞同：6
> 
> 时间：2008-09-19T08:47:11.493
> 
> 标签：c#, visual-studio, debuggervisualizer

我想这个话题经常被监督，但在调试你的代码时相当有用。就在今天，我偶然发现了这个简单而有效的可视化图像的可视化工具（它在一个德国博客上，但我猜代码内容是不言自明的）：

[链接文本](http://blogs.msdn.com/dparys/archive/2007/10/23/das-debugger-visualizer-item-template.aspx)

我想知道您在日常使用 VS2005/2008 的工作中使用了哪些调试可视化工具。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-19T08:50:33.357

我用[鼹鼠](http://karlshifflett.wordpress.com/mole-for-visual-studio/)。

> Mole 的设计不仅允许开发人员查看对象或数据，还允许开发人员深入了解这些对象的属性，然后对其进行编辑。Mole 允许无限制地钻入对象和子对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T15:32:17.267

另请查看 Xml Visualizer v.2 ( [http://codeplex.com/XmlVisualizer](http://codeplex.com/XmlVisualizer) )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T18:46:51.220

由于我经常使用 Graphics 和 GDI，我发现[Graphic Debug Visualizer](http://www.codeproject.com/KB/macros/GraphicDebuggerVisualizer.aspx)非常宝贵。它基于的[Bitmap Visualizer](http://blogs.geekdojo.net/brian/archive/2006/08/06/bitmapvisualizer.aspx)也很好，但是我必须为 Visual Studio 2008 重新编译它（并更改对各种 VisualStudio 扩展 dll 的引用）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T09:10:26.960

在 MSDN 博客上有一个 Microsoft.Xna.Framework.Matrix 的示例，我认为是。后来我自己做了，但它仍然很好。

# seo - 如何在不同的 Google 数据中心上执行 Google 搜索？

> ID：100557
> 
> 赞同：0
> 
> 时间：2008-09-19T08:48:47.633
> 
> 标签：seo

我想获取有关 Google 网站索引的最新信息，而且结果似乎因恰好处理您的搜索查询的数据中心而异。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T09:01:47.243

您可以使用专门为此设计的众多工具之一。其中之一是[iWebTool 上的 Google 数据中心搜索](http://www.iwebtool.com/google_datacenter_search)。

（实际上就是获取数据中心 IP 列表并向它们发送与 google.com 相同的 GET 变量。）

# scripting - 使用应用程序自动执行重复性任务的最佳自动化或脚本工具是什么？

> ID：100592
> 
> 赞同：1
> 
> 时间：2008-09-19T08:56:44.573
> 
> 标签：scripting, automation

我知道您可以编写 Microsoft Office 应用程序的脚本，但我正在寻找可以应用于其他应用程序的更通用的东西，例如 Adob​​e Acrobat、Web 浏览器和其他没有脚本能力的应用程序。

我使用过[AutoIt](http://www.autoitscript.com/autoit3/)，但它有点笨拙，尤其是在尝试调试脚本失败或停止的原因时。此外，获取操作的时间，例如单击按钮或正确选择菜单项可能会很痛苦。

是否有可用于此目的的构建工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T09:07:55.420

我推荐[AutoHotKey](http://www.autohotkey.com/)。它的语法并不漂亮，但大多数时候您不必编写自己的脚本，因为它的社区如此庞大且组织良好。即使你这样做了，文档也很丰富，很好，论坛会很快回答你的问题。开发人员积极响应，这意味着错误得到快速修复，并且正在考虑和添加新功能。

自从我开始使用 AHK 以来，我无法想象没有它 - 它可以在很多方面让 Windows 上的生活变得更简单。

您还可以使用 Python 和其他脚本语言的 COM 接口。它更复杂，但你可以使用更强大的语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-14T20:03:23.097

可能有点满足您的需求，但 AutoMate 非常强大且易于使用。不需要任何脚本技能，因为大多数任务都可以通过拖放构建[http://www.networkautomation.com/sales/scripting/](http://www.networkautomation.com/sales/scripting/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T09:24:39.093

我也喜欢 AutoHotkey (small k...)，但除了它奇怪的语​​法之外，它同样缺乏调试工具...基本上，就是“显示 msgbox 警报、将字符串发送到文件或调试视图、跟踪”。这对大多数情况来说是可以的，因为您很少使用这些工具编写长而复杂的应用程序。

在这两种工具中，可能在所有宏软件中，无论如何都很难获得“动作时间”，因为事件是异步的：大多数情况下，您不会等待给定时间，而是等待窗口出现。希望是对的！

还有其他自动化工具，比如[Ranorex](http://www.ranorex.com/ "Ranorex")（我没有测试过），你甚至可以使用一些脚本语言（Lua、Python）和一个库来发送消息（WM_XXX）和另一个调用 WinAPI ......但是像 AutoIt 这样的工具和 AutoHotkey 具有经过广泛测试的优势，因此它们可以处理大量行为/问题（例如等待剪贴板数据可用等）。

# c++ - Best resources for converting C/C++ dll headers to Delphi?

> ID：100596
> 
> 赞同：15
> 
> 时间：2008-09-19T08:56:53.747
> 
> 标签：c++, c, delphi, dll, header

A rather comprehensive site explaining the difficulties and solutions involved in using a dll written in c/c++ and the conversion of the .h header file to delphi/pascal was posted to a mailing list I was on recently, so I thought I'd share it, and invite others to post other useful resources for this, whether they be links, conversion tools, or book/paper titles.

One resource per answer please, so we'll end up with the most popular/best resources bubbling to the top.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-11-01T14:38:43.680

Over at [Rudy's Delphi Corner](http://rvelthuis.de/index.html), he has an [excellent article about the pitfalls of converting C/C++ to Delphi](http://rvelthuis.de/articles/articles-convert.html). In my opinion, this is essential information when attempting this task. Here is the description:

> This article is meant for everyone who needs to translate C/C++ headers to Delphi. I want to share some of the pitfalls you can encounter when converting from C or C++. This article is not a tutorial, just a discussion of frequently encountered problem cases. It is meant for the beginner as well as for the more experienced translator of C and C++.

He also wrote a "[Conversion Helper Package](http://rvelthuis.de/programs/convertpack.html)" that installs into the Delphi IDE which aids in converting C/C++ code to Delphi:

[![alt text](../Images/abac6a0cbfb9885a52abe22c7a9fa9ac.png)](https://i.stack.imgur.com/nwutf.png)
[(source: [rvelthuis.de](http://rvelthuis.de/images/convertpackshaded.png))]

His other relevant articles on this topic include:

*   [Using C++ Objects in Delphi](http://rvelthuis.de/articles/articles-cppobjs.html)
*   [Using C object files in Delphi](http://rvelthuis.de/articles/articles-cobjs.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-19T08:57:34.103

[Article](http://rvelthuis.de/articles/articles-convert.html#main) at Rudy's Delphi Corner

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T09:48:45.137

Also, CodeGear hosts a rudimentary translation tool called [CToPas](http://cc.codegear.com/item/23991) (written by Ural Gunaydin).

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-31T19:22:55.107

I would like to highlight the [Jedi Api Library](http://blog.delphi-jedi.net/home/), it is the Delphi translation of the Windows SDK headers. Might save you a lot of work if you need to translate headers from the SDK and is of course a good sample of conversions!

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-26T08:06:46.913

Since FreePascal is aimed at Delphi compatibiltiy among other things, i think H2Pas may be helpful too.

[https://www.freepascal.org/tools/h2pas.var](https://www.freepascal.org/tools/h2pas.var)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-19T09:45:10.510

[HeadConv](http://www.drbob42.com/headconv/) from DrBob is used quite a lot too, although I concur with Graza that manual translation is best.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T18:54:31.587

use this option so the byte alignment is the same as C/C++ and then you don't need to add padding bytes in structs.

{$MINENUMSIZE 4}

# sql - 您可以关闭 Visual Studio 2008 查询格式吗？

> ID：100614
> 
> 赞同：0
> 
> 时间：2008-09-19T09:00:05.580
> 
> 标签：sql, visual-studio-2008

是否可以关闭在 Visual Studio 中编辑数据库查询时发生的查询重新格式化？（即右击数据源并选择新建查询）

当我们针对 sql compact 3.5 数据库编写 sql 查询时，就会发生这种情况。

当您仔细缩进和格式化的查询被混入视觉工作室的格式（难以辨认！）时，它相当令人恼火。我在选项对话框中找不到任何设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T12:34:21.997

我使用 Add New "Sql Script" 而不是 Query 来防止重新格式化，但仍然保持语法突出显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-24T13:41:25.887

只是为了关闭这个，据我所知，没有办法做到这一点。

# .net - 如何从 cisco callmanager 获取 mac 地址或 IPAddress？

> ID：100620
> 
> 赞同：0
> 
> 时间：2008-09-19T09:01:46.950
> 
> 标签：.net, vb.net, cisco

有没有办法通过带有 VB.net 的 axl 使用 Callmanager 版本 6 检索 Cisco 服务器上电话的 MAC 地址或 IP 地址？

服务器可以自己检索IP地址以使用电话，它不在从服务器检索的数据库信息中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-02T13:20:27.127

您可以从 CallManager 服务器下载 WSDL 文件。然后使用包含的方法，您可以调用 getPhone 并且从那里开始非常简单。如果您想以更手动的方式进行操作，可以使用此博客文章中的方法：

[http://blog.crowe.co.nz/Archive/2008/October](http://blog.crowe.co.nz/Archive/2008/October)

（请参阅“使用 C# 从 Cisco Call Manager v6.x 获取电话的 IP 地址”部分）

# flash - Flash 应该在新选项卡中打开窗口，但它会在 Mac 上打开一个新的弹出窗口

> ID：100622
> 
> 赞同：1
> 
> 时间：2008-09-19T09:02:05.090
> 
> 标签：flash, actionscript-3, macos, firefox, cross-platform

`target="_blank"`在使用`navigateToUrl`

使用 Windows 上的 Firefox 会在新选项卡中打开，使用 Mac 上的 Firefox 会打开一个“弹出窗口”，

如何在 Mac 上的 Firefox 的新标签页中弹出窗口？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T09:30:27.753

检查您的 Firefox 首选项>>标签>>新窗口应该在（新窗口|新标签）中打开。您的 Firefox 在 Windows 和 Mac 上是否有不同的设置？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T18:12:16.367

这是浏览器首选项，而不是 actionscript 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T09:14:00.820

这很可能是浏览器和/或插件中的错误。我的建议是尝试使用 ExternalInterface 告诉 JavaScript 打开窗口。不过，这可能更有可能触发弹出窗口阻止程序。

# python - Windows 上的 Python - 如何等待多个子进程？

> ID：100624
> 
> 赞同：24
> 
> 时间：2008-09-19T09:02:43.217
> 
> 标签：python, windows, asynchronous

如何在 Windows 上等待 Python 中的多个子进程，而无需主动等待（轮询）？像这样的东西*几乎*对我有用：

```
proc1 = subprocess.Popen(['python','mytest.py'])
proc2 = subprocess.Popen(['python','mytest.py'])    
proc1.wait()
print "1 finished"
proc2.wait()
print "2 finished" 
```

问题是当`proc2`完成之前`proc1`，父进程仍然会等待`proc1`。在 Unix 上，人们会`waitpid(0)`在一个循环中使用它们来获取子进程完成时的返回码——如何在 Windows 上的 Python 中实现这样的事情？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-19T10:09:47.050

这似乎有点矫枉过正，但是，这里是这样的：

```
import Queue, thread, subprocess

results= Queue.Queue()
def process_waiter(popen, description, que):
    try: popen.wait()
    finally: que.put( (description, popen.returncode) )
process_count= 0

proc1= subprocess.Popen( ['python', 'mytest.py'] )
thread.start_new_thread(process_waiter,
    (proc1, "1 finished", results))
process_count+= 1

proc2= subprocess.Popen( ['python', 'mytest.py'] )
thread.start_new_thread(process_waiter,
    (proc2, "2 finished", results))
process_count+= 1

# etc

while process_count > 0:
    description, rc= results.get()
    print "job", description, "ended with rc =", rc
    process_count-= 1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-21T15:25:33.770

Twisted 有一个在 Windows 上工作的[异步进程生成 API 。](http://twistedmatrix.com/documents/8.1.0/api/twisted.internet.interfaces.IReactorProcess.html)实际上有几种不同的实现，其中很多都不是很好，但是您可以在它们之间切换而无需更改代码。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-21T15:12:19.607

基于 zseil 的回答，您可以混合使用 subprocess 和 win32 API 调用来完成此操作。我使用了直接的 ctypes，因为我的 Python 没有安装 win32api。我只是在这里从 MSYS 生成 sleep.exe 作为示例，但显然你可以生成任何你喜欢的进程。我使用 OpenProcess() 从进程的 PID 中获取 HANDLE，然后使用 WaitForMultipleObjects 等待任何进程完成。

```
import ctypes, subprocess
from random import randint
SYNCHRONIZE=0x00100000
INFINITE = -1
numprocs = 5
handles = {}

for i in xrange(numprocs):
    sleeptime = randint(5,10)
    p = subprocess.Popen([r"c:\msys\1.0\bin\sleep.exe", str(sleeptime)], stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=False)
    h = ctypes.windll.kernel32.OpenProcess(SYNCHRONIZE, False, p.pid)
    handles[h] = p.pid
    print "Spawned Process %d" % p.pid

while len(handles) > 0:
    print "Waiting for %d children..." % len(handles)
    arrtype = ctypes.c_long * len(handles)
    handle_array = arrtype(*handles.keys())
    ret = ctypes.windll.kernel32.WaitForMultipleObjects(len(handle_array), handle_array, False, INFINITE)
    h = handle_array[ret]
    ctypes.windll.kernel32.CloseHandle(h)
    print "Process %d done" % handles[h]
    del handles[h]
print "All done!" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-29T15:52:35.563

Windows 上的 Twisted 将在幕后执行主动等待。如果您不想使用线程，则必须使用 win32 API 来避免轮询。像这样的东西：

```
import win32process
import win32event

# Note: CreateProcess() args are somewhat cryptic, look them up on MSDN
proc1, thread1, pid1, tid1 = win32process.CreateProcess(...)
proc2, thread2, pid2, tid2 = win32process.CreateProcess(...)
thread1.close()
thread2.close()

processes = {proc1: "proc1", proc2: "proc2"}

while processes:
    handles = processes.keys()
    # Note: WaitForMultipleObjects() supports at most 64 processes at a time
    index = win32event.WaitForMultipleObjects(handles, False, win32event.INFINITE)
    finished = handles[index]
    exitcode = win32process.GetExitCodeProcess(finished)
    procname = processes.pop(finished)
    finished.close()
    print "Subprocess %s finished with exit code %d" % (procname, exitcode) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-29T19:17:31.900

您可以使用[psutil](https://code.google.com/p/psutil/)：

```
>>> import subprocess
>>> import psutil
>>> 
>>> proc1 = subprocess.Popen(['python','mytest.py'])
>>> proc2 = subprocess.Popen(['python','mytest.py'])    
>>> ls = [psutil.Process(proc1.pid), psutil.Process(proc2.pid)]
>>>
>>> gone, alive = psutil.wait_procs(ls, timeout=3) 
```

'gone' 和 'alive' 是指示哪些进程已经消失以及哪些进程仍然存在的列表。

或者，您可以指定一个回调，该回调在每次被监视进程之一终止时被调用：

```
>>> def on_terminate(proc):
...     print "%s terminated" % proc
...
>>> gone, alive = psutil.wait_procs(ls, timeout=3, callback=on_terminate) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-11-14T09:57:59.927

你可以使用[psutil](https://psutil.readthedocs.io/en/latest/)

```
import psutil

with psutil.Popen(["python", "mytest.py"]) as proc1, psutil.Popen(
    ["python", "mytest.py"]
) as proc2:
    gone, alive = psutil.wait_procs([proc1, proc2], timeout=3) 
```

'gone' 和 'alive' 是指示哪些进程已经消失以及哪些进程仍然存在的列表。

或者，您可以指定一个回调，该回调在每次被监视进程之一终止时被调用：

```
def on_terminate(proc):
    print "%s terminated" % proc

gone, alive = psutil.wait_procs(ls, timeout=3, callback=on_terminate) 
```

# asp-classic - 许可网站 - 它是如何工作的？

> ID：100629
> 
> 赞同：0
> 
> 时间：2008-09-19T09:04:32.013
> 
> 标签：asp-classic, licensing

我一直在查看几个提供“链接软件”许可形式的网站，您可以在其中免费获得该网站，但需要保留所有指向开发人员网站的链接。购买许可证密钥并将其添加到站点（在数据库或某种形式的配置文件中）会删除这些链接。

我想知道是否有人有过运行这样的系统的经验，特别是如何生成和检查许可证密钥？我正在考虑将类似的模型应用于我正在处理的事情，因此“经典”ASP 中的任何示例都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T09:07:44.920

通常，许可证使用公钥系统工作。您的许可证字符串只是一些信息（例如，可能包含有关此许可证对哪个域名有效的信息），由您的私钥签名。Web 应用程序包含公钥，用于检查签名的有效性。

我敢肯定还有其他方法，但这似乎是我所知道的更强大的方法之一。:-)

我没有用 ASP 编写任何代码，所以我没有给你的例子，对不起。

# mysql - Ruby on Rails 中的“MySQL 服务器已经消失”

> ID：100631
> 
> 赞同：42
> 
> 时间：2008-09-19T09:06:01.930
> 
> 标签：mysql, ruby-on-rails

在我们的 Ruby on Rails 应用程序运行一段时间后，它开始抛出 500s 并显示“MySQL 服务器已消失”。这通常在一夜之间发生。它最近开始这样做，我们的服务器配置没有明显变化。

```
 Mysql::Error: MySQL server has gone away: SELECT * FROM `widgets` 
```

重新启动杂种（不是 MySQL 服务器）修复它。

我们如何解决这个问题？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-07-24T00:13:18.350

Ruby on Rails 2.3 为您的数据库连接提供了重新连接选项：

```
production:
  # Your settings
  reconnect: true 
```

看：

*   [*Ruby on Rails 2.3 发行说明*，第 4.8 小节*重新连接 MySQL 连接*](http://guides.rubyonrails.org/2_3_release_notes.html#reconnecting-mysql-connections)。

*   *[重新访问 MySQL 自动重新连接](http://groups.google.com/group/rubyonrails-core/browse_thread/thread/49d2a7e9c96cb9f4?pli=1)*

祝你好运！

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-19T11:42:00.347

这可能是由于与 MySQL 的持久连接消失（如果它发生在一夜之间，可能会超时）并且 Ruby on Rails 无法恢复连接，默认情况下应该这样做：

在文件 vendor/rails/actionpack/lib/action_controller/dispatcher.rb 是代码：

```
if defined?(ActiveRecord)
  before_dispatch { ActiveRecord::Base.verify_active_connections! }
  to_prepare(:activerecord_instantiate_observers) {ActiveRecord::Base.instantiate_observers }
end 
```

该方法`verify_active_connections!`执行几个动作，其中之一是重新创建任何过期的连接。

此错误的最可能原因是这是因为[猴子补丁](https://en.wikipedia.org/wiki/Monkey_patch)已将调度程序重新定义为不调用`verify_active_connections!`，或者`verify_active_connections!`已更改等。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-01-12T12:21:34.037

在 Ruby on Rails 4 中尝试`ActiveRecord::Base.connection.verify!`。验证 ping 服务器并在未连接时重新连接。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-19T12:42:55.143

正如该线程的其他贡献者所说，MySQL 服务器很可能由于不活动而关闭了与您的 Ruby on Rails 应用程序的连接。默认超时为 28800 秒或 8 小时。

```
set-variable = wait_timeout=86400 
```

将此行添加到您`/etc/my.cnf`将超时时间提高到 24 小时 [http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#option_mysqld_wait_timeout](http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#option_mysqld_wait_timeout)。

尽管文档没有说明，但值 0*可能会*完全禁用超时，但您需要进行试验，因为这只是推测。

但是，我知道还有其他三种情况会产生该错误。第一个是 MySQL 服务器正在重新启动。这显然会断开所有连接，但由于 MySQL 客户端是被动的，在您执行下一个查询之前不会注意到这一点。

第二个条件是如果有人从 MySQL 命令行中终止了您的查询，这也会断开连接，因为它可能会使客户端处于未定义状态。

最后一种情况是，如果您的 MySQL 服务器由于致命的内部错误而自行重新启动。也就是说，如果您正在对表进行简单查询并立即看到“MySQL 已消失”，我会仔细查看服务器的日志以检查硬件错误或数据库损坏。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-05-27T17:31:54.230

我在向 MySQL 发送非常大的语句时遇到了这个问题。MySQL 限制语句的大小，如果超出限制，将关闭连接。

```
set global max_allowed_packet = 1048576; # 2^20 bytes (1 MB) was enough in my case 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-07-26T00:03:43.663

首先，确定 MySQL 中的 max_connections：

```
show variables like "max_connections"; 
```

您需要确保在 Ruby on Rails 应用程序中建立的连接数小于允许的最大连接数。请注意，额外的连接可能来自您的[cron](http://en.wikipedia.org/wiki/Cron)作业、delayed_job 进程（每个进程在您的 中具有相同的池大小`database.yml`）等。

通过在 MySQL 中执行以下操作，在您通过应用程序、运行进程等时监控 SQL 连接：

```
show status where variable_name = 'Threads_connected'; 
```

您可能需要考虑在`Thread`完成执行后关闭连接，因为数据库连接不会自动关闭（我认为这对于 Ruby on Rails 4 应用程序[Reaper](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract/connection_pool.rb)来说不是问题）：

```
Thread.new do
  begin
     # Thread work here
  ensure
     begin
        if (ActiveRecord::Base.connection && ActiveRecord::Base.connection.active?)
           ActiveRecord::Base.connection.close
        end
      rescue
      end
  end
end 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T09:20:14.533

与 MySQL 服务器的连接可能超时。

您应该能够增加 MySQL 中的超时时间，但要进行适当的修复，请让您的代码检查数据库连接是否仍然存在，如果不是则重新连接。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-19T09:24:07.223

您是否监控打开的 MySQL 连接或线程的数量？max_connections 的 mysql.ini 设置是什么？

```
mysql> show status; 
```

查看 Connections、Max_used_connections、Threads_connected 和 Threads_created。

您可能需要增加 MySQL 配置中的限制，或者 rails 没有正确关闭连接*。

*注意：我只是简单地使用过 Ruby on Rails...*

服务器状态的 MySQL 文档位于[http://dev.mysql.com/doc/refman/5.0/en/server-status-variables.html](http://dev.mysql.com/doc/refman/5.0/en/server-status-variables.html)中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-09-28T16:53:32.350

在 database.yml 中使用 reconnect: true 将导致在引发 ActiveRecord::StatementInvalid 错误后重新建立数据库连接（正如 Dave Cheney 所提到的）。

不幸的是，似乎有必要在数据库操作上添加重试以防止连接超时：

```
begin
  do_some_active_record_operation
rescue ActiveRecord::StatementInvalid => e
  Rails.logger.debug("Got statement invalid #{e.message} ... trying again")
  # Second attempt, now that db connection is re-established
  do_some_active_record_operation
end 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-11-22T01:08:49.130

`mysql2`我在使用gem的 Ruby on Rails 3 应用程序中遇到了这个问题。我复制了有问题的查询并尝试直接在 MySQL 中运行它，我得到了同样的错误，“MySQL 服务器已消失。”。

有问题的查询非常非常大。一个非常大的插入 (+1 MB)。我试图插入的字段是 TEXT 列，它们的最大大小为 64 KB。连接没有抛出错误，而是消失了。

我增加了字段的大小并得到了同样的结果，所以我仍然不确定确切的问题是什么。关键是由于一些奇怪的查询，它在数据库中。反正！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-03-07T10:42:10.657

其他要检查的是 Unicorn 配置是否正确。在此处查看 ActiveRecord 连接的 before_fork 和 after_fork 处理：[https ://gist.github.com/nebiros/2776085#file-unicorn-rb](https://gist.github.com/nebiros/2776085#file-unicorn-rb)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-05-18T15:57:38.013

### 在 Rails 中分叉时。

对于在 Rails 中分叉时遇到此问题的任何人，请尝试在分叉之前清除现有连接，然后为每个分叉建立新连接，如下所示：

```
# Clear existing connections before forking to ensure they do not get inherited.
::ActiveRecord::Base.clear_all_connections! 

fork do
  # Establish a new connection for each fork.
  ::ActiveRecord::Base.establish_connection 

  # The rest of the code for each fork...
end 
```

在此处查看此 StackOverflow 答案：[https ://stackoverflow.com/a/8915353/293280](https://stackoverflow.com/a/8915353/293280)

# language-agnostic - 为什么不在同一行声明多个相同类型的变量？

> ID：100633
> 
> 赞同：16
> 
> 时间：2008-09-19T09:06:16.533
> 
> 标签：language-agnostic, refactoring, conventions

为什么在一行上声明变量是不好的做法？

例如

```
private String var1, var2, var3 
```

代替：

```
private String var1;
private String var2;
private String var3; 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-19T09:09:31.983

在我看来，将每个变量放在单独的行上的主要目标是促进版本控制工具的工作。

如果多个变量在同一行，则可能会因不同开发人员的不相关修改而发生冲突。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-19T09:13:15.313

在 C++ 中：

```
int * i, j; 
```

i 是 int * 类型，j 是 int 类型。这种区别太容易被忽略了。

除了将它们放在一行之外，以后可以更轻松地添加一些评论

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-19T09:13:28.747

我认为有多种原因，但都归结为第一个原因是可读性较差且更容易失败，因为一行代码在做不止一件事。

所有这一切都没有真正的收获，难道你不告诉我你发现两行节省的空间是真正的收获。

这与您拥有时发生的事情类似

```
if ((foo = some_function()) == 0) {
    //do something
} 
```

当然，这个例子比你的要糟糕得多。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-19T09:16:34.043

在 C/C++ 中，您还有一个问题，即用于指示指针类型的 * 仅适用于紧随其后的标识符。因此，没有经验的开发人员的一个相当常见的错误是编写

```
int* var1, var2, var3; 
```

并期望所有三个变量都是“int指针”类型，而对于编译器来说，这读作

```
int* var1;
int var2;
int var3; 
```

仅使 var1 成为指针。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-19T09:11:50.840

使用单独的行，您有机会在描述变量使用的每一行上添加注释（如果从名称中不清楚）。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-19T09:06:59.417

因为在某些语言中，示例中的 var2 和 var3*不是*字符串，它们将是变体（无类型）。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-19T09:23:56.350

为什么这是不好的做法？只要您的代码仍然可读，我认为不是。

```
//not much use
int i, j, k;

//better
int counter, 
    childCounter, 
    percentComplete; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-19T09:15:57.397

老实说，我并不反对。我认为将类似的变量分组在同一行上是完全可行的，例如

浮动 fMin, fMax;

但是，当变量不相关时，我会避开，例如

int iBalance, iColor;

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-19T10:00:14.437

关联。

仅仅因为两个变量是 String 类型并不意味着它们彼此密切相关。

如果两个（或更多）变量通过函数而不是变量类型密切相关，那么也许它们可以一起声明。即，只有当您的程序的读者可以同时看到这两个变量时，才应该将它们实际放在一起

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-19T09:12:19.090

以下是我的理由：

*   可读性，如果您知道每行只有一个，则更容易发现
*   版本控制，更少的行内更改，更多的单行添加、更改或删除，更容易从一个分支合并到另一个分支

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-19T09:18:15.210

情况如何，例如：

```
public static final int NORTH = 0,
                        EAST = 1,
                        SOUTH = 2,
                        WEST = 3; 
```

这也被认为是不好的做法吗？我认为这可以，因为它反驳了之前提出的一些观点：

*   它们肯定都是相同的类型（在我的静态类型 Java 世界中）
*   可以为每个添加评论
*   如果你必须改变一个的类型，你可能必须为所有的，所有四个都可以在一个变化中完成

所以在一个（尽管代码很臭）的例子中，你有理由不这样做吗？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T09:10:38.330

同意 edg，也因为将每个变量放在单独的行上更具可读性和易于维护。您会立即看到类型、范围和其他修饰符，并且当您更改修饰符时，它仅适用于您想要的变量 - 这样可以避免错误。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-19T09:16:22.857

1.  在使用版本控制工具时对您更加明显（由 Michel 介绍）
2.  当您遇到最简单的上溢/下溢或编译错误并且您的眼睛无法指出明显的错误时，让您更具可读性
3.  捍卫相反（即多变量单行声明）的优点较少（“代码文本垂直可见性”是单例）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T09:18:19.437

当您可以并且想要在减速时初始化变量时，这是一种不好的做法。这可能不是那么糟糕的一个例子是：

```
string a,b;
if (Foo())
{
  a = "Something";
  b = "Something else";
}
else
{
  a = "Some other thing";
  b = "Out of examples";
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-19T09:43:45.677

一般来说，出于其他人讨论的版本控制和评论原因，我会在 95% 的情况下应用它。但是在某些情况下它确实有意义，例如，如果我正在编写图形并且我想要几个变量来表示纹理坐标（通常按约定引用为 s 和 t），那么将它们声明为

整数 s, t; // 纹理坐标

恕我直言，通过缩短代码和明确这两个变量属于一起来增强代码的可读性（当然有些人会主张在这种情况下使用单点类变量）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-08-22T09:59:29.430

在尝试这个问题时[https://www.interviewbit.com/problems/remove-element-from-array/](https://www.interviewbit.com/problems/remove-element-from-array/)

方法 1 给出了超出此代码的内存限制：

类型 1：

```
int i,j; 
```

类型 2：

```
int i;
int j; 
```

类型 1：超出内存限制

```
int removeElement  (int* A, int n1, int B) 
{
    int k=0, i;
    for(i=0;i<n1;i++)
        if(A[i]!=B)
        {
            A[k]=A[i];
            k++;
        }    
    return k;
} 
```

而类型 2 工作得很好

```
int removeElement  (int* A, int n1, int B) 
{
    int k=0;
    int i;
    for(i=0;i<n1;i++)
        if(A[i]!=B)
        {
            A[k]=A[i];
            k++;
        }    
    return k;
} 
```

# javascript - 计算 Javascript 的圈复杂度

> ID：100645
> 
> 赞同：51
> 
> 时间：2008-09-19T09:08:00.927
> 
> 标签：javascript, metrics, cyclomatic-complexity

是否有任何工具可用于计算 Javascript 中的圈复杂度？

过去在处理服务器端代码时，我发现它是一个非常有用的指标，并且希望能够将它用于我编写的客户端 Javascript。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-19T12:06:02.897

我帮助编写了一个工具来对 JavaScript 项目执行软件复杂性分析：

[复杂性报告](https://github.com/escomplex/complexity-report)

它报告了一系列不同的复杂度指标：代码行数、参数数量、圈复杂度、圈密度、Halstead 复杂度度量、可维护性指数、一阶密度、变更成本和核心大小。

它是在 MIT 许可下发布的，并使用 Node.js 和[Esprima](http://esprima.org/) JavaScript 解析器构建。它可以通过 npm 安装，如下所示：

```
npm i -g complexity-report 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-04-08T06:58:24.737

为了答案的完整性，我前段时间一直在寻找相同的工具，但没有找到任何适合可视化的工具，所以我写了[plato](http://github.com/jsoverson/plato)

示例报告：

*   [jQuery](http://jsoverson.github.com/plato/examples/jquery/)
*   [咕哝](http://jsoverson.github.com/plato/examples/grunt/)
*   [木偶](http://jsoverson.github.com/plato/examples/marionette/)

它使用 phil 的复杂性报告（上面提到过）并且还从 jshint （最终，其他）聚合数据。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-04-04T15:38:41.887

[JSHint](https://jshint.com/about/)最近[增加了](https://github.com/jshint/jshint/pull/593)对计算代码指标的支持。

您可以为以下各项设置最大值：

*   [`maxparams`](https://jshint.com/docs/options/#maxparams)- 允许的形式参数的数量
*   [`maxdepth`](https://jshint.com/docs/options/#maxdepth)- 代码块的嵌套深度应该是多少
*   [`maxstatements`](https://jshint.com/docs/options/#maxstatements)- 每个函数允许的语句数
*   [`maxcomplexity`](https://jshint.com/docs/options/#maxcomplexity)- 最大圈复杂度

### 例子

*每个函数允许的最大形式参数数*

```
/*jshint maxparams:3 */

function login(request, onSuccess) {
  // ...
}

// JSHint: Too many parameters per function (4).
function logout(request, isManual, whereAmI, onSuccess) {
  // ...
} 
```

*每个函数允许的最大嵌套代码块数*

```
/*jshint maxdepth:2 */

function main(meaning) {
  var day = true;

  if (meaning === 42) {
    while (day) {
      shuffle();

      if (tired) { // JSHint: Blocks are nested too deeply (3).
          sleep();
      }
    }
  }
} 
```

*每个函数允许的最大语句数*

```
/*jshint maxstatements:4 */

function main() {
  var i = 0;
  var j = 0;

  // Function declarations count as one statement. Their bodies
  // don't get taken into account for the outer function.
  function inner() {
    var i2 = 1;
    var j2 = 1;

    return i2 + j2;
  }

  j = i + j;
  return j; // JSHint: Too many statements per function. (5)
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-13T16:28:08.160

由于计算圈复杂度计算关键字“if，switch，while for break”等的数量。每个与C一起使用的工具都可以完成这项工作，比如sourcemonitor： http: [//www.campwoodsw.com/sourcemonitor.html](http://www.campwoodsw.com/sourcemonitor.html)

实际上，在 javascript 上，您尝试修改代码的次数越多，速度就越慢，因此请谨慎对待；)

编辑：我**真的**不明白这个答案发生了什么，我得到了另一个反对意见，当我的回答中我告诉了一个在 javascript 中计算圈复杂度的好工具时，这特别有效。

对于第二个断言，我的评论来自经验，我从来没有告诉过*不要修改你的 js 代码*，我只是告诉你*在做的时候要注意*，因为通常需要权衡速度，当我谈到速度时我的意思是可能会发生 2 种不同的减速：在*下载时*和*执行时*（在像 pda/智能手机这样的慢速设备中，这很重要）。

由于像这样的工具经常驱使开发人员编写更多代码来尽可能地追逐更小的索引，但不幸的是，在 js 中，更多的代码意味着可能会发生减速，并且**过度使用**这些工具是不好的。当然，这些工具可以为您提供可以改进代码的提示**，**但您必须掌握如何使用该工具，而不是盲目地依赖它。

因此，如果您再次对我投反对票，请在评论中解释您这样做的原因，讨论只能从中受益，谢谢您，对发泄感到抱歉。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-10-07T08:01:09.400

新版[http://jshint.com](http://jshint.com)出来了，有一个很好的圈复杂度计算器

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-08-06T18:12:24.073

您可以使用来自[blunck.info 的 ARCHIVE](https://web.archive.org/web/20150219013605/http://www.blunck.info/ccm.html)或 github repo [jonasblunck/ccm的 ccm 工具](https://github.com/jonasblunck/ccm)

它支持 JavaScript、C/C++ 和 C#。它是免费的，在 Windows 上运行（也可以在 Linux 和 Mac OS X 上运行 - 使用 Mono 框架）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-28T08:20:10.003

现在还有 Yardstick：[https ://github.com/calmh/yardstick](https://github.com/calmh/yardstick)

它尝试计算惯用 Javascript 的圈复杂度，处理比 jscheckstyle 更多的案例。

# c# - 为什么有些 wav 文件可以在我的 c# directsound 应用程序中播放，而有些则不能？

> ID：100654
> 
> 赞同：3
> 
> 时间：2008-09-19T09:10:44.477
> 
> 标签：c#, audio, directx, directsound

我有一个 ac# 应用程序，可以通过 directsound 播放简单的 wav 文件。使用我拥有的测试数据，代码运行良好。但是，当我使用真实世界的数据时，它在创建辅助缓冲区时产生了一个非常无用的错误：“ArgumentException：值不在预期范围内。”

测试 wav 具有 512kbps 的比特率、16bit 的音频采样大小和 32kHz 的音频采样率。新的 wav 分别为 1152kbps、24bit 和 48kHz。如何让 Directsound 处理这些较大的值，或者如果不是，我如何在尝试播放文件之前以编程方式检测这些值？

它是我正在使用的托管 DirectX v9.00.1126，我在下面包含了一些示例代码：

```
using DS = Microsoft.DirectX.DirectSound;  
...  
DS.Device device = new DS.Device();
device.SetCooperativeLevel(this, CooperativeLevel.Normal);  
...
BufferDescription bufferDesc = new BufferDescription();
bufferDesc.ControlEffects = false;  
...
try
{
    SecondaryBuffer sound = new SecondaryBuffer(path, bufferDesc, device);
    sound.Play(0, BufferPlayFlags.Default);
}
... 
```

附加信息：真实世界的 wav 文件也不会在 windows 媒体播放器中播放，告诉我需要编解码器才能播放文件，而它们在 winamp 中播放正常。

附加信息 2：比较工作测试数据和不良真实数据的字节，我可以看到在 RIFF 块之后，不良数据有一个“bext”块，互联网告诉我是与广播相关的元数据音频扩展，而测试数据直接进入 fmt 块。/is/ 坏数据中有一个 fmt 块，所以我不知道它是否格式错误，或者加载程序是否应该进一步寻找 fmt 数据。我可以看看我是否可以从向我提供数据的人那里获得有关此 rouge bext 块的一些信息 - 如果他们可以删除它，我的代码可能仍然有效。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T09:16:35.150

并非所有声卡都支持 24 位采样播放，即使支持，它们通常也必须在该模式下以独占方式打开。采样率也有类似的问题。您的声卡可能以 44.1kHz 运行，在这种情况下，需要重新采样 48kHz 才能播放。

[我编写了一个名为NAudio](http://www.codeplex.com/naudio)的开源 .NET 音频库，它可以让您找出给定 WAV 文件的采样率和位深度。它还提供了播放音频的替代方法（例如，通过 Wav...API），以及使用 DMO 重采样器对象对文件进行重采样的能力。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T09:23:46.927

除了采样问题，WAV 只是一种容器格式，音频可以被压缩成无数音频格式中的任何一种（就像 AVI 是视频的容器一样）。因此，您可以使用像[GSpot](http://www.headbands.com/gspot/download.html)这样的工具来确定您的 WAV 是否​​以非标准格式编码并安装编解码器。Winamp 默认安装的编解码器比 WMP 多，这可以解释 Winamp 播放它而 WMP 不播放。

# javascript - 计算 Javascript 每种方法的平均代码行数

> ID：100661
> 
> 赞同：2
> 
> 时间：2008-09-19T09:12:34.473
> 
> 标签：javascript, metrics

是否有任何工具可用于计算**每种方法的平均代码行数**？

我想知道每种方法的平均大小，而不仅仅是项目中的总行数。每个方法计数将使我能够衡量每种方法的简单程度。

这将作为构建过程的一部分进行计算，并显示在仪表板上。这个想法是我们可以看到每种方法的平均大小是否在增加。这将标志着代码复杂性正在增加的可能性，我们可能需要考虑重构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T10:03:48.330

在您的项目中进行递归“for(i in this)”搜索，如果对象 (i) 是一个函数，则调用“test.toString().split("\n").length”。这会计算函数中换行符的数量。如果它不是函数，而是对象，则在该对象中调用此函数。还要计算你找到的函数的数量，然后用换行符的总数除以函数的总数，然后你就有了平均值。

**编辑**

```
function calculateMethodSize(obj){
  var fcount = 0;
  var fsize = 0;
  for(i in obj){
    if(obj[i] instanceof Function){
      fcount++;
      fsize += obj[i].toString().split(";\n").length;
    }else if(obj[i] instanceof Object){
      var ret = calculateMethodSize(obj[i]);
      fcount += ret.fcount;
      fsize += ret.fsize;
    }
  }
  return {fsize:fsize, fcount:fcount};
}
var data = calculateMethodSize(this);
var average = data.fsize / data.fcount; 
```

不过要小心运行此代码。如果你用这个运行它，就像我所做的那样，那么你可能会遇到堆栈溢出（我做过）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T09:35:31.780

short fast and dirty : grep for ";"，计算行数，这会给你一个语句数的估计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-16T04:23:44.900

您可能还想了解其他指标。无论如何计算行数，只要确保它不会面对没有“function”关键字或花括号定义的函数。现实世界的例子：

```
var negate = bind1st(compose, not); 
```

（这里的 negate 是从函数 bind1st、compose 和 not 构建的函数）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T14:40:23.677

将行定义为“\n”或“;”，

您可以尝试一个简单的算法，如下所示：

```
FOR each line in a javascript file (or chunk of text)
    IF the line starts with "function " THEN
        PUSH the first left-curly brace you find onto a stack
        WHILE the stack is non-empty
            PUSH any left-curly braces in the current line
            POP any left-curly braces when you encounter a right-curly brace
            Increment your line-count by 1
            Increment your line counter (as mentioned in the FOR loop above)
        END WHILE
        Store your total lines for this function            
     ELSE
         //ignore the line because it's probably a global var or blank
     END IF
END FOR 
```

我不知道可以自动执行此操作的工具。但是，尝试自己制作一个会很有趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T09:33:51.800

我不确定它是否这样做，但是在您之前的帖子之后搜索什么是圈复杂度，我去了指向[代码分析器](http://www.geocities.com/sivaram_subr/codeanalyzer/description.htm "代码分析器")的相关维基百科页面。他们在那里说：

> 在计算 HTML 或 JSP 文件时，它将正确计算嵌入在 <script> 标记中的 javascript 和 vbscript 代码的 LoC。

我不知道这个计数是否按方法分派，但可能值得一看（它是一个免费工具）。

# c++ - ：：发信息（ ）

> ID：100678
> 
> 赞同：1
> 
> 时间：2008-09-19T09:17:18.207
> 
> 标签：c++, winapi

```
LRESULT result = ::SendMessage(hWnd, s_MaxGetTaskInterface, (WPARAM)&pUnkReturn, 0); 
```

调用后result的值为0

我希望它返回一个有效的 pUnkReturn 值，但它返回一个 NULL 值。

此电话之前的必要信息：

```
const UINT CMotionUtils::s_MaxGetTaskInterface =  RegisterWindowMessage(_T("NI:Max:GetTaskInterface")); 
```

i get here的值`s_MaxGetTaskInterface`是 49896 。

hWnd 的值也是合适的。我用 Spy++（Visual Studio 工具）检查了这一点。

Microft Spy++ 消息窗口显示了此窗口的以下内容。

```
<00001> 009F067C S message:0xC2E8 [Registered:"NI:Max:GetTaskInterface"]wParam:0224C2D0 lParam:00000000
<00002> 009F067C S message:0xC2E8 [Registered:"NI:Max:GetTaskInterface"]lResult:00000000 
```

请帮助我在通话后获取存储在 pUnkReturn 中的有效地址。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T17:04:53.807

目标 hWnd 是否在同一进程中？如果没有，您将无法通过消息传递（或返回）指针。请注意，Windows 实现了内置消息的编组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T10:37:23.007

我认为 &pUnkReturn 中的 & 是必要的，基于匈牙利语前缀。我希望 pUnkReturn 的类型为 IUnknown*。消息接收者将提供 IUnknown*。它将存储 IUnknown* 的地址是 IUnknown**。因此，此代码传入 &pUnkReturn 并且消息接收者写入 *(IUnknown**)wParam。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T17:52:56.533

问题不在于您如何调用 SendMessage()。问题在于您对“NI:Max:GetTaskInterface”注册消息的消息处理程序的实现。

SendMessage() 返回的值与从消息处理程序返回的值相同。如果您需要 pUnkReturn 成为 out-val，那么您的消息处理程序必须填充它。

让我们看看您的消息处理程序的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T10:28:58.143

您需要告诉我们它是什么`pUnkReturn`以及它是如何定义的。

您还需要告诉我们 s_MaxGetTaskInterface 的处理程序期望什么。

如果您希望处理程序填充 pUnkReturn 指向的任何内容，那么您将需要使用 (WPARAM)pUnkReturn 调用 SendMessage，但是如果处理程序返回一个指针，则按照您现在的方式调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T09:21:39.973

当我用谷歌搜索时，`NI:Max:GetTaskInterface`我找不到任何东西。一般来说，窗口如何处理给定的消息完全取决于相关的窗口。窗口（由 指定`hWnd`）是否支持`NI:Max:GetTaskInterface`消息？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T09:23:47.690

您将不得不提供更多信息 - 什么是“GetTaskInterface”（Google 未提供任何结果）。SendMessage 将返回处理消息“s_MaxGetTaskInterface”的 WndProc 返回的任何值。如果不处理，您将得到零，并且您的指针仍将为 NULL。

# asp.net - 菜单控件：如何使整个项目可点击，而不仅仅是文本

> ID：100689
> 
> 赞同：1
> 
> 时间：2008-09-19T09:21:06.713
> 
> 标签：asp.net

我有一个让我的用户感到困惑的问题，尽管当用户将鼠标悬停在项目上时（通过悬停样式）突出显示项目，但他们必须将鼠标悬停在实际项目文本上，有时与项目相比非常小。有没有办法使整个项目可点击？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T09:24:18.610

向 A 元素添加一些填充？或者，如果它位于块级元素中包含的菜单中，则将 A 也显示为块：

```
a {
  display: block;
  width: 100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T09:32:05.317

如果您只有 <a> ... </a> 中的文本，那是唯一可以点击的部分。在链接内移动您的图形等。

# c# - 迁移到 ASP.NET - VB 还是 C#？

> ID：100691
> 
> 赞同：3
> 
> 时间：2008-09-19T09:21:38.243
> 
> 标签：c#, .net, asp.net, vb.net, webforms

我们有一个大型的 ASP 经典代码库，但我希望在 ASP.NET 中进行未来的开发（并且可能在我们拥有的未来移植中）。语言的自然选择似乎是 VB（现有代码是 VBScript），但我是不是太仓促了？从长远来看，语言的选择是否会产生影响？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-19T09:25:46.017

学习.Net（框架）需要时间。

具体的语言无关紧要，更多的是品味问题。我通常建议尝试两种语言的一些游戏项目（以及任何其他可能让你喜欢的项目），然后决定你更喜欢哪一个（或者更成功！）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-19T12:35:35.880

首先，不要为了它而移植一些东西。如果它工作正常并且移植它没有什么好处，那就别管它，继续在 VBScript 中进行错误修复和小改进。如果有足够的理由进行迁移，那么就在那时进行，但是如果您预先进行移植，您最好先熟悉 Web 应用程序的 .Net 版本，而不是尝试即时学习。在“干净”的环境中学习 PostBack 和 ViewState 等新概念要容易得多。

当你移植东西时，打破旧思维方式的空间也更小（只是让它以任何旧方式工作，而不是在需要的地方重新设计）。

最终，从长远来看并没有太大的区别，这主要是感性的和个人品味的问题，但我建议首先学习 C#，因为它缺乏熟悉度会强调你正在学习新东西的事实。希望这将帮助您学习以自然的 .Net 方式而不是主要程序化的 VB（脚本）方式来做事。你试图忘记和学习。熟悉某些关键字会对您不利。

在一些帖子中呼应其他好处，并添加一些我自己的：

*   未来的潜在收益：由于感知差异，C# 开发人员通常比 VB.Net 开发人员更有价值。
*   大多数开源 .Net 代码都是 C#，它的质量通常（尽管并非总是）往往更高。
*   互联网上的 C# 问答和示例比 VB.Net 更多。在我发布这篇文章时，有**1572**篇用 C# 标记的帖子，只有**185**篇用 VB.Net 标记在 Stack OverFlow 上。
*   C# OO 关键字是相当标准的，它使阅读其他 OO 语言代码更容易。VB.Net 无缘无故地重新命名，例如*抽象*（C#、C++、Java 等）与*MustInherit*（仅限 VB.Net）。
*   人们普遍认为，一旦您熟悉这两种语言，直观地解析 C# 代码比 VB.Net 代码容易得多
*   你不会被 C#'ers '看不起'，并且可以帮助取笑 VB.Net 的人（如果你愿意 - 文化存在......）

一旦您最初在 C# 中学习了它，那么转入 VB.Net 应该比反过来更容易。投资于自己的未来。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-19T09:57:15.833

当我从 ASP3 迁移到 ASP.NET 时，我最终选择使用 C# 而不是 VB.NET。

我写了很多年的基础知识（MS-BAsic、GW-Basic、Quick-Basic、Visual Basic、VBScript），使用 VB.NET 非常困难，因为我总是尝试像以前使用 VB6 或 VBScript 那样编写东西。

所以 C# 对我来说是一个更好的选择：我并没有因为习惯的重量而放慢脚步。

此外，C# 是一门新语言（此时），而新的 VB.NET 关键字给他带来了 Cobol 的味道 :)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-24T21:37:48.803

此外，不要忘记您可以在项目中混合搭配！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-19T09:28:57.867

我会选择语法你最熟悉的语言，因为在功能上几乎没有区别，尽管有人说 VB 和 c# 开发人员之间存在文化差异。另一种选择是两者都学习，在我看来，迁移到 .net 的最大障碍是学习庞大的 .net 框架，你应该能够很快掌握实际的语言语法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-09T07:08:39.370

重要的是学习.NET。不是一种特定的语言，因为 C# 或 VB 只改变了语法。它们在 .NET 环境中的逻辑是相同的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-19T09:24:34.740

您可以在 C# 或 VB.NET 中执行相同的操作。最后，它会是一个更容易移植的选择。

请记住，您不应该（恕我直言）将 ASP 直接移植到 ASP.NET，因为您会丢失 .NET 中的许多功能，无论如何这将包括相当多的重写。所以我会选择 C#，因为我认为它不那么冗长，更容易编写和阅读。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-19T09:31:44.630

.NET 实际上是关于框架和基类库的。VB 或 C# - 正如 Chris 所说，实际上只是语法上的差异。

由于您已经完成了 VBScript 向 VB.NET 的迁移，因此更自然 - 您可以学习新语法，然后转到 Framework 和 BCL，当您熟悉这些时，您可以学习 C# 语法 - 双语是总是好的。

2sontek：VB 中还有一些 C# 不支持的功能——我们不要去那里。80%（或更多）的开发人员只使用了 20% 的功能，并且差异非常小——他们当然不适合 20%

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-27T22:40:20.873

我在两者中都进行了开发，但 C# 将是我的首选。

你可以用两种语言做大部分事情，我当然不会用 c# 重新编写任何 vb 项目。

但是对于 C#：新的语言特性通常首先出现在 c# 中，例如 linq 中的 lamda 表达式你可以在 c# 中编写代码 C# 将迫使你变得更整洁 C# 开发人员平均获得更多报酬，大多数大型项目只会是 c# C# 有类似的javascript 的语法和函数名称 .net 社区对 vb 开发人员有些势利

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-19T09:23:29.017

差别不大，但有一些差别（主要是语法性质的）。如果您的旧站点是 VBScript，那么使用 VB.NET 可能更容易。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-19T09:25:11.417

C# 3.5 中的一些功能在 Visual Basic 中不受支持，但语言选择始终是团队的偏好以及你们觉得最有效率的东西。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-19T09:31:15.130

从经验来看，最容易掌握您当前技能的位置。如果这是在 vb6/vbscript 等中，我会首先查看 vb.net。它还取决于任何项目的时间表和交付日期。您将在 vb.net 中更快地掌握速度。如果你有时间我会认真考虑c#，如果只是为了在你来寻找新的牧场时让你在开发市场上站稳脚跟。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-19T09:32:11.337

您可能还想研究 C#。

VB.Net 和 C# 都非常适合创建 Web 应用程序，这实际上取决于您的需求。

例如，C# 擅长处理事件，而 VB.Net 擅长处理 XML。

我会说你的开发人员觉得更舒服。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-19T09:32:14.910

我最近在看一个网站，该网站列出了基于技术的英国平均工资。现在找不到链接（典型！），但我记得 C# 的平均工资比 VB.NET 的平均工资高出大约 5000 英镑。

如果您不打算同时学习两者（实际上没有理由不学习，因为它们之间唯一真正的区别是语法）我会选择 C#。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-08-22T08:31:34.737

.net 或 c# 由您决定如何解决问题以及什么让您更有创造力。但我认为.net 将被删除，c# 将是唯一可以在 asp 中使用的语言。我开始学习 .net 概念，然后在我将我的语言更改为 c# for asp.net mvc 之后，所以我建议你必须去 c#，因为它将来对你有更多帮助。

# .net - WSDL.exe 的位置

> ID：100705
> 
> 赞同：27
> 
> 时间：2008-09-19T09:24:18.500
> 
> 标签：.net, web-services, sdk, wsdl

我最近听说过 WSDL.Exe，但我不知道在哪里可以找到这个程序。有谁知道我在哪里可以找到或下载它？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2011-06-05T15:14:49.397

如果有人使用 VS 2008 (.NET 3.5) 也在寻找 wsdl.exe。我在这里找到了它：

C:\Program Files\Microsoft SDKs\Windows\v6.0A\bin\wsdl.exe

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2015-01-27T16:05:34.503

在我的 Windows 7 机器上，它在这里：

C:\Program Files (x86)\Microsoft SDKs\Windows\v8.1A\bin\NETFX 4.5.1 工具

请注意，文件 wsdl.exe 是可移植的，因为您可以将其复制到另一台 Windows 机器并且它可以工作。我还没有尝试查看 4.5 exe 是否可以在只有 .NET 2.0 的机器上运行，但这会很有趣。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-09-19T09:42:58.380

您将在 Visual Studio 安装（如果包含 SDK）或独立 SDK 安装中获得它。它会生活在类似的地方`C:\program files\Microsoft Visual Studio 8\SDK\v2.0\Bin`

如果您还没有，可以从以下位置下载 .NET SDK
[http://msdn.microsoft.com/en-us/netframework/aa569263.aspx](http://msdn.microsoft.com/en-us/netframework/aa569263.aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-09-29T04:11:23.480

C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\wsdl.exe

（通过这个问题：[我在哪里可以找到 WSDL.exe？](https://stackoverflow.com/questions/5953012/where-can-i-find-wsdl-exe)）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-08-29T14:49:50.660

如果您有 Windows 10 和 VS2019，以及 .NET Framework 4.8，您可以在下面看到**WSDL.exe 的位置**

电脑中的路径**C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.8 Tools**

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-06-25T14:43:57.547

如果你有 Windows 10 和 VS2015，你可以在下面看到**WSDL.exe 的位置**

电脑中的路径**C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.7 Tools**

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-01-16T10:13:37.813

C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.6.1 工具

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-09-23T15:57:25.773

您可以通过使用 windows dir 命令在 windows 中找到您想要的内容，使用管理员帐户可以轻松找到：

c:>dir wsdl.exe /s

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T09:27:42.597

它包含在 .NET 中（不确定是否仅在 SDK 中）。

# java - 睡眠和等待线程消耗多少资源

> ID：100707
> 
> 赞同：19
> 
> 时间：2008-09-19T09:24:30.030
> 
> 标签：java, multithreading, sleep, wait

我想知道，在 java 1.6 x64 中有许多线程处于等待状态是多么昂贵。

更具体地说，我正在编写跨多台计算机运行并从一台计算机发送/接收数据的应用程序。我觉得为每台连接的机器和任务设置单独的线程会更舒服，比如 1) 发送数据，2) 接收数据，3) 在连接断开时重新建立连接。因此，假设集群中有 N 个节点，每台机器将为 N-1 个邻居中的每一个拥有 3 个线程。通常会有 12 台机器，相当于 33 个通信线程。

这些线程中的大多数大部分时间都在休眠，因此出于优化目的，我可以减少线程数量并为每个线程分配更多工作。比如，例如。重新建立连接是接收线程的责任。或者发送到所有连接的机器是由单线程完成的。

那么拥有许多睡眠线程是否会对性能产生重大影响？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-19T09:34:09.587

在大多数情况下，休眠线程消耗的资源将是它的堆栈空间。使用 2-threads-per-connection-model（我认为这与您所描述的类似）已知会在连接数量变大时导致很大的可伸缩性问题。

我自己也遇到过这种情况，当连接数超过 500 个连接（大约 1000 个线程）时，您往往会遇到很多出现 OutOfMemoryError 的情况，因为线程堆栈空间使用量超过了最大数量单个进程的内存。至少在我们的案例中，它是在 32 位 Windows 世界上的 Java 中。我猜你可以调整一些东西并走得更远，但最终它只是不是很可扩展，因为你浪费了大量的内存。

如果您需要大量连接，Java NIO（新 IO 或其他）是可行的方法，可以在同一个线程中处理大量连接。

话虽如此，在一个相当现代的服务器上，你不应该遇到少于 100 个线程的问题，即使它可能仍然是资源的浪费。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T10:56:32.990

在我们切换到 NIO 之前，我们遇到了非常相似的问题，所以我将支持 Liedmans 的建议以使用该框架。你应该可以找到一个教程，但如果你想了解详细信息，我可以推荐Ron Hitchens 的[Java NIO](https://rads.stackoverflow.com/amzn/click/com/0596002882)。

切换到 NIO 增加了我们可以处理的连接数量，这对我们来说非常重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T09:40:25.937

这不会很好地扩展。拥有大量线程意味着 VM 必须花费更多时间进行上下文切换，并且由于每个线程都需要自己的堆栈空间，因此内存使用率会更高。以管道方式处理较少数量的线程会更好，或者将线程池与异步技术一起使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T10:33:14.107

大量线程等同于大量堆栈空间，这会占用您的内存 - 检查您的 -Xss 设置以了解多少，然后进行数学计算。

而且，如果您出于某种原因必须执行 notifyAll() ，那么您当然会唤醒大量额外的线程 - 尽管您可能不需要在建议的架构中这样做。

我不确定您是否可以轻松避免在此模型中每个侦听套接字有一个线程（尽管我对 NIO 知之甚少 - 这甚至可能解决该问题），但请查看[java.util.concurrent.Executor](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Executor.html)接口和它的实现类以一种体面的方式来避免有太多额外的线程挂起。事实上，这`ThreadPoolExecutor`也可能是管理监听线程的好方法，因此您不会花费太多时间不必要地创建和销毁线程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-29T09:55:52.817

根据我在 C、Lua 和 Python 中所做的测试，您可以使用非常少的代码行来创建自己的睡眠或等待函数，从而创建一个简单的轻量级循环。使用带有您想要到达的未来时间的局部变量，然后在 while 循环中测试当前时间戳。如果您在使用 fps 的范围内，请让等待函数每帧运行一次以节省资源。您需要的精度越高，请考虑使用时钟而不是时间戳，因为时间戳限制为秒。您添加到等待函数中的代码行越多，它变得越不精确并且消耗的资源越多，尽管任何低于 10 行的代码都应该足够快。

# c# - 确定应用程序缓存项何时超时？

> ID：100717
> 
> 赞同：0
> 
> 时间：2008-09-19T09:26:00.197
> 
> 标签：c#, asp.net, asp.net-1.1

在 ASP.NET 中，当在应用程序缓存中存储一​​个绝对到期的值时，是否有一种方法可以检索项目到期的日期/时间？如果根据用户请求过期，应用程序缓存项将被刷新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T13:30:20.477

HttContext.Cache 对象上有一个方法签名，允许您指定在设置新缓存项时删除缓存项时要调用的方法。

为自己定义一个允许您处理该信息的方法，无论您是否希望它重新将项目提交到应用程序缓存、通过电子邮件发送给您、将其记录在事件日志中，无论您需要什么。

希望有帮助，帕斯卡

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T12:44:25.000

不确定我是否正确理解了您的问题，但我会试一试：我相信没有办法真正弄清楚某个缓存项何时到期。在大多数情况下，我在将对象添加到缓存时使用作为参数 (CacheItemRemovedCallback) 传入的委托，因此当项目被踢出时我会收到通知。

希望这个对你有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T13:46:46.723

使用 CacheItemRemovedCallback；无论如何，您的对象可能会比您预期的更早从缓存中踢出

# .net - DirectoryInfo.GetDirectories() 和属性

> ID：100721
> 
> 赞同：6
> 
> 时间：2008-09-19T09:26:38.527
> 
> 标签：.net, file-io, attributes, directoryinfo, getdirectories

我正在使用`DirectoryInfo.GetDirectories()`递归查找给定路径下的所有子目录。但是，我想排除系统文件夹，并且没有明确的方法。在 FindFirstFile/FindNextFile 中，属性更清晰。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-19T09:51:44.160

@rslite 是对的，.NET 没有提供这种开箱即用的过滤，但实现起来并不难：

```
static IEnumerable<string> GetNonSystemDirs(string path)
{
    var dirs = from d in Directory.GetDirectories(path)
               let inf = new DirectoryInfo(d)
               where (inf.Attributes & FileAttributes.System) == 0
               select d;

    foreach (var dir in dirs)
    {
        yield return dir;
        foreach (var subDir in GetNonSystemDirs(dir))
        {
            yield return subDir;
        }
    }
} 
```

MSDN 链接：

[FileSystemInfo.Attributes 属性](http://msdn.microsoft.com/en-us/library/system.io.filesysteminfo.attributes.aspx)

[文件属性枚举](http://msdn.microsoft.com/en-us/library/system.io.fileattributes.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T10:07:48.770

这是一个很好的例子，说明 Linq 和扩展方法使事情变得非常干净和简单。

```
public static DirectoryInfo[] GetNonSystemDirectories(
    this DirectoryInfo directory,
    string searchPattern,
    SearchOption searchOption)
{
    return directory.GetDirectories(searchPattern, searchOption)
        .Where(subDir => (subDir.Attributes & FileAttributes.System) == 0)
        .ToArray();
} 
```

如果您正在构建一个 .net v2 应用程序，那么您可以使用[LinqBridge](http://www.albahari.com/nutshell/linqbridge.html)让您可以访问所有很酷的 Linq to objects 方法（如上面的 Where() 和 ToArray()）。

**编辑**

在 .net v4 中，您将使用[EnumerateDirectories](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.enumeratedirectories.aspx)而不是[GetDirectories](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.getdirectories.aspx)，它允许您迭代结果而无需先在内存中构建数组。

```
public static IEnumerable<DirectoryInfo> EnumerateNonSystemDirectories(
    this DirectoryInfo directory,
    string searchPattern,
    SearchOption searchOption)
{
    return directory.EnumerateDirectories(searchPattern, searchOption)
        .Where(subDir => (subDir.Attributes & FileAttributes.System) == 0);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T09:37:33.273

您可能必须遍历结果并拒绝那些具有您不想要的属性的结果（使用 Attributes 属性）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-10T01:53:22.793

使用终极 Sweet Linq

```
 IEnumerable<string> directories = new DirectoryInfo(path).GetDirectories().Where(a => (a.Attributes & FileAttributes.System) == 0).Select(a => a.FullName); 
```

# python - 为什么 Python 中的“if not someobj:”比“if someobj == None:”更好？

> ID：100732
> 
> 赞同：146
> 
> 时间：2008-09-19T09:29:19.317
> 
> 标签：python

我见过几个这样的代码示例：

```
if not someobj:
    #do something 
```

但我想知道为什么不这样做：

```
if someobj == None:
    #do something 
```

有什么区别吗？一个比另一个有优势吗？

* * *

## 回答 #1

> 赞同：205
> 
> 时间：2008-09-19T09:38:10.247

`bool`在第一个测试中，如果对象还不是一个值，Python 会尝试将其转换为一个值。粗略地说，**我们是在问对象：你有意义吗？**这是使用以下算法完成的：

1.  如果对象有一个`__nonzero__`特殊的方法（如数字内置函数`int`和`float`），它会调用这个方法。它必须要么返回一个`bool`然后直接使用的值，要么返回一个如果等于零`int`则被视为的值。`False`

2.  否则，如果对象有一个`__len__`特殊的方法（就像容器内置函数一样，`list`, `dict`, `set`, `tuple`, ...），它会调用这个方法，`False`如果容器是空的（长度为零），它会考虑一个容器。

3.  否则，考虑对象，`True`除非`None`在这种情况下，考虑对象`False`。

在第二个测试中，比较对象是否相等`None`。在这里，**我们问对象，“你等于这个其他值吗？”** 这是使用以下算法完成的：

1.  如果对象有`__eq__`方法，则调用该方法，然后将返回值转换为`bool`值并用于确定`if`.

2.  否则，如果对象有`__cmp__`方法，则调用它。此函数必须返回一个`int`指示两个对象的顺序（`-1`if `self < other`、`0`if `self == other`、`+1`if `self > other`）。

3.  否则，将比较对象的身份（即它们引用相同的对象，`is`操作员可以测试）。

可以使用`is`操作符进行另一项测试。**我们会问对象，“你是这个特定的对象吗？”**

通常，我建议使用非数值的第一个测试，当您想要比较相同性质的对象（两个字符串，两个数字，...）时使用相等性测试，并且仅在以下情况下检查身份使用标记值（`None`例如，未为成员字段初始化，或者在使用`getattr`或`__getitem__`方法时）。

总而言之，我们有：

```
>>> class A(object):
...    def __repr__(self):
...        return 'A()'
...    def __nonzero__(self):
...        return False

>>> class B(object):
...    def __repr__(self):
...        return 'B()'
...    def __len__(self):
...        return 0

>>> class C(object):
...    def __repr__(self):
...        return 'C()'
...    def __cmp__(self, other):
...        return 0

>>> class D(object):
...    def __repr__(self):
...        return 'D()'
...    def __eq__(self, other):
...        return True

>>> for obj in ['', (), [], {}, 0, 0., A(), B(), C(), D(), None]:
...     print '%4s: bool(obj) -> %5s, obj == None -> %5s, obj is None -> %5s' % \
...         (repr(obj), bool(obj), obj == None, obj is None)
  '': bool(obj) -> False, obj == None -> False, obj is None -> False
  (): bool(obj) -> False, obj == None -> False, obj is None -> False
  []: bool(obj) -> False, obj == None -> False, obj is None -> False
  {}: bool(obj) -> False, obj == None -> False, obj is None -> False
   0: bool(obj) -> False, obj == None -> False, obj is None -> False
 0.0: bool(obj) -> False, obj == None -> False, obj is None -> False
 A(): bool(obj) -> False, obj == None -> False, obj is None -> False
 B(): bool(obj) -> False, obj == None -> False, obj is None -> False
 C(): bool(obj) ->  True, obj == None ->  True, obj is None -> False
 D(): bool(obj) ->  True, obj == None ->  True, obj is None -> False
None: bool(obj) -> False, obj == None ->  True, obj is None ->  True 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-09-19T10:12:34.377

这些实际上都是不好的做法。曾几何时，人们认为随意将 None 和 False 视为相似是可以的。但是，从 Python 2.2 开始，这不是最好的策略。

首先，当您进行一种`if x`或`if not x`类型的测试时，Python 必须隐式转换`x`为布尔值。该`bool`函数的规则描述了许多错误的事物；其他一切都是真实的。如果 x 的值一开始就不是正确的布尔值，那么这种隐式转换并不是最清晰的表达方式。

在 Python 2.2 之前，没有 bool 函数，所以更不清楚。

其次，你不应该真的用`== None`. 您应该使用`is None`和`is not None`。

请参阅 PEP 8，[Python 代码样式指南](http://www.python.org/dev/peps/pep-0008/)。

> ```
> - Comparisons to singletons like None should always be done with
>   'is' or 'is not', never the equality operators.
> 
>   Also, beware of writing "if x" when you really mean "if x is not None"
>   -- e.g. when testing whether a variable or argument that defaults to
>   None was set to some other value.  The other value might have a type
>   (such as a container) that could be false in a boolean context! 
> ```

有多少个单例？五：`None`、`True`、`False`和`NotImplemented`。`Ellipsis`因为你真的不太可能使用`NotImplemented`or `Ellipsis`，而且你永远不会说`if x is True`（因为简单`if x`得多），你只会测试`None`.

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-09-19T09:38:26.313

因为`None`不是唯一被认为是错误的东西。

```
if not False:
    print "False is false."
if not 0:
    print "0 is false."
if not []:
    print "An empty list is false."
if not ():
    print "An empty tuple is false."
if not {}:
    print "An empty dict is false."
if not "":
    print "An empty string is false." 
```

`False`, `0`, `()`, `[]`,`{}`和`""`都与 不同`None`，所以你的两个代码片段是*不*等价的。

此外，请考虑以下事项：

```
>>> False == 0
True
>>> False == ()
False 
```

`if object:`不是*平等*检查。`0`, `()`, `[]`, `None`,`{}`等都*彼此*不同，但它们都*评估*为 False。

这是短路表达式背后的“魔力”，例如：

```
foo = bar and spam or eggs 
```

这是以下的简写：

```
if bar:
    foo = spam
else:
    foo = eggs 
```

虽然你真的应该写：

```
foo = spam if bar else egg 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-19T09:39:16.640

[PEP 8 -- Python 代码样式指南](https://www.python.org/dev/peps/pep-0008/#programming-recommendations)建议使用***is***或***not***如果您正在测试 None-ness

> ```
> - Comparisons to singletons like None should always be done with
>   'is' or 'is not', never the equality operators. 
> ```

另一方面，如果您要测试的不仅仅是“无”，则应使用布尔运算符。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-19T10:27:52.297

如果你问

```
if not spam:
    print "Sorry. No SPAM." 
```

*垃圾邮件*的*__nonzero__*方法被调用。来自 Python 手册：

 *> **__nonzero__** ( *self* ) 调用实现真值检测，内置操作 bool(); 应该返回 False 或 True，或它们的整数等价物 0 或 1。如果未定义此方法，则调用 __len__()（如果已定义）（见下文）。如果一个类既没有定义 __len__() 也没有定义 __nonzero__()，那么它的所有实例都被认为是真的。

如果你问

```
if spam == None:
    print "Sorry. No SPAM here either." 
```

*spam*的*__eq__*方法使用参数*None*调用。

 **有关自定义可能性的更多信息，请查看[https://docs.python.org/reference/datamodel.html#basic-customization上的 Python 文档](https://docs.python.org/reference/datamodel.html#basic-customization)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-19T09:38:37.577

这两种比较有不同的目的。前者检查某物的布尔值，后者检查无值的身份。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T09:39:01.977

第一个例子更短，看起来更好。根据其他帖子，您选择的内容还取决于您真正想做的比较。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T09:39:41.867

答案是“视情况而定”。

如果我认为 0、""、[] 和 False（列表并非详尽无遗）在这种情况下等同于 None，我将使用第一个示例。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-19T09:53:04.017

就个人而言，我选择了跨语言的一致方法：`if (var)`仅当 var 被声明为布尔值（或这样定义，在 C 中我们没有特定类型）时，我才这样做（或等效）。我什至在这些变量前面加上一个`b`（`bVar`实际上是这样），以确保我不会在这里意外使用另一种类型。
我真的不喜欢隐式转换为布尔值，当有许多复杂的规则时更是如此。

当然，人们会不同意。有些走得更远，我`if (bVar == true)`在我的工作中看到 Java 代码（对我来说太多余了！），其他人喜欢过于紧凑的语法，去`while (line = getNextLine())`（对我来说太模棱两可了）。***

# java - 动态编译代码时如何访问 Java Web Start 加载的类？

> ID：100737
> 
> 赞同：1
> 
> 时间：2008-09-19T09:30:38.097
> 
> 标签：java, jnlp, java-web-start, dynamic-compilation

我正在我的客户端应用程序中动态编译代码。当我使用 Java Web Start 启动应用程序时，出现异常。该异常仅在通过 Java Web Start 运行时发生。

```
//The exception
evolver.core.model.change.execution.ExecutionException: Compilation failed!

DynamicComparator.java:2: package evolver.core.model.i does not exist
import evolver.core.model.i.IDefaultObject;
                           ^
DynamicComparator.java:9: cannot find symbol
symbol  : class PropertyBag
location: class DynamicComparator
PropertyBag b2 = new PropertyBag(dob2);
                     ^ 
```

上面的 PropertyBag 应该由 JNLPClassloader 提供，因为它是 JWS 下载的文件之一的一部分

导致问题的代码如下所示。

```
public static int compile(String javaFileName) {    
    ByteArrayOutputStream os = new ByteArrayOutputStream();
    PrintWriter w = new PrintWriter(os);
    int res = com.sun.tools.javac.Main.compile(new String[]{"-d", "./", javaFileName}, w);
    if (res != 0)
        throw new ExecutionException("Compilation failed!" + "\n\n" + os.toString());
    return res;
} 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T10:27:31.733

按照目前的情况，您必须在服务器上编译代码。服务器不应提供任何可能允许跨站点攻击的代码，因此要非常小心。然后客户端可以使用 URLClassLoader.newInstance 来加载它。

# algorithm - Lindenmayer Systems 实现有机增长

> ID：100747
> 
> 赞同：0
> 
> 时间：2008-09-19T09:32:26.673
> 
> 标签：algorithm

我正在寻找一种使用代码表示有机增长的好方法——尤其是树木和花卉。

我发现 Lindenmayer Systems 是描述这一点的合理方式，但需要一个好的地方来开始编程。

有什么好的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T09:50:41.543

首先在 home.wanadoo.nl/laurens.lapre/ 上查看 Laurens Lapre 的 LParser 系统页面。

他提供了源代码，这是一个很好的起点。该代码非常有用 - 我曾经将它包装在一个 dll 中，在景观生成程序中使用它时所做的更改很少，并且效果很好。

LParser 已经有一段时间了，但这并不能阻止它成为一个很好的实现和一个非常简洁的编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-19T00:26:40.730

网络上有许多 LSystem 实现。你可以试试这个： http: [//marvinproject.sourceforge.net/en/plugins/lindenmayer.html](http://marvinproject.sourceforge.net/en/plugins/lindenmayer.html)

下载 MarvinEditor。在那里，您可以指定自己的规则来通过 LSystem 创建自己的对象。

网上也有 3D 的 LSystem。一切都取决于您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T09:43:10.483

我不确定您对该主题已经了解多少，但我相信 Wikipedia 关于[L-system](http://en.wikipedia.org/wiki/L-system "L系统")的文章应该是一个好的开始。

“使用代码”有点模糊，所以我很难回答。您可能会找到一些免费软件来试验 L 系统，您可以使用一些图形语言，如处理，在 GDI 或 Java2D（或 3D）中进行，等等。

还有其他方法，我自己的[蕨类植物 - 静态视图](http://philho.deviantart.com/art/Ferns-Static-view-85913591 "蕨类植物 - 静态视图")是使用处理制作的，绘制短线，使用分层类系统来表示树干、树枝和树叶。

# communication - 沟通差距：用户与分析师-设计师

> ID：100767
> 
> 赞同：3
> 
> 时间：2008-09-19T09:38:56.063
> 
> 标签：communication, analysis

通常的做法是使用案例研究、构建工作流和数据流等。但这并不一定会在用户/发起人和分析师设计者之间创建一个共享词汇表：通常，两者都必须获得其他专业领域的“内部”的术语和观点，这通常会导致误解和会议澄清（输入 RAD 技术，如进化原型）等。

用户/赞助商专注于他/她的需求/环境，从他们的角度来看，他们不想也不应该被迫获得不相关的“编程术语”。学习新环境的责任在于分析师/设计师（/程序员）。

你如何克服学习曲线？当您面对需要软件解决方案的用户时，什么对您有用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-22T22:39:36.183

我用评论

“如果你不能向酒吧女招待解释你的物理，那它就不是很好的物理”和“除非你能向你的祖母解释，否则你就不会真正理解某些东西”（归因于卢瑟福和爱因斯坦）

当我与客户谈论需求时，就像咒语一样。

采取两管齐下的方法，一个高层次的，Powerpoint 或白板演示，如果你可以让用户在 POC 或模型上放松。

然后逐行做详细的要求。细节决定成败。让他们签署这些细节。对它们进行标记和编号，以便他们可以逐行分析。

如果你在高水平集之前做详细的需求，用户永远不会掌握设计中的任何概念，并陷入最细微的细节规范中。没有任何框架或概念，用户将围绕大头针头上的天使数量旋转。

只要客户和开发团队可以使用类似的语言，敏捷性和迭代就很好。确保设定并满足期望。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T11:18:46.917

一个好的交互设计师应该能够用外行的方式描述软件的工作原理。如果没有，恕我直言，他不应该做前端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T13:25:59.270

尽量消除用户和最终实施者之间的**中间步骤。**每一个这样的步骤都会掩盖和丢失信息。你团队中最有价值的成员可能是可以穿**两套衣服**的人——与用户的“界面”，并实际实施。

如果没有，请确保您有**快速迭代**并迭代地实现事物。很容易将其与增量混淆。不同之处在于，使用迭代方法，您可以在很小但统一的程度上实现广泛的功能。在增量方法中，您一个接一个地实现大块功能。

在迭代方法中，您具有**敏捷性的优势。**用户改变主意，还是有一些误解？没问题，还有改的空间。甚至，希望没有花费太多的努力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T16:50:41.757

这需要一系列的技术，并且双方都需要在一定程度上学会了解对方的业务：即分析师必须了解用户的领域，用户必须熟悉分析师的一些技术。

我发现流程流是一个很好的开始方式，可以在高层次上就业务的运作方式达成一致。一些用户擅长数据模型（例如 ERD），但通常我会说他们不是：当规则以文本形式阐明时，他们通常会做出更好的反应，例如

*   一个订单可以包含一个或多个订单行
*   每个订单都有一个唯一的 10 位参考编号

与对 ERD 进行质量检查相比，他们可以更轻松地阅读、勾选或交叉这些内容。

接下来，没有什么比输入屏幕和报告的草图更能让用户专注于他们想要的细节了。

# javascript - javascript XSLTProcessor 偶尔不起作用

> ID：100774
> 
> 赞同：1
> 
> 时间：2008-09-19T09:39:30.557
> 
> 标签：javascript, xml, firefox, xslt

下面的 JavaScript 假设从 XML 文件中读取流行的标签，并应用 XSL 样式表并作为 HTML 输出到浏览器。

```
function ShowPopularTags() {
   xml = XMLDocLoad("http://localhost/xml/tags/popular.xml?s=94987898");
   xsl = XMLDocLoad("http://localhost/xml/xsl/popular-tags.xsl");
   if (window.ActiveXObject) {
      // code for IE
      ex = xml.transformNode(xsl);
      ex = ex.replace(/\\/g, "");
      document.getElementById("popularTags").innerHTML = ex;
   } else if (document.implementation && document.implementation.createDocument) {
      // code for Mozilla, Firefox, Opera, etc.
      xsltProcessor = new XSLTProcessor();
      xsltProcessor.importStylesheet(xsl);
      resultDocument = xsltProcessor.transformToFragment(xml, document);
      document.getElementById("popularTags").appendChild(resultDocument);
      var ihtml = document.getElementById("popularTags").innerHTML;
      ihtml = ihtml.replace(/\\/g, "");
      document.getElementById("popularTags").innerHTML = ihtml;
   }
}
ShowPopularTags(); 
```

此脚本的问题是有时它设法输出生成的 HTML 代码，有时却没有。有谁知道哪里出了问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T10:50:17.687

为了避免并行加载的问题（正如 Dan 所暗示的），仅在页面完全加载时调用此类脚本总是一个好主意。

理想情况下，您将脚本标签放在页眉中并调用 ShowPopularTags(); 在正文 Onload 项中。IE

```
<BODY onLoad="ShowPopularTags();"> 
```

这样您就可以完全确定您的 document.getElementById("popularTags") 不会失败，因为在包含该元素的 HTML 完全加载之前调用了脚本。

另外，我们可以看看你的 XMLDocLoad 函数吗？如果其中还包含非顺序元素，您可能会遇到 XSLT 转换发生在对象 xml 和 xsl 完全加载之前发生的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-21T12:04:02.740

您是被迫使用现在正在使用的同步解决方案，还是异步解决方案也是一种选择？我记得 Firefox 过去在同步调用方面也遇到过一些问题，我不知道其中还有多少。我见过这样的情况：只要请求正在运行，整个 Firefox 界面就会锁定（这取决于超时设置，可能需要很长时间）。

这将需要您做更多的工作，但解决方案将类似于以下内容。这是我使用 Ajax 处理 XSLT 内容的代码（稍微重写它，因为我的代码是面向对象的，并且包含一个循环，该循环从第一次加载的 XML 文档中解析出适当的 XSL 文档）

注意：确保在函数之外声明您的 oCurrentRequest 和 oXMLRequest 版本，因为它将被继承。

```
if (window.XMLHttpRequest)
{
  oCurrentRequest = new XMLHttpRequest();
  oCurrentRequest.onreadystatechange = processReqChange;
  oCurrentRequest.open('GET', sURL, true);
  oCurrentRequest.send(null);
}
else if (window.ActiveXObject)
{
  oCurrentRequest = new ActiveXObject('Microsoft.XMLHTTP');
  if (oCurrentRequest)
  {
    oCurrentRequest.onreadystatechange = processReqChange;
    oCurrentRequest.open('GET', sURL, true);
    oCurrentRequest.send();
  }
} 
```

在此之后，您只需要一个名为 processReqChange 的函数，其中包含如下内容：

```
function processReqChange()
{
  if (oCurrentRequest.readyState == 4)
  {
    if (oCurrentRequest.status == 200)
    {
      oXMLRequest = oCurrentRequest;
      oCurrentRequest = null;
      loadXSLDoc();
    }
  }
} 
```

当然，您需要生成第二组函数来处理 XSL 加载（例如，从 loadXSLDoc 开始）。

然后在 processXSLReqChange 结束时，您可以获取 XML 结果和 XSL 结果并进行转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T10:09:49.547

好吧，对于 IE 和其他所有内容，该代码遵循完全不同的路径。我认为问题仅限于其中之一。您在哪些浏览器上尝试过，哪些浏览器出现此错误？

我唯一能想到的另一件事是，当您尝试对其进行处理时，popularTags 元素可能不存在。这个函数是如何执行的？在 onload/domready 事件中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-19T10:18:08.620

担。IE 执行脚本没有问题。我在 Firefox 中遇到了这个问题。popularTags 元素存在于调用该函数的 HTML 文档中。

```
<div id="popularTags" style="line-height:18px"></div>
<script language="javascript" type="text/javascript">
    函数 ShowPopularTags()
    {
        xml=XMLDocLoad("http://localhost/xml/tags/popular.xml?s=29497105");
        xsl=XMLDocLoad("http://localhost/xml/xsl/popular-tags.xsl");

        如果（窗口。ActiveXObject）{
            // IE代码
            ex=xml.transformNode(xsl);
            ex = ex.replace(/\\/g, "");
            document.getElementById("popularTags").innerHTML=ex;
        }
        else if (document.implementation && document.implementation.createDocument){
            // Mozilla、Firefox、Opera 等的代码
            xsltProcessor=新 XSLTProcessor();
            xsltProcessor.importStylesheet(xsl);
            resultDocument = xsltProcessor.transformToFragment(xml,document);
            document.getElementById("popularTags").appendChild(resultDocument);

            var ihtml = document.getElementById("popularTags").innerHTML;
            ihtml = ihtml.replace(/\\/g, "");
            document.getElementById("popularTags").innerHTML = ihtml;
         }
    }

    ShowPopularTags();
</脚本>    

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-21T10:27:54.813

以下是 XMLDocLoad 函数。

```
函数 XMLDocLoad(fname)
{
    var xmlDoc;

    如果（窗口。ActiveXObject）{
        // IE代码
        xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
        xmlDoc.async=false；
        xmlDoc.load(fname);

        返回（xmlDoc）；
    }
    否则如果（document.implementation && document.implementation.createDocument）{
        // Mozilla、Firefox、Opera 等的代码
        xmlDoc=document.implementation.createDocument("","",null);

        xmlDoc.async=false；
        xmlDoc.load(fname);

        返回（xmlDoc）；

    }
    别的{
        alert('您的浏览器无法处理此脚本');
    }

}

```

# mysql - MySQL 培训视频

> ID：100780
> 
> 赞同：-3
> 
> 时间：2008-09-19T09:40:59.770
> 
> 标签：mysql, sql

嗨，我可以找到 MySQL 的培训视频吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T09:51:01.730

在 youtube 中，您会发现类似 mysql 的安装：[http ://www.youtube.com/watch?v=KQcFP3GcQ0s](http://www.youtube.com/watch?v=KQcFP3GcQ0s)

mysql培训：[http ://www.youtube.com/watch?v=BHq-bORKncA](http://www.youtube.com/watch?v=BHq-bORKncA)

关于 mysql tunning（热门）的 Google 演示[http://www.youtube.com/watch?v=u70mkgDnDdU](http://www.youtube.com/watch?v=u70mkgDnDdU)

您还有其他关于 mysql 的 google 演示文稿，只需在 youtube 和 googlevideos 中搜索 :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T09:56:19.377

不要忘记：[http ://dev.mysql.com/](http://dev.mysql.com/)

这是备份您在任何视频中找到的任何内容的好资源。我不能推荐任何视频，因为我没有经验，对不起。

# sql-server - SQL Server 锁解释

> ID：100789
> 
> 赞同：10
> 
> 时间：2008-09-19T09:43:11.263
> 
> 标签：sql-server, locking

下面是 SQL Server 2000 支持的锁列表。我对“意图”锁的实际含义有点困惑。我在网上四处张望，答案似乎有点神秘。

除了获得对我的具体问题的答案之外，我希望将此问题用作 Wiki，以了解每个锁的含义以及在什么情况下将获取该类型的锁。

*   共享 (S)
    *   更新（U）
    *   独家 (X)
    *   意图
        *   意图共享 (IS)
        *   意向排他 (IX)
        *   与意图独占共享（六）
        *   意图更新 (IU)
        *   更新意图独占 (UIX)
        *   共享意图更新 (SIU)
    *   架构
        *   模式修改 (Sch-M)
        *   模式稳定性 (Sch-S)
    *   批量更新 (BU)
    *   键程
        *   共享密钥范围和共享资源锁 (RangeS_S)
        *   共享密钥范围和更新资源锁 (RangeS_U)
        *   插入键范围和空资源锁 (RangeI_N)
        *   独占键范围和独占资源锁 (RangeX_X)
        *   转换锁（RangeI_S、RangeI_U、RangeI_X、RangeX_S、RangeX_U）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-19T13:10:30.930

[SQL server MSDN 页面](http://msdn.microsoft.com/en-us/library/aa213039(SQL.80).aspx?ppud=4)有一个合理的解释：

> 意向锁表示 SQL Server 想要在层次结构中较低的某些资源上获取共享 (S) 锁或排他 (X) 锁。例如，放置在表级别的共享意图锁意味着事务打算在该表中的页或行上放置共享 (S) 锁。在表级别设置意向锁可防止另一个事务随后在包含该页的表上获取排他 (X) 锁。意向锁提高了性能，因为 SQL Server 仅在表级别检查意向锁以确定事务是否可以安全地获取该表上的锁。这消除了检查表上的每一行或每页锁定以确定事务是否可以锁定整个表的要求。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-19T10:49:53.240

意向锁放置在表级别，并指示事务将在表中的某些行上放置适当的锁。

这加快了对需要在表级别放置锁的事务的冲突检查。例如，需要在表上独占锁的事务可以检测表级别的冲突（“意图共享”锁将在那里），而不必检查所有行（或页）的共享锁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-12T11:02:32.153

Intent 锁的另一个重要特性是您不会从代码中显式放置它们，当您放置非意图锁时会隐式请求它们。

# php - 如何对继承对象进行单元测试？

> ID：100795
> 
> 赞同：5
> 
> 时间：2008-09-19T09:44:54.863
> 
> 标签：php, unit-testing, oop, inheritance, phpunit

当你使用组合时，你可以模拟你的被测类所依赖的其他对象，但是当你使用继承时，你不能模拟基类。（或者你可以吗？）

我通常[更喜欢组合而不是继承](https://stackoverflow.com/questions/49002/prefer-composition-over-inheritance)，但有时继承似乎真的是这项工作的最佳工具——嗯，至少在涉及单元测试之前是这样。

那么，如何测试继承？还是您只是将其视为不可测试而将其丢弃并改用组合？

**注意：**我主要使用 PHP 和 PHPUnit，因此非常感谢这方面的帮助。但是知道其他语言是否有解决这个问题的方法也很有趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-22T17:45:40.213

使用一套反映类层次结构的单元测试。如果您有一个基类 Base 和一个派生类 Derived，那么就有测试类 BaseTests 并从该 DerivedTests 派生。BaseTests 负责测试 Base 中定义的所有内容。DerivedTests 继承了这些测试，还负责测试 Derived 中的所有内容。

如果您想在 Base 中测试受保护的虚拟方法（即 Base 与其后代类之间的接口），那么创建一个测试该接口的仅测试派生类也可能有意义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T09:48:04.577

只要您不覆盖父类的公共方法，我不明白为什么需要在它的所有子类上测试它们。单元测试父类上的方法，只测试子类上的新方法或覆盖的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-19T10:08:38.363

您在合成中使用模拟对象的原因是，如果真实对象做了您不想设置的事情（例如使用套接字、串行端口、获取用户输入、检索大容量数据等）。您应该尽可能使用真实的对象。模拟对象仅适用于使用真实对象实现和维护测试的估计工作量大于使用模拟对象实现和维护测试的估计工作量。你的基类不应该做任何花哨的事情！

所以你不必测试继承。假设您正在使用基类的行为，因此只需像往常一样测试派生类 - 根据测试的需要调用基类和派生类的方法。这可确保测试派生类的所有预期行为。

本质上，（大多数时候）您测试派生类，就好像基类是不可见的一样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T09:49:22.823

为什么要模拟基类？

如何从不存在的父类创建派生类？

像往常一样测试它，但是有父类。

我想你还没有讲完整个故事。

此外，语言功能应该可以工作（除非您使用的是 beta 版本左右），因此您不需要测试该方法是否实际存在于派生类中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T12:02:44.757

不，你没有。你只需要检查被覆盖的方法是否做了它们应该做的事情。它绝不应该影响您的父方法的行为。如果您的父方法开始失败，则意味着您在父级别测试它们时错过了绑定条件。

# php - 在 PHP 中接收多部分 POST 数据请求

> ID：100808
> 
> 赞同：1
> 
> 时间：2008-09-19T09:49:11.453
> 
> 标签：php, http, mime, multipart, form-data

我想收到以下`HTTP`请求`PHP:`

```
Content-type: multipart/form-data;boundary=main_boundary

--main_boundary
Content-type: text/xml
<?xml version='1.0'?>
<content>
Some content goes here
</content>

--main_boundary
Content-type: multipart/mixed;boundary=sub_boundary

  --sub_boundary
  Content-type: application/octet-stream

  File A contents

  --sub_boundary
  Content-type: application/octet-stream

  File B contents

  --sub_boundary

--main_boundary-- 
```

（注意：我对子部分进行了缩进，只是为了让这篇文章更具可读性。）

我对 PHP 不是很流利，想获得一些帮助/指针来弄清楚如何在 PHP 代码中接收这种多部分表单请求。我曾经写过一些代码，我收到一个标准的 HTML 表单，然后我可以通过使用表单元素的名称作为`$HTTP_GET_VARS`数组中的索引键来访问表单元素，但在这种情况下，没有表单元素名称，表单数据部分也没有线性（即子部分=多级数组）。

感谢您的帮助！

/罗伯特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T10:07:14.733

`$HTTP_GET_VARS`,`$HTTP_POST_VARS`等是过时的符号，您应该使用`$_GET`,`$_POST`等。

现在，文件内容应该在`$_FILES`全局数组中，而如果没有元素名称，我不确定其余内容是否会显示在`$_POST`. 无论如何，如果在*php.ini*`always_populate_raw_post_data`中设置为 true ，则数据应该在. *此外，阅读php://input*时应该显示整个请求。*`$HTTP_RAW_POST_DATA`*

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-16T00:04:05.697

你应该注意：

“php://input 允许您读取原始 POST 数据。它是 $HTTP_RAW_POST_DATA 的内存密集型替代方案，不需要任何特殊的 php.ini 指令。php://input 不适用于 enctype=”multipart/form-data”</p>

从 php 手册...看来 php://input 不可用

尚无法发表评论，但这旨在补充 pilsetnieks 的答案

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-09-19T09:52:00.137

上传的文件可以通过 $_FILE 全局变量访问，其他参数可以通过 $_GET 全局变量访问。**

# svn - 如何撤消子目录上的“svn switch”？

> ID：100812
> 
> 赞同：13
> 
> 时间：2008-09-19T09:49:30.720
> 
> 标签：svn

不是第一次，我不小心从项目根目录下的某个地方完成了“svn switch”。这只会切换该子目录，但我该如何撤消呢？

如果我尝试将子目录切换回原始分支，我会得到：

```
"svn: Directory 'subdir\_svn' containing working copy admin area is missing" 
```

**更新**：我在子目录中有更改，所以我不想删除。

在短期内，我通过重新应用更改来修复它，但我正在寻找一种方法让 Subversion 重新切换回我来自的地方......或者这是一个缺失的功能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T09:51:51.633

快速破解：删除目录，上一级，然后运行 ​​svn update。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T11:22:29.107

在不确切知道您是如何进行切换以及您的目录和存储库布局如何的情况下，很难说出您的情况出了什么问题。

没有办法真正“恢复”开关。通常，svn 切换可以通过切换回原始位置来撤消，即当原始位置在 svn://url/to/orig/dir 时，以下应该可以工作：

将子目录切换到存储库的不同部分

```
svn switch svn://path/to/switched/dir/ subdir 
```

...并再次切换回来

```
svn switch svn://url/to/orig/dir subdir 
```

在您的情况下，听起来好像您试图切换一个不属于您的工作副本的目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-08T22:22:29.573

我通过检查切换目录中的更改，删除 .svn 文件和放错位置的文件，然后使用`svn checkout <rootUrl>`后跟`svn update -r HEAD --force`.

我认为没有一种干净的方法可以做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-08T13:46:44.550

似乎可以运行另一个切换回您实际所在目录的正确路径。也就是说，如果您运行：

```
svn switch file:///srv/svn/someproject/branch/27 
```

当您在某个项目/子目录中时，然后运行

```
svn switch file:///srv/svn/someproject/branch/26/subdir 
```

然后从正确的位置运行您的原始开关。

这似乎恢复了秩序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-21T02:41:49.770

我的用例看起来很简单；我想切换回当前目录名称以父目录 URL 为根的目录。当然，这里的麻烦在于获取然后复制父目录的 URL。Windows批处理中的这个脚本为我做了。Bash 用户可以更轻松地做到这一点，但要点就在这里。看起来这个功能直接折叠到SVN中是微不足道的......

您可能需要在参数周围添加引号以进行切换，但我将把它留给您。如果不明显，您需要在要“取消切换”的目录中运行它。它此时不需要参数或任何东西，尽管如果您愿意的话，这是一个非常简单的添加（如果不是空的，就`cd \d %1`在顶部）。`%1`

**svn-unswitch.bat**

```
@echo off
setlocal

for /f "tokens=*" %%u in ('svn info --show-item url ..') do set "PARENT_URL=%%u"
call :SetDirName %CD%
svn switch %PARENT_URL%/%DIRNAME%
goto :eof

:SetDirName
    set DIRNAME=%~nx1
    goto :eof 
```

认证：*在我的机器上工作！*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-28T15:33:50.947

如果最新的更改只是开关，那么，

右键单击公共父目录，tortoise svn-> Go to svn logs。右键单击 SVN 切换之前的版本，然后选择恢复到此版本。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-09-19T10:05:47.043

```
svn revert <dir> 
```

或者，是的，删除它并获取另一个副本。

# jsf - 如何检索伍德斯托克表的选定行

> ID：100820
> 
> 赞同：0
> 
> 时间：2008-09-19T09:51:03.913
> 
> 标签：jsf, woodstock

我有一个带有复选框的 JSF 伍德斯托克表。选择一行时，我想对这些项目进行一些处理。我设法选择了 RowKey 对象，但不知道如何获取我放回的原始对象。该表由 ObjectListDataProvider 填充。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-19T09:59:24.843

能够回答您自己的问题总是很高兴。我设法通过将表的数据提供者转换为 ObjectListDataProvider 并使用方法“getObject”来取回我的原始对象来解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-12T23:40:28.967

所以我偶然发现了这一点，并希望找到如何实际进行选择并获取行信息。我最终想通了，我认为其他人可能会从我的做法中受益。

我在 JSP 中的表列中添加了一个 RadioButton，并添加了一个 valueChangeListener

```
<ui:radioButton id="radioButton1" name="radioButton-group1" valueChangeListener="#{MyBeanPage.radioButton1_processValueChange}" /> 
```

在我的 Java 代码中，我创建了 valueChangeListener 函数并存储了当前行信息。

```
public void radioButton1_processValueChange(ValueChangeEvent event) {
  TableRowDataProvider trdp = (TableRowDataProvider)getValue("#{currentRow}");
  setCurrentRowKey(trdp.getTableRow());  //Sets an instance variable for the RowKey
} 
```

现在，如果您有任何按钮想要操作所选行中的数据，您可以执行此操作以获取对象数据。贾斯珀在上面提到了这一点。

```
/*getObjectListDataProviderImpl() returns the implementation of 
 *ObjectListDataProvider for your dynamic data.
 */
getObjectListDataProviderImpl().getObject(getCurrentRowKey()); 
```

您可能可以将单选按钮的 selectedValue 属性与其他东西结合使用，而不是执行 valueChangeListener 并避免必须执行 valueChange 函数，但这很有效，所以我不想找出另一种方法。

# c# - 有没有更好的方法来解释 .net 中结构和类之间的行为差 异？

> ID：100824
> 
> 赞同：2
> 
> 时间：2008-09-19T09:51:56.330
> 
> 标签：c#, .net

下面的代码显示了我最近用来向刚接触开发的人解释结构和类的不同行为的示例。有更好的方法吗？（是的 - 代码使用公共字段 - 这纯粹是为了简洁）

```
namespace StructsVsClasses
{
    class Program
    {
        static void Main(string[] args)
        {
            sampleStruct struct1 = new sampleStruct();
            struct1.IntegerValue = 3;
            Console.WriteLine("struct1.IntegerValue: {0}", struct1.IntegerValue);

            sampleStruct struct2 = struct1;
            Console.WriteLine();
            Console.WriteLine("struct1.IntegerValue: {0}", struct1.IntegerValue);
            Console.WriteLine("struct2.IntegerValue: {0}", struct2.IntegerValue);
            struct1.IntegerValue = 5;
            Console.WriteLine();
            Console.WriteLine("struct1.IntegerValue: {0}", struct1.IntegerValue);
            Console.WriteLine("struct2.IntegerValue: {0}", struct2.IntegerValue);

            sampleClass class1 = new sampleClass();
            class1.IntegerValue = 3;
            Console.WriteLine();
            Console.WriteLine("class1.IntegerValue: {0}", class1.IntegerValue);

            sampleClass class2 = class1;
            Console.WriteLine();
            Console.WriteLine("class1.IntegerValue: {0}", class1.IntegerValue);
            Console.WriteLine("class2.IntegerValue: {0}", class2.IntegerValue);
            class1.IntegerValue = 5;
            Console.WriteLine();
            Console.WriteLine("class1.IntegerValue: {0}", class1.IntegerValue);
            Console.WriteLine("class2.IntegerValue: {0}", class2.IntegerValue);

            Console.ReadKey();
        }
    }

    struct sampleStruct
    {
        public int IntegerValue;
    }

    class sampleClass
    {
        public int IntegerValue;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T10:08:28.160

好吧，您的*解释*根本不是解释，而是对行为的观察，这是不同的。

如果您想解释差异是什么，那么您需要一段文字来*解释*它。解释的行为可以用代码编辑。

Grimtron 链接到的页面非常适合详细说明类和结构之间的所有个体差异，其中的部分内容将作为*概述解释*，特别是阅读以下项目：

*   存在于堆栈或堆上？
*   传承差异？

但我不会链接到该页面作为对差异的*解释*。这就像试图描述汽车是什么，只是列出构成汽车的所有部件。您仍然需要了解大局才能了解汽车是什么，而这样的清单无法为您提供。

在我看来，解释是告诉你某事是如何工作的，然后所有细节都自然而然地随之而来。

*例如，如果您了解值类型与引用类型背后的基本原理，那么如果您考虑一下*，该页面上的许多细节都是有意义的。

例如，一个值类型（结构）被分配在它被声明的地方，可以说是内联的。它占用堆栈空间，或者使一个类在内存中更大。然而，引用类型是一个指针，它具有固定大小，指向*内存中存储实际对象的其他位置*。

通过上面的解释，以下细节是有意义的：

*   结构变量不能为空（即它总是占用必要的空间）
*   对象引用可以为空（即指针可以指向任何内容）
*   结构不会给垃圾收集增加压力（垃圾收集与堆一起工作，堆是对象存在于*其他空间的地方*）
*   总是有一个默认的构造函数。由于您可以声明任何值类型变量（基本上是一种结构），而不给它一个值，因此必须有一些潜在的魔法来清除该空间（记住我说它无论如何都占用了空间）

其他的事情，就像所有与继承有关的事情，需要他们自己的部分来解释。

等等...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T10:02:36.380

我想以这种方式显示值/引用类型的差异是可以的。不过，使用控制台输出的方法可能会更简洁一些。

正如您所说，您的“某人”是开发新手，这可能不太重要，但是这里有一个很好的列表，列出了 C# 中的类和结构之间的进一步差异：

[C# 结构/类差异](http://www.jaggersoft.com/pubs/StructsVsClasses.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T11:17:59.290

当结构/类是另一个类的成员时，差异可能更容易理解。

类示例：

```
class PointClass {
  int double X;
  int double Y;
}

class Circle {
  PointClass Center = new PointClass() { X = 0, Y = 0; }
}

static void Main() {
  Circle c = new Circle();
  Console.WriteLine(c.Center.X);
  c.Center.X = 42;
  Console.WriteLine(c.Center.X);
} 
```

输出：

```
0
42 
```

结构示例：

```
struct Point {
  int double X;
  int double Y;
}

class Circle {
  PointStruct Center = new PointStruct() { X = 0, Y = 0; }
}

static void Main() {
  Circle c = new Circle();
  Console.WriteLine(c.Center.X);
  c.Center.X = 42;
  Console.WriteLine(c.Center.X);
} 
```

输出：

```
0
0 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T12:15:26.820

**结构**是一种软弱无力的数据排列。软弱而被动。

一个**类**在构造函数的瞬间爆发。充满活力的班级是现代[编程]世界的超级英雄。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T10:16:57.110

1.  我看不出你想用你的样本展示什么。

2.  我向人们解释它的方式是“一个结构*包含*东西。一个类用它*做*一些事情”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T10:29:17.830

拉塞夫克，

谢谢你（除了语义上的挑剔：=） - 但是，也许我没有尽可能清楚，我试图*展示*而不是*告诉*一个新开发的人，像这样的散文块意味着同样多作为星际迷航式技术的平均水平。

Grimtron 链接到的页面，一旦我的新手更熟悉/更熟悉 .net 和一般编程，你的文本肯定会有用，我敢肯定！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T11:21:36.240

最基本的区别是结构是值类型，类是引用类型

# bash - 从 shell 脚本生成交互式 telnet 会话

> ID：100829
> 
> 赞同：11
> 
> 时间：2008-09-19T09:53:58.070
> 
> 标签：bash, telnet

我正在尝试编写一个脚本以允许我登录到控制台服务器的 48 个端口，以便我可以快速确定哪些设备连接到每条串行线路。

本质上，我希望能够有一个脚本，给定主机/端口列表，远程登录到列表中的第一个设备并让我处于交互模式，以便我可以登录并确认设备，然后当我关闭telnet 会话，连接到列表中的下一个会话。

我面临的问题是，如果我从可执行的 bash 脚本中启动 telnet 会话，会话会立即终止，而不是等待输入。

例如，给定以下代码：

```
$ cat ./telnetTest.sh
#!/bin/bash

while read line
do
        telnet $line
done
$ 
```

当我运行命令'echo "hostname" | testscript.sh' 我收到以下输出：

```
$ echo "testhost" | ./telnetTest.sh
Trying 192.168.1.1...
Connected to testhost (192.168.1.1).
Escape character is '^]'.
Connection closed by foreign host.
$ 
```

有谁知道停止自动关闭 telnet 会话的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T10:41:43.730

您需要将终端输入重定向到`telnet`进程。这应该是`/dev/tty`。所以你的脚本看起来像：

```
#!/bin/bash

for HOST in `cat`
do
  echo Connecting to $HOST...
  telnet $HOST </dev/tty
done 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-19T10:07:53.250

我认为你应该看看**期望**程序。它存在于所有现代 Linux 发行版中。这是一些示例脚本：

```
#!/usr/bin/expect -f
spawn telnet $host_name
expect {
   "T0>"                {}
   -re "Connection refused|No route to host|Invalid argument|lookup failure"
                        {send_user "\r******* connection error, bye.\n";exit}
   default              {send_user "\r******* connection error (telnet timeout),
 bye.\n";exit}
}
send "command\n"
expect -timeout 1 "something" 
```

**spawn**命令启动远程登录程序（telnet、ssh、netcat 等）

**expext**命令用于... 嗯.. 期望远程会话中的某些内容

**发送**- 发送命令

**send_user** - 将评论打印到标准输出

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T14:12:24.680

谢谢戴夫 - 这是我错过的 TTY 重定向。

对于那些感兴趣的人，我使用的完整解决方案：

```
#!/bin/bash

TTY=`tty` # Find out what tty we have been invoked from.
for i in `cat hostnames.csv` # List of hosts/ports
do
        # Separate port/host into separate variables
        host=`echo $i | awk -F, '{ print $1 }'`
        port=`echo $i | awk -F, '{ print $2 }'`
        telnet $host $port < $TTY # Connect to the current device
done 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-02T12:43:30.163

Telnet 到服务器使用 Shell 脚本示例：

`Test3.sh`文件：

```
#!/bin/sh

#SSG_details is file from which script will read ip adress and uname/password
#to telnet.

SSG_detail=/opt/Telnet/SSG_detail.txt

cat $SSG_detail | while read ssg_det ; do

   ssg_ip=`echo $ssg_det|awk '{print $1}'`
   ssg_user=`echo $ssg_det|awk '{print $2}'`
   ssg_pwd=`echo $ssg_det|awk '{print $3}'`

   echo " IP to telnet:" $ssg_ip
   echo " ssg_user:" $ssg_user
   echo " ssg_pwd:" $ssg_pwd

   sh /opt/Telnet/Call_Telenet.sh $ssg_ip $ssg_user $ssg_pwd 

done

exit 0 
```

`Call_Telenet.sh`脚本如下：

```
#!/bin/sh

DELAY=1 
COMM1='config t'                 #/* 1st commands to be run*/
COMM2='show run'
COMM3=''
COMM4=''
COMM5='exit'
COMM6='wr'
COMM7='ssg service-cache refresh all'
COMM8='exit'                     #/* 8th command to be run */

telnet $1 >> $logfile 2>> $logfile |&
sleep $DELAY
echo -p $2 >> $logfile 2>> $logfile
sleep $DELAY
echo -p $3 >> $logfile 2>> $logfile
sleep $DELAY
echo -p $4 >> $logfile 2>> $logfile
sleep $DELAY
echo -p $5 >> $logfile 2>> $logfile
sleep $DELAY

sleep $DELAY
sleep $DELAY
sleep $DELAY
echo -p $COMM7 >> $logfile 2>> $logfile
sleep $DELAY
echo -p $COMM8 >> $logfile 2>> $logfile
sleep $DELAY

exit 0 
```

运行上述文件如下：

```
$> ./test3.sh 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T09:58:35.283

也许您可以尝试 bash -i 强制会话处于交互模式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T10:11:40.260

您的示例中的问题是您将脚本的输入（以及间接的`telnet`）链接到`echo`. 所以在`echo`完成并`telnet`启动之后，就没有更多的输入要读取了。一个简单的解决方法是替换`echo "testhost"`为`{ echo "testhost"; cat; }`.

编辑：`telnet`似乎不喜欢从管道中获取输入。但是，`netcat`在这种情况下确实并且可能只适合。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T13:30:33.673

@muz我有一个ssh设置，没有telnet，所以我无法测试你的问题是否与telnet相关，但是运行以下脚本会连续将我记录到不同的机器上，要求输入密码。

```
for i in adele betty
do
ssh all@$i
done 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-02T12:56:37.650

如果您的环境是基于 X11 的，则可以打开一个运行 telnet 的 xterm：

```
xterm -e telnet $host $port 
```

xterm 中的操作是交互式的，并且 shell 脚本会暂停，直到 xterm 终止。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-09-15T06:36:42.523

试试这些链接。

[http://planetozh.com/blog/2004/02/telnet-script/](http://planetozh.com/blog/2004/02/telnet-script/)

[http://www.unix.com/unix-dummies-questions-answers/193-telnet-script.html](http://www.unix.com/unix-dummies-questions-answers/193-telnet-script.html)

```
#!/bin/sh
( echo open hostname
sleep 5
echo username
sleep 1
echo password
sleep 1
echo some more output, etc. ) | telnet 
```

他们为我工作：D

# java - 您可以在诺基亚手机 (N80/N95) 上使用 Java Midlet 录制音频而不会导致 JVM 泄漏内存吗？

> ID：100832
> 
> 赞同：2
> 
> 时间：2008-09-19T09:54:43.810
> 
> 标签：java, audio, memory-leaks, nokia, midlet

我想在带有 Java Midlet 的诺基亚手机上反复捕获音频片段。我目前的经验是使用 Sun 文档中的代码（参见：http: [//java.sun.com/javame/reference/apis/jsr135/javax/microedition/media/control/RecordControl.html](http://java.sun.com/javame/reference/apis/jsr135/javax/microedition/media/control/RecordControl.html)）并将其包装在“ while(true)" 循环有效，但应用程序会慢慢消耗手机上的所有内存，程序最终会抛出异常并且无法启动进一步的录制。

消耗的内存不是 Java 堆内存——我的示例程序（如下）显示 Java 内存大致保持静态，大约为 185,000 字节——但诺基亚提供的底层支持库中存在某种内存泄漏；我相信会发生内存泄漏，因为如果您在运行 Java 应用程序一段时间后尝试启动另一个（非 Java）应用程序（例如 Web 浏览器），手机会终止该应用程序并发出有关内存不足的警告。

我已经尝试了几种不同的方法，这些方法与 Sun 在文档中的规范示例所采用的方法不同（每次循环初始化所有内容，尽可能只初始化一次，调用尽可能多的解除分配风格的函数，这些函数不应该是绝对必要的ETC。）。似乎没有一个是成功的。下面是一个简单的示例程序，我认为它应该可以工作，但在 N80（尽管有固件更新）和 N95 上运行 15 分钟左右后崩溃。其他论坛也报告了这个问题，但那里提出的解决方案似乎不起作用（例如，参见：[http](http://discussion.forum.nokia.com/forum/showthread.php?t=129876) ://discussion.forum.nokia.com/forum/showthread.php?t=129876 ）。

```
import javax.microedition.media.*;
import javax.microedition.midlet.*;
import javax.microedition.lcdui.*;
import java.io.*;

public class Standalone extends MIDlet {

protected void startApp() {

 final Form form = new Form("Test audio recording");
 final StringItem status = new StringItem("Status","");
 form.append(status);
 final Command exit = new Command("Exit", Command.EXIT, 1);
 form.addCommand(exit);
 form.setCommandListener(new CommandListener() {
    public void commandAction(Command cmd, Displayable disp) {
        if (cmd == exit) {
        destroyApp(false);
        notifyDestroyed();
        }
    }
    });

 Thread t = new Thread(){
    public void run() {
        int counter = 0;
        while(true) {
        //Code cut 'n' paste from Sun JSR135 javadocs for RecordControl:
        try {
            Player p = Manager.createPlayer("capture://audio");
            p.realize();
            RecordControl rc = (RecordControl)p.getControl("RecordControl");
            ByteArrayOutputStream output = new ByteArrayOutputStream();
            rc.setRecordStream(output);
            rc.startRecord();
            p.start();
            Thread.currentThread().sleep(5000);
            rc.commit();
            p.close();
        } catch (Exception e) {
            status.setText("completed "+counter+
                   " T="+Runtime.getRuntime().totalMemory()+
                   " F="+Runtime.getRuntime().freeMemory()+
                   ": Error: "+e);
            break;
        }
        counter++;
        status.setText("completed "+counter+
                   " T="+Runtime.getRuntime().totalMemory()+
                   " F="+Runtime.getRuntime().freeMemory());
        System.gc(); //One forum post suggests this, but doesn't help
        this.yield();
        }
    }
    };
 t.start(); 
 final Display display = Display.getDisplay(this);
 display.setCurrent(form);
}

protected void pauseApp() {}
protected void destroyApp(boolean bool) {}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-20T21:28:54.467

N 系列诺基亚设备存在已知的内存泄漏。它不是特定于 Java 的，它位于操作系统的某个地方。

最近在开发一款针对诺基亚 N90 的游戏时，我遇到了类似的问题。我会遇到内存问题，这些问题会在应用程序的多次不同重新启动时累积。解决的办法就是降低游戏的整体质量和资源量……

我建议尝试更新您的固件，因为较新的版本应该可以解决此问题。但是，诺基亚并没有让升级固件变得很容易，在大多数情况下，您必须将设备发送给诺基亚。而且，如果这个应用程序不只是供您个人使用，那么您必须期望任何使用 N 系列设备的人都没有最新的固件。

最后，我建议花一些时间浏览诺基亚论坛，因为我知道有与内存泄漏和 N 系列设备相关的帖子。这是一篇似乎可以解决您遇到的问题的帖子。

[http://discussion.forum.nokia.com/forum/showthread.php?t=123486](http://discussion.forum.nokia.com/forum/showthread.php?t=123486)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T10:05:49.353

我认为你应该提交一份错误报告，而不是试图解决这个问题。

# networking - 人为创建连接超时错误

> ID：100841
> 
> 赞同：345
> 
> 时间：2008-09-19T09:57:47.283
> 
> 标签：networking, network-programming, connection, tcp

当我收到连接超时时，我们的软件中出现了一个错误。这些错误非常罕见（通常是当我的连接被我们的内部网络断开时）。我怎样才能人为地产生这种效果，以便我可以测试我们的软件？

如果重要的话，应用程序是使用 CAsyncSocket 类在 C++/MFC 中编写的。

**编辑：**

我尝试使用不存在的主机，但出现套接字错误：

> WSAEINVAL (10022) 参数无效

我的下一个尝试是使用[Alexander](https://stackoverflow.com/questions/100841?sort=oldest#100859)的建议连接到不同的端口，例如 81（虽然在我自己的服务器上）。那效果很好。与断开连接完全相同（等待 60 秒，然后出错）。谢谢！

* * *

## 回答 #1

> 赞同：484
> 
> 时间：2009-05-24T20:42:43.377

连接到不可路由的 IP 地址，例如 10.255.255.1。

* * *

## 回答 #2

> 赞同：358
> 
> 时间：2008-09-19T10:02:57.660

连接到现有主机，但连接到被防火墙阻止的端口，该端口仅丢弃 TCP SYN 数据包。例如，www.google.com:81。

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2019-06-05T11:27:52.907

很多好的答案，但最干净的解决方案似乎是[这项服务](http://httpstat.us)

`http://httpstat.us/504?sleep=60000`

您可以配置超时持续时间（最长 230 秒）和最终返回码。

* * *

## 回答 #4

> 赞同：62
> 
> 时间：2016-05-26T15:50:18.750

如果您在 unix 机器上，您可以使用 netcat 启动端口侦听：

```
nc -l 8099 
```

然后，修改您的服务以调用它通常对该端口执行的任何操作，例如[http://localhost:8099/some/sort/of/endpoint](http://localhost:8099/some/sort/of/endpoint)

然后，您的服务将打开连接并写入数据，但永远不会得到响应，因此会给您一个 Read Time Out（而不是 Connection Refused）

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2016-11-07T06:45:10.217

以下 URL 总是给出超时，并结合了上面 @Alexander 和 @Emu 的最佳答案：

[http://example.com:81](http://example.com:81)

使用`example.com:81`是对亚历山大答案的改进，因为 example.com 是由 DNS 标准保留的，所以它总是无法访问的，不像`google.com:81`，如果谷歌喜欢它可能会改变。此外，由于`example.com`定义为不可访问，因此您不会淹没 Google 的服务器。

我会说这是对@emu 答案的改进，因为它更容易记住。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2015-07-23T07:54:41.807

*   10.0.0.0
*   10.255.255.255
*   172.16.0.0
*   172.31.255.255
*   192.168.0.0
*   192.168.255.255

所有这些都是不可路由的。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2013-04-16T22:09:50.350

您可以使用 Python REPL 在接收数据时模拟超时（即在成功建立连接之后）。只需要标准的 Python 安装即可。

```
Python 2.7.4 (default, Apr  6 2013, 19:54:46) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import socket
>>> s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)        
>>> s.bind(('localhost', 9000))
>>> s.listen(0)
>>> (clientsocket, address) = s.accept() 
```

现在它等待传入的连接。将您想要测试的任何内容连接到`localhost:9000`. 当你这样做时，Python 将接受连接`accept()`并将其返回。除非您通过 发送任何数据`clientsocket`，否则调用方的套接字应该在下一个`recv()`.

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2014-02-20T10:45:35.323

我想向大家指出[mitmproxy](https://mitmproxy.org/)。

使用配置（取自他们的示例），`200:b@100:dr`您将获得一个随机断开的连接。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2010-03-12T15:05:33.053

软件解决方案怎么样：

在应用服务器上安装 SSH 服务器。然后，使用套接字隧道在您的本地端口和应用程序服务器上的远程端口之间创建一个链接。您可以使用 ssh 客户端工具来执行此操作。让您的客户端应用程序连接到映射的本地端口。然后，您可以随意打破套接字隧道以模拟连接超时。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2016-08-15T19:30:03.793

如果您想使用活动连接，您还可以使用[http://httpbin.org/delay/#](http://httpbin.org/delay/#)，其中 # 是您希望他们的服务器在发送响应之前等待的时间。只要您的超时时间短于延迟...应该模拟效果。我已经成功地将它与 python requests 包一起使用。

如果您发送任何敏感信息，您可能需要修改您的请求 - 不知道发送给他们的数据会发生什么。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-09-11T23:22:14.663

有一些可用的服务允许您通过调用 API 来人为地创建原始超时，您可以在其中指定服务器响应所需的时间。macgyver 上的服务器超时是此类服务的一个示例。

例如，如果您想测试一个需要 15 秒才能响应的请求，您只需向 macgyver API 发出一个 post 请求。

JSON有效负载：

```
{
    "timeout_length": 15000
} 
```

API 响应（15 秒后）：

```
{
    "response": "ok"
} 
```

macgyver 上的服务器超时程序
[https://askmacgyver.com/explore/program/server-timeout/3U4s6g6u](https://askmacgyver.com/explore/program/server-timeout/3U4s6g6u)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-19T10:10:40.950

您可以安装 Microsoft Loopback 驱动程序，该驱动程序将为您创建一个单独的界面。然后您可以将其连接到您的某些服务（您自己的主机）。然后在网络连接中，您可以禁用/启用此类界面...

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-19T13:20:35.240

尽管还不完全清楚 OP 想要测试哪一个：尝试连接到不存在的主机/端口与已建立的连接超时之间存在差异。我会和 Rob 一起去，等到连接正常，然后拉电缆。或者 - 为方便起见 - 将虚拟机用作测试服务器（使用桥接网络），并在建立连接后停用虚拟网络接口。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-03-27T21:08:06.613

我经常用来模拟随机连接超时的技术是使用 ssh 本地端口转发。

```
ssh -L 12345:realserver.com:80 localhost 
```

这会将 localhost:12345 上的流量转发到 realserver.com:80 如果需要，您也可以在自己的本地计算机上循环它：

```
ssh -L 12345:localhost:8080 localhost 
```

因此，您可以将您的应用程序指向您的本地主机和自定义端口，并且流量将被路由到目标主机：端口。然后你可以退出这个shell（退出后你可能还需要ctrl+c shell），它会终止转发，导致你的应用程序看到连接丢失。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-19T10:03:27.517

我过去曾使用过几种策略来模拟网络问题；

1.  拔出网线
2.  关闭您的机器和“目标”机器之间的开关（理想情况下，计算机插入的开关仍处于通电状态，以便机器保持其“网络连接”）
3.  在目标机器上运行防火墙软件，静默丢弃接收到的数据

其中一个想法可能会为您提供一些人工生成所需场景的方法

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-19T10:03:38.517

根据您安装/可用的防火墙软件，您应该能够阻止传出端口，并且根据防火墙的设置方式，它应该只丢弃连接请求数据包。没有连接请求，没有连接，超时。如果它在路由器级别实现，这可能会更好（他们倾向于丢弃数据包而不是发送重置，或任何等效的情况），但肯定会有一个软件包也可以做到这一点。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-19T10:09:43.680

我遇到了与您相同的问题。为了测试软件的行为，我只是在适当的时候拔掉了网线。在我想拔掉电缆之前，我必须设置一个断点。

如果我再做一次，我会在网络电缆中放置一个开关（一个常闭瞬时按钮）。

如果物理断开导致不同的行为，您可以将计算机连接到便宜的集线器，并将上面提到的交换机放在集线器和主网络之间。

-- 编辑 -- 在许多情况下，您需要网络连接正常工作，直到您到达程序中的某个点，然后您需要使用提供的众多建议之一断开连接。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-19T10:10:20.420

最简单的方法是使用[CurrPorts](http://www.nirsoft.net/utils/cports.html)断开连接。

但是，为了对您的异常处理代码进行单元测试，也许您应该考虑抽象您的网络连接代码，并编写一个按需抛出异常的存根、模拟或装饰器。然后，您将能够测试应用程序错误处理逻辑，而无需实际使用网络。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-08-11T18:40:15.913

对我来说，最简单的方法是在基于目标网络的办公室路由器上添加静态路由。只需将流量路由到一些无响应的主机（例如您的计算机），您就会收到请求超时。

对我来说最好的事情是可以通过 Web 界面管理静态路由并轻松启用/禁用。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2008-09-19T10:09:57.363

您可以尝试通过外部可能无法使用的端口（例如 200）连接到知名网站之一。大多数防火墙都在 DROP 模式下工作，它会为您模拟超时。

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2008-09-19T10:00:33.033

将您的网络电缆插入没有其他连接/电缆的交换机。恕我直言，这应该有效。

# c# - 你如何投射一个 IEnumerable 或 IQueryable 到实体集 ?

> ID：100851
> 
> 赞同：12
> 
> 时间：2008-09-19T10:00:41.860
> 
> 标签：c#, .net, linq

在这种情况下，我尝试使用 LINQ to XML 和 LINQ to SQL 执行从 XML 文件到数据库的数据导入。

这是我的 LINQ 数据模型：

```
public struct Page
{
    public string Name;
    public char Status;
    public EntitySet<PageContent> PageContents;

}
public struct PageContent
{
    public string Content;
    public string Username;
    public DateTime DateTime;
} 
```

基本上我要做的是编写一个查询，它会给我一个数据结构，我可以提交给我的 LINQ 数据上下文。

```
IEnumerable<Page> pages = from el in doc.Descendants()
                          where el.Name.LocalName == "page"
                          select new Page()
                {
                    Name = el.Elements().Where(e => e.Name.LocalName == "title").First().Value,
                    Status = 'N',
                    PageContents = (from pc in el.Elements()
                                    where pc.Name.LocalName == "revision"
                                    select new PageContent()
                                    {
                                       Content = pc.Elements().Where(e => e.Name.LocalName=="text").First().Value,
                                       Username = pc.Elements().Where(e => e.Name.LocalName == "contributor").First().Elements().Where(e => e.Name.LocalName == "username").First().Value,
                                       DateTime = DateTime.Parse(pc.Elements().Where(e => e.Name.LocalName == "timestamp").First().Value)
                                    }).ToList()
                }; 
```

问题出在子查询中。我必须以某种方式将我的对象集合放入 EntitySet 容器中。我不能施放它（哦，天哪，我试过了）并且没有 EntitySet() 构造函数似乎有帮助。

那么，我可以编写一个 LINQ 查询，用我的 IEnumerable<Page> 数据填充 EntitySet<PageContent> 数据吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-19T10:29:09.983

您可以使用辅助类从 IEnumerable 构造实体集，例如：

```
public static class EntityCollectionHelper
{
    public static EntitySet<T> ToEntitySet<T>(this IEnumerable<T> source) where T:class
    {
        EntitySet<T> set = new EntitySet<T>();
        set.AddRange(source);
        return set;
    }
} 
```

并像这样使用它：

```
PageContents = (from pc in el.Elements()
                                where pc.Name.LocalName == "revision"
                                select new PageContent()
                                {
                                   Content = pc.Elements().Where(e => e.Name.LocalName=="text").First().Value,
                                   Username = pc.Elements().Where(e => e.Name.LocalName == "contributor").First().Elements().Where(e => e.Name.LocalName == "username").First().Value,
                                   DateTime = DateTime.Parse(pc.Elements().Where(e => e.Name.LocalName == "timestamp").First().Value)
                                }).ToEntitySet() 
```

# .net - <%# 和 <%= 开始标签有什么区别？

> ID：100853
> 
> 赞同：5
> 
> 时间：2008-09-19T10:01:11.767
> 
> 标签：.net, asp.net

在编辑一个 aspx 文件时，我发现这两个开始标签用于看似相同的事情。有区别吗？如果有，那是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-19T10:09:49.967

`<%=`相当于`<% Repsonse.Write()`

您可以在这里写出任何内容：例如

```
<%=myProperty + " additional Text" %> 
```

`<%#`是一个绑定表达式。您可以检索当前上下文中的任何公共值（例如在 GridViews 中）。但是你不能在这里混合内容。

查看[MSDN](http://msdn.microsoft.com/en-us/library/ms178366.aspx)以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T10:07:19.007

不同之处在于 # 符号指定了一个数据绑定指令，该指令在数据绑定时解析（例如，当您调用 Page.DataBind 时），而 = 符号指定了一个评估表达式，当该行只计算并打印到 HTML 输出被处理。

编辑：只需在 <%# %> 内添加，您就可以访问 Eval 等数据绑定函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T10:10:29.107

<%= 是 Response.Write() 的简写。
<%# 表示您正在使用数据绑定控件中的数据容器。

# c# - 在 C# 代码中重用 .h 文件中的定义语句

> ID：100854
> 
> 赞同：6
> 
> 时间：2008-09-19T10:02:03.217
> 
> 标签：c#, c++, header, c-preprocessor, versioning

我有 C++ 项目（VS2005），它在#define 指令中包含带有版本号的头文件。现在我需要在双 C# 项目中包含完全相同的数字。最好的方法是什么？

我正在考虑将此文件作为资源包含在内，然后在运行时使用正则表达式对其进行解析以恢复版本号，但也许有更好的方法，你觉得呢？

我不能将版本移到 .h 文件之外，构建系统也依赖于它，而 C# 项目是一个应该适应的项目。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-04-12T16:55:55.617

我会考虑使用 .tt 文件来处理 .h 并将其转换为 .cs 文件。它非常简单，然后源文件将成为您的 C# 解决方案的一部分（这意味着它们将随着 .h 文件的更改而刷新），可以单击以在编辑器中打开，等等。

如果您只有 1 个#define，它可能有点矫枉过正，但如果您有一个充满它们的文件（例如，可能是一个 mfc resource.h 文件），那么这个解决方案将成为一个巨大的胜利。

例如：创建一个文件 DefineConverter.tt 并将其添加到您的项目中，将标记的行更改为引用您的 .h 文件，您将在项目中获得一个充满静态 const 条目的新类。（注意输入文件是相对于您的项目文件的，如果您想要绝对路径，请设置 hostspecific=false）。

```
<#@ template language="C#v3.5" hostspecific="True" debug="True" #>
<#@ output extension="cs" #>
<#@ assembly name="System.Core.dll" #>
<#@ import namespace="System" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="System.IO" #>

<#
string input_file = this.Host.ResolvePath("resource.h");             <---- change this
StreamReader defines = new StreamReader(input_file);
#>
//------------------------------------------------------------------------------
//     This code was generated by template for T4
//     Generated at <#=DateTime.Now#>
//------------------------------------------------------------------------------

namespace Constants
{
    public class <#=System.IO.Path.GetFileNameWithoutExtension(input_file)#>
    {
<#
    // constants definitions

    while (defines.Peek() >= 0)
    {
        string def = defines.ReadLine();
        string[] parts;
        if (def.Length > 3 && def.StartsWith("#define"))
        {
            parts = def.Split(null as char[], StringSplitOptions.RemoveEmptyEntries);
            try {
                Int32 numval = Convert.ToInt32(parts[2]);
                #>
        public static const int <#=parts[1]#> = <#=parts[2]#>;
<#
            }
            catch (FormatException e) {
            #>
        public static const string <#=parts[1]#> = "<#=parts[2]#>";
<#
            }
        }
    } #> 
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-19T10:14:29.630

MSDN 告诉我们：

> #define 指令不能像 C 和 C++ 中通常那样用于声明常量值。C# 中的常量最好定义为类或结构的静态成员。如果您有多个这样的常量，请考虑创建一个单独的“常量”类来保存它们。

您可以使用包含类的托管 C++ 创建库 - 围绕您的常量进行包装。然后你可以从 C# 项目中引用这个类。只是不要忘记在常量声明中使用**readonly < type >**而不是**const < type >** :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T10:15:47.393

您始终可以使用预构建事件在 .cs 文件上运行 C 预处理器，并使用构建后事件来撤消预构建步骤。预处理器只是一个文本替换系统，所以这是可能的：

```
// version header file
#define Version "1.01"

// C# code
#include "version.h"
// somewhere in a class
string version = Version; 
```

预处理器将生成：

```
// C# code
// somewhere in a class
string version = "1.01"; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-19T10:18:02.333

您只需几个步骤即可实现您想要的：

1.  创建一个 MSBuild 任务 - [http://msdn.microsoft.com/en-us/library/t9883dzc.aspx](http://msdn.microsoft.com/en-us/library/t9883dzc.aspx)
2.  更新项目文件以包含对在构建之前创建的任务的调用

该任务接收一个参数，其中包含您引用的头 .h 文件的位置。然后它会提取版本并将该版本放入您之前创建的 C# 占位符文件中。或者，您可以考虑使用通常包含版本的 AssemblyInfo.cs，如果这对您来说可以的话。

如果您需要更多信息，请随时发表评论。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T10:18:21.257

您可以编写包含此 .h 文件的简单 C++/C 实用程序并动态创建可在 C# 中使用的文件。
该实用程序可以作为 C# 项目的一部分作为预构建阶段运行。
这样，您始终与原始文件同步。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-05T20:20:16.787

基于 gbjbaanb 的解决方案，我创建了一个 .tt 文件，该文件在特定目录中查找所有 .h 文件，并将它们滚动到具有多个类的 .cs 文件中。

差异

*   我添加了对双打的支持
*   从 try-catch 切换到 TryParse
*   读取多个 .h 文件
*   使用“只读”而不是“常量”
*   **修剪以;**结尾的 #define 行
***   命名空间是根据项目中的 .tt 位置设置的**

 *** * *

```
<#@ template language="C#" hostspecific="True" debug="True" #>
<#@ output extension="cs" #>
<#@ assembly name="System.Core.dll" #>
<#@ import namespace="System" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="System.IO" #>
<#
string hPath = Host.ResolveAssemblyReference("$(ProjectDir)") + "ProgramData\\DeltaTau\\";  
string[] hFiles = System.IO.Directory.GetFiles(hPath, "*.h", System.IO.SearchOption.AllDirectories);
var namespaceName = System.Runtime.Remoting.Messaging.CallContext.LogicalGetData("NamespaceHint");
#>
//------------------------------------------------------------------------------
//     This code was generated by template for T4
//     Generated at <#=DateTime.Now#>
//------------------------------------------------------------------------------

namespace <#=namespaceName#>
{
<#foreach (string input_file in hFiles)
{
StreamReader defines = new StreamReader(input_file);
#>
    public class <#=System.IO.Path.GetFileNameWithoutExtension(input_file)#>
    {
<#    // constants definitions

    while (defines.Peek() >= 0)
    {
        string def = defines.ReadLine();
        string[] parts;
        if (def.Length > 3 && def.StartsWith("#define"))
        {
            def = def.TrimEnd(';');
            parts = def.Split(null as char[], StringSplitOptions.RemoveEmptyEntries);
            Int32 intVal;
            double dblVal;
            if (Int32.TryParse(parts[2], out intVal))
            {
            #>
        public static readonly int <#=parts[1]#> = <#=parts[2]#>;           
<#
            }
            else if (Double.TryParse(parts[2], out dblVal))
            {
            #>
        public static readonly double <#=parts[1]#> = <#=parts[2]#>;            
<#
            }
            else
            {
            #>
        public static readonly string <#=parts[1]#> = "<#=parts[2]#>";
<#          
            }
        }
    } #>
    }
<#}#>     
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T19:26:31.867

我编写了一个 python 脚本，将#define FOO "bar" 转换为 C# 中可用的东西，我在我的 C# 项目的预构建步骤中使用它。有用。

```
# translate the #defines in messages.h file into consts in MessagesDotH.cs

import re
import os
import stat

def convert_h_to_cs(fin, fout):
    for line in fin:
        m = re.match(r"^#define (.*) \"(.*)\"", line)
        if m != None:
            if m.group() != None:
                fout.write( "public const string " \
                + m.group(1) \
                + " = \"" \
                + m.group(2) \
                + "\";\n" )
        if re.match(r"^//", line) != None:
            fout.write(line)

fin = open ('..\common_cpp\messages.h')
fout = open ('..\user_setup\MessagesDotH.cs.tmp','w')

fout.write( 'using System;\n' )
fout.write( 'namespace xrisk { class MessagesDotH {\n' )

convert_h_to_cs(fin, fout)

fout.write( '}}' )

fout.close()

s1 = open('..\user_setup\MessagesDotH.cs.tmp').read()

s2 = open('..\user_setup\MessagesDotH.cs').read()

if s1 != s2:
    os.chmod('..\user_setup\MessagesDotH.cs', stat.S_IWRITE)
    print 'deleting old MessagesDotH.cs'
    os.remove('..\user_setup\MessagesDotH.cs')
    print 'remaming tmp to MessagesDotH.cs'
    os.rename('..\user_setup\MessagesDotH.cs.tmp','..\user_setup\MessagesDotH.cs')
else:
    print 'no differences.  using same MessagesDotH.cs' 
```**

# asp.net - 扩展 Asp.Net 所需的帮助

> ID：100860
> 
> 赞同：3
> 
> 时间：2008-09-19T10:03:08.597
> 
> 标签：asp.net

大多数人都知道，如果我将名为 app_offline.htm 的文件放到 asp.net 应用程序的根目录中，它会使应用程序脱机[，详见此处](http://asp-net-whidbey.blogspot.com/2006/04/aspnet-20-features-appofflinehtm.html)。

您还会知道，虽然这很好，但 IIS 实际上会在此过程中返回 404 代码，并且 Microsoft 不会对此采取任何措施，[如此处所述](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=319986)。

现在，由于 Asp.Net 通常是如此可扩展，我在想不应该有一种方法可以覆盖此状态代码以返回 503 吗？问题是，我不知道从哪里开始寻求做出这种改变。

帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T10:17:53.927

app_offline.htm 的处理在 ASP.NET 管道中是硬编码的，并且无法修改：请参阅`CheckApplicationEnabled()`，`HttpRuntime.cs`如果应用程序被认为处于脱机状态，它将引发非常不可配置的 404 错误。

然而，[创建自己的 HTTP 模块](http://support.microsoft.com/kb/307996)来做类似的事情当然是微不足道的——在这种情况下 OnBeginRequest 处理程序可能如下所示（显示了 HttpHandler 的实现，但在 HttpModule 中的想法完全相同）：

```
Public Sub ProcessRequest(ByVal ctx As System.Web.HttpContext) Implements IHttpHandler.ProcessRequest
    If IO.File.Exists(ctx.Server.MapPath("/app_unavailable.htm")) Then
        ctx.Response.Status = "503 Unavailable (in Maintenance Mode)"
        ctx.Response.Write(String.Format("<html><h1>{0}</h1></html>", ctx.Response.Status))
        ctx.Response.End()
    End If
End Sub 
```

当然，这只是一个起点：通过使返回的 HTML 更友好一点，您也可以向您的用户显示一个漂亮的“我们马上回来”页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T10:08:27.460

您可以尝试在 web.config 中将其关闭。

```
<httpRuntime enable = "False"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T10:17:31.587

您可能可以通过编写自己的 HTTP 处理程序（实现 System.Web.IHttpHandler 接口的 .NET 组件）来实现。

这里有一篇很好的入门文章： [链接文本](http://www.15seconds.com/issue/020417.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-20T11:50:52.930

原始问题的第一个链接中突出显示的 app_offline.htm 和 httpRuntime enable = "False" 的一个优点是不再加载应用程序的应用程序域，这对于大量站点更改可能是可取的。对 leppie 的回答（仍然为 404 服务）的轻微修改是添加一个 defaultRedirect 到另一个网站，这将允许源站点处于关闭状态，然后目标站点将提供一个简单的 503 生成页面

web.config 源站点

```
<httpRuntime enable="false" />
<customErrors mode="On" defaultRedirect="/maintainance.aspx"/> 
```

目标站点中的维护.aspx

```
<%@Page Language="C#"%>
<% 
    Response.StatusCode = 503;
    Response.Write("App offline for maintainance"); 
%> 
```

# browser - 浏览器检测

> ID：100898
> 
> 赞同：10
> 
> 时间：2008-09-19T10:11:55.640
> 
> 标签：browser, browser-detection

检测用户浏览器的最佳/最简单/最准确的方法是什么？

易于扩展和实施是一个优点。

使用的技术越少越好。

解决方案可以是服务器端、客户端或两者兼而有之。不过，结果最终应该会出现在服务器上。

该解决方案可以与框架无关。

该解决方案将仅用于报告目的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-19T10:17:12.400

在服务器上，您几乎受限于浏览器提供的 UserAgent 字符串（这充满了问题，请阅读有关[UserAgent 字符串的历史记录](http://www.webaim.org/blog/user-agent-string-history/)）。

在客户端（即在 Javascript 中），您有更多选择。但最好的选择是实际上不必担心确定它是哪个浏览器。只需检查以确保您要使用的任何功能确实存在。

例如，您可能想要使用只有 MSIE 提供的 setCapture：

```
if (element.setCapture) element.setCapture() 
```

与其弄清楚浏览器是什么，然后推断它的功能，我们只是在使用它之前看看它是否支持某些东西——谁知道未来哪些浏览器会支持什么，你真的想回去更新吗？如果 Safari 决定支持 setCapture，你的脚本呢？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-19T10:14:01.050

[JQuery 浏览器插件](http://jquery.thewikies.com/browser/)将在客户端为您完成。

> **什么是 jQuery 浏览器插件？**
> 
> jQuery 浏览器插件是 jQuery 的一个插件，可以轻松地唯一识别访问者的浏览器。
> 
> **它有什么作用？**
> 
> 它为您提供了一个 javascript 对象，其中包含有关正在使用的浏览器的所有信息。它还添加了 CSS 浏览器选择器，这意味着您可以为特定浏览器、浏览器版本、布局、布局版本甚至操作系统设置元素样式或编写函数。运行中的 jQuery 浏览器插件的图像。

该插件`$.browser`可用，如果您确实需要服务器端，您可以通过 AJAX 调用将其重新提交到您的服务器。

```
alert($.browser.name);  // Alerts Firefox for me 
```

但是，该插件将仅与它所测试的浏览器一样有效。上面列出的插件有一个[在其测试中识别的浏览器](http://jquery.thewikies.com/browser/test.html)列表，但总是存在新浏览器会偷偷溜出的风险（[谷歌浏览器..](http://www.google.com/chrome)），这需要重新编写识别规则。也就是说，这个插件似乎会定期更新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T10:21:41.123

使用 javascript 时：**不要使用浏览器检测**

编写代码，针对浏览器展示的给定案例进行自我测试，否则您只会为非常少的人群编写代码。最好在需要的地方使用`"typeof foo == 'undefined'"`和浏览器特定的技巧。

jQuery 在其代码库中执行此操作（如果您查看代码，您会看到它实现了针对不同浏览器技术的行为）

从长远来看它更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T10:16:27.660

由于我刚刚在一个（现已删除的问题）中发布了它并且它仍在我的粘贴缓冲区中，所以我将重新发布。注意：这是一个服务器端的 PHP 解决方案

我目前为此使用以下代码。这几乎不是一个令人筋疲力尽的解决方案，但它应该很容易实现更多的浏览器。我不知道[user-agents.org](http://user-agents.org/)（感谢 PConroy），“这些天之一”我会遍历它，看看我是否可以更新并添加到我的列表中。

```
define("BROWSER_OPERA","Opera");
define("BROWSER_IE","IE");
define("BROWSER_OMNIWEB","Omniweb");
define("BROWSER_KONQUEROR","Konqueror");
define("BROWSER_SAFARI","Safari");
define("BROWSER_MOZILLA","Mozilla");
define("BROWSER_OTHER","other");

$aBrowsers = array
(
  array("regexp" => "@Opera(/| )([0-9].[0-9]{1,2})@", "browser" => BROWSER_OPERA, "index" => 2),
  array("regexp" => "@MSIE ([0-9].[0-9]{1,2})@", "browser" => BROWSER_IE, "index" => 1),
  array("regexp" => "@OmniWeb/([0-9].[0-9]{1,2})@", "browser" => BROWSER_OMNIWEB, "index" => 1),
  array("regexp" => "@(Konqueror/)(.*)(;)@", "browser" => BROWSER_KONQUEROR, "index" => 2),
  array("regexp" => "@Safari/([0-9]*)@", "browser" => BROWSER_SAFARI, "index" => 1),
  array("regexp" => "@Mozilla/([0-9].[0-9]{1,2})@", "browser" => BROWSER_MOZILLA, "index" => 1)
);

foreach($aBrowsers as $aBrowser)
{
  if (preg_match($aBrowser["regexp"], $_SERVER["HTTP_USER_AGENT"], $aBrowserVersion))
  {
    define("BROWSER_AGENT",$aBrowser["browser"]);
    define("BROWSER_VERSION",$aBrowserVersion[$aBrowser["index"]]);
    break;
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T10:15:17.507

正如丹所说：这取决于所使用的技术。

对于 PHP 服务器端浏览器检测，我推荐 Harald Hope 的浏览器检测：

[http://techpatterns.com/downloads/php_browser_detection.php](http://techpatterns.com/downloads/php_browser_detection.php)

在 GPL 下发布。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T20:32:07.310

不要使用浏览器检测：

*   在最好的情况下，浏览器检测并不是 100% 可靠的，但情况比这更糟：
*   浏览器有很多变体（MSIE 定制等）
*   浏览器可以谎报自己的身份（Opera 实际上内置了这个功能）
*   网关隐藏或混淆浏览器的身份
*   定制和网关供应商在 USER_AGENT 中编写自己的垃圾

最好在客户端脚本中进行特征检测。希望您只需要浏览器检测来解决特定浏览器和版本中的错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-25T12:13:48.207

我最初问这个问题是因为我希望能够记录人们用来访问我的网站的浏览器和操作系统。是的，用户代理字符串不可信，是的，您不应该使用浏览器检测来确定在 JS 中运行哪些代码，但是，我希望获得尽可能准确的统计信息。

我做了以下。

我正在使用 JavaScript 和 PHP 的组合来记录统计信息。JavaScript 来确定什么浏览器和操作系统（因为这*可能*是最准确的），以及 PHP 来记录它：

JavaScript 来自[Quirksmode](http://www.quirksmode.org/js/detect.html)，PHP 是不言而喻的。我使用[MooTools](http://mootools.net) JS 框架。

将以下内容添加到 BrowserDetect 脚本：

```
window.addEvent('domready', function() {
    if (BrowserDetect) {
        var q_data = 'ajax=true&browser=' + BrowserDetect.browser + '&version=' + BrowserDetect.version + '&os=' + BrowserDetect.OS;
        var query = 'record_browser.php'
        var req = new Request.JSON({url: query, onComplete: setSelectWithJSON, data: q_data}).post();
    }
}); 
```

这确定了用户浏览器的浏览器、浏览器版本和操作系统，并将其发送到`record_browser.php`脚本。该`record_browser.php`脚本只是添加信息，以及 PHP`session_id`和 current `user_id`（如果存在）。

MySQL 表：

```
CREATE TABLE `browser_detects` (
  `id` int(11) NOT NULL auto_increment,
  `session` varchar(255) NOT NULL default '',
  `user_id` int(11) NOT NULL default '0',
  `browser` varchar(255) NOT NULL default '',
  `version` varchar(255) NOT NULL default '',
  `os` varchar(255) NOT NULL default '',
  PRIMARY KEY  (`id`),
  UNIQUE KEY `sessionUnique` (`session`)
) 
```

PHP代码：

```
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $session = session_id();
    $user_id = isset($user_id) ? $user_id ? 0;
    $browser = isset($_POST['browser']) ? $_POST['browser'] ? '';
    $version = isset($_POST['version']) ? $_POST['version'] ? '';
    $os = isset($_POST['os']) ? $_POST['os'] ? '';
    $q = $conn->prepare('INSERT INTO browser_detects (`session`, `user`, `browser`, `version`, `os`) VALUES (:session :user, :browser, :version, :os)');
    $q->execute(array(
                    ':session' => $session,
                    ':user' => $user_id,
                    ':browser' => $browser,
                    ':version' => $version,
                    ':os' => $os
                ));
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-14T17:44:09.603

正如许多人所说，浏览器检测可能会出错……但是出于 Code Golf 的利益。

这是检测 IE 的一种非常快速的方法。

```
<script>
  if('\v'=='v'){
    alert('I am IE');
  } else {
    alert('NOT IE');
  }
</script> 
```

实际上它非常整洁，因为它可以在不触发 Opera 的情况下选择 IE。

如果您知道**为什么**这在 IE 中有效，则可以加分。;-)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-06-08T16:37:34.337

**编辑**：不推荐以下解决方案。试试这个：[http ://whichbrowser.net/](http://whichbrowser.net/)

这曾经对我有用，但现在看代码，我不知道如何。改用上面的：-/

```
<script type="text/javascript">
    // <![CDATA[
    var BrowserCheck = Class.create({
        initialize: function () {
            var userAgent = navigator.userAgent.toLowerCase();
            this.version = (userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/) || [])[1];
            this.safari = /webkit/.test(userAgent) && !/chrome/.test(userAgent);
            this.opera = /opera/.test(userAgent);
            this.msie = /msie/.test(userAgent) && !/opera/.test(userAgent);
            this.mozilla = /mozilla/.test(userAgent) && !/(compatible|webkit)/.test(userAgent);
            this.chrome = /chrome/.test(userAgent);
        }
    });    
    // ]]>
</script> 
```

不要忘记你需要初始化它才能使用它，所以把它放在你的代码中：

```
var UserBrowser = new BrowserCheck(); 
```

然后检查浏览器类型和版本，如下所示：（例如 Internet Explorer 8）

```
if ((UserBrowser.msie == true) && (UserBrowser.version == 8)) 
```

等等

希望它能像对我们一样为您完成工作，但请记住，没有浏览器检测是防弹的！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-01-10T19:43:42.790

这是我使用的C#代码，希望对你有所帮助。

```
StringBuilder strb = new StringBuilder();
strb.AppendFormat ( "User Agent: {0}{1}", Request.ServerVariables["http_user_agent"].ToString(), Environment.NewLine );
strb.AppendFormat ( "Browser: {0}{1}", Request.Browser.Browser.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Version: {0}{1}", Request.Browser.Version.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Major Version: {0}{1}", Request.Browser.MajorVersion.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Minor Version: {0}{1}", Request.Browser.MinorVersion.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Platform: {0}{1}", Request.Browser.Platform.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "ECMA Script version: {0}{1}", Request.Browser.EcmaScriptVersion.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Type: {0}{1}", Request.Browser.Type.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "-------------------------------------------------------------------------------{0}",  Environment.NewLine );
strb.AppendFormat ( "ActiveX Controls: {0}{1}", Request.Browser.ActiveXControls.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Background Sounds: {0}{1}", Request.Browser.BackgroundSounds.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "AOL: {0}{1}", Request.Browser.AOL.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Beta: {0}{1}", Request.Browser.Beta.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "CDF: {0}{1}", Request.Browser.CDF.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "ClrVersion: {0}{1}", Request.Browser.ClrVersion.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Cookies: {0}{1}", Request.Browser.Cookies.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Crawler: {0}{1}", Request.Browser.Crawler.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Frames: {0}{1}", Request.Browser.Frames.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Tables: {0}{1}", Request.Browser.Tables.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "JavaApplets: {0}{1}", Request.Browser.JavaApplets.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "JavaScript: {0}{1}", Request.Browser.JavaScript.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "MSDomVersion: {0}{1}", Request.Browser.MSDomVersion.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "TagWriter: {0}{1}", Request.Browser.TagWriter.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "VBScript: {0}{1}", Request.Browser.VBScript.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "W3CDomVersion: {0}{1}", Request.Browser.W3CDomVersion.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Win16: {0}{1}", Request.Browser.Win16.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "Win32: {0}{1}", Request.Browser.Win32.ToString ( ), Environment.NewLine );
strb.AppendFormat ( "-------------------------------------------------------------------------------{0}", Environment.NewLine );
strb.AppendFormat ( "MachineName: {0}{1}", Environment.MachineName, Environment.NewLine );
strb.AppendFormat ( "OSVersion: {0}{1}", Environment.OSVersion, Environment.NewLine );
strb.AppendFormat ( "ProcessorCount: {0}{1}", Environment.ProcessorCount, Environment.NewLine );
strb.AppendFormat ( "UserName: {0}{1}", Environment.UserName, Environment.NewLine );
strb.AppendFormat ( "Version: {0}{1}", Environment.Version, Environment.NewLine );
strb.AppendFormat ( "UserInteractive: {0}{1}", Environment.UserInteractive, Environment.NewLine );
strb.AppendFormat ( "UserDomainName: {0}{1}", Environment.UserDomainName, Environment.NewLine ); 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-19T20:25:39.883

对于 Internet Explorer 和样式表，您可以使用以下语法：

```
<!--[if lte IE 6]><link href="/style.css" rel="stylesheet" type="text/css" /><![endif]--> 
```

这适用于 IE 6 或更早版本。您可以更改 IE 版本，还可以：

```
<!--[if eq IE 7]> = Equal too IE 7
<!--[if gt IE 6]> = Greater than IE 6 
```

我不确定这是否适用于页面的其他部分，但在放置在`<head>`标签内时有效。有关更多信息，请参阅此[示例](http://www.quirksmode.org/css/condcom.html)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-09-25T12:17:47.353

通常，当浏览器发出请求时，它会向您发送一堆信息（时间、名称日期、用户代理...）。您应该尝试查看客户端发送的标头并转到告诉您浏览器的标头（我认为它是“User-Agent：”。

# c - 如何克服 snprintf 在不同的类 UNIX 操作系统中的不一致行为？

> ID：100904
> 
> 赞同：3
> 
> 时间：2008-09-19T10:12:36.840
> 
> 标签：c, cross-platform, buffer-overflow, buffer-overrun

根据手册页，snprintf 返回从 glibc 2.2 版开始写入的字节数。但在较低版本的 libc2.2 和 HP-UX 上，它返回一个正整数，这可能导致缓冲区溢出。

如何克服这一点并编写可移植的代码？

编辑：为了更清楚

此代码在 lib 2.3 中完美运行

```
 if ( snprintf( cmd, cmdLen + 1, ". %s%s", myVar1, myVar2 )  != cmdLen )
    {
        fprintf( stderr, "\nError: Unable to  copy bmake command!!!");
        returnCode = ERR_COPY_FILENAME_FAILED;
    } 
```

它在 Linux 上返回字符串 (10) 的长度。但相同的代码返回的正数大于 HP-UX 机器上打印的字符数。希望这个解释很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-19T10:32:47.963

您可以创建一个 snprintf 包装器，当缓冲区中没有足够的空间时，它会为每种情况返回 -1。

有关更多文档，请参见[手册页](http://linux.die.net/man/3/snprintf)。它还有一个威胁所有案例的例子。

```
 while (1) {
      /* Try to print in the allocated space. */
      va_start(ap, fmt);
      n = vsnprintf (p, size, fmt, ap);
      va_end(ap);
      /* If that worked, return the string. */
      if (n > -1 && n < size)
         return p;
      /* Else try again with more space. */
      if (n > -1)    /* glibc 2.1 */
         size = n+1; /* precisely what is needed */
      else           /* glibc 2.0 */
         size *= 2;  /* twice the old size */
      if ((np = realloc (p, size)) == NULL) {
         free(p);
         return NULL;
      } else {
         p = np;
      }
   } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T11:46:51.287

您是否考虑过 printf 的可移植实现？不久前我找了一个，然后选择了三重奏。

[http://daniel.haxx.se/projects/trio/](http://daniel.haxx.se/projects/trio/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T14:53:25.783

你的问题还不清楚。链接到的[手册页是这样说的：](http://linux.die.net/man/3/snprintf)

> 函数 snprintf() 和 vsnprintf()**写入的字节数不超过 size 字节**（包括尾随的 '\0'）。如果输出由于此限制而被截断，则返回值是在有足够空间可用的情况下**将**写入最终字符串的字符数（不包括尾随的 '\0'）。因此，**大小或更大的返回值意味着输出被截断。**

因此，如果您想知道您的输出是否被截断：

```
int ret = snprintf(cmd, cmdLen + 1, ". %s%s", myVar1, myVar2 ) == -1)
if(ret == -1 || ret > cmdLen)
{
    //output was truncated
}
else
{
    //everything is groovy
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-19T16:21:17.147

*printf 可移植性存在很多问题，实际上您可能希望遵循以下三种路径之一：

1.  需要一个符合 c99 的 *printf，因为 9 年对任何人来说都足够了，否则就说平台坏了。

2.  有一个带有一堆#ifdef 的 my_snprintf()，用于您想要支持所有调用下面的 vsnprintf() 的特定平台（了解最低公分母就是您所拥有的）。

3.  只需在您的代码中随身携带一份 vsnprintf() 副本，对于简单的用例，它实际上[非常简单](http://www.and.org/texts/simple_printf.c)，对于其他人您可能想查看[vstr](http://www.and.org/vstr/)，您将免费获得客户格式化程序。

...正如其他人建议的那样，您可以针对 -1 的情况进行 hack 合并 #1 和 #2，但这是有风险的，因为 c99 *printf 在某些情况下可以/确实返回 -1。

我个人建议只使用[像 ustr 这样的字符串库](http://www.and.org/ustr/)，它为您提供简单的解决方法并免费为您提供托管字符串。如果您真的很在意，可以与[vstr](http://www.and.org/vstr/)结合使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T10:18:44.237

我找到了一种可移植的方法来预测和/或限制 sprintf 和相关函数返回的字符数，但它效率低下，许多人认为它不雅。

您所做的是使用 tmpfile()、fprintf() 创建一个临时文件（它可靠地返回写入的字节数），然后倒带并将全部或部分文本读入缓冲区。

例子：

```
int my_snprintf(char *buf, size_t n, const char *fmt, ...)
{
    va_list va;
    int nchars;
    FILE *tf = tmpfile();

    va_start(va, n);
    nchars = vfprintf(tf, fmt, va);
    if (nchars >= (int) n)
        nchars = (int) n - 1;
    va_end(va);
    memset(buf, 0, 1 + (size_t) nchars);

    if (nchars > 0)
    {
        rewind(tf);
        fread(buf, 1, (size_t) nchars, tf);
    }

    fclose(tf);

    return nchars;   
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T14:58:43.243

请改用更高级的 asprintf() 。

这是一个 GNU 扩展，但如果它本身不可用，则值得将其复制到目标平台。

# database - 您可以在不创建锁定文件的情况下访问 Delphi DBIV 数据库吗？

> ID：100917
> 
> 赞同：0
> 
> 时间：2008-09-19T10:16:08.830
> 
> 标签：database, delphi

我试图从 Delphi DBIV 数据库中读取数据，每次我访问数据库时，它都会创建一个 Paradox.lck 和一个 Pdoxusrs.lck 文件。我只使用 TQuery 对象来执行此操作（仅此而已）。我可以在不创建这些锁定文件的情况下访问 Delphi DBIV 数据库吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-19T12:43:01.417

你为什么不想要锁定文件？没有真正研究它，我认为这些锁定文件有一个真正的目的

自从我使用 BDE 以来已经有一段时间了，但是您不能在 SELECT 查询中使用一些关键字来指示您不想要任何锁定吗？

例如，在 MS SQL 中，您可以使用以下语法：

```
SELECT * WITH(NOLOCK)
FROM SomeTable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T19:18:08.470

如果您的应用程序正在创建 PARADOX.LCK 和 PDOXUSRS.LCK 文件，那么它也在某处创建或访问 PDOXUSRS.NET 文件。

BDE 使用单个通用 PDOXUSRS.NET 文件以及每个共享目录中的 PARADOX.LCK 和 PDOXUSRS.LCK 文件来协调引擎的分布式实例之间的共享访问。

您必须确定您的应用程序是否与任何其他应用程序共享表。如果数据是共享的，您必须允许 BDE 创建和使用这些锁定文件。

如果您确定您是数据的唯一用户，则可以消除锁定文件的创建。但是——除非锁定文件是唯一阻止你做一些有用的事情的东西，否则很少值得阻止它们的创建。

注册表项告诉 BDE 在哪里可以找到其配置文件。BDE 附带一个配置文件编辑器；查找 BDEADMIN.EXE 或 BDECFG32.EXE。配置编辑器使用相同的注册表项来确定要编辑的文件。

为避免在您是数据的唯一用户时创建锁定文件：

1.  打开配置编辑器。

2.  转到配置 | 驱动程序 | 本地人 | 悖论，或驱动程序 | PARADOX，并注意 NET DIR 条目。

3.  将 NET DIR 值设置为空白。

4.  转到配置 | 系统 | INIT 或 System，并将 LOCAL SHARE 设置为 False。

5.  保存您的编辑。

6.  按照您在步骤 2 中记下的路径并删除在那里找到的 PDOXUSRS.NET。

7.  删除数据目录中所有剩余的 PARADOX.LCK 或 PDOXUSRS.LCK 文件。

警告：当您不了解锁定文件的目的时，玩弄锁定文件是使您的应用程序变砖的好方法。

-阿尔。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-20T14:23:37.717

感谢您的回复。我会研究你的两个建议。

致 AI Breveleri：

是的，我知道你在说什么，我不愿意关闭它们，但是使用数据库的其他应用程序比我的重要得多。理想情况下，我希望发生以下情况：

我的应用程序开始获取数据，如果其他应用程序想要使用数据库，那么我的应用程序将停止。

目前正在发生完全相反的情况。

炖。

# c# - ASP.NET：同步客户端和服务器端验证规则

> ID：100919
> 
> 赞同：8
> 
> 时间：2008-09-19T10:16:31.450
> 
> 标签：c#, asp.net, .net, validation

是否有任何简单、智能的方法可以使您的客户端和服务器端验证规则保持同步？

在客户端，我们有 JavaScript，可能是 jQuery 或 YUI 之类的框架。

在服务器端，我们有 ASP.NET WebForms 或 ASP.NET MVC。

验证的内容如下：

*   正确的电子邮件地址
*   正确的家庭地址和邮政编码
*   正确的信用卡号码

等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T13:43:50.600

<asp:RegularExpressionValidator ...> (and the other asp.net validators) implement client side javascript and server side checking to the same rules.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T16:47:59.680

我一直使用内置的验证器。例如，如果您使用 RegularExpressionValidator 并提供 ValidationExpression，它将使用相同的代码在客户端（如果可用）和服务器端进行验证。

您可以通过从 BaseValidatior 派生来编写自己的自定义验证器。这样做允许您通过覆盖 EvaluteIsValid 来创建服务器验证。如果有必要，您可以稍后添加客户端验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T16:52:13.633

这不是一个真实的解决方案，但请查看 CodePlex 上的[Axial 项目](http://www.codeplex.com/axial)。这是一个将 C# 转换为 Web 的 Javascript 的项目，并具有一个控件，可让您使用相同的代码进行服务器端验证和客户端验证。它还没有准备好投入生产，但我很想知道这是否是你想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T02:53:49.630

[xVAL](http://xval.codeplex.com/)比 Enterprise Library Validation 容易得多，并且可以处理客户端和服务器的模型绑定验证。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T13:41:56.290

编写一个包含验证规则的大型通用测试数据语料库，并针对这些通用数据对验证器进行单元测试。

当您的规则发生变化时，您可以通过更新测试数据和测试来反映这一点，直到一切再次变绿。

# inversion-of-control - 默认构造函数与 IOC 容器

> ID：100922
> 
> 赞同：12
> 
> 时间：2008-09-19T10:16:34.647
> 
> 标签：inversion-of-control

有人可以向我解释使用 IOC 容器相对于简单地将默认实现硬编码到默认构造函数中的优势吗？

换句话说，这段代码有什么问题？

```
public class MyClass
{
    private IMyInterface _myInterface;

    public MyClass()
    {
        _myInterface = new DefaultMyInterface();
    }

    public MyClass(IMyInterface myInterface)
    {
        _myInterface = myInterface;
    }
} 
```

据我所知，这个类足够支持构造函数注入，因此单元测试和模拟很容易完成。除此之外，默认构造函数消除了 IOC 容器的计算开销（更不用说整个过程更加透明）。

我可以看到使用 IOC 容器的唯一好处是如果您需要经常切换接口的实现。我错过了什么吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-19T10:22:59.857

IoC 的想法是将组件的部分功能委托给系统的另一部分。在 IoC 世界中，您拥有彼此不了解的组件。您的示例违反了这一点，因为您正在 MyClass 和 IMyInterface 的某些实现之间创建紧密耦合。**主要思想**是您的组件**不知道**如何使用它。在您的示例中，您的组件对其使用**做出了一些假设**。

实际上这种方法可以工作，但是混合 IoC 和显式对象初始化并不是 IMO 的好习惯。

IoC 通过执行后期绑定来为您提供松散耦合，但代价是代码清晰。当您向此过程添加其他行为时，它会使事情变得更加复杂，并且当某些组件可能接收到具有不需要或不可预测行为的对象时可能会导致错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T10:36:58.873

选择一方:)

简而言之，推荐国际奥委会。代码的问题是，如果不重新编译代码，我就无法换出依赖项的默认实现，正如您最后所说的那样。IOC 允许您在外部文件中更改对象的配置或组成，而无需重新编译。
**IOC 从代码的其余部分接管“构造和组装”责任。** IOC 的目的不是让您的代码可测试……这是一个令人愉快的副作用。（就像 TDDed 代码带来更好的设计一样）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T10:50:31.337

这段代码没有任何问题，您仍然可以将它与 Spring 和 Guice 等依赖注入框架一起使用。

许多开发人员将 Spring 的 XML 配置文件视为优于在代码中连接依赖项的优势，因为您可以在不需要编译步骤的情况下切换实现。这种好处实际上是在您已经在类路径中编译了多个实现并且您希望在部署时选择实现的情况下实现的。您可以想象一个组件在部署后由第三方提供的情况。类似地，您可能希望在部署后将其他实现作为补丁发布。

但并非所有 DI 框架都使用 XML 配置。例如，Google Guice 将模块编写为 Java 类，必须像任何其他 Java 类一样进行编译。

那么如果你甚至需要一个编译步骤，那么 DI 有什么优势呢？这使我们回到您最初的问题。我可以看到以下优点：

1.  整个应用程序中 DI 的标准方法。
2.  配置与其他逻辑巧妙地分离。
3.  注入代理的能力。例如，Spring 允许您通过注入代理而不是您的实现来进行声明性事务处理
4.  更容易重用配置逻辑。当您广泛使用 DI 时，您会看到一个复杂的依赖关系树随着时间的推移而演变。在没有明确分离的配置层和框架支持的情况下管理它可能是一场噩梦。DI 框架通过继承和其他方式使重用配置逻辑变得容易。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-13T17:52:24.090

我唯一担心的是（1）您的默认服务依赖项本身是否具有另一个/辅助服务依赖项（依此类推......您的 DefaultMyInterface 依赖于 ILogger）和（2）您需要将第一个服务依赖项与第二个服务依赖项（需要使用存根 ILogger 测试 DefaultMyInterface）。在这种情况下，您显然需要丢失默认的“new DefaultMyInterface”，而是执行以下操作之一：(1) 纯依赖注入或 (2) 服务定位器或 (3) container.BuildUp(new DefaultMyInterface());

列出的其他海报中的一些问题可能对您的问题不公平。您不是在询问多个“生产”实现。您在询问*单元测试。* 在单元测试你的方法的情况下，我的第一个警告是，似乎是合法的；我也会考虑在简单的单元测试用例中使用它。

同样，一些响应者对重复性表示担忧。我也不喜欢重复，但是如果（1）您的默认实现确实是您的默认实现（YAGNI：您没有更改默认设置的计划）并且（2）您不相信我所说的第一个警告适用并且(3) 更喜欢您共享的更简单的代码方法，那么我认为这种特殊形式的重复不是问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-19T10:37:45.097

除了松耦合之外，IoC 还可以减少代码重复。当您使用 IoC 并且想要更改接口的默认实现时，您只需在一处进行更改。当您使用默认构造函数注入默认实现时，您必须在使用接口的任何地方更改它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-22T17:52:10.170

除了其他评论之外，在这些情况下，人们可能会争论 DRY（不要重复自己）原则。必须将默认构造代码放在每个类中是多余的。它还介绍了不需要的特殊情况处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-19T10:23:07.627

我不明白为什么您对默认实现进行硬编码的技术不能与 IOC 容器一起使用。只是，您未在配置中指定的依赖项将采用默认实现。

还是我错过了什么？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-19T10:24:35.097

您可能想要使用 IOC 容器的一个原因是便于后期配置您的软件。

例如，假设您提供了特定接口的多个实现——客户（或您的专业服务团队）可以通过修改 IOC 配置文件来决定使用哪一个。

# mysql - 如何在 Mac OS 安装上停止 MySQL？

> ID：100948
> 
> 赞同：223
> 
> 时间：2008-09-19T10:21:42.700
> 
> 标签：mysql, macos

[我通过MacPorts](http://en.wikipedia.org/wiki/MacPorts)安装了 MySQL 。我需要停止服务器的命令是什么（我需要测试我的应用程序在 MySQL 死机时的行为）？

* * *

## 回答 #1

> 赞同：449
> 
> 时间：2008-09-19T14:08:18.373

根据您是使用官方二进制安装程序、使用[MacPorts](http://en.wikipedia.org/wiki/MacPorts)还是使用[Homebrew安装](http://brew.sh/)[MySQL](http://en.wikipedia.org/wiki/MySQL) ，存在不同的情况：

## 家酿

```
brew services start mysql
brew services stop mysql
brew services restart mysql 
```

## MacPorts

```
sudo port load mysql57-server
sudo port unload mysql57-server 
```

注意：这在重新启动后持续存在。

## 二进制安装程序

```
sudo /Library/StartupItems/MySQLCOM/MySQLCOM stop
sudo /Library/StartupItems/MySQLCOM/MySQLCOM start
sudo /Library/StartupItems/MySQLCOM/MySQLCOM restart 
```

* * *

## 回答 #2

> 赞同：142
> 
> 时间：2012-01-18T16:40:44.510

对于那些使用 homebrew 安装 MySQL 的用户，请使用以下命令来启动、停止或重新启动 MySQL

**酿造开始**

```
/usr/local/bin/mysql.server start 
```

**重新开始冲泡**

```
/usr/local/bin/mysql.server restart 
```

**冲泡站**

```
/usr/local/bin/mysql.server stop 
```

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2008-09-19T10:24:49.527

您始终可以使用命令“mysqladmin shutdown”

* * *

## 回答 #4

> 赞同：56
> 
> 时间：2016-05-13T13:43:54.230

如果您正在使用`homebrew`，您可以使用

```
brew services restart mysql
brew services start mysql
brew services stop mysql 
```

获取可用服务列表

```
brew services list 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2012-08-16T16:52:19.680

sudo /usr/local/mysql/support-files/mysql.server 停止

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2010-01-12T21:48:41.110

`sudo /opt/local/etc/LaunchDaemons/org.macports.mysql5/mysql5.wrapper stop`

您也可以在此处使用 start 和 restart 。我通过查看 /Library/LaunchDaemons/org.macports.mysql.plist 的内容发现了这一点。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2020-04-13T08:02:00.090

就我而言，只要我使用 PID 终止进程，它就会继续重新启动。当我在不使用自制软件的情况下安装时，命令也`brew stop`不起作用。然后我去了 mac 系统偏好设置，我们在那里安装了 MySQL。只需打开它并停止 MySQL 服务器即可。在屏幕截图中，您可以在系统偏好设置的底部找到 MySQL。[![在此处输入图像描述](../Images/e54f1bca60edf43a5e6fa4ba8a38c7bb.png)](https://i.stack.imgur.com/NqLCN.png)

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-09-19T10:23:31.387

显然你想要：

```
sudo /Library/StartupItems/MySQLCOM/MySQLCOM stop 
```

进一步阅读*[Jeez People，停止为安装 RMagic 烦恼](http://www.simplisticcomplexity.com/2007/10/27/start-and-stop-mysql-in-mac-os-x-105-leopard/)*。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2010-08-19T16:45:33.777

尝试

```
sudo <path to mysql>/support-files/mysql.server start
sudo <path to mysql>/support-files/mysql.server stop 
```

其他尝试：

```
sudo /Library/StartupItems/MySQLCOM/MySQLCOM start
sudo /Library/StartupItems/MySQLCOM/MySQLCOM stop<br>
sudo /Library/StartupItems/MySQLCOM/MySQLCOM restart 
```

但是，我发现第二个选项只有在 .plist 已加载时才有效（OS X 10.6，MySQL 5.1.50）：

```
sudo launchctl load -w /Library/LaunchDaemons/com.mysql.mysqld.plist 
```

PS：我还发现我需要卸载 .plist 以获得[MAMP](http://en.wikipedia.org/wiki/MAMP) -MySQL 的无关安装才能正确启动/停止。运行这个之后，MAMP-MySQL 就可以正常启动了：

sudo launchctl unload -w /Library/LaunchDaemons/com.mysql.mysqld.plist

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2016-03-22T03:38:02.113

在我的 mac osx 优胜美地 10.10 上。该命令有效：

```
sudo launchctl load -w /Library/LaunchDaemons/com.mysql.mysql.plist
sudo launchctl unload -w /Library/LaunchDaemons/com.mysql.mysql.plist 
```

您可以在文件夹 /Library/LaunchDaemons/ 中找到您的 mysql 文件以运行

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2013-07-08T11:56:25.603

采用：

```
sudo mysqladmin shutdown --user=*user* --password=*password* 
```

[不使用sudo](http://en.wikipedia.org/wiki/Sudo)可能会侥幸逃脱。例如，*用户*可以是 root（即 MySQL root 用户）。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2016-06-23T14:13:11.403

最新的 OSX (10.8) 和 mysql 5.6，该文件位于 Launch Daemons 下，为 com.oracle.oss.mysql.mysqld.plist。它在系统选项下显示一个选项，通常位于列表的底部。所以进入系统设置，点击Mysql，然后从选项框中将其关闭。 [https://dev.mysql.com/doc/refman/5.6/en/osx-installation-launchd.html](https://dev.mysql.com/doc/refman/5.6/en/osx-installation-launchd.html)

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-09-19T10:26:36.370

好吧，如果一切都失败了，您可以采取无情的方法并手动终止运行 MySQL 的进程。

那是，

```
ps -Af 
```

列出所有进程，然后执行“ `kill <pid>`”，这里`<pid>`是 MySQL 守护进程 (mysqld) 的进程 ID。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2021-07-21T11:19:59.757

获取实例名称：

```
ls /Library/LaunchDaemons | grep mysql 
```

停止 MySQL 实例（适用于 MacOS Catalina、MySQL 8）：

```
sudo launchctl unload /Library/LaunchDaemons/com.oracle.oss.mysql.mysqld.plist 
```

或者，您可以停止 MySQL 实例

```
MacOS Settings > MySQL > Stop MySQL Server 
```

另外，请在此处查看更多方法： [https ://tableplus.com/blog/2018/10/how-to-start-stop-restart-mysql-server.html](https://tableplus.com/blog/2018/10/how-to-start-stop-restart-mysql-server.html)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2021-07-22T14:56:47.063

正如@gediminas 所说

系统偏好设置 > MySQL > 停止 MySQL 服务器

是最简单的方法。使用从 Oracle 下载的二进制安装程序。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2011-06-30T10:09:05.660

对我来说，它正在使用“mysql5”

```
sudo launchctl unload -w /Library/LaunchDaemons/org.macports.mysql5.plist
sudo launchctl load -w /Library/LaunchDaemons/org.macports.mysql5.plist 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-10-15T09:15:08.113

在 OSX 雪豹上

```
launchctl unload /System/Library/LaunchDaemons/org.mysql.mysqld.plist 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2020-11-30T10:51:31.920

对我来说，以下解决方案有效[Unable to stop MySQL on OS X 10.10](https://stackoverflow.com/questions/29375253/unable-to-stop-mysql-on-os-x-10-10)

要停止我使用的自动启动：

```
sudo launchctl unload -w /Library/LaunchDaemons/com.mysql.mysql.plist 
```

并杀死我使用的服务：

```
sudo pkill mysqld 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-19T10:24:01.243

如果您使用 MacPorts 安装了 MySQL 5 软件包：

```
sudo launchctl  unload -w /Library/LaunchDaemons/org.macports.mysql.plist 
```

或者

```
sudo launchctl  unload -w /Library/LaunchDaemons/org.macports.mysql5-devel.plist 
```

如果您安装了`mysql5-devel`软件包。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2013-02-13T08:38:29.073

我在 macports 上安装了 mysql5 和 mysql55。对我来说，这里提到的文件位于以下位置：

(mysql55-server) /opt/local/etc/LaunchDaemons/org.macports.mysql55-server/org.macports.mysql55-server.plist

(mysql5) /opt/local/etc/LaunchDaemons/org.macports.mysql5/org.macports.mysql5.plist

所以停止这些工作是这样的：

mysql55-服务器：

```
sudo launchctl unload -w /opt/local/etc/LaunchDaemons/org.macports.mysql55-server/org.macports.mysql55-server.plist 
```

mysql5:

```
sudo launchctl unload -w /opt/local/etc/LaunchDaemons/org.macports.mysql5/org.macports.mysql5.plist 
```

您可以检查服务是否仍在运行：

```
ps ax | grep mysql 
```

此外，您可以在此处查看我的日志文件：

mysql55-服务器

```
sudo tail -n 100 /opt/local/var/db/mysql55/<MyName>-MacBook-Pro.local.err
...
130213 08:56:41 mysqld_safe mysqld from pid file /opt/local/var/db/mysql55/<MyName>-MacBook-Pro.local.pid ended 
```

mysql5:

```
sudo tail -n 100 /opt/local/var/db/mysql5/<MyName>-MacBook-Pro.local.err
...
130213 09:23:57  mysqld ended 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-04-03T21:31:25.427

mysql> 显示变量 where variable_name like '%dir%';

| 数据目录 | /opt/local/var/db/mysql5/ |

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-07-09T06:12:56.303

在尝试了所有这些命令行之后，它不起作用。我必须做以下事情：

```
mv /usr/local/Cellar/mysql/5.7.16/bin/mysqld /usr/local/Cellar/mysql/5.7.16/bin/mysqld.bak
mysql.server stop 
```

这种方式有效，mysqld进程消失了。但是 /var/log/system.log 有很多垃圾：

```
Jul  9 14:10:54 xxx com.apple.xpc.launchd[1] (homebrew.mxcl.mysql[78049]): Service exited with abnormal code: 1
Jul  9 14:10:54 xxx com.apple.xpc.launchd[1] (homebrew.mxcl.mysql): Service only ran for 0 seconds. Pushing respawn out by 10 seconds. 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-08-24T04:41:47.680

这在 macOS 10.13.6 和 8.0.12 MySQL 上对我有用

`/usr/local/mysql/support-files/mysql.server start`

`/usr/local/mysql/support-files/mysql.server restart`

`/usr/local/mysql/support-files/mysql.server stop`

# macos - Mac SQLite 编辑器

> ID：100959
> 
> 赞同：216
> 
> 时间：2008-09-19T10:24:18.450
> 
> 标签：macos, user-interface, sqlite

我知道[CocoaMySQL](http://cocoamysql.sourceforge.net/)，但我还没有看到 SQLite 的 Mac GUI，有吗？

我的谷歌搜索没有出现任何与 Mac 相关的 GUI，这就是为什么我在这里问而不是谷歌。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2008-12-16T23:23:01.773

[Base](http://menial.co.uk/software/base/)比您的问题更年轻，并且绝对感觉像 1.0，但用户体验比在 Mac 上使用任何“跨平台”应用程序的体验*好几英里。*

[http://menial.co.uk/software/base/](http://menial.co.uk/software/base/)

我建议您在开发人员意识到他收取的费用太少之前购买许可证。

更新：自 2008 年 12 月以来，Base 现在升级到 2.1 版，它已成为一款出色的产品。我不记得以前花了多少钱，但我支付了从 1.x 升级到 2.x 的费用。仍然强烈推荐。

另一个更新：[Base 在 Mac App Store 上可用](http://itunes.apple.com/us/app/base/id402383384?mt=12)，您可能会发现在那里阅读评论很有用。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2008-09-19T10:30:56.703

[火狐的 SQLite 管理器](https://addons.mozilla.org/en-US/firefox/addon/5817)

* * *

## 回答 #3

> 赞同：89
> 
> 时间：2012-05-03T11:21:22.960

我使用Mac App Store 中的[Liya](https://itunes.apple.com/dk/app/liya/id455484422?mt=12)，它是免费的，可以完成工作，并且项目得到维护（截至 2013 年 1 月的更新间隔一个月左右）。

我也在设备上进行了很多测试。您可以通过以下方式访问设备上的 SQLITE 数据库：

1.  添加`Application supports iTunes file sharing`到 info.plist 并将其设置为 YES
2.  在设备上运行应用程序
3.  打开 iTunes
4.  选择设备
5.  选择“应用程序”选项卡
6.  向下滚动到“文件共享”部分并选择应用程序
7.  .sqlite 文件应出现在右侧窗格中 - 选择它并“保存到...”
8.  保存后在您最喜欢的 SQLITE 编辑器中打开它

您也可以对其进行编辑并将其复制回来。

**编辑：您也可以通过 XCode 中的 Organizer**

1.  在 XCode 中打开管理器（窗口 > 管理器）
2.  选择“设备”选项卡
3.  展开左侧要下载/上传数据的设备
4.  选择应用程序
5.  在主面板中选择一个应用程序
6.  底部的面板（沙盒中的数据文件）将使用该应用程序中的所有文件进行更新
7.  选择下载并将其保存在某处
8.  在 Finder 中查找文件
9.  右键单击并选择“显示包内容”

您现在可以查看、编辑包并将其重新上传到您的调试设备。这对于保存不同状态的快照以在其他设备上试用非常方便。

* * *

## 回答 #4

> 赞同：65
> 
> 时间：2013-01-09T04:27:57.433

您可能喜欢[SQLPro for SQLite](https://sqlitepro.com/?source=stackoverflow)（以前的 SQLite Professional - [App Store](https://itunes.apple.com/us/app/sqlite-professional/id586001240?ls=1&mt=12)）。

该应用程序具有一些简洁的功能，例如：

*   自动完成和语法高亮。
*   版本集成（回滚到以前的版本）。
*   内联数据过滤。
*   加载[sqlite 扩展](http://www.sqlite.org/loadext.html)的能力。
*   SQLite 2 兼容性。
*   导出选项为 CSV、JSON、XML 和 MySQL。
*   从 CSV、JSON 或 XML 导入。
*   列重新排序。
*   全屏支持。

[![SQLPro for SQLite 概述屏幕截图](../Images/26ef1b4eb20ad39be75e968f37c6d4d2.png)](https://i.stack.imgur.com/JxBse.png)

[该网站](https://sqlitepro.com/?source=stackoverflow)提供 7 天试用版。如果您通过我们的[网站](https://sqlitepro.com/store.php)购买，请使用促销代码**STACK25**节省 25%。

免责声明：我是开发人员。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-02-23T00:49:51.877

MesaSQLite 是迄今为止我发现的最好的。

[www.desertsandsoftware.com](http://www.desertsandsoftware.com/)

看起来确实很有前途。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2010-09-23T08:32:34.840

我正在使用简单的工具进行基本的 sqlite 操作，称为[Lita](http://www.dehats.com/drupal/?q=node/58)

此工具基于 Adob​​e Air，因此必须在使用 Lita 之前安装。Adobe air 可以从[Adob​​e 网站](http://www.adobe.com)免费下载。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2008-09-21T16:27:40.720

那个 FireFox 扩展看起来很不错。我过去使用过[SQLite 浏览器](http://sqlitebrowser.sourceforge.net/)，它完成了这项工作。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2010-05-01T14:33:03.033

我已经发布了关于如何在 Firefox 之外运行[Firefox SQLite Manager](http://www.kiveo.net/blog/mac-sqlite-manager-standalone-app/)的说明，因为 FF 在最近的几个版本中变得如此臃肿。这真的很简单，如果有人想要的话，我什至已经为 sqlite gui 编译了一个 DMG。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-06-26T03:52:13.747

看看免费工具 - Valentina Studio。惊人的产品！IMO 这是适用于所有平台的 SQLite 的最佳管理器：

*   [http://www.valentina-db.com/en/valentina-studio-overview](http://www.valentina-db.com/en/valentina-studio-overview)

它也适用于 Mac OS X，您可以直接从 Mac App Store 安装 Valentina Studio (免费)：

*   [https://itunes.apple.com/us/app/valentina-studio/id604825918?ls=1&mt=12](https://itunes.apple.com/us/app/valentina-studio/id604825918?ls=1&mt=12)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-06-22T13:06:38.200

[Sqliteman](http://sqliteman.com/)是我目前的偏好：它使用 QT，所以它是跨平台的。由于我在 Windows、Linux 和 OS X 上进行开发，因此在每个平台上提供相同的工具会很有帮助。

我还尝试了一段时间的[SQLite Admin](http://sqliteadmin.orbmu2k.de/)（Windows，无论如何都与问题无关），但这些天似乎没有维护，并且拥有我用过的任何应用程序中最烦人的热键 - Ctrl-S 清除当前查询，没有撤消的希望。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2013-08-19T13:32:44.453

还有 Induction 应用程序 ( [http://inductionapp.com/](http://inductionapp.com/) )，它是免费和开源的 ( [https://github.com/Induction/Induction](https://github.com/Induction/Induction) )。

只需将 .sqlite 文件拖放到图标上即可打开文件。

另一个不错的选择是[https://github.com/yepher/CoreDataUtility](https://github.com/yepher/CoreDataUtility)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-06-20T09:38:09.913

试试这个[SQLite 数据库浏览器](http://sourceforge.net/projects/sqlitebrowser/)

[在此处](http://sqlitebrowser.sourceforge.net/)查看完整文档。这是一个非常简单快速的 SQLite 数据库浏览器。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-09-19T11:48:26.257

请尝试使用[versiontracker 搜索](http://www.versiontracker.com/php/qs.php?mode=basic&action=search&str=sqlite&srchArea=macosx&submit=Go "Versiontracker.com：“sqlite”的搜索结果")。[来自 SQLabs 的 SqliteManager](http://www.sqlabs.net/sqlitemanager.php)（49 美元，Mac 和 Windows）是我更喜欢的一个，但我还没有真正评估过其他替代方案。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-09-30T16:45:35.567

你可以试试[Navicat](http://www.navicat.com)。它曾经有一个免费的“精简版”版本，遗憾的是不再可用。专业版支持几个重要的数据库引擎，不仅仅是 SQLite。我目前正在使用 30 天免费评估版。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-08-01T11:56:03.340

Razorsql 可以处理多种数据库。

# opengl - AMD 64 位双核优化

> ID：100960
> 
> 赞同：0
> 
> 时间：2008-09-19T10:24:23.647
> 
> 标签：opengl, graphics, 64-bit, cpu, amd-processor

我们有一个图形密集型应用程序，它似乎在 AMD 64 位双核平台上遇到问题，而在 Intel 平台上并不明显。

运行应用程序会导致 CPU 以 100% 运行，尤其是在使用阴影和照明代码 (Open GL) 时。

有谁知道 AMD 处理器的具体问题可能导致此问题，或者知道在哪里追查问题，和/或优化代码库以避免这些问题的方法？

*请注意，该应用程序通常在中档硬件上运行良好，我的开发机器有一个 nvidia gtx260 卡，所以电源不足应该不是问题*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-22T12:35:34.793

请注意，AMD64 是一种[NUMA](http://en.wikipedia.org/wiki/Non-Uniform_Memory_Access)架构 - 如果您使用的是多处理器盒，您可能会在超传输总线上运行大量内存访问，这将比本地内存慢，并且可以解释这种行为。

单个插槽上的内核之间不会出现这种情况，因此如果您不使用多插槽机器，请随意忽略这一点。

Linux 是 NUMA 感知的（即它具有系统服务来通过本地银行分配内存并将进程绑定到特定的 CPU）。我相信 Win 2k3 服务器、2k8 和 Vista 支持 NUMA，但 XP 不支持。大多数专有的 unix 变体（例如 Solaris）也支持 NUMA。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T20:39:21.937

这里迟到的答案。

不知道这是否相关，但在某些 win32 OpenGL 驱动程序中，SwapBuffers() 在等待 vsync 时不会产生 CPU，因此很容易获得 100% 的 CPU 利用率。

我使用的解决方案是测量自上次 SwapBuffers() 完成以来的时间，它告诉我下一个 vsync 有多远。所以在调用 SwapBuffers() 之前，我会使用很短的 Sleep()，直到我检测到 vsync 迫在眉睫。这种方式 SwapBuffers() 不必等待很长时间来等待 vsync，因此不会太严重地占用 CPU。

请注意，您可能必须使用 timeBeginPeriod() 来获得足够的 Sleep() 精度才能使其可靠地工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-21T17:28:51.467

根据您如何完成阴影和其他图形代码，您可能“掉进了快速路径”并且图形驱动程序已经开始进行软件仿真。如果您有复杂的管道，或者在着色器代码中使用太多条件（或太多指令），则可能会发生这种情况。

我会确保这个特定的显卡支持您正在使用的所有功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-22T12:46:00.650

此外，缓存不共享，这可能会导致在多个线程之间共享数据时性能不足。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T10:26:59.117

我会投资分析软件来追踪问题的实际原因。

在 linux 上，Valgrind（包含 Cachegrind 和 Callgrind）+ KCacheGrind 可以确定所有繁重的函数调用在哪里进行。

此外，使用完整的调试符号进行编译，它甚至可以在慢速函数调用时显示汇编代码。

如果您使用的是英特尔专用编译器，这可能是您的问题的一部分（未定义），请尝试 GCC 系列。

此外，如果您还没有深入了解 OpenMP 和 Threads，您可能还想深入了解。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T10:33:39.333

嗯 - 如果您使用阴影，GPU 应该处于负载状态，因此 GPU 渲染帧的速度不太可能比 CPU 发送图形数据的速度快。在这种情况下，100% 的负载是可以的，甚至可以预期。

它可能只是一个无聊的 OpenGL 驱动程序，它会在某个地方的自旋锁中消耗 CPU 周期。要了解到底发生了什么，我建议您运行分析工具，例如 AMD 的 Code Analyst（上次我使用它时免费）。

用几分钟分析你的程序，看看时间花在了哪里。如果您在 opengl 驱动程序中看到一个高峰，而不是在您的应用程序中看到一个新的驱动程序。否则，您至少会知道发生了什么。

顺便说一句 - 让我猜猜，你使用的是 ATI 卡，对吧？我不想冒犯任何 ATI 粉丝，但他们的 OpenGL 驱动器并不是很出色。如果您不走运，您甚至可能使用了该卡不支持或由于硅错误而被禁用的功能。在这种情况下，驱动程序将退回到软件光栅化模式。即使您的程序是单线程的，这也会大大减慢速度并为您提供 100% 的 CPU 负载。

# ssl - 在嵌入式壁虎浏览器中阻止 https url

> ID：100976
> 
> 赞同：0
> 
> 时间：2008-09-19T10:28:05.820
> 
> 标签：ssl, https, embedding, gecko, nss

我有一个嵌入壁虎浏览器的应用程序。当我尝试访问任何 https url 时应用程序崩溃，因为此时 nss 未正确初始化。崩溃发生在 PK11_TokenExists() 中。我想阻止我的浏览器呈现 https 网站。如果用户单击 https 链接，我可以在 nsIURIContentListener 的 OnStartURI() 中阻止该加载。但如果用户输入说 orkut.com，我不会在 OnStartURI() 中知道它是 http url 还是 https 的（即它是否将使用 SSL 与否）。我想知道在这种情况下如何阻止 https url？

感谢 jbsp72

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T12:39:58.100

我会首先尝试找出您的应用程序在 HTTPS/SSL 连接上崩溃的原因。我认为修复崩溃比试图避免它更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-10T16:34:56.380

您可以通过以下方式实现：

实现接口的`OnStateChange`方法`nsIWebProgressListener`。

检查参数`aStateFlags`：如果此参数包含标志`STATE_IS_DOCUMENT`和`STATE_START`，则正在导航到新位置。

要查找 URL，请使用参数`aRequest`。它有 type `nsIRequest`，但将其强制转换为 type `nsIChannel`。然后读取`URI`属性。这包含要导航到的 URL。

如果 URI 以“https”开头，则通过调用 parameter 的`cancel`方法中止导航，并作为参数`aRequest`传递。`NS_BINDING_ABORTED`

# winapi - 在 Win32 中子类化 MonthCal 控件

> ID：100989
> 
> 赞同：3
> 
> 时间：2008-09-19T10:32:26.230
> 
> 标签：winapi, controls, monthcalendar

目的：使用标准的Win32 MonthCal控件，用RED绘制节假日等日子。

似乎 Win32 的本机方法将使用[MCN_GETDAYSTATE](http://msdn.microsoft.com/en-us/library/bb760935(VS.85).aspx)通知，这似乎只允许以粗体绘制特定日期。

可能（但被拒绝）的解决方案是编写我自己的随意绘制的 MonthCalendar，将自己赶出主题支持 - 这意味着当有新主题出现时，我的控制可能不会与 UI 保持一致。

如果有人遇到此问题，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T14:54:45.277

好吧，如果您的应用程序不使用任何 MFC，而是用纯 win32 调用编写的，那么执行您想要的操作的 MFC 控件是不可能的。因此，您可以使用 MFC 或 win32 进行控件 - 显然 MFC 控件将在后台使用 win32，但 15 年的 Windows 开发人员约定表明，当有人谈论“win32 控件”时，它是一个“仅使用 win32 调用的控件” ，没有外部库”和“MFC 控件”是“直接或间接从 CWnd 派生并使用 MFC 类和使用模式的控件”。

无论如何，看看[http://www.bcgsoft.com/samples/calendar.htm](http://www.bcgsoft.com/samples/calendar.htm)。他们的 UI 套件中有一个控件，看起来像 MonthCal 控件，但您可以在其中用颜色指示日期范围等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-19T21:25:30.990

做不到。该控件仅支持以粗体显示某些日子。

您的目标是什么平台（台式机或 WM？）如果是台式机，它真的是 win32 还是可以接受 MFC 解决方案？

# spring - spring & web 服务客户端 - 故障详情

> ID：100990
> 
> 赞同：5
> 
> 时间：2008-09-19T10:32:29.740
> 
> 标签：spring, service, webservicetemplate

如何获取 SoapFaultClientException 发送的故障详细信息？我使用如下所示的 WebServiceTemplate：

```
WebServiceTemplate ws = new WebServiceTemplate();
ws.setMarshaller(client.getMarshaller());
ws.setUnmarshaller(client.getUnMarshaller());
try {
    MyResponse resp = (MyResponse) = ws.marshalSendAndReceive(WS_URI, req);
} catch (SoapFaultClientException e) {
     SoapFault fault =  e.getSoapFault();
     SoapFaultDetail details = e.getSoapFault().getFaultDetail();
      //details always NULL ? Bug?
} 
```

发送的 Web 服务故障似乎是正确的：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<soapenv:Body>
  <soapenv:Fault>
     <faultcode>soapenv:Client</faultcode>
     <faultstring>Validation error</faultstring>
     <faultactor/>
     <detail>
        <ws:ValidationError xmlns:ws="http://ws.x.y.com">ERR_UNKNOWN</ws:ValidationError>
     </detail>
  </soapenv:Fault>
</soapenv:Body> 
```

谢谢

威洛姆

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-18T11:43:56.157

我还遇到了 getFaultDetail() 返回 null（对于 SharePoint Web 服务）的问题。我可以使用与此类似的方法来获取详细信息元素：

```
private Element getDetail(SoapFaultClientException e) throws TransformerException {
    TransformerFactory transformerFactory = TransformerFactory.newInstance();
    Transformer transformer = transformerFactory.newTransformer();
    DOMResult result = new DOMResult();
    transformer.transform(e.getSoapFault().getSource(), result);
    NodeList nl = ((Document)result.getNode()).getElementsByTagName("detail");
    return (Element)nl.item(0);
} 
```

之后，您可以在返回的 Element 或您想要的任何内容上调用 getTextContent()。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-05-05T09:47:58.890

查看收到 Soap Fault 时收到的 HTTP 响应类型。当 SOAP 故障响应使用 HTTP 200 而不是 HTTP 500 时，我遇到了同样的问题。然后你得到：

> JAXB 解组异常；嵌套异常是 javax.xml.bind.UnmarshalException

当您更改 WebServiceTemplate 连接故障设置如下：

```
WebServiceTemplate webServiceTemplate = getWebServiceTemplate();
webServiceTemplate.setCheckConnectionForFault(false); 
```

那么您可以正确捕获**SoapFaultClientException**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T21:41:27.533

从[marshalSendAndReceive 方法](http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/ws/client/core/WebServiceOperations.html#marshalSendAndReceive%28java.lang.String,%20java.lang.Object%29)的 Javadocs 看来，catch 块中的 SoapFaultClientException 永远不会发生。

从 API 看来，确定故障细节的最佳选择是设置自定义[故障消息接收器](http://static.springframework.org/spring-ws/sites/1.5/apidocs/org/springframework/ws/client/core/WebServiceTemplate.html#setFaultMessageResolver%28org.springframework.ws.client.core.FaultMessageResolver%29)。

# web-services - RMI 与 Web 服务。Java2Java 远程处理的最佳选择是什么？

> ID：100993
> 
> 赞同：47
> 
> 时间：2008-09-19T10:32:55.670
> 
> 标签：web-services, remoting, jax-ws, rmi

我是 Web 服务和 RMI 的新手，我想知道在不同的 Web 应用程序之间进行远程处理的更好方法是，当这些应用程序都用 Java 编写时，即不同的编程语言无关紧要（这将是WS的优势）。

一方面我猜想在使用 Web 服务时会有性能开销（有没有人有一些数字可以证明这一点？），另一方面，在我看来，Web 服务的耦合度要松散得多，可以用来实现一个更加面向服务的架构 (SOA)（这在 RMI 中是不可能的，对吧？）。

虽然这是一个相当笼统的问题，但您的意见是什么？

谢谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-19T10:56:20.463

Web 服务确实允许松散耦合的架构。使用 RMI，您必须确保类定义在所有应用程序实例中保持同步，这意味着您始终必须同时部署所有它们，即使只有其中一个被更改（不一定，但它是由于串行 UUID 等原因，经常需要）

此外，它的可扩展性也不是很好，如果您想拥有负载平衡器，这可能是一个问题。

在我看来，RMI 最适合与互联网无关但仍需要解耦的小型本地应用程序。我用它来制作一个处理电子通信的 java 应用程序，我对结果非常满意。对于需要更复杂的部署和跨互联网工作的其他应用程序，我宁愿使用 Web 服务。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-19T10:48:38.173

您是使用 Web 服务还是更“本机”的方法也取决于环境。如果您必须通过代理或某些公司防火墙，Web 服务更有可能工作，因为它们仅依赖于 HTTP。RMI 要求您为您的应用程序打开另一个端口，这在某些环境中可能很困难（但在技术上并非如此）......

如果您知道这个问题不是问题，您应该考虑使用 RMI。SOA 不依赖于技术，而是依赖于良好的服务设计。如果你有一个 EJB 容器，你可以通过 RMI 调用会话 bean，如果你真的需要的话，还可以将它们公开为 Web 服务。

性能取决于您计划交换的数据。如果您想将复杂的对象网络从一个应用程序发送到另一个应用程序，使用 RMI 可能会更快，因为它（通常）以二进制格式传输。如果您有某种文本/XML 内容，那么 Web 服务可能是等效的，甚至更快，因为那时您根本不需要转换任何东西（用于通信）。

HTH，
马丁

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-11-14T17:25:57.917

WS 优于 RMI 的一件事是 WS 在 HTTP 端口 80/443 上工作，该端口通常不会被防火墙阻止，可以在 NAT 等后面工作。RMI 有一个非常复杂的底层网络协议，需要您打开 RMI 端口，并且如果客户端是 NATTED，则可能无法正常工作。其次，使用 RMI，您将 slef 限制为 JAVA-JAVA 通信，而使用 Webservies 则没有这样的限制。由于数据是 SOAP/HTTP ，因此通过网络调试 Web 服务要容易得多，可以通过嗅探工具轻松捕获这些数据以进行调试。我不知道通过 RMI 执行此操作的简单方法。此外，RMI 真的很老了，最近几年没有受到太多关注。在 CORBA 大的时代，这很重要，而且 RMI CORBA 都是过时的技术。最好的选择是 REST 风格的 Web 服务。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-19T10:43:34.473

我在 RMI 和 Web 服务方面的经验反映了您上面的猜测。一般来说，如果通信要求是针对复杂对象，RMI 的性能会超过 Web 服务。需要为 Web 服务明确指定 JEE 接口规范。

请注意，Web 服务是可互操作的，而 RMI 不是（就客户端和服务器的技术而言）。当我有一个或多个实现接口的外部合作伙伴时，我倾向于使用 Web 服务，但如果我控制连接的两端，则使用 RMI。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T14:08:54.260

如果您需要维护复杂的状态，RMI 可能是更好的方向。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-23T10:11:06.610

@马丁克林克

“性能取决于您计划交换的数据。如果您想将复杂的对象网络从一个应用程序发送到另一个应用程序，使用 RMI 可能会更快，因为它（通常）以二进制格式传输。如果您有某种无论如何，对于文本/XML 内容，Web 服务可能是等效的，甚至更快，因为那时您根本不需要转换任何东西（用于通信）。”

据我所知，性能问题在序列化-反序列化过程中会产生影响，换句话说就是编组-解组过程。我不确定这两个术语是否相同。顺便说一句，在分布式编程中，我不是在谈论发生在同一个 JVM 中的过程，它是关于如何复制数据。它是按值传递或按引用传递。二进制格式对应于按值传递，这意味着将对象复制到二进制文件中的远程服务器。如果您到目前为止还有任何疑问，我想听听

就编组-解组或序列化-反序列化而言，以二进制格式发送和文本/xml 内容有什么区别？

我只是猜测。它不取决于您发送什么样的数据。无论您发送什么数据类型，它都将成为编组-解组过程的一部分，最后将以二进制文件的形式发送，对吗？

欢呼八木

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-05T10:19:54.060

春季远程处理怎么样。它结合了类似 REST 的 HTTP 协议和 RMI 的二进制格式。非常适合我。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-04-12T12:58:26.760

作为 Spring 的顽固分子和 SOA 多年的倡导者，我建议 Spring 远程处理。这种服务出口商的风格将为 RMI 解决问题。

```
org.springframework.remoting.rmi.RmiServiceExporter 
```

当然还有其他交通工具。如果您明智地对接口（端点）和 DTO 进行版本控制并正确管理序列化 UUID，那么序列化的事情就很容易管理。我们将“Alpha”、“Bravo”后缀到我们的接口和对象，并在必要时在必要时增加、减少和重新发明。我们还将序列化 UUID 修复为 1，并确保更改只是附加的，否则我们会从“Bravo”变为“Charlie”。所有这些都可以在企业设置中进行管理。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-20T11:12:27.027

对于Spring Remoting（我猜你的意思是HTTP Invoker），双方都应该使用Spring，如果是这种情况可以讨论。

对于 Java 到 Java 应用程序，RMI 是一个很好的解决方案，如果客户端不受您的控制或可能移动到另一个平台，则应避免用于 Java 到 Java 通信的 JAX-RPC 或 JAX-WS。

# domain-driven-design - 什么是领域驱动设计？

> ID：100995
> 
> 赞同：50
> 
> 时间：2008-09-19T10:33:35.060
> 
> 标签：domain-driven-design

所以我从团队中的一位开发人员那里得到了这个问题：什么是领域驱动设计？我当然可以指出埃文斯的书，但这实际上是一个答案吗？

您将如何用几句话向团队中的初级软件工程师解释 DDD？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-09-19T10:42:01.683

我想说的是，这种做法有助于将您的精力集中在“问题空间”而不是“解决方案空间”上。通过学习并真正了解和理解领域来推动紧急解决方案（设计）。其中一种实践（取自 XP）是编写发生在问题域中的故事。从这些您可以确定您的设计用例和对象。它们“出现”并告诉您解决方案中需要包含什么，以及它们需要如何相互交互。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-19T10:56:38.543

InfoQ 有一本免费的电子书：

[领域驱动设计快速](http://www.infoq.com/minibooks/domain-driven-design-quickly)

这是一本很好的读物，有很多例子。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-19T10:47:51.453

在发现“领域”的过程中，您形成了一种通用语言，开发人员和项目中的所有其他利益相关者都可以理解。

域模型及其“术语”在成品的源代码中非常明显。这至少是我的经验

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-19T10:44:40.633

DDD 的一个重要部分是所谓的泛在语言；即说与业务专家相同的语言。并使您的代码/架构能够反映这种语言以避免阻抗问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-19T10:55:16.973

尝试理解你正在编写的软件是关于什么的，并在模型中反映这种理解。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-23T20:40:02.110

域驱动设计是关于在域模型中管理应用程序的复杂性，它最容易被提炼出来。

很难用几句话来描述，但我会推荐[InfoQ](https://stackoverflow.com/questions/tagged/domain-driven-design)的书作为一个很好的介绍。我还听说很多人用 Evans 的 DDD 书建立了一个读书俱乐部，这对理解它有很大帮助。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-18T01:24:32.753

对我来说是 OOD/OOP 的下一个级别，其中封装完全是关于用户描述和理解的问题空间，而不是技术实现。

# delphi - 德尔福 7 和 Windows Vista

> ID：100998
> 
> 赞同：2
> 
> 时间：2008-09-19T10:33:53.263
> 
> 标签：delphi, windows-vista

我有一个用 Delphi 7 制作的简单软件，一段时间后它在 Vista 上崩溃了。这些都是完全随机的崩溃，任何崩溃日志中都没有写入任何内容，只是停止工作，然后 Vista 试图找到解决方案。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-19T11:11:03.673

尝试其中一种异常捕获器，例如 madExcept。它通常可以帮助您了解出现问题时应用程序内部发生的情况。总的来说，虽然 Delphi 应用程序在 Vista 中很好，所以必须有一些交互，也许是用户权限，这会造成麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T10:43:14.770

一些想法：

*   DEP - 尝试为程序禁用 DEP，看看它是否解决了问题
*   ASLR
*   它无法访问某些资源，获得一个 NULL 指针（一种常用的函数表示它们失败的方式）并尝试使用它（具有可预测的结果）

最好的办法是使用附加的调试器（最好是 Delphi 7 - 听起来你有源代码）运行并检查崩溃的确切位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-19T18:49:37.057

只是指出--madExcept 有一个“挂起”检测选项应该会有所帮助。